# StackOverflow 问答 14088000-14088999

# xamarin.ios - Monotouch.Dialog 元素样式影响背景视图

> ID：14088000
> 
> 赞同：1
> 
> 时间：2012-12-30T03:13:23.393
> 
> 标签：xamarin.ios, monotouch.dialog

我在尝试设置 monotouch.dialog 样式时遇到了一些问题。

我正在设置背景对话框

```
public override void LoadView ()
    {
        base.LoadView ();
        TableView.BackgroundView = null;
        TableView.BackgroundColor = UIColor.FromPatternImage(UIImage.FromBundle("Images/Background/bg-app")); 
```

部分标题看起来不错，但是每个元素看起来都像是在重新创建背景。

只显示白框而不重新创建背景的最简单（也是最好）的方法是什么？我想要单个背景图像的外观，对话框出现在背景上

![在此处输入图像描述](../Images/71140a5de3d020f281b6eef7a0b181da.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-10T17:40:56.850

您可以尝试将图像设置为表格视图的完整大小 -

```
TableView.BackgroundView = new UIImageView(UIImage.FromFile("image-size-of-table-view.png")); 
```

# javascript - 无法将事件添加到内联 SVG 元素

> ID：14088001
> 
> 赞同：4
> 
> 时间：2012-12-30T03:13:29.027
> 
> 标签：javascript, svg

我正在尝试访问 JavaScript 中的内联 SVG 元素，以添加单击事件。我遇到了将事件添加到除以 id 标识的单个元素之外的任何内容的问题。使用 document.getElementById("p1_1_1") 会起作用，但我需要操作 200 个矩形，所以我需要使用 document.getElementsByTagName 或 document.getElementsByClassName - 两者都返回有意义的 HTMLCollections，但 addEvent 不会添加事件。

到目前为止，我已经尝试过 Firefox 17 和 Chrome 23，以及一些其他方法，例如`getElementsByTagNameNS`, bu no lucky。

感谢您提供的任何帮助。

以下是我正在使用的 JS 代码和 HTML/SVG 的精简版本：

**JavaScript：**

```
 function testing() {
    var testDiv = document.getElementById("tester");
    testDiv.innerHTML = '<h1>Success!</h1><br>';
}

function addEvent(obj, evt, func) {
    if (obj.addEventListener) {
        obj.addEventListener(evt, func, false)
    } else if (obj.attachEvent) {
        obj.attachEvent("on" + evt, func);
    } else {
        alert("no success adding event");
    }
}

function init() {
    var targetSquares = document.getElementsByTagName("rect");
    addEvent(targetSquares, "click", testing);
}

window.addEvent(window, "load", init); 
```

**内联 SVG**

```
<!DOCTYPE html>
<html lang="en-GB">
    <head>
        <meta charset="utf-8">
        <script type="text/javascript" src="bsroyale.js"></script>
    </head>
    <body>
<div id="tester">
</div>
        <div id="gamemap">
              <svg xmlns="http://www.w3.org/2000/svg"
                   xmlns:xlink="http://www.w3.org/1999/xlink"
                   viewBox="0 0 600 600">
                <rect x="50" y="50" width="20" height="20" class="p1" id="p1_1_1" />
                <rect x="71" y="50" width="20" height="20" class="p1" id="p1_2_1" />
                <rect x="92" y="50" width="20" height="20" class="p1" id="p1_3_1" />
                <rect x="113" y="50" width="20" height="20" class="p1" id="p1_4_1" />
                <rect x="134" y="50" width="20" height="20" class="p1" id="p1_5_1" />
                <!-- etc etc, 200 rect in total-->
            </svg>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T03:28:58.857

`document.getElementsByTagName("rect")`返回一个 HTML 集合。然后，您必须遍历该集合（即，对于每个...）并将事件侦听器添加到每个集合项。

我没有对其进行测试，但您的 init 函数可能如下所示：

```
function init() {
    var targetSquares = document.getElementsByTagName("rect");
    for (var i = 0; i < targetSquares.length; i++) {
        addEvent(targetSquares[i], "click", testing);
    }
} 
```

# javascript - html5 音频和支持 Javascript

> ID：14088006
> 
> 赞同：2
> 
> 时间：2012-12-30T03:14:49.150
> 
> 标签：javascript, html, audio

我写了一些应该播放声音文件的简单 html 和 javascript。该页面显示两个按钮，但是当我单击播放按钮时，它什么也不做。我知道我的浏览器可以播放我的 mp3 文件，因为它只适用于音频标签 ex：

```
<audio src="soundtest.mp3" ></audio> 
```

如果有人能告诉我我做错了什么，我将不胜感激。

```
<!DOCTYPE html>
<html>
<body>

<button onclick="playSong()" type="button">play</button>
<button onclick="pauseSong()" type="button">pause</button>
<br>

<audio id="audio1">
<source src="soundtest.mp3" type="audio/mp3" >
  Your browser does not support the audio tag!
</audio>

<script> 
var mySong=document.getElementById("audio1"); 

function playSong()
  { 
  mySong.play();

  } 

function pauseSong()
  { 
  mySong.pause();

  } 

</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T03:31:39.303

有几件事可以尝试。首先，检查`mySong.canPlayType("audio/mpeg")`. 它应该返回“也许”。如果不支持，则您的浏览器不支持 MP3，您应该尝试使用其他浏览器。

那么，`<audio>`标签的`type`属性应该是`audio/mpeg`，而不是`audio/mp3`。MIME 类型很重要。

事实上，非常重要的是，如果它仍然不起作用，您应该检查以确保服务器配置为提供`.mp3`具有`audio/mpeg`MIME 类型标头的文件。

如果这仍然不起作用...尝试打开扬声器：p 我在开玩笑，如果您在执行这些步骤后仍有问题，请告诉我。

# java - 我应该使用“_activity = this;”吗？

> ID：14088007
> 
> 赞同：6
> 
> 时间：2012-12-30T03:14:56.217
> 
> 标签：java, android, android-activity

我应该使用“ `_activity = this;`”吗？

我在示例代码中多次看到 _activity 被引用。因此，我武断地认为这看起来是一种很好的做法，并且已经在我的所有代码中使用了一段时间（一年多）。但是，在我开始更多地传播这个词之前，我想找到一些适当的文档，说明使用全局（活动局部）上下文变量是否是好的做法。

有人有想法/想法/链接吗？知道任何优点和缺点吗？

到目前为止，我发现的一个资源似乎说使用它有好有[坏](http://android-developers.blogspot.com/2009/01/avoiding-memory-leaks.html)

我知道我*可以*使用`this`or `MainActivity.this`，但这不是问题。

..万一你不知道我在说什么，这里有一个现场制作的简单例子：

```
public class MainActivity extends Activity {
    MainActivity _activity;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        _activity = this; // TODO: Find out if this is good practice?
        setContentView(R.layout.activity_main);
    }

    public void onClickButton(View v) {
        Toast.makeText(_activity, "Five boxing wizards", Toast.LENGTH_LONG).show();

        button2.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Toast.makeText(_activity, "asdf", Toast.LENGTH_LONG).show();
            }
        });
    }
} 
```

编辑：评论的另一个附带问题：通过举手，谁实际使用`_activity`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-30T03:20:17.340

这不是好的做法。`this`在大多数情况下简单地使用，以及`MainActivity.this`在创建匿名子类等时使用。

我认为要问自己的正确问题是，“添加这个成员变量对我有什么作用”，或者“有什么我可以做而`_activity`我不能做的事情`this`。我可以告诉你答案是“不”，但你应该自己决定这是否属实。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T03:27:03.670

这不是好的做法。

除了没有实现任何东西（直接使用无法完成`this`）：

*   它使父对象更大（通过一个引用），
*   它可能会慢一些，并且
*   它使您的代码更加脆弱；例如，如果有人不小心为变量分配了不同的值。

我认为代码的可读性*较差*，但您可能不同意这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T03:23:46.140

不，这不好。如果我正在阅读代码，我知道“this”是什么意思，但如果我看到我需要调查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T08:44:27.850

仅当您的外部类不是一项活动但您需要一项活动时，这才有意义。例如，如果你想在自己的文件中定义你的 onclicklistener，你需要传入并存储一个引用（注意不要像注释那样泄漏太多；）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T13:47:05.287

除了创建不必要的引用（因为实例也可以通过`this`关键字 or获得，[根据 Java 编程语言](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-135099.html#367)`MainActivity.this`的代码约定，不鼓励使用下划线前缀的字段名称：9\. 命名约定

# jquery-ui - jQuery UI 主题滚轮 - 以前的版本

> ID：14088013
> 
> 赞同：2
> 
> 时间：2012-12-30T03:16:16.717
> 
> 标签：jquery-ui, themeroller

我需要使用 jQuery UI Theme Roller 与 jQuery UI 1.8.16 一起使用......有没有办法为之前版本的 jQuery UI 生成主题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T18:36:34.220

[http://jqueryui.com/themeroller/](http://jqueryui.com/themeroller/)

当您点击“下载”时，您将能够选择版本 1.8.24 甚至 1.7.3。

# python - 在 App Engine 中不使用数据存储区的情况下获取引用属性的键字符串

> ID：14088022
> 
> 赞同：0
> 
> 时间：2012-12-30T03:19:00.637
> 
> 标签：python, google-app-engine, datastore, referenceproperty

如何在不使用数据存储区获取对象的情况下获取引用属性的键字符串？

我有 2 个由 db.ReferenceProperty 链接的数据存储对象：

```
 class Track(db.Model):
   name   = db.StringProperty()
 class Video(db.Model):
   name  = db.StringProperty()
   track = db.ReferenceProperty(Track, collection_name='video-track') 
```

这使得从给定视频中获取链接轨道变得容易：

```
 video = Video.get(a_video_key_string)
 track = video.track 
```

我可以将这些存储到内存缓存中，以便以后快速访问：

```
 memcache.add(str(video.key()), video)
 memcache.add(str(track.key()), track) 
```

现在我可以从 memcache 中获取视频或曲目：

```
 video = memcache.get(a_video_key_string)
 track = memcache.get(str(video.track.key())) 
```

但是，这会为轨道生成一个数据存储请求，即使我不希望它这样做。具体来说，video.track 请求会自动调用数据存储区来获取 Track 对象，然后调用 key() 来确定密钥字符串。

我想从链接的 ReferenceProperty 中获取键值，而无需实际实例化 Track 对象。你知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T11:39:03.713

正如有人提到的，您可以将属性更改为 KeyProperty，或者您可以使用属性的 property.get_value_for_datastore(obj) 方法来获取密钥而不解析对象。

请参阅文档 [https://developers.google.com/appengine/docs/python/datastore/propertyclass#Property_get_value_for_datastore](https://developers.google.com/appengine/docs/python/datastore/propertyclass#Property_get_value_for_datastore)

通常，您会使用它来获取密钥，例如

键 = myclass.some_property.get_value_for_datastore(some_obj)

所以在你的例子中

track_key = Video.track.get_value_for_datastore(视频)

干杯

# android - Android 中的选项卡 - tabView 或 ActionBar

> ID：14088023
> 
> 赞同：0
> 
> 时间：2012-12-30T03:19:55.773
> 
> 标签：android, android-actionbar, fragment, tabview

我想做这样的事情，[我](https://lh5.ggpht.com/S28Kqz5Xj3ERRPI1SrLxh_dm7kbJ3qaYtCdMvTObH8CzRAlU2QuI4hq_3QewoCA_Ji7x) 已经阅读了关于 TabView 的教程以及稍后关于 ActionBar 和 Fragments 的教程。我很困惑。

请问有人可以告诉我哪个 TabView 或 ActionBar 将允许我在给定的链接中绘制一个 Tab 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:31:04.710

我想你是因为“更多”标签而问的。我相信这是`tab view`肯定的。这个[链接](http://www.androidhive.info/2011/08/android-tab-layout-tutorial/)显示了如何做到这一点。

# java - 我们可以隐藏 URL 的一部分吗？

> ID：14088027
> 
> 赞同：-1
> 
> 时间：2012-12-30T03:20:31.417
> 
> 标签：java, http, url

我想要这样当你点击一个链接时，浏览器只会显示它指向你的文件夹，而不是整个地址。

前任：

```
folder/ 
```

而不是

```
127.0.0.1/folder/ 
```

这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:26:57.680

> 我们可以隐藏 URL 的一部分吗？

不，这是不可能的。[规范](http://www.w3.org/Addressing/URL/url-spec.txt)中明确规定了 URI/URL 的正确形式，并且必须显示路径的“域”部分。

有一些方法可以掩盖页面部分的来源。EG 使用代理。

另一方面，调查为什么*感知到*需要“屠杀一个 URL”可能更有利可图。

# opencl - openCL 在执行大量数据时返回错误 -58

> ID：14088030
> 
> 赞同：1
> 
> 时间：2012-12-30T03:21:26.157
> 
> 标签：opencl, breadth-first-search

我正在编写一个 openCL 代码，以使用 BFS 在图中查找从每个节点到其他节点的最短路径。（这是我正在做的事情的详细信息： [BFS 的最短路径，将代码从 CUDA 移植到 openCL](https://stackoverflow.com/questions/14081307/shortest-paths-by-bfs-porting-a-code-from-cuda-to-opencl)

这就是我如何拆分数据以传递给 clEnqueueNDRangeKernel

```
size_t global_size, local_size;
local_size=1024;
global_size=ceil(e_count/(float)local_size)*local_size;
cl_event sync1;
err = clEnqueueNDRangeKernel(queue, kernel, 1, NULL, 
    &global_size, &local_size, 0, NULL, &sync1); //wait for this to finish (to synchronize); 
```

错误 = clWaitForEvents(1, &sync1)

该代码适用于边数 <= 50000（比其等效的 cpu 版本慢得多）。当我增加边数时，程序刚刚退出并给出错误-58（在 clEnqueueNDRangeKernel 之后）

我正在使用 NVIDIA Geforce 630M。

我怎样才能弄清楚发生了什么以及如何解决问题？

最好的祝福

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T19:52:39.113

错误 -58 是一个 CL_INVALID_EVENT（如您在[cl.h](http://www.khronos.org/registry/cl/api/1.1/cl.h)中看到的），它不是由[clEnqueueNDRangeKernel](http://www.khronos.org/registry/cl/sdk/1.1/docs/man/xhtml/clEnqueueNDRangeKernel.html)返回的，仅由[clWaitForEvents 返回](http://www.khronos.org/registry/cl/sdk/1.1/docs/man/xhtml/clWaitForEvents.html)。所以你可能只检查后一个函数的错误。为了找出实际的错误是什么，您应该检查返回值[clEnqueueNDRangeKernel](http://www.khronos.org/registry/cl/sdk/1.1/docs/man/xhtml/clEnqueueNDRangeKernel.html)与它可以返回的不同状态常量。事实上，您应该对所有主机 OpenCL 函数执行此操作，否则将很难准确确定正在发生的错误类型。

在这种特定情况下，我敢打赌您遇到了与内存相关的错误，例如 CL_OUT_OF_RESOURCES（没有足够的本地或私有内存供您的内核使用）。

希望这可以帮助。

# yii - 自动指向 yii urlManager 中的 id

> ID：14088031
> 
> 赞同：1
> 
> 时间：2012-12-30T03:21:32.017
> 
> 标签：yii

或者换句话说摆脱`/id/`地址栏中的。

我在 urlManager 中指定了以下内容：

`'<controller:\w+>/update/<sid:\w+>'=>'<controller>/<action>'`

这意味着我需要在 url 地址栏中指定以下内容：

```
mysite.com/post/update/sid/s390seret88se 
```

如何配置它，以便我需要的是：

```
mysite.com/post/update/s390seret88se 
```

我不希望 sid 在地址栏中可见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T10:32:11.463

如果您只想隐藏`sid`操作`update`，请执行此操作

```
'<controller:\w+>/update/<sid:\w+>'=>'<controller>/update' 
```

或者，如果您想更新所有操作，请使用

```
'<controller:\w+>/<action:\w+>/<sid:\w+>'=>'<controller>/<action>' 
```

# c++ - 使用 linux 处理内存中的位图图像

> ID：14088032
> 
> 赞同：3
> 
> 时间：2012-12-30T03:21:38.060
> 
> 标签：c++, linux, raspberry-pi

我做了一些研究，但到目前为止还没有发现任何有用的东西。

简而言之，我希望能够在内存中创建位图/画布并使用具有在该位图上绘制原始形状和文本并直接读取内存的功能的 api。这应该完全在内存中完成，不需要窗口系统或 Qt 或 GTK 之类的东西。

为什么？我正在为树莓派写作，并通过 spi 与 256x64 4 位灰度 OLED 显示器连接。到目前为止，这一切都很好。我已经编写了几个用于编写文本等的函数，但我想知道是否已经有一个可以使用的库。我双缓冲显示，所以我只需要操作内存中的图像，然后读取整个图片。

我可以在 Windows 中轻松做到这一点，但不确定在 linux 中做到这一点的最佳方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T05:24:49.703

我用 Image Magick 做类似的事情。它支持位图和 SVG。[http://www.imagemagick.org/script/index.php](http://www.imagemagick.org/script/index.php)

# wordpress - WordPress：本地主机上的自定义默认头像？

> ID：14088040
> 
> 赞同：2
> 
> 时间：2012-12-30T03:22:52.413
> 
> 标签：wordpress, localhost, gravatar, avatar

我正在尝试在 functions.php 中向 WordPress 添加自定义默认头像，但该图像未显示在设置/讨论或网站上的其他位置。该代码有效，因为添加了一个带有自定义字段名称的新单选字段，但图像不会显示。头像不显示是因为我使用的是本地主机吗？

我没有足够的代表来评论类似的问题。

这是代码：

```
add_filter( 'avatar_defaults' , 'wps_new_avatar' );
function wps_new_avatar( $avatar_defaults ){
    $new_avatar = get_stylesheet_directory_uri() . '/images/default-avatar.png';
    $avatar_defaults[$new_avatar] = "Default Avatar";
    return $avatar_defaults;
} 
```

我尝试了其他示例和“Add-New-Default-Avatar”插件，结果相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T18:59:16.670

我遇到了同样的问题并想出了这个完全骇人听闻的解决方案......虽然它有效:)

```
add_filter( 'get_avatar', 'so_14088040_localhost_avatar', 10, 5 );

function so_14088040_localhost_avatar( $avatar, $id_or_email, $size, $default, $alt )
{
    $whitelist = array( 'localhost', '127.0.0.1' );

    if( !in_array( $_SERVER['SERVER_ADDR'] , $whitelist ) )
        return $avatar;

    $doc = new DOMDocument;
    $doc->loadHTML( $avatar );
    $imgs = $doc->getElementsByTagName('img');
    if ( $imgs->length > 0 ) 
    {
        $url = urldecode( $imgs->item(0)->getAttribute('src') );
        $url2 = explode( 'd=', $url );
        $url3 = explode( '&', $url2[1] );
        $avatar= "<img src='{$url3[0]}' alt='' class='avatar avatar-64 photo' height='64' width='64' />";
    }

    return $avatar;
} 
```

**结果：**

[![本地主机头像](../Images/b3b2803be2a01aefa17247c10a4352b4.png)](https://i.stack.imgur.com/5rGCY.png)

* * *

***当然，此过滤器仅用于开发。***

# html - 使用 IndexedDB 存储对象关系

> ID：14088048
> 
> 赞同：2
> 
> 时间：2012-12-30T03:25:43.213
> 
> 标签：html, indexeddb, persistent-object-store

我正在尝试使用 mozilla 学习 HTML5 的 IndexedDB 教程[Using Indexed DB](https://developer.mozilla.org/en-US/docs/IndexedDB/Using_IndexedDB)。

我了解 IndexedDB 是对象存储实现。但是我尝试的所有示例，它们都存储带有键：值对的简单对象。但是我将如何保存嵌套或分层对象？例如父对象并有一个子对象列表。将复杂对象结构处理到索引数据库中的最佳方法是什么？

我知道父子对象的 OOPS 表示或 XML 表示。
我将如何在 IndexedDB 中实现它？任何教程资源都会非常有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T12:44:00.233

> 他们只存储键：值对。但是我将如何保存嵌套对象？

什么是嵌套对象？您可以存储任何可以用 JSON 表示的对象（或更正确地可以通过结构化克隆算法序列化）。那是嵌套对象吗？您可以将任何 OOPS 转换为 JSON，并通过其构造将其取回。对于 XML，只需存储序列化的字符串格式。

如果你提到关系，这是另一个问题。我写了一些[关于 IndexedDB 关系](http://dev.yathit.com/ydn-db/schema.html)的文章。在 IndexedDB 中建模关系不是问题。事实上，它支持得很好。

# java - Java 7 在 IntelliJ 中的多捕获

> ID：14088050
> 
> 赞同：0
> 
> 时间：2012-12-30T03:26:03.170
> 
> 标签：java, intellij-idea

在我的项目中，我使用 Java 7 以及 Java 7 的功能

![在此处输入图像描述](../Images/b9533079f9f3fd18c23838aa70d60bde.png)

但是，当我执行以下操作时，我没有看到任何警告或建议表明多捕获块可以更好地处理异常。

![在此处输入图像描述](../Images/86b7d0688c6354f504ec1c86479e2988.png)

如果我继续进行更改，IntelliJ 不会抱怨，因为它不应该抱怨。

![在此处输入图像描述](../Images/967c6b264a27933a3cb997dc693a0b06.png)

此外，我在检查中看不到任何与此相关的内容： ![在此处输入图像描述](../Images/0eb7021fc053899fce76fe5185d11885.png)

带着这2个问题：

1.  我怎样才能让 IntelliJ 识别这些情况并提出纠正它们？
2.  我如何确保在检查（分析->检查代码）时发现这些类型的情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T15:41:50.037

要启用这些功能，需要启用插件，如图所示

![在此处输入图像描述](../Images/92465d00fdc3a0530b9ecf371d0d7abb.png)

# c++ - 使用 UpdateResource 更新字符串表

> ID：14088057
> 
> 赞同：8
> 
> 时间：2012-12-30T03:27:42.943
> 
> 标签：c++, c, windows, winapi, resources

我在这里问了这个问题 -[通过 UpdateResource 更新 STRING TABLE（添加多个字符串）](https://stackoverflow.com/questions/14054765/updating-string-table-via-updateresource-adding-multiple-strings)

现在我又问了，因为这次我可以为这个问题添加更多细节。

我在过去的一天里一直在尝试这个，或者没有什么真正的用处。我想要的结果是这样的（我在 MSVS 中手动添加了字符串）：如您所见，多个条目，并且它是“干净的”并且可以由程序轻松访问！ ![在此处输入图像描述](../Images/4c13c18af11ada28c6ebcc4a04b6523b.png)

现在，我的消息来源：

```
wstring buffer[5] = {L" Meow",L" I",L" Am",L" A",L" Dinosaur"}; // ignore the string
if (HANDLE hRes = BeginUpdateResource("Output.exe",TRUE))
{
    for (int i = 0; i < 5; i++)
    {
    wchar_t * temp;
    temp = new wchar_t[(buffer[i].length()+1)];
    wcscpy(temp,buffer[i].c_str());
    wcout << temp << endl;
    UpdateResource(hRes,RT_STRING,MAKEINTRESOURCE(1),MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
                   temp, 48); //buffer[i].length()+1
    delete[] temp;
    }
    EndUpdateResource(hRes,FALSE);

} 
```

产生： ![在此处输入图像描述](../Images/1f43dbba9ba759520d1f014a71956a64.png)

这是错误的，因为它似乎只将最后一个字符串添加到表中，而不是之前的字符串！

当我尝试修改源时，MAKEINTRESOURCE(1) 现在是“MAKEINTRESOURCE(i)”，结果如下图所示： ![http://gyazo.com/5fa7a6682d5da2def4683227533b2755.png](../Images/4a010eb37360700caa94e32f5a6c93b5.png) ![http://gyazo.com/e77f6e90cb3dbfe21d07b3d55c931acb.png](../Images/f9baaa12072652a34681790ecb2f5463.png) ![http://gyazo.com/2e632768e2cdfcea8ab9cd08caea9cc8.png](../Images/2fd0386143843c8a8590c57fd513c729.png) ![http://gyazo.com/f9dcd68c671923d8faefce76877bc3be.png](../Images/a08038a98fb5579c64f84bbe9fb8ef97.png)

它添加了所有字符串这一事实取得了成功，但它似乎创建了各种字符串表，这并不是我们想要的。虽然我确实注意到每张图片中的 ID 增加了 16，这可能可以解释一些事情。基本上，我希望将字符串格式化为第一张图片（使用多个字符串），但不知道如何执行此操作。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-30T07:52:24.447

字符串资源不同于任何其他资源格式。它们不存储为单独的条目，而是打包成每组 16 个字符串。第一组存储字符串 0 到 15，第二组存储字符串 16 到 31，依此类推。在上面的屏幕截图中，组显示为左侧树视图中父级下方的第一级。

字符串资源的不​​同之处还在于它们存储为计数的 Unicode 字符串（没有零终止符），而不是零终止的 C 字符串。因此，例如 C 字符串`'T' 'e' 's' 't' '\0'`将存储为`0004 0054 0065 0073 0074`第一个`WORD`表示长度的位置，其余 4`WORD`表示 Unicode 字符。

这种资源格式的结果是，如果组内的字符串 ID 存在间隙，则必须使用零长度字符串来解决丢失的字符串，或者简单地`0000`以资源格式说话。因此，如果您的字符串表包含 ID 为 2 和 5 的字符串，则将有一个包含 16 个条目的组 (1) ：...。`0000` `0000` *`<string 2>`* `0000` `0000` *`<string 5>`* `0000` `0000``0000`

还需要一条信息，即`lpName`在调用中为参数传递哪个资源 ID [`UpdateResource`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648049.aspx "更新资源函数")： 由于字符串资源组只能作为一个整体更新，因此您必须提供组 ID，其中第一个组的 ID 为 1。从字符串 ID 计算组 ID 是用 完成的`groupID = ( strID >> 4 ) + 1`，而组内的相对（从零开始）偏移量是`strOffset = strID % 16`。如果您查看通过传递产生的结果，`MAKEINTRESOURCE(1)`您现在可以看到为什么它以 ID 为 0 进入第 1 组。

将所有部分放在一起，您可以使用以下代码更新字符串资源：

```
void ReplaceStringTable() {

    HANDLE hRes = BeginUpdateResource( _T( "Output.exe" ), TRUE );
    if ( hRes != NULL ) {
        wstring data[] = { L"",   // empty string to skip string ID 0
                           L"Raymond",
                           L"Chen",
                           L"is",
                           L"my",
                           L"Hero!", 
                           // remaining strings to complete the group
                           L"", L"", L"", L"", L"", L"", L"", L"", L"", L""
                         };

        vector< WORD > buffer;
        for ( size_t index = 0;
              index < sizeof( data ) / sizeof( data[ 0 ] );
              ++index ) {

            size_t pos = buffer.size();
            buffer.resize( pos + data[ index ].size() + 1 );
            buffer[ pos++ ] = static_cast< WORD >( data[ index ].size() );
            copy( data[ index ].begin(), data[ index ].end(),
                  buffer.begin() + pos );
        }
        UpdateResource( hRes,
                        RT_STRING,
                        MAKEINTRESOURCE( 1 ),
                        MAKELANGID( LANG_NEUTRAL, SUBLANG_DEFAULT ),
                        reinterpret_cast< void* >( &buffer[ 0 ] ),
                        buffer.size() * sizeof( WORD ) );

        EndUpdateResource( hRes, FALSE );
    }
} 
```

# c++ - 位图算法

> ID：14088058
> 
> 赞同：0
> 
> 时间：2012-12-30T03:27:46.963
> 
> 标签：c++, performance, algorithm, bitmap

数据集是一个二维网格。从实时源更新网格的频率非常高，但处理这些数据需要很长时间。

计时器在固定时间对网格进行采样，以查找标记为脏且需要处理的单元格。

启动处理的开销，称为函数 P() 需要很长时间来引导。P 可以采用一维数组，例如水平或垂直的扫描线。

问题是如何设计一种有效的算法，可以将二维网格上的任意一组脏位“分块”成扫描线，以最大限度地减少调用 P() 的次数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:57:45.163

您可以研究[前缀和](http://en.wikipedia.org/wiki/Prefix_sum)算法的变体，以并行快速扫描位图，隔离脏块，并将指向这些脏块的指针打包到可以传递给`P()`函数的新数组或“扫描线”中。

例如，使用并行线程，对二维数组执行前缀求和，其中脏块的值为 ，`1`非脏块的值为`0`。完成前缀总和后，所有脏块将从`1....N`. 现在，使用一组并行线程，将编号的脏块的指针复制或创建到一个新的“扫描线”数组......来自前缀和的值成为扫描线数组中每个脏块的槽的基本哈希值块应该被引用。

# android - 简单的 RSS 提要无法打开网站

> ID：14088074
> 
> 赞同：0
> 
> 时间：2012-12-30T03:30:44.773
> 
> 标签：android, eclipse, rss

我正在做一个简单的 RSS Feed 教程，不幸的是出了点问题。教程：[http ://www.cse.nd.edu/courses/cse40814/www/RSS_Android.pdf](http://www.cse.nd.edu/courses/cse40814/www/RSS_Android.pdf)

（更详细的教程在达到带宽限制的网站上。）

代码几乎是相同的，只是减去了一些我为了让我更容易识别而更改的变量。我没有复制和粘贴任何内容，所以我可能在打字时犯了错误，但我对此表示怀疑。我的日志唯一告诉我的是它无法打开测试网站。控制台没有识别出任何错误。

日志猫：

```
12-29 21:16:40.062: E/RssReader(614): Couldn't open http://www.southbendtribune.com/ws/content/collection/?collection=sbt_sports_photogalleries&key=d3IwcUN6Ym9NVEV0MWkzcEJsVEU2UFp3bWxmbVRzWFBxbVNyc0pjd1BOWjk4alBLSEpOdHRJVlhXK1dscWhvZg&version=1.0&limit=20 
```

主要活动：

```
package tutorials.baseRSSReader;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class StartMain extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.start_main);

    try {
        // Create RSS reader
        RssReader rssReader = new RssReader("http://www.southbendtribune.com/ws/content/collection/?collection=sbt_sports_photogalleries&key=d3IwcUN6Ym9NVEV0MWkzcEJsVEU2UFp3bWxmbVRzWFBxbVNyc0pjd1BOWjk4alBLSEpOdHRJVlhXK1dscWhvZg&version=1.0&limit=20");

        // Get a ListView from main view
        ListView Items = (ListView) findViewById(R.id.listView1);

        // Create a list adapter
        ArrayAdapter<RssItem> adapter = new ArrayAdapter<RssItem>(this,android.R.layout.simple_list_item_1, rssReader.getItems());
        // Set list adapter for the ListView
        Items.setAdapter(adapter);

        // Set list view item click listener
        Items.setOnItemClickListener(new ListListener(rssReader.getItems(), this));

    } catch (Exception e) {
        Log.e("RssReader", e.getMessage());
    }
    }
} 
```

阅读器：

```
package tutorials.baseRSSReader;

import java.util.List;

import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;

public class RssReader {

    private String rssURL;

    public RssReader(String rssURL)
    {
        this.rssURL = rssURL;
    }

    public List<RssItem> getItems() throws Exception {
        // SAX parse RSS data
        SAXParserFactory factory = SAXParserFactory.newInstance();
        SAXParser saxParser = factory.newSAXParser();

        RssParseHandler handler = new RssParseHandler();

        saxParser.parse(rssURL, handler);

        return handler.getItems();

    }
} 
```

如果需要，我可以列出所有代码，但我认为错误出在这两个类中。我提前感谢您的帮助。

编辑：我使用的提要无效，我现在正在使用：[http ://rss.nytimes.com/services/xml/rss/nyt/HomePage.xml](http://rss.nytimes.com/services/xml/rss/nyt/HomePage.xml)

而且由于我拿到了一个实际的设备，我在日志中又遇到了一个错误：

```
12-29 22:19:02.608: W/global(11470): [DNS] InetAddress.lookupHostByName NOT CACHED, so DNS Query 
```

不过，我在模拟器中看不到这一点。

编辑：刷新清单，某些原因导致它无法识别权限标签，但我不确定是什么......我不再收到“无法打开”错误，但现在我正在尝试制作日志的感觉... AndDev 网站上没有任何内容涵盖 lookupHostByName，但在我看来，它找不到它正在寻找的内容，也许我正在使用的 RSS 提要不起作用。日志猫：

```
12-31 13:34:36.314: W/global(2805): [DNS] InetAddress.lookupHostByName NOT CACHED, So DNS Query
12-31 13:34:36.384: W/global(2805): [DNS] name(rss.nytimes.com), IN, AAAA, CNAME, TTL=4m16s
12-31 13:34:36.384: W/global(2805): [DNS] name(rss.nytimes.com), IN, AAAA, CNAME, TTL=11m44s
12-31 13:34:36.384: W/global(2805): [DNS] name(rss.nytimes.com), IN, A, CNAME, TTL=4m16s
12-31 13:34:36.384: W/global(2805): [DNS] name(rss.nytimes.com), IN, A, CNAME, TTL=11m44s
12-31 13:34:36.384: W/global(2805): [DNS] name(rss.nytimes.com), IN, A, A, TTL=50S
12-31 13:34:36.384: W/global(2805): [DNS] InetAddress.lookupHostByName ttl= 50
12-31 13:34:36.384: W/global(2805): [DNS] AddressCache.customTtl : ttlS= 50
12-31 13:34:36.645: W/global(2805): [DNS] InetAddress.lookupHostByName host = rss.nytimes.com => cached.. 
```

我认为这些是指解析时的错误？我不知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T05:02:15.497

开始使用不同的教程，一些代码是无效和过时的。

# ruby-on-rails - 如何有条件地验证 1-1 模型关系？

> ID：14088076
> 
> 赞同：0
> 
> 时间：2012-12-30T03:30:53.530
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation, relationship

我有一个模型 Person，如果它的类型是“计划的”，则需要一个计划。在它的控制器中（继承自`InheritedResources::Base`）：

```
def create
  super do
    @person.schedule = Schedule.create params[:schedule] if @person.scheduled?
  end
end 
```

问题是，我想验证所有“预定”类型的人都有一个时间表。像这样的东西：

```
validates :schedule, :presence => true, :if => :scheduled? 
```

在 Person 模型中。但是因为调度`belongs_to`了一个人，所以它需要在创建自己之前创建人（所以这个人将有一个 ID）。因此，在我的控制器中，人员验证失败，因为需要稍后创建计划。

Rails 中有什么我不知道的东西可以让我执行这些验证吗？如果我使用`accepts_nested_attributes_for`，那会允许这些验证通过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T07:16:37.057

也许只是不事先创建它？

```
@person.schedule = Schedule.new params[:schedule] if @person.scheduled? 
```

因此@person 和分配的时间表应同时保存**（**事务）。

我认为这是唯一正确的方法。

* * *

**更新**（由于超级：创建概念）：

# 超级动作

```
def create(&block)
  ...
  yield @person if block_given?
  @person.save # line where @person get saved
end 
```

# 继承动作

```
def create
  super do |person|
    person.schedule = Schedule.new params[:schedule] if person.scheduled?
  end
end 
```

# c++ - 使用带有字符串而不是字符的 .getline

> ID：14088081
> 
> 赞同：4
> 
> 时间：2012-12-30T03:31:43.127
> 
> 标签：c++, fstream, ifstream

所以我这里有一些代码从文本文档中读取并将其存储到`char bunz`. 我知道这听起来像一个愚蠢的问题，但我宁愿使用`string`而不是 char。`.getline`如果与 ? 一起使用，将接受字符串`ifstream`？还是我会被迫将字符转换为字符串后缀？

谢谢。

```
ifstream filler("C:\\bunz.txt");

char bunz[30+1];
filler.getline(bunz, 40);
cout<<bunz;
filler.close(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T03:36:26.117

克里斯因将答案作为评论发布而臭名昭著，他*在*. 一旦你使用`std::getline()`，你将*永远不会*回去：

```
ifstream filler("C:\\bunz.txt");
string bunz;
getline(filler, bunz);
cout<<bunz;
filler.close(); 
```

# c# - 多对多表的 PK 首先在代码中映射为 FK 到任何多对多表

> ID：14088084
> 
> 赞同：0
> 
> 时间：2012-12-30T03:32:08.167
> 
> 标签：c#, ef-code-first, entity-framework-4.1

这些是我的表：CFFPart、Disp、CFFPartDisp、Expert、CFFpartDispExpert、CFFPartDisp 在 CFFPart 和 Disp 之间有很多关系。

```
ToTable("Discipline", "dbr");
        Property(t => t.Id).HasColumnName("DispID");
        Property(t => t.Text).HasColumnName("DisPName");

        HasMany(t => t.CFFParts).WithMany().Map(m => m.MapLeftKey("DisPID").MapRightKey("CFFPartID").ToTable("CFFPartDisP", "dbr")); 
```

CFFpartDisPExpert 在 Expert 和 CFFpartDisP 之间有很多关系 我如何首先在代码中为此编写映射？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T21:59:16.943

您必须在模型中公开`CFFPartDisp`为实体类。您不能将其用作问题中的 Fluent 映射之间`CFFPart`的链接表。和`Disp`之间的关系不是多对多的关系（在严格的 EF 意义上）。相反，您必须创建两个作为中间实体的一对多关系。然后，您可以将您与该中间实体之间的关系链接为第三个关系。`CFFPart``Disp``CFFPartDisp``CFFPartDisp``Expert`

该`CFFPartDisp`实体可能如下所示：

```
public class CFFPartDisp
{
    public int ID { get; set; }

    public int CFFPartID { get; set; }
    public CFFPart CFFPart { get; set; }

    public int DispID { get; set; }
    public Disp Disp { get; set; }

    public ICollection<Expert> Experts { get; set; }
} 
```

`CFFPart`和实体需要引用的`Disp`集合`CFFPartDisp`：

```
public class CFFPart
{
    public int ID { get; set; }

    public ICollection<CFFPartDisp> CFFPartDisps { get; set; }
}

public class Disp
{
    public int ID { get; set; }

    public ICollection<CFFPartDisp> CFFPartDisps { get; set; }
} 
```

并且还`Expert`需要一个集合来建立和`CFFPartDisp`之间的多对多关系：`CFFPartDisp``Expert`

```
public class Expert
{
    public int ID { get; set; }

    public ICollection<CFFPartDisp> CFFPartDisps { get; set; }
} 
```

使用这些实体，您可以创建三个关系：

```
modelBuilder.Entity<CFFPartDisp>()
    .HasRequired(cpd => cpd.CFFPart)
    .WithMany(cp => cp.CFFPartDisps)
    .HasForeignKey(cpd => cpd.CFFPartID);

modelBuilder.Entity<CFFPartDisp>()
    .HasRequired(cpd => cpd.Disp)
    .WithMany(cp => cp.CFFPartDisps)
    .HasForeignKey(cpd => cpd.DispID);

modelBuilder.Entity<CFFPartDisp>()
    .HasMany(cpd => cpd.Experts)
    .WithMany(e => e.CFFPartDisps)
    .Map(m =>
    {
        m.MapLeftKey("CFFPartDispID");
        m.MapRightKey("ExpertID");
        m.ToTable("CFFpartDisPExpert");
    }); 
```

# mysql - 在 MySQL 中查找加权地理中点

> ID：14088085
> 
> 赞同：1
> 
> 时间：2012-12-30T03:32:49.510
> 
> 标签：mysql, latitude-longitude

我试图找到一大组坐标的地理中心点，按房屋要价加权。

找到地理中心点的一种简单、非加权的方法正在发挥作用：

```
SELECT
    avg(LMD_MP_Latitude) as AVG_LAT,  
    avg(LMD_MP_Longitude) as AVG_LON

FROM  `great_users`.`usage` 
```

*请注意，所有结果都在 25 英里范围内，因此[球面问题很小](http://www.geomidpoint.com/calculation.html)。*

上面的查询有效，我得到一个坐标，它是所有属性的中心。

现在，我想对结果进行加权`L_AskingPrice`。更昂贵的行将有更多的“重力”，并且应该将中心点移向更昂贵的社区。

然而，下面的查询将中心点移动了几米远，考虑到超过 4,000 的行数和非常不同的输入，这感觉不正确。

```
SELECT 
    SUM(LMD_MP_Latitude * L_AskingPrice) / SUM(L_AskingPrice) AS Avg_Lat, 

    SUM(LMD_MP_Longitude * L_AskingPrice) / SUM(L_AskingPrice) AS Avg_Lon

    FROM `great_users`.`usage` 
```

我想知道权重（从 50,000 到 4,000,000 的整数）是否超过了 34.X 和 -82.X 的 GPS 坐标

我尝试将`L_AskingPrice`by 值从 100k 划分为 7B，但它似乎没有动针。但是，尽管我尽了最大努力，但我可能还是搞砸了操作顺序。

样品表：

LMD_MP_Latitude | LMD_MP_经度 | L_AskingPrice

34.83701 | -82.432411 | 175000

# facebook - 标签字段在使用 facebook api 和 php 时返回 NULL

> ID：14088086
> 
> 赞同：0
> 
> 时间：2012-12-30T03:32:57.717
> 
> 标签：facebook, facebook-graph-api, facebook-php-sdk

我正在使用 facebook php api 来获取用户的标记图像和标签。我具有以下用户权限：

read_stream、publish_stream、user_birthday、user_location、user_work_history、user_hometown、user_photos、friends_photos、user_about_me、user_videos、friends_actions.video、friends_video

我能够成功调用所有内容并获取标记的图像。但是，当我调用时：

```
$tagged_photos=$facebook->api('me/photos');

foreach ($tagged_photos['data'] as $taggedpics)
     {
       var_dump($taggedpics['tags']); // This Returns NULL :(
       friend_id=$taggedpics['id']; // Returns some value ...
     } 
```

图像、id、时间等其他字段具有预期值。

但是，当我检查`/me/photos`图形资源管理器时，它会返回标签。

我检查了权限并尽我所能。非常感谢任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T08:12:58.983

Never Mind ,found out my mistake . I was missing the user_photo_video_tags permission.In case this helps,Check the debug access token in the graph explorer to see what permissions you need

# amazon-web-services - DynamoDB 和 UpdateItem

> ID：14088088
> 
> 赞同：0
> 
> 时间：2012-12-30T03:33:38.977
> 
> 标签：amazon-web-services, amazon-dynamodb

从 AWS 上的阅读来看，DynamoDB UpdateItem 似乎能够将属性添加到现有项目。

因此，例如，如果我有一个项目 - 主键：UserID，并且它有一些属性，如成员：1 成员：2 成员：3

我可以添加成员：4 吗？

***属性的关键成员是否需要唯一？如果是这样，当项目的内容只是成员编号列表（他们在系统上的朋友）时，是否有办法使其独一无二？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-25T07:13:22.513

在 Dynamodb 中，主键被命名为“哈希键”。这是独一无二的。我们必须在创建表时定义什么是哈希键（只有一个）。在这种情况下说

哈希键是用户 ID。Dynamodb 的优点是我们可以在现有属性中添加任意数量的属性。示例 UserId 1 我们有 member1 member2 member3 然后对于用户 ID 2 我们可以有 member, member2 , member3, member4,.... 我们不需要在 Dynamo-db 中创建表时创建新列或属性为要更新的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-03T15:26:02.420

您可以根据需要添加新属性。

您应该更喜欢使用“数字集”attr 类型来存储朋友成员 ID，而不是为每个朋友添加新的 attr。

**但不要忘记限制**

与单个项目关联的属性数量没有明确限制，但项目的总大小（包括所有属性名称和属性值）为 64KB。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T08:46:26.997

是的，DynamoDB 支持将字符串、数字和二进制集作为属性。

[http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DataModel.html#DataModelDataTypes](http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DataModel.html#DataModelDataTypes)：

> 字符串、数字和二进制集
> 
> Amazon DynamoDB 还支持数字集、字符串集和二进制集。多值属性，例如书籍项目中的作者属性和产品项目的颜色属性是字符串集类型属性的示例。请注意，因为它是一个集合，所以集合中的值必须是唯一的。属性集没有排序；不保留集合中返回的值的顺序。请注意，Amazon DynamoDB 不支持空集。

# python - python：for循环紧凑表示

> ID：14088092
> 
> 赞同：3
> 
> 时间：2012-12-30T03:34:24.180
> 
> 标签：python, numpy

蟒蛇，麻木

有没有更紧凑的方法来操作数组元素，而不必使用标准的 for 循环。？

例如，考虑下面的函数：

```
filterData(A):
    B = numpy.zeros(len(A));
    B[0] = (A[0] + A[1])/2.0;
    for i in range(1, len(A)): 
        B[i] = (A[i]-A[i-1])/2.0;
    return B; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T03:38:53.163

Numpy 有一个[diff 运算符](http://docs.scipy.org/doc/numpy/reference/generated/numpy.diff.html)，适用于 numpy 数组和 Python 原生数组。您可以将代码重写为：

```
def filterData(A):
    B = numpy.zeros(len(A));
    B[1:] = np.diff( A )/2.0
    B[0] = (A[0] + A[1])/2.0;
    return B 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T14:57:42.767

还有[`numpy.ediff1d`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.ediff1d.html#numpy.ediff1d)，它允许您使用`to_end`and`to_begin`参数显式地预先或附加到差异，例如：

```
>>> import numpy as np
>>> a = np.arange(10.)
>>> diff = np.ediff1d(a,to_begin = a[:2].sum()) / 2.
>>> diff
array([ 0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5,  0.5])
>>> diff.size
10 
```

# ember.js - 在 Ember Data 中，如何仅查找已加载的记录？

> ID：14088094
> 
> 赞同：1
> 
> 时间：2012-12-30T03:34:49.330
> 
> 标签：ember.js, ember-data

根据文档：

[http://emberjs.com/guides/ember-data-lifecycle/](http://emberjs.com/guides/ember-data-lifecycle/)

如果未加载，Ember 数据将自动向持久层查找记录，我如何只加载`find`甚至`findAll`已加载的记录？

除了创建加载记录的非持久列表，并在那里查找记录？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T07:32:13.267

您可以通过过滤器执行此操作：

```
App.Post.filter(function(post) { return post.get('isLoaded'); }); 
```

`App.Post`这将只保留已加载的记录的最新数组。加载新记录时，它会自动更新（并更新绑定到它的任何 DOM）。

# android - 如何将 GPS 和网络位置坐标发送到服务器（静态 IP）？

> ID：14088095
> 
> 赞同：2
> 
> 时间：2012-12-30T03:34:58.610
> 
> 标签：android, gps, send

我是 Android 开发的初学者。我想制作一个 android 应用程序，它将 GPS 和网络位置（纬度和经度）发送到我的服务器（静态 IP）。我找到了以下代码并且它成功运行，在服务器端已经制作的应用程序接收数据（现在它与客户端应用程序无关）

当我在我的 Android 应用程序上单击“发送位置”按钮时，我的服务器收到的数据。

*   获取 /31.4244456/74.7349772 HTTP/1.1

*   主机：180.178.169.77:6081

*   连接：保持活动状态

*   用户代理：Apache-HttpClient/不可用（java 1.4）

180.178.169.77是我的服务器IP，6081是端口

此时一切正常，我几乎实现了我想要的，但我面临的真正问题是我的 Android 应用程序在将此数据发送到服务器后挂起并崩溃。如果有人有想法，请解决我的问题。

我从这里找到了代码。 [http://www.gideondsouza.com/blog/how-to-get-the-current-location-address-and-send-it-to-a-server-on-android#.UNLbTOT0Dxo](http://www.gideondsouza.com/blog/how-to-get-the-current-location-address-and-send-it-to-a-server-on-android#.UNLbTOT0Dxo)

这是我的 AddressActivity.java

```
package com.gideon.address;

import java.io.IOException;
import java.util.List;
import java.util.Locale;

import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import android.app.Activity;
import android.content.Context;
import android.location.Address;
import android.location.Geocoder;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;

public class AddressActivity extends Activity {
/** Called when the activity is first created. */
String lat="", lon="";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button btnLocation = (Button)findViewById(R.id.btnLocation);
    btnLocation.setOnClickListener(new OnClickListener() {
        public void onClick(View arg0) {
            // Acquire a reference to the system Location Manager
            LocationManager locationManager = (LocationManager) AddressActivity.this.getSystemService(Context.LOCATION_SERVICE);
            // Define a listener that responds to location updates
            LocationListener locationListener = new LocationListener() {
                public void onLocationChanged(Location location) {
                    // Called when a new location is found by the network location provider.
                    lat = Double.toString(location.getLatitude());
                    lon = Double.toString(location.getLongitude());
                    TextView tv = (TextView) findViewById(R.id.txtLoc);
                    tv.setText("Your Location is:" + lat + "--" + lon);
                }

                public void onStatusChanged(String provider, int status, Bundle extras) {}
                public void onProviderEnabled(String provider) {}
                public void onProviderDisabled(String provider) {}
            };
            // Register the listener with the Location Manager to receive location updates
            locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, locationListener);
        }
    });

    Button btnSend = (Button)findViewById(R.id.btnSend);
    btnSend.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            postData(lat, lon);
        }
    });

    Button btnAdd = (Button)findViewById(R.id.btnAddress);
    btnAdd.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            TextView tv = (TextView)findViewById(R.id.txtAddress);
            tv.setText(GetAddress(lat, lon));
        }
    });

}

public void postData(String la, String lo) {
    // Create a new HttpClient and Post Header
    HttpClient httpclient = new DefaultHttpClient();
    //HttpGet  htget = new HttpGet("http://myappurl.com/Home/Book/"+la+"/"+lo);
    HttpGet  htget = new HttpGet("http://180.178.169.77:6081/"+la+"/"+lo);

    try {
        // Execute HTTP Post Request
        HttpResponse response = httpclient.execute(htget);
        String resp = response.getStatusLine().toString();
        Toast.makeText(this, resp, 5000).show();

    } catch (ClientProtocolException e) {
        Toast.makeText(this, "Error", 5000).show();
    } catch (IOException e) {
        Toast.makeText(this, "Error", 5000).show();
    }
} 
public String GetAddress(String lat, String lon)
{
    Geocoder geocoder = new Geocoder(this, Locale.ENGLISH);
    String ret = "";
    try {
        List<Address> addresses = geocoder.getFromLocation(Double.parseDouble(lat), Double.parseDouble(lon), 1);
        if(addresses != null) {
            Address returnedAddress = addresses.get(0);
            StringBuilder strReturnedAddress = new StringBuilder("Address:\n");
            for(int i=0; i<returnedAddress.getMaxAddressLineIndex(); i++) {
                strReturnedAddress.append(returnedAddress.getAddressLine(i)).append("\n");
            }
            ret = strReturnedAddress.toString();
        }
        else{
            ret = "No Address returned!";
        }
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        ret = "Can't get Address!";
    }
    return ret;
}
} 
```

这是我的 AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.gideon.address"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.INTERNET"/>
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".AddressActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T03:42:42.423

将`postData`主线程移到辅助线程。在这里查看`Async`任务示例：http: [//developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T07:22:48.463

你的问题是

```
 public void onClick(View v) {
            postData(lat, lon);
        } 
```

在 UI 线程上运行。这意味着当您执行“发布”操作时，UI 不会刷新并且无法访问 - 您的应用会卡住，直到发布结束。

您需要执行以下操作：

```
 public void onClick(View v) {
        PostAsyncTask postAsyncTask = new PostAsyncTask();
        postAsyncTask.execute();
    }

 private class PostAsyncTask extends AsyncTask<URL, Integer, Long> {
 protected Long doInBackground(URL... urls) {
     postData(lat, lon);
     return 0;
 }

 protected void onPreExecute() {
     // show progress dialog
 }

     protected void onPostExecute(Long result) {
         // hide  progress dialog
     }
 } 
```

# linux - 尝试在具有多个站点的服务器上编辑 crontab

> ID：14088098
> 
> 赞同：0
> 
> 时间：2012-12-30T03:35:44.053
> 
> 标签：linux, unix, crontab, vi

我编辑了我的 crontab，但旧设置仍然运行。这是我的 crontab 清单：

```
[root@semanticvalley etc]# for user in $(cut -f1 -d: /etc/passwd); do crontab -u $user -l; done
no crontab for root
no crontab for bin
no crontab for daemon
no crontab for adm
no crontab for lp
no crontab for sync
no crontab for shutdown
no crontab for halt
no crontab for mail
no crontab for news
no crontab for uucp
no crontab for operator
no crontab for games
no crontab for gopher
no crontab for ftp
no crontab for nobody
no crontab for dbus
no crontab for vcsa
no crontab for mailnull
no crontab for smmsp
no crontab for sshd
no crontab for apache
## ----- Begin HSPC generated text. Do not edit! ----- another_site.com
## ----- End HSPC generated text. ----- another_site.com

MAILTO=''
## ----- Begin HSPC generated text. Do not edit! ----- comehike.com
MAILTO='alex.genadinik@gmail.com'
30 13 * * * php /home/webadmin/comehike.com/html/utils/post_hike.php
## ----- End HSPC generated text. ----- comehike.com

MAILTO=''
no crontab for rpc
no crontab for popa3d
no crontab for pcap
no crontab for nscd
no crontab for rpm
no crontab for named
no crontab for mysql
no crontab for xfs
no crontab for spfmilt
no crontab for genadinik
## ----- Begin HSPC generated text. Do not edit! ----- somesite.com
## ----- End HSPC generated text. ----- somesite.com 
```

但是我为其设置新 crontab 的站点甚至没有出现在此列表中。我必须更改/编辑什么才能正确设置？

澄清一下，这是旧的 crontab：

```
MAILTO=''
## ----- Begin HSPC generated text. Do not edit! ----- comehike.com
MAILTO='alex.genadinik@gmail.com'
30 13 * * * php /home/webadmin/some_url/some_path.php
## ----- End HSPC generated text. ----- comehike.com 
```

我设置的新 crontab 甚至没有出现在这里。但是，如果我执行 cat /etc/crontab ，那么新设置就会出现。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T03:54:42.630

编辑 crontab 的正确方法是：

```
crontab -e 
```

如果您想从 shell 或用户脚本中执行此操作，您还可以执行以下操作：

```
less setting_file | crontab -u user 
```

其中 setting_file 是包含新设置的文件。我希望这会有所帮助。

# wpf - 如何在 wpf 的整个应用程序中使用 loginid 值

> ID：14088104
> 
> 赞同：0
> 
> 时间：2012-12-30T03:38:07.490
> 
> 标签：wpf

我有一个应用程序，其中用户 ID 应该在 Wpf 中的所有表单中都可用。我写了这样的代码

在form1我这样写

```
 var login =
                    context.Logins.FirstOrDefault(
                        x => x.EmailAddress == email && x.Password == password);
                if (login != null)
                {
                    fp.Show();
                    Application.Current.Properties["UserId"] = login.Id; 
                    Close();
                } 
```

在 form2 中，我应该可以访问用户 ID，所以我编写了这样的代码

```
 var  userid = (int) Application.Current.Properties["UserId"];
        int id = userid; 
```

我收到系统空引用异常：{“对象引用未设置为对象的实例。”}

任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T04:06:00.087

它在一个简单的配置中对我有用，你的代码中还有我不确定的其他事情。这是我的测试代码，看看你能不能破解它。我使用计时器只是为了验证关闭主窗体并没有终止设置。我不确定您的表单 fp 是否是您调用 form2 的表单，但如果是，您需要在显示之前保存您的设置，而不是像现在这样。

**主窗口.xaml.cs**

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        Application.Current.Properties["UserId"] = 12;

    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        Window1 win1 = new Window1();
        win1.Show();
        Close();
    }
} 
```

**窗口1**

```
public partial class Window1 : Window
{
    System.Windows.Threading.DispatcherTimer tmr = new System.Windows.Threading.DispatcherTimer();
    public Window1()
    {
        InitializeComponent();
        tmr.Interval = new TimeSpan(0, 0, 10);
        tmr.Tick += new EventHandler(tmr_Tick);
        tmr.Start();
    }

    void tmr_Tick(object sender, EventArgs e)
    {
        tmr.Stop();
        var userid = (int)Application.Current.Properties["UserId"];
        int id = userid;
        this.Title = Application.Current.Properties["UserId"].ToString();
    }

} 
```

# ios - 故事板 - 弹出框的委托

> ID：14088108
> 
> 赞同：2
> 
> 时间：2012-12-30T03:39:56.073
> 
> 标签：ios, storyboard, popover

我正在使用popover，popover里面有一个uitableview，我想在点击uitableview时获得价值，我在里面创建委托

弹出框.h

```
@class PopOverVCDelegate;
@protocol PopOverVCDelegate <NSObject>

-(void)getValue:(int)value;

@end

@interface ..
{
@property(nonatomic)id<PopOverVCDelegate> delegate;
}
@end 
```

弹出框.m

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [self.delegate getValue:[indexPath row]];
} 
```

和 mainclass 接收委托是

主类.h

```
#import "PopOverVC.h"
@interface MainClassVC : UIViewController<PopupCatchupVCDelegate,UIPopoverControllerDelegate>
{} 
```

主类.m

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"showPopover"])
    {
        [[segue destinationViewController] setDelegate:self];
        UIPopoverController *p = [(UIStoryboardPopoverSegue *)segue popoverController];
        p.popoverBackgroundViewClass = [CustomPopoverBackground class];
        self.popoverController = p;        
        popoverController.delegate = self;
    }
}

-(void)getValue:(int)value
{
    NSLog(@"adsf-%d",value);
} 
```

我没有从代表那里得到任何价值。任何人都可以帮助我，我使用情节提要并从推送导航中调用弹出框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:48:37.703

在 popover.h 你声明了协议 PopOverVCDelegate & 在 mainclass.h 你正在实现 PopupCatchupVCDelegate 协议。您的主类应该向 PopOverVCDelegate 确认。

```
@interface MainClassVC : UIViewController<PopOverVCDelegate, PopupCatchupVCDelegate, UIPopoverControllerDelegate> 
```

此外，您应该在调用它之前检查委托方法是否已实现 -

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if([self.delegate respondsToSelector:@selector(getValue:)])
        [self.delegate getValue:[indexPath row]];
} 
```

**编辑**

我查看了故事板并注意到，您的委托没有设置为正确的控制器。您正在将委托设置为 p(UIPopoverController)，您应该将其设置为 popover 的 contentViewController(PopOver)。

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"idenPopover"])
    {
        [[segue destinationViewController] setDelegate:self];
        UIPopoverController *p = [(UIStoryboardPopoverSegue *)segue popoverController];
        p.popoverBackgroundViewClass = [CustomPopoverBackground class];
        self.popoverController = p;
        self.popoverController.delegate = self;

        //set delegate to PopOver 
        UINavigationController *navigationController = (UINavigationController*)p.contentViewController;
        PopOver *popOver = (PopOver*)navigationController.topViewController;
        [popOver setDelegate:self];
    }
} 
```

# spring - 加载资源失败：服务器响应状态为 406（不可接受）

> ID：14088115
> 
> 赞同：3
> 
> 时间：2012-12-30T03:41:25.797
> 
> 标签：spring, dependency-injection, spring-3

根据我之前的[问题，由于这个](https://stackoverflow.com/q/14060314/1391249)[问题](https://stackoverflow.com/q/13686757/1391249)中提到的原因，我已经将 Spring 框架从 3.0.2 升级到了[3.2.0](http://www.springsource.org/download/community)（Spring 3.0.2 导致上传多个文件时出现问题，因为存在长期存在的错误）。

使用较新的版本，一切正常，但 JSON 除外。响应时，谷歌浏览器显示此错误。

> 加载资源失败：服务器响应状态为 406（不可接受）

我试图按照文件中的[说明](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-multiple-representations)`dispatcher-servlet.xml`进行操作，例如，

```
<bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
  <property name="mediaTypes">
    <map>
      <entry key="atom" value="application/atom+xml"/>
      <entry key="html" value="text/html"/>
      <entry key="json" value="application/json"/>
    </map>
  </property>
  <property name="viewResolvers">
    <list>
      <bean class="org.springframework.web.servlet.view.BeanNameViewResolver"/>
      <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix" value="/WEB-INF/jsp/"/>
        <property name="suffix" value=".jsp"/>
      </bean>
    </list>
  </property>
  <property name="defaultViews">
    <list>
      <bean class="org.springframework.web.servlet.view.json.MappingJackson2JsonView" />
    </list>
  </property>
</bean> 
```

**并在保存 xml 文件时**以以下异常结束。

> java.lang.ClassCastException java.lang.String 无法转换为 org.springframework.http.MediaType

* * *

文件完整内容`dispatcher-servelet.xml`如下，有需要的可以看看。

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"

       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mvc="http://www.springframework.org/schema/mvc"

       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
       http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <context:component-scan base-package="controller" />
    <context:component-scan base-package="validatorbeans" />
    <mvc:annotation-driven />

<bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
  <property name="mediaTypes">
    <map>
      <entry key="atom" value="application/atom+xml"/>
      <entry key="html" value="text/html"/>
      <entry key="json" value="application/json"/>
    </map>
  </property>
  <property name="viewResolvers">
    <list>
      <bean class="org.springframework.web.servlet.view.BeanNameViewResolver"/>
      <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix" value="/WEB-INF/jsp/"/>
        <property name="suffix" value=".jsp"/>
      </bean>
    </list>
  </property>
  <property name="defaultViews">
    <list>
      <bean class="org.springframework.web.servlet.view.json.MappingJackson2JsonView" />
    </list>
  </property>
</bean>

    <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping" />
    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"/>
    <bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <prop key="index.htm">indexController</prop>

            </props>
        </property>
    </bean>

<!--<bean id="viewResolver"
       class="org.springframework.web.servlet.view.InternalResourceViewResolver"
       p:prefix="/WEB-INF/jsp/"
       p:suffix=".jsp" />

       Initially this bean was mentioned like this was given a comment. It is specified as above-->

    <bean name="indexController"
          class="org.springframework.web.servlet.mvc.ParameterizableViewController"
          p:viewName="index" />
</beans> 
```

如何解决此异常？这个例外的谷歌搜索[结果](http://www.google.co.in/#hl=en&tbo=d&sclient=psy-ab&q=java.lang.ClassCastException:+java.lang.String+cannot+be+cast+to+org.springframework.http.MediaType&oq=java.lang.ClassCastException:+java.lang.String+cannot+be+cast+to+org.springframework.http.MediaType&gs_l=hp.3..0.1196.1196.0.3238.1.1.0.0.0.0.219.219.2-1.1.0.les;..0.0...1c.1.hTbMloILKOw&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.&bvm=bv.1355534169,d.bmk&fp=aaf6447fe4e1119c&bpcl=40096503&biw=1366&bih=677)无法给我带来具体的参考。

* * *

**编辑：**

根据[这个](http://forum.springsource.org/showthread.php?133343-3-1-2-gt-3-2-issue-with-ContentNegotiatingViewResolver&p=433755#post433755)配置，我现在有以下 XML 映射。

```
<bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
    <property name="order" value="1" />
    <property name="contentNegotiationManager">
        <bean class="org.springframework.web.accept.ContentNegotiationManager">
            <constructor-arg>
                <bean class="org.springframework.web.accept.PathExtensionContentNegotiationStrategy">
                    <constructor-arg>
                        <map>
                            <entry key="json" value="application/json"/>
                            <entry key="xml" value="application/xml"/>
                            <!--<entry key="html" value="text/html"/>
                            <entry key="atom" value="application/atom+xml"/-->
                        </map>
                    </constructor-arg>
                </bean>
            </constructor-arg>
        </bean>
    </property>

    <property name="defaultViews">
        <list>
            <!-- JSON View -->
            <bean class="org.springframework.web.servlet.view.json.MappingJacksonJsonView" />

            <!-- XML View -->
            <bean class="org.springframework.web.servlet.view.xml.MarshallingView">
                <constructor-arg>
                    <bean class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
                        <property name="packagesToScan">
                            <list>
                                <value>documentLoader.domain</value>
                            </list>
                        </property>
                    </bean>
                </constructor-arg>
            </bean>
        </list>
    </property>
</bean> 
```

* * *

```
<bean id="viewResolver"
      class="org.springframework.web.servlet.view.InternalResourceViewResolver"
      p:prefix="/WEB-INF/jsp/"
      p:suffix=".jsp" /> 
```

消失了`ClassCastException`，但 JSON 仍然不起作用。我仍然遇到同样的错误，

> 加载资源失败：服务器响应状态为 406（不可接受）

还剩下什么？仍然可以看到一个[jira问题。](https://jira.springsource.org/browse/SPR-10119?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel)

**注意：**我在类路径上有 [Jackson 1.9.8](http://jackson.codehaus.org/1.9.8/jackson-all-1.9.8.jar)（它的下载[页面](http://wiki.fasterxml.com/JacksonDownload)）库。对于 Jackson 2.1.1，在运行时抛出以下异常不起作用。

> org.springframework.beans.factory.BeanCreationException：在 ServletContext 资源 [/WEB-INF/dispatcher-servlet.xml] 中定义名称为“org.springframework.web.servlet.view.ContentNegotiatingViewResolver#0”的 bean 创建错误：无法创建内部bean 'org.springframework.web.servlet.view.json.MappingJacksonJsonView#bb314f' 类型 [org.springframework.web.servlet.view.json.MappingJacksonJsonView]，同时使用键 [0] 设置 bean 属性'defaultViews'；嵌套异常是 org.springframework.beans.factory.BeanCreationException: Error Creating bean with name 'org.springframework.web.servlet.view.json.MappingJacksonJsonView#bb314f' 在 ServletContext 资源 [/WEB-INF/dispatcher-servlet.xml ]: bean 实例化失败；嵌套异常是 org.springframework.beans。**嵌套异常是 java.lang.NoClassDefFoundError: org/codehaus/jackson/map/ObjectMapper**

因为 Jackson 2.1.1`ObjectMapper`在另一个包中有这个类 - `com.fasterxml.jackson.databind.ObjectMapper`. 方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T21:14:48.767

最好在 MediaType 类中引用常量

```
<constructor-arg>
    <map>
        <entry key="json">
            <util:constant static-field="org.springframework.http.MediaType.APPLICATION_JSON_VALUE" />
        </entry>
        <entry key="xml">
            <util:constant static-field="org.springframework.http.MediaType.APPLICATION_ATOM_XML_VALUE" />
        </entry>
    </map>
</constructor-arg> 
```

您还需要包含 util 架构

```
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:util="http://www.springframework.org/schema/util"
xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd
    http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.2.xsd"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-01T11:34:35.680

您应该添加对 ContentNegotiatingViewResolver 的引用。代替

```
<mvc:annotation-driven /> 
```

经过

```
<mvc:annotation-driven content-negotiation-manager="contentNegotiationManager" /> 
```

并将 id 添加到 bean 定义中：

```
<bean id="contentNegotiationManager"  class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver"> 
```

此外，您需要将架构位置更新为 3.2。

```
xsi:schemaLocation="
    http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T03:50:47.090

当您尝试将`mediaTypes`属性设置为时会发生异常，`ContentNegotiatingViewResolver`因为该值不是您想象的“text/html”之类的纯字符串。这是另一种类型[`MediaType`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/http/MediaType.html)

而是指定这样的内容。

```
<bean id="atomXml" class="org.springframework.http.MediaType">
<constructor-arg><value><![CDATA[application/atom+xml]]></value></constructor-arg>
</bean> 
```

和其他豆类类似。

* * *

当你想设置 mediaTypes 时，将上面创建的 bean 注入到`ContentNegotiatingViewResolver`.

```
<property name="mediaTypes">
    <map>
      <entry key="atom" value-ref="atomXml"/>
    </map>
</property> 
```

定义其他相关 bean 并修复与上述配置相关的任何语法问题留给您作为练习。

# android - 如何使用 Json 字符串？

> ID：14088119
> 
> 赞同：1
> 
> 时间：2012-12-30T03:43:15.840
> 
> 标签：android, asp.net, json, web-services

以下是**尝试返回 JSON 字符串的 asp Web 服务输出**（不确定是否返回 JSON 字符串）。

![在此处输入图像描述](../Images/a5ee13e7babd1bb9e6a20fbbe0a5ce0c.png)

在 android 应用程序使用此字符串后，字符串如下：

**GetCustomerListResponse{GetCustomerListResult=[{"VehicleID":"KL-9876","VehicleType":"Nissan","VehicleOwner":"Sanjiva"}];}**

[我很确定它不是 json 字符串]。

我想知道我应该进行哪些更改，以便 android 程序使用 json 字符串。

提前非常感谢，下面提供了我完整的 aspx 代码和 android 代码。

**安卓代码：**

```
 package com.example.objectpass;

        import android.app.Activity;
        import android.os.Bundle;
        import android.util.Log;
        import android.widget.ArrayAdapter;
        import android.widget.Spinner;
        import android.widget.TextView;

        import org.json.JSONArray;
        import org.json.JSONObject;
        import org.ksoap2.*;
        import org.ksoap2.serialization.SoapObject;
        import org.ksoap2.serialization.SoapPrimitive;
        import org.ksoap2.serialization.SoapSerializationEnvelope;
        import org.ksoap2.transport.*;

        public class MainActivity extends Activity {
            TextView resultA;
            Spinner spinnerC;

            @Override
            public void onCreate(Bundle savedInstanceState) {
                String[] toSpinnerSum;
                toSpinnerSum = new String[9];

                super.onCreate(savedInstanceState);
                setContentView(R.layout.activity_main);
                spinnerC = (Spinner) findViewById(R.id.spinner1);
                resultA = (TextView) findViewById(R.id.textView2);

                final String NAMESPACE = "http://tempuri.org/";
                final String METHOD_NAME = "GetCustomerList";
                final String SOAP_ACTION = "http://tempuri.org/GetCustomerList";
                final String URL = "http://192.168.1.100/WebService4/Service1.asmx";

                SoapObject Request = new SoapObject(NAMESPACE, METHOD_NAME);
                SoapSerializationEnvelope soapEnvelope = new SoapSerializationEnvelope(
                        SoapEnvelope.VER11);
                soapEnvelope.dotNet = true;
                soapEnvelope.setOutputSoapObject(Request);
                AndroidHttpTransport aht = new AndroidHttpTransport(URL);

                try {
                    aht.call(SOAP_ACTION, soapEnvelope);
                    SoapObject response = (SoapObject) soapEnvelope.bodyIn;

                    JSONArray jArray = new JSONArray();

                    resultA.setText(response.toString());

                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        } 
```

**ASP 网络服务代码：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Services;
using System.Web.Script.Services;
using Newtonsoft.Json;

namespace WebService4
{
    /// <summary>
    /// Summary description for Service1
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    // [System.Web.Script.Services.ScriptService]
    public class Service1 : System.Web.Services.WebService
    {

        [WebMethod]
       [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
        public string GetCustomerList()
        {
            Vehicle vehi = simpleCase();
            List<Vehicle> newL = new List<Vehicle> { vehi };
            string output = JsonConvert.SerializeObject(newL);
           // return newL;
            return output;
        }

        [WebMethod]
        public Vehicle simpleCase()
        {
            Vehicle obj = new Vehicle();
            obj.VehicleID = "KL-9876";
            obj.VehicleType = "Nissan";
            obj.VehicleOwner = "Sanjiva";
            return obj;
        }
    }

    public class Vehicle
    {
        public string VehicleID { get; set; }
        public string VehicleType { get; set; }
        public string VehicleOwner { get; set; }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T09:44:27.860

您的 WCF 服务是 XML 和 JSON 的混合体。您需要将其更改为返回纯 JSON 的服务。

`http://localhost:49476/JsonService.svc/vehiclelist`然后，您可以使用 URL和访问您的 JSON 方法`http://localhost:49476/JsonService.svc/randomvehicle`（端口号在您的情况下会有所不同）。只需在您的网络浏览器中尝试即可。

您可能还想看看这个[答案](https://stackoverflow.com/questions/835839/client-configuration-to-consume-wcf-json-web-service/4535043#4535043)。除了这个答案，它还展示了如何使用 POST 请求向服务发送大量数据。

请注意，我没有为 WCF 服务使用任何 JSON 类。相反，W

**IJsonService.cs：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.ServiceModel.Web;
using System.Text;

namespace SimpleJsonService
{
    [ServiceContract]
    public interface IJsonService
    {
        [OperationContract]
        [WebGet(ResponseFormat = WebMessageFormat.Json,
           BodyStyle = WebMessageBodyStyle.Bare,
           UriTemplate = "/vehiclelist")]
        List<Vehicle> GetCustomerList();

        [OperationContract]
        [WebGet(ResponseFormat = WebMessageFormat.Json,
           BodyStyle = WebMessageBodyStyle.Bare,
           UriTemplate = "/randomvehicle")]
        Vehicle RandomVehicle();
    }

    [DataContract]
    public class Vehicle
    {
        [DataMember]
        public string VehicleID { get; set; }
        [DataMember]
        public string VehicleType { get; set; }
        [DataMember]
        public string VehicleOwner { get; set; }
    }
} 
```

**JsonService.svc.cs：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.ServiceModel.Web;
using System.Text;

namespace SimpleJsonService
{
    public class JsonService : IJsonService
    {
        public List<Vehicle> GetCustomerList()
        {
            Vehicle vehicle = RandomVehicle();
            List<Vehicle> vehicleList = new List<Vehicle> { vehicle };
            return vehicleList;
        }

        public Vehicle RandomVehicle()
        {
            Vehicle vehicle = new Vehicle();
            vehicle.VehicleID = "KL-9876";
            vehicle.VehicleType = "Nissan";
            vehicle.VehicleOwner = "Sanjiva";
            return vehicle;
        }
    }
} 
```

**JsonService.svc：**

```
<%@ ServiceHost Language="C#" Debug="true" Service="SimpleJsonService.JsonService" CodeBehind="JsonService.svc.cs" Factory="System.ServiceModel.Activation.WebServiceHostFactory" %> 
```

**网络配置：**

```
<?xml version="1.0"?>
<configuration>

  <appSettings>
    <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
  </appSettings>
  <system.web>
    <compilation debug="true" targetFramework="4.5" />
    <httpRuntime targetFramework="4.5"/>
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <protocolMapping>
        <add binding="basicHttpsBinding" scheme="https" />
    </protocolMapping>    
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <directoryBrowse enabled="true"/>
  </system.webServer>

</configuration> 
```

在 Android 端，您需要使用 HTTPClient 和 JSONObject/JSONArray 来检索数据并对其进行解析。StackOverflow 上有很多例子展示了如何做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T08:52:26.640

嗨@Kasanova 将服务的响应格式设置为 json，如下所示：

```
 [OperationContract]
 [WebGet(UriTemplate = "data/id={value}", ResponseFormat = WebMessageFormat.Json)]
 string[] GetUser(string Id); 
```

# objective-c - 在没有崩溃日志的情况下将对象设置为 NSMutableDictionary 时应用程序崩溃

> ID：14088123
> 
> 赞同：0
> 
> 时间：2012-12-30T03:44:01.707
> 
> 标签：objective-c, xcode, cocos2d-iphone, nsdictionary, nsmutabledictionary

我尝试为我的游戏制作一个简单的分数系统，我正在使用字典并使用 NSUserDefaults 保存它来存储玩家的分数。但是，当我尝试为现有键/值设置新分数时，应用程序崩溃，没有任何控制台日志消息，并且 xcode 切换到我无法读取的汇编代码。我知道它在哪里崩溃，因为我设置了异常并且它显示了它在哪一行被调用。如果有任何改变，我也会使用 cocos2d。

这是代码：

```
//creates key for the right level     
NSString *currentLevelString = [NSString stringWithFormat:@"Level%i",numberOfCurentLevel];

 //checking if dictionary is empty, if empty then it means the game is played for the first time
 NSMutableDictionary *dictionary = [[[NSMutableDictionary alloc]init]autorelease];
//ud is the UserDefaults

 dictionary = [ud objectForKey:@"dictionaryWithScores"];

 if ([dictionary objectForKey:@"Level5"] == nil) {
     //assigning first values for empty dictionary
     dictionary = [NSMutableDictionary dictionaryWithContentsOfFile:[[NSBundle mainBundle]pathForResource:@"ScoreList" ofType:@"plist"]];
     NSLog(@"dictionary was empty");
 }
 //NSLog(@"now dictionary shoud not be empty %@",dictionary);
 //calculating current score for this level
 double currentScore = (numberOfCurentLevel * elementsFound)/9.0;///timeInSeconds;
 double previousScore = [[dictionary objectForKey:currentLevelString]doubleValue];//taking previous score for thi level
 NSLog(@"currentScore: %f \n previousScore: %f",currentScore,previousScore);
 //checking whether current score is greater than the previous one
 if (currentScore > previousScore)
 {
     NSLog(@"dictionary just before the crash: %@",dictionary);
     //if new score is greater then update the dictionary
     NSString *currentScoreString = [NSString stringWithFormat:@"%f",currentScore]; 
```

**`//it crashes on this line seObject`**

```
 [dictionary setObject:currentScoreString forKey:currentLevelString];
     [ud setObject:dictionary forKey:@"dictionaryWithScores"];
     [ud synchronize];

//calculating total score (score for each level + next one)
 double overallScore = 0;
 for (int i=1; i <= 101; i++) {
     //adding scores for each level to each other
     overallScore = overallScore + [[dictionary objectForKey:[NSString stringWithFormat:@"Level%i",i]]doubleValue];
    // NSLog(@"overal score: %f",overallScore);
 } 
```

当我评论 setObject 行时，一切正常。任何人都可以，如果有什么导致崩溃？先感谢您。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T03:56:14.223

你的问题是这一行：

```
dictionary = [ud objectForKey:@"dictionaryWithScores"]; 
```

那是返回一个*不可变*的字典，所以没有`setObject:`方法。您将 plist 文件加载到可变字典中，但该字典中的所有字典*仍然*是不可变的。

要将不可变字典转换为可变字典，请执行以下操作：

```
dictionary = [[ud objectForKey:@"dictionaryWithScores"] mutableCopy]; 
```

您可能还想将刚刚制作的可变副本保存回`ud`字典中：

```
[ud setObject:dictionary forKey:@"dictionaryWithScores"]; 
```

PS：我不确定您为什么看不到日志消息；你应该看到一个。

# javascript - JavaScript/Ajax：navigator.onLine 替代方案：serverReachable()

> ID：14088125
> 
> 赞同：0
> 
> 时间：2012-12-30T03:44:27.290
> 
> 标签：javascript, ajax

以下代码是使用 navigator.onLine 的替代方法 - 通过检查服务器是否可访问。

“简单”的问题——我该如何让它发挥作用？

```
function serverReachable() {
  // IE vs. standard XHR creation
  var x = new ( window.ActiveXObject || XMLHttpRequest )( "Microsoft.XMLHTTP" ),
      s;
  x.open(
    // requesting the headers is faster, and just enough
    "HEAD",
    // append a random string to the current hostname,
    // to make sure we're not hitting the cache
    "//" + window.location.hostname + "/?rand=" + Math.random(),
    // make a synchronous request
    false
  );
  try {
    x.send();
    s = x.status;
    // Make sure the server is reachable
    return ( s >= 200 && s < 300 || s === 304 );
  // catch network & other problems
  } catch (e) {
    return false;
  }
} 
```

上面的代码取自文章： http: [//louisremi.com/2011/04/22/navigator-online-alternative-serverreachable/](http://louisremi.com/2011/04/22/navigator-online-alternative-serverreachable/)但我不知道为什么它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:03:14.120

> “出于某种原因，无论我使用什么服务器，我都只会得到错误”

[由于同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，您不能选择任何随机服务器。您只能执行您当前所在的本地域。

# java - 防止 HTMLUnit 日志系统干扰 Logback

> ID：14088127
> 
> 赞同：1
> 
> 时间：2012-12-30T03:44:45.057
> 
> 标签：java, logging, htmlunit, logback

我正在从 Log4j 切换到 Logback。我在我的项目中使用 HTMLUnit，当我使用 Log4j 时，我必须添加下面的 2 行以防止 HTMLUnit 日志消息干扰我的配置。

```
log4j.logger.com.gargoylesoftware.htmlunit=ERROR
log4j.logger.org.apache.http=ERROR 
```

这是我当前的 Logback 配置

```
<configuration>
    <appender name="DB" class="ch.qos.logback.classic.db.DBAppender">
        <connectionSource
            class="ch.qos.logback.core.db.DriverManagerConnectionSource">
            <driverClass>org.postgresql.Driver</driverClass>
            <url>jdbc:postgresql://MYIP:5432/logs</url>
            <user>logs</user>
            <password>MYPASS</password>
        </connectionSource>
    </appender>

    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%msg%n</pattern>
        </encoder>
    </appender>

    <root level="DEBUG">
        <appender-ref ref="DB" />
        <appender-ref ref="STDOUT" />
    </root>

</configuration> 
```

我现在正在为 Logback 使用 xml 样式的配置文件。xml Logback 配置的上述行的等价物是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T04:05:29.240

您可以在 logback 配置中明确指定记录器的级别，如下所示：

```
<logger name="com.gargoylesoftware.htmlunit" level="ERROR" />
<logger name="org.apache.http" level="ERROR" /> 
```

# ios - Xcode 获取版本和内部版本号

> ID：14088128
> 
> 赞同：6
> 
> 时间：2012-12-30T03:44:52.687
> 
> 标签：ios, xcode, version, build-numbers

我想在应用程序的信息和积分屏幕上将版本和内部版本号打印到我的应用程序中。我在摘要页面的“版本号”中输入了 1.2，在摘要页面的“内部版本号”中输入了“D03”。

然后我找到了这个代码片段来打印它们，

```
NSString * appVersionString = [[NSBundle mainBundle]
                                   objectForInfoDictionaryKey:@"CFBundleVersion"]; 
```

但是，这似乎只打印“内部版本号”中的值，而不是版本号中的值。如何访问内部版本号和版本号？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T03:54:17.573

我相信你想要使用的是`CFBundleShortVersionString`. 这是有关您要查找的内容的文档：

[苹果的文档](https://developer.apple.com/library/mac/#documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html#//apple_ref/doc/uid/TP40009249-102364-TPXREF106)

# sql - 在 SQL Server 2008 中何处编写 SQL 语句或查询？

> ID：14088131
> 
> 赞同：0
> 
> 时间：2012-12-30T03:46:04.103
> 
> 标签：sql

我知道，问这个很有趣。但我是 SQL Server 的新手，我不知道在哪里编写 SQL 查询？我学习了整个 SQL 教程，但我不知道在哪里编写这些查询。我安装了 SQL Server 2008。我在 SQL Server 2008 中找不到任何文本区域来编写查询

提前致谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:49:17.813

您是否安装了 SQL Server Management Studio？这是一个应该对您有所帮助的[链接。](http://msdn.microsoft.com/en-us/library/ms174173.aspx)这里还有几个链接：

1.  [SQL Server Management Studio for SQL 2008 express](http://www.microsoft.com/en-us/download/details.aspx?id=7593)
2.  [SQL Server Management Studio for SQL 2012 express](http://www.microsoft.com/en-us/download/details.aspx?id=29062)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:58:47.480

您可能想阅读[SQL Server 2008 教程](http://www.quackit.com/sql_server/sql_server_2008/tutorial/)。它将帮助您滚动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T04:56:02.857

顺便说一下，根据个人经验，将其安装为*新实例*。它将为您省去一些头痛！如果您在安装时遇到问题，并且无法正确完成，则可能与之前的 SQL 安装有冲突。*您可以通过在控制面板*中卸载以前的 SQL 内容来解决该问题。祝你好运！

# c++ - “错误 C2065：'ON_WM_THEMECHANGED'：未声明的标识符”

> ID：14088133
> 
> 赞同：-1
> 
> 时间：2012-12-30T03:46:07.253
> 
> 标签：c++, windows, mfc, visual-c++-6, uxtheme

我正在使用VC6。如何解决错误？

```
error C2065: "error C2065: 'ON_WM_THEMECHANGED' : undeclared identifier" 
```

类定义代码：

```
 #include "stdafx.h"
    #include "ConfigListCtrl.h"
    #include "CellCtrls\ListCtrlCellWnd.h"
    #include "CellCtrls\CellButton.h"
    #include "Windows.h"
    #include "Winuser.h"
    // CConfigListCtrl

    IMPLEMENT_DYNAMIC(CConfigListCtrl, CListCtrl)

    CConfigListCtrl::CConfigListCtrl() : m_bInit(FALSE), m_bCaretExists(FALSE), m_bTabbedIn(FALSE), m_bKeyUp(FALSE), m_bIsEnabled(TRUE)
    {
    }

    CConfigListCtrl::~CConfigListCtrl()
    {
        ForEachCellCtrl(&CConfigListCtrl::DeleteCellCtrl);
    }

    BEGIN_MESSAGE_MAP(CConfigListCtrl, CListCtrl)
...
        ON_WM_THEMECHANGED()
...
    END_MESSAGE_MAP()
    ...
    } 
```

似乎我错过了一些头文件或lib文件，但是它们是什么，无论如何如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:55:28.820

在 VC6 几年之后，Windows XP 首次引入了主题。您将需要更新的 Windows SDK 以及相应的 win....h 文件。

# c# - 如何有效地存储/检索有关网格边缘的数据？

> ID：14088136
> 
> 赞同：4
> 
> 时间：2012-12-30T03:46:44.843
> 
> 标签：c#

如果这是此问题的错误 stackexchange 网站，请在其他地方指导我！

我有一个规则的二维节点网格。我还想存储有关网格节点之间边缘的数据，但我不确定如何以有效的方式执行此操作。

我立即想到的三个想法都有缺点，我不确定哪个更可取，或者是否确实有更好的方法。

1.  **将边缘数据存储在二维数组中。**由于图节点本质上是一个二维数组，你可以简单地将边数据存储在一个普通的二维数组中——0,0 是左下节点，1,0 是它的右边，而 0,1 是直接“上面”它等等。

这种方法的问题是数据重复——关于 0,0 和 0,1 之间的边的数据存储在两个不同的位置。每当需要更新数据时，您都需要在两个地方都更新它，当然，您有额外的内存开销，因为您可能需要保存两倍的数据（即使其中一半是重复的）

2.  **仅将“顶部”和“左侧”边缘存储在二维数组中。**这是方法 1 的扩展，可避免存储冗余数据。但是，这使得检索和存储数据变得更加困难，因为您现在需要 3 次调用来收集或设置节点的所有边（x,y；x+1,y；和 x,y-1）。

3.  **使用`dictionary<<<x,y>,<x,y>>,Edge>`字典（点元组）来存储和检索关于图中两个节点之间的边的数据。**

这避免了冗余，但字典查找比数组慢，并且不可能一次获得所有 4 条边（接受一个节点并返回 4 条边的字典可以解决后者，但会重新引入冗余问题）。出于我的目的，我主要对一小组节点之间所有可能的边感兴趣，因此不检索所有节点并不是一个大问题。

现在，我倾向于方法#1，只是吸收和处理冗余数据。有没有更好的方法来存储/检索有关边缘的数据，或者这是最好的方法。

示例 - 在 Edge 中存储颜色：

![在此处输入图像描述](../Images/35619b2d6121817f837d3b0034aad593.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:00:41.727

另一种选择是制作一个大的一维边缘对象列表，然后将它们适当地链接到节点。例如，您的节点类可能有`TopEdge`、`LeftEdge`、`BottomEdge`和`RightEdge`成员，每个成员都是对边缘列表中某个对象的引用。

最初设置这可能有点复杂，但可以避免数据重复并提供从节点对适当边缘的轻松访问。

如果您想要更正式的解决方案，您可能还想阅读[图论。](http://en.wikipedia.org/wiki/Graph_%28data_structure%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T05:02:59.350

假设一切都适合内存并且您的边缘不是非常稀疏，我会选择*“仅将“顶部”和“左侧”边缘存储在二维数组中”*，因为它可能具有您列出的选项的最佳缓存性能。

> 但是，这使得检索和存储数据变得更加困难，因为您现在需要 3 次调用来收集或设置节点的所有边（x,y；x+1,y；和 x,y-1）。

我不明白你这是什么意思。一切都应该封装在一个类中，以方便使用的接口。如果您发现自己需要设置节点的所有边，请编写一个方法来执行此操作。

# css - 为什么 CSS 从一开始就没有设计父选择器？

> ID：14088141
> 
> 赞同：0
> 
> 时间：2012-12-30T03:48:36.753
> 
> 标签：css, css-selectors

基于 CSS4 规范的初始草案，[父选择器最终将在 CSS 中可用](http://www.w3.org/TR/2011/WD-selectors4-20110929/)。我的问题是，为什么 W3C 没有在早期的 CSS 规范中包含这个？为什么它没有与 CSS 的其他选择器一起发布？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T03:50:32.910

首先：您在 Selectors 4 中所指的不仅仅是“父选择器”。这是一个[*主题选择器*](http://www.w3.org/TR/2011/WD-selectors4-20110929/#subject)。这意味着它不仅仅涉及一个组合器，它从一个选择器指向另一个选择器并说“这是那是父”，类似于子组合器`>`。它需要说“这个特定元素是接收样式的元素”的语法，即选择器的主题。这就是为什么您会看到使用诸如前缀或后缀之类的东西，而不是组合符。您只是*碰巧*能够使用它来*选择元素的父级*；但它的设计并不仅仅考虑到该功能。这就是为什么称它为“父选择器”是不合适的。

主题选择器的语法很难正确。请注意，他们已经在这方面工作了 10 多年；只需在[公共邮件列表档案](http://lists.w3.org/Archives/Public/www-style)中搜索“主题选择器”，您就会发现可以追溯到 1999 年（！）的东西，当时 CSS 2.0 刚刚成为 W3C 推荐标准。即使在当前的 Selectors 4 草案中，他们还没有决定最终的语法：2011 年的 FPWD 使用`$`符号，而在 2012 年的 WD 中，它现在是`!`.

至于一般的父选择器：从历史上看，这^(主要)是我所看到的重绘性能的问题。*浏览器在页面下载时按顺序构建 DOM，并在页面加载*时立即实时应用 CSS 。使用父选择器，浏览器必须等到知道它的子选择器后才能决定是否应用它的规则。这可能会导致重新绘制问题，尤其是在页面加载缓慢时，从而进一步损害用户体验。

这对于后代选择器、子选择器或跟随兄弟选择器来说不是问题，因为它们遵循文档的自然源顺序，尤其是在像 HTML 这样的声明性标记语言中。

我想，这是阻止父选择器晋级的几个问题中最大的问题之一。事实上，在一*开始*，CSS1 甚至没有子选择器或兄弟选择器。它只有一个后代选择器，它本身甚至没有被称为；它被简单地称为[上下文选择](http://www.w3.org/TR/CSS1/#contextual-selectors)，这是一个非常原始的概念，当时 CSS 刚刚从表现性标记的开发地狱中衍生出来。

* * *

¹ [既然 Selectors 4 引入了一种将规则应用于复杂选择器中表示的任何单个元素的方法，您会想知道这些性能问题是否已得到解决或以其他方式变得无关紧要，因为选择器作为一个整体仍然必须依赖在一个完整的结构上，以便浏览器确定匹配，这意味着页面加载仍然是一个主要因素。不幸的是，这对我来说是禁区。我没有实现 CSS，所以我不能谈论实现问题。]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T03:52:14.407

CSS 被设计为以只进的方式应用，因此一旦下载了该元素的源，就知道适用于该元素的样式。

父选择器破坏了该设计，因为在从服务器下载所有子元素之前，渲染器无法知道它是否适用于元素。

# c++ - Visual Studio 2010 文本编辑器错误插入符号

> ID：14088149
> 
> 赞同：0
> 
> 时间：2012-12-30T03:50:16.297
> 
> 标签：c++, visual-studio-2010

我已经安装了 VS 2010 大约一年，直到大约一个月前它一直运行良好。

当我输入“::”、“.”、“->”等时，文本编辑器开始将插入符号移动到奇怪的地方，而且没有立即可推断的原因，这种情况越来越频繁。

我已经做了resetsettings无济于事。

有任何想法吗？

编辑 - 更多细节：

键入“::”时，插入符号将跳转到行首，或该行第一个符号中间的某个位置。

当完成一对“<>”时，如果有任何嵌套出现，则删除或对齐最后一个“>”。例如：

```
welcome_mat<
    tuba<
        yip<int>,
        orange<float> // <- after typing newline here...
    > // <- this was the original closing ">" for "welcome_mat" (I didn't type a ">" yet)
// ^---- caret is now here 
```

我通常在键入模板时关闭模板，但在排列多个参数时，我将它们垂直放置并倾向于在填写完它们后关闭它们。这不会发生在单行上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:54:24.087

尝试重新安装它，如果这不起作用，请查看您的键盘快捷键，也许您有一些奇怪的快捷键绑定可以使插入符号移动。

# php - mysqli_free_result 有必要吗？

> ID：14088155
> 
> 赞同：20
> 
> 时间：2012-12-30T03:51:46.577
> 
> 标签：php, mysqli

我正在查看我的代码并读到它被推荐在[`mysqli_free_result`](http://www.php.net/manual/en/mysqli-result.free.php)不再需要您的结果对象时使用。但是在看到每个查询`$result`在整个脚本中重复输出到变量之后，我想知道是否`mysqli_free_result`真的有必要。似乎每次运行查询时，`$result`变量已经被清除干净并设置为新结果。只是好奇是否有人对此有任何意见。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T04:00:41.127

实际上这是必要的，因为当发出许多请求时，它可能会给服务器带来沉重的负担。所以最好，你应该使用它。

在其他情况下，您知道此查询后面跟着其他查询，因此您不必使用它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-30T04:04:24.280

这从来都不是绝对必要的，但最好注意您正在使用的资源并知道何时不再需要它们。

放入那行额外的代码几乎不需要付出任何努力，所以每次你完成一个结果集时我都会这样做。当您完成资源时，它还有一个额外的好处是让阅读您的代码的人清楚。

# ruby-on-rails-3 - 在 rspec 中，我是否可以确保某些示例仅在另一个示例通过时才运行？

> ID：14088158
> 
> 赞同：3
> 
> 时间：2012-12-30T03:53:23.080
> 
> 标签：ruby-on-rails-3, rspec, rspec2

我想知道当且仅当另一个通过时是否可以运行某些示例测试？我知道您可以使用`if: something`元数据过滤示例，但据我了解，`something`不能在示例中设置，因为示例作为对象实例操作，而示例的声明（在哪里`if: something`）在示例组的类方法中操作（其他人可能比我更好地举例说明）。

在代码中，这就是我正在寻找的东西，或者类似的东西

```
describe Something do

  it "has a breadcrumb trail" do
    expect(page).to have_breadcrumb
    has_breadcrumb = true
  end
  it "has the parent name in the breadcrumb", if: has_breadcrumb do
    expect(page).to have_text("somename")
  end
end 
```

显然在这里简化了，但动机是我希望能够设置测试，其中期望依赖于另一个功能的实现。

规范 2.12

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T13:05:02.807

测试的最佳实践是确保您的测试彼此独立。我不确定你想要做什么是理想的。

# java - 如何最小化 GC_FOR_ALLOC 的出现？

> ID：14088159
> 
> 赞同：19
> 
> 时间：2012-12-30T03:53:48.243
> 
> 标签：java, android, memory-management, garbage-collection, dalvik

我的应用程序导致这些可怕的 GC_FOR_ALLOC 在特定位置（方法）多次发生：

```
12-29 22:20:30.229: D/dalvikvm(10592): GC_FOR_ALLOC freed 1105K, 14% free 10933K/12615K, paused 33ms, total 34ms
12-29 22:20:30.260: D/dalvikvm(10592): GC_FOR_ALLOC freed 337K, 13% free 11055K/12615K, paused 25ms, total 26ms
12-29 22:20:30.288: D/dalvikvm(10592): GC_FOR_ALLOC freed 278K, 14% free 10951K/12615K, paused 24ms, total 24ms
12-29 22:20:30.495: D/dalvikvm(10592): GC_CONCURRENT freed 633K, 11% free 11317K/12615K, paused 16ms+3ms, total 79ms
12-29 22:20:30.495: D/dalvikvm(10592): WAIT_FOR_CONCURRENT_GC blocked 16ms
12-29 22:20:30.499: D/dalvikvm(10592): WAIT_FOR_CONCURRENT_GC blocked 15ms 
```

我很清楚，我在内存管理方面做错了（是的，垃圾收集很棒，但仍然不能让我免于知道何时以及如何分配的责任）。

您能否推荐一种**故障排除方法或技术**，可以引导我找到有问题的代码行和可能的解决方案？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-12-30T04:18:12.553

Android DDMS 是 Eclipse 中 Android 开发工具的一部分，它有非常有用的工具，可用于分析和内存分配跟踪。

下面的截图突出显示了其中一些工具（都在 DDMS 下），一些工具需要通过单击左侧面板中的相应按钮（以红色突出显示）来激活，然后您可以在右侧面板中看到值（一些带有图表）通过选择您要观看的标签（以蓝色突出显示）

堆和分配跟踪器在您的情况下将非常有用。

![显示分析和内存分配工具的 Eclipse 屏幕截图](../Images/167e628322403922c7b3501f126d437f.png)

# node.js - 多个快递应用在不同目录中共享同一个域

> ID：14088165
> 
> 赞同：0
> 
> 时间：2012-12-30T03:55:10.200
> 
> 标签：node.js, ssl, express, directory

我有四个使用 express 框架构建的节点应用程序。我有一个域名`expressapps.com`，我希望这三个应用程序中的每一个都在不同的子目录中运行。我希望第四个应用程序在主页上运行（并可能委托其他应用程序）。

*   expressapps.com
*   expressapps.com/app-one
*   expressapps.com/app-two
*   expressapps.com/app-三

我希望所有应用程序都能够与域名分离并移动到不同的应用程序，不以任何方式相互依赖，不共享 cookie 或会话数据。我还希望应用程序在节点级别上运行在彼此不同的进程中。我猜这些应用程序都必须在同一台服务器上，但是有可能让它们在不同的服务器上吗？

我这样做而不是使用子域的原因是因为`ssl`，我只想购买一个证书。

这可能吗？有什么可以帮助这种配置的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T17:49:29.440

最优雅的方式是使用子域，而不是端口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T18:43:51.060

您可以尝试做子域：

```
http://expressapps.com
http://app-one.expressapps.com
http://app-two.expressapps.com
http://app-three.expressapps.com 
```

这样做的好处是，您可以将每个应用程序托管在单独的位置，甚至可以在不同的服务器上或使用不同的托管服务，然后只需更改您的 DNS 设置以将这些子域指向适当的位置。有道理？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-08T02:07:35.443

您可以使用这样的工具[`haproxy`](http://haproxy)，该工具允许您在不同的服务器上运行不同的应用程序，但所有应用程序都位于一个域下并转发到另一个域。

# php - 从第一个表中选择所有，计算第二个表中的ID实例

> ID：14088172
> 
> 赞同：1
> 
> 时间：2012-12-30T03:56:43.430
> 
> 标签：php, mysql

我有两个表，第一个表包含具有唯一 ID 和关键字的数字，第二个表包含通过唯一 ID 链接回第一个表的数字（在`CAMPAIGN`列中）。我想从第一个表中获取每个数字，并计算其唯一 ID（in `CAMPAIGN`）在第二个表中出现的次数（即：每个数字附加了多少关键字）。

```
 CAMPAIGNS                                   SUBSCRIBERS
----------------------------------      --------------------------------------
ID    |    NUMBER    |  KEYWORD  |      | ID    |   NUMBER     |   CAMPAIGN  |
----------------------------------      --------------------------------------
1     |  +1222222222 |   pizza   |      |  22   | 555-333-222  |     2       |
----------------------------------      --------------------------------------
2     |  +1222222222 |   burger  |      |  21   | 222-333-222  |     2       |
----------------------------------      --------------------------------------
3     |  +1444444444 |    pie    |      |  33   | 333-111-111  |     1       |
----------------------------------
4     |  +1111111111 |  chicken  | 
```

我需要的结果是：

```
----------------------------------------
      NUMBER      |  KEYWORD   | COUNT |
----------------------------------------
    +1222222222   |   pizza    |   1   |
----------------------------------------
    +1222222222   |   burger   |   2   |
----------------------------------------
    +1444444444   |    pie     |   0   |
----------------------------------------
    +1111111111   |   chicken  |   0   | 
```

我不太熟悉，`JOIN`所以`UNION`我一直在尝试和阅读文档，但我不太清楚如何`COUNT`使用它们来实现。

这是我到目前为止所拥有的，但每次我尝试添加`COUNT`函数时，我都会遇到错误并且无法弄清楚：

```
SELECT * FROM `campaigns` LEFT JOIN `subscribers` ON `campaigns`.id = `subscribers`.campaign; 
```

**编辑** 在下面发布的查询有效，但它不包括计数为零的其他活动

```
SELECT c.number,c.id,c.keyword,COUNT(s.id) AS count FROM campaigns AS c LEFT JOIN subscribers AS s ON c.id = s.campaign GROUP BY s.campaign ORDER BY c.id ASC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:18:23.517

```
SELECT c.number,c.keyword,COUNT(s.campaign)  
FROM `campaigns` AS c 
LEFT JOIN `subscribers` AS s ON c.id = s.campaign 
GROUP BY c.id 
ORDER BY c.id ASC 
```

这个查询将给出你所期望的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T03:47:20.333

```
SELECT c.number, c.id, c.keyword, ISNULL(s.count,0) AS count
FROM campaigns AS c
LEFT JOIN (
  SELECT Campaign, COUNT(*) AS count
  FROM Subscribers
  GROUP BY Campaign
) AS s
ON c.id = s.Campaign
ORDER BY c.id ASC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T04:07:17.350

```
SELECT campaigns.number AS number, campaigns.keyword AS keyword, COUNT( subscribers.id ) AS count
FROM  `subscribers` 
LEFT JOIN  `campaigns` ON subscribers.campaign = campaigns.id
GROUP BY campaigns.keyword 
```

是你需要的。唯一不起作用的是显示有 0 个订阅者的“饼图”......不幸的是，我不喜欢 mysql 子选择，这是你需要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T04:51:50.637

作为您的问题的解决方案，请尝试执行以下 sql 查询

```
select c.number,keyword,(select count(id) as count from subscribers
where campaign=c.id) from  campaigns c 
```

# c# - Entity Framework Code First 场景中 ApplicationServices 连接字符串的用途是什么？

> ID：14088179
> 
> 赞同：8
> 
> 时间：2012-12-30T03:58:15.773
> 
> 标签：c#, .net, entity-framework, connection-string

每当您首先使用 EF 代码创建应用程序时，您都可以看到添加了以下 web.config 键：

```
<add name="ApplicationServices" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true" providerName="System.Data.SqlClient" /> 
```

您可以很容易地看到它不包含特定于应用程序的信息。更改这些值不会影响应用程序的运行方式，因此我认为它一定是某种不必要的 EF 工件，可能是设计人员需要的。但是，如果您完全删除此密钥，应用程序将在启动时抛出 ConfigurationError。这把钥匙的真正目的是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T08:41:40.910

您引用的连接字符串：

```
<add name="ApplicationServices" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true" providerName="System.Data.SqlClient" /> 
```

与实体框架无关。它是所有非空 ASP.NET 项目（包括 WebForms/WebPages 和 MVC 框架）模板的一部分。它用于连接到将驻留在您的`App_Data`文件夹中的嵌入式数据库，并允许您使用 ASP.NET 提供程序模型，而无需 SQL Server 实例。如果您不确定，请查看`connectionString`该部分的默认值`Membership`：

```
<membership>
  <providers>
    <clear/>
    <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices"
         enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false"
         maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
         applicationName="/" />
  </providers>
</membership> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T04:24:10.227

> 您可以很容易地看到它不包含特定于应用程序的信息

您希望从连接字符串中获得哪些特定于应用程序的信息？！

> 这把钥匙的真正目的是什么？

这是 Visual Studio 2012 中的一项新功能。它称为 localdb。mdf 文件始终位于项目的 app_data 文件夹中。引入它是为了方便开发人员，让他们在开发时不必担心后端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T05:25:02.620

来自 Web 或 app.config 的片段显示很可能是连接字符串条目。

例如

```
<connectionStrings>
<add name="NameOfYourContext" connectionString="Data Source=SQLServerHost;Initial Catalog=The DBName;Integrated Security=True;MultipleActiveResultSets=True;App=EntityFramework"
   providerName="System.Data.SqlClient" /> 
```

这个例子如果用于 SQL server 你的 SQL express。差异突出了预期用途。

即：启动（http 服务）查找 web.config 或 WPF/Console/Forms 应用程序查找 App.config。

实体框架查找具有上下文名称的连接字符串（请参阅构造函数或您的上下文）。这住

```
 <configuration>
      <connectionStrings> 
```

通过添加元素。

您可以拥有任意数量的连接字符串。EF 和其他进程可以使用相同的连接字符串。它不是人工制品，实际上 EF 重用了一个长期建立的 .net 功能。例如 [http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.connectionstrings.aspx](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.connectionstrings.aspx)

我假设您的上下文称为 ApplicationServices ，这引起了混乱。或者该名称是您使用此类成员数据库的服务功能使用的默认连接名称。[http://msdn.microsoft.com/en-us/library/bb547119%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/bb547119%28v=vs.100%29.aspx) 例如，您可能在配置中有一个部分，其中有一个“ApplicationServices”的“connectionStringName”

# javascript - 从对象数组递归创建 JSON 树结构

> ID：14088181
> 
> 赞同：1
> 
> 时间：2012-12-30T03:58:59.887
> 
> 标签：javascript, arrays, json, object, recursion

这是我的数据结构：

```
{ projects: [
      { revisions: [
            { files: [] },
        ],
      }
  ],
  user: {}
} 
```

转到此处的 jsFiddle：http: [//jsfiddle.net/winduptoy/EXdDy/](http://jsfiddle.net/winduptoy/EXdDy/)

我很想递归地创建对象的父级及其`id`s 的 JSON 层次结构。检查您的控制台。看看`projects[0].revisions[0]._idTree`，其中包含`projects._id`和`revisions`作为 的***子***项`projects`，正如预期的那样。现在看看`projects[0].revisions[0].files[0]._idTree`，它包含`projects.files`作为 的***兄弟***，`projects.revisions`什么时候`files`应该是的***孩子***。`projects.revisions`我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:35:31.473

我认为这是您应该使用的：

[http://www.jstree.com/](http://www.jstree.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T04:37:57.883

请改写`recurseTree`如下：

```
function recurseTree(tree, newKey, newId) {
    if(angular.element.isEmptyObject(tree)) {
        tree[newKey] = {_id: newId};
        return;
    } 

    var child = null; // find current tree's child
    for(var key in tree) {
        if (key != '_id') {
            child = tree[key]; // found a child
            break;
        }
    }
    if (child) { // recursively process on child
        recurseTree(child, newKey, newId);
    } else { // no child, so just fill the tree
        tree[newKey] = {_id: newId};
    }
} 
```

# ruby - Ruby：访问子类常量

> ID：14088182
> 
> 赞同：1
> 
> 时间：2012-12-30T03:59:04.833
> 
> 标签：ruby, constants, subclass, class-method

为什么以下不起作用？

```
class Foo
    def self.keyletters
        self::KEYLETTERS
    end
end

class Baz < Foo
    KEYLETTERS = "US"
end

puts Foo.keyletters 
```

我已经看到了类似问题的问题（例如，这里：[Have a parent class's method access the subclass's constants](https://stackoverflow.com/questions/9014764/have-a-parent-classs-method-access-the-subclasss-constants)），但在我的情况下 Foo.keyletters 是一个类方法，而不是一个实例方法。我正进入（状态

```
uninitialized constant Foo::KEYLETTERS (NameError) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T04:08:00.700

当类`A`继承类`B`或包含/扩展模块`C`时，除了它自己的常量、变量和方法之外，还会`A`得到任何东西`B`。并且不受此影响。`C``B``C`

在您的情况下，`Baz`是`Foo`. `Baz`除了. _ `Foo`_ 没有任何额外的东西。特别是，没有.`Baz::KEYLETTERS``Foo``Foo::KEYLETTERS`

# c++ - C++ 中的向量迭代和删除

> ID：14088187
> 
> 赞同：3
> 
> 时间：2012-12-30T04:00:34.620
> 
> 标签：c++, vector, iteration

我正在尝试遍历向量并删除第一次出现的对象。我不断收到编译错误（使用 g++），但我正在按照 stackoverflow 答案和其他来源建议删除它的方式删除它。我可能缺少一些超级简单的东西，所以另一双眼睛也会很棒。

```
#include <iostream>
#include <vector>
#include <assert.h>
using namespace std;

bool Garage::remove(const Car &car){
assert(!empty());

int size = v.size();
for(vector<Car>::const_iterator it = v.begin(); it != v.end(); ++it){
    if(it -> Car::make() == car.Car::make()){
        it = v.erase(it);
        assert(v.size() == size - 1);
        return true;
     }
 }
 return false;
} 
```

编译错误是 error: no matching function for call to 'std::vector::erase(const Car&)'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T04:03:15.950

您正在尝试使用 const_iterator 进行擦除。由于您正在尝试修改向量，请切换到常规迭代器。

```
for(vector<Car>::iterator it = v.begin(); it != v.end(); ++it){ 
```

这有效：

```
int main()
{
   vector<int> ints;

   for (vector<int>::iterator iter = ints.begin();iter != ints.end();++iter)
   {
      ints.erase(iter);
   }
} 
```

这不会：

```
int main()
{
   vector<int> ints;

   for (vector<int>::const_iterator iter = ints.begin();iter != ints.end();++iter)
   {
      ints.erase(iter);
   }
} 
```

使用 const_iterator 时出错：

```
test.cpp:18:22: error: no matching function for call to ‘std::vector<int>::erase(std::vector<int>::const_iterator&)’ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T04:09:36.457

[看来](https://stackoverflow.com/questions/571394/how-to-find-an-item-in-a-stdvector)您需要使用[find](http://www.sgi.com/tech/stl/find.html)来查找元素的索引并随后将其[删除](http://www.cplusplus.com/reference/vector/vector/erase/)。我说“出现”是因为我不是 C++ 程序员。

# mysqli - 来自安装 php-common-5.1.6-39.el5_8.i386 的文件 /etc/php.ini 与来自包 php53u-common-5.3.19-1.ius.el5.i386 的文件冲突

> ID：14088191
> 
> 赞同：-1
> 
> 时间：2012-12-30T04:01:25.057
> 
> 标签：mysqli, centos, rpm

当我在我的 centos 上安装 mysqli

```
# yum -y install php-mysqli 
```

他告诉我：

```
Transaction Check Error:
  file /etc/php.ini from install of php-common-5.1.6-39.el5_8.i386 conflicts with file from package php53u-common-5.3.19-1.ius.el5.i386 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T12:36:29.903

正如输出所说：

php-common-5.1.6-39.el5_8.i386（php-mysqli的依赖）与php53u-common-5.3.19-1.ius.el5.i386冲突

如果你想要 php-mysqli，只需删除 php53u-common-5.3.19-1.ius.el5.i386。

# php - jQuery ajax 没有成功

> ID：14088196
> 
> 赞同：0
> 
> 时间：2012-12-30T04:02:38.073
> 
> 标签：php, ajax

我有一段 HTML 代码：

```
<div id="question_form">
<form method="POST" id="question_form" action="addQuestion.php">
<input type="hidden" id="u_id" name="u_id" value="6"/>
<input type="hidden" id="u_a_name" name="u_a_name" value=""/>
<textarea placeholder="question here" cols="138" rows="3" name="question" id="question_input"/>
<input type="image" class="ask_button" value="submit" src="img/ask.png"/>
</form>
</div> 
```

这里是 JavaScript：

```
$(".ask_button").click(function() {
        $.ajax({
               type: "POST",
               url: "addQuestion.php",
               data: $("div#question_form").formSerialize() + "&textareadata="+escape($("#question_input").value),
               success: function(data)
               {
                        if (data == "Asked") {
                        window.location.reload();
                    } else {
                        alert(data);
                    }
               }
             });
        return false;
    }); 
```

php 文件检查问题是否为空，如果不是 - 将其写入数据库。

当我单击提交按钮时，我看到 addQuestion.php 页面，但没有警报，尽管 php 脚本执行正确。有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:21:00.973

`escape($("#question_input").value)`应该`encodeURIComponent($("#question_input").val())`

jQuery 对象没有 value 属性（[`.val()`](http://api.jquery.com/val/)改为使用），这会导致您的代码出现错误，并可能导致表单提交到`addQuestion.php`

* * *

您还有两个`id`具有相同名称的标签：

```
<div id="question_form">
<form method="POST" id="question_form" action="addQuestion.php"> 
```

每个`id`标签在 HTML 中必须是完全唯一的，以便 jQuery 提供预期的结果。尝试重命名其中之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T04:43:56.190

你可以看看这个类似的问题here

[用php提交ajax表单](https://stackoverflow.com/questions/13924309/ajax-form-submission-with-php/13924367#13924367)

这已经被我解决了。并希望这对你也有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T05:06:15.430

您可以简单地这样做来避免此类问题，

```
$(document).ready(function(){
$(".ask_button").click(function() {
    $.ajax({
           type: "POST",
           url: "addQuestion.php",
           data: $("#question_form").serialize(),
           success: function(data)
           {
                if (data == "Asked") {
                    window.location.reload();
                } else {
                    alert(data);
                }
           }
         });
    return false;
}); 
```

});

并为 div 和 form 提供不同的 id ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T04:54:21.423

好的，解决了。真的，我使用了错误的脚本，所以我改为`.value`手动`.val()`设置所有参数，所以现在它似乎可以工作了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T04:59:01.030

您可能遇到了阻止表单通过 ajax 发送的 Javascript 错误，并且它通过常规 HTTP 方式提交。

您看不到区别，因为表单的`action`属性与 ajax 请求 url 相同。如果您更改其中任何一个，您会注意到我的解释。

要跟踪问题，您应该在 firebug/firefox/chrome 控制台中启用“在导航时保留日志记录”或类似选项，再次进行测试，并在您导航到`addQuestion.php`.

# javascript - 如何使用响应式设计使 div 的高度和宽度相同？

> ID：14088200
> 
> 赞同：0
> 
> 时间：2012-12-30T04:03:04.420
> 
> 标签：javascript, jquery, html, css, responsive-design

我正在研究响应式设计，并且很难尝试使某些 div 的高度和宽度都相同。起初我将 div 的宽度设置为百分比并将其高度更改为 auto，但这只会导致 div 不显示。在这个例子中，我必须有一个固定的像素高度才能显示 div。我无法通过使用简单的图像来解决这个问题，而是我必须在 div 中使用背景图像，这些图像需要响应具有响应性的等于和高度。当我重新调整浏览器的大小时，我需要 div 将大小更改为正方形而不是矩形。我怎样才能做到这一点？

jsFiddle 上的以下示例可以使用缩短的 url 在[http://bit.ly/ZLiBm2找到](http://bit.ly/ZLiBm2)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:21:59.777

试试这个jsFiddle [http://jsfiddle.net/ZYTST/中的方法](http://jsfiddle.net/ZYTST/)

将`padding-bottom`用作元素所需的高度百分比，然后将其设置`height`为`0`和`width`的相同值`padding-bottom`。

# intellij-idea - IntelliJ 检查，需要澄清

> ID：14088205
> 
> 赞同：0
> 
> 时间：2012-12-30T04:03:31.203
> 
> 标签：intellij-idea

似乎`IntelliJ 12 Ultimate`缺少一些相对于其中存在的检查`Community 11`

![在此处输入图像描述](../Images/f63ea94d7189f926e4be03e91b454764.png) ![在此处输入图像描述](../Images/dd34f3261212a725da145870593bd3d6.png)

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T04:36:26.043

通过以下方式转到 IntelliJ 12 Ultimate 中的设置：

1.  点击配置
2.  单击设置
3.  在搜索框中输入“Serail”

![在此处输入图像描述](../Images/5c3c4f60abe06a4183dbe9d0dcf65570.png)

在这里可以找到配置（启动菜单）： ![在此处输入图像描述](../Images/920cd0aed46d813878e7093383c9f4f7.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T15:19:50.360

回答这个问题的所有功劳都[归于 CrazyCoder](https://stackoverflow.com/users/104891/crazycoder)。

看来，默认情况下`Settings-> Plugins->Inspection Gadgets`未启用。

![在此处输入图像描述](../Images/49454ed41f950c0076c29e2dbe4a8a02.png)

启用它们会将这个和许多其他检查放入 IDE。

# python-2.7 - Ftp 仅发送使用 python 的新文件

> ID：14088211
> 
> 赞同：1
> 
> 时间：2012-12-30T04:05:14.220
> 
> 标签：python-2.7, ftplib

我正在使用此代码将所有 htm 文件上传到 Web 服务器，但每次运行它时，我都会上传所有文件，并且我只想上传新文件。

```
try:
ftp.cwd('public_html')
F=open('Simple.png','rb')
tp.storbinary('STOR Simple.png',F,1024)
file.close(F)
for root, dirs, files in os.walk('C:\Relatorio'):
    for fname in files :
    if (fname.endswith(".HTM")) or (fname.endswith(".htm")):
        ftp.storbinary('STOR ' + fname, open(fname, 'rb'))
            print "FTP Enviado"
            except ftplib.all_errors,e:
            print 'Erro ao conectar ao servidor FTP\nErro:',e 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:22:38.690

您可以使用本地和远程文件的“最后修改”时间作为估计文件自上次上传以来是否已更改的粗略方法。

# html - 从网络文件共享提供文件时的浏览器缓存

> ID：14088212
> 
> 赞同：5
> 
> 时间：2012-12-30T04:05:25.730
> 
> 标签：html, http, caching, browser

据我了解，一个项目是否被网络浏览器缓存取决于：

1.  响应头告诉浏览器做什么（例如，`Cache-Control`和`Expires`）。
2.  验证器的存在（例如，ETag 或 Last-Modified 标头）。

这对于从网络文件共享提供的文件有何不同？跨不同的浏览器？考虑这个 JavaScript 包括：

```
<script type="text/javascript" src="\\SOMECOMPUTER\folder\file.js"></script> 
```

`meta`当涉及到网络文件时，浏览器会遵守这样的标签吗？

```
<META HTTP-EQUIV="EXPIRES" CONTENT="Mon, 31 Dec 2011 11:12:01 GMT"> 
```

我发现关于这个主题的文档很少。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T18:02:25.740

**编辑：**在实际做了更多测试之后，假设设置了正确的权限，您可以使用 IE8、Firefox 和 Google 以这种方式访问​​文件，抱歉之前的混淆。

现在回到它是否会缓存 java-script 文件（或任何真正的文件）的问题，这是肯定的。所以这里是你可以解决的方法：

[使用 <meta> 标签关闭所有浏览器中的缓存？](https://stackoverflow.com/questions/1341089/using-meta-tags-to-turn-off-caching-in-all-browsers)（这对我来说似乎很好，所以浏览器似乎会监听这样的网络文件的元标记）

[如何强制 IE 重新加载 javascript？](https://stackoverflow.com/questions/866619/how-to-force-ie-to-reload-javascript)（这就像您通过将时间作为未使用的变量附加到它来避免缓存 ajax 调用一样）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:11:18.650

只有在通过 HTTP 协议发送文件时才会考虑 HTTP 标头。文件访问（本地和网络共享）不通过 HTTP，因此您无法控制缓存。

HTML 文件在`<head>`带有元标记的部分中具有缓存控件。所以，如果你想控制 .html 文件的缓存，你可以做到。不幸的是，上述内容不适用于 .js 文件，您无法通过这种方式控制 js 文件缓存。

我会推荐2个选项：

*   **设置一个小型 HTTP 服务器**，并从那里获取 .js 文件 - 这样您就可以通过 HTTP 标头控制缓存超时
*   **将您的 JavaScript 代码内联到 HTML 页面**（在`<script>...</script>`标签中），并通过标签控制缓存`<meta>`。这样你就可以加载这个文件`<div src="\\server\cachedfile.html" \>`- 加载后甚至可以隐藏 div。

我认为第二种方案更好，因为`<meta>`缓存控制更可靠，更可控。

# c++ - 向量 连同地图 释放时可能失败？想知道内存使用细节

> ID：14088215
> 
> 赞同：1
> 
> 时间：2012-12-30T04:05:35.253
> 
> 标签：c++, memory-leaks, stl, vector

我正在用 C++ 编写处理包含百万节点信息的大量流数据。我使用向量来存储每个节点的名称和索引映射。

现在的问题是 vector 占用的内存比预期的要多得多，而且它们的破坏是无法解释的。

假设某个文件包含 100 万行，每行超过 50 个字符。将它们读入两次，然后检查进程的内存使用情况和向量的估计内存使用情况。它们在 60 MB 上有所不同。这只是我遇到的更大问题的一个小预测，它可能在 GB 规模上有所不同。

我在 Windows7 SP1 Ultimate 64bit 上使用 VS2010 SP1 使用 x86 设置编译程序。

```
#include <iostream>
#include <string>
#include <vector>
#include <map>
#include <fstream>
#include <Windows.h>
#include <Psapi.h>
using namespace std;

//#define COUNT 500000
int COUNT = 0;

vector<string> namesVector;
map<string,int> namesMap;
void ProcessStatistics()
{   
    PROCESS_MEMORY_COUNTERS memCounter;
    GetProcessMemoryInfo(GetCurrentProcess(),&memCounter,sizeof(memCounter));
    cout<<"Mem Usage by Process: "<<memCounter.WorkingSetSize * 1.0e-6f<<" MB."<<endl;
}
void VectorMemUsage()
{   
    COUNT = namesVector.size();
    int overhead = StringOverhead();
    double mem = 0;
    mem += sizeof(vector<string>);
    mem += overhead*COUNT;
    for(int i=0; i<COUNT; i++)
    {
        mem += namesVector[i].capacity();
    }
    cout<<"Calculated String Vector Usage: "<<mem * 1.0e-6f<<" MB of "<<COUNT<<" strings."<<endl;
}
int StringOverhead()
{
    int overhead = sizeof(string);
    cout<<"String overhead: "<<overhead<<" Bytes."<<endl;   
    return overhead;
}

void main(){
    const std::string infile = "somefile";
    ifstream infstream(infile);
    string s;   
    while(getline(infstream,s) != NULL)
    {
        namesVector.push_back(s);
        //namesMap.insert(pair<string,int>(s,namesVector.size()));
    }
    infstream.clear();
    infstream.seekg(0,ios::beg);    
    while(getline(infstream,s) != NULL)
    {
        namesVector.push_back(s);
        //namesMap.insert(pair<string,int>(s,namesVector.size()));
    }
    //Check process and vector memory usage:
    ProcessStatistics();
    VectorMemUsage();
    System("pause");

    //Release the vector.
    cout<<"Now releasing the memory..."<<endl;        
    //vector<string>(namesVector).swap(namesVector);
    //vector<string>().swap(namesVector); //Deallocate Vector
//map<string,int>().swap(namesMap);   //Deallocate Map
    cout<<"Capacity of vector "<<namesVector.capacity()<<endl;
    ProcessStatistics();
 } 
```

x86 版本的程序输出如下：

```
Mem Usage by Process: 336.523 MB.
String overhead: 28 Bytes.
Calculated String Vector Usage: 301.599 MB of 3385108 strings.
Press any key to continue . . .
Now releasing the memory...
Mem Usage by Process: 7.64314 MB. 
```

当我在向量上调用 namesVector.shrink_to_fit() 或 vector(namesVector).swap(namesVector) 成语时，向量容量确实减少了，但是内存使用率很高，有人知道解决这个问题吗？交换技巧应该是指针交换吗？为什么它会涉及内存复制和所有并导致这种情况？

```
Mem Usage by Process: 336.536 MB.
String overhead: 28 Bytes.
Calculated String Usage: 301.599 MB of 3385108 strings.
Vector Capacity is 3543306.
Calculated String Vector Usage: 315.693 MB of 3385108 strings.
Now releasing the memory...
Capacity of vector 3385108
Mem Usage by Process: 434.5 MB. 
```

当我为字符串索引添加映射时，发生了意外行为。当我同时调用vector().swap(namesVector)和map().swap(namesMap)时，结果是这样的，这很好，因为内存被释放了。

```
Mem Usage by Process: 534.778 MB.
String overhead: 28 Bytes.
Calculated String Usage: 301.599 MB of 3385108 strings.
Vector Capacity is 3543306.
Calculated String Vector Usage: 315.693 MB of 3385108 strings.
Press any key to continue . . .
Now releasing the memory...
Capacity of vector 0
Mem Usage by Process: 8.2903 MB. 
```

但是当我只调用vector().swap(namesVector)时，内存被部分释放了。部分我的意思是它释放的比上面的结果少，大约 336 MB。

```
Mem Usage by Process: **534.77** MB.
String overhead: 28 Bytes.
Calculated String Usage: 301.599 MB of 3385108 strings.
Vector Capacity is 3543306.
Calculated String Vector Usage: 315.693 MB of 3385108 strings.
Press any key to continue . . .
Now releasing the memory...
Capacity of vector 0
Mem Usage by Process: **440.459** MB. 
```

或者map().swap(namesMap)，内存几乎完全没有释放。

```
Mem Usage by Process: **534.774** MB.
String overhead: 28 Bytes.
Calculated String Usage: 301.599 MB of 3385108 strings.
Vector Capacity is 3543306.
Calculated String Vector Usage: 315.693 MB of 3385108 strings.
Press any key to continue . . .
Now releasing the memory...
Capacity of vector 3543306
Mem Usage by Process: **535.441** MB. 
```

我无法解释发生了什么。有人知道这里发生了什么吗？

谢谢您的帮助。

最好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T14:31:05.163

内存泄漏标记在这里不合适，从来没有任何*泄漏*的内存——所有内存都可以访问并由仍在范围内的对象拥有。内存泄漏意味着丢失的内存永远无法释放，因为您没有引用它。

在`VectorMemUsage`你应该使用`overhead*namesVector.capacity()`或者你只计算填充的向量元素，而不是分配但未初始化的内存。为什么该函数仍然使用全局变量？最好把它写成：

```
void VectorMemUsage()
{   
    int overhead = StringOverhead();
    double mem = 0;
    mem += sizeof(vector<string>);
    mem += overhead*namesVector.capacity();
    for(int i=0; i < namesVector.size(); i++)
    {
        mem += namesVector[i].capacity();
    }
    cout<<"Calculated String Vector Usage: "<<mem * 1.0e-6f<<" MB of " << namesVector.size() <<" strings."<<endl;
} 
```

如果您想避免向量中未使用的容量，您需要提前知道它将有多少元素（即输入文件中有多少行）并用于`reserve`预先分配正确数量的元素。

> 当我在vector上调用shrink_to_fit或swap idiom时，vector容量确实减少了，但是内存使用率很高，有人知道解决这个问题吗？交换技巧应该是指针交换吗？

不，如果仅此而已，它不会减少分配的内存！它将元素复制到一个新向量（仅与所需一样大），*然后*进行指针交换。因此峰值内存*更高*，因为您暂时拥有所有元素的两个副本。

> 或者map().swap()，内存接近没有释放。

除非您使用交换技巧（或），否则向量不会释放其内存`shrink_to_fit()`，它会保持其当前容量，并且只有在您清除它时才会减小其大小。要释放未使用的容量，您必须使用交换技巧或`shrink_to_fit()`. 所以所有的内存仍然归向量所有。

使用交换技巧是没有意义的`std::map`，映射永远不会保留未使用的分配内存，因此您可以`namesMap.clear()`释放映射使用的所有内存。

总之，由于容器的工作方式，这完全是意料之中的。没有泄漏，您只是有无效的假设。

# java - Thymeleaf 呈现空白页

> ID：14088220
> 
> 赞同：1
> 
> 时间：2012-12-30T04:06:22.953
> 
> 标签：java, thymeleaf

我使用 Thymeleaf 作为 Java webapp 的模板引擎，但在渲染模板时遇到问题。请求似乎已正确处理，但浏览器中的页面为空白。

Thymeleaf 引擎配置

```
public static class TemplateEngineProvider implements Provider<TemplateEngine> {
    private static final Logger logger = LoggerFactory.getLogger(TemplateEngineProvider.class);

    private TemplateEngine templateEngine;
    TemplateEngineProvider() {
        logger.debug("Initializing template Engine");

        TemplateResolver templateResolver = new ServletContextTemplateResolver();

        templateResolver.setTemplateMode("HTML5");
        templateResolver.setPrefix("/WEB-INF/templates/");
        templateResolver.setSuffix(".html");

        this.templateEngine = new TemplateEngine();
        this.templateEngine.setTemplateResolver(templateResolver);
    }

    @Override
    public TemplateEngine get() {
        return this.templateEngine;
    }
} 
```

小服务程序代码

```
protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

    logger.trace("Loading dashboard");

    DBI dbi = dbiProvider.get();
    PostDAO postDAO = dbi.onDemand(PostDAO.class);
    long postCount = postDAO.getPostCount();

    resp.setContentType("text/html");

    logger.trace("Calling template engine");
    WebContext ctx = new WebContext(req, resp, getServletContext());
    ctx.setLocale(req.getLocale());
    this.templateEngine.process(TEMPLATE_NAME, ctx);
    logger.trace("Done processing request");

} 
```

模板。在尝试显示基本 HTML 模板时，Thymeleaf 功能已被注释掉。

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="http://www.thymeleaf.org">
<head>
<title>dashboard</title>
<!--<title>th:text="${page.title}</title>-->
</head>
<body>
Admin dashboard
<!--<div th:substituteby="header::header"></div>
<p th:text="#{dashboard.post.total_count(${post_count})}"></p>
<div th:substituteby="footer::footer"></div>-->

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T16:24:12.047

正在使用的流程函数返回一个带有已解析模板数据的字符串。

```
public final String process(String templateName, IContext context) 
```

该调用应该包含响应编写器，以便将解析的模板直接写入编写器

```
public final void process(String templateName, IContext context, Writer writer) 
```

应该花更多时间在 Javadocs 上。

# java - 访问其他类的对象

> ID：14088221
> 
> 赞同：9
> 
> 时间：2012-12-30T04:06:27.900
> 
> 标签：java, class, object

我最近学习了 Java，但遇到了一个问题。我有几个具有不同类的文件，但我不知道如何访问文件中其他类的对象，而不是声明它们的文件。例如：

```
player.java:
public class Player 
{
    public static void main(String[] args) {
        Player player = new Player();
    }
    public int getLocation()
    {
         return 2;
    }
}

monster.java:
public class Monster
{
    public void attackPlayer()
    {
        player.getLocation();
    }
} 
```

我不确定如何从其他文件和类本身有效地访问其他类的这些对象？我知道我可以将对象设为静态，然后通过它们所在的类将它们作为变量访问，但这似乎违反直觉？我来自较少面向对象的编程背景，所以我仍在尝试理解 java 的编程风格。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-30T04:11:01.637

你可能只是想要这样的东西：

```
player.java:
public class Player 
{
    public static void main(String[] args) {
        Player player = new Player();
        Monster monster = new Monster();
        monster.attackPlayer(player);
    }
    public int getLocation()
    {
         return 2;
    }
}

monster.java:
public class Monster
{
    public void attackPlayer(Player player)
    {
        player.getLocation();
    }
} 
```

希望有帮助/有意义！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T04:14:31.490

一个好的开始是在怪物攻击“何时”传递你想要攻击的玩家。

战斗.java

```
public class Battle {

  public static void main(String[] args) {
    Player player = new Player();
    Monster monster = new Monster();
    monster.attackPlayer(player);
  }
} 
```

播放器.java：

```
public class Player 
{
    public int getLocation()
    {
         return 2;
    }
} 
```

怪物.java：

```
public class Monster
{
    public void attackPlayer(Player player)
    {
        player.getLocation();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T04:37:20.830

类只是对象的蓝图。

您只能在已实例化的实际 Player 对象上调用 Player 类中定义的方法 - 您已在`main(String[] args)`方法的以下行中完成了此操作：

```
Player player = new Player(); 
```

但是，该`player`变量现在仅可用于其声明范围内的代码 - 在这种情况下，在`main(String[] args)`方法中此行之后的任何位置。

它在此范围之外不可用。Monster 类中的`attackPlayer()`方法绝对不在此范围内！当您在那里引用`player`时，编译器不知道该标记指的是什么。在开始调用该方法之前，您必须将 Player 类型的参数（命名为`player`（或任何您喜欢的）传递给该方法。

# jquery - jquery div 轮播

> ID：14088224
> 
> 赞同：-3
> 
> 时间：2012-12-30T04:07:32.957
> 
> 标签：jquery, jquery-plugins

我想知道如何创建一个 jQuery 轮播，我可以在其中浏览 div 而不是图像。所以我想浏览一张带有一些描述文字的图片。这可能吗？它是如何完成的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T04:21:45.607

谷歌我的朋友，谷歌。

这些看起来相当不错： http: [//www.codegrape.com/item/div-carousel-jquery-content-slider/1420](http://www.codegrape.com/item/div-carousel-jquery-content-slider/1420)和[http://baijs.nl/tinycarousel/](http://baijs.nl/tinycarousel/)

[http://jquery.malsup.com/cycle/int2.html](http://jquery.malsup.com/cycle/int2.html)和[http://codecanyon.net/item/showbiz-business-carousel-jquery-plugin/926348](http://codecanyon.net/item/showbiz-business-carousel-jquery-plugin/926348)似乎也足够了（正如 IAlwaysAcceptAnswer 和 3dgoo 建议的那样）。 ..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T04:13:22.033

最好获得一个现有的并根据您的需要对其进行修改。例如这个 [http://codecanyon.net/item/showbiz-business-carousel-jquery-plugin/926348](http://codecanyon.net/item/showbiz-business-carousel-jquery-plugin/926348)

我相信互联网上的某个地方也有它的免费版本......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T04:13:43.630

这是一个插件示例：

[http://jquery.malsup.com/cycle/int2.html#s6](http://jquery.malsup.com/cycle/int2.html#s6)

# c++ - 关于引用和指向它们的指针的问题

> ID：14088227
> 
> 赞同：0
> 
> 时间：2012-12-30T04:08:07.067
> 
> 标签：c++, reference

> **可能重复：**
> [指向特定固定地址的指针](https://stackoverflow.com/questions/2389251/pointer-to-a-specific-fixed-address)

```
int a, hex = 0x573285;
int * pA; // Pointer?
*pa = &a; // &a = the hexadecimal-memory location and *pa is now going to point to that place. 
```

所以我想：

假设可以写这样的东西，例如：

```
(*hex) = 5; or whatever the hexadecimal number is 
```

改变内存的值？

如果我有一个程序（我不知道），它会显示我的游戏使用的所有内存位置。如果我更改了程序中的值然后回到我的游戏或其他任何情况下，它也会在那里更改吗？（如果游戏正在运行）。

是`(*this) the same as (this*)`吗？

编辑：这有效

```
int a = 5, b=0x28ff1c;
int* c = &a;
cout << *(c); 
```

但不是：

```
int a = 5;
int * b=0x28ff1c;
int * c = &a;
cout << *(b); 
```

也不：

```
int a = 5, b=0x28ff1c;
int * c = &a;
cout << *(b); 
```

你明白我在做什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T04:19:01.870

> 假设可以写这样的东西，例如：
> 
> ```
> (*hex) = 5; or whatever the hexadecimal number is 
> ```
> 
> 改变内存的值？

该标准不一定保证这种能力，但在许多系统上您可以编写：

```
*((int *) hex) = 5; 
```

将“强制转换”`hex`为指向 - 的指针`int`，然后取消引用该指针并将其设置`int`为`5`- 当然，前提是 in 的值`hex`实际上是指您可以写入的某个内存位置。但不用说，您不应该在您实际打算用于任何事情的任何程序中执行此*操作*。

> 如果我有一个程序（我不知道），它会显示我的游戏使用的所有内存位置。如果我更改了程序中的值然后回到我的游戏或其他任何情况下，它也会在那里更改吗？（如果游戏正在运行）。

这在嵌入式系统上通常是这种情况，但在具有正常操作系统的现代机器上通常不是这种情况，因为使用了[虚拟内存](http://en.wikipedia.org/wiki/Virtual_memory)和[虚拟地址空间](http://en.wikipedia.org/wiki/Virtual_address_space)。发生的情况是，一个进程通常不知道它正在使用的内存的真实*物理*内存位置（如果有的话）；相反，存储在指针中的值是“虚拟的”，并且依赖于进程。两个进程`0x12345678`可以彼此完全没有关系，被映射到完全独立的内存位置。

# assembly - 在 x86 中向 xmm 寄存器添加一个常量值

> ID：14088228
> 
> 赞同：4
> 
> 时间：2012-12-30T04:08:13.290
> 
> 标签：assembly, x86, sse, x87

我将如何添加`1`或添加`2`到寄存器`xmm0`（双）？

我可以这样做，但肯定有一个更简单的方法：

```
movsd xmm0, [ecx]

xor eax, eax
公司
cvtsi2sd xmm1, eax
添加 xmm0, xmm1

movsd [ecx], xmm0

```

也可以用浮点x87指令来做到这一点吗？

这对我不起作用：

```
fld dword ptr [ecx]
fld1
faddp
fstp dword ptr [ecx]

```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T05:36:12.900

您可以在内存或另一个寄存器中保留一个常量：

```
_1      dq      1.0 
```

和

```
addsd   xmm1,[_1] 
```

或者

```
movsd   xmm0,[_1]
addsd   xmm1,xmm0 
```

如果你在 x64 上，你可以这样做：

```
mov     rax,1.0
movq    xmm0,rax
addsd   xmm1,xmm0 
```

或者如果类型不匹配困扰您，请使用堆栈：

```
mov     rax,1.0
push    rax
movsd   xmm0,[rsp]
pop     rax
addsd   xmm1,xmm0 
```

至于 x87 代码，`double`s 是`qwords`， 不是`dwords`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-10T13:46:08.160

```
vpcmpeqq  xmm1,xmm1,xmm1          ; xmm1 = [ -1 | -1 | -1 | -1 ] as ints
vmovsd    xmm0,dword ptr [ecx]    ; xmm0 = VALUE as int
vsubsd    xmm0,xmm0,xmm1          ; xmm0 = VALUE - (-1) = VALUE + 1 
```

以上应该是

```
vpcmpeqq  xmm1,xmm1,xmm1          ; xmm1 = [ -1 | -1 | -1 | -1 ] as ints
vmovd     xmm0,dword ptr [ecx]    ; xmm0 = VALUE as int
vpsubd    xmm0,xmm0,xmm1          ; xmm0 = VALUE - (-1) = VALUE + 1 
```

对于整数递增 1 和

```
vpcmpeqq  xmm1,xmm1,xmm1          ; xmm1 = [ -1 | -1 ] as quads
vmovsd    xmm0,dword ptr [ecx]    ; xmm0 = VALUE as double
vcvtdq2pd xmm1,xmm1               ; xmm1 = [ -1.0 | -1.0 ] as doubles
vsubsd    xmm0,xmm0,xmm1          ; xmm0 = VALUE - (-1.0) = VALUE + 1.0 
```

双倍递增 1.0

# c++ - Visual Studio 2010 C++ 与 zigbee 通信

> ID：14088230
> 
> 赞同：0
> 
> 时间：2012-12-30T04:08:39.290
> 
> 标签：c++, visual-studio-2010, serial-port

我目前正在尝试处理图像并检测一个圆圈，并通过 zigbee 向陆地基地发送一些协议。我对此进行了研究并尝试了我的发现，但它们都不起作用。

以下是我尝试过的代码：

```
 #ifdef __BORLANDC__
#pragma hdrstop            // borland specific
#include <condefs.h>       
#pragma argsused           
USEUNIT("Tserial.cpp");    
#endif

#include "opencv2/objdetect/objdetect.hpp"
#include "opencv2/highgui/highgui.hpp"
#include "opencv2/imgproc/imgproc.hpp"
#include <c:\OpenCV243\include\opencv\cv.h>
#include <c:\OpenCV243\include\opencv\highgui.h>
#include <math.h>
#include "Tserial.h"
#include <iostream>

using namespace std;
using namespace cv;

  int zigbee_command;
  Tserial *zigbee_com;
  unsigned char protocol = 0;

int main( int argc, char **argv )
{
    CvCapture *capture = 0;
    IplImage  *img = 0;
    int       key = 0;
    int px;
int py;
    CvFont font;
    cvInitFont(&font, CV_FONT_HERSHEY_PLAIN,1.0,1.0,0,1,CV_AA);

    #pragma region find_camera

    capture = cvCaptureFromCAM( 0 );
        #pragma endregion

    #pragma region detect_image
    if ( !capture ) {
        fprintf( stderr, "Cannot open initialize webcam!\n" );
        return 1;
    }
    #pragma endregion

    cvNamedWindow( "result", CV_WINDOW_AUTOSIZE );

#pragma region serial
     // // serial to zigbee setup 
  zigbee_com = new Tserial();
  if (zigbee_com!=0) {
       zigbee_com->connect("COM5", 9600, spNONE); } 
  //// serial to zigbee setup 
#pragma endregion 
    img = cvQueryFrame( capture );
    if (!img)
        exit(1);
    IplImage* gray = cvCreateImage( cvGetSize(img), 8, 1 );
    CvMemStorage* storage = cvCreateMemStorage(0);

    while( key != 'q' ) {
        img = cvQueryFrame( capture );
        if( !img ) break; 

        cvCvtColor( img, gray, CV_BGR2GRAY );
        cvSmooth( gray, gray, CV_GAUSSIAN, 9, 9 );
        CvSeq* circles = cvHoughCircles( gray, storage, CV_HOUGH_GRADIENT, 2, gray->height/4, 200, 100, 20, 100 );
        int i;
        for( i = 0; i < circles->total; i++ )
        {
            float* p = (float*)cvGetSeqElem( circles, i );

            cvCircle( img, cvPoint(cvRound(p[0]),cvRound(p[1])), cvRound(p[2]), CV_RGB(0,0,255), 2, 8, 0 );
            cvLine (img, cvPoint(cvRound(p[0]+40),cvRound(p[1])), cvPoint(cvRound(p[0]),cvRound(p[1])), CV_RGB(0,255,0), 1, CV_AA,0);
            cvLine (img, cvPoint(cvRound(p[0]),cvRound(p[1]+40)), cvPoint(cvRound(p[0]),cvRound(p[1])), CV_RGB(0,255,0), 1, CV_AA,0);
            cvLine (img, cvPoint(cvRound(p[0]-40),cvRound(p[1])), cvPoint(cvRound(p[0]),cvRound(p[1])), CV_RGB(0,255,0), 1, CV_AA,0);
            cvLine (img, cvPoint(cvRound(p[0]),cvRound(p[1]-40)), cvPoint(cvRound(p[0]),cvRound(p[1])), CV_RGB(0,255,0), 1, CV_AA,0);

            px=cvRound(p[0]); 
py=cvRound(p[1]);
if((px < 330 && px > 320) && (py > 230 && py < 250))
{

     cvPutText(img, "CENTER",cvPoint(cvRound(p[0]+45),cvRound(p[1]+45)), &font, CV_RGB(0,0,255));

     protocol = 'okie'; 
     zigbee_com->sendChar(protocol);

}
 // displays coordinates of circle's center
cout <<"(x,y) -> ("<<px<<","<<py<<")"<<endl;
        }

        cvShowImage( "result", img );
        key = cvWaitKey( 1 );

    }

    cvDestroyWindow( "result" );
    cvReleaseCapture( &capture );   

    return 0;
} 
```

串行源来自：[http ://www.tetraedre.com/advanced/serial/](http://www.tetraedre.com/advanced/serial/)

### 错误：

> 1>DetectCircle.obj：错误 LNK2019：无法解析的外部符号“public：void __cdecl Tserial::sendChar(char)”(?sendChar@Tserial@@QEAAXD@Z) 在函数 main 中引用
> 
> 1>DetectCircle.obj：错误 LNK2019：无法解析的外部符号“public：int __cdecl Tserial::connect(char *,int,enum serial_parity)”(?connect@Tserial@@QEAAHPEADHW4serial_parity@@@Z) 在函数 main 中引用
> 
> 1>DetectCircle.obj：错误 LNK2019：无法解析的外部符号“public：__cdecl Tserial::Tserial(void)”(??0Tserial@@QEAA@XZ) 在函数 main 1>C:\Users\Steven\Documents\Visual 中引用Studio 2010\Projects\mynewproject\x64\Debug\mynewproject.exe : 致命错误 LNK1120: 3 unresolved externals

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T07:34:18.633

这些是链接器错误，因为虽然实现该类的 Tserial.cpp 已复制到同一目录，但编译器并不知道它们。你需要去项目 | 添加现有项目并将其添加到那里，以便它知道它是项目的一部分并构建和链接它。

此外，您还有以下代码尝试将字符串存储为单个字符并发送它，但这是行不通的：

```
unsigned char protocol = 0;
protocol = 'okie'; 
zigbee_com->sendChar(protocol); 
```

根据与该类一起包含的 sertest2.cpp 示例，您可以使用以下内容发送字符串，其中 4 是要发送的数据的长度：

```
zigbee_com->sendArray("okie", 4); 
```

# java - Java中的if和搜索条件

> ID：14088233
> 
> 赞同：0
> 
> 时间：2012-12-30T04:08:53.677
> 
> 标签：java, if-statement

我有 7 个包含一些字符串值的 LinkedHashMap。我想搜索有多少 LinkedHashMap 包含键，有多少 LinkedHashMap 不包含搜索到的值。下面是我的示例 Java 代码。在示例 Java 代码中，我只使用了五个 LinkedHashMap。它告诉哪个 LinkedHashMap 只包含搜索词。

```
public void sampleFunction(
        LinkedHashMap<String, String> h1,
        LinkedHashMap<String, String> h2, 
        LinkedHashMap<String, String> h3,
        LinkedHashMap<String, String> h4,
        LinkedHashMap<String, String> h5) {

    String searchMe = "something";

    if(h1.containsValue(searchMe)){
        System.out.println("I am in h1");
    }
    if(h2.containsValue(searchMe)){
        System.out.println("I am in h2");
    }
    if(h3.containsValue(searchMe)){
        System.out.println("I am in h3");
    }
    if(h4.containsValue(searchMe)){
        System.out.println("I am in h4");
    }
    if(h5.containsValue(searchMe)){
        System.out.println("I am in h5");
    }

} 
```

## 编辑

例如：假设我将 7 个 LinkedHashMaps 传递给一个函数。该函数应该能够告诉我哪些传递的 LinkedHashMaps 包含搜索词。函数的输出可以是：

H1 h2 和 h3 LinkedHashMaps 包含键和 h4、h5、h6、h7 错过了搜索词。

根据输出的每种组合，我会在我的程序中调用适当的函数。例如，如果 h2 和 h3 包含该值，那么我可以调用 fBill 或 fPay。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T04:14:11.900

使用可变参数：

```
public void sampleFunction(LinkedHashMap<String, String>... hs) {
    String searchMe = "something";
    for(LinkedHashMap<String, String> h : hs) {
        if(h.containsValue(searchMe)) {
            //do whatever
        }
    }
} 
```

# jquery - 需要jquery库的ajax请求

> ID：14088234
> 
> 赞同：0
> 
> 时间：2012-12-30T04:09:01.913
> 
> 标签：jquery, ajax, qtip

我正在使用 qTip 加载一个模式，该模式使用 ajax 显示来自另一个文件的 html/js/css。正在加载的内容是大量的 css/js，只有当我在内容文件中包含 jquery javascript 文件时它才能正常工作。

它工作正常，但是当我关闭模式框时，该页面上的其他 jquery 内容都不再起作用，就像我关闭模式时 jquery 从内存中删除一样。

如何让 ajax 内容“共享”原始 jquery，或者至少在我关闭它时不将其删除？

# android - 我可以帮助 Galaxy S III 浏览器识别街道地址吗？

> ID：14088238
> 
> 赞同：4
> 
> 时间：2012-12-29T23:27:28.103
> 
> 标签：android, web, galaxy, street-address

当我的 Android 手机上的网络浏览器识别电话号码或街道地址并提供拨打该号码或映射地址时，我总是感到惊讶和高兴。

在我正在建立的一个新网站上，公司的地址在我的 Droid 4 上被识别，但在我妻子的三星 GS3 上却没有。

有什么方法可以对公司地址应用一些标记以帮助浏览器识别它？

# php - 错误 - 警告：mysql_fetch_array() 期望参数 1 是资源，布尔值在

> ID：14088239
> 
> 赞同：0
> 
> 时间：2012-12-30T04:09:56.390
> 
> 标签：php

> **可能重复：**
> [mysql_fetch_array() 期望参数 1 是资源，选择中给出的布尔值](https://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select)

我收到以下两个错误：

> 警告：mysql_num_rows() 期望参数 1 是资源，在第 51 行的 C:\xampp\htdocs\SystemVehicle\delete_multiple.php 中给出的布尔值
> 
> 警告：mysql_fetch_array() 期望参数 1 是资源，在第 75 行的 C:\xampp\htdocs\SystemVehicle\delete_multiple.php 中给出 null

```
$sql="SELECT * FROM $userlogin";
$result=mysql_query($sql);

//count table row
$count=mysql_num_rows($result);
?>
<table width="400" border="0" cellspacing="1" cellpadding="0">
<tr>
<td><form name="form1" method="post" action="">
<table width="400" border="0" cellpadding="3" cellspacing="1" bgcolor="#CCCCCC">
<tr>
<td bgcolor="#FF0000">&nbsp;</td>

<td colspan="4" bgcolor="#FF0000"><strong>Delete multiple rows in mysql</strong> </td>
</tr>
<tr>
<td align="center" bgcolor="#FF0000">#</td>
<td align="center" bgcolor="#FF0000"><strong>name</strong></td>
<td align="center" bgcolor="#FF0000"><strong>matric</strong></td>
<td align="center" bgcolor="#FF0000"><strong>Position</strong></td>
<td align="center" bgcolor="#FF0000"><strong>Department</strong></td>
<td align="center" bgcolor="#FF0000"><strong>UserName</strong></td>
<td align="center" bgcolor="#FF0000"><strong>Password</strong></td>
<td align="center" bgcolor="#FF0000"><strong>Email</strong></td>
</tr>

<?php
while($result=mysql_fetch_array($row)){
?> 
```

如何解决这些问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T04:15:01.067

您应该获取查询数组..

```
 <?php
    while($row=mysql_fetch_array($result))
    {
echo $row['some_column'];
     }
    ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T04:18:26.407

我认为您需要查看`$userlogin`包含的内容并对数据库运行该查询。

换句话说， table name:`$userlogin`不存在或需要用反引号括起来：``$userlogin``

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T04:11:38.217

`$row`不存在（即，它不是资源）

你的意思是`$result`？

编辑：刚刚看到更新，您是否尝试过回应`mysql_error()`？

# android - 2 个功能在一项活动中运行

> ID：14088241
> 
> 赞同：-1
> 
> 时间：2012-12-30T04:10:17.323
> 
> 标签：android

我可以知道如何在一个活动示例中运行两个功能 c->b->a

```
camera.takePicture(null, null, null, jpegCallBack);
public void sendemail(){
public void performDial(){ 
```

这所有功能都在一个活动中

请帮助我谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T04:56:48.937

打开你的相机，用这个拍照

```
Intent camera = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
URI pictureUri = Uri.fromFile(new File(<path where you want to save your file>));
camera.putExtra(MediaStore.EXTRA_OUTPUT, pictureUri);
startActivityForResult(camera); 
```

在那之后`onActivityResult`，

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == PICTURE_RESULT){
        if (resultCode == Activity.RESULT_OK) {
            sendEmail(Uri.parse(data.toURI()));
        } else if (resultCode == Activity.RESULT_CANCELED) {

        }
    }
}

private void sendEmail(Uri path){
    Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND); 
    emailIntent.setType("image/jpeg");
    emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, new String[]{"me@me.com"}); 
    emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "Default Subject"); 
    emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, "Default Text"); 
    emailIntent.putExtra(Intent.EXTRA_STREAM, path);
    startActivity(Intent.createChooser(emailIntent, "Send email..."));
} 
```

# c - 从 C 中的系统调用向 SCP 命令发送输入

> ID：14088243
> 
> 赞同：0
> 
> 时间：2012-12-30T04:10:59.797
> 
> 标签：c, scp

```
#include <stdlib.h>
#include <unistd.h>

int main()
{
    int euid = geteuid();
    setreuid(euid, euid);
    system("echo hi");
    system("cp test_file ~/dump.txt");
    system("scp ~/dump.txt host@ipaddress:~");
    return 0; 
```

}

上面的代码是我写的一个简短的程序，它将一个文件复制到一个转储文件，然后使用终端 scp 命令将它发送给某人。当第一次使用 scp 时，终端上会出现一个提示，询问用户是否要将密钥添加到主机名列表或类似的东西。然后它会提示输入密码。如何从该程序发送输入以便密码提示接收它？该代码是什么样的？

编辑：我面临的问题是当对 scp 进行系统调用时，程序会暂停，直到整个 scp 命令被执行，所以当这种情况发生时，输入不再从程序中获取，而是从用户那里获取. 我不知道如何从我的程序中传递 scp 的密码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:16:11.053

利用：

```
system("scp -o StrictHostKeyChecking=no ~/dump.txt host@ipaddress:~"); 
```

此选项将自动将新密钥添加到 known_hosts 文件，无需提示。

# javascript - 前端的 Meteor，后端的 Express (NodeJS)

> ID：14088246
> 
> 赞同：3
> 
> 时间：2012-12-30T04:11:08.127
> 
> 标签：javascript, node.js, express, meteor, derbyjs

对于一个想要 Meteor 在前端应用程序上提供的“实时”“反应性”并且有一个工作处理后端（类似于 Kue）的站点，前端应用程序显然受益于 Meteor。后端处理不需要 Meteor 的反应性，除了在管理 UI 中的实时报告。

*我确实了解 Meteor 是一个完整的堆栈，可以同时处理前端和后端。当我在我的问题中陈述前端时，它与为用户提供 UI 相关的所有内容，因此前端应用程序将包括客户端 HTML/CSS/Javascript 和服务器端节点/数据库。通过后端，我指的是像 Kue/Gearman 这样的工作队列中的数据处理*

**问题：**您将如何构建这样一个网站？

前端有 Meteor 支持的服务器（或节点实例），后端有一个带有 Kue/Redis 的 Express 服务器？还是两台单独的 Meteor 服务器，一台用于前端，一台用于后端？或者 1 个单独的 Meteor 服务器，用于服务前端和进行后端处理？

你推荐的理由是什么？谢谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T05:07:07.363

> 通过后端，我指的是像 Kue/Gearman 这样的工作队列中的数据处理

因为这听起来像是一个与“前端”分离的规则/处理引擎，它提供“客户端 HTML/CSS/Javascript”和“服务器端节点/数据库”，我认为很可能满足您的需求的是一个**[DDP 客户端](https://stackoverflow.com/questions/10128430/documentation-or-code-details-on-meteors-ddp-pub-sub-protocol)**，它可以订阅流星服务器端的出版物并相应地排队作业（使用诸如[Kue](http://learnboost.github.com/kue/)之类的引擎）。

这样的客户端可以在自己的环境中完全独立于 Meteor 应用程序。这样，您仍然可以利用您在 Meteor 中寻求的所有反应性优势，同时使用更成熟的处理工具来处理独立于 UI 运行的基于队列的作业。使用 DDP 客户端，您还可以重新连接到 UI，通过利用订阅在作业完成时通知客户端。

这是一个可能被证明有用的节点 DDP 客户端。 [https://github.com/oortcloud/node-ddp-client](https://github.com/oortcloud/node-ddp-client)

希望这可以帮助！

# mysql - 具有动态列的 SQL 查询 (PIVOT)

> ID：14088247
> 
> 赞同：3
> 
> 时间：2012-12-30T04:11:16.690
> 
> 标签：mysql, sql, pivot

我正在尝试编写一个将翻转此表的 SQL 查询：

```
Start_time    End_time   Instructor    Student  
9:00          9:35       Joe Bob       Andrew
9:00          9:35       Joe Bob       Smith
9:00          9:35       Roberto       Andy
10:00         10:35      Joe Bob       Angelica
11:00         11:20      Roberto       Bob 
```

变成这样：

```
Instructor    9:00              10:00         11:00
Joe Bob       Andrew, Smith     Angelica      NULL
Roberto       Andy              NULL          Bob 
```

我认为这是某种 PIVOT 命令，但我不确定应该如何编写 SQL 查询。时间都是动态生成的，所以如果查询会动态生成第二个表中的列名，我会更喜欢它（例如，如果原始表包含额外的开始时间 11:30，则应该有一个 11 的新列结果：30）。

提前谢谢你，我已经玩了一段时间了，但我自己无法让它工作。如有必要，我可以提供 SQL INSERT 命令为您提供完整数据。

编辑：将此 select 语句的结果作为 VIEW 将特别有帮助。谢谢！

编辑 2：生成创建第一个表的视图的代码是：

```
CREATE VIEW schedule_view AS SELECT RTRIM(SUBSTRING(students.schedule_first_choice, 1, 5)) AS start_time, RTRIM(SUBSTRING(students.schedule_first_choice, -10, 5) AS end_time, CONCAT(instructors.first_name, ' ', instructors.last_name) AS instructor_name, 
    CONCAT(students.first_name, ' ', students.last_name) AS student_name , students.swim_america_level as class 
    FROM students, instructors WHERE students.instructor_id = instructors.instructor_id AND students.season = 
    (SELECT constant_value FROM constants WHERE constant_name = 'season') AND students.year = 
    (SELECT constant_value FROM constants WHERE constant_name = 'year') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T04:19:32.090

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'GROUP_CONCAT(case when Start_time = ''',
      Start_time,
      ''' then Student ELSE NULL end) AS ',
      CONCAT('`',Start_time,'`')
    )
  ) INTO @sql
FROM Table1;

SET @sql = CONCAT('SELECT Instructor, ', @sql, ' 
                   FROM Table1 
                   GROUP BY Instructor');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/55577/3)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-24T11:52:14.260

在这些在 SQL SEREVR 中执行和测试的所有查询中

在 Pivot 中使用静态柱

```
 Select * from  
 (
      select Instructor,Start_time, STUFF((select ',' + student from Table1 a where         
      a.Start_time = b.Start_time and
      a.Instructor=b.Instructor for xml     path('')),1,1,'') as student
      from table1 b ) x 
 PIVOT 
 (
      max(Student) 
      for start_time IN ([9:00],[10:00], [11:00])
 ) p 
```

* * *

使用临时表动态创建数据透视表

```
 Declare @tab nvarchar(max) 
 Declare @pivottab nvarchar(max)

 Create table #Table2 (     
        instructor varchar(100),    
        student    varchar(100),    
        start_time varchar(10) 
 ); 

 insert into #Table2 (instructor,student,start_time) 
 select 
       Instructor,  
       STUFF((Select ','+student 
             from Table1 as a
         Where 
             a.Start_time = b.Start_time and 
                 a.Instructor=b.Instructor
             for xml path('')),1,1,''),
       Start_time  
 from table1 as b

 select @tab = coalesce(@tab + ',['+start_time+']' ,'['+start_time+']')  
 from #Table2  
 group by Start_time

 set @pivottab = 
     N' select * from  (
                        select Instructor, Start_time, student from #Table2 
                       ) x 
        PIVOT (
              max(Student) for start_time IN ('+@tab+') 
        ) p'

 execute(@pivottab)

 if exists(select * from #table2)
 Begin
Drop table #table2 
 End 
```

* * *

动态创建数据透视表

```
Declare @tab nvarchar(max)
Declare @pivottab nvarchar(max)

Select @tab = coalesce(@tab + ',['+start_time+']' , '['+start_time+']') from Table1
group by Start_time

set @pivottab = N'
select *
from 
(
  select Instructor,Start_time,STUFF((select '+ char(39)+char(44)+char(39) + '+ a.student from Table1 as a
where a.Start_time = b.Start_time and a.Instructor=b.Instructor for xml path('''')),1,1,'''') 
as Student from table1 as b

) x
PIVOT
(
  max(Student)
  for start_time IN ('+@tab+')
) p'

execute(@pivottab) 
```

# android - Android：getView() 方法中的 startActivityForResult 和 OnActivityResult

> ID：14088248
> 
> 赞同：1
> 
> 时间：2012-12-30T04:11:28.360
> 
> 标签：android, android-intent, android-arrayadapter, android-button, start-activity

> **可能重复：**
> [Android：将按钮单击响应从适配器类的 getView() 方法传递给 mainActivity](https://stackoverflow.com/questions/14086039/android-passing-button-click-response-from-getview-method-of-adapter-class-t)

我写了一个扩展 ArrayAdapter 的类。这个适配器处理几个 TEXTVIEW 和一个 BUTTON。对于每个按钮单击，我想通过意图与下一个活动建立双向通信。是否可以在 getView() 方法中使用 startActivityForResult 和 OnActivityResult 。如果是这样，请告诉我如何使用它。

提前致谢。

以下是getView方法

```
public View getView(final int position, View convertView, ViewGroup parent) {      
    ViewHolder holder;   
    int type = getItemViewType(position); 

    if (convertView == null) { 
        holder = new ViewHolder();  
        switch (type) {
        case 0:
            convertView = vi.inflate(R.layout.group,  null); 
            holder.menuItem = (TextView) convertView.findViewById(R.id.tvGroup);
            convertView.setBackgroundColor(Color.RED); 
            break;              
        case 1:
            convertView = vi.inflate(R.layout.confirmitem,  null); 
            holder.menuItem = (TextView) convertView.findViewById(R.id.tvConfirmItem); 
            holder.quantity = (TextView) convertView.findViewById(R.id.tvQuantity); 
            holder.cancel   = (Button)   convertView.findViewById(R.id.bCancel); 

            //   cancel button
               holder.cancel.setOnClickListener(new View.OnClickListener() {        
                    public void onClick(View v) {                   
                        Log.i("ConfirmAdapter ","Button postion  "+ position + "canceled item : " + menuItemList.get(position).getTicketItemObject().getName() ); 
                        }       
                });   
            break; 
         }  
        convertView.setTag(holder); 
    } else {
        holder = (ViewHolder) convertView.getTag();  
    }    

    switch (type) {
    case 0:         
        holder.menuItem.setText(menuItemList.get(position).getTicketItemObject().getCategoryName()) ; 
        convertView.setBackgroundColor(Color.RED);  
        break;              
    case 1:
        holder.menuItem.setText(menuItemList.get(position).getTicketItemObject().getName());
        holder.quantity.setText(Integer.toString(menuItemList.get(position).getTicketItemObject().getItemCount())); 
        break; 
     }

    return convertView; 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:12:54.093

试试这个，让我知道：

**伪代码（未经测试）：**

```
holder.cancel.setOnClickListener(new View.OnClickListener() {        
                    public void onClick(View v) {                   
                        Log.i("ConfirmAdapter ","Button postion  "+ position + "canceled item : " + menuItemList.get(position).getTicketItemObject().getName() ); 
                        }

((Activity) passedContext).startActivityForResult(.....) ;      
                }); 
```

其中passedContext 是您需要在customadapter 类的构造函数中初始化的上下文，如下所示。

```
class CustomAdapter extends ArrayAdapter
{
          private Context passedContext;
          CustomAdapter(Context context)
     {
         passedContext = context;
     }
} 
```

当您从主活动实例化 CustomAdapter 时，请执行以下操作：

```
CustomAdapter adapter = new CustomAdapter(MainAcitvityClassName.this); 
```

以上将结果返回给主活动，尽管您是从非活动类开始的。因此，您可能需要在 MainActivity 类中定义 onActivityResult(...) 。我想这就是你想要的。希望这可以帮助。

# jquery - 如何使提交表单按钮将表单值提交到数据库并更改液体滑块面板？

> ID：14088250
> 
> 赞同：1
> 
> 时间：2012-12-30T04:11:47.397
> 
> 标签：jquery, mysql

我希望它提交表单中的值，并且我希望它将它交叉链接到液体滑块，以便在单击它时更改面板

这是提交按钮

```
<input name = "submit" type="submit" class="submit1 tb10" value="Sign - Up" /> 
```

当我这样做时，它会更改面板，但不会提交数据

```
<input name = "submit" type="submit" class="submit1 tb10" value="Sign - Up" href="#3" data-liquidslider-ref="slider-id"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T01:46:25.737

[您可以通过点击事件在Liquid Slider](http://liquidslider.kevinbatdorf.com/)中有条件地设置面板 ，如下所示...

然后你使用一个jQuery点击事件......

```
$('.submit1').on('click', function() {

    // Store the slider as an object
    var sliderObject = $.data( $('#slider-id')[0], 'liquidSlider');

    // n is the tab you want to switch to.
    sliderObject.currentTab(n);
}); 
```

如果页面重新加载，那么您需要按照 charlietfl 的建议使用哈希链接

# php - 如何在 php 中查找 DOM 元素的行号？

> ID：14088253
> 
> 赞同：1
> 
> 时间：2012-12-30T04:12:16.063
> 
> 标签：php, dom

我想检查一个`<img>`标签是否有`alt=""`文本，还需要在 DOM 中找到 img 标签的行号。目前，我编写了以下代码，但一直在寻找行号。例如：

```
$doc = new DOMDocument();
$doc->loadHTMLFile('http://www.google.com');
$htmlElement = $doc->getElementsByTagName('html');
$tags = $doc->getElementsByTagName('img');
echo $tags->item(0)->getLineNo();
foreach ($tags as $image) {
    // Get sizes of elements via width and height attributes
    $alt = $image->getAttribute('alt');
    if($alt == ""){
       $src = $image->getAttribute('src'); 
       echo "No alt text ";  
      echo '<img src="http://google.com/'.$src.'" alt=""/>'. '<br>';
    }
    else{
       $src = $image->getAttribute('src'); 
         echo '<img src="http://google.com/'.$src.'" alt=""/>'. '<br>';            
    }             
} 
```

目前，从上面的代码中，我得到的图像和文字在图像旁边显示“没有替代文字”，但我想获得 img 标签出现的行号。例如这里的行号是 57，

```
56\. <div class="work_item">
57\. <p class="pich"><img src="images/works/1.jpg"    alt=""></p>
58\. </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T16:20:34.217

使用[`DOMNode::getLineNo()`](http://php.net/manual/en/domnode.getlineno.php#102771)，例如`$line = $image->getLineNo()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T04:24:01.797

HTML 没有行号的真正概念，因为它们只是空格。

考虑到这一点，您可能能够计算目标节点之前的所有文本节点中有多少换行符。你也许可以用 DOMXPath 做到这一点：

```
$xpath = new DOMXPath($doc);
$node = /* your target node */;
$textnodes = $xpath->query("./preceding::*[contains(text(),'\n')]",$node);
$line = 1;
foreach($textnodes as $textnode) $line += substr_count($textnode->textContent,"\n");
// $line is now the line number of the node. 
```

请注意，我没有对此进行测试，也从未在 xpath 中使用过轴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T06:19:51.810

我想我已经弄清楚了我想要实现的目标，但不确定这是正确的方法。它正在做这项工作。请留下评论或任何其他想法，我该如何改进它。如果您访问以下站点并键入任何 URL。它将在网页中生成包含可访问性问题的报告。它是一个可访问性检查工具。

```
http://valet.webthing.com/page/ 
```

我要做的就是实现这种布局。下面的代码将生成所提供 URL 的 DOM，并查找任何没有替代文本的图像标签。

```
<html>
<body>
    <?php
    $dom = new domDocument;
// load the html into the object
    $dom->loadHTMLFile('$yourURLAddress');
// keep white space
    $dom->preserveWhiteSpace = true;
// nicely format output
    $dom->formatOutput = true; 
    $new = htmlspecialchars($dom->saveHTML(), ENT_QUOTES);
    $lines = preg_split('/\r\n|\r|\n/', $new); //split the string on new lines
    echo "<pre>";
    //find 'alt=""' and print the line number and html tag
    foreach ($lines as $lineNumber => $line) {

        if (strpos($line, htmlspecialchars('alt=""')) !== false) {
            echo "\r\n" . $lineNumber . ". " . $line;
        }
    }
    echo "\n\n\nBelow is the whole DOM\n\n\n";
    //print out the whole DOM including line numbers
    foreach ($lines as $lineNumber => $line) {
        echo "\r\n" . $lineNumber . ". " . $line;
    }
    echo "</pre>";
    ?>   
 </body> 
</html> 
```

我要感谢所有特别帮助“chwagssd”和迈克约翰逊的人。

# ajax - 有没有推荐的 ajax 表单代码生成库或应用程序？

> ID：14088254
> 
> 赞同：3
> 
> 时间：2012-12-30T04:12:26.563
> 
> 标签：ajax, django, ajaxform

Ajax froms 正逐渐成为行业标准。越来越多的框架喜欢原生处理它，例如 scala lift 或 grails。

django 中是否有任何 ajax 自动化库可以生成这样的 ajax： [http](http://simply.liftweb.net/index-4.8.html) ://simply.liftweb.net/index-4.8.html ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T10:02:06.570

我真的不知道您所指的“AJAX 表单”是什么，因为表单只是静态 HTML 元素。我的猜测是您可能正在考虑 ajax 表单验证。

在这种情况下，由 Django 表单生成的静态 HTML 代码就足够了。您所要做的就是编写一些 JavaScript（我会使用 jQuery）并在服务器端进行一些不同的处理。

请看看 [http://alexkehayias.tumblr.com/post/1402015536 ​​0/django-form-validation-ajax](http://alexkehayias.tumblr.com/post/14020155360/django-form-validation-ajax)

及其应用程序 [http://pypi.python.org/pypi/django-ajax-forms/](http://pypi.python.org/pypi/django-ajax-forms/)

# android - 报警设计实践

> ID：14088260
> 
> 赞同：0
> 
> 时间：2012-12-30T04:13:53.663
> 
> 标签：android, android-alarms

我对android中的警报有两个问题。我的应用程序根据用户的要求使用警报管理器设置警报

1- 如果我的应用程序正在更新（从 google play 下载更新），警报会丢失并且我必须重新安排它们吗？或者他们仍然会被触发？

2- 在我的警报到期后，我想在屏幕上显示 Foo 对象。目前，我已将此 Foo 对象序列化并作为警报附加的意图传递。这个可以吗？或者我应该传递 id，并在到期时提取该 ID，调用我的 SqlDatabase 并相应地构造对象？

请帮忙谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T05:57:32.487

当警报对应用程序非常重要时，我通常会在以下事件中检查它的存在（并在必要时创建它）：

*   设备启动时 (android.intent.action.BOOT_COMPLETED)
*   应用程序启动时
*   当应用程序更新（android.intent.action.PACKAGE_REPLACED）时，我重置警报（取消并重新创建）。

我不记得确切的原因，但我之前在应用程序更新时发生了警报错误，这就是为什么我正在听这个并重置警报。

我将警报信息保存在 SharedPreferences 中，因此我可以轻松检索它并在崩溃时重新创建警报。

对于您的第二个问题，我认为仅传递 id 在资源方面更有效，但这取决于您的警报触发的频率。

# android - 使用微调器和编辑文本实现重置按钮时无法获得相同的值

> ID：14088261
> 
> 赞同：1
> 
> 时间：2012-12-30T04:13:55.020
> 
> 标签：android, spinner, runtime-error

我有 10 个微调器和 10 个编辑文本（用户可以让多个微调器和编辑文本空白），并且我还有 2 个按钮来对所选微调器对象的值求和并编辑文本。对值求和是成功的，但是当我使用重置按钮回到应用程序首次启动时的初始状态时，我遇到了问题。结果是错误的，即使我已将其设置回默认值，我还是从第一次操作中获得了值。这是我的重置按钮代码

```
hapus.setOnClickListener(new View.OnClickListener()
    {
        public void onClick(View v)
        {
            qty1.setText(null);
            qty2.setText(null);
            qty3.setText(null);
            qty4.setText(null);
            qty5.setText(null);
            qty6.setText(null);
            qty7.setText(null);
            qty8.setText(null);
            qty9.setText(null);
            qty10.setText(null);
            spin1.setSelection(0);
            spin2.setSelection(0);
            spin3.setSelection(0);
            spin4.setSelection(0);
            spin5.setSelection(0);
            spin6.setSelection(0);
            spin7.setSelection(0);
            spin8.setSelection(0);
            spin9.setSelection(0);
            spin10.setSelection(0);
            sum.setText(null);
            hasil = 0;
        }
    }); 
```

这是我的微调器和求和操作代码的一部分

```
spin8.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener()
    {
        @Override
        public void onItemSelected(AdapterView<?> parent, View selectedItem, int pos, long id)
        {
            Object item = parent.getItemAtPosition(pos);
            value8 = item.toString();
            if (item.equals("null"))
            {
                hrg8 = 0;
            }
            else if (item.equals("Soto Istimewa"))
            {
                hrg8 = 24000;
            }
            else if (item.equals("Soto Biasa"))
            {
                hrg8 = 17000;
            }
            else if (item.equals("Nasi Putih"))
            {
                hrg8 = 4000;
            }
            else if (item.equals("Emping"))
            {
                hrg8 = 2000;
            }
            else if (item.equals("Kerupuk"))
            {
                hrg8 = 1000;
            }
            else if (item.equals("Es Teh"))
            {
                hrg8 = 2000;
            }
            else if (item.equals("Es Teh Manis"))
            {
                hrg8 = 3000;
            }
            else if (item.equals("Es Teh Botol"))
            {
                hrg8 = 5000;
            }
            else if (item.equals("Teh Botol Dingin"))
            {
                hrg8 = 3000;
            }
            else if (item.equals("Air Jeruk Panas"))
            {
                hrg8 = 7000;
            }
            else if (item.equals("Air Jeruk Dingin"))
            {
                hrg8 = 7000;
            }
            else if (item.equals("Aqua"))
            {
                hrg8 = 3000;
            }
        }

        @Override
        public void onNothingSelected(AdapterView<?> parent)
        {

        }
    });

    spin9.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener()
    {
        @Override
        public void onItemSelected(AdapterView<?> parent, View selectedItem, int pos, long id)
        {
            Object item = parent.getItemAtPosition(pos);
            value9 = item.toString();
            if (item.equals("null"))
            {
                hrg9 = 0;
            }
            else if (item.equals("Soto Istimewa"))
            {
                hrg9 = 24000;
            }
            else if (item.equals("Soto Biasa"))
            {
                hrg9 = 17000;
            }
            else if (item.equals("Nasi Putih"))
            {
                hrg9 = 4000;
            }
            else if (item.equals("Emping"))
            {
                hrg9 = 2000;
            }
            else if (item.equals("Kerupuk"))
            {
                hrg9 = 1000;
            }
            else if (item.equals("Es Teh"))
            {
                hrg9 = 2000;
            }
            else if (item.equals("Es Teh Manis"))
            {
                hrg9 = 3000;
            }
            else if (item.equals("Es Teh Botol"))
            {
                hrg9 = 5000;
            }
            else if (item.equals("Teh Botol Dingin"))
            {
                hrg9 = 3000;
            }
            else if (item.equals("Air Jeruk Panas"))
            {
                hrg9 = 7000;
            }
            else if (item.equals("Air Jeruk Dingin"))
            {
                hrg9 = 7000;
            }
            else if (item.equals("Aqua"))
            {
                hrg9 = 3000;
            }
        }

        @Override
        public void onNothingSelected(AdapterView<?> parent)
        {

        }
    });

    spin10.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener()
    {
        @Override
        public void onItemSelected(AdapterView<?> parent, View selectedItem, int pos, long id)
        {
            Object item = parent.getItemAtPosition(pos);
            value10 = item.toString();
            if (item.equals("null"))
            {
                hrg10 = 0;
            }
            else if (item.equals("Soto Istimewa"))
            {
                hrg10 = 24000;
            }
            else if (item.equals("Soto Biasa"))
            {
                hrg10 = 17000;
            }
            else if (item.equals("Nasi Putih"))
            {
                hrg10 = 4000;
            }
            else if (item.equals("Emping"))
            {
                hrg10 = 2000;
            }
            else if (item.equals("Kerupuk"))
            {
                hrg10 = 1000;
            }
            else if (item.equals("Es Teh"))
            {
                hrg10 = 2000;
            }
            else if (item.equals("Es Teh Manis"))
            {
                hrg10 = 3000;
            }
            else if (item.equals("Es Teh Botol"))
            {
                hrg10 = 5000;
            }
            else if (item.equals("Teh Botol Dingin"))
            {
                hrg10 = 3000;
            }
            else if (item.equals("Air Jeruk Panas"))
            {
                hrg10 = 7000;
            }
            else if (item.equals("Air Jeruk Dingin"))
            {
                hrg10 = 7000;
            }
            else if (item.equals("Aqua"))
            {
                hrg10 = 3000;
            }
        }

        @Override
        public void onNothingSelected(AdapterView<?> parent)
        {

        }
    });

    hitung.setOnClickListener(new View.OnClickListener()
    {
        public void onClick(View v)
        {
            try
            {
                if (qty1.getText().toString() != null && !(qty1.getText().toString().equals("")))
                {
                    jml1 = Integer.parseInt(qty1.getText().toString());
                    item1 = hrg1 * jml1;
                }
                else 
                {
                    jml1 = 0;
                }
                if (qty2.getText().toString() != null && !(qty2.getText().toString().equals("")))
                {
                    jml2 = Integer.parseInt(qty2.getText().toString());
                    item2 = hrg2 * jml2;
                }
                else 
                {
                    jml2 = 0;
                }
                if (qty3.getText().toString() != null && !(qty3.getText().toString().equals("")))
                {
                    jml3 = Integer.parseInt(qty3.getText().toString());
                    item3 = hrg3 * jml3;
                }
                else 
                {
                    jml3 = 0;
                }
                if (qty4.getText().toString() != null && !(qty4.getText().toString().equals("")))
                {
                    jml4 = Integer.parseInt(qty4.getText().toString());
                    item4 = hrg4 * jml4;
                }
                else 
                {
                    jml4 = 0;
                }
                if (qty5.getText().toString() != null && !(qty5.getText().toString().equals("")))
                {
                    jml5 = Integer.parseInt(qty5.getText().toString());
                    item5 = hrg5 * jml5;
                }
                else 
                {
                    jml5 = 0;
                }
                if (qty6.getText().toString() != null && !(qty6.getText().toString().equals("")))
                {
                    jml6 = Integer.parseInt(qty6.getText().toString());
                    item6 = hrg6 * jml6;
                }
                else 
                {
                    jml6 = 0;
                }
                if (qty7.getText().toString() != null && !(qty7.getText().toString().equals("")))
                {
                    jml7 = Integer.parseInt(qty7.getText().toString());
                    item7 = hrg7 * jml7;
                }
                else 
                {
                    jml7 = 0;
                }
                if (qty8.getText().toString() != null && !(qty8.getText().toString().equals("")))
                {
                    jml8 = Integer.parseInt(qty8.getText().toString());
                    item8 = hrg8 * jml8;
                }
                else 
                {
                    jml8 = 0;
                }
                if (qty9.getText().toString() != null && !(qty9.getText().toString().equals("")))
                {
                    jml9 = Integer.parseInt(qty9.getText().toString());
                    item9 = hrg9 * jml9;
                }
                else 
                {
                    jml9 = 0;
                }
                if (qty10.getText().toString() != null && !(qty10.getText().toString().equals("")))
                {
                    jml10 = Integer.parseInt(qty10.getText().toString());
                    item10 = hrg10 * jml10;
                }
                else 
                {
                    jml10 = 0;
                }
                hasil = item1 + item2 + item3 + item4 + item5 + item6 + item7 + item8 + item9 + item10;
                Toast.makeText(getApplicationContext(), "Rp. " + hasil, Toast.LENGTH_LONG).show();
                sum.setText("Rp. " + Integer.toString(hasil));
            }
            catch(Exception e)
            {
                Toast.makeText(getApplicationContext(), "Quantity can't be empty. Please type item quantity", Toast.LENGTH_LONG).show();
            }     
        }
    }); 
```

任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T04:18:12.887

您正在尝试`null`用作字符串：

```
if (item.equals("null")) 
```

它应该是：

```
if (item == null) 
```

Spinner 或 EditText 的默认值也不是空字符串（即`""`）`null`。我相信你应该`.setText("");`在重置值时使用，所以第一个 if 语句应该是：

```
if (item.isEmpty()) // or item.equals("") 
```

最后，您是否有 10 个 OnItemSelectedListeners 包含 80-90% 的相同代码？如果是这样，您应该编写一个通用侦听器并使用`parent.getId()`它来确定要设置的值。

# firefox - Web字体在本地的Firefox中不起作用，但在服务器上起作用

> ID：14088263
> 
> 赞同：0
> 
> 时间：2012-12-30T04:14:21.973
> 
> 标签：firefox, webfonts

我正在本地开发一个站点，并且正在使用 webfonts 作为符号。当我只是在浏览器中查看文件（即 file:///path/to/file.html）时，webfonts 在 Chrome 中工作，但在 Firefox 中不工作。但是，如果我将站点上传到我的服务器并在 Firefox 中查看该文件，它就可以正常工作。知道为什么会这样以及我可以做些什么来在本地正确查看文件吗？

这是一个代码片段（所有路径都有效）：

```
@font-face {
font-family: 'WebSymbolsRegular';

src: url('fonts/websymbols.eot?#iefix') format('embedded-opentype'),
     url('fonts/websymbols.woff') format('woff'),
     url('fonts/websymbols.ttf') format('truetype'),
     url('fonts/websymbols.svg#WebSymbolsRegular') format('svg'),
     url('fonts/websymbols.eot'); 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T07:10:29.353

这很可能是由于协议（文件而不是 http）。您几乎总是希望在本地服务器上进行测试，而不仅仅是在浏览器中从磁盘打开页面。为 Linux 安装 Apache、Nginx 或 Lighttpd；或 IIS、IIS Express 或适用于 Windows 的 Apache。然后，设置一个指向您站点所在文件夹的本地站点（即 localhost:1234），并通过该站点运行您的页面。

# ruby - 比较数组中的值？

> ID：14088268
> 
> 赞同：-3
> 
> 时间：2012-12-30T04:15:11.613
> 
> 标签：ruby

我需要比较数组中的值。

例如，我的数组是：

```
[18, 1, 113, 103, 1100, 909, 94, 67, 61] 
```

我需要比较每个值，比如`18->1`,`1->113`等等`113->103`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T04:39:47.573

你没有说你想要什么样的比较，但这将遍历数组，比较连续的元素：

```
puts [
  18, 1, 113, 103, 1100, 909, 94, 67, 61
].each_cons(2).map{ |a, b| a <=> b } 
```

哪个输出：

```
1
-1
1
-1
1
1
1
1 
```

比较运算符`<=>`用于排序以比较两个值。它在 时返回 -1，在 时返回`a < b`0，在 时返回`a == b`1 `a > b`。

所以，这告诉我们 , `18 > 1`, `1 < 113`,`113 > 103`和`103 < 1100`所有其余的都是按降序排列的。

替换`<=>`为您需要的任何比较。

# python - Python - 没有名为 setuptools 的模块

> ID：14088270
> 
> 赞同：2
> 
> 时间：2012-12-30T04:16:01.643
> 
> 标签：python, macos

我正在尝试在我的 Mac (OS X 10.7.4) 上安装的 Python (3.3.0) 的替代版本上安装模块。新版本的 Python 在 IDLE 和终端中运行正常：

但是，尝试安装像 NumPy 这样相对微不足道的东西只会安装在我的 Mac (2.7.1) 上预装的旧 Python 版本中。

执行这个：

```
$ python3.3 easy_install numpy 
```

给我这个错误信息：

> /Library/Frameworks/Python.framework/Versions/3.3/Resources/Python.app/Contents/MacOS/Python：无法打开文件'easy_install'：[Errno 2]没有这样的文件或目录

然后我读到创建虚拟环境是要走的路，所以我尝试了：

```
$ mkvirtualenv python=python3.3 foo 
```

它返回了这个错误：

> -bash：mkvirtualenv：找不到命令

所以，我显然也没有正确安装（`virtualenv-1.8.4`）。

我可能需要做更多的功课，但我真的没有打算再次使用 2.7，只是 Python 3，所以我不需要来回走动。同时我知道无论出于何种原因我都需要在我的 Mac 上保留旧版本的 Python，所以我不打算删除它。对于我所缺少的任何建议都会非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T04:40:47.317

试试这个：

```
easy_install numpy 
```

easy_install 是一个 shell 脚本，而不是 python 脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T08:44:00.243

你有错误的命令。代替：

```
$ python3.3 easy_install numpy 
```

你要：

```
$ easy_install3 numpy 
```

甚至更具体：

```
$ easy_install-3.3 numpy 
```

[但你不应该首先`easy_install`使用](https://stackoverflow.com/questions/3220404/why-use-pip-over-easy-install)：

```
$ pip3 install numpy 
```

或更具体`pip3`：

```
$ pip-3.3 install numpy 
```

* * *

如果你看得更深，你会发现两者`pip3`都是`pip-3.3`一样的：

```
$ pip3 --version
pip 1.2.1 from /usr/local/lib/python3.3/site-packages/pip-1.2.1-py3.3.egg (python 3.3)
$ pip-3.3 --version
pip 1.2.1 from /usr/local/lib/python3.3/site-packages/pip-1.2.1-py3.3.egg (python 3.3) 
```

两者`easy_install3`和`easy_install-3.3`都是一样的：

```
$ easy_install3 --version
distribute 0.6.32
$ easy_install-3.3 --version
distribute 0.6.32 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-17T15:42:38.807

我通过使用 Enthought 的 Anaconda 解决了这个问题。它有我需要的所有插件等。感谢大家的建议和帮助！:)

# documentation - 将库的文档添加到手册页

> ID：14088271
> 
> 赞同：2
> 
> 时间：2012-12-30T04:16:21.617
> 
> 标签：documentation, ffmpeg, shared-libraries, ubuntu-12.04, manpage

我正在使用 Ubuntu 12.04.1 。我正在学习使用 C 中的 FFmpeg 库制作基本的视频播放器。我的手册页没有显示 library 的 headers/functions 的任何条目。有人可以告诉我一种将文档添加到我的手册页的方法吗？
这样搜索比每次都在网页上搜索要容易得多。

PS：我尝试使用 Synaptic 包管理器将文档添加到手册页。我安装了一个**ffmpeg-doc**包。但它似乎不起作用。

谢谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:18:09.150

这能解决你的问题吗 -

[http://ffmpeg-users.933282.n4.nabble.com/Building-man-pages-td934441.html](http://ffmpeg-users.933282.n4.nabble.com/Building-man-pages-td934441.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-30T11:24:20.887

`FFmpeg`项目用于`doxygen`创建文档。Doxygen 可以配置为输出 man 格式。

像下面这样修改文件`doc/Doxyfile`，告诉 doxygen 你想要手册页格式。

```
GENERATE_MAN           = YES
MAN_LINKS              = YES 
```

`MAN_LINKS`选项非常重要，因为如果省略它，您将无法通过名称找到正确的 api 调用。

通过 invoke 配置 ffmpeg 项目后`./configure ...`，使用目标`apidoc`创建手册页。

```
$ make apidoc 
```

手册页将输出到`doc/doxy/man/man3`，然后将此路径附加到您的手册页搜索路径。

```
$ export MANPATH=$MANPATH:`pwd`/doc/doxy/man 
```

然后您可以查找 ffmpeg 库 api 的手册页。

```
$ man av_register_all 
```

### 笔记

doxygen 为大多数 api 库生成的手册页只是一个指向真实源手册页的链接。

使用 man 打开后，您必须使用 key`/`搜索并跳转到您想要的文档部分。

# c - Raw Socket Linux 发送/接收数据包

> ID：14088274
> 
> 赞同：9
> 
> 时间：2012-12-30T04:16:49.823
> 
> 标签：c, sockets, networking, send, recv

接收数据包有一些问题。我可以接收和读取传入的数据包，但我认为我没有与任何主机握手。我只想在收到答案时向具有开放端口的远程计算机发送一个数据包，以查看 TTL（生存时间）和窗口大小。有谁知道错误在哪里？~~（我对C编程没有很深的了解）~~

代码：

```
#include <sys/types.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/socket.h>
#include <errno.h>
#include <unistd.h>
#include <arpa/inet.h>
#include <net/ethernet.h>
#include <netinet/in.h>
#include <netinet/ip.h>
#include <netinet/tcp.h>

struct pseudohdr {
    u_int32_t src_addr;
    u_int32_t dst_addr;
    u_int8_t padding;
    u_int8_t proto;
    u_int16_t length;
};

struct data_4_checksum {
    struct pseudohdr pshd;
    struct tcphdr tcphdr;
    char payload[1024];
};
unsigned short comp_chksum(unsigned short *addr, int len) {
    long sum = 0;

    while (len > 1) {
        sum += *(addr++);
        len -= 2;
    }

    if (len > 0)
        sum += *addr;

    while (sum >> 16)
        sum = ((sum & 0xffff) + (sum >> 16));

    sum = ~sum;

    return ((u_short) sum);

}

int main(int argc, char *argv[]) {

    int sock, bytes, on = 1;
    char buffer[1024];
    struct iphdr *ip;
    struct tcphdr *tcp;
    struct sockaddr_in to;
    struct pseudohdr pseudoheader;
    struct data_4_checksum tcp_chk_construct;

    if (argc != 2) {
        fprintf(stderr, "Usage: %s ", argv[0]);
        fprintf(stderr, "<dest-addr>\n");
        return 1;
    }

    sock = socket(AF_INET, SOCK_RAW, IPPROTO_TCP);
    if (sock == -1) {
        perror("socket() failed");
        return 1;
    }else{
        printf("socket() ok\n");
    }

    if (setsockopt(sock, IPPROTO_IP, IP_HDRINCL, &on, sizeof(on)) == -1) {
        perror("setsockopt() failed");
        return 2;
    }else{
        printf("setsockopt() ok\n");
    }

    ip = (struct iphdr*) buffer;
    tcp = (struct tcphdr*) (buffer + sizeof(struct tcphdr));

    int iphdrlen = sizeof(struct iphdr);
    int tcphdrlen = sizeof(struct tcphdr);
    int datalen = 0;
    printf("Typecasting ok\n");

    ip->frag_off = 0;
    ip->version = 4;
    ip->ihl = 5;
    ip->tot_len = htons(iphdrlen + tcphdrlen);
    ip->id = 0;
    ip->ttl = 40;
    ip->protocol = IPPROTO_TCP;
    ip->saddr = inet_addr("192.168.165.135");
    ip->daddr = inet_addr(argv[1]);
    ip->check = 0;

    tcp->source     = htons(12345);
    tcp->dest       = htons(80);
    tcp->seq        = random();
    tcp->doff       = 5;
    tcp->ack        = 0;
    tcp->psh        = 0;
    tcp->rst        = 0;
    tcp->urg        = 0;
    tcp->syn        = 1;
    tcp->fin        = 0;
    tcp->window     = htons(65535);

    pseudoheader.src_addr = ip->saddr;
    pseudoheader.dst_addr = ip->daddr;
    pseudoheader.padding = 0;
    pseudoheader.proto = ip->protocol;
    pseudoheader.length = htons(tcphdrlen + datalen);

    tcp_chk_construct.pshd = pseudoheader;
    tcp_chk_construct.tcphdr = *tcp;

    int checksum = comp_chksum((unsigned short*) &tcp_chk_construct,
            sizeof(struct pseudohdr) + tcphdrlen + datalen);

    tcp->check = checksum;

    printf("TCP Checksum: %i\n", checksum);
    printf("Destination : %i\n", ntohs(tcp->dest));
    printf("Source: %i\n", ntohs(tcp->source));

    to.sin_addr.s_addr = ip->daddr;
    to.sin_family = AF_INET;
    to.sin_port = tcp->dest;

    bytes = sendto(sock, buffer, ntohs(ip->tot_len), 0, (struct sockaddr*) &to,
            sizeof(to));

    if (bytes == -1) {
        perror("sendto() failed");
        return 1;
    }

    recv(sock, buffer, sizeof(buffer), 0);
    printf("TTL= %d\n", ip->ttl);
    printf("Window= %d\n", tcp->window);
    printf("ACK= %d\n", tcp->ack);
    printf("%s:%d\t --> \t%s:%d \tSeq: %d \tAck: %d\n",
                    inet_ntoa(*(struct in_addr*) &ip->saddr), ntohs(tcp->source),
                    inet_ntoa(*(struct in_addr *) &ip->daddr), ntohs(tcp->dest),
                    ntohl(tcp->seq), ntohl(tcp->ack_seq));

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-30T04:48:45.727

1.  您正在接收和存储数据包`buffer`，但是您正在从`ip`和`tcp`不解析该缓冲区的情况下打印数据。`buffer` **您应该在收到数据包之后**和**打印之前**解析数据包。
2.  您的代码假定所有数据包都是 TCP，但事实并非如此。RAW 套接字仅支持第 3 层协议（IP、ICMP 等）。换句话说，`IPPROTO_TCP`在创建 RAW 套接字时使用会产生误导。坚持`IPPROTO_IP`，并为您关心的每个协议（TCP、UDP 等）添加必要的条件。这恰好起作用，因为 Linux 内核验证了协议号，并回退到`IPPROTO_IP`. 但是，这可能不适用于其他系统。
3.  检查您的网络通信是否使用正确的字节顺序。网络字节顺序是 Big-Endian，而主机字节顺序取决于您的架构，因此您可能需要来回转换多字节字段。
4.  您`tcp->seq`的值可能无效，因为 TCP 只接受最高 65535 的值，而`random()`返回从 0 到`RAND_MAX`(0x7fffffff) 的值。尝试`tcp->seq = htonl(random() % 65535);`
5.  您对 TCP 标头的偏移量计算不正确。应该是`sizeof(struct iphdr)`而不是`sizeof(struct tcphdr)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-29T06:31:27.947

```
ip = (struct iphdr*) buffer;
tcp = (struct tcphdr*) (buffer + sizeof(struct tcphdr)); //This is wrong 
```

此处要获取 tcp 标头的数组索引`buffer`，您需要像下面提到`sizeof(struct iphdr)`的那样添加。`buffer`

```
ip = (struct iphdr*) buffer;
tcp = (struct tcphdr*) (buffer + sizeof(struct iphdr)); //This is correct 
```

# javascript - 如何每 5 秒旋转一次背景图像？javascript？

> ID：14088275
> 
> 赞同：1
> 
> 时间：2012-12-30T04:17:05.447
> 
> 标签：javascript, css, xhtml, background

我不确定如何正确解释这一点，所以请耐心等待...

我一直在寻找有关如何旋转图像/背景文件夹的答案，以便它每 5 秒更改一次背景，如果它也可以淡入淡出，那将是一个奖励。我找到了一些类似的答案，但在尝试使其适应我的页面时遇到了一些困难。

我不确定我应该提供什么信息，所以我将继续发布我的索引，然后是我的样式表。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<link rel="shortcut icon" href="images/favicon.ico" />
<link href="css/styler.css" rel="stylesheet" type="text/css" />

</head>

<body>

<!--Start Main Canvas-->
<div class="maincanvas">

</div><!--End Main Canvas-->
</body>
</html> 
```

我目前在“styler.css”样式表中显示我的背景，如下所示

```
 .maincanvas {
    background-image: url(../images/background/bg_image01.jpg);
    background-position: center;
    background-repeat: no-repeat;
    height: auto;
    left: 0px;
    min-height: 100%;
    min-width: 1100px;
    position: fixed;
    top: 0px;
    width: 100%;
 } 
```

我希望这是足够的信息，对此的任何帮助都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T16:00:39.507

你可以使用 css 关键帧来做这样的事情。

因此，您将设置关键帧，您需要在浏览器中添加这些前缀，一种快速的方法是使用[http://prefixr.com](http://prefixr.com)。

```
@keyframes "bg" {
 0% {
    background: url(link/to/image);
 }
 20% {
    background: url(link/to/image);
 }
 40% {
    background: url(link/to/image);
 }
 60% {
    background: url(link/to/image);
 }
 80% {
    background: url(link/to/image);
 }
 100% {
    background: url(link/to/image);
 }

} 
```

然后像这样设置动画（再次记住前缀）。

```
animation: bg 25s 0 infinite ease; 
```

因此，无限循环上的总动画时间为 5 x 5s = 25s。

当然，这样做的缺点是您必须手动添加图片网址。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-30T05:50:22.633

[这](http://trendmedia.com/news/infinite-rotating-images-using-jquery-javascript/)是一个旋转图像的示例，但它使用 jQuery。

# python - 使用自制 Python 在 Mac 10.8 上安装 scipy 的正确位置是什么？

> ID：14088278
> 
> 赞同：4
> 
> 时间：2012-12-30T04:17:35.580
> 
> 标签：python, macos, scipy

我听从了大多数 pythonistas 的建议，设置了一个与 Mac OS X 内置的 Python 不同的 Python 版本。在四处浏览之后，似乎处理事情的最好方法是使用`homebrew`，然后跟进`pip`。一切都很好`numpy`，然后事情就变糟了。我不能`scipy`安装也不能`matplotlib`。在 StackOverflow 上搜索并尝试了许多解决方案后，我终于偶然发现了 Chris Fonnesbeck 的[“Scipy Superpack”](http://fonnesbeck.github.com/ScipySuperpack/)，它承诺：

> 安装 Numpy (1.8) 和 Scipy (0.12)、Matplotlib (1.3)、iPython (0.14)、Pandas (0.10)、Statsmodels (0.5.0)、Scikit-Learn 0.13 以及 PyMC (2.2) 的最新 64 位版本) 适用于英特尔 Macintosh 上的 OS X 10.8 (Mountain Lion)。

这对我的菜鸟来说听起来很棒，但是当我查看安装脚本时`install_superpack.sh`，它似乎正在指导事情与系统的 python 版本一起工作：

```
#!/bin/sh
PYTHON='/usr/bin/python'
GIT_FILENAME='git-1.7.7.3-intel-universal-snow-leopard'
GIT_VOLUME='/Volumes/Git 1.7.7.3 Snow Leopard Intel Universal/'
GFORTRAN='gcc-42-5666.3-darwin11.pkg'
SUDO='sudo' 
```

我应该更改`PYTHON`上面的变量还是保留它并对 PYTHON 环境进行调整（是？！不是！？）我在其他地方读过的thingamabob？如果有的话，我还应该编辑什么？或者我应该退出这个脚本，因为我显然已经超出了我的深度？

我应该注意，我非常喜欢`matplotlib`在我的机器上运行，因为我想为我正在追求的一些文本分析制作直方图。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T05:19:51.420

superpack 是为 Apple python 编译的。它可能适用于自制软件中的 python，但不推荐。

顺便说一句，当你说：

> 处理事情的最好方法似乎是使用自制软件，然后用 pip 跟进

如果这是真的，那么这里就不会有很多人在使用 homebrew/pip 安装 scipy 时遇到问题。Homebrew 和 pip 非常适合简约的纯 python 包。但是他们在 scipy 或需要外部非 python 包的包上绊倒了。

随着 Macports 现在有一个适用于 OSX 10.8 的 buildbot，我个人认为没有理由有人愿意为科学的 python 安装而使用 homebrew/pip。有了良好的互联网连接，安装完整的设置将需要几分钟，并且您可以拥有带有任意数量后端的 matplotlib。

# mysql - mysql中的计算字段？

> ID：14088279
> 
> 赞同：1
> 
> 时间：2012-12-30T04:17:47.500
> 
> 标签：mysql, stored-procedures, triggers, calculated-field

> **可能重复：**
> [插入后和更新后的 MySQL 触发器](https://stackoverflow.com/questions/5201497/mysql-trigger-after-insert-and-after-update)

我有一个表格，例如：类型 | 平台 | 姓名 | 版本 | 全名

当有插入或更新时，我想用“Type.Platform.Name.Version”更新全名。

我认为 CONCAT_WS('.', Type,Platform,Name,Version) 会提供我想要的数据，但是如何将它放入 FullName 字段？

我查看了触发器，但它们无法更新与数据所在的同一个表。我没有看到自动化存储过程的方法，但也许我没有完全理解它们。

也许只有可以触发的 FullName 字段的表？任何见解表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T04:34:53.710

您可以执行 BEFORE INSERT 和 BEFORE UPDATE 触发器。

```
CREATE TRIGGER fullname_update BEFORE UPDATE ON table
  FOR EACH ROW BEGIN
    SET NEW.fullname = CONCAT_WS('.', NEW.type, NEW.platform, NEW.name, NEW.version);
  END; 
```

您可以对 BEFORE INSERT 触发器执行相同的操作。希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T04:32:10.363

如果您不拘泥于特定版本的 MySQL，您可能需要考虑[MariaDB](https://mariadb.org/)，它支持“[虚拟列](https://kb.askmonty.org/en/virtual-columns/)”。这将解决您遇到的问题。

请注意，MariaDB 是 MySQL 的一个分支，因此您仍将拥有所有标准 MySQL 功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T04:51:30.953

您的解决方案是[MySQL 视图](http://dev.mysql.com/doc/refman/5.0/en/views.html)。

您有一个包含实际数据的表和一个称为“视图”的实体，您可以将其用作常规表 - 从中​​发出请求、进行更新等。我多次使用它的目的与你问，你应该探索它们。

当然，使用有限制，但根据您的问题，它会满足您的需求。

# django - Django购物车不更新数量

> ID：14088282
> 
> 赞同：1
> 
> 时间：2012-12-30T04:18:19.060
> 
> 标签：django, forms, views

您好，我正在编写我的电子商务 django 教程，由于某种原因，我的简单购物车计数不起作用。每次我添加到购物车时，我的 cart.html 中的 {{cart_item_count}} 都是 0

同样与此代码有关，这本书将我的 carts.py 设置为 cart.py，但由于该应用程序由于某种原因是 cart 不喜欢这样，所以我将我的 cart.py 重命名为“carts.py”，并从 cart import carts 执行此操作大车

Django不允许与应用程序同名的py文件吗？？？

帮助代码

carts.py 有一个函数 def cart_disinct_item_count(request) 返回在我的 views.py 中调用的计数以设置变量“cart_item_count”，该变量显示在我的 cart.html 页面中，但目前无论我的表单有什么都返回 0 .

我没有发布整个项目代码，但我想我得到了所有需要的相关信息。

谢谢

购物车.html

```
{% block content %}
<h1>Cart Page Here</h1>
Cart item count: {{cart_item_count }}
{% endblock %} 
```

购物车视图.py

```
# Create your views here.
from django.shortcuts import render_to_response
from django.template import RequestContext
from cart import carts as cart

def show_cart(request, template_name="cart/cart.html"):
    cart_item_count = cart.cart_disinct_item_count(request)
    page_title = 'Shopping Cart'
    return render_to_response("cart/cart.html", locals(),
                          context_instance = RequestContext(request)) 
```

购物车项目模型

```
class CartItem(models.Model):
cart_id = models.CharField(max_length=50)
date_added = models.DateTimeField(auto_now_add = True)
quantity = models.IntegerField(default = 1)
product = models.ForeignKey('catalog.Product', unique = False)

class Meta:
    app_label = ''
    db_table = 'cart_items'
    ordering = ['date_added']

def total(self):
    return self.quantity * self.product.price
def name(self):
    return self.product.name
def price(self):
    return self.product.price

def get_absolute_url(self):
    return self.product.get_absolute_url()
def augment_quantity(self, quantity):
        """ called when a POST request comes in for a Product instance already in the shopping cart """
        self.quantity = self.quantity + int(quantity)
        self.save() 
```

购物车.py

```
def get_cart_items(request):
    return CartItem.objects.filter(cart_id=_cart_id(request))

#add an item to the cart
def add_to_cart(request):    
    postdata = request.POST.copy()
    #get product slug from post data, return blank if empty
    product_slug = postdata.get('product_slug', '')
    #get quantity added, return 1 if empty
    quantity = postdata.get('quantity', 1)
    #fetch the product or return a missing page error
    p = get_object_or_404(Product, slug = product_slug)
    #get products in cart
    cart_products = get_cart_items(request)
    product_in_cart = False
    #check to see if item is already in cart
    for cart_item in cart_products:
        if cart_item.product.id == p.id:
            #update the quantity if found
            cart_item.augment_quantity(quantity)
            product_in_cart = True
        if not product_in_cart:
            #create and save a new cart item
            ci = CartItem()
            ci.product = p
            ci.quantity = quantity
            ci.cart_id = _cart_id(request)
            ci.save()
#returns the total number of items in the user's cart
def cart_disinct_item_count(request):
    return get_cart_items(request).count() 
```

表格.py：

```
class ProductAddToCartForm(forms.Form):
quantity = forms.IntegerField(widget=forms.TextInput(attrs={'size':'2',
                              'value':'1', 'class':'quantity'}),
                              error_messages={'invalid': 'Please enter a valid quantity'},
                              min_value = 1)
product_slug = forms.CharField(widget = forms.HiddenInput())

#override the default __init__ so we can set the request
def __init__(self, request = None, *args, **kwargs):
    self.request = request
    super(ProductAddToCartForm, self).__init__(*args, **kwargs) 
```

****编辑***** 忘记添加显示产品并调用 add_to_cart 的视图：

```
#new product view, with POST vs GET detection 
```

def show_product(request, product_slug, template_name = "catalog/product.html"):

```
p = get_object_or_404(Product, slug=product_slug)

categories = p.categories.all()
page_title = p.name
meta_keywords = p.meta_keywords
meta_description = p.meta_description
#need to evaluate the HTTP method
if request.method == 'POST':

    #add to cart....create the bound form
    postdata = request.POST.copy()
    form = ProductAddToCartForm(request, postdata)

    #check if posted data is valid
    if form.is_valid():
        #add to cart and redirect to cart page
        cart.add_to_cart(request)
        # if test cookie worked, get rid of it
        if request.session.test_cookie_worked():
            request.session.delete_test_cookie()

        url = urlresolvers.reverse('show_cart')
        return HttpResponseRedirect(url)
else:
    # it's a GET, create the unbound form. Note request as a kwarg
    form = ProductAddToCartForm(request = request, label_suffix = ':')

    #assign the hidden input the product slug
    form.fields['product_slug'].widget.attrs['value'] = product_slug
    #set the test cookie on our first GET request
    request.session.set_test_cookie()

    return render_to_response("catalog/product.html", locals(),   context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T04:08:42.840

发现错误 :) 缩进问题（愚蠢的 python） j/k 第一个是我的，第二个是正确的。得习惯这个。很容易被未经训练的眼睛忽视....

```
def add_to_cart(request):    
postdata = request.POST.copy()
product_slug = postdata.get('product_slug', '')
quantity = postdata.get('quantity', 1)
p = get_object_or_404(Product, slug = product_slug)
cart_products = get_cart_items(request)
product_in_cart = False
for cart_item in cart_products:
    if cart_item.product.id == p.id:
        cart_item.augment_quantity(quantity)
        product_in_cart = True
    if not product_in_cart:
        ci =  CartItem()
        ci.product = p
        ci.quantity = quantity
        ci.cart_id = _cart_id(request)
        ci.save() 
```

这是书，它有效：

```
def add_to_cart(request):
postdata = request.POST.copy()
product_slug = postdata.get('product_slug','')
quantity = postdata.get('quantity',1)
p = get_object_or_404(Product, slug=product_slug)
cart_products = get_cart_items(request)
product_in_cart = False
for cart_item in cart_products:
    if cart_item.product.id == p.id:
        cart_item.augment_quantity(quantity)
        product_in_cart = True
if not product_in_cart:
    ci = CartItem()
    ci.product = p
    ci.quantity = quantity
    ci.cart_id = _cart_id(request)
    ci.save() 
```

# ios - 将 AVCaptureAudioDataOutput 数据传递到 vDSP / Accelerate.framework

> ID：14088290
> 
> 赞同：5
> 
> 时间：2012-12-30T04:19:36.723
> 
> 标签：ios, avfoundation, signal-processing, core-audio, accelerate-framework

我正在尝试创建一个对麦克风数据运行 FFT 的应用程序，因此我可以检查例如输入中最响亮的频率。

我看到有很多获取音频输入的方法（RemoteIO AudioUnit、AudioQueue 服务和 AVFoundation），但似乎 AVFoundation 是最简单的。我有这个设置：

```
// Configure the audio session
AVAudioSession *session = [AVAudioSession sharedInstance];
[session setCategory:AVAudioSessionCategoryRecord error:NULL];
[session setMode:AVAudioSessionModeMeasurement error:NULL];
[session setActive:YES error:NULL];

// Optional - default gives 1024 samples at 44.1kHz
//[session setPreferredIOBufferDuration:samplesPerSlice/session.sampleRate error:NULL];

// Configure the capture session (strongly-referenced instance variable, otherwise the capture stops after one slice)
_captureSession = [[AVCaptureSession alloc] init];

// Configure audio device input
AVCaptureDevice *device = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeAudio];
AVCaptureDeviceInput *input = [AVCaptureDeviceInput deviceInputWithDevice:device error:NULL];
[_captureSession addInput:input];

// Configure audio data output
AVCaptureAudioDataOutput *output = [[AVCaptureAudioDataOutput alloc] init];
dispatch_queue_t queue = dispatch_queue_create("My callback", DISPATCH_QUEUE_SERIAL);
[output setSampleBufferDelegate:self queue:queue];
[_captureSession addOutput:output];

// Start the capture session.   
[_captureSession startRunning]; 
```

（加上错误检查，为了便于阅读，此处省略）。

然后我实现以下[AVCaptureAudioDataOutputSampleBufferDelegate](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVCaptureAudioDataOutputSampleBufferDelegate_Protocol/Reference/Reference.html)方法：

```
- (void)captureOutput:(AVCaptureOutput *)captureOutput
didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer
       fromConnection:(AVCaptureConnection *)connection
{
    NSLog(@"Num samples: %ld", CMSampleBufferGetNumSamples(sampleBuffer));
    // Usually gives 1024 (except the first slice)
} 
```

我不确定下一步应该是什么。格式到底`CMSampleBuffer`描述了什么（如果有的话，可以对它做出什么假设）？[`vDSP_fft_zrip`](http://developer.apple.com/library/ios/#documentation/Performance/Conceptual/vDSP_Programming_Guide/UsingFourierTransforms/UsingFourierTransforms.html)我应该如何以尽可能少的额外预处理来获取原始音频数据？（另外，你会建议做什么来验证我看到的原始数据是正确的？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T12:20:03.620

这`CMSampleBufferRef`是包含 0 个或更多媒体样本的不透明类型。文档中有一些简介：

[http://developer.apple.com/library/ios/#documentation/CoreMedia/Reference/CMSampleBuffer/Reference/reference.html](http://developer.apple.com/library/ios/#documentation/CoreMedia/Reference/CMSampleBuffer/Reference/reference.html)

在这种情况下，它将包含一个音频缓冲区，以及对样本格式和时序信息的描述等。如果您真的感兴趣，只需在委托回调中放置一个断点并查看一下。

第一步是获取一个指向已返回数据缓冲区的指针：

```
// get a pointer to the audio bytes
CMItemCount numSamples = CMSampleBufferGetNumSamples(sampleBuffer);
CMBlockBufferRef audioBuffer = CMSampleBufferGetDataBuffer(sampleBuffer);
size_t lengthAtOffset;
size_t totalLength;
char *samples;
CMBlockBufferGetDataPointer(audioBuffer, 0, &lengthAtOffset, &totalLength, &samples); 
```

iPhone 麦克风的默认采样格式是线性 PCM，带有 16 位采样。这可能是单声道或立体声，具体取决于是否有外部麦克风。要计算 FFT，我们需要一个浮点向量。幸运的是，有一个加速功能可以为我们进行转换：

```
// check what sample format we have
// this should always be linear PCM
// but may have 1 or 2 channels
CMAudioFormatDescriptionRef format = CMSampleBufferGetFormatDescription(sampleBuffer);
const AudioStreamBasicDescription *desc = CMAudioFormatDescriptionGetStreamBasicDescription(format);
assert(desc->mFormatID == kAudioFormatLinearPCM);
if (desc->mChannelsPerFrame == 1 && desc->mBitsPerChannel == 16) {
    float *convertedSamples = malloc(numSamples * sizeof(float));
    vDSP_vflt16((short *)samples, 1, convertedSamples, 1, numSamples);
} else {
    // handle other cases as required
} 
```

现在你有一个样本缓冲区的浮点向量，你可以使用它`vDSP_fft_zrip`。似乎无法将麦克风的输入格式更改为使用 浮动样本`AVFoundation`，因此您被最后一个转换步骤所困扰。在实践中，我会保留缓冲区，如果有必要在更大的缓冲区到达时重新分配它们，这样您就不会在每个委托回调中分配和释放缓冲区。

至于你的最后一个问题，我想最简单的方法是注入一个已知的输入并检查它是否给你正确的响应。您可以在麦克风中播放一个正弦波，并检查您的 FFT 在正确的频率箱中是否有一个峰值，类似这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T11:08:16.670

我不建议使用 AVFoundation 有 3 个原因：

1.  我将它用于我的一些应用程序（morsedec，irtty），它在模拟器和某些硬件上运行良好，但在其他应用程序中完全失败！
2.  您对格式的采样率没有很好的控制。
3.  延迟可能很高。

我建议从苹果的示例代码 aurioTouch 开始。要进行 FFT，您可以使用循环缓冲区（我喜欢[https://github.com/michaeltyson/TPCircularBuffer](https://github.com/michaeltyson/TPCircularBuffer)）转移到 vDSP 框架。

希望这有帮助

# python - python中的多线程Web服务器

> ID：14088294
> 
> 赞同：58
> 
> 时间：2012-12-30T04:20:10.130
> 
> 标签：python, multithreading, http, webserver

我正在尝试在 python 中创建多线程 Web 服务器，但它一次只响应一个请求，我不知道为什么。你能帮我吗？

```
#!/usr/bin/env python2
# -*- coding: utf-8 -*-

from SocketServer import ThreadingMixIn
from  BaseHTTPServer import HTTPServer
from SimpleHTTPServer import SimpleHTTPRequestHandler
from time import sleep

class ThreadingServer(ThreadingMixIn, HTTPServer):
    pass

class RequestHandler(SimpleHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.send_header('Content-type', 'text/plain')
        sleep(5)
        response = 'Slept for 5 seconds..'
        self.send_header('Content-length', len(response))
        self.end_headers()
        self.wfile.write(response)

ThreadingServer(('', 8000), RequestHandler).serve_forever() 
```

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-12-30T08:44:34.387

查看Doug Hellmann 博客中的[这篇](http://pymotw.com/2/BaseHTTPServer/index.html#module-BaseHTTPServer)文章。

```
from BaseHTTPServer import HTTPServer, BaseHTTPRequestHandler
from SocketServer import ThreadingMixIn
import threading

class Handler(BaseHTTPRequestHandler):

    def do_GET(self):
        self.send_response(200)
        self.end_headers()
        message =  threading.currentThread().getName()
        self.wfile.write(message)
        self.wfile.write('\n')
        return

class ThreadedHTTPServer(ThreadingMixIn, HTTPServer):
    """Handle requests in a separate thread."""

if __name__ == '__main__':
    server = ThreadedHTTPServer(('localhost', 8080), Handler)
    print 'Starting server, use <Ctrl-C> to stop'
    server.serve_forever() 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2017-04-17T06:16:22.213

我开发了一个名为[ComplexHTTPServer](https://github.com/vickysam/ComplexHTTPServer)的 PIP 实用程序，它是 SimpleHTTPServer 的多线程版本。

要安装它，您需要做的就是：

```
pip install ComplexHTTPServer 
```

使用它很简单：

```
python -m ComplexHTTPServer [PORT] 
```

（默认情况下，端口为 8000。）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2018-07-27T13:27:43.073

在 python3 中，您可以使用以下代码（https 或 http）：

```
from http.server import HTTPServer, BaseHTTPRequestHandler
from socketserver import ThreadingMixIn
import threading

USE_HTTPS = True

class Handler(BaseHTTPRequestHandler):

    def do_GET(self):
        self.send_response(200)
        self.end_headers()
        self.wfile.write(b'Hello world\t' + threading.currentThread().getName().encode() + b'\t' + str(threading.active_count()).encode() + b'\n')

class ThreadingSimpleServer(ThreadingMixIn, HTTPServer):
    pass

def run():
    server = ThreadingSimpleServer(('0.0.0.0', 4444), Handler)
    if USE_HTTPS:
        import ssl
        server.socket = ssl.wrap_socket(server.socket, keyfile='./key.pem', certfile='./cert.pem', server_side=True)
    server.serve_forever()

if __name__ == '__main__':
    run() 
```

你会发现这段代码将创建一个新线程来处理每个请求。

以下命令生成自签名证书：

```
openssl req -x509 -newkey rsa:4096 -nodes -out cert.pem -keyout key.pem -days 365 
```

如果你使用 Flask，[这个博客](https://blog.miguelgrinberg.com/post/running-your-flask-application-over-https)很棒。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-09-14T16:29:02.733

令人惊讶的是，这些打破流媒体的解决方案获得了多少票。如果将来可能需要流式传输，那么`ThreadingMixIn`gunicorn 就不好了，因为它们只是收集响应并将其作为一个单元写入最后（如果您的流是无限的，这实际上什么都不做）。

您与线程结合的基本方法`BaseHTTPServer`很好。但是默认`BaseHTTPServer`设置会在每个侦听器上重新绑定一个新套接字，如果所有侦听器都在同一个端口上，这在 Linux 中将不起作用。`serve_forever()`在通话前更改这些设置。（就像您必须`self.daemon = True`在线程上设置以阻止 ctrl-C 被禁用一样。）

以下示例在同一端口上启动 100 个处理程序线程，每个处理程序通过`BaseHTTPServer`.

```
import time, threading, socket, SocketServer, BaseHTTPServer

class Handler(BaseHTTPServer.BaseHTTPRequestHandler):

    def do_GET(self):
        if self.path != '/':
            self.send_error(404, "Object not found")
            return
        self.send_response(200)
        self.send_header('Content-type', 'text/html; charset=utf-8')
        self.end_headers()

        # serve up an infinite stream
        i = 0
        while True:
            self.wfile.write("%i " % i)
            time.sleep(0.1)
            i += 1

# Create ONE socket.
addr = ('', 8000)
sock = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
sock.bind(addr)
sock.listen(5)

# Launch 100 listener threads.
class Thread(threading.Thread):
    def __init__(self, i):
        threading.Thread.__init__(self)
        self.i = i
        self.daemon = True
        self.start()
    def run(self):
        httpd = BaseHTTPServer.HTTPServer(addr, Handler, False)

        # Prevent the HTTP server from re-binding every handler.
        # https://stackoverflow.com/questions/46210672/
        httpd.socket = sock
        httpd.server_bind = self.server_close = lambda self: None

        httpd.serve_forever()
[Thread(i) for i in range(100)]
time.sleep(9e9) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-12-03T15:05:06.487

python3.7中的多线程https服务器

```
from http.server import BaseHTTPRequestHandler, HTTPServer
from socketserver import ThreadingMixIn
import threading
import ssl

hostName = "localhost"
serverPort = 8080

class MyServer(BaseHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.send_header("Content-type", "text/html")
        self.end_headers()
        self.wfile.write(bytes("<html><head><title>https://pythonbasics.org</title></head>", "utf-8"))
        self.wfile.write(bytes("<p>Request: %s</p>" % self.path, "utf-8"))
        self.wfile.write(bytes("<p>Thread: %s</p>" % threading.currentThread().getName(), "utf-8"))
        self.wfile.write(bytes("<p>Thread Count: %s</p>" % threading.active_count(), "utf-8"))
        self.wfile.write(bytes("<body>", "utf-8"))
        self.wfile.write(bytes("<p>This is an example web server.</p>", "utf-8"))
        self.wfile.write(bytes("</body></html>", "utf-8"))

class ThreadingSimpleServer(ThreadingMixIn,HTTPServer):
    pass

if __name__ == "__main__":
    webServer = ThreadingSimpleServer((hostName, serverPort), MyServer)
    webServer.socket = ssl.wrap_socket(webServer.socket, keyfile='./privkey.pem',certfile='./certificate.pem', server_side=True)
    print("Server started http://%s:%s" % (hostName, serverPort))

    try:
        webServer.serve_forever()
    except KeyboardInterrupt:
        pass

    webServer.server_close()
    print("Server stopped.") 
```

可以在浏览器中测试：[https://localhost:8080](https://localhost:8080) 运行结果是： 在此处输入图片描述 在[此处](https://i.stack.imgur.com/FRioS.png)
[输入图片描述](https://i.stack.imgur.com/iGi7B.png) 提醒您可以生成自己的keyfile和证书使用

```
$openssl req -newkey rsa:2048  -keyout privkey.pem -x509 -days 36500 -out certificate.pem 
```

要了解有关使用 openssl 创建自签名证书的详细信息：[https ://www.devdungeon.com/content/creating-self-signed-ssl-certificates-openssl](https://www.devdungeon.com/content/creating-self-signed-ssl-certificates-openssl)

# iphone - 使用三个嵌入式控制器的屏幕截图，其中一个是视频模式下的 UIImagePicker？

> ID：14088295
> 
> 赞同：0
> 
> 时间：2012-12-30T04:20:49.973
> 
> 标签：iphone, ios6, uiimagepickercontroller, screen-capture

我需要对整个 iPhone 屏幕进行实时屏幕截图。屏幕嵌入了三个容器视图。这些容器之一是 UIImagePickerController。屏幕上的所有东西都捕捉得很漂亮，但是拥有 UIImagePickerController 的容器是黑色的。我需要整个屏幕截图，因此操作的连续性看起来是无缝的。有没有办法从 UIImagePickerController 捕获屏幕上当前显示的内容？下面是我用来捕获屏幕图像的代码。

我也尝试过[Apple 的 Technical Q&A QA1703](http://developer.apple.com/library/ios/#qa/qa1703/_index.html#//apple_ref/doc/uid/DTS40010193)。

```
UIGraphicsBeginImageContextWithOptions(myView.bounds.size, YES, 0.0f);
[myView.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T09:50:07.083

在尝试捕获包含 GLKView 和 UIImagePickerController 的屏幕截图之前，我遇到了类似的问题。有时我会出现黑屏，有时我会收到有关无效上下文的投诉（使用与您类似的代码时）。我找不到解决方案，所以我实现了一个 AVFoundation 摄像头，此后再也没有回头。这里有一些快速的源代码可以帮助你。

**视图控制器.h**

```
// Frameworks
#import <CoreVideo/CoreVideo.h>
#import <CoreMedia/CoreMedia.h>
#import <AVFoundation/AVFoundation.h>
#import <UIKit/UIKit.h>

@interface CameraViewController : UIViewController <AVCaptureVideoDataOutputSampleBufferDelegate>

// Camera
@property (strong, nonatomic) AVCaptureSession* captureSession;
@property (strong, nonatomic) AVCaptureVideoPreviewLayer* previewLayer;
@property (strong, nonatomic) UIImage* cameraImage;

@end 
```

**视图控制器.m**

```
#import "CameraViewController.h"

@implementation CameraViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    [self setupCamera];
}

- (void)setupCamera
{    
    AVCaptureDeviceInput* input = [AVCaptureDeviceInput deviceInputWithDevice:[AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo] error:nil];
    AVCaptureVideoDataOutput* output = [[AVCaptureVideoDataOutput alloc] init];
    output.alwaysDiscardsLateVideoFrames = YES;

    dispatch_queue_t queue;
    queue = dispatch_queue_create("cameraQueue", NULL);
    [output setSampleBufferDelegate:self queue:queue];

    NSString* key = (NSString *) kCVPixelBufferPixelFormatTypeKey;
    NSNumber* value = [NSNumber numberWithUnsignedInt:kCVPixelFormatType_32BGRA];
    NSDictionary* videoSettings = [NSDictionary dictionaryWithObject:value forKey:key];
    [output setVideoSettings:videoSettings];

    self.captureSession = [[AVCaptureSession alloc] init];
    [self.captureSession addInput:input];
    [self.captureSession addOutput:output];
    [self.captureSession setSessionPreset:AVCaptureSessionPresetPhoto];

    self.previewLayer = [AVCaptureVideoPreviewLayer layerWithSession:self.captureSession];
    self.previewLayer.videoGravity = AVLayerVideoGravityResizeAspectFill;

    // CHECK FOR YOUR APP
    self.previewLayer.frame = CGRectMake(0, 0, self.view.frame.size.height, self.view.frame.size.width);
    self.previewLayer.orientation = AVCaptureVideoOrientationLandscapeRight;
    // CHECK FOR YOUR APP

    [self.view.layer insertSublayer:self.previewLayer atIndex:0];

    [self.captureSession startRunning];
}

- (void)captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection
{
    CVImageBufferRef imageBuffer = CMSampleBufferGetImageBuffer(sampleBuffer);
    CVPixelBufferLockBaseAddress(imageBuffer,0);
    uint8_t *baseAddress = (uint8_t *)CVPixelBufferGetBaseAddress(imageBuffer);
    size_t bytesPerRow = CVPixelBufferGetBytesPerRow(imageBuffer);
    size_t width = CVPixelBufferGetWidth(imageBuffer);
    size_t height = CVPixelBufferGetHeight(imageBuffer);

    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef newContext = CGBitmapContextCreate(baseAddress, width, height, 8, bytesPerRow, colorSpace, kCGBitmapByteOrder32Little | kCGImageAlphaPremultipliedFirst);
    CGImageRef newImage = CGBitmapContextCreateImage(newContext);

    CGContextRelease(newContext);
    CGColorSpaceRelease(colorSpace);

    self.cameraImage = [UIImage imageWithCGImage:newImage];

    CGImageRelease(newImage);

    CVPixelBufferUnlockBaseAddress(imageBuffer,0);
}

// Call whenever you need a snapshot
- (UIImage *)snapshot
{
    NSLog(@"SNAPSHOT");
    return self.cameraImage;
}

@end 
```

此代码根据所选预设（在本例中为照片：852x640）捕获输入图像，因此如果您想将其与视图一起捕获，我建议使用以下选项：

1.  捕捉后缩放、裁剪和转换图像。优点：相机仍然运行流畅。缺点：更多代码
2.  添加一个 UIImageView 而不是，它会在委托`previewLayer`中更新其图像。`captureOutput`优点：所见即所得。缺点：可能会导致您的相机运行速度变慢。

在上述两种情况下，您都需要在截屏后将生成的捕获与其他图像合并（不像听起来那么难）。

AVFoundation 及其相关框架非常令人生畏，因此这是一个非常精简的实现，可以满足您的需求。如果您想了解更多详细信息，请查看以下示例：

*   [iOS 4 和直接访问相机](http://www.benjaminloulier.com/posts/ios4-and-direct-access-to-the-camera)
*   [屏幕截图 - 获取屏幕截图的合法方式](http://cocoacoderblog.com/2011/03/30/screenshots-a-legal-way-to-get-screenshots/)

希望有帮助！

# python - 如何手动调用 dbus.service.signal 装饰器？

> ID：14088297
> 
> 赞同：2
> 
> 时间：2012-12-30T04:21:33.860
> 
> 标签：python, dbus

我正在尝试使用 dbus-python 将信号动态添加到 D-Bus 服务。它为此提供了一个装饰器，如果信号名称在模块加载时已知，则可以正常工作；但是，直到运行时我才知道要导出到 D-Bus 的名称。

为了说明这个问题，我想做*的*是道德上的等价物：

```
import dbus
import dbus.service
import gobject
from dbus.mainloop.glib import DBusGMainLoop

class Event(dbus.service.Object):
    def __init__(self, name):
        self.name = name
        self.busName = dbus.service.BusName('com.acme.EventManager',
                                            bus=dbus.SessionBus())
        dbus.service.Object.__init__(self,
                                     self.busName,
                                     '/com/acme/EventManager/' +
                                     self.name)

        self.signame = 'com.acme.EventManager.' + self.name

    # THIS DOES NOT WORK: this decorator is parsed before the Event
    # class, and 'self' wouldn't exist here, anyway...
    @dbus.service.signal(dbus_interface=self.signame, signature='v')
    def emit(self, data):
        print "In %s event, got: %s " % (self.name, data)

if __name__ == "__main__":
    DBusGMainLoop(set_as_default=True)
    bus = dbus.SessionBus()
    loop = gobject.MainLoop()
    connect = Event('Connect')
    disconnect = Event('Disconnect')
    loop.run() 
```

毫不奇怪，这会产生：

```
@dbus.service.signal(dbus_interface=self.signame, signature='v')
NameError: name 'self' is not defined 
```

我想我可以省去装饰运算符提供的语法糖，`@`并在定义类之后手动修补 Event，如下所示：

```
import dbus
import dbus.service
import gobject
from dbus.mainloop.glib import DBusGMainLoop

class Event(dbus.service.Object):
    def __init__(self, name):
        self.name = name
        self.busName = dbus.service.BusName('com.acme.EventManager',
                                            bus=dbus.SessionBus())
        dbus.service.Object.__init__(self,
                                     self.busName,
                                     '/com/acme/EventManager/' +
                                     self.name)

        self.signame = 'com.acme.EventManager.' + self.name

    def emit(self, data):
        print "In %s event, got: %s " % (self.name, data)

if __name__ == "__main__":
    DBusGMainLoop(set_as_default=True)
    bus = dbus.SessionBus()
    loop = gobject.MainLoop()
    e1 = Event('Connect')
    e1.emit = dbus.service.signal(dbus_interface=e1.signame,
                              signature='v')(e1.emit)
    loop.run() 
```

这运行没有错误，但它无法将信号导出到 D-Bus。当我运行 D-Feet 时，我看到了对象路径`/com/acme/EventManager/Connect`，但除了`Introspect()`.

为了了解我是否可以了解正在发生的事情，我`dbus.service.signal`在调试器中检查了传递给装饰器的函数的值。对于这个典型的用例：

```
@dbus.service.signal(dbus_interface='com.acme.foo', signature='v')
def emit(self, data):
    pass 
```

传入装饰器的函数（在变量中`func`）如下所示：

```
>>> func
>>> <function emit at 0x99fbed4> 
```

但是当我*手动*调用装饰器函数时（如`e1.emit =`上面第二个示例中的赋值），我看到：

```
>>> func
>>> <bound method Event.emit of <__main__.Event at /com/acme/EventManager/Connect at 0x9b3348c>> 
```

所以......似乎，对于*正常*的用例，`dbus.service.signal`期望接收一个自由函数——**不是**一个未绑定的函数，而是一个函数，从所有意图和目的来看，它看起来像是使用以下定义的：

```
def emit():
    pass 
```

这种行为对我来说完全是神秘的。我已经阅读了很多关于装饰器的教程，并且认为我对它们非常了解，但是我已经为此困扰了好*几个小时*。如果这个装饰器希望用“原始”函数调用，我如何转换一个对象方法以便我可以手动调用它？

从[这个问题](https://stackoverflow.com/questions/972/adding-a-method-to-an-existing-object)，我看到`types.MethodType()`可以用来将自由函数转换为绑定方法。但似乎我需要做相反的事情（？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T12:35:38.690

我认为做你想做的事情的一种方法是使用工厂函数——但是以下内容未经测试，因为我没有安装 D-Bus 模块。

问题的根源是您试图在类定义时使用装饰器，该装饰器需要在创建该类的实例之前不提供的数据。一种解决方法是在函数内定义类并使用[闭包](https://en.wikipedia.org/wiki/Closure_%28computer_programming%29)，以便数据在需要时可用。请注意，工厂函数返回创建的类的*实例*，而不是类本身，尽管如果需要也可以。

```
import dbus
import dbus.service
import gobject
from dbus.mainloop.glib import DBusGMainLoop

def event_factory(event_name):
    class Event(dbus.service.Object):
        def __init__(self):
            self.busName = dbus.service.BusName('com.acme.EventManager',
                                                bus=dbus.SessionBus())
            dbus.service.Object.__init__(self,
                                         self.busName,
                                         '/com/acme/EventManager/'+event_name)

        @dbus.service.signal(dbus_interface='com.acme.EventManager.'+event_name,
                             signature='v')
        def emit(self, data):
            print "In %s event, got: %s " % (event_name, data)

    return Event() # return an instance of the class

if __name__ == "__main__":
    DBusGMainLoop(set_as_default=True)
    bus = dbus.SessionBus()
    loop = gobject.MainLoop()
    connect = event_factory('Connect')
    disconnect = event_factory('Disconnect')
    loop.run() 
```

# javascript - 如何在Javascript中递归有效地嵌套for循环？

> ID：14088301
> 
> 赞同：0
> 
> 时间：2012-12-30T04:23:19.647
> 
> 标签：javascript, recursion, for-loop, tree, functional-programming

我是这个网站的新手，我想你可以帮助我解决一些我无法弄清楚的事情。

我需要递归地嵌套 for 循环，并找到一种方法将单个数组推入我的 for 循环中心的所有单叶的完整路径。

换句话说，我需要做类似的事情

```
var link2 = function(node,nb){
var array =[];
//getAnwers returns an array containing the leaves of the node.
var array1 = getAnswers(node);  
        for(var j =0;j<getAnswers(node).length;j+=2){     
            var array2 = getAnswers(array1[j]);
            for(var k = 0;k<array2.length;k+=2){
                var array3 = getAnswers(array2[k]);
                for(var l=0;l<array3.length;l+=2){
                    var arraytemp = [];
                    arraytemp.push(mot);
                    arraytemp.push(array1[j]);
                    arraytemp.push(array2[k]);
                    arraytemp.push(array3[l]);
                    array.push(arraytemp);
                    print(arraytemp);
                }
            }
        } return array;   
    }
}} 
```

但是以递归方式！我尝试这样做，其中 nb 是递归数。

```
var link6 = function(node,nb){
var array = [];
var arraySave = [];

var helper = function(node2,nb,arrayTemp){//pause();
    if(nb<=0){

        for(var k=0;k<arrayTemp.length;k+=2){
            var arrayChain = [];
            for(var j=0;j<arraySave.length-1;j++){
                arrayChain.push(arraySave[j]);
            }
            arrayChain.push(arrayTemp[k]);
            if(k===arrayTemp.length-2){
                arraySave.pop();
                arraySave.pop();
            }
            array.push(arrayChaine);
        }
    }

    else{
        var array1 = getAnswers(node2);
        for(var i =0;i<array1.length;i+=2){
                arraySave.push(array1[i]);
                helper(array1[i],nb-1,array1);
                return array;
            }   

    }
}
helper(node,nb,null);
return array; 
```

}

问题是，我怎样才能做与我在第一个代码中所做的完全相同的事情，但是以递归的方式，所以我可以选择我的树的级别数！如您所见，我尝试了函数link6，但没有获得好的结果..我是个初学者..

非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:38:48.317

第一个提示：使用[`forEach`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach).

```
var array = [];
getAnswers(mot, seuil).forEach(function(jarr) {
  return getAnswers(jarr).forEach(function(karr) {
    return getAnswers(karr).forEach(function(larr) {
        var arraytemp = [mot, jarr, karr, larr];

        print(arraytemp);
        array.push(arraytemp);
    });
  });
}); 
```

正如[Paul S.](https://stackoverflow.com/users/1615483/paul-s)在他的评论中指出的那样，您可能并不打算`continue`在所有其他分支中使用。

要回答您最初的问题，我认为您正在寻找这样的东西：

```
/* Assumes that n >= 1 and depth(arr) > n */
function ndeep(arr, n, fn) {
  function helper(acc, n) {
    arr.forEach(function(narr) {
      var nacc = acc.slice();
      nacc.push(narr);

      if (n == 1) {
        return fn(nacc); 
      } else {
        return helper(nacc, n - 1);
      }
    });
  }

  return helper([], n);
}

var array = [];
ndeep(getAnswers(mot, seuil), depth, function(acc) {
    array.push([mot].conat(acc));
}); 
```

...`depth`您想要的深度在哪里。

# javascript - 在 Marionette 中使用 appendHtml() 时是否可以避免添加默认视图元素“div”？

> ID：14088305
> 
> 赞同：7
> 
> 时间：2012-12-30T04:23:48.943
> 
> 标签：javascript, jquery, backbone.js, marionette

我使用以下代码手动将视图附加到模板中的 dom 元素：

```
appendHtml: function(collectionView, itemView, index){
      collectionView.$("ul#search_list_container").append(itemView.el);
} 
```

在我的模板中，我有：

```
<script id='search-list-grid-template' type='text/x-handlebars-template'>
    <ul id="search_list_container"></ul>
</script> 
```

尽管我将视图附加到 ul#search_list_container 我有包装模板的默认 div：

```
<div>
    <ul id="search_list_container">
    <a href="#">
        <span id="search_list_item">
            id
            invoice_number
        </span>
    </a>
    </li>
    </ul>
</div> 
```

有没有办法避免显示默认标签“div”？，我对此没有任何问题，但每当我想出这个例子时，我总是会想到这个疑问。

注意：我有一个用于 ul 复合视图的 itemView，以及这里未显示的其他一些内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T19:48:02.613

Backbone`Views`被设计为将自己的 DOM 元素存储为视图的`el`属性。

不建议按照 Steven-Farley 的建议删除视图元素，因为事件可能会绑定到它。

最好的方法是将您的`tagName`属性更改`collectionView`为`ul`.

另请参阅：[Backbone.Marionette 中的项目视图和布局中的额外 div](https://stackoverflow.com/questions/11183130/extra-divs-in-itemviews-and-layouts-in-backbone-marionette)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T04:54:40.780

使用 jQuery，您可以使用[.unwrap()](http://api.jquery.com/unwrap/)。

试试这个：

**改变：**

```
collectionView.$("ul#search_list_container").append(itemView.el); 
```

**到：**

```
collectionView.$("ul#search_list_container").append(itemView.el).unwrap(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T17:04:30.937

关于这个**集合视图的几件事不需要模板**，

它要么呈现

*   [空视图](https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.collectionview.md#collectionviews-emptyview)

或者

*   [项目视图](https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.collectionview.md#collectionviews-itemview)

取决于集合是否有任何东西。

如果您不希望每个项目中都有“div”，那就这么说吧。尝试添加

```
var yourItemView= Backbone.Marionette.ItemView.extend({
             tagName: "li",
          //OTHER STUFF HERE
          }); 
```

然后从您的项目模板中删除包装 <li> 。

您不需要为此用例修改 appendHtml att all。

# c++ - 获取 C++ 中运算符的返回类型？

> ID：14088308
> 
> 赞同：3
> 
> 时间：2012-12-30T04:24:12.270
> 
> 标签：c++, c++11, operator-keyword, return-type, typetraits

考虑以下函数：

```
template<class T1, class T2, class T3 = /* SOMETHING */> 
T3 f(const T1& x, const T2& y); 
```

我想`T3`等于的返回类型`T1+T2`。如何用 C++11 做到这一点？

注意：我不想要 的结果`std::common_type<T1, T2>::type`，我想要 的真实类型`T1+T2`，考虑到`operator+`可以是非成员函数或可以是 的成员函数`T1`。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-30T04:26:14.293

通常的方法是`decltype`尾随返回类型：

```
template<class T1, class T2> 
auto f(const T1& x, const T2& y) -> decltype(x+y); 
```

# boost - 如何从提升路径获取 char* 文件名

> ID：14088309
> 
> 赞同：0
> 
> 时间：2012-12-30T04:25:18.353
> 
> 标签：boost

```
for (fs::directory_iterator iter(realPath); iter != end_iter; ++iter )
        {
            if (iter->path().extension() == ".png"){
                fs::path currentPath = iter->path();
                const char *filename = const_cast<char*>(currentPath.string().c_str());
                std::cout << iter->path().leaf() << std::endl;

                processFile(filename);
                std::cout <<"Hi" << std::endl;
            }
        } 
```

这是我的代码，这里的 processFile 函数接受 char* 格式的文件名。上面的代码返回文件名的垃圾值。不知道获取文件名的最佳方法是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:57:32.103

它在这里对我来说很好（Boost.1.52，Mac OS X，clang）。

虽然我必须同意 Miguel 的观点，但你在这里做了很多工作。

```
for (fs::directory_iterator iter(realPath); iter != end_iter; ++iter )
    if (iter->path().extension() == ".png") {
        fs::path currentPath = iter->path();
        std::cout << currentPath.leaf() << std::endl;
        processFile(currentPath.c_str ());
    } 
```

并且根据您对代码的品味，您可以完全摆脱`currentPath`（替换为`iter->path()`）

# templates - Symfony 2 中的模板部分

> ID：14088313
> 
> 赞同：4
> 
> 时间：2012-12-30T04:26:43.967
> 
> 标签：templates, symfony, twig, partials

Symfony 2 中是否有诸如partials 之类的东西，可以从任何地方有效地重用模板？

我找到了`include` [http://twig.sensiolabs.org/doc/tags/include.html](http://twig.sensiolabs.org/doc/tags/include.html)但这仅允许在特定目录结构中呈现模板。

我真正想要一个包含我所有部分模板的文件夹，而不是将它们集中到我的主视图中？

所以我希望能够做类似的事情

```
{% include "Bundle:Default:Partials:view.html.twig" %} 
```

**更新**

我不想使用结构的强制`Bundle:Controller:Template`结构。我不想使用它，因为这意味着将我所有的模板部分放在我的主视图模板中。我需要一些能让我做的事情`Bundle:Controller:PartialDir:Template`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-30T04:50:20.463

你已经可以这样做了。symfony2 文档有一节描述了如何做到这一点。

[http://symfony.com/doc/current/book/templating.html#include-other-templates](http://symfony.com/doc/current/book/templating.html#including-other-templates)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-17T00:54:30.307

在 Symfony 2.4（我目前使用的版本，但它可能也适用于其他 2.x 版本）中，您可以执行以下操作：

```
{% include '::_partials/partial.html.twig' %} 
```

或者在 Symfony 2.2+ 中使用 include 函数

```
{{ include('::_partials/partial.html.twig') }} 
```

这将在 app/Resources/views/_partials 目录中查找 partial.html.twig 模板。显然，您可以随意命名 _partials 目录。它也可以在没有 '::' 前缀的情况下工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-16T11:14:57.920

我知道这是旧的，但实现 OP 要求的方法如下：
我们不必这样做
`bundle:controler:partialDir:template`
，而是稍微切换它来实现：
`{% include 'Bundle:PartialDir/Controller:Template' %}`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-01T13:43:45.160

要包含控制器，您需要使用控制器的标准字符串语法（即 bundle:controller:action）来引用它：

```
{{ render(controller(
    'App\\Controller\\ArticleController::recentArticles',
    { 'max': 3 }
)) }} 
```

# visual-studio-2010 - 我这样做对吗？使用集中式包文件夹进行 Nuget 包还原

> ID：14088316
> 
> 赞同：3
> 
> 时间：2012-12-30T04:28:03.723
> 
> 标签：visual-studio-2010, visual-studio, nuget

我在我的项目根文件夹中放置了一个**nuget.config**文件，该文件指定所有 NuGet 包应放在我的所有解决方案的位置。

这是文件：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <config>
    <add key="repositoryPath" value="D:\Projects\Development\NuGet Packages" />
  </config>
</configuration> 
```

我还在我的所有解决方案上启用了**NuGet 包还原**。

当我第一次设置它时，nuget.config 文件被忽略了——所有 NuGet 包都被放置在解决方案文件夹中的“包”文件夹中。我多次尝试删除此文件夹，但 NuGet 总是会重新创建它并用包填充它。

经过多次试验和错误，我偶然发现了`<PackagesDir>`“NuGet.targets”中的元素，并注意到将其注释掉最终允许将包放置在我的项目根目录中的正确文件夹中。

这是 NuGet.targets 的相关行

```
<PackagesDir>$([System.IO.Path]::Combine($(SolutionDir), "packages"))</PackagesDir> 
```

我的问题只是注释掉 NuGet.targets 文件中的`PackagesDir`元素是否是让我的 nuget.config 文件被遵循的预期方法，或者我是否缺少更明显的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T09:59:22.880

你的问题有两件事在起作用：

*   NuGet 在哪里存储包？
*   为打开的项目/解决方案还原 NuGet 包

关于第一个：在 nuget.config 文件中设置*repositoryPath*键是指示 NuGet 从默认文件夹中提取包的正确方法。每当开发人员将包引用添加到您的项目时，都会使用此设置。

对于 NuGet 包还原，此设置会被您在*NuGet.targets*中找到的设置覆盖。在构建解决方案时恢复包时使用此设置。

如果要使用包还原*和*自定义路径，则确实必须同时指定两者。第一个用于您的开发人员，第二个用于包还原。

# c++ - 确定插入的设备及其类型

> ID：14088317
> 
> 赞同：0
> 
> 时间：2012-12-30T04:28:08.560
> 
> 标签：c++, winapi, port

我正在尝试使用 Win32 API 列出当前插入计算机/笔记本电脑的所有设备。当我说设备时，我的意思是；耳机、USB 存储设备、HDMI 连接（电视或投影仪）、打印机等。

**什么是最好的本机 Win32 功能来简单地检测插入了哪些设备以及它们是什么类型？**

功能：

```
SetupDiClassGuidsFromNameA("Ports", 0, 0, &RequiredSize);
SetupDiClassGuidsFromNameA("Ports", (_GUID*)buf, RequiredSize*sizeof(GUID), &RequiredSize); 
```

和

```
SetupDiEnumDeviceInfo(DeviceInfoSet,numDev,&DeviceInfoData); 
```

最好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:46:41.640

是的，Setup API 是在 C++ 中枚举设备的方法。

这是一个简单的示例： http: [//www.codeproject.com/Articles/6445/Enumerate-Installed-Devices-Using-Setup-API](http://www.codeproject.com/Articles/6445/Enumerate-Installed-Devices-Using-Setup-API)

# python - configobj 多个配置

> ID：14088330
> 
> 赞同：0
> 
> 时间：2012-12-30T04:33:06.453
> 
> 标签：python, configobj

我是一名新程序员，正在开发一个包含食谱列表的程序，可以对其进行搜索，然后从选定的通用性生成菜单。

我最初的想法是使用配置文件来存储数据（我正在使用`configobj`python）。这里的问题是一个值（例如`ingredients = []`）会出现多次。

有没有办法在一个文件中分离不同的配置？就像是

```
Recipe
{
    value0 = 
}
Recipe 2
{
    value0 =
} 
```

我试图避免使用升序值（`value1(n),value1(n+1)`）或为每个配方使用配置文件。

或者，如果这不可能，有人可以建议替代文件结构，包括那些不使用`configobj`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:23:12.903

如果您想要人工可编辑的类似 ini 的格式：

```
[Recipe]
value0 = ..

[Recipe2]
value0 = .. 
```

如果该文件用于在程序之间交换数据，那么您可以使用（也是人类可读的）json 格式：

```
{ "Recipe": { "value0": ".." }, "Recipe2": { "value0": ".." } } 
```

# php - 如果字符串包含特定文本，则不匹配

> ID：14088331
> 
> 赞同：0
> 
> 时间：2012-12-30T04:33:34.893
> 
> 标签：php, regex, string

我做了这个正则表达式：

`(?<=span class="ope">)?[a-z0-9]+?\.(pl|com|net\.pl|tk|org|org\.pl|eu)|$(?=<\/span>)$`

它确实匹配字符串，例如: `example.pl`, `example12.com`，`something.eu`但它也会匹配`dontwantthis.com`.

我的问题是如果字符串包含字符串，如何不匹配`dontwantthis`字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T04:44:37.143

您可能正在使用循环跟踪您的正则表达式以循环匹配。在这种情况下，检查`dontwantthis`子字符串是否存在以及`continue`是否存在可能是最简单的。试图在正则表达式中实现它只是自找麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T04:50:11.053

您似乎正在`span`使用正则表达式从元素中提取内容。现在，尽管这[不是](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)一个好主意的所有[原因](http://www.codinghorror.com/blog/2009/11/parsing-html-the-cthulhu-way.html)[......](http://welbog.homeip.net/glue/53/XML-is-not-regular)

......保持你的表情。然后，如果您有匹配项，请过滤掉应该被拒绝的匹配条目。

```
var $match = extractContentFromHtml($html);  // use regex here, return false if no match
if ($match && validMatch($match)) {
    // do something
} 
```

例如，应该在哪里`validMatch(string)`检查该值是否存在于某个数组中。

# c - 是否可以使用 switch 语句进行“和”操作

> ID：14088333
> 
> 赞同：-1
> 
> 时间：2012-12-30T04:34:27.003
> 
> 标签：c, gcc, switch-statement

据我所知，到目前为止，我能够使用`switch`语句并将其用作“或”运算符。例如：

```
switch(num)
case 1:
case 2:
 printf("One or Two"); 
```

它像

```
if(num==1 || num==2)
 printf(""One or two); 
```

是否可以修改 switch 语句并将其用作 AND 而不是 OR？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T04:42:40.003

一个变量不能同时保存两个值。

num == 1 && num == 2 总是错误的。

这个问题有意义还是我错过了重点？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T07:02:02.507

[德摩根定律](http://en.wikipedia.org/wiki/De_Morgan%27s_laws)通常是在 OR 和 AND 之间转换的关键。作为一个 C 表达式，它是

```
!( A || B ) == ( !A && !B ) 
```

一个`switch`陈述可能有一个`default`案例，当其他条件都不满足时采取。如果它是您已经给出的 OR 案例的唯一替代方案，那么由于它是 OR 的对立面，它自动成为 De Morgan 的 AND 案例。

```
switch(num) {
case 1:
case 2:
    printf("One or Two\n");
    break;
default:
    printf("Not one AND not two\n");
    break;
} 
```

如前所述，这是使 AND 有意义的唯一方法，因为变量不能同时是两个数字。

# html - .htaccess 问题只需要从 html 页面中删除“/”

> ID：14088334
> 
> 赞同：0
> 
> 时间：2012-12-30T04:34:30.877
> 
> 标签：html, regex, apache, .htaccess, url

我希望我在正确的地方写这个问题。我也用谷歌搜索我的问题，或者我实际上可能不完全知道如何用谷歌搜索我的问题。

我将很少描述我的问题，它可能会帮助别人理解。

我从 Web 服务器下载 html 页面，这些页面数量很大。在图像或链接中的每个 html 页面中，都有“/”作为示例

```
<img src="/newimage.jpg" /> and <a href="/myfile.html">file</a> 
```

所以当我需要正常工作时，我必须从每个 img 和 .

我还发现它有 .htaccess 文件我认为这个东西可以从这里处理，但我不是专业人士，甚至不完全知道如何为我的问题进行搜索查询。如果您对我的问题有所了解，请帮助我。提前致谢。

## **更新：**

如果我不能正确地阐述我的问题，我很抱歉。我给你另一个例子在我的html页面中，css路径是这样的：

```
<link href="/style.css" rel="stylesheet" type="text/css" /> 
```

它对我不起作用我必须编辑它并让它像这样

```
<link href="style.css" rel="stylesheet" type="text/css" /> 
```

你可以看到我只从 style.css 中删除了“/”，它现在对我有用，在所有 html 中，所有 url 都是这样的。我知道这是 .htaccess 问题，但不知道如何搜索或如何执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T13:22:36.193

@unor 给我一个尝试虚拟主机的想法。将我的所有代码放入子域后，它现在可以正常工作了。所以主要问题是主域中的代码不是.htaccess。

谢谢大家帮助我。

# ruby - 使用块 / 过程 / lambda 的 Ruby 双管道分配？

> ID：14088344
> 
> 赞同：19
> 
> 时间：2012-12-30T04:36:45.153
> 
> 标签：ruby, syntax, operators, variable-assignment, block

能写出来真是太好了

```
@foo ||= "bar_default" 
```

或者

```
@foo ||= myobject.bar(args) 
```

但我一直在寻找是否有办法写出类似的东西

```
@foo ||= do
  myobject.attr = new_val
  myobject.other_attr = other_new_val
  myobject.bar(args)
end 
```

在实际功能代码中大致等同于类似的东西

```
@foo = if !@foo.nil?
         @foo
       else
         myobject.attr = new_val
         myobject.other_attr = other_new_val
         myobject.bar(args)
       end 
```

而且我想我可以编写自己的全局方法，例如“getblock”来包装并返回任何通用块的结果，但我想知道是否已经有内置的方法可以做到这一点。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-12-30T04:46:49.533

您可以使用`begin`.. `end`：

```
@foo ||= begin
  # any statements here
end 
```

或者考虑将块的内容分解为单独的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-11T21:35:56.983

我通常这样写：

```
@foo ||= (
  myobject.attr = new_val
  myobject.other_attr = other_new_val
  myobject.bar(args)
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T04:45:36.623

```
@foo ||= unless @foo
  myobject.attr = new_val
  myobject.other_attr = other_new_val
  myobject.bar(args)
end 
```

# perl - 使用while循环读取perl中的多列

> ID：14088347
> 
> 赞同：0
> 
> 时间：2012-12-30T04:37:46.947
> 
> 标签：perl, shell

我陷入了 Perl 的一个问题。

我想使用 while 循环读取 1 行中的多列。

我知道我可以使用下面的 shell 脚本来实现这一点

```
cat file.txt|while read field1 field2 field3 field4
do
statement1
statement2
done 
```

我在 Perl 中想要同样的东西，但不明白如何得到它。

请帮我。

在此先感谢，苏马纳

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T04:47:50.103

采用

```
perl -F -ane '....' your file 
```

-F 标志将每个字段存储在数组@F 中。因此您可以将 $F[0] 用于第一个字段。例如：

```
perl -F -ane 'print $F[0]' your file 
```

将打印每一行的第一个字段

如果您担心性能：

```
perl -lne "my($f,$s,$t)=split;print 'first='.$f.' second='.$s.' third='.$t" your_file 
```

举个大例子：也检查[一下](http://theunixshell.blogspot.com/2012/12/using-perls-f-flag.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T04:53:27.030

在一个循环中，您可以这样做：

```
#!/usr/bin/perl -w
use strict;

my $file = "MYFILE";
open (my $fh, '<', $file) or die "Can't open $file for read: $!";
my @lines;
while (<$fh>) {
    my ($field1, $field2, $field3) = split;
}
close $fh or die "Cannot close $file: $!"; 
```

在循环中，Perl 将 $_ 分配文件的下一行，并且没有参数，split 将在空白处拆分该变量。

# php - 我想添加当我的用户失去互联网连接时显示消息的 facebook 功能

> ID：14088351
> 
> 赞同：6
> 
> 时间：2012-12-30T04:38:44.277
> 
> 标签：php, javascript, jquery, mysql, facebook

> **可能重复：**
> [JavaScript：如何检测 Internet 连接是否离线？](https://stackoverflow.com/questions/189430/javascript-how-to-detect-that-the-internet-connection-is-offline)

在 facebook 中，当您断开互联网连接时，您会看到一条消息“没有互联网连接。再试一次？” 你从在线变为离线。我想要在我的网站上。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T04:46:06.150

这应该有效，但我可能会以不同的方式处理它。它只是每 15 秒向服务器上的一个页面发送一个查询。如果查询失败，那么它可能处于脱机状态（您或服务器）。

```
function checkOnline(){
    $.ajax({
        url: "test.php",
    }).done(function( html ) {
        if(html=='ok')
            setTimeout('checkOnline()',15000);
        else
            alert('Error');
    }).fail(function(){
        alert('Offline');
    });
} 
```

测试.php

```
<?php exit('ok'); ?> 
```

我会亲自将失败函数附加到我的其他 Ajax 或轮询查询。如果这些失败，我会触发离线消息并停止进一步的轮询或查询，直到页面重新加载或在某个时间间隔之后。仅仅轮询服务器是没有意义的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T04:45:46.617

对您的服务器运行定期 ajax 请求。如果请求失败，ajax 引擎将调用“失败”回调。

但在现实生活中，您可能会将“失败”javascript 回调附加到对服务器端的所有请求，并且它会在请求失败时触发。

# sencha-touch - 将某些内容动态添加到选项卡栏时，选项卡面板行为会中断

> ID：14088354
> 
> 赞同：0
> 
> 时间：2012-12-30T04:39:26.023
> 
> 标签：sencha-touch, sencha-touch-2

[我尝试按照http://www.sencha.com/forum/showthread.php?234909-tab-panel-doesn-t-switch-between-tabs-](http://www.sencha.com/forum/showthread.php?234909-tab-panel-doesn-t-switch-between-tabs-when-added-dynamically)的建议将 this.callParent(arguments) 添加到选项卡面板的初始化事件中[动态添加时，](http://www.sencha.com/forum/showthread.php?234909-tab-panel-doesn-t-switch-between-tabs-when-added-dynamically)但我得到：

```
Uncaught Error: this.callParent() was called but there's no such method (doFire) found in the parent class (Ext.Base). 
```

有人能指出我正确的方向吗？

谢谢你。

我的控制器如下：

```
Ext.define('MyApp.controller.MyController', {
    extend: 'Ext.app.Controller',

    config: {
        refs: {
            mytabpanel: '#mytabpanel'
        }
    },

    init: function(application) {

        this.control({
            mytabpanel: {
                initialize: function(component, options){
                    var bar = component.getTabBar();

                    bar.insert(0, { flex:1, xtype:'toolbar', title: '' });

                    bar.insert(bar.getItems().length, 
                    {
                        xtype: 'toolbar',
                        flex: 1,
                        title: '',
                        items: [
                        {
                            xtype : 'button',
                            docked: 'right',
                            ui: 'round',
                            iconCls: 'info',
                            iconMask: true,
                            handler: function(){                       
                            }
                        }
                        ]
                    });
                    this.callParent(arguments);
                }
            }
        });
    }
}); 
```

我的看法如下：

```
Ext.define('MyApp.view.MyTabPanel', {
    extend: 'Ext.tab.Panel',

    config: {
        id: 'mytabpanel',
        items: [
            {
                xtype: 'container',
                title: 'Tab 1',
                iconCls: 'info',
                html: 'tab 1'
            },
            {
                xtype: 'container',
                title: 'Tab 2',
                iconCls: 'info',
                html: 'tab 2'
            },
            {
                xtype: 'container',
                title: 'Tab 3',
                iconCls: 'info',
                html: 'tab 3'
            }
        ],
        tabBar: {
            docked: 'bottom'
        }
    }
}); 
```

**编辑 12 月 30 日星期日上午 6:57（格林威治标准时间 - 4:00）**

通过搜索网络，我现在相信因为我重写了初始化，所以我需要调用超类的初始化方法，以便它的代码也将被执行。正如 user1479606 所指出的那样，调用 this.callParent 将永远不会起作用。所以，问题就变成了：如何调用超类的初始化方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:18:26.587

我认为您的应用程序不适用于您的情况，因为您应该`this.callParent(arguments)`在视图中使用而不是控制器，否则您的父类将始终是`Ext.Base`.

为了更容易理解和更好的方法，你为什么不遵循这样的 Sencha Touch 2 约定：

```
config: {
    refs: {
        mytabpanel: '#mytabpanel'
    }

    control: {
        mytabpanel: {
            initialize: 'domytabpanel'
        }
    }
},

domytabpanel: function(component, options) {
    var bar = component.getTabBar();

    bar.insert(0, {
        flex:1, 
        xtype:'toolbar', 
        title: ''
    });

    bar.insert(bar.getItems().length, 
    {
        xtype: 'toolbar',
        flex: 1,
        title: '',
        items: [
        {
            xtype : 'button',
            docked: 'right',
            ui: 'round',
            iconCls: 'info',
            iconMask: true,
            handler: function(){                       
            }
        }
        ]
    });
} 
```

希望能帮助到你 ：）

# python - 包装期望 C 动态回调的 C 函数

> ID：14088355
> 
> 赞同：0
> 
> 时间：2012-12-30T04:39:40.127
> 
> 标签：python, python-c-api, cpython

我正在尝试围绕 libedit 编写一个包装器（一个 BSD 替代 readline 的 API 略有不同），并且有一种方法可以将命名函数添加到 C API。

例如在 C 中：

```
static unsigned char show_help(EditLine *e, int ch) {
    printf("Help");
}

el = el_init(argv[0], stdin, stdout, stderr);
el_set(el, EL_ADDFN, "help",  "This is help", show_help);
el_set(el, EL_BIND, "\?", "help", NULL); 
```

我调用 el_set 添加一个函数，然后稍后绑定该函数。

我找不到允许我包装 EL_ADDFN 以动态绑定 Python 方法的好方法。我可以创建一堆预先命名的 C 函数并将它们单独包装到 python 方法中，但我宁愿尽可能地模拟 C API。

有没有办法调用 EL_ADDFN 并确定它正在调用哪个 python 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T01:40:58.727

试试这个：一个单一的处理函数（我将在下面描述）。包装 EL_ADDFN 以便它记录名称到 python 函数的映射，但始终使用一个处理函数。包装 EL_BIND，以便记录字符到函数名的映射。你的处理函数应该在你的字符中查找 ch 参数到名称映射，然后查找名称到函数映射，然后调用函数。（如果必须在 BIND 之前调用 ADDFN，您可以创建一个 ch 映射来运行并直接在 BIND 包装器中填充它。）

在伪 C 中：

```
const char *chmap[256];  // initialize to zero
struct hashtable *namemap;  // up to you to find a
                            // hashtable implementation that
                            // will take const char * and map to
                            // PyObject * (function object);

static unsigned char python_func(EditLine *e, int ch) {
    const char *name = chmap[ch];
    // check for errors
    PyObject *func = lookup(namemap, name);
    // check for errors

    PyObject *editline = convert(e); // or whatever you have
    PyObject *result = PyObject_CallFunctionObjArgs(func, NULL);
    // check result, convert to unsigned char, and return
} 
```

因此，ADDFN 包装器填充哈希表，而 BIND 运算符填充 chmap。

# .htaccess - 我可以将这两个 .htaccess 文件合并为一个吗？

> ID：14088357
> 
> 赞同：0
> 
> 时间：2012-12-30T04:40:10.827
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, apache2, rewrite

可以将这两个 .htaccess 文件合并为一个吗？他们处理两个独立的 PHP 应用程序，它们具有完全独立的漂亮 URL 处理。我想尝试一个的原因是因为 mod_security 抛出错误并完全忽略了我在链中的第二个 .htaccess 文件，但似乎一个 .htaccess 文件没有问题。

因此，如果访问 /blah，第一个应用程序会处理漂亮的 URL 处理。但是如果一个去 /members/blah，第二个应用程序会处理漂亮的 URL 处理。但是，请注意我们检查实际文件或目录路径并允许它们通过的 -f 和 -d 参数。

在根中：

```
RewriteEngine On
RewriteRule ^index\.php$ - [L]
RewriteRule ^members$ /members/ [QSA,L]
RewriteRule ^members/(.*)$ /memberapp/$1 [QSA,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

在 /memberapp 中：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /memberapp/index.php [QSA] 
```

**编辑1：**

因此，这是映射示例：

```
domain.com = domain.com/index.php
domain.com/ = domain.com/index.php
domain.com/?test=test = domain.com/index.php
domain.com/members/test.png = domain.com/memberapp/test.png (file exists)
domain.com/members/dir1 = domain.com/memberapp/dir1 (directory exists)
domain.com/members/dir1/ = domain.com/memberapp/dir1 (ditto)
domain.com/test = domain.com/index.php
domain.com/members/login = domain.com/memberapp/index.php
domain.com/members/test.php = domain.com/memberapp/test.php (file exists)
domain.com/dir1 = domain.com/dir1 (directory exists)
domain.com/dir1/ = domain.com/dir1 (directory exists)
domain.com/test.png = domain.com/test.png (file exists)
domain.com/members/login?test=test = domain.com/memberapp/index.php 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T21:39:52.713

```
RewriteEngine On

RewriteRule ^index\.php$ - [L]
RewriteRule ^members$ /members/ [R=302,L]
RewriteRule ^members/(.*)$ /memberapp/$1 [QSA,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^membersapp/ /memberapp/index.php [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

# wpf - WPF 列表框选定项样式（突出显示覆盖数据触发样式）

> ID：14088358
> 
> 赞同：0
> 
> 时间：2012-12-30T04:40:24.280
> 
> 标签：wpf, user-controls, listbox, wpf-controls

我是一名进入 .Net 的 Access 开发人员，我有一个 WPF 项目。由于我习惯于 Access 中的子表单，因此我创建了用户控件以这种方式进行操作（本身可能是一个问题，但我目前还没有解决这个问题）。

这个特定的用户控件（子窗体）有几个列表框，这些列表框绑定到后面代码中的对象（VB——我也没有参与那个辩论；我熟悉 VBA）。这些列表框绑定到一个名为“IsAssigned”的布尔值。我创建了一种样式，根据该值将这些列表框中的项目更改为绿色或红色。这是有效的。

然后我想更改该值以覆盖窗口的突出显示行为并了解 SystemColors.HighlightColor 和 ControlBrushKey。问题是我希望 HighlightColor 和 ControlBrushKey 颜色取决于“IsAssigned”值。除非我错过了什么，否则我显然无法嵌套触发器。在下面的代码中，我将高亮值设置为绿色只是为了说明我对此的理解。

So what I want is that when an item is selected, the text is bolded, with a black border, and maintains a solid color of green or red depending on the "IsAssigned" value. 当同一个项目是突出显示的项目时，我真的希望前景色为白色，并且可能有更厚的边框。

温柔点——我在很多方面都是菜鸟。

```
<UserControl.Resources>
    <Style TargetType="{x:Type ListBoxItem}" x:Key="ColorTrueAndFalse">
        <Style.Resources>
            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightColor}" Color="Green" />
            <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Green" />
        </Style.Resources>
        <Style.Triggers>
            <Trigger Property="IsSelected" Value="true">
                <Setter Property="FontWeight" Value="Bold" />
                <Setter Property="BorderBrush" Value="Black" />
            </Trigger>
            <DataTrigger Binding="{Binding IsAssigned}" Value="True">
                <Setter Property="Background">
                    <Setter.Value>
                        <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                            <GradientStop Color="LightGreen" Offset="0" />
                            <GradientStop Color="Green" Offset="1" />
                            <GradientStop Color="LawnGreen" Offset="2" />
                        </LinearGradientBrush>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding IsAssigned}" Value="False">
                <Setter Property="Background">
                    <Setter.Value>
                        <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                            <GradientStop Color="LightCoral" Offset="0.5" />
                            <GradientStop Color="Coral" Offset="1" />
                            <GradientStop Color="Red" Offset="2" />
                        </LinearGradientBrush>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers>
    </Style>
</UserControl.Resources> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T08:39:03.227

the `DataContext`of the`ListBoxItem`不同于 the one of the`ListBox`本身。在's 样式中使用时，您没有使用与 the 相同的样式，因此`{Binding IsAssigned}`您找不到该属性。`ListBoxItem``DataContext``ListBox`

**这可以通过使用相对绑定**轻松解决- 例如：

```
<DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=ListBox}, Path=DataContext.IsAssigned}" Value="true"> 
```

这会尝试绑定到 ListBoxItems 的父级。它沿着 Visual Tree 向上直到找到 ListBox 并尝试使用前者的`DataContext`属性来查找 IsAssigned。

所以一个完整的解决方案看起来像这样：

```
<Style.Triggers>
    <Trigger Property="IsSelected" Value="true">
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="BorderBrush" Value="Black" />
    </Trigger>
    <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=ListBox}, Path=DataContext.IsAssigned}" Value="true">
        <Setter Property="Background">
          ....
        </Setter>
    </DataTrigger> 
```

**更新**- 突出显示：

首先注意高光画笔的名称`HighlightBrushKey`不是你写的：

```
<Style.Resources>
    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Green" /> 
```

第二 - 而不是`Trigger`您使用的，使用它`DataTrigger`来更改所选项目的属性：

```
<DataTrigger Binding="{Binding Path=IsSelected, RelativeSource={RelativeSource Self}}" Value="True">
    <Setter Property="FontWeight" Value="Bold" />
    <Setter Property="BorderBrush" Value="Black" />
</DataTrigger> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T13:34:35.690

好吧，经过大量拔掉我剩下的小头发，并从 Blachshma 那里得到了一些正确方向的指示，我想出了一个解决方案。它主要基于[此处找到](http://vbcity.com/blogs/xtab/archive/2009/06/28/background-color-for-wpf-listbox-selected-item.aspx)的标记。

HighlightBrushKey 和 ControlBrushKey 让我很伤心——我无法让它们识别数据触发器已经设置的基础颜色。我可以将其设置为静态颜色，但没有任何动态。如果投入更多时间，这可能会奏效。相反，我使用边框来设置数据触发器中的颜色，并更改任何选定项目的字体和不透明度。即使在一个列表框中选择了一个项目并移开以选择另一个列表框中的另一个项目后，边框颜色仍然保持不变，这正是我想要的。

**这是我的 XAML（为简洁起见，省略了某些细节）：**

```
<UserControl.Resources>
    <Style TargetType="{x:Type ListBoxItem}" x:Key="BorderTrueAndFalse">
        <Style.Resources>
            <LinearGradientBrush x:Key="TrueBrush" EndPoint="1,0.5" StartPoint="0,0.5">
                ...
            </LinearGradientBrush>
            <LinearGradientBrush x:Key="FalseBrush" EndPoint="0,0.5" StartPoint="1,0.5">
                ...
            </LinearGradientBrush>
        </Style.Resources>
        <Setter Property="FocusVisualStyle" Value="{x:Null}"></Setter>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                    <Border  Name="Border" Padding="2" SnapsToDevicePixels="true">
                            <ContentPresenter />
                    </Border>
                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding IsAssigned}" Value="True">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource TrueBrush}"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding IsAssigned}" Value="False">
                            <Setter TargetName="Border" Property="Background" Value="{StaticResource FalseBrush}"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Path=IsSelected, RelativeSource={RelativeSource Self}}" Value="True">
                            <Setter Property="FontWeight" Value="Bold" />
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="Opacity" Value=".8"/>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</UserControl.Resources> 
```

当然，我相信我对这里发生的事情只有 80% 的把握，但是这个过程让我对绑定、触发器、样式、模板以及为什么 Access 的东西开发得如此之快有了更深入的了解！也许有一天我会把文本设置为旋转、闪烁，然后起床做一个小跳汰机，但现在我是一个快乐的露营者。

# razor - Razor heper 方法无法识别

> ID：14088368
> 
> 赞同：4
> 
> 时间：2012-12-30T04:43:10.657
> 
> 标签：razor, asp.net-mvc-4, visual-studio-2012, intellisense

自从我将项目升级到 MVC4 后，我的 Razor 助手就被标记为红色波浪线，并且智能感知不起作用；不过，一切都在设计时有效。任何人都可以帮忙吗？

![在此处输入图像描述](../Images/6674b6c0a200feb35ebf01ec61bca849.png)

这是我的 Views/Web.config 所拥有的。

```
<system.web.webPages.razor>
  <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
  <pages pageBaseType="Qwiple.Web.Views.BaseViewPage">
    <namespaces>
      <add namespace="System.Web.Mvc" />
      <add namespace="System.Web.Mvc.Ajax" />
      <add namespace="System.Web.Mvc.Html" />
      <add namespace="System.Web.Routing" />
      <add namespace="System.Web.Helpers"/>
    </namespaces>
  </pages>
</system.web.webPages.razor> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-29T22:50:18.737

在我的情况下，Views/web.config 的 razor 部分中缺少以下行，位于命名空间下：

```
<add namespace="System.Web.Helpers"/> 
```

请注意，这条线出现在上面 Joe 的原始示例中，因此我们并非都遇到相同的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T22:52:14.887

我想到了。在升级期间，我错过了更改 Views/web.config 中剃刀部分的版本。确保部分组与下面的示例匹配。

```
<sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
  <section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
  <section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
</sectionGroup> 
```

# css - 通过对象包含的 html 的 css

> ID：14088369
> 
> 赞同：0
> 
> 时间：2012-12-30T04:43:28.847
> 
> 标签：css, html

我有一个通过对象“包含”的 html 文件：

```
<object type="text/html" data="try.html">
</object> 
```

我想使用 CSS 来控制内容的外观，但是对象中的 HTML 似乎忽略了 CSS 代码。如果我直接拉入 CSS 作品，那么我知道它是“正确的”。如果我用调试器查看 HTML，我可以看到还有另一个 BODY & HTML 标签，但由于我使用的是 ID，我认为它仍然会找到它。

有什么建议么 ？

**编辑**

所以我让它使用带有 $.get() 的 jquery 来工作，如下所示：

```
<div id="here">
</div>
 <script>
  $.get("try.html", function(data) {
  $('#here').html(data);
  });
</script> 
```

但我仍然想知道为什么，CSS 不适用于 object 标签包含的 HTML 代码。我还没有找到一个很好的解释。

# ios - 应用程序生命周期 iOS

> ID：14088370
> 
> 赞同：0
> 
> 时间：2012-12-30T04:43:34.293
> 
> 标签：ios

我在 iOS 编程中遇到了应用程序生命问题。我的应用程序具有已为绘图子类化的视图控制器。一切都很顺利，直到我决定该应用程序处于非活动状态（按主页）。我希望它加载一个新屏幕。我使用了通知`applicationWillEnterForeground`和其他一些。当我尝试获取时，绘图代码会失败`UIGraphicsGetCurrentContext`，它会返回为零。我假设我正在尝试在上下文可用之前获取上下文。什么是适当的事件。我想我试过了，除了正确的。

# python - 如何在 python 中将 RGB 转换为 CMYK，反之亦然？

> ID：14088375
> 
> 赞同：18
> 
> 时间：2012-12-30T04:44:39.163
> 
> 标签：python, colors

如果我有一个 RGB 十进制数`255, 165, 0`，我该怎么做才能将其转换为 CMYK？

例如：

```
>>> red, green, blue = 255, 165, 0
>>> rgb_to_cmyk(red, green, blue)
(0, 35, 100, 0) 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-30T04:54:18.153

[这是Javascript 实现](http://www.javascripter.net/faq/rgb2cmyk.htm)的 Python 端口。

```
RGB_SCALE = 255
CMYK_SCALE = 100

def rgb_to_cmyk(r, g, b):
    if (r, g, b) == (0, 0, 0):
        # black
        return 0, 0, 0, CMYK_SCALE

    # rgb [0,255] -> cmy [0,1]
    c = 1 - r / RGB_SCALE
    m = 1 - g / RGB_SCALE
    y = 1 - b / RGB_SCALE

    # extract out k [0, 1]
    min_cmy = min(c, m, y)
    c = (c - min_cmy) / (1 - min_cmy)
    m = (m - min_cmy) / (1 - min_cmy)
    y = (y - min_cmy) / (1 - min_cmy)
    k = min_cmy

    # rescale to the range [0,CMYK_SCALE]
    return c * CMYK_SCALE, m * CMYK_SCALE, y * CMYK_SCALE, k * CMYK_SCALE 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-10-31T19:20:48.833

接受的答案提供了从 RGB 到 CMYK 的好方法，但问题标题还包括

> 反之亦然

所以这是我对从 CMYK 到 RGB 转换的贡献：

```
def cmyk_to_rgb(c, m, y, k, cmyk_scale, rgb_scale=255):
    r = rgb_scale * (1.0 - c / float(cmyk_scale)) * (1.0 - k / float(cmyk_scale))
    g = rgb_scale * (1.0 - m / float(cmyk_scale)) * (1.0 - k / float(cmyk_scale))
    b = rgb_scale * (1.0 - y / float(cmyk_scale)) * (1.0 - k / float(cmyk_scale))
    return r, g, b 
```

与 patapouf_ai 的回答不同，此函数不会产生负 rgb 值。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-05-02T12:01:51.973

但是转换完整图像 RGB2CMYK 或反之亦然，就像

```
from PIL import Image
image = Image.open(path_to_image)

if image.mode == 'CMYK':
    rgb_image = image.convert('RGB')

if image.mode == 'RGB':
    cmyk_image = image.convert('CMYK') 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-05-06T13:53:32.563

跟进Fooz先生的实施。

CMYK 有两种可能的实现方式。有一个比例是相对于空白空间的（例如在 GIMP 中使用），它是由 Fooz 先生实现的，但还有另一种 CMYK 实现（例如由 LibreOffice 使用），它给出相对于总色彩空间的色彩比例。如果您希望使用 CMYK 来模拟油漆或墨水的混合，那么第二个可能会更好，因为可以使用每种颜色的权重将颜色线性添加在一起（半混合为 0.5）。

这是带有反向转换的 CMYK 的第二个版本：

```
rgb_scale = 255
cmyk_scale = 100

def rgb_to_cmyk(r,g,b):
    if (r == 0) and (g == 0) and (b == 0):
        # black
        return 0, 0, 0, cmyk_scale

    # rgb [0,255] -> cmy [0,1]
    c = 1 - r / float(rgb_scale)
    m = 1 - g / float(rgb_scale)
    y = 1 - b / float(rgb_scale)

    # extract out k [0,1]
    min_cmy = min(c, m, y)
    c = (c - min_cmy) 
    m = (m - min_cmy) 
    y = (y - min_cmy) 
    k = min_cmy

    # rescale to the range [0,cmyk_scale]
    return c*cmyk_scale, m*cmyk_scale, y*cmyk_scale, k*cmyk_scale

def cmyk_to_rgb(c,m,y,k):
    """
    """
    r = rgb_scale*(1.0-(c+k)/float(cmyk_scale))
    g = rgb_scale*(1.0-(m+k)/float(cmyk_scale))
    b = rgb_scale*(1.0-(y+k)/float(cmyk_scale))
    return r,g,b 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-11-01T23:04:04.560

对于大多数实际目的而言，使用已接受答案中给出的 CMYK 转换（在撰写本文时）*并不准确。*

CMYK是基于四种墨水如何在纸上形成颜色；但是，墨水的颜色混合相当复杂，比用于在 RGB 颜色模型中形成颜色的“光”混合更复杂。

由于 CMYK 很有用，首先，在打印图像时，任何转换为​​ CMYK 都需要考虑*打印条件*，包括使用什么打印机和使用什么纸张进行打印。出于打印目的准确转换为 CMYK 并非易事，并且需要校准打印机并测量测试纸上的 CMYK 色块等。

[正如国际色彩联盟的CMYK 特征数据页面](http://www.color.org/chardata/drsection1.xalter)所示，CMYK 颜色与 sRGB 对 RGB 一样普遍存在并没有任何意义。

另请参阅我关于此主题[的彩色文章。](https://www.codeproject.com/Articles/1202772/Color-Topics-for-Programmers#CMYK_and_Other_Ink_Mixture_Color_Models)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-30T04:54:25.797

要使这种转换有用，您需要一个色彩管理系统，其中包含描述被转换的 RGB 系统和 CMYK 系统的配置文件。

[http://en.wikipedia.org/wiki/CMYK_color_model#Conversion](http://en.wikipedia.org/wiki/CMYK_color_model#Conversion)

以下是关于如何使用 ICC 配置文件解决此问题的讨论：

[如何使用 ICC 配置文件对一组任意像素值（而不是图像数据结构）执行颜色转换？](https://stackoverflow.com/questions/3597528/how-can-one-perform-color-transforms-with-icc-profiles-on-a-set-of-arbitrary-pix)

这是 pyCMS 的链接，它使用 ICC 颜色配置文件进行转换：

[http://www.cazabon.com/pyCMS/](http://www.cazabon.com/pyCMS/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-12-19T10:06:19.227

我尝试使用 bisounours_tronconneuse 提供的反向计算，但 CMYK (96 63 0 12) 失败。结果应该是：[像这样](http://www.colorhexa.com/0953e0)

将 w3schools javascript（[此处的代码](http://www.w3schools.com/lib/w3color.js)）转换为 python，下面的代码现在返回正确的结果：

```
def cmykToRgb(c, m, y, k) :
    c=float(c)/100.0
    m=float(m)/100.0
    y=float(y)/100.0
    k=float(k)/100.0
    r = round(255.0 - ((min(1.0, c * (1.0 - k) + k)) * 255.0))
    g = round(255.0 - ((min(1.0, m * (1.0 - k) + k)) * 255.0))
    b = round(255.0 - ((min(1.0, y * (1.0 - k) + k)) * 255.0))
    return (r,g,b) 
```

# c# - 从 ViewModel 中的 IoCContainer 获取对象实例

> ID：14088382
> 
> 赞同：0
> 
> 时间：2012-12-30T04:46:08.653
> 
> 标签：c#, mvvm, inversion-of-control, ioc-container

我是一名学习 MVVM 的学生，我正在开发一个 WPF 应用程序。当我必须从 ViewModel_1 实例化 ViewModel_2 时，我的问题就出现了。ViewModel_2 依赖于在 IoC 容器中注册的 XService。因此，当我要求容器解析 ViewModel_2 时，它会创建所需的服务，将其注入构造函数，并提供 ViewModel。

我的问题是：我一直读到容器不应该被任何类引用，而是管理其生命周期的引导程序，那么谁将 ViewModel_2 提供给 ViewModel_1？

我能想到的唯一解决方案是在 ViewModel_1 的 ctor 中放置一个 Lazy，并在需要时访问它，但是如果我要从那里管理多个 VM 怎么办？

我希望你能帮助我。非常感谢，新年快乐！=)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:59:29.857

据我了解，您拥有`ViewModel_1`包含属性`ViewModel_2`。你需要`ViewModel_2`用 DI 注入它。在这个简单的例子中，你可以注入`ViewModel_2`.`ViewModel_1`

您应该向我们提供有关“如果我有多个虚拟机要从那里管理怎么办”的更多详细信息。你说的是什么虚拟机？那是哪里”？如果您发布代码，`ViewModel_1`它将`ViewModel_2`有助于理解您的问题。

# ruby-on-rails - 使用 rails 创建一个下载链接到带有 at URL 的外部文件

> ID：14088383
> 
> 赞同：2
> 
> 时间：2012-12-30T04:46:16.257
> 
> 标签：ruby-on-rails, rackspace-cloud, rackspace, sendfile

我将文件存储移动到 Rackspace Cloudfiles，它破坏了我的 send_file 操作。

# 老的

```
def full_res_download
  @asset = Asset.find(params[:id])
  @file = "#{Rails.root}/public#{@asset.full_res}"
  send_file @file
end 
```

# 新的

```
def full_res_download
  @asset = Asset.find(params[:id])
  @file = "http://86e.r54.cf1.rackcdn.com/uploads/fake/filepath.mov"
  send_file @file
end 
```

当文件在公共文件中时。代码效果很好。当您单击链接时，文件将下载并且网页不会更改。现在它给出了这个错误。

```
Cannot read file http://86e.r54.cf1.rackcdn.com/uploads/fake/filepath.mov 
```

我错过了什么？

非常感谢您的参与。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T22:21:57.253

# 什么有效

```
def full_res_download
  @asset = Asset.find(params[:id])
  @file = open("http://86e.r54.cf1.rackcdn.com/uploads/fake/filepath.mov")
  send_file( @file, :filename => File.basename(@asset.file.path.to_s))
end 
```

### 真实代码

控制器.rb

```
def web_video_download
  @asset = Asset.find(params[:id])
  @file = open(CDNURL + @asset.video_file.path.to_s)
  send_file( @file, :filename => File.basename(@asset.video_file.path.to_s))
end 
```

发展.rb

```
CDNURL = "http://86e.r54.cf1.rackcdn.com/" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T04:50:48.287

`send_file`打开一个本地文件并使用机架中间件发送它。您应该只重定向到 url，因为您不再托管该文件。

正如其中一条评论指出的那样，在某些情况下，由于各种原因，您可能无法使用重定向。如果是这种情况，您必须下载该文件并在检索后将其转发给用户。这样做的效果是向用户的转移将执行以下操作：

1.  请求到达您的服务器，开始处理您的操作。
2.  您的操作从 CDN 请求文件，并等待文件被完全检索到。
3.  您的服务器现在可以将文件中继给最终用户。

这与重定向的情况相比：

1.  请求到达您的服务器，开始处理您的操作。
2.  您的操作会将用户重定向到 CDN。

在这两种情况下，用户都必须等待两个完整的连接，但是您的服务器已经节省了一些工作。因此，在情况允许时使用重定向会更有效。

# jquery - 取消按钮功能错误

> ID：14088385
> 
> 赞同：0
> 
> 时间：2012-12-30T04:46:41.173
> 
> 标签：jquery

我在错误控制台中收到以下错误，该错误未显示在问题所在的视图源中：

```
typeError: $(...).text(...).html is not a function 
```

但是通过试图找出错误来自哪里，我认为错误出现在下面的代码中，因为它在我单击取消按钮后出现：

```
function htmlEncode(value) { return $('<div/>').text(value).html(); } 
```

我在谷歌中找不到这个问题，但有人在我的 jquery 代码中看到错误吗？如果出现错误，代码中的错误可能会导致控制台中的错误。

完整代码：

下面是html编码：

```
function htmlEncode(value) { return $('<div/>').text(value).html(); } 
```

开始上传功能：

```
 function startImageUpload(imageuploadform){

      $(imageuploadform).find('.imagef1_upload_process').css('visibility','visible');
      $(imageuploadform).find('.imagef1_cancel').css('visibility','visible');
      $(imageuploadform).find('.imagef1_upload_form').css('visibility','hidden');
      $(imageuploadform).find('.imagemsg').css('visibility','hidden');
      sourceImageForm = imageuploadform;

            $(".sbtnimage").attr("disabled", "disabled");
            $(".sbtnvideo").attr("disabled", "disabled");
            $(".sbtnaudio").attr("disabled", "disabled");

            $(imageuploadform).find(".imageCancel").on("click", function(event) {
                      $('.upload_target_image').get(0).contentwindow;
                      stopImageUpload(2);

          $("iframe[name='upload_target_image']").on("load",function() {
          stopImageUpload(1);
        }).attr("src", "cancelimage.php");

    }); 
          return true;
    }

          var imagecounter = 0; 
```

停止上传的函数：

```
 function stopImageUpload(success, imagefilename){

          var result = '';
          imagecounter++;

          if (success == 1){
             result = '<span class="imagemsg'+imagecounter+'">The file was uploaded successfully</span>';      
             $('.listImage').eq(window.lastUploadImageIndex).append('<div>' + htmlEncode(imagefilename) + '<button type="button" class="deletefileimage" image_file_name="' + imagefilename + '">Remove</button><br/><hr/></div>'); 
          }
          else if (success == 2){
              result = '<span class="imagemsg'+imagecounter+'"> The file upload was cancelled</span>';
          }
          else {
             result = '<span class="imagemsg'+imagecounter+'">There was an error during file upload</span>';
          }

          $(sourceImageForm).find('.imagef1_upload_process').css('visibility','hidden');
          $(sourceImageForm).find('.imagef1_cancel').css('visibility','hidden');
          $(sourceImageForm).find('.imagemsg').html(result);
          $(sourceImageForm).find('.imagemsg').css('visibility','visible'); 
          $(sourceImageForm).find(".fileImage").replaceWith("<input type='file' class='fileImage' name='fileImage' />");
          $(sourceImageForm).find('.imagef1_upload_form').css('visibility','visible');

          $(".sbtnimage").removeAttr("disabled");
          $(".sbtnvideo").removeAttr("disabled");
          $(".sbtnaudio").removeAttr("disabled");

            $(".imageClear").on("click", function(event) {
            event.preventDefault();
            $(this).parents("form:first").find(".fileImage").replaceWith("<input type='file' class='fileImage' name='fileImage' />");

        });

      var _imagecounter = imagecounter;

    $('.listImage').eq(window.lastUploadImageIndex).find(".deletefileimage").on("click", function(event) {
        var image_file_name = $(this).attr('image_file_name');

        jQuery.ajax("deleteimage.php?imagefilename=" + image_file_name)
            .done(function(data) {

            $(".imagemsg" + _imagecounter).html(data);
        });

        $(this).parent().remove();
    });

          return true;   
    } 
```

ImageclickHandler() 函数：

```
 function imageClickHandler(imageuploadform){ 
  if(imageValidation(imageuploadform)){ 
      window.lastUploadImageIndex = $('.imageuploadform').index(imageuploadform); 
      return startImageUpload(imageuploadform); 
  } 
  return false;
} 
```

更新：

下面是上传文件的php代码：

```
<?php

ini_set('display_errors', 1);
error_reporting(E_ALL);

session_start();

if ($_FILES['fileImage']['error'] === UPLOAD_ERR_OK) {
    $result = 0;

    if (getimagesize($_FILES['fileImage']['tmp_name'])) {
        if ((($_FILES["fileImage"]["type"] == "image/gif") || ($_FILES["fileImage"]["type"] == "image/jpeg") || ($_FILES["fileImage"]["type"] == "image/pjpeg") || ($_FILES["fileImage"]["type"] == "image/jpg")) && ($_FILES['fileImage']['size'] > 0)) {
            if (is_file("ImageFiles/" . $_FILES['fileImage']['name'])) {
                $parts = explode(".", $_FILES['fileImage']['name']);
                $ext   = array_pop($parts);
                $base  = implode(".", $parts);
                $n     = 2;

                while (is_file("ImageFiles/" . $base . "_" . $n . "." . $ext))
                    $n++;
                $_FILES['fileImage']['name'] = $base . "_" . $n . "." . $ext;

                move_uploaded_file($_FILES["fileImage"]["tmp_name"], "ImageFiles/" . $_FILES["fileImage"]["name"]);
                $result = 1;

            }

            else {
                move_uploaded_file($_FILES["fileImage"]["tmp_name"], "ImageFiles/" . $_FILES["fileImage"]["name"]);
                $result = 1;
            }

        }

    }
} else {
    echo "Upload was not successful";
}

?> 

  <script language="javascript" type="text/javascript">window.top.stopImageUpload(<?php
echo $result;
?>, '<?php
echo $_FILES['fileImage']['name'];
?>');</script> 

</body> 
</html> 
```

更新 2：

iframe 加载的当前代码：

```
 $(imageuploadform).find(".imageCancel").on("click", function(event) {
                  $('.upload_target_image').get(0).contentwindow;
                  stopImageUpload(2);

      $("iframe[name='upload_target_image']").on("load",function() {
      stopImageUpload(1);
    }).attr("src", "cancelimage.php"); 
```

iframe 加载的原始代码：

```
$(imageuploadform).find(".imageCancel").on("click", function(event) {
                  $('.upload_target_image').get(0).contentwindow;

      $("iframe[name='upload_target_image']").on("load",function() {
      stopImageUpload(2);
    }).attr("src", "cancelimage.php"); 
```

原始代码发生的情况是，当文件成功上传时，发生的事情是瞬间显示成功 == 1 消息，但随后立即显示取消消息，即成功 - 2。

这显然是不正确的，所以尝试修复它，我尝试了当前的代码解决方案，所以我认为如果取消，显示成功 == 2 消息，如果文件成功，则显示成功 == 1 消息那条信息没有改变。但是感谢Barman，这导致了我遇到的错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:34:42.070

原因是`stopImageUpload()`需要 2 个参数，但您只提供 1 个参数。第二个参数应该是文件名。然后你`htmlEncode(imagefilename)`用这个未定义的文件名参数调用，它调用`$('<div/>').text(undefined).html()`. `$('<div/>').text(undefined)`被 jQuery 当作是`$('<div/>').text()`，所以它返回字符串`""`。然后它尝试调用`"".html()`，这是无效的。

解决方法是将文件名参数传递给函数。但我不确定你可以从哪里获得文件名，所以我认为你可能只需要删除试图将文件名放入 DIV 的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:51:20.547

### 只需更换：

```
return $('<div/>').text(value).html(); 
```

### 和：

```
return $('<div/>').text(value).end().html(); 
```

### 或者

```
$('<div/>').text(value);
return value; 
```

* * *

### 更新：原始脚本有效：

### 小提琴：http: [//jsfiddle.net/z6VzH/](http://jsfiddle.net/z6VzH/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T04:52:11.677

`.text()`返回一个**字符串**，它没有方法`.html()`。

并且错误不是来自您发布的代码，可能在`stopImageUpload`.

# iphone - UIImagePickerController 仅支持纵向模式。支持横向模式的任何替代方案？

> ID：14088388
> 
> 赞同：0
> 
> 时间：2012-12-30T04:47:25.807
> 
> 标签：iphone, orientation, uiimagepickercontroller

iOS 文档说“`UIImagePickerController`该类仅支持纵向模式”。如果我想以横向模式显示照片库，还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T08:03:52.937

可能这会对您有所帮助。您可以使用 ALAssetsLibrary 和资产类来获取设备中的图片，您可以使用它们以横向模式和纵向模式显示，就像 uiimagepicker 一样。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [activity startAnimating];

    appObj=(ImagePickerAppDelegate *)[[UIApplication sharedApplication]delegate];

    void (^assetEnumerator)(struct ALAsset *, NSUInteger, BOOL *) = ^(ALAsset *result, NSUInteger index, BOOL *stop)
    {
        if(result != NULL) 
        {
            //assets is a mutualable array...for storing the images that are in the device..
            [assets addObject:result];
        }
    };

    void (^assetGroupEnumerator)(struct ALAssetsGroup *, BOOL *) =  ^(ALAssetsGroup *group, BOOL *stop) 
    {
        if(group != nil)
        {
            [group enumerateAssetsUsingBlock:assetEnumerator];
        }
        //meth is a user defined method..   
        [self meth];
        [activity stopAnimating];
        [activity setHidden:YES];
    };
    assets = [[NSMutableArray alloc] init];
    ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];
    [library enumerateGroupsWithTypes:ALAssetsGroupAlbum usingBlock:assetGroupEnumerator 
                         failureBlock: ^(NSError *error) { NSLog(@"Failure");}];
}

-(void)meth
{
    NSLog(@"%i",[assets count]);

    if(userOrientation==UIInterfaceOrientationPortrait || userOrientation==UIInterfaceOrientationPortraitUpsideDown)
    {
        NSLog(@"haii");
        [scrollView removeFromSuperview];

        scrollView=[[UIScrollView alloc]initWithFrame:CGRectMake(0, 0, 320, 460)];
        scrollView.backgroundColor=[UIColor whiteColor];

        NSLog(@"%i",[assets count]);
        for (int i = 0; i < [assets count]; i++) 
        {
            imgBtn = [UIButton buttonWithType:UIButtonTypeCustom];
            [imgBtn setFrame:CGRectMake((i%4*80)+2,(i/4*80)+2,75,75)];
            imgBtn.tag=i;
            [imgBtn addTarget:self action:@selector(imageClicked:) forControlEvents:UIControlEventTouchUpInside];
            ALAsset *asset=[assets objectAtIndex:i];
            [imgBtn setImage:[UIImage imageWithCGImage:[asset thumbnail]] forState:UIControlStateNormal];
            [scrollView addSubview:imgBtn];
        }
        scrollView.contentSize = CGSizeMake(320,(([assets count]/4)+1)*300 );
    }

    if(userOrientation==UIInterfaceOrientationLandscapeRight || userOrientation==UIInterfaceOrientationLandscapeLeft)
    {
        [scrollView removeFromSuperview];
        scrollView=[[UIScrollView alloc]initWithFrame:CGRectMake(0, 0, 480,320)];
        for (int i = 0; i < [assets count]; i++) 
        {
            imgBtn = [UIButton buttonWithType:UIButtonTypeCustom];
            [imgBtn setFrame:CGRectMake((i%6*80)+2,(i/6*80)+2,75,75)];
            imgBtn.tag=i;
            [imgBtn addTarget:self action:@selector(imageClicked:) forControlEvents:UIControlEventTouchUpInside];
            ALAsset *asset=[assets objectAtIndex:i];
            [imgBtn setImage:[UIImage imageWithCGImage:[asset thumbnail]] forState:UIControlStateNormal];
            [scrollView addSubview:imgBtn];
        }
        scrollView.contentSize = CGSizeMake(480,(([assets count]/4)+1)*300);
    }
    [self.view addSubview:scrollView];
}

-(void)imageClicked:(UIButton *)sender
{
    //for picking the images that the user has selected we are using other array "selectedImages" i.e declared in the app delegate
    ALAsset *asset=[assets objectAtIndex:sender.tag];
    [appObj.selectedImages addObject:[UIImage imageWithCGImage:[[asset defaultRepresentation] fullScreenImage]]];
    NSLog(@"%i",[appObj.selectedImages count]);
    [self.navigationController popViewControllerAnimated:YES ];
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-30T04:56:20.967

我没有检查这是否非法，但它对我有用。如果您希望 UIImagePickerController 在横向代码中启动（并保持）：

```
//Initialize picker

UIImagePickerController * picker = [[UIImagePickerController alloc] init];
   picker.delegate = self;

//set Device to Landscape. This will give you a warning. I ignored it.
//warning: 'UIDevice' may not respond to '-setOrientation:'

[[UIDevice currentDevice] setOrientation:UIInterfaceOrientationLandscapeRight];

//Set Notifications so that when user rotates phone, the orientation is reset to landscape.
[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];

//Refer to the method didRotate:   
[[NSNotificationCenter defaultCenter] addObserver:self
              selector:@selector(didRotate:)
               name:@"UIDeviceOrientationDidChangeNotification" object:nil];

//Set the picker source as the camera   
picker.sourceType = UIImagePickerControllerSourceTypeCamera;

//Bring in the picker view   
[self presentModalViewController:picker animated:YES]; 
```

方法 didRotate：

```
- (void) didRotate:(NSNotification *)notification

{
      //Maintain the camera in Landscape orientation
 [[UIDevice currentDevice] setOrientation:UIInterfaceOrientationLandscapeRight];

} 
```

# java - 如何使用 Java 在 Kubuntu 中发出哔哔声？

> ID：14088390
> 
> 赞同：0
> 
> 时间：2012-12-30T04:47:59.900
> 
> 标签：java, kubuntu

一段时间以来，我一直是 Ubuntu 的粉丝。在过去一年左右的时间里，我只在笔记本电脑上运行 XUbuntu，我瞥见了 Kubuntu 并不得不尝试一下。直到我尝试制作一个简单的应用程序之前，它都很棒。

如何让电脑发出哔哔声？`Toolkit.getDefaultToolkit().beep()`，`getToolkit().beep()`并且`System.out.print("07")`不在 Kubuntu 中工作。我不想整天流式传输音频，我只想发出一声短促的哔声。甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T16:27:25.360

我无法使哔哔声工作，但是在 XUbuntu 上我可以加载一个点击声音文件并在没有任何外部库的情况下使用它。所以这对我的目的来说已经足够了，但它在 Kubuntu 上不起作用。换句话说，我没有答案，但我继续前进。我没有回答这个问题，因为我仍然有兴趣了解最初的问题，如果有人碰巧知道原因是什么，我可能会修复它。

# android - 使用 simplecursoradapater 将可绘制文件夹中的图像显示在列表视图中

> ID：14088393
> 
> 赞同：0
> 
> 时间：2012-12-30T04:49:24.217
> 
> 标签：android, sqlite, imageview, simplecursoradapter

我想要做的是`drawable-dbimages`使用 SimpleCursorAdapter 将我文件夹中的图像显示在 ImageView 中。

我真的不知道该怎么做。我知道如何使用它在数据库中按名称获取图像`BitmapFactory.decodeResource`，但我不知道如何将其应用于适配器。

例如，假设我有一个名为`cars`. 在该表中，我有一个名为`image`. `image`每行的值是`drawable-dbimages`文件夹中图像的名称。

现在我有这个代码：

```
cursor = datasource.fetchAllCars();
to = new int[] { R.id.listitem_car_name, R.id.listitem_car_image };
dataAdapter = new SimpleCursorAdapter(this, R.layout.listitem_car, cursor, columns, to, 0);
setListAdapter(dataAdapter); 
```

文本视图在哪里`R.id.listitem_car_name`，图像视图在哪里`R.id.listitem_car_image`。

我知道如何`image`从数据库中获取值并将其吐出到 textview 中，但我希望它具有来自 drawables 文件夹的图像，其名称在数据库列中，显示在每个 listview 项的图像视图中.

我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:52:46.333

android 的预制件`SimpleCursorAdapter`仅支持`TextViews`并将光标列映射到它们。对于您所描述的内容，您需要制作自己的适配器对象，在这里我使用了 a `CursorAdapter`，这将需要通过一些幕后工作来弄脏您的手。这是我的示例中的主要实例：

```
 cursor = datasource.fetchAllCars();
    dataAdapter = new CustomCursorAdapter(this, cursor, 0);
    setListAdapter(dataAdapter); 
```

然后这里是完整的对象

```
import android.content.Context;
import android.database.Cursor;
import android.support.v4.widget.CursorAdapter;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ImageView;
import android.widget.TextView;

public class CustomCursorAdapter extends CursorAdapter {

    private LayoutInflater inflater;

    public CustomCursorAdapter(Context context, Cursor c, int flags) {
        super(context, c, flags);
        inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    @Override
    public View newView(Context context, Cursor c, ViewGroup parent) {
        // do the layout inflation here
        View v = inflater.inflate(R.layout.listitem_car, parent, false);
        return v;
    }

    @Override
    public void bindView(View v, Context context, Cursor c) {
        // do everything else here
        TextView txt = (TextView) v.findViewById(R.id.listitem_car_name);
        ImageView img = (ImageView) v.findViewById(R.id.listitem_car_image);

        String text = c.getString(c.getColumnIndex("COLUMN_TEXT")); 
        txt.setText(text);

        // where the magic happens
        String imgName = c.getString(c.getColumnIndex("COLUMN_IMAGE"));
        int image = context.getResources().getIdentifier(imgName, "drawable", context.getPackageName());
        img.setImageResource(image);
    }

} 
```

我希望它主要是不言自明的，但是我标记为“魔法发生的地方”的部分应该是与您的问题有关的最重要的部分。基本上，您从数据库中获取图像名称，然后下一行尝试按名称（而不是像往常一样通过 id）查找图像，然后您只需像往常一样设置图像。该方法返回`int 0`它找不到的图像，因此您可能希望也可能不希望为此执行错误处理。此外，如果您想使用其他加载图像的方法，那就是这样做的地方。

# c++ - Visual Studio C++ 项目

> ID：14088398
> 
> 赞同：0
> 
> 时间：2012-12-30T04:50:23.180
> 
> 标签：c++, visual-studio-2012

好的，这个问题非常基本，我可能遗漏了一些明显的东西。但我刚刚在 Windows 8 上下载了 Visual Studio 2012，因为我正在重新学习 C++。而且我终其一生都找不到如何创建一个基本的 C++ 项目。没什么特别的。只是一个包含扩展名为 .cpp 的文件的空白 C++ 项目。在 VS 中，我转到文件>新项目>已安装>模板>Visual C++。那里的所有内容都是与 xaml 相关的或其他比我想要处理的更复杂的东西（例如 Direct3D App）。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:16:10.977

您应该找到类似于以下内容的内容：

![在此处输入图像描述](../Images/513c24c36b76edc96ccc5e7d2d48c892.png)

如果您下载了 Visual Studio Express 2012，请确保您获得了正确的版本（**Windows**、Web、Phone 等）。

# java - 合并算法

> ID：14088400
> 
> 赞同：0
> 
> 时间：2012-12-30T04:50:30.397
> 
> 标签：java, mergesort

这是用于合并排序的合并实现，在 Java 中有效：

```
void merge(int[] numbers, int low, int mid, int high) {
    int helper[] = new int[numbers.length];
    for (int i = low; i <= high; i++) {
         helper[i] = numbers[i];
    }

    int lowone = low;
    int lowtwo = mid + 1;
    int count = low;

    while (lowone <= mid || lowtwo <= high) {
        if (lowone <= mid && lowtwo <= high) {
            if (helper[lowone] <= helper[lowtwo]) {
                numbers[count] = helper[lowone];
                lowone++;
            } else {
                numbers[count] = helper[lowtwo];
                lowtwo++;
            }
        }
        else if (lowone <= mid) {
              numbers[count] = helper[lowone];
              lowone++;
            }
        else {
              numbers[count] = helper[lowtwo];
              lowtwo++;

        }
       count++;
    }
}
//msort algorithm in case it's relevant
void msort(int[] arr, int low, int high) {
    if (low < high) {
        int mid = (low + high)/2;

        msort(arr, low, mid);
        msort(arr, mid + 1, high);

        merge(arr, low, mid, high);
    }
} 
```

在我第一次尝试合并时，我试图让数组的后半部分包含中点索引，而不是在前半部分包含它。这是相关代码（请注意，上面只有 4 处更改）：

```
 int lowtwo = mid;

    while (lowone < mid || lowtwo <= high) {
        if (lowone < mid && lowtwo <= high) {
            if (helper[lowone] <= helper[lowtwo]) {
                numbers[count] = helper[lowone];
                lowone++;
            } else {
                numbers[count] = helper[lowtwo];
                lowtwo++;
            }
        }
        else if (lowone < mid) {
              numbers[count] = helper[lowone];
              lowone++;
        }
        else {
              numbers[count] = helper[lowtwo];
              lowtwo++;   
        } 
```

与 msort（上图）一起使用的修改版本无法正确排序列表。也许这很明显，但我似乎无法弄清楚为什么它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:16:05.663

问题出现是因为您在合并中更改了 mid 的含义。查看它的最简单方法是一个示例。假设我们有一个带有索引的数组：

```
[0 1 2 3 4] 
```

调用 msort，您将传入 0 表示低，4 表示高。这意味着 mid 被计算为 2。所以你现在将数组划分为这样（不在内存中，只是在逻辑上）：

```
[0 1 2] [3 4] 
```

现在，当调用 merge 时，它​​传入 2 作为 mid ，这是数组 1 中的最后一个索引。但是，在您修改后的代码中，您将 mid 作为数组 2 的起始索引。这使得两个数组看起来像：

```
[0 1] [2 3 4] 
```

这与一切如何对待它不同。如果您是两个数组（排序后）看起来像这样（数字现在是值，而不是索引），则这种情况会下降的一个例子：

```
[8 12 14] [7 11] 
```

但是，根据您对 mid 的解释，数组是：

```
[8 12] [14 7 11] 
```

不再排序。因此，您的合并功能将不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T05:34:36.150

`msort(...)`这是因为在与第二个子数组 (in ) 中的中点合并之前，您已经使用第一个子数组 (in ) 中的中点对两个子列表进行了排序`merge(...)`。

举个最简单的例子

[2,1]

像这样分裂（因为 mid == ((0+1)/2) == 0 ）

[2] 和 [1]

哪个 msort 微不足道地排序

[2] 和 [1]

但是，通过将 mid 放在合并的第二个列表中，您实际上是在合并：

[] 和 [2,1]

这显然导致[2,1]，这是错误的！

中点放置在两个子阵列的拆分和合并中必须保持一致。

# php - 带有php的电子邮件不发送电子邮件

> ID：14088405
> 
> 赞同：0
> 
> 时间：2012-12-30T04:52:09.977
> 
> 标签：php, email

我正在尝试使用 php 发送电子邮件，一切似乎都正常，但我没有收到电子邮件。没有错误出现，我只是没有收到电子邮件。有什么建议么？这是我的代码：

```
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>mail</title>
<link href="loginmodule.css" rel="stylesheet" type="text/css" />

<?php
if(isset($_POST['email'])) {

    // EDIT THE 2 LINES BELOW AS REQUIRED
    $email_to = "myemail@gmail.com";
    $email_subject = "MythMedia Account Reqe";

    function died($error) {
        // your error code can go here
        echo "We are very sorry, but there were error(s) found with the form you submitted. ";
        echo "These errors appear below.<br /><br />";
        echo $error."<br /><br />";
        echo "Please go back and fix these errors.<br /><br />";
        die();
    }

    // validation expected data exists
    if(!isset($_POST['first_name']) ||
        !isset($_POST['last_name']) ||
        !isset($_POST['email']) 
        ) {
        died('We are sorry, but there appears to be a problem with the form you submitted.');      
    }

    $first_name = $_POST['first_name']; // required
    $last_name = $_POST['last_name']; // required
    $email_from = $_POST['email']; // required
    $telephone = $_POST['telephone']; // not required
    $comments = $_POST['comments']; // required

    $error_message = "";

    $string_exp = "/^[A-Za-z .'-]+$/";
  if(!preg_match($string_exp,$first_name)) {
    $error_message .= 'The First Name you entered does not appear to be valid.<br />';
  }
  if(!preg_match($string_exp,$last_name)) {
    $error_message .= 'The Last Name you entered does not appear to be valid.<br />';
  }

  if(strlen($error_message) > 0) {
    died($error_message);
  }

    function clean_string($string) {
      $bad = array("content-type","bcc:","to:","cc:","href");
      return str_replace($bad,"",$string);
    }

    $email_message .= "First Name: ".clean_string($first_name)."\n";
    $email_message .= "Last Name: ".clean_string($last_name)."\n";
    $email_message .= "Password: ".clean_string($email_from)."\n";

// create email headers
$headers = 'From: '.Mythmedia."\r\n".
'Reply-To: '.$email_from."\r\n" .
'X-Mailer: PHP/' . phpversion();
mail($email_to, $email_subject, $email_message, $headers);

?>

Thank you, I will process your account soon&trade;<br>

 <a href="login-form.php">Login</a>
<?php
}
?> 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:01:37.850

请检查此行

```
$headers = 'From: '.Mythmedia."\r\n". 
```

我认为你必须做类似的事情

```
$Mythmedia='Mythmedia';
$headers = 'From: '.$Mythmedia."\r\n". 
```

或者

```
$headers = 'From: Mythmedia \r\n'. 
```

# ruby-on-rails - 在响应 JSON 调用时包括虚拟属性

> ID：14088407
> 
> 赞同：2
> 
> 时间：2012-12-30T04:52:35.077
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个帖子模型，它有一个我想设置的虚拟属性，然后包含在对我的 post#index 操作的 JSON 调用的响应中。我似乎无法将虚拟属性包含在响应中。

```
class Post < ActiveRecord::Base
  attr_accessible :height
  attr_accessor :m_height
end

class PostsController < ApplicationController
  respond_to :html, :json, :js

  def index
    story = Story.find(params[:story_id])
    @posts = story.posts.where("posts.id >= ?", 100)
    @posts.each do |post|
      post.m_width = post.height * 200
    end
    results = { :total_views => story.total_views,  
                :new_posts => @posts }
    respond_with(results)
  end
end 
```

我认为我必须需要类似的东西`@post.to_json(:methods => %w(m_width))`，但我不知道如何在 response_with 中使用 :methods

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:17:17.997

~~[这](http://asciicasts.com/episodes/224-controllers-in-rails-3)似乎提供了答案。酌情在您的模型中实施 a `to_json`and `to_xml`，其定义如下：~~

[这里](http://blog.gomiso.com/2011/05/16/if-youre-using-to_json-youre-doing-it-wrong/)暗示了一个更好的答案。

以下代码从帖子中窃取：

```
 def as_json(options={})
    super(options.merge(:methods => [...], :only => [...], :include => [...])
  end 
```

`to_json`在这种情况下，不会在您的模型上调用，从我在[源代码](https://github.com/rails/rails/blob/1304298bd921976b8390a8d90bb533fd493e2867/activesupport/lib/active_support/json/encoding.rb#L58)中可以看出，但`as_json`会在序列化过程中。

因此，以概览形式发生的情况如下：

1.  `respond_with`您使用已构建的结果哈希调用。
2.  Rails (ActionController)[调用 to_json](https://github.com/rails/rails/blob/1304298bd921976b8390a8d90bb533fd493e2867/actionpack/lib/action_controller/metal/responder.rb#L154)。
3.  `to_json` [将您发送到](https://github.com/rails/rails/blob/1304298bd921976b8390a8d90bb533fd493e2867/activesupport/lib/active_support/core_ext/object/to_json.rb#L16) [JSON::Encoding](https://github.com/rails/rails/blob/1304298bd921976b8390a8d90bb533fd493e2867/activesupport/lib/active_support/json/encoding.rb#L58)，它会一直调用`as_json`，直到所有内容都被 JSON 化。

这就是为什么在这个答案的早期版本中存在混淆`to_json`的原因。`as_json`

# jquery-ui - 带有工具提示的 jquery UI 滑块

> ID：14088408
> 
> 赞同：3
> 
> 时间：2012-12-30T04:52:43.840
> 
> 标签：jquery-ui, slider

我正在处理的网页上有一个 jquery UI 滑块，但我也希望在滑块上获得一个工具提示。我已经解决了这里的大部分问题（搜索），但没有找到我要找的东西，或者我无法理解答案。

这是我正在寻找的示例： [带有工具提示的示例 UI 滑块](http://media02.hongkiat.com/jquery-ui-slider/demo/index.html)

这是我的滑块： [我的滑块还没有工具提示](http://mypaydayloanus.com/)

我刚刚从 jquery 网站创建了一个简单的 UI 滑块。捕捉到增量。理想情况下，无论滑块的金额是多少，我都希望工具提示显示在它的正上方。稍后我将处理 CSS 代码以获得外观。

而且我不能发布我的实际代码，因为它里面有超链接，而且因为我是这里的新手，这个网站不会让我发布超过 2 个超链接的帖子，我已经用过了向您展示示例和我的滑块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T14:07:57.210

我相信你正在寻找[这个](http://css-tricks.com/value-bubbles-for-range-inputs/)。

基本上，本教程展示了如何设置滑块样式并在滑块上方放置工具提示以获取输入值。

# ruby - 从格式化的时间字符串中获取时间间隔

> ID：14088409
> 
> 赞同：0
> 
> 时间：2012-12-30T04:52:53.937
> 
> 标签：ruby

我有两个变量`time_before`，`time_after`如下所示：

```
time_before = Time.now.strftime("%H%M%S")
time_after = Time.now.strftime("%H%M%S") 
```

我想以秒为单位获得时间间隔，`time_before`并`time_after`在不同时间分配。任何人请指导我的方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:00:14.510

```
time_before = Time.now
...
time_after = Time.now

puts "before #{time_before.strftime('%H%M%S')}"
puts "after #{time_before.strftime('%H%M%S')}"
puts "elapsed (seconds): #{time_after - time_before}" 
# its already in seconds, with fractional
puts "#{'%.0f' % (time_after - time_before)}" # just whole seconds 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:32:35.507

```
time_before = Time.now.strftime("%H%M%S")
sleep(1)
time_after = Time.now.strftime("%H%M%S")

[time_before, time_after]
.map{|s| Time.parse(s.scan(/\d\d/).join(":"))}
.tap{|t1, t2| puts t2 - t1} 
```

# node.js - 猫鼬和 q 承诺

> ID：14088410
> 
> 赞同：6
> 
> 时间：2012-12-30T04:53:03.813
> 
> 标签：node.js, mongoose, deferred, promise, q

我在[这里](https://gist.github.com/2660323)使用 mongoose/q promises 框架示例，但在尝试使用 findOne 时似乎 nfbind 存在一些问题，主要是因为来自[Q](https://github.com/kriskowal/q)框架的示例似乎与要点中的示例不匹配。

我的代码：

```
var mongoose = require('mongoose');
var Q = require('q');

var user_schema = mongoose.Schema({username:String, last_touched:Date, app_ids:[String]});
var user = mongoose.model('user', user_schema);

exports.user = user;
exports.user.find = Q.nfbind(user.find);
exports.user.findOne = Q.nfbind(user.findOne); 
```

如果我打电话`user.findOne({username:'test'}).then(function(err, user) { ... }`，用户总是未定义的。如果我删除导出并使用带有回调的非承诺版本，我会得到用户。我错过了一些特殊的魔法，但是在查看了代码实现、来自 Q github 的示例和来自 mongoose 演示的示例之后......没有什么真正跳出来的。关于如何`findOne`与 Q 合作的任何想法？

我也尝试`nfbind`在源代码而不是模块中设置功能，但无济于事。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T05:59:49.857

因为您要 nfbinding 的方法是`user`对象的方法，所以您需要`bind`在将它们传递给该对象之前将它们传递给该对象，`nfbind`以便`this`在调用时保留指针。

这种方法对我有用：

```
exports.user.find = Q.nfbind(user.find.bind(user));
exports.user.findOne = Q.nfbind(user.findOne.bind(user)); 
```

# android - 活动生命周期问题

> ID：14088411
> 
> 赞同：0
> 
> 时间：2012-12-30T04:53:10.227
> 
> 标签：android, android-activity

如果全局数据结构不存在（它是静态的，在 中 `public class Globals extends Application`），我想在我的一个活动中隐藏一个按钮。由于我想在恢复活动时重绘按钮，但不想重绘视图的其余部分，因此我将视图的初始化`onCreate()`和按钮隐藏代码放入`onResume()`：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.myActivity);
}

@Override
protected void onResume() {
    super.onResume();

    if (Globals.datastructure == null) {
        ((Button) findViewById(R.id.myButton)).setVisibility(View.GONE);
    }
} 
```

当我分配数据结构然后从不同的活动返回到活动时，`onResume`正确执行但按钮不会重新出现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T04:59:10.930

包含按钮的活动可能没有被重新创建，这意味着当您从其他活动返回到它时，按钮永远不会被设置（返回）为可见。您可能应该将其更改为`onResume()`：

```
@Override
protected void onResume() {
    super.onResume();

    findViewById(R.id.myButton).setVisibility(Globals.datastructure == null ? View.GONE : View.VISIBLE);
} 
```

所以基本上你只需要确保无论何时`Globals.datastructure != null`，你也可以适当地改变可见性。换句话说： an`else`是必需的`if`。

# jquery - jquery mobile嵌套列表视图不显示子菜单

> ID：14088413
> 
> 赞同：1
> 
> 时间：2012-12-30T04:53:30.857
> 
> 标签：jquery, jquery-mobile

我正在将 jquery 移动嵌套列表视图合并为我正在构建的 vBulletin 网站的移动版本的主导航菜单。请注意，您需要使用移动设备/模拟器，否则列表视图将不会显示。我正在通过更改 Safari 中的用户代理进行测试。

这是该网站的链接：

[http://www.ulbf.innov-images.com/content.php?6-home](http://www.ulbf.innov-images.com/content.php?6-home)

这是带有列表视图的 html：

```
<ul data-role="listview">    
    <li><a href="register.php">How to Join</a></li>
    <li><a href="memberlist.php">Find a Service or Member</a></li>
    <li><a href="sendmessage.php">Contact Us</a></li>                      
    <li>For Members
        <ul data-role="listview">
            <li><a href="#">History &amp; Mission</a></li>
            <li><a href="#">Success Stories</a></li>
            <li><a href="#">Current Officers</a></li>
            <li><a href="#">Past Events &amp; Topics</a></li>
        </ul>
    </li>
</ul> 
```

包含嵌套列表视图的列表项是“For Members”项。

我对此进行了大量研究，甚至创建了一个具有相同 html 和 jquery/jq mobile 版本的 jsfiddle。

编辑： jsfiddle 确实有效。这就是我想说的。小提琴有效，但我网站上的代码没有，我不知道为什么。

[http://jsfiddle.net/QfyZd/](http://jsfiddle.net/QfyZd/)

我的结论是 vbulletin 中必须有其他 javascript 和/或 css 阻止子菜单显示。我尝试不包括两个 vBulletin javascript，但这有效果。

我不知道从这里去哪里。

编辑 - 我发现问题来自 vbulletin-mobile.js。我将文件解压缩并将其加载到我的服务器。似乎问题出现在第 799 - 1006 行的列表视图部分。那是相当多的行，到目前为止，我不知道在哪里。我会继续努力，但与此同时，如果有人有任何想法，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-03T10:10:35.447

**jquery移动嵌套列表视图**

```
<!DOCTYPE html>
<html>
    <head>
        <title>jQM Complex Demo</title>
        <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
        <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi"/>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
        <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>    
    </head>
    <body>
        <div data-role="page" id="index">
            <div data-theme="b" data-role="header">
                <h1>Index page</h1>
            </div>

            <div data-role="content">
                <ul data-role="listview" data-header-theme="e">
                    <li>Animals
                        <ul>
                            <li>Pets
                                <ul>
                                    <li><a href="index.html">Canary</a></li>
                                    <li><a href="index.html">Cat</a></li>
                                    <li><a href="index.html">Dog</a></li>
                                </ul>
                            </li>
                            <li>Farm animals
                                <ul>
                                    <li><a href="index.html">Chicken</a></li>
                                    <li><a href="index.html">Cow</a></li>
                                    <li><a href="index.html">Sheep</a></li>
                                </ul>
                            </li>
                            <li>Wild animals>
                                <ul>
                                    <li><a href="index.html">Alligator</a></li>
                                    <li><a href="index.html">Bear</a></li>
                                    <li><a href="index.html">Zebra</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>Colors
                        <ul>
                            <li><a href="index.html">Blue</a></li>
                            <li><a href="index.html">Green</a></li>
                            <li><a href="index.html">Red</a></li>
                        </ul>
                    </li>
                    <li>Vehicles
                        <ul>
                            <li>Cars
                                <ul>
                                    <li><a href="index.html">Audi</a></li>
                                    <li><a href="index.html">BMW</a></li>
                                    <li><a href="index.html">Volkswagen</a></li>
                                </ul>
                            </li>
                            <li>Planes
                                <ul>
                                    <li><a href="index.html">Boeing</a></li>
                                    <li><a href="index.html">Embraer</a></li>
                                    <li><a href="index.html">Airbus</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul><br/><br/>
                <div data-role="collapsible-set" data-theme="b" data-content-theme="d" data-inset="false">
                    <div data-role="collapsible">
                        <h2>Filtered list</h2>
                        <ul data-role="listview" data-filter-theme="c" data-divider-theme="d" data-inset="false">
                            <li><a href="index.html">Adam Kinkaid</a></li>
                            <li><a href="index.html">Alex Wickerham</a></li>
                            <li><a href="index.html">Avery Johnson</a></li>
                            <li><a href="index.html">Bob Cabot</a></li>
                            <li><a href="index.html">Caleb Booth</a></li>
                        </ul>
                    </div>
                    <div data-role="collapsible">
                        <h2>Formatted text</h2>
                        <ul data-role="listview" data-theme="d" data-divider-theme="d">
                            <li data-role="list-divider">Friday, October 8, 2010 <span class="ui-li-count">2</span></li>
                            <li><a href="index.html">
                                <h3>Stephen Weber</h3>
                                <p><strong>You've been invited to a meeting at Filament Group in Boston, MA</strong></p>
                                <p>Hey Stephen, if you're available at 10am tomorrow, we've got a meeting with the jQuery team.</p>
                                <p class="ui-li-aside"><strong>6:24</strong>PM</p>
                                </a></li>
                            <li><a href="index.html">
                                <h3>jQuery Team</h3>
                                <p><strong>Boston Conference Planning</strong></p>
                                <p>In preparation for the upcoming conference in Boston, we need to start gathering a list of sponsors and speakers.</p>
                                <p class="ui-li-aside"><strong>9:18</strong>AM</p>
                                </a></li>
                        </ul>
                    </div>
                    <div data-role="collapsible">
                        <h2>Thumbnails and split button</h2>
                        <ul data-role="listview" data-split-icon="gear" data-split-theme="d" data-inset="false">
                            <li><a href="index.html">
                                <img src="../../_assets/img/album-bb.jpg">
                                    <h3>Broken Bells</h3>
                                    <p>Broken Bells</p>
                                </a><a href="lists-split-purchase.html" data-rel="dialog" data-transition="slideup">Purchase album
                                </a></li>
                                <li><a href="index.html">
                                    <img src="../../_assets/img/album-hc.jpg">
                                        <h3>Warning</h3>
                                        <p>Hot Chip</p>
                                    </a><a href="lists-split-purchase.html" data-rel="dialog" data-transition="slideup">Purchase album
                                    </a></li>
                                    <li><a href="index.html">
                                        <img src="../../_assets/img/album-p.jpg">
                                            <h3>Wolfgang Amadeus Phoenix</h3>
                                            <p>Phoenix</p>
                                        </a><a href="lists-split-purchase.html" data-rel="dialog" data-transition="slideup">Purchase album
                                        </a></li>
                                    </ul>
                                </div>
                            </div>                
                        </div>
                    </div>    
                </body>
            </html> 
```

# java - Eclipse 自动生成的 toString() 方法

> ID：14088414
> 
> 赞同：5
> 
> 时间：2012-12-30T04:54:12.927
> 
> 标签：java, eclipse, tostring

据我所知，当您有大量字符串时，使用 + 号连接字符串不是一个好习惯。但是当我检查 eclipse 生成的 toString() 方法时（点击源文件 -> 源 -> 生成 toString() ）它具有相同的。

```
public class Temp
 {
      private String tempName;
      private String tempValue;

      // here getters and setters

  /* (non-Javadoc)
         * @see java.lang.Object#toString()
  */
@Override
public String toString() {
    return "Temp [tempName=" + tempName + ", tempValue=" + tempValue + "]";
}

} 
```

是否有任何地方可以像我预期的 toString() 方法一样配置，如 Eclipse 中的波纹管或为什么 Eclipse 不考虑这一点。

```
 public String expectedToString(){
    StringBuffer sb = new StringBuffer();
    sb.append("Temp [tempName=").append(tempName).append(",").append(" tempValue=").append(tempValue).append("]");
    return sb.toString();
} 
```

我将使用自动生成的 toString() 方法来记录我的对象值。

请给我建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T05:18:59.093

无需更改任何内容，它紧凑且易于阅读，javac 将使用 StringBuilder 进行实际连接，如果您反编译 Temp.class，您将看到

```
public String toString() {
   return (new StringBuilder("Temp [tempName=")).append(tempName).append(", tempValue=").append(tempValue).append("]").toString();
} 
```

但在其他情况下，比如

```
 String[] a = { "1", "2", "3" };
    String str = "";
    for (String s : a) {
        str += s; 
    } 
```

`+`或者`+=`是真正的性能杀手，请参阅反编译代码

```
String str = "";
for(int i = 0; i < j; i++) {
    String s = args1[i];
    str = (new StringBuilder(String.valueOf(str))).append(s).toString();
} 
```

在每次迭代中，都会创建一个新的 StringBuilder，然后将其转换为 String。在这里你应该明确地使用 StringBuilder

```
 StringBuilder sb = new StringBuilder();
    for (String s : a) {
        sb.append(s); 
    }
    String str = sb.toString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-11T03:39:40.600

请注意，Eclipse 4.21（2021 年 7 月，9 年后）将有助于生成正确的代码：

> ## [“使用 StringBuilder 而不是 StringBuffer”清理](https://www.eclipse.org/eclipse/news/4.21/jdt.php#stringbuffer-to-stringbuilder)

> 添加了一个新的清理，将代码转换为使用`StringBuilder`（在 Java 1.5 中添加），而不是`StringBuffer`具有同步方法并且比 using 慢`StringBuilder`。
> 
> 有一个子选项，其中更改只会发生在默认情况下启用的局部变量。
> 当此子选项打开时，只会对`StringBuffer`方法本地的变量进行更改。
> 当一个方法使用这些变量调用其他方法或分配给/从字段/参数时，方法内容将不会被转换。
> 允许将 StringBuffer 字段或参数附加到局部`StringBuffer`变量，然后仍然可以转换为`StringBuilder`.
> 
> 选择该选项并关闭“本地变量的子选项”时，无论使用如何，`StringBuffer`所选文件中的所有使用情况都会更改为。 应该注意的是，在这种情况下，清理将不会跟踪引用的未选择的类和方法，并且可能需要更改才能成功编译。`StringBuilder`
> 
> 要应用清理，请选中清理配置文件中选项卡`Use StringBuilder instead of StringBuffer`上的复选框。 要仅指定局部变量，请选中下方的复选框。`Optimization`
> `Only for local variables`
> 
> [![首选项——https://www.eclipse.org/eclipse/news/4.21/images/stringbuffer-to-stringbuilder-prefs.png](../Images/86a1532bf688c61cdefba909c273e8fc.png)](https://i.stack.imgur.com/mkjET.png)

例子：

[![之前——https://www.eclipse.org/eclipse/news/4.21/images/stringbuffer-to-stringbuilder-before.png](../Images/7abfaa29bda2b267990f7b286809f4ee.png)](https://i.stack.imgur.com/aRnWS.png)

会成为：

[![之后——https://www.eclipse.org/eclipse/news/4.21/images/stringbuffer-to-stringbuilder-after.png](../Images/865694b1cd1976896bc4dc0e7eb35838.png)](https://i.stack.imgur.com/Cj3kc.png)

# linux - kinect“无法枚举端口上的 USB 设备”安装为常规集线器，但检测到“Xbox NUI 摄像头”和“Xbox NUI 音频”

> ID：14088422
> 
> 赞同：0
> 
> 时间：2012-12-30T04:56:18.903
> 
> 标签：linux, kinect, xbox360, openkinect

注意：我的设备是 xbox 360 kinect 设备，不是 Windows 的 kinect。我尝试了不同的 linux 内核和不同的 libfreenect 编译，但没有雪茄。

连接线上的指示灯呈绿色常亮，kinect 设备上的指示灯呈绿色闪烁（当它插入我正在运行的计算机时）。

一个似乎可疑的特点是 udev 文件将 ATTR{idProduct}=="02b0" 指定给 xbox“Xbox NUI Motor”。正如在我的 lsusb 文件中看到的那样，linux 正在使用 idProduct 为“02c2”的设备重新识别设备。该设备已在大约一个月前购买，所以他们可以更改 idProduct 吗？在这个猜测下我修改了我的udev规则文件重新启动udev，没有工作，然后重新启动我的电脑，仍然没有工作。

我正在从 github 编译 libfreenect，你可以看到下面的输出。我还尝试了 debian 软件包（0.1.2）。由于检测到“Xbox NUI 音频”“Xbox NUI 摄像头”，我觉得这不是 USB 电源问题，但我可能是错的。

测试程序输出：

```
$ ./bin/glview
Kinect camera test
Number of devices found: 1
Could not open device 
```

调试信息：

```
$ dmesg
[  361.532077] usb 1-4: new high-speed USB device number 2 using ehci_hcd
[  361.664408] usb 1-4: New USB device found, idVendor=045e, idProduct=02c2
[  361.664416] usb 1-4: New USB device strings: Mfr=0, Product=0, SerialNumber=0
[  361.664875] hub 1-4:1.0: USB hub found
[  361.665008] hub 1-4:1.0: 2 ports detected
[  361.940144] usb 1-4.2: new high-speed USB device number 3 using ehci_hcd
[  361.972410] hub 1-4:1.0: unable to enumerate USB device on port 2
[  362.668134] usb 1-4.1: new high-speed USB device number 4 using ehci_hcd
[  362.762514] usb 1-4.1: New USB device found, idVendor=045e, idProduct=02ad
[  362.762522] usb 1-4.1: New USB device strings: Mfr=1, Product=2, SerialNumber=3
[  362.762529] usb 1-4.1: Product: Xbox Kinect Audio, \xffffffc2\xffffffa9\xffffffa9 2011 Microsoft Corporation. All rights reserved.
[  362.762535] usb 1-4.1: Manufacturer: Microsoft
[  362.762540] usb 1-4.1: SerialNumber: A70774X04011232A 
```

lsusb 调试信息：

```
$ lsusb
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 004 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 005 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 006 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 007 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
Bus 003 Device 002: ID 064e:a101 Suyin Corp. Acer CrystalEye Webcam
Bus 005 Device 003: ID 0c45:7403 Microdia 
Bus 001 Device 002: ID 045e:02c2 Microsoft Corp. 
Bus 001 Device 004: ID 045e:02ad Microsoft Corp. Xbox NUI Audio
Bus 001 Device 006: ID 045e:02ae Microsoft Corp. Xbox NUI Camera 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-16T14:21:57.357

安装了 ROS (fuerto/groovy) + PCL 并与**openni_launch**包一起工作。我也在使用 XBOX kinect。使用 RVIZ 进行可视化！

# php - Web 服务中的多种语言

> ID：14088428
> 
> 赞同：0
> 
> 时间：2012-12-30T04:56:59.780
> 
> 标签：php, ios, web-services

目前我正在使用 php web 服务从 MySQL 中检索信息。我正在处理多种语言，包括中文/日文/法文字符，我在显示中文/日文和其他几种语言时遇到问题。

```
<?php

    echo "你好";

?> 
```

例如，当我尝试回显简单的汉字时，显示的是“ä½ å¥½”，我不知道如何进行。

请指教。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T05:09:52.710

您可能应该设置字符编码。

这通常是通过设置 html 内容类型标头来完成的。默认值通常是：

`Content-Type: text/html; charset=ISO-8859-1`

[`header()`](http://ca3.php.net/manual/en/function.header.php)您可以使用该函数通过 php 更改此设置。

`header('Content-Type: text/html; charset=utf-8');`

为您提供的其他一些资源：

[http://www.w3.org/International/questions/qa-html-encoding-declarations](http://www.w3.org/International/questions/qa-html-encoding-declarations) http://en.wikipedia.org/wiki/Character_encodings_in_HTML

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T05:14:05.700

1) 确保文件保存为 UTF-8（无 BOM）

2）告诉浏览器它是UTF-8（正如hafichuk解释的）

3) 确保浏览器使用具有中文/日文/等字符的字体（大量字体没有它们——如果你已经完成了 1 和 2，这很可能是问题所在）

# java - 请求调度程序转发在包含任何 servlet 后不转发

> ID：14088429
> 
> 赞同：1
> 
> 时间：2012-12-30T04:57:07.393
> 
> 标签：java, jakarta-ee, servlets, requestdispatcher

有人请帮助我。

```
 private void forward(String address,
                    HttpServletRequest  request,
                    HttpServletResponse response)
                        throws ServletException, IOException{
    getServletContext()
        .getRequestDispatcher("/" + address)
        .forward(request, response);
}
private void include(String address,
                    HttpServletRequest  request,
                    HttpServletResponse response)
                        throws ServletException, IOException{
    getServletContext()
        .getRequestDispatcher("/" + address)
        .include(request, response);
} 
```

这两个函数已经写在我项目的每个 servlet 中，问题是当我第一次在 servlet 中使用这两个函数时 include("servlet/abc",request.response); 在它使用了 forward("servlet/def",request.response); 所以使用Netbeans 7我一步一步地观察到转发不是转发servlet的控制但是当我在转发之前不使用include时转发它的控制。

所以我想知道它为什么会发生，原因是什么，以及在包含任何 servlet 之后我该怎么做。

请有人帮助我……这是一个有趣的问题。

```
include("servlet/abc",request, response);

forward("servlet/def",request, response);   //HERE IS PROBLEM NOT FORWRDING AFTER INCLUDE 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T06:29:15.713

无论您似乎观察到这种行为的确切*原因*，您所尝试的都不会奏效。根据[RequestDispatcher.forward()](http://docs.oracle.com/javaee/6/api/javax/servlet/RequestDispatcher.html#forward%28javax.servlet.ServletRequest,%20javax.servlet.ServletResponse%29)的约定，“如果响应已经提交，则此方法会抛出 IllegalStateException”，并且“响应缓冲区中未提交的输出在转发之前会自动清除。”

因此，无论转发成功与否，您都无法在转发之前和之后成功地将内容发送回用户。这是因为转发的目的是允许“一个 servlet 对请求进行初步处理，另一个资源生成响应”，而不是让两个不同的 servlet 生成响应的不同部分。在 Servlet 模型中，生成响应始终只属于一个 servlet。

如果您不知道“已提交”和“未提交”是什么意思，则[指的是响应状态和标头是否已发送给用户](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponse.html#isCommitted%28%29)。当您编写响应时，实际上是在写入[本地缓冲区](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponse.html#setBufferSize%28int%29)。不会立即发送任何内容。只要您编写的所有内容仍然是本地的，您就可以自由地做任何事情，包括[重置缓冲区](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponse.html#reset%28%29)和重新开始，就像前锋一样，但是一旦发送了某些内容，您就已经承诺并且不能再改变你要做什么。响应可以通过几种方式提交（即全部或部分发送给用户），包括填充缓冲区以便必须发送它以腾出空间容纳更多内容，手动，或刷新响应的[Writer](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponse.html#getWriter%28%29)或[OutputStream](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletResponse.html#getOutputStream%28%29)。

最终，在您的情况下*可能*发生的事情是您正在使用包含编写一些东西，并且它导致响应被提交，或者是因为您已经填充了缓冲区，或者因为我似乎记得包含通常会导致自动冲洗（不确定有关此文档的文档）。然后，当您尝试转发时，它会抛出所需的 IllegalStateException，您可能应该在日志中的某个地方看到它，但不会导致典型的 500 响应状态，因为正如我所讨论的，您已经提交了一些其他状态代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T05:01:45.400

提交响应后，您无法更改响应状态或状态。当您使用请求调度程序包含某些页面时，您实际上是在提交响应并且数据开始发送到客户端。之后，您将无法将响应状态更改为重定向所需的 302。

`java.lang.IllegalStateException: Cannot forward after response has been committed`如果你尝试这样做，你会得到一个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-25T20:26:47.240

RequestDispatcher 只有两种方法：

```
public interface javax.servlet.RequestDispatcher {
  public abstract void forward(javax.servlet.ServletRequest, javax.servlet.ServletResponse) throws javax.servlet.ServletException, java.io.IOException;
  public abstract void include(javax.servlet.ServletRequest, javax.servlet.ServletResponse) throws javax.servlet.ServletException, java.io.IOException;
} 
```

你给它作为

```
include("servlet/abc",request, response);
forward("servlet/def",request, response); 
```

但是在 API 中只提到了 servlet 请求对象和响应对象作为参数，所以我想你应该从那里删除你的 url。如果我错了，请纠正我，因为我也在学习。

# python - python：我想在谷歌位置结果中找到第一条记录但得到第一个字符

> ID：14088430
> 
> 赞同：0
> 
> 时间：2012-12-30T04:57:25.087
> 
> 标签：python, google-maps

我正在使用 google place API 返回位置列表。我想从结果集中找到名字。我得到了一个值列表，但是当我尝试只获取名字时，它给了我第一个字符。

```
name2 = simplejson.dumps([s['name'] for s in result['results']], indent=0)[0] 
```

显然，必须有更好的方法来获得我想要的东西，但我还没有找到。好像我错过了一些非常基本的东西。以下是整个函数：

```
import simplejson, urllib

PLACE_SEARCH = 'https://maps.googleapis.com/maps/api/place/textsearch/json'

def placelatlng(name,city, state,  sensor,**geo_args):
    geo_args.update({
        'name': name,
        'city': city,
        'state': state,       
        'sensor': sensor  
    })  
    concat=name+'+'+city+'+'+state 
    query =  {"query": concat }

    key="MyKey"
    url = PLACE_SEARCH + '?' + urllib.unquote(urllib.urlencode(query))+ '&'  + "sensor="+sensor +'&' + "key="+key
    result = simplejson.load(urllib.urlopen(url))
    name2 = simplejson.dumps([s['name'] for s in result['results']], indent=0) 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T05:10:58.283

dumps() 返回一个字符串。`[0]`获取其中的第一个字符。

要获得第一个结果的名称：

```
print result['results'][0]['name'] 
```

# ruby-on-rails-3 - 如何在 Heroku 中处理长 Web 请求？

> ID：14088436
> 
> 赞同：2
> 
> 时间：2012-12-30T04:59:16.530
> 
> 标签：ruby-on-rails-3, heroku, controller, timeout, httprequest

[https://devcenter.heroku.com/articles/request-timeout](https://devcenter.heroku.com/articles/request-timeout)

* * *

根据他们的文档，30 秒和超时错误触发。

我正在上传并解析一个 CSV 文件以保存到我的数据库中。其中一个文件大小为 1.7MB，有 37000 行。

这个过程处理时间有点长，肯定超过30秒。

在这些情况下我能做什么？我有什么选择？

```
require 'csv'

class DatabaseImporterController < ApplicationController
  def index
  end

  def import
    # Receive the uploaded CSV file and import to the database.
    csv_file = params[:csv_file].tempfile

    i = 0
    CSV.foreach(csv_file) do |row|
      # Structure for CSV file: Year, Make, Model, Trim
      if i > 0 then
        make = Make.find_or_create_by_name(row[1])
        model = make.model.create(:year => row[0], :name => row[2], :trim => row[3])
      end

      i += 1
    end
    redirect_to :action => 'list'
  end

  def list
    @models = Model.all
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T05:04:47.883

而不是在控制器中处理您的 CSV 文件，而是将通知推送到包含上传文件位置的队列。然后让[工人测功机](https://devcenter.heroku.com/articles/background-jobs-queueing)处理该处理。

你会多付一点钱，特别是如果你试图坚持使用免费的单 dyno 层，但这是一个可扩展的设计（这就是为什么我认为 HTTP 处理有 30 秒的超时）。

另一种方法是将数据直接推送到表中并异步执行存储过程。这会将工作推到 Postgres 来处理 HTTP 线程，并且可能会将您的请求置于 30 秒的时间限制之下，尽管对于较大的文件，您可能会违反此上限。

在您重新构建整个应用程序之前，您[需要运行一个测试](https://stackoverflow.com/questions/5893524/using-the-postgresql-gem-async)以确保 Heroku 没有禁用[libpq-asynch](http://www.postgresql.org/docs/9.0/interactive/libpq-async.html)。

上面代码中的最大成本是`Make.find_or_create_by_name`分别调用 37,000 个 - 根据您的示例输入 - SELECT 并且可能为 CSV 中的每一行调用一个 INSERT。如果 libpq-asynch 不是一个选项，您将不得不创建一个存储过程，该过程将一次以 100 或 1000 行的批次执行此功能 - 这样您的控制器代码就不会对数据库进行如此多的往返。Postgres 支持经典的序数索引样式的[数组](http://www.postgresql.org/docs/9.0/static/arrays.html)以及[行类型](http://www.postgresql.org/docs/9.0/static/rowtypes.html)的数组，所以这实际上比听起来要痛苦得多。

# php - 变量在 javascript 中传递

> ID：14088442
> 
> 赞同：0
> 
> 时间：2012-12-30T05:02:22.793
> 
> 标签：php, javascript, html

我必须将变量从 javascript 传递给 php。我的代码如下：

```
<script>
function getValue(val,val2){
      window.a = val;
      window.b = val2;
}
function getValue2(val,val2){
      window.c = val;
      window.d = val2;
}
function sendvar(){

        if(window.a === 'undefined'){
            window.a = 0;
        }
               if(window.b === 'undefined'){
            window.b = 0;
        }
                if(window.c === 'undefined'){
            window.c = 0;
        }
                if(window.d === 'undefined'){
            window.d = 0;
        }
location.href = "count.php?id="+window.a + "&optionname1=" + window.b + "&id=" + window.c + "&optionname1=" + window.d
</script>

<img src="img1.jpg" onclick="getValue('yes','1');">
<img src="img2.jpg" onclick="getValue2('no','1');">

<button onclick="sendvar();">Click me</button> 
```

当 getValue 函数调用所以只有这个函数的值传入 href 其他值应该为零，而当 getValue2 函数调用所以只有这个函数的值传入 href 其他值应该为零。但这不是现在发生的。

请告诉我我错在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:12:44.120

作为您的问题的解决方案，请参考以下代码片段

```
<script>
var a=0;
var b=0;
var c=0;
var d=0;
 function getValue(val,val2)
 {
   window.a = val;
   window.b = val2;
   window.c=0;
   window.d=0;
 }
 function getValue2(val,val2)
 {
   window.c = val;
   window.d = val2;
   window.a=0;
   window.b=0;
  }
 function sendvar(){

    location.href = "count.php?id="+window.a + "&optionname1=" + window.b + "&id=" +   window.c + "&optionname1=" + window.d
  }
    </script>

   <img src="img1.jpg" onclick="getValue('yes','1');">
   <img src="img2.jpg" onclick="getValue2('no','1');">
    <button onclick="sendvar();">Click me</button> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:23:28.830

`window.a`等于`undefined`没有引号。`typeof`将等于`"undefined"`引号。

```
 if(typeof a === 'undefined'){
        window.a = 0;
    }
    if(typeof b === 'undefined'){
        window.b = 0;
    }
    if(typeof c === 'undefined'){
        window.c = 0;
    }
    if(typeof d === 'undefined'){
        window.d = 0;
    } 
```

# php - 需要帮助找出 MySQL 查询以计算某个数字

> ID：14088443
> 
> 赞同：0
> 
> 时间：2012-12-30T05:02:30.033
> 
> 标签：php, mysql, sql, count

我有一个这样的表设置：

```
fruit1 | fruit2 | fruit3 | fruit4 | number1 | number2 | number3 | number4
--------------------------------------------------------------------------
apple  | orange | banana |  berry |    5    |    2    |    1    |    4   
orange | banana | apple  |  berry |    3    |    2    |    5    |    2
berry  | banana | orange |  apple |    1    |    2    |    5    |    2 
```

我需要一个 MySQL 查询来计算给定水果是 5 的次数。在这个例子中，苹果是 5 两次，橙子是 5 一次。那有意义吗？fruit1 的编号是 number1，fruit2 的编号是 number2，以此类推...

我可以用一些 php 代码来做到这一点，但我知道这是一个非常简单的 MySQL 查询。我只是最难将查询放在一起。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:06:16.877

```
SELECT fruit, COUNT(*) NumberOfInstance
FROM
(
    SELECT fruit1 fruit, number1 num FROM table1
    UNION ALL
    SELECT fruit2 fruit, number2 num FROM table1
    UNION ALL
    SELECT fruit3 fruit, number3 num FROM table1
    UNION ALL
    SELECT fruit4 fruit, number4 num FROM table1
) s
WHERE num = 5
GROUP BY fruit 
```

*   [SQLFiddle 演示链接](http://sqlfiddle.com/#!2/3fa84/3)

# css - 影响嵌套变量的参数混合值（不）

> ID：14088445
> 
> 赞同：0
> 
> 时间：2012-12-30T05:02:56.447
> 
> 标签：css, grid, sass, mixins

我试图允许列中的元素是行中唯一或第一项（给它适当的边距）的情况，并添加了 .first、.only 和 .firstOnly 类。有没有办法合并参数混合中提供的值来定义（或更改）变量？

```
$colCount: 2;
$colSpan: 1;
$gutter: 4%;

$width: $colSpan * ((100% - $gutter) / $colCount);

@mixin width($colCount: 2, $colSpan: 1, $gutter: 4%) {
    $width: $colSpan * ((100% - $gutter) / $colCount);
}

@mixin columns($colCount: 2, $colSpan: 1, $gutter: 4%) { 
    @content;
    @include width() {
        width: $width;
    }

    &.first {
        @include first();
    }

    &.only {
        @include only();
    }

    &.firstOnly {
        @include firstOnly();
    }
}

@mixin first($colCount: 2, $colSpan: 1, $gutter: 4%) {
    margin-left: 100% - $width;
}

@mixin only($colCount: 2, $colSpan: 1, $gutter: 4%) {
    margin-left: 100% - (2 * $width) - (2 * $gutter);
}

@mixin firstOnly($colCount: 2, $colSpan: 1, $gutter: 4%) {
    margin-left: 100% - $width - $gutter;
    margin-right: 100% - $width;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T12:53:16.457

你有很多事情发生在这里并不完全正确。

```
// If this is part of a reusable library, use the default flag
// I typically prefer prefixing global variables to avoid collisions with other code
// (eg. $grid-colCount instead of $colCount)
$colCount: 2 !default;
$colSpan: 1 !default;
$gutter: 4% !default;

// Mixin changed to a function, better for its intended purpose
@function width($colCount: $colCount, $colSpan: $colSpan, $gutter: $gutter) {
    @return $colSpan * ((100% - $gutter) / $colCount);
}

// The arguments are set to our global variables by default
@mixin columns($colCount: $colCount, $colSpan: $colSpan, $gutter: $gutter) { 
    @content;
    // Something weird was going on here that just plain didn't compile
    width: width($colCount, $colSpan, $gutter);

    &.first {
        // This is where your mixin was getting messed up,
        // it wasn't passing the values it received on to the mixins
        @include first($colCount, $colSpan, $gutter);
    }

    &.only {
        @include only($colCount, $colSpan, $gutter);
    }

    &.firstOnly {
        @include firstOnly($colCount, $colSpan, $gutter);
    }
}

@mixin first($colCount: $colCount, $colSpan: $colSpan, $gutter: $gutter) {
    margin-left: 100% - width($colCount, $colSpan, $gutter);
}

@mixin only($colCount: $colCount, $colSpan: $colSpan, $gutter: $gutter) {
    margin-left: 100% - (2 * width($colCount, $colSpan, $gutter)) - (2 * $gutter);
}

@mixin firstOnly($colCount: $colCount, $colSpan: $colSpan, $gutter: $gutter) {
    margin-left: 100% - width($colCount, $colSpan, $gutter) - $gutter;
    margin-right: 100% - width($colCount, $colSpan, $gutter);
} 
```

当我们这样调用 mixin 时：

```
.test {
    @include columns(3, 8, 40%);
}

.test2 {
    @include columns;
} 
```

我们得到这个结果：

```
.test {
  width: 160%;
}

.test.first {
  margin-left: -60%;
}

.test.only {
  margin-left: -300%;
}

.test.firstOnly {
  margin-left: -100%;
  margin-right: -60%;
}

.test2 {
  width: 48%;
}

.test2.first {
  margin-left: 52%;
}

.test2.only {
  margin-left: -4%;
}

.test2.firstOnly {
  margin-left: 48%;
  margin-right: 52%;
} 
```

# linux - En_US 和 en_US 的区别？

> ID：14088448
> 
> 赞同：2
> 
> 时间：2012-12-30T05:03:37.847
> 
> 标签：linux, sorting, lang

今天我在使用 linux sort 命令对文件进行排序时发现了一个问题。当我设置 env LANG=En_US 时，结果就是我所期望的。但是当 LANG=en_US 时，结果很奇怪。我运行的一些命令和输出如下：

```
[work@xx:/data1/muce_temp/datamarts/reduce_result_file/302/1d/201212260000]$ cat dd.dat                 
23 340_guard    16                                                                                                        
23 340_guard    17                                                                                                        
23 340_guard    18                                                                                                        
23 360_guard... 16                                                                                                      
23 360_guard    16                                                                                                        
23 360_guard... 17                                                                                                      
23 360_guard... 18              

[work@xx:/data1/muce_temp/datamarts/reduce_result_file/302/1d/201212260000]$ LANG=En_US sort dd.dat     
23 340_guard    16                                                                                                        
23 340_guard    17                                                                                                        
23 340_guard    18                                                                                                        
23 360_guard    16                                                                                                        
23 360_guard... 16                                                                                                      
23 360_guard... 17                                                                                                      
23 360_guard... 18                                 

[work@xx:/data1/muce_temp/datamarts/reduce_result_file/302/1d/201212260000]$ LANG=en_US sort dd.dat     
23 340_guard    16                                                                                                        
23 340_guard    17                                                                                                        
23 340_guard    18                                                                                                        
23 360_guard... 16                                                                                                      
23 360_guard    16          (why this line appear here ? )                                                                                      
23 360_guard... 17                                                                                                      
23 360_guard... 18 
```

此文件中行的格式详细信息如下：

```
2^E3^F360_guard^E...^I16^Ee^E17/18^I63776769$
2^E3^F360_guard^E^I16^Ee^E17/18^I63776769$
2^E3^F360_guard^E...^I17^Ei^E0^I63776771$
2^E3^F360_guard^E...^I18^Ei^E1^I63776773$ 
```

^E 是 '\x05' ， ^F 是 '\x06' ， ^I 是制表符， $ 是 '\n' 。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:06:45.410

en_US 调用一种更智能的排序算法，该算法会忽略那些点串，就像在排序中通常会忽略它们一样。它显然区分大小写，因此 En_US 正在回退到默认语言（可能是 C）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:13:48.677

“en_US”是“Language=English, locale=United States”的“正确”值。其他语言环境包括“en_GB”（英国）、“en_CA”（加拿大）和 en_AU（澳大利亚）：

*   [http://gcc.gnu.org/onlinedocs/libstdc++/manual/localization.html](http://gcc.gnu.org/onlinedocs/libstdc++/manual/localization.html)

*   [http://computing.fnal.gov/unix-users/tips/Lang_Tips.html](http://computing.fnal.gov/unix-users/tips/Lang_Tips.html)

我得到这些结果：

```
echo $LANG;sort tmp.txt
en_US.UTF-8
23 340_guard    16
23 340_guard    17
23 340_guard    18
23 360_guard    16
23 360_guard... 16
23 360_guard... 17
23 360_guard... 18

export LANG=en_US;echo $LANG;sort tmp.txt
en_US
23 340_guard    16
23 340_guard    17
23 340_guard    18
23 360_guard    16
23 360_guard... 16
23 360_guard... 17
23 360_guard... 18

export LANG=En_US;echo $LANG;sort tmp.txt
En_US
23 340_guard    16
23 340_guard    17
23 340_guard    18
23 360_guard    16
23 360_guard... 16
23 360_guard... 17
23 360_guard... 18

 export LANG=abc-silly;echo $LANG;sort tmp.txt
abc-silly
23 340_guard    16
23 340_guard    17
23 340_guard    18
23 360_guard    16
23 360_guard... 16
23 360_guard... 17
23 360_guard... 18 
```

# c# - SharpGL - 进入活动渲染循环

> ID：14088455
> 
> 赞同：0
> 
> 时间：2012-12-30T05:04:54.390
> 
> 标签：c#, opengl, rendering

我已经成功地设置了我的框架，并将我的方法`OpenGLControl`委托给它的事件。但是，我想做游戏编程，所以我想进入一个活跃的渲染循环，我会从另一个线程更新游戏状态和渲染，但不知道该怎么做。`render``OpenGLDraw`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T02:50:46.713

不是肯定的，但是如果它与大多数其他系统一样工作，您将需要确保所有 OpenGL 调用都来自线程，除此之外，您可以放置​​您的逻辑，而其他一切都是卑鄙的，无论您想要哪个线程。希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T03:29:11.323

通过不调用`Application.Run`而是使用`P/Invoke`创建`C++`样式化的`MessagePump`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T16:49:09.370

您是否尝试过使用 Winforms`Application.Idle`事件？

示例（假设您有一个标准的静态类程序）：

在主要 -`Application.Idle += Tick`

```
static void Tick(object sender, EventArgs e)
{
    //Insert rendering/updating code here
} 
```

# html - 表单代码：如何获取文本框旁边的提交按钮

> ID：14088456
> 
> 赞同：1
> 
> 时间：2012-12-30T05:05:13.433
> 
> 标签：html, css, forms

我只是想不出在此页面循环顶部找到的表单的文本框右侧的“提交”按钮：[http](http://www.babysavers.com) ://www.babysavers.com 。

我正在使用的代码在这里：

```
<center>
<div style="width: 625px; height: 70px;  border-style: dotted; border-color: #d7345a; border-width: 1px; padding: 5px;">
<form action="http://www.feedblitz.com/f/f.fbz?AddNewUserDirect&amp;ajax=4" method="POST" name="FeedBlitz_9fe455b8521611e29f67003005ce8903">
<h3>Join over 8,900 subscribers! Enter your email below for FREE Updates:</h3>
<input style="display:none" type="text" name="EMAIL" value="" maxlength="64"  size="65">
<input type="hidden" name="EMAIL_" value="" maxlength="64" /> 
<input type="hidden" name="EMAIL_ADDRESS" value="" maxlength="64" /> 
<input type="hidden" name="FEEDID" value="873069" /> <input type="hidden" name="cids" value="1" /> 
<input type="hidden" name="PUBLISHER" value="24085942" />
<input onclick="FeedBlitz_9fe455b8521611e29f67003005ce8903s(this.form);" type="button" value="Subscribe!" />
</form></div><script type="text/javascript" language="Javascript">// < ![CDATA[
// < ![CDATA[
// < ![CDATA[
// < ![CDATA[
function FeedBlitz_9fe455b8521611e29f67003005ce8903i(){var x=document.getElementsByName('FeedBlitz_9fe455b8521611e29f67003005ce8903');for(i=0;i<x .length;i++){x[i].EMAIL.style.display='block';
x[i].action='http://www.feedblitz.com/f/f.fbz?AddNewUserDirect';}}
function FeedBlitz_9fe455b8521611e29f67003005ce8903s(v){v.submit();}FeedBlitz_9fe455b8521611e29f67003005ce8903i();
// ]]></script><br></center> 
```

我知道我的代码很草率，但我要做的就是将提交按钮排成一行，使其位于文本框的右侧，而不是在其下方。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T05:12:33.307

将显示设置为内联而不是无：

```
style="display: inline;" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T05:09:46.117

试试这个改变（显示：内联）：

```
<input type="text" size="65" maxlength="64" value="" name="EMAIL" style="display: inline;"> 
```

# jquery - 如何从 $.get jquery 创建一个变量

> ID：14088457
> 
> 赞同：1
> 
> 时间：2012-12-30T05:05:21.550
> 
> 标签：jquery

我对 jquery 很陌生，遇到了一个小故障。基本上，我有一个非常基本的查询脚本，它访问 php 文件以返回日历上日期检查器的数组。

我在那里有警报，它告诉我数组正在正确发送，但我无法让 availableDates 变量对其进行操作。

这是jquery脚本

```
$.get("sql.php",function(data,status)

{
/* alert("Data: " + data + "\nStatus: " + status); */
result = data;
return result;
});

var unavailableDates = result; /*result is an array. In this format it works, var unavailableDates = ["1-1-2013"]; */ 
```

这是它正在访问的基本 php 脚本：

```
<?

$row[0] = "01-01-2013";
$row[1] = "02-01-2013";
$row[2] = "03-01-2013";

echo $row;

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T05:08:12.277

### AJAX 是异步的。

这意味着您不能从使用`$.get()`or`$.post()`等​​的函数返回任何内容。相反，请执行以下操作：

```
$.get("sql.php",function(data,status)
{
    /* alert("Data: " + data + "\nStatus: " + status); */
    result = data;
    var unavailableDates = result;
}); 
```

并在功能`$.ajaxComplete`上，给工作使用`unavailableDates`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T05:07:51.060

`$.get`是异步的。代码行：

```
var unavailableDates = result; 
```

将在`get`完成之前执行并运行回调。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T05:30:25.270

其他人已经注意到您的 JS 中的异步问题，但 php 的输出也需要是 JSON，以便将数组从服务器发送到客户端。

```
echo json_encode( $row); 
```

添加`dataType`参数，`$.get`以便 jQuery 知道将数据解析为 JSON。

```
$.get("sql.php",function(data,status){
    /* consume array here since AJAX is asychronous*/
     $.each(data, function(i, item){
          doSomething( item);
     })
},'json'); 
```

编辑：也可以使用已经`$.getJSON()`包含数据类型的快捷方法`json`

# java - 类型 java.lang.String 无法转换为 JSONObject

> ID：14088459
> 
> 赞同：0
> 
> 时间：2012-12-30T05:05:35.133
> 
> 标签：java, android, json

我有一个 java 字符串变量*newTempTT*，它包含以下内容：

```
myObject = {"VehicleID":"KL-9876","VehicleType":"Nissan","VehicleOwner":"Sanjiva"} 
```

我想将它添加到一个 json 对象中，所以我执行了以下代码行：

```
JSONObject jObject = new JSONObject(newTempTT); 
```

没有错误消息，但是当我运行程序时它说

“java.lang.String 类型的不能转换为 JSONObject”

为了将此字符串转换为 JSONObject，我需要进行哪些更改。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:10:47.900

从javadoc：

```
 Parameters: source - `A string beginning with { (left brace) and ending with } (right brace).` 
    Throws:
    JSONException - If there is a syntax error in the source string or a duplicated key. 
```

检查您当前是否正在关注此内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T05:16:04.763

您似乎正在自己将事物编码为 JSON。不要这样做，让图书馆为你做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T05:13:38.227

在每个双引号中包含这样的转义字符。

```
 String newTempTT = "myObject = {\"VehicleID\":\"KL-9876\",\"VehicleType\":\"Nissan\",\"VehicleOwner\":\"Sanjiva\"}";

JSONObject jObject = new JSONObject(newTempTT); 
```

# mysql - 根据表 2 中是否存在相同数据以及按年和月分组汇总，统计表 1 中数据的出现次数

> ID：14088466
> 
> 赞同：0
> 
> 时间：2012-12-30T05:06:52.760
> 
> 标签：mysql, group-by, pivot

**第 1 步**`t1`- 将所有存在的行（即`field1`不为空）计数为`Count1`并按年和月分组。

```
SELECT
  Year(t1.date) AS Year,
  Month(t1.date) AS Month,
  Count(t1.field1) As Count1,
FROM t1
GROUP BY Year(t1.date), Month(t1.date) 
```

**第 2 步**`t1`- 计算值**不**`t1.field1`为的所有行，并按年和月分组。 **`t2.field1``Count2`**

 **```
SELECT
  Year(t1.date),
  Month(t1.date),
  Count(*) t1.field1 AS Count2,
  FROM t1 LEFT JOIN t2 ON t1.field1 = t2.field1
  WHERE ISNULL t2.field1
GROUP BY Year(t1.date), Month(t2.date) 
```

**第 3 步**- 在表格中显示上述两个计数的结果，其中包含`Year(t1.date)`行标题和`Month(t1.date)`列标题，每个月的结果`Count1`和`Count2`嵌套在每个月的下方。

我没有任何代码可以显示第 3 步，因为我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:20:55.733

试试这个。

> SELECT
>       STEP1.Total_Rows_S1, STEP1.Year_S1, STEP1.Month_S1, COUNT(*) as Remaining_Rows
> FROM (
>             SELECT
>             Year(t1.date) AS Year_S1,
>             Month(t1.date) AS Month_S1,
>             Count(t1.field1) As Total_Rows_S1,
>             t1 .field1 AS FS1
>             FROM t1
>             GROUP BY Year(t1.date), Month(t1.date)
> ) AS STEP1 LEFT JOIN t2 ON (STEP1.FS1 = t2.field1)
> WHERE ISNULL t2.field1
> GROUP BY STEP1.Year_S1, Month( t2.日期）**

# ruby-on-rails - 错误处理多模型表单

> ID：14088468
> 
> 赞同：0
> 
> 时间：2012-12-30T05:07:13.100
> 
> 标签：ruby-on-rails, error-handling, multi-model-forms

我有一个多模型表单，我似乎无法捕获与嵌套模型相关的错误。这是 Project->Team->Roles->Role_skill_relationship 形式的层次结构。我能够捕获与项目模型实例 @project 相关的错误，但我未能成功捕获与角色和技能模型相关的验证。错误直接在浏览器页面中返回，而不是重定向并闪烁到屏幕上。如果我故意错误地填写表格的角色部分，则错误的一个示例是

> 角色中的 NoMethodError#create
> 
> 显示 C:/Users/Dstile/Documents/GitHub/creunity_app/app/views/skills/_form.html.erb 其中第 8 行提出：
> 
> nil:NilClass 的未定义方法 `map' 提取的源代码（第 8 行附近）
> 
> 7: <%= Skill_form.label :skill %>
> 8: <%= Skill_form.collection_select :skill_id, @skills, :id, :name, :prompt => "选择一个>技能" %>

这是代码的一部分

```
<%= render 'shared/project_error_messages' %>

    <%= project_form.label :title %>
    <%= project_form.text_field :title %>

    <%= project_form.label :category, "Category" %>
    <%= project_form.select(:category, Project::CATEGORY_TYPES) %>

    <%= project_form.label :description %>
    <%= project_form.text_area :description %>

    <%= project_form.label :goal_1, "Goal 1:" %>
    <%= project_form.text_field :goal_1 %>

    <h2>Your Team</h2>
    <%= project_form.fields_for :team do |f| %>
      <%= render 'teams/form', :team_form => f %>
    <% end %>` 
```

这是错误渲染代码

```
'<% if @project.errors.any? %>
  <div id="error_explanation">
    <div class="alert alert-error">
      The form contains <%= pluralize(@project.errors.count, "error") %>.
    </div>
    <ul>
    <% @project.errors.full_messages.each do |msg| %>
      <li>* <%= msg %></li>
    <% end %>
    </ul>
  </div>
<% end %>' 
```

角色表单嵌套在团队表单中，就像团队嵌套在项目中一样。从我读过的所有其他线程中，我的理解是项目及其所有子模型（团队、角色、role_skill_relationships）的错误应该由@parent 对象捕获。

是否有我缺少的配置设置或一段代码应该强制浏览器忽略错误？我的想法是错误可能在@project 中，但是这个过程被中断了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:47:52.227

好像`@skills`没有设置。在传入的集合上`#collection_select`运行（在这种情况下），如果集合是（这是未定义实例变量的默认值），则会显示该错误。`#map``@skills``nil`

请记住，在验证错误的情况下，`#create`控制器中的方法将只是呈现模板 - 它不会*为该*模板运行相应的操作方法。因此，如果您`@skills`在您的`#new`操作中定义，那么您还需要在您的`#create`操作中定义它（或者，更好的是，在 a 中`before_filter`）。

# c# - Azure 移动服务查询不返回所有行

> ID：14088469
> 
> 赞同：6
> 
> 时间：2012-12-30T05:07:13.667
> 
> 标签：c#, windows-phone-8, azure-mobile-services

我的 Azure 移动服务中有一个名为 NameTable 的表。当我在我的客户端应用程序（使用移动服务 SDK 的 WP8 应用程序）中进行以下提到的调用时：

```
var myTable = GetZumoService().GetTable<NameTable>();
var myList = await myTable.Where(nameInfo => nameInfo.IsTaken == false).ToListAsync(); 
```

myList 始终只包含 50 个项目，尽管我知道表中有超过 400 行与查询条件匹配。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-30T16:35:00.213

默认情况下，该服务只会在每个读取操作中返回一定数量的行（如您所见，为 50）。由于 Azure 服务在免费时（以及付费服务的成本）有返回字节数的配额，因此移动服务具有此默认值。

您可以使用操作请求更多行`Take`。但是，您可以在任何给定时间询问的行数是有限制的（即 1000）。这个想法是您不应该要求表中的所有数据 - 它可能很多 - 并且在需要时使用`Skip`and`Take`操作来要求行。

```
var myTable = GetZumoService().GetTable<NameTable>();
var myList = await myTable.Take(500)
                          .Where(nameInfo => nameInfo.IsTaken == false)
                          .ToListAsync(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-01-23T19:22:20.173

我发现这还不够。您需要使用以下`[EnableQuery]`属性装饰您的 Azure 移动服务控制器方法：

```
[EnableQuery(PageSize=1000)]
public IQueryable<MyDataTable> GetOneThousandRecords()
{
    return Query()
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-17T09:09:33.920

由于服务器端的行为，我不得不在简单的表格中更改我的脚本，如下所示：[MSDN 论坛](https://social.msdn.microsoft.com/Forums/en-US/0782789b-1d58-4236-b3cb-0c9e4b33db35/ignore-paging-limit-for-azure-mobile-service-in-a-universal-app-uwp)

> 使用应用服务编辑器，编辑 tableName.js 文件（在表目录中，将 tableName 替换为您的表名），然后设置：table.maxTop = 1000 您还可以设置 table.pageSize = 1000 以设置默认页面大小。

设置 table.pageSize = 1000; 为我工作。

# java - 关于允许用户画线的 Java 挑战

> ID：14088470
> 
> 赞同：0
> 
> 时间：2012-12-30T05:07:46.943
> 
> 标签：java, graphics, drawing, awt, mouseevent

我的问题已经在[java draw line as the mouse is](https://stackoverflow.com/questions/9711938/java-draw-line-as-the-mouse-is-moved)中提到过，但是，我还没有深入到本书中，无法涵盖 JPanels、JFrames 和 Points，正如之前提出这个问题的程序员所说的那样。

回答这个问题肯定会帮助大多数初学者更好地理解图形类和绘图，这是一个通常复杂的过程，尤其是对于初学者。

根据我正在使用的文本（因为我正在自己学习 Java），这是如何使用 Java 画线的示例：

```
/*
 * LineTest
 * Demonstrates drawing lines
 */
import java.awt.*;
public class LineTest extends Canvas {
public LineTest() {
super();
setSize(300, 200);
setBackground(Color.white);
}
public static void main(String args[]) {
LineTest lt = new LineTest();
GUIFrame frame = new GUIFrame("Line Test");
frame.add(lt);
frame.pack();
frame.setVisible(true);
}
public void paint(Graphics g) {
g.drawLine(10, 10, 50, 100);
g.setColor(Color.blue);
g.drawLine(60, 110, 275, 50);
g.setColor(Color.red);
g.drawLine(50, 50, 300, 200);
}
} 
```

规范是：

> 创建一个允许您通过单击初始点并将鼠标拖动到第二个点来绘制线条的应用程序。应重新绘制应用程序，以便在拖动鼠标时可以看到线条的大小和位置发生变化。释放鼠标按钮时，将绘制线条。

正如您将认识到的，运行此程序不会由用户创建任何图形。我相信由于第 21 行遇到此错误：`g.drawLine(x, y, x2, y2);`不正确，因为这是定义线条绘制的语句。

任何帮助是极大的赞赏。预先感谢您在此问题上的所有时间和合作。

我回答这个问题的代码是：

```
import java.awt.*;
import java.awt.event.*;

public class LineDrawer extends Canvas
                        implements MouseListener, MouseMotionListener {
int x, y, x2, y2;

public LineDrawer() {
    super();
    setSize(300, 200);
    setBackground(Color.white);
}
public void mouseClicked(MouseEvent me) {
                int x = me.getX();
                int y = me.getY();
                int x2 = me.getX();
                int y2 = me.getY();

    }
public void paint(Graphics g) {
            g.drawLine(x, y, x2, y2);
            g.setColor(Color.blue);
    }

    public void mousePressed(MouseEvent me) {
        repaint();
    }

    public void mouseDragged(MouseEvent me) {
    }
    public void mouseExited(MouseEvent me) {
    }
    public void mouseEntered(MouseEvent me) {
    }

    public void mouseReleased(MouseEvent me) {
    }
    public void mouseMoved(MouseEvent me) {
    }

    public static void main(String args[]) {
        LineDrawer ld = new LineDrawer();
        GUIFrame frame = new GUIFrame("Line Drawer");
        frame.add(ld);
        frame.pack();
        frame.setVisible(true);
    }

} 
```

PS：我一直犹豫寻求帮助，因为我担心其他程序员会用我还没有学过的方法来回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:21:20.787

```
int x1, y1, x2, y2; 
```

```
public void mousePressed(MouseEvent e){
    x1 = e.getX();
    y1 = e.getY();
} 
```

```
public void mouseDragged(MouseEvent e){
    x2 = e.getX();
    y2 = e.getY();
    // Now Paint the line
    repaint();
} 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:29:17.033

让我们从

```
public void mouseClicked(MouseEvent me) {
    int x = me.getX();
    int y = me.getY();
    int x2 = me.getX();
    int y2 = me.getY();
} 
```

您之前已声明`x`、和`y`，但在此方法中，您已用新的减速覆盖了这些减速，这意味着将不会使用先前声明的变量并且将忽略事件参数。`x2``y2`

`mouseClicked``mousePressed`在一个和事件之后触发`mouseReleased`，这意味着这实际上是在用户释放鼠标按钮时。

*Extreme Coder 指出`MouseClicked`只有在同时按下和释放鼠标按钮时才会触发，即不涉及拖动 - 它仍然不是正确的使用方法，但澄清很好*

你应该做的是...

`mousePressed`存储点击的`x`,`y`位置，`mouseReleased`存储`x2`,`y2`位置。

在`mouseDragged`事件中，您应该更新`x2`,`y2`值并调用`repaint`

```
public void mousePressed(MouseEvent me) {
    // Mouse is down, but hasn't yet being released...
    x = me.getX();
    y = me.getY();
    // We need to "override" any previous values...
    x2 = x;
    y2 = y;
    repaint();
}

public void mouseDragged(MouseEvent me) {
    x2 = me.getX();
    y2 = me.getY();
    repaint();
}

public void mouseReleased(MouseEvent me) {
    // Here I would store the points so I could re-draw each new line...
} 
```

而不是使用`x`, `y`, `x2`and `y2`，使用两个数组可能会更好，即

```
private int[] startPoint;
private int[] endPoint; 
```

然后你可以做类似的事情......

```
public void mousePressed(MouseEvent me) {
    // Mouse is down, but hasn't yet being released...
    startPoint = new int[2];
    startPoint[0] = me.getX();
    startPoint[1] = me.getY();
    endPoint = startPoint;
    repaint();
}
public void mouseDragged(MouseEvent me) {
    endPoint = new int[2];
    endPoint[0] = me.getX();
    endPoint[1] = me.getY();
    repaint();
} 
```

现在我更喜欢`paintComponent`from `JComponent`，但我现在会坚持你的例子..

```
public void paint(Graphics g) {
    super.paint(g); // This is super important...
    if (startPoint != null && endPoint != null && startPoint.length == 2 && endPoint.length == 2) {
        g.drawLine(startPoint[0], startPoint[1], endPoint[0], endPoint[1]);
    }
} 
```

**额外的**

这有点令人担忧...

```
public void paint(Graphics g) {
    g.drawLine(x, y, x2, y2);
    g.setColor(Color.blue);
} 
```

操作顺序非常重要。在您绘制线条之后设置颜色对您的绘制操作没有影响（但可能会影响您之后发生的绘制操作）。

另外，你必须打电话`super.paint(g)`- 这非常重要......

**例子**

一个“基本”示例，使用`int[]`数组进行点存储......

```
public class BasicLineDraw {

    public static void main(String[] args) {
        new BasicLineDraw();
    }

    public BasicLineDraw() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new DrawLinePane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class DrawLinePane extends JPanel {

        private int[] startPoint;
        private int[] endPoint;
        private List<int[][]> lines;

        public DrawLinePane() {

            lines = new ArrayList<int[][]>(25);

            MouseAdapter handler = new MouseAdapter() {
                @Override
                public void mousePressed(MouseEvent e) {
                    startPoint = new int[]{e.getX(), e.getY()};
                    endPoint = startPoint;
                    repaint();
                }

                @Override
                public void mouseDragged(MouseEvent e) {
                    endPoint = new int[]{e.getX(), e.getY()};
                    repaint();
                }

                @Override
                public void mouseReleased(MouseEvent e) {
                    if (startPoint != null && endPoint != null && startPoint.length == 2 && endPoint.length == 2) {
                        lines.add(new int[][]{startPoint, endPoint});
                    }
                    startPoint = null;
                    endPoint = null;
                    repaint();
                }
            };

            addMouseListener(handler);
            addMouseMotionListener(handler);

        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            Graphics2D g2d = (Graphics2D) g.create();
            if (startPoint != null && endPoint != null && startPoint.length == 2 && endPoint.length == 2) {

                g2d.setColor(Color.RED);
                g2d.drawLine(startPoint[0], startPoint[1], endPoint[0], endPoint[1]);

            }

            g2d.setColor(Color.BLUE);
            for (int[][] line : lines) {
                g2d.drawLine(line[0][0], line[0][1], line[1][0], line[1][1]);
            }

            g2d.dispose();

        }
    }
} 
```

还有一个更高级的例子，使用`Point`Java 的[2D Graphics API](http://docs.oracle.com/javase/tutorial/2d/index.html)

```
public class LineDrawer {

    public static void main(String[] args) {
        new LineDrawer();
    }

    public LineDrawer() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new DrawLinePane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class DrawLinePane extends JPanel {

        private Point anchor;
        private Point lead;

        private List<Line2D> lines;

        public DrawLinePane() {

            lines = new ArrayList<Line2D>(25);

            MouseAdapter handler = new MouseAdapter() {

                @Override
                public void mousePressed(MouseEvent e) {
                    lead = null;
                    anchor = e.getPoint();
                    repaint();
                }

                @Override
                public void mouseDragged(MouseEvent e) {
                    lead = e.getPoint();
                    repaint();
                }

                @Override
                public void mouseReleased(MouseEvent e) {
                    if (lead != null && anchor != null && !anchor.equals(lead)) {
                        lines.add(new Line2D.Float(anchor, lead));
                    }
                    repaint();
                }

            };

            addMouseListener(handler);
            addMouseMotionListener(handler);

        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g); 

            Graphics2D g2d = (Graphics2D) g.create();
            g2d.setColor(Color.RED);
            if (lead != null && anchor != null) {

                Composite composite = g2d.getComposite();
                g2d.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, 0.25f));
                g2d.draw(new Line2D.Float(anchor, lead));
                g2d.setComposite(composite);

            }

            for (Line2D line : lines) {
                g2d.draw(line);
            }

            g2d.dispose();

        }

    }

} 
```

# objective-c - 自动引用计数 - 发送到已释放实例的消息

> ID：14088477
> 
> 赞同：0
> 
> 时间：2012-12-30T05:09:46.130
> 
> 标签：objective-c, ios, automatic-ref-counting

我创建了一个充当其他几个类的代表的类。不过有问题。**ARC 过早地释放了这个类**，当一个委托消息发送给它时，程序崩溃了。我不明白为什么...我将课程设置为强。如何保证这个类不被释放？

视图控制器.h

```
Class *__strong class; 
```

* * *

视图控制器.m

```
class = [[Class alloc] init...]; 
```

* * *

类.m

```
-(id)init {

    self = [super init];

    Object *object = [[Object alloc] init...];
    object.delegate = self;

    return self;

} 
```

* * *

日志

```
-[Object respondsToSelector:]: message sent to deallocated instance 0x11453f40 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:23:10.657

局部变量在函数退出时被释放，无论您决定附加多少内存限定符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T08:12:59.317

你有你的答案，但我想我会用我自己的一点小费来插话。我总是从 dealloc 的通知中心删除我的课程。

```
-(void) dealloc{
    [[NSNotificationCenter defaultCenter] removeObserver:self];
} 
```

这对某些人来说可能有点矫枉过正，但我​​非常依赖通知模式来实现尽可能少的耦合。由于通知的异步特性与 ARC 相结合，这几乎是必需的。

# c# - 如果仅删除一条边，则 Dijkstra Shortest-Paths 快速重新计算

> ID：14088483
> 
> 赞同：4
> 
> 时间：2012-12-30T05:11:46.567
> 
> 标签：c#, shortest-path, dijkstra

我正在尝试计算最短路径。这确实适用于下面粘贴的 Dijkstra 实现。但是我想加快速度。

我使用这个实现来决定接下来我想去哪个领域。该图表示一个二维数组，其中所有字段都连接到每个邻居。但随着时间的推移，会发生以下情况：我需要移除一些边缘（有障碍物）。起始节点是我当前的位置，它也会随着时间而改变。

这表示：

*   我从不添加节点，从不添加新边，从不更改边的权重。唯一的操作是删除边缘

*   起始节点确实会随着时间而改变

问题：

*   当我知道图中唯一的变化是删除一条边时，是否有一种算法可以快速重新计算最短路径？

*   当起始节点仅更改为它的一个邻居时，是否有一种算法允许我快速重新计算最短路径？

*   另一种算法可能更适合我的问题吗？

谢谢你的帮助

```
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Text;

public class Dijkstra<T>
{
    private Node<T> calculatedStart;

    private ReadOnlyCollection<Node<T>> Nodes {
        get ;
        set ;
    }

    private ReadOnlyCollection<Edge<T>> Edges {
        get;
        set;
    }

    private List<Node<T>> NodesToInspect {
        get;
        set ;
    }

    private Dictionary<Node<T>, int> Distance {
        get ;
        set ;
    }

    private Dictionary<Node<T>, Node<T>> PreviousNode {
        get;
        set ;
    }

    public Dijkstra (ReadOnlyCollection<Edge<T>> edges, ReadOnlyCollection<Node<T>> nodes)
    {
        Edges = edges;
        Nodes = nodes;
        NodesToInspect = new List<Node<T>> ();
        Distance = new Dictionary<Node<T>, int> ();
        PreviousNode = new Dictionary<Node<T>, Node<T>> ();

        foreach (Node<T> n in Nodes) {
            PreviousNode.Add (n, null);
            NodesToInspect.Add (n);
            Distance.Add (n, int.MaxValue);
        }
    }

    public LinkedList<T> GetPath (T start, T destination)
    {
        Node<T> startNode = new Node<T> (start);
        Node<T> destinationNode = new Node<T> (destination);

        CalculateAllShortestDistances (startNode);

        // building path going back from the destination to the start always taking the nearest node
        LinkedList<T> path = new LinkedList<T> ();
        path.AddFirst (destinationNode.Value);

        while (PreviousNode[destinationNode] != null) {
            destinationNode = PreviousNode [destinationNode];
            path.AddFirst (destinationNode.Value);
        }

        path.RemoveFirst ();

        return path;
    }

    private void CalculateAllShortestDistances (Node<T> startNode)
    {
        if (startNode.Value.Equals (calculatedStart)) {
            return;
        }

        Distance [startNode] = 0;

        while (NodesToInspect.Count > 0) {
            Node<T> nearestNode = GetNodeWithSmallestDistance ();
            // if we cannot find another node with the function above we can exit the algorithm and clear the
            // nodes to inspect because they would not be reachable from the start or will not be able to shorten the paths...
            // this algorithm does also implicitly kind of calculate the minimum spanning tree...
            if (nearestNode == null) {
                NodesToInspect.Clear ();
            } else {
                foreach (Node<T> neighbour in GetNeighborsFromNodesToInspect(nearestNode)) {
                    // calculate distance with the currently inspected neighbour
                    int dist = Distance [nearestNode] + GetDirectDistanceBetween (nearestNode, neighbour);

                    // set the neighbour as shortest if it is better than the current shortest distance
                    if (dist < Distance [neighbour]) {
                        Distance [neighbour] = dist;
                        PreviousNode [neighbour] = nearestNode;
                    }
                }
                NodesToInspect.Remove (nearestNode);
            }
        }

        calculatedStart = startNode;
    }

    private Node<T> GetNodeWithSmallestDistance ()
    {
        int distance = int.MaxValue;
        Node<T> smallest = null;

        foreach (Node<T> inspectedNode in NodesToInspect) {
            if (Distance [inspectedNode] < distance) {
                distance = Distance [inspectedNode];
                smallest = inspectedNode;
            }
        }

        return smallest;
    }

    private List<Node<T>> GetNeighborsFromNodesToInspect (Node<T> n)
    {
        List<Node<T>> neighbors = new List<Node<T>> ();

        foreach (Edge<T> e in Edges) {
            if (e.Start.Equals (n) && NodesToInspect.Contains (n)) {
                neighbors.Add (e.End);
            }
        }

        return neighbors;
    }

    private int GetDirectDistanceBetween (Node<T> startNode, Node<T> endNode)
    {
        foreach (Edge<T> e in Edges) {
            if (e.Start.Equals (startNode) && e.End.Equals (endNode)) {
                return e.Distance;
            }
        }

        return int.MaxValue;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T19:18:35.997

> 当我知道图中唯一的变化是删除一条边时，是否有一种算法可以快速重新计算最短路径？
> 
> 当起始节点仅更改为它的一个邻居时，是否有一种算法允许我快速重新计算最短路径？

这两个问题的答案都是肯定的。

* * *

对于第一种情况，您正在寻找的算法称为[LPA*](http://idm-lab.org/bib/abstracts/papers/nips2001.pdf) *（有时，不太常见，称为增量 A*。该论文上的标题已过时）*。这是对 A* 的*（相当复杂的）*修改，当只有少数边发生变化时，它允许快速重新计算最佳路径。

与 A* 一样，LPA* 需要[允许的距离启发式](http://en.wikipedia.org/wiki/Admissible_heuristic)。如果不存在这样的启发式，您可以将其设置为 0。在 A* 中执行此操作实际上会将其变成 Djikstra 算法；在 LPA* 中执行此操作会将其变成一种名为[DynamicSWSF-SP](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.45.1855&rep=rep1&type=pdf)的晦涩、很少使用的算法。

* * *

对于第二种情况，您正在寻找[D*-Lite](http://idm-lab.org/bib/abstracts/papers/aaai02b.pdf)。这是对 LPA* 的一个非常简单的修改*（很简单，至少，一旦你理解了 LPA*）*，它会随着单元从开始到结束移动并获得新信息*（添加/删除/更改边缘*）进行增量寻路。它主要用于穿越未知或部分已知地形的机器人。

* * *

我在[这里](https://cstheory.stackexchange.com/questions/11855/how-do-the-state-of-the-art-pathfinding-algorithms-for-changing-graphs-d-d-l/11866#11866)写了一个关于各种寻路算法的相当全面的答案*（带有论文的链接，在问题中）*。

# c - 为什么这段代码会阻止 gcc 和 llvm 进行尾调用优化？

> ID：14088484
> 
> 赞同：7
> 
> 时间：2012-12-30T05:11:47.550
> 
> 标签：c, gcc, llvm, tail-recursion, tail-call-optimization

我已经在 Linux 上的 gcc 4.4.5 和 Mac OSX（Xcode 4.2.1）上的 gcc-llvm 和[这个](http://llvm.org/demo/index.cgi). 下面是相关函数的源码和生成的反汇编。（补充：用 编译`gcc -O2 main.c`）

```
#include <stdio.h>
__attribute__((noinline))
static void g(long num)
{
        long m, n;
        printf("%p %ld\n", &m, n);
        return g(num-1);
}
__attribute__((noinline))
static void h(long num)
{
        long m, n;
        printf("%ld %ld\n", m, n);
        return h(num-1);
}
__attribute__((noinline))
static void f(long * num)
{
        scanf("%ld", num);
        g(*num);
        h(*num);        
        return f(num);
}
int main(void)
{
        printf("int:%lu long:%lu unsigned:%lu\n", sizeof(int), sizeof(long), sizeof(unsigned));
        long num;
        f(&num);                 
        return 0;
} 
```

* * *

```
08048430 <g>:
8048430:    55                   push   %ebp
8048431:    89 e5                mov    %esp,%ebp
8048433:    53                   push   %ebx
8048434:    89 c3                mov    %eax,%ebx
8048436:    83 ec 24             sub    $0x24,%esp
8048439:    8d 45 f4             lea    -0xc(%ebp),%eax
804843c:    c7 44 24 08 00 00 00 movl   $0x0,0x8(%esp)
8048443:    00 
8048444:    89 44 24 04          mov    %eax,0x4(%esp)
8048448:    c7 04 24 d0 85 04 08 movl   $0x80485d0,(%esp)
804844f:    e8 f0 fe ff ff       call   8048344 <printf@plt>
8048454:    8d 43 ff             lea    -0x1(%ebx),%eax
8048457:    e8 d4 ff ff ff       call   8048430 <g>
804845c:    83 c4 24             add    $0x24,%esp
804845f:    5b                   pop    %ebx
8048460:    5d                   pop    %ebp
8048461:    c3                   ret    
8048462:    8d b4 26 00 00 00 00 lea    0x0(%esi,%eiz,1),%esi
8048469:    8d bc 27 00 00 00 00 lea    0x0(%edi,%eiz,1),%edi

08048470 <h>:
8048470:    55                   push   %ebp
8048471:    89 e5                mov    %esp,%ebp
8048473:    83 ec 18             sub    $0x18,%esp
8048476:    66 90                xchg   %ax,%ax
8048478:    c7 44 24 08 00 00 00 movl   $0x0,0x8(%esp)
804847f:    00 
8048480:    c7 44 24 04 00 00 00 movl   $0x0,0x4(%esp)
8048487:    00 
8048488:    c7 04 24 d8 85 04 08 movl   $0x80485d8,(%esp)
804848f:    e8 b0 fe ff ff       call   8048344 <printf@plt>
8048494:    eb e2                jmp    8048478 <h+0x8>
8048496:    8d 76 00             lea    0x0(%esi),%esi
8048499:    8d bc 27 00 00 00 00 lea    0x0(%edi,%eiz,1),%edi

080484a0 <f>:
80484a0:    55                   push   %ebp
80484a1:    89 e5                mov    %esp,%ebp
80484a3:    53                   push   %ebx
80484a4:    89 c3                mov    %eax,%ebx
80484a6:    83 ec 14             sub    $0x14,%esp
80484a9:    8d b4 26 00 00 00 00 lea    0x0(%esi,%eiz,1),%esi
80484b0:    89 5c 24 04          mov    %ebx,0x4(%esp)
80484b4:    c7 04 24 e1 85 04 08 movl   $0x80485e1,(%esp)
80484bb:    e8 94 fe ff ff       call   8048354 <__isoc99_scanf@plt>
80484c0:    8b 03                mov    (%ebx),%eax
80484c2:    e8 69 ff ff ff       call   8048430 <g>
80484c7:    8b 03                mov    (%ebx),%eax
80484c9:    e8 a2 ff ff ff       call   8048470 <h>
80484ce:    eb e0                jmp    80484b0 <f+0x10> 
```

我们可以看到`g()`and`h()`几乎是相同的，除了（以及不相关的and ）`&`的参数旁边的（地址）运算`m`符。然而，尾调用优化而不是。为什么？`printf()``%ld``%p``h()``g()`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T05:20:31.000

在 g() 中，您获取局部变量的地址并将其传递给函数。“足够聪明的编译器”应该意识到 printf 不存储该指针。相反，gcc 和 llvm 假设 printf 可能将指针存储在某处，因此包含 m 的调用帧可能需要在递归中进一步“活动”。因此，没有 TCO。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T05:37:02.957

它是 & 做的。它告诉编译器`m`应该存储在堆栈中。即使它被传递给`printf`，编译器也必须假设它可能被其他人访问，因此必须在调用 之后从堆栈中清除它`g`。

在这种特殊情况下，正如`printf`编译器所知（并且它知道它不保存指针），它可能会被教导执行此优化。

有关这方面的更多信息，请查看“逃避分析”。

# css - 在 IE 的 Twitter Bootstrap 导航栏中替换背景

> ID：14088485
> 
> 赞同：4
> 
> 时间：2012-12-30T05:11:53.747
> 
> 标签：css, internet-explorer, twitter-bootstrap, background-image, navbar

我正在尝试用我自己的图像替换 Twitter Bootstrap 导航栏的背景图像。它适用于 Chrome、Firefox 和 Safari，但不适用于 Internet Explorer。我对 IE 缺少什么？（它在 IE 中仍然是纯黑色）

```
.navbar.navbar-inverse.navbar-fixed-top .navbar-inner {
    background: url(/assets/navbar.png) repeat-x;
    box-shadow: none;
    border: none;
    -webkit-box-shadow: none;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-30T06:23:06.830

你需要添加这个：

```
filter: progid:DXImageTransform.Microsoft.gradient(enabled=false); 
```

# javascript - 在javascript中水平移动对象的算法

> ID：14088489
> 
> 赞同：0
> 
> 时间：2012-12-30T05:12:55.230
> 
> 标签：javascript, processing

我目前正在使用 javascript 和 processing.js 开发游戏，但我在试图弄清楚如何对角移动东西时遇到了麻烦。在这个游戏中，中心有一个物体可以射击周围的其他物体。现在我只能垂直或仅水平移动子弹没有问题，但是我很难为子弹算法实现对角线运动。

在尝试方面，我尝试戴上我的数学思维上限并使用 y=mx+b 公式沿直线运动，但这就是我的代码最终的样子：

```
ellipse(shuriken.xPos, shuriken.yPos, shuriken.width, shuriken.height); //this is what I want to move diagonally

    if(abs(shuriken.slope) > 0.65) {
        if(shuriken.targetY < shuriken.OrigYPos) {
            shuriken.yPos -= 4;
        } else {
            shuriken.yPos += 4;
        }
        shuriken.xPos = (shuriken.yPos - shuriken.intercept)/shuriken.slope;

    } else {
        if(shuriken.targetX < shuriken.OrigXPos) {
            shuriken.xPos -= 4;
        } else {
            shuriken.xPos += 4;
        }
        shuriken.yPos = shuriken.slope * shuriken.xPos + shuriken.intercept;
    } 
```

上面的代码非常糟糕和hacky，因为速度随着线的斜率而变化。

我尝试实现三角关系，但仍然徒劳无功。

任何帮助/建议将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T05:22:25.433

可以这样想：您希望手里剑移动`s`像素。如果运动是水平的，它应该`s`水平移动像素；如果垂直，则垂直`s`像素。但是，如果是其他任何东西，它将是水平/垂直像素的组合。什么是正确的组合？`s`那么，如果你从给定点向任何方向投射距离，你会得到什么形状？没错，一个半径为 的圆`s`。让我们用角度来表示方向，`a`。所以我们有这张图：

[![图片](../Images/e377f1dcaa43fa302c96f65b7f6135a5.png)](https://i.stack.imgur.com/lcmjk.png)

我们如何得到`x`和`y`？如果你注意到，我们有一个三角形。如果你回想一下你的三角函数，这正是正弦、余弦和正切函数的用途。我通过助记符 SOHCHAHTOA 了解了它们的定义。即：Sin (a) = 对边/斜边，Cos(a) = 相邻/斜边，Tan(a) = 对边/相邻。在这种情况下，角的对面`a`是`y`，角的邻接`a`是`x`。因此我们有：

```
cos(a) = x / s
sin(a) = y / s 
```

求解`x`和`y`：

```
x = s * cos(a)
y = s * sin(a) 
```

所以，给定 angle `a`，并且你想移动你的手里剑`s`像素，你想`s * cos(a)`水平和`s * sin(a)`垂直移动它。

请确保您将`a`弧度而不是度数传递给 javascript`Math.sin`和`Math.cos`函数：

```
radians = degrees * pi / 180.0 
```

这可能就是为什么您的三角函数解决方案不起作用的原因，因为这在过去让我很痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T05:28:33.770

如果您知道要移动的角度和速度，则可以将其视为极坐标，然后转换为笛卡尔坐标以获得 x,y 向量，您需要将对象移动到该方向和速度.

如果你不知道角度，你也可以通过 X 和 Y 的差来得出向量（我知道你可以这样做，因为你可以计算两点之间的斜率）。然后取得到的向量并除以向量的长度得到一个单位向量，然后你可以缩放到你的速度来得到一个最终向量，你可以在其中移动你的对象。

（这可能就是 kennypu 坚持使用向量的意思？）

# objective-c - iOS - SQLite 未更新但准备和步骤已成功执行

> ID：14088490
> 
> 赞同：4
> 
> 时间：2012-12-30T05:13:03.670
> 
> 标签：objective-c, ios, sql, sqlite

标题几乎是我拥有的所有信息，因为我找不到代码的问题。下面代码中使用的同一数据库实例能够成功插入、删除和选择，但此功能不起作用。不返回错误码（始终为0），执行此函数后程序继续名义上运行。

这是表信息：

```
reminder (uniqueID integer primary key autoincrement, title text not null, details text, time integer) 
```

有问题的代码：

```
- (void) updateEntryData:(ReminderData *)data
{
    sqlite3_stmt *statement; 
    char *updateCommand = "UPDATE reminder SET title = '?', details = '?', time = ?    WHERE uniqueID = ?";

    int e = sqlite3_prepare_v2(database, updateCommand, -1, &statement, nil);
    if(e != SQLITE_OK) {
        NSLog(@"Problem with updateEntryWithUniqueID");
        NSLog(@"Error Code: %d, message '%s'", e, sqlite3_errmsg(database));
        return;
    }

    sqlite3_bind_text(statement, 1, [data.title UTF8String], -1, SQLITE_TRANSIENT);
    sqlite3_bind_text(statement, 2, [data.details UTF8String], -1, SQLITE_TRANSIENT); 
    sqlite3_bind_int(statement, 3, [data.time timeIntervalSince1970]);
    sqlite3_bind_int(statement, 4, data.uniqueID);
    NSLog(@"\nID: %d\nTitle: %@\nDetails: %@\nTime: %@", data.uniqueID, data.title, data.details, data.time);

    if(sqlite3_step(statement) != SQLITE_DONE) {
        NSLog(@"Problems updating entry in reminder");
    }

    /* Finished */ 
    sqlite3_finalize(statement);
} 
```

任何帮助将不胜感激; 我难住了。

编辑：忘记提及进入sqlite控制台时使用的sql命令有效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T05:14:49.163

只需删除参数周围的单引号即可。包装占位符将使其成为一个值，而不是一个参数。

```
char *updateCommand = "UPDATE reminder SET title = ?, details = ? ....."; 
```

# ios - 在iOS中上传JSON文档时需要检测应用程序何时无法连接到服务器

> ID：14088491
> 
> 赞同：1
> 
> 时间：2012-12-30T05:13:05.977
> 
> 标签：ios, json, plist, nsurlconnection

我正在将我的应用程序中的 JSON 文档上传到网络上的服务器，并且我能够成功地做到这一点。但是，我现在需要做的是检测何时没有 WiFi 或 3G 连接，并通过警报提示用户应用程序无法连接，然后让他们选择将 JSON 文档另存为.plist 文件在本地。

这是我到目前为止的代码：

这是我将 JSON 文档上传到服务器的方法：

```
- (void) sendJsonDoc:(NSString *)jDoc {

    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://myWebsite.php"]];

    [request setHTTPMethod:@"POST"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Content-type"];

    [request setValue:[NSString stringWithFormat:@"%d", [jDoc length]] forHTTPHeaderField:@"Content-length"];

    [request setHTTPBody:[jDoc dataUsingEncoding:NSUTF8StringEncoding]];

    [NSURLConnection connectionWithRequest:request delegate:self];

}

- (void) connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {

    NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;
    int code = [httpResponse statusCode];
    NSLog(@"%d", code);

} 
```

这是我为了将 JSON 文档在本地保存为 plist 文件而拥有的代码：

```
NSString *path = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];
    path = [path stringByAppendingPathComponent:@"jsonDoc.plist"];

    // If the file doesn't exist in the Documents Folder, copy it.
    NSFileManager *fileManager = [NSFileManager defaultManager];

    if (![fileManager fileExistsAtPath:path]) {
        NSString *sourcePath = [[NSBundle mainBundle] pathForResource:@"jsonDoc" ofType:@"plist"];
        [fileManager copyItemAtPath:sourcePath toPath:path error:nil];
    }

    // Load the Property List.
    NSString *loadJSON = [[NSString alloc] initWithContentsOfFile:path encoding:NSUTF8StringEncoding error:nil]; 
```

如何在我的 sendJsonDoc 方法中检测到没有连接并向用户发出警报，提示他们没有连接，以及他们是否想在本地保存文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:19:50.140

查看可达性框架/库。

tonymillion 制作了 Apple 提供的一个很好的版本，它已经适应了 ARC 并增加了对块的支持。github 上的自述文件还解释了如何订阅更改连接的通知 :)

[在这里查看项目](https://github.com/tonymillion/Reachability)

# c# - 如何在winforms中获取facebook访问令牌

> ID：14088493
> 
> 赞同：2
> 
> 时间：2012-12-30T05:13:29.270
> 
> 标签：c#, facebook, winforms, facebook-graph-api, facebook-c#-sdk

我是 facebook c# sdk 的新手，我正在尝试创建一个将发布到页面时间轴的程序。

我一直在尝试遵循[这个](http://codesamplez.com/programming/facebook-api-access-token-using-c-sharp)，但是我很难理解第二个代码片段，因为它使用`Request`了`asp.net`. 我找不到将其转换为 WinForms 的方法。

（我确实必须更改`FacebookAPI`为`FacebookClient`）

我怎样才能达到同样的效果，重定向到 facebook 并接收`code`获取访问令牌？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T07:19:57.277

facebook SDK 有一个特定的 Winforms 示例，此处可用：[Facebook Sample using Facebook C# SDK with WinForms](https://github.com/wpasternak/facebook-winforms-sample)

> 此示例演示如何将 Facebook C# SDK v6 用作 WinForms 示例。
> 
> 注意：此示例不一定展示最佳用途，而是展示在桌面应用程序上使用 Facebook C# SDK 的功能。始终建议使用异步（XAsync 或 XTaskAsync）方法而不是同步方法。XTaskAsync 方法优于 XAsync 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T06:02:28.017

如果您只是发布到自己页面的时间线，最简单的方法可能是使用 New-FBPost cmdlet 的 PowerShell 脚本：http: [//facebookpsmodule.codeplex.com](http://facebookpsmodule.codeplex.com)

# uitextfield - 如何查找给定 returnKeyType 的文本？

> ID：14088499
> 
> 赞同：2
> 
> 时间：2012-12-30T05:15:18.367
> 
> 标签：uitextfield, uikeyboard, uikeyboardtype, uikeyinput

这是一个关于 UITextInputTraits 协议的问题。

在文档的管理键盘行为一节中，可以看到属性：returnKeyType。

它从中获取可能的值：

```
typedef enum {
   UIReturnKeyDefault,
   UIReturnKeyGo,
   UIReturnKeyGoogle,
   UIReturnKeyJoin,
   UIReturnKeyNext,
   UIReturnKeyRoute,
   UIReturnKeySearch,
   UIReturnKeySend,
   UIReturnKeyYahoo,
   UIReturnKeyDone,
   UIReturnKeyEmergencyCall,
} UIReturnKeyType; 
```

我想要的是一种获取属性returnKeyType给定值的匹配文本的方法。

例如，在英语中：

*   如果值为 UIReturnKeyDefault，则文本为“return”；
*   如果值为 UIReturnKeySearch，则文本为“Search”；
*   ……等等……</li>

但是当语言设置不同时，文本会有所不同。无论属性 returnKeyType 的值是什么以及用户的语言设置是什么，我都需要一种方法来找出适当的文本。

提前感谢您提供任何相关提示。

# ruby - 在写入新内容之前清理 ruby 文件

> ID：14088504
> 
> 赞同：3
> 
> 时间：2012-12-30T05:16:45.950
> 
> 标签：ruby

有人可以指导我**在用 Ruby 向文件中写入新信息****之前清理文件中所有现有内容的** 方法吗？我正在使用以下代码编写此文件的内容：

 **```
logfile = File.new(filepath, "w")
logfile.write("my content") 
```

但是，我希望在向其写入新信息之前删除此“日志文件”中的所有现有内容。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-30T14:17:19.020

当打开一个文件进行写入时，即使用“w”选项，文件的所有以前的内容都将被删除，所以你不必明确地做任何事情来达到那个效果。**

# java - 在 2D 六边形网格上查找邻居

> ID：14088508
> 
> 赞同：3
> 
> 时间：2012-12-30T05:17:40.613
> 
> 标签：java

所以我有一个有效的 getNeighbors 函数：

（它的静态基于我的地图有多大，还没有让它成为动态的......虽然这不应该是一个问题）

它的 19x12

> 公共 int[] getNeighbors(int i) {
> 
> ```
>  int[] neighbors = new int[6];
>   if (((i % xlength) % 2) == 0) {
>       neighbors[0] = (i - 19);
>       neighbors[1] = (i - 18);
>       neighbors[2] = (i + 1);
>       neighbors[3] = (i + 19);
>       neighbors[4] = (i - 1);
>       neighbors[5] = (i - 20);
>   } else {
>       neighbors[0] = (i - 19);
>       neighbors[1] = (i + 1);
>       neighbors[2] = (i + 20);
>       neighbors[3] = (i + 19);
>       neighbors[4] = (i + 18);
>       neighbors[5] = (i - 1);
>   } 
> ```
> 
> }

它工作得很好，花花公子，但当我在边缘时挂起。

我不知道我是否应该逐案进行，或者我是否想得太多。现在我有一个自动脚本，用于将点从十六进制随机移动到十六进制，有时它会将其视为圆环网格并跳到另一侧（不是我想要的，但我希望使用当前代码）或者只是挂起在我正在寻找的无限循环中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T07:29:52.110

在这种情况下，如果您的算法有问题，将电路板在边缘处变大一格会简单得多。您当然会限制它们用于位置，但是您的邻居逻辑不需要在边缘有所不同。

# java - 如何以一种好的方式将新方法添加到给定的数据结构中？

> ID：14088509
> 
> 赞同：2
> 
> 时间：2012-12-30T05:18:05.287
> 
> 标签：java, polymorphism

可以说，我们有一个给定的具有树数据结构的外部库。示例：具有子类的超`S`类。子类也可能有子类。`B1``B5`

现在我想为这个数据结构添加一个额外的方法。通常，人们会使用多态来实现它：每个子类都实现特定的方法。

但是因为我们处理的是一个外部库，所以我们不能改变原来的类。我想到了两种替代解决方案：

1.  使用一个方法创建一个新类，该方法通过使用检查大小写`instanceof`
2.  为每个类创建子类并在那里实现方法。

哪种方法是常见的情况？或者，是否有更好的替代解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T05:49:32.557

[装饰器设计模式](http://en.wikipedia.org/wiki/Decorator_pattern)可能会有所帮助。您可以拥有一个从 Class 扩展的装饰器类`S`。它也包裹了一个`S`。您可以在装饰器中实现您的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T05:50:18.163

装饰器模式可能会派上用场

```
 class S2 extends S {
        S s;

        S2(S s) {
            this.s = s;
        }

         // delegate method calls to wrapped B1-B5 instance

        @Override
        void oldMethod1() {
            s.oldMethod1();
        }

...

         // add new methods
        void newMetod1() {
             ...
        }
    } 
```

然后将其用作

```
new S2(new B1()); 
```

或在 B1 的现有实例上

```
new S2(b1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T05:20:34.920

[访问者设计模式](http://en.wikipedia.org/wiki/Visitor_pattern)使您能够向现有数据结构“添加”新操作。

# cocos2d-iphone - 如何在 Cocos2d 的一个纹理上使用两个片段着色器？

> ID：14088512
> 
> 赞同：0
> 
> 时间：2012-12-30T05:19:03.203
> 
> 标签：cocos2d-iphone, kobold2d

我正在尝试使用 cocos2d 2.0 中的着色器做模糊效果。我有两个片段着色器，一个用于水平方向，一个用于垂直方向。它们都可以工作，但我需要能够同时使用它们来在两个方向上获得模糊效果。而且我不知道如何在同一个精灵上使用两个片段着色器，因为您只能将一个着色器程序附加到一个精灵。有什么特别的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T06:26:45.887

我找到了一个“解决方案”。

您可以使用 CCRenderTexture，并在其上绘制带有第一个 Shader 的精灵，然后使用其结果在其上运行第二个 Shader。

它并不理想，但它有效。

# ruby - Ruby：模块、Mixins 和 Blocks 令人困惑？

> ID：14088513
> 
> 赞同：2
> 
> 时间：2012-12-30T05:19:10.627
> 
> 标签：ruby, module, mixins, block

以下是我试图从`Ruby Programming`书中 运行的代码[http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_modules.html](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_modules.html)

为什么该`product`方法没有给出正确的输出？我用`irb test.rb`. 我正在跑步`Ruby 1.9.3p194`。

```
module Inject
  def inject(n)
    each do |value|
      n = yield(n, value)
    end
    n
  end

  def sum(initial = 0)
    inject(initial) { |n, value| n + value }
  end

  def product(initial = 1)
    inject(initial) { |n, value| n * value }
  end
end

class Array
  include Inject
end

[1, 2, 3, 4, 5].sum            ## 15
[1, 2, 3, 4, 5].product        ## [[1], [2], [3], [4], [5]] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T05:26:38.543

由于编写了该代码示例，`Array`因此获得了一个[`#product`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-product)方法，您将看到该特定方法的输出。将模块的方法重命名为`product_new`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-30T11:04:13.140

在代码末尾添加这一行：

```
p Array.ancestors 
```

你得到（在 Ruby 1.9.3 中）：

```
[Array, Inject, Enumerable, Object, Kernel, BasicObject] 
```

Array 是 Object 的子类，并且有一个指向 Object 的超类指针。由于 Enumerable 被 Array 混入（包含）中，因此 Array 的超类指针指向 Enumerable，并从那里指向 Object。当您包含 Inject 时，Array 的超类指针指向 Inject，并从那里指向 Enumerable。当你写

[1, 2, 3, 4, 5].产品

方法搜索机制从实例对象 [1, 2, 3, 4, 5] 开始，进入其类 Array，并在那里找到 product（1.9 中的新功能）。如果你在 Ruby 1.8 中运行相同的代码，方法搜索机制从实例对象 [1, 2, 3, 4, 5] 开始，到它的类 Array，没有找到 product，沿着超类链向上，找到Inject 中的产品，您会得到预期的结果 120。

[您可以在 Pickaxe http://pragprog.com/book/ruby3/programming-ruby-1-9](http://pragprog.com/book/ruby3/programming-ruby-1-9)中找到对模块和 Mixins 的很好解释

我知道我已经看到有些人要求`prepend`在实例和它的类之间包含一个模块的方法，以便搜索机制在类的方法之前找到包含的方法。我在 SO 中使用“[ruby]prepend module 而不是 include”进行了搜索，并在其他中发现了这个：

[为什么包含此模块不会覆盖动态生成的方法？](https://stackoverflow.com/questions/4741373/why-does-including-this-module-not-override-a-dynamically-generated-method)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T12:00:56.893

回应@zeroone“我们如何避免这种命名空间冲突？”

尽可能避免猴子补丁核心类是第一条规则。一个更好的方法（IMO）是子类 Array：

```
class MyArray < Array
  include Inject 
  # or you could just dispense with the module and define this directly.
end

xs = MyArray.new([1, 2, 3, 4, 5])
# => [1, 2, 3, 4, 5]
xs.sum
# => 15
xs.product
# => 120
[1, 2, 3, 4, 5].product
# => [[1], [2], [3], [4], [5]] 
```

Ruby 可能是一种 OO 语言，但由于它有时非常动态（我发现）子类化被遗忘为一种有用的做事方式，因此过度依赖 Array、Hash 和 String 的基本数据结构，然后导致这些课程过多地重新开放。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-30T17:27:12.743

顺便说一句：在 Ruby 2.0 中，有两个特性可以帮助您解决这两个问题。

`Module#prepend` *在继承链中添加一个mixin*，以便在 mixin 中定义的方法*覆盖*在它被混合到的模块/类中定义的方法。

*改进*允许词法范围的猴子补丁。

它们在这里起作用（您可以通过 RVM 或 ruby​​-build 轻松获得 YARV 2.0 的当前版本）：

```
module Sum
  def sum(initial=0)
    inject(initial, :+)
  end
end

module ArrayWithSum
  refine Array do
    prepend Sum
  end
end

class Foo
  using ArrayWithSum

  p [1, 2, 3].sum
  # 6
end

p [1, 2, 3].sum
# NoMethodError: undefined method `sum' for [1, 2, 3]:Array

using ArrayWithSum
p [1, 2, 3].sum
# 6 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-30T20:44:25.540

下面的代码不是很详细。只是为了向您展示今天您已经有方法，例如当某些事件发生时由 Ruby 调用的钩子，来检查将使用/不使用哪个方法（来自包含类或包含的模块）。

```
module Inject
    def self.append_features(p_host) # don't use included, it's too late
        puts "#{self} included into #{p_host}"
        methods_of_this_module = self.instance_methods(false).sort
        print "methods of #{self} : "; p methods_of_this_module
        first_letter = []
        methods_of_this_module.each do |m|
            first_letter << m[0, 2]
        end
        print 'selection to reduce the display : '; p first_letter
        methods_of_host_class = p_host.instance_methods(true).sort
        subset = methods_of_host_class.select { |m| m if first_letter.include?(m[0, 2]) }
        print "methods of #{p_host} we are interested in: "; p subset
        methods_of_this_module.each do |m|
            puts "#{self.name}##{m} will not be used" if methods_of_host_class.include? m
        end

        super # <-- don't forget it !
    end 
```

像你的帖子一样休息。执行 ：

```
$ ruby -v
ruby 1.8.6 (2010-09-02 patchlevel 420) [i686-darwin12.2.0]
$ ruby -w tinject.rb 
Inject included into Array
methods of Inject : ["inject", "product", "sum"]
selection to reduce the display : ["in", "pr", "su"]
methods of Array we are interested in: ["include?", "index",  
 ..., "inject", "insert", ..., "instance_variables", "private_methods", "protected_methods"]
Inject#inject will not be used
$ rvm use 1.9.2
...
$ ruby -v
ruby 1.9.2p320 (2012-04-20 revision 35421) [x86_64-darwin12.2.0]
$ ruby -w tinject.rb 
Inject included into Array
methods of Inject : [:inject, :product, :sum]
selection to reduce the display : ["in", "pr", "su"]
methods of Array we are interested in: [:include?, :index, ..., :inject, :insert, 
..., :private_methods, :product, :protected_methods]
Inject#inject will not be used
Inject#product will not be used 
```

# iphone - 检测 Core Data 轻量级迁移中的错误

> ID：14088514
> 
> 赞同：0
> 
> 时间：2012-12-30T05:19:16.400
> 
> 标签：iphone, ios, core-data, migration

我第一次使用轻量级迁移来更新我的模型。测试以前版本的更新似乎很好，但我希望能够捕获故障并记录它们。

在应用程序崩溃之前，我如何以及在哪里拦截任何迁移错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T12:09:28.010

本，

轻量级迁移发生在 store 使用该`-addPersistentStoreWithType:configuration:URL:options:error:`方法连接到 coordinator 时。你可以在这里发现你的错误。

安德鲁

# java - Double 没有转换为 int

> ID：14088522
> 
> 赞同：7
> 
> 时间：2012-12-30T05:21:16.043
> 
> 标签：java, eclipse, int, double

我编写的这段代码转换`double`为`int`获取异常。

```
Exception in thread "main" java.lang.Error: Unresolved compilation problem: 
Cannot cast from Double to int 
```

这是我的代码

```
Double d = 10.9;    
int i = (int)(d); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-30T05:24:39.023

`Double`是原语之上的一个*包装*`double`类。可以转换为`double`，但不能`int`直接转换为 。

如果你使用`double`而不是`Double`，它将编译：

```
double d = 10.9;    
int i = (int)(d); 
```

您还可以`double`在中间添加演员表，如下所示：

```
int i = (int)((double)d); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-30T05:24:21.200

那是因为你不能混合拆箱（将你的转换`Double`为双`primitive`）和铸造。尝试

```
int i = (int)(d.doubleValue()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T05:24:18.980

这

```
Double d = 10.9; 
```

是你的错误。您正在使用包装类而不是数据类型。采用

```
double d = 10.9; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T06:10:11.840

您不能直接将像 Double 这样的包装器转换为像 int 这样的原始类型。

你可以试试这个——

`int i = (int)((double)d);`

有关更多信息，请查看以下链接 - [http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html)

# iphone - Cocos2d NSMutable Array 枚举时发生突变

> ID：14088524
> 
> 赞同：0
> 
> 时间：2012-12-30T05:21:27.927
> 
> 标签：iphone, objective-c, cocos2d-iphone, nsmutablearray, collision

我一直在做游戏，在某个时候我没有遇到删除敌人游戏对象的问题（现在它们是子类`CCSprite`，我知道这不是最好的方法）

但是我不确定当程序`removeChild`在`_targets`添加到`targetsToDelete`.

我尝试移动东西，我只是不知道在创建数组时如何添加或编辑数组......任何帮助或建议都会很棒！

实际上，如果您对如何最好地创建游戏敌人有任何指示，您是子类`NSObject`还是`CCNode`？我听说将它们划分为组件类，但我不知道它们是什么意思。

```
//Projectile Target collision

-(void)update:(ccTime)dt {

    for (spygot *target in _targets) {
        CGRect targetRect = CGRectMake(
                                       target.position.x - (target.contentSize.width/2),
                                       target.position.y - (target.contentSize.height/2),
                                       target.contentSize.width,
                                       target.contentSize.height);

        //Collision Detection Player
        CGRect playerRect2 = CGRectMake(
                                        _controlledSprite.position.x - (_controlledSprite.contentSize.width/2),
                                        _controlledSprite.position.y - (_controlledSprite.contentSize.height/2),
                                        _controlledSprite.contentSize.width,
                                        _controlledSprite.contentSize.height);

    NSMutableArray *projectilesToDelete = [[NSMutableArray alloc] init];
    for (Projectile *projectile in _projectiles) 
    {           
        NSMutableArray *targetsToDelete = [[NSMutableArray alloc] init];

        CGRect projectileRect = CGRectMake(
                                           projectile.position.x - (projectile.contentSize.width/2),
                                           projectile.position.y - (projectile.contentSize.height/2),
                                           projectile.contentSize.width,
                                           projectile.contentSize.height);
        BOOL monsterHit = FALSE;

        if (CGRectIntersectsRect(projectileRect, targetRect))
        {
            NSLog(@"hit");
            target.mhp = target.mhp - 1;
            monsterHit = TRUE;

            if (target.mhp <= 0)
            {
                [targetsToDelete addObject:target];
            }
        }

        for (spygot *target in targetsToDelete) 
        {
            [self removeChild:target cleanup:YES];
            [_targets removeObject:target];
        }

        if (monsterHit)
        {
            [projectilesToDelete addObject:projectile];
        }

        [targetsToDelete release];
    }

    for (Projectile *projectile in projectilesToDelete) 
    {
        [_projectiles removeObject:projectile];
        [self removeChild:projectile cleanup:YES];

    }
    [projectilesToDelete release];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:55:14.633

看起来您粘贴的代码全部来自`for`循环迭代`_targets`。变量如何`target`初始化？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:25:33.460

通常当我遇到这种错误时，是因为我将代码放在一个块中，或者以其他方式在一个模糊的线程上。您有多确定这段代码不会同时运行多次？

您可以尝试将其包装在以下内容中：

```
dispatch_async(dispatch_get_main_queue(), ^{
    // do everything here.
}); 
```

至于关于将 CCSprite 用于游戏敌人对象的建议，我的建议是在出现问题时修复它。你现在看到它的问题了吗？过早的优化几乎和一开始就做错一样糟糕。在项目结束时，您会更好地了解您应该如何更早地完成它。;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T21:05:19.323

我猜你知道在迭代数组时不能从数组中删除元素。这就是为什么你有`targetsToDelete`数组。

但在我看来，您确实很快就会删除目标。

试试这个：完成迭代主循环并完成将目标收集到 targetsToDelete 数组，并且仅在主循环完成后删除目标。

# smarty - Prestashop：order-detail.tpl 中未定义的 Smarty 变量

> ID：14088525
> 
> 赞同：0
> 
> 时间：2012-12-30T05:22:00.703
> 
> 标签：smarty, prestashop

在 order-detail.tpl 中，有 {$is_guest} 和 {$return_allowed} 等变量。一点调试（使用 Javascript 警报）显示 {$is_guest} 由于某种原因未定义，即使我允许返回，{$return_allowed} 也会返回 0。这导致订单详情页面隐藏了商品退货部分。

所有这些 Smarty 变量都定义在 root/controllers/OrderDetailController.php 中，所以我不知道是什么导致了错误。

我正在使用 Prestashop 1.4.9。任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T08:53:20.197

我解决了我自己的问题。转到根目录/controllers/OrderDetailController.php。在第 144 行附近，更改

```
'is_guest' => false, 
```

到

```
'is_guest' => "false", 
```

还有，改变

```
{if !$is_guest} 
```

到

```
{if $is_guest == "false"} 
```

至于$return_allowed，原来必须在BO中将物品标记为先送达。它被定义为是假的，除非在退货截止日期之前支付+交付+。

# c# - 如何评估两个日期时间何时彼此相等

> ID：14088527
> 
> 赞同：1
> 
> 时间：2012-12-30T05:22:06.870
> 
> 标签：c#, visual-studio, windows-phone-7, windows-phone, windows-phone-8

情况是这样的：我的应用程序中有一个 TimePicker。我希望用户能够使用 TimePicker 选择时间，然后应用程序将在使用 TimePicker 输入的时间向用户发送通知。我正在用 C# 为 Windows Phone 编写一个应用程序。到目前为止，这是我的代码（我不认为这是正确的）

```
DateTime now = DateTime.Now;
DateTime? get = timePicker1.Value;         

if (now == get)
{
    ShellToast toast = new ShellToast();
    toast.Title = "Title";
    toast.Content = "The Time Has Come!";
    toast.Show();
} 
```

但是每次我运行代码时，它都会给我一个异常，应用程序根本不会加载，并且每次通知（toast）都不会显示。（我也知道该应用程序无法在前台运行以显示通知）。（我知道通知有效，因为我可以让它在其他情况下工作）。

基本上，我的问题是：如何在最终用户定义的特定时间触发通知？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:32:05.287

```
Line 1 : DateTime now = DateTime.Now;
Line 2 : DateTime? get = timePicker1.Value; 
```

在 中`Line 1`，你得到系统当前的日期时间，“现在”是日期时间而不是空值。但是在 中`Line 2`，“get”是可以为空的变量，并且您正在获取 timepicker.value 并将日期时间与时间进行比较。我不知道您有什么异常，但是通过 2 次额外检查，您可以获得更安全的代码

1.  “获取”的空值检查
2.  确保在您的开发环境中，您可以将日期时间与时间值进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T17:02:50.320

首先，如果应用程序在前台运行，则不会显示 Toast 通知。它应该只在后台代理或应用程序在锁屏下运行时使用。
其次，如果您的目标是在一天中的选定时间显示通知，那么您不能比较 DateTime 值，而是比较 TimeOfDay 部分。还要通过检查“get.HasValue”确保用户输入了有效值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T12:48:48.293

你必须记住，`Date.Now`有一个完整的时间和日期！

因此，与`get`变量相比，您必须忽略 Date 部分，否则可能不起作用。

尝试改变你`if`的样子：

```
if (get.HasValue && now.TimeOfDay == get.Value.TimeOfDay)
{
    // your remaining code
} 
```

此外，ShellToast 类仅适用于后台服务，不适用于前台应用程序（请查看[此处](http://msdn.microsoft.com/en-US/library/windowsphone/develop/microsoft.phone.shell.shelltoast%28v=vs.105%29.aspx)的备注）！

如果您想在您的应用程序中显示 Toast，请使用[Coding4Fun Toolkit](http://coding4fun.codeplex.com/)中的 Toast Prompt 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-22T14:37:37.363

您可以比较两个日期时间的日、月、年值。如果您想更精确，请考虑分钟和秒（因为我不知道您要比较值的详细程度）。

如果您想在特定时间收到通知，请尝试[使用 Alarm 类](http://debugmode.net/2012/01/16/creating-alarm-and-reminder-in-windows-phone/)。

# php - json解码不起作用

> ID：14088533
> 
> 赞同：0
> 
> 时间：2012-12-30T05:23:28.773
> 
> 标签：php, javascript

我有一个我想要`json_decode`的数据，数据`json_stringify`在发送到 PHP 之前，数据如下所示：

```
{\"data\":{\"buildingID\":{\"2\":{\"path\":[[11,11],[10,11],[10,10],[9,10],[8,10],[8,9],[8,8],[8,7],[8,6]]}}}} 
```

在我的脚本中，我有：

```
echo $_GET['as']; //this is what you see above^
$obj = json_decode($_GET['as']);
echo $obj; //no output
var_dump($obj);  //this shows NULL 
```

我的错误日志中也没有错误/通知/警告。

我想知道斜线是否会引起某种问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T05:33:09.407

斜线确实是问题所在。

我的猜测是魔术引号是罪魁祸首。我建议你[禁用魔术引号](http://php.net/manual/en/security.magicquotes.disabling.php)。

# javascript - 如何使用 selenium 在 python 中执行 Javascript 函数

> ID：14088541
> 
> 赞同：13
> 
> 时间：2012-12-30T05:24:50.227
> 
> 标签：javascript, python, selenium, selenium-webdriver

我在 javascript 中有一个名为“checkdata(code)”的函数，如您所见，它接受一个名为“code”的参数来运行并返回一个 15 字符的字符串。

所以，我发现（并测试了）如何在 javascript 中调用无参数函数，但我的问题是，当我调用 checkdata(code) 时，我总是得到一个“无”返回值。到目前为止，这就是我正在做的事情：

```
wd = webdriver.Firefox()
wd.get('My Webpage')
a = wd.execute_script("return checkdata()", code)  //Code is a local variable
                                                   //from my python script
print a 
```

我正在做这个，因为我在非官方的 selenium 文档和这里阅读了它：[链接](https://stackoverflow.com/questions/5585343/getting-the-return-value-of-javascript-code-in-selenium/5585345#5585345)

但是，正如我之前所说，我只是一直没有打印出来。

如何调用传递该参数的函数？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-30T05:32:18.080

构建字符串

```
a = wd.execute_script("return checkdata('" + code + "');") 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-05-20T04:29:49.323

而不是构建一个字符串（这意味着你必须正确地转义你的引号），试试这个：

```
a = wd.execute_script("return checkdata(arguments[0])", code) 
```

# javascript - Google Places API 在 Firefox 中不起作用

> ID：14088543
> 
> 赞同：0
> 
> 时间：2012-12-30T05:25:10.623
> 
> 标签：javascript, firefox, google-maps-api-3, google-places-api

我完全被这里吓到了。我使用 Google Places API 和 Google Maps Javascript API v3 来显示带有地址、电话号码等的商业地图……我在 Webkit 上开发了网站……然后我发现它在火狐...这是我的代码：

```
function initialize() {
var e = document.getElementById('place_reference')
if (e) {
    var place_reference = document.getElementById('place_reference').innerText;
}
var request = {
  reference: place_reference
};
service = new google.maps.places.PlacesService(document.getElementById('map_canvas'));
service.getDetails(request, callback);

function callback(place, status) {
  console.log(status);
  if (status == google.maps.places.PlacesServiceStatus.OK) {
    document.getElementById('loading').style.display = 'none';
    if (document.getElementById('place_address').innerText == '') {
        document.getElementById('place_address').innerText = place.formatted_address;
    }
    if (document.getElementById('place_phone').innerText == '') {
        document.getElementById('place_phone').innerText = place.international_phone_number;
    }
    if (document.getElementById('place_website').innerHTML == '') {
        document.getElementById('place_website').innerHTML = '<a href="' + place.website + '"target="_blank">' + place.website + '</a>';
    }  
    var place = place.geometry.location;
    var marker;
    var map;
    var mapOptions = {
      zoom: 16,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      disableDefaultUI: true,
      scrollwheel: false,
      center: place
    };
    map = new google.maps.Map(document.getElementById('map_canvas'),
            mapOptions);
    marker = new google.maps.Marker({
      map: map,
      draggable: false,
      animation: google.maps.Animation.DROP,
      position: place
    });
  }
}
} 
```

在 Firefox 上，状态返回 INVALID_REQUEST 而在其他浏览器上，它返回 OK

我真的需要帮助来解决这个问题。您可以通过以下地址查看网站： http: [//social-e.laclinique.biz/en/blog/shops/noel-eternel](http://social-e.laclinique.biz/en/blog/shops/noel-eternel)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T06:35:14.363

问题在这里：

```
 var place_reference = document.getElementById('place_reference').innerText; 
```

FF不支持innerText，使用例如：

```
 var place_reference = document.getElementById('place_reference').firstChild.nodeValue 
```

（或者）

```
 var place_reference = document.getElementById('place_reference').innerHTML; 
```

# asp.net - 当我从后面的代码将按钮添加到 GridView 的单元格时，单击事件不会调用

> ID：14088544
> 
> 赞同：3
> 
> 时间：2012-12-30T05:25:59.230
> 
> 标签：asp.net

我使用下面的代码从后面的代码中将按钮添加到 GridView 的单元格，但是当我单击我添加的每个按钮时，单击事件（lnk_Click）不会调用并且在我单击它后按钮隐藏。我该如何解决这个问题?

```
//aspx
    <asp:GridView ID="GridView1" runat="server" GridLines="None" Width="940px"
      OnSelectedIndexChanged="grid_SelectedIndexChanged"
      onrowdatabound="GridView1_RowDataBound" AutoGenerateColumns="False" CssClass="gridview">
       <Columns>
          <asp:TemplateField HeaderText="...">
               <ItemTemplate>
                   <asp:Panel ID="pnlSteps" runat="server"></asp:Panel>
               </ItemTemplate>
          </asp:TemplateField>
       </Columns>
  </asp:GridView>

    //Code behind
    for (int i = 0; i < GridView1.Rows.Count; i++)
            {
                Panel pnl = (Panel)GridView1.Rows[i].Cells[0].FindControl("pnlSteps");
                LinkButton lnk = new LinkButton();
                lnk.Text = "...";
                pnl.Controls.Add(lnk);
                lnk.Click += new EventHandler(lnk_Click);
            }//for
    ...

    protected void lnk_Click(object sender, EventArgs e)
        {
    //...
    } 
```

//编辑

我用下面的代码填充gridview

```
//dsSet is DataSet that i fill it with data from Database
DataTable dtt = new DataTable();

        dtt.Columns.Add(new DataColumn("status", typeof(string)));
        dtt.Columns.Add(new DataColumn("finantial", typeof(string)));
        dtt.Columns.Add(new DataColumn("phone", typeof(string)));
        dtt.Columns.Add(new DataColumn("name", typeof(string)));
        dtt.Columns.Add(new DataColumn("code", typeof(string)));

        for (int i = 0; i < dsSet.Tables[0].Rows.Count; i++)
        {
            DataRow dr = dtt.NewRow();

            dr[0]=...;
            dr[1]=...;
            dr[2]=...;
            dr[3]=...;
            dr[4]=...;

            dtt.Rows.Add(dr);
        }//for
        GridView1.DataSource = dtt;
        GridView1.DataBind(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T12:30:51.027

因为按钮在里面`gridview`所以你不能得到它的点击事件`onclick`但是你必须使用[GridView.RowCommand](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowcommand.aspx)并`commandname`在按钮中使用

**编辑**

```
<asp:TemplateField>
  <ItemTemplate>
    <asp:Button ID="AddButton" runat="server" 
      CommandName="commandName" 

      Text="command" />
  </ItemTemplate> 
</asp:TemplateField> 
```

后面的代码：

```
protected void GridView1_RowCommand(object sender, 
  GridViewCommandEventArgs e)
{
  if (e.CommandName == "commandName")
  {
     // add your code
  }

} 
```

# php - 在ajax调用中处理php代码

> ID：14088545
> 
> 赞同：0
> 
> 时间：2012-12-30T05:26:03.537
> 
> 标签：php, ajax

我在一个调用 php 脚本的网站上使用 ajax，该脚本然后解析另一个页面并返回我想要显示的页面部分。我过去使用过这种技术并且效果很好，只是这次返回的页面部分中有一些 php 代码，并且它是在没有处理 php 代码的情况下返回的。

这是进行解析并返回结果的 php 脚本。

```
require_once('simple_html_dom.php');
$dom = new simple_html_dom;

if(isset($_GET['url']))  {
    $url = $_GET['url'];
    $html = file_get_html($url);
    /*get contents*/
    $contents = $html->getElementById('content');
    echo $contents;
} 
```

正如我提到的，在 $contents 中返回的内容是在没有处理 $contents 字符串中的 php 代码的情况下返回的，我怎样才能让它在返回 $contents 字符串之前处理 php 代码？

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:22:50.287

解析由另一个 PHP 脚本生成的 HTML 是相当骇人听闻的。如果您正在开发一个新站点，您至少应该将您的 PHP 脚本划分为函数，然后，对于 AJAX 请求，只调用必要的函数。

即使您正在处理现有的复杂站点，请记住 jQuery 的[.load()](http://api.jquery.com/load/)允许您将服务器响应的特定片段插入到文档中，而丢弃其余部分：

```
$('#content').load('script.php #content'); 
```

* * *

也就是说，您要问的是可能的：

*   PHP 的[输出控制](http://www.php.net/manual/en/ref.outcontrol.php)函数允许您将脚本的输出捕获为字符串，您可以使用 str_get_html() 对其进行解析。要完成这项工作，您必须包含现有的 PHP 脚本。请注意，您包含的任何脚本都可以访问全局函数和变量、超全局变量和类。

    **警告：**确保根据特定文件的白名单检查请求的文件名，以防止[文件包含攻击](http://cwe.mitre.org/data/definitions/98.html)。仅仅将 URL 列入黑名单并禁用 allow_url_fopen 不足以保护您的网站。

    ```
    ob_start();
    require $filename; // might have to be outside of a function
    $html = str_get_html(ob_get_clean()); 
    ```

*   [或者，您可以让 AJAX 脚本使用file_get_contents()](http://www.php.net/manual/en/function.file-get-contents.php)或[cURL](http://www.php.net/manual/en/book.curl.php)（指定绝对 URL，而不是文件名）发出自己的 HTTP 请求。除非您以其他方式配置 Web 服务器，否则此内部请求将在您的 Web 服务器的访问日志中显示为来自 127.0.0.1 或您的 Web 服务器的 IP 地址。

# azure - 500 - Azure 中的内部服务器错误

> ID：14088550
> 
> 赞同：1
> 
> 时间：2012-12-30T05:27:20.840
> 
> 标签：azure

我正在使用`SDK 1.8`。我想在 azure 中部署一个示例站点。我有一个测试帐户，所以我不知道我是否拥有完全权限。当我使用模拟器在本地运行站点时，它运行但当我创建包并部署时在天蓝色我得到一个错误：

```
500 - Internal server error 
```

我发现[这个问题](https://stackoverflow.com/questions/6275462/azure-management-api-returns-500-internal-server-error) 有同样的问题。它已经 5 个月大了，没有解决方案。我包括`web.config`：

```
customErrors="Off" 
```

但仍然是同样的问题。我将它部署为一个创建包的站点。

我搜索但从未找到任何解决方案。可能有些人面临同样的问题并得到解决方案。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T18:02:10.247

Azure 网站未部署为包，您从 TFS 或 Visual Studio 发布。Azure WebRoles 使用包部署到 Azure 云服务。按照您[引用](https://stackoverflow.com/questions/14050234/physicaldirectory-and-redirection-in-azure)的问题中的建议，完全删除“站点”元素。对于简单的部署，它被过度指定了。请参见此处的图 1 - [http://msdn.microsoft.com/en-us/wazplatformtrainingcourse_advancedwebandworkerroles_topic2.aspx](http://msdn.microsoft.com/en-us/wazplatformtrainingcourse_advancedwebandworkerroles_topic2.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-20T14:29:51.703

您可能希望使用计算模拟器在本地进行调试。即使您现在不使用它来快速在云上工作，您将来也需要它。

帮助获得更多描述性输出的一种方法是启用详细的错误消息，而不是您目前看到的错误消息。

这不像启用自定义错误那么容易，并且需要对 Web 角色进行一些修改。这篇文章“[调试 Azure HTTP 500 错误](http://blogs.msdn.com/b/rickandy/archive/2012/11/06/debugging-azure-http-500-errors.aspx)”解释了如何做到这一点，所以，简而言之：

在您的 Web 角色的根级别创建一个名为 startup 的新文件夹，并在此文件夹中创建一个名为`startup.cmd`. 将此文件的属性设置为 Copy Always 以确保将其部署。

将以下代码添加到`startup.cmd`文件中：

```
%windir%\system32\inetsrv\AppCmd.exe set config -section:system.webServer/httpErrors -errorMode:Detailed 
%APPCMD% set config -section:system.webServer/httpErrors -errorMode:Detailed 
```

第一行在 Azure 上启用详细的错误消息。第二行在计算模拟器上启用它们。

接下来，`ServiceDefinition.csdef`在您的 Web 角色项目中打开该文件并添加以下元素：

```
<Startup>
    <Task commandLine=”..\startup\startup.cmd” executionContext=”elevated” />
</Startup> 
```

你的项目应该看起来像这样*（在这个例子中，启动标签被注释掉了）*：

![在此处输入图像描述](../Images/dbbd690ac0fe090aeb4f20d677931eff.png)

如果一切顺利，您应该开始看到更多有用和描述性的错误消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-02T13:54:56.883

这可能是由于各种原因。就我而言，这是LocalWebDevelopmentServer 设置的**错误配置。**设置它来`IISExpress`解决问题。![在此处输入图像描述](../Images/9b1f4fdfb3dddce3c094764fa514e2ba.png)

# python - https应该使用什么python web交互模块？

> ID：14088551
> 
> 赞同：0
> 
> 时间：2012-12-30T05:27:23.753
> 
> 标签：python

https操作应该使用什么python web交互模块？例如在受 HTTPS/SSL 证书保护的网站上自动注册帐户的程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T05:39:30.200

不太确定你在这里问什么，但该[`requests`](http://docs.python-requests.org/en/latest/)模块非常适合各种 HTTP 操作，包括 HTTPS。

# objective-c - 段控制：无法识别的选择器发送到实例

> ID：14088554
> 
> 赞同：1
> 
> 时间：2012-12-30T05:28:17.110
> 
> 标签：objective-c, ios5, xcode4.3

我想创建一个包含段控件和标签的应用程序，按下控件时更改标签。

我想使用“发件人”来获取段控件的值，但为什么它不起作用？

```
-(void)segmentControlIndexChanged:(id)sender
{
    switch ([sender selectedIndex]) {
        case 0:
            label.text = @"Case Zero :)";
            break;
        case 1:
            label.text = @"Happy New Year!";
            break;
        default:
            label.text = @"Press a button:";
            break;
    }
} 
```

* * *

其他麻烦：下面的代码导致：

-[ViewController segmentControlIndexChanged:]：无法识别的选择器发送到实例

```
//ViewController.h
@interface ViewController : UIViewController {
    IBOutlet UILabel *label;
    IBOutlet UISegmentControl *segmentControl;
}

@property (retain, nonatomic) UILabel *label;
@property (retain, nonatomic) UISegmentControl *segmentControl; 
```

-

```
//ViewController.m
-(IBAction)segmentControlIndexChanged
{
    switch ([segmentControl selectedSegmentIndex]) {
        case 0:
            label.text = @"X'mas always come first :)";
            break;
        case 1:
            label.text = @"Happy New Year!";
            break;
        default:
            label.text = @"Press a button:";
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T05:35:14.920

它不起作用，因为`UISegmentedControl`有`selectedSegmentIndex`属性，而不是`selectedIndex`：

```
switch ([sender selectedSegmentIndex]) { // <<== Here
    case 0:
        label.text = @"Case Zero :)";
        break;
    case 1:
        label.text = @"Happy New Year!";
        break;
    default:
        label.text = @"Press a button:";
        break;
} 
```

有时，Xcode 会让你选择错误的方法；当您不确定确切的名称时，请查阅在线可用的[开发人员文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UISegmentedControl_Class/Reference/UISegmentedControl.html)，并通过 Xcode 的帮助/文档和 API 参考。

# android - 保存列表视图菜单

> ID：14088555
> 
> 赞同：0
> 
> 时间：2012-12-30T05:28:31.507
> 
> 标签：android, persistence

我正在使用 ListView 和 ArrayAdapters 构建菜单。当我运行应用程序时，我可以将项目添加到 ListView，因为 EditText 和 Button 将在 EditText 中键入的任何内容添加到 ListView。

当我关闭应用程序时，我的问题就出现了。当我关闭应用程序时，ListView 会重置。我需要 ListView 来保存从 EditText 添加的项目。我的应用程序使用 ArrayAdapters、ArrayLists、ListView、Button、EditText 和 onClickListeners。

我只需要关于如何保存在程序运行时添加到 ListView 的数据的好教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:15:59.470

[官方的 android Notepad 教程](http://developer.android.com/training/notepad/index.html)有一个完整的例子，在列表视图中显示 SQLite 数据并保存它。你应该检查一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:03:38.193

这两个教程可以帮助你保存你想要的一切：

[Android SQLite 数据库和 ContentProvider](http://www.vogella.com/articles/AndroidSQLite/article.html)

[Android SQLite 数据库教程](http://www.androidhive.info/2011/11/android-sqlite-database-tutorial/)

并且为了保存视图或组件的属性，您应该研究`Serialization`and `Deserialization`。为此，您可以遵循以下问题：

[序列化 Android 视图 - 导致来自 IllegalAccessException 的 InvalidClassException](https://stackoverflow.com/questions/9779436/serializing-android-views-causes-invalidclassexception-from-illegalaccessexcep)

[如何序列化对象并将其保存到 Android 中的文件中？](https://stackoverflow.com/questions/4118751/how-do-i-serialize-an-object-and-save-it-to-a-file-in-android)

对于您的主要问题，这个问题也可以帮助您：

[如何在 Activity 重新启动时保留复杂对象？](https://stackoverflow.com/questions/1636623/how-do-i-preserve-a-complex-object-across-activity-restarts)

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T05:33:12.670

您需要学习如何将数据保存到持久存储中。从 Google的[本教程](http://developer.android.com/training/basics/data-storage/index.html)开始。

在您的情况下，如果您的数据是结构化的，您可以保存到一个简单的文件或 SQLite 数据库。

# java - 从桌面应用程序登录网站

> ID：14088557
> 
> 赞同：2
> 
> 时间：2012-12-30T05:28:33.710
> 
> 标签：java, authentication, login, inputstream, outputstream

我想从我的 Java 桌面应用程序登录到一个网站。我必须编写`Username`和`Password`使用`OutputStreamWriter`. 我能够从我的应用程序成功登录到其他网站，但不是我真正想要的。在分析了该网站的页面源之后，我发现这`ID`两个文本框的`Username & password`每个请求和每次页面刷新时都会发生变化。

```
<input type="text" name="UserName_88515" id="UserName_88515" /> 
```

最后`id`5 位数字每次都会更改，因此我决定读取页面源，检索这 5 位数字，然后写入凭据以登录该网站。

```
public class LoginHandler {

static boolean isLoggedIn = false;
static String responseText, myText;

public void login(String usrname, String password, String cookys, String sessionCode) {

    try {

        URL url = new URL("http://www.somewebsite.com/home.php?session="
                + sessionCode);
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setDoOutput(true);
        conn.setRequestMethod("GET");
        conn.setRequestProperty("User-Agent",
                "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:17.0) Gecko/20100101 Firefox/17.0");
        conn.setRequestProperty("Cookie", cookys);
        conn.setDoOutput(true);

        final BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));

        final StringBuilder response = new StringBuilder();
        myText = response.toString();
        String line;

        while ((line = rd.readLine()) != null) {
            response.append(line);
        }
        rd.close();

        final String text1 = response.toString();
        final int starIndex = text1.indexOf("UserName_");
        final int endIndex = starIndex + 15;
        System.err.println("This is starIndex" + starIndex);
        System.err.println("This is endIndex" + endIndex);
        final String avc = text1.substring(starIndex, endIndex);
        System.err.println("This is avc\n" + avc);
        final String fin = avc.substring(10, 15);
        System.err.println("This is fin\n" + fin);

        final String data1 = URLEncoder.encode("MessageLength", "UTF-8")
                + "=" + URLEncoder.encode("140", "UTF-8") + "&"
                + URLEncoder.encode("UserName_" + fin, "UTF-8") + "="
                + URLEncoder.encode("username", "UTF-8") + "&"
                + URLEncoder.encode("Password_" + fin, "UTF-8") + "="
                + URLEncoder.encode("password", "UTF-8") + "&"
                + URLEncoder.encode("LoginNowbtnDiv", "UTF-8") + "="
                + URLEncoder.encode("Login Now", "UTF-8") + "&"
                + URLEncoder.encode("LoginNow", "UTF-8") + "="
                + URLEncoder.encode("Login Now", "UTF-8");

        System.err.println("THIS IS Data1:\n " + data1);

        final OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
        wr.write(data1);
        wr.flush();

        final BufferedReader rd1 = new BufferedReader(new InputStreamReader(conn.getInputStream()));

        final StringBuilder response1 = new StringBuilder();
        String line1;

        while ((line1 = rd1.readLine()) != null) {
            response1.append(line1);
        }

        final String text2 = response1.toString();
        System.err.println("This is second response\n" + text2);
        rd1.close();
    } catch (Exception ex) {
        ex.printStackTrace();
    }
}
} 
```

为此，我编写了以下代码，但出现以下错误：

```
Cannot write output after reading input 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:34:00.637

查看这个问题的答案 -[读取输入后无法写入输出](https://stackoverflow.com/questions/11413028/cannot-write-output-after-reading-input) 简短版本是基础 HttpURLConnection (conn) 无法重用，您需要打开一个新的。

一般来说，如果你为你的 http 代码使用更好的库，比如[HTTPComponents ，你会更容易](http://hc.apache.org/)

# version-control - 如何撤消 Mercurial 中一个或多个变更集的内容？

> ID：14088563
> 
> 赞同：2
> 
> 时间：2012-12-30T05:30:26.987
> 
> 标签：version-control, mercurial

几个月前我有一些变更集，我从一个单元测试框架转换为另一个。（不要问）我决定不喜欢新框架，并想恢复使用旧框架。

我不想真正从我的存储库中删除有问题的变更集——我只想要一个变更集，它可以撤消以前的变更集或变更集所做的事情。

当我使用 svn 时，有一个 TortoiseSVN 命令可以执行此操作，它将一组提交“反向合并”到工作副本中。

Mercurial 是否具有开箱即用的此类功能，还是我将与 Beyond Compare 度过一个有趣的夜晚？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T05:54:38.747

你正在寻找`hg backout`. 从[善变的文档](http://mercurial.selenic.com/wiki/Backout)：

> 回退通过应用与要回退的变更集相反的变更集来工作。新的变更集被提交到存储库，并最终合并。

你想用一个特定的版本来调用它。例如，要撤销修订号为 3 的修订，请运行`hg backout -r 3`

# javascript - 鼠标事件和 FPS

> ID：14088565
> 
> 赞同：1
> 
> 时间：2012-12-30T05:30:45.147
> 
> 标签：javascript, canvas, html5-canvas

我正在尝试使用画布和 javascript 记录用户的鼠标移动。通常，当浏览器有新的鼠标事件时，每个点都会被保存，但显然在回放它们时会导致问题。

出于这个原因，我想到了以每秒恒定帧数记录鼠标移动的想法，但我真的不知道如何实现这一点，因为鼠标是基于事件的（无法请求当前位置？）。简单地说，我想以恒定的 PFS 记录鼠标位置，以便再次以恒定的 FPS 回放它们。**对于基于事件的鼠标位置，如何实现这种“每秒恒定帧数”？**

我很确定这个问题有一个简单的答案。作为一个长期使用 Flash 的用户，框架是作为一切基础的主要事物之一。现在我很难得到我每天用画布面对的更抽象的概念。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:45:33.790

那么我相信保存所有点的**问题**是浏览器的性能下降。

但即使在 Flash 中，您也可能不得不这样做。这里没有什么不同。

*   在 Flash 中，您可能已将鼠标移动事件添加为侦听器。

    在 JS 中，您也可以直接将 mousemove 处理程序附加到对象。

*   在 Flash 中，您可以使用 fps 或使用 Timer 类来处理时间事件。

    在 JS 中，您有相同的 setInterval 和 setTimeout。

您可能不会从中获得任何好处，但同样，如果您希望保持更新鼠标坐标的类似逻辑，这里是如何：

JS 需要以毫秒为单位的时间间隔，所以

```
interval = 1000 / fps; 
```

这是我为您准备的[小提琴样本。](http://jsfiddle.net/cKhbc/)

# asp.net - 为什么此查询无法编译？

> ID：14088566
> 
> 赞同：0
> 
> 时间：2012-12-30T05:31:34.397
> 
> 标签：asp.net, vb.net

这段代码有什么问题？

```
Dim mycon As OleDbConnection
    Dim cmd As OleDbCommand
    Dim sqlstring, game, ram, vga, scr, download, gametype, size As String
    game = TextBox1.Text
    download = TextBox2.Text
    scr = TextBox3.Text
    vga = TextBox4.Text
    ram = TextBox5.Text
    size = TextBox6.Text
    gametype = DropDownList1.SelectedValue.ToString
    mycon = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" & Server.MapPath("../games.mdb"))
    mycon.Open()
    sqlstring = "INSERT INTO [Games] ( Name , url , image , Vga , Ram , Size , Type ) VALUES ('" + game + "' , '" + download + "' , '" + scr + "' , '" + vga + "' , '" + ram + "' , '" + size + "' , '" + gametype + "')"
    cmd = New OleDbCommand(sqlstring, mycon)
    cmd.ExecuteNonQuery()
    mycon.Close() 
```

当我运行它时，我得到：

```
error in 
Line 21:         cmd.ExecuteNonQuery() 
```

游戏架构 ID|名称|网址|图像|VGA|内存|大小|类型

堆栈跟踪：

```
[OleDbException (0x80040e14): Syntax error in INSERT INTO statement.]
   System.Data.OleDb.OleDbCommand.ExecuteCommandTextErrorHandling(OleDbHResult hr) +1090740
   System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS dbParams, Object& executeResult) +247
   System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object& executeResult) +189
   System.Data.OleDb.OleDbCommand.ExecuteCommand(CommandBehavior behavior, Object& executeResult) +58
   System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior behavior, String method) +162
   System.Data.OleDb.OleDbCommand.ExecuteNonQuery() +107
   admin_editgames.Button1_Click(Object sender, EventArgs e) in E:\New folder (4)\WebSite1\admin\editgames.aspx.vb:23
   System.Web.UI.WebControls.Button.OnClick(EventArgs e) +9553594
   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +103
   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +10
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +35
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1724 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:35:57.737

您的任何 TextBox 输入的输入值中是否有撇号（“'”）？如果是这样，你需要用另一个撇号来逃避它们：

```
game = Replace(TextBox1.Text, "'", "''")
' repeated for all variables 
```

当您阅读有关 SQL 注入攻击的信息时，这类代码就是它们发生的方式。

# c# - 使用 EF Code First 从 SimpleMembership 获取成员资格记录

> ID：14088569
> 
> 赞同：0
> 
> 时间：2012-12-30T05:32:20.870
> 
> 标签：c#, asp.net-mvc, ef-code-first, simplemembership

我正在了解新的 SimpleMembership 提供程序如何在带有 EF Code First 的 MVC 4 中工作。到目前为止，我的一切工作都很好，但我遇到了一些我不太明白的事情。

由于这行代码，SimpleMembership 自动创建了几个表：

```
WebSecurity.InitializeDatabaseConnection("DatabaseContext", "User", "Id", "Email", autoCreateTables: true); 
```

我有一个名为“用户”的 Code First 实体来存储我所有特定于域的用户数据。因此，使用 WebSecurity 类，我可以通过各种方式获取我需要的用户 ID，然后查询我的用户实体以获取我的域特定数据。但是，由于 SimpleMembership 自动创建的“webpages_xxxx”表没有 POCO 类，因此我无法通过 EF 轻松访问这些类。具体来说，我有兴趣获取 pages_Membership 表，这样当我有用户 ID 时，我可以获取“IsConfirmed”、“PasswordVerificationToken”等字段。

常识说我只需要编写一些 POCO 类来表示表结构，但感觉应该有一些开箱即用的东西。Microsoft 是否让我们只编写自己的 POCO 类来表示它们的表结构，还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:47:49.160

如果我理解，您的方案是：使用 SimpleMembership，但首先使用代码访问数据，其中我的表位于同一数据库中。

这个有可能。为此，我使用了 EF 团队的一个不错的工具[http://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d](http://visualstudiogallery.msdn.microsoft.com/72a60b14-1581-4b9b-89f2-846072eff19d) 。

使用 **EF powertool**，您可以*生成用于访问现有数据库的 CodeFirst 代码*。

如何：安装电动工具。（见上面的链接）将鼠标放在项目上，代码应该去。右键单击项目，选择实体框架，从数据库中反向工程代码优先。

答对了。您可以将 POCO 类添加到您的模型和您的上下文中。并且您可以读取和写入标准的成员资格表。

# php - 如何强制 PDOexception 记录错误？(php)

> ID：14088570
> 
> 赞同：1
> 
> 时间：2012-12-30T05:32:25.350
> 
> 标签：php, logging, pdo

我想使用 PDO 记录数据库错误，但我不想重复将日志记录添加到我的 catch 块中。有没有办法强制记录 PDOException？

或者我是否必须创建一个扩展 PDO 的类，然后创建一个扩展 PDOExceptions 的类并改用它们。如下所示：

```
try {
  $dbconn = new logPDO ( ... );
  //...
} catch (LogException $e ) {
  //..
} 
```

我想避免创建新类只是为了解决这个问题。我无法记录 PDOException 似乎很奇怪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:33:26.747

最简单的事情是创建一个接受`PDOException`并执行日志记录逻辑的函数。

```
function logPdo(PDOException $e) {
  // log stuff w/ the exception instance..
} 
```

这也可能是类上的静态方法。但是，如果您想要一个更 OO 的解决方案，子类化`PDO`并让它捕获`PDOException`然后抛出一个具有`log`方法或类似方法的子类或自定义 Exception 类，这是一种合理的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T09:37:53.893

整个设置对我来说看起来很不寻常。
您不想将日志记录添加到您的 catch 块中，但希望将这些块添加到数字中。

据我了解，处理错误的一般方法是单个应用程序范围的异常处理程序来完成所有工作 - 要么在屏幕上显示错误，要么记录它，同时将 503 发送到浏览器。在任何错误上，不仅是 PDO 错误。因为我发现每一个错误都非常有用，值得平等对待。

为此，必须设置自己[的错误处理程序](http://php.net/manual/en/class.errorexception.php)以引发异常并设置异常处理程序以记录错误。并为整个应用程序设置全局 try-catch 块。

虽然对于应用程序可以在没有的情况下生存的这几个非关键部分，可以使用内部带有记录器的 try-catch 块，但同样，我不明白为什么只使用 PDO - 我会包装整个这样的块，并记录发生的每个错误，而不仅仅是 PDO-risen。因此，某些不同类型的异常（仅触发日志记录但不会在捕获时停止应用程序）可以解决问题。

# android - 片段内的 CordovaWebView 返回 NullPointerException

> ID：14088571
> 
> 赞同：1
> 
> 时间：2012-12-30T05:32:28.423
> 
> 标签：android, android-fragments, android-webview, cordova-2.0.0

我正在尝试在片段中实现 CordovaWebView (2.2.0)，但在尝试扩展布局时它返回错误。

我的xml：

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
         android:layout_width="fill_parent"
         android:layout_height="fill_parent">

<org.apache.cordova.CordovaWebView
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:id = "@+id/mainView"/>

</FrameLayout> 
```

我的 onCreateView：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {

    View v = inflater.inflate(R.layout.cordovawebview, container); // <--- the error occurs here!

    return v;
} 
```

错误：

> 10-25 15:52:02.839: ERROR/AndroidRuntime(2878): FATAL EXCEPTION: main android.view.InflateException: Binary XML file line #21: Error inflating class org.apache.cordova.CordovaWebView NullPointerException CordovaWebView.java 行 691

```
int id = getResources().getIdentifier("config", "xml", this.cordova.getActivity().getPackageName()); 
```

似乎资源在这里为空。

我已经检查过了，config.xml 文件在 xml 文件夹中。

我可以在 FragmentActivity 中实现它，但我需要在 Fragment 中实现它。

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-08T15:30:08.153

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {

    View v = inflater.inflate(R.layout.cordovawebview, container, false); // <--- add false parameter
    CordovaWebView webView = (CordovaWebView)v.findViewById(R.id.mainView);

    return v;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-14T21:19:27.583

需要在片段所在的活动以及片段本身上创建 CordovaWebViews。您可以创建自己的 ContextWrapper 并将其提供给您的充气机来为您处理此操作。

这是有关如何做到这一点的分步指南：[https ://github.com/Adobe-Marketing-Cloud/app-sample-android-phonegap/wiki/Embed-Webview-in-Android-Fragment](https://github.com/Adobe-Marketing-Cloud/app-sample-android-phonegap/wiki/Embed-Webview-in-Android-Fragment)

# php - PHP 设置普通变量 更改会话变量

> ID：14088575
> 
> 赞同：6
> 
> 时间：2012-12-30T05:33:10.170
> 
> 标签：php, session, variables

我只是突然开始遇到我见过的最奇怪的问题，除了我网站的主机之外什么都没有改变。我在代码中使用了很多 $_SESSION 变量，这些变量可能与普通变量同名，但设置普通变量似乎是在更改具有相同名称的 $_SESSION 变量。

例如，如果我这样做

```
$_SESSION['favcolor'] = 'blue';
$favcolor = 'green';
echo $_SESSION['favcolor']; 
```

我得到`green`了回应......我怎么不让这种情况发生？我认为很可能有一些 PHP ini 变量必须更改，但我似乎在这方面找不到任何东西......

* * *

**解决方案**

因此，由于我在不同的主机上托管我的网站，所以我必须按照以下方式进行。我创建了一个`php.ini`文件并将其放在我网站文件的根目录中，其中仅包含以下行：

```
register_globals = Off ;notice the capital 'O' in 'Off' 
```

然后在我的 .htaccess 文件中，我将其添加到文件末尾：

```
<IfModule mod_suphp.c>
suPHP_ConfigPath /home/myhostusername/public_html/stumpyinc.com
<Files php.ini>
order allow,deny
deny from all
</Files>
</IfModule> 
```

不再有冲突的变量！我也从这次经历中学到了一些东西，并做了一些进一步的研究；变量和会话变量无论如何都不应该相同。这是一个很好的实践，我将在接下来的编程中开始使用它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T05:37:55.727

好像[`register_globals`](http://php.net/manual/en/security.globals.php)开启了 这将导致像你正在经历的冲突。您的主机可能在配置服务器时忘记关闭它们。一旦他们这样做了，您的问题就应该消失了。

如果他们拒绝将其关闭，请寻找新的主机。不仅应该`register_globals`关闭，而且它们已被弃用，并将在下一版本的 PHP 中删除。

# ios - 导航控制器的 Xcode Visual Storyboard 问题

> ID：14088578
> 
> 赞同：0
> 
> 时间：2012-12-30T05:34:11.947
> 
> 标签：ios, xcode, uistoryboard

[之前的描述已删除]

让我们再试一次。我正在使用 Xcode 的视觉故事板。我正在使用导航控制器场景，它链接到视图控制器场景，然后通过按钮链接到 3 个单独的视图控制器场景。

当我突出显示第一个 View Controller Scene 并启用 Assistant Editor 时，我可以在相邻窗口中对 ViewController.h 或 .m 进行更改。

**问题的核心：** 当我选择 3 个单独的视图控制器场景中的任何一个时，我的助理编辑器会在我期待 ViewController.h 或 .m 时显示“@interface UIViewController.h”。更重要的是，我无法进行任何更改，因为弹出错误“此内容已锁定无法编辑”。

温柔点，我是新人。我确定我只是缺少一些小东西。

* * *

**解决了，感谢评论中的道格拉斯**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T02:12:56.630

在您的 3 个视图控制器中，您是否更改了它们的类？每个人都需要一个特定的 .h 和 .m 文件。如果您不定义一个，则无法更改或编辑任何内容。让我们知道结果如何！

# javascript - 如何测试 Javascript WinRT/Metro 客户端/服务器应用程序？

> ID：14088579
> 
> 赞同：2
> 
> 时间：2012-12-30T05:34:14.880
> 
> 标签：javascript, windows, windows-8, windows-runtime, client-server

我正在开发[一个客户端/服务器 Javascript Windows 8 Metro 应用程序](http://apps.microsoft.com/windows/en-US/app/quiz-clicker/67786fc8-b27b-4ea1-92f5-1ad8abfbeda1)，我使用[Microsoft 的 StreamSocket 示例](http://code.msdn.microsoft.com/windowsapps/StreamSocket-Sample-8c573931)来实现服务器和客户端之间的通信。现在我几乎完成了实现，我不知道如何在我的计算机上对其进行测试，因为似乎不可能多次运行同一个应用程序。你知道这个问题的任何解决方法吗？

一种解决方法（实际上不是解决方案）是将应用程序多次复制到不同的项目中，然后将其中一个作为服务器启动，并将其他的作为客户端启动。即使使用这种方法，我也无法将我的客户端连接到服务器实例。当服务器实例未启动时，客户端尝试连接服务器后，返回此错误消息：

> “由于目标机器主动拒绝，无法建立连接。”

但是，当服务器实例启动并侦听连接时，客户端尝试连接服务器后，它会等待一段时间，然后返回此错误消息：

> “连接尝试失败，因为连接的一方在一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应。”

我知道`localhost`不支持用于将客户端连接到服务器，并且因为我已连接到网络，所以我使用计算机的 IP 地址作为客户端的地址。我还在服务器和客户端中添加了这些功能：

*   互联网（客户端）
*   互联网（客户端和服务器）
*   专用网络（客户端和服务器）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T08:19:21.303

出于`localhost`调试目的，使用`CheckNetIsolation.exe`. 您可以通过调用添加应用程序以免除环回隔离：

```
CheckNetIsolation.exe LoopbackExempt –a –n=myapp_ecet6zh215f62e 
```

最后一部分 ( `myapp_ecet6zh215f62e`) 是`Package family name`您的应用程序的，可以在文件`Packaging`选项卡上找到`Package.appxmanifest`。

您还可以列出所有已豁免的应用程序：

```
CheckNetIsolation.exe LoopbackExempt –s 
```

更多细节`CheckNetIsolation.exe`可以在[这里](http://msdn.microsoft.com/en-us/library/windows/apps/Hh780593.aspx)找到。

但是，从 Visual Studio 运行的所有应用程序都应该已经豁免。也许有防火墙阻止您的两个应用程序实例连接。尝试暂时禁用它，只是为了确定。

没有办法在一台机器上运行应用程序的多个实例，至少我不知道。在您的情况下，我可能会在我的计算机上安装一个虚拟机并从那里运行第二个实例。无论如何，这将是对真实环境的更好模拟，您甚至可以避免处理环回隔离。

# google-chrome - 我可以让 Chrome DevTools Network 一直记录请求吗？

> ID：14088581
> 
> 赞同：4
> 
> 时间：2012-12-30T05:35:12.753
> 
> 标签：google-chrome, google-chrome-devtools

当我打开 DevTools 并切换到网络选项卡时，我看到一条消息“未捕获请求”。然后我需要重新加载页面以查看活动。

有没有办法让这个选项卡始终运行，以便我可以随时点击`F12`并立即开始检查网络请求？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:55:41.490

不幸的是没有。一个站点可能有很多请求，我们将为此功能浪费太多内存，而不能保证此信息是必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-19T01:09:59.813

Chrome 的开发工具不这样做。但是有一些工具可以帮助实现这一结果：

铬插件：

*   [网络嗅探器](https://chrome.google.com/webstore/detail/web-sniffer/ndfgffclcpdbgghfgkmooklaendohaef)
*   [HTTP 跟踪](https://chrome.google.com/webstore/detail/http-trace/idladlllljmbcnfninpljlkaoklggknp)

应用程序（我列出了适用于 Mac 的应用程序）：

*   [查尔斯](https://www.charlesproxy.com/)
*   [代理人](https://proxyman.io/)
*   [Postman 及其拦截器插件](https://www.postman.com/)（不保存响应）

# java - 在加载活动之前加载 Admob 广告，以便它们立即出现而不是 3-5 秒后？

> ID：14088583
> 
> 赞同：4
> 
> 时间：2012-12-30T05:35:14.100
> 
> 标签：java, android, android-activity, admob, ads

我的应用程序的设计方式是，我在主菜单上加载广告，一个“结束”页面，以及一个希望（如果我能解决这个问题）在一个页面上弹出 5 秒钟，然后自动继续到另一个页面。

特别是对于 5 秒后关闭的自动加载页面，有没有办法可以在后台加载广告，并在我更改活动时立即使用它？如果我只有正常的代码，它通常没有足够的时间在继续之前加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T10:49:00.473

在仅弹出 5 秒的页面上显示广告有什么意义？大部分收入来自点击，在这么短的时间内，不要指望任何点击摘录可能是偶然的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:46:12.053

我已经尝试在 BREW 手机上解决这个问题，但它们的能力要差得多，而且我无法真正解决这个问题。我们的解决方案是在我们的应用程序中将 HTML 浏览器显示为屏幕，虽然它在所有尝试中都没有 100% 的加载时间，但它仍然能够产生可观的收入。

我还没有在Android上尝试过。

你能提前创建一个[WebView ，像嵌入网页一样获取 AdMob 广告，然后在 WebView 中显示页面吗？](https://developer.android.com/reference/android/webkit/WebView.html)这不是使用 AdMob SDK。

# iphone - UIScrollview 中的非滚动标签栏

> ID：14088585
> 
> 赞同：0
> 
> 时间：2012-12-30T05:36:12.807
> 
> 标签：iphone, xcode, uitabbar

我有一个 ViewController 并向该视图添加了一个 UIScrollView。现在我想在视图底部有一个标签栏。标签栏项目不包含正在显示的当前视图。所以我选择了 UITabbar 而不是 tabbarController。但是问题是因为当我将标签栏添加到视图时视图是可滚动的，所以它也是可滚动的。我想让标签栏静态，它位于视图的底部。我的 ViewController 及其出口是这样的：

我有一个可滚动的视图（配置文件），我有（搜索，登录）作为标签栏项目，在显示编辑配置文件时默认没有选择。如何在当前视图中添加静态标签栏。目前我是这样的：

我必须考虑任何子视图吗？

任何建议/建议都是可观的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:59:08.140

![在此处输入图像描述](../Images/839a7ab2ea5ff635611e750e04554774.png)为什么不将标签栏保留在滚动视图之外？我的意思是标签栏和顶部之间的滚动视图。

您还可以使用表格视图并设置其页脚......但如果您粘贴屏幕截图，它将帮助您充分

这就是最终构建的样子，我将标签栏放在外面......

# scheme - 为什么'and'和'or'在Scheme中不起作用？

> ID：14088587
> 
> 赞同：3
> 
> 时间：2012-12-30T05:36:53.563
> 
> 标签：scheme, boolean, racket

我`map`用来测试值列表以查看它们是否具有给定的属性。然后，我想看看他们是否都拥有该属性并返回如果他们都`true` [拥有](http://en.wikipedia.org/wiki/If_and_only_if)。

所以我的第一个想法是只给出`and`列表，`(and (list #t #t #f))`但这似乎将整个`(#t #t #f)`视为布尔值 true 并返回它。

所以，我想我可以使用`foldl`. 我知道这`(foldl + 0 (list 1 2 3))`行得通，我认为这也`(foldl and #t (list #t #t #f))`应该行得通……但事实并非如此。

在[DrRacket](http://racket-lang.org/)（使用`#lang racket`）中，我得到错误“ `and: bad syntax in: and`”，这不太有用，但在[Repl.it](http://repl.it/GHX)（使用[BiWaScheme](http://www.biwascheme.org/)）上，我得到错误“ `Error: #<Syntax and> is not a function`”。

所以，我猜这`and`是一个宏？支持这一点，如果我只是评估`+`I get `#<procedure:+>`，但对于`and`I get `and: bad syntax in: and`（扼要地说，`xor`是一个过程但是`or`,`nor`和`nand`不是）。

那么，是宏还是什么（可能是为了方便短路）？如果是这样，将执行“与”操作的布尔*函数是什么？*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-01T12:50:20.920

其他答案已经解释了如何使用`and`“好像”它是一个函数，但原因`and`是宏是为了支持您习惯于其他语言的“短路”行为。例如，`(and #f (display "blah"))`不会打印任何内容，因为`and`一旦看到错误值就会停止。如果`and`是一个函数，它的两个参数都必须在调用它之前进行评估，然后`display`无论如何都会发生。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-30T05:44:19.197

是的，`and`是一个宏。但是你可以把它变成函数

```
(lambda (x y) (and x y)) 
```

如在

```
(foldl (lambda (x y) (and x y)) #t your-list) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-12-03T12:37:36.540

其他答案已经解释了为什么`and`不是直接函数，但语言设计中的深层原因仍有待进一步揭示。

有核心原因：

1.  Scheme 提供函数作为[过程](https://schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-7.html#%_sec_4.1.4)。[过程调用](https://schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-7.html#%_sec_4.1.3)需要操作数的[应用顺序](https://en.wikipedia.org/wiki/Evaluation_strategy#Applicative_order)（除了未指定操作数之间的求值顺序），这是[严格求值](https://en.wikipedia.org/wiki/Evaluation_strategy)的情况，其中所有操作数都需要在调用中求值。
2.  [`and`Scheme 中](https://schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-7.html#%_sec_4.2.1)的表达式需要支持操作数的“短路”求值（“任何剩余的表达式都不求值”在“第一个求值为假值的表达式”之后），即[非严格求](https://en.wikipedia.org/wiki/Evaluation_strategy#Non-strict_evaluation)值的情况，其中并非所有操作数必须在调用中进行评估。

这些使用过程和支持短路评估的要求在逻辑上是不一致的，所以你不能让它们在语言中共存。[宏可以通过扩展](https://en.wikipedia.org/wiki/Evaluation_strategy#Call_by_macro_expansion)支持非严格评估，所以在这里。

但是，上述限制是由于 Scheme 的设计选择造成的。函数和非严格求值的概念在本质上并不冲突。在提供支持非严格评估的“函数”（除了 Scheme 的过程）的语言中，可以实际实现类似的构造。值得注意[的是，作为类似于 Scheme 的派生，Kernel 语言](https://web.cs.wpi.edu/~jshutt/kernel.html)提供了应用组合器（如 Scheme 的过程）和操作组合器（宏的替换，但作为一流的过程，例如允许作为操作数传递给另一个组合器），这可以统称为“功能”。该语言中的标准派生（非原始组合器）包括*两者* `$and?`（作为 Scheme 的`and`宏的操作，`and?`（一个保证操作数总是首先被评估的应用程序，就像一个普通的严格评估函数一样）。Klisp 作为一种实现，在[其主页](http://klisp.org)`$and?`中提供了 的派生作为区别示例。

# c# - 如何在 C# 中为变量创建闭包？

> ID：14088593
> 
> 赞同：1
> 
> 时间：2012-12-30T05:38:10.853
> 
> 标签：c#, closures

以下示例在 1 秒后五次打印数字“5”。

```
for (int i = 0; i < 5; ++i)
{
    EasyTimer.SetTimeout(() => Console.WriteLine(i), 1000);
} 
```

（假设`EasyTime.SetTimeout`行为类似于 JavaScript 的`setTimeout`）

我们如何创建一个闭包`i`，让它记住回调的值？

我知道[如何在 JavaScript 中做到这一点，](https://stackoverflow.com/a/5606076/65387)但我不确定我们是否可以在 C# 中以同样的方式做到这一点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T05:40:04.477

在块内部，将 i 分配给一个新变量 j，并在 lambda 中使用 j，如下所示：

```
for (int i = 0; i < 5; ++i)
{
    int j = i;
    EasyTimer.SetTimeout(() => Console.WriteLine(j), 1000);
} 
```

值得注意的是，这个问题只是因为 lambda*是*一个闭包而出现的`i`，所以它在 lambda 执行时获取值，而不是在创建时获取值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T09:55:34.323

如果您使用的是 C#5.0，您可以编写以下代码：

```
foreach (int i in Enumerable.Range(0, 5))
{
    EasyTimer.SetTimeout(() => Console.WriteLine(i), 1000);
} 
```

它会自动生成局部变量。这仅适用于 foreach 循环，不适用于 for。

# html - IE 9 与 HTML 5 的兼容性

> ID：14088603
> 
> 赞同：0
> 
> 时间：2012-12-30T05:40:59.310
> 
> 标签：html, internet-explorer, css, internet-explorer-9

我创建了一个网站[http://www.gkduniya.com](http://www.gkduniya.com)。使用 Mozilla 和 chrome，类别部分还可以。但是对于 IE 9，类别部分放错了位置。请检查它以获取详细信息。我正在使用下面的 CSS 代码来制作渐变框：

```
 .gradientBoxesWithOuterShadows { 
  height:auto;
  width: 240px; 
   padding: 20px;
  background-color: white; 

/* outer shadows  (note the rgba is red, green, blue, alpha) */
 -webkit-box-shadow: 0px 0px 12px rgba(0, 0, 0, 0.4); 
 -moz-box-shadow: 0px 1px 6px rgba(23, 69, 88, .5);

/* rounded corners */
 -webkit-border-radius: 12px;
 -moz-border-radius: 7px; 
  border-radius: 7px;

 /* gradients */
 background: -webkit-gradient(linear, left top, left bottom, 
 color-stop(0%, white), color-stop(15%, white), color-stop(100%, #D7E9F5)); 
 background: -moz-linear-gradient(top, white 0%, white 55%, #D5E4F3 130%); 
 } 
```

请帮助，以便它也适用于 IE 9。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:26:32.873

哎呀！这是错误的：

```
<!DOCKTYPE HTML> 
```

这种无效的 DOCTYPE 会将 IE9 设置为在“Quirks 模式文档”中运行，除非 IE9 开发人员工具（或其他随机 Windows 设置）更改/强制。

**修复页面，使其成为有效标记**，并[使用验证器*确保*其有效](http://validator.w3.org)。（有趣的是，w3c 验证器将其猜测为 HTML5，而 IE9 将页面默认标记为怪癖。此外，我只能让 IE9 在 IE9/IE7 模式下“看起来明显错误”。）

还要修复 JavaScript 错误，这样它就不会在 IE 中显示一堆令人讨厌的错误消息:(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:44:12.833

对我来说看起来不错，只需添加不带前缀的`box-shadow`就可以了。同样，为背景添加无前缀`gradient`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T05:53:15.893

添加 un 前缀`box-shadow`到您的 css 和 Gradient 问题添加

```
-ms-linear-gradient(top, white 0%, white 55%, #D5E4F3 130%); /* for IE-10 */
filter: progid:DXImageTransform.Microsoft.gradient(startColorStr='#FFF', EndColorStr='#D5E4F3'); /* IE6–IE9 */
linear-gradient(top, white 0%, white 55%, #D5E4F3 130%); /* for all */ 
```

为了进一步简化开发，请参阅 [CSS Gradient Background Maker](http://ie.microsoft.com/testdrive/graphics/cssgradientbackgroundmaker/default.html)

# binary - 串行通信吃掉传入的 ASCII DC1 字符

> ID：14088606
> 
> 赞同：2
> 
> 时间：2012-12-30T05:41:49.700
> 
> 标签：binary, embedded, serial-port

我正在实现一个串行接口，以使用 /dev/ttyS0 与外部硬件进行通信。我已经为 RAW 输入和输出进行了配置，因为数据流采用数据包格式并封装有消息开头、长度字节和二进制数据。传入数据流中的任何 DC1 或 DC3 字符 0x11 或 0x13 都会被 Linux OS（最新的 Ubuntu）吃掉。

我有一台 Windows PC 和 Realterm 监控通信，并在监视器上看到 0x11 和 0x13 字符。据我所知，没有其他丢失的字符。

这是我的串行设置代码（注意 IXON、IXOFF、IXANY 已禁用）：

```
void Ser_Open_Port( unsigned char *port )
{
   tcgetattr(ser_handle, &ser_old_settings);
   tcgetattr(ser_handle, &ser_new_settings);

   // Set Baud Rate
   cfsetospeed(&ser_new_settings, baud); 

   // ~BRKINT - No Flush on Break
   // ~PARMRK, ~IGNPAR - Parity Error result in \0 char
   // ~ISTRIP - No 8th bit Strip
   // ~INLCR - No NL to CR Translate
   // ~IGNCR No Ignore CR
   // ~ICRNL No CR to NL Translate
   // ~IXON - No Software Flow Control on Output
   // ~IXOFF - No Software Flow Control on Output
   // ~IXANY - No Software Flow Control on Output
   // ~INPCK - Ignore Parity Checking
   ser_new_settings.c_iflag &= ~(BRKINT|PARMRK|IGNPAR|ISTRIP|INLCR|IGNCR|ICRNL|IXON|IXOFF|IXANY|INPCK);
   // IGNBRK - Ignore Break
   ser_new_settings.c_iflag |= (IGNBRK); 

   // ~OPOST - Implementation Defined Output Processing Off - Raw Output
   // All Other c_oflag bits are ignored
   ser_new_settings.c_oflag &= ~(OPOST);

   // ~ICANON - Not Canonical Input Mode
   // ~ECHO - No Echo
   // ~ECHOE - No Echo Erase
   // ~ECHONL - No Echo NL
   // ~ISIG - No Signals
   // ~IEXTEN - Implementation Defined Input Processing Off - Raw Input
   ser_new_settings.c_lflag &= ~(ICANON|ECHO|ECHOE|ECHONL|ISIG|IEXTEN);

   // ~PARENB - No Parity
   // ~CSTOPB - 1 stop bit 
   // ~CSIZE - Clear Character Size Bits
   ser_new_settings.c_cflag &= ~(PARENB|CSTOPB|CSIZE);
   // CS8 - Character Size 8 bits
   // CLOCAL -  Ignore Modem Control Lines
   ser_new_settings.c_cflag |= (CS8|CLOCAL); 

   // apply the settings
   tcsetattr(ser_handle, TCSANOW, &ser_new_settings);
   tcflush(ser_handle, TCOFLUSH);

   // Open Serial Port for Read/Write, and Non Blocking
   ser_handle = open(port, O_RDWR | O_NOCTTY | O_NDELAY | O_NONBLOCK);
} 
```

这是我从串行端口缓冲区读取的位置：

```
 ser_charin_count = read( ser_handle, ser_charin, 30);
   if( ser_charin_count > 0 && ser_charin_count != 0xFFFFFFFF)
   {
   // Code to Process Message Bytes Here
   } 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T20:11:20.460

错误在于没有首先打开端口以将 ser_handle 初始化为正确的端口 attr 结构。我将 open 放在子例程的顶部，然后使用 tcgetattr 和 tcsetattr 函数正确修改端口值。

# c++ - 如何轻松地将成员函数实现为模板参数？

> ID：14088607
> 
> 赞同：3
> 
> 时间：2012-12-30T05:42:21.820
> 
> 标签：c++, templates

我想开发一个容器，它可以使用其属性访问成员函数（例如 Name()）对其元素进行排序。我想将其用作以下

```
SortedVector<T, &T::Name> v;
T t;
v.Add(t);
v.FindElementWithName("AName"); 
```

如何声明模板类？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:03:02.077

*除非您只允许一种函数结果类型*，否则没有任何声明允许您设想的简单用法。

有了这个限制，你可以做例如

```
template< class Item, std::string (Item::*)() const >
class SortedVector; 
```

但更一般地说（不支持简单的符号）你可以做

```
template< class Item, class Result, Result (Item::*)() const >
class SortedVector; 
```

无论如何，主要问题是如何利用标准库的类。

我想我可能会使用 a`std::vector`进行存储和 a`std::map`进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T13:10:27.793

这是一些与您想要的非常相似的代码：提供基于单个对象的“keygetter”而不是两个对象的比较器的排序。使用 lambdas 的 C++11x 版本应该相当干净（这是改编自一些旧的 gcc 4.4 代码）。

```
#include <algorithm>
#include <boost/bind.hpp>
#include <boost/function.hpp>
#include <iostream>
#include <string>
#include <vector>

template <
  typename T,
  typename K
> struct sort_by_key_comparator {

  sort_by_key_comparator(boost::function<K(const T&)> keygetter)
    :_keygetter(keygetter){}

  bool operator()(const T& a,const T& b) {
    return (_keygetter(a)<_keygetter(b));
  }

  boost::function<K(T)> _keygetter;
};

// Sort an iterator range based on comparison of
// keys of type K retrieved from ojects of type T
template <
  typename IT,
  typename T,
  typename K
> void sort_by_key(
  IT first,
  IT last,
  boost::function<K(const T&)> keygetter
) {
  sort_by_key_comparator<T,K> cmp(keygetter);
  std::sort(first,last,cmp);
}

class data {

public:

  data(int id,const std::string& txt)
    :_id(id),_txt(txt){}

  int get_id() const {return _id;}

  const std::string& get_txt() const {return _txt;}

private:
  int _id;
  std::string _txt;
};

int main(int,char**) {

  std::vector<data> v;
  v.push_back(data(0,"d"));
  v.push_back(data(3,"c"));
  v.push_back(data(1,"b"));
  v.push_back(data(2,"a"));

  boost::function<int(const data&)> idkey=
    boost::bind(&data::get_id,_1);

  sort_by_key(v.begin(),v.end(),idkey);

  for (size_t i=0;i<v.size();++i) 
    std::cout << v[i].get_id() << ", " << v[i].get_txt() << std::endl;

  std::cout << std::endl;

  boost::function<std::string(const data&)> txtkey=
    boost::bind(&data::get_txt,_1);

  sort_by_key(v.begin(),v.end(),txtkey);

  for (size_t i=0;i<v.size();++i)
    std::cout << v[i].get_id() << ", " << v[i].get_txt() << std::endl;
} 
```

有趣的是，[Python 的排序](http://wiki.python.org/moin/HowTo/Sorting/#Key_Functions)使用了这种“keygetter”风格，而 C++ 的 STL/std 库当然是[基于两个对象的比较器](http://www.cplusplus.com/reference/functional/less/)。Scala[提供了两种样式](http://www.scala-lang.org/api/current/scala/collection/immutable/List.html)（通过`sortBy`和`sortWith`）。

# javascript - Javascript 问题表单值和窗口

> ID：14088608
> 
> 赞同：0
> 
> 时间：2012-12-30T05:43:01.883
> 
> 标签：javascript, html

我正在尝试创建一个用户输入用户名，然后单击按钮的表单。然后它会打开一个窗口，其中包含 url 中的参数，如下所示。

```
<script type="javascript">
function open(id) {
    window.open("http://linkhere.com/~Robby/lcpVote.php?u="+ document.getElementById(id).innerHTML +"&s=" + id + "&a=addVote");
}
</script>
<input type="text" placeholder="MC Username" id="name" style="width:100%"> 
```

当他们点击下面的按钮时，

```
<button class="btn btn-primary" style="width:100%" onclick="open('1')" id="1" href="#">MCServers.org</button> 
```

它打开以下网址

```
http://LINKHERE.COM/~Robby/lcpVote.php?u=USERNAMEFROMFORM&s=IDFROMBUTTON&a=addVote 
```

但是当我使用我的代码单击它时，它只会返回一个白页？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T05:47:47.740

`method="get"`在表格上使用。这将使查询字符串适合您想要的内容，具体取决于表单中的输入名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T05:48:06.757

这是因为您在 onclick 函数中将 1 作为 id 传递。您应该传入输入字段的 id。所以应该是：

```
<button class="btn btn-primary" style="width:100%" onclick="open('name')" id="1" href="#">MCServers.org</button> 
```

其中**name**是您的输入字段 ID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T06:14:10.203

替换`innerHTML`为`value`..

```
window.open("http://linkhere.com/~Robby/lcpVote.php?u="+ document.getElementById(id).value+"&s=" + id + "&a=addVote"); 
```

并替换`1`为`name`..

```
<button class="btn btn-primary" style="width:100%" onclick="open('name')" id="1" href="#">MCServers.org</button> 
```

# java - 图形 - 如何使用方法 create(int x, int y, int width, int height) 和 translate(int x, int y)？

> ID：14088613
> 
> 赞同：0
> 
> 时间：2012-12-30T05:44:58.577
> 
> 标签：java, graphics, awt, translate, java-2d

我试图做我的计算机科学作业，但当我试图使用以下方法时我被困住了。

1.  `public Graphics create(int x,int y,int width,int height)`

    基于此 Graphics 对象创建一个新的 Graphics 对象，但具有新的翻译和剪辑区域。

    参数：

    *   x - x 坐标。
    *   y - y 坐标。
    *   width - 剪切矩形的宽度。
    *   height - 剪切矩形的高度。

2.  `public abstract void translate(int x,int y)`

    将图形上下文的原点转换为当前坐标系中的点 (x, y)。

谁能解释并举例说明如何使用它们？

我试图这样做..

```
public Graphics drawPlayer1()
{
    myPencil.up();
    myPencil.move(-620,300);
    myPencil.down();
    myPencil.fillCircle(20);
    myPencil.up();
    myPencil.move(-590,300);
    myPencil.drawString("Player1: " + player1);
    p1.create(-620,300,40,40);
    return p1;
}//end drawPlayer1 
```

当涉及到 p1.create(-620,300,40,40); 时，它给了我一个 nullPointerException；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:04:15.530

我和安德鲁一起做这个，我从来没有用过`Graphics#create(int, int, int, int)`。不过我确实用过`Graphics#create`。

基本上，create 方法将创建一个新的图形上下文，它是原始的副本。这允许您在不影响原件的情况下操作副本。如果您正在对无法（轻松）撤消的图形执行操作，这一点很重要。

将图形上下文简单“归零”到新位置。Swing 绘制过程对其绘制的每个组件执行此操作。基本上，在`paint`调用之前，图形上下文被翻译到组件位置，这意味着组件内的所有绘制都是从 0x0 完成的

![在此处输入图像描述](../Images/87c186a4c2b4bc8c77557a64472448a1.png)

```
public class TestGraphics01 {

    public static void main(String[] args) {
        new TestGraphics01();
    }

    public TestGraphics01() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new TestGraphicsPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class TestGraphicsPane extends JPanel {

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(400, 400);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            FontMetrics fm = g.getFontMetrics();

            // This creates a "copy" the graphics context, it's translated
            // to the x, y position within the current graphics context
            // and has a width and height.  If the width or height is outside
            // the current graphics context, then it is truncated...
            // It's kind of like clip, except what ever you do to this copy
            // does not effect the graphics context it came from...
            // This would be simular to setting the clipping region, just it 
            // won't effect the parent Graphics context it was copied from...
            Graphics create = g.create(100, 100, 200, 200);
            create.setColor(Color.GREEN);
            create.fillRect(0, 0, 200, 200);
            create.setColor(Color.YELLOW);
            create.drawString("I'm inside...", 0, fm.getAscent());
            create.dispose();

            // But I remain uneffected...
            g.drawString("I'm outside...", 0, fm.getAscent());

            // I will effect every thing draw afterwards...
            g.setColor(Color.RED);
            int y = 50 - (fm.getHeight() / 2) + fm.getAscent();
            g.translate(50, y);
            g.drawString("I'm half way", 0, 0);
            // You must reset the translation if you want to reuse the graphics OR
            // you didn't create a copy...
            g.translate(-50, -y);

            y = 350 - (fm.getHeight() / 2) + fm.getAscent();
            g.translate(300, y);
            g.drawString("I'm half way", 0, 0);
            // You must reset the translation if you want to reuse the graphics OR
            // you didn't create a copy...
            g.translate(-300, -y);

        }

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:22:34.323

对我来说已经很晚了，但我会快速尝试一下。Graphics（或 Graphics2D）实例是图形设备（例如打印机、屏幕等）的抽象。它有一个边界。假设您只想绘制到设备的特定区域，并且您希望代码始终与 (0,0) 相关（例如，精灵在屏幕上移动的游戏）。精灵总是相同的，但它的位置会不同。实现此目的的一种方法是创建一个 Graphics2D，将输出限制为主 Graphics2D 的子集。就是这样

```
public Graphics create(int x,int y,int width,int height) 
```

会为你做的。我认为 Graphics2D 的其他属性也是独立的。这意味着在第二个 Graphics2D 上设置 Paint 不会影响主要的。

```
public abstract void translate(int x,int y) 
```

是关于移动原点（但不是轴的方向）。默认情况下，原点将是设备的左上角。这可以更改为设备内的任何位置。使用上面的精灵在屏幕上移动的例子，只需调用 translate 你想要它绘制的地方，然后绘制它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T05:52:16.857

如果尚未完成，您可以阅读 2D 图形和[javadocs](http://docs.oracle.com/javase/6/docs/api/java/awt/Graphics2D.html)[的 java 教程。](http://docs.oracle.com/javase/tutorial/2d/index.html)

# jquery - 滑动切换效果

> ID：14088614
> 
> 赞同：0
> 
> 时间：2012-12-30T05:45:09.280
> 
> 标签：jquery

我有以下代码：

```
<script type="text/javascript">
function shownavall()
{
$('#shownavall').slideToggle('slow', function() {
 $('.otherlink').toggle(function(){
    $(this).css('background-position', '0px 0px');
     }, function(){
    $(this).css('background-position', '25px 0px');
 });
  });

}
</script> 
```

当我尝试调用该函数时，该函数在`slidetoggle`零件上起作用。但是不改了`css`我`.otherlink`想知道为什么？以及如何解决？

我试图通过使用条件语句来做到这一点，这是我的代码：（此代码根本不起作用！）

```
function shownavall()
{
$('#shownavall').slideToggle('slow', function() {
if ($('.otherlink').css('background-position') == '25px 0px')
{
$(.otherlink).css('background-position', '0px 0px');
}
else 
{
$(.otherlink).css('background-position', '25px 0px');
}
  });
} 
```

我 100% 确定错误出在我的 Jquery 代码中。所以请不要询问html或css。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T07:51:59.053

```
function shownavall()
{
$('#shownavall').slideToggle('slow', function() {
if ($('.otherlink').css('background-position') == '25px 0px')
{
$('.otherlink').css('background-position', '0px 0px');
}
else 
{
$('.otherlink').css('background-position', '25px 0px');
}
  });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:10:42.493

我认为在 CSS 中“背景位置”是正确的，而不是“背景位置”。此外 background -position 更改背景的位置而不是元素本身的位置，因此您必须使用位置属性。

```
 <script type="text/javascript">

  function shownavall()
    {
     $('#shownavall').slideToggle('slow', function() {
     $('.otherlink').toggle(function(){
  $(this).css({'position':'absolute','left':'100px','top':'150px'});

      }, function(){
    $(this).css({'position':'absolute','left':'0px','top':'0px'});
  });
    });

  }

     </script> 
```

# macos - Apple 推送通知和通用 UX 策略——通过非典型途径通知用户的最合理方法是什么？

> ID：14088616
> 
> 赞同：1
> 
> 时间：2012-12-30T05:45:13.553
> 
> 标签：macos, cocoa, design-patterns, apple-push-notifications, user-experience

我正在开发一个小型 Mac OS X 实用程序，该实用程序通过非典型路由（UX 方面）提供某些事件的通知——它通过 ZigBee 接口向外部灯发送消息——我很好奇如何最好地接近 Apple推送通知堆栈。我已经编写了实用程序的主要内容（USB 上的串行端口接口、带状态的守护进程`CFRunLoop`等），但剩下的就是将其与实际事件联系起来。

我还没有编写与任何类型的 APN 接口的代码。如果我希望我的实用程序在例如用户收到电子邮件时做出反应，那么哪种方法最有意义？我是否：

*   运行我自己的电子邮件轮询服务以向客户端发送 APN？
*   订阅现有服务发出的 APNs？
*   以编程方式与 OS X 通知中心应用程序/服务/小部件本身对话？
*   完全避免 APN 以支持其他路由（例如 Mail.app 插件或其他 API）？

可以肯定的是，这是一个普遍的问题——但我完全不确定这些方法中的任何一种的可行性，我希望任何在这个特定领域有经验的人都可以提供任何基本指导。谢谢！

# c - 一次唤醒所有线程，无需互斥锁

> ID：14088620
> 
> 赞同：0
> 
> 时间：2012-12-30T05:46:20.013
> 
> 标签：c, pthreads

我的程序根据行的字段之一在不同的线程中处理数据库行。主线程产生“工人”，执行查询，然后，对于每一行，需要唤醒所有工人，以便其中一个消耗该行。

现在，使用 pthread_cond_broadcast() 似乎是最合乎逻辑的选择。但是，在这种情况下，工作人员都必须*使用相同的 mutex*在 pthread_cond_wait() 内等待。

*在我的情况下，这是次优的，因为这意味着，工人将一次*被唤醒（我不需要） - 而不是*一次全部*唤醒。是的，我确实希望他们*都*醒来——他们都会从新的 DB 行中读取一个字段，之后除了一个之外的所有字段都将返回等待下一行。我不需要同步它们。

我想，我会在每个线程中使用带有 pthread_cond_wait() 的虚拟线程特定互斥锁，但这不起作用（只有一个线程被唤醒）。[标准](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_cond_timedwait.html)说，使用不同的互斥锁等待相同的条件变量（就像我一样）是未定义的。

那么，有没有办法*一次*通知所有线程？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T07:25:25.783

我认为你需要更多地描述这个问题以及为什么你（试图）开始这样做。如果最好的方法是做一些完全不同的事情，不涉及在没有互斥锁的情况下一次唤醒所有线程，我不会感到惊讶。

对我来说，你的描述听起来像：

*   主线程产生几个线程（产生一个线程相对昂贵）
*   主线程进行查询，而生成的线程启动，做的很少，然后阻塞（启动/重新启动和阻塞相对昂贵）
*   对于每一行，主线程唤醒每个线程（相对昂贵的重新启动和阻塞），并且除其中一个之外的每个线程都返回等待（非常浪费）

在不知道您为什么要这样做的情况下，我假设根本不使用任何线程会更快（例如，主线程能够比主线程检查该行并告诉一个人更快地处理一行产生线程来处理它并无缘无故地打扰其他线程）。

如果处理一行需要很长时间，那么我会考虑让工作线程在 FIFO 队列上等待，这样主线程将“处理这一行”命令推送到队列中，而第一个线程从队列进程中获取它那一排。

当然我不知道你为什么要做你想做的事，因此任何建议都只是猜测。

TL; DR：我认为你的问题有点像想减肥的人问“砍掉自己腿的最好方法是什么”（最实际的答案与实际提出的问题无关）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:23:44.297

对于条件变量，假设有一些相关的“条件”（在您的情况下是数据行）需要专门检查和更新（因此是互斥锁）。无论您选择哪种其他机制，您都需要弄清楚如何确保对“工作队列”的独占访问（无论是单个插槽还是真正的队列）。

使用共享队列，数据结构将始终有 2 个写入者（主线程 + 预期工作线程）和 N-1 个读取者。您可以使用读写锁 (rwlock) 来确保完整性。

或者，您可以有 N 个单独的队列（每个工作人员一个）。您会将数据行的副本推送给每个工作人员。

至于一次唤醒多个线程：您可以让您的工作人员“休眠”（例如使用 select()）并使用 pthread_signal()（在循环中）唤醒它们。

您也可以使用[pthread_barrier_wait()](http://pubs.opengroup.org/onlinepubs/009695299/functions/pthread_barrier_wait.html)。

> pthread_barrier_wait() 函数应在屏障引用的屏障处同步参与线程。调用线程应阻塞，直到所需数量的线程调用了指定屏障的 pthread_barrier_wait()。
> 
> 当所需数量的线程调用了指定屏障的 pthread_barrier_wait() 时，常量 PTHREAD_BARRIER_SERIAL_THREAD 应返回给一个未指定的线程，并且零应返回给每个剩余线程。此时，屏障应重置为最近引用它的 pthread_barrier_init() 函数的结果。

1.  [使用pthread_barrier_init()](http://pubs.opengroup.org/onlinepubs/009695299/functions/pthread_barrier_init.html)初始化屏障（count = 1 + # of workers）
2.  在每个worker中，循环调用pthread_barrier_wait()；当它返回时，新数据已准备好
3.  在主线程中，调用 pthread_barrier_wait() 向工作人员发出信号

不幸的是（正如 OP 所指出的），在下一次迭代中，在先前激活的工作人员完成其工作之前，不会唤醒任何工作人员。

一个更简单的架构将使主线程将事件分派给适当的工作人员（而不是唤醒所有工作人员并让他们弄清楚哪个是预期的接收者）。除非您拥有与 worker 一样多的核心，否则测试无论如何都不会真正并行发生。此外，即使您有足够的核心让工作人员并行运行，其中 N-1 也不会在完成测试之前得知“获胜者”已接手工作，因此所有核心的总工作量更高.

# php - 使用 PHP 在保持动画的同时保持 HTML

> ID：14088622
> 
> 赞同：0
> 
> 时间：2012-12-30T05:46:49.123
> 
> 标签：php, html

晚上好，我有一个网站，到目前为止，我正在复制每个页面的导航代码。烦人的权利:)

但是我想使用 PHP 或其他东西来保存 HTML，所以我只需要编辑一个文件。然而，由于导航栏的操作方式，有一个名为的类保持单击的链接突出显示，以向用户显示他们在哪个页面上。

这是代码：

```
<nav>
                    <ul class="menu">
                        <li class="active"><a href="index.html"><strong><strong>Home</strong></strong></a></li>
                        <li><a href="services.html"><strong><strong>services</strong></strong></a>
                          <ul>
                                <li><a herf="services.html">Repairs</a>
                                    <ul>
                                        <li><a href="phonerep.html">Phone Repairs</a>
                                      <li><a href="podrep.html">Ipod Repairs</a>
                                    <li><a href="padrep.html">Ipad Repairs</a>
                                  <li><a href="comprep.html">Computer & Laptop Repairs</a>
                                  </ul>
                                </li>
                                <li><a href="compmain.html">Maintenance & Upgrades</a>
                                    <ul>
                                        <li><a href="compmain.html">Computers & Laptops</a>
                                  </ul>
                              </li>
                              <li><a href="tuition.html">Tutoring</a></li>
                              <li><a href="spechelp.html">Specialist Help</a></li>
                          </ul>
                        </li>
                        <li><a href="iphone.html"><strong><strong>Prices</strong></strong></a>
                            <ul>
                                <li><a href="iphone.html">Iphone</a>
                                 <li><a href="ipod.html">Ipod</a>
                                  <li><a href="ipad.html">Ipad</a>
                                    <li><a href="complap.html">Computer and Laptop</a>
                          </ul>
                        <li><a href="about.html"><strong><strong>about</strong></strong></a></li>
                        <li><a href="contactus.html"><strong><strong>Contact</strong></strong></a></li>
                    </ul>
                </nav> 
```

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:50:39.783

我不打算为你做，但你可以做的很简单就是做这样的事情（当然还有更优雅的方法，但我们在这里坚持 KISS 原则，因为看起来你是新人到 PHP）：

**我的菜单.php**

```
<nav>
  <ul class="menu">
    <li <?PHP if($PAGE == 'home') echo 'class="active">'; ?>><a href="index.html"><strong><strong>Home</strong></strong></a></li>
    <li <?PHP if($PAGE == 'service') echo 'class="active">'; ?>><a href="services.html"><strong><strong>services</strong></strong></a>
    <ul>
      <li <?PHP if($PAGE == 'home') echo 'class="active">'; ?>><a herf="services.html">Repairs</a> <--Type here, should be href, not herf! :-)
[...] 
```

您所要做的就是`$PAGE`在使用适当的字符串在每个页面上调用包含之前定义变量。

**索引.php：**

```
$PAGE = 'home';
include 'myMenu.php'; 
```

**服务.php：**

```
$PAGE = 'services';
include 'myMenu.php'; 
```

* * *

您也可以使用 Javascript，但由于您在 PHP/HTML 标记中发布了此内容，所以我暂时不打扰您！

# android - Android webView 播放 YouTube 视频

> ID：14088623
> 
> 赞同：3
> 
> 时间：2012-12-30T05:46:54.113
> 
> 标签：android, webview, youtube, embed

任何人都可以帮助使用此代码来播放嵌入在网站中的 youtube 视频吗？已经尝试了各种方法，包括清单中的 hardwareAccelerated=true。

webview 显示 youtube 页面和缩略图，但点击它们时没有任何反应。

在某些具有硬件加速的设备上，它播放声音但不播放视频。感谢大家！

```
package com.inglesupdated;

import java.util.ArrayList;

import android.app.AlertDialog;
import android.app.Dialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.graphics.Picture;
import android.net.Uri;
import android.os.Bundle;
import android.view.Gravity;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup.LayoutParams;
import android.webkit.WebChromeClient;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.webkit.WebView.PictureListener;
import android.widget.Button;
import android.widget.LinearLayout;

public class BT_screen_customURL extends BT_activity_base{

    private boolean didCreate = false;
    private WebView webView = null;
    private String dataURL = "";
    private String currentURL = "";
    private String originalURL = "";
    private AlertDialog confirmLaunchInNativeAppDialogue = null;
    private AlertDialog confirmEmailDocumentDialogue = null;

    private String showBrowserBarBack = "";
    private String showBrowserBarLaunchInNativeApp = "";
    private String showBrowserBarEmailDocument = "";
    private String showBrowserBarRefresh = "";

    //////////////////////////////////////////////////////////////////////////
    //activity life-cycle events.

    //onCreate
    @Override
    public void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        this.activityName = "BT_screen_customURL";
        BT_debugger.showIt(activityName + ":onCreate"); 

        //reference to base layout..
        LinearLayout baseView = (LinearLayout)findViewById(R.id.baseView);

        //setup background colors...
        BT_viewUtilities.updateBackgroundColorsForScreen(this, this.screenData);

        //setup background images..
        if(backgroundImageWorkerThread == null){
            backgroundImageWorkerThread = new BackgroundImageWorkerThread();
            backgroundImageWorkerThread.start();
        }           

        //setup navigation bar...
        LinearLayout navBar = BT_viewUtilities.getNavBarForScreen(this, this.screenData);
        if(navBar != null){
            baseView.addView(navBar);
        }

        //inflate this screens layout file...
        LayoutInflater vi = (LayoutInflater)thisActivity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View thisScreensView = vi.inflate(R.layout.screen_customurl, null);

        //add the view to the base view...
        baseView.addView(thisScreensView);

        //reference to the webview in the layout file.

        webView = (WebView) thisScreensView.findViewById(R.id.webView);
        webView.setBackgroundColor(0);
        webView.setInitialScale(0);
        webView.getSettings().setJavaScriptEnabled(true);
        webView.getSettings().setSupportZoom(true);
        webView.getSettings().setBuiltInZoomControls(true);
        webView.getSettings().setPluginsEnabled(true);
        webView.setPictureListener(new MyPictureListener()); 
        webView.setWebChromeClient(new WebChromeClient());
        webView.setWebViewClient(new WebViewClient(){

            @Override
            public boolean shouldOverrideUrlLoading(WebView view, String url){

                //remember the URL...
                currentURL = url;

                //load the URL in the app's built-in browser if it's in our list of types to load...
                if(BT_act_controller.canLoadDocumentInWebView(url)){

                    //load url in built-in browser...
                //  showProgress(null, null);
                    return false;                   

                }else{

                    //ask user what app to open this in if the method returned NO...
                    try{
                        Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
                        startActivity(Intent.createChooser(i, getString(R.string.openWithWhatApp)));  
                    }catch(Exception e){
                        BT_debugger.showIt(activityName + ": Error launching native app for url: " + url);
                        showAlert(getString(R.string.noNativeAppTitle), getString(R.string.noNativeAppDescription));
                    }

                    //do not try to load the URL..
                    return true;                    

                }

            }

            @Override
            public void onPageFinished(WebView view, String url){
                hideProgress();
                BT_debugger.showIt(activityName + ":onPageFinished finished Loading: " + url);
            }

            @Override
            public void onReceivedError(WebView view, int errorCode, String description, String failingUrl) {
                hideProgress();
                showAlert(getString(R.string.errorTitle), getString(R.string.errorLoadingScreen));
                BT_debugger.showIt(activityName = ":onReceivedError ERROR loading url: " + failingUrl + " Description: " + description);
            }           

        }); 

        //fill JSON properties...
        dataURL = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "dataURL", "");
        currentURL = dataURL;
        originalURL = dataURL;

        //button options for hardware menu key...
        showBrowserBarBack = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "showBrowserBarBack", "0");
        showBrowserBarLaunchInNativeApp = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "showBrowserBarLaunchInNativeApp", "0");
        showBrowserBarEmailDocument = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "showBrowserBarEmailDocument", "0");
        showBrowserBarRefresh = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "showBrowserBarRefresh", "0");

        //prevent user interaction?
        String preventUserInteraction = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "preventUserInteraction", "0");
        if(preventUserInteraction.equalsIgnoreCase("1")){
            //can't seem to get Android to "prevent user interaction"...??? 
        }

        //hide scroll bars..
        String hideVerticalScrollBar = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "hideVerticalScrollBar", "0");
        if(hideVerticalScrollBar.equalsIgnoreCase("1")){
            webView.setVerticalScrollBarEnabled(false);
        }
        String hideHorizontalScrollBar = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "hideHorizontalScrollBar", "0");
        if(hideHorizontalScrollBar.equalsIgnoreCase("1")){
            webView.setHorizontalScrollBarEnabled(false);
        }
        String preventAllScrolling = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "preventAllScrolling", "0");
        if(preventAllScrolling.equalsIgnoreCase("1")){
            webView.setVerticalScrollBarEnabled(false);
            webView.setHorizontalScrollBarEnabled(false);
        }       

        //figure out what to load...
        if(dataURL.length() > 1){

            String useUrl = BT_strings.mergeBTVariablesInString(dataURL);
            BT_debugger.showIt(activityName + ": loading URL from: " + useUrl);
            this.loadUrl(useUrl);

        }else{
            BT_debugger.showIt(activityName + ": No URL found? Not loading web-view!");
            showAlert(getString(R.string.errorTitle), getString(R.string.errorLoadingScreen));
        }

        //flag as created..
        didCreate = true;

        /*
         * *******************************************************************

         Notes: This screen has fully loaded it's layout file at this point. 

         BT_activity_base loaded act_base.xml 
         --THEN--
         this screen loaded it's own layout file. 

         JSON properties for this screen from the app's configuration data are 
         available for use. You can read these properties easily using the BT_strings class.

         Example: 
         String thisScreensNavBarTitleText = BT_strings.getJsonPropertyValue(this.screenData.getJsonObject(), "thisScreensNavBarTitleText", "default value here");

         The screens background and title bar were setup using the BT_viewUtilities class:
         BT_viewUtilities.updateBackgroundColorsForScreen() 

         You are free to modify the layout file and extend this screen however you want. 

         ********************************************************************
        */      

    }//onCreate

    //onStart
    @Override 
    protected void onStart() {
        //BT_debugger.showIt(activityName + ":onStart");    
        super.onStart();
    }

    //onResume
    @Override
    public void onResume() {
       super.onResume();
        //BT_debugger.showIt(activityName + ":onResume");

       //verify onCreate already ran...
       if(didCreate){

       }

    }

    //onPause
    @Override
    public void onPause() {
        super.onPause();
        //BT_debugger.showIt(activityName + ":onPause");    
    }

    //onStop
    @Override 
    protected void onStop(){
        super.onStop();
        //BT_debugger.showIt(activityName + ":onStop"); 
    }   

    //onDestroy
    @Override
    public void onDestroy() {
        super.onDestroy();
        //BT_debugger.showIt(activityName + ":onDestroy");  
    }

    //end activity life-cycle events
    //////////////////////////////////////////////////////////////////////////

    //load URL in webView
    public void loadUrl(String theUrl){
        BT_debugger.showIt(activityName + ": loadUrl");
        try{
            webView.loadUrl(theUrl);
        }catch(Exception e){
            BT_debugger.showIt(activityName + ":loadUrl Exception: " + e.toString());
        }
    }

    /*  Hardware Back-Key, uncomment as needed.
        Uncomment this to make the hardware back-key act like a browser back button
        Warning: If you do this the user will need to go "back" the number of times they
        when "forward" to return to the previous screen.
        @Override
        public boolean onKeyDown(int keyCode, KeyEvent event){
            if ((keyCode == KeyEvent.KEYCODE_BACK) && webView.canGoBack()){
                webView.goBack();
                return true;
            }
            //not the back-key..
            return super.onKeyDown(keyCode, event);
        }
    */

    //back button...
    public void handleBackButton(){
        BT_debugger.showIt(activityName + ":handleBackButton");
        if(webView.canGoBack()){
            webView.goBack();
        }else{
            BT_debugger.showIt(activityName + ":handleBackButton cannot go back?");
        }
    }

    //refresh button...
    public void handleRefreshButton(){
        BT_debugger.showIt(activityName + ":handleRefreshButton");
        if(currentURL.length() > 1){
            showProgress(null, null);
            webView.loadUrl(currentURL);
        }else{
            BT_debugger.showIt(activityName + ":handleRefreshButton cannot refresh?");
        }
    }

    //launch in native app button...
    public void handleLaunchInNativeAppButton(){
        BT_debugger.showIt(activityName + ":handleLaunchInNativeAppButton");
        if(currentURL.length() > 1 && originalURL.length() > 1){
            confirmLaunchInNativeApp();
        }else{
            showAlert(getString(R.string.errorTitle), getString(R.string.cannotOpenDocumentInNativeApp));
            BT_debugger.showIt(activityName + ":handleLaunchInNativeAppButton NO url?");
        }
    }

    //handle email button
    public void handleEmailDocumentButton(){
        BT_debugger.showIt(activityName + ":handleLaunchInNativeAppButton");
        showAlert(getString(R.string.errorTitle), getString(R.string.cannotEmailDocument));
        BT_debugger.showIt(activityName + ":handleEmailDocumentButton NO  document to email on URL screens");
    }

    //confirm launch in native app
    public void confirmLaunchInNativeApp(){
        confirmLaunchInNativeAppDialogue = new AlertDialog.Builder(this).create();
        confirmLaunchInNativeAppDialogue.setTitle(getString(R.string.confirm));
        confirmLaunchInNativeAppDialogue.setMessage(getString(R.string.confirmLaunchInNativeBrowser));
        confirmLaunchInNativeAppDialogue.setIcon(R.drawable.icon);

        //YES
        confirmLaunchInNativeAppDialogue.setButton(DialogInterface.BUTTON_POSITIVE, getString(R.string.yes), new DialogInterface.OnClickListener() {
          public void onClick(DialogInterface dialog, int which) {
              confirmLaunchInNativeAppDialogue.dismiss();

              //tell Android to load the URL in the best available Native App...
                try{
                    Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse(currentURL));
                    startActivity(i);
                }catch(Exception e){
                    BT_debugger.showIt(activityName + ": Error launching native app for url: " + currentURL);
                    showAlert(getString(R.string.noNativeAppTitle), getString(R.string.noNativeAppDescription));
                }             
        } }); 

        //NO
        confirmLaunchInNativeAppDialogue.setButton(DialogInterface.BUTTON_NEGATIVE, getString(R.string.no), new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {
                confirmLaunchInNativeAppDialogue.dismiss();
            } }); 

        //show the confirmation box...
        confirmLaunchInNativeAppDialogue.show();
    }       

    //confirm email document
    public void confirmEmailDocumentDialogue(){
        confirmEmailDocumentDialogue = new AlertDialog.Builder(this).create();
        confirmEmailDocumentDialogue.setTitle(getString(R.string.confirm));
        confirmEmailDocumentDialogue.setMessage(getString(R.string.confirmEmailDocument));
        confirmEmailDocumentDialogue.setIcon(R.drawable.icon);

        //YES
        confirmEmailDocumentDialogue.setButton(DialogInterface.BUTTON_POSITIVE, getString(R.string.yes), new DialogInterface.OnClickListener() {
          public void onClick(DialogInterface dialog, int which) {
              confirmEmailDocumentDialogue.dismiss();

              //tell Android launch the native email application...
              Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);  
              emailIntent.setType("plain/text");  
              emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, getString(R.string.sharingWithYou));  
              emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, currentURL);                

              //chooser will propmpt user if they have more than one email client..
              startActivity(Intent.createChooser(emailIntent, getString(R.string.openWithWhatApp)));  

        } }); 

        //NO
        confirmEmailDocumentDialogue.setButton(DialogInterface.BUTTON_NEGATIVE, getString(R.string.no), new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int which) {
                confirmEmailDocumentDialogue.dismiss();
            } }); 

        //show the confirmation box...
        confirmEmailDocumentDialogue.show();
    }       

    //see webView (above) where onPageFinished is loading too soon...
    class MyPictureListener implements PictureListener {
        public void onNewPicture(WebView view, Picture arg1) {
            //BT_debugger.showIt("here" + ":onNewPicture done");
            hideProgress();      
        }    
    }

    /////////////////////////////////////////////////////
    //options menu (hardware menu-button)
    @Override 
    public boolean onPrepareOptionsMenu(Menu menu) { 
        super.onPrepareOptionsMenu(menu); 

         //set up dialog
        final Dialog dialog = new Dialog(this);

        //linear layout holds all the options...
        LinearLayout optionsView = new LinearLayout(this);
        optionsView.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));
        optionsView.setOrientation(LinearLayout.VERTICAL);
        optionsView.setGravity(Gravity.CENTER_VERTICAL);
        optionsView.setPadding(0, 0, 0, 20);

        //options have individual layout params
        LinearLayout.LayoutParams btnLayoutParams = new LinearLayout.LayoutParams(400, LayoutParams.WRAP_CONTENT);
        btnLayoutParams.setMargins(10, 10, 10, 10);
        btnLayoutParams.leftMargin = 10;
        btnLayoutParams.rightMargin = 10;
        btnLayoutParams.topMargin = 0;
        btnLayoutParams.bottomMargin = 10;

        //holds all the options 
        ArrayList<Button> options = new ArrayList<Button>();

        //cancel...
        final Button btnCancel = new Button(this);
        btnCancel.setText(getString(R.string.okClose));

        btnCancel.setOnClickListener(new OnClickListener(){
            public void onClick(View v){
                dialog.cancel();
            }
        });
        options.add(btnCancel);

        //back...
        if(showBrowserBarBack.equalsIgnoreCase("1")){
            final Button btn = new Button(this);
            btn.setText(getString(R.string.browserBack));
            btn.setOnClickListener(new OnClickListener(){
                public void onClick(View v){
                    dialog.cancel();
                    handleBackButton();
                }
            });
            options.add(btn);
        }

        //launch in native app...
        if(showBrowserBarLaunchInNativeApp.equalsIgnoreCase("1")){
            final Button btn = new Button(this);
            btn.setText(getString(R.string.browserOpenInNativeApp));
            btn.setOnClickListener(new OnClickListener(){
                public void onClick(View v){
                    dialog.cancel();
                    handleLaunchInNativeAppButton();
                }
            });
            options.add(btn);
        }   

        //email document...
        if(showBrowserBarEmailDocument.equalsIgnoreCase("1")){
            final Button btn = new Button(this);
            btn.setText(getString(R.string.browserEmailDocument));
            btn.setOnClickListener(new OnClickListener(){
                public void onClick(View v){
                    dialog.cancel();
                    handleEmailDocumentButton();
                }
            });
            options.add(btn);
        }

        //refresh page...
        if(showBrowserBarRefresh.equalsIgnoreCase("1")){
            final Button btn = new Button(this);
            btn.setText(getString(R.string.browserRefresh));
            btn.setOnClickListener(new OnClickListener(){
                public void onClick(View v){
                    dialog.cancel();
                    handleRefreshButton();
                }
            });
            options.add(btn);
        }       

        //refreshAppData (if we are on home screen)
        if(this.screenData.isHomeScreen() && inglesupdated_appDelegate.rootApp.getDataURL().length() > 1){

            final Button btnRefreshAppData = new Button(this);
            btnRefreshAppData.setText(getString(R.string.refreshAppData));
            btnRefreshAppData.setOnClickListener(new OnClickListener(){
                public void onClick(View v){
                    dialog.cancel();
                    refreshAppData();
                }
            });
            options.add(btnRefreshAppData);         
        }       

        //add each option to layout, set layoutParams as we go...
        for(int x = 0; x < options.size(); x++){
            options.get(x).setLayoutParams(btnLayoutParams);
            options.get(x).setPadding(5, 5, 5, 5);
            optionsView.addView(options.get(x));
        }

        //set content view..        
        dialog.setContentView(optionsView);
        if(options.size() > 1){
            dialog.setTitle(getString(R.string.menuOptions));
        }else{
            dialog.setTitle(getString(R.string.menuNoOptions));
        }
        //show
        dialog.show();
        return true;

    } 
    //end options menu
    /////////////////////////////////////////////////////   

} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-10T16:04:36.480

在尝试使用在 10 个 Google 搜索页面上找到的不同解决方案在 WebView 中播放 Youtube 视频 3 天后，一些解决方案有效，但并非适用于所有设备或操作系统版本，我决定以我自己的方式思考。

对我来说，直接在 WebView 上播放视频的解决方案即使在最后一个 Android 设备上也会产生许多工件：Nexus 4 所以，我必须找到一种方法来捕捉 Youtube iframe 上的点击，以便直接启动 Youtube 应用程序iOS 无需任何开发人员的努力即可完美运行。

```
public class MyWebViewClient extends WebViewClient {

    public Activity mActivity;

    public MyWebViewClient(Activity activity) {
        super();
        mActivity = activity;
    }

    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        Uri uri = Uri.parse(url);
        if (uri.getHost().contains("youtube.com")) {
            IntentUtils.viewYoutube(mActivity, url);
            return true;
        }

        return false;
    }

    public static void viewYoutube(Context context, String url) {
        IntentUtils.viewWithPackageName(context, url, "com.google.android.youtube");
    }

    public static void viewWithPackageName(Context context, String url, String packageName) {
        try {
            Intent viewIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
            if (isAppInstalled(context, packageName)) {
                viewIntent.setPackage(packageName);
            }
            context.startActivity(viewIntent);
        } catch (Exception e) {
            Intent viewIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
            context.startActivity(viewIntent);
        }
    }

    public static boolean isAppInstalled(Context context, String packageName) {
        PackageManager packageManager = context.getPackageManager();
        try {
            packageManager.getPackageInfo(packageName, PackageManager.GET_ACTIVITIES);
            return true;
        } catch (NameNotFoundException e) {
        }
        return false;
    }

    @Override
    public void onPageFinished(final WebView view, String url) {
        String javascript = "javascript:" +
            "var iframes = document.getElementsByTagName('iframe');" +
            "for (var i = 0, l = iframes.length; i < l; i++) {" +
            "   var iframe = iframes[i]," +
            "   a = document.createElement('a');" +
            "   a.setAttribute('href', iframe.src);" +
            "   d = document.createElement('div');" +
            "   d.style.width = iframe.offsetWidth + 'px';" +
            "   d.style.height = iframe.offsetHeight + 'px';" +
            "   d.style.top = iframe.offsetTop + 'px';" +
            "   d.style.left = iframe.offsetLeft + 'px';" +
            "   d.style.position = 'absolute';" +
            "   d.style.opacity = '0';" +
            "   d.style.filter = 'alpha(opacity=0)';" +
            "   d.style.background = 'black';" +
            "   a.appendChild(d);" +
            "   iframe.offsetParent.appendChild(a);" +
            "}";
        view.loadUrl(javascript);

        super.onPageFinished(view, url);
    }
} 
```

顺便说一句，我对为向开发人员提供可接受的 WebView 所做的一些努力感到有些不安。

即使我理解希望避免仅基于 HTML 的 Android 应用程序，它始终是在详细信息页面上显示丰富内容的最佳/最快方式。例如，在我的例子中，我管理一个基于 RSS 的应用程序，它允许我的客户自己更改内容。

此外，与 Windows Phone 开发相比，我们必须花费时间将 UI 与网络数据和保存的数据链接起来，在 Windows Phone 开发中，每个数据都直接链接到 UI 组件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-31T11:10:31.567

Thomas G. 的解决方案对我有用，但是我不得不修改 javascript。

```
String javascript = "javascript:" +
                "setTimeout(function() {" +
                "   var iframes = document.getElementsByTagName('iframe');" +
                "   for (var i = 0, l = iframes.length; i < l; i++) {" +
                "       var iframe = iframes[i]," +
                "       a = document.createElement('a');" +
                "       a.setAttribute('href', iframe.src);" +
                "       d = document.createElement('div');" +
                "       d.style.width = iframe.offsetWidth + 'px';" +
                "       d.style.height = iframe.offsetHeight + 'px';" +
                "       d.style.top = iframe.offsetTop + 'px';" +
                "       d.style.left = iframe.offsetLeft + 'px';" +
                "       d.style.position = 'absolute';" +
                "       d.style.opacity = '0';" +
                "       d.style.filter = 'alpha(opacity=0)';" +
                "       d.style.zIndex='" + Integer.MAX_VALUE + "';" +
                "       d.style.background = 'black';" +
                "       a.appendChild(d);" +
                "       iframe.offsetParent.appendChild(a);" +
                "   }" +
                "}, 600);"; 
```

在 onPageFinished 事件解决了三星 Tab 设备上的一个问题之后执行 javascript，如果 js 立即执行，该问题似乎还没有准备好。我尝试了 onload 事件 / $(document).ready 但仍然没有工作。等待 600 毫秒并不理想，但我已经花了足够的时间试图让它工作。

确保 z-index 大于 iframe 的，最简单的方法是将 zIndex 设置为`Integer.MAX_VALUE`

# codeigniter - MySQL 和 CodeIgniter！搜索表单问题

> ID：14088632
> 
> 赞同：0
> 
> 时间：2012-12-30T05:50:18.217
> 
> 标签：codeigniter

谁能给我任何建议，告诉我如何获得一个带有 4 个文本字段的 html 表单来搜索我的数据库并在其中查找任何相关数据并显示它？

基本上，这个表格不必完全填写，用户可以只输入 1 或 2 个字段（例如 first_name 和 last_name），然后模型应该搜索与用户条目相关的其他 2 个缺失字段。

至少必须填写一个字段才能进行搜索操作，该字段可以是 4 个字段中的任何一个（随机）。这些字段被命名为：

名字 姓氏 部门职务

我的数据库中有 3 个包含所需信息的表，它们如下所示：

部门（dept_no，dept_name）员工（emp_no，first_name，last_name）title（emp_no，title）

由于并非所有人都共享相同的主键，因此我的数据库中有另一个表将“部门”表链接到“员工”表。

(departments_employees) => dept_emp(emp_no, dept_no)

我下面的 model.php 文件使用所有这些表来搜索一些数据，但到目前为止，此函数仅搜索与“名字”条目匹配的数据，其余输入字段被忽略。

```
<?php

class Emp_model extends CI_Model {

function find_dept()
{
    $this->db->select('employees.first_name, employees.last_name, departments.dept_name, titles.title');
    $this->db->where('last_name', $this->input->get('lastname'));
    $this->db->join('dept_emp', 'dept_emp.emp_no = employees.emp_no');
    $this->db->join('departments', 'departments.dept_no = dept_emp.dept_no');
    $this->db->join('titles', 'titles.emp_no = employees.emp_no');
    $query = $this->db->get('employees');

    if($query->num_rows > 0)
    {
        return $query->result();

    }

    else
    {
        redirect('find');

    }

}
}

?> 
```

我的视图在表格中显示结果，所以到目前为止一切正常，没有错误。经过数小时的研究，我想不出办法做到这一点。如果有人有我可以遵循的任何想法或类似教程，请告诉我！将非常感激！谢谢 ：）

如果我没有说清楚或需要更多信息，请告诉我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:08:18.590

您可以将数组传递给 CI 活动记录，如果检查所有输入，则必须在其中调用活动记录，然后再获取

```
$inputs = $this->input->post(); // you get an Associative array of post data

extract($inputs); // will extract variables from Associative array.

$where = array();

if(strlen($first_name))
 { 
   $where['first_name'] = $first_name;
 }

   if(strlen($last_name))
 { 
   $where['last_name'] = $last_name;
 }

 if(strlen($dept))
 { 
   $where['dept'] = $dept;
 }

  if(strlen($title))
 { 
   $where['title'] = $title;
 }

 $this->db->where($where);
 $query = $this->db->get('employees'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T06:15:06.960

似乎您非常接近完成您的任务，只是关于您的代码应该提及的几件事。您不应该`$this->input->get('lastname')`直接在模型中使用，您应该在控制器中获取信息并使用以下方式将其传递给模型：

```
function find_dept($firstName, $lastName, $dept, $title) {
   ...
} 
```

这将允许您重用模型函数，而不必依赖将信息发送给它的方法。

```
function find_dept($firstName = false, $lastName = false, $dept = false, $title = false) {
   $this->db->select('employees.first_name, employees.last_name, departments.dept_name, titles.title');

   $this->db->join('dept_emp', 'dept_emp.emp_no = employees.emp_no');
   $this->db->join('departments', 'departments.dept_no = dept_emp.dept_no');
   $this->db->join('titles', 'titles.emp_no = employees.emp_no');

   if($firstName && $firstName !== '')
   {
     $this->db->where('employees.first_name', $firstName);
   }

   if($lastName && $lastName !== '')
   {
     $this->db->where('employees.last_name', $lastName);
   }

   if($dept && $dept !== '')
   {
     $this->db->where('departments.dept_name', $dept);
   }

   if($title && $title !== '')
   {
     $this->db->where('titles. title', $title);
   }

   $query = $this->db->get('employees');
} 
```

为了详细说明codeigniter，我使用了`if($dept && $dept !== '')`因为`$this->input->get('lastname')`如果未设置则返回false，但您可能需要检查它是否等于空字符串。可能有更好的写法

您还`$this->db->like`可以改进您的搜索。查看：[http ://ellislab.com/codeigniter/user-guide/database/active_record.html](http://ellislab.com/codeigniter/user-guide/database/active_record.html)

# google-maps-api-3 - 一键选择两个地图图层

> ID：14088635
> 
> 赞同：2
> 
> 时间：2012-12-30T05:50:52.357
> 
> 标签：google-maps-api-3, google-fusion-tables

是否可以一键选择两个 Google 地图多边形图层。我可以添加两层：建筑物和地块。我可以单独访问每个图层，但是如果我单击建筑物位于宗地图层顶部的地图，则只会检索到建筑物图层。

添加图层的脚本：

```
 var otrParcel = new google.maps.FusionTablesLayer({
    query: {
      select: "'Geometry'",
      from: otrParcLayer 
    },
    suppressInfoWindows: true,
    map: map
  });

  var otrBuilding = new google.maps.FusionTablesLayer({
    query: {
      select: "'Geometry'",
      from: otrBldgLayer
    },
    suppressInfoWindows: true,
    map: map
  }); 
```

我正在尝试通过 1 单击从两个图层中检索 infoWindoHtml。这适用于单独构建和包裹，但不适用于 1 在另一个之上。附件是我尝试执行此操作的最新尝试。当我单击带有包裹的建筑物时，第一个侦听器功能无法正常工作。第二个侦听器功能正常工作。

```
 google.maps.event.addListener(otrBuilding , 'click', function(e) {
    var  infoBubble = new InfoBubble({
      maxWidth: 300
    });
    infoBubble.addTab('Building', e.infoWindowHtml );

    var layer = new google.maps.FusionTablesLayer({
      query: {
        select: "'geometry'",
        from: otrParcLayer,
        where: "ST_INTERSECTS('geometry', CIRCLE(LATLNG(e.latLng), 0.001))",
        limit:1
      } 
    });

    infoBubble.addTab('Parcel', layer.infoWindowHtml);  

    infoBubble.addTab('Contact', contacInfo() );
    if (!infoBubble.isOpen()) {
      infoBubble.setPosition(e.latLng);
      infoBubble.open(map);
    };
  });

  google.maps.event.addListener(otrParcel , 'click', function(e) {
    var  infoBubble = new InfoBubble({
      maxWidth: 300
    });
    infoBubble.addTab('Parcel', e.infoWindowHtml);
    infoBubble.addTab('Contact', contacInfo() );
    if (!infoBubble.isOpen()) {
      infoBubble.setPosition(e.latLng);
      infoBubble.open(map);
    };
  }); 
```

这是我正在测试的页面的链接。加载地图时，我正在使用右下角的建筑物（金刚砂剧院）进行测试。它的中间有一个甜甜圈洞。单击外环应包括建筑物和地块信息（它没有）。点击中间只会显示包裹信息。

[http://fitreks.com/bdcurc/bdcurcMUmockup11.html](http://fitreks.com/bdcurc/bdcurcMUmockup11.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T22:28:33.497

您可以在底层触发点击事件。

不要忘记使用 e-argument 作为 trigger 的第三个参数，否则 event-argument 在回调中不可用。

* * *

# 编辑：

示例：当前图层 otrBuilding 位于顶部，因此您必须在单击时触发 otrParcel 图层的点击事件：

```
google.maps.event.addListener(otrBuilding , 'click', function(e) {
   google.maps.event.trigger(otrParcel , 'click',e);

   //continue with your code
}); 
```

但是看起来会更好，当您将地块层放在顶部时，在单击地块层时触发建筑物层的事件：

```
google.maps.event.addListener(otrParcel , 'click', function(e) {
   google.maps.event.trigger(otrBuilding , 'click',e);

   //continue with your code
}); 
```

请注意：e-argument 包含顶层点击的事件对象。当您只访问事件的 lat 和 lng 时，这没有问题，但是您将无法使用事件访问与图层相关的属性，例如`e.row`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T13:21:47.620

一种选择是在两个图层上设置 {clickable: false}。然后使用地图点击侦听器查询两个表的数据以填充 InfoBubble（而不是使用 FusionTablesLayer 点击侦听器中的可用数据）并使用来自两个查询的回调函数的数据（如果适用）填充 InfoBubble。您可能需要考虑使用单个 InfoBubble，而不是让多个 InfoBubble 保持打开状态。

# c# - 是否可以在没有实现 IEnumerable 的类的情况下在编译时知道元素类型 ?

> ID：14088636
> 
> 赞同：0
> 
> 时间：2012-12-30T05:50:56.097
> 
> 标签：c#, arrays, generics, types

*   概括

    忽略对象不能表示为数组的情况，是否可以定义扩展（静态）方法，例如：

    ```
    public static ? ToArray<TSource>(this TSource source); 
    ```

    并返回一个对象的数组，如果它由任何元素序列组成？如果是，那会是什么`?`？

*   解释

    我考虑过以下声明：

    ```
    public static TElement[] ToArray<TElement>(this IEnumerable<TElement> source); 
    public static ? ToArray<TSource>(this IEnumerable source); 
    ```

    但我不能假设一个未知的类必须实现`IEnumerable<T>`或`IEnumerable`。我什至无法定义`?`它，因为它只是`IEnumerable`超出了一般定义。

    而且我还考虑过`Array`课程：

    ```
    public static Array ToArray<TSource>(this TSource source); 
    ```

    但这意味着元素类型在编译时是未知的。

    所以我想知道是否有可能在没有实现类的情况下在编译时知道元素类型`IEnumerable<T>`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:24:59.457

不幸的是，`IEnumerator`它早于泛型，所以它没有类型信息；只是尝试强制执行您尝试完成的通用实现并不那么吸引人`IEnumerator GetEnumerator()`。`String`

自从我完成 C# 以来已经有很长时间了，但我想：

```
public static TElement ToArray<TSource>(this IEnumerable<TElement> source); 
```

...应该没问题：

```
public static TElement[] ToArray<TElement>(this IEnumerable<TElement> source); 
```

关于扩展方法要记住的重要一点是它们只是语法糖。他们实际上并没有留下来或被注入到他们正在装饰的类型中。它们在编译时被替换为静态方法调用。您使用扩展方法的里程*会*有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T12:41:21.067

你的问题具体是什么？如果您要问是否`IEnumerable`在编译时总是知道 an 中元素的类型，那么答案是“不，并不总是知道”。非泛型 IEnumerable 不强制任何元素类型。这就是为什么你可以`foreach`在 any 上定义一个循环`IEnumerable`：

```
IEnumerable items = GetItems();

foreach(SomeClass item in items)
{
   ...
} 
```

但这将抛出一个`InvalidCastException`if 的元素之一`items`不能转换为 a `SomeClass`。

顺便说一句，如果您定义这样的方法：

```
public static TElement[] MyToArray<TElement>(this IEnumerable<TElement> source); 
```

然后您*可以*`string`在 .NET 2.0+中调用它，因为在 .NET 2.0 和 3.0 以及3.5+ 中`string`实现。事实上，内置在 .NET 中的扩展已经可以在您不定义任何内容的情况下使用。`IEnumerable<string>``IEnumerable<char>``.ToArray()``string`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T13:25:18.480

它在编译时不知道，也不可能知道。

例如我可以这样做：

```
IEnumerable myCollection;
string discriminator = Console.ReadLine();
if (discriminator == "string")
{
   myCollection = new List<string>{"One", "Two", "Three", "Four"};
}
else 
{
   myCollection =  new int[]{1, 2, 3, 4};
}

//what should be the type of the elements variable
var elements = myCollection.ToArray(); 
```

基本上，根据用户输入，`myCollection`将是 a`List<string>`或 an `int[]`, 两种类型，它们几乎没有任何共同点，除了可枚举。

因此，为了让您的`ToArray`方法正常工作，您可以引入类型安全和泛型，使用`IEnumerable<T>`代替`IEnumerable`，或使用对象集合，例如`object[]`方法的返回类型。

# c++ - 在第三方软件中派生没有虚拟析构函数的类

> ID：14088640
> 
> 赞同：2
> 
> 时间：2012-12-30T05:51:24.677
> 
> 标签：c++, virtual-destructor

我得到了一个第三方库，其中包含要使用的标头。现在这个库有一个类'Base'。这个类的问题是它没有虚拟析构函数。现在，由于我没有第三方代码，我无法在那里进行更改。

我被告知用它编写几个派生类，并确保在删除对象时正确清理对象。我们怎样才能做到这一点？

* * *

谢谢回复，看来我只有2个选项。

1）将虚拟析构函数放在派生类中 2）使用组合。

我打算采用第一种方法。我打算使用带有虚拟析构函数的包装派生类。然后使用这个包装派生类进行进一步的派生。下面是代码。

```
//++ THIRD PARTY HEADER
class base
{
public:
    ~base(){ }
};
//-- THIRD PARTY HEADER

//++ MY CODE
// wrapper polymorphic base.
class polymorphic_base
{
public:    
    virtual ~polymorphic_base() { }
};

class derived1 : polymorphic_base
{
/// derived 1
};

class derived2 : polymorphic_base
{
/// derived 2
}

void foo(polymorphic_base *pb)
{
    // use pb
    // use pb
    delete pb;
}

//-- MY CODE 
```

请让我知道这种方法是否可行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T05:59:52.970

如果派生类析构函数`public`是非虚拟的，则意味着第三方的实现者不希望他们的类用于多态继承。

如果您的实施计划有删除基类指针指向的派生类对象的场景，那么没有`virtual`析构函数的基类将导致未定义的行为。
如果您的实施计划没有上述场景，那么您仍然可以从该类派生而不会出现任何问题。

在第一种情况下，由于您没有此基类的代码，因此您无法克服失败。你能做的最好的就是考虑一段`has-a`关系而不是`is-a`关系，并试着让它为你工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:21:01.820

使用`Base`非虚拟的析构函数，如果你必须支持它`delete`，`Base*`那么你就不走运了。

否则，到

> “确保在删除对象时正确清理对象”

只需在派生类中添加一个虚拟析构函数`Derived`。

但是你确定这个要求真的是“当对象被删除时”吗？因为更好的方法是*禁止动态分配*。您可以通过使 - 表达式所需的几乎不可用的东西在代码中执行此操作`new`，例如分配函数（例如，限制其可访问性），并且您可以通过在文档中声明不支持动态分配来更轻松地执行此操作.

如果你能弄清派生类的目的是什么，可能会有更好的解决方案`Base`。也许你不需要类派生。比如说，也许你可以凑合着找一个`Base`成员。

# apache - 如何在 wamp 服务器的 www 文件夹中使用 htaccess？

> ID：14088641
> 
> 赞同：0
> 
> 时间：2012-12-30T05:51:25.477
> 
> 标签：apache, .htaccess, wamp

我想在这样的文件夹中使用 htaccess：

```
C:\wamp\www2\
```

它在 C:\wamp\www\ （wamp 服务器的默认文件夹）中工作，但与上述文件夹无关。
如何让 htaccess 在 www2 文件夹下工作？
我使用 www2 通过 https
OS:win server 2008请求 SSL 请求
。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T07:32:39.163

这可能是因为您没有正确的`<Directory>`指令。您的默认 WAMP 配置中可能有类似的东西：

```
<Directory C:\wamp\www\>
    AllowOverride All
    Order allow,deny
    allow from all
</Directory> 
```

重要的部分是`AllowOverride`。当设置为`All`或特定值时，Apache 将查找 .htaccess 文件并在运行时根据内容进行自我配置。

您可能只需要为您的目录添加一个类似的`<Directory>`部分。`c:\wamp\www2\`

# scala - 如何在 Scala 中实现类型安全的可扩展类型系统？

> ID：14088642
> 
> 赞同：3
> 
> 时间：2012-12-30T05:51:29.840
> 
> 标签：scala, types, extensibility

我正在用 Scala 编写一个项目。该项目涉及一组*特性*和一组*配置*，两者都是可扩展的。“可扩展”是指稍后我将在层次结构中添加新功能，并且它们必须与任何配置一起使用而无需重新编译。这是下图的特征层次结构：

```
trait Feature {
    def apply(board: Board)
}

class Foo extends Feature {
    def apply(board: Board) {
        println(board formatted "Foo: %s")
    }
}

class Bar extends Feature {
    def apply(board: Board) {
        println(board formatted "Bar: %s")
    }
} 
```

配置基本上只是为 a 定义了很多参数`Board`，包括每个`Feature`. 在运行时创建配置有几种可能的策略：预定义的、随机的、使用用户提供的值等。理论上，我希望能够编写这样的东西（不是有效的 Scala 代码！）：

```
abstract class Config(val param: Int) {
    val ConfigParameter: Int
    def featureCount[T <: Feature]: Int
}

object Config {
    def makeBasic(param: Int) = new Config(param) {
        val ConfigParameter = param
        def featureCount[Foo] = 3
        def featureCount[Bar] = 7
    }
    def makeRandom(param: Int) = new Config(param) { ... }
    def makeWithUserValues(param: Int, ...) = new Config(param) { ... }
    def makeByStandardISO1234567(param: Int) = new Config(param) { ... }
}

class Board(val config: Config) { ... } 
```

显然，它不会编译。我的问题是：用 Scala 表示这个可扩展系统的最佳方式是什么？我总是可以在 中包含类似`Map[Class, Int]`的东西，但它不是类型安全的：程序员可以在非s`Config`中插入类。那么，在 Scala 类型系统中是否有一种方法可以表示类似其中的不同键可能是不同子类型的东西？或者，也许有一些方法可以将所有这些行为转移到层次结构中？`Map``Feature``Map[Class[T <: Feature], Int]``Map``Feature``Feature`

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T09:23:57.967

您可以使用`ClassManifest`（`ClassTag`在 Scala 2.10 中）来改进您的地图解决方案：

```
package object features {
  type FeatureMap = Map[Class[_ <: Feature], Int]
}

abstract class Config(val param: Int) {
    def ConfigParameter: Int
    def featureMap: FeatureMap
    def featureCount[T<:Feature]( implicit man: ClassManifest[T] ): Int = 
      featureMap( man.erasure )
}

object Config {
    def makeBasic(param: Int) = new Config(param) {
        val ConfigParameter = param
        lazy val featureMap: FeatureMap = Map(
            classOf[Foo] -> 3,
            classOf[Bar] -> 7
        )
    }
} 
```

每次调用`featureCount`编译器时，都会为您在括号中传递的类型使用正确的 classManifest。该`erasure`方法返回对应的类。

备注：避免抽象 vals，它有烦人的效果，并且会破坏二进制兼容性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T07:44:00.987

我找到了`Map`基于 - 的解决方案（尽管它可能不是最优雅的解决方案）：

```
package object features {
    type FeatureMap = Map[Class[_ <: Feature], Int]
}

abstract class Config(val param: Int) {
    val ConfigParameter: Int
    val FeatureCount: FeatureMap
}

object Config {
    def makeBasic(param: Int) = new Config(param) {
        val ConfigParameter = param
        lazy val FeatureCount: FeatureMap = Map(
            classOf[Foo] -> 3,
            classOf[Bar] -> 7
        )
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T14:45:08.180

您确定需要地图来了解每个键的特定子类型`Feature`吗？例如，我是这样写的：

```
trait Feature { def apply(board: Board) }

case object Foo extends Feature {
  def apply(board: Board) { printf("Foo: %s", board) }
}

case object Bar extends Feature {
  def apply(board: Board) { printf("Bar: %s", board) }
}

// ...
val featureCount: Map[Feature, Int] = Map(Foo -> 3, Bar -> 7) 
```

现在您可以只写`featureCount(Foo)`,`featureCount.get(Bar)`等。您甚至可以键入映射，就`Map[Feature with Singleton, Int]`好像您想确保没有非对象值可以潜入一样。

[或者，如果你真的想要一个以类型为键的地图，你可以用Shapeless](https://github.com/milessabin/shapeless)做这样的事情：

```
trait Feature

case class Foo(count: Int) extends Feature
case class Bar(count: Int) extends Feature

import shapeless._

object featureWithCount extends Poly0 {
  implicit def foo = at(Foo(3))
  implicit def bar = at(Bar(7))
} 
```

进而：

```
scala> featureWithCount[Foo]
res0: Foo = Foo(3)

scala> featureWithCount[Bar]
res1: Bar = Bar(7) 
```

不过，我不确定这对你有什么好处。

# php - AJAX 仅在 JQuery 对话框内失败

> ID：14088645
> 
> 赞同：0
> 
> 时间：2012-12-30T05:52:31.923
> 
> 标签：php, ajax, jquery-dialog

**这个怎么运作**

1.  我有一个名为的页面，该页面`displayRecord.php`加载在 JQuery 对话框中。对话框在里面创建`editTicket.php`

2.  基本上 displayRecord.php 允许用户添加用户名和 ref id，并通过 AJAX`$.post`更新数据库并检索相应表中的记录数。

3.  检索计数器步骤也意味着在页面加载时发生，因此它不仅在用户添加用户名和密码时显示，而且在页面第一次加载时显示。

**什么无法正常工作**

当 displayRecord.php 页面位于 JQuery 对话框内时（或至少我发现的内容），上面的第 3 步失败。如果我转到 URL，它会在加载时显示计数器。第 2 步在对话框中仍然有效。

**从 editTicket.php 调用 JQuery 对话框**：

```
<script type="text/javascript">

var dlg = '';
$(document).ready(function() { 

     dlg=$('#ticketDetails').dialog({
        title: 'TICKET DETAILS',
        resizable: false,
        autoOpen:false,
        modal: true,
        show:'fade',
        hide: 'fade',
        buttons:{ "Close": function() { dlg.dialog("close"); } },
        close: function(e, i) { dlg.hide(); },
        width: 1300   
     });

    $('a.view').click(

        function(e) 
            {    
                dlg.load('displayRecord.php?id='+this.id, function(){ 
                dlg.dialog('open');

            });

        });
}); 
```

**在 displayRecord.php 中加载时调用 showCount 函数：**

```
<?php if (@$data['escalate'] == "No"){ ?>
        <body onLoad="showCount()">
<?php } else{ ?>
        <body>
    <?php } ?> 
```

**显示计数功能：**

```
function showCount(){

    var ticket_id = <?php echo $data['id']; ?>

    $.post('escalationCount.php',{post_ticket_id:ticket_id}, 
    function(data) {
    $('#escalationCount').html(data);
    });
} 
```

由于页面加载功能之前的状态似乎没有在 JQuery 对话框内触发。

在这一点上，我正在努力确定问题的根源。请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:44:14.747

如果我理解正确（我不确定我是否理解）：

```
$('a.view').click(

    function(e) 
        {    
            dlg.load('displayRecord.php?id='+this.id, function(){ 
                <?php if (@$data['escalate'] == "No") { echo 'showCount();' } ?>
                dlg.dialog('open');

        });

    }); 
```

这将在对话框打开时更新计数器。

# javascript - 保存 DOM 相关数据： $("element")[0].prop （或 document.gEbyID("id_element").prop 甚至 $("element").prop(prop)) vs $.data("element “，“支柱”）

> ID：14088648
> 
> 赞同：-2
> 
> 时间：2012-12-30T05:53:03.207
> 
> 标签：javascript, jquery, html, dom

如果对应于特定 DOM 对象的 javascript 元素总是引用同一个 DOM 对象，并且如果访问属性比函数调用更快，那么这样做有什么好处`$.data()`？

我在某处读到了一些关于`$.data()`防止循环引用以防止内存泄漏的内容。

使用普通属性时，什么样的诡计可能会让我陷入那种麻烦？有人可以提供一个例子吗？如果只有 IE 遇到此问题，也许这是鼓励用户切换到更好的浏览器的好方法！

我还假设属性方法的唯一错误是这些内存泄漏，并且还可能破坏 DOM 属性名称。还有其他顾虑吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:49:28.517

> 如果只有 IE 遇到此问题，也许这是鼓励用户切换到更好的浏览器的好方法！

没有很好的方法可以做到这一点。

> 如果与特定 DOM 对象对应的 javascript 元素总是引用同一个 DOM 对象，并且如果访问属性比函数调用更快，那么 $.data() 有什么好处？

访问 HTML5 数据属性，并在元素从 DOM 中移除时移除引用。

# javascript - 如何移动 DOM 中的元素？

> ID：14088650
> 
> 赞同：21
> 
> 时间：2012-12-30T05:53:08.143
> 
> 标签：javascript, jquery, jquery-ui, dom

我在 DOM 中有一个非常互动的元素 #superWidget。它使用 jquery UI 可排序、可拖动和一堆其他插件。

```
<div id="wrapperA"></div>
<div id="wrapperB">
  <div id="superWidget"></div>
</div> 
```

我想改变#superWidget 在DOM 中的位置。我想将其从#wrapperB 中删除并将其放在#wrapperA 中。

```
<div id="wrapperA">
  <div id="superWidget"></div>
</div>
<div id="wrapperB"></div> 
```

我尝试了以下...

```
var copy = $("#superWidget").clone(true, true);
$("#superWidget").remove();
$("#wrapperA").append(copy); 
```

...但是这破坏了很多插件。

我不想重新绑定一切。有一个更好的方法吗？（我注意到 jquery UI sortable 能够以某种方式在 DOM 中移动元素而不会破坏任何交互性......必须有一种方法。）

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-12-30T05:56:15.583

与其复制，不如这样做：

```
document.getElementById('wrapperA').appendChild(document.getElementById('superWidget')); 
```

# ruby - 木偶清单 - 'sudo' 命令？

> ID：14088651
> 
> 赞同：7
> 
> 时间：2012-12-30T05:53:10.277
> 
> 标签：ruby, manifest, puppet, vagrant

我在 Vagrant 中有一个 CentOS 基本盒子，我正拿着一个木偶清单站起来。到目前为止，清单中的内容如下：

```
class base {
    exec { "sudocmd":
        path => ["/usr/bin/","/usr/sbin/","/bin"],
        command => "sudo yum update -y",
    }

    package { "man":
        ensure => present,
    }

    package { "bind":
        ensure => present,
    }

    package { "bind-utils":
        ensure => present,
    }
}

include base 
```

但是当我说 时`vagrant up`，我收到一个错误，sudocmd`yum update`以 1 退出。我在网上查看过，但我还没有找到解决方案。有什么帮助吗？

========EDIT========= 我阅读了答案并同意-谢谢大家。我只是在开发盒上使用它来搞乱，我需要它是最新的，然后才开始研究它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-31T05:49:04.360

使用 puppet，您不需要使用`sudo`，只需直接运行`yum`命令即可。通常命令将默认以 root 身份运行，但您可以指定什么用户。

```
exec { "sudocmd":
    path => ["/usr/bin/","/usr/sbin/","/bin"],
    command => "yum update -y",
    user => root,
} 
```

但是，我强烈建议您不要对`exec`puppet 使用任何类型的非条件。每次 puppet 运行时都会运行。正如[Forrest 已经说过](https://stackoverflow.com/a/14095425)的，这不是 puppet 的设计目的。我不会将 puppet 用于 a `yum update`，而我`exec`的 s 总是有`creates`, `onlyif`，`refreshonly`或者`unless`确保它们仅在需要时运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T22:39:24.543

所以 Puppet 并不是真的要执行像 yum 更新这样的任务。它是一个配置管理工具，而不是完全取代这类任务的东西。此外，您还会遇到很多问题。如果 Puppet 被守护了怎么办？这会对我们的生产环境产生负面影响吗？如果用户意外运行 Puppet 并更新了破坏我们脚本（JDK、MySQL、PHP 等）的包，会发生什么情况。据我所知，没有解决方案，因为它并不是真正的问题。Scott Pack 在[Serverfault](https://serverfault.com/questions/411049/how-to-yum-update-aptitude-safe-upgrade-many-hosts)上为类似问题提供了一个非常描述性的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-24T23:28:09.940

更新“路径”属性对我有帮助。sudo 和 apt-get 命令在**/usr/bin/**路径中可用

```
exec { 'autoclean':
        command   => 'apt-get autoclean',
        path      => '/usr/local/bin/:/bin/:/usr/bin/',
        cwd       => '/home',
} 
```

我的木偶版本：5.5.1

# wpf - 绑定到数据模板中的集合命令

> ID：14088652
> 
> 赞同：1
> 
> 时间：2012-12-30T05:53:14.167
> 
> 标签：wpf, binding, command, datatemplate

我有一个带有集合作为其数据上下文的列表框，并且我已经定义了一个数据模板以具有集合项的特定视图。

我想在集合级别执行可能适用于某些项目或不适用的命令，并希望在数据模板中使用它们。有很多代码要插入，但希望这张图能给你一个大概的想法。

![在此处输入图像描述](../Images/85b1402bc87636a9d1ddece64b57a28a.png)

如何在集合级别绑定到命令的数据模板中定义此类命令，以及如何知道哪个项目发送了命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T14:13:28.570

我终于在下面的文章中找到了解决方案：

[MVVM 应用程序中父子场景中 DataTemplate 内的命令绑定](http://www.codeproject.com/Articles/159939/Command-Binding-inside-DataTemplate-in-Parent-Chil)

阿米特·库马尔·杜塔

# r - 将月、日和无年转换为时间序列

> ID：14088654
> 
> 赞同：1
> 
> 时间：2012-12-30T05:54:37.787
> 
> 标签：r

我有一个中等大小的数据集，下面是一个取自数据集的示例：

```
2011.2012
9/7 
11/5
12/15
1/5
2/5 
```

我想将此数据转换为时间序列格式。

在将它们从因子转换为字符后，我使用了 as.Dates 函数，但我遇到了一个小故障。

结果假设缺少的年份是当前年份。我的目标是能够将 1/1 之前的日期转换为 2011 年，将 1/1 之后的日期转换为 2012 年。数据范围介于 2011 年 9 月和 2012 年 4 月之间。

我试过使用 origin 和 start ，但无济于事。这是我的代码：

```
date1 <- as.character(2011.2012)
date1 <- as.Date(date1, format="%m/%d") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T06:11:06.877

六月/七月分手怎么样？这取决于您的日期格式。

```
> x=c("9/7", "11/5", "12/15", "1/5", "2/5" )
> sapply(strsplit(x, '/')
         , function(x) paste(if(as.numeric(x[1]) > 6) 2011 else 2012, x[1], x[2]
                             , sep="/"
                            )
        )

[1] "2011/9/7"   "2011/11/5"  "2011/12/15" "2012/1/5"   "2012/2/5" 
```

这是上述的矢量化方法，它使用`ifelse`而不是`if`：

```
mm <- matrix(nrow=2, unlist(strsplit(x, '/')))
paste(ifelse(as.numeric(mm[1,]) > 6, 2011, 2012), mm[1,], mm[2,], sep='/')

[1] "2011/9/7"   "2011/11/5"  "2011/12/15" "2012/1/5"   "2012/2/5" 
```

矢量化方法可读性较差，但速度更快（1.7x）。

这是您可以矢量化@MarkMiller 的方法的一种方法，使用这些`Date`函数并在当月寻找回归：

```
initialYear <- 2011

dd <- as.Date(x, "%m/%d")
mon <- format(dd, "%m")
as.Date(paste(initialYear + c(0, cumsum(diff(as.numeric(mon))<0))
                , mon
                , format(dd, "%d")
                , sep="-"
                )
          )

[1] "2011-09-07" "2011-11-05" "2011-12-15" "2012-01-05" "2012-02-05" 
```

可能是因为所有`Date`函数的原因，这比上面的矢量化方法运行时间长 3.6 倍（如果去掉 final`as.Date`则为 2.6 倍），仅限于 2011 年和 2012 年。我没有测量 Mark 的代码，但它可能比上面更快三个`sapply`和一个显式`for`循环。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T07:19:53.847

这是我想出的。我不知道这段代码是否总是有效，但它似乎适用于我使用的示例数据集。该代码似乎可以处理 >2 年和一年中的任何一天。

该代码无法处理没有数据的年份，但如果年份不在数据集中，那么无论如何都可能无法识别这样的差距。

另请注意，如果这两个日期来自连续两年，则此方法将因以下两个日期而失败：“1/30”和“3/1”。那是因为两个日期之间的差距如此之长，以至于计算机无法意识到这两个日期不是来自同一年。

换句话说，如果两个连续日期之间有很长的间隔，任何方法都可能在没有额外信息的情况下失败。例如，如果每个季度或半年至少有一个日期，那么我认为两个发布的答案都会起作用，因为计算机将能够识别出连续几个月的减少表示新的一年。

如果两个连续日期之间的最长间隔是 11 个月，那么这两种方法都可能会起作用。如果将代码修改为同时检查两个连续日期中的每个日期的月份日期，那么 363 天的间隔可能是可以的。

```
# specify the initial year and create dates from the data

initial.year = 2010

date  <- c("12/30", "1/1", "6/1", "6/1", "10/25", "11/27", "12/28", 
           "1/16", "2/17", "2/17", "2/17")

DDD3  <- as.Date(date, format="%m/%d")

# deconstruct dates into month, day and erroneous year

dtstr <- as.character(DDD3)
month <- as.numeric(as.character(sapply(strsplit(dtstr, "-") , "[", 2)))
day   <- as.numeric(as.character(sapply(strsplit(dtstr, "-") , "[", 3)))
year  <- as.numeric(as.character(sapply(strsplit(dtstr, "-") , "[", 1)))
DDD4  <- data.frame(month, day, year)

# obtain correct year for each date

year2=rep(NA, nrow(DDD4))
year2[1] = initial.year

for(i in 2:length(year2)) { 

    if(DDD4[i,1] <  DDD4[(i-1),1]) (year2[i] = year2[(i-1)]+1)
    if(DDD4[i,1] >= DDD4[(i-1),1]) (year2[i] = year2[(i-1)])

}

# create new dates using correct year

day2 <- sprintf("%02d", day)
month2 <- sprintf("%02d", month)
year2 <- as.character(year2)

DDD5 <- data.frame(month2, day2, year2)
DDD6 <- paste(DDD5[,1], DDD5[,2], DDD5[,3], sep='/')
DDD7 <- as.Date(DDD6, "%m/%d/%Y")
DDD7

# [1] "2010-12-30" "2011-01-01" "2011-06-01" "2011-06-01" 
#     "2011-10-25" "2011-11-27" "2011-12-28" "2012-01-16"
#     "2012-02-17" "2012-02-17" "2012-02-17" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T16:54:33.887

我发布了这个可以称为矢量化方法的方法，与目前提供的方法不同。我认为`ifelse`是伪向量化，因为需要构造然后选择三个向量。

```
 dat <- read.table(text="2011.2012
 9/7 
 11/5
 12/15
 1/5
 2/5", header=TRUE)

dat$date1 <- as.Date(dat$X2011.2012, format="%m/%d") 
dat$GT <- c(FALSE, diff(dat$date1) < 0)
startyr <- cumsum( as.numeric( substr(names(dat)[1], 2,5) ) )
dat$truedate <- paste( format(dat$date1, format="%m/%d") , 
                      dat$GT+startyr, sep="-")  
 dat
#-------------------------
  X2011.2012      date1 GT   truedate
1        9/7 2012-09-07  0 09/07-2011
2       11/5 2012-11-05  0 11/05-2011
3      12/15 2012-12-15  0 12/15-2011
4        1/5 2012-01-05  1 01/05-2012
5        2/5 2012-02-05  1 02/05-2012 
```

我认为将第一行作为标题读取是完全合法的，但如果需要，使用操作的替代方案`cumsum`仍应`diff.Date`“矢量化”。这不仅限于两年，而且即使每年只有一个日期，也应该是成功的。

# matlab - Matlab低通滤波器输出初始/结束值

> ID：14088658
> 
> 赞同：3
> 
> 时间：2012-12-30T05:55:12.780
> 
> 标签：matlab, filter, lowpass-filter

我有一个带有不需要的振荡载波的信号，如蓝色曲线所示。我做了一个低通滤波器（五阶巴特沃斯）并应用了`filtfilt`函数，低滤波输出是红色曲线。

```
[b,a] = butter(5,.7);
y = filtfilt(b,a,y); 
```

![在此处输入图像描述](../Images/963bb45fca4d2d43e071e4d8c572caaa.png) 从 x 值 500 到结束的红色曲线正是我想要的，但是初始振荡仍然存在。似乎过滤器函数试图匹配过滤器输入和输出的初始/结束值，因此振荡保留。有没有办法使初始值不匹配，这样我就可以获得平滑的输出而没有任何振荡？

更新：我认为我的问题不清楚。我想要黑色曲线（手绘）之类的东西：完全消除振荡，并且不匹配初始值。我怎样才能做到这一点？![在此处输入图像描述](../Images/fc27463d01c53ac124fdb520315b00d4.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T06:26:01.530

简短的回答是，你所问的是不可能的。

所有过滤器都需要一些时间来“预热”——这被称为过滤器的“上升时间”。发生这种情况是因为`n`阶滤波器对最后一个样本执行加权平均`n`，并且当信号第一次开始时，该积压的样本不可用。

你在那里的滤波器实际上有一个相当好的上升时间——只需要大约 10 个样本就可以开始正确跟踪输入。

发生的振荡被称为“过冲”——在设计滤波器时，需要在上升时间和过冲之间进行权衡，不能有快速上升时间和没有过冲。[关于阻尼](http://en.wikipedia.org/wiki/Damping)的维基百科文章可能对您来说是一个很好的资源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T07:23:01.767

遇到这个问题时，我经常做的是在滤波信号之前创建一个启动信号。

对于低通滤波器来说，这是一项相对容易的任务，但取决于您的原始信号。我最初的尝试是反映关于原点的部分信号：

```
[b,a] = butter(5,.7);
N = 50; % change this to suit your needs
    yNew = filtfilt(b,a,[y(N:-1:1);y];
yNew = yNew(N+1:end); 
```

这确保了最小的启动，并且您可以“开始运行”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T09:38:30.523

阅读以前的答案和评论，似乎过滤并不是这个特定问题所寻求的答案。

您是否考虑过用一些参数曲线拟合信号？由于所寻求的曲线位于信号中间（没有“异常值”），因此最小二乘拟合似乎可以做得很好。

```
% assuming y is your signal
% fit polynomial of degree Deg
Deg = 5; 
x = linspace(0,1, numel(y));
p = polyfit( x, y, Deg );
figure('Name','fit poly');
plot( y, '-+b');
hold all;
plot( polyval( p, x ), ':k', 'LineWidth', 1.2 ); 
```

我曾经`polyfit`在`Deg=5`这个例子中，但你可能会考虑不同的功能和不同的程度。

您可能会找到`fit`一个有用的工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T16:47:46.473

在应用黄油过滤器之前尝试使用 sgolay 过滤器（订单 1 就足够了）。Sgolayfilter 用它的基本多项式近似拟合初始点（1 阶线）。请参阅与您的数据类似的示例

```
tt=0:1000;
toto=cos(.3*tt).*cos(tt*pi/4000)-tt/500+sin(pi*tt/1000);
[B,A]=butter(4,.02);
plot(tt,toto,tt,filtfilt(B,A,toto),'r',tt,filtfilt(B,A,sgolayfilt(toto,1,51)),'k'); 
```

希望它仍然有帮助。

# css - 有序列表 - 设置 li 翻转上的数字？

> ID：14088662
> 
> 赞同：3
> 
> 时间：2012-12-30T05:56:02.967
> 
> 标签：css, html-lists

我已经对有序列表进行了样式化，以在列表编号周围显示一个圆角框。我感兴趣的是让这个盒子在 li 悬停时改变颜色。

见小提琴 - [http://jsfiddle.net/CH74M/](http://jsfiddle.net/CH74M/)

```
<ol class="testing">
    <li>Test number 1</li>
    <li>Test number 2</li>
    <li>Test number 3</li>
</ol>

ol.testing {
    counter-reset:li; /* Initiate a counter */
    margin:0 0 0 45px;
}
ol.testing > li {
    position:relative; /* Create a positioning context */
    margin:0 0 30px 2em; /* Give each list item a left margin to make room for the numbers */
    padding:3px 8px; /* Add some spacing around the content */
    list-style:none; /* Disable the normal item numbering */
}
ol.testing > li:before {
    content:counter(li); /* Use the counter as content */
    counter-increment:li; /* Increment the counter by 1 */
    /* Position and style the number */
    position:absolute;
    top:-2px;
    left:-2em;
    font-size:15px;
    -moz-box-sizing:border-box;
    -webkit-box-sizing:border-box;
    box-sizing:border-box;
    -moz-border-radius:4px;
    -webkit-border-radius:4px;
    border-radius:4px;
    width:2em;
    /* Some space between the number and the content in browsers that support
   generated content but not positioning it (Camino 2 is one example) */
    margin-right:8px;
    padding:4px;
    color:#fff;
    background:#2363a1;
    font-weight:bold;
    text-align:center;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:04:00.910

你可以这样做

```
ol li:hover:before { 
   color: red; 
} 
```

[![jsFiddle](../Images/827f57786617d886d70c0bce0ccca6b6.png)](http://jsfiddle.net/Pq22X/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T06:06:11.057

使用 :hover before :before 你可以做到

```
ol.testing > li:hover:before {
  color: #090;
} 
```

[http://jsbin.com/ifeyaw/1/](http://jsbin.com/ifeyaw/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T06:03:24.203

刚刚将这一位添加到代码中

```
ol.testing > li:hover:before {
    background:#000000;
} 
```

**jsfiddle** [http://jsfiddle.net/CH74M/1/](http://jsfiddle.net/CH74M/1/)

我不确定您要支持哪些浏览器，但基于[http://quirksmode.org/css/contents.html](http://quirksmode.org/css/contents.html)之前仅适用于 ie8 及更高版本的所有浏览器，悬停也是如此，这应该不是问题

# ruby-on-rails - Rails API 应用程序：（无 MethodError）当我运行工头启动时

> ID：14088669
> 
> 赞同：2
> 
> 时间：2012-12-30T05:58:45.993
> 
> 标签：ruby-on-rails, ruby, api, foreman

我刚刚创建了一个新的 Rails API 应用程序，我第一次尝试运行它。我安装了工头 gem，我正在使用命令

```
 foreman start 
```

启动服务器，但我收到这些错误：

```
 Exiting
 21:52:55 web.1  |
 /Users/AM/Documents/RailsWS/app1229/config/initializers/wrap_parameters.rb:8:in 
 `block in <top (required)>':
 undefined method `wrap_parameters' for ActionController::API:Class (NoMethodError)
 21:52:55 web.1  |  
 from /Users/AM/.rvm/gems/ruby-1.9.3-p194-gemset/gems/activesupport-
 3.2.8/lib/active_support/lazy_load_hooks.rb:36:in `instance_eval'
 21:52:55 web.1  |  
 from /Users/AM/.rvm/gems/ruby-1.9.3-p194-gemset/gems/activesupport- 
 3.2.8/lib/active_support/lazy_load_hooks.rb:36:in `execute_hook'
 21:52:55 web.1  |  
 from /Users/AM/.rvm/gems/ruby-1.9.3-p194-gemset/gems/activesupport-
 3.2.8/lib/active_support/lazy_load_hooks.rb:26:in `block in on_lo
  .......... 
```

我已经尝试更新 gemset 并重新评估终端等。

然而，没有任何工作。想知道是否有人可以提供有关如何继续诊断此错误来源的想法

谢谢

* * *

编辑这里是 ApplicationController.rb 的内容

```
 class ApplicationController < ActionController::API 
   include ActionController::MimeResponds 
   include ActionController::ImplicitRender 

 end 
```

宝石文件：

```
 source 'https://rubygems.org'
 gem 'rails', '3.2.8'
 gem 'rails-api'
 gem 'pg'
 gem 'thin'
 gem 'foreman'
 gem 'rabl'
 gem "paperclip"
 gem 'aws-sdk'
 group :development do
gem 'annotate', :git=>'git://github.com/ctran/annotate_models.git'
gem 'debugger'
 end 
```

错误指向此文件中的第 8 行：wrap_parameters.rb

```
 # Be sure to restart your server when you modify this file.
 #
 # This file contains settings for ActionController::ParamsWrapper which
 # is enabled by default.

 # Enable parameter wrapping for JSON. You can disable this by setting :format to an    
   empty array.
 ActiveSupport.on_load(:action_controller) do
   ERROR >>>>  wrap_parameters format: [:json]
 end

 # Disable root element in JSON by default.
  ActiveSupport.on_load(:active_record) do
  self.include_root_in_json = false
 end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-11T10:51:03.633

The problem in the wrap_parameters is fixed in version 0.0.3 of rails-api, but for previously generated applications we have to substitute the first block of code in initializers/wrap_parameters.rb for this one:

```
ActiveSupport.on_load(:action_controller) do
  include ActionController::ParamsWrapper
  wrap_parameters format: [:json] if respond_to?(:wrap_parameters)
end 
```

I've tested it right now in one of my heroku apps and works perfectly. No need to rewrite the code in full featured rails anymore :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:06:35.673

你`Procfile`的 Rails 项目目录的根目录中有一个吗？对于最简单的设置，我的 Procfiles 通常如下所示：

```
web: bundle exec thin start -p $PORT 
```

（当然`gem 'thin'`，您的 Gemfile 中也需要。）

# c# - 使用正则表达式将房屋编号替换为房屋编号

> ID：14088672
> 
> 赞同：1
> 
> 时间：2012-12-30T05:59:27.447
> 
> 标签：c#, regex

我想在地址字符串中查找并替换门牌号。地址字符串如下

1.  34 号房屋 45 号街道 防御路
2.  房子 #334 Street #323 Bangla 133

所以，我想找到用字符串 House no 替换不同变体的 House number。

门牌号的不同变化如下：

1.  房屋编号
2.  何。不
3.  H＃
4.  房子 ＃
5.  何#
6.  何不。

我尝试使用以下正则表达式来实现这一点，但对于大多数门牌号字符串变体来说它都失败了。

```
string hno_regex =  ((i?)h.[^#]*.); 
```

您能否建议一个正则表达式来查找门牌号字符串的变化..？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:03:25.903

我建议这样做：

```
hno_regex = @"(?i)\bH(?:o(?:use\b|\.)?)?\s*(?:#|\bno\b\.?)"; 
```

**解释：**

```
(?i)   # case-insensitive mode on
\b     # Match a word boundary (start of word)
H      # Match H
(?:    # Try to match...
 o     # an o
 (?:   # followed by...
  use  # "use"
  \b   # (end of word)
 |     # or
  \.   # a dot.
 )?    # Make that part of the match (use|.) optional
)?     # as well as the previous part (o).
\s*    # Match optional whitespace
(?:    # Try to match
 [#]   # a hash mark
|      # or
 \b    # (start of word)
 no    # "no"
 \b    # (end of word)
 \.?   # optional dot.
)      # (End of alternation) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T13:50:33.343

你可以直接做。只需将所有匹配项放在一个组中即可。

regex="\bH(ouse 编号|o. No|#|ouse #|o #|o no.)"

房子号何。没有H#House#Ho#Ho没有。

# php - 在网站上通过 twitter 登录后，如何从 Facebook 获取数据？

> ID：14088679
> 
> 赞同：-1
> 
> 时间：2012-12-30T06:00:24.437
> 
> 标签：php, facebook-graph-api, twitter, twitter-oauth

我已经看到它完成了，这是很有可能的。在 Klout.com .. 例如，如果您通过 Twitter 登录，您会被重定向到您的个人资料，然后如果您希望将您的 facebook 帐户连接到 Klout.com，您单击 Facebook 连接，然后它们会合并两个帐户，您可以看到你的推文和 Facebook 状态，我认为这很酷。我正在尝试在我的网站上实现它。我知道如何通过 API 获取我的 facebook 朋友和 twitter 关注者，但我不知道如何将两个帐户合并在一起，以便我可以在我的网站上拥有这两个数据。

有人可以帮助我如何去做吗？现在，我试着去做。通过twitter API及其会话在我的网站上通过twitter登录，并且我通过twitter登录后添加了facebook登录按钮，facebook按钮有效，但facebook数据无法显示在同一会员区的twitter数据中页 。我非常感谢您在如何完成此操作方面提供的帮助。非常感谢。

```
<?php
session_start();
require_once('../madscore/twitter/twitteroauth/twitteroauth.php');
require_once('../madscore/twitter/config.php');
require('../madscore/database/connect.php');

/* If access tokens are not available redirect to connect page. */
if (empty($_SESSION['access_token']) || empty($_SESSION['access_token']['oauth_token']) || empty($_SESSION['access_token']['oauth_token_secret'])) {
    header('Location: ./clearsessions.php');
}
/* Get user access tokens out of the session. */
$access_token = $_SESSION['access_token'];

/* Create a TwitterOauth object with consumer/user tokens. */
$handle = new TwitterOAuth(CONSUMER_KEY, CONSUMER_SECRET, $access_token['oauth_token'], $access_token['oauth_token_secret']);

?>

<?php
    require "../madscore/authentication.php";
   // $config['baseurl'] ="../index3.php";

    //if user is logged in and session is valid.
    if ($fbme){
        //Retriving movies those are user like using graph api
        try{
            $movies = $facebook->api('/me/movies');
            $pages = $facebook->api('/me/likes');

        }
        catch(Exception $o){
            d($o);
        }

        //Calling users.getinfo legacy api call example
        try{
            $param  =   array(
                'method'  => 'users.getinfo',
                'uids'    => $fbme['id'],
                'fields'  => 'name,current_location,profile_url',
                'callback'=> ''
            );
            $userInfo   =   $facebook->api($param);
        }
        catch(Exception $o){
            d($o);
        }

        //update user's status using graph api
        if (isset($_POST['tt'])){
            try {
                $statusUpdate = $facebook->api('/me/feed', 'post', array('message'=> $_POST['tt'], 'cb' => ''));
            } catch (FacebookApiException $e) {
                d($e);
            }
        }

        //fql query example using legacy method call and passing parameter
        try{
            //get user id
            $uid    = $facebook->getUser();
            //or you can use $uid = $fbme['id'];

            $fql    =   "SELECT pic_square
FROM user 
WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me())";
            $param  =   array(
                'method'    => 'fql.query',
                'query'     => $fql,
                'callback'  => ''
            );
            $fqlResult   =   $facebook->api($param);
        }
        catch(Exception $o){
            d($o);
        }
    }
?>

// This displays my twitter followers , and it works .. but below this code when i try to actually display data from facebook , nothing happens ..
<?php
$followers = $handle->get('friends/list', array('screen_name' => $screen_name));
         $json  = json_encode($followers);
         $array = json_decode($json, true); 

                              shuffle($array);

                          if(is_array($array))
                             {

                               foreach($array as $value)

                               {

                                 if(is_array($value))
                                   {
                                     foreach($value as $key => $second)

                                      {
                                         if(is_array($second))
                                          {
                                            foreach($second as $key_second => $third)

                                                if($key_second !='profile_image_url')
                                                {
                                                     unset($key_second);
                                              }

                                             else

                                              {

                                                   echo "<img src='".$third."' width='100' height='100'/>";
                                             }

                                           }

                                     }

                             }

                        }
                  }  

?> 
```

测试facebook数据是否在这里返回..没有任何反应..

```
<?php var_dump($fbme); ?> 
```

这是 facebook 的 require 语句中的身份验证文件

```
<?php
    $fbconfig['appid' ]  = "314286708589099";
    $fbconfig['api'   ]  = "314286708589099";
    $fbconfig['secret']  = "8f803e0f9e9da4f2ba9f23ad3bd00ded";

    try{
        include_once "../madscore/facebook/facebook-sdk/src/facebook.php";
    }
    catch(Exception $o){
        echo '<pre>';
        print_r($o);
        echo '</pre>';
    }
    // Create our Application instance.
    $facebook = new Facebook(array(
      'appId'  => $fbconfig['appid'],
      'secret' => $fbconfig['secret'],
      'cookie' => true,
    ));

    // We may or may not have this data based on a $_GET or $_COOKIE based session.
    // If we get a session here, it means we found a correctly signed session using
    // the Application Secret only Facebook and the Application know. We dont know
    // if it is still valid until we make an API call using the session. A session
    // can become invalid if it has already expired (should not be getting the
    // session back in this case) or if the user logged out of Facebook.
    $session = $facebook->getUser();

    $fbme = null;
    // Session based graph API call.
    if ($session) {
      try {
        $uid = $facebook->getUser();
        $fbme = $facebook->api('/me');
      } catch (FacebookApiException $e) {
         // d($e);
      }
    }

    function d($d){
        echo '<pre>';
        print_r($d);
        echo '</pre>';
    }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:11:47.810

这真的很简单。如前所述，您应该只允许用户通过 Twitter 和 Facebook 创建 OAuth 令牌。

至于系统设计。我建议有一个用户表。然后为每个用户在 OAuth-twitter 和 OAuth-facebook 表中添加新记录。

我的猜测是您正面临 Facebook API 的技术问题。粘贴您的代码，我们可能会提供更多帮助。

# java - Ubuntu 服务器中的 OutOfMemoryError

> ID：14088686
> 
> 赞同：0
> 
> 时间：2012-12-30T06:02:07.413
> 
> 标签：java, memory, ubuntu, out-of-memory, ram

我有一个用 java 编写的服务器，在 Windows 7 中运行良好。但是当我在 Ubuntu 中安装相同的服务器时，它显示内存不足错误，服务器有 8 GB 的内存，而我们的服务器只使用了 70% 的内存，它显示了的内存错误。CPU 使用率在内存不足时达到峰值。

1.  如何将剩余的 30% 内存分配给我的应用程序？
2.  如何增加分配给 Ubuntu 中应用程序的内存限制？

在 Windows 中不会发生内存不足错误，只有 Ubuntu。在 windows 任务管理器中显示 100% 的 CPU 使用率和完整的 RAM 使用率。我希望在 Ubuntu 中实现这种性能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:12:22.213

如果您的意思是 Java 抛出[OutOfMemoryError](http://docs.oracle.com/javase/7/docs/api/java/lang/OutOfMemoryError.html)，您首先需要了解原因。您可能想要使用[VisualVM](http://visualvm.java.net)（免费）或[YourKit](http://www.yourkit.com/)（非免费）之类的分析器来查看内存中发生了什么。之后，您可以决定适当的操作，例如提高应用程序的内存效率或更改 JVM 设置以增加适当的内存分配。

为了让您开始，如果您的堆空间（老一代）用完，您可以使用 JVM 标志调整可用的最大堆`-Xmx`。例如，`-Xmx1024m`或`-Xmx1g`将最大值设置为 1GB。如果是永久代 (PermGen)，您可以使用`-XX:MaxPermSize`JVM 标志为该永久代分配更大的总堆块，例如`-XX:MaxPermSize=256m`. 请注意，增加永久代的大小将相应地减少其他堆段可用的内存量。

有关这些和其他 JVM 内存设置的完整详细信息，请参见[Java 应用程序启动器页面](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html)和[HotSpot VM 选项页面](http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html)（假设您使用的是 HotSpot VM）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:12:13.283

您可以使用[ulimit](http://www.linuxhowtos.org/Tips%20and%20Tricks/ulimit.htm)来限制所需进程的 RAM 使用量。

此外，对于`Java`应用程序，您可以将`-Xms`（最小）、`-Xmx`（最大）等参数传递给`java`进程（M 代表 MB，G 代表 GB）。

# python - 如何更改绘图背景颜色？

> ID：14088687
> 
> 赞同：322
> 
> 时间：2012-12-30T06:02:09.550
> 
> 标签：python, matplotlib

我正在 matplotlib 中制作散点图，需要将实际绘图的背景更改为黑色。我知道如何使用以下方法更改绘图的面部颜色：

```
fig = plt.figure()
fig.patch.set_facecolor('xkcd:mint green') 
```

[![在此处输入图像描述](../Images/6e2aee44d84eaea57061b44f75767869.png)](https://i.stack.imgur.com/UN6YB.png)

我的问题是这会改变情节周围空间的颜色。如何更改绘图的实际背景颜色？

* * *

## 回答 #1

> 赞同：314
> 
> 时间：2014-05-14T04:05:02.657

使用您已通过以下方式之一创建**`set_facecolor(color)`的`axes`object的方法：**

*   您一起创建了一个图形和轴/es

    ```
    fig, ax = plt.subplots(nrows=1, ncols=1) 
    ```

*   您创建了一个图形，然后是轴/es

    ```
    fig = plt.figure()
    ax = fig.add_subplot(1, 1, 1) # nrows, ncols, index 
    ```

*   你使用了有状态的 API（如果你做的事情不止几行，*特别是*如果你有多个绘图，上面的面向对象的方法让生活更轻松，因为你可以参考特定的数字，在某些轴上绘图，并自定义任何一个）

    ```
    plt.plot(...)
    ax = plt.gca() 
    ```

然后你可以使用`set_facecolor`：

```
ax.set_facecolor('xkcd:salmon')
ax.set_facecolor((1.0, 0.47, 0.42)) 
```

[![轴上带有粉红色背景的示例图](../Images/61185c251d25932895f85972a2bd46e0.png)](https://i.stack.imgur.com/2wFc6.png)

作为复习可以是什么颜色：

> ## [matplotlib.colors](https://matplotlib.org/api/colors_api.html?highlight=color#module-matplotlib.colors)
> 
> Matplotlib 识别以下格式来指定颜色：
> 
> *   `[0, 1]`（例如，`(0.1, 0.2, 0.5)`或）中浮点值的 RGB 或 RGBA 元组`(0.1, 0.2, 0.5, 0.3)`；
> *   十六进制 RGB 或 RGBA 字符串（例如，`'#0F0F0F'`或`'#0F0F0F0F'`）；
> *   浮点值的字符串表示，`[0, 1]`包括灰度级（例如，`'0.5'`）；
> *   之一`{'b', 'g', 'r', 'c', 'm', 'y', 'k', 'w'}`；
> *   一个 X11/CSS4 颜色名称；
> *   来自[xkcd 颜色调查](https://xkcd.com/color/rgb/)的名称；`'xkcd:'`以（例如， ）为前缀`'xkcd:sky blue'`；
> *   其中之一`{'tab:blue', 'tab:orange', 'tab:green', 'tab:red', 'tab:purple', 'tab:brown', 'tab:pink', 'tab:gray', 'tab:olive', 'tab:cyan'}`是来自“T10”分类调色板的 Tableau 颜色（这是默认颜色循环）；
> *   “CN”颜色规范，即“C”后跟一个数字，这是默认属性循环 ( `matplotlib.rcParams['axes.prop_cycle']`) 的索引；索引在艺术家创建时发生，如果循环不包括颜色，则默认为黑色。
> 
> 除“CN”之外的所有颜色字符串规范都不区分大小写。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2016-11-02T01:13:56.243

一种方法是在脚本中手动设置轴背景颜色的默认值（请参阅[自定义 matplotlib](http://matplotlib.org/users/customizing.html)）：

```
import matplotlib.pyplot as plt
plt.rcParams['axes.facecolor'] = 'black' 
```

这与 Nick T 改变特定`axes`对象的背景颜色的方法形成对比。如果您要制作多个具有相似样式的不同绘图并且不想不断更改不同的`axes`对象，则重置默认值很有用。

*注：相当于*

```
fig = plt.figure()
fig.patch.set_facecolor('black') 
```

*你的问题是：*

```
plt.rcParams['figure.facecolor'] = 'black' 
```

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2012-12-30T07:26:32.003

像这样的东西？使用`axisbg`关键字`subplot`：

```
>>> from matplotlib.figure import Figure
>>> from matplotlib.backends.backend_agg import FigureCanvasAgg as FigureCanvas
>>> figure = Figure()
>>> canvas = FigureCanvas(figure)
>>> axes = figure.add_subplot(1, 1, 1, axisbg='red')
>>> axes.plot([1,2,3])
[<matplotlib.lines.Line2D object at 0x2827e50>]
>>> canvas.print_figure('red-bg.png') 
```

（当然，不是散点图，也不是黑色背景。）

![在此处输入图像描述](../Images/04db57f10ed4422d8612d7be6c7d507e.png)

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2020-05-21T23:07:23.740

更简单的答案：

```
ax = plt.axes()
ax.set_facecolor('silver') 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2014-05-28T09:33:57.530

如果您已经有`axes`对象，就像在[*Nick T*的答案](https://stackoverflow.com/a/23645437/2781698)中一样，您也可以使用

```
 ax.patch.set_facecolor('black') 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2017-04-13T11:30:51.297

One suggestion in other answers is to use `ax.set_axis_bgcolor("red")`. This however is deprecated, and doesn't work on MatPlotLib >= v2.0\.

There is also the suggestion to use `ax.patch.set_facecolor("red")` (works on both MatPlotLib v1.5 & v2.2). While this works fine, an even easier solution for v2.0+ is to use

### `ax.set_facecolor("red")`

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2019-05-03T19:03:37.317

最简单的事情可能是在创建绘图时提供颜色：

```
fig1 = plt.figure(facecolor=(1, 1, 1)) 
```

或者

```
fig1, (ax1, ax2) = plt.subplots(nrows=1, ncols=2, facecolor=(1, 1, 1)) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-04-16T14:06:28.233

除了 NickT 的答案之外，您还可以通过将其设置为“无”来删除背景框架，如下所述：[https ://stackoverflow.com/a/67126649/8669161](https://stackoverflow.com/a/67126649/8669161)

```
import matplotlib.pyplot as plt
plt.rcParams['axes.facecolor'] = 'none' 
```

# python - NLTK 可以识别首字母后跟点吗？

> ID：14088688
> 
> 赞同：5
> 
> 时间：2012-12-30T06:02:48.693
> 
> 标签：python, nlp, nltk

我正在尝试使用 NLTK 来解析俄语文本，但它不适用于像 А 这样的缩写和首字母。И. Манташева 和Я。Вышинский。

相反，它打破如下：

> организовывал забастовки и демонстрации, поднимал рабочих на бакинских предприятиях А.
> 
> И.
> 
> Манташева。

当我`russian.pickle`从[https://github.com/mhq/train_punkt](https://github.com/mhq/train_punkt)使用时，它做了同样的事情，
这是一般的 NLTK 限制还是特定于语言的限制？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T22:53:07.957

正如一些评论所暗示的那样，您想要使用的是 Punkt 句子分段器/标记器。

### NLTK 或特定语言？

两者都不。正如您所意识到的，您不能简单地在每个时期进行拆分。NLTK 带有几个受过不同语言培训的 Punkt 分段器。但是，如果您遇到问题，最好的办法是使用更大的训练语料库供 Punkt 分词器学习。

### 文档链接

*   [https://nltk.googlecode.com/svn/trunk/doc/howto/tokenize.html](https://nltk.googlecode.com/svn/trunk/doc/howto/tokenize.html)
*   [https://nltk.googlecode.com/svn/trunk/doc/api/nltk.tokenize.punkt.PunktSentenceTokenizer-class.html](https://nltk.googlecode.com/svn/trunk/doc/api/nltk.tokenize.punkt.PunktSentenceTokenizer-class.html)

### 示例实现

以下是为您指明正确方向的部分代码。通过提供俄语文本文件，您应该能够为自己做同样的事情。其中一个来源可能是[俄语版本](http://dumps.wikimedia.org/ruwiki/)的[Wikipedia 数据库转储](https://en.wikipedia.org/wiki/Wikipedia%3aDatabase_download)，但我将其作为潜在的次要问题留给您。

```
import logging
try:
    import cPickle as pickle
except ImportError:
    import pickle
import nltk

def create_punkt_sent_detector(fnames, punkt_fname, progress_count=None):
    """Makes a pass through the corpus to train a Punkt sentence segmenter.

    Args:
        fname: List of filenames to be used for training.
        punkt_fname: Filename to save the trained Punkt sentence segmenter.
        progress_count: Display a progress count every integer number of pages.
    """
    logger = logging.getLogger('create_punkt_sent_detector')

    punkt = nltk.tokenize.punkt.PunktTrainer()

    logger.info("Training punkt sentence detector")

    doc_count = 0
    try:
        for fname in fnames:
            with open(fname, mode='rb') as f:
                punkt.train(f.read(), finalize=False, verbose=False)
                doc_count += 1
                if progress_count and doc_count % progress_count == 0:
                    logger.debug('Pages processed: %i', doc_count)
    except KeyboardInterrupt:
        print 'KeyboardInterrupt: Stopping the reading of the dump early!'

    logger.info('Now finalzing Punkt training.')

    punkt.finalize_training(verbose=True)
    learned = punkt.get_params()
    sbd = nltk.tokenize.punkt.PunktSentenceTokenizer(learned)
    with open(punkt_fname, mode='wb') as f:
        pickle.dump(sbd, f, protocol=pickle.HIGHEST_PROTOCOL)

    return sbd

if __name__ == 'main':
    punkt_fname = 'punkt_russian.pickle'
    try:
        with open(punkt_fname, mode='rb') as f:
            sent_detector = pickle.load(f)
    except (IOError, pickle.UnpicklingError):
        sent_detector = None

    if sent_detector is None:
        corpora = ['russian-1.txt', 'russian-2.txt']
        sent_detector = create_punkt_sent_detector(fnames=corpora,
                                                   punkt_fname=punkt_fname)

    tokenized_text = sent_detector.tokenize("some russian text.",
                                            realign_boundaries=True)
    print '\n'.join(tokenized_text) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-12T11:20:56.297

您可以从[https://github.com/Mottl/ru_punkt](https://github.com/Mottl/ru_punkt)获取经过训练的俄语句子标记器，它可以处理俄语姓名的首字母和缩写。

```
text = ("организовывал забастовки и демонстрации, ",
        "поднимал рабочих на бакинских предприятиях А.И. Манташева.")
print(tokenizer.tokenize(text)) 
```

输出：

```
['организовывал забастовки и демонстрации, поднимал рабочих на бакинских предприятиях А.И. Манташева.'] 
```

# python - 让安全的 Websockets 在 Tornado 上工作

> ID：14088695
> 
> 赞同：9
> 
> 时间：2012-12-30T06:03:42.483
> 
> 标签：python, websocket, tornado

如何在 Tornado 上设置 WSS（安全 WebSockets）？

在他们的文档字符串中，他们说：

`WebSocketHandler.get_websocket_scheme`在未正确设置的情况下， 可用于选择适当的 url 方案（`ws://`或）。`wss://``HTTPRequest.protocol`

那么，我如何使用`get_websocket_scheme`和/或`HTTPRequest.protocol`让 WSS 在 Tornado 上工作。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-30T08:39:59.537

我得到了它 ：））

只需将其添加到您的应用程序中：

```
 http_server = tornado.httpserver.HTTPServer(application,ssl_options={
    "certfile": "cert.cer",
    "keyfile":  "key.key",
}) 
```

这将解决问题。与常规 HTTPS 非常相似。我也很欣赏任何其他使它起作用的方法。

# jquery - 表格滚动条锁定在 chrome 中

> ID：14088698
> 
> 赞同：4
> 
> 时间：2012-12-30T06:04:39.490
> 
> 标签：jquery, html, css, google-chrome

我只有在谷歌浏览器中的表格滚动条有问题。所有其他浏览器中的表格滚动都可以正常工作，但是在 chrome 中，当表格滚动条出现时，它只是锁定到位，除非我更改浏览器窗口的缩放比例，否则无法移动它，然后表格滚动条移动。

我在[这里](http://helios.hud.ac.uk/u0867587/Mobile_app/QandATable2.php)有一个应用程序（在 Google Chrome 和其他主要浏览器中打开）

在应用程序中，只需继续单击“添加”按钮，直到您看到表格滚动出现。现在在 chrome 中，如果您尝试滚动表格滚动条，除非您按照我所说的去做，否则它不会这样做。在您打开应用程序的其他浏览器中，表格滚动条工作正常。

有没有其他人遇到过这个问题？是我拥有的一段代码导致它没有立即在 google chrome 中真正执行滚动，还是只是 chrome 浏览器本身在执行此操作？这是我真的应该担心的事情吗，或者如果是浏览器故障，那么我应该离开它吗？

该应用程序的代码在这个 jsfiddle 中：http: [//jsfiddle.net/2SJFt/](http://jsfiddle.net/2SJFt/)

如果您在 google chrome 中打开 jsfiddle 的嵌入式版本：http: [//jsfiddle.net/2SJFt/embedded/result/](http://jsfiddle.net/2SJFt/embedded/result/)并执行相同的步骤以显示滚动条，那么它会立即执行滚动，但我假设因为它在技术上处于 jsfiddle 中，这就是它立即执行滚动的原因。

表格的滚动条由简单的 css 完成：

```
#qandatbl_onthefly_container
{
    width:100%;
    overflow:scroll;
    max-height:500px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T10:37:04.237

请不要问为什么它可能会起作用，但是在您`var $fileImage`编写`iframe`的源代码中放置“#”以外的其他内容，例如“/”就可以了。至少这个技巧在我的浏览器上有效。

我一整天都在尝试解决您的这个问题，当我这样做时，一切似乎都很好。所以你`var $fileImage`应该看起来像这样。

```
var $fileImage = $("<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target_image' onsubmit='return imageClickHandler(this);' class='imageuploadform' >" + 
"<p class='imagemsg'></p><p class='imagef1_upload_process' align='center'>Loading...<br/><img src='Images/loader.gif' /></p><p class='imagef1_upload_form' align='center'><label>" + 
"Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><br/><label class='imagelbl'>" + 
"<input type='submit' name='submitImageBtn' class='sbtnimage' value='Upload' /></label>" + 
"<label><input type='button' name='imageClear' class='imageClear' value='Clear File'/></label>" +
"<input type='hidden' class='numimage' name='numimage' value='" + GetFormImageCount() + "' />" +
"</p><p class='imagef1_cancel' align='center'><label>" +
"<input type='reset' name='imageCancel' class='imageCancel' value='Cancel' /></label>" +
"</p><p class='listImage' align='left'></p>" +
"<iframe class='upload_target_image' name='upload_target_image' src='/' style='width:0px;height:0px;border:0px;solid;#fff;'></iframe></form>"); 
```

它真的有效吗？:$

# jenkins - 如何检测和使用 config.xml 中的更新值

> ID：14088706
> 
> 赞同：1
> 
> 时间：2012-12-30T06:06:45.440
> 
> 标签：jenkins

我是 Jenkins 的新手，我想使用自定义版本进行构建。我创建了一个带参数的作业并设置了两个参数：

*   版本（默认值为 1.0.0）
*   buildNumber（默认值为 1）

当我构建工作时，我输入版本和构建号并构建项目。Jenkins 将这两个属性传递给构建文件的我的 ant 脚本。构建的最后一步更新Jenkins 配置文件 ( )中的`version`和值。`buildNumber``jenkins_home\jobs\jobName\config.xml`

我的问题是我发现`config.xml`文件已按预期更新，但是当我再次构建时，它没有显示新值。就像值以某种方式被缓存一样。我怎样才能让詹金斯展示新的价值观？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T09:22:25.067

您不应该尝试对*config.xml*文件
的内容或任何 Jenkins 环境变量的内容进行粗暴处理。

为此使用插件，例如**[Next Build Number Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Next+Build+Number+Plugin)**
或**[Version Number Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Version+Number+Plugin)**。

另请参阅：
**[覆盖 Jenkis/Hudson BUILD_URL](https://stackoverflow.com/a/13996906/1390251)**

（Jenkins 不会监控对其作业配置文件的任何更改，
除非您选择重新加载配置，这通常是不好的做法）。

干杯

# php - 在 PHP 中通过他们的国家/地区重定向用户

> ID：14088707
> 
> 赞同：0
> 
> 时间：2012-12-30T06:06:54.990
> 
> 标签：php, web

我正在尝试将用户重定向到关于他们在 PHP 中的国家/地区的适当页面。例如。美国 - mysite.com，澳大利亚 - mysite.com.au。我已经通过此功能获得了 IP 地址，并想使用此站点获取他们的国家/地区：`http://api.hostip.info/country.php?ip=`.

```
if (getenv(HTTP_X_FORWARDED_FOR)) { 
    $ip_address = getenv(HTTP_X_FORWARDED_FOR); 
    echo $ip_address;
} else { 
    $ip_address = getenv(REMOTE_ADDR);
    echo $ip_address;
}

ip_address_to_number($ip_address); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:12:32.783

我建议使用[NetImpact 的 API](http://www.netimpact.com/)，但你能具体告诉我们问题是什么吗？您所做的只是告诉我们您要做什么，但您从未告诉我们您当前的代码是如何出现故障的。

注意：Netimpact 已关闭。他们已将用户迁移到[KickFire](https://kickfire.com/kf-api)，它提供更广泛的 API：IP2GEO、IP2Company、Domain2IP。

但是，如果您只想获取该 URL 的内容，那真的很容易。只需将其放在您的 PHP 页面中：

```
<?php
$ip = $_SERVER['REMOTE_ADDR'];
$url = 'http://api.hostip.info/country.php?ip=' . $ip;
$country = file_get_contents($url);
// Do something with the country, I am forwarding to a subdomain here but you can
// do whatever you like.
header('Location: http://' . $country. '.mysite.com');
?> 
```

# javascript - javascript验证中名称字段的正则表达式

> ID：14088714
> 
> 赞同：6
> 
> 时间：2012-12-30T06:09:11.900
> 
> 标签：javascript

我需要 javascript 验证中的正则表达式。将接受字母的名称字段的正则表达式，并且字段中单词和总字符之间只有空格字符应该在 2 到 30 之间。即，该字段应该接受最少 2 个字符和最多 30 个字符

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-30T06:20:51.800

```
function validate(id) {
    var regex = /^[a-zA-Z ]{2,30}$/;
    var ctrl =  document.getElemetnById(id);
    return regex.test(ctrl.value);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T06:18:36.553

尝试这个：

```
/^([a-zA-Z ]){2,30}$/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T06:17:42.283

你的解决方案是。

```
 /^[a-zA-Z ]{2,30}$/; 
```

注意：只需在括号内添加一个空格。其他空白字符，如 -tab、换页符和换行符，将不匹配。

# haskell - Haskell 类型类（Float 并不意味着 Floating？）

> ID：14088717
> 
> 赞同：5
> 
> 时间：2012-12-30T06:10:00.823
> 
> 标签：haskell

```
toFloat :: (Floating a) => String -> a
toFloat s = read s :: Float

main = print (toFloat "1") 
```

给我错误：

```
Could not deduce (a ~ Float)
from the context (Floating a) 
```

我确定我缺少一些基本的东西，但似乎我的 toFloat 应该总是返回一个 Float 并且 Float 应该暗示 Floating。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-30T06:26:05.090

类型签名承诺结果将是`Floating`调用者想要的类的任何实例。实现说“知道吗？不要介意它可以是任何类型的承诺 - 让我们把它变成一个`Float`”。

然后编译器出现并说“哇！你没有返回你承诺的类型。” 除了它非常努力地使您的类型签名和您的实现匹配。它对自己说：“如果以某种方式限制它，那么`a`它总是与 相同的东西`Float`，这将是正确的。” 它真的很想找到一种方法你的代码是正确的。好吧，编写这种约束的方法是使用`~`类型相等运算符。的约束`(a ~ Float)`意味着“与”`a`的类型相同`Float`。因此编译器会检查您在类型签名中提供的上下文，但无法找到该约束。它没有办法让你的类型签名和实现一起工作，放弃并报告错误。

不幸的是，它报告的错误有点不透明，因为它付出了多少努力来尝试使您的代码正常工作。只需最微小的更改，添加一点限制，就可以让它变得正确。因此它报告该约束不存在。但它没有报告它为什么要寻找那个约束，如果你以前没有看过它，这会让整个事情变得有点不清楚。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-30T12:38:56.657

这个问题或与之非常相似的问题会定期被问到。（这不是抱怨，我只是指出您不是唯一对此感到困惑的人。）

在 OO 语言中，您可以说“这个函数返回实现 X 的东西”。然后，该函数可以返回任何它想要返回的东西，*只要*它确实实现了 X。

Haskell 不是那样工作的。如果你说“这个函数返回了实现 X 的东西”，那么这个函数必须能够产生*任何*实现 X 的可能类型！

关键区别在于：在 OO 语言中，*函数*决定返回什么类型（在指定的约束内）。在 Haskell 中，*调用者*决定返回什么类型（同样，在规定的约束内）。

一旦你理解了这个关键的区别，剩下的就是不言而喻的了。

同样，*很多*人似乎误解了这部分。我们可能应该在教程和其他东西中更多地提及它，因为它似乎是一个 VFAQ ......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-30T06:19:44.540

您是说`toFloat`可以返回属于`Floating`typeclass 的任何类型，但您将其限制为`Float`，这是错误的。你的函数是多态的，`a`所以你不能返回一个实例`Floating`，它应该能够与所有实例一起工作。

否则，您可以通过以下方式理解这一点

```
toFloat :: (Read a,Floating a) => String -> a
toFloat s = read s 
```

在 ghci

```
*Main> :t toFloat "12.1"
toFloat "12.1" :: (Floating a, Read a) => a
*Main> :t (toFloat "12.1" :: Float)
(toFloat "12.1" :: Float) :: Float
*Main> :t (toFloat "12.1" :: Double)
(toFloat "12.1" :: Double) :: Double 
```

由于它返回属于 typeclass 的类型，因此您应该能够通过在应用函数后提供显式类型签名`Floating`将其转换为任何类型（属于）。`Floating`另一方面，当您现在显式返回时，请记住您的情况，您`Float`不能只说我期望`Double`这个函数，因为如果没有显式转换，这是不可能发生的。

另一种理解你的假设有多可怕的方法是考虑函数`read`

```
read :: Read a => String -> a 
```

现在根据你的说法，你可以只返回 say`Int`一切，因为`Int`有一个`Read`. 现在你可以理解如果你做类似的事情会发生什么

```
read "12" +  (1.2 :: Double) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T08:28:47.877

这很简单：

```
-- The simplest.                                                                                                                                               
toFloat :: String -> Float
toFloat = read

-- More generalized.                                                                                                                                           
toFloat' :: (Floating a, Read a) => String -> a
toFloat' = read 
```

# asp.net - 在 asp.net 中查找网站的 Google 页面排名

> ID：14088718
> 
> 赞同：0
> 
> 时间：2012-12-30T06:10:01.307
> 
> 标签：asp.net, pagerank

我正在使用此功能来获取网站的页面排名。每次它返回 -1 即异常代码。我找不到公关。我不知道出了什么问题以及为什么我找不到公关

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Text;
using System.Text.RegularExpressions;
using System.Net;
using System.IO;

class GetPR
{
    private const UInt32 myConst = 0xE6359A60;
    private static void _Hashing(ref UInt32 a, ref UInt32 b, ref UInt32 c)
    {
        a -= b; a -= c; a ^= c >> 13;
        b -= c; b -= a; b ^= a << 8;
        c -= a; c -= b; c ^= b >> 13;
        a -= b; a -= c; a ^= c >> 12;
        b -= c; b -= a; b ^= a << 16;
        c -= a; c -= b; c ^= b >> 5;
        a -= b; a -= c; a ^= c >> 3;
        b -= c; b -= a; b ^= a << 10;
        c -= a; c -= b; c ^= b >> 15;
    }
    public static string PerfectHash(string theURL)
    {
       String url = string.Format("info:{0}", theURL);

        int length = url.Length;

        UInt32 a, b;
        UInt32 c = myConst;

        int k = 0;
        int len = length;

        a = b = 0x9E3779B9;

        while (len >= 12)
        {
            a += (UInt32)(url[k + 0] + (url[k + 1] << 8) +
                 (url[k + 2] << 16) + (url[k + 3] << 24));
            b += (UInt32)(url[k + 4] + (url[k + 5] << 8) +
                 (url[k + 6] << 16) + (url[k + 7] << 24));
            c += (UInt32)(url[k + 8] + (url[k + 9] << 8) +
                 (url[k + 10] << 16) + (url[k + 11] << 24));
            _Hashing(ref a, ref b, ref c);
            k += 12;
            len -= 12;
        }
        c += (UInt32)length;
        switch (len)
        {
            case 11:
                c += (UInt32)(url[k + 10] << 24);
                goto case 10;
            case 10:
                c += (UInt32)(url[k + 9] << 16);
                goto case 9;
            case 9:
                c += (UInt32)(url[k + 8] << 8);
                goto case 8;
            case 8:
                b += (UInt32)(url[k + 7] << 24);
                goto case 7;
            case 7:
                b += (UInt32)(url[k + 6] << 16);
                goto case 6;
            case 6:
                b += (UInt32)(url[k + 5] << 8);
                goto case 5;
            case 5:
                b += (UInt32)(url[k + 4]);
                goto case 4;
            case 4:
                a += (UInt32)(url[k + 3] << 24);
                goto case 3;
            case 3:
                a += (UInt32)(url[k + 2] << 16);
                goto case 2;
            case 2:
                a += (UInt32)(url[k + 1] << 8);
                goto case 1;
            case 1:
                a += (UInt32)(url[k + 0]);
                break;
            default:
                break;
        }

        _Hashing(ref a, ref b, ref c);

        return string.Format("6{0}", c);
    }

    public  int MyPR(string myURL)
    {
        string strDomainHash = PerfectHash(myURL);
        string myRequestURL = string.Format("http://toolbarqueries.google.com/" +
               "search?client=navclient-auto&ch={0}&features=Rank&q=info:{1}",
               strDomainHash, myURL);

        try
        {
            HttpWebRequest myRequest = (HttpWebRequest)WebRequest.Create(myRequestURL);
            string myResponse = new StreamReader(
                   myRequest.GetResponse().GetResponseStream()).ReadToEnd();
            if (myResponse.Length == 0)
                return 0;
            else
                return int.Parse(Regex.Match(myResponse,
                       "Rank_1:[0-9]:([0-9]+)").Groups[1].Value);
        }
        catch (Exception)
        {
            return -1;
        }
    }

}

public partial class PageRankChecker : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    public void checkpagerankbutton_Click(object sender, EventArgs e)
    {
        String geturl= url.Text;

        GetPR a = new GetPR();

        int profmywebsite= a.MyPR(geturl);
        mypr1.Text = profmywebsite.ToString();

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T13:04:33.433

```
private static void _Hashing(ref UInt32 a, ref UInt32 b, ref UInt32 c)
{
    a -= b; a -= c; a ^= c >> 13;
    b -= c; b -= a; b ^= a << 8;
    c -= a; c -= b; c ^= b >> 13;
    a -= b; a -= c; a ^= c >> 12;
    b -= c; b -= a; b ^= a << 16;
    c -= a; c -= b; c ^= b >> 5;
    a -= b; a -= c; a ^= c >> 3;
    b -= c; b -= a; b ^= a << 10;
    c -= a; c -= b; c ^= b >> 15;
} 
```

# wolfram-mathematica - 生成所有 (0,1) nxn 矩阵

> ID：14088720
> 
> 赞同：5
> 
> 时间：2012-12-30T06:10:33.040
> 
> 标签：wolfram-mathematica

在处理与韦斯坦猜想（https://cs.uwaterloo.ca/journals/JIS/VOL7/Sloane/sloane15.pdf）相关的问题时，我需要为*n* =生成所有*n* x *n* (0,1) 矩阵2, 3, 4,... 如果您考虑正确的二进制序列并相应地对它们进行分区，这并不难。例如，这里是所有 3 x 3 矩阵：

 *```
With[{n = 3}, 
 lis = PadLeft[IntegerDigits[#, 2], n^2]& /@ Range[0, 2^n^2 - 1]; 
 mats = (Partition[#, n] & ) /@ lis
]; 
```

Weisstein 猜想涉及，对于每个*n* = 2, 3, ...，计算特征值都是实数和正数的矩阵的数量。对于*n* = 2，有 3 个；对于*n* = 3，有 25 个；对于*n* = 4，有 543 个；等等。特征值计算耗时但简单。

不过，我感兴趣的是找到枚举*n* x *n*矩阵的其他方法。为了得到所有这些，我使用了整数的基数 2 表示，最多为 2^( *n* ^2) 并分区以制作矩阵。必须有其他（更有效的？）方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T13:46:24.670

我们可以使用内置的 Mathematica 函数`Tuples`。您的 3x3 示例简单地变为

```
ms = Tuples[{1, 0}, {3, 3}]; 
```

排序的枚举可以通过二进制数来完成

```
FromDigits[#, 2] & /@ Flatten /@ ms 
```

![在此处输入图像描述](../Images/e750b7007ee151795c913aedfbe90c64.png)

可视化排序：

```
ArrayPlot[#, ImageSize -> 20, Mesh -> All] & /@ ms 
```

![在此处输入图像描述](../Images/3b0cea4d0e5223c5ecdebba9ce7afea0.png)*

# inline-assembly - @ 在内联汇编中是什么意思？

> ID：14088724
> 
> 赞同：0
> 
> 时间：2012-12-30T06:12:01.263
> 
> 标签：inline-assembly

```
__asm__ __volatile__
  ("@ call(start) \n\t"
   "mov     lr, pc       \n\t"
   "@ call(end)   \n\t"
   : 
```

它看起来像是为函数调用定义一个区域，但你能解释更多吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T01:59:59.043

做出有根据的猜测，即您正在使用 GCC 来定位 ARM，`@`开始一个延伸到该行末尾的注释。请参阅[GNU AS 手册 - ARM 语法 - 特殊字符](http://sourceware.org/binutils/docs/as/ARM_002dChars.html#ARM_002dChars)。

# php - WordPress 插件 JJ NextGen JQuery Carousel 显示所有项目

> ID：14088731
> 
> 赞同：0
> 
> 时间：2012-12-30T06:13:09.710
> 
> 标签：php, jquery, wordpress

我正在使用 JJ NextGen JQuery Carousel 插件，但它似乎表现得很奇怪。而不是像旋转木马一样隐藏图像，它只是将它们全部显示出来，这使得页面非常宽。请参阅此处（页面底部）[http://vabisoftware.com/](http://vabisoftware.com/)

任何人都可以发现这有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T08:54:14.073

您需要做的就是`overflow:hidden;`在您`CSS`的`jcarousel-container`.

**排队：**

```
<div class="jcarousel-container
      jcarousel-container-horizontal"
      style="position: relative;
             display: block;
             overflow: hidden;"> 
```

**或在样式表中：**

```
div#bottoni_container
.jcarousel-skin-tango
.jcarousel-container-horizontal {
     width: 560px !important;
     overflow: hidden;
} 
```

这是此类滑块显示和消失图像的正常方式。

# javascript - jquery幻灯片和隐藏部分div

> ID：14088733
> 
> 赞同：0
> 
> 时间：2012-12-30T06:13:26.060
> 
> 标签：javascript, jquery, animation, slide

有了这个 html

```
 <div id="main-content">
        <section id="search-section" class="active">Test 1
             <button id="new-person" data-section="person-section" type="button">
               New Person
             </button>
         </section>
        <section id="person-section">Test adfs </section>
    </div>​ 
```

我试图简单地`new-person`点击幻灯片中的`person-section`.

我有两个问题：

1.  我看不到隐藏人员部分，我想在初始加载时只有我的`search-section`可见。
2.  使用以下 javascript，使用我正在使用的查询选择器找不到 jquery 滑动部分。关于如何实现这一点的任何想法，或者是否有一个现有的插件已经这样做了。

    ```
     $(document).ready(function() {

       $('#new-person').click(function() 
        {  
               event.preventDefault();
                var sectionId = $(this).attr("data-section"),
                $toSlide= $("#"+sectionId),
                $fromSlide= $('.active');

            if (!($toSlide.hasClass("active")))
            {

                $fromSlide.animate({"left":"-100%"},500,'linear')
                $toSlide.animate({"left":"0%"},500,'linear',function()
                {
                    $fromSlide.css("left","100%");
                    $fromSlide.removeClass("active");
                    $toSlide.addClass("active");
                });

            }

        });
    }); 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:53:15.027

我把`person-section`它推到了视野的左边，把它藏了起来。通过给它一个风格`left`来做到这一点。`position`不要忘记给它包含 parent `position:relative`。不知道你要去哪里，`$fromSlide`所以我删除了它并清理了代码。

```
<div id="main-content" style="position:relative;">
        <section id="search-section" class="active">Test 1
             <button id="new-person" data-section="person-section" type="button">
               New Person
             </button>
         </section>
        <section id="person-section" style="position:absolute; left:-100px;">Test adfs </section>
    </div 
```

--

```
$('#new-person').click(function(e) {
    e.preventDefault();
    var sectionId = $(this).attr("data-section");
    $toSlide = $("#" + sectionId);

    if (!($toSlide.hasClass("active"))) {
        $toSlide.animate({
            "left": "0%"
        }, 500, 'linear', function() {
            $toSlide.addClass("active");
        });
    }
    else {
        $toSlide.animate({
            "left": "-100%"
        }, 500, 'linear', function() {
            $toSlide.removeClass("active");
        })
    }
}); 
```

在此处查看工作示例：http: [//jsfiddle.net/fP7DL/](http://jsfiddle.net/fP7DL/)

# design-patterns - 动态可配置对象的设计模式

> ID：14088737
> 
> 赞同：0
> 
> 时间：2012-12-30T06:14:41.353
> 
> 标签：design-patterns, configuration

我有一个基于 Flash 的浏览器动画，它加载一个基于 xml 的配置文件并设置一个名为的外部回调：`setConfig( xmlString ):void`. 我在动画旁边的代码镜像中也有可编辑的配置文件。每次保存配置文件时，都应将新文件注入闪存（无需重新加载）。

我正在寻找一种设计模式来正确地将其实现到闪存中。所有对象都应通过配置更改得到通知，并在必要时做出反应。什么是好方法？我很好奇各种建议！

问候...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:16:53.777

[观察者](https://en.wikipedia.org/wiki/Observer_pattern)设计模式。

> 观察者模式是一种软件设计模式，其中称为主体的对象维护其依赖项列表（称为观察者），并自动通知他们任何状态更改，通常通过调用他们的方法之一。它主要用于实现分布式事件处理系统。

# java - 计划用于后端执行的 GAE 任务返回 405 错误

> ID：14088740
> 
> 赞同：0
> 
> 时间：2012-12-30T06:15:18.710
> 
> 标签：java, google-app-engine, backend, task-queue

我无法理解为什么前端任务正确执行但后端任务返回 405 错误。

以下代码：

`queue.add(withUrl(url).taskName(taskName).method(Method.GET));`

工作顺利，因为它正在前端处理。但是当我像这样向后端解决它时：

`queue.add(withUrl(url).taskName(taskName).method(Method.GET).header("Host", BackendServiceFactory.getBackendService().getBackendAddress(backend)));`

然后它不起作用。这不是将任务发送到后端的正确方法吗？我依靠这个[代码实验室](http://googcloudlabs.appspot.com/codelabexercise8.html#Upload)的例子。我确实在 backends.xml 中配置了后端，所以不确定我还应该做什么。

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T04:02:51.793

这是一个愚蠢的错误。上面的代码完全没问题。事实证明，前端和后端在运行的应用程序版本方面不同步。因此，如果您看到类似的行为，请务必检查所有内容是否在同一版本上运行。

# python - 理解 Python 中的研究

> ID：14088741
> 
> 赞同：1
> 
> 时间：2012-12-30T06:15:39.770
> 
> 标签：python

我试图允许用户输入字母数字、下划线和空格作为名称。我一直在`if not re.search(r'^[\w-]+$', name):`检查名称是否包含字母数字、下划线和空格以外的任何内容。但在这里我只能输入一个词，而不是多个。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T06:45:22.910

你没有做任何明显错误的事情。您的问题也不完全清楚，所以我将尝试解决几个可能的问题。

### 为什么正则表达式只接受一个词？

在您的正则表达式中，`\w`根据[`re`文档](http://docs.python.org/2/library/re.html)，您拥有的只是字母数字字符和下划线。您*没有*包括的是空格字符，因此任何带有空格的名称（包括分隔名字和姓氏的名称）都将与您的正则表达式匹配，因此`False`由`not`. 您应该检查是否有任何非字母数字字符/下划线/空格如下：

```
if not re.search(r'^[\w- ]+$', name): 
```

或者，如果您也出于某种原因担心换行符 ( `\n`) 或制表符 ( `\t`) 以及其他类型的空格：

```
if not re.search(r'^[\w\s- ]+$', name): 
```

### 为什么我一次只能检查一个名字？

这是因为正则表达式一次只会搜索一个字符串。如果你想让它检查多个名称，你应该对每个名称运行正则表达式，格式如下：

```
# assuming name_list is a list of name strings
for name in name_list:
    if not re.search(r'^[\w- ]+$', name):
        # do whatever 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T06:52:13.930

您的正则表达式不允许空格（相反，它允许您在问题中未提及的破折号）。

```
if not re.search(r'^[\w ]+$', name): 
```

只允许 ASCII 字母、数字、下划线和空格（并且至少需要一个字符）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T15:12:59.030

你需要学习一点关于正则表达式的知识。

我个人是从[Google 课程开始的，阅读](https://developers.google.com/edu/python/regular-expressions)[文档](http://docs.python.org/2/library/re.html)已经足够好了。

# css-paged-media - 使用css在打印模式下每页的页眉和页脚

> ID：14088745
> 
> 赞同：20
> 
> 时间：2012-12-30T06:16:24.640
> 
> 标签：css-paged-media

我有一个 Web 应用程序，它的报告可能超过一页，我想在每一页中打印页眉和页脚。我找到并尝试了这个： [在每个页面中重复一个报告标题，](https://www.servoyforge.net/boards/2/topics/215?r=220#message-220) 但它对我不起作用。我尝试了opera，IE9，Firefox，Google Chrome，但......没有。page-margin 工作正常，但内容是我想要的它不起作用。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-30T06:21:15.097

您可以设置`position: fixed;`页眉和页脚，以便在每一页上重复

例如

```
<header class="onlyprint"><!--Content Goes Here--></header>
<footer class="onlyprint"><!--Content Goes Here--></footer>

@media screen {
    header.onlyprint, footer.onlyprint{
        display: none; /* Hide from screen */
    }
}

@media print {
    header.onlyprint {
        position: fixed; /* Display only on print page (each) */
        top: 0; /* Because it's header */
    }
    footer.onlyprint {
        position: fixed;
        bottom: 0; /* Because it's footer */
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-30T13:43:41.803

我非常感谢您的回复，但我之前使用过此解决方案（位置：固定），页面内容将被标题掩盖。所以我必须使用“@page”，它只能与“Margin”属性一起使用，而“Content”不起作用，或者换句话说，我无法达到我想要的结果。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-19T09:58:31.267

目前 webkit 引擎 ( [https://bugs.webkit.org/show_bug.cgi?id=100075](https://bugs.webkit.org/show_bug.cgi?id=100075) ) 中存在一个错误，导致页脚完全错位。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-12-19T11:48:28.523

我找到了一个对我有用的解决方案，并且只有一个没有问题的解决方案。

在 html 中

```
<table>
        <thead><tr><td>
            <div class="header-space">&nbsp;</div>
        </td></tr></thead>
        <tbody><tr><td>
            <div id="pageHost" class="content"></div>
        </td></tr></tbody>
        <tfoot><tr><td>
            <div class="footer-space">&nbsp;</div>
        </td></tr></tfoot>
    </table>
    <header id="pageHeader">
    </header>
    <footer id="pageFooter">
        Custom Footer
        <div class="numberOfPages">

        </div>
    </footer> 
```

在 CSS 中

```
 header, .header-space,
            footer, .footer-space {
                height: 100px;
                font-weight: bold;
                width: 100%;
                padding: 10pt;
                margin: 10pt 0;
            }

            header {
                position: fixed;
                top: 0;
                border-bottom: 1px solid black;
            }

            footer {
                position: fixed;
                bottom: 0;
                border-top: 1px solid black;
            } 
```

# java - 为什么这会导致 java.lang.NullPointerException？

> ID：14088749
> 
> 赞同：-5
> 
> 时间：2012-12-30T06:17:02.423
> 
> 标签：java, arrays, nullpointerexception

```
String filelist1[];
filelist1 = null;

for (String s : step1) {
    if(s != null || !"".equals(s)) {
        on = s.split(":");

        if("FILE".equals(on[0])) {
            filelist1[i] = on[1];
            i++;
        }
    }
} 
```

为什么这会导致 NullPointerException？我已经确定它与 有关`filelist1[i] = on[1];`，甚至进一步认为它只是`filelist1`数组。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T06:21:07.187

```
filelist1 = null; 
```

然后你尝试设置`filelist1[i] = ...`......它是`null`，它不是一个数组！

改用一个`ArrayList`。

```
ArrayList<String> filelist1 = new ArrayList<String>();

...
filelist1.add(on[1]); 
```

# php - PHP解析多维JSON数组

> ID：14088750
> 
> 赞同：1
> 
> 时间：2012-12-30T06:17:04.203
> 
> 标签：php, parsing, json

我正在使用 Angel list api 来提取此数据并尝试通过此代码对其进行解析（通过尝试解析进行提取）

解析代码无法正常工作，并且由于某种原因不会检索 [id] 的值。我一直在查找 json 深度并认为这可能是问题所在，并尝试了许多不同的方法，但似乎没有任何效果。有人可以帮助从嵌套数组中提取单个值吗？

```
$ch = curl_init($array_url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HEADER, 0);
$data = curl_exec($ch);
curl_close($ch);
$response = json_decode($data);
print $response->{'name'};
echo "\n"; 
```

示例输出

```
Array
(
[0] => Array
    (
        [id] => 79840
        [pic] => https://s3.amazonaws.com/photos.angel.co/startups/i/79840-e351f55eea90356818e586ca3e547981-thumb_jpg.jpg?buster=1333248008
        [url] => https://angel.co/joinastartup-org
        [name] => JoinAStartup.org
        [type] => Startup
    )

[1] => Array
    (
        [id] => 121425
        [pic] => https://s3.amazonaws.com/photos.angel.co/startups/i/121425-7cea796d5afc33877d68c633963ec8e9-thumb_jpg.jpg?buster=1353964843
        [url] => https://angel.co/jointly
        [name] => Jointly
        [type] => Startup
    )

[2] => Array
    (
        [id] => 76554
        [pic] => https://s3.amazonaws.com/photos.angel.co/startups/i/76554-d227b51eac3509eeba4cced14186b782-thumb_jpg.jpg?buster=1347923043
        [url] => https://angel.co/supportlocal
        [name] => SupportLocal
        [type] => Startup
    )

[3] => Array
    (
        [id] => 30334
        [pic] => https://s3.amazonaws.com/photos.angel.co/startups/i/30334-219f36ea273ef199c2aaf7b034554b90-thumb_jpg.jpg?buster=1326922125
        [url] => https://angel.co/jointli
        [name] => Jointli
        [type] => Startup
    )

[4] => Array
    (
        [id] => 14278
        [pic] => https://s3.amazonaws.com/photos.angel.co/startups/i/14278-8b9059bb1fa7fab5813dfbade19056eb-thumb_jpg.jpg?buster=1315736993
        [url] => https://angel.co/joint
        [name] => joint
        [type] => Startup
    )

[5] => Array
    (
        [id] => 22687
        [pic] => https://s3.amazonaws.com/photos.angel.co/startups/i/22687-94e1104706736e7636d23ff055819b8c-thumb_jpg.jpg?buster=1337954356
        [url] => https://angel.co/join-our-talents
        [name] => Join Our Talents
        [type] => Startup
    )

[6] => Array
    (
        [id] => 45059
        [pic] => 
        [url] => https://angel.co/joint-research-centre
        [name] => Joint Research Centre
        [type] => Startup
    )

[7] => Array
    (
        [id] => 119433
        [pic] => https://s3.amazonaws.com/photos.angel.co/startups/i/119433-585159079dc0e8b31156e772d53914de-thumb_jpg.jpg?buster=1346721187
        [url] => https://angel.co/joinspeaker-1
        [name] => JoinSpeaker
        [type] => Startup
    )

[8] => Array
    (
        [id] => 40214
        [pic] => 
        [url] => https://angel.co/advanced-joining-technology
        [name] => Advanced Joining Technology
        [type] => Startup
    )

[9] => Array
    (
        [id] => 35338
        [pic] => https://s3.amazonaws.com/photos.angel.co/startups/i/35338-52ca618ccef71f1a67b21e2e838a4674-thumb_jpg.jpg?buster=1326845104
        [url] => https://angel.co/joingo
        [name] => Joingo
        [type] => Startup
    )

) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:22:55.400

我认为问题是为什么打印语句不起作用？首先，`<br>`在每一行的末尾，这不是有效的 PHP 语法，我希望这不在您的实际代码中。

其次，关于打印语句......响应是一个数组，因此您可以使用以下方式访问它：

```
$response[0]['name'] 
```

替换`0`为您要访问的元素的索引。您甚至可以使用循环来遍历结果并获取所有名称

```
$len = count($response);
for ($i = 0; $i < $len; ++$i) {
    print $response[$i]['name'];
} 
```

您还可以使用[foreach](http://php.net/manual/en/control-structures.foreach.php)循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T06:27:08.660

您需要使用类似的东西遍历数组`foreach`，例如

改变：

```
print $response->{'name'}; 
```

到：

```
foreach ($response as $r) {
    echo $r['name'];
} 
```

# java - 如何在tomcat中为Web应用程序配置外部文件夹中的log4j.properties

> ID：14088751
> 
> 赞同：3
> 
> 时间：2012-12-30T06:17:10.343
> 
> 标签：java, jakarta-ee, tomcat, classpath, tomcat5.5

请帮助如何处理以下情况。

**当前 Web 应用程序：** [我已将 log4j.propertes 放在`/WEB-INF/classes`webapp 的文件夹中。]

**想要实现：** [将 log4j.properties 放在外部位置并从我的 Web 应用程序中引用，这样我就可以随时修改日志位置，而无需重新构建战争。]

`$CATALINA_HOME/propdirwebapp1/log4j.properties $CATALINA_HOME/propdirwebapp2/log4j.properties`

[如果我部署了多个应用程序，请提出解决方案。如果服务器上只部署了一个应用程序，请提出解决方案]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-30T15:25:08.247

在我的情况下，`web.xml`我添加了`Log4jConfigListener`它并且它有效。`log4jRefreshInterval`在这里是可选的。

```
<context-param>
    <param-name>log4jConfigLocation</param-name>
    <param-value>file:/<your-path-here>/log4j.properties</param-value>
</context-param>
<context-param>
    <param-name>log4jRefreshInterval</param-name>
    <!-- Refresh log4j configuration every 5 minutes. -->
    <param-value>300000</param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
</listener> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:58:15.627

无需重建war文件，直接修改log4j.properties并重启tomcat即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T13:17:33.783

您可以将目录添加到 $CATALINA_BASE/conf/catalina.properties 中的 shared.loader 属性。

```
shared.loader=conf/myapp/ 
```

然后把log4j.properties放到这个目录下。

但是有两个限制。

1）如果有一个 log4j.properties 文件`WEBINF/classes`将首先加载

2) 该目录被所有 webapps 共享，因此所有 webapps 只能有一个 log4j.properties 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-19T13:30:54.313

我喜欢我的尝试，它只处理不同战争应用程序的日志级别。

将自定义属性文件放在 conf 中，例如

```
$CATALINA_BASE/conf/my.properties 
```

创建条目，如

```
myapp.loglevel = INFO
myapp2.loglevel = DEBUG 
```

读取每个请求的道具，例如

```
myProps = new Properties();
myProps.load(new FileInputStream(new File(System.getProperty("catalina.base"), "conf/my.properties"))); 
```

读取和使用属性，例如在请求开始时在 servlet 中

```
String myLoglevel = (String)myProps.get("myapp.loglevel");
LogManager.getRootLogger().setLevel(Level.toLevel(myLoglevel)); 
```

我们正在使用 slf4j-log4j12 并且我读过 log4j2 中没有 LogManager，但我确信这种机制也可以应用于 log4j2。

# android - 我将如何使用 ArrayAdapter、ListView 和菜单根据用户输入添加项目切换到新活动

> ID：14088752
> 
> 赞同：0
> 
> 时间：2012-12-30T06:17:27.847
> 
> 标签：android, eclipse, listview, android-activity, android-arrayadapter

我正在设计的应用程序基于一个菜单，其项目是由用户输入 EditText 然后通过单击按钮提交文本来创建的。我还希望能够根据用户单击他们创建的菜单项来进行新活动。到目前为止，这是我的 Java 代码：

```
 package com.example.doodlestudy;

    import java.io.FileOutputStream;
    import java.util.ArrayList;

    import android.os.Bundle;
    import android.app.Activity;
    import android.content.Context;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.ArrayAdapter;
    import android.widget.Button;
    import android.widget.EditText;
    import android.widget.ListView;

    public class MainActivity extends Activity {

private OnClickListener AddToString;

Button Badd;
EditText ETadd;
ListView LVmain;

String filename = "Main_Activity";
String input;
FileOutputStream outputStream;

ArrayAdapter<String> m_adapter;
ArrayList<String> m_listItems = new ArrayList<String>();

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Badd = (Button)findViewById(R.id.Badd);
    ETadd = (EditText)findViewById(R.id.ETadd);
    LVmain = (ListView)findViewById(R.id.LVmain);

    m_adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, m_listItems);
    LVmain.setAdapter(m_adapter);

    Badd.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            input = ETadd.getText().toString();

            m_listItems.add(new String(input));
            m_adapter.notifyDataSetChanged();   
        }
    });

    try {
        outputStream = openFileOutput(filename, Context.MODE_PRIVATE);
        outputStream.write(input.getBytes());
        outputStream.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
}
    } 
```

这是我的xml代码：

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
android:padding="10dp"
tools:context=".MainActivity" >

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal">

    <EditText
        android:id="@+id/ETadd"
        android:layout_width="200dp"
        android:layout_height="wrap_content"
        android:ems="10"
        android:hint="Click to Edit..." >

        <requestFocus />
    </EditText>

    <Button
        android:id="@+id/Badd"
        android:layout_width="100dp"
        android:layout_height="wrap_content"
        android:text="Add" />
</LinearLayout>

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical">

    <ListView
        android:id="@+id/LVmain"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ListView>
</LinearLayout> 
```

这是我的清单：

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.doodlestudy"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="16" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.example.doodlestudy.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

我还没有触摸我的清单，因为我无法让我的代码允许转换到一个新的活动。我想我可能需要一种不同的方式来存储用户在 EditText 中创建的字符串，但我并不肯定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T07:08:48.603

听起来您想要的是`ClickListener`为您的 设置一个`ListView`，就像您的按钮一样，它会将您带到下一个`Activity`。这是它的样子：

```
 LVmain.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> parent, View v, int position,
                    long id) {
                Intent intent = new Intent(MainActivity.this, SecondActivity.class);
//              intent.putExtra(name, value);
//              take the time to put extra information that you need for the next activity here
                startActivity(intent);
            }
        }); 
```

然后你的清单也需要知道你的新活动。

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.doodlestudy"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="16" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.doodlestudy.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name="SecondActivity"></activity> 
        // add your activities to your manifest
    </application> 
```

# c++ - 从 C++ 中的双精度数中检索分数部分

> ID：14088755
> 
> 赞同：0
> 
> 时间：2012-12-30T06:17:44.743
> 
> 标签：c++, double, fractions

我以双精度输入，然后对其进行类型转换以取出小数部分。但是，当输入是一个小数字时，可以说`4294967295.2`，小数部分被检索，但是当我输入一个更大的数字时，小数部分变为零。我知道这是一些数字，但我对这些东西有点陌生。当输入数字像.时，小数部分为零的原因是`9007199254740991.2`什么？这是代码：

```
unsigned long long first,second;
double a,b,remainderA,remainderB;
cout << "Enter first number:\n"<< endl;
cin>> a;
cout << "\nEnter second number:\n"<< endl;
cin >> b;

first=(unsigned long long) a;
second=(unsigned long long) b;

remainderA=a-first;
remainderB=b-second;

cout<<remainderA<<endl; 
```

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:32:29.230

这只是一个精度问题。一个双精度数有 52 位尾数，它给出了大约 15-17 位的十进制数字。您的第二个示例达到了此限制，并且最有可能的分数 (0.2) 不会存储在双精度中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:29:04.280

当输入数字足够大以驻留在目标类型中时，它将强制转换为 0。您正在以具有更大范围的双精度输入。并将其转换为具有较小范围的 unsigned long long 。这就是问题发生的原因。

你可以看看以下

[http://www.tutorialspoint.com/cprogramming/c_type_casting.htm](http://www.tutorialspoint.com/cprogramming/c_type_casting.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T06:36:29.690

double 的范围为：1.7E +/- 308（15 位）
，unsigned long long 的范围为：0 到 18,446,744,073,709,551,615（20 位）

，您首先投射=（unsigned long long）a；
例如。如果您在“a”中插入 9007199254740991.2，则
插入的值为

```
 a = 9,0072e+015 
    first :90071992547409910 
```

因此**它的精度问题**。这就是你遇到问题的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T07:09:29.807

浮点数存储一定数量的数字。如果数字太长，则小数部分已经超过数据类型的限制精度。

要获得更多的有效数字`double`，请尝试`long double`。例如，这个输出 `0.2`（大约，同样由于精度有限）：[https ://ideone.com/i8Yyt0](https://ideone.com/i8Yyt0)

您可能希望用于`std::floor`执行舍入，因为将大数转换为整数类型会导致未定义的行为，它超出了整数类型的范围。（它可能会崩溃，例如将整数除以零。）

# javascript - nodejs中的工作流引擎

> ID：14088761
> 
> 赞同：1
> 
> 时间：2012-12-30T06:19:35.070
> 
> 标签：javascript, node.js, workflow, state-machine

我正在编写一个 QA 机器人，

它使用 expressjs 作为后端服务，客户端使用 REST 提出问题并得到答复。

所以我正在寻找工作流引擎或状态机库。

已阅读[Javascript 中的工作流引擎，](https://stackoverflow.com/questions/10414849/workflow-engine-in-javascript) 但它似乎在前端使用。

并找到了一个 lib noflo ，但对于不熟悉英语的新手来说很难使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-07T08:19:31.870

看看[https://github.com/steelbreeze/state](https://github.com/steelbreeze/state) - 这提供了一个松散地基于 UML 2 语义的分层状态机（使用状态之间的“完成转换”，您可以实现类似工作流的行为）。

[https://steelbreeze.net/state/](https://steelbreeze.net/state/)上还有更多示例

# android - Android -- 操作栏选项卡旁边的图像图标，使用 Sherlock 库

> ID：14088762
> 
> 赞同：2
> 
> 时间：2012-12-30T06:19:37.993
> 
> 标签：android, tabs, android-actionbar, actionbarsherlock

我目前正在将 ActionBarSherlock 实施到我现有的项目中。

我计划使用 3 个标签。我可以让选项卡正常工作，但我似乎无法找出一个问题。

我的目标是低端手机，因为我的应用程序对许多型号的手机都非常友好。但是，在选项卡布局中使用操作栏、选项卡布局以及查看分页器是有代价的。在我的 HTC Incredible 测试手机上，碎片似乎相当小。

因此，我决定取出操作栏，并尝试在我的“标签”旁边添加一个图标。

使用 TabView，我当然可以将它放在父视图中并添加一个图标，但是我在操作栏（或特别是 ActionBarSherlock）上做同样的事情时遇到了麻烦

我当然是使用编程方式添加标签；

```
final ActionBar actionBar = getSupportActionBar();
actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

actionBar.setDisplayShowHomeEnabled(false);
actionBar.setDisplayShowTitleEnabled(false);

for (int i = 1; i <= 3; i++) {
        ActionBar.Tab tab = getSupportActionBar().newTab();
        tab.setText("Tab " + i);
        tab.setTabListener(this);
        getSupportActionBar().addTab(tab);
} 
```

非常感谢帮助或提示。

谢谢

# python - 重定向网址只是打印到屏幕 - python

> ID：14088763
> 
> 赞同：3
> 
> 时间：2012-12-30T06:19:40.757
> 
> 标签：python, url, redirect, cgi-bin

我编写了一个简单的 python 脚本来在点击广告后重定向一个 url。
与广告关联的 url 是`http://server.example.com/redirect.py`。

的代码`redirect.py`如下所示：

```
import cgi
import cgitb

cgitb.enable()
print('Content-Type: text/html\n\n')
print('Location: http://www.finalurl.com') 
```

然而，不是将请求重定向到`www.finalurl.com`点击广告时，最终的 url 只是简单地显示在浏览器窗口中。非常感谢所有帮助。

请注意，`redirect.py`脚本在`/public_html/cgi-bin/`文件夹中，并且脚本具有`711`权限。此外，目标 url 并不总是相同的 url，它基于数据库查询。该代码被简单地省略了。

我还尝试了包括：`print ("Status: 301 Moved")`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T06:41:26.893

'\n\n' 是 http 标头标记的结尾，请改用：

```
print 'Status: 301 Moved Permanently'
print 'Location: http://www.finalurl.com'
print 'Content-Type: text/html'
print # end of header
... # short html with the url 
```

# twitter-bootstrap - 更改引导模式视图的形状

> ID：14088765
> 
> 赞同：2
> 
> 时间：2012-12-30T06:19:54.843
> 
> 标签：twitter-bootstrap, modal-dialog

有没有办法改变 Twitter Bootstrap 模式视图的背景形状（例如，变成菱形或圆形）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:56:08.777

尝试在 bootstrap.css 中编辑以下代码

```
.modal {
  position: fixed;
  top: 50%;
  left: 50%;
  z-index: 1050;
  width: 560px;
  margin: -250px 0 0 -280px;
  overflow: auto;
  background-color: #ffffff;
  border: 1px solid #999;
  border: 1px solid rgba(0, 0, 0, 0.3);
  *border: 1px solid #999;
  -webkit-border-radius: 6px;
     -moz-border-radius: 6px;
          border-radius: 6px;
  -webkit-box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3);
     -moz-box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3);
          box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3);
  -webkit-background-clip: padding-box;
     -moz-background-clip: padding-box;
          background-clip: padding-box;
} 
```

还有其他模态相关的CSS

# ruby-on-rails - 实现抽象基模型类，Rails Way™

> ID：14088768
> 
> 赞同：15
> 
> 时间：2012-12-30T06:20:34.347
> 
> 标签：ruby-on-rails, activerecord, inheritance, abstract-class, sti

我有一个共享许多属性的**Book**和**Download**模型，所以我的目标是从**DownloadableResource**模型继承公共属性。
看了一下[STI](http://my.safaribooksonline.com/book/web-development/ruby/9780132480345/advanced-active-record/ch09lev1sec5)，但我采用了[抽象基模型类](http://my.safaribooksonline.com/book/web-development/ruby/9780132480345/advanced-active-record/ch09lev1sec6)的方式：

*   楷模：

    ```
    class DownloadableResource < ActiveRecord::Base
      self.abstract_class = true

      attr_accessible :title, :url, :description, :active, :position
      validates :title, :url, :description, presence: true
      scope :active, where(active: true).order(:position)
    end

    class Book < DownloadableResource
      attr_accessible :cover_url, :authors
      validates :cover_url, :authors, presence: true
    end

    class Download < DownloadableResource
      attr_accessible :icon_url
      validates :icon_url, presence: true
    end 
    ```

*   迁移：

    ```
    class CreateDownloadableResources < ActiveRecord::Migration
      def change
        create_table :downloadable_resources do |t|
          t.string    :title
          t.string    :url
          t.text      :description
          t.boolean   :active,      default: false
          t.integer   :position
          t.timestamps
        end
      end
    end

    class CreateBooks < ActiveRecord::Migration
      def change
        create_table :books do |t|
          t.string :cover_url
          t.string :authors
          t.timestamps
        end
      end
    end

    class CreateDownloads < ActiveRecord::Migration
      def change
        create_table :downloads do |t|
          t.string :icon_url
          t.timestamps
        end
      end
    end 
    ```

迁移后，当我创建新书时，结果远非预期：

```
> Book.new
=> #<Book id: nil, cover_url: nil, authors: nil, created_at: nil, updated_at: nil> 
```

有人可以说明如何实现抽象基模型类技术，以便 ActiveRecord 模型可以通过[继承](https://stackoverflow.com/a/2330533/341929)共享公共代码，但可以持久保存到不同的数据库表？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-30T14:28:57.410

通过将模型声明为抽象，您实际上是在说没有基础表并且您希望允许子类化。这意味着：

*   你不需要`downloadable_resources`桌子
*   Book.table_name 打印`books`而不是`downloadable_resources`

正如@Finbarr 已经提到的，这也意味着模型`Book`和`Download`模型都需要在其表中具有所有属性。

那么这实际上有什么用呢？在我看来不是很多。您可以共享验证、范围等，但您可以通过包含自定义模块更轻松地实现所有这些。

To solve your problem I would probably go with a different approach. I would create another model called `DownloadableContent` that would be self contained. It would include validations and the table would have all of the attributes. And finally models `Book` and `Download` would have a polymorphic `has_one` relation to the `DownloadableContent` model.

You could go with the STI approach but I generally don't like mixing all of the custom attributes together.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T06:48:22.873

在这种情况下不应该有一张`downloadable_resources`桌子。您的书籍和下载表都应该声明他们需要的所有字段。

# android - 如何在 SQLite 中添加日期时间函数

> ID：14088770
> 
> 赞同：0
> 
> 时间：2012-12-30T06:20:55.210
> 
> 标签：android, sqlite, timestamp

> **可能重复：**
> [如何在 Android 应用程序中插入日期时间设置为“现在”的 SQLite 记录？](https://stackoverflow.com/questions/754684/how-to-insert-a-sqlite-record-with-a-datetime-set-to-now-in-android-applicatio)

我正在开发一个将名称、密码等存储到数据库的应用程序。而且我还想将当前日期和时间存储到数据库中并稍后检索。我无法破解如何在 SQLite 数据库中存储日期和时间。我应该使用日期时间功能吗？如果是，如何在我的后续示例中添加它。请帮忙。

提前致谢。

```
public class DBAdapter{public static final String ROWID = "_id";
public static final String NAME = "name";
public static final String EMAIL = "email";
public static final String PASSWORD = "password";
public static final String TYPE = "type";
private static final String TAG = "DBAdapter";
private static final String DATABASE_NAME = "primus_db";
private static final String DATABASE_TABLE = "user_db";
private static final int DATABASE_VERSION = 1;
private static final String DATABASE_CREATE = "create table user_db (_id integer primary key autoincrement, "
        + "name text not null, "
        + "email text not null, "
        + "password text not null," + "type text not null );";
private final Context context;
private DatabaseHelper DBHelper;
private SQLiteDatabase db;

/**
 * 
 */
public DBAdapter(Context ctx) {
    this.context = ctx;
    this.DBHelper = new DBAdapter.DatabaseHelper(this.context);
}

private static class DatabaseHelper extends SQLiteOpenHelper {
    DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        try {
            db.execSQL(DATABASE_CREATE);
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.w(TAG, "Upgrading database from version " + oldVersion + " to "
                + newVersion + ", which will destroy all old data");
        db.execSQL("DROP TABLE IF EXISTS contacts");
        onCreate(db);
    }
}

// ---opens the database---
public DBAdapter open() throws SQLException {
    db = DBHelper.getWritableDatabase();
    return this;
}

// ---closes the database---
public void close() {
    DBHelper.close();
}

// ---insert a contact into the database---
public long insertContact(String name, String email, String password,
        String type) {
    ContentValues initialValues = new ContentValues();
    initialValues.put(NAME, name);
    initialValues.put(EMAIL, email);
    initialValues.put(PASSWORD, password);
    initialValues.put(TYPE, type);
    return db.insert(DATABASE_TABLE, null, initialValues);
}

// ---retrieves all the contacts---
public Cursor getAllContacts() {
    return db.query(DATABASE_TABLE, new String[] { ROWID, NAME, EMAIL,
            PASSWORD, TYPE }, null, null, null, null, null);
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:26:59.800

你可以遵循不同的方式。您可以 `DATETIME('NOW')`在将时间戳插入记录时使用，不是吗？或者您可以在创建表时使用它。

```
time TIMESTAMP DEFAULT CURRENT_TIMESTAMP 
```

其中 time 是采用当前时间的列。

有关更多详细信息，请参阅[此](http://www.sqlite.org/lang_datefunc.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:38:38.300

如果您计划重用该日期/时间数据，例如“在开始日期和结束日期之间”函数或类似的东西，我建议使用`timestamp`like`DATETIME('NOW')`和 use `long datatype`。或者如果只是为了记录，你可以使用`currentDateTime.getTime())`和使用`text datatype`.

# html - 使用 CSS 弹出窗口编写统计公式

> ID：14088777
> 
> 赞同：0
> 
> 时间：2012-12-30T06:22:47.233
> 
> 标签：html, css

我正在尝试将我刚刚格式化的公式与我在下面设置的 CSS 弹出窗口结合起来。通过组合，我的意思是我希望弹出窗口像在文本上一样显示在公式上，但保留公式的格式。我正在使用 CSS 样式来与 Google 网站兼容。

任何帮助将不胜感激。

```
<!DOCTYPE html>
<html>
    <head>
        <title>document title</title>
        <style type="text/css">
a.info
{
    position:relative;
    z-index:24; background-color:#ddd;
    color:#000;
    text-decoration:none
}

a.info:hover {z-index:25; background-color:#ff0}

a.info span{display: none}

a.info:hover span
{
    display:block;
    position:absolute;
    top:2em; left:2em; width:10em;
    border:2px solid #0cf;
    background-color:#555; color:#fff;
}
        </style>
    </head>
    <body>
        <a href="http://www.bylau.com" style="text-decoration:none;">
            <font face="times new roman, serif" size="5">
                SS<sub>T</sub>&nbsp;=&nbsp;∑ (<i>x</i><sub><i>i&nbsp;</i></sub>− <i>x̄</i><sub>grand</sub>)<sup>2</sup>
            </font>
        </a>
        <br>
        <br>
        <a href="www.bylau.com" title="squared">
            <span style="text-decoration:overline;">
                <span class="texhtml">
                    <var>
                        z
                    </var>
                    <!--can't get bar over z without finding special character or having underline-->
                </span>
            </span>
        <br>
        <br>    
        </a>
        The<a class="info" href="http://www.bylau.com"> SS<sub>T </sub><span>variable explanation</span></a>formula should be here.
    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T06:29:09.623

只需`white-space: nowrap;`用于`a.info:hover span`

[**演示**](http://jsfiddle.net/cy9RJ/)

> 注意：`<font>`标签已弃用，使用 CSS 为您的元素提供大小、颜色、字体系列

标记

```
<!DOCTYPE html>
<html>
    <head>
        <title>document title</title>
        <style type="text/css">
a.info {
    position:relative;
    z-index:24; background-color:#ddd;
    color:#000;
    text-decoration:none
}

a.info:hover {z-index:25; background-color:#ff0}

a.info span{display: none}

a.info:hover span {
    display:block;
    position:absolute;
    top:2em; left:2em; width:10em;
    border:2px solid #0cf;
    background-color:#555; color:#fff;
    white-space: nowrap; <-------- Here
}
</style>
</head>
    <body>
        <a href="http://www.bylau.com" style="text-decoration:none;">
            <font face="times new roman, serif" size="5">
                SS<sub>T</sub>&nbsp;=&nbsp;∑ (<i>x</i><sub><i>i&nbsp;</i></sub>− <i>x̄</i><sub>grand</sub>)<sup>2</sup>
            </font>
        </a>
        <br>
        <br>
        <a href="www.bylau.com" title="squared">
            <span style="text-decoration:overline;">
                <span class="texhtml">
                    <var>
                        z
                    </var>
                    <!--can't get bar over z without finding special character or having underline-->
                </span>
            </span>
        <br>
        <br>    
        </a>
        The<a class="info" href="http://www.bylau.com"> SS<sub>T </sub><span><font face="times new roman, serif" size="5">
                SS<sub>T</sub>&nbsp;=&nbsp;∑ (<i>x</i><sub><i>i&nbsp;</i></sub>− <i>x̄</i><sub>grand</sub>)<sup>2</sup>
            </font></span></a>formula should be here.
    </body>

</html> 
```

# vim - 更改 CTRL+S 以在 vim 中保存文件时 TAB 不起作用

> ID：14088778
> 
> 赞同：0
> 
> 时间：2012-12-30T06:22:49.387
> 
> 标签：vim, key-bindings

我尝试使用`CTRL`+将文件保存在 vim 中`S`。我遇到了这个链接[http://vim.wikia.com/wiki/Map_Ctrl-S_to_save_current_or_new_files](http://vim.wikia.com/wiki/Map_Ctrl-S_to_save_current_or_new_files)并根据它分别在 .basrc 和 vimrc 中添加了这些代码：

```
vim()
{
local STTYOPTS="$(stty --save)"
stty stop '' -ixoff
command vim "$@"
stty "$STTYOPTS"
} 
```

和

```
nmap <C-s> :wq!<cr> 
```

现在好了`CTRL`+`S`保存文件。但`TAB`现在在插入模式下不起作用。当我按`TAB`时，光标返回当前行的第一列！！有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:36:48.123

`:nmap`仅定义正常模式下的映射。对于插入模式，使用`:imap`（通常，`:inoremap`除非你真的需要重新映射，否则更喜欢），并首先通过预先`<C-o>`设置（对于单个命令）或（更合适的这里，因为无论如何`<Esc>`你想离开缓冲区）离开插入模式`:quit`.

```
:inoremap <C-s> <C-o>:wq!<cr> 
```

* * *

顺便说一句，我觉得你也想退出缓冲区很有趣。对我来说，映射很有帮助，因为我可以在编辑过程中快速键入它，这样我就可以经常持久化更改。

```
" Use CTRL-S for saving, also in Insert mode
:nnoremap <C-S>     :<C-U>update<CR>
:vnoremap <C-S>     :<C-U>update<CR>gv
:cnoremap <C-S>     <C-C>:update<CR>
:inoremap <C-S>     <C-O>:update<CR> 
```

# ruby - 如何阻止我的媒体文件的盗链？

> ID：14088782
> 
> 赞同：0
> 
> 时间：2012-12-30T06:23:06.430
> 
> 标签：ruby, ruby-on-rails-3, hotlinking

我有可以从其他网站热链接的 swf 和图像文件，例如在这个[问题](https://stackoverflow.com/questions/5657462/stop-my-swf-file-from-being-hotlinked)中 如何使用[HTTP Referer 标头](http://en.wikipedia.org/wiki/HTTP_referrer)让我的 swf 文件只能从我的网站查看？

编辑

我的文件托管在我的服务器上，我没有使用 Amazon S3 服务或其他文件托管服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:28:21.797

您应该确保引用链接与您的域具有相同的域，例如如果您有 nginx：

```
location ~* (\.swf)$ {
    valid_referers blocked mydomain.com www.mydomain.com;
    if ($invalid_referer) ) {
        return 444;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T00:58:38.293

```
if request.env['HTTP_REFERER'] =~ /yourdomain\.com\//
  # serve asset
end 
```

请注意，`nil =~ regex # => nil`您无需先检查是否`request.env['HTTP_REFERER']`存在。

**编辑：**

关于 =~ 运算符的更多信息：[Object#=~](http://ruby-doc.org/core-1.9.3/Object.html#method-i-3D-7E)、 [String#=~](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-3D-7E)、[Regex#=~](http://www.ruby-doc.org/core-1.9.3/Regexp.html#method-i-3D-7E)

```
$ irb
> nil =~ /something/
=> nil 
```

# node.js - 主机名/IP 与证书的替代名称不匹配

> ID：14088787
> 
> 赞同：22
> 
> 时间：2012-12-30T06:24:20.537
> 
> 标签：node.js, ssl, openssl, ssl-certificate, csr

我正在尝试使用带有自签名证书的 Node.js 0.8.8 创建 TLS 服务器/客户端设置。

基本的服务器代码看起来像

```
var tlsServer = tls.createServer({
  key: fs.readFileSync('server-key.pem'),
  cert: fs.readFileSync('server-cert.pem')
}, function (connection) {
  // [...]
});
tlsServer.listen(3000); 
```

现在，当我尝试连接到此服务器时，我使用以下代码：

```
var connection = tls.connect({
  host: '192.168.178.31',
  port: 3000,

  rejectUnauthorized: true,
  ca: [ fs.readFileSync('server-cert.pem') ]
}, function () {
  console.log(connection.authorized);
  console.log(connection.authorizationError);
  console.log(connection.getPeerCertificate());
}); 
```

如果我删除线

```
ca: [ fs.readFileSync('server-cert.pem') ] 
```

从客户端代码，Node.js 抛出一个错误告诉我`DEPTH_ZERO_SELF_SIGNED_CERT`。据我了解，这是因为它是一个自签名证书，并且没有其他方信任该证书。

如果我删除

```
rejectUnauthorized: true, 
```

同样，错误消失了-但`connection.authorized`等于`false`实际上意味着我的连接未加密。无论如何，使用`getPeerCertificate()`我可以访问服务器发送的证书。由于我想强制执行加密连接，我知道我可能不会删除此行。

现在我读到我可以使用该`ca`属性来指定我希望 Node.js 信任的任何 CA。[TLS模块](http://nodejs.org/api/tls.html#tls_tls_connect_port_host_options_callback)的文档暗示将服务器证书添加到`ca`数组中就足够了，然后一切都应该没问题。

如果我这样做，这个错误就消失了，但我得到了一个新的：

```
Hostname/IP doesn't match certificate's altnames 
```

对我来说，这意味着 CA 现在基本上是受信任的，因此现在没关系，但是证书是为我使用的另一台主机制作的。

我使用创建了证书

```
$ openssl genrsa -out server-key.pem 2048
$ openssl req -new -key server-key.pem -out server-csr.pem
$ openssl x509 -req -in server-csr.pem -signkey server-key.pem -out server-cert.pem 
```

正如文档所暗示的那样。在创建 CSR 时，我会被问到一些常见的问题，例如国家、州、... 和通用名称 (CN)。正如您在“网络上”被告知的 SSL 证书一样，您*没有*提供您的 CN 名称，而是您想要使用的主机名。

这可能是我失败的地方。

我试过

*   `localhost`
*   `192.168.178.31`
*   `eisbaer`
*   `eisbaer.fritz.box`

其中最后两个是我的机器的本地名称和完全限定的本地名称。

知道我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-12-18T16:19:07.130

最近有一个[添加到 node.js](https://github.com/joyent/node/commit/bf5e2f246eff55dfc33318f0ffb4572a56f7645a)，它允许使用自定义函数覆盖主机名检查。它已添加到 v0.11.14，并将在下一个稳定版本 (0.12) 中提供。现在您可以执行以下操作：

```
var options = {
  host: '192.168.178.31',
  port: 3000,
  ca: [ fs.readFileSync('server-cert.pem') ],
  checkServerIdentity: function (host, cert) {
    return undefined;
  }
};
options.agent = new https.Agent(options);
var req = https.request(options, function (res) {
  //...
}); 
```

这现在将接受任何服务器身份，但仍会加密连接并验证密钥。

**请注意**，在以前的版本中（例如`v0.11.14`），它`checkServerIdentity`会返回一个`boolean`指示服务器有效性的值。如果存在问题并且如果存在有效，则已将其（之前`v4.3.1`）更改为 function `return`ing（not `throw`ing）错误。`undefined`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-30T08:16:27.753

在[tls.js 的第 112-141 行中](https://github.com/joyent/node/blob/77ed12fe7a16d3d97d637512db109f4273711bec/lib/tls.js#L112-L141)，您可以看到如果调用时使用的主机名`connect`是 IP 地址，则证书的 CN 将被忽略，并且仅使用 SAN。

由于我的证书不使用 SAN，因此验证失败。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-30T11:35:36.633

如果您使用主机名进行连接，则会根据 DNS 类型的主题备用名称（如果有）检查主机名，否则将使用主题可分辨名称中的 CN。

如果您使用 IP 地址进行连接，则会根据*IP 地址*类型的 SAN 检查 IP 地址，而不会退回到 CN。

这至少是符合[HTTP over TLS](https://www.rfc-editor.org/rfc/rfc2818#section-3.1)规范（即 HTTPS）的实现所做的。有些浏览器更宽容一些。

[这与Java 中的这个答案](https://stackoverflow.com/a/8444863/372643)完全相同，它还提供了一种通过 OpenSSL 放置自定义 SAN 的方法（[也请参阅此文档](http://www.crsr.net/Notes/SSL.html)）。

一般来说，除非是用于测试 CA，否则很难管理依赖于 IP 地址的证书。使用主机名连接会更好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-01-27T20:07:09.103

Mitar 有一个错误的假设，即 checkServerIdentity 应该在成功时返回“真”，但实际上它应该在成功时返回“未定义”。任何其他值都被视为错误描述。

所以这样的代码是正确的：

```
var options = {
  host: '192.168.178.31',
  port: 3000,
  ca: [ fs.readFileSync('server-cert.pem') ],
  checkServerIdentity: function (host, cert) {
    // It can be useful to resolve both parts to IP or to Hostname (with some synchronous resolver (I wander why they did not add done() callback as the third parameter)).
    // Be carefull with SNI (when many names are bound to the same IP).
    if (host != cert.subject.CN)
      return 'Incorrect server identity';// Return error in case of failed checking.
      // Return undefined value in case of successful checking.
      // I.e. you could use empty function body to accept all CN's.
  }
};
options.agent = new https.Agent(options);
var req = https.request(options, function (res) {
  //...
}); 
```

我试图在 Mitar 的答案中进行编辑，但编辑被拒绝，所以我创建了一个单独的答案。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-30T08:45:17.363

您做错的是使用 IP 地址而不是域名。创建一个域名并将其粘贴在 DNS 服务器中（或只是在主机文件中），创建一个以域名作为 Common Name 的自签名证书，并连接到域名而不是 IP 地址。

# javascript - 同时打开多个窗口，popupWindow 和 New Tab

> ID：14088793
> 
> 赞同：1
> 
> 时间：2012-12-30T06:25:47.050
> 
> 标签：javascript, google-chrome-extension

我一直致力于使用javascript同时打开一个popupWindow和一个_blank URL的能力。这是我所拥有的：

```
newPopup('http://www.someurl.com');
newTab('http://www.otherurl.com');

function newPopup(url) {
    popupWindow = window.open(url,'popUpWindow','formatting stuff here'); }

function newTab(url) {
    newLink = window.open(url,'_blank'); } 
```

我试过反转它们（首先是新窗口，然后是弹出窗口）。

我也试过：

```
var = setTimeout(Popup('http ....'),3000); 
```

我试过了：

```
chrome.tabs.create({url:"http://....."}); 
```

有人对此有任何想法吗？我注意到当 popupWindow 出现时，扩展页面上会出现一个检查元素，但 _blank 却没有。我可以得到任何一个或，但永远不会两者兼而有之。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T14:51:37.740

经过许多艰苦的工作，我终于让它工作了。我对此感到有些愚蠢，因为我的问题已经有了答案。

```
newPopup('http://www.someurl.com');
newTab('http://www.otherurl.com');

function newPopup(url) {
    popupWindow = window.open(url,'popUpWindow','formatting stuff here'); }

function newTab(url) {
    newTab = chrome.tabs.create({url: url});} 
```

不幸的是，我没有尝试使用window.open 加载另一个加载chrome.tabs.create，因此它们使用不同的基本过程，它在任何东西上都像培根一样工作。:)

谢谢

# objective-c - 正确裁剪从照片库中获取的图像

> ID：14088802
> 
> 赞同：8
> 
> 时间：2012-12-30T06:27:17.193
> 
> 标签：objective-c, ios, cgimage, alassetslibrary, alasset

我整天都在研究这个问题，并且在 SO 和 google 上查看了很多问题，但到目前为止我还没有想出任何正确的答案。

我在运行 iOS 5.1.1 的 iPad 上拍摄了一张照片，并使用照片应用对其进行了裁剪。然后我从资产库中获得对它的引用，并获得未裁剪的全分辨率图像。

我发现裁剪信息包含在我的对象的`AdjustmentXMP`键中。`metadata``ALAssetRepresentation`

所以我使用 XMP 信息裁剪照片，这是我得到的：

原始照片（1,936 x 2,592）：
![原始照片](../Images/e2eb97d47765e796742c32c1bc792038.png)

正确裁剪的照片，如照片应用程序中所示 (1,420 x 1,938)：
![正确裁剪的照片](../Images/0cd86576535ed7fdbc0a5dbd45178784.png)

用下面的代码裁剪的照片
（也是 1,420 x 1,938，但裁剪得离右边太远了大约 200 像素）：
![问题](../Images/b810d36e1c56a6070ad2a11788e8b3d5.png)

这是照片中的 XMP 数据：

```
<x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="XMP Core 4.4.0">
   <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
      <rdf:Description rdf:about=""
            xmlns:aas="http://ns.apple.com/adjustment-settings/1.0/">
         <aas:AffineA>1</aas:AffineA>
         <aas:AffineB>0</aas:AffineB>
         <aas:AffineC>0</aas:AffineC>
         <aas:AffineD>1</aas:AffineD>
         <aas:AffineX>-331</aas:AffineX>
         <aas:AffineY>-161</aas:AffineY>
         <aas:CropX>0</aas:CropX>
         <aas:CropY>0</aas:CropY>
         <aas:CropW>1938</aas:CropW>
         <aas:CropH>1420</aas:CropH>
      </rdf:Description>
   </rdf:RDF>
</x:xmpmeta> 
```

这是我用来裁剪照片的代码：

```
ALAssetRepresentation *rep = // Get asset representation
CGImageRef defaultImage = [rep fullResolutionImage];

// Values obtained from XMP data above:
CGRect cropBox = CGRectMake(0, 0, 1938, 1420);
CGAffineTransform transform = CGAffineTransformMake(1, 0, 0, 1, 331, 161);

// Apply the Affine Transform to the crop box:
CGRect transformedCropBox =  CGRectApplyAffineTransform(cropBox, transform);

// Created a new cropped image:
CGImageRef croppedImage = CGImageCreateWithImageInRect(defaultImage, transformedCropBox);

// Create the UIImage:
UIImage *image = [UIImage imageWithCGImage:croppedImage scale:[rep scale] orientation:[rep orientation]];

CGImageRelease(croppedImage); 
```

我用多张图片重现了这个问题。如果我只是使用`fullScreenImage`它可以完美显示，但我需要全尺寸图像。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-30T11:21:13.310

这是一个棘手的问题！这个 XMP 数据显然没有文档，所以我们必须猜测如何解释它。有许多选择要做，如果做错了可能会导致微妙的错误结果。

**TL;DR：理论上你的代码看起来是正确的，但实际上它给出了错误的结果，我们可以尝试一个相当明显的调整。**

## 方向

图像文件可能包含额外的元数据，指定图像的原始数据在显示时是否（以及如何）旋转和/或翻转。`UIImage`用它的[`imageOrientation`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIImage_Class/Reference/Reference.html#//apple_ref/occ/instp/UIImage/imageOrientation)性质来表达这一点，并且[`ALAssetRepresentation`是相似的](http://developer.apple.com/library/ios/documentation/AssetsLibrary/Reference/ALAssetRepresentation_Class/Reference/Reference.html#//apple_ref/occ/instm/ALAssetRepresentation/orientation)。

但是，`CGImage`s 只是位图，其中没有存储方向。`-[ALAssetRepresentation fullResolutionImage]`为您提供`CGImage`原始方向的 a，未应用任何调整。

在您的情况下，方向是`3`, 意思`ALAssetOrientationRight`或`UIImageOrientationRight`。查看软件（例如`UIImage`）查看此值，发现图像向右（顺时针）旋转 90°，然后在显示之前将其向左旋转 90°（逆时针）。或者，换一种说法，`CGImage`从您在屏幕上看到的图像顺时针旋转 90°。

`CGImageGetWidth()`（要验证这一点，请使用和获取 CGImage 的宽度和高度`CGImageGetHeight()`。您应该会发现 CGImage 的宽度为 2592，高度为 1936。它从 旋转 90° `ALAssetRepresentation`，其`dimensions`应该是 1936 宽 x 2592 高。您还可以`UIImage`从`CGImage`使用正常方向创建一个，将`UIImageOrientationUp`写入`UIImage`文件，然后查看它的外观。）

XMP 字典中的值似乎与`CGImage`' 的方向有关。例如，裁剪矩形的宽度大于高度，X 平移大于 Y 平移，等等。这是有道理的。

## 坐标系

我们还必须决定 XMP 值应该在哪个坐标系中。很可能是这两个之一：

*   [“笛卡尔”](http://en.wikipedia.org/wiki/Cartesian_coordinate_system)：原点在图像的左下角，X向右增加，Y向上增加。这是 Core Graphics 通常使用的系统。
*   “翻转”：原点在图像的左上角，X向右增加，Y向下增加。这是 UIKit 通常使用的系统。令人惊讶的是，与大多数 CG 不同，它以这种方式[`CGImageCreateWithImageInRect()`](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CGImage/Reference/reference.html#//apple_ref/c/func/CGImageCreateWithImageInRect)解释其`rect`论点。

让我们假设“翻转”是正确的，因为它通常更方便。无论如何，您的代码已经在尝试这样做。

## 解释 XMP 字典

该字典包含一个仿射变换和一个裁剪矩形。让我们猜测它应该按以下顺序解释：

1.  应用变换
2.  以自然矩形 (0,0,w,h) 绘制图像
3.  取消应用变换（弹出变换堆栈）
4.  裁剪到裁剪矩形

如果我们手动尝试，数字似乎可以解决。这是一个粗略的图表，裁剪矩形为半透明紫色：

![翻转案例示意图](../Images/3df59224c956bfdc91cc3beccb0b30b4.png)

## 现在一些代码

在调用 CG 方面，我们实际上不必遵循这些确切的步骤，但我们应该表现得好像我们有那样。

我们只想调用`CGImageCreateWithImageInRect`，并且很明显如何计算适当的裁剪 rect `(331,161,1938,1420)`。您的代码似乎可以正确执行此操作。

如果我们将图像裁剪为该矩形，然后`UIImage`从中创建一个（指定正确的方向，`UIImageOrientationRight`），那么我们应该得到正确的结果。

*但是，结果是错误的！* 你得到的*就像*我们在笛卡尔坐标系中进行操作一样：

![笛卡尔案例图](../Images/091c23ae2b15405a352b571cc501c5cc.png)

或者，就好像图像被旋转到相反的方向`UIImageOrientationLeft`，但我们保持相同的裁剪矩形：

![左向案例图](../Images/e67d6bee3668fc90c03ea734ea3c3375.png)

## 更正

这一切都很奇怪，我不明白出了什么问题，尽管我很乐意。

但修复似乎相当简单：只需翻转剪辑矩形。如上计算后：

```
// flip the transformedCropBox in the image
transformedCropBox.origin.y = CGImageGetHeight(defaultImage) - CGRectGetMaxY(transformedCropBox); 
```

那样有用吗？（对于这种情况，以及其他方向的图像？）

# php - 相同的 PHP 脚本在浏览器中显示的输出与从命令行运行时不同

> ID：14088803
> 
> 赞同：1
> 
> 时间：2012-12-30T06:27:38.583
> 
> 标签：php, multithreading, mongodb

我在根目录中有一个 PHP 应用程序，其中有 2 个名为“ **database.php** ”和“ **Thread.php** ”的文件（已从[此处](http://blog.motane.lu/2009/01/02/multithreading-in-php/)下载 Thread.php ）。database.php 在连接到远程 MondoDb 数据库后执行一些琐碎的任务。这是 database.php 的代码：

```
<?php
include('Thread.php');

$dbUser = 'MyUserName';
$dbPass = 'MyPassword';
$dbHost = 'dsxxxxxx.mongolab.com';
$dbPort = 'xxxxx';
$dbName = 'MyDatabaseName';
$collectionName = 'TestCollection';

function connectToDatabase($dbUser, $dbPass, $dbHost, $dbPort, $dbName) {
    try {
        reconnect:
        echo "connecting to mongodb://{$dbUser}:{$dbPass}@{$dbHost}:{$dbPort}/{$dbName} ...<br/>";
        $database = new MongoClient("mongodb://{$dbUser}:{$dbPass}@{$dbHost}:{$dbPort}/{$dbName}");
        echo "connected ...<br/>";
    }
    catch (MongoConnectionException $e) {
        goto reconnect;
    }
    return $database->$dbName;
}

$database = connectToDatabase($dbUser, $dbPass, $dbHost, $dbPort, $dbName);

$collection = $database->$collectionName;

function modifyRecent($id, $error, $time) {
     global $database;
     echo "In function modifyRecent ...<br/>";
     //do something
     return;
}

function modifyAll($id, $error, $time) {
     global $database;
     echo "In function modifyAll ...<br/>";
     //do some other things
     return;
}

function updateDatabase($id, $error, $time) {
    echo "In function updateDatabase ...<br/>";
    if( ! Thread::available() ) {
        echo "Thread is not supported ...<br/>";
        return false;
    }

    $thread1 = new Thread('modifyAll');
    $thread2 = new Thread('modifyRecent');

    $thread1->start($id, $error, $time);
    $thread2->start($id, $error, $time);

    while($thread1->isAlive() || $thread2->isAlive()) {}

    return true;
}

updateDatabase((float)"1", (float)"12.6", (float)"23.7");

?> 
```

现在当我从 shell () 运行这个脚本时`php database.php`......它显示了一个输出：

```
user@local_machine:~/AppDir$ php database.php 
connecting to mongodb://MyUserName:MyPassword@dsxxxxxx.mongolab.com:xxxxx/MyDatabaseName ...<br/>connected ...<br/>In function updateDatabase ...<br/>In function modifyAll ...<br/>In function modifyRecent ...<br/>
user@local_machine:~/AppDir$ 
```

这意味着一切顺利。

**但是从浏览器（ http://app.localhost/database.php** ）运行相同的脚本后，输出为：

```
connecting to mongodb://MyUserName:MyPassword@dsxxxxxx.mongolab.com:xxxxx/MyDatabaseName ...
connecting to mongodb://MyUserName:MyPassword@dsxxxxxx.mongolab.com:xxxxx/MyDatabaseName ...
connecting to mongodb://MyUserName:MyPassword@dsxxxxxx.mongolab.com:xxxxx/MyDatabaseName ...
connecting to mongodb://MyUserName:MyPassword@dsxxxxxx.mongolab.com:xxxxx/MyDatabaseName ...
connected ...
In function updateDatabase ...
Thread is not supported ... 
```

PS：我已经配置了一个虚拟主机（**http://app.localhost/**），它指向我的应用程序的根目录（**~/AppDir**），以便在本地对其进行测试。

谁能指出我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:33:29.387

`pcntl_fork()`当 PHP 用作 Apache 模块时，无法使用该功能。您只能`pcntl_fork()`在 CGI 模式或命令行中使用。

Thread.php 使用`pcntl_*()`函数。

`Thread::available()`返回 false的原因就是因为这个。功能是：

```
public static function available() {
    $required_functions = array(
        'pcntl_fork',
    );

    foreach( $required_functions as $function ) {
        if ( !function_exists( $function ) ) {
            return false;
        }
    }

    return true;
} 
```

由于您无权修改服务器。*您可以*通过执行以下操作将 PHP 文件作为 CGI 运行，前提是您的主机支持 CGI 和 .htaccess

创建一个 .htaccess 文件并将其放在 database.php 所在的文件夹中，并将以下内容放入其中：

```
Action php-script /FULL_PATH_TO_YOU_PHP_BINARY
AddHandler php-script php 
```

# c - 如何从函数返回矩阵（二维数组）？（C）

> ID：14088804
> 
> 赞同：16
> 
> 时间：2012-12-30T06:27:39.217
> 
> 标签：c, function, multidimensional-array

我创建了一个生成宾果板的函数，我想返回宾果板。

正如我没想到的那样，它不起作用。

这是功能：

```
int** generateBoard() {
    int board[N][M], i, j , fillNum;
    Boolean exists = True;
    // initilize seed
    srand(time(NULL));
    // fill up..
    for(i = 0; i < N; ++i) {
        for(j = 0; j < M; ++j) {
            exists = True;
            while(exists) {
                fillNum = rand()%MAX_RANGE + 1; // limit up to MAX_RANGE
                if(beenAdded(board, fillNum) == Exist) {
                    continue;
                } else {
                    board[i][j] = fillNum;
                    exists = False;
                }
            }
        }
    }
    return board;
} 
```

我在“返回板”行有一个编译错误（红色子线）。

**有没有办法在不**使用结构\动态分配的情况下返回二维数组？

我正在使用 Microsoft Visual C++ Express 2010。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-30T06:53:08.513

您定义`board`为局部变量 - 当函数超出范围时，它的内存被释放。

您可以将板声明为全局，也可以像这样动态创建它：

```
int **allocate_board(int Rows, int Cols)
{    
    // allocate Rows rows, each row is a pointer to int
    int **board = (int **)malloc(Rows * sizeof(int *)); 
    int row;

    // for each row allocate Cols ints
    for (row = 0; row < Rows; row++) {
        board[row] = (int *)malloc(Cols * sizeof(int));
    }

    return board;
} 
```

您将需要动态释放板：

```
// you must supply the number of rows
void free_board(int **board, int Rows) 
{
    int row;

    // first free each row
    for (row = 0; row < Rows; row++) {
         free(board[row]);
    }

    // Eventually free the memory of the pointers to the rows
    free(board);
 } 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-12-30T06:37:06.397

*有人必须在某处*拥有该板的内存，更重要的是，该所有权必须延伸回该函数的调用者。如果没有动态分配，您唯一的其他真正选择是将其作为 in/out 参数发送到函数中。

```
void generateBoard(size_t N, size_t M, int board[N][M])
{
    int i, j , fillNum;
    Boolean exists = True;
    // initilize seed
    srand(time(NULL));
    // fill up..
    for(i = 0; i < N; ++i) {
        for(j = 0; j < M; ++j) {
            exists = True;
            while(exists) {
                fillNum = rand()%MAX_RANGE + 1; // limit up to MAX_RANGE
                if(beenAdded(board, fillNum) == Exist) {
                    continue;
                } else {
                    board[i][j] = fillNum;
                    exists = False;
                }
            }
        }
    }
} 
```

并从你的调用者这样调用：

```
int main()
{
    const size_t N = 10;
    const size_t M = 10;
    int board[N][M];

    generateBoard(N,M,board);

    ...
} 
```

我还会考虑将`srand()`调用重新定位到`main()`. 理想情况下，它应该永远不会出现在某些可能重复调用的函数中，并且应该保证每个流程执行只执行**一次。**（注意：老实说，我不记得它是否每个*线程*执行一次，但在你的编码学习曲线的这一点上，我猜多线程还没有出现在雷达上）。

最后，您的随机填充循环是不必要的重复。有更好的替代方案可以生成您显然想要做的事情：创建现有数字集的随机排列。如所写，您可以旋转一段时间以尝试填充最后几个插槽，具体取决于`MAX_RANGE`与`(N*M)`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-07-26T13:41:57.823

```
int **setMatrix(int *row1, int *cols1) //return matrix
{
    int row, cols;
    int **matrix;
    printf("enter row:\n");
    scanf("%d",&row);
    printf("enter cols:\n");
    scanf("%d",&cols);

    matrix=(int **)calloc(cols ,sizeof(int*));
      for(int i=0;i<cols ;i++)
      {
          matrix[i]=(int *)calloc(row ,sizeof(int));
      }
    *row1=row;
    *cols1=cols;
    return matrix;

}

int main()
{
   int row ,cols;
   int **matrix;

   matrix=setMatrix(&row, &cols); //get the matrix back 

   return 0;
 } 
```

# java - 使用 App Engine 查询游标 (Java - JDO)

> ID：14088808
> 
> 赞同：2
> 
> 时间：2012-12-30T06:28:33.697
> 
> 标签：java, google-app-engine, google-cloud-datastore, jdo

我需要在我的结果获取中实现分页，所以在环顾四周时，我在 Google Developer 网站上获得了指向查询游标的链接，但文章解释了使用低级 API 使用查询游标（我避免像瘟疫这样的事情） . 我在 JDO 上看到的所有`setRange(start, end)`内容（如果我是对的）都不是那么有效，因为您仍然需要为获取和丢弃范围之前的结果所涉及的开销付出代价。如何在 App Engine 数据存储之上的 JDO 中使用查询游标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T11:58:00.687

来自 appengine 文档：

```
Query q = pm.newQuery(Person.class);
q.setRange(0, 20);

List<Person> results = (List<Person>) q.execute();
// Use the first 20 results

Cursor cursor = JDOCursorHelper.getCursor(results); 
```

[https://developers.google.com/appengine/docs/java/datastore/jdo/queries](https://developers.google.com/appengine/docs/java/datastore/jdo/queries)

然后，使用光标（也在提供的文档中，您应该阅读）：

```
String cursorString = cursor.toWebSafeString();
// Send cursor around as string

// Query q = the same query that produced the cursor;
Cursor cursor = Cursor.fromWebSafeString(cursorString);
Map<String, Object> extensionMap = new HashMap<String, Object>();
extensionMap.put(JDOCursorHelper.CURSOR_EXTENSION, cursor);
q.setExtensions(extensionMap);
q.setRange(0, 20); //note, the same range; 
//the query should cover everything you expect to load.
q.execute(); 
```

# asp.net - ASP.NET 在上传文件时丢失会话变量

> ID：14088809
> 
> 赞同：0
> 
> 时间：2012-12-30T06:28:53.473
> 
> 标签：asp.net, c#-3.0

我正在使用 jQuery uploadify 插件在 ASP.NET 中上传文件。在上传文件之前，我可以访问像 userId 这样的会话变量。但是当我立即点击上传时，我丢失了会话变量。当我访问 Session [ _UserId] 。可能是什么原因。我在做什么错误？

谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:45:52.910

要通过此插件上传图像，我相信您使用了 ashx 处理程序，并且可能您正在使用会话。

为了获得会话，处理程序类必须实现 IReadOnlySessionState 接口。

例子 ：

```
using System.Web.SessionState;

public class Handler : IHttpHandler, IReadOnlySessionState
{
    // your stuff
} 
```

希望这会有所帮助！

# ssh - bitbucket - 无法确定主机“bitbucket.org”的真实性

> ID：14088810
> 
> 赞同：8
> 
> 时间：2012-12-30T06:28:55.800
> 
> 标签：ssh, bitbucket

我在尝试推送到我的 bitbucket 存储库时遇到了这个问题，不知道为什么指纹不匹配：

![http://imgur.com/38p8n](../Images/8cc2b088e95dbe5aa90f8898f0c297a6.png)
![http://imgur.com/3B35N](../Images/27d44a05e0cae1ea9560244199081c7e.png)
它询问我是否要继续，但点击确定后我无法在对话框中输入任何内容。有什么见解吗？提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-16T05:00:15.750

我有同样的问题..发现发生这种情况是因为 bitbucket.org 不在 Known Host list 中。这些是从头开始的步骤......（假设您将 EGit 与 Eclipse 一起使用并配置了 ssh 密钥）

编辑： **创建本地存储库**
1.右键单击项目->团队->共享项目
2.从菜单中选择 GIT 单击下一步（忽略消息“未设置 HOME 环境变量..”）
3.选择使用或创建存储库。在父文件夹中...并选择项目
4.hit create repo。按钮 -> 完成

**1.在Eclipse中打开Git Repository View**
Window->show view->other->Git->Git Repository

![Git 存储库视图](../Images/65bfbd8d8379263b504dc4bedbe8e834.png)

**2.输入repo名称** ![输入回购名称](../Images/c2861d6ea3c77fe1044e635041efb1ca.png)

**3.从下一个窗口点击添加按钮输入存储库uri点击完成** ![在此处输入图像描述](../Images/3acab30bf91e23e805b746a12d733ae3.png)

**4.现在单击试运行按钮，您应该会看到以下对话框，单击是，bitbucket 将被添加到已知主机**
![在此处输入图像描述](../Images/dd43b9fabda221300933dd0e476d27e9.png)

**5.最后点击保存并按下按钮**

# android - 如何从 Necessitas Android 应用程序中删除所有默认权限？

> ID：14088811
> 
> 赞同：1
> 
> 时间：2012-12-30T06:28:56.147
> 
> 标签：android, qt, android-permissions, qt-necessitas

适用于 Android 的 Necessitas 应用程序似乎默认启用了三个权限：

```
- Storage
     modify/delete SD card contents
- Network communication
     full internet access
- Phone calls
     read phone state and identity 
```

我想删除它们。我已经尝试在我的所有项目文件中搜索，`uses-permission`并从以下位置找到并删除了这两行`AndroidManifest.xml`：

```
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
```

但是，现在删除这些行后，我的 Necessitas 应用程序仍然需要两个权限：

```
- Storage
     modify/delete SD card contents
- Phone calls
     read phone state and identity 
```

看来我已经摆脱了只有网络权限。我如何摆脱这三个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:27:35.887

当我将使用 Necessitas 开发的应用程序发布到 Google Play 时，权限`Phone calls`消失了，我不知道为什么：P

权限`Storage`仍然有效，我的应用程序需要它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T07:01:27.003

应用程序所需的所有权限都列在`AndroidManifest.xml`文件中，例如

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

如果不需要，您可以从清单中删除它们。您的清单中还有哪些其他权限？

但是，如果您的应用程序需要您已删除的权限才能运行，您将收到异常。因此，您需要检查您的应用是否需要已删除的权限

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-29T18:30:45.923

仔细阅读清单文件中的内容：

```
<!-- The following comment will be replaced upon deployment with default permissions based on the dependencies of the application.
     Remove the comment if you do not require these default permissions. -->
<!-- %%INSERT_PERMISSIONS --> 
```

# c# - C#，基于套接字通信的二进制序列化

> ID：14088821
> 
> 赞同：4
> 
> 时间：2012-12-30T06:32:39.977
> 
> 标签：c#, sockets, visual-studio-2008, network-programming

我使用二进制序列化对象来读取或写入数据流，以前如果我们要写入/读取它们，我们必须将*“实例类”*编译为 DLL 文件，这样我们之间就有相同的程序集，对吗？

现在好了，这是我的问题：

这是我的二进制发件人代码

```
public void SendBinarySerial(object graph)
{
    IFormatter formatter = new BinaryFormatter();

    System.Net.Sockets.NetworkStream strm = mClient.GetStream(); //get TCPclient stream

    formatter.Serialize(strm, graph);
} 
```

这是我的二进制接收器代码：

```
private void doRead()
{
    do 
     {
       if (mClient.GetStream().CanRead) 
          {
             System.Net.Sockets.NetworkStream strm = mClient.GetStream();

              IFormatter formatter = new BinaryFormatter();

              object mydat = (object)formatter.Deserialize(strm);//deserialize data receiver         
           }
    } while (true);
} 
```

这是我想发送给所有客户的*“实例类”代码。*好的让我们考虑以下代码：

```
[Serializable()]
public class DataSend
{
    public List<Bitmap> MainData = new List<Bitmap>();
    public List<string> Title = new List<string>();
} 
```

如您所见，有几个*列表*变量，例如位图和字符串。位图数据用于图像数据。如果我用许多图像填充它，它将增加可变内存的大小，可能约为 20 mb。

之后，我将把它们发送给所有客户。好吧，这是我的问题：

**使用这种技术，如果大小对象约为 20 mb，这会很好吗？我知道 Socket 通信对发送数据有大小限制**

我根本不想定义任何协议，我只想使用套接字通信，尽管这可能不是最好的方法。

感谢您的答复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:45:00.837

我不会担心使用套接字的大小限制。根据我的经验，可以从 NetworkStream 读取/写入任意大小的数据。但是，我会担心 Bitmap 对象的可序列化性。据我所知，这不会序列化图像数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T13:23:46.540

The BinaryFormatter will really start to struggle once your file size is above several MB. Have you considered using an [open source communication library](http://www.networkcomms.net) which uses more sophisticated serialisation techniques?

Using networkcomms.net your send method would become (you just provide the RAW object and it does all of the serialisation for you):

```
NetworkComms.SendObject("DataPacket", ipAddress, port, object); 
```

On the receive end you code would be:

```
NetworkComms.AppendGlobalIncomingPacketHandler<object>("DataPacket", (header, connection, incomingObject) => { object mydat = incomingObject; });
TCPConnection.StartListening(); 
```

# php - 如何将数据从一个php页面传递到另一个页面

> ID：14088822
> 
> 赞同：-2
> 
> 时间：2012-12-30T06:32:39.053
> 
> 标签：php, html, mysql

我正在构建三个相互链接的 php 页面，例如。
1\. 客户详情
2\. 产品详情
3\. 付款详情
与每个在线购物网站提供的相同程序或机制。现在，我只需要传递或保存任何用户在第一个表单（即客户资料页面）到第二个表单（即产品详细信息）填写的数据/值，而无需将数据提交或插入数据库，以及第二页的值，即带有第一页数据的产品详细信息应传递到第三页，即付款详细信息，现在当单击第三页的提交按钮时，所有三个页面的全部数据或值应存储或最终插入数据库。
我知道php为此提供了方法，我也为此使用了GET和POST方法，但根本不是
这是我的代码
-对于第一页-

```
 <HTML>
     <head>
       <?php
            $value1 = trim($_POST[name]);
        $value2 = trim($_POST[address]);
    $value3= trim($_POST[city]);
        ?>
     </head>
     <body>
       <form action="secondpage.php" method="POST">
         //content of form
        <?php
           echo "<a href='secondpage.php?name=" . $value1 . " && address=" . $value2 .              " && city=" . $value3 . "'><input type='button' value='Proceed To Customer Profile!!!' class='submit' style='cursor:pointer;cursor:hand;' />";
           ?>
  </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:42:00.603

我可以建议两种方法：1-将每个页面表单信息存储在用户会话中。你可以通过使用 $_SESSION PHP 变量来做到这一点。但请注意，您必须在使用它之前调用 session_start。

```
$_SESSION["PAGE1"] = array (
    'var1' => 'value1', 
    'var2' => 'value3', 
    ....
); 
```

2-您可以在每个页面中放置一个隐藏输入，并将从其他页面收集的数据序列化到此隐藏输入中。您可以选择 base64_decode/base64_encode 和 json_encode/json_decode 来序列化您的数据，或者您可以使用 PHP 内置的序列化/反序列化函数。

```
$serializedData = base64_encode ( json_encode ( $_POST ) );
$originalData = json_decode ( base64_decode ( $serializedData ) ); 
```

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T06:44:15.547

你可以这样做

1.  暂时将数据插入数据库，然后再将其删除。这是最有效的方法。

2.  将其存储在`$_SESSION[]`变量中并在用户的整个会话期间访问它

3.  最低效的方法是通过仅使用 GET 方法将数据链接到三个网页并将不相关的数据隐藏在`<input type='hiden' value='$val'>`

4.  将它们存储在文件或 cookie 中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T06:35:57.170

您可以将会话中的值存储在多维数组中，如下所示：

```
 $_SESSION['customer_details'] 
 $_SESSION['Product_details'] 
 $_SESSION['Payment_Details'] 
```

您可以将客户详细信息的所有详细信息存储为

```
$_SESSION['customer_details']['name'] = $_POST['name'];
$_SESSION['customer_details']['email'] = $_POST['email']; 
```

其余页面相同。一旦您从付款网关获得确认，您就可以在数据库中存储/插入值。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-30T06:35:36.817

首先，请学习格式化您的问题，它真的会为您提供很好的答案，其次是为了将数据从`page1`to传递`page2`到`page3`您可以用来存储用户数据的最佳位置，`$_SESSION`然后您可以`unset`在他完成后使用表单提交

# c# - SQL插入，更新看不到现有记录，而是复制了已创建的记录

> ID：14088823
> 
> 赞同：0
> 
> 时间：2012-12-30T06:32:51.793
> 
> 标签：c#, asp.net, sql, sql-server

我有一个奇怪的情况，我正在检查插入或更新记录是否存在于通过 html 表行的循环中的数组中。如果我填写第一条记录并将第二条记录留空，它会将其插入数据库，但稍后将不接受任何插入第二行的记录，而是复制第一行记录。可互换的是，如果我先填充第二行。如果我将它们都填满@开头，它将同时插入它们，但是对于以后的任何更改，它将无法识别（未找到）第二条记录，并且会复制第一条记录？

![在此处输入图像描述](../Images/40c085598cf518c88321abb09d24f66e.png)

下面是代码：

```
#region //if exist update else insert inserting code
//Response.Write("<script>alert('InputDate = " + stringList2[6] + 
//" and Dept= " + stringList2[7] + " and DeptType= " + stringList2[8] + 
//" and DeptSubType= " + stringList2[9] + "')</script>");
con.Open();
//cmd = new SqlCommand("SELECT 1 FROM MainDailyData WHERE Dept= '" + stringList2[7] + 
//    "' and DeptType = '" + stringList2[8] + "' and DeptSubType= '" + stringList2[9] + "'", con);
cmd = new SqlCommand("SELECT 1 FROM MainDailyData WHERE Dept= @dpt and DeptType = @dptType and DeptSubType= @DptSbType", con);
cmd.Parameters.AddWithValue("@dpt", stringList2[7]);
cmd.Parameters.AddWithValue("@dptType", stringList2[8]);
cmd.Parameters.AddWithValue("@DptSbType", stringList2[9]);

bool fRecordExists = false;
SqlDataReader dr = cmd.ExecuteReader();
//SqlDataReader dr = cmd.ExecuteScalar();
if (dr != null && dr.HasRows)
{
fRecordExists = true;
}
dr.Close();
dr.Dispose();
if (fRecordExists)
{
Response.Write("<script>alert('Found,Update')</script>");
SqlDataAdapter myda = new SqlDataAdapter();
myda.UpdateCommand = new SqlCommand("UPDATE MainDailyData SET Product1 = @Prod1, Product2 = @Prod2, Product3 = @Prod3, Product4 = @Prod4, Product5 = @Prod5, Product6 = @Prod6, InputDate = @InDate, Dept = @Dpt, DeptType = @DptType, DeptSubType = @DptSubType", con);
myda.UpdateCommand.Parameters.Add("@Prod1", SqlDbType.VarChar).Value = stringList2[0];
myda.UpdateCommand.Parameters.Add("@Prod2", SqlDbType.VarChar).Value = stringList2[1];
myda.UpdateCommand.Parameters.Add("@Prod3", SqlDbType.VarChar).Value = stringList2[2];
myda.UpdateCommand.Parameters.Add("@Prod4", SqlDbType.VarChar).Value = stringList2[3];
myda.UpdateCommand.Parameters.Add("@Prod5", SqlDbType.VarChar).Value = stringList2[4];
myda.UpdateCommand.Parameters.Add("@Prod6", SqlDbType.VarChar).Value = stringList2[5];
myda.UpdateCommand.Parameters.Add("@InDate", SqlDbType.VarChar).Value = stringList2[6];
myda.UpdateCommand.Parameters.Add("@Dpt", SqlDbType.VarChar).Value = stringList2[7];
myda.UpdateCommand.Parameters.Add("@DptType", SqlDbType.VarChar).Value = stringList2[8];
myda.UpdateCommand.Parameters.Add("@DptSubType", SqlDbType.VarChar).Value = stringList2[9];
myda.UpdateCommand.ExecuteNonQuery();
}
else
{
Response.Write("<script>alert('not Found,Insert')</script>");
SqlDataAdapter myda = new SqlDataAdapter();
myda.InsertCommand = new SqlCommand("INSERT INTO MainDailyData (Product1,Product2,Product3,Product4,Product5,Product6,InputDate,Dept,DeptType,DeptSubType) VALUES(@Prod1,@Prod2,@Prod3,@Prod4,@Prod5,@Prod6,@InDate,@Dpt,@DptType,@DptSubType)", con);
myda.InsertCommand.Parameters.Add("@Prod1", SqlDbType.VarChar).Value = stringList2[0];
myda.InsertCommand.Parameters.Add("@Prod2", SqlDbType.VarChar).Value = stringList2[1];
myda.InsertCommand.Parameters.Add("@Prod3", SqlDbType.VarChar).Value = stringList2[2];
myda.InsertCommand.Parameters.Add("@Prod4", SqlDbType.VarChar).Value = stringList2[3];
myda.InsertCommand.Parameters.Add("@Prod5", SqlDbType.VarChar).Value = stringList2[4];
myda.InsertCommand.Parameters.Add("@Prod6", SqlDbType.VarChar).Value = stringList2[5];
myda.InsertCommand.Parameters.Add("@InDate", SqlDbType.VarChar).Value = stringList2[6];
myda.InsertCommand.Parameters.Add("@Dpt", SqlDbType.VarChar).Value = stringList2[7];
myda.InsertCommand.Parameters.Add("@DptType", SqlDbType.VarChar).Value = stringList2[8];
myda.InsertCommand.Parameters.Add("@DptSubType", SqlDbType.VarChar).Value = stringList2[9];
myda.InsertCommand.ExecuteNonQuery();
}
con.Close();
#endregion 
```

如果这考虑到重复线程，我深表歉意，但我之前的问题有所不同并已解决。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:51:07.827

从我的角度来看，您的更新命令错过了 Where 子句，这很奇怪。这看起来是问题的原因，至少我在您的代码中没有看到其他明显的问题。您如何确定要更新的行？

此外，后续无需调用 DataReader.Dispose 和 DataReader.Close 方法。DataReader.Dispose 方法调用 Close 本身。

# java - Switch 似乎比 if 慢

> ID：14088824
> 
> 赞同：12
> 
> 时间：2012-12-30T06:32:53.880
> 
> 标签：java, performance, if-statement, switch-statement

我对 on 的速度很好奇`switch`，认为它“非常”快，但是我有一个测试用例，似乎显示单个开关大约与 4`if`次测试一样快，而我预计（没有充分的理由）它会与 1 次测试一样快。这是我写的两种比较`switch`方法`if`：

```
public static int useSwitch(int i) {
    switch (i) {
        case 1: return 2;
        case 2: return 3;
        case 3: return 4;
        case 4: return 5;
        case 5: return 6;
        case 6: return 7;
        default: return 0;
    }
}

public static int useIf(int i) {
    if (i == 1) return 2;
    if (i == 2) return 3;
    if (i == 3) return 4;
    if (i == 4) return 5;
    if (i == 5) return 6;
    if (i == 6) return 7;
    return 0;
} 
```

这是我的测试代码：

```
long x = 0;
for (int i = 0; i < 999999; i++)
    x += useIf(i % 7); // I use "x" so calls won't get optimized out 
```

还有另一个相同的循环`useSwitch()`

在我的机器上，这些循环*大约需要相同的时间*才能完成，这令人惊讶。
我得出的 if 数为“4”，因为这是给定输入范围的平均值（我认为）。
如果我减少逻辑选项的数量，`if`版本会明显更快。

我的问题是：

它`switch`实际上*不是*那么快，还是在某种程度上这是一个“不公平”的测试？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-30T07:30:12.567

这在某种程度上是不公平的比较。大部分 CPU 时间将用于处理模运算：`i % 7`. 即使在最新最好的 CPU 上取模也非常慢，并且执行时间可能比您尝试进行基准测试的 if() 或 switch() 实现长 20 倍。

此外，有两种不同的方式可以优化 switch 语句。一种是查找表，它用于您提出的顺序情况。另一种方法是在适当的情况下使用**搜索分区树**。当案例*稀疏*时会发生这种情况，例如在以下示例中：

```
switch (someInt) {
    case 0:  ... break;
    case 10:  ... break;
    case 102:  ... break;
    case 6543:  ... break;
    case 19303:  ... break;
    case 19305:  ... break;
    // and so forth...
} 
```

大多数编译器将使用展开的分区树来找到正确的情况，这在长开关上提供了非常好的平均和最坏情况跳转，以达到正确的情况。生成的伪代码将是这样的：

```
if (someInt >= 6543) {
    if (someInt >= 19303) {
        // continue tree search, etc.
    }
    else if (someInt==6543) {}
}
else if (someInt >= 0) {
    if (someInt >= 10) {
        // continue tree search, etc.
    }
    else if (someInt == 0) {} 
}
else {
    // default case handler...
} 
```

此处显示的仅 6-8 个案例并没有太大帮助，但如果您有一个可能有 50 多个案例的开关，那么它会非常有帮助。线性搜索将具有 O(n)（最差 50 个条件，平均 25 个），而分区树版本将接近 sqrt(n)（最差 8-9 个条件，平均 5-7 个，具体取决于编译器选择）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T07:02:52.320

switch应该更快，看字节码就够了

```
 TABLESWITCH
      1: L1
      2: L2
      3: L3
      4: L4
      5: L5
      6: L6 
```

看是不是特殊操作。在现实生活中，由于 JVM 优化，可能没有区别。但是，如果我们使用 -Xint（仅解释模式）运行您的代码，那么差异应该很明显，在我的 PC 上，它是 63 到 93（毫秒），有利于切换。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T06:49:38.097

这里有趣的问题是编译器如何翻译 switch （可能像哈希表或结果可能类似于 if-else 结构）。它还可以根据输入（如果已知）进行各种优化。但是，这取决于编译器，并且在我知道的任何规范中都没有定义。

所以，我不能给你答案，但我可以告诉你，如果你想进一步完善你的测试，你总是可以给它输入 7。这将使它通过所有测试，直到返回答案，如果开关经过优化，它会给你更好的结果，如果它就像一个 if-else 它将有类似的结果。只是不要对 7 进行硬编码，以免编译器提前知道它，使用 parseint 之类的东西从字符串中获取它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T11:49:20.950

由于您的代码可能会根据 JIT 的智能程度而被消除，也可能不会被消除，因此您可能已经确定`if`语句比 switch 更容易消除。这并不奇怪，因为许多 if 语句更有可能被消除，例如断言和调试检查。

# html - 缩小时我的布局变得混乱

> ID：14088825
> 
> 赞同：2
> 
> 时间：2012-12-30T06:33:01.747
> 
> 标签：html, alignment, gets

一周前我开始学习网页设计。我正在尝试创建一个三个相邻的 div 的网页。缩小时我的布局变得混乱。50% 的缩放级别是可以的，但是当我开始进一步缩放时，右侧边栏位于内容 div 下方。请帮忙 ：（

```
<div id="wrapper">

    <div id="banner">
    </div>

    <div id="topnav">
    </div>

    <div id="leftsidebar1">
    </div>

    <div id="content">
    </div>

    <div id="rightsidebar1">
    </div>

    <div id="footer">
    </div>

</div>

here's the css

    #wrapper{
    width: 900px;
    margin: 0 auto;
    padding: 10px 0 0 0;
    max-height:1000px;  
}

    #banner{
width:900px;
height:150px;
background-color: #000;
-moz-border-radius-topleft: 10px;
-moz-border-radius-topright: 10px;
border-top-left-radius: 10px;
border-top-right-radius: 10px; 
```

}

```
#leftsidebar1{
    float: left;
    width: 25%;
    height: 500px;
    background-color:#000;
}

#content{
    display:inline;
    width: 50%;
    height: 500px;
    background-color:#006;
    float:left;
}

#rightsidebar1{
    float:left;
    width: 25%;
    height:500px;
    background-color:#999;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T08:24:58.903

在父 div 中获取三个 div，并将其大小设置为三个浮动 div 的总大小。

# php - 如何从课程列表中选择学生的课程？

> ID：14088826
> 
> 赞同：-2
> 
> 时间：2012-12-30T06:33:13.230
> 
> 标签：php, javascript, jquery, mysqli

我正在创建一个可以编辑学生详细信息的脚本。因此，我从下拉菜单中的学生列表中选择了一个学生，该下拉菜单使用以下代码编译：

```
 $studentInfo = array();

            while ($studentqrystmt->fetch()) {
                $studentHTML .= sprintf("<option value='%s'>%s</option>", $dbStudentId, $dbStudentUsername) . PHP_EOL;

                $studentData                    = array();
                $studentData["StudentId"]       = $dbStudentId;
                $studentData["StudentAlias"]    = $dbStudentalias;
                $studentData["StudentUsername"] = $dbStudentUsername;
                $studentData["CourseId"]        = $dbCourseId;
                $studentData["CourseNo"]        = $dbCourseNo;
                $studentData["CourseName"]      = $dbCourseName;

                array_push($studentInfo, $studentData);

            }

            $studentHTML .= '</select>';

            $studentForm = " 
            <form action='" . htmlentities($_SERVER['PHP_SELF']) . "' method='post' id='studentForm'> 
            <p>{$studentHTML}</p>   
            </form> 
            ";

            echo $studentForm; 
```

下面是下拉菜单中学生列表的源代码：

```
<form action='...editstudent.php' method='post' id='studentForm'>
<p><strong>Students:</strong> <select name="student" id="studentsDrop">
<option value="">Please Select</option>
<option value='38'>u0495333 - Jack smith</option>
<option value='1'>u0867587 - Mayur Patel</option>
<option value='36'>u0867588 - paul smith</option>
<option value='39'>u4838229 - Chris Tucker</option>
</select> </p>   
<div id='targetdiv'></div> 
</form> 
```

现在发生的情况是，当用户被选中时，它会在相关文本输入的表单中显示学生的所有详细信息：

```
$(document).ready( function(){

                    var studentinfo = [{"StudentId":38,"StudentAlias":"u0495333","StudentForename":"Jack","StudentSurname":"smith","StudentUsername":"u0495333","StudentEmail":"u0495333@hud.ac.uk","StudentDOB":"07-12-2012","StudentYear":2,"CourseId":19,"CourseNo":"BIO234","CourseName":"Biology"},
                    {"StudentId":36,"StudentAlias":"u0867588","StudentForename":"paul","StudentSurname":"smith","StudentUsername":"u0867588","StudentEmail":"u0867588@hud.ac.uk","StudentDOB":"05-12-2012","StudentYear":2,"CourseId":2,"CourseNo":"INFO102","CourseName":"Bsc Computing"}];

        $('#studentsDrop').change( function(){

            var studentId = $(this).val();

                    if (studentId !== '') {
        for (var i = 0, l = studentinfo.length; i < l; i++)
        {
                if (studentinfo[i].StudentId == studentId) { 

        var currentid = $('#currentStudentId').val(studentinfo[i].StudentId);
        var currentusername = $('#currentStudentUsername').val(studentinfo[i].StudentUsername);
        var currentcourse = $('#currentStudentCourse').val(studentinfo[i].CourseNo + " - " + studentinfo[i].CourseName);
        var newid = $('#newStudentId').val(studentinfo[i].StudentId);
        var newusername = $('#newStudentUsername').val(studentinfo[i].StudentUsername);
        var newcourse = $('#newStudentCourse').val(studentinfo[i].CourseId);

        var text = $(this).find('option:selected').text();
        var split = text.split(' - ');
        $('#currentStudentAlias').val( split[0] );      
        $('#newStudentAlias').val( split[0] );     

                break;       
            }
          }  
        }
            else{
                $('#currentStudentAlias,#currentStudentUsername,#currentStudentCourse,#currentStudentId').val('');                   
                $('#newStudentAlias,#newStudentUsername,#newStudentCourse,#newStudentId').val('');                   

                }
        });

    }); 
```

以下是每个数据应该显示的形式：

```
<form id='editForm'>

    <p><strong>Current Student Details</strong></p>
    <table>
    <tr>
    <th></th>
    <td><input type='hidden' id='currentStudentId' name='StudentIdcurrent' value='' /> </td>
    </tr>
    <tr>
    <th>Student Number:</th>
    <td><input type='text' id='currentStudentAlias' name='StudentAliascurrent' readonly='readonly' value='' /> </td>
    </tr>
    <tr>
    <th>Username:</th>
    <td><input type='text' id='currentStudentUsername' name='StudentUsernamecurrent' readonly='readonly' value='' /> </td>
    </tr>
    <th>Course:</th>
    <td><input type='text' id='currentStudentCourse' name='StudentCoursecurrent' readonly='readonly' value=''/> </td>
    </tr>
    </table>
    <div id='currentAlert'></div>

    <p><strong>New Student Details</strong></p>
    <table>
    <tr>
    <th></th>
    <td><input type='hidden' id='newStudentId' name='StudentIdNew' value='' /> </td>
    </tr>
    <tr>
    <th valign='top'>Student Number:</th>
    <td valign='top'><input type='text' id='newStudentAlias' name='StudentAliasNew' readonly='readonly' value='' /> </td>
    <div id='studentAliasAlert'></div>
    </tr>
    <tr>
    <th valign='top'>Username:</th>
    <td valign='top'><input type='text' id='newStudentUsername' name='StudentUsernameNew' readonly='readonly' value='' /> </td>
    <div id='studentUsernameAlert'></div>
    </tr>
    <tr>
    <th valign='top'>Course:</th>
    <td id='datacourse' valign='top'><select name="courses" id="newStudentCourse">
<option value="">Please Select</option>
<option value='1'>INFO101 - Bsc Information Communication Technology</option>
<option value='2'>INFO102 - Bsc Computing</option>
<option value='8'>INFO103 - Business and Finance</option>
<option value='7'>INFO104 - English</option>
<option value='9'>INFO107 - Mathematics and Stats</option>
<option value='16'>INFO120 - Science</option>
</select>
    <div id='studentCourseAlert'></div></td>
    </tr>
    </table>

    </form> 
```

请注意，您可以看到上面表格中显示的课程列表。

现在一切都在 jquery 中工作，期望这一行：`var newcourse = $('#newStudentCourse').val(studentinfo[i].CourseId);`

我试图对上面的行做的是，当一个学生被选中时，它将从课程列表中选择用户当前正在学习的课程下拉菜单中的课程。问题是在选择学生后，它仍然在课程下拉菜单中显示“请选择”选项

我的问题是，在下面下拉菜单中的课程列表中，如何在选择学生后在课程下拉菜单中选择学生的课程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:48:54.600

如果您发布的编辑是您的确切代码，则您的代码没有任何直接错误。我将它复制到一个 jsFiddle - [http://jsfiddle.net/GSDUx/](http://jsfiddle.net/GSDUx/) - 它按设计工作。

您的问题是您的 4 名学生`student` `<select>`，但您的数组中只有 2 名学生 `studentinfo`，并且数组中只有 1 门课程`studentinfo`也在 `course` `<select>`.

所以它唯一会改变的`course` `<select>`是 for
`<option value='36'>u0867588 - paul smith</option>`
=> `<option value='2'>INFO102 - Bsc Computing</option>`
**OR**
`<option value='38'>u0495333 - Jack smith</option>`
= > `<option value="">Please Select</option>`
（这会改变为`<option value="">Please Select</option>`因为`CourseId:19`不存在。

```
<select name="student">
<option value='38'>u0495333 - Jack smith</option>
<option value='1'>u0867587 - Mayur Patel</option>
<option value='36'>u0867588 - paul smith</option>
<option value='39'>u4838229 - Chris Tucker</option> 
```

* * *

```
var studentinfo =
[{"StudentId":38,"StudentAlias":"u0495333","StudentForename":"Jack","StudentSurname":"smith","StudentUsername":"u0495333","StudentEmail":"u0495333@hud.ac.uk","StudentDOB":"07-12-2012","StudentYear":2,"CourseId":19,"CourseNo":"BIO234","CourseName":"Biology"},  
{"StudentId":36,"StudentAlias":"u0867588","StudentForename":"paul","StudentSurname":"smith","StudentUsername":"u0867588","StudentEmail":"u0867588@hud.ac.uk","StudentDOB":"05-12-2012","StudentYear":2,"CourseId":2,"CourseNo":"INFO102","CourseName":"Bsc Computing"}]; 
```

* * *

```
<select name="courses">
<option value="">Please Select</option>
<option value='1'>INFO101 - Bsc Information Communication Technology</option>
<option value='2'>INFO102 - Bsc Computing</option>
<option value='8'>INFO103 - Business and Finance</option>
<option value='7'>INFO104 - English</option>
<option value='9'>INFO107 - Mathematics and Stats</option>
<option value='16'>INFO120 - Science</option> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T07:02:51.063

使用 jQuery 命令更新课程选择框的值

```
$('#newStudentCourse').val(newcourse); 
```

我附上了 jQuery 命令的简化版本：http: [//jsfiddle.net/waQYz/](http://jsfiddle.net/waQYz/)

# php - 加载用户IP后PHP解析URL

> ID：14088827
> 
> 赞同：-1
> 
> 时间：2012-12-30T06:33:17.223
> 
> 标签：php, curl, html-parsing, file-get-contents

我想知道如何在通过用户 IP 地址加载 URL 后解析它。我想知道这一点，因为对于这个站点，我想解析它会加载一个带有每个人 IP 地址的新密钥。所以当我通过 cURL 的 file_get_contents 解析它时，它给了我默认值而不是唯一键。我认为它工作的唯一方法是将页面加载到 iframe 中，然后获取 iframe 的源代码。但是，我不知道这是否可能。如果这是或者如果你们知道我可以做到这一点的方法，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:37:18.133

你说你正在尝试解析一个 URL，所以使用[`parse_url`](http://php.net/manual/en/function.parse-url.php).

但听起来您的意思是要解析页面结果中的 HTML，在这种情况下，您应该使用 DOM 解析器。有关如何使用 PHP 模块正确解析 HTML 的示例，请参阅[http://htmlparsing.com/php.html 。](http://htmlparsing.com/php.html)如果有人告诉您使用正则表达式来解析 HTML，请忽略它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:47:36.530

听起来您需要用户从他们自己的计算机上实际获取 url 并将结果发送给您。为什么不将 url 加载到 iframe 中，然后使用 ajax 函数将 iframe 的内容发送回您的站点，对其进行操作并在必要时重定向。

看到这个关于使用 jquery 处理加载到 iframe [iframe 内容更改事件中的内容的对话？](https://stackoverflow.com/questions/2433966/iframe-contents-change-event)

请参阅 jquery ajax 文档，了解如何将此信息提交到您自己的 php 文件 [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

不确定这是否是您想要的，但您可能必须这样做才能将 url 的内容作为用户的 ip 地址。

# javascript - 在 Windows Store Javascript 应用程序中使用 Ace 编辑器

> ID：14088831
> 
> 赞同：0
> 
> 时间：2012-12-30T06:33:38.813
> 
> 标签：javascript, windows-store-apps, ace-editor

因此，我尝试将 ACE 嵌入到我正在开发的 Windows 8 JavaScript 应用程序中，但遇到了很多麻烦。这是我用来将我的`<pre id="ace-editor">`元素变成 Ace 编辑器的代码。

```
WinJS.Utilities.ready(function ()
{
    var editor = ace.edit('ace-editor');

    editor.setTheme('ace/theme/monokai');

    editor.getSession().setMode('ace/mode/javascript');
    editor.getSession().setTabSize(4);
    editor.getSession().setUseSoftTabs(false);
    editor.setShowPrintMargin(false);

}); 
```

首先，出现了一个重复的光标，带有一点位置和闪烁的时间偏移。请看下面的图片。

![](../Images/7702ed2f7599342aca230b9bf04553b3.png)

其次，一旦我创建了编辑器，我必须调用每个方法两次，这样我才能更改我的编辑器对象的属性。例如，看下面的片段：

```
editor.setTheme('ace/theme/clouds');
editor.setTheme('ace/theme/clouds'); 
```

这就是我需要做的改变主题。调用该`setTheme()`方法一次不会这样做。

现在，我是 Windows 应用商店开发的新手，但经过一番折腾，如果我删除默认添加的核心 UI 样式表，我可以让光标消失。核心 JS 文件也是如此。如果我删除它们，双重射击问题就会消失。这里有没有人知道为什么会发生这种情况的解决方案或线索？我正在使用 Ace 的非冲突版本，但我也尝试过另一个版本。而且我想这听起来比 Ace 更像是一个 WinJS 问题，但如果这里有人可以帮助我，那就太好了。

谢谢！

更新：

对于重复光标，ACE 似乎无法正确检测 Windows 应用商店应用环境，因为它没有在其用户代理中使用字符串“Microsoft Internet Explorer”。相反，它是“MSAppHost/1.0”之类的。所以我改变了我的`ace.js`，现在我检测到两者。这是更新的代码：

```
(navigator.appName=="Microsoft Internet Explorer"||navigator.appName.indexOf("MSAppHost")>=0) 
```

谢谢，用户1743328！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:54:41.920

对于第二个光标，请参阅[https://github.com/ajaxorg/ace/blob/master/lib/ace/virtual_renderer.js#L79](https://github.com/ajaxorg/ace/blob/master/lib/ace/virtual_renderer.js#L79)可能它只是无法将 win8 useragent 识别为 IE

# ruby - 如何在 ruby 代码中使用指南针编译项目？（不使用系统调用）

> ID：14088833
> 
> 赞同：4
> 
> 时间：2012-12-30T06:33:56.067
> 
> 标签：ruby, compass-sass

如何在我的 ruby​​ 代码中调用 compass 来编译项目而不调用 shell 命令？

我尝试从[Using Compass from Ruby (not shell)](https://stackoverflow.com/questions/13129789/using-compass-from-ruby-not-shell)中调整解决方案，但没有成功。我的项目结构看起来像

```
assets/scss               (location of uncompiled project files)
assets/css                (location for compiled css)
assets/compass/config.cfg (the compass config file) 
```

我尝试过这样的事情

```
fixed_options = {
  :project_path => '/path/to/assets,
  :sass_path => 'scss',
  :css_path => 'css'
}
Compass.add_project_configuration '/path/to/assets/compass/config.rb'
Compass.add_configuration fixed_options, 'custom'
Compass.compiler.run 
```

这有效，但只有当我`irb`在项目根目录中运行时才这样做`/path/to/assets`。

似乎任何设置都可以根据需要`fixed_options`覆盖选项`config.rb`（或者它们被合并，或者有两组选项：我很难说），但是`:project_path`似乎没有做任何事情，因为指南针似乎只关心关于我运行的目录`irb`。

注意：我一直在尝试使用 in 的输出`Compass.compiler`来`irb`尝试了解正在发生的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T10:52:14.337

注意：这可能不是您想要的答案，因为它涉及 shell，但它可能是您想要的答案，因为它涉及从 shell 运行一次命令***，***然后在资产发生更改时重新编译它们。也许这对你来说就足够了。

我运行指南针的方式是使用[Guard](https://github.com/guard/guard)文件。

这是我的 Gemfile 的相关部分（我使用的是 OSX）：

```
# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem "sass"  # sassy CSS
  gem "coffee-script" # destroy javascript!
  gem "guard" # file watcher with rules
  gem "guard-coffeescript" # regen coffee
  gem "guard-sass", :require => false # auto generate sass
  gem "rb-fsevent"
  gem "growl" # notifications for OSX
end 
```

指南针配置文件：

```
# Set this to the root of your project when deployed:
http_path = "/"
css_dir = "public/css"
sass_dir = "views/stylesheets"
images_dir = "public/images"
javascripts_dir = "public/js"
project_type = :stand_alone
output_style = :compact
line_comments = false
preferred_syntax = "scss" 
```

在 ./Guardfile

```
# This will generate stuff:

guard 'coffeescript', :input => "coffee", :output => 'app/public/js'

guard 'sass', :input => 'app/views/stylesheets', :output => 'app/public/css', :compass => true, :style => "compressed", :shallow => true 
```

然后我`guard start`在终端中运行，它会监视文件的更改并在更改时重新编译。我让终端窗口在后台打开，这样我也可以强制重新编译。YMMV。

# java - 在数据库和文件中多次写入数据

> ID：14088834
> 
> 赞同：0
> 
> 时间：2012-12-30T06:34:33.813
> 
> 标签：java, file

我正在从共享地图网络驱动器目录中读取文件。逐行读取文件以登录文件夹并插入数据库然后删除。我得到一些文件多次记录相同的数据，但其他文件很好。为什么记录多次？关闭缓冲区或文件读取或解析方法有任何错误吗？

```
 public static void main(String[] args) {        
            while (true) {        
                DirectoryFetcher fetch = new DirectoryFetcher();
                if (fetch.hasFile()) {              
                    for(File file:fetch.getFiles()){
                        try {                       
                            if(file.isFile()){                  

                                boolean flag = fetch.read(file);
                                 if(flag){
                                    file.delete();
                                 }                          

                              }

                        } catch (Exception e) {
                            logger.error(e.getMessage());
                            }                                   
                    }

                }
            }
        }

public class DirectoryFetcher {     

    public DirectoryFetcher() {
        ServerParams params = Configuration.getConfig().getServerParams();
        directory = new File(params.getLocalDirectory());
        if (directory.isDirectory()) {
            files = directory.listFiles();
        }else{

            logger.info("Map Network Drive is not Exist");
        }

    }

    boolean read(File file){
            BufferedReader br = null;
            String line = null;
            boolean flag = false;
             StringBuffer appendMessage = null;
             String completeMessage = null;
            try {
                if(file.exists()){
                    br = new BufferedReader(new FileReader(file));
                     appendMessage = new StringBuffer(16384); 
                     while ((line = br.readLine()) != null) {                
                         appendMessage.append(line);
                         appendMessage.append('\n');                 
                    }            
                     if(appendMessage != null){
                         completeMessage = appendMessage.toString();
                     }                       

                    if (completeMessage != null) {
                        if (!completeMessage.equals("")) {              

                            flag = new BioRad().parse(completeMessage,file);                        

                        }
                    }
                }   
            } catch (FileNotFoundException e) {
                logger.error(e.getMessage());
                e.printStackTrace();
            }catch (Exception e) {
                logger.error(e.getMessage());
                e.printStackTrace();
            }       
            finally{

                if(br != null){
                    try {

                        br.close();

                    } catch (IOException e) {
                        logger.error(e.getMessage());
                        e.printStackTrace();
                    }
                }
            }       

            return  flag ;
        }
}

public boolean parse(String message,File file) {        
        TestResultParser parser = null;     
        String[] records = message.split(RECORD_SPILIT_PATTERN);
            List<String> result = new ArrayList<String>();
            for (String record : records) {             
                result.add(record);
            }               
            logger.info("result:: "+result.size() );            
            parser = new TestResultParser(result);      
        return log(parser,file );
    }

    private boolean log(TestResultParser parser,File file) {
        boolean logFlag = false;        
        if(parser != null) {            
            TestResultMessage report = parser.getTestResultMessage();
            //TestResultModel   model = parser.getTestResultModel();
            List<Result> list = parser.getTestResultModelList();    
            logger.info("list:: "+ list.size());            
            logFlag  = (new DBLogger()).log(list);

//          for(Result model:list){             
//              if(model != null && model.getTestCode() != null && !model.getTestCode().equals("")) {
//                  (new DBLogger()).log(model);
//                  
//              }
//          }           

            if(report != null) {            
                if (params.isOutputOnFile()) {
                    (new FileLogger()).log(report,file.getName());
                }               
            }

        }       

        return logFlag;
    } 
```

# facebook - Facebook 喜欢的盒子在 Chrome 中被截断

> ID：14088835
> 
> 赞同：1
> 
> 时间：2012-12-30T06:34:36.713
> 
> 标签：facebook, facebook-like

它在 Firefox 中运行良好，但在 chrome 中却没有，我使用了 firebug 并发现默认的 css 高度导致了这个问题。我怎样才能解决这个问题？

它在 Joomla 2.5 中使用 ITP 共享模块，尝试过溢出：可见但没有帮助。

![Facebook 喜欢的盒子在 Chrome 中被截断](../Images/9c3620709f2851c401439fb3d49c069e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T13:43:25.877

尝试使用你的 CSS 来解决这个问题。

将 facebook 共享模块放在具有唯一类或 id 的 div 中。

例子：

```
 <div id="FacebookShareContainer"><!--put here the plugin in your html page--></div> 
```

然后：

在你的css文件中：

```
 #FacebookShareContainer span{
  height:19px;
}
#FacebookShareContainer iframe{
  height:19px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T01:20:14.417

检查浏览器上的缩放 - Facebook 点赞按钮会在稍微缩小时以这种方式出现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-13T22:31:14.690

这也可能发生——尤其是在我发现的移动测试模式下——如果只是放大了 Facebook 的 iFrame。

您需要使用标签突出显示 Facebook 按钮（喜欢/登录/分享），然后根据需要使用`Ctrl``-`或`Ctrl``+`缩放。在另一个窗口中访问 Facebook.com 并进行缩放似乎并不总能解决此问题。

其他 iframe 也会发生同样的情况，例如 Paypal 按钮：

[![在此处输入图像描述](../Images/31e06a9fa6fab62590be26b6d4e4276d.png)](https://i.stack.imgur.com/Bdi3f.png)

# java - 将通用编码从 JSP 传递到支持 bean

> ID：14088838
> 
> 赞同：1
> 
> 时间：2012-12-30T06:35:21.160
> 
> 标签：java, eclipse, jsp, encoding

目前我正在使用 Eclipse 开发一个 JAVA 动态 web 项目，我想使用 JSP 将一些通用字符（例如日文/中文）提交给我的支持 bean，然后提交给数据库。我一直在网上搜索几种解决方案，但不幸的是，它们都不适合我。（仅供参考，显示字符运行良好）

*   我已经完成了网页标题的更改：

    ```
    <?xml version="1.0" encoding="UTF-8" ?>
    <%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%> 
    ```

*   我已经完成了 web.xml 中的更改：

    ```
    <url-pattern>*.jsp</url-pattern>
    <page-encoding>UTF-8</page-encoding> 
    ```

*   在 persistence.xml 中，我完成了更改：

    ```
    property name="javax.persistence.jdbc.url" 
    value="jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=UTF-8" 
    ```

*   在 tomcat server.xml 中，我完成了更改：

    ```
    URIEncoding="UTF-8" 
    ```

*   对于 bean 属性和数据库列，我还将它们设置为 utf-8 并且已经过测试可以正常工作。

所有这些更改实际上并不能解决问题。在 JSP 中，我`<h:inputText>`在我的 .出现在数据库中。

我还看到了一些其他方法，例如强制`response.setContentType("text/html; charset=utf-8")`，但是因为我直接将 JSP 链接到支持 bean，所以这不适用于我的情况。

# bash - 理解 PS1 bash 提示符中奇怪的字符语法

> ID：14088839
> 
> 赞同：1
> 
> 时间：2012-12-30T06:35:31.047
> 
> 标签：bash, shell, git-bash, ps1

这是我的 bash 提示符： ![重击](../Images/712a3a6c3fb8c076144465fd8c5286c1.png)

这是`PS1`生成的

```
PS1='${debian_chroot:+($debian_chroot)}\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]`__git_ps1`    \$ ' 
```

现在，这是我理解的东西：

*   `$debian_chroot`- 用于`su`&`sudo`
*   `u`- 用户
*   `h`- 主持人
*   其余字符喜欢`\033`用于颜色。

我不明白的是什么在**AFTER** `rails`和**BEFORE** `(master)`生成空间？那是什么角色？我想删除那个空间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T06:40:30.200

该`__git_ps1`函数正在生成它。编辑定义函数的文件。

# c++ - 为什么 glScaled(1, 1, 5) 会改变 glVertex3d(1, 1, 0) 的光照？

> ID：14088841
> 
> 赞同：2
> 
> 时间：2012-12-30T06:35:47.420
> 
> 标签：c++, objective-c, c, opengl

我正在绘制 2 个三角形，`z=0`漫射照明从上方居中。`z`如果我在轴上缩放其中一个，它会改变它的光照。因为`z=0`，我会认为在 z 轴上的缩放不会有任何效果。

我错过了什么？

* * *

## 渲染代码

```
 // Set up the a light centered horizontally.
  glEnable(GL_LIGHTING);
  glEnable(GL_LIGHT0);
  float light1Position[] = { 0.0f, 2.0f, 0.0f, 1.0f };
  float light1Diffuse[] = { 1.0f, 1.0f, 1.0f, 1.0f };
  glLightfv(GL_LIGHT0, GL_POSITION, light1Position);
  glLightfv(GL_LIGHT0, GL_DIFFUSE, light1Diffuse);

  // Set up the material.
  float material1Diffuse[] = { 1.0f, 1.0f, 1.0f, 1.0f };
  glMaterialfv(GL_FRONT, GL_DIFFUSE, material1Diffuse);

  // Transform such that we can draw in (-1, -1) to (1, 1) at z = 0.
  glTranslated(0, 0, -1);
  glScaled(2, 2, 1);

  // Draw two triangles, symmetric w.r.t. to the light and camera.
  glBegin(GL_TRIANGLES);
    glVertex3d(-1, -1,  0);
    glVertex3d( 0,  1,  0);
    glVertex3d(-1,  1,  0);
  glEnd();

  glScaled(1, 1, 5.0);  // This should be a no-op since 5 * 0 = 0.
                        // However, the following triangle is darker.
  glBegin(GL_TRIANGLES);
    glVertex3d( 1, -1,  0);
    glVertex3d( 1,  1,  0);
    glVertex3d( 0,  1,  0);
  glEnd(); 
```

* * *

## 渲染结果

![截屏](../Images/ed1b03e78e580f36683b80f21fb98803.png)

* * *

我已经上传了一个 Cocoa 项目，它[在 github 上](https://github.com/bklimt/Repro3D/blob/master/Repro3D/Repro3D/BKOpenGLView.m)重现了这个。我在 Objective-C 和 C++ 中都试过这个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T07:21:45.733

即使您的顶点坐标在 Z 方向上为 0，您的法线也不一定。事实上，默认法线是 (0, 0, 1)，这是有效的，因为您没有在示例代码中明确指定任何法线。

`glScale`因此，您的问题是您的矩阵将法线缩放为非标准化长度。

# javascript - 在 JavaScript 中：类中函数和方法定义之间的语法差异

> ID：14088842
> 
> 赞同：5
> 
> 时间：2012-12-30T06:35:49.573
> 
> 标签：javascript, function, methods

Object 类同时具有方法和函数，这意味着它们都可以通过 Object.nameOfMethodOrFunction() 访问。以下问题[What is the difference between a method and a function](https://stackoverflow.com/questions/155609/what-is-the-difference-between-a-method-and-a-function)解释了方法和函数之间的区别，但没有解释如何在对象中创建它们。例如，下面的代码定义了 sayHi 方法。但是你如何在同一个对象中定义一个函数呢？

```
var johnDoe =
{
      fName : 'John',
      lName: 'Doe',
      sayHi: function()
      {
        return 'Hi There';
      }
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T06:56:40.177

下面定义了两个类`ClassA`和`ClassB`，具有相同的功能但性质不同：

```
function ClassA(name){
    this.name = name;
    // Defines method ClassA.say in a particular instance of ClassA
    this.say = function(){
        return "Hi, I am " + this.name;
    }
}

function ClassB(name){
    this.name = name;
}
// Defines method ClassB.say in the prototype of ClassB
ClassB.prototype.say = function(){
    return "Hi, I am " + this.name;
} 
```

如下图，它们在用法上并没有太大区别，都是“方法”。

```
var a = new ClassA("Alex");
alert(a.say());
var b = new ClassB("John");
alert(b.say()); 
```

* * *

所以现在你对“函数”的意思是什么，根据你作为评论给出的msdn链接，似乎“函数”只是一个“静态方法”，就像在 C# 或 Java 中一样？

```
// So here is a "static method", or "function"?
ClassA.createWithRandomName = function(){
    return new ClassA("RandomName"); // Obviously not random, but just pretend it is.
}

var a2 = ClassA.createWithRandomName(); // Calling a "function"?
alert(a2.say()); // OK here we are still calling a method. 
```

* * *

所以这就是你的问题：

```
var johnDoe =
{
      fName : 'John',
      lName: 'Doe',
      sayHi: function()
      {
        return 'Hi There';
      }
}; 
```

好的，这是一个`Object`，但*显然*不是一个类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T07:04:11.467

用“方法在对象上。函数独立于对象”引用 Aaron。

从逻辑上讲，如果没有定义“this”，方法是没有用的。

考虑这个例子：

```
var johnDoe =
{
    fName: 'John',
    lName: 'Doe',
    sayHi: function () {
        return 'Hi There, my name is ' + this.fName;
    }
};

function sayHi2() {
    return 'Hi There, my last name is ' + this.lName;
}

//Will print Hi there, my first name is John
alert(johnDoe.sayHi());

//An undefined will be seen since there is no defined "this" in SayHi2.
alert(sayHi2());

//Call it properly now, using the oject johnDoe for the "this"
//Will print Hi there, my last name is Doe.
alert(sayHi2.call(johnDoe)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T06:43:50.273

```
var johnDoe = {
  fName: 'John',
  lName: 'Doe',
  sayHi: function(){
    function message(){ return 'Hi there'; }
    return message();
  }
}; 
```

这与在 JavaScript 中创建“类”的对象声明方法一样好。请记住，函数仅在`sayHi`' 范围内有效。

但是，如果您将函数用作类结构，则具有更多的灵活性：

```
var johnDoe = function(){
  this.publicFunction = function(){
  };
  var privateFunction = function(){
  };
};
var jd = new johnDoe();
jd.publicFunction(); // accessible
jd.privateFunction(); // inaccessible 
```

（尽管两者都被认为是方法，因为它们可以访问对象的范围）。

# javascript - 检测 mousedown 是否用于选择拖动

> ID：14088847
> 
> 赞同：1
> 
> 时间：2012-12-30T06:36:18.107
> 
> 标签：javascript, html, dom

我正在跟踪 mousedown 状态，并且不仅`mousedown`在未能传递事件时，辅助鼠标按钮单击触发了事件`mouseup`，拖动所选内容的情况也是如此（注意这与拖动*到 select*不同）。

我目前*在 Mac 上的 Safari 6 上*遇到此问题，如果我在其他平台/系统上看到它，我会报告。

有没有办法拦截这个，这样我的 JS 程序就不会对正在发生的事情感到困惑？对于辅助按钮情况，我只需检查`event.which === 3`我的处理程序，只是不将我的按钮标记为向下，这会解决这个问题，但我也使用左按钮来启动对选定文本的拖动..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T13:21:39.060

我不确定我是否理解您想要做什么，但是检查哪个按钮已被按下可能涉及比检查 which 属性更多的工作。

看看[这个 quirksmode 页面](http://www.quirksmode.org/js/events_properties.html#button)。**右键单击**部分包含一些可能对您有所帮助的代码。

[此处还提供了](http://www.quirksmode.org/js/events_mouse.html)有关鼠标事件的非常详尽的解释。它确实可以帮助您处理浏览器的怪癖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T08:19:21.633

这里的具体问题是`mousedown`拖动选择时不会触发。

解决方案是简单地防止选择可能成为问题的地方。

# android - 动态按钮和 OnClickListener

> ID：14088853
> 
> 赞同：1
> 
> 时间：2012-12-30T06:37:35.263
> 
> 标签：android, class, onclick, onclicklistener

假设我有动态创建的按钮：

```
for(int j = 0; j < spirits.length;

     j++){
                         Button imgBtn = new Button(v.getContext());
                         imgBtn.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                         imgBtn.setMinimumWidth(100);
                         imgBtn.setMinimumHeight(100);
                         imgBtn.setId(j+1);
                         imgBtn.setTag(spirits[j]);
                         imgBtn.setText(spirits[j]);
                         imgBtn.setOnClickListener(new SpiritsClickListener());
                         cabinet_layout.addView(imgBtn);
                     } 
```

我想在每次按下按钮时更改按钮的文本（开 - 关） 如何引用 OnClickListener 类中的按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:49:57.283

在您的 onClickListener 中，您有一个函数，称为单击的视图`onClick(View v){}`在哪里。`v`您可以使用`v`来获取有关按钮的详细信息，包括其 ID。您也可以采用此视图，如果您知道它是一个按钮，则将其转换为一个按钮。

```
Button clicked = (Button)v; 
```

然后，您可以在您的 javacode 中使用它，就像您通常使用按钮一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:46:46.853

你为什么不像这样`new OnClickListener()`在那个循环中调用

```
for(int j = 0; j < spirits.length;j++){
    Button imgBtn = new Button(v.getContext());
    imgBtn.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
    imgBtn.setMinimumWidth(100);
    imgBtn.setMinimumHeight(100);
    imgBtn.setId(j+1);
    imgBtn.setTag(spirits[j]);
    imgBtn.setText(spirits[j]);
    imgBtn.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            //do what you need to do here
        }
    });
    cabinet_layout.addView(imgBtn);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T06:47:56.650

`OnClickListener`为动态创建的按钮创建一个：

```
 // Create Listener  for Button
    private OnClickListener SpiritsClickListener = new OnClickListener()
    {
        @Override
        public void onClick(View view) {
            // TODO Auto-generated method stub
            Button btn = (Button) view;
           String btnText = btn.getText();

            if(btnText.equalsIgnoreCase("On")){
                 btn.setText("Off");
             }else{
                 btn.setText("On");
            }
        }
    }; 
```

将此侦听器添加到动态创建的按钮中：

```
imgBtn.setOnClickListener(SpiritsClickListener); 
```

# struts - 当我在 Struts 中进行表单验证时，我正在获取 org.apache.commons.validator.ValidatorException

> ID：14088861
> 
> 赞同：1
> 
> 时间：2012-12-30T06:40:31.617
> 
> 标签：struts

```
When I am Doing Form validations In Struts I am Getting Exception: 
```

org.apache.commons.validator.ValidatorException：没有这样的验证方法：
org.apache.struts.validator.FieldChecks.validateRequired
(java.lang.Object, org.apache.commons.validator.ValidatorAction,
org.apache.commons.validator .Field, org.apache.struts.action.ActionErrors, javax.servlet.http.HttpServletRequest) 在 org.apache.commons.validator.ValidatorAction.loadValidationMethod
(ValidatorAction.java:604) 在 org.apache.commons.validator.ValidatorAction.executeValidationMethod (ValidatorAction.java:532) 在 org.apache.commons.validator.Field.validateForRule(Field.java:796) 在 org.apache。 commons.validator.Field.validate(Field.java:876) 在 org.apache.commons.validator.Form.validate(Form.java:288) 在 org.apache.commons.validator.Validator.validate(Validator.java: 351) 在 org.apache.struts.validator.ValidatorForm.validate(ValidatorForm.java:110) 在 org.apache.struts.action.RequestProcessor.processValidate (RequestProcessor.java:927) 在 org.apache.struts.action.RequestProcessor .process(RequestProcessor.java:204) 在 org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196) 在 org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:728) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:647) 在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter (ApplicationFilterChain .java:305) 在 org.apache.catalina.core.StandardWrapperValve.invoke (StandardWrapperValve.java:222) 在 org.apache.catalina 的 org.apache.catalina.core.ApplicationFilterChain.doFilter (ApplicationFilterChain.java:210)。 core.StandardContextValve.invoke (StandardContextValve.java:123) 在 org.apache.catalina.authenticator.AuthenticatorBase.invokeinternalDoFilter (ApplicationFilterChain.java:305) at org.apache.catalina.core.ApplicationFilterChain.doFilter (ApplicationFilterChain.java:210) at org.apache.catalina.core.StandardWrapperValve.invoke (StandardWrapperValve.java:222) at org.apache .catalina.core.StandardContextValve.invoke (StandardContextValve.java:123) 在 org.apache.catalina.authenticator.AuthenticatorBase.invokeinternalDoFilter (ApplicationFilterChain.java:305) at org.apache.catalina.core.ApplicationFilterChain.doFilter (ApplicationFilterChain.java:210) at org.apache.catalina.core.StandardWrapperValve.invoke (StandardWrapperValve.java:222) at org.apache .catalina.core.StandardContextValve.invoke (StandardContextValve.java:123) 在 org.apache.catalina.authenticator.AuthenticatorBase.invoke
(AuthenticatorBase.java:472) org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171) org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99) org.apache。 catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936) at org.apache.catalina.core.StandardEngineValve.invoke (StandardEngineValve.java:118) at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java: 407) 在 org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process 的 org.apache.coyote.http11.AbstractHttp11Processor.process (AbstractHttp11Processor.java:1004)
(AbstractProtocol.java:589) 在 org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run (JIoEndpoint.java:310) 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source) 在 java.util .concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at java.lang.Thread.run(Unknown Source)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-16T10:09:04.650

我在尝试提交表单时也遇到了同样的错误。我发现这个错误可能是由于一个版本的 struts 有一个 validation-rules.xml 文件，而另一个版本的 struts 有一个 struts.jar 文件。检查您的安装并确保这两个文件来自同一个下载。还要检查 WEB-INF/lib 目录中的所有其他 jar 文件是否来自同一下载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-02T12:07:21.677

改变：

```
<!DOCTYPE form-validation PUBLIC "-//Apache Software Foundation//DTD Commons Validator Rules Configuration 1.1.3//EN" "http://jakarta.apache.org/commons/dtds/validator_1_1_3.dtd"> 
```

至：

```
<!DOCTYPE form-validation PUBLIC "-//Apache Software Foundation//DTD Commons Validator Rules Configuration 1.3.0//EN" "http://jakarta.apache.org/commons/dtds/validator_1_3_0.dtd"> 
```

# linux - 在子目录中查找特定字符串并按修改日期排序顶级目录

> ID：14088866
> 
> 赞同：1
> 
> 时间：2012-12-30T06:42:32.643
> 
> 标签：linux, bash, pipe

我有一个包含一些文件的目录结构。我正在尝试查找包含具有特定字符串的文件的顶级目录的名称。

我有这个：

```
grep -r abcdefg . | grep commit_id | sed -r 's/\.\/(.+)\/.*/\1/'; 
```

它返回如下内容：

```
topDir1
topDir2
topDir3 
```

我希望能够获取此输出并以某种方式将其输入此命令：

```
ls -t | grep -e topDir1 -e topDir2 -e topDir3 
```

这将返回由第一个命令过滤并按修改日期排序的输出。

我希望有一个班轮。或者也许有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T06:50:57.690

只要目录名称不包含空格或通配符，这应该可以工作：

```
ls -td $(grep -r abcdefg . | grep commit_id | dirname) 
```

# colors - Lazarus - 如何控制禁用的文本框的颜色（即启用：= false）

> ID：14088867
> 
> 赞同：0
> 
> 时间：2012-12-30T06:43:14.673
> 
> 标签：colors, textbox, lazarus, locked, disabled-control

当只查看数据时，我将禁用表单上的文本框。

但是在这段时间里，文本不是很可读，因为它很轻。

有没有办法改变这些文本框的颜色，而不是使用 DISABLED 对象的默认颜色？

随后，我认为这将适用于所有对象 - 列表框、下拉组合、日期输入等，但目前它仅适用于文本框。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-01T07:03:19.440

从我自己的问题来看，禁用文本框的目的是让它们锁定以防止用户更改。但是，禁用的文本框不可读。

解决方案不是更改 dsabled 对象的颜色，而是将其锁定。最简单的方法是将`ReadOnly`属性更改为`true`. 因此，当需要锁定文本框时，我可以像这个例子一样设置属性。

```
MyTextBox.ReadOnly := True; 
```

现在控件保持白色或任何其他颜色，同时用户不可编辑。

奇怪，这是多么简单，我之前没有想到这一点:)

# embed - 嵌入媒体播放器以流式传输音频

> ID：14088868
> 
> 赞同：1
> 
> 时间：2012-12-30T06:43:43.473
> 
> 标签：embed, audio-streaming, winamp

我已经知道有 Flash 和 html5 播放器可以有效地流式传输广播源。我也知道我可以简单地添加一个指向 .pls 的链接并打开它。我知道我不能强制在用户系统上使用特定的播放器。我已经浏览了这个网站上的各种问题，但实际上并没有找到解决方案。我知道，如果我使用简单的 href 命令并将其指向 m3u 文件，我可以弹出一个窗口，然后它将加载用户设置为默认播放器的任何音频播放器。我想做的是为人们提供一种方法来单击特定类型播放器的链接，然后打开该类型的嵌入式播放器。如果用户没有安装该插件或播放器，它将提供下载和安装的选项。一世' 我已经知道如何嵌入 windows 媒体播放器和 quicktime 播放器，但我还没有弄清楚如何嵌入真正的音频或“默认”（winamp vlc 媒体）播放器。我希望有人对如何实现这一点有一个想法。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:06:47.393

您需要做的就是嵌入正确的内容，系统将使用任何已注册的插件来处理该内容类型。

```
<embed src="somefile.ra" /> 
```

# java - 修改Java Source Code File，增加几行代码

> ID：14088869
> 
> 赞同：0
> 
> 时间：2012-12-30T06:43:45.220
> 
> 标签：java

我有一个 java 源文件（例如）

```
public class JTest{  
  public static void main (String arg[])  
    { . . . . . }  
  public mytestmethod()  
    {  
    for(i=0;i<10;i++)  
      System.out.println(i);  
    }    } 
```

我要做的是**编写**可以修改上述java文件**源代码的java程序，而不是编译的类文件。**
使用该程序修改后，输出可能是 . . .

```
public class JTest{  
  public static void main (String arg[])  
    { . . . . . }  
  public mytestmethod()  
    {  
    for(i=0;i<10;i++)  
      {                                    // { added to code  
         System.out.println(i);  
         System.out.println("ITERATION");  //new line added to code  
      }                                    // } added to code  
 }  } 
```

我想我的问题现在很清楚了。这只是我的任务的一个例子。
可以使用哪些 java 库/库。

**JAVASSIST**有助于修改类文件。这是一个非常简单方便的字节码编辑工具，但我必须编辑源代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:58:42.433

看起来您必须进行完整的语法分析。Java 源代码本质上是自由格式的文本，不能依赖换行符或空格，可以在代码的任何位置插入注释。因此，所有使用字符串匹配或正则表达式来解决这个问题的尝试最终都会失败。

Javacc 或 antlr 等工具可能有助于解析。如果您搜索，您会发现这些工具的 Java 语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T12:57:57.027

一个简单的解决方案（不使用 javacc 或类似的东西进行完整解析）：

创建标记注释，例如

```
public void myMethod(bla blubb) {
//$myMethod entry$
stuff.going.on();
//$myMethod exit$
} 
```

然后使用简单的字符串替换来注入您的代码。（注射后保留标记以便能够重新注射）。

进行完整的语法树解析，然后注入代码 + 重写保留注释和格式的文件是一项非常复杂的任务。你需要一些时间。

# c# - 如何在一段时间内将请求数限制为操作

> ID：14088871
> 
> 赞同：1
> 
> 时间：2012-12-30T06:43:55.970
> 
> 标签：c#, .net, asp.net-mvc

如何将传入的请求限制为一个 Action，例如我不希望用户重复向 Action 发布数据。有什么方法可以申请 Actions 的时间限制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T07:16:26.290

您通常无法限制传入的请求 - 它们来自您无法控制的机器。您可以做的是拒绝请求（即使用 503 响应），或者如果您以某种方式控制客户端，则可以限制合法客户端发出的请求数量。

为了能够合理地拒绝传入的请求，您需要了解有关每个特定用户的先前请求的一些信息（即上次请求时间/存储在 cookie 中的索引，或存储在会话状态中的一些信息）。有了这些信息，您应该能够编写将检查条件并拒绝请求的操作过滤器。

请注意，非合法用户将能够轻松绕过所有不依赖于服务器端存储的限制（如会话状态）。如果您不能对用户进行自动化（即通过用户名）限制现有会话的数量也可能是有问题的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T07:36:27.520

这是我会做的一个简单方法。

为每个用户创建一个 Guid，以及最后发布的日期时间，将其推送给用户，就像在 cookie 中一样。每次用户发布内容时，请阅读 cookie。检查日期时间，如果用户在用户可以再次发布之前发布了一些内容，则返回回复，说“慢下来老虎！” 否则继续。您可以自己定义此时间跨度。

容易吗？

另一方面，如果您只想让 10 个用户调用您的操作，则需要一个原子计数器。`Interlocked`是你的朋友。您可以在方法开始时递增，然后在结束时递减。

哦。信号量怎么样，在概念上适合你的问题。

# java - java.util.Locale 有一个空的第一项

> ID：14088874
> 
> 赞同：3
> 
> 时间：2012-12-30T06:44:35.970
> 
> 标签：java, jvm, locale

我正在尝试从 JVM 获取所有语言环境以填充 Country 下拉列表。第一项是空的非空对象。它不为空，因为我正在使用 TreeMap 集合来添加国家/地区缩写和（可显示）名称。看看下面的集合是什么。

```
{=, AE=United Arab Emirates, AL=Albania, AR=Argentina, AT=Austria, AU=Australia, BA=Bosnia and Herzegovina, BE=Belgium, BG=Bulgaria, BH=Bahrain, BO=Bolivia, BR=Brazil,.... 
```

这是代码。我删除了那个空对象以确保第一个值不为空。

```
public Map<String, String> countries(Locale currentLocale) {
    Map<String, String> countries = new TreeMap<String, String>();
    for (Locale locale : Locale.getAvailableLocales()) {
        countries.put(locale.getCountry(),
                locale.getDisplayCountry(currentLocale));
    }
    countries.remove("");
    return countries;
} 
```

JVM 版本 - (build 1.7.0_09-b05)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T07:33:49.273

[javadocs](http://docs.oracle.com/javase/7/docs/api/java/util/Locale.html)基本上涵盖了这一点。

为`locale.getCountry()`您找到：

> 返回此语言环境的国家/地区代码，它应该是**空字符串**、大写的 ISO 3166 2 字母代码或 UN M.49 3 位数代码。

并为`locale.getDisplayCountry()`您找到：

> 返回适合向用户显示的区域设置国家/地区的名称。如果可能，返回的名称将针对默认语言环境进行本地化。例如，如果语言环境是 fr_FR，默认语言环境是 en_US，getDisplayCountry() 将返回“France”；如果语言环境是 en_US 并且默认语言环境是 fr_FR，getDisplayCountry() 将返回“Etats-Unis”。如果返回的名称无法针对默认语言环境进行本地化（例如，我们没有克罗地亚的日文名称），则此函数将使用英文名称，并使用 ISO 代码作为最后的值。如果语言环境未指定国家/地区，则此函数返回空字符串。

您无法“看到”的那个没有 ISO 代码，并且由于它无法本地化到您的区域设置并且也没有英文名称（或者，没有国家指定的）。为两者都使用空字符串是完全有效的（虽然，相当没用）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-01T04:52:32.273

有问题的语言环境就是[Locale.ROOT](http://docs.oracle.com/javase/8/docs/api/java/util/Locale.html#ROOT)。`locale == Locale.ROOT`就我而言，我认为对你来说也是如此。

为什么`Locale.ROOT`存在？根据[http://www.oracle.com/technetwork/java/javase/java8locales-2095355.html](http://www.oracle.com/technetwork/java/javase/java8locales-2095355.html)：

> 如果指定的语言环境提供者都不支持请求的语言环境，则使用 Locale.ROOT 语言环境的默认“JRE”语言环境提供者的资源。例如，如果在“java.locale.providers”系统属性中仅指定了“CLDR”，则 Collat​​or 的工作方式就像请求 ROOT 语言环境一样，因为“CLDR”语言环境提供程序不提供 Collat​​or 语言环境数据。指定“CLDR,JRE”补充了“JRE”语言环境提供者的整理器功能，并且更喜欢“CLDR”语言环境提供者的其他语言环境数据而不是“JRE”的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T07:24:03.617

尝试

```
 for (Locale locale : Locale.getAvailableLocales()) {
        System.out.println(locale.getLanguage() + " " + locale.getCountry());
    } 
```

你会看到一些语言环境只有语言没有国家

```
ms MY
ar QA
is IS
fi FI
pl 
en MT
... 
```

# xml - 使用 XQuery 将 XML 转换为 CSV

> ID：14088881
> 
> 赞同：5
> 
> 时间：2012-12-30T06:46:37.263
> 
> 标签：xml, xquery, marklogic, xpath-2.0, altova

我有一个 XML 文件，我需要将它转换为 XQuery。考虑一组简单的 XML：

```
books[book]
book[@isbn, title, descrption] 
```

例如：

```
<books>
    <book isbn="1590593049">
        <title>Extending Flash MX 2004</title>
        <description>
        Using javascript alongwith actionscript 3.0 and mxml.</description>
    </book>
    <book isbn="0132149184">
        <title>Java Software Solutions</title>
        <description>
            Complete book full of case studies on business solutions and design concepts while building mission critical
            business applications.
        </description>
    </book> 
```

如何使用 XQuery 将其转换为 CSV 格式？CSV 由 Microsoft excel 使用，

因此它将由逗号 (,) 字符分隔，并且应转义特殊字符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T10:26:25.467

假设您的 xml 在变量中，`$books`您可以使用以下命令创建一个 csv 文件，其中每个书节点在新行上：

```
declare function local:my-replace($input) {
  for $i in $input
  return '"' || replace($i, '"', '""') || '"'
};
for $book in $books//book
return string-join(local:my-replace(($book/@isbn, $book/title, $book/description)), ",") || '&#xa;' 
```

`string-join`连接不同的字符串，本地函数`my-replace`根据您的规范替换序列中的值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-30T17:47:09.523

**纯 XPath 2.0 表达式**：

```
for $b in /*/book
    return
      concat(escape-html-uri(string-join(($b/@isbn,
                                          $b/title,
                                          $b/description
                                          )
                                           /normalize-space(),
                                        ",")
                             ),
             codepoints-to-string(10)) 
```

**基于 XSLT 2 的验证：**

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
  <xsl:sequence select=
   "for $b in /*/book
       return
         concat(escape-html-uri(string-join(($b/@isbn,
                                             $b/title,
                                             $b/description
                                             )
                                              /normalize-space(),
                                           ',')
                                ),
                codepoints-to-string(10))"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时**（已纠正其格式错误）：

```
<books>
    <book isbn="1590593049">
        <title>Extending Flash MX 2004</title>
        <description>
        Using javascript alongwith actionscript 3.0 and mxml.</description>
    </book>
    <book isbn="0132149184">
        <title>Java Software Solutions</title>
        <description>
            Complete book full of case studies on business solutions and design concepts while building mission critical
            business applications.
        </description>
    </book>
</books> 
```

**产生了想要的正确结果**：

```
1590593049,Extending Flash MX 2004,Using javascript alongwith actionscript 3.0 and mxml.
 0132149184,Java Software Solutions,Complete book full of case studies on business solutions and design concepts while building mission critical business applications. 
```

**更新**：

在评论中，OP 要求任何文本中的逗号都用引号括起来，并且（之后）任何引号都被两个引号替换，最后，如果整个结果包含一个引号，它必须用 (单）引号。

**下面是一个纯粹的 XPath 2.0 表达式，它产生这个：**

```
for $b in /*/book,
    $q in codepoints-to-string(34),
    $NL in codepoints-to-string(10),
    $isbn in normalize-space(replace($b/@isbn, ',', concat($q,',',$q))),
    $t in normalize-space(replace($b/title, ',', concat($q,',',$q))),
    $d in normalize-space(replace($b/description, ',', concat($q,',',$q))),
    $res in
     escape-html-uri(string-join(($isbn,$t,$d), ',')),
    $res2 in replace($res, $q, concat($q,$q))
   return
    if(contains($res2, $q))
       then concat($q, $res2, $q, $NL)
       else concat($res2, $NL) 
```

**当此 XPath 表达式针对此（使用新的测试用例扩展）XML 文档进行评估时：**

```
<books>
    <book isbn="1590593049">
        <title>Extending Flash MX 2004</title>
        <description>
        Using javascript alongwith actionscript 3.0 and mxml.</description>
    </book>
    <book isbn="0132149184">
        <title>Java Software Solutions</title>
        <description>
            Complete book full of case studies on business solutions and design concepts while building mission critical
            business applications.
        </description>
    </book>
    <book isbn="XX1234567">
        <title>Quotes and comma</title>
        <description>
            Hello, World from "Ms-Excel"
        </description>
    </book>
</books> 
```

**产生了想要的正确结果：**

```
1590593049,Extending Flash MX 2004,Using javascript alongwith actionscript 3.0 and mxml.
0132149184,Java Software Solutions,Complete book full of case studies on business solutions and design concepts while building mission critical business applications.
"XX1234567,Quotes and comma,Hello"","" World from ""Ms-Excel""" 
```

# objective-c - 是否可以在运行时定义 C 函数？

> ID：14088882
> 
> 赞同：0
> 
> 时间：2012-12-30T06:46:37.320
> 
> 标签：objective-c, ios, objective-c-runtime

> **可能重复：**
> [在 c 中动态创建函数](https://stackoverflow.com/questions/1839965/dynamically-creating-functions-in-c)

这是我想做的一个例子：

```
void  attribute((constructor)) someFunction() {
    // Would be nice to define C function "someFunction2" somehow here.
} 
```

我知道`class_addMethod`允许在运行时将 C 函数添加到 Objective-C 类。

是否可以将 C 函数添加到 C`main`空间？

如果我正在考虑这种做事方式，请不要告诉我我错了——我对它感兴趣，而不是出于教育目的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T07:04:37.507

不，AC 函数由名称和主体组成。编译器将主体转换为可执行代码的二进制片段，当从可执行文件创建进程时，该可执行代码将映射到某个地址。静态和动态链接器将该名称用作该地址的别名。

在运行时，这两个概念都不是很有趣。加载可执行文件并解析名称，因此动态创建它们几乎没有用处。

在 iOS 上，甚至不可能创建新的函数实现，因为内核不允许使内存可执行。

# javascript - 更改颜色亮度

> ID：14088889
> 
> 赞同：1
> 
> 时间：2012-12-30T06:48:36.820
> 
> 标签：javascript, colors, rgb

> **可能重复：**
> [使用 jquery/javascript 单击时增加 CSS 亮度颜色？](https://stackoverflow.com/questions/5833624/increase-css-brightness-color-on-click-with-jquery-javascript)

在 JavaScript 中，当我们知道红色、蓝色、绿色的值时，我如何改变颜色的亮度，就像在 MSPaint 中一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T14:04:50.457

这个问题与 Javascript 无关，我不知道您对 MSPaint 有什么影响。另外，仅仅为了调整亮度而在色彩空间之间进行转换可能过于昂贵。有一种更简单的方法可能对您来说已经足够好了，它是一种快速且易于执行的伽马校正。如果您的红色、绿色和蓝色值在 [0, 255] 范围内，您还可以轻松创建一个查找表 ( `lut`)，该表将用于快速应用范围 [0, 255]。这个方法的伪代码是：

```
GAMMA = k

lut = []
for i = 0 to 255
    v = i/255.0
    lut.push(round(255 * (v ^ GAMMA)))

foreach x, y in image
    image[x, y] = lut[image[x, y]] 
```

大于 1的值`k`会使图像变亮，小于 1 会使图像变暗。伽马校正应用于每个像素分量（即，单独的红色、绿色和蓝色）。以下是一些`k = 1, 2, 3`分别带有 的示例：

![在此处输入图像描述](../Images/85633c2d9e03a2ca10c2a24c6e7d2ccc.png) ![在此处输入图像描述](../Images/8059443074159b0462fe02c8725f11ae.png) ![在此处输入图像描述](../Images/faba221aedb1b01fbf3b3b6ec42745c0.png)

执行此操作的完整 Python 代码（可能有助于 Javascript 翻译）：

```
import sys
from PIL import Image

GAMMA = 1/3.0

lut = []
for i in xrange(256):
    v = i/255.
    lut.append(round(255 * (v ** GAMMA)))

img = Image.open(sys.argv[1])
img = img.point(lambda x: lut[x])
img.save(sys.argv[2]) 
```

# html - 为什么边距填充在表 td 和 tr 中不起作用？

> ID：14088890
> 
> 赞同：5
> 
> 时间：2012-12-30T06:49:02.100
> 
> 标签：html, css

```
<table  border="0" style="padding:10px;width: 960px;border-collapse: collapse;">

   <tbody>
<tr>
<td  style="padding: 0"><img src="8.jpg" alt="" /></td>
<td  style="padding: 0"><img src="98.jpg" alt="" /></td>
<td  style="padding: 0"><img src="998.jpg" alt="" /></td>
<td  style="padding: 0"><img src="1998.jpg" alt="" /></td>
</tr>
<tr>
<td  style="background-color: #757575;">11194</td>
<td  style="background-color: #757575;">11194</td>
<td  style="background-color: #757575;">11194</td>
<td  style="background-color: #757575;">11194</td>
</tr>
<tr>
<td  style="padding: 0"><img src="8.jpg" alt="" /></td>
<td  style="padding: 0"><img src="98.jpg" alt="" /></td>
<td  style="padding: 0"><img src="998.jpg" alt="" /></td>
<td  style="padding: 0"><img src="1998.jpg" alt="" /></td>
</tr>

</tbody>
</table> 
```

为什么我不能在 tr 和 td 中添加边距？我希望 td ( `<td style="background-color: #757575;">11194</td>`) 有边距。即，每个都用一些空格分隔。但无法工作。如何纠正它。并且第二个 tr 在以下 tr 之间有一些空间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T07:29:14.213

表格单元格的边距规格被忽略参考：[http](http://www.w3.org/TR/CSS2/tables.html) ://www.w3.org/TR/CSS2/tables.html 和[CSS 单元格边距](https://stackoverflow.com/questions/716442/css-cell-margin)

> 内部表格元素生成带有内容和边框的矩形框。单元格也有填充。内部表格元素没有边距。

如果你想添加填充，只需设置边框折叠：单独参考：[http ://www.w3schools.com/cssref/playit.asp?filename=playcss_border-collapse](http://www.w3schools.com/cssref/playit.asp?filename=playcss_border-collapse)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T06:51:17.343

我猜你在问`border-collapse;`所以尝试使用它......

```
table {
   border-collapse: collapse;
} 
```

如果你想添加`padding`你可以这样做

```
table.class_name td {
   padding: 0; 
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T06:51:55.690

原因是因为你在`table`元素和 on 上提供填充`td`并且你在给`padding:0`

`border-collapse: collapse`从元素中删除`table`，您可以在此表中轻松处理填充和边距。

请参阅演示小提琴的概念：http: [//jsfiddle.net/GVt3z/](http://jsfiddle.net/GVt3z/)

注意：上面的小提琴不包含确切的答案。

请参阅更新的小提琴以获取右边距空间，但使用不同的技术。

[http://jsfiddle.net/GVt3z/1/](http://jsfiddle.net/GVt3z/1/)

# java - 从 Java 中的范围列表中选择一个随机整数

> ID：14088891
> 
> 赞同：0
> 
> 时间：2012-12-30T06:49:22.013
> 
> 标签：java

我有一个 Java 范围列表

```
public class Range {
   private int min, max;
   //constructor, getters, setters go here
} 
```

所以，一个列表可能看起来像这样

```
ranges = [[3,9], [18,45], [90,112]] 
```

我需要做以下功能

```
public int getRandomValueWithinRanges() {
   //returns a value which is contained inside a range inside the ranges ArrayList
} 
```

我怎样才能做到这一点？这些范围内的每个值都应该有相同的被选择概率，并且应该有效地完成（即列出范围内的所有值，然后从该列表中随机选择是*无效*的）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T06:53:31.677

好吧，一种方法：

1.  总结所有范围（即它们跨越的整数总数）

2.  从中选择一个随机值`[0-total)`

3.  把随机值*当作一个索引*，增量查找这个索引对应的范围

4.  根据包含所述索引的范围开始偏移随机数..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T07:24:00.820

首先，选择一个随机范围。然后从选定的随机范围中选择一个随机整数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T08:05:01.650

最佳解决方案取决于您是否可以将设置成本*分摊*到`getRandomValueWithinRanges`具有*相同*范围列表的多次调用中。

如果您无法摊销，那么@pst 的方法是最好的。

如果您可以摊销，那么有多种方法可以使该方法更快；例如

*   构建所有范围元素的数组列表。这给出了最快的`getRandom...`，但有很大的设置时间和很大的空间开销。
*   构建数据结构以加快随机索引（在@pst 的解决方案中）到值的映射。

* * *

应该注意的是，对随机范围和范围内的随机元素的简单选择很容易使随机数的选择产生偏差……除非您可以通过加权范围选择或其他方式弄清楚如何进行补偿。

# c# - 从文件中读取特定行

> ID：14088894
> 
> 赞同：2
> 
> 时间：2012-12-30T06:49:41.170
> 
> 标签：c#, asp.net, readline

我正在尝试获取包含特定单词的行之前的行列表。这是我的脚本：

```
private static void Main(string[] args)
{
    int counter = 0;
    string line;

    System.IO.StreamReader file = new System.IO.StreamReader("E:\\overview2.srt");
    List<string> lines = new List<string>();
    while ((line = file.ReadLine()) != null)
    {
        if (line.Contains("medication"))
        {

            int x = counter - 1;
            Console.WriteLine(x); // this will write the line number not its contents

        }

        counter++;
    }

    file.Close();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T08:09:43.903

Using LINQ method syntax:

```
var lines = File.ReadLines("E:\\overview2.srt")
        .Where(line => line.Contains("medication"))
        .ToList(); 
```

and LINQ keyword syntax:

```
var lines = (
    from line in File.ReadLines("E:\\overview2.srt")
    where line.Contains("medication")
    select line
).ToList(); 
```

If you need an array, use `.ToArray()` instead of `.ToList()`.

Also, if all you need is to iterate once over the lines, don't bother with `ToArray` or `ToList`:

```
var query = 
    from line in File.ReadLines("E:\\overview2.srt")
    where line.Contains("medication")
    select line;
foreach (var line in query) {
    Console.WriteLine(line);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T07:08:45.310

此代码将在包含搜索文本的任何行之前显示所有行。

```
 private static void Main(string[] args)
    {
        string cacheline = "";
        string line;

        System.IO.StreamReader file = new System.IO.StreamReader("C:\\overview2.srt");
        List<string> lines = new List<string>();
        while ((line = file.ReadLine()) != null)
        {
            if (line.Contains("medication"))
            {
                lines.Add(cacheline);
            }
            cacheline = line;
        }
        file.Close();

        foreach (var l in lines)
        {
            Console.WriteLine(l);           
        }
    } 
```

很难从您的问题中看出您要在找到的行之前查找所有行还是仅查找一行。（您必须处理在第一行找到搜索文本的特殊情况）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T06:55:42.723

你可以创建一个`Queue<string>`. 当您通过它时，将每一行添加到它。如果它的行数超过了所需的行数，则将第一个项目出列。当您点击所需的搜索表达式时，`Queue<string>`其中包含您需要输出的所有行。

或者，如果内存不是对象，您可以使用`File.ReadAllLines`（参见[http://msdn.microsoft.com/en-us/library/system.io.file.readalllines.aspx](http://msdn.microsoft.com/en-us/library/system.io.file.readalllines.aspx)）并索引到一个数组中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T06:57:23.237

尝试这个：

```
 int linenum = 0;
                foreach (var line in File.ReadAllLines("Your Address"))
                {
                    if (line.Contains("medication"))
                    {
                        Console.WriteLine(string.Format("line Number:{} Text:{}"linenum,line)
//Add to your list or ...
                    }
                    linenum++;
                } 
```

# algorithm - 如何使用 A 星算法找到前 100 条最短路径？

> ID：14088898
> 
> 赞同：3
> 
> 时间：2012-12-30T06:50:27.253
> 
> 标签：algorithm, graph-algorithm, shortest-path, a-star

如何使用 A 星算法找到前 100 条最短路径？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T07:11:07.397

找到第 k 条最短路径的问题是[NP-Hard](http://en.wikipedia.org/wiki/NP-hard)，因此任何对 A-Star 的修改都会按照您的要求进行 - 输入的大小将成指数增长。

**证明：（**
注意：我将在*简单*路径上展示）
假设您有一个多项式算法，它在多项式时间内运行并返回`k`最短路径的长度让算法为`A(G,k)`

路径的最大数量是`n!`，并且通过在范围上应用二进制搜索`[1,n!]`来找到长度最短的路径`n`，您需要`O(log(n!)) = O(nlogn)`调用`A`.
如果你发现有一条长度的路径`n`——它是一条[汉密尔顿路径](http://en.wikipedia.org/wiki/Hamiltonian_path)。
通过对图中（其中的）每个源和目标重复该过程`O(n^2)`，您可以多项式地解决[哈密顿路径问题](http://en.wikipedia.org/wiki/Hamiltonian_path_problem)`A`，假设存在这样的问题。
**量子点**

由此我们可以得出结论，除非[P=NP](http://en.wikipedia.org/wiki/P_versus_NP_problem)（根据大多数 CS 研究人员的说法，这不太可能），否则问题无法通过多项式解决。

另一种方法是使用[统一成本搜索](https://en.wikipedia.org/wiki/Uniform_cost_search)的变体，无需维护`visited`/`closed`设置。您也可以**通过禁用关闭的节点**来修改 A* ，并在遇到时产生/生成解决方案，而不是返回它们并完成，但我目前想不出一种方法来证明 A* 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T10:56:58.830

除了这个问题是-hard 之外，无论有没有重大修改`NP`，都不可能做到这一点。以下是一些主要原因：`A*``dijkstra`

首先，该算法在每一步都只保留迄今为止的最佳路径。考虑下图：

```
 A
 / \
S   C-E
 \ /
  B 
```

假设距离`d(S,A)=1, d(S,B)=2, d(A,C)=d(B,C)=d(C,E)=10`。

访问 C 时，您将选择路径 via `A`，但您将无处存储路径 via `B`。所以你必须保留这些信息。

但是，其次，您甚至没有考虑所有可能的路径，假设如下图：

```
S------A--E
 \    /
  B--C 
```

假设距离`d(S,A)=1, d(S,B)=2, d(B,C)=1, d(A,E)=3`。您的访问顺序将是`{S,A,B,C,E}`。因此，当您访问时，您甚至无法通过并且因为您不知道而`A`绕道而行。您必须为每个未访问的邻居添加诸如“通过 C 的潜在路径”之类的内容。`B``C`

第三，您必须合并循环和[死胡同](http://en.wikipedia.org/wiki/Cul-de-sac)，因为是的，其中包含循环的路径很可能最终成为您的 100 条最短路径之一。您当然可能希望限制这一点，但这是一种普遍的可能性。例如，考虑这样的图表：

```
S-A--D--E
  |  |
  B--C 
```

很明显，您可以轻松地在此处开始循环，除非您不允许“返回”（例如`D->A`，如果`A->D`已经在路径中，则禁止）。`A-B-A-B-A-...`实际上，这甚至是一个没有明显图形循环的问题，因为在一般情况下，您总是可以在两个邻居（路径）之间进行乒乓球。

现在我什至可能忘记了一些问题。

请注意，这些事情中的大多数也使得开发通用算法变得非常困难，当然是最后一部分，因为使用循环很难限制可能路径的数量（“无限循环”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-20T04:05:32.333

这不是 NP 硬算法，下面的链接是 Yen 算法，用于在多项式时间内计算图中的 K 最短路径。 [日元的算法链接](http://people.csail.mit.edu/minilek/yen_kth_shortest.pdf)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-30T06:57:42.943

当目的地是第 k 次推入队列时，使用 a* 搜索。这将是第 k 条最短路径。

# iphone - 我如何在 Uinavigationbar 上制作 uiview

> ID：14088908
> 
> 赞同：0
> 
> 时间：2012-12-30T06:52:24.403
> 
> 标签：iphone, ios, cocoa-touch

我正在做一个 iphone 应用程序。在这个应用程序中，我想**禁用后退 navigationleftbarbutton**。我已经使用下面的代码来禁用navigationleftbarbutton，但它不起作用。现在我创建了一个视图，并添加了 uinavigationbar。但现在我想在透明视图中制作该视图。以及如何从导航栏中删除我的 customview(myview1)。我附上了我的代码。请一些人帮我解决我的问题。

**禁用代码：**

```
self.navigationItem.leftBarButtonItem setEnabled:NO]; 
```

**这是我的自定义视图代码：**

```
myview1 = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 40)];
myview1.backgroundColor = [UIColor redColor];
button = [[UIBarButtonItem alloc]initWithCustomView:myview1];
self.navigationItem.leftBarButtonItem = button; 
```

我怎样才能让 myview 是透明视图。以及如何从导航栏中删除 mycustomview(myview1)。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T08:11:46.033

you can hide navigation back button by writing code below:

```
self.navigationItem.leftBarButtonItem.hidden = YES; 
```

and your view ie myview can be transparent by changing alpha value of the view

```
[myview setAlpha:0.3];   //alpha value ranges from 0 to 1 
```

By settign alpha value 0.0 makes view transparent and increases transparency as u increases alpha value

# php - PHP：将函数的输出插入字符串

> ID：14088910
> 
> 赞同：0
> 
> 时间：2012-12-30T06:53:04.917
> 
> 标签：php, function

我正在编写一个自定义 PHP 函数，以便更轻松地生成使用媒体查询的 CSS 样式。

我的函数变得非常重复，所以我创建了第二个函数，我将它放在第一个函数中。第二个函数包含所有重复的代码。

第二个函数生成一个文本字符串，该字符串插入到第一个函数的另一个字符串中。

但是，我发现最终输出将第二个函数文本字符串***放在***第一个函数字符串之外。我该如何纠正？

这是我的代码：

```
 <?php
function css_bgcolor_height_embded($region, $height_value, $mobile_setting, $mobile_custom_height)
{
    function css_height_output($region, $height_value, $class_prefix, $height_division)
    {
        echo "$class_prefix" . " ." . $region . "-bgcolor-height-source-element {
            height: $height_value" . "px;
            height:" . (($height_value / $height_division) / 10) . "rem;
        }" . "   " . "

        $class_prefix" . " ." . $region . "-bgcolor-height  {
            top:" . "$height_value" . "px;
            top:" . (($height_value / $height_division) / 10) . "rem;
        } ";

    }

    $css_bgcolor_height_embeded .= css_height_output($region, $height_value, '', 1);

    if ($mobile_setting == '50%') {
        $css_bgcolor_height_embeded .= "@media only screen and (min-width: 0px) and (max-width: 959px) {" . css_height_output($region, $height_value, '.submenu-devices', 2) . "}";

        $css_bgcolor_height_embeded .= "@media only screen and (min-width: 0px) and (max-width: 767px) {" . css_height_output($region, $height_value, '.submenu-portables', 2) . "}";

        $css_bgcolor_height_embeded .= css_height_output($region, $height_value, 'submenu-all', 2);

    } elseif ($mobile_setting == 'custom') {
        $css_bgcolor_height_embeded .= "@media only screen and (min-width: 0px) and (max-width: 959px) {" . css_height_output($region, $mobile_custom_height, '.submenu-devices', 2) . "}";

        $css_bgcolor_height_embeded .= "@media only screen and (min-width: 0px) and (max-width: 767px) {" . css_height_output($region, $mobile_custom_height, '.submenu-portables', 2) . "}";

        $css_bgcolor_height_embeded .= css_height_output($region, $mobile_custom_height, '.submenu-all', 2);

    }

    echo $css_bgcolor_height_embeded;
}

echo css_bgcolor_height_embded('header', 10, 'custom', '100');

?> 
```

这是我的输出：（媒体查询的代码被错误地放置在它之外[见结尾]）

```
.header-bgcolor-height-source-element {
    height: 10px;
    height: 1rem;
}

.header-bgcolor-height {
    top: 10px;
    top: 1rem;
}

.submenu-devices .header-bgcolor-height-source-element {
    height: 100px;
    height: 5rem;
}

.submenu-devices .header-bgcolor-height {
    top: 100px;
    top: 5rem;
}

.submenu-portables .header-bgcolor-height-source-element {
    height: 100px;
    height: 5rem;
}

.submenu-portables .header-bgcolor-height {
    top: 100px;
    top: 5rem;
}

.submenu-all .header-bgcolor-height-source-element {
    height: 100px;
    height: 5rem;
}

.submenu-all .header-bgcolor-height {
    top: 100px;
    top: 5rem;
}
@media only screen and (min-width: 0px) and (max-width: 959px) {
}
@media only screen and (min-width: 0px) and (max-width: 767px) {
} 
```

输出应该是这样的：（媒体查询的代码应该放在里面）

```
.header-bgcolor-height-source-element {
    height: 10px;
    height: 1rem;
}

.header-bgcolor-height {
    top: 10px;
    top: 1rem;
}

.submenu-all .header-bgcolor-height-source-element {
    height: 100px;
    height: 5rem;
}

.submenu-all .header-bgcolor-height {
    top: 100px;
    top: 5rem;
}
@media only screen and (min-width: 0px) and (max-width: 959px) {

.submenu-devices .header-bgcolor-height-source-element {
    height: 100px;
    height: 5rem;
}

.submenu-devices .header-bgcolor-height {
    top: 100px;
    top: 5rem;
}

}
@media only screen and (min-width: 0px) and (max-width: 767px) {
    .submenu-portables .header-bgcolor-height-source-element {
    height: 100px;
    height: 5rem;
}

.submenu-portables .header-bgcolor-height {
    top: 100px;
    top: 5rem;
}
} 
```

（最终代码将被插入到 Drupal 函数中。但是，我忽略了 Drupal 元素，因为我认为这更像是一个通用的 PHP 问题）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T06:57:11.593

`echo`除了在你的函数中使用`css_height_output`，你应该使用 return 代替它。问题是`echo`它将立即输出该字符串，而不是将其插入到您要查找的字符串中。

ECHO 函数将在此时获取该文本并将其输出到文本的主体，其中 return 会将数据发送回调用它的对象，在您的情况下，将其添加到`$css_bgcolor_height_embeded`变量的末尾。

```
function css_height_output($region, $height_value, $class_prefix, $height_division)
{
    return "$class_prefix" . " ." . $region . "-bgcolor-height-source-element {
        height: $height_value" . "px;
        height:" . (($height_value / $height_division) / 10) . "rem;
    }" . "   " . "

    $class_prefix" . " ." . $region . "-bgcolor-height  {
        top:" . "$height_value" . "px;
        top:" . (($height_value / $height_division) / 10) . "rem;
    } ";

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T07:05:54.603

试试这个...

```
<?php
function css_bgcolor_height_embded($region, $height_value, $mobile_setting, $mobile_custom_height)
{
    function css_height_output($region, $height_value, $class_prefix, $height_division)
    {
    return "$class_prefix" . " ." . $region . "-bgcolor-height-source-element {
        height: $height_value" . "px;
        height:" . (($height_value / $height_division) / 10) . "rem;
    }" . "   " . "

    $class_prefix" . " ." . $region . "-bgcolor-height  {
        top:" . "$height_value" . "px;
        top:" . (($height_value / $height_division) / 10) . "rem;
    }\n\n";

    }

    $css_bgcolor_height_embeded = css_height_output($region, $height_value, '', 1);

    if ($mobile_setting == '50%') {
    $css_bgcolor_height_embeded .= "@media only screen and (min-width: 0px) and (max-width: 959px) {" . css_height_output($region, $height_value, '.submenu-devices', 2) . "}";

    $css_bgcolor_height_embeded .= "@media only screen and (min-width: 0px) and (max-width: 767px) {" . css_height_output($region, $height_value, '.submenu-portables', 2) . "}";

    $css_bgcolor_height_embeded .= css_height_output($region, $height_value, 'submenu-all', 2);

    } elseif ($mobile_setting == 'custom') {
    $css_bgcolor_height_embeded .= "@media only screen and (min-width: 0px) and (max-width: 959px) {" . css_height_output($region, $mobile_custom_height, '.submenu-devices', 2) . "}";

    $css_bgcolor_height_embeded .= "@media only screen and (min-width: 0px) and (max-width: 767px) {" . css_height_output($region, $mobile_custom_height, '.submenu-portables', 2) . "}";

    $css_bgcolor_height_embeded .= css_height_output($region, $mobile_custom_height, '.submenu-all', 2);

    }

    return $css_bgcolor_height_embeded;
}

echo css_bgcolor_height_embded('header', 10, 'custom', '100');

?> 
```

注意使用return而不是echo。Echo 在评估时将其打印出来，

# visual-studio-2010 - 在 Windows 8 应用商店应用程序（使用 Visual C++ 2012 构建）中使用 C++ 库（使用 Visual C++ 2010 构建）

> ID：14088917
> 
> 赞同：1
> 
> 时间：2012-12-30T06:55:59.383
> 
> 标签：visual-studio-2010, visual-c++, windows-8, visual-studio-2012

我有一个使用 VC++ 2010 构建的 C++ 库。我有这个库的头文件、导入库和 DLL。我想在我尝试使用 VC++ 2012 构建的 Windows 8 Store 应用程序中使用这个库。我的应用程序在我的本地机器上运行良好，但是当我尝试在远程 Windows 8 设备上运行这个应用程序时，应用程序无法加载. 我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:55:59.383

您不能在 Windows 8 应用商店应用中使用使用旧版 Visual Studio（早于 Visual Studio 2012）构建的 C++ 二进制文件。

原因是因为使用 Visual Studio 2010 构建的二进制文件将依赖于 Visual Studio 2010 中的 C++ 运行时 DLL。而您的应用程序的其余部分是使用 Visual Studio 2012 编写的，因此它将依赖于 C++ 运行时 DLL来自 Visual Studio 2012。后者可从 Windows 应用商店自动获取（阅读[此文](http://blogs.msdn.com/b/vcblog/archive/2012/09/28/10354327.aspx)了解更多详细信息）。但是前者在 Windows 应用商店中不可用。此外，您的应用无法表达对 VC2010 运行时的依赖。在应用程序包中包含 VC2010 运行时 DLL 也将不起作用，因为该包将在商店上传时被拒绝。

因此，最好的选择是严格使用 Visual Studio 2012 为您的 Windows 8 应用商店应用程序构建所有源代码。

# objective-c - NSUSerDefaults 和 NSMutableArray 按 desc 顺序排序

> ID：14088921
> 
> 赞同：0
> 
> 时间：2012-12-30T06:56:35.137
> 
> 标签：objective-c, ios

我对为什么降序排序不适用于以下代码感到头疼。我想限制前 5 名的分数和其他逻辑。分数如下所示：22/30、12/18、34/38、23/32 等。我添加/删除了 SortDescriptor 以按降序排序，它似乎适用于前 3 个项目，但随后无法正确排序. 有人可以帮忙吗？

```
- (NSMutableArray*) method1:(NSString *) mode byScore: (NSString *) score
{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSMutableArray *array = [[defaults objectForKey:mode]mutableCopy];

    if (!array)
    {
        array = [[NSMutableArray alloc] init];
    }
    NSLog(@"The content of array is%@", array);

    if ([array count] < 5)
    {
      if (![array containsObject:score])
      {
          [array addObject:score];
          // Need to sort here. But not too sure this is the right place
          NSLog(@"The content of the sorted array upto 5 is%@", array); 
      }
    }
    else
    {
       if (![array containsObject:score])
       {
           if ([array lastObject] < score)
           {
               [array addObject:score];
               // Need to sort here before I remove the last object                   
               [array removeLastObject];
               NSLog(@"The content of the sorted array else is%@",array);
           }
       }
    }
    [defaults setObject:array forKey:mode];
    [defaults synchronize];
    // I want the array in NSUserDefaults to be sorted in desc order
    // don't know what to return here ==> the array object or the defaults object cast    to NSMutableArray?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T11:58:28.470

辅助函数

```
static NSComparisonResult CompareFloats( float a, float b )
{
    if ( a < b ) { return NSOrderedAscending ; }
    else if ( a > b ) { return NSOrderedDescending ; }
    return NSOrderedSame ;
} 
```

NSString 上的类别

```
@implementation NSString (Stuff)

-(float)floatValueForFraction
{
    NSArray * components = [ self componentsSeparatedByString:@"/" ] ;
    return [ components[0] floatValue ] / [ components[1] floatValue ] ;
}

@end 
```

你的方法：

```
- (void)addScore:(NSString*)score forMode:(NSString*)mode
{
    NSUserDefaults * defaults = [ NSUserDefaults standardUserDefaults ] ;
    NSArray * scores = [ defaults objectForKey:mode ] ;

    scores = scores ? [ scores arrayByAddingObject:score ] : @[ score ] ;
    scores = [ scores sortedArrayUsingComparator:^(NSString * a, NSString * b){
        return CompareFloats( [ a floatValueForFraction ], [ b floatValueForFraction ] ) ;
    }]

    if ( scores.count > 5 ) { scores = [ scores subarrayWithRange:(NSRange){ .length = 5 } ] ; }

    [ default setObject:scores forKey:mode ] ;
} 
```

如果你想要调用这个方法后更新的高分，只需使用`[ [ NSUserDefaults standardUserDefaults ] objectForKey:<mode> ]`. 最好让你的方法只做一件事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T07:20:24.357

一种排序方法`array`：

首先定义一个块`getNumeratorAndDenominatorFromScoreString`如下：

```
BOOL (^getNumeratorAndDenominatorFromScoreString)(NSString *, NSInteger *, NSInteger *) = ^(NSString *scoreString, NSInteger *numeratorOut, NSInteger *denominatorOut) {
    BOOL res = NO;
    NSArray *components = [scoreString componentsSeparatedByString:@"/"];
    if (components && 
        [components count] == 2) {
        res = YES;
        if (numeratorOut) {
            NSNumber *numeratorNumber = [components objectAtIndex:0];
            *numeratorOut = [numeratorNumber integerValue];
        }
        if (denominatorOut) {
            NSNumber *denominatorNumber = [components objectAtIndex:1];
            *denominatorOut = [denominatorNumber integerValue];
        }
    }
    return res;
}; 
```

然后将此块与`-[NSArray sortedArrayUsingComparator]`排序一起使用`array`：

```
NSArray *sortedArray = [array sortedArrayUsingComparator: ^(id obj1, id obj2) {
    NSComparisonResult res = NSOrderedSame;

    NSString *score1 = (NSString *)obj1;
    NSString *score2 = (NSString *)obj2;

    NSInteger numerator1, denominator1, numerator2, denominator2;
    BOOL res1, res2;

    res1 = getNumeratorAndDenominatorFromScoreString(score1, &numerator1, &denominator1);
    res2 = getNumeratorAndDenominatorFromScoreString(score2, &numerator2, &denominator2);

    if (res1
        && res2) {
        CGFloat value1 = ((CGFloat)numerator1)/((CGFloat)denominator1);
        CGFloat value2 = ((CGFloat)numerator2)/((CGFloat)denominator2);

        if (value1 > value2) {
            res = NSOrderedDescending;
        } else if (value1 < value2) {
            res = NSOrderedAscending;
        }
    }
    return res;
}]; 
```

这`array`将从最小到最大排序。要从大到小排序，只需替换

```
if (value1 > value2) {
    res = NSOrderedDescending;
} else if (value1 < value2) {
    res = NSOrderedAscending;
} 
```

和

```
if (value1 > value2) {
    res = NSOrderedAscending;
} else if (value1 < value2) {
    res = NSOrderedDescending;
} 
```

* * *

这种方法的可读结构将是，[大部分不是]伪代码

```
- (void)addScoreToHighscores:(NSString *)score withMethod:(NSString *)mode
{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

    NSArray *currentHighscores = [defaults arrayForKey:mode];
    if (!currentHighscores) currentHighscores = [NSArray array];

    if (![currentHighscores containsObject:score]) {
        currentHighscores = [currentHighscores arrayByAddingObject:score];

        //sort currentHighscores: adapt the above code so that we have
        BOOL (^getNumeratorAndDenominatorFromScoreString)(NSString *, NSInteger *, NSInteger *) = //as above
        NSArray *newHighscores = [currentHighscores sortedArrayUsingComparator:^(id obj1, id obj2) {
            //as above
        }];

        //truncate newHighscores
        if ([newHighscores count] > 5) {
            newHighscores = [newHighscores subarrayWithRange:NSMakeRange(0,5)];
        }

        [defaults setObject:newHighscores forKey:mode];
    } else {
        //since score is already in currentHighscores, we're done.
        return;
    }
} 
```

* * *

如果您需要筛选出不相等的分数但分数相等的分数（@“1/2”和@“5/10”），您需要更聪明。

* * *

这是上面草绘的完整代码：

```
- (void)addScoreToHighscores:(NSString *)score withMethod:(NSString *)mode
{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

    NSArray *currentHighscores = [defaults arrayForKey:mode];
    if (!currentHighscores) currentHighscores = [NSArray array];

    if (![currentHighscores containsObject:score]) {
        currentHighscores = [currentHighscores arrayByAddingObject:score];

        //sort currentHighscores: adapt the above code so that we have
        BOOL (^getNumeratorAndDenominatorFromScoreString)(NSString *, NSInteger *, NSInteger *) = ^(NSString *scoreString, NSInteger *numeratorOut, NSInteger *denominatorOut) {
            BOOL res = NO;
            NSArray *components = [scoreString componentsSeparatedByString:@"/"];
            if (components && 
                [components count] == 2) {
                res = YES;
                if (numeratorOut) {
                    NSNumber *numeratorNumber = [components objectAtIndex:0];
                    *numeratorOut = [numeratorNumber integerValue];
                }
                if (denominatorOut) {
                    NSNumber *denominatorNumber = [components objectAtIndex:1];
                    *denominatorOut = [denominatorNumber integerValue];
                }
            }
            return res;
        };

        NSArray *newHighscores = [currentHighscores sortedArrayUsingComparator:^(id obj1, id obj2) {
            NSComparisonResult res = NSOrderedSame;

            NSString *score1 = (NSString *)obj1;
            NSString *score2 = (NSString *)obj2;

            NSInteger numerator1, denominator1, numerator2, denominator2;
            BOOL res1, res2;

            res1 = getNumeratorAndDenominatorFromScoreString(score1, &numerator1, &denominator1);
            res2 = getNumeratorAndDenominatorFromScoreString(score2, &numerator2, &denominator2);

            if (res1
                && res2) {
                CGFloat value1 = ((CGFloat)numerator1)/((CGFloat)denominator1);
                CGFloat value2 = ((CGFloat)numerator2)/((CGFloat)denominator2);

                if (value1 > value2) {
                    res = NSOrderedDescending;
                } else if (value1 < value2) {
                    res = NSOrderedAscending;
                }
            }
            return res;
        }];

        //truncate newHighscores
        if ([newHighscores count] > 5) {
            newHighscores = [newHighscores subarrayWithRange:NSMakeRange(0,5)];
        }

        [defaults setObject:newHighscores forKey:mode];
    } else {
        //since score is already in currentHighscores, we're done.
        return;
    }
} 
```

# eclipse - 在 Eclipse 中更改“修复”背景颜色

> ID：14088926
> 
> 赞同：13
> 
> 时间：2012-12-30T06:57:47.123
> 
> 标签：eclipse, colors

我一直在尝试更改 eclipse juno 中“快速修复”弹出窗口（列出修复错误方法的弹出窗口）的背景颜色。目前颜色为黑色，文本为蓝色，因此很难阅读。

我找不到改变颜色的正确方法。请帮忙。眯着眼睛看黑色背景上的蓝色文字真的很烦人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:21:03.647

这也让我发疯，这是解决方法。

*   转到首选项。

*   搜索“注释”

    ```
    for each Annotation Type:

       if "Text as" == "Highlighted" and Color == black:

           Set the color to light or uncheck "Text As" 
    ```

在此屏幕截图中，我正在修复事件。

我在左边显示的问题是“匹配标签”注释，它有同样的问题。

![显示首选项修复的屏幕截图](../Images/178670d0cd5385f7261951c999c7c82f.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-01T11:53:00.633

您可以更改弹出窗口中文本的颜色。

在 Windows 中，您可以转到控制面板，搜索颜色和指标，然后选择更改窗口颜色和指标。在项目菜单中选择超链接并更改颜色。

编辑：此修复对 Windows 7 有效。Windows 10 没有更改超链接颜色的选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T07:18:20.280

右键单击编辑器窗口中的任意位置，然后在上下文菜单底部选择首选项。这将带你进入`Java -> Editor`. 在该窗口的底部，选择您要更改的元素颜色，在您的情况下是`Parameter hints background`and`Parameter hints background`或`Completion overview background`and `Completion overview foreground`，具体取决于您遇到的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-11T18:56:19.477

根据我的发现，我认为您无法更改颜色。我不愿意去 Eclipse 源代码并找到它，但这就是为我修复它的方法。不完美，但我可以使用快速修复。就我而言，背景和前景是相同的。（Luna，黑暗主题，使用 Solarized Editor 主题）。

*   进入首选项（窗口->首选项）
*   从左侧菜单中选择常规 -> 外观
*   取消选中复选框为标签使用混合字体和颜色

详细信息在这篇文章中。[如何在 Eclipse 中更改自动完成框中的突出显示颜色](https://stackoverflow.com/questions/8012176/how-to-change-the-highlight-color-in-autocomplete-box-in-eclipse)

# c# - JavaScriptSerializer：将列表 + 字符串序列化为 JSON

> ID：14088928
> 
> 赞同：1
> 
> 时间：2012-12-30T06:58:24.427
> 
> 标签：c#, asp.net-mvc, json

我想使用 JavaScriptSerializer 发送包含对象列表和字符串的 JSON 数据包，标识为 ChatLogPath。据我所知，该类只能序列化一个对象 - 作为列表 - 如果我尝试附加多个对象，它显然只会创建像 {...}{...} 这样的无效 JSON工作。

有没有办法做到这一点？我对 C# 和 ASP.NET MVC 非常陌生，所以如果这是一个愚蠢的问题，请原谅我 :)

编辑：这是我现在的代码。

```
 string chatLogPath = "path_to_a_text_file.txt";
    IEnumerable<ChatMessage> q = ...
    ...
    JavaScriptSerializer json = new JavaScriptSerializer();
    return json.Serialize(q) + json.Serialize(chatLogPath); 
```

它将在 JSON { ... } 中输出这样的数组，然后是 chatLogPath { ... }。换句话说，它不能工作，因为那是无效的 JSON。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T07:18:28.913

获取具有数组和路径的单个 JSON 对象的最简单方法是创建一个类或动态对象，每个对象都作为它的属性/字段。

类示例：

```
public class ChatInformation {
  public IEnumerable<ChatMessage> messages;
  public string chatLogPath;
}
...
var output = new ChatInformation {
  messages = ...,
  chatLogPath = "path_to_a_text_file.txt"
};
return json.Serialize(output); 
```

动态示例（需要 .NET 4+）：

```
dynamic output = new ExpandoObject {
  messages = ...,
  chatLogPath = "path_to_a_text_file.txt"
};
return json.Serialize(output); 
```

匿名类型示例（如果您不想拥有另一个类，也不在 .NET 4 上）：

```
var output = new {
  messages = ...,
  chatLogPath = "path_to_a_text_file.txt"
};
return json.Serialize(output); 
```

# c# - 如何在 c# 中禁用 UltraToolBarsManager 的 RibbonGroup

> ID：14088930
> 
> 赞同：1
> 
> 时间：2012-12-30T06:58:31.907
> 
> 标签：c#, infragistics

我想在按钮的单击事件处理程序中禁用我的 UltraToolBarsManager 的 RibbonGroup 的所有工具。我知道我可以使用以下代码

```
toolBarsManager1.Tools["tool1"].SharedProps.Enabled = 
toolBarsManager1.Tools["tool2"].SharedProps.Enabled = 
toolBarsManager1.Tools["tool3"].SharedProps.Enabled = false; 
```

但我想知道是否有办法设置**RibbonGroup**的 Enabled 属性，而不是。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T07:24:52.097

尝试这个：

```
 foreach(ToolBase tool in ultraToolbarsManager1.Ribbon.Tabs[TabKey].Groups[RibonGroupKey].Tools)

            {

                tool.SharedProps.Enabled = enable;

            } 
```

# android - 有时 Google LVL 会因“联系许可服务器时出错”而失败。其他人见过这个吗？

> ID：14088932
> 
> 赞同：1
> 
> 时间：2012-12-30T06:58:53.397
> 
> 标签：android, google-play, android-lvl

我的测试应用程序非常简单，几乎与 LVL 示例相同。当它工作时，它工作得很好。然而，今天两次，我让应用程序进入错误状态，应用程序报告它无法联系许可服务器。
起初我无法清除错误情况 - 即使我尝试过：

*   清除“Google Play 商店”中的数据
*   重新启动我的平板电脑
*   重新安装了我的测试应用

这些都没有帮助。出现此错误，adb logcat 报告：

```
I/LicenseChecker( 7265): Binding to licensing service.
I/LicenseChecker( 7265): Calling checkLicense on service for com.DynaZu.Tracker.Prokey
I/LicenseChecker( 7265): Start monitoring timeout.
I/LicenseChecker( 7265): Received response.
I/LicenseChecker( 7265): Clearing timeout.
W/LicenseValidator( 7265): Error contacting licensing server.
D/LicenseChecker( 7265): Server Failure: ERROR_CONTACTING_SERVER
D/LicenseChecker( 7265): Android ID: 34ac09669bf32423
D/LicenseChecker( 7265): Time: 30 Dec 2012 05:43:31 GMT 
```

我最终所做的是更改 AESObfuscator 使用的 20 字节 SALT 中的一个字节，该 AESObfuscator 传递给 LicenseChecker。这一变化立即解决了这个问题。我希望这有助于解决这个问题。

有没有其他人看到这个问题？混淆的数据是否会以某种方式出现乱码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:52:47.803

我猜这是网络或许可证服务器的暂时性问题。更改盐值应该对此没有任何影响，这只是一个巧合。

# php - 如何恢复 netbeans 的默认行为？

> ID：14088939
> 
> 赞同：6
> 
> 时间：2012-12-30T07:01:00.383
> 
> 标签：php, netbeans

我想我不小心覆盖了 NetBeans 编辑器（Windows 7 上的 7.2）中的一个默认设置，并且一个漂亮的功能消失了。

括号完成功能现在生效。

我是 NetBeans 的新手。我以前打字的时候

```
echo " 
```

NetBeans 用于放置匹配`"`项并将光标放在第一个引号之后

```
echo "|"`   // here the `|` denotes the cursor 
```

因此，当我在那里看到光标时，我只需键入...当我完成键入时，我曾经能够简单地按 Enter 键（而光标仍在右引号内），而 NetBeans 过去常常自动将半-行尾的列（在结束引号之后）并将我推进到下一行 - 非常好。但是现在，输入完全创建了一个新行，将结束引号也推到下一行。显然，不再是半列。

所以我现在最终得到了这个

```
echo "test  
 " 
```

输入用来代替给我这个；

```
echo "test"; 
```

我想知道出了什么问题，在哪里。现在我必须按右箭头才能到达结束引号的右侧并手动放置一个半列，然后按 Enter。

如何恢复默认设置？在这种情况下你会怎么做？

*运行 Windows 7 和 NetBeans 7.2.1*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T07:07:59.490

## 对您的问题的一般回答

设置存储在用户目录中的 XML 文件中：

**例子**

```
${userdir}/config/Editors/text/{PROGRAMMING_LANGUAGE_HERE}/Preferences/org-netbeans-modules-editor-settings-CustomPreferences.xml. 
```

如果您删除此文件，语言设置（包括格式）将设置为默认值。

我不完全确定该功能是否在语言设置中，但只需检查配置目录并删除文件，直到该功能恢复！

您还可以删除 XML 文件的特定部分以仅重置某些设置。

* * *

## 替代您的具体问题（替代方案 1）

在评论中的讨论和一些搜索之后，我发现[这个链接](http://greg.gannicott.co.uk/2010/01/02/netbeans-tip-adding-a-semicolon-to-the-end-of-a-line/)可以替代您的具体要求。我仍将原始答案留在那里，因为它回答了标题中的问题（并帮助未来使用搜索功能的人）。

> ## Netbeans 提示：在 PHP 的行尾添加分号
> 
> 在 Netbeans 中编写 Java 时，有一个方便的快捷方式，即在行尾放置一个分号 (;)，只需按 ctrl+; 即可。这听起来没什么大不了的，但似乎我经常写一段代码，但不知何故最后没有分号。我认为这与代码的完整性有关（例如，在我完成编写我想要编写的代码之前，IDE 永远不会让我到达行尾——这真的是一件好事）。但是，在编写 PHP 时，此功能不可用。
> 
> 证明我实际上发现这个快捷方式有多方便的是，我现在在编写 PHP 时一直在尝试在 Netbeans 中执行此操作，结果却感到失望。
> 
> **如何在 Netbeans for PHP 中执行此操作**
> 
> 但是，有一种在 Netbeans（以及任何提供宏支持的编辑器）中创建此功能的快速方法：
> 
> 在 Netbeans 中，单击文本编辑器中的某处。
> 
> 1.  选择编辑 > 启动宏
>     
>     
> 2.  现在在编辑器中，按“结束”键，然后按“；” 钥匙。您现在应该在行尾有一个分号。
>     
>     
> 3.  选择编辑 > 停止宏
>     
>     
> 4.  给你的宏起个名字（例如“Append ;”）
>     
>     
> 
> 点击“设置快捷方式”</p>
> 
> 按“ctrl+;” 并单击确定
> 
> 你完成了！

* * *

## 替代您的具体问题（替代方案 2）

此外，在 中`Options -> Editor -> Code Templates`，您有一堆模板，包括一个生态快捷方式，它完全符合您的要求（双引号、; 等）！出于某种原因，这些模板不适用于默认设置“在 TAB 上展开模板”，但如果我将其更改为 CTRL+SPACE，它就可以完美运行！

# python - 如何在 emacs 的终端中启用`flymake-display-err-menu-for-current-line`？

> ID：14088940
> 
> 赞同：1
> 
> 时间：2012-12-30T07:01:11.520
> 
> 标签：python, user-interface, emacs, terminal, flymake

我正在使用`flymake-python`. 当我执行`flymake-display-err-menu-for-current-line`时，emacs 总是抱怨`Can not put GUI menu on this terminal`。

有没有人知道如何在终端中显示 flymake 的消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:02:47.200

尝试在您的 emacs 配置中设置以下内容：

```
(setq flymake-gui-warnings-enabled nil) 
```

您可以考虑使用[flycheck](https://github.com/lunaryorn/flycheck)而不是 flymake。它正在积极开发中，无需任何额外配置即可在 python 上正常工作。

# ruby-on-rails - 如何从模型中调用辅助方法？

> ID：14088945
> 
> 赞同：4
> 
> 时间：2012-12-30T07:02:15.963
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model

我在带有 MongoID gem 的 Rails 应用程序中使用 MongoDB 作为数据库。我想使用 n aafter_create 回调方法从模型中调用辅助方法。这怎么可能？
我的模型代码是：

```
class Department
  include ApplicationHelper
  after_create :create_news
  private
  def create_news
    @user = ApplicationHelper.get_current_users
  end
end 
```

我的帮助代码是：

```
module ApplicationHelper
  def get_current_users
    current_user
  end
end 
```

当我创建新部门时，会发生以下错误。

```
undefined method `get_current_users' for ApplicationHelper:Module 
```

如何消除错误？
提前致谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-10-07T15:14:02.043

我也使用 mongoid 并且一直使用它。不过，这不应该是 mongoid 独有的。

```
ApplicationController.helpers.my_helper_method 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T07:38:40.270

如果你想要一个可以在你的视图中使用的帮助方法来返回当前用户，你可以在你的 ApplicationController 中这样做，例如：

```
private
def current_user
  @current_user ||= User.find(session[:user_id]) if session[:user_id]
end 
helper_method :current_user 
```

然后您可以在任何视图中使用它。

如果您希望模型中的某个任意方法知道它正在处理的用户是什么，**请在您在控制器中调用它时将其作为参数****传递** 给该方法。`@current_user`

 **您的代码似乎不完整，因此我无法真正看到您要完成的工作，但这是一种非常标准的做法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-30T07:09:57.980

确保模块文件命名正确，这意味着在您的情况下 application_helper.rb 并且它位于帮助程序库中。

您还可以尝试在 ApplicationController (app/controller/application_controller.rb) 中包含帮助程序。**

# phpmyadmin - 做一个简单的调查(phpmyadmin)

> ID：14088950
> 
> 赞同：0
> 
> 时间：2012-12-30T07:03:30.247
> 
> 标签：phpmyadmin

我正在使用 php myadmin 进行一个简单的调查，以便稍后分析数据。我运行这段代码，我只是得到一个空白页。问题和解决方案可能是什么？我一直盯着这段代码好几个小时了，还没有解决方案。赛安普

```
<?php
$init_connection = mysql_connect("localdev1.local","user","123" );
mysql_select_db("Word Think",$init_connection);

function displaySurvey ($prompt, $questions){
echo "<td><b>".$prompt."</b><form method=\"post\" action=\"\">"
    "<table border=\"0\"/>"

for(i = 0; $i <count($questions) ;$i++){
    echo "<tr><td><label><input type=\"radio\" name+\survey\" value=\"".i."\"/>".
$questions[$i]."</label></td></tr>"; 
}

echo "</table>"
<input type=\"submit\" name=\"submit" value=\"Select Appropriate Response\" /> 
</form></td></td></table>";
}
$answer_1 = "*SELECT * FROM poll WHERE id = 1";
$process_one = mysql_query($answer_1);
while($row = mysql_fetch_array($process_one, MYSQL_ASSOC)){
$mod_c_one = (int)$row['c_one'] + 1;
$mod_c_two = (int)$row['c_two'] + 1;
$mod_c_three = (int)$row['c_three'] + 1;
$mod_c_four = (int)$row['c_four'] + 1;
}
$choices = array('Definately Yes', 'Yes', 'Undecided', 'No', 'Definately No' );
echo "<table><tr><td><b>Results;</b><table><tr><td>".(mod_c_1-1)."</td><td>".
$choices[0]."<td></tr><tr><td>".($mod_c_2-1)."</td><td>".$choices[1]."</td></tr><tr><td>".
($mod_c_3-1)."</td><td>".$choices[2]."</td></tr><tr><td>".($mod_c_4-1)."</td>          <td>".$choices[3]."</td></tr></table></td>";
displaySurvey('Would Your Recomend Your Current Employer', $choices);
if(isset($_POST['sumbit'])){
if(isset($_POST['survey']))
    $selection = $_POST['survey'];
else
    $selection = "";

if(strlen($selection) > 0){
    switch((int)$selection){
        case 0:
            $select_stmt = "UPDATE survey SET c_1 = $mod_c_1 WHERE id =     1";
        case 1:
            $select_stmt = "UPDATE survey SET c_2 = $mod_c_2 WHERE id = 1";
        case 2:
            $select_stmt = "UPDATE survey SET c_3 = $mod_c_3 WHERE id = 1";
        case 3:
            $select_stmt = "UPDATE survey SET c_4 = $mod_c_4 WHERE id = 1";
    }

    $process = myswq_query($select_stmt)or die(mysql_error());
    if($process)
        echo "Thank you for participating";
    else
        echo "Error";

    echo $chocies[$selection];
    }else
        echo "You have not selected a response yet";
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T07:14:27.340

PHP 文件中的空白可能会引起一些真正的麻烦（通常以空白页的形式）。您似乎在结束`?>`标记后有两个空格。尝试删除它们，看看会发生什么。

# java - ArrayIndexOutOfBoundsException 错误

> ID：14088951
> 
> 赞同：1
> 
> 时间：2012-12-30T07:03:56.243
> 
> 标签：java, hadoop

当我运行我的代码时，我`ArrayIndexOutOfBoundsException`从减速器的任务中得到错误。

我的代码如下：

```
public void map(ImageHeader key, FloatImage value, Context context) throws IOException, InterruptedException{
    if (value != null) {
        mapcounter++;
        FloatImage gray=new FloatImage(value.getWidth(),value.getHeight(),value.getBands());

        int imageWidth = value.getWidth();
        int imageHeight = value.getHeight();

        for (int x = 0; x < imageWidth-1; x++) {

            for (int y = 0; y < imageHeight-1; y++) {
                float red =value.getPixel(x, y, 0);
                float green =value.getPixel(x, y, 1);
                float blue =value.getPixel(x, y, 2);
                //average of RGB
                float avg = (red + blue + green)/3;

                //set R, G & B with avg color
                gray.setPixel(x, y, 0, avg);
                gray.setPixel(x, y, 1, avg);
                gray.setPixel(x, y, 2, avg);
            }
        }

        ImageEncoder encoder = JPEGImageUtil.getInstance();

        FSDataOutputStream os = fileSystem.create(outpath);
        encoder.encodeImage(gray, key, os);
        os.flush();
        os.close();

        context.write(new BooleanWritable(true), new LongWritable(1));
    }
    else
        context.write(new BooleanWritable(false), new LongWritable(0));
}
public static class MyReducer extends Reducer<BooleanWritable, LongWritable, BooleanWritable, LongWritable> {

    public void reduce(BooleanWritable key, Iterable<LongWritable> values, Context context)
        throws IOException, InterruptedException
        {
            System.out.println("REDUCING");
            for (LongWritable temp_hash : values)
            {
                   context.write(new BooleanWritable(true), new LongWritable(1));
            }//for
        }
} 
```

错误如下：

```
...
12/12/30 09:06:01 INFO mapred.JobClient:  map 100% reduce 33%
12/12/30 09:06:03 INFO mapred.JobClient: Task Id : attempt_201212271308_0005_r_000000_0, Status : FAILED
java.lang.ArrayIndexOutOfBoundsException: 1
        at org.apache.hadoop.io.WritableComparator.readInt(WritableComparator.java:153)
        at org.apache.hadoop.io.BooleanWritable$Comparator.compare(BooleanWritable.java:103)
        at org.apache.hadoop.mapreduce.ReduceContext.nextKeyValue(ReduceContext.java:120)
        at org.apache.hadoop.mapreduce.ReduceContext.nextKey(ReduceContext.java:92)
        at org.apache.hadoop.mapreduce.Reducer.run(Reducer.java:175)
        at org.apache.hadoop.mapred.ReduceTask.runNewReducer(ReduceTask.java:566)
        at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:408)
        at org.apache.hadoop.mapred.Child.main(Child.java:170) 
```

我该如何解决这个问题？

第二个问题：如何在我的程序中忽略 reduce 阶段而不运行 reduce 阶段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T07:56:46.900

看起来这是 Apache-hoop 中的一个错误。他们声称他们已修复如下。

> 它作为 MAPREDUCE-365 的一部分被修复。

您能否参考[此处](http://lucene.472066.n3.nabble.com/It-is-possible-a-bug-about-BooleanWritable-td995245.html)了解有关该错误的详细信息。

# jquery - “悬停”在 iPad 上播放音乐

> ID：14088954
> 
> 赞同：1
> 
> 时间：2012-12-30T07:04:36.210
> 
> 标签：jquery, ios, html, safari, jplayer

我正在设计一个带有多个图块的网页。在桌面上，悬停每个图块将触发 jPlayer 开始播放音乐预览，执行此操作的代码（使用 jQuery）是：

```
function init_tile(id, url) {
    $(id).hover(
        function() {
            $('#player').jPlayer("setMedia", {mp3: url}).jPlayer("play");
        },
        function() {
            $('#player').jPlayer("stop");
        }
    );
} 
```

除了 iOS 上的 Mobile Safari 之外，它运行良好： [jPlayer does not play audio file automatically in iPad](https://stackoverflow.com/questions/5898257/jplayer-doesnt-play-audio-file-automatically-in-ipad?rq=1)，我从中了解到只有用户操作（单击/点击但不是“悬停”，这在触摸屏上没有意义) 可以触发 HTML5 播放。

我喜欢这个`.hover`电话，因为它在 iPad 上运行得非常好。第一次快速点击将触发悬停状态，然后第二次点击将跟随链接。点击其他图块将恢复之前悬停的图块。如果我选择使用来自 jquery-mobile 的 'tap' 事件来模拟这个，那将会很麻烦。

我想知道这个的捷径解决方案是什么。我正在为所有依赖项使用最新的稳定版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:38:40.517

好的，我自己来回答。

事实证明，这并没有太大的麻烦。即使我不使用 mouseover/mouseenter，Mobile Safari 仍会将 mouseover/mouseout 发送到“热门项目”。我不必专门跟踪瓷砖。

我最终得到了这样的结果：

```
if (Modernizr.touch) {
    $(id).click(
        function (e) {
            if ($(id).hasClass('playing')) {
                $(id).trigger('mouseout');
            } else {
                e.preventDefault();
                $(id).addClass('playing');
                $('#player').jPlayer("setMedia", {mp3: url}).jPlayer("play");
            }
        });
    $(id).mouseout(
        function () {
            $(id).removeClass('playing');
            $('#player').jPlayer("stop");
        });
} else {
    $(id).hover(
        function () {
            $('#player').jPlayer("setMedia", {mp3: url}).jPlayer("play");
        },
        function () {
            $('#player').jPlayer("stop");
        }
    );
} 
```

它使用[modernizr](http://modernizr.com)来检测触摸设备。这基本上是“第一次点击悬停，第二次点击跟随”行为的手动实现。而且您不必跟踪热磁贴。

# listview - KendoMobileListView - 想要删除每个列表项中的前导黑点

> ID：14088967
> 
> 赞同：0
> 
> 时间：2012-12-30T07:08:21.113
> 
> 标签：listview, mobile, kendo-ui

我是 KENDO 手机的新手。当我显示我的 kendoMobileListView 时，对于列表中的每个项目，我都会看到一个前导黑点。

谁能告诉我应该如何隐藏这个点？

谢谢

哈盖

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T14:43:46.593

这意味着未正确加载 Kendo Mobile CSS 文件。检查是否不是这种情况。

# css - 用css创建一个facebook风格的状态更新框？

> ID：14088970
> 
> 赞同：-1
> 
> 时间：2012-12-30T07:08:54.063
> 
> 标签：css, callout

我一直在互联网上寻找有关如何创建 facebook 样式状态更新 css 框的教程。这是当前的 facebook 状态更新标注框，它是方形的，顶部有一个小凹槽。

任何人都可以帮我为这样的东西组合一个CSS设计吗？

谢谢

例子：

```
________^_____________________
|                             |
|                             |
|                             |
|_____________________________| 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T07:15:50.500

看看[这个演示](http://nicolasgallagher.com/pure-css-speech-bubbles/demo/)，它列出了很多种“带箭头的盒子”。

# boost - BOOST_PARAMETER_FUNCTION 最多可以处理 5 个参数吗？

> ID：14088971
> 
> 赞同：2
> 
> 时间：2012-12-30T07:08:56.383
> 
> 标签：boost, parameters

当我运行下面的代码时，出现以下错误（在 kubuntu 12.04 上运行的提升版本 1.46.1-7ubuntu3）：

```
test_param_bug.cpp:34:1: error: wrong number of template arguments (6, should be 5)
/usr/include/boost/parameter/parameters.hpp:714:8: error: provided for ‘template<class PS0, class PS1, class PS2, class PS3, class PS4> struct boost::parameter::parameters’
In file included from test_param_bug.cpp:2:0:
/usr/include/boost/parameter/preprocessor.hpp: In instantiation of ‘boost::parameter::aux::argument_pack<boost_param_params_34func<int> >’:
test_param_bug.cpp:34:1:   instantiated from here
/usr/include/boost/parameter/preprocessor.hpp:157:13: error: no type named ‘parameter_spec0’ in ‘struct boost_param_params_34func<int>’
/usr/include/boost/parameter/preprocessor.hpp:158:47: error: no type named ‘parameter_spec0’ in ‘struct boost_param_params_34func<int>’
test_param_bug.cpp:34:1: error: template argument 1 is invalid
test_param_bug.cpp:34:1: error: expected initializer before ‘func’
test_param_bug.cpp:34:1: error: wrong number of template arguments (7, should be 6)
/usr/include/boost/parameter/preprocessor.hpp:148:8: error: provided for ‘template<class Parameters, class A0, class A1, class A2, class A3, class A4> struct boost::parameter::aux::argument_pack’
test_param_bug.cpp:34:1: error: template argument 1 is invalid
test_param_bug.cpp:34:1: error: wrong number of template arguments (7, should be 6)
/usr/include/boost/parameter/preprocessor.hpp:98:8: error: provided for ‘template<class Parameters, class A0, class A1, class A2, class A3, class A4> struct boost::parameter::aux::match’
test_param_bug.cpp: In function ‘int main()’:
test_param_bug.cpp:41:10: error: no matching function for call to ‘func()’
test_param_bug.cpp:41:10: note: candidates are:
 ...CUT.... 
```

不过，它最多可以使用五个参数。让它运行会很好，因为我认为这是一个方便的功能。这是一个众所周知的限制还是我没有正确使用它？

```
BOOST_PARAMETER_FUNCTION(
  (void),
  func,
  tag, 
  (optional
   (param1, (int), 0)
   (param2, (int), 0)
   (param3, (int), 0)
   (param4, (int), 0)
   (param5, (int), 0)
   (param6, (int), 0) //<- won't work. too many arguments?
   )
  )
{
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T11:52:33.927

在包含标头之前，可以使用`#define BOOST_PARAMETER_MAX_ARITY n`（在您的情况下为 n = 6）配置 Boost.Parameter 中函数中的最大参数数。`5`此参数在 boost 1.49 之前的默认值。值`8`在那之后。我相信增加这个数字会影响程序的编译时间，所以你应该将它设置为你需要的，而不是任意高。

# asp.net-mvc - 违反了多重性约束。数据库优先 EF 4.1

> ID：14088973
> 
> 赞同：2
> 
> 时间：2012-12-30T07:09:50.190
> 
> 标签：asp.net-mvc, entity-framework, entity-framework-4, edmx

我有以下模型： ![EDMX](../Images/3e1053963fe884f72e1e8b1524737d19.png)

我运行以下命令来添加一个新用户：

```
 using (var context = new CamelotDB())
    {
        Console.WriteLine("Creating Test User");
        DomainEntity userToAdd = new DomainEntity()
        {
            EntityName = "Test User",
            EntityType = DomainEntity.eEntityType.User,
            EntityCreationDate = DateTime.Now,
            EntityLastUpdateDate = DateTime.Now,
            EntityCreatorUserID = 0,
            Creator = context.DomainEntities.Find(0),
            EntityUpdaterUserID = 0,
            Updater = context.DomainEntities.Find(0),
            EntityParentID = null,
            UserDetails = new User()
            {
                Username = "TestUser",
                Password = "123",
                Email = "TestUser@Test.org",
                FirstName = "Test",
                LastName = "User",
                Phone = "123456789"
            }
        };

        Console.WriteLine("Adding user to Database...");
        userToAdd = context.DomainEntities.Add(userToAdd);
        context.SaveChanges();

    } 
```

我收到以下错误：违反多重性约束。关系“CamelotShiftManagement.DAL.DomainEnttyFK1”的角色“用户”具有多重性 1 或 0..1.![在此处输入图像描述]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T09:22:59.327

问题不在于域实体引用的用户实体。问题是创建者和更新者的自我引用。它们都不是 Nullable ...所以我必须在属性中添加一个实际的 ID 号，并且需要在 Creator 和 Updater 的导航属性中放置一个实际的用户实体。

# java - Reduce DataJoin 中的 java.lang.reflect.InvocationTargetException（Hadoop 实战）

> ID：14088977
> 
> 赞同：1
> 
> 时间：2012-12-30T07:10:33.643
> 
> 标签：java, hadoop

我在运行 Hadoop In Action 中的 DataJoin 示例时遇到问题。似乎在运行作业时，抛出了 java.lang.reflect.InvocationTargetException。我试了一天还是不行。我做错了什么？

下面是例外

```
12/12/30 01:54:06 INFO mapred.JobClient: Task Id : attempt_201212280853_0032_m_000000_2, Status : FAILED
java.lang.RuntimeException: Error in configuring object
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:106)
    at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:72)
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:130)
    at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:389)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:327)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:268)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1332)
    at org.apache.hadoop.mapred.Child.main(Child.java:262)
Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.ja 
```

下面是取自 Hadoop In Action 的代码。我的输入目录中有customers.txt 和orders.txt。我尝试将输入目录中的这两个文件重命名为 part-0000.txt 和 part-0001.txt ，但它仍然不起作用。

```
import java.io.DataInput;
import java.io.DataOutput;
import java.io.IOException;
import java.util.Iterator;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.conf.Configured;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.io.Writable;
import org.apache.hadoop.mapred.FileInputFormat;
import org.apache.hadoop.mapred.FileOutputFormat;
import org.apache.hadoop.mapred.JobClient;
import org.apache.hadoop.mapred.JobConf;
import org.apache.hadoop.mapred.KeyValueTextInputFormat;
import org.apache.hadoop.mapred.MapReduceBase;
import org.apache.hadoop.mapred.Mapper;
import org.apache.hadoop.mapred.OutputCollector;
import org.apache.hadoop.mapred.Reducer;
import org.apache.hadoop.mapred.Reporter;
import org.apache.hadoop.mapred.TextInputFormat;
import org.apache.hadoop.mapred.TextOutputFormat;
import org.apache.hadoop.util.ReflectionUtils;
import org.apache.hadoop.util.Tool;
import org.apache.hadoop.util.ToolRunner;

import org.apache.hadoop.contrib.utils.join.DataJoinMapperBase;
import org.apache.hadoop.contrib.utils.join.DataJoinReducerBase;
import org.apache.hadoop.contrib.utils.join.TaggedMapOutput;

/**
 * DataJoinMapperBase has a method method - http://hadoop.apache.org/docs/mapreduce/r0.21.0/api/org/apache/hadoop/contrib/utils/join/DataJoinMapperBase.html
 * 
 * map(Object key, Object value, OutputCollector output, Reporter reporter) 
 *  
 */

public class DataJoin extends Configured implements Tool {

    public static class MapClass extends DataJoinMapperBase {

        protected Text generateInputTag(String inputFile) {
            String datasource = inputFile.split("-")[0];
            return new Text(datasource);

        }

        protected Text generateGroupKey(TaggedMapOutput aRecord) {
            String line = ((Text) aRecord.getData()).toString();
            String[] tokens = line.split(",");
            String groupKey = tokens[0];
            return new Text(groupKey);
        }

        protected TaggedMapOutput generateTaggedMapOutput(Object value) {
            TaggedWritable retv = new TaggedWritable();
            retv.setData((Text) value);
            retv.setTag(this.inputTag);
            return retv;
        }
    }

    public static class Reduce extends DataJoinReducerBase {

        protected TaggedMapOutput combine(Object[] tags, Object[] values) {
            if (tags.length < 2) return null;  
            String joinedStr = ""; 
            for (int i=0; i<values.length; i++) {
                if (i > 0) joinedStr += ",";
                TaggedWritable tw = (TaggedWritable) values[i];
                String line = ((Text) tw.getData()).toString();
                String[] tokens = line.split(",", 2);
                joinedStr += tokens[1];
            }
            TaggedWritable retv = new TaggedWritable();
            retv.setData(new Text(joinedStr));
            retv.setTag((Text) tags[0]); 
            return retv;
        }
    }

    public static class TaggedWritable extends TaggedMapOutput {

        private Writable data;

//        public TaggedWritable(Writable data) {
//            this.tag = new Text("");
//            this.data = data;
//        }
        public TaggedWritable() {
            this.tag = new Text();
        }        

        public Writable getData() {
            return data;
        }

        public void setData(Writable data) {
            this.data = data;
        }        

        public void write(DataOutput out) throws IOException {
            this.tag.write(out);
            this.data.write(out);
        }

        public void readFields(DataInput in) throws IOException {
            this.tag.readFields(in);
            String dataClz = in.readUTF();
            if (this.data == null
                    || !this.data.getClass().getName().equals(dataClz)) {
                try {
                    this.data = (Writable) ReflectionUtils.newInstance(
                            Class.forName(dataClz), null);
                } catch (ClassNotFoundException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
            this.data.readFields(in);
        }        

//        public void readFields(DataInput in) throws IOException {
//            this.tag.readFields(in);
//            this.data.readFields(in);
//        }
    }

    public int run(String[] args) throws Exception {
        Configuration conf = getConf();

        JobConf job = new JobConf(conf, DataJoin.class);

        Path in = new Path(args[0]);
        Path out = new Path(args[1]);
        FileInputFormat.setInputPaths(job, in);
        FileOutputFormat.setOutputPath(job, out);

        job.setJobName("DataJoin");
        job.setMapperClass(MapClass.class);
        job.setReducerClass(Reduce.class);

        job.setInputFormat(TextInputFormat.class);
        job.setOutputFormat(TextOutputFormat.class);
        job.setOutputKeyClass(Text.class);
        job.setOutputValueClass(TaggedWritable.class);
        job.set("mapred.textoutputformat.separator", ",");

        JobClient.runJob(job); 
        return 0;
    }

    public static void main(String[] args) throws Exception { 
        int res = ToolRunner.run(new Configuration(),
                                 new DataJoin(),
                                 args);

        System.exit(res);
    }
}

I hit the similar problem and java.lang.reflect.InvocationTargetException was the root cause...what did i do wrong?

12/12/30 01:54:06 INFO mapred.JobClient: Task Id : attempt_201212280853_0032_m_000000_2, Status : FAILED
java.lang.RuntimeException: Error in configuring object
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:106)
    at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:72)
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:130)
    at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:389)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:327)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:268)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1332)
    at org.apache.hadoop.mapred.Child.main(Child.java:262)
Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.ja
Below is the code taken from the Hadoop In Action

import java.io.DataInput;
import java.io.DataOutput;
import java.io.IOException;
import java.util.Iterator;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.conf.Configured;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.io.Writable;
import org.apache.hadoop.mapred.FileInputFormat;
import org.apache.hadoop.mapred.FileOutputFormat;
import org.apache.hadoop.mapred.JobClient;
import org.apache.hadoop.mapred.JobConf;
import org.apache.hadoop.mapred.KeyValueTextInputFormat;
import org.apache.hadoop.mapred.MapReduceBase;
import org.apache.hadoop.mapred.Mapper;
import org.apache.hadoop.mapred.OutputCollector;
import org.apache.hadoop.mapred.Reducer;
import org.apache.hadoop.mapred.Reporter;
import org.apache.hadoop.mapred.TextInputFormat;
import org.apache.hadoop.mapred.TextOutputFormat;
import org.apache.hadoop.util.ReflectionUtils;
import org.apache.hadoop.util.Tool;
import org.apache.hadoop.util.ToolRunner;

import org.apache.hadoop.contrib.utils.join.DataJoinMapperBase;
import org.apache.hadoop.contrib.utils.join.DataJoinReducerBase;
import org.apache.hadoop.contrib.utils.join.TaggedMapOutput;

/**
 * DataJoinMapperBase has a method method - http://hadoop.apache.org/docs/mapreduce/r0.21.0/api/org/apache/hadoop/contrib/utils/join/DataJoinMapperBase.html
 * 
 * map(Object key, Object value, OutputCollector output, Reporter reporter) 
 *  
 */

public class DataJoin extends Configured implements Tool {

    public static class MapClass extends DataJoinMapperBase {

        protected Text generateInputTag(String inputFile) {
            String datasource = inputFile.split("-")[0];
            return new Text(datasource);

        }

        protected Text generateGroupKey(TaggedMapOutput aRecord) {
            String line = ((Text) aRecord.getData()).toString();
            String[] tokens = line.split(",");
            String groupKey = tokens[0];
            return new Text(groupKey);
        }

        protected TaggedMapOutput generateTaggedMapOutput(Object value) {
            TaggedWritable retv = new TaggedWritable();
            retv.setData((Text) value);
            retv.setTag(this.inputTag);
            return retv;
        }
    }

    public static class Reduce extends DataJoinReducerBase {

        protected TaggedMapOutput combine(Object[] tags, Object[] values) {
            if (tags.length < 2) return null;  
            String joinedStr = ""; 
            for (int i=0; i<values.length; i++) {
                if (i > 0) joinedStr += ",";
                TaggedWritable tw = (TaggedWritable) values[i];
                String line = ((Text) tw.getData()).toString();
                String[] tokens = line.split(",", 2);
                joinedStr += tokens[1];
            }
            TaggedWritable retv = new TaggedWritable();
            retv.setData(new Text(joinedStr));
            retv.setTag((Text) tags[0]); 
            return retv;
        }
    }

    public static class TaggedWritable extends TaggedMapOutput {

        private Writable data;

//        public TaggedWritable(Writable data) {
//            this.tag = new Text("");
//            this.data = data;
//        }
        public TaggedWritable() {
            this.tag = new Text();
        }        

        public Writable getData() {
            return data;
        }

        public void setData(Writable data) {
            this.data = data;
        }        

        public void write(DataOutput out) throws IOException {
            this.tag.write(out);
            this.data.write(out);
        }

        /***

          //  public void readFields(DataInput in) throws IOException {
          //  this.tag.readFields(in);
          //  String dataClz = in.readUTF();
          //  if (this.data == null
          //          || !this.data.getClass().getName().equals(dataClz)) {
          //      try {
          //          this.data = (Writable) ReflectionUtils.newInstance(
          //                  Class.forName(dataClz), null);
          //      } catch (ClassNotFoundException e) {
          //          // TODO Auto-generated catch block
          //          e.printStackTrace();
          //      }
          //  }
          //this.data.readFields(in);
        //}

        *****/        

        public void readFields(DataInput in) throws IOException {
            this.tag.readFields(in);
            this.data.readFields(in);
        }
    }

    public int run(String[] args) throws Exception {
        Configuration conf = getConf();

        JobConf job = new JobConf(conf, DataJoin.class);

        Path in = new Path(args[0]);
        Path out = new Path(args[1]);
        FileInputFormat.setInputPaths(job, in);
        FileOutputFormat.setOutputPath(job, out);

        job.setJobName("DataJoin");
        job.setMapperClass(MapClass.class);
        job.setReducerClass(Reduce.class);

        job.setInputFormat(TextInputFormat.class);
        job.setOutputFormat(TextOutputFormat.class);
        job.setOutputKeyClass(Text.class);
        job.setOutputValueClass(TaggedWritable.class);
        job.set("mapred.textoutputformat.separator", ",");

        JobClient.runJob(job); 
        return 0;
    }

    public static void main(String[] args) throws Exception { 
        int res = ToolRunner.run(new Configuration(),
                                 new DataJoin(),
                                 args);

        System.exit(res);
    }
} 
```

# php - 我应该在模型类中为哪些输入定义规则？

> ID：14088978
> 
> 赞同：0
> 
> 时间：2012-12-30T07:11:01.317
> 
> 标签：php, yii, yii-validation

我应该为模型类中的所有输入元素定义规则吗？例如，模型表单有 2 个输入类型元素和一个文本区域。我可以只为这两种输入类型而不是 textarea 定义规则吗？

我已经这样做了，但是在 textarea 中输入的文本没有保存，但是如果我为它的长度设置一个规则，例如它会被保存。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T07:55:39.160

如果您没有为属性定义任何规则（或定义`unsafe`规则），则在批量分配 ( ) 期间不会设置该属性`$model->attributes = $_POST['ModelClassName']`。这似乎是您的 textarea 值未保存的最可能原因。请参阅[保护属性分配](http://www.yiiframework.com/doc/guide/1.1/en/form.model#securing-attribute-assignments)。

* * *

Yii 文档建议只为接受用户输入的字段创建规则。但是，我发现为所有属性指定规则很有用，既基于业务逻辑，也基于底层数据库存储（尽管我不喜欢同一个类必须担心这两个方面的事实），然后将`unsafe`规则添加到不允许批量赋值的字段。

# java - 当我从 Java 中的网页检索数据时，为什么 html 实体显示错误

> ID：14088984
> 
> 赞同：1
> 
> 时间：2012-12-30T07:12:47.360
> 
> 标签：java, html-entities

当我从 Java 网页中检索数据时，为什么 html 实体显示错误：

```
 URL url = new URL("http://www.eslcafe.com/joblist/index.cgi?read=27334");
    URLConnection connection = url.openConnection();

    BufferedReader reader = new BufferedReader(new InputStreamReader(connection.getInputStream(), Charset.forName("ISO-8859-1")));

    String line = null;

    while ((line = reader.readLine()) != null) {

        System.out.println(line);
    } 
```

这个页面的标题应该被检索为“A LITTLE Different in Hsin-Chu, Taiwan！”，但是“”从来没有正确显示，我的默认字符集也是“ISO-8859-1”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T08:41:58.003

我已经用 curl 下载了你的网页，并用十六进制编辑器打开了它。可以看出《新竹有一点不同》前面的“”实际上是0xA0而不是0x20，即不是人们常用的空白字符，也许这就是它显示不正确的原因。希望能帮助到你。

# asp.net-mvc - 当我想在内容文件夹中创建文件夹时访问被拒绝

> ID：14088986
> 
> 赞同：0
> 
> 时间：2012-12-30T07:13:07.530
> 
> 标签：asp.net-mvc, file-upload, asp.net-mvc-4

嗨，我正在使用此代码通过 ASP.NET MVC 上传文件，一切正常，但无法访问上传文件夹：

```
public static char DirSeparator = System.IO.Path.DirectorySeparatorChar;
        public static string FilesPath = "Content" + DirSeparator + "Uploads" + DirSeparator;
        public static string UploadFile(HttpPostedFileBase file)
        {
            if (null == file) return "";
            if (!(file.ContentLength > 0)) return "";
            string fileName = file.FileName; string fileExt = Path.GetExtension(file.FileName);
            if (null == fileExt) return "";
            if (!Directory.Exists(FilesPath))
            {
                Directory.CreateDirectory(FilesPath);
            }
            string path = FilesPath + DirSeparator + fileName;
            file.SaveAs(Path.GetFullPath(path));
            return fileName;
        } 
```

我得到这个错误：

```
Access to '/Content/Upload/' is Denied 
```

我的问题在哪里，

**谢谢您的建议**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:15:09.687

您的问题在于权限，并且您的权限是以无权访问您请求它创建目录的位置的用户身份运行的。确保您的用户拥有或具有组权限，并在您尝试的位置创建文件/文件夹。

# android - 从 web 视图播放 youtube 视频

> ID：14088996
> 
> 赞同：4
> 
> 时间：2012-12-30T07:15:36.240
> 
> 标签：android, youtube-api

是否可以从 webview 播放 youtube 视频，就像我从浏览器访问 youtube 网站并且视频开始播放时一样，它会全屏播放视频。

到目前为止，这是我的代码：

```
webView = (WebView) v.findViewById(R.id.webview);
webView.setWebChromeClient(new WebChromeClient()); 
webView.setWebViewClient(new WebViewClient()); 
webView.getSettings().setJavaScriptEnabled(true); 
webView.getSettings().setPluginState(WebSettings.PluginState.ON);
webView.setWebChromeClient(new WebChromeClient() {
        public void onShowCustomView(View view, WebChromeClient.CustomViewCallback callback) {
            super.onShowCustomView(view, callback);
            if (view instanceof FrameLayout) {
                final FrameLayout frame = (FrameLayout) view;
                if (frame.getFocusedChild() instanceof VideoView) {
                    // get video view

                    VideoView video = (VideoView) frame.getFocusedChild();
                    Uri mUri = null;
                    try {
                        Field mUriField = VideoView.class.getDeclaredField("mUri");
                        mUriField.setAccessible(true);
                        mUri = (Uri) mUriField.get(video);
                        Log.d(TAG, "the uri is "+mUri.toString());
                        Intent i = new Intent();
                        i.setData(mUri);
                        i.setAction(Intent.ACTION_VIEW);
                        startActivity(i);
                    } catch (Exception e) {
                        e.printStackTrace();
                    }

                }
            }
        }
    });

webView.loadUrl("www.youtube.com"); 
```

我只想在用户单击 webview 内的 youtube 视频上的“播放”时才启动 youtube 应用程序，而不是之前。

需要显示整个频道，因此用户可以选择他想播放的视频，与从浏览器应用程序访问 youtube 网站的行为相同。

**编辑：**正如我所建议的，我添加了 onShowCustomView() 方法来处理播放点击，现在我得到了一些 uri，我怎样才能在全屏 videoview 中播放视频？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T08:00:35.090

```
webView = (WebView) findViewById( R.id.webview_1 );

String play= "<html><body>Youtube <br> <iframe class=\"youtube-player\" type=\"text/html\" width=\"600\" height=\"300\" src=\"http://www.youtube.com/embed/bIPcobKMB94\" frameborder=\"0\"></body></html>"

webView.loadData(play, "text/html", "utf-8"); 
```

也可以看到..
[YouTube 视频未在 WebView 中播放 - Android](https://stackoverflow.com/questions/12708890/youtube-video-not-playing-in-webview-android)

# objective-c - 当一个局部变量持有委托引用时，它什么时候会被杀死？

> ID：14088998
> 
> 赞同：0
> 
> 时间：2012-12-30T07:15:54.727
> 
> 标签：objective-c, ios, delegates

我不太了解委托模式中的内存管理。

在 Controller 中，如果它**拥有**该对象。我们应该为它分配一个强指针。这样它所**拥有**的对象就不会丢失。

我创建了一个小型库类来帮助我进行异步连接，它拥有一个指向采用其协议的 ViewController 的弱指针。连接完成后，数据被发送回 ViewController。

```
#import <Foundation/Foundation.h>

@protocol AsyncConnectionDelegate;

@interface AsyncConnection : NSObject <NSURLConnectionDataDelegate>
@property (weak, nonatomic) id <AsyncConnectionDelegate> delegate;

-(void)callAsyncConnectionAtUrl:(NSString *)url dictionary:(NSDictionary *)dictionary method:(NSString *)method delegate:(id)delegate;
@end

@protocol AsyncConnectionDelegate <NSObject>
- (void)finishConnectionWithData:(NSData *)data connection:(AsyncConnection *)connection;
@end 
```

**用法：（**按下按钮时）

```
// user input
NSString *username = _usernameTextField.text;
NSString *password = _pwdTextField.text;

//create dictionary key-value pair for transformming into NSData
NSMutableDictionary *loginKeyValue = [[NSMutableDictionary alloc]init];
[loginKeyValue setObject:username forKey:@"username"];
[loginKeyValue setObject:password forKey:@"password"];

AsyncConnection *conc = [[AsyncConnection alloc]init];
[conc callAsyncConnectionAtUrl:@"http://localhost:3000/login.json" dictionary:loginKeyValue method:@"POST" delegate:self]; 
```

这里`*conc`只是一个局部变量，视图控制器**并没有对它持有强引用**。所以在我看来，它应该在方法完成执行时被杀死。但是，它可以是活动的并将数据发送回 ViewController。

**委托方法**

```
- (void)finishConnectionWithData:(NSData *)data connection:(AsyncConnection *)connection{

    NSLog(@"Connection Object : %@", connection );

    Member *member = [Member initWithData:data];
    NSLog(@"member username \n %@",member.username);
    NSLog(@"member password \n %@",member.password);

    NSString *msg = (member.username)?@"Login Success":@"Failed to login";

    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"NOTICE!!" message:msg delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alert show];
} 
```

**该类只是使用此方法发送数据：它是 NSURLConnection 的委托方法：**

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection{
    [_delegate finishConnectionWithData:_downloadData connection:self];   
} 
```

我尝试两次记录连接对象的内存地址，它们是不同的。（我按了两次按钮）。所以我想知道连接对象什么时候会被杀死。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T07:30:13.623

行为取决于`-[AsyncConnection callAsyncConnectionAtUrl:dictionary:method:delegate:]`.

如果它什么也没做，那么你是对的，你会期望在`AsyncConnection *conc`按下按钮的方法结束时释放它，因为没有其他人会保留它。

但是，`-callAsyncConnectionAtUrl:`可能会导致`self`保留一段时间。（它是否传递`self`给可能保留它的其他代码？或者它是否包含一个引用 的块，`self`然后将该块传递给其他代码？）

如果您想知道`AsyncConnection`在实践中何时解除分配，很容易找到：添加 to 的实现，`dealloc`在`AsyncConnection`其中设置断点，然后运行您的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T08:11:55.083

通过对象的名称，它可能会创建一个 NSURLConnection 并将自己设置为委托。从 NSURLConnection 的文档中：

> 特别注意事项
> 
> 在下载期间，连接保持对委托的强引用。当连接完成加载、失败或被取消时，它会释放该强引用。

所以有一个迷你（有意的）保留周期让您的 AsycConnection 对象保持活动状态。