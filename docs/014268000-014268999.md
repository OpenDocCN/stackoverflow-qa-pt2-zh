# StackOverflow 问答 14268000-14268999

# objective-c - Box2d - 鼠标关节设置到对象上的特定点

> ID：14268001
> 
> 赞同：1
> 
> 时间：2013-01-10T21:57:13.627
> 
> 标签：objective-c, cocos2d-iphone, box2d, game-physics

我有一个 Box2d iphone 应用程序（使用 cocos2d），其中有一个鼠标关节，每当您使用鼠标关节时，它都会在您单击的任何点向对象施加力。我想知道是否有一种方法可以始终将力施加到物体上的某个点，例如物体的中心。原因是当我的形状是一个盒子时，例如，当我使用鼠标关节拾取它时，它会旋转，以便我点击的任何地方最终都朝向顶部。我想总是从物体的中心拿起物体。我试过放大惯性阻尼，但并没有完全达到我想要的效果。这是我当前的代码：

```
b2Vec2 locationWorld = b2Vec2(newtouch.x/PTM_RATIO, newtouch.y/PTM_RATIO);
b2MouseJointDef md;
md.bodyA = physicsLayer.groundBody;
md.bodyB = touchedObject.body;
md.target = locationWorld;
md.maxForce = 2000;

b2World* w = [physicsLayer getWorld];
mouseJoint = (b2MouseJoint*)w->CreateJoint(&md); 
```

touchObject 是我正在移动的对象，它将它的主体存储为一个属性。该代码按原样工作正常，只是令人讨厌的旋转。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T07:46:24.743

您可以将目标点更改为框的质心：

```
md.target = touchedObject.body->GetWorldCenter(); 
```

这将使关节将盒子的中心拉到您手指所在的位置，而不是您触摸的点。如果它已经在旋转，它不会阻止它旋转，所以你可能仍然想在身体上使用一些角度阻尼来让它感觉更像是用户实际触摸它，而不是握住一个穿过中心的针它的:)

# eclipse - 颠覆性的 SVN 连接器不会出现在 eclipse juno 中

> ID：14268003
> 
> 赞同：43
> 
> 时间：2013-01-10T21:57:20.437
> 
> 标签：eclipse, svn, subversive

从 Eclipse 市场安装 svn 后重新启动 Eclipse Juno IDE 后，Subversive SVN 连接器不会出现。

有任何想法吗？

由于这个问题，我无法为 svn eclipse 插件分配 svn 连接器，因此它根本无法执行任何 svn 功能。

我正在运行 Windows 8 并尝试在管理员模式下运行 Eclipse，但仍然没有乐趣。我可以在任何地方手动下载连接器，如果可以，我在哪里安装它？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-03-15T05:22:52.397

可能会帮助某人...

Polarion[使用](http://www.polarion.com/products/svn/subversive/download.php)此更新站点[。](http://community.polarion.com/projects/subversive/download/eclipse/3.0/juno-site/)我刚安装

1.  颠覆性的 SVN 连接器
2.  SVNKit 1.7.5.v1 实现
3.  SVN 团队提供者连接器源

在此之后，我在 eclipse 首选项中发现 Team->SVN 选择了 svn kit 1.7.5 并且一切都开始工作了。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-07-16T15:41:22.073

只需删除工作区目录中的 .metadata 文件夹并重新启动

然后 windows -> 首选项 -> 团队 -> svn 点击。会出现

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-09-25T08:10:02.087

我无法添加新评论。只是面临同样的问题。更新@Saran[答案](https://stackoverflow.com/a/15425331/2711023)：

Eclipse **Mars**站点是

> [http://community.polarion.com/projects/subversive/download/eclipse/5.0/mars-site/](http://community.polarion.com/projects/subversive/download/eclipse/5.0/mars-site/)

Eclipse **Luna**站点是

> [http://community.polarion.com/projects/subversive/download/eclipse/4.0/luna-site/](http://community.polarion.com/projects/subversive/download/eclipse/4.0/luna-site/)

Eclipse **Kepler** 站点是

> [http://community.polarion.com/projects/subversive/download/eclipse/3.0/kepler-site/](http://community.polarion.com/projects/subversive/download/eclipse/3.0/kepler-site/)

您可以从那里手动安装 svn 连接器。

（记住：帮助菜单 -> 安装新软件 -> 粘贴站点 url）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-02-18T20:01:33.483

对我来说，切换到新的工作空间解决了这个问题。我跟着这个[链接](http://www.eclipse.org/forums/index.php/t/201570/#msg_num_6)。一旦我切换到新的工作区，自动连接器发现工具就会弹出。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-14T13:57:10.333

我可以推荐 CollabNet Eclipse 桌面而不是 Marketplace SVN 吗？

[http://desktop-eclipse.open.collab.net/](http://desktop-eclipse.open.collab.net/)

我发现它的安装比任何其他将 SVN 安装到 Eclipse 中的方法要少得多。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-05-06T15:40:54.943

切换工作区有效。

同样对于较新的 Subversive 版本，**连接器显示**在： **windows > preferences > team > svn（在此窗口内的选项卡中）**，**而不是**旧的**svn > connector menu**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-07-31T00:52:11.967

1.  关闭你的 Eclipse。
2.  在您的工作区目录中，打开（*.metadata/.plugins/org.eclipse.core.runtime/.settings/org.eclipse.team.svn.ui.prefs*）。
3.  将选项**firstStartup=false**更改为**firstStartup=true**。
4.  再次重新打开 Eclipse。

# jquery - CSS背景大小：覆盖滞后浏览器

> ID：14268005
> 
> 赞同：0
> 
> 时间：2013-01-10T21:57:29.873
> 
> 标签：jquery, html, css, background-image

我使用全宽和全高的 div 来显示封面背景图像。还有一个向左滑动并显示下一个全屏 div 的功能。问题是当我使用`background-size:cover`浏览器时，幻灯片过渡滞后。

我做了一个小提琴： http: [//jsfiddle.net/ULah3/1/](http://jsfiddle.net/ULah3/1/)我知道我使用了高质量的图片。

有任何想法吗？

编辑：您可以将其与`background-size:100% auto` [http://jsfiddle.net/ULah3/4/进行比较](http://jsfiddle.net/ULah3/4/)

# javascript - 使用 MySQL 为 Supersized 生成图像数组

> ID：14268007
> 
> 赞同：0
> 
> 时间：2013-01-10T21:57:35.033
> 
> 标签：javascript, mysql, database, background-image, supersized

我想在我的服务器上有一个所有背景图像的数据库列表，并随机选择 5 个来显示用户何时上传页面（这样我的服务器上的消耗更少，同时仍然显示我所有 40 个左右的背景照片想包括）。

我对 Javascript 非常陌生，但对 MySQL 有丰富的经验，所以如果你能用以下语法给出答案：

```
<javascript code>
//Enter MySQL here
<javascript code? 
```

我真的很感激。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:49:42.230

基本上，您正在寻找 AJAX 具有的功能。一个好的库是 jQuery (jquery.com)，它包括 ajax。这样，您可以拥有一个服务器端脚本（可能用 PHP 编写？），它在调用 ajax 函数时运行一些 MySQL 代码并发送带有一些图片的响应。

这是一个基本教程：[http ://www.w3schools.com/jquery/jquery_ajax_intro.asp](http://www.w3schools.com/jquery/jquery_ajax_intro.asp)

这里是 API：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# jquery - 使用 jQuery Datepicker 更改元素中的日期

> ID：14268010
> 
> 赞同：0
> 
> 时间：2013-01-10T21:57:58.030
> 
> 标签：jquery, jquery-ui, datepicker

我正在为我的一个项目使用 jQuery datepicker，它工作得很好，除了我无法更改元素 onSelect 内的日期。

我的代码如下：

```
$("#datepicker").datepicker({
   dateFormat: "d MM yy",
   onSelect: function(dateText) 
   { 
       var url = "/schedule_backend.php";
       var league = $('#compose').val();
       var data = "date="+ dateText +"&league="+ league;
       var myDate = new Date(dateText);
       var newFormat = $.format.date('dd M yy', myDate);                

       alert(newFormat);

       $("#kind").text(myDate);

   $('.schedule_block').load(url, data);                

   document.title = 'Sportannica - Schedule for '+ newFormat;           
  }
}); 
```

当我选择一个日期时，没有任何警报。关于如何正确格式化日期的任何想法？

谢谢，

槊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:09:28.573

看起来问题出在你的格式化程序上……你用的是什么？这是一个[jsfiddle](http://jsfiddle.net/KwXxc/)，显示正在调用该函数，并且日期是正确的，但是您的格式化程序正在取消它。

```
$("#datepicker").datepicker({
  dateFormat: "d MM yy",
  onSelect: function(dateText)
  {
    var myDate = new Date(dateText);
    //var newFormat = $.format.date('dd M yy', myDate);
    var newFormat = myDate.toString();
    alert(newFormat);
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T00:15:04.490

jQuery 默认不格式化日期。您将需要下载并使用插件。但是，手动完成并不难。

```
$("#datepicker").datepicker({
dateFormat: "d MM yy",
onSelect: function(dateText) 
{ 
   var url = "/schedule_backend.php";
   var league = $('#compose').val();
   var data = "date="+ dateText +"&league="+ league;
   var d = new Date(dateText);

   var weekday=new Array(7);
   weekday[0]="Sunday";
   weekday[1]="Monday";
   weekday[2]="Tuesday";
   weekday[3]="Wednesday";
   weekday[4]="Thursday";
   weekday[5]="Friday";
   weekday[6]="Saturday";

   var month=new Array();
   month[0]="January";
   month[1]="February";
   month[2]="March";
   month[3]="April";
   month[4]="May";
   month[5]="June";
   month[6]="July";
   month[7]="August";
   month[8]="September";
   month[9]="October";
   month[10]="November";
   month[11]="December";

   var newFormat = weekday[d.getDay()] + ", " + month[d.getMonth()] + " " + d.getDate();

   alert(newFormat);
}
}); 
```

[http://jsfiddle.net/gEdmj/2/embedded/result/](http://jsfiddle.net/gEdmj/2/embedded/result/)

# wordpress - wordpress 中哪些页面控制主页和其他内容页面 - 根主题

> ID：14268012
> 
> 赞同：0
> 
> 时间：2013-01-10T21:58:01.037
> 
> 标签：wordpress, wordpress-theming

我正在使用`roots theme`. 现在，我知道控制首页页面布局的主文件是`base.php`.

我的问题是哪个文件控制其他页面的布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T23:14:53.653

*   `index.php`=新闻源，沼泽，帖子。
*   `page.php`= 通用默认模板

# c# - 添加到 CookeContainer 时抛出 CookieException；饼干不长

> ID：14268014
> 
> 赞同：0
> 
> 时间：2013-01-10T21:58:08.953
> 
> 标签：c#, iis-7

将 Cookie 添加到 CookieContainer 时出现 CookieException，如下所示：

```
 ProxyRequest.CookieContainer = new CookieContainer();
        Uri serverUri = new Uri(ServerURL);
        foreach (string name in Context.Request.Cookies.AllKeys)
        {
            var requestCookie = Context.Request.Cookies[name];
            ProxyRequest.CookieContainer.Add(new Cookie(requestCookie.Name, requestCookie.Value, "/", serverUri.DnsSafeHost));
        } 
```

CookieException 的文档说，当 cookie 大于 CookieContainer 中的 MaxCookieSize 时会发生这种情况；但是，MaxCookieSize 是 4096，而这个 cookie 只有 96 个字节长。

4096是否限制了容器中所有cookie加在一起的限制？我得到这个例外还有其他原因吗？

有例外的消息是：`The 'Value'='84-B2,PX,TT|15-TL|30-T6,TL|23-GA,TL,TT|29-MR|25-CX,GA,TT|31-CX,GA,PX|9-B2,TF,TR|7-B2,CX,PX,TL,TT' part of the cookie is invalid.`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T00:15:21.353

您的域可能有其他 cookie，您每个站点不能存储超过 20 个 cookie。

通过使用带有子键的单个 cookie，您使用的站点分配的这 20 个 cookie 中的更少。

此外，单个 cookie 占用大约 50 个字符作为开销（过期信息等），加上您存储在其中的值的长度，所有这些都计入 4096 字节的限制。如果您存储五个子键而不是五个单独的 cookie，则可以节省单独 cookie 的开销，并且可以节省大约 200 个字节。

希望这可以帮助

拉胡尔·贾恩·拉胡尔马纳萨

# php - 并发使用持久性 PHP 套接字

> ID：14268018
> 
> 赞同：8
> 
> 时间：2013-01-10T21:58:21.527
> 
> 标签：php, apache, sockets, networking

我想使用 PHP 创建到通知服务服务器的持久套接字连接，我想知道在出现问题之前有多少 Apache/PHP 线程能够同时使用套接字。我已经对此进行了一些测试，但我似乎无法产生任何问题。

* * *

**编辑**

我正在使用这样的套接字：

```
$fh = pfsockopen('127.0.0.1', '1338');
fwrite($fh,$data); 
```

每个 PHP 线程将共享相同的持久套接字

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-11T09:18:57.143

限制`fsockopen`是系统内核设置中定义的打开文件描述符的最大数量。如果实现得好，它应该只使用一个套接字连接，意味着**每个 php 进程**`pfsockopen`只有一个文件描述符。

 **你必须对此进行测试。

例如

```
$fd = pfsockopen('173.194.44.24', 80);
echo $fd; 
```

这将输出文件描述符的 id：`Resource id #1`

在 Web 浏览器中打开它并多次重新加载页面 - 每次使用相同的套接字连接时，您应该看到相同的 id。

在默认的**Apache prefork MPM - mod_php**设置中，您可能会被随机发送到不同的分叉进程，这很可能会导致 n 个不同的 id 循环通过，而 n 取决于您的 Apache 配置

*   `MinSpareServers`(<= n pConnections)
*   `MaxSpareServers` (>= n pConnections)
*   `MaxRequestsPerChild`(tMax)

当您到达`MaxRequestsPerChild`该进程时，该进程将终止，并且此子节点上的持久连接也将终止。

在 Apache Worker MPM 或任何其他支持 fastcgi 的网络服务器（如 Lighttpd 或 Nginx 与 PHP-FPM 或 PHP-cgi + fastcgi 结合使用）中，我期待相同的行为，现在不是由网络服务器引起，而是由 php 进程引起。

与上述 apache 设置并行，相关设置为

**PHP-FPM**

*   `pm.min_spare_servers`(<= n pConnections)
*   `pm.max_spare_servers`(>= n pConnections)
*   `pm.max_requests`(tMax)

**快速CGI**

*   `PHP_FCGI_CHILDREN`(= n pConnections)
*   `PHP_FCGI_MAX_REQUESTS`(tMax)

在所有配置中，持久连接的最大生命周期是（以该进程处理的请求数量）`tMax`，并行持久连接的最大数量`n pConnections`

在命令行上模拟这个（php-cli）

```
# php -a
Interactive shell                            # in a webserver environment this is the equivalent of one child

php > $fd1 = fsockopen( 'google.de', 80 );   # open non-persistent connection
php > echo $fd1 . "\n";
Resource id #1
php > $fd2 = fsockopen( 'google.de', 80 );   # open another one
php > echo $fd2 . "\n";
Resource id #2                               # new fd, new connection

php > $pd1 = pfsockopen( 'google.de', 80 );  # persistent connection
php > echo $pd1 . "\n";
Resource id #3                               # first persistent fd
php > $pd2 = pfsockopen( 'google.de', 80 );
php > echo $pd2 . "\n";                        
Resource id #3                               # uses the same connection

php > exit                                   # simulating MaxRequestsPerChild threshold
# php -a
Interactive shell

php > $pd3 = pfsockopen( 'google.de', 80 );  # persistent connection, same host
php > echo $pd3 . "\n";
Resource id #1                               # resource id reused because all old connections are gone 
```

**编辑**

Acually 我忘了提到第二个限制。当然，服务器本身可以随时关闭连接。这在很大程度上取决于您使用的服务器设置和协议。

大多数服务器会在`n`几秒钟的静默和`x`几秒钟的总连接时间后关闭连接。

`pfsockopen`默默地处理这个，它只是在旧连接消失时打开一个新连接。

再次在 cli 上模拟：

```
# php -a
Interactive shell

php > $pd1 = pfsockopen( '127.0.0.1', 80 );
php > echo $pd1 . "\n";
Resource id #1
php > $pd1 = pfsockopen( '127.0.0.1', 80 );
php > echo $pd1 . "\n";
Resource id #1

(restarting my webserver on the another console /etc/init.d/nginx restart)

php > $pd1 = pfsockopen( '127.0.0.1', 80 );
php > echo $pd1 . "\n";
Resource id #2 
```**

# c++ - 在 Visual Studio 中包含 .pdb 文件和库管理器

> ID：14268019
> 
> 赞同：9
> 
> 时间：2013-01-10T21:58:26.807
> 
> 标签：c++, visual-studio, debugging, libraries

我有一个项目，其输出是一个库（.lib）。该项目依赖于第三方库（也是 .lib）。为了避免在我的库之上构建的项目不得不担心这种第三方依赖项，我使用图书管理员将其包含在我的库中（项目属性 > 图书管理员 > 常规 > 附加依赖项）。

但是，当我构建一个链接到我的库的单独的可执行项目时，我会收到一堆警告，如下所示：

> MyProject.lib(someThirdPartyObjectFile.obj)：警告 LNK4099：在“MyProject.lib(someThirdPartyObjectFile.obj)”或“\vc110.pdb”中未找到 PDB“vc110.pdb”；链接对象好像没有调试信息

这意味着（我假设）我将能够调试属于我的库的任何代码，但不能调试第三方库的任何代码。

如何指示 Visual Studio 也将第三方库的 PDB 的内容包含在我的中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T10:26:36.360

静态库可能已被移动，因此编译器无法从中找到符号。你有几个选择：

*   将调试格式更改为[`/Z7`](http://msdn.microsoft.com/en-us/library/958x11bc%28v=vs.100%29.aspx)，将调试信息嵌入代码中（而[`/Zi`](http://msdn.microsoft.com/en-us/library/958x11bc%28v=vs.100%29.aspx)将[`/ZI`](http://msdn.microsoft.com/en-us/library/958x11bc%28v=vs.100%29.aspx)其放在单独的文件中）。
*   更改 pdb 文件的输出配置（对于 VS2005 是`Settings > C++ > Output Files > Program Database File Name`，在 VS2010 中可能类似）。

[您可以在此处](https://groups.google.com/forum/?fromgroups=#!topic/microsoft.public.vc.language/TOT04atI4EE)和[此处](https://stackoverflow.com/questions/7575298/static-library-debug-symbols)找到更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-29T04:03:40.350

转到属性页 (Alt+F7) 链接器，所有选项，生成调试信息设置为无位置

# ember.js - 仅在插入视图并加载内容时执行处理程序

> ID：14268020
> 
> 赞同：4
> 
> 时间：2013-01-10T21:58:28.640
> 
> 标签：ember.js, ember-data

当满足两个条件时，我需要执行一个处理程序：

1.  与 ArrayController 关联的视图被插入到 DOM
2.  arrayController 内容已完全加载，通过存储

我试图在`controller.isLoaded`属性上添加一个观察者，`didInsertElement`但观察者处理程序永远不会被调用。

```
didInsertElement: function() {
    this.addObserver('controller.isLoaded', function() {
        console.info('inserted the element and store is loaded');
    });
}, 
```

当我在`didInsertElement`方法之外设置观察者时，观察者在视图插入 dom 之前调用处理程序太快了。

```
handler: function() {        
    var content, controller = this.get('controller');
    console.info(controller.get('content').get('isLoaded'));
}.observes('controller.isLoaded') 
```

另外，我不明白为什么上述场景中的处理程序被调用两次并且每次 controller.get('content') 显示一个空数组

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T09:08:12.030

可能的答案：您可能会发现[我的解决方案](https://stackoverflow.com/a/13857859/489116)非常适合。这个想法是添加一个handlebars helper，当视图模板的一个*子*`{{trigger}}`部分被渲染时触发一个事件。例如，如果您的模板中已经有一个块，例如，您可以这样做：*`{{#if content.isLoaded}}`*

 *```
{{#if content.isLoaded}}
    {{#each content}}
        ...
    {{/each}}
    {{trigger contentDidRender}}
{{else}}
    <p>Loading...</p>
{{/if}} 
```

当数据显示时，你应该总是得到一个事件。由于车把模板已经很好地完成了这一点，我只是利用了它。

至于为什么您尝试过的事情有问题，您可能在视图显示和内容加载之间存在竞争条件（可能首先发生的未定义） - 即您可能在`isLoaded`之后添加了观察者它已经加载，因此您没有观察到变化。并且请注意，（我认为）`observes`每次观察到的属性被*设置*时都会调用处理程序，而不是每次*更改*时......所以它可能被设置了两次，但两次都为假。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-29T11:38:26.327

我相信 addObserver 的语法要求第二个参数是你的处理程序将被执行的上下文。

```
didInsertElement: function() {
  this.addObserver('controller.isLoaded', this, function() {
    console.info('inserted the element and store is loaded');
  });
} 
```

注意第二个参数是'this'。查看[Observing Property Changes的文档](http://emberjs.com/api/classes/Ember.Observable.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T00:21:18.650

另一个提示而不是真正的解决方案，也许在 didInsertElement 中，观察者永远不会被调用，因为我认为它被错误地定义了。（我不知道它是否支持键链接）。我会做类似的事情：

```
didInsertElement: function() {
  this.get('controller.content').addObserver('isLoaded', function() {
    console.info('inserted the element and store is loaded');
  });
} 
```

如果可行，请不要忘记在 willDestroyElement 挂钩中删除此观察者*

# android - 如何调整弹出菜单的大小

> ID：14268023
> 
> 赞同：0
> 
> 时间：2013-01-10T21:58:32.257
> 
> 标签：android, user-interface, popupwindow

我创建了一个快速操作。但是在快速动作的设定高度出现问题。我的快速操作是一个包含视图的弹出菜单。你可以在下面看到它的图片：

![在此处输入图像描述](../Images/79301991dccbf1d353dc04634f0878e4.png)

我点击按钮。然后出现了快速行动。哦，快速行动比实际空间更大（可用空间）。然后我调整它的大小。没关系。
但请在新图像中查看：

![在此处输入图像描述](../Images/c71765234f3951d4e5c5025290c2bf1f.png)

类似previus的快速动作比真实空间大。然后我调整它的大小。但调整结果不是我想要的。它继续锚定。哪里有问题。我用以下命令调整它的大小
`mypopupwindow.setHeight(realSpace)`

# android - 有没有办法确定微调器是否展开？

> ID：14268024
> 
> 赞同：2
> 
> 时间：2013-01-10T21:58:36.507
> 
> 标签：android

有什么方法可以确定微调器是否处于展开状态？我试图在手机旋转时保持其展开或折叠状态。

谢谢。

# physics-engine - 子弹物理标题：没有这样的文件或目录

> ID：14268026
> 
> 赞同：0
> 
> 时间：2013-01-10T21:58:48.753
> 
> 标签：physics-engine, bulletphysics

当我尝试在我的项目中使用头文件时（我之前创建了 .a 文件和链接），我收到下一个错误：

```
fatal error: <bullet header.h> : No such file or directory 
```

我按照本教程创建库 .a ：

[http://vgamec.blogspot.com.es/2011/09/instalar-bullet-physics-para-codeblocks.html](http://vgamec.blogspot.com.es/2011/09/instalar-bullet-physics-para-codeblocks.html)

有谁知道为什么我不能使用图书馆？

PD 我使用 Codeblocks 12.11 和编译器 GCC 版本 4.7.1，32 位。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:35:57.367

BulletPhysics 没有这样的头文件。`bullet header.h`

错误出现在包含该文件的代码中。

显示代码`#include`

# android - 从 Android 调用 REST (POST) 网络服务

> ID：14268029
> 
> 赞同：3
> 
> 时间：2013-01-10T21:58:52.987
> 
> 标签：android, web-services, rest

我正在尝试创建一个 Web 服务并从 Android 中使用它。它正在使用 GET 方法，但我无法调用 POST 方法。

```
@Path("/dictionary")
public class DictionaryWebService {

private final static String ID = "id";
private final static String WORD = "palabra";
private final static String DESCRIPTION = "description";

.....  
@POST
@Consumes(MediaType.APPLICATION_FORM_URLENCODED)
@Produces(MediaType.APPLICATION_JSON)
public Word postNewWord(MultivaluedMap<String, String> newWord) {

    Word dict;

    String id = newWord.getFirst(ID);
    String word = newWord.getFirst(WORD);
    String description = newWord.getFirst(DESCRIPTION);

    dict = new Word(id, word, description);
    dictionary.putNewWord(dict);

    System.out.println("New Word info: " + dict.toString());

    return dict;

    }
} 
```

我的安卓代码是：

```
 @Override
        public void onClick(View arg0) {
            System.out.println("onClick!!!");
            HttpClient httpClient = new DefaultHttpClient();
            HttpPost post = new HttpPost("http://10.0.2.2:8080/DictionaryWebService/rest/dictionary/");
            post.setHeader("content-type", "application/json");

            //Construimos el objeto cliente en formato JSON
            JSONObject dato = new JSONObject();

            try {

                dato.put("id", txtId.getText().toString()); 
                dato.put("palabra", txtWord.getText().toString());
                dato.put("description", txtDescription.getText().toString());

                StringEntity entity = new StringEntity(dato.toString());
                post.setEntity(entity);

                HttpResponse resp = httpClient.execute(post);
                String respStr = EntityUtils.toString(resp.getEntity());

                System.out.println("OKAY!");

            .....

        }
    }); 
```

我不知道，但我无法执行网络服务，，，它没有被调用。怎么了？？有人可以帮助我吗？onclick 方法完成，没有任何错误。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-31T07:33:53.410

我使用了你的代码，它工作正常吗？我所做的唯一更改是将帖子标题设置为；

```
post.setHeader("content-type", "application/json; charset=UTF-8"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:49:11.360

我这样做与您有所不同，但是从客户端的角度来看，我看到的 SO 中的一个示例与您的示例相似（[带有参数的 Http post 不起作用](https://stackoverflow.com/a/5958314/137670)）使用了额外的 post.setHeader 调用：

```
post.setHeader("Accept", "application/json"); 
```

这是您已经进行的 post.setHeader 调用的补充。

链接中的示例也是一个很好的简短测试，用于检查其他一切是否正常（完整性检查）。

希望这可以帮助。

# c# - 如何为不同版本的应用程序交换资源？

> ID：14268030
> 
> 赞同：1
> 
> 时间：2013-01-10T21:58:58.767
> 
> 标签：c#, .net, wpf, visual-studio

我开发了一个应用程序，它至少有 2 个，如果不是 3-4 个不同的版本（不要问）。这些应用程序基本上是相同的，只是产品名称、窗口标题、应用程序图标以及字符串或图像资源方面的一些其他细微差别不同。

我的主要目标是避免为每个可执行文件创建多个项目。我希望能够拥有一个主要的应用程序项目并让它只加载这些资源（名称、图标等）并且不知道它是哪个版本。这样，我可以简单地配置我的安装项目以使用该应用程序的版本部署适当的资源。理想情况下，安装后最终用户不会看到它。

我尝试过什么：我尝试过创建不同的 .resx 文件并根据构建配置交换它们，或者我还尝试过添加环境变量和变量上的#if。**但是，我真的不想要多个构建配置。**我希望它只依赖于部署。

是否可以在不同的项目或同一个项目中创建 resx 文件并将它们从构建中排除，并将它们生成到类似于本地化的附属 .DLL 程序集中，然后加载与应用程序一起部署的任何一个？

如果我应该考虑运行我自己的 RESGEN 和 AL 任务，或者我应该只创建一个 DLL 项目（但也许那时我必须为一个资源文件创建多个 DLL 项目），我感到很困惑。此外，我能找到的任何关于使用 .RESX 文件的文章都是用于本地化的。它依赖于设置 CurrentCulture 来解析要使用的特定资源。我的场景与文化无关......**我只想为应用程序的不同部署加载不同的资源。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:58:03.367

在不知道需要多深的情况下，您可以将资源打包到单独的 .dll 文件中并以这种方式进行区分。例如，将各种不同的版本构建到单独的 DLL 中，并让安装程序调整名称以匹配您的应用程序所期望的名称，或者使用 XML 配置文件来指定要加载的内容并以这种方式加载它。

[Assembly.Load()](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.load%28v=vs.71%29.aspx)将允许您加载替代程序集。

```
Assembly _assembly;
_assembly = Assembly.GetExecutingAssembly();

Stream _imageStream;
_imageStream = 
    _assembly.GetManifestResourceStream(
    "ThumbnailPictureViewer.resources.Image1.bmp");
Bitmap theDefaultImage = new Bitmap(_imageStream); 
```

见： http: [//www.attilan.com/2006/08/accessing-embedded-resources-using.html](http://www.attilan.com/2006/08/accessing-embedded-resources-using.html)

# javascript - 从应用视图引用主干视图

> ID：14268031
> 
> 赞同：0
> 
> 时间：2013-01-10T21:59:02.470
> 
> 标签：javascript, backbone.js, backbone-views

嘿，我对 Backbone 还是很陌生，尽管我花了几天时间来尝试熟悉这个框架，而且似乎每次我开始感到舒服时，我都会遇到一个新问题。

我想知道如何引用从我的主 appview 中呈现的视图。我知道这是一个非常简单的问题，但我似乎无法弄清楚。

所以例如我有一个简单的观点

```
 var SubView = Backbone.View.extend({
    //something here including render function
}); 
```

然后我从主应用程序视图中呈现该视图

```
var myApp = Backbone.View.extend({
    render: function{
        var mysubView = new SubView();
        mysubView.render();
    },
    editSomething: function{
        mysubView.remove();
    }
}); 
```

当我尝试从主应用程序视图中的函数 (editSomething:) 引用该视图时，出现引用错误。

我想要实现的是我有两个包含表单的视图。我想在调用编辑函数和调用添加函数时在两种表单之间切换。但我似乎无法访问已经呈现的视图。

我不想在删除现有视图之前初始化和渲染新视图，因为据我了解，我将开始让一堆视图漂浮在内存中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:02:48.843

使用它来引用它`this`：

```
var myApp = Backbone.View.extend({
    render: function{
        this.subView = new SubView();
        this.subView.render();
    },
    editSomething: function{
        this.subView.remove();
    }
}); 
```

# events - 如何在 qooxdoo 中重新触发数据事件？

> ID：14268037
> 
> 赞同：0
> 
> 时间：2013-01-10T21:59:25.653
> 
> 标签：events, qooxdoo

从 qooxdoo 触发一个事件，我该怎么办？

ClassA 分派 MyEvent 类型的事件 A，ClassB 侦听该事件。然后 classB 使用相同的数据调度 MyEvent 类型的相同事件 B。在 classB 中，我做了这个：

```
 var target = evt.getTarget();
        this.fireEvent("A", MyEvent, [target]) 
```

但我在重复代码，有可能更自动化吗？

多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T14:15:00.010

我想您可以将此逻辑包含在 qooxdoo 全局变量中，然后将该变量作为函数调用：

```
var standardEvent : function() {
    var target = evt.getTarget();
    this.fireEvent("A", MyEvent, [target])
} 
```

并在您的子类中调用它：

```
qx.core.Init.getApplication().standardEvent(); 
```

不过，您必须弄清楚范围。

# c# - SQL Like 语句：无法将 char 值转换为货币。char 值的语法不正确

> ID：14268044
> 
> 赞同：1
> 
> 时间：2013-01-10T21:59:55.263
> 
> 标签：c#, sql-server-2008, tsql, exception-handling, ado.net

我有一个文本框，允许用户在我们的网站上搜索内容，这是传入的要处理的 c# 代码：

```
string search = Server.HTMLDecode(userEnteredSearchText);
SqlCommand comm = new SqlCommand("SELECT data FROM database WHERE (Title LIKE @search) " 
comm.Parameters.Add(new SqlParameter("search", String.Format("%{0}%", search))); 
```

我以前从未见过这个错误：

> 无法将 char 值转换为货币...

但如果用户输入空格，它就会关闭。我通过它进行了调试，似乎是什么原因导致它是如果搜索 =“”，那么参数将是 %%？似乎有时如果用户输入足够的空格（即搜索是“”），那么页面不会崩溃？但我不确定问题是什么。

更新：不确定到底是什么问题，但我通过对文本框使用 RequiredFieldValidator 来修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:17:30.173

@Kevin，为什么不检查用户是否输入了 "" ？然后，如果用户正在输入“”，则在将其发送到数据库之前给他们一个错误以修复他们的输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:05:44.173

您需要将`money`值转换为`string`. 试试这样；

```
SqlCommand comm = new SqlCommand("SELECT CAST(Result AS VARCHAR(MAX)) WHERE (Keyword LIKE @search) " 
```

# xpages - 你能计算出使用哪个自定义控件吗？

> ID：14268046
> 
> 赞同：0
> 
> 时间：2013-01-10T22:00:06.397
> 
> 标签：xpages, lotus-notes

想想“计算子表单”，但在 Xpages 中。

在我的一个自定义控件上，根据某个值，我想呈现一个自定义控件，该控件使用组合框呈现下拉列表，或者呈现带有预先输入的输入框。

这是在呈现视图的自定义控件上，所有视图配置选择由文档而不是设计处理，因此几个不同的视图使用相同的自定义控件。

例如：我有一个按状态视图，使用具有状态作为第一列的自定义控件，我们使用组合框允许用户选择要过滤的状态值。另一个视图按申请编号排序，我想使用预先输入而不是组合框。

我的偏好是对两者使用相同的动态视图自定义控件，并有一个公式来确定要使用两者中的哪一个（comboBox 或 inputText）。如何计算要加载的自定义控件？

（动态视图控制的功劳归于 Teamworks Solutions 的 Scott Good 人员。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T23:06:18.250

在其生命周期中，XPage 存在于两个地方。首先，XPage 相关组件的表示存储在服务器上。然后页面经历一个生命周期，从文档中检索属性，检查应该呈现哪些组件，检索任何重复控件（如视图面板等）的数据，并将相关的 HTML 传递给浏览器。浏览器是它存在的第二个地方。

所以你不能这样计算自定义控件。您所能做的就是设置加载的属性，并且加载需要基于非动态计算，例如 viewScope 变量、当前 XPage 名称、存储在 XPage 上的视图名称等。您将难以做的是根据该行条目上的数据使用不同的自定义控件。

另一个选项是扩展库中的动态内容控件或切换控件。两者都类似于使用加载的属性，因为您将两个自定义控件放在页面上并选择要显示的控件。

根据您的描述，加载的属性应该涵盖您需要的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T03:57:25.477

前段时间我在 StackOverflow 上看到了[这个问题，](https://stackoverflow.com/questions/12171182/include-custom-control-dynamically-on-xpage)其中作者使用包含页面控件 ( ) 来包含使用基于公式的属性的`xp:include`自定义控件。`pageName`

```
<xp:include>
     <xp:this.pageName><![CDATA[${javascript:sessionScope.ccPageName + ".xsp";}]]> </xp:this.pageName>
</xp:include> 
```

与 Paul Withers 在他的回答中描述的技术类似，属性 of`pageName`也是在页面加载时计算的。

# jquery - 如何检测单击锚点并添加额外像素并保留 URL

> ID：14268047
> 
> 赞同：1
> 
> 时间：2013-01-10T22:00:08.663
> 
> 标签：jquery

因为我有一个固定位置的标题，当点击锚链接时，一些内容被标题遮住了，所以我想修改位置，使请求的内容完全可见。我目前正在使用以下 jQuery 成功完成此操作：

```
$(document).ready(function () {
    $("a[href^='#']").click(function () {
        var id = $(this).attr("href");
        var newPosition = $(id).offset();
        if (newPosition != undefined) {
            window.scrollTo(newPosition.left, newPosition.top - 50);
        }
        else {
            window.scrollTo(0, 0);
        }
        return false;
    });
}); 
```

然而，这种方法的问题是 URL 永远不会更改以添加 #anchor 部分，因此用户无法像我希望的那样为页面添加书签。

有没有办法做到这一点，网址会改变？我需要广泛的浏览器兼容性，所以我认为我不能更改 URL。我在想我也许可以监视窗口滚动事件并查看 URL 哈希是否已更改，如果是，则进行 50 像素调整。但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:04:44.520

这实际上是一个复杂的问题。有一个很棒的插件专门用来解决这个问题，叫做[BBQ](http://benalman.com/projects/jquery-bbq-plugin/)。一个问题（您可能还没有意识到这将是一个问题）是使用后退按钮。用户希望后退按钮将他们“带到”他们点击链接之前的最后一个位置。如果您不支持，您将有非常伤心的用户。BBQ 能够解决这些问题并使后退按钮正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T00:31:54.723

为了可能回答我自己的问题，我尝试了一个脚本，该脚本在使用哈希打开页面时执行所需的操作，当您单击哈希时，当您在滚动后单击相同的哈希时，并且还处理后退按钮. 这似乎适用于流行的浏览器。

```
 $(document).ready(function () {
            var scrollOnReady = false;
            var lastHash = window.location.hash ? window.location.hash : "";
            if (lastHash != "") {
                scrollOnReady = true;
                setTimeout(function () {
                    var newPosition = $(lastHash).offset();
                    if (newPosition != undefined) {
                        if ($(window).scrollTop() == newPosition.top) {
                            window.scrollTo(newPosition.left, newPosition.top - 50);
                        }
                    }
                    else {
                        window.scrollTo(0, 0);
                    }
                }, 50);
            }

            $(window).scroll(function () {
                if (scrollOnReady) {
                    scrollOnReady = false;
                }
                else {
                    if ((window.location.hash ? window.location.hash : "") !== lastHash) {
                        lastHash = window.location.hash ? window.location.hash : "";
                        setTimeout(function () {
                            $(window).scrollTop($(window).scrollTop() - 50);
                        }, 50);
                    }
                }
            });

            $("a[href^='#']").click(function () {
                var hash = $(this).attr("href");
                if (hash === lastHash) {
                    lastHash = "";
                }
            });
        }); 
```

# c# - 如何返回包含枚举值的字符串 []

> ID：14268048
> 
> 赞同：0
> 
> 时间：2013-01-10T22:00:10.037
> 
> 标签：c#, arrays, string, enums, namespaces

我想创建一个动态 GUI，将 Enum 的所有选项列为按钮。因此，我需要一种将 Enum 类型传递给方法并取回包含 enum 类型可以是的所有选项的字符串数组的方法。

例如，给定文件 Foo.cs 中的 Enum 声明：

```
public Enum Fruits {
    Apple,
    Orange,
    Peach
};

public class Foo { ... } 
```

我想要这个返回：

```
{ "Apple", "Orange", "Peach" } 
```

我经历了几种代码排列。现在我有以下但我收到错误“*找不到类型或命名空间名称'enumeratedType'* ”

```
public static string[] EnumToStringArray (System.Type enumeratedType) {
    int         enumSize    =   sizeof(enumeratedType);
    string[]    enumStrings =   new string[enumSize];

    for (int i = 0 ; i < enumSize ; i++) {
        enumStrings[i]  =   enumeratedType.getValues()[i].toString();
    }

    return enumStrings;
} 
```

我正在尝试做的事情可能吗？我已经根据这个问题中的信息尝试了几次完整的重写[Using sentinal values in C# enum (size of enum at compile time)?](https://stackoverflow.com/questions/9435209/using-sentinal-values-in-c-sharp-enum-size-of-enum-at-compile-time/9435541#9435541) 但我无法让它工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T22:02:15.747

```
string[] names = Enum.GetNames(typeof(Fruits)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:09:52.993

你可以使用类似的东西

```
public static IEnumerable<string> EnumToStringArray(Type enumeratedType) {
    if (!enumeratedType.IsEnum)
        throw new ArgumentException("Must be an Enum", "enumeratedType");

    return Enum.GetNames(enumeratedType);
} 
```

但即使这样也是不必要的，因为如果给定的类型是 no ，`Enum.GetNames(...)`它本身就会抛出一个。（感谢@Alexander Balte）。因此，无论如何您都不需要自己的功能。正如其他人已经提到的那样，只需完成这项工作。`ArgumentException``Enum``Enum.GetNames(typeof(Fruits))`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T22:39:04.330

您似乎误解了[`sizeof`关键字](http://msdn.microsoft.com/en-us/library/eahchzkf.aspx)的含义。它返回值类型在与非托管内存中的其他值对齐时“占用”的字节数（每个字节等于 8 位）。

`sizeof`如果您不使用`unsafe`上下文（如指针），则没有用。

对于您的`Fruits`类型，`sizeof(Fruits)`返回，`4`因为基础迭代器类型是 an `Int32`（因为这是您未另行指定时的默认值）。An`Int32`需要 32 位，因此`sizeof`返回`4`. 如果您有 1、2、10 或 4294967296 种不同的水果，则无关紧要。

请注意，一个枚举可以有多个名称指向同一个值，例如：

```
public enum Fruits {
  Apple,
  Orange,
  Peach,
  ChineseApple = Orange,
} 
```

在此示例中，枚举包含四个命名常量，但其中两个“映射到”相同的值。在这种情况下，`Enum.GetNames(typeof(Fruits))`, 会给你所有四个名字。

但是`Enum.GetValues(typeof(Fruit))`会给你一个 的四个*值*的列表`Fruit`，其中两个是相同的。您无法提前知道这两个相同的值是否会显示为`Orange`or `ChineseApple`，因此如果您的枚举有这样的重复项，请不要使用此方法。

# c++ - 如何在标准构造函数之外设置 boost::uniform_int_distribution 的参数？

> ID：14268049
> 
> 赞同：0
> 
> 时间：2013-01-10T22:00:17.380
> 
> 标签：c++, boost, random, constructor

我在 Boost 1.52 中使用 uniform_int_distribution 使用基本样板代码生成随机数：

```
#include <boost/random/mersenne_twister.hpp>
#include <boost/random/uniform_int_distribution.hpp>

boost::random::mt19937 gen;

int roll_die()
{
    boost::random::uniform_int_distribution<> dist(1, 6);
    return dist(gen);
}

int main()
{
    for (int i = 0; i < 10; i++) std::cout << roll_die() << std::endl;     
} 
```

我在一个更大的项目中实现了其中的一部分，并且效果很好。这是我的问题。

在上面的函数中，dist 对象似乎是函数的本地对象。如果您多次调用 roll_die()，似乎将 dist() 设置为函数的本地会引入大量开销。

我认为最好设置一次该对象的最小和最大参数，然后在更大的对象或其他东西中只有一个 dist 实例。如何做到这一点？我试图理解类模板的“公共成员函数”部分：http: [//www.boost.org/doc/libs/1_47_0/doc/html/boost/random/uniform_int_distribution.html#id744736-bb](http://www.boost.org/doc/libs/1_47_0/doc/html/boost/random/uniform_int_distribution.html#id744736-bb)但它是在我头上。在该文档中，我看到：

```
void param(const param_type & param); //Sets the parameters of the distribution. 
```

您如何实际使用它？.param() 本身是要调用的函数，还是另一个函数的替身？我找不到另一个可以满足我要求的提升示例。提前感谢您的帮助和建议！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T22:16:43.853

> 似乎......会引入很多开销。

你可能会认为它确实如此，但你真的知道吗？如果没有实际运行分析器或以其他方式对代码进行基准测试，您不应该做出任何假设。如果您查看源代码，您会看到`uniform_int_distribution`的构造函数仅分配最小值和最大值 - 这应该是非常微不足道的开销。特别是如果您考虑到实际的随机数生成将是比两次分配更复杂的操作。所以我建议你保持代码不变，如果你的程序太慢，你总是可以分析然后优化。

编辑：引用 Djikstra：“过早的优化是万恶之源”。很多时候，程序员编写的代码比需要的更复杂，仅仅是因为他们认为这样会更快。不要这样做——只有在出现速度问题时才开始优化。

无论如何，回答您的问题：`param()`是`uniform_int_distribution`. 它需要一个类型的对象`uniform_int_distribution::param_type`。你可以像这样使用它：

```
using namespace boost::random;

// Create an uniform_int_distribution object
uniform_int_distribution<> dist(1, 6);

// Create a params object
uniform_int_distribution::param_type newParams(10, 500);

// The following will reconfigure dist to have 10 and 500 as 
// min and max value
dist.param(newParams); 
```

这样，您可以根据需要随时重新配置单个分发对象。但是“开销”可能与构建新的分发对象相同。

另一种可以确保对象只创建一次的方法：

```
int roll_die()
{
    static boost::random::uniform_int_distribution<> dist(1, 6);
    return dist(gen);
} 
```

将函数内部的变量声明为 static 与全局变量具有类似的效果，但它仅在函数的范围内可见。

# python - 计算 250k 列表的成对相似度的最有效方法

> ID：14268053
> 
> 赞同：10
> 
> 时间：2013-01-10T22:00:23.357
> 
> 标签：python, matrix

我有 250,000 个列表，每个列表平均包含 100 个字符串，存储在 10 个字典中。我需要计算所有列表的成对相似度（相似度度量在这里不相关；但简而言之，它涉及取两个列表的交集并通过某个常数对结果进行归一化）。

我为成对比较提出的代码非常简单。我只是使用 itertools.product 将每个列表与其他列表进行比较。问题在于以一种省时的方式对 250,000 个列表执行这些计算。对于处理过类似问题的任何人：根据以下标准，哪种常用选项（scipy、PyTables）最适合此问题：

*   支持python数据类型
*   巧妙地存储一个非常稀疏的矩阵（大约 80% 的值将是 0）
*   高效（可以在 10 小时内完成计算）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T01:55:54.287

您只是想要最有效的方法来确定数据中任意两点之间的距离吗？

或者您是否真的需要这个*mxm*距离矩阵来存储数据中所有行的所有成对相似度值？

通常，使用为快速检索而优化的数据结构将数据保存在某个度量空间中比预先计算成对相似度值并仅查找它们要高效得多。不用说，距离矩阵选项的规模非常大——n 个数据点需要一个 nxn 距离矩阵来存储成对的相似度分数。

*kd-tree*是小维度数据的首选技术（这里的“小”意味着特征数量少于大约 20） ；对于更高维度的数据，通常首选*Voronoi 细分。*

最近，***球树***已被用作两者的优越替代品——它具有*kd-tree*的性能，但在高维上没有退化。

***[scikit-learn](http://scikit-learn.org/stable/install.html#installing-from-source)***具有出色的实现，其中包括单元测试。它有据可查，目前正在积极开发中。

*scikit-learn*建立在*NumPy*和*SciPy 之上*，因此两者都是依赖项。站点上提供了*scikit-learn*的各种[安装选项。](http://scikit-learn.org/stable/install.html#installing-from-source)

 *Ball Trees 最常见的用例是在*k-Nearest Neighbors*中；但它本身会很好地工作，例如，在像 OP 中描述的情况下。

您可以像这样使用*scikit-learn Ball Tree*实现：

```
>>> # create some fake data--a 2D NumPy array having 10,000 rows and 10 columns
>>> D = NP.random.randn(10000 * 10).reshape(10000, 10)

>>> # import the BallTree class (here bound to a local variable of same name)
>>> from sklearn.neighbors import BallTree as BallTree

>>> # call the constructor, passing in the data array and a 'leaf size'
>>> # the ball tree is instantiated and populated in the single step below:

>>> BT = BallTree(D, leaf_size=5, p=2)

>>> # 'leaf size' specifies the data (number of points) at which 
>>> # point brute force search is triggered
>>> # 'p' specifies the distance metric, p=2 (the default) for Euclidean;
>>> # setting p equal to 1, sets Manhattan (aka 'taxi cab' or 'checkerboard' dist)

>>> type(BT)
    <type 'sklearn.neighbors.ball_tree.BallTree'> 
```

实例化和填充球树***非常快*** （使用 Corey Goldberg 的[计时器类计时](https://gist.github.com/2942781)）：

```
>>> with Timer() as t:
        BT = BallTree(D, leaf_size=5)

>>> "ball tree instantiated & populated in {0:2f} milliseconds".format(t.elapsed)
        'ball tree instantiated & populated in 13.90 milliseconds' 
```

查询球树也***很快***：

示例查询：*提供最接近数据点行索引 500 的三个数据点*；*并且对于他们每个人，返回他们的索引和他们在 D[500,:] 处与这个参考点的距离*

```
>>> # ball tree has an instance method, 'query' which returns pair-wise distance
>>> # and an index; one distance and index is returned per 'pair' of data points

>>> dx, idx = BT.query(D[500,:], k=3)

>>> dx    # distance
    array([[ 0\.   ,  1.206,  1.58 ]])

>>> idx    # index
    array([[500, 556, 373]], dtype=int32)

>>> with Timer() as t:
    dx, idx = BT.query(D[500,:], k=3)

>>> "query results returned in {0:2f} milliseconds".format(t.elapsed)
        'query results returned in 15.85 milliseconds' 
```

scikit-learn Ball Tree 实现中的默认距离度量是***Minkowski***，它只是欧几里得和曼哈顿的泛化（即，在 Minkowski 表达式中，有一个参数 p，当设置为 2 时，它会塌陷为欧几里得，而曼哈顿，对于 p = 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:51:57.090

如果您定义适当的距离（相似性）函数，那么[scipy.spatial.distance 中](http://docs.scipy.org/doc/scipy/reference/spatial.distance.html)的一些函数可能会有所帮助*

# parsing - 如何处理 powershell 中参数的多个选项？

> ID：14268054
> 
> 赞同：1
> 
> 时间：2013-01-10T22:00:24.730
> 
> 标签：parsing, powershell, parameters, arguments, powershell-2.0

我希望能够有多种形式的相同参数，如下所示：

```
param(
  [string]$p or $path = "C:\",
  [string]$f or $filter = "*.txt",
  [switch]$o or $overwrite
) 
```

但我不知道该怎么做。大多数时候，您只能选择一个（例如，只有 $p 或只有 $path）。是否可以为同一个变量/参数使用多个名称？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:28:36.170

PowerShell 部分参数名称匹配可能是您所寻找的。

```
# test.ps1
param($path)
write-host $path 
```

调用 .\test.ps1 中的任何一个`.\test.ps1 -path "c:\windows"`或`.\test.ps1 -p "c:\windows"`都将匹配并填充 $path 参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T22:33:51.703

像这样：

```
param(
  [Alias('p')]
  [string]$path = "C:\",
  [Alias('f')]
  [string]$filter = "*.txt",
  [Alias('o')]
  [switch]$overwrite
) 
```

请注意，您也可以有多个别名：`[Alias('p','thepath')]`

# python - 如何在控制台中从龙卷风中的处理程序登录？

> ID：14268056
> 
> 赞同：1
> 
> 时间：2013-01-10T22:00:33.450
> 
> 标签：python, tornado

如何在控制台中从龙卷风中的处理程序登录？我从控制台启动应用程序并将其放在处理程序之上`logging.getLogger().setLevel(logging.DEBUG)`

和内部处理程序

```
logging.info('RECEIVED HTTP GET REQUEST') 
```

但是处理程序没有在控制台中写入任何内容。我尝试过使用 print 但它在处理程序中不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T23:32:42.840

您可以通过导入**tornado.options来尝试**

[https://github.com/facebook/tornado/blob/branch2.4/tornado/options.py](https://github.com/facebook/tornado/blob/branch2.4/tornado/options.py)

第 465 - 468 行：

```
define("logging", default="info",
       help=("Set the Python log level. If 'none', tornado won't touch the "
             "logging configuration."),
       metavar="debug|info|warning|error|none") 
```

此代码块将“日志记录”注册为 tornado 命令行参数解析器中的命令行参数，并将默认值设置为 info。

在开发版本中，他们将其移至“tornado.log”模块中的“define_logging_options”*功能。

# jquery - PrimeFaces p:inputText 和 p:inputTextarea 在 ap:panelGrid 表单中呈现太宽

> ID：14268059
> 
> 赞同：4
> 
> 时间：2013-01-10T22:00:43.670
> 
> 标签：jquery, css, jsf, primefaces

我注意到，在我们的表单上，输入字段`p:inputText`与`p:inputTextarea`其他小部件（例如`p:select*`或`p:commandButton`. 我们的表格由 ap:panelGrid 包围。

这是一个测试页面：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

    <h:head>
        <title>
            D E B U G
        </title>
    </h:head>

    <h:body>

        <h:form>

            <p:panelGrid columns="2">

                <p:outputLabel value="ID:" />
                <p:inputText style="width: 100%;" />

                <h:outputText />
                <p:commandButton value="all = width: 100%" style="width: 100%;" />

                <p:outputLabel value="Status:" />
                <p:selectOneMenu style="width: 100%;">
                    <f:selectItem itemLabel="Status A" itemValue="1" />
                    <f:selectItem itemLabel="Status B" itemValue="2" />
                    <f:selectItem itemLabel="Status C" itemValue="3" />
                </p:selectOneMenu>

                <p:outputLabel value="Remarks:" />
                <p:inputTextarea rows="6" style="width: 100%;" />

            </p:panelGrid>

            <br />

            <p:panelGrid columns="2">

                <p:outputLabel value="ID:" />
                <p:inputText style="width: 300px;" />

                <h:outputText />
                <p:commandButton value="all = width: 300px" style="width: 300px;" />

                <p:outputLabel value="Status:" />
                <p:selectOneMenu style="width: 300px;">
                    <f:selectItem itemLabel="Status A" itemValue="1" />
                    <f:selectItem itemLabel="Status B" itemValue="2" />
                    <f:selectItem itemLabel="Status C" itemValue="3" />
                </p:selectOneMenu>

                <p:outputLabel value="Remarks:" />
                <p:inputTextarea rows="6" style="width: 300px;" />

            </p:panelGrid>
        </h:form>        

    </h:body>

</html> 
```

在 Firefox 上看起来像这样：

![在此处输入图像描述](../Images/778d0fbb30f5f5a0873d883cc1400fca.png)

在 IE 9（IE 8 模式）上看起来像这样：

![在此处输入图像描述](../Images/4b60f32fcef24986e43d2eeecfcbe66f.png)

对于百分比宽度`<p:inputText style="width: 100%;" />` ，组件被渲染得稍微太宽。这似乎同样适用于绝对宽度`<p:inputText style="width: 300px;" />`。

我发现 PrimeFaces CSS 附带

```
.ui-inputfield {
    font-weight: normal;
    margin: 0;
    outline: medium none;
    padding: 4px;
} 
```

，其中删除填充会导致正确的宽度。但是，填充用于输入的文本插入。覆盖 CSS 选择器并没有真正起作用。

**问**：

你如何修复`p:inputText`and `p:inputText`？你如何最好地调整这一点？使用自定义 PrimeFaces 渲染器？

附录：

我查看了源代码，但找不到可以更改的地方（InputRenderer 类？）。任何关于在哪里看的提示都表示赞赏（在评论中！）。

请注意，`p:calendar`组件似乎显示了正确的大小（但仅适用于百分比宽度）。PrimeFaces 似乎在这里有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T10:06:44.670

这是正常行为，您已经发现了原因。由于您选择的主题中有填充。

这样你就可以：

*   正确调整组件的宽度。inputText 使用 296px 或 selectOneMenu 使用 304px 或任何适合您需要的东西
*   覆盖给定部分的 css 样式。只需了解如何在给定上下文中覆盖给定类的样式。
*   最佳解决方案，因为您有特定需求：根据当前主题**编写自己的**主题（PrimeFaces 文档第 7 节）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-26T07:03:54.023

您可以在primefaces 样式表**之后**覆盖填充和其他样式。通常这意味着直接在 <h:body> 之后内联/包含样式表：

```
.ui-inputfield {
    padding: 0;
} 
```

# android - XML解析不在随机节点上存储整个值

> ID：14268061
> 
> 赞同：0
> 
> 时间：2013-01-10T22:01:06.780
> 
> 标签：android

我有一个 android 应用程序，它通过服务从 Web 服务器下载 xml 文件，解析数据并通过内容提供程序更新数据库。这一切都很好。

我的问题是，在 xml 文件的某些节点上，它不会处理它包含的整个字符串。我有一个结构类似于...的xml

```
<books>
    <book>
        <author>Test Author</author>
        <title>Example title</title>
        <datestamp>201212251300</datestamp>
    </book>
    about 30 more book nodes...
</books> 
```

我使用日期戳值（这是一个 YYYYMMDDHHMM 值）来订购书籍，但有时它只会在 1 或 2 本书上保存 4 或 5 个字符的日期戳，然后会弄乱列上的排序。

我可能会将日期戳列更改为单个数字以绕过它，但以前有人见过吗？

谢谢。

DefaultHandler 类中的代码段显示了将值添加到 ContentValues 对象的位置...

```
@Override
public void characters(char ch[], int start, int length) {
    if(this.in_datestamp_tag){
        cv.put(DbAdapter.TBL_BOOK_ROW_DATESTAMP, new String(ch, start, length));
    }
} 
```

# jquery - 将可拖动添加到表格行（使用 Kendo Grid）

> ID：14268064
> 
> 赞同：1
> 
> 时间：2013-01-10T22:01:19.257
> 
> 标签：jquery, jquery-selectors, draggable, kendo-ui

我正在尝试在表格的行上添加一个可拖动的事件，但我没有得到我应该得到的。这是一个创建表格结构的剑道网格。最后，如果可能的话，我想把这行放在不是剑道的东西上。

### HTML

```
<div id="Assets" style="width: 200px; float: left;" data-role="grid" class="k-grid k-widget" tabindex="0">
    <ul>
        <div class="k-widget k-grid" id="Assets">
            <div class="k-grid-header">
                <div class="k-grid-header-wrap">
                    <table cellspacing="0">
                        <colgroup>
                        <col style="width: 240px">
                    </colgroup>
                    <tbody></tbody>
                </table>
            </div>
        </div>
        <div class="k-grid-content" style="height: 200px">
            <div class="k-grid-header" style="padding-right: 17px;">
                <div class="k-grid-header-wrap">
                    <table cellspacing="0">
                        <colgroup><col style="width: 240px"></colgroup>
                        <thead>
                            <tr data-role="draggable">
                                <th class="k-header" data-field="Id" data-title="Id" scope="col" style="display: none"><span class="k-link">Id</span></th>
                                <th class="k-header" data-field="Name" data-title="Name" scope="col"><span class="k-link">Name</span></th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
        <table cellspacing="0" class="k-focusable">
            <colgroup><col style="width: 240px"/></colgroup>
            <tbody>
                <tr data-uid="cc7fc98a-dc66-4a46-8d3a-b73d608cf32b">
                    <td style="display: none">1</td>
                    <td>A Commons</td>
                </tr>
                <tr class="k-alt" data-uid="daf17bf4-52d3-43a4-acc0-034c7c53e5af">
                    <td style="display: none">2</td>
                    <td>A Chase</td>
                </tr>
                <tr data-uid="6dbe2dec-e9ce-4640-8f61-f1ee4469a581">
                    <td style="display: none">4</td>
                    <td>Beacon</td>
                </tr>
                <tr class="k-alt" data-uid="569798d6-433c-4dea-b56b-5833bab22058">
                    <td style="display: none">5</td>
                    <td>Seminole</td>
                </tr>
                <tr data-uid="4639277c-97eb-43d0-9aa1-6402671474b5">
                    <td style="display: none">6</td>
                    <td>Commons</td>
                </tr>
                <tr class="k-alt" data-uid="9ad1bf14-91bf-474f-9115-246c55c38eab">
                    <td style="display: none">3</td>
                    <td>Willows</td>
                </tr>
            </tbody>
        </table>
    </ul>
</div> 
```

### JS

这是我试图选择我需要的 tr 的代码：

```
$(".k-focusable > tbody > tr").kendoDraggable({
    hint: function(e) {
        item = $('<div class="k-grid k-widget" style="background-color: lightblue; color: black;"><table><tbody><tr>' + e.html() + '</tr></tbody></table></div>');
        return item;
    },
}); 
```

我宁愿以纯粹的`jQuery`方式做到这一点：

```
$("<selector>").draggable({
    cursor: 'move',
    distance: 40,
    helper: 'clone',
    opacity: 0.8,
    revert: 'invalid',
    revertDuration: 100,
    snap: 'div.node.expanded',
    snapMode: 'inner',
    stack: 'div.node',
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T23:16:55.633

不知道你想在删除时做什么，但这应该可以将一行从 Kendo Grid 移动到可放置区域**但**它实际上并没有从`grid`你应该（或不应该）删除元素。

放下时我要做`clone`的是移动元素并将其插入`clone`目标区域。

HTML 代码：

```
<div id="grid"></div>
<table id="target" class="k-widget k-grid">
    <thead>
        <tr>
            <th class="k-header" colspan="2">Drop inside red area</th>
        </tr>
    </thead>
</table> 
```

JavaScript 网格初始化：

```
var dataSource = new kendo.data.DataSource({
    data    : [
        {"ID": 1, "Nom": "John"},
        {"ID": 2, "Nom": "Jane"},
        {"ID": 3, "Nom": "Sam"},
        {"ID": 4, "Nom": "Charles"},
        {"ID": 5, "Nom": "Paul"},
        {"ID": 6, "Nom": "Josh"},
        {"ID": 7, "Nom": "Daniel"}
    ],
    pageSize: 8
});

var grid = $("#grid").kendoGrid({
    dataSource: dataSource,
    columns   : [
        {field: "ID" },
        {field: "Nom"}
    ]
}).data("kendoGrid"); 
```

最后是拖放：

```
$("tr", grid.tbody).kendoDraggable({
    hint: function (e) {
        item = $('<div class="k-grid k-widget" style="background-color: lightblue; color: black;"><table><tbody><tr>' + e.html() + '</tr></tbody></table></div>');
        return item;
    }
});

$("#target").kendoDropTarget({
    drop: function (e) {
        e.dropTarget.append($(e.draggable.currentTarget).clone());
    }
}); 
```

看到它在[这里运行](http://jsfiddle.net/OnaBai/WAw4Y/)

# android - 启动时绕过主要活动

> ID：14268074
> 
> 赞同：2
> 
> 时间：2013-01-10T22:02:11.143
> 
> 标签：android, android-activity, android-manifest

我的应用程序有几个活动，包括`StartActivity`声明

```
<intent-filter>
    <action android:name="android.intent.action.MAIN" />
    <category android:name="android.intent.category.LAUNCHER" />
</intent-filter> 
```

在清单中。我也有一个`Application`子类，就是在这里开始一些初始化任务。初始化代码在后台线程中执行，因此`StartActivity`只需显示启动屏幕并等待后台初始化完成。在初始化完成之前，控制权不会传递给任何其他 Activity，这一点很重要。

有时，在我的应用程序运行后，它会通过用户按 HOME 键发送到后台，并且可能会打开其他一些应用程序。如果我的应用在一段时间后从启动器重新启动，则应用会在上次打开应用时处于活动状态的任何活动中愉快地恢复。这可以。

如果在我的应用程序重新启动之前有几个小时的延迟，那么有趣的事情就会开始发生。似乎该进程已重新启动-我可以从日志输出中得知我的`Application.onCreate()`已被调用，并且后台初始化任务已启动-但至关重要的`StartActivity`是，该进程已被绕过并且系统已尝试直接进入上次活动的任何活动应用程序已打开。

在我看来，这似乎是一个不可能的情况。进程永远不可能重新启动（在先前被终止之后，可能是由于不活动）并直接跳转到非`MAIN`活动。要么应用程序处于活动状态，并且可以简单地恢复上次使用的 Activity，而无需重新初始化应用程序；或者，应用程序已死，应该从头开始重新初始化，包括启动`MAIN`Activity。它永远不应该处于这种奇怪的僵尸状态。

我的理解是错误的，还是 Android 正在做一些完全疯狂的事情？

[可能相关：[Android：系统何时卸载类？](https://stackoverflow.com/questions/2447588/android-when-do-classes-get-unloaded-by-the-system)]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:46:55.400

您的应用程序处于“停止”状态，隐藏，即您所说的“僵尸状态”。

重新启动时，它正在调用上次打开的 Activity 的 onRestart() 方法。您需要在此 Activity中实现[onRestart()方法。](http://developer.android.com/reference/android/app/Activity.html#onRestart%28%29)

在那里你应该重新初始化你的应用程序。

欲了解更多信息：http: [//developer.android.com/training/basics/activity-lifecycle/stopping.html](http://developer.android.com/training/basics/activity-lifecycle/stopping.html)

附加建议：

首先，您应该检查是否确实需要初始化。如果您的初始化过程是异步任务，您可以在此处启动它（可能使用对话框），或者您可以将用户直接发送回 SplashScreen/MainActivity。

```
protected void onRestart() {
    super.onRestart();
    if (!this.getApplicationContext().getIsInitialized()
      && !(this instanceof SplashScreenActivity)) {
      Log.v(TAG, "onRestart() starting Initialization of Application");
      initialize();
    } else {
       Log.v(TAG, "onRestart() Application already initialized");
    }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:38:23.027

您需要使用[onSaveInstanceState](http://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState%28android.os.Bundle%29)来保留在您的活动被终止并重新启动时需要恢复的任何配置。您将在 onCreate 中重新获得此捆绑包，并且可以将应用程序更新到它停止的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T22:42:02.573

检查您在 Eclipse 中的设置。确保将启动活动设置为应用在清单中定义的任何内容。有时 Eclipse 喜欢将特定的启动器活动设置为默认值并记住该活动，即使您的清单另有说明。

# javascript - 如果浮动工具提示在屏幕上的最左端或最右端，则重新定位它

> ID：14268076
> 
> 赞同：0
> 
> 时间：2013-01-10T22:02:24.107
> 
> 标签：javascript, jquery, flot

我正在尝试显示浮动图表的工具提示。当他们将鼠标悬停在栏上时，提示会显示相应的值。我的图表占据了整个屏幕的宽度，当它在最左边时，提示超出了屏幕，我看不到任何价值。如果它在极左或极右，如何重新定位它。我正在传递 item.pageX 和 item.pageY 值。我很困惑

```
#flot-tooltip {
        font-size: 12px;
        font-family: Verdana, Arial, sans-serif;
        position: absolute;
        display: none;
        border: 2px solid;
        padding: 2px;
        background-color: #FFF;
        opacity: 0.8;
        -moz-border-radius: 5px;
        -webkit-border-radius: 5px;
        -khtml-border-radius: 5px;
        border-radius: 5px;
    }

function showTooltip(x, y, contents, z) {
        $('<div id="flot-tooltip">' + contents + '</div>').css({
            position: 'absolute',
            display: 'none',
            top: y - 30, 
            left: x - 110,
            'border-color': z,
        }).appendTo("body").show();
    }

$("#flot-chart").bind("plothover", function(event, pos, item) {
        if(item) {
            if(previousPoint != item.dataIndex) {
                previousPoint = item.dataIndex;

                $('#flot-tooltip').remove();
                var x = item.datapoint[0].toFixed(2);
                    y = item.datapoint[1].toFixed(2);
                    z = item.series.color;

                showTooltip(item.pageX, item.pageY, "<b>" + item.series.label + "</b><br /> <hr>" + y, z);

            }
        } else {
            $('#flot-tooltip').remove();
            previousPoint = null;
        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:11:31.013

您可能需要在`showTooltip`函数中添加一些逻辑。例如，`x`当它太靠近屏幕的左边缘时，您想限制它。您可以添加一些内容以达到以下效果：

```
function showTooltip(x, y, contents, z) {
    if(x < 100){
     x = 100;
    }
  //rest of function
} 
```

这应该强制工具提示出现在等于`x`值小于预定义值的位置（此处为示例）。 `100``x``100`

# php - 跨/不同托管服务器中的 Yii 核心库

> ID：14268077
> 
> 赞同：0
> 
> 时间：2013-01-10T22:02:24.353
> 
> 标签：php, yii

我使用共享主机并且不想在我的每个共享主机帐户中安装 Yii 的核心库。
因此，我想将库放在一个共享主机中，并在我的所有帐户共享主机中使用它。
这是可以做到的还是会因此产生什么后果？

Yii 中的示例代码`index.php`将是：

```
// change the following paths if necessary
$yii='http://gusdecool.com/Script/Yii/1.1.13/yii.php';
$config=dirname(__FILE__).'/protected/config/main.php';

// remove the following lines when in production mode
defined('YII_DEBUG') or define('YII_DEBUG',true);
// specify how many levels of call stack should be shown in each log message
defined('YII_TRACE_LEVEL') or define('YII_TRACE_LEVEL',3);

require_once($yii);
Yii::createWebApplication($config)->run(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:10:45.773

如果您在共享主机上，您可能无法做到这一点。我的意思是，如果您尝试对多个域使用相同的 yii 框架文件夹，它可能会引发错误（打开基本目录或类似的），因为您无法从 domainA 的帐户访问 domainB 的帐户。

我管理专用服务器，我将框架目录放在 php 包含路径上，我就完成了。

您可以询问您的托管服务提供商是否可以这样做。

**编辑** 我刚刚看到的：

```
$yii='http://gusdecool.com/Script/Yii/1.1.13/yii.php'; 
```

你不能那样做。如果您通过 http 访问该文件，它将返回 html 代码，而不是 php 代码本身。你所要做的

```
$yii = '/whatever/path/gusdecool.com/Yii/1.1.13/yii.php'; 
```

但是，正如我之前所说，它必须在您的包含路径中

# jquery - jQuery：如何使用 jQuery 过滤内容？

> ID：14268078
> 
> 赞同：0
> 
> 时间：2013-01-10T22:02:26.560
> 
> 标签：jquery, json, sorting, filtering

我有一个列表，其中包含我想通过打开/关闭（选择、单选、复选框）过滤并按字段（名称、日期、...）排序的项目。

下面的代码可以用于基本过滤，但这不是一个好方法。我想知道如何以专业的方式做到这一点。有什么好的 jQuery 插件吗？我不想要一个小部件，只是它背后的过滤/排序引擎。

```
# this code is pseudocode and not running! # 
<script>
// ready
$(function() {
    // get items
    var items = jQuery.parseJSON("items_json.php");

    // items filtered
    var items_filtered = new Array();

    // conditions/relations for filtering
    var filter1_relations = jQuery.parseJSON("filter1_relations.php");
    var filter2_relations = jQuery.parseJSON("filter2_relations.php");

    // build unfiltered list
    build_list(items);

    // build filtered list
    $(".filter").on("change", function() {
        items_filtered = run_filter1(items, filter1_relations);
        items_filtered = run_filter2(items_filtered, filter2_relations);
        build_list(items_filtered);
    });
});

// filters the 'items' by checking if a 'relation' exists
function run_filter1(items, relations) {
    items_filterd = new Array();
    $.each(items, function(key, item) {
        for (var i = 0; i < relations.length; i++) {
            if (...) {
                items_filtered.push(item);
            }
        }
    });
    return items_filtered;
}

// build list and add to #content
function build_list(items) {
    html = '<ul>';
    for (var i = 0; i < items.length; i++) {
        html += '<li>'+ items[i].name +'</li>';
    }
    html += '</ul>';

    $("#content").html(html);
}
</script>
Filter 1.1: <input type="checkbox" name="filter1_condition1" value="1" class="filter"/><br/>
Filter 1.2: <input type="checkbox" name="filter1_condition1" value="1" class="filter"/><br/>
Filter 2.1: <input type="checkbox" name="filter1_condition1" value="1" class="filter"/><br/>
Filter 2.1: <input type="checkbox" name="filter1_condition1" value="1" class="filter"/><br/>
<div id="content"></div> 
```

我通过搜索 stackoverflow找到[了这段代码，但它并不那么广泛。](http://jsfiddle.net/nanoquantumtech/Ddnuh/)

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:34:27.667

instead of looping every time on change, once you have the data (providing you cannot structure your data before sending by server via sql or php or both), create right away the arrays for each filter

```
//loop data
//loop filter conditions
//if match
if (!filter_results[filter])   filter_results[filter]=new Array () 
filter_results[filter].push(data) 
```

edit : can use index instead of push (it's faster)

```
var i = -1; 
```

then in the loop

```
filter_results[filter][++i]=data 
```

(or an array of index if there are many of them, creating new one when creating the new Array))

so yes just like index then on change you just create your html from the good array

```
 var html='<ul><li>'+ filter_results[filterselected].join('</li><li>')+'</li></ul>' 
```

one way or another, you'll have to loop through, with this way you'll just loop through it once for all (i had to deal with stg similar not long ago -receiving 100/200kb of pregzip data at each call- & after much thinking/experimenting/evaluating memory usage i went for that way)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:09:38.223

[我刚刚使用KnockOut](http://knockoutjs.com/)实现了一个相当复杂的表单（有很多“如果选择了这个选项，这些项目应该变得可见”），这对于这类事情非常有用。

您需要在 KnockOut 视图模型中设置条件，然后您可以绑定这些条件，例如，仅在满足特定条件时才显示项目：

```
<input type="checkbox" data-bind="visible: filter1_condition1" value="1" class="filter"/> 
```

# c++ - 取消已锁定互斥锁的线程不会解锁互斥锁

> ID：14268080
> 
> 赞同：12
> 
> 时间：2013-01-10T22:02:31.153
> 
> 标签：c++, c, linux, mutex

帮助客户解决他们遇到的问题。我更像是一个系统管理员/DBA 人，所以我正在努力帮助他们。他们说这是内核/环境中的错误，在我坚持认为它在他们的代码中或寻求操作系统的供应商支持之前，我试图证明或反驳这一点。

发生在 Red Hat 和 Oracle Enterprise Linux 5.7（和 5.8）上，应用程序是用 C++ 编写的

他们遇到的问题是主线程启动了一个单独的线程来执行可能长时间运行的 TCP connect() [客户端连接到服务器]。如果“长时间运行”方面花费的时间太长，他们会取消线程并启动另一个线程。

这样做是因为我们不知道服务器程序的状态：

*   服务器程序启动并运行 --> 立即接受连接
*   服务器程序未运行，机器和网络正常 --> 连接立即失败，出现错误“连接被拒绝”
*   机器或网络崩溃或关闭 --> 连接需要很长时间才能失败，并出现错误“没有到主机的路由”

问题是取消已锁定互斥锁的线程（设置清除处理程序以解锁互斥锁）有时不会解锁互斥锁。

这使得主线程挂起试图锁定互斥锁。

详细环境信息：

*   glibc-2.5-65
*   glibc-2.5-65
*   libcap-1.10-26
*   内核调试-2.6.18-274.el5
*   glibc-headers-2.5-65
*   glibc-common-2.5-65
*   libcap-1.10-26
*   内核-doc-2.6.18-274.el5
*   内核-2.6.18-274.el5
*   kernel-headers-2.6.18-274.el5
*   glibc-devel-2.5-65

代码是用：c++ -g3 tst2.C -lpthread -o tst2 构建的

非常感谢任何建议和指导

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-10T22:45:32.107

取消的线程不会解锁它们持有的互斥锁是正确的，您需要手动安排它，这可能很棘手，因为您需要非常小心地在每个可能的取消点周围使用正确的清理处理程序。假设您正在使用`pthread_cancel`取消线程并设置清理处理程序`pthread_cleanup_push`来解锁互斥锁，您可以尝试几种替代方法，它们可能更容易正确处理，因此可能更可靠。

使用[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)解锁互斥锁*会*更可靠。在 GNU/Linux`pthread_cancel`上实现了一个特殊的异常类型`__cxxabi::__forced_unwind`，所以当一个线程被取消时，一个异常被抛出并且堆栈被展开。`__forced_unwind`如果互斥锁被 RAII 类型锁定，那么如果堆栈被异常 解开，它的析构函数将保证运行。[`Boost Thread`](http://www.boost.org/libs/thread/)提供了一个可移植的 C++ 库，它封装了 Pthreads，并且更易于使用。它提供了 RAII 类型`boost::mutex`和其他有用的抽象。Boost Thread 还提供了自己的“线程中断”机制，与 Pthread 取消类似但又不一样，Pthread 取消点（如`connect`) 不是 Boost Thread 中断点，这对某些应用程序很有帮助。但是，在您的客户的情况下，因为取消点是中断`connect`呼叫，他们可能确实希望坚持使用 Pthread 取消。GNU/Linux 将取消作为例外实现的（不可移植的）方式意味着它可以很好地与`boost::mutex`.

当您使用 C++ 编写代码时，确实没有任何理由显式锁定和解锁互斥锁，恕我直言，C++**最重要和最有用**的特性是析构函数，它非常适合自动释放资源，例如互斥锁。

另一种选择是使用健壮的互斥锁，它是通过在初始化互斥锁之前调用[`pthread_mutexattr_setrobust`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_mutexattr_setrobust.html)a创建的。`pthread_mutexattr_t`如果一个线程在持有一个健壮的互斥锁时死掉了，内核会记下它，以便下一个试图锁定互斥锁的线程得到特殊的错误代码`EOWNERDEAD`。如果可能，新线程可以使该线程保护的数据再次保持一致，并取得互斥锁的所有权。这比简单地使用 RAII 类型来锁定和解锁互斥锁要难于正确使用。

一种完全不同的方法是确定在调用时是否真的需要持有互斥锁`connect`。在缓慢的操作期间持有互斥锁不是一个好主意。`connect`如果成功锁定互斥锁并更新受互斥锁保护的任何共享数据，您就不能打电话吗？

我的偏好是同时使用 Boost Thread 并避免长时间持有互斥锁。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T01:24:54.207

> 他们遇到的问题是主线程启动了一个单独的线程来执行可能长时间运行的 TCP connect() [客户端连接到服务器]。如果“长时间运行”方面花费的时间太长，他们会取消线程并启动另一个线程。

微不足道的修复——不要取消线程。它有什么害处吗？如有必要，让线程检查（当`connect`finally 完成时）是否仍然需要连接，如果不需要，则关闭它，释放互斥体并终止。您可以使用受互斥锁保护的布尔变量来执行此操作。

此外，线程在等待网络 I/O 时不应持有互斥锁。互斥锁应该只用于快速且主要受 CPU 限制或可能受本地磁盘限制的事物。

最后，如果您觉得需要从外部伸手并迫使线程做某事，请退后一步。*您*为该线程编写了代码。如果您觉得需要，这意味着您没有编写该线程来执行您真正希望它执行的操作。解决方法是修改线程以执行您真正想要的，并且只执行您真正想要的。这样你就不必从外面“推它”了。

# java - ArrayList 是有效的@ModelAttribute 吗？如何创建填充它的表单？

> ID：14268088
> 
> 赞同：0
> 
> 时间：2013-01-10T22:03:11.663
> 
> 标签：java, html, spring

我无法让这个工作。我将保持我的代码和想法通用，因为我已经看到了一些有类似问题的人的例子：

基本思想是视图有一个订单项列表，其中包含用户可以在表单中修改的属性。当用户提交表单时，我希望使用用户提交的数据填充订单项。

如何创建填充这个的 HTML 表单，`@ModelAttribute("orderItems")`它是一个`ArrayList`of `OrderItemBean`s

控制器代码：

```
@RequestMapping("/order/{orderId}/save")
public String saveOrder(Map<String, Object> map, @ModelAttribute("orderItems") ArrayList<OrderItemBean> orderItems) throws Exception
{
  ...    
} 
```

Java Bean 代码：（隐含的 getter 和 setter）

```
public class OrderItemBean
{
  String orderItemId;
  String itemName;
} 
```

我不确定我哪里出错了，因为我还在学习 Spring。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:15:06.733

我总是通过接口使用声明参数。

尝试更改 ArrayList -> 列表

还要确保您的 OrderItemBean 使用 @XmlRootElement 注释并在上下文中声明。

# ios - UIPickerview 在释放时导致堆增长

> ID：14268094
> 
> 赞同：3
> 
> 时间：2013-01-10T22:03:20.873
> 
> 标签：ios, memory-leaks, uipickerview, heapshot

iOS 新手，尽我所能掌握内存管理和 Instruments。

我的问题是添加/删除pickerview 时出现奇怪的内存丢失。我已经设置了一个非常基本的示例，其中包含两个按钮：一个创建并显示选择器。另一个将其从主视图中删除。

分析仪干净，仪器没有报告任何明显的泄漏。但是 - 当我重复这个“显示和隐藏”操作时，堆内存继续增长。

这是代码。我在 XCode 4.5 上，启用了 ARC：

我的 ViewController.h：

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController <UIPickerViewDataSource,UIPickerViewDelegate>

@property (nonatomic,strong) UIPickerView *myPickerView;

- (IBAction)pickerButtonPressed:(id)sender;
- (IBAction)freeButtonPressed:(id)sender;

@end 
```

视图控制器.m：

```
@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)pickerButtonPressed:(id)sender {

    NSLog(@"Tap");

    // create picker view on first button tap
    UIPickerView* newPicker = [[UIPickerView alloc] initWithFrame:CGRectMake(20, 20,160, 160)];

    newPicker.dataSource = self;
    newPicker.delegate = self;
    newPicker.showsSelectionIndicator = YES;
    self.myPickerView = newPicker;

    [self.view addSubview:newPicker];
}

- (IBAction)freeButtonPressed:(id)sender {

    NSLog(@"Free");

    // remove from view and release
    [self.myPickerView removeFromSuperview];

    self.myPickerView = nil;
}

-(NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component{

    return 5;
}

-(NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView{

    return 2;
}

- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component
{
    return @"Meh";
}

@end 
```

Instruments 上的对象列表显示`UIPickerView`每次迭代都很好，所以看起来它被正确地释放了。嗯，不完全是。这是来自 heapshot 的示例：

![在此处输入图像描述](../Images/91b4f77fbbd508cc235dff0b3dd58fa1.png) （对不起，我还不允许发布图片）

现在，如果我实际上正确地释放了pickerview（从视图中删除并将其引用设置为nil）这些分配来自哪里？

在旁注中-`UIPickerTableViewTitledCell`堆栈跟踪上的那件事让我感到怀疑，因为有些人在泄漏涉及该问题的pickerviews方面遇到了类似的问题（请参阅[this](https://stackoverflow.com/questions/9762457/ios-weird-exception)和[this one](https://stackoverflow.com/questions/13045423/ios6-uipickerview-memory-leak)），但是我无法确定自己是什么应该与此有关。不确定它们是否真的与我的问题有关，但如果运气好的话，它们可能会指向正确的方向。

有小费吗？

# bash - 我需要 cat 将 heredoc 写入文件吗？

> ID：14268097
> 
> 赞同：10
> 
> 时间：2013-01-10T22:03:31.363
> 
> 标签：bash, cat

我有一个写入文件的脚本，如下所示：

```
cat >myfile <<EOF
some lines
and more lines
EOF 
```

但我不确定这是否是对 Cat 的无用使用......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-13T17:31:15.370

即使这可能不是 UUOC，也可能有用`tee`：

```
tee myfile <<EOF
some lines
and more lines
EOF 
```

`sudo`它更简洁，而且与重定向运算符不同，如果您需要写入具有 root 权限的文件，它可以结合使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T22:08:41.787

它不是真正的 UUOC。你也可以对 echo 做同样的事情：

```
echo "this is line
this is another line
this is the last line" > somefile 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T22:14:31.750

UUOC 就是在你`cat`不需要的时候使用它。如：

```
cat file | grep "something" 
```

相反，你可以在没有猫的情况下做到这一点：

```
grep "something" file 
```

[在此处](http://en.wikipedia.org/wiki/Cat_%28Unix%29#Useless_use_of_cat)查找UUOC 的原始定义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-10T22:39:32.077

在 zsh 中它是一个 UUOC，因为：

```
>myfile <<EOF
some lines
and more lines
EOF 
```

工作正常。

# mobile - 用于学校目的的 WML 和 WAP 开发环境

> ID：14268098
> 
> 赞同：1
> 
> 时间：2013-01-10T22:03:32.527
> 
> 标签：mobile, ide, emulation, wap, wml

我在 BscIT 的第 5 学期学习 WML 和 WAP，我很难找到`nokia wap toolkit`我书中使用的内容。当我终于从朋友那里得到一份副本时，它从未加载过，`jvm`尽管`java 1.6` 我之前安装了之前安装的。除了`jre 1.4`我有双启动windows7/Ubuntu12.04。我显然更喜欢在 Ubuntu 上工作。有没有其他选择。像 IDE, `eclipse`, `netbeans`, `intellij`? 到目前为止，我所看到的是`Android sdk,java MIDP projects`来自这些 IDE，而不是某种 wml 项目。

请指出正确的方向。谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T07:38:31.533

您可以试试 Openwave SDK，它已在[此处](http://blog.wapreview.com/3733/)存档。遗憾的是，就像诺基亚 WAP 工具包一样，制造商不再提供或支持它。

显然，它不会与您书中的示例相匹配，但它应该为您提供一个运行和测试 WAP 应用程序的简单环境。请注意，这仅适用于 Windows，并且早于 Windows 7；希望它会运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T04:59:49.500

在文档文件中编写代码并提供 .wml 扩展名。之后要运行此代码，只需将[附加组件添加](https://addons.mozilla.org/en-us/firefox/addon/wmlbrowser/)到您的 Firefox。和这些一起工作真是太好了。

谢谢。

# android - 访问库项目中定义的样式资源

> ID：14268104
> 
> 赞同：6
> 
> 时间：2013-01-10T22:04:03.457
> 
> 标签：android

我的图书馆项目中有这样的东西。我想在我的具体项目中使用该自定义主题，但我无法引用它。我怎样才能实现这一目标？

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<style name="MenuDialog" parent="android:Theme.Dialog">
    <item name="android:windowNoTitle">true</item>
    <item name="android:windowCloseOnTouchOutside">false</item>
    <item name="android:windowAnimationStyle">@null</item>
</style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:45:09.250

我现在为解决方法所做的是：我不在清单文件中设置主题，而不是在 setContentView 方法之前设置它。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    setTheme(package_library.R.style.MenuDialog);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:13:27.667

如果我正确理解您的问题，希望您正在寻找这个

用这个：

在 style.xml 文件中创建主题

```
<style name="Theme.SettingsBackground" parent="@android:style/Theme.NoTitleBar">
<item name="android:windowBackground">@android:color/black</item>
</style> 
```

然后在清单文件中使用：

```
<activity android:name=".Settings" android:theme="@style/Theme.SettingsBackground"></activity> 
```

对您想要的所有子活动执行此操作。

# web-services - Web 服务 - 默认值忽略或清除字段？

> ID：14268106
> 
> 赞同：1
> 
> 时间：2013-01-10T22:04:04.550
> 
> 标签：web-services, asp.net-web-api

我们正在开发基于 .NET webApi 的 Web 服务，允许客户创建和更新对象。当模型交给我们的控制器时，我们如何区分为 null/blank/0 的字段，因为调用者希望它们设置为 null/blank/0，或者为 null/blank/0 的字段，因为这是默认使用的当调用者不打算为该字段设置值时进行参数绑定？有处理这个的标准吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:27:47.947

您应该能够只检查控制器上的 ModelState 属性。如果调用了 WebAPI 操作并且 ModelState 有效，则应该意味着所有参数都从 URI 成功绑定或从请求正文中反序列化。

有一个警告 - 这仅适用于 WebAPI 的默认参数绑定。如果您注册自己的自定义参数绑定以不同方式绑定参数，那么所有赌注都将失败。

现在就参数的属性和字段而言，由格式化程序决定如何处理它们。反序列化程序在遇到丢失的成员时有两种选择。他们可以抛出，也可以用 0/blank/null 填充成员。您可以通过将属性标记为 [Required] 或使用 [DataMember(IsRequired=true)] 如果您正在使用数据协定模型来要求格式化程序在缺少属性时添加模型状态错误。

# java - 通过setter方法执行过滤？

> ID：14268107
> 
> 赞同：0
> 
> 时间：2013-01-10T22:04:08.817
> 
> 标签：java, oop, javabeans, setter, getter-setter

我需要对 setter 方法进行一些过滤并考虑修改它们，例如：

```
class Dog{
    int speed;

    public int getSpeed() {
        return speed;
    }
    public void setSpeed(int speed) {
        if(speed < 100)
            this.speed = speed;
        else
            this.speed = 100;
    }
} 
```

我不记得有任何这样的实现，它可能不合法（或至少不正确）。`setFilteredSpeed(int speed)`而不是这个，我应该写额外的 setter 方法，命名`setSpeed(int speed)`为默认值吗？这种方式似乎不是破豆的方式。

```
class Dog{
    int speed;

    public int getSpeed() {
        return speed;
    }
    public void setSpeed(int speed) {
        this.speed = speed;
    }
    public void setFilteredSpeed(int speed) {
        if(speed < 100)
            setSpeed(speed);
        else
            setSpeed(100);
    }
} 
```

第三种选择是准备像这样的单独过滤器类：

```
class DogFilter{

    public int doSpeed(int speed) {
        if(speed < 100)
            return speed;
        else
            return 100;
    }
}

class Main(){
    public static void main(){
        Dog dog = new Dog();
        dog.setSpeed(DogFilter.doSpeed(165));
    }
} 
```

我认为这是常见的用法；但第二种选择似乎更接近 OOP 方法。哪种方式是正确的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:05:56.713

假设您实际上想要*完全*防止无效速度，您的第一个选择是正确的方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:07:24.013

如果`speed`永远*不会*高于 100，则第一个解决方案就足够了。对于其他两种解决方案，您需要确保所有可能设置无效（太高）的类都`speed`使用适当的方法，这很容易出错。

# c# - Mysql .Net 选择/删除自动增量值

> ID：14268109
> 
> 赞同：-1
> 
> 时间：2013-01-10T22:04:21.693
> 
> 标签：c#, mysql, wpf, vb.net, select

我有一个名为 UIDhold 的 mysql 表和一个名为`UID`（主键）的列。我的值从 1-20000 自动递增。

在我的 WPF 应用程序中，我有 mysql .net 库参考并已成功连接到数据库。我想知道的是在连接到数据库之后，我将如何选择 UID（例如；1），存储该值文本框或字符串变量`，然后从 db 表中删除该 UID？

当我在 Mysql cmdline 中执行时：

```
SELECT LAST_INSERT_ID(); 
```

我明白`0`了，但第一个值应该是`1`。

任何指导都会很棒！

更新：

我已经弄清楚如何选择最小 UID，即 1。但是我不知道如何将它存储在字符串变量/文本框中。UIDTextBox.Text = myData 处的语法错误。" System.data.datatable 类型的值无法转换为字符串。" 那么我需要做什么呢？

VB.Net

```
Imports MySql.Data.MySqlClient
Imports System.Data

Public Class test1

Dim cmd As New MySqlCommand

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As  System.Windows.RoutedEventArgs) Handles Button1.Click
    Dim myCommand As New MySqlCommand
    Dim myAdapter As New MySqlDataAdapter
    Dim myData As New DataTable
    Dim SQL As String
    Dim connStr As String = "Database=;" & _
                       "Data Source=localhost;" & _
                       "User Id=;Password=;"
    Dim connection As New MySqlConnection(connStr)

    connection.Open()
    SQL = "SELECT MIN(UID) FROM `UIDhold`"

    myCommand.CommandText = SQL

    myAdapter.SelectCommand = myCommand
    myAdapter.Fill(myData)

    UIDTextBox.Text = myData

End Sub
End Class 
```

XAML

```
<Window x:Class="test1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="test1" Height="300" Width="300">
<Grid>
    <Button Content="Sign In" Height="23" HorizontalAlignment="Left" Margin="184,159,0,0" Name="Button1" VerticalAlignment="Top" Width="75" />
    <TextBox Height="23" HorizontalAlignment="Left" Margin="120,38,0,0" Name="UIDTextBox" VerticalAlignment="Top" Width="68" />
    <Label Content="UID" Height="28" HorizontalAlignment="Left" Margin="58,33,0,0" Name="Label1" VerticalAlignment="Top" />
</Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T16:26:48.970

自动递增可以通过 MySQL 服务器本身完成。您只需在设置表时进行设置。

```
CREATE TABLE data(
     UID MEDIUMINT NOT NULL AUTO_INCREMENT,
     name CHAR(30) NOT NULL,
     PRIMARY KEY (id)
) ENGINE=MyISAM; 
```

因此，每当您要将其存储回数据库时，如果将值设置为 null 它将自动递增。

```
INSERT INTO animals (name) VALUES
    ('ssss') 
```

也知道你想要做什么（希望我理解正确）；但是，如果要创建数据表，则必须解析每一行，然后使用我认为的 while 循环添加它。

```
 table.Columns.Add("UID", typeof(int));
    table.Columns.Add("name", typeof(string));

   using (var varConnection = Locale.sqlConnectOneTimeMySql(Locale.sqlDataConnectionDetailsMySQL))
    using (var sqlQuery = new MySqlCommand(preparedCommand, varConnection)) {
        using (var sqlQueryResult = sqlQuery.ExecuteReader())                 
                while (sqlQueryResult.Read()) {
//above is basic sql stuff i expect you know

//Here's where you ge thte data
                    int uid = sqlQueryResult["UID"] is int ? (int)sqlQueryResult["UID"] : 0;
                    string name = sqlQueryResult["name"].ToString();

// here is where you're outputting to your table
                    table.Rows.Add(uid,name); 
                }
         }
    } 
```

# c# - jQuery 对话框中的 asp.net button.onclientclick 和 button.text 为空

> ID：14268116
> 
> 赞同：0
> 
> 时间：2013-01-10T22:05:10.333
> 
> 标签：c#, jquery, asp.net, jquery-ui-dialog

我有一个控件，应该提示用户选择会话的 customerId 或页面的旧 ViewState customerId。如果视图状态中的值与会话中的值不匹配，则会出现一个 jQuery 模式对话框。该对话框有两个按钮，一个应显示 ViewState 值，另一个应显示会话值。具有 ViewState 值的按钮还具有 OnClientClick 属性。我已经用一个简单的测试页面测试了这段代码，该页面只包含一个按钮和我的控件。简单的测试页面有效。当我将此控件添加到现有页面时，我可以显示对话框，但 button.text（在后面的代码中分配）是空的，并且 OnClientClick 的函数不会触发。

ascx

```
<script type="text/javascript">

    function ShowCustomerChangedModalDialog() {
        var dlg = $("#CustomerChangedModal").dialog({
            title: 'Select Customer ID',
            resizable: false,
            modal: true
        });
        dlg.parent().appendTo(jQuery("form:first"));
    };

    function changeCustomer(customerId, baseUrl) {
        $.ajax({ url: "/General/Accounts/change.account?id=" + customerId + "&admin=false", async: false });
        $("#CustomerChangedModal").dialog('close');
        return false;
    }

</script>

<div id="CustomerChangedModal" style="width: 440px; height: 250px; overflow: auto; display: none;">
    The session information has changed.
    Which account ID do you wish to use?
    <br />
    <br />
    <asp:Button ID="btnNewCustId" runat="server" OnClick="btnNewCustId_Click" />
    <asp:Button ID="btnOldCustId" runat="server" />
</div> 
```

后面的代码

```
public partial class CustomerChanged : System.Web.UI.UserControl
{
    protected override void OnInit(EventArgs e)
    {
        base.OnInit(e);
        this.Page.PreLoad += Page_PreLoad;
    }

    void Page_PreLoad(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            ViewState.Add("CustID", Globals.CurrentCust.CustId);
        }
        if (IsPostBack)
        {
            Page.Validate();
            ValidateCustomerId();
        }
    }

    protected void ValidateCustomerId()
    {
        if (Convert.ToInt32(ViewState["CustID"]) != Globals.CurrentCust.CustId)
        {
            //button properties assignments
            btnOldCustId.Text += "Old AccountId\n" + ViewState["CustID"].ToString();
            btnNewCustId.Text += "New AccountId\n" + Globals.CurrentCust.CustId.ToString();
            btnOldCustId.OnClientClick = string.Format("return changeCustomer({0},'{1}');", ViewState["CustID"].ToString(), Globals.GeneralSiteUrl);

            CustomValidator err = new CustomValidator();
            err.IsValid = false;
            err.ErrorMessage = "The customer has changed.";
            Page.Validators.Add(err);
        }
    }

    protected void Page_Load(object sender, EventArgs e)
    {

        if (IsPostBack)
        {
            if (!Page.IsValid)
            {
                ScriptManager.RegisterStartupScript(this.Page, this.Page.GetType(), "CustomerChangedModalDialog", "ShowCustomerChangedModalDialog();", true);
            }
        }
    }

    protected void btnNewCustId_Click(object sender, EventArgs e)
    {
        Response.Redirect(Request.RawUrl);
    }

} 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:16:58.280

我停止尝试使用服务器端代码并​​切换到 javascript 来分配按钮文本并使用新的 customerId 重新加载页面。这并不能回答我的问题，即为什么服务器端属性的行为不像我预期的那样，但它现在可以完成工作。

```
var div = $("#CustomerChangedModal");
var oldButton = $("[id$=btnOldCustId]", div);
var newButton = $("[id$=btnNewCustId]", div);
newButton.val("New AccountId " + newId);
oldButton.val("Old AccountId " + oldId);
newButton.on("click", function (event) { changeCustomerNew(newId) });
oldButton.on("click", function (event) { changeCustomerOld(oldId) }); 
```

# javascript - Javascript onclick 在单选按钮上不起作用

> ID：14268119
> 
> 赞同：0
> 
> 时间：2013-01-10T22:05:14.737
> 
> 标签：javascript

我有 javascript 的问题。我已经下载了一个评级明星插件，确切地说是这个：[http ://www.fyneworks.com/jquery/star-rating/#tab-Testing](http://www.fyneworks.com/jquery/star-rating/#tab-Testing)

我在一页上有很多东西要评价，所以我想我可以使用 onclick 将其发送到一个函数，该函数使用 ajax 将它发送到我的数据库。问题是，当点击评级星时，没有任何反应，我在常规提交按钮上尝试过，并且该功能被执行。

这是代码：

```
 <script type="text/javascript">
               function postform(){                      
                           alert('Thing is clicked');
                       };                 
            </script> 
```

星星实际上是一个单选按钮：

```
<input name="adv1" type="radio" class="star {split:4}" value="0.50" onclick="postform()"/> 
```

我看不出代码有什么问题，因为当我在这样的常规按钮上测试它时：

```
 <input type="submit" value="testbutton" onclick="postform()"/> 
```

它给了我警报 Thing is Clicked。

不知何故，明星不喜欢 onclick 的东西。我在 IE、Chrome 和 FF 中测试过它，没有任何反应

有人可以帮我吗？

非常感谢！

编辑：

按照卢卡斯的要求，我脑子里有这个：

```
<script type='text/javascript' src='jquery.min.js'></script>
<script src='jquery.MetaData.js' type="text/javascript"></script>
<script src='jquery.rating.js' type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:13:09.387

该库正在为您处理单选按钮的 onclick 事件，因此您无法通过向输入元素添加属性 onclick 来处理它。

根据他们的文档，您需要将一些这样的代码放在脚本中：

```
$('.auto-submit-star').rating({
    callback: function(value, link){
        alert(value);
    }
}); 
```

然后将类 auto-submit-star 添加到单选按钮的类列表中：

```
<input name="adv1" type="radio" class="auto-submit-star {split:4}" value="0.50" onclick="postform()"/> 
```

# python - 封闭式导入在 Python 中的工作原理

> ID：14268123
> 
> 赞同：1
> 
> 时间：2013-01-10T22:05:23.457
> 
> 标签：python

这是我在 pythion 的进口中无法完全弄清楚的东西。假设我有一个模块“a”，它使用“import b”导入模块“b”然后，有一个模块“c”导入模块“a”。模块“b”的名称是否可以在“c”中使用？

我已经检查过它实际上取决于您如何在模块“c”中导入模块“a”。如果您执行“导入 a”，则“b”中的名称将无法在“c”中使用。但是，如果您执行“从导入 *”，那么它们将可用。有人可以澄清一下区别吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:11:01.363

如果您仔细考虑这些命令的实际作用，那就很简单了。

一个.py：

```
import b
foo = 0 
```

b.py：

```
bar = 1 
```

c.py：

```
import a 
```

从`c`，你不能只说`foo`，你必须说`a.foo`。`a`常量、变量、函数、类甚至模块中的每个名称都是如此。这包括`b`.

所以，你不能说`bar`or `a.bar`，但你可以说`a.b.bar`。

现在，如果您像这样更改它会怎样：

一个.py：

```
from b import *
foo = 0 
```

b.py：

```
bar = 1 
```

c.py：

```
from a import * 
```

这样`from b import *`做是将 's 名称空间中的所有内容`b`，并将其放入`a`'s 名称空间中，因此您可以直接`bar`从inside 中说`a`。然后，当你这样做时`from a import *`，它会将 's 命名空间中的所有内容`a`放入`c`'s 中，所以就像你可以做的那样`foo`，你也可以做`bar`.

这就是为什么您通常不想`from b import *`在除了顶级脚本之外的任何地方做任何事情——因为您的命名空间会全部合并在一起。

这也是为什么您可以限制使用以下内容的`*`原因`__all__`：

一个.py：

```
from b import *
__all__ = ['foo']
foo = 0 
```

b.py：

```
bar = 1 
```

c.py：

```
from a import * 
```

现在，从`c`，你可以做`c.foo`，但不能`c.bar`。

因此，`a`可以`from b import *`实现自己的功能，而无需将所有`b`内部结构暴露给用户。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T22:15:47.463

该`import`语句导致模块被执行，所有变量都保存*在执行模块的命名空间中*。也就是说，如果你`import a`，那么所有`a`的变量都会在 下`a.[variable]`。关键字给出了稍微不同的`from`行为：它将变量*放在当前的命名空间*中。例如，`from a import foo`将变量`foo`放在当前命名空间中。`from a import *`将所有变量从`a`当前命名空间导入。`as`关键字允许您在导入变量时重命名它们；因此`from a import foo as bar`允许你访问`a.foo`，但你必须调用它`bar`；`import a.foo as foo`相当于`from a import foo`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:21:06.840

比上面更具体的例子：

`a.py`

```
import b
bar = 'bar' 
```

`b.py`

```
foo = 'foo' 
```

`c.py`

```
import a

try:
   print(b.foo)
except:
   print('No `b` in current namespace')

try:
   print(a.bar)
except:
   print('No `a` in current namespace')

try:
   print(a.b.foo)
except:
   print('No `a` or `a.b` in current namespace') 
```

这应该打印（按顺序）：

```
No `b` in current namespace
bar
foo 
```

换句话说， b 可以通过 a 使用，但只能通过访问`a`的命名空间

# algorithm - 使用什么算法来匹配字符串的开头

> ID：14268124
> 
> 赞同：2
> 
> 时间：2013-01-10T22:05:25.837
> 
> 标签：algorithm, sorting, search, language-agnostic

我有很多字符串要与搜索词匹配。

例子：

```
folks
fort
garage
grabbed
grandmother
habit
happily
harry
heading
hunter 
```

我想搜索字符串“ha”和返回列表开头的算法，其中字符串以“ha”开头，在本例中为“habit”。

当然，我不会一一列出，因为列表很大。我可以做一些预处理来对列表进行排序或将其放入使这种搜索快速的结构中。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:07:55.760

那么你想要某种类型的排序结构。您可以使用 TreeMap 或 Radix Tree（Radix 将为您节省一些空间）。这样做的开销将是排序操作或插入排序数据结构的开销。然而，一旦排序，二分搜索会给你`logN+1`最坏的情况查找性能。

值得注意的是`Lucene`使用 Radix Trees afaik

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:52:18.990

你的帖子留下了太多没有答案的问题。我的解释是你想从一个无序列的单词列表中创建一个字典。但是，当您搜索 时`ha`，您真正想要的是什么？

你想要

1.  `ha`以?开头的第一个词

2.  以 ?开头的第一个单词的索引`ha`？

3.  可以轻松访问所有以 开头的单词`ha`？

如果你想要`1`和/或`3`，那么说[trie](http://www.geekviewpoint.com/java/trie/is_word)的人是正确的。（我给你的链接有一个易于阅读的实现）。

如果`2`是你想要的，那么你能谈谈一个用例吗？如果没有，那么您正在考虑使用[字符串搜索算法](http://www.geekviewpoint.com/java/string_search_algorithm/kmp_string_search_algorithm)。没有更多细节，很难给出更准确的建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:08:56.943

您可以随时查看[Patricia Trees](http://en.wikipedia.org/wiki/Radix_tree)。它们几乎非常适合这种事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T22:09:10.773

[Trie](http://en.wikipedia.org/wiki/Trie)是您正在寻找的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-12T13:35:17.840

你的问题有很多模糊的地方。根据您的具体要求，您可能会发现[Rabin-Karp](http://en.wikipedia.org/wiki/Rabin%E2%80%93Karp_algorithm)字符串搜索方法对您有用。

# linux - 多个linux终端同时向所有窗口发送命令

> ID：14268128
> 
> 赞同：5
> 
> 时间：2013-01-10T22:05:52.847
> 
> 标签：linux, terminal

例如，假设我打开了 3 个终端（即[gnome-terminal](http://directory.fsf.org/wiki/Gnome-terminal)或[xterm](http://invisible-island.net/xterm/)），并且希望将它们组合在一起以在 1 个单个终端上键入时同时向所有终端发送命令。

如果我需要在特定终端中发出 1 个命令，我希望可以选择分散这些终端。有没有可以提供这种能力的终端应用程序？我已经尝试过 [keyboardcast](https://launchpad.net/keyboardcast)，但并不完全是我想要的，因为你必须在弹出窗口中输入你的命令。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T22:08:54.097

有一个叫做终结者的程序，它正是你想要的:)

~~[http://www.tenshu.net/p/terminator.html](http://www.tenshu.net/p/terminator.html)~~

[编辑] [https://github.com/software-jessies-org/jessies/wiki/Terminator](https://github.com/software-jessies-org/jessies/wiki/Terminator)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-30T10:50:41.093

如果您想要基于非 GUI 的方法，您还可以使用[tmux](http://tmux.sourceforge.net/)发送到多个会话，如此[处](http://masterofnull.com/2011/10/10/tmux-interact-with-any-or-all-panes/)所述- 基本上它通过在循环中使用以下 tmux 命令（如有必要）来工作：

```
tmux send-keys -t session_id your_command C-m 
```

还有一个 tmux 的增强功能，称为[wemux](https://github.com/zolrath/wemux)，它支持配对、镜像和流氓模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-30T18:29:20.413

如果您在 tmux 中使用窗格而不是单独的终端，则可以使用“同步窗格”将相同的输入发送到多个窗格。另外，您可以将命令绑定到一个键`.tmux.conf`以轻松打开和关闭它。

```
# sends input to all panes in a given window.
bind e setw synchronize-panes on
bind E setw synchronize-panes off 
```

见[https://linux.die.net/man/1/tmux](https://linux.die.net/man/1/tmux)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-09T10:57:15.997

如果您在 konsole 中打开多个选项卡/窗口，您可以将键盘输入从其中一个引导到其他选项卡/窗口。只需选择菜单 Edit -> Copy Input To ... -> All Tabs/Select .../None。

# php - 我试图确保我的字符串在 PHP 中只有有效的 UTF-8 字符。我怎样才能做到这一点？

> ID：14268130
> 
> 赞同：0
> 
> 时间：2013-01-10T22:06:08.107
> 
> 标签：php, regex, string, unicode, utf-8

> **可能重复：**
> [PHP：替换 utf-8 字符串中的无效字符](https://stackoverflow.com/questions/1433636/php-replace-invalid-characters-in-utf-8-string-in)

我有一个字符串，其中包含无效字符（它不是 UTF-8），例如以下显示 SUB：

![在此处输入图像描述](../Images/9a4d10e5a3e0912288e55893b486b5af.png)

我认为这是某种外国无效字符。

PHP中有没有办法获取一个字符串并使用`preg_replace`或其他方法来确保我只在我的字符串中使用有效的UTF-8字符，而其他任何东西都会被删除？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T11:37:55.800

首先，没有无效的 UTF-8 字符。存在无效的 UTF-8 字节和字节序列，这意味着有人试图对您的服务器发起编码攻击。这些可以使用`mb_check_encoding`即将到来的输入数据进行验证，如果您没有获得有效的 UTF-8，则会立即失败并返回 400 Bad Request。

你所拥有的只是 SUBSTITUTE 控制字符，一个有效但不可打印的字符。

> 最初旨在用作传输控制字符，以指示已接收到乱码或无效字符。当不需要它提供的带内错误信号时，它通常被用于其他目的，特别是在使用强大的错误检测和纠正方法的情况下，或者在错误预计足够少以使使用该字符的情况下其他目的为宜。

您可以使用此正则表达式来摆脱它（[以及其他一些](http://en.wikipedia.org/wiki/C0_and_C1_control_codes)）：

```
$reg = '/(?![\r\n\t])[\p{Cc}]/u';

preg_replace( $reg, "", $str ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:11:51.817

该[`mb_check_encoding`](http://php.net/mb_check_encoding)功能应该能够做到这一点。

```
mb_check_encoding("Jetzt gibts mehr Kanonen", "UTF-8"); 
```

注意：我没有测试过这个。

# jquery - jQuery：如何跨文件访问本地范围的函数

> ID：14268131
> 
> 赞同：0
> 
> 时间：2013-01-10T22:06:12.337
> 
> 标签：jquery, scope

我有两个 JS 文件，它们都包含在：

```
(function($) {})(jQuery) 
```

我想从另一个访问功能。除了从一个文件中删除包装器之外，我不知道如何做到这一点。像这样：

[http://pastie.org/5664519](http://pastie.org/5664519)

当我这样做时，我得到“Uncaught ReferenceError: switchPlaces is not defined”。我明白为什么，但我不知道如何解决它。

# html - 表格溢出div时的圆角？

> ID：14268135
> 
> 赞同：0
> 
> 时间：2013-01-10T22:06:24.730
> 
> 标签：html, css, html-table, overflow

我的结构类似于下面的代码。当表格对于内容容器来说太高时，它会隐藏溢出的内容。我的问题是可见表的底角是方形的，尽管它的容器 div 的下角是圆形的。有没有办法在表格底部和容器 div 底部之间不留空隙的情况下修整底部？

这是一个重现问题的演示 [http://www.jsbin.com/ohejor/1/edit](http://www.jsbin.com/ohejor/1/edit)

```
<div class='container'>
<table>
    ....table populated by php pulling from mysql table
</table>
</div> 
```

和 CSS

```
table{ overflow:auto;}
.container{ position:relative; height:75%;  border-radius:0px 0px 5px 5px;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T00:03:15.340

问题是您应该在容器而不是表上设置溢出-y：

```
table{}
.container{ position:relative; height:75%; border-radius:0px 0px 5px 5px; overflow-y: auto} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T23:59:32.257

`border-collapse: collapse`添加到表选择器应该会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T22:20:37.450

的角`table`是方形的，因为虽然你已经为 声明`border-radius`了`div.container`，但你还没有为`table`.

圆角`table`：

```
table { border: solid red 1px; border-radius: 0px 0px 5px 5px; } 
```

`div.container`为了防止和 之间的间距`table`：

```
.container { padding: 0px;} 
```

# php - 动态添加的输入字段未发布？

> ID：14268136
> 
> 赞同：0
> 
> 时间：2013-01-10T22:06:25.453
> 
> 标签：php, javascript, jquery

下面的代码由包含用户可以填写的一些输入字段的发票行组成。初始输入行数为 20。用户通常需要通过单击“添加行”按钮向发票中添加更多行。每次单击此按钮都会使用 Javascript 将更多行附加到发票上。

问题是当表单被提交时，似乎只有前 20 行被提交。所有 javascript 附加的发票行都被忽略并且永远不会发布。

我已经尝试解决这个问题很长一段时间了，我想知道是否有人可以指导我如何正确实施这个问题？

提前谢谢了。

标记/PHP

```
 <?php
                for($i=0; $i < 20; $i++){
                    echo '
                    <div class="invoice-line">
                        <div class="prod-id-cell"><input name="rows['.$i.'][id]" type="text" class="prod-id-input">
                            <div class="smart-suggestions">
                                    <!-- RESULT SUGGESTIONS WILL POPULATE HERE -->                              </div>
                        </div>
                        <div class="prod-name-cell">
                            <input type="text" name="rows['.$i.'][name]" class="prod-name-input"/>                                  <div class="smart-suggestions">
                                            <!-- RESULT SUGGESTIONS WILL POPULATE HERE -->
                                    </div>
                                </div>
                        <div class="price-cell"><input name="rows['.$i.'][price]" class="price-input" type="text" /></div>
                        <div class="quantity-cell"><input  name="rows['.$i.'][quantity]" type="text" class="quantity-input"></div>
                        <div class="unit-price-cell"><input name="rows['.$i.'][unit-price]" class="unit-price-input" type="text" /></div>
                        <div class="num-kits-cell"><input name="rows['.$i.'][num-kits]" class="num-kits-input" type="text" /></div>
                        <div class="amount-cell"><input name="rows['.$i.'][amount]" class="amount-input" type="text" readonly="readonly" /></div>
                    </div>';
                }
        ?> 
```

Javascript

```
//**ADD 5 LINES**//
        $('.invoice-links div').on("click", ".add-five-trigger", function(){
            for(var i=0; i < 5; i++){
                var invoiceLine = $(".invoice-line").first().clone( true, true );
                $(invoiceLine).insertAfter(".invoice-line:last");
                $(".invoice-line:last").find('input').val('').attr('disabled','disabled');
            }
        }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:08:02.177

这些值未发布，因为您正在禁用它们。具有 disabled 属性的输入元素不会被发布。

此外，请始终确保元素具有唯一的 ID 和名称。没有名称的元素不会被发布。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T22:10:44.630

您忘记更改`name`克隆输入的属性。他们会覆盖以前的字段。

用这个：

```
var invoiceLine = $(".invoice-line").last();
var newLine = invoiceLine.clone( true, true );
invoiceLine.after(newLine);
newLine.find('input').each(function() {
    if (this.type == "text")
        this.value = "";
    this.name = this.name.replace(/rows\[(\d+)\]/, function(m, num) {
        return "rows["+(+num+1)+"]";
    });
    this.disabled = true;
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:11:46.503

您没有为您创建的元素赋予新名称。您也在禁用它们。

```
$(".invoice-line:last").find('input').val('').attr('disabled','disabled'); 
```

禁用的表单输入永远不会与表单一起提交。

# c# - 如何将一个项目链接到另一个项目？

> ID：14268138
> 
> 赞同：0
> 
> 时间：2013-01-10T22:06:28.570
> 
> 标签：c#, xml, mapping

我的 XML 文件中有数字和后者。Numbers 由 4 个项目组成，但可以增加，后者由一批后者组成，我需要做的就是从 Numbers 中获取每个项目并从 Latters 分配给它的后者。

我在下面提出了一个解决方案，但没有任何成功，任何解决它的帮助将不胜感激:)

```
class aWithItsB{
//It means that nextA stores 1 number and 
//nextLattersBs stores latters for each number according XML file. 
    public string nextA;
    public List<string> nextLattersBs = new List<string>();

    }

public class AB : MonoBehaviour {

    void Start () {

        XmlDocument doc = new XmlDocument();
        doc.Load("D:\\new.xml");

        string lastNumber="";
        XmlNodeList numbers = doc.SelectNodes("AB/AandB/@numbers");
        XmlNodeList latters = doc.SelectNodes("AB/AandB/@latters");
        foreach(XmlNode number in numbers){
        if(number.Value!=lastNumber){
            foreach(XmlNode latter in latters){
            aWithItsBs AandB = new aWithItsB();
            AandB.nextA = number.Value;
            AandB.nextLattersB.Add(latter.Value);
                    print(number.Value + "" + latter.Value);
            }
        }
        lastNumber = number.Value;
        }
    }
} 
```

XML 文件：

```
<?xml version="1.0" encoding="iso-8859-1"?>
<AB>
<AandB numbers ="1" latters = "a"></AandB>
<AandB numbers ="1" latters = "b"></AandB>
<AandB numbers ="1" latters = "c"></AandB>
<AandB numbers ="1" latters = "c"></AandB>
<AandB numbers ="2" latters = "b"></AandB>
<AandB numbers ="2" latters = "x"></AandB>
<AandB numbers ="3" latters = "y"></AandB>
<AandB numbers ="3" latters = "a"></AandB>
<AandB numbers ="3" latters = "z"></AandB>
<AandB numbers ="4" latters = "y"></AandB>
<AandB numbers ="4" latters = "x"></AandB>
<AandB numbers ="4" latters = "a"></AandB>
</AB> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:12:59.067

一个有用的提示：

我相信您想为此任务使用字典或集合，而不是列表。

如果您使用不允许多个集合的集合，那么您不必做太多的逻辑。您可以检查项目是否存在并添加或不添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:31:04.153

尝试这个

```
class NumberLetter
{
    public string Number {get; set;}
    public string Letter {get; set;}

    NumberLetter(string number, string letter)
    {
        Number = number;
        Letter = letter;
    }
}

public class AB : MonoBehaviour {

    void Start () {

        List<NumberLetter> myList = new List<NumberLetter>();
        myList.Add(new NumberLetter("2", "a"));
        myList.Add(new NumberLetter("2", "b"));
        myList.Add(new NumberLetter("2", "c"));
        // ...
        // writing
        sing (var sw = new StreamWriter("D:\\new.xml"))
        {
            var g = new XmlSerializer(typeof(List<NumberLetter>));
            g.Serialize(sw, myList);
        }

        // reading
        using (var sr = new StreamReader("D:\\new.xml"))
        {
            var l = new XmlSerializer(typeof(List<NumberLetter>));
            myList = (List<NumberLetter>)l.Deserialize(sr);
        }

        // ...
    }
} 
```

# java - 缺少/不可用依赖项的服务

> ID：14268141
> 
> 赞同：6
> 
> 时间：2013-01-10T22:06:54.687
> 
> 标签：java, mysql, persistence, ejb-3.0

知道为什么我会收到此错误：

```
JBAS014775:    New missing/unsatisfied dependencies:
  service jboss.jdbc-driver.mysql (missing) dependents: [service jboss.data-source.jboss/datasources/UserDS] 
```

* * *

```
ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) `{"JBAS014653: Composite operation failed and was rolled back. Steps that failed:" => {"Operation step-2" => {"JBAS014771: Services with missing/unavailable dependencies" => ["jboss.data-source.jboss/datasources/UserDSjboss.jdbc-driver.com_mysql_jdbcMissing[jboss.data-source.jboss/datasources/UserDSjboss.jdbc-driver.com_mysql_jdbc]"]}}}` 
```

**持久性.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
    <persistence version="2.0"
       xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
            http://java.sun.com/xml/ns/persistence
            http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
       <persistence-unit name="primary">
          <jta-data-source>java:jboss/datasources/UserDS</jta-data-source>
          <properties>
             <!-- Properties for Hibernate -->
             <property name="hibernate.hbm2ddl.auto" value="create-drop" />
             <property name="hibernate.show_sql" value="true" />
          </properties>
       </persistence-unit>
    </persistence> 
```

* * *

**mydatasource-ds.xml**

```
 <?xml version="1.0" encoding="UTF-8"?>
            <datasources xmlns="http://www.jboss.org/ironjacamar/schema"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xsi:schemaLocation="http://www.jboss.org/ironjacamar/schema http://docs.jboss.org/ironjacamar/schema/datasources_1_0.xsd">
                <datasource jndi-name="java:jboss/datasources/UserDS" pool-name="kitchensink-quickstart" 
                    enabled="true" use-java-context="true">
                    <!-- jdbc:h2:mem:kitchensink-quickstart;DB_CLOSE_ON_EXIT=FALSE;DB_CLOSE_DELAY=-1 -->
                    <connection-url>
                        jdbc:mysql://localhost:3306/test
                    </connection-url>
                    <driver>mysql</driver>
                    <security>
                        <user-name>root</user-name>
                        <password>root</password>
                    </security>
                </datasource>
            </datasources> 
```

* * *

模块.xml

```
<module xmlns="urn:jboss:module:1.0" name="com.mysql">
      <resources>
        <resource-root path="mysql-connector-java-5.1.22.jar"/>
      </resources>
      <dependencies>
        <module name="javax.api"/>
      </dependencies>
    </module> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-05-16T05:47:20.900

如果您将数据源指定为 web.xml 中的资源引用，则将名称与standalone.xml（或 domain.xml） 中的名称*完全匹配：*

**网页.xml**：

```
 <resource-ref>
  <res-ref-name>java:jboss/datasources/OracleDS</res-ref-name>
  <res-type>javax.sql.DataSource</res-type>
  <res-auth>Container</res-auth>
 </resource-ref> 
```

**独立的.xml**：

```
<datasource jndi-name="java:jboss/datasources/OracleDS" pool-name="OracleDS" enabled="true" use-java-context="false"> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-23T21:26:48.337

错误的原因是您缺少依赖 java:jboss/datasources/UserDS. 使用 Jboss 7.x+，这些数据源可以直接添加到您发现的应用服务器配置中。

独立配置和域配置之间的区别在于独立配置仅针对具有所述配置的一个应用服务器而设计。如果您仔细查看 domain.xml，您将看到几个应用服务器配置（也称为配置文件）。这些将很像standalone/conf* 目录下的standalone、standalone-full、standalone-ha、standalone-full-ha 配置文件。在域模式下操作允许您从一个中心位置（即域控制器）控制在该域上运行的许多不同的服务器实例。（如果您已配置，这包括集群的节点）

这与您的原始问题密切相关，因为域控制器能够优雅地将此数据源配置共享给它的所有节点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-14T09:17:48.817

Wildfly 版本 10.0.1 我正在运行非集群 Wildlfy 设置。我有 2 个 Wildlfy 实例已经在运行，并在遇到错误时尝试部署第 3 个。我不得不停止其他两个实例，然后再试一次，wildfly 部署成功完成。

# c++ - 指针类型转换改变意外内存

> ID：14268142
> 
> 赞同：0
> 
> 时间：2013-01-10T22:06:55.243
> 
> 标签：c++

```
#define ARRAY_SIZE 20

float DataSource[ARRAY_SIZE];

void Read(unsigned char const *Source, unsigned char *Destination, unsigned long DataSize)
{
  for ( unsigned long i = 0; i < DataSize; i++)
  {
    *(Destination + i*DataSize) = *(Source + i*DataSize);
  }
}

void fun()
{
  int Index;
  float Dest;

  for ( Index = 0; Index < ARRAY_SIZE; Index++ )
  {
    Read((unsigned char *)&DataSource[Index], (unsigned char *)&Dest, sizeof(DataSource[Index]));
  }
} 
```

我在上面的代码中遇到问题，在调用 Read() 时，我的 Index 变量被覆盖，我确信丑陋的指针转换是罪魁祸首，但我无法准确理解这里发生的事情。

unsigned char 指针类型是强制性的，因为上面的代码旨在模拟一些驱动程序级别的软件并保持相同的原型。

有人可以帮我理解这里的问题吗？除了 Read() 的原型之外，上述所有代码都是可以更改的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:12:20.593

错误在这里：

```
for ( unsigned long i = 0; i < DataSize; i++)
{
  //              vvvvvvvvvv               vvvvvvvvvv
  *(Destination + i*DataSize) = *(Source + i*DataSize);
} 
```

`i * DataSize`总是大于`i`=>“越界”访问。

用。。。来代替：

```
for ( unsigned long i = 0; i < DataSize; i++)
{
  *(Destination + i) = *(Source + i);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T22:12:39.697

您将单个`float`的地址传递给`Read` ( `&Dest`)，然后继续将许多值写入连续的内存位置。由于此时您正在编写随机内存，因此它不太可能被覆盖`index`（和其他内容），因为堆栈通常会向下增长。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:28:20.357

一种有趣的（对我而言）C++ 方式。

```
template<typename Data>
struct MemBlockRefHelper {
  typedef Data value_type;
  Data* data;
  size_t size;
  MemBlockRefHelper( Data* d, size_t s):data(d), size(s) {}

  template<typename Target, typename Other=typename Target::value_type>
  Target& Assign( MemBlockRefHelper<Other> const& other ) {
    Assert(size == other.size);
    for (size_t i = 0; i < size; ++i) {
      if (i < other.size) {
        data[i] = other.data[i];
      } else {
        data[i] = 0;
      }
    }
    Target* self = static_cast<Target*>(this);
    return *self;
  }

};
struct MemBlockRef;
struct MemBlockCRef:MemBlockRefHelper<const unsigned char> {
  MemBlockCRef( const unsigned char* d, size_t s ):MemBlockRefHelper<const unsigned char>( d, s ) {}
  MemBlockCRef( const MemBlockRef& other );
};
struct MemBlockRef:MemBlockRefHelper<unsigned char> {
  MemBlockRef( unsigned char* d, size_t s ):MemBlockRefHelper<unsigned char>( d, s ) {}
  MemBlockRef& operator=( MemBlockRef const& other ) {
    return Assign< MemBlockRef >( other );
  }
  MemBlockRef& operator=( MemBlockCRef const& other ) {
    return Assign< MemBlockRef, const unsigned char >( other );
  }
};
inline MemBlockCRef::MemBlockCRef( const MemBlockRef& other ): MemBlockRefHelper<const unsigned char>( other.data, other.size ) {}

void Read( unsigned char const* Source, unsigned char* Dest, unsigned long DataSize ) {
  MemBlockCRef src( Source, DataSize );
  MemBlockRef dest( Dest, DataSize );
  dest = src;
} 
```

大规模过度设计，但想法是总结一定大小的 POD 内存块的想法，并为其内容提供引用语义（初始化是创建对相同数据的新引用，赋值对引用的数据进行复制到数据）。

一旦你有了这样的类，代码就`Read`变成了 3 行。好吧，您可以一次性完成：

```
 MemBlockRef( Dest, DataSize ) = MemBlockCRef( Source, DataSize ); 
```

但这是不必要的。

好吧，这就是整个框架。

但写下来我觉得很有趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T22:12:55.017

这是错误的：

```
*(Destination + i*DataSize) = *(Source + i*DataSize); 
```

你想复制`DataSize`相邻的字节，而不是`DataSize`分开的字节（总跨度`DataSize*DataSize`）

说啊

```
Destination[i] = Source[i]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T22:32:26.613

`Dest`您正在将内部声明的标量变量`fun()`视为内部数组`Read()`。似乎两者`Dest`和您的`Index`变量都相邻放置在堆栈上，这解释了`Index`当内部循环执行时恰好被覆盖`Read()`for `i==1`。

所以解决方案是：也声明`Dest`为数组：

```
float Dest[ARRAY_SIZE]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-10T22:15:16.883

让我们仔细看看您的`Read()`：i 从 0 变为 DataSize-1；每次您以 i*DataSize... 的偏移量访问内存时，即从 0 到 DataSize*(DataSize-1) 的偏移量。看起来不对，因为`DataSize**2-DataSize`没有意义。

与其他答案不同，我不想猜测您想要什么。只是展示一种“维度分析”，可以帮助发现代码中最错误的部分，*而无需*阅读作者的想法。

# c# - TDD - 提取接口或使方法虚拟化

> ID：14268150
> 
> 赞同：2
> 
> 时间：2013-01-10T22:07:49.023
> 
> 标签：c#, tdd

每当我想在一个平凡的类中存根一个方法时，我最常提取一个接口。现在，如果该类的构造函数是公共的并且不是太复杂或不依赖于复杂类型，那么将相关方法设置为虚拟并继承将具有相同的效果。这比提取接口更可取吗？如果是这样，为什么？

编辑：

```
class Parser
{
    public IDictionary<string, int> DoLengthyParseTask(Stream s)
    {
        // is slow even with using memory stream
    }
} 
```

有两种方法：提取接口或使方法虚拟化。我实际上更喜欢接口，但这可能会导致`IParser` `Parser`元组爆炸......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T22:11:36.343

您需要考虑在单元测试之外要完成的工作。**不要**让你的工具支配你的设计。

处理接口有助于解耦代码，但这些应该是代码中的自然分离点（例如业务逻辑或数据访问）。如果您要继承和覆盖这些方法，则将方法设为虚拟是有意义的。

在*你的情况下*，我会尝试直接测试使用的**行为**`DoLengthyParseTask`而不是方法。这也将提供更强大的测试套件。您需要仔细考虑此方法是否真的需要[**公开**](http://msdn.microsoft.com/en-us/library/yzh058ae.aspx)（这意味着它可以并且*应该*在其自己的程序集之外引用）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T22:20:08.653

接口只是为你订立一个契约，基本上是一个承诺，即你的实现将提供对一组指定的接触点（方法、属性等）的访问，而没有行为规范。只要你信守承诺，你就可以为所欲为。

另一方面，除了契约之外，基类至少指定了类中编码的一些行为（除非一切都是抽象的，但那是另一回事了）。使方法虚拟化仍然使您能够调用基的实现，并且仍然提供您自己的代码。

这种行为的继承基本上是现代 OOP 中禁止多继承的原因，多接口实现比较普遍。

也就是说，您需要权衡您是否只是想提取合同，或者您也想提取一些行为，并且对于特定情况，答案应该是显而易见的。

至于`IParser`/`Parser`对，首先它们非常适合单元测试和依赖注入，其次，它们不会向您收取创建类的费用，因此您可以随意创建任意数量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T22:19:20.537

通过对接口进行编程，您可以获得单元测试中易于模拟/存根和松散耦合代码的好处（因此，更高的灵活性），实际上**是免费**的（唯一的缺点是要管理更多的*工件*）。

接口和继承是两个独立的东西，即使可以互换使用它们也不是一个好主意。通过标记方法`virtual`，您实际上是在告诉其他人，他们不仅可以在他们的实现中**自由更改**（覆盖）此方法，而且您实际上**希望他们这样做**（并且您是吗？）。

这样的设计带来了相当严重的后果，所以除非你明确需要它 - 你不应该使用它。尝试坚持编程接口。

良好的面向对象设计原则之一表明您应该对接口进行编程（*按合同设计*，[Liskov 替换原则](http://en.wikipedia.org/wiki/Solid_%28object-oriented_design%29)）并且更喜欢[组合而不是继承](http://en.wikipedia.org/wiki/Composition_over_inheritance)（不仅您的类应该实现接口/抽象类，而且还应该包含这样的实现）。

值得注意的是，您的`Parser`示例非常适合隐藏在抽象后面（无论是接口还是基类）。从消费者的角度来看，如何创建数据并不重要——现在您可能认为它只是 XML 流，但需求往往会发生变化（和/或增长），您可能很快就会发现自己正在实现二进制文件解析器，数据流挖掘解析器和其他什么。现在就做好，以后省时省事。

# c# - 将图像渲染为 pdf 是模糊的

> ID：14268154
> 
> 赞同：3
> 
> 时间：2013-01-10T22:08:11.100
> 
> 标签：c#, ios, pdf, pdfsharp

我一定做错了什么。我尝试将图像渲染为 PDF 到 iOS 中的 pdfContext 和使用 PDFSharp 的 PDF。当我这样做时，与我在 Photoshop 或 Microsoft 的图片预览中打开它时相比，它是模糊的。所以也许我不明白图像本身发生了什么。这是我所知道的：

图像尺寸为 90 x 20 (wxh)。分辨率为 264 ppi。

要在 PDFSharp 中绘制它，我会：

```
XImage image = XImage.FromGdiPlusImage(Properties.Resources.logo);
gphx.DrawImage(image, leftStartDefault, 50, image.PointWidth, image.PointHeight); 
```

我也在上面的代码中尝试过 image.PixelWidth, image.PixelHeight。两者都产生相同的模糊结果。

在 iOS 中，我会

```
UIImage *logo = [UIImage imageNamed:@"logo.png"];
[logo drawInRect:CGRectMake(self.frame.size.width - 90 - 60, 20, 90, 20)]; 
```

两者都会产生模糊的结果。我不确定为什么。我不知道如何选择要绘制的尺寸是否是我所缺少的。如果我需要向我们的图形艺术家索要不同分辨率/尺寸的图像，或者这是我进行绘图调用的方式。如果我以一半大小绘制图像，它会更清晰。

例如

```
gphx.DrawImage(image, leftStartDefault, 50, 45, 10); 
```

有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-09T15:26:12.150

我意识到这是旧的，也许不再是问题，但我遇到了同样的问题。

我在 PDFSharp 论坛上发现[了这个线程，它很有用。](http://forum.pdfsharp.net/viewtopic.php?f=2&t=1811)

据我所知，绘画中图像上的 x 像素不会以相同的方式转移到 pdf 上图像中的 y 像素（至少在我的情况下）。拥有`100x100px`in paint 的图像会将相同的图像应用于大约`153x153px`. 我完全不知道为什么会发生这种情况，但是一旦我弄清楚了图像大小增加的因素，“调整”图像以在 pdf 上打印就变得很简单了。

像这样：

```
gfx.DrawImage(logo, 0, 0, ApplyTransform(logo.PointWidth), ApplyTransform(logo.PointHeight));

private static double ApplyTransform(double previous)
{
    return previous * .6538;
} 
```

编辑：经过进一步研究，我认为这是由于 pdf 文档首先没有像素的概念造成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-11T03:38:39.487

可能，PDF 光栅化库使用不同于 Photoshop、Windows Viewer ...**图像插值算法**，这些算法错误地应用于结果视图。他们还使用了不同的[ICC](http://en.wikipedia.org/wiki/ICC_profile)配置文件，这也会影响渲染。

# css - 选择最后 3 个子元素

> ID：14268156
> 
> 赞同：67
> 
> 时间：2013-01-10T22:08:31.010
> 
> 标签：css, css-selectors

我知道您可以选择最后一个孩子`:last-child`或某个孩子`:nth-child`（如果您知道他们的位置/编号）。

我需要的是在不知道可能有多少子元素的情况下选择最后 3 个子元素。

我知道有一些东西叫做`:nth-last-child` ，但我真的不明白它是如何工作的。

为了这：

```
<div id="something">

    <a href="images/x.jpg"  ><a/>
    <a href="images/x.jpg"  ><a/>
    <!-- More elements here -->
    <!-- ..... -->
    <!-- I need to select these: -->
    <a href="images/x.jpg"  ><a/>
    <a href="images/x.jpg"  ><a/>
    <a href="images/x.jpg"  ><a/>

</div> 
```

我需要这样的东西：

```
#something a:last-child{
   /* only now it selects the last <a> and the 2 <a>'s that come before*/ 
} 
```

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2013-01-10T22:14:21.253

[你可以在这里](http://reference.sitepoint.com/css/pseudoclass-nthlastchild)阅读更多关于 nth-last 孩子的信息，但这基本上应该可以使用 CSS 选择最后 3 个孩子

```
#something a:nth-last-child(-n+3) {
    /*declarations*/
} 
```

**Fabrício Matté的**[小提琴](http://jsfiddle.net/6BV3K/)演示

 **这只会选择那些为 out N 表达式 (-n+3) 返回正数的行，并且由于我们使用的是 nth-last-child，它从最后一个到第一个计数，所以从底部开始的第一行给出，

```
f(n) = -n+3
f(1) = -1+3 = 2 <- first row from the bottom
f(2) = -2+3 = 1 <- second row from the bottom
f(3) = -3+3 = 0 <- third row from the bottom 
```

其他一切都将返回一个负数

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-10T22:11:44.237

这可以通过 CSS3 选择器和[公式](http://css-tricks.com/useful-nth-child-recipies/)实现：

```
.something a:nth-last-child(-n+3) { ... } 
```

您还可以尝试[使用 jQuery（示例）](https://stackoverflow.com/questions/1948152/select-last-5-elements-with-jquery)或在服务器端代码的最后三个元素中添加特定类（它不需要在浏览器中启用 JavaScript，也适用于不支持 CSS3 的旧浏览器）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-01-31T14:54:04.523

接受的答案有正确的公式，但解释是错误的。

所以正确的 CSS 是（与当前接受的答案相同）：

```
#something a:nth-last-child(-n+3) {
    /*declarations*/
} 
```

但这里是数学的正确解释：

```
f(n) = -n+3
f(0) = -0+3 = 3 <- 3rd row from the bottom
f(1) = -1+3 = 2 <- 2nd row from the bottom
f(2) = -2+3 = 1 <- 1st row from the bottom
f(3) = -3+3 = 0 <- nothing
f(3) = -4+3 = -1 <- nothing
etc... 
```**

# linq-to-objects - 将此 Linq 代码转换为常规/非 linq 代码

> ID：14268159
> 
> 赞同：1
> 
> 时间：2013-01-10T22:08:38.493
> 
> 标签：linq-to-objects

我是 Linq 的新手，并且正在研究完全相反的某人的代码。他在下面写了这段代码。我理解代码，但谁能告诉我是否可以用几乎相同数量的代码将此代码转换为非 linq

```
public static AType MyFunction() 
{
          return new AType 
          {
              PropertyOfAType = SomeIEnumerable.Select(r => new BType
              {
                  Property1OfBType =  r.GetData(5),
                  Property2OfBType =  r.GetData(6)

              }).ToArray()
          };

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-03T23:50:30.440

```
 public static AType MyFunction()
    {
        AType aType = new AType();
        List<BType> bTypes = new List<BType>();
        foreach (var r in SomeIEnumerable)
        {
            bTypes.Add(new BType
            {
                Property1OfBType = r.GetData(5),
                Property2OfBType = r.GetData(6)
            });
        }
        aType.PropertyOfAType = bTypes.ToArray();
        return aType;
    } 
```

# vb.net - 从隔离存储和应用程序目录绑定图像

> ID：14268163
> 
> 赞同：2
> 
> 时间：2013-01-10T22:08:49.800
> 
> 标签：vb.net, windows-phone-7, listbox, isolatedstorage

在我的 WP7 应用程序中，我有一个包含图像的列表框。我在我的应用程序中包含了几个图像，但如果找不到图像，则应从 Internet 检索它，然后当然将其存储在独立存储中。现在我有 1-2 个问题：1）在初始应用程序启动时，我是否应该将所有图像复制到独立存储中，以便独立存储包含所有图像（因此应用程序图像文件夹中的图像可用两次：在应用程序图像目录和隔离存储）？2) 列表框中是否可以在一种情况下显示来自 IsoloatedStorage 的图像，另一种情况下来自应用程序文件目录？

非常感谢！

欢迎使用 PS 代码示例，尤其是在 vb.net 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T20:23:32.930

1 - 不。为什么要浪费时间和存储空间？

2 - 可能的解决方案 - 编写一个实现 IValueConverter 的类。在您的 Convert 方法中，如果值为 Uri，且 IsAbsoluteUri=true 且 Scheme="isostore"，您从独立存储中读取文件，并返回 BitmapImage，[如此处所述](http://www.j2i.net/blogEngine/post/2011/09/03/Displaying-an-Image-from-Isolated-Storage.aspx)。否则，您只需从 Convert 方法返回未转换的值。并且，您在绑定中指定您的转换器。

抱歉，我没有要分享的代码示例。

PS 对于您的任务，我推荐一个名为“ [Kawagoe Toolkit](http://kawagoe.codeplex.com/) ”的 3-rd 方库。唯一的缺点是许可证要求您在“关于”页面中提及它们。如果使用 Kawagoe，您可以只定义一个属性“imageSource”返回对象，并返回来自资源/XAP 的图像的 Uri，或者延迟加载从 Kawagoe 的 ImageCache.Default.Get() 方法获得的 ImageSource 对象，该方法最终会从要么是互联网的孤立商店。他们已经拥有您需要的下载和缓存代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T10:09:15.287

1.  是的，你最好复制它们以统一位置。
2.  做什么的 ？仅显示来自 IsolatedStorage 的图像。初始图像被复制到那里，新图像从互联网上下载并放到IsolatedStorage（当然你必须编写这段代码）。

# bash - 使用 sed 在大量文件中搜索特定字符串并替换它

> ID：14268170
> 
> 赞同：2
> 
> 时间：2013-01-10T22:09:20.063
> 
> 标签：bash, sed

我正在尝试做的是在大量源文件中搜索特定模式，并在该模式的基础上放入另一个表达式。我正在查看的文件都具有相同的扩展名 *.F90。我的第一步是使用 grep 并找到那些包含分配但未分配的文件的所有行，所以我有：

```
grep –I “ allocate *(” *.F90 | grep –v allocated 
```

我遇到的第一个问题是括号前面可能有一个或多个空格。我可以有

```
 allocate( 
 or allocate ( 
 or allocate  ( 
```

这就是为什么我需要 grep 命令中的“*”。然而，一般规则（除了空格）说分配后跟“（”，然后是被分配的东西。所以我有：

```
allocate ( array_name ( .... 
```

再次，空格是可选的所以我想做的是找到这个字符串，并在它前面放置以下内容：

```
If( allocated(array_name) ) deallocate(array_name) 
```

在这之后的下一行我想要原始字符串`allocate(array( … .`

请注意，array_name 是一个字母数字字符串，替换后出现在多个位置。它是被分配的数组的名称。如果有人能给我提示如何做到这一点，我将不胜感激。我被卡住了，不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:28:27.127

我假设您的意思是要替换`allocate ( array_name )`为`If( allocated(array_name) ) deallocate(array_name) allocate ( array_name )`.

在 GNU 或 BSD sed 中，您可以执行以下操作：

```
sed -i.bk -e '/allocated/t' \
  -e 's/allocate *( *\([A-Za-z0-9_]*\) *)/If( allocated(\1) ) deallocate(\1) &/' \
  *.F90 
```

这将搜索和替换 *.F90 中的匹配行并使用`allocated`on 跳过行。原始文件将被称为 *.F90.bk。

正如@Anders Johansson 提到的，在其他情况下，分配的参数不是字母下划线，那么您可以在搜索和替换之前搜索它：

```
for i in *.F90; do
    echo "$i"
    sed -n '/.*allocate *( *\([^ )]*\) *).*/{h; s//\1/; /^[A-Za-z0-9_]*$/t
        x; p;}' "$i"
done 
```

（注意 之后的换行符`t`，BSD sed 将 t 之后的所有内容解释为标签）。在 bash 中按 ctrl+v ctrl+j 在命令行中输入换行符。

*   `/a\(b\)c/`找到匹配字符串的行
*   `h`*h*将比赛`abc`保存到保持空间
*   `s//\1/`*s*`abc`用第一组替换最后一场比赛`b`
*   /^[az]*$/t 如果`b`匹配`^[a-z]*$`，则跳转到脚本末尾
*   `x`e*x*更改保持空间`abc`和模式空间`b`
*   `p`*p*打印图案空间`b`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:36:52.160

```
cat old_file.txt | sed 's/allocate *( *\([a-zA-Z0-9_]*\)/If( allocated(\1) ) deallocate(\1)\
allocate(\1/' > new_file.txt 
```

# database - 结合读取速度和数据完整性的 NoSQL 数据库

> ID：14268172
> 
> 赞同：3
> 
> 时间：2013-01-10T22:09:32.150
> 
> 标签：database, nosql, solution, schemaless

是否有任何 NoSQL 数据库或“即用型解决方案”结合了应用程序需要的**复制数据以****实现快速读取**和数据关系的数据完整性以及**自动分配**对复制数据的更改？

**例子：**

*实体：*

```
Topic
  - id
  - title
  - first_comment_id

Comment
  - id
  - topic_id
  - text 
```

*文档/物化视图：*

```
TopicList
  - topic_id
  - topic_title
  - first_comment_text 
```

当我更改主题标题时，更改将分发到数据库层包含此属性的每个文档。所以完整性将由数据库管理。

我真的很喜欢 MongoDB 的无模式行为，所以 Oracle 或其他关系数据库不是解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T04:33:31.943

我在 Mongo 和加入实体/文档方面有一些经验，所以我会为此提供答案。您可以在 Mongo 中创建输出到集合的 map/reduce 查询。这种行为非常好，并且避免了在“准备好”之前从新创建的集合中读取的问题（在 map/reduce 完成运行之前等）

为了保持该集合的更新，我使用了一个外部进程按计划发出 map/reduce 函数。它允许您对查询更加随意。

我想这也将管理一致性，因为每个实体都是权威的，当临时集合再次生成时，您会看到更改。当然，需要注意的是它不是实时的。

# c++ - 使用 Eclipse CDT 进行 Pintool 开发

> ID：14268175
> 
> 赞同：1
> 
> 时间：2013-01-10T22:09:41.197
> 
> 标签：c++, c, eclipse, eclipse-cdt

所以，我有一些需要用 pintools 开发的东西，而且我很难用 eclipse 来处理它。

我找到[了这个](http://tech.groups.yahoo.com/group/pinheads/message/7226)，但它没有提供非常具体的细节。我希望有人可以提供有关如何在 Mac（或 linux）上使用 eclipse 开发 pintools 的非常具体的说明。

我试了一下，发现在mac上你必须安装clang构建工具链，即使那样，做一个简单的MyPinTool导入比看起来更难，因为makefile指定了很多我没有的额外选项/变量'不知道如何最好或正确地在 eclipse 中配置。

你可以下载pintools。我正在谈论的 makefile 位于 source/tools/MyPinTool 中，它获取位于 tools/makefile.gnu.config 的文件

编辑：顺便说一句，我在 Mac OS X Lion 上使用 pin 2.12 使用 i7

`c++ --version`返回这个：

> Apple clang 4.1 版（tags/Apple/clang-421.11.66）（基于 LLVM 3.1svn）目标：x86_64-apple-darwin11.4.2 线程模型：posix

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T10:28:13.767

我猜您正在使用最新版本的 Eclipse (4.2)，并且您从“源/工具”中的模板 MyPinTool pintool 开始工作。我会接受这些猜测，因为配置 CDT 以从编译工具识别引脚环境要容易得多，而不是手动配置它。

首先从现有源创建一个 makefile 项目： ![在此处输入图像描述](../Images/66b9f8013488804e11d9e664eea18683.png)

然后转到您的项目属性并在“C/C++ General”->“Preprocessor Include...”下选择“CDT GCC build output parser”，确保它已启用，如果您使用 clang++ 作为编译器，那您将其添加到编译器模式中： ![在此处输入图像描述](../Images/43024376e3951a1d1a6d64052ba6cfed.png)

现在从 Eclipse 中构建您的 pintool（单击工具栏中的锤子图标，或右键单击您的项目并选择“构建项目”）。CDT 应该解析构建输出并从中解析所有路径和所需的宏。基本上，现在你可以走了……但是……

我发现 CDT 有一些怪癖，如果这不起作用，请尝试执行以下操作：

1.  检查您是否正在使用“深层”路径 (/a/b/c/d/e/f/g/h/i/j/k/l/m)，有时 CDT 会采用make 文件，并将其转换为错误的绝对路径。我发现在“较浅”的路径中工作可以解决这个问题（我应该为此打开一个错误报告......）。
2.  有时索引器不会立即启动。尝试刷新项目，重建索引（右键单击项目然后“索引”->“重建”），甚至重新启动 eclipse 然后再次执行此操作。

我知道这有点巫术魔法，但我让它工作了:)

我使用 MyPinTool 在新工具包上测试了此过程，但如果仍然无法正常工作，请提供您执行的步骤以及 eclipse 给您带来的错误。

# xcode - 存储首次使用 iPad 应用程序的用户信息

> ID：14268178
> 
> 赞同：0
> 
> 时间：2013-01-10T22:10:00.617
> 
> 标签：xcode, ipad, ios6

我正在编写一个应用程序并希望执行以下操作：首次使用该应用程序时，它会提示用户输入购买时提供的用户名。输入后，它会被存储并且无法更改。

我不确定这是否可行，或者我应该使用什么方法来存储它。我认为这是 KeyChain 的一个是正确的？

非常感谢任何建议。

# python-2.7 - 时间戳系列的 Pandas.Series.map 函数的奇怪之处

> ID：14268179
> 
> 赞同：1
> 
> 时间：2013-01-10T22:10:00.523
> 
> 标签：python-2.7, pandas

在 panda.Series 上应用函数时发生了一些奇怪的事情

```
In [508]: id = lambda x : x
In [509]: tt = lambda x : type(x)
In [510]: timeSeries
Out[510]: 
0   1900-01-01 20:11:49.075690
1   1900-01-01 20:11:49.082546
2   1900-01-01 20:11:52.535287
3   1900-01-01 20:11:52.535372
4   1900-01-01 20:11:52.535528
Name: timeSeries

In [511]: timeSeries.map(id)
Out[511]: 
0    1969-12-06 172:11:49.075690
1    1969-12-06 172:11:49.082546
2    1969-12-06 172:11:52.535287
3    1969-12-06 172:11:52.535372
4    1969-12-06 172:11:52.535528
Name: timeSeries 
```

此处时间戳已通过应用 id 函数更改新时间中的小时不正确。更多：类型也改变了

```
In [513]: type(timeSeries[0])
Out[513]: pandas.lib.Timestamp

In [512]: timeSeries.map(tt)
Out[512]: 
0    <type 'numpy.datetime64'>
1    <type 'numpy.datetime64'>
2    <type 'numpy.datetime64'>
3    <type 'numpy.datetime64'>
4    <type 'numpy.datetime64'>
Name: timeSeries 
```

我认为只要保留它们映射到的时间戳，类型更改就可以了

```
In [515]: np.datetime64(timeSeries[0])
Out[515]: 1900-01-01 20:11:49.075690 
```

有人可以解释一下这里发生了什么吗？我想做一个带有自定义功能的地图，我期待 pandas.lib.Timestamp 类型。或者是否有办法将 np.datetime64 转换为有效时间。

编辑：以下工作将 np.datetime64 转换回时间戳。上面的内容仍然很奇怪。

```
In [528]: pd.lib.Timestamp(time2[0])
Out[528]: <Timestamp: 1900-01-01 20:11:49.075690>
In [529]: time2[0]
Out[529]: 1969-12-06 172:11:49.075690 
```

我的猜测是关于 np.datetime64 与 pandas.lib.Timestamp 之间的内部格式差异？

# spring - Spring Security @PreAuthorize - 使用 Spring EL 限制某些角色

> ID：14268180
> 
> 赞同：3
> 
> 时间：2013-01-10T22:10:01.887
> 
> 标签：spring, spring-mvc, spring-security

使用 Spring Security 3.1.3.RELEASE

因此，如果有一个角色列表（超过 10 个）并且只需要阻止一个角色访问 Spring Controller 方法。这可以使用 Spring 表达式语言来完成，并且避免列出每个非常受欢迎的角色吗？

例如，通过包含 Not 符号。

> @PreAuthorize("!hasRole('ROLE_FREE_USER')")

像这样列出所有角色

> @PreAuthorize("hasAnyRole('ROLE_ADMIN','ROLE_PAID_USER','ROLE_PREM_USER',...)

我在这里查看了文档：http: [//static.springsource.org/spring-security/site/docs/3.0.x/reference/el-access.html](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/el-access.html)

但是在 NOT EQUAL to case 上似乎没有任何内容。任何人都面临类似的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:37:11.327

I'm pretty sure that NOT-sign (`!`) is supported in Spring Expression Language (SPEL). Naturally, it returns a `boolean` result.

An Example from the [official documentation](http://static.springsource.org/spring/docs/3.0.0.RELEASE/reference/html/expressions.html#d0e11564):

```
// evaluates to false
boolean falseValue = parser.parseExpression("!true").getValue(Boolean.class);

// -- AND and NOT --
String expression =  "isMember('Nikola Tesla') and !isMember('Mihajlo Pupin')";
boolean falseValue = parser.parseExpression(expression).getValue(societyContext, Boolean.class); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-09T11:47:07.940

在这种情况下，Spring 表达式语言对我不起作用。最初我尝试了以下内容，

```
@RequestMapping("/post/edit")
        @PreAuthorize("hasRole('ROLE_OWNER') AND !hasRole('ROLE_ADMIN')")
        public String editPost(Model model, Principal principal,  HttpServletRequest request, @RequestParam("postId") String postId) {
    } 
```

但是，如果用户具有管理员权限，我必须从方法内部重新检查角色并重定向页面。

```
@RequestMapping("/post/edit")
    @PreAuthorize("hasRole('ROLE_OWNER')")
    public String editPost(Model model, Principal principal,  HttpServletRequest request{

        //Admin Users does not have access to post edit page
        if (request.isUserInRole("ROLE_ADMIN")) {
            return TemplateNamesConstants.POST_WALL;
        }
} 
```

如果您找到更好/替代的解决方案，请更新此线程。

# java - 如何使用java比较两个xml文件

> ID：14268197
> 
> 赞同：3
> 
> 时间：2013-01-10T22:11:02.870
> 
> 标签：java, xml, diff

我有两个要比较的 xml 文件：

**旧的.xml：**

```
<EMPLOYEES>
  <employee>
    <id>102</id>
    <name>Fran</name>
    <department>  THIS IS COMPUTER DEPARTMENT  </department>
  </employee> 
  <employee>
    <id>105</id>
    <name>Matthew</name>
    <department> THIS IS SCIENCE AND TECHNOLOGY </department>
  </employee> 
</EMPLOYEES> 
```

**新的.xml：**

```
<EMPLOYEES>
  <employee>
    <id>105</id>
    <name>Matthew</name>
    <department>  THIS IS SCIENCE AND TECHNOLOGY **Modified *** </department>
  </employee> 
  <employee>
    <id>106</id>
    <name>xyz</name>
    <department> THIS IS SCIENCE AND TECHNOLOGY </department>
  </employee>
  <employee>
    <id>107</id>
    <name>Francis</name>
    <department>  THIS IS XYZ  </department>
  </employee>
</EMPLOYEES> 
```

我想比较这两个文件并返回添加、删除或更新了哪些记录。 `old.xml`包含 2`<employee>`条记录并`new.xml`包含 3`<employee>`条记录。

**我希望结果是这样的：**

**添加记录** 2：例如：-employee.id=106 和employee.id=107

**已删除记录** 1：例如：-employee.id=102

**更新记录** 1：ex:-employee.id=105 更新为 ----

区分这两个 XML 文件以获得这些结果的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:14:34.707

这听起来类似于[Best way to compare 2 XML documents in Java](https://stackoverflow.com/questions/141993/best-way-to-compare-2-xml-documents-in-java)。我建议检查 XMLUnit：

[http://xmlunit.sourceforge.net/](http://xmlunit.sourceforge.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T02:53:28.960

我会做什么

```
@XmlRootElement
class Employees {
    List<Employee> list;
}

class Employee {
    int id;
    String name;
    String department;
} 
```

解组 xml。创建 2 个地图并执行以下操作

```
 Map<Integer, Employee> map1 = ...
    Map<Integer, Employee> map2 = ...
                // see Map.retainAll API
    map1.keySet().retainAll(map2.keySet());
    // now map1 contains common employees
    for (Integer k : map1.keySet()) {
        Employee e1 = map1.get(k);
        Employee e2 = map2.get(k);
        // compare name and department
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T11:02:04.280

对于逻辑差异，即两个xml文件中对应节点的差异，可以使用节点类的isEqualNode(Node node)方法。

对于逐行比较，扫描仪易于使用。示例代码 -

```
 public void compareFiles (Scanner file1, Scanner file2) {
                String lineA ;
                String lineB ;

                int x = 1;

                    while (file1.hasNextLine() && file2.hasNextLine()) {
                        lineA = file1.nextLine();
                        lineB = file2.nextLine();

                        if (!lineA.equals(lineB)) {
                            System.out.print("Diff " + x++ + "\r\n");
                            System.out.print("< " + lineA + "\r\n");
                            System.out.print("> " + lineB + "\r\n");
                        }
                    }

            } 
```

# html - 2 个 div 50% 内联块不相邻

> ID：14268203
> 
> 赞同：3
> 
> 时间：2013-01-10T22:11:28.873
> 
> 标签：html, css

我对这个盒子模型有疑问。我只遇到了 Blackberry 4.6 的问题，但它也发生在 jsbin/jsfiddle 上。这 2 个 div 应该是 50%，因此彼此直接相邻，但最后一个正在崩溃。

**jsbin：http:** [//jsbin.com/oyujof/1/edit](http://jsbin.com/oyujof/1/edit)

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T22:13:49.380

当涉及内联和内联块元素时，空格很重要。删除或注释掉 div 之间的空格。

澄清：空格是换行符和 div 之间的空格：

```
 </div>\n
  __<div class="nav-button"> 
```

当您使用 inline 或 inline-block 时，这些将呈现为单个空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:15:45.543

空白有宽度，所以你的总布局是 50% + space_width + 50%, > 100% 所以第二个 div 中断。删除空格，或将宽度设置为 49%。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:18:38.603

虽然`float`可能会出现问题，但在这种情况下使用浮点数很简单，并且可能是您在清理空白和/或 49% 不是一个选项时的唯一选择。

```
.nav-button {
  float: left;
  display: block;
  width: 50%;
} 
```

**更新 jsbin：http:** [//jsbin.com/oyujof/23/](http://jsbin.com/oyujof/23/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T22:19:22.117

您只需要指定规则`.nav-to`以及将`.nav-button`它们浮动到左边。这是用您提供的 HTML 修复它的 CSS：

```
.nav-to {
        width: 50%;
        float:left;
    .nav-button {
        width: 50%;
        float:left;

        &:last-child {
            text-align: right;
        }
    }
} 
```

[http://jsbin.com/oyujof/32/edit](http://jsbin.com/oyujof/32/edit)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-10T22:16:51.130

这可能不是最好的答案，但如果您将每个设置为 49%，而不是 50%，那么它会起作用。

# dart - 遍历dart中的JSON数据？

> ID：14268212
> 
> 赞同：0
> 
> 时间：2013-01-10T22:12:16.110
> 
> 标签：dart

在尝试了很多之后，很抱歉问了这么一个微不足道的问题。

下面给出的屏幕截图包含我从服务器成功接收的数据。 ![在此处输入图像描述](../Images/189756ade767ce391c2c3ccd6122a1a4.png)

我想知道如何遍历数据，因为每当我尝试将其转换为某些东西并尝试使用 foreach 时，它都会出错。

从服务器发送的实际数据是 List() 类型。

我想知道如何将它转换为相同的类型并在这里使用它。

我尝试铸造，但它在这里说意外的令牌。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:40:54.733

[JSON.parse](http://api.dartlang.org/docs/releases/latest/dart_json/JSON.html#parse)返回类型取决于`String`您尝试解析的内容。请参阅文档：

> 解析`json`并构建相应的解析 JSON 值。
> 
> 解析的 JSON 值的类型为`num`, `String`, `bool`, `Null`, `List`s 解析的 JSON 值或`Map`s from`String`到解析的 JSON 值。

从您的屏幕截图中，返回值似乎是一个列表。您可以执行以下操作来使用它（您是否注意到注释代码中的错字 - `.fore`）：

```
final parsedList = JSON.parse(e.data)/*.fore*/;
parsedList.forEach((x){
  query('#idData').appendText(x[0]);
  query('#idData').appendText(x[1]);
  query('#idData').appendText(x[2]);
  query('#idData').appendText(x[3]);
}); 
```

# extjs - ExtJS DateField 被选中时被空白

> ID：14268217
> 
> 赞同：3
> 
> 时间：2013-01-10T22:12:33.990
> 
> 标签：extjs, datefield

我有一个网格，其列配置为...

```
{
   ...
   editor:new Ext.form.DateField({format:'m/d/Y'}),
   renderer: function (val){return val ? Ext.util.Format.date(val, 'm/d/Y') : ''}
   ...
} 
```

它工作正常，除了当我单击一个单元格进行编辑时，该单元格会被空白而不是保持其现有值，直到我选择新的。如果单击单元格后我单击离开它，则该单元格为空。

知道什么会导致这种情况吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-31T11:17:30.180

我遇到了类似的问题，并通过设置解决了一些问题，`allowBlank: false`如下所示：

```
...
editor:new Ext.form.DateField({
    format:'m/d/Y',
    allowBlank: false
}),
... 
```

如果您在未选择新值的情况下单击日期字段外，这应该会将值重置为其原始值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T09:38:23.703

我原以为您希望您的列定义如下：

```
columns: [{
    xtype: 'datecolumn', 
    format: 'm/d/Y',
    editor: {
        xtype: 'datefield'
    }
}] 
```

我认为您不需要使用渲染器或使用 create 是您在示例中使用它

# delphi - 来自 TWebBrowser 的 HTML 源代码 - 如何检测流编码？

> ID：14268220
> 
> 赞同：4
> 
> 时间：2013-01-10T22:12:38.247
> 
> 标签：delphi, dom, character-encoding, delphi-7, twebbrowser

基于这个问题： [How can I get HTML source code from TWebBrowser](https://stackoverflow.com/questions/10091666/how-can-i-get-html-source-code-from-twebbrowser/10091894)

如果我使用具有 Unicode 代码页的 html 页面运行[此代码](https://stackoverflow.com/a/10091894/937125)，则结果是乱码，因为 TStringStream 在 D7 中不是 Unicode。该页面可能是 UTF8 编码或其他 (Ansi) 代码页编码的。

如何检测 TStream/IPersistStreamInit 是否为 Unicode/UTF8/Ansi？

对于此函数，我如何始终将正确的结果作为**WideString返回？**

```
function GetWebBrowserHTML(const WebBrowser: TWebBrowser): WideString; 
```

如果我用 TMemoryStream 替换 TStringStream，并将 TMemoryStream 保存到文件中，一切都很好。它可以是 Unicode/UTF8/Ansi。但我总是想将流返回为 WideString：

```
function GetWebBrowserHTML(const WebBrowser: TWebBrowser): WideString;
var
  // LStream: TStringStream;
  LStream: TMemoryStream;
  Stream : IStream;
  LPersistStreamInit : IPersistStreamInit;
begin
  if not Assigned(WebBrowser.Document) then exit;
  // LStream := TStringStream.Create('');
  LStream := TMemoryStream.Create;
  try
    LPersistStreamInit := WebBrowser.Document as IPersistStreamInit;
    Stream := TStreamAdapter.Create(LStream,soReference);
    LPersistStreamInit.Save(Stream,true);
    // result := LStream.DataString;
    LStream.SaveToFile('c:\test\test.txt'); // test only - file is ok
    Result := ??? // WideString
  finally
    LStream.Free();
  end;
end; 
```

* * *

编辑：我找到了这篇文章 - [How to load and save documents in TWebBrowser in a Delphi-like way](http://www.delphidabbler.com/articles?article=14&part=1)

这正是我需要的。但它仅适用于 Delphi Unicode 编译器 (D2009+)。阅读[结论](http://www.delphidabbler.com/articles?article=14&part=1#conclusion)部分：

> 显然我们可以做的还有很多。有几件事立刻浮现在脑海。我们将一些 Unicode 功能和对非 ANSI 编码的支持改进为预 Unicode 编译器代码。如果文档字符集不是 ANSI，则使用早于 Delphi 2009 的任何内容编译的当前代码将无法将文档内容正确保存为字符串。

魔术显然在`TEncoding`类（`TEncoding.GetBufferEncoding`）中。但D7没有`TEncoding`。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:59:24.643

我使用[GpTextStream](http://17slon.com/gp/gp/gptextstream.htm)来处理转换（应该适用于所有 Delphi 版本）：

```
function GetCodePageFromHTMLCharSet(Charset: WideString): Word;
const
  WIN_CHARSET = 'windows-';
  ISO_CHARSET = 'iso-';
var
  S: string;
begin
  Result := 0;
  if Charset = 'unicode' then
    Result := CP_UNICODE else
  if Charset = 'utf-8' then
    Result := CP_UTF8 else
  if Pos(WIN_CHARSET, Charset) <> 0 then
  begin
    S := Copy(Charset, Length(WIN_CHARSET) + 1, Maxint);
    Result := StrToIntDef(S, 0);
  end else
  if Pos(ISO_CHARSET, Charset) <> 0 then // ISO-8859 (e.g. iso-8859-1: => 28591)
  begin
    S := Copy(Charset, Length(ISO_CHARSET) + 1, Maxint);
    S := Copy(S, Pos('-', S) + 1, 2);
    if S = '15' then // ISO-8859-15 (Latin 9)
      Result := 28605
    else
      Result := StrToIntDef('2859' + S, 0);
  end;
end;

function GetWebBrowserHTML(WebBrowser: TWebBrowser): WideString;
var
  LStream: TMemoryStream;
  Stream: IStream;
  LPersistStreamInit: IPersistStreamInit;
  TextStream: TGpTextStream;
  Charset: WideString;
  Buf: WideString;
  CodePage: Word;
  N: Integer;
begin
  Result := ''; 
  if not Assigned(WebBrowser.Document) then Exit;
  LStream := TMemoryStream.Create;
  try
    LPersistStreamInit := WebBrowser.Document as IPersistStreamInit;
    Stream := TStreamAdapter.Create(LStream, soReference);
    if Failed(LPersistStreamInit.Save(Stream, True)) then Exit;
    Charset := (WebBrowser.Document as IHTMLDocument2).charset;
    CodePage := GetCodePageFromHTMLCharSet(Charset);
    N := LStream.Size;
    SetLength(Buf, N);
    TextStream := TGpTextStream.Create(LStream, tsaccRead, [], CodePage);
    try
      N := TextStream.Read(Buf[1], N * SizeOf(WideChar)) div SizeOf(WideChar);
      SetLength(Buf, N);
      Result := Buf;
    finally
      TextStream.Free;
    end;
  finally
    LStream.Free();
  end;
end; 
```

# nhibernate - NHibernate：处理空结果集上的 Select()

> ID：14268222
> 
> 赞同：0
> 
> 时间：2013-01-10T22:12:40.013
> 
> 标签：nhibernate, linq-to-nhibernate

当数据库中没有`Entity`记录时调用以下查询会引发`NotSupportedException`

```
var list = session.Query<Entity>()
                  .OrderBy(x => x.TranslationTime)
                  .Take(10)
                  .Select(x => x.TranslationTime)
                  .ToList(); 
```

删除`Select(x => x.TranslationTime)`可以很好地处理查询。

有没有办法让 NHibernate 即使在空结果集上也接受原始查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:44:24.760

`Take(10)`方法必须在方法之后`Select`：

```
var list = session.Query<Entity>()
                  .OrderBy(x => x.TranslationTime)
                  .Select(x => x.TranslationTime)
                  .Take(10)
                  .ToList(); 
```

# height - 无法达到 100% 的工作高度（阅读此处的大多数帖子并尝试了 1 个多小时）

> ID：14268227
> 
> 赞同：0
> 
> 时间：2013-01-10T22:13:00.663
> 
> 标签：height, css

很抱歉打扰这样一个*初学者的问题*，但我根本无法让这个 100% 高度的东西工作。这是情况（对不起，在本地开发所以没有链接）：

我有一个包含两个浮动元素的包装容器。我遵循了所有可能解决 100% 问题的步骤，例如：

```
html, body {
  height: 100%;
  background: url(../img/bg.png);
  font-family: 'SansationRegular', Helvetica;
}

.wrap {
  width: 100%;
  height: 100%;
  height: auto !important; (apparently this fixes the issue in Chrome)
  margin:40px 0px 0px 0px;
  padding:0;
} 
```

两个浮动 div（侧边栏和内容）的高度：100%，我还添加了第三个 div 容器来清除浮动元素。

不过，当我将内容添加到内容 div 时，侧边栏不会自动“增长”。我觉得我尝试了一切，但它不会奏效。

在这一点上，任何想法/提示都受到高度赞赏！:)

提前谢谢了！

PS 我也使用 Twitter Bootstrap 以帮助解决我的问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:36:51.463

Here's a basic example which shows how to do what you're trying to do. You should be able to take this code and adapt it to your own code.

[http://jsfiddle.net/QXZuy/1/](http://jsfiddle.net/QXZuy/1/)

```
<div class="wrap">
  <div class="sidebar"></div>
  <div class="content"></div>
</div>

html, body {
  height:100%;
}
.wrap {
  height:100%;
  width:100%;
  display:table;
  overflow:auto;
  background:#ccc;
}
.sidebar {
  display:table-cell;
  width:25%;
  background-color:blue;
}
.content {
  display:table-cell;
  width:75%;
  background-color:red;
} 
```

# ios - 有没有人找到使用 UIWebView 加载带有无效服务器证书的 HTTPS 页面的方法？

> ID：14268230
> 
> 赞同：11
> 
> 时间：2013-01-10T22:13:12.077
> 
> 标签：ios, uiwebview

如果用户尝试在 Mobile Safari 中加载 https 网页并且服务器的证书验证检查失败（其过期、撤销、自签名等），则会向用户显示一条警告消息并询问他们是否要继续或不。

类似地，NSURLConnection 让实现者能够首先决定如何检查证书，然后决定如果证书失败如何继续，因此在这种情况下也可以向用户显示警告并为他们提供继续加载的机会页面与否。

然而，当在 UIWebView 中加载一个未通过证书检查的 https 页面时，这种行为似乎只是无法加载该页面 - didFailLoadWithError: 使用 kCFURLErrorServerCertificateUntrusted 调用，但没有向用户显示任何内容。

这是不一致的 - UIWebView 行为肯定应该以与 Safari 类似的方式在 iPhone 内部保持一致吗？NSURLConnection 允许完全的灵活性也是一个愚蠢的做法，但 NSURLRequest:setAllowsAnyHTTPSCertificate 是私有的。

无论如何要实现与 Safari 一致的行为，是否可以以类似于 NSURLConnection 允许的方式自定义此默认行为？

干杯

PS 请不要进入关于为什么有人要这样做的光顾的旁白讨论，非常感谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-11T21:18:04.540

我发现了如何做到这一点：

1）当页面加载时会失败，因此在 didFailLoadWithError 中添加如下内容：

```
- (void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error
    if ([error.domain isEqualToString: NSURLErrorDomain])
    {
        if (error.code == kCFURLErrorServerCertificateHasBadDate        ||
            error.code == kCFURLErrorServerCertificateUntrusted         ||
            error.code == kCFURLErrorServerCertificateHasUnknownRoot    ||
            error.code == kCFURLErrorServerCertificateNotYetValid)
        {
        display dialog to user telling them what happened and if they want to proceed 
```

2）如果用户想要加载页面，那么您需要使用 NSURLConnection 进行连接：

```
NSURLRequest *requestObj = [NSURLRequest requestWithURL:self.currentURL     cachePolicy:NSURLRequestReturnCacheDataElseLoad timeoutInterval:10.0];
self.loadingUnvalidatedHTTPSPage = YES;
[self.webView loadRequest:requestObj]; 
```

3) 然后对 shouldStartLoadWithRequest 进行此更改

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType 
{
    if (self.loadingUnvalidatedHTTPSPage)
    {
        self.connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
        [self.connection start];
        return NO;
    } 
```

4) 将 NSURLConnectionDelegate 实现为：

```
- (void)connection:(NSURLConnection *)connection willSendRequestForAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge
{
    SecTrustRef trust = challenge.protectionSpace.serverTrust;
    NSURLCredential *cred;
    cred = [NSURLCredential credentialForTrust:trust];
    [challenge.sender useCredential:cred forAuthenticationChallenge:challenge];
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response;
{
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:self.currentURL cachePolicy:NSURLRequestReturnCacheDataElseLoad timeoutInterval:10.0];
    self.loadingUnvalidatedHTTPSPage = NO;
    [self.webView loadRequest: requestObj];
    [self.connection cancel];
} 
```

一切似乎都很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:59:18.680

从马口中：

“UIWebView 没有为应用程序自定义其 HTTPS 服务器信任评估提供任何方式。使用公共 API 可以解决此限制，但这并不容易。如果您需要这样做，请联系开发人员技术支持（dts @apple.com)

来源：http: [//developer.apple.com/library/ios/#technotes/tn2232/_index.html](http://developer.apple.com/library/ios/#technotes/tn2232/_index.html)

# vim - vim：带有确认键的映射命令

> ID：14268232
> 
> 赞同：4
> 
> 时间：2013-01-10T22:13:24.710
> 
> 标签：vim

我已经在我的 .vimrc 中为我正在使用的版本控制系统（Perforce）编写了一些宏（请不要建议 vim 的 perforce 插件，我试过了，但我不喜欢它）。除了revert 宏，它们都工作正常，它由于确认提示而中断（我需要它，所以我不会不小心把我的更改拿掉）。它目前看起来像这样：

```
map <F8> :if confirm('Revert to original?', "&Yes\n&No", 1)==1 | !p4 revert <C-R>=expand("%:p")<CR><CR><CR>:edit<CR> | endif 
```

当 vim 尝试加载文件时，这会导致 bash 抱怨：

```
bin/bash: -c: line 0: syntax error near unexpected token `(' 
```

查看 bash 看到的缓冲区，看起来错误是 vim 在第一个管道之后发送所有内容，而不仅仅是用于 bash 的部分。我尝试了一些替代方案，但似乎无法使其发挥作用。当我删除管道和 endif（使用简写 if）时，我已经让它正确显示确认对话框，但是在用户给出响应后 vim 会抱怨。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T00:11:34.917

我认为您想要以下方面的内容：

```
:map <F8> :if confirm('Revert to original?', "&Yes\n&No", 1)==1 <Bar> exe "!p4 revert" . expand("%:p") <Bar> edit <Bar> endif<CR><CR> 
```

请记住，这`:map`是一个愚蠢的击键序列：您要映射`F8`到的必须是一系列击键，如果键入就会起作用。`<CR>`语句中间的A`:if`并不表示“`Enter`如果条件为真，则在此时执行命令时按”；它的意思是“`Enter`在输入命令的过程中按这里`:if`”，这显然不是你想要的。

从内到外，一次次地构建它：

1.  您有时想要运行一个 shell 命令。
2.  该 shell 命令需要在一个内部`:if`执行“有时”位，因此有一个`:endif`跟随它。
3.  After a literal `!` everything following is passed to the shell, including `|` characters which normally signify the start of another Vim command. That's reasonable, because `|` is a perfectly good character to use in shell commands. So we need some way of containing the shell command. `:exe` can do this; it executes the supplied string as a command — and its argument, being a string, has a defined end. So the general form is `:if condition | exe "!shell command" | endif`.
4.  Your shell command has an expression in it. Using `:exe` makes this easy, since you can simply concatenate the string constant parts of the command with the result of the expression. So the command becomes `:exe "!p4 revert" . expand("%:p")` — try that out on its own on a file, and check it does what you want before going any further.
5.  Putting that inside the condition gives you `:if confirm('Revert to original?', "&Yes\n&No", 1)==1 | exe "!p4 revert" . expand("%:p") | edit | endif` — again try that out before defining the mapping.
6.  Once you have that working, define the mapping. A literal `|` does end a mapping and signify the start of the next Vim command. In your original the mapping definition only went to the end of the condition (check it with `:map <F8>` after loading a file) and the `!p4` part was being run immediately, on the Vim file that defines the mapping! You need to change each `|` in your command into `<Bar>`, similarly to how each press of `Enter` in your command needs writing as `<CR>`. That gives you the mapping above. Try it by typing it at the command line first, then do `:map <F8>` again to check it's what you think it is. And only then try pressing `F8`.
7.  If that works, put the mapping in your *.vimrc*.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T22:31:01.487

使用管道将多个 vim 命令串在一起并不是特别明确的定义，并且有许多怪癖。至关重要的是，（请参阅[`:help :bar`](http://vimdoc.sourceforge.net/htmldoc/cmdline.html#%3abar)）它不能在像 shell 命令`:!`这样将`|`字符视为其参数的命令之后使用。

[`system()`](http://vimdoc.sourceforge.net/htmldoc/eval.html#system%28%29)您可能会发现使用该功能更容易。

例如

```
:echo system("p4 revert " . shellescape(expand("%:p"))) 
```

如果[`shellescape()`](http://vimdoc.sourceforge.net/htmldoc/eval.html#shellescape%28%29)文件名中有空格或引号等字符（或者巧妙地命名它`; rm -rf ~`（不要在家里尝试这个！）），包装器很有用。

为了创建更具可读性/可维护性的代码，您可能希望将代码移动到函数中：

```
function Revert()
    if confirm('Revert to original?', "&Yes\n&No", 1)==1
        return system("p4 revert " . shellescape(expand("%:p")))
    endif
endfunction 
```

您可以在宏中使用`:call`or命令访问它。`:echo`

# sql - PostgreSQL SQL 查询说明

> ID：14268234
> 
> 赞同：-3
> 
> 时间：2013-01-10T22:13:28.057
> 
> 标签：sql, postgresql

谁能帮我理解 PostgreSQL 中的这个 SQL 查询？

```
SELECT sum(count) 
FROM ( 
    SELECT count, 
           time, 
           max(time) OVER (PARTITION BY post_id) max_time 
    FROM totals 
    WHERE cust_id IN %s 
    AND time < %s 
    AND type = %s 
) as ss 
WHERE time = max_time; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:17:11.910

它返回列的总和，其中`count`列中的值与每个 post_id的`time`列中的最新值匹配。`time`

检查的总数受 cust_id、时间和类型的限制。这些条件的值（显然）作为参数传递。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:30:50.417

**附加评论**

为了解释我对 a_horse_with_no_name 的 OP 的评论，这个查询可以重写如下：

```
SELECT sum(count) 
FROM ( 
    SELECT count, 
           time, 
           RANK() OVER (ORDER BY time DESC PARTITION BY post_id) time_desc 
    FROM totals 
    WHERE cust_id IN %s 
    AND time < %s 
    AND type = %s 
) as ss 
WHERE time_desc = 1; 
```

我相信这可以更清楚地说明这个查询在做什么（因为它是一种更标准的形式。）

* * *

**原始评论**

让我猜一下 - 假设计数是观看次数，时间是出现这些观看次数的时间。我的猜测是这样的。但KM不会告诉我们。

无论如何，如果这是它的工作方式，那么这就是查询的作用：

**它给出了所有帖子的总视图。** （受传入参数限制）

我可以解释原因，但我会等你为诅咒我而道歉。

# javascript - theyworkforyou API 在 Javascript Ajax 中返回为空

> ID：14268235
> 
> 赞同：1
> 
> 时间：2013-01-10T22:13:31.480
> 
> 标签：javascript, jquery, json

我真的很困惑。如果我将以下链接发布到浏览器中，它可以工作，没问题，但是当我要求 jQuery 对其执行时，它返回空白，但没有错误。

**链接**：

[http://www.theyworkforyou.com/api/getConstituency?key=FU8MWTEQnvVsHC6GM7B82zie&postcode=BS345NT](http://www.theyworkforyou.com/api/getConstituency?key=FU8MWTEQnvVsHC6GM7B82zie&postcode=BS345NT)

**代码**：

```
$.ajax({
  url: 'http://www.theyworkforyou.com/api/getConstituency?key=FU8MWTEQnvVsHC6GM7B82zie&postcode='+postcode+'&output=js',
  type: 'POST',
  success: function(response) {
    console.log(response);
   }
}); 
```

我可以更改密钥，所以不要担心我发布它的事实。

任何想法为什么它不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T00:07:52.150

您的 javascript 在从源服务器下载到浏览器的网页的上下文中运行。它尝试从不同的服务器请求页面，但这违反了[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)。Javascript 不能向源服务器以外的服务器发出请求。

[JSONP](http://en.wikipedia.org/wiki/JSONP)技术可以用来解决这个问题，但前提是非源服务器支持它。在这种技术中，javascript 代码动态创建一个脚本标签，其 src 元素 1) 指向非源服务器，2) 传递（作为查询参数）存在于本地 javascript 中的函数的名称。非源服务器返回一个脚本的源代码，该脚本仅对非源服务器提供的数据调用函数。通过这种方式，javascript 可以从非源服务器请求数据。

如果非源服务器不支持 JSONP，那么你将无法为所欲为。

# graphics - 可以使用什么样的工具来生成这个图表？

> ID：14268238
> 
> 赞同：0
> 
> 时间：2013-01-10T22:13:36.140
> 
> 标签：graphics, matplotlib

我是大数据分析绘图工具的新手。虽然以下不是来自大数据，但我想知道使用什么样的工具来创建这种复杂的图表：

[http://www.bitmover.com/lmbench/mem_lat3.pdf](http://www.bitmover.com/lmbench/mem_lat3.pdf)

与论文相关[http://www.bitmover.com/lmbench/lmbench-usenix.pdf](http://www.bitmover.com/lmbench/lmbench-usenix.pdf)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T12:40:20.463

这篇文章是用[LaTeX](http://en.wikipedia.org/wiki/LaTeX)制作的（特别是[groff](http://www.gnu.org/software/groff/)项目），根据图表 PDF 中的元数据，它是从 Photoshop 中保存为 PDF 的（所以这篇文章到此结束）。无论如何，[TikZ](http://www.texample.net/tikz/examples/)或[Asymptote](http://asymptote.sourceforge.net/)（[见图库](http://asymptote.sourceforge.net/gallery/3D%20graphs/)）能够绘制这样的图表..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T09:10:29.623

看起来有点像gnuplot，但是matplotlib可以完美完成。可以在[此页面](http://matplotlib.org/examples/mplot3d/surface3d_demo.html)上找到一个示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-08T17:25:12.180

对不起，我以前从未注意到这个问题。拉里从我那里借来了那个图形，它是用 Excel 创建的。

我正在考虑向 lmbench 添加代码以自动创建该图，Thorsten 对 mplot3d 的建议听起来是一个不错的起点。

# c++ - 使用带有 Rcpp 的 R 包中的头 (.h) 文件和 cpp 文件

> ID：14268245
> 
> 赞同：5
> 
> 时间：2013-01-10T22:13:59.757
> 
> 标签：c++, r, rcpp

> **可能重复：**
> [将第 3 方头文件与 Rcpp 一起使用](https://stackoverflow.com/questions/13995266/using-3rd-party-header-files-with-rcpp)

*注意：这是从此处开始的讨论的延续： [Using 3rd party header files with Rcpp](https://stackoverflow.com/questions/13995266/using-3rd-party-header-files-with-rcpp)。但是，这个问题非常不同，以至于我认为我会将其作为自己的问题提出。*

我有一个名为的头文件`coolStuff.h`，其中包含一个`awesomeSauce(arg1)`我想在我的 R 包中的 cpp 文件中调用的函数。

封装结构：

*   包裹名字

    *   描述
    *   [男人]

    *   命名空间

    *   R
        *   一些脚本
    *   源代码
        *   Cpp文件.cpp
        *   其他CppFile.cpp

CppFile.cpp 的代码：

```
`#include <Rcpp.h>
using namespace Rcpp;

// [[Rcpp::export]]
double someFunctionCpp(double someInput){

 double someOutput = awesomeSauce(someInput);

return someOutput;` 
```

1）我应该放在`coolStuff.h`包目录结构中的哪个位置，以便在构建包并编译cpp文件时，将包含来自coolStuff.h的代码。

2）我应该如何调用这个文件`coolStuff.h`？

`otherCppFile.cpp`3）同样，如果我想调用`theCppFile.cpp`where do

再次感谢你的帮助。我从上次的谈话中学到了很多。如果在某处有一些标准文档，我会很高兴 RTFM，只要指出我正确的方向。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:25:55.457

有*一个完整的小插图专门用于使用 Rcpp 构建一个包，*是的，你应该看看它。

Rcpp 属性确实非常适合快速和简单的事情，但即使它们也依赖于包：如果不是 RcppArmadillo 包提供的内联插件，你不能做他们的 Depends: on，比如说，RcppArmadillo。

简而言之：是的，请阅读精美的手册和/或查看（当前）CRAN 上使用 Rcpp 并依赖于它的 95 个包。

*编辑：* 这里有一个可能的捷径：如果`coolStuff.h`只是一个标题（因此没有链接到外部库），您可以通过在与源代码相同的目录中使用它来获得。这有助于快速`sourceCpp()`探索。但是对于一个*包*，你仍然需要做额外的步骤，但即使其中一些已经自动化了——请参阅 Rcpp 属性小插图。

*编辑2*：我刚刚重新阅读了您之前的问题。这个**新问题没有任何意义**，也没有增加任何内容。您是否阅读并理解了我们上次告诉您的内容？

# jquery - 一次选择更改不同的输入值

> ID：14268248
> 
> 赞同：0
> 
> 时间：2013-01-10T22:14:22.983
> 
> 标签：jquery

我想在一个选择上获得不同的输入值 - 选项。只有我不能让它工作..

```
$("#theSelect").change(function() {
    if($("#theSelect") == "foo")    {
      someInput1.show();
      someInput1.value = "Some Foo text";

      someInput2.show();
      someInput2.value = "different Text";
    } 
```

任何人的想法？

见：http: [//jsfiddle.net/853GJ/2/](http://jsfiddle.net/853GJ/2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:16:31.427

您正在将 jquery`object`与一个`string`值进行比较：

```
if($("#theSelect") == "foo") 
```

您需要使用以下方法获取值`.val()`：

```
if($("#theSelect").val() == "foo") 
```

此外，您需要获取隐藏输入的 jquery 对象：

```
var someInput1 = $('#someInput1'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:19:02.317

您需要为此获取选择元素使用`val`方法的值。您也可以`this`在您的内部使用`if`来获取当前元素的值。您还需要找到输入元素以显示它们并更改其值。

```
$("#theSelect").change(function() {
  if($(this).val() == "foo") {
    $("#someInput1").show();
    $("#someInput1").val("Some Foo text");

    $("#someInput2").show();
    $("#someInput2").val("different Text");      
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T22:19:53.803

我在你的 jquery 中注意到了一些事情：

**jQuery** :

```
var $someInput1 =  $("#someInput1");
var $someInput2 =  $("#someInput2");

$someInput1.hide();
$someInput2.hide();

$("#theSelect").change(function() {  

    if($("#theSelect").val() === "foo"){
      $someInput1.show().val("Some Foo text");
      $someInput2.show().val("different Text");
    }

    if($("#theSelect").val() === "bar")    {
      $someInput1.show().val("Some bar text");
      $someInput2.show().val("Text....");
    }

}).change(); // trigger once if needed 
```

*   `if($("#theSelect") == 'foo'`改为`if($("#theSelect").val() == 'foo'`
*   `.value`变成`val()`
*   `$("#someInput1")`为和创建缓存变量`$("#someInput2")`。

**[例子](http://jsfiddle.net/853GJ/9/)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T22:21:36.030

更改处理程序内`this`指的是元素。

在您的 if 中，您想将 与`value`可以使用`val()`方法检索的字符串进行比较

```
$("#theSelect").change(function() {
    if($(this).val() == "foo")    {
     /* assuming that "someInput" is a jQuery object since you are using "show()"*/
        /* use val() since someINput is jQuery object... can chain the methods*/

      someInput1.show().val("Some Foo text"); 

    }
}) 
```

# java - 如何从给定列表中选择随机字符串？（爪哇）

> ID：14268251
> 
> 赞同：-1
> 
> 时间：2013-01-10T22:14:34.873
> 
> 标签：java, javascript, random

我在 JavaScript 中做了同样的事情，但我是 JavaScript 新手，我不知道如何转换它......：/

```
<script language="JavaScript">
<!--
var randomString = new Array ();
randomString[0] = "a random string";
randomString[1] = "another random string";
randomString[2] = "another random string";
randomString[3] = "another random string";
randomString[4] = "another random string";
randomString[5] = "another random string";
randomString[6] = "another random string";
randomString[7] = "another random string";
var i = Math.floor(7*Math.random())

document.write(randomString[i]);
//-->
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:25:58.783

在 Java 中有多种选择。您可以使用 String 数组来完成您在此处使用的相同策略：

```
String[] randomString = new String[8];
randomString[0] = "a random string";
randomString[1] = "another random string";
randomString[2] = "another random string";
randomString[3] = "another random string";
randomString[4] = "another random string";
randomString[5] = "another random string";
randomString[6] = "another random string";
randomString[7] = "another random string";
int i = Math.floor(randomString.length * Math.random());

System.out.println(randomString[i]); 
```

另一种选择是使用[Java 集合框架](http://docs.oracle.com/javase/6/docs/technotes/guides/collections/index.html)并使用类似列表的东西：

```
List<String> randomStrings = new LinkedList<String>();
randomStrings.add("a random string");
randomStrings.add("another random string");
randomStrings.add("another random string"); 
```

一旦你有了一个列表，你可以做几件事：

```
Collections.shuffle(randomStrings);
System.out.println(randomStrings.get(0)); 
```

或者：

```
int i = Math.floor(randomStrings.size() * Math.random());
System.out.println(randomStrings.get(i)); 
```

Collections.shuffle 将实际修改列表并随机播放元素，因此请注意这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:21:49.863

我的 Java 有点生锈了，但这是怎么回事？

```
List<String> s = new List<String>(); //better than an array, because those are bounded
s.add("this is a string"); // first string
//repeat

int i = new Random().nextInt(s.size()); 
//from 0 - size exclusive, and the array starts at 0, so this is good

String result = s.get(i); 
```

# java - 3D 阵列不工作

> ID：14268252
> 
> 赞同：0
> 
> 时间：2013-01-10T22:14:49.560
> 
> 标签：java, string, methods, multidimensional-array

```
public static String[] getWords(int cat, int diff) {
    String topic[][][] = new String[3][3][3];
    switch(cat){
        case 0:
            topic[0][0][0] = "Paris";
            topic[0][0][1] = "London";
            topic[0][0][2] = "Sydney";
            diff = 0;
            topic[0][1][0] = "Toronto";
            topic[0][1][1] = "Florida";
            topic[0][1][2] = "Frankfurt";
            diff = 1;
            topic[0][2][0] = "Barcelona";
            topic[0][2][1] = "Vancouver";
            topic[0][2][2] = "Zimbabwe";
            diff = 2;
        case 1:
            topic[1][0][0] = "Halo";  
            topic[1][0][1] = "Fifa";                   
            topic[1][0][2] = "GTA";
            diff = 0;                  
            topic[1][1][0] = "Skyrim";
            topic[1][1][1] = "HITMAN";
            topic[1][1][2] = "Batman";
            diff =1;
            topic[1][2][0] = "Minecraft";
            topic[1][2][1] = "Zombieville";
            topic[1][2][2] = "BoderLands";
            diff =2;
        case 2:
            topic[2][0][0] = "Acura";
            topic[2][0][1] = "Audi";
            topic[2][0][2] = "Bmw";
            diff = 0;
            topic[2][1][0] = "Bentley";
            topic[2][1][1] = "Buggati";
            topic[2][1][2] = "Honda";
            diff = 1;
            topic[2][2][0] = "Lamborghini";
            topic[2][2][1] = "Rolls-Royce";
            topic[2][2][2] = "Mercedes";
            diff = 2;
    }
    return topic[cat][diff];
} 
```

所以这是我使用 3d 数组的方法，我想知道我是否做对了，如果我在 main 方法中调用它会起作用吗？我使用了 switch 语句，因为有人向我推荐了它，我真的是 java 新手，你可以看到这是游戏 Hangman

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:20:54.907

不，不会的。您的 switch 不包含任何`break;`语句，因此在它遇到第一个`case`评估为 true 的语句后，它将执行之后的所有语句，直到 switch 结束，或者直到你`break;`或`return`其他东西。

此外，调用：

```
diff = 0;
// ...
diff = 1;
// ...
diff = 2; 
```

是多余的，因为分配的值从未使用过。

所以应该是：

```
switch(cat)
{
    case 0:
        topic[0][0][0] = "Paris";
        topic[0][0][1] = "London";
        topic[0][0][2] = "Sydney";

        topic[0][1][0] = "Toronto";
        topic[0][1][1] = "Florida";
        topic[0][1][2] = "Frankfurt";

        topic[0][2][0] = "Barcelona";
        topic[0][2][1] = "Vancouver";
        topic[0][2][2] = "Zimbabwe";
        break;
    case 1:
        topic[1][0][0] = "Halo";
        topic[1][0][1] = "Fifa";
        topic[1][0][2] = "GTA";

        topic[1][1][0] = "Skyrim";
        topic[1][1][1] = "HITMAN";
        topic[1][1][2] = "Batman";

        topic[1][2][0] = "Minecraft";
        topic[1][2][1] = "Zombieville";
        topic[1][2][2] = "BoderLands";
        break;
    case 2:
        topic[2][0][0] = "Acura";
        topic[2][0][1] = "Audi";
        topic[2][0][2] = "Bmw";

        topic[2][1][0] = "Bentley";
        topic[2][1][1] = "Buggati";
        topic[2][1][2] = "Honda";

        topic[2][2][0] = "Lamborghini";
        topic[2][2][1] = "Rolls-Royce";
        topic[2][2][2] = "Mercedes";
        break;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:28:46.317

你需要休息一下；在情况之间。它只会简单地处理每个案例，因为没有休息时间。好吧，如果是案例 1，则每个案例，如果是案例 2，则为 2 和 3，并且只有案例 3。

所以 3 是唯一可以正常中断的，因为因为它是最后一个，所以你不需要一个。！

# java - JPA中的日期到日期时间转换

> ID：14268253
> 
> 赞同：1
> 
> 时间：2013-01-10T22:14:52.680
> 
> 标签：java, oracle, datetime, jpa, jdbc

我看到存储在 Oracle DB 中的值是`19-JAN-13`. 当我通过以下方式获得结果时：

```
List list1 = getEntityManager().createQuery(query).getResultList() 
```

我看到一个值`2013-01-19 07:03:49.0`而不是`2013-01-19 00:00:00.0`or `2013-01-19 23:59:59.9`。

我想知道为什么会这样？日期到日期时间的转换不应该默认时间为零吗？该行是在`07:03:49.0`2013 年 1 月 1 日创建的。

访问器定义为

```
@Column(name = "FREE_TRIAL_EXPIRY_DATE")
public Date getFreeTrialExpiryDate() {
    return freeTrialExpiryDate;
}
public void setFreeTrialExpiryDate(Date freeTrialExpiryDate) {
    this.freeTrialExpiryDate = freeTrialExpiryDate;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:54:01.277

实际上，Oracle [Date](http://docs.oracle.com/cd/B28359_01/server.111/b28318/datatype.htm#i1847)类型存储日期和时间的值。您的 Oracle 工具恰好只显示日期 DD-MM-YYYY 值。

您只需在 Java 应用程序中正确输出格式即可获得所需的 DD-MM-YYYY 表示。

底线是 Java 没有弥补时间价值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:48:26.507

甲骨文总是会保持时间，这就是它的方式。Oracle 的'DATE' 包括时间到秒，它不等同于永恒的java.sql.Date。

如果您希望该字段是无时间日期，则需要通过以下注释在应用程序级别指定截断：

`@Temporal(TemporalType.DATE)`

在实体上。

# javascript - 使用带有 onclick=playSound 命令的多个音频文件来支持跨浏览器

> ID：14268257
> 
> 赞同：0
> 
> 时间：2013-01-10T22:15:00.160
> 
> 标签：javascript, html, html5-audio

我目前在此链接 (http://webdesign.about.com/od/sound/a/play_sound_oncl.htm) 上使用 onclick=playsound 代码，并带有一些样式的单选按钮，以允许切换几个单个音频文件。

唯一的问题是我无法弄清楚如何使用这种方法获得跨浏览器支持。

有没有办法做到这一点？

```
 <div class="tabs" id="play-bar">
                                <div class="tab">
                                    <input type="radio" id="tab-1" name="tab-group-1" checked onclick="playSound('soundfile1.wav');">
                                    <label for="tab-1">1</label>
                                </div>
                                <div class="tab">
                                    <input type="radio" id="tab-2" name="tab-group-1" onclick="playSound('soundfile2.wav');">
                                    <label for="tab-2">2</label>
                                </div></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:59:10.917

只需将 jQuery 用于跨浏览器投诉代码。

HTML

```
<div class="tabs" id="play-bar">
  <div class="tab">
    <input type="radio" id="tab-1" name="tab-group-1" checked>
    <label for="tab-1">1</label>
  </div>
  <div class="tab">
    <input type="radio" id="tab-2" name="tab-group-1">
    <label for="tab-2">2</label>
  </div>
</div> 
```

jQuery

```
$('input[name="tab-group-1"]').click(function(){
  var num = $(this).prop('id').split('-')[1];
  playSound('soundfile'+ num +'.wav');
}); 
```

# php - 我无法让我的 php 加密工作

> ID：14268258
> 
> 赞同：0
> 
> 时间：2013-01-10T22:15:00.427
> 
> 标签：php, function, encryption, salt

该脚本旨在加密密码，以便在其上使用彩虹表更加困难，并且人们无法轻易破解服务器，但我似乎无法让它工作，所以我希望你们中的一个可以帮助我。

```
<?php

function enc($string){
    $salt = "randomsalt";
    $hash = sha1(md5($salt.$string)) . $md5($string) . sha1(md5(md5($string)));
    return $hash;   
}

echo enc('password');

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:24:18.917

听听评论，但你也有一个错字：

`$md5($string)`必须是（它不是一个变量，它前面`md5($string)`不应该有一个）。`$`

确实，您没有在这里加密，但这只是一个命名问题（您正在对其进行哈希处理，这是您想要做的）......但是，您的盐可能不应该是一个固定的字符串......它如果你真的想要一个强哈希，应该因用户而异。关于这个主题还有很多话要说（`md5`并且`SHA1`不是最好的密码哈希算法，因为两者都有太多彩虹表而且它们执行起来太快），但你可以在[这里](https://stackoverflow.com/questions/536584/non-random-salt-for-password-hashes/536756#536756)和[这里阅读 bcrypt 信息](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:23:59.173

```
$md5( $string) 
```

破坏你的代码。删除 $

您应该为所有用户使用 bcrypt 和不同的盐之类的东西。

# ruby-on-rails - 即使字段不为空，也验证属性是否存在引发错误

> ID：14268264
> 
> 赞同：0
> 
> 时间：2013-01-10T22:15:24.907
> 
> 标签：ruby-on-rails, forms, validation, activemodel

因此，我一直在使用 Active 模型在 ruby​​ on rails (1.9.3) 中处理多步骤表单，同时遵循 railscast #217 和 #219 并且在验证时遇到问题，问题是即使属性字段是不为空它仍然会抛出错误

```
1 error prohibited this wizard from being saved:
Validationattr can't be blank 
```

我不相信它应该保存，但这可能与错误有关。（我不能使用表单 gem，必须自己写）如果您需要更多信息，请告诉我，我很乐意提供。

**我的控制器代码 - (contollers/awizard_controller.rb)**

```
class AwizardController < ApplicationController

  def new
    # New Asset Wizard
    @wizard = Awizard.new(id: 1)
    # Set session variable as initial step
    session[:wizard_step] = @wizard.current_step
  end

  def update
    @wizard = Awizard.new(id: 1) unless !@wizard.nil?
    @wizard.current_step = session[:wizard_step] unless nil

    if @wizard.valid?
      if params[:back_button]
        @wizard.previous_step
      elsif @wizard.last_step?
        @wizard.save if @wizard.all_valid?
      else
        @wizard.next_step
      end
      session[:wizard_step] = @wizard.current_step
    end

    if @wizard.changed?
      render 'form'
    else
      @wizard.save
    end
  end

end 
```

**我的向导模型 - (models/awizard.rb)**

```
 class Awizard < Wizard
 validates :validationattr, :presence => true
 attr_accessor :validationattr

  def steps
    %w[validate_schedule validate_assets save_assets]
  end

 end 
```

**我的向导模型 - (models/wizard.rb)**

```
class Wizard
include ActiveModel::Validations
include ActiveModel::Conversion
include ActiveModel::Dirty
include ActiveModel::Naming

#This class is used to manage the wizard steps using ActiveModel (not ActiveRecord)

attr_accessor :id
attr_writer :current_step  #used to write to current step
define_attribute_methods [:current_step] #used for marking change

def initialize(attributes = {})
   attributes.each do |name, value|
     send("#{name}=", value)
   end
end

def current_step
  @current_step || steps.first
end

def steps
  %w[] 
end

def next_step
  current_step_will_change! #mark changed when moving stepped
  self.current_step = steps[steps.index(current_step)+1] unless last_step?
end

def previous_step
  current_step_will_change! #mark changed when moving stepped
  self.current_step = steps[steps.index(current_step)-1] unless first_step?
end

def first_step?
  current_step == steps.first
end

def last_step?
  current_step == steps.last
end

def all_valid?
  steps.all? do |step|
    self.current_step = step
    valid?
  end
end

def step(val)
  current_step_will_change!
  self.current_step = steps[val]
end

def persisted?
  self.id == 1
end

end 
```

**我的观点 -** **(/views/awizard/_form.html.erb)**

```
<%=  content_for :awizard_form do%>
  <%= form_for(@wizard) do |f| %>
    <%= render "#{@wizard.current_step}_step", :f => f %>
    <%= f.submit "Previous", :name => "back_button" unless @wizard.first_step? %>
    <%= f.submit "Continue", :name => "step" unless @wizard.last_step? %>
  <% end %>
<% end %> 
```

**(/views/awizard/_step1.html.erb)**

```
<div class="field">
  <%= f.label :validationattr %><br />
  <%= f.text_field :validationattr %>
</div> 
```

**(/views/awizard/_step2.html.erb)**

```
<div class="field">
  <%= f.label 'Step2' %><br />
</div> 
```

**(/views/awizard/_step3.html.erb)**

```
<div class="field">
  <%= f.label 'Step3' %><br />
</div> 
```

**路线代码**

```
resources :awizard 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:31:48.793

抛出错误是因为第 2 步中的 validationattr 属性为零。我不确定逻辑，您可能需要在后续帖子中包含它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T01:42:46.463

问题是正如[Yoshiji 先生](https://stackoverflow.com/users/976775/mryoshiji)所说，没有将参数传递到步骤 2，validationattr 无法在向导中验证，在控制器中添加向导参数的合并解决了这个问题。

# java - Java 竞赛小程序不工作

> ID：14268266
> 
> 赞同：0
> 
> 时间：2013-01-10T22:15:27.943
> 
> 标签：java, applet

我无法模拟两个竞争对手之间的比赛。这是您的典型比赛计划，您使用随机数生成器来确定竞争对手使用的“移动”。如下面的代码所示，赛道由 50 个矩形组成，填充的矩形显示了每个参赛者在赛道上的位置。例如，一些“动作”使参赛者向右跳 9 个方格，或向后跳 2 个方格。当我运行小程序时，只显示初始起始位置；小程序不起作用。我意识到这是很多代码，但我需要做些什么来解决我的问题？我真的被困在这一点上。任何帮助表示赞赏。我只能用AWT，不能swing。这是类的作业：/这是代码：

```
import java.awt.*;
import java.applet.*;

    public class Example extends Applet
    {
        Image tortoise, hare;
        int tortX = 250, hareX = 250; 
        final int tortY = 100, hareY = 300, WIDTH = 15, HEIGHT = 50;
        int turn; String turnNum;
        int move; String tMove, hMove;

        public void init()
        {
            tortoise = getImage( getDocumentBase(), "images/tortoise.gif" );
            hare = getImage( getDocumentBase(), "images/hare.gif" );
            move = 0; turn = 0;
        }

        public void control()
        {
            while (( tortX < 985 ) || ( hareX < 985 ))
            {
                move = (int)(10 * Math.random());
                switch (move)
                {
                    case 1:
                    case 2:
                        tortX += (3 * WIDTH);
                        hareX += (9 * WIDTH);
                        tMove = "Fast Plod"; hMove = "Big Hop";
                        break;
                    case 3:
                    case 4:
                    case 5:
                        tortX += (3 * WIDTH);
                        hareX += WIDTH;
                        tMove = "Fast Plod"; hMove = "Small Hop";
                        break;
                    case 6:
                        tortX += WIDTH;
                        if (hareX == 250) {} // DO NOTHING
                        else if (hareX <= (250 + (11 * WIDTH)))
                            hareX = 250;
                        else 
                            hareX -= (12 * WIDTH);
                        tMove = "Slow Plod"; hMove = "Big Slip";
                        break;
                    case 7:
                    case 8:
                        tortX += (1 * WIDTH);
                        if (hareX == 250) {} // DO NOTHING
                        else if (hareX <= (250 + (WIDTH)))
                            hareX = 250;
                        else 
                            hareX -= (2 * WIDTH);
                        tMove = "Slow Plod"; hMove = "Small Slip";
                        break;
                    case 9:
                    case 10:
                        if (tortX == 250) {} // DO NOTHING
                        else if (tortX <= (250 + (5 * WIDTH)))
                            tortX = 250;
                        else 
                            tortX -= (6 * WIDTH);
                        tMove = "Slip"; hMove = "Fall Asleep. Zzz...";
                        break;
                        // Hare falls asleep. No action. 
                }

                turn++; turnNum = (turn + "");
                repaint();
                for (int i = 1; i <= 10; i++)
                {
                    delay();
                }
            }

            tortX = 985; hareX = 985;
            repaint();
        }

        public void paint( Graphics screen )
        {
            drawRace(screen);

            if (tortX >= 985)
            {
                screen.setFont(new Font("Times New Roman", Font.ITALIC, 48));
                screen.drawString("Tortoise Wins", 650, 240);
                clearCurrent(screen); 
                fillNext(screen);
            }
            else if (hareX >= 985)
            {
                screen.setFont(new Font("Times New Roman", Font.ITALIC, 48));
                screen.drawString("Tortoise Wins", 650, 240);
                clearCurrent(screen); 
                fillNext(screen);
            }
            else
            {       
                screen.drawString(("Turn " + turnNum), 621, 55);
                screen.setFont(new Font("Times New Roman", Font.ITALIC, 12));
                screen.drawString(tMove, 59, 65); screen.drawString(hMove, 66, 255); 
                clearCurrent(screen);
                fillNext(screen);
            }

            stop();
        }

        public void clearCurrent( Graphics s )
        {
            s.clearRect(tortX+1, tortY+1, WIDTH-1, HEIGHT-1);
            s.clearRect(hareX+1, hareY+1, WIDTH-1, HEIGHT-1);

        }

        public void fillNext( Graphics s )
        {
            s.fillRect(tortX+1, tortY+1, WIDTH-1, HEIGHT-1);
            s.fillRect(hareX+1, hareY+1, WIDTH-1, HEIGHT-1);

        }

        public void drawRace( Graphics s )
        {
            // GENERATES INITIAL GRAPHICS FOR RACE
            s.drawRect(250, 100, 750, 50);
            s.drawRect(250, 300, 750, 50);
            int lineX = 265, lineYi = 100, lineYf = 150;
            for (int i = 1; i <= 98; i++)
            {
                if (lineX == 1000)
                {
                    lineX = 265; lineYi = 300; lineYf = 350;
                }
                s.drawLine(lineX, lineYi, lineX, lineYf);
                lineX += 15;
            }
            s.fillRect(tortX+1, tortY+1, WIDTH-1, HEIGHT-1);
            s.fillRect(hareX+1, hareY+1, WIDTH-1, HEIGHT-1);
            s.drawImage(tortoise, 59, 80, this);
            s.drawImage(hare, 66, 271, this);
            s.setFont(new Font("Times New Roman", Font.BOLD, 24));
            s.drawString("Race", 250, 55);
        }

        public void delay()
        {
            for (int i = 0; i < 90000000; i++)
            {
            }
        }

        public void stop()
        {
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:41:59.240

你的第一个问题是你实际上从来没有“开始”比赛......当然是你`init`的小程序，但是，什么都没有......

您的第二个问题是该`control`方法阻止了事件调度线程，这意味着，当您使用此方法时，它们不会被绘制到屏幕上。这是因为事件调度线程也负责调度重绘请求。

你的第三个问题是你违反了`paint`联系。你有责任打电话`super.paint(screen)`——paint 是一种复杂的方法，除非你有充分的理由这样做，否则永远不要忽视它。

您的第四个问题是，您使用的`Applet`是 a 而不是 a `JApplet`。最好忽略 AWT 控件以支持 Swing 控件。Swing 更灵活，更容易扩展。

您的第五个问题是您在顶级容器上绘画，这是不推荐的。你最好使用类似的东西`JPanel`并覆盖它的`paintComponent`方法（不要忘记调用`super.paintComponent`）。除此之外，它是双缓冲的，并且会随着屏幕的更新而减少闪烁。

看一眼...

*   [Swing 中的并发](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)性以及[如何使用 Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)解决 EDT 阻塞问题...
*   [执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)以获得有关在 Swing 中绘画的想法

# java - 垂直对齐的居中按钮

> ID：14268267
> 
> 赞同：3
> 
> 时间：2013-01-10T22:15:28.493
> 
> 标签：java, button, boxlayout

我目前正在构建一个包含几个按钮的项目，并且我正在尝试将这些按钮垂直对齐在面板的中心。我还试图使它们具有完全相同的大小（例如 new Dimension(15, 100)）。

对于我试图使按钮居中的部分，我尝试使用 BoxLayout，它工作正常，直到我尝试使按钮大小相同.. 我尝试使用

```
myButton.setSize(new Dimension(15, 100))
myButton.setPreferredSize(new Dimension(15, 100));
myButton.setMinimumSize(new Dimension(15, 100)); 
```

对于 BoxLayout 部分，我使用的是这段代码

```
buttonPanel.setLayout(new BoxLayout(buttonPanel, BoxLayout.Y_AXIS)); 
```

效果很好，但它是居中/尺寸规格对我不起作用..

# android - 在不同 dpi 中不同的地图视图标记顶部添加信息窗口

> ID：14268269
> 
> 赞同：0
> 
> 时间：2013-01-10T22:15:31.643
> 
> 标签：android, xamarin.android, google-maps-markers

我正在使用此代码添加一个布局，该布局在标记顶部显示有关标记的信息。虽然我在此代码中使用代码将像素转换为 dpi。但它不会在不同的 dpi 相同的视图中查看。

```
 protected override bool OnTap (int index)
    {
        if (!ShowPropertyFlag) {
            if (mapview .ChildCount > 0) {
                mapview .RemoveViewAt (0);
            }
            if (_items [index].Snippet == Boolean .FalseString) {
                InformationLayout iWindow = new InformationLayout 
            (mapview .Context, _Properties [_items [index].Title], sayActivity);

                GeoPoint p = _items [index].Point;

                MapView.LayoutParams _params = new MapView.LayoutParams
            (WindowManagerLayoutParams .WrapContent,
                   WindowManagerLayoutParams.WrapContent 
                     , p,-(int) Common .convertPixelsToDp    (13,sayActivity ),-(int) Common .convertPixelsToDp  (25,sayActivity ), 
                     MapView .LayoutParams .Bottom   );
                _params.Mode = MapView .LayoutParams .ModeMap;

                iWindow .Visibility = ViewStates .Visible;

                mapview .AddView (iWindow, _params);
                mapview .HasIWindows =true ;

            } else {
                Property[] m = _SubProperties [_items [index].Title];
                List <Property > templist= m.OfType <Property > () .ToList ();
                sayActivity .ListShow (templist ,m.Length );
            }

        }
            return base.OnTap (index);

    } 
```

这是我`Common .convertPixelsToDp`用于将 Pixel 转换为 Dp的代码

```
 public static float convertPixelsToDp (float px, Context context)
    {
        return  px / ((float)context.Resources.DisplayMetrics.DensityDpi / 160f);
    } 
```

我的标记宽度 x 高度是：25 x 45

因为我是新用户，所以我不能以不同的 dpi 发布我的信息窗口和标记的图像。但我解释一下。在 ldpi 中它看起来不错并且处于良好状态（我通过尝试不同的数字来修复它，最后在 13 和 25 时它得到修复）但是在 hdpi 中，信息窗口看起来是关于标记的中心而不是标记的顶部。我不明白为什么？虽然我使用像素到 dp 转换器。

编辑：

也许这些链接有助于查看不同 dpi 的图像：

hdpi：http: [//i.stack.imgur.com/K8vjO.png](http://i.stack.imgur.com/K8vjO.png)

ldpi：http: [//i.stack.imgur.com/sLH5o.png](http://i.stack.imgur.com/sLH5o.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T15:33:03.127

请看链接：

[MapView.LayoutParams](https://developers.google.com/maps/documentation/android/v1/reference/com/google/android/maps/MapView.LayoutParams#MapView.LayoutParams%28int,%20int,%20com.google.android.maps.GeoPoint,%20int,%20int,%20int%29)

mapview.layoutparams 中的 x 和 y 偏移量必须基于 px 发送。这意味着即使您将其转换为 dp，构造函数也将其假定为 px。因此最好的方法是使用标记的表格高度。该代码解决了问题。（`location_Marker`是地图中显示的标记）：

```
MapView.LayoutParams _params = new MapView.LayoutParams
                    ( MapView .LayoutParams  .WrapContent,
                     MapView .LayoutParams  .WrapContent 
                     , p,0,
                     - sayActivity .Resources .GetDrawable (Resource .Drawable .location_Marker ).IntrinsicHeight , 
                     MapView .LayoutParams .Bottom   ); 
```

# mysql - 选择mysql返回的所有值的平均值

> ID：14268279
> 
> 赞同：0
> 
> 时间：2013-01-10T22:16:23.017
> 
> 标签：mysql, sql

如何使用 SQL 从该查询中找到平均值：

```
SELECT  count(col1) as count FROM table1 GROUP BY col1 HAVING count > 1 
```

我试图找到每个平均行数`col1`

到目前为止，我设法找到了每行的总数量`col1`，现在我只需要 avg

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:19:05.783

```
select avg( c ) 
from ( SELECT  count(col1) as c FROM table1 GROUP BY col1 HAVING count > 1 ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:50:28.933

对于表，您需要别名并更改`count`为`count(*)`.

询问：

```
SELECT avg(t1.c) AS avgcol1
FROM
  (SELECT count(col1) AS c
   FROM table1
   GROUP BY col1 HAVING COUNT(*) > 1) t1 
```

# c# - 桌面应用程序 - 无法连接到任何指定的 MySQL 主机

> ID：14268280
> 
> 赞同：2
> 
> 时间：2013-01-10T22:16:27.323
> 
> 标签：c#, mysql

我正在使用 MS Visual Studio 2008 c# 开发桌面应用程序，并且正在尝试连接到 mysql 数据库。我下载了连接器，添加了参考资料，我有这个代码：

```
try
    {
         MySqlConnection conn = new MySqlConnection("server=127.0.0.1;User Id=user;Pwd=pass;database=db");
            conn.Open();
    }
    catch (MySqlException exp)
    {
        Console.WriteLine(exp.Message);
    } 
```

在 conn.Open(); 我得到了 MySqlException**无法连接到任何指定的 MySQL 主机。**最糟糕的是我可以连接到 MSVStudio 中的数据库 throw Server Explorer。 ![在此处输入图像描述](../Images/c39d9b72a02aecb0555388268f30d44e.png)

我查看了所有类似的问题，但我没有得到答案！请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-03T13:14:15.700

我意识到这个问题已经有几年的历史了，但是当我尝试在数据集设计器中打开查询生成器时，我在 VS2015 社区版中遇到了同样的问题。我在网上搜索了整个网络，试图找到一个修复程序，但都没有奏效。终于偶然间找到了答案。

发生的事情是 VS 没有意识到它必须先打开连接，错误消息非常具有误导性。要解决此问题，您需要做的就是在数据连接下的服务器资源管理器中找到您正在处理的连接，然后只需双击它即可打开。而已！

[![在此处输入图像描述](../Images/028bbc09f3fc2e34a038618b6dfcf048.png)](https://i.stack.imgur.com/vwpgL.png)

如果您查看连接旁边的图标，您会注意到它从[![断开连接](../Images/1ffddb79b579a54b836df74e1f03195e.png)](https://i.stack.imgur.com/Ys4la.png)变为[![在此处输入图像描述](../Images/7aafad365d39f11b69af2e28dcd5b34a.png)](https://i.stack.imgur.com/BWo1y.png)显示连接已打开。

# networking - 网络是否强制 JVM 使用较小的堆栈/堆限制？

> ID：14268282
> 
> 赞同：0
> 
> 时间：2013-01-10T22:16:28.163
> 
> 标签：networking, error-handling, out-of-memory

我正在尝试在我的 Java 课程中开发一个游戏，但是在学校玩了几分钟后，我收到了 OutOfMemory 错误。但是，如果我在家里运行它，我似乎可以无限期地播放它而不会显示错误。Windows 7 和 Vista 上的 CPU/RAM 监视器在学校运行程序时几乎达到极限（它达到 %100 CPU 和 %90+ RAM），但是在家里，我看不出 CPU 有什么不同米，而 RAM 米只上升了几个百分点。

那么，是学校网络的问题，还是学校电脑和我自己的电脑规格差异很大的问题？

# html - 带跨度的 CSS 工具提示不起作用

> ID：14268291
> 
> 赞同：1
> 
> 时间：2013-01-10T22:16:55.603
> 
> 标签：html, css

我读到您可以使用 Span 制作一些简单的 CSS 工具提示，所以我尝试了它，但它对我不起作用，我很难弄清楚原因：

```
if($result = $mysqli->query($query)) {
    while($obj = $result->fetch_object()) {
        $image = $obj->Image;
        $page  = $obj->Page;
        $name  = $obj->Name;
        if($image != null) {
            echo "<a href=" . $page . " target=_parent><img src=" . $image . " width=93 height=66><span class=info>test</span></img></a> ";
        }
    }
} 
```

和CSS：

```
 <style type="text/css">
    body,td,th {
        font-family: "Myriad Pro";
        font-size: 12px;
        background-color:#fcfcfc;;
    }
    a {
        border:none;
    }
    img {
        border:thin solid;
        border-color:CCC    
    }
    img:hover {
        opacity:0.5;    
    }
    span.info {
        display:none;   
    }
    img:hover span.info {
        display:block;position:absolute; width:200px; height:200px; 
    }
    </style> 
```

我的问题是跨度根本不会显示。有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:27:14.603

您正在寻找的选择器是这样的：

```
img:hover + span.info {
    display:block;position:absolute; width:200px; height:200px; 
} 
```

`+`用于相邻元素。使用空格用于后代元素（并且`span`绝对不是 的后代`img`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:24:41.593

我认为将其作为图像标签上的悬停事件不会起作用，因为跨度标签不是图像标签的子标签。

图像标签没有您在代码中编写的结束图像标签。

它们可以通过简单地在末尾加上一个斜线来关闭，例如

```
<img src="" /> 
```

如果您将其作为“a”标签的事件，则应该可以使用，例如

```
a:hover span.info {
    // your css here
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:27:38.077

你需要做两件事：

1.  将“img:hover span.info”更改为“a:hover span.info”，因为 span 是 a 标签的子标签，而不是 img 标签
2.  将定位应用于 a 标签（位置：绝对将仅在父级明确说明位置时相对于父级）

虽然上面提到的 + 选择器确实适用于支持 CSS3 的浏览器，但它适用于所有浏览器（IE8 及以下）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T23:56:53.060

据我所知，你不能在 IMG 标签内嵌套任何东西（这可能是它没有出现的原因） - 做这样的事情：

CSS：

```
.tippedImage {
position: relative
}

.tippedImage span {
display: none;
position: absolute;
}

.tippedImage:hover span {
display: block
} 
```

HTML：

```
<span class="tippedImage">
<img src="someimage.gif" />
<span class="tooltip">Tool tip text</span>
</span> 
```

# php - 为外部网络发布者创建图像引用以链接到我的网站

> ID：14268292
> 
> 赞同：0
> 
> 时间：2013-01-10T22:17:09.710
> 
> 标签：php, html, mysql, image, badge

我们正在尝试创建一个引用系统，外部网络发布者可以在其中将一些 html 放在他们网站上的页面上，该页面链接回我们网站上的特定产品页面。就这个问题而言，我们称其为“徽章”。

一旦他们插入了徽章，我们想要识别它，然后抓住 <h1> 和第一个 <p> 作为预告片，以包含从我们网站到他们的网站的链接，并将所有这些内容写入我们的数据库。然后，我们的用户可以看到他们页面的标题和第一位，然后决定是否要查看更多内容。

这是我们所做的（恐怕不多）：

```
<a href="http://www.mysite.com/abc.html">
<img alt="abc" src="http://www.mysite.com/logo.gif" style="width:200px;height:100px" />       
</a> 
```

我们计划构建一个管理页面来完成最后一部分的抓取 <h1> 和 <p> 并将其发布到实时数据库等，我们稍后会解决这个问题。

但是，中间的步骤（识别出这段html已经被使用过）我们就不知所措了。

这是我们应该通过日志文件做的事情吗……我什至不知道如何开始考虑它。

从哪里开始解决这个问题的一点方向会非常有帮助。

提前致谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:11:46.763

这是一种方法。

你给他们的 HTML 看起来像：

```
<a href="http://www.mysite.com/abc.html">
    <img alt="abc" src="http://www.mysite.com/logo.php" style="width:200px;height:100px" />       
</a> 
```

注意说`logo.php`，不是`logo.gif`。

`logo.php`将存在于您的服务器上。其目的有两个：

1.  收集有关持有`<img>`标签的页面的信息
2.  加载并输出 logo.gif，以便用户按预期看到图像。

如果您将该 html 嵌入到某处的网页中，logo.php 将包含有关图像请求来源的信息。具体来说，`$_SERVER['HTTP_REFERER']`将为您提供 img 标签所在页面的完整 URL。然后由您决定如何处理和存储该信息。

我不知道你想做什么，但一个非常简化的 logo.php 看起来像这样：

```
<?php
$url = $_SERVER['HTTP_REFERER'];

// do something with $url... 
// it will be something like "http://theirsite.com/wherever/they/pasted/the.html"

// now output the logo image...
header("Content-Type: image/gif");
echo file_get_contents("/path/to/logo.gif"); 
```

请记住，*每次*有人使用图像标签点击他们的页面时，都会运行 logo.php。所以不要意外地在您的网站上创建 10000 个链接回他们的网站 :)

# udp - UDP客户端和服务器缓冲协议

> ID：14268300
> 
> 赞同：-1
> 
> 时间：2013-01-10T22:17:50.960
> 
> 标签：udp, client-server

嗨，我正在编写一个程序，它将使用 UDP 套接字使用不同的数据包大小（例如 512B、1KB 和 2KB）将文件从客户端发送到服务器，我不想在接收器（服务器）中使用固定的缓冲区大小。我需要一些代码在 Java 中，这将允许服务器和客户端在传输开始之前就数据包大小达成一致。非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:22:29.783

您是否忘记了 UDP 数据包可能会被分段、重复和丢失？有很多事情需要处理，从丢失的数据包重传开始。

我讨厌给出“不要这样做”的答案，但对于这个，只需使用 TCP。如果你想要一些用户级的“数据包”，你也可以用 TCP 来拥有它们（每个都加上它的长度前缀，这就足够了）。

# c# - 正确的类定义和使用 - 线程安全 - ASP.net

> ID：14268307
> 
> 赞同：-1
> 
> 时间：2013-01-10T22:18:49.040
> 
> 标签：c#, asp.net, c#-4.0, thread-safety, static-functions

我想知道如何正确定义一个类并安全地使用它。我的意思是当每个网站访问者都进行数千个并发调用时，线程安全。

我让自己像下面这样，但我想知道它是否正确构建

```
public static class csPublicFunctions
{
    private static Dictionary<string, clsUserTitles> dicAuthorities;

    static csPublicFunctions()
    {
        dicAuthorities = new Dictionary<string, clsUserTitles>();
        using (DataTable dtTemp = DbConnection.db_Select_DataTable("select * from myTable"))
        {
            foreach (DataRow drw in dtTemp.Rows)
            {
                clsUserTitles tempCLS = new clsUserTitles();
                tempCLS.irAuthorityLevel = Int32.Parse(drw["Level"].ToString());
                tempCLS.srTitle_tr = drw["Title_tr"].ToString();
                tempCLS.srTitle_en = drw["Title_en"].ToString();
                dicAuthorities.Add(drw["authorityLevel"].ToString(), tempCLS);
            }
        }
    }

    public class clsUserTitles
    {
        private string Title_tr;
        public string srTitle_tr
        {
            get { return Title_tr; }
            set { Title_tr = value; }
        }

        private string Title_en;
        public string srTitle_en
        {
            get { return Title_en; }
            set { Title_en = value; }
        }

        private int AuthorityLevel;
        public int irAuthorityLevel
        {
            get { return AuthorityLevel; }
            set { AuthorityLevel = value; }
        }
    }

    public static clsUserTitles returnUserTitles(string srUserAuthority)
    {
        return dicAuthorities[srUserAuthority];
    }
} 
```

**字典只会被初始化 1 次。以后不添加删除更新。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:22:39.713

快速浏览您的代码，在我看来，您的第一个问题将是公开可用的字典`dicAuthorities`。字典不是线程安全的。根据您要对该字典执行的操作，您需要实现一些东西来规范对它的访问。请参阅此相关问题：

[使字典访问线程安全？](https://stackoverflow.com/questions/2940241/making-dictionary-access-thread-safe)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T22:32:03.527

字典支持线程安全阅读。[这是来自MSDN](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)的证明：

> 只要不修改集合，字典就可以同时支持多个阅读器。即便如此，通过集合枚举本质上不是线程安全的过程。在枚举与写访问竞争的极少数情况下，必须在整个枚举期间锁定集合。要允许集合被多个线程访问以进行读写，您必须实现自己的同步。

因此，如果您打算只从中读取数据，它应该可以工作。但是，我不相信您的字典只填写一次并且在您的应用程序工作期间不会被修改。在这种情况下，这个线程中的所有其他人都是正确的，有必要同步访问这个字典，最好使用[ConcurrentDictionary](http://msdn.microsoft.com/en-us/library/dd287191.aspx)对象。

现在，我想谈谈设计本身。如果要在用户之间存储共享数据，请改用专为此目的设计的[ASP.NET 缓存。](http://msdn.microsoft.com/en-us/library/xsbfdd8c%28v=vs.71%29.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T22:33:21.623

正如其他人所说，`Dictionary<TKey,TValue>`它本质上不是线程安全的。但是，如果您的使用场景是：

1.  启动时填写字典
2.  在应用程序运行时使用该字典作为查找
3.  启动后切勿添加或删除值

比你应该没问题。

但是，如果您使用 .net 4.5，我建议您通过使用[`ReadOnlyDictionary`](http://msdn.microsoft.com/en-us/library/gg712981.aspx)

因此，您的实现可能看起来像这样（将编码风格更改为对 C# 更友好）

```
private static readonly ReadOnlyDictionary<string, UserTitles> authorities;

static PublicFunctions()
{
    Dictionary<string, UserTitles> authoritiesFill = new Dictionary<string, clsUserTitles>();
    using (DataTable dtTemp = DbConnection.db_Select_DataTable("select * from myTable"))
    {
        foreach (DataRow drw in dtTemp.Rows)
        {
            UserTitles userTitle = new UserTitles
            {
              AuthorityLevel = Int32.Parse(drw["Level"].ToString()),
              TitleTurkish = drw["Title_tr"].ToString();
              TitleEnglish = drw["Title_en"].ToString();
            }
            authoritiesFill.Add(drw["authorityLevel"].ToString(), userTitle);
        }
    }
    authorities = new ReadOnlyDictionary<string, UserTitles>(authoritiesFill);
} 
```

我还`readonly`为声明本身添加了一个修饰符，因为这样可以确保它不会在运行时被另一个字典替换。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-10T22:37:00.833

不，您的代码不是线程安全的。

*   [ *EDIT*不适用 - 在静态构造函数中设置/创建] 字典（如 System Down 回答所指出的）在更新时不是线程安全的。字典不是只读的 - 因此无法保证它不会随着时间的推移而修改。
*   [*编辑*不适用-在静态构造函数中设置/创建]初始化不受任何锁的保护，因此您最终会同时进行多个初始化
*   您的条目是可变的 - 因此，如果您获得每个条目的一致值，则很难推理
*   [ *EDIT*不适用 - 仅在静态构造函数中修改] 保存字典的字段不是只读的 - 根据代码，如果不缓存指向字典本身的指针，则最终可能会出现不一致的数据。

旁注：尝试遵循 C# 的编码指南并调用以大写 MySpecialClass 开头的类，并具有反映类目的的名称（或明确的示例名称）。

编辑：我的大部分观点都不适用，因为字典的唯一初始化是在静态构造函数中。从线程安全的角度来看，这使得初始化是安全的。请注意，静态构造函数内部的初始化将在“首次使用之前”的不确定时刻发生。它可能导致意外行为 - 即当访问数据库时可能使用错误的“当前”用户帐户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T22:25:16.433

您的问题的答案是否定的，它不是线程安全的。`Dictionary`不是线程安全的集合。如果要使用线程安全字典，请使用[ConcurrentDictionary](http://msdn.microsoft.com/en-us/library/dd287191.aspx)。

除此之外，很难说你是否`csPublicFunctions`是线程安全的，因为它取决于你如何处理调用中的数据库连接`DbConnection.db_Select_DataTable`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-10T22:36:36.607

只有 public 没有线程安全问题`Dictionary`。是的，字典填充是线程安全的。但是这个字典的另一个修改不是线程安全的。如上所述 -`ConcurrentDictionary`可以提供帮助。

另一个问题是你的类`clsUserTitles`也不是线程安全的。如果`clsUserTitles`仅用于阅读，您可以将每个属性设置器设为`clsUserTitles`私有。`clsUserTitles`并从构造函数初始化这些属性。

# macos - Applescript System Events Returns .DS_Store - How can I ignore

> ID：14268319
> 
> 赞同：0
> 
> 时间：2013-01-10T22:19:22.803
> 
> 标签：macos, applescript, osx-lion

I have looked around on the net for hours looking for this answer so I apologize if its there somewhere. This script below works fine except for the fact that it returns the .DS_Store file how can I exclude it from this query and all other hidden files for that matter but because I am creating the folder in my script the only one there is .DS_Store

**tell application "System Events" set listOfInputs to POSIX path of every disk item of folder a as list end tell**

Here is the full script below. I have been dropping files into the in folder after it is created but will eventually prompt for files before it is created.

on run

```
tell application "Finder"
    if not (exists folder "IN") then
        make new folder at desktop with properties {name:"IN"}
    end if
    if not (exists folder "OUT") then
        make new folder at desktop with properties {name:"OUT"}
    end if
end tell

set theINfolder to path to the desktop as string
set a to theINfolder & "IN:"

tell application "System Events"
    set listOfInputs to POSIX path of every disk item of folder a as list
end tell

set inputs to listOfInputs

set theOutfolder to path to the desktop as string
set outputFolder to theOutfolder & "OUT:"

set params to {}

main(inputs, outputFolder, params) 
```

end run

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:39:09.207

The following will work:

```
set listOfInputs to list folder a without invisibles 
```

But `without invisibles` cannot be combined with `POSIX path`, so we use a loop instead:

```
set listOfInputs to {}
tell application "System Events"
    set the_items to list folder a without invisibles
    repeat with i from 1 to the count of the_items
        set this_item to alias ((a as Unicode text) & (item i of the_items))
        set end of listOfInputs to POSIX path of this_item
    end repeat
end tell 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T04:56:38.820

The List Folder command has been deprecated and may stop working unexpectedly.

Try:

```
set inFolder to (path to desktop as text) & "IN"
do shell script "mkdir -p " & quoted form of (POSIX path of inFolder)
set listOfInputs to paragraphs 2 thru -1 of (do shell script ("find " & quoted form of (POSIX path of inFolder) & " \\! -name \".*\"")) 
```

You can get the result as a string separated by spaces like this:

```
set inFolder to (path to desktop as text) & "IN"
do shell script "mkdir -p " & quoted form of (POSIX path of inFolder)
set {TID, text item delimiters} to {text item delimiters, " "}
set listOfInputs to paragraphs 2 thru -1 of (do shell script ("find " & quoted form of (POSIX path of inFolder) & " \\! -name \".*\"")) as text
set text item delimiters to TID 
```

# c++ - 将 goto 标签暴露给符号表

> ID：14268325
> 
> 赞同：3
> 
> 时间：2013-01-10T22:20:09.337
> 
> 标签：c++, c, gcc, symbols, goto

我想知道是否可以将函数中的 goto 标签暴露给 C/C++ 的符号表

例如，我想让以下代码段的*ret*标签出现在符号表中，并且可以使用标准 API（如 dlsym()）进行引用。

提前感谢您的帮助！

```
#include <stdio.h>

int main () {
  void *ret_p = &&ret;
  printf("ret: %p\n", ret_p);
  goto *ret_p;

  return 1;

  ret:
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T20:57:29.080

感谢[Marc Glisse](https://stackoverflow.com/users/1918193/marc-glisse)关于使用指定标签的内联汇编的评论，我可以为这个问题想出一个解决方法。以下示例代码片段显示了我是如何解决问题的。

```
#include <stdio.h>

int main () {
  void *ret_p = &&ret;
  printf("ret: %p\n", ret_p);
  goto *ret_p;

  return 1;

  ret:
  asm("RET:")

  return 0;
} 
```

这将添加一个符号表条目，如下所示。

```
jikk@sos15-32:~$ gcc  -Wl,--export-dynamic t.c  -ldl
jikk@sos15-32:~$ readelf -s a.out 

39: 08048620     0 FUNC    LOCAL  DEFAULT   13 __do_global_ctors_aux
40: 00000000     0 FILE    LOCAL  DEFAULT  ABS t.c
41: 0804858a     0 NOTYPE  LOCAL  DEFAULT   13 RET
42: 08048612     0 FUNC    LOCAL  DEFAULT   13 __i686.get_pc_thunk.bx
43: 08049f20     0 OBJECT  LOCAL  DEFAULT   19 __DTOR_END__

jikk@sos15-32:~$ ./a.out
ret: 0x804858a 
```

我将进一步测试此解决方法，以验证这是否会产生任何意外的副作用。

谢谢

# actionscript-3 - AS3：演员或“作为”？

> ID：14268329
> 
> 赞同：16
> 
> 时间：2013-01-10T22:20:16.433
> 
> 标签：actionscript-3, flash, casting, coding-style, conventions

两者在使用、效率或背景技术上有什么不同吗？

```
var mc:MovieClip = MovieClip(getChildByName("mc")); 
```

和

```
var mc:MovieClip = getChildByName("mc") as MovieClip; 
```

?

选择只是惯例、偏好问题，还是在某些情况下您不能使用？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-10T22:24:59.050

[本文](http://archive.darronschall.com/weblog/2006/02/actionscript-3-casting.html)很好地描述了这些差异：

> 强制转换和 as 运算符之间的一个关键区别是失败时的行为。当 ActionScript 2 中的强制转换失败时，将返回 null。当 ActionScript 3 中的强制转换失败时，会引发 TypeError。使用 ActionScript 3 中的 as 运算符，只要转换失败，就会返回数据类型的默认值。

`as`还允许您转换为`Array`，这在以前是不可能的，因为转换函数`Array()`优先。

**编辑：**关于性能，`as`据报道使用比各种文章中的函数调用样式转换更快：[ [1](http://jacksondunstan.com/articles/830) ][ [2](http://upshots.org/actionscript/20-tips-to-optimize-your-actionscript) ][ [3](http://gamedevjuice.wordpress.com/2008/02/15/seven-tips-about-performance-optimization-in-actionscript-3/) ]。引用的第一篇文章深入研究了性能差异，并报告说速度提高了`as`4 到 4.5 倍。

**编辑 2：**在正常的最佳情况下，不仅`as`速度快 4x-4.5x，而且当您将`(cast)`样式转换包装在 try-catch 块中时，实际上最终抛出了一个错误，它更像是 30x - 230x 快。在 AS3 中，如果您认为您将要做一些特殊的事情（因为它可能会引发错误），那么很明显您应该始终在跳跃之前查看。除非 API 强制，否则永远不要使用 try/catch，实际上这意味着永远不要使用 try/catch`(cast)` 的性能影响，即使没有引发异常也是如此。即使在没有任何问题的情况下，设置 try/catch 块也会降低性能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T06:36:20.863

由于没有人直接回答性能方面的问题，而且在您的问题中，它`as`在运行时比`(cast)`在 AS3 中的效率和速度要快得多。

[http://jacksondunstan.com/articles/830](http://jacksondunstan.com/articles/830)

结合所有其他因素，我认为绝对没有理由使用`(cast)`并认为应该完全避免使用它。

下面撤回的评论实际上也让我想起了一个很好的观点。如果你`(cast)`那么你几乎肯定会发现自己处于必须尝试/抓住的情况

```
try{
    SubType(foo).bar();
}catch(e:TypeError){
    // Can't cast to SubType
} 
```

这是非常缓慢的。唯一的解决方法是`is`先检查

```
if(foo is SubType){ 
  SubType(foo).bar();
} 
```

这似乎是错误和浪费的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T22:25:34.520

[AS3 将一种类型转换为另一种类型也](https://stackoverflow.com/q/9660275/1313143)包含回答此问题的答案：“as”关键字`null`在转换失败时分配，否则它会抛出`TypeError`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T22:33:46.760

最佳做法是使用`as`关键字。

`as`具有不引发 RTE（运行时错误）的优点。例如，假设您有一个`Dog`无法转换为 MovieClip 的类；此代码将引发 RTE：

```
var dog:Dog = new Dog();
var mc:MovieClip = MovieClip(Dog); 
```

> TypeError：错误 #1034：类型强制失败：无法将 Dog 转换为 MovieClip。

为了使此代码“安全”，您必须将强制转换包含在`try`/`catch`块中。

另一方面，`as`会更安全，因为如果转换失败，它只会返回 null ，然后您可以自己检查错误，而无需使用`try`/`catch`块：

```
var dog:Dog = new Dog();
var mc:MovieClip = Dog as MovieClip;
if (mc) 
    //conversion succeeded
else
    //conversion failed 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-11T06:26:46.500

更喜欢使用强制转换而不是使用`as operator`. 仅当强制可能失败并且您希望表达式计算为 null 而不是引发异常时，才使用 as 运算符。

做这个：

```
IUIComponent(child).document 
```

不是这个：

```
(child as IUIComponent).document 
```

[编码约定](http://sourceforge.net/adobe/flexsdk/wiki/Coding%20Conventions/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-07-12T14:31:07.873

(cast) 和 "as" 是两个完全不同的东西。虽然“as”只是告诉编译器将对象解释为给定类型（仅适用于相同或子类或数字/字符串转换），但 (cast) 尝试使用目标类的静态转换函数. 这可能会失败（抛出错误）或返回目标类的新实例（不再是同一个对象）。这不仅解释了速度差异，还解释了错误事件的行为，如 Alejandro PS 所述

含义很清楚：如果编码器知道对象的类但编译器不知道对象的类，则使用“as”（因为被只命名超类或“*”的接口混淆了）。如果假定的类型（或与自动强制兼容的类型）不能 100% 确定，则建议在之前进行“is”检查或之后（更快）进行空检查。

如果必须将对象实际转换为另一个类（如果可能的话），将使用 (cast)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-07T13:02:35.800

进一步启动或不启动 RTE，或返回 null，当我们管理加载到单独应用程序域中的 swf 中的错误时，存在显着差异。

使用 Loader.uncaughtErrorEvents 处理加载的 swf 的错误；如果我们像 'event.error as Error' 那样进行转换，则生成的错误将具有原始堆栈跟踪（与导致错误的 swf 中捕获的相同），而如果使用 Error (event.error) 进行转换，则堆栈错误的跟踪将被当前的堆栈跟踪（进行强制转换的位置）更改。

示例代码：

```
if (event && event.error && event.error is Error) {
    debug ("Casting with 'as Error'") 
    debugStackTrace (event.error as Error); 
    debug ("casting with 'Error (...)'"); 
    debugStackTrace (Error (event.error)); 
} 
```

样本输出：

```
Casting with 'as Error' 
ReferenceError: Error # 1056 
at Player / onEnterFrame () 
casting with 'Error (...)' 
Error: ReferenceError: Error # 1056 
at package :: HandlerClass / uncaughtErrorHandler () 
at EventInfo / listenerProxy () 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-08T06:57:00.447

`var mc:MovieClip = MovieClip(getChildByName("mc"));`

将直接设置为电影剪辑

`var mc:MovieClip = getChildByName("mc") as MovieClip;`

将使 mc 像电影剪辑一样，如果需要的类型相同

# php - 如何设置 Gearman 在一台特定服务器上执行应用程序？

> ID：14268333
> 
> 赞同：1
> 
> 时间：2013-01-10T22:20:27.470
> 
> 标签：php, linux, ubuntu, gearman

这是我的情况：

我在负载均衡器下有多个服务器。我的用户能够将文件上传到服务器。这些文件需要修改并发送到另一台服务器。因此，我决定使用 Gearman 来管理将完成这项工作的 PHP 脚本队列。

这是问题所在。如果一台服务器出现故障会发生什么... 然后 gearman 执行代码以获取特定文件，但该文件位于出现故障的服务器上。我如何设置 Gearman 以等待发生故障的服务器最终获得正确的文件...也可能发生服务器可能不会关闭但由于 gearman 与其他服务器对话，它可能会在另一台机器上执行代码对于另一个服务器上的文件。

我怎样才能解决这个问题？无需将每个 Gearman 服务器彼此隔离。因为我会将它用于其他没有相同约束的事情。

# django - 将 django 模板中的第一个字母大写

> ID：14268342
> 
> 赞同：143
> 
> 时间：2013-01-10T22:20:56.780
> 
> 标签：django, django-templates

我从存储为`myname`. 如何在 Django 模板中将其显示为`Myname`，第一个字母为大写。

* * *

## 回答 #1

> 赞同：261
> 
> 时间：2013-01-10T22:23:06.837

[使用名为title](https://docs.djangoproject.com/en/stable/ref/templates/builtins/#title)的 Django 内置模板过滤器

```
{{ "myname"|title }} 
```

* * *

## 回答 #2

> 赞同：158
> 
> 时间：2013-05-24T08:29:11.103

我知道这有点晚了，但你可以使用[capfirst](https://docs.djangoproject.com/en/3.2/ref/templates/builtins/#capfirst)：

```
{{ "waiting for action"|capfirst }} 
```

这将导致“等待操作”

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2018-03-19T11:52:26.727

如果您有多个单词（例如全部大写），此解决方案也适用：

```
{{ "ALL CAPS SENTENCE"|lower|capfirst }} 
```

这将输出“All caps sentence”。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-01-11T02:48:38.233

过滤器`title`工作正常，但如果你有一个多字字符串，如: `"some random text"`，结果将是`"Some Random Text"`. 如果您真正想要的**只是**将整个字符串的第一个字母大写，您应该创建自己的自定义过滤器。

您可以像这样创建一个过滤器（按照有关如何从此[文档](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/)创建自定义模板过滤器的说明进行操作- 这很简单）：

```
# yourapp/templatetags/my_filters.py
from django import template

register = template.Library()

@register.filter()
def upfirstletter(value):
    first = value[0] if len(value) > 0 else ''
    remaining = value[1:] if len(value) > 1 else ''
    return first.upper() + remaining 
```

然后，您应该在模板中加载 my_filters 文件，并使用其中定义的过滤器：

```
{% load my_filters %}

...
{{ myname|upfirstletter }} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-08-20T13:39:21.993

它在模板变量中对我有用。

```
{{ user.username|title }} 
```

如果用户是“al hasib”，那么它将返回“Al Hasib”

或者

```
{{ user.username|capfirst }} 
```

如果用户是“hasib”，那么最后一个将返回“Hasib”

两者看起来都一样，但有一些不同。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-07-28T16:07:12.690

使用 `{{"myname"|title}}` 这将使每个单词的第一个字母大写

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-05-07T07:33:37.570

只需`{{myname | capfirst}}` 在 Django 中使用模板过滤器*capfirst*大写给定字符串的第一个字母。

# html - 弯曲图像超链接

> ID：14268343
> 
> 赞同：1
> 
> 时间：2013-01-10T22:21:03.240
> 
> 标签：html, css

是否有可能有一个圆形图像，例如（图像使用 alpha 通道），这样围绕它的超链接只会注册实际图像而不是 alpha'ed 位？

如果没有，还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:25:29.140

您可以为图像定义图像映射。

[http://en.wikipedia.org/wiki/Image_map](http://en.wikipedia.org/wiki/Image_map)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:28:01.493

我建议使用 CSS 来解决这个问题。

```
.yourclass {
-moz-border-radius: 15px;
border-radius: 15px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T23:49:50.190

当您单击它时，您可能希望删除它周围的丑陋方形轮廓？尝试添加到css：

```
img {border: none} 
```

并在实际的圆形图像A标签上，关闭轮廓：

```
<a href="#" style="outline: none"><img src="roundimage.jpg" /></a> 
```

您仍然会将指针光标从圆形部分上移开 - 如果您希望指针仅在您将鼠标悬停在圆形部分上时显示 - 从图像中制作图像地图并将地图区域形状设置为圆形。

# php - CQL 3.0 的 Cassandra PHP 客户端

> ID：14268349
> 
> 赞同：9
> 
> 时间：2013-01-10T22:21:26.093
> 
> 标签：php, client, cassandra, cql

我最近将我的 cassandra 集群升级到 1.2，并且我搜索了一个支持 Cassandra 1.2、具有完整 CQL 3.0 并使用新协议（不是 thrift）的 php 客户端。

如今，phpcassa、simplecassie、cassandra-pdo 等似乎都不支持完整的 CQL 3.0（例如，复合类型和集合返回数据错误）。我也没有发现任何公开的努力来制作一个完全支持的 php 客户端。

任何人都知道任何接近全面支持的 php 客户端，或者它正在走向它？或者，如果不在 php 中，也许在 python 中？

# performance - Python 运行速度比 MATLAB 慢

> ID：14268354
> 
> 赞同：3
> 
> 时间：2013-01-10T22:21:54.577
> 
> 标签：performance, numpy, python-3.x, fft

我正在将我在 MATLAB 中编写的数值方法转换为 Python。由于某种原因，几乎相同的 Python 代码运行速度要慢得多。这里`U`和`V`是在每个时间步解决的未知数。`U[:,n]`和的大小`V[:,n]`为 700x1。其余变量（`dt`、`A`和`denom`）是常量。这是循环（`numpy`已导入为`*`）：

```
for n in range(0, 400):
    UnVn2 = fft.fft(U[:, n] * V[:, n] ** 3)
    U[:, n +1 ] = fft.ifft((fft.fft(U[:, n]) / dt - UnVn2 + A) / denom)
    V[:, n + 1] = fft.ifft((fft.fft(V[:, n]) / dt + UnVn2) / denom) 
```

有什么建议么？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:36:55.920

有关使 python 和 numpy 使用与 MATLAB 一起提供的相同加速 FFT 例程的说明，请参阅[此内容。](http://software.intel.com/en-us/articles/numpyscipy-with-intel-mkl)

如果您有 AMD 处理器，请参阅[这些](http://projects.scipy.org/numpy/ticket/740)说明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T00:07:23.453

我不确定为什么 Python 比 Matlab 慢，但是......

作为傅立叶变换的 FFT 具有许多[属性](http://en.wikipedia.org/wiki/Fourier_transform#Properties_of_the_Fourier_transform)，它们会产生大多数（全部）不必要的 FFT 操作：

```
def func1(U, V, dt, denom, A) :
    UnVn2 = np.fft.fft(U * V**3)
    U_ = np.fft.ifft((np.fft.fft(U) / dt - UnVn2 + A) / denom)
    V_ = np.fft.ifft((np.fft.fft(V) / dt + UnVn2) / denom)
    return np.vstack((U_, V_))

def func2(U, V, dt, denom, A) :
    UnVn2 = U * V**3
    U_ = (U / dt - UnVn2) / denom
    U_[0] += A / denom
    V_ = (V / dt + UnVn2) / denom
    return np.vstack((U_, V_))

U = np.random.rand(700)
V = np.random.rand(700)
dt, denom, A = tuple(np.random.rand(3))

>>> func1(U, V, dt, denom, A)
array([[ 2.35201751 -1.11022302e-16j,  0.81099082 -2.45463372e-16j,
         0.48451858 +2.15658782e-18j, ...,  2.23237712 -5.24753851e-16j,
         1.15264205 -2.31140087e-16j,  1.06670009 +1.28369537e-16j],
       [ 2.89314136 +8.67361738e-17j,  3.65612404 -7.80625564e-17j,
         3.31383830 +8.96916836e-17j, ...,  0.90415910 +6.27969898e-16j,
         3.03505664 +4.72358723e-16j,  0.64669863 +4.99600361e-16j]])
>>> func2(U, V, dt, denom, A)
array([[ 2.35201751,  0.81099082,  0.48451858, ...,  2.23237712,
         1.15264205,  1.06670009],
       [ 2.89314136,  3.65612404,  3.3138383 , ...,  0.9041591 ,
         3.03505664,  0.64669863]])
>>> np.max(np.abs(func1(U, V, dt, denom, A) - func2(U, V, dt, denom, A)))
1.5151595604785605e-15 
```

而且当然：

```
>>> import timeit
>>> timeit.timeit('func1(U, V, dt, denom, A)', 'from __main__ import func1, U, V, dt, denom, A', number=400)
0.14169366197616284
>>> timeit.timeit('func2(U, V, dt, denom, A)', 'from __main__ import func2, U, V, dt, denom, A', number=400)
0.06098524703428154 
```

我不得不承认这比我预期的要少，但它仍然快了近 3 倍。

**编辑** 不做 FFT 的速度似乎太小了，所以我修改`func1`并`func2`返回一个元组`(U_, V_)`并运行以下代码：

```
from time import clock
U = np.zeros((700,400), dtype=np.float)
V = np.zeros((700,400), dtype=np.float)
U[:,0] = np.random.rand(700)
V[:,0] = np.random.rand(700)
dt, denom, A = tuple(np.random.rand(3))
t = clock()
for j in xrange(399) :
    U[:, j+1], V[:, j+1] = func1(U[:, j], V[:, j], dt, denom, A)
print clock() - t
t = clock()
for j in xrange(399) :
    U[:, j+1], V[:, j+1] = func2(U[:, j], V[:, j], dt, denom, A)
print clock() - t 
```

打印输出是这样`11.5148652438`，`0.321673111194`所以实际问题设置中的加速更像是 x30。

我还对 pwuertz 的提案进行了计时，没有明显改进，`11.1805414552`并且`0.297830755317`针对以下代码：

```
U = np.zeros((400, 700), dtype=np.float)
V = np.zeros((400, 700), dtype=np.float)
U[0] = np.random.rand(700)
V[0] = np.random.rand(700)
dt, denom, A = tuple(np.random.rand(3))
t = clock()
for j in xrange(399) :
    U[j+1], V[j+1] = func1(U[j], V[j], dt, denom, A)
print clock() - t
t = clock()
for j in xrange(399) :
    U[j+1], V[j+1] = func2(U[j], V[j], dt, denom, A)
print clock() - t 
```

不过，它看起来确实要整洁得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T23:16:20.997

我不确定 MatLab 如何在多维数组中组织轴，但我很确定 numpy 使用类似 C 的[行优先顺序](http://en.wikipedia.org/wiki/Row-major_order "行主要顺序")（编辑：维基百科甚至提到 MatLab 使用列优先顺序；））。

由于您在单列上进行操作，因此您的所有操作都必须遍历行。对于行优先排序，这通常比遍历整行效率低。考虑转置二维数组的布局，您应该会获得显着的性能提升。

# qt - Pyside 改变布局

> ID：14268356
> 
> 赞同：3
> 
> 时间：2013-01-10T22:22:08.870
> 
> 标签：qt, pyside

我有一个界面，在屏幕顶部有 4 个按钮，在其下方我有 QFrame。我想根据按下的按钮更改 QFrame 中的布局。例如，如果 Button_1 被按下，则显示一个 TextEdit Widget，如果 Button_2 被按下，则显示一个 ListViewWidget。

有谁知道如何做到这一点？非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T08:55:24.163

使用 a[`QStackedLayout`](http://qt-project.org/doc/qt-4.8/qstackedlayout.html)来存储您的小部件。然后您可以更改为带有 的那个[`setCurrentIndex`](http://qt-project.org/doc/qt-4.8/qstackedlayout.html#currentIndex-prop)。或者，您可以使用 a[`QStackedWidget`](http://qt-project.org/doc/qt-4.8/qstackedwidget.html)代替您的`QFrame`.

一个简单的例子：

```
import sys
from PySide import QtGui

class Window(QtGui.QWidget):
    def __init__(self, parent=None):
        super(Window, self).__init__(parent)

        self.textEdit = QtGui.QTextEdit('Text Edit')
        self.listWidget = QtGui.QListWidget()
        self.listWidget.addItem('List Widget')
        self.label = QtGui.QLabel('Label')

        self.stackedLayout = QtGui.QStackedLayout()
        self.stackedLayout.addWidget(self.textEdit)
        self.stackedLayout.addWidget(self.listWidget)
        self.stackedLayout.addWidget(self.label)

        self.frame = QtGui.QFrame()
        self.frame.setLayout(self.stackedLayout)

        self.button1 = QtGui.QPushButton('Text Edit')
        self.button1.clicked.connect(lambda: self.stackedLayout.setCurrentIndex(0))
        self.button2 = QtGui.QPushButton('List Widget')
        self.button2.clicked.connect(lambda: self.stackedLayout.setCurrentIndex(1))
        self.button3 = QtGui.QPushButton('Label')
        self.button3.clicked.connect(lambda: self.stackedLayout.setCurrentIndex(2))

        buttonLayout = QtGui.QHBoxLayout()
        buttonLayout.addWidget(self.button1)
        buttonLayout.addWidget(self.button2)
        buttonLayout.addWidget(self.button3)

        layout = QtGui.QVBoxLayout(self)
        layout.addLayout(buttonLayout)
        layout.addWidget(self.frame)

if __name__ == '__main__':
    app = QtGui.QApplication(sys.argv)

    w = Window()
    w.show()

    sys.exit(app.exec_()) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T22:32:49.887

就像是...

```
myframe.layout().removeWidget(mywidget)
mywidget = QTextEdit()
myframe.layout().addWidget(myWidget) 
```

# ruby-on-rails-3 - Rails 3.2 质量分配

> ID：14268367
> 
> 赞同：0
> 
> 时间：2013-01-10T22:23:26.140
> 
> 标签：ruby-on-rails-3, mass-assignment

我希望我能在我最近升级的 Rails 3.2 应用程序中获得一些关于批量分配问题的帮助。

我知道在 Rails 3.2 中，属性默认情况下是锁定的，为了分配它们，我需要使用 attr_accessible “解锁”它们。这适用于普通模型属性。

但是，我有一个自制的自定义属性 mixin，它允许我向任何模型添加任意命名的属性。这些属性存储在 custom_properties 表中。如果我向模型询问诸如 foo.property_foobar 之类的属性，则此 mixin 会利用缺少的方法从该表中查找属性。

使用此 mixin 的每个模型都可以具有 X 具有任意名称的自定义属性。我没有能力指定这些属性的名称，这显然很难添加到 attr_accessible。

有没有人建议我如何允许对这些动态属性进行批量分配？我宁愿不将所有模型属性列入白名单。

希望所有这些都有意义。感谢大家！

路易斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:08:21.580

一种解决方案是`attr_protected`改用。这允许您将某些属性列入黑名单，同时允许其余属性。但是，这有点难以确保。

另一种解决方案是将分配保护移至控制器，并根据需要在每个控制器/操作中允许/拒绝属性。有一个名为[strong parameters](https://github.com/rails/strong_parameters)的 gem允许这样做，它也将包含在 Rails 4 中。我建议这个解决方案。

如果上述方法都不适合您，也许您应该尝试另一种方法来实现这些任意属性？例如，您可以将它们作为序列化哈希存储在数据库列中。

# c# - 在两个单独的 StringCollections 中逐行合并

> ID：14268368
> 
> 赞同：0
> 
> 时间：2013-01-10T22:23:27.320
> 
> 标签：c#, wpf, stringcollection

我正在尝试获取两个字符串集合并同时组合两个集合中的每一行，以便为我的用户显示完整的文件路径。

帮助消除混淆的示例：

*   字符串集合 1 将包含路径列表。
    例子：

    ```
    C:\windows\xxxx\xxx\xx, C:\Users\xxx\xxx, C:\test\xxx\xxx 
    ```

*   字符串集合 2 将包含文件名列表。
    例子：

    ```
    file.txt, asd.txt, mydll.dll 
    ```

每个列表都在同一行号中相互保存密钥，我只需将它们组合起来即可将它们输出给最终用户。

```
String Collection Line 1 + SC2 Line 1 = Path
SC Line 2 + SC2 Line 2 = Path
SC Line 3 + SC2 Line 3 = Path 
```

在组合状态下无法访问信息，因此我将把数据放入两个单独的 WPF 文本框，然后将它们的内容拉入字符串集合。

第一次收藏

```
StringCollection lines = new StringCollection();
int lineCount = filePath.LineCount;

for (int line = 0; line < lineCount; line++)
    // Get line text and add to string collection
    lines.Add(filePath.GetLineText(line)); 
```

第二次收藏

```
StringCollection lines2 = new StringCollection();
int lineCount2 = fileName.LineCount;

for (int line = 0; line < lineCount; line++)
    // Get line text and add to string collection
    lines.Add(fileName.GetLineText(line)); 
```

任何和所有的帮助表示赞赏！

**编辑 1**

感谢 Eve，我已经尝试了 ZIP 命令，但我也找到了一条替代路线。与下面的代码相比，使用 zip 是否有更安全的路线？

请记住，我将具有检查行数并确保它们相同的功能。

```
 StringCollection lines = new StringCollection();
        int lineCount = itemIDBox.LineCount;

        for (int line = 0; line < lineCount; line++)
        {
            string id;
            string rev;
            string combined;

            id = itemIDBox.GetLineText(line);
            rev = revBox.GetLineText(line);

            combined = id + @"\" + rev;

            lines.Add(combined);
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:27:27.200

您可以使用 中的`Zip`方法`System.Linq`。

```
var fullPaths = lines.Cast<string>().
    Zip(lines2.Cast<string>(), (path, fileName) => Path.Combine(path, fileName)).
    ToArray(); 
```

# css - 如何将页脚保持在底部，背景为 100%？

> ID：14268371
> 
> 赞同：-1
> 
> 时间：2013-01-10T22:23:40.253
> 
> 标签：css, html, background, footer, sticky-footer

我试图弄清楚如何在我的网页底部添加页脚，但它似乎并没有“粘”在底部，我不知道是不是我的背景图片 100% 导致了问题，所以我需要帮助将页脚保持在底部，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:56:54.117

如果您希望它无论如何都在文档的最底部添加页脚，那么您可以使用`position:absolute`& `bottom:0px`。背景图像不应影响其定位。

请看这个[小提琴](http://jsfiddle.net/Z9zjg/)

是的，看看你当前的代码不起作用会很有帮助。

# c - 以下 for 循环语法在 C 中是什么意思？

> ID：14268372
> 
> 赞同：1
> 
> 时间：2013-01-10T22:23:41.367
> 
> 标签：c, for-loop

我遇到了这种语法，不知道它是什么意思。

```
 for( ; ; )
  {
    //do stuff like read from a handle etc.
  } 
```

我仍然在 C 语言的学习曲线上，所以如果你愿意，如果这是一个蹩脚的问题，请投反对票。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T22:24:26.917

这是一个无限循环。如同`while(1)`

真正要注意的唯一重要的事情是 for 循环看起来像`for (initialize vars; continue condition; counters)` . 由于没有 continue 条件，它只会继续运行（除非某处有 break 或 return 语句）。

# java - XML列表视图问题

> ID：14268374
> 
> 赞同：0
> 
> 时间：2013-01-10T22:23:43.450
> 
> 标签：java, android

尝试使用我的数据库查询结果设置列表视图。

无论如何，我从我的列表视图中收到了一个奇怪的 XML 参考 ID 错误。任何人都可以在这里看到这个问题吗？我猜是导致问题的“@id”引用？

这是我的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<ListView
    android:id="@+id/contentList"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
</ListView>

</LinearLayout> 
```

还有我的java类：

错误在“R.id.conactList”上。

```
ListView listContent = (ListView)findViewById(R.id.contentList); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:32:58.367

这对我来说看起来不错。您可以更改`></ListView>`为`/>`稍微清理 xml。尝试清理您的项目以确保您的 R 文件得到更新。有日志可以发吗？究竟是什么错误？

# android - 从后台更新前台活动

> ID：14268375
> 
> 赞同：0
> 
> 时间：2013-01-10T22:23:43.777
> 
> 标签：android

我有`ListView`一个由 SQLITE 表填充的 ，该表由蓝牙 spp 输入通过使用`Handler`. （蓝牙条码扫描仪执行扫描和增量功能来修改表格中的行。）我`startActivityForResult`在 a`ListItemClick`上调​​出更详细的视图并能够更改记录信息。当详细视图处于活动状态时，其他扫描将继续更新原始表和 ListView。

有没有办法通知活动的“详细”视图后台表已更改（从而使前台活动能够显示新数据）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T15:37:54.677

当您完成启动的活动使用 setresult 时，这将把控制权交还给 onactivityresult 回调上一个活动从它启动的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:31:56.630

您可以将 Intents 发送到“详细”活动，其中包含表示新数据的附加内容。在活动中，重写[onNewIntent](http://developer.android.com/reference/android/app/Activity.html#onNewIntent%28android.content.Intent%29)以拦截它们。您还需要在清单中将详细活动的启动模式指定为 singleTop

# c# - SpriteBatch.End() 抛出 OpenTK.Graphics.GraphicsErrorException: InvalidEnum

> ID：14268379
> 
> 赞同：0
> 
> 时间：2013-01-10T22:24:12.787
> 
> 标签：c#, linux, opentk, monogame

我决定用 MonoGame 开始游戏开发，但我遇到了一个问题。

当我尝试使用 SpriteBatch 对象将精灵添加到屏幕上时，就像我在许多 XNA 教程中看到的那样，我得到了一个 OpenTK.Graphics.GraphicsErrorException。

```
 protected override void Draw (GameTime gameTime)
    {
        graphics.GraphicsDevice.Clear (Color.CornflowerBlue);

        spriteBatch.Begin();
        spriteBatch.Draw(spriteTexture, position, Color.White);
        spriteBatch.End(); // <—— Exception here

        base.Draw (gameTime);
    } 
```

Exception.Message 说*InvalidEnum*。

```
OpenTK.Graphics.GraphicsErrorException: InvalidEnum
  at OpenTK.Graphics.OpenGL.ErrorHelper.CheckErrors () [0x000c0] in /home/sam/Téléchargements/opentk/src/opentk/Source/OpenTK/Graphics/OpenGL/ErrorHelper.cs:118
  at OpenTK.Graphics.OpenGL.ErrorHelper.Dispose () [0x00000] in /home/sam/Téléchargements/opentk/src/opentk/Source/OpenTK/Graphics/OpenGL/ErrorHelper.cs:129
  at OpenTK.Graphics.OpenGL.GL.TexEnv (TextureEnvTarget target, TextureEnvParameter pname, Int32 param) [0x0001e] in /home/sam/Téléchargements/opentk/src/opentk/Source/OpenTK/Graphics/OpenGL/GL.cs:69308
  at Microsoft.Xna.Framework.Graphics.SpriteBatch.End () [0x00000] in <filename unknown>:0
  at FirstGame.Game1.Draw (Microsoft.Xna.Framework.GameTime gameTime) [0x0003c] in /home/sam/Developpement/C#/Test/FirstGame/Game1.cs:82
  at Microsoft.Xna.Framework.Game.DoDraw (Microsoft.Xna.Framework.GameTime gameTime) [0x00000] in <filename unknown>:0
  at Microsoft.Xna.Framework.GameWindow.OnRenderFrame (System.Object sender, OpenTK.FrameEventArgs e) [0x00000] in <filename unknown>:0
  at OpenTK.GameWindow.OnRenderFrame (OpenTK.FrameEventArgs e) [0x0000b] in /home/sam/Téléchargements/opentk/src/opentk/Source/OpenTK/GameWindow.cs:976
  at OpenTK.GameWindow.OnRenderFrameInternal (OpenTK.FrameEventArgs e) [0x00016] in /home/sam/Téléchargements/opentk/src/opentk/Source/OpenTK/GameWindow.cs:1032
  at OpenTK.GameWindow.RaiseRenderFrame (System.Diagnostics.Stopwatch render_watch, System.Double& next_render, OpenTK.FrameEventArgs render_args) [0x00104] in /home/sam/Téléchargements/opentk/src/opentk/Source/OpenTK/GameWindow.cs:527
  at OpenTK.GameWindow.DispatchUpdateAndRenderFrame (System.Object sender, System.EventArgs e) [0x00018] in /home/sam/Téléchargements/opentk/src/opentk/Source/OpenTK/GameWindow.cs:433
  at OpenTK.GameWindow.Run (Double updates_per_second, Double frames_per_second) [0x000d5] in /home/sam/Téléchargements/opentk/src/opentk/Source/OpenTK/GameWindow.cs:411
  at OpenTK.GameWindow.Run (Double updateRate) [0x00000] in /home/sam/Téléchargements/opentk/src/opentk/Source/OpenTK/GameWindow.cs:358
  at Microsoft.Xna.Framework.GameWindow.Run (Double updateRate) [0x00000] in <filename unknown>:0
  at Microsoft.Xna.Framework.LinuxGamePlatform.RunLoop () [0x00000] in <filename unknown>:0
  at Microsoft.Xna.Framework.Game.Run (GameRunBehavior runBehavior) [0x00000] in <filename unknown>:0
  at Microsoft.Xna.Framework.Game.Run () [0x00000] in <filename unknown>:0
  at FirstGame.Program.Main () [0x0000a] in /home/sam/Developpement/C#/Test/FirstGame/Program.cs:21 
```

就像这是非常基本的东西，我不知道我是否错过了什么……</p>

我在最新的 ArchLinux 安装下使用来自 MonoDevelop 的 MonoGame 版本 2.5.10。Mono 版本是 2.10.8，OpenTK 版本是最新的稳定版本（2010.10.06）。

# jquery - jQuery标签插件，如何获取用户输入值？

> ID：14268382
> 
> 赞同：1
> 
> 时间：2013-01-10T22:24:22.080
> 
> 标签：jquery, jquery-ui, autocomplete

我正在使用这个标记插件：http: [//xoxco.com/projects/code/tagsinput/](http://xoxco.com/projects/code/tagsinput/)

文档中未涵盖的一件事是如何获取当前**输入的**值。我需要这个来为自定义自动完成器构建查询字符串。

```
$('#tags').tagsInput({    
  autocomplete_url:'http://myserver.com/api/autocomplete?term='(??????),
  autocomplete:{selectFirst:true,width:'100px',autoFill:true}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:09:48.370

[我决定查看自动完成](http://api.jqueryui.com/autocomplete/)器本身并从那里提取值，而不是查看解决方案的标记插件。

```
var tags = [ "c++", "java", "php", "coldfusion", "javascript", "asp", "ruby" ];
$( "#autocomplete" ).autocomplete({
  source: function( request, response ) {
          var matcher = new RegExp( "^" + $.ui.autocomplete.escapeRegex( request.term ), "i" );
          response( $.grep( tags, function( item ){
              return matcher.test( item );
          }) );
      }
}); 
```

从这里我注意到了这个`request.term`变量，然后我可以获取我自己的 Ajax 调用参数。

# c# - .NET 中用户友好的属性名称，如 Rails 中的属性名称

> ID：14268390
> 
> 赞同：4
> 
> 时间：2013-01-10T22:24:48.340
> 
> 标签：c#, .net, asp.net-mvc

在 Ruby on Rails 中，配置中有一个 YAML 文件，可让您定义模型属性名称的纯英文版本。实际上，它可以让你定义简单的任何语言版本：它是国际化的一部分，但大多数人使用它来向用户显示模型验证结果。

我的 .NET MVC 4 项目中需要这种功能。用户提交一个表单并收到一封包含他们发布的几乎所有内容的电子邮件（表单绑定到模型）。我编写了一个辅助方法来通过反射转储出属性/值对的 HTML 表，例如

```
foreach (PropertyInfo info in obj.GetType()
    .GetProperties(BindingFlags.Public | 
                   BindingFlags.Instance | 
                   BindingFlags.IgnoreCase)) 
{
  if (info.CanRead && !PropertyNamesToExclude.Contains(info.Name)) 
  {
    string value = info.GetValue(obj, null) != null ? 
                                            info.GetValue(obj, null).ToString() :
                                            null;
    html += "<tr><th>" + info.Name + "</th><td>" + value + "</td></tr>";
  }
} 
```

但是，当然，这打印出来`info.Name`就像“OrdererGid”，而“Orderer Username”可能会更好。.NET中有这样的东西吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-10T22:34:17.127

There is a data attribute called DisplayName which allows you to do this. Just annotate your model properties with this and a friendly name for each

```
[DisplayName("Full name")]
public string FullName { get; set; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T22:01:58.437

非常感谢@Stokedout 和@Clemens 的回答。实际上通过反射访问有点复杂。由于某种原因，我无法直接访问 CustomAttributes 属性。终于来到了这个：

```
DisplayNameAttribute dna = (DisplayNameAttribute)info
    .GetCustomAttributes(typeof(DisplayNameAttribute), true).FirstOrDefault();

string name = dna != null ? dna.DisplayName : info.Name;

string value = info.GetValue(obj, null) != null ? 
     (info.GetValue(obj, null).GetType().IsArray ? 
           String.Join(", ", info.GetValue(obj, null) as string[]) : 
           info.GetValue(obj, null).ToString()) : 
      null;

html += "<tr><th>" + name + "</th><td>" + value + "</td></tr>"; 
```

# c# - 为什么这个程序仍然输出“not null”？

> ID：14268397
> 
> 赞同：0
> 
> 时间：2013-01-10T22:25:08.943
> 
> 标签：c#, .net

为什么即使一切都是空的，这个程序仍然输出“not null”？！我必须改变什么才能最终使它为空？

“您的帖子没有太多解释代码部分的上下文；请更清楚地解释您的场景。” 对不起……

```
public interface IDrawable 
{
    void Draw();
}

public interface IAdvancedDraw : IDrawable
{
    void DrawInBoundingBox();
    void DrawUpsideDown();
}

public class BitmapImage : IAdvancedDraw
{
    public void Draw() { }
    public void DrawInBoundingBox() { }
    public void DrawUpsideDown() { }
}

class Program
{

    static void Main( string[] args )
    {

        BitmapImage myBitmap = new BitmapImage();

        if ((IAdvancedDraw)myBitmap != null){
            Console.WriteLine("not null"); 
        }

        Console.ReadLine();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:26:28.357

因为它已初始化，所以它不为空。

```
BitmapImage myBitmap = new BitmapImage(); 
```

[新操作员](http://msdn.microsoft.com/en-us/library/fa0ab757.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:27:54.050

你总是得到，`"not null'`因为总有*一些东西*在里面`myBitmap`——毕竟，你只是创建了一个`new BitmapImage()`并把它放在那里！

# php - sql文件扩展类型

> ID：14268401
> 
> 赞同：13
> 
> 时间：2013-01-10T22:25:28.387
> 
> 标签：php

**什么是sql扩展类型？**
我只想上传到服务器中的某个文件夹 .sql 文件。
我知道对于 txt 是文本/纯文本。什么是 sql 文件？

```
 if($_FILES['userfile']['type'] != 'THE SQL EXTENSION'){
    echo ' File is not an sql file.';
    exit;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2015-04-20T19:26:12.293

根据 IANA 的官方回答是`application/sql`。请参阅[http://www.iana.org/assignments/media-types/media-types.xhtml](http://www.iana.org/assignments/media-types/media-types.xhtml)和[https://www.rfc-editor.org/rfc/rfc6922](https://www.rfc-editor.org/rfc/rfc6922)

但是，由于很多人不屑于阅读文档，您可能还想接受`text/sql`,`text/x-sql`和`text/plain`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-10T22:32:06.623

~~SQL 没有特殊的 MIME 类型。只需使用`application/octet-stream`.~~

请参阅下面的@Vroo 答案（`application/sql`）。自 RFC6922 发布以来，此答案不再正确。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T22:38:30.830

没有办法仅根据 MIME 类型来检查它是否是 SQL 文件。正如其他人已经指出的那样，SQL 文件是文本/纯文本。如果您想确保只上传 SQL 文件，则必须对传入文件执行一些检查（例如运行检查 SQL 命令的正则表达式，或者甚至运行解析器/检查器，如果在 PHP 中可用）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T22:35:07.780

找出返回 $_FILES['userfile']['type']

用 echo $_FILES['userfile']['type'] 替换 echo ...

# shell - grep“cat 命令的输出 - 每一行”在不同的文件中

> ID：14268404
> 
> 赞同：3
> 
> 时间：2013-01-10T22:25:34.580
> 
> 标签：shell, grep, cat

抱歉，这个问题的标题有点令人困惑，但我想不出其他任何东西。我正在尝试做这样的事情

```
cat fileA.txt | grep `awk '{print $1}'` fileB.txt 
```

fileA 包含 100 行，而 fileB 包含 1 亿行。

我想要的是从fileA中获取id，在不同的file-fileB中grep该id并打印该行。

```
e.g fileA.txt
1234
1233

e.g.fileB.txt
1234|asdf|2012-12-12
5555|asdd|2012-11-12
1233|fvdf|2012-12-11 
```

预期输出为

```
1234|asdf|2012-12-12
1233|fvdf|2012-12-11 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-10T22:28:33.553

`cat`完全摆脱`awk`：

```
grep -f fileA.txt fileB.txt 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T22:48:07.160

单独的 awk 可以很好地完成这项工作：

```
awk -F'|' 'NR==FNR{a[$0];next;}$1 in a' fileA fileB 
```

看测试：

```
kent$  head a b
==> a <==
1234
1233

==> b <==
1234|asdf|2012-12-12
5555|asdd|2012-11-12
1233|fvdf|2012-12-11

kent$  awk -F'|' 'NR==FNR{a[$0];next;}$1 in a' a b
1234|asdf|2012-12-12
1233|fvdf|2012-12-11 
```

**编辑**

添加说明：

```
-F'|'  #| as field separator (fileA)
'NR==FNR{a[$0];next;} #save lines in fileA in array a
 $1 in a  #if $1(the 1st field) in fileB in array a, print the current line from FileB 
```

for further details I cannot explain here, sorry. for example how awk handle two files, what is NR and what is FNR.. I suggest that try this awk line in case the accepted answer didn't work for you. If you want to dig a little bit deeper, read some awk tutorials.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:28:04.363

如果 id 位于不同的行上，您可以使用以下`-f`选项`grep`：

```
cut -d "|" -f1 < fileB.txt | grep -F -f fileA.txt 
```

该`cut`命令将确保在模式搜索中使用 仅搜索第一个字段`grep`。

从手册页：

```
-f FILE, --file=FILE
Obtain patterns from FILE, one per line.  
The empty file contains zero patterns, and therefore matches nothing.
(-f is specified by POSIX.) 
```

# android - Dagger 在创建图形时抛出 NoSuchMethodException

> ID：14268406
> 
> 赞同：2
> 
> 时间：2013-01-10T22:25:41.730
> 
> 标签：android, dagger

我使用[Dagger](https://github.com/square/Dagger)作为依赖注入框架。到目前为止它运行良好，但我在使用 Dagger 进行 Android 单元测试时遇到问题，无法弄清楚原因（可能是因为不正确使用 Dagger）。

我有以下异常

```
java.lang.IllegalArgumentException: Failed to construct com.couchsurfing.mobile.android.CSApplication$ProdModule
at dagger.internal.plugins.reflect.ReflectiveModuleAdapter.newModule(ReflectiveModuleAdapter.java:94)
at dagger.internal.RuntimeAggregatingPlugin.getModuleAdapter(RuntimeAggregatingPlugin.java:99)
at dagger.internal.RuntimeAggregatingPlugin.collectIncludedModulesRecursively(RuntimeAggregatingPlugin.java:85)
at dagger.internal.RuntimeAggregatingPlugin.getAllModuleAdapters(RuntimeAggregatingPlugin.java:71)
at dagger.ObjectGraph.makeGraph(ObjectGraph.java:115)
at dagger.ObjectGraph.create(ObjectGraph.java:103)
at com.couchsurfing.mobile.android.core.MessageManagerTest.setUp(MessageManagerTest.java:34)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:190)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:175)
at android.test.InstrumentationTestRunner.onStart(InstrumentationTestRunner.java:555)
at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:1661)
Caused by: java.lang.NoSuchMethodException: <init> []
at java.lang.Class.getConstructorOrMethod(Class.java:460)
at java.lang.Class.getDeclaredConstructor(Class.java:588)
at dagger.internal.plugins.reflect.ReflectiveModuleAdapter.newModule(ReflectiveModuleAdapter.java:88)
... 15 more 
```

产生异常的代码如下：

```
public class MessageManagerTest extends InstrumentationTestCase {

    @Inject
    MessageManager mMessageManager;

    @Inject
    MessageOperations.Factory mMOFactory;

    @Inject
    Context mAppContext;

    @Override
    public void setUp() {
        ObjectGraph.create(new TestModule()).inject(this);
    }

    @Module(
        includes = CSApplication.ProdModule.class,
        entryPoints = MessageManagerTest.class,
        overrides = true)
    static class TestModule {
        @Provides
        MessageOperations.Factory provideMessageOperationsFactory() {
            return Mockito.mock(MessageOperations.Factory.class);
        }

        @Provides
        Context provideAppContext() {
            return Mockito.mock(Context.class);
        }
    }

    public void testCreateMessage() throws RemoteException, OperationApplicationException {

      ...
    }
} 
```

请注意，模块**CSApplication$ProdModule**在应用程序的生产版本中使用并且运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T01:35:54.970

您需要给 ProdModule 一个无参数的非私有构造函数。并且类需要是静态的。没有这个 Dagger 就无法构建你的模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T16:09:57.520

您需要添加一个无参数可访问（在本例中为公共）构造函数，或者您需要传入模块的实例。如果你不传入一个实例，那么 Dagger 必须自己构造模块，如果没有可访问的无参数构造函数，它就无法做到这一点。

# java - 如何以编程方式确定android是否连接到wifi？

> ID：14268407
> 
> 赞同：4
> 
> 时间：2013-01-10T22:25:49.530
> 
> 标签：java, android, wifimanager

我正在尝试在我正在开发的一个新的 android 应用程序上设置自动化测试，但其中一个 api 有点麻烦

我面临的问题是我想在 wifi 连接后开始测试，而不是在它处于连接状态时开始测试。我尝试了两种解决方案，但没有运气，并且测试似乎在我的 android 设备完全连接之前开始（wifi 条上没有 x）

```
wifiManager.setWifiEnabled(state);
WifiInfo wifiInfo = wifiManager.getConnectionInfo();
while (wifiInfo.getSSID() == null) {
    Log.i("WifiStatus", "Here I am");
    Thread.sleep(Time.ONE_SECOND);
    wifiInfo = wifiManager.getConnectionInfo(); 
```

这是我第一次尝试获取 SSID 以确定连接是否已建立。但是测试仍然在建立完整连接之前开始并且设置失败。

```
ConnectivityManager connManager = 
    (ConnectivityManager) con.getSystemService(Context.CONNECTIVITY_SERVICE);
NetworkInfo networkInfo = connManager.getNetworkInfo(ConnectivityManager.TYPE_WIFI);

wifiManager.setWifiEnabled(state);
while (!networkInfo.isConnected()) {
    Log.i("WifiStatus", "Here I am");
    Thread.sleep(Time.ONE_SECOND);
    networkInfo = connManager.getNetworkInfo(ConnectivityManager.TYPE_WIFI);
} 
```

第二个实现我使用连接管理器，而不是使用`isConnected()`.

有没有人有另一种方法我可以检查以确定设备是否已完全建立与 wifi 的连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T23:12:00.587

而不是手动获取网络信息......尝试获取“当前活动”网络并检查是否是wifi。注意：如果它为空，则意味着没有网络连接......所以它替换了 isConnected 调用。

```
ConnectivityManager connManager = 
    (ConnectivityManager) con.getSystemService(Context.CONNECTIVITY_SERVICE);
NetworkInfo current = connManager.getActiveNetworkInfo();
boolean isWifi = current != null && current.getType() == ConnectivityManager.TYPE_WIFI; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T22:58:46.923

如果您想这样称呼它，请发送“ping”。如果连接完成，您就知道您仍然处于连接状态。如果您得到 a`IOException`或 a `NullPointerException`，那么您可能已超时并且不再连接。

```
try {
        URL url = new URL("http://www.google.com");
        HttpURLConnection urlConnect = (HttpURLConnection) url.openConnection();
        urlConnect.setConnectTimeout(1000);
        urlConnect.getContent();
        System.out.println("Connection established.");
    } catch (NullPointerException np) {
        np.printStackTrace();
    } catch (IOException io) {
        io.printStackTrace();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-29T09:27:48.823

`wifiManager.getWifiState()== WifiManager.WIFI_STATE_ENABLED`当您获得完全连接时

# javascript - 在插件中调用 jQuery 插件公共函数

> ID：14268410
> 
> 赞同：0
> 
> 时间：2013-01-10T22:25:55.263
> 
> 标签：javascript, jquery

我知道，网上有很多例子，但是对于初学者来说很难从中找到一个真正的例子。所以我想用公共方法创建 jQuery 插件。示例代码：

```
(function($) {
    $.fn.peel = function(options) {
        var defaults = {
        };

        var settings = $.extend({},defaults, options);

        this.public = function() {
            alert("public");
        };

        var private = function() {
            alert("private");
        }

        return this.each(function() {
            //this.public();
            private();
        });
    };
})(jQuery); 
```

正如我发现的那样，这是制作公共功能的方法，可以这样调用：

```
var peel = $('img').peel();
peel.public(); 
```

到目前为止它按预期工作 - 可以调用 public() 。但是如果我想在我的插件中调用那个函数呢？我在 this.each() 中注释掉了，因为它不起作用。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:37:04.550

One way to create publicly accessible methods within your plugins is to use the [jQuery UI widget factory](http://wiki.jqueryui.com/w/page/12138135/Widget%20factory). This is the framework that jQuery UI uses for all of it's supported UI widgets. A quick example would look like this:

```
(function( $ ) {
    $.widget( "something.mywidget", {

    // Set up the widget
    _create: function() {

    },

    publicFunction: function(){
        //...
    }
  });
}( jQuery ) );

var $w = $('#someelement').mywidget();

$w.mywidget('publicFunction'); 
```

# java - 使用 Java 的 OOP：避免重复代码

> ID：14268415
> 
> 赞同：1
> 
> 时间：2013-01-10T22:26:22.503
> 
> 标签：java, oop

我想覆盖`toString()`几个类型为`Exception`or的个人异常的方法`RuntimeException`。

假设我想同时显示子类和子类`test`的`toString()`方法。我只需要覆盖一次。`Exception``RuntimeException``toString()`

由于Java不支持多继承，我该怎么做？我只是不想`toString()`为这两种异常编写 2 次方法...

例子 ：

```
public class SubClassOfException extends Exception {

    ...

   @Override
   public String toString() {   
      return "test";
   }

} 
```

我的目标是创建自定义方法`SubClassOfRuntimeException`并从中受益，因为它是.`toString()``SubClassOfException``RuntimeException``Exception`

有没有办法做到这一点，或者我必须将`toString()`代码复制到`SubClassOfException`and中`SubClassOfRuntimeException`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:40:01.090

由于您`SubClassOfException`的层次结构与 相同，因此您不能通过继承`RuntimeException`共享该方法。`toString()`

`toString()`但是，如果您的具体异常类型中的两种方法都将实际的字符串构建委托给一个通用的“异常字符串构建器” ，那么您也不需要复制代码。我的意思是

```
class ExceptionPrinter {
    public static String exceptionToString(Exception e) { ... }
} 
```

并且在两个异常类中

```
@Override
public String toString() {
    return ExceptionPrinter.exceptionToString(this);
} 
```

# c# - 更改 ListView 中的列

> ID：14268417
> 
> 赞同：6
> 
> 时间：2013-01-10T22:26:43.443
> 
> 标签：c#, winforms

我的应用程序包含`ListView`我正在处理的文件，并且有 3 列：文件名、长度和状态。在我的 for 循环中，我正在处理一个又一个文件，并希望在这种情况下将状态列从**wait**更改为开始时的值**in process**。是否可以更改一列？

lvFiles 是我的 ListView

```
for (int i = 0; i < lvFiles.Items.Count; i++)
{
    //here i am do things with my file
} 
```

在这里，我将文件添加到我的 ListView 中：

```
ListViewItem item = new ListViewItem(new string[] { new FileInfo(filePath).Name, duration, "Waiting" }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:40:54.370

使用[SubItems](http://msdn.microsoft.com/en-us/library/system.windows.forms.listviewitem.subitems.aspx)属性`ListViewItem`：

```
foreach(ListViewItem item in lvFiles.Items)
    item.SubItems[2].Text = "Waiting"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T22:30:53.420

如果你知道特定的列，你可以尝试这样的事情，例如地址是 colString[2] 你可以做一行

```
string[] colString = new string{ "Starting", "Paused", "Waiting" };
int colIndex = 0;
foreach (ColumnHeader lstViewCol in lvFiles.Columns)
{
  lstViewCol.Text = colString[colIndex];
  colIndex++;
} 
```

对于单列你说你想要第三列然后你可以这样

```
lvFiles.Colunns[2] = "waiting"; 
```

# javascript - 使用 document.getElementById(id)、$(id) 和 containerElement.find(id) 的速度差异

> ID：14268420
> 
> 赞同：1
> 
> 时间：2013-01-10T22:27:03.930
> 
> 标签：javascript, html, dom-traversal, dom

假设我在页面上有一个容器元素/div。它之外还有其他元素，包括页面布局/导航，其中有相当数量的内容。

在我的 javascript 中，我需要在该容器中查找/操作一些元素。如果所有这些元素都设置了 id 属性，速度明智，是更好地使用`document.getElementById()`（考虑到一旦找到，元素将需要转换为 jQuery 对象进行操作）来查找它们，或者像这样使用 jQuery 选择它们: `$("#id")`，或者先选择容器，将其存储在一个变量中，然后使用 jQuery 选择要操作的元素，如下所示`container.find("#id")`：

哪种方法更快？像这样的搜索速度取决于什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:21:57.433

与内部使用`jQuery()`的 id 选择器`document.getElementById`一样，直接使用 native 方法显然更快。当然开销是可以忽略不计的（你永远不需要通过 id 选择数百个元素），它们做不同的事情——很可能你想要一个包含 DOM 节点的 jQuery 包装器对象。

`container.find(idselector)`不过，这是一个有趣的案例。由于 id 在整个文档中都是唯一的，因此您根本不需要这样的表达式。正因为如此，id 选择通常由`O(1)`浏览器内的查找表增强，即使对于完整文档也非常快。我不确定当您在容器中使用它时会发生什么，但它可能会退回到相当慢的 DOM 树遍历。

# iphone - 在网格视图中按下了哪个按钮

> ID：14268421
> 
> 赞同：0
> 
> 时间：2013-01-10T22:27:07.497
> 
> 标签：iphone, ios, gridview, uibutton

晚上所有

我有以下代码来填充按钮网格，但是如何检测已选择哪个按钮并将按钮图像传递到另一个控制器

```
i =0; 
int i1=0; 
while(i<n){ 
int yy = 4 +i1*79; 
for(int j=0; j<4;j++){ 
if (i>=n) break; 
CGRect rect; 
rect = CGRectMake(4+79*j, yy, 75, 75); 
UIButton *button=[[UIButton alloc] initWithFrame:rect]; 
[button setFrame:rect]; 

id item = [items objectAtIndex:i]; 
NSString *imageLink = [item objectForKey:@"link"]; 

UIImage *buttonImageNormal=[UIImage imageWithData: [NSData dataWithContentsOfURL: [NSURLURLWithString: imageLink]]]; 

[button setBackgroundImage:buttonImageNormal forState:UIControlStateNormal]; 
button.tag =i; 
NSLog(@"index: %i", i); 
[button addTarget:self action:@selector(buttonPressed:) forControlEvents:UIControlEventTouchUpInside ]; 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:33:34.467

您将获得按下的按钮作为回调方法 (buttonPressed:) 的参数。只需以这种方式实现它：

```
- (void)buttonPressed:(UIButton *)senderButton {

    UIImage *image = [senderButton backgroundImageForState:UIControlStateNormal];
    //use image:)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T00:29:20.607

您可以给每个按钮一个标签，然后使用`-(void)buttonPressed:`之前发布的。使用该功能，您可以执行以下操作：

```
- (void)buttonPressed:(UIButton *)senderButton 
{
    if (senderButton.tag == 0) {
         // perform segue
    } else if (senderButton.tag == 1) {
         // perform other segue
    }
} 
```

等等等等。

我希望这会有所帮助！

# matlab - inf 还是 Inf？南还是南？

> ID：14268423
> 
> 赞同：7
> 
> 时间：2013-01-10T22:27:19.260
> 
> 标签：matlab

在 MATLAB 中似乎两者`inf`和`Inf`完全相同（同样是`nan`和`NaN`，但不是`Nan`）。有什么区别吗？

```
>> which inf
built-in (/Applications/MATLAB_R2011b.app/toolbox/matlab/elmat/inf)
>> which Inf
built-in (/Applications/MATLAB_R2011b.app/toolbox/matlab/elmat/Inf) 
```

如果它们相同，那么在实践中应该使用哪一个？对于分配数组，我一直在使用`x = inf(3,5)`样式跟随`zeros`并且`ones`都是小型大写字母。对于分配单个值，我使用`x = Inf`. 您认为这是一致的用途吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-10T22:32:08.083

最惯用的一致是`nan`and`inf`但 MATLAB 为您提供了另一种大写`NaN`and`Inf`的方式，您可以在其他任何地方找到它的方式，例如在打印输出中。请注意，MATLAB*区分*大小写。没有人会使用`Nan`or `InF`，因此 MATLAB 不提供这些“别名”。

**编辑：** 对于在数据向量中使用`[3.7, 1.2, NaN, 3.1]`，我一直发现自己也在使用`NaN`，但以下实验*非常强烈地*表明，这种使用与 MATLAB 的内部工作**并不密切。**创建一个`n = NaN()`返回 4 的函数并将其保存`NaN.m`在当前文件夹中。像上面那样定义向量会导致*MATLAB 无法理解**为一个 constant*，并且会查找一个函数，根据 MA​​TLAB 的习惯用法，该函数应该全部小写`[3.7, 1.2, 4.0, 3.1]`。 *`NaN`*

 **`NaN.m`现在让我们在忘记之前快速删除，并继续`NaN`在数据列中使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T12:42:13.107

以下是 MATLAB 似乎使用的约定：

对于非数字：始终使用`NaN`（除了组合，例如`isnan()`

For Infinite：`inf`用于函数并`Inf`用于值（和`INFs`倍数，但这当然不是命令）。请注意，这有点棘手，因为这意味着对`inf`给的评估`Inf`。

推导自：

`help Inf`: inf(N) 是一个 N×N 的 INF 矩阵。

`help nan`: NaN(N) 是 NaN 的 N×N 矩阵。

`help isnan`: 例如，isnan([pi NaN Inf -Inf]) 是 [0 1 0 0]。**

# php - Htaccess .php 和尾部斜杠和哈希组合过滤器

> ID：14268424
> 
> 赞同：1
> 
> 时间：2013-01-10T22:27:24.223
> 
> 标签：php, jquery, .htaccess, hash

我在整个站点中使用 htaccess mod rewrite 从页面中删除斜杠和 .php 扩展名。

但是，当我来到目录和页面 work/index.php 时，我在这里遇到了麻烦：http: [//thriftandthistle.co.uk/sprout/work/](http://thriftandthistle.co.uk/sprout/work/)

我想完全删除 index.php，但由于使用哈希来过滤投资组合，我遇到了问题。

但是使用 htaccess 我希望 php 页面读取 work#print 等来过滤投资组合，但这些只是导致页面通过 mod 重写重定向。

这是我的htaccess：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
# remove trailing slash
RewriteRule ^(.*)/$ /$1 [L,R=301]
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php
# Replace html with your file extension, eg: php, htm, asp

php_value include_path 'includes' 
```

任何人都可以帮助建议我可以对 htaccess 进行更改以删除尾部斜杠并停止哈希重定向页面而不是过滤投资组合吗？

我让它在像这里这样的 html 页面上工作：http: [//thriftandthistle.co.uk/sprout/work.html](http://thriftandthistle.co.uk/sprout/work.html) 但不是重写，这似乎导致了问题。

# concurrency - cuda 并发内核执行不成功

> ID：14268426
> 
> 赞同：-1
> 
> 时间：2013-01-10T22:27:34.770
> 
> 标签：concurrency, cuda

以下是我从“cuda by example”一书中编辑的代码，用于测试 CUDA 并发内核执行。

```
static void HandleError( cudaError_t err,
                         const char *file,
                         int line ) { 
    if (err != cudaSuccess) {
        printf( "%s in %s at line %d\n", cudaGetErrorString( err ),
                file, line );
        exit( EXIT_FAILURE );
    }   
}
#define HANDLE_ERROR( err ) (HandleError( err, __FILE__, __LINE__ ))

#define N   (1024*1024*10)
#define FULL_DATA_SIZE   (N*2)

__global__ void kernel( int *a, int *b, int *c ) {
    int idx = threadIdx.x + blockIdx.x * blockDim.x;
    if (idx < N) {
        int idx1 = (idx + 1) % 256;
        int idx2 = (idx + 2) % 256;
        float   as = (a[idx] + a[idx1] + a[idx2]) / 3.0f;
        float   bs = (b[idx] + b[idx1] + b[idx2]) / 3.0f;
        c[idx] = (as + bs) / 2;
    }
}

int main( void ) {
    cudaDeviceProp  prop;
    int whichDevice;
    HANDLE_ERROR( cudaGetDevice( &whichDevice ) );
    HANDLE_ERROR( cudaGetDeviceProperties( &prop, whichDevice ) );
    if (!prop.deviceOverlap) {
        printf( "Device will not handle overlaps, so no speed up from streams\n" );
        return 0;
    }

    cudaEvent_t     start, stop;
    float           elapsedTime;

    cudaStream_t    stream0, stream1;
    int *host_a, *host_b, *host_c;
    int *dev_a0, *dev_b0, *dev_c0;
    int *dev_a1, *dev_b1, *dev_c1;

    // start the timers
    HANDLE_ERROR( cudaEventCreate( &start ) );
    HANDLE_ERROR( cudaEventCreate( &stop ) );

    // initialize the streams
    HANDLE_ERROR( cudaStreamCreate( &stream0 ) );
    HANDLE_ERROR( cudaStreamCreate( &stream1 ) );

    // allocate the memory on the GPU
    HANDLE_ERROR( cudaMalloc( (void**)&dev_a0,
                              N * sizeof(int) ) );
    HANDLE_ERROR( cudaMalloc( (void**)&dev_b0,
                              N * sizeof(int) ) );
    HANDLE_ERROR( cudaMalloc( (void**)&dev_c0,
                              N * sizeof(int) ) );
    HANDLE_ERROR( cudaMalloc( (void**)&dev_a1,
                              N * sizeof(int) ) );
    HANDLE_ERROR( cudaMalloc( (void**)&dev_b1,
                              N * sizeof(int) ) );
    HANDLE_ERROR( cudaMalloc( (void**)&dev_c1,
                              N * sizeof(int) ) );

    // allocate host locked memory, used to stream
    HANDLE_ERROR( cudaHostAlloc( (void**)&host_a,
                              FULL_DATA_SIZE * sizeof(int),
                              cudaHostAllocDefault ) );
    HANDLE_ERROR( cudaHostAlloc( (void**)&host_b,
                              FULL_DATA_SIZE * sizeof(int),
                              cudaHostAllocDefault ) );
    HANDLE_ERROR( cudaHostAlloc( (void**)&host_c,
                              FULL_DATA_SIZE * sizeof(int),
                              cudaHostAllocDefault ) );

    for (int i=0; i<FULL_DATA_SIZE; i++) {
        host_a[i] = rand();
        host_b[i] = rand();
    }

    HANDLE_ERROR( cudaEventRecord( start, 0 ) );
    // now loop over full data, in bite-sized chunks
    for (int i=0; i<FULL_DATA_SIZE; i+= N*2) {
        // enqueue kernels in stream0 and stream1   
        kernel<<<N/256,256,0,stream0>>>( dev_a0, dev_b0, dev_c0 );
        kernel<<<N/256,256,0,stream1>>>( dev_a1, dev_b1, dev_c1 );
    }
    HANDLE_ERROR( cudaStreamSynchronize( stream0 ) );
    HANDLE_ERROR( cudaStreamSynchronize( stream1 ) );

    HANDLE_ERROR( cudaEventRecord( stop, 0 ) );

    HANDLE_ERROR( cudaEventSynchronize( stop ) );
    HANDLE_ERROR( cudaEventElapsedTime( &elapsedTime,
                                        start, stop ) );
    printf( "Time taken:  %3.1f ms\n", elapsedTime );

    // cleanup the streams and memory
    HANDLE_ERROR( cudaFreeHost( host_a ) );
    HANDLE_ERROR( cudaFreeHost( host_b ) );
    HANDLE_ERROR( cudaFreeHost( host_c ) );
    HANDLE_ERROR( cudaFree( dev_a0 ) );
    HANDLE_ERROR( cudaFree( dev_b0 ) );
    HANDLE_ERROR( cudaFree( dev_c0 ) );
    HANDLE_ERROR( cudaFree( dev_a1 ) );
    HANDLE_ERROR( cudaFree( dev_b1 ) );
    HANDLE_ERROR( cudaFree( dev_c1 ) );
    HANDLE_ERROR( cudaStreamDestroy( stream0 ) );
    HANDLE_ERROR( cudaStreamDestroy( stream1 ) );

    return 0;
} 
```

首先，我使用 nvvp 进行了 CUDA 分析，发现两个内核根本没有重叠： ![在此处输入图像描述](../Images/b08e6ddf5b33544d096c2e526b1fe2a1.png) SO 上的一些先前帖子指出分析器可能会禁用并发内核执行，所以我做了一个简单的运行。内核循环中的总时间报告为 2.2ms，但他的分析器报告每个内核的执行时间为 1.1ms。这仍然意味着两个内核之间没有（或非常差）重叠。

我在 Tesla M2090 上使用 CUDA4.0。看来这个设备（6G）上的内核资源需求（~10s MB）应该很小，并发执行应该是实用的。不确定问题出在哪里。我应该做一些特别的事情来启用并发内核（一些 API，一些环境设置......）吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-01-10T22:33:11.323

您是否指定代码应针对哪种计算架构进行编译？默认是 1.0，如果我没记错的话，它不支持并发内核。尝试将以下内容添加到您的 nvcc 调用中：

```
--generate_code code=sm_21,arch=compute_20 
```

我不知道你的卡支持哪种计算架构，但你应该可以在网上的某个地方找到它。但也许只是先尝试​​上述方法，如果失败，请尝试`sm_20`代替`sm_21`.

# python - 终止线程：Python

> ID：14268431
> 
> 赞同：1
> 
> 时间：2013-01-10T22:27:56.573
> 
> 标签：python, multithreading, python-multithreading

在下面的示例中，如果您多次执行该程序，它每次都会生成一个具有新 ID 的新线程。1.如何在任务完成时终止所有线程？2\. 我如何为线程分配名称/ID？

```
import threading, Queue 

THREAD_LIMIT = 3                 
jobs = Queue.Queue(5)           # This sets up the queue object to use 5 slots 
singlelock = threading.Lock()   # This is a lock so threads don't print trough each other 

# list  
inputlist_Values = [ (5,5),(10,4),(78,5),(87,2),(65,4),(10,10),(65,2),(88,95),(44,55),(33,3) ] 

def DoWork(inputlist): 
    print "Inputlist received..."
    print inputlist 

    # Spawn the threads 
    print "Spawning the {0} threads.".format(THREAD_LIMIT) 
    for x in xrange(THREAD_LIMIT): 
        print "Thread {0} started.".format(x) 
        # This is the thread class that we instantiate. 
        worker().start() 

    # Put stuff in queue 
    print "Putting stuff in queue"
    for i in inputlist: 
        # Block if queue is full, and wait 5 seconds. After 5s raise Queue Full error. 
        try: 
            jobs.put(i, block=True, timeout=5) 
        except: 
            singlelock.acquire() 
            print "The queue is full !"
            singlelock.release() 

    # Wait for the threads to finish 
    singlelock.acquire()        # Acquire the lock so we can print 
    print "Waiting for threads to finish."
    singlelock.release()        # Release the lock 
    jobs.join()                 # This command waits for all threads to finish. 

class worker(threading.Thread): 
    def run(self): 
        # run forever 
        while 1: 
            # Try and get a job out of the queue 
            try: 
                job = jobs.get(True,1) 
                singlelock.acquire()        # Acquire the lock 
                print self
                print "Multiplication of {0} with {1} gives {2}".format(job[0],job[1],(job[0]*job[1]))         
                singlelock.release()        # Release the lock 
                # Let the queue know the job is finished. 
                jobs.task_done() 
            except: 
                break           # No more jobs in the queue 

def main():    
    DoWork(inputlist_Values) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:40:45.150

> 如何在任务完成时终止所有线程？

如果线程看到它，您可以将`THREAD_LIMIT`标记值（例如，`None`）放在队列的末尾并退出线程的方法。`run()`

在您的主线程退出时，所有非守护线程都已加入，因此如果任何线程处于活动状态，程序将继续运行。守护程序线程在您的程序退出时终止。

> 如何为线程分配名称/ID？

您可以通过将名称传递给构造函数或`.name`直接更改来分配名称。

线程标识符`.ident`是一个只读属性，在活动线程中是唯一的。如果一个线程退出而另一个线程启动，它可能会被重用。

* * *

`multiprocessing.dummy.Pool`您可以使用提供相同接口[`multiprocessing.Pool`](http://docs.python.org/2/library/multiprocessing.html#module-multiprocessing.pool)但使用线程而不是进程的方式重写代码：

```
#!/usr/bin/env python
import logging
from multiprocessing.dummy import Pool

debug = logging.getLogger(__name__).debug

def work(x_y):
    try:
        x, y = x_y # do some work here
        debug('got %r', x_y)
        return x / y, None
    except Exception as e:
        logging.getLogger(__name__).exception('work%r failed', x_y) 
        return None, e

def main():
    logging.basicConfig(level=logging.DEBUG,
        format="%(levelname)s:%(threadName)s:%(asctime)s %(message)s")

    inputlist = [ (5,5),(10,4),(78,5),(87,2),(65,4),(10,10), (1,0), (0,1) ]
    pool = Pool(3)
    s = 0.
    for result, error in pool.imap_unordered(work, inputlist):
        if error is None:
           s += result
    print("sum=%s" % (s,))
    pool.close()
    pool.join()

if __name__ == "__main__":
   main() 
```

### [输出](http://ideone.com/O50t0A)

```
DEBUG:Thread-1:2013-01-14 15:37:37,253 got (5, 5)
DEBUG:Thread-1:2013-01-14 15:37:37,253 got (87, 2)
DEBUG:Thread-1:2013-01-14 15:37:37,253 got (65, 4)
DEBUG:Thread-1:2013-01-14 15:37:37,254 got (10, 10)
DEBUG:Thread-1:2013-01-14 15:37:37,254 got (1, 0)
ERROR:Thread-1:2013-01-14 15:37:37,254 work(1, 0) failed
Traceback (most recent call last):
  File "prog.py", line 11, in work
    return x / y, None
ZeroDivisionError: integer division or modulo by zero
DEBUG:Thread-1:2013-01-14 15:37:37,254 got (0, 1)
DEBUG:Thread-3:2013-01-14 15:37:37,253 got (10, 4)
DEBUG:Thread-2:2013-01-14 15:37:37,253 got (78, 5)
sum=78.0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T00:08:06.800

*除非您告诉它们*停止，否则线程不会停止。

我的建议是您将一个`stop`变量添加到您的`Thread`子类中，并检查该变量是否`True`在您的运行循环中（而不是`while 1:`）。

一个例子：

```
class worker(threading.Thread): 
    def __init__(self):
         self._stop = False

    def stop(self):
         self._stop = True

    def run(self): 
        # run until stopped 
        while not self._stop:                 
            # do work 
```

然后，当您的程序退出（无论出于何种原因）时，您必须确保`stop`在所有工作线程上调用该方法。

关于您的第二个问题，是否为您的子类添加`name`变量对您`Thread`有用？

# apache - apache .htaccess 仅对经过身份验证的用户显示目录索引

> ID：14268437
> 
> 赞同：4
> 
> 时间：2013-01-10T22:28:17.640
> 
> 标签：apache, .htaccess, authentication, configuration

我的网络服务器上有这个目录结构：

```
web
    privatedir1
    privatedir2
    publicdir
        file1
        file2
        file3 
```

我想使用 .htaccess 文件设置以下功能：

*   用户“管理员”（经过身份验证）可以无限制访问所有目录（包括目录索引）
*   其他任何人都可以下载 file1、file2、file3 但看不到 publicdir 的列表（索引）

您能否描述如何使用 .htaccess 文件实现这一目标？我知道如何允许/禁止目录索引，但我不知道如何有条件地做到这一点（取决于用户是否经过身份验证）

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-07-30T19:36:28.150

这是一个非常基本的示例，但您可以这样做。

```
<Directory /srv/dev/>
        AllowOverride All
        Options +Indexes

        AuthType Basic
        AuthUserFile /srv/.htpasswd
        Require valid-user
</Directory>

<Directory /srv/dev/apps/>
        <If "%{REQUEST_URI} != '/'">
        Require all granted
        </If>
</Directory> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-03-13T21:00:12.377

我认为您的答案可能在于此网址

[htaccess 允许访问特定用户](https://stackoverflow.com/questions/10623019/htaccess-allow-access-to-specific-user)

“您需要使用 htpasswd 实用程序创建要允许的用户数据库/特定用户。从那里，在您要限制的目录中的 htaccess 文件中，使用：”

```
AuthUserFile /path/to/.htpasswd
AuthName "Authorization Form Title"
AuthType Basic

#Allow any valid user
require valid-user

#Allow only one user with specified username
require user username 
```

“更多信息可以在大量在线参考资料中找到，这是最早出现的资料之一：http: [//www.apacheweek.com/features/userauth](http://www.apacheweek.com/features/userauth) ”

# c# - 访问列表中的所有项目 以随机顺序

> ID：14268439
> 
> 赞同：0
> 
> 时间：2013-01-10T22:28:20.537
> 
> 标签：c#, .net-4.5

我有一个列表，其中 T 有一个属性 CoverImage。我想以随机顺序访问列表中的所有项目并从服务器加载适当的图像。我对从服务器加载数据不感兴趣，我只想知道如何以随机方式访问该列表中的所有元素并且只访问一次？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:31:38.217

```
Random rnd = new Random();
foreach(var elem in list.OrderBy(x => rnd.Next()))
{

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T22:32:36.847

合适的术语是*shuffling*。洗牌是将集合/序列重新排序为随机顺序的概念。

这样做的方法有很多，对性能的影响各不相同。F [isher–Yates shuffle是一个不错的选择](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)

伪代码：

```
To shuffle an array a of n elements (indices 0..n-1):
  for i from n − 1 downto 1 do
       j ← random integer with 0 ≤ j ≤ i
       exchange a[j] and a[i] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T22:41:55.533

```
Random r = new Random();
List<T> myListRnd = new List<T>();

int p = 0;
while (myList.Count > 0)
{
    p = r.Next(myList.Count + 1)
    myListRnd.Add(myList[p]);
    myList.RemoveAt[p];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T23:02:11.830

如果您有兴趣编写自己的扩展方法，它可能如下所示：

```
public static IEnumerable<T> Shuffle<T>(this IEnumerable<T> enumerable, Random random)
{
    List<T> itemList = new List<T>(enumerable);

    for (int i = 0; i < itemList.Count; ++i)
    {
        int randomIndex = random.Next(itemList.Count);
        if (randomIndex != i)
        {
            T temp = itemList[i];
            itemList[i] = itemList[randomIndex];
            itemList[randomIndex] = temp;
        }
    }

    return itemList;
} 
```

# delphi - Fxxx 私有类名前缀约定从何而来？

> ID：14268441
> 
> 赞同：9
> 
> 时间：2013-01-10T22:28:29.413
> 
> 标签：delphi

在 C++/C# 中，私有类变量的通用约定是`m_MyPrivateVar`，我相信“ **m_** ”代表“我的”（我可能错了）。

在 Delphi 中，私有类变量以**F**开头，例如 FHandle 等。

F 是什么意思？福？:)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-10T23:02:23.143

有一些命名约定不要迷失在代码中。

这里有一个例子来说明为什么这是有用的。

```
// Types begins with T
TFoo = class
strict private
  // sometimes I saw strict private fields beginning with underscore
  // I like this too 
  _Value : string;
private
  // private class vars are Fields and therefore begins with F
  FValue : string;
  function GetValue : string;
public
  property Value : string read GetValue write FValue;

  // Parameters should NOT begin with P (P is for Pointer) but with A
  // because "i will pass A value" :o)
  function GetSomething( const AValue : string ) : string;
end;

function TFoo.GetValue : string;
begin
  Result := '*' + FValue + '*';
end;    

function TFoo.GetSomething( const AValue : string ) : string;
var
  // IMHO there is no naming convention to Local vars
  // but mine begins with L
  LValue : string;
begin

  LValue { local var } := 
    Value   { property via getter }  + 
    AValue  { parameter } + 
    FValue  { field };

  Result := LValue;
end; 
```

# c# - VS 远程调试问题

> ID：14268442
> 
> 赞同：3
> 
> 时间：2013-01-10T22:28:30.130
> 
> 标签：c#, .net, visual-studio-2010, remote-debugging, visual-studio-debugging

我正在尝试在其他 PC 上附加进程以调试远程。但是“附加到进程”对话框中的代码类型始终是本机（x86 或 x64），而不是托管代码（我的应用程序是 100% 托管的）。附加后我无法调试托管代码。为什么会这样？

现在我必须改变我的问题。问题在于远程传输模式（仅支持本机代码）。但现在我无法开始工作。

1.  我在其他具有管理员权限的 PC 上使用我的登录名和密码创建了用户
2.  我已经从该用户运行远程调试器
3.  在我选择浏览到那台 PC（来自远程调试器的服务器名称）后，调试器说：

    > 无法连接到服务器。请求的名称有效，但未找到数据或请求的类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-23T13:44:00.530

在远程计算机上，在 Visual Studio 远程调试监视器中寻找类似 Msvsmon 的东西启动了一个名为“user@servername”的新服务器...

现在，在运行 Visual Studio 的计算机上，在“附加到进程”窗口的“限定符”文本字段中输入相同的服务器名称。除非您在“安全网络”上，否则将“传输”保留为默认值。

您现在应该能够在可用进程下看到您的应用程序。

# mysql - mysql中的in子句

> ID：14268444
> 
> 赞同：2
> 
> 时间：2013-01-10T22:28:32.660
> 
> 标签：mysql, sql

我有 4 个表如下，它们具有以下属性：

```
Actor:actor_id,firstname,lastname
film_actor:actor_id,film_id
film_category:film_id,category_id
category:category_id,name 
```

我想找到在电影中工作的所有演员的列表，他们的 film_id、category_id 和类别名称。

我想使用 In 子句进行后续查询。所以我通过如下实现来获得o/p：

```
select  a.first_name,a.actor_id,fc.film_id,c.name,c.category_id
from actor a,film_actor fa,film_category fc,category c where a.actor_id 
in (select fa.film_id from film_actor fa where fa.actor_id=a.actor_id
and fa.film_id 
in (select fc.film_id  from film_category fc where fc.film_id=fa.film_id
and fc.category_id 
in(select fc.category_id from category c where c.category_id=fc.category_id))) 
```

但是假设现在我想知道特定 category_id 的演员列表。假设 5 存在。因此，我进行了以下更改：

```
select  a.first_name,a.actor_id,fc.film_id,c.name,c.category_id
from actor a,film_actor fa,film_category fc,category c 
where a.actor_id in 
(select fa.film_id from film_actor fa where fa.actor_id=a.actor_id
and fa.film_id 
in (select fc.film_id  from film_category fc where fc.film_id=fa.film_id
and fc.category_id 
in(select fc.category_id from category c where c.category_id=fc.category_id
and category_id=5))) 
```

我得到了空的结果。最后，我们什么时候应该使用 IN 子句，什么时候不应该？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:31:21.380

不要`IN`用于这个..`JOIN`改用。

```
select  
    a.first_name,
    a.actor_id,
    fc.film_id,
    c.name,
    c.category_id
from 
    actor a join 
    film_actor fa on fa.actor_id = a.actor_id join
    film_category fc on fc.film_id = fa.film_id join
    category c on c.category_id = fc.category_id and c.category_id = 5 
```

我通常只`IN`用于一组硬编码的 ID……`JOIN`或`EXISTS`其他所有情况。这不仅更清洁，而且还可能会产生更好的执行计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:31:41.700

请开始使用连接语法而不是`IN`子句：

```
select a.first_name,
  a.actor_id,
  fc.film_id,
  c.name,
  c.category_id
from actor a
left join film_actor fa
  on a.actor_id = fa.actor_id
left join film_category fc
  fa.film_id = fc.film_id
left join category c 
  on fc.category_id = c.category_id
  and c.category_id=5 
```

这将返回表中的所有记录，`actor`无论其他表中是否存在匹配记录。

如果您在学习`JOIN`语法方面需要帮助，这里有一个很好[的连接可视化解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

# c# - Java 泛型作为参数

> ID：14268448
> 
> 赞同：1
> 
> 时间：2013-01-10T22:28:45.927
> 
> 标签：c#, java, generics

所以我有一堆方法，它们本质上是相同的调用，唯一的区别是泛型的类名。例子：

当前的：

```
public void methodA(ARequest request, ADelegate delegate)
{
     JsonClient<ARequest, AResponse> client = new JsonClient<ARequest, AResponse>(request.ServiceServerUrl, request, new AResponse());
     client.sendRequest(delegate);
}

public void methodB(BRequest request, BDelegate delegate)
{
         JsonClient<BRequest, BResponse> client = new JsonClient<BRequest, BResponse>(request.ServiceServerUrl, request, new BResponse());
         client.sendRequest(delegate);
} 
```

我想做的是：

```
private void serviceCall<R extends RequestBase, S extends ResponseBase>(ADelegate delegate)
{
    JsonClient<R, S> client = new JsonClient<R, S>(request.ServiceServerUrl, request, new AResponse());
    client.sendRequest(delegate);
}

public void methodA(ARequest request, ADelegate delegate)
{
    serviceCall<ARequest, AResponse>(delegate);
}

public void methodB(BRequest request, BDelegate delegate)
{
    serviceCall<BRequest, BResponse>(delegate);
} 
```

我认为这在 C# 中是可能的，但我只想知道如何在 Java 中正确地做到这一点。

编辑：为清楚起见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:35:26.740

您应该能够编写以下内容：

```
private <R extends RequestBase, S extends ResponseBase> void serviceCall(
        R request,
        S response,
        ADelegate delegate
) {
    JsonClient<R, S> client = new JsonClient<R, S>(request.ServiceServerUrl, request, response);
    client.sendRequest(delegate);
} 
```

请注意，调用者必须实例化并传入`response`，因为`new S()`在 Java 中是不可能的：

```
public void method(ARequest request, ADelegate delegate) {
    serviceCall(request, new AResponse(), delegate);
} 
```

就像是

```
MyClass.<ARequest, AResponse>serviceCall(request, new AResponse(), delegate) 
```

这里不需要，因为编译器会为您推断类型参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:31:05.783

你的意思是？

```
public <T extends RequestBase, E extends ResponseBase> void method(T request, E delegate)
{
     JsonClient<T, E> client = new JsonClient<T, E>(request.ServiceServerUrl, request, new AResponse());
     client.sendRequest(delegate);
} 
```

并像`ClassName.<ARequest, AResponse>method(request, response)`.

# spring - Spring Security - UserDetailsS ervice 实现 - 登录失败

> ID：14268451
> 
> 赞同：10
> 
> 时间：2013-01-10T22:29:25.660
> 
> 标签：spring, login, spring-security, authorization

我对春天很陌生，我在春天安全方面遇到了这个问题。实际上，它仅在没有我的自定义 UserDetailsS​​ervice 实现的情况下才有效。

帐户和角色对象

```
@Entity
@Table(name="ACCOUNT", uniqueConstraints = {@UniqueConstraint (columnNames = "USERNAME"),      @UniqueConstraint (columnNames = "EMAIL")})
public class Account implements Serializable {
private static final long serialVersionUID = 2872791921224905344L;

@Id
@GeneratedValue(strategy = GenerationType.AUTO)
@Column(name="ID")
private Integer id;

@Column(name="USERNAME")
@NotNull
private String username;

@Column(name="PASSWORD")
@NotNull
private String password;

@Column(name="EMAIL")
@NotNull
@Email
private String email;

@Column(name="ENABLED")
private boolean enabled;

@ManyToMany(cascade= CascadeType.ALL)
@JoinTable(name="ACCOUNT_ROLE", joinColumns = {@JoinColumn (name="ID_ACCOUNT")}, inverseJoinColumns ={ @JoinColumn (name="ID_ROLE")})
private Set<Role> roles = new HashSet<Role>(0); 
```

角色

```
@Entity
@Table(name="ROLE", uniqueConstraints={@UniqueConstraint (columnNames="NAME")})
public class Role implements Serializable{

private static final long serialVersionUID = -9162292216387180496L;

@Id
@GeneratedValue(strategy = GenerationType.AUTO)
private Integer id;

@Column(name = "NAME")
@NotNull
private String name;

@ManyToMany(mappedBy = "roles")
private Set<Account> accounts = new HashSet<Account>(0); 
```

UserDetails 的适配器

```
@SuppressWarnings({ "serial", "deprecation" })
public class UserDetailsAdapter implements UserDetails {

private Account account;

public UserDetailsAdapter(Account account) {this.account = account;}

public Account getAccount() {return account;}

public Integer getId(){return account.getId();}

public String getEmail () {return account.getEmail();}

@Override
public Collection<? extends GrantedAuthority> getAuthorities() {
    Set<GrantedAuthority> authorities = new HashSet<GrantedAuthority>();
    for (Role r :account.getRoles()) {
        authorities.add(new GrantedAuthorityImpl(r.getName()));
    }
    return authorities;
} 
```

自定义 UserDetailsS​​ervice

```
@Service("customUserDetailsService")
public class CustomUserDetailsService implements UserDetailsService {
@Inject AccountDao accountDao;
@Inject RoleDao roleDao;

@Override
public UserDetails loadUserByUsername(String username)
        throws UsernameNotFoundException {
    Account account= accountDao.findByUsername(username);

    if(account==null) {throw new UsernameNotFoundException("No such user: " + username);
    } else if (account.getRoles().isEmpty()) {
        throw new UsernameNotFoundException("User " + username + " has no authorities");
                }
    UserDetailsAdapter user = new UserDetailsAdapter(account);
    return user;
    } 
```

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee  http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

<filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
</filter-mapping>

<!-- The definition of the Root Spring Container shared by all Servlets and Filters -->
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/spring/root-context.xml
                    /WEB-INF/spring/appServlet/security-  context.xml</param-value>
</context-param>

<!-- Creates the Spring Container shared by all Servlets and Filters -->
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<!-- Creates the Filters to handle hibernate lazyload exception -->

<filter>
    <filter-name>OpenSessionInViewFilter</filter-name>
    <filter-class>org.springframework.orm.hibernate3.support.OpenSessionInViewFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>OpenSessionInViewFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<!-- Processes application requests -->
<servlet>
    <servlet-name>appServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/appServlet/servlet-context.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>appServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>

</web-app> 
```

根上下文

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xmlns:p="http://www.springframework.org/schema/p"
xmlns:context="http://www.springframework.org/schema/context"
xsi:schemaLocation="http://www.springframework.org/schema/mvc  http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

<!-- Root Context: defines shared resources visible to all other web components -->
<context:property-placeholder properties-ref="deployProperties"/> 
<!-- Remember to correctly locate the right file for properties configuration(example DB connection parameters) -->
<bean id="deployProperties" class="org.springframework.beans.factory.config.PropertiesFactoryBean"
    p:location="/WEB-INF/spring/appServlet/spring.properties" />

    <context:annotation-config/>
    <context:component-scan base-package="org.treci">
    <context:exclude-filter type="annotation" expression="org.springframework.stereotype.Controller"/>
    </context:component-scan>

    <import resource="/appServlet/data-context.xml"/> 
```

安全上下文

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
xmlns:beans="http://www.springframework.org/schema/beans"
xmlns:p="http://www.springframework.org/schema/p"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:tx="http://www.springframework.org/schema/tx"
xsi:schemaLocation="http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">

<http pattern="/resources" security="none" />

<http auto-config="true" use-expressions="true">
    <intercept-url pattern="/" access="permitAll"/>
    <intercept-url pattern="/login" access="permitAll"/>
    <intercept-url pattern="/login-success" access="hasRole('ROLE_ADMIN')"/>

    <form-login login-page="/login" 
    default-target-url="/login-success"
    authentication-failure-url="/login-failed"/>
    <logout logout-success-url="/logout"/>
</http>

<beans:bean id="customUserDetailsService" class="org.treci.app.service.CustomUserDetailsService"></beans:bean>

<authentication-manager>
    <authentication-provider user-service-ref="customUserDetailsService">
    </authentication-provider>
</authentication-manager>

</beans:beans> 
```

我希望你们中的一些人可以帮助，救救我:)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-13T00:11:58.313

这是我解决问题的方法：

如您所见，在 CustomDetailsS​​ervice 中，我使用适配器返回了一个 UserDetails 对象。

看了一些教程，我意识到我应该返回一个 org.springframework.security.core.userdetails.User 对象。

这是我的新 CustomDetailsS​​ervice 实现：

```
@Transactional(readOnly=true)
@Service("customUserDetailsService")
public class CustomUserDetailsService implements UserDetailsService {
@Inject AccountDao accountDao;

@Override
public UserDetails loadUserByUsername(String username)
        throws UsernameNotFoundException {
    Account account= accountDao.findByUsername(username);

    if(account==null) {throw new UsernameNotFoundException("No such user: " + username);
    } else if (account.getRoles().isEmpty()) {
        throw new UsernameNotFoundException("User " + username + " has no authorities");
                }

    boolean accountNonExpired = true;
    boolean credentialsNonExpired = true;
    boolean accountNonLocked = true;

    return new User(
            account.getUsername(),
            account.getPassword().toLowerCase(),
            account.isEnabled(),
            accountNonExpired,
            credentialsNonExpired,
            accountNonLocked,
            getAuthorities(account.getRoles()));
    }

public List<String> getRolesAsList(Set<Role> roles) {
    List <String> rolesAsList = new ArrayList<String>();
    for(Role role : roles){
        rolesAsList.add(role.getName());
    }
    return rolesAsList;
}

public static List<GrantedAuthority> getGrantedAuthorities(List<String> roles) {
    List<GrantedAuthority> authorities = new ArrayList<GrantedAuthority>();
    for (String role : roles) {
        authorities.add(new SimpleGrantedAuthority(role));
    }
    return authorities;
}

public Collection<? extends GrantedAuthority> getAuthorities(Set<Role> roles) {
    List<GrantedAuthority> authList = getGrantedAuthorities(getRolesAsList(roles));
    return authList;
}

} 
```

# google-app-engine - 在 Google App Engine 上运行 SciPy 的替代方案？

> ID：14268453
> 
> 赞同：5
> 
> 时间：2013-01-10T22:29:42.977
> 
> 标签：google-app-engine, scipy

我需要在我的应用程序中运行一些统计测试，这需要来自 scipy.stats 的函数。但是我发现 Google App Engine 不信任 SciPy。那么是否有任何 GAE 支持的库可以进行一些统计计算，例如生成随机数、估计 CDF、运行 T 测试、检查正态性等。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T13:27:01.030

[Python 2.7 运行时包括](https://developers.google.com/appengine/docs/python/tools/libraries27)NumPy 。这是一个科学图书馆，可以帮助你做你想做的事。

**Numpy**是一种语言扩展，它定义了数值数组和矩阵类型以及对它们的基本操作。

NumPy 的更多信息在[这里](http://www.numpy.org/)

顺便提一句：

> 但是我发现 Google App Engine 不信任 SciPy。

我认为应该是：

> GAE 仅支持原生 python 代码

**编辑**

对于随机数，您可以使用[Python 的 Random](http://docs.python.org/2/library/random.html)

对于 CDF [http://pysclint.sourceforge.net/pycdf/](http://pysclint.sourceforge.net/pycdf/)或[http://code.google.com/p/netcdf4-python/](http://code.google.com/p/netcdf4-python/)但我不确定它们是否只包含本机代码。喜欢的话可以试试。

也看看这里[http://www.astro.cornell.edu/staff/loredo/statpy/](http://www.astro.cornell.edu/staff/loredo/statpy/)

另一种方法可能是让家庭服务器运行您可能喜欢的任何 python 模块。然后使用[PULL QUEUE 通过 REST](https://developers.google.com/appengine/docs/python/taskqueue/overview-pull)与您的“家庭”服务器通信并在那里处理计算。

# c# - C#，Unity - 单个函数采用多个不同的对象

> ID：14268455
> 
> 赞同：5
> 
> 时间：2013-01-10T22:29:57.860
> 
> 标签：c#, class, function, inheritance, abstract

我需要你的帮助。我正在安排一个脚本，该脚本可以在角色扮演游戏中执行能力之前检查各种条件。

所有这些能力都在单独的类（火球、治疗、毒药）中，都派生自另一个抽象类（远程能力、治疗能力、DOT 能力），它们都是抽象类（能力）的父级。

为了避免创建多个功能，处理每一个能力：

```
void condition(Fireball f){//test}; 
void condition(Heal f){//test}; 
void condition(Poison f){//test}; 
```

我正在尝试创建一个可以采用所有类型能力的单个函数调用。

```
void condition(Ability f){//test} 
```

到目前为止，我已经成功创建了一个 Fireball 对象并将其传递给函数。

```
Fireball _fire = new FireBall();
condition(_fire);

void condition(Ability f){//test} 
```

从这里我可以访问在Ability 类中初始化的所有公共变量，但我无法访问在派生类中初始化的公共变量（Ranged 能力、Healing 能力、DOT 能力）。

是我忘记了什么，还是我看错了？（我不擅长利用继承和抽象类。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T22:44:18.830

在不了解条件函数的更多细节的情况下，您有两个选择。

一，你可以做类似的事情

```
if (f.GetType() == typeof(FireBall))
{
  fireBall = (FireBall)f;
  fireBall.FireTheFireBall();
}
else if (f.GetType() == typeof(Heal))
... 
```

或者，您的 Ability 可以有一个抽象的 Activate 方法，所有派生类都需要重载该方法：

```
class Fireball
{
   public override void Activate()
   {
       //do fireball specific things
       this.FireTheFireBall();
   }   

   public void FireTheFireBall() {...}    
}

class Heal
{
   public override void Activate()
   {
       //do healing specific things
       this.ApplyTheBandage();
   }
   ...
}

abstract class Ability
{
  public abstract void Activate();
}

void condition(Ability f){
   f.Activate(); //runs the version of Activate of the derived class
} 
```

然后任何与能力一起工作的东西都可以调用 someAbility.Activate() 并且派生类提供的实现将被执行。

您还应该学习接口，它有点像抽象类。接口的好处是您可以实现多个接口，而您只能从一个基本抽象类继承。考虑一个具有转动和拉动功能的 IKnob 界面。您可能有一个实现 IKnob 的 Drawer 类、一个 Door 类、一个实现 Turn 并激活陷阱的 TrappedDoor 类。玩家走到一扇门前，按下门上的 Use 按钮​​，然后将对象 Open（IKnob 旋钮）传递给 open 函数

```
void Open(IKnob knob)
{
   knob.Turn();
   knob.Pull();
}

class TrappedDoor:IKnob,IMaterial,ISomethingElse,IHaveTheseOtherCapabilitiesAsWell
{
  private bool TrapAlreadySprung{get;set;}
  //more complex properties would allow traps to be attached either to the knob, or the door, such that in one case turning the knob activates the trap, and in the other, Pull activates the trap
  public Turn() { 
    if(! TrapAlreadySprung)
    {
      MessageBox("You hit your head, now you're dead");
    }
  }
} 
```

有一些方法可以检查某物是否有接口，因此如果某个玩家走到一个物品前并尝试与它交谈，您可以检查该对象是否具有 ICanTalk 接口，如果有则调用 object.GetReply("Hello")并且对象可以响应。因此，如果您愿意，您可以拥有会说话的门和石头。您将获得处理与事物交谈/显示响应等的所有代码，使用 ICanTalk 接口方法，然后其他类可以实现 ICanTalk 并且它们各自决定如何响应被交谈。这个概念被称为“关注点分离”，可以帮助您创建更多可重用的代码。

重要的是你可以编写一段代码、一个算法、函数等，只适用于那个接口，这样一旦你让那个代码和接口一起工作，你就可以在任何类上使用那个接口，并且该类可以利用现有代码。

即你的`condition`函数，如果它接受了一个 IAbility 接口，一旦你的代码工作，那么你创建的任何实现 IAbility 的类都可以传递给条件函数。条件函数负责做它应该做的任何事情，实现 IAbility 的类负责它实现的方法中特定于它的任何事情。

当然，实现抽象类或接口的类必须实现所需的方法，所以有时您可能会觉得自己在复制代码。例如，如果您有类似的类，例如 TrappedDoor 和 Door，如果 TrappedDoor 未设置/已经弹出，则 TrappedDoor 的行为可能与常规 Door 一样。因此，在这种情况下，您可能要么继承自 Door，要么拥有私有 Door 属性（称为“组合”）。如果陷阱已经弹出，那么您可以调用基类 Door 或私有 Door 属性并调用 .Turn ，以便在陷阱未激活的情况下重用常规门的默认行为。

[测试对象是否实现接口](https://stackoverflow.com/questions/410227/test-if-object-implements-interface)

就我个人而言，我主要使用接口和组合，而不是继承。并不是说继承很糟糕，而是继承层次结构很快就会变得非常复杂。

# android - 安卓外接usb摄像头

> ID：14268458
> 
> 赞同：1
> 
> 时间：2013-01-10T22:30:03.857
> 
> 标签：android, camera, usb, kernel

我扎根了android银河系。我没有看到通过 adb shell 检查 dev 文件夹下的任何视频设备。

我正在尝试使用外部 USB 摄像头[http://brain.cc.kogakuin.ac.jp/research/usb-e.html](http://brain.cc.kogakuin.ac.jp/research/usb-e.html)。

修改内核设置并构建自定义 zImage ，解压 boot.img 并替换 zImage 然后重新打包为 new-boot.img。我用新的 boot.img 闪过。一旦我从上述 url 运行示例相机应用程序，就看不到任何视频帧。我认为可能是因为 /dev 下没有视频设备，通常设备应该有 /dev/video0,1 等等。

任何机构都可以提供帮助或指明方向吗？

# javascript - 仅在鼠标单击时绘制图像

> ID：14268459
> 
> 赞同：0
> 
> 时间：2013-01-10T22:30:07.230
> 
> 标签：javascript, html, mouseevent, drawimage

有什么方法可以使“绘制图像”仅在按下键/单击时发生？

我对 javascript 很陌生，但我已经完成了 html 和 css。

有没有一种简单的方法可以让我完成这项工作？

```
<!doctype html>
<html>
<head>
    <title>test</title>
    <style type="text/css">
        body {
            background-color:#000000;
            image-repeat:none;
            margin: 0px;
            cursor: none;
            overflow: hidden; 
            }
    </style>
</head>
<body>
    <script type="text/javascript">
        var imageWidthHalf, imageHeightHalf;
        var canvas = document.createElement( 'canvas' );
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            canvas.style.display = 'block';
            document.body.appendChild( canvas );
        var context = canvas.getContext( '2d' );
        var image = document.createElement( 'img' );

            image.addEventListener('load', function() {
                imageWidthHalf = Math.floor( this.width / 2 );
                imageHeightHalf = Math.floor( this.height / 2 );
                document.addEventListener( 'mousemove', onMouseEvent, false ); //mouseclick ?
            }   , false );

        image.src ="cir.png" 

                             //mouseclick ?
        function onMouseEvent( event ) {
            context.drawImage( image, event.clientX - imageWidthHalf , event.clientY - imageHeightHalf );
        }
    </script>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:37:15.477

也许将 jQuery 添加到您的项目中，它使生活变得更加轻松。

```
 $("canvas").click(function() {
     // alert("Handler for .click() called.");
      context.drawImage( image, event.clientX - imageWidthHalf , event.clientY - imageHeightHalf );
  }); 
```

见：[http ://api.jquery.com/click/](http://api.jquery.com/click/)

# ios - 批量推送通知让我的服务器停机

> ID：14268460
> 
> 赞同：2
> 
> 时间：2013-01-10T22:30:08.193
> 
> 标签：ios, notifications, push

当我向我的 iOS 应用程序用户（大约 100,000）发送大量推送通知时，在我的 PHP 页面显示“完成：消息已发送给 X 用户）之后，我的服务器关闭并关闭，尽管页面已完成发送，并且所有用户收到了我的消息。

为什么我的服务器宕机了？我只向 Apple 网关服务器发送请求，他们的服务器完成了艰苦的工作。

我的脚本：

```
$sound = "default"; 
$passphrase = 'pass';
$message = 'some message';

$ctx = stream_context_create();
stream_context_set_option($ctx, 'ssl', 'local_cert', 'ck.pem');
stream_context_set_option($ctx, 'ssl', 'passphrase', $passphrase);

$fp = stream_socket_client(
    'ssl://gateway.push.apple.com:2195', $err,
    $errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx);

if (!$fp)
    exit("Failed to connect: $err $errstr" . PHP_EOL);

$body['aps'] = array(
    'alert' => $message,
    'sound' => $sound,
    'badge' => 1
    );

$payload = '{"aps":{"alert":"' . $message . '","sound":"' . $sound  . '","badge":1}}';

$results = mysql_query ("Select * from tokens");
while ($row = mysql_fetch_array($results)) {
  $deviceToken = $row[Token];
  $i ++;

  $msg = chr(0) . pack('n', 32) . pack('H*', $deviceToken) . pack('n', strlen($payload)) . $payload;
  $result = fwrite($fp, $msg,strlen($msg));  

  if (!$result) {
    fclose($fp);
    sleep (3);
    $fp = stream_socket_client(
    'ssl://gateway.push.apple.com:2195', $err,
    $errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx);
    if (!$fp) exit("Failed to connect: $err $errstr" . PHP_EOL);
  }

}

fclose($fp);
echo "Done: messages has ben sent to $i users.";

} 
```

我有 2GB RAM 的 VPS。

任何想法是什么导致了这个问题，以及避免它的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-07-26T07:59:18.140

我想这不是推送通知是从您的服务器发送的事实，而是当通知到达时立即**单击通知的用户会为您的服务器****产生负载**。

我遇到了同样的问题并以这样的方式解决了它，即我不会一次向所有用户发送主题消息或消息，而是**将小块消息发送**给用户。块之间的延迟应根据服务器的容量进行调整。

# openssl - 失败的 PCI 审计 Diffie-Hellman Tomcat 7

> ID：14268464
> 
> 赞同：0
> 
> 时间：2013-01-10T22:30:42.280
> 
> 标签：openssl, tomcat7

我们未能通过定期 PCI 审计，因为我们的 Tomcat 7 允许 Diffie-Hellman 密钥交换。我对Tomcat并不感兴趣，我做了一些研究无济于事。

审计说我有 3 个选择来纠正这个问题。

1.  升级到 OpenSSL 1.0.0。在 YUM 中不可用。
2.  禁用 FIPS 模式。有人说不是最好的选择。
3.  将密码套件配置为不包含任何 Diffie-Hellman 密钥交换。最好的猜测，这就是我需要的。

我们正在运行：Tomcat 7.0.23 OpenSSL 0.9.8e CentOS 5.5

任何帮助将不胜感激。

审计是这样说的：

“描述：SSL 服务器接受弱 Diffie-Hellman 密钥概要：远程 SSL/TLS 服务器接受弱 Diffie-Hellman 公钥值。影响：远程 SSL/TLS 服务器接受弱 Diffie-Hellman (DH) 公钥值。这缺陷可能有助于攻击者对远程服务器进行中间人 (MiTM) 攻击，因为它可以强制计算完全可预测的 Diffie-Hellman 秘密。仅凭此缺陷不足以设置MiTM 攻击（因此风险因素为“无”），因为它需要一些 SSL 实现缺陷来影响连接到远程主机的客户端之一。

收到的数据：可以通过发送值为 1 的 DH 密钥来完成完整的 SSL 握手。其他参考：OSVDB：70945，OSVDB：71845

解决方法：在 FIPS 模式下编译时，OpenSSL 会受到影响。要解决此问题，请升级到 OpenSSL 1.0.0、禁用 FIPS 模式或将服务器使用的密码套件配置为不包含任何 Diffie-Hellman 密钥交换。PolarSSL 受到影响。要解决此问题，请升级到版本 0.99-pre3 / 0.14.2 或更高版本。如果使用任何其他 SSL 实现，请将服务器使用的密码套件配置为不包含任何 Diffie-Hellman 密钥交换或联系您的供应商获取补丁。”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:40:08.900

使用 3。

你可以谷歌“禁用 TLS Tomcat 7”来找到如何做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-25T07:56:20.387

对我来说，在 conf/server.xml 中将允许的密码列表添加到 Tomcat 配置以禁用弱 Diffie-Hellman 密码后，它就起作用了：

```
 <Connector
        protocol="HTTP/1.1"
        port="8000"
        ...
        scheme="https"
        secure="true"
        clientAuth="false"
        sslProtocol="TLS" 
        SSLEnabled="true"
        ciphers="TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA256,TLS_RSA_WITH_AES_256_CBC_SHA"
        redirectPort="8443" 
```

# jquery - 在浏览器后退按钮上重新加载验证码

> ID：14268467
> 
> 赞同：1
> 
> 时间：2013-01-10T22:30:56.430
> 
> 标签：jquery, reload, recaptcha, back

回页时我尝试了多种方法来重新加载图像，但无论我尝试什么，我都会得到相同的图像。一些方法很接近（我可以看到图像刷新，但recaptcha 服务器响应并重新出现以前的图像）。单击后退按钮时是否有一些技巧可以让图像重新加载？我不希望我的用户在输入错误的安全词时必须重新输入所有表单信息。我还想避免存储所有信息。该页面是经典的 asp，因此 jquery 或 ajax 方法将是要走的路线，或者 id 假设。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T04:42:42.397

我想出了一个快速破解来解决这个问题。在带有recaptcha 的页面上添加以下jquery

```
<script>
$(document).ready(function(){
  $("#form_div").Show();
);
</script> 
```

只需将“#form_div”替换为包含您的表单的任何 div。现在，当用户点击后退按钮时，它会刷新 recaptcha 图像。从任何意义上来说，这都是一种黑客攻击，但它对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:40:37.377

从以下位置调用您的刷新方法`window.onload`：

```
window.onload = function(){ /* refresh here */ } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T23:08:11.770

编辑：删除历史 API 答案以显示可能的 AJAX 答案。

使用 jQuery，这非常容易。

```
$(window).on('load',function(){
    $('#RecaptchaContainer').load('/path/to/recaptcha.php',function(){
         // any javascript you need to perform on the recaptcha
    });
}); 
```

您可以在该文件中包含所有 recaptcha HTML，但您可以在该回调函数中包含所有 javascript。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-18T02:36:34.187

这是适用于 Chrome 的简单方法：

在 HTML 正文上添加重新加载功能，如下所示：

```
<body onload="javascript:Recaptcha.reload()"> 
```

`reCaptcha`当用户单击后退按钮时，图像会在 Chrome 中自动重新加载。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-18T09:49:31.513

通过使用这行代码，我设法让它正确刷新：

```
body onLoad="javascript:Recaptcha.reload()" 
```

但是这种方法不是一个好的解决方案，因为焦点设置在 recaptacha 文本字段上，这意味着窗口向下滚动到页面底部，即 recaptacha 字段所在的位置，即使您是第一次进入页面（不是仅当按“返回”到页面时）。此解决方案有效，但最好找到一个不将焦点设置在 recaptacha 输入字段上的解决方案。

# php - PHP/MySQL：使用准备好的语句在 WHERE 子句中使用数组元素

> ID：14268473
> 
> 赞同：2
> 
> 时间：2013-01-10T22:31:10.067
> 
> 标签：php, mysql, prepared-statement

我想`WHERE`根据字符串数组在我的查询中创建一个“动态”子句。我想使用 Mysqi 的预处理语句运行创建的查询。

到目前为止我的代码，PHP：

```
$searchArray = explode(' ', $search);
$searchNumber = count($searchArray);
$searchStr = "tags.tag LIKE ? ";
for($i=1; $i<=$searchNumber-1 ;$i++){
    $searchStr .= "OR tags.tag LIKE ? ";
} 
```

我的查询：

```
SELECT tag FROM tags WHERE $searchStr; 
```

更多PHP：

```
$stmt -> bind_param(str_repeat('s', count($searchArray))); 
```

现在这显然给了我一个错误，因为 bind_param 部分只包含它需要的一半细节。

我应该如何进行？

还有其他（更好的）方法吗？

它安全吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T00:21:39.340

关于问题的安全部分，带有占位符的准备好的语句与用值填充这些占位符所涉及的验证机制一样安全。对于 mysqli 准备好的语句，[文档](http://php.net/manual/en/mysqli.prepare.php)说：

> 标记仅在 SQL 语句中的某些位置是合法的。例如，它们可以在 INSERT 语句的 VALUES() 列表中使用（以指定行的列值），或者在与 WHERE 子句中的列进行比较以指定比较值时。
> 
> 但是，它们不允许用于标识符（例如表名或列名），在命名要由 SELECT 语句返回的列的选择列表中，或指定二元运算符（例如 = 等号）的两个操作数。后一个限制是必要的，因为不可能确定参数类型。不允许将标记与 NULL 进行比较？也为空。通常，参数仅在数据操作语言 (DML) 语句中合法，在数据定义语言 (DDL) 语句中不合法。

这显然排除了修改查询的一般语义的任何可能性，这使得更难（但并非不可能）将其从最初的意图转移。

关于查询的动态部分，您可以`str_repeat`在查询条件构建部分中使用，而不是执行循环：

```
 $searchStr = 'WHERE tags.tag LIKE ?' . 
                        str_repeat($searchNumber - 1, ' OR tags.tag LIKE ?'); 
```

对于`bind_param`通话，您应该`call_user_func_array`像这样使用：

```
$bindArray[0] = str_repeat('s', $searchNumber);
array_walk($searchArray,function($k,&$v) use (&$bindArray) {$bindArray[] = &$v;});
call_user_func_array(array($stmt,'bind_param'), $bindArray); 
```

希望上面的代码片段应该将查询中的每个值`$bindArray`与其对应的占位符绑定。

* * *

附录：

但是，您应该警惕两件事：

*   `call_user_func_array`需要一个整数索引数组作为其第二个参数。我不确定它在字典中的表现如何。
*   `mysqli_stmt_bind_param` [要求](http://php.net/manual/en/mysqli-stmt.bind-param.php)其参数通过引用传递。

对于第一点，您只需要确保它`$bindArray`使用整数索引，上面的代码就是这种情况（或者检查它`call_user_func_array`不会阻塞您提供的数组）。

对于第二点，如果您打算在调用`$bindArray` **之后**`bind_param`（即通过`call_user_func_array`函数）和执行查询**之前修改数据，这将是一个问题。**如果您希望这样做 - 例如，通过在同一脚本中使用不同参数的值多次运行相同的查询，那么您将必须使用相同的数组 ( `$bindArray`) 来执行以下查询，并使用相同的键。除非手动完成，否则复制另一个数组是行不通的：

```
foreach($bindArray as $k => $v)
    $bindArray[$k] = some_new_value(); 
```

或者

```
foreach($bindArray as &$v)
    $v = some_new_value(); 
```

上面的方法会起作用，因为它不会破坏`bind_param`先前调用时与该语句绑定的数组条目上的引用。同样，以下应该有效，因为它不会更改之前设置的引用。

```
array_walk($bindArray, function($k,&$v){$v = some_new_value();}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:37:30.543

准备好的语句需要有明确定义的参数数量；它不能有任何动态功能元素。这意味着您必须生成您需要的特定语句并准备好它。

你可以做的——如果你的代码在数据库连接存在期间被多次调用——是缓存那些准备好的语句，并根据你正在接受的参数数量对它们进行索引。这意味着您第二次使用三个参数调用该函数时，您已经完成了该语句。但是由于准备好的语句无论如何都不能在断开连接中幸存下来，因此只有在同一脚本运行中执行多个查询时，这才有意义。（我故意省略了持久连接，因为这会打开一个完全不同的蠕虫罐头。）

顺便说一句，我不是 MySQL 专家，但是没有 where 条件加入，而是写作不会有什么不同`WHERE tags in (tag1, tag2, tag3, tag4)`吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T20:09:14.220

[在此处](https://stackoverflow.com/a/7240875/1523238 "这里")找到的答案的帮助下解决了这个问题。

```
$query = "SELECT * FROM tags WHERE tags.tag LIKE CONCAT('%',?,'%')" . str_repeat(" OR tags.tag LIKE CONCAT('%',?,'%')", $searchNumber - 1)

$stmt = $mysqli -> prepare($query);
$bind_names[] = str_repeat('s', $searchNumber);

for ($i = 0; $i < count($searchArray); $i++){
   $bind_name = 'bind'.$i; //generate a name for variable bind1, bind2, bind3...
   $$bind_name = $searchArray[$i]; //create a variable with this name and put value in it
   $bind_names[] = & $$bind_name; //put a link to this variable in array
}

call_user_func_array(array($stmt, 'bind_param'), &$bind_names);

$stmt -> execute(); 
```

# php - 安全表单提交

> ID：14268487
> 
> 赞同：1
> 
> 时间：2013-01-10T22:32:11.723
> 
> 标签：php, html, forms, security, submit

所以有人告诉我，每当有人在您的前端查看源代码时，让这种东西可见是不安全的：

```
<form action="http://www.somedomain.com/form.php" method="post"> 
```

基本上，能够看到表单提交的 php 文件的人是危险的。是这样吗？如果是这样，我如何使我的可见源安全，同时仍然让表单提交给我们假设的“form.php”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:36:12.910

首先，php源代码不能被查看，除非你通过htaccess或其他方式限制访问，其次，你的前端源代码必须始终是公开的，因为安全问题没有从前到后处理——最后，第三，您的 php 文件的源不能像 css 文件或 javascript 代码一样查看

如果你想限制对 form.php 的直接 HTTP 访问，你可以使用 .htaccess

我使用这个解决方案，一些文件被标记为 somefile.php，但一些 util 文件要么存储在一个文件夹中，要么被标记为 utils.inc.php，所以我确保我限制对 inc.php 文件的直接访问并允许一切别的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:36:57.420

我个人认为显示表单提交的页面也没有问题，因为一旦用户提交了他/她的输入，`action=""`无论如何都会将用户重定向到所述页面，所以无论哪种方式，他们都会看到他们将在哪里结束向上。无论是在 URL 栏还是表单脚本中。

只需确保在将用户输入数据通过数据库之前对其进行清理。

取决于您用于数据库交互的内容；将提供保护您免受注射的功能

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:40:06.217

默默无闻的安全性是一个很好的策略，只有在非常选择的特定情况下。但是知道表单提交到哪里——这实际上是 Web 表单的本质。现在有办法了。

即使您提交的 URL 是为了某种安全感而以某种方式动态创建的——只要在浏览器和服务器之间建立一个代理，整个 HTTP 对话就可以打开以供阅读。

# windows - 如何让 CRichEditView 与 MDI 结合使用

> ID：14268489
> 
> 赞同：0
> 
> 时间：2013-01-10T22:32:16.943
> 
> 标签：windows, mfc

CRichEditView (+ ~Doc 和 ~CntrItem) 与 MDI 相结合在遗留 MFC 项目 (1998) 中工作，但不再与最新 (11) 版本的 MFC 一起使用，使用 Visual Studio 2012 C++ 专业版。显然，CRichEditView.m_lpRichEditOle 仍然是 zeroNull0nada。当我尝试将 MDI 示例中的 CDocument 类的派生从 MSDN (MDIDocvw) 更改为 CRichEditDoc 类（以及相应的视图和 controlItems）时，也会发生同样的情况。我需要知道这是否是确定的，由女士决定，还是这里的一些误解。我可能对 TabbedDI 也很满意。

谢谢

# perl - charnames::viacode() 的简称？

> ID：14268493
> 
> 赞同：0
> 
> 时间：2013-01-10T22:32:39.780
> 
> 标签：perl, unicode

是否有一个版本`charnames::viacode()`将返回代码点的短名称，即`use charnames ':short'`在生效时可以使用的名称？

```
use charnames ':short';

my $x = ord("\N{Cyrillic::es}");

say "long name:  ", charnames::viacode($x); # prints "CYRILLIC SMALL LETTER ES"
say "short name: ", ???($x);                # want: Cyrillic:es 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:14:26.213

[charnames](http://search.cpan.org/perldoc?charnames)文件表明

```
SCRIPTNAME:CHARNAME 
```

搜索

*   SCRIPTNAME CAPITAL LETTER CHARNAME（如果 CHARNAME 不是全部小写）
*   SCRIPTNAME SMALL LETTER CHARNAME（如果 CHARNAME 全部小写）
*   脚本名称字母字符名称

所以你可以使用

```
sub short_name {
   my ($long_name) = @_;
   return "$1:\U$2" if $long_name =~ /^(\S+) CAPITAL LETTER (\S+)\z/;
   return "$1:\L$2" if $long_name =~ /^(\S+) SMALL LETTER (\S+)\z/;
   return "$1:$2"   if $long_name =~ /^(\S+) LETTER (\S+)\z/;
   return $long_name;
} 
```

# php - 检查肥皂连接是否工作

> ID：14268494
> 
> 赞同：10
> 
> 时间：2013-01-10T22:32:40.310
> 
> 标签：php, soap, soap-client

快速一个，您将如何检查您与肥皂服务器的连接是否实际连接？

我有这个代码：

```
$m_wsdl = "https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl";
    try {
        $client = new SoapClient($m_wsdl);

        $this->m_messages = $client->peekMessages('','',10,"");
    } catch (Exception $e) {

        echo "Exception: \n" . $e->getMessage() . "\n";
    }

    $this->do_parse_xml(); 
```

显然，我的用户名和密码在 peekmessages 字段中它们应该在的位置，它们都是正确的，我是 100%。

出于某种原因，它根本没有返回任何数据，我不知道如何检查连接是否真的有效？

我没有得到任何例外的回应

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:46:48.637

使用`isSoapFault()` [http://php.net/manual/en/function.is-soap-fault.php](http://php.net/manual/en/function.is-soap-fault.php)

此外，该`peekMessages`方法可能会返回`false`或`SoapFault`.

您也可以`Exceptions`在`SoapClient`

# shader - CG着色器，控制每个片段的Z-Write？

> ID：14268496
> 
> 赞同：1
> 
> 时间：2013-01-10T22:32:45.443
> 
> 标签：shader, cg, depth-buffer

是否可以以某种方式控制每个片段是否应将深度写入深度缓冲区？

我希望对我的对象进行正确的深度测试（因此我需要为每个片段输出准确的深度进行测试），但我只希望将一些片段写入缓冲区。

有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:56:10.870

渲染一个不写入颜色缓冲区的通道。随意使用剪辑/丢弃。

渲染另一个写入颜色而不是深度缓冲区的通道。

# c# - 在后面的代码中为 Image 设置 NotifyOnSourceUpdate

> ID：14268498
> 
> 赞同：0
> 
> 时间：2013-01-10T22:32:53.960
> 
> 标签：c#, wpf, binding

`NotifyOnSourceUpdate`是否可以在代码中设置属性`Image`in `WPF`？我需要在后面的代码中执行此操作。我不能使用：[MSDN](http://msdn.microsoft.com/library/system.windows.data.binding.notifyonsourceupdated.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:56:14.320

如果`Binding`已经设置`Xaml`或代码您不能更改绑定属性，但您可以创建并分配一个新的绑定到您的`Image`

```
 Binding binding = new Binding("MyImageProperty") { NotifyOnSourceUpdated = true };
 image.SetBinding(Image.SourceProperty, binding); 
```

# ruby-on-rails - 根据另一个关系获取课程

> ID：14268499
> 
> 赞同：-2
> 
> 时间：2013-01-10T22:32:55.933
> 
> 标签：ruby-on-rails, ruby, rails-activerecord

我有两个关系，称为`Course`and `School`。

`Course`还有一个日期时间字段`open_date`。

我想返回学校等级不是1的所有课程，并且在某个日期内。

我想要一些这样的rails代码：

```
Course.includes(:school).where("school.tier <> ? AND open_date between ? and ?",1 , date1, date2) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:40:18.753

你几乎在那里：

```
Course.joins(:schools).where("schools.tier <> ? AND schools.open_date between ? and ?",1 , date1, date2) 
```

该`joins`条款将消除与学校无关的课程。

（如果不起作用，请尝试使用`joins(:school)`）

# jquery - ColorBox：使用链接到覆盖中的全尺寸图像的图像拇指

> ID：14268502
> 
> 赞同：2
> 
> 时间：2013-01-10T22:33:05.813
> 
> 标签：jquery, colorbox

我的彩盒工作正常。

有没有办法从颜色框内获取完整尺寸的图像（800 像素 x 800 像素）并将其用作颜色框锚点中的小拇指（100 像素 x 100 像素），就像颜色框覆盖显示全尺寸一样？

```
<a href="pathToImage/image.jpg" class="colorbox"><img src="pathToImage/image.jpg" /></a> 
```

href = 100px x 100px thumb img = 全尺寸

或者，这是否最好由 timthumb 之类的东西来完成？

仅供参考...我在 wordpress 插件的管理区域中使用颜色框。

[更新] 因为我在 Wordpress 中执行此操作，据我了解，更改图像大小内嵌广告在页面加载时间上不必要的开销。

这是我正在使用的 jquery： add_action( 'admin_head', 'do_colorbox_script' );

函数 wlmm_do_colorbox_script() {

```
$max_width  = '';       $max_height     = '';
$width      = '';       $height         = '';
$inner_width    = '';       $inner_height  = '';
$opacity        = '0.9';
$img_error  = 'Sorry this image not currently available.';

// Colorbox settings
echo '
<script>
  jQuery(document).ready(function () {
      jQuery("a.help").colorbox({ 
      maxWidth:"'.$max_width.'", 
      maxHeight:"'.$max_height.'", 
      Width:"'.$width.'", 
      Height:"'.$height.'", 
      innerWidth:"'.$inner_width.'", 
      innerHeight:"'.$innerHeight.'", 
      imgError:"'.$img_error.'",
      opacity:'.$opacity.' });
  });
</script>'; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:42:45.033

试试这个：

`<a href="pathToImage/image.jpg" class="colorbox"><img width="100" height="100" src="pathToImage/image.jpg" /></a>`

但是，除非您还可以提供用于调用它的颜色框 jQuery，否则很难给出完整的答案。

# c++ - 对象 C 的顺序列表；选择领域

> ID：14268504
> 
> 赞同：1
> 
> 时间：2013-01-10T22:33:08.930
> 
> 标签：c++, list, sorting, object

经过大量研究和尝试解决这个问题

我想知道是否有办法在 C++ 中订购对象列表；

到目前为止我看到的所有解决方案，我们必须事先定义哪个阵营将用于排序。

我想要的是让用户自由选择他想用哪个阵营来排序这是我的代码

```
class LOL
{
   public:
   LOL( const string& Nickname = "", int skill = 0,int level= 0 );
   bool operator > ( const LOL &rhs ) const; 
   void print() const;

   private:
   int level_;
   string Nickname_;
   int skill_;
};

inline
LOL::LOL( const string& Nickname, int skill, int level)
   : level_( level), Nickname_( Nickname ), skill_( skill )
{} 

inline
bool LOL::operator > ( const LOL& rhs ) const
{ return Nickname_  > rhs.Nickname_; } 

inline
void LOL::print() const
{ cout << Nickname_ << " from level " << level_
   << " has skill of [ " << skill_ <<" ]"<< endl<< endl;
}

int main( )
{
   list<LOL> list1;
   list1.push_back( LOL( "Dhespair", 50000, 30 ) );
   list1.push_back( LOL( "Pedro", 1, 1 ) );
   list1.push_back( LOL( "Blackblood", 99999, 30 ) );
   list1.push_back( LOL( "Zladovic", 30000, 25 ) );

   list1.sort( greater <LOL>()  );
   for_each( list1.begin(), list1.end(), mem_fun_ref( &LOL::print ) );
   printf("\n\n");
   system("pause");
} 
```

经过几次尝试，我想出了这个解决方案

```
class LOL
{
   public:
   LOL( const string& Nickname = "", int skill = 0,int level= 0 , int op=1);
   bool operator > ( const LOL &rhs        ) const; // MUDAR O > para maior  ou < MENOR
   bool operator < ( const LOL &rhs        ) const; // MUDAR O > para maior  ou < MENOR
   void print() const;

   private:
   int level_;
   string Nickname_;
   int skill_;
   int op_;
};

inline
LOL::LOL( const string& Nickname, int skill, int level, int op)
   : level_( level), Nickname_( Nickname ), skill_( skill ), op_( op )
{} 

inline
bool LOL::operator > ( const LOL& rhs ) const
{ 
    switch(rhs.op_)
    {
    case 1:
    return Nickname_  > rhs.Nickname_; 
    break;

    case 2:
    return level_  > rhs.level_; 
    break;

    case 3:
    return skill_ > rhs.skill_; 
    break;
    } // MUDAR O  > para maior  ou < MENOR e ESCOLHER CAMPO A TER EM CONTA
}

inline
bool LOL::operator < ( const LOL& rhs ) const
{ 
    switch(rhs.op_)
    {
    case 1:
    return Nickname_  < rhs.Nickname_; 
    break;

    case 2:
    return level_  < rhs.level_; 
    break;

    case 3:
    return skill_ < rhs.skill_; 
    break;
    } // MUDAR O  > para maior  ou < MENOR e ESCOLHER CAMPO A TER EM CONTA
}

inline
void LOL::print() const
{ cout << Nickname_ << " from level " << level_
   << " has skill of [ " << skill_ <<" ]"<< endl<< endl;
}

int main( )
{
   list<LOL> list1;
   list1.push_back( LOL( "Dhespair", 50000, 30,3 ) );
   list1.push_back( LOL( "Pedro", 1, 1,3 ) );
   list1.push_back( LOL( "Blackblood", 99999, 30,3) );
   list1.push_back( LOL( "Zladovic", 30000, 25,3 ) );

   list1.sort( less <LOL>()  );
   for_each( list1.begin(), list1.end(), mem_fun_ref( &LOL::print ) );
   printf("\n\n");
   system("pause");
} 
```

我所做的是对我的对象有一个新值，我将使用它来操作 bool 运算符内的 switch case。

它有效，但如果有人知道一种使用该开关的方法，而不必在我的对象中有一个新参数，我真的很感激 x)

此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:37:19.330

```
bool compareTwoLOLObjectsWay1(LOL &A, LOL &B)
{
  /* Logic to determine if A<B */
}

bool compareTwoLOLObjectsWay2(LOL &A, LOL &B)
{
  /* Logic to determine if A>B */
}

switch(sortWay)
{
  case 1:
    list1.sort(&compareTwoLOLObjectsWay1);
    break;
  case 2:
    list1.sort(&compareTwoLOLObjectsWay2);
    break;
} 
```

# yii - 在 OS X 上使用 Yiic 和 AMPPS

> ID：14268505
> 
> 赞同：2
> 
> 时间：2013-01-10T22:33:09.157
> 
> 标签：yii

我正在尝试在我的 iMac 上使用 yiic shell 和 yiic 迁移工具，但我似乎遇到了一些困难。我认为这可能是因为我使用 AMPPS 作为我的开发服务器，而不是单独安装 Apache/PHP/MySQL。例如，在我的项目中，我有一个名为的模型`Project`，它对应于我的 MySQL 数据库中名为`tbl_project`. 我可以使用以下命令调用 yiic shell：

```
./yiic shell /Applications/AMPPS/www/TrackStar/protected/config/main.php 
```

但是，当我运行时：

```
var_dump(Project::model()->findAll('id = 1')); 
```

我收到这个冗长的错误消息：

```
Warning: PDO::__construct(): [2002] No such file or directory (trying to connect via unix:///var/mysql/mysql.sock) in /Applications/AMPPS/YiiRoot/framework/db/CDbConnection.php on line 423
exception 'CDbException' with message 'CDbConnection failed to open the DB connection: SQLSTATE[HY000] [2002] No such file or directory' in /Applications/AMPPS/YiiRoot/framework/db/CDbConnection.php:381
Stack trace:
#0 /Applications/AMPPS/YiiRoot/framework/db/CDbConnection.php(330): CDbConnection->open()
#1 /Applications/AMPPS/YiiRoot/framework/db/CDbConnection.php(308): CDbConnection->    setActive(true)
#2 /Applications/AMPPS/YiiRoot/framework/base/CModule.php(387): CDbConnection->init()
#3 /Applications/AMPPS/YiiRoot/framework/base/CModule.php(103): CModule->getComponent('db')
#4 /Applications/AMPPS/YiiRoot/framework/cli/commands/ShellCommand.php(131) : eval()'d code(1): CModule->__get('db')
#5 /Applications/AMPPS/YiiRoot/framework/cli/commands/ShellCommand.php(131): eval()
#6 /Applications/AMPPS/YiiRoot/framework/cli/commands/ShellCommand.php(99): ShellCommand->runShell()
#7 /Applications/AMPPS/YiiRoot/framework/console/CConsoleCommandRunner.php(67): ShellCommand->run(Array)
#8 /Applications/AMPPS/YiiRoot/framework/console/CConsoleApplication.php(91): CConsoleCommandRunner->run(Array)
#9 /Applications/AMPPS/YiiRoot/framework/base/CApplication.php(169): CConsoleApplication->processRequest()
#10 /Applications/AMPPS/YiiRoot/framework/yiic.php(33): CApplication->run()
#11 /Applications/AMPPS/www/TrackStar/protected/yiic.php(7): require_once('/Applications/A...')
#12 /Applications/AMPPS/www/TrackStar/protected/yiic(4): require_once('/Applications/A...')
#13 {main} 
```

我认为这可能是因为它试图通过

```
unix:///var/mysql/mysql.sock 
```

这不是我的 MySQL shell 所在的位置。我已经配置了我的 config/main.php 和 config/console.php 以反映：

```
'db'=>array(
    'connectionString' => 'mysql:host=localhost;dbname=trackstar',
    'emulatePrepare' => true,
    'username' => 'root',
    'password' => 'mysql',
    'charset' => 'utf8',
), 
```

任何人都可以帮忙吗？当我尝试使用迁移功能时，我遇到了同样的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:44:30.483

我认为您应该定义正确的套接字路径

```
connectionString=>msql:host=localhost;dbname=trackstar;unix_socket=socket/path', 
```

# jquery - Jquery 无停止背景位置

> ID：14268508
> 
> 赞同：0
> 
> 时间：2013-01-10T22:33:12.747
> 
> 标签：jquery

我正在尝试创建一个简单的移动背景。它是第一次工作，但是我不知道如何运行不间断动画功能。你能告诉我如何让它持续工作吗？如果您让我知道如何使用 jquery 缓动函数，这可以使移动更加顺畅，那就太好了。

这是我的代码：
1- Html：

```
<div class="wave"></div> 
```

2-CSS：

```
.wave{ background:url(http://www.publicspace.net/images/vitamin/cloud.png) top left no-repeat;
 width:70px;
 height:70px; 
```

}

3- jQuery：

```
$(document).ready(function(){
$('.wave').css({'background-position': '0px 0px'}). 
animate({'background-position': '-160px 0px'}); 
}); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:41:29.703

编辑：

```
 $(document).ready(function(){

        doit();

        });

function doit(){
        $('.wave').css({'background-position': '0px 0px'}). 

        animate({'background-position': '-160px 0px'},doit()); 
} 
```

# web-services - “打印”到 Web 服务，并传递上下文信息

> ID：14268509
> 
> 赞同：1
> 
> 时间：2013-01-10T22:33:13.243
> 
> 标签：web-services, printing

**问题：** 我们有一个基于网络的医疗软件应用程序，作为解决方案的一部分，它允许人们上传和共享文件。将这些文件从其源电子病历应用程序中保存并上传到我们的过程中，对于用户来说是很麻烦的。

**目标：** 我希望他们能够通过标准打印对话框从源应用程序“打印”（这是必要的，因为我们无法控制源应用程序），但将该文档实际上传到我们的网络应用程序通过网络服务、IPP 或类似服务。

**并发症：** 我们还需要一些上下文数据：你打印的这个东西属于哪个病人？这是通过用户需要指定的标识符来完成的，我们将在我们这边进行匹配。

**我需要帮助：** 我对打印驱动程序、端口重定向（例如 RedMon）或 IPP 或类似的东西了解得不够多，不知道应该如何构建它。这是我的尝试。这行得通吗？有没有更简单的方法？

1.  用户安装 RedMon 或类似软件以及我们编写的用于捕获打印机图像的自定义本地应用程序
2.  这会触发本地应用程序提示用户输入我们需要匹配文档的患者信息
3.  然后本地程序进行身份验证，并将文件上传到我们的网络服务，供用户使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-17T16:06:53.913

我猜你的用户操作系统是 windows，所以一个很好的起点是**PDFCreator**（一个开源的 windows 虚拟打印机）。

将您的文件另存为：

*   PDF格式，
*   PNG，
*   JPEG,
*   BMP,
*   PCX,
*   国际电影节，
*   PS，
*   每股收益，
*   TXT，
*   PSD，
*   PCL,
*   生的，
*   SVG

通过指定位置并使用文件命名约定到本地文件系统。使用**保存后的操作**来运行 shell 脚本。使用此 shell 脚本向**用户询问更多元数据**，并让此脚本**上传到您的 Web 服务**。

PDFCreator 是开源的（您可以在 sourceforge.com 上找到它），因此您可以将一些元数据字段添加到打印机对话框，并通过文件命名约定将它们传递给 shell 脚本。

另一种选择是收集您的 web 应用程序中的所有上传并在上传后添加元数据。可能是为每个用户实施“虚拟打印机队列”的选项（由上传者/作者/Windows用户名/从主机名上传）。

也许你可以从这里开始（未经测试）：

```
Scripts/RunProgramAfterSaving/FTPUpload.vbs 
```

也可能很有趣：

```
Scripts/RunProgramAfterSaving/PopUpMessage.vbs 
```

**注意：注意**不要**使用**PDFCreator 设置安装广告软件。

# c# - 将一系列事件转换为更精细的值序列

> ID：14268511
> 
> 赞同：3
> 
> 时间：2013-01-10T22:33:21.477
> 
> 标签：c#, system.reactive

简而言之，我正在尝试使用 Reactive Library 来实现一个简单的 tail 实用程序，以便在将新行附加到文件时主动监控它们。这是我到目前为止得到的：

```
 static void Main(string[] args)
    {
        var filePath = @"C:\Users\wbrian\Documents\";
        var fileName = "TestFile.txt";
        var fullFilePath = filePath + fileName;
        var fs = new FileStream(fullFilePath, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);
        var sr = new StreamReader(fs, true);
        sr.ReadToEnd();
        var lastPos = fs.Position;

        var watcher = new FileSystemWatcher(filePath, fileName);
        watcher.NotifyFilter = NotifyFilters.Size;
        watcher.EnableRaisingEvents = true;

        Observable.FromEventPattern<FileSystemEventHandler, FileSystemEventArgs>(
            action => watcher.Changed += action,
            action => watcher.Changed -= action)
             .Throttle(TimeSpan.FromSeconds(1))
             .Select(e =>
                 {
                     var curSize = new FileInfo(fullFilePath).Length;
                     if (curSize < lastPos)
                     {
                         //we assume the file has been cleared,
                         //reset the position of the stream to the beginning.
                         fs.Seek(0, SeekOrigin.Begin);
                     }
                    var lines = new List<string>();
                    string line;
                    while((line = sr.ReadLine()) != null)
                    {
                        if(!string.IsNullOrWhiteSpace(line))
                        {
                            lines.Add(line);
                        }
                    }
                     lastPos = fs.Position;
                     return lines;
                 }).Subscribe(Observer.Create<List<string>>(lines =>
                 {
                     foreach (var line in lines)
                     {
                         Console.WriteLine("new line = {0}", line);
                     }
                 }));

        Console.ReadLine();
        sr.Close();
        fs.Close();
    } 
```

如您所见，我从 FileWatcher 事件创建了一个 Observable，该事件在文件大小更改时触发。从那里，我确定哪些行是新的，并且 observable 返回一个新行列表。理想情况下，可观察序列将只是一个代表每个新行的字符串。可观察返回列表的唯一原因是因为我根本不知道如何按摩它来做到这一点。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:00:31.233

您可以使用[SelectMany](http://msdn.microsoft.com/en-us/library/hh211809.aspx)：

```
SelectMany(lines => lines)
.Subscribe(Observer.Create<string>(line => { Console.WriteLine("new line = {0}", line); }); 
```

# asp.net - 从上一页访问下拉列表？

> ID：14268513
> 
> 赞同：1
> 
> 时间：2013-01-10T22:33:23.297
> 
> 标签：asp.net, .net

在一个页面中，我有用户用来进行搜索的下拉列表。这些下拉列表是从数据库动态创建的，因此数量未知。

结果显示在下一页中，其中再次包含所有下拉菜单。我需要在结果页面中显示上一页中选定的下拉值，但不确定从搜索页面访问选定下拉值的最佳方法是什么。

请指导

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:38:33.777

你有几个选择。您可以将值存储在数据库或`Session`.

另一种选择是在通过 转移到下一页时使用页面的[`PreviousPage`属性](http://msdn.microsoft.com/en-us/library/system.web.ui.page.previouspage.aspx)[`Server.Transfer`](http://msdn.microsoft.com/en-us/library/y4k58xk7.aspx)。

[**ASP.NET 网页中的跨页发布**](http://msdn.microsoft.com/en-us/library/ms178139%28v=vs.100%29.aspx)

```
if (Page.PreviousPage != null)
{
    DropDownList ddl1 = 
        (DropDownList)Page.PreviousPage.FindControl("DropDownList1");
    if (ddl1 != null)
    {
        Label1.Text = ddl1.SelectedItem.Text;
    }
} 
```

如果这不适用于先前页面上的动态控件（从未测试过），您可以尝试使用`Request.Form["DropDownList1"]`来获取值。

# php - How does a string returned from a SQL select statement get encoded?

> ID：14268519
> 
> 赞同：0
> 
> 时间：2013-01-10T22:34:04.083
> 
> 标签：php, mysql, character-encoding

Here's a sample string, stored in a MySQL database, running on a Linux server: ™</p>

That's the single TM character, which is represented as `0x2122` in `UTF-16BE`, or `0xE284A2` in `UTF-8`

The database table is encoded in `utf8-unicode-ci`. I'm running PHP on another Linux server, which uses an internal encoded (as reported by `mb_internal_encoding`) of `ISO-8859-1`, which uses the same encoding for the character as UTF-8.

When I run a SQL query to get the string, it returns `0x0099`, which is its representation in `Windows-1252`.

How would that even happen, and how can I fix it to return in a more sensible codepage?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:03:04.903

您观察到的行为是由于默认的 MySQL 客户端字符集造成的。

您可以覆盖默认值，并指定要用于客户端连接的字符集。如果您使用的是 mysqli，请执行以下操作：

```
$mysqli->set_charset('utf8'); 
```

看：

[http://php.net/manual/en/mysqlinfo.concepts.charset.php](http://php.net/manual/en/mysqlinfo.concepts.charset.php)

[http://dev.mysql.com/doc/refman/5.5/en/charset-connection.html](http://dev.mysql.com/doc/refman/5.5/en/charset-connection.html)

# jquery - JSON data parsing, sorting and merge with jquery

> ID：14268520
> 
> 赞同：1
> 
> 时间：2013-01-10T22:34:07.103
> 
> 标签：jquery, json

I have a long array of pks. Which has been converted into a json object `pk:count` This how I created it

```
var count = {};
topPKs=[];
topPKs.push(pk1);
topPKs.push(pk2);
topPKs.push(pk3);
topPKs.push(pk1);
topPKs.push(pk1);
$.each(topPKs, function(key, value) {
                    if(!count[value])
                        count[value] = 1;
                    else
                        count[value]++;
                }); 
```

This is how it looks in console:

```
Object
511909695: 3
523212317: 2
530009912: 3
532408581: 2
533498979: 1
555813096: 1
574723371: 1
574938523: 1
580120684: 6
584152864: 2 
```

There is an object array with pk and name. So when I say Object.pk, it returns pk value.
Not all pks in the second object array present in the first object with pk:count.

```
0: Object
    pk: "609819451"
    name: "Some Name"
1: Object
2: Object 
```

Now I want to sort second object array based on the pk count present in the first object. I am not sure how would traverse through all the pks in the first object. Because it is not an array. Should I create it a different way?

1.  How would I traverse the first object with jquery?
2.  How would I sort the second object array based on the count of pk in first PK?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:42:28.513

```
for(var k1 in obj1){ var record = obj1[k1];
  for(var k2 in obj2){ 
    if (obj2[k2].pk == record)
       obj2[k2].count = record.count;
  }
} 
```

然后按 count 属性对第二个对象进行[排序](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort)

```
obj2.sort(function _internalSort(l,r){var x = l.count || 0, y = r.count || 0;return y - x; })
//this handles the case where a value appears in the second list but not the first
//by forcing all values to have a count for the sorting method 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:43:13.023

我不清楚你到底在问什么，因为你提供的数据没有以实际的 javascript 语法显示。但是，要遍历对象的所有属性，您可以这样做：

```
for (var prop in obj) {
    var item = obj[prop];
    // prop is the property name
    // item is the value of the property
} 
```

注意：对象的属性没有定义的顺序。

# intellij-idea - Running a GEB test using Intellij

> ID：14268523
> 
> 赞同：0
> 
> 时间：2013-01-10T22:34:22.890
> 
> 标签：intellij-idea, geb

Being a beginner in GEB testing, I am trying to run a simple login program in Intellij. Could you please help me run this test in Intellij? My question is what selections should I make in the edit configurations page? Please help. This example is from the book of geb.

```
import geb.Browser

Browser.drive {
  go "http://google.com/ncr"

  // make sure we actually got to the page
  assert title == "Google"

  // enter wikipedia into the search field
  $("input", name: "q").value("wikipedia")

  // wait for the change to results page to happen
  // (google updates the page dynamically without a new request)
  waitFor { title.endsWith("Google Search") }

  // is the first link to wikipedia?
  def firstLink = $("li.g", 0).find("a.l")
  assert firstLink.text() == "Wikipedia"

  // click the link 
  firstLink.click()

  // wait for Google's javascript to redirect to Wikipedia
  waitFor { title == "Wikipedia" }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T06:51:50.977

如果您在 IntelliJ 中运行它，您应该能够将它作为 JUnit 测试 (ctrl+F10) 运行。确保这是在一个类的内部和一个方法中。

为了简化语法，最好使用 Spock 作为 BDD 框架（在项目中包含库；如果使用 Maven，请按照网站上的指南进行操作，但更新到 Spock 0.7-groovy-2.0 和 Geb 0.9.0-RC -1 表示最新的库

如果您想从直接的 JUnit 切换到 Spock（请记住，您应该使用 JUnit 作为静默库），那么您的测试用例如下所示：

```
 def "show off the awesomeness of google"() {
    given:
    go "http://google.com/ncr"

    expect: "make sure we actually got to the page"
    title == "Google"

    when: "enter wikipedia into the search field"
    $("input", name: "q").value("wikipedia")

    then: "wait for the change to results page to happen and (google updates the page dynamically without a new request)"
    waitFor { title.endsWith("Google Search") }
    // is the first link to wikipedia?
    def firstLink = $("li.g", 0).find("a.l")

    and:
    firstLink.text() == "Wikipedia"

    when: "click the link"
    firstLink.click()

    then: "wait for Google's javascript to redirect to Wikipedia"
    waitFor { title == "Wikipedia" }
} 
```

请记住：Ctrl + F10（在 IntelliJ 中进行测试的最佳快捷键！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-28T16:12:47.070

以上是接近但没有雪茄，可以这么说。

如果您想在 Intellij 内运行批量标准 Gebish 测试，我尝试了 2 件事。

1.  我将 geckodriver.exe 添加到我的 Spock/Geb 测试下的测试/资源中
2.  我确实在*给定的：*我的 Spok/Geb 测试的一部分做了以下事情：

    ```
     given:  
    System.setProperty("webdriver.gecko.driver", "C:\\repo\\geb-example-gradle\\src\\test\\resources" + "\\geckodriver.exe"); 
    ```

    1.  失败的
    2.  成功

现在通常处理答案是，有人写了一些东西，你尝试它，然后它失败了。因此，如果它不适合您，请使用 Github 上的参考 Geb/Spock 项目，如下所示并将其导入 intellij（记住，新建项目，然后找到 gradle.build 脚本，然后 intellij 将很好地导入它）...它还开始构建，所以不要惊慌失措：

1.  [https://github.com/geb/geb-example-gradle](https://github.com/geb/geb-example-gradle)
2.  下载驱动程序： [https](https://github.com/mozilla/geckodriver/releases) ://github.com/mozilla/geckodriver/releases 并将其移动到您刚刚在 test/groovy 下导入的参考项目的 test/resource 文件夹中...（见图）

现在将上面的*given:*子句添加到 GebishOrgSpec Sock/Geb 测试中： [![在 Spock/Geb 测试中配置 geckodriver.exe](../Images/4d6cc525e61df8829c223384c5bd3d37.png)](https://i.stack.imgur.com/SK2be.png)

该测试在 WITHIN Intellij 中运行良好。证明浏览器打开并且测试正在运行：

[![在此处输入图像描述](../Images/e23ed570b395b81257a0ff1d2279e807.png)](https://i.stack.imgur.com/gxZdZ.png)

**可爱的工作:=)**

# c# - 在 Umbraco 中访问全局会话密钥

> ID：14268525
> 
> 赞同：0
> 
> 时间：2013-01-10T22:34:27.430
> 
> 标签：c#, xslt, umbraco

我有一组会话密钥，我在全局类文件中声明，这些密钥在登录时正确设置。

```
public static class SessionKeys
{
    public static string memberToken = "token";
    public static string memberFirstName = "first_name";
    public static string role_pmn = "PMNInstructor";
    public static string role_superUser = "";
    public static string role_chapterAdmin = "ChapterMember";
    public static string role_registeredUser = "RegisteredUser";
} 
```

我需要稍后在 XSLT 宏中访问其中一些会话变量以进行导航。我无法找到在 XSLT 宏中访问这些变量的正确语法。

此语法适用于我的 .NET 宏：

```
Session[Globals.SessionKeys.role_pmn] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:16:03.630

正确的语法应该是 umbraco.library:Session

[此链接](http://en.wikibooks.org/wiki/Umbraco/Reference/umbraco.library/Session)应提供更多信息。

或者，您可以创建一个扩展库，在 .net 中获取参考，然后仅在 xslt 中引用您的库（供参考的[umbraco.tv 视频](http://umbraco.com/help-and-support/video-tutorials/developing-with-umbraco/xslt-extensions/introduction-to-xslt-extensions)，或[纯文本说明](http://en.wikibooks.org/wiki/Umbraco/Create_xslt_exstension_like_umbraco.Library_in_C)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:00:37.383

在 XSLT 中访问全局会话密钥的语法与在 C# 中用于访问它们的语法不同。您只需要使用您设置密钥的字符串值。

```
umbraco.library:Session(PMNInstructor) 
```

# c - 将 smbus.c 链接到 smbus.h？

> ID：14268530
> 
> 赞同：0
> 
> 时间：2013-01-10T22:34:50.223
> 
> 标签：c, raspberry-pi

我正在使用[此代码](http://www.raspberrypi.org/phpBB3/viewtopic.php?t=16968&p=233656)创建一个高度 ai ，在帖子的末尾，它指出，

> 要编译，请确保您下载了 smbus.c 和 smbus.h 文件，将 smbus.c 更改为正确链接到 smbus.h，并将上面提到的 DEFINE 行添加到 smbus.c，这样编译器就不会报错。

这里是 smbus.c，

```
#include <errno.h>
#include <i2c/smbus.h>
#include <sys/ioctl.h>
#include <linux/types.h>
#include <linux/i2c.h>
#include <linux/i2c-dev.h>

/* Compatibility defines */
#ifndef I2C_SMBUS_I2C_BLOCK_BROKEN
#define I2C_SMBUS_I2C_BLOCK_BROKEN I2C_SMBUS_I2C_BLOCK_DATA
#endif
#ifndef I2C_FUNC_SMBUS_PEC
#define I2C_FUNC_SMBUS_PEC I2C_FUNC_SMBUS_HWPEC_CALC
#endif

__s32 i2c_smbus_access(int file, char read_write, __u8 command,
           int size, union i2c_smbus_data *data)
{
    struct i2c_smbus_ioctl_data args;
    __s32 err;

    args.read_write = read_write;
    args.command = command;
    args.size = size;
    args.data = data;

    err = ioctl(file, I2C_SMBUS, &args);
    if (err == -1)
        err = -errno;
    return err;
}

__s32 i2c_smbus_write_quick(int file, __u8 value)
{
    return i2c_smbus_access(file, value, 0, I2C_SMBUS_QUICK, NULL);
}

__s32 i2c_smbus_read_byte(int file)
{
    union i2c_smbus_data data;
    int err;

    err = i2c_smbus_access(file, I2C_SMBUS_READ, 0, I2C_SMBUS_BYTE, &data);
    if (err < 0)
        return err;

    return 0x0FF & data.byte;
}

__s32 i2c_smbus_write_byte(int file, __u8 value)
{
    return i2c_smbus_access(file, I2C_SMBUS_WRITE, value,
                I2C_SMBUS_BYTE, NULL);
}

__s32 i2c_smbus_read_byte_data(int file, __u8 command)
{
    union i2c_smbus_data data;
    int err;

    err = i2c_smbus_access(file, I2C_SMBUS_READ, command,
                   I2C_SMBUS_BYTE_DATA, &data);
    if (err < 0)
        return err;

    return 0x0FF & data.byte;
}

__s32 i2c_smbus_write_byte_data(int file, __u8 command, __u8 value)
{
    union i2c_smbus_data data;
    data.byte = value;
    return i2c_smbus_access(file, I2C_SMBUS_WRITE, command,
                I2C_SMBUS_BYTE_DATA, &data);
}

__s32 i2c_smbus_read_word_data(int file, __u8 command)
{
    union i2c_smbus_data data;
    int err;

    err = i2c_smbus_access(file, I2C_SMBUS_READ, command,
                   I2C_SMBUS_WORD_DATA, &data);
    if (err < 0)
        return err;

    return 0x0FFFF & data.word;
}

__s32 i2c_smbus_write_word_data(int file, __u8 command, __u16 value)
{
    union i2c_smbus_data data;
    data.word = value;
    return i2c_smbus_access(file, I2C_SMBUS_WRITE, command,
                I2C_SMBUS_WORD_DATA, &data);
}

__s32 i2c_smbus_process_call(int file, __u8 command, __u16 value)
{
    union i2c_smbus_data data;
    data.word = value;
    if (i2c_smbus_access(file, I2C_SMBUS_WRITE, command,
                 I2C_SMBUS_PROC_CALL, &data))
        return -1;
    else
        return 0x0FFFF & data.word;
}

/* Returns the number of read bytes */
__s32 i2c_smbus_read_block_data(int file, __u8 command, __u8 *values)
{
    union i2c_smbus_data data;
    int i, err;

    err = i2c_smbus_access(file, I2C_SMBUS_READ, command,
                   I2C_SMBUS_BLOCK_DATA, &data);
    if (err < 0)
        return err;

    for (i = 1; i <= data.block[0]; i++)
        values[i-1] = data.block[i];
    return data.block[0];
}

__s32 i2c_smbus_write_block_data(int file, __u8 command, __u8 length,
                 const __u8 *values)
{
    union i2c_smbus_data data;
    int i;
    if (length > I2C_SMBUS_BLOCK_MAX)
        length = I2C_SMBUS_BLOCK_MAX;
    for (i = 1; i <= length; i++)
        data.block[i] = values[i-1];
    data.block[0] = length;
    return i2c_smbus_access(file, I2C_SMBUS_WRITE, command,
                I2C_SMBUS_BLOCK_DATA, &data);
}

/* Returns the number of read bytes */
/* Until kernel 2.6.22, the length is hardcoded to 32 bytes. If you
   ask for less than 32 bytes, your code will only work with kernels
   2.6.23 and later. */
__s32 i2c_smbus_read_i2c_block_data(int file, __u8 command, __u8 length,
                    __u8 *values)
{
    union i2c_smbus_data data;
    int i, err;

    if (length > I2C_SMBUS_BLOCK_MAX)
        length = I2C_SMBUS_BLOCK_MAX;
    data.block[0] = length;

    err = i2c_smbus_access(file, I2C_SMBUS_READ, command,
                   length == 32 ? I2C_SMBUS_I2C_BLOCK_BROKEN :
                I2C_SMBUS_I2C_BLOCK_DATA, &data);
    if (err < 0)
        return err;

    for (i = 1; i <= data.block[0]; i++)
        values[i-1] = data.block[i];
    return data.block[0];
}

__s32 i2c_smbus_write_i2c_block_data(int file, __u8 command, __u8 length,
                     const __u8 *values)
{
    union i2c_smbus_data data;
    int i;
    if (length > I2C_SMBUS_BLOCK_MAX)
        length = I2C_SMBUS_BLOCK_MAX;
    for (i = 1; i <= length; i++)
        data.block[i] = values[i-1];
    data.block[0] = length;
    return i2c_smbus_access(file, I2C_SMBUS_WRITE, command,
                I2C_SMBUS_I2C_BLOCK_BROKEN, &data);
}

/* Returns the number of read bytes */
__s32 i2c_smbus_block_process_call(int file, __u8 command, __u8 length,
                   __u8 *values)
{
    union i2c_smbus_data data;
    int i, err;

    if (length > I2C_SMBUS_BLOCK_MAX)
        length = I2C_SMBUS_BLOCK_MAX;
    for (i = 1; i <= length; i++)
        data.block[i] = values[i-1];
    data.block[0] = length;

    err = i2c_smbus_access(file, I2C_SMBUS_WRITE, command,
                   I2C_SMBUS_BLOCK_PROC_CALL, &data);
    if (err < 0)
        return err;

    for (i = 1; i <= data.block[0]; i++)
        values[i-1] = data.block[i];
    return data.block[0];
} 
```

这里是 smbus.h，

```
#ifndef LIB_I2C_SMBUS_H
#define LIB_I2C_SMBUS_H

#include <linux/types.h>
#include <linux/i2c.h>

extern __s32 i2c_smbus_access(int file, char read_write, __u8 command,
              int size, union i2c_smbus_data *data);

extern __s32 i2c_smbus_write_quick(int file, __u8 value);
extern __s32 i2c_smbus_read_byte(int file);
extern __s32 i2c_smbus_write_byte(int file, __u8 value);
extern __s32 i2c_smbus_read_byte_data(int file, __u8 command);
extern __s32 i2c_smbus_write_byte_data(int file, __u8 command, __u8 value);
extern __s32 i2c_smbus_read_word_data(int file, __u8 command);
extern __s32 i2c_smbus_write_word_data(int file, __u8 command, __u16 value);
extern __s32 i2c_smbus_process_call(int file, __u8 command, __u16 value);

/* Returns the number of read bytes */
extern __s32 i2c_smbus_read_block_data(int file, __u8 command, __u8 *values);
extern __s32 i2c_smbus_write_block_data(int file, __u8 command, __u8 length,
                    const __u8 *values);

/* Returns the number of read bytes */
/* Until kernel 2.6.22, the length is hardcoded to 32 bytes. If you
   ask for less than 32 bytes, your code will only work with kernels
   2.6.23 and later. */
extern __s32 i2c_smbus_read_i2c_block_data(int file, __u8 command, __u8 length,
                       __u8 *values);
extern __s32 i2c_smbus_write_i2c_block_data(int file, __u8 command, __u8 length,
                        const __u8 *values);

/* Returns the number of read bytes */
extern __s32 i2c_smbus_block_process_call(int file, __u8 command, __u8 length,
                      __u8 *values);

#endif /* LIB_I2C_SMBUS_H */ 
```

最后，这里是前面提到的Define命令，

> '#define NULL 0

有了这些信息，我该如何链接这两个文件并定义 null？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T23:43:56.900

在程序中包含标题。

```
#include <smbus.h> 
```

或者如果 .c 和 .h 都在同一个目录中；

```
#include "smbus.h" 
```

将此包含在您的 smbus.c 中。

# java - Image Panel doesn't show up immediately in JFrame

> ID：14268531
> 
> 赞同：0
> 
> 时间：2013-01-10T22:35:02.827
> 
> 标签：java, image, swing, user-interface, jframe

So I have a class which extends `JPanel` and on which I draw a `BufferedImage` (in its `paintComponent` method). However, the image doesn't show up until I resize the window. Any idea how to fix this? I've tried repaint without much success.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:37:02.297

You must use the `validate();` method along with `repaint();`.

```
frame.repaint();
frame.validate();
frame.setVisible(true); 
```

# mysql - Optimize sql query - select in select

> ID：14268532
> 
> 赞同：0
> 
> 时间：2013-01-10T22:35:05.920
> 
> 标签：mysql

Which is the best method for optimizing the select in select mysql query ?

This is my example:

```
SELECT count(distinct email) 
FROM emails_stats 
WHERE DATE_FORMAT(time, '%Y-%m-%d') >= '2012-12-12' 
 and email in (SELECT email 
               FROM `reminder` 
               WHERE DATE_FORMAT(time, '%Y-%m-%d') = '2012-12-12') 
```

My database has over 500k entries.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:23:48.190

```
SELECT count(distinct emails_stats.email) 
FROM emails_stats 
JOIN reminder ON emails_stats.email= reminder.email
WHERE 
    emails_stats.time >= CAST('2012-12-12 00:00:00' AS datetime) AND
    (reminder.time BETWEEN CAST('2012-12-12 00:00:00' AS datetime) AND CAST('2012-12-12 23:59:59' AS datetime)); 
```

如果将 date_format() 与表字段一起使用，mysql 将需要遍历表中的每一行，因为它需要获取 date_format() 函数的结果才能将值与给定的字符串进行比较。为了使其更快，请为“时间”字段创建索引并改用此查询。这样mysql就可以通过查找索引来确定它需要哪些行。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-10T22:44:01.207

请改用存在子句：

```
SELECT count(distinct email) 
FROM emails_stats 
WHERE DATE_FORMAT(time, '%Y-%m-%d') >= '2012-12-12' 
and exists (SELECT 1
                   FROM `reminder` 
                   WHERE emails_stats.email = `reminder`.email 
                   and DATE_FORMAT(time, '%Y-%m-%d') = '2012-12-12') 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-10T22:44:08.383

最好的方法是在这里使用 join 像

```
SELECT count(distinct emails_stats.email) 
FROM emails_stats 
JOIN reminder ON emails_stats.email= reminder.email
WHERE DATE_FORMAT(emails_stats.time, '%Y-%m-%d') >= '2012-12-12'; 
```

# scala - How can I serve mostly static pages from a scala Play! application like an "About" page in different languages?

> ID：14268536
> 
> 赞同：4
> 
> 时间：2013-01-10T22:36:06.397
> 
> 标签：scala, internationalization, playframework-2.0

I am building an application using the Play! framework version 2.0.4\. Some pages that are legally required such as an imprint mostly contain lots (some 10k each) of static text which I would like to provide in different languages.

In versions 1.x there was an `#include` directive that allowed to construct the actual resource path using the current `Lang`.

What is the recommended way of implementing sth similar with Play 2.x?

Thank you & best regards, Erich

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T18:02:03.100

到目前为止，我还不能 100% 确定你是如何实现它的，但这就是我想出的。

你可以只写你自己的包含助手。将以下内容保存`Helpers.scala`在您的视图文件夹中的文件中。解释在代码的注释中。

```
package views.html.helper

object include {
  import play.api.templates.Html
  import play.api.Play
  import play.api.Play.current
  import play.api.i18n._

  // The default is to look in the public dir, but you can change it if necessary
  def apply(filePath: String, rootDir: String = "public")(implicit lang: Lang): Html = {
    // Split filePath at name and suffix to insert the language in between them
    val (fileName, suffix) = filePath.splitAt(filePath.lastIndexOf("."))

    // Retrieve the file with the current language, or as a fallback, without any suffix
    val maybeFile =
      Play.getExistingFile(rootDir + "/" + fileName + "_" + lang.language + suffix).
      orElse(Play.getExistingFile(rootDir + "/" + filePath))

    // Read the file's content and wrap it in HTML or return an error message
    maybeFile map { file =>
      val content = scala.io.Source.fromFile(file).mkString
      Html(content)
    } getOrElse Html("File Not Found")
  }
} 
```

现在在你的`imprint.scala.html`你可以这样称呼它：

```
@()(implicit lang: Lang)
@import helper._
@include("static/imprint.html") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T11:27:46.090

**Schleichardt**展示的方式用于[`play-authenticate`](https://github.com/joscha/play-authenticate)选择不同语言的邮件模板，现在它已更改为与控制器上的反射一起使用，所以也许对您来说可能会很有趣。无论如何，它是为了保持标准模板的可能性（因为每封邮件都需要在发送前进行个性化）

对于静态信息页面，您可以只保存每种语言的代码，后缀为 ie。`impressum_en.html`，`impressum_de.html`在文件系统中并使用简单的控制器，它将找到具有适当后缀的文件并完全按原样返回其内容......您可能只需要返回 Ok(fileContent) 并将 Content-Type 手动设置为`text/html`.

其他选项是做类似的事情，但将其存储在数据库中，因此您可以创建简单的后端并使用浏览器对其进行编辑。

如果你还需要替​​换一些元素，你可以`###MARKER###`通过代码中的一些 + 简单的字符串操作，或者在客户端使用 JavaScript 来完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T00:30:19.267

2.0 中的模板工作方式略有不同。编译基于 Scala 的模板。从一个模板而不是“包含”另一个模板，您可以调用它。我不确定你所说的语言是什么意思。但在 2.0 中，模板的参数可以是语言。

包whateverpackage中名为“included”的示例模板。

```
@(lang: Lang)

... 
```

调用名为“包含”的模板的示例：

```
@import whateverpackage._

@included(Lang("en")) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T00:32:48.280

```
@()(implicit lang: Lang)

@main(Messages("imprint")) {
    @lang match {
        case Lang("de", _) => { @germanImprint() @* uses app/views/germanImprint.scala.html file *@}
        case _ => { @englishImprint() }
    }
} 
```

# backbone.js - Backbone when to build logic into view vs having separate view

> ID：14268537
> 
> 赞同：0
> 
> 时间：2013-01-10T22:36:07.207
> 
> 标签：backbone.js, backbone-views

So I know there are many ways for doing things in Backbone, but since I don't have the vast experience of many on here, I would like advice regarding a best approach.

I have a basic CRUD app where I have a form for adding data and a form for editing data, which are essentially the same. And actually are attached to the same DOM element.

So I could include the two forms into one view and serve the appropriate template, depending on whether the view has a model or not. Something like this:

```
var AddEditView = Backbone.View.extend ({
el: $("#add"),
template: $("editTemplate").html();
render: function() {
    if (this.model) {
        var theTmp = _.template(this.template)
        this.$el.html(theTmp(this.model.toJSON()));
    }
    else {
        var theTmp = _.template($("#addTemplate").html());
        this.$el.html(theTmp);
    }
}, 
```

}); I think this would work however I might run into some sticky issues with any events (i.e. events being bound twice).

Or I could create two completely separate views that would be attached to the same dom element and would toggle back and forth depending on the app state (way more lines of code).

What would you all recommend in this situation. Is more logic in a view better or more lines of code and less logic in views?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:45:39.550

假设无论您是创建新模型还是编辑现有模型，这些字段都是相同的，我建议只有一个视图和一个模板。当您实例化视图时，如果您正在创建一个新模型，只需实例化一个新模型并将其传递给视图。否则，通过现有模型。

```
var AddEditView = Backbone.View.extend ({
    render: function() {
        var theTmp = _.template(this.template)
        this.$el.html(theTmp(this.model.toJSON()));
    },
    someSaveEvent: function() {
        this.model.save(); // This will POST if the model isNew() or PUT otherwise
    }
});

var model = new Model(); // If you're creating a new model

var addEditView = new AddEditView({
    model: model
}); 
```

# sprite - OpenGL 3.2 Core Sprite Batch Example?

> ID：14268545
> 
> 赞同：3
> 
> 时间：2013-01-10T22:36:46.897
> 
> 标签：sprite, batch-processing, opengl-3, spritebatch

I have been tearing my hair out for a while over this. I need an OpenGL 3.2 Core (no deprecated stuff!) way to efficiently render many sprites, using batching (no instancing).

I've seen examples that do this with geometry alone, but mine also needs to send textures to it, I don't know how to do this.

I need a well done example of it working in action. And looking at how other libs like monogame and such do it isn't much help, because all I'm interested in is the GL code, and it has to have no deprecated stuff in it.

Basically I want to be able to efficiently render thousands+ of sprites, all having textures. The texture is just a spritesheet, so I just need to tell it to render a region of that spritesheet.

I'm disappointed in the amount of material available for programmable pipeline. To the point where it seems like it'd be so much easier to just say screw it and use fixed pipeline, even though I definitely don't want to do that.

So yeah, any full examples that do what I want? Or could somebody more knowledgable write one up? :)

A lot of the examples are "oh, here's how you render 1 triangle". Well that's great, except nobody needs to render only 1 triangle/quad. And they need to be textured in addition to that!

An example that uses VBOs/VAOs/EBOs

ALSO: this means the code can't use glTexPointer and that stuff, but just in raw VBOs/VAOs...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T06:47:38.853

我看到了这个问题，并决定编写一个小程序，使用点和 gl_PointSize 进行一些“精灵”渲染。我不太清楚你所说的“批处理”是什么意思，而不是“实例化”，但我的程序使用 glDrawArraysInstanced() 调用，这样我就可以渲染多个点，而不需要我的 VBO 是可变大小的。我的代码也不会对精灵进行纹理处理，但这很容易添加（使用 glUniform1i 将活动纹理索引（在调用 glTexSubImage 期间处于活动状态的索引）上传到 GLSL sampler2D）。

无论如何，这是我写的程序：http: [//litherum.blogspot.com/2013/02/sprites-in-opengl-programmable-pipeline.html](http://litherum.blogspot.com/2013/02/sprites-in-opengl-programmable-pipeline.html)希望你能从中学习！

# ios - Cache returning wrong objectForKey with NSIndexPath as key

> ID：14268552
> 
> 赞同：1
> 
> 时间：2013-01-10T22:37:00.163
> 
> 标签：ios, objective-c, uitableview, nsindexpath, nscache

In my `cellForRowAtIndexPath` method, I have this code:

```
if ([self.cellImageCache objectForKey:indexPath]) {
        UIImage *image = [self.cellImageCache objectForKey:indexPath];
        [cell.entryView setImage:image];

        return cell;
    }

Entry *entry = [self.appDelegate.fetchedResultsController objectAtIndexPath:indexPath];

UIImage *image = [JTimelineCellContent imageForEntry:entry];

[cell.entryView setImage:image];

[self.cellImageCache setObject:image forKey:indexPath]; 
```

When I scroll to the bottom of the tableview, each cell displays fine. Upon scrolling back up, cells display fine too. But when I begin scrolling down after scrolling up, cells begin to appear repeated.

Every NSLog search I do for index paths returns the correct value, even on repeated cells.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:15:45.090

NsIndexPath 实际上是一个数组而不是字符串。所以你的设计是有缺陷的。

您可以使用以下方法从 indexPath 生成唯一字符串：

```
NSString *uniqueKey = [NSString stringWithFormat:@"key%@%@",indexPath.section,indexPath.row]; 
```

所以你可以拥有：

```
NSString *uniqueKey = [NSString stringWithFormat:@"key%@%@",indexPath.section,indexPath.row];
  if ([self.cellImageCache objectForKey:uniqueKey]) {
            UIImage *image = [self.cellImageCache objectForKey:uniqueKey];
            [cell.entryView setImage:image];

            return cell;
        }

    Entry *entry = [self.appDelegate.fetchedResultsController objectAtIndexPath:indexPath];

    UIImage *image = [JTimelineCellContent imageForEntry:entry];

    [cell.entryView setImage:image];

    [self.cellImageCache setObject:image forKey:uniqueKey]; 
```

# sharepoint-2013 - Noob Visual Studio Sharepoint 2013 开发

> ID：14268561
> 
> 赞同：1
> 
> 时间：2013-01-10T22:37:19.193
> 
> 标签：sharepoint-2013

我必须在我的 DEV 盒子上安装 Server 2008 R2 或更高版本，并且至少安装 sharepoint2013 才能创建 sharepoint 项目，这是真的吗？我刚刚下载了这些工具，当我去创建一个共享点项目时，我得到一个“未安装共享点”错误。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T05:25:03.327

这些是 SharePoint2013 的要求

视窗服务器

> Windows Server 2008 R2 Service Pack 1（64 位）标准版、企业版或数据中心版 Windows Server 2012 候选发布版（64 位）标准版或数据中心版。

SQL 服务器

> SQL Server 2008 R2 Service Pack 1（64 位） SQL Server 2012（64 位）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-18T15:09:01.150

我可以在我的 Windows 7 开发机器上使用 Visual Studio 2012 创建一个共享点项目。我有一个来自 sharepoint 2010 的旧版本 Microsoft.SharePoint.dll 部署到 GAC，当我创建新项目时会自动引用它。

显然我无法运行代码，因为我没有安装 sharepoint 2013（这需要服务器版本的 windows），但它足以创建一个 sharepoint 项目并编写一些代码，我什至得到 sharepoint intellisense（尽管如果你正在开发对于 sharepoint 2013，最好使用更高版本的 Microsoft.SharePoint.dll）。

# java - 如何使用 piqi 定义通过 Java 从 C++ 读取 JSON 数据

> ID：14268562
> 
> 赞同：1
> 
> 时间：2013-01-10T22:37:22.440
> 
> 标签：java, c++, protocol-buffers, thrift, protostuff

我们使用第 3 方 REST Web 服务，它使用 piqi 模式定义了他们的 json API。我们当前的架构需要通过 java 客户端读取这些数据并将其传输到 c++ 二进制文件。理想情况下，我希望生成所有 POJO 和 c++ 结构以及数据转换（json->java、java->c++）逻辑。我一直在研究 protobuf、protostuff 和 thrift 的不同组合，但流程中仍然存在差距。有人有建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T05:09:44.950

皮奇作者在这里。第三方 API 提供商很可能会使用[piqi-rpc](http://piqi.org/doc/piqi-rpc)公开 JSON over HTTP API 。假设您拥有服务的最新`.piqi`定义，您就有机会以 Protocol Buffers 格式而不是 JSON 格式获取输出和/或发送输入数据。在 Java 和 C++ 中处理 Protobuf比处理 JSON*要容易和可靠得多。*

除非 API 提供者明确禁止使用协议缓冲区作为输入/输出格式，否则您应该能够通过将`Accept`标头（和`Content-Type`输入参数）设置`application/x-protobuf`为[此处](http://piqi.org/doc/piqi-rpc/#codecontenttypecodeandcodeacceptcodeheaders)所述来使用此格式。我会尝试一下，看看它是否有效。如果没有，您可以要求提供商将其打开。

# opengl - 光线采摘混乱

> ID：14268564
> 
> 赞同：0
> 
> 时间：2013-01-10T22:37:29.237
> 
> 标签：opengl, ray-picking

我正在使用光线拾取来找到角色的边界。这不是最佳的，但这是我能做的最好的，而且必须做的；我需要（接近）像素完美的碰撞，而且我有很多很多的物体。

但是，我没有让光线拾取正常工作。它发生了碰撞，但不是在正确的地方。我尝试调整射线的大小，但无济于事。

请原谅我的乱码，我只是把它放在一起。

```
private void renderCollision(Vector3f dir){
    //
    // Render the models
    //

    glPushMatrix();
    glPushAttrib(GL_ALL_ATTRIB_BITS);

    float size = 10.0f;
    Picker.startPicking2D(10, 10, 20, 20, -1.0f, size);
    //Picker.startPicking2D(10, 10, 20, 20, 0.1f, 20.0f);

    glClear (GL_COLOR_BUFFER_BIT);
    glDisable(GL_BLEND);
    glDisable(GL_ALPHA);
    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LESS);
    glDepthMask(true);
    glClearColor(0.0f, 0.0f, 0.0f, 1.0f);
    glClearDepth(100.0f);
    glClear (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glDisable(GL_TEXTURE_2D);

    glLoadIdentity (); 

    //box.drawMoving(camera);
    player.move(dir);
    glTranslatef(-player.position.x, -player.position.y + size / 2.0f, -player.position.z);
    glRotatef(90.0f, 0.0f, 1.0f, 0.0f);

    box.drawAll();

    glDisable(GL_DEPTH_TEST);

    boolean hit = Picker.getHit();
    if (hit) {
        player.move(new Vector3f(-dir.x, -dir.y, -dir.z));
    }

    Picker.stopPicking();

    glPopAttrib();
    glPopMatrix();
}

public class Picker {

    private static IntBuffer selBuffer;
    private static int hits;

    private static int xSelected;
    private static int ySelected;

    /**
     * Makes the game available for picking (when in 3D mode)
     *
     * @param xMouse The x coordinate of the mouse on the screen
     * @param yMouse The y coordinate of the mouse on the screen
     */
    public static void startPicking3D(int xMouse, int yMouse, int screenWidth, int screenHeight, float near, float far) {
        startPickingGeneric(xMouse, yMouse);

        GLU.gluPerspective(SCREEN_FOV, SCREEN_RAT,
                           near, far);

        GL11.glMatrixMode(GL11.GL_MODELVIEW);
        GL11.glLoadIdentity();
    }

    /**
     * Makes the game available for picking (when in 2D mode)
     *
     * @param xMouse The x coordinate of the mouse on the screen
     * @param yMouse The y coordinate of the mouse on the screen
     */
    public static void startPicking2D(int xMouse, int yMouse, int screenWidth, int screenHeight, float near, float far) {
        startPickingGeneric(xMouse, yMouse);

        GL11.glOrtho(0, screenWidth, 0, screenHeight, near, far);

        GL11.glMatrixMode(GL11.GL_MODELVIEW);
        GL11.glLoadIdentity();
    }

    /**
     * Makes the game available for picking (generic)
     *
     * @param xMouse The x coordinate of the mouse on the screen
     * @param yMouse The y coordinate of the mouse on the screen
     */
    private static void startPickingGeneric(int xMouse, int yMouse){
        // The selection buffer
        selBuffer = ByteBuffer.allocateDirect(1024).order(ByteOrder.nativeOrder()).
                    asIntBuffer();
        IntBuffer vpBuffer = ByteBuffer.allocateDirect(64).
                             order(ByteOrder.nativeOrder()).asIntBuffer();
        // Size of the viewport. [0] Is <x>, [1] Is <y>, [2] Is <width>, [3] Is <height>
        int[] viewport = new int[4];

        // Get the viewport info
        GL11.glGetInteger(GL11.GL_VIEWPORT, vpBuffer);
        vpBuffer.get(viewport);

        // Set the buffer that OpenGL uses for selection to our buffer
        GL11.glSelectBuffer(selBuffer);

        // Change to selection mode
        GL11.glRenderMode(GL11.GL_SELECT);

        // Initialize the name stack (used for identifying which object was selected)
        GL11.glInitNames();

        GL11.glMatrixMode(GL11.GL_PROJECTION);
        GL11.glPushMatrix();
        GL11.glLoadIdentity();

        // Create 5x5 pixel picking region near cursor location
        GLU.gluPickMatrix((float) xMouse, (float) yMouse,
                          5.0f, 5.0f, IntBuffer.wrap(viewport));
    }

    /**
     * Stops the picking mode
     */
    public static void stopPicking(){
        GL11.glMatrixMode(GL11.GL_PROJECTION);
    GL11.glPopMatrix();
        GL11.glMatrixMode(GL11.GL_MODELVIEW);

        hits = 0;
        hits = GL11.glRenderMode(GL11.GL_RENDER);
    }

    /**
     * Gets the tile the mouse points to
     *
     * @return TileCoords object with the coordinates of the selected tile
     */
    public static boolean getHit(){

        int[] buffer = new int[256];
        xSelected = -1000;
        ySelected = -1000;

        selBuffer.get(buffer);

        if (hits > 0) {
              // If there were more than 0 hits
              xSelected = buffer[3]; // Make our selection the first object
              ySelected = buffer[4];
              int depth = buffer[1]; // Store how far away it is
              for (int i = 1; i < hits; i++) {
                    // Loop through all the detected hits
                    // If this object is closer to us than the one we have selected
                    if (buffer[i * 4 + 1] < (int) depth) {
                        xSelected = buffer[i * 4 + 3]; // Select the closest object
                        ySelected = buffer[i * 4 + 4];
                        depth = buffer[i * 4 + 1]; // Store how far away it is
                     }
              }
              return true;
        }
        return false;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T11:42:10.947

我应该绕 x 轴而不是 y 轴旋转，然后平移。

# sql - 更新一行并保留原始数据

> ID：14268566
> 
> 赞同：0
> 
> 时间：2013-01-10T22:37:33.653
> 
> 标签：sql, oracle11g

我正在尝试更新数据库中的列。客户希望在行中添加 XR+ 原始信息。所以一个例子是

```
Sumary Doctype
Med    10 
```

他们希望文档类型为 10 的所有内容都包含摘要 + XR。

所以他们想要

```
Sumary    Doctype
XR Med    10 
```

这是针对 oracle 11g 的。我认为这是一个更新，但有没有一种简单的方法可以随心所欲地做这一切，而不是

```
update document 
set summary = XR med
where summary in ( list all instances) and doctype = 10? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:40:28.947

尝试这个：

```
update document 
set summary = 'XR ' || summary 
where doctype = 10 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:41:44.693

这应该适用于您的情况

`update document set summary = 'XR ' + summary where summary in ( list all instances) and doctype = 10`

# nhibernate - 构建 FluentNH 配置的奇怪错误

> ID：14268568
> 
> 赞同：3
> 
> 时间：2013-01-10T22:37:58.843
> 
> 标签：nhibernate, fluent-nhibernate

我正在处理一个 Fluent NHibernate 项目，并且在进行一些测试时遇到了一个非常奇怪的错误：

`The entity '<>c__DisplayClass3' doesn't have an Id mapped. Use the Id method to map your identity property. For example: Id(x => x.Id).`

报告的相关实体是：

`{Name = "<>c__DisplayClass3" FullName = "TPLLCPortal.Domain.Account+<>c__DisplayClass3"}`

我没有任何名为 的类`DisplayClass`，但我确实有一个`Account`实体。我正在使用如下所示的主键约定：

```
public class PrimaryKeyConvention : IIdConvention
{
    public void Apply(IIdentityInstance instance)
    {
        instance.GeneratedBy.GuidComb();
    }
} 
```

我的`Account`类继承自一个`EntityBase`将 ID 声明为的类：

```
/// <summary>
/// Gets or sets the id.
/// </summary>
/// <value>The id.</value>
public virtual Guid Id { get; protected internal set; } 
```

我确信我正在正确设置配置并且正在采用约定，但以防万一我添加了覆盖并专门映射了`Account`该类的 ID。没有骰子。

有什么想法吗？

我正在使用 FNH 1.3.0.733 和 NHibernate 3.3.1.4000（都从 NuGet 加载）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T01:31:36.830

看来我想通了。[这个 SO 答案](https://stackoverflow.com/a/11447966/240439)有关键。因为类上的某些方法使用 lambda，所以编译器会创建可以在 中排除的类，方法`DefaultAutomappingConfiguration`是指定`!type.IsDefined(typeof(CompilerGeneratedAttribute), false)`为`ShouldMap`覆盖的一部分。

# python - 从混洗列表中提取元素（基于用户的输入）

> ID：14268576
> 
> 赞同：-2
> 
> 时间：2013-01-10T22:38:35.193
> 
> 标签：python, random

我有这样的事情：

```
s=[7777,5454,75000,4545,787,16000,1000,9888,7854,12223]
random.shuffle(s)
ans=input('Press a number from 0 to 9') 
```

我想将输入数字 ans 与 s[ans] 元素相关联。我可以用 10 个 if 循环来做到这一点，这是唯一的机会吗？//解决了这个

完成后，我想重复随机提取，直到用户数字类似于“停止”（我在这里），然后将所有提取的值相加，直到“停止”字符串。我该怎么做最后一点？

谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:42:05.470

```
from random import choice
elem = choice (some_list) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:42:44.150

如果您只是尝试选择一个随机数（并且要求输入只是实现该目标的一种手段），那么您真的应该研究[`random.choice`](http://docs.python.org/2/library/random.html#random.choice). 它完全符合您的需要，您不必花时间洗牌

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T23:46:06.633

您已编辑问题以声明原始版本“已解决”，然后添加了第二个。以后不要那样做；接受为您解决问题的答案，然后创建一个新问题。（而且您仍然应该接受解决原始问题的答案！）但是仅这一次，这是第二个答案：

> 完成后，我想重复随机提取，直到用户数字类似于“停止”（我在这里），然后将所有提取的值相加，直到“停止”字符串。我该怎么做最后一点？

我假设您使用的是 Python 2，并使用该`input`函数，因此用户只需键入即可`2`获得 number`2`而不是 string `"2"`。（如果您使用的是 Python 3，则其`input`工作方式与 Python 2 类似`raw_input`，因此请参阅第二个版本。）

所以：

```
s=[7777,5454,75000,4545,787,16000,1000,9888,7854,12223]
random.shuffle(s)
values = []
while True:
    ans=input('Press a number from 0 to 9')
    if ans == 'stop':
        break
    values.append(s[ans])
print sum(values) 
```

请注意，用户必须以`"stop"`这种方式输入引号。如果用户改为键入`stop`（或`10`，就此而言），程序将退出并出现异常。改为使用会更好`raw_input`，并执行以下操作：

```
s=[7777,5454,75000,4545,787,16000,1000,9888,7854,12223]
random.shuffle(s)
values = []
while True:
    ans=raw_input('Press a number from 0 to 9, or stop when done')
    if ans == 'stop':
        break
    try:
        index = int(ans)
        values.append(s[ans])
    except ValueError:
        print '{} is not a number or the word stop'.format(ans)
    except IndexError:
        print '{} is not between 0 and 9.'.format(ans)
print sum(values) 
```

您可能会认识到这种`values = []`, `while`,`values.append`模式正是列表推导和迭代器的用途。而且您可以轻松地将所有用户输入分解到一个生成器函数中，该函数只是`yield`s each `s[ans]`，然后只是`print sum(userChoices())`，而根本不需要建立一个列表。但我会把它留给读者作为练习。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T22:42:08.523

您可以像这样直接访问数组的值：

```
s[ans] 
```

但首先您可能必须将 ans 转换为整数（并处理用户发送非数字内容的情况！）

```
try:
    i = int(s)
except ValueError:
    i = 0 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-11T04:00:46.950

```
ans = 0
s = [7777,5454,75000,4545,787,16000,1000,9888,7854,12223]
ans_sums = []
while ans != 'stop': # while the input is not 'stop'
    random.shuffle(s)
    ans = raw_input('Press a number from 0 to 9: ') # this returns the input as a string
    if ans == 'stop':
        break
    else:
        ans_sums.append(int(s[ans])) # adds s[ans] to ans_sums.
        # it must be converted to an integer first because raw_input returns it as a string
return sum(s[ans]) 
```

或者，您可以执行以下操作：

```
ans = 0
s = [7777,5454,75000,4545,787,16000,1000,9888,7854,12223]
ans_sums = 0
while ans != 'stop': # while the input is not 'stop'
    random.shuffle(s)
    ans = input('Press a number from 0 to 9: ')
    if ans == 'stop':
        break
    else:
        ans_sums += s[ans] # adds s[ans] to ans_sums
return ans_sums 
```

这避免了创建列表并完成相同的工作：找到所有输入的总和。

# ios - 实体（空）不符合键“标题”的键值编码

> ID：14268580
> 
> 赞同：6
> 
> 时间：2013-01-10T22:39:14.747
> 
> 标签：ios, objective-c, core-data, restkit, mogenerator

我试图让 RestKit 和 CoreData 一起工作。我越来越近了，但我收到以下错误：

```
CoreData: error: Failed to call designated initializer on NSManagedObject class 'Book' 
*** Terminating app due to uncaught exception 'NSUnknownKeyException', reason: 
    '[<Book 0x8454560> valueForUndefinedKey:]: the entity (null) is not key value coding-compliant for the key "title".' 
```

在我看来，它成功地找到了我的 Book 类，并且它确实具有 title 属性。我究竟做错了什么？

* * *

书籍.xcdatamodel

```
Book
  title: String 
```

`localhost:3000/books/initial`我有一个返回以下（JSON）的网址

```
[{title:"one"}, {title:"two"}] 
```

我正在使用 mogenerator 创建我的课程。我没有添加任何东西`Book`，但`_Book`显然已经定义了 title 属性。

最后，这是我用来加载请求的代码。

```
RKObjectManager* objectManager = [RKObjectManager managerWithBaseURL:[NSURL URLWithString:@"http://localhost:3000/"]];
RKManagedObjectStore* objectStore = [[RKManagedObjectStore alloc] initWithManagedObjectModel:self.model];
objectManager.managedObjectStore = objectStore;

// Mappings
RKEntityMapping *bookMapping = [RKEntityMapping mappingForEntityForName:@"Book" inManagedObjectStore:objectStore];
[bookMapping addAttributeMappingsFromArray:@[@"title"]];

RKResponseDescriptor * responseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:bookMapping pathPattern:@"books/initial/" keyPath:nil statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

[objectManager addResponseDescriptor:responseDescriptor];

// Send Request
[objectManager getObjectsAtPath:@"/books/initial/" parameters:nil success:^(RKObjectRequestOperation * operation, RKMappingResult *mappingResult) {
    NSLog(@"SUCCESS");
} failure: ^(RKObjectRequestOperation * operation, NSError * error) {
    NSLog(@"FAILURE %@", error);
}]; 
```

* * *

**编辑：**`//Send Request`我在应用程序中找到的部件之前添加了以下几行`RKTwitterCoreData`，但我仍然得到同样的错误

```
// Other Initialization (move this to app delegate)
[objectStore createPersistentStoreCoordinator];
[objectStore createManagedObjectContexts];

objectStore.managedObjectCache = [[RKInMemoryManagedObjectCache alloc] initWithManagedObjectContext:objectStore.persistentStoreManagedObjectContext]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T18:22:17.210

问题是映射中的路径不正确。我有`http://localhost:3000/`作为我的域，它应该在哪里`http://localhost:3000`，我有`books/initial/`作为它应该在的路径`/books/initial/`。

请参阅[RestKit 0.20 — CoreData：错误：无法在 NSManagedObject 类上调用指定的初始化程序](https://stackoverflow.com/questions/13734221/restkit-0-20-coredata-error-failed-to-call-designated-initializer-on-nsmanag)

我也忘了创建持久存储。这是完整的工作示例：

```
// Core Data Example
// Initialize RestKIT
RKObjectManager* objectManager = [RKObjectManager managerWithBaseURL:[NSURL URLWithString:@"http://localhost:3000"]];
RKManagedObjectStore* objectStore = [[RKManagedObjectStore alloc] initWithManagedObjectModel:self.model];
objectManager.managedObjectStore = objectStore;

// Mappings
RKEntityMapping *bookMapping = [RKEntityMapping mappingForEntityForName:@"Book" inManagedObjectStore:objectStore];
[bookMapping addAttributeMappingsFromArray:@[@"title"]];

RKResponseDescriptor * responseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:bookMapping pathPattern:@"/books/initial/" keyPath:nil statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

[objectManager addResponseDescriptor:responseDescriptor];

// Other Initialization (move this to app delegate)
[objectStore createPersistentStoreCoordinator];

NSString *storePath = [RKApplicationDataDirectory() stringByAppendingPathComponent:@"RKTwitter.sqlite"];
NSString *seedPath = [[NSBundle mainBundle] pathForResource:@"RKSeedDatabase" ofType:@"sqlite"];
NSError *error;
NSPersistentStore *persistentStore = [objectStore addSQLitePersistentStoreAtPath:storePath fromSeedDatabaseAtPath:seedPath withConfiguration:nil options:nil error:&error];
NSAssert(persistentStore, @"Failed to add persistent store with error: %@", error);

[objectStore createManagedObjectContexts];

objectStore.managedObjectCache = [[RKInMemoryManagedObjectCache alloc] initWithManagedObjectContext:objectStore.persistentStoreManagedObjectContext];

// Send Request
[objectManager getObjectsAtPath:@"/books/initial/" parameters:nil success:^(RKObjectRequestOperation * operation, RKMappingResult *mappingResult) {
    NSLog(@"SUCCESS");
} failure: ^(RKObjectRequestOperation * operation, NSError * error) {
    NSLog(@"FAILURE %@", error);
}]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T01:53:51.910

我看不到您在哪里添加了持久存储。你忘了这样做吗？

# javascript - Ext.js：Vbox布局如何在第二项隐藏时使第一项占据所有空间？

> ID：14268581
> 
> 赞同：0
> 
> 时间：2013-01-10T22:39:14.413
> 
> 标签：javascript, extjs

我有一个带有 vbox 布局的面板，里面有两个面板，一个在顶部，一个在底部。通过一些操作，我通过调用其 hide() 方法来隐藏底部面板。我现在怎样才能让顶部面板占据所有空间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:43:59.290

这是一个示例：

```
Ext.require('*');

Ext.onReady(function(){

    var p1 = new Ext.panel.Panel({
        flex: 1,
        title: 'Top panel'
    });

    var p2 = new Ext.panel.Panel({
        title: 'Bottom panel',
        flex: 1
    });

    new Ext.container.Viewport({
        layout: {
            type: 'vbox',
            align: 'stretch'
        },
        items: [p1, p2]
    });

    var visible = true;
    setInterval(function(){
        if (visible) {
            p2.hide();
        } else {
            p2.show();
        }
        visible = !visible;
    }, 1000);

}); 
```

# javascript - javascript在文本框中输入文本

> ID：14268583
> 
> 赞同：1
> 
> 时间：2013-01-10T22:39:28.167
> 
> 标签：javascript, html

我对 javascript 很陌生，所以如果这看起来很简单，请原谅我。我想要做的是让输入框的值为'hello'，当单击 submit_a 时，但它没有发生。

```
<script type="text/javascript">

var Text = 'hello'.
  function setInput(button) {
     var buttonVal = button.value,
     textbox = document.getElementById('input_' + buttonVal);
     textbox.value = Text ;
}
</script>

<html>
 <input type="submit" name="submit_a" value="click-me" onclick="setInput(this); return 
  false;"> 
 <input type="text" name="a" id="input_a">
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:52:35.187

为了完成这项工作，将 JavaScript 更改为：

```
var Text = 'hello';

function setInput(button) {
   var buttonVal = button.name,
   textbox = document.getElementById('input_' + buttonVal);
   textbox.value = Text ;
} 
```

...和HTML：

```
<input type="submit" name="a" value="click-me" onclick="setInput(this); return false;"> 
<input type="text" id="input_a"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:43:27.007

评论提到“你好”之后的点是错误的和按钮值。

您还在下划线字符后省略了“a”。

不需要的“button.value”后面有一个逗号。

```
var Text = 'hello';
  function setInput(button) {
     textbox = document.getElementById('input_a');
     textbox.value = Text ;
} 
```

# inheritance - 让 Ext JS 关联、继承和存储工作

> ID：14268585
> 
> 赞同：1
> 
> 时间：2013-01-10T22:39:43.207
> 
> 标签：inheritance, extjs, model, associations, store

这是一个简单的用例，用于存储具有继承性的一对多（甚至一对一）。Ext JS 如何用它的 JSON 阅读器处理这个问题？

以下代码提供了一些伪模型和数据来说明用例：

伪代码示例：

```
Models:

Car {
  model,
  year,
  color
}

Truck extends Car {
  bedLength,
  duality
}

Van extends Car {
  leftSlideDoor,
  rightSlideDoor,
  tailGate
}

CarOwner {
  name,
  cars <Car>
}

Data:

carOwners:

[
{
  name: "Sencha",
  cars: [
   {
    color: "Brown",
    model: "Mater"
    type: "truck",
    duality: "false",
    bedLength: "10"
    },
    {
    color: "red",
    model: "sienna",
    type: "van",
    tailGate: "true",
    leftSlideDoor: "true",
    rightSlideDoor: "true"
    }
  ]
}
] 
```

加载数据时，会实例化并加载“正确”类型的 Cars。如何在 Ext JS 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T08:03:05.287

从 OO 的角度来看，您所描述的内容是行不通的。您的车主拥有一系列“汽车”，但您尝试在数据中使用的类型不是汽车，而是汽车的扩展。在 c# 中，您`carOwner`可能包含`List<ICar>`并且虽然这将使您能够存储卡车和货车，但您只能使用 ICar 接口的属性（因为这些是唯一的共享属性）。

我建议在该示例中，如果属性是可变的，您可以像这样设置自己的汽车：

```
CarOwner {
  name,
  cars <Car>
  vans <Van>
  trucks <Trucks>
} 
```

或者您可以将您的数据描述为“车辆”，并使该对象足够通用以包含所有可能的属性。

作为旁注，如果您纯粹是在 Ext 中的“关联”示例之后，并且汽车/货车/卡车的事情是假设的，请回复此内容，我会放弃一个。

# .net - 使用带有 Windows 身份验证的 Sharepoint 2010 中托管的自定义 REST 服务

> ID：14268586
> 
> 赞同：0
> 
> 时间：2013-01-10T22:39:49.097
> 
> 标签：.net, sharepoint-2010, httpwebrequest, windows-authentication, wcf-rest

在使用 Windows 身份验证的 Sharepoint 2010 应用程序中托管了此自定义 WCF REST 服务。

我需要在 .NET 项目（即控制台项目）中使用此服务，但凭证让我发疯。我收到很多回复（取决于我是否包含一些身份验证）`400 - bad request`。`401 - unauthorized`

让我给你举个例子：

`siteUri`是 SP 站点（根/主页）`methodUri`的 url，是返回 XML 的服务方法的 url。

同样，该站点已通过 Windows 身份验证。如果我打开浏览器并转到`methodUri`我得到：

> 请求错误
> 
> 服务器在处理请求时遇到错误。有关更多详细信息，请参阅服务器日志。

但是，如果然后我去`siteUri`，Sharepoint 主页加载，然后我可以`methodUri`再次浏览，现在我得到正确的 XML 响应。

因此，似乎浏览到主页会存储一些 cookie，然后在向 web 方法发出请求时使用这些 cookie。检查 Fiddler 中的请求，我可以确认这一点：

第一个`methodUri`请求因代码而失败，`400`并且请求标头中没有任何 Cookie。然后，当我浏览主页 ( `siteUri`) 时，有一些请求/响应似乎是身份验证本身。响应头包括：

```
WWW-Authenticate: Negotiate oRswGaADCgEAoxIEEAEAAABDh+CIwTbjqQAAAAA=
Set-Cookie: WSS_KeepSessionAuthenticated={b89d78b2-063d-4ac4-810e-bde4e04a829e}; path=/
Persistent-Auth: true 
```

最后，当`methodUri`再次浏览时，第一个响应是 401 - 未经授权，但之后有另一个请求包括此标头

```
Cookie: WSS_KeepSessionAuthenticated={b89d78b2-063d-4ac4-810e-bde4e04a829e}
Authorization: Negotiate oXcwdaADCgEBoloEWE5UTE1TU1AAAwAAAAAAAABYAAAAAAAAAFgAAAAAAAAAWAAAAAAAAABYAAAAAAAAAFgAAAAAAAAAWAAAABXCiOIGAbEdAAAAD37/i76Dl3jNyK8bIRz57fmjEgQQAQAAAPUXp1AtIpqEAAAAAA== 
```

最终被接受并且服务使用相应的 XML 进行响应。

所以浏览器足够聪明，可以处理这个来回的请求/响应来验证当前的 windows 用户。

我的问题是，如何在 .NET（3.5 或 4）中执行此操作，但不使用默认凭据，我需要指定用户名、密码和域。

我已经花了 5 天的时间来处理这个问题，我可以使用 HttpWebRequest 中的默认网络凭据使其工作，但是当我手动设置凭据时（使用与当前登录用户相同的凭据）它不起作用。

我只是觉得这整个事情过于复杂了（谢谢微软），因为我来自开源（ruby、python）背景，而且这种事情很简单。

希望我很清楚，如果您需要任何额外的信息，请询问。我愿意为此付出我的全部名誉。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T20:11:58.657

嗯，我已经修好了。

这是我最终使用的代码。感谢微软让事情变得如此简单和解释清楚。

```
var siteUri = @"http://sharepoint-site-uri";
var methodUri = @"http://sharepoint-site-uri/namespace/service/method";
string responseXml = null;

var request = (HttpWebRequest)WebRequest.Create(siteUri);
var cc = new CredentialCache { { new Uri(siteUri), "NTLM", new NetworkCredential("user", "pwd", "domain") } };
request.Credentials = cc;

try
{
    // first site request
    var response = (HttpWebResponse)request.GetResponse();
    if (response.StatusCode == HttpStatusCode.OK)
    {
        request = (HttpWebRequest)WebRequest.Create(uri);
        request.CookieContainer = new CookieContainer();

        // copy the authentication cookies from the response
        foreach (Cookie c in response.Cookies)
        {
            request.CookieContainer.Add(c);
        }

        request.ContentType = "application/xml; charset=utf-8";

        // second request, now against the service url
        using (var reader = new StreamReader(request.GetResponse().GetResponseStream()))
        {
            // get the response text
            responseXml = reader.ReadToEnd();
        }
    }
}
catch (Exception e)
{       
   // handle error
} 
```

# ios - 应用关闭后 UILocalNotification 为零

> ID：14268589
> 
> 赞同：6
> 
> 时间：2013-01-10T22:40:01.887
> 
> 标签：ios, objective-c, notifications, uilocalnotification

我正在使用 UILocalNotifications。我遇到的一个问题是，在我在 XCode 中重新启动我的应用程序后，与通知关联的数据似乎被删除了。这是我正在遵循的步骤。

- 在 XCode 中启动应用程序

- 收到通知

- 在 XCode 中停止应用程序

- 在 XCode 中启动应用程序

- 转到通知中心并点击我的应用程序的通知之一

-打破`application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification`

在这一点上，如果我检查`notification`我发现它是`nil`.

任何想法出了什么问题？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:40:21.660

如果在通知中心点击本地通知，则使用该`application:didFinishLaunchingWithOptions:`方法启动应用程序，您可以使用 key 从字典中访问`UILocalNotification`对象。`options``UIApplicationLaunchOptionsLocalNotificationKey`

`application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification`仅当通知触发并且应用程序位于前台时才调用。

# sql - 与 ActiveRecord 联合的替代方案

> ID：14268591
> 
> 赞同：0
> 
> 时间：2013-01-10T22:40:05.443
> 
> 标签：sql, activerecord

我想我想在 Rails 中做一个联合，但是根据这个 post [rails union hack，如何将两个不同的查询拉在一起](https://stackoverflow.com/questions/1584589/rails-union-hack-how-to-pull-two-different-queries-together)，Rails 本身并不支持联合。我想知道是否有更好的方法来解决这个问题。

我有项目表，每个项目都有很多价格，但我只想为每个项目加入一个价格。

为了确定商品的正确价格，我在价格模型中有两个额外的外键：category_id 和 discount_id。每个人都可以独立宣布一件物品的价格。

前任。项目 + 类别 = 价格 1 和项目 + 折扣 = 价格 2

如果 discount_id 与传递的 id 匹配，我想排除仅匹配项目 + 类别的该项目的价格结果。我也尽量不放松延迟加载。

希望问题很清楚！如果不是，我会尝试澄清更多，在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T04:49:53.473

您的模型将开始看起来像这样：

```
class Price < ActiveRecord::Base
  belongs_to :item
  belongs_to :category
  belongs_to :discount

  scope :category, where("prices.category_id IS NOT NULL")
  scope :discount, where("prices.discount_id IS NOT NULL")
end

class Item < ActiveRecord::Base
  has_many :prices
end

class Category < ActiveRecord::Base
  has_many :prices
end

class Discount < ActiveRecord::Base
  has_many :prices
end 
```

一种方法是添加一个`Price`封装此逻辑的类方法：

```
class Price < ActiveRecord::Base
  def self.used
    discount_items_sql = self.discount.select("prices.item_id").to_sql
    where("prices.discount_id IS NOT NULL OR prices.item_id NOT IN (#{discount_items_sql})")
  end
end 
```

这实际上与此查询相同：

```
SELECT * FROM prices
WHERE prices.discount_id IS NOT NULL -- the discount_id is present on this record,
  OR prices.item_id NOT IN (         -- or no discount_id is present for this item
      SELECT item_id FROM prices WHERE discount_id IS NOT NULL) 
```

为简单起见，您可以在`Item`模型上添加这些辅助方法：

```
class Item < ActiveRecord::Base
  def category_price
    prices.category.first
  end

  def discount_price
    prices.discount.first
  end

  def used_price
    prices.used.first
  end
end 
```

现在您可以轻松获取单个商品的每个“类型”价格（将`nil`针对不可用的价格）：

```
item.category_price
item.discount_price
item.used_price 
```

# postgresql - 取消组合 postgres 中的列

> ID：14268594
> 
> 赞同：0
> 
> 时间：2013-01-10T22:40:15.287
> 
> 标签：postgresql, loops, group-by

我有一个表，由 cron 构建。假设它有两列，Hours 和 Jobname。例如：作业 1 运行小时 {1,2,3,4}，作业 2 运行小时 {3,4,5,6}。

我需要一个查询，它取消对列小时的分组并列出每小时的工作。

预期输出：

```
工作时间 工作名称
1 工作 1
2 工作 1
3 工作 1、工作 2
4 工作 1、工作 2
5 工作 2
6 工作 2

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:04:57.993

假设您的作业列是*逗号分隔的数据类型`text`（或类似）*列表- 分隔`', '`- 我将其转换为数组，[`string_to_array()`](http://www.postgresql.org/docs/current/interactive/functions-array.html#ARRAY-FUNCTIONS-TABLE)然后将其转换[`unnest()`](http://www.postgresql.org/docs/current/interactive/functions-array.html#ARRAY-FUNCTIONS-TABLE)为单独的行：

```
SELECT hour, unnest(string_to_array(jobs, ', ')) AS job
FROM   tbl
ORDER  BY 1; 
```

您也可以使用[`regexp_split_to_table(jobs, ', ')`](https://www.postgresql.org/docs/current/static/functions-string.html)，它更简单，但对于较长的字符串不能很好地扩展。

相关问题：

*   [从字符串创建表](https://stackoverflow.com/questions/11755075/create-table-from-string)
*   [计算包含字母/数字的行数](https://stackoverflow.com/questions/10538051/count-the-number-of-rows-that-contain-a-letter-number)

在 Postgres **9.3**或更高版本中，请改用`LATERAL`连接。假设查询很*简单*并且定义了作业`NOT NULL`，这可以正常工作并且通常根据元素的原始顺序返回作业：

```
SELECT hour, job
FROM   tbl, unnest(string_to_array(jobs, ', ')) job  -- implicitly LATERAL
ORDER  BY 1; 
```

[**SQL小提琴。**](http://sqlfiddle.com/#!15/7ca8b/1)

对于更复杂的查询或 if`jobs`可以`NULL`：

```
SELECT hour, job
FROM   tbl
LEFT   JOIN LATERAL unnest(string_to_array(jobs, ', '))
       WITH ORDINALITY AS j(job, ord) ON TRUE
ORDER  BY hour, ord; 
```

`WITH ORDINALITY`需要 Postgres **9.4**只需要*保证*数组元素的原始顺序。细节：

*   [LATERAL 和 PostgreSQL 中的子查询有什么区别？](https://stackoverflow.com/questions/28550679/what-is-the-difference-between-lateral-and-a-subquery-in-postgresql/28557803#28557803)
*   [带有元素编号的 PostgreSQL unnest()](https://stackoverflow.com/questions/8760419/postgresql-unnest-with-element-number/8767450#8767450)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T00:19:50.650

如果您有工作表，则可以将其作为连接处理：

```
select cront.hour, j.name
from cront join
     jobs j
     on ', '||jobs||', ' like '%, '||j.name||', ' 
```

# clearcase - cleartool：如何将命令 find 的结果写入文本文件

> ID：14268596
> 
> 赞同：4
> 
> 时间：2013-01-10T22:40:21.273
> 
> 标签：clearcase, cleartool

我试图在我的视图中找到 gt.BridgeGov 分支下的所有文件

```
 find \gtGov -all -version "brtype(gt.BridgeGov)" -print 
```

该语句工作正常，并列出了分支 gt.BridgeGov 下的所有文件。我在控制台上获取列表，但我想将结果重定向到文本文件。

我尝试了以下

```
find \gtGov -all -version "brtype(gt.BridgeGov)" > myFile.txt
find \gtGov -all -version "brtype(gt.BridgeGov)" >> myFile.txt 
```

它给我一个错误 cleartool：错误：额外参数：>“

如何将结果重定向到文本文件？

-更新：

```
find \gtGov -all -version "brtype(gt.BridgeGov)" -print > myFile.txt 
```

试过这个也完全错误当我尝试

```
find \gtGov -all -version "brtype(gt.BridgeGov)" | tee myFile.txt 

cleartool: Error: Extra arguments: "|"
Usage: find { pname ... [-depth | -nrecurse | -directory]
        | [pname ...] -all [-visible | -nvisible]
        | -avobs [-visible | -nvisible]
        }
        [-name 'pattern']
        [-cview]
        [-user login-name]
        [-group group-name]
        [-type {f|d|l}...]
        [-follow]
        [-kind object-kind]
        [-nxname]
        [-element query]
        [-branch query]
        [-version query]
        {-print | -exec command-invocation | -ok command-invocation} ... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T04:21:26.310

您处于 cleartool 会话中。

不。

在 ClearCase 视图中转到 dos 或 shell 会话，然后键入

```
cleartool find ... > res.txt 
```

以这种方式重定向 cleartool 命令的结果不会有任何问题。

*请注意，如果您在动态*视图根目录（`M:\myDynView`，或`/view/myView`，...）中执行 cleartool find 命令，您将（无权直接在所述根目录中写入。

但是，您可以将输出重定向到您想要的任何文件：

```
cd /view/MyView
cleartool find -all ... > /my/path/res.txt 
```

# jackson - Jackson 2.1.2 多态反序列化抛出 JsonMappingException。为什么？

> ID：14268601
> 
> 赞同：2
> 
> 时间：2013-01-10T22:40:53.417
> 
> 标签：jackson

Jackson 的多态序列化/反序列化功能真的很酷，或者如果我能弄清楚如何将它应用到我手头的问题上。[http://programmerbruce.blogspot.com/2011/05/deserialize-json-with-jackson-into.html](http://programmerbruce.blogspot.com/2011/05/deserialize-json-with-jackson-into.html)上有一篇很好的文章，我无法适应我的简化问题。

简而言之，我能够让 Jackson 2.1.2 将类层次结构序列化为带有类型信息的 JSON 字符串。但是，我无法让 Jackson 2.1.2 将该 JSON 字符串反序列化回我的类层次结构中。下面是一个暴露这个问题的单元测试。

类层次结构很简单；只有两个直接子类的基类。此外，JSON 输出似乎尊重我的 Jackson @JsonTypeInfo 并从 mapper.writeValueAsString 生成一个可信的字符串

```
{"type":"dog","name":"King","breed":"Collie"} 
```

但是我对 mapper.readValue(jsonOfKing, Animal.class) 堆栈跟踪的调用...

```
FAILED: testJacksonSerializeDeserialize
com.fasterxml.jackson.databind.JsonMappingException: No suitable constructor found for type [simple type, class org.rekdev.fasterjacksonwtf.PolymorphismTests$Dog]: can not instantiate from JSON object (need to add/enable type information?)
at [Source: java.io.StringReader@32b3a5a0; line: 1, column: 14]
    at com.fasterxml.jackson.databind.JsonMappingException.from(JsonMappingException.java:164)
    at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObjectUsingNonDefault(BeanDeserializer.java:400)
    at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:289)
.... 
```

这是我的单元测试。

```
import org.testng.annotations.*;
import static org.testng.Assert.*;
import com.fasterxml.jackson.annotation.*;
import com.fasterxml.jackson.annotation.JsonSubTypes.Type;
import com.fasterxml.jackson.databind.*;

public class PolymorphismTests {
    @Test
    public void testJacksonSerializeDeserialize() throws Exception {
        ObjectMapper mapper = new ObjectMapper();

        Animal king = new Dog();
        king.name = "King";
        ( (Dog) king ).breed = "Collie";
        String jsonOfKing = mapper.writeValueAsString( king );
        // JsonMappingException right here!
        Animal actualKing = mapper.readValue( jsonOfKing, Animal.class );
        assertEquals( king, actualKing );

    }

    @JsonTypeInfo( use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "type" )
    @JsonSubTypes( { @Type( value = Cat.class, name = "cat" ), @Type( value = Dog.class, name = "dog" ) } )
    abstract class Animal {
        public String name;

        @Override
        public abstract boolean equals( Object obj );

        @Override
        public abstract int hashCode();
    }

    class Dog extends Animal {
        public String breed;

        @Override
        public boolean equals( Object obj ) {
            if ( this == obj ) {
                return true;
            }
            if ( obj == null ) {
                return false;
            }
            if ( getClass() != obj.getClass() ) {
                return false;
            }
            final Dog that = (Dog) obj;
            boolean equals = name.equals( that.name ) && breed.equals( that.breed );
            return equals;
        }

        @Override
        public int hashCode() {
            int hashCode = name.hashCode() + breed.hashCode();
            return hashCode;
        }
    }

    class Cat extends Animal {
        public String favoriteToy;

        @Override
        public boolean equals( Object obj ) {
            if ( this == obj ) {
                return true;
            }
            if ( obj == null ) {
                return false;
            }
            if ( getClass() != obj.getClass() ) {
                return false;
            }
            final Cat that = (Cat) obj;
            boolean equals = name.equals( that.name ) && favoriteToy.equals( that.favoriteToy );
            return equals;
        }

        @Override
        public int hashCode() {
            int hashCode = name.hashCode() + favoriteToy.hashCode();
            return hashCode;
        }
    }
} 
```

为什么 ObjectMapper 不允许我对由 ObjectMapper.writeValue() 生成的 JSON 进行 readValue 处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T03:53:51.853

使您的内部类静态，例如：

```
static class Dog extends Animal { ... } 
```

否则事情将无法正常工作（因为非静态内部类需要所谓的“隐式 this”参数来引用封闭类的实例）。

# c# - 通过反射引发事件

> ID：14268605
> 
> 赞同：1
> 
> 时间：2013-01-10T22:41:24.630
> 
> 标签：c#, reflection

好吧，我在这里和那里阅读了很多关于为什么通过反射引发事件不可靠的帖子..我的问题是这个..我使用 PostSharp 定义一个接口，该接口允许类在属性更改之前和之后通知..

我`NotifyAttribute`创建的需要能够引发`PropertyBeforeChange`和`PropertAfterChange`事件.. 事情是，即使我可以检索事件，它`GetRaiseMethod()`返回 null，因此我无法引发所述事件.. 我该怎么做呢？

```
using PostSharp.Aspects;

namespace Core
{
    public delegate void PropertyBeforeChangeEventHandler(object sender, string sPropertyName, object oCurrentValue, ref object oProposedValue, ref bool bCancel);
    public delegate void PropertyAfterChangeEventHandler(object sender, string sPropertyName, object oOldValue, object oNewValue);

    public interface INotify
    {
        event PropertyBeforeChangeEventHandler PropertBeforeChange;
        event PropertyAfterChangeEventHandler PropertyAfterChange;
    }

    [Serializable]
    public sealed class NotifyAttribute : LocationInterceptionAspect, IInstanceScopedAspect
    {
        bool _NotifyBefore { get; set; }
        bool _NotifyAfter { get; set; }

        public NotifyAttribute() { _NotifyAfter = true; }
        public NotifyAttribute(bool bNotifyBefore, bool bNotifyAfter) { _NotifyBefore = bNotifyBefore; _NotifyAfter = bNotifyAfter; }

        public override void OnSetValue(LocationInterceptionArgs args)
        {
            INotify oNotify = args.Instance as INotify;
            if (oNotify == null) return;

            object oCurrentValue = args.GetCurrentValue();
            object oProposedValue = args.Value;
            if (object.Equals(oCurrentValue, oProposedValue)) return;
            bool bCancel = false;

            if (_NotifyBefore)
            {
                var oObj = args.Instance.GetType().GetEvent("PropertyBeforeChange");
                // RAISE EVENT HERE
            }
            if (bCancel) return;

            args.Value = oProposedValue;
            args.ProceedSetValue();
            if (_NotifyAfter)
            {
                var oObj = args.Instance.GetType().GetEvent("PropertyAfterChange");
                // RAISE EVENT HERE
            }
        }

        public object CreateInstance(AdviceArgs adviceArgs) { return this.MemberwiseClone(); }
        public void RuntimeInitializeInstance() { }
    }
} 
```

定义了这个接口和这个属性，我可以按如下方式使用它..

```
 public class Test : INotify
    {
        public event PropertyBeforeChangeEventHandler PropertyBeforeChange;
        public event PropertyAfterChangeEventHandler PropertyAfterChange;

        [Notify]
        public string Name { get; set; }
    }

    Test oTest = new Test();
    oTest.PropertyBeforeChange += Test_PropertBeforeChange;
    oTest.PropertyAfterChange += Test_PropertyAfterChange;
    oTest.Name = "Asim";
    void Test_PropertBeforeChange(object sender, string sPropertyName, object oCurrentValue, ref object oProposedValue, ref bool bCancel)
    {
    }
    void Test_PropertyAfterChange(object sender, string sPropertyName, object oOldValue, object oNewValue)
    {
    } 
```

# comet - 异步servlet长轮询和bayeux协议（彗星）之间的区别

> ID：14268606
> 
> 赞同：8
> 
> 时间：2013-01-10T22:41:25.047
> 
> 标签：comet, server-push, servlet-3.0, reverse-ajax, bayeux

**简单的 Async servlet 和 Comet / Bayeux 协议有什么区别？**

我正在尝试实现“服务器推送”（或“反向 Ajax”）类型的网页，该网页将在服务器上发生事件时从服务器接收更新。因此，即使没有客户端显式发送请求，我也需要服务器能够向特定客户端浏览器发送响应。

我知道 Comet 是这类技术的总称；'Bayeux' 是协议。但是当我查看 servlet 规范时，即使是“异步 servlet”似乎也能完成同样的事情。我的意思是我可以定义一个简单的servlet

```
<async-supported> 
```

web.xml 中的属性设置为 true；并且该 servlet 将能够异步向客户端发送响应。然后我可以拥有一个基于 jQuery 或 ExtJS 的 ajax 客户端，它只是不断地做一个

```
long_polling() 
```

调用servlet。类似于以下链接中描述的内容 [http://www.ibm.com/developerworks/web/library/wa-reverseajax1/index.html#long](http://www.ibm.com/developerworks/web/library/wa-reverseajax1/index.html#long)

所以我的问题是：

**简单的 Async servlet 和 Comet / Bayeux 协议有什么区别？**

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-10T23:51:43.357

确实，“彗星”是这些技术的术语，但 Bayeux 协议仅由少数实现使用。Comet 技术可以使用它想要的任何协议；巴约就是其中之一。

话虽如此，异步 servlet 解决方案和 Comet+Bayeux 解决方案之间有两个主要区别。

第一个区别是 Comet+Bayeux 解决方案独立于传输 Bayeux 的协议。在[CometD](http://cometd.org)项目中，客户端和服务器都有可插入的传输，可以承载 Bayeux。您可以使用 HTTP 携带它，Bayeux 是 POST 请求的内容，但您也可以使用 WebSocket 携带它，Bayeux 是 WebSocket 消息的有效负载。如果您使用异步 servlet，则无法利用比 HTTP[更有效的 WebSocket。](http://webtide.intalio.com/2011/09/cometd-2-4-0-websocket-benchmarks/)

第二个区别是异步 servlet 只携带 HTTP，而您需要更多的东西来处理远程 Comet 客户端。

例如，您可能希望唯一标识客户端，以便同一页面的 2 个选项卡生成 2 个不同的客户端。为此，您需要在异步 servlet 请求中添加一个“属性”，我们称之为`sessionId`.

接下来，您希望能够对客户端进行身份验证；只有经过身份验证的客户端才能获得`sessionId`. 但是要区分第一个身份验证请求和其他已经身份验证的后续请求，您需要另一个属性，例如`messageType`.

接下来，您希望能够快速通知由于网络丢失或其他连接问题而导致的断开连接；所以你需要想出一个心跳解决方案，这样如果心跳你就知道连接是活着的，如果它不跳动你就知道它已经死了，并执行救援行动。

接下来，您需要断开连接功能。等等。

很快您就会意识到您正在 HTTP 之上构建另一个协议。

此时，最好重用现有的协议，如 Bayeux，以及经过验证的解决方案，如 CometD（基于使用 Bayeux 协议的 Comet 技术），它为您提供：

*   具有简单而强大 API 的 Java 和 JavaScript 客户端库
*   Java 服务器库来执行您的应用程序逻辑，而无需通过带注释的服务处理 HTTP 或 WebSocket 等低级细节
*   传输可插拔性，客户端和服务器
*   Bayeux 协议可扩展性
*   懒惰的消息
*   聚类
*   顶级性能
*   未来证明：在 WebSocket 出现之前 CometD 的用户并没有更改一行代码来利用 WebSocket - 所有的魔法都在库中实现
*   基于标准
*   由网络协议专家设计和维护
*   扩展[文档](http://docs.cometd.org)
*   我可以继续，但你明白了:)

您不想使用仅将您绑定到 HTTP 的低级解决方案。您希望使用更高级别的解决方案，将您的应用程序从所使用的 Comet 技术和传输 Bayeux 的协议中抽象出来，以便您的应用程序可以编写一次并利用未来的技术改进。作为技术改进的一个例子，CometD 在异步 servlet 出现之前运行良好，现在异步 servlet 变得更具可扩展性，因此您的应用程序无需更改应用程序中的任何一行。

通过使用更高级别的解决方案，您可以专注于您的应用程序，而不是关注如何正确编写异步 servlet 的血腥细节（这并不像人们想象的那么容易）。

您的问题的答案可能是：您使用 Comet+Bayeux 是因为您想[站在巨人的肩膀上](http://en.wikipedia.org/wiki/Standing_on_the_shoulders_of_giants)。

# symfony - Symfony 2 - Redirect() 到指定页面

> ID：14268608
> 
> 赞同：0
> 
> 时间：2013-01-10T22:41:36.727
> 
> 标签：symfony

`/404`如果出现 404 错误，我正在尝试将 Symfony 重定向到另一条路由。在`ExceptionController.php`文件中，我正在寻找错误代码 404。当出现错误 404 时，重定向到`my-domain.com/404`. 我想将我的用户重定向到另一个 404 页面是因为我的自定义 404 页面来自另一个包。

下面是我写的代码。当我访问一个不存在的网站时，我看到的是 500 服务器错误页面，而不是我预期的重定向 404 页面。我错过了什么吗？

```
if ($code == '404') {
    return $this->redirect("/404");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T00:39:07.260

我看过了，据我所知，捆绑中不可能有错误页面。它必须是一个站点范围内的站点`app/Resources/views/Exception/error404.html.twig`

但是，您可以通过利用 HttpFoundation 组件返回自定义响应

```
<?php

namespace Acme\WhateverBundle\Controller;

//...
use Symfony\Component\HttpFoundation\Response;

class MyController extends Controller
{
    //...
    public function takeAction()
    {
        //..

        if ($notFound) {
            $twig = $this->container->get('templating');

            $content = $twig->render('AcmeAnotherBundle:Exception:error404.html.twig');

            return new Response($content, 404, array('Content-Type', 'text/html'));   
        }

        // ...

        return $this->render('AcmeWhateverBundle:Default:index.html.twig');
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:48:44.897

你可以尝试使用 Symfony 的 createNotFoundException() 方法：

[http://symfony.com/doc/2.0/book/controller.html#managing-errors-and-404-pages](http://symfony.com/doc/2.0/book/controller.html#managing-errors-and-404-pages)

不要重定向到 404 页面，而是在您的控制器中尝试以下操作：

```
throw $this->createNotFoundException('This page does not exist.'); 
```

# android - 为 android 创建自定义键盘，通过服务替换默认的 android 键盘

> ID：14268609
> 
> 赞同：0
> 
> 时间：2013-01-10T22:41:36.333
> 
> 标签：android

我正在创建我的键盘布局，我想用默认的 android android 键盘替换这个键盘。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:11:41.260

说真的，看一下 SDK 中的 SoftKeyboard 演示。那是你应该开始的地方。不过，您将无法强制用户使用您的新键盘。他们必须选择用您的输入法替换他们当前的输入法。该演示也向您展示了它如何适应设置。

# apache-flex - 如何在 Flex 中显示具有不同小数分隔符的数字

> ID：14268611
> 
> 赞同：3
> 
> 时间：2013-01-10T22:41:41.087
> 
> 标签：apache-flex, numberformatter

按照此处的说明更改我的操作系统的小数分隔符后：（[http://blogmines.com/blog/2010/03/11/how-to-change-the-decimal-separator-in-excel-2010/](http://blogmines.com/blog/2010/03/11/how-to-change-the-decimal-separator-in-excel-2010/)），我想在 Flex 中显示一个使用逗号作为千位分隔符和小数分隔符的数字。听起来很简单，对吧？

我尝试使用 Flex 提供的三种不同的 NumberFormatter。一路走来，我了解到它们中的两个在同一个类中不能很好地与其他类一起使用，即使在声明变量时使用完全限定的类路径，所以我不得不将它们分成三个类，如下所示：

NF1 - spark.formatters.NumberFormatter

```
package dstrube
{
    import flash.globalization.NumberParseResult;
    import spark.formatters.NumberFormatter;
    public class NF1
    {
        public static function get(value:String):String{
            var nf1:NumberFormatter = new NumberFormatter();
            var result:NumberParseResult = nf1.parse(value);
            return nf1.format(result.value);
        }
    }
} 
```

NF2 - flash.globalization.NumberFormatter

```
package dstrube
{
    import flash.globalization.NumberParseResult;
import flash.globalization.NumberFormatter;
    public class NF2
    {
        public static function get(value:String):String{
            var nf2:NumberFormatter = new NumberFormatter("");// LocaleID.DEFAULT = same outcome as without
            nf2.fractionalDigits = 2; //= same outcome as without
            nf2.trailingZeros = true;
            var result:NumberParseResult = nf2.parse(value);
            //nf2.parseNumber(value); = NaN
            return nf2.formatNumber(result.value)
        }
    }
} 
```

NF3 - mx.formatters.NumberFormatter（已弃用）

```
package dstrube
{
    //import mx.formatters.NumberBaseRoundType;
    import mx.formatters.NumberFormatter;
    public class NF3
    {
    public static function get(value:String):String{
        var nf3:NumberFormatter = new NumberFormatter();
        //nf3.rounding = NumberBaseRoundType.NEAREST; //no effect in this case
        return nf3.format(value);
    }
} 
```

}

最后，主要的

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600"
               creationComplete="init()"
               >
    <fx:Script>
        <![CDATA[
            import dstrube.NF1;
            import dstrube.NF2;
            import dstrube.NF3;
            [Bindable]
            public var s:String = "";
            protected  function init():void{
                var value:String = "5558049.90360013";
                s = "spark.formatters.NumberFormatter = " + NF1.get(value); //5,558,049.90
                s += "\n flash.globalization.NumberFormatter = " + NF2.get(value);//5,558,049,00
                s += "\n mx.formatters.NumberFormatter = " + NF3.get(value); //5,558,049.90360013
            }
        ]]>
    </fx:Script>
        <s:TextArea id="textArea" text="{s}" width="100%" height="100%" />
</s:Application> 
```

三个 NumberFormatter 中最聪明的是 flash.globalization.NumberFormatter 用于识别小数分隔符，但它舍入不正确，显示 5,558,049,00 而不是 5,558,049,90

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T22:01:22.800

您可以：

*   显式设置格式化程序的属性将为您提供所需的输出。
*   将格式化程序设置为使用默认语言环境。

    ```
     [Bindable] protected var formatted:String;

            protected function init(event:FlexEvent):void
            {
                var formatter:NumberFormatter = new NumberFormatter();

                // Option 1 set explicitly
                formatter.decimalSeparator = ",";
                formatter.fractionalDigits = 2;
                formatter.trailingZeros = true;

                // Option 2 set default locale to be the locale
                formatter.setStyle("locale", LocaleID.DEFAULT);

                formatted = formatter.format("5558049.90360013");
            }

        ]]>
    </fx:Script>

    <s:Label text="{formatted}" /> 
    ```

输出为“5,558,049,90”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:52:09.290

这种方式将显示操作系统设置中设置的任何小数点分隔符。

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx"
               initialize="init(event)">
    <fx:Script>
        <![CDATA[
            import mx.events.FlexEvent;
            import spark.formatters.NumberFormatter;
            import flash.globalization.NumberFormatter;

            [Bindable] protected var formatted:String;

            protected function init(event:FlexEvent):void
            {
                var formatter:spark.formatters.NumberFormatter = new spark.formatters.NumberFormatter();
                var nf2:flash.globalization.NumberFormatter = new flash.globalization.NumberFormatter("");

                formatter.decimalSeparator = nf2.decimalSeparator;
                formatter.fractionalDigits = 2;
                formatter.trailingZeros = true;

                formatted = formatter.format("5558049.90360013");
            }

        ]]>
    </fx:Script>

    <s:Label text="{formatted}" />
</s:Application> 
```

# spring - Spring框架中的文件类型支持

> ID：14268624
> 
> 赞同：3
> 
> 时间：2013-01-10T22:42:25.933
> 
> 标签：spring, properties

`java.io.File`是否可以直接在配置中实例化类型的属性？就像是：

```
<property><file path="..." /></property> 
```

一种可能的解决方法可能是使用 String 属性并在设置它时创建 File 实例。有没有更直接的方法来实现这一点？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:59:04.677

是的，你可以这样做。只需将文件名作为属性值传递：

```
<bean>
  <property name="myFile" value="path-to-file"/>
</bean> 
```

Spring 会自动为您创建一个 java.io.File 实例并将其注入到您的 bean 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T22:53:59.763

当然，只需将其定义`<bean/>`为`<constructor-arg/>`：

```
<property>
    <bean class="java.io.File">
        <constructor-arg value="/foo/bar.txt"/>
    </bean>
</property> 
```

# c++ - 为什么 Windows 上的 CodeBlocks 12.11 会用红色锯齿线在我的评论下划线，如何关闭此功能？

> ID：14268631
> 
> 赞同：13
> 
> 时间：2013-01-10T22:42:46.810
> 
> 标签：c++, windows-7, codeblocks

如何在 Windows 上的 CodeBlocks 中关闭“类似拼写检查”功能？

我现在也意识到，如果我在注释末尾添加“\”（反斜杠），则如果代码也被注释，则下一行。这一直是 c++ 的标准吗？

![在此处输入图像描述](../Images/b3540c8e2e794caafb8ffcdc6722eaf5.png)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-15T19:44:52.143

我的也强调了我所有的评论和字符串。结果当我下载代码块时，语言没有设置为英语。如果您查看代码块窗口的右下角，会看到一个小标志。您可以右键单击它并选择正确的语言。希望这可以帮助！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-04-09T05:19:09.337

1.  打开代码::块。
2.  转到插件-> 管理插件
3.  选择拼写检查器并禁用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:46:42.417

> 这一直是 c++ 的标准吗？

好吧，而不是 C 预处理器（C++ 详尽地使用它）。是的，这是一个文档化的功能：反斜杠换行符序列充当续行标记（即，反斜杠“无效”，转义换行符，有效地使预处理器将由反斜杠分隔的连续行视为一行）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-19T19:10:22.060

错误下划线的单词可能是由于没有选择字典造成的。这就是我修复它的方法。

单击设置-> 编辑器-> 拼写检查器（对话框左侧），然后在语言下的下拉菜单中选择字典。

# java - 如何在 Java 中处理不断发展的 XML 模式

> ID：14268633
> 
> 赞同：3
> 
> 时间：2013-01-10T22:43:00.180
> 
> 标签：java, xml, jaxb

如何在 Java 中处理不断发展的 XML 模式？我有一个用例，我必须在 Java 应用程序中支持一组旧的和不断发展的 XML 模式（即支持 Foo v1、v2、v3、v4、v5）。

我的用例包括 - 读取针对不同版本的 Foo XML 模式编写的所有 Foo XML 内容 - 合并可能以不同版本编写的 Foo XML 内容与使用不同版本的 OVAL XML 模式（即将 Foo v1 与 Foo v5 合并）。

Foo XML 模式相当复杂，并且存在已知的向后兼容性问题，因此 Foo v1 XML 内容可能无法使用 Foo v3 XML 模式验证 XML 模式。

我想到了 2 种方法 1) 使用诸如 JAXB 之类的 Java XML 数据绑定，并为每个版本的 XML 模式生成一组绑定。以 Foo XML 模式为例，我将为 Foo XML 模式 v1 到 v5 生成 5 组绑定。挑战在于如何将 Foo XML 内容的版本与 XML 内容的另一个版本合并。

2) 创建一组 Java 数据模型并使用 SAX、DOM、JDOM 手动解析它，并尝试解决我可能遇到的所有向后兼容性问题。现在的挑战是我必须在没有 JAXB 帮助的情况下自己解析 XML。

我想就处理不断发展的 XML 模式的最佳方法获得一些建议。Java XML 数据绑定是正确的前进路径，还是创建我自己的 Java 数据模型并手动解析它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:48:31.013

根据我的经验，最重要的是**数据模型**而不是输入格式。如果您可以提供一个干净的模型并抽象出不同输入的所有讨厌的东西，那么您最终会得到一个更干净、更易于管理的代码线。

鉴于单个文档的版本往往是增量的，如果您自己编写解析器，您可能可以获得相当多的代码重用，或者您可以创建并行 JAXB 包来处理与另一个类配对的每种格式以转换该版本特定模型到您的顶级模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T09:27:21.427

Schema evolution is the big drawback of the data binding approach. If your schema is not stable, then data binding is going to be a hassle, as you have discovered. There's a basic conflict here: XML is designed to be flexible ("semi-structured") in the data structures it handles, and Java is not. Are you sure that data binding is the right approach for you? Might it not be better to use a programming language designed for XML, such as XSLT or XQuery?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:49:44.623

我们为每个新版本提供 Java 转换器。他们能够从各自的先前版本进行转换。我们将 v1 作为 XML，使用 JAXB 将其转换为 Java，然后转换为数据模型 v2、v3、v4、v5。转换器都受版本控制，是每个已发布工件的一部分。

此外，我们支持 v2-1、v2-2 等分支。这要求我们有从分支 n 到下一个主要 n+1 的转换器（例如 v2-2 -> v3）。在某些时间间隔，我们停止支持“非常旧”的分支。

# php - PHP 或 MYSQL 无法识别价值

> ID：14268634
> 
> 赞同：0
> 
> 时间：2013-01-10T22:43:07.867
> 
> 标签：php, mysql

我正在使用 php 从 mysql 查询 home_team 或 away_team 列包含给定值。我知道数据库中存在此类值的记录。但是，由于某种原因，PHP 或 MySQL 告诉我它不是。我的代码如下。

```
$teams = array("St. Louis",
       "NY Yankees",
       "NY Mets",
       "LA Dodgers",
       "LA Angels");

foreach($teams as $given_team)
{
    $query = mysql_query("SELECT COUNT(*) FROM current_season_games WHERE home_team = '".$given_team."' OR away_team = '".$given_team."'")or die(mysql_error());
    $count = mysql_result($query, 0);

    echo "".$count."<br />";
} 
```

我知道正在回显的 $count 变量不正确。我正在查看数据库中符合查询中指定条件的一些行。

有任何想法吗？

谢谢，

槊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:47:06.910

您正在使用`COUNT(*)`. 这不会为您提供该字段的值。 `COUNT(*)`通常用于衡量返回了多少结果。

您实际上需要做的是选择列名，或者选择与条件匹配的整行。像这样的东西-

```
SELECT * FROM current_season_games 
WHERE home_team = '".$given_team."' OR away_team = '".$given_team."'") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:52:29.053

在我遇到的仍在使用已弃用`mysql_*`函数的旧代码中，我通常会遇到[`mysql_num_rows()`function](http://php.net/manual/en/function.mysql-num-rows.php)的使用。

> 从结果集中检索行数。此命令仅对返回实际结果集的 SELECT 或 SHOW 等语句有效。要检索受 INSERT、UPDATE、REPLACE 或 DELETE 查询影响的行数，请使用[`mysql_affected_rows()`](http://php.net/manual/en/function.mysql-affected-rows.php).

我建议将您的代码更改为这样的 -

```
$result = mysql_query("SELECT COUNT(*) FROM current_season_games WHERE home_team = '".$given_team."' OR away_team = '".$given_team."'")or die(mysql_error());
$count = mysql_num_rows($result); 
```

请注意，该`mysql_query()`函数不会`$query`像您的变量名称所指示的那样返回 a 。它返回一个结果集，然后您可以检查该结果集以检索该实际数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T23:48:39.683

这里有几件事要检查：

*   PHP 是否连接到同一个主机和数据库？（对于一些开发人员来说，这是一个“DOH！”时刻，他们有多个数据库......一个本地数据库，一个在测试服务器上。）您确定要查询同一张表吗？

*   尝试测试一个更简单的查询，例如`SELECT COUNT(*) FROM current_season_games`查看是否可以返回任何非零计数

*   尝试将查询放入字符串中，并在执行之前回显字符串

*   这是一个 InnoDB 表，并且您要计算的行是否已提交？（添加行的会话是否执行了 START TRANSACTION、插入行，然后还没有提交它们？（对于使用多个环境（例如 SQLyog 和 Web 服务器）的一些开发人员来说，这是一个 DOH！时刻。（一个单独的事务隔离级别为 REPEATABLE READ 的会话将看不到未提交的行）

*   数据库中的该列是否使用区分大小写的排序规则，其中谓词（WHERE 子句）中的相等比较被处理为区分大小写与不区分大小写？

这些都不能解决您的问题，但是如果没有更多信息，就不可能（从这里）说出问题所在。但这是您可以检查的几件事。

# eclipse - 如何在我的 RCP 应用程序的 Eclipse 安装新软件对话框中隐藏 UI 的选择软件站点部分？

> ID：14268635
> 
> 赞同：1
> 
> 时间：2013-01-10T22:43:09.253
> 
> 标签：eclipse, eclipse-rcp, p2

我发现文档说明我可以在 Eclipse RCP 应用程序的“安装新软件”对话框中隐藏一些 UI 元素。

这一切都[在这里](http://wiki.eclipse.org/Equinox/p2/Adding_Self-Update_to_an_RCP_Application#Configuring_the_p2_UI)描述。

我希望我的 RCP 应用程序（基于 Eclipse 3.7）像 RCP Mail 示例应用程序一样隐藏可用的软件站点，所以我使用这个示例实现了我的 RCP 应用程序。但是，它不起作用。

我什至已经将 RCP Mail 项目导入我的 Eclipse IDE 并启动它并调试它以查看它在做什么。当我在我的 IDE 中运行 RCP Mail 项目时，它就像一个魅力。它隐藏了 UI，就像我希望我的 RCP 应用程序做的那样。

到目前为止，我发现的主要区别是这个。

当我运行我的应用程序并尝试使用此代码获取策略时...

```
ProvisioningUI.getDefaultUI().getPolicy() 
```

我得到的政策与我使用此代码注册的政策不同...

```
policy = new RestrictedP2UIPolicy();
policyRegistration = context.registerService(Policy.class.getName(), policy, null); 
```

我的 ResrictedP2UIPolicy 类与 RCP Mail 示例应用程序中的 CloudPolicy 类相同。

我在运行时返回的 Policy 是一个名为 SDKPolicy 的实现类。

有没有人知道为什么我要获得此其他政策而不是我要注册的政策？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T04:08:27.057

SDK 策略来自 p2.ui.sdk 包。在 RCP 应用程序中，您不应使用此捆绑软件，因为它提供与 Eclipse SDK 相同的 p2 体验。

# tridion - 在具有组件链接的组件上使用 SiteEdit/TridionUI 2012 启用内联编辑

> ID：14268637
> 
> 赞同：3
> 
> 时间：2013-01-10T22:43:18.043
> 
> 标签：tridion

在 Tridion 2011（使用 UI 2012）中，我有一个组件，其字段是组件链接列表。我想对通过组件链接引入的字段之一启用内联编辑。这可能吗？

我能够为其他非组件链接字段启用内联编辑，但 CL 似乎是一个问题。我首先尝试了 tcdl 语法，但没有生成有效的 SiteEdit 组件字段标记。最后，我尝试编辑页面上的 Start Component Field 注释，看看是否能找到有效的语法，但没有提出任何有效的语法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T01:01:54.077

Nick 调用`RenderComponentPresentation`链接组件的解决方案应该可以正常工作。调用`RenderComponentPresentations`链接组件通常应该被认为是一种好的做法，因为您毕竟是在渲染另一个组件表示。

但是，如果您想控制生成的确切标签，您也可以这样做。当我需要这种级别的控制时，我创建了一些自定义函数，可以直接输出评论，而不是摆弄`tcdl`.

使用这些函数的 DWT 片段：

```
<div class="ContentArea">
  <div class="ContentFull">
    @@MarkComponentPresentation()@@
    <h1>@@MarkComponentField('Title')@@@@Component.Fields.Title@@</h1>
    <div>@@MarkComponentField('Image')@@<img src="@@Image.ID@@"/></div>
    <div class="FullDescription">
        <div class="FullDescriptionText">@@MarkComponentField('Description')@@@@Component.Fields.Description@@</div>
    </div>
    ... 
```

所以这使用`MarkXxx`而不是常规`RenderXxx`来输出评论。

您可以在 Google 代码上的 Tridion Practice wiki 上找到这些函数的代码： [http ://code.google.com/p/tridion-practice/wiki/TridionUI2012FunctionsForUseInHtmlTemplates](http://code.google.com/p/tridion-practice/wiki/TridionUI2012FunctionsForUseInHtmlTemplates)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T23:37:52.507

如果您使用此链接组件呈现此链接组件，`@@RenderComponentPresentation(componentTcmId, comonentTemplateId)@@`则启用组件内联编辑 TBB 将添加正确的 UI 标签，您将能够编辑您的嵌套组件。

您尝试手动呈现内联编辑命令的方法应该有效。我怀疑它对您不起作用的原因是由于某些语法错误或无效/缺失的参数值。

如果您共享整个呈现的 HTML 文档，我们可能会提供进一步的帮助。

# knockout.js - 如果 / ifnot 没有容器元素，则使用 Knockout 时出现问题

> ID：14268638
> 
> 赞同：0
> 
> 时间：2013-01-10T22:43:21.647
> 
> 标签：knockout.js

我有类似于以下 html 的内容：

```
<table>
  <tbody data-bind="foreach: { data: items, afterRender: alternateRowColor }">
    <!-- ko if: isNew() -->
    <tr>
      <td><input data-bind="text: prop"/></td>
    </tr>
    <!-- /ko -->
    <!-- ko if: !isNew() -->
    <tr>
      <td data-bind="text: prop"/></td>
    </tr>
    <!-- /ko -->
  </tbody>
</table> 
```

具有如下定义的对象集合：

```
function NewItem() {
  this.prop = ko.observable(0);
  this.isNew = ko.observable(true);
}

function Item(prop) {
  this.prop = prop;
  this.isNew = ko.observable(false);
} 
```

“项目”来自服务器，“新项目”是在用户单击链接时添加的。这个想法只是为新项目提供一个输入框，而只是现有项目的显示。这似乎适用于现有项目（当 isNew 为 false 时），但当 isNew 为 true 时，两组标记都呈现（添加了两行，一个可编辑，然后一个仅显示）。如果 isNew 为真，我希望只呈现第一个“tr”。有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:26:50.813

我的[Switch-Case 绑定](https://github.com/mbest/knockout-switch-case)就是为了解决这类问题。

```
<table>
  <tbody data-bind="foreach: { data: items, afterRender: alternateRowColor }">
    <tr data-bind="switch: true">
      <!-- ko case: isNew -->
        <td><input data-bind="text: prop"/></td>
      <!-- /ko -->
      <!-- ko case: $else -->
        <td data-bind="text: prop"/></td>
      <!-- /ko -->
    </tr>
  </tbody>
</table> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T23:07:28.133

使用`ifnot`而不是`!`标志。删除`()`，您正在评估它的价值。

```
<!-- ko ifnot: isNew --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T17:37:19.987

我能够使用模板选择器完成此操作。我创建了一个演示该行为的小提琴：http: [//jsfiddle.net/tltjr/3FUQR/](http://jsfiddle.net/tltjr/3FUQR/)

我仍然不确定为什么这种`if`行为不起作用，但我觉得这种方法更灵活，更易读。

# javascript - 浏览器窗口顶部和底部的动态叠加层

> ID：14268641
> 
> 赞同：0
> 
> 时间：2013-01-10T22:43:30.460
> 
> 标签：javascript, jquery, dom

我试图弄清楚如何使用 JavaScript 和 jQuery 动态创建两个`<div>`元素，并在浏览器窗口顶部覆盖一个，在底部覆盖另一个，两者的宽度都等于浏览器窗口的宽度。

我不太确定如何解决这个问题，所以我想我只想问两个主要问题：

1.  有没有办法获取浏览器窗口的尺寸并使用它来定位叠加层？

2.  创建静态定位元素时，如何将它们插入 DOM 以使其不会改变页面的任何其他部分？

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:47:12.750

1.  [jQuery 宽度](http://api.jquery.com/width/)/ [jQuery 高度](http://api.jquery.com/height/)

    var $win = $(window), $width = $win.width(), $height = $win.height();

2.  [jQuery 追加（）](http://api.jquery.com/append/)

    $(body).append(div); <- div 被创建为变量中的字符串

第二个假设它们是位置：绝对。无论您想在何处附加该项目，只需选择您想要的父项并根据需要应用即可。

# knockout.js - Knockout.js foreach 不适用于第二个或更多元素

> ID：14268642
> 
> 赞同：1
> 
> 时间：2013-01-10T22:43:33.390
> 
> 标签：knockout.js

尝试将数组与表绑定，如果我有这个：

```
<table data-bind="foreach: Applicants, visible: Applicants().length > 0">
        <tr>
        <td>
        <p data-bind="text:FirstName() + ' ' + LastName()" />
        <img data-bind="attr:{src: URL}" width="100px" height="100px" alt="test" /></td>
        </tr>
</table> 
```

不会生成 img 标签，只是从显示中省略。

必须有另一个`<td>`包装`<img>`来显示它。为什么？

* * *

好的，@Stokedout 是对的，在尝试使用`</p>`而不是使用封闭标签`<p .... />`之后，它可以工作。因此，如果标签可能具有价值但没有任何价值而关闭，那么淘汰赛将不适用于其余标签..

例子：

将起作用： -- 名字和姓氏都将显示。

```
 <p data-bind="text: FirstName"></p>
      <p data-bind="text: LastName"></p> 
```

将不起作用：- 仅显示名字

```
 <p data-bind="text: FirstName"/>
      <p data-bind="text: LastName"/> 
```

我不知道为什么！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T03:50:30.097

当你写：

```
<p data-bind="text:FirstName() + ' ' + LastName()" />
<img data-bind="attr:{src: URL}" width="100px" height="100px" alt="test" /> 
```

如果没有结束标签，img 将被视为段落的内容。对于自闭合的 P 元素，浏览器可以推断该段落在下一个段落的开头已经结束。

当您使用此绑定时：

```
data-bind="text:FirstName() + ' ' + LastName()" 
```

KO 将尝试为您的 P 元素设置文本并清除以前的内容。

解决方法很简单，只需添加一个结束标签：

```
<p data-bind="text:FirstName() + ' ' + LastName()"></p>
<img data-bind="attr:{src: URL}" width="100px" height="100px" alt="test" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T01:52:46.243

这是因为`<p>`元素必须具有完整的元素语法。

```
<p data-bind="text:FirstName() + ' ' + LastName()"></p> 
```

没有它，HTML 变成：

```
<p data-bind="text:...">
    <img ... />
</p> 
```

因此`img`成为`p`元素的内容并被`text`绑定覆盖。

# excel - 运行时错误 52 错误文件名 - 仅限 Mac

> ID：14268646
> 
> 赞同：0
> 
> 时间：2013-01-10T22:43:49.697
> 
> 标签：excel, vba, macos

我有以下函数，它仅在 Mac 上产生**运行时错误 52 （错误的文件名或编号）**`Open filePath & filename For Output As #1`

```
Function ExportAsCSV(ByVal charToEncode As String, _
    ByVal filePath As String, ByVal filename As String) As Boolean

'Function to Export string to CSV. Returns True/False if successful
'Tested and working on PC XL2003,2007 & 2010 // MAC XL2011

    'On Error GoTo Err:
    On Error GoTo 0

    Open filePath & filename For Output As #1
    Print #1, charToEncode
    Close #1

    ExportAsCSV = True

    On Error GoTo 0
    Exit Function

Err:
On Error GoTo 0
ExportAsCSV = False

End Function 
```

导致错误的示例参数是：

```
 filePath : "Untitled:Users:ooo:Desktop:New" : String
  filename : ":FloridaRhum Barbancourt 5 Star Reserve Speciál 8 Years Old.csv" : String 
```

这绝对是导致问题的文件名，就好像我将其更改为“：test.csv”一样，它可以工作。所有单个单词也可以正常工作，因此它似乎不是编码问题，如果我生成相同长度的长文件名，也可以。

我很难过..有什么想法吗？

**编辑：**

还要补充一点，`Open filePath & filename For Output As #1`它实际上会在正确的位置生成一个具有正确文件名的文件。但是由于 VBA 生成错误，所以没有写入任何内容，因此文件为零字节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T13:15:47.323

我认为您遇到了一个遗留错误，该错误将通过 VBA 的保存限制为 32 个字符。您仍然可以创建文件，但无法打开和写入文件。

我要么在处理时写入较短的文件名，最后一步要么使用该`SaveAs`方法保存到较长的 CSV 文件名，要么使用 AppleScript 重命名文件。（我相信他们会在下一版本的 Office 中修复它；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-27T09:03:07.740

只是为了给这个问题多加一点

我偶然发现了在 Office 2011 下使用 vba for Word 的问题，所以它不仅仅是 Excel。

在我的情况下，导致问题的路径中的两个文件夹是一个文件夹。

我正在使用此路径创建并写入文件：

Macintosh HD:Users:myusername:Desktop:Data Extractor V8 copy.zip 文件夹:xl:Newstyles.xml

当我更改路径以将文件夹名称减少为 31 个字符时，即：

Macintosh HD:Users:myusername:Desktop:Data Extractor V8 co.zip 文件夹:xl:Newstyles.xml

一切正常。

男孩确实需要一些时间才能找到。试图让我的老大脑写 vba 而没有把这些卷发器扔到路上已经够糟糕了（对不起双关语）

无论如何-希望这对其他人有所帮助-我将通过 Word 向 Microsoft 发布警报

鲍勃·J。

# php - PHP 压缩来自 Gopro 的视频，最好的方法？

> ID：14268657
> 
> 赞同：0
> 
> 时间：2013-01-10T22:44:31.793
> 
> 标签：php, ffmpeg

我开发了一个网站来托管来自 GoPro 的视频（通常是高清的 mp4 文件）

我想上传后如何压缩视频。实际上，在网站上您可以上传视频并观看它，但是她太胖了，无法观看...

我看到 ffmpeg-php 但我看不到如何使用她的 API 进行压缩。

最好的方法是压缩成像 flv 这样的独特格式？还是 ogv/webM/mp4 使用 html 5 ？

有任何想法吗 ？

非常感谢，

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:11:36.723

如果可以使用 exec(); 在您的服务器中运行，您可以按照这个简单的教程使用 FFMPEG，[http: //www.slideshare.net/ProdigyView/ffmpeg-basics-for-php-tutorial](http://www.slideshare.net/ProdigyView/ffmpeg-basics-for-php-tutorial)

我认为 FFMpeg 是在 php 中处理视频文件的最佳且简单的方法。

# c++ - C++/链表中的指针

> ID：14268659
> 
> 赞同：2
> 
> 时间：2013-01-10T22:44:41.217
> 
> 标签：c++, pointers, linked-list

假设在我的链表类中，我保留了一个指向链表头部的指针......

当我编写此代码时，在其中一个成员函数中......

```
Node *cur = head;
cur = cur->next; 
```

为什么头不改变`head->next`？

如果我写`cur = NULL`；它会让人头疼`null`吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T22:51:23.133

我假设这`head`是一个`Node *`. 在这种情况下，当您说`cur = cur->next`您正在更改 where`cur`点时，但`head`仍将指向列表的头部，因为您没有更改它指向的位置。

```
Cur----------|
             |
             V       next
Head -----> Item 1--------->Item 2 
```

`cur = cur->next`产生以下结果：

```
Cur--------------------------|
                             |
                     next    V      
Head -----> Item 1--------->Item 2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T22:48:10.370

如果你写：

```
Node *cur = head;
cur = NULL; 
```

然后`cur`将指向任何内容，并且不会发生任何事情`head`。

如果你写：

```
Node *cur = head;
cur = cur->next;
cur = NULL; 
```

同样的事情会发生（`cur`将指向任何东西，也不会发生任何事情`head`），除非`head`was `NULL`，在这种情况下，你会崩溃`cur = cur->next;`

如果您尝试通过指针设置`head->next`，`NULL`可以`cur`使用以下方法进行设置：

```
Node *cur = head;
cur->next = NULL; 
```

我可以看到您的困惑来自指针的性质。当您说`Node *cur = head;`您正在创建一个`Node`指向与`head`. 如果您`cur`通过 设置为其他内容`cur = NULL`，那么您只是更改**指向 的**内容，而不是**它所`cur`****指向的内容的值，**因此不会受到影响`head`。

当您改为使用时，您**正在**`cur->next = NULL`修改**指向**`next`的成员。这也是what指向的成员，因此变化也反映在.**`cur`**`next``head``head->next`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:49:24.523

cur 是指针，cur = cur->next; 只是在其他地方提出当前观点，它为什么要换头？

# php - Mysql-PHP，基于变量字段的透视/交叉表

> ID：14268664
> 
> 赞同：2
> 
> 时间：2013-01-10T22:45:10.807
> 
> 标签：php, mysql, variables, pivot, crosstab

大家好，提前感谢您的帮助！

我正在尝试根据返回的查询创建交叉表类型的查询结果。第一个查询：

```
SELECT DISTINCT
dc.`name`,
Count(pd.dispositionCodeId) AS NumberOfDispos
FROM
pd

 JOIN ph ON (pd.packetHeaderId = ph.packetHeaderId)
 JOIN sc ON (sc.packetHeaderId = ph.packetHeaderId)
 JOIN dc ON pd.dispositionCodeId = dc.dpcodeId
WHERE (`ph`.`customerId` = 60)
GROUP BY
dc.`name` 
```

导致：

```
Name NumberofDispos
B      400
NO     245
S      134
V      98 
```

-`name`我返回的内容是可变的，具体取决于 customerId，以及出现在其他类似查询中的附加 where 子句。

有没有办法将`name`字段的结果作为第二个表中的列标题进行旋转，第二个查询将计算该特定名称出现在另一个匹配字段中的出现次数？

```
 B   NO  S   V 
PackA   250 120 61  22
PackB   100 23  62  37
PackC   50  102 11  39 
```

请记住，列标题会根据第一次查询的结果而变化。

据我所知，我需要创建一个 php 数组并遍历 sql 结果

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:08:20.793

这种类型的查询称为*数据透视*，但不幸的是 MySQL 没有数据透视函数，因此您需要使用带有`CASE`语句的聚合函数来复制它。

如果这些值是提前知道的，那么您可以将这些值硬编码为以下内容：

```
SELECT pd.dispositionCodeId,
  sum(case when dc.`name` = 'B' then 1 else 0 end) B,
  sum(case when dc.`name` = 'NO' then 1 else 0 end) NO,
  sum(case when dc.`name` = 'S' then 1 else 0 end) S,
  sum(case when dc.`name` = 'V' then 1 else 0 end) V
FROM pd
JOIN ph 
  ON pd.packetHeaderId = ph.packetHeaderId
JOIN sc 
  ON sc.packetHeaderId = ph.packetHeaderId
JOIN dc 
  ON pd.dispositionCodeId = dc.dpcodeId
WHERE (`ph`.`customerId` = 60)
GROUP BY pd.dispositionCodeId; 
```

但是，如果值或数量`names`未知，那么您可以使用准备好的语句来创建动态 sql 语句来执行。代码将如下所示：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'sum(case when dc.`name` = ''',
      name,
      ''' then 1 else 0 end) AS ',
      name
    )
  ) INTO @sql
FROM dc;

SET @sql = CONCAT('SELECT pd.dispositionCodeId, ', @sql, ' 
                   FROM pd
                   JOIN ph 
                     ON pd.packetHeaderId = ph.packetHeaderId
                   JOIN sc 
                     ON sc.packetHeaderId = ph.packetHeaderId
                   JOIN dc 
                     ON pd.dispositionCodeId = dc.dpcodeId 
                   WHERE `ph`.`customerId` = 60
                   GROUP BY pd.dispositionCodeId');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:55:40.127

这应该适合你：

```
SELECT 
  pd.dispositionCodeId,
  SUM(CASE WHEN dc.`Name` = 'B' THEN 1 ELSE 0 END 0) AS B,
  SUM(CASE WHEN dc.`Name` = 'NO' THEN 1 ELSE 0 END 0) AS NO,
  SUM(CASE WHEN dc.`Name` = 'S' THEN 1 ELSE 0 END 0) AS S,
  SUM(CASE WHEN dc.`Name` = 'V' THEN 1 ELSE 0 END 0) AS V
FROM pd
JOIN ph ON (pd.packetHeaderId = ph.packetHeaderId)
JOIN sc ON (sc.packetHeaderId = ph.packetHeaderId)
JOIN dc ON pd.dispositionCodeId = dc.dpcodeId
WHERE (`ph`.`customerId` = 60)
GROUP BY pd.dispositionCodeId 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T23:22:31.647

如果提供的答案不合适，因为您事先不知道该`name`字段的值并且不想使用准备好的语句，您总是可以添加另一个级别的分组并在您的应用程序代码中执行“pivot” . 选择可能看起来像

```
SELECT
dc.`name` as `name`,
dc.`other_field` as `other_field`,
Count(pd.dispositionCodeId) AS NumberOfDispos
FROM
pd
 JOIN ph ON (pd.packetHeaderId = ph.packetHeaderId)
 JOIN sc ON (sc.packetHeaderId = ph.packetHeaderId)
 JOIN dc ON pd.dispositionCodeId = dc.dpcodeId
WHERE (`ph`.`customerId` = 60)
GROUP BY
dc.`name`,
dc.`other_field`
ORDER BY
dc.`name` ASC,
dc.`other_field` ASC 
```

然后，您可以在 PHP 中构建数据透视表所需的二维数组（假设此处为 PDO，但基本要点与使用其他库遍历结果集相同）：

```
$final_array = array();
while($row = $statement->fetchObject()) {
    $final_array[$row->name][$row->other_field] = $row->NumberOfDispos;
} 
```

# iphone - UITableView 插入旧数据

> ID：14268666
> 
> 赞同：0
> 
> 时间：2013-01-10T22:45:15.667
> 
> 标签：iphone, ios, objective-c, uitableview

我有一个带有 1 部分的简单 UITableView，其中存在任意数量的`KMInputCell`带有 UITextFields 的自定义 UITableViewCells （类型）的行。当用户开始在最后一个（空白）文本字段中输入时，会插入一个新的空白行（因此用户可以创建一个类似列表的结构）。由于我只会在视图关闭时“保存”数据，因此数据源只是`NSUInteger`跟踪行数。

在用户从表中删除一行之前，我的代码可以正常工作。然后，当用户开始在列表末尾键入并且应该插入一个新的（空白）行时，插入的 UITableView 单元格包含来自已删除单元格的旧数据。更糟糕的是，当多行被删除然后用户开始输入（并且应该插入一个空白行）时，多行被删除的行会突然出现。

这是在`fieldChanged:`编辑单元格中的一个 UITextField 时调用的方法（`self.last_cell`返回该部分中的最后一个单元格）：

```
- (IBAction)fieldChanged:(id)sender {
    // get the text field of the last row
    // if it has a value that is not blank, insert another row
    KMInputCell* last_cell = self.last_cell;
    if(![last_cell.textField.text isEqualToString:@""]){
        [self.tableView beginUpdates];
        NSIndexPath* new_cell_path = [NSIndexPath indexPathForItem:[self.tableView numberOfRowsInSection:0] inSection:0];
        [self.tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:new_cell_path] withRowAnimation:UITableViewRowAnimationAutomatic];
        number_emails++;
        [self.tableView endUpdates];
    }
} 
```

这`commitEditingStyle:`是用于删除单元格的方法：

```
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source
        number_emails--;
        [tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }   
    else if (editingStyle == UITableViewCellEditingStyleInsert) {
        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
     }   
} 
```

## 添加

这里是`cellForRowAtIndexPath:`：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"add_email_prototype";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];=

    // Configure the cell...

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:59:56.510

我不太清楚你的数据模型的细节......仅仅跟踪一个整数并不是一个很好的方法 - 但也许我只是不明白你在做什么。您是否有代表这些行的模型数组或模型对象，或者您只是跟踪其字段中的文本？

您正在插入新行，但问题可能与 UITableViewCells 在呈现时被重用的事实有关。如果这确实是这里的问题，您可能需要更新此处未提供的方法：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    // Configure the cell...

    return cell;
} 
```

这应该是您用来填充文本字段的方法。还必须明确清除任何动态字段的内容，以便在重新使用表格单元格时不会在其中获得意外内容。

更新

文本字段本身不适合保留数据。正如您从这里的问题中看到的那样，该体系结构将其排除在外，因为当单元格在屏幕上下滚动（或被删除/添加）时，它们会被重复使用。一种做法是创建一个数组并将这些文本字段的内容作为字符串存储在其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T07:04:38.760

在 cellForRowIndex 函数中，只需将它们初始化为 nil。这将解决问题。

# google-maps - 谷歌地图刷新灰色

> ID：14268667
> 
> 赞同：2
> 
> 时间：2013-01-10T22:45:20.707
> 
> 标签：google-maps, google-maps-api-3

我正在尝试将 Google Map 添加到 jquery.mobile 站点 javascript 和 Google Maps API。问题是每次我加载地图时，**大部分地图都是灰色的**。我做了一些研究，显然我必须添加命令：

```
google.maps.event.trigger(map, 'resize');
```

但在过去的几个小时里我一直在摆弄这个，我似乎无法让它工作。这是我正在使用的代码：

```
      var myLatlng = 新 google.maps.LatLng(34.310774,66.225586);

      var mapOptions = {
        中心：myLatlng，
        mapTypeId：google.maps.MapTypeId.ROADMAP
      }

      var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

      // 边界
      var southWest = 新 google.maps.LatLng(31.207164,61.347656);
      var northEast = new google.maps.LatLng(37.617713,69.785156);
      var bounds = new google.maps.LatLngBounds(southWest,northEast);

      map.fitBounds(边界);
      google.maps.event.trigger(map, 'resize');

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T23:07:03.117

要解决该问题，您需要：

1.  确保显示地图的 div 具有有效的大小，如果它被隐藏，它将具有零大小，您需要先显示 div，然后它才会具有有效的大小。如果使用百分比调整大小，请确保其所有父元素都具有百分比大小或特定大小（[有关详细信息，请参阅 Mike Williams 的 Google Maps API v2 教程](http://econym.org.uk/gmap/basic19.htm)）。

2.  一旦它有一个大小初始化地图（如果你还没有）

3.  如果它已经被初始化，触发它的 resize 事件。

4.  触发调整大小事件后，您可能需要设置地图的中心。

你没有提供足够的信息来看看你哪里出错了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-21T00:16:03.837

在开始编码之前，您应该首先让 Google Map Widget 工作。您只需要密钥 ID、纬度和经度并使用应用程序设计器。默认情况下建议的缩放设置为 8 就足够了。以下是一些细节： [http ://hodentekmobile.blogspot.com/2016/07/intel-xdk-controls-6-using-google-map.html](http://hodentekmobile.blogspot.com/2016/07/intel-xdk-controls-6-using-google-map.html)

# ios - Objective-C 属性 - “id”是什么意思？

> ID：14268669
> 
> 赞同：16
> 
> 时间：2013-01-10T22:45:38.003
> 
> 标签：ios, objective-c, ios5

> **可能重复：**
> [id 是什么意思？](https://stackoverflow.com/questions/7987060/what-is-the-meaning-of-id)

根据我的问题，我显然是 iOS 开发和 Objective-C 的菜鸟。我正在学习一个教程，并且在我的接口 (.h) 实现中声明了这一行：

```
@property (strong, nonatomic) id dataObject1; 
```

“身份证”是什么意思？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-10T22:47:06.193

`id`是对象的类型；例如，该类型可能是`NSArray *`或`int`相反。

该`id`类型指定对任何 Objective-C 对象（无论其类）的引用。

# javascript - 取消选中多个复选框后从数组中删除值

> ID：14268671
> 
> 赞同：0
> 
> 时间：2013-01-10T22:45:52.283
> 
> 标签：javascript

```
$('.options').click(function() {
            var selectedItems = new Array();
            $("input:checkbox:checked").each(function() {selectedItems.push($(this).val());});
                var data = selectedItems.join(',');
            $("#opts").val(data);
        }); 
```

我有这个函数将复选框中的值插入到数组中。目前这工作正常。但是在提交表单时，值会像它应该的那样保留在数组中，但问题是在取消选中复选框后它会保留在数组中，如果我再次选中同一个框，它会再次添加值。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:30:47.683

您可以检查以确保在推送之前该值不在数组中

```
if(!($.inArray($(this).val(), selectedItems))){
  selectedItems.push($(this).val());});
} 
```

# javascript - 流星模板更新

> ID：14268672
> 
> 赞同：7
> 
> 时间：2013-01-10T22:45:58.320
> 
> 标签：javascript, meteor

我是流星的新手。我建立了简单的测试并陷入了非常简单的部分。我的网页内容仅在数据库更改时更新，但是当函数返回结果更改时如何强制更新？这是我的应用程序的部分代码：

客户端.js：

```
Meteor.subscribe("tasks");

var search_query = "";

Template.page.tasks = function() {
    return Tasks.find({title: {$regex: search_query}});
};

Template.task.events({
    'click .checkmark': function() {
        Tasks.update({_id: this._id}, {$set: {done: !this.done}});
    }
});

Template.page.events({
    'keyup .search': function() {
        search_query = $(".search").val();
    }
}); 
```

todo.html:

```
<head>
  <title>Todo list</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
  {{> page}}
</body>

<template name="page">
    <div class="tasks">
        <h1>Collections TODOs</h1>
        <input type="text" class="search" placeholder="Search...">
        {{#each tasks}}
            {{> task}}
        {{/each}}
    </div>
</template>

<template name="task">
    <div class="task well well-small">
        <button type="button" class="close cancel">&times;</button>
        <h3>
            {{#if done}}
                <button type="button" class="checkmark done">&#10003;</button>
            {{else}}

    <button type="button" class="checkmark muted">&#10003;</button>
        {{/if}}
        {{title}}
    </h3>
    <div class="creator muted">{{creator}}</div>
    <p>{{description}}</p>
</div> 
```

所以现在，我希望每当用户在 input.search 框变量中键入某些内容时都会`search_query`更改并且现在`Template.page.tasks`返回不同的结果。但没有什么真正的更新。[您可以在http://slava.meteor.com](http://slava.meteor.com)上查看应用程序

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T23:09:41.267

您需要一个[反应变量](http://docs.meteor.com/#reactivity)来再次动态运行搜索。做`search_query`一个`Session`这样的变量

```
Template.page.tasks = function() {
    return Tasks.find({title: {$regex: Session.get("search_query") }});
}; 
```

在您的活动中：

```
Template.page.events({
   'keyup .search': function() {
        Session.set("search_query", $(".search").val());
    }
}); 
```

# jquery - jQuery mouseout 事件应该“悬停”css 元素吗？

> ID：14268673
> 
> 赞同：0
> 
> 时间：2013-01-10T22:46:02.517
> 
> 标签：jquery

有些元素具有`:hover`css属性，我需要通过强制mouseout将它们带走`.trigger("mouseout");`它不应该工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:48:31.417

强制 mouseout 事件不会删除`:hover`伪类，浏览器对此负责。

也许您想绑定在鼠标悬停时添加类并在鼠标移出时删除类的事件处理程序。然后，您可以更精细地控制何时添加/删除类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:49:47.663

那不管用。大多数渲染引擎的实现不将悬停状态的激活/停用与鼠标悬停/悬停事件联系起来。你为什么要这样做？你想达到什么目的？尝试寻求替代方案，但提供更多信息。你应该这样得到你想要的。

# css - 为什么这些 @-moz-keyframes 不起作用？

> ID：14268674
> 
> 赞同：0
> 
> 时间：2013-01-10T22:46:20.483
> 
> 标签：css, css-animations

我需要有人指出我为什么 @-moz-keyframes 不起作用。我安装了最新的FF。因此，如果有人提供帮助，那就太好了。

```
@-moz-keyframes accTextMove {
25% { margin: 50px 0 0 380px; opacity: 0; } 100% { margin: 50px 0 0 30px; opacity: 1;         }
}

@-moz-keyframes focusTextMove {
0% { opacity: 0; } 50% { opacity: 0; } 100% { opacity: 1; }
}

@-moz-keyframes accFadeTextMove {
0% { opacity: 0; -moz-transform: scale(.5); } 100% { opacity: 1; -moz-transform: scale(1); }
}

@-moz-keyframes focusFadeTextMove {
0% { opacity: 0; } 35% { opacity: 0; margin: 115px 0 0 53px; } 100% { opacity: 1; margin: 115px 0 0 140px; }
}

<div id="textIntroArea">
    <span id="accFade">Accounting</span>
    <span id="focusFade">with focus</span>
    <span id="acc">Accounting</span>
    <span id="focus">with focus</span>
</div> 
```

如果你能看到我错过的东西，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:14:35.410

-moz prefix doesn't support in new version of FF ( 18.0.1)

Check this question answer

[css @-moz-keyframes animation not working on firefox 18.0.1](https://stackoverflow.com/questions/14713191/css-moz-keyframes-animation-not-working-on-firefox-18-0-1)

# iphone - 将 JSON 解析应用于我的案例

> ID：14268679
> 
> 赞同：0
> 
> 时间：2013-01-10T22:46:33.540
> 
> 标签：iphone, objective-c, json

我一直在关注[这个](http://www.touch-code-magazine.com/tutorial-fetch-and-parse-json-in-ios6/)教程。我试图将它应用到我的案例中。我将使用的 JSON 提要是：[JSON 提要](http://www.ah.nl/albertheijn/winkelinformatie/winkels)。

他们正在使用以下“查询”：

```
 json[@"loans"][0][@"name"] 
```

因此，我使用以下方法尝试了我的案例：

```
json[@"0"][@"format"] 
```

或者

```
json[@"0"][0][@"format"] 
```

但两者都返回null。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:49:00.403

好吧，因为您拥有的不是 JSON。（即，它是“无效”的 JSON - 例如，它没有用引号括起来的字典键，因此无论您使用什么 JSON 解析器，都可能会返回`nil`，因为它无法解析它。）

顺便说一句，即使它是有效的 JSON，你的方法也不管用。首先你有一个**数组**作为根元素，然后它的项目是字典。即，你必须如何索引是

```
json[0][@"format"] 
```

（前提`json`是已经解析的对象，而不是 JSON 字符串本身！）

# node.js - execSync 与流星

> ID：14268682
> 
> 赞同：1
> 
> 时间：2013-01-10T22:46:54.153
> 
> 标签：node.js, meteor

我正在尝试使用该`execSync`包来获得同步 shell 功能。虽然我最初由于缺少文件而遇到问题，但我通过在适当的目录中`binding.node`运行来解决它。现在，我可以毫无问题地调用节点内的函数。`node-gyp``execSync``execSync`

但是，当我尝试使用流星中的函数时，出现以下错误：

```
Running on: http://localhost:3000/
/usr/lib/meteor/bin/node: symbol lookup error: /home/onur/node_modules/execSync/node_modules/ffi/node_modules/ref/build/Release/binding.node: undefined symbol: _ZNK2v85Value6IsNullEv
Exited with code: 127
Your application is crashing. Waiting for file change. 
```

**笔记：**

通过网络快速检查表明该符号属于 V8 库。

**编码**

我在`Meteor.methods`.

```
getpuzzle: function (clu, lo, hi) {
    var require = _meteor_bootstrap__.require;   
    var exec = require('execSync');
    var sudoku_str = exec.stdout(path_sudoku_gen+" "+clu+" "+lo+" "+hi);  
    console.log(sudoku_str); 
    return sudoku_str;                                        
} 
```

我试图弄清楚服务器和客户端之间的交互。基本上，我正在尝试这样[做](http://www.scriptol.com/javascript/nodejs-php.php)。客户端的函数需要一个字符串，该字符串由服务器端执行的 python 脚本返回。我尝试使用全局变量进行肮脏的破解，但这仍然无关紧要，因为脚本是异步运行的。我可以在没有同步执行的情况下做到这一点吗？我无法完全掌握客户端-服务器交互的模型，所以如果有正确的方法，请随时纠正我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T03:48:59.630

由于您没有显示代码，因此我假设您的要求行失败。而不是标准的 node.js 要求您必须使用 Meteor 包装器

```
var require = __meteor_bootstrap__.require;
var path = require('path') 
```

# javascript - 保留两个s 同步 我的应用中有两个 <select>，但在不同的屏幕上。它们附加了相同的更改处理程序并具有相同的值。当一个改变另一个应该相应地改变它的值。问题是当一个被更改并且我尝试更改另一个时，它会在第一个上触发更改事件，以此类推。那么如何更改选择，但不触发更改事件？在更改处理程序中，仅当其值不同时才更新另一个选择，如果值匹配则不执行任何操作。这打破了递归。试试这个： var $selects=$('#select_1,#select_2').change(function( ID：14268685 赞同：4 时间：2013-01-10T22:46:57.553 标签：javascript, jquery 回答 #1 赞同：11 时间：2013-01-10T23:08:02.190 当我尝试更改另一个时，它将在第一个上触发更改事件，依此类推。 真的吗？那你一定是做错了什么，通常改变值不会触发事件。只需使用 var bothselects = $("#first-select, #second-select"); bothselects.change(function(e) { bothselects.val(this.value); // "this" is the changed one // do whatever else you need to do }); 回答 #2 赞同：4 时间：2013-01-10T23:19:23.460 如果要按索引而不是值匹配选项的选项，请按以下方式进行操作： HTML： <select class="synch"> <option value="A">A</option> <option value="B">B</option> <option value="C">C</option> </select> <select class="synch"> <option value="AA">AA</option> <option value="BB">BB</option> <option value="CC">CC</option> </select> javascript： var $synch = $(".synch").on('change', function() { $synch.not(this).get(0).selectedIndex = this.selectedIndex; }); 演示 我看不出递归应该是个问题。即使以<select>编程方式更改确实触发了“更改”事件（它不会），那么在第一次同步之后，两个索引（或值）将匹配并且不会发生进一步的更改，也不需要发生。因此没有变化，没有变化事件，也没有递归。 回答 #3 赞同：1 时间：2013-01-10T22:53:35.777 尝试这个： var $selects=$('#select_1,#select_2').change(function(){ $selects.not(this).val( $(this).val() ); }) 演示http://jsfiddle.net/mGYGK/ 回答 #4 赞同：1 时间：2013-01-10T22:54:21.890 $("#select1").change(function(){ $("#select2").val($("#select1").val()) }); $("#select2").change(function(){ $("#select1").val($("#select2").val()) }); 您可以在此处查看此功能的现场演示 回答 #5 赞同：0 时间：2013-01-10T22:50:04.927 在更改处理程序中，仅当其值不同时才更新另一个选择，如果值匹配则不执行任何操作。这打破了递归。</select>

# tomcat - 每次更改应用程序后都必须重新启动 TomCat

> ID：14268688
> 
> 赞同：2
> 
> 时间：2013-01-10T22:47:08.283
> 
> 标签：tomcat, ant

我在使用**TomCat 7**时遇到问题，我对应用程序所做的任何更改，我使用 ant 构建以查看我必须不断重启服务器的那些更改。只有当服务器关闭时，我才能**构建**和**部署**，然后重新启动服务器，它就会工作。

如果我不重新启动服务器并且我**取消部署**并将其**部署**应用程序，我将收到 **http :404 错误**。

有人可以告诉我我需要做些什么来避免每次更改都令人讨厌时重新启动。

**ANT 构建文件：**

```
<?xml version="1.0"?>

<project name="app" basedir="." default="usage">
    <property file="build.properties"/>

    <property name="src.dir" value="src"/>
    <property name="web.dir" value="war"/>
    <property name="build.dir" value="${web.dir}/WEB-INF/classes"/>
    <property name="name" value="crimeTrack"/>

    <path id="master-classpath">
        <fileset dir="${web.dir}/WEB-INF/lib">
            <include name="*.jar"/>
        </fileset>

        <fileset dir="${appserver.lib}">
            <include name="servlet*.jar"/>

        </fileset>

        <pathelement path="${build.dir}"/>
    </path>

    <target name="usage">
        <echo message=""/>
        <echo message="${name} build file command list"/>
        <echo message="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"/>       
        <echo message="                | Targets: ANT                                    |"/>                                       
        <echo message="                ---------------------------------------------------"/>
        <echo message="                | build     --: Build the application             |"/>             
        <echo message="                ---------------------------------------------------"/>
        <echo message="                | deploy    --: Deploy application as directory   |"/>
        <echo message="                ---------------------------------------------------"/>
        <echo message="                | deploywar --: Deploy application as a WAR file  |"/>
        <echo message="                ---------------------------------------------------"/>
        <echo message="                | install   --: Install application in Tomcat     |"/>
        <echo message="                ---------------------------------------------------"/>
        <echo message="                | reload    --: Reload application in Tomcat      |"/>
        <echo message="                ---------------------------------------------------"/>
        <echo message="                | start     --: Start Tomcat application          |"/>
        <echo message="                ---------------------------------------------------"/>
        <echo message="                | stop      --: Stop Tomcat application           |"/>
        <echo message="                ---------------------------------------------------"/>
        <echo message="                | list      --: List Tomcat applications          |"/>
        <echo message="                ---------------------------------------------------"/>
        <echo message="                ___________________________________________________"/>
        <echo message="                Targets: Database                                  "/>
        <echo message="                ___________________________________________________"/>
        <echo message="                | createTables --: Creates Database Tables        |"/>
        <echo message="                ---------------------------------------------------"/>
        <echo message="                | emptyTables --: Empty Database Tables           |"/>
        <echo message="                ---------------------------------------------------"/>
        <echo message="                | loadData  --: Loads data into Database Tables   |"/>
        <echo message="                ---------------------------------------------------"/>
        <echo message="                | showTables --: Lists the tables in Database     |"/>
        <echo message="                ---------------------------------------------------"/>
        <echo message="                ___________________________________________________"/>
        <echo message="                Targets: Junit                                     "/>
        <echo message="                ___________________________________________________"/>
        <echo message="                | tests --: Runs test on all objects using JUNIT  |"/> 
        <echo message=                 "${deploy.path}/${name} and ${build.dir}" /> 
        <echo message="                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"/>
    </target>

    <target name="build" description="Compile main source tree java files">
        <mkdir dir="${build.dir}"/>
        <javac destdir="${build.dir}" source="1.7" target="1.7" debug="true" includeantruntime="false" 
               deprecation="false" optimize="false" failonerror="true">
            <src path="${src.dir}"/>
            <classpath refid="master-classpath"/>
        </javac>
    </target>

    <target name="deploy" depends="build" description="Deploy application">
        <copy todir="${deploy.path}/${name}" preservelastmodified="true">
            <fileset dir="${web.dir}">
                <include name="**/*.*"/>
            </fileset>
        </copy>
    </target>

    <target name="deploywar" depends="build" description="Deploy application as a WAR file">
        <war destfile="${name}.war"
             webxml="${web.dir}/WEB-INF/web.xml">
            <fileset dir="${web.dir}">
                <include name="**/*.*"/>
            </fileset>
        </war>
        <copy todir="${deploy.path}" preservelastmodified="true">
            <fileset dir=".">
                <include name="*.war"/>
            </fileset>
        </copy>
    </target>

<!-- ============================================================== -->
<!--                           Tomcat tasks                         -->
<!-- ============================================================== -->

    <path id="catalina-ant-classpath">
        <!-- We need the Catalina jars for Tomcat -->
        <!--  * for other app servers - check the docs -->
        <fileset dir="${appserver.lib}">
            <include name="catalina-ant.jar"/>
        </fileset>
    </path>

    <taskdef name="install" classname="org.apache.catalina.ant.DeployTask">
        <classpath refid="catalina-ant-classpath"/>
    </taskdef>
    <taskdef name="reload" classname="org.apache.catalina.ant.ReloadTask">
        <classpath refid="catalina-ant-classpath"/>
    </taskdef>
    <taskdef name="list" classname="org.apache.catalina.ant.ListTask">
        <classpath refid="catalina-ant-classpath"/>
    </taskdef>
    <taskdef name="start" classname="org.apache.catalina.ant.StartTask">
        <classpath refid="catalina-ant-classpath"/>
    </taskdef>
    <taskdef name="stop" classname="org.apache.catalina.ant.StopTask">
        <classpath refid="catalina-ant-classpath"/>
    </taskdef>

    <target name="install" description="Install application on the Tomcat Server">
        <install url="${tomcat.manager.url}"
                 username="${tomcat.manager.username}"
                 password="${tomcat.manager.password}"
                 path="/${name}"
                 war="${name}"/>
    </target>

    <target name="reload" description="Reload application on the Tomcat Server">
        <reload url="${tomcat.manager.url}"
                 username="${tomcat.manager.username}"
                 password="${tomcat.manager.password}"
                 path="/${name}"/>
    </target>

    <target name="start" description="Start Tomcat application">
        <start url="${tomcat.manager.url}"
                 username="${tomcat.manager.username}"
                 password="${tomcat.manager.password}"
                 path="/${name}"/>
    </target>

    <target name="stop" description="Stop Tomcat application">
        <stop url="${tomcat.manager.url}"
                 username="${tomcat.manager.username}"
                 password="${tomcat.manager.password}"
                 path="/${name}"/>
    </target>

    <target name="list" description="List Tomcat applications on server">
        <list url="${tomcat.manager.url}"
                 username="${tomcat.manager.username}"
                 password="${tomcat.manager.password}"/>
    </target>

<!-- End Tomcat tasks -->

<!-- ============================================================== -->
<!--                          TESTING JUNIT                         -->
<!-- ============================================================== -->

     <property name="test.dir" value="test"/>

    <path id="test-classpath">
                <fileset dir="${web.dir}/WEB-INF/lib">
                    <include name="*.jar"/>
                </fileset>
                <pathelement path="${build.dir}"/>
                <pathelement path="${test.dir}"/>
                <pathelement path="${web.dir}/WEB-INF/classes"/>
    </path>

        <target name="buildtests" description="Compile test tree java files">
            <mkdir dir="${build.dir}"/>
            <javac destdir="${build.dir}" source="1.7" target="1.7" debug="true"
                deprecation="false" optimize="false" failonerror="true">
                <src path="${test.dir}"/>
                <classpath refid="master-classpath"/>
            </javac>
        </target>

        <target name="tests" depends="build, buildtests" description="Run tests">
            <junit printsummary="on"
                fork="false"
                haltonfailure="false"
                failureproperty="tests.failed"
                showoutput="true">
                <classpath refid="test-classpath"/>
                <formatter type="brief" usefile="false"/>

                <batchtest>
                    <fileset dir="${build.dir}">
                        <include name="**/*Tests.*"/>
                        <exclude name="**/Jdbc*Tests.*"/>
                    </fileset>
                </batchtest>

            </junit>

            <fail if="tests.failed">
                tests.failed=${tests.failed}
                ***********************************************************
                ***********************************************************
                *************     Testing Found Errors!...    *************
                ***********************************************************
                ***********************************************************
            </fail>
        </target>

     <target name="dbTests" depends="build, buildtests,emptyTables,createTables,loadData" 
                description="Run db tests">
            <junit printsummary="on"
                fork="false"
                haltonfailure="false"
                failureproperty="tests.failed"
                showoutput="true">
                <classpath refid="test-classpath"/>
                <formatter type="brief" usefile="false"/>

                <batchtest>
                    <fileset dir="${build.dir}">
                        <include name="**/Jdbc*Tests.*"/>
                    </fileset>
                </batchtest>

            </junit>

            <fail if="tests.failed">
                tests.failed=${tests.failed}
                ***********************************************************
                ***********************************************************
                *************     Testing Found Errors!...    *************
                ***********************************************************
                ***********************************************************
            </fail>
        </target>

      <target name="clean" description="Clean output directories">
            <delete>                
                <fileset dir="${build.dir}">
                    <include name="**/*.class"/>
                </fileset>
            </delete>
        </target>

        <target name="undeploy" description="Un-Deploy application">
            <delete>
                <fileset dir="${deploy.path}/${name}">
                    <include name="**/*.*"/>
                </fileset>
            </delete>
        </target>

    <!-- ============================================================== -->
    <!--                          DataBase CrimeTrack                   -->
    <!-- ============================================================== -->

    <target name="createTables">
            <echo message="CREATE TABLES USING: ${db.driver} ${db.url}"/>
            <sql driver="${db.driver}"
                 url="${db.url}"
                 userid="${db.user}"
                 password="${db.pw}"
                 onerror="continue"
                 src="db/create_database_tables.sql">  
                <classpath refid="master-classpath"/>
            </sql> 
        </target>

        <target name="emptyTables">
            <echo message="EMPTY TABLES USING: ${db.driver} ${db.url}"/>
            <sql driver="${db.driver}"
                 url="${db.url}"
                 userid="${db.user}"
                 password="${db.pw}"
                 onerror="continue"
                 src="db/flush_data.sql">  
                <classpath refid="master-classpath"/>
            </sql> 
        </target>

        <target name="loadData">
            <echo message="LOAD DATA USING: ${db.driver} ${db.url}"/>
            <sql driver="${db.driver}"
                 url="${db.url}"
                 userid="${db.user}"
                 password="${db.pw}"
                 onerror="continue"
                 src="db/load_systems_tables.sql">  
                <classpath refid="master-classpath"/>
            </sql> 
        </target>

        <target name="showTables">
            <echo message="SHOW DATABASE TABLES USING: ${db.driver} ${db.url}"/>
            <sql driver="${db.driver}"
                 url="${db.url}"
                 userid="${db.user}"
                 password="${db.pw}"
                 onerror="continue"
                 print="true">  
                <classpath refid="master-classpath"/>

            SHOW TABLES;

            </sql> 
        </target>

         <target name="shutdownDb">
            <echo message="SHUT DOWN DATABASE USING: ${db.driver} ${db.url}"/>
            <sql driver="${db.driver}"
                 url="${db.url}"
                 userid="${db.user}"
                 password="${db.pw}"
                 onerror="continue">  
                <classpath refid="master-classpath"/>

            SHUTDOWN;

            </sql> 
        </target>   

</project> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T12:05:39.893

您可能应该创建执行[hotswap](https://stackoverflow.com/questions/4553353/change-a-method-at-runtime-via-a-hot-swap-mechanism)的 ant 任务。甚至还有一个[项目](http://code.google.com/p/hotswap/)可以帮助你做到这一点。或者，您可以使用 jrebel，但它是一个商业产品。

# ruby-on-rails - ActionController::Live 是否可以检查连接是否仍然存在？

> ID：14268690
> 
> 赞同：17
> 
> 时间：2013-01-10T22:47:18.190
> 
> 标签：ruby-on-rails, publish-subscribe, event-stream

我正在尝试使用 Rails 4 的实时流实现文本/事件流。它工作得很好，我遇到的唯一问题是我无法在不发送任何消息的情况下检查连接是否存在。

我想出的唯一解决方案是使用循环滴答发生器制作支持通道，以便一些后台任务会定期在那里发送消息。但它似乎是混乱和不可靠的。有更好的解决方案吗？

这是我的控制器：

```
require 'persistency/sse'
require 'persistency/track'

class PersistencyController < ApplicationController
  include ActionController::Live

  def stream
    response.headers['Content-Type'] = 'text/event-stream'

    sse = Persistency::SSE.new(response.stream)
    track = Persistency::Track.new(current_user)
    redis = Redis.new

    begin
      redis.subscribe(:info, :chat) do |on|
        on.message do |channel, message|
          sse.write({ :message => message }, :event => channel)
        end
      end
    rescue IOError
    ensure
      track.close
      sse.close
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-12T00:35:02.520

好的，我找到了两个选项：

1）有趣但不好（因为我没有得到我应该使用什么服务器来处理1000个并行连接）：

```
begin
  ticker = Thread.new { loop { sse.write 0; sleep 5 } }
  sender = Thread.new do
    redis.subscribe(:info, :chat) do |on|
      on.message do |event, message|
        sse.write(message, :event => event.to_s)
      end
    end
  end
  ticker.join
  sender.join
rescue IOError
ensure
  Thread.kill(ticker) if ticker
  Thread.kill(sender) if sender
  track.close
  sse.close
end 
```

2）真棒。使用 Goliath 服务器。事实证明，它可以在没有任何代码的情况下检查连接是否丢失。在去歌利亚的路上发现了抽筋。它很轻巧，希望很快，但似乎被放弃了。

# html - 如何在窗口调整大小时修改 HTML 的外观？

> ID：14268692
> 
> 赞同：0
> 
> 时间：2013-01-10T22:47:23.807
> 
> 标签：html, css

很简单的说我要显示一个html表格，当窗口大于900px左右时。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T22:48:52.383

您正在寻找[CSS 媒体查询](http://css-tricks.com/css-media-queries/)。

您可以使用媒体查询在较小的视口上隐藏元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T22:52:26.693

两个选项，媒体查询或 javascript。

媒体查询：

```
@media screen and (max-device-width: 900px) { ... } 
```

将您的特定代码放在该文件中以显示它。

Javascript：

```
if(document.width >= 900){ /*display content*/ } 
```

在 JS 情况下，您可能需要附加一个事件侦听器来调整窗口大小。

# algorithm - 使用重复值快速选择

> ID：14268693
> 
> 赞同：5
> 
> 时间：2013-01-10T22:47:44.803
> 
> 标签：algorithm, selection, multiset, quickselect

是否可以在多集（值可以重复）上在 O(n) 中执行搜索第 k 个元素？

因为据我了解快速选择的想法，我必须使用一些枢轴对输入进行分区。然后我有 2 个数组，我选择用于递归搜索取决于我正在搜索的索引元素 + 两个数组的大小，例如：

> 1 7 8 5 3 2 4

假设枢轴是 4 我正在搜索第二大元素。所以分区后我可能会得到类似的订单

> 1 3 2 **4** 7 8 5

因为右子数组由 3 个元素组成，如果我是正确的，我仍然会尝试在右数组中找到第二大元素？

但是，如果我以 8 作为支点，我可能会得到类似的东西

> 1 3 2 7 5 4 **8**

因此我会尝试在左表中找到最大的元素（可能是线性的，但通常我会采用左子数组并搜索元素 - (|右子数组大小| + 1)）

但是多集呢？假设我有数组：

> 4 5 6 7 7 7 4 3 2 1

我的支点是 6 搜索第三大元素，分区后我收到：

> 4 5 3 2 4 1 **6** 7 7 7

所以如果我使用上面介绍的方法，我将尝试在右子数组上执行递归，而很明显第三个最大值是左边的 5？

我想出的唯一解决方案是使用一些数据结构（如 BST、Set 等）来 O(nlogn) 过滤掉重复项。然后使用 O(n) 快速选择。但是总的来说，它会给我非线性方法，这可以线性完成吗？

* * *

我还有一个额外的问题，如果无法分配内存怎么办？我能做的就是只使用本地整数+堆栈递归。这个问题可以在 O(n) 中解决吗？因为 O(nlogn) 可以通过排序 + 线性“通过计数”来完成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T22:56:27.593

我认为这取决于您对“第 k 个最大元素”的解释。如果“第 k 个最大元素”的意思是“如果对数组中的位置 k 进行排序的元素”，那么 quickselect 将无需修改即可工作。

另一方面，如果您的意思是“数组中第 k 个最大的不同值”，那么您是正确的，未修改的快速选择将无法正常工作，如您的示例所示。但是，您可以修改算法，使其在预期的 O(n) 时间内工作，方法是将所有元素添加到哈希表中，然后遍历哈希表以获取每个不同值的副本。从那里，您可以在该生成的数组上使用普通的快速选择算法，这将需要总共 O(n) 的预期时间。

希望这可以帮助！

# google-chrome-extension - 在 Chrome 扩展程序中传递消息

> ID：14268694
> 
> 赞同：1
> 
> 时间：2013-01-10T22:47:56.177
> 
> 标签：google-chrome-extension, message-passing

我对什么算作 chrome 扩展视图感到非常困惑，它直接与我可以用来在不同组件之间传递消息的函数相关联。

让我先描述一下我要做什么；

我的 background.html 基于通过 socket.io 从 node.js 服务器接收到的一些事件创建桌面通知。

当用户单击通知时，我想在我的扩展程序（/src/view/token.html）中创建一个指向 html 的新选项卡，然后从 background.js（我的 socket.io 代码所在的位置）发送一些数据是）到新标签。我想通过消息传递来做到这一点。

所以，基本上，我在做

```
 var notification = webkitNotifications.createNotification(image, title, content);
 notification.onclick(function(e){

    chrome.tabs.create({url: "/src/view/tokens.html"}, function(tab){
        //just to make sure the tab is activated..
        chrome.tabs.onUpdated.addListener(function(tabId){
            if(tabId == tab.id) {
                chrome.tabs.sendMessage({data: whatever_data}, tabId); 
            }
        });
    });

 }); 
```

现在我的问题出在我的 tokens.js 中（在 tokens.html 中加载），我尝试使用以下命令收听消息：

```
chrome.extension.onMessage.addListener(function (msg, _, sendResponse) {
console.log(msg);
}); 
```

但我收到“未捕获的类型错误：无法读取未定义的属性‘onMessage’：，所以我假设我无权访问 tokens.html 中的 chrome.extension ？？？

我用弹出页面（浏览器操作弹出）和选项页面尝试了这个，它们都工作得很好。所以，我猜我创建的视图不是 chrome 扩展页面？

现在我很困惑...... 1）什么被认为是可以访问 chrome.* API 的 chrome 扩展页面 2）我应该如何实现我想要做的事情？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T06:09:32.853

## 代码中的问题

*   [chrome.tabs.sendMessage()](http://developer.chrome.com/extensions/tabs.html#method-sendMessage)错误的调用模式
*   由于不共享完整的代码，我假设所有页面都获得了权限，因为清单不会为某些值集[生成警告。](http://developer.chrome.com/extensions/permission_warnings.html)
*   **`notification.onclick(function`**产生 `Uncaught TypeError: Property 'onclick' of object #<Notification> is not a function`错误

**Chrome.tabs.sendMessage**

[chrome.tabs.sendMessage](http://developer.chrome.com/extensions/tabs.html#method-sendMessage) ({data:whatever_data},tabId)的调用形式；应该是[chrome.tabs.sendMessage](http://developer.chrome.com/extensions/tabs.html#method-sendMessage) (tabId,{"data": "whatever_data"}); ***（标签 ID 后跟消息）。***

**通知.onclick（功能**

对 onclick 属性使用`notification.onclick = (function(`分配处理程序***（因为它不是函数）***

解决上述问题后，我让您的脚本运行。

### 清单.json

注册后台脚本并授予所需的所有权限。

```
{
    "name": "Message Passing",
    "description": "This is used as a message passing",
    "version": "1",
    "manifest_version": 2,
    "background": {
        "scripts": [
            "background.js"
        ]
    },
    "permissions": [
        "notifications",
        "tabs"
    ]
} 
```

### 背景.js

修改代码以消除错误

```
//Created Notification
var notification = webkitNotifications.createNotification("icon.jpg", "title", "content");
//Added onclick property
notification.onclick = (function (e) {
    //Created new tab
    chrome.tabs.create({
        url: "/src/view/notification.html"
    }, function (tab) {
        //just to make sure the tab is activated..
        chrome.tabs.onUpdated.addListener(function (tabId) {
            if (tabId == tab.id) {
                //Send Mesage
                chrome.tabs.sendMessage(tabId, {
                    "data": "whatever_data"
                });
            }
        });
    });
});
notification.show(); 
```

### 通知.html

确保没有`inline script`或`<script>`标签符合[CSP](http://developer.chrome.com/extensions/contentSecurityPolicy.html)。

```
<html>

    <head>
        <script src="notification.js">

        </script>
    </head>

    <body>
        <p>This is a notification</p>
    </body>

</html> 
```

### 通知.js

使用您的脚本没有任何变化！

```
chrome.extension.onMessage.addListener(function (msg, _, sendResponse) {
    console.log(JSON.stringify(msg));
}); 
```

# 输出

您可以在新的 中看到收到的消息`tab`。

![在此处输入图像描述](../Images/336baefb824753487db00012f76c1b36.png)

# 参考

*   [CSP](http://developer.chrome.com/extensions/contentSecurityPolicy.html)
*   [桌面通知](http://developer.chrome.com/extensions/notifications.html)
*   [chrome.tabs.sendMessage](http://developer.chrome.com/extensions/tabs.html#method-sendMessage)
*   [chrome.extension.onMessage](http://developer.chrome.com/extensions/extension.html#event-onMessage)

# ajax - CORS - Ajax 错误函数将返回 401 的 API 请求的错误代码报告为 0

> ID：14268706
> 
> 赞同：9
> 
> 时间：2013-01-10T22:48:54.277
> 
> 标签：ajax, jquery, cors

## 背景

身份验证 (JWT) 成功后，我在本地开发环境中使用了 CORS。我的客户端页面从 localhost 运行并调用 api.mycompany.com 获取数据。我的 api 项目检查有效的 JWT，如果通过，则返回内容。我花了一段时间才到这里，但这一切都很好。

如果我没有发送有效的 JWT，api 会正确响应 401（在 Fiddler 中检查过），但客户端上的错误函数回调会报告错误代码 0 和“错误”状态。

我希望 ajax 回调函数检查错误的状态代码，如果是 401，请检查名为 location 的标头的标头（它将包含身份验证服务的 uri）。

## 设置

*   （API 项目）在本地 IIS Express 上运行 MVC4 项目的 Visual Studio 2012 实例

    *   本地主机文件将 127.0.0.1 映射到 api.mycompany.com
    *   将项目 -> 属性 -> Web 设置为 IIS Express
        *   使用本地 IIS Express（选中）
        *   项目网址：`http://localhost:8080`
        *   创建虚拟目录
        *   覆盖应用程序根 URL（选中）
        *   覆盖应用程序根 URL：`http://api.mycompany.com:8080`
    *   在站点下的 applicationhost.config 中：

        ```
        <site name="StuffManagerAPI" id="1">
          <application path="/" applicationPool="Clr4IntegratedAppPool">
            <virtualDirectory path="/" physicalPath="C:\Users\me\Documents\Visual Studio 2012\Projects\StuffManagerAPI\StuffManagerAPI" />
          </application>
          <bindings>
            <binding protocol="http" bindingInformation="*:8080:localhost" />
            <binding protocol="http" bindingInformation="*:8080:api.mycompany.com" />
          </bindings>
        </site> 
        ```

*   （客户端项目）使用 ASP.net 空 Web 应用程序分离 Visual Studio 实例

    *   将项目 -> 属性 -> Web 设置为 IIS Express
        *   使用本地 IIS Express（选中）
        *   项目网址：`http://localhost:22628`
        *   创建虚拟目录
*   使用谷歌浏览器作为测试客户端

*   使用 Fiddler 查看流量

## 代码

我认为这些应该是我的概念证明中的重要部分。再一次，CORS 预检和数据检索都可以正常工作。只是未经授权的案例不起作用。如果您还需要什么，请告诉我。谢谢您的帮助。

### API项目

**授权标头处理程序**

```
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Http;
using System.Threading.Tasks;

namespace StuffManagerAPI.Handlers
{
public class AuthorizationHeaderHandler : DelegatingHandler
{
    private const string KEY = "theKey";

    protected override Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, System.Threading.CancellationToken cancellationToken)
    {
        var taskCompletionSource = new TaskCompletionSource<HttpResponseMessage>();

        const string identityProviderUri = "https://idp.mycompany.com";

        IEnumerable<string> apiKeyHeaderValues = null;
        if (request.Headers.TryGetValues("Authorization", out apiKeyHeaderValues))
        {
            var apiKeyHeaderValue = apiKeyHeaderValues.First();
            var token = apiKeyHeaderValue.Split(' ').LastOrDefault();
            var tokenProcessor = new JasonWebTokenDecryptor.JasonWebToken(token, KEY);

            if (tokenProcessor.IsValid)
            {
                base.SendAsync(request, cancellationToken).ContinueWith(t => taskCompletionSource.SetResult(t.Result));
            }
            else
            {
                var response = FailedResponseWithAddressToIdentityProvider(identityProviderUri);
                taskCompletionSource.SetResult(response);
            }

        }
        else
        {
            if(request.Method.Method != "OPTIONS")
            {
                //No Authorization Header therefore needs to redirect
                var response = FailedResponseWithAddressToIdentityProvider(identityProviderUri);
                taskCompletionSource.SetResult(response);
            }
            else
            {
                base.SendAsync(request, cancellationToken).ContinueWith(t => taskCompletionSource.SetResult(t.Result));
            }
        }

        return taskCompletionSource.Task;
    }

    private static HttpResponseMessage FailedResponseWithAddressToIdentityProvider(string identityProviderUri)
    {
        // Create the response.
        var response = new HttpResponseMessage(HttpStatusCode.Unauthorized);
        response.Headers.Add("Location", identityProviderUri);
        return response;
    }
}
} 
```

**东西控制器**

```
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Web.Http;
using StuffManagerAPI.Attributes;
using StuffManagerAPI.Models;

namespace StuffManagerAPI.Controllers
{
[HttpHeader("Access-Control-Allow-Origin", "*")]
[HttpHeader("Access-Control-Allow-Methods", "OPTIONS, HEAD, GET, POST, PUT, DELETE")]
[HttpHeader("Access-Control-Allow-Headers", "Authorization")]
[HttpHeader("Access-Control-Expose-Headers", "Location")]
public class StuffController : ApiController
{
    private readonly Stuff[] _stuff = new[]
        {
            new Stuff
                {
                    Id = "123456",
                    SerialNumber = "112233",
                    Description = "Cool Item"
                },
            new Stuff
                {
                    Id = "456789",
                    SerialNumber = "445566",
                    Description = "Another Cool Item"
                }
        };

    public Stuff Get(string id)
    {
        var item = _stuff.FirstOrDefault(p => p.Id == id);
        if (item == null)
        {
            throw new HttpResponseException(HttpStatusCode.NotFound);
        }

        return item;
    }

    public IEnumerable<Stuff> GetAll()
    {
        return _stuff;
    }

    public void Options()
    {
       // nothing....
    }

}
} 
```

### 客户项目

**main.html**

```
<!DOCTYPE html>
<html lang="en">
<head>
    <title>ASP.NET Web API</title>
    <link href="../Content/Site.css" rel="stylesheet" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.js"></script>

    <script type="text/javascript">
        var baseUrl = "http://api.mycompany.com:8080/api/";
        $.support.cors = true;

        $(document).ready(
            getListofStuff()
        );

        function setHeader(xhr) {
            xhr.setRequestHeader('authorization', 'Bearer blah.blah.blah');
        }

        function getListofStuff() {
            var apiUrl = baseUrl + "stuff/";

            $.ajax({
                url: apiUrl,
                type: 'GET',
                dataType: 'json',
                crossDomain: true,
                success: receivedListOfStuff,
                error: receiveError,
                beforeSend: setHeader,
                statusCode: {
                    0: function() {
                        alert('got 0');
                    },
                    401: function () {
                        alert('finally got a 401');
                    }
                }
            });
        }

        function getIndividualPieceOfStuff(id) {
            var apiUrl = baseUrl + "stuff/" + id;

            $.ajax({
                url: apiUrl,
                type: 'GET',
                dataType: 'json',
                crossDomain: true,
                success: receivedIndividualStuffItem,
                error: receiveError,
                beforeSend: setHeader
            });
        }

        function receivedListOfStuff(data) {
            $.each(data, function (key, val) {

                var listItem = $('<li/>').text(val.Description);
                listItem.data("content", { id: val.Id});
                $(".myStuff").prepend(listItem);
            });

            $(".myStuff li").click(function () {
                getIndividualPieceOfStuff($(this).data("content").id);
            });
        }

        function receivedIndividualStuffItem(data) {
            $("#stuffDetails #id").val(data.Id);
            $("#stuffDetails #serialNumber").val(data.SerialNumber);
            $("#stuffDetails #description").val(data.Description);
        }

        function receiveError(xhr, textStatus, errorThrown) {
            var x = xhr.getResponseHeader("Location");
            var z = xhr.responseText;

            if (xhr.status == 401){
                alert('finally got a 401');
               }

            alert('Error AJAX');
        }
    </script>

</head>
<body>
.
.
.
.
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T15:57:43.967

我终于弄明白了。在 Authorization Header Handler 中，当 tokenProcessor.IsValid 为 false 时，我跳转到 FailedResponseWithAddressToIdentityProvider 然后立即设置结果并将任务标记为完成。因此，我从不访问 Stuff Controller 并添加访问控制标头：

```
if (tokenProcessor.IsValid)
{
    base.SendAsync(request, cancellationToken).ContinueWith(t => taskCompletionSource.SetResult(t.Result));
}
else
{
    var response = FailedResponseWithAddressToIdentityProvider(identityProviderUri);
            taskCompletionSource.SetResult(response);
}
.
.
.
private static HttpResponseMessage FailedResponseWithAddressToIdentityProvider(string identityProviderUri)
{
    // Create the response.
    var response = new HttpResponseMessage(HttpStatusCode.Unauthorized);
    response.Headers.Add("Location", identityProviderUri);
    return response;
} 
```

}

可能有更好的方法来做到这一点，但我只是在 FailedResponseWithAddressToIdentityProvider 方法中将标题添加到我的响应中，浏览器最终在 Chrome、Firefox 和 IE8 中看到了 401。这是更改：

```
private static HttpResponseMessage FailedResponseWithAddressToIdentityProvider(string identityProviderUri)
{
    // Create the response.
    var response = new HttpResponseMessage(HttpStatusCode.Unauthorized);
    response.Headers.Add("Location", identityProviderUri);
    response.Headers.Add("Access-Control-Allow-Origin", "*");
    response.Headers.Add("Access-Control-Allow-Methods", "OPTIONS, HEAD, GET, POST, PUT, DELETE");
    response.Headers.Add("Access-Control-Allow-Headers", "Authorization");
    response.Headers.Add("Access-Control-Expose-Headers", "Location");
    return response;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T05:12:32.237

而是直接在 ajax 上检查状态代码，您可以使用此代码在 onComplete 上检查...

```
> $.ajaxSetup({
>     error: function (x) {     
>         if (x.status == 401) {
>             alert("401");
>         }
>     } }); 
```

# java - 在java中的运行时向面板添加元素

> ID：14268712
> 
> 赞同：1
> 
> 时间：2013-01-10T22:49:28.610
> 
> 标签：java, swing, layout, constructor, jpanel

> **可能重复：**
> [如何将 JLabels 动态添加到 JPanel？](https://stackoverflow.com/questions/14030124/how-to-dynamically-add-jlabels-to-jpanel)

我创建了一个面板并为其使用了网格布局。

> ```
> public pnlFriends() {
>     initComponents();
>     this.setLayout(new GridLayout(10,1));
>    // showFriends();
> 
> }
> 
> private void formComponentShown(java.awt.event.ComponentEvent evt) {
>     showFriends();
>     System.out.print("comp");
> }
> 
>    private void showFriends()
>    {
>     //Integer id = NewMain.network.getEdges().get(Main.uuid).getDegree();
>     for(int i = 0;i < 10 ;i++)
>     {
> 
>         String name = "as";
>         String occupation ="adf";
>         String place = "asdf";
>         Integer connections = 5;
>         this.add(displayMiniProfile(name,occupation,place,connections));
>     }
> } 
> ```

返回`displayMiniProfile`一个JPanel。

现在，当我在父 JPanel 的构造函数中调用此函数时，它可以工作，我可以添加 MiniProfile JPanel。

但是，当我在`componentshown`事件响应中调用此函数时，它不会显示任何内容。

**为什么 ？**

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T23:31:16.110

没有显示任何内容，因为在`JPanel`添加新面板后仍未验证。你需要打电话

```
revalidate();
repaint(); 
```

打电话后

```
this.add(displayMiniProfile(name,occupation,place,connections)); 
```

# ruby - 使用 Heroku 在应用程序之间共享消息队列

> ID：14268716
> 
> 赞同：2
> 
> 时间：2013-01-10T22:49:47.227
> 
> 标签：ruby, heroku, message-queue, sidekiq

我有两个 Web 应用程序，都托管在 Heroku 上。一个是前端应用程序，从某种意义上说，所有面向消费者的操作都将通过这个应用程序。新注册等。另一个是后端，它处理新客户、他们的订单和相关业务逻辑的所有处理。我需要这些应用程序相互通信并在它们之间传递数据。我宁愿不在 BE 应用程序上编写 api，因为只有 FE 应用程序会使用它，这意味着我需要花时间编写安全规则和限制以防止其他人访问它。

我的问题是我是否可以在它们之间使用共享消息队列，这是否是一个好主意，以及在 Heroku 上是否可行？此用例是否存在附加组件/服务？列出的大多数排队插件在同一个应用程序中都有工作人员和任务创建者。

我一直在将 Sidekiq 视为一种可能性，因为 BE 应用程序无论如何都需要一个队列来处理其他任务，这似乎是一个很好的候选者，但我不确定即使我在应用程序之间提供了一个共享的 Redis 实例, Sidekiq 有能力在它们之间传递消息。有人知道吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T23:24:44.047

我在 Heroku 上使用[AMQP取得了很大的成功。](http://www.amqp.org/)有一个可用的 heroku 插件（[CloudAMQP](http://www.cloudamqp.com/)）和对 AMQP 的[良好 ruby​​ 支持](http://rubyamqp.info/)。

一般来说，在 Heroku 上提供此类服务时，我一直在 Heroku 主应用程序中提供插件，并与其他应用程序共享环境配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T02:13:01.083

Sidekiq 在像您这样的分布式环境中运行良好。由于处理作业所需的所有信息都驻留在 1 个 Redis 服务器中，因此您可以让尽可能多的服务器处理任何类型的作业。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-22T22:18:55.097

如果每个应用程序都有自己的 Redis 连接，您可以通过设置另一个连接从一个应用程序推送到另一个 Sidekiq 环境：

```
class RemoteWorker
  cattr_writer :client

  def self.push(worker_class_name, args, queue = 'default')
    client.push(
      'args' => [args],
      'class' => worker_class_name,
      'queue' => queue,
    )
  end

  def self.client
    @@client or raise 'Make sure to set client to Sidekiq::Client'
  end
end 
```

然后从配置它`config/initializers/remote_worker.rb`

```
redis_config = YAML.load_file(Rails.root.join('config', 'redis.OTHER.yml'))[Rails.env]
redis = Redis.new(redis_config)
RemoteWorker.client = Sidekiq::Client.new(ConnectionPool.new{ redis }) 
```

# .net - 是否可以反汇编 monomac 文件？

> ID：14268717
> 
> 赞同：2
> 
> 时间：2013-01-10T22:49:46.743
> 
> 标签：.net, osx-mountain-lion, monomac, disassembly

我正在尝试使用 .NET Reflactor 应用程序反汇编我的 monomac .net 可执行文件，但它似乎只识别 Windows 可执行文件。

是否有任何应用程序/插件可以使这个东西工作？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T15:33:28.303

.NET reflector works on any .NET executable (.exe) or library (.dll). A MonoMac-based application will produce them (they are the output of the C#, or any other .NET, compiler) so **it will work too**.

OTOH MonoMac also produce an application bundle (a `.app` directory) and a **native** *wrapper* launcher (that replaces `mono` to launch the `.exe`). Other **native** libraries can also be included into the application bundle (so the application can be redistributed without dependencies).

Those **native** files (and directories) are not .NET executable and .NET reflector (or similar tools) won't be able to process them.

# events - 返回 Facebook 活动场地数据（城市、州、街道、邮编等）

> ID：14268719
> 
> 赞同：0
> 
> 时间：2013-01-10T22:49:53.180
> 
> 标签：events, facebook-graph-api, facebook-fql

我正在尝试将即将发生的事件从 Facebook 页面列出到网站。[这篇文章](http://autobotcode.blogspot.com/2012/10/display-facebook-page-events-using-graph-api-and-fql.html) 让我达到了 95%。

这是我的 FQL 查询：

```
SELECT name,start_time,end_time,location,venue,venue.city,venue.street,eid FROM event WHERE eid IN ( SELECT eid FROM event_member WHERE uid = 137235173013656 AND start_time >= '$now') ORDER BY start_time asc LIMIT 0, 5 
```

不幸的是，这个事件的场地数组似乎只返回一个 ID：

```
"data": [
  {
    "name": "Party for the Rest of Us 8", 
    "start_time": "2013-02-01T19:00:00-0500", 
    "end_time": null, 
    "location": "The Renaissance Ballroom", 
    "venue": {
      "id": 102464129826400
    }, 
    "eid": 365130383585238
  }
] 
```

这对我来说似乎很奇怪，b/c 当我创建事件时，它会自动完成到具有城市和州的[已知位置。](https://www.facebook.com/pages/The-Renaissance-Ballroom/102464129826400)

我无法手动输入活动的位置信息。

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T00:17:04.297

Facebook 于 2012 年 5 月开始改变 API 返回场地的方式。此后创建的一些场地仅返回 ID。`page`您可以通过对表执行多重查询并在脚本中重新组装它们来获得这些的完整地址。

这个查询应该让你开始：

```
{
  "q_events":
    "SELECT name,start_time,end_time,location,venue,eid FROM event WHERE eid = 365130383585238",
  "q_venues":
    "SELECT page_id, name, location FROM page WHERE page_id IN 
       (SELECT venue.id FROM #q_events)"
} 
```

# gwt - 到 phoneGap 的 GWT 应用程序在没有 phoneGap 的情况下工作 Javascript 包括

> ID：14268721
> 
> 赞同：0
> 
> 时间：2013-01-10T22:50:08.280
> 
> 标签：gwt, cordova

我创建了一个简单的 GWT UI 并对其进行编译，将生成的 javascript 放到我的 android 应用程序上并运行它。一切正常，然后我注意到我实际上并没有在我的 HTML 页面中包含 cordova.2.2.0.js 文件，但 UI 在我的手机上仍然显示正常。这怎么样？那么cordova2.2.0.js javascript文件需要什么？我的应用程序确实只包含几个按钮和文本框，所以也许简单的东西可以开箱即用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T02:10:01.343

cordova.js 负责本地电话 API 访问，如存储、摄像头等。因此，如果没有它，您将不会收到设备事件，也无法访问设备本机功能。

# javascript - 转到网站上的不同页面时是否可以不重新启动 setTimeout？

> ID：14268722
> 
> 赞同：0
> 
> 时间：2013-01-10T22:50:21.323
> 
> 标签：javascript, cookies

如果我在网站标题的脚本中设置了 setTimeout，则可以让它在用户从一个页面转到另一个页面时继续运行而无需重新启动。这是我可以使用 cookie 来做的事情吗？有什么我可以看的例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:00:32.813

你有两个选择。

*   将 GET 查询添加到 URL 字符串。这看起来像 www.ex.com/index.html?time=300024

您将捕获所有锚标记的点击，如果它指向您自己的网站，它会将 ?time=${time} 附加到 url。然后，在下一页，在初始化计时器时，在 location.search 中分离出时间在下一页。请注意，此方法不会保持准确的时间，因为在加载页面和 DOM 时会有延迟。

[从 javascript 的 location.search 获取参数](https://stackoverflow.com/questions/523266/how-can-i-get-a-specific-parameter-from-location-search)

*   通过ajax加载网站内容

这样，您将完全重新设计您的网站，以便任何指向您网站内部部分的链接实际上都将使用 AJAX 来查询新内容。这意味着您永远不会更改页面本身，并且永远不会卸载 javascript 超时。这不是最推荐的做法。这是一个基本示例：

[一个简单的带有 jQ​​uery 的 AJAX 网站](http://tutorialzine.com/2009/09/simple-ajax-website-jquery/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T00:00:31.333

使用 localStorage 保存状态。

设置您的常规 setTimeout。当它启动时，让它从 localStorage 加载它需要的任何状态数据。每当它更新数据时，它应该将其保存回 localStorage 以保持持久性。

如果您需要有关如何执行此操作的具体细节，请留下您的问题的评论，我会尽力回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T00:24:35.833

使用会话 cookie 来保存您希望 setTimeout 代码执行的时间。

在每一页上：

*   检查 cookie 是否有值。如果没有，请将其设置为类似`Date.now() + delayValue`，其中 delayValue 是等待多长时间（以毫秒为单位）。
*   检查`cookieValue - Date.now()`-- 如果 > 0，将其用作您的 setTimeout 计时器值。如果 <= 0，您的计时器功能应该已经运行

# wordpress - 使用 Zend Framework 应用程序重定向到 Wordpress 文件夹

> ID：14268726
> 
> 赞同：1
> 
> 时间：2013-01-10T22:50:40.380
> 
> 标签：wordpress, .htaccess, zend-framework

我有一个 ZF1.11.12 应用程序，它在共享主机上的 /public/blog 上安装了 Wordpress。我正在使用 .htaccess 将所有请求重定向到 /public：

```
RewriteEngine On

# Exclude some directories from URI rewriting
#RewriteRule ^(dir1|dir2|dir3) - [L]

RewriteRule ^\.htaccess$ - [F]

RewriteCond %{REQUEST_URI} =""
RewriteRule ^.*$ /public/index.php [NC,L]

RewriteCond %{REQUEST_URI} !^/public/.*$
RewriteRule ^(.*)$ /public/$1

RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^.*$ - [NC,L]

RewriteRule ^public/.*$ /public/index.php [NC,L] 
```

在公用文件夹中，我使用第二个 .htaccess 将所有请求定向到 index.php（根据标准 ZF 约定）将请求保存到两个目录 - /blog 和 /app。代码如下：

```
SetEnv APPLICATION_ENV production
SetEnv MAGIC_QUOTES 0
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]

RewriteRule ^blog - [NC,L]
RewriteRule ^app - [NC,L]

RewriteRule ^.*$ index.php [NC,L] 
```

一切似乎都正常运行，除了

1.  当我导航到我的 WP 登录页面（/blog/wp-login.php）时，它通过 ZF 路由并抛出 404 异常（控制器不正确）
2.  当我导航到 /blog 时，我被重定向到 /blog/blog/ 但是当我导航到 /blog/ （带有斜杠）时，我正确地发送了博客主页。对所有其他 WP 帖子的请求都可以正常工作。

更令人困惑的是，我在本地环境中访问我的 wp 登录没有问题。任何帮助，将不胜感激！网址是 www.lajollabluebook.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-20T20:18:03.947

我目前正在将我们的 WP 站点与 Zend 1.11 一起添加。我已将 WP 站点添加到`public/about/`（对于我们的案例）。

我不必接触 Zend`.htaccess`文件`public/`（使用已经存在的文件，其中没有提及我们的新`about`目录）。

在 WP`.htaccess`文件 ( `public/about/`) 中，我编辑`RewriteBase`了`RewriteRule`以下内容：

```
 RewriteBase /about/
 RewriteRule . /about/index.php [L] 
```

我可以在 [url]/about/[the-rest-of-WP-site] 下的 WP 网站上到处走走。*我想我必须删除缓存或 cookie 或其他东西才能正常工作（不记得了）*。

希望有帮助。

# ruby-on-rails-3 - Rails：邮件中的电子邮件确认 RESTful (PUT) URL

> ID：14268729
> 
> 赞同：2
> 
> 时间：2013-01-10T22:50:52.573
> 
> 标签：ruby-on-rails-3, rest, routes, put, email-confirmation

从头开始滚动我自己的电子邮件确认。苦苦思索如何为我的`confirmations_controller`.

新用户会收到一封电子邮件，其中包含返回应用程序以“验证”地址的链接。

我的想法是它应该是一个 PUT 操作，因为它将对数据库进行更改。但是，单击电子邮件中的链接不会提交“放置”操作……还是会？除了我自己的无知之外，我一定是错过了什么。

```
#config/routes.rb
...
resources :confirmations, only: [:update] 
```

`confirmation_url(user.email_token)`生成有效的 url:`http://localhost:3000/confirmations/ArELEOejYlqbRXdJPavhrp`但是当点击该链接时，它会被应用程序接收为“获取”请求。

我应该如何处理这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:05:58.483

你的电子邮件是什么格式的？如果是纯文本，它将是一个 GET。这本身不是更新激活页面的问题。您还可以打开一个页面（使用 GET）并让他们单击一个按钮以进行最终提交（并不罕见）。

但是，通过 GET 进行更新不会因为这个特定的功能而困扰我。

例子：

```
# routes.rb
get 'confirmations/:id/confirm' => 'Confirmations#confirm'

# confirmations.rb
class ConfirmationsController < ApplicationController

  def confirm
    # handle the get data here (switch aa flag for the email account)       
   end
end 
```

# c# - Windows 窗体设计器和对旧代码重构项目的影响

> ID：14268730
> 
> 赞同：1
> 
> 时间：2013-01-10T22:50:52.737
> 
> 标签：c#, winforms, dojo, refactoring

所以 - 我正在处理一个 150 万多行的大型代码库 UI 是使用 Windows 窗体设计器创建的 应用程序当前是一个桌面应用程序 我正在尝试将应用程序重建为一个 Web 应用程序 我找到了一个应该做的技术堆栈技巧 堆栈包括一个 .Net 后端、一个 DOJO UI 和一个 MS MVC 架构

问题 - 在查看了可用于这种转换的各种产品之后，我们还没有发现任何看起来很匹配的东西 从头开始​​编写所有内容 - 即使只是 UI 也是不可行的

现状 - 从商业角度来看，一次性完成这项工作的大爆炸式解决方案存在两个风险现在下来

我们目前的方法 - 我们正在考虑尝试构建一个自定义工具，将 Windows 窗体设计器生成的代码转换为使用 DOJO 库而不是 MS 原生东西生成的等效 UI - 主要是因为 MVC 似乎太不成熟

问题 - 我们如何在程序上解析 Windows 窗体设计器输出，以便我们可以遍历给定显示中存在的 UI 元素，以便我们可以识别它们并从我们选择的目标库中选择类似的元素。

我认为这个问题与“是否有允许以编程方式解析 Windows 窗体设计器输出的 SDK？”的问题相同。

我从高层次上查看了 VS Studio SDK，并确信这是错误的答案，但我可能弄错了。请告知 - 问候。

所以必须这样做的原因是因为当前的部署范式非常昂贵。我无法详细说明，因为这都是专有的，但简而言之 - 当前状态的应用程序必须部署在 Citrix 上，并且服务器成本在每月 10k 范围内运行。这是这样做的重大经济动机。我也知道重写的成本通常在 4 美元/LOC 范围内……这将非常昂贵——比如 400 万美元。这也已经完成，所以问题归结为 - 在考虑劳动力成本的同时，我怎样才能做到最便宜。使用网络服务器提供应用程序预计可将所需的服务器数量减少大约 95%。当前负载所经历的性能已经在推动合同 QOS 要求。

不这样做是一种逃避——这确实需要发生，尽管也许以这种方式处理问题并不是正确的方法。还有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T04:52:58.700

如果您的问题需要进行大规模更改，您可能会考虑使用自动更改工具，例如[程序转换](http://en.wikipedia.org/wiki/Program_transformation) 系统 (PTS)。此类工具提供了为任意语言（和/或 WFD 等不寻常的工件）定义解析器的方法，并对代码进行可靠的更改。

它们旨在解决 4 美元/行的手动代码转换成本（实际上比这更高），以及每天 200 行（比 Gartner 引用的手动转换每天 140 行）需要 25人年来完成这项工作。

PTS 需要相当大小的代码库才能实现规模经济，但您似乎拥有这一点。他们解决了通常被认为难以手工完成的问题。

我不确定他们会根据你的描述完成这项工作，但你应该看看。

披露：我是其中一种工具的提供者。

# php - SimpleXML PHP 解析 OCR XML 文档

> ID：14268731
> 
> 赞同：2
> 
> 时间：2013-01-10T22:50:55.820
> 
> 标签：php, simplexml

假设我有这个 XML 文档，（实际上是一个包含 OCR 文档结果的 XML 文件：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<document xmlns="http://www.abbyy.com/FineReader_xml/FineReader10-schema-v1.xml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.abbyy.com/FineReader_xml/FineReader10-schema-v1.xml http://www.abbyy.com/FineReader_xml/FineReader10-schema-v1.xml" version="1.0" producer="ABBYY FineReader Engine 11" languages="">
<page width="317" height="387" resolution="96" originalCoords="1">
<block blockType="Text" l="132" t="18" r="302" b="98"><region><rect l="132" t="18" r="302" b="71"/><rect l="195" t="71" r="302" b="98"/></region>
<text>
<par align="Right">
<line baseline="36" l="179" t="20" r="299" b="36"><formatting lang="EnglishUnitedStates">
<charParams l="179" t="20" r="199" b="36">W</charParams>
<charParams l="201" t="20" r="210" b="36">h</charParams>
<charParams l="212" t="24" r="223" b="36">a</charParams>
<charParams l="223" t="21" r="229" b="36">t</charParams>
<charParams l="230" t="20" r="236" b="36"> </charParams>
<charParams l="237" t="20" r="253" b="36">M</charParams>
<charParams l="255" t="24" r="266" b="36">a</charParams>
<charParams l="267" t="20" r="277" b="36">k</charParams>
<charParams l="278" t="24" r="288" b="36">e</charParams>
<charParams l="289" t="24" r="299" b="36">s</charParams></formatting></line></par>
<par align="Justified">
<line baseline="68" l="134" t="42" r="299" b="69"><formatting lang="EnglishUnitedStates">
<charParams l="134" t="42" r="160" b="68">Y</charParams>
<charParams l="155" t="48" r="175" b="69">o</charParams>
<charParams l="177" t="49" r="197" b="69">u</charParams>
<charParams l="200" t="48" r="213" b="68">r</charParams>
<charParams l="214" t="42" r="221" b="68"> </charParams>
<charParams l="222" t="42" r="246" b="68">V</charParams>
<charParams l="244" t="48" r="264" b="69">o</charParams>
<charParams l="264" t="43" r="278" b="68">t</charParams>
<charParams l="278" t="48" r="299" b="69">e</charParams></formatting></line></par>
<par>
<line baseline="95" l="197" t="76" r="299" b="96"><formatting lang="EnglishUnitedStates">
<charParams l="197" t="76" r="218" b="95">M</charParams>
<charParams l="220" t="81" r="234" b="96">a</charParams>
<charParams l="235" t="77" r="245" b="96">t</charParams>
<charParams l="245" t="77" r="256" b="96">t</charParams>
<charParams l="257" t="81" r="272" b="96">e</charParams>
<charParams l="274" t="81" r="284" b="95">r</charParams>
<charParams l="285" t="76" r="299" b="95">?</charParams></formatting></line></par>
</text>
</block>
<block blockType="Text" l="25" t="83" r="155" b="281"><region><rect l="25" t="83" r="155" b="281"/></region>
<text>
<par align="Justified">
<line baseline="276" l="26" t="82" r="154" b="278"><formatting lang="EnglishUnitedStates">
<charParams l="26" t="82" r="154" b="278">9</charParams></formatting></line></par>
</text>
</block>
<block blockType="Text" l="73" t="288" r="107" b="322"><region><rect l="73" t="288" r="107" b="322"/></region>
<text>
<par lineSpacing="-1"></par>
</text>
</block>
<block blockType="Text" l="25" t="327" r="136" b="356"><region><rect l="25" t="327" r="136" b="356"/></region>
<text>
<par lineSpacing="1050">
<line baseline="337" l="27" t="328" r="109" b="337"><formatting lang="EnglishUnitedStates">
<charParams l="27" t="328" r="32" b="337">F</charParams>
<charParams l="33" t="328" r="35" b="337">i</charParams>
<charParams l="36" t="330" r="42" b="337">n</charParams>
<charParams l="42" t="329" r="49" b="337">d</charParams>
<charParams l="50" t="329" r="52" b="337"> </charParams>
<charParams l="53" t="330" r="59" b="337">o</charParams>
<charParams l="60" t="331" r="66" b="337">u</charParams>
<charParams l="66" t="329" r="69" b="337">t</charParams>
<charParams l="70" t="329" r="73" b="337"> </charParams>
<charParams l="74" t="329" r="79" b="337">h</charParams>
<charParams l="80" t="331" r="86" b="337">o</charParams>
<charParams l="87" t="331" r="95" b="337">w</charParams>
<charParams l="96" t="330" r="98" b="337"> </charParams>
<charParams l="99" t="330" r="105" b="337">a</charParams>
<charParams l="106" t="329" r="109" b="337">t</charParams></formatting></line>
<line baseline="351" l="31" t="341" r="133" b="353"><formatting lang="EnglishUnitedStates">
<charParams l="31" t="343" r="42" b="351" suspicious="1">m</charParams>
<charParams l="44" t="343" r="50" b="351">a</charParams>
<charParams l="51" t="341" r="56" b="351">t</charParams>
<charParams l="57" t="341" r="64" b="351">h</charParams>
<charParams l="66" t="343" r="72" b="351">a</charParams>
<charParams l="74" t="344" r="84" b="351">w</charParams>
<charParams l="85" t="343" r="92" b="351">a</charParams>
<charParams l="94" t="344" r="98" b="351">r</charParams>
<charParams l="99" t="343" r="106" b="351">e</charParams>
<charParams l="107" t="348" r="110" b="351">.</charParams>
<charParams l="111" t="343" r="119" b="351">o</charParams>
<charParams l="120" t="344" r="125" b="351">r</charParams>
<charParams l="125" t="343" r="133" b="353">g</charParams></formatting></line></par>
</text>
</block>
<block blockType="Text" l="6" t="364" r="312" b="376"><region><rect l="6" t="364" r="312" b="376"/></region>
<text>
<par align="Justified">
<line baseline="372" l="7" t="365" r="309" b="374"><formatting lang="EnglishUnitedStates">
<charParams l="7" t="365" r="14" b="372">M</charParams>
<charParams l="15" t="367" r="19" b="372">a</charParams>
<charParams l="19" t="366" r="22" b="372">t</charParams>
<charParams l="23" t="366" r="27" b="372">h</charParams>
<charParams l="27" t="367" r="33" b="372">e</charParams>
<charParams l="33" t="367" r="40" b="372">m</charParams>
<charParams l="40" t="367" r="45" b="372">a</charParams>
<charParams l="45" t="366" r="48" b="372">t</charParams>
<charParams l="48" t="365" r="50" b="372">i</charParams>
<charParams l="50" t="367" r="55" b="372">c</charParams>
<charParams l="55" t="367" r="60" b="372">s</charParams>
<charParams l="61" t="365" r="62" b="372"> </charParams>
<charParams l="62" t="365" r="68" b="372">A</charParams>
<charParams l="68" t="367" r="75" b="372">w</charParams>
<charParams l="75" t="367" r="80" b="372">a</charParams>
<charParams l="80" t="367" r="83" b="372">r</charParams>
<charParams l="83" t="367" r="88" b="372">e</charParams>
<charParams l="88" t="367" r="93" b="372">n</charParams>
<charParams l="93" t="367" r="98" b="372">e</charParams>
<charParams l="98" t="367" r="103" b="372">s</charParams>
<charParams l="103" t="367" r="107" b="372">s</charParams>
<charParams l="108" t="365" r="109" b="372"> </charParams>
<charParams l="110" t="365" r="117" b="372">M</charParams>
<charParams l="118" t="367" r="123" b="372">o</charParams>
<charParams l="123" t="367" r="127" b="372">n</charParams>
<charParams l="128" t="366" r="131" b="372">t</charParams>
<charParams l="131" t="365" r="136" b="372">h</charParams>
<charParams l="137" t="365" r="138" b="372"> </charParams>
<charParams l="139" t="367" r="143" b="370">â€¢&lt;/charParams>
<charParams l="144" t="365" r="145" b="372"> </charParams>
<charParams l="146" t="365" r="152" b="372">A</charParams>
<charParams l="151" t="367" r="157" b="374">p</charParams>
<charParams l="157" t="367" r="162" b="372">n</charParams>
<charParams l="162" t="366" r="164" b="372" suspicious="1">l</charParams>
<charParams l="165" t="365" r="166" b="372"> </charParams>
<charParams l="167" t="365" r="171" b="372">2</charParams>
<charParams l="172" t="365" r="177" b="372">0</charParams>
<charParams l="177" t="365" r="182" b="372">0</charParams>
<charParams l="182" t="365" r="187" b="372">8</charParams>
<charParams l="188" t="365" r="190" b="372"> </charParams>
<charParams l="191" t="367" r="194" b="370">â€¢&lt;/charParams>
<charParams l="195" t="365" r="197" b="372"> </charParams>
<charParams l="198" t="365" r="206" b="372">M</charParams>
<charParams l="206" t="367" r="211" b="372">a</charParams>
<charParams l="212" t="366" r="215" b="372">t</charParams>
<charParams l="216" t="365" r="220" b="372">h</charParams>
<charParams l="221" t="367" r="226" b="372" suspicious="1">e</charParams>
<charParams l="227" t="367" r="235" b="372">m</charParams>
<charParams l="235" t="367" r="240" b="372">a</charParams>
<charParams l="241" t="366" r="244" b="372">t</charParams>
<charParams l="245" t="365" r="246" b="372">i</charParams>
<charParams l="247" t="367" r="252" b="372">c</charParams>
<charParams l="253" t="367" r="257" b="372">s</charParams>
<charParams l="258" t="367" r="260" b="372"> </charParams>
<charParams l="261" t="367" r="265" b="372">a</charParams>
<charParams l="266" t="367" r="271" b="372">n</charParams>
<charParams l="272" t="365" r="277" b="372">d</charParams>
<charParams l="278" t="365" r="279" b="372"> </charParams>
<charParams l="280" t="365" r="286" b="372">V</charParams>
<charParams l="286" t="367" r="291" b="372">o</charParams>
<charParams l="291" t="366" r="295" b="372">t</charParams>
<charParams l="295" t="365" r="297" b="372">i</charParams>
<charParams l="298" t="367" r="303" b="372">n</charParams>
<charParams l="304" t="367" r="309" b="374">g</charParams></formatting></line></par>
</text>
</block>
<block blockType="Separator" l="0" t="379" r="310" b="387"><region><rect l="0" t="379" r="310" b="387"/></region>
<separator type="Black" thickness="8"><start x="0" y="383"/><end x="310" y="383"/>
</separator>
</block>
<block blockType="Picture" l="1" t="362" r="316" b="376"><region><rect l="1" t="362" r="316" b="376"/></region>
</block>
</page>
</document> 
```

我将如何`charParams`使用 获取 XML 文档中每个内容的内容`simplexml_load_string`？我想每个里面`echo`的内容每个。并且在每个之后，它都会一个. 谢谢！哦，这会用 来完成吗？请指点我的方向。`charParms``line``line``echo``<br>``foreach`

就像在这种情况下，我希望它输出一些像这样的东西：

```
What Makes<br>Your Vote<br>Matter?<br>Find out how at 
```

等等。

只是给你一个基本的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:22:01.727

您需要像这样遍历块/段落/行/字符：

```
$string = '';
$xml = simplexml_load_file('file');

foreach ($xml->page->block as $block) {
    if ($block->text->count()) {
        foreach ($block->text->par as $par) {
            if ($par->line->count()) {
                foreach ($par->line as $line) {
                    foreach ($line->formatting->charParams as $char) {
                        $string .= $char;
                    }

                    $string .= "\n";
                }
            }

            $string .= "\n";
        }
    }

    $string .= "\n";
} 
```

**编辑**：我添加了更多错误检查以避免循环警告。目前，所有内容都加入了新行，因此您可能希望更改这些以更改您的输出。

[这是一个工作示例](http://codepad.viper-7.com/b9tlBF)。

# java - 进程迁移

> ID：14268732
> 
> 赞同：1
> 
> 时间：2013-01-10T22:50:55.717
> 
> 标签：java, android, process, parallel-processing

我想将一个进程从 android 设备迁移到计算机，在我的计算机上执行该进程并返回到 android 设备。是否可以在android设备和计算机之间迁移进程？

更多细节：我将开发一个应用程序来执行某种任务（比如按升序对 5000 个数字的列表进行排序）。此任务将在 android 设备上的函数 A 中执行。现在，我想做的是在服务器上（运行时）执行该功能。服务器不会提前获得功能码。因此，在android设备上调用该函数时，该函数（进程）会迁移到服务器（代码+输入数据），在服务器上执行，然后将排序后的列表返回给android设备。希望你能得到我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:20:16.770

您不能“发送进程”。通常你会在手机上开始执行进程，然后向服务器发送请求，然后使用以太推送或拉取在服务器上获取执行结果，之后你可以在手机上恢复你的逻辑。像 REST 协议和在你的 Android 应用程序中使用 HttpClient 之类的东西将是可能的解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T23:34:43.303

Android 没有内置支持以可以在其他地方恢复为进程的方式暂停进程。

您可以修改要迁移的过程吗？或者您是否试图针对任意 Android 进程？

Android 确实支持原始的、应用程序感知的“挂起”和“恢复”（表现良好的 Android 应用程序应该保持其状态，以便即使它被杀死也可以透明地“恢复”——参见[Android 进程生命周期](http://developer.android.com/reference/android/app/Activity.html#ProcessLifecycle)）。如果您控制有问题的应用程序，则可以`saveStateInstance`以平台中立的方式编写并在桌面上使用它来“恢复”该过程，反之亦然。根据您对“进程迁移”的定义，这可能会也可能不会计数。

理论上没有什么可以阻止将更健壮的进程迁移添加到 Android 中（迁移基于 Java 的进程应该更容易一些），但是您将遇到[所有标准进程迁移问题](http://www.hpl.hp.com/personal/Dejan_Milojicic/pm7.pdf)（网络身份、本地资源使用，开放的网络连接是标准的绊脚石）。

# javascript - 将 HTML 值与 jquery 输入值进行比较

> ID：14268735
> 
> 赞同：0
> 
> 时间：2013-01-10T22:51:37.567
> 
> 标签：javascript, jquery, string, jquery-selectors

我觉得我错过了一些小东西，但我似乎无法完成这项工作。我正在验证允许用户更改其电子邮件的表单，除其他外，我想确认他们没有重新输入他们已经拥有的同一电子邮件。

我已经尝试了很多尝试使用 id="originalemail" 提取 p 的值，但我似乎无法以与输入的值相比反映字符串相同的形式得到它。任何帮助将不胜感激。

为简单起见，我将该功能修剪为仅根据输入的新电子邮件是否与当前存在的（原始）电子邮件匹配进行验证：

JS/jQuery：

```
<script>
function validateEmailChange()
{
    // set comparison
    var originalemail=document.getElementById("originalemail").innerHTML;
    var newemail=document.forms["emailform"]["emailnewemail"].value;

    if (newemail == originalemail)
    {
        $('#emailnewemailoff').html("Same as current email address");
        $('#emailconfirmationoff').html("");
        return false;
    }
</script> 
```

HTML：

```
// show the user's current email
<p id="originalemail"><?= htmlspecialchars($user[0]["email"]) ?></p>

<form id="emailform" name="emailform" onsubmit="return validateEmailChange()" 
              action="email.php" method="post">

<input id="emailnewemail" name="emailnewemail" placeholder="New Email" type="text"/>
<input type="submit" value="Change Email" class="btn"/> 
```

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:58:05.050

你可以试试`if( $('#originalemail').text() == $('#emailnewemail').val() )`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T23:26:19.097

我创建了 jQuery 来评估用户何时离开电子邮件输入字段 ( `$('#emailnewemail').blur()`，并且它也比较不区分大小写 ( `.toLowerCase()`) 的值，因此“my@email.com”被识别为与“my@EMAIL.COM”相同'。

```
$('#emailnewemail').blur(function() {
    if ($('#originalemail').text().toLowerCase() === $('#emailnewemail').val().toLowerCase()) {
        $('#emailnewemailoff').html("Same as current email address");
        $('#emailconfirmationoff').html("");
        return false;
    } else {
        $('#emailnewemailoff').html("Not the same email address");
    }
}); 
```

有关工作示例，请参见[http://fiddle.jshell.net/jhfrench/EZp6R/ 。](http://fiddle.jshell.net/jhfrench/EZp6R/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T22:59:23.653

您可能想尝试使用 jQuery 提取值。我不确定你为什么决定为这两行回退到原生 JavaScript -

```
var originalemail=document.getElementById("originalemail").innerHTML;
var newemail=document.forms["emailform"]["emailnewemail"].value; 
```

使用 jQuery，这些行看起来像这样 -

```
var originalemail = $("#originalemail").text();
var newemail = $("#emailnewemail").val(); 
```

## [这是一个小演示](http://jsfiddle.net/sDjDd/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T23:40:40.670

我意识到我的问题是我正在包装

行，因此包括前导零。它看起来像下面。解决了这个问题，感谢大家的帮助，对于发布的错误问题我深表歉意（仍然是编码新手，所以像这样的语法仍然让我很着迷）

```
<p id="originalemail">
    <?= htmlspecialchars($user[0]["email"]) ?></p> 
```

# c++ - 符号可见性、异常、运行时错误

> ID：14268736
> 
> 赞同：21
> 
> 时间：2013-01-10T22:51:40.707
> 
> 标签：c++, exception, visibility, symbols, elf

我试图更好地理解符号可见性。GCC Wiki ( [http://gcc.gnu.org/wiki/Visibility](http://gcc.gnu.org/wiki/Visibility) ) 有一个关于“C++ 异常问题”的部分。根据 GCC Wiki，由于未导出异常，可能会出现**运行时错误。**没有编译时错误/警告的运行时错误非常危险，所以我试图更好地理解这个问题。我做了一些实验，但我仍然无法重现它。任何想法如何重现问题？

Wiki 中提到了三个库相互使用，所以我做了三个小库。

我运行以下命令：

没有 vtable 的异常类（按预期工作）：

```
make
./dsouser 
```

带有 vtable 的异常类，但它不导出（甚至不编译）：

```
make HAS_VIRTUAL=1 
```

异常类导出的 vtable（按预期工作）：

```
make HAS_VIRTUAL=1 EXCEPTION_VISIBLE=1
./dsouser 
```

生成文件：

```
CXX=g++-4.7.1
CFLAGS=-ggdb -O0 -fvisibility=hidden
ifdef EXCEPTION_VISIBLE
  CFLAGS+=-DEXCEPTION_VISIBLE
endif
ifdef HAS_VIRTUAL
  CFLAGS+=-DHAS_VIRTUAL
endif
all: dsouser

libmydso.so: mydso.cpp mydso.h
    $(CXX) $(CFLAGS) -fPIC -shared -Wl,-soname,$@ -o $@ $<

libmydso2.so: mydso2.cpp mydso.h mydso2.h libmydso.so
    $(CXX) $(CFLAGS) -L.  -fPIC -shared -Wl,-soname,$@ -o $@ $< -lmydso

libmydso3.so: mydso3.cpp mydso.h mydso2.h mydso3.h libmydso2.so
    $(CXX) $(CFLAGS) -L.  -fPIC -shared -Wl,-soname,$@ -o $@ $< -lmydso -lmydso2

dsouser: dsouser.cpp libmydso3.so
    $(CXX) $< $(CFLAGS) -L. -o $@ -lmydso -lmydso2 -lmydso3

clean:
    rm -f *.so *.o dsouser

.PHONY: all clean 
```

mydso.h：

```
#ifndef DSO_H_INCLUDED
#define DSO_H_INCLUDED
#include <exception>
#define SYMBOL_VISIBLE __attribute__ ((visibility ("default")))
namespace dso
{
  class
#ifdef EXCEPTION_VISIBLE
    SYMBOL_VISIBLE
#endif
    MyException : public std::exception
  {
  public:
#ifdef HAS_VIRTUAL
    virtual void dump();
#endif
    void SYMBOL_VISIBLE foo();
  };
}
#endif 
```

mydso.cpp：

```
#include <iostream>
#include "mydso.h"
namespace dso
{

#ifdef HAS_VIRTUAL
void MyException::dump()
{
}
#endif

void MyException::foo()
{
#ifdef HAS_VIRTUAL
  dump();
#endif
}

} 
```

mydso2.h：

```
#ifndef DSO2_H_INCLUDED
#define DSO2_H_INCLUDED
#define SYMBOL_VISIBLE __attribute__ ((visibility ("default")))
namespace dso2
{
  void SYMBOL_VISIBLE some_func();
}
#endif 
```

mydso2.cpp：

```
#include <iostream>
#include "mydso.h"
#include "mydso2.h"
namespace dso2
{
  void some_func()
  {
    throw dso::MyException();
  }
} 
```

mydso3.h：

```
#ifndef DSO3_H_INCLUDED
#define DSO3_H_INCLUDED
#define SYMBOL_VISIBLE __attribute__ ((visibility ("default")))
namespace dso3
{
  void SYMBOL_VISIBLE some_func();
}
#endif 
```

mydso3.cpp：

```
#include <iostream>

#include "mydso2.h"
#include "mydso3.h"

#include <iostream>

namespace dso3
{

  void some_func()
  {
    try
    {
      dso2::some_func();
    } catch (std::exception e)
    {
      std::cout << "Got exception\n";
    }
  }

} 
```

dsouser.cpp：

```
#include <iostream>
#include "mydso3.h"
int main()
{
  dso3::some_func();
  return 0;
} 
```

谢谢，丹妮

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-16T17:19:54.587

我是 GCC 添加类可见性支持的原始补丁的作者，GCC 克隆的原始方法位于[http://www.nedprod.com/programs/gccvisibility.html](http://www.nedprod.com/programs/gccvisibility.html)。感谢 VargaD 亲自给我发电子邮件告诉我这个 SO 问题。

您观察到的行为对最近的 GCC 有效，但并非总是如此。当我最初在 2004 年修补 GCC 时，我向 GCC bugzilla 提交了一个请求，要求 GCC 异常处理运行时通过字符串比较它们的错位符号而不是比较*地址来比较抛出的类型*在这些字符串中 - 当时被 GCC 维护者拒绝为不可接受的运行时成本，尽管这种行为是 MSVC 所做的，并且尽管异常抛出期间的性能通常不被认为是重要的，因为它们应该是罕见的。因此，我不得不在我的可见性指南中添加一个特定的例外，以说明任何抛出的类型都不能在二进制文件中被隐藏，一次都不能，因为“隐藏”胜过“默认”，因此只需一个隐藏符号声明即可保证覆盖所有情况给定二进制文件中的相同符号。

接下来发生的事情我想我们都没有预料到——KDE 非常公开地接受了我贡献的功能。在极短的时间内，几乎所有使用 GCC 的大型项目都采用了这种方式。突然间，隐藏符号成为常态，而不是例外。

不幸的是，少数人没有正确地应用我的指南来处理异常抛出的类型，并且关于 GCC 中不正确的交叉共享对象异常处理的持续错误报告最终导致 GCC 维护人员放弃并在多年后修补字符串比较用于抛出类型匹配，正如我最初要求的那样。因此，在较新的 GCC 中，情况要好一些。我没有更改我的指南和说明，因为自 v4.0 以来，该方法在每个 GCC 上仍然是最安全的，虽然由于现在使用字符串比较，较新的 GCC 在处理异常抛出方面更可靠，但遵循指南的规则并没有什么坏处那。

这给我们带来了 typeinfo 问题。一个大问题是最佳实践 C++ 要求您**始终***虚拟*继承可抛出类型，因为如果您组合两个异常类型都继承（假设）自 std::exception，则拥有两个等距的 std::exception 基类将导致捕获(std::exception&) 自动调用 terminate() 因为它无法解析要匹配的基类，所以你必须永远只有一个 std::exception 基类，并且相同的原理适用于任何可能的 throwable 组合类型。在任何 C++ 库中都特别需要这种最佳实践，因为您无法知道第三方用户将如何处理您的异常类型。

换句话说，这意味着在最佳实践中所有抛出的异常类型总是伴随着每个基类的连续 RTTI 链，并且异常匹配现在是在内部对正在匹配的类型执行成功的 dynamic_cast<> 的情况， O（基类数量）操作。为了使 dynamic_cast<> 在一系列虚拟继承的类型上工作，你猜对了，你需要**每一个**此链的默认可见性。如果在执行 catch() 的代码中甚至隐藏了一个，那么整个 caboodle 就会翻倒，你会得到一个 terminate()。如果您重新编写上面的示例代码以虚拟继承并查看会发生什么，我会非常感兴趣 - 您的一条评论说它拒绝链接，这很好。但是假设 DLL A 定义了类型 A，DLL B 将类型 A 子类化为 B，DLL C 将类型 B 子类化为 C，并且程序 D 在抛出类型 C 时尝试捕获类型 A 的异常。程序 D 将提供 A 的类型信息，但在尝试获取 B 和 C 类型的 RTTI 时应该会出错。不过，也许最近的 GCC 也修复了这个问题？我不知道，近年来我的注意力集中在 clang 上，因为这是所有 C++ 编译器的未来。

显然，这是一个混乱，但它是一个特定于 ELF 的混乱 - 这些都不会影响 PE 或 MachO，它们都通过首先不使用进程全局符号表来获得上述所有权利。然而，致力于 C++17 的 WG21 SG2 模块研究组必须有效地实现模块的导出模板才能解决 ODR 违规问题，而 C++17 是我见过的第一个使用 LLVM 编写的提议标准头脑。换句话说，C++17 编译器必须像 clang 一样将复杂的 AST 转储到磁盘上。这意味着 RTTI 可用保证的巨大增加——事实上，这就是我们有 SG7 反思研究组的原因，因为 C++ 模块中的 AST 可以极大地增加可能的自我反思机会。换句话说，

所以，简而言之，现在继续遵循我的原始指南。未来十年，情况有望大大改善。并感谢 Apple 为该解决方案提供资金，由于它的难度很大，所以已经很长时间了。

尼尔

# accessibility - 使用 JAWS 读取多个跨度标签的问题

> ID：14268737
> 
> 赞同：4
> 
> 时间：2013-01-10T22:51:46.990
> 
> 标签：accessibility, jaws-screen-reader

我正在尝试通过 JAWS 屏幕阅读器读取简单的 HTML 结构

```
<html>
<head>
    <title>test code</title>
</head>
<body>
    <a href="#"></a>
    <span tabindex="0">
        <span>first line</span>
        <span>second line</span>
    </span>
</body> 
```

由于 tabIndex，标签焦点设置在下一个可聚焦的 SPAN 标签上。但是 JAWS 在其集中注意力时无法读取该 SPAN 中的所有内容。它只读取第一个子 SPAN 内容并跳过第二个 SPAN 内容。

我需要有关 JAWS 将读取两个 SPAN 标签的代码更改方面的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T10:31:42.843

由于 JAWS 只读取第一个元素，也许你可以试试这个：

```
 <style type="text/css">            
    .marked-hidden-for-reader{
       display:none;
    }
    </style>

    <span tabindex="0">
        <span class="marked-hidden-for-reader">first line second line</span>
        <span>first line</span>
        <span>second line</span>
    </span> 
```

# sql - 如何从 catch 块中记录错误并同时回滚事务？

> ID：14268738
> 
> 赞同：0
> 
> 时间：2013-01-10T22:51:53.390
> 
> 标签：sql, tsql, transactions, try-catch

```
BEGIN TRANSACTION
    BEGIN TRY
        --DO_ACTION
        --COMMIT_TRANSACTION
    END TRY
    BEGIN CATCH
        --LOG_ERROR (e.g. INSERT INTO ErrorTable (ERROR_MESSAGE(), ...))
        --ROLLBACK
    END CATCH 
```

但是，我正在尝试执行以下操作，ROLLBACK 命令正在回滚我的错误记录，因此“ErrorTable”中没有任何内容。

在这种情况下，我将如何去做我想做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:57:10.530

你想登录`ErrorTable`什么？如果是回滚后还不可用的数据，可以将其保存在表变量中，然后`ErrorTable`在回滚后插入。表变量不参与事务。

# github - Github Wiki 的表格和标题

> ID：14268739
> 
> 赞同：26
> 
> 时间：2013-01-10T22:51:55.530
> 
> 标签：github, markdown, wiki, textile

用标题和表格在 Github 中键入 wiki 文档的简单方法是什么？这让我很恼火：

1.  如果我使用**Markdown**，我必须使用`<table>`.

2.  如果我使用**Textile**，则没有`#`or `##`for header

我喜欢这种`|col1|col2|`语法。

人们在这种情况下使用什么？无需大量输入/剪切和粘贴（`<table>`例如）。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-11T00:16:36.350

[可以看出](http://github.com/svnpenn/a/wiki)，这 肯定是可能的。

```
dog | bird | cat
----|------|----
foo | foo  | foo
bar | bar  | bar
baz | baz  | baz 
```

（这是使用 GitHub 的“Markdown”编辑模式）

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-09-16T20:09:09.977

如果要强制对单元格进行特定对齐，可以执行以下操作，其中我将第一列左对齐，中间列居中，最后一列右对齐：

```
dog | bird | cat
:-- | :--: | --:
foo | foo  | foo
bar | bar  | bar
baz | baz  | baz 
```

# algorithm - 结构递归与生成递归有何不同？

> ID：14268749
> 
> 赞同：27
> 
> 时间：2013-01-10T22:52:49.957
> 
> 标签：algorithm, data-structures, recursion

[维基百科](http://en.wikipedia.org/wiki/Recursion_%28computer_science%29#Structural_versus_generative_recursion)中对生成递归的描述对我来说很清楚，但我对结构递归的概念感到困惑。

有人可以解释一个计算第 n 个斐波那契数的函数和一个计算从 1 到 N 阶乘的函数是结构性的还是生成性的？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-01-10T23:05:12.270

结构递归和生成递归之间的主要区别在于递归过程在哪里获取它所处理的数据以及它如何处理这些数据。具体来说，对于结构递归，对原始输入数据的子集进行递归调用。而对于生成递归，递归调用是对从原始输入数据构造/计算的数据进行的。

例如，如果要计算链表中元素的数量，可以执行以下操作：

```
int NumberOfNodes(ListNode* node) {
    if (node == nullptr) return 0;
    return 1 + NumberOfNodes(node->next);
} 
```

`NumberOfNodes`在这里，正在对 进行递归调用`node->next`，这是已经存在的原始输入的一部分。在这种情况下，递归的工作原理是将输入分解成更小的部分，然后在更小的部分上递归。

类似地，在 BST 中搜索值的代码将是结构递归，因为递归调用是对原始输入的子部分的调用：

```
TreeNode* Find(TreeNode* root, DataType value) {
    if (root == nullptr) return nullptr;
    if (value < root->value) return Find(root->left, value);
    else return Find(root->right, value); 
```

术语“结构递归”来自这样一个事实，即这些结构（列表、BST 等）可以递归定义：

*   列表要么什么都不是，要么是一个单元格后跟一个列表。
*   二叉树要么什么都不是，要么是一个有两个二叉树作为子节点的节点。

在进行结构递归时，您正在“撤消”这些结构相互构建的操作。例如，`NumberOfNodes`函数“取消”获取节点并将其添加到现有列表的构造。运算符“撤消”将`Find`节点粘合到其他两棵树的操作。因此，很容易看出为什么这些函数必须终止 - 最终，您“撤消”了最初构建对象的所有操作，递归停止。

另一方面，考虑快速排序，它执行以下操作：

1.  选择一个支点。
2.  创建三个新列表：小于枢轴的所有元素之一，大于枢轴的所有元素之一，以及等于枢轴的所有元素之一。
3.  递归地对这些列表中的第一个和第二个进行排序。
4.  连接较小、相等和较大值的列表。

在这里，递归调用是在不属于原始输入的较小数组上进行的——必须从数据中创建列表。（通常，实现会为这些列表重用空间，但不能保证这些子列表直接存在于输入中）。

当涉及到自然数时，这种区别是模糊的。通常，自然数递归定义如下：

*   0 是自然数。
*   如果 n 是自然数，则 n + 1 是自然数。
*   没有其他东西是自然数。

在这个定义下，数字 n 是 n + 1 的“部分”。因此，这个递归代码来计算 n！是结构递归：

```
int Factorial(int n) {
    if (n == 0) return 1;
    return n * Factorial(n - 1);
} 
```

这是结构递归，因为参数 n - 1 是原始输入 n 的“一部分”。

类似地，根据这个定义，递归计算第 n 个斐波那契数算作结构递归：

```
int Fibonacci(int n) {
    if (n <= 1) return n;
    return Fibonacci(n - 1) + Fibonacci(n - 2);
} 
```

这被认为是结构递归，因为 n - 1 是 n 的一部分（通过“撤消”+1 形成）并且 n - 2 是 n-1 的一部分（再次通过“撤消”+1 形成）。

另一方面，这个计算 gcd 的代码将被认为是生成递归，而不是结构递归：

```
int gcd(int a, int b) {
    if (b == 0) return a;
    return gcd(b, a % b);
} 
```

原因是，由于是从and`a % b`中“计算”出来的，而不是通过“撤消”一些 +1 操作而形成的，因此生成了数据。`a``b`

生成递归与结构递归不同的原因是不能保证它会终止。例如，考虑这个函数：

```
int BadTimes(int a, int b) {
    if (a == 0 && b == 0) return 0;
    return BadTimes(a * 2, b - 1);
} 
```

这个生成递归函数永远不会终止：`a`即使`b`不断变小，也会不断变大。

老实说，我以前从未听说过这种区别，我教授离散数学和编程课程。除非有人要求您知道其中的区别，否则我不会太担心。

希望这可以帮助！

# android - 将文本字符串值从微调器转换为数字以供将来计算

> ID：14268751
> 
> 赞同：0
> 
> 时间：2013-01-10T22:52:53.947
> 
> 标签：android

我希望对解决我在其他地方找不到的问题有一些想法。我想在计算中使用分配给文本微调器选择的数值，同时将微调器显示为用户选择的文本值。例如，如果用户选择“比萨”，我希望显示比萨，但分配给比萨的数值要保存并用于将来的计算。

这是可以在应用程序生成器中完成的事情，还是我需要从头开始做的事情？

这是我的图表：

1.  Spinner A（文本）---->数值列在列表中
2.  微调器B（数量）
3.  用户输入 A（数字）
4.  用户输入 B（数字）
5.  计算---->微调器A的数值+微调器B+用户输入A+用户输入B
6.  显示结果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:01:19.717

只需使用数组

```
var spinnerVals = [];

spinnerVals.push[ spinnerVals.length ] = [ snipperValue, number ];
spinnerVals[ spinnerVals.length ] = [ "userInput", number ];

for( var i = 0, result = 0; i < spinnerVals.length; i++ ) {
    result += spinnerVals[i][1];
} 
```

# html - CSS 定位 - 如何解决负载问题

> ID：14268755
> 
> 赞同：0
> 
> 时间：2013-01-10T22:53:05.120
> 
> 标签：html, css, load, css-position

我的主页上有两个 css 按钮，它们相对于图像具有绝对位置。我遇到的问题是它们的加载速度比图像加载速度要快得多，因此在加载页面的瞬间，按钮会漂浮在 la la Land 中，直到图像加载并且它们对齐。

是否有一个简单的解决方法或者我必须完全重做定位？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:56:11.437

最简单的方法是最初隐藏按钮（显示：无），并使用 javascript/jquery 显示 onload。

jQuery示例是这样做的：

```
$('#ImgReferenced').on('load',function(){
    $('input[button]').show();
}); 
```

但同样可以在带有 onload 事件处理程序的 javascript 中完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T23:28:51.277

`<img ... width="xxx" height="yyy">`您是否在图像元素上使用宽度和高度属性？这就是浏览器如何为图像“保留空间”并在加载图像之前知道其尺寸的方式。它需要这个，所以它可以绘制与图像相关的东西。

# c# - C# / XNA 直线矩形碰撞/响应

> ID：14268756
> 
> 赞同：1
> 
> 时间：2013-01-10T22:53:11.603
> 
> 标签：c#, xna, geometry, collision-detection, xna-4.0

首先，我有一个简单的课程`Line`；

```
public class Line
{
    public Vector2 P1 = Vector2.Zero;
    public Vector2 P2 = Vector2.Zero;

    public Line(Vector2 p1, Vector2 p2)
    {
        P1 = p1;
        P2 = p2;
    }
} 
```

游戏中所有线条的列表，以及我的精灵边界矩形。我试图找出这个矩形底部中间是否低于它正上方的线上的点，并将它更新到它所在的线上的点。这张图片可能会帮助您理解我的意思； ![在此处输入图像描述](../Images/4369b31fe11446f90aadc70c1d3750d8.png)

矩形向下移动，通过它的交点，然后相应地更新。

关于如何解决这个问题的任何想法？我可以很容易地找到它当前在哪条线上，但我不知道如何在它上面的线上获得点并防止它超过那个点。

代码示例或参考会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T08:59:55.783

如果您知道直线端点的位置，那么以 y = mx + c 的形式获得该直线的方程就很简单了。然后你需要找到那个矩形底部的中点——看到 XNA 矩形给你它的高度、宽度和中心点位置，这也是微不足道的。从那里，您获取矩形中心点的 x 坐标，使用 y = mx + c 等式计算该点的直线的 y 坐标。然后您只需要检查矩形的底部中心是否低于该点，如果是，请使用矩形的高度值计算出您需要将矩形放置在该 y 坐标之上多远，以便它看起来坐在上面线。应该足够简单。

# intellij-idea - Intellij Idea 代码缩进在评论中令人困惑

> ID：14268757
> 
> 赞同：1
> 
> 时间：2013-01-10T22:53:11.900
> 
> 标签：intellij-idea, auto-indent

当我创建 Java 文件时，我会将 Javadoc 命令作者添加到文件中。Intellij IDEA 还添加了尚未在 Javadoc 中实现的日期和时间作为注释。当我进行自动代码缩进时，它变成了这样：

```
/**
 * @author kamaci
 *         Date: 11.01.2013
 *         Time: 00:47
 */ 
```

代替：

```
/**
 * @author kamaci
 * Date: 11.01.2013
 * Time: 00:47
 */ 
```

如何实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T23:57:12.357

您可能想在 Settings->Code Style->Java->JavaDoc(tab) 中取消选中“align parameter descriptions”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-10T08:10:54.450

您可以取消选中“启用前导星号”。参考：[https ://www.jetbrains.com/help/idea/2016.1/code-style-java.html?origin=old_help](https://www.jetbrains.com/help/idea/2016.1/code-style-java.html?origin=old_help)

# c++ - 命令行风格的自动完成视觉工作室

> ID：14268758
> 
> 赞同：1
> 
> 时间：2013-01-10T22:53:26.103
> 
> 标签：c++, shell, command-line, autocomplete, intellisense

有谁知道使 VS2010/2012 的智能自动完成功能像命令行自动完成一样工作的方法？这在编码 OpenGL/C++ 应用程序时会有很大帮助。我知道 C# 有 Resharper，但我认为它不适用于 C++。

例如，我想输入 glGetAttributeLocation。我可以使用 TAB 自动完成直到下一个模棱两可的点，而不是键入 glGetA 然后必须向下滚动列表。

# jquery - jquery 与其他脚本的冲突问题

> ID：14268762
> 
> 赞同：0
> 
> 时间：2013-01-10T22:53:44.967
> 
> 标签：jquery

您好，在我的网站上，我正在运行许多 Jquery 插件，例如 carouFredSel、nivoslider、cloud-zom 等......它们工作正常，直到我添加了这个 jquery 脚本：

```
<script type="text/javascript" src="jquery.lightbox_me.js" charset="utf-8"></script>
<script type="text/javascript" charset="utf-8">
    $(function() {
        function launch() {
             $('#sign_up').lightbox_me({centered: true, onLoad: function() { $('#sign_up').find('input:first').focus()}});
        }
        $('#try-1').click(function(e) {
            $("#sign_up").lightbox_me({centered: true, onLoad: function() {
                $("#sign_up").find("input:first").focus();
            }});
            e.preventDefault();
        });
        $('table tr:nth-child(even)').addClass('stripe');

            $(".sign_up2").lightbox_me({centered: true, onLoad: function() {
                $(".sign_up2").find("input:first").focus();
            }});
            e.preventDefault();

    });
</script> 
```

添加此代码后，我的滑块停止工作并且图像缩放...如何使非冲突？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:59:18.163

你有两个选择。要么使用jquery noconflict

[http://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

或使用限制您对 jquery 的调用范围

```
(function($) {
    // code here
})(jquery) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T23:12:10.747

在我看来，`e.preventDefault();`您的代码中有一个孤儿。先把它清理干净。然后我们会看看你是否还有问题。

# objective-c - Encoding a CLLocationcoordinate2D

> ID：14268766
> 
> 赞同：10
> 
> 时间：2013-01-10T22:54:08.443
> 
> 标签：objective-c, cllocation, nscoding

I am trying to encode annotations that are on a map, but I read that I am not able to encode CLLocationcoordinate2D variables. Does anyone know how I can solve this? Here is some code.

This is where I drop the pins:

```
- (void)press:(UILongPressGestureRecognizer *)recognizer {
    CGPoint touchPoint = [recognizer locationInView:_worldView];
    CLLocationCoordinate2D touchMapCoordinate = [_worldView convertPoint:touchPoint toCoordinateFromView:_worldView];

    geocoder = [[CLGeocoder alloc]init];
    CLLocation *location = [[CLLocation alloc]initWithCoordinate:touchMapCoordinate
                                                    altitude:CLLocationDistanceMax
                                          horizontalAccuracy:kCLLocationAccuracyBest
                                            verticalAccuracy:kCLLocationAccuracyBest
                                                   timestamp:[NSDate date]];
    [geocoder reverseGeocodeLocation:location
               completionHandler:^(NSArray *placemarks, NSError *error) {
                   //NSLog(@"reverseGeocoder:completionHandler: called");
                   if (error) {
                       //NSLog(@"Geocoder failed with error: %@", error);
                   } else {
                       CLPlacemark *place = [placemarks objectAtIndex:0];
                       geocodedAddress = [NSString stringWithFormat:@"%@ %@, %@ %@", [place subThoroughfare], [place thoroughfare], [place locality], [place administrativeArea]];
                       if (UIGestureRecognizerStateBegan == [recognizer state]) {
                           value = [number intValue];
                           number = [NSNumber numberWithInt:value + 1];
                           _addressPin = [[MapPoint alloc]initWithAddress:geocodedAddress coordinate:touchMapCoordinate
                                                                   title:geocodedAddress identifier:number];
                           NSLog(@"The identifier is %@", number);
                           [[Data singleton].annotations addObject:_addressPin];
                           [_worldView addAnnotation:_addressPin];
                           NSLog(@"The number of pins in the annotation array is: %u",[Data singleton].annotations.count);
                       }
                   }
               }];
} 
```

Here is my class that conforms to the MKAnnotation protcol:

```
#import <CoreLocation/CoreLocation.h>
#import <MapKit/MapKit.h>

@interface MapPoint : NSObject <MKAnnotation, NSCoding>
{
}

- (id)initWithAddress:(NSString*)address
    coordinate:(CLLocationCoordinate2D)coordinate
         title:(NSString *)t
       identifier:(NSNumber *)ident;

//This is a required property from MKAnnotation
@property (nonatomic, readonly) CLLocationCoordinate2D coordinate;

//This is an optional property from MKAnnotataion
@property (nonatomic, copy) NSString *title;
@property (nonatomic, readonly, copy) NSString *subtitle;
@property (nonatomic) BOOL animatesDrop;
@property (nonatomic) BOOL canShowCallout;

@property (copy) NSString *address;
@property (copy) NSNumber *identifier;
@property (nonatomic, copy) NSString *imageKey;
@property (nonatomic, copy) UIImage *image;

@end

import "MapPoint.h"

@implementation MapPoint

@synthesize title, subtitle, animatesDrop, canShowCallout, imageKey, image;
@synthesize address = _address, coordinate = _coordinate, identifier = _indentifier;

-(id)initWithAddress:(NSString *)address
       coordinate:(CLLocationCoordinate2D)coordinate
            title:(NSString *)t
       identifier:(NSNumber *)ident {
    self = [super init];

    if (self) {
        _address = [address copy];
        _coordinate = coordinate;
        _indentifier = ident;

        [self setTitle:t];

        NSDate *theDate = [NSDate date];

        subtitle = [NSDateFormatter localizedStringFromDate:theDate
                                              dateStyle:NSDateFormatterShortStyle
                                              timeStyle:NSDateFormatterShortStyle];
        }
    return self;
}

 - (void)encodeWithCoder:(NSCoder *)aCoder {

    [aCoder encodeObject:_address forKey:@"address"];

    [aCoder encodeObject:title forKey:@"title"];
    [aCoder encodeObject:_indentifier forKey:@"identifier"];
}

- (id)initWithCoder:(NSCoder *)aDecoder {
    self = [super init];
    if (self) {
        [self setAddress:[aDecoder decodeObjectForKey:@"address"]];

    }
    return self;
} 
```

@end

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-11T00:33:20.397

Just encode the two fields of the `CLLocationCoordinate2D` value.

```
[aCoder encodeDouble:_coordinate.latitude forKey:@"latitude"];
[aCoder encodeDouble:_coordinate.longitude forKey:@"longitude"]; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-02-14T16:42:10.257

NSValue is NSCoding compliant. You can box your CLLocationcoordinate2D variable in an NSValue object:

```
 [coder encodeObject:[NSValue valueWithMKCoordinate:coordinate] forKey:@"coordinate"] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-09-05T10:04:41.487

The `CLLocationCoordinate2D`'s latitude and longitude are of type `CLLocationDegrees` which is, essentially, a fancy way of saying `double`.

This is how you can encode and decode them:

```
NSString *const kPinCoordinateLatitudeKey = @"kPinCoordinateLatitudeKey";
NSString *const kPinCoordinateLongitudeKey = @"kPinCoordinateLongitudeKey";

- (void)encodeWithCoder:(NSCoder *)encoder
{
    [encoder encodeDouble:self.coordinate.latitude forKey:kPinCoordinateLatitudeKey];
    [encoder encodeDouble:self.coordinate.longitude forKey:kPinCoordinateLongitudeKey];
}

- (id)initWithCoder:(NSCoder *)decoder
{
    if((self = [super init])) {
        CLLocationDegrees latitude = [decoder decodeDoubleForKey:kPinCoordinateLatitudeKey];
        CLLocationDegrees longitude = [decoder decodeDoubleForKey:kPinCoordinateLongitudeKey];
        _coordinate = CLLocationCoordinate2DMake(latitude, longitude);
    }
    return self;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-11-05T22:43:51.017

I decided to encode use a `CLLocation` property handle this situation, which conforms to `NSSecureCoding`.

If you need to convert to or from a CLLocationCoordinate2D:

```
// Coordinate to Location
CLLocationCoordinate2D coord;
CLLocation *loc = [[CLLocation alloc] initWithLatitude:coord.latitude
                                             longitude:coord.longitude];

// Location to Coordinate
CLLocationCoordinate2D coord = loc.coordinate; 
```

# css - IE8 无法正确对齐固定大小的堆叠浮动元素

> ID：14268767
> 
> 赞同：1
> 
> 时间：2013-01-10T22:54:10.940
> 
> 标签：css, internet-explorer-8

我正在尝试浮动固定宽度（300px + 40px 边距）和高度是固定值（400px + 40px 边距）的整数倍的元素，以便它们都应该完美堆叠。我将它们浮动在一个具有固定宽度的容器中，以恰好适合连续两个（680px = 2*300px + 2*40px）。非 IE 浏览器完美地执行了这项任务，但 IE8 因我无法理解的原因而失败。谁能解释为什么 IE8 不能完成这个看似简单的任务，以及是否可以修复它，而不必明确地“清除：左；” 在那些元素上？（如果我向该元素添加内联“clear:left;”，IE8 会清除它，但它的位置根本不会改变，所以它不像元素“碰撞”到“tall”元素。）

[http://jsfiddle.net/Nun2L/](http://jsfiddle.net/Nun2L/)

HTML：

```
<div id="boxes">

  <div class="box tall"></div>

  <div class="box"></div>

  <div class="box"></div>

  <div class="box"></div>

  <div class="box"></div>

</div> 
```

CSS：

```
#boxes {
  position: relative;
  width: 680px;
  margin-left: -40px;
}

.box {
  position: relative;
  float: left;
  width: 300px;
  height: 200px;
  margin-left: 40px;
  margin-bottom: 40px;
  background-color: red;
}

.box.tall {
  height: 440px; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:06:59.840

可能是 IE 进入了怪癖模式，而 .class.class 把它搞砸了。看：

[IE8 在怪癖模式下不接受多个类？](https://stackoverflow.com/questions/1663495/ie8-not-accepting-multiple-classes-in-quirks-mode)

# php - 用php将jpg保存为透明png

> ID：14268769
> 
> 赞同：1
> 
> 时间：2013-01-10T22:54:34.207
> 
> 标签：php, image-processing, gd

我创建了一个函数，它根据参数以不同的方式处理图像。我在函数中有注释来解释一下。

当我拍摄 jpg 图像并将其保存为 png 时，一切正常。我刚刚检查过，即使我使用`imagepng()`但使用扩展名 .jpg 保存它，图像在正确调整大小时显示，但扩展名为 .jpg。但是，如果我上传相同的 .jpg 图像，使用`imagepng()`并使用 .png 扩展名保存它，我会在调整大小后以 png 格式获得预期宽度和高度的图像，并带有 .png 扩展名。虽然整个图像是 100% 透明的，但我在左上角有一个 1px x 1px 黑色像素。

如果有人能看看这个，看看他们是否看到我遗漏的东西，我将不胜感激。我相信 1px X 1px 来自我用于 的点`imagefill()`，但我不明白为什么；它应该像图像的其余部分一样填充所有透明。

这是我的功能：

```
if(!function_exists("upload")){
    //$image = $image file name
    //$width = intended width of resized image, if 0 it will proportion to height, overrides proportion
    //$height = intended width of resized image, if 0 it will proportion to width, overrides proportion
    //$proportion = 2,1,0;
    //------ 2 = Preserve proportions while adding a border to fill width and height  
    //------ 1 = retain proportion to fit within both given width and height
    //------ 0 = disregard proportions and resize to the exact width and height
    function upload($image, $width, $height, $proportion){
        // IS GD HERE?

        $gdv = get_gd_info();

        if (!$gdv){ 
            return FALSE;
        }

        // GET AN IMAGE THING

        $ext = trim(strtolower(end(explode('.', $image))));

        list($imageX, $imageY, $type) = getimagesize($image);   //gets information about new server image

        // GET THE LESSER OF THE RATIO OF THUMBNAIL H OR W DIMENSIONS
        $ratio_w = ($width / $imageX);
        $ratio_h = ($height / $imageY);
        $ratio   = ($ratio_w < $ratio_h) ? $ratio_w : $ratio_h;     

        if($width == 0){

            if($imageY > $height){
                $newHeight = $height;
                $newWidth = ($height/$imageY) * $imageX;    
            }else{
                $newHeight = $imageY;
                $newWidth = $imageX;    
            }

            $width = $newWidth;
            $height = $newHeight;

            // COMPUTE THUMBNAIL IMAGE CENTERING OFFSETS
            $fromMidX = 0;
            $fromMidY = 0;

        }elseif($height == 0){

            if ($imageX > $width){
                $newWidth = $width;
                $newHeight = ($width/$imageX) * $imageY;
            }else{
                $newHeight = $imageY;
                $newWidth = $imageX;    
            }

            $width = $newWidth;
            $height = $newHeight;

            // COMPUTE THUMBNAIL IMAGE CENTERING OFFSETS
            $fromMidX = 0;
            $fromMidY = 0;

        }elseif($proportion == 2){

            // COMPUTE THUMBNAIL IMAGE DIMENSIONS
            $newWidth = $imageX * $ratio;
            $newHeight = $imageY * $ratio;

            // COMPUTE THUMBNAIL IMAGE CENTERING OFFSETS
            $fromMidX = ($width - $newWidth) / 2.0;
            $fromMidY = ($height - $newHeight) / 2.0;

        }elseif($proportion == 1){

            if ($imageX > $width){
                $newHeight = ($width/$imageX) * $imageY;
                $newWidth = $width;
            }
            if ($imageY > $height){
                $newHeight = $height;
                $newWidth = ($height/$imageY) * $imageX;
            }

            $fromMidY = 0;
            $fromMidX = 0;

        }elseif($proportion == 0){

            $newWidth = $width;
            $newHeight = $height;

            $fromMidY = 0;
            $fromMidX = 0;          
        }

        switch(strtoupper($ext))
        {
            case 'JPG' :
            case 'JPEG' :
                $source = imagecreatefromjpeg($image);
                break;

            case 'PNG' :
                $source = imagecreatefrompng($image);

                break;

            default : die("UNKNOWN IMAGE TYPE: $image");
        }

        // WHICH FUNCTIONS CAN RESIZE / RESAMPLE THE IMAGE?
        if ($gdv >= 2)
        {

            // IF GD IS AT LEVEL 2 OR ABOVE
            $target = imagecreatetruecolor($width, $height);
            $color = imagecolorallocatealpha($target, 0, 0, 0, 127); 

            imagefill($target, 0, 0, $color);

            imagesavealpha($target, TRUE);

            imagecopyresampled ($target, $source, $fromMidX, $fromMidY, 0, 0, $newWidth, $newHeight, $imageX, $imageY);

        }
        else
        {
            // IF GD IS AT A LOWER REVISION LEVEL
            $target = imagecreate($width, $height);
            imagesavealpha($target, TRUE);
                $empty = imagecolorallocatealpha($thumb,0x00,0x00,0x00,127);
                imagefill($target, 0, 0, $empty);
            imagecopyresized($target, $source, $fromMidX, $fromMidY, 0, 0, $newWidth, $newHeight, $imageX, $imageY);
        }

        // SHARPEN THE PIC
        $sharpenMatrix = array
        ( array( -1.2, -1, -1.2 )
        , array( -1,   20, -1 )
        , array( -1.2, -1, -1.2 )
        )
        ;
        $divisor = array_sum(array_map('array_sum', $sharpenMatrix));
        $offset  = 0;
        imageconvolution($target, $sharpenMatrix, $divisor, $offset);

        if(imagepng($target, $image,9)){

            imagedestroy($target);
        }else{

        }

        return $image;  
    }
} 
```

编辑1：我想我应该注意到我正在上传一个.jpg图像（例如：100px X 200px）并将它们转换为.png（例如：400px X 200px），但我保留了图像的比例以完全适合目标 .png 的中心。所以我会有一个 400px X 200px .p​​ng，我的图像在中心，左右 100px，应该是透明的。这样它就可以很好地适合没有纯色作为填充的滑块。所以我调用我的函数的一个例子是`upload($image, 400, 200, 2)`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T14:59:24.307

我弄清楚了问题所在。决定我是否应该使用`imagecreatefromjpeg`或`imagecreatefrompng`错误地离开传递图像的扩展名的代码部分，而不是它的 mime 类型。我把它改成这样：

```
switch($type)
        {
            case '2' :
                $source = imagecreatefromjpeg($image);
                break;
            case '3' :
                $source = imagecreatefrompng($image);
                break;
            default : die("UNKNOWN IMAGE TYPE: $image");
        } 
```

我在那里`$type`的线路来自哪里

```
list($imageX, $imageY, $type) = getimagesize($image); 
```

所以所有的功能是：

```
if(!function_exists("upload")){
    //$image = $image file name
    //$width = intended width of resized image, if 0 it will proportion to height, overrides proportion
    //$height = intended width of resized image, if 0 it will proportion to width, overrides proportion
    //$proportion = 2,1,0;
    //------ 2 = Preserve proportions while adding a border to fill width and height  
    //------ 1 = retain proportion to fit within both given width and height
    //------ 0 = disregard proportions and resize to the exact width and height

    function upload($image, $width, $height, $proportion){
        // IS GD HERE?

        $gdv = get_gd_info();

        if (!$gdv){ 
            return FALSE;
        }

        // GET AN IMAGE THING

        $ext = trim(strtolower(end(explode('.', $image))));

        list($imageX, $imageY, $type) = getimagesize($image);   //gets information about new server image

        // GET THE LESSER OF THE RATIO OF THUMBNAIL H OR W DIMENSIONS
        $ratio_w = ($width / $imageX);
        $ratio_h = ($height / $imageY);
        $ratio   = ($ratio_w < $ratio_h) ? $ratio_w : $ratio_h;     

        if($width == 0){

            if($imageY > $height){
                $newHeight = $height;
                $newWidth = ($height/$imageY) * $imageX;    
            }else{
                $newHeight = $imageY;
                $newWidth = $imageX;    
            }

            $width = $newWidth;
            $height = $newHeight;

            // COMPUTE THUMBNAIL IMAGE CENTERING OFFSETS
            $fromMidX = 0;
            $fromMidY = 0;

        }elseif($height == 0){

            if ($imageX > $width){
                $newWidth = $width;
                $newHeight = ($width/$imageX) * $imageY;
            }else{
                $newHeight = $imageY;
                $newWidth = $imageX;    
            }

            $width = $newWidth;
            $height = $newHeight;

            // COMPUTE THUMBNAIL IMAGE CENTERING OFFSETS
            $fromMidX = 0;
            $fromMidY = 0;

        }elseif($proportion == 2){

            // COMPUTE THUMBNAIL IMAGE DIMENSIONS
            $newWidth = $imageX * $ratio;
            $newHeight = $imageY * $ratio;

            // COMPUTE THUMBNAIL IMAGE CENTERING OFFSETS
            $fromMidX = ($width - $newWidth) / 2.0;
            $fromMidY = ($height - $newHeight) / 2.0;

        }elseif($proportion == 1){

            if ($imageX > $width){
                $newHeight = ($width/$imageX) * $imageY;
                $newWidth = $width;
            }
            if ($imageY > $height){
                $newHeight = $height;
                $newWidth = ($height/$imageY) * $imageX;
            }

            $fromMidY = 0;
            $fromMidX = 0;

        }elseif($proportion == 0){

            $newWidth = $width;
            $newHeight = $height;

            $fromMidY = 0;
            $fromMidX = 0;          
        }

        switch($type)
        {
            case '2' :
                $source = imagecreatefromjpeg($image);
                break;
            case '3' :
                $source = imagecreatefrompng($image);
                break;
            default : die("UNKNOWN IMAGE TYPE: $image");
        }

        // WHICH FUNCTIONS CAN RESIZE / RESAMPLE THE IMAGE?
        if ($gdv >= 2)
        {

            // IF GD IS AT LEVEL 2 OR ABOVE
            $target = imagecreatetruecolor($width, $height);
            $color = imagecolorallocatealpha($target, 0, 0, 0, 127); 
            imagefill($target, 0, 0, $color);
            imagesavealpha($target, TRUE);
            imagecopyresampled ($target, $source, $fromMidX, $fromMidY, 0, 0, $newWidth, $newHeight, $imageX, $imageY);

        }
        else
        {
            // IF GD IS AT A LOWER REVISION LEVEL
            $target = imagecreate($width, $height);
            imagesavealpha($target, TRUE);
                $empty = imagecolorallocatealpha($thumb,0x00,0x00,0x00,127);
                imagefill($target, 0, 0, $empty);
            imagecopyresized($target, $source, $fromMidX, $fromMidY, 0, 0, $newWidth, $newHeight, $imageX, $imageY);
        }

        // SHARPEN THE PIC
        $sharpenMatrix = array
        ( array( -1.2, -1, -1.2 )
        , array( -1,   20, -1 )
        , array( -1.2, -1, -1.2 )
        )
        ;
        $divisor = array_sum(array_map('array_sum', $sharpenMatrix));
        $offset  = 0;
        imageconvolution($target, $sharpenMatrix, $divisor, $offset);

        if(imagepng($target, $image,9)){
            imagedestroy($target);
        }
        return $image;
    }
} 
```

一个示例调用是：`upload("path/to/image/on/server.png", 400, 200, 2)` 其中图像路径可以是 jpg 或 png mime 类型。但扩展名必须是 .png。我想我可以让它更聪明，你可以有任何扩展，但是对于使用这个函数的当前代码，让我保持原样更有意义。我想最终添加打开或关闭透明度的选项，并在需要时使用纯色，例如黑色。随意使用和修改它。

我计划在[这里使用一些不错的 hex2rgb/rgb2hex 函数](http://bavotasan.com/2011/convert-hex-color-to-rgb-using-php/)

# java - 来自非空值的 Java NullException

> ID：14268770
> 
> 赞同：-3
> 
> 时间：2013-01-10T22:54:41.513
> 
> 标签：java, exception, maps

当我尝试填充地图时，我无法弄清楚为什么 Java 会给我一个 NullPointerException。

```
public class ResultsClass extends Class2 {

    private Map<String,Object> result_map;

    public ResultsClass(Object o){
        this.results = o;
        System.out.println(this.results.somemethod().isEmpty());
        fill_results();
    }

    private void fill_results(){
        System.out.println(this.results.somemethod.isEmpty());
        result_map.put("ID",this.results.somemethod()); 
    }

    public static void main(String[] args) throws Exception{
        ResultsClass results = new ResultsClass(Object);
    }
} 
```

两个打印语句都说错了。

我想我只是用错了地图。我虽然 .put 输入了一个关键值。我认为我将其声明为 <"string",Object> 允许我混合和匹配将放入地图的值。即使我这样做：

```
result_map.put("id","value") 
```

我得到同样的例外。我应该使用另一种类型的地图，它可以有不同的键值类型吗？

编辑：

哇你们太狠了 我不知道必须将地图声明为这样的类。我是新来的，我没有想到。感谢您的快速回答！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T22:56:39.937

您需要实例化（“创建”）地图 - 例如：

```
private Map<String, Object> result_map = new HashMap<String, Object> (); 
```

在你这样做之前，`result_map`它是 null （不引用有效对象）并且不能使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T23:00:34.903

您没有创建地图；因此你不能使用 result_map 因为它是空的。

# iphone - 嵌套未知数量的 UIView 动画

> ID：14268771
> 
> 赞同：0
> 
> 时间：2013-01-10T22:54:42.610
> 
> 标签：iphone, ios, cocoa

我正在构建一个 iPhone 纸牌游戏，我想在每轮结束时为玩家卡片制作动画。玩家可以在每一轮结束时拥有任意数量的牌，所以我不能以任何静态方式嵌套动画代码。如果我有以下代码来为桌子上的两个卡片视图对象设置动画......

```
UICardView * __block card1 = [[UICardView alloc] init];
UICardView * __block card2 = [[UICardView alloc] init];
[UIView animateWithDuration:1.0f 
                      delay:0.0f 
                    options:UIViewAnimationCurveLinear 
                 animations:^{
                                card1.frame = CGRectOffset(cardView.frame, 0.0f, -300.0f);
                             } 
                 completion:^(BOOL finished) {
                                [UIView animateWithDuration:1.0f
                                                      delay:0.0f 
                                                    options:UIViewAnimationCurveLinear 
                                                 animations:^{
                                                                 card2.frame = CGRectOffset(cardView.frame, 0.0f, -300.0f);
                                                             } 
                                                 completion:nil]
                 }]; 
```

...我如何构建我的代码来为 NSOrderedList 中未知数量的卡片视图对象设置动画？

非常感谢你的智慧！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:15:30.230

```
-(void)animateCards:(NSMutableArray *)cards
{
    if(cards.count) {
        UICardView *cardView = [cards lastObject];
        [UIView animateWithDuration:1.0f 
                              delay:0.0f 
                            options:UIViewAnimationCurveLinear 
                         animations:^{
                             cardView.frame = CGRectOffset(cardView.frame, 0.0f, -300.0f);
                         } 
                         completion:^(BOOL finished) {
                             [cards removeLastObject];
                             [self animateCards:cards];
                         }
    } else {
        NSLog("Finished animating cards!");
    }
} 
```

您可以使用 UICardView 数组调用 animateCards。（确保复制，因为数组最后会是空的）

例如，如果你有一个 self.playerCards 作为 UICardView 的数组，你想要动画就这样调用它

```
NSMutableArray *cardsToBeAnimated = [NSMutableArray arrayWithArray:self.playerCards];
[self animateCards:cardsToBeAnimated]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T23:04:15.497

...或递归，也许：

```
- (void)animateCardNTimes:(int)times
{
    if (times <= 0) return;

    __block CardView *cv = [[CardView alloc] init]; 
    [UIView animateWithDuration:1.0f 
                          delay:0.0f 
                         options:UIViewAnimationCurveLinear 
                      animations:^{
                          cv.frame = CGRectOffset(cardView.frame, 0.0f, -300.0f);
                      } 
                      completion:^(BOOL finished) {
                          [self animateCardNTimes:times - 1];
                      }
    ];
} 
```

# android - 放置 GridView 时，resolveuri 在错误的位图 uri 上失败

> ID：14268774
> 
> 赞同：1
> 
> 时间：2013-01-10T22:54:52.837
> 
> 标签：android, gridview, bitmap, thumbnails

您好我正在尝试开发从我的手机摄像头中提取所有图像并显示在 GridView 中的 android 应用程序。但是，我收到以下错误：

```
01-11 09:38:38.890: I/System.out(6766): resolveUri failed on bad bitmap uri:   /storage/sdcard0/DCIM/.thumbnails/1347279747819.jpg 
```

事实上我得到了很多，这就是为什么当我在手机上测试它时，我可以看到滚动条但没有显示缩略图（除了 2 张图片）

这是我认为相关的代码：

```
package org.dale.dalegetcontent1;

import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.LoaderManager.LoaderCallbacks;
import android.support.v4.content.CursorLoader;
import android.support.v4.content.Loader;
import android.support.v4.widget.SimpleCursorAdapter;
import android.view.Menu;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.GridView;

public class GetContent1 extends FragmentActivity  implements LoaderCallbacks<Cursor>{

/** SimpleCursorAdapter, holds images and layout for the gridview */
SimpleCursorAdapter mAdapter;

@Override
protected void onStart() {
    super.onStart();

    /** Initializes the Loader */
    getSupportLoaderManager().initLoader(0, null, this);
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_get_content1);

    /** Getting a reference to gridview of the MainActivity layout */
    GridView gridView = (GridView) findViewById(R.id.gridview);

    /** Create an adapter for the gridview */
    /** This adapter defines the data and the layout for the grid view */
    mAdapter = new SimpleCursorAdapter(
        getBaseContext(),
        R.layout.gridview,
        null,
        new String[] { "_data","_id"} ,
        new int[] { R.id.img},
        0
    );

    /** Setting adapter for the gridview */
    gridView.setAdapter(mAdapter);

    /** Loader to get images from the SD Card */
    getSupportLoaderManager().initLoader(0, null, this);

    /** Defining item click listener for the grid view */
    OnItemClickListener itemClickListener = new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> arg0, View arg1, int position, long arg3) {

            /** Getting the cursor object corresponds to the clicked item */
            Cursor c1 = (Cursor ) arg0.getItemAtPosition(position);

            /** Getting the image_id from the cursor */
            /** image_id of the thumbnail is same as the original image id */
            String id = c1.getString(c1.getColumnIndex("image_id"));

            /** Creating a bundle object to pass the image_id to the ImageDialog */
            Bundle b = new Bundle();

            /** Storing image_id in the bundle object */
            b.putString("image_id", id);

            /** Instantiating ImageDialog, which displays the clicked image */
            ImageDialog img = new ImageDialog();

            /** Setting the bundle object to the ImageDialog */
            img.setArguments(b);

            /** Opening ImageDialog */
            img.show(getSupportFragmentManager(), "IMAGEDIALOG");
           return ;
        }

    };

    /** Setting itemclicklistener for the grid view */
    gridView.setOnItemClickListener(itemClickListener);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_get_content1, menu);
    return true;
}

/** A callback method invoked by the loader when initLoader() is called */
@Override
public Loader<Cursor> onCreateLoader(int arg0, Bundle arg1) {
    /** Getting uri to the Thumbnail images stored in the external storage */
    Uri uri = MediaStore.Images.Thumbnails.getContentUri("external");

    System.out.println("Thumb URI: "+uri.toString());

    /** Invoking the uri */
    return new CursorLoader(this, uri, null, null, null, null);
}

/** A callback method, invoked after the requested content provider returned all the data */
@Override
public void onLoadFinished(Loader<Cursor> arg0, Cursor arg1) {
    mAdapter.swapCursor(arg1);
}

@Override
public void onLoaderReset(Loader<Cursor> arg0) {
    // TODO Auto-generated method stub
}
} 
```

而我的gridview.xml在布局下：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="vertical" >
<ImageView
    android:id="@+id/img"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:contentDescription="@string/img_description"
    android:padding="10dp"
    android:adjustViewBounds="true"
/>
</LinearLayout> 
```

而我的activity_get_content1.xml在布局下：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".GetContent1" >

<GridView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/gridview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:numColumns="auto_fit"
    android:verticalSpacing="10dp"
/>

</RelativeLayout> 
```

谢谢，如果需要，很乐意提供更多信息

干杯，戴尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-25T11:33:05.643

也许您应该在 AndroidManifest.xml 中添加此权限：

```
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/> 
```

# java - 创建新的 java 实体类 (Java SE 1.7)

> ID：14268781
> 
> 赞同：1
> 
> 时间：2013-01-10T22:55:38.833
> 
> 标签：java, netbeans, annotations, entity

所以我正在尝试创建一个名为 student 的简单实体类。根据教程，我需要`@Entity`为这个类添加注释，但是当我把它放进去时，NetBeans (7) 一直抱怨找不到符号。任何想法？

哦，我的课看起来像这样

```
@Entity
public class Student
{
    //...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:58:22.683

这不是标准 Java API 的一部分，它来自 Java Enterprise 规范。在项目的“库”上单击鼠标右键，添加库，然后添加“Java EE 6 API 库”或仅添加“持久性”

# mysql - osCommerce 中产品属性的发票上仅显示前 32 个字符

> ID：14268787
> 
> 赞同：1
> 
> 时间：2013-01-10T22:56:17.007
> 
> 标签：mysql, oscommerce

具有自定义输入值的产品不会保存其整个长度，并且客户发票的前 32 个字符被剪裁。

我正在处理的商店中的一种产品有一个测试区域，供用户输入产品的自定义值。

此产品属性通过管理员设置为 150 个字符的长度，但是当有人订购并填写时，他们输入的信息在发票页面上查看时会在第 32 个字符之后被截断。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-12T23:29:58.320

您的数据库列太小而无法捕获自由文本字段，尽管您可能在管理员中将其设置为。

下订单时，购物车中每件商品的任何属性都将保存到 orders_products_attributes 表中。如果文本字段是客户可以指定的属性的一部分，则会将其保存在该项目行的 products_options_values 列中。

默认情况下，这是一`varchar(32)`列。这意味着即使您在管理控制台中将其设置为 255，数据库也只会保留前 32 个字符。

您可以通过 phpMyAdmin 或 Adminer 跳转到数据库并运行此 SQL 来增加列字段大小：

```
ALTER TABLE orders_products_attributes
 CHANGE products_options_values 
 products_options_values varchar(250) NOT NULL DEFAULT ''; 
```

上面的 SQL 会将 products_options_values 列的大小更新为最大 250 个字符。根据需要进行调整。

现在，包含自由文本产品属性的所有未来购买将在发票中显示最多 250 个字符。

# macos - 有没有一种简单的方法可以从运行 Sublime 2 的 Mac 环境中检出 TFS 中的文件？

> ID：14268789
> 
> 赞同：1
> 
> 时间：2013-01-10T22:56:20.503
> 
> 标签：macos, visual-studio, tfs, ide, sublimetext2

好的，在我详细解释之前，这是我的（非常奇怪的）设置：

**硬件**：iMac 操作系统：Mountain Lion

**软件**：

*   编辑器（Mac）：崇高 2
*   虚拟化：运行 Windows Server 2008 的 Parallels
*   IDE（Windows）：Visual Studio 2010
*   源代码管理 (Windows)：Team Foundation Server

* * *

所以这是我的困境。

我喜欢 Sublime 2。但是，作为我工作场所的 Microsoft 商店，我别无选择，只能处理 TFS。我不做很多后端编码，我是前端人员，不需要 Visual Studio 中内置的所有重要的类和结构跟踪，所以 Sublime 非常适合我。

我喜欢 Sublime 的一件事是我可以点击 cmd+p 并立即拉出任何文件。另一种方法是花几分钟筛选我们的文件结构以找到相同的文件（我们有一个庞大的项目结构......这是一个野兽）。

不幸的是，我不能只是点击 cmd+p 并拉出任何文件...我可以...但是在编辑它之后，我点击保存并且“哦哦！文件没有签出，它是只读的”。然后我必须切换空间，花几分钟筛选目录以找到我处理的同一个文件，然后检查它。切换回来，保存，然后签入。这浪费了我很多时间，并且破坏了 Sublime 文件搜索的省时优势。

我想知道是否有更简单的方法来实现这一点。我已经尝试了几件事，但都没有成功。我找到了一个将 TFS 与 Sublime 集成的插件——但它只适用于 Windows。我尝试将 Eclipse 与 TFS 插件一起使用，但在 Sublime 中编辑之前，我仍然必须浏览大量目录结构以在 Eclipse 中检出该文件。

有没有办法更好地简化这个过程？我知道通过如此极端的方式在这里和那里节省一两分钟可能听起来很愚蠢，但是当我每天这样做数百次时，它开始节省很多时间！

提前感谢社区对此提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T08:40:21.137

如果您可以说服您的 TFS 管理员团队升级到**TFS 2012**，您将获得您的解决方案。TFS 2012 支持**“本地工作区”**，它不会在磁盘上保持只读文件。您可以通过 Visual Studio 或 Eclipse 下载一次源代码，然后继续在您想要的任何编辑器中工作。TFS 客户端跟踪文件系统上的更改，您只需要 VS 或 Eclipse 在一天结束时签入您的工作。

对于 TFS 2008 和 2010，您必须手动或在受支持的 IDE 的帮助下签出文件。这些版本仅支持“服务器工作区”，并且工作区的这种风格将磁盘上的所有文件保持为只读。

在 2008 年或 2010 年艰难的情况下，您可能还有另一个机会。Windows 平台上的 TFS 2008 和 TFS 2010 支持**离线工作**，这会暂时断开您的工作区与服务器的连接以完成您的工作。然后在一天结束时，您重新联机，TFS 客户端尝试“检测”在您离线时所做的更改并让您签入。**[这篇博客文章](http://www.woodwardweb.com/vsts/tfs/five_hidden_fea.html)**说 Team Explorer Everywhere 支持离线工作。您可能需要手动删除文件的只读标志。离线工作即使在 Windows 平台上也不是完美的，你需要小心，直到你习惯它，但我相信值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T08:32:01.813

如果升级到 TFS 2012 是一个选项，那么您可能需要考虑它。

具有本地工作空间的 TFS2012 不再需要首先在 Visual Studio 中签出文件（文件不再标记为只读，并且 vs 检测来自其他程序的更改）。这将摆脱你的一个 alt-tabs 到窗口。

您仍然必须返回 alt-tab 才能签入，如果您不想让 Visual Studio 保持打开状态，您可能会使用命令行“tf checkin”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T19:26:38.880

因此，在尝试了这里的几个建议之后，在我在其他地方找到的几个建议中，我得出的结论是（对我来说）最好的设置如下：

*   编辑器（Mac）：崇高 2
*   **编辑器（PC）：带有 TFS 插件的 Sublime 2**
*   虚拟化：运行 Windows Server 2008 的 Parallels
*   IDE (Windows)：Visual Studio 2010 源代码管理
*   (Windows)：团队基础服务器

如您所见，我通过一个细微的调整更新了我现有的设置。在我的 Windows 端，我安装了 Sublime 2 并安装了 TFS 插件。如果我想签出文件，我切换到 windows，搜索文件，通过 Sublime 的 TFS 插件签出，然后切换回 Mac。这当然不理想，需要额外的步骤，但它似乎对我来说效果最好，并且比使用 Visual Studio 签入/签出要快。

If anyone comes up with a more elegant setup (aside from using TFS 2012 - which thankfully is coming for my organization), I'd love to hear about it. In the meantime, I hope this helps anyone else who might be using a setup similar to mine.

# android - ViewPager 源代码

> ID：14268792
> 
> 赞同：0
> 
> 时间：2013-01-10T22:56:30.917
> 
> 标签：android, android-viewpager

我正在尝试编辑 ViewPager 源代码。但是，如果我将文件添加到我的项目中，它会在该行上`mAdapter.registerDataSetObserver(mObserver);`说 registerDataSetObserver 方法是不可见的。mAdapter 这里是一个[PagerAdapter](http://developer.android.com/reference/android/support/v4/view/PagerAdapter.html)。如果您查看开发人员页面，PagerAdapter 确实没有 registerDataSetObserver 方法。但我也检查了 SDK 中的 PagerAdapter 源代码。原来源码中有一个 registerDataSetObserver 方法。

我在这里有点困惑。有人可以启发我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:14:33.583

viewpager 在兼容性包（又名支持库）中可用。

为什么不使用里面的那个呢？

这样，您还可以支持较旧的 android 版本（低至 API 4）。

示例：FragmentTabsPager.java 文件已被使用，在路径“...\extras\android\support\samples\Support4Demos\src\com\example\android\supportv4\app”内

# python - 细化，平均，圆形数据python

> ID：14268794
> 
> 赞同：2
> 
> 时间：2013-01-10T22:56:37.173
> 
> 标签：python, numpy, pandas, average

我有一个大型数据集（请参见下面的示例格式），我需要执行以下操作：

1.  识别出现在第 1、2、5 列上的重复值 - 如果全部重复，那么我需要删除冗余行并平均第 8 列中的值（这对于我将发布的代码是成功的 -
2.  在第一步之后，我想将第 1,2 列的值四舍五入为整数（无小数）
3.  我想重新引入第 3、4、6 和 7
    列 - 第 3、6 和 7 列需要有一个我将指定的特定值（例如，3 应该全为 0，6 全为 1，第 7 列全为 1）（类似于输入文件）第 4 列需要增加一，基于第 4 列不同值的数量）（类似于输入文件

这是一个示例输入文件：数据（文件名）

```
564991.15   7371277.89  0   1   1530    1   1   16.0225
564991.15   7371277.89  0   1   8250    1   1   14.4405
564991.15   7371277.89  0   2   1530    1   1   14.8637
564991.15   7371277.89  0   2   8250    1   1   14.8918
564991.17   7371277.89  0   3   1530    1   1   16.0002
564991.17   7371277.89  0   3   8250    1   1   15.4333
564991.04   7371276.76  0   4   1530    1   1   14.73
564991.04   7371276.76  0   4   8250    1   1   15.6138
564991.04   7371276.76  0   5   1530    1   1   16.2453
564991.04   7371276.76  0   5   8250    1   1   15.6138 
```

这是我所知道的代码（目前我在 calc 中补充）

```
import os
import numpy as np
import pandas as pd
datadirectory = '/media/data'
os.chdir = 'datadirectory'
df = pd.read_csv('/media/data/data.dat')
sorted_data = df.groupby(["X.1","X.2","X.5"])["X.8"].mean().reset_index()
tuple_data = [tuple(x) for x in sorted_data.values]
datas = np.asarray(tuple_data)
np.savetxt('sorted_data_rounded.dat', datas, fmt='%s', delimiter='\t') 
```

但他只给了我 4 列，没有四舍五入的数据....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:28:33.763

添加 half 和 cast 可能会稍微快一些：[`astype`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.Series.astype.html) `int`

```
df = pd.read_csv('data.dat', header=None, sep='\s+')

In [2]: df
Out[2]: 
           0           1  2  3     4  5  6        7
0  564991.15  7371277.89  0  1  1530  1  1  16.0225
1  564991.15  7371277.89  0  1  8250  1  1  14.4405
2  564991.15  7371277.89  0  2  1530  1  1  14.8637
3  564991.15  7371277.89  0  2  8250  1  1  14.8918
4  564991.17  7371277.89  0  3  1530  1  1  16.0002
5  564991.17  7371277.89  0  3  8250  1  1  15.4333
6  564991.04  7371276.76  0  4  1530  1  1  14.7300
7  564991.04  7371276.76  0  4  8250  1  1  15.6138
8  564991.04  7371276.76  0  5  1530  1  1  16.2453
9  564991.04  7371276.76  0  5  8250  1  1  15.6138

df1 = df.groupby([0, 1, 4])[7].mean().reset_index()
df1['ints'] = (df1[7] + 0.5).astype(int)

In [5]: df1
Out[5]: 
           0           1     4         7  ints
0  564991.04  7371276.76  1530  15.48765    15
1  564991.04  7371276.76  8250  15.61380    16
2  564991.15  7371277.89  1530  15.44310    15
3  564991.15  7371277.89  8250  14.66615    15
4  564991.17  7371277.89  1530  16.00020    16
5  564991.17  7371277.89  8250  15.43330    15 
```

*注意：您可以使用 DataFrame 方法保存 DataFrame [`to_csv`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.to_csv.html#pandas.DataFrame.to_csv)。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T23:06:24.127

使用圆形函数（）

```
x = round(number to round , number of decimal places to round the number to ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T16:25:33.370

这段代码正是我想要的：

```
import os
import numpy as np
import pandas as pd 

datadirectory = '/media/DATA'
os.chdir( datadirectory)

df = pd.read_csv('/media/DATA/data.dat', sep="\\s+", header=None)
df1 = df.groupby(["X.1","X.2","X.5"])["X.8"].mean().reset_index() 
df1['X.3'] = df["X.3"]
df1['X.4']=df["X.4"]
df1['X.6']=df["X.6"]
df1['X.7']=df["X.7"]
sorted_data = df1.reindex_axis(sorted(df1.columns), axis=1)
tuple_data = [tuple(x) for x in sorted_data.values]
datas = np.asarray(tuple_data)

dfround = df
dfround['X.1'] = df["X.1"].astype(int)
dfround['X.2'] = df["X.2"].astype(int)
df2 = dfround.groupby(["X.1","X.2","X.5"])["X.8"].mean().reset_index()
df2['X.3'] = df["X.3"] #add extra columns
df2['X.4']=df["X.4"]
df2['X.6']=df["X.6"]
df2['X.7']=df["X.7"]
sorted_data2 = df2.sort_index(axis=1) #rearragne data - method 2
tuple_data2 = [tuple(x) for x in sorted_data2.values]
datas2 = np.asarray(tuple_data2)

np.savetxt('sorted_data.dat', datas, fmt='%s', delimiter='\t') #Save the data
np.savetxt('sorted_rounded_data.dat', datas2, fmt='%s', delimiter='\t') #Save   the data
print ('DONE') 
```

# javascript - 如何在不打开邮件客户端的情况下使用 JavaScript 发送电子邮件？

> ID：14268796
> 
> 赞同：20
> 
> 时间：2013-01-10T22:56:42.523
> 
> 标签：javascript, html, html-email

我正在编写一个带有注册按钮的 HTML 页面，该按钮应该只是在不打开本地邮件客户端的情况下静默发送电子邮件。这是我的 HTML：

```
<form method="post" action="">
    <input type="text" id="email_address" name="name" placeholder="Enter your email address..." required>
    <button onclick="sendMail(); return false">Send Email</button>
</form> 
```

...这是我的 JavaScript 代码：

```
<script type="text/javascript">
  function sendMail() {
    var link = 'mailto:hello@domain.com?subject=Message from '
             +document.getElementById('email_address').value
             +'&body='+document.getElementById('email_address').value;
    window.location.href = link;
}
</script> 
```

上面的代码有效......但它打开了本地电子邮件客户端。如果我像这样删除属性中的`return`语句：`onclick`

```
<form method="post" action="">
    <input type="text" id="email_address" name="name" placeholder="Enter your email address..." required>
    <button onclick="sendMail()">Send Email</button>
</form> 
```

...然后根本不发送电子邮件。我错过了什么吗？

任何帮助将不胜感激:-)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-10T22:59:43.827

您不能让用户的浏览器静默发送电子邮件。这将是一个可怕的安全问题，因为任何网站都可以将他们的系统用作垃圾邮件中继和/或收集他们的电子邮件地址。

您需要向从您的服务器发送邮件的服务器端进程（以您选择的语言编写）发出 HTTP 请求。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-10T22:59:56.940

您需要服务器端支持来实现这一点。基本上，您的表单应该发布（AJAX 也可以）到服务器，并且该服务器应该通过 SMTP 连接到某个邮件提供商并发送该电子邮件。

即使可以使用 JavaScript（即从用户计算机）直接发送电子邮件，用户仍然必须连接到某些 SMTP 服务器（如 gmail.com），提供 SMTP 凭据等。这通常在服务器端（在您的应用程序中），它知道这些凭据。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-12-02T07:46:47.453

**直接来自客户**

* * *

[仅使用 JavaScript 发送电子邮件](https://medium.com/design-startups/b53319616782)

```
in short: 
1\. register for Mandrill to get an API key
2\. load jQuery
3\. use $.ajax to send an email 
```

像这样 -

```
function sendMail() {
    $.ajax({
      type: 'POST',
      url: 'https://mandrillapp.com/api/1.0/messages/send.json',
      data: {
        'key': 'YOUR API KEY HERE',
        'message': {
          'from_email': 'YOUR@EMAIL.HERE',
          'to': [
              {
                'email': 'RECIPIENT@EMAIL.HERE',
                'name': 'RECIPIENT NAME (OPTIONAL)',
                'type': 'to'
              }
            ],
          'autotext': 'true',
          'subject': 'YOUR SUBJECT HERE!',
          'html': 'YOUR EMAIL CONTENT HERE! YOU CAN USE HTML!'
        }
      }
     }).done(function(response) {
       console.log(response); // if you're into that sorta thing
     });
} 
```

[https://medium.com/design-startups/b53319616782](https://medium.com/design-startups/b53319616782)

注意：请记住，任何人都可以看到您的 API 密钥，因此任何恶意用户都可能使用您的密钥发送电子邮件，从而占用您的配额。

* * *

**通过您的服务器间接**- 安全

* * *

为了克服上述漏洞，您可以修改自己的服务器以在基于会话的身份验证后发送电子邮件。

**node.js** - [https://www.npmjs.org/package/node-mandrill](https://www.npmjs.org/package/node-mandrill)

```
var mandrill = require('node-mandrill')('<your API Key>'); 

function sendEmail ( _name, _email, _subject, _message) {
    mandrill('/messages/send', {
        message: {
            to: [{email: _email , name: _name}],
            from_email: 'noreply@yourdomain.com',
            subject: _subject,
            text: _message
        }
    }, function(error, response){
        if (error) console.log( error );
        else console.log(response);
    });
}

// define your own email api which points to your server.

app.post( '/api/sendemail/', function(req, res){

    var _name = req.body.name;
    var _email = req.body.email;
    var _subject = req.body.subject;
    var _messsage = req.body.message;

    //implement your spam protection or checks. 

    sendEmail ( _name, _email, _subject, _message );

}); 
```

然后在客户端使用 $.ajax 来调用您的电子邮件 API。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-10T23:00:11.077

您不能仅使用客户端脚本来执行此操作...您可以对某些将发送电子邮件的服务器端代码进行 AJAX 调用...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-01-13T17:19:33.190

我认为您可以使用[smtpjs.com](http://smtpjs.com)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-10T23:00:42.177

需要某种类型的后端框架来发送电子邮件。这可以通过 PHP/ASP.NET 或使用本地邮件客户端来完成。如果您希望用户什么都看不到，最好的方法是通过对单独的 send_email 文件的 AJAX 调用来利用这些内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-10T23:01:59.270

您需要直接在服务器上执行此操作。但更好的方法是使用 PHP。听说PHP有一个特殊的代码，可以不用打开邮件客户端直接发送邮件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-26T14:07:58.347

嗯，PHP 可以很容易地做到这一点。

可以通过 PHP`mail()`函数来完成。这是一个简单的函数的样子：

```
<?php     
$to_email = 'name@company.com';
$subject = 'Testing PHP Mail';
$message = 'This mail is sent using the PHP mail function';
$headers = 'From: noreply@company.com';
mail($to_email,$subject,$message,$headers);
?> 
```

这将向 . 文件中指定的收件人发送一封后台电子邮件`$to_email`。

为简单起见，上述示例在源代码中为电子邮件地址和其他详细信息使用硬编码值。

假设您必须为用户创建一个联系我们的表单，填写详细信息然后提交。

1.  用户可能会意外或故意在标头中注入代码，从而导致发送垃圾邮件
2.  为了保护您的系统免受此类攻击，您可以创建一个自定义函数，在发送邮件之前对值进行清理和验证。

`filter_var()`让我们创建一个自定义函数，使用内置函数验证和清理电子邮件地址。

这是一个示例代码：

```
<?php 
function sanitize_my_email($field) {
    $field = filter_var($field, FILTER_SANITIZE_EMAIL);
    if (filter_var($field, FILTER_VALIDATE_EMAIL)) {
        return true;
    } else {
        return false;
    }
}
$to_email = 'name@company.com';
$subject = 'Testing PHP Mail';
$message = 'This mail is sent using the PHP mail ';
$headers = 'From: noreply@company.com';
//check if the email address is invalid $secure_check
$secure_check = sanitize_my_email($to_email);
if ($secure_check == false) {
    echo "Invalid input";
} else { //send email 
    mail($to_email, $subject, $message, $headers);
    echo "This email is sent using PHP Mail";
}
?> 
```

我们现在将让它成为一个单独的 PHP 文件，例如`sendmail.php`.

然后，将在表单提交时使用此文件，使用表单的`action`属性，例如：

```
<form action="sendmail.php" method="post">
   <input type="text" value="Your Name: ">
   <input type="password" value="Set Up A Passworrd">
   <input type="submit" value="Signup">
   <input type="reset" value="Reset Form">
</form> 
```

* * *

希望我能帮上忙

# c++ - 在 C++ 中处理没有操作系统依赖的消息的方法是什么？

> ID：14268797
> 
> 赞同：-1
> 
> 时间：2013-01-10T22:56:48.283
> 
> 标签：c++, ipc, message

有没有办法编写 C++ 程序来处理在 Linux 和 Windows 中工作的 IPC？是否有任何 C++ 库在不依赖操作系统的情况下执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T23:03:36.973

如果“消息”是指 IPC（进程间通信），那么不，没有操作系统的参与是不可能的，而且在宇宙中可以找到的每个操作系统上，实现它的方式可能都不同。如果“消息”是指在应用程序中传递数据的任何方式，那么是的，它可以而且应该在没有操作系统参与的情况下完成。

在 IPC 的情况下，您总是可以使用[Boost.IPC](http://www.boost.org/doc/libs/1_52_0/doc/html/interprocess.html)，如果您只需要传递消息。当然，如果你还需要获取 UI 事件等，那是不够的；[Qt](http://qt.digia.com/)是 C++ 中常用的可移植 GUI 工具包之一（不是说它漂亮，但它可以工作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T23:13:58.140

如果您正在谈论套接字（又名 TCP/IP 或 UDP/IP），那么您可以使用套接字库，如果您小心的话，您可以在 Windows 和 Unix 变体上使用相同的代码。但是跨平台套接字 API 只有非常有限的异步能力（`select`调用及其相关的可伸缩性问题）。

您也可以使用[libevent](http://libevent.org/)。那是跨平台的，并且具有更丰富的异步语义。

对于命名管道或 fifos 之类的东西......我知道没有好的跨平台库来处理这些东西。

# tumblr - Tumblr：PostSummary 输出 HTML 代码

> ID：14268798
> 
> 赞同：1
> 
> 时间：2013-01-10T22:56:52.403
> 
> 标签：tumblr

当我尝试使用这些行时：

```
{block:PostSummary}
  {PostSummary}
{/block:PostSummary} 
```

我得到了 HTML 代码，而不是摘录的纯文本！

这是 Title 和 Meta:Description 元素的一个大问题。

我该怎么办？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T14:36:00.883

看看[http://www.tumblr.com/docs/en/custom_themes#variable-transformations](http://www.tumblr.com/docs/en/custom_themes#variable-transformations)

> 通过使用特殊的转换关键字为变量添加前缀，Tumblr 将以特殊格式输出变量——在将数据传递给 Javascript 等时很有用。
> 
> > [...] 为 任何主题变量加上前缀以输出带有 HTML 标记的字符串，并将适当的字符转换为 HTML 实体，以便它们可以安全地包含在 HTML 属性等中。**`Plaintext`**
> > `Plaintext`

所以它可能看起来像：

```
{block:PostSummary}
  {PlaintextPostSummary}
{/block:PostSummary} 
```

# android - 带有字符串数组和 Jsoup 的 ArrayAdapter

> ID：14268802
> 
> 赞同：0
> 
> 时间：2013-01-10T22:57:13.560
> 
> 标签：android, json, parsing, jsoup, android-arrayadapter

我能够从页面中提取 href 元素并将结果存储到字符串数组中。然后在 TextView 中显示它。如果我尝试显示到 ListView，就会出现问题。在这种情况下，我不知道如何使用 ArrayAdapters。这是我在 TextView 中显示的工作代码。

```
package com.example.jsouptestarray;

import java.io.IOException;
import java.util.ArrayList;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

import com.example.jsouptestarray.R;

import android.os.AsyncTask;
import android.os.Bundle;
import android.app.Activity;
import android.text.method.ScrollingMovementMethod;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;

public class MainActivity extends Activity {

    TextView text;
    ListView list; 

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        new MyTask().execute();  
    }

    private class MyTask extends AsyncTask<Void, Void, ArrayList<String>> {

        ArrayList<String> arr_linkText=new ArrayList<String>();

        @Override
        protected ArrayList<String> doInBackground(Void... params) {

             Document doc;
             String linkText = ""; 

             try {
                 doc = Jsoup.connect("https://www.google.com/").get();
                 Elements links = doc.getElementsByTag("a");
                 for (Element el : links) { 
                     linkText = el.attr("href");
                     arr_linkText.add(linkText); // add value to ArrayList
                 }
             } catch (IOException e) {
                 // TODO Auto-generated catch block
                 e.printStackTrace();
             }

             return arr_linkText;     //<< retrun ArrayList from here
        } 

        @Override
        protected void onPostExecute(ArrayList<String> result) {        

            // get all value from result to display in TextView
            for (String temp_result : result) {
                 System.out.println("links :: "+temp_result);
                 text = (TextView) findViewById (R.id.textView2);
                 text.append(temp_result + "\n" + "\n");
                 text.setMovementMethod(new ScrollingMovementMethod());
            }
        }

    }
} 
```

这是我对 ListView 的尝试，但我收到一个错误，我不明白如何修复它。

```
list = (ListView) findViewById(R.id.listView1);
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
          android.R.layout.simple_list_item_1, android.R.id.text1, temp_result);

// Assign adapter to ListView
list.setAdapter(adapter); 
```

这是错误的屏幕截图

![在此处输入图像描述](../Images/33e2824882c8dde88316990352e8b824.png)

我希望有人可以帮助我解决它，我很感激你的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:00:50.057

替换`this`为`MainActivity.this`。当你在 AsyncTask 内部时，`this`指的是 AsyncTask 实例，它不能传递给构造函数（不同的、不相关的、不兼容的类）

因此，您需要调用 Activity 作为参数，并且由于您的 AsyncTask 是 Activity 的一部分，因此您可以使用`ClassName.this`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T23:09:28.770

在您的情况下，构造函数的第四个元素是多余的。它可以用来一次设置数据，你应该看到[API](http://developer.android.com/reference/android/widget/ArrayAdapter.html#ArrayAdapter%28android.content.Context,%20int,%20int,%20java.util.List%3CT%3E%29)。试试这个：

```
list = (ListView) findViewById(R.id.listView1);
ArrayAdapter<String> adapter = 
    new ArrayAdapter<String>(MainActivity.this, 
                             android.R.layout.simple_list_item_1, 
                             android.R.id.text1);

for (String temp_result : result)
{
   adapter.add(temp_result);
}

// Assign adapter to ListView
list.setAdapter(adapter); 
```

# c# - 在 xaml 项目中使用 CoreWindow 交换链，为什么没有绘制？

> ID：14268806
> 
> 赞同：0
> 
> 时间：2013-01-10T22:57:24.660
> 
> 标签：c#, c++, xaml, windows-8, directx

我目前正在开发一个 Win8 项目，该项目使用 C# 和 XAML 作为应用程序的前端，使用 C++ 和 DirectX 作为图形密集型部分。因为它主要以实时图形和输入为中心，所以我决定使用为 CoreWindow 创建的 SwapChain。

虽然我设法通过将渲染线程绑定到 CompositionTarget 来运行渲染线程，但屏幕仍然是黑色的。绘图代码工作正常，它使用 ImageSurfaceSource，我最近切换到了 SwapChain。

即使初始化的任何部分都没有返回任何错误，你们中的任何人都可以阐明为什么它不绘制任何东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T04:46:13.767

完全相同的问题，我使用交换链我的整个屏幕变黑了。后端是 c++ **windows 运行时组件**，实际执行代码驻留在 C# win 8 项目中。

相同的代码开始在 c++ 项目中工作。

* * *

# 重新创建错误的步骤：

（我在这里使用互操作代码：[interop](http://msdn.microsoft.com/library/windows/apps/hh825871.aspx)）呈现给 SwapChainBackgroundPanel ）

1.  c++ **windows 运行时组件**，采用交换链，并呈现。

2.  我将此组件添加到 C++ 空白商店应用程序中，并且渲染工作正常。

3.  将相同的组件项目添加到 C# 空白商店应用程序 // 然后创建一个 swapChainPanel .. 并传递它。这就是我最终得到一个空白屏幕的地方。

# 解决方案：

我设置`CompositionTarget.Rendering += OnRendering; // the render event`

导航时。现在我注意到我从未真正导航过。

所以渲染器永远不会被调用......在构造函数上添加事件解决了我的情况。

# javascript - 我们应该使用哪种方法来执行和处理一些代码，为什么？

> ID：14268808
> 
> 赞同：0
> 
> 时间：2013-01-10T22:57:47.957
> 
> 标签：javascript

我想知道在执行某些代码的某些特定方法下隐藏了什么。

我有3种不同的方法可以做，但我真的不知道哪种情况更好，为什么。我`Case 2`大部分时间只是出于语法偏好而选择该方法，但我越来越想知道每种方法的优缺点是什么。

情况1：

```
var response = Func();
//Handle response... 
```

案例二：

```
Func(response){
  //Handle response...
}; 
```

案例3：

```
Func({
  case_x: function(opt){
    //Handle an example case...
  }
}); 
```

感谢您的解释，我对此非常好奇！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:09:34.977

假设 Func 是一个现有函数：

情况 1 是如果您的函数返回一个值并且您想要存储结果，例如：

```
function times_ten(num){ return num*10; }
var ten = 10;
var hundred = times_ten(ten); 
```

所以现在你可以从现在开始使用这个变量`hundred`了。

情况 2 是如果您没有返回值，或者您不需要保存它：

```
function write_times_ten(num){ num = num*10; document.write(num);  }
var ten = 10;
var hundred = write_times_ten(ten); 
```

案例 3 稍微复杂一些。

如果你这样做`var something={a:function(){}}`- 通过创建这样的对象，你的所有函数都在同一个范围内，所以你不会污染全局命名空间。这有点像用其他语言创建一个类。jQuery 是我能想到的最大的例子，因为它所做的所有事情都是由对象处理的`jQuery`（或调用诸如`jQuery.parseJSON(json_string)`

如果你传入一个具有类似函数的对象，那么你就是要求`Func()`对传入的函数做一些事情，如下所示：

```
function do_something_times_ten(options){
    options.num = options.num*10;
    options.do_something(num);
}
var ten = 10;
do_something_times_ten({num:ten, 
                        do_something:function(num){
                                                     num = num*10;
                                                     document.write(num);  
                                                  }
                        }
); 
```

现在会写出 1000，而不是 100。

# .htaccess - htaccess 如何在 url 中的第二个问号后获取参数？

> ID：14268810
> 
> 赞同：2
> 
> 时间：2013-01-10T22:57:56.400
> 
> 标签：.htaccess, url-rewriting

我已经像这样重写了 htaccess 的 url：

```
RewriteCond $1 !-f
RewriteCond $1 !-d
RewriteCond $1 !^(index\.php)
RewriteRule ^(.*)$  index.php?page=$1 [L] 
```

例如 url：[http](http://www.smth.com/en/page/subpage/) ://www.smth.com/en/page/subpage/在 PHP 脚本中我可以简单地调用 $_GET['page'] 来获取这些参数。

但如果我的网址看起来像： [http ://www.smth.com/en/page/subpage/?data=one&result=two](http://www.smth.com/en/page/subpage/?data=one&result=two)

如何在 PHP 中获取这些**data=one&result=two参数？**

# r - 合并数据框中的行，其中行不相交并包含 NA

> ID：14268814
> 
> 赞同：14
> 
> 时间：2013-01-10T22:58:05.950
> 
> 标签：r, dataframe, dplyr, data.table, coalesce

我有一个有两行的数据框：

```
| code | name  | v1 | v2 | v3 | v4 |
|------|-------|----|----|----|----|
| 345  | Yemen | NA | 2  | 3  | NA |
| 346  | Yemen | 4  | NA | NA | 5  | 
```

有没有一种简单的方法来合并这两行？如果我在“346”中重命名“345”会怎样，这会让事情变得更容易吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-11T17:44:02.737

您可以使用[`aggregate`](http://stat.ethz.ch/R-manual/R-devel/library/stats/html/aggregate.html). 假设您要合并 column 中具有相同值的行`name`：

```
aggregate(x=DF[c("v1","v2","v3","v4")], by=list(name=DF$name), min, na.rm = TRUE)
   name v1 v2 v3 v4
1 Yemen  4  2  3  5 
```

这就像 SQL `SELECT name, min(v1) GROUP BY name`。该`min`函数是任意的，您也可以使用`max`or `mean`，它们都从 NA 返回非 NA 值，如果 则返回非 NA 值`na.rm = TRUE`。（如果存在于 R 中，类似 SQL 的`coalesce()`函数听起来会更好。）

但是，您应该首先检查给定的所有非 NA 值`name`是否相同。例如，使用 and 运行`aggregate`两者`min`并`max`进行比较，或使用`range`.

最后，如果您有比 v1-4 更多的变量，您可以使用它`DF[,!(names(DF) %in% c("code","name"))]`来定义列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-09-26T18:45:31.240

添加`dplyr`和`data.table`解决方案的完整性

**使用`dplyr::coalesce()`**

```
library(dplyr)

sum_NA <- function(x) {if (all(is.na(x))) x[NA_integer_] else sum(x, na.rm = TRUE)}

df %>% 
  group_by(name) %>% 
  summarise_all(sum_NA)
#> # A tibble: 1 x 6
#>   name   code    v1    v2    v3    v4
#>   <fct> <dbl> <dbl> <dbl> <dbl> <dbl>
#> 1 Yemen   691     4     2     3     5

# Ref: https://stackoverflow.com/a/45515491
# Supply lists by splicing them into dots:
coalesce_by_column <- function(df) {
  return(dplyr::coalesce(!!! as.list(df)))
}

df %>% 
  group_by(name) %>% 
  summarise_all(coalesce_by_column)
#> # A tibble: 1 x 6
#>   name   code    v1    v2    v3    v4
#>   <fct> <dbl> <dbl> <dbl> <dbl> <dbl>
#> 1 Yemen   345     4     2     3     5 
```

**使用`data.table`**

```
# Ref: https://stackoverflow.com/q/28036294/
library(data.table)
setDT(df)[, lapply(.SD, na.omit), by = name]
#>     name code v1 v2 v3 v4
#> 1: Yemen  345  4  2  3  5
#> 2: Yemen  346  4  2  3  5

setDT(df)[, code := NULL][, lapply(.SD, na.omit), by = name]    
#>     name v1 v2 v3 v4
#> 1: Yemen  4  2  3  5

setDT(df)[, code := NULL][, lapply(.SD, sum_NA), by = name]
#>     name v1 v2 v3 v4
#> 1: Yemen  4  2  3  5 
```

# html - 将 < 添加到 Html 文本以在浏览器中显示

> ID：14268825
> 
> 赞同：0
> 
> 时间：2013-01-10T22:58:54.180
> 
> 标签：html

我想创建一个标签：

```
 <div id="Id_Field" class="myclass"> <<Nack>> </div> 
```

所以浏览器会显示：

```
<<Nack>> 
```

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:01:01.590

是的。使用 HTML 实体：`&gt;`和`&lt;`.

[http://en.wikipedia.org/wiki/List_of_HTML_entities#Character_entity_references_in_HTML](http://en.wikipedia.org/wiki/List_of_HTML_entities#Character_entity_references_in_HTML)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T23:01:03.183

使用字符引用`&gt;`将 < 字符表示为数据（与标记的开头相反）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T23:01:10.460

使用 < 和> 对于 < 和 >，分别

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T23:01:22.050

```
<div id="Id_Field" class="myclass"> &lt;&lt;Nack&gt;&gt; </div> 
```

在浏览器中查看时，上述 ASCII 码将转换为小于和大于符号。

# c# - 从三个表linq2sql选择中的一个值获取计数？

> ID：14268830
> 
> 赞同：0
> 
> 时间：2013-01-10T22:59:33.863
> 
> 标签：c#, c#-4.0, linq-to-sql

我只希望公寓大楼与其他值一起计数。仅添加计数会破坏代码。我得到的错误是“'System.String' 类型不支持序列运算符。” 我也尝试过将 apartCount 更改为 int ，但没有成功。任何帮助，将不胜感激

```
using (var db = new DataClasses2DataContext())
        {
            var zips = (from s in db.ZipCodeServiceAvailabilities
                        join b in db.ZipCodeBoundaries on s.ZipCode equals b.ZipCode
                        join a in db.pdx_apart_views on s.ZipCode equals a.Zip_Code
                        where (s.IsServiced == 1 && b.Ordering % 10 == 0) 
                        orderby b.ZipCode

                        select new
                        {
                            zipCode = b.ZipCode.Trim(),
                            latitude = b.Latitude,
                            longitude = b.Longitude,
                            apartCount = a.Apartment_complex.Count()

                        }).ToArray();
             } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T20:29:34.373

我认为您`group by`在查询中错过了子句。

`select`或者您可以在子句中使用关联子查询。请进一步解释您的问题

# javascript - 如何在 javascript 中重新创建 .net 成员资格 hmacsha1 哈希

> ID：14268833
> 
> 赞同：1
> 
> 时间：2013-01-10T22:59:44.413
> 
> 标签：javascript, hash, asp.net-membership, cryptojs

我正在尝试在 javascript 函数中从 .net 成员资格提供程序中重现相同的 hmacsha1 哈希和 base64 编码。我试过使用 crypto-js 并得到不同的结果。.net 代码会将“test”散列到“W477AMlLwwJQeAGlPZKiEILr8TA="

这是.net代码

```
string password = "test";
HMACSHA1 hash = new HMACSHA1();
hash.Key = Encoding.Unicode.GetBytes(password);
string encodedPassword = Convert.ToBase64String(hash.ComputeHash(Encoding.Unicode.GetBytes(password))); 
```

这是我尝试使用不会产生相同输出的crypto-js的javascript方法

```
var hash = CryptoJS.HmacSHA1("test", "");
var encodedPassword = CryptoJS.enc.Base64.stringify(hash); 
```

如何让我的 javascript 哈希与从 .net 生成的哈希匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:22:16.450

```
//not sure why crypt-js's utf16LE function doesn't give the same result
//words = CryptoJS.enc.Utf16LE.parse("test");
//utf16 = CryptoJS.enc.Utf16LE.stringify("test");

function str2rstr_utf16le(input) {
  var output = [],
      i = 0,
      l = input.length;

  for (; l > i; ++i) {
    output[i] = String.fromCharCode(
      input.charCodeAt(i)        & 0xFF,
      (input.charCodeAt(i) >>> 8) & 0xFF
    );
  }

  return output.join('');
}

var pwd = str2rstr_utf16le("test");
var hash = CryptoJS.HmacSHA1(pwd, pwd);

var encodedPassword = CryptoJS.enc.Base64.stringify(hash);
alert(encodedPassword); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T23:26:05.953

您没有在 .NET 中指定密钥：

```
var secretKey = "";
var password = "test";

var enc = Encoding.ASCII;
System.Security.Cryptography.HMACSHA1 hmac = new System.Security.Cryptography.HMACSHA1(enc.GetBytes(secretKey));
hmac.Initialize();

byte[] buffer = enc.GetBytes(password);
var encodedPassword = Convert.ToBase64String(hmac.ComputeHash(buffer)); 
```

编辑：正如@Andreas 提到的，你的问题是编码。因此，您只需在自己的代码中将 UTF 替换为 ANSI：

```
string password = "test";
System.Security.Cryptography.HMACSHA1 hash = new System.Security.Cryptography.HMACSHA1();
hash.Key = Encoding.ASCII.GetBytes("");
string encodedPassword = Convert.ToBase64String(hash.ComputeHash(Encoding.ASCII.GetBytes(password))); 
```

# zsh - tmux-powerline 显示在多行

> ID：14268837
> 
> 赞同：2
> 
> 时间：2013-01-10T23:00:05.987
> 
> 标签：zsh, tmux

我在下面的 github 链接上发布了一个问题，但简而言之，我无法让 zsh 正常工作。我愿意接受建议。

[https://github.com/erikw/tmux-powerline/issues/125](https://github.com/erikw/tmux-powerline/issues/125)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:32:05.333

您的提示符中有 UTF 字符吗？如果是这样，请确保您的`.tmux.conf`:

```
# use UTF8
set -g utf8
set-window-option -g utf8 on 
```

一些 UTF 字符会占用额外的空间，导致 tmux-powerline 出现一些奇怪的格式。

# iframe - 将 IFrame 与 Meteor 一起使用

> ID：14268840
> 
> 赞同：6
> 
> 时间：2013-01-10T23:00:21.530
> 
> 标签：iframe, meteor

我一直在寻找将 Meteor 与 iframe 一起使用的示例，但毫无结果。（请注意，我必须使用 iframe 而不是 DIV，因为内容最终会到达那里）。我都试过了：

```
<body>
  {{> hello}}
</body>

<template name="hello">
  <h1>Hello World!</h1>
  {{greeting}}
  <input type="button" value="Click to see what you typed" />
  <br>
  <iframe id="compose" src={{> iframe-content}} height=600></iframe>
</template>

<template name="iframe-content">
  <body>
    <div contenteditable="true">
      Edit me
    </div> 
  </body>
</template> 
```

这会递归加载，不断创建子 Iframe。

我也试过

```
<iframe id="compose" src="content.html" height=600></iframe> 
```

但是 Meteor 将多个 HTML 文件组合在一起，这也会导致 iframe 失败。

到目前为止，唯一有效的是 SRCDOC 而不是 SRC，但是像 FF 这样的多个浏览器并不能很好地支持它。

那么，在 Meteor 中使用 iframe 的技巧是什么，最好是在模板中，而不是严格通过代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T22:33:12.677

您想要“公共”文件夹。Meteor 将内容单独留在该文件夹中，如下所述：http: [//docs.meteor.com/#/full/structuringyourapp](http://docs.meteor.com/#/full/structuringyourapp)

将“content.html”移动到项目/应用程序根目录下名为“public”的文件夹中，并在 html 中像这样引用它：

```
<head>
  <title>iframe</title>
</head>

<body>
  {{> hello}}
</body>

<template name="hello">
  <h1>Hello World!</h1>
  {{greeting}}
  <input type="button" value="Click" />

  <iframe src="hello.html"></iframe>

</template> 
```

为了让其他读者清楚，Meteor 对 iframe 没有问题。问题在于 iframe 引用的“content.html”文件的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T23:45:53.293

我不明白你的第一个代码示例：

```
<iframe id="compose" src={{> iframe-content}} height=600></iframe> 
```

据我所知，这不是 iframe 的工作方式。你必须在 src 属性中指定一个 url，你不能只把实际的 HTML 放在那里。所以这行不通。

至于第二个例子：

```
<iframe id="compose" src="content.html" height=600></iframe> 
```

`content.html`如果您没有指定该路径存在，您希望 Meteor 到哪里？由于 Meteor 默认不设置路由，所以 /content.html 处没有资源。所以你必须添加 Meteor Router 包或一些类似的路由机制，然后告诉 Meteor 当被要求提供 /content.html 时，它应该只返回一些模板的内容。具有挑战性的部分是弄清楚如何让 Meteor 返回“真实”的 HTML，而不是通常提供的 Meteor 包装的实时 HTML 结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-10T08:46:09.003

我最近一直在玩 iframe（主要是为了封装一些为应用程序 webviews 制作的页面），如果你将这些 html 文件放在`/public`文件夹中并在 iframe src 中写入绝对 url `/file.html`，那么它就可以工作。

# python - Python/PyODBC 使用可信连接通过 IP 连接到 SQL Server 2008 数据库

> ID：14268846
> 
> 赞同：1
> 
> 时间：2013-01-10T23:00:55.483
> 
> 标签：python, sql-server-2008, pyodbc

如果有人问过这个问题，我提前道歉，虽然我找到了类似的问题，但我找不到正确的答案。

我正在尝试通过使用受信任连接的 IP / 端口连接到 SQL Server 2008 数据库。

另一个复杂点是：数据库在美国以外，通常我们通过 Citrix 登录。登录 citrix 后，它使用我们的 Windows 凭据（不确定这是否会影响问题）。

我尝试了几种不同类型的连接字符串

驱动程序=SQL Server
驱动程序=SQL Native Client
驱动程序=SQL Server Native Client 10.0

我也尝试过不同的格式，包括端口，以及在使用 IP 路由时弄乱网络库。

我希望有人可以帮助我理解两件事。

1）（最重要的是）我如何弄清楚如何正确连接而无需简单的反复试验。我尝试检查 connectionstrings.com 但这并没有太大帮助。我一直无法在网上找到任何东西。

2）如果有人可以帮助我解决连接字符串。

这是我正在做的一个例子：

```
cn = pyodbc.connect(r'DRIVER={SQL Native Client};Server=1.1.3.4,1234;Network    Library=DBMSSOCN;Initial Catalog=Test;UID=DOM\me;Pwd=pass') 
```

非常感谢任何帮助/指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T23:44:00.333

如果要使用受信任的连接，则无需指定用户或密码，而是使用 paramater `Trusted_Connection=yes`。有关文档，请参见[此处](http://code.google.com/p/pyodbc/wiki/ConnectionStrings#Security)。

过去，这样的事情对我有用：

```
cn = pyodbc.connect('DRIVER={SQL Native Client};
                     Server=1.1.3.4; DATABASE=mydb; 
                     Trusted_Connection=yes;') 
```

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2013-09-29T14:00:40.377

[在这里](http://ofers-python-articles.pythonblogs.com/227_ofers_python_articles/archive/1299_using_pythons_pyodbc_with_microsoft_sql_server_and_sql_server_data_tools_for_visual_studio.html)找到一些解释、相关链接和示例代码。

# visual-c++ - Loadframe 在 CMainFrame 中无明显原因在 CreateEx 失败

> ID：14268850
> 
> 赞同：0
> 
> 时间：2013-01-10T23:01:06.850
> 
> 标签：visual-c++, user-interface, mfc

好的，所以我的 MFC 应用程序运行良好，直到我从系统注册表中清除了该应用程序。现在我无法运行该程序。每当我尝试运行该程序时，我都会遇到异常。检查堆栈时，我注意到 CMainFrame 的 LoadFrame 中的 CreateEx 崩溃了。当在应用程序的派生 CwinApp 中调用 ProcessShellCommand 时会发生此崩溃。但是，我无法查明崩溃的确切原因。我有一种预感，它可能与资源的加载有关，但我不知道具体如何。我检查了 .rc 包含文件，对我来说它看起来不错。我只是不明白如何清除注册表会导致如此混乱。在过去的 4 个小时里一直在做这件事。所以基本上我在问你们中是否有人以前遇到过这个问题，以及您是如何在不从头开始的情况下设法修复它的？我不确定我应该放在这里澄清我的问题的代码的确切部分，所以我希望这足够清楚。谢谢

# bamboo - Bamboo with tSQLt - 无法解析测试结果文件

> ID：14268852
> 
> 赞同：3
> 
> 时间：2013-01-10T23:01:09.400
> 
> 标签：bamboo, tsqlt

首先，我应该指出我对 Atlassian 的 Bamboo 和一般的持续集成是新手。这是我使用过的第一个项目。

我使用 tSQLt 框架创建了大量的单元测试。我还将 Bamboo 配置为：

*   从 BitBucket 获取存储库的新副本
*   删除并重新创建构建数据库
*   使用 Red-Gate SQL Compare 将数据库对象从源部署到构建数据库
*   运行 tSQLt 测试
*   将测试结果以 XML 格式输出到名为 TestResults.xml 的文件中

我已经检查并可以确认 TestResults.xml 文件已创建。

然后我在 Bamboo 中添加了一个 JUnit Parser 任务来使用这个 TestResults.xml 文件的内容。但是，当该任务运行时，它会返回此错误：

`Failed to parse test result file`

起初我认为这可能意味着 Bamboo 找不到该文件。我将创建结果文件的任务更改为输出名为 TestResults2.xml 的文件。当我这样做时，JUnit Parser 返回了这个错误：

`Failing task since test cases were expected but none were found.`

所以我假设第一条错误消息意味着 Bamboo 正在查找文件，它只是无法解析文件。

我不知道从哪里开始找出问题所在。有没有人有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-31T20:35:59.873

我有几个这样的案例，并且能够通过从 *.rb 文件中的测试名称中删除单引号**和****大于**/**小于字符来修复它。**

 **> 例子
> 
> > 测试“确保 'go_to_world' 已从标头中删除且长度 < 23”
> 
> 更改以删除单引号和 < 符号
> 
> > 测试“确保从标题中删除 go_to_world 并且长度小于 23”

很常见的是缩略语：“不会不应该不应该”，或所有格：“容器的数据”。

还有**< 或 >**字符。

我认为解析器中存在一个错误，它不能适当地转义测试标题中的这些字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-15T05:26:11.817

我有一个类似的问题，但结果证明是竹子的奇怪行为，需要修改文件戳才能看到 JUnit 文件。

在 Windows 环境中，您只需要在“JUnit 任务”之前添加“脚本任务”

```
powershell  (ls *.xml).LastWriteTime = Get-Date 
```

**参考**

[https://jira.atlassian.com/browse/BAM-12768](https://jira.atlassian.com/browse/BAM-12768)**

# python - Python 并行执行 - threading.Lock 未按预期工作

> ID：14268857
> 
> 赞同：4
> 
> 时间：2013-01-10T23:01:21.440
> 
> 标签：python, parallel-processing, locking

我目前有一个 global `Lock = threading.Lock()`，并拨打以下电话：

```
Parallel(n_jobs=2)(delayed(serialRemove)(dir,c,b,l,f) for f in os.listdir(dir)) 
```

使用工作库。中`serialRemove`，我有

```
Lock.acquire()
print(f+' begin')
if h in hashes:
    try:
        os.remove(path)
        if l: print('Removing ' + path)
        removed += 1
    except os.error:
        print('Encountered error removing file') 
else:
    hashes.add(h)
print(f+' end')
Lock.release() 
```

部分调用导致：
10.txt begin
11.txt begin
20.txt begin
我不明白如果我将代码包围在 Lock 中，怎么会有两个 begin 打印。有什么简单的方法可以保护代码块，所以理想情况下我得到：
10.txt begin
10.txt end
11.txt begin
11.txt end
20.txt begin
20.txt end

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T23:27:50.720

`threading.Lock`仅适用于同一进程的线程之间。

在实际上不知道您在这里使用什么库进行并行处理的情况下，很难确定，但几乎可以肯定它是在单独的进程中执行任务。（任何在同一个进程中启动线程的东西，至少对于 CPython，都不会因为 GIL 而为 CPU 绑定代码获得任何有效的并行性。因此，他们都没有这样做。）

因此，如果您尝试使用`threading.Lock`来自其他进程的全局对象，您将在每个进程中获得一个完全独立的锁。所以，锁定它没有任何好处。（使用一些并行库——每个平台上可能不同——你会得到一个错误。但它不可能做你想做的事。）

大多数并行化库都有自己的锁类型，可以使用它们的多处理风格。如果是这样，请使用图书馆附带的那个。

如果没有，取决于您的图书馆的工作方式，[`multiprocessing.Lock`](http://docs.python.org/3/library/multiprocessing.html#synchronization-between-processes)可能会奏效。

如果没有，您将不得不使用例如锁定文件（可能与[`flock`](http://docs.python.org/3/library/fcntl.html#fcntl.flock)/一起`lockf`，或依赖于 Windows 独占打开或其他）来显式地实现某些东西。

另外，请注意，具有可以理解您的示例代码行的 API 的多个库中的至少一个 [ `joblib`] 是为没有任何共享的任务明确设计的，因此不应该与完全锁定。（它可能`multiprocessing.Lock`无论如何都可以使用，但你真的不应该指望它。）

# spine.js - Spine.js 有 updateAttributes 包括新属性

> ID：14268865
> 
> 赞同：1
> 
> 时间：2013-01-10T23:01:47.903
> 
> 标签：spine.js

似乎 Spine`Model.updateAttributes`只更新属性，如果您提供任何属性，则不会创建新属性。

在我的用例中，我有一个创建部分属性的控制器。然后通过 Ajax 请求，服务器用完整的对象进行响应，我想用其他变量更新 Spine 中的模型实例。

例如，我有一个带有属性的模型：**name**，**date_created**。通过控制器，用户实例化一个只提供**名称**的对象。Ajax 请求会通知服务器，而服务器又会以名称和**date_created**进行响应。然后应将此**date_created添加到用户的模型中。**

`Model.updateAttributes`不起作用，我也不会太喜欢删除对象并创建一个新对象——这似乎开销太大。我可以为创建时未设置的变量提供默认值，但这也有不利的一面。我想我正在寻找的是一种可以调用的方法`Model.createOrUpdateAttributes`。有人可以推荐一种方法来实现这一目标吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T13:18:25.687

我可能还没有完全理解你的用例，但我会尽力回答。**您需要使用configure**类方法声明模型类型具有的任何属性。这个声明有助于各种模型函数在以后完成它们的工作。在你声明了所有你需要的属性之后，你可以使用之前声明的任何属性来创建模型实例。您不必为所有声明的属性提供值。ajax 调用返回后，将在您的模型实例上设置**date_created 。**在这种情况发生之前，它将只是*undefined*。

如果此解决方案仍然无法为您工作，请说明原因，我很乐意提供帮助。

# sql - 在视图中将数据类型 nvarchar 转换为数字时出错

> ID：14268866
> 
> 赞同：5
> 
> 时间：2013-01-10T23:01:54.217
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-server-2008-r2

我有一个看法：

```
SELECT
u.display_name AS usuario,
g.parent_name AS grupo,
pr.pkey,
REPLACE(
    CONVERT (VARCHAR, ji.CREATED, 111),
    '/',
    '-'
) AS fecha,
CAST (ji.issuetype AS INT) AS issuetype,
a.customvalue AS aplicativo,
m.customvalue AS modulo
FROM
jiraissue AS ji
JOIN project pr ON pr.ID = ji.PROJECT
JOIN (
SELECT
    ms.*
FROM
    cwd_membership ms
INNER JOIN cwd_group gp ON (
    gp.ID = ms.parent_id
    AND group_name IN (
        'Grupo QA 1',
        'Grupo QA 2',
        'Grupo QA 3',
        'BH Seguros Homo'
    )
)
) g ON g.lower_child_name = ji.REPORTER
JOIN cwd_user u ON g.lower_child_name = u.user_name
JOIN (
SELECT
    ISSUE,
    customvalue
FROM
    customfieldvalue v
INNER JOIN customfield f ON (
    f.ID = v.customfield
    AND f.cfname = 'Aplicativo'
)
INNER JOIN customfieldoption o ON (o.ID = v.STRINGVALUE)
) a ON (a.ISSUE = ji.ID)
JOIN (
SELECT
    ISSUE,
    customvalue
FROM
    customfieldvalue v
INNER JOIN customfield f ON (
    f.ID = v.customfield
    AND f.cfname = 'Módulo'
)
INNER JOIN customfieldoption o ON (o.ID = v.STRINGVALUE)
) m ON (m.ISSUE = ji.ID)
WHERE
ji.issuetype IN (9, 11, 12, 13, 14, 15)
GROUP BY
ji.issuetype,
pr.pkey,
g.parent_name,
u.display_name,
REPLACE(
    CONVERT (VARCHAR, ji.CREATED, 111),
    '/',
    '-'
),
a.customvalue,
m.customvalue 
```

这给了我这样的东西：

```
usuario             grupo      pkey     fecha       issuetype  aplicativo 
----------------------------------------------------------------------------------
Ricardo A. Casares  Grupo QA 1  GD123   2012-11-23  12  Act-creditos-scheduler  ABM_Suc-backend 
```

然后，当我尝试查询这个视图时，让我们说一个简单的查询：

```
SELECT * FROM view
WHERE pkey LIKE '%GD123%' 
```

在某些列中，我收到“将数据类型 nvarchar 转换为数字时出错”但在其他一些列中，例如“aplicativo”，它工作正常。

为什么会这样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T23:22:49.663

问题在于这个任务：

```
o.ID = v.STRINGVALUE 
```

请更正它，它将解决问题。纠正问题的一种可能方法是使用 ISNUMERIC，例如

```
o.ID = CASE WHEN ISNUMERIC(v.STRINGVALUE) = 1 THEN v.STRINGVALUE ELSE -1 END 
```

（在 ELSE 中，您可以使用其他保证不与表 'o' 连接的数字，即可以使用 0）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T23:14:58.263

此错误意味着您有一些类型的列，`nvarchar`并且您正在尝试转换为数值（例如 int）。
*但*至少在返回的行中，该值不能转换为数字。

例如 - 尝试将“abcd”转换为数字会引发该错误。

在您提供的查询中，它可能在线：`CAST (ji.issuetype AS INT) AS issuetype`

检查中的任何数据`ji.issuetype`是否不是数字的字符串表示形式...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T23:53:10.083

您可以尝试的另一件事是使用它`ARITHABORT`来告诉 SQL 只是它不能转换的 NULL 值。

例如，在从视图中选择之前使用`SET ARITHABORT OFF`&`SET ANSI_WARNINGS OFF`应该 NULL 它无法转换的值（而不是抛出异常） - 然后您可以看到哪些行（以及哪些值）让您感到悲伤。

# java - 识别回文数的Java方法

> ID：14268869
> 
> 赞同：-1
> 
> 时间：2013-01-10T23:02:07.057
> 
> 标签：java, for-loop, palindrome

在一个练习中，我们被告知以下方法可以识别回文（前后相同的单词），但它不起作用。它接受一些不是回文的刺，我们被要求确定方法中的错误在哪里，以及我们可以纠正它。该方法`clean`去除空白，然后运行`toLowerCase`​​.

```
public boolean checkPalindrom(String sc){
    boolean isPalindrom = true;
    String sr = clean(sc);
    for(int i = 0; i < sr.length()/2; i++){
         isPalindrom = (sr.charAt(i)==(sr.charAt(sr.length()-1 - i)));
    }
return isPalindrom;
} 
```

我找不到任何不是回文但被此函数接受的字符串。

任何提示表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T23:03:25.637

一旦失败，您永远不会中断，因此您只返回最后一张支票。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T23:05:58.030

这是修复：

```
public boolean checkPalindrom(String sc){
    boolean isPalindrom = true;
    String sr = clean(sc);
    for(int i = 0; i < sr.length()/2 && isPalindrom; ++i){
         isPalindrom = (sr.charAt(i)==(sr.charAt(sr.length()-1 - i)));
    }
return isPalindrom;
} 
```

这样，一旦你发现它不是回文，你就打破了循环。否则，如果它的中间和附近有相同的字母，就会被认为是回文。

例子：

```
adcde 
```

# ios - 旋转背景图像

> ID：14268872
> 
> 赞同：1
> 
> 时间：2013-01-10T23:02:21.300
> 
> 标签：ios

我有三个要在背景中旋转的图像。以下是我到目前为止所拥有的。我想要一个可以容纳所有这些 UIImageViews 并在后台随机显示它们的类。我阅读了 UIView 和 frame 方法，但我不知道如何添加它们，因为它只需要一帧。

因此，我使用 NSArray 来保存所有对象。现在唯一的问题是当新背景出现时，旧背景并没有消失。现在我要删除旧背景吗？

如果有人能指出我正确的方向，那就太好了。

谢谢！

```
@interface ViewController : UIViewController

@property (strong, nonatomic) NSArray *imageArray;
@property (strong, nonatomic) UIImageView *imageView;

- (IBAction)buttonPressed:(UIButton *)sender;

@end 
```

// .m 文件

```
@implementation ViewController
@synthesize imageArray;
@synthesize imageView;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    imageView = [[UIImageView alloc] init];

    UIImage *image1 = [UIImage imageNamed:@"image1.png"];
    UIImage *image2 = [UIImage imageNamed:@"image2.png"];
    UIImage *image3 = [UIImage imageNamed:@"image3.png"];

    imageArray = [[NSArray alloc] initWithObjects:image1, image2, image3, nil];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)buttonPressed:(UIButton *)sender {

    NSUInteger index = arc4random_uniform(self.imageArray.count);
    [imageView setImage:[imageArray objectAtIndex:index]];

}
@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:51:28.883

在您的方法中，您创建了 6 个对象 - 3 个 UIImages 和 3 个 UIImageViews。

你想要的可以使用 4 个对象而不是 6 个对象来完成，使用更少的内存，让你的应用程序运行得更快，同时回答你的问题（另外，我假设你有所有相同大小的背景图像，大小设备的屏幕）。

我建议先创建一个 UIImageView：

```
//backgroundImage is an IVAR
backgroundImage = [[UIImageView alloc] init]; 
```

后跟三个 UIImage 并将它们放在一个 NSArray 中：

```
UIImage *image1 = [UIImage imageNamed:@"image1.png"];
UIImage *image2 = [UIImage imageNamed:@"image2.png"];
UIImage *image3 = [UIImage imageNamed:@"image3.png"];
//imagesArray is an IVAR
imagesArray = [[NSArray alloc]] initWithObjects: image1, image2, image3, nil]; 
```

最后，要更改背景，调用 random 函数并更新 UIImageView 图像属性，而不是在视图堆栈顶部弹出不同的视图：

```
NSUInteger index = arc4random() % [imagesArray count];
[backgroundImage setImage:[imagesArray objectAtIndex:index]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T23:33:19.730

这个：

```
[self.view insertSubview:current atIndex:0]; 
```

正在将另一个视图添加到您的视图层次结构中，但您不会删除之前放置的视图。所以你有一个不断增长的 UIVews 堆栈。您还将新视图放置在堆栈的底部。

尝试

```
[[[self.view subviews] objectAtIndex:[[self.view subviews] count]-1] removeFromSuperview];
[self.view addSubview:current]; 
```

或者更好 - 正如@Kaan 建议的那样 - 有一个 UIImageView 并简单地更改它的 UIImage 属性。

为此，您的数组将包含您的 UIImages 而不是您的 UIImageviews。

您的 UIView 可以*是*UIImageview，也可以*包含*UIImageview。

UIImageview 有一个可以设置的图像属性。

你的代码看起来像这样......

```
self.imageArray = [[NSArray alloc] initWithObjects:image1, image2, image3, nil];
NSUInteger index = arc4random_uniform(self.imageArray.count);
UIImage *current;
current = [self.imageArray objectAtIndex:index];
self.imageview.image = current; 
```

# r - 随机颜色的凯莱表的可视化？

> ID：14268874
> 
> 赞同：1
> 
> 时间：2013-01-10T23:02:25.433
> 
> 标签：r, visualization

我有以下数据，我可以像这样可视化

```
A = matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 2, 1, 5, 6, 3, 4, 9, 10, 7, 8, 12, 11, 3, 5, 1, 7, 2, 9, 4, 11, 6, 12, 8, 10, 4, 6, 7, 8, 9, 10, 11, 1, 12, 2, 3, 5, 5, 3, 2, 9, 1, 7, 6, 12, 4, 11, 10, 8, 6, 4, 9, 10, 7, 8, 12, 2, 11, 1, 5, 3, 7, 9, 4, 11, 6, 12, 8, 3, 10, 5, 1, 2, 8, 10, 11, 1, 12, 2, 3, 4, 5, 6, 7, 9, 9, 7, 6, 12, 4, 11, 10, 5, 8, 3, 2, 1, 10, 8, 12, 2, 11, 1, 5, 6, 3, 4, 9, 7, 11, 12, 8, 3, 10, 5, 1, 7, 2, 9, 4, 6, 12, 11, 10, 5, 8, 3, 2, 9, 1, 7, 6, 4),nrow=12,ncol=12,byrow=TRUE)
require(plotrix)
color2D.matplot(A) 
```

（`A`可以是任何整数方阵）

我需要让它以不太相似的随机颜色显示。这是我要实现的目标的示例：

![在此处输入图像描述](../Images/2bf3559e9824630621c3c33d44b6f872.png)

我一直无法让随机颜色起作用。matplot 是这个功能吗？谁能告诉我如何随机化颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:02:07.570

根据@DWin 的评论，请尝试：

```
plot(NULL, type= "n", xlim = c(1,ncol(A)), ylim = c(1, nrow(A)), xlab = "column", ylab = "row",
  main = "HCL colors, pseudo-random hue, scaled chroma and luminance")
rect(col(A)-.5,row(A)-.5,col(A)+.5,row(A)+.5,
     col = hcl(h = round(runif(length(A))*360), c = 60*A/max(A)+20, l = 60*A/max(A)+20)
    ) 
```

![在此处输入图像描述](../Images/a4ff1d3e2a7ffbd53007f8baec5ddde3.png)

我猜您仍然希望矩阵中的值仍然确定颜色的“暗度”，就像灰度图像中的情况一样。这里唯一随机的是色调——即从色轮中随机选取的角度。

# java - 在android活动之间传递数据

> ID：14268879
> 
> 赞同：-1
> 
> 时间：2013-01-10T23:03:14.290
> 
> 标签：java, android, android-intent

我正在尝试在我的 android 应用程序中的两个活动之间传递数据，但是当我尝试运行发送数据的单击方法时，应用程序崩溃了。

这是计算出我的计算试图将其发送到另一个名为结果的活动的活动代码。我试图发送的变量输出是双精度的。

```
Intent myIntent = new Intent(BMIMetric.this, result.class);
BMIMetric.this.startActivity(myIntent);
myIntent.putExtra("key", output); 
```

然后在结果页面上，我尝试使用此代码获取变量

```
Intent myIntent = getIntent();
double output = (Double) getIntent().getExtras().get("Key"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T23:06:54.633

首先，您有一个订单问题（编辑代码）：

```
Intent myIntent = new Intent(BMIMetric.this, result.class);
myIntent.putExtra("key", output);
BMIMetric.this.startActivity(myIntent); 
```

您需要在开始新的 Activity 之前设置 extras。

然后在您的其他活动中执行以下操作：

```
Intent myIntent = getIntent();
double output = getDoubleExtra ("key", -1.0); 
```

`getDoubleExtra()`似乎更合适，因为您要分配给原始数据类型。

此外，正如布鲁默所说，`"key"`拼写不同。您需要相同的拼写键，这就是它的工作原理。否则你会提到一些不同的东西，它不会被发现。

作为使用的补充`getExtras()`- 如果您使用`getExtras().get()`并且找不到密钥，您将获得`null`回报。虽然`Double`现在 s 可以自动装箱/拆箱，但如果你这样做

```
Double doubleObject = null;
double d = doubleObject; 
```

你仍然会得到一个`NullPointerException`.

# mysql - 在触发器中分配列值会导致“未知系统变量”错误

> ID：14268881
> 
> 赞同：3
> 
> 时间：2013-01-10T23:03:19.290
> 
> 标签：mysql, triggers

我发现的所有示例似乎都与我的代码相同，但我很难让它工作。这是桌子，

```
CREATE TABLE `samfoo` (
`test` varchar(10) default NULL,
`trig_field` varchar(10) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

这是触发器：

```
DELIMITER $$

DROP TRIGGER IF EXISTS footrigger$$

CREATE TRIGGER samtrigger
BEFORE INSERT ON samfoo
FOR EACH ROW
BEGIN
  SET trig_field = 1;
END$$

DELIMITER ; 
```

当我运行它时，我得到了错误`Unknown system variable 'trig_field'`。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T23:05:20.210

它应该是`SET NEW.trig_field := 1;`

# ruby-on-rails - 将自定义路由添加到控制器时出错

> ID：14268883
> 
> 赞同：0
> 
> 时间：2013-01-10T23:03:26.167
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes

我已经重写了我的问题以更准确。我有一个银行账户控制器/模型。

我的控制器上有以下方法

```
def search
  #@ledgeritems = Ledgeritem.where("bankaccount_id = ? and transactiondate >= ? and transactiondate < ?", params[:bankaccount_id], params[:startdate], params[:enddate])
  @bankaccount = Bankaccount.find(params[:bankaccount_id])
  respond_to do |format|
    format.js { render :partial => "bankaccount/bankledger" }
  end
end 
```

我已经两次尝试调用它。

**尝试 1**

尝试 1 的路线

```
resources :bankaccounts do
    post "search"
end 
```

当我做耙子时，这显示了以下路线

```
bankaccount_search POST   /bankaccounts/:bankaccount_id/search(.:format) bankaccounts#search 
```

调用尝试 1 的 Javascript

```
$.ajax({
    type: "POST",
    url: "/bankaccounts/" + bank_account_id + "/search.js",
    data: $('#edit_bankaccount_' + bank_account_id).serialize(),
    success: function (result, status) {
        $('#bank_ledger_div').html(result);
    }
}); 
```

这会在我的控制器上调用正确的路由，但服务器将其视为 PUT 而不是 POST 并返回 404。

**尝试 2**

尝试 2 的路线

```
resources :bankaccounts do
  collection do
    post "search"
  end
end 
```

当我做耙子时，这显示了以下路线

```
search_bankaccounts POST   /bankaccounts/search(.:format)       bankaccounts#search 
```

调用尝试 2 的 Javascript

```
$.ajax({
    type: "POST",
    url: "/bankaccounts/search.js",
    data: $('#edit_bankaccount_' + bank_account_id).serialize(),
    success: function (result, status) {
        $('#bank_ledger_div').html(result);
    }
}); 
```

这会调用更新路由，但仍显示为 PUT 命令。在 Firebug 中，我看到 500 错误，结果如下

```
Couldn't find Bankaccount with id=search 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:06:55.353

通常，此错误意味着您正在发出 GET 请求而不是 POST 请求。

例如：

假设 GET /bankaccounts/search 正在请求 ID = search 的银行帐户的 SHOW 页面

尽管

POST /bankaccounts/search 将正确地击中您的操作。

**编辑：**

```
resources :bankaccounts do
  collection do
    post "search"
  end
end 
```

也是正确的。现在我注意到您这样做是为了获取数据：

```
data: $('#edit_bankaccount_' + bank_account_id).serialize() 
```

该表单中可能有一个隐藏字段，由rails 放置在那里，名称='_method' 和值='PUT'。这就是使您的 POST 确实是 PUT 的原因。您需要从序列化数据中删除它才能正确发布表单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T23:17:43.287

URL 需要格式

```
/bankaccounts/:bankaccount_id/search 
```

错误来自这种方法吗？/bankaccounts/search 可以匹配另一条路线吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T23:09:07.590

如果您希望在`/search`不指定 id 的情况下使用 url，则应将其声明为`collection`action ：

```
resources :bankaccounts do
  collection do
    post "search"
  end
end 
```

您可以使用`rake routes`命令检查应用程序中定义的路由，以确保您定义了您的意思。

# c# - 我如何才能确定属性在 GridDataViewer 中的显示方式

> ID：14268886
> 
> 赞同：0
> 
> 时间：2013-01-10T23:04:09.847
> 
> 标签：c#

情况是这样的：

我有一个`Form`包含一个`DataGridView`. 即`DataGridView`绑定到一个对象`BindingSource`。绑定的对象有`Property`一个枚举。

我想要做的是在其中放置一列，`DataGridView`而不是显示枚举的数量，我想将它映射到`String`

有没有一种简单的方法可以做到这一点？

我正在考虑向`Property`返回`String`我想要显示的模型添加另一个，但如果可能的话，我想避免这种情况。

编辑：

是这样的`enum`：

```
public enum FilterClass
{
    TypeAFilter = 1,
    TypeBFilter = 2,
    TypeCFilter = 3
}; 
```

我对 C# 世界很陌生，所以也许我做错了什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:36:03.650

您是否想在字符串表示中获取每个枚举的名称

例如在你的课堂上做这样的事情

这只是您放置枚举声明的一个示例，请让我知道这是否是您想要的，否则我将不得不更改我的答案

```
namespace sampleLogin
{
    public enum FilterClass
    {
        TypeAFilter = 1,
        TypeBFilter = 2,
        TypeCFilter = 3
    };

    public partial class frmLogin : Form
    {
      public frmLogin()
      {
        InitializeComponent();

        foreach (FilterClass fltClass in Enum.GetValues(typeof(FilterClass)))
        {
            Console.WriteLine(fltClass.ToString());
        }
    }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T00:08:56.150

假设您**无法更改业务对象**（假设它是第 3 方组件），您可以简单地创建一个自定义列：

```
private void Form1_Load(object sender, EventArgs e)
{
    // filling up example data
    var s = new List<InfoItem>();
    s.Add(new InfoItem() { PropertyA = "PA", PropertyB = 1, PropertyC = DateTime.Now, PropertyD = InfoItemType.Item_B });
    s.Add(new InfoItem() { PropertyA = "PB", PropertyB = 2, PropertyC = DateTime.Now, PropertyD = InfoItemType.Item_C });
    s.Add(new InfoItem() { PropertyA = "PC", PropertyB = 3, PropertyC = DateTime.Now, PropertyD = InfoItemType.Item_A });
    s.Add(new InfoItem() { PropertyA = "PD", PropertyB = 4, PropertyC = DateTime.Now, PropertyD = InfoItemType.Item_B });

    // assign my collection to the DataGrid
    dg.DataSource = s;

    // let's create one more column at the end
    var column = new DataGridViewColumn();
    column.CellTemplate = new DataGridViewTextBoxCell();
    column.HeaderText = "Custom Column";
    column.Name = "customColumn"; // important name to remember
    column.DataPropertyName = "PropertyD"; // the Enum Property
    dg.Columns.Add(column); // add the column
}

// let's make the use of the `CellFormatting` event
private void dg_CellFormatting(object sender, DataGridViewCellFormattingEventArgs e)
{
    // If the column is the "customColumn", check the value. 
    if (this.dg.Columns[e.ColumnIndex].Name == "customColumn")
    {
        if (e.Value != null)
        {
            // let's change to whatever we want...
            switch ((InfoItemType)e.Value)
            {
                case InfoItemType.Item_A: e.Value = "I'm A"; break;
                case InfoItemType.Item_B: e.Value = "I'm B"; break;
                case InfoItemType.Item_C: e.Value = "I'm C"; break;
                default: e.Value = "I'm not..."; break;
            }
        }
    }
} 
```

请记住将事件附加到`DataGridView`对象上

![在此处输入图像描述](../Images/d3a2036cee24f91172dfd97c82f73a96.png)

那么**结果**将是这样的：

![在此处输入图像描述](../Images/8d2919530bc5a99bd6cc13e6991861e3.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T23:28:42.433

我将在 BusinessObject 类中创建一个新字段，该字段表示枚举的字符串表示并将 DataGridView 的 Column 绑定到此属性。这种方法是否满足您的要求？

```
public string EnumString {
  get { 
    FilterClass fClass = this.FilterClass;
    return fClasss.ToString();
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-11T00:00:16.607

您可以为`DataGridView.CellFormatting`. 在处理程序中，第一个参数是 DataGridView（声明为对象），第二个参数是 type`DataGridViewCellFormattingEventArgs`并且它有一个 property `ColumnIndex`。如果调用是针对正确的列索引，那么您可以从中获取`row`, 和，然后以您喜欢的任何方式格式化单元格。 `cell``DataGridView`

还有一种更复杂的方法，您可以将事件处理程序分配给列，但我不会在这里重复。如果您对此方法感兴趣，请参阅我的其他帖子。

因此，在您想要显示的对象上创建另一个属性可能更简单。但是为了完整起见，我添加了这个答案。

# macos - 什么是“非法指令：4”错误，为什么“-mmacosx-version-min=10.x”会修复它？

> ID：14268887
> 
> 赞同：83
> 
> 时间：2013-01-10T23:04:12.550
> 
> 标签：macos, gcc, osx-lion, osx-mountain-lion, osx-leopard

`Illegal Instruction: 4`当这些二进制文件在 Mac OS X 10.7.x（“Lion”）和更早版本下运行时，我在 Mac OS X 10.8.2（“Mountain Lion”）下使用 GCC 4.7.2 编译的二进制文件出错。二进制文件在 Mac OS X 10.8.x 下正常工作。

我添加`-mmacosx-version-min=10.5`到我的编译标志中，这似乎有助于解决 10.5.x、10.6.x 和 10.7.x 客户端的问题，无论是什么问题。

这引起了我的问题：

*   错误是什么`Illegal Instruction: 4`？
*   为什么要在更大的客户端`-mmacosx-version-min=10.x`上修复此特定错误？`10.x`

我想将此修复应用到我的 makefile，但想在扣动扳机之前知道它在做什么。（我会有更大的二进制文件吗？我还有 64 位二进制文​​件吗？我应该知道这种方法的陷阱吗？意外的副作用？等等。）

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-11T20:12:53.617

来自[Apple 开发者论坛](https://devforums.apple.com/message/773142)（需要帐户）：

> “编译器和链接器能够使用在旧操作系统版本上不起作用的功能和执行优化。`-mmacosx-version-min`告诉工具您需要使用哪些操作系统版本，因此这些工具可以禁用无法在这些操作系统版本上运行的优化。如果您需要在较旧的操作系统版本上运行，则必须使用此标志。
> 
> “不利的一面`-mmacosx-version-min`是，如果不需要向后兼容，应用程序在较新的操作系统版本上的性能可能会更差。在大多数情况下，差异很小。”

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-01-10T23:18:55.783

“非法指令”消息只是告诉您，您的二进制文件包含您尝试运行它们的操作系统版本不理解的指令。我不能给你确切的意思，`4`但我希望这是苹果内部的。

否则看看这些......它们有点旧，但可能会告诉你你需要知道的

[64 位代码如何在 OS-X 10.5 上运行？](https://stackoverflow.com/questions/2482285/how-does-64-bit-code-work-on-os-x-10-5?rq=1)
[macosx-version-min 是什么意思？](https://stackoverflow.com/questions/2923502/what-does-macosx-version-min-imply)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-07-06T07:45:39.197

[考虑到这](https://meta.stackexchange.com/questions/23996/does-it-make-sense-to-answer-old-questions)一点，我有意识地写了一个老问题的答案，因为其他答案对我没有帮助。

我`Illegal Instruction: 4`在编译它的同一个系统上运行二进制文件，所以`-mmacosx-version-min`没有帮助。

我在 Mac OS X 10.11 上的 Code Blocks 16 中使用 gcc。

但是，关闭所有代码块的编译器标志以进行优化是可行的。因此，查看代码块设置的所有标志（右键单击项目 ->“构建属性”）并关闭所有您确定不需要`-s`的`-O`标志，尤其是优化标志。那是为我做的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-07-07T04:29:50.140

我发现我的问题不
`if (leaf = NULL) {...}`
应该出现在应该出现的地方
`if (leaf == NULL){...}`

检查那些编译器警告！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-10-05T20:25:53.980

尝试使用 Xcode 10 构建时出现此错误。这似乎是 Swift 编译器中的错误。建立`Whole Module Optimization`在，解决了这个问题：[https ://forums.swift.org/t/illegal-instruction-4-when-trying-to-compile-project/16118](https://forums.swift.org/t/illegal-instruction-4-when-trying-to-compile-project/16118)

这不是一个理想的解决方案，我会继续使用 Xcode 9.4.1 直到这个问题得到解决。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-04-16T12:51:33.740

就我而言，我在超载时得到了这个

```
ostream & operator << (ostream &out, const MyClass &obj) 
```

并忘记返回`out`。在其他系统中，这只会产生一个警告，但在 macos 上它也会产生一个错误（尽管它似乎打印正确）。

通过添加正确的返回值解决了错误。就我而言，添加`-mmacosx-version-min`标志没有效果。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-16T13:44:46.383

我最近遇到了这个错误。我已经用 -O3 编译了二进制文件。谷歌告诉我这意味着“非法操作码”，这对我来说似乎很可疑。然后我关闭了所有优化并重新运行。现在错误转换为段错误。因此，通过设置 -g 并运行 valgrind 我跟踪了源并修复了它。重新启用所有优化后没有进一步出现非法指令 4。

显然，优化错误的代码会产生奇怪的结果。

# javascript - Backbone.js：在 jQuery 插件上捕获自定义事件？

> ID：14268890
> 
> 赞同：0
> 
> 时间：2013-01-10T23:04:26.167
> 
> 标签：javascript, jquery, jquery-plugins, backbone.js, backbone-events

我有一个搜索表单的主干视图。该表单包含几个元素，包括在[jSlider](http://egorkhmelev.github.com/jslider/)中实现的滑块。我想捕获对表单的所有更改，并相应地更新显示的结果。

我可以很好地捕获点击事件，但我不知道如何在 jSlider 上捕获幻灯片事件 - 我知道[如何在 Backbone 中绑定自定义事件](https://stackoverflow.com/questions/5379290/how-to-trigger-bind-custom-events-in-backbone-js-views)，但 jSlider[似乎没有办法直接绑定它](http://egorkhmelev.github.com/jslider/)。

这是我的 HTML：

```
 <form id="searchform">
   <input type="text" id="city" />
   <input type="text" id="type" />
   <input id="price-jslider" type="slider" name="price" value="1;500" />
   </form> 
```

这是我的主干代码：

```
var SearchFormView = Backbone.View.extend({
    el: $('#searchForm'),
    events: {
      "click input": "updateResults",
      // how to capture slide event on jslider?
    },
    updateResults: function(e) {
      // do stuff 
    }
   }); 
```

有人对如何捕捉此类事件有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:15:14.983

`onstatechange`您可以在初始化 jQuery 滑块时传递一个函数：

```
var SearchFormView = Backbone.View.extend({
    el: $('#searchForm'),
    render: function() {
        var self = this;
        $("#price-jslider").slider({
            onstatechange: function( value ) {
                self.updateResults();
            }
        });
    },
    events: {
      "click input": "updateResults"
    },
    updateResults: function(e) {
      // do stuff 
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T23:20:08.663

来自 jslider 页面

onstatechange function(value) 当滑块改变状态时函数触发。

回调函数（值）函数在“mouseup”事件时触发。

当您实例化 jslider 时，您在选项中定义这些函数

```
$(whatever).jslider({
       onstatechange : function(v) {
                 //set your input value to v
                 $('#searchForm').trigger('click')
     }
   }) 
```

# javascript - 将 SVG 文件转换为 Raphael 的可能方法有哪些

> ID：14268894
> 
> 赞同：3
> 
> 时间：2013-01-10T23:04:34.337
> 
> 标签：javascript, svg, raphael

假设我将一些`.ai`文件保存为`.svg`. 现在我想将所有向量从这个文件移动到 Raphael 以使用 JavaScript 操作它们。

我该怎么做？有哪些可能的方法来实现这一目标？也请写下任何优点和缺点，以便用户能够以他们认为的方式选择最好的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T23:26:32.773

几个月前我不得不做同样的事情。我用[**拉帕**](https://github.com/DmitryBaranovskiy/rappar)

我使用命令行中的节点进行转换并将其保存到文件中

```
node rappar.js test.svg >test.js 
```

test.js 现在包含向量。我唯一找到的是 rappar 的第 537 行

```
var files = process.ARGV.slice(0); 
```

应该

```
var files = process.argv.slice(0); 
```

除此之外，它是一种享受。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T23:04:34.337

[我在这里](http://readysetraphael.com/)找到了一些简单的转换器。

**优点：** 这真的很简单直接——你上传文件，然后得到生成的代码。你甚至可以看到它的预览。当你加载非常简单`.svg`时，它工作得很好，你可以轻松地编辑代码，但是......

**缺点：** 但它最大的问题是代码有点乱。因此，如果您加载更大的文件（100 多个向量，甚至更多；出于测试目的，我加载了大约 1000 个）。它的名称和结构也不响应层的划分。有时某些图层（您可以在预览中看到）的顺序不正确，因此如果您想看到完全相同的“图像”，您需要浏览代码，查看哪个路径对应于`.svg`文件中的哪个对象。

无论如何，这是我找到的唯一一个，最后（经过一些工作）你可以实现你想要的。使用它的最佳方法是逐部分上传 .svg 文件，以避免大量杂乱的代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T23:17:28.487

您可以遍历 SVG 的节点并将它们一一写入 Raphaël 对象，但除非您正在处理非标准元素类型/属性，否则最好使用 Raphaël 插件之一，该插件使导入 SVG 成为单行命令. 如：

*   [https://github.com/crccheck/raphael-svg-import-classic](https://github.com/crccheck/raphael-svg-import-classic)
*   [https://github.com/wout/raphael-svg-import](https://github.com/wout/raphael-svg-import)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-10T23:12:57.547

这对我来说非常有效[http://roomandboard.github.com/vectron/](http://roomandboard.github.com/vectron/) 在[https://github.com/DmitryBaranovskiy/rappar](https://github.com/DmitryBaranovskiy/rappar)安装 rappar 依赖项时，您需要删除 Node.js 代码才能使其正常工作.

优点：不需要太多代码。

缺点：在较大的 SVG 上可能会有点慢。您可能需要考虑使用另一个 Raphael 插件将其保存为 JSON，以便下次加载更快。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-01-10T23:06:50.943

所有向量都在文件中，因此您可以将这些路径放入变量字符串，Raphael 将使用它。

# visual-studio-2010 - Visual Studio/TFS 可扩展性：为什么 DocumentService 会给我一个 InvalidCastException？

> ID：14268895
> 
> 赞同：4
> 
> 时间：2013-01-10T23:04:35.630
> 
> 标签：visual-studio-2010, outlook-addin, outlook-2007, tfs-workitem, outlook-2007-addin

我正在为 Microsoft Outlook 2007 编写插件。我的目标是在 Visual Studio 2010 实例中打开一个工作项，我知道该实例存在并且为 TFS 2012 加载了包。以下代码工作正常，直到最后一行给出我是一个 InvalidCastException：

```
Imports Microsoft.VisualStudio.TeamFoundation.WorkItemTracking
Imports Microsoft.TeamFoundation.Client
Imports Microsoft.VisualStudio.OLE.Interop
Imports Microsoft.VisualStudio.Shell

Private Sub Test()

    Dim vsObj As IServiceProvider = System.Runtime.InteropServices.Marshal.GetActiveObject("VisualStudio.DTE.10.0")
    Dim sp As New ServiceProvider(vsObj)
    Dim docService As DocumentService = sp.GetService(GetType(DocumentService))

    ... do stuff with docService ...

End Sub 
```

这是完整的异常文本：

> 无法将类型为“System.__ComObject”的 COM 对象转换为类类型“Microsoft.VisualStudio.TeamFoundation.WorkItemTracking.DocumentService”。表示 COM 组件的类型的实例不能转换为不表示 COM 组件的类型；但是，只要底层 COM 组件支持对接口的 IID 的 QueryInterface 调用，它们就可以转换为接口。

我向服务提供商询问了 DocumentService，它给了我*一些东西*，但那东西告诉我它实际上不是 DocumentService。这是怎么回事？我如何让 DocumentService 知道它是一个 DocumentService，或者我如何获得实际上是一个的东西？

编辑：我还尝试删除“As DocumentService”以通过无效的演员表，但是当我将其作为 Watch 进行检查时，没有发现任何关于该对象的其他内容。我还尝试了以下方法（[在此处](http://www.mztools.com/articles/2006/mz2006013.aspx "卡洛斯·金特罗，06 年 2 月")推荐），希望它能对问题有所了解：

```
 Dim vsObj As IServiceProvider = System.Runtime.InteropServices.Marshal.GetActiveObject("VisualStudio.DTE.10.0")
    Dim sp As New ServiceProvider(vsObj)
    Dim docService = sp.GetService(GetType(DocumentService))

    'Note that I still didn't specify a type for docService above.
    MsgBox(Microsoft.VisualBasic.Information.TypeName(docService)) 
```

令我惊恐的是，消息框上写着“DocumentService”，只是重申了我的愤慨。我真的不知道该怎么办。

这篇相关文章是我能找到的最接近遇到同样问题的人的文章，但没有得到回答：[如何从 Visual Studio 外部打开 WorkItem (VS-Team Explorer)？](https://stackoverflow.com/questions/3987693/how-to-open-workitem-vs-team-explorer-from-outside-visual-studio/3990978).

谢谢！

# delphi - 单击鼠标滚轮按钮，像 Google Chrome 一样滚动

> ID：14268897
> 
> 赞同：3
> 
> 时间：2013-01-10T23:04:56.843
> 
> 标签：delphi, delphi-7, mousewheel

在 Google Chrome 中，当您单击鼠标滚轮按钮时，您会看到以下光标：

![在此处输入图像描述](../Images/427781606fdfbf1373747a3292d0cfbb.png)

然后，当您用鼠标四处移动时，您可以滚动到所有可能的方向......

IE 也有这个，但只是上下移动：

![在此处输入图像描述](../Images/f4e5009236c2aee94d764be13cf62879.png)

Delphi 有没有可以做到这一点的组件？（以 TScrollBox 为例）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T21:09:20.500

似乎此功能在 RAD studio 2009 中[可用](http://www.trichview.com/forums/viewtopic.php?p=8711)（但在 D7 中不可用）。您需要使用`Imouse`(imouse.pas 单元) 并且该控件必须具有 csPannaable 的 ControlStyle。

引用：

> Imouse（imouse.pas 单元）是使用中键滚动（也称为“鼠标平移”）的标准实现。它也用于 RAD Studio。Imouse 功能依赖于标准窗口滚动条，并将 WM_HSCROLL/WM_VSCROLL 发送到窗口以使其滚动。它适用于每个具有滚动条的窗口（例如，如果 AutoScroll 为 True 并且至少一个滚动条可见，则 TListView、TTreeView、甚至 TForm/TFrame）。
> 
> 哦，我忘记了一件事。控件必须在 ControlStyle 中具有 csPannaable，但 RichView 默认没有。所以，添加代码后：RichViewEdit1.ControlStyle := RichViewEdit1.ControlStyle + [csPanniable];

虽然我没有测试它。剩下的就是查看源代码（当我可以拿到 D2009 的副本时），也许用 D7 来暗示这个......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-11T00:04:50.670

例如，TMemo 可以为您做到这一点，只要您将其 ScrollBars 属性设置为 ssNone 以外的其他值。它甚至会根据启用的滚动条进行调整。TScrollBar 组件的问题在于它本身没有任何可聚焦的部分并且不会接收 OnMouseWheel(/Up/Down) 事件，但它包含的窗口控件可能会。不过，您可以为主要表单事件编写一个解决方法。[在http://www.delphipages.com/forum/showthread.php?t=197309](http://www.delphipages.com/forum/showthread.php?t=197309)查看解决方案

**编辑**： OnMouseWheel(/Up/Down) 应该是 OnMouse(/Up/Down)，感谢@Sertac Akyuz 指出这一点；）

# java - java GregorianCalendar 添加小时奇怪的行为

> ID：14268899
> 
> 赞同：0
> 
> 时间：2013-01-10T23:05:03.580
> 
> 标签：java, calendar, gregorian-calendar

我对 GregorianCalendar 有疑问，所以请您帮我解决。首先，我会给你我的代码：

```
private String changeClock(String day, String clock, int change) {
    String time="";
    DateFormat df=new SimpleDateFormat("yyyy-MM-dd hh:mm");
    try {
        Date d=df.parse(day+" "+clock);
        GregorianCalendar g=new GregorianCalendar();
        g.setTime(d);
        g.add(GregorianCalendar.HOUR_OF_DAY, change);
        time=g.get(GregorianCalendar.YEAR)+"-"
                +(g.get(GregorianCalendar.MONTH)+1)+"-"
                +g.get(GregorianCalendar.DAY_OF_MONTH)+" "
                +g.get(GregorianCalendar.HOUR_OF_DAY)+":"
                +g.get(GregorianCalendar.MINUTE);
    } catch (Exception e) {
        e.printStackTrace();
    }
    return time;
} 
```

让我解释一下发生了什么。我有一个带有 + 和 - 按钮的 GUI。当有人按下 + 时，它会增加一小时，或者如果按下 - 则需要一小时。

现在例如，时间是 23:00，我按 +，一切正常，它跳到第二天的 00:00。问题出现在 12:00。如果是 12:00 并且我按 + 它会转到 1:00，然后继续。即使在 2x12 小时或 21465x12 小时之后，它也不会移动到第二天。如果我可以这么说，倒退会好一点。当它是 00:00 并且我按下 - 它会更改为昨天 23:00（日期也会更改）。如果我然后按 + 它也会改变一天（在这种情况下到今天）。

我做错了什么或者我应该在我的代码中写什么？

谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T23:24:09.047

您的日期格式错误...

您正在使用`hh`，这是*“上午/下午 (1-12) 小时”*的表示，因此下午 1 点的时间被转换为上午 1 点。

您应该使用`HH`which 是*"Hour in day (0-23)"*的表示形式。

要么，或者您需要提供带有 am/pm 标记的日期/时间格式...

使用`DateFormat df=new SimpleDateFormat("yyyy-MM-dd HH:mm");`或`DateFormat df=new SimpleDateFormat("yyyy-MM-dd hh:mm a");`

而不是依赖`String`日期/时间值，您应该传入和返回一个`Date`对象，保留显示的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-17T21:44:01.253

# jquery - jQuery延迟动画

> ID：14268900
> 
> 赞同：-1
> 
> 时间：2013-01-10T23:05:06.130
> 
> 标签：jquery, jquery-animate, delay

第一个`<div>`下移动画效果很好。我想`<div>`在延迟 500 毫秒后向上滑动。它工作不正常。有谁知道为什么？

这很有效，没有延迟：

```
$('#first-div').animate({top:"640px"},3000);
$('#second-div').slideDown("1000"); 
```

但我想在第一次向下移动`<div>`后延迟第二次向上滑动`<div>`。但它不工作`.delay()`

```
$('#first-div').animate({top:"640px"},3000);
$('#second-div').delay(5000).slideup("1000"); 
```

我尝试使用的完整脚本是：

```
$(document).ready(function() {

      $('#first-div').animate({top:"640px"},3000);
      $('#second-div').delay(5000).slideup("1000");
      }); 
```

延迟后第二次`<div>`向上滑动不起作用！我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:15:45.777

如果您希望第二个动作发生在第一个动作之后，您可以使用该`complete`函数

```
$(document).ready(function() {

    $('#first-div').animate({top:"640px"}, 3000, function() {
        //executes after the animation completes
        $('#second-div').slideDown("1000");
    });

}); 
```

**编辑**

[在这里](http://api.jquery.com/animate/)查看更多信息`animate`。

# jquery - Jquery 日历工具

> ID：14268904
> 
> 赞同：0
> 
> 时间：2013-01-10T23:05:21.800
> 
> 标签：jquery, plugins, jquery-plugins

我只是想知道是否有一个 jquery 日历工具。我尝试在[http://api.jquery.com/](http://api.jquery.com/)上搜索，但找不到任何东西。似乎 jquery 错过了这个，或者我只是错过了一些东西。

如果jquery没有这个，有人可以分享/推荐一个好的jquery日历工具/插件吗？

PS我的目标是通过JSON获得月份的字符串名称：sample (0 -> january, 1 -> february, ...)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:07:34.360

jQuery UI 有一个日期选择器 -> [http://jqueryui.com/datepicker/](http://jqueryui.com/datepicker/)

许多现代浏览器都内置了日期选择器，因此如果浏览器不支持，您可能只想使用 jQuery UI 日期选择器。请参阅[http://net.tutsplus.com/tutorials/javascript-ajax/quick-tip-cross-browser-datepickers-within-minutes/](http://net.tutsplus.com/tutorials/javascript-ajax/quick-tip-cross-browser-datepickers-within-minutes/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T23:07:44.920

有 jQuery UI [datepicker](http://jqueryui.com/datepicker/#inline)。

不过，jQuery UI 仍然需要核心 jQuery 库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T23:07:08.090

你应该看看[jQuery UI](http://jqueryui.com/)

# facebook - FQL 流不返回限制定义的帖子数

> ID：14268907
> 
> 赞同：2
> 
> 时间：2013-01-10T23:05:37.920
> 
> 标签：facebook, facebook-fql

我试过`"SELECT post_id, actor_id, target_id, message, likes FROM stream WHERE source_id = me() LIMIT 100"`了，它返回 81 而不是 100 个帖子，然后我尝试`"SELECT post_id, actor_id, target_id, message, likes FROM stream WHERE source_id = me() LIMIT 50"`了，并期望它返回 50 个帖子，因为第一个查询返回 81，但结果只包含 43 个帖子。

想知道 LIMIT 是如何工作的。

此外，这`created_time`并不适合我， `"SELECT post_id, actor_id, target_id, message, likes FROM stream WHERE source_id = me() AND created_time > 1262196000 LIMIT 100"`返回 81 个帖子，而`"SELECT post_id, actor_id, target_id, message, likes FROM stream WHERE source_id = me() AND created_time > 1262196000"`只返回 5 个。知道吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T23:22:23.520

是的，这很正常。Facebook 执行您的 FQL 并返回与您的查询匹配的所有帖子。在这种情况下，有 100 个帖子。

*然后*Facebook 会过滤掉您的应用程序看不到的帖子。这是基于演员的隐私设置。表中没有允许您预先过滤结果`visible_to_me`的字段。`stream`

如果您想要 100 个帖子，请要求 200 个，然后显示前 100 个。大多数情况下，您将在结果中获得至少 100 个帖子。

如果您`stream`不带查询`LIMIT`，您将获得最近 50 个帖子或最近 30 天的项目，*以较少者为准*。

作为奖励，对于您的`created_time`查询，`strtotime()`如果您不考虑 UNIX 时间戳（我不考虑），则可以使用 FQL 创建时间戳。`strtotime()`它解析与 PHP函数相同的字符串。

# r - 在 R 中使用拆分扩展数据框

> ID：14268908
> 
> 赞同：1
> 
> 时间：2013-01-10T23:05:50.870
> 
> 标签：r, split

> **可能重复：**
> [从 data.frame 中“解包”一个因子列表](https://stackoverflow.com/questions/14226575/unpacking-a-factor-list-from-a-data-frame)

如果我有一个与这样的格式相同的数据框

```
X   geneA,geneB
Y   geneD,geneF
Z   geneH,geneL,geneS 
```

我正在尝试找到一种快速有效的扩展方式，以便我可以拆分（用逗号）第二列并分配第一列的相应值给我这样的东西

```
X   geneA
X   geneB
Y   geneD
Y   geneF
Z   geneH
Z   geneL
Z   geneS 
```

先谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:14:35.210

这是使用`melt.list`包中的解决方案`reshape2`：

```
library(reshape2)

dat = read.table(header=FALSE, stringsAsFactors=FALSE,
                 text="X   geneA,geneB
                       Y   geneD,geneF
                       Z   geneH,geneL,geneS")

lst = strsplit(dat$V2, ",")
names(lst) = dat$V1

res = melt(lst)

res
#   value L1
# 1 geneA  X
# 2 geneB  X
# 3 geneD  Y
# 4 geneF  Y
# 5 geneH  Z
# 6 geneL  Z
# 7 geneS  Z 
```

# python - 使用 python（或 R）清理表丢失数据

> ID：14268911
> 
> 赞同：0
> 
> 时间：2013-01-10T23:05:57.813
> 
> 标签：python, r

我有一个像这样组织的表格（curves.csv）（没有组织会更好的描述）

```
CL,D,PD,CL,D,PD,CL,D,PD,CL,D,PD,CL,D,PD
A,1,a,B,1,b,C,1,c,D,1,d,E,1,e
A,2,f,B,3,g,C,2,h,D,4,i,E,2,j
A,5,k,B,6,l,C,5,m,D,8,n,E,5,o 
```

我想将此表转换为

```
,A,B,C,D,E
1,a,b,c,d,e
2,f,,h,,j
3,,g,,,
4,,,,i,
5,k,,m,,o
6,,l,,,
8,,,,n, 
```

我目前有这个：

```
celllines=["A","B","C","D","E"]
sorted_days=["1","2","3","4","5","8"]
for d in sorted_days:
    curves=open("curves.csv","rU")
    for line in curves:
        line=line.rstrip().rsplit(",")
        if line[0]!="CL":#removes header
            for x in range(0,len(line),3):
                if line[x] in celllines:
                    if line[x+1] == d:
                        print d,line[x],line[x+2]
                    else:
                        print d, line[x],""

    curves.close() 
```

我只是觉得我正在进一步形成答案，而不是更接近！一如既往，任何指针都会非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:41:31.153

我发现解决此类问题的最佳方法是将旧格式的分解和新格式的构建分开。取而代之的是，将旧格式分解为一个健全的数据结构，以便在 Python 中轻松使用数据，然后使用这种良好的、可延展的结构构建新格式。

无论我们在哪里使用逗号分隔值，我们都可以通过使用标准库中[的`csv`模块](http://docs.python.org/3.3/library/csv.html)来简化这一切，并大大简化了这种工作。

该解决方案还大量使用[了列表理解（以及它的各种表亲）](http://www.youtube.com/watch?v=pShL9DCSIUw)，因此如果您不熟悉它们，我建议您阅读一下（之前链接的是我解释它们的简短视频）。

```
import csv
import itertools

def grouper(n, iterable, fillvalue=None):
    args = [iter(iterable)] * n
    return itertools.zip_longest(fillvalue=fillvalue, *args)

with open("curves.csv") as file:
    data = csv.reader(file)
    next(data) #Ignore header row.
    parsed = {(column, row): value for line in data
              for column, row, value in grouper(3, line)}

rows = sorted({row for (_, row) in parsed})
columns = sorted({column for (column, _) in parsed})

with open("output.csv", "w") as file:
    writer = csv.writer(file)
    writer.writerow([None] + columns)
    writer.writerows([[row]+[parsed.get((column, row))
                             for column in columns]
                      for row in rows]) 
```

我们首先使用`with`语句打开文件（确保文件关闭的最佳实践），然后跳过标题行并解析数据。为此，我们获取数据中的每一行，然后将行分组为长度为 3 的块（使用`grouper()`函数，它是[一个`itertools`recipie](http://docs.python.org/3/library/itertools.html#itertools-recipes)）。这为我们提供了列、行和值，然后我们将其用作字典的键和值。

这给了我们一个字典`{("A", 1): "a", ...}`。这是一种很好的工作格式，所以现在我们将文件重新构建为所需的格式。

首先我们需要知道我们需要哪些行和列，我们只从解析的数据中获取行，并创建一个集合（因为集合不能包含重复项），最后将它们重新排序到一个列表中，这样我们就有了正确的顺序。

然后我们打开我们的输出文件，并将列写入其中（记住`None`为行标题列添加一个），然后写出我们的数据。对于每一行，我们写入行号，然后从我们解析的数据中获取每一列的值，如果没有值，则使用[`dict.get()`](http://docs.python.org/2/library/stdtypes.html#dict.get)so 我们得到。`None`这给出了想要的输出。

注意：看来您在问题中使用的是 Python 2.x，我的答案是用 3.x 编写的。唯一的区别应该`itertools.zip_longest()`是`itertools.izip_longest()`在 3.x 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T23:23:56.463

像这样的东西怎么样，使用`csv`模块：

```
import csv

# make a dictionary to store the data
data = {}

# first, read it in
with open("curves.csv", "rb") as fp:

    # make a csv reader object
    reader = csv.reader(fp)

    # skip initial line
    next(reader)

    for row in reader:
        # for each triplet, store it in the dictionary
        for i in range(len(row)//3):
            CL, D, PD = row[3*i:3*i+3]
            data[D, CL] = PD

# see what we've got
print data

with open("newcurves.csv", "wb") as fp:
    # get the labels in order
    row_labels = sorted(set(k[0] for k in data), key=int)
    col_labels = sorted(set(k[1] for k in data))

    writer = csv.writer(fp)
    # write header
    writer.writerow([''] + col_labels)

    # write data rows
    for row_label in row_labels:
        # start with the label
        row = [row_label]

        # then extend a list of the data in order, using the empty string '' if
        # there's no such value
        row.extend([data.get((row_label, col_label), '') for col_label in col_labels])

        # dump it out
        writer.writerow(row) 
```

这给了我们一个看起来像的字典

```
{('1', 'D'): 'd', ('1', 'E'): 'e', ('5', 'C'): 'm', ('1', 'B'): 'b', ('2', 'E'): 'j', ('1', 'C'): 'c', ('5', 'A'): 'k', ('6', 'B'): 'l', ('2', 'C'): 'h', ('1', 'A'): 'a', ('4', 'D'): 'i', ('8', 'D'): 'n', ('2', 'A'): 'f', ('3', 'B'): 'g', ('5', 'E'): 'o'} 
```

和一个输出文件，如

```
~/coding$ cat newcurves.csv 
,A,B,C,D,E
1,a,b,c,d,e
2,f,,h,,j
3,,g,,,
4,,,,i,
5,k,,m,,o
6,,l,,,
8,,,,n, 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-12T02:31:11.183

只是为了表明（有点晚）它也可以在 R 中完成：

```
curves <- read.csv("curves.csv", as.is = TRUE)
stack  <- data.frame(CL = unlist(curves[, c(TRUE, FALSE, FALSE)]),
                     D  = unlist(curves[, c(FALSE, TRUE, FALSE)]),
                     PD = unlist(curves[, c(FALSE, FALSE, TRUE)]),
                     stringsAsFactors = FALSE)
library(reshape2)
output <- acast(stack, D ~ CL, value.var = "PD", fill = "")
write.csv(output, "new_curves.csv", quote = FALSE) 
```

* * *

如果你不喜欢使用第三方包，那么你可以用 base 来做这一切：

```
curves   <- read.csv("curves.csv", as.is = TRUE)
rownames <- sort(unique(unlist(curves[, c(FALSE, TRUE, FALSE)])))
colnames <- sort(unique(unlist(curves[, c(TRUE, FALSE, FALSE)])))
output   <- matrix("", nrow = length(rownames), ncol = length(colnames),
                       dimnames = list(rownames, colnames))
fill.i   <- match(unlist(curves[, c(FALSE, TRUE, FALSE)]), rownames)
fill.j   <- match(unlist(curves[, c(TRUE, FALSE, FALSE)]), colnames)
fill.x   <- unlist(curves[, c(FALSE, FALSE, TRUE)])
output[cbind(fill.i, fill.j)] <- fill.x
write.csv(output, "new_curves.csv", quote = FALSE) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-12T05:09:54.080

R 解决方案与`tapply`-ing 连接函数，c。

```
cvrs <- read.table(text="CL,D,PD,CL,D,PD,CL,D,PD,CL,D,PD,CL,D,PD
 A,1,a,B,1,b,C,1,c,D,1,d,E,1,e
 A,2,f,B,3,g,C,2,h,D,4,i,E,2,j
 A,5,k,B,6,l,C,5,m,D,8,n,E,5,o", header=TRUE, sep=",", check.names=FALSE)

long <- rbind(crvs[, 1:3], crvs[, 4:6], crvs[, 7:9], crvs[, 10:12])
out <- with( long, tapply(PD, list(D, CL), FUN=c) )
#-----------------
 write.table(out, quote=FALSE, sep=",", na="")
A,B,C,D
1,a,b,c,d
2,f,,h,
3,,g,,
4,,,,i
5,k,,m,
6,,l,,
8,,,,n 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-11T01:03:45.657

不使用`csv`模块：

```
celllines=["","A","B","C","D","E"]
days=["1","2","3","4","5","6","7","8"]

curves = sum([line.split(',') for line in open("curves.csv","rU").read().split()[1:]], [])

group = {(d,cl): pd for (cl,d,pd) in [curves[i:i+3] for i in range(0,len(curves),3)]}
table = [[d if not x else '' for x in celllines] for d in days]

for (d,cl),pd in group.items():
    table[days.index(d)][celllines.index(cl)] = pd

with open("curves2.csv", "w") as f:
    f.write('\n'.join(','.join(line) for line in [celllines]+table)) 
```

# c# - 如何打开 mpx 项目文件，然后将其另存为 mpp 项目？

> ID：14268915
> 
> 赞同：0
> 
> 时间：2013-01-10T23:06:14.597
> 
> 标签：c#, asp.net, ms-project, aspose, mpxj

我在 Asp .Net Mvc3 中有一个应用程序，我正在使用 mpxj 库来生成一个项目文件（扩展名为 mpx）。但是这个文件不包含任务的日期，然后我想用 Ms Project 打开文件，然后用新格式保存（Ms 项目为任务创建日期）。细节是我想自动完成。可能吗？什么是最好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T15:26:10.833

我知道`interop` `MsOffice`在 Asp.NET 中不推荐[http://support.microsoft.com/kb/257757](http://support.microsoft.com/kb/257757)。但是需要自动计算日期，我正在处理错误，并且我正在使用`MsProject Interop`. 这是我的代码：

```
Microsoft.Office.Interop.MSProject.Application app = new Microsoft.Office.Interop.MSProject.Application();
app.DisplayAlerts = false;
app.AskToUpdateLinks = false;

app.FileOpenEx(
        Server.MapPath("") + "\\sample.mpx",
        false,
        Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,
        PjPoolOpen.pjPoolReadWrite, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);
         Microsoft.Office.Interop.MSProject.Project pj=app.ActiveProject;

app.CalculateAll(); //Para calcular las fechas

app.FileSaveAs(Server.MapPath("") + "\\sample.mpp",PjFileFormat.pjMPP, Type.Missing, Type.Missing,Type.Missing,           Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing,Type.Missing); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-31T08:01:33.397

导入库`Microsoft.Office.Interop.MSProject`。

从 ASP.NET Web 窗体中查看我的代码。您可以对任何版本的 ASP 执行相同的操作；你也可以用 ASP.NET Core 来做，但这会改变一些小事情。

1.  如果您注意到，我将文件保存在路径中`c:\temp`

2.  我将前面的文件作为变量`fu_upload`并制作我的过程，然后保存文件并打开它以供阅读。

    ```
     ApplicationClass appclass = new ApplicationClass();

     object oMissing = System.Reflection.Missing.Value;
     object mppfile = @"c:\Temp";
     if (fu_Upload.PostedFile.FileName.Contains(@"\"))
         mppfile += fu_Upload.PostedFile.FileName.Substring(fu_Upload.PostedFile.FileName.LastIndexOf("\\"), fu_Upload.PostedFile.FileName.Length - fu_Upload.PostedFile.FileName.LastIndexOf('\\'));// fu_Upload.PostedFiles[0].FileName;
     else
         mppfile += @"\" + fu_Upload.PostedFile.FileName;
     fu_Upload.PostedFile.SaveAs(mppfile.ToString());
     object oFormat = "sample.mpx";
     object oReadOnly = true;

     PathFile = mppfile.ToString();

     UploadFileToFileSpacePage(fu_Upload, PathFile);

     appclass.DisplayAlerts = false;
     //    var projectdoc ;
     appclass.FileOpen(mppfile, oReadOnly, Microsoft.Office.Interop.MSProject.PjMergeType.pjDoNotMerge, oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, oFormat, oMissing, Microsoft.Office.Interop.MSProject.PjPoolOpen.pjPoolReadOnly, oMissing, oMissing, oMissing, oMissing);

     Microsoft.Office.Interop.MSProject.Project project = appclass.ActiveProject;

     return project; 
    ```

# php - IIRF / APACHE 重写条件失败，查询字符串

> ID：14268920
> 
> 赞同：1
> 
> 时间：2013-01-10T23:06:39.130
> 
> 标签：php, apache, url-rewriting, query-string, iirf

我有一个 CMS 系统，可以将丑陋的 URL 转换为更友好的 URL。

到目前为止的实例，而不是页面 url 是这样的：

```
/pagebase.php?id=3644 
```

我为每个页面设置了一个 url 写入设置，以使其更友好。

例如：

```
RewriteRule ^/events$   /pagebase.php?id=3644 [I] 
```

这样当用户输入 domain.com/events 时，他们会拉到 url 上方。

这适用于几乎所有页面，除了这个我需要添加额外的查询字符串以便我可以做这样的事情。

```
www.domain.com/events?y=2010=&m=&1d=2 
```

那将重写为

```
www.domain.com/pagebase.php?id=3366&y=2010=&m=&1d=2\. 
```

唯一的问题是 url 写入匹配失败，因为它没有将 ?y=2010=&m=&1d=2 视为查询字符串，而是将其视为 url 的一部分并失败。

我需要修改我的重写文件以允许通过查询字符串。

我想做类似 RewriteRule ^/events-%QUERYSTRING% $ /pagebase.php?id=3644 + %QUERYSTRING% [I]

它从匹配中删除查询字符串，然后将其附加到写入的 url 的末尾。我只是对 url 重写如何做到这一点没有足够的知识。

这是我的重写文件的示例。

```
RewriteRule ^/events$   /pagebase.php?id=3644
RewriteRule ^/faqs$   /pagebase.php?id=3659
RewriteRule ^/gallery$   /pagebase.php?id=3645
RewriteRule ^/gifts$   /pagebase.php?id=3646 
```

我需要适用于所有页面的东西，我不想修改每个规则来处理特定的查询字符串，我只想要一个通用的解决方案来传递查询字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T14:38:28.027

您可以尝试**匹配一个可选的查询字符串**，并用`[QSA]`修饰符附加它：

```
RewriteRule ^/events(\?.*)?$   /pagebase.php?id=3644 [QSA,L]
RewriteRule ^/faqs(\?.*)?$     /pagebase.php?id=3659 [QSA,L]
RewriteRule ^/gallery(\?.*)?$  /pagebase.php?id=3645 [QSA,L]
RewriteRule ^/gifts(\?.*)?$    /pagebase.php?id=3646 [QSA,L] 
```

# c - 在 C 中执行大量字符串连接？

> ID：14268928
> 
> 赞同：5
> 
> 时间：2013-01-10T23:07:04.573
> 
> 标签：c, string, concatenation, string-concatenation

我正在将一些代码从 Java 移植到 C，到目前为止一切顺利。

但是，我在 Java 中有一个特殊的函数可以自由使用`StringBuilder`，如下所示：

```
StringBuilder result = new StringBuilder();
// .. build string out of variable-length data
for (SolObject object : this) {
    result.append(object.toString());
}
// .. some parts are conditional
if (freezeCount < 0) result.append("]");
else result.append(")"); 
```

我意识到 SO 不是代码翻译服务，但我不是要求任何人翻译上述代码。

我想知道如何在 C 中有效地执行这种类型的大量字符串连接。它主要是小字符串，但每个字符串都由一个条件决定，所以我不能将它们组合成一个简单的`sprintf`调用。

我怎样才能可靠地进行这种类型的字符串连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T23:23:51.863

将多个“对象”转换为字符串的一种相当“聪明”的方法是：

```
 char buffer[100];
 char *str = buffer;
 str += sprintf(str, "%06d", 123);
 str += sprintf(str, "%s=%5.2f", "x", 1.234567); 
```

这是相当有效的，因为 sprintf 返回复制的字符串的长度，所以我们可以将 str 向前“移动”返回值，并继续填写。

当然，如果有真正的 Java 对象，那么您需要弄清楚如何将 Java 风格的 ToString 函数变成 C 的 printf 系列中的“%somethign”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T23:12:09.557

性能问题`strcat()`是它必须扫描目标字符串以找到终止符`\0'`，然后才能开始附加到它。

但请记住，`strcat()`它不接受*字符串*作为参数，而是接受*指针*。

如果您维护一个单独的指针，该指针始终指向`'\0'`您要附加到的字符串的终止，您可以将该指针用作 的第一个参数`strcat()`，并且不必每次都重新扫描它。就此而言，您可以使用`strcpy()`rater than `strcat()`。

保持这个指针的值并确保有足够的空间作为练习。

注意：您可以使用它`strncat()`来避免覆盖目标数组的末尾（尽管它会默默地截断您的数据）。我不建议`strncpy()`为此目的使用。见[我对这个问题的咆哮](http://the-flat-trantor-society.blogspot.com/2012/03/no-strncpy-is-not-safer-strcpy.html)。

如果您的系统支持它们，则（非标准）`strcpy()`和`strlcat()`函数可能对这种事情有用。他们都返回他们试图创建的字符串的总长度。但是它们的使用会降低您的代码的可移植性；另一方面，您可以在任何地方使用开源实现。

另一种解决方案是调用`strlen()`您要附加的字符串。这并不理想，因为它会被扫描两次，一次`strcat()`又一次`strlen()`——但至少它避免了重新扫描整个目标字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T23:43:05.297

连接字符串时性能不佳的原因是内存的重新分配。Joel Spolsky 在他的文章[Back to basics](http://www.joelonsoftware.com/articles/fog0000000319.html)中讨论了这一点。他描述了连接字符串的简单方法：

> Shlemiel 找到了一份街头画家的工作，在路中间画出虚线。第一天，他把一罐油漆带到路上，完成了 300 码的路。“那还不错！” 他的老板说，“你是一个快速的工人！” 并付给他一个戈比。
> 
> 第二天，Shlemiel 只完成了 150 码。“嗯，那不如昨天好，但你仍然是一个快速的工人。150码是体面的，”并付给他一个戈比。
> 
> 第二天，Shlemiel 粉刷了 30 码的道路。“只有三十个！” 他的老板喊道。“这不可接受！第一天你做了十倍的工作！这是怎么回事？”
> 
> “我无能为力，”Shlemiel 说。“我每天都离油漆罐越来越远！”

如果可以，您想知道目标缓冲区在分配之前需要多大。唯一现实的方法是调用`strlen`所有要连接的字符串。然后分配适当数量的内存并使用稍微修改的版本`strncpy`返回指向目标缓冲区末尾的指针。

```
// Copies src to dest and returns a pointer to the next available
// character in the dest buffer.
// Ensures that a null terminator is at the end of dest.  If
// src is larger than size then size - 1 bytes are copied
char* StringCopyEnd( char* dest, char* src, size_t size )
{
    size_t pos = 0;
    if ( size == 0 ) return dest;

    while ( pos < size - 1 && *src )
    {
        *dest = *src;
        ++dest;
        ++src;
        ++pos;
    }
    *dest = '\0';
    return dest;
} 
```

请注意如何将`size`参数设置为目标缓冲区结束前剩余的字节数。

这是一个示例测试功能：

```
void testStringCopyEnd( char* str1, char* str2, size_t size )
{
    // Create an oversized buffer and fill it with A's so that 
    // if a string is not null terminated it will be obvious.
    char* dest = (char*) malloc( size + 10 ); 
    memset( dest, 'A', size + 10 );
    char* end = StringCopyEnd( dest, str1, size );
    end = StringCopyEnd( end, str2, size - ( end - dest ) );
    printf( "length:  %d - '%s'\n", strlen( dest ), dest );
}

int main(int argc, _TCHAR* argv[])
{
    // Test with a large enough buffer size to concatenate 'Hello World'.
    // and then reduce the buffer size from there
    for ( int i = 12; i > 0; --i )
    {
        testStringCopyEnd( "Hello", " World", i );
    }
    return 0;
} 
```

产生：

```
length:  11 - 'Hello World'
length:  10 - 'Hello Worl'
length:  9 - 'Hello Wor'
length:  8 - 'Hello Wo'
length:  7 - 'Hello W'
length:  6 - 'Hello '
length:  5 - 'Hello'
length:  4 - 'Hell'
length:  3 - 'Hel'
length:  2 - 'He'
length:  1 - 'H'
length:  0 - '' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T23:37:32.427

如果此类操作非常频繁，您可以在自己的缓冲区类中实现它们。示例（为简洁起见，省略了错误处理；-）：

```
struct buff {
        size_t used;
        size_t size;
        char *data;
        } ;

struct buff * buff_new(size_t size)
{
struct buff *bp;
bp = malloc (sizeof *bp);
bp->data = malloc (size);
bp->size = size;
bp->used = 0;
return bp;
}

void buff_add_str(struct buff *bp, char *add)
{
size_t len;
len = strlen(add);

        /* To be implemented: buff_resize() ... */
if (bp->used + len +1 >= bp->size) buff_resize(bp, bp->used+1+len);

memcpy(buff->data + buff->used, add, len+1);

buff->used += len;
return;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T23:12:08.060

`strcat`鉴于字符串看起来如此之小，如果性能成为问题，我倾向于使用并重新审视。

您可以创建自己的方法来记住字符串长度，因此它不需要遍历字符串来查找结尾（如果您对长字符串进行大量附加，这可能是 strcat 的缓慢位）

# c# - .Include() 特定类型的派生类？

> ID：14268929
> 
> 赞同：1
> 
> 时间：2013-01-10T23:07:04.890
> 
> 标签：c#, .net, entity-framework

这个 Lambda 查询有什么问题？我希望能够只包含某种类型的 ProjectDocs，可能有多种类型的 ProjectDocs

```
 ICollection<Project> projects = db.Projects
      .Include(i => i.ProjectDoc.OfType<Cover>().Where(s => s.Status == "Active"))
      .Include(i => i.ProjectDoc.OfType<Summary>().Where(s => s.Status == "Active"))
      .Include(i => i.User)
      .Include(i => i.ProjectTag.Select(t => t.Tag)).ToList(); 
```

我有一个带有派生类 Cover、Segment 和 Summary 的模型 ProjectDoc。我应该只包含 ProjectDoc 并稍后在条件中使用鉴别器列吗？一些类型可能有大量结果，而另一些则只有少数。

我得到的错误...

```
 The Include path expression must refer to a navigation property defined 
 on the type. Use dotted paths for reference navigation properties and the 
 Select operator for collection navigation properties.
 Parameter name: path 
```

“项目”上的导航属性是 ProjectDoc。派生类没有导航属性。当我尝试这样做时，我得到了很多额外的钥匙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:53:18.293

不支持此方案 - 您只能加载或不加载一组相关实体，但不能应用过滤器表达式来仅加载实体的子集。

的[API 文档`Include()`](http://msdn.microsoft.com/en-us/library/gg671236)列出了支持的不同表达式，并声明该方法只是将工作委托给以`Include()`字符串为参数的底层方法，例如[`ObjectQuery.Include()`](http://msdn.microsoft.com/en-us/library/bb738708.aspx). 此方法的文档和链接页面[Shaping Query Results](http://msdn.microsoft.com/en-us/library/bb896272.aspx)或多或少地表明不支持此方法。

# asp.net-mvc - 如何修改从基本控制器（MVC4）返回的视图模型

> ID：14268943
> 
> 赞同：0
> 
> 时间：2013-01-10T23:08:56.247
> 
> 标签：asp.net-mvc, inheritance, asp.net-mvc-4

我正在尝试实现基本控制器、应用程序服务、存储库设计。我是这个级别的 OO 设计的新手，但已经完成了它。剩下的障碍是如何处理扩展我的基本控制器。

我的目标：

1.  有一个可以独立存在的基本控制器......即您可以从它继承一个特定的控制器，但它本身是空的并让它工作。
2.  在我需要扩展基本控制器的情况下，可以在特定控制器中这样做。

这是我所拥有的：

基本控制器：

```
public class BaseControllerSingle<TRepository, TViewModelSingle> : BaseController
...
// GET: /InventoryMgmt/ManageItems/Edit/5
        public virtual ActionResult Edit( 
            int id = 0,
            string pageTitleNoun = "",
            Expression<Func<TRepository, bool>> predicate = null
        )
        {
            TViewModelSingle viewModelSingle = new TViewModelSingle();

            ViewBag.Mode = "EDIT";

            if (id == 0) //Add new company mode
            {
                viewModelSingle = _baseAppServSingle.CreateNewViewModel(CurrentUserId);
                ViewBag.Header = "Create New " + pageTitleNoun;
                ViewBag.Mode = "NEW";
                return View(viewModelSingle);
            }

            //else edit existing record mode
            viewModelSingle = _baseAppServSingle.CreateEditViewModel(id, predicate);
            ViewBag.Header = "Edit " + pageTitleNoun;

            return View(viewModelSingle);
        } 
```

还有我的特定控制器。请注意这里的代码是不正确的（特别是“ItemViewModel viewModel = actionResult(ItemViewModel);”......但试图展示我正在尝试的内容，这本质上是从操作结果中提取视图模型，进一步操作它，然后返回它。

```
public class ManageItemsController : BaseController
...
// GET: /InventoryMgmt/ManageItems/Edit/5
        public ActionResult Edit(int id = 0)
        {
            ActionResult actionResult = GetBaseControllerSingle().Edit(
                "Material", 
                id, 
                x => x.Id == id && x.CompanyId == CurrentCompanyId);

            ItemViewModel viewModel = actionResult(ItemViewModel);
            if (id == 0)
            {
                viewModel = _manageItemsAppServ.CreateNewViewModel(viewModel, CurrentCompanyId);
            }

            viewModel.DDLOptions = _manageItemsAppServ.CreateFilterOptionsViewModel(CurrentCompanyId);
            return View(viewModel);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T21:57:23.943

我决定重写一些代码来消除这种必要性。我想也许它可以用 Ninject 来完成……但这不是我现在想要做的事情

# javascript - 如何动态地将歌曲传递给 jPlayer？

> ID：14268947
> 
> 赞同：0
> 
> 时间：2013-01-10T23:09:10.433
> 
> 标签：javascript, jquery, asp.net, visual-studio-2012, jplayer

我现在正在开发一个看起来像地铁的 asp.net 应用程序。这是一个 mp3 播放器，您可以在其中选择艺术家（单击磁贴），然后选择专辑（相同），然后从列表中选择一首歌曲。

现在我想将选择的歌曲的文件名和位置传递给 jPlayer，以便它替换实际播放的歌曲。我知道如何播放播放器构造函数中指定的一首歌曲，但不知道如何动态更改它。

我不需要坚持使用 jPlayer，如果您可以向我推荐任何其他可以以更简单的方式完成上述操作的播放器，那就没问题了 :)

（英语不是我的主要语言，如有错误请见谅，希望可以理解）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:15:19.397

你试过这个吗？

```
$("#jquery_jplayer_1").jPlayer("setMedia", {mp3: url}).jPlayer("play"); 
```

来自： [通过单击链接更改 jPlayer 上的歌曲，托管在 Amazon S3 上](https://stackoverflow.com/questions/8206608/changing-songs-on-jplayer-by-clicking-a-link-hosted-on-amazon-s3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T18:11:03.780

好的，这是对我有用的代码（将按钮的 id 设置为“myPlayButton”）：

```
$("#myPlayButton").click(function () {
             $("#jquery_jplayer_1").jPlayer("setMedia", {mp3: "/Music/a.mp3"}).jPlayer("play");
         }); 
```

我在服务器的根目录中有名为“音乐”的文件夹。

# php - 如何在远程服务器上设置 php 指令？

> ID：14268948
> 
> 赞同：-1
> 
> 时间：2013-01-10T23:09:13.597
> 
> 标签：php

我的问题很简单。我正在开发一个本地 PHP 项目。我用一些自定义配置设置了我的 php.ini。

稍后我将在商业主机提供商中托管该项目。

但是，该远程服务器将拥有自己的 PHP 配置，并且我的自定义 php.ini 指令将无效。我对吗？

如果是这样，我如何在远程服务器中使用我的自定义 php.ini？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:17:09.900

有了这样的东西，你已经修改了你的 php.ini；在标准网络托管中，您将无权修改 php.ini，因为托管公司的所有用户都在使用该文件。

为了让您完全控制您的 php.ini，您需要转到 VPS/专用服务器并配置 Lamp 服务器。从那里您可以进行与在本地服务器上所做的相同的更改

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T23:12:15.453

这取决于您的服务器配置。

在大多数共享服务器提供商上，您将无法使用 php.ini；在 VPS / 专用环境中，您可以编辑设置，但您当然应该询问您的提供商。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T23:12:15.343

首先，您的**本地** `php.ini`对服务器**没有影响**，您是正确的。

现在，配置**遥控器** `php.ini`取决于您拥有什么样的主机。
使用共享主机，您通常可以配置的东西不多，但如果您有**VPS**（虚拟专用服务器）或**专用**服务器，您应该能够复制/粘贴它。

另外，请记住，如果您没有很多自定义配置，一些小的调整可以通过 PHP 本身完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T23:27:42.793

您可以使用设置大量选项`ini_set`- 但当然，其中相当多的选项可能无法在您的托管服务提供商上进行更改。但是可以设置诸如`error_reporting`,之类的东西。`display_errors`

根据您的托管服务提供商使用的配置和版本，您可以选择在 htaccess 文件中设置 php_options（如果他们使用`mod_php`基于 - 的托管，我认为这些日子不太常见），或者`.user.ini`在您的 php 代码所在的目录。但这完全取决于虚拟主机的位置。

# git - 从 git repo 历史中删除大量推送数据

> ID：14268952
> 
> 赞同：-1
> 
> 时间：2013-01-10T23:09:28.617
> 
> 标签：git

不小心我推送了一个提交，其中包括应该被忽略的文件（node_modules 和 bower 组件目录）。由于我使用了许多依赖项，因此提交变得非常大，并且上传了很多数据。

我在另一个提交中删除了这些文件并包含了一个`.gitignore`文件，但是每次我克隆应用程序时，所有这些大文件都会作为项目的*历史记录*下载。

有没有办法摆脱它？一种从我的 git存储库中明确删除**node_modules**和**bower 组件目录的方法？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:12:05.470

你可以重写 git 历史并从 git 中删除这些对象。查看下一个链接[https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History](https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T02:30:53.400

即使您执行 a `git rm`，这些文件也会在项目历史记录中继续存在。这样，您必须在克隆存储库时下载它们。要永久删除文件，您需要更改历史记录。

如果添加文件的提交是最近的，您可以在`git reset`添加文件的提交之前执行提交。但是，如果文件是前一段时间添加的，则需要使用`git filter branch`. 当我想从存储库中删除大文件时，我将展示一些我使用的步骤。

```
git filter-branch --index-filter 'git rm --cached --ignore-unmatch file-or-directory-that-you-want-to-remove-with-complete-path' --all. 
```

然后，您需要执行 a `git push -f`，因为您更改了项目历史记录。这样，当您再次克隆项目时，将不再下载已删除的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T23:17:32.297

我会说

```
git commit --amend 
```

或者

```
git commit --rebase 
```

但是，如果您要删除的文件已经存在了很长一段时间，那么：

```
git filter-branch --index-filter 'git rm --cached --ignore-unmatch filename' HEAD 
```

# ruby-on-rails - 在铁轨路线中循环

> ID：14268953
> 
> 赞同：0
> 
> 时间：2013-01-10T23:09:29.057
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, routes

好的，所以我的 routes.rb 文件中有这个循环

```
[:animals, :humans].each do |app|
  resources app, controller => "mammals", type: app.to_s do
    member do
      post :deny
    end

    collection do
      get :wait, :state => 'wait', :action => 'index'
    end
  end
end 
```

但我得到这个错误错误的参数数量（0 代表 1）

```
/Users/trace/.rvm/gems/ruby-1.9.3-p327@sss/gems/actionpack-3.1.10/lib/action_dispatch/routing/mapper.rb:651:in `controller'
/Users/trace/Sites/sss/config/routes.rb:31:in `block (2 levels) in <top (required)>'
/Users/trace/Sites/sss/config/routes.rb:30:in `each' 
```

但我在 routes.rb 的其他部分使用循环，一切都很好

关于正在发生的事情的任何想法......可能是语法错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T23:12:42.550

这看起来很可疑：

`resources app, controller => "mammals", type: app.to_s do`

怎么样：

```
resources app, controller: "mammals", type: app.to_s do 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T23:12:46.677

您缺少控制器上的冒号。

```
 resources app, controller => "mammals", type: app.to_s do 
```

应该

```
 resources app, :controller => "mammals", type: app.to_s do 
```

# dart - 如何使用 Dart 列出目录的内容？

> ID：14268967
> 
> 赞同：37
> 
> 时间：2013-01-10T23:10:30.050
> 
> 标签：dart, dart-io

我想使用 Dart 列出一个目录（在文件系统上）的所有内容。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-06-13T07:51:50.430

API 已更改，我已更新 M4 版本 (0.5.16_r23799) 的异步代码：

```
Future<List<FileSystemEntity>> dirContents(Directory dir) {
  var files = <FileSystemEntity>[];
  var completer = Completer<List<FileSystemEntity>>();
  var lister = dir.list(recursive: false);
  lister.listen ( 
      (file) => files.add(file),
      // should also register onError
      onDone:   () => completer.complete(files)
      );
  return completer.future;
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2020-01-23T00:47:10.020

## 如何在 Dart 中列出目录的内容

```
final dir = Directory('path/to/directory');
final List<FileSystemEntity> entities = await dir.list().toList(); 
```

这会从路径创建一个目录。然后它将其转换为 的列表`FileSystemEntity`，该列表可以是 a `File`、 a`Directory`或 a `Link`。默认情况下，子目录不会递归列出。

如果要打印该列表，请添加以下行：

```
entities.forEach(print); 
```

如果您只想获取文件，那么您可以这样做：

```
final Iterable<File> files = entities.whereType<File>(); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2019-02-14T14:04:10.337

该`list`方法返回一个`Stream`，其中每个发出的事件都是一个目录条目：

```
Directory dir = Directory('.');
// execute an action on each entry
dir.list(recursive: false).forEach((f) {
  print(f);
}); 
```

顾名思义，`listSync`method 是阻塞版本：

```
// create a list of entries
List<FileSystemEntity> entries = dir.listSync(recursive: false).toList(); 
```

使用什么方法取决于应用程序上下文。直接来自[文档](https://docs.flutter.io/flutter/dart-io/Directory-class.html)的注释：

> 除非您有特定原因使用方法的同步版本，否则请首选异步版本以避免阻塞您的程序。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-01-10T23:10:30.050

# 这个答案已经过时了。请参阅已接受的答案。

有两种方法可以使用 Dart VM 和`dart:io`库列出目录的内容。

（注意：以下内容仅在命令行上运行或作为服务器端应用程序运行时在 Dart VM 中有效。这在浏览器中或编译为 JavaScript 时无效。）

## 设置

首先，您需要导入`dart:io`库。该库包含访问文件、目录等所需的类。

```
import 'dart:io'; 
```

其次，创建`Directory`该类的新实例。

```
var dir = new Directory('path/to/my/dir'); 
```

## 在脚本中列出内容

最简单的方法是使用新`listSync`方法。这将返回一个内容列表。默认情况下，这不会递归。

```
List contents = dir.listSync();
for (var fileOrDir in contents) {
  if (fileOrDir is File) {
    print(fileOrDir.name);
  } else if (fileOrDir is Directory) {
    print(fileOrDir.path);
  }
} 
```

如果你想通过目录递归，你可以使用可选参数`recursive`。

```
List allContents = dir.listSync(recursive: true); 
```

**警告**如果你的目录结构有循环符号链接，上面的代码将会崩溃，因为它递归地跟随符号链接。

`listSync`当您使用 Dart 编写 shell 脚本、命令行实用程序或类似的应用程序或脚本时，这种使用 的方法特别有用。

## 列出服务器中的内容

列出目录内容的第二种方法是使用`list`. 当您需要列出目录以响应 HTTP 请求时，您将使用第二种方法。请记住，Dart 的每个隔离都在单个线程中运行。任何长时间运行的进程都可能阻塞事件循环。当交互性很重要，或者从单个 Dart 脚本为大量客户端提供服务时，请使用异步版本。

使用异步版本，`dir.list()`返回一个`DirectoryLister`. 您可以在 DirectoryLister 上注册三个不同的回调：

*   `onFile`: 遇到文件或目录时调用
*   `onDone`：当目录列表器完成列出内容时调用
*   `onError`: 当列表器遇到一些错误时调用

这是一个简单的函数，它返回一个字符串列表的 Future，其中包含目录中的文件名：

```
Future<List<String>> dirContents(Directory dir) {
  var filenames = <String>[];
  var completer = new Completer();
  var lister = dir.list();
  lister.onFile = (filename) => filenames.add(filename);
  // should also register onError
  lister.onDone = (_) => completer.complete(filenames);
  return completer.future;
} 
```

当然，这种方法对于服务器来说是完美的，对于简单的脚本就比较麻烦了。

幸运的是，Dart 支持这两种方法供您使用！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-09-30T17:40:07.743

里面和异步函数写这个

```
List<FileSystemEntity> allContents = await Directory("folder/path").list().toList(); 
```

现在你有一个包含所有内容的列表

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-09-16T12:20:47.350

这是我使用 async/await 的版本，仅返回文件列表：

```
List<File> filesInDirectory(Directory dir) async {
  List<File> files = <File>[];
  await for (FileSystemEntity entity in dir.list(recursive: false, followLinks: false)) {
    FileSystemEntityType type = await FileSystemEntity.type(entity.path);
    if (type == FileSystemEntityType.FILE) {
      files.add(entity);
      print(entity.path);
    }
  }
  return files;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-04-02T02:52:51.253

使用此功能，您可以打印一个目录的所有目录和文件。你只需要传递一个特定的路径。

```
Future listDir(String folderPath) async {
  var directory = new Directory(folderPath);
  print(directory);

  var exists = await directory.exists();
  if (exists) {
    print("exits");

    directory
      .list(recursive: true, followLinks: false)
      .listen((FileSystemEntity entity) {
        print(entity.path);
      });
  }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-17T16:01:51.143

要获取具有特定字符串的文件名列表，可以使用以下代码：

```
String directory = (await getApplicationDocumentsDirectory()).path;
List<FileSystemEntity> files = Directory(directory).listSync(recursive: false);

List<String> filePaths = [];
for (var fileSystemEntity in files) {
  if (basename(fileSystemEntity.path).contains('mystring')) {
    filePaths.add(fileSystemEntity.path);
  }
} 
```

如果您只需要文件名而不是整个路径，则可以使用 basename 函数。

# php - 如何检测并回显单词中的最后一个元音？

> ID：14268970
> 
> 赞同：-2
> 
> 时间：2013-01-10T23:10:48.280
> 
> 标签：php, detect, multibyte

```
$word = "Acrobat" (or Apple, Tea etc.) 
```

如何使用 php 检测和回显给定单词的最后一个元音？我尝试了 preg_match 函数，谷歌搜索了几个小时，但找不到合适的解决方案。

字符串中可以有 ü、ö 等多字节字母。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T00:58:41.327

这是捕获字符串中最后一个元音的多字节安全版本。

```
$arr = array(
    'Apple','Tea','Strng','queue',
    'asartä','nő','ağır','NOËL','gør','æsc'
);

/*  these are the ones I found in character viewer
    in Mac so these vowels can be extended. don't
    forget to add both lower and upper case versions
    of new ones because personally I wouldn't rely
    on the i (case insensitive) flag in the pattern
    for multibyte characters.
*/
$vowels =
    'aàáâãāăȧäảåǎȁąạḁẚầấẫẩằắẵẳǡǟǻậặæǽǣ' .
    'AÀÁÂÃĀĂȦÄẢÅǍȀȂĄẠḀẦẤẪẨẰẮẴẲǠǞǺẬẶÆǼǢ' .
    'EÈÉÊẼĒĔĖËẺĚȄȆẸȨĘḘḚỀẾỄỂḔḖỆḜ' .
    'eèéêẽēĕėëẻěȅȇẹȩęḙḛềếễểḕḗệḝ' .
    'IÌÍÎĨĪĬİÏỈǏỊĮȈȊḬḮ' .
    'iìíîĩīĭıïỉǐịįȉȋḭḯ' .
    'OÒÓÔÕŌŎȮÖỎŐǑȌȎƠǪỌØỒỐỖỔȰȪȬṌṐṒỜỚỠỞỢǬỘǾŒ' .
    'oòóôõōŏȯöỏőǒȍȏơǫọøồốỗổȱȫȭṍṏṑṓờớỡởợǭộǿœ' .
    'UÙÚÛŨŪŬÜỦŮŰǓȔȖƯỤṲŲṶṴṸṺǛǗǕǙỪỨỮỬỰ' .
    'uùúûũūŭüủůűǔȕȗưụṳųṷṵṹṻǖǜǘǖǚừứữửự'
;

// set necessary encodings
mb_internal_encoding('UTF-8');
mb_regex_encoding('UTF-8');

// and loop
foreach ($arr as $word) {

    $vow = mb_ereg_replace('[^'.$vowels.']','',$word);
    // get rid of all consonants (non-vowels in this pattern)
    $lastVw = mb_substr($vow,-1);
    // and get the last one from the remaining vowels

    if (empty($lastVw))
    // it evaluates this line when there's no vowel in the string
        echo "there's no vowel in <b>\"$word\"</b>." . PHP_EOL;
    else
    // and vice versa
        echo "last vowel in <b>\"$word\"</b> is " .
        "<span style=\"color:#F00\">{$lastVw}</span>" . PHP_EOL;    
} 
```

这是输出。

> **"Apple"**中的 最后一个元音是e ***"*** **Tea"**中的最后***一个*****元音是"Strng"** 中没有元音。**"queue"**中的 最后一个元音 是e ***"*** **asartä"**中的 最后一个元音是***ä*** **"nő"**中的 ​​最后一个元音是***ő*** **"ağır"**中的 最后一个元音是***ı*** **"NOËL"**中的 最后一个元音是***Ë*** **"gør"**中的最后一个元音是***ø*** 最后一个元音在**“æsc”**中是***æ***

 ******** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T23:21:45.203

```
$word = "Acrobat";
$vowels = array_intersect(str_split($word), array('A','E','I','O','U','a','e','i','o','u'));
echo array_pop($vowels); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T23:16:34.153

```
function last_vowel($word) {
  for ($i = strlen($word) - 1; $i >= 0; --$i) {
      switch (strtolower($word[$i])) {
        case 'a': case 'e': case 'i': case 'o': case 'u': case 'y':
          return $word[$i];
      }
  }
  return null;
}

echo last_vowel("Apple"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T23:16:21.540

使用方法 str_split()

[http://www.php.net/manual/en/function.str-split.php](http://www.php.net/manual/en/function.str-split.php)

这会将您的字符串转换为数组，然后您可以使用数组的索引来查找字符串的第一个和最后一个字母。

-Array[0] 是第一个字母 *Array[total number of letters - 1] 是最后一个字母。

获取数组中的第一个和最后一个元素后，映射开始。例如： if(letter=="a"||letter=="A") echo "Apple";

等等...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T23:21:57.763

我会说 Ed 或 Mark 的答案肯定更有效率，但如果你想要一个递归函数的例子，它是：

```
$word = "stellar";

function lastVowel($word)
{
    $vowels = array('a','e','i','o','u');
    $letter = substr($word, strlen($word) - 1);
    if(in_array(strtolower($letter), $vowels))
        return $letter;
    else
    {
        if(strlen($word) > 0)
            return lastVowel(substr($word, 0, strlen($word) - 1));
        else
            return "no vowels";
    }
}

echo lastVowel($word); 
```

请注意，有更好的方法可以做到这一点。只是举一个具体的例子，不一定是“最好的”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-10T23:27:09.733

我会亲自[`preg_match()`](http://php.net/manual/en/function.preg-match.php)用于这项任务。

```
$arr = array(
    'Apple','Tea','Strng','queue'
);

foreach ($arr as $word) {

    preg_match('~[aeiou](?=[^aeiou]*$)~i',$word,$m);

    if (empty($m)) echo "there's no vowel in \"$word\".";
    else echo "last vowel in \"$word\" is <b style=\"color:#F00\">{$m[0]}</b>";
    echo PHP_EOL;   
} 
```

这将输出

> “Apple”中的最后一个元音是**e**
> “Tea”中的最后**一个**
> 元音 是“Strng”中没有元音。
> “队列”中的最后一个元音是**e*********

# objective-c - 如何制作斜阴影？

> ID：14268974
> 
> 赞同：1
> 
> 时间：2013-01-10T23:11:15.830
> 
> 标签：objective-c, cocoa, uikit

我正在向 a 添加一个`NSShadow`对象以`NSMutableAttributedString`在字符串周围绘制阴影。但我看到它`NSShadow`没有设置阴影倾角的属性。它只有`shadowOffset`和。 `shadowColor``shadowBlurRadius`

我如何使它倾斜？

# javascript - 使用 JavaScript 将页面移动到由哈希定义的元素

> ID：14268978
> 
> 赞同：0
> 
> 时间：2013-01-10T23:11:43.427
> 
> 标签：javascript, jquery, html

我有一个嵌入了许多 Picasa 相册的页面。每个嵌入的专辑都在一个`<div>`具有唯一 ID 的内部。

我希望能够将我的浏览器指向 /photos/#UNIQUEID 并让页面加载集中在正确的相册上。

如何使用 JavaScript 做到这一点？我的页面是：http: [//goo.gl/jDZIK](http://goo.gl/jDZIK)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T23:16:17.050

你为什么要使用 JavaScript 来做这件事？这已经是浏览器的默认行为。

[http://www.outtheremusic.net/photos/#summer2010](http://www.outtheremusic.net/photos/#summer2010)

这个链接让我使用我手头测试的浏览器向下滚动到正确的图像：Firefox、Opera、Chrome、Internet Explorer

所以你的问题的答案是：你不需要这样做，浏览器已经做到了。如果您想在单击页面上的某些内容而不重新加载它的同时向下滚动到图片，那是一个不同的故事（在这件事上也是一个不同的问题）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T23:17:00.410

```
window.location.href = '#HASH_NAME'? 
```

已编辑。感谢 Cory 指出我明显的错误并对此感到抱歉！;) 干杯！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T23:22:25.703

在您的页面中，您有几个`<h1>`标题元素，每个专辑上方都有一个。例如，如果您希望 URL`~/photos/#album1`跳转到标题为“Album 1”的区域，您只需稍微修改您的 HTML。这样做的“老式”方法是提供`<a>`具有匹配`name`属性的锚元素。所以，

```
<h1>Album 1</h1> 
```

将更改为：

```
<a name="album1"></a><h1>Album 1</h1> 
```

`id`或者，现代浏览器将跳转到与哈希值匹配的任何元素，因此您可以简单地执行以下操作：

```
<h1 id="album1">Album 1</h1> 
```

浏览器应该负责其余的工作。只要确保`id`您页面上的所有 s 都是独一无二的。仅供参考：我不喜欢跳转到`<div>`元素的想法，因为这样标题就会从视口中删除。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-10T23:19:21.277

使用 jQuery，您可以指定当有人单击 div 时将其发送到您想要的位置。

```
$("div").click(function(){
  var UniqueID = $(this).prop('id');

  window.location.href = "www.servername.com/photos/#" + UniqueID;

}); 
```

# java - 在运行时修改类定义的注释字符串参数

> ID：14268981
> 
> 赞同：63
> 
> 时间：2013-01-10T23:11:56.953
> 
> 标签：java, reflection

想象有一个类：

```
@Something(someProperty = "some value")
public class Foobar {
    //...
} 
```

它已经编译（我无法控制源代码），并且是 jvm 启动时类路径的一部分。我希望能够在运行时将“某个值”更改为其他值，这样之后的任何反射都将具有我的*新值*，而不是默认的“某个值”。

这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2015-01-23T20:44:36.970

~~**警告：**未在 OSX 上测试 - 请参阅 @Marcel 的评论~~

在 OSX 上测试。工作正常。

由于我还需要在运行时更改注释值，所以我重新审视了这个问题。

这是@assylias 方法的修改版本（非常感谢您的启发）。

```
/**
 * Changes the annotation value for the given key of the given annotation to newValue and returns
 * the previous value.
 */
@SuppressWarnings("unchecked")
public static Object changeAnnotationValue(Annotation annotation, String key, Object newValue){
    Object handler = Proxy.getInvocationHandler(annotation);
    Field f;
    try {
        f = handler.getClass().getDeclaredField("memberValues");
    } catch (NoSuchFieldException | SecurityException e) {
        throw new IllegalStateException(e);
    }
    f.setAccessible(true);
    Map<String, Object> memberValues;
    try {
        memberValues = (Map<String, Object>) f.get(handler);
    } catch (IllegalArgumentException | IllegalAccessException e) {
        throw new IllegalStateException(e);
    }
    Object oldValue = memberValues.get(key);
    if (oldValue == null || oldValue.getClass() != newValue.getClass()) {
        throw new IllegalArgumentException();
    }
    memberValues.put(key,newValue);
    return oldValue;
} 
```

使用示例：

```
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
public @interface ClassAnnotation {
  String value() default "";
}
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.FIELD)
public @interface FieldAnnotation {
  String value() default "";
}
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface MethodAnnotation {
  String value() default "";
}
@ClassAnnotation("class test")
public static class TestClass{
    @FieldAnnotation("field test")
    public Object field;
    @MethodAnnotation("method test")
    public void method(){

    }
}

public static void main(String[] args) throws Exception {
    final ClassAnnotation classAnnotation = TestClass.class.getAnnotation(ClassAnnotation.class);
    System.out.println("old ClassAnnotation = " + classAnnotation.value());
    changeAnnotationValue(classAnnotation, "value", "another class annotation value");
    System.out.println("modified ClassAnnotation = " + classAnnotation.value());

    Field field = TestClass.class.getField("field");
    final FieldAnnotation fieldAnnotation = field.getAnnotation(FieldAnnotation.class);
    System.out.println("old FieldAnnotation = " + fieldAnnotation.value());
    changeAnnotationValue(fieldAnnotation, "value", "another field annotation value");
    System.out.println("modified FieldAnnotation = " + fieldAnnotation.value());

    Method method = TestClass.class.getMethod("method");
    final MethodAnnotation methodAnnotation = method.getAnnotation(MethodAnnotation.class);
    System.out.println("old MethodAnnotation = " + methodAnnotation.value());
    changeAnnotationValue(methodAnnotation, "value", "another method annotation value");
    System.out.println("modified MethodAnnotation = " + methodAnnotation.value());
} 
```

这种方法的优点是不需要创建新的注释实例。因此不需要事先知道具体的注解类。此外，由于原始注释实例保持不变，因此副作用应该是最小的。

使用 Java 8 测试。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2013-01-11T10:35:05.317

这段代码或多或少地做了你所要求的——它是一个简单的概念证明：

*   适当的实施还需要处理`declaredAnnotations`
*   如果 Class.java 中注解的实现发生变化，代码将会中断（即它可以在未来的任何时间中断）
*   不知道有没有副作用...

输出：

> oldAnnotation = 某个值
> modifiedAnnotation = 另一个值

```
public static void main(String[] args) throws Exception {
    final Something oldAnnotation = (Something) Foobar.class.getAnnotations()[0];
    System.out.println("oldAnnotation = " + oldAnnotation.someProperty());
    Annotation newAnnotation = new Something() {

        @Override
        public String someProperty() {
            return "another value";
        }

        @Override
        public Class<? extends Annotation> annotationType() {
            return oldAnnotation.annotationType();
        }
    };
    Field field = Class.class.getDeclaredField("annotations");
    field.setAccessible(true);
    Map<Class<? extends Annotation>, Annotation> annotations = (Map<Class<? extends Annotation>, Annotation>) field.get(Foobar.class);
    annotations.put(Something.class, newAnnotation);

    Something modifiedAnnotation = (Something) Foobar.class.getAnnotations()[0];
    System.out.println("modifiedAnnotation = " + modifiedAnnotation.someProperty());
}

@Something(someProperty = "some value")
public static class Foobar {
}

@Retention(RetentionPolicy.RUNTIME)
@interface Something {

    String someProperty();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-28T07:34:07.233

这个适用于我的 Java 8 机器。它将`ignoreUnknown`注释中的值`@JsonIgnoreProperties(ignoreUnknown = true)`从**true**更改为**false**。

```
final List<Annotation> matchedAnnotation = Arrays.stream(SomeClass.class.getAnnotations()).filter(annotation -> annotation.annotationType().equals(JsonIgnoreProperties.class)).collect(Collectors.toList());    

final Annotation modifiedAnnotation = new JsonIgnoreProperties() {
    @Override public Class<? extends Annotation> annotationType() {
        return matchedAnnotation.get(0).annotationType();
    }    @Override public String[] value() {
        return new String[0];
    }    @Override public boolean ignoreUnknown() {
        return false;
    }    @Override public boolean allowGetters() {
        return false;
    }    @Override public boolean allowSetters() {
        return false;
    }
};    

final Method method = Class.class.getDeclaredMethod("getDeclaredAnnotationMap", null);
method.setAccessible(true);
final Map<Class<? extends Annotation>, Annotation> annotations = (Map<Class<? extends Annotation>, Annotation>) method.invoke(SomeClass.class, null);
annotations.put(JsonIgnoreProperties.class, modifiedAnnotation); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-03-23T06:03:44.533

SPRING 可以很容易地完成这项工作，可能对 spring 开发人员有用。跟着这些步骤 ：-

**第一个解决方案：-** 1）创建一个返回 someProperty 值的 Bean。在这里，我从 DB 或属性文件中注入了带有 @Value 注释的 somePropertyValue ：-

```
 @Value("${config.somePropertyValue}")
    private String somePropertyValue;

    @Bean
    public String somePropertyValue(){
        return somePropertyValue;
    } 
```

2）在此之后，可以将 somePropertyValue 注入到 @Something 注释中，如下所示：-

```
@Something(someProperty = "#{@somePropertyValue}")
public class Foobar {
    //...
} 
```

**第二种解决方案： -**

1）在bean中创建getter setter：-

```
 @Component
    public class config{
         @Value("${config.somePropertyValue}")
         private String somePropertyValue;

         public String getSomePropertyValue() {
           return somePropertyValue;
         }
        public void setSomePropertyValue(String somePropertyValue) {
           this.somePropertyValue = somePropertyValue;
        }
    } 
```

2）在此之后，可以将 somePropertyValue 注入到 @Something 注释中，如下所示：-

```
@Something(someProperty = "#{config.somePropertyValue}")
public class Foobar {
    //...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-10-15T12:42:40.110

试试这个 Java 8 的解决方案

```
public static void main(String[] args) throws Exception {
    final Something oldAnnotation = (Something) Foobar.class.getAnnotations()[0];
    System.out.println("oldAnnotation = " + oldAnnotation.someProperty());
    Annotation newAnnotation = new Something() {

        @Override
        public String someProperty() {
            return "another value";
        }

        @Override
        public Class<? extends Annotation> annotationType() {
            return oldAnnotation.annotationType();
        }
    };
    Method method = Class.class.getDeclaredMethod("annotationData", null);
    method.setAccessible(true);
    Object annotationData = method.invoke(getClass(), null);
    Field declaredAnnotations = annotationData.getClass().getDeclaredField("declaredAnnotations");
    declaredAnnotations.setAccessible(true);
    Map<Class<? extends Annotation>, Annotation> annotations = (Map<Class<? extends Annotation>, Annotation>) declaredAnnotations.get(annotationData);
    annotations.put(Something.class, newAnnotation);

    Something modifiedAnnotation = (Something) Foobar.class.getAnnotations()[0];
    System.out.println("modifiedAnnotation = " + modifiedAnnotation.someProperty());
}

@Something(someProperty = "some value")
public static class Foobar {
}

@Retention(RetentionPolicy.RUNTIME)
@interface Something {
    String someProperty();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-21T13:03:28.257

我可以在jdk1.8中以这种方式访问​​和修改注释，但不知道为什么没有效果，

```
try {
    Field annotationDataField = myObject.getClass().getClass().getDeclaredField("annotationData");
    annotationDataField.setAccessible(true);
    Field annotationsField = annotationDataField.get(myObject.getClass()).getClass().getDeclaredField("annotations");
    annotationsField.setAccessible(true);
    Map<Class<? extends Annotation>, Annotation> annotations =  (Map<Class<? extends Annotation>, Annotation>) annotationsField.get(annotationDataField.get(myObject.getClass()));
    annotations.put(Something.class, newSomethingValue);
} catch (IllegalArgumentException | IllegalAccessException e) {
    e.printStackTrace();
} catch (NoSuchFieldException e) {
    e.printStackTrace();
} catch (SecurityException e) {    
    e.printStackTrace();
} 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2013-01-10T23:14:21.410

注释属性值必须是常量——所以除非你想做一些严肃的字节码操作，否则这是不可能的。有没有更简洁的方法，比如用你想要的注释创建一个包装类？

# ruby-on-rails - 如何从 github 更新 best_in_place 版本

> ID：14268990
> 
> 赞同：1
> 
> 时间：2013-01-10T23:12:14.210
> 
> 标签：ruby-on-rails, best-in-place

`gryzzly`被告知要从 github 更新我的 best_in_place 版本，以解决此问题：[Checkboxes with images](https://github.com/bernat/best_in_place/pull/210)

他告诉从 github 更新，因为目前还没有包含此修复程序的版本。

所以，我在我的`Gemfile`：

```
gem 'best_in_place', :git => 'git://github.com/bernat/best_in_place.git' 
```

然后运行：`bundle install`。

这不能解决我的问题：[show-images-in-checkbox-collection](https://stackoverflow.com/questions/14266858/show-images-in-checkbox-collection)，所以我认为我做错了什么。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:24:12.067

尝试添加您认为合适的分支。在你的情况下：

```
gem 'best_in_place', :git => 'git://github.com/bernat/best_in_place.git', :branch => 'fix-display-methods' 
```

编辑：研究提交，似乎正确的条目`Gemfile`是：

```
gem "best_in_place",:git => 'git://github.com/bernat/best_in_place.git', :tag => "0665b5f2e41967d8d1616f953fa3c0983cef1d51" 
```

我希望这能解决你的问题。

编辑 2：今天我在我的机器上复制了你的代码，它运行良好。该标记似乎是正确的，您的代码中只有一件小事似乎令人困惑：在 Rails> 3 中，对图像的引用很简单`image_tag("your_img.png")`。您的代码应该是：

```
<%= best_in_place task, :done,:classes => 'highlight_on_success', type: :checkbox, collection: [image_tag("checkbox_no.png"), image_tag("checkbox_yes.png")] %> 
```

祝你好运 。

# php - PHP $_FILES 数组操作

> ID：14268997
> 
> 赞同：0
> 
> 时间：2013-01-10T23:13:00.290
> 
> 标签：php, image, file, crop, jcrop

我正在使用表单上传图像。图片上传后，我们将能够看到上传的图片。然后我使用`JCrop`( [http://deepliquid.com/content/Jcrop.html](http://deepliquid.com/content/Jcrop.html) ) 允许裁剪此图像。假设我只关心`JPEG`图像。然后我准备提交表格。

提交表单后，我将执行一些图像处理并裁剪图像。但是我想把这个裁剪图像的信息放回`$_FILES`数组中（这是必须的）。我将如何`$_FILES`在 PHP 脚本中操作这个数组？

这是我尝试过的，但它不起作用。

```
$upload_dir = '/Users/user/Sites/tmp/';

$file_name = $_FILES['image']['name'];
$file_name = "cropped_".$file_name;
$tmp_name = $_FILES['image']['tmp_name'];
$file_size = $_FILES['image']['size'];

$src_file = imagecreatefromjpeg($tmp_name);

list($width,$height) = getimagesize($tmp_name);

// Creates cropped image
$tmp = imagecreatetruecolor($_POST['w'], $_POST['h']);
imagecopyresampled($tmp, $src_file, 0, 0, $_POST['x'], $_POST['y'], $_POST['w'], $_POST['h'], $_POST['w'], $_POST['h']);
$small_pic_file_path = $upload_dir.$file_name;

imagejpeg($tmp,$small_pic_file_path,85);
$message = "<img src='http://localhost/~user/tmp/".$file_name."'>";

$_FILES['image']['name'] = $file_name;
$_FILES['image']['type'] = "image/jpeg";
// unlink($tmp_name);
// if(!move_uploaded_file($upload_dir.$file_name, $tmp_name)) echo "Failure Moving Image";
$_FILES['image']['tmp_name'] = $upload_dir.$file_name;
$_FILES['image']['error'] = 0;
$sizes = getimagesize($upload_dir.$file_name);
$_FILES['image']['size'] = ($sizes['0'] * $sizes['1']); 
```

可以改变这个`$_FILES`数组吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T03:27:23.963

仅在全局数组中进行更改是行不通的。你只是说`$_FILES['image']['tmp_name']`将是新创建的。但是 tmp 位置具有相同的旧文件。

但是您必须更新`/tmp`文件夹中的图像。

在那里获取您的`tmp`路径和`copy`图像。

一种`copy($newImage, /tmp)`- 从中​​获取您的 tmp 文件夹路径`php.ini`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T03:21:00.837

更改超全局变量不是一个好主意，您最好将其复制到另一个变量中，然后做任何您想做的事情。

# tinymce - Google Spell API 和 TinyMCE

> ID：14268998
> 
> 赞同：5
> 
> 时间：2013-01-10T23:13:03.173
> 
> 标签：tinymce, google-api, google-search-api

[我刚刚使用此处](http://ondotnet.deap.nu/2009/01/implementing-tinymce-spellchecker-with.html)的说明成功实现了 TinyMCE 的拼写检查插件。不过，这结尾段让我有点害怕。

> 我在查找 Google Spell Service 的良好文档时遇到了一些麻烦，[它似乎不再更新，但仍然可供已经使用它的开发人员使用](http://code.google.com/apis/soapsearch/index.html)（其中应该包括 TinyMCE .Net 包，即使你以前没有使用过它）。但是，如果 Google 决定删除它，使用风险自负。这是我能找到的唯一官方文档，而且不多……

我是否将其理解为 Moxiecode.TinyMCE.dll 使用的拼写检查服务指向 Google 的不受支持、已废弃的 api？

**编辑**

似乎拼写检查是通过[此处](http://weblogs.asp.net/pwelter34/archive/2005/07/19/419838.aspx)`https://www.google.com/tbproxy/spell?...`描述的帖子进行的。

该服务是否记录在任何地方？

# visual-studio-2010 - VS2010启动时缩小到85%

> ID：14268999
> 
> 赞同：0
> 
> 时间：2013-01-10T23:13:03.023
> 
> 标签：visual-studio-2010

嗨，每当 VS2010 加载项目时，有什么方法可以将放大级别更改为 85%。我发现每次加载项目或不同的页面/文件时都会执行此过程。我希望默认级别为 85% 而不是 100%

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:17:02.230

我不认为有办法在启动时做到这一点，但请查看[Presentation Zoom](http://visualstudiogallery.msdn.microsoft.com/6a7a0b57-7059-470d-bcfa-60ceb78dc752/)。

如果您放大一个页面，其他页面将遵循新设置。它仅在 Visual Studio 打开时持续存在，因此每次打开它时都必须执行一次。