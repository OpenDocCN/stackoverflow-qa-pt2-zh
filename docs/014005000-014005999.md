# StackOverflow 问答 14005000-14005999

# javascript - 替换javascript中的空格

> ID：14005001
> 
> 赞同：3
> 
> 时间：2012-12-22T17:34:04.613
> 
> 标签：javascript

我需要将句子中的所有字母替换为 *（星号）。

我的代码是

```
var password='hello world';
password.replace(/\S/g, '*'); 
```

所有的字母都被替换了，但空间没有。怎么也能换？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T17:35:47.373

`\s`将匹配空格

`\S`（大写 S）将匹配除空格之外的所有内容

`.`将匹配每个字符

所以要替换每个字符：

```
password.replace(/./g, '*'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T17:38:01.060

关于什么

```
password.replace(/[a-zA-Z|\s]/g, '*'); 
```

这匹配字母和空格，但如果您输入所有字符，则使用其他答案。虽然更好地使用“密码”类型的输入，如果这样可以实现您想要做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T17:38:53.603

将您的代码更改为：

```
var password='hello world';
password=password.replace(/[\S ]/g, '*'); 
```

在这里测试和说明：http: [//jsfiddle.net/HSP2P/](http://jsfiddle.net/HSP2P/)

# arrays - 如何为图像数组创建 OnClick 过程？

> ID：14005005
> 
> 赞同：-1
> 
> 时间：2012-12-22T17:35:34.567
> 
> 标签：arrays, delphi, onclick, procedure, timage

我在这些图像中创建和加载图片的过程，但是如何创建 OnClick 过程并确定我点击的是哪个？

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, jpeg, ExtCtrls, Math, StdCtrls;

type
  TForm1 = class(TForm)
Label1: TLabel;
procedure FormCreate(Sender: TObject);
private
procedure ImageClick(Sender: TObject);
{ Private declarations }
public
{ Public declarations }
end;

var
 Form1: TForm1;
 Box: array [1..8,1..8] of TImage;
 size: integer;

implementation

{$R *.dfm}

procedure imagecreation;
var i,j: integer;
begin
  size:=60;
  for i:=1 to 8 do
    begin
      for j:=1 to 8 do
        begin
      box[i,j]:=Timage.Create(Form1);
      box[i,j].AutoSize:=false;
      box[i,j].Proportional:=true;
      box[i,j].Width:=size;
      box[i,j].Height:=size;
      box[i,j].Top:=(i+1)*size;
      box[i,j].Left:=(j+1)*size;
      box[i,j].Parent:=Form1;
      box[i,j].OnClick:=ImageClick;
        end;
    end;
end;

procedure TForm1.FormCreate(Sender: TObject);
begin
  imagecreation;
end;

procedure TForm1.ImageClick(Sender: TObject);
var
  ClickedImage: TImage;
begin
  ClickedImage := Sender as TImage;
end;
end. 
```

此时它调用“ImageClick”和未声明的标识符。这些是如何声明的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T17:39:55.257

如果您有一个表单或其他类，您可以在其中定义一个方法并将其附加到所有图像：

```
// The event handler
procedure TForm1.ImageClick(Sender: TObject);
var
  Image: TImage;
begin
  // Senders points to the image clicked
  Image := Sender as TImage;
  // Use Image as you like. 
end;

// Creating the images.
procedure TForm1.CreateImage;
var
  Image: TImage;
begin
  Image := TImage.Create(Self);
  // Set parent, load picture, etc.
  Image.OnClick := ImageClick; // Attach the event.
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T17:40:17.563

创建一个通用的 OnClick 处理程序（例如，在您的表单上）：

```
procedure TForm1.ImageClick(Sender: TObject);
var
  ClickedImage: TImage;
begin
  ClickedImage := Sender as TImage;
  // Do whatever with the image clicked
end; 
```

（提示：在代码编辑器中键入上述代码后，点击`Ctrl`++ ，IDE 会自动为您将声明添加到表单界面。）`Shift``C`

当您创建图像并将其分配给数组时，将其`OnClick`事件设置为上述事件：

```
for i:=1 to 8 do 
begin 
  for j:=1 to 8 do 
  begin      
    Images[i, j] := TImage.Create(nil);
    Images[i, j].OnClick := ImageClick;
    Images[i, j].LoadFromFile(AnImageFilename);
    // Other settings for image
  end;
end; 
```

编辑：现在你已经发布了你的代码，问题是你没有为`imagecreation`你的表单创建一个方法，因此它不知道在哪里可以找到`ImageClick`. 您可以通过更改代码来修复它

```
procedure imagecreation; 
```

至

```
procedure TForm1.imagecreation; 
```

并使用我之前给您的快捷方式将其添加到表单的接口声明中。

# java - 我使用什么日志系统？

> ID：14005008
> 
> 赞同：2
> 
> 时间：2012-12-22T17:35:52.503
> 
> 标签：java, log4j, slf4j, logback, apache-commons-logging

如何确定给定项目使用的日志记录系统？

它有和`log4j`的迹象。看起来活动配置文件是. 记录器是在类中创建的`slf4j``logback``log4j.properties`

```
private static Logger log = LoggerFactory.getLogger(MyClass.class); 
```

记录器的完整类型是`org.slf4j.Logger`，工厂的类型是`org.slf4j.LoggerFactory`。

但也有罐子`logback-core-0.9.26.jar`和`logback-classic-0.9.26.jar`.

其他罐子是`slf4j-log4j12-1.6.1.jar`,`slf4j-api-1.6.1.jar`和.`log4j-1.2.16.jar``commons-logging-1.1.1.jar`

什么定义了`logback`明显不活跃的？如何激活它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T17:37:37.440

sl4j 是一个门面，没有实际的实现。也就是说sl4j不能单独工作，底层的日志框架可以是log4j、logback、java util logging等。

`slf4j-log4j12-1.6.1.jar`依赖意味着底层的日志实现是 log4j。

这种方法的优点是稍后您可以将日志记录实现从 Log4j 切换到 logback（许多人声称它更好）或任何其他日志记录框架。您的类与日志框架不紧密耦合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:14:14.290

您描述的 logback-classic.jar 和 slf4j-log4j12.jar 都出现在类路径上的情况是SLF4J 错误代码文档中提到的“[多重绑定问题”的一个实例。](http://slf4j.org/codes.html#multiple_bindings)相关错误代码的说明：

> SLF4J 发出的警告就是这样，一个警告。即使存在多个绑定，SLF4J 也会选择一个日志框架/实现并与之绑定。SLF4J 选择绑定的方式是由 JVM 决定的，并且出于所有实际目的应该被认为是随机的。从 1.6.6 版本开始，SLF4J 将命名它实际绑定到的框架/实现类。

奇怪的是，您没有在问题中提及此错误消息。如果如您所说，logback-classic.jar 和 slf4j-log4j12.jar 确实存在于类路径中，那么 SL​​F4J 肯定会打印“在类路径上找到多个绑定”作为警告。如果没有，那么类路径上实际上只存在一个绑定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T18:03:49.643

鉴于您提到的 jar，我假设日志系统是 log4j，通过 slf4j 或 commons 日志访问（可能提供以满足其他框架的依赖项）。

这里的关键是`slf4j-log4j12-1.6.1.jar`通过 log4j 连接 slf4j。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T19:21:16.457

如果项目代码使用 slf4j，那么在某种程度上询问它使用的日志记录系统是在问一个错误的问题。它将使用 slf4j*在运行时*找到的任何日志框架。如果不确定，请打开所有相关库的调试信息：

*   对于 log4j，添加`-Dlog4j.debug`到 java 命令行。
*   对于 slf4j，我记得添加调试代码并打印[ILoggerFactory](http://www.slf4j.org/apidocs/org/slf4j/ILoggerFactory.html)实例的类名（由[LoggerFactory.getILoggerFactory()](http://www.slf4j.org/apidocs/org/slf4j/LoggerFactory.html#getILoggerFactory%28%29)返回），这揭示了它将使用的实际记录器。
*   不知道如何调试 logback 或 commons 日志记录，但我相信他们的文档会说明这一点。

# html - 可折叠下拉菜单下方的文字不可选择，链接不可点击

> ID：14005011
> 
> 赞同：1
> 
> 时间：2012-12-22T17:36:39.170
> 
> 标签：html, css, css-transitions

[这是一个小提琴](http://jsfiddle.net/its_me/8Mde7/1/)，向您展示了我编写的下拉菜单[的演示。](http://jsfiddle.net/its_me/8Mde7/1/embedded/result/)

**问题：**

![截屏](../Images/f6b656859c319bedde943f7aad6e25ab.png)

下拉菜单（“频道”）下方的部分文本（在这种情况下为网站标题链接）是不可选择/不可点击的，而普通“主页”链接下方的另一部分则呈现得很好。（您可以在演示中尝试。）

**为什么我认为会发生这种情况：**单击菜单（“通道”）时，我使用 JavaScript 动态更改`height`介于`0`和值之间；`auto`不是类似的东西`display: none;`，因此菜单项元素只是隐藏的，使其下方的文本无法选择/可点击。

![截屏](../Images/bbb9c6fc24b2622709b493d3eb88c53f.png)

**问题是**，我该如何解决这个问题，而不破坏菜单的当前功能和样式（即`transition`下拉菜单）。我尝试过的一切，包括`display: none | block;`, `visibility: hidden | visible;`，`opacity: 0 | 1;`但都让我失望了。

**编辑：**如最新版本的 Google Chrome 和 Chromium 网络浏览器所示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T17:47:15.133

它在FF中工作

对于 Chrome，由于某种原因，子元素 ( *of`#channels-menu-item-wrapper`* ) 不尊重`overflow:hidden`父元素的使用 (*它仅以视觉方式尊重隐藏..* )

您可以使用延迟过渡并将子元素移开..

```
.collapse > div{
    position:relative;

}
.collapse:not(.in) > div {
    left:-10000px;    
    -webkit-transition:left 0s ease;
    -webkit-transition-delay:0.35s; /*same delay as the time it takes to open/close so it does not show*/
} 
```

（*我只添加了`-webkit-`供应商特定规则.. 适用于所有*）

**演示在** [http://jsfiddle.net/gaby/cfH33/5/](http://jsfiddle.net/gaby/cfH33/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:07:30.507

单击菜单时，~~使用脚本~~将 .collapse div 的高度和宽度设置为 0 。

**更新：**形成@Gaby 答案得到这个提示“.collapse:not(.in)”。

```
.collapse:not(.in){
    width:0;
 } 
```

这也将起作用。[http://jsfiddle.net/8Mde7/3/](http://jsfiddle.net/8Mde7/3/)

这就是我设置宽度：0 的意思。

# custom-component - 寻找 flexglobals.toplevelapplication 的反面

> ID：14005019
> 
> 赞同：1
> 
> 时间：2012-12-22T17:37:46.150
> 
> 标签：custom-component, textinput, globals, refer

如果我想从自定义组件引用顶级应用程序中的 textInput（例如）。比我可以使用 FlexGlobals.toplevelapplication 但我如何在顶级应用程序的自定义组件中引用 textInput。所以我需要与 FlexGlobals.toplevelapplication 相反。

# c++ - 可变参数模板 - 模棱两可的调用

> ID：14005020
> 
> 赞同：11
> 
> 时间：2012-12-22T17:37:47.113
> 
> 标签：c++, templates, c++11, language-lawyer, variadic-templates

以下代码在 gcc 4.7.2 和 MSVC-11.0 中编译：

```
template <typename T>
void foo(T bar) {}

template <typename T, typename... Args>
void foo(T bar, Args... args) {}

int main()
{
    foo(0); // OK
} 
```

为什么？我认为这一定是模棱两可的电话：

**ISO/IEC 14882:2011**

> 14.5.6.2 函数模板的部分排序[temp.func.order]

5 ...

```
[ Example:

template<class T, class... U> void f(T, U...); // #1

template<class T > void f(T); // #2

template<class T, class... U> void g(T*, U...); // #3

template<class T > void g(T); // #4

void h(int i) {

f(&i); // error: ambiguous

g(&i); // OK: calls #3

}

—end example ] 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-22T17:55:26.150

[这被认为是当前标准中的一个缺陷](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1395)。甚至标准本身也依赖于在规范中的可变参数模板之前部分排序的非可变参数模板`std::common_type`：

`§20.9.7.6 [meta.trans.other] p3`

> 嵌套的 typedef`common_type::type`应定义如下：

```
template <class ...T> struct common_type;

template <class T>
struct common_type<T> {
  typedef T type;
};

template <class T, class U>
struct common_type<T, U> {
  typedef decltype(true ? declval<T>() : declval<U>()) type;
};

template <class T, class U, class... V>
struct common_type<T, U, V...> {
  typedef typename common_type<typename common_type<T, U>::type, V...>::type type;
}; 
```

具体`common_type<T, U>`与`common_type<T, U, V...>`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T17:57:37.673

是的，你是对的！这是一个编译器“特性”，而且很可能是经过*深思熟虑*的，因为委员会在[issue #1395中建议](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1395)[*应该*接受](https://groups.google.com/forum/?fromgroups=#!topic/comp.lang.c++.moderated/EHIBDm43faM)这种情况，因此，在未来的标准（甚至是 TR）中，它似乎*会*是。

# wordpress - 尝试在 wordpress 中显示帖子但将页面作为输出

> ID：14005029
> 
> 赞同：0
> 
> 时间：2012-12-22T17:38:18.110
> 
> 标签：wordpress

我正在尝试在我`roots theme`的`base.php`文件首页上显示帖子。

我已将循环添加为

```
<?php while (have_posts()) : the_post(); ?>
        <?php
            echo '<h2>';
            the_title();
            echo '</h2>';
            the_content( 'Read the full post »' ); ?>
<?php endwhile;?> 
```

但是，这只会显示第一页的内容和标题。

我如何让它显示帖子？我在 settings -> reading 下将帖子数设置为 3。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T10:40:15.113

```
if (have_posts()) : $count = 0;            
while (have_posts()) : the_post(); $count++;
      echo '<h2>';
      the_title(); 
      echo '</h2>';
      the_content( 'Read the full post »' ); 
endwhile; 
```

万一;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T17:53:05.603

弄清楚了。我正在使用`roots`主题。在这个主题里面有`base.php`需要该行的文件

```
<?php include roots_template_path()?> 
```

缺少这条线不允许它选择正确的模板。

# android - AppWidgetProvider 中 ImageView 的大小

> ID：14005031
> 
> 赞同：0
> 
> 时间：2012-12-22T17:38:44.117
> 
> 标签：android

无法在小部件应用程序（AppWidgetProvider）中获取 ImageView 的大小？我想在这个 ImageView 中放一个位图，我需要知道它的大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T18:40:27.447

为什么你需要准确地知道尺寸？据我所知，图像会根据小部件的尺寸自动调整大小。

但是如果你想知道大小，我认为你可以用[getMaxHeight()](http://developer.android.com/reference/android/widget/ImageView.html#getMaxHeight%28%29)和[getMaxWidth()做到这一点](http://developer.android.com/reference/android/widget/ImageView.html#getMaxWidth%28%29)

# javascript - 在 KineticJS 中单击时向多边形添加一个新点

> ID：14005035
> 
> 赞同：1
> 
> 时间：2012-12-22T17:38:58.160
> 
> 标签：javascript, jquery, html, canvas, kineticjs

我在舞台上有一个多边形（正方形）。当用户单击多边形的任何边时，将在该点创建一个新顶点，边数增加 1。

**问题：**如何检测对多边形边缘/笔划的点击？

检测到点击后，如何在点击的位置向多边形添加一个新的顶点/点？我猜如果将新点添加到多边形`points`数组的末尾，多边形可能会重叠，因为它以逆时针方式绘制多边形。

**jsfiddle 尝试**：http: [//jsfiddle.net/frpn7/](http://jsfiddle.net/frpn7/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T17:46:20.303

切换到“单击”以捕获对多边形的单击：

```
poly.on('click', function(e) { 
```

不幸的是，这也会在多边形内部引发点击事件，因此如果您只想让边框可点击，则需要创建 2 个多边形（1 个用于内部，1 个用于边框），否则您可能会尝试不填充多边形。

*编辑如何做到这一点：*

您可以通过将两个形状组合在一起并将它们放在一组中来做到这一点。第一个形状有边框，第二个没有边框。

```
 var first_poly = new Kinetic.Polygon({
            points: [73, 192, 73, 160, 340, 23, 500, 109, 499, 139, 342, 93],
            fill: '#00D2FF',
            stroke: 'black',
            strokeWidth: 5
        });
        var second_poly = new Kinetic.Polygon({
            points: [73, 192, 73, 160, 340, 23, 500, 109, 499, 139, 342, 93],
            fill: '#00D2FF',
            stroke: 'black',
            strokeWidth: 0
        });

        first_poly.on("click",function(){
            alert("border clicked");
        })
        // add the shape to the layer
        layer.add(first_poly);
        layer.add(second_poly);
        stage.add(layer); 
```

第二部分借自：[Kinetic JS - Detecting Click on Border of Shape](https://stackoverflow.com/questions/12458943/kinetic-js-detecting-click-on-border-of-shape)

接下来是重新绘制多边形的第三部分。抽象地说，您总是可以清除这些多边形并简单地重新绘制整个多边形。首先确定单击在多边形点数组中的新位置。您可以通过遍历每个点来确定最近的 2 个点并将其注入它们之间来近似它。

# javascript - 数组推送在 JavaScript 中不起作用

> ID：14005036
> 
> 赞同：0
> 
> 时间：2012-12-22T17:39:02.577
> 
> 标签：javascript, html

为什么数组推送在以下代码中不起作用？有人可以找到错误吗？

```
<html>
<body>
<script>
words=new Array("limit","lines","finish")
words.push("complete","In","Out")
var jwords=words.join(;)
document.write(jwords)
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T17:39:52.357

```
words.join(;) 
```

应该：

```
words.join(";"); 
```

这实际上是一个语法错误，可以被您的浏览器 ( `F12`) 捕获。

一些技巧：

1.  使用关键字创建变量名称`var`。您的`words`变量不是用`var`.

2.  不要使用`Array`构造函数。使用数组文字语法`[]`。这意味着将第一行更改为：

    ```
    var words = [ 'limit', 'lines', 'finish' ]; 
    ```

3.  使用`console.log`而不是`document.write`. 您可以通过点击在浏览器中查看结果`F12`。`document.write`在某些情况下使用时会导致问题，因此最好避免使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T17:41:22.557

您需要`;`在此行中引用参数

> var jwords=words.join(';')

# php - Wordpress - 按标签显示分类

> ID：14005043
> 
> 赞同：0
> 
> 时间：2012-12-22T17:39:58.503
> 
> 标签：php, arrays, wordpress, taxonomy

有没有办法可以显示带有分类标签的帖子？
我懂了：

```
$args = array(
'posts_per_page' => 2,
'post_type' =>"works", 
'post_status' => array('publish') 
```

我想以类似的方式显示一些带有“*游戏*”标签的帖子

```
$args = array(
'posts_per_page' => 2,
'post_type' =>"works", 
    'tax_query' => array(
      array(
      "singular_label" => 'gamed',

  )
    'post_status' => array('publish') 
```

非常感谢你的帮助。

# json - 将 JSON 消息从 Android 设备发送到服务器

> ID：14005044
> 
> 赞同：1
> 
> 时间：2012-12-22T17:40:00.233
> 
> 标签：json, http, servlets, url-encoding

我有一个 Android 设备，它创建 JSON 格式的消息并将其发送到 Tomcat 服务器。服务器正在运行一个 Java Web 应用程序，该应用程序接收此 JSON 格式的消息，然后对其进行处理。

我的问题是，当服务器收到消息时，服务器会将某些字符（'{'、'['、'"'、']' 和 '}'）替换为看起来像它们的十六进制表示，这会导致服务器无法识别消息的 JSON 错误。

我的问题是是否有人知道导致此问题的原因以及我将如何解决此问题（我确定这不是 JSON 代码，而是消息在发送/接收方面的处理方式）。

这是我的服务器端代码：

```
@Override
protected void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    // Setup response
    PrintWriter out = response.getWriter();

    // Store input message as String
    StringBuilder sb = new StringBuilder();
    String message;

    // Build String
    while ((message = request.getReader().readLine()) != null) {
        sb.append(message);
    }

    // Full message as String
    message = sb.toString();

    // Convert message to JSON format
    Gson gson = new Gson();
    ImageFeatures features = gson.fromJson(message, ImageFeatures.class);

    out.println("Normal data: " + features);
    out.println();
} 
```

这是我收到的错误：

```
com.google.gson.JsonSyntaxException: java.lang.IllegalStateException: Expected BEGIN_OBJECT but was STRING at line 1 column 12
com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:176)
com.google.gson.Gson.fromJson(Gson.java:795)
com.google.gson.Gson.fromJson(Gson.java:761)
com.google.gson.Gson.fromJson(Gson.java:710)
com.google.gson.Gson.fromJson(Gson.java:682) 
```

这是在 Android 设备将消息发送到服务器**之前生成的 JSON 格式的消息：**

```
{
"image_x_size":800,
"image_y_size":1600,
"features":
    [
        {"cart_x":5.0,"cart_y":124.0,"polar_angle":0.0,"polar_dist":0.0,"size":15.0},
        {"cart_x":5.0,"cart_y":124.0,"polar_angle":0.0,"polar_dist":0.0,"size":15.0}
    ]
} 
```

这是服务器看到消息的方式（即`message`字符串的内容）：

```
%7B+%09%22image_x_size%22%3A800%2C+%09%22image_y_size%22%3A1600%2C+%09%22features%22%3A+%09%09%5B+%09%09%09%7B%22cart_x%22%3A5.0%2C%22cart_y%22%3A124.0%2C%22polar_angle%22%3A0.0%2C%22polar_dist%22%3A0.0%2C%22size%22%3A15.0%7D%2C+%09%09%09%7B%22cart_x%22%3A5.0%2C%22cart_y%22%3A124.0%2C%22polar_angle%22%3A0.0%2C%22polar_dist%22%3A0.0%2C%22size%22%3A15.0%7D+%09%09%5D+%7D+ 
```

如您所见，消息字符串具有替换某些字符的各种十六进制值。

提前谢谢了！

编辑：我想我应该包括我的 Android 代码以进一步清楚

```
HttpClient http_client = new DefaultHttpClient();

// Set long timeout limit
HttpConnectionParams.setConnectionTimeout(http_client.getParams(), 10000);
HttpConnectionParams.setSoTimeout(http_client.getParams(), 10000);
HttpResponse response;

// Setup json_object
JSONObject json_object = convertImageFeaturesToJSON(data, x, y);

try {
HttpPost http_post = new HttpPost(URL_BASE + "/featureuploader");

Log.i(TAG, json_object.toString());

StringEntity se = new StringEntity(json_object.toString());
se.setContentType("application/json; charset=UTF-8");
se.setContentEncoding(new BasicHeader(HTTP.CONTENT_TYPE, "application/json; charset=UTF-8"));

http_post.setEntity(se);
http_post.setHeader("Accept", "application/json");
http_post.setHeader("Content-Type", "application/json");

response = http_client.execute(http_post);

if (response != null) {
    String response_string = httpResponseToString(response.getEntity().getContent());
    if (! response_string.startsWith("Received: <html>")) {
        Log.i(TAG, "Received: ERROR! - " + response_string.substring(0, 20));
    } else {
        Log.i(TAG, "Received: " + response_string);
    }
} else {
    Log.e(TAG, "Did not receive from server");
}               
} catch (Exception e) {
    Log.e(TAG, "Error: " + e.getMessage());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:19:39.623

> 这就是服务器看到消息的方式......

这是您在服务器上看到的 JSON 的 URL 编码版本。您需要先对其进行解码（使用[URLDecoder](http://docs.oracle.com/javase/6/docs/api/java/net/URLDecoder.html)之类的东西），或者以您已解码的方式从请求中检索它。

# c++ - 向量的向量如何工作？

> ID：14005046
> 
> 赞同：3
> 
> 时间：2012-12-22T17:40:12.213
> 
> 标签：c++, stl, vector

[这里](https://stackoverflow.com/questions/849168/are-stdvector-elements-guaranteed-to-be-contiguous)的答案是：

> 来自 n2798（C++0x 草案）：向量的元素是连续存储的，这意味着如果 v 是一个向量，其中 T 是 bool 以外的某种类型，那么它遵循恒等式 &v[n] == &v[0 ] + n 对于所有 0 <= n < v.size()。

该程序有效：

```
#include <iostream>
#include <vector>
#include <iterator>
using namespace std;

int main(){
  int k;
  cin >> k; cout << endl << "k = " << k << endl;
  ostream_iterator<int> oi(cout, " ");
  vector<vector<int> > vpi;
  while(k--)
  {
    vpi.push_back(vector<int>(istream_iterator<int>(cin), istream_iterator<int>()));
    cin.clear();
    cout<<"k = "<< k <<endl;
    copy(vpi[vpi.size()-1].begin(), vpi[vpi.size()-1].end(), oi);
    cout<<endl;
  }
} 
```

当向量的元素必须具有相同的大小并且要存储的向量的大小事先不知道时，向量如何连续存储向量？

如果之前有人问过这个问题，我很抱歉，我找不到它，如果是这种情况，请给我一个链接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T17:59:17.000

A`std::vector`是一个小的、固定大小的对象。通常的实现涉及三个指针或一个指针和几个整数大小（对于当前大小和分配的容量）。向量的*内容*不存储在向量对象本身中，而是存储在使用向量分配器（默认为标准堆分配器）分配的内存中。

所以向量的向量是一个小对象，通常是三个指针的大小。它内部的向量是堆中某处连续内存中的小对象。这些内部向量的内容在堆中的其他地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T17:42:26.067

向量可以很容易地连续存储，因为它们的元素不在它们自己内部，而是在空闲存储的一些内存中。由 指定的对象的大小`sizeof`是*编译时常量表达式*，这些是连续存储的位。

# lucene - Lucene 4.0 - HighFreqTerms 类如何获取实际的 Term 字符串

> ID：14005049
> 
> 赞同：1
> 
> 时间：2012-12-22T17:40:49.513
> 
> 标签：lucene, indexing, search-engine, information-retrieval

我想获得 Lucene 索引的最高频率术语。

我用：

```
HighFreqTerms.getHighFreqTerms(reader, noOfTerms, field); 
```

问题是，该函数的返回类型为“TermStats []”。TermStats 类有一个名为“termText”的字段，但该字段的类型不是字符串，而是“ByteRef” - 我怎样才能获得高频术语的字符串表示形式？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:43:17.593

只需调用方法 termText.utf8ToString()。

# php - 为什么我的表单错误没有从表单验证中返回正确的消息？

> ID：14005051
> 
> 赞同：-1
> 
> 时间：2012-12-22T17:40:56.393
> 
> 标签：php, codeigniter

我正在尝试输入一个自定义表单错误，该错误将向用户显示“您没有帐户。单击此处注册”。但目前，如果我输入了不正确的用户名，我在视图中什么也看不到存在于我的个人资料数据库中。我有一个 lang 文件，它加载了我已经在我的 autoload.php 文件中定义的这个错误： $autoload['language'] = array('myerrors'); 我的视图有问题吗？认为我需要使用 form_error 行，但我并不确切在哪里......定义的错误名称是 validateUser_error。

模型：

```
 function validateUser($username, $password)
     {
      $this->db->select('*')->from('membership');
      $this->db->where('username', $username);
      $this->db->where('password', $password);
      $query = $this->db->get();
      if ($query ->num_rows ==1)
     {
        $this->form_validation->set_message('validateUser_error');

        return true;
    }

    else{
        return false;

       }
    } 
```

看法：

```
<?php echo validation_errors(); ?>

<?=form_open('login/loguserin');?>
  <p>
    username <?=form_input('username');?>
  </p>
  <p>
    password <?=form_password('password');?>
  </p>
  <p>
  <?=form_submit('submit', 'Login'); ?>
  <?=form_close(); ?>
</p> 
```

控制器：

函数登录用户（）

{

```
$this->load->helper(array('form', 'url'));

$this->load->library('form_validation');

$this->form_validation->set_rules('username', 'Username', 'required|min_length[4]|max_length[12]|callback_validateUser_error|trim');
$this->form_validation->set_rules('password', 'Password', 'required|md5|trim');

$username = $this->input->post('username');
$password = $this->input->post('password');

$valid = $this->membership->validateUser($username, $password);

if ($this->form_validation->run() && $valid == true)
{
    $this->session->set_userdata('status', 'OK');
    $this->session->set_userdata('username', $username);

    redirect('home');
}
else
{
    $this->session->set_userdata('status', 'NOT_OK');
    $this->load->view('shared/header');
    $this->load->view('account/logintitle');
    $this->load->view('account/loginview');
    $this->load->view('shared/footer');
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T01:42:29.527

更改模型方法，使其仅返回 true 或 false。如果失败，请在视图中显示一条消息。

```
 if( $this->membership->validateUser($username, $password) == false ) 
 {
      $data['error_msg'] = 'OMG what is up with your fat fingers? ';
      // load view, pass $data, $error_msg will be available in yr view
      $this->load->view('account/loginview', $data);
 } 
 else
 {
      // keep going 

 } 
```

如果检查用户名，然后检查密码，您将有更多选择。

另一种方法是在失败时使用单独的方法，并使用 $this->error_msg 或类似方法。特别是如果您正在加载一堆视图，您将不必重复它

```
 if( $this->membership->validateUser($username) == false ) 
  {
  $this->error_msg = 'No user by that name ';   
  $this->loginFail();
  } 
  elseif( $this->membership->validatePass($password) == false ) 
  {
  $this->error_msg = 'Password does not match this user name';   
  $this->loginFail();
  } 
```

然后在 loginFail() 中加载视图，相应的错误消息将自动传递给视图：

```
 $data['error_msg'] = $this->error_msg ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T21:34:04.953

在模型中设置此消息有点奇怪 - 通常这样做的地方是控制器......

另外，如果您执行 autoload `form_validation`，那么为什么要在控制器中再次加载它？如果你不这样做，如果你想在那里设置消息，你也应该将它加载到模型中。

但主要的是，只有在函数返回 false 时才会出现验证消息`validateUser_error`- 此函数似乎不存在于您的示例中。

有不同的方法来更改代码，但基本上你的 validateUser() 应该由 validateUser_error() 调用（它将由 CI 自动调用，因为它在验证规则中）可以从表单字段中获取数据并无条件调用

```
$this->form_validation->set_message('validateUser_error', 'Error message'); 
```

我希望它有所帮助。

# ravendb - 如何在 RavenDB 的文档中使用引用类型作为键

> ID：14005053
> 
> 赞同：2
> 
> 时间：2012-12-22T17:41:20.777
> 
> 标签：ravendb, composite-key

我有一个要用于[RavenDB](http://ravendb.net/)中的文档键的类：

```
public class DocumentKey
{
    public string Namespace { get; set; }
    public string Id { get; set; }
} 
```

我还实现了`ITypeConverter`（不是 .NET 接口，RavenDB 专用接口）将引用类型转换为字符串（因为在数据库中，[键实际上都只是字符串](https://groups.google.com/d/msg/ravendb/RHlIb_k-PrU/WVQG0j8vYnIJ)）。

最后，我通过通过属性公开的方式`ITypeConverter`将`IDocumentStore`实现添加到实现中。`List<ITypeConverter>``Conventions.IdentityProviders`

但是，实现上的`LoadAsync<T>`重载签名看起来像这样（为简洁起见，删除了采用多个 id 的签名。此外，与接口上`IAsyncDocumentSession`的签名相同）：`Load``IDocumentSession`

```
LoadAsync<T>(string id);
LoadAsync<T>(ValueType id); 
```

我真的不想为我的键使用值类型，原因如下：

*   我有一个抽象，它对键的类型没有限制。创建单独的结构来反映这一点只是为了拥有值类型是*非常*不方便的。
*   通过限制为值类型，我无法完全控制类型。值类型有一个默认构造函数，它以我不想在代码中的其他任何地方处理的方式默认值。

如何在 RavenDB 中使用引用类型作为文档键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T17:41:20.777

因为所有文档标识符最终都存储为 RavenDB 中的字符串，所以关键是使用带字符串的重载：

```
LoadAsync<T>(string id); 
```

从`IAsyncDocumentSession`界面中，您可以使用`Conventions`(exposed by `Advanced.DocumentStore.Conventions`)，特别是`FindFullDocumentKeyFromNonStringIdentifier`委托，它具有以下签名：

```
string FindFullDocumentKeyFromNonStringIdentifier(
    object id, Type type, bool allowNull); 
```

以下是参数的作用：

*   `id`- 这是用作文档标识符的对象。在上面的示例中，它将是`DocumentKey`实例。由于这是作为`object`（而不是 a [`ValueType`](http://msdn.microsoft.com/en-us/library/system.valuetype.aspx)）类型的，因此此处将接受引用类型。
*   `type`-[`Type`](http://msdn.microsoft.com/en-us/library/system.type.aspx)表示`id`所属项目类型的实例。打电话`LoadAsync<T>`的时候是这样的`typeof(T)`。
*   `allowNull`- 这是作为`allowNull`参数传递的，通过`ITypeConverter.ConvertFrom`添加到`IdentityProviders`暴露的实现中`Conventions`。

这都可以包含在强类型的扩展方法中`IAsyncDocumentSession`（或`IDocumentSession`根据需要进行修改），如下所示：

```
static Task<T> LoadAsync<T, TId>(this IAsyncDocumentSession session, TId id)
{
    // Validate parameters.
    if (session == null) throw new ArgumentNullException("session");
    // Check if the id is null.
    if ((object) id == null) throw new ArgumentNullException("id");

    // Get the string id.
    string stringId = session.Advanced.DocumentStore.Conventions.
        FindFullDocumentKeyFromNonStringIdentifier(id, typeof(T), true);

    // Load using the string id.
    return session.LoadAsync<T>(stringId);
} 
```

[请注意，`if ((object) id == null)`在这种情况下，比较可能会对性能产生影响。](https://stackoverflow.com/q/12396457/50776)

# c++ - 头文件中的全局变量和函数

> ID：14005056
> 
> 赞同：1
> 
> 时间：2012-12-22T17:41:32.167
> 
> 标签：c++, class, header, global-variables, code-separation

我试图将我的代码分成标题和 cpp
我为我拥有的每个类创建了一个 .h 和 .cpp
但我不知道将函数（不在类中）和
我尝试放置的全局变量放在哪里它们在 main 中，但没有
用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T17:43:30.573

在.h中：

```
extern int myGlobal;
int myFunction(int arg); 
```

在.cpp 文件*之一中：*

```
int myGlobal;

int myFunction(int arg)
{
    return arg + 5;
} 
```

您可以将内容拆分到多个 .cpp 文件中，只是不要在多个地方*定义任何内容。*如果您将定义放在 .h 文件中，并多次包含它，您会得到多个（冲突的）定义。

# php - 将标题保留在动态网站上

> ID：14005059
> 
> 赞同：3
> 
> 时间：2012-12-22T17:41:41.217
> 
> 标签：php, javascript, jquery, ajax, html

我正在尝试使用 ajax 制作一个动态网站。此时，它有点像在使用 jQuery 进行 ajax 调用后刷新主 div 的单个页面。我此时遇到的问题是通过这样做：

1.  后退按钮不像用户期望的那样工作。
2.  用户无法为某个结果页面添加书签。

我想我可以通过 ajax 调用另一个 php 来刷新页面并拥有一个新的 URL 和标题。我遇到的问题是我不是整页刷新的忠实粉丝。

我想要的至少是一个标题是静态的并且内容是动态的但返回按钮可以工作并且用户可以为页面添加书签的站点。

如果不清楚，我深表歉意，但希望我可以根据任何问题进一步解释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T17:45:48.320

您可以使用 HTML5 的历史 API 推送/弹出页面状态。 [这篇文章](http://html5doctor.com/history-api/)应该可以帮助您指出正确的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T17:50:19.670

您可以通过使用页面锚标记来实现您想要做的事情。完成 ajax 刷新后，将页面重定向到锚标记，

```
// Possibly using
window.location.href = "yourpage.html#myanchortag" 
```

在哪里并不重要，你要做的就是让你的后退按钮起作用。

如果这不起作用，请嵌入隐藏的 iframe。每次 iframe 更改时，后退按钮都会起作用。

虽然使用 html5 和更新的浏览器，但我认为您可能能够原生地操作后退按钮历史记录。不要引用我的话。

我个人使用谷歌的闭包库，他们有一大堆库代码可以做到这一点。可能值得研究他们是如何做到的。

你可以在这里找到源代码和文档

[https://closure-library.googlecode.com/svn-history/r4/trunk/closure/goog/docs/class_goog_History.html](https://closure-library.googlecode.com/svn-history/r4/trunk/closure/goog/docs/class_goog_History.html)

有一些想法和地方可以帮助您入门。

# c++ - 未定义的引用

> ID：14005060
> 
> 赞同：1
> 
> 时间：2012-12-22T17:41:44.397
> 
> 标签：c++, linker-errors, undefined-reference, build-error

> **可能重复：**
> [C++ 模板，未定义的引用](https://stackoverflow.com/questions/648900/c-templates-undefined-reference)

我有一个非常简单的程序，由三个文件组成，它从普通数组构建向量：

```
//create.hpp

#ifndef CREATE_HPP_
#define CREATE_HPP_

#include <vector>

using namespace std;

template<class T>
vector<T> create_list(T uarray[], size_t size);

#endif /* CREATE_HPP_ */ 
```

* * *

```
//create.cpp

#include "create.hpp"

template<class T>
vector<T> create_list(T uarray[], size_t size){
    vector<T> ulist(uarray, uarray + size);
    return ulist;
} 
```

* * *

```
//main.cpp

#include <vector>
#include <iostream>

#include "create.hpp"

using namespace std;

int main(){
    char temp[] = { '/', '>' };
    vector<char> uvec = create_list<char>(temp, 2);

    vector<char>::iterator iter=uvec.begin();
    for(;iter != uvec.end();iter++){
        cout<<*iter<<endl;
    }

    return 0;
} 
```

构建过程如下：

```
g++ -O0 -g3 -Wall -c -fmessage-length=0 -o create.o create.cpp
g++ -O0 -g3 -Wall -c -fmessage-length=0 -o main.o main.cpp
g++ -o main.exe main.o create.o 
```

在构建程序时，我收到此错误：

```
main.o: In function `main':
../main.cpp:18: undefined reference to `std::vector<char, std::allocator<char> > create_list<char>(char*, unsigned int)' 
```

这个程序真的很简单。但是，编译成功通过，但链接失败。然后我将所有代码移动到一个文件中，一切都像一个魅力。任何人都可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T17:44:34.887

是的。答案很复杂。它与模板在 C++ 中的实际工作方式有关。

简短的回答：完整的模板定义必须在头文件中，或者您必须有一个明确的实例化（例如[http://msdn.microsoft.com/en-us/library/by56e477(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/by56e477(v=vs.80).aspx)）对于 CPP 文件中的给定类型。

长答案（原因）：模板不是可以编译成二进制（对象）的代码。它们只是“创建代码的秘诀”，并且只能在实例化过程中创建代码。这也是为什么不准确地使用模板可能会导致编译时间长并且二进制文件比需要的大的原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T17:48:54.120

您已在单独的`.cpp`文件中定义模板。每个文件都是单独编译的。您`create.cpp`不包含任何正在运行的代码，因此它被编译器丢弃。后来，在链接阶段，当链接器尝试链接 with 的二进制文件时`main.cpp`，`create_list`它在其他编译对象中找不到它，因此您收到此错误。要解决它，您需要在您的模板中至少实例化一次，`create.cpp`或者在头文件中实现。

# c++ - 如何在命令行中使 gcc 链接器输出节大小？

> ID：14005065
> 
> 赞同：1
> 
> 时间：2012-12-22T17:42:17.597
> 
> 标签：c++, gcc

我为 MCU 编程。代码和数据的大小很重要，编译后我需要知道这些部分的大小。我知道如何获得这些信息。只需定义

```
__text_size = SIZEOF(.text); 
```

在链接器脚本文件中，然后我可以在链接器输出的映射文件中获取它的值。（“.text”是我的链接器脚本文件中定义的部分）。但是，我讨厌每次编译和链接后打开地图文件并搜索 __text_size。有没有办法告诉链接器在命令行输出节的大小？例如 Keil 总是在编译后输出代码、rodata、数据和 zi-data 大小。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T17:52:02.843

您可以使用[size](http://linux.die.net/man/1/size)实用程序：

> $size 测试
> 文本数据 bss dec 十六进制文件名
> 1153 504 24 1681 691 测试

# scala - 使用 xsbt-web-plugin 请求登录 Jetty 容器的控制台

> ID：14005066
> 
> 赞同：2
> 
> 时间：2012-12-22T17:42:19.310
> 
> 标签：scala, logging, jetty, sbt, xsbt-web-plugin

我正在使用`xsbt-web-plugin`开发网络服务。

为了更容易调试，我想在控制台中打开请求日志，如下所示。

> [22/Dez/2012:15:29:56 +0000]“获取/消息 HTTP/1.1”200 27276

在生产中我使用`NCSARequestLog`的很好，但在开发中我想在我通过/`sbt console`启动容器的地方包含日志`container:start`

如何启用请求日志？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-23T21:07:46.710

要启用请求日志，您可以`NCSARequestLog`通过自定义*jetty.xml*文件进行配置。

将此添加到*build.sbt*：

```
env in Compile := Some(file(".") / "jetty-env.xml" asFile) 
```

创建*myproject/jetty-env.xml*：

```
<Configure class="org.eclipse.jetty.webapp.WebAppContext">

  <Set name="handler">
    <New id="RequestLog" class="org.eclipse.jetty.server.handler.RequestLogHandler">
      <Set name="requestLog">
        <New id="RequestLogImpl" class="org.eclipse.jetty.server.NCSARequestLog">
          <Set name="filename"><Property name="jetty.logs" default="./logs"/>/test-yyyy_mm_dd.request.log</Set>
          <Set name="filenameDateFormat">yyyy_MM_dd</Set>
          <Set name="LogTimeZone">GMT</Set>
          <Set name="retainDays">90</Set>
          <Set name="append">true</Set>
        </New>
      </Set>
    </New>
  </Set>

</Configure> 
```

在 sbt 中，运行`container:start`，您将看到在*myproject/logs*下收集的请求日志。当我对此进行测试时，Jetty 不会自行创建*日志*目录——我必须自己创建。

您可以通过以下方式实时查看请求日志`tail`：

```
tail -f myproject/logs/test-2013_08_23.request.log 
```

有关这方面的完整示例，请参阅 xwp-template 的[*request-logging*分支](https://github.com/JamesEarlDouglas/xwp-template/tree/request-logging)。

# cassandra - 卡桑德拉数据丢失

> ID：14005067
> 
> 赞同：1
> 
> 时间：2012-12-22T17:42:22.230
> 
> 标签：cassandra

我的 cassandra 数据库刚刚丢失了大部分数据。这只是测试数据，但我仍然需要了解发生了什么，并确保真实数据不会发生这种情况。

我在 Windows Server 上将 cassandra 1.1 作为服务运行。db 接收来自 ac# 应用程序的数据。脚本终止并重新启动了 cassandra 服务。在那之后，过去 20 小时左右的所有数据都消失了。旧数据仍然存在。

有问题的数据可能根本没有写入磁盘。但是，数据库在有问题的 20 小时内正确回答了查询，因此数据必须至少在内存中。

除了存储位置等之外，该配置与默认配置相同。刷新策略是

```
commitlog_sync: periodic 
commitlog_sync_period_in_ms: 10000 
```

感谢任何提示，包括尝试什么以及在日志文件或配置中查找什么。

**编辑：**经过更多试验后，我现在可以重现以下内容：

*   插入新数据 - 好的
*   查询新数据 - 好的
*   停止并重新启动 db - 所有新数据现在都消失了:(（旧数据仍然存在）
*   日志文件中没有任何内容，只是“日志重播完成，0 次重播突变”

**Edit2：**从一个新的空数据库开始，现在一切正常（当然配置相同）。使用我损坏的数据库的备份，我可以再次重现上述问题。我在 cassandra 中发现了一个错误吗？显然，我的数据库处于未写入或未正确重播提交日志的状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T18:18:51.820

“新突变不会重播，但旧突变仍然存在”听起来像[https://issues.apache.org/jira/browse/CASSANDRA-4782](https://issues.apache.org/jira/browse/CASSANDRA-4782)，已在 1.1.6 中修复。最新的 1.1 版本是 1.1.8；你应该升级到那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T15:01:03.560

我会查看数据目录并想知道它们是否设置正确。它们是否正确存在？它们是可写的吗？与您工作的数据库进行比较。请注意，在您进行节点工具修复之前，其中一个目录不会被写入太多内容。

我的猜测是 cass 纯粹是从内存中工作的，因为它不能写。

它应该为每次更新写一个日志记录。

# c++ - 从 C++ 中的父析构函数调用子方法

> ID：14005070
> 
> 赞同：4
> 
> 时间：2012-12-22T17:42:41.857
> 
> 标签：c++

```
class A {
public:
  ~A() { release(); }
  virtual release() { cout << "~A"; } 
}

class B : public A {
  release() { cout << "~B"; }
} 
```

当我删除 B 时，只调用了 A 类的 release() 方法。

我想要实现的是对于每个子对象，当它被删除时，我想调用在每个子类中被覆盖的 release 方法，而不需要为每个子对象手动指定析构函数来调用 release（我很懒）。这实际上不可能以这种方式或任何其他方式实现吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-22T17:45:08.657

*析构*函数的执行顺序与*构造函数*的相反，所以当`A`in a`B`被销毁时，它的`B`组件已经被销毁并且不再存在。在被破坏的对象上调用方法会产生*未定义的行为*，这就是为什么对*虚拟方法的调用总是解析为**构造函数*或*析构函数*中的当前类类型。

所以基本上不，你不能这样做。你必须把它们都写下来。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T17:45:25.913

不要从析构函数或构造函数调用虚方法——它们不会做你期望它们做的事情。

放弃懒惰并编写析构函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-22T18:18:04.047

此类问题的解决方案是预销毁阶段，您可以在其中手动控制销毁的发生方式。

`pImpl`使用该模式实现您的对象。当包装对象被销毁时，`pImpl`在销毁它之前通知它将被销毁。

`pImpl`可以有一个`virtual PreDestroyable`允许子方法注册`PreDestruction`回调的基类，您可以在此预销毁阶段调用该回调。

```
class Destroyable {
protected:
  Destroyable() {}; // must be empty
  virtual ~Destroyable() { Assert(PreDestroyers.empty()); };
  void RegisterPreDestroy( std::function<void()> const& func ) { PreDestroyers.push_back(func) );
private:
  std::vector<std::function<void()>> PreDestroyers;
public:
  // reverse order, reentrant:
  void PrepareToDie() {
    while (!PreDestroyers.empty()) {
      auto f = PreDestroyers.back();
      PreDestroyers.pop_back();
      f();
    }        
  }
};

// handles registration:
template<typename T>
class HasPreDestroyCode: public virtual Destroyable {
  // TODO: usual CRTP static or dynamic checks:
  T* self() { return static_cast<T*>(this); }
  T const* self() const { return static_cast<T*>(this); }
  HasPreDestroyCode() {
    RegisterPreDestroy( [&]() { self()->PreDestroy(); } );
  }
  HasPreDestroyCode( HasPreDestroyCode const& other ) {
    RegisterPreDestroy( [&]() { self()->PreDestroy(); } );
  }
  HasPreDestroyCode( HasPreDestroyCode const& other ) {
    RegisterPreDestroy( [&]() { self()->PreDestroy(); } );
  }
private:
  HasPreDestroyCode& operator=( HasPreDestroyCode const& other ) = delete;
};

class Test: HasPreDestroyCode<Test> {
public:
  void PreDestroy() {}
}; 
```

我上次在 C++11 之前写了这些东西，所以我还没有弄清楚如何处理构建它的移动。并且这一切都是在运行时完成的，而可能用更少的运行时数据来做类似上面的事情。类似于层次结构中包含预销毁代码的类型列表之类的东西？

# c++ - 编译 Twilio C++ 源代码

> ID：14005076
> 
> 赞同：1
> 
> 时间：2012-12-22T17:43:39.043
> 
> 标签：c++, windows-7, g++, twilio

我是 C++ 新手，我正在尝试在 Windows 上为它编译 twilio 库。

当我尝试构建代码时，出现以下错误

简要概述我所做的和正在使用的。

我已经安装了 MinGW，所有库文件都在它下面的正确包含文件夹中。

我正在为我的 IDE 使用 sublime，这是构建它时收到的错误。

更新*

我已经运行了。我正在从 Cygwin 复制输出，但正常的 DOS 提示符给出了相同的输出。

$ mingw32-make

ar rcs twilio-cplusplus.a Rest.o TwiML.o Utils.o

如果这有助于让我知道并感谢您迄今为止的回复，我可以在这里复制 make 文件或任何代码。

结束更新*

我知道我必须遗漏一些简单的东西，任何帮助将不胜感激。

```
C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0x313): undefined reference to `twilio::Rest::request(std::string const&, std::string const&, std::vector<twilio::Var, std::allocator<twilio::Var> > const&)'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0x74a): undefined reference to `twilio::Rest::request(std::string const&, std::string const&, std::vector<twilio::Var, std::allocator<twilio::Var> > const&)'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0xb69): undefined reference to `twilio::Rest::request(std::string const&, std::string const&, std::vector<twilio::Var, std::allocator<twilio::Var> > const&)'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0xc74): undefined reference to `twilio::Say::setLoop(int)'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0xcae): undefined reference to `twilio::Say::setVoice(std::string const&)'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0xcdc): undefined reference to `twilio::Verb::append(twilio::Verb&)'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0xcf1): undefined reference to `twilio::Verb::toXML()'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0xd54): undefined reference to `twilio::Gather::setNumDigits(int)'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0xdca): undefined reference to `twilio::Verb::append(twilio::Verb&)'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0xde2): undefined reference to `twilio::Verb::append(twilio::Verb&)'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0xdfa): undefined reference to `twilio::Verb::append(twilio::Verb&)'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0xe0f): undefined reference to `twilio::Verb::toXML()'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text+0xfe3): undefined reference to `twilio::Utils::validateRequest(std::string const&, std::string const&, std::vector<twilio::Var, std::allocator<twilio::Var> >&)'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio3SayC1ERKSs[twilio::Say::Say(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)]+0x14): undefined reference to `twilio::Verb::V_SAY'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio6GatherC1Ev[twilio::Gather::Gather()]+0x3a): undefined reference to `twilio::Verb::V_GATHER'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio6GatherC1Ev[twilio::Gather::Gather()]+0x66): undefined reference to `twilio::Verb::V_SAY'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio6GatherC1Ev[twilio::Gather::Gather()]+0x7c): undefined reference to `twilio::Verb::V_PLAY'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio6GatherC1Ev[twilio::Gather::Gather()]+0x92): undefined reference to `twilio::Verb::V_PAUSE'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio8RedirectC1Ev[twilio::Redirect::Redirect()]+0x3a): undefined reference to `twilio::Verb::V_REDIRECT'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio13TwiMLResponseC1Ev[twilio::TwiMLResponse::TwiMLResponse()]+0x3a): undefined reference to `twilio::Verb::V_RESPONSE'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio13TwiMLResponseC1Ev[twilio::TwiMLResponse::TwiMLResponse()]+0x66): undefined reference to `twilio::Verb::V_GATHER'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio13TwiMLResponseC1Ev[twilio::TwiMLResponse::TwiMLResponse()]+0x7c): undefined reference to `twilio::Verb::V_RECORD'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio13TwiMLResponseC1Ev[twilio::TwiMLResponse::TwiMLResponse()]+0x92): undefined reference to `twilio::Verb::V_DIAL'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio13TwiMLResponseC1Ev[twilio::TwiMLResponse::TwiMLResponse()[Finished in 3.9s with exit code 1]]+0xa8): undefined reference to `twilio::Verb::V_SAY'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio13TwiMLResponseC1Ev[twilio::TwiMLResponse::TwiMLResponse()]+0xbe): undefined reference to `twilio::Verb::V_PLAY'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio13TwiMLResponseC1Ev[twilio::TwiMLResponse::TwiMLResponse()]+0xd4): undefined reference to `twilio::Verb::V_REDIRECT'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio13TwiMLResponseC1Ev[twilio::TwiMLResponse::TwiMLResponse()]+0xea): undefined reference to `twilio::Verb::V_REJECT'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio13TwiMLResponseC1Ev[twilio::TwiMLResponse::TwiMLResponse()]+0x100): undefined reference to `twilio::Verb::V_HANGUP'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio13TwiMLResponseC1Ev[twilio::TwiMLResponse::TwiMLResponse()]+0x116): undefined reference to `twilio::Verb::V_PAUSE'
    C:\Users\user\AppData\Local\Temp\ccInjOWV.o:Examples.cpp:(.text$_ZN6twilio13TwiMLResponseC1Ev[twilio::TwiMLResponse::TwiMLResponse()]+0x12c): undefined reference to `twilio::Verb::V_SMS'
    collect2: ld returned 1 exit status 
```

# c# - 如何检测到 Windows VirtualStore 的文件重定向？

> ID：14005081
> 
> 赞同：11
> 
> 时间：2012-12-22T17:44:36.613
> 
> 标签：c#, virtualization, uac, virtualstore

自 Win Vista 发布以来，Microsoft 为作为 32 位进程运行的遗留应用程序引入了文件虚拟化。作为 Microsoft 的用户帐户控制 (UAC) 的一部分发布的任何旧版应用程序尝试写入被认为受操作系统保护的任何位置都会被重定向到 VirtualStore。

此时，已采取措施确保相关应用程序现在作为可识别 UAC 的 64 位进程运行，但是，这对于解决将用户数据迁移到被认为不受虚拟化安全的位置的问题几乎无济于事。

在解决此问题时，我发现在处理多个用户帐户时，在位于 的旧路径中进行了一些更改，`C:\Program Files(x86)\MyApp\Data`同时对位于 的 VirtualStore 进行了更改`%localappdata%\VirtualStore\Programs\MyApp\Data`。问题是，如何检测是否正在发生任何文件/文件夹虚拟化以及如何合并这两个位置？

**编辑：**我发现几个网站详细说明了问题以及如何复制它，但没有包含修复它的方法。我确实找到了这个引用[FILE_ATTRIBUTE_VIRTUAL](http://msdn.microsoft.com/en-us/library/ee332330%28VS.85%29.aspx)，它定义了一个似乎很有希望的文件属性 - 我在某处找到了另一个引用，虽然我不记得在哪里，它指出这是 Windows 用来指示文件虚拟化正在发生并标记的属性请求重定向。

这些链接描述了这个问题：

[http://www.c-sharpcorner.com/uploadfile/GemingLeader/windows-file-and-registry-virtualization/](http://www.c-sharpcorner.com/uploadfile/GemingLeader/windows-file-and-registry-virtualization/)

[http://www.codeproject.com/Articles/66275/Windows-Vista-File-and-Registry-Virtualization](http://www.codeproject.com/Articles/66275/Windows-Vista-File-and-Registry-Virtualization)

[http://download.microsoftvirtuallabs.com/download/8/a/7/8a71365b-4c80-4e60-8185-8f12f59bf1d4/UACDataRedirection.pdf](https://web.archive.org/web/20091229140330/http://download.microsoftvirtuallabs.com/download/8/a/7/8a71365b-4c80-4e60-8185-8f12f59bf1d4/UACDataRedirection.pdf)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-05T04:53:28.507

不容易，但我找到了如何检测是否启用了 UAC 虚拟化。作为信息类调用[`GetTokenInformation()`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa446671%28v=vs.85%29.aspx)和传入`TokenVirtualizationEnabled`将返回是否启用了文件和注册表虚拟化。这是一个 C 函数：

```
// Gets whether the current process has UAC virtualization enabled.
// Returns TRUE on success and FALSE on failure.
BOOL GetVirtualizationEnabled(BOOL *enabled) {
    HANDLE token;
    DWORD tmpEnabled;
    DWORD returnLen;
    BOOL retVal = TRUE;

    if(!OpenProcessToken(GetCurrentProcess(), TOKEN_QUERY, &token))
        return FALSE;

    if(!GetTokenInformation(token, TokenVirtualizationEnabled,
            &tmpEnabled, sizeof(tmpEnabled), &returnLen)) {
        retVal = FALSE;
        goto err;
    }

    *enabled = tmpEnabled;

err:
    CloseHandle(token);

    return retVal;
} 
```

P/Invoke 有点困难，但在这里，包括 P/Invoke 标头：

```
enum TOKEN_INFORMATION_CLASS
{
    TokenUser = 1,
    TokenGroups,
    TokenPrivileges,
    TokenOwner,
    TokenPrimaryGroup,
    TokenDefaultDacl,
    TokenSource,
    TokenType,
    TokenImpersonationLevel,
    TokenStatistics,
    TokenRestrictedSids,
    TokenSessionId,
    TokenGroupsAndPrivileges,
    TokenSessionReference,
    TokenSandBoxInert,
    TokenAuditPolicy,
    TokenOrigin,
    TokenElevationType,
    TokenLinkedToken,
    TokenElevation,
    TokenHasRestrictions,
    TokenAccessInformation,
    TokenVirtualizationAllowed,
    TokenVirtualizationEnabled,
    TokenIntegrityLevel,
    TokenUIAccess,
    TokenMandatoryPolicy,
    TokenLogonSid,
    MaxTokenInfoClass
}

public const UInt32 STANDARD_RIGHTS_REQUIRED = 0x000F0000;
public const UInt32 STANDARD_RIGHTS_READ = 0x00020000;
public const UInt32 TOKEN_ASSIGN_PRIMARY = 0x0001;
public const UInt32 TOKEN_DUPLICATE = 0x0002;
public const UInt32 TOKEN_IMPERSONATE = 0x0004;
public const UInt32 TOKEN_QUERY = 0x0008;
public const UInt32 TOKEN_QUERY_SOURCE = 0x0010;
public const UInt32 TOKEN_ADJUST_PRIVILEGES = 0x0020;
public const UInt32 TOKEN_ADJUST_GROUPS = 0x0040;
public const UInt32 TOKEN_ADJUST_DEFAULT = 0x0080;
public const UInt32 TOKEN_ADJUST_SESSIONID = 0x0100;
public const UInt32 TOKEN_READ = (STANDARD_RIGHTS_READ | TOKEN_QUERY);
public const UInt32 TOKEN_ALL_ACCESS = (STANDARD_RIGHTS_REQUIRED | TOKEN_ASSIGN_PRIMARY |
    TOKEN_DUPLICATE | TOKEN_IMPERSONATE | TOKEN_QUERY | TOKEN_QUERY_SOURCE |
    TOKEN_ADJUST_PRIVILEGES | TOKEN_ADJUST_GROUPS | TOKEN_ADJUST_DEFAULT |
    TOKEN_ADJUST_SESSIONID);

[DllImport("advapi32.dll", SetLastError=true)]
static extern bool GetTokenInformation(
    IntPtr TokenHandle,
    TOKEN_INFORMATION_CLASS TokenInformationClass,
    IntPtr TokenInformation,
    int TokenInformationLength,
    out uint ReturnLength);

[DllImport("advapi32.dll", SetLastError = true)]
static extern bool SetTokenInformation(IntPtr TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,
    ref uint TokenInformation, uint TokenInformationLength);

[DllImport("advapi32.dll", SetLastError=true)]
static extern bool OpenProcessToken(IntPtr ProcessHandle,
    uint DesiredAccess, out IntPtr TokenHandle);

[DllImport("kernel32.dll", SetLastError=true)]
    static extern bool CloseHandle(IntPtr hObject);

static bool TryGetVirtualizationEnabled(out bool enabled) {
    IntPtr processHandle = Process.GetCurrentProcess().Handle;
    IntPtr token;
    uint returnLen;
    object tmpEnabled = new uint();

    enabled = false;
    GCHandle handle = GCHandle.Alloc(tmpEnabled, GCHandleType.Pinned);

    try {
        if(!OpenProcessToken(processHandle, TOKEN_QUERY, out token))
            return false;

        try {
            if(!GetTokenInformation(token, TOKEN_INFORMATION_CLASS.TokenVirtualizationEnabled,
                                    handle.AddrOfPinnedObject(), Marshal.SizeOf(typeof(uint)), out returnLen))
                return false;

            enabled = (uint)tmpEnabled != 0;
        } finally {
            CloseHandle(token);
        }
    } finally {
        handle.Free();
    }

    return true;
} 
```

我尝试使用任务管理器打开和关闭 UAC 虚拟化，并验证返回了正确的结果。可以通过调用来启用和禁用虚拟化[`SetTokenInformation()`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379591%28v=vs.85%29.aspx)。

微软表示，他们计划在未来的 Windows 版本中移除 UAC 虚拟化，并让程序不再依赖现有的 UAC 虚拟化。我看到有人建议制作一个不知道 UAC 的单独程序将文件从 VirtualStore 移动到 AppData，但我不知道这是否是一个好的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-02T01:20:58.170

FWIW，这是 Delphi 中检测代码的一个版本：

```
unit checkvirtual;

interface
uses windows;

function GetVirtualizationEnabled(var enabled:Boolean):Boolean;

implementation

// Gets whether the current process has UAC virtualization enabled.
// Returns TRUE on success and FALSE on failure.
function GetVirtualizationEnabled(var enabled:Boolean):Boolean;
var
  token:THandle;
  tmpEnabled:DWORD;
  returnLen:DWORD;
begin
  result:=false;
  enabled:=false;
  if not(OpenProcessToken(GetCurrentProcess(), TOKEN_QUERY, token)) then exit;
  try
    if not(GetTokenInformation(token, TokenVirtualizationEnabled,
              @tmpEnabled, sizeof(tmpEnabled), returnLen)) then exit;

    enabled:=tmpEnabled<>0;
    result:=true;
  finally
    CloseHandle(token);
  end;
end;

end. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T18:43:01.680

如果您从本地应用程序数据路径“运行”，听起来您正在尝试标记，在这种情况下：

```
var currentPath = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);  
var appDataPath = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData);
Console.WriteLine(
    "Current path is:{0}, AppData Path is {1}, Current is subpath of appdata path:{2}",
    currentPath, 
    appDataPath, 
    currentPath.StartsWith(appDataPath)
); 
```

# java - 简单的 CRUD 操作 异常设计

> ID：14005083
> 
> 赞同：9
> 
> 时间：2012-12-22T17:44:41.840
> 
> 标签：java, exception, jdbc, crud

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T17:58:35.860

我相信您的应用程序在开发完成后不应该处理 SQL 异常。所以，你不应该捕获像 SQLException 这样的异常。或者，如果您被迫捕获它们，则只需重新抛出 RuntimeException。根据我的荣誉经验，创建自己的异常只有在为其他人开发某种库时才有意义。即使在这种情况下，在许多情况下您也可以使用现有的异常。尝试在不创建异常的情况下进行开发。只有当你意识到你不能没有它们时才创建它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T17:56:12.633

我的想法在这里：
关于 1 - 是的，检查的异常会添加“混乱代码” - 这是一个权衡，
你需要考虑什么对你来说更重要。
在许多设计中，没有完美的解决方案，
您必须决定什么更适合您。

关于 BusinessException - 我个人不喜欢它。
我想在客户端知道，当我添加用户时，它已经存在。
我不想编写“Peals” BusinessException 的代码来获取根本原因。

和一个一般性的建议 - 请使用泛型作为 crud 异常。
例如，不要使用`UserAlreadyExistsException`，而是使用`EntityAlreadyExistsException<User>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T14:18:52.000

@Bartzilla：我也不喜欢在每一层中包装和展开异常对象，它确实使应用程序代码混乱。我宁愿认为错误代码和错误消息方法是更好的方法。对于这个问题，我认为有三种解决方案：

1) 在应用程序定义的 RunTimeException 类中包装 DB 层异常。这个 RuntimeException 应该包含一个 errorcode 字段、一个错误消息和原始异常对象。由于你所有的 DAO API 都只会抛出运行时异常，所以这意味着业务层不一定要捕获它。它将被允许冒泡直到可以处理它的程度。例如

```
class DAOException extends RuntimeException{
 private int errorCode;
 private String errorMessage;
 private Exception originalException;

 DAOException(int errorCode, String errorMessage, Exception originalException){
    this.errorCode=errorCode;
    this.errorMessage=errorMessage;
    this.originalException=originalException;
    }

} 
```

现在以这种方式，您的 DAO 方法将根据异常决定错误代码，例如：-

```
int Integrity_Voildation_ERROR=3;
 public void create(User team) throws DAOException
    {       
        try
        {
            System.out.println("Attempting to create an user - yikes the user already exists!");
            throw new SQLIntegrityConstraintViolationException();           
        }
        catch(SQLIntegrityConstraintViolationException e)
        {   int errorCode=Integrity_Voildation_ERROR;
            throw new DAOException(Integrity_Voildation_ERROR,"user is already found",e);
        }
} 
```

这个异常可以在它应该在的层中被捕获。在这种情况下，每个错误代码都意味着一个可恢复（可操作）的异常。当然，应用程序的入口点（servlet 或过滤器或任何东西）必须捕获一般异常以捕获不可恢复的异常并向用户显示有意义的错误。

2）让您的 DAO API 返回一个 Result 类型的对象，该对象包含与上述情况下 DAOException 中提供的相同信息。

所以你有 Result 类： -

```
 Class Result implements IResult{

    private boolean isSuccess;
    private int errorCode;
     private String errorMessage;
     private Exception originalException;//this might be optional to put here.
    }

So a DAO API:
    public IResult create(User team) throws DAOException
    {      
   IResult result=new Result();
        try
        {
            System.out.println("Attempting to create an user - yikes the user already exists!");
            throw new SQLIntegrityConstraintViolationException();           
        }
        catch(SQLIntegrityConstraintViolationException e)
        {   int errorCode=Integrity_Voildation_ERROR;
            result.setSuccess(false);
        result.setErrorCode(errorCode);
        result.setErrorMessage("user is already found");    
        }
    return result;
} 
```

在上述情况下，约束是每个 DAO API 都需要返回相同的结果对象。当然，您的业务相关数据可以填充到 ResultClass 的各种子类中。请注意，在情况 1 和 2 中，您可以使用枚举来定义所有可能的错误代码。可以从数据库表等中提取错误消息。

3）如果你想避免使用errorCode，你可以这样做：而不是像DAOException（上面的case1）那样定义单个RunTimeException类，你可以为每种可能的可恢复SQL异常类型定义一个异常层次结构，每个都是父类DAOException的子类。

基于 java 的 Spring 框架 DAO 异常层次结构就是一个很好的例子。请通过[这个](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/dao.html#dao-exceptions)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T06:50:09.263

基于约定优于配置概念，您可以设计您的异常处理程序，我认为为此目的最快和可靠的方法是使用 AOP，为此您可以根据异常类型处理您方面的异常，您可以做出恢复的决定从异常与否。例如，如果发生验证异常，您可以返回输入页面路径以将客户端发送到现有页面以正确填充数据，如果发生不可恢复的异常，您可以在异常处理程序中返回错误页面。

例如，您可以为输入和错误页面创建约定，为输入和错误页面提供全局名称。通过这种方式，您可以根据异常类型决定将请求发送到适当的页面。

您可以关注这篇文章以获取[面向方面的编程](https://stackoverflow.com/questions/4829088/java-aspect-oriented-programming-with-annotations)

下面添加的示例

```
 @Aspect
    public class ExceptionHandlerAspect {

        @Around("@annotation(ExceptionHandler)")
        public Object isException(ProceedingJoinPoint proceedingJoinPoint) {
            try {
                return proceedingJoinPoint.proceed();
            } catch (Exception exception) {
                if (exception instanceof UnRecoverableException) {
                    addErrorMessage("global system error occurred");
                    return "errorPage";
                } else if (exception instanceof ValidationException) {
                    addErrorMessage("validation exception occurred");
                    return "inputPage";
                } else {
                    addErrorMessage("recoverable exception occurred");
                    return "inputPage";
                }
            }
        }
    }

@Target({METHOD})
@Retention(RUNTIME)
public @interface ExceptionHandler {
} 
```

表示层

```
@ExceptionHandler
public String createUser() {
    userService.create(user);
    return "success";
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-03T09:32:48.710

看看 spring-jdbc 是如何做到的。我认为这是一个非常好的设计。Spring 处理来自驱动层的已检查异常并抛出未检查异常。它还将来自 MySQL、Postgres 等的不同异常转换为标准 Spring 异常。

在过去的 6 年里，我在所有代码中都切换到了未经检查的异常，并且没有回头。90％的时间你无法处理代码。并且您通过设计或测试了解它的情况，并将相关的 catch 块放入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-03T15:49:11.567

您说 3 层系统 - 这是否意味着这些层可能在不同的计算机或不同的进程中运行？还是只是将代码组织成一组由特定功能定义的层，并且所有东西都在单个节点上运行？

问这个的原因 - 除非你的层在不同的进程中运行 - 它没有增加 CheckedExceptions 的价值。拥有大量 CheckedExceptions 只会使代码混乱并增加不必要的复杂性。

异常设计很重要，并且按照上面建议的使用 ag112 的方式进行操作，即使用 RunTimeException 是干净的、更少的代码和可管理的。

..只是我的想法

# android - AsyncTask 返回 null

> ID：14005085
> 
> 赞同：1
> 
> 时间：2012-12-22T17:44:46.457
> 
> 标签：android, jsoup, asynctaskloader

我正在使用 jsoup 解析 html 代码，显然我使用的是 AsyncTask 但它返回 null (javanullpointerexception)。

```
private class LoadDocument extends AsyncTask<String, Void, Document>
    {

        ProgressDialog mProgressDialog;

        @Override
        protected void onPreExecute() {
            mProgressDialog = ProgressDialog.show(Parser.this, "Loading...", "Recuperation donnees...");
        }

        @Override
        protected Document doInBackground(String... url) {
            url[0] = urll;

                try {
                    document = Jsoup.connect(url[0])
                            .data("query", "Java")
                            .userAgent("Mozilla")
                            .cookie("auth", "token")
                            .timeout(10000)
                            .post();
                } catch (IOException e) {
                    e.printStackTrace();
                }

            return document;
        }

        @Override
        protected void onPostExecute(Document result) {
             document=result;
            mProgressDialog.dismiss();

        }

} 
```

然后执行任务并返回文档：

```
urll= //the website
document=new LoadDocument().execute(urll).get(); 
```

我猜那个文件总是空的。我的代码出了什么问题？感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T17:57:51.397

代码没有问题。请使用`Document.text();`您可以尝试更改要检查的一行吗？ doc =`Jsoup.connect("http://stackoverflow.com").get();`然后`Document.text()`在您的日志中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T17:49:47.277

`AsyncTask.execute()`不返回结果。相反，它返回对任务本身的引用。结果仅`onPostExecute`在任务完成后对方法可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T18:00:10.543

问题出在代码`try catch`块内的某个地方。`Jsoup`而不是`printStackTrace`，用 记录一些东西`Log.e`，然后检查您的 LogCat 输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T17:49:13.103

该代码中的许多可能会出错：

```
url[0] 
```

可以是空字符串...

我将该声明拆分为：

```
Jsoup.connect(url[0]) 
```

+

```
.data("query", "Java")
                            .userAgent("Mozilla")
                            .cookie("auth", "token")
                            .timeout(10000) 
```

*   。邮政（）;

至少

# c# - 将多个参数传递给操作

> ID：14005086
> 
> 赞同：2
> 
> 时间：2012-12-22T17:45:01.357
> 
> 标签：c#, asp.net-mvc-3, asp.net-mvc-routing

我正在尝试通过执行以下操作将多个参数传递给我的控制器中的操作：

```
@Html.ActionLink("Set", "Item", "Index", new { model = Model, product = p }, null) 
```

我的操作方法如下所示：

```
public ActionResult Item(Pro model, Pro pro)
{
   ...
} 
```

问题是action方法中的`model`和`productToBuy`变量`null`都是调用方法的时候。怎么会？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:04:15.650

您**不能将复杂对象**作为路由参数发送。因为它在传递给操作方法时会转换为查询字符串。因此始终需要使用**原始数据类型**。

它应该如下所示（示例）

```
@Html.ActionLink("Return to Incentives", "provider", new { action = "index", controller = "incentives" , providerKey = Model.Key }, new { @class = "actionButton" }) 
```

您的**路由表**应如下所示。由原始数据类型组成。

```
 routes.MapRoute(
     "Default", // Route name
     "{controller}/{action}/{id}", // URL with parameters
     new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
            ); 
```

**解决方案 1**

您可以使用 ActionLink 将模型的 Id 作为参数发送，然后从数据库中获取必要的对象，以便在控制器的操作方法中进行进一步处理。

**解决方案 2**

您可以使用**TempData**将对象从一种操作方法发送到另一种操作方法。简单地说，它是在控制器操作之间共享数据。您应该只在当前请求和后续请求期间使用它。

举个例子

**模型**

```
public class CreditCardInfo
{
    public string CardNumber { get; set; }
    public int ExpiryMonth { get; set; }
 } 
```

**动作方法**

```
[HttpPost]
public ActionResult CreateOwnerCreditCardPayments(CreditCard cc,FormCollection frm)
  {
        var creditCardInfo = new CreditCardInfo();
        creditCardInfo.CardNumber = cc.Number;
        creditCardInfo.ExpiryMonth = cc.ExpMonth;

    //persist data for next request
    TempData["CreditCardInfo"] = creditCardInfo;
    return RedirectToAction("CreditCardPayment", new { providerKey = frm["providerKey"]});
  }

 [HttpGet]
 public ActionResult CreditCardPayment(string providerKey)
  {
     if (TempData["CreditCardInfo"] != null)
        {
         var creditCardInfo = TempData["CreditCardInfo"] as CreditCardInfo;
        }

      return View();

    } 
```

# java - 使用属性抓取 Html

> ID：14005092
> 
> 赞同：2
> 
> 时间：2012-12-22T17:45:41.177
> 
> 标签：java, android, html, web-scraping, jsoup

```
<tr valign="middle" align="center"> 
<td><b>someNumbers</b></td>
<td width="22" height="22" background="..." class="SomeIntrestingClass">xxxxx</td>
<td width="22" height="22" background="..." class="SomeIntrestingClass">xgdsx</td> 
<td width="22" height="22" background="..." class="SomeIntrestingClass">xyzzx</td>
<td width="22">&nbsp;</td></tr> 
```

我正在制作一个需要来自网站的数据的应用程序。我需要提取 'someNumbers' 中的值和 td ex:'xyzzx' 中的值...
我遇到的问题是 'someNumbers 没有类所以我尝试使用
`doc.getElementsByAttributeValue(key, value)`
但属性相同在文档的其他部分。如何使用 JSoup 或任何其他聪明的想法提取这些值？感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:00:10.050

`Document.select(...);` 该方法的作用是，我们能够使用“css 选择器”，例如`td.class`or ，就像在 Jsoup中的这篇[文章](http://jsoup.org/cookbook/extracting-data/selector-syntax)`tr td #id`中的CSS 选择器一样使用它们。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-22T18:33:13.547

`<td[^<]+?>*</[^<]+?>`将其用作正则表达式并将其全部存储在一个数组中

`<td[^<]+?>`然后通过删除然后删除每个`</[^<]+?>`。

# javascript - Jquery Javascript 函数未定义

> ID：14005095
> 
> 赞同：5
> 
> 时间：2012-12-22T17:45:54.203
> 
> 标签：javascript, jquery, django-autocomplete-light

我正在尝试使用 python-django 应用程序调试 JS/Jquery 问题，同时尝试在我自己的 django 项目中实现它。我使用浏览器的开发人员控制台检索以下错误：

```
TypeError: 'undefined' is not a function (evaluating '$(this).yourlabsWidget()') 
```

于是我去寻找函数'yourlabsWidget()是在哪里定义的，它就在函数调用的正上方。

```
$.fn.yourlabsWidget = function(overrides) { ... }

$(document).ready(function() {
$('.autocomplete-light-widget[data-bootstrap=normal]').live('initialize', function() {
     $(this).yourlabsWidget();
}); 
```

我对javascript或jquery不太了解，所以我在这里完全不知所措。假设在语法上没有任何错误，这样的问题是否意味着 jquery 无法正常工作？我知道这不是很多信息，但我会添加任何其他所需的相关信息。

给我带来麻烦的应用程序和特定文件在这里（分别），

*   [https://github.com/yourlabs/django-autocomplete-light/](https://github.com/yourlabs/django-autocomplete-light/)

*   [https://github.com/yourlabs/django-autocomplete-light/blob/docs_rewrite/autocomplete_light/static/autocomplete_light/widget.js](https://github.com/yourlabs/django-autocomplete-light/blob/docs_rewrite/autocomplete_light/static/autocomplete_light/widget.js)

我已经在我的开发服务器上使用它自己的测试项目测试了该应用程序，并且它在它自己的测试项目中开箱即用。但是，如果我将一个工作测试应用程序安装到我自己的 django-project 中，它就不再工作了。

更新：

整个函数定义：

```
$.fn.yourlabsWidget = function(overrides) {
var overrides = overrides ? overrides : {};

if (this.data('widget') == undefined) {
    // Instanciate the widget
    var widget = new yourlabs.Widget(this);

    // Pares data-*
    var data = this.data();
    var dataOverrides = {autocompleteOptions: {}};
    for (var key in data) {
        if (!key) continue;

        if (key.substr(0, 12) == 'autocomplete') {
            var newKey = key.replace('autocomplete', '');
            newKey = newKey.replace(newKey[0], newKey[0].toLowerCase())
            dataOverrides['autocompleteOptions'][newKey] = data[key];
        } else {
            dataOverrides[key] = data[key];
        }
    }

    // Allow attribute overrides
    widget = $.extend(widget, dataOverrides);

    // Allow javascript object overrides
    widget = $.extend(widget, overrides);

    this.data('widget', widget);

    // Setup for usage
    widget.initialize();

    // Widget is ready
    widget.widget.attr('data-widget-ready', 1);
    widget.widget.trigger('widget-ready');
}

return this.data('widget');
} 
```

HTML（包括）

```
<!DOCTYPE html>
<html lang="en-us" >
<head>
<title></title>
<link rel="stylesheet" type="text/css" href="/static/admin/css/base.css" />
<link rel="stylesheet" type="text/css" href="/static/admin/css/forms.css" />
<!--[if lte IE 7]><link rel="stylesheet" type="text/css" href="/static/admin/css/ie.css"     /><![endif]-->

<script type="text/javascript">window.__admin_media_prefix__ = "/static/admin/";</script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>

<script type="text/javascript" src="/static/autocomplete_light/autocomplete.js"></script>
<script type="text/javascript" src="/static/autocomplete_light/widget.js"></script>
<script type="text/javascript" src="/static/autocomplete_light/addanother.js"></script>
<script type="text/javascript" src="/static/autocomplete_light/text_widget.js"></script>
<script type="text/javascript" src="/static/autocomplete_light/remote.js"></script>
<link rel="stylesheet" type="text/css" href="/static/autocomplete_light/style.css" /> 
```

HTML表格：

```
<span class="autocomplete-light-widget customer_order_products_set-0-product_id
single"
id="id_customer_order_products_set-0-product_id-wrapper"
data-max-values="1" data-bootstrap="normal"
data-autocomplete-url="http://127.0.0.1:8000/autocomplete/InventoryAutocomplete/" data-autocomplete-choice-selector="[data-value]" data-autocomplete-placeholder="THIS IS WORKING"
> 
```

注意：我知道 URL 不可移植。这只是为了测试。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T15:29:46.683

> `$(this).yourlabsWidget()`undefined 不是函数

这意味着`$(this).yourlabsWidget`未定义。

您正在加载 jQuery 两次：

*   已加载 jQuery
*   自动完成插件被加载到 jQuery 中
*   jQuery 再次加载
*   它没有自动完成插件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T17:59:16.583

你试过这样吗：

```
$.fn.yourlabsWidget = function(overrides) { ... };
$(document).ready(function() {
    $('body').on('load', function() {
       $('.autocomplete-light-widget input[data-bootstrap=normal]').yourlabsWidget();
    });
}); 
```

或者你也可以试试这个：

```
$(document).ready(function() {
   $('.autocomplete-light-widget input[data-bootstrap=normal]').yourlabsWidget();
}); 
```

我猜您在代码中缺少输入或选择标记引用。看看这是否有效

# javascript - Coffeescript（或我理解的任何语言）中贝塞尔曲线和直线相交的数学解决方案

> ID：14005096
> 
> 赞同：0
> 
> 时间：2012-12-22T17:46:06.573
> 
> 标签：javascript, coffeescript, bezier

我发现一个[论坛问题](http://www.blitzbasic.com/Community/posts.php?topic=64459)...

```
Function intersectBezier3Line(x1#,y1#,vx1#,vy1#,x2#,y2#,vx2#,vy2#,L1x#,L1y#,L2x#,L2y#)

        Local A#,B#,C#,E#,F#,G#,La#,Lb#,Lc#,Solution#

                A=3*vx1+x2-(3*vx2)-x1
        B=3*x1-(6*vx1)+(3*vx2)
        C=3*vx1-(3*x1)

                E=3*vy1+y2-(3*vy2)-y1
        F=3*y1-(6*vy1)+(3*vy2)
        G=3*vy1-(3*y1)

        La=L2y-L1y
        Lb=L1x-L2x
        Lc=L1y*(L2x-L1x) + L1x*(L1y-L2y)

                ax(4)=La*x1 + Lb*y1 + Lc
        ax(3)=La*C  + Lb*G
        ax(2)=La*B  + Lb*F
        ax(1)=La*A  + Lb*E

       FindRootsPoly3(ax(4),ax(3),ax(2),ax(1)) 

End Function

Function  FindRootsPoly3(A3#,A2#,A1#,A0#)

    Local fc2#,gc2#,hc2#,Rc2#,Sc2#,Tc2#,Uc2#,ic2#,jc2#,kc2#,Lc2#,Mc2#,Nc2#,Pc2#

    fc2 =( (3*A1/A3) - ((A2^2)/(A3^2) ))/ 3
    gc2=(( (2*A2^3)/(A3^3)) - (9*A2*A1/(A3^2)) + (27*A0/A3)) / 27
    hc2 = ((gc2^2)/4) + ((fc2^3)/27)

    If hc2>0 Then
                Rc2 = -(gc2/2) + (Sqr(hc2))
                If Rc2<0 Then 
                    Sc2 = -(Abs(Rc2)^0.333333)
                Else
                    Sc2 = ((Rc2))^0.333333
                EndIf
                Tc2 = -(gc2/2) -( Sqr(hc2))
                If Tc2<0 Then 
                    Uc2 = -(Abs(Tc2)^0.333333)
                Else
                    Uc2 = (Tc2)^0.333333
                EndIf
                Rx(0) = (Sc2 + Uc2) - (A2/(3*A3))
                Else
                If hc2=0 And gc2=0 And fc2=0 Then
                    Rx(0) =-((A0/A3)^0.3333333 )
                Else
                    If hc2<0 Or hc2=0 Then
                        ic2= Sqr(((gc2^2)/4) - hc2)
                        jc2 = (ic2)^0.333333
                        kc2 = ACos (- (gc2 / (2*ic2)))
                        Lc2 = -jc2
                        Mc2 = Cos (kc2/3)
                        Nc2 = Sqr( 3) * Sin (kc2/3)
                        Pc2 = -(A2/(3*A3))
                        Rx(0) = 2*jc2 * Cos(kc2/3) -(A2/(3*A3))
                        Rx(1) = Lc2 * (Mc2 + Nc2) + Pc2
                        Rx(2) = Lc2 * (Mc2 - Nc2) + Pc2
                   EndIf        
              EndIf
    EndIf
End Function 
```

我希望以某种方式输出直线和贝塞尔曲线之间的交点。我翻译成coffeescript

```
intersectBezier3Line = (x1,y1,vx1,vy1,x2,y2,vx2,vy2,L1x,L1y,L2x,L2y)->

  A=3*vx1+x2-(3*vx2)-x1
  B=3*x1-(6*vx1)+(3*vx2)
  C=3*vx1-(3*x1)

  E=3*vy1+y2-(3*vy2)-y1
  F=3*y1-(6*vy1)+(3*vy2)
  G=3*vy1-(3*y1)

  La=L2y-L1y
  Lb=L1x-L2x
  Lc=L1y*(L2x-L1x) + L1x*(L1y-L2y)

  ax = [
    La*x1 + Lb*y1 + Lc
    La*C  + Lb*G
    La*B  + Lb*F
    La*A  + Lb*E
  ]

  FindRootsPoly3 ax[3],ax[2],ax[1],ax[0]

pow = (x,y)-> Math.pow x,y
sqr = (x)-> x*x 

FindRootsPoly3 = (A3,A2,A1,A0)->

  fc2 = ((3*A1 / A3) - ( pow(A2,2) / pow(A3,2) ))/ 3
  gc2 = (( (2*pow(A2,3)) / pow(A3,3)) - (9*A2*A1 / pow(A3,2)) + (27*A0 / A3)) / 27
  hc2 = (pow(gc2,2)/4) + (pow(fc2,3)/27)

  Rx = []
  if hc2>0
    Rc2 = -(gc2/2) + (sqr(hc2))
    if Rc2<0
      Sc2 = -(pow(Math.abs(Rc2),0.333333))
    else
      Sc2 = pow(((Rc2)),0.333333)

    Tc2 = -(gc2/2) - ( sqr(hc2))
    if Tc2<0
      Uc2 = -pow(Math.abs(Tc2),0.333333)
    else
      Uc2 = pow((Tc2),0.333333)

    Rx[0] = (Sc2 + Uc2) - (A2/(3*A3))
  else
    if hc2==0 and gc2==0 and fc2==0
      Rx[0] = -pow((A0/A3),0.3333333 )
    else
      if hc2<0 or hc2==0
        ic2 = sqr((pow(gc2,2)/4) - hc2)
        jc2 = pow((ic2),0.333333)
        kc2 = Math.acos( -(gc2 / (2*ic2)))
        Lc2 = -jc2
        Mc2 = Math.cos(kc2/3)
        Nc2 = sqr( 3) * Math.sin(kc2/3)
        Pc2 = -(A2/(3*A3))
        Rx[0] = 2*jc2 * Math.cos(kc2 / 3) - (A2/(3*A3))
        Rx[1] = Lc2 * (Mc2 + Nc2) + Pc2
        Rx[2] = Lc2 * (Mc2 - Nc2) + Pc2
  Rx 
```

有时（有一些输入）它会输出一些东西，但主要是`NaN`and `undefined`。我不知道它到底应该输出什么，是`t`初始贝塞尔曲线上的值吗？

此外，它显然无法正常工作。任何人都可以看到我的翻译或初始代码有什么问题吗？

我真的很希望能够在数学上将贝塞尔曲线与 javascript/coffeescript 中的一条线相交！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:12:49.160

您最大的错误是在 vbscript`Sqr`中不是“平方”，而是“平方根”

编辑：（不要介意之前的评论）

编辑二：您的翻译没有问题，但似乎原始代码在定义要解决的多项式时存在一些错误：

```
bezier4poly = (A,B,C,D) ->
    [
        -A + 3*B + -3*C + D 
        3*A - 6*B + 3*C
        -3*A + 3*B
        A 
    ]
intersectBezier3Line2 = (Px0,Py0,Px1,Py1,Px2,Py2,Px3,Py3,Lx0,Ly0,Lx1,Ly1)->

    ### (x_2 - x_1)(y - y_1)=(y_2 - y_1)(x - x_1) =>  ### 
    ###(y_1 - y_2)x + (x_2 - x_1)y   + (x_1(y_2 - y_1) + - y_1(x_2 - x_1)) =>  Ax + By + C = 0  ###
    A=Ly0-Ly1
    B=Lx1-Lx0
    C=Lx0*(Ly1-Ly0) + -Ly0*(Lx1-Lx0)

    ax = bezier4poly(Px0,Px1,Px2,Px3)
    ay = bezier4poly(Py0,Py1,Py2,Py3)
    p = [
        A*ax[0] + B*ay[0]
        A*ax[1] + B*ay[1]
        A*ax[2] + B*ay[2]
        A*ax[3] + B*ay[3]  + C
    ]

    findRootsPoly3 p[0],p[1],p[2],p[3] 
```

使用这个，取这个结果并排序

```
intersectBezier3Line2(0,0,1,0,0,1,1,1,0,0,1,1) 
```

给

```
[-6.212270483585414e-7, 0.49999999999999994, 1.0000006212270485] 
```

这接近我直觉的 t 值，其中 t 的贝塞尔曲线紧邻 (0,0), (1,1) 定义的线，但我还没有接近称这个错误为免费，它只是“似乎工作”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T21:45:22.457

如果你知道 Obj-C，我发布了一个关于创建贝塞尔曲线的问题。随着纠正事情的答案，它的工作功能。

[Objective-c 中的贝塞尔曲线算法需要调整](https://stackoverflow.com/questions/10466302/bezier-curve-algorithm-in-objective-c-needs-a-tweak)

# java - 语法错误，插入“;” 完成 FieldDeclaration

> ID：14005100
> 
> 赞同：2
> 
> 时间：2012-12-22T17:46:17.660
> 
> 标签：java, android, webview

### 字符串.xml

```
<string name="app_name">WebView Z/I</string>
<string name="http://www.cherkaoui.info/Spikal"> Cherkaoui</string> 
```

### 爪哇

```
package com.firstest.android;

public final class R {
    public static final class attr {

    }

    public static final class drawable {
        public static final int ic_launcher=0x7f020000;
    }

    public static final class id {
        public static final int buttonUrl=0x7f050000;
        public static final int webView1=0x7f050001;
    }

    public static final class layout {
        public static final int main=0x7f030000;
        public static final int webview=0x7f030001;
    }

    public static final class string {
        public static final int app_name=0x7f040000;
        **public static final int http_//www_cherkaoui_info/Spikal=0x7f040001;**
    }
} 
```

网上查了一下，string.xml有问题，不知道是哪一个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T17:48:22.203

您不能`/`在标识符中使用 - 所以这个：

```
http_//www_cherkaoui_info/Spikal=0x7f040001 
```

不是有效的变量名。更改您的 XML 以使用有效的标识符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T17:48:30.950

字符串名称属性必须是一个有效的 java 标识符你认为这个`"http://www.cherkaoui.info/Spikal`“作为一个有效的 java 标识符？？？

你可以这样做

```
<string name="http_www_cherkaoui_info_Spikal"> Cherkaoui</string> 
```

然后你可以在代码中引用它

```
String str = getString(R.string.http_www_cherkaoui_info_Spikal); 
```

# ssrs-2008 - sql 报告服务操作方法：屏蔽参数

> ID：14005103
> 
> 赞同：1
> 
> 时间：2012-12-22T17:47:02.833
> 
> 标签：ssrs-2008, reporting-services

我有一个要求，允许我的用户使用客户的信用卡号作为参数为他们的客户提取报告。为了安全起见，我们希望屏蔽该字段，这在许多电子商务网站上很常见。

我很确定这不是报告服务的开箱即用功能。但我希望这可以通过在报告中添加一些 VB 来实现。不过不确定。

任何人都知道如何在报告服务中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T08:55:35.067

据我所知，SSRS 2008 中的参数没有屏蔽输入。我不确定自定义代码是否可行。您还没有告诉我们您是如何交付报告的，但是带有[ReportViewer](http://msdn.microsoft.com/en-us/library/ms345248%28v=sql.105%29.aspx)的自定义应用程序或网站可能是您解决方案的最佳选择。除了 ReportViewer 控件之外，您还可以放置自己的（屏蔽输入）控件，供用户输入参数并在后面的代码中发送值。

**不过，重要**的一点是，请仔细考虑如何处理信用卡号码。[在我们的姊妹网站security.stackexchange.com](http://security.stackexchange.com)上提出[这样](https://security.stackexchange.com/questions/10647/storing-credit-card-numbers)的问题（最重要的评论：“如果你必须问这个问题，你可能不应该存储信用卡号码。如果可能的话，外包这个”）不确定。在任何情况下，要知道默认情况下 SSRS 并不是特别安全：一方面，它将参数简单地存储在 ReportServer 数据库中。

# node.js - 如何让 {{>partials} 与 Consolidate.js 和 Mustache 一起工作？

> ID：14005106
> 
> 赞同：4
> 
> 时间：2012-12-22T17:47:14.990
> 
> 标签：node.js, express, templating, mustache

与 consolidate.js 一起使用时，我无法像 {{>my_partial}} 那样添加小胡子阅读部分。我从以下内容开始我的快速应用程序：

文件 index.js：

```
var express = require('express'),
    cons    = require('consolidate'); 

app.configure(function(){

  app.set( 'models',       BACKEND + '/models' );       // Set the models directory
  app.set( 'views',        BACKEND + '/views' );        // Set the views directory
  app.set( 'controllers',  BACKEND + '/controllers' );  // Set the controllers dir

  app.set( 'view engine',  'html' );                // Set Mustache as the templating engine
  app.engine( 'html', cons.mustache );
  app.engine( 'mustache', cons.mustache );

  app.use( app.router );  // Set the router
  app.use( '/public', express.static( BASEPATH + '/frontend/public' ) );  // set frontend/public to /public for users
  app.use( '/js', express.static( BASEPATH + '/frontend/js' ) );
  app.use( '/out', express.static( BASEPATH + '/out' ) ); // documentation path

  // Set client side libraries here (Make them available to the public based on settings.json)
  for(setting in SETTINGS.public) {
    app.use( SETTINGS.public[setting],  express.static(BASEPATH + SETTINGS.public[setting]) );
  }

}); 
```

然后，在控制器的某个地方，我像这样使用渲染：

```
function Blog(app, request, response){

  var fs      =  require('fs'), 
      Blog    =  require( app.get('models') + '/blog' ),
      model   =  new Blog(),
      scripts =  fs.readFileSync( VIEWS + '/m_scripts.mustache').toString()     ;

  model.List(function(data){

    response.render('layout', 
      {
        title     :  'My Blog',
        body      :  'Hello Mustache World',
        list      :  data.rows,
        cache     :  false,
        partials  : {
          m_scripts : partialStr
        }
      }
    );

  });

};

exports.list = Blog; 
```

m_scripts.mustache 有：

```
<script data-src="ergierjgoejoij"></script> 
```

布局模板渲染得很好，参数也很好地传递，部分 m_scripts 与 readFileSync().toString() 传递的文本一起传递，但 HTML 内容被编码并呈现无用。

我的问题是，有没有一种方法可以只放入 layout.mustache {{>m_scripts}} 并且 mustache 可以自动加载 m_scripts.mustache 而无需将其传递给 render()。如果没有，我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:28:34.160

事实证明，此时 consolidate.js 不支持 partials。有一个拉取请求来解决此问题，但尚未合并：[https ://github.com/simov/consolidate.js](https://github.com/simov/consolidate.js)

我最终通过以下方式使用了那个叉子：

1）npm卸载合并

2) npm install simov/consolidate.js

npm install simov/consolidate.js 将安装该分叉版本。然后我可以执行以下操作：

```
/**
 * @module Blog Controller
 */ 
function Blog(app, request, response){

  var Blog    =  require( app.get('models') + '/blog' ),
      model   =  new Blog();

  model.List(function(data){

    response.render('layout', 
      {
        title     :  'My Blog',
        body      :  'Hello Mustache World',
        list      :  data.rows,
        cache     :  false
        ,partials  : {
          m_scripts : './backend/views/m_scripts.html'
        }
      }
    );

  });

};

exports.list = Blog; 
```

这比我想象的要简单得多。您将路径传递给您的部分，然后您可以在 layout.html 上使用 {{>m_scripts}}

不过，不确定是否有办法做到这一点，默认情况下，在视图文件夹或其他东西上查找 {{>m_scripts}}。那会很整洁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T05:32:57.737

您可以使用[Hogan](http://twitter.github.com/hogan.js/)代替 Mustache。Hogan 将使用您设置`app.set('partials', partialsPathMap)`为路径图的部分渲染模板。

您可以在项目中使用此[gist:5149597](https://gist.github.com/mytharcher/5149597)中的代码。那么在渲染模板时你就不需要更多的部分配置了。

* * *

2014-06-23 编辑：

为了简单起见，我写了一个 npm 来处理这个问题。只是`npm install mustlayout`，存储库和文档在这里：[https ://github.com/mytharcher/mustlayout](https://github.com/mytharcher/mustlayout)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-08T12:05:03.720

我偶然发现了这个主题，因为我想知道 Consolidate 如何使用 partials 并发现 Consolidate 现在能够很好地使用 partials。

1.  创建一个 views 文件夹并创建一个名为 index.hbs 的文件
2.  在 HTML 的某处添加行 {{>menuPartial}}
3.  创建一个名为 partials 的视图子文件夹
4.  创建一个名为 menu.hbs 的文件

然后你可以使用这个 Node 脚本来完成部分工作：

```
const express = require('express');
const engines = require('consolidate');

const app = express();
app.engine('hbs', engines.handlebars);
app.set('views', './views');
app.set('view engine', 'hbs');

app.get('/', (request, response) => {
    response.render('index', { partials : { menuPartial : './partials/menu'} });
});

exports.app = functions.https.onRequest(app); 
```

# postgresql - 如何使用 3rd 方库将 .aar 文件部署为服务（在 WSO2 应用程序服务器中）

> ID：14005109
> 
> 赞同：1
> 
> 时间：2012-12-22T17:47:41.763
> 
> 标签：postgresql, wso2, sqlexception

我厌倦了将 .aar 文件部署为 WSO2 应用程序服务器中的服务。该服务需要处理postgress sql driver；所以我相应地更改了 ant 脚本以将 sql 驱动程序与 .aar 文件捆绑在一起。

然后我将我的 .aar 作为服务部署在 WSO2 应用程序服务器中，并且部署成功。但是在尝试触发此服务时，我总是收到此错误。

`java.sql.SQLException: No suitable driver found for jdbc:postgresql://localhost:5432/login`

尝试通过将同一个罐子也放入以下位置来触发服务，但没有运气。{application_server_home}\repository\components\plugins
{application_server_home}\repository\components\lib
{application_server_home}\lib

有谁知道如何解决这个问题？感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:24:34.870

如果你想在 WSO2 Server 中部署一个 JAR，你需要把它放在 {application_server_home}\repository\components\lib

如果它是一个 OSGi 包，你可以把它放在 {application_server_home}\repository\components\dropins

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-09T12:55:03.937

您可以将第三个库放到 aar 文件中的 resources/lib 中。所以他们将在 WSO2 的轴 2 服务中加载 aar。你也可以把它放在服务器上，它是如何在 Maninda 的回答中描述的

# video - 如何使用 FFMPEG 分割视频，以便每个块都以关键帧开头？

> ID：14005110
> 
> 赞同：53
> 
> 时间：2012-12-22T17:47:51.153
> 
> 标签：video, ffmpeg, split, keyframe

我们需要将大型实时 WMV 视频源拆分为大小相同的小块。我们制作了一个可以正常工作的脚本，除了一件事：视频块不以关键帧开头，因此在播放大多数视频块时，它们不会显示任何图像，直到最终来自原始视频的关键帧到达。

有没有办法告诉 ffmpeg 让输出视频从关键帧开始？

这是我们的命令行现在的样子：

```
ffmpeg.exe -i "C:\test.wmv" -ss 00:00:00 -t 00:00:05 -acodec copy -vcodec copy -async 1 -y  "0000.wmv"
ffmpeg.exe -i "C:\test.wmv" -ss 00:00:05 -t 00:00:05 -acodec copy -vcodec copy -async 1 -y  "0001.wmv" 
```

等等...

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2014-01-30T06:25:07.640

FFMPEG 的最新版本包括一个新选项“segment”，这正是我认为您需要的。

`ffmpeg -i INPUT.mp4 -acodec copy -f segment -vcodec copy -reset_timestamps 1 -map 0 OUTPUT%d.mp4`

这会产生一系列编号的输出文件，这些文件根据关键帧分成几段。在我自己的测试中，它运行良好，尽管我没有在超过几分钟的时间内使用它，而且只使用 MP4 格式。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2015-10-17T15:36:44.757

正如官方[FFMPEG Docs](http://trac.ffmpeg.org/wiki/Seeking)中所述，它对我来说更好地指定`-ss timestart` **before** `-i input_file.ext`，因为它将生成的视频的开头设置（或者我理解）到您指定的时间戳 **之前找到的最近的关键帧。**

将您的示例更改为：

```
ffmpeg.exe -ss 00:00:00 -i "C:\test.wmv" -t 00:00:05 -acodec copy -vcodec copy -async 1 -y  "0000.wmv" 
```

我已经测试了这种方法在文件上`.flv`的工作。`.mp4`

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-12-23T18:17:51.200

这是我可以开始工作的解决方案：

正如 av501 和 d33pika 所建议的，我使用 ffprobe 来查找关键帧的位置。因为 ffprobe 非常冗长，可能需要几秒钟甚至几分钟才能输出所有关键帧，并且无法从冗长的视频中确定我们想要的帧范围，所以我分为 5 个步骤：

1.  从原始文件中导出一个视频块，大约是所需块大小的两倍。

    ```
    ffmpeg -i source.wmv -ss 00:00:00 -t 00:00:06 -acodec copy -vcodec copy -async 1 -y  0001.wmv 
    ```

2.  使用 ffprobe 查找关键帧的位置。在所需的块大小之后选择最近的关键帧。

    ```
    ffprobe -show_frames -select_streams v -print_format json=c=1 0001.wmv 
    ```

3.  从 ffprobe 的输出中获取该`pkt_dts_time`关键帧之前的帧。

4.  ffmpeg 在步骤 1 的导出块上，指定相同的输入和输出文件，并指定`-ss 00:00:00`和`-t`[在步骤 3 中找到的值]。

    ```
    ffmpeg -i 0001.wmv -ss 00:00:00 -t 00:00:03.1350000 -acodec copy -vcodec copy -async 1 -y 0001.wmv 
    ```

5.  在步骤 1 重新开始，使用`-ss`[在步骤 3 中通过迭代找到的值的累积总和]。

以这种方式进行，我能够有一种有效且强大的方法来在关键帧处分割视频。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-07-16T22:58:31.587

使用较新的构建`ffmpeg`，可以通过使用`ffprobe`和`ffmpeg`段来实现这一点`muxer`。

1.  使用`ffprobe`和 awk 来识别尽可能接近所需块长度的关键帧。

```
ffprobe -show_frames -select_streams v:0 \
        -print_format csv [SOURCE_VIDEO] 2>&1 |
grep -n frame,video,1 |
awk 'BEGIN { FS="," } { print $1 " " $5 }' |
sed 's/:frame//g' |
awk 'BEGIN { previous=0; frameIdx=0; size=0; } 
{
  split($2,time,".");
  current=time[1];
  if (current-previous >= [DURATION_IN_SECONDS]){
    a[frameIdx]=$1; frameIdx++; size++; previous=current;
  }
}
END {
  str=a[0];
  for(i=1;i<size;i++) { str = str "," a[i]; } print str;
}' 
```

在哪里

*   **[SOURCE_VIDEO]** = 要分段的视频的路径
*   **[DURATION_IN_SECONDS]** = 所需的分段长度（以秒为单位）

输出是以逗号分隔的关键帧字符串。

2.  使用上面的关键帧输出作为`ffmpeg`.

```
ffmpeg -i [SOURCE_VIDEO] -codec copy -map 0 -f segment \
       -segment_frames [OUTPUT_OF_STEP_1] [SEGMENT_PREFIX] \
       _%03d.[SOURCE_VIDEO_EXTENSION] 
```

在哪里

*   **[SOURCE_VIDEO]** = 要分段的视频的路径
*   **[OUTPUT_OF_STEP_1]** = 逗号分隔的关键帧字符串
*   **[SEGMENT_PREFIX]** = 段输出的名称
*   **[SOURCE_VIDEO_EXTENSION]** = 源视频的扩展名（例如，mp4、mkv）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-12-23T14:11:51.423

用于`ffprobe -show_frames -pretty <stream>`识别关键帧。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-12-23T03:36:11.217

如果您愿意编写一些脚本并希望我以特定的时间间隔进行构图，那么一种方法是

1.  运行 ffprobe 并从输出中收集 I 帧的位置

    ffprobe -show_streams

2.  使用相同的脚本运行一系列 -ss -t 命令以获得所需的块。

然后你可以让你的脚本决定最小帧数[假设有两张相距 10 帧的 I 图片，你真的不想在那里分块]。

另一种方法是使用 gstreamer 的 multisfilesink 并将模式设置为关键帧 [但是这将在每个关键帧处分块，因此可能并不理想]

# c++ - 如何使用 C 修改文本数据文件中的值

> ID：14005112
> 
> 赞同：-2
> 
> 时间：2012-12-22T17:48:10.330
> 
> 标签：c++, c, algorithm, file, file-io

```
while(!feof(fp)) 
{
    fscanf(fp,"%d %s %d %d",&res[i].id,res[i].title,&res[i].price,&res[i].qty);
    i++;
}
while(j<i)
{
    printf("\nID:|%d|\tNAME:|%s|\tPRICE:|%d|\tQTY:|%d|",res[j].id,res[j].title,res[j].price,res[j].qty);
    j++;
} 
```

我有这段代码正在从文件中收集数据。现在我想知道是否从喜欢的用户那里获得输入，`res[id]`并且我想减少该特定 id 的数量如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T17:57:18.673

如果文件是二进制格式，则更容易做你想做的事。

文本格式和二进制格式有什么区别？如果文件以二进制格式写入，则 32 位整数将表示为文件中的 32 个连续位。例如，在文本格式中，数字将表示为数字序列`32`。

那么这种差异有什么大不了的呢？好吧，如果您将 32 替换为 1243，在二进制格式中，该数字仍将采用相同的 32 位，因此无需移动其他任何内容，您只需更改这 4 个字节。而在第二种情况下，您再添加 2 个数字，这将导致文件的所有后续内容移动两个字节。

为了根据需要移动所有内容，您需要读取文件的当前内容更改值，然后将内容写回。我的意思是您所做的更改之后的所有内容。

# objective-c - NSXMLParserDelegate 解析器：foundCDATA：返回流氓数据

> ID：14005113
> 
> 赞同：1
> 
> 时间：2012-12-22T17:48:12.133
> 
> 标签：objective-c, nsxmlparser, cdata

这真是莫名其妙。我有一个 NSXMLParser 读取包含大量 CDATA 部分的文档。但是我发现在程序的某些运行中，我通过这种方法接收到的数据是错误的。它并不总是发生，但当它发生时，通常在它应该实际阅读的部分之后，文档的其他一些随机部分的大约 100 个字符。

简化，我有这个：

```
- (void)parser:(NSXMLParser *)parser foundCDATA:(NSData *)CDATABlock {
    NSString *queryFragment = [NSString stringWithUTF8String:[CDATABlock bytes]];
    ....
} 
```

令人难以置信的是，在阅读同一文档的同一部分时，有时变量 queryFragment 得到的正是我所期望的，但有时它最后会出现随机垃圾。我曾经见过它读过 CDATA 块的末尾并获得原始 XML！

我已经调试了两天了。任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T17:55:25.853

这是错误的，因为您期望一个以 0 结尾的 utf-8 字符串`stringWithUTF8String:`

**虽然原始字节不是 0 终止**

你必须使用数据：

```
NSString *queryFragment = [[NSString alloc] initWithData:CDATABlock encoding:NSUTF8StringEncoding]; 
```

# c++ - 如果复合表达式中的多个操作数修改同一个对象，它是未定义的行为吗？

> ID：14005116
> 
> 赞同：27
> 
> 时间：2012-12-22T17:48:26.443
> 
> 标签：c++, c++11, undefined-behavior, language-lawyer, unspecified-behavior

我隐约记得在某处读过，如果复合表达式中的多个操作数修改同一个对象，则这是未定义的行为。

我相信下面的代码中显示了这个 UB 的一个示例，但是我已经在 g++、clang++ 和 Visual Studio 上编译，它们都打印出相同的值，并且似乎无法在不同的编译器中产生不可预测的值。

```
#include <iostream>

int a( int& lhs ) { lhs -= 4; return lhs; }
int b( int& lhs ) { lhs *= 7; return lhs; }
int c( int& lhs ) { lhs += 1; return lhs; }
int d( int& lhs ) { lhs += 2; return lhs; }
int e( int& lhs ) { lhs *= 3; return lhs; }

int main( int argc, char **argv )
{
    int i = 100;
    int j = ( b( i ) + c( i ) ) * e( i ) / a( i ) * d( i );

    std::cout << i << ", " << j << std::endl;

    return 0;
} 
```

这种行为是未定义的，还是我以某种方式想出了一个实际上未定义的假定 UB 的描述？

如果有人可以发布此 UB 的示例，甚至可以指出我在 C++ 标准中说它是 UB 的位置，我将不胜感激。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-22T17:52:19.903

不它不是。未定义的行为在这里是没有问题的（假设`int`算术没有溢出）：所有修改`i`都由序列点隔离（使用 C++03 术语）。每个函数的入口处都有一个序列点，出口处有一个序列点。

*此处未指定*行为。

*您的代码实际上遵循与通常用于说明未定义*和*未指定*行为之间区别的经典示例相同的模式。考虑这个

```
int i = 1;
int j = ++i * ++i; 
```

人们经常会声称在这个例子中“结果不依赖于评估的顺序，因此`j`必须始终为 6”。这是一个无效的声明，因为行为是未定义的。

然而在这个例子中

```
int inc(int &i) { return ++i; }

int i = 1;
int j = inc(i) * inc(i); 
```

该行为在形式上只是未指定的。即，未指定评估顺序。但是，由于表达式的结果根本不依赖于求值顺序，`j`所以保证总是以`6`. 这是一个示例，说明通常危险的未指定行为组合如何导致完美定义的结果。

在您的情况下，表达式的结果在很大程度上取决于评估顺序，这意味着结果将是不可预测的。然而，这里没有未定义的行为，即不允许该程序格式化您的硬盘驱动器。只允许在 中产生不可预知的结果`j`。

PS 同样，您的表达式的某些评估场景可能会导致有符号整数溢出（我没有全部分析过），这本身会触发未定义的行为。因此，仍有可能导致表达式中出现未定义行为的未指定行为。但这可能不是你的问题。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-22T17:58:35.603

不，它**不是**未定义的行为。

但它确实调用了**未指定的行为**。

这是因为未指定评估子表达式的顺序。

```
int j = ( b( i ) + c( i ) ) * e( i ) / a( i ) * d( i ); 
```

在上面的表达式中，子表达式：

```
b(i)
c(i)
e(i)
a(i)
d(i) 
```

可以按任何顺序进行评估。因为它们都有副作用，所以结果将取决于此顺序。

如果将表达式划分为所有子表达式（这是伪代码）
，那么您可以看到所需的任何排序。上述表达式不仅可以按任何顺序完成，而且可能与更高级别的子表达式交错（只有几个约束）。

```
tmp_1 = b(i)           // A
tmp_2 = c(i)           // B
tmp_3 = e(i)           // C
tmp_4 = a(i)           // D
tmp_5 = d(i)           // E

tmp_6 = tmp_1 + tmp_2  // F   (Happens after A and B)
tmp_7 = tmp_6 * tmp_3  // G   (Happens after C and F)
tmp_8 = tmp_7 / tmp_4  // H   (Happens after D and G)
tmp_9 = tmp_8 * tmp_5  // I   (Happens after E and H)

int j = tmp_9;         // J   (Happens after I) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-22T17:59:21.650

它不是未定义的行为，但它具有未指定的结果：唯一修改的对象是`i`通过传递给函数的引用。但是，对函数的调用引入了序列点（我没有 C++ 2011：它们在那里被称为不同的东西），即表达式中的多次更改不会导致未定义的行为的问题。

但是，未指定计算表达式的顺序。因此，如果评估顺序发生变化，您可能会得到不同的结果。这不是未定义的行为：结果是所有可能的评估顺序之一。未定义的行为意味着程序可以按照它想要的任何方式运行，包括为所讨论的表达式生成“预期”（程序员预期的）结果，同时破坏所有其他数据。

# validation - 如何在 Play 框架 2 中的字段构造函数之外打印验证错误

> ID：14005121
> 
> 赞同：7
> 
> 时间：2012-12-22T17:49:27.990
> 
> 标签：validation, scala, view, playframework, playframework-2.0

如何在 Play 框架 2 中的字段构造函数之外显示表单字段的验证错误？这是我尝试过的：

```
@eventForm.("name").error.message 
```

我得到这个错误：

```
value message is not a member of Option[play.api.data.FormError] 
```

我很困惑，因为在[api 文档](http://www.playframework.org/documentation/api/2.0/scala/play/api/data/FormError.html)中它说 message 是 FormError 的成员。这也适用于全局错误：

```
@eventForm.globalError.message 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-22T19:19:39.253

[您可以在此处查看 Form 的源代码来](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/scala/play/api/data/Form.scala)更好地掌握它

`Form`定义一个应用方法：

```
 def apply(key: String): Field = Field(
    this,
    key,
    constraints.get(key).getOrElse(Nil),
    formats.get(key),
    errors.collect { case e if e.key == key => e },
    data.get(key)) 
```

正如文档中所说，即使它不存在，它也会返回任何字段。并且 a`Field`有一个`errors`返回 a 的成员`Seq[FormError]`：

所以，你可以做这样的事情（对于`Seq[FormError]`）：

```
eventForm("name").errors.foreach { error =>
  <div>@error.message</div>
} 
```

或者（对于`Option[FormError]`）

```
eventForm("name").error.map { error =>
  <div>@error.message</div>
} 
```

或者，您可以使用`Form` `errors`：

```
 def errors(key: String): Seq[FormError] = errors.filter(_.key == key) 
```

并获取给定键的所有错误。像这样（对于`Seq[FormError]`）：

```
eventForm.errors("name").foreach { error =>
      <div>@error.message</div>
} 
```

或者（对于`Option[FormError]`）

```
eventForm.error("name").map { error =>
          <div>@error.message</div>
} 
```

如果您想了解更多详细信息，请查看源代码。它写得很好，评论也很好。

干杯!

**编辑：**

正如 biesior 评论的那样：要使用不同的语言显示人类可读的漂亮消息，您必须检查 play 是如何工作的 I18N 在[这里](http://www.playframework.org/documentation/2.0/ScalaI18N)

为了彻底，你可能不得不处理 I18N。让这一切正常工作一点也不难。阅读[文档](http://www.playframework.org/documentation/2.0/ScalaI18N)后，您可能仍会感到有些困惑。我会给你一点推动力。将文件添加`messages`到您的文件夹，您可以从[此处](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/resources/messages)`conf`复制其内容。这样您就可以更好地控制默认消息。现在，在您看来，您应该能够执行以下操作：

```
eventForm.errors("name").foreach { error =>
          <div>@Messages(error.message, error.args: _*)</div>
} 
```

例如，如果它会显示先前在文件`error.message`中定义的消息。定义您的错误消息可能处理的一些参数。例如，如果您正在处理，则 an可能是所需的最小值。在您的消息中，您只需要遵循模式，其中 n 是您的论点的顺序。`error.invalid``conf/messages``Invalid value``args``error.min``arg``{n}`

当然，您可以像这样定义自己的消息：

```
error.futureBirthday=Are you sure you're born in the future? Oowww hay, we got ourselves a time traveler! 
```

在您的控制器中，您可以像这样检查您的表单（只需一行代码即可向您展示它的感觉）

```
"year" -> number.verifying("error.furtureBirthday", number <= 2012) // 2012 being the current year 
```

如果您想使用语言，只需按照文档进行操作。

干杯，再一次！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T18:30:46.187

正如你自己所说，`message`是 的成员`FormError`，但你有一个`Option[FormError]`. 你可以使用

```
eventForm("name").error.map(_.message).getOrElse("") 
```

这会给你消息，如果有错误，`""`如果没有。

# drupal - 如何为挂起的站点调试 nginx/php-fpm？

> ID：14005129
> 
> 赞同：5
> 
> 时间：2012-12-22T17:50:51.433
> 
> 标签：drupal, nginx, php

我需要一些关于如何调试挂起的新服务器配置的提示。这个站点本身就是一个非常大的 Drupal 实例。与 APC 运行时每页加载 45+ MB PHP 内存一样大。

该站点本身确实在具有 nginx/php-fpm/apc 的另一台服务器上运行。我正在设置的新服务器有一个自定义的 PHP 5.3 版本。

nginx 配置为监听 80 端口，并将 fastcgi 请求传递给 127.0.0.1:9000。这行得通。

在 Drupal 根目录中，我有一个带有 phpinfo(); 的普通 PHP 文件。在里面。我可以直接加载这个 PHP 文件并确认 PHP 构建看起来不错。

没有 nginx 错误，但是 php-fpm 错误日志会在页面挂起时显示：

[22-Dec-2012 17:41:16] 警告：[pool www] child 19760，脚本'/var/www/mysite/public_html/index.php'（请求：“GET /index.php”）执行速度太慢（5.068781 秒），记录

除了这个错误，什么都没有。

因此，考虑到正常的 PHP 脚本加载正常，但加载 Drupal 应用程序（直接到 index.php，甚至不尝试干净的 url）挂起，我正在寻找有关调试方法的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T14:19:26.327

当您在 php-fpm 错误日志中看到该错误日志条目时，它实际上为缓慢的 php 进程提供了有用的堆栈跟踪。

在您的 php-fpm 配置文件（例如 /etc/php-fpm.d/www.conf）中，查看`request_slowlog_timeout`和`slowlog`设置。第一个定义了多少秒，直到一个请求被认为是“慢”，后者定义了堆栈跟踪将被写入的文件。

如果您查看 php-fpm 慢日志文件，您将更好地了解您的进程在方法调用堆栈中的确切位置。

# wpf - 从资源文件中获取字符串

> ID：14005132
> 
> 赞同：1
> 
> 时间：2012-12-22T17:51:30.357
> 
> 标签：wpf, vb.net, resourcedictionary

我看了这个样本：

[http://www.dotnetfunda.com/articles/article811-simplest-way-to-implement-multilingual-wpf-application.aspx](http://www.dotnetfunda.com/articles/article811-simplest-way-to-implement-multilingual-wpf-application.aspx)

但是，此示例显示了如何将字符串输入 GUI。

如何将字符串放入变量中。

我想显示一个 messagebox ，其中包含资源文件中的字符串。

在此先感谢家伙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:21:22.240

您可以使用[`ResourceDictionary.Item`](http://msdn.microsoft.com/en-us/library/ms601221%28v=vs.100%29.aspx)这是修改后的示例代码以使其执行您想要的操作。

```
Class MainWindow
    Dim dict As ResourceDictionary = New ResourceDictionary()
    Public Sub New()

        ' This call is required by the designer.
        InitializeComponent()
        SetLanguageDictionary()
        MessageBox.Show(dict.Item("greeting").ToString)
    End Sub

    Private Sub SetLanguageDictionary()

        Select Case (Thread.CurrentThread.CurrentCulture.ToString())
            Case "en-US"
                dict.Source = New Uri("..\Resources\StringResources.xaml", UriKind.Relative)
            Case "fr-CA"
                dict.Source = New Uri("..\Resources\StringResources.fr-CA.xaml", UriKind.Relative)
            Case Else
                dict.Source = New Uri("..\Resources\StringResources.xaml", UriKind.Relative)
        End Select
    End Sub
End Class 
```

和我正在使用的资源文件

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:system ="clr-namespace:System;assembly=mscorlib" >        
    <system:String x:Key="greeting">Hello World</system:String>
</ResourceDictionary> 
```

# python - 将 Str 转换为整数

> ID：14005134
> 
> 赞同：-2
> 
> 时间：2012-12-22T17:51:41.170
> 
> 标签：python, python-2.7

我收到以下错误：`TypeError: list indices must be integers, not str`在这行代码上：

```
 a= doc['coordinates']['coordinates'] 
```

这是从数据库读取记录，我想知道如何将其从 str 转换为整数？

谢谢

编辑：

`doc['coordinates']['coordinates']`从 mongoDB 返回坐标信息，这些是字段。它返回程序运行的前十次的相关信息，然后我收到此错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T18:05:09.207

看看这里发生了什么：

```
a= doc['coordinates']['coordinates'] 
```

首先`doc['coordinates']`是评估。这将返回一个坐标列表，比如说`[32.9,23.11]`。

现在您正尝试使用索引“坐标”在此列表中查找某些内容。

`a = [32.9,32.11]['coordinates']`

这是你的清单：`[32.9,32.11]`

列表只有数字索引，在这种情况下：`0`和`1`。

如果您尝试将坐标列表分配给变量，您可以这样做，`a = doc['coordinates']`或者如果您想要一个单独的坐标，`doc['coordinates'][0]`

# ios - 自定义 CIPixellate 过滤器的颜色选择

> ID：14005135
> 
> 赞同：0
> 
> 时间：2012-12-22T17:51:47.923
> 
> 标签：ios, core-image, cifilter

用户选择一个图像，该图像或多或少基于滑块输入进行像素化：

```
-(CIImage *)pixelPhoto:(CIImage *)img withAmount:(float)inputScale {

// Set up the pixellate filter where the inputScale is provided by the slider.
CIFilter *pixel = [CIFilter filterWithName:@"CIPixellate"];
[pixel setValue:img forKey:kCIInputImageKey];
[pixel setValue:[NSNumber numberWithDouble:inputScale] forKey:@"inputScale"];
CIImage *croppedImage = [pixel.outputImage imageByCroppingToRect:[beginImage extent]];
return croppedImage; } 
```

我理解它“通过将图像映射到颜色由替换像素定义的彩色方块来使图像变得块状”。（[CIFilter 类参考](https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/QuartzCoreFramework/Classes/CIFilter_Class/Reference/Reference.html/%22CIFilter%20Class%20Reference%22)）想象一个按数字绘制的场景；我想对 CIPixellate 进行更深入的研究，然后将每个正方形的颜色近似为大约 400 种颜色的较小数组。

这是我第一次尝试处理图像，或者真的是在玩任何类型的图形。我认为我没有太多运气找到我需要的信息，因为我没有足够的知识来拥有正确搜索的正确术语。

似乎我应该能够从像素化图像数据中提取正方形颜色的数组，然后遍历它们以应用算法以将它们近似为我希望限制它们的较短颜色列表。有什么建议么？

# c# - 面板背景油漆不起作用

> ID：14005141
> 
> 赞同：3
> 
> 时间：2012-12-22T17:52:49.217
> 
> 标签：c#, winforms, gradient, paint

我一直在用面板做我的winforms的边框。我想在底部面板中使用渐变，但我遇到了问题。

我使用的方法几乎与我在这里绘制表单背景的方法相同，但我在面板中得到了一个红十字。我不知道为什么会这样，它应该可以正常工作。

图片：![在此处输入图像描述](../Images/eda75c02416e3b831ae73b78012c9f46.png)

这是我要绘制的代码：

```
public void Colorear_Barra_abajo(object sender, PaintEventArgs e)
    {
        Rectangle r = this.ClientRectangle;

        if (r.Width > 0 && r.Height > 0)
        {
            Color c1 = Color.FromArgb(255, 54, 54, 54);
            Color c2 = Color.FromArgb(255, 98, 98, 98);

            LinearGradientBrush br = new LinearGradientBrush(r, c1, c2, 90, true);
            ColorBlend cb = new ColorBlend();
            cb.Positions = new[] { (float)0.357, (float)0.914 };
            cb.Colors = new[] { c1, c2 };
            br.InterpolationColors = cb;

            // paint
            e.Graphics.FillRectangle(br, r);
        }
    } 
```

这就是我所说的（panel_Borde_abajo 是面板）：

```
public Base_Form_Standard()
    {
        InitializeComponent();
        panel_Borde_abajo.Paint += new PaintEventHandler(Colorear_Barra_abajo);
    } 
```

我曾经使用这种方法来绘制除表单（menustrip fe）以外的其他控件并且它们工作得很好，但是这个特别的不工作。

例如，这确实可以正常工作，并且没有出现红十字：

```
public void Form_Background(object sender, PaintEventArgs e)
    {
        Rectangle r = this.ClientRectangle;

        if (r.Width > 0 && r.Height > 0)
        {
            Color c1 = Color.FromArgb(255, 252, 254, 255);
            Color c2 = Color.FromArgb(255, 247, 251, 253);
            Color c3 = Color.FromArgb(255, 228, 239, 247);
            Color c4 = Color.FromArgb(255, 217, 228, 238);
            Color c5 = Color.FromArgb(255, 177, 198, 215);

            LinearGradientBrush br = new LinearGradientBrush(r, c1, c5, 90, true);
            ColorBlend cb = new ColorBlend();
            cb.Positions = new[] { 0, (float)0.3, (float)0.486, (float)0.786, 1 };
            cb.Colors = new[] { c1, c2, c3, c4, c5 };
            br.InterpolationColors = cb;

            // paint
            e.Graphics.FillRectangle(br, r);
        }
    } 
```

如果有人可以帮助我，那就太好了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:03:19.623

看起来，您对**ColorBlend.Positions**属性使用了无效值，请尝试以下代码：

```
ColorBlend cb = new ColorBlend();
cb.Positions = new[] { 0.0f, 0.357f, 0.914f, 1.0f };
                       ^^^^                  ^^^^ 
```

根据[文档](http://msdn.microsoft.com/en-us/library/system.drawing.drawing2d.colorblend.positions.aspx)：

> 此数组中的元素由介于 0.0f 和 1.0f 之间的浮点值表示，并且数组的第一个元素必须是 0.0f，最后一个元素必须是 1.0f。

# objective-c - 从现有指针构建指针数组

> ID：14005151
> 
> 赞同：0
> 
> 时间：2012-12-22T17:54:14.780
> 
> 标签：objective-c, cocoa, pointers

我有一个类必须以相同的方式初始化一组相似的对象。

```
NSNumber *a = nil;
NSNumber *b = nil;
NSNumber *c = nil; 
```

a、b 和 c 是现有对象的成员变量。在我的代码中，我使用了一个更复杂的 NSObject 子类，但是这个例子使用 NSNumbers 更容易理解。

所有 3 个对象都必须以类似的方式初始化。因此，我想构建一个指针数组，我可以在这样的 for 循环中使用它：

```
NSPointerArray *objs = [NSPointerArray weakObjectsPointerArray];
[objs addPointer:&a];
[objs addPointer:&b];
[objs addPointer:&c]; 
```

运行上面的代码我得到以下错误：

```
error: address doesn't contain a section that points to a section in a object file 
```

如何构建一个可以用这样的循环探索的数组？

```
 for (id *o in objs) {
        *o = @2;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T18:01:08.030

只需将指针包装在“NSValue”对象中就可以了

```
id v1 = [NSValue valueWithPointer:p1];
id v2 = [NSValue valueWithPointer:p2];
id v3 = [NSValue valueWithPointer:p3];

id array = @[v1,v2,v3];

for(NSValue *value in array) {
    void *pointer = value.pointerValue;
    NSNumber *n = (__bridge NSNumber*)pointer;
} 
```

你想要做的演示：（NSNumbers 是不可变的）

```
#import <Foundation/Foundation.h>

int main(int argc, char *argv[]) {
@autoreleasepool {
    NSNumber *a;
    NSNumber *b;

    NSArray *os = @[ [NSValue valueWithPointer:&a],
                 [NSValue valueWithPointer:&b] ];

    for (NSValue *v in os) {
        void *pointer = [v pointerValue];
        NSNumber **n_ptr = (__bridge NSNumber**)pointer; 
        *n_ptr = @2.0;
    }

    NSLog(@"%@ %@", a,b);
}
} 
```

# distributed-computing - 非浏览器分布式应用程序中的数据传输（从/到服务器与从/到客户端）

> ID：14005160
> 
> 赞同：0
> 
> 时间：2012-12-22T17:55:44.193
> 
> 标签：distributed-computing, distributed-system

所以我们有命令行脚本（用 Python 编写），它位于客户机器上，每 24 小时后以 CSV 格式向我们发送数据。现在，我们实际上希望能够告诉客户随时向我们发送数据。几乎所有客户都在 MS Windows 机器上，要求我们可以在客户机器上安装很少的软件（大多数人甚至无法登录到客户机器，只有少数人可以）。

我实际上不确定如何最好地解决这个问题。可能是以下三种可能的方式（但正在寻找更好的方式）

1.  我们用 Python 制作一个守护进程并将其安装在客户机器上。守护进程与我们的服务器对话，我们发回配置信息。在该配置信息中，我们发回“睡眠持续时间”。所以守护进程向我们发送数据，然后在“睡眠持续时间”变量中定义的秒数进入睡眠状态。一旦限制结束，守护进程 ping 我们，我们再次发回配置信息。冲洗并重复。

2.  我们在客户机器上安装一个脚本，它每小时运行一次。最后，我们存储了客户应该多久向我们发送一次数据（24 小时、12 小时等），当脚本与我们交谈时，我们确定已经过去了多长时间以及该脚本是否应该发送给我们数据？如果是时候，那么我们告诉脚本向我们发送数据。

3.  我们安装了一个非常小的服务器端（Django 或 Flask）应用程序，它在客户机器上运行。每当我们需要数据时，我们都会向客户机器发送请求，我们的小型服务器端应用程序会为我们服务。为此，我们可能会要求我们的客户为我们保留一个端口（不确定有多少客户实际允许这样做）

我相信有更好的方法可能。您能告诉我以上哪种方法最合适吗？或者请让我知道是否有更好的方法。

我非常感谢所有见解，提前感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T04:46:01.543

选项 3 可能不起作用。大多数人的机器都在防火墙或路由器后面进行 NAT。在这种情况下，通常无法从公共 Internet 访问正在侦听请求进入的服务器。

如果他们有静态 IP 地址并且如果服务器可以从公共互联网访问，那么端口扫描器会检测到它并可能尝试做不受欢迎的事情。您真的不会有人侵入您的客户系统并对其造成严重破坏。如果可能，请避免使用此选项。

但是，在客户系统上安装服务器是安全的，只要它是登录到您的服务器并发送数据的服务器。

更好的解决方案是拥有一个在生成数据时不断向服务器提供数据的应用程序。是相对容易做相当于

```
 tail -f csv_file | send_data_home 
```

其中 send_data_home 是在客户系统上运行的程序。这样影响最小。csv 文件的创建不受影响。send_data_home 登录到您的服务器并在生成数据时发送数据。

# objective-c - GameKit/点对点网络

> ID：14005162
> 
> 赞同：3
> 
> 时间：2012-12-22T17:55:56.627
> 
> 标签：objective-c, ios, p2p, gamekit

对于我正在开发的 iOS 应用程序，我希望多部手机能够相互连接并能够在这些设备之间进行语音聊天。

当两个设备都在同一个网络上时，我让它工作。这很简单，我想做的大部分事情都是可能的。

但是现在我正在添加互联网支持，这很麻烦。我将首先尝试使用我设置的小型 Web 服务来解释我想如何匹配设备。

**服务器**

1.  使用会话模式 GKSessionModePeer 启动一个新的 GameKit 会话
2.  在我刚刚创建的会话中找到服务器的“Peer ID”
3.  在空闲端口上创建一个新的 CFSocketRef 并准备好接受连接
4.  将 Peer ID 和端口号发送到我的 web 服务，在外部服务器上运行。

**网络服务**

1.  Webservice 接收信息并将其与客户端的 ID 和 IP 地址一起存储在数据库中。
2.  将 ID 发送回服务器，服务器显示 ID

**客户**

1.  当用户选择使用 GameKit 的“在线”功能搜索游戏时，我会要求用户提供一个 ID（用户应输入服务器接收到的 ID）。
2.  客户端连接到提供 ID 的 Web 服务。Web 服务返回有关服务器会话（IP、PORT、Peer ID）的信息。
3.  用户尝试使用端口信息连接到 IP 地址，并与服务器建立输入和输出流。

这当然行不通，因为我的网络不允许传入连接和随机端口（来自外部网络）。

但现在的问题是，我该如何解决这个问题？我希望能够在两台设备之间建立对等连接，这些设备可以在同一个网络上，也可以在不同的网络上。

是否有框架、示例或任何显示如何执行此操作的内容？我希望能够将数据从设备发送到设备，而无需先将其发送到服务器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T18:50:24.517

我不知道有任何框架可以做到这一点。然而，我在跨多个网络的 p2p 网络方面确实有很多经验。

我学到的一条重要规则：在网络之间进行通信时，除非必要，**否则不要**创建直接连接。有太多因素可以（将？）导致问题，例如防火墙、NAT 等。

当然，您可以先尝试连接。您可以尝试连接到给定的 IP 地址*，但在大多数情况下它会失败。即使使用 UPnP 和 NAT-PMP，您也会发现在很多情况下（超过一半？）您根本无法接受传入连接。

因此，请确保有一个备份计划。制作一个网络层抽象，它不仅`listen()`可以连接到服务器，还可以连接到服务器。这样，当您无法连接到客户端的 IP* 时，您只需通过服务器建立一个连接，网络抽象会处理这一切。

*让我重申一下：不要只依赖传入的连接，总是有一个备份计划。*

* * *

* 我写 IP 是因为客户端可以有多个本地/远程 IP。连接时始终遍历所有这些 IP。示例：我的手机有 2 个本地 IPv4 地址（10.0.0.172 和 10.8.0.2）和一个 IPv6 地址（[2001:x:x::6]）。在这三个地址中，只有 IPv6 地址是可公开访问的，并且这两个 IPv4 地址位于不同的子网中，因此您是否可以连接到它们取决于另一个客户端所在的子网。始终尝试连接到两者，并在失败时回退到服务器代理连接。

** 我提到了 IPv6，是的。我们不要忘记，与 IPv4 不同，IPv6 不受 NAT 的限制，这意味着如果支持，您通过 IPv6 获得良好连接的可能性要比 IPv4 高得多。

# git - 将 git repo 分叉到另一个 repo 的目录中？

> ID：14005163
> 
> 赞同：0
> 
> 时间：2012-12-22T17:56:06.010
> 
> 标签：git, branching-and-merging, git-fork

> **可能重复：**
> [如何合并两个 git 存储库？](https://stackoverflow.com/questions/1425892/how-do-you-merge-two-git-repositories)

我有一个现有的 git 存储库 A。

对于另一个项目，项目 B，我的同事已经着手创建了一个新的 git 存储库。我们已经向这个存储库添加了一堆代码，因此它的结构自然与存储库 A 不同。

现在事实证明，我们希望在项目 B 中使用 A。理想情况下，我们希望将*A 分叉*到 B 的子目录下已经存在于 B 的存储库中，以免干扰已经存在的工作。自然地，我们希望保留 A 的历史（即不只是将一堆源代码复制过来）。

然后，我们计划根据项目 B 的特定需求对克隆/分叉的 A 进行广泛修改（这是一个一次性演示）。

做这个的最好方式是什么？可以使用[克隆](http://git-scm.com/docs/git-clone)来实现这一目标吗？或者也许我可以克隆 A，将东西移动到我想要它去的地方，然后尝试将它[合并](http://git-scm.com/docs/git-merge)到 B 中？您可以合并两个从未有过共享历史的存储库吗？

# android - Eclipse ADT Bundle：致命错误，无法启动

> ID：14005164
> 
> 赞同：4
> 
> 时间：2012-12-22T17:56:06.420
> 
> 标签：android, eclipse, sdk, java

我已经下载了 ADT Bundle for Linux (http://developer.android.com/sdk/index.html)，其中包括带有 ADT 插件的 android sdk + eclipse。

解压 .ZIP 文件后，双击 eclipse...我选择默认工作区，应用程序崩溃...创建了一个日志。这是它的内容：

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00007f9c7a8b52c0, pid=11965, tid=140310293825280
#
# JRE version: 7.0_09-b30
# Java VM: OpenJDK 64-Bit Server VM (23.2-b09 mixed mode linux-amd64 compressed oops)
# Problematic frame:
# C  [libgobject-2.0.so.0+0x192c0]  g_object_get_qdata+0x20
#
# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try "ulimit -c unlimited" before starting Java again
#
# If you would like to submit a bug report, please include
# instructions on how to reproduce the bug and visit:
#   https://bugs.launchpad.net/ubuntu/+source/openjdk-7/
# The crash happened outside the Java Virtual Machine in native code.
# See problematic frame for where to report the bug.
#

---------------  T H R E A D  ---------------

Current thread (0x00007f9c80009800):  JavaThread "main" [_thread_in_native, id=11966, stack(0x00007f9c8928c000,0x00007f9c8938d000)]

siginfo:si_signo=SIGSEGV: si_errno=0, si_code=1 (SEGV_MAPERR), si_addr=0x00000000000000c8

Registers:
RAX=0x00000000000000c8, RBX=0x00007f9c807ceae0, RCX=0x0000000000000358, RDX=0x00007f9c807ceae0
RSP=0x00007f9c89389af0, RBP=0x0000000000000358, RSI=0x0000000000000358, RDI=0x00007f9c807ceae0
R8 =0x00007f9c7d005400, R9 =0x00000000c0e8a400, R10=0x00007f9c7d011f64, R11=0x00007f9c880110b0
R12=0x0000000000000000, R13=0x00000000c0ef1120, R14=0x00007f9c89389ba8, R15=0x00007f9c80009800
RIP=0x00007f9c7a8b52c0, EFLAGS=0x0000000000010202, CSGSFS=0x0000000000000033, ERR=0x0000000000000004
  TRAPNO=0x000000000000000e

Top of Stack: (sp=0x00007f9c89389af0)
0x00007f9c89389af0:   00007f9c89389b40 00000000c0ef1120
0x00007f9c89389b00:   00007f9c89389b78 00007f9c4aec1ef6
0x00007f9c89389b10:   00000000d004cec0 00007f9c7d011f90
0x00007f9c89389b20:   0000000000000001 00000000f08ecaa8
0x00007f9c89389b30:   0000000000000001 00007f9c89389b38
0x00007f9c89389b40:   0000000000000000 00007f9c89389ba8
0x00007f9c89389b50:   00000000c0f82828 0000000000000000
0x00007f9c89389b60:   00000000c0ef1120 0000000000000000
0x00007f9c89389b70:   00007f9c89389b98 00007f9c89389bf0
0x00007f9c89389b80:   00007f9c7d006275 00000000f08eaa08
0x00007f9c89389b90:   00007f9c7d00edd7 0000000000000358
0x00007f9c89389ba0:   00007f9c807ceae0 0000000000000001
0x00007f9c89389bb0:   00007f9c89389bb0 00000000c0ef1229
0x00007f9c89389bc0:   00007f9c89389c28 00000000c0f82828
0x00007f9c89389bd0:   0000000000000000 00000000c0ef1268
0x00007f9c89389be0:   00007f9c89389b98 00007f9c89389c18
0x00007f9c89389bf0:   00007f9c89389c70 00007f9c7d006275
0x00007f9c89389c00:   0000000000000000 0000000000000000
0x00007f9c89389c10:   0000000000000000 0000000000000358
0x00007f9c89389c20:   00007f9c807ceae0 0000000000000000
0x00007f9c89389c30:   00007f9c89389c30 00000000c0e8a37b
0x00007f9c89389c40:   00007f9c89389ca0 00000000c0eb8d00
0x00007f9c89389c50:   0000000000000000 00000000c0e8a400
0x00007f9c89389c60:   00007f9c89389c18 00007f9c89389c90
0x00007f9c89389c70:   00007f9c89389ce8 00007f9c7d006333
0x00007f9c89389c80:   0000000000000000 0000000000000000
0x00007f9c89389c90:   00007f9c807ceae0 00000000f0cd2f58
0x00007f9c89389ca0:   00000000f0903fa8 00007f9c89389ca8
0x00007f9c89389cb0:   00000000c113bed5 00007f9c89389d08
0x00007f9c89389cc0:   00000000c11439c0 0000000000000000
0x00007f9c89389cd0:   00000000c113bf58 00007f9c89389c90
0x00007f9c89389ce0:   00007f9c89389d08 00007f9c89389d50 

Instructions: (pc=0x00007f9c7a8b52c0)
0x00007f9c7a8b52a0:   48 89 5c 24 f0 48 89 6c 24 f8 48 83 ec 18 48 85
0x00007f9c7a8b52b0:   ff 48 89 fb 74 21 48 8b 07 89 f5 48 85 c0 74 06
0x00007f9c7a8b52c0:   48 83 38 50 74 42 be 50 00 00 00 48 89 df e8 8d
0x00007f9c7a8b52d0:   83 01 00 85 c0 75 31 48 8d 15 92 1c 02 00 48 8d 

Register to memory mapping:

RAX=0x00000000000000c8 is an unknown value
RBX=0x00007f9c807ceae0 is an unknown value
RCX=0x0000000000000358 is an unknown value
RDX=0x00007f9c807ceae0 is an unknown value
RSP=0x00007f9c89389af0 is pointing into the stack for thread: 0x00007f9c80009800
RBP=0x0000000000000358 is an unknown value
RSI=0x0000000000000358 is an unknown value
RDI=0x00007f9c807ceae0 is an unknown value
R8 =0x00007f9c7d005400 is an unknown value
R9 =0x00000000c0e8a400 is an oop
{method} 
 - klass: {other class}
R10=0x00007f9c7d011f64 is an Interpreter codelet
method entry point (kind = native)  [0x00007f9c7d011d00, 0x00007f9c7d012540]  2112 bytes
R11=0x00007f9c880110b0: <offset 0x7810b0> in /usr/lib/jvm/java-7-openjdk-amd64/jre/lib/amd64/server/libjvm.so at 0x00007f9c87890000
R12=0x0000000000000000 is an unknown value
R13=0x00000000c0ef1120 is an oop
{method} 
 - klass: {other class}
R14=0x00007f9c89389ba8 is pointing into the stack for thread: 0x00007f9c80009800
R15=0x00007f9c80009800 is a thread

Stack: [0x00007f9c8928c000,0x00007f9c8938d000],  sp=0x00007f9c89389af0,  free space=1014k
Native frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)
C  [libgobject-2.0.so.0+0x192c0]  g_object_get_qdata+0x20

[error occurred during error reporting (printing native stack), id 0xb]

Java frames: (J=compiled Java code, j=interpreted, Vv=VM code)
j  org.eclipse.swt.internal.gtk.OS._g_object_get_qdata(JI)J+0
j  org.eclipse.swt.internal.gtk.OS.g_object_get_qdata(JI)J+9
j  org.eclipse.swt.widgets.Display.removeWidget(J)Lorg/eclipse/swt/widgets/Widget;+19
j  org.eclipse.swt.widgets.Combo.deregister()V+21
j  org.eclipse.swt.widgets.Widget.releaseWidget()V+1
j  org.eclipse.swt.widgets.Control.releaseWidget()V+1
j  org.eclipse.swt.widgets.Composite.releaseWidget()V+1
j  org.eclipse.swt.widgets.Combo.releaseWidget()V+1
j  org.eclipse.swt.widgets.Widget.release(Z)V+82
j  org.eclipse.swt.widgets.Control.release(Z)V+94
j  org.eclipse.swt.widgets.Composite.releaseChildren(Z)V+31
j  org.eclipse.swt.widgets.Widget.release(Z)V+38
j  org.eclipse.swt.widgets.Control.release(Z)V+94
j  org.eclipse.swt.widgets.Composite.releaseChildren(Z)V+31
j  org.eclipse.swt.widgets.Widget.release(Z)V+38
j  org.eclipse.swt.widgets.Control.release(Z)V+94
j  org.eclipse.swt.widgets.Composite.releaseChildren(Z)V+31
j  org.eclipse.swt.widgets.Widget.release(Z)V+38
j  org.eclipse.swt.widgets.Control.release(Z)V+94
j  org.eclipse.swt.widgets.Composite.releaseChildren(Z)V+31
j  org.eclipse.swt.widgets.Widget.release(Z)V+38
j  org.eclipse.swt.widgets.Control.release(Z)V+94
j  org.eclipse.swt.widgets.Composite.releaseChildren(Z)V+31
j  org.eclipse.swt.widgets.Canvas.releaseChildren(Z)V+42
j  org.eclipse.swt.widgets.Decorations.releaseChildren(Z)V+22
j  org.eclipse.swt.widgets.Shell.releaseChildren(Z)V+100
j  org.eclipse.swt.widgets.Widget.release(Z)V+38
j  org.eclipse.swt.widgets.Control.release(Z)V+94
j  org.eclipse.swt.widgets.Widget.dispose()V+23
j  org.eclipse.swt.widgets.Shell.dispose()V+20
j  org.eclipse.jface.window.Window.close()Z+65
j  org.eclipse.jface.dialogs.Dialog.close()Z+26
j  org.eclipse.jface.dialogs.Dialog.okPressed()V+6
j  org.eclipse.ui.internal.ide.ChooseWorkspaceDialog.okPressed()V+15
j  org.eclipse.jface.dialogs.Dialog.buttonPressed(I)V+5
j  org.eclipse.jface.dialogs.Dialog$2.widgetSelected(Lorg/eclipse/swt/events/SelectionEvent;)V+17
j  org.eclipse.swt.widgets.TypedListener.handleEvent(Lorg/eclipse/swt/widgets/Event;)V+1133
j  org.eclipse.swt.widgets.EventTable.sendEvent(Lorg/eclipse/swt/widgets/Event;)V+214
j  org.eclipse.swt.widgets.Widget.sendEvent(Lorg/eclipse/swt/widgets/Event;)V+25
j  org.eclipse.swt.widgets.Display.runDeferredEvents()Z+92
j  org.eclipse.swt.widgets.Display.readAndDispatch()Z+46
j  org.eclipse.jface.window.Window.runEventLoop(Lorg/eclipse/swt/widgets/Shell;)V+23
j  org.eclipse.jface.window.Window.open()I+49
j  org.eclipse.ui.internal.ide.ChooseWorkspaceDialog.prompt(Z)V+15
j  org.eclipse.ui.internal.ide.application.IDEApplication.promptForWorkspace(Lorg/eclipse/swt/widgets/Shell;Lorg/eclipse/ui/internal/ide/ChooseWorkspaceData;Z)Ljava/net/URL;+15
j  org.eclipse.ui.internal.ide.application.IDEApplication.checkInstanceLocation(Lorg/eclipse/swt/widgets/Shell;Ljava/util/Map;)Ljava/lang/Object;+183
j  org.eclipse.ui.internal.ide.application.IDEApplication.start(Lorg/eclipse/equinox/app/IApplicationContext;)Ljava/lang/Object;+50
j  org.eclipse.equinox.internal.app.EclipseAppHandle.run(Ljava/lang/Object;)Ljava/lang/Object;+135
j  org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(Ljava/lang/Object;)Ljava/lang/Object;+103
j  org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(Ljava/lang/Object;)Ljava/lang/Object;+29
j  org.eclipse.core.runtime.adaptor.EclipseStarter.run(Ljava/lang/Object;)Ljava/lang/Object;+149
j  org.eclipse.core.runtime.adaptor.EclipseStarter.run([Ljava/lang/String;Ljava/lang/Runnable;)Ljava/lang/Object;+183
v  ~StubRoutines::call_stub
j  sun.reflect.NativeMethodAccessorImpl.invoke0(Ljava/lang/reflect/Method;Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+0
j  sun.reflect.NativeMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+87
j  sun.reflect.DelegatingMethodAccessorImpl.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+6
j  java.lang.reflect.Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;+57
j  org.eclipse.equinox.launcher.Main.invokeFramework([Ljava/lang/String;[Ljava/net/URL;)V+211
j  org.eclipse.equinox.launcher.Main.basicRun([Ljava/lang/String;)V+126
j  org.eclipse.equinox.launcher.Main.run([Ljava/lang/String;)I+4
j  org.eclipse.equinox.launcher.Main.main([Ljava/lang/String;)V+10
v  ~StubRoutines::call_stub

---------------  P R O C E S S  ---------------

Java Threads: ( => current thread )
  0x0000000001206000 JavaThread "Worker-JM" [_thread_blocked, id=11995, stack(0x00007f9c4b490000,0x00007f9c4b591000)]
  0x0000000001098000 JavaThread "[Timer] - Main Queue Handler" daemon [_thread_blocked, id=11992, stack(0x00007f9c4b5d1000,0x00007f9c4b6d2000)]
  0x0000000001135800 JavaThread "Bundle File Closer" daemon [_thread_blocked, id=11988, stack(0x00007f9c4b7d3000,0x00007f9c4b8d4000)]
  0x00007f9c80540000 JavaThread "Start Level Event Dispatcher" daemon [_thread_blocked, id=11987, stack(0x00007f9c4b6d2000,0x00007f9c4b7d3000)]
  0x00007f9c80523000 JavaThread "Framework Event Dispatcher" daemon [_thread_blocked, id=11985, stack(0x00007f9c4b8d4000,0x00007f9c4b9d5000)]
  0x00007f9c80522000 JavaThread "State Saver" [_thread_blocked, id=11984, stack(0x00007f9c4b9d5000,0x00007f9c4bad6000)]
  0x00007f9c804ee800 JavaThread "Framework Active Thread" [_thread_blocked, id=11983, stack(0x00007f9c4bad6000,0x00007f9c4bbd7000)]
  0x00007f9c80192000 JavaThread "Service Thread" daemon [_thread_blocked, id=11976, stack(0x00007f9c7acfd000,0x00007f9c7adfe000)]
  0x00007f9c80190000 JavaThread "C2 CompilerThread1" daemon [_thread_blocked, id=11975, stack(0x00007f9c7adfe000,0x00007f9c7aeff000)]
  0x00007f9c8018d000 JavaThread "C2 CompilerThread0" daemon [_thread_blocked, id=11974, stack(0x00007f9c7aeff000,0x00007f9c7b000000)]
  0x00007f9c8018b000 JavaThread "Signal Dispatcher" daemon [_thread_blocked, id=11973, stack(0x00007f9c8407e000,0x00007f9c8417f000)]
  0x00007f9c80135000 JavaThread "Finalizer" daemon [_thread_blocked, id=11971, stack(0x00007f9c8444a000,0x00007f9c8454b000)]
  0x00007f9c80132800 JavaThread "Reference Handler" daemon [_thread_blocked, id=11970, stack(0x00007f9c8454b000,0x00007f9c8464c000)]
=>0x00007f9c80009800 JavaThread "main" [_thread_in_native, id=11966, stack(0x00007f9c8928c000,0x00007f9c8938d000)]

Other Threads:
  0x00007f9c8012a000 VMThread [stack: 0x00007f9c8464c000,0x00007f9c8474d000] [id=11969]
  0x00007f9c8019d000 WatcherThread [stack: 0x00007f9c7abfc000,0x00007f9c7acfd000] [id=11977]

VM state:not at safepoint (normal execution)

VM Mutex/Monitor currently owned by a thread: None

Heap
 PSYoungGen      total 88960K, used 13784K [0x00000000f0000000, 0x00000000f99a0000, 0x0000000100000000)
  eden space 78784K, 17% used [0x00000000f0000000,0x00000000f0d763c0,0x00000000f4cf0000)
  from space 10176K, 0% used [0x00000000f4cf0000,0x00000000f4cf0000,0x00000000f56e0000)
  to   space 15616K, 0% used [0x00000000f8a60000,0x00000000f8a60000,0x00000000f99a0000)
 ParOldGen       total 43072K, used 22279K [0x00000000d0000000, 0x00000000d2a10000, 0x00000000f0000000)
  object space 43072K, 51% used [0x00000000d0000000,0x00000000d15c1c68,0x00000000d2a10000)
 PSPermGen       total 23936K, used 17774K [0x00000000c0000000, 0x00000000c1760000, 0x00000000d0000000)
  object space 23936K, 74% used [0x00000000c0000000,0x00000000c115b818,0x00000000c1760000)

Card table byte_map: [0x00007f9c85def000,0x00007f9c85ff0000] byte_map_base: 0x00007f9c857ef000

Polling page: 0x00007f9c8928b000

Code Cache  [0x00007f9c7d000000, 0x00007f9c7d270000, 0x00007f9c80000000)
 total_blobs=856 nmethods=421 adapters=387 free_code_cache=47393Kb largest_free_block=48499776

Compilation events (10 events):
Event: 11,144 Thread 0x00007f9c80190000  418             java.io.FilterInputStream::read (8 bytes)
Event: 11,147 Thread 0x00007f9c80190000 nmethod 418 0x00007f9c7d1a5610 code [0x00007f9c7d1a5780, 0x00007f9c7d1a5a68]
Event: 11,510 Thread 0x00007f9c80190000  419             java.util.HashMap::put (124 bytes)
Event: 11,546 Thread 0x00007f9c8018d000  420             org.eclipse.osgi.framework.util.KeyedHashSet::add (194 bytes)
Event: 11,561 Thread 0x00007f9c80190000 nmethod 419 0x00007f9c7d1b8950 code [0x00007f9c7d1b8b80, 0x00007f9c7d1b95a0]
Event: 11,570 Thread 0x00007f9c8018d000 nmethod 420 0x00007f9c7d1b9e90 code [0x00007f9c7d1ba0c0, 0x00007f9c7d1ba810]
Event: 11,637 Thread 0x00007f9c80190000  421             java.lang.reflect.Field::getModifiers (5 bytes)
Event: 11,637 Thread 0x00007f9c80190000 nmethod 421 0x00007f9c7d1bc590 code [0x00007f9c7d1bc6c0, 0x00007f9c7d1bc718]
Event: 11,955 Thread 0x00007f9c80190000  422             java.util.zip.ZipFile::access$400 (5 bytes)
Event: 11,956 Thread 0x00007f9c80190000 nmethod 422 0x00007f9c7d1bbf90 code [0x00007f9c7d1bc0c0, 0x00007f9c7d1bc118]

GC Heap History (10 events):
Event: 4,106 GC heap before
{Heap before GC invocations=6 (full 0):
 PSYoungGen      total 22272K, used 22272K [0x00000000f0000000, 0x00000000f3220000, 0x0000000100000000)
  eden space 20608K, 100% used [0x00000000f0000000,0x00000000f1420000,0x00000000f1420000)
  from space 1664K, 100% used [0x00000000f1420000,0x00000000f15c0000,0x00000000f15c0000)
  to   space 5056K, 0% used [0x00000000f2d30000,0x00000000f2d30000,0x00000000f3220000)
 ParOldGen       total 27328K, used 9351K [0x00000000d0000000, 0x00000000d1ab0000, 0x00000000f0000000)
  object space 27328K, 34% used [0x00000000d0000000,0x00000000d0921eb0,0x00000000d1ab0000)
 PSPermGen       total 21248K, used 8767K [0x00000000c0000000, 0x00000000c14c0000, 0x00000000d0000000)
  object space 21248K, 41% used [0x00000000c0000000,0x00000000c088fcc0,0x00000000c14c0000)
Event: 4,120 GC heap after
Heap after GC invocations=6 (full 0):
 PSYoungGen      total 45440K, used 5050K [0x00000000f0000000, 0x00000000f33c0000, 0x0000000100000000)
  eden space 40384K, 0% used [0x00000000f0000000,0x00000000f0000000,0x00000000f2770000)
  from space 5056K, 99% used [0x00000000f2d30000,0x00000000f321e978,0x00000000f3220000)
  to   space 5888K, 0% used [0x00000000f2770000,0x00000000f2770000,0x00000000f2d30000)
 ParOldGen       total 27328K, used 9726K [0x00000000d0000000, 0x00000000d1ab0000, 0x00000000f0000000)
  object space 27328K, 35% used [0x00000000d0000000,0x00000000d097fbc8,0x00000000d1ab0000)
 PSPermGen       total 21248K, used 8767K [0x00000000c0000000, 0x00000000c14c0000, 0x00000000d0000000)
  object space 21248K, 41% used [0x00000000c0000000,0x00000000c088fcc0,0x00000000c14c0000)
}
Event: 4,809 GC heap before
{Heap before GC invocations=7 (full 0):
 PSYoungGen      total 45440K, used 45434K [0x00000000f0000000, 0x00000000f33c0000, 0x0000000100000000)
  eden space 40384K, 100% used [0x00000000f0000000,0x00000000f2770000,0x00000000f2770000)
  from space 5056K, 99% used [0x00000000f2d30000,0x00000000f321e978,0x00000000f3220000)
  to   space 5888K, 0% used [0x00000000f2770000,0x00000000f2770000,0x00000000f2d30000)
 ParOldGen       total 27328K, used 9726K [0x00000000d0000000, 0x00000000d1ab0000, 0x00000000f0000000)
  object space 27328K, 35% used [0x00000000d0000000,0x00000000d097fbc8,0x00000000d1ab0000)
 PSPermGen       total 21248K, used 8794K [0x00000000c0000000, 0x00000000c14c0000, 0x00000000d0000000)
  object space 21248K, 41% used [0x00000000c0000000,0x00000000c0896908,0x00000000c14c0000)
Event: 4,847 GC heap after
Heap after GC invocations=7 (full 0):
 PSYoungGen      total 46272K, used 5856K [0x00000000f0000000, 0x00000000f5ee0000, 0x0000000100000000)
  eden space 40384K, 0% used [0x00000000f0000000,0x00000000f0000000,0x00000000f2770000)
  from space 5888K, 99% used [0x00000000f2770000,0x00000000f2d283a0,0x00000000f2d30000)
  to   space 8192K, 0% used [0x00000000f56e0000,0x00000000f56e0000,0x00000000f5ee0000)
 ParOldGen       total 27328K, used 12830K [0x00000000d0000000, 0x00000000d1ab0000, 0x00000000f0000000)
  object space 27328K, 46% used [0x00000000d0000000,0x00000000d0c87860,0x00000000d1ab0000)
 PSPermGen       total 21248K, used 8794K [0x00000000c0000000, 0x00000000c14c0000, 0x00000000d0000000)
  object space 21248K, 41% used [0x00000000c0000000,0x00000000c0896908,0x00000000c14c0000)
}
Event: 5,333 GC heap before
{Heap before GC invocations=8 (full 0):
 PSYoungGen      total 46272K, used 46240K [0x00000000f0000000, 0x00000000f5ee0000, 0x0000000100000000)
  eden space 40384K, 100% used [0x00000000f0000000,0x00000000f2770000,0x00000000f2770000)
  from space 5888K, 99% used [0x00000000f2770000,0x00000000f2d283a0,0x00000000f2d30000)
  to   space 8192K, 0% used [0x00000000f56e0000,0x00000000f56e0000,0x00000000f5ee0000)
 ParOldGen       total 27328K, used 12830K [0x00000000d0000000, 0x00000000d1ab0000, 0x00000000f0000000)
  object space 27328K, 46% used [0x00000000d0000000,0x00000000d0c87860,0x00000000d1ab0000)
 PSPermGen       total 21248K, used 8812K [0x00000000c0000000, 0x00000000c14c0000, 0x00000000d0000000)
  object space 21248K, 41% used [0x00000000c0000000,0x00000000c089b148,0x00000000c14c0000)
Event: 5,369 GC heap after
Heap after GC invocations=8 (full 0):
 PSYoungGen      total 86976K, used 8186K [0x00000000f0000000, 0x00000000f62c0000, 0x0000000100000000)
  eden space 78784K, 0% used [0x00000000f0000000,0x00000000f0000000,0x00000000f4cf0000)
  from space 8192K, 99% used [0x00000000f56e0000,0x00000000f5ede838,0x00000000f5ee0000)
  to   space 10176K, 0% used [0x00000000f4cf0000,0x00000000f4cf0000,0x00000000f56e0000)
 ParOldGen       total 27328K, used 14754K [0x00000000d0000000, 0x00000000d1ab0000, 0x00000000f0000000)
  object space 27328K, 53% used [0x00000000d0000000,0x00000000d0e688e8,0x00000000d1ab0000)
 PSPermGen       total 21248K, used 8812K [0x00000000c0000000, 0x00000000c14c0000, 0x00000000d0000000)
  object space 21248K, 41% used [0x00000000c0000000,0x00000000c089b148,0x00000000c14c0000)
}
Event: 10,168 GC heap before
{Heap before GC invocations=9 (full 0):
 PSYoungGen      total 86976K, used 86970K [0x00000000f0000000, 0x00000000f62c0000, 0x0000000100000000)
  eden space 78784K, 100% used [0x00000000f0000000,0x00000000f4cf0000,0x00000000f4cf0000)
  from space 8192K, 99% used [0x00000000f56e0000,0x00000000f5ede838,0x00000000f5ee0000)
  to   space 10176K, 0% used [0x00000000f4cf0000,0x00000000f4cf0000,0x00000000f56e0000)
 ParOldGen       total 27328K, used 14754K [0x00000000d0000000, 0x00000000d1ab0000, 0x00000000f0000000)
  object space 27328K, 53% used [0x00000000d0000000,0x00000000d0e688e8,0x00000000d1ab0000)
 PSPermGen       total 21248K, used 11684K [0x00000000c0000000, 0x00000000c14c0000, 0x00000000d0000000)
  object space 21248K, 54% used [0x00000000c0000000,0x00000000c0b69368,0x00000000c14c0000)
Event: 10,237 GC heap after
Heap after GC invocations=9 (full 0):
 PSYoungGen      total 88960K, used 10162K [0x00000000f0000000, 0x00000000f99a0000, 0x0000000100000000)
  eden space 78784K, 0% used [0x00000000f0000000,0x00000000f0000000,0x00000000f4cf0000)
  from space 10176K, 99% used [0x00000000f4cf0000,0x00000000f56dcb78,0x00000000f56e0000)
  to   space 15616K, 0% used [0x00000000f8a60000,0x00000000f8a60000,0x00000000f99a0000)
 ParOldGen       total 27328K, used 24666K [0x00000000d0000000, 0x00000000d1ab0000, 0x00000000f0000000)
  object space 27328K, 90% used [0x00000000d0000000,0x00000000d1816b28,0x00000000d1ab0000)
 PSPermGen       total 21248K, used 11684K [0x00000000c0000000, 0x00000000c14c0000, 0x00000000d0000000)
  object space 21248K, 54% used [0x00000000c0000000,0x00000000c0b69368,0x00000000c14c0000)
}
Event: 10,237 GC heap before
{Heap before GC invocations=10 (full 1):
 PSYoungGen      total 88960K, used 10162K [0x00000000f0000000, 0x00000000f99a0000, 0x0000000100000000)
  eden space 78784K, 0% used [0x00000000f0000000,0x00000000f0000000,0x00000000f4cf0000)
  from space 10176K, 99% used [0x00000000f4cf0000,0x00000000f56dcb78,0x00000000f56e0000)
  to   space 15616K, 0% used [0x00000000f8a60000,0x00000000f8a60000,0x00000000f99a0000)
 ParOldGen       total 27328K, used 24666K [0x00000000d0000000, 0x00000000d1ab0000, 0x00000000f0000000)
  object space 27328K, 90% used [0x00000000d0000000,0x00000000d1816b28,0x00000000d1ab0000)
 PSPermGen       total 21248K, used 11684K [0x00000000c0000000, 0x00000000c14c0000, 0x00000000d0000000)
  object space 21248K, 54% used [0x00000000c0000000,0x00000000c0b69368,0x00000000c14c0000)
Event: 10,447 GC heap after
Heap after GC invocations=10 (full 1):
 PSYoungGen      total 88960K, used 0K [0x00000000f0000000, 0x00000000f99a0000, 0x0000000100000000)
  eden space 78784K, 0% used [0x00000000f0000000,0x00000000f0000000,0x00000000f4cf0000)
  from space 10176K, 0% used [0x00000000f4cf0000,0x00000000f4cf0000,0x00000000f56e0000)
  to   space 15616K, 0% used [0x00000000f8a60000,0x00000000f8a60000,0x00000000f99a0000)
 ParOldGen       total 43072K, used 22279K [0x00000000d0000000, 0x00000000d2a10000, 0x00000000f0000000)
  object space 43072K, 51% used [0x00000000d0000000,0x00000000d15c1c68,0x00000000d2a10000)
 PSPermGen       total 23936K, used 11680K [0x00000000c0000000, 0x00000000c1760000, 0x00000000d0000000)
  object space 23936K, 48% used [0x00000000c0000000,0x00000000c0b681f8,0x00000000c1760000)
} 
```

- 编辑：

嗯，我解决了！我试图打开一个现有的 eclipse-workspace 目录，其中包含一些旧项目（使用旧版本的 Eclipse 创建）。如果我选择一个新的工作区目录......程序启动正常！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T21:55:26.890

嗯，我解决了！我试图打开一个现有的 eclipse-workspace 目录，其中包含一些旧项目（使用旧版本的 Eclipse 创建）。如果我选择一个新的工作区目录......程序启动正常！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-27T13:48:29.367

我在搜索“Ubuntu/Linux Mint 从 13.04 升级到 13.10 后 libglib-2.0 中的 Java 崩溃”时进入了这个页面。

因此，如果您使用的是 Ubuntu 13.10 / Linux Mint 16 并且遇到与我完全相同的问题：

解决方案是：（在 KDE 中）

系统设置 > 应用程序外观 > GTK

设置 GTK2 主题：Raleigh 非常适合作为解决方法。

（对于 Unity 或其他桌面，您需要了解如何更改 GTK(2) 主题）

参考：

1.  [https://bugs.launchpad.net/ubuntu/+source/java-common/+bug/1241101](https://bugs.launchpad.net/ubuntu/+source/java-common/+bug/1241101)
2.  [https://bugs.kde.org/show_bug.cgi?id=324438](https://bugs.kde.org/show_bug.cgi?id=324438)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-24T04:42:14.430

将以下行添加到 eclipse.ini 的末尾

```
Dorg.eclipse.swt.browser.DefaultType=mozilla 
```

（这在**linux mint 17 mate**中对我有帮助）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T18:40:47.387

你不能尝试不同版本的 eclipse 或 java jdk。此问题与 android 或 adt 无关，而仅与堆栈跟踪指示的 eclipse 相关。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T23:46:28.480

尝试安装 JDK 1.6。ADT 下载页面将 JDK 6 列为系统要求。

# ruby - 在 ruby 的 OpenSSL 中使用私钥对数据进行签名

> ID：14005167
> 
> 赞同：2
> 
> 时间：2012-12-22T17:56:12.627
> 
> 标签：ruby, openssl, md5, rsa, digest

我有本机 openssl utilitiy 命令

```
openssl dgst -sign mtscert.pem -out KK_0.txt -md5 svertka.txt 
```

我需要将它“转换”为 ruby​​ 的 OpenSSL。当我这样做时

```
keypair = OpenSSL::PKey::RSA.new(File.open("somecert_with_keys.pem"), "somepass")
keypair.sign(OpenSSL::Digest::MD5.new, File.read("input.txt")) 
```

我得到了一些不同的代码。本机 openssl 给出：

```
,\xFC^\x99\xE1\xFB\xE7\r\u0014'2n\xB5A\x8C;\xFF<\x88=\x81\fX\x9F\x8E\xD8&^\u001DD\xBCӳ\xFE\xD4\xC6r6xn²\xE9D\xB3Y\xA0\xF6\xAB\rV\u0012w\u0014U\u000F\xA2\xFC\xA1[O\xAA\xCEB\xBD\x97C\xB5\xA3E\xE65\xADYq\xC5ӽ\r.\xA2\xE4\x86\u0016p\u000EݫSs\xA4\x9B\xD8\u0012\x80P^\xF4\x896\xC2\u001F\xC0\xBF>5\xEF[ʎ\xFD\xAE;p\x88|9a+\x89\xC1\u001Ej\xBA\xDD\xEB\u001D\xC8 
```

Ruby 的 OpenSSL：

```
,\xFC^\x99\xE1\xFB\xE7\r\x14'2n\xB5A\x8C;\xFF<\x88=\x81\fX\x9F\x8E\xD8&^\x1DD\xBC\xD3\xB3\xFE\xD4\xC6r6xn\xC2\xB2\xE9D\xB3Y\xA0\xF6\xAB\rV\x12w\x14U\x0F\xA2\xFC\xA1[O\xAA\xCEB\xBD\x97C\xB5\xA3E\xE65\xADYq\xC5\xD3\xBD\r.\xA2\xE4\x86\x16p\x0E\xDD\xABSs\xA4\x9B\xD8\x12\x80P^\xF4\x896\xC2\x1F\xC0\xBF>5\xEF[\xCA\x8E\xFD\xAE;p\x88|9a+\x89\xC1\x1Ej\xBA\xDD\xEB\x1D\xC8 
```

# java - Spring 3.2 测试，com.jajway 不包含在依赖项中

> ID：14005169
> 
> 赞同：29
> 
> 时间：2012-12-22T17:56:19.993
> 
> 标签：java, json, spring, spring-mvc

我的测试失败了，因为类未找到异常

`import com.jayway.jsonpath.InvalidPathException;`

之内

```
org.springframework.test.util.JsonPathExpectationsHelper; 
```

手动将 jayway 依赖项添加到我的 maven pom 中删除了这个错误，我的测试按预期运行。

我是否发现了一个错误，或者我是否需要添加一个不同的弹簧罐以及弹簧测试？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-08-15T10:17:50.027

就我而言

**拥有包含jsonPath**用法的测试代码：

```
 mockMvc.perform(get("/api/userDetails").header("Authorization", base64ForTestUser).accept(MediaType.APPLICATION_JSON))
                .andExpect(status().isOk())
                .andDo(print())
                .andExpect(jsonPath("userName").value("testUser")); 
```

我得到

```
java.lang.NoClassDefFoundError: com/jayway/jsonpath/InvalidPathException 
```

和

```
java.lang.ClassNotFoundException: com.jayway.jsonpath.InvalidPathException 
```

这个错误是直接缺少这样的依赖导致的

```
<dependency>
    <groupId>com.jayway.jsonpath</groupId>
    <artifactId>json-path-assert</artifactId>
    <version>0.8.1</version>
    <scope>test</scope>
</dependency> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-26T22:22:04.063

Spring 中不包含外部依赖项（例如，JUnit、Mockito、Easy Mock、JayWay 等），因此有必要将它们（Ant/Maven/Ivy 依赖项或 jar 文件）显式添加到项目的类路径中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-19T07:49:30.460

添加此依赖项有效

```
<dependency>
    <groupId>com.jayway.jsonpath</groupId>
    <artifactId>json-path-assert</artifactId>
    <version>0.8.1</version>
    <scope>test</scope>
</dependency> 
```

如果您想使用其他版本的 json-path-assert 可以查看以下存储库：

[http://mvnrepository.com/artifact/com.jayway.jsonpath/json-path](http://mvnrepository.com/artifact/com.jayway.jsonpath/json-path)

# external - 如何通过一些 JS 和 inc.php 文件使 TableSorter.js 在 demad 上使用表格

> ID：14005172
> 
> 赞同：1
> 
> 时间：2012-12-22T17:56:37.290
> 
> 标签：external, tablesorter, ondemand

我有一张要排序的表。问题是这个表是通过一些 JS (filter-data.js) 函数从外部文件 (inc.php) 加载的。更准确地说，我有一个带有**提交**按钮的 main.php 页面。当我单击它时，会触发一些 JS 代码，该代码调用 inc.php 文件以使用来自 MySQL 库的按需数据填充我的表，然后将它们（表 + 数据）都放回主页：

这是主页上的表格占位符。

```
<div id="tableData"></div> 
```

这是主页上的提交按钮：

```
 <input type="submit" onclick="genTable()" value="Populate users data"> 
```

这是我从 table.inc.php 页面得到的：

```
<table id="my-table">
   <thead>
       <tr>
           <th>Column 1</th>
           <th>Column 2</th>
       </tr>
    </thead>
   <tbody>
       <tr>
           <td>45</td>
           <td>34</td>
       </tr>
       <tr>
           <td>23</td>
           <td>17</td>
       </tr>
   </tbody>
</table> 
```

我不确定如何以及在哪里调用 TS 函数 - 它应该在 main.php 页面还是 table.inc.php 页面上？我几乎尝试了一切，但没有成功。

```
$("#my-table").tablesorter(); 
```

如果我跳过 JS，只需要 main.php 页面中的 table.inc.php 文件，它就可以正常工作。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T04:48:22.517

将 HTML 与脚本分开是更好的做法，为此，请将其添加到您的页面（或者更好的是，将脚本标签内的内容移动到外部文件中）：

```
<script>
// dom ready
$(function(){
    // do something when the submit button is clicked
    $('input[type=submit]').click(function(){
        // generate table
        genTable();
        // add sorting
        $("#my-table").tablesorter();
    });
});
</script> 
```

`onclick`然后通过删除属性修改您的提交按钮代码：

```
<input type="submit" value="Populate users data"> 
```

如果这不起作用，您可以`genTable();`与我们分享代码吗？

* * *

可悲的是，我即将出城一周……希望在那之前我能帮助你。

我建议做的是下载我[的tablesorter fork，](http://mottie.github.com/tablesorter/docs/)因为它有一个禁用客户端排序的选项：（`serverSideSorting`参考[）](http://mottie.github.com/tablesorter/docs/#serversidesorting)。

然后你可以绑定到tablesorter的`sortEnd`函数：

```
$("#my-table").on("sortEnd", function(e, table) {

    // get sorting information
    // [[0,0]] means sort the first column (zero-based index) in ascending direction
    // [[0,1]] means sort the first column in a descending direction
    // [[0,0], [2,0]] means sort the first and third columns, both in the ascending direction
    var sortList = table.config.sortList,
        // set the sort direction
        // this is why I need to know what is stored in the #sort element,
        // or how the server knows how to sort the data
        d = 'something';

    $('#sort').val( d );
    genTable();
    // initialize tablesorter again, because the entire table is being replaced
    // Otherwise if you only update the tbody, use:
    // $("#my-table").trigger('update');
    $("#my-table").tablesorter({
        theme : 'blue', // required theme option (tablesorter fork)
        serverSideSorting : true
    });

}); 
```

# jquery - 使用数据库中未知数量的项目创建三列布局

> ID：14005173
> 
> 赞同：0
> 
> 时间：2012-12-22T17:56:44.327
> 
> 标签：jquery, math, jquery-mobile

这应该很容易，它可能只涉及数学。我有一个三列布局，我想为从我的数据库返回的每个项目附加 jQuery 可折叠 div。

示例：如果我从数据库中返回 9 个项目：

```
column 1 = 1, 4, 7
column 2 = 2, 5, 8
column 3 = 3, 6, 9 
```

这是我到目前为止所拥有的：

```
if (centerCount == 1 || centerCount == 4 || centerCount == 7)
{   
// add to column 1                  
}
else if (centerCount == 2 || centerCount == 5 || centerCount == 8)
{
    // add to column 2
}
else if (centerCount == 3 || centerCount == 6 || centerCount == 9)
{
    // add to column 3
} 
```

以上假设物品数量为 9。如果我不知道会返回多少物品，我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T17:59:31.297

如果您有一些连续的 id（例如，我假设是 your `centerCount`），则可以将以下代码与模运算符一起使用`%`：

```
var col = centerCount % 3;

switch( col ) {
  case 0: // first column
    break;
  case 1: // second column
    break;
  case 2: // third column
    break;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:01:24.003

非常简单的模数就可以了

```
if (centerCount % 3 == 1) {
    // add to column 1
} 
else if (centerCount % 3 == 2) {
    // add to column 2
} 
else if (centerCount % 3 == 0) {
    // add to column 3
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T18:02:16.720

你可能想试试这个插件？**分柱器 jQuery 插件**

*   [http://welcome.totheinter.net/columnizer-jquery-plugin/](http://welcome.totheinter.net/columnizer-jquery-plugin/)
*   [https://github.com/adamwulf/Columnizer-jQuery-Plugin](https://github.com/adamwulf/Columnizer-jQuery-Plugin)

不确定它是否能满足您的需求？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T18:03:10.300

```
var col = centerCount % 3;

switch( col ) {
  case 1: // first column
    break;
  case 2: // second column
    break;
  case 0: // third column
    break;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T18:04:14.260

这就是我要做的，只需遍历每一列，然后遍历每一列的每个值。这似乎是您试图达到的最终解决方案。

```
<?
$columns = array(
    array(1,4,7,5,34,5,5),
    array(2,5,6,5,3,6,2),
    array(3,6,9,5,4,3,2)
)
?>
<table>
    <tr>
        <? for($x = 0; $x < count($columns); $x++) { ?>
        <td>
            <? foreach($columns[$x] as $column_value) { ?>
            <?= $column_value ?><br />
            <? } ?>
        </td>
        <? } ?>
    </tr>
</table> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-22T18:14:31.787

您可以`slice()`结合使用`wrapAll`将元素包装在列包装器中，因此您不需要创建任何数组，只需根据总项目进行计算

```
var $divs = $('#content div');
var totDiv = $divs.length,
    start = 0,
    itemsPerColumn = Math.ceil(totDiv / 3);

for (i = 0; i < 3; i++) {
    var end = start + itemsPerDiv;
    $divs.slice(start, end).wrapAll('<div class="column">')
    start = end
} 
```

演示：http: [//jsfiddle.net/WHNgP/](http://jsfiddle.net/WHNgP/)

或者，如果您从数据数组创建元素，则在创建 html 时使用本机 javascript 切片在数组上执行相同操作

API参考：http: [//api.jquery.com/slice/](http://api.jquery.com/slice/)

# c# - C# 中的 Html 敏捷包、Web 抓取和欺骗

> ID：14005175
> 
> 赞同：8
> 
> 时间：2012-12-22T17:56:52.120
> 
> 标签：c#, web-scraping, html-agility-pack, spoofing

有没有办法从 C# 代码中欺骗 Web 请求，使其看起来不像是机器人或垃圾邮件访问网站？我正在尝试抓取我的网站，但在拨打一定数量的电话后一直被阻止。我想表现得像一个真正的浏览器。我正在使用来自 HTML Agility Pack 的这段代码。

```
 var web = new HtmlWeb();
                web.UserAgent =
                    "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11"; 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-23T11:47:51.270

我做了太多的网络抓取，但这里有一些选项：我有一个我添加的默认标题列表，因为所有这些都是浏览器所期望的：

```
 wc.Headers[HttpRequestHeader.UserAgent] = "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11";
        wc.Headers[HttpRequestHeader.ContentType] = "application/x-www-form-urlencoded";
        wc.Headers[HttpRequestHeader.Accept] = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
        wc.Headers[HttpRequestHeader.AcceptEncoding] = "gzip,deflate,sdch";
        wc.Headers[HttpRequestHeader.AcceptLanguage] = "en-GB,en-US;q=0.8,en;q=0.6";
        wc.Headers[HttpRequestHeader.AcceptCharset] = "ISO-8859-1,utf-8;q=0.7,*;q=0.3"; 
```

（WC 是我的 WebClient）。

作为进一步的帮助 - 这是我保存 cookie 的 webclient 类 - 这也是一个巨大的帮助：

```
public class CookieWebClient : WebClient
{

    public CookieContainer m_container = new CookieContainer();
    public WebProxy proxy = null;

    protected override WebRequest GetWebRequest(Uri address)
    {
        try
        {
            ServicePointManager.DefaultConnectionLimit = 1000000;
            WebRequest request = base.GetWebRequest(address);
            request.Proxy = proxy;

            HttpWebRequest webRequest = request as HttpWebRequest;
            webRequest.Pipelined = true;
            webRequest.KeepAlive = true;
            if (webRequest != null)
            {
                webRequest.CookieContainer = m_container;
            }

            return request;
        }
        catch
        {
            return null;
        }
    }
} 
```

这是我通常的用途。使用您可能拥有的所有解析功能将静态副本添加到您的基站点类：

```
 protected static CookieWebClient wc = new CookieWebClient(); 
```

并这样称呼它：

```
public HtmlDocument Download(string url)
    {
        HtmlDocument hdoc = new HtmlDocument();
        HtmlNode.ElementsFlags.Remove("option");
        HtmlNode.ElementsFlags.Remove("select");
        Stream read = null;
        try
        {
            read = wc.OpenRead(url);
        }
        catch (ArgumentException)
        {
            read = wc.OpenRead(HttpHelper.HTTPEncode(url));
        }

        hdoc.Load(read, true);

        return hdoc;
    } 
```

您可能崩溃的另一个主要原因是连接被服务器关闭，因为您打开连接的时间过长。您可以通过在上面的下载部分周围添加 try catch 来证明这一点，如果失败，请重置 webclient 并再次尝试下载：

```
HtmlDocument d = new HtmlDocument();
                            try
                            {
                                d = this.Download(prp.PropertyUrl);
                            }
                            catch (WebException e)
                            {
                                this.Msg(Site.ErrorSeverity.Severe, "Error connecting to " + this.URL + " : Resubmitting..");
                                wc = new CookieWebClient();
                                d = this.Download(prp.PropertyUrl);
                            } 
```

这一直节省我的屁股，即使是服务器拒绝你，这可以重新调整很多。Cookie 被清除，您可以再次自由漫游。如果更糟真的变得更糟 - 添加代理支持并为每 50 次请求应用一个新代理。

这应该足以让您踢自己和任何其他网站。

评价我！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-22T18:15:03.913

使用常规浏览器和[提琴手](http://www.fiddler2.com/fiddler2/)（如果开发人员工具不符合标准）并查看请求和响应标头。

构建您的请求和请求标头以匹配浏览器发送的内容（您可以使用几个不同的浏览器来评估这是否会有所不同）。

关于“在一定数量的通话后被阻止” - 限制你的通话。每 x 秒只打一个电话。对网站表现得很好，它会对你表现得很好。

他们很有可能只是查看每秒来自您的 IP 地址的呼叫次数，如果超过阈值，IP 地址就会被阻止。

# android - ADB 在 Windows 7 下无法识别 Nexus 4

> ID：14005176
> 
> 赞同：166
> 
> 时间：2012-12-22T17:57:00.433
> 
> 标签：android, adb, nexus-4

我在 Windows 7 上运行，并且按照 Android 开发者网站上关于使用硬件设备的说明更新了所有驱动程序。但是，当我尝试运行应用程序时， [Eclipse仍然无法识别我的 Nexus 4。](http://en.wikipedia.org/wiki/Eclipse_%28software%29)弹出 Android 设备选择器，但在硬件部分没有显示任何内容。我也在我的手机上打开了调试、第三方应用程序和模拟位置。

这是因为手机还是新的吗？有没有办法让我的 Nexus 与 Eclipse 一起工作？

命令提示符下的[ADB](http://en.wikipedia.org/wiki/Android_Debug_Bridge)设备下没有显示任何内容。

* * *

## 回答 #1

> 赞同：266
> 
> 时间：2012-12-23T08:11:54.850

我的 Nexus 4 也有类似的情况。对我来说，这是 Windows 自动安装的驱动程序的问题。我按照*[[Q]计算机无法识别手机中的说明进行操作？- 发布#8](http://forum.xda-developers.com/showpost.php?p=34658752&postcount=8)*。我在 Windows 7 上有一些细微的差别。

对我来说我，

1.  从设备管理器卸载驱动
2.  让它自动安装通用的“MTP 设备驱动程序”
3.  右键单击新设备并选择“更新驱动程序”
4.  选择“从磁盘安装”并将其指向 [android-sdk-dir]\extras\google
5.  观看了“ADB”驱动程序安装。
6.  打开 Eclipse 以在我的 Nexus 4 上成功运行。

祝你好运！

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2013-01-10T12:08:59.570

只是为了确认之前的评论。除了启用开发人员选项，然后从新出现的开发人员选项中选择 USB 调试之外，我还需要将连接切换到相机 (PTP) 模式。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2013-01-30T09:11:32.990

要启用[USB](http://en.wikipedia.org/wiki/USB)调试，请转到设置，关于手机，然后在底部点击内部版本号七次。这将启用开发人员设置，您可以在其中启用 USB 调试。

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2013-04-11T22:45:41.593

在**Windows 7/8 32bit/64bit**上修复/安装 Android USB 驱动程序：

1.  将 Android 设备连接到计算机的 USB 端口。
2.  从桌面或 Windows 资源管理器中右键单击计算机，然后选择**管理**。
3.  在左侧窗格中选择设备。
4.  在右侧窗格中找到并展开其他设备。
5.  右键单击设备名称（**Nexus 7** / **Nexus 5** / **Nexus 4**）并选择**更新驱动程序软件**。这将启动硬件更新向导。
6.  选择**浏览我的计算机以查找驱动程序软件**，然后单击下一步。
7.  单击**浏览**并找到 USB 驱动程序文件夹。（Google USB 驱动程序位于`<sdk>\extras\google\usb_driver\`.）
8.  单击**下一步**安装驱动程序。

如果它仍然不起作用，请尝试从**MTP**更改为**PTP**。

![MTP -> PTP](../Images/bce9592115b8dd929f40c47d09f011ee.png)

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2013-01-12T04:30:05.843

I had the same problem, but I didn't want to change to PTP mode. This is how I fixed it with [MTP](https://en.wikipedia.org/wiki/Media_Transfer_Protocol) still enabled.

1.  Uninstalled Google USB Driver from Eclipse in the Android SDK Manager.
2.  Uninstalled the driver from Device Manager - click box for "delete driver from my computer"
3.  Unplugged and re-plugged my phone into the computer.
4.  Windows "improperly" installed drivers for the Nexus 4.
5.  The Nexus 4 was now showing up in *My Computer* like a drive.
6.  Reinstall Google USB Driver in SDK Manager.
7.  Update Nexus 4 driver in Device Manager.
8.  Everything works.

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2013-04-10T15:54:41.977

I had the same problem and none of the above worked, but the following solution worked for me:

On my Nexus 4:

*   Go to Settings

*   Choose Developer options (from the end of the list after pressing seven times on "About phone")

*   Check the "USB debugging" and press `OK`.

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-03-07T15:17:01.863

对于它的价值，就我而言，我只需将 USB 连接模式从媒体设备 (MTP) 更改为相机 (PTP) 即可解决问题。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-03-12T04:40:54.280

我不得不求助于 Windows 7 x64 的全新安装来解决这个问题。

我尝试了其他答案中的所有步骤/变体。没运气。设备管理器将显示我的“Android 设备/Android 复合 ADB 接口”与 Google 的 7.0.0.1 驱动程序一起正常工作，但没有任何东西可以让“adb 设备”显示我的 Nexus 4。

我使用[USBDeview](http://www.nirsoft.net/utils/usb_devices_view.html)卸载了所有连接到我的计算机的 USB 设备，除了我的键盘和鼠标。没运气。

我在设备管理器中启用了“显示隐藏设备”并卸载了与 USB 相关的所有内容。没运气。

我将 Google 的供应商 ID 添加到 adb_usb.ini。没运气。我删除了 adb_usb.ini 并运行了“android update adb”。没运气。

我把我的 Nexus 4 带到我哥哥的公寓，确认它没有故障。在他的机器上工作没有打嗝。

我很高兴全新安装成功，因为进一步的故障排除需要更换主板或购买 MacBook。

男孩，这迅速升级。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-08-20T13:08:21.160

将 USB 模式从 MTP 更改为 PTP 对我有用。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-11-04T21:29:15.350

只是为任何努力让他们的 Nexus 4 被 Eclipse - ADT 识别的人添加到上面的帖子中。过去，Eclipse ADT 可以毫无问题地识别该设备！

我遇到了与原始问题相同的问题。我尝试的每种方法都行不通...

*   切换“USB调试”选择
*   切换“允许第 3 方”应用选择
*   允许模拟位置
*   重新安装驱动程序
*   重新启动 adb.exe

**最后简单解决**

*   转到**设置 -> 存储 -> USB 计算机条件**（存储屏幕中的菜单选项）

*   从媒体设备 (MTP) 更改为**相机 (PTP)**

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-03-14T05:28:27.900

如何在**Windows 8**上执行此操作（我认为，它也适用于 Windows 7）

1.  打开 Android SDK Manager 并删除 Google Usb Driver
2.  打开控制面板 -> 设备管理器 -> 找到您的 Nexus -> 右键单击​​ -> 删除设备
3.  拔下您的设备
4.  打开 Android SDK Manager 并安装 Google Usb Driver
5.  连接您的设备
6.  打开控制面板 -> 设备管理器 -> 找到您的 Nexus -> 右键单击​​ -> 更新驱动程序 -> 手动更新 -> 打开 android-sdk 文件夹（启用子文件夹复选框） -> 从 Google Inc 安装驱动程序
7.  adb 杀死服务器；adb 启动服务器；adb devices 应该显示你的关系

不要忘记，Android 4.2 现在希望您从计算机提交 RSA 密钥，请查看您的设备屏幕。

*要在 Android 4.2 上启用开发者选项：打开设置 -> 关于手机 -> 点击内部版本号 7 次。*

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-01-20T14:24:50.197

我有一个类似的问题，以前的解决方案都不适合我，我自己解决了（经过几个小时的挫折），所以我要分享我的解决方案。

在为我的 Nexus 4 安装 Android Composite ADB Interface 后，我的计算机突然停止识别我插入的任何 Android 设备。我无法卸载驱动程序，因为设备管理器的任何尝试都失败了（设备管理器停止响应每次）。

所以我这样解决了：

1.  将 Windows 切换到安全模式
2.  卸载 Android Composite ADB 接口
3.  安装旧的 SAMSUNG Android ADB 接口
4.  将 Windows 切换到正常模式
5.  插入式 Android 设备（在我的例子中是 Nexus 4）
6.  Windows 将该设备识别为 Nexus 4
7.  从 android-sdk/extras/google 文件夹安装驱动程序
8.  一切都恢复正常！:)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-03-07T03:25:09.117

请按照 Google 的说明进行操作，*[OEM USB 驱动程序](http://developer.android.com/tools/extras/oem-usb.html)*。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-04-03T01:41:32.983

在 Windows 7 上，使用[Samsung Nexus S](https://en.wikipedia.org/wiki/Nexus_S)时，它在[设备管理器](http://en.wikipedia.org/wiki/Device_Manager)中什么也没有显示，该`adb devices`命令显示没有设备，但是当插入设备时说 USB 调试已打开并已连接。

我使用 Andrea 的 2 月 2 日的答案安装了 Google USB 驱动程序，该驱动程序创建了 /gooogle/usb_driver 目录，并使用了 RobertNovelo 的 3 月 7 日的答案转到链接并按照说明进行操作。该设备显示在“其他”下的设备管理器中。我右键单击它并选择更新驱动程序，现在它显示在“Android设备”下的设备管理器中，现在命令行`adb devices`列出了它。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-06-30T20:28:25.683

我有 2 台 Nexus 4 设备。一个连接到 ADB 没有任何问题，第二个在我使用`adb devices`命令时从未出现过。另一个症状是，当手机设置为媒体模式时，第二部手机在 Windows 资源管理器中没有显示为便携式设备。

在某个时候，我发现第二个 Nexus 的临时解决方案是将其切换到 PTP 模式。然后被`adb devices`命令找到了。奇怪的是，第一部手机一直都在两种模式下工作！

**最后我找到了这个解决方案**，现在我可以在两种模式下连接两部手机：

*   将手机的USB模式设置为MTP（媒体）
    使用PC设备管理器卸载设备->Android设备->Android ADB接口
    确保选中“删除驱动程序软件”框！

*   然后将手机的USB模式设置为PTP（相机）
    使用PC设备管理器卸载设备->便携式设备->Nexus 4

*   然后拔下 USB 并将其重新插入（确保其设置为 MTP（媒体），我发现该设备已在设备管理器中正确注册为 ->便携式设备 ->Nexus 4

解决方案位于：http: [//forum.xda-developers.com/showthread.php?p=34910298#post34910298](http://forum.xda-developers.com/showthread.php?p=34910298#post34910298)

如果您在将 Nexus 连接到 ADB 时遇到类似问题，那么我建议您先将其切换到 PTP 模式。如果您的问题在该步骤中消失，我建议您执行上面列出的其他步骤，因为 MTP 可能是您大部分时间想要将手机设置为的模式。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-03-08T14:44:28.377

如果所有答案都不起作用，那么以下说明可能会有所帮助。我遵循最佳答案并尝试从命令行使用[ADB加载程序以减少可能的并发症，但这没有用。](http://en.wikipedia.org/wiki/Android_Debug_Bridge)

一旦启用 PTP 模式，ADB devices 命令会找到我的 Nexus 4，但我无法推送到它。我必须使用[Eclipse](http://en.wikipedia.org/wiki/Eclipse_%28software%29)并且为了显示对话框以接受下面描述的 RSA 密钥。

> 注意：当您将运行 Android 4.2.2 或更高版本的设备连接到您的计算机时，系统会显示一个对话框，询问是否接受 RSA 密钥。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-04-12T12:39:37.743

仅当您使用 Windows 时才需要安装 USB 驱动程序（如果您使用的是 MAC/Linux，很可能无需安装任何驱动程序就可以正常工作）

在以下链接中，他们描述了如何做到这一点：

[http://developer.android.com/tools/extras/oem-usb.html](http://developer.android.com/tools/extras/oem-usb.html)

简而言之：

1.  将 Android 设备连接到计算机的 USB 端口。
2.  从桌面或 Windows 资源管理器中右键单击计算机，然后选择管理。
3.  在左侧窗格中选择设备。
4.  在右侧窗格中找到并展开其他设备。
5.  右键单击设备名称（例如 Nexus S）并选择更新驱动程序软件。这将启动 6\. 硬件更新向导。
6.  选择浏览我的计算机以查找驱动程序软件，然后单击下一步。单击浏览并找到 USB 驱动程序文件夹。（Google USB 驱动程序位于 \extras\google\usb_driver。）
7.  单击下一步安装驱动程序。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-06-18T14:42:43.487

我的症状是没有安装复合设备（这包含所有实际的 USB 设备，如 ADB 接口、相机等）。这有一个硬件ID：

```
USB\VID_18D1&PID_4EE6&REV_0228
USB\VID_18D1&PID_4EE6 
```

复合设备的子设备后面会有 &MI_##。如果你看到这些，那么这不是同一个问题。

我通过从 Windows 7 的虚拟机将 usb.inf 处理为 %windir%\inf 解决了这个问题。之后检测到硬件并正常安装。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-03-20T03:15:19.510

我有办法解决你的问题：

1.  下载 Nexus Root Toolkit v2.0.4：[http ://www.wugfresh.com/nrt/](http://www.wugfresh.com/nrt/)
2.  安装并选择您的潜水员，然后选择 Google API。例如，我选择了 Nexus 4 并选择了 Google API 4.4.4
3.  单击“完整驱动程序安装指南...”，然后单击步骤 3 选项卡。选择 Google 驱动程序。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2013-09-27T01:40:03.250

对我来说，它是 Nexus 4 和 Windows 7。我重新安装了驱动程序，改为 PTP - 基本上经历了一切。

单击 Eclipse 中显示 MainActivity.java 而不是 activity_main.xml 的选项卡为我修复了它。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-03-16T00:11:36.773

如果您在**Windows 8.1**下安装 ADB 驱动程序有问题，请尝试以下解决方案：[ADB Driver and Windows 8.1](https://stackoverflow.com/questions/21972658/adb-driver-and-windows-8-1)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-02-02T07:23:27.560

我的 Windows 7 安装根本找不到驱动程序。xda-forums 帖子有正确的文件夹来告诉 Windows 驱动程序在哪里—— `{SDK directory}/extras/google/usb-driver`。

如果您没有 extras/Google 文件夹 + Tim Bellis，请转到 IDE 中的 SDK 管理器并在 Extras 类别中查找 Google USB 驱动程序，然后安装它。我无法告诉您如何在 Eclipse 中执行此操作，但如果您有[IntelliJ IDEA](http://en.wikipedia.org/wiki/IntelliJ_IDEA)，它位于列表底部附近，选中它并单击“安装包”。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-02-25T12:14:59.083

[（Windows 7）我的解决方案是在设备管理器](http://en.wikipedia.org/wiki/Device_Manager)中找到该设备，卸载现有驱动程序并使用包含子目录选项从您的用户帐户中的 android 文件夹中安装一个新驱动程序。

一切顺利。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-11-30T12:14:48.530

这是我的司机失踪问题。我启用了 USB 调试，尝试更换 USB 电缆，尝试重新安装 Google USB 驱动程序，但没有任何帮助。

然后最终我按照[这里](http://www.android.gs/how-to-install-google-nexus-4-usb-drivers-for-adb-sideload-support/)的建议下载了设备驱动程序。

要确定您是否有设备驱动程序问题，请访问：

1.  电脑->右键
2.  管理
3.  装置经理

并查看您的 Nexus 是否显示为“ **Android 设备**”或“**其他**”中的设备。

如果它显示在“**其他**”中，您的问题应该通过下载并解压缩[然后](http://www.mediafire.com/download/sc1ljof749qlayq/usb_driver.rar)执行以下步骤来解决：

1.  按照上面提到的三个步骤，在设备管理器中找到它后，右键单击您的设备。
2.  说**更新驱动软件**。
3.  说**浏览我的电脑以获取驱动程序软件**
4.  将其定位到您从上述链接下载驱动程序的位置。

最后，您的设备将显示如下：

![电脑管理截图](../Images/ee7e5d50acfe7dd8b34bac38182513a1.png)

执行此操作后，您的设备上会立即出现一个弹出窗口，要求您允许调试。一旦你接受，你就准备好了！

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-04-11T21:51:24.677

你们中的一些人可能已经遇到过这个问题。如果您没有找到 USB 驱动程序（像我一样，我下载了 Eclipse 和 Android SDK 的捆绑包），请转到`<sdk>/SDK Manager`. 打开它并从选项中选择*USB 驱动程序*进行安装，您就准备好了。我也必须做 PTP 模式。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-10-13T00:47:48.240

我的解决方案非常愚蠢。我已经尝试了上述所有解决方案并浪费了很多时间。然后我在浏览开发人员选项时找到了解决方案。我没有勾选“USB调试”选项。愚蠢的我认为打开开发人员选项意味着打开 USB 调试，但我错了。

# ruby-on-rails - 在两个控制器之间传递变量

> ID：14005178
> 
> 赞同：0
> 
> 时间：2012-12-22T17:57:09.650
> 
> 标签：ruby-on-rails

我有两个控制器：任务，任务人员。

我有意见/任务/index.html.erb：

```
<table>
    <% @tasks.group_by(&:name).each do |name, tasks| %>
    <tr>
      <td><%= name %></td>
      <td><%= tasks.size %></td>
      <td><%= tasks.select{ |task| task.done != true }.size %></td>
    </tr>
    <% end %>
</table> 
```

**我想在views/tasks/index.html中创建一个到views/tasksperson/index.html.erb的链接。我还想将名称发送到Tasksperson_controller中的“索引”中。我试图通过获取参数来做到这一点[： name] 但我认为这是错误的**

**也许，我需要做类似的事情：**

```
<td><%= link_to 'Show Tasks', tasksperson_path(name) %></td> 
```

这是我的任务person_controller：

```
class TaskspersonController < ApplicationController
    def index
       @tasks = Task.where(:name => params[:name]) respond_to do |format|
          format.html # index.html.erb
          format.json { render json: @tasks }
       end
    end
end 
```

和意见/tasksperson/index.html.erb：

```
<table>
  <tr>
    <th>Name</th>
    <th>num of tasks</th>
    <th>num tasks left</th>
    <th>test</th>
  </tr>

  <% @tasks.each do |f| %>
  <tr>
    <td><%= f.name %></td>
    <td><%= f.task %></td>
    <td><%= f.done %></td>
  </tr>
  <% end %>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:15:47.683

根据您的评论“ *......所以任务有很多任务人员*”我认为您想要一个类似于下面的数据模型

```
class Task < ActiveRecord::Base
  has_many :assigned_tasks
  has_many :people, :through => :assigned_tasks
end

# maybe this is just the User class?
class Person < ActiveRecord::Base 
  has_many :assigned_tasks
  has_many :tasks, :through => :assigned_tasks
end

# was TaskPerson
class AssignedTask < ActiveRecord::Base
  belongs_to :task
  belongs_to :person
end 
```

有关“has_many :through Association”的信息，请参阅[http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association](http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association)

```
task = Task.create(:title => "Go up the hill")
jack = Person.find(00000)
jill = Person.find(00000)

task.people << jack
task.people << jill

task.assigned_tasks.each do |join|
  puts join.created_at
  puts join.person.name
  # 0 - jack
  # 1 - jill
end

task.people.each do |person|
  puts person.name
end 
```

我不确定您要在视图中显示什么，看起来您正在按任务/索引中的任务名称属性进行分组，那是人名吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:07:33.093

您需要将`:name`作为参数添加到定义路由的规则中`TaskspersonController#index`，`routes.rb` 因此它将是这样的：

`match 'tasksperson/index/:name' => 'tasksperson#index', as: :tasksperson_path`

# php - move_uploaded_file() 更改中文文件 joomla 的名称

> ID：14005193
> 
> 赞同：1
> 
> 时间：2012-12-22T17:59:16.497
> 
> 标签：php, joomla

上传带有纯**中文**字体`move_uploaded_file()`功能的文件时，将名称更改为一些符号，同时存储到图像文件夹中。我正在使用 joomla 网站。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T18:33:14.550

本地文件必须使用系统编码保存：简而言之，如果您的系统使用中文编码，则必须将文件名转换为该编码

如果您的 php 文件是 utf-8，并且您使用的是 windows，则必须使用，例如

```
$destfilename = iconv("UTF-8", "GBK", "您好.txt");

move_uploaded_file($temp, $destfilename); 
```

并且您必须对 mkdir、rename 等函数使用相同的处理方式

# arrays - VB.NET CreateInstance 结构体

> ID：14005195
> 
> 赞同：1
> 
> 时间：2012-12-22T17:59:21.277
> 
> 标签：arrays, vb.net, structure

我写了以下代码：

```
Public Class Form1

Private Structure udtThing
    Dim SomeText As String
    Dim SomeElements() As String
    Public Shared Function CreateInstance() As udtThing
        Dim result As New udtThing
        result.SomeText = String.Empty
        ReDim result.SomeElements(2)
        result.SomeElements(0) = String.Empty
        result.SomeElements(1) = String.Empty
        result.SomeElements(2) = String.Empty
        Return result
    End Function
End Structure

Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    Dim nThings() As udtThing
    nThings = Array.CreateInstance(GetType(udtThing), 10)

End Sub
End Class 
```

我部分工作，nThings 变成了 11 个 udtThings 的数组。但是 .SomeElements 并没有重新调整为 3 个 String.Empty 字符串，而是“Nothing”。

有人看到我哪里出错了吗？

非常感谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:17:46.510

按照设计，需要 Redim。Array.CreateInstance() 不会执行该操作，它无法猜测所需的大小。你必须帮助：

```
Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Dim nThings(10) As udtThing
    For ix As Integer = 0 To UBound(nThings)
        nThings(ix) = udtThing.CreateInstance()
    Next
End Sub 
```

# visual-c++ - 更改 MessageBox 中的按钮文本

> ID：14005197
> 
> 赞同：1
> 
> 时间：2012-12-22T17:59:24.883
> 
> 标签：visual-c++, mfc, messagebox

当我使用带有 MB_OK 的 AfxMessageBox 时，消息框显示为“ok”作为按钮文本，当我使用 MB_YESNO 时，它显示为“Oui”表示 Ok，“Annuler”表示否（我在法语 Windows 下运行）。

我想知道是否可以在不创建自定义按钮的情况下更改 MessageBow 的文本按钮？或者当我使用 MB_YESNO 时是否可以隐藏取消按钮？

# android - Mifare DESFire卡上的PICC格式化没用？

> ID：14005198
> 
> 赞同：1
> 
> 时间：2012-12-22T17:59:27.187
> 
> 标签：android, nfc, mifare

我正在使用 IsoDep 和 DESFire 本机命令在 android 上处理 Mifare DESFire 4k 标签。当我向卡发送 PICC 格式命令时，我得到一个 TagLostException，之后使用 Android 上的任何软件都无法检测到该标签。这是预期的行为吗？有没有办法让标签表现得像格式化之前一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:53:58.183

在发送格式命令之前尝试增加收发超时，使用[`setTimeout()`](http://developer.android.com/reference/android/nfc/tech/IsoDep.html#setTimeout%28int%29), 到某个较大的值（几秒钟）。格式化 DESFire 标记需要一些时间。我对 TagLostException 有同样的经历，但从未破坏过标签......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T11:47:51.320

我更同意 NFC 的家伙。在格式化 PICC 时破坏标签是非常罕见的，但由于 Android 代码（已知错误/问题）使用标签操作时收到 TagLostException 的情况并不少见，有时标签会停止响应，但它应该在一段时间后恢复。

# magento - magento 为可配置产品的每个数量选择属性

> ID：14005203
> 
> 赞同：1
> 
> 时间：2012-12-22T17:59:48.003
> 
> 标签：magento, attributes, magento-1.7, configurable-product

我需要在 Magento 1.7 上让用户为可配置产品中的每个数量选择属性。

可能吗？

圣诞快乐 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T06:38:58.223

# jquery - 附加元素在 mousemove 上移动不顺畅？

> ID：14005204
> 
> 赞同：0
> 
> 时间：2012-12-22T18:00:04.190
> 
> 标签：jquery, append, mouseevent, onmousemove

当你点击一个按钮时，我想制作一个加载提示。下面是我的尝试，

```
this.mouse_loader_click = function(){   

    /* CONFIG */        
    xOffset = 10;
    yOffset = 20;       

    $(".mouse-loader").click(function(e){

        /* append the popup */
        $(document.body).append("<p class='loading-tip'>Loading</p>");
        $(".loading-tip")
            .css("top",(e.pageY - xOffset) + "px")
            .css("left",(e.pageX + yOffset) + "px")
            .fadeIn("fast");

        $(document.body).mousemove(function(e){
            $(".loading-tip")
                .css("top",(e.pageY - xOffset) + "px")
                .css("left",(e.pageX + yOffset) + "px");
        });

        return false;

    });

}; 
```

但它的作用很有趣，因为`loading element`- **“.loading-tip”**不会随着鼠标**平滑**移动。它似乎一直很生涩。

但是如果它在一个盒子里，它可以正常工作并且可以用鼠标平滑移动。

请看[这里](http://jsfiddle.net/9x4KZ/)。

我错过了什么？我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:06:34.543

尝试动画而不是设置静态位置，以创建更平滑的过渡。

```
$(document.body).mousemove(function(e){
    $(".loading-tip").stop().animate({
        top     : (e.pageY - xOffset) + "px",
        left    : (e.pageX + yOffset) + "px"
    }, 100); // 100 is the desired time in milliseconds from point A to point B, play with it if it's not smooth enough for you :)
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:08:38.647

问题似乎只是因为`document.body`不是浏览器窗口高度的 100%。因此，当您低于身体底部时，它不再触发`mousemove`事件。

将这两行添加到您的 jsfiddle 并再次尝试：

```
html { height:100%; }
body { height:100%; } 
```

# tridion - 我应该使用 tcdl、Tridion 标签还是 RenderComponentPresentation？

> ID：14005206
> 
> 赞同：5
> 
> 时间：2012-12-22T18:00:15.583
> 
> 标签：tridion, tridion-content-delivery

## 使用 Tridion 管理“全球”徽标

例如，要使用 SDL Tridion 管理网站范围的徽标及其文本元素，我希望它在一个组件中，由（动态）组件模板呈现，并由页面模板放置。我的要求包括：

1.  **徽标作为组件**——图像作为多媒体 (mm) 组件和链接、alt（即“home”）和可选*容器组件中的其他文本*
2.  **动态组件展示 (DCP)** - 能够管理徽标的标记展示并发布更改*，而无需发布每个页面*
3.  **可共享——能够**在较低的出版物中本地化组件中的多媒体和文本，而不是模板

作者不需要将徽标作为组件演示 (CP) 放置在每个页面上，尽管仅在主页上的徽标 CP 可以提供动态链接。

## `RenderComponentPresentation()`, `TCDL`, 或`Tridion`“非 CP”的标签

**对于这种无 CP 方法，我认为 RenderComponentPresentation() 或[TCDL 标记](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/concept_B72F4D64713F4682B61C838A013DF8F8)将是正确的“不可知论”方法。一个比另一个更受欢迎吗？**

例如，我的模板输出：

```
<h3>By tridion: (ASP.NET) tag</h3>
<tridion:ComponentPresentation runat="server"
    PageURI="tcm:7-1535-64"
    ComponentURI="tcm:7-1533"
    TemplateURI="tcm:7-1532-32"/>

<h3>By tcdl: tag</h3>
<tcdl:ComponentPresentation
    PageURI="@@Page.ID@@"
    type="Dynamic"
    ComponentURI="tcm:7-1533"
    TemplateURI="tcm:7-1532-32"/>

<h3>by render component presentation</h3>
@@RenderComponentPresentation('tcm:7-1533','tcm:7-1532-32')@@ 
```

这些在文件系统上转换为以下内容。

```
<h3>By tridion: (ASP.NET) tag</h3>
<tridion:ComponentPresentation runat="server"
    PageURI="tcm:7-1535-64"
    ComponentURI="tcm:7-1533"
    TemplateURI="tcm:7-1532-32"/>

<h3>By tcdl: tag</h3>
<tridion:ComponentPresentation runat="server"
    PageURI="tcm:7-1535-64"
    ComponentURI="tcm:7-1533"
    TemplateURI="tcm:7-1532-32"/>

<h3>by render component presentation</h3>
<tridion:ComponentPresentation runat="server"
    PageURI="tcm:7-1535-64"
    ComponentURI="tcm:7-1533"
    TemplateURI="tcm:7-1532-32"/> 
```

每个都*呈现*交付端，以便用户在浏览器中看到正确的 CP。

## 问题）：

1.  任何方法都可以让我们获得从 PT 引用的 DCP，其格式不可知，可以在演示端检索，避免全站点发布。它实际上不在*页面上*，因此我们必须确保使用动态 CT 发布徽标（在本例中为 html 片段）。***我错过了什么吗？***

2.  **RenderComponentPresentation() 是优先于 TCDL 还是特定的表示端语法？**有什么我真正想要的理由`<tridion:ComponentPresentation runat="server">`吗？

编辑：我错过了`Type="Dynamic"`属性和值，还有片刻认为 RenderComponentPresentation 没有创建正确的 CP 引用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T09:27:36.560

基本上你自己已经回答了你的第一个问题，除了你想如何在你的模板中写出来之外，你还有你的 DCP。

我的偏好是使用`@@RenderComponentPresentation('tcm:7-1533','tcm:7-1532-32')@@`，但实际上我不会将它与硬编码的 TCMURI 一起使用。我可能会编写一个 TBB，它从某个配置组件或发布元数据中读取多媒体组件 TCMURI 及其模板 URI，然后您的模板可能类似于：

```
@@RenderComponentPresentation(${LogoUri}, ${LogoTemplateUri})@@ 
```

在为您的布局使用 Dreamwever TBB 时，我会将此作为首选项。如果您使用另一种布局方式，那么下一个最好的方法是使用 TCDL 标签。确实要尝试使您的模板代码不可知。唯一一次我会自己写出 tridion 控制代码，就是当我无法以另一种方式实现它的时候。

# java - Java Thread：解释为什么不总是打印变量的最新值

> ID：14005209
> 
> 赞同：1
> 
> 时间：2012-12-22T18:00:43.103
> 
> 标签：java, multithreading

我有这段代码使用Java Thread：

```
public class ThreadExample implements Runnable{

    public Thread thread;
    static int i = 0;
    ThreadExample(){
        thread = new Thread(this);
        thread.start();
    }

    public static void main(String[] args) {
        ThreadExample example = new ThreadExample();
        for(int n =0; n<1000; n++){
            System.out.println("main thread "+i);
            i++;
        }
    }

    public void run(){
        for(int index=0; index<1000; index++){
            System.out.println("Sub thread "+i);
            i++;
        }
    }
} 
```

运行时，结果是：

```
main thread 0
Sub thread 0
Sub thread 2
Sub thread 3
Sub thread 4
Sub thread 5
Sub thread 6
Sub thread 7
Sub thread 8
Sub thread 9
Sub thread 10
Sub thread 11
Sub thread 12
main thread 1
.... 
```

我知道运行的线程不遵循它的顺序。但是，我不明白的是：为什么主线程打印 1 （它打印变量 i），当变量 i 达到 12 时？（因为子线程已打印到 12）。

谢谢 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T18:03:33.400

最有可能的解释是，在准备打印文本和实际打印文本之间存在很大的延迟。主线程准备语句“主线程 1”，然后必须等到子线程释放锁`System.out`，并获取锁，才能实际打印它。

如果您使`i`volatile 发生，它仍然会发生，那么这几乎是唯一的解释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:36:58.153

`volatile`发生这种情况是因为如果没有一些同步或关键字，线程将不会看到彼此的修改。

请参阅[http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.3.1.4](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.3.1.4)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-23T03:13:26.743

结果可能是由于锁定获取方式（发生在 System.out.println 调用的幕后）本质上并不公平。不公平的实现，或者至少部分不公平的实现，通常不能保证线程会按照它们等待的顺序获取锁。

结果是，当两个线程在一个紧密的循环中反复竞争锁时（如您的示例中所示），您通常会有一个线程进行一次获取，然后另一个线程进行一次获取，依此类推。不公平锁通常更容易实现，并且通常比高度竞争锁的完全公平替代方案提高性能（吞吐量），因为它们不会受到[锁护卫](http://www.bluebytesoftware.com/blog/PermaLink,guid,e40c2675-43a3-410f-8f85-616ef7b031aa.aspx)效应的影响。显然，缺点是不能保证特定等待线程将获取锁的顺序，理论上某些等待线程肯定会被饿死（实际上这可能不会发生，或者锁可能被设计为当某些线程等待异常时间时回退到公平行为）。

给定不公平的锁，这种模式是自然的。您的第二个线程中的循环获得了锁定，并且在第一个线程读取 1 并开始等待后不久 - 要输出的字符串此时已经与前导文本连接，因此值 1 被“烘焙”。主线程必须等待另一个线程上的几个锁定/解锁对，此时它有机会运行，并打印旧值。

另一种解释是，由于缺少 volatile，解释器或 JIT 甚至不再读取 i 的共享值，而是将变量托管到寄存器中——这在 JMM 和 JVM 规范下是允许的，因为没有可能会修改 i 的干预方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T18:15:10.557

据我所知，这是因为`System.out`

尝试写入文件或`System.out.flush()`在每个 printlen 之后调用。

并尝试`i`通过同步方法增加：

```
public synchronized void increment() {
  i++;
} 
```

# assembly - I/O 指令周期是否取决于设备的速度？

> ID：14005226
> 
> 赞同：2
> 
> 时间：2012-12-22T18:03:38.550
> 
> 标签：assembly, io, cpu-architecture, machine-instruction

例如，

```
in al, 8 
```

如果端口 8 的设备非常慢，那么 CPU 是否必须等待指令完成？

谢谢！</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T14:06:15.463

这取决于设备的哪个部分“非常慢”。如果响应 PIO 请求（如`in`and `out`）需要花费大量时间，那么是的，它将停止执行单元（以及依赖于它的所有内容）。“非常慢”的内存也会发生同样的情况。

但是，如果设备需要很长时间才能完成其任务（无论它们可能是什么），但对 PIO 请求的响应非常快（例如，表明它还没有完成任务），那么它并没有真正停止 CPU .

正确设计的硬件可以做到后者。

# c - Linux 中的 pthread_mutex_trylock()

> ID：14005229
> 
> 赞同：3
> 
> 时间：2012-12-22T18:04:11.760
> 
> 标签：c, unix, pthreads, mutex, errno

我正在学习在 Linux 编程中使用互斥锁。我遇到了 trylock 函数，它首先检查互斥锁是否可用，否则将其锁定，然后返回。

现在我的问题是：

*   当调用trylock时，它是否在到达函数末尾而不执行临界区后返回？
*   为什么它不在`errno`我下面的代码中打印？

这是代码：

```
int main()
{
pthread_t tid[5];

int i;

if(pthread_mutex_init(&mutex,NULL))
    printf("Failed to lock the mutex\n");
for(i=0;i<5;i++)
{
    if(pthread_create(&tid[i],NULL,func,&i))
        printf("Failed to create a thread\n");

    if(errno==EBUSY)
        printf("thread busy\n");

}

for(i=0;i<5;i++)
{
    if(pthread_join(tid[i],NULL))
        printf("Failed to wait for thread %d\n",i);
}

printf("All threads terminated\n");

return 0;
}

void *func(void * arg)
{
int i=*(int *)arg;

if(pthread_mutex_trylock(&mutex)==0)
{
    sleep(5);
printf(" i is %d\n",i);

pthread_mutex_unlock(&mutex);
}
else
    if(errno== EBUSY)
            printf("thread busy\n");
} 
```

抱歉格式化少代码..

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:13:58.590

`pthread_mutex_trylock()`未设置`errno`- 您只需使用返回值：

```
int result = pthread_mutex_trylock(&mutex);

if(result==0)
{
    sleep(5);
    printf(" i is %d\n",i);

    pthread_mutex_unlock(&mutex);
}
else
    if (result == EBUSY)
            printf("thread busy\n");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:21:35.577

**当调用trylock时，它是否在到达函数末尾而不执行临界区后返回？**

如果`pthread_mutex_trylock(&mutex)`成功（即返回 0），则将执行第一部分（即关键部分）并返回函数。如果`pthread_mutex_trylock(&mutex)`不成功（即返回-1），则将执行else部分并希望`thread busy`将其打印并且函数将返回而不执行关键部分。

**为什么它不在我下面的代码中打印 errno？**

要么调用`pthread_mutex_trylock(&mutex)`总是成功的，如果你看到 i 的所有值（即 1-5）都被打印出来，那么就是这种情况。或者 errorno 不是 EBUSY 您可以通过之前打印的内容来检查`if(errno== EBUSY)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T18:14:06.547

pthread_mutex_trylock 的文档说，如果无法锁定互斥锁，它会返回错误代码，它不会将 errno 设置为 EBUSY。为了得到预期的结果，你应该做例如

```
int rc;
if((rc = pthread_mutex_trylock(&mutex))==0) {
  sleep(5);
  printf(" i is %d\n",i);

  pthread_mutex_unlock(&mutex);
} else {
  printf("thread busy: %s\n", strerror(rc));
} 
```

# intellij-idea - 使用 Dart 进行 IntelliJ/WebStorm 文件搜索

> ID：14005235
> 
> 赞同：0
> 
> 时间：2012-12-22T18:05:14.273
> 
> 标签：intellij-idea, dart, webstorm

以下 Dart 代码行在从终端运行时显示现有文件为 true，但从 IntelliJ 或 WebStorm 运行时为 false。有人可以解释为什么以及如何设置创意编辑器，以便它返回与终端运行相同的结果。

```
bool pathExists(String path) => new File(path).existsSync(); 
```

**更新**

经过修补后，我现在发现如果我使用“打开目录”在 WebStorm 5 中创建项目，它适用于所有（WebStorm、IntelliJ 和终端）。~~问题是当我尝试在 IntelliJ 12 中创建项目时，因为似乎没有打开目录的等效项，它似乎试图创建一个 Java 项目。目前，WebStorm 似乎对从头开始创建 Dart 应用程序有更好的支持。~~ **有关说明，请参阅下面的答案。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T10:42:19.923

你真的应该展示整个程序*以及*如何运行它，否则我只能猜测。我的猜测是您正在传递函数的*相对*路径，并且您从与 IntelliJ 不同的目录运行程序。

假设我有这个 Dart 程序：

```
import 'dart:io';

bool pathExists(String path) => new File(path).existsSync();

main() {
  print(pathExists('books.txt'));
} 
```

`true`当`books.txt`文件存在**于当前目录中**时，该程序将打印。我碰巧在我的主目录中有这样的文件，所以当我这样做时

```
ladicek@argondie:~$ dart check_file.dart 
```

它显然会打印`true`。但是如果我从另一个目录运行*相同的程序*，它肯定会打印`false`. 这可能就是您的情况。

您应该检查 IntelliJ 中的*运行/调试配置*，它允许您配置程序启动的目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-25T03:38:45.393

关注@CrazyCoder 的评论：选择

> 创建新项目

然后

> 静态网页/网页模块

并选择您的文件夹

> 项目地点

然后展开

> 更多设置

最后确保

> 模块文件位置

设置为您的 main() dart 文件所在的位置。默认情况下，它设置为内容根目录。

*与Open Directory*具有相同的效果。我试过了，效果很好。

# php - 如何在mysql中查询前3条记录？

> ID：14005236
> 
> 赞同：-2
> 
> 时间：2012-12-22T18:05:20.347
> 
> 标签：php, mysql, function, user-defined-functions

我正在为班级建立一个简单的登录/注册网站。（即没有md5、sha等） 其中一个参数是在注册时不让新注册的密码等于前3个。如果是这种情况，我将编写一个返回 true 的函数。我无法弄清楚如何做到这一点。我数据库上的主键是 user_id （自动递增）。如果用户名已经存在，这是一个返回 true 的函数：

```
function user_exists ($username) {
    return (mysql_result(mysql_query("SELECT COUNT(`user_id`) 
    FROM `users` WHERE `username` = '$username'"), 0) == 1) ? true : false;} 
```

我以为我会从这个开始，并添加一些代码以仅回顾前三个用户名

```
function returns true if password exists database
function password_exists ($password) {
$password = sanitize($password);
return (mysql_result(mysql_query("SELECT COUNT(`user_id`) `FROM `users` 
WHERE `password` = '$password' AND `user_id <'$user_id' ORDER BY user_id DESC, LIMIT 3"), 0) ==  1) ? true : false ; 
```

我是否试图用一个功能做太多事情？即我是否需要首先在一个函数中隔离最后 3 条记录，然后搜索该集合？我应该添加一个按顺序编号条目的列吗？即，如果有 5 条记录 1、2、3、4、5，并且“2”被删除，则该列将显示为 1、2、3、4。在我看来，这样搜索会更容易。非常感谢任何帮助！谢谢

```
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T18:09:23.597

您可以通过以下形式的嵌套选择来做到这一点：

```
SELECT x FROM (SELECT ...) as y; 
```

您的内部选择 (SELECT ...) 将返回记录，按日期排序（最近的在前），限制为 3。

您的外部选择将从内部选择中选择用户名。

如果返回 > 0 条记录，则说明用户名不好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:14:08.047

这样做没有任何意义。
要么检查整个数据库，要么根本不检查。

此外，这样的功能将对安全性产生巨大影响，这意味着这样的错误可能会暗示其他人的密码。

（如果是作业需要的话，难怪为什么每个人都讨厌 PHP。即使在课堂上他们教你写可怕的代码）

# image - 模糊彩色图像分割 ::Matlab

> ID：14005245
> 
> 赞同：1
> 
> 时间：2012-12-22T18:06:46.807
> 
> 标签：image, matlab, colors, image-segmentation, fuzzy-logic

我正在使用 Matlab 模糊工具箱在 HSV 颜色空间中进行彩色图像分割。目标是读取 RGB 图像-> 转换为 hsv-> 使用 H、S、V 值作为模糊系统的输入，然后找到该像素属于哪个类（这是我们的 16 种常量输出颜色）。这是模糊系统：

![](../Images/6051b24c24b5d2a6fc077810b92f1d72.png)

“推理过程基于零阶 Takagi-Sugeno 模型，因此每个模糊规则的结果部分是集合 {Black, White, Red, Orange,etc} 的清晰离散值。由于该模型有 10 Hue 模糊集，Saturation 5 个，Value 4 个模糊集，此模型所需的规则总数为 10*5*4=200"。(1)

**问题是**当我在我的程序中使用这一行来获取输出值时

```
segimg=reshape(evalfis([h s v],hsvRuleSugeno),imgh,imgw); 
```

输出不是我的任何常量类，因为它使用质心进行去模糊化，正如你在下面看到的，我不能依赖它作为输出！

[![](../Images/f8ffc6c8237b69bbf28c880620f9eb61.png)](https://i.stack.imgur.com/H6VzI.jpg)

我搜索了很多论文和网站，但我认为它是如此简单，以至于没有人解释它！我遗漏了一些东西，或者我可能没有足够的知识，你能帮我理解这个问题吗？

参考： (1): Human Perception-based Color Segmentation Using Fuzzy Logic, Lior Shamir Department of Computer Science, Michigan Tech。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T23:28:13.563

本文在 2.3 节中解释了计算过程。您不需要从 获得的非离散值或质心值`evalfis`。我假设您已经制定了必须将 16 个类之一作为输出的所有规则。这意味着每个输出类都与至少一个规则相关联。根据论文，您需要：

1.  制作 16 个组，其中包含与每个输出类关联的规则。一组黄色，一组白色，一组黑色，依此类推...
2.  计算每条规则的强度。
3.  对于每个组，找到该组中包含的所有规则的强度值的总和。
4.  然后找到其包含的规则的累积强度和最大的组。

为了实现这一点，我们不能依赖基于质心的去模糊值。我检查了上面`evalfis`和下面的文档是应该能够执行上述算法的脚本。想法是收集每个规则的强度，根据规则的输出类将规则分组，然后找到每个组的总和并找到最大值。

```
[output, IRR, ORR, ARR] = evalfis(input, fismat)
m = cat(2, ORR, ARR);
m = sortrows(m, 1)

r = [];
for l = 2 : size(m, 1)
    if m(l, 1) ~= m(l - 1, 1)
        r = cat(1, r, m(l - 1, :));
    else
        m(l, 2) = m(l, 2) + m(l - 1, 2);
    end
end

if size(m, 1) >= 2
    r = cat(1, r, m(size(m, 1), :));
end

% r now contains the final class to be choosen
disp(r) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T14:55:56.350

非常感谢您的回答 Shivam，实际上您的代码有错误，但我明白了并开始研究它，终于找到了该怎么做！这是我使用的，结果还可以！现在我必须努力调整规则以获得更好的结果

```
for i=1:imh
    for j=1:imw
        [output, IRR, ORR, ARR] = evalfis([h(i,j);s(i,j);v(i,j)], hsvRuleSugeno);
        m = cat(2,ARR,ORR);
        [trash,idx] = unique(m(:,1),'first');
        out = m(sort(idx),:);
        out(:,[1,2])=out(:,[2,1]);
        out = sortrows(out, 1);
         res=zeros(size(out));
           for l = 2 : size(out, 1)
                if out(l, 1) == out(l - 1, 1)
                res(l-1,1) = out(l-1,1);
                res(l-1,2) = out(l-1,2)+out(l,2);
                else
                res(l,1) = out(l,1);
                res(l,2) = out(l,2);  
                end
           end
           [num idx] = max(res(:,2));
           [x y] = ind2sub(size(res),idx);
          segimg(i,j)=res(x,y)/10;    
    end
end 
```

分段结果：http://i45.tinypic.com/2aj9mg.jpg

# php - ckeditor 可以更新数据库内容吗？

> ID：14005247
> 
> 赞同：0
> 
> 时间：2012-12-22T18:06:57.077
> 
> 标签：php, javascript, mysql, ckeditor

你能给我一种将ckeditor的内容保存到数据库的方法吗？

我对如何使事情起作用的想法为 0%，这将是第一次使用。我在谷歌上搜索过，但它总是显示 fckeditor（它们是一样的吗？）。另外，我尝试了一些带有 AJAX 的代码，但仍然无法使其工作，因为它需要一些插件，而我实际上并不理解它。

无论如何，我正在使用 ckeditor 的 4.0 版本，并且更喜欢 php 或 javascript 代码，因为我并不真正了解 AJAX。这是我的试用代码：

```
<!DOCTYPE html>
<!--
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
-->

<?php
include('global.php');
?>

<html>
<head>

    <script>
        var type = 'Admin';

        <!-- editableContent -->
        window.onload = function (){
            if(type=='Admin'){
            document.getElementById('opener').contentEditable= true;
            document.getElementById('main').contentEditable= true;
            // We need to turn off the automatic editor creation first.
            CKEDITOR.disableAutoInline = true;
            var editor = CKEDITOR.inline( 'opener' );
            var editor = CKEDITOR.inline( 'main' );
            }
            else{
            document.getElementById('opener').contentEditable= false;
            document.getElementById('main').contentEditable= false;
            }
        }

        function showHTML () {
        document.getElementById('textpad').textContent = textEditor.document.body.innerHTML;
        return;
        }

    </script>

    <title>Inline Editing by Code &mdash; CKEditor Sample</title>
    <meta charset="utf-8">
    <script src="ckeditor/ckeditor.js"></script>
    <link href="ckeditor/samples/sample.css" rel="stylesheet">
    <style>

        #editable
        {
            padding: 10px;
            float: left;
        }

    </style>
</head>
<body>
    <div id="opener">
    <?
    $result= mysql_query ("SELECT * from text_tb WHERE categoryName='index'");
        while($row = mysql_fetch_array($result)){
        echo $row[1];
        }
    ?>
    </div>

    <div id="main">
    <?
    $result= mysql_query ("SELECT * from text_tb WHERE categoryName='about'");
        while($row = mysql_fetch_array($result)){
        echo $row[1];
        }
    ?>
    </div>
</body>
</html> 
```

非常感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T18:17:09.883

这可能不是 100% 的目标，但这是我使用过的并且效果很好。TinyMCE 使用 HTML **textarea**标签和一些 JavaScript 来允许客户端格式化信息。然后一个普通的“提交”将 textarea 的内容发送到服务器，您在服务器上以 POST 方法请求接收它，然后您可以将其存储在数据库中。

TinyMCE 的示例 JS：

```
<script language="javascript" type="text/javascript" src="scripts/tiny_mce/tiny_mce.js"></script>
<script language="javascript" type="text/javascript">

tinyMCE.init({
    mode : "textareas",
    theme : "advanced",
    plugins : "safari,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",

    theme_advanced_buttons1 : "bold,italic,underline,|,justifyleft,justifycenter,justifyright,|,bullist,numlist,|,copy,paste,pastetext,pasteword,|,undo,redo,|,link,unlink,anchor,image,cleanup,|,removeformat,|,forecolor,backcolor,|,formatselect,charmap,emotions,iespell,",
    theme_advanced_buttons2 : "",
    theme_advanced_buttons3 : "",
    theme_advanced_toolbar_location : "top",
    theme_advanced_toolbar_align : "left",
    theme_advanced_statusbar_location : "bottom",
    theme_advanced_resizing : true
});

</script> 
```

链接在这里：[http ://www.tinymce.com/](http://www.tinymce.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:57:08.230

ckeditor 文档提供了一种非常简单易用的方法：

```
<form method="post">
    <p>
        My Editor:<br>
        <textarea name="editor1">&lt;p&gt;Initial value.&lt;/p&gt;</textarea>
        <script>
            CKEDITOR.replace( 'editor1' );
        </script>
    </p>
    <p>
        <input type="submit">
    </p> 
```

@ [http://docs.ckeditor.com/#!/guide/dev_framed-section-4](http://docs.ckeditor.com/#!/guide/dev_framed-section-4)

在服务器端，你只需要

```
mysql_query("insert into yourtable (yourtextfield) VALUES ( '".mysql_real_escape_string($_POST['editor1'])."')"); 
```

尽管我强烈建议您使用 PHP PDO Extensions 提供的准备好的语句。准备好的语句更加安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T19:10:10.083

> [...] 更喜​​欢 php 或 javascript 代码，因为我并不真正了解 AJAX。

事实上，AJAX 是 PHP 和 JavaScript 的混合体：P 如果没有服务器端语言 (PHP)，您无法更新数据库内容，但是使用客户端语言 (JavaScript) 您可以与服务器端脚本“对话”，那就是我们称之为 AJAX..

无论如何，正如 Ray Paseur 所说，通常您会发布一个包含 textarea 的表单，其中包含已编辑内容的值，但在您的情况下，您似乎正在使用 4.0 版本的新内联编辑功能？

因此，在这种情况下，要访问已编辑内容的值，您必须像这样获取已编辑的 div 的内容：

```
var opener_content=document.getElementById("opener").innerHTML;
var main_content=document.getElementById("main").innerHTML; 
```

这将为您提供编辑器生成的 HTML 代码。只需在您从页面中的“保存更改”按钮调用的函数中执行此操作，然后使用 AJAX 将这些变量发送到您的服务器......（我真的建议您了解有关 AJAX 的更多信息，它比接缝更简单.)

但是，如果您现在不想学习 AJAX，您可以在页面上添加一个带有空文本区域的隐藏表单，当单击保存按钮时，您使用上面的 2 个变量填充这些文本区域，然后通过 JavaScript 发布此表单并使用`$_POST`变量将数据保存在 PHP 中！它会起作用，即使它是一个丑陋和懒惰的解决方案:)

# wpf - 绑定到 ObservableCollection 特定索引

> ID：14005249
> 
> 赞同：0
> 
> 时间：2012-12-22T18:07:02.423
> 
> 标签：wpf, mvvm, binding

我有下一节课：

```
public class GridViewControlModel : NotificationObject
{
    DataTable datasource;
        public DataTable Datasource
        {
            get
            {
                return datasource;
            }
            set
            {
                datasource = value;
                RaisePropertyChanged("Datasource");
            }
        }

        ObservableCollection<string> fieldsNames;
        public ObservableCollection<string> FieldsNames
        {
            get
            {
                if (fieldsNames == null)
                {
                    fieldsNames = new ObservableCollection<string>();
                }
                return fieldsNames;
            }
            set
            {
                fieldsNames = value;
                RaisePropertyChanged("FieldsNames");
            }
        }    
//and more properties
} 
```

属性“FieldsNames”包含我想绑定到 GridView 数据列标题的列标题列表。

在我的 ViewModel 中，我创建了属性 - GridViewControlModel CurrentGridViewData，我想将我的 GridView 列标题绑定到我的 CurrentGridViewData.FieldsNames[indexes]

例如

```
<dxg:GridColumn1 Header="{Binding CurrentGridViewData, Path=CurrentGridViewData.FieldsNames[0]}">
<dxg:GridColumn2 Header="{Binding CurrentGridViewData, Path=CurrentGridViewData.FieldsNames[1]}"> 
```

等等...我正在与 DevExpress gridCointrol 合作，但我认为这无关紧要。

如何将属性绑定到特定的 ObservableCollection 索引？

我将解释我想要做什么。我有许多视图的 GridControl。当用户切换视图时，网格控件需要更改其整个结构（不同的列数、列标题、列大小、类型等）。我创建了一个包含每个视图的所有属性和设置的类（我的问题中的这个 CurrentGridViewData 类），当用户切换视图时，我将 CurrentGridViewData 的引用更改为正确的视图实例，并通过绑定我想要进行所有网格更改。有没有更好的办法？

谢谢

谢谢

* * *

我想我找到了与 DevExpress GridControl 相关的可能解决方案。看下一个链接 [http://documentation.devexpress.com/#wpf/CustomDocument10121](http://documentation.devexpress.com/#wpf/CustomDocument10121)

你在想什么？它比使用 DataTemplate 更好吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:48:21.270

我的解决方案是为每个要绑定到 DataGrid 的模型创建一个 DataTemplate。

例如，假设您有 3 个不同的数据表：OrdersDataTable、CustomersDataTable 和 ProductsDataTable。

首先是用一个简单的 ContentControl 替换您的 DataGrid 控件。

```
<ContentControl Content="{Binding DataTable}"/> 
```

然后在您的应用程序资源中添加并创建这些 DataTemplate。

```
<DataTemplate DataType="{x:Type local:OrdersDataTable}">
    <DataGrid ItemsSource="{Binding}">
        <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding ID}" Header="ID"/>
            <DataGridTextColumn Binding="{Binding Tax}" Header="Tax"/>
            <DataGridTextColumn Binding="{Binding NetAmount}" Header="NetAmount"/>
        </DataGrid.Columns>
    </DataGrid>
</DataTemplate>

<DataTemplate DataType="{x:Type local:CustomersDataTable}">
    <DataGrid ItemsSource="{Binding}">
        <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding ID}" Header="ID"/>
            <DataGridTextColumn Binding="{Binding FirstName}" Header="First name"/>
            <DataGridTextColumn Binding="{Binding LastName}" Header="Last name"/>
        </DataGrid.Columns>
    </DataGrid>
</DataTemplate>

<DataTemplate DataType="{x:Type local:ProductsDataTable}">
    <DataGrid ItemsSource="{Binding}">
        <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding ID}" Header="ID"/>
            <DataGridTextColumn Binding="{Binding Name}" Header="Name"/>
            <DataGridTextColumn Binding="{Binding Quantity}" Header="Quantity"/>
            <DataGridTextColumn Binding="{Binding UnitPrice}" Header="UnitPrice"/>
        </DataGrid.Columns>
    </DataGrid>
</DataTemplate> 
```

这样，当您将 DataTable 绑定到内容控件时，它将查找具体的 DataTable 类型并爬取应用程序资源以找到相应的 DataTemplate 来显示您的 DataTable。

我建议对 DataGrid 控件使用 Style，这样您就不必在所有 DataTemplate 中重现该样式。

注意： DataGrid.ItemsSource 可能不适合您，只需调整它即可。

# c# - 如何阻止第二个事件C#

> ID：14005250
> 
> 赞同：0
> 
> 时间：2012-12-22T18:07:05.830
> 
> 标签：c#, silverlight, windows-phone-7

我有一个`Listbox`. 每个`Listbox`项目都在一个大网格中包含一些内容（文本、照片、音频、视频）。

`Grid`有点击事件 - 它正在导航到带有对此`Listbox`项目的评论的页面。如果`Listbox`'项目有音频-在网格中我构建一个`Textblock' with content "title and artist" and assign event which navigate to page with`音频播放器`。

在这附近`Textblock`，我建立了一个播放按钮。它有一个事件，它只是开始音乐而不导航到`audioplayer`.

在这里我有一个问题：当我点击这个按钮时 - 启动开始播放音乐的事件（没关系），然后 - 启动大网格事件，它将我导航到带有评论的页面（它不好）。

`Grid`因此，如果我按下“播放”按钮，则需要阻止 big的事件。

# c++ - 修复涉及派生类和静态类的 C++ 内存泄漏

> ID：14005251
> 
> 赞同：3
> 
> 时间：2012-12-22T18:07:09.037
> 
> 标签：c++, memory-leaks

我正在努力修复来自第三方软件包（Zinc Application Framework，一个 GUI windows 框架，大约 1999 [！]）的内存泄漏。我正在使用 Microsoft Visual Studio 2005 C++ 的 Windows 7 机器上工作（请屏住呼吸）。我很好奇是否有人对可能出现的问题有任何见解。

以下是我收到的消息，表明存在内存泄漏：

```
Detected memory leaks!
Dumping objects ->
{291} normal block at 0x003DE228, 36 bytes long.
Data: <`               > 60 B6 1D 10 00 00 00 00 00 00 00 00 00 00 CD CD 
Object dump complete.
The program '[3496] TempZAF3.exe: Native' has exited with code 0 (0x0). 
```

追踪到内存分配块291，我进入如下方法：

```
long ZafCache::Get(long type, long value)
{
    // Find a matching cache element.
    CacheElement *element; 
    for (element = (CacheElement *)First(); element; element = (CacheElement *)element->Next())
        if (element->type == type && element->value == value)
        {
            // Move the element to the front of the list because it is
            // most recently used.
            if (element != first)
            {
                ZafList::Subtract(element);
                ZafList::Add(element, first);
            }

            element->useCount++;
            return element->handle;
        }

    // Create a cache element if one didn't already exist.
    long handle = CreateFunction(type, value);
    element = new CacheElement(type, value, handle);
    ZafList::Add(element, first);

    // Remove a cache element if the cache is full.
    if (++count >= size)
    {
        element = (CacheElement *)last;
        if (element->useCount <= 0)
        {
            ZafList::Subtract(element);
            DestroyFunction(element->type, element->value, element->handle);
            delete element;
            element = ZAF_NULLP(CacheElement); 
            count--;
        }
    }

    return handle;
} 
```

调试器将我带到上述方法的以下代码行：

```
element = new CacheElement(type, value, handle); 
```

啊哈。至少在此方法中，此代码后面没有“删除元素”命令。显然，这是罪魁祸首——我们为 CacheElement 分配内存，而我们从未释放内存。

伟大的！因此，让我们在将元素添加到静态 ZafList 后简单地删除它，看看是否能解决问题。不——我们得到一个未处理的异常，读取某个位置的访问冲突。好的，让我们尝试一个小实验。我们将注释掉这行代码

```
//ZafList::Add(element, first); 
```

并添加一个

```
delete element; 
```

答对了。没有更多的内存泄漏。唯一的问题是我们实际上想要将元素添加到 ZafList。

下面是 ZafList::Add 方法的代码：

```
ZafElement *ZafList::Add(ZafElement *newElement, ZafElement *positionElement)
{
    // Add the element to the list.
    if (!first)                     // Put at the first of the list.
    {
        newElement->previous = newElement->next = ZAF_NULLP(ZafElement);
        first = last = newElement;
    }
    else if (!positionElement)      // Put at the end of the list.
    {
        newElement->previous = last;
        newElement->next = ZAF_NULLP(ZafElement);
        last->next = newElement;
        last = newElement;
    }
    else                            // Put before the specified element.
    {
        newElement->previous = positionElement->previous;
        newElement->next = positionElement;
        if (!positionElement->previous)
            first = newElement;
        else
            positionElement->previous->next = newElement;
        positionElement->previous = newElement;
    }

    ++count;

    return (newElement);
} 
```

下面是显示 ZafList 和 ZafCache 以及 ZafElement 和 CacheElement 之间关系的代码：

```
// Cache used for cacheing GDI pens and brushes. 
class ZafCache : public ZafList
{
public:
    ZafCache(int size,
            long (*CreateFunction)(long type, long value),
        void (*DestroyFunction)(long type, long value, long handle));
    virtual ~ZafCache(void); 

    long Get(long type, long value);
    int Release(long handle);

private:
    int count;
    int size;
    long (*CreateFunction)(long type, long value);
    void (*DestroyFunction)(long type, long value, long handle);

    class CacheElement : public ZafElement
    {
    public:
        long handle;
        long type;
        long value;
        int useCount;

        CacheElement(long type, long value, long handle);
    };
}; 
```

ZafList 析构函数是否应该释放分配给 CacheElement 的内存？名义上，ZafList 析构函数似乎应该完成这项工作，因为它调用了以下方法。

```
void ZafList::Destroy(void)
{
    ZafElement *tElement;

    // Delete all the elements in the list.
    for (ZafElement *element = first; element; )
    {
        tElement = element;
        element = element->next;
        delete tElement;
        tElement = ZAF_NULLP(ZafElement);
    }

    first = last = current = ZAF_NULLP(ZafElement);
    count = 0;
} 
```

然而，我们遇到了内存泄漏。所以问题归结为：在将 CacheElement 添加到 ZafList 后，如何释放为 CacheElement 分配的内存？在此先感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:20:13.793

代码看起来都不错。

但是仅仅因为内存泄漏软件说有泄漏并不一定意味着有一个。可能是内存泄漏检测代码在调用列表的析构函数之前被挂钩（如果列表是文件范围静态存储持续时间对象，则可能发生这种情况）。

# php - PHP 搜索 MySQL 数据库框架

> ID：14005257
> 
> 赞同：1
> 
> 时间：2012-12-22T18:08:09.757
> 
> 标签：php, mysql, sql, search, full-text-search

我敢肯定这个问题已经被问了至少 1000 次，但请听我说完。

我为 MySQL 编写了一个 PHP 脚本，用于搜索在我的图书交换网站上出售的图书。我使用[本教程](http://devzone.zend.com/26/using-mysql-full-text-searching/)帮助我编​​写了 FULLTEXT 搜索脚本，它在大多数情况下都很好用。有两个真正的大问题让我和我的一些用户感到畏缩：

1.  例如，如果我按名称搜索特定商家，`Steve Miller`该脚本将返回所有姓名为`Steve Miller`、名字为`Steve`和姓氏为 的人`Miller`。正如您可以想象的那样，该脚本返回了相当多的虚假结果。书名中的常用词（例如`of`or ）会变得更糟`the`，但它不会返回包含这些词的所有书籍。
2.  我有一个自动建议功能，它只能在您输入整个单词时建议标题。例如搜索`The Unive`can'tSuggest任何东西，而`The Universe`可以建议`The Universe Next Door`。

**问题：**是否有任何完善的脚本或框架允许我在 MySQL 数据库中搜索多个关系？我不能使用谷歌自定义搜索之类的东西，因为我正在搜索数据库中的特定关系和外键关系，而不是整个站点。

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T15:44:29.037

我决定使用 IndexDen 来搜索 MySQL 数据。他们有一个 PHP API 类，使您能够发送可以专门格式化以适合您的数据库结构的数据，并使用他们的服务来搜索您发送的数据中的特定“属性”。

*   [索引](http://indexden.com/documentation/php-client#fields)
*   [按“数据库”属性搜索](http://indexden.com/documentation/api#searching)

他们还提供了不错的自动完成服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:19:35.680

您的自动建议似乎是倒退的，它应该产生相反的结果。当有人键入 The Univ 时，它应该返回 The Universe Next Door - 这就是自动建议/完成的用途。至于问题#1。如果您愿意，有一定的秘密知识，如果有人在搜索，他们将继续输入字符，直到出现他们正在寻找的结果。如果事实上他们只是在寻找“史蒂夫”，那么他们想知道所有对“史蒂夫”的引用，或者他们只是懒惰。如果他们键入 Steve Mill，那么它应该返回 Steve Mill 以及 Steve Miller，但不返回 Steve Milworks，因为名字匹配但用户正在寻找比 Steve 更具体的名字。

# sql - 来自多个表的 SQL 查询

> ID：14005259
> 
> 赞同：2
> 
> 时间：2012-12-22T18:08:37.173
> 
> 标签：sql

我是 SQL 新手，我需要一些帮助，

我想用姓氏找出已确认（已确认=1）的预订日期`Steven`

有人可以帮助这个 SQL 查询吗

**表成员**

```
+-----------+-----------+
|Member_id  | last_name |
+-----------+-----------+
| 1         | David     |
| 2         | owen      |
| 3         | Tom       |
| 4         | Steven    |
| 5         | Steven    |
| 6         | Steven    |
| 7         | Steven    |
| 8         | Steven    |
| 9         | Steven    |
+-----------+-----------+ 
```

**表保留**

```
+-----------+-----------+-----------+-----------+
|resvationID|Member_id  | day       |   month   |
+-----------+-----------+-----------+-----------+
| 1         | 1         |   1       |     6     |
| 2         | 1         |   2       |     6     |
| 3         | 2         |   1       |     6     |
| 4         | 4         |   1       |     6     |
| 5         | 4         |   2       |     6     |
| 6         | 5         |   1       |     6     |
| 7         | 5         |   2       |     6     |
| 8         | 7         |   3       |     6     |
+-----------+-----------+-----------+-----------+ 
```

**确认**

```
+-----------+-----------+-----------+
|confirmID  |resvationID| confirmed |
+-----------+-----------+-----------+
| 1         | 1         |   1       |
| 2         | 2         |   1       |
| 3         | 3         |   0       |
| 4         | 4         |   0       |
| 5         | 5         |   1       |
| 6         | 6         |   1       |
| 7         | 7         |   0       |
| 8         | 8         |   1       |
+-----------+-----------+-----------+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:22:04.820

这样的事情对你有用吗？

```
 SELECT
     m.Member_ID, m.Last_Name,
     r.Day, r.Month, 
     c.ConfirmID
 FROM 
     table_member m
 INNER JOIN 
     table_reservation r ON r.Member_ID = m.Member_ID
 INNER JOIN
     Confirm c ON c.resvationID = r.resvationID
 WHERE
     m.Last_Name = 'Steven' AND c.confirmed = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:20:12.310

```
Select c.*, r.*, m.*
from confirm c
left join table_reservation r on c.reservationID = r.reservationID
left join table_member m on m.member_id = r.Member_id
Where c.confirmed = 1
and m.name = "Steven" 
```

我没有测试它，但这应该为您指明方向。

（编辑：第二个“哪里”是错字）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T20:23:27.520

对所有表应用内连接

```
select day,month from table_reservation inner join table_member on table_member.member_id=table_reservation.member_id
inner join confirm on confirm.reservationid=table_reservation.reservationid where confirm.confirmid=1
and table_member.last_name like 'Steven' 
```

# c - 信号量操作

> ID：14005262
> 
> 赞同：2
> 
> 时间：2012-12-22T18:08:58.477
> 
> 标签：c, semaphore

我正在阅读有关信号量及其操作的文本。作者强调信号量的`wait()`和`post()`操作应该原子执行，否则可能违反线程互斥。谁能给我解释一下他的意思？顺便说一句，我是多线程的新手

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:23:22.540

上下文切换的操作，其中一个任务/进程被内核替换为另一个，是异步和不确定的。

让我们检查以下代码：

```
x++; 
```

看起来很简单，哈？但是，如果 x 在不同的任务/进程之间共享，则此代码容易出现同步错误。

要理解这一点，您必须了解原子操作的概念。

原子操作是处理器可以在单个时钟上执行的指令。它通常涉及读取寄存器、写入寄存器等。

回到代码示例：当递增变量时，在幕后（汇编）实际发生的是 cpu 将变量的值读入寄存器。然后，它增加它。然后它将它保存回它从（内存）工具它的原始位置。

如您所见，像这样的简单操作涉及 3 个 cpu 步骤。上下文切换可以在这 3 个步骤之间发生。

让我们举一个需要增加同一个变量 x 的两个线程的例子。

让我们检查一个想象的（但可能的）场景的伪汇编代码

1.  读取要注册的值（线程 1）
2.  增加值（线程 1） CONTEXT SWITCH
3.  读取要注册的值（线程 2）
4.  增加值（线程 2）
5.  保存值（线程 2） CONTEXT SWITCH
6.  保存值（线程 1）

如果 x 是 3，现在看来它需要是 5，但它会是 4。

现在，让我们参考您的原始问题。信号量/互斥体实际上是一个变量。当一个进程想要接受它时，它会增加它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:48:51.400

是的，如果信号量上的`wait()`和`post()`操作没有原子地执行，线程的相互执行可能会被违反。

例如，考虑一个具有值`S = 1`和进程的信号量，`P1`并`P2`尝试`wait()`同时执行如下，

在 time `T0`，`T1`process `P1`，分别`P2`找到 semaphore 的值，`S = 1`然后递减 semaphore 以获取锁并同时进入临界区，违反了线程的相互执行。

建议在获得锁之前 使用自旋锁`wait()`和`post()` [自旋锁](http://en.wikipedia.org/wiki/Spinlock)之间的原子性。

# objective-c - 切换CCLayer的最佳实践，如CCDirector切换CCScene

> ID：14005269
> 
> 赞同：0
> 
> 时间：2012-12-22T18:10:02.657
> 
> 标签：objective-c, cocos2d-iphone

有人可以建议或指向我如何切换 CCLayer 的链接，就像

```
[ [CCDirector sharedDirector] replaceScene: [SomeCustomScene scene] ]; 
```

我计划在我的游戏项目中使用 CCLayers 来管理菜单系统和关卡，而不是使用 CCScenes。我正计划像 sharedDirector 一样创建一个“SharedLayer”（单例）来交换级别和菜单。

例如：`[ [MySharedLayer sharedLayer] replaceLayer: [MyCustomLayer node] ];`

有没有更好的方法。请指教

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T03:51:43.307

用途：**CCLayerMultiplex**

*CCLayerMultiplex*是一个 CCLayer，能够多路复用它的子级。

特征：

*   它支持一个或多个孩子
*   一次只有一个孩子活跃

参考：

a) [http://www.cocos2d-iphone.org/api-ref/1.0.0/interface_c_c_layer_multiplex.html](http://www.cocos2d-iphone.org/api-ref/1.0.0/interface_c_c_layer_multiplex.html)

B） [http://books.google.ca/books?id=9CQL8t6Eob0C&pg=PA104&lpg=PA104&dq=CCMultiplexLayer&source=bl&ots=AgsaLtHNyX&sig=vpYxnf4jUeuQHauxmmIuuv6MJzU&hl=en&sa=X&ei=Tn_WUI3jBsmCqgHpo4DYCw&ved=0CE0Q6AEwAw#v=onepage&q=CCMultiplexLayer&f=false](http://books.google.ca/books?id=9CQL8t6Eob0C&pg=PA104&lpg=PA104&dq=CCMultiplexLayer&source=bl&ots=AgsaLtHNyX&sig=vpYxnf4jUeuQHauxmmIuuv6MJzU&hl=en&sa=X&ei=Tn_WUI3jBsmCqgHpo4DYCw&ved=0CE0Q6AEwAw#v=onepage&q=CCMultiplexLayer&f=false)

方法：

```
 - (void) switchTo:(unsigned int) n; 
```

将允许您在图层之间切换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T21:58:59.957

感谢@sg7 的反馈。我觉得创建单例 CCLayer 是一种交换图层的好方法，就像 CCDirector 替换场景一样，因为在我的项目中，我打算只有一个场景。如果我试图保留一堆层以进行快速交换，我肯定会采用 CCLayerMultiplex 路线。

在我的情况下，我采取了不同的路线。我用 CCLayer 属性（当前）和 switchLayer 方法制作了我的 SceneMgr 类（继承自 CCScene）的单例。

```
//I can now switch layers like this...
//There is a static SceneMgr being used, so only one instance exists
[ [SceneMgr scene].current switchLayer: myNewLayer withAction: fadeIn]; 
```

# javascript - 使用 document.write 加载不同的 css 样式表时，浏览器会无限刷新

> ID：14005272
> 
> 赞同：0
> 
> 时间：2012-12-22T18:10:58.317
> 
> 标签：javascript, ios, css, wordpress, stylesheet

我试图在我的 wordpress 博客上使用两种不同的样式表，这样当通过 Web 访问页面时使用一个样式表，当通过我们的 iOS 应用程序访问博客内容时使用另一个样式表。现在我们正在将 ?app=true 附加到来自 iOS 应用程序的 URL 请求中，希望在我们的博客中我们可以搜索此字符串并加载不同的样式表。我们正在使用 JSON API 插件，以便我们的 iOS 应用程序可以通过编程方式拉取我们的博客文章并将它们显示在 iOS 应用程序的 Web 视图中。

在我的 wordpress 博客中，我使用了在 URL 中查找 ?app=true 的 javascript，如果是，则加载不同的样式表。

```
<script language="javascript" type="text/javascript">
    var location = window.location.href;
if(location.indexOf("?app=true") > -1) {        
document.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"appstyle.css\" />");
}
</script> 
```

此代码放置在我的 wordpress 主题的 header.php 文件的标签中。

我尝试使用的样式表名为 appstyle.css，与 header.php 位于同一目录中。

我遇到的问题是，使用此代码会无限重新加载浏览器页面。问题似乎与 document.write 函数有关，因为没有该网页可以正常加载（尽管它显然没有加载 appstyle.css 样式表）。

我也试过这个 if 语句：

```
if(window.location.search.indexOf('?app=true') === 0) 
```

但这似乎没有什么不同。

有没有更好的方法来加载不同的样式表，具体取决于它是在 iOS 应用程序中还是在 Web 中加载的？我的代码中有什么做错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T18:15:23.713

此行有语法错误：

```
document.write("<link rel="stylesheet" type="text/css" href="appstyle.css" />"); 
```

尝试将其更改为：

```
document.write('<link rel="stylesheet" type="text/css" href="appstyle.css" />'); 
```

或进行适当的转义

```
document.write("<link rel=\"stylesheet\" type=\"text/css\" href=\"appstyle.css\" />"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T18:53:13.233

尝试：

```
location === window.location 
```

在控制台中。

它将输出`true`. 这表明全局变量已经设置`location`并指向[`location`](https://developer.mozilla.org/docs/DOM/window.location). [`window`](https://developer.mozilla.org/docs/DOM/window)使用您的代码，您通过分配一个新值来更改该变量，这会触发浏览器重新加载。

要修复它，只需为您的变量使用另一个名称，例如：

```
var currentLocation = window.location.href; 
```

或者将您的代码放在一个自执行函数中，以将其与全局范围分开：

```
(function (){
  var location = window.location.href;
  if(location.indexOf('?app=true') > -1) {        
    document.write('<link rel="stylesheet" type="text/css" href="appstyle.css" />');
  }
}()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-22T18:31:26.883

如果您坚持使用 document.write，请记住在 onload 或稍后调用 document.close()。

# c++ - boost::spirit::position_iterator2 的奇怪错误

> ID：14005273
> 
> 赞同：2
> 
> 时间：2012-12-22T18:11:02.707
> 
> 标签：c++, boost-spirit, boost-spirit-qi

所以我想做的是解析一个字符串列表：

```
namespace qi = boost::spirit::qi;
namespace ascii = boost::spirit::ascii;

std::string TEST = "aa\nbbbb\nccc\n";

std::istringstream INPUT (TEST);
std::noskipws(INPUT);

typedef std::istreambuf_iterator<char> base_iterator;
typedef boost::spirit::multi_pass<base_iterator>  multi_pass_iter;
typedef boost::spirit::classic::position_iterator2<multi_pass_iter> pos_iterator;

base_iterator base_begin(INPUT);

multi_pass_iter first =  boost::spirit::make_default_multi_pass(base_begin);
multi_pass_iter last;

pos_iterator pfirst(first,last,std::string("DD"));
pos_iterator plast;

using qi::lexeme;
using ascii::alpha;

std::vector<std::string> DDD;
bool res = qi::phrase_parse(pfirst,plast,* lexeme[+alpha],ascii::space,DDD);

for (const auto & d : DDD) std::cout << d << " (" << d.size() << ")" << std::endl; 
```

我得到的`DDD`是正确大小的 3 个字符串，但都是空格。

相反，如果我使用

```
bool res = qi::phrase_parse(first,last,* lexeme[+alpha],ascii::space,DDD); 
```

一切都按预期工作。我`position_iterator2`过去使用没有任何问题，所以我不相信这是一个错误。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-10T06:40:04.263

我认为这是[一个精神错误](https://svn.boost.org/trac/boost/ticket/3999)。[如果您查看票证](https://svn.boost.org/trac/boost/ticket/3999)的底部，您会发现我认为可以修复它的补丁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T11:18:14.777

[这里](http://boost-spirit.com/home/articles/qi-example/tracking-the-input-position-while-parsing/)有一个例子也不起作用。使用 Visual Studio 2012 都会发出警告：

```
boost/iterator/iterator_adaptor.hpp(306): warning C4172: returning address of local variable or temporary
boost_1_52_0\boost/iterator/iterator_adaptor.hpp(306) : while compiling class template member function 'const char &boost::iterator_adaptor<Derived,Base,Value,Traversal>::dereference(void) const'
         with
         [
            Derived=boost::spirit::classic::position_iterator2<forward_iterator_type>,
            Base=forward_iterator_type,
            Value=const char,
            Traversal=boost::forward_traversal_tag
         ] 
```

快速谷歌搜索“iterator_adaptor dereference temporary”会导致[建议](http://boost.2283326.n4.nabble.com/Iterator-Can-dereference-in-iterator-adaptor-return-a-temporary-value-td3706635.html)`Reference`参数`iterator_adaptor`为非引用类型。

为了实现这一点，您需要更改文件“boost/spirit/home/classic/iterator/impl/position_iterator.ipp”。具体来说，您需要更改：

```
typedef boost::iterator_adaptor<
    main_iter_t,
    ForwardIterT,
    const_value_type,
    boost::forward_traversal_tag
> type; 
```

到：

```
typedef boost::iterator_adaptor<
    main_iter_t,
    ForwardIterT,
    const_value_type,
    boost::forward_traversal_tag,
    const_value_type
> type; 
```

这会导致 g++ 和 vc11 中出现新错误：

```
boost_1_52_0\boost/concept_check.hpp(212): error C2440: 'initializing' : cannot convert from 'boost::detail::iterator_category_with_traversal<Category,Traversal>' to 'std::forward_iterator_tag'
          with
          [
              Category=std::input_iterator_tag,
              Traversal=boost::forward_traversal_tag
          ]
          No constructor could take the source type, or constructor overload resolution was ambiguous 
```

如果将`iterator_adaptor`typedef 更改为：

```
typedef boost::iterator_adaptor<
    main_iter_t,
    ForwardIterT,
    const_value_type,
    std::forward_iterator_tag,
    const_value_type
> type; 
```

这使得下面的程序（基于您的代码）和 boost-spirit.com 中的示例都可以工作，但我不确定它在其他情况下不会中断，因此请自行决定使用它。

```
#include <vector>
#include <istream>
#include <sstream>
#include <iostream>
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/support_multi_pass.hpp>
#include <boost/spirit/include/classic_position_iterator.hpp>

namespace qi = boost::spirit::qi;
namespace ascii = boost::spirit::ascii;

int main()
{

    std::string TEST = "aa\nbbbb\nccc\n";

    std::istringstream INPUT (TEST);
    std::noskipws(INPUT);

    typedef std::istreambuf_iterator<char> base_iterator;
    typedef boost::spirit::multi_pass<base_iterator>  multi_pass_iter;
    typedef boost::spirit::classic::position_iterator2<multi_pass_iter> pos_iterator;

    base_iterator base_begin(INPUT);

    multi_pass_iter first =  boost::spirit::make_default_multi_pass(base_begin);
    multi_pass_iter last;

    pos_iterator pfirst(first,last,std::string("DD"));
    pos_iterator plast;

    using qi::lexeme;
    using ascii::alpha;

    std::vector<std::string> DDD;
    bool res = qi::phrase_parse(pfirst,plast,* lexeme[+alpha],ascii::space,DDD);

    if(res && pfirst==plast)
    {
        for (const auto & d : DDD) 
            std::cout << d << " (" << d.size() << ")" << std::endl;
    }
    else
    {
        std::cout << "Parsing error." << std::endl;
    }

    return 0;
} 
```

# jquery - 在 jquery.each 中每 5 秒显示一次对象值

> ID：14005276
> 
> 赞同：1
> 
> 时间：2012-12-22T18:11:35.190
> 
> 标签：jquery

我有 5 个项目的集合，我希望每个项目显示 5 秒。这是以下 HTML 代码：

```
<div class="show">
 <rec>First item</rec>
 <rec>Second item</rec>
 <rec>Third item</rec>
 <rec>Fourth item</rec>
 <p class="show-line"></p>
</div> 
```

这里是 Jquery

```
 $('.show > rec').hide();

 $('rec').each(function(index) { 
  var x = $(this).text();
    setTimeout(function() {
      $('p.show-line').html(x).fadeIn('slow');  
    }, 5000);

 }); 
```

现在的问题是在 show-line 元素中只输出了最后一项。但是当我提醒 x 元素时，它会输出正确的值。那么我怎样才能将每个元素显示 5 秒，然后隐藏并显示下一个元素等等......

这是一个工作示例[http://jsfiddle.net/3NnR2/11/](http://jsfiddle.net/3NnR2/11/)

肿瘤坏死因子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:24:56.363

另一种选择是使用[setInterval](http://www.w3schools.com/jsref/met_win_setinterval.asp)方法，然后根据索引选择要显示的元素：

```
$('.show > rec').hide();

var index = 0;
var total = $('rec').size() - 1;

setInterval(function(){

    var rec = $('rec:eq(' + index + ')');
    $('p.show-line').html(rec.text()).fadeIn("slow");

    if(index == total){
        index = 0;
    } else {
        index++;
    }

}, 5000); 
```

工作示例：http: [//jsfiddle.net/3NnR2/15/](http://jsfiddle.net/3NnR2/15/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:17:01.007

1.  您需要为每个设置不同的 setTimeout 间隔。
2.  您还需要`.hide()`之前的元素`.fadeIn()`

尝试以下操作：

```
$('.show > rec').hide();

$('rec').each(function(index) { 
    var x = $(this).text();
    setTimeout(function() {
       $('p.show-line').html(x).hide().fadeIn('slow');  
     }, index * 5000);

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T18:26:10.780

你在这里做错了几件事。

1.  无文件准备功能
2.  你在`fadeIn`错误的元素上调用（`.show-line`而不是`rec`）

[以下是](http://jsfiddle.net/3NnR2/13/)如何实际做到这一点：

```
$(document).ready(function(){
    $('.show > rec').hide();
    showNext($("rec:first-child"));

});

function showNext($ele){
    $ele.fadeIn('slow'); 
    if ($ele.next("rec").length > 0)
         setTimeout(function() {
           showNext($ele.next("rec"))  
         }, 5000);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T18:35:36.327

把我的答案也扔进去。看起来这是一种流行的方法，看到使用的各种技术很有趣。

```
var i = 0;
var items = [];

$('.show > rec').hide();

$('rec').each(function(index) {
    var x = $(this).text();
    items[items.length] = x;
});

function rotate() {

    setTimeout(function() {
        if (i > items.length) {
            i = 0;
        }
        $('p.show-line').html(items[i]).hide().fadeIn('slow');
        i++;
        rotate();
    }, 5000);
}

rotate();​ 
```

基本思想只是将项目填充到一个数组中，然后使用递归永远循环它们。工作示例：http: [//jsfiddle.net/3NnR2/17/](http://jsfiddle.net/3NnR2/17/)

# asp.net - 当我将 cookie 添加到 HttpResponse 时，如何删除“no-cache="Set-Cookie"'？

> ID：14005279
> 
> 赞同：5
> 
> 时间：2012-12-22T18:11:40.133
> 
> 标签：asp.net, .net, wcf, cookies

我目前正在使用以下代码从 Web 服务返回一个 cookie：

```
HttpResponse response = ...;
var cookie = new HttpCookie(cookieName)
{
    Value = cookieValue,
    Expires = expiresDate,
    HttpOnly = true,
    Path = "/",
    Secure = true,
};
response.Cookies.Add(cookie); 
```

这会导致在我的 Cache-Control 标头中自动添加**no-cache**指令：

> Cache-Control: public, **no-cache="Set-Cookie"** , must-revalidate, max-age=60

我的客户恰好通过直接不缓存响应来处理此指令。**如果我在no-cache**指令到达客户端之前手动删除它，那么缓存效果很好。

如何防止 .NET 自动将此指令添加到包含 cookie 的响应中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-22T18:11:40.133

`HttpResponse``Cookies`根据集合是否为非空来决定是否添加该指令。因此，如果您手动添加标头，您可以在 .NET 中隐藏它的存在：

```
response.AddHeader("Set-Cookie", String.Format(
        "{0}={1}; expires={2}; path=/; secure; HttpOnly",
        cookieName, cookieValue, expiresDate.ToString("R"))); 
```

# ruby-on-rails - rails 作为远程文件下载的代理

> ID：14005281
> 
> 赞同：2
> 
> 时间：2012-12-22T18:11:44.470
> 
> 标签：ruby-on-rails, proxy

我在 example.com 上有一个 rails 应用程序。我正在为任何类型的文件（视频、图像……）使用云存储提供商。不，我想让它们可供下载而不暴露实际存储位置的 url。所以我在想一种代理。一个简单的控制器，看起来像这样：

```
data = open(params[:file])
filename = "#{RAILS_ROOT}/tmp/my_temp_file"

File.open(filename, 'r+') do |f|
  f.write data.read
end

send_file filename, ...options... 
```

（代码取自[链接](http://www.ruby-forum.com/topic/98626)）。

重点是我必须先下载文件。所以我想知道是否可以在不先从云存储下载的情况下立即流式传输文件。

最好的菲利普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T23:12:35.483

不久前，我正在研究这个确切的问题，并得出结论，如果不必将文件下载到您的服务器，然后按照您所说的将其传递给客户端，这是不可能的。我建议生成一个签名的、过期的下载链接，每当用户点击您页面上的下载链接时，您就可以将其插入隐藏的 iframe 中。通过这种方式，他们将获得从您的页面下载的体验，而不会使文件不必要地往返您的服务器。

# r - 根据值减少数据集

> ID：14005282
> 
> 赞同：3
> 
> 时间：2012-12-22T18:11:54.097
> 
> 标签：r, dataframe

我有一个数据集

```
dtf<-data.frame(id=c("A","A","A","A","B","B","B","B"), value=c(2,4,6,8,4,6,8,10)) 
```

对于每个 id，值按升序排序

我想减少 dtf 以仅包含每个`id`值超过指定限制的第一行。每行只有一行`id`，那应该是第一个`value`超过指定限制的行。

对于这个例子和`5`dtf 的限制应该减少到：

```
A 6
B 6 
```

这是一个很好的方法吗？

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T18:18:40.457

可以通过以下方式完成`aggregate`：

```
dtf<-data.frame(id=c("A","A","A","A","B","B","B","B"), value=c(2,4,6,8,4,6,8,10))

limit <- 5

aggregate(value ~ id, dtf, function(x) x[x > limit][1]) 
```

结果：

```
 id value
1  A     6
2  B     6 
```

* * *

*更新*：多列的解决方案：

一个示例数据框`dtf2`：

```
dtf2 <- data.frame(id=c("A","A","A","A","B","B","B","B"), 
                   value=c(2,4,6,8,4,6,8,10),
                   col3 = letters[1:8],
                   col4 = 1:8) 
```

解决方案包括`ave`：

```
with(dtf2, dtf2[ave(value, id, FUN = function(x) cumsum(x > limit)) == 1, ]) 
```

结果：

```
 id value col3 col4
3  A     6    c    3
6  B     6    f    6 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T18:36:03.853

这是一个“不错”的选项，使用`data.table`：

```
library(data.table)
DT <- data.table(dft, key = "id")

DT[value > 5, head(.SD, 1), by = key(DT)]
#    id value
# 1:  A     6
# 2:  B     6 
```

而且，本着分享的精神，`sqldf`根据您是否对 SQL 感觉更舒服，使用 which 的选项可能会更好。

```
sqldf("select id, min(value) as value from dtf where value > 5 group by id")
#   id value
# 1  A     6
# 2  B     6 
```

* * *

### 更新：无序的源数据，以及`data.frame`多列

根据您对某些答案的评论，您的“价值”列可能不像您的示例中那样排序，并且您的`data.frame`.

对于这些场景，这里有两种替代方案，一种是`data.table`，我发现它最容易阅读并且很可能是最快的，另一种是这种任务通常需要的典型“拆分-应用-组合”方法。

首先，一些示例数据：

```
dtf2 <- data.frame(id = c("A","A","A","A","B","B","B","B"),
                   value = c(6,4,2,8,4,10,8,6),
                   col3 = letters[1:8],
                   col4 = 1:8)
dtf2 # Notice that the value column is not ordered
#   id value col3 col4
# 1  A     6    a    1
# 2  A     4    b    2
# 3  A     2    c    3
# 4  A     8    d    4
# 5  B     4    e    5
# 6  B    10    f    6
# 7  B     8    g    7
# 8  B     6    h    8 
```

二、`data.table`做法：

```
library(data.table)
DT <- data.table(dtf2)
DT # Verify that the data are not ordered
#    id value col3 col4
# 1:  A     6    a    1
# 2:  A     4    b    2
# 3:  A     2    c    3
# 4:  A     8    d    4
# 5:  B     4    e    5
# 6:  B    10    f    6
# 7:  B     8    g    7
# 8:  B     6    h    8
DT[order(value)][value > 5, head(.SD, 1), by = "id"]
#    id value col3 col4
# 1:  A     6    a    1
# 2:  B     6    h    8 
```

二、base R 常用的“split-apply-combine”方法：

```
do.call(rbind,
        lapply(split(dtf2, dtf2$id), 
               function(x) x[x$value > 5, ][which.min(x$value[x$value > 5]), ]))
#   id value col3 col4
# A  A     6    a    1
# B  B     6    h    8 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-22T18:21:35.177

另一种方法`aggregate`：

```
> aggregate(value~id, dtf[dtf[,'value'] > 5,], min)
  id value
1  A     6
2  B     6 
```

这确实取决于被排序的元素，因为这将是返回的条目`min`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-22T18:54:40.880

`plyr`也可以用and替代`head`：

```
library(plyr)
dtf<-data.frame(id=c("A","A","A","A","B","B","B","B"), value=c(2,4,6,8,4,6,8,10))
limit <- 5
result <- ddply(dtf, "id", function(x) head(x[x$value > limit ,],1) )

    > result
  id value
1  A     6
2  B     6 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-22T18:18:51.260

这取决于您的 data.frame 被排序：

```
threshold <- 5
foo <- dtf[dtf$value>=threshold,]
foo[c(1,which(diff(as.numeric(as.factor(foo$id)))>0)),] 
```

# php - Cakephp - 动态保存多个 jqplot 图像

> ID：14005290
> 
> 赞同：0
> 
> 时间：2012-12-22T18:13:54.273
> 
> 标签：php, javascript, cakephp, jqplot

我需要在单个函数中将多个图表呈现并保存为图像。

我已经创建了渲染图像的函数。我还使用 javascript 和 ajax 制作了一个函数来将图形转换为图像并将其保存在服务器上（还添加水印和文本）。但这适用于您目前正在查看的 1 个图表。如果我想在一个视图中保存多个图表怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T21:36:48.010

由于 JQPLot 图表是在客户端呈现的，您唯一的选择是生成每个图表，可能在隐藏的 div 中，将其转换为 PNG 文件，您可以稍后将其发送到服务器。

或者您可以在运行时使用 js 生成 png 并继续将它们添加到可能是逗号分隔的隐藏变量中。

# sql-server - 电子商务解决方案的数据库架构

> ID：14005295
> 
> 赞同：0
> 
> 时间：2012-12-22T18:14:14.753
> 
> 标签：sql-server

我有很多关于电子商务解决方案数据库的重要问题：

1.  例如，用于验证表单字段（不能插入空值、唯一值、仅输入数字、日期验证等）

    最好的方法是什么：

    a) 在我的数据库中对表字段使用 T-SQL 函数并使用 Try-Catch 处理
    b) 使用 .NET 验证组件
    c) 使用 Ajax 组件
    d) 使用业务方法

2.  如果我使用实体框架，我应该使用存储过程还是可以使用实体框架中的插入、更新和删除方法？

    哪一种是电子商务解决方案的最佳方式？

3.  对于电子商务解决方案，我们应该 3 或 5 步规范化或创建平面表？

4.  对于电子商务解决方案 Linq To Sql 或实体框架？哪一个，为什么？

这些对我来说是非常重要的问题

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T18:22:40.277

我认为正确的答案更微妙。“最佳”方式意味着在沿途的许多地方进行验证。

您应该使用 JavaScript/jQuery 在表单中进行验证。告诉用户所需的值、不正确的格式等。

控制器应该绑定并验证他们收到的值。

服务永远不应该信任 UI。它们还具有 UI 永远无法拥有的附加信息：有效性的业务规则。这些取决于上下文并且可能会改变。让业务规则的执行由中间层服务完成。

Validating in the database, using constraints like UNIQUE, triggers or stored procedures, should be the last resort and only used if the database is shared by several applications. I wouldn't want to wait until I was persisting data to find out that it was invalid. The earlier you can inform a user, the better.

# java - WebSpec (Watij) 无法点击按钮

> ID：14005299
> 
> 赞同：0
> 
> 时间：2012-12-22T18:14:35.210
> 
> 标签：java, watij

我正在开发一个利用 WebSpec 的简单应用程序。我正在使用 mozilla() 浏览器。现在，有一页我想将一些文本注入到输入中，然后单击一个值为“提交”的按钮。该页面已正确加载，所有标签都存在并且可以访问。唯一的麻烦是，每次 WebSpec 尝试访问它时，“提交”按钮都不起作用。即使我自己单击它也无法使其工作。页面需要重新加载。

这是表单的代码：

```
<form action="" method="post" name="theForm" id="theForm" onsubmit="get_search_results(); return false;">
  <table cellpadding="0" cellspacing="10" style="text-align:left;margin:auto;" >
    <tr>
      <th valign="top">Enter Text: </th>
      <td valign="top"><input type="text" name="theText" id="theText" class="box"  value="" />
      <br />
      </td>
      <td valign="top">
        <select name="its-name" class="box" >
                //some options
        </select>
      </td>
      <td valign="top"><input type="button" value="Submit" class="button-of-color" onclick="get_the_results();"  /></td>
      <td valign="top"><a href="url" class="button-of-color">A Link</a></td>
    </tr>
  </table>
  <div id="theResults"></div>
</form> 
```

这是我用来执行上述操作的代码（XTend 代码）：

```
spec.open(theUrl)
val keywordBox = spec.find.input().with.name("theText")
val proceedBox = spec.find.input().with.type("button").with.value("Submit")
keywordBox.set.value(theText)
proceedBox.click 
```

输入文本字段获取其值，但按钮（即使它被单击）不会执行脚本。正如我所说，即使手动单击也没有任何效果。另一方面，我可以更改它的值和其他属性。

我不知道为什么会发生这种情况以及罪魁祸首是什么。而且由于我使用 Watin 在 .NET 中编写的另一个应用程序运行良好，我相信它应该可以运行。

在此先感谢您的帮助。:)

**编辑：**只是`mozilla`改变`ie`似乎正在解决问题。我想这是一个应该由开发人员修复的错误。我会问他们。我不喜欢的是，这就是我从 .NET 切换到 Java 的原因——我不必移植应用程序。

与此同时，我仍在寻找解决方法......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T08:35:27.897

我在 IE 上遇到了同样的问题，并添加了一个 while 循环来检查我设置的文本字段是否已完成，[不是修复，是的，一个肮脏的解决方法]

前任：

```
 ie.textField(name, "email").set("xyz@gmail.com");
    while (ie.textField(name, "email").value().isEmpty())
        ;       
    ie.button(name, "Login").click(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-04-09T06:48:09.783

这条线可能是错误的..

```
val proceedBox = spec.find.input().with.type("button").with.value("Submit") 
```

试试这个 ..

```
val proceedBox = spec.find.input().with.type("submit").with.value("Submit") 
```

# php - 灵活地将数据从一个对象传递到另一个对象，这是真的吗？

> ID：14005300
> 
> 赞同：0
> 
> 时间：2012-12-22T18:14:41.490
> 
> 标签：php, oop

我有两个对象，我需要将一些数据从一个对象传递到另一个对象。我用于那个 getter 和 setter。将来我会有很多这样的对象，我不喜欢使用 getter 和 setter 的解决方案，因为我必须编写太多代码。

有没有办法灵活地做到这一点？例如，使用一些映射来了解需要使用哪些方法将数据设置到另一个对象或类似的东西？是的，我写的是 PHP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-20T15:34:31.707

您可以包装您的复制功能，以便代码保持可读性。

像这样的东西：

```
class DataHelper {

    public static function copyData($objA, $objB) {
        $objB->setAnything( $objA->getAnything() );
    }

}

$foo = new yourClass();
$bar = new yourClass();

DataHelper::copyData($foo, $bar); 
```

此外，根据复制操作，这是“DRY”

我知道我们在这里使用了您想要阻止的 getter 和 setter，但是在定义数据时，您不会一遍又一遍地重复 getter 和 setter 来生成数据。这将仅由辅助方法完成一次（当然也可以是一个不包含在类中的单个函数）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:20:25.893

您可以将一个对象分配给一个 PHP 变量，然后只传递这个单个变量。变量中公开可见的属性在传递后将可见——简单！

# wordpress - 在 wp-admin 之后登录并重定向

> ID：14005301
> 
> 赞同：2
> 
> 时间：2012-12-22T18:14:55.080
> 
> 标签：wordpress

这个想法是否可行？

如果管理员用户从[http://domain.ltd/wp-admin](http://domain.ltd/wp-admin)登录 wp-admin 面板；我们可以重定向到一些外部页面，比如[http://domain.ltd/my-newadmin](http://domain.ltd/my-newadmin)吗？这可能吗 ？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T21:11:50.857

这可以使用 filter [`wp_login`](http://adambrown.info/p/wp_hooks/hook/wp_login)。`administrator`在此示例中，如果用户具有此能力，则会发生重定向。

```
add_action( 'wp_login', 'so_14005301_redirect_admin_login', 10, 2 );

function so_14005301_redirect_admin_login( $user_login, $user )
{
    if( array_key_exists( 'administrator', $user->caps ) )
    {
        wp_redirect( site_url( 'new-admin/', 'http' ), 301 );
        exit;
    }
} 
```

* * *

**代码参考：**

*   功能[`site_url`](http://codex.wordpress.org/Function_Reference/site_url)
*   [`wp_login`](http://core.trac.wordpress.org/browser/tags/3.5/wp-includes/user.php#L64)钩
*   功能[`array_key_exists`](http://php.net/manual/en/function.array-key-exists.php)

* * *

**变量引用：**函数回调接收到
的参数内容：`$user`

```
WP_User Object
(
    [data] => stdClass Object
        (
            [ID] => 1
            [user_login] => my_name
            [user_pass] => $P$BAdksWhVu4gZlZPZnv0m/VuUjsS3/Z0
            [user_nicename] => my_name
            [user_email] => email@gmail.com
            [user_url] => 
            [user_registered] => 2012-12-15 12:12:20
            [user_activation_key] => 
            [user_status] => 0
            [display_name] => my_name
        )

    [ID] => 1
    [caps] => Array
        (
            [administrator] => 1
        )

    [cap_key] => wp_capabilities
    [roles] => Array
        (
            [0] => administrator
        )

    [allcaps] => Array
        (
            [switch_themes] => 1
            [edit_themes] => 1
            [activate_plugins] => 1
            [edit_plugins] => 1
            [edit_users] => 1
            [edit_files] => 1
            [manage_options] => 1
            [moderate_comments] => 1
            [manage_categories] => 1
            [manage_links] => 1
            [upload_files] => 1
            [import] => 1
            [unfiltered_html] => 1
            [edit_posts] => 1
            [edit_others_posts] => 1
            [edit_published_posts] => 1
            [publish_posts] => 1
            [edit_pages] => 1
            [read] => 1
            [level_10] => 1
            [level_9] => 1
            [level_8] => 1
            [level_7] => 1
            [level_6] => 1
            [level_5] => 1
            [level_4] => 1
            [level_3] => 1
            [level_2] => 1
            [level_1] => 1
            [level_0] => 1
            [edit_others_pages] => 1
            [edit_published_pages] => 1
            [publish_pages] => 1
            [delete_pages] => 1
            [delete_others_pages] => 1
            [delete_published_pages] => 1
            [delete_posts] => 1
            [delete_others_posts] => 1
            [delete_published_posts] => 1
            [delete_private_posts] => 1
            [edit_private_posts] => 1
            [read_private_posts] => 1
            [delete_private_pages] => 1
            [edit_private_pages] => 1
            [read_private_pages] => 1
            [delete_users] => 1
            [create_users] => 1
            [unfiltered_upload] => 1
            [edit_dashboard] => 1
            [update_plugins] => 1
            [delete_plugins] => 1
            [install_plugins] => 1
            [update_themes] => 1
            [install_themes] => 1
            [update_core] => 1
            [list_users] => 1
            [remove_users] => 1
            [add_users] => 1
            [promote_users] => 1
            [edit_theme_options] => 1
            [delete_themes] => 1
            [export] => 1
            [administrator] => 1
        )

    [filter] => 
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:42:03.123

为此，我会使用 Peter 的登录重定向插件。很棒（正如插件评级所暗示的那样）。

[http://wordpress.org/extend/plugins/peters-login-redirect/](http://wordpress.org/extend/plugins/peters-login-redirect/)

# c - 当读取更多字符时，'ftell()' 返回值是否保证更大？

> ID：14005303
> 
> 赞同：0
> 
> 时间：2012-12-22T18:15:03.753
> 
> 标签：c, gcc, ftell

我明白，在仔细阅读[cplusplus.com](http://cplusplus.com)的 C 库参考之后，“*对于文本流，数值*[由 ftell() 返回]*可能没有意义*”

我的问题是：这是否意味着我不能**绝对**确定当我读取 3000 个字符时返回的值会大于仅读取 3 个字符时返回的值？

提前致谢，

若昂席尔瓦。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:20:51.393

来自 C 标准：

> **7.21.9.4`ftell`函数**
> *概要*
> `#include <stdio.h>`
> `long int ftell(FILE *stream);`
> *描述*
> 该`ftell`函数获取stream指向的流的文件位置指示符的当前值。对于二进制流，该值是从文件开头开始的字符数。**对于文本流，其文件位置指示符包含未指定的信息，`fseek`函数可使用该信息将流的文件位置指示符返回到`ftell`调用时的位置；两个这样的返回值之间的差异不一定是衡量写入或读取字符数的有意义的量度。**

（强调我的）

我认为这很清楚，但如果没有，请发表评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:18:48.247

是的。如果`ftell()`的数值没有意义，那么两个这样的值之间的关系也没有意义。据推测，图书馆文档的措辞允许文件系统使用某种形式的内部记录，这些记录可能不会按递增顺序编号。

OTOH，我还没有看到值不是从文件开始的字节偏移量的系统。在某些系统 *（如 Windows 和 DOS）上，对两个字符的行尾进行了调整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T18:22:57.250

不。这意味着例如当文件位置位于文件末尾时`ftell` *，文本流返回的值可能不是文件中的实际字节数。*这是由于不同的行尾约定以及如何在输入中处理这些约定。因此，从本质上讲，您不应该对`ftell`值进行数学运算，例如将它们彼此相减，甚至不应该减去 0 来计算从文件开头到当前位置的字节数。

这意味着返回的值仅适用于*将文件位置*指示器重新定位到获得的相同位置。

# php - 如果有其他帮助，请使用 Wordpress php。在 echo 中显示 php 和 html

> ID：14005306
> 
> 赞同：-2
> 
> 时间：2012-12-22T18:15:16.890
> 
> 标签：php, wordpress, if-statement

我需要帮助才能让这个 if else 语句正常工作。我在网站上显示了 HTML，但我也需要 php 工作。我不知道在另一个回声中做一个回声的方法（这是不受欢迎的）。任何建议都会有所帮助！

```
code
<?php
if ( is_user_logged_in() ) {echo "
<div id='fixedbar'>
<div id='boxfloat'>
<div id='header'>
<img src='http://s3.amazonaws.com/punchtab-static/nd/images/favicon.ico' id='favicon'       border='0' onerror='imageNotFound(this, '//s3.amazonaws.com/punchtab-  static/nd/images/bar/shield.png')' onload='imageFound(this)' style='visibility: visible;'>
</div>
<p>
Rewards
<div id='points'>
<div id='user'>
echo 'cosmo_avatar( get_the_author_meta('ID') , 30 )'; ?>
</div>
echo cp_displayPoints($user->ID)'; pts
</div>
<div id='more'>
<a href='/leaderboard'>
<img border='0' src='http://expertcamo.com/wp-content/uploads/2012/12/icon-leaderboard.png' id='leaderboard' alt='Leaderboard' title='Expert Camo Points Leaderboard'</a>

<a href='/catalog'>
<img border='0' src='http://expertcamo.com/wp-content/uploads/2012/12/icon-trophy.png' id='catalog' alt='Catalog' title='Rewards Catalog'</a>

</div>
</p>
<div id='copyright'><a href='/'>
Expert Camo &copy; echo 'date('Y')';</a>
</div>
</div>
</div>
";} else { echo "
<div id='fixedbar'>
<div id='boxfloat'>

</div>
</div>
";}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:28:47.197

未经测试，但基于您应该工作的内容：

```
 <?php
if(is_user_logged_in()){
               echo "
                <div id='fixedbar'>
                <div id='boxfloat'>
                <div id='header'>
                <img src='http://s3.amazonaws.com/punchtab-static/nd/images/favicon.ico' id='favicon'           border='0' onerror='imageNotFound(this, '//s3.amazonaws.com/punchtab-      static/nd/images/bar/shield.png')' onload='imageFound(this)' style='visibility: visible;'>
                </div>
                <p>
                Rewards
                <div id='points'>
                <div id='user'>";
                echo cosmo_avatar( get_the_author_meta('ID') , 30 );
                echo "</div>";

                echo cp_displayPoints($user->ID) . 'pts';

                echo "</div>
                <div id='more'>
                <a href='/leaderboard'>
                <img border='0' src='http://expertcamo.com/wp-content/uploads/2012/12/icon-leaderboard.png' id='leaderboard' alt='Leaderboard' title='Expert Camo Points Leaderboard'</a>

                <a href='/catalog'>
                <img border='0' src='http://expertcamo.com/wp-content/uploads/2012/12/icon-trophy.png' id='catalog' alt='Catalog' title='Rewards Catalog'</a>

                </div>
                </p>
                <div id='copyright'><a href='/'>Expert Camo &copy; ";

                echo date('Y');

                echo "</a>
                        </div>
                        </div>
                        </div>";

        }
            else{

                    echo "<div id='fixedbar'>
                            <div id='boxfloat'>
                            </div>
                            </div>";

            }

?> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-22T18:21:51.460

我宁愿你加载一个模板而不是回显所有的html，但是，你可以通过退出引号来调用你的回声中的函数，像这样

```
<?php echo 'Some text ... ' . cosmo_avatar(get_the_author_meta('ID'), 30) . ' and some more text'; ?> 
```

# c# - 如何在 gridview 中实现 adcontrol，以便它显示 30 个项目，然后是广告，然后是 30 个项目，然后是广告

> ID：14005309
> 
> 赞同：1
> 
> 时间：2012-12-22T18:15:32.087
> 
> 标签：c#, gridview, windows-8, microsoft-metro

如何将 adcontrol 添加到我拥有的 gridview 中。（项目页面模板）

这是我使用的数据模板：

```
 <DataTemplate x:Key="Normal">
    <Grid HorizontalAlignment="Left" Width="180" Height="180">
        <Border Background="{StaticResource ListViewItemPlaceholderBackgroundThemeBrush}">
            <Image Source="{Binding Image}" Stretch="UniformToFill" AutomationProperties.Name="{Binding Title}"/>
        </Border>
        <StackPanel VerticalAlignment="Bottom" Background="{StaticResource ListViewItemOverlayBackgroundThemeBrush}">
            <TextBlock Text="{Binding Title}" Foreground="{StaticResource ListViewItemOverlayForegroundThemeBrush}" Style="{StaticResource TitleTextStyle}"
                       Height="40"
                       Margin="15,0,15,0"
                       TextAlignment="Center" />
            <TextBlock Text="{Binding Subtitle}" Foreground="{StaticResource ListViewItemOverlaySecondaryForegroundThemeBrush}" Style="{StaticResource CaptionTextStyle}" TextWrapping="NoWrap" Margin="15,0,15,10"
                       TextAlignment="Center" />
        </StackPanel>
    </Grid>
</DataTemplate> 
```

我用它来展示我的物品，我也想有广告。我如何实现一个广告控件，以便它显示 30 个项目，然后是广告，然后是 30 个项目，然后是广告。（我有添加项目的代码，我只是不知道如何添加广告）。

**编辑** 好的，我已经做了所有我应该做的，但现在它给了我一个错误，即找不到命名空间。

**这是错误：**

```
The name "MyDataTemplateSelector" does not exist in the namespace "using:MyDataSelector" 
```

在我的主页 XAML 代码中，我这样做了：

```
xmlns:selectornamespace="using:MyDataSelector" 
```

这是我的页面资源：

```
<Page.Resources>
    <!-- Collection of items displayed by this page -->
        <CollectionViewSource
        x:Name="itemsViewSource"
        Source="{Binding Items}"/>
    <!-- TODO: Delete this line if the key AppName is declared in App.xaml -->
    <x:String x:Key="AppName">Sample App</x:String>

    <selectornamespace:MyDataTemplateSelector x:Key="Selector" AdTemplate="{StaticResource Ad}" NormalTemplate="{StaticResource Normal}"></selectornamespace:MyDataTemplateSelector>
</Page.Resources> 
```

这是 MyDataSelector 类。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;

namespace MyDataSelector
{
    private class MyDataTemplateSelector : DataTemplateSelector
    {
        public DataTemplate NormalTemplate { get; set; }
        public DataTemplate AdTemplate{ get; set; }
        protected override DataTemplate SelectTemplateCore(object item, DependencyObject container)
        {
            if (item is TestApp.Mainpage.NormalData)
                return NormalTemplate
            if (item is TestApp.Mainpage.AdData)
                return AdTemplate;

            return SelectTemplateCore(item, container);
        }
    }
} 
```

NormalTemplate 和 AdTemplate 位于 StandardStyles.xaml

任何帮助将非常感激！谢谢和圣诞快乐

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:53:17.650

使用[数据模板选择器](http://diptimayapatra.wordpress.com/2012/07/24/data-template-selector-in-windows-8-metro-xaml-app/)，然后检测该项目是否只是一个虚拟的“广告”项目，然后显示添加数据模板而不是标准模板。

您需要在每 30 个项目之后将一个虚拟项目插入到您的数据源中，但是要使其正常工作

# objective-c - 使用 NSString 调用现有对象并调用方法-objective-c

> ID：14005310
> 
> 赞同：0
> 
> 时间：2012-12-22T18:15:44.173
> 
> 标签：objective-c, cocoa

另一个简单的，对你们来说，我的意思是：

我需要在现有对象上调用一个方法，如下所示：

```
[object method]; 
```

但是，对象的名称每次都不同（此代码用于超类，子类都有不同的名称）。所以我想用这样的 NSString 调用对象：

```
NSString *objectName = @"object";
[objectName method]; 
```

我已经阅读了有关 NSClassFromString 的信息（我一直在寻找几个小时），但这不起作用。然后我收到以下错误：“选择器'方法'没有已知的类方法”。

你们知道我做错了什么吗？

提前致谢， 弗兰斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T18:19:11.650

变量的名称仅在编译时才知道。无法从 NSString 中自动获取变量。但是，您可以使用 NSDictionary 并调用该方法，例如：

```
NSDictionary* dict = @{@"object": object, @"obj2": obj2};
NSString* objectName;
[dict[objectName] method]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:19:51.000

C中没有反射，您所能做的就是将对象放入字典或使其成为ivar。

例如：

```
@property (nonatomic,strong) id objectName1; // with ARC
@property (nonatomic,strong) id objectName2;
...
@property (nonatomic,strong) id objectNameN; 
```

然后：

```
NSString* key= @"objectName1"; // objectName1 or whatever
id object= [self valueForKey: key];
[object method]; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-22T18:22:08.747

没有您正在搜索的东西，但您可以通过使用`isKindOfClass`然后执行该方法来防止此错误。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-22T19:06:18.497

如果我正确理解了这一点并且您正在谈论类方法，那么问题是您不能“直接”向您正在创建的类发送消息。你必须使用`performSelector`.

```
SEL method = NSSelectorFromString(@"method");
Class class = NSClassFromString(@"SomeClass");
[(id)class performSelector:method]; 
```

# mongoose - 从我们刚刚保存的实体中获取 id 的最佳方法是什么？

> ID：14005312
> 
> 赞同：1
> 
> 时间：2012-12-22T18:15:46.740
> 
> 标签：mongoose

我想知道是否有办法获取我们刚刚用猫鼬保存的实体的 ID（在 BDD 中自动生成）。

也许保存方法上有回调或其他东西，除了错误回调之外，我在文档上没有找到任何关于它的内容。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:24:15.237

新`_id`创建的文档是在客户端而不是服务器上创建的。所以它实际上在你调用之前就可用了`save`。

```
var newDoc = new MyModel({name: 'foobar'});
console.log(newDoc._id); // logs the assigned _id
newDoc.save(function(err, doc) {
    console.log(doc._id);  // also available here; newDoc._id == doc._id
}); 
```

# .htaccess - 使用 htacces 301 重定向的多语言

> ID：14005318
> 
> 赞同：0
> 
> 时间：2012-12-22T18:17:20.770
> 
> 标签：.htaccess, redirect, http-status-code-301, multilingual

我希望我的网站是多语言的。我做过这样的事情。我使用 htaccess mod_rewrite 到 index.php。例如，当我第一次打开网站时，在 index.php 中我正在做这样的事情

```
header("HTTP/1.1 301 Moved Permanently");
header("Location: http://www.exaple.com/hy");
exit; 
```

它工作正常。但我想知道正确的方法，它对 seo 是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T11:47:04.347

我在 stackoverflow 上的另一个问题中发布了对此的详细答案。这应该可以帮助您入门，如果您有任何更具体的问题，请告诉我：

Stackoverflow：[国际化和搜索引擎优化](https://stackoverflow.com/questions/1828317/internationalization-and-search-engine-optimization/1829730#1829730)

纳特

# objective-c - 如何将objective-c方法设为私有

> ID：14005322
> 
> 赞同：0
> 
> 时间：2012-12-22T18:17:50.113
> 
> 标签：objective-c

> **可能重复：**
> [为什么 Objective-C 不支持私有方法？](https://stackoverflow.com/questions/2158660/why-doesnt-objective-c-support-private-methods)
> [私有方法声明 Objective-C](https://stackoverflow.com/questions/9414410/private-method-declaration-objective-c)

我想做的是将Objective C中特定方法的实现设为私有（使用Java术语）。也就是说，类可以根据需要调用的方法，而不必担心该方法会被子类覆盖。也许这个词是“安全的，不会被覆盖”。

例如，一个对象有多个 init 方法，并且有一个私有的 initialize 方法来进行常见的初始化：

```
- (void) initWithFile:(NSString *)file
{
    if ((self = [super init]) != nil) {
        self.file = file;
        self.url = nil;
        [self initialize]
    }
    return self;
}

- (void) initWithURL:(NSURL *)url
{
    if ((self = [super init]) != nil) {
        self.url = url;
        self.file = nil;
        [self initialize]
    }
    return self;
}

- (void) initialize
{
    ...
} 
```

这是可行的，如果 initialize 没有在 .h 文件中声明，它就会被“保护”而不会被其他类调用。

我遇到了子类的问题（假设以下类是上一个示例的子类）：

```
- (void) initWithFile:(NSString *)file
{
    if ((self = [super initWithFile:file]) != nil) {
        [self initialize];   // my local initializations
    }
    return self;
}

- (void) initialize
{
    ... // my private stuff
} 
```

问题是在这个例子中，基类的initialize方法现在从未被调用，而子类的initialize方法被调用了两次，因为子类的initialize方法覆盖了基类的方法。

我知道我可以在子类中调用 [super initialize]，并在子类的 init 方法中省略调用，但这需要子类知道基类的内部结构。由于子类不需要访问基类的源代码，并且只需要 .h 接口文件，因此完全有理由认为它可以实现初始化方法而不会导致改变行为的不良副作用的基类。

我之所以问这个问题是因为我遇到了一个与未在初始化函数中设置的属性直接相关的问题，只是发现它被子类篡夺了，我花了一些时间来调试它。我想首先防止这种情况发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:30:34.887

Objective-C 中没有这样的东西。你可以做的只是不定义方法。

苹果经常这样做。

```
@interface SomeClass ()
- (void)_someNonPublicMethod;
@end 
```

这是一个类别，它简单地说应该在类中定义什么。您可以在**.m**文件中执行此操作。

就像已经提到的其他一些答案一样，您可以使用 class-dump 找出类实现了哪些方法，然后您可以覆盖这些方法，即使它们是私有的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:19:42.520

objC 中的方法没有 private 或 final 关键字

只是不要将它们包含在标题中...
也许以某种方式将它们命名为__XY左右...

* * *

顺便说一句：在java中，**私有**并不反对覆盖，那只是另一个“副作用”。关键字**final**反对覆盖

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T20:15:28.083

一个相当可靠的解决方案是使用静态 c 方法进行初始化。毕竟所有有效的c都是有效的objective-c。

例如，**CustomSuperclass.h：**

```
#import <Foundation/Foundation.h>
@interface CustomSuperclass : NSObject
@property (nonatomic) NSUInteger integer;
@end 
```

**自定义超类.m：**

```
#import "CustomSuperclass.h"
@implementation CustomSuperclass
@synthesize integer = _integer;
static void initializeInstance(CustomSuperclass *self) {
    self.integer = 9;
}
-(id)init{
    if ((self = [super init])){
        initializeInstance(self);
    }
    return self;
}
@end 
```

**自定义子类.h：**

```
#import "CustomSuperclass.h"
@interface CustomSubclass : CustomSuperclass
@end 
```

**自定义子类.m：**

```
#import "CustomSubclass.h"
@implementation CustomSubclass
// Obviously we would normally use (CustomSubclass *self), but we're proving a point with identical method signatures.
void initializeInstance(CustomSuperclass *self) {
    self.integer = 10;
}
-(id)init{
    if ((self = [super init])){
        // We won't call this classes `initializeInstance()` function.
        // We want to see if this one overrides it's superclasses version.
    }
    return self;
}
@end 
```

现在如果你运行这样的代码：

```
CustomSuperclass *instanceOfSuperclass = [[CustomSuperclass alloc] init];
NSLog(@"superclass integer:%i", instanceOfSuperclass.integer);

CustomSubclass *instanceOfSubclass = [[CustomSubclass alloc] init];
NSLog(@"subclass integer:%i", instanceOfSubclass.integer); 
```

你会看见：

```
superclass integer:9
subclass integer:9 
```

如果子类的版本`initializeInstance()`是子类使用的版本（调用时`[super init]`），那么子类整数将为 10。这证明了`initializeInstance()`超类的方法没有被子类的版本覆盖（至少在超类的范围内） .

**编辑以回应评论：**

我发布了这个答案及其解决方案，不是因为我认为这是解决问题的最佳方法，而是因为它符合问题的规范。问题本质上是，“我如何强制动态语言以静态方式运行，这样我就不必遵循正常的命名/初始化约定？”

处理这种情况的最佳方法是让您的类有一个指定的初始化程序，每个初始化程序都会调用该初始化程序。喜欢：

```
/* Designated initializer */
-(id)initWithFile:(NSString *)file andURL:(NSURL *)url{
    if ((self = [super init])){
        _url = url;
        _file = file;
        // Initialization of new instance code here.
    }
    return self;
}
-(id)initWithFile:(NSString *)file{
    return [self initWithFile:file andURL:nil];
}
-(id)initWithURL:(NSURL *)url{
    return [self initWithFile:nil andURL:url];
} 
```

指定的初始化器几乎适用于所有情况。它们对于`UIView`子类来说有点麻烦，因为 IB`UIView`会`initWithCoder:`在实例化代码`UIView`将/应该调用的地方`initWithFrame:`调用。在这种情况下，可能会编写一个通用方法以在调用后完成`[super initWith...]`以减少代码重复。

覆盖通用初始化方法的名称可能会遇到问题。对于大多数人来说，这是通过默默无闻获得一点安全性的地方，例如：

```
-(void)initialize_CustomUIView{
    // Common init tasks
}
-(id)initWithFrame:(CGRect)frame{
    if ((self = [super initWithFrame:frame])){
        [self initialize_CustomUIView];
    }
    return self;
}
-(id)initWithCoder:(NSCoder *)aDecoder{
    if ((self = [super initWithCoder:aDecoder])){
        [self initialize_CustomUIView];
    }
    return self;
}
-(id)init{
    if ((self = [super init])){
        [self initialize_CustomUIView];
    }
    return self;
} 
```

但是再次，您特别询问了如何禁止自己覆盖通用初始化方法，因此是`static void initializeInstance()`解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T19:28:44.643

在@implementation 中定义或在无名类别中声明的方法不可见，但可以执行。但是，真正的问题是您希望每个实例都有一个初始化方法，但是：

*   您希望这个方法是私有的，但让这个类的用户知道它存在，并且他们应该覆盖它。如何？未来你不会喜欢这样的。
*   您想要覆盖此方法并从另一个覆盖的方法中调用它。这导致子方法的双重执行。

您尝试创建的约定没有意义。您应该给每个初始化方法一个不同的名称，并从 init 中调用每个方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T18:30:38.470

这必须在 .m 文件中：

```
@interface MyClass()

- (void) privateMethod1;

@end

@implementation MyClass

@end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-22T18:24:47.233

看看这个页面它是关于最佳客观 c 代码实践的，包括私有方法:)

[http://ironwolf.dangerousgames.com/blog/archives/913](http://ironwolf.dangerousgames.com/blog/archives/913)

# html - 将文本字符串的不同部分与 div 的左侧和右侧对齐

> ID：14005326
> 
> 赞同：1
> 
> 时间：2012-12-22T18:18:11.050
> 
> 标签：html, css, razor, css-float

我在当前使用剃须刀的项目中添加了一个聊天窗口。我遇到的问题是，当出现新行时，它会将所有内容都向左移动...问题的屏幕截图是![捕获](../Images/8fe53526486886372a168ea059d6ce43.png)红线显示突出显示的文本应右对齐的位置。显示此区域的当前代码看起来像这样：

```
<div id="messages" class="rectangular-area" style="text-align: left; width: 600px;">
<h3>
    Latest received events:
</h3>
 @For Each item In xList
   If item.Contains("System Message") Then
       @<br />@<b style="color: Red">@item.Split("-")(0)  - <b style="color: Black">@item.Split("-")(1) : <b style="color: #8B6508">@item.Split("-")(3)</b></b> </b>
   ElseIf item.Contains("*******@******online.com") Then
       @<br />@<b style="color:#00CDCD">@item.Split("-")(0) <b style="color: Blue">(@item.Split("-")(1)) <b style="color:Black"> : @item.Split("-")(2)</b></b></b>
   ElseIf item.Contains("************") Then
      @<br />@<b style="color:#00CDCD">@item.Split("-")(0) <b style="color: #E066FF">(@item.Split("-")(1)) <b style="color:Black"> : @item.Split("-")(2)</b></b></b>
   ElseIf item.Contains("************") Then
       @<br />@<b style="color:#00CDCD">@item.Split("-")(0) <b style="color: #66CDAA">(@item.Split("-")(1)) <b style="color:Black"> : @item.Split("-")(2)</b></b></b>
   Else
        @<br />@<b style="color:#00CDCD">@item.Split("-")(0) <b style="color: #FFA54F">(@item.Split("-")(1)) <b style="color:Black"> : @item.Split("-")(2)</b></b></b>
   End If
Next
</div> 
```

关于如何实现这一壮举的任何想法？我已经尝试在每种类型的第三个中使用 align-left`<b style>`但这不起作用..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:54:06.090

带有内联样式的标记很难处理，所以这里有一个简单的 HTML 和 CSS 示例，您可以从中学习：

**HTML**

```
<ul>
    <li>
        <strong>User 1</strong>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>        
    </li>
    <li>
        <strong>User 2</strong>
        <p>Duis aute irure dolor in reprehenderit.</p>        
    </li>
    <li>
        <strong>User 1</strong>
        <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>        
    </li>
</ul>​ 
```

**CSS**

```
strong, p {
    display: block;
    width: 50%;
    float: left;
    margin-bottom: 1em;
} 
```

[演示](http://jsfiddle.net/EF2E9/)

# c# - 控制第三方应用并向其子窗口发送消息

> ID：14005328
> 
> 赞同：2
> 
> 时间：2012-12-22T18:18:20.977
> 
> 标签：c#, ui-automation

我正在尝试使用 c# 代码自动化第 3 方应用程序。我知道如何使用类似这样的代码通过代码调用应用程序的主窗口。

```
word = textBox1.Text;
        Process myprocess = new Process();
        myprocess.StartInfo.FileName = @"C:\Users\Public\Desktop\Cambridge Advanced  Learner's Dictionary - 3rd Edition.lnk";
        myprocess.Start(); 
```

但我不知道如何控制其子窗口及其不同选项以及如何将 word 的值发送到其子窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:23:56.143

看看双胞胎：[http ://code.google.com/p/twin/](http://code.google.com/p/twin/)

> Twin 是用于自动化 Windows 应用程序的工具。也就是说，它使您能够像用户一样编写代码来单击按钮、输入文本和查看结果。
> 
> Twin 是在 eBay 开发的，用于对 Windows 软件进行自动功能测试。该设计基于 Web 自动化工具 Selenium/WebDriver，并且可以以类似的方式使用。

# jquery - 将 javascript 转换为 jQuery 以禁用选项选择上的文本框

> ID：14005337
> 
> 赞同：0
> 
> 时间：2012-12-22T18:18:53.553
> 
> 标签：jquery

如果我的“remote_server”选项设置为 no，我目前正在使用 javascript 禁用文本框。这是我现有的代码

**HTML**

```
<select name="remote_server" class="required">
    <option></option>
    <option value="1" <?php if($remote=="1") echo 'selected="selected"'; ?>>Yes</option>
    <option value="0" <?php if($remote=="0") echo 'selected="selected"'; ?>>No</option>
</select> 
```

**Javascript**

```
var e = document.getElementsByName("remote_server")[0]
var strUser = e.options[e.selectedIndex].value;

if ( strUser == 0 ) {
document.getElementsByName("ftp_hostname")[0].setAttribute("disabled", "disabled");
document.getElementsByName("ftp_user")[0].setAttribute("disabled", "disabled");
document.getElementsByName("ftp_password")[0].setAttribute("disabled", "disabled");
document.getElementsByName("ftp_mode")[0].setAttribute("disabled", "disabled");
document.getElementsByName("ftp_port")[0].setAttribute("disabled", "disabled");
document.getElementsByName("ftp_directory")[0].setAttribute("disabled", "disabled");
} 
```

有没有一种简单的方法可以将其转换为 jquery，以便在选择选项时文本框将被启用或禁用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T18:56:08.097

如果您的目标是输入，请尝试这个：

`you can change to select if your html element's name belongs to html's <select> tag`

```
$(document).on('change', 'select[name="remote_server"]', function() {
    if ($(this).val() == "1") {
       $('input[name^=ftp_]').prop("disabled", true);
    } else {
       $('input[name^=ftp_]').prop("disabled", false);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:24:12.963

这样做： -

```
$('input[name=ftp_user]').attr('disabled', 'disabled'); 
```

## 更新：

阅读更多关于**[prop()](http://api.jquery.com/prop/)**和**[attr()](http://api.jquery.com/attr/)**

```
$('input[name^=ftp_]').attr("disabled", "disabled");
$('input[name^=ftp_]').prop("disabled", "disabled");​ 
```

或者

```
$('input[name^=ftp_]').prop("disabled", true);​ 
```

参考**[现场演示](http://jsfiddle.net/SivaCharan/TpBC9/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T18:26:35.793

尝试这个：

```
$('select[name=remote_server]').change(function(){
    var inputs = $('input[name^=ftp_],select[name^=ftp_]');
    $(this).val() == "1" ? inputs.prop("disabled", "disabled") : inputs.removeProp("disabled");
}); 
```

# jquery - jQuery this 和类选择器

> ID：14005338
> 
> 赞同：0
> 
> 时间：2012-12-22T18:18:57.573
> 
> 标签：jquery, jquery-selectors

我有一个投资组合项目的显示，当我单击我希望对象出现时，投资组合代码如下 - div .info 默认设置为 display:none。

```
<div class="portfolio-item tango">
                <div class="info">portfolio info</div>
            </div>
            <div class="portfolio-item truvoz">
                <div class="info">portfolio info</div>
            </div>
            <div class="portfolio-item tt">
                <div class="info">portfolio info</div>
            </div>
            <div class="portfolio-item sow">
                <div class="info">portfolio info</div>
            </div>
            <div class="portfolio-item ih">
                <div class="info">portfolio info</div>
            </div>
            <div class="portfolio-item jmm">
                <div class="info">portfolio info</div>
            </div> 
```

当我使用代码片段测试第一个项目时，它工作正常 -

```
$(".tango").click(function() { $(".tango .info").toggle("fast"); }); 
```

但是我想这样做，例如它以这种方式工作

```
$(".portfolio-item").click(function() { $("this .info").toggle("fast"); }); 
```

这样，它只是这一行代码适用于所有情况......

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:21:28.433

您可以使用`$(selector, context)`：

```
$(".portfolio-item").click(function() { 
    $(".info", this).toggle("fast"); 
}); 
```

或`find`方法：

```
$(".portfolio-item").click(function() { 
    $(this).find(".info").toggle("fast"); 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:21:19.593

试试这个：

```
$(".portfolio-item").click(function() { $(".info",this).toggle("fast"); }); 
```

# php - Strstr 替代品

> ID：14005339
> 
> 赞同：0
> 
> 时间：2012-12-22T18:19:02.520
> 
> 标签：php, html, syntax

strstr() 函数在另一个字符串中搜索第一次出现的字符串。我的问题是，是否有替代 strstr 来搜索所有事件的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:23:31.137

[http://php.net/manual/en/function.substr-count.php](http://php.net/manual/en/function.substr-count.php)可能会为你做。

这些是添加的字节，以使 SO 接受简洁的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:46:04.133

您可以使用`preg_match_all`它来查找与正则表达式模式匹配的所有匹配项。

这将比 strstr [http://php.net/manual/en/function.preg-match-all.php稍微起作用](http://php.net/manual/en/function.preg-match-all.php)

根据您使用的准确程度，`strstr`您将定义您的表达式。

如果需要，一旦确切用途明确，我可以为您提供帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T18:26:30.857

```
<?php
// get last directory in $PATH
$dir = substr(strrchr($PATH, ":"), 1);

// get everything after last newline
$text = "Line 1\nLine 2\nLine 3";
$last = substr(strrchr($text, 10), 1 );
?> 
```

# makefile - Makefile 自动覆盖旧文件

> ID：14005340
> 
> 赞同：1
> 
> 时间：2012-12-22T18:19:07.170
> 
> 标签：makefile

> **可能重复：**
> [如何强制生成文件重建目标](https://stackoverflow.com/questions/816370/how-do-you-force-a-makefile-to-rebuild-a-target)

我正在使用[zedshaw 的 makefile](http://c.learncodethehardway.org/book/ex28.html#makefile)的略微修改版本，但是当我运行它时，它不会重新编译`.o`文件。

我只花了 2 个小时进行调试，却发现 make 正在查看现有的目标文件，而根本没有重新编译它们。

`$(OBJECTS)`将来如何强制make重新编译？有没有办法在不添加`clean`目标之前做到这一点`all`？

**编辑：**为清楚起见：如果源代码中的某些内容已更改，Make 应该会自动重新编译，这不适用于，`$(OBJECTS)`所以我需要强制重新编译它们或找出它为什么不自己这样做。

**编辑 2：**在复制整个文件夹并在不同时间对其进行比较后，我意识到 make 正确地看到了除一个依赖项之外的所有依赖项。问题出在以下几点：

```
tests: LDLIBS += $(TARGET)
tests: $(TESTS) 
```

Make 无法将事物识别`LDLIBS`为依赖项，因此我添加了：

```
$(TESTS): $(TARGET) 
```

这解决了这个问题。由于 Jens 在评论中称它为已接受，因此我将他的回答标记为已接受。

```
CFLAGS=-g -O2 -Wall -Wextra -Isrc -rdynamic -DNDEBUG $(OPTFLAGS)
LDLIBS=-ldl $(OPTLIBS)
PREFIX?=/usr/local

SOURCES=$(wildcard src/**/*.c src/*.c)
OBJECTS=$(patsubst %.c,%.o,$(SOURCES))

TEST_SRC=$(wildcard tests/*_tests.c)
TESTS=$(patsubst %.c,%,$(TEST_SRC))

TARGET=build/liblcthw.a
SO_TARGET=$(patsubst %.a,%.so,$(TARGET))

# The Target Build
all: cls $(TARGET) $(SO_TARGET) tests

dev: CFLAGS=-g -Wall -Isrc -Wall -Wextra $(OPTFLAGS)
dev: all

$(TARGET): CFLAGS += -fPIC
$(TARGET): build $(OBJECTS)
    ar rcs $@ $(OBJECTS)
    ranlib $@

$(SO_TARGET): $(TARGET) $(OBJECTS)
    $(CC) -shared -o $@ $(OBJECTS)

build:
    @mkdir -p build
    @mkdir -p bin

# The Unit Tests
.PHONY: tests
tests: LDLIBS += $(TARGET)
tests: $(TESTS)
    sh ./tests/runtests.sh

valgrind:
    VALGRIND="valgrind --log-file=/tmp/valgrind-%p.log" $(MAKE)

# The Cleaner
clean: cls
    rm -rf build $(OBJECTS) $(TESTS)
    rm -f tests/tests.log
    find . -name "*.gc*" -exec rm {} \;
    rm -rf `find . -name "*.dSYM" -print`

# The Install
install: all
    install -d $(DESTDIR)/$(PREFIX)/lib/
    install $(TARGET) $(DESTDIR)/$(PREFIX)/lib/

# The Checker
BADFUNCS='[^_.>a-zA-Z0-9](str(n?cpy|n?cat|xfrm|n?dup|str|pbrk|tok|_)|stpn?cpy|a?sn?printf|byte_)'
check:
    @echo Files with potentially dangerous functions.
    @egrep $(BADFUNCS) $(SOURCES) || true

# Clear screen for unspammy terminals
cls:
    clear 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:33:27.327

> 如何强制 make 重新编译？

两种选择：

1.  `touch`所有源文件
2.  如果您使用的是 GNU make，`make --always-make`

# excel - 复制多个工作表列中的纯值单元格并粘贴到一列中

> ID：14005341
> 
> 赞同：2
> 
> 时间：2012-12-22T18:19:09.810
> 
> 标签：excel, vba

我有多个电子表格，我需要在一个特别命名的工作表上复制从“S4”开始的列，并且我只需要该列中包含数据的单元格（从 S4 开始以及它下面的所有内容）。

我需要复制该数据并将其粘贴到我的“主”电子表格中，从特定工作表的 A2 开始。我可以用一个电子表格来做到这一点，但是我遇到的问题我需要 VBA 来找到 A 列中最后一个有值的单元格，然后开始将新数据粘贴到它下面的单元格中，等等......否则，当它查看其他电子表格，它只是覆盖了我的主电子表格中的数据。

您会注意到 S4:S2000 的指定范围 - 它的目的是用于单个电子表格，它工作得很好，因为我从来没有超过 2000 年的数据，但我真的只需要它来查找单元格值并抓取这些值。

这是我遇到麻烦的代码块。我希望它从 A2 开始搜索（跳过列标题），查找最后一个具有值的单元格，然后将值从 S4 开始的单元格粘贴到另一个工作表上。

```
On Error Resume Next
        Set wbkCS = Workbooks.Open(strCutSheetFile(i))
        On Error GoTo 0
    If Not wbkCS Is Nothing Then
        With wbkVer.Sheets("Cutsheets")
             .Range(.Cells(2,1)).End(xlUp).Row = wbkCS.Worksheets("Cut Sheet").Range("S4:S2000").Value 
```

我不得不稍微调整一下你的，因为我正在处理受保护的文件，但这有效：

```
Set copyRng1 = Worksheets("Cutsheets").Range("A2")

If copyRng1 = "" Then
        wbkCS.Worksheets("Cut Sheet").Range("S4:S2000").Locked = False
        wbkCS.Worksheets("Cut Sheet").Range("S4:S2000").Copy Destination:=wbkVer.Worksheets("Cutsheets").Range("A2")
    Else
        wbkCS.Worksheets("Cut Sheet").Range("S4:S2000").Copy Destination:=wbkVer.Worksheets("Cutsheets").Range("A" & wbkVer.Worksheets("Cutsheets").Range("A65536").End(xlUp).Row + 1)

    End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T20:47:56.410

以下是如何准确获取 S 中填充的行的方法：

```
Dim StrRange As String

. . .

'Get range
strRange = "S4:S" & Worksheets(wkShtIndex).UsedRange.Columns("S:S").Rows.Count  
'Do something with range
Worksheets(wkShtIndex).Range(strRange) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:16:52.707

这是一个可以将您推向正确方向的示例...

假设我想`Sheet1`使用`S4:S2000`工作簿中所有其他工作表中的数据来聚合我的数据。

```
Sub CopyAndStack()
    Dim wkShtIndex As Integer, copyRng As Range

    Set copyRng = Worksheets(1).Range("A2")

    For wkShtIndex = 2 To Worksheets.Count
        If copyRng = "" Then
            Worksheets(wkShtIndex).Range("S4:S2000").Copy Destination:=copyRng
        Else
            Worksheets(wkShtIndex).Range("S4:S2000").Copy Destination:=Range("A" & copyRng.End(xlDown).Row + 1)
        End If
    Next wkShtIndex
End Sub 
```

我检查是否`A2`为空，如果是，我粘贴第一批数据。

如果`A2`不是空的，我会在 A 列中获取下一个空单元格并将其粘贴到那里。

# c# - 用 C# 创建的 Excel 文件无法打开

> ID：14005349
> 
> 赞同：-3
> 
> 时间：2012-12-22T18:20:06.907
> 
> 标签：c#, export-to-excel, excel-2010

使用 C# 创建 Excel 文件后，我试图打开该文件，并得到以下异常：

**“excel无法打开文件，因为文件格式或文件扩展名无效。验证文件没有损坏，文件扩展名与文件格式匹配。”**

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:48:13.960

没有任何代码并通过阅读错误，我怀疑您在保存文件时在路径中指定了错误的扩展名，这是一个常见错误：

```
string path = "C:\\excelfile.xls"; //or xlsx as said @JMK 
```

# c# - ycbcr 颜色范围

> ID：14005352
> 
> 赞同：0
> 
> 时间：2012-12-22T18:20:16.467
> 
> 标签：c#, aforge

我正在尝试使用 Aforge.Net 检测肤色。我发现了一些肤色值，但它们是整数值

> Y 在 [0,255]
> Cb 在 [80,135]
> Cr 在 [131,185]
> 我只需要将它们转换为 Aforge.Net 中的范围，其中
> Y 在 [0,1]，
> Cb 在 [-0.5， 0.5]，
> Cr 在 [-0.5,0.5]。

那么如何将范围转换为这些范围？

# image-processing - 如何处理用相机拍摄的图像中的噪点

> ID：14005354
> 
> 赞同：0
> 
> 时间：2012-12-22T18:20:42.397
> 
> 标签：image-processing, noise, noise-reduction

假设有一个黑盒子，里面没有光，而这个盒子里有一个摄像头。相机开始捕捉，它捕捉到的什么都没有——盒子里到处都是纯黑色。但是由于各种类型的噪声（热噪声、量化噪声等），捕获帧的大小会有所不同。我想在软件方面减少/消除这些噪音的影响，以便在完全隔离的黑匣子中，所有捕获的帧都将完全相同。处理后的分辨率、深度、颜色等属性都无关紧要，最终捕获的帧的准确性/质量无关紧要。任何类型的过滤、下采样等每个解决方案都是可以接受的。参考是黑匣子，帧应尽可能相同。

有什么建议么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:36:15.133

去除噪声的方法有很多，你说的噪声可能是高斯噪声。删除它的最简单方法是在图像上运行高斯模糊，然后使用阈值删除（使值为零）它的值在“a”之下的所有内容，当“a”是你的参数时应该玩一点以找到最合适的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-25T16:05:44.503

好的，这是一个有点有趣的答案，因为你最后写的捕获帧的准确性/质量并不重要，我想说简单的返回黑色软件生成的黑色图像。你可以在没有相机的情况下做到这一点；）

嗯，更严重的是，我认为您想计算接近黑色的平均值。每个额外的样本都会产生较少的影响，并且随着时间的推移会为您的相机创建一个噪点模式。

然后从新捕获的图像中减去该图像。

或者返回一个统计结果，以便您返回值和该值的概率。

# parsing - 在 WMB 中处理回退消息的最佳方法

> ID：14005357
> 
> 赞同：0
> 
> 时间：2012-12-22T18:20:48.447
> 
> 标签：parsing, websphere, ibm-mq, websphere-8

我的队列管理器有一个回退队列。

我想构建一个**消息流**来读取这个队列，如果有任何消息进入队列，它应该接收消息并将**其包装在特殊格式的 XML**消息中，并将其放入获取已处理异常的正常异常队列中。

但是，进入回退队列的消息可以是任何格式，我必须制作一个 xml，该消息将成为一个字段。

那么，对于我的流程（关于 MQMD 属性，如 CCSID、格式等）以及我应该使用哪个**解析器**（DFDL 或 BLOB 或 MRM），什么可能是**最佳设置？**

 **好心劝告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T19:23:32.090

由于您不知道什么样的消息到达了回退队列，因此您不应该使用特定的解析器（如 XMLNSC 等）对其进行解析。可能您在 MQInput 上设置的通用参数越多，您就越能在流程中进一步确定消息中的内容。

因此，我将从默认消息域 (BLOB) 开始，并保持其他参数不变。将一些日志记录节点（例如 Trace 节点）连接到 Catch 和 Failure 终端。将 Out 终端连接到包含 ESQL 的 Compute 节点以确定错误类型并决定进一步的操作（例如，路由到标签）。然后在每个标签中决定应该将消息的哪一部分映射到最终异常消息和映射。

如果您需要结果消息中当前位于回退队列中的消息的那些 MQMD 属性，只需提取值并将/连接/任何内容放入结果消息 XML 部分。我认为您不应该将 MQMD（和其他）标头按原样复制到结果消息，因为这些可能是原始消息进入回退队列并且您的结果消息将再次到达那里的原因。从头开始构造生成的消息头。

如果在执行这些转换时发生了不好的事情，您将在 Trace 中看到问题。然后适当修改错误处理逻辑，避免以后出现错误处理。**

# javascript - 你知道闪存条码扫描仪吗？

> ID：14005359
> 
> 赞同：0
> 
> 时间：2012-12-22T18:20:54.470
> 
> 标签：javascript, flash

对于我的网络项目，我需要一个 Flash 条码扫描仪。

我做了一些研究，但没有找到任何可用的软件。

您知道用 Flash 编写的用于扫描条形码的资产吗？我可以将哪些内容包含到 html 文档中并使用 JavaScript 访问？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:25:42.130

只是google了一下。

[http://zxing.riaforge.org/](http://zxing.riaforge.org/)

这是一个 flex 项目，但我认为您可以轻松地将生成的 SWF 或 AS3 文件嵌入到您的 flash 项目中。

# php - 正则表达式 - 查找价格

> ID：14005360
> 
> 赞同：-2
> 
> 时间：2012-12-22T18:20:54.800
> 
> 标签：php, regex

我正在研究一个正则表达式，它将以不同的格式获取价格，因为我不知道我将以哪种格式获取字符串，所以我试图涵盖尽可能多的变化

这是我想出的

```
\$\s*?(\d+\.?\d*?)+|usd\s*?(\d+\.?\d*?)+|(\d+\.?\d*?)\s*?usd+|(\d+\.?\d*?)\s*?dollars?+|dollars?\s*?(\d+\.?\d*?)+|(\d+\.?\d*?)\s*?bucks?+|bucks?\s*?(\d+\.?\d*?)+ 
```

我已经用几个例子尝试了上面的方法，到目前为止还没有失败。

谁能想到更好的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:29:04.637

这里的真正答案将通过数据的**规范化**来实现。首先删除除数字、点和（如果您期望为负值）连字符以外的所有字符。然后你将有一个可以用作数字的字符串。当您有一些可用的测试数据时，请先尝试规范化，然后再尝试编写正则表达式。代码不仅更容易编写，而且运行速度也更快！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:31:46.517

我建议对每个变体使用单独的表达式，并按顺序测试它们（最有可能首先测试它们），应用责任链模式。

优点是可维护性。当您需要支持新的变体时（考虑到您事先并不知道所有可能的变化），只需将另一个成员添加到链中，而不是摆弄您现在所构建的奥术复杂性。

# terminal - 如何在applescript终端中使用空格更改目录？

> ID：14005362
> 
> 赞同：5
> 
> 时间：2012-12-22T18:21:09.290
> 
> 标签：terminal, applescript, iphoto

我是applescripts的新手，我正在尝试自动化一个过程，但是当目录中有空格时，如何通过脚本更改目录？我的命令应该是正确的，但语法错误不断弹出：

```
Expected “"” but found unknown token. 
```

这是我的脚本：

```
tell application "Terminal"
activate
do script "cd ~/Pictures/iPhoto\ Library"
end tell 
```

我不明白哪里错了。它在我的终端上运行良好。

谢谢一群人！！

更新：这个效果最好！！

```
# surround in single quotes
tell application "Terminal"
    activate
    do script "cd  '/Users/username/Pictures/iPhoto Library'"
end tell 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-22T18:49:43.303

有几种方法。

```
# escape the quotes with a backslash. AND Escape the first backslash for Applescript to accept it.
tell application "Terminal"
    activate
    do script "cd ~/Pictures/iPhoto\\ Library"
end tell

# surround in double quotes and escape the quotes with a backslash. 
tell application "Terminal"
    activate
    do script "cd \"/Users/username/Pictures/iPhoto Library\""
end tell

# surround in single quotes using quoted form of 
tell application "Terminal"
    activate
    do script "cd " & quoted form of "/Users/username/Pictures/iPhoto Library"
end tell
# surround in single quotes
tell application "Terminal"
    activate
    do script "cd  '/Users/username/Pictures/iPhoto Library'"
end tell 
```

另外，当您在整个路径上使用引号时，我不认为波浪号会扩大。因此，您将需要以另一种方式获取用户名。

例子：

```
# inserting the user name. And surrond in brackets so the name and path are seen as one string before the quotes are added
set whoami to do shell script "/usr/bin/whoami"
tell application "Terminal"
    activate
    do script "cd /Users/" & quoted form of whoami & "/Pictures/iPhoto\\ Library"
end tell

tell application "System Events" to set whoami to name of current user
# inserting the user name. And surrond in brackets so the name and path are seen as one string before the quotes are added
tell application "Terminal"
    activate
    do script "cd /Users/" & quoted form of (whoami & "/Pictures/iPhoto Library")
end tell 
```

如您所见，有不止一种方法可以做到这一点。

或者只是引用目录部分。

例子。

```
tell application "Terminal"
    activate
    do script "cd ~" & quoted form of "/Pictures/iPhoto Library"
end tell 
```

# javascript - 将表单目标设置为 _blank 会导致 2 个窗口打开

> ID：14005363
> 
> 赞同：0
> 
> 时间：2012-12-22T18:21:12.473
> 
> 标签：javascript, html, forms

我正在使用带有 Paypal 按钮的以下脚本，它运行良好，除了 2 个窗口向 Paypal 打开，而不是一个。如果有人能帮助我打开 1 个窗口，我将不胜感激。这是一个 asp.net 项目的内部。页面上的源中有一个表单。

```
function submitFormToPaypal() {
    var formElementsArray = document.getElementsByTagName('FORM');

    if (formElementsArray != null) {
        var formElement = formElementsArray[0];

        document.getElementById('__VIEWSTATE').name = 'NOVIEWSTATE';

        formElement.action = 'https://www.paypal.com/cgi-bin/webscr';
        formElement.setAttribute("target", "_blank");
        formElement.submit();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:59:11.247

如果您在提交或单击提交按钮时调用您的函数，则需要删除 formelement.submit。

如果您显示带有事件处理程序的 HTML，也许我们可以建议如何执行此操作。

# php - PHP WordPress 画廊

> ID：14005368
> 
> 赞同：3
> 
> 时间：2012-12-22T18:21:30.523
> 
> 标签：php, wordpress, html-lists, gallery

我正在尝试使用滑块来展示我在帖子中的图像。我目前已经完成了所有设置，但我只有一个 li 元素可以显示所有三个图像。我想要三个 li 元素，每个元素显示一个图像，但我不知道如何自动隔离每个图像。任何帮助将不胜感激！

您可以在此处查看当前状态：http: [//mksgear.com/shop/test-product/](http://mksgear.com/shop/test-product/)

这就是我的代码的样子：

```
<ul class="slides">

  <li class="slide">

<?php if ( has_post_thumbnail() ) : ?>

    <?php echo do_shortcode('[gallery option1="value1"]'); ?>

<?php else : ?>

    <img src="<?php echo woocommerce_placeholder_img_src(); ?>" alt="Placeholder" />

<?php endif; ?>

  </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:09:25.347

我不确定我是否正确理解了你的问题，但我会给出一个答案。如果我误解了您要做什么，请为我澄清一下，我会更新我的答案。

您可以`itemtag="li"`在图库短代码中使用将每个图像包装在`li`. 您需要删除您`<li class="slide">`的代码行，并且可能使用 jQuery 将“幻灯片”类添加回生成的`li`标签。所以你可以做这样的事情：

`:`此外，在 if/else 语句中 使用时，您的代码是否会呈现图库？

```
<script>
jQuery(document).ready(function() {
    jQuery("#slides li").addClass("slide");
});
</script>

<ul class="slides">

    <?php if ( has_post_thumbnail() ) { ?>

        <?php echo do_shortcode('[gallery itemtag="li" option1="value1"]'); ?>

    <?php } else { ?>

        <img src="<?php get_bloginfo( 'stylesheet_directory' ); ?>/images/thumbnail-default.jpg" />

    <?php } ?>

</ul> 
```

将此添加到您的页脚，您可以将其添加到与 jQuery 相同的 document.ready 中以添加类幻灯片。只需将其复制并粘贴到`jQuery("slides li").addClass("slide");`. 如果需要，您可以在此调用中调整高度、宽度或任何其他选项。这有望奏效。

```
jQuery("#slides").advancedSlider({
width: 900, 
height: 460, 
responsive: 1, 
skin: 'light-round'
}); 
```

# javascript - 在 Rails 中显示 Flash 通知的最佳方式

> ID：14005381
> 
> 赞同：2
> 
> 时间：2012-12-22T18:23:10.433
> 
> 标签：javascript, jquery, ruby-on-rails, ruby, erb

我在 Rails 和 Devise 中使用通知，想知道显示它们的最佳方式是什么？

在我的应用程序中，我也有它，所以当用户保存帖子时，它使用 Ajax 保存它，我使用 jQuery 来显示通知。

对于我使用的所有通知：

```
<% flash.each do |key,msg| %>
    <div class="message" id="<%= key %>">
        <div class="message-inner">
            <%= content_tag :div, msg %>
            <a class="dismiss">x</a>
        </div>
    </div>
<% end %> 
```

代码是：

```
$("#notice").html("Saved."); 
```

我希望它是一个闪光通知，以便它从顶部滑下，几秒钟后，它又滑回来。

由于我在保存帖子时使用 jQuery 作为通知，而不是使用 Rails 通知，这意味着我必须在 application.html.erb 文件中拥有 a`<div id="notice"></div>`和。`flash.each`

我可以将它们加在一起，这样我只使用一个通知并让它从顶部滑下，然后在几秒钟后滑开吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-23T18:06:41.547

我会默认隐藏通知。然后打电话

```
$('#notice').html("Saved.").slideDown(500).delay(3000).slideUp(500) 
```

您可以将 jQuery 方法中的数字调整为您想要的动画时间。

# sql - Oracle中缺少关键字错误

> ID：14005382
> 
> 赞同：0
> 
> 时间：2012-12-22T18:23:22.227
> 
> 标签：sql, oracle, alter-table

我正在尝试更改 SQL 中的列数据类型，但它给了我缺少关键字错误。我查看了如何在几个地方更改列，他们都给了我这个查询：

我正在使用这个：

```
 ALTER TABLE CARD 
  MODIFY COLUMN Charged NUMBER(4,2); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:33:45.707

COLUMN 关键字是多余的——这应该有效：

```
ALTER TABLE Card MODIFY Charged NUMBER(4,2) 
```

有趣的是，标准 SQL 不支持 MODIFY （直到我去检查 [SQL Syntax](http://savage.net.au/SQL)时我才知道）。根据 SQL 标准（ISO/IEC 9079-2:2003），可以这样写：

### 11.12 `<alter column definition>`(p572)

更改列及其定义。

```
<alter column definition>    ::=   ALTER [ COLUMN ] <column name> <alter column action>

<alter column action>    ::=
           <set column default clause>
     |     <drop column default clause>
     |     <add column scope clause>
     |     <drop column scope clause>
     |     <alter identity column specification> 
```

（并且在 SQL 2003 中，`MODIFY`不是 SQL 关键字）。在这个公式中，关键字`COLUMN`是允许的，但它是可选的。与“真正的”DBMS 不同，它似乎也不允许更改列的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:30:03.583

你缺少括号，你应该省略这个词`COLUMN`：

```
ALTER TABLE CARD MODIFY ( Charged NUMBER(4,2)); 
```

有关如何修改列的示例，请参阅[此文档。](http://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_3001.htm#i2133121)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T18:30:39.117

不要使用“列”作为关键字：

```
ALTER TABLE card
MODIFY charged NUMBER(4,2); 
```

# .net - 使用 Mono Cecil 的类型的默认值

> ID：14005384
> 
> 赞同：1
> 
> 时间：2012-12-22T18:23:28.263
> 
> 标签：.net, reflection, mono, mono.cecil

我有一种方法可以基于反射返回任何类型的默认值，如下所示

```
private object getDefault(Type type) 
{
    object defaultValue = null;
    //I have some specific logics here
    defaultValue = getCustomDefaultValues(type);

    //Value types
    if(defaultValue == Type.Missing && type.IsValueType)  
    {       
         defaultValue=  Activator.CreateInstance(type);  
    }
    //All other types including Ref.        
    return defaultValue == Type.Missing ? "null" : defaultValue;
} 
```

现在我从经典反射转向 Mono Cecil。所以“类型”将变成“类型定义”。问题是**Activator.CreateInstance(type);** 不适用于 TypeDefinition。那么还有其他方法可以找到任何类型的默认值吗？或任何现有的简单方法来获取塞西尔类型的默认值？

# c# - 自动解决温斯多城堡

> ID：14005386
> 
> 赞同：0
> 
> 时间：2012-12-22T18:23:43.240
> 
> 标签：c#, mvvm, dependency-injection, inversion-of-control, castle-windsor

我试图在不同的程序集中分离我的模型、视图和视图模型，并用温莎城堡实例化它们。

我有我的 app.config

```
<components>
  <component id="ViewModel.SomeViewModel" service="TEST.Business.IViewModel, TEST.Business" type="TEST.ViewModel.SomeViewModel, Test.ViewModel" />
  <component id="ViewModel.SomeView" service="TEST.Business.IView, TEST.Business" type="TEST.View.SomeView, Test.View" />
</components> 
```

并通过以下方式解决

```
IoC.Configure(); 
var viewModel = IoC.Resolve<IViewModel>();
var view = IoC.Resolve<IView>();
view.ShowDialog(); 
```

我的静态 IoC 类

```
public static class IoC
{
    private static IWindsorContainer container;

    public static void Configure()
    {

        IResource resource = new ConfigResource("castle");
        container = new WindsorContainer(new XmlInterpreter(resource));
    }

    public static TService Resolve<TService>()
    {
        return container.Resolve<TService>();
    }
} 
```

直到现在真的很简单。

但我很想这样做：

命名必须是这样的：I[someName]ViewModel 和 I[someName]View 然后解析我的 app.config 中的每个组件，因此对于每对 View 和 ViewModel 解析并关联它们。

我想我的问题有很多解决方案，但我不知道要使用哪些关键字。

顺便说一句：I[someName]ViewModel 和 View 是 ofc IViewModels 和 IViews

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T01:05:06.110

使用反射来迭代您要解析的程序集中的类型。您可以`Classes`用于注册。

```
var assembly = Assembly.GetExecutingAssembly(); // Replace with the assembly you want to resolve for.
var exports = assembly.ExportedTypes;
var viewTypes = exports.Where(t => t.GetInterface(typeof(IView).FullName) != null);

foreach (var viewType in viewTypes)
{
    var viewModelType = assembly.GetType(viewType.FullName.Replace("View", "ViewModel"));
    var viewModel = container.Resolve(viewModelType);
    var view = container.Resolve(viewType);
    view.ShowDialog();
} 
```

在您的示例中，我看不到 IViewModel 和 IView 之间的任何依赖关系，因此您的代码没有意义。如果视图模型作为构造函数的参数注入，它将被自动解析。

我不建议使用这种技术。它可能比它需要的更复杂。你确定你真的了解如何使用 IoC 容器/Castle Windsor 吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T07:02:38.843

我认为你做错了。

不要抽象您的视图和视图模型。它没有给你任何好处。因此，问题是架构问题，而不是技术问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T18:39:41.563

一旦你习惯了 Ioc 容器，它们就很棒。通常，您只想从应用程序的主/引导代码中使用您的容器。对我来说，您似乎尝试将容器的解析功能设为静态，以允许在任何地方解析组件。这不应该是必需的。

如果您正在寻找一种以很好的方式绑定视图和视图模型的方法，请查看 caliburn micro。您可以将其与大多数 Ioc 容器结合使用，包括 Windsor

亲切的问候，

马尔维恩。

# html - 每页页脚边距不同

> ID：14005394
> 
> 赞同：0
> 
> 时间：2012-12-22T18:24:50.477
> 
> 标签：html, css, haml, sass, footer

我有网页，我必须在页面底部粘贴页脚。我在这里为你准备了代码：1) [http://jsfiddle.net/6P3Ag/](http://jsfiddle.net/6P3Ag/) 2) [http://jsfiddle.net/bmzgp/](http://jsfiddle.net/bmzgp/)

另请参阅 jsfiddle 上的预览，例如[http://jsfiddle.net/6P3Ag/embedded/result/](http://jsfiddle.net/6P3Ag/embedded/result/)这很重要（高度是另一个）

**但是为什么我在每页的页脚和包装器之间得到不同的页边距顶部？怎么了？**

还有一点页脚代码：

```
.footer{
  position: relative;
  margin: 150px 0 0 0;
  @include gradient-background(bottom, $gr1, $gr2);
  width: 100%;
  height: 144px;
  clear: both;
} 
```

我也使用 sass+haml ......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:08:02.927

我只是快速浏览了一下，但我认为这是您的`wrapper`div 高度的问题。我`height:100%`从两个示例的包装类中删除了，看起来页脚现在在它们之间的大小是一致的。

# java - 我不明白如何使用带有标签的操作栏 sherlock

> ID：14005395
> 
> 赞同：0
> 
> 时间：2012-12-22T18:24:51.943
> 
> 标签：java, android, tabs, actionbarsherlock, fragment

我正在尝试将选项卡添加到操作栏 sherlock，但它一直在崩溃并且无法启动。我应该在 xml 文件中放入什么，我找不到放入其中的内容

MainActivity.java

```
import com.actionbarsherlock.app.ActionBar.Tab;
import com.actionbarsherlock.app.ActionBar.TabListener;
import com.actionbarsherlock.app.*;
import com.actionbarsherlock.view.Menu;
import com.actionbarsherlock.view.MenuInflater;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentTransaction;
import android.util.Log;

public class MainActivity extends SherlockFragmentActivity{

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
       // setContentView(R.layout.activity_main);

        final ActionBar actionBar = getSupportActionBar();
        actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

        ActionBar.Tab tabData = actionBar.newTab();
        tabData.setText("Match Data");
        tabData.setTabListener(new MyTabListener());
        actionBar.addTab(tabData);

      //  tabRed.setTabListener(new TabListener<TabFragment>(this, "tab1", TabFragment.class));
       /* Tab tabComp = actionBar.newTab();
        tabComp.setText("New Competition");
        tabComp.setTabListener(new TabListener<ScoreRedActivity>(this, "B", ScoreRedActivity.class));
        actionBar.addTab(tabComp);*/
       // tabBlue.setTabListener(new TabListener<TabFragment>(this, tabBlue, TabFragment.class));

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu){
        MenuInflater inflater = getSupportMenuInflater();
        inflater.inflate(R.menu.activity_main, menu);
        return true;
    }

    private class MyTabListener implements ActionBar.TabListener{
        @Override
        public void onTabSelected(Tab tab, FragmentTransaction ft){
            if(tab.getPosition() == 0)
            {
                ScoreRedActivity frag = new ScoreRedActivity();
                ft.replace(R.id.textView1, frag);

            }
        }

        @Override
        public void onTabUnselected(Tab tab, FragmentTransaction ft){

        }

        @Override
        public void onTabReselected(Tab tab, FragmentTransaction ft){
        }

    }

} 
```

我的 ScoreRedActivity.java 这是一个片段

```
import com.actionbarsherlock.app.SherlockFragment;

import android.os.Bundle;
import android.app.Activity;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.EditText;

public class ScoreRedActivity extends SherlockFragment {

    EditText t;

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        return inflater.inflate(R.layout.activity_score_red, container, false);
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState){
        t = (EditText) getActivity().findViewById(R.id.weightedRed);
    }

} 
```

activity_score_red.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".ScoreRedActivity" >

    <TextView 
        android:layout_height="wrap_content"
        android:layout_width="wrap_content" 
        android:text="You are presently in Fragment A" 
        android:id="@+id/textView1"/>

    <Button 
        android:layout_height="wrap_content" 
        android:layout_width="wrap_content" 
        android:text="Click me for toast"
        android:id="@+id/button1"/>

</LinearLayout> 
```

这是日志猫

```
12-22 13:21:38.076: E/AndroidRuntime(394): FATAL EXCEPTION: main
12-22 13:21:38.076: E/AndroidRuntime(394): java.lang.RuntimeException: Unable to start activity ComponentInfo{org.say.upscorer/org.say.upscorer.MainActivity}: android.support.v4.app.SuperNotCalledException: Fragment ScoreRedActivity{45f8b1c8 #0 id=0x1020002} did not call through to super.onActivityCreated()
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.os.Looper.loop(Looper.java:123)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.app.ActivityThread.main(ActivityThread.java:4627)
12-22 13:21:38.076: E/AndroidRuntime(394):  at java.lang.reflect.Method.invokeNative(Native Method)
12-22 13:21:38.076: E/AndroidRuntime(394):  at java.lang.reflect.Method.invoke(Method.java:521)
12-22 13:21:38.076: E/AndroidRuntime(394):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-22 13:21:38.076: E/AndroidRuntime(394):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
12-22 13:21:38.076: E/AndroidRuntime(394):  at dalvik.system.NativeStart.main(Native Method)
12-22 13:21:38.076: E/AndroidRuntime(394): Caused by: android.support.v4.app.SuperNotCalledException: Fragment ScoreRedActivity{45f8b1c8 #0 id=0x1020002} did not call through to super.onActivityCreated()
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.support.v4.app.Fragment.performActivityCreated(Fragment.java:1470)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:931)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1088)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:682)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1444)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.support.v4.app.FragmentActivity.onStart(FragmentActivity.java:551)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1129)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.app.Activity.performStart(Activity.java:3781)
12-22 13:21:38.076: E/AndroidRuntime(394):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2636)
12-22 13:21:38.076: E/AndroidRuntime(394):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T18:34:58.690

您需要添加

```
super.onActivityCreated(savedInstanceState) 
```

后

```
t = (EditText) getActivity().findViewById(R.id.weightedRed); 
```

这是因为，正如您的 LogCat 所说

```
did not call through to super.onActivityCreated() 
```

一些方法，即那些与初始化和活动和片段的生命周期有关的方法，需要调用它们覆盖的超类方法，因为有些事情在**你**没有覆盖的链上完成。但是请注意，并非所有被覆盖的方法都需要调用`super`，Activity 和 Fragment 生命周期方法是一种特殊情况，因为它们非常复杂，而且您不能期望每次创建应用程序时都重写整个 Activity/Fragment 类。

# javascript - Turn.js 为翻书创建索引

> ID：14005404
> 
> 赞同：0
> 
> 时间：2012-12-22T18:26:31.100
> 
> 标签：javascript, turnjs

我正在使用 turn.js（一个产生翻页效果的脚本）在线发布我的文章，但我想添加一个带有可点击链接的索引，该链接跳转到特定页面

我在这里搜索了我的问题，最接近的是 [Turn.js 更多控件来制作按钮](https://stackoverflow.com/questions/13027185/turn-js-more-controls-to-make-buttons#comment17683508_13027185)

答案是：$("#magazine").turn("page",4) //转到第 4 页参考：[http ://www.turnjs.com/#samples/docs/18](http://www.turnjs.com/#samples/docs/18)

好吧，我不知道把它放在哪里，让它成为一个可点击链接的动作

抱歉新手问题我是图形设计师和诗人，但我对 javascript 编码完全陌生

谢谢你的时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:15:05.903

我不知道 turn.js，但您可以尝试创建一个调用 javascript 的链接，如下所示：

```
 <a href="javascript:$('#magazine').turn('page',4)">Index term</a> 
```

使您的索引成为此类链接的列表，为页码和索引词设置适当的值。对文档的快速扫描表明没有理由这样做不起作用。

# asp.net - 在代码中使用完整的类型名称比使用整个命名空间的 using 指令更快

> ID：14005407
> 
> 赞同：0
> 
> 时间：2012-12-22T18:26:47.563
> 
> 标签：asp.net, .net, performance, dllimport, using-statement

为了获得最佳网站性能，使用：（例如）

```
Telerik.Web.UI.RadChart ResultChart = new Telerik.Web.UI.RadChart(); 
```

比：

```
using Telerik.Web.UI; 
```

和

```
RadChart ResultChart = new RadChart(); 
```

如果我`using`在 ASP.net 页面的许多模块中使用了该指令，编译器会使用一次吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:27:49.387

没有什么不同的。每次需要使用该类型时，编译后的 IL 将包含完全限定名称。

该`using`语句只是使您的代码文件更短且更易于阅读。

指令在您的代码中出现的次数也没有什么区别——只要项目引用它所在的程序集就足够了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T18:30:04.153

没有区别。

`using`语句使您的代码更短且更具可读性。如果在多个模块中使用它是没有问题的。为这两个版本创建了相同的 IL（中间语言）代码。您可以查看这两条代码及其IL代码；

```
using System;

namespace Programs
{
    public class Program
    {
        public static void Main(string[] args)
        {
            string s = "Foo";
        }
    }
} 
```

* * *

```
.method public hidebysig static void  Main(string[] args) cil managed
{
  .entrypoint
  // Code size       8 (0x8)
  .maxstack  1
  .locals init ([0] string s)
  IL_0000:  nop
  IL_0001:  ldstr      "Foo"
  IL_0006:  stloc.0
  IL_0007:  ret
} // end of method Program::Main 
```

* * *

```
namespace Programs
{
    public class Program
    {
        public static void Main(string[] args)
        {
            System.String s = "Foo";
        }
    }
} 
```

* * *

```
.method public hidebysig static void  Main(string[] args) cil managed
{
  .entrypoint
  // Code size       8 (0x8)
  .maxstack  1
  .locals init ([0] string s)
  IL_0000:  nop
  IL_0001:  ldstr      "Foo"
  IL_0006:  stloc.0
  IL_0007:  ret
} // end of method Program::Main 
```

# emacs - Zen Coding 更新了 emacs 模式

> ID：14005413
> 
> 赞同：5
> 
> 时间：2012-12-22T18:28:06.007
> 
> 标签：emacs, emmet

似乎没有积极维护 emacs 中 Zen Coding 的[GitHub 存储库](https://github.com/rooney/zencoding)（上次提交是一年前），并且缺少一些功能，例如`html:5`“标签”。

我找不到 emacs 模式的任何其他来源。有谁知道是否存在更新版本？

Zen Coding google 组链接到 EmacsWiki，后者又链接到上述 GitHub 存储库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-18T12:06:54.367

我[分叉](https://github.com/smihica/emmet)了 zencoding-mode 并添加了一些新功能支持，例如[html:5](https://github.com/smihica/zencoding#aliases)标签、[CSS abbreviations](https://github.com/smihica/zencoding#css-abbreviations)。您可以通过编辑 conf/snippets.json 并重新编译来定义更多内容。

请尝试一下；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T16:41:58.847

Zen Coding 现在是[Emmet](http://docs.emmet.io/)。遗憾的是，Emacs 不是他们支持的编辑器之一。

[这个 GitHub repo](https://github.com/rooney/zencoding)可能是规范的zencoding 实现，尽管[这个 fork](https://github.com/smihica/zencoding)[支持 HTML 5](https://github.com/smihica/zencoding/commit/05b9826295d902ed00d0971437e5d5de76fb7d9b)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-05-11T12:17:11.717

作者已经提交了新版本，并且这个 fork 已经支持 html 片段...我推荐给你

* * *

我已经安装[了这个 fork](https://github.com/smihica/zencoding)，但它不适用于许多新标签，如 html:5,input:i...anynoe 遇到了这个问题？我给作者发了一封邮件，但到现在我还没有收到任何答复。

# java - 需要帮助为 java 中的命令行界面构建命令类

> ID：14005414
> 
> 赞同：0
> 
> 时间：2012-12-22T18:28:10.047
> 
> 标签：java, command, command-line-interface

好的，我正在构建这个电子表格应用程序，我正在通过命令行界面实现它，其中我有某些命令，例如 exit，它会终止程序。

所以我有这个应用程序类，其中有以下字段：

```
private ArrayList<Spreadsheet> spreadsheets;
private Spreadsheet worksheet; 
```

这个方法：

```
public void newSpreadsheet() {
  worksheet = new Spreadsheet();
  spreadsheets.add(worksheet);
} 
```

然后我有这个 CommandIntepreter 类，它看起来像这样：

```
package ui;

import java.util.Scanner;
import java.util.InputMismatchException;
import java.util.NoSuchElementException;

import ui.command.Command;
import ui.command.ExitCommand;
import ui.command.FailedCommand;
import ui.command.PrintCommand;
import ui.command.NewCommand;
import ui.command.ListCommand;
import ui.command.ChangeCommand;
import ui.command.SetCommand;
import ui.command.GetCommand;

import spreadsheet.*;
import spreadsheet.arithmetic.*;

public final class CommandInterpreter {

private CommandInterpreter() {
// The class should not be instanciated.
}

public static Command interpret(final Scanner scanner) {
final String keyword = scanner.next();
switch(keyword) {
  case "exit":
    return new ExitCommand();
  case "pws":
    return new PrintCommand();
  case "ns":
    return new NewCommand();
  case "ls":
    return new ListCommand();
  case "cws":
    return new ChangeCommand();
  case "set":
    return new SetCommand();
  case "get":
    return new GetCommand();

}
return new FailedCommand(
  String.format("Illegal start of command, \"%s\".", keyword));
}

} 
```

然后我创建了如下所示的 NewCommand 类：

```
package ui.command;

import spreadsheet.Application;
import spreadsheet.Spreadsheet;

public final class NewCommand
 extends Command {

public void execute() {
 Application.instance.newSpreadsheet();
}
} 
```

当我写 ns 时应该制作一个新的电子表格。但是当我这样做时，什么都没有发生，所以你能告诉我为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T18:41:59.603

您必须调用 NewCommand 类的执行方法才能创建新的电子表格。我在您的代码中没有看到您这样做的任何地方。

在此之前，我相信您正在尝试在此应用程序中使用命令模式。我建议您创建一个名为“Command”的接口并使用方法“execute()”，然后在所有类中实现 Command 接口。如果您发现 'ns' 作为命令行输入，只需为 New Command 创建实例

```
case "ns":
Command nsCommand = new NewCommand();
nsCOmmand.execute();
return "SOME_MESSAGE" 
```

# keylistener - Java - 按下方向键并使其平稳移动

> ID：14005423
> 
> 赞同：-1
> 
> 时间：2012-12-22T18:29:24.870
> 
> 标签：keylistener

当我按下方向键将对象朝那个方向移动时，它会移动一次，然后暂停片刻，然后再次移动。有点像如果我想输入“aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa，我会按住“a”键，但是在第一个“a”之后有一个暂停，然后输入其余的“a”。如何删除 KeyListener 中的暂停？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:00:46.897

这是操作系统提供的关键重复功能，因此无法绕过暂停。大多数游戏解决这个问题的方法是保留所有必需键的当前状态数组，并定期检查它们（例如在游戏循环中）并采取行动（例如移动）。

```
public class KTest extends JFrame implements KeyListener {
    private boolean[] keyState = new boolean[256];

    public static void main(String[] args) { 
        new KeyTest();

        int xVelocity = 0;

        int x = 0;

        while(1) {
            xVelocity = 0;

            if(keyState[KeyEvent.VK_LEFT]) {
                xVelocity = -5;
            }

            x += xVelocity;
        }
    } 

    KTest() {
        this.addKeyListener(this);
    }
    void keyPressed(KeyEvent e) {
        key_state[e.getKeyCode()] = true;
    }
    void keyReleased(KeyEvent e) {
        key_state[e.getKeyCode()] = false;
    }
} 
```

基类取自：[http ://content.gpwiki.org/index.php/Java:Tutorials:Key_States](http://content.gpwiki.org/index.php/Java:Tutorials:Key_States)

# c# - 如何在 WinRT 中将字符串绘制到位图图像

> ID：14005424
> 
> 赞同：4
> 
> 时间：2012-12-22T18:29:45.637
> 
> 标签：c#, image, windows-runtime, winrt-xaml, winjs

您如何将字符串绘制到图像中`winRT`？在 WinForms 中，可以使用命名空间`drawstring()`内的方法来完成，`system.drawing`但我在 WinRT API 中找不到它的等价物。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-27T12:39:57.000

在 Windows 8.1 中，它们最终支持将 XAML 控件呈现为位图。现在你可以使用

```
var renderTargetBitmap = new RenderTargetBitmap();
await renderTargetBitmap.RenderAsync(uiElement, width, height));
var buffer = await renderTargetBitmap.GetPixelsAsync();
var tmpWbm = new WriteableBitmap(renderTargetBitmap.PixelWidth, renderTargetBitmap.PixelHeight); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T21:01:19.983

您将不得不使用 DirectX。您可以使用[SharpDx](http://code.google.com/p/sharpdx/ "SharpDx")在 C# 中执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T19:14:24.327

Direct2D 是 WinRT 中 GDI 的替代品。所以你必须使用 C++/CX 和 DirectX 来绘制文本。

我没有任何例子给你，但也许[这个链接](http://answers.flyppdevportal.com/categories/metro/nativecode.aspx?ID=02e3515b-5cfd-4f57-aad5-897a9f418878)（以及包含的链接）可以帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T18:50:21.097

你不能 - 不幸的是没有这样的 API :-(

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-05T20:05:34.257

谷歌“使用 Direct2D 和 DirectWrite for Graphics 的 Metro CSharp”。这是他们的代码示例之一。这不是我见过的最简洁的例子，但它确实有效。使用 SharpDX 做同样的事情会更干净。

# silverlight - ListBox 以可变高度滚动

> ID：14005429
> 
> 赞同：2
> 
> 时间：2012-12-22T18:30:08.893
> 
> 标签：silverlight, windows-phone-7, xaml

我对 ListBox 滚动有疑问。每次我有比屏幕上显示的更多的项目时，我尝试滚动列表，它会自动回到顶部。我发现这可以通过为 ListBox 设置固定高度来解决。但是，我需要动态地将项目添加到列表中，因此高度会发生变化。

列表框位于嵌套在 PivotItem 中的网格的第二行中。

如何使用 XAML 动态设置列表框的高度或实现不总是对齐顶部的滚动效果，从而阻止我阅读/编辑底部的项目？

这是 XAML：

```
<Grid x:Name="LayoutRoot">
 ...
    <controls:Pivot Title="Malts">
        <controls:PivotItem Header="Gravity" Name="GravityPivot">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <Grid> some more controls in row 0</Grid>
                <Grid
                    Grid.Row="1">  
                    <ListBox
                 VerticalAlignment="Stretch"         
                 ItemsSource="{Binding ItemList}" 
                    Padding="10,10,0,10"
                    ItemContainerStyle="{StaticResource ListBoxItemStyle}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock 
                                    Style="{StaticResource PhoneTextExtraLargeStyle}" 
                                    Text="{Binding Name}" 
                                    VerticalAlignment="Bottom"/>

                                    <StackPanel>
                                        <StackPanel 
                                        Orientation="Horizontal" >

                                            <TextBlock
                                                Text="{Binding Amount, Converter={StaticResource WeightConverter},StringFormat=' {0:f2}'}" 
                                                Margin="10,0,5,0"
                                                Style="{StaticResource PhoneTextNormalStyle}"/>
                                            <TextBlock
                                                Text="{Binding ., Converter={StaticResource UnitExtension}, ConverterParameter='Weight'}"
                                                Style="{StaticResource PhoneTextNormalStyle}"/>
                                        </StackPanel>
                                    </StackPanel>

                                    <toolkit:ContextMenuService.ContextMenu>
                                        <toolkit:ContextMenu>
                                            <toolkit:MenuItem                                                 
                                            Header="Edit"
                                            Command="{Binding ElementName=MaltList, Path=DataContext.EditCommand}"
                                            CommandParameter="{Binding}"/>
                                            <toolkit:MenuItem 
                                            Header="Remove"
                                            Command="{Binding ElementName=MaltList, Path=DataContext.RemoveCommand}"
                                            CommandParameter="{Binding}"/>
                                        </toolkit:ContextMenu>
                                    </toolkit:ContextMenuService.ContextMenu>
                                </StackPanel>

                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Grid>
        </controls:PivotItem> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T20:32:01.700

试试这个，应该可以解决您的问题；

```
<ListBox>

            <!-- You want this part... -->
            <ListBox.Template>
                <ControlTemplate>
                    <ScrollViewer HorizontalScrollBarVisibility="Auto"
                                  VerticalScrollBarVisibility="Auto">
                        <ItemsPresenter/>           
                    </ScrollViewer>         
                </ControlTemplate>      
            </ListBox.Template>

</ListBox> 
```

# ruby-on-rails - 在 ruby on rails 中可以通过收集和包含来实现哪些改进？

> ID：14005437
> 
> 赞同：1
> 
> 时间：2012-12-22T18:31:17.660
> 
> 标签：ruby-on-rails, loops, include, nested, collect

我在初学者级别有一个非常复杂的查询，我无法解决。在本地机器上，我的页面加载时间约为 6 7 秒。

查询类似于用户

```
self.groups.collect(&:reports).flatten.paginate 
```

现在我运行一个类似于以下内容的循环：

```
reports.each do |report|
  report.name

  report.user.name
  report.user.image.attachment.url(:thumb)   #User has_one :image , Image belongs_to :user

  report.questions.each do |question|
    question.name 

    question.answers.each do |answer|
      answer.name
    end
  end

  report.comments.each do |comment|
    comment.name 
    comment.user.name
    comment.user.image.attachment.url(:thumb)   #User has_one :image , Image belongs_to :user
  end

end 
```

它有很多嵌套循环，需要大量使用包含，但我无法弄清楚我应该继续使用哪种方式。我之前的问题是[N+1 在与活动记录的关系中？](https://stackoverflow.com/questions/13806639/n1-in-rails-relations-with-active-records)

**- - - - - - - - - 编辑 - - - - - - - - -**

我能做到

```
self.groups.includes(:reports => [:user, :questions]) 
```

或者

```
self.groups.includes(:reports => [:user => [:image]]) 
```

但不是

```
 self.groups.includes(:reports => [:user => [:image], :questions]) 
```

这有什么问题？

**- - - - - - - - - 编辑 - - - - - - - - -**

```
self.groups.includes(:reports => [:questions, :user => [:image]]).collect(&:reports).flatten.paginate(:page => page, :per_page => 6) 
```

[根据子弹宝石（ https://github.com/flyerhzm/bullet](https://github.com/flyerhzm/bullet) ） ，这似乎对我有用，没有额外/更少的急切加载，但加载查询仍然需要大约 10 秒，它就像一个巨大的巨大加载。任何进一步的改进建议？

**- - - - - - - - - 编辑 - - - - - - - - -**

```
 self.groups.includes(:reports => [:questions, .........]).collect(&:reports).paginate 
```

变成

```
self.group_reports.includes(:questions, ....... ).paginate 
```

帮了很多忙

在**用户模型**中定义了类似的东西

```
has_many :reports
has_many :group_reports, :through => :groups, :source => :reports 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:03:23.867

尝试使用哈希：self.groups.includes(:reports => [:questions, {:user => :image}])

# javascript - 通过ajax加载内容时如何更新浏览器中的url

> ID：14005438
> 
> 赞同：0
> 
> 时间：2012-12-22T18:31:17.247
> 
> 标签：javascript, html, ajax, url

在我的 web 应用程序中，我在 fancybox 中加载图像。现在我希望当打开图像时，浏览器的 URL 会像新页面加载一样发生变化，并指向图像的位置，例如：如果 siteurl 是：

```
http://mysite.org 
```

当使用 ajax 加载图像时，它应该显示：

```
http://mysite.org/imag1.jpg 
```

这很有帮助，因为用户可以使用 url 引用图像。我可以使用 ajax 或任何其他方法获取 url，但是如何更新浏览器 url 以指向该位置。如果后退和前进按钮可以切换，那就太好了来回切换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:32:41.943

您可以使用[HTML5 历史 API](http://html5demos.com/history)。

编辑：[本教程](http://diveintohtml5.info/history.html)似乎很好。本教程中有几个示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:30:56.713

在您的 ajax 回调中，您可以：

```
window.location.href = 'http://mysite.org/imag1.jpg'; 
```

# mysql - 在 Mysql 上使用 ddl 模式生成时未生成 ON DELETE CASCADE 选项

> ID：14005442
> 
> 赞同：7
> 
> 时间：2012-12-22T18:31:49.680
> 
> 标签：mysql, hibernate, cascade, cascading-deletes, hbm2ddl

在 Tomcat Web 应用程序上运行的 Maven-Spring-Hibernate-MySql 中，我使用 hibernate ddl 通过 MySQL5InnoDBDialect 生成我的数据库模式。

除了外键的级联选项外，模式生成得很好。例如我有这个结构：

包含用户详细信息对象的用户对象，两者共享相同的密钥：

```
@Entity
@Table(name = "Users")
public class User implements Serializable {

    private static final long serialVersionUID = -359364426541408141L;

    /*--- Members ---*/

    /**
     * The unique generated ID of the entity.
     */
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "User_Id")
    protected long id;

    @Getter
    @OneToOne(cascade = CascadeType.ALL, fetch = FetchType.EAGER, mappedBy = "user", optional = true)
    protected UserDetails userDetails;

...

} 
```

以及用户详细信息：

```
@Entity
@Table(name = "UserDetails")
public class UserDetails implements Serializable {

    private static final long serialVersionUID = 957231221603878419L;

    /*--- Members ---*/

    /**
     * Shared Key
     */
    @Id
    @GeneratedValue(generator = "User-Primary-Key")
    @GenericGenerator(name = "User-Primary-Key", strategy = "foreign", parameters = { @Parameter(name = "property", value = "user") })
    @Column(name = "User_Id")
    protected long id;

    @Getter
    @Setter
    @OneToOne(optional = false, fetch = FetchType.LAZY)
    @PrimaryKeyJoinColumn
    private User user;

...

} 
```

生成模式时，从 users-details 表到 users 表的外键缺少级联。

这是用户详细信息的架构创建：

```
CREATE TABLE `userdetails` (
  `User_Id` bigint(20) NOT NULL,
  `Creation_Time` bigint(20) NOT NULL,
  `EMail` varchar(128) DEFAULT NULL,
  `Enabled` bit(1) NOT NULL,
  `First_Name` varchar(15) DEFAULT NULL,
  `Last_Name` varchar(25) DEFAULT NULL,
  `Password` varchar(64) NOT NULL,
  `User_Name` varchar(15) NOT NULL,
  PRIMARY KEY (`User_Id`),
  UNIQUE KEY `User_Name` (`User_Name`),
  UNIQUE KEY `EMail` (`EMail`),
  KEY `FKAE447BD7BF9006F5` (`User_Id`),
  CONSTRAINT `FKAE447BD7BF9006F5` FOREIGN KEY (`User_Id`) REFERENCES `users` (`User_Id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8$$ 
```

如您所见，“外键”部分中没有任何“ON DELETE CASCADE”。

[这里](https://stackoverflow.com/questions/2856460/hibernate-doesnt-generate-cascade)和[这里](https://forum.hibernate.org/viewtopic.php?t=986157)也描述了这个问题。

所以我尝试在 userDetails 成员上方添加 @OnDelete 注释，但没有成功。

然后我创建了自己的方言，覆盖了supportsCascadeDelete：

```
public class MySql5Dialect extends MySQL5InnoDBDialect {

    public MySql5Dialect() {
    super();
    }

    @Override
    public String getTableTypeString() {
    return " ENGINE=InnoDB DEFAULT CHARSET=utf8";
    }

    @Override
    public boolean supportsCascadeDelete() {
    return true;
    }

} 
```

但仍然没有任何变化。生成架构后，我的外键级联选项仍设置为“RESTRICT”：

![在此处输入图像描述](../Images/c94469b92f29b92da60ddad664b66ffa.png)

有没有办法解决这个问题（当然非手动）？

## 更新

按照[Angel Villalain](https://stackoverflow.com/users/213882/angel-villalain)的建议，我将 @OnDelete 注释放在 UserDetails 类的“用户”成员之上，这对 OneToOne 关系起到了作用，删除是级联的，但 OnUpdate 设置为限制（仍然），这导致我的第一个问题 - 这是什么意思？我的意思是“OnDelete”非常简单 - 当我删除父级时也会删除子级，但是“OnUpdate”选项的含义是什么？当它设置为限制/级联时，它如何影响我的应用程序？

我的第二个问题是指级联与 OneToMany 关系。我的 User 类拥有许多 UserProviders。以下代码来自**User**类：

```
@OneToMany(fetch = FetchType.EAGER, cascade = CascadeType.ALL, orphanRemoval = true)
@JoinTable(name = "Users_Providers", joinColumns = @JoinColumn(name = "User_Id"), inverseJoinColumns = @JoinColumn(name = "Provider_Id"))
protected Set<UserProvider> userProviders = new HashSet<>(0); 
```

这是来自**UserProvider**类的反比关系：

```
@ManyToOne(fetch = FetchType.LAZY)
@JoinTable(name = "Users_Providers", joinColumns = @JoinColumn(name = "Provider_Id", insertable = false, updatable = false), inverseJoinColumns = @JoinColumn(name = "User_Id"))
@OnDelete(action = OnDeleteAction.CASCADE)
protected User user; 
```

因此，在使用 @OnDelete 注释后，我希望在连接表中看到带有级联的 onDelete 选项，但事实并非如此:(我是否正确使用了它？

最后一个问题——像@ElementCollection 这样的单向关系呢？我的**UserDetails**类拥有一个 ElementCollection 角色（可以为每个用户分配一个或多个角色）：

```
@ElementCollection(fetch = FetchType.EAGER, targetClass = Role.class)
@CollectionTable(name = "Users_Roles", joinColumns = @JoinColumn(name = "User_Id", referencedColumnName = "User_Id"))
@Column(name = "Role")
protected Set<Role> roles = new HashSet<Enums.Role>(0); 
```

角色只是一个枚举，而不是一个实体，因此我不能从一个角色指向父实体。在这种情况下，有没有办法级联onDelete？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T00:51:45.917

使用`OnDelete`注释 DDL 应该是正确的。您能否检查一下您是如何配置的`SessionFactory`，特别是您为 hbm2ddl.auto 参数使用了哪个值。

**更新**

*   关于你在`UserProvider`课堂上的问题。首先映射似乎是双向的，但一侧必须是所有者侧，另一侧必须是反向侧。意思是拥有关系的那个就是将关系持久化到连接表中的那个，另一个必须用`mappedBy`参数映射并且不控制关系。所以指向成员的那个`OneToMany`会是反面，会是拥有者，应该有注解。但是让我明天测试一下，以确保我不在我的开发站前面。`mappedBy``user``UserProperty``UserProperty``OnDelete`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T14:12:31.010

在调查了这个问题之后，我想出了以下处理 DB 模式生成的方法（假设您使用 Hibernate 作为您的 JPA 提供程序）：

*   使用 ddl 模式生成，您可以生成数据库模式。使用此选项，架构将在您启动 Web 服务器时创建/更新。如果您使用此方法，为了确保您的 onDelete 选项设置为级联，您可以使用 OnDelete 注释。这对我来说适用于 OneToOne 关系（感谢[Angel Villalain](https://stackoverflow.com/users/213882/angel-villalain)），但由于某种原因，它不适用于 OneToMany 关系。为了解决这个差距，我使用了 Spring 的[ResourceDatabasePopulator](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/jdbc/datasource/init/ResourceDatabasePopulator.html)：

![在此处输入图像描述](../Images/21ae13931b091cd1bcb95d8a799d5858.png)

db-additions.sql 文件包含适应我的数据库的查询，在我的例子中创建 Ondelete Cascade。例如：

```
ALTER TABLE `buysmartdb`.`users_providers` DROP FOREIGN KEY `FKB4152EEBBF9006F5` ;
ALTER TABLE `buysmartdb`.`users_providers` 
  ADD CONSTRAINT `FKB4152EEBBF9006F5`
  FOREIGN KEY (`User_Id` )
  REFERENCES `buysmartdb`.`users` (`User_Id` )
  ON DELETE CASCADE
  ON UPDATE CASCADE; 
```

请注意，由 ResourceDatabasePopulator 触发的脚本在 Hibernate ddl 生成模式之后应用，这很好。我知道，由于最终结果，我无法真正确保它得到保证。

*   第二种方法是在编译时使用 maven 生成模式。有几种方法可以做到这一点，例如[这个](http://techblog.bozho.net/?p=935)或[那个](http://doingenterprise.blogspot.co.il/2012/05/schema-generation-with-hibernate-4-jpa.html)。

我希望这会对某人有所帮助..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-25T15:19:19.867

出于某种原因，将 @OnDelete 放在 Mysql 和 PostgreSql 中的 @ManyToOne 端对我不起作用，但它在 @OneToMany 端起作用。 [https://stackoverflow.com/a/44988100/4609353](https://stackoverflow.com/a/44988100/4609353)

# drupal - 在 Drupal 中向订阅者发送邮件

> ID：14005444
> 
> 赞同：0
> 
> 时间：2012-12-22T18:32:10.897
> 
> 标签：drupal, drupal-6, sendmail, subscription

我正在使用 Drupal 6 开发一个网站。

我需要一个订阅块来获取访问者的电子邮件。还有一个模块，可以在某个时间一次向所有人或其中一些人发送一些 html 电子邮件。

我可以使用什么模块？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T05:53:16.470

使用[http://drupal.org/project/simplenews](http://drupal.org/project/simplenews)这个模块，您可以轻松自定义模板，它有许多相关模块，如 Simplenews Scheduler、Simplenews Content Selection 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T00:56:20.440

我赞成为此集成到 Drupal 中的 3rd 方服务。

这将减轻您服务器的负担，并且您将拥有更好的工具来创建电子邮件。

Mailchimp 是一种流行的，可以很好地集成到 Drupal 中。

[http://mailchimp.com/](http://mailchimp.com/) http://drupal.org/project/mailchimp

# css - 如何使用 Wordpress 主题和 CSS 修复可点击背景

> ID：14005445
> 
> 赞同：0
> 
> 时间：2012-12-22T18:32:11.290
> 
> 标签：css, wordpress, background, ads

我在使用可点击的广告皮肤作为我的 Wordpress 网站的背景时遇到问题。我的网站是这样的：[http](http://www.tvindiretta.com) ://www.tvindiretta.com 。如果您向下滚动我网站的任何页面，您会看到背景的顶部覆盖了内容并且一团糟……我认为我应该在前景中添加一个白色背景。我真的需要你的帮助，我是 CSS 和编程方面的菜鸟......我读到了关于这个参数的谷歌搜索......

```
display: block; ??
text-indent: px; ??
overflow: hidden; ??
z-index:22 ??? 
```

...但我不知道如何解决这个问题...这是我的 Wordpress 主题 CSS 文件[http://www.tvindiretta.com/wp-content/themes/videoplus/style.css](http://www.tvindiretta.com/wp-content/themes/videoplus/style.css)非常感谢任何提前帮助

PS 这个网站：IMPRONTALAQUILA.ORG 在某些页面中显示了相同的广告和其他类似的皮肤，没有任何错误或问题……我怎样才能得到相同的结果？我希望修复背景，以便用户在浏览页面的任何部分时看到它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:46:19.267

`fixed`从中删除

```
background: white url(http://www.affiliago.it/accounts/default1/banners/SKIN_BAKECA.jpg) no-repeat fixed; 
```

以你的`body`风格。

更新：

添加你的CSS：

```
.myClass{
    background-color:white;
    width:994px;
    margin:0 auto;
} 
```

并将这些样式添加到：

`<div class="clear">`到`<div class="clear myClass">`

`<nav>`到`<nav class="myClass">`

`<div class="wrap">`到`<div class="wrap myClass">`

# silverlight - Silverlight，VisualStateManager gotostate 不适用于数据模板

> ID：14005448
> 
> 赞同：1
> 
> 时间：2012-12-22T18:32:23.053
> 
> 标签：silverlight, visualstatemanager

我在 ContentPresenter 中有一个名为“PART_closeButton”的按钮。我正在为我的按钮定义一些视觉状态。

```
 <VisualStateGroup x:Name="CommonStates">
          <VisualState x:Name="MouseOver">
                <Storyboard>
                    <DoubleAnimation Duration="0" To="1" 
Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="PART_closeButton" d:IsOptimized="True"/>
                 </Storyboard>
          </VisualState>
          <VisualState x:Name="Normal">
                  <Storyboard>
                       <DoubleAnimation Duration="0" To="0.7" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="PARTcloseButton" d:IsOptimized="True"/>
                  </Storyboard>
           </VisualState>
    </VisualStateGroup> 
```

所以一切都为我工作。当我将鼠标悬停在按钮上时，它变得半透明。但是，如果我为 contentpresenter 加载一些数据模板，其中还包含同名按钮，则视觉状态不再反应。（mouseOver 事件也为该按钮处理并触发）。goToState 不工作。我知道实际的按钮对象正在改变，VisualState 与具有 TargetName 的按钮连接。所以新按钮具有相同的名称，为什么状态管理器不起作用？

# iphone - 将键盘限制为表情符号

> ID：14005449
> 
> 赞同：3
> 
> 时间：2012-12-22T18:32:25.143
> 
> 标签：iphone, textfield, emoji

我有一个只应该包含表情符号字符的文本字段。是否可以将用户的键盘限制为仅输入表情符号，即禁用其他键盘？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:20:55.867

键盘类型可以在 Interface Builder 中设置，也可以使用本指南以编程方式设置：

```
typedef enum {
    UIKeyboardTypeDefault,                // Default type for the current input method.
    UIKeyboardTypeASCIICapable,           // Displays a keyboard which can enter ASCII characters, non-ASCII keyboards remain active
    UIKeyboardTypeNumbersAndPunctuation,  // Numbers and assorted punctuation.
    UIKeyboardTypeURL,                    // A type optimized for URL entry (shows . / .com prominently).
    UIKeyboardTypeNumberPad,              // A number pad (0-9). Suitable for PIN entry.
    UIKeyboardTypePhonePad,               // A phone pad (1-9, *, 0, #, with letters under the numbers).
    UIKeyboardTypeNamePhonePad,           // A type optimized for entering a person's name or phone number.
    UIKeyboardTypeEmailAddress,           // A type optimized for multiple email address entry (shows space @ . prominently).

    UIKeyboardTypeAlphabet = UIKeyboardTypeASCIICapable, // Deprecated

  } UIKeyboardType; 
```

表情符号键盘设置为单独的语言键盘，因此无法以编程方式设置。它由用户在设置应用程序中设置。

我想，即使它很麻烦，您也可以提醒您的用户或在您的应用程序中有一个帮助文件，说明要获得您的应用程序的最佳体验，他们需要启用它。

另请注意，我相信 Apple 现在拒绝创建自己的自定义表情符号键盘的应用程序，因为它现在是主操作系统的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-28T09:08:11.873

目前正在开发一个要求与您相同的项目，并尝试搜索解决方案但没有找到，我编写了一个对我来说工作正常的代码。希望它也适合你。我知道为时已晚，但将来会帮助你。

我的解决方案是

```
#pragma mark validate emoji's

-(void)validateEmoji
{
BOOL lowerCaseLetter=0,upperCaseLetter= 0,digit=0,specialCharacter=0;
    for (int i = 0; i < [emojiTextField.text length]; i++)
    {
        unichar c = [emojiTextField.text characterAtIndex:i];
        if(!lowerCaseLetter)
        {
          lowerCaseLetter = [[NSCharacterSet     lowercaseLetterCharacterSet] characterIsMember:c];
        }
        if(!upperCaseLetter)
        {
            upperCaseLetter = [[NSCharacterSet uppercaseLetterCharacterSet] characterIsMember:c];
        }
        if(!digit)
        {
            digit = [[NSCharacterSet decimalDigitCharacterSet] characterIsMember:c];
        }
        if(!specialCharacter)
        {
            specialCharacter = [[NSCharacterSet symbolCharacterSet] characterIsMember:c];
        }
    }

    if(lowerCaseLetter || upperCaseLetter || digit || specialCharacter)
    {
        // if textfield contains special characters,lowercase,uppercase,numeric digits
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error"
                                                        message:@"Please select only emoji's from Keyboard"
                                                       delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alert show];
        emojiTextField.text=@"";
        [emojiTextField becomeFirstResponder];
        emojiTextFieldFlag = false;
    }
    else
    {
        emojiTextFieldFlag = true;
        // emoji is selected do whatever you want.
    }

}

#pragma mark TextField delegate methods
-(BOOL)textFieldShouldReturn:(UITextField *)textField
 {
if ([textField isEqual:emojiTextField])
{
    [emojiTextField resignFirstResponder];
    NSLog(@"%@",emojiTextField.text);
    // make it blank for next click when comes back
    appdelegate.appdelegateEmojiTextFieldClicked =@"";
    if (emojiTextFieldFlag)
    {
        [self saveEmojiJsonParsing];
    }
    else
    {
        [emojiTextField becomeFirstResponder];
    }
  }
  return YES;
  }

-(void)textFieldDidEndEditing:(UITextField *)textField
 {
   if ([textField isEqual:emojiTextField])
   {
    [self validateEmoji];
   }
 } 
```

# cuda - 在 CUDA 中使用函子

> ID：14005450
> 
> 赞同：2
> 
> 时间：2012-12-22T18:32:29.480
> 
> 标签：cuda, thrust

我在 CUDA 中有以下类函子

```
class forSecondMax{
private:
    int toExclude;
public:
    __device__ void setToExclude(int val){
        toExclude = val;
    }
    __device__ bool operator () 
       (const DereferencedIteratorTuple& lhs, const DereferencedIteratorTuple& rhs) 
  {
    using thrust::get;
    //if you do <=, returns last occurence of largest element. < returns first
    if (get<0>(lhs)== get<2>(lhs) /*&& get<0>(rhs) == get<2>(rhs)*/ && get<0>(lhs) != toExclude/* && get<0>(rhs)!= toExclude */) return get<1>(lhs) < get<1>(rhs); else
    return true ;
  }

}; 
```

有没有办法从主机设置 toExclude 的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T10:49:32.340

解决此问题所需要做的就是为函子定义一个构造函数，该函子从参数中设置数据成员。所以你的班级看起来像这样：

```
class forSecondMax{
    private:
        int toExclude;
    public:
        __device__ __host__ forSecondMax(int x) : toExclude(x) {};
        __device__ __host__ bool operator () 
            (const DereferencedIteratorTuple& lhs, 
             const DereferencedIteratorTuple& rhs) 
            {
                using thrust::get;
                if (get<0>(lhs)== get<2>(lhs) && get<0>(lhs) != toExclude) 
                    return get<1>(lhs) < get<1>(rhs);
                else
                    return true ;
            }

}; 
```

[免责声明：用浏览器编写，从未测试或编译，使用风险自负]

要在将函子传递给推力算法之前设置值，请创建函子的实例并将其传递给推力调用，例如：

```
forSecondMax op(10);
thrust::remove_if(A.begin(), A.end(), op); 
```

这将`toExclude`在类的新实例中将数据成员的值设置为 10，并在流压缩调用中使用该实例。

# php - PDO，使用方法`bindValue`时的奇怪行为

> ID：14005451
> 
> 赞同：0
> 
> 时间：2012-12-22T18:32:31.710
> 
> 标签：php, pdo

我需要使用存储过程从远程 MSSQL 获取一些数据，然后在调用下一个存储过程时绑定此值。该值只是一个字符串。我写

`$statement->bindValue(':value', $value, \PDO::PARAM_STR);`

，但该值设置为空。我试图手动绑定另一个值，一切正常。这是什么意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T16:54:50.283

正如我后来理解的那样，问题出在 MSSQL uniqueidentifier 类型上，需要通过函数[http://php.net/manual/en/function.mssql-guid-string.php](http://php.net/manual/en/function.mssql-guid-string.php)手动转换为字符串。我希望它可以帮助某人。

# javascript - DOM 元素原型

> ID：14005458
> 
> 赞同：0
> 
> 时间：2012-12-22T18:33:58.467
> 
> 标签：javascript, html, dom

我正在创建自己的小部件：

```
Button = function(){};
Button.prototype = document.createElement('INPUT');

btn = new Button();
btn.type = 'BUTTON';
btn.value = 'test';
btn.onclick = function(){alert('TEST!')}
document.body.appendChild(btn); 
```

如果我只是打开一个新标签并复制并粘贴到 Firefox 的控制台中，这运行得非常好。但是当我将它们放入一个 js 文件（包含在 中`$(document).ready`）并将其链接到 HTML 中，然后在浏览器中打开 HTML 时，它失败了。

在线上`btn.onclick`，它告诉我：

```
uncaught exception: [Exception... "Illegal operation on WrappedNative prototype object"  nsresult: "0x8057000c (NS_ERROR_XPC_BAD_OP_ON_WN_PROTO)"  location: "JS frame :: main.js :: <TOP_LEVEL> :: line 12"  data: no] 
```

我有点理解错误，因为我继承了原型，但我继承了`new-ed`元素（不直接作用于它），它在控制台中运行正常。谁能指出问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:40:46.807

你不能像这样创建 DOM 节点（而且你的原型设计不正确，你需要使用`HTMLInputElement.prototype`，但那是另一回事），而是做

```
Button = function(){
    var btn = document.createElement('INPUT');
    btn.type = 'BUTTON';
    return btn;
}; 
```

您仍然可以这样做，`new Button`除非这次它会按预期工作。

* * *

编辑：如果要用于`Button.prototype`定义属性和方法，可以将它们复制到`btn`构造函数中（这将是*ByVal*而不是*ByRef*）

```
for (i in Button.prototype) { // make sure to var i
    btn[i] = Button.prototype[i];
} 
```

尝试使用如下原型，但请注意更改`Button.prototype`不会反映在已创建`btn`的 s 中。

```
Button.prototype = {test: function () {console.log('invoked');}} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T18:43:18.107

无论我是否在 Firefox 的开发者控制台中工作（`btn.type = ...`在线），我都会收到错误消息。

一般来说，不能保证[*宿主对象*](http://www.ecma-international.org/ecma-262/5.1/#sec-4.3.8)可以作为原型正常工作。从[规范的§8.6.2](http://www.ecma-international.org/ecma-262/5.1/#sec-8.6.2)：

> 所有对象都有一个名为 的内部属性`[[Prototype]]`。该属性的值是或者是`null`一个对象，用于实现继承。**本机对象是否可以具有宿主对象`[[Prototype]]`取决于实现。**

*（我的重点）*

显然在这种情况下，实现（Firefox 的 SpiderMonkey）不喜欢你这样做。

与其尝试使用宿主对象作为原型，您最好的选择可能是按照 Paul 在[他的回答](https://stackoverflow.com/a/14005497/157247)中提出的建议。（您的`Button`构造函数可以使用或不使用`new`，因为如果构造函数返回不同的对象，则创建的新对象将`new`被丢弃。）

# php - Android Login with Token Session：就像用户登录并保持会话直到注销

> ID：14005460
> 
> 赞同：3
> 
> 时间：2012-12-22T18:34:12.877
> 
> 标签：php, android, authentication, login, session-cookies

登录 android 应用程序后，如何在 php api 中创建令牌会话？

像这样：

我想确保当用户登录时，无论发生什么（崩溃、关机/关机/重启、离开应用程序），它都会保持会话状态，同时用户信息数据将与所有活动一起发送应用程序到网络服务器。

我只是使用：

```
session_start();
$_SESSION['username'] = $user;
$_SESSION['auth'] = "true"; 
```

如果是这样，我如何将此会话传递给 android 应用程序？

Android App中的登录验证：

```
HttpClient client = new DefaultHttpClient();
String url = "http://www.somewebsite.com/login.php?username="+username+"&password="+password;
HttpGet request = new HttpGet(url);
// Get the response
ResponseHandler<String> responseHandler = new BasicResponseHandler();
response_str = client.execute(request, responseHandler);
php android authentication login session-cookies 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T19:19:52.353

*   当您的 Android 应用程序第一次调用您的登录 API 时，从经过验证的响应中检索令牌字段
*   使用 SharedPreferences 将这些令牌字段存储在本地应用程序中

[http://developer.android.com/reference/android/content/SharedPreferences.html](http://developer.android.com/reference/android/content/SharedPreferences.html)

*   （此存储在应用程序/操作系统生命周期之外持续存在，在重新启动应用程序或设备重启后仍将存在）
*   每当您调用 Web 服务 (php) 时，附加令牌参数

这看起来像这里的一些相关信息：

[http://www.androidhive.info/2012/08/android-session-management-using-shared-preferences/](http://www.androidhive.info/2012/08/android-session-management-using-shared-preferences/)

# objective-c - 错误访问回放用户录制与基于阵列的录制音量的动画同步

> ID：14005469
> 
> 赞同：0
> 
> 时间：2012-12-22T18:35:50.120
> 
> 标签：objective-c, animation, cocos2d-iphone, nsmutablearray, exc-bad-access

我正在尝试根据音频输入存储一个数组，然后在播放录音时播放与输入相对应的动画帧。

代码一直运行到现在，除了一段时间后它在模拟器中崩溃并突出显示

```
"CCLOG(@"adding image: %@", characterImageString);"; 
```

有了这个：

```
 EXC_BAD_ACCESS (code=1, address=0xd686be8) 
```

这是我知道的内存管理，但我绝对很难过。

```
if(isRecording){
   int myInt;
   NSString * characterImageString;

   //get a number based on the volume input
   float f = audioMonitorResults * 200; //convert max(0.06) to 12
   f=((f/12)*10);
   NSNumber *myNumber = [NSNumber numberWithDouble:(f+0.5)];
   myInt = [myNumber intValue] + 1;

   //create the image file name from the intiger we 
   //created from the audiomonitor results
   if(myInt < 10){
      characterImageString = [NSString stringWithFormat:@"fungus000%i.png",myInt];
   } else if (myInt == 10){
      characterImageString = [NSString stringWithFormat:@"fungus00%i.png",myInt];
   }

   CCLOG(@"adding image: %@", characterImageString);

   //add each frame
   [animationSequence addObject:characterImageString];

   // print array contents
   NSLog(@"animationSequence Array: %@", animationSequence);
   // print array size
   NSLog(@"animationSequence Number of Objects in Array: %u", [animationSequence count]);           } 
```

这是在播放音频时播放的代码：

```
-(void) updateAnimation:(ccTime) delta{

myFrame ++;

NSString *imageToDisplay;

imageToDisplay = animationSequence[myFrame];

CCTexture2D *currentTextureToDisplay = [[CCTextureCache sharedTextureCache] addImage:imageToDisplay];

[character setTexture:currentTextureToDisplay];

CCLOG(@"current texture to display: %@", currentTextureToDisplay);

if (myFrame >= [animationSequence count]) {

    [self unschedule:@selector(updateAnimation:)];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T20:44:57.713

显然，小的调试有很长的路要走。您能否在行前为**myInt**添加控制打印输出

`if(myInt < 10){`

**在崩溃前查看myInt**的值？

如果`myInt is <= 0`您的程序对这种情况没有保护，那么生成的图片将不存在。并且对于`myInt > 10` 程序将崩溃，因为`NSString * characterImageString;`是随机值的自动未初始化变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:18:24.073

嗯……一些母性和苹果派，很难得到可用的信息。不确定初始浮点值是多少，因此请在某处声明您的最小和最大图像编号（例如，kMinFrameNumber 和 kMaxFrameNumber）。由于浮点值可以是算法开始时的任何值，因此在计算 myInt 后添加以下“防御性”行：

```
myInt=MAX(kMinFrameNumber,myInt);    
myInt=MIN(kMaxFrameNumber,myInt); 
```

然后格式化：

```
characterImageString = [NSString stringWithFormat:@"fungus%04i.png",myInt]; 
```

最后，我怀疑异常是否在突出显示的行（即检测到它的位置）处引发。

一个。您是如何声明数组 animationSequence 的（是否保留？）。如果没有，它可能会在您的脚下以某个随机间隔自动释放，并且您将尝试向已释放的实例发送消息。

湾。您还应该在处理 animationSequence 之前检查边界

```
if(myFrame<[animationSequence count]-1) {
    imageToDisplay = animationSequence[myFrame];
} else {
    CCLOGERROR(@"Yelp ! addressing out of bounds!"); 
    // terminate neatly here ! as in unschedule and return 
} 
```

C。在设置精灵之前检查您的纹理是否为 nil（它将在 cocos2d 2.0 版中接受 nil 纹理）但是，您对代码的状态一无所知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T22:26:46.480

你`characterImageString`是`nil`如果`myInt > 10`

抛出异常，因为您正在尝试打印尚未初始化的变量。

您可以尝试将代码更改为以下内容：

```
if(myInt < 10)
{
    characterImageString = [NSString stringWithFormat:@"fungus000%i.png",myInt];
} 
else if (myInt >= 10 && myInt < 100)
{
    characterImageString = [NSString stringWithFormat:@"fungus00%i.png",myInt];
}
else if (myInt >= 100 && myInt < 1000)
{
    characterImageString = [NSString stringWithFormat:@"fungus0%i.png",myInt];        
}
else
{
    characterImageString = [NSString stringWithFormat:@"fungus%i.png",myInt];        
} 
```

# java - 使用 Spring MVC 流媒体的正确方法是什么

> ID：14005473
> 
> 赞同：5
> 
> 时间：2012-12-22T18:36:26.520
> 
> 标签：java, spring-mvc, controller

我有一个控制器方法，它只是将媒体（图像、css、js 等）的字节流传输到客户端。我首先尝试了这样的事情：

```
@RequestMapping(value="/path/to/media/**", method=RequestMethod.GET)
@ResponseBody
public byte[] getMedia(HttpServletRequest request) throws IOException
{
    //logic for getting path to media on server

    return Files.readAllBytes(Paths.get(serverPathToMedia));
} 
```

我最初在 Firefox 中对此进行了测试，一切似乎都运行良好。但是，我随后在 Chrome 中尝试了它，然后发现所有图像都不起作用。所以，然后我把它改成这样：

```
@RequestMapping(value="/path/to/media/**", method=RequestMethod.GET)
public ResponseEntity<byte[]> getMedia(HttpServletRequest request) throws IOException
{
    //logic for getting path to media on server

    byte[] bytes = Files.readAllBytes(Paths.get(serverPathToMedia));
    //logic for setting some header values like Content-Type and Content-Length
    return new ResponseEntity<byte[]>(bytes, headers, HttpStatus.OK);
} 
```

这给出了与以前相同的结果。我在开发人员工具中看到我的响应标头按预期下降，但仍然没有图像字节

接下来我尝试了这样的事情：

```
@RequestMapping(value="/path/to/media/**", method=RequestMethod.GET)
public void getMedia(HttpServletRequest request, HttpServletResponse response) throws IOException
{
    //logic for getting path to media on server

    byte[] bytes = Files.readAllBytes(Paths.get(serverPathToMedia));
    response.getOutputStream().write(bytes);
} 
```

甚至无需设置任何响应标头，这适用于 Firefox 和 Chrome。现在，虽然我可以这样做，因为它可以工作，但这似乎不是正确的 Spring MVC 方式。我想知道为什么我尝试的前两件事不起作用，因为它们看起来更正确。另外，有没有我没有尝试过的东西实际上是正确的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T20:52:08.757

您的最后一种方法几乎是解决方法。我可以建议的唯一更改是不要将整个内容文件保留在内存中流式传输，而是通过缓冲流式传输内容 -来自 Apache commons 的[IOUtils](http://commons.apache.org/io/api-release/org/apache/commons/io/IOUtils.html#copy%28java.io.InputStream,%20java.io.OutputStream%29)可以为您执行此操作。

# java - 可以本地覆盖最终方法吗？

> ID：14005474
> 
> 赞同：3
> 
> 时间：2012-12-22T18:36:36.170
> 
> 标签：java, methods, final

```
public class Test  {  

    public static void main(String args[]){
        Test t = new Test();
        t.inner();

    }
    public final void print() { 
        System.out.print("main"); 
    }      

    public void inner() {       
        class TestInner {           
            void print(){
                System.out.print("sub");                
            }

        }
        TestInner inner =new TestInner();
        inner.print();
        print();
    }
} 
```

输出：子主

问题：Test 类中的 print() 方法是最终方法，本地类可以访问，但本地类仍然可以再次定义 print() 方法怎么办？

如果我们在超类中声明 private final x()，它在子类中是不可访问的，所以我们可以在子类中定义 x()。

如果我们在超类中声明 public final x()，它可以在子类中访问，所以我们不能在子类中定义 x()。

谁能解释一下？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T18:43:39.433

内部类没有覆盖该`final`方法。

内部类必须*扩展*外部类才能覆盖外部类的方法。

这两个类是独立的，彼此无关，除了外部类包含内部类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T18:44:33.523

因为 TestInner 类没有扩展 Test 类，所以它有自己独立的命名空间。

它没有任何技巧，它不会覆盖测试类的打印方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-21T03:49:39.920

内部类没有覆盖 final 方法。

内部类必须扩展外部类才能覆盖外部类的方法。

这两个类是独立的，彼此无关，除了外部类包含内部类。

# couchdb - 特定的 couchdb 视图突然开始超时

> ID：14005478
> 
> 赞同：5
> 
> 时间：2012-12-22T18:37:08.220
> 
> 标签：couchdb

我有三个具体的观点在顺利工作两年后突然开始崩溃。同一数据库上的其他视图就可以了。这是蒲团的错误：

```
Error: os_process_error
OS process timed out. 
```

Couchdb 版本是 1.2.0。

这是崩溃报告日志：

```
[Sat, 22 Dec 2012 18:28:53 GMT] [error] [<0.1434.0>] OS Process Error <0.1331.0> :: {os_process_error,
                                                 "OS process timed out."}
[Sat, 22 Dec 2012 18:28:53 GMT] [error] [emulator] Error in process <0.1434.0> with exit value: {{nocatch,{os_process_error,"OS process timed out."}},[{couch_os_process,prompt,2,[{file,"/usr/src/build-couchdb/dependencies/couchdb/src/couchdb/couch_os_process.erl"},{line,57}]},{couch_query_servers,map_doc_raw... 

[Sat, 22 Dec 2012 18:28:53 GMT] [error] [<0.1427.0>] ** Generic server <0.1427.0> terminating 
** Last message in was {'EXIT',<0.1431.0>,
                       {{nocatch,
                            {os_process_error,"OS process timed out."}},
                        [{couch_os_process,prompt,2,
                             [{file,
                                  "/usr/src/build-couchdb/dependencies/couchdb/src/couchdb/couch_os_process.erl"},
                              {line,57}]},
                         {couch_query_servers,map_doc_raw,2,
                             [{file,
                                  "/usr/src/build-couchdb/dependencies/couchdb/src/couchdb/couch_query_servers.erl"},
                              {line,88}]},
                         {couch_view_updater,'-do_maps/3-fun-0-',3,
                             [{file,
                                  "/usr/src/build-couchdb/dependencies/couchdb/src/couchdb/couch_view_updater.erl"},
                              {line,174}]},
                         {couch_view_updater,do_maps,3,
                             [{file,
                                  "/usr/src/build-couchdb/dependencies/couchdb/src/couchdb/couch_view_updater.erl"},
                              {line,169}]}]}}
** When Server state == {group_state,undefined,<<"anypy_suggest">>,
                     {"/usr/src/build-couchdb/build/var/lib/couchdb",
                      <<"anypy_suggest">>,
                      {group,
                       <<179,2,154,154,243,188,196,230,224,228,72,35,138,
                         126,255,36>>,
                       nil,<<"_design/message">>,<<"javascript">>,[],
                       [{view,0,0,0,[],
                         <<"function(doc) {\n\t\n\t// test if messages shoud be emitted\n\tvar emit_all = function(messages) {\n\t\tfor(var i in messages) {\n\t\t\tvar d = messages[i].when.split(\"-\");\n\t\t\tvar day = d[2].split(\"T\");\n\t\t\temit([d[0]+'-'+d[1]+'-'+day[0], messages[i].group, messages[i].who], 1);\n\t\t}\n\t};\n\n\n\t// vacation plan level messages\n\tif(doc.doc_type == 'PlanRoute') {\n\n\t\t// route level messages\n\t\tif(doc.messages) \n\t\t\temit_all(doc.messages);\n\n\t\t// destination level messages\n\t\tif(doc.destinations) {\n\t\t\tfor(var i in doc.destinations) {\n\t\t\t\tif(doc.destinations[i].messages) {\n\t\t\t\t\temit_all(doc.destinations[i].messages);\n\t\t\t\t}\n\t\t\t\t// service level messages\n\t\t\t\tif(doc.destinations[i].services) {\n\t\t\t\t\tfor(var ii in doc.destinations[i].services) {\n\t\t\t\t\t\tif(doc.destinations[i].services[ii].messages) {\n\t\t\t\t\t\t\temit_all(doc.destinations[i].services[ii].messages);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}">>,
                         nil,
                         [{<<"by_date">>,
                           <<"function(keys, values) {\n\treturn sum(values)\n}">>}],
                         []},
                        {view,1,0,0,
                         [<<"sent_by">>],
                         <<"function(doc) {\n\t\n\tvar key;\n\n\t// test if messages shoud be emitted\n\tvar emit_all = function(level, key, doc, messages) {\n\t\tfor(var i in messages) {\n\t\t\tdo_emit(level, key, doc, messages, i);\n\t\t}\n\t};\n\n\tvar do_emit = function(level, key, doc, msgs, idx) {\n\t\tmsg = msgs[idx];\n\t\tvar context = [];\n\t\tfor(i=0; i < idx; i++)\n\t\tcontext.push({who:msgs[i].who, message:msgs[i].message});\n\t\tvar ndoc = {\n\t\tmessage:msg.message,\n\t\twhen:msg.when,\n\t\twho:msg.who,\n\t\tgroup:msg.group,\n\t\tviewed_by:msg.viewed_by,\n\t\tlevel: level,\n\t\tdoc_id: doc._id,\n\t\tdoc_type: doc.doc_type,\n\t\tdoc_title: doc.name,\n\t\tcontext: context,\n\t\t};\n\n\t\tkeys = [msg.who, msg.when];\n\t\temit(keys, ndoc);\n\t};\n\n\t// vacation plan level messages\n\tif(doc.doc_type == 'PlanRoute') {\n\t\tkey = doc.staff_id;\n\n\t\t// route level messages\n\t\tif(doc.messages) \n\t\t\temit_all('', key, doc, doc.messages);\n\n\t\t// destination level messages\n\t\tif(doc.destinations) {\n\t\t\tfor(var i in doc.destinations) {\n\t\t\t\tif(doc.destinations[i].messages) {\n\t\t\t\t\tvar level = 'Destination ('+doc.destinations[i].destination_id+') on VP leg #' + doc.destinations[i].leg;\n\t\t\t\t\temit_all(level, key, doc, doc.destinations[i].messages);\n\t\t\t\t}\n\t\t\t\t// service level messages\n\t\t\t\tif(doc.destinations[i].services && doc.destinations[i].services.length > 0) {\n\t\t\t\t\tfor(var ii in doc.destinations[i].services) {\n\t\t\t\t\t\tif(doc.destinations[i].services[ii].messages) {\n\t\t\t\t\t\t\tvar level = doc.destinations[i].services[ii].desc;\n\t\t\t\t\t\t\temit_all(level, key, doc, doc.destinations[i].services[ii].messages, ii);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}">>,
                         nil,[],[]},
                        {view,2,0,0,
                         [<<"unviewed_by">>],
                         <<"function(doc) {\n\t\n\tvar key;\n\n\t// test if messages shoud be emitted\n\tvar test_and_emit = function(level, group_not, key, doc, messages) {\n\t\tfor(var i in messages) {\n\t\t\tif(messages[i].group != group_not && messages[i].viewed_by.indexOf(key) == -1) {\n\t\t\t\t// key not in the list, emit this message and doc details\n\t\t\t\tdo_emit(level, key, doc, messages, i);\n\t\t\t}\n\t\t}\n\t};\n\n\tvar do_emit = function(level, key, doc, msgs, idx) {\n\t\tmsg = msgs[idx];\n\t\tvar context = [];\n\t\tfor(i=0; i < idx; i++)\n\t\tcontext.push({who:msgs[i].who, message:msgs[i].message});\n\t\tvar ndoc = {\n\t\tmessage:msg.message,\n\t\twhen:msg.when,\n\t\twho:msg.who,\n\t\tgroup:msg.group,\n\t\tviewed_by:msg.viewed_by,\n\t\tlevel: level,\n\t\tdoc_id: doc._id,\n\t\tdoc_type: doc.doc_type,\n\t\tdoc_title: doc.name,\n\t\tcontext: context,\n\t\t};\n\t\temit(key, ndoc);\n\t};\n\n\t// suggest level messages\n\tif(doc.doc_type == 'ReserveSuggest') {\n\t\tkey = doc.staff_id;\n\t\t\n\t\t// doc level messages\n\t\tif(doc.messages) \n\t\t\ttest_and_emit('','staff', key, doc, doc.messages);\n\t\n\t\t// suggest level messages\n\t\tif(doc.suggests) {\n\t\t\tfor(var i in doc.suggests) {\n\t\t\t\tif(doc.suggests[i].messages) {\n\t\t\t\t\tvar level = doc.suggests[i].desc;\n\t\t\t\t\ttest_and_emit(level, 'staff', key, doc, doc.suggests[i].messages, ii);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// vacation plan level messages\n\tif(doc.doc_type == 'PlanRoute') {\n\t\tkey = doc.staff_id;\n\n\t\t// route level messages\n\t\tif(doc.messages) \n\t\t\ttest_and_emit('','staff', key, doc, doc.messages);\n\n\t\t// destination level messages\n\t\tif(doc.destinations) {\n\t\t\tfor(var i in doc.destinations) {\n\t\t\t\tif(doc.destinations[i].messages) {\n\t\t\t\t\tvar level = 'Destination ('+doc.destinations[i].destination_id+') on VP leg #' + doc.destinations[i].leg;\n\t\t\t\t\ttest_and_emit(level, 'staff', key, doc, doc.destinations[i].messages);\n\t\t\t\t}\n\t\t\t\t// service level messages\n\t\t\t\tif(doc.destinations[i].services && doc.destinations[i].services.length > 0) {\n\t\t\t\t\tfor(var ii in doc.destinations[i].services) {\n\t\t\t\t\t\tif(doc.destinations[i].services[ii].messages) {\n\t\t\t\t\t\t\tvar level = 'Service (' + doc.destinations[i].services[ii].type + ')';\n\t\t\t\t\t\t\ttest_and_emit(level, 'staff', key, doc, doc.destinations[i].services[ii].messages, ii);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}">>,
                         nil,[],[]}],
                       {[]},
                       nil,0,0,nil,nil}},
                     {group,
                      <<179,2,154,154,243,188,196,230,224,228,72,35,138,
                        126,255,36>>,
                      <0.1428.0>,<<"_design/message">>,<<"javascript">>,
                      [],
                      [{view,0,503333,0,[],
                        <<"function(doc) {\n\t\n\t// test if messages shoud be emitted\n\tvar emit_all = function(messages) {\n\t\tfor(var i in messages) {\n\t\t\tvar d = messages[i].when.split(\"-\");\n\t\t\tvar day = d[2].split(\"T\");\n\t\t\temit([d[0]+'-'+d[1]+'-'+day[0], messages[i].group, messages[i].who], 1);\n\t\t}\n\t};\n\n\n\t// vacation plan level messages\n\tif(doc.doc_type == 'PlanRoute') {\n\n\t\t// route level messages\n\t\tif(doc.messages) \n\t\t\temit_all(doc.messages);\n\n\t\t// destination level messages\n\t\tif(doc.destinations) {\n\t\t\tfor(var i in doc.destinations) {\n\t\t\t\tif(doc.destinations[i].messages) {\n\t\t\t\t\temit_all(doc.destinations[i].messages);\n\t\t\t\t}\n\t\t\t\t// service level messages\n\t\t\t\tif(doc.destinations[i].services) {\n\t\t\t\t\tfor(var ii in doc.destinations[i].services) {\n\t\t\t\t\t\tif(doc.destinations[i].services[ii].messages) {\n\t\t\t\t\t\t\temit_all(doc.destinations[i].services[ii].messages);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}">>,
                        {btree,<0.1428.0>,
                         {829460268,{128035,[128035]},6593177},
                         #Fun<couch_btree.3.62781489>,
                         #Fun<couch_btree.4.62781489>,
                         #Fun<couch_view.less_json_ids.2>,
                         #Fun<couch_view_group.10.74547581>,snappy},
                        [{<<"by_date">>,
                          <<"function(keys, values) {\n\treturn sum(values)\n}">>}],
                        []},
                       {view,1,503333,0,
                        [<<"sent_by">>],
                        <<"function(doc) {\n\t\n\tvar key;\n\n\t// test if messages shoud be emitted\n\tvar emit_all = function(level, key, doc, messages) {\n\t\tfor(var i in messages) {\n\t\t\tdo_emit(level, key, doc, messages, i);\n\t\t}\n\t};\n\n\tvar do_emit = function(level, key, doc, msgs, idx) {\n\t\tmsg = msgs[idx];\n\t\tvar context = [];\n\t\tfor(i=0; i < idx; i++)\n\t\tcontext.push({who:msgs[i].who, message:msgs[i].message});\n\t\tvar ndoc = {\n\t\tmessage:msg.message,\n\t\twhen:msg.when,\n\t\twho:msg.who,\n\t\tgroup:msg.group,\n\t\tviewed_by:msg.viewed_by,\n\t\tlevel: level,\n\t\tdoc_id: doc._id,\n\t\tdoc_type: doc.doc_type,\n\t\tdoc_title: doc.name,\n\t\tcontext: context,\n\t\t};\n\n\t\tkeys = [msg.who, msg.when];\n\t\temit(keys, ndoc);\n\t};\n\n\t// vacation plan level messages\n\tif(doc.doc_type == 'PlanRoute') {\n\t\tkey = doc.staff_id;\n\n\t\t// route level messages\n\t\tif(doc.messages) \n\t\t\temit_all('', key, doc, doc.messages);\n\n\t\t// destination level messages\n\t\tif(doc.destinations) {\n\t\t\tfor(var i in doc.destinations) {\n\t\t\t\tif(doc.destinations[i].messages) {\n\t\t\t\t\tvar level = 'Destination ('+doc.destinations[i].destination_id+') on VP leg #' + doc.destinations[i].leg;\n\t\t\t\t\temit_all(level, key, doc, doc.destinations[i].messages);\n\t\t\t\t}\n\t\t\t\t// service level messages\n\t\t\t\tif(doc.destinations[i].services && doc.destinations[i].services.length > 0) {\n\t\t\t\t\tfor(var ii in doc.destinations[i].services) {\n\t\t\t\t\t\tif(doc.destinations[i].services[ii].messages) {\n\t\t\t\t\t\t\tvar level = doc.destinations[i].services[ii].desc;\n\t\t\t\t\t\t\temit_all(level, key, doc, doc.destinations[i].services[ii].messages, ii);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}">>,
                        {btree,<0.1428.0>,
                         {829552398,{108630,[]},204390994},
                         #Fun<couch_btree.3.62781489>,
                         #Fun<couch_btree.4.62781489>,
                         #Fun<couch_view.less_json_ids.2>,
                         #Fun<couch_view_group.10.74547581>,snappy},
                        [],[]},
                       {view,2,503333,0,
                        [<<"unviewed_by">>],
                        <<"function(doc) {\n\t\n\tvar key;\n\n\t// test if messages shoud be emitted\n\tvar test_and_emit = function(level, group_not, key, doc, messages) {\n\t\tfor(var i in messages) {\n\t\t\tif(messages[i].group != group_not && messages[i].viewed_by.indexOf(key) == -1) {\n\t\t\t\t// key not in the list, emit this message and doc details\n\t\t\t\tdo_emit(level, key, doc, messages, i);\n\t\t\t}\n\t\t}\n\t};\n\n\tvar do_emit = function(level, key, doc, msgs, idx) {\n\t\tmsg = msgs[idx];\n\t\tvar context = [];\n\t\tfor(i=0; i < idx; i++)\n\t\tcontext.push({who:msgs[i].who, message:msgs[i].message});\n\t\tvar ndoc = {\n\t\tmessage:msg.message,\n\t\twhen:msg.when,\n\t\twho:msg.who,\n\t\tgroup:msg.group,\n\t\tviewed_by:msg.viewed_by,\n\t\tlevel: level,\n\t\tdoc_id: doc._id,\n\t\tdoc_type: doc.doc_type,\n\t\tdoc_title: doc.name,\n\t\tcontext: context,\n\t\t};\n\t\temit(key, ndoc);\n\t};\n\n\t// suggest level messages\n\tif(doc.doc_type == 'ReserveSuggest') {\n\t\tkey = doc.staff_id;\n\t\t\n\t\t// doc level messages\n\t\tif(doc.messages) \n\t\t\ttest_and_emit('','staff', key, doc, doc.messages);\n\t\n\t\t// suggest level messages\n\t\tif(doc.suggests) {\n\t\t\tfor(var i in doc.suggests) {\n\t\t\t\tif(doc.suggests[i].messages) {\n\t\t\t\t\tvar level = doc.suggests[i].desc;\n\t\t\t\t\ttest_and_emit(level, 'staff', key, doc, doc.suggests[i].messages, ii);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// vacation plan level messages\n\tif(doc.doc_type == 'PlanRoute') {\n\t\tkey = doc.staff_id;\n\n\t\t// route level messages\n\t\tif(doc.messages) \n\t\t\ttest_and_emit('','staff', key, doc, doc.messages);\n\n\t\t// destination level messages\n\t\tif(doc.destinations) {\n\t\t\tfor(var i in doc.destinations) {\n\t\t\t\tif(doc.destinations[i].messages) {\n\t\t\t\t\tvar level = 'Destination ('+doc.destinations[i].destination_id+') on VP leg #' + doc.destinations[i].leg;\n\t\t\t\t\ttest_and_emit(level, 'staff', key, doc, doc.destinations[i].messages);\n\t\t\t\t}\n\t\t\t\t// service level messages\n\t\t\t\tif(doc.destinations[i].services && doc.destinations[i].services.length > 0) {\n\t\t\t\t\tfor(var ii in doc.destinations[i].services) {\n\t\t\t\t\t\tif(doc.destinations[i].services[ii].messages) {\n\t\t\t\t\t\t\tvar level = 'Service (' + doc.destinations[i].services[ii].type + ')';\n\t\t\t\t\t\t\ttest_and_emit(level, 'staff', key, doc, doc.destinations[i].services[ii].messages, ii);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}">>,
                        {btree,<0.1428.0>,
                         {829591489,{139,[]},306902},
                         #Fun<couch_btree.3.62781489>,
                         #Fun<couch_btree.4.62781489>,
                         #Fun<couch_view.less_json_ids.2>,
                         #Fun<couch_view_group.10.74547581>,snappy},
                        [],[]}],
                      {[]},
                      {btree,<0.1428.0>,
                       {829452501,[],6016985},
                       #Fun<couch_btree.3.62781489>,
                       #Fun<couch_btree.4.62781489>,
                       #Fun<couch_btree.5.62781489>,nil,snappy},
                      503333,0,nil,nil},
                     <0.1431.0>,nil,false,
                     [{{<0.130.0>,#Ref<0.0.0.41069>},509735}],
                     <0.1430.0>,false}
** Reason for termination == 
** {os_process_error,"OS process timed out."}

[Sat, 22 Dec 2012 18:28:53 GMT] [error] [<0.1427.0>] {error_report,<0.31.0>,
                  {<0.1427.0>,crash_report,
                   [[{initial_call,
                      {couch_view_group,init,['Argument__1']}},
                     {pid,<0.1427.0>},
                     {registered_name,[]},
                     {error_info,
                      {exit,
                       {os_process_error,"OS process timed out."},
                       [{gen_server,terminate,6,
                         [{file,"gen_server.erl"},{line,737}]},
                        {proc_lib,init_p_do_apply,3,
                         [{file,"proc_lib.erl"},{line,227}]}]}},
                     {ancestors,[<0.1426.0>]},
                     {messages,[]},
                     {links,[<0.1428.0>,<0.122.0>]},
                     {dictionary,[]},
                     {trap_exit,true},
                     {status,running},
                     {heap_size,2584},
                     {stack_size,24},
                     {reductions,545}],
                    []]}}
[Sat, 22 Dec 2012 18:28:53 GMT] [error] [<0.130.0>] Uncaught server error: {os_process_error,
                                        <<"OS process timed out.">>}
[Sat, 22 Dec 2012 18:28:53 GMT] [error] [<0.1428.0>] ** Generic server <0.1428.0> terminating 
** Last message in was {'EXIT',<0.1427.0>,
                           {os_process_error,"OS process timed out."}}
** When Server state == {file,{file_descriptor,prim_file,{#Port<0.2941>,101}},
                          829595830}
** Reason for termination == 
** {os_process_error,"OS process timed out."}

[Sat, 22 Dec 2012 18:28:53 GMT] [error] [<0.1428.0>] {error_report,<0.31.0>,
                  {<0.1428.0>,crash_report,
                   [[{initial_call,{couch_file,init,['Argument__1']}},
                     {pid,<0.1428.0>},
                     {registered_name,[]},
                     {error_info,
                      {exit,
                       {os_process_error,"OS process timed out."},
                       [{gen_server,terminate,6,
                         [{file,"gen_server.erl"},{line,737}]},
                        {proc_lib,init_p_do_apply,3,
                         [{file,"proc_lib.erl"},{line,227}]}]}},
                     {ancestors,[<0.1427.0>,<0.1426.0>]},
                     {messages,[{'EXIT',<0.1430.0>,shutdown}]},
                     {links,[]},
                     {dictionary,[]},
                     {trap_exit,true},
                     {status,running},
                     {heap_size,377},
                     {stack_size,24},
                     {reductions,1125}],
                    []]}} 
```

此外，即使关联的请求正常返回，我也经常在日志中看到此错误：

```
[Sat, 22 Dec 2012 19:20:28 GMT] [info] [<0.3849.0>] checkpointing view update at seq 232409 for xxxx _design/all_types
[Sat, 22 Dec 2012 19:20:28 GMT] [error] [<0.124.0>] {error_report,<0.31.0>,
                 {<0.124.0>,crash_report,
                  [[{initial_call,
                     {mochiweb_socket_server,init,['Argument__1']}},
                    {pid,<0.124.0>},
                    {registered_name,[]},
                    {error_info,
                     {exit,eaddrinuse,
                      [{gen_server,init_it,6,
                        [{file,"gen_server.erl"},{line,313}]},
                       {proc_lib,init_p_do_apply,3,
                        [{file,"proc_lib.erl"},{line,227}]}]}},
                    {ancestors,
                     [couch_secondary_services,couch_server_sup,<0.32.0>]},
                    {messages,[]},
                    {links,[<0.93.0>]},
                    {dictionary,[]},
                    {trap_exit,true},
                    {status,running},
                    {heap_size,987},
                    {stack_size,24},
                    {reductions,466}],
                   []]}} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T18:59:13.090

在视图索引更新期间，CouchDB 运行指定设计文档的更新视图。这也意味着超时错误适用于整个这个组，而不是特定的视图功能。对于您的情况，此错误意味着您的视图组现在对于某些文档的运行速度不如以前快（单个文档适用于整个组） - 可能，他们现在有一些大事。

然而，这个错误并不是致命的，它只是一个限制，让查询服务器不要运行太久，并激励你编写快速和优化的函数（快速处理 -> 快速响应）。我在您的视图中看到“for”循环 - 可能有可能降低它们对于大消息列表的复杂性？无论如何，您总是可以通过更新 CouchDB 配置来延长操作系统进程超时：

```
curl -X PUT http://localhost:5984/_config/couchdb/os_process_timeout -d '"35000"' 
```

将 3500 替换为您喜欢的号码。该值定义了查询服务器在由于超时而终止之前可以处理 CouchDB 命令（查看索引、设计文档功能执行、验证、过滤器等）的毫秒数。响应 curl 请求，您将获得旧的配置值。

**编辑**：替换`query_servers_config/os_process_limit`为`couchdb/os_process_timeout`. 这是两个不同的选项：第一个控制可以为单一 ddoc 语言运行的查询服务器进程的数量，而第二个指定实际执行时间限制。

# ruby-on-rails - 带有嵌套记录的 mark_for_destruction

> ID：14005480
> 
> 赞同：1
> 
> 时间：2012-12-22T18:37:23.533
> 
> 标签：ruby-on-rails, ruby, nested-attributes, before-save

在我的应用程序中，我`mark_for_destruction`用来根据条件删除嵌套记录。

我有一个`Ticket`模型和一个`Pick`模型：

```
class Ticket < ActiveRecord::Base
  has_many :picks
  accepts_nested_attributes_for :picks
  attr_accessible :picks_attributes

  before_save :mark_destroy_zero_weighted_picks

  def mark_destroy_zero_weighted_picks
    picks.each do |pick|
      pick.mark_for_destruction if pick.weight.to_i == 0
    end
  end
end

class Pick < ActiveRecord::Base
  belongs_to :ticket
  attr_accessible :ticket_id
  attr_accessible :weight
end 
```

如果有一张带有 4 个选秀权的票与之关联，则有 weight `1,0,2,1`；然后在创建新的票证记录时，只有第一个选秀权被保存，加权选秀权之后的所有其他选秀`0`权（这是真的）被删除。`marked_for_destruction`如果我编辑记录但在创建新记录时不起作用，它可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T23:11:59.947

在我看来，rails 3.2.3 中有一个错误 - 我没有看到 3.2.12 的这个问题，但我不确定它什么时候得到修复。

也就是说，解决这个问题的一种更简单的方法可能是对接受嵌套属性_for使用reject_if选项：

```
class Ticket < ActiveRecord::Base
  has_many :picks
  accepts_nested_attributes_for :picks,
    :reject_if => lambda { |attributes| attributes[:weight].to_i == 0 },
    :allow_destroy => true
  attr_accessible :picks_attributes
end 
```

这将默默地拒绝所有权重为 0 的新选择。它唯一没有解决的问题是更新案例，如果您希望在将现有选择更新为权重为 0 时将其删除，但您有一个删除无论如何选择链接以允许这样做。

# java - Java中的反射（区分两种类型）

> ID：14005482
> 
> 赞同：0
> 
> 时间：2012-12-22T18:37:31.277
> 
> 标签：java, reflection

在我的程序中，我将**2 个字符串**传递给某种方法进行评估。该方法必须获取`Class`这些字符串的类（如果它是真正的类名！）并比较它们的共性。字符串可以有 2 种类型的输入：

1.  Java API 中的类名，如“java.lang.Byte”、“java.lang.Math”等。
2.  任何其他可能的字符串，例如“some string”、“hello”等。

在我获取这两个字符串的方法中，我怎么能理解它是 1 型还是 2 型，所以不能得到`Exception`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:10:22.103

我怀疑是否有一个完美的条件来检查它，因为“Hello”是一个与 java.lang.Byte 一样好的有效类名。您可以根据有效的 java 标识符验证字符串[http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.8](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.8)

所以要进行两项检查： 1\. 检查有效的 java 类名。2\. 尝试 Class.forName() 加载类。如果类在类路径中不存在，这将通过 ClassNotFoundException。

使用了我在其他一些链接中找到的简单正则表达式来验证类名

```
String regexForBasicClassNameValidation = "([a-zA-Z_$][a-zA-Z\\d_$]*\\.)*[a-zA-Z_$][a-zA-Z\\d_$]*" ;
     if(inputString.matches(regexForBasicClassNameValidation))
     {
     try {
            Class.forName(inputString) ;
            System.out.println("Valid class name");
    } catch (ClassNotFoundException e) {
        System.out.println("Invalid Class name or class not found in classpath ");

    }
     }
     else
     {
     System.out.println("Not a class name");
     } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:44:13.840

[Class.forName() 的 JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#forName%28java.lang.String%29)

```
Class clazz = null;
try 
{
    clazz = Class.forName(myString);    
} 
catch (ClassNotFoundException e) 
{
    System.out.println("This isn't a class");
} 
```

# iphone - 我创建了一个简单的球类游戏。现在我试着让球移动得更快……有人知道吗？

> ID：14005483
> 
> 赞同：2
> 
> 时间：2012-12-22T18:37:33.177
> 
> 标签：iphone, objective-c, nsarray

我想移动得更快的球是*敌人；

我希望*敌人在 20 秒后在不触球的情况下移动得更快。*player 球是您可以控制的球。在这个游戏中，你不能触碰敌人的球。

我希望敌人的球每 20 秒变得更快.. 我在想一些带有数组循环的东西..

谢谢你的帮忙

* * *

## 。H

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController {
    IBOutlet UIButton *startButton;
    NSTimer *randomMain;

    CGPoint pos; 
    IBOutlet UIImageView *enemy;
    IBOutlet UIImageView *player;

    int MainInt;
    IBOutlet UILabel *seconds;

    IBOutlet UILabel *lastTime;
    IBOutlet UILabel *theTime;
}

@property (nonatomic, retain) NSTimer *numro;

- (IBAction)start;
@end 
```

* * *

## .m

```
#import "ViewController.h"

@implementation ViewController

@synthesize numro;

- (IBAction)start {
    [startButton setHidden:YES];
    randomMain = [NSTimer scheduledTimerWithTimeInterval:(0.03)
      target:self selector: @selector(onTimer) userInfo:(nil) repeats:YES];
    numro = [NSTimer scheduledTimerWithTimeInterval:(1.0)
      target:self selector:@selector(countup) userInfo:nil repeats:YES];
    MainInt = 0;
    [lastTime setHidden:YES];
    [theTime setHidden:YES];
}

-(void)countup {
    MainInt += 1;
    seconds.text = [NSString stringWithFormat:@"%i", MainInt];

// I TRIED IT WITH "IF"  BUT IT I DONT WANT TO WRITE THIS FOR EVERY 20 SECONDS

    if (MainInt == 20) {
        randomMain = [NSTimer scheduledTimerWithTimeInterval:(0.002)
      target:self selector: @selector(checkCollision) userInfo:(nil) repeats:YES];
    }
     /*   if (MainInt == 40) {
        randomMain = [NSTimer scheduledTimerWithTimeInterval:(0.01)
      target:self selector: @selector(onTimer) userInfo:(nil) repeats:YES];
    }*/
}

-(void)onTimer{
    [self checkCollision];
    enemy.center = CGPointMake(enemy.center.x+pos.x,enemy.center.y+pos.y);
    if (enemy.center.x > 320 || enemy.center.x < 0)
        pos.x = -pos.x;
    if (enemy.center.y > 480 || enemy.center.y < 0)
        pos.y = -pos.y;
}

- (void)checkCollision {
    if( CGRectIntersectsRect(player.frame,enemy.frame))
    {
        [randomMain invalidate];
      [startButton setHidden:NO];

        CGRect frame = [player frame];
        frame.origin.x = 137.0f;
        frame.origin.y = 326.0;
        [player setFrame: frame];

        CGRect frame2 = [enemy frame];
        frame2.origin.x = 137.0f;
        frame2.origin.y = 20.0;
        [enemy setFrame: frame2];

  UIAlertView *alert =[[UIAlertView alloc]initWithTitle:@"AAA"
        message: [NSString stringWithFormat:@"BBB"] delegate:nil 
                 cancelButtonTitle:@"Dismiss" otherButtonTitles:nil];
        [alert show];
        MainInt = 0 ;
        [numro invalidate];
        [lastTime setHidden:NO];
        [theTime setHidden:NO];
        theTime.text = seconds.text;
    }
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *myTouch = [[event allTouches] anyObject];
    player.center = [myTouch locationInView:self.view]; //player ball
}

-(void)viewDidLoad {
    [lastTime setHidden:YES];
    [super viewDidLoad];
    // X Speed Y Speed
    //I tried to do anything with the X and Y speed ... but it didn't work
    pos = CGPointMake(5.0,4.0);
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:40:33.440

更改方法中`if`的块`countup`如下...

```
if(MainInt % 20 == 0) {    //True every 20th second

   int speedUpCount=MainInt/20;
   float interval=1.0-(speedUpCount/10.0);

   [randomMain invalidate];   //Must stop the previous timer

   randomMain = [NSTimer scheduledTimerWithTimeInterval:interval target:self selector: @selector(checkCollision) userInfo:(nil) repeats:YES];
} 
```

希望这将有助于解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:50:37.143

// 现在，从第 20 秒开始，球每秒钟都变得更快 :S

```
-(void)countup {

MainInt += 1;
seconds.text = [NSString stringWithFormat:@"%i", MainInt];

if(MainInt % 20 == 0) {    //True every 20th second

    int speedUpCount=MainInt/20;
    float interval=1.0 - (speedUpCount/1000.0);

    [randomMain invalidate];   //Must stop the previous timer
    randomMain = [NSTimer scheduledTimerWithTimeInterval:interval target:self selector: @selector(start) userInfo:(nil) repeats:YES]; 
```

# java - JSlider 旋钮未更新（基本 Java）

> ID：14005488
> 
> 赞同：0
> 
> 时间：2012-12-22T18:38:35.653
> 
> 标签：java, swing, jslider

我正在用 Java 实现一个简单的水平 JSlider。没有刻度线或类似的东西。可能和人类想象的一样简单。

当我尝试通过用鼠标拖动 JSlider 左右“移动”它时，它的数值*确实会*更新（我设置了一个`system.out`打印语句来报告滑块的变化值，它们看起来很好）。

但是，滑块旋钮*本身*不会移动。它只是停留在初始化期间开始的位置。关于这方面，“每个 JSlider 都应该拥有”某种样板代码吗？

我一直在玩“ChangeListener”的东西，但我一直在死胡同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:46:36.880

对我来说似乎工作正常，请发布[SSCCE](http://sscce.org)以显示具体问题：

![在此处输入图像描述](../Images/5db29805bd760c9d3329a2d44cb801a4.png)

```
import java.awt.BorderLayout;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JSlider;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.UIManager.LookAndFeelInfo;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

public class SwingSliderExample extends JPanel {

    public SwingSliderExample() {

        super(true);
        this.setLayout(new BorderLayout());
        final JSlider slider = new JSlider(JSlider.HORIZONTAL, 0, 50, 25);

        slider.setMinorTickSpacing(2);
        slider.setMajorTickSpacing(10);
        slider.setPaintTicks(true);
        slider.setPaintLabels(true);

        // We'll just use the standard numeric labels for now...
        slider.setLabelTable(slider.createStandardLabels(10));

        slider.addChangeListener(new ChangeListener() {
            @Override
            public void stateChanged(ChangeEvent ce) {
                if (!slider.getValueIsAdjusting()) {//no adjustments are taking place thus we know the value is final
                    System.out.println(slider.getValue());
                }
            }
        });

        add(slider, BorderLayout.CENTER);
    }

    public static void main(String s[]) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    for (LookAndFeelInfo info : UIManager.getInstalledLookAndFeels()) {
                        if ("Nimbus".equals(info.getName())) {
                            UIManager.setLookAndFeel(info.getClassName());
                            break;
                        }
                    }
                } catch (Exception e) {
                    // If Nimbus is not available, you can set the GUI to another look and feel.
                }
                JFrame frame = new JFrame("Slider Example");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new SwingSliderExample());
                frame.pack();
                frame.setVisible(true);
            }
        });
    }
} 
```

**参考：**

*   [http://www.java2s.com/Code/Java/Swing-JFC/AnexampleofJSliderwithdefaultlabels.htm](http://www.java2s.com/Code/Java/Swing-JFC/AnexampleofJSliderwithdefaultlabels.htm)

# java - java或类似语言中的数据访问示例

> ID：14005491
> 
> 赞同：-1
> 
> 时间：2012-12-22T18:38:54.530
> 
> 标签：java, database, flat-file, data-access

有人可以发布或指出一个例子

1.  java中如何进行平面文件数据访问？什么java技术用于此目的？
2.  java中如何进行rdbms数据访问？什么java技术用于此目的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:44:48.190

1.  java.io 用于读取和写入数据到文件。网上有几个很好的教程，比如[这个](http://tutorials.jenkov.com/java-io/index.html)和[这个](http://docs.oracle.com/javase/tutorial/essential/io/index.html)，可以帮助你理解细节。
2.  JDBC 用于连接数据库。同样，网上也有大量的[JDBC 教程。](http://docs.oracle.com/javase/tutorial/jdbc/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T18:44:32.453

> java中如何进行平面文件数据访问？什么java技术用于此目的？

正如 fge 所说，太笼统了。需要更多细节。您使用[文件 I/O](http://docs.oracle.com/javase/tutorial/essential/io/index.html)与文件系统进行交互，但如果您需要与某些特定格式进行交互，那仅仅是开始。

> java中如何进行rdbms数据访问？什么java技术用于此目的？

使用[JDBC](http://docs.oracle.com/javase/tutorial/jdbc/basics/index.html)。您可以找到几乎所有数据库的驱动程序以及大量支持库，以简化数据库访问、事务管理、模式管理等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T18:49:10.567

我可以指导您[阅读 Java 教程](http://docs.oracle.com/javase/tutorial/)吗？特别是[基本 I/O](http://docs.oracle.com/javase/tutorial/essential/io/index.html)和[JDBC 数据库访问](http://docs.oracle.com/javase/tutorial/jdbc/index.html)部分？

# android - 使用谷歌地图 v2 编写 android 应用程序 - 立即崩溃

> ID：14005493
> 
> 赞同：0
> 
> 时间：2012-12-22T18:39:37.807
> 
> 标签：android, google-maps, google-maps-api-2

我是应用程序编程和一般编程的新手。我还在学校学习计算机科学（我是大二学生）。所以请放轻松。我讨厌在论坛上被抨击。

我的问题是我的应用程序将使用谷歌地图作为主窗口立即崩溃。我已经在下面发布了我的所有代码，我正在寻找任何帮助来帮助我启动和运行这个应用程序（或者它不会立即崩溃）。

有几件事可能是错误的：

1) 我现在在这个测试阶段使用 SHA1 调试密钥。这是正确的吗？

2）我是否需要与 java 中的“GoogleMap”类型进行通信以设置起始位置或其他任何东西？

3）我正在我的手机（Galaxy SIII）上测试这个，它过去在简单的布局上工作过，但是测试这个谷歌地图应用程序是否需要手机无法提供的身份验证？

到目前为止，我发现一些有用的链接： [https ://developers.google.com/maps/documentation/android/start#installing_the_google_maps_android_v2_api](https://developers.google.com/maps/documentation/android/start#installing_the_google_maps_android_v2_api)

[Google Maps Android API v2 - 示例代码崩溃](https://stackoverflow.com/questions/13733911/google-maps-android-api-v2-sample-code-crashes)

设置注意事项：我已将 android-support-v4.jar 和 google-play-services.jar 添加到我的参考库中。属性 -> Java 构建路径、库

现在，下面，这是我到目前为止的所有代码！

Java 文件（Main.java）：

```
package com.MYDOMAINNAME.www;

import android.os.Bundle;
import android.support.v4.app.FragmentActivity;

public class MainActivity extends FragmentActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
}
} 
```

xml 文件（主要布局）：

```
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/map"
android:layout_width="match_parent"
android:layout_height="match_parent"
class="com.google.android.gms.maps.SupportMapFragment"/> 
```

程序清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.MYDOMAINNAME.www"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />
<permission
     android:name="com.MYDOMAINNAME.www.permission.MAPS_RECEIVE"
     android:protectionLevel="signature"/>
<uses-permission  android:name="com.MYDOMAINNAME.www.permission.MAPS_RECEIVE"/>
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>

<uses-feature android:glEsVersion="0x00020000" android:required="true"/>

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <uses-library android:name= "com.google.android.maps" />
    <activity
        android:name="com.MYDOMAINNAME.www.Main"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <meta-data
    android:name="com.google.android.maps.v2.API_KEY"
    android:value="MY SHA1 DEBUG KEY"/>
</application>
</manifest> 
```

所以我会问，我需要添加或减去什么来实现这个吗？

非常感谢！

原木猫：

```
12-22 14:45:28.482: E/Trace(10174): error opening trace file: No such file or directory (2)
12-22 14:45:28.482: D/ActivityThread(10174): setTargetHeapUtilization:0.25
12-22 14:45:28.482: D/ActivityThread(10174): setTargetHeapIdealFree:8388608
12-22 14:45:28.482: D/ActivityThread(10174): setTargetHeapConcurrentStart:2097152
12-22 14:45:28.502: D/AndroidRuntime(10174): Shutting down VM
12-22 14:45:28.502: W/dalvikvm(10174): threadid=1: thread exiting with uncaught exception (group=0x4155e438)
12-22 14:45:28.512: E/AndroidRuntime(10174): FATAL EXCEPTION: main
12-22 14:45:28.512: E/AndroidRuntime(10174): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.MYDOMAINAME.www/com.MYDOMAINAME.www.MainActivity}: java.lang.ClassNotFoundException: com.MYDOMAINAME.www.MainActivity
12-22 14:45:28.512: E/AndroidRuntime(10174):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2012)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2113)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at android.app.ActivityThread.access$700(ActivityThread.java:139)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1224)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at android.os.Handler.dispatchMessage(Handler.java:99)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at android.os.Looper.loop(Looper.java:137)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at android.app.ActivityThread.main(ActivityThread.java:4918)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at java.lang.reflect.Method.invokeNative(Native Method)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at java.lang.reflect.Method.invoke(Method.java:511)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1004)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:771)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at dalvik.system.NativeStart.main(Native Method)
12-22 14:45:28.512: E/AndroidRuntime(10174): Caused by: java.lang.ClassNotFoundException: com.MYDOMAINAME.www.MainActivity
12-22 14:45:28.512: E/AndroidRuntime(10174):    at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at android.app.Instrumentation.newActivity(Instrumentation.java:1068)
12-22 14:45:28.512: E/AndroidRuntime(10174):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2003)
12-22 14:45:28.512: E/AndroidRuntime(10174):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:20:00.203

您为 Main 命名的 java 文件是什么？它应该是 Main.java 而不是 MainActivity.java。
如果您查看日志，则会`12-22 14:04:16.043: E/AndroidRuntime(9154): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.gotonight.www/com.gotonight.www.MainActivity}: java.lang.ClassNotFoundException: com.gotonight.www.MainActivity`
尝试查找此行，
`com.gotonight.www.MainActivity`但您的 Main 类是`com.gotonight.www.Main`

# javascript - 多列文本编辑？

> ID：14005494
> 
> 赞同：0
> 
> 时间：2012-12-22T18:39:54.640
> 
> 标签：javascript, text-editor, multiple-columns

使用 Microsoft Office Word，可以同时查看多个页面，并且在向第一页添加新内容时，添加的内容会将之后的内容向前推进。您是否会说存在通过使用 HTML、CSS 和 JavaScript 为网页实现类似功能的更好解决方案？可能有任意数量的页面，并且并非所有页面都可以同时显示。

CSS3 中有一个[多列布局模块](http://www.w3.org/TR/css3-multicol/)，但是编辑部分（以及浏览器支持）呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T09:25:57.687

就像你说的那样，它适用于 CSS 多列。我做了一个类似 wiki 的网站，它使用多列布局和 contenteditable 来编辑文本。我注意到 Chrome 有时会出现处理问题（标签崩溃），但 Firefox 处理得很好。它可能会被修复。

另一个有趣的解决方案是（仍作为工作草案）CSS 区域和“流入”规则。

# javascript - 使用 jQuery 翻译 ajax 输出

> ID：14005496
> 
> 赞同：0
> 
> 时间：2012-12-22T18:40:41.097
> 
> 标签：javascript, jquery, ajax

我正在尝试用 jQuery 翻译一些短语。这段代码大部分都很好用：

```
changeText = function(text, newText){
var currentText = $('span.example').html();  
$('span.example').html(currentText.replace(text,newText)); };
window.setTimeout(function(){changeText("TranslateMe", "Translation")}, 0000); 
```

但是，当您等待 ajax 生成的结果时，它几乎没有用。澄清一下 - 这是一个具有以下过程的搜索脚本：

1.  当您单击搜索时，您会“正常”加载页面的一部分。我可以毫无问题地更改这些文本字符串。

2.  之后，我猜是通过 ajax 动态加载的结果，并且有 div“块”一个接一个地被加载。这些短语不会被翻译。

一种解决方法是等待一段时间，直到所有内容都加载完毕，然后它确实适用于某些部分。例如：

```
window.setTimeout(function(){changeText("TranslateMe", "Translation")}, 20000); 
```

但是，这不是一个好的解决方案，因为用户在一段时间内会以这种方式看到未翻译的字符串。

因此，我正在寻找一种在显示字符串时会更改字符串的解决方案。有没有办法做到这一点？

提前致谢！

编辑：

尝试查理的方法：

```
<script>
changeText = function(text, newText, $el) { 

$el.html(function(i, currentText){
    return currentText.replace(text, newText);
});    
};

$(function(){
changeText(text, newText,$('span.example'));
});

$.ajax({
  success:function(data){
        var $changeEl=$(data).find('span.example');
        changeText(text, newText,$changeEl);

var currentText = $('span.example').html();  
$('span.example').html(currentText.replace(TranslateMe,Translation));
};

  })
})
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:11:20.793

我同意 Tyron 的观点，如果可以的话，您应该向 AJAX 调用添加或修改回调函数。

至于在不访问 ajax 的情况下检测更改和翻译。这样的事情可能会有所帮助。

```
var c = document.getElementById('[ID OF CONTAINER FOR  UNTRANSLATED BLOCKS]');
c.__appendChild = c.appendChild;

//this function catches the element before it is appended
c.appendChild = function(){

    //this applies the change
    c.__appendChild.apply(c, arguments);

    var newBlock = $(c).children().last();
    //this hides the newly added block
    newBlock.hide();
    // now perform your translations on the newBlock contents
        //here
    // and then make the block visible again
    newBlock.show();
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:49:40.647

您最好/最干净的方法是从进行 AJAX 调用的位置添加一个回调，并将内容插入到 div 中。

[如果这对您来说是不可能的，那么如果 DOM 按照此处](https://stackoverflow.com/questions/1091661/detect-element-content-changes-with-jquery)和[此处](https://stackoverflow.com/questions/648996/how-do-i-monitor-the-dom-for-changes)的要求进行更改，您可能会收到回调

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T19:19:28.053

如果您更改函数以添加上下文参数，您可以执行以下操作：

```
changeText = function(text, newText, $el) { 
     /* html method allows for function as argument to modify element*/
    $el.html(function(i, currentText){
        return currentText.replace(text, newText);
    });    
}; 
```

然后在页面加载：

```
$(function(){
    changeText( text, newText,$('span.example'));
}); 
```

在 AJAX 成功中寻找新元素并修改它们：

```
$.ajax({
      success:function(data){
            var $changeEl=$(data).find('span.example');
            changeText( text, newText,$changeEl);
           /* your code that inserts the new html here*/
      })
}) 
```

# ruby-on-rails - 新安装 Rails + Devise 总是得到 401 Unauthorized

> ID：14005500
> 
> 赞同：15
> 
> 时间：2012-12-22T18:40:47.837
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise

我有一个新的 Rails 安装，并正在尝试使用 Devise 设置身份验证。据我所知，我有一个非常基本的设置应该可以工作，但是每当我尝试使用默认的 Devise 登录表单登录时，我都会收到未经授权的错误。我确信我的凭据是正确的，因为我在控制台中创建了一个要测试的用户，如下所示：

```
User.new({:email=>'mark@markdavies.com.au', :priv_level => 'admin', :password=>'mypassword', :password_confirmation=>'mypassword'}).save 
```

我的用户模型：

```
class User < ActiveRecord::Base

  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :recoverable, :rememberable, :trackable, :validatable, :confirmable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me, :priv_level, :unconfirmed_email
  # attr_accessible :title, :body

  has_one :supplier

end 
```

我的日志：

```
Started POST "/admin/user/sign_in" for 127.0.0.1 at 2012-12-22 13:10:56 -0500
Processing by Admin::SessionsController#create as HTML
Parameters: {"utf8"=>"✓", "authenticity_token"=>"wYLsalxN9rTv8P8bvYuT0wZcvlFbu6b1SvoCyKtTCII=", "admin_user"=>{"email"=>"mark@markdavies.com.au", "password"=>"[FILTERED]", "remember_me"=>"0"}, "commit"=>"Sign in"}
User Load (0.2ms)  SELECT "users".* FROM "users" WHERE "users"."email" = 'mark@markdavies.com.au' LIMIT 1
(0.1ms)  begin transaction
(0.0ms)  commit transaction
Completed 401 Unauthorized in 69ms 
```

有什么方法可以让我获得更多关于设计失败的信息吗？当我在控制台中创建用户时，使用的加密与通过表单使用的加密不同吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-22T21:44:22.993

好吧，这个沮丧的小练习结果证明是 RTFM 的一个很好的教训。我已经设置了可确认的设计，当我创建布局时，我忽略了插入以下行：

```
<p class="notice"><%= notice %></p>
<p class="alert"><%= alert %></p> 
```

...正如它在入门指南中明确指出的那样。当我插入这些时，我收到错误消息“您需要在登录前确认您的电子邮件地址。”

在控制台中，我为用户设置了 confirm_at = Time.now，瞧，我现在可以登录了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-19T21:10:13.180

在我的情况下，它是由这个引起的

# 之前（以 401 失败）

`resources :users devise_for :users`

# 之后（成功）

`devise_for :users resources :users`

所以，尝试在 routes.rb 中做出正确的顺序

# iphone - 在另一个方法中调用一个方法？

> ID：14005503
> 
> 赞同：2
> 
> 时间：2012-12-22T18:41:59.230
> 
> 标签：iphone

我有一个委托方法，其中只有一些代码，在输入的数字的末尾放置一个 % 符号。

```
- (void)textFieldDidEndEditing:(UITextField *)UItextfield {
     NSString *oldTextFieldValue = UItextfield.text;
     UItextfield.text = [NSString stringWithFormat:@"%@ %%",oldTextFieldValue];
   } 
```

我可以不这样做，而是采取以下行动

```
-(IBAction)Calculate:(UITextField *)UITextfield;
{
    NSString *oldTextFieldValue = UItextfield.text;
    UItextfield.text = [NSString stringWithFormat:@"%@ %%",oldTextFieldValue];
} 
```

然后在 Delegate 函数中调用那个动作？就像是

```
-(void)textFieldDidEndEditing:(UITextField *)UItextfield {
[self Calculate:self]
} 
```

我试过了，它不起作用。我知道它会让我得到相同的结果，但我只想知道它是否可以完成。我想我在问是否可以在另一种方法（textFieldDidEndEditing）中调用方法（Calculate）以及如何调用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T18:46:53.300

您提供`self`的方法参数是您所在的类的实例。在这种情况下这是错误的，因为方法参数应该是`UITextField`. 试试`[self Calculate:UItextfield]`你的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T19:30:30.380

在大多数编程语言中，从方法调用其他方法一直都在发生。这是一种无需复制/粘贴即可拆分代码并在不同位置重用代码的好方法。

（这对你来说可能太基础了。在那种情况下很抱歉）

如果您也使用标准命名约定，事情可能更容易理解。（'likeThis' 用于变量和方法名；'LikeThis' 用于类名）

```
- (void)textFieldDidEndEditing:(UITextField *)textField {
     NSString *oldTextFieldValue = textField.text;
     textField.text = [NSString stringWithFormat:@"%@ %%",oldTextFieldValue];
} 
```

`textField`这里，是指向刚刚完成编辑的 UITextField 对象的指针。您想将此对象传递给您的新“其他”方法。

```
[self calculate:textField]; 
```

`self`是指向当前类的实例的指针。例如，在名为“MyViewController”的 UIViewController 子类中，self 指的是此类的当前实例。由于该`-calculate`方法是实例方法（以“-”开头），因此需要您使用`self`. 变量`textField`在冒号之后传递。

```
- (void)calculate: (UITextField*)textField {
NSString *oldTextFieldValue = textField.text;
textField.text = [NSString stringWithFormat:@"%@ %%",oldTextFieldValue]; 
```

}

`IBAction`当您希望从 xib 或故事板中的 UIComponent 调用方法时，仅使用关键字。

# git - git push 错误：HTTP 请求失败：请求的 URL 返回 504

> ID：14005505
> 
> 赞同：12
> 
> 时间：2012-12-22T18:42:38.760
> 
> 标签：git, github, tortoisegit

在将我的更改推送到 GITHub 中的 master 时，我在 Tortoise Git 中收到错误 git did not exitly (exit code 128)

```
git.exe push -v --progress  "origin" master:master

Pushing to https://github.com/myproj/Net.git
error: The requested URL returned 
error: 504 while accessing 
https://github.com/myproj/Net.git/info/refs?service=git-receive-pack
fatal: HTTP request failed

git did not exit cleanly (exit code 128) (63228 ms @ 22-12-2012 23:57:48) 
```

我已经提到[如何解决 TortoiseGit 上的“git 没有完全退出（退出代码 128）”错误？](https://stackoverflow.com/questions/9617336/how-to-resolve-git-did-not-exit-cleanly-exit-code-128-error-on-tortoisegit)

但我使用的是 HTTPS 而不是 SSH。我的意思是我使用来自 GITHub 的 HTTPS url 克隆。我也不知道如何生成 SSH！

![在此处输入图像描述](../Images/df1aa754624615f7aa5332fca6dd2b30.png)

会解决什么问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-23T00:44:53.543

如此处所述：

> 504 Gateway Timeout 错误是一个 HTTP 状态代码，这意味着一台服务器在尝试加载网页或填充浏览器的另一个请求时没有收到来自它正在访问的另一台服务器的及时响应。
> 
> 这通常意味着另一台服务器已关闭或无法正常工作。

这与当前的[GitHub 状态](https://status.github.com/)（12 月 22 日）一致：

> 我们目前正在经历所有服务的重大服务中断。

因此，虽然原因非常及时且特定于 GitHub 端当前的网络问题，但您的问题可以帮助其他人提供类似的错误消息：

504表示：上游服务器有问题。

# mysql - Hibernate 自定义 sql 查询

> ID：14005506
> 
> 赞同：1
> 
> 时间：2012-12-22T18:42:40.603
> 
> 标签：mysql, hibernate

我正在尝试通过休眠执行以下报告 mysql 查询，但我无法使用休眠限制和投影选项成功。

```
SELECT sum(totalprice) as totalprice, hour(createdate) as createdate where day(createdate) = day(curdate()) group by day(createdate), hour(createdate) 
```

谁能帮我把这个 sql 查询转换成休眠格式？或者有没有更好的选择来执行这些复杂的 sql 查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T18:51:19.993

为什么你不能使用存储过程来在休眠调用的情况下简化你的实现？

# c - 指针的递增指针

> ID：14005507
> 
> 赞同：1
> 
> 时间：2012-12-22T18:42:53.800
> 
> 标签：c, pointers

我试图弄清楚我将如何增加一个指针指针以指向我想要的值。这本质上是一个指向 cstrings 的指针数组，我想增加指针以指向 xx 指针。为了坚持我当前的应用程序，如果我想指向我可以做的第五个指针（指针定义为`char **pointer`）

```
*pointer++;
*pointer++;
*pointer++;
*pointer++;
*pointer++; 
```

我现在将设置`*pointer[0]`我想要的第五个指针。我只是在寻找一种方法来把它清理成一个 1 班轮。我尝试了不同的方法来解决这个问题，但我还没有找到一个可行的解决方案。我的最后一次尝试是

```
*pointer += (sizeof(pointer) * 5); 
```

但它没有用。我认为如果我在系统上获得一个指针的大小（4 个字节）并将其乘以我希望跳过的指针的数量，它会做与垃圾邮件`*pointer++`调用相同的事情。在我增加我的指针后，我使用以下内容打印其余的 cstrings，直到遇到指针数组的末尾。

```
while(*pointer[0])
{
   printf("data: %s\n", *pointer);
   pointer++;
} 
```

总的来说，我需要帮助将 5 个`*pointer++;`电话变成 1 个班轮。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:51:06.757

如果您想将指针递增`5`，只需执行以下操作：

```
pointer += 5; 
```

这在 C 中很好，它被称为*指针算术*：编译器将计算出指向对象的大小并添加正确数量的可寻址单元。如果乘以`5`指针的大小，结果将不是您所期望的，如果指针的大小`4`在您的平台上，那么结果将是增量`20`而不是`5`.

增量运算符对指针没有任何作用，您只是在添加`1`它。

此外，你确定`*pointer++`真的如你所想吗？增量的优先级高于取消引用运算符。这两个语句具有相同的效果：

```
*pointer++;

pointer++; 
```

在这两个语句中，指针都是递增的，在第一个语句中，您还取消引用指针（旧值，因为增量是后缀）并获取它指向的内容，而不用做任何事情。

如果你在表达式中使用它们，它们会给你两个不同的东西：如果`pointer`有类型`char **`（假设它是一个字符串数组），`*pointer++`给你第一个字符串作为指向它的第一个字符的指针*，然后*递增`pointer`，而结果`pointer++`仍然是`char **`并简单地返回`pointer`自身*，然后*递增`pointer`. 请注意，在这两种情况下，您都会丢失第一个字符串。

我看到了`linux`标签：你不必考虑这里的平台，这是可移植的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:04:07.147

如果您有一个`pointer`类型的指针`TYPE*`并添加`N`，则该指针将前进一个`N * sizeof (*pointer)`或等效`N * sizeof(TYPE)`字节。由于您没有提到内存是否是动态分配的，因此在这些指针前进之后，当您尝试访问`free()`内存时会导致未定义的行为。这意味着它也是分配的字节数或当前地址指向。

# c++ - 那么为什么 i = ++i + 1 在 C++11 中定义良好？

> ID：14005508
> 
> 赞同：29
> 
> 时间：2012-12-22T18:42:54.097
> 
> 标签：c++, c++11, undefined-behavior, language-lawyer

我已经看过[其他](https://stackoverflow.com/q/1860461/150634)类似的[问题](https://stackoverflow.com/q/4336860/150634)并阅读了有关它的[缺陷。](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#637)但我还是不明白。为什么`i = ++i + 1`在 C++11 中定义明确，`i = i++ + 1`但不是？标准是如何明确定义的？

通过我的工作，我有以下*排序的前*图（其中箭头表示排序前的关系，除非另有说明，否则一切都是值计算）：

```
i = ++i + 1
     ^
     |
assignment (side effect on i)
 ^      ^
 |      |
☆i   ++i + 1
     ||    ^
    i+=1   |
     ^     1
     |
★assignment (side effect on i)
  ^      ^
  |      |
  i      1 
```

我`i`用黑星标记了副作用，用白星标记了值计算`i`。这些似乎彼此之间没有顺序（根据我的逻辑）。标准说：

> 如果标量对象的副作用相对于同一标量对象的另一个副作用或使用同一标量对象的值的值计算是未排序的，则行为未定义。

[缺陷报告](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#637)中的解释没有帮助我理解。左值到右值的转换与什么有什么关系？我做错了什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-22T18:49:33.567

> ...或***使用***相同标量对象的值进行值计算...

重要的部分在这里加粗。左侧不使用 的值`i`进行值计算。正在计算的是一个*glvalue*。只有在之后（sequenced after），对象的值才会被触摸和替换。

不幸的是，这是一个非常微妙的观点:)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-12-22T18:50:37.247

好吧，这里的关键时刻是 的结果`++i`是一个*lvalue*。为了参与二进制`+`，必须通过左值到右值的转换将左值转换为右值。左值到右值的转换基本上是`i`从内存中读取变量的行为。

这意味着`++i`应该*像*直接从 读取一样获得 的值`i`。这意味着从概念上讲，在二进制评估开始之前，新的（增加的）值`i`必须准备好（必须物理存储在 中） 。`i``+`

这种额外的顺序是无意中定义了这种情况下的行为的原因。

在 C++03 中，没有严格要求`++i`直接从`i`. 甚至在它被`i + 1`物理`+`存储在实际的`i`. 尽管可以合理地声称即使在 C++03 中也隐含了该要求（并且 C++03 不承认其存在的事实是 C++03 的缺陷）

* * *

在 的情况下`i++`，结果是一个*右值*。`i`由于它已经是一个右值，因此不涉及左值到右值的转换，并且在我们开始评估二进制文件之前绝对不需要存储它`+`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-01-27T14:39:12.673

自从提出这个问题以来，我已经写了一篇关于[使用图形可视化 C++ 评估序列](http://josephmansfield.uk/articles/c++-sequenced-before-graphs.html)的文章。这个问题与 的情况相同`i = ++i`，它具有以下先序图：

![i = ++i 的先序图](../Images/cb7dd4f6e4bcfaf683fc5e1cecb00489.png)

红色节点代表对 的副作用`i`。蓝色节点表示*使用 的值*的评估`i`。这个表达式定义明确的原因是因为这些节点中没有一个是彼此不排序的。赋值左边的使用`i`不*使用 的值*，`i`所以不是问题。

我缺少的主要部分是“使用价值”的含义。如果运算符期望该操作数的纯右值表达式，则使用其操作数的值。在给对象命名的时候，是一个左值，这个左值要经过左值到右值的转换，可以看成是“读取对象的值”。赋值只需要左操作数的左值，这意味着它不使用它的值。

# mysql - SQL 语句按问题排序

> ID：14005509
> 
> 赞同：0
> 
> 时间：2012-12-22T18:42:53.583
> 
> 标签：mysql, sql

我为一个表运行一个 select 语句。我在 DATE 类型的字段上执行 ORDER BY。该字段有 3 个可能的值：

1.  日期>=今天

2.  一个日期<今天

3.  空值

我希望它将 no2 视为 null，以便首先给我带来 no1 结果，然后是所有其他结果，无论它们的值如何，因为我接下来运行第二个 ORDER BY。我尝试了任何事情都没有成功，这似乎超出了我的知识范围。谢谢你读我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:45:50.210

对于 SQL Server：

```
order by 
case when mydate >= getdate() then mydate else null end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:13:17.037

您也可以在 mysql 中使用 CASE 语句编写 ORDER BY 语句，或者您也可以在 SELECT 子句中使用别名编写 CASE 语句并按顺序使用它。我无法理解您真正想要什么，如果您可以提供一些示例数据，那么我们可能会帮助您处理查询本身。

# java - 我已经安装了 lucene，但无法在课堂上导入它

> ID：14005510
> 
> 赞同：0
> 
> 时间：2012-12-22T18:42:55.480
> 
> 标签：java, eclipse, lucene

我已经安装了 lucene，它写在 BUILD.txt 中。建筑输出：

```
 Buildfile: /home/ali/Downloads/lucene-3.6.1/build.xml

check-lucene-core-uptodate:

compile-lucene-core:

jflex-uptodate-check:

jflex-notice:
     [echo] 
     [echo]       One or more of the JFlex .jflex files is newer than its corresponding
     [echo]       .java file.  Run the "jflex" target to regenerate the artifacts.
     [echo]     

javacc-uptodate-check:

javacc-notice:

ivy-availability-check:

ivy-fail:

resolve:
[ivy:retrieve] :: Ivy 2.2.0 - 20100923230623 :: http://ant.apache.org/ivy/ ::
[ivy:retrieve] :: loading settings :: url = jar:file:/home/ali/.ant/lib/ivy-2.2.0.jar!/org/apache/ivy/core/settings/ivysettings.xml

init:

clover.setup:

clover.info:
     [echo] 
     [echo]       Clover not found. Code coverage reports disabled.
     [echo]     

clover:

common.compile-core:
    [mkdir] Created dir: /home/ali/Downloads/lucene-3.6.1/build/core/classes/java
    [javac] Compiling 503 source files to /home/ali/Downloads/lucene-3.6.1/build/core/classes/java
    [javac] /home/ali/Downloads/lucene-3.6.1/core/src/java/org/apache/lucene/queryParser/CharStream.java:50: warning: [dep-ann] deprecated item is not annotated with @Deprecated
    [javac]   int getEndColumn();
    [javac]       ^
    [javac] /home/ali/Downloads/lucene-3.6.1/core/src/java/org/apache/lucene/queryParser/QueryParserTokenManager.java:441: warning: [cast] redundant cast to int
    [javac]          int hiByte = (int)(curChar >> 8);
    [javac]                       ^
    [javac] /home/ali/Downloads/lucene-3.6.1/core/src/java/org/apache/lucene/queryParser/QueryParserTokenManager.java:691: warning: [cast] redundant cast to int
    [javac]          int hiByte = (int)(curChar >> 8);
    [javac]                       ^
    [javac] /home/ali/Downloads/lucene-3.6.1/core/src/java/org/apache/lucene/queryParser/QueryParserTokenManager.java:798: warning: [cast] redundant cast to int
    [javac]          int hiByte = (int)(curChar >> 8);
    [javac]                       ^
    [javac] /home/ali/Downloads/lucene-3.6.1/core/src/java/org/apache/lucene/queryParser/QueryParserTokenManager.java:969: warning: [cast] redundant cast to int
    [javac]          int hiByte = (int)(curChar >> 8);
    [javac]                       ^
    [javac] Note: Some input files use or override a deprecated API.
    [javac] Note: Recompile with -Xlint:deprecation for details.
    [javac] 5 warnings

compile-core:

jar-core:

jflex-uptodate-check:

jflex-notice:
     [echo] 
     [echo]       One or more of the JFlex .jflex files is newer than its corresponding
     [echo]       .java file.  Run the "jflex" target to regenerate the artifacts.
     [echo]     

javacc-uptodate-check:

javacc-notice:

ivy-availability-check:

ivy-fail:

resolve:
[ivy:retrieve] :: loading settings :: url = jar:file:/home/ali/.ant/lib/ivy-2.2.0.jar!/org/apache/ivy/core/settings/ivysettings.xml

init:

clover.setup:

clover.info:
     [echo] 
     [echo]       Clover not found. Code coverage reports disabled.
     [echo]     

clover:

common.compile-core:

compile-core:

jar-core:
      [jar] Building jar: /home/ali/Downloads/lucene-3.6.1/build/core/lucene-core-3.6.1-SNAPSHOT.jar

default:

BUILD SUCCESSFUL
Total time: 10 seconds 
```

但是当我想将它导入到 Eclipse 中的类时，我看不到任何 lucene 选项。例如，我想导入

```
import org.apache.lucene.analysis.standard.StandardAnalyzer 
```

Eclipse 显示没有这样的库的错误。问题是什么？

# ruby-on-rails - 具有关系的单表继承？

> ID：14005518
> 
> 赞同：1
> 
> 时间：2012-12-22T18:43:49.783
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-activerecord

我找到了一些关于 STI 的好信息，但没有看到我想做的例子。这是我能想到的最好的例子。我希望能够跟踪两个实体，但它们不需要自己的表。我只需要区分类型（STI 可以做到这一点），但我还需要知道一个实体是否以及如何与另一个实体相关。我将以书籍为例。有些书只是书，但其他实体书是多本书的集合。

表：书籍

```
id | title | author_id | book_id
1, 'Fellowship of the Ring, 34, (NULL)      # is a physical book
2, 'The Two Towers', 34, (NULL)             # is a physical book
3, 'American Gods', 1, (NULL)               # is a physical book
4, 'Complete Lord Of the Rings', 34, (NULL)
5, 'Fellowship of the Ring', 34, 4          # is collected within book id 4
6, 'The Two Towers', 34, 4                  # is also collected within book id 4
etc. 
```

所以我希望能够查询所有书籍的书籍，并了解它们如何以及是否通过“book_id”相互关联

这在 Rails 中可行吗？如果是这样，如何最好地实施？我可以在书籍模型中说“has_many :books”吗？他们的问题或担忧等？

先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T18:54:58.760

像这样的东西可能适合你的情况？

```
class Book < ActiveRecord::Base
  # all attributes of a book
end

class SeriesBook < Book
  has_many :books, :class_name => "PhysicalBook", :foreign_key => "parent_id"
end

class PhysicalBook < Book
  belongs_to :series, :class_name => "SeriesBook", :foreign_key => "parent_id"
end 
```

那么查询的时候

```
# searches both Series and Physical
Book.where("title LIKE ?", "#{params[:title]}%") 
# searches only Series
SeriesBook.where("title LIKE ?", "#{params[:title]}%") 
```

您可能会发现您真的希望您的模型与众不同？系列和书籍而不使用 STI？它会使两者的查询更加复杂，但可能会使应用程序的其余部分更容易理解

更新：将belongs_to 添加到PhysicalBook，has_many 关联上的类名

```
# How would I query a specific collection to see which and how many books it has within it?
series = SeriesBook.find(0000)
series.books.length # => how many 
series.books.each do |book|
  puts book.title
end

# How would I look at a book and see if it was in a collection and, 
# if so, the specific ID of the specific collection to which it is associated
book = PhysicalBook.find(0000)
puts book.series.title
puts book.series.id 
```

图书数据库表最终看起来像

```
id # primary key
title
# other book columns ....
type # STI
parent_id # nullable, used by physical book when part of a series, points to books.id on the series book 
```

另外：阅读此内容-http: [//rhnh.net/2010/07/02/3-reasons-why-you-should-not-use-single-table-inheritance](http://rhnh.net/2010/07/02/3-reasons-why-you-should-not-use-single-table-inheritance)

你可能不想要性病？数据模型看起来与上面类似，但没有 STI，即系列/书籍

在 has_many 和 belongs_to 中使用 foreign_key 可能会令人困惑：在此处阅读 - [http://guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

# ruby - Ruby 托管 Sinatra + Apache Solr 多核 + SQL DB

> ID：14005519
> 
> 赞同：1
> 
> 时间：2012-12-22T18:43:50.807
> 
> 标签：ruby, solr, web-hosting

我对 Ruby 世界完全陌生，我想知道是否有托管公司可以运行由 Sinatra 提供支持的 Ruby 应用程序并运行 Tomcat 服务器，我可以在其中部署 Solr 实例。

我想我可能不得不寻找专用的服务器或住房解决方案。请注意，这不是为了生意，只是为了好玩——至少到目前为止；）

无论如何，是否可以使用可以支持 Solr 多核配置的 ruby​​（不是 Rails）插件？托管公司是否支持这些插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T17:56:27.440

对于托管，我想说什么都应该做。VPS或专用。我认为 Solr 有一个 Heroku 插件，但我不确定。

至于插件，[Sunspot](https://github.com/sunspot/sunspot)与 Sinatra 兼容。

# ruby - 在不转换为字符串的情况下，Fixnum 有多少位？

> ID：14005524
> 
> 赞同：9
> 
> 时间：2012-12-22T18:44:44.800
> 
> 标签：ruby, integer, ruby-1.9, fixnum

我想找到`length`a 的[`Fixnum`](https://ruby-doc.org/core-1.9.3/Fixnum.html),`num`而不将其转换为`String`.

换句话说，在`num`不调用该`.to_s()`方法的情况下有多少位数：

```
num.to_s.length 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-12-22T19:04:40.423

```
puts Math.log10(1234).to_i + 1 # => 4 
```

你可以像这样将它添加到 Fixnum 中：

```
class Fixnum
  def num_digits
    Math.log10(self).to_i + 1
  end
end

puts 1234.num_digits # => 4 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-12-26T17:22:11.723

Ruby 2.4 有一个[Integer#digits](https://ruby-doc.org/core-2.4.0/Integer.html#method-i-digits)方法，它返回一个包含数字的数组。

```
num = 123456
num.digits
# => [6, 5, 4, 3, 2, 1] 
num.digits.count
# => 6 
```

**编辑：**

要处理负数（感谢@MatzFan），请使用绝对值。[整数#abs](https://ruby-doc.org/core-2.4.0/Integer.html#method-i-abs)

```
-123456.abs.digits
# => [6, 5, 4, 3, 2, 1] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-02-19T13:04:17.137

**Ruby 2.4+**的旁注

 **我对不同的解决方案进行了一些基准测试，`Math.log10(x).to_i + 1`实际上*比*`x.to_s.length`. [@Wayne Conrad](https://stackoverflow.com/questions/14005524/how-do-i-determine-the-length-of-a-fixnum-in-ruby/14005668#comments-14005668)的评论已过时。新的[解决方案`digits.count`](https://stackoverflow.com/a/41334337/2235594)远远落后，尤其是在数量更大的情况下：

```
with_10_digits = 2_040_240_420

print Benchmark.measure { 1_000_000.times { Math.log10(with_10_digits).to_i + 1 } }
# => 0.100000   0.000000   0.100000 (  0.109846)
print Benchmark.measure { 1_000_000.times { with_10_digits.to_s.length } }
# => 0.360000   0.000000   0.360000 (  0.362604)
print Benchmark.measure { 1_000_000.times { with_10_digits.digits.count } }
# => 0.690000   0.020000   0.710000 (  0.717554)

with_42_digits = 750_325_442_042_020_572_057_420_745_037_450_237_570_322

print Benchmark.measure { 1_000_000.times { Math.log10(with_42_digits).to_i + 1 } }
# => 0.140000   0.000000   0.140000 (  0.142757)
print Benchmark.measure { 1_000_000.times { with_42_digits.to_s.length } }
# => 1.180000   0.000000   1.180000 (  1.186603)
print Benchmark.measure { 1_000_000.times { with_42_digits.digits.count } }
# => 8.480000   0.040000   8.520000 (  8.577174) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-03-23T22:03:18.153

尽管投票率最高的循环很好，但它不是非常 Ruby，并且对于大数字会很慢， .to_s 是一个内置函数，因此会快得多。几乎通用的内置函数将比构造的循环或迭代器快得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-08T04:01:06.140

其他方式：

```
def ndigits(n)
  n=n.abs
  (1..1.0/0).each { |i| return i if (n /= 10).zero? }
end

ndigits(1234) # => 4
ndigits(0)    # => 1
ndigits(-123) # => 3 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-05T15:26:12.793

如果你不想使用正则表达式，你可以使用这个方法：

```
def self.is_number(string_to_test)
is_number = false
# use to_f to handle float value and to_i for int
string_to_compare = string_to_test.to_i.to_s
string_to_compare_handle_end = string_to_test.to_i

# string has to be the same
if(string_to_compare == string_to_test)
  is_number = true
end
# length for fixnum in ruby
size = Math.log10(string_to_compare_handle_end).to_i + 1
# size has to be the same
if(size != string_to_test.length)
  is_number = false
end
is_number
end 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-06-28T17:32:31.140

你不必花哨，你可以做这么简单。

```
def l(input)
  output = 1
  while input - (10**output) > 0
    output += 1
  end
  return output
end
puts l(456) 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-11-25T12:22:20.543

它可以是找出固定数字的长度/计数/大小的解决方案。

```
irb(main):004:0> x = 2021
=> 2021
irb(main):005:0> puts x.to_s.length
4
=> nil
irb(main):006:0> 
```**

# macos - Emacs 启动警告

> ID：14005526
> 
> 赞同：14
> 
> 时间：2012-12-22T18:44:50.320
> 
> 标签：macos, emacs

我正在为 Mac OS X 24.2 使用 Emacs。一旦emacs卡住了，然后我就杀死了进程，但是当我重新打开它时，下面显示了一些警告：</p>

```
warning: desktop file appears to be in use by PID 200.
Using it may cause conflicts. Use it anyway? (y or n) 
```

从那以后每次打开 Emacs 时都会显示消息，那么我们应该如何解决呢？我真的很生气。顺便说一句，我的操作系统是 Mac OS X 10.7.5

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-23T03:40:51.663

当您的 emacs 上次意外退出时，通常会发生这种情况。你可以试试这个：

查找并删除此文件：`.emacs.desktop.lock`. （这是 的值，`desktop-base-lock-name`可以自定义。）它位于您的`user-emacs-directory`，通常`.emacs.d`在您的主目录中。

# c# - VS 2010 - 输出窗口 - 如何启用“在代码中查找消息”按钮？

> ID：14005529
> 
> 赞同：2
> 
> 时间：2012-12-22T18:45:08.453
> 
> 标签：c#, visual-studio-2010, visual-studio-debugging

当我在调试模式 (F5) 下构建`Windows Forms`项目时`VS2010`，会出现一个标题为输出窗口的窗口。输出窗口顶部有几个按钮：“ `Find Message in Code`”、“ `Next Message`”和“ `Previous Message`”。但是，它们始终显示为灰色（禁用）。这些是如何启用的？

我期待这些按钮的目的是帮助我找到导致消息出现在输出窗口中的代码行。例如，如果我`Trace.WriteLine("MyMessage");`在客户端代码中编写，执行时它将使 ' `MyMessage`' 出现在`Output Window`; 我认为通过在输出窗口中选择一条消息并单击“ `Find message in Code`”，它将导航到包含“ `MyMessage`”的客户端代码行。如果启用它并且我的假设是正确的，这将是一个巧妙的功能。不幸的是，我无法启用按钮。

要回答这个问题，请说明如何启用和使用这些按钮，以及是否应应用任何最佳做法（可选）。

这里有一些源代码可以作为参考。创建一个`Windows Forms`项目并进行您在下面看到的更改，您可以重现我正在尝试的内容。

```
// program.cs

using System;
using System.Diagnostics;
using System.Windows.Forms;

namespace MyNamespace
{
    internal static class Program
    {
        [STAThread]
        private static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            try
            {
                throw new ApplicationException("MyMessage"); 
                Application.Run(new FormMain());
            }
            catch (ApplicationException e)
            {
                Trace.WriteLine(e.ToString());
            }
        }
    }
} 
```

**JasonD 的推荐**

我换了

```
Trace.WriteLine(e.ToString()); 
```

和

```
Trace.WriteLine("Program.cs" + "(" + 23 + ")" + " Some info"); 
```

**结束 JasonD 解决方案 - 结果：启用按钮**

那解决了它。多么出乎意料的答案。在这个强类型化的时代，答案取决于使用魔法消息格式化字符串。我对此感到惊讶。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:59:03.620

您需要输出它可以解析的内容，它与您在编译时看到的错误/警告消息的格式基本相同，包括`"FILENAME(LINE) stuff"`.

在 C# 中，是这样的：

```
 string file_= new System.Diagnostics.StackTrace(true).GetFrame(0).GetFileName();
        int line_= new System.Diagnostics.StackTrace(true).GetFrame(0).GetFileLineNumber(); 
        System.Diagnostics.Trace.WriteLine(file_+ "(" + line_.ToString() + ") Some info"); 
```

（这有点乱，但是我发现没有好的 C/C++`__FILE__`和宏等价物）`__LINE__`

您可以稍微整理一下并将其包装在一个函数中，但是您需要获取调用者的文件/行，而不是实际的函数本身：

```
 static void traceFunc(string msg)
    {
        System.Diagnostics.StackTrace trace = new System.Diagnostics.StackTrace(true);
        string file = trace.GetFrame(1).GetFileName();
        int line = trace.GetFrame(1).GetFileLineNumber();
        System.Diagnostics.Trace.WriteLine(file + "(" + line.ToString() + ") " + msg);
    } 
```

# sql - SQL查询查找多个妻子

> ID：14005532
> 
> 赞同：1
> 
> 时间：2012-12-22T18:45:34.563
> 
> 标签：sql, sql-server-2012

我有一个数据库，其中包含一个名为“Couple”的表，它代表数据对。

该表包含以下字段：`CoupleId, WifeId, HusbandId, startDate, Enddate` 其中`startdate`表示婚姻开始`enddate`的日期，以及表示婚姻结束的日期。

`HusbandId`和`WifeId`是来自另一个表的外键，称为存储 `Person`每个人的附加信息的地方。

我需要一个查询来返回同时与两个或更多男人结婚的女人的信息（同步妻子）。

例如，#1 的女性与 #2 表格 1-1-2012 至 1-5-2012 (dd-mm-yyyy) 的男性结婚，而此女性（#1）与男性的 #3 从 1 结婚-3-2012 到 1-4-2012 ，这被称为女性#1的同步婚姻

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:59:03.033

与其使用自联接，不如使用相关子查询。它更易于阅读和理解，因为它使读者无需考虑自连接中的重复项。

```
SELECT COUNT(A.CoupleId) "no of conflicting relationships", A.WifeId
FROM
  COUPLE A
WHERE EXISTS ( 
    SELECT AA.WifeId
    FROM COUPLE AA
    WHERE 
    A.WifeId = AA.WifeId AND -- same wife, but ...
    A.CoupleId <> AA.CoupleId AND -- another couple (independent of husband)
    A.StartDate < AA.EndDate AND
    A.EndDate > AA.StartDate
)
Group By A.WifeId
Having COUNT(A.CoupleId) > 1 -- optional for the given scenario, as the result will only contain records > 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T19:03:08.997

这是一种方法：

```
SELECT
   DISTINCT A.WifeID
FROM
   dbo.Couple A
   INNER JOIN dbo.Couple B
      ON A.WifeID = B.WifeID
      AND A.HusbandID <> B.HusbandID -- or A.CoupleID > B.CoupleID
      AND A.StartDate < B.EndDate
      AND A.EndDate > B.StartDate; 
```

要实际计算每个人有多少并发关系，使用 FromDate 和 ToDate 范围，是一个更复杂的查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T19:47:42.903

在表上做一个自我加入：

```
SELECT DISTINCT c1.WifeID
FROM Couple c1
   INNER JOIN Couple c2 ON c1.WifeID = c2.WifeID
   AND c1.HusbandID <> c2.HusbandID
   AND c1.StartDate < c2.EndDate
   AND c2.StartDate < c1.EndDate; 
```

但是对于海量数据，执行时间会更长……

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-22T19:10:33.737

从 enddate > GETDATE() 或 enddate 为 null 的情侣中选择 count(wifeid),wifeid

# c# - 如何从 Listbox（在 C# 中）中获取所有元素/字段并将它们放入 DataTable 中？

> ID：14005534
> 
> 赞同：0
> 
> 时间：2012-12-22T18:45:46.820
> 
> 标签：c#, datatable, listbox

我有一个带有`ListBox`. 我想动态创建一个`DataTable`（直到现在我只声明了一些列 - 你可以在代码中看到 - 我以后想用来链接`DataTable`到现有的空`DataBase`）但不知道如何将它链接`Listbox`到从中“获取” 4 个元素：`event_time , event_filename , event_name , event_fullpath`. 请帮助，

到目前为止，我的部分代码是：

```
 private delegate void AppendListHandler(string event_filename, String event_name, String event_fullpath);

    private void AppendText(string event_filename, String event_name, String event_fullpath)
    {
        if (lstResultLog.InvokeRequired)
            lstResultLog.Invoke(new AppendListHandler(AppendText), new object[] { event_filename, event_name, event_fullpath });
        else
        {
            DateTime event_time = DateTime.Now;
            //String event_duration = event_time.ToString("HH:mm");
            lstResultLog.Items.Add(event_time + event_filename + event_name + event_fullpath);
        }

        DataTable table = new DataTable("tbl_Event");
        table.Columns.Add("event_duration");
        table.Columns.Add("event_name");
        table.Columns.Add("event_filename");
        table.Columns.Add("event_fullpath");
        table = (DataTable)lstResultLog.DataSource;
    } 
```

`lstResultLog`是 ListBox 的名称，ListBox 中的所有字段的名称都与声明的 DataTable 和 DataBase 中的名称完全相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:13:20.987

您可以在表单中包含一个类型的字段，该字段`DataTable`将保存您想要的数据。然后，每当您将项目添加到列表框时，请在数据表中添加具有相同数据的行：

```
public class YourForm
{
    private DataTable _table;
    public YourForm()
    {
        InitializeComponents();
        _table = BuildDataTable();
    }

    private DataTable BuildDataTable()
    {
        DataTable table = new DataTable("tbl_Event");
        table.Columns.Add("event_duration");
        table.Columns.Add("event_name");
        table.Columns.Add("event_filename");
        table.Columns.Add("event_fullpath");
        return table;
    }

    private void AppendText(string event_filename, String event_name, String event_fullpath)
    {
        if (lstResultLog.InvokeRequired)
            lstResultLog.Invoke(new AppendListHandler(AppendText), new object[] { event_filename, event_name, event_fullpath });
        else
        {
            DateTime event_time = DateTime.Now;
            lstResultLog.Items.Add(event_time + event_filename + event_name + event_fullpath);
            //Create new row
            var row = _table.NewRow();
            // Fill row values
            row["event_name"] = event_name;
            // Add row to table
            _table.Rows.Add(row);
        }
    }
} 
```

当您需要将数据发送到数据库时，只需将`_table`字段作为参数发送到保存数据的方法即可。

# arrays - AS3 对象数组 - 不是那么简单的查找/排序

> ID：14005541
> 
> 赞同：-1
> 
> 时间：2012-12-22T18:46:39.523
> 
> 标签：arrays, actionscript-3

想象一个简单的 AS3 对象数组，如下所示：

```
var arr:Array = new Array ();
arr.push ({xx:"50", yy:"200"});
arr.push ({xx:"75", yy:"50"});
arr.push ({xx:"25", yy:"100"});
arr.push ({xx:"75", yy:"75"}); 
```

我需要以这样的方式对数组进行“数学运算”，以便得到以下结果：

（逻辑应该首先是最小的 yy，然后是最小的 xx）

```
1\. xx:"75", yy:"50"
2\. xx:"75", yy:"75"
3\. xx:"25", yy:"100"
4\. xx:"50", yy:"200" 
```

任何提示，例如...意见，请帮助:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T19:36:00.677

您可以通过使用包含排序字段的数组来进行二次排序。另外，我假设你想做一个数字排序：

```
var array:Array = new Array;

array.push({xx:75, yy:75});
array.push({xx:75, yy:50});
array.push({xx:100, yy:25});
array.push({xx:200, yy:35});
array.push({xx:75, yy:550});

array.sortOn(["yy","xx"], Array.NUMERIC); 
```

如果您不将 NUMERIC 与您拥有的那些字符串一起使用，它将像它们是字符串一样对它们进行排序。例如 ：

```
1
10
100
2
20
3
300 
```

与

```
1
2
3
10
20
100
300 
```

# java - 如何修复调用 Thread.sleep() 时未处理异常的编译错误？

> ID：14005549
> 
> 赞同：23
> 
> 时间：2012-12-22T18:47:25.937
> 
> 标签：java, exception-handling, checked-exceptions

我是 Java 新手，也是编程新手（我知道直接进入 Java 可能不是最好的主意。）无论我如何尝试在我的程序中添加暂停，我都一直遇到错误。我正在做一个简单的计数程序，并想在每个数字之间添加一秒的延迟，这是我到目前为止的代码：

```
import java.lang.*;

public class Counter
{
    public static void main(String[]args)
    {
        int i;

        for (i = 0; i <= 10; i++)
        {
            Thread.sleep(1000);
            System.out.println(i);
        }
        System.out.println("You can count to ten.");
    }
} 
```

调用`Thread.sleep()`不会编译。编译器说，“未报告的`javac`异常 InterruptedException；必须被捕获或声明为抛出”，而 Eclipse 说，“未处理的异常类型 InterruptedException”

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-12-22T18:49:27.340

Thread.sleep 可以抛出一个已检查异常的 InterruptedException。所有检查的异常都必须被捕获和处理，否则您必须声明您的方法可以抛出它。无论是否实际抛出异常，您都需要执行此操作。未声明您的方法可以抛出的已检查异常是编译错误。

你要么需要抓住它：

```
try {
    Thread.sleep(1000);
} catch (InterruptedException e) {
    e.printStackTrace();
    // handle the exception...        
    // For example consider calling Thread.currentThread().interrupt(); here.
} 
```

或者声明你的方法可以抛出`InterruptedException`：

```
public static void main(String[]args) throws InterruptedException 
```

**有关的**

*   [课程 - 例外](http://docs.oracle.com/javase/tutorial/essential/exceptions/)
*   [Java的Thread.sleep什么时候抛出InterruptedException？](https://stackoverflow.com/questions/1087475/when-does-javas-thread-sleep-throw-interruptedexception)
*   [Java理论与实践：处理InterruptedException](http://www.ibm.com/developerworks/java/library/j-jtp05236/index.html)

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2016-01-23T06:24:35.670

你可以摆脱第一行。你不需要`import java.lang.*;`

只需将您的第 5 行更改为：

```
public static void main(String [] args) throws Exception 
```

# php - Yii 框架 - beginWidget 没有回声

> ID：14005550
> 
> 赞同：3
> 
> 时间：2012-12-22T18:47:28.327
> 
> 标签：php, forms, yii

我使用此代码来创建我的表单：

```
$form=$controller->beginWidget('CActiveForm', array(
            'id'=>'my-form',
            'enableAjaxValidation'=>false
    )); 
```

当我这样做时，它会打印表单。但我想把它放在一个变量中，因为整个表单在方法中作为字符串返回。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:10:32.677

以下内容获取输出缓冲区，将其存储到变量中，然后将其擦除。享受！！！

```
ob_start();

$form=$controller->beginWidget('CActiveForm', array(
        'id'=>'my-form',
        'enableAjaxValidation'=>false
    ));

$formToStore =  ob_get_clean(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T23:22:25.630

您可以使用控制器的 renderPartial 方法返回一个字符串。只需将整个表单单独放在一个文件中，我们称之为`_myForm.php`.

然后使用这一行将表单内容写入变量`$form`：

```
$form = $controller->renderPartial('//stuff/_myForm', $data, true); 
```

第三个参数设置为`true`将返回该 renderPartial 的内容，而不是回显。这包括“覆盖”小部件本身的回声。

该`$data`参数包括您需要传递给表单的任何变量。

文件本身需要在`protected/views/stuff/`文件夹中。`//`第一个参数的开头是文件夹的快捷方式`protected/views/`。

`'_myForm'`或者，如果该文件与调用 renderPartial 的位置相同，则仅用于第一个参数。

`ob_start`注意：这与使用and的选项在功能上并没有真正的不同`ob_get_clean`。这只是更多的 Yii 方式。根据您的具体情况，一个版本可能优于另一个版本。

# html - :hover with ">" 在 CSS

> ID：14005554
> 
> 赞同：1
> 
> 时间：2012-12-22T18:48:19.807
> 
> 标签：html, css

这是一个愚蠢的问题，但很好。CSS中的“>”是什么版本？我在谷歌上找不到它，因为我不知道它的名字。

例子。

CSS

```
.test {
    width:200px;
    height:200px;}

.test .color {
    width:50px;
    height:50px;
    float:left;
    background:red;}

.test:hover > .color {
    background:blue;} 
```

HTML

```
<div class="test">
    <div class="color"></div>
</div> 
```

它是什么版本的 CSS？2个还是3个？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:49:47.483

它标记节点的直接子节点。因此它的名字是“子选择器”。

因此，在您的情况下，`.test:hover > .color`选择具有类的任何节点，该类`color`是具有类的悬停节点的直接子节点`test`。

有关更多信息，请查看[相应的 MDN 页面](https://developer.mozilla.org/en-US/docs/CSS/Child_selectors)。

> > 组合符分隔两个选择器并仅匹配由第二个选择器匹配的那些元素，这些元素是由第一个选择器匹配的元素的直接子元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:50:24.263

这称为子选择器，它是 CSS2 的一部分。

[http://www.w3.org/TR/CSS2/selector.html#child-selectors](http://www.w3.org/TR/CSS2/selector.html#child-selectors)上的文档

> 当元素是某个元素的子元素时，*子选择器匹配。*子选择器由两个或多个以“>”分隔的选择器组成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T18:50:31.147

选择器用于直系后代。

因此`div > div`将选择所有`div`具有直接父元素的元素，该元素也是`div`.

它是 CSS 2。

它也被推荐用于 CSS 3 选择器。

参见[MDN](https://developer.mozilla.org/en-US/docs/CSS/Child_selectors)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T19:09:42.740

那将是一个 CSS 选择器，它位于另一个元素的正下方（在文档树中）。就像它的子元素一样。

这个 CSS3 备忘单非常有用：[CSS3 Cheat Sheet](http://media.smashingmagazine.com/wp-content/uploads/images/css3-cheat-sheet/css3-cheat-sheet.pdf)，不仅可以回答您的问题，还可以回答其他不常见的选择器类型。

您还可以通过以下方式找到哪些浏览器支持的内容：[我可以使用... HTML5、CSS3 的支持表...](http://caniuse.com/#compare=ie+7,ie+8,ie+9,ie+10,firefox+3.6,firefox+19,chrome+25)

# php - 如何使用 PHPUnit 测试依赖于特定 PHP 版本的语句？

> ID：14005555
> 
> 赞同：6
> 
> 时间：2012-12-22T18:48:27.743
> 
> 标签：php, phpunit, code-coverage

我有一个这样的构造：

```
class Foo
{
    public function doFoo($value = '')
    {
        if (function_exists('foo'))
        {
            return foo($value);
        }
        // if php version does not support foo()
        // ...
    }
} 
```

如果函数 foo 的存在取决于已安装的 PHP 版本，我如何使用 PHPUnit 测试此代码以实现 100% 的代码覆盖率（对于此示例，我假设该函数存在，否则 100% 的代码覆盖率是不可能的）。有没有办法在运行时禁用/启用 PHP 函数？

任何想法如何解决它？

**编辑：**

我找到了一个解决方案：高级 PHP 调试器/PECL 扩展为此目的提供了一个函数 *rename_function*。

> bool rename_function ( string $original_name , string $new_name )
> 
> > 将全局函数表中的 orig_name 重命名为 new_name。对于临时覆盖内置函数很有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:51:41.130

`foo()`您可以在测试方法中定义模拟。做这样的事情：

```
<?php
/**
 * Your test method
 */
public function testSomething () {

    // if the function not exists, create a simulation
    if(!function_exists('foo')) {
        function foo() {
            return $aValue;
        }
    }

    // your test code ...
} 
```

这是可行的，因为一个函数可以定义到另一个方法或函数中。尽管它们是在方法中定义的，但它们是全局可用的。

不需要使用 pecl 扩展。此外，它可能会*污染*测试执行环境，至少会增加不必要的需求。

此外**请注意**，PHPUnit 从 3.6 版开始支持注释`@codeCoverageIgnore`、`@codeCoverageIgnoreStart`、`@codeCoverageIgnoreEnd`to ，可用于从覆盖分析中排除类、方法或代码部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:22:50.660

那么，在 PHP 5.3 及更高版本中，您可以覆盖任何 PHP 函数的行为。

看这个

```
namespace Test
{
    function function_exists($function)
    {
        return false;
    }

    var_dump(function_exists('var_dump')); // bool(false)
} 
```

由于 PHP 的[回退机制](http://php.net/manual/en/language.namespaces.fallback.php)，这是可能的。简而言之，当它遇到一个函数时，它首先检查该函数是否存在于当前命名空间中。如果不是，它会回退到全局命名空间。

# ios - 将“标签”粘贴到 UITextView

> ID：14005559
> 
> 赞同：1
> 
> 时间：2012-12-22T18:49:18.513
> 
> 标签：ios, cocoa-touch, uiview, uitextfield, uitextview

在模拟器中，我粘贴到`UITextView`. 我不知道我的粘贴板上还有一些 Objective-c 代码，所以粘贴的文本包括多行和一些选项卡。

我很惊讶地看到文本字段突然变成了多行（显然看起来很糟糕，因为视图足够高，只能容纳 1-2 行）。

我在 s 中也经历过`UITextField`粘贴相同格式的文本与我`sizeWithFont:constrainedToSize:`用来正确调整某些视图大小的实现相混淆。

任何人都可以阐明正在发生的事情，以及我是否需要围绕这种可能性进行编码？在设备本身上，操作系统是否以某种方式处理了这个问题？我还将尝试在网站上托管相同的文本，以查看从设备内复制和粘贴是否表现出相同的行为。

我真的希望这只是模拟器的限制和从外部环境复制。

# opengl-es - OpenGL 未定义 cocos2d

> ID：14005560
> 
> 赞同：1
> 
> 时间：2012-12-22T18:49:24.520
> 
> 标签：opengl-es, cocos2d-iphone

功能如

```
glDisableClientState(GL_TEXTURE_COORD_ARRAY);
glDisableClientState(GL_COLOR_ARRAY);
glColor4f(c2.r, c2.g, c2.b, c2.a);
glVertexPointer(2, GL_FLOAT, 0, vertices); 
```

给我一个未定义的错误（使用未声明的标识符..）

这是在 Cocos2d 2.0 中，它应该有 OpenGL es 库链接到它。我从这里得到了代码-> [http://www.raywenderlich.com/3857/how-to-create-dynamic-textures-with-ccrendertexture](http://www.raywenderlich.com/3857/how-to-create-dynamic-textures-with-ccrendertexture) 他们的示例代码看起来不错，我不确定有什么不同，我在我的声明中没有看到他们应该拥有的任何库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:59:28.497

Cocos2D 2.0 和 Cocos2D 1.0 的区别在于 OpenGLES 版本。Cocos2D 2.0 使用 OpenGLES 2.0，而 Cocos2D 1.0 使用 OpenGLES 1.0。

只需避免所有立即模式 API。这是一篇类似的帖子：[Cocos2d 2.0 -OpenGL-Errors！](https://stackoverflow.com/questions/11662770/cocos2d-2-0-zillions-of-opengl-errors/11663486#11663486)

# java - Java 按行拆分文本（其他解决方案不起作用）

> ID：14005561
> 
> 赞同：2
> 
> 时间：2012-12-22T18:49:26.390
> 
> 标签：java

我正在编写代码以在 java 中拆分行，但它无法正常工作。

```
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.ArrayList;
import java.lang.*;

public class mainprogram {
    public static void main(String [] args ) throws FileNotFoundException, IOException
    {
    //creating object for purpose of writing into file
    writFile ObjectwritFile = new writFile();

    //creating object for purpose of reading from file
    loadFile ObjectloadFile = new loadFile();

    //this will be used for storing text into from file
    String text="";

    //text = ObjectloadFile.loadFile("C://names.txt");

    System.out.println(text);

    ObjectwritFile.writeFile("C://testfile.txt",text);

   //these regexp didn't work
    //String regexp = "[\\r\\n]+"; 
   //String regexp = "[\\s,;\\n\\t]+";  

  String regexp = "[\\n]+";

   //this one didn't work  
   //String[] lines = text.split(regexp);

    String[] lines = text.split(System.getProperty("line.separator"));

    for(int i=0; i<lines.length; i++){

    System.out.println("Line "+i+": "+lines[i]);
    ObjectwritFile.writeFile("C://testfilelines.txt","Line "+i+": "+lines[i]);

    }         
          }

    } 
```

文本采用这种格式。

```
John, Smith, 4 ,5 ,6
Adams, Olsen, 7,8, 3
Steve, Tomphson , 4,5 9
Jake, Oliver, 9,8,9 
```

一旦我按行分隔文本，我必须按字母和数字将其排序到具有相同文本格式的文件中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T18:55:16.500

您可以使用扫描[仪](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)`\n`作为分隔符，逐行读取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T19:05:38.740

尝试这个：

```
String[] lines = text.split("\n+"); 
```

请注意，这`"\n"`不是特殊的正则表达式字符，因此不需要转义。正则表达式`"\\n"`（在java中）是文字`"n"`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T18:55:08.637

为什么要手动做所有事情？只需使用可用的 CSV 库之一，例如[Super CSV](http://supercsv.sourceforge.net/examples_reading.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T19:06:30.410

我不完全理解您要做什么，但是如果您的输入文本始终采用以下格式：`String,String,int,int,int`，那么这个 groovy 代码将读取这些行，按最后三个数字升序对它们进行排序，然后将它们打印出来：

```
def lines = new File('textSort.txt').readLines()
lines.sort{ it.split(',')[4].trim() }
lines.sort{ it.split(',')[3].trim() }
lines.sort{ it.split(',')[2].trim() }
println lines.join('\n') 
```

排序 3 次有点 hacky，但它可以完成工作并且可以正常工作，除非你有一个大的数据集。它的 Java 代码会相应地大得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T18:52:23.360

```
String regexp = "[\\n]+";

   //this one didn't work  
   //String[] lines = text.split(regexp); 
```

您不需要像有效的转义序列一样`\n`使用额外的反斜杠进行转义。`\\n``\n`

```
String regexp ="[\n]+"; //will work fine 
```

# multithreading - 如何使用 posix 信号量实现屏障？

> ID：14005565
> 
> 赞同：3
> 
> 时间：2012-12-22T18:49:39.900
> 
> 标签：multithreading, posix, semaphore, barrier

如何使用 posix 信号量实现屏障？

```
void my_barrier_init(int a){

    int i;  
    bar.number = a;
    bar.counter = 0;

    bar.arr = (sem_t*) malloc(sizeof(sem_t)*bar.number);
    bar.cont = (sem_t*) malloc(sizeof(sem_t)*bar.number);
    for(i = 0; i < bar.number; i++){    
    sem_init(&bar.arr[i], 0, 0);
    sem_init(&bar.cont[i], 0, 0);   }
}

void my_barrier_wait(){
    int i;    
    bar.counter++;

    if(bar.number == bar.counter){      
    for(i = 0; i < bar.number-1; i++){  sem_wait(&bar.arr[i]);    }
    for(i = 0; i < bar.number-1; i++){   sem_post(&bar.cont[i]);     }
    bar.counter = 0;
    }else{
        sem_post(&bar.arr[pthread_self()-2]);
        sem_wait(&bar.cont[pthread_self()-2]);
  }
} 
```

当调用函数 my_barrier_wait 时，首先 (N-1) 次它将为数组“arr”中的信号量设置(+1) 并进入睡眠状态（调用 sem_wait）。第 N 次它减少 'arr' 中的信号量并且应该（如我所料）唤醒 [0..bar.number-1] 线程为 'cont' 数组中的信号量发布 +1。它不像屏障那样起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T09:53:17.743

你需要看看[这个](http://greenteapress.com/semaphores/downey05semaphores.pdf)(PDF)，Allen Downey 的 The Little Book of Semaphores。特别是第 3.6.7 节。它在 Python 中，但它的要点应该足够清楚。

# ruby-on-rails - 从“外键”ObjectId 中有效查询用户名

> ID：14005568
> 
> 赞同：0
> 
> 时间：2012-12-22T18:49:56.133
> 
> 标签：ruby-on-rails, mongodb, mongoid, query-optimization, relationship

例如我有模型`User`和`Post`

**用户**

```
{
    "_id": ObjectId("pretendThisIsAUserObjectId"),
    "name": "someUser"
} 
```

**邮政**

```
{
    "_id": ObjectId("pretendThisIsAUserObjectId"),
    "title": "blah blah",
    "user_id": ObjectId("pretendThisIsAUserObjectId"),
    "content": "more blah"
} 
```

用户有很多帖子。所以我们已经`user_id`存储在`Post`.

因此，当我们为每个用户列出帖子时，我们将有 N+1 个查询（N 个帖子加上 1 个用户名查询），因为我们在 MongoDB 中没有加入。

我们也可以将用户名存储在`Post`, 以进行优化吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:05:35.417

简短的回答是**肯定**的。您可以将数据非规范化到您认为适合您的特定需求的任何程度。您甚至可以将整个`User`文档存储在 each 中`Post`，但这将是一种*愚蠢*的重复。

然而，我的第一个倾向是考虑在应用程序端缓存与每个用户 ID 关联的用户名，而不是尝试在`Post`文档中包含名称或每次需要时都查询它。

如果您的用户名是唯一的，您可以考虑将用户名设置`_id`为`User`文档的，而不是标准的`ObjectId`. 这使您的用户 ID 更加有用，因为您不再需要执行额外的查询来查找每个用户的姓名，因为他们的姓名就是他们的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T18:54:38.640

如果您启用了[身份映射](http://mongoid.org/en/mongoid/docs/identity_map.html)`includes`，则可以照常使用。

```
Post.includes(:user)... 
```

请参阅[急切加载](http://mongoid.org/en/mongoid/docs/querying.html)。

# javascript - 用javascript改变不透明度？

> ID：14005576
> 
> 赞同：4
> 
> 时间：2012-12-22T18:50:43.767
> 
> 标签：javascript, jquery

我需要一些帮助来解决这个问题！我正在尝试更改位于我网站底部的工具栏（类）的不透明度。以下代码适用于 Chrome 和 Firefox，但在 IE8 上...不行。我已经尝试了各种各样的东西来让它工作，但为了保持这篇文章的干净，我不会全部列出来。

```
<script>
        function hide() {
             $(".grid_10.bottombar").animate( { opacity: 0, left: 0 }, 1000 );
             $( ".ArrowBottom.float-right" ).show();
        }
  </script>

  <p>
        <img onclick="hide()" src="/images/BlueArrowSmall.png" />
  </p> 
```

任何帮助将不胜感激！提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:12:03.400

我将采用这种方式。仅使用 jQuery 并将该 evenListener 附加到该类。

```
$(function(){
   $('.bottombar').on('click', function(){
      $(this).animate( { opacity: 0, left: 0 }, 1000, function(){

        $('.ArrowBottom').find('.float-right').show();

      });
   });

}); 
```

# haskell - 为什么 cabal 黑线鳕找不到镜头？

> ID：14005577
> 
> 赞同：1
> 
> 时间：2012-12-22T18:50:44.987
> 
> 标签：haskell, cabal, haddock

我有一个项目，我正在尝试[镜头](http://lens.github.com/)库。我正在尝试生成黑线鳕文档，以便我可以看到该函数生成的`makeClassy` `TemplateHaskell`函数。`cabal build`工作正常，但`cabal haddock`失败

```
$ cabal haddock
Running Haddock for myproject-0.0.1...
Warning: The documentation for the following packages are not installed. No
links will be generated to these packages: rts-1.0
Preprocessing library myproject-0.0.1...
<command line>: cannot satisfy -package-id lens-3.7.1-a40583cdc124338f52ab40ebbf747e8f
    (use -v for more information) 
```

我错过了什么？

# javascript - 任何人都可以建议导致图形“摆动”到位的效果的起点 onload

> ID：14005582
> 
> 赞同：0
> 
> 时间：2012-12-22T18:51:21.380
> 
> 标签：javascript, html, css

...例如用于[http://vasonanetworks.com](http://vasonanetworks.com)的那个？

不仅当您进入该站点时，而且当您滚动时，图形都会出现缓慢的性质，我想知道是否有人对这是如何完成的有任何见解。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T18:55:29.360

当然，请查看 jQuery 和动画功能。

[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

专门用于处理滚动事件：[http ://api.jquery.com/scroll/](http://api.jquery.com/scroll/)

# python - 如何在 html 中显示 python 应用程序？

> ID：14005584
> 
> 赞同：2
> 
> 时间：2012-12-22T18:51:41.363
> 
> 标签：python, html, matplotlib, tkinter

我用 Python 编写了一个程序，它使用`matplotlib`和绘制一些图形`tkinter`。
我想在我的网页上显示该程序以供免费使用。
如何让这个 Python 程序在网页上运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:53:19.443

如果您对使用 web 框架烧瓶感兴趣，请查看[这个](https://gist.github.com/862153)，从关于如何[在烧瓶中使用 matplotlib 即时创建图形的讨论中。](http://flask.pocoo.org/mailinglist/archive/2011/3/9/matplotlib/#7c207bd9d1524ef27dbe4986f09c1bf2)

我建议将图像存储在 amazons s3 服务之类的地方。这样，图像将很容易在会话之间进行访问。所以从上面的线程链接修改代码......

将对象返回为 png：

```
from matplotlib.pyplot import figure
from matplotlib.backends.backend_agg import FigureCanvasAgg as FigureCanvas
import StringIO

def create_a_graph()
    fig = figure(figsize=a_size_integer,a_size_integer))
    canvas = FigureCanvas(fig)
    canvas.print_png(png_output)

    return png_output 
```

[然后使用boto](https://github.com/boto/boto)将它们上传到亚马逊 s3 站点，并将它们显示在您选择的任何框架上。

我正在做的一个[当前项目就是这样做的。](https://github.com/Midnightcoffee/petal)查看文件：graph.py、tools.py、views.py 和 base.html。当然，这需要了解 boto、flask 和 matplotlib，但至少它为您提供了一个起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T18:57:12.893

您应该查看[mod_wsgi](http://code.google.com/p/modwsgi/)和 python 社区中存在的许多 web 包之一，或者构建您自己的。

但是您还需要了解 tkinter 是一个 gui 库，它不会从网络上运行，这听起来像是您想要的。但相反，您可以为您的代码构建一个 Web 界面，如果表示逻辑与应用程序逻辑很好地分离，这应该不难。话虽如此，如果您不熟悉一般编程或特别是 Web 编程，这绝对不是一件容易的事。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-22T19:31:44.810

看看[Flask](http://flask.pocoo.org/)作为一个轻量级框架，用于制作 Web 应用程序，然后有一个类似于以下的路由：

```
@app.route("/graph/<input>")
def drawGraph(input):
    # Graph drawing code goes here.
    image = # The image file as a string, as if you'd read it in from a file
            # object

    return Request(image, mimetype="image/png") 
```

然后在模板中，您可以使用`/graph/`url 为适当的输入获取图形并在`<img>`标签中呈现它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T19:30:43.440

解决此类问题的常用方法是将程序的核心与界面分开。

一种方法是将程序变成一个模块，然后从 GUI 和 Web 框架中导入该模块。

另一种方法是将程序变成一个[守护进程](http://en.wikipedia.org/wiki/Daemon_%28computing%29)。然后，GUI 和 Web 界面都使用某种消息传递协议与之对话。例如[ipython](http://ipython.org/)就是一个例子。

# php - 发布后的 Facebook redirect_uri

> ID：14005587
> 
> 赞同：1
> 
> 时间：2012-12-22T18:52:18.790
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk

我了解如何在通过 facebook api 登录后重定向用户，但是如何在成功发布后设置重定向目标。这就是我同时发布到 facebook 和我的博客的方式。

```
$post_url = '/'.$userPageId.'/links';

$msg_body = array(
  'message' => 'Hello World',
  'link' => 'http://localhost:8888/path/to/my/blog?blog='.$this->id,
);

$postResult = $facebook->api($post_url, 'post', $msg_body ); 
```

目前，用户将使用所需的博客字段填写网络表单 (new_blog.php)，点击提交，博客将发布到我的网站数据库和 facebook，然后重定向回 new_blog.php。成功发布后，我需要重定向到不同的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:51:55.823

通过 PHP SDK 对 Facebook Graph API 的所有调用都是**同步**的。因此，您可以在调用 API 后直接调用任何函数，例如：

```
<?php
try 
{
    $result = $facebook->api($post_url, 'post', $msg_body);
    do_something($result);
} 
catch (Exception $e) 
{
  // Error
}
?> 
```

# android - 为什么 Eclipse 不再“正确”显示项目？

> ID：14005588
> 
> 赞同：3
> 
> 时间：2012-12-22T17:20:43.997
> 
> 标签：android, eclipse

我只有一个项目，在其中，项目的布局变得“一团糟”。看这里：

![在此处输入图像描述](../Images/bc7fd2e7edb6d25e941abb28dafac00e.png)

点文件现在可见。src 文件夹不再折叠...也就是说，空文件夹现在不再显示为一个文件夹。

我到底在这里做了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T17:58:27.527

我认为您已经从 Java 视角转变为 Java EE 视角或*棘轮怪胎*所说的 :)。

# haskell - 使用 Haskell 播放 wav 文件

> ID：14005592
> 
> 赞同：25
> 
> 时间：2012-12-22T18:52:43.733
> 
> 标签：haskell, audio, wav

是否有一种简单直接的方法可以使用某个库从 Haskell 播放 WAV 文件，并且可能让我一次播放许多声音？

我知道 OpenAL，但我不是在编写一些高级音频合成程序，我只是想为一些小玩意儿播放一些声音。理想情况下，API 可能类似于：

```
readWavFile :: FilePath -> IO Wave
playWave :: Wave -> IO ()
playWaveNonBlocking :: Wave -> IO () 
```

我很*接近*仅仅启动 mplayer 或其他东西。或者尝试将 wav 直接发送到 /dev/snd/ 或类似的东西。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-23T12:47:20.953

这是使用 SDL 一次在多个通道上播放多个声音的方法。我认为这回答了问题标准。WAV 文件，简单，Haskell，多通道。

```
import Control.Monad
import Control.Monad.Fix
import Graphics.UI.SDL as SDL
import Graphics.UI.SDL.Mixer as Mix

main = do
  SDL.init [SDL.InitAudio]
  result <- openAudio audioRate audioFormat audioChannels audioBuffers
  classicJungle <- Mix.loadWAV "/home/chris/Samples/ClassicJungle/A4.wav"
  realTech      <- Mix.loadWAV "/home/chris/Samples/RealTech/A4.wav"
  ch1 <- Mix.playChannel anyChannel classicJungle 0
  SDL.delay 1000
  ch2 <- Mix.playChannel anyChannel realTech 0
  fix $ \loop -> do
    SDL.delay 50
    stillPlaying <- numChannelsPlaying
    when (stillPlaying /= 0) loop
  Mix.closeAudio
  SDL.quit

  where audioRate     = 22050
        audioFormat   = Mix.AudioS16LSB
        audioChannels = 2
        audioBuffers  = 4096
        anyChannel    = (-1) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-22T19:22:28.770

我意识到这实际上不是一种方便的方法，但我有测试代码，所以......

```
{-# LANGUAGE NoImplicitPrelude #-}
module Wav (main) where

import Fay.W3C.Events
import Fay.W3C.Html5

import Language.Fay.FFI
import Language.Fay.Prelude

main :: Fay ()
main = addWindowEventListener "load" run

run :: Event -> Fay Bool
run _ = do
    aud <- mkAudio
    setSrc aud "test.wav"
    play aud
    return False

mkAudio :: Fay HTMLAudioElement
mkAudio = ffi "new Audio()"

addWindowEventListener :: String -> (Event -> Fay Bool) -> Fay ()
addWindowEventListener = ffi "window['addEventListener'](%1,%2,false)" 
```

好了——借助 HTML5 的强大功能，在 Haskell 中播放 WAV 文件！您所要做的就是启动一个网络浏览器而不是 mplayer。:D

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-11-15T07:52:16.573

通过 ALUT 使用 OpenAL：

```
import Control.Monad
import Sound.ALUT

playSound :: IO ()
playSound =
  withProgNameAndArgs runALUTUsingCurrentContext $ \_ _ ->
  do
    (Just device) <- openDevice Nothing
    (Just context) <- createContext device []
    currentContext $= Just context
    buffer1 <- createBuffer $ Sine 440 0 1
    buffer2 <- createBuffer HelloWorld
    [source] <- genObjectNames 1
    queueBuffers source [buffer1,buffer2]
    play [source]
    sleep 4
    closeDevice device
    return ()

main = playSound 
```

加载 wav 文件：

```
buffer3 <- createBuffer $ File "/path/to/file.wav" 
```

归功于 Chris Double：[http ://bluishcoder.co.nz/articles/haskell/openal.html](http://bluishcoder.co.nz/articles/haskell/openal.html)

# python - PIP 安装失败

> ID：14005593
> 
> 赞同：3
> 
> 时间：2012-12-22T18:52:48.463
> 
> 标签：python, django, firebird, pip

我正在学习 Python，我遵循的文档建议安装 Firebird。我跑了`sudo pip install fdb`。

我看到了一个构建目录，我理解它只包含源代码而不是二进制文件，所以我删除了它。当我这样做时`pip freeze | grep fdb`，我找不到火鸟。

我尝试`sudo pip install fdb`再次运行，现在出现此错误（并且构建目录正在返回）：

```
Downloading/unpacking fdb
  Downloading fdb-0.9.9.tar.gz (481Kb): 481Kb downloaded
  Running setup.py egg_info for package fdb
    Traceback (most recent call last):
      File "<string>", line 14, in <module>
      File "/Users/nayef/Documents/Django/build/fdb/setup.py", line 7, in <module>
        from fdb import __version__
      File "fdb/__init__.py", line 23, in <module>
        from fdb.fbcore import *
      File "fdb/fbcore.py", line 26, in <module>
        from . import ibase
      File "fdb/ibase.py", line 1164, in <module>
        isc_attach_database = fb_library.isc_attach_database
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/ctypes/__init__.py", line 366, in __getattr__
        func = self.__getitem__(name)
      File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/ctypes/__init__.py", line 371, in __getitem__
        func = self._FuncPtr((name_or_ordinal, self))
    AttributeError: dlsym(RTLD_DEFAULT, isc_attach_database): symbol not found
    Complete output from command python setup.py egg_info:
    Traceback (most recent call last):

  File "<string>", line 14, in <module>

  File "/Users/nayef/Documents/Django/build/fdb/setup.py", line 7, in <module>

    from fdb import __version__

  File "fdb/__init__.py", line 23, in <module>

    from fdb.fbcore import *

  File "fdb/fbcore.py", line 26, in <module>

    from . import ibase

  File "fdb/ibase.py", line 1164, in <module>

    isc_attach_database = fb_library.isc_attach_database

  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/ctypes/__init__.py", line 366, in __getattr__

    func = self.__getitem__(name)

  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/ctypes/__init__.py", line 371, in __getitem__

    func = self._FuncPtr((name_or_ordinal, self))

AttributeError: dlsym(RTLD_DEFAULT, isc_attach_database): symbol not found

----------------------------------------
Command python setup.py egg_info failed with error code 1 in /Users/nayef/Documents/Django/build/fdb
Storing complete log in /Users/nayef/Library/Logs/pip.log 
```

我在这里做错了什么？我不确定 pip 有什么问题。我从来没有遇到过任何问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T19:03:56.070

这不是*pip*失败，这是*fdb*包安装失败。

似乎您缺少一些驱动程序，特别是 firebird 头文件。

你有[安装firebird](http://www.firebirdsql.org/file/documentation/papers_presentations/html/paper-fb-macosx-install.html)吗？确保仅在安装驱动程序后安装 Python 绑定。

# magento - 所有 Magento 扩展都必须使用辅助类吗？

> ID：14005596
> 
> 赞同：7
> 
> 时间：2012-12-22T18:53:27.513
> 
> 标签：magento, magento-1.7

许多扩展（包括我编写的扩展）包括一个帮助类，它只是扩展抽象基类而不添加任何功能。助手通常如下所示：

```
class MyCompany_MyModule_Helper_Data extends Mage_Core_Helper_Abstract {
} 
```

因此，扩展类仅用于抽象类提供的东西，尤其是用于翻译。另一方面，Magento 中的所有 Block 和 Controller 类都继承了`__()`翻译方法 - 在我目前正在开发的扩展中，我甚至不需要调用帮助程序类一次。

我可以删除助手类并将其从中删除`config.xml`吗？我已经尝试过了，扩展似乎可以正常工作，但由于 Magento 的复杂性，我总是有点担心会有我不知道的影响。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-22T20:19:31.467

如果你从头开始创建一个模块，辅助类并不是绝对必要的。我通常会跳过创建一个，直到需要它。

**但是**，如果任何 XML 文件使用该`module`属性来指定翻译模块，则该属性需要解析为有效的帮助程序。例如，在这个核心文件中

```
<!-- File: app/code/core/Mage/Catalog/etc/system.xml -->
<tabs>
    <catalog translate="label" module="catalog">
        <label>Catalog</label>
        <sort_order>200</sort_order>
    </catalog>
</tabs> 
```

有`module="catalog"`。通过指定此属性，翻译标签的 Magento 系统代码将如下所示

```
Mage::helper('catalog')->__('Label'); 
```

因此，从目录模块中删除帮助程序会破坏 Magento 的某些部分。

（单部分类别名由Magento系统代码`catalog`自动转换为）`Mage::helper('catalog/data')`

**Magento 的许多**XML 文件中都使用了这种“分组翻译助手”功能，而不仅仅是`system.xml`（布局、小部件等）。此外，Magento 中的某些系统会推断和/或要求存在用于翻译的辅助模块（访问控制、外部 API 系统等）。

长话短说：如果您从头开始创建模块，请随时将帮助程序排除在外，直到您开始遇到 Magento 无法实例化帮助程序的错误。永远不要从模块中删除现有的帮助器，如果你想确保你与其他人可能做出的假设 100% 兼容，请始终包含一个`Data.php`帮助器类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T19:50:46.873

Magento 的 Helper 类包含实用方法，允许您对对象和变量执行常见任务。[http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-1-introduction-to-magento#6](http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-1-introduction-to-magento#6)

假设 Helper 文件为空且没有自定义方法，例如。

```
<?php 
class MagePal_SomeModule_Helper_Data extends Mage_Core_Helper_Abstract
{
} 
```

那么一些可能仍然受到影响的事情是：

*   system.xml - admin -> system -> config 中模块的空白屏幕
*   $this->__('') - .phtml 模板中的错误（用于国际化/翻译）

因此，如果您的助手是空的，没有系统配置部分且没有翻译，那么“也许”可以删除。

# php - 通过 App 将图片（带标题）上传到 Facebook 页面

> ID：14005598
> 
> 赞同：0
> 
> 时间：2012-12-22T18:53:40.147
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk, facebook-access-token

所以我想做以下事情：一个 php 脚本应该将带有标题的图片上传到 facebook 页面。

然后我用谷歌搜索了一下，发现了这个：[Simple example to post to a Facebook fan page via PHP?](https://stackoverflow.com/questions/7818667/simple-example-to-post-to-a-facebook-fan-page-via-php)

一切正常，但遗憾的是结果不是我想要的。而不是“完整”的形象，我只得到一个跛子：http: [//i.imgur.com/2qINX.jpg](https://i.imgur.com/2qINX.jpg)

你能帮我吗？该脚本需要离线访问，我已经有一个应用程序。我只需要它来上传图片和标题，仅此而已。在此之前，我是通过 Facebook 为移动用户提供的电子邮件上传图片，但这已经不再令人满意了。我的意思是，这不可能那么难。但如果我不明白这一点，我将租用一个虚拟 Windows 服务器并运行一个脚本来登录 Facebook 并发布图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:00:51.907

您可以使用以下方式将图片上传到您的页面 -

```
$image['file'] = PATH_TO_PICTURE;
$args = array( 'access_token' => PAGE_ACCESS_TOKEN, 'message' => '','no_story' => 0);
$args['image'] = '@' . $image['file'];
$target_url = "https://graph.facebook.com/ALBUM_ID/photos";

$ch = curl_init(); 
curl_setopt ($ch,CURLOPT_URL,$target_url); 
curl_setopt ($ch, CURLOPT_POST, 1); 
curl_setopt ($ch, CURLOPT_RETURNTRANSFER,1); 
curl_setopt($ch, CURLOPT_POSTFIELDS, $args);
curl_exec($ch);
curl_close ($ch); 
```

**PAGE_ACCESS_TOKEN**

1.  获取页面/应用程序列表-

    ```
    $facebook->api("/USER_ID/accounts"); 
    ```

2.  获取页面的访问令牌-

    ```
    $facebook->api("/PAGE_ID?fields=access_token"); 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:02:26.150

这会将图片加载到特定的画廊：

```
$newphotodata = array(
'access_token' => $fanPageAccessToken,
'message' => $message,
'no_story' => 1,
'aid' => $albumId,
'image' => '@' . $picturePath);
$uploadedphoto = $facebook->api('/' . $albumId . '/photos/', 'post', $newphotodata); 
```

不过，您也需要以下权限：

```
read_stream, manage_pages, publish_stream, photo_upload, user_photos, user_photo_video_tags 
```

我不确定 user_photos 和 user_photo_video_tags 是否真的需要，所以如果你可以使用它，请尝试不使用。

此外，在拨打电话之前，您需要以下行：

```
$facebook->setFileUploadSupport(true); 
```

不过，您基本上需要先做两件事。

首先，您需要查询 API 以获取要发布到的任何页面的访问令牌。

您可以通过以下 api 调用执行此操作：

```
$fanpages = $facebook->api('me/accounts?access_token='.$accessToken); 
```

然后你遍历 $fanpages['data']，找到你想要的页面：

```
$fanPageAccessToken = $fanPage['access_token'] 
```

然后，您使用适当的专辑 ID 拨打上面给出的电话。

现在，如果您不知道需要什么专辑 ID，请查看以下内容：

```
$fan_albums = $facebook->api($fanPageId.'/albums/'); 
```

这将显示所有专辑。目前的关键字段将是 ['id'] 和 ['name']。

一旦你发了帖子，就没有证据了。因此，您应该做的是在链接提要上发布指向照片的链接。如果您需要帮助，请询问，我会提供信息。

或者，查看我不久前写的这两篇文章，它们涵盖了相同的内容。

[http://facebookanswers.co.uk/?p=262](http://facebookanswers.co.uk/?p=262)

[http://facebookanswers.co.uk/?p=322](http://facebookanswers.co.uk/?p=322)

# c - for_each_process - 它是否也迭代线程和进程？

> ID：14005599
> 
> 赞同：7
> 
> 时间：2012-12-22T18:53:41.067
> 
> 标签：c, linux, linux-kernel, embedded-linux

我想迭代内核中的所有任务（线程和进程）并使用 for_each_process 宏打印 tid/pid 和名称：

```
#define for_each_process(p) \
    for (p = &init_task ; (p = next_task(p)) != &init_task ; ) 
```

如何区分线程和进程？

所以我会这样打印：

```
 if (p->real_parent->pid == NULL)
      printk("PROCESS: name: %s pid: %d \n",p->comm,p->pid);
 else
      printk("THREAD: name: %s tid: %d \n",p->comm,p->pid); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T12:37:17.337

您需要以下宏：

```
/*
 * Careful: do_each_thread/while_each_thread is a double loop so
 *          'break' will not work as expected - use goto instead.
 */
#define do_each_thread(g, t) \
        for (g = t = &init_task ; (g = t = next_task(g)) != &init_task ; ) do

#define while_each_thread(g, t) \
        while ((t = next_thread(t)) != g) 
```

像这样使用它们：

```
 rcu_read_lock();
        do_each_thread(g, t) {
            //...
        } while_each_thread(g, t);

        rcu_read_unlock(); 
```

# html - 填写输入类型=文件

> ID：14005613
> 
> 赞同：1
> 
> 时间：2012-12-22T18:56:16.980
> 
> 标签：html, input, tags

我知道`<input type = file />`出于安全原因，不允许在 HTML 中预填充标签。但是有没有`automated`办法通过任何方式以自动方式`scripts`用预先指定的文件填充该字段？`(by the user, and not the server`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:10:24.983

这是不可能的（有充分的理由），如果可能的话，实际上被认为是一个安全问题。想象一下，如果服务器可以自动选择用户计算机上的文件进行上传。吓人吧？

您可以看到 Microsoft 在[错误报告中解决了这个问题。](http://support.microsoft.com/kb/266087)

# java - 具有自定义文件保存能力的 Java 爬虫

> ID：14005616
> 
> 赞同：1
> 
> 时间：2012-12-22T18:57:00.490
> 
> 标签：java, web-crawler

我正在寻找一个用 Java 编写的开源网络爬虫，**除了通常的网络爬虫功能，如深度/多线程/等。**具有自定义处理每种文件类型的能力。

更准确地说，当一个文件被下载（或即将被下载）时，我想处理文件的保存操作。HTML 文件应保存在不同的存储库中，图像应保存在其他位置，其他文件应保存在其他位置。此外，存储库可能不仅仅是一个简单的文件系统。

我听说过很多关于[Apache Nutch](http://nutch.apache.org)的信息。它有能力做到这一点吗？我希望尽可能简单快速地实现这一目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:27:03.220

基于您希望对爬虫的工作方式进行大量控制的假设，我会推荐[crawler4j](http://code.google.com/p/crawler4j/)。有很多[例子](http://code.google.com/p/crawler4j/source/browse/src/test/java/edu/uci/ics/crawler4j/examples/)，所以你可以快速了解事情是如何工作的。

您可以根据内容类型轻松处理资源（查看[Page.java](http://code.google.com/searchframe#cRPXZ1h-0hE/src/main/java/edu/uci/ics/crawler4j/crawler/Page.java)类 - 它是包含有关已获取资源的信息的对象类）。

存储库没有限制。你可以使用任何你想要的东西。

# javascript - Javascript getElementsByTagName("div") 我在标记什么？

> ID：14005621
> 
> 赞同：2
> 
> 时间：2012-12-22T18:57:31.183
> 
> 标签：javascript, gallery, getelementsbytagname

我正在尝试将一组 div“gallerybox”（位于另一个 div “galleryimages”内）的 ID 设置为递增增量，即。图片1、图片2等

我见过类似的问题，并试图绕过它们，但这很困难。现在我的问题是，我从这里的第二行得到什么？什么是“画廊盒子”？我是否能够像我尝试的那样像数组和标签 ID 一样循环遍历它？

```
var galleryimages = document.getElementById("galleryimages");
var galleryboxes = galleryimages.getElementsByTagName("div");

var k = 1;

for (var i = 0; i < galleryboxes.length; i++) {
galleryboxes[i].setAttribute=("id", "picture" + k);
k++;
} 
```

代码似乎有效，但我认为我实际上并没有标记我想要标记的 div；我检查“picture1”的内容是什么，它显示为空（它应该充满了图片和一些文字）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T19:08:41.997

### 我从这里的第二行得到什么？

有问题的行是这样的：

```
var galleryboxes = galleryimages.getElementsByTagName("div"); 
```

这样做的目的是提供一个`nodeList`完整的带有标签名称的所有元素，`<div>`这些元素是变量所`galleryimages`代表的元素的子元素。请注意，这不是一个实际的数组，并且数组和 a 之间有区别特征`nodeList`。最值得注意的是， a`nodeList`不从`Array`构造函数继承，因此不包含所有数组通用的基本方法，如`push`、`pop`和。`sort`

### 我是否能够像我尝试的那样像数组和标签 ID 一样循环遍历它？

是的。这对我们来说很容易，因为幸运`nodeList`的是 s 有一个`length`属性。您已经展示了如何遍历它们，但是您设置属性的行格式不正确：

```
galleryboxes[i].setAttribute=("id", "picture" + k); 
```

等号不应该在那里。这会引发语法错误。如果你把等号去掉，代码就可以正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T19:02:25.273

`galleryboxes`给你一个节点列表，你可以像数组一样迭代它，但你在这里有一个错误

```
galleryboxes[i].setAttribute=("id", "picture" + k); 
```

应该

```
galleryboxes[i].setAttribute("id", "picture" + k); 
```

注意缺乏`=`

也可以使用 id 属性来完成。

```
galleryboxes[i].id = "picture" + k; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T19:07:54.500

galleryboxes 是一个数组，其中包含元素“galleryimages”中的所有 div

```
<html>
<head>
    ...
<head>
<body>
    <div id="galleryimages">   
        <div class="img_container"></div>
        <p>This text will not be in the array...</p>
        <div class="img_container"></div>
        <div class="img_container"></div>
    </div>
</body>
</html> 
```

如果您的代码与上面类似，则该变量`galleryboxes`将仅包含 div。

至于当您检查“picture1”的内容时，它可能为空，我想您已经在 css 中为#picture1 定义了背景图像，对吗？

无论如何，您应该做的就是使用诸如 firebug 之类的东西来查看生成的 DOM。这样你可以更容易地调试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T19:08:32.397

`galleryboxes[i].id`如果您以后想以编程方式访问它（至少如果您希望它始终如一地工作），您将需要直接设置该属性 ( )。所以：

```
var galleryimages = document.getElementById("galleryimages");
var galleryboxes = galleryimages.getElementsByTagName("div");

for (var i = 0; i < galleryboxes.length; i++) {
    galleryboxes[i].id = "picture" + (i + 1);
} 
```

[有关示例，请参见此 jsfiddle](http://jsfiddle.net/ChrisPebble/ngVgA/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T19:22:58.053

我知道，您在这里寻找 javascript 答案，但您也可以尝试使用此 jQuery 代码，如果您也想的话：

```
$("#galleryimages > div").each(function(i) {
    $(this).prop("id", "picture" + (i + 1));
});​ 
```

只看 3 行代码 :)

# java - 为什么 ZipInputStream 在其中找不到文件

> ID：14005624
> 
> 赞同：0
> 
> 时间：2012-12-22T18:57:55.703
> 
> 标签：java

我想将文件中的数据读入Java中的Zip文件

```
InputStream is = new FileInputStream("file.zip");
ZipInputStream zis = new ZipInputStream(is);
ZipEntry entry;
while ((entry = zis.getNextEntry()) != null) {
    Scanner scanner = new Scanner(zis);
} 
```

但是当我到达排队时：

```
while((entry = zis.getNextEntry()) != null) { 
```

它没有进入while循环，为什么不能访问其中的文件，而zis本身没有和入口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:30:10.490

我发现错误！文件的位置对java很重要我将文件的位置更改为我的项目之外，它得到了正确的感谢大家

# mysql - 可疑的 SQL 实践 - 按 id 排序而不是创建时间

> ID：14005631
> 
> 赞同：16
> 
> 时间：2012-12-22T18:59:14.613
> 
> 标签：mysql, sql, database, query-optimization

所以我有一个有趣的问题，我不确定是否被认为是“黑客”。我查看了一些问题，但没有找到重复的问题，所以在这里。基本上，我需要知道这是否不可靠或被认为是不好的做法。

我有一个非常简单的表，它有一个唯一的自动递增 id 和一个 created_at 时间戳。（我的问题的简化版本以澄清相关概念）

```
+-----------+--------------------+
| id        |created_at          |
+-----------+--------------------+
| 1         |2012-12-11 20:35:19 |
| 2         |2012-12-12 20:35:19 |
| 3         |2012-12-13 20:35:19 |
| 4         |2012-12-14 20:35:19 |
+-----------+--------------------+ 
```

这两列都是动态添加的，因此可以说新的“插入”**总是**有更大的 id 并且**总是**有更大的日期。

**目标**- 非常简单地获取按 created_at 降序排序的结果

**解决方案一**- 按日期降序排列的查询

```
SELECT * FROM tablename
ORDER BY created_at DESC 
```

**解决方案二**- 按 ID 降序排序的查询

```
SELECT * FROM tablename
ORDER BY id DESC 
```

解决方案二是否被认为是不好的做法？或者解决方案二是正确的做事方式。当我试图理解这个概念时，对你的推理的任何解释都会非常有帮助，而不仅仅是简单地得到答案。提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-22T19:04:14.747

在典型实践中，您几乎总是可以假设可以对自动增量 id 进行排序，以便按创建顺序（任一方向）为您提供记录。但是，您应该注意，就您的数据而言，这不被认为是可移植的。您可以将数据移动到重新创建密钥的另一个系统，但 created_at 数据是相同的。

实际上有一个关于这个问题的很好的[StackOverflow 讨论](https://stackoverflow.com/questions/3730762/sql-best-practices-ok-to-rely-on-auto-increment-field-to-sort-rows-chronologic)。

基本总结是第一个解决方案，按 created_at 排序，被认为是最佳实践。但是，请务必正确索引 created_at 字段以提供最佳性能。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-22T19:24:23.687

除了唯一标识一行之外，您不应该依赖 ID 来处理任何事情。它是一个任意数字，恰好与创建记录的顺序相对应。

假设你有这张桌子

```
ID  creation_date
1   2010-10-25
2   2010-10-26
3   2012-03-05 
```

在这种情况下，按 ID 排序而不是 creation_date 有效。

现在在未来你意识到，哦，哎呀，你必须将记录 ID #2 的创建日期更改为 2010-09-17。您使用 ID 的排序现在以相同的顺序报告记录：

```
1   2010-10-25
2   2010-09-17
3   2012-03-05 
```

即使有了新的日期，它们应该是：

```
2   2010-09-17
1   2010-10-25
3   2012-03-05 
```

短版：**将数据列用于创建它们的目的。**不要依赖数据的副作用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-22T19:03:37.357

这两个选项之间存在一些差异。

* * *

首先是它们可以给出不同的结果。

的值`created_at`可能会受到服务器上正在调整的时间的影响，但该`id`列将不受影响。如果时间向后调整（手动或通过时间同步软件自动），您可以获得稍后插入的记录，但时间戳在较早插入的记录之前。在这种情况下，您将获得不同的顺序，具体取决于您订购的列。您认为哪个顺序“正确”取决于您。

* * *

二是性能。`ORDER BY`您的[聚集索引](http://dev.mysql.com/doc/refman/5.5/en/innodb-index-types.html)可能会更快。

> **聚集索引如何加速查询**
> 
> 通过聚集索引访问行速度很快，因为行数据位于索引搜索引导的同一页上。

默认情况下，聚集键是主键，在您的情况下可能是`id`列。您可能会发现它`ORDER BY id`比`ORDER BY created_at`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-22T19:11:48.760

*按插入*顺序按 id排序。

如果您有可能延迟插入的用例，例如批处理，那么您必须按 created_at 排序才能按时间排序。

如果它们满足您的需求，两者都是可以接受的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-22T19:07:18.743

主键，尤其是代理类型的主键，通常不代表任何类型的有意义的数据，除了它们的功能是允许唯一可识别的记录。由于在这种情况下日期确实代表了有意义的数据，这些数据在其主要功能之外具有意义，我想说根据日期进行排序是一种更合乎逻辑的方法。

# java - Java 生成字符串的所有可能排列

> ID：14005633
> 
> 赞同：2
> 
> 时间：2012-12-22T18:59:36.117
> 
> 标签：java, string, permutation

我知道这个问题已经被问过很多次了，但是我正在寻找一种非常快速的算法来生成长度为 8 的字符串的所有排列。我正在尝试生成一个长度为 8 的字符串，其中字符串中的每个字符都可以是任何字符 0-9 或 az（总共 36 个选项）。目前，这是我必须这样做的代码：

```
for(idx[2] = 0; idx[2] < ch1.length; idx[2]++)
for(idx[3] = 0; idx[3] < ch1.length; idx[3]++)
    for(idx[4] = 0; idx[4] < ch1.length; idx[4]++)
        for(idx[5] = 0; idx[5] < ch1.length; idx[5]++)
            for(idx[6] = 0; idx[6] < ch1.length; idx[6]++)
                for(idx[7] = 0; idx[7] < ch1.length; idx[7]++)
                    for(idx[8] = 0; idx[8] < ch1.length; idx[8]++)
                        for(idx[9] = 0; idx[9] < ch1.length; idx[9]++) 
                            String name = String.format("%c%c%c%c%c%c%c%c%c%c",ch1[idx[0]],ch2[idx[1]],ch3[idx[2]],ch4[idx[3]],ch5[idx[4]],ch6[idx[5]],ch7[idx[6]],ch8[idx[7]],ch9[idx[8]],ch10[idx[9]]); 
```

如您所见，这段代码无论如何都不漂亮。此外，此代码每秒可以生成 28 万个字符串。我正在寻找一种比这更快的算法。

我尝试了一种递归方法，但这似乎比这种方法运行得慢。建议？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-22T19:10:05.317

应该更快（每秒产生超过百万输出），至少阅读起来肯定更愉快：

```
final long count = 36L * 36L * 36L * 36L * 36L * 36L * 36L * 36L;

for (long i = 0; i < count; ++i) {
    String name = StringUtils.leftPad(Long.toString(i, 36), 8, '0');
} 
```

这利用了您的问题：

> 生成一个长度为 8 的字符串，其中字符串中的每个字符可以是 0-9 或 az 中的任何字符（总共 36 个选项）

可以重新表述为：

*在 base-36 系统中打印从`0`until`36^8`*的所有数字。

几点注意事项：

*   输出按定义排序，很好！

*   为了简单起见，我使用[`StringUtils.leftPad()`](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html#leftPad(java.lang.String,%20int,%20char))，另请参阅：[如何在左侧填充一个带有零的整数？](https://stackoverflow.com/questions/473282)

*   您正在寻找的并不是真正的[排列](http://en.wikipedia.org/wiki/Permutation)

*   通过利用您生成所有后续数字的事实，您可以轻松地进一步改进此算法：

    ```
    final int MAX = 36;
    final long count = 1L * MAX * MAX * MAX * MAX * MAX * MAX * MAX * MAX * MAX * MAX;

    final char[] alphabet = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".toCharArray();
    final int[] digits = new int[8];
    final char[] output = "00000000".toCharArray();

    for (long i = 0; i < count; ++i) {
        final String name = String.valueOf(output);

        // "increment"
        for (int d = 7; d >= 0; --d) {
            digits[d] = (digits[d] + 1) % MAX;
            output[d] = alphabet[digits[d]];
            if (digits[d] > 0) {
                break;
            }
        }

    } 
    ```

上面的程序，在我的电脑上，每秒生成超过**3000 万个字符串。**而且还有很大的改进空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:24:54.507

这段代码可能看起来更漂亮 - 或者至少更复杂；）

```
boolean incrementIndex( int[] idx, final int maxValue ) {
  int i = 0;
  int currIndexValue;
  do {
    currIndexValue = idx[i];
    currIndexValue++;
    if ( currIndexValue > maxValue ) {
      currIndexValue = 0;
    }
    idx[i] = currIndexValue;
    i++;
  } while ( currIndexValue == 0 && i < idx.length );

  return i < idx.length;
}

do {
  // create String from idx[0]...idx[8]
} while ( incrementIndex(idx, 35) ); 
```

# batch-file - 如何注销 dll 然后在同一个批处理文件上注册 dll？

> ID：14005640
> 
> 赞同：2
> 
> 时间：2012-12-22T19:00:19.867
> 
> 标签：batch-file, cmd

我在命令提示符下使用以下命令手动注销并注册了一个 dll。

注销：

```
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\RegAsm.exe "C:\Program Files\ABC\foo.dll" /codebase /u 
```

登记：

```
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\RegAsm.exe "C:\Program Files\ABC\foo.dll" /codebase 
```

因此，请帮助我使用批处理命令，以便客户可以在不知道如何手动执行的情况下运行此批处理

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T15:00:22.170

简单地说，批处理文件就是一长串按顺序执行的命令行命令。所以用你的命令制作一个 .bat 文件。创建一个文本文件并将其命名为 File.bat，然后将您的命令复制并粘贴到该文件中。保存，你就完成了。请注意，在命令和 bat 文件中使用符号时存在一些差异，但对于您的需要，这不是问题。

**例子：**

```
:: Hide commands statements
@echo off

:: Unregister
"C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\RegAsm.exe" "C:\Program Files\ABC\foo.dll" /codebase /u

:: Register
"C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\RegAsm.exe" "C:\Program Files\ABC\foo.dll" /codebase 
```

**大批量参考：**

[`Technet`](http://technet.microsoft.com/en-us/library/cc772390%28v=ws.10%29.aspx), [`Rob`](http://www.robvanderwoude.com/batchfiles.php), [`SS64`](http://ss64.com/),[`DosTips`](http://www.dostips.com/)

# email - 推进匹配电子邮件验证器是错误的？

> ID：14005641
> 
> 赞同：1
> 
> 时间：2012-12-22T19:00:33.460
> 
> 标签：email, match, propel

我尝试使用 Propel 匹配验证器。在本例中为电子邮件字符串。我使用 Propel Docs 中的示例：

```
/^([a-zA-Z0-9])+([\.a-zA-Z0-9_-])*@([a-zA-Z0-9])+(\.[a-zA-Z0-9_-]+)+$/ 
```

但是，这个正则表达式总是失败。例如：pepe@mail.com、ramiro@gmail.com、messi.10@barsa.ca、js_veron@hotmail.com.ar

任何想法 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T22:00:06.720

问题是永远不要分配电子邮件值，谢谢！

# dojo - Dojo调试js文件

> ID：14005642
> 
> 赞同：0
> 
> 时间：2012-12-22T19:00:36.423
> 
> 标签：dojo

你能告诉他们在 Dojo 中使用了什么 js 文件吗？我尝试调试但找不到请帮助。

[http://www.ibm.com/us/en/](http://www.ibm.com/us/en/)

```
<title>IBM - United States</title>
<script src="//1.www.s81c.com/common/js/ipadpilot.js">//</script>
<link href="//1.www.s81c.com/common/v17/css/www.css" rel="stylesheet" title="www" type="text/css">
<script src="//1.www.s81c.com/common/js/dojo/www.js" type="text/javascript">//</script><link rel="search" type="application/opensearchdescription+xml" href="http://www.ibm.com/search/opensearch/description.xml" title="IBM Search">
<link type="text/css" title="www" rel="stylesheet" href="//1.www.s81c.com/common/v17/css/homepage.css">
<script type="text/javascript">
ibmweb.config.set({ sbs: { enabled: false }, easyaccess: { enabled: false }  });

dojo.require('ibmweb.homepage');

</script><script type="text/javascript" charset="utf-8" src="//1.www.s81c.com/common/js/dojo/1.6/ibmweb/homepage.xd.js"></script>
<style type="text/css"> 
```

# ruby-on-rails - Heroku - 从另一个目录部署应用程序

> ID：14005644
> 
> 赞同：0
> 
> 时间：2012-12-22T19:00:50.757
> 
> 标签：ruby-on-rails, ruby, deployment, heroku

我有一个目录`A`，我从该目录中将 Rails 应用程序部署到 Heroku。现在，我将本地主机上的这个项目移动到另一个名为的目录`B`，并且从这个`B`目录我需要将应用程序部署到原始 Heroku 应用程序（到我从`A`目录部署代码的同一个应用程序）。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:05:09.447

您需要将 git repo url 添加到`B`.

```
git remote add heroku git@heroku.com:YOURAPPNAME.git 
```

并且`git push heroku master`会工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:06:15.187

只要您将`.git`目录与其余文件一起移动，就应该没有区别，一切都应该像以前一样工作。如果您没有该`.git`目录，则必须再次设置远程 heroku url。

# php - 通过来自 iOS 的 http post 请求接收 php 中的图像

> ID：14005646
> 
> 赞同：0
> 
> 时间：2012-12-22T19:01:34.550
> 
> 标签：php, ios, http

我正在尝试将图像从 iOS 设备发送到 php 脚本。我在 iOS 端没有收到错误，所以我相信问题出在我的 php 脚本上。我是php新手，请原谅我。这是php脚本：

```
<?php
$uploaddir = './';      //Uploading to same directory as PHP file
$file = basename($_FILES['userfile']['name']);
$uploadFile = $file;
$randomNumber = rand(0, 99999); 
$newName = $uploadDir . $randomNumber . $uploadFile;

if (is_uploaded_file($_FILES['userfile']['tmp_name'])) {
    echo "Temp file uploaded. \r\n";
} else {
    echo "Temp file not uploaded. \r\n";
}

if ($_FILES['userfile']['size']> 300000) {
    exit("Your file is too large."); 
}

if (move_uploaded_file($_FILES['userfile']['tmp_name'], $newName)) {
    $postsize = ini_get('post_max_size');   //Not necessary, I was using these
    $canupload = ini_get('file_uploads');    //server variables to see what was 
    $tempdir = ini_get('upload_tmp_dir');   //going wrong.
    $maxsize = ini_get('upload_max_filesize');
    echo "http://www.iroboticshowoff.com/dir/{$file}" . "\r\n" . $_FILES['userfile']['size'] . "\r\n" . $_FILES['userfile']['type'] ;
}
?> 
```

如果有人对 iOS 了解很多，这里是我用来发送图像的代码：

```
// Dictionary that holds post parameters. You can set your post parameters that your server accepts or programmed to accept.
NSMutableDictionary* _params = [[NSMutableDictionary alloc] init];
[_params setObject:[NSString stringWithString:@"1.0"] forKey:[NSString stringWithString:@"ver"]];
[_params setObject:[NSString stringWithString:@"en"] forKey:[NSString stringWithString:@"lan"]];

// the boundary string : a random string, that will not repeat in post data, to separate post data fields.
NSString *BoundaryConstant = [NSString stringWithString:@"----------V2ymHFg03ehbqgZCaKO6jy"];

// string constant for the post parameter 'file'. My server uses this name: `file`. Your's may differ
NSString* FileParamConstant = [NSString stringWithString:@"file"];

// the server url to which the image (or the media) is uploaded. Use your server url here
NSURL* requestURL = [NSURL URLWithString:@"http://myurl.com/upload.php"];

// create request
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
[request setCachePolicy:NSURLRequestReloadIgnoringLocalCacheData];
[request setHTTPShouldHandleCookies:NO];
[request setTimeoutInterval:30];
[request setHTTPMethod:@"POST"];

// set Content-Type in HTTP header
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@", BoundaryConstant];
[request setValue:contentType forHTTPHeaderField: @"Content-Type"];

// post body
NSMutableData *body = [NSMutableData data];

// add params (all params are strings)
for (NSString *param in _params) {
    [body appendData:[[NSString stringWithFormat:@"--%@\r\n", BoundaryConstant] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"%@\"\r\n\r\n", param] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"%@\r\n", [_params objectForKey:param]] dataUsingEncoding:NSUTF8StringEncoding]];
}

// add image data
NSData *imageData = UIImageJPEGRepresentation(finalImage, 1.0);
if (imageData) {
    [body appendData:[[NSString stringWithFormat:@"--%@\r\n", BoundaryConstant] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"%@\"; filename=\"image.jpg\"\r\n", FileParamConstant] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithString:@"Content-Type: image/jpeg\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:imageData];
    [body appendData:[[NSString stringWithFormat:@"\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
}

[body appendData:[[NSString stringWithFormat:@"--%@--\r\n", BoundaryConstant] dataUsingEncoding:NSUTF8StringEncoding]];

// setting the body of the post to the reqeust
[request setHTTPBody:body];

// set the content-length
NSString *postLength = [NSString stringWithFormat:@"%d", [body length]];
[request setValue:postLength forHTTPHeaderField:@"Content-Length"];

// set URL
[request setURL:requestURL]; 
```

我在stackoverflow上找到了这两个，但据我了解iOS工作正常，php应该将照片放在我服务器的根目录中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:09:11.070

[$_FILES](http://php.net/manual/en/reserved.variables.files.php)数组包含很多有用的信息。您可以（并且应该）使用[var_dump()](http://php.net/manual/en/function.var-dump.php)打印出内容。这是一个用于上传文件的脚本。也许您可以根据自己的需要调整设计。

```
<?php // RAY_upload_example.php
error_reporting(E_ALL);

// MANUAL REFERENCE PAGES YOU MUST UNDERSTAND TO UPLOAD FILES
// http://php.net/manual/en/features.file-upload.php
// http://php.net/manual/en/features.file-upload.common-pitfalls.php
// http://php.net/manual/en/function.move-uploaded-file.php
// http://php.net/manual/en/reserved.variables.files.php

// MANUAL PAGES THAT ARE IMPORTANT IF YOU ARE DEALING WITH LARGE FILES
// http://php.net/manual/en/ini.core.php#ini.upload-max-filesize
// http://php.net/manual/en/ini.core.php#ini.post-max-size
// http://php.net/manual/en/info.configuration.php#ini.max-input-time

// PHP 5.1+  SEE http://php.net/manual/en/function.date-default-timezone-set.php
date_default_timezone_set('America/Chicago');

// ESTABLISH THE NAME OF THE 'uploads' DIRECTORY (MUST ALREADY EXIST)
$uploads = 'RAY_junk';

// ESTABLISH THE BIGGEST FILE SIZE WE CAN ACCEPT - ABOUT 8 MB
$max_file_size = '8000000';

// ESTABLISH THE MAXIMUM NUMBER OF FILES WE CAN UPLOAD
$nf = 3;

// ESTABLISH THE KINDS OF FILE EXTENSIONS WE CAN ACCEPT
$file_exts = array
( 'jpg'
, 'gif'
, 'png'
, 'txt'
, 'pdf'
)
;

// LIST OF THE ERRORS THAT MAY BE REPORTED IN $_FILES[]["error"] (THERE IS NO #5)
$errors = array
( 0 => "Success!"
, 1 => "The uploaded file exceeds the upload_max_filesize directive in php.ini"
, 2 => "The uploaded file exceeds the MAX_FILE_SIZE directive that was specified in the HTML form"
, 3 => "The uploaded file was only partially uploaded"
, 4 => "No file was uploaded"
, 5 => "UNDEFINED ERROR"
, 6 => "Missing a temporary folder"
, 7 => "Cannot write file to disk"
)
;

// IF THERE IS NOTHING IN $_POST, PUT UP THE FORM FOR INPUT
if (empty($_POST))
{
    ?>
    <h2>Upload <?php echo $nf; ?> file(s)</h2>

    <!--
        SOME THINGS TO NOTE ABOUT THIS FORM...
        ENCTYPE IN THE HTML <FORM> STATEMENT
        MAX_FILE_SIZE MUST PRECEDE THE FILE INPUT FIELD
        INPUT NAME= IN TYPE=FILE DETERMINES THE NAME YOU FIND IN $_FILES ARRAY
        ABSENCE OF ACTION= ATTRIBUTE IN FORM TAG CAUSES POST TO SAME URL
    -->

    <form name="UploadForm" enctype="multipart/form-data" method="post">
    <input type="hidden" name="MAX_FILE_SIZE" value="<?php echo $max_file_size; ?>" />
    <p>
    Find the file(s) you want to upload and click the "Upload" button below.
    </p>

    <?php // CREATE INPUT STATEMENTS FOR UP TO $n FILE NAMES
    for ($n = 0; $n < $nf; $n++)
    {
        echo "<input name=\"userfile$n\" type=\"file\" size=\"80\" /><br/>\n";
    }
    ?>

    <br/>Check this box <input autocomplete="off" type="checkbox" name="overwrite" /> to <strong>overwrite</strong> existing files.
    <input type="submit" value="Upload" />
    </form>
    <?php
    die();
}
// END OF THE FORM SCRIPT

// WE HAVE GOT SOMETHING IN $_POST - RUN THE ACTION SCRIPT
else
{
    // THERE IS POST DATA - PROCESS IT
    echo "<h2>Results: File Upload</h2>\n";

    // ACTIVATE THIS TO SEE WHAT IS COMING THROUGH
    // echo "<pre>"; var_dump($_FILES); var_dump($_POST); echo "</pre>\n";

    // ITERATE OVER THE CONTENTS OF $_FILES
    foreach ($_FILES as $my_uploaded_file)
    {
        // SKIP OVER EMPTY SPOTS - NOTHING UPLOADED
        $error_code = $my_uploaded_file["error"];
        if ($error_code == 4) continue;

        // SYNTHESIZE THE NEW FILE NAME
        $f_type    = trim(strtolower(end    (explode( '.', basename($my_uploaded_file['name'] )))));
        $f_name    = trim(strtolower(current(explode( '.', basename($my_uploaded_file['name'] )))));
        $my_new_file
        = getcwd()
        . DIRECTORY_SEPARATOR
        . $uploads
        . DIRECTORY_SEPARATOR
        . $f_name
        . '.'
        . $f_type
        ;
        $my_file
        = $uploads
        . DIRECTORY_SEPARATOR
        . $f_name
        . '.'
        . $f_type;

        // OPTIONAL TEST FOR ALLOWABLE EXTENSIONS
        if (!in_array($f_type, $file_exts)) die("Sorry, $f_type files not allowed");

        // IF THERE ARE ERRORS
        if ($error_code != 0)
        {
            $error_message = $errors[$error_code];
            die("Sorry, Upload Error Code: $error_code: $error_message");
        }

        // GET THE FILE SIZE
        $file_size = number_format($my_uploaded_file["size"]);

        // IF THE FILE IS NEW (DOES NOT EXIST)
        if (!file_exists($my_new_file))
        {
            // IF THE MOVE FUNCTION WORKED CORRECTLY
            if (move_uploaded_file($my_uploaded_file['tmp_name'], $my_new_file))
            {
                $upload_success = 1;
            }
            // IF THE MOVE FUNCTION FAILED
            else
            {
                $upload_success = -1;
            }
        }

        // IF THE FILE ALREADY EXISTS
        else
        {
            echo "<br/><b><i>$my_file</i></b> already exists.\n";

            // SHOULD WE OVERWRITE THE FILE? IF NOT
            if (empty($_POST["overwrite"]))
            {
                $upload_success = 0;
            }
            // IF WE SHOULD OVERWRITE THE FILE, TRY TO MAKE A BACKUP
            else
            {
                $now    = date('Y-m-d');
                $my_bak = $my_new_file . '.' . $now . '.bak';
                if (!copy($my_new_file, $my_bak))
                {
                    echo "<br/><strong>Attempted Backup Failed!</strong>\n";
                }
                if (move_uploaded_file($my_uploaded_file['tmp_name'], $my_new_file))
                {
                    $upload_success = 2;
                }
                else
                {
                    $upload_success = -1;
                }
            }
        }

        // REPORT OUR SUCCESS OR FAILURE
        if ($upload_success == 2) { echo "<br/>It has been overwritten.\n"; }
        if ($upload_success == 1) { echo "<br/><strong>$my_file</strong> has been saved.\n"; }
        if ($upload_success == 0) { echo "<br/><strong>It was NOT overwritten.</strong>\n"; }
        if ($upload_success < 0)  { echo "<br/><strong>ERROR: $my_file NOT SAVED - SEE WARNING FROM move_uploaded_file() COMMAND</strong>\n"; }
        if ($upload_success > 0)
        {
            echo "$file_size bytes uploaded.\n";
            if (!chmod ($my_new_file, 0755))
            {
                echo "<br/>chmod(0755) FAILED: fileperms() = ";
                echo substr(sprintf('%o', fileperms($my_new_file)), -4);
            }
            echo "<br/><a target=\"_blank\" href=\"$my_file\">See the file $my_file</a>\n";
        }
    // END FOREACH ITERATOR - EACH ITERATION PROCESSES ONE FILE
    }
} 
```

# java - 在 Java 中为 BigIntegers 生成从 1 到 n-1 的随机数

> ID：14005647
> 
> 赞同：-1
> 
> 时间：2012-12-22T19:01:57.227
> 
> 标签：java, biginteger

> **可能重复：**
> [如何在 Java 中生成随机 BigInteger 值？](https://stackoverflow.com/questions/2290057/how-to-generate-a-random-biginteger-value-in-java)

我在 JAVA 中使用 BigInteger 类，我想从`1 to x-1`. 我不知道该怎么做？

我不能使用`nextInt()`，因为它只接受`int`不接受`BigIntegers`，我将生成 32 位及以上的数字，所以，甚至`nextInt()`不会工作。

我知道如果我搜索我可能会找到一些有用的解决方案，但我的时间太短了。（截止日期前2小时）

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:47:49.933

愿这项工作

```
 public static void main(String[] args) {
        BigInteger bigInteger = new BigInteger("9349988899999");
        BigInteger bigInteger1 = bigInteger.subtract(new BigInteger("1"));
        System.out.println(randomBigInteger(bigInteger1));
    }

    public static BigInteger randomBigInteger(BigInteger n) {
        Random rnd = new Random();
        int maxNumBitLength = n.bitLength();
        BigInteger aRandomBigInt;
        do {
            aRandomBigInt = new BigInteger(maxNumBitLength, rnd);
            // compare random number lessthan ginven number
        } while (aRandomBigInt.compareTo(n) > 0); 
        return aRandomBigInt;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:07:02.973

只需使用get的[构造函数](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html#BigInteger%28int,%20java.util.Random%29)`Random`

```
Random rnd = new Random();
BigInteger i = new BigInteger(maxNumOfBits, rnd); 
```

如果您想要介于 0 和某个数字之间，您可以生成与该数字相同的位数并生成随机数，直到您得到比它少的一位。

（代码未测试）

```
public static BigInteger randomBigInteger(BigInteger maxNum) {
    Random rnd = new Random();
    int maxNumBitLength = maxNum.bitLength();
    BigInteger rndNum;
    do {
        rndNum = new BigInteger(maxNumBitLength, nd);
    } while(result.compareTo(upperLimit) >= 0);
    return result;
} 
```

# scala - akka 将任务拆分为更小的并折叠结果

> ID：14005650
> 
> 赞同：3
> 
> 时间：2012-12-22T19:02:43.920
> 
> 标签：scala, akka, actor

问题是关于**Akka 演员**库。A 想要将一项大任务拆分为较小的任务，然后将它们的结果折叠成一个“大”结果。这会给我更快的计算利润。如果较小的任务是独立的，则可以并行计算它们。

假设我们需要像这样计算一些东西。函数`count2X`很耗时，因此在一个线程中多次使用它并不是最佳选择。

```
//NOT OPTIMAL
def count2X(x: Int) = {
  Thread.sleep(1000)
  x * 2
}

val sum = count2X(1) + count2X(2) + count2X(3)
println(sum) 
```

问题来了。

**如何调度任务并收集结果然后折叠它们，所有这些都使用 akka 演员？** Akka 是否已经提供了这样的功能，还是我需要自己实现？这种方法的最佳做法是什么。

这是我的问题的“视觉”解释：

```
 /-> [SMALL_TASK_1] -\
[BIG_TASK] -+--> [SMALL_TASK_1] --> [RESULT_FOLD]
             \-> [SMALL_TASK_1] -/ 
```

下面是我的脚手架实现缺少/错误的实现:)

```
case class Count2X(x: Int)

class Count2XActor extends Actor {
  def receive = {
    case Count2X(x) => count2X(x); // AND NOW WHAT ?
  }
}

case class CountSumOf2X(a: Int, b: Int, c: Int)

class SumOf2XActor extends Actor {
  val aCounter = context.actorOf(Props[Count2XActor])
  val bCounter = context.actorOf(Props[Count2XActor])
  val cCounter = context.actorOf(Props[Count2XActor])

  def receive = {
    case CountSumOf2X(a, b, c) => // AND NOW WHAT ? aCounter ! Count2X(a); bCounter ! Count2X(b); cCounter ! Count2X(c);
  }
}

val aSystem = ActorSystem("mySystem")
val actor = aSystem.actorOf(Props[SumOf2XActor])

actor ! CountSumOf2X(10, 20, 30) 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T00:49:21.437

在 Akka，我会做这样的事情：

```
val a = aCounter ? Count2X(10) mapTo[Int]
val b = bCounter ? Count2X(10) mapTo[Int]
val c = cCounter ? Count2X(10) mapTo[Int]
Await.result(Future.sequence(a, b, c) map (_.sum), 1 second).asInstanceOf[Int] 
```

我确信有更好的方法 - 在这里你开始对结果求和，毕竟`Future`-s 是并行完成的，对于简单的任务没关系，但通常你不应该等那么久

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T19:13:34.367

你可以做两件事：

1) 使用 Akka 期货。这些允许您分派操作并以异步方式折叠它们。查看[http://doc.akka.io/docs/akka/2.0.4/scala/futures.html](http://doc.akka.io/docs/akka/2.0.4/scala/futures.html)了解更多信息。

2）您可以将工作分派给多个“工人”演员，然后让“主”演员聚合它们，通过将信息存储在消息本身中来跟踪哪些消息正在等待/处理。我在这里有一个使用 Akka 演员的简单股票报价示例：[https ://github.com/ryanlecompte/quotes](https://github.com/ryanlecompte/quotes)

# c - 将十六进制转换为二进制并将位存储在数组中

> ID：14005651
> 
> 赞同：0
> 
> 时间：2012-12-22T19:02:50.540
> 
> 标签：c, binary, hex

我正在尝试用 C 编写一个函数，将十六进制值转换为其二进制表示，然后将每个位分别存储在一个数组中。

所以目前我正在使用这种冗长的方法..

```
void HexToBinary(int *bits, unsigned int hex)
{
  bits[31] = (hex & 0x90000000) >> 31;
  bits[30] = (hex & 0x50000000) >> 30;
  bits[29] = (hex & 0x30000000) >> 29;
  bits[28] = (hex & 0x10000000) >> 28;
  bits[27] = (hex & 0x09000000) >> 27;
  bits[26] = (hex & 0x05000000) >> 26;
  bits[25] = (hex & 0x03000000) >> 25;
  bits[24] = (hex & 0x01000000) >> 24;
  bits[23] = (hex & 0x00900000) >> 23;
  bits[22] = (hex & 0x00500000) >> 22;
  bits[21] = (hex & 0x00300000) >> 21;
  bits[20] = (hex & 0x00100000) >> 20;
  bits[19] = (hex & 0x00090000) >> 19;
  bits[18] = (hex & 0x00050000) >> 18;
  bits[17] = (hex & 0x00030000) >> 17;
  bits[16] = (hex & 0x00010000) >> 16;
  bits[15] = (hex & 0x00009000) >> 15;
  bits[14] = (hex & 0x00005000) >> 14;
  bits[13] = (hex & 0x00003000) >> 13;
  bits[12] = (hex & 0x00001000) >> 12;
  bits[11] = (hex & 0x00000900) >> 11;
  bits[10] = (hex & 0x00000500) >> 10;
  bits[9] = (hex & 0x00000300) >> 9;
  bits[8] = (hex & 0x00000100) >> 8;
  bits[7] = (hex & 0x00000090) >> 7;
  bits[6] = (hex & 0x00000050) >> 6;
  bits[5] = (hex & 0x00000030) >> 5;
  bits[4] = (hex & 0x00000010) >> 4;
  bits[3] = (hex & 0x00000009) >> 3;
  bits[2] = (hex & 0x00000005) >> 2;
  bits[1] = (hex & 0x00000003) >> 1;
  bits[0] = (hex & 0x00000001);
} 
```

它采用 8 字符（32 位）十六进制值并使用 & 和位移识别所需的位，然后将其存储在十六进制值中每个位的数组中。

显然这是一个很长的方法，而且不是很好。我正在寻找一种更短更简单的方法来做到这一点。

这些位必须单独存储在数组中而不是四边形中，因为我必须单独访问程序中的每个位。

解决这个问题的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:10:29.887

```
for (int i=0;i<32;i++) {
  bits[i]=hex&1;
  hex>>=1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:09:39.327

只需使用一个循环：

```
void HexToBinary(int *bits, unsigned int hex) {
    for (int i = 0; i < 32; ++i) {
        bits[i] = (hex >> i) & 1;
    }
} 
```

您不必将所有位都放入数组中以单独访问每个位。您还可以使用以下功能访问它：

```
int bit(unsigned int hex, int i) {
    return (hex >> i) & 1;
} 
```

或使用宏：

```
#define BIT(hex, i) ((hex >> i) & 1) 
```

# c# - 如何在“Windows Store”（Metro）应用程序中将 Skydrive 文件夹包含在 FolderPicker 中？

> ID：14005652
> 
> 赞同：0
> 
> 时间：2012-12-22T19:02:52.470
> 
> 标签：c#, microsoft-metro, onedrive

我可以使用 FolderPicker 看到本地文件夹，但 Skydrive 的文件夹不显示。我如何包括它们？

编辑：对于它的价值，这是我的代码：

```
 async private void Button_Click_2(object sender, RoutedEventArgs e) {
        var picker = new FolderPicker();
        picker.SuggestedStartLocation=PickerLocationId.PicturesLibrary;
        picker.ViewMode=PickerViewMode.Thumbnail;
        picker.FileTypeFilter.Add(".jpg");
        picker.FileTypeFilter.Add(".jpeg");
        picker.FileTypeFilter.Add(".png");
        var folder = await picker.PickSingleFolderAsync();

    } 
```

编辑 2：*FilePicker*确实显示 Skydrive。但是我不能选择一个文件夹，所以这没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:48:45.713

skydrive 是默认存在的，只需单击“文件”下拉列表，然后单击 skydrive。

编辑

抱歉，我将您的问题误读为文件选择器。

当您请求存储文件夹时，您基本上要求请求对该文件夹中所有文件的权限，如果不将所有文件下载到本地缓存，skydrive 无法提供该权限 - 由于可能需要时间，这是不切实际的。

为什么文件选择器不适合您？

# python - 解析文本文件时如何反转我的for循环（python）

> ID：14005654
> 
> 赞同：0
> 
> 时间：2012-12-22T19:02:58.523
> 
> 标签：python

我有一个 for 循环，它遍历一个文本文件（在这种情况下实际上是一个 Python 文件），它试图提取所有函数（寻找单词`def`）。一旦它找到那个词，它就会开始记录行，直到它碰到一个空格（我用它来表示函数的结尾）。

`def`我的问题是，一旦我在文件中点击 a 并记录可能出现在函数之前的任何注释，我就想备份。例如：`# This function does the following...`等。我想备份，直到我不再遇到哈希。

我将如何用我写的这个循环向后看？

```
for (counter,line) in enumerate(visible_texts):
    line= line.encode('utf-8')
# if line doesn't contain def then ignore it
    if "def" in line and infunction== 0:
        match = re.search(r'\def (\w+)', line.strip())
        line = line.split ("def")[1]    
        print "Recording start of the function..."
        # Backup to see if there's any hashes above it (until the end of the hashes) ** how do I do this ** 
```

我最后想要的输出示例是：

```
# This function was created by Thomas
# This function print a pass string into the function    
def printme( str ):
       "This prints a passed string into this function"
       print str
       return 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T19:09:23.300

不要备份；无论如何都要记录评论，直到你打到另一行。如果它不是`def`一行，则丢弃收集的评论：

```
comments = []
for (counter, line) in enumerate(visible_texts):
    if line.lstrip().startswith('#'):
        comments.append(line)
    elif "def" in line and not infunction:
        comment = '\n'.join(comments)
        comments = []
        # rest of your code
    else:
        comments = [] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:44:00.440

您可以使用该[`ast`](http://docs.python.org/2/library/ast.html)模块来[解析](http://docs.python.org/2/library/ast.html#ast.parse)python 代码。

您应该养成使用[文档字符串](http://www.python.org/dev/peps/pep-0257/)而不是注释来描述函数的习惯。

优点之一是该[`ast`](http://docs.python.org/2/library/ast.html)模块可以使用[`ast.get_docstring()`](http://docs.python.org/2/library/ast.html#ast.get_docstring).

# image - HTML Canvas 与图像内存使用

> ID：14005661
> 
> 赞同：3
> 
> 时间：2012-12-22T19:03:58.687
> 
> 标签：image, memory, html5-canvas

如果我通过以下方式创建画布元素：

```
var canvas = document.createElement('canvas'); 
```

然后吸引它。然后，如果我保留对该画布的引用，是否会比将画布内容转换为数据 url 并使用该数据创建图像元素并释放对画布的引用使用更多的内存？

哪个内存消耗少？画布元素或图像元素，具有相同图像数据的相同尺寸？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T21:33:16.047

Using this html test page:

```
<html>
    <head>
        <script type="text/javascript">
            window.onload = function () {
                var c = document.getElementById("canvas");
                var ctx = c.getContext("2d");
                var img = new Image;
                img.src = "http://blog.buzzbuzzhome.com/wp-content/uploads/2012/06/Canadian-Flag-canada-729711_1280_1024.jpg";
                ctx.drawImage(img, 0, 0);
            }
        </script>
    </head>
    <body>
        <canvas id="canvas" width="1280" height="1024"></canvas>
        <img src="http://blog.buzzbuzzhome.com/wp-content/uploads/2012/06/Canadian-Flag-canada-729711_1280_1024.jpg">
    </body>
</html> 
```

The memory output from a Google Chrome profile snapshot is as follows:

![Google Chrome -> Developer Tools -> Profiles -> Take Head Snapshot -> Class Filter:HTML](../Images/fdc7884d5da7fafe1383a579a50f7317.png)

Google Chrome -> Developer Tools -> Profiles -> Take Head Snapshot -> Class Filter:HTML

The canvas has a smaller retained size (132 to 152 of the img), but a look into what's left over from rendering the image reveals more:

![Class Filter:canvas](../Images/d0654f65c42fa674acd642669aab414d.png)

Class Filter:canvas

IMHO you're going to pay an overhead for rendering to the canvas in most major browsers.

Whether the mess gets cleaned up when your reference is released and your final memory usage is lower is anyone's guess.

I realize I didn't do it strictly the way you intended, but I felt a side by side comparison would give you some idea what's involved.

I suppose if loading the image via canvas is the only way to go, perhaps you're performing some manipulation before outputting the final result, then leaving it in the canvas and attempting to nullify all references for garbage collection will be slightly less expensive for the client.

This test was only done in Google Chrome and I cannot verify anything for other browsers.

Try it yourself!

# php - PHP MCRYPT 不断抛出模块初始化失败警告

> ID：14005669
> 
> 赞同：8
> 
> 时间：2012-12-22T19:04:57.680
> 
> 标签：php, encryption, mcrypt

每次我尝试运行 m_decrypt 时，都会抛出以下错误：

```
Warning: mcrypt_get_key_size(): Module initialization failed in /var/www/milo/system/encryption/common.php on line 51 Warning: mcrypt_get_block_size(): Module initialization failed in /var/www/milo/system/encryption/common.php on line 54 Warning: mcrypt_decrypt(): Module initialization failed in /var/www/milo/system/encryption/common.php on line 55 
```

以下是驱动这一切的代码：

```
class encrpt
{
    protected $data;
    protected $key = "JUST A KEY";
    protected $cipher = "MCRYPT_SERPENT_256";
    protected $mode = "MCRYPT_MODE_CBC";

    public function m_encrypt($data)
    {
        return (string) 
         base64_encode(
          mcrypt_encrypt(
           $this->cipher,
           substr(md5($this->key),0,mcrypt_get_key_size($this->cipher, $this->mode)),
           $data,
           $this->mode,
           substr(md5($this->key),0,mcrypt_get_block_size($this->cipher, $this->mode))
          )
         );
    }

    public function m_decrypt($data)
    {
        return (string)
          mcrypt_decrypt(
           $this->cipher,
           substr(md5($this->key),0,mcrypt_get_key_size($this->cipher, $this->mode)),
           base64_decode($data),
           $this->mode,
           substr(md5($this->key),0,mcrypt_get_block_size($this->cipher, $this->mode))
          );
    }
} 
```

我不知道我错过了什么。我的 php-mcrypt 模块是否损坏或缺少依赖项？我在 PHP 5.3 上运行

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-03-26T04:42:27.910

```
protected $cipher = MCRYPT_SERPENT_256;
protected $mode = MCRYPT_MODE_CBC; 
```

这些是常量 - 不要使用引号。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-22T19:26:12.023

好的解决了。我输入错误的常量。我改变了我班级的变量，如下所示：

```
protected $cipher = "rijndael-256";
protected $mode = "cbc"; 
```

希望这可以帮助人们在路上不要猛烈抨击他们的大脑！！

# bash - Bash 解释器更改参数顺序

> ID：14005673
> 
> 赞同：0
> 
> 时间：2012-12-22T19:05:22.440
> 
> 标签：bash, arguments

我有 bash 脚本并尝试在其中运行命令

没关系

```
echo ${something:="zip -r -q $TAG -P $PASS $LOCPATH"}
>zip -r -q evolution -P evolution ~/.gconf/apps/evolution 
```

那也没关系

```
zip -r -q evolution -P evolution ~/.gconf/apps/evolution 
```

但是这里的 order 仅在传递值并添加了奇怪时才更改。-一世

```
zip -r -q $TAG -P $PASS $LOCPATH
>zip error: Nothing to do! (try: zip -r -q -P evolution evolution . -i ~/.gconf/apps/evolution 
```

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T20:15:07.187

BASH 常见问题解答条目 #50：[“我正在尝试将命令放入变量中，但复杂的情况总是失败！”](http://mywiki.wooledge.org/BashFAQ/050)

```
something=(zip -r -q "$TAG" -P "$PASS" "$LOCPATH")
"${something[@]}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:09:23.350

尝试做`type zip`，似乎它的别名。

也许把完整的路径`zip`覆盖这个，比如：

```
/usr/bin/zip 
```

# css - 段落在 div 之外流动

> ID：14005675
> 
> 赞同：2
> 
> 时间：2012-12-22T19:05:35.203
> 
> 标签：css, html, alignment, footer

我正在尝试按此处所述制作页脚：http: [//css-tricks.com/left-align-and-right-align-text-on-the-same-line/](http://css-tricks.com/left-align-and-right-align-text-on-the-same-line/)

问题是 2 段被放置在页脚下方，就好像它们没有在 div 中定义一样。这是我的代码：

```
<div id="footer" style="clear: both;">
  <p class="alignleft">left</p>
  <p class="alignright">right</p>
</div> 
```

CSS：

```
div#footer{
    height: 20px;
    padding: 0px 10px;
    line-height: 20px;
    clear: both;
}
.alignleft {
    float: left;
}
.alignright {
    float: right;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T19:07:34.483

`overflow: hidden;`在容器上使用`div`以清除浮动，不要使用`height`

[**演示**](http://jsfiddle.net/pQjPL/)

CSS

```
div#footer {
   padding: 0px 10px;
   line-height: 20px;
   overflow: hidden;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-28T11:31:01.240

高度值应该是自动的

CSS

```
#footer{
   height: auto;
   padding: 0px 10px;
   line-height: 20px;
   **word-wrap: break-word;**
} 
```

# javascript - WebSQL 返回对象

> ID：14005679
> 
> 赞同：0
> 
> 时间：2012-12-22T19:05:45.607
> 
> 标签：javascript, sql, database

有人可以向我展示一个 Web SQL 选择查询，该查询将结果作为对象返回，而不是向控制台发出警报或记录。

我想集中我的选择查询，而不是在特定函数中重复选择/执行和处理结果代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T02:02:38.823

如果我们假设该问题与 Web SQL 下执行查询和获取结果集所需的 API 有关，您可以如下所示继续。我没有提供太多细节，因为这个问题有点模糊，几乎没有家庭作业的证据......

1.  在一个打开的数据库上启动一个 readTransaction（你确实说“查询”，所以我假设“选择”）：

    db.readTransaction(onStartTransaction); // 使用 readTransaction 减少锁定开销

onStartTransaction 函数如下所示：

```
function onStartTransaction(tx) {
        tx.executeSql(sql, params, onExecuteSqlOk, onExecuteSqlFail);
    } 
```

如果您不需要任何参数，只需传递您的 sql 和 [] 作为参数。

您的结果将返回到您的“onExecuteSqlOk”函数：

```
function onExecuteSqlOk(tx, result) {
        //
        // tx: an SqlTransaction object
        // results: an SqlResultSet object
        // 
```

好东西在 SqlResultSet 对象中。

它具有具有“行”属性的结构。每行包含在 sql select 语句中指定的字段。

```
var len = results.rows.length; // how many rows did we get
var firstRow = results.rows.item(0); 
```

因此，您从 Web Sql 查询中得到一个“对象”作为结果。请注意，显示的 api 是异步的，因此您可能需要使用进一步的回调函数....

# iis - 了解 401 的基本身份验证

> ID：14005680
> 
> 赞同：1
> 
> 时间：2012-12-22T19:05:46.703
> 
> 标签：iis, http-headers, wcf-data-services, basic-authentication, http-status-code-401

关于网络浏览器的基本身份验证，我有点困惑。我原以为 Web 浏览器只会在上一个响应中收到 HTTP 401 状态后才发送 Authorization 标头。但是，Chrome 似乎在此后的每个请求中都发送了 Authorization 标头。它包含我曾经输入的数据，以响应我网站上的 401，并与每条消息一起发送（根据 Chrome 和我的网络服务器附带的开发人员工具）。这是预期的行为吗？是否有一些我应该与我的 401 一起使用的标头来推断授权内容不应该被缓存？我目前正在使用 WWW-Authenticate 标头。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T19:22:31.260

[这是RFC 2617（第 2 节）](http://www.ietf.org/rfc/rfc2617.txt)中定义的浏览器的预期行为：

```
A client SHOULD assume that all paths at or deeper than the depth of
the last symbolic element in the path field of the Request-URI also
are within the protection space specified by the Basic realm value of
the current challenge. A client MAY preemptively send the
corresponding Authorization header with requests for resources in
that space without receipt of another challenge from the server.
Similarly, when a client sends a request to a proxy, it may reuse a
userid and password in the Proxy-Authorization header field without
receiving another challenge from the proxy server. See section 4 for
security considerations associated with Basic authentication. 
```

据我所知，基本 HTTP 身份验证无法执行注销/重新身份验证。这与 HTTP 基本身份验证缺乏安全性一起，是大多数网站现在使用表单和 cookie 进行身份验证解决方案的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T19:22:07.617

来自[RFC 2617](https://www.rfc-editor.org/rfc/rfc2617#page-4)：

> 如果先前的请求已被授权，则相同的凭证可以在由身份验证方案、参数和/或用户偏好确定的时间段内用于该保护空间内的所有其他请求。

根据我的经验，浏览器会自动为后续请求发送基本凭据是很常见的。它可以避免为额外的资源进行额外的往返。

# c# - XmlElement HasChildNodes 属性定义

> ID：14005688
> 
> 赞同：1
> 
> 时间：2012-12-22T19:06:40.967
> 
> 标签：c#, .net, xml, xmldocument

假设您有以下 XML 结构：

```
<Class>
       <Worker>
              <Name> Dan </Name>
              <Phone> 123 </Phone> 
                <Class>
                     <Address>
                        <Street> yellow brick road </Street>
                        <Zip Code> 123456 </Zip Code>
                     </Address>
                </Class>
         </Worker>
 </Class> 
```

使用`XMLElement`，我的问题是元素的`HasChildNodes`属性`<Name>`返回 true，而我希望它返回 false。

`HasChildNodes`根据我的定义应该是这样的：`<Worker>`也有孩子，`<Address>`但是没有孩子，他们有一个价值。 `<Street>``<Name>`

我如何区分这些情况？是否有另一个具有我期望的行为的属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:57:35.550

这是因为元素内部的“Dan”值`Name`被视为子节点。

也许你可以测试一下独生子女是否`XMLElement`有`XMLText`孩子，或者是否没有`XMLElement`孩子？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:58:43.793

在 DOM 术语中，字符内容表示为*文本节点*，因此只有完全空的元素节点（`<foo/>`或`<bar></bar>`）才会没有子节点。您必须检查所有子节点以查看它们是否为`XMLElement`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-03T10:57:46.327

这是 vb.net 中的代码，用于检查节点是否实际上具有 xml 子元素

```
Function hasXmlChildElements(ByVal node As XmlNode) As Boolean
            If node.HasChildNodes AndAlso node.ChildNodes.Count = 1 AndAlso node.FirstChild.GetType.Name.ToUpper = "XMLTEXT" Then
                Return False
            End If
            Return node.HasChildNodes
    End Function 
```

# iphone - Facebook iOS SDK 戳

> ID：14005689
> 
> 赞同：1
> 
> 时间：2012-12-22T19:06:43.190
> 
> 标签：iphone, ios, facebook, facebook-graph-api

是否可以使用 iOS 版 Facebook SDK“戳”Facebook 朋友？我玩弄了在线 API 资源管理器并筛选了文档，但找不到公共 API。

有谁知道我可以通过我的 iOS 应用程序来戳 Facebook 朋友的 Graph API 请求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T05:25:58.927

不，不能通过 iOS 的图形 API 或 SDK 戳 Facebook 朋友。我也在为我的应用程序寻找这个功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T03:37:45.443

不，Facebook SDK 中还没有公开的 Poke API。

# c - TCP 套接字 C 上的负数

> ID：14005693
> 
> 赞同：1
> 
> 时间：2012-12-22T19:07:29.140
> 
> 标签：c, sockets, tcp

每当我尝试通过 TCP 套接字发送一个负数时，当我打印收到的内容时，它会显示“4.29497e+09”。我正在做的就是这样：

```
int i = -8;
int temp = htonl(i);
write(sock,&temp,4); 
```

在服务器上：

```
int temp;
read(sock, &temp,4);
int read = ntohl(temp);
cout << read << endl; 
```

如果有人可以提供帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T19:22:33.150

/函数专门用于无符号 32 位整数`htonl`。`ntohl`

> 该`htonl()`函数将**无符号**整数`hostlong`从主机字节顺序转换为网络字节顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:10:13.283

通过套接字传输数据时，您不需要将其转换为网络字节序。此函数用于转换地址，而不是实际数据。这些函数适用于无符号整数，因此它们与您的参数（有符号整数）不匹配

**你需要省略它们。**

如果第二台机器使用不同的字节序，这种情况很少见（8086 和 ARM 架构都使用小字节序），则在读取整数和短字节时需要交换字节。这通常在接收套接字上完成。

# html - 我可以在 Google Drive 虚拟主机中使用 google 字体吗？

> ID：14005695
> 
> 赞同：5
> 
> 时间：2012-12-22T19:07:47.697
> 
> 标签：html, google-drive-api

我很想在托管在 Google Drive 公用文件夹中的网页中尝试 Google 字体 - 但字体没有显示 - 是否有在 Google Drive 中使用它们的技术或是否受到限制？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-06T12:23:25.030

我找到了一种通过创建指向 Google 字体 API 的安全链接来为自己使用 Google Web 字体的技术 - 将 http 更改为 https，如下所示：

```
<link href='https://fonts.googleapis.com/css?family=Francois+One' rel='stylesheet' type='text/css' /> 
```

你应该会发现这行得通！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-23T18:40:36.040

无论出于何种原因，Google Drive 网络托管都不喜欢链接到外部 CSS。不知道如何解决它，但我通过手动将谷歌字体 css 代码添加到我的 css 文件中解决了这个问题。例如：

打开他们给你的 HTML 代码的链接，你会看到一些 CSS 代码：

的HTML：

```
<link href='http://fonts.googleapis.com/css?family=Francois+One' rel='stylesheet' type='text/css' /> 
```

链接指向的 CSS：

```
@font-face {
  font-family: 'Francois One';
  font-style: normal;
  font-weight: 400;
  src: local('Francois One Regular'), local('FrancoisOne-Regular'), url(http://themes.googleusercontent.com/static/fonts/francoisone/v6/bYbkq2nU2TSx4SwFbz5sCHhCUOGz7vYGh680lGh-uXM.woff) format('woff');
} 
```

如果您将该 css 代码直接复制到您的 css 文件中，您的字体将显示在 Google Drive 托管站点中。如果您没有单独的 css 文件，您可以将 css 直接嵌入到您的 html 代码中，如下所示：

```
<style media="screen" type="text/css">
  @font-face {
    font-family: 'Francois One';
    font-style: normal;
    font-weight: 400;
    src: local('Francois One Regular'), local('FrancoisOne-Regular'), url(http://themes.googleusercontent.com/static/fonts/francoisone/v6/bYbkq2nU2TSx4SwFbz5sCHhCUOGz7vYGh680lGh-uXM.woff) format('woff');
  }
</style> 
```

# php - 与 $.ajax (JQuery) 相比，使用 XMLHttpRequest 有什么优势吗？

> ID：14005700
> 
> 赞同：0
> 
> 时间：2012-12-22T19:08:26.310
> 
> 标签：php, jquery, ajax, xmlhttprequest

我知道 $.ajax 正在使用 XMLHttpRequest 来完成相同的任务，并且在速度方面略有不同，我也意识到 XHR 可以根据我的要求量身定制，但我对功能表示怀疑。

基本上我想知道 $.ajax 是否可以完成 XHR 可以完成的所有事情，或者以某种方式超越 XHR。

如果 XHR 与 $.ajax 相比没有任何优势，我应该尝试理解所有 Http 标头请求还是只对 $.ajax 感到满意？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:09:54.427

的优点`XMLHttpRequest`是它不需要 jQuery。

如果您已经在使用 jQuery，那么`$.ajax`可能是您最好的选择 - 它会给您一些`XMLHttpRequest`不提供的简单性，而不会产生任何真正的重大开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:14:41.097

有一些东西`$.ajax`没有内置功能（比如中止请求），但`$.ajax`实际上返回 XMLHttpRequest 对象，它允许您[直接访问和操作它](https://stackoverflow.com/questions/446594/abort-ajax-requests-using-jquery)。

因为 jQuery 只是扩展了 XMLHttpRequest，所以我想不到 XMLHttpRequest 可以做的事情你也不能用 jQuery 扩展来完成。

# java - 为什么这个引用为空？

> ID：14005705
> 
> 赞同：-2
> 
> 时间：2012-12-22T19:09:21.337
> 
> 标签：java

以下代码来自 Bates 和 Sierra：

```
public class Book {
    private String title; // instance reference variable

    public String getTitle() {
       return title;
    }

    public static void main(String [] args) {
       Book b = new Book();
       String s = b.getTitle(); // Compiles and runs
       String t = s.toLowerCase(); // Runtime Exception!
    }
} 
```

为什么不会`String t = s.toLowerCase()`导致运行时异常`String s = b.getTitle()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:11:58.330

这很简单：对 Book 的 b 引用不为空，但您从未为 title 赋值。它是空的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T19:11:19.123

因为标题从来没有被赋予任何价值。非原始实例字段，例如`title`，默认值为`null`。所以当你说`b.getTitle()`，那返回`null`。然后`s`是`null`，当您尝试取消引用时`null`，即在其上使用`.`运算符时，您会得到 NullPointerException。尝试：

```
Book b = new Book(); // b is now a Book object with a null title
b.title = "Programming Java"; // b's title is now a String instead of null
String s = b.getTitle(); // s is now the title that we added to the book
String t = s.toLowerCase(); // t is now the same title in lower case 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-22T19:11:47.393

Null 引用可以根据需要多次传递，NPE**只会**在您想对引用进行实际操作时发生。为了避免 NPE，请执行以下操作

```
private String title = ""; // instance reference variable 
```

这样，您的`title`var 将不会`null`在创建 Book Object 时出现

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T19:11:32.013

`new Book()`将制作一个带有 null title 的 book 实例`private String title;`。

当您尝试时`String t = s.toLowerCase();`s 为空，因此结果

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T19:11:52.667

**java中的**对象**`null`获取as `default value`，**String**是一个`object`因此如果没有初始化它将是**null**。**

 **> 为什么 String t = s.toLowerCase() 会导致运行时异常，而 String s = b.getTitle() 不会？

好吧，`b`已初始化，因此在调用其方法时它不会**抛出 NPE**，但是`b.getTitle()`会返回未初始化，因此当您在 s 上调用时会得到`null`（这是 null）。`title``NPE``toLowerCase()`

```
String s = b.getTitle(); ---> s=null;
String t= s.toLowerCase(); ---> t= null.toLowerCase();
Throws NPE; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-22T19:12:25.560

`b`是一个有效的初始化`Book`对象。但是没有定义标题。所以`b.getTitle()`返回`null`。随着`s.toLowerCase()`您尝试执行`null`导致 NullPointerException 的方法。

您可以通过给 title 一个默认值来避免这种情况：

```
private String title = "default title.."; 
```**

# c# - 优化字符串中的字符计数

> ID：14005710
> 
> 赞同：1
> 
> 时间：2012-12-22T19:09:28.187
> 
> 标签：c#, string, performance, character

我刚刚创建了一个简单的方法来计算字符串中每个字符的出现次数，而不考虑大写。

```
static List<int> charactercount(string input)
        {
            char[] characters = "abcdefghijklmnopqrstuvwxyz".ToCharArray();
            input = input.ToLower();

            List<int> counts = new List<int>();
            foreach (char c in characters)
            {
                int count = 0;
                foreach (char c2 in input) if (c2 == c)
                    {
                        count++;
                    }

                counts.Add(count);
             }

            return counts;

        } 
```

有没有更简洁的方法来做到这一点（即不创建一个字符数组来保存字母表中的每个字符），它也会考虑到数字、其他字符、大写字母等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:33:22.377

从概念上讲，我更愿意返回`Dictionary<string,int>`计数。我假设可以通过省略而不是显式计数 0 来知道一个字符出现零次，您可以通过 LINQ 做到这一点。@Oded 为您提供了如何做到这一点的良好开端。您需要做的就是将 替换`Select()`为`ToDictionary( k => k.Key, v => v.Count() )`。请参阅我对他关于进行不区分大小写分组的回答的评论。注意：你应该决定你是否关心字符的文化差异，并`ToLower`相应地调整方法。

您也可以在没有 LINQ 的情况下执行此操作；

```
public static Dictionary<string,int> CountCharacters(string input)
{
     var counts = new Dictionary<char,int>(StringComparer.OrdinalIgnoreCase);

     foreach (var c in input)
     {
          int count = 0;
          if (counts.ContainsKey(c))
          {
              count = counts[c];
          }
          counts[c] = counts + 1;
     }

     return counts;
} 
```

请注意，如果您想要一个`Dictionary<char,int>`，您可以通过创建一个不区分大小写的字符比较器并将其用作`IEqualityComparer<T>`所需类型的字典来轻松做到这一点。为了简单起见，我`string`在示例中使用了它。

同样，调整比较器的类型以与您想要处理文化的方式保持一致。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:12:38.120

使用`GroupBy`和`Select`：

```
aString.GroupBy(c => c).Select(g => new { Character = g.Key, Num = g.Count() }) 
```

返回的匿名类型列表将包含每个字符以及它在字符串中出现的次数。

然后，您可以使用定义的静态方法以任何您希望的方式过滤它`Char`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T19:36:23.767

您的代码有点慢，因为您正在循环范围 az 而不是仅循环输入。

如果您只需要计算字母（如您的代码所示），那么最快的方法是：

```
int[] CountCharacters(string text)
{
    var counts = new int[26];

    for (var i = 0; i < text.Length; i++)
    {
        var charIndex - text[index] - (int)'a';
        counts[charIndex] = counts[charindex] + 1;
    }

    return counts;
} 
```

请注意，您需要添加一些内容，例如验证字符是否在范围内，并在需要时将其转换为小写，否则此代码可能会引发异常。我会把这些留给你补充。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T20:28:57.993

基于 +Ran 对避免的回答`IndexOutOfRangeException`：

```
static readonly int differ = 'a';
int[] CountCharacters(string text) {
    text = text.ToLower();
    var counts = new int[26];

    for (var i = 0; i < text.Length; i++) {
        var charIndex = text[i] - differ;
        // to counting chars between 'a' and 'z' we have to do this:
        if(charIndex >= 0 && charIndex < 26)
            counts[charIndex] += 1;
    }
    return counts;
} 
```

实际上，使用`Dictionary`和/或`LINQ`在计算字符和使用低级数组时不够优化。

# c# - Excel 文件无法保存

> ID：14005715
> 
> 赞同：0
> 
> 时间：2012-12-22T19:10:03.703
> 
> 标签：c#, export-to-excel

打开并更改 Excel 文件后，我尝试使用以下方法保存它：

> excelApp.ActiveWorkbook.Save();

但是数据似乎没有保存。

```
 private void ExportResultsToExcel()
 {
     string fullFilename = Regex.Match(Path, @".*\\([^\\]+$)").Groups[1].Value;
     string fileName = fullFilename.Substring(0, fullFilename.Length - 5);
     var templatePath = Path.Replace(fileName, "SolutionTemplate");
     var solutionPath = Path.Replace(fileName, fileName+"_Solution");
     System.IO.File.Copy(templatePath, solutionPath);

     var excelApp = new Excel.Application();
     var workbooks = excelApp.Workbooks;
     var workbook = workbooks.Open(solutionPath, 0, true, 5, "", "", true,
                                            XlPlatform.xlWindows, "\t", false,
                                            false, 0, true, 1, 0);
     var workSheets = workbook.Worksheets;
     var workSheet = (Worksheet) workSheets.Item[1];
     var rowIndex = 2;
     excelApp.DisplayAlerts = false;
     excelApp.ScreenUpdating = false;
     excelApp.Visible = false;
     excelApp.UserControl = false;
     excelApp.Interactive = false;
     foreach (var product in DemandData.Keys)
     {
         workSheet.Cells[rowIndex, 1] = product;
         workSheet.Cells[rowIndex, 2] = Result[product][0];
         workSheet.Cells[rowIndex, 3] = Result[product][1];
         workSheet.Cells[rowIndex, 4] = Result[product][2];
         workSheet.Cells[rowIndex, 5] = Result[product][3];
         workSheet.Cells[rowIndex, 6] = Result[product][4];
         workSheet.Cells[rowIndex, 7] = Result[product][5];
         workSheet.Cells[rowIndex, 8] = Result[product][6];
         workSheet.Cells[rowIndex, 9] = Result[product][7];
         workSheet.Cells[rowIndex, 10] = Result[product][8];
         workSheet.Cells[rowIndex, 11] = Result[product][9];
         workSheet.Cells[rowIndex, 12] = Result[product][10];
         workSheet.Cells[rowIndex, 13] = Result[product][11];
         workSheet.Cells[rowIndex, 14] = Result[product][12];
         rowIndex++;
     }
     int hWnd = excelApp.Application.Hwnd;
     //workbook.Save();
     excelApp.ActiveWorkbook.Save();
     Marshal.ReleaseComObject(workSheets);
     Marshal.ReleaseComObject(workSheet);
     Marshal.ReleaseComObject(workbooks);
     Marshal.ReleaseComObject(workbook);
     workbook.Close();
     excelApp.Quit();
     TryKillProcessByMainWindowHwnd(hWnd);

 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:48:51.063

我相信我看到了您的问题..在您的 open() 方法中，您以只读方式打开它，您可以尝试以下更改

```
var workbook = workbooks.Open(solutionPath, 0, true, 5, "", "", true,
                                            XlPlatform.xlWindows, "\t", false,
                                            false, 0, true, 1, 0); 
```

到

```
var workbook = workbooks.Open(solutionPath, 0, false, 5, "", "", true,
                                            XlPlatform.xlWindows, "\t", false,
                                            false, 0, true, 1, 0); 
```

为Workbooks.Open方法的**ReadOnly参数传入****false** ，以便您以后可以使用 Workbook.Save 方法保存它。

 **其他建议是也将靠近这个位置

```
 workbook.Close();
 Marshal.ReleaseComObject(workSheets);
 Marshal.ReleaseComObject(workSheet);
 Marshal.ReleaseComObject(workbooks);
 Marshal.ReleaseComObject(workbook); 
```

查看 MSDN 中的 Marshal.ReleaseComObject ，您还可以在调用 4 个 Marshal.ReleaseComObject() 方法后将 objects = 设置为 null 以确保安全

Microsoft 参考[MarshalReleaseComObject](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.finalreleasecomobject.aspx)**

# javascript - 使用重定向规则的 Chrome 扩展“未捕获的错误：无效值”

> ID：14005725
> 
> 赞同：2
> 
> 时间：2012-12-22T19:10:52.470
> 
> 标签：javascript, google-chrome

我正在尝试编写一个扩展程序，当它检测到 chrome 请求音频文件时，它将下载音频文件。我这个项目是基于谷歌提供的“Download_links”和“catifier”两个样本的代码。这是我目前拥有的：

```
var RequestMatcher = chrome.declarativeWebRequest.RequestMatcher;
var IgnoreRules = chrome.declarativeWebRequest.IgnoreRules;
var RedirectRequest = chrome.declarativeWebRequest.RedirectRequest;
var songFileURL = "http://somefile.mp3";
...
function registerRules() {
    var redirectRule = {
    priority: 100,

    conditions: [
        new RequestMatcher({
            contentType: ['audio/mp3']
        }),
    ],

    actions: [
        chrome.downloads.download({url: songFileURL}),
    ]
};
... 
```

当我加载并尝试它时，我收到一个错误：`Uncaught Error: Invalid value for argument 1\. Property '.0': Value does not match any valid type choices.` 无论我尝试什么，我都无法弄清楚是什么导致了这个错误。总的来说，我对 Chrome 扩展和 JavaScript 相当满​​意，所以我确信这是一个简单的解决方法，但我无法弄清楚。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T21:52:27.700

我认为问题在于您指定了不受支持的操作。可以在[页面`chrome.declarativeWebRequest`上](http://developer.chrome.com/extensions/declarativeWebRequest.html#evaluation)找到可用操作的列表。

我认为您应该使用`chrome.webRequest.onBeforeRequest`,`onHeadersReceived`或`onComplete`来跟踪媒体链接并从那里启动自定义下载，可能以某种延迟的方式，因为我不确定`downloads`仅从另一个请求处理程序中工作。

首先，您可以查看 Google 的[CatBlock](https://developer.chrome.com/extensions/samples.html#12a7bf1490a26359eadf10917e37c5b9)示例，或其他[相关答案](https://stackoverflow.com/a/12162257/1102014)或[其他](https://stackoverflow.com/a/13571375/1102014)答案。基本上，您需要通过添加适当的事件处理程序`addListener`，并在处理程序调用`chrome.downloads.download({url: request.url})`中，其中将`request`作为输入参数传递给处理程序。

您应该根据自己的要求决定选择哪一个事件（例如，`onBeforeRequest`或）。`onComplete`据我了解，您不想阻止原始请求，因此等待原始下载完成，然后在处理程序中`onComplete`处理它可能很有用，这样 Chrome 就可以通过从缓存中复制已经下载的文件来优化该过程。

`{cancel: true}`作为替代方案，您可以通过从每个声音文件的处理程序返回来阻止初始下载`onBeforeRequest`，然后作为单个文件开始下载，可能`saveAs`涉及选项。

# mysql - MySQL - 查询语法

> ID：14005726
> 
> 赞同：2
> 
> 时间：2012-12-22T19:10:59.960
> 
> 标签：mysql, sql, join

我有 3 张桌子。

```
news:
id
title

categories:    
id
name

newsEachCategories:
postId
categoryId 
```

表 newsEachCategories 保存每个帖子的 id 和发布它的类别的 id。

因此，如果 id 为 13 的帖子已发布在类别 6 和 7 中，则有两个条目，一个是“postId 13 , categoryId 6”，另一个是“postId 13 , categoryId 7”。

因此，为了查找属于某个类别的所有帖子（例如 id 为 5 的类别），我使用：

```
SELECT news.title , news.editedTitle , news.id
FROM news JOIN newsEachCategories
ON news.id = newsEachCategories.postId
WHERE  newsEachCategories.categoryId = 5 
```

如果我想选择属于 5 类和 6 类的帖子，我应该如何对我的查询进行语法分析？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T19:15:40.770

要仅返回两个类别中都存在的结果，您可以使用`COUNT()`聚合并在您的`HAVING`子句中验证是否返回了 2 个结果。

在这个解决方案中，我加入了一个返回`COUNT()`per的子查询`postId`，并限制了这两个类别中的那些。这将连接回主表以获得您想要的特定列的剩余列`news.id`。

```
SELECT 
  news.title,
  news.editedTitle,
  news.id
FROM
  news
  /* Join against subquery to count occurrences in newsEachCategories */
  JOIN (
    SELECT postId, COUNT(DISTINCT categoryId) AS postcount 
    FROM newsEachCategories 
    /* Limit to categories 5 & 6 */
    WHERE categoryId IN (5, 6)
    GROUP BY postId
    /* Ensures a result was returned for each category 5, 6 */
    HAVING postcount = 2
  ) postCounts ON news.id = postCounts.postId 
```

# java - JTextArea 文本消失

> ID：14005730
> 
> 赞同：2
> 
> 时间：2012-12-22T19:11:23.890
> 
> 标签：java, swing, jtextarea

我正在为一个项目制作一个国际象棋程序。我正在尝试在棋盘的一侧添加一个移动历史记录框。移动历史运行正常，数据已正确发送到文本区域，但 JTextArea 内的文本在 AI 考虑他的移动时消失了。

```
public void aiMove(){
  if (!playing){ return; }
  paintImmediately(0,0,totalX,totalY);
  ai = eve.getMove(chess,wtm,aiOut);   //text disappears here
  chess.makeMove(ai);
  wtm = !wtm;
  humanMove = true;
  writeMove(ai);                   //updates move history, text reappears here
  playing = stillPlaying();
  repaint();
}

private void writeMove(Move move){
  char c = "abcdefgh".charAt(7-move.fromY);
  char h ="abcdefgh".charAt(7-move.toY);
  String s = Character.toString(c)+(move.fromX+1)+" - "+Character.toString(h)+(move.toX+1)+"  ";
  if (!wtm){
    String q = chess.getFullMove()+".  "+s+"  ";
    moves.setText(moves.getText()+q);
  }
  else {
    moves.setText(moves.getText()+s+"\n");
  }
} 
```

这是正在发生的事情的打印屏幕。 [http://s13.postimage.org/mh7hltfk7/JText_Area_disappear.png](http://s13.postimage.org/mh7hltfk7/JText_Area_disappear.png)

* * *

**已解决** 感谢所有回复。我改变了 aiMove() 所以它创建了一个线程。这就是我所做的。

尝试#3 ...摇摆对我来说仍然很陌生。我不想将 writeMove 更改为 getMove，否则我将不得不稍微重写人类的轮到。由于该项目基本上已经完成，我试图避免尽可能多的工作 :) 无论如何，GUI 完全是可选的，我只是为了好玩，并尝试学习一些摇摆。

```
public void aiMove(){
  if (!playing){ return; }
  if (!aiThread.isAlive()){
    aiThread = new Thread(){
      public void run(){
        ai = eve.getMove(chess,wtm,aiOut);
        chess.makeMove(ai);
        wtm = !wtm;
        humanMove = true;
        SwingUtilities.invokeLater(new Runnable(){
          public void run(){
            writeMove(ai);
          }
        });
        repaint();
        playing = stillPlaying();
      }
    };
    aiThread.start();
  }
} 
```

它还解决了我之前遇到的一个问题，如果我按住“a”键（强制 ai 移动），它会排队许多强制 ai 移动。现在这不会发生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T19:59:55.483

问题是您的 AI 思维是 CPU 密集型/耗时的，因此它被认为是一项*长期运行的任务*。您不应在 GUI 事件调度线程上执行*长时间运行的任务*，因为这会导致 UI 看起来冻结，因此仅在任务完成后才显示更新。

幸运的是，您可以使用 2 种不同的方法：

*   使用[Swing Worker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)，如教程所述：

> SwingWorker 子类可以定义一个方法 done，当后台任务完成时，该方法会在事件调度线程上自动调用。
> 
> SwingWorker 实现 java.util.concurrent.Future。该接口允许后台任务向其他线程提供返回值。此接口中的其他方法允许取消后台任务并发现后台任务是否已完成或已取消。
> 
> 后台任务可以通过调用 SwingWorker.publish 来提供中间结果，从而从事件调度线程调用 SwingWorker.process。
> 
> 后台任务可以定义绑定属性。对这些属性的更改会触发事件，从而在事件调度线程上调用事件处理方法。

*   `Thread`或者，为 AI 思维创建单独的并包含`setText`调用`SwingUtilities.invokeLater(...);`

    ```
    Thread t=new Thread(new Runnable() {
         @Override
         public void run() {
        }
    });
    t.start(); 
    ```

**更新**

阅读 MadProgrammers 评论（+1）后，请记住通过`SwingUtilities.invokeLater(..)`块在 EDT 上创建/操作您的 GUI/Swing 组件。你可以在[这里](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)阅读更多。

**更新 2：**

那个编辑违背了这一点，在块中对 EDT 的唯一调用`SwingUtilitites`应该是`setText`或至少唯一的代码来操作 Swing 组件，即

```
public void aiMove(){
  if (!playing){ return; } 
  if (!aiThread.isAlive()){  //originally initialized by constructor
    aiThread = new Thread(){
      public void run(){
            ai = eve.getMove(chess,wtm,aiOut);
            chess.makeMove(ai);
            wtm = !wtm;
            humanMove = true;
        SwingUtilities.invokeLater(new Runnable(){
          public void run(){
            writeMove(ai);
          }
        });
        repaint();
        playing = stillPlaying();
      }
    };
    aiThread.start();
  }
} 
```

# sql - 如何使用 SQL 命令文件创建 SQLite3 数据库文件？

> ID：14005731
> 
> 赞同：25
> 
> 时间：2012-12-22T19:11:24.140
> 
> 标签：sql, database, sqlite

我有一个包含一些 SQL 命令的文件，如下所示：

```
CREATE DATABASE IF NOT EXISTS `db_name`;
USE `db_name`;

CREATE TABLE IF NOT EXISTS `customers` (
  `id` int(10) unsigned NOT NULL,
  `f_name` varchar(50) DEFAULT NULL,
  `l_name` varchar(50) DEFAULT NULL,
  `company_name` varchar(200) DEFAULT NULL,
  `email` varchar(50) DEFAULT NULL,
  `phone` varchar(25) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `customers` (`id`, `f_name`, `l_name`, `company_name`, `email`, `phone`) VALUES
    ...
    ...
    ... 
```

我想使用这些命令创建一个 SQLite3 数据库文件，以便在 Python 中轻松使用它。

我如何在 Ubuntu 上做到这一点？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-12-22T19:29:26.347

这不是一个完整的 SQL 文件，它包含一堆特定于 MySQL 的东西，其中一些 SQLite 会接受，而另一些则不会。我们将从顶部开始。

您不需要`create database`或`use`使用 SQLite。如果要创建数据库，只需在`sqlite3`从命令行运行时为其命名：

```
$ sqlite3 db_name.sqlt < your_sql.sql 
```

如果`db_name.sqlt`存在则将使用它，如果它不存在则将创建它。所以`create database`和`use`是由你如何运行所暗示的`sqlite3`。根据 Python 想要看到的内容，您可能需要使用不同的扩展。

引用的反引号是 MySQL 主义，双引号是标识符的标准引用机制。幸运的是，SQLite 会接受它们，所以你可以不用管它们。

SQLite 不知道是什么`int(10) unsigned`意思，你必须`unsigned`在 SQLite 接受它之前删除它。SQLite 也不知道是什么`ENGINE=InnoDB DEFAULT CHARSET=utf8`意思，所以你也必须删除它。

您可能会遇到 MySQL 满意但 SQLite 不满意的其他事情。您必须尝试并修复它并尝试并修复它，直到它起作用为止。或者尝试找到一种可以为您在数据库之间进行转换的工具，我总是手工或使用一次性脚本来做这些事情，所以我不知道有什么工具可以帮助您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:36:48.347

基本上上面的命令是用于 mysql 或其他数据库的（其中大部分必须进行调整才能与 sqlite 一起使用。Sqlite 以文件的形式存储数据库。基本上，当你启动 sqlite 时，它​​会创建一个文件（如果不存在）。你可以通过键入来创建或打开数据库

```
sqlite3 db 
```

在命令行上。此语句创建或打开名为“db”的数据库

# file - 在 Java Web 应用程序中存储和访问资源文件的最佳实践

> ID：14005749
> 
> 赞同：8
> 
> 时间：2012-12-22T19:13:38.207
> 
> 标签：file, web-applications, servlets, war

我有一堆文本、xml 和其他文件（即资源），我需要在 java web 应用程序中使用 servlet 访问它们。例如，有一个 xml 文件，其中一部分是通过用户查询与 servlet 一起返回的。我正在使用Tomcat。存储这些文件并从 Java 代码访问它们的最佳实践是什么？1) 我应该将它们放在哪里的默认文件夹是什么，我需要将它们放入 Web 存档中还是放入其中一个罐子中？2）如何从java代码访问文件？如何设置它们的路径以便它可以在任何环境中工作？PS 我已经阅读了许多与此主题相关的帖子，其中大多数建议将资源存储在 jar 中并使用 java.lang.Class.getResourceAsStream(String) 访问它们。这似乎很奇怪，因为类和数据应该分开。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-22T20:35:27.597

使用类加载器加载静态资源非常好。例如，这就是 ResourceBundle 加载国际化属性文件的方式。

将它们`WEB-INF/classes`与您的类文件一起放入，或放入 jar 中`WEB-INF/lib`，并使用 ClassLoader 加载它们，如您已阅读的答案所示。

这并不禁止您将这些文件放置在与项目中的 Java 源文件不同的目录中。构建过程应该确保将它们放在适当的位置以供运行时使用。Maven 和 Gradle 约定是将源文件`src/main/java`放在`src/main/resources`.

# java - 如何修改默认绘图颜色lwjgl

> ID：14005750
> 
> 赞同：0
> 
> 时间：2012-12-22T19:13:40.973
> 
> 标签：java, graphics, 2d, lwjgl

好的，所以我通过 TheCodingUniverse 的一些教程开始学习 LWJGL，但我在绘制线条和四边形方面遇到了困难。

编码

```
package LWJGL_Learn;

import static org.lwjgl.opengl.GL11.*;
import org.lwjgl.opengl.*;
import org.lwjgl.*;

public class SimpleOGLRenderer {

    public SimpleOGLRenderer() {
        try {
            Display.setDisplayMode(new DisplayMode(640, 480));
            Display.setTitle("SimpleOGLRenderer");
            //Display.setInitialBackground(256, 256, 256);
            Display.create();
        } catch (LWJGLException e) {
            e.printStackTrace();
        }

        //OpenGL Initialization
        glMatrixMode(GL_PROJECTION); 
        glLoadIdentity();
        glOrtho(0, 640, 480, 0, 1, -1);
        glMatrixMode(GL_MODELVIEW);

        while (!Display.isCloseRequested()) {

            //Render Code'
            glBegin(GL_QUADS);
                glVertex2i(50, 50);
                glVertex2i(80, 70);
                glVertex2i(80, 130);
                glVertex2i(50, 300);
            glEnd();

            glBegin(GL_LINES);
                glVertex2i(100, 100);
                glVertex2i(200, 200);
            glEnd();

            GL11.glClear(GL11.GL_COLOR_BUFFER_BIT);
            Display.update();
            Display.sync(60);
        }
        Display.destroy();
        System.exit(0);
    }
    public static void main(String[] args) {
        new SimpleOGLRenderer();
    }
} 
```

[请参阅此视频](http://www.youtube.com/watch?v=cQAYMkzy9rQ&list=SP19F2453814E0E315)中大约 6:50 分钟，以了解代码应该是什么以及它应该做什么。

无论如何，问题是没有线或四边形出现。屏幕保持黑色。现在，我想可能是因为在黑色显示器上绘制了黑线，所以我修改了背景颜色（注释掉的线，像`.setInitialDisplay...`），但没有结果。颜色改变了，但屏幕保持白色，没有出现任何线条。你们中的任何人都知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:33:24.370

1) 默认颜色为白色，但您在执行 Display.update() 删除之前正在清除颜色缓冲区：

> GL11.glClear(GL11.GL_COLOR_BUFFER_BIT);

2）您没有使用视频中的坐标，就在 6:50 之前。

# wcf - 如何绑定端点？

> ID：14005751
> 
> 赞同：1
> 
> 时间：2012-12-22T19:13:49.330
> 
> 标签：wcf, wcf-binding

尽管有很多关于同一问题的帖子，但我仍然没有弄清楚如何解决有关端点的问题。

在解决方案中有几个项目，在阅读了类似问题后，我通过以下方式编辑了 StartUp Project 的 app.config 文件：

```
<system.serviceModel>
<services>
...
<service name="LiveGames.Engine.LoginService">
        <endpoint address="" name="ILoginService" binding="wsHttpBinding" contract="LiveGames.Entities.Interfaces.ILoginService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8732/LiveGames.Engine/LoginService/" />
          </baseAddresses>
        </host>
      </service>
    </services>
    <client>
      <endpoint address="http://localhost:8732/LiveGames.Engine/LoginService/"
          binding="wsHttpBinding" bindingConfiguration="WSHttpBinding_ILoginService" contract="LiveGames.Entities.Interfaces.ILoginService"
          name="ILoginService" kind="" endpointConfiguration="">
        <identity>
          <dns value="localhost" />
        </identity>
      </endpoint>
    </client>
  </system.serviceModel> 
```

我使用以下方法创建了 Proxy 类：

```
public ChannelFactory<T> GetFactory<T>(string serviceName, out T channel)
{
    ChannelFactory<T> factory = new ChannelFactory<T>(serviceName);
    channel = factory.CreateChannel();

    return factory;
}

public JSONUserLogin Login(string username, string password)
{

    JSONUserLogin retval = new JSONUserLogin();
    ILoginService sec = null;

    ChannelFactory<ILoginService> factory = null;

    try
    {
        using (factory = GetFactory<ILoginService>("ILoginService", out sec))
        {
            retval = sec.Login(username, password);
        }
        return retval;
    }
    catch (Exception ex)
    {
        return new JSONUserLogin();

    }
    finally
    {
        if (sec != null)
            ((IChannel)sec).Close();

        if (factory != null)
            factory.Close();
    }

} 
```

何时`serviceName="ILoginService"`以及执行是否成功`ChannelFactory<T> factory = new ChannelFactory<T>(serviceName);`

它抛出一个异常：

```
System.InvalidOperationException: Could not find endpoint element with name 'ILoginService' and contract 'LiveGames.Entities.Interfaces.ILoginService' in the ServiceModel client configuration section. This might be because no configuration file was found for your application, or because no endpoint element matching this name could be found in the client element. 
```

有谁知道这里可能出了什么问题以及如何解决问题？

# php - PHP 将多维数组排序为 cetegorized html 列表

> ID：14005752
> 
> 赞同：0
> 
> 时间：2012-12-22T19:13:54.717
> 
> 标签：php, multidimensional-array

我的数组是一个国家列表，确切地说是国家代码。

```
$nazioni = array(
    'all' => array(
        'ad','ae','af','ag','al','am','ao','ar','at','au','az','ba','bb','bd',
        'be','bf', etc... ...'zw',
    ),

    'europa' => array(
        'ad','al','am','at','az','ba','be','bg','by','ch','cy','cz','de','dk',
        'ee','es','fi','fr','gb','ge','gr','hr','hu','ie','is','it','kz','li',
        'lt','lu','lv','mc','md','me','mk','mt','nl','no','pl','pt','ro','rs',
        'ru','se','si','sk','sm','tr','ua','va',
    ),

    'asia' => array(
        'ae','af','am','az','bd','bh','bt','bn','cn','cy','ge','id','il','in',
        'iq','ir','jo','jp','kg','kh','kp','kr','kw','kz','la','lb','lk','mm',
        'mn','mv','my','np','om','ph','pk','ps','qa','ru','sa','sg','sy','th',
        'tj','tl','tm','tr','uz','vn','ye',
    ),

etc... 
```

这个包含大陆的列表还将包含地中海或中东等地区，这意味着值将在类别中重复。即使是基本的亚洲和欧洲类别也会包含重复值，我将使用每个值创建一个链接。

我在重新安排我的数组的放置方式方面非常灵活，但是甚至可以采用这样的列表并制作一个分类排列的列表，而不会产生重复值的开销吗？或者这个开销是如此之小以至于这不是问题？

目前我使用基本的 foreach 循环来安排它，如下所示：

```
 echo '<li>'.Lang::line('nations.europa')->get().'</li>';
    foreach($nazioni['europa'] as $n) {
        echo '<li>'.Filtra::uri(Lang::line('nations.'.$n)->get(), $uri, 1, $n).'</li>';
    } 
```

Filtra::uri 函数建立了一个链接，我使用 Laravel 框架中的 Lang::line 函数通过键值查找国家/地区。基本的。

我最终想要的是一个分类的链接列表。设计尚未最终确定，但到目前为止返回的 HTML 看起来有点像这样，我将把类别包装在一些东西中，以使其在稍后阶段更具交互性。也许使用 DL、DT 和 DD 标签或从中制作一个选项列表，但这不是重点。

```
<li>Europe</li>
<li><a href="http://example.ex/en/+Andorra">Andorra</a></li>
and same for all Europe countries...

<li>Asia</li>
<li><a href="http://example.ex/en/+United+Arab+Emirates">United Arab Emirates</a></li>
and same for all Asian countries...... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:29:02.807

> 甚至可以采用这样的列表并制作一个分类排列的列表，而不会产生重复值的开销吗？或者这个开销是如此之小以至于这不是问题？

开销非常小 - 在阅读您的代码时，做其他人（或未来的您）更容易理解的事情

# php - PHP 正则表达式问题 - preg_match 不返回任何结果

> ID：14005757
> 
> 赞同：0
> 
> 时间：2012-12-22T19:14:50.377
> 
> 标签：php, regex, preg-match, expression

我有一个名为 1.txt 的文件，我正在尝试在网站上显示它的部分。

我正在尝试显示两个关键字之间的特定部分。

该文件可以在这里看到：http: [//pastebin.com/GwVKhs8h](http://pastebin.com/GwVKhs8h)

我想在这些词之间显示文本：“（非特权）.pst”和“-----Original Message-----”所以它会返回：

如果您仍然需要曲线移位，请告诉我。

我正在使用以下代码：

```
<?php
$myFile = "1.txt";
$fh = fopen($myFile, 'r');
$theData = fread($fh, filesize($myFile));
fclose($fh);

if (preg_match("/\(Non-Privileged\)\.pst((\n|.)*)-----Original Message-----/", $theData, $matches1))
{
    echo $matches1[1]."<br />";
}
?> 
```

我尝试了几件事，但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:31:44.127

使用**爆炸**。

```
 $myFile = "1.txt";
    $fh = fopen($myFile, 'r');
    $theData = fread($fh, filesize($myFile));
    fclose($fh);

    $pairs = explode("(Non-Privileged).pst", $theData);
    $pairs = explode("-----Original Message-----", $pairs[1]); 
    $text  = $pairs[0]; 

    print $text; 
```

# php - GZIP 压缩 + htaccess 放气

> ID：14005758
> 
> 赞同：9
> 
> 时间：2012-12-22T19:14:56.770
> 
> 标签：php, compression, gzip, http-compression

我可以同时拥有 .htaccess 吗：

```
 DEFLATE 
```

在 php、图像、html 文件等 + php 标头上：

```
 ob_start("gzhandler") ? 
```

如果没有，最好的机会是什么？我只是担心它是否会发生冲突。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-22T19:25:35.727

对图像使用压缩通常是一个非常糟糕的主意，因为网络上大多数广泛使用的图像格式已经被压缩，所以你只会给文件增加不必要的开销。您通常希望对本质上是文本的资源（HTML、CSS、JavaScript 等）使用压缩，因为这些资源的压缩率非常高。

至于问题本身，据我所知，不可能同时使用两者`DEFLATE`，`GZIP`但老实说，因为我从来没有尝试过类似的事情，如果这些信息不正确，请多多包涵。

至于选择哪一个，我强烈建议您看看下面的帖子，您可以在其中看到两者的`DEFLATE`优缺点`GZIP`。

[为什么对 Apache 提供的文本文件使用 deflate 而不是 gzip？](https://stackoverflow.com/questions/388595/why-use-deflate-instead-of-gzip-for-text-files-served-by-apache)

我个人`DEFLATE`尽可能地使用它，因为它有时`.htaccess`比代码更容易实现。我也喜欢在测试或开发东西时快速禁用该功能的可能性。

Apache Server Configs 项目有一个非常全面的`.htaccess`文件，因此您可能想在**[此处](https://github.com/h5bp/server-configs-apache)**查看该项目。

现在，尽管该文件非常全面，但您可能只想使用正常情况下的场景配置，如下所示：

```
# -----------------------------------------------------------------------
# Defining MIME types to ensure the web server actually knows about them.
# -----------------------------------------------------------------------
<IfModule mod_mime.c>
    AddType application/javascript          js
    AddType application/vnd.ms-fontobject   eot
    AddType application/x-font-ttf          ttf ttc
    AddType font/opentype                   otf
    AddType application/x-font-woff         woff
    AddType image/svg+xml                   svg svgz 
    AddEncoding gzip                        svgz
</Ifmodule>

# -----------------------------------------------------------------------
# Compressing output.
# -----------------------------------------------------------------------
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/css application/json
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE text/xml application/xml text/x-component
    AddOutputFilterByType DEFLATE application/xhtml+xml application/rss+xml application/atom+xml
    AddOutputFilterByType DEFLATE image/x-icon image/svg+xml application/vnd.ms-fontobject application/x-font-ttf font/opentype
</Ifmodule> 
```

# html - 如何去除拼接图像之间的间距

> ID：14005763
> 
> 赞同：-2
> 
> 时间：2012-12-22T19:15:20.547
> 
> 标签：html, space

嘿，我在 Photoshop 中为电子邮件通讯制作了一张图片。我对图像进行了切片并添加了指向我想要单击的图像的链接，但是当我通过电子邮件发送它时，图像之间存在空格。如何删除空格？这是编码。

```
<html>
<head>
<title>email_template_1</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<!-- ImageReady Slices (email_template_1.psd) -->
<table id="Table_01" width="650" height="801" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td colspan="8">
            <img src="images/ttcc_01.jpg" width="650" height="65" alt=""></td>
    </tr>
    <tr>
        <td colspan="3" rowspan="2">
            <img src="images/ttcc_02.jpg" width="507" height="33" alt=""></td>
        <td rowspan="2">
            <valign=top align=left width=33><a href="http://ttchallenge.blogspot.com"><img src="images/ttcc_03.jpg" width="33" height="33" border="0" alt="Blog"></a></td>
  <td rowspan="2">
            <img src="images/ttcc_04.jpg" width="10" height="33" border="0" alt="space"></td>
        <td>
            <valign=top align=left width=33><a href="https://www.facebook.com/groups/217569431593349/"><img src="images/ttcc_05.jpg" width="33" height="32" border="0" alt="Facebook"></a></td>
        <td colspan="2" rowspan="2">
            <img src="images/ttcc_06.jpg" width="67" height="33" alt=""></td>
    </tr>
    <tr>
        <td>
            <img src="images/ttcc_07.jpg" width="33" height="1" alt=""></td>
    </tr>
    <tr>
        <td colspan="8">
            <img src="images/ttcc_08.jpg" width="650" height="25" alt=""></td>
    </tr>
    <tr>
        <td colspan="8">
            <img src="images/ttcc_09.jpg" width="650" height="162" alt=""></td>
    </tr>
    <tr>
        <td colspan="8">
            <img src="images/ttcc_10.jpg" width="650" height="347" alt=""></td>
    </tr>
    <tr>
        <td colspan="2">
            <img src="images/ttcc_11.jpg" width="504" height="1" alt=""></td>
        <td colspan="6">
            <img src="images/ttcc_12.jpg" width="146" height="1" alt=""></td>
    </tr>
    <tr>
        <td>
            <img src="images/ttcc_13.jpg" width="324" height="72" alt=""></td>
        <td colspan="6"><valign=top align=left width=280><a href="https://itunes.apple.com/us/app/take-the-challenge/id468178150?ls=1&mt=8"><img src="images/ttcc_14.jpg" algin="left" width="280" height="72" border="0" alt="Click Here for more Information!"></a></td>
<td>
            <img src="images/ttcc_15.jpg" align="left" width="46" height="72" border="0" alt=""></td>
  </tr>
    <tr>
        <td colspan="8">
            <img src="images/ttcc_16.jpg" width="650" height="95" alt=""></td>
    </tr>
    <tr>
        <td>
            <img src="images/spacer.gif" width="324" height="1" alt=""></td>
        <td>
            <img src="images/spacer.gif" width="180" height="1" alt=""></td>
        <td>
            <img src="images/spacer.gif" width="3" height="1" alt=""></td>
        <td>
            <img src="images/spacer.gif" width="33" height="1" alt=""></td>
        <td>
            <img src="images/spacer.gif" width="10" height="1" alt=""></td>
        <td>
            <img src="images/spacer.gif" width="33" height="1" alt=""></td>
        <td>
            <img src="images/spacer.gif" width="21" height="1" alt=""></td>
        <td>
            <img src="images/spacer.gif" width="46" height="1" alt=""></td>
    </tr>
</table>
<!-- End ImageReady Slices -->
</body>
</html> 
```

和网站文件：///Users/Dad/Dropbox/Apps/site44/ttc.site44.com/ttcc.html

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:24:52.397

由于您的 Photoshop 正在创建表格，而且表格很差，因此您遇到了不同的问题。我建议您将以下样式应用于您的表格：

```
#Table_01 {
  border-collapse: collapse:
} 
```

那应该可以解决问题。

但是，如果您不使用表格，您仍然可能遇到同样的问题。这是因为图像之间的空间是空白。它们发生是因为您的服务器没有优化 HTML 输出。这是一个问题的原因是因为图像和空间都可以被解释为具有 CSS 属性`display: inline`。（我知道有些浏览器不会对图像这样做，但是当他们这样做时，就会发生这种事情。）

我使用的解决方案是在重要时从标签之间去除所有空白。这是执行此操作的示例函数。

```
 function stripSpaceBetweenTags(container) {
            var rex = />\s+</gm;
            var htmlString = $(container).html();
            htmlString = htmlString.replace(rex,"><");
            $(container).html(htmlString)
    } 
```

`container`参数是一个字符串，可以用作有效的 jQuery 选择器。*发生的情况是，如果这些标签之间只有空格，*它会去除标签之间的所有空格（空格、制表符、换行符等）。这很重要：如果您有其他角色，您不希望它们被剥离。

将其视为*临时*优化器。您不必对整个页面执行此操作，如果您不这样做可能会更好。但是，如果您有一个容器可以容纳必须紧、紧、紧的图像，这是一个很好的解决方法。

# regex - Perl 正则表达式在 char 之前添加 char

> ID：14005766
> 
> 赞同：-2
> 
> 时间：2012-12-22T19:15:54.780
> 
> 标签：regex, perl

我需要帮助在特殊字符之前添加反斜杠。注意：我不能使用任何模块，所以我需要创建简单的脚本。

假设你有这样的行：

```
<link class="include" rel="stylesheet" type="text/css" href="../css/style.css" /> 
```

现在我想在任何 " 或其他特殊 Perl 字符之前添加 "\"，例如：

```
$%/!`| 
```

最后应该是：

```
<link class=\"include\" rel=\"stylesheet\" type=\"text/css\" href=\"../css/style.css\" /> 
```

我尝试使用：

```
$line =~ s/["%'\/{|}]+/\\$1/g; 
```

没用。

我应该使用什么正则表达式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:34:43.500

您期望特殊字符在`$1`. 为此，您需要使用`( )`

```
$line =~   s/ ( ["%'\/{|}] ) /\\$1/xg; 
```

请注意，我添加了一些间距和 //x 合格以使 ( ) 更加突出。

另一种方法是使用前瞻。

```
$line =~ s/(?= [%'\/{|}] ) /\\/xg; 
```

# haskell - Haskell，无法匹配预期的类型

> ID：14005770
> 
> 赞同：0
> 
> 时间：2012-12-22T19:16:31.380
> 
> 标签：haskell, types, match

我是 Haskell 的新手，我不知道出了什么问题。

```
data Stmt = If BExpr Stmt
      | While BExpr Stmt
      | Assign String AExpr
      deriving (Eq, Show)
printStmt :: Stmt -> String
printStmt (If e, s1)                = "if " ++ (printBExpr e) ++ " {" ++ (printStmt s1) ++ " }"
printStmt (While e, s)              = "while" ++ (printBExpr e) ++ "{" ++ (printStmt s) ++ "}"
printStmt (Assign s, e)             = s ++ ":=" ++ (printAExpr e) 
```

谁能告诉我这里出现“与预期类型不匹配”的错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T19:23:15.727

从模式中删除逗号：

```
printStmt :: Stmt -> String
printStmt (If e s1)         = "if " ++ (printBExpr e) ++ " {" ++ (printStmt s1) ++ " }"
printStmt (While e s)       = "while" ++ (printBExpr e) ++ "{" ++ (printStmt s) ++ "}"
printStmt (Assign s e)      = s ++ ":=" ++ (printAExpr e) 
```

`(If e, s1)`被解释为一对（双元组）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T19:23:43.660

假设您对`printBExpr`和的定义`printAExpr`没问题，您需要删除模式匹配中的逗号：

```
printStmt (If e s1)
printStmt (While e s)
printStmt (Assign s e) 
```

# c# - 使用 c#/asp.net 显示来自数据库的超链接列表

> ID：14005771
> 
> 赞同：3
> 
> 时间：2012-12-22T19:16:34.153
> 
> 标签：c#, asp.net

我是一个 asp.net / c# 新手，我正在尝试创建一个从我的数据库生成的非常简单的菜单。到目前为止，我已经设法将表从数据库中提取到数据表中，然后从那里提取到数组中。

我的问题是我还没有弄清楚如何在我的页面中循环使用数据（菜单根据用户类型而变化）。我尝试使用`<% =Array %>`，但我似乎无法在 while/for 循环甚至赋值行中使用它。

也许我以错误的方式攻击这个，我想我的问题基本上是这样的：如何在我的动态页面中使用从数据库（名称，url）收集的数据？

这是我当前的代码：

```
 public string[] keep = new string[100];
public void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        //Response.Write("response in postback");
        getMenu();
    }
}

void getMenu()
{
    Response.Write("response in getmenue");
    SqlConnection con = new SqlConnection();
    con.ConnectionString = "server=(local);database=PhilipsMaterials;Integrated Security=SSPI;";
    con.Open();
    DataSet ds = new DataSet();
    DataTable dt = new DataTable();
    string sql = "Select * from Materials";
    SqlDataAdapter da = new SqlDataAdapter(sql, con);
    da.Fill(ds);
    dt = ds.Tables[0];
    DataRow[] drowpar = dt.Select();
    int i = 0;
    foreach (DataRow dr in drowpar)
    {
        keep[i] = dr["Material Name"] as string;
        i = i + 1;
    }

    con.Close();

} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T19:30:50.547

您只需要使用像 gridview 或 repeater 这样的数据控件。然后您可以将数据集绑定到这些控件的数据源属性。从我的角度来看，中继器将是动态菜单的最佳数据控制。

这是中继器的标记

```
 <asp:Repeater ID="Rept" runat="server">
    <HeaderTemplate>
    <ul>
    </HeaderTemplate>
    <ItemTemplate>
    <li><a href='<%#Eval("url") %>'><%#Eval("names") %></a></li>
    </ItemTemplate>
    <FooterTemplate>
    </ul>
    </FooterTemplate> 
```

这是绑定数据集的代码

```
Rept.DataSource = ds;
Rept.DataBind(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:31:37.193

一种很好且清晰的方法，它也与 header 兼容，UpdatePanel 是在页面内使用 Literal 控件并在其上呈现您的菜单。

在页面中的某处放置文字：

```
<asp:Literal runat="server" ID="txtInfo" EnableViewState="false" /> 
```

然后使用 a 在数据后面的代码上呈现`StringBuilder`，然后将其放置在此 Literal 上，如下所示：

```
StringBuilder sbRenderOnMe = new StringBuilder();

sbRenderOnMe.Append("<br> Some Text");

txtInfo.Text = sbRenderOnMe.ToString(); 
```

例如，您的代码将是：

```
using(SqlConnection con = new SqlConnection())
{
  con.ConnectionString = "server=(local);database=PhilipsMaterials;Integrated Security=SSPI;";
  con.Open();
  DataSet ds = new DataSet();
  DataTable dt = new DataTable();
  string sql = "Select * from Materials";
  SqlDataAdapter da = new SqlDataAdapter(sql, con);
  da.Fill(ds);
  dt = ds.Tables[0];
  DataRow[] drowpar = dt.Select();

  StringBuilder sbRenderOnMe = new StringBuilder();
  foreach (DataRow dr in drowpar)
  {
     sbRenderOnMe.AppendFormat("Some Menu Names : {0}", dr["Material Name"]);
  }

  con.Close();
}

txtInfo.Text = sbRenderOnMe.ToString(); 
```

一些注意事项：不要使用`Response.Write`后面的代码中的特殊内容，因为您可能会在页面的第一个字节之前编写。直接写入输出 - 在您的`Response.Write`情况下，您赢得了创建一些数据并将它们放置在页面上的特定位置，`Response.Write`无法帮助，无法从后面的代码中处理，因为只是直接在页面上写入。

# php - 将控制器中定义的变量传递给 CodeIgniter 下的模型

> ID：14005772
> 
> 赞同：1
> 
> 时间：2012-12-22T19:16:38.727
> 
> 标签：php, class, codeigniter, parameter-passing, codeigniter-2

我在控制器内部的方法中定义了一个变量，例如

```
class test extends CI_Controller {
    function tester() {
    $variable = 'value'
    }
} 
```

现在我想在我的模型中调用这个变量。这怎么可能？

编辑：我使用 CodeIgniter。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:31:42.310

模型：

```
class your_model extends CI_Model {
    var $variable;

    function __construct() {
        parent::__construct();
    }

    function set_variable($variable) {
        $this->variable = $variable;
    }

} 
```

控制器：

```
class test extends CI_Controller {
    function tester() {
        $this->load->model('your_model');
        $variable = 'value'
        $this->your_model->set_variable($variable); 
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T01:22:07.937

仅供参考 - 如果您需要一个可用于控制器和/或模型中的多个方法的变量 - 您可以在类的“构造函数”中设置它。在变量名前使用**$this-> 。**

```
 class Test extends CI_Controller {

 public function __construct() {

 parent::__construct();

  // Set var in construct  
  $this->variable123 = 'some value 123' ;

} // end construct 
```

您现在可以从类中的任何位置调用 $this->variable123 并且它将可用。如果您从此类加载模型，则该模型中的任何方法都可以使用该模型。

# jquery - 使用带有 jquery ajax 的 ASP.NET MVC 验证？

> ID：14005773
> 
> 赞同：124
> 
> 时间：2012-12-22T19:16:41.433
> 
> 标签：jquery, ajax, asp.net-mvc, validation

我有这样的简单 ASP.NET MVC 操作：

```
public ActionResult Edit(EditPostViewModel data)
{

} 
```

具有`EditPostViewModel`如下验证属性：

```
[Display(Name = "...", Description = "...")]
[StringLength(100, MinimumLength = 3, ErrorMessage = "...")]
[Required()]
public string Title { get; set; } 
```

在视图中，我正在使用以下助手：

```
 @Html.LabelFor(Model => Model.EditPostViewModel.Title, true)

 @Html.TextBoxFor(Model => Model.EditPostViewModel.Title, 
                        new { @class = "tb1", @Style = "width:400px;" }) 
```

如果我在一个表单上提交，这个文本框被放置在一个验证中，将首先在客户端上完成，然后在 service( `ModelState.IsValid`) 上完成。

现在我有几个问题：

1.  这可以与 jQuery ajax 提交一起使用吗？我所做的只是删除表单，然后单击提交按钮，javascript 将收集数据，然后运行`$.ajax`​​.

2.  服务器端会`ModelState.IsValid`工作吗？

3.  如何将验证问题转发回客户端并将其呈现为好像我使用构建 int 验证（`@Html.ValidationSummary(true)`）？

Ajax 调用示例：

```
function SendPost(actionPath) {
    $.ajax({
        url: actionPath,
        type: 'POST',
        dataType: 'json',
        data:
        {
            Text: $('#EditPostViewModel_Text').val(),
            Title: $('#EditPostViewModel_Title').val() 
        },
        success: function (data) {
            alert('success');
        },
        error: function () {
            alert('error');
        }
    });
} 
```

编辑1：

包含在页面上：

```
<script src="/Scripts/jquery-1.7.1.min.js"></script>
<script src="/Scripts/jquery.validate.min.js"></script>
<script src="/Scripts/jquery.validate.unobtrusive.min.js"></script> 
```

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2012-12-31T21:20:01.503

# 客户端

使用该`jQuery.validate`库应该很容易设置。

在文件中指定以下设置`Web.config`：

```
<appSettings>
    <add key="ClientValidationEnabled" value="true"/> 
    <add key="UnobtrusiveJavaScriptEnabled" value="true"/> 
</appSettings> 
```

当你建立你的视图时，你会定义这样的事情：

```
@Html.LabelFor(Model => Model.EditPostViewModel.Title, true)
@Html.TextBoxFor(Model => Model.EditPostViewModel.Title, 
                                new { @class = "tb1", @Style = "width:400px;" })
@Html.ValidationMessageFor(Model => Model.EditPostViewModel.Title) 
```

***注意：****这些需要在表单元素中定义*

然后你需要包括以下库：

```
<script src='@Url.Content("~/Scripts/jquery.validate.js")' type='text/javascript'></script>
<script src='@Url.Content("~/Scripts/jquery.validate.unobtrusive.js")' type='text/javascript'></script> 
```

这应该能够为您设置客户端验证

## 资源

*   [http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvccustomvalidation_topic5.aspx](http://msdn.microsoft.com/en-us/vs2010trainingcourse_aspnetmvccustomvalidation_topic5.aspx)

# 服务器端

**注意：**这仅用于`jQuery.validation`库顶部的额外服务器端验证

也许这样的事情可以帮助：

```
[ValidateAjax]
public JsonResult Edit(EditPostViewModel data)
{
    //Save data
    return Json(new { Success = true } );
} 
```

其中`ValidateAjax`一个属性定义为：

```
public class ValidateAjaxAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        if (!filterContext.HttpContext.Request.IsAjaxRequest())
            return;

        var modelState = filterContext.Controller.ViewData.ModelState;
        if (!modelState.IsValid)
        {
            var errorModel = 
                    from x in modelState.Keys
                    where modelState[x].Errors.Count > 0
                    select new
                           {
                               key = x,
                               errors = modelState[x].Errors.
                                                      Select(y => y.ErrorMessage).
                                                      ToArray()
                           };
            filterContext.Result = new JsonResult()
                                       {
                                           Data = errorModel
                                       };
            filterContext.HttpContext.Response.StatusCode = 
                                                  (int) HttpStatusCode.BadRequest;
        }
    }
} 
```

它的作用是返回一个 JSON 对象，指定所有模型错误。

示例响应是

```
[{
    "key":"Name",
    "errors":["The Name field is required."]
},
{
    "key":"Description",
    "errors":["The Description field is required."]
}] 
```

这将返回给您调用的错误处理`$.ajax`回调

您可以遍历返回的数据以根据返回的键设置错误消息（我认为类似的东西`$('input[name="' + err.key + '"]')`会找到您的输入元素

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-12-27T21:33:44.433

您应该做的是序列化您的表单数据并将其发送到控制器操作。ASP.NET MVC 将使用 MVC 模型绑定功能将表单数据绑定到`EditPostViewModel`对象（您的操作方法参数）。

您可以在客户端验证您的表单，如果一切正常，将数据发送到服务器。该[`valid()`](https://jqueryvalidation.org/valid/)方法将派上用场。

```
$(function () {

    $("#yourSubmitButtonID").click(function (e) {

        e.preventDefault();
        var _this = $(this);
        var _form = _this.closest("form");

        var isvalid = _form .valid();  // Tells whether the form is valid

        if (isvalid)
        {           
           $.post(_form.attr("action"), _form.serialize(), function (data) {
              //check the result and do whatever you want
           })
        }

    });

}); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-05-24T09:24:07.473

这是一个相当简单的解决方案：

在控制器中，我们返回如下错误：

```
if (!ModelState.IsValid)
        {
            return Json(new { success = false, errors = ModelState.Values.SelectMany(x => x.Errors).Select(x => x.ErrorMessage).ToList() }, JsonRequestBehavior.AllowGet);
        } 
```

这是一些客户端脚本：

```
function displayValidationErrors(errors)
{
    var $ul = $('div.validation-summary-valid.text-danger > ul');

    $ul.empty();
    $.each(errors, function (idx, errorMessage) {
        $ul.append('<li>' + errorMessage + '</li>');
    });
} 
```

这就是我们通过ajax处理它的方式：

```
$.ajax({
    cache: false,
    async: true,
    type: "POST",
    url: form.attr('action'),
    data: form.serialize(),
    success: function (data) {
        var isSuccessful = (data['success']);

        if (isSuccessful) {
            $('#partial-container-steps').html(data['view']);
            initializePage();
        }
        else {
            var errors = data['errors'];

            displayValidationErrors(errors);
        }
    }
}); 
```

此外，我通过以下方式通过 ajax 渲染部分视图：

```
var view = this.RenderRazorViewToString(partialUrl, viewModel);
        return Json(new { success = true, view }, JsonRequestBehavior.AllowGet); 
```

RenderRazorViewToString 方法：

```
public string RenderRazorViewToString(string viewName, object model)
    {
        ViewData.Model = model;
        using (var sw = new StringWriter())
        {
            var viewResult = ViewEngines.Engines.FindPartialView(ControllerContext,
                                                                     viewName);
            var viewContext = new ViewContext(ControllerContext, viewResult.View,
                                         ViewData, TempData, sw);
            viewResult.View.Render(viewContext, sw);
            viewResult.ViewEngine.ReleaseView(ControllerContext, viewResult.View);
            return sw.GetStringBuilder().ToString();
        }
    } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-04-12T13:21:44.187

为@Andrew Burgess 提供的解决方案添加了更多逻辑。这是完整的解决方案：

创建了一个动作过滤器来获取 ajax 请求的错误：

```
public class ValidateAjaxAttribute : ActionFilterAttribute
    {
        public override void OnActionExecuting(ActionExecutingContext filterContext)
        {
            if (!filterContext.HttpContext.Request.IsAjaxRequest())
                return;

            var modelState = filterContext.Controller.ViewData.ModelState;
            if (!modelState.IsValid)
            {
                var errorModel =
                        from x in modelState.Keys
                        where modelState[x].Errors.Count > 0
                        select new
                        {
                            key = x,
                            errors = modelState[x].Errors.
                                                          Select(y => y.ErrorMessage).
                                                          ToArray()
                        };
                filterContext.Result = new JsonResult()
                {
                    Data = errorModel
                };
                filterContext.HttpContext.Response.StatusCode =
                                                      (int)HttpStatusCode.BadRequest;
            }
        }
    } 
```

将过滤器添加到我的控制器方法中：

```
[HttpPost]
// this line is important
[ValidateAjax]
public ActionResult AddUpdateData(MyModel model)
{
    return Json(new { status = (result == 1 ? true : false), message = message }, JsonRequestBehavior.AllowGet);
} 
```

为 jquery 验证添加了一个通用脚本：

```
function onAjaxFormError(data) {
    var form = this;
    var errorResponse = data.responseJSON;
    $.each(errorResponse, function (index, value) {
        // Element highlight
        var element = $(form).find('#' + value.key);
        element = element[0];
        highLightError(element, 'input-validation-error');

        // Error message
        var validationMessageElement = $('span[data-valmsg-for="' + value.key + '"]');
        validationMessageElement.removeClass('field-validation-valid');
        validationMessageElement.addClass('field-validation-error');
        validationMessageElement.text(value.errors[0]);
    });
}

$.validator.setDefaults({
            ignore: [],
            highlight: highLightError,
            unhighlight: unhighlightError
        });

var highLightError = function(element, errorClass) {
    element = $(element);
    element.addClass(errorClass);
}

var unhighLightError = function(element, errorClass) {
    element = $(element);
    element.removeClass(errorClass);
} 
```

最后将错误 javascript 方法添加到我的 Ajax Begin 表单中：

```
@model My.Model.MyModel
@using (Ajax.BeginForm("AddUpdateData", "Home", new AjaxOptions { HttpMethod = "POST", OnFailure="onAjaxFormError" }))
{
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-22T20:20:05.283

你可以这样做：

（**编辑：**考虑到您正在等待`json`回复`dataType: 'json'`）

。网

```
public JsonResult Edit(EditPostViewModel data)
{
    if(ModelState.IsValid) 
    {
       // Save  
       return Json(new { Ok = true } );
    }

    return Json(new { Ok = false } );
} 
```

JS：

```
success: function (data) {
    if (data.Ok) {
      alert('success');
    }
    else {
      alert('problem');
    }
}, 
```

如果您需要，我还可以通过返回错误 500 来解释如何执行此操作，并在事件错误 (ajax) 中获取错误。但在你的情况下，这可能是一个选择

# qt - 在单个应用程序中使用多个版本的 qt-libs

> ID：14005775
> 
> 赞同：0
> 
> 时间：2012-12-22T19:16:57.243
> 
> 标签：qt, shared-libraries

我的主要应用程序是由 Qt V1（例如 4.7.4）编译的。（需要 QtCore 4.7.4） 主应用程序使用的共享库由 Qt V2（ex.4.8.2）编译。（需要 QtCore 4.8.2）我无法重新编译库，也不想重新编译主应用程序。是否可以使用多个版本的 QtCore、QtGui 等来部署我的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:53:32.900

> 是否可以使用多个版本的 QtCore、QtGui 等来部署我的应用程序？

简短的回答：没有。

长答案：*如果*您提前计划好，您可以通过`dlopen`and间接使用“使用 Qt V2 的共享库”（我们称之为 int libFoo.so） `dlsym`。如果你这样做了，你可以`dlopen("libFoo.so", RTLD_LOCAL)`，然后“Qt V2”中的符号对主可执行文件不可见。这是一个非常不稳定的基础，但*理论上*它应该有效。

# android - 我的布局右侧的黑条

> ID：14005776
> 
> 赞同：0
> 
> 时间：2012-12-22T19:17:02.937
> 
> 标签：android, android-layout, xamarin.android, android-linearlayout

我使用布局代码来设计您在图像中看到的页面的主要部分：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:minWidth="25px"
android:minHeight="25px">
 <ScrollView
    android:minWidth="25px"
    android:minHeight="25px"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/scrollView1"
    android:layout_weight="1"
    android:background="#ffededed">
    <LinearLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">
        <TextView
            android:text="@string/MortgageSelectCurrencyString"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/textView1"
            android:layout_marginLeft="5dp"
            android:textColor="#0094ff"
            android:textStyle="bold"
            android:textSize="16sp"
            android:layout_marginTop="5dp" />
        <TextView
            android:text="@string/MortgageCurrencyDiscriptionString"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/textView2"
            android:layout_marginLeft="5dp"
            android:textColor="#666666"
            android:textSize="10sp"
            android:textStyle="bold" />
        <RadioGroup
            android:minWidth="25px"
            android:minHeight="25px"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/radioGroup1"
            android:orientation="horizontal"
            android:layout_marginTop="0dp">
            <RadioButton
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:checked="true"
                android:text="@string/MortgageUSD_String"
                android:id="@+id/USDCheck"
                android:layout_marginRight="5dp"
                android:textColor="#000000"
                android:textSize="14sp" />
            <RadioButton
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/MortgageLocalString"
                android:id="@+id/LocalCheck"
                android:textColor="#000000"
                android:textSize="14sp" />
        </RadioGroup>
        <RelativeLayout
            android:minWidth="25px"
            android:minHeight="25px"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/relativeLayout1">
            <TextView
                android:text="@string/MortgagePropertyPriceString"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:id="@+id/textView3"
                android:layout_marginLeft="5dp"
                android:textColor="#0094ff"
                android:textStyle="bold"
                android:layout_centerVertical="true" />
            <EditText
                android:inputType="number"
                android:layout_width="100dp"
                android:layout_height="30dp"
                android:id="@+id/MrtgPropertyPriceEditText"
                android:background="@drawable/textbox_bg"
                android:text="3463"
                android:textColor="#000000"
                android:layout_alignParentRight="true"
                android:layout_marginRight="10dp" />
        </RelativeLayout>
        <TextView
            android:text="@string/MortgageDownPaymentString"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/textView1"
            android:layout_marginLeft="5dp"
            android:textColor="#0094ff"
            android:textStyle="bold"
            android:textSize="16sp"
            android:layout_marginTop="10dp" />
        <TextView
            android:text="@string/MortgageDownPaymentDiscriptionString"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/textView2"
            android:layout_marginLeft="5dp"
            android:textColor="#666666"
            android:textSize="10sp"
            android:textStyle="bold" />
        <TextView
            android:text="50%"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/textView4"
            android:layout_marginLeft="5dp"
            android:layout_marginTop="3dp"
            android:textSize="12sp" />
        <SeekBar
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/seekBar1"
            android:layout_marginLeft="3dp"
            android:layout_marginRight="10dp" />
        <TextView
            android:text="@string/MortgageFI_String"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/textView1"
            android:layout_marginLeft="5dp"
            android:textColor="#0094ff"
            android:textStyle="bold"
            android:textSize="16sp"
            android:layout_marginTop="10dp" />
        <TextView
            android:text="@string/MortgageFI_DescriptionString"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/textView2"
            android:layout_marginLeft="5dp"
            android:textColor="#666666"
            android:textSize="10sp"
            android:textStyle="bold" />
        <Spinner
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/spinner1"
            android:layout_marginRight="10dp" />
        <RelativeLayout
            android:minWidth="25px"
            android:minHeight="25px"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/relativeLayout1">
            <TextView
                android:text="@string/MortgageYearsString"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:id="@+id/textView3"
                android:layout_marginLeft="5dp"
                android:textColor="#0094ff"
                android:textStyle="bold"
                android:layout_centerVertical="true" />
            <EditText
                android:inputType="number"
                android:layout_width="100dp"
                android:layout_height="30dp"
                android:id="@+id/MrtgLoanYearsEditText"
                android:background="@drawable/textbox_bg"
                android:text="3463"
                android:textColor="#000000"
                android:layout_alignParentRight="true"
                android:layout_marginRight="10dp" />
        </RelativeLayout>
        <TextView
            android:text="@string/MortgageMonthlyPaymentString"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/textView5"
            android:layout_marginLeft="5dp"
            android:layout_marginTop="10dp"
            android:textSize="16sp"
            android:textStyle="bold"
            android:textColor="#0094ff" />
        <EditText
            android:inputType="number"
            android:layout_width="fill_parent"
            android:layout_height="30dp"
            android:id="@+id/MrtgMonthlyPaymentEditText"
            android:background="@drawable/textbox_bg"
            android:text="3463"
            android:textColor="#000000"
            android:layout_marginRight="10dp"
            android:layout_marginLeft="5dp"
            android:layout_marginTop="2dp" />
        <RelativeLayout
            android:minWidth="25px"
            android:minHeight="25px"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/relativeLayout1"
            android:layout_marginTop="10dp">
            <TextView
                android:text="@string/MortgageFamilyIncomeString"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:id="@+id/FamilyInComeTxtView"
                android:layout_marginLeft="5dp"
                android:textColor="#0094ff"
                android:textStyle="bold" />
            <TextView
                android:text="@string/MortgageFamilyIncomeDescriptionString"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:id="@+id/textView2"
                android:layout_marginLeft="5dp"
                android:textColor="#666666"
                android:textSize="10sp"
                android:textStyle="bold"
                android:layout_below="@+id/FamilyInComeTxtView" />
            <EditText
                android:inputType="number"
                android:layout_width="100dp"
                android:layout_height="30dp"
                android:id="@+id/MrtgFamilyIncomeEditText"
                android:background="@drawable/textbox_bg"
                android:text="3463"
                android:textColor="#000000"
                android:layout_alignParentRight="true"
                android:layout_marginRight="10dp" />
        </RelativeLayout>
        <RelativeLayout
            android:minWidth="25px"
            android:minHeight="25px"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:id="@+id/relativeLayout1"
            android:layout_marginTop="10dp">
            <TextView
                android:text="@string/MortgageAffordString"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:id="@+id/FamilyInComeTxtView"
                android:layout_marginLeft="5dp"
                android:textColor="#0094ff"
                android:textStyle="bold" />
            <TextView
                android:text="@string/MortgageAffordDescriptionString"
                android:layout_width="180dp"
                android:layout_height="wrap_content"
                android:id="@+id/textView2"
                android:layout_marginLeft="5dp"
                android:textColor="#666666"
                android:textSize="10sp"
                android:textStyle="bold"
                android:layout_below="@+id/FamilyInComeTxtView" />
            <EditText
                android:inputType="number"
                android:layout_width="100dp"
                android:layout_height="30dp"
                android:id="@+id/MrtgAffordEditText"
                android:background="@drawable/textbox_bg"
                android:text="3463"
                android:textColor="#000000"
                android:layout_alignParentRight="true"
                android:layout_marginRight="10dp" />
        </RelativeLayout>
    </LinearLayout>
</ScrollView> 
```

并将其包含在另一个布局中，如下所示（我包含抵押布局的部分是用于包含上述代码）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:id="@+id/AllPropertShow"
android:minWidth="25px"
android:minHeight="25px">
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="45dp">
    <include
        android:id="@+id/TopActionBarMenu"
        layout="@layout/ActionBarMenu" />
</LinearLayout>
<include
    android:id="@+id/PropertyShowBar"
    layout="@layout/PropertyShowBar" />
<ScrollView
    android:minWidth="25px"
    android:minHeight="25px"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:id="@+id/scrollView1"
    android:scrollbars="vertical"
    android:layout_weight="1"
    android:fillViewport="true">
    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="#f3f3f3"
        android:orientation="vertical">

        <include
            android:id="@+id/ImageInfoLayout"
            layout="@layout/PropertyShowImageView"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" />

        <LinearLayout
            android:id="@+id/InfoLayout"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:orientation="vertical"
            android:layout_marginRight="10dp"
            android:layout_marginLeft="10dp"
            android:layout_marginBottom="10dp"
            android:layout_marginTop="10dp" />
        <include
            android:id="@+id/AgentInfoLayout"
            layout="@layout/PropertyShoeAgentInfo" />

         <include
            android:id="@+id/MortgageLayout"
            layout="@layout/Mortgage" 
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"/>

    </LinearLayout>
</ScrollView>
<LinearLayout
    android:orientation="horizontal"
    android:layout_width="fill_parent"
    android:layout_height="350dp"
    android:background="@drawable/AgentInfo_bg"
    android:id="@+id/PrptyLocationOnMapLayout">
    <com.google.android.maps.MapView
        android:id="@+id/PrptyLocationOnMap"
        android:layout_width="wrap_content"
        android:layout_height="310dp"
        android:layout_marginRight="10dp"
        android:layout_marginLeft="10dp"
        android:apiKey="0OXLEzToRdbykr-QjEcfB9RECFS2k_Y5be7en-Q"
        android:layout_marginTop="10dp"
        android:layout_marginBottom="10dp" />
</LinearLayout>
<include
    android:id="@+id/Buttomactionbar"
    layout="@layout/Buttom_ActionBar" /> 
```

结果是这个图像：

![抵押](../Images/ec8107248d3db4174a2b8056fbec8025.png)

我不知道为什么这部分会显示黑条。我在此活动的地图上方也有这个（您可以在标签栏下方看到它）：

![地图](../Images/3f1e133ecbf630e70e672c6c1a55ba40.png)

我怎样才能隐藏它们？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:24:44.963

```
<ScrollView
    android:minWidth="25px"
    android:minHeight="25px"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" 
```

你可能想`match_parent`为宽度做

# c# - 选择何时加载第二个表单（身份验证服务器）

> ID：14005779
> 
> 赞同：0
> 
> 时间：2012-12-22T19:18:08.647
> 
> 标签：c#, authentication

我在允许我的表单加载第二个表单时遇到问题。我正在尝试设置身份验证服务器：在名为 Form2 的表单上。如果验证码正确，则将其编程到 MainForm。所以我希望它在显示“禁用身份验证代码”后关闭 Form2 并加载 MainForm。这是 Form2 的代码（带有身份验证服务器代码的表单）

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Windows.Forms;
using System.Drawing.Drawing2D;
using System.Diagnostics;
using System.Threading;
using System.IO;
using System.Net;
using System.Security.Cryptography;

namespace BBP
{
public partial class auth : Form
{

public static String Auth = null;
public static String Authcode = null;
public static String ip = null;
public auth()
{

InitializeComponent();
}

private void button1_Click(object sender, EventArgs e)
{
{
Auth = textBox1.Text;
if (Auth == (""))
{
MessageBox.Show("Enter Auth Code");
}

else
if (webBrowser3.Document.Body.InnerText.Contains(textBox1.Text))
MessageBox.Show("Auth Code Disabled");
else
if (webBrowser1.Document.Body.InnerText.Contains(textBox1.Text))
{
this.Hide();
 Form2 f2 = new Form2();
 f2.ShowDialog();
Application.Exit();
}
  else

 if (webBrowser2.Document.Body.InnerText.Contains(textBox1.Text))
 {

 this.Hide();
 Form2 f3 = new Form2();
 f3.ShowDialog();

Application.Exit();
}
else
{
MessageBox.Show("Invalid Auth Code");
}

}}

 private void webBrowser1_DocumentCompleted(object sender,WebBrowserDocumentCompletedEventArgs e)                       
 {

 }

 }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:34:34.680

关闭“Application.Exit()”行并重试。说：退出应用程序后，您无法打开表单。

# mysql - MySQL选择重复的列

> ID：14005780
> 
> 赞同：2
> 
> 时间：2012-12-22T19:18:28.473
> 
> 标签：mysql, coldfusion

我在我的选择语句中选择了两次 State 和 Zip3 列，准确地说明了我想看到的内容。当我在本机 MySQL 中执行此操作时，我得到了正确的结果：

```
SELECT State,Zip3, FirstName, LastName, State, Zip3 
FROM Person
WHERE State >= 'A'
ORDER BY State, Zip3
LIMIT 10;

+-------+------+-----------+-------------+-------+------+
| State | Zip3 | FirstName | LastName    | State | Zip3 |
+-------+------+-----------+-------------+-------+------+
| AB    | T7X  | Adalei    | Starreveld  | AB    | T7X  |
| AK    | 998  | Linda     | Rosenthal   | AK    | 998  |
| AL    | 361  | Benjamin  | Sung        | AL    | 361  |
| AL    | 362  | Lawrence  | Kallus      | AL    | 362  |
| AZ    | 857  | Rose      | Springfield | AZ    | 857  |
| CA    | 941  | Maura     | Cronin      | CA    | 941  |
| CA    | 941  | Dov       | Grunschlag  | CA    | 941  |
| CA    | 943  | Ruth      | Hodos       | CA    | 943  |
| CT    | 055  | Andrew    | Salvo       | CT    | 055  |
| CT    | 064  | DEBORAH   | GRASER      | CT    | 064  |
+-------+------+-----------+-------------+-------+------+ 
```

当我在 Cold Fusion 中执行此操作时，我得到了错误的结果：

```
<cfquery name = "stest" datasource = "Moxart">
select State,Zip3, FirstName,LastName,State,Zip3 from Person
where State >= 'A'
order by State,Zip3
</cfquery>
<cfset j = 0>
<table>
<cfoutput query = "stest">
<tr>
<cfloop index = "col" list = "#columnlist#">
<cfset j = j + 1>
<cfset colname[j] = #stest[col][currentrow]#>
<td>   #colname[j]# </td>
</cfloop><br/>
</tr>
</cfoutput>
</table>

Adalei      Starreveld      AB      AB      T7X     T7X  
Linda       Rosenthal       AK      AK      998     998 
Benjamin    Sung            AL      AL      361     361
Lawrence    Kallas          AL      AL      362     362
Rose        Springfield     AZ      AZ      857     857
Maura       Cronin          CA      CA      941     941
Dov         Grunschlag      CA      CA      941     941
Ruth        Hodos           CA      CA      943     943
Andrew      Salvo           CT      CT      055     055
DEBORAH     GRASER          CT      CT      064     064 
```

如何从 ColdFusion 中获得正确的结果。我正在使用 ColdFusion 8 和 Firefox。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T19:28:30.760

尝试给列一个别名

```
select 
  State,
  Zip3, 
  FirstName,
  LastName,
  State AS State_2,
  Zip3 as Zip3_2 
from 
  Person
where 
  State >= 'A'
order by 
  State,
  Zip3 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T03:42:34.283

> 我确实尝试了别名的东西，没有用。但确实解决了问题，这是我循环的变量 columnlist。

**维护列顺序**

好吧，您实际上并没有描述原始问题中的输出有什么问题；）但是，正如我在评论中提到的，`columnList`始终使用字母顺序。要获得原始订单

1.  使用`getMetaData(query)`. 它返回一个包含查询列属性的结构数组，包括`name`.
2.  或者，您可以改用*未记录* `query.getColumnList()`的方法。它返回一个列名数组（仅）。

然后只需使用`cfloop array`. 无需转换为列表，除非您使用的是 MX7 或更早版本（不支持数组循环）。

```
 <!--- using getMetaData --->
    <cfset colProps = getMetaData(someQuery) />
    <cfoutput query="someQuery">
        <cfloop array="#colProps#" index="col">
            #someQuery[ col.Name ][ currentRow ]# |
        </cfloop>
        <br />
    </cfoutput>

    <!--- using undocumented getColumnList() --->
    <cfset colNames = someQuery.getColumnList() />
    <cfoutput query="someQuery">
        <cfloop array="#colNames#" index="col">
            #someQuery[ col ][ currentRow ]# |
        </cfloop>
        <br />
    </cfoutput> 
```

* * *

> 有时有充分的理由请求一个字段两次

**唯一查询列名**

老实说，我想不出很多好理由多次返回*同一*列。正如 Dan 指出的那样，您可以轻松地多次输出它。所以我很好奇你的用例。

在结果中多次返回*相同的列名是有问题的，因为它是模棱两可的。*所以当你引用它时，CF 不知道你想要哪一列。在您的特定情况下，这并不重要，因为两者的值相同。但是考虑这个数据值不同但相同的列名分配给两者的示例：

```
<cfquery name="someQuery" datasource="someDSN">
    SELECT  1 AS Zip3, 2 AS Zip3 
    UNION ALL
    SELECT  8 AS Zip3, 16 AS Zip3 
</cfquery> 
```

如果要输出`#zip3#`，正确的结果应该是什么？如果您实际转储查询，则结果为：

```
 RESULTSET query 
  Row  | ZIP3 | ZIP3 
  1    | 1    | 1  
  2    | 8    | 8 
```

因为 CF 不知道要为“Zip3”使用哪些值，所以它显然只是选择了它找到的第一列来解决歧义。第二个“Zip3”列中的值被简单地丢弃。这就是为什么您应该始终使用别名来确保查询列名是唯一的。

当然，这是假设它甚至可以在其他版本中使用。我隐约记得某些版本在遇到重复的列名时会抛出错误。但由于这不是我通常做的事情，我必须运行测试来验证它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T21:54:26.107

我建议选择一次，显示两次。像这样的东西：

```
<cfscript>
Headers = "State,Zip Code,First Name,Last Name,State,Zip Code";
Fields = "state,zip3,FirstName,LastName,State,Zip3";
</cfscript>

<cfquery name = "stest" datasource = "Moxart">
select State, Zip3, FirstName, LastName
from Person
where State >= 'A'
order by State,Zip3
</cfquery>

<table>
<tr>
<cfoutput>
<cfloop index = "thisHeader" List = "#Headers>
<th>#thisHeader#</th>
</cfloop>
<cfoutput>
</tr>
<cfoutput query = "stest">
<tr>
<cfloop list = "#fields#" index = "thisField">
<td>#stest[thisField][currentrow]#</td>
</cfloop>
</tr>
</cfoutput>
</table> 
```

请注意，我实际上并没有测试此代码。可能有一两个语法错误，但逻辑很好。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-22T19:23:54.993

不知道你为什么要调用它两次，但我会这样做：

```
SELECT state, first_name, last_name zip FROM person WHERE state >= 'a' ORDER BY state, zip 
```

如果真的 zip 在表格中出现两次，并且您想确保它们匹配

```
SELECT state, first_name, last_name zip FROM person WHERE state >= 'a' AND zip = zip ORDER BY state, zip 
```

# c# - 有没有一种方法可以轻松地在 Ruby 中的对象之间进行映射？

> ID：14005781
> 
> 赞同：3
> 
> 时间：2012-12-22T19:18:41.847
> 
> 标签：c#, ruby-on-rails, ruby, automapper

我的 Rails 应用程序中有一个 ActiveRecord 模型，我想将它映射到其他一些 Ruby 对象。这些模型将命中外部 api，类之间的主要变化是字段名称和一些 api 细节。在下面的示例中，**Person**需要映射到其他两个 Api 特定类。

```
class Person
    include Virtus

    attribute :first_name, String
    attribute :last_name, String
    attribute :gender, String
end

class PersonApi1
    include Virtus

    attribute :forename, String
    attribute :surname, String
    attribute :gender, String
end

class PersonApi2
    include Virtus

    attribute :firstname, String
    attribute :secondname, String
    attribute :gender, String
end 
```

是否有可用的映射 gem 可以进行这种类型的映射？有没有其他人遇到过类似的映射问题，您是如何解决的？

如果我要自己推出，我会考虑某种散列来映射每个字段。

.net 世界有 Automapper，您可以在其中说如下内容。Ruby中有类似的东西吗？

```
public class CalendarEvent
{
    public DateTime Date { get; set; }
    public string Title { get; set; }
}

public class CalendarEventForm
{
    public DateTime EventDate { get; set; }
    public int EventHour { get; set; }
    public int EventMinute { get; set; }
    public string Title { get; set; }
}

//AutoMapper mapping

Mapper.CreateMap<CalendarEvent, CalendarEventForm>()
    .ForMember(dest => dest.EventDate, opt => opt.MapFrom(src => src.EventDate.Date))
    .ForMember(dest => dest.EventHour, opt => opt.MapFrom(src => src.EventDate.Hour))
    .ForMember(dest => dest.EventMinute, opt => opt.MapFrom(src => src.EventDate.Minute)); 
```

来自 automapper wiki [https://github.com/AutoMapper/AutoMapper/wiki/Projection](https://github.com/AutoMapper/AutoMapper/wiki/Projection)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T17:45:21.383

我不知道有什么宝石可以做到这一点，所以我昨天把一个放在一起 - 如果你想试试 - [https://github.com/house9/simple_attribute_mapper](https://github.com/house9/simple_attribute_mapper)

更新：版本 0.0.2 现在支持以下映射

*   默认（源和目标匹配的属性名称）
*   标准源到目标属性
*   嵌套源到目标属性
*   复合（lambda 样式）源到目标属性

# java - DefaultTableModel 的 ImageIcon

> ID：14005782
> 
> 赞同：1
> 
> 时间：2012-12-22T19:18:46.870
> 
> 标签：java, swing, imageicon, defaulttablemodel

我正在为学校制作一个程序，您可以记录系统剪贴板历史记录，我的老师说到目前为止还不错，但我需要添加图像。所以我得到了一些图像来表示图像、url、文本或文件夹。但是当我尝试使用图像 .addRow 时，它显示图像的来源而不是实际图像。这是我的课

```
public class Main extends JFrame implements ClipboardOwner {

    private static final long serialVersionUID = -7215911935339264676L;

    public final Clipboard clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();

    private static DecimalFormat df = new DecimalFormat("#.##");

    public static ArrayList<NewEntry> history = new ArrayList<NewEntry>();

    private DefaultTableModel model;

    private JTable table;

    public static void main(String[] args) throws Exception {
        UIManager.setLookAndFeel(new GraphiteLookAndFeel());
        Static.main.setVisible(true);
    }

    public Main() {
        super("Clipboard Logger");

        setSize(667, 418);
        setLocationRelativeTo(null);
        getRootPane().setWindowDecorationStyle(JRootPane.PLAIN_DIALOG);
        setDefaultCloseOperation(JFrame.HIDE_ON_CLOSE);

        model = new DefaultTableModel(null, new String[] { "Type", "Content", "Size", "Date" });
        table = new JTable(model) {

            private static final long serialVersionUID = 2485117672771964339L;

            @Override
            public boolean isCellEditable(int row, int column) {
                return false;
            }
        };

        table.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseReleased(MouseEvent e) {
                int r = table.rowAtPoint(e.getPoint());
                if (r >= 0 && r < table.getRowCount()) {
                    table.setRowSelectionInterval(r, r);
                } else {
                    table.clearSelection();
                }

                int rowindex = table.getSelectedRow();
                if (rowindex < 0)
                    return;
                if (e.isPopupTrigger() && e.getComponent() instanceof JTable ) {
                    createAndShowPopupMenu(rowindex, e.getX(), e.getY());
                }
            }
        });

        JScrollPane pane = new JScrollPane(table);
        table.setAutoResizeMode(JTable.AUTO_RESIZE_ALL_COLUMNS);

        getContentPane().add(pane);

        Transferable trans = clipboard.getContents(this);
        regainOwnership(trans);

        setIconImage(Static.icon);
    }

    @Override
    public void lostOwnership(Clipboard clipboard, Transferable transferable) {
        try {
            Thread.sleep(50);
            Transferable contents = clipboard.getContents(this);
            processContents(contents);
            regainOwnership(contents);
        } catch (Exception e) {
            regainOwnership(clipboard.getContents(this));
        }
    }

    public void processContents(Transferable t) throws UnsupportedFlavorException, IOException {
        System.out.println("Processing: " + t);
        DataFlavor[] flavors = t.getTransferDataFlavors();
        File file = new File(t.getTransferData(flavors[0]).toString().replace("[", "").replace("]", ""));
        System.out.println("HI"+file.getName());
        NewEntry entry = null;
        if (t.isDataFlavorSupported(DataFlavor.stringFlavor)) {
            System.out.println("String Flavor");
            String s = (String) (t.getTransferData(DataFlavor.stringFlavor));
            entry = new NewEntry(EntryType.TEXT, s, getSizeUnit(s.getBytes().length), DateFormat.getDateInstance().format(new Date()));
        } else if (isValidImage(file.getName()) && file.exists()) {
            System.out.println("Image Flavor");

            entry = new NewEntry(EntryType.IMAGE, file.getAbsolutePath(), getSizeUnit(file.length()), DateFormat.getDateInstance().format(new Date()));
        }
        history.add(entry);
        model.addRow(new Object[] { entry.getIcon(), entry.getContent(), entry.getSize(), entry.getDate() });
    }

    public void regainOwnership(Transferable t) {
        clipboard.setContents(t, this);
    }

    public boolean isValidImage(String filename) {
        for (String string : ImageIO.getReaderFormatNames()) {
            if (filename.endsWith(string)) {
                return true;
            }
        }
        return false;
    }

    public void createAndShowPopupMenu(int index, int x, int y) {
        final NewEntry entry = history.get(index);
        if (entry == null) return;
        JPopupMenu pop = new JPopupMenu();
        JMenu jm = new JMenu("Open in");
        JMenuItem jmi = new JMenuItem("Browser");
        jmi.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                try {
                    Desktop.getDesktop().browse(new URI("file:///"+entry.getContent().replace("\\", "/")));
                } catch (IOException e) {
                    e.printStackTrace();
                } catch (URISyntaxException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        });
        jm.add(jmi);
        jmi = new JMenuItem("Windows Explorer");
        jmi.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                try {
                    Desktop.getDesktop().open(new File(entry.getContent()));
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        });
        jm.add(jmi);
        pop.add(jm);
        pop.show(this, x, y);
    }

    public static String getSizeUnit(long dataSize) {
        double n = dataSize;
        String suffix = "B";
        if (n > 1000) {
            suffix = "KB";
            n /= 1000;
        }
        if (n > 1000) {
            suffix = "MB";
            n /= 1000;
        }
        if (n > 1000) {
            suffix = "GB";
            n /= 1000;
        }
        return df.format(n)+suffix;
    }
} 
```

这是我的 EntryType 类

```
public class EntryType {

public static final ImageIcon TEXT = new ImageIcon(Toolkit.getDefaultToolkit().getImage("./resources/text.png"));

public static final ImageIcon URL = new ImageIcon(Toolkit.getDefaultToolkit().getImage("./resources/url.png"));

public static final ImageIcon FILE = new ImageIcon(Toolkit.getDefaultToolkit().getImage("./resources/file.png"));

public static final ImageIcon IMAGE = new ImageIcon(Toolkit.getDefaultToolkit().getImage("./resources/image.png"));

} 
```

当我执行这行代码时，我将如何做到这一点：

> model.addRow(new Object[] { entry.getIcon(), entry.getContent(), entry.getSize(), entry.getDate() });

它实际上显示的是图标而不是来源？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T19:30:21.750

`JTable`为图像提供渲染器。覆盖`getColumnClass()`并返回`Icon.class`具有图标的列。

请参阅*如何使用表格*教程的[编辑器和渲染器](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editrender)部分。

# html - CSS 图像和标题没有换行

> ID：14005785
> 
> 赞同：0
> 
> 时间：2012-12-22T19:18:52.907
> 
> 标签：html, css

我的目标是生成这个：

```
<div>
   Image (40px by 40px) Caption

   Image (40px by 40px) Caption

   Image (40px by 40px) Caption
</div> 
```

我当前的代码生成包含在 div 中的图像，其中包含上一个列表项，而不是图像正下方的图像

我的代码结构是

```
<div>
   <ul>
      <li>
         <img/>
         <span>caption</span>
      </li>

      .....
   </ul>
</div> 
```

我需要什么 CSS，这样我才能避免做我看到的包装？

我现在对这些元素拥有的 CSS 是

```
li img{
    position:absolute;
    bottom:0;
    display: block;
}
li{
    position:relative;
}

.box (this is for div)
{
    padding: 4px 15px;
    border: 1px solid #ccc;
    margin: 0 0 10px 0;
    border-radius: 15px;
    -moz-border-radius: 15px; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:26:38.067

没有正确回答您的问题，但是如果您希望标题文本不被包装而不是使用 CSS`white-space`属性，这样文本就不会被包装

```
.box /* (this is for div) */ {
    padding: 4px 15px;
    border: 1px solid #ccc;
    margin: 0 0 10px 0;
    border-radius: 15px;
    -moz-border-radius: 15px;
    white-space: nowrap;
} 
```

# actionscript-3 - 在 AS3 中使用组合时访问调用者对象

> ID：14005786
> 
> 赞同：2
> 
> 时间：2012-12-22T19:19:09.613
> 
> 标签：actionscript-3, composition

在 ActionScript3 中，我试图从组合中访问调用者对象的属性。

```
public class Robot {
 ...
 private var controlPanel:ControlPanel;
 ...
 public function Robot() {
 ...
 cPanel = new ControlPanel();
 ...
  }
 } 
```

`this`我的 ControlPanel 需要从 Robot 实例访问属性，但我认为在调用 ControlPanel 时我不能通过...

```
public class ControlPanel{
...
 public function ControlPanel() {
  //How can I refer back to robot properties ?
  //
 } 
```

}

我相信我是在组合的情况下，因为机器人*有一个*控制面板。我正在考虑使用事件，但我需要访问许多属性。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:39:59.493

您总是可以让`ControlPanel`存储对其自身`Robot`对象的引用，如下所示：

```
// ControlPanel
private var robot:Robot;

public function ControlPanel(robot:Robot) {
    this.robot = robot;
} 
```

然后，在创建控制面板时：

```
// Robot
public function Robot() {
    controlPanel = new ControlPanel(this);
} 
```

或者，您可以创建一个均匀的排序系统，然后让控制面板调度它们。您可以创建自己的`ControlPanelEvent`类，然后让机器人自己处理结果。例如，假设您更改了`foo`在控制面板中调用的属性。你可以像这样发送它：

```
var event:ControlPanelEvent = new ControlPanelEvent(ControlPanelEvent.PROPERTY_CHANGE, "foo", value); 
```

然后你会像这样收到它：

```
public function Robot() {
    controlPanel = new ControlPanel();
    controlPanel.addEventListener(ControlPanelEvent.PROPERTY_CHANGE, updateProperty);
}

public function updateProperty(event:ControlPanelEvent):void {
    if (event.key == "foo") {
        this.foo = event.value;
    }
} 
```

但是，这是冗长且不必要的。您还可以在事件处理程序中使用 ActionScript 的数组访问表示法，这将是一个简单的单行代码：

```
this[event.key] = event.value; 
```

尽管如此，这并不完全安全，因为您可能不希望控制面板能够更新机器人的所有属性。相反，您可以维护一个机器人可以拥有的可配置属性的简单映射，然后更新它：

```
private var configuration:Dictionary = new Dictionary();

public function Robot() {
    // ...
    configuration.foo = "bar";
    configuration.baz = "qux";
    //...
}

public function updateProperty(event:ControlPanelEvent):void {
    if (configuration.hasOwnProperty(event.key))
        configuration[event.key] = event.value;
} 
```

你去吧。当然，您总是*可以*将配置映射存储在`ControlPanel`自身中，然后`Robot`从中提取，但如果您绝对需要它作为机器人的属性，这里有一些解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:47:25.183

你应该能够通过'this'：

```
cPanel=new ControlPanel(this);

public class ControlPanel{
    ...
    protected var _robot:Robot;
    public function ControlPanel(robot:Robot){
        _robot = robot;
    }
} 
```

扩展显示类时不能使用参数，但 ControlPanel 扩展对象（默认情况下未定义扩展。

对于显示类，您可以在创建后设置属性：

```
cPanel=new ControlPanel();
cPanel.robot = this;

public class ControlPanel{
    ...
    public var robot:Robot;
    public function ControlPanel(){
    }
} 
```

# r - heckman 模型的预测函数

> ID：14005788
> 
> 赞同：5
> 
> 时间：2012-12-22T19:19:21.523
> 
> 标签：r

我使用 sampleSelection 包中的示例

```
## Greene( 2003 ): example 22.8, page 786
    data( Mroz87 )
    Mroz87$kids  <- ( Mroz87$kids5 + Mroz87$kids618 > 0 )
    # Two-step estimation
    test1  = heckit( lfp ~ age + I( age^2 ) + faminc + kids + educ,
                     wage ~ exper + I( exper^2 ) + educ + city, Mroz87 ) 
    # ML estimation
    test2 =  selection( lfp ~ age + I( age^2 ) + faminc + kids + educ,
                        wage ~ exper + I( exper^2 ) + educ + city, Mroz87 ) 
    pr2 <- predict(test2,Mroz87)
    pr1 <- predict(test1,Mroz87) 
```

我的问题是预测功能不起作用。我收到此错误：

```
 Error in UseMethod("predict") : 
  no applicable method for 'predict' applied to an object of class "c('selection', 'maxLik', 'maxim', 'list')" 
```

predict 函数适用于许多模型，所以我想知道为什么赫克曼回归模型会出错。

-----------更新----------- 我取得了一些进展，但我仍然需要你的帮助。我建立了一个原始的 heckman 模型进行比较：

```
data( Mroz87 )
Mroz87$kids  <- ( Mroz87$kids5 + Mroz87$kids618 > 0 )
test1  = heckit( lfp ~ age + I( age^2 ) + faminc + kids + educ,
                 wage ~ exper + I( exper^2 ) + educ + city, Mroz87[1:600,] ) 
```

之后，我开始自己构建它。Heckman 模型需要一个选择方程：

```
zi* = wi γ + ui
where zi =1 if zi* >0  and zi = 0 if zi* <=0
after you calculate yi = xi*beta +ei ONLY for the cases where zi*>0 
```

我首先建立概率模型：

```
library(MASS)
#probit1 = probit(lfp ~ age + I( age^2 ) + faminc + kids + educ, Mroz87, x = TRUE, print.level = print.level -      1, iterlim = 30)
myprobit <- glm(lfp ~ age + I( age^2 ) + faminc + kids + educ, family = binomial(link = "probit"), 
                data = Mroz87[1:600,])
summary(myprobit) 
```

该模型与 heckit 命令完全相同。

然后我建立一个 lm 模型：

```
#get predictions for the variables (the data is not needed but I specify it anyway)
selectvar <- predict(myprobit,data = Mroz87[1:600,])
#bind the prediction to the table (I build a new one in my case)
newdata = cbind(Mroz87[1:600,],selectvar)
#Build an lm model for the subset where zi>0
lm1 = lm(wage ~ exper + I( exper^2 ) + educ + city , newdata, subset = selectvar > 0)
summary(lm1) 
```

我现在的问题是 lm 模型与 heckit 创建的模型相比并不多。我不知道为什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-09T06:57:07.717

## 执行

这是该`predict.selection`函数的一个实现——它产生 4 种不同类型的预测（[在此处](https://r-forge.r-project.org/tracker/index.php?func=detail&aid=5175&group_id=256&atid=1055)解释）：

```
library(Formula)
library(sampleSelection)
predict.selection = function(objSelection, dfPred, 
                                 type = c('link', 'prob', 'cond', 'uncond')) {

  # construct the Formula object
  tempS = evalq(objSelection$call$selection)
  tempO = evalq(objSelection$call$outcome)

  FormHeck = as.Formula(paste0(tempO[2], '|', tempS[2], '~', tempO[3], '|', tempS[3]))

  # regressor matrix for the selection equation
  mXSelection = model.matrix(FormHeck, data = dfPred, rhs = 2)

  # regressor matrix for the outcome equation
  mXOutcome = model.matrix(FormHeck, data = dfPred, rhs = 1)

  # indices of the various parameters in selectionObject$estimate
  vIndexBetaS = objSelection$param$index$betaS
  vIndexBetaO = objSelection$param$index$betaO
  vIndexErr = objSelection$param$index$errTerms

  # get the estimates
  vBetaS = objSelection$estimate[vIndexBetaS]
  vBetaO = objSelection$estimate[vIndexBetaO]

  dLambda = objSelection$estimate[vIndexErr['rho']]*
    objSelection$estimate[vIndexErr['sigma']]

  # depending on the type of prediction requested, return
  # TODO allow the return of multiple prediction types
  pred = switch(type, 
         link = mXSelection %*% vBetaS,
         prob = pnorm(mXSelection %*% vBetaS),
         uncond = mXOutcome %*% vBetaO,
         cond = mXOutcome %*% vBetaO + 
           dnorm(temp <- mXSelection %*% vBetaS)/pnorm(temp) * dLambda)
  return(pred)
} 
```

## 测试

假设您使用 MLE 估计以下 Heckman 样本选择模型：

```
data(Mroz87)

# define a new variable
Mroz87$kids  = (Mroz87$kids5 + Mroz87$kids618 > 0)

# create the estimation sample
Mroz87Est = Mroz87[1:600, ]

# create the hold out sample
Mroz87Holdout = Mroz87[601:nrow(Mroz87), ]

# estimate the model using MLE
heckML =  selection(selection = lfp ~ age + I(age^2) + faminc + kids + educ,
                    outcome = wage ~ exper + I(exper^2) + educ + city, data = Mroz87Est) 
summary(heckML) 
```

不同类型的预测计算如下：

```
vProb = predict(objSelection = heckML, dfPred = Mroz87Holdout, type = 'prob')
vLink = predict(objSelection = heckML, dfPred = Mroz87Holdout, type = 'link')
vCond = predict(objSelection = heckML, dfPred = Mroz87Holdout, type = 'cond')
vUncond = predict(objSelection = heckML, dfPred = Mroz87Holdout, type = 'uncond') 
```

您可以在产生这些输出的平台上验证这些计算，例如[Stata](http://www.stata.com/help.cgi?heckman_postestimation)。

# php - MySQL 3插入重复键更新查询多个表不起作用

> ID：14005790
> 
> 赞同：-1
> 
> 时间：2012-12-22T19:19:33.920
> 
> 标签：php, mysql

如果我在 PhpMyAdmin 中执行下面的查询，则根本没有问题，但是如果我从 PHP 执行它会给出错误，为什么？

像这样从 PhP 执行：

mysql_query($query_antwooden.$query_huurtermijnen.$query_gesloten) 或死 (....

```
INSERT INTO data_prijzen_antwoorden (`ID_advertentie`,`antw_wisseldagen`,`antw_gesloten`,`antw_borg`) 
VALUES (19,1,1,2) 
ON DUPLICATE KEY UPDATE antw_wisseldagen = VALUES(antw_wisseldagen), antw_gesloten = VALUES(antw_gesloten), antw_borg = VALUES(antw_borg);

INSERT INTO data_huurtermijnen_wisseldagen (`ID_advertentie`,`ID_htbl_huurtermijn`,`huurtermijn_beschikbaar`,`startdag`,`starttijd`,`einddag`,`eindtijd`) 
VALUES (19,1,1,'Maandag','9.00','Vrijdag','17.00'),(19,2,1,'Vrijdag','12.00','Vrijdag','10.00'),(19,3,1,'Maandag','3.00','Vrijdag','4.00'),(19,4,1,'Vrijdag','10.00','Maandag','1.00'),(19,5,1,'Vrijdag','12.00','Zondag','10.00'),(19,6,1,'dag','0.00','dag','17.00'),(19,7,1,'dag','0.00','dag','12.00'),(19,8,1,'dag','0.00','dag','17.30') 
ON DUPLICATE KEY UPDATE huurtermijn_beschikbaar = VALUES(huurtermijn_beschikbaar), startdag = VALUES(startdag), starttijd = VALUES(starttijd), einddag = VALUES(einddag), eindtijd = VALUES(eindtijd);

INSERT INTO data_periodes_gesloten (`ID_advertentie`,`from_11`,`to_11`,`from_12`,`to_12`,`from_13`,`to_13`,`array_gesloten_data`) 
VALUES (19,'19-12-2012','21-12-2012',NULL,NULL,NULL,NULL,'1355875200,1355961600,1356048000') 
ON DUPLICATE KEY UPDATE from_11 = VALUES(from_11), to_11 = VALUES(to_11), from_12 = VALUES(from_12), to_12 = VALUES(to_12), from_13 = VALUES(from_13), to_13 = VALUES(to_13), array_gesloten_data = VALUES(array_gesloten_data); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T19:21:13.703

您不能在 PHP 中的单个查询调用中执行多个查询。这是一种反sql注入防御机制。

您必须进行 3 次单独的 ->query() 调用。

# java - 创建新的 LAN 套接字时连接被拒绝

> ID：14005794
> 
> 赞同：0
> 
> 时间：2012-12-22T19:20:08.680
> 
> 标签：java, sockets

我一直试图在我的局域网中的两台计算机之间建立一个非常基本的连接。我查看了几个代码片段并从那里开始，但事情似乎在一开始就失败了：创建一个套接字。

我已经尝试连接到我正在执行代码的计算机（使用主机名“ `Jeroen-DESKTOP`”和“ `Localhost`”以及本地主机 IP“ `127.0.0.1`”），并连接到我的笔记本电脑（使用“ `Jeroen-LAPTOP`”）。我已经尝试了这些端口`6666`，`7598`并在我的防火墙设置中打开了所有的 TCP 连接。

我使用的代码非常基本：

```
socket = new Socket("Jeroen-LAPTOP", 6666);
System.out.println(socket.getPort()); 
```

错误是：

```
java.net.ConnectException: Connection refused: connect
    at java.net.DualStackPlainSocketImpl.connect0(Native Method)
    at java.net.DualStackPlainSocketImpl.socketConnect(Unknown Source)
    at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source)
    at java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source)
    at java.net.AbstractPlainSocketImpl.connect(Unknown Source)
    at java.net.PlainSocketImpl.connect(Unknown Source)
    at java.net.SocksSocketImpl.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source)
    at java.net.Socket.<init>(Unknown Source)
    at java.net.Socket.<init>(Unknown Source)
    at domain.Client.<init>(Client.java:13) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:37:20.533

在不知道你在做什么的情况下——

假设您在机器 A 上打开一个套接字并尝试使用机器 B 连接到它，那么 Java 中的典型场景将是。

机器A：

```
ServerSocket server = new ServerSocket(4444);
Socket connection = server.Accept(); 
```

机器 B：

```
Socket sock = new Socket(MACHINE-A-IP, 4444); 
```

这将需要异常处理等以使其工作。您可以在此处查看示例； [http://docs.oracle.com/javase/tutorial/networking/sockets/clientServer.html](http://docs.oracle.com/javase/tutorial/networking/sockets/clientServer.html)

关于您的评论 - 是的，您可以在本地运行它们。

# delphi - Delphi XE2 中的命名空间

> ID：14005795
> 
> 赞同：5
> 
> 时间：2012-12-22T19:20:09.680
> 
> 标签：delphi, namespaces, delphi-xe2

我有两个 bpl 包：Core 和 Business，由一个应用程序使用。Core.bpl 包含单元 User.pas，其中包含 TUser 类。Core.bpl 中的 TUser 只有两个基本字段：登录和密码。我想用新字段扩展业务包中的 TUser 类：用户名。我想将业务单元命名为基本单元：User.pas。

因此，我在 Business.bpl 中创建了一个新单元 User.pas，并在其中放置了从 Core.bpl 扩展 TUser 的 TUser 类。现在我需要将 TUser 与 Core.bpl 和 TUser 与 Business.bpl 分开。我需要在这里使用“命名空间的力量”:)

我已经阅读了[Embarcadero 文档页面](http://docwiki.embarcadero.com/RADStudio/XE2/en/Using_Namespaces_with_Delphi)。他们说可以通过命名来设置包的默认命名空间，例如 Base.Core。我将我的包命名为 Base.Core.bpl 和 Extra.Business.bpl。并且编译的文件是这样命名的。但是它们中的所有单元仍然像以前一样命名：User.pas -> User.dcu。

现在我在 User.pas 模块中有两个类 TUser：一个在包 Base.Core.bpl 中，另一个在包 Extra.Business.bpl 中。额外的 User.pas 看起来像

```
unit User;
interface
uses
  Base.User;
type
  TUser = class(Base.User.TUser)
  end; 
```

但是当我想编译它时，我有一个窗口：“删除用户。单位用户在所需的包基础中找到。”

例如，我该怎么做才能从 Base.User.TUser 继承新的 TUser，就像它可以在 Java 中一样？

PS 以防万一，我使用 Delphi XE2 IDE。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T19:47:12.490

默认命名空间似乎是 Portal cake——这是一个谎言。您链接到的文档与程序不匹配。

我做了这个程序：

**MyCompany.Programs.MyProgram.dpr**

```
program MyCompany.Programs.MyProgram;

uses
  MyUnit in 'MyUnit.pas';

begin
end. 
```

**我的单位.pas**

```
unit MyUnit;

interface

implementation

end. 
```

生成的 .dcu 文件名为`MyUnit.dcu`. 根据您链接到它的文档，它应该被命名为`MyCompany.Programs.MyUnit.dcu`.

我相信您必须在单元名称中明确指定命名空间。

# jquery - jquery限制元素查询结果

> ID：14005796
> 
> 赞同：10
> 
> 时间：2012-12-22T19:20:19.990
> 
> 标签：jquery, css-selectors

> **可能重复：**
> [使用 jQuery 选择前“n”个项目](https://stackoverflow.com/questions/1865552/selecting-the-first-n-items-with-jquery)

我有一个无限可数的元素列表！

是否有从列表头部查找 x 元素并停止的功能！

```
$('.elements').find('li').limit(10) //this does not work 
```

我尝试了 goog，但我对 ? ！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-22T19:22:03.250

是的，您可以为此使用 jQuery 的[自定义`:lt`选择器](http://api.jquery.com/lt-selector/)。

例如，这将只找到`li`给定目标列表中的前三个：

```
var firstThree = $("#target li:lt(3)"); 
```

[实例](http://jsbin.com/eqafos/1)| [资源](http://jsbin.com/eqafos/1/edit)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-12-22T19:31:35.417

试试 jQuery[切片](http://docs.jquery.com/Traversing/slice)。您的代码将是这样的：

```
$('.elements').find('li').slice(0,10); 
```

**更新**

正如 Marius Miliunas 和 TJ Crowder 所建议的，根据性能，您可以这样做：

```
$('.elements li').slice(0,10); 
```

# php - 我必须为 Symfony 2 安装 intl 吗？

> ID：14005797
> 
> 赞同：0
> 
> 时间：2012-12-22T19:20:35.857
> 
> 标签：php, symfony

我用`generate:doctrine:crud`. 我的控制器工作完美，但是当我提交编辑表单或创建表单时，我收到一个错误，该方法`getSymbol()`没有实现，我必须安装 intl，但我认为这只是一个建议。

如何在我的 Mac OS 上安装它？我已取消注释`extension=php_intl.dll`并重新启动，但没有任何反应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:38:00.527

老哥请用谷歌。

[http://mansion.im/2011/php-with-intl-and-gettext-on-osx-lion/](http://mansion.im/2011/php-with-intl-and-gettext-on-osx-lion/)

解决问题的第一个结果

# scsf - 从另一个智能部件获取 Active Smartpart

> ID：14005798
> 
> 赞同：3
> 
> 时间：2012-12-22T19:20:42.813
> 
> 标签：scsf

我正在开发定制的智能客户端应用程序。我想从另一个智能部件中了解活动的智能部件。由于我根据用户需求使用命令处理程序一个按钮“新建”将用于所有表单。如果我打开多个视图/智能部件并单击新按钮，则会为工作区中的所有智能部件触发此操作。我怎样才能在那里进行检查，以便只能为活动的一个/视图/智能部分处理新按钮操作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T08:02:07.713

您可以使用`WorkItem.Workspaces[WorkspaceNames.YourWorkspaceName].ActiveSmartPart`

# try-catch - 文件存在但程序抛出 FileNotFoundException

> ID：14005799
> 
> 赞同：0
> 
> 时间：2012-12-22T19:20:52.313
> 
> 标签：try-catch, filenotfoundexception

```
/*
 *This program checks type casting from String to int/double from a file
 */

import java.io.*;

import java.lang.String;

public class ConvertingStringsToNums {

  public static void main (String[] args){

    File dataFile = new File("/files/scores.dat");
    FileReader in;
    BufferedReader readFile;
    String score;
    double avgScore, totalScores = 0;
    int numScores = 0;
    //------------------------------------------------------------
    try {
      in = new FileReader(dataFile);
      readFile = new BufferedReader(in);

      while((score = readFile.readLine()) != null) {
        numScores += 1;
        System.out.println(score);
        totalScores += Double.parseDouble(score);
      }
      avgScore = totalScores / numScores;

      readFile.close();
      in.close();
    } catch(FileNotFoundException e) {
      System.err.println("FileNotFoundException: " + e.getMessage());
    } catch (IOException e) {
      System.err.println("IOException: " + e.getMessage());
    } //end try/catch

  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:54:14.720

1) 如果您希望在硬盘驱动器上的绝对文件路径中打开文件：

```
br = new BufferedReader (
  new FileReader(
    new File ("/files/scores.dat"))); 
```

2）如果您希望以相对于您启动应用程序的位置的相对路径打开文件：

```
br = new BufferedReader (
  new FileReader(
    new File ("files/scores.dat"))); 
```

3) 如果您希望以相对于类文件的相对路径打开文件（尤其与包和/或从 .jar 或 .war 执行有关）：

```
this.getClass().getResourceAsStream ("files/scores.dat"); 
```

'希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:43:27.903

原因可能是您没有打开文件的权限。从终端尝试 `chmod 755 scores.dat`以更改权限并查看错误是否仍然存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T20:07:50.660

这个问题的答案存在于[File 类的 javadocs 中](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)：

> 对于 UNIX 平台，绝对路径名的前缀始终是“/”。相对路径名没有前缀。表示根目录的抽象路径名具有前缀“/”和一个空的名称序列。

在您的代码中，您具有以下内容：

```
File dataFile = new File("/files/scores.dat"); 
```

根据文档，这是一个绝对路径，这意味着 Java 正在文件系统的根目录中查找名为“files”的文件夹，然后在该文件夹中查找 score.dat。

如果您希望搜索相对于当前目录的文件目录，则需要省略第一个`/`：

```
File dataFile = new File("files/scores.dat"); 
```

另一种选择是使用数据文件的绝对路径，但如果更改项目的位置或将类文件放在 JAR 文件中，可能会遇到问题。

尝试将您的日志记录级别设置为 DEBUG 或 ALL，以便您可以准确地看到程序试图查看的位置。这将帮助您调整代码以定位正确的文件夹。

# ruby - 有没有办法在 Vim 的“嵌入式”Ruby 中使用 Gems？

> ID：14005800
> 
> 赞同：4
> 
> 时间：2012-12-22T19:21:01.550
> 
> 标签：ruby, gem, vim, load-path

我正在尝试使用`tinder`Vim 内部的 gem。我希望能够写入 Vim 缓冲区，所以我需要使用 Vim 的嵌入式 Ruby using`:ruby`而不是外部调用`!ruby`.

我`gem install tinder`在命令行上运行没有问题，但嵌入式 ruby​​ 似乎在其加载路径上没有相关目录能够要求它。

我尝试通过尝试以下操作来操纵加载路径：

```
:ruby `gem env gempath`.strip.split(':').each { |p| $:.unshift(p) } 
```

...但收效甚微。

我也尝试过类似的事情：

```
Gem.path.unshift ... 
```

...但是，同样，收效甚微。

我尝试过解压 Tinder 并要求使用绝对路径，这似乎确实有效，但 unpack 不会解压 gem 的依赖项，因此它无法找到“法拉第”。也许我可以递归解包？

有人对这个问题有任何想法吗？

我搜索了很多，并查看了 Vmail 等项目的来源，但据我所知，没有人在 Vim 的 Ruby 中使用 Gems。这似乎是一种可怕的耻辱。

我很确定 gem 原生扩展永远不会工作，无论我尝试什么 - 但我很高兴能够需要纯 Ruby gem。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:45:04.313

折腾了半天，其实很简单。

最简单的方法是针对 1.9 或更高版本的 Ruby 编译 Vim。编译时，Vim 将使用加载路径中最先出现的 Ruby。

然后，您只需要通过常规方式为您编译的版本安装 gems。

在 1.9 及更高版本中，默认情况下这些 gem 将在您的加载路径中可用，因为它们对 ruby​​gems 的自动加载方式进行了一些更改。

# sql - 如何在 SQL Server 2012 中运行子查询？

> ID：14005801
> 
> 赞同：0
> 
> 时间：2012-12-22T19:21:03.437
> 
> 标签：sql, sql-server-2012

```
SELECT [SKULL].[dbo].[reports].[idnumber], [SKULL].[dbo].[reports].[subid] 
FROM [SKULL].[dbo].[reports] 
WHERE reportColumn =  (SELECT DISTINCT(reportColumn)
                       FROM [SKULL].[dbo].[reports] 
                       WHERE [SKULL].[dbo].reports.reportColumn 
                       LIKE '%someword%') 
```

我收到一条错误消息说

```
Msg 512, Level 16, State 1, Line 2
Subquery returned more than 1 value. 
This is not permitted when the subquery follows =, !=, <, <= , >, >= or 
when the subquery is used as an expression. 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:46:30.857

我不太确定你想在这里做什么。如果我们假设您要返回报告列与包含相同单词的不同报告列值列表匹配的所有报告记录，那么您做的工作太多。你可以这样写：

```
SELECT [SKULL].[dbo].[reports].[idnumber], [SKULL].[dbo].[reports].[subid] 
FROM [SKULL].[dbo].[reports] 
WHERE reportColumn LIKE '%someword%'; 
```

如果这不是您想要的，请查看您的查询，尤其是列名和表名。如果在这种情况下您仍然无法弄清楚如何编写查询，请发布一些示例值和预期结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:57:59.317

如果子查询返回多于一行，则使用`IN`而不是`=`as

```
SELECT [SKULL].[dbo].[reports].[idnumber], [SKULL].[dbo].[reports].[subid] 
FROM [SKULL].[dbo].[reports] 
WHERE reportColumn IN  (SELECT DISTINCT(reportColumn)
                       FROM [SKULL].[dbo].[reports] 
                       WHERE [SKULL].[dbo].reports.reportColumn 
                       LIKE '%someword%') 
```

或者

如果您确定子查询返回单行，则用作

```
SELECT [SKULL].[dbo].[reports].[idnumber], [SKULL].[dbo].[reports].[subid] 
FROM [SKULL].[dbo].[reports] 
WHERE reportColumn =  (SELECT top(1) DISTINCT(reportColumn)
                       FROM [SKULL].[dbo].[reports] 
                       WHERE [SKULL].[dbo].reports.reportColumn 
                       LIKE '%someword%' order by idnumber) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T19:30:07.633

错误原因：尝试将单个值与多个值进行比较。

解决方案：限制内部查询返回 1 个值或更改 where 条件以与多个返回集进行比较。

与单个值比较：SELECT [SKULL].[dbo].[reports].[idnumber], [SKULL].[dbo].[reports].[subid] FROM [SKULL].[dbo].[reports] WHERE reportColumn = (SELECT **TOP1** reportColumn FROM [SKULL].[dbo].[reports] WHERE [SKULL].[dbo].reports.reportColumn LIKE '%someword%')

或者

与多个返回集比较

SELECT [SKULL].[dbo].[reports].[idnumber], [SKULL].[dbo].[reports].[subid] FROM [SKULL].[dbo].[reports] WHERE reportColumn **in** (SELECT DISTINCT (reportColumn) FROM [SKULL].[dbo].[reports] WHERE [SKULL].[dbo].reports.reportColumn LIKE '%someword%')

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T19:22:49.847

你正在做`where field=subquery`的，这是一个相等性测试——子查询必须返回一个**SINGLE**值，例如 1 行有 1 个值。现在是 2 行，而不是 2 个字段。如果您要返回多行，它必须是`where field IN (subquery)`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T19:23:44.323

如错误所述，您的子查询只能返回一条记录。尝试使用`TOP 1`来做到这一点。

```
SELECT [SKULL].[dbo].[reports].[idnumber],  [SKULL].[dbo].[reports].[subid] FROM [SKULL].[dbo].[reports] WHERE reportColumn =  (SELECT TOP 1 reportColumn
  FROM [SKULL].[dbo].[reports] WHERE [SKULL].[dbo].reports.reportColumn LIKE '%someword%') 
```

# ruby-on-rails - Appfog + Rails 3 + Postgresql + IronWorker => 无法连接到服务器：连接超时（PG::Error）

> ID：14005807
> 
> 赞同：0
> 
> 时间：2012-12-22T19:21:27.230
> 
> 标签：ruby-on-rails, postgresql, appfog, ironworker

我在 Appfog 上部署了一个带有 postgresql 数据库的 Rails 3 应用程序。我想用 IronWorker 运行后台作业，但我无法连接到我的数据库。

这是我的铁工文件（.worker + my_worker.rb）

。工人

```
runtime "ruby"
gemfile '../Gemfile'
dir "../app/models" # merge all models
full_remote_build true
exec "my_worker.rb" 
```

my_worker.rb

```
require 'rubygems'
require 'active_record'
require 'pg'
require 'models/my_model.rb'

def setup_database
  puts "Database connection details:#{params['database'].inspect}"
  return unless params['database']
  # estabilsh database connection
  ActiveRecord::Base.establish_connection(params['database'])
end

setup_database
@my_models = My_model.all 
```

然后我创建一个任务，将数据库连接传递给 Ironworker：

```
client = IronWorkerNG::Client.new
client.tasks.create("my_worker", database:Rails.configuration.database_configuration[Rails.env]) 
```

这是我在 IronWorker 中的错误

```
/task/__gems__/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:1213:in `initialize': could not connect to server: Connection timed out (PG::Error)
Is the server running on host "10.0.48.220" and accepting TCP/IP connections on port 5432? 
```

有人可以帮我从 IronWorker 连接我的 Appfog DB 吗？

非常感谢提前

——马修

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:52:58.213

据我所知，AppFog 阻止了与其数据库的外部连接 [https://groups.google.com/forum/?fromgroups=#!topic/appfog-users/I31ni0pff9I](https://groups.google.com/forum/?fromgroups=#!topic/appfog-users/I31ni0pff9I)

可能的解决方案：

*   戳 AppFog
*   切换到其他数据库主机
*   Make some kind of tunnel. As example, IronWorker platform allows you to interact with any non-privileged code during worker's execution, so you can try to set up SSH tunnel to 'good' machine.

# django - Django：自动生成 Adob e Illustrator 图像预览

> ID：14005812
> 
> 赞同：0
> 
> 时间：2012-12-22T19:22:13.937
> 
> 标签：django, adobe, django-views, adobe-illustrator

如果用户上传 .AI 文件，我如何自动生成文件内部的图像预览？Mac OS X 10.8 使用“空格键”预览来做到这一点，但我希望能够在我的基于网络的 django 项目中做到这一点。

我不需要创建 AI 文件，我只需要创建以前制作的文件的预览。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T05:56:15.697

Mac OS 10.8 可以生成预览的原因是因为 Illustrator 默认将 PDF 与文件一起保存。[这个网站](http://weblogs.asp.net/jgalloway/archive/2008/02/24/opening-adobe-illustrator-ai-files-when-you-don-t-have-adobe-illustrator.aspx)可能会有所帮助。

# java - LibGdx：我在加载大背景图像时遇到问题。我收到一个错误，说它不是两个正方形。有没有解决的办法？

> ID：14005820
> 
> 赞同：0
> 
> 时间：2012-12-22T19:23:37.540
> 
> 标签：java, load, textures, libgdx, assets

我正在尝试创建一个级别为 380 X 10000 的垂直滚动游戏。当我创建纹理以加载图像时，我收到此错误：原因：com.badlogic.gdx.utils.GdxRuntimeException：纹理宽度和高度必须是 2 的幂：380x10000 我知道我可以得到 512X512 的纹理来很好地加载。那么我需要做些什么来加载这个背景图像呢？

```
Assets{
public static Texture levels;
    public static TextureRegion levelsRegion;
}

Load{
    levels = loadTexture("data/levels.png"); <--------- Error occurs here.
        levelsRegion = new TextureRegion(background, 0, 0, 380, 10000); <--- Doesnt get to this point
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:13:04.563

WWOOoooo 380x10000?? 你是针对手机吗？？如果您使用的是 GL 1.1，则使用 GL2.0 将解决您的 -not power of two- 问题。不太确定您的设备是否能够加载该纹理！

PS：如果是这样，请考虑拆分纹理。并非所有设备都能够加载 10000 像素宽的纹理！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-23T15:34:21.900

利用

`Texture.setEnforcePotImages(false)`

然后您可以加载非正方形（精确的两个长的非幂）图像。虽然加载这么大的图像是非常糟糕的主意。只需将其拆分为更小的部分，并在需要在屏幕上显示时使用它们。

# android - 钛金属中是否存在 Seekbar

> ID：14005821
> 
> 赞同：-1
> 
> 时间：2012-12-22T19:23:39.067
> 
> 标签：android, mobile, titanium, seekbar

嗨，我正在寻找钛中的搜索栏，就像 android 一样，但我在文档中没有遇到过这样的事情。实际上我想手动更改值。我看到了进度条，但没有看到搜索栏。任何人都可以告诉钛有吗实施了搜索栏，如果没有的话，还有什么替代方法。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:10:32.930

听起来你想要 Ti.UI.Slider。

[http://docs.appcelerator.com/titanium/2.1/#!/api/Titanium.UI.Slider](http://docs.appcelerator.com/titanium/2.1/#!/api/Titanium.UI.Slider)

# wordpress - Wordpress XML-RPC 发布成功，但不适用于长正文

> ID：14005828
> 
> 赞同：0
> 
> 时间：2012-12-22T19:24:20.970
> 
> 标签：wordpress

我使用下面的代码通过 XML-RPC 发布，它确实成功。但是当我发送一个长字符串 $bodypost 时，我的帖子没有正文内容。我用 html 代码测试它，它工作正常，然后我删除所有空间，我的 $bodypost 只有 1 行大约 4000 个字，它不工作。

我该如何解决？

```
 <?php 
function send_post($titlepost, $bodypost, $categorypost, $keywordspost )  
{  
    require_once("IXR_Library.php.inc");
    $encoding='UTF-8';
    $client->debug = false; //Set it to false in Production Environment
    $title= $titlepost; // $title variable will insert your blog title 
    $body= $bodypost; // $body will insert your blog content (article content)
    $category=$categorypost; // Comma seperated pre existing categories. Ensure that these categories exists in your blog.
    $keywords=$keywordspost;
    $customfields=array('key'=>'Author-bio', 'value'=>'Autor Bio Here'); // Insert your custom values like this in Key, Value format
        $title = htmlentities($title,ENT_NOQUOTES,$encoding);
        $keywords = htmlentities($keywords,ENT_NOQUOTES,$encoding);
        $content = array(
            'title'=>$title,
            'description'=>$body,
            'mt_allow_comments'=>0,  // 1 to allow comments
            'mt_allow_pings'=>0,  // 1 to allow trackbacks
            'post_type'=>'post',
            'mt_keywords'=>$keywords,
            'categories'=>array($category),
            'custom_fields' =>  array($customfields)

        );

    // Create the client object
    $client = new IXR_Client('http://www.domain.com/xmlrpc.php');
     $username = "abc"; 
     $password = "abc"; 
     $params = array(0,$username,$password,$content,true); // Last parameter is 'true' which means post immideately, to save as draft set it as 'false'
    // Run a query for PHP
    if (!$client->query('metaWeblog.newPost', $params)) {
        die('Something went wrong - '.$client->getErrorCode().' : '.$client->getErrorMessage());
    }
    else
        echo "Article Posted Successfully";
}   
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T18:49:10.227

我找到了解决方法。如果我的正文代码是由默认 Wordpress 编辑器的源代码提供的，则此代码不起作用，但如果我将其更改为 CkEditor，它就可以工作！

# java - 如何使用 java 访问 cd 驱动器？

> ID：14005838
> 
> 赞同：0
> 
> 时间：2012-12-22T19:25:33.807
> 
> 标签：java, windows, cd-rom

如何从 Java 访问 CD ROM 驱动器（在我的例子中是 F:）？我不介意平台特定的代码。我使用的是 Windows 8。我有以下代码，但被拒绝访问。

```
 public static void main(String args[]) throws IOException {     
        File cd = new File( "f:\\lang" );
        System.out.println(cd.canRead());
        RandomAccessFile rawAccess = new RandomAccessFile( cd, "r" );

        rawAccess.close();
   } 
```

这 3 个 true 正在检查 cd.canRead、cd.canWrite、cd.canExecute。

```
 true
   true
   true
   Exception in thread "main" java.io.FileNotFoundException: f:\lang (Access is denied) at java.io.RandomAccessFile.open(Native Method)
   at java.io.RandomAccessFile.<init>(Unknown Source) at myapp.main(myapp.java:16) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:58:05.317

`RandomAccessFile`提供对文件而不是目录的访问。

被`FileNotFound`抛出，因为没有文件，只有一个目录。

[http://docs.oracle.com/javase/6/docs/api/java/io/RandomAccessFile.html#RandomAccessFile(java.io.File](http://docs.oracle.com/javase/6/docs/api/java/io/RandomAccessFile.html#RandomAccessFile(java.io.File) , java.lang.String)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:27:07.507

我现在看到了我的错误。当我真正想要的是来自光盘的原始数据时，我正在尝试使用 Java File 对象。我正在提供一个目录并尝试像打开文件一样打开它，导致原始帖子中出现错误。一旦我将路径更改为特定文件，它就起作用了。

我将创建一个更清楚我想要什么的新问题。谢谢你。

# arrays - 如何使用foreach跳过数组中的第一个元素？

> ID：14005840
> 
> 赞同：10
> 
> 时间：2012-12-22T19:25:37.133
> 
> 标签：arrays, perl, foreach

假设我有一个数组：

```
my @arr = (1,2,3,4,5); 
```

现在我可以通过 foreach 对其进行迭代：

```
foreach ( @arr ) {
    print $_;
} 
```

但是有没有办法从第二个（例如）迭代到最后一个元素？

提前致谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-22T19:41:11.810

这是perl。总是有不止一种方法可以做到这一点。比如数组切片：

```
for (@arr[1 .. $#arr])   # for and foreach are exactly the same in perl 
```

您可以`shift`按照 Andy Lester 的建议使用，但这当然会改变您的原始数组。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-22T19:30:01.223

只需在循环之前移开第一个元素。

```
my @arr = ( 1..5 );
shift @arr; # Remove the first element and throw it away

foreach ( @arr ) {
    print "$_\n";
} 
```

# java - 局部变量可能未初始化

> ID：14005841
> 
> 赞同：1
> 
> 时间：2012-12-22T19:25:44.983
> 
> 标签：java, scope

> **可能重复：**
> [变量未初始化 - 虽然我是？](https://stackoverflow.com/questions/12148387/variable-not-initialized-although-i-am)

我对编程很陌生，所以我想尝试制作一个简单的计算器，它并不特定于像 + 这样的符号。无论如何，我不太确定为什么这不起作用，因为据我所知，我做的一切都是正确的。

```
import java.util.Scanner;

public class calculator2 {

    public static void main(String args[]){

        Scanner tom = new Scanner(System.in);
        double fnum, snum, answer;
        int symbol;

        System.out.println("Enter First Number");
        fnum = tom.nextDouble();

        System.out.println("Enter Comand, 1 = add, 2 = subtract, 3 = divide, 4 = multiply");
        symbol = (int)tom.nextDouble();

        System.out.println("Enter Second Number");
        snum = tom.nextDouble();

        switch (symbol){

        case 1:         
            answer = fnum + snum;

        case 2:         
            answer = fnum - snum;

        case 3:         
            answer = fnum / snum;

        case 4:         
            answer = fnum * snum;       
        }

        System.out.println(answer);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:29:15.940

这是因为您没有初始化`answer`变量，并且您的`switch`语句缺少`default`分配它的案例。Java 编译器的理由是，如果`symbol`不是，那么在您将其传递给时将保持未初始化*状态* 。`1..4``answer``println`

您可以`answer`在声明时设置一些初始值，或者`default`在`switch`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:30:43.000

在声明变量（初始化它）时为其分配一个默认值，或者为开关提供一个默认情况：

选项1：

```
double answer = 0; 
```

选项 2：

```
switch(symbol) {
    case 1:
        ...
    default:
        answer = 0;
} 
```

请注意，您的代码中有一个严重的错误：您的案例的每个代码块都应该以 结尾`break;`，即

```
switch(symbol) {
case 1:
    answer = fnum + sum;
    break;
etc
default:
    answer = 0;
} 
```

否则，以下情况的所有代码也会被执行。开关盒就像一个 goto。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T19:30:00.660

当你声明它们时，你需要给 fnum、snum、answer 一个符号一个值，否则 java 不能保证它有一个值可以在进一步的计算中使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T19:40:03.483

或者你为你的 switch 语句添加一个默认子句，或者你需要初始化你的*answer*变量。

此外，由于“切换失败”，您的代码可能有问题。当case语句中的条件满足时，后面的case语句也会被执行，直到有break（或return）语句。

如果我处于您的情况，我会编写如下代码：

```
double fnum = 0, snum = 0, answer 0;
int symbol = 0

...

switch (symbol){

    case 1: 

        answer = fnum + snum; break;

    case 2:

        answer = fnum - snum; break;

    case 3:

        answer = fnum / snum; break;

    case 4:

        answer = fnum * snum; break;
    default:

    } 
```

# c++ - 转换和验证字符串

> ID：14005842
> 
> 赞同：1
> 
> 时间：2012-12-22T19:25:58.823
> 
> 标签：c++, algorithm, console-application, std

我需要花时间以 HH:MM 形式作为用户输入，然后对其进行验证。它需要以某种形式出现在适当的时间。关于如何做到这一点的任何好主意？

我正在尝试创建一个函数来遍历字符串，验证每个字符，然后将它们转换为数字（或某种时间戳），以便我可以将多个字符串相互比较。

我只使用 std 命名空间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:28:26.250

使用 boost::regex 匹配字符串及其部分 (HH) 和 (MM)，并使用 scanf 获取小时和分钟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T19:31:22.173

这听起来更像是一个算法问题，我会：

1，检查字符串的长度是否为5。
2，检查'：'是否在中间。
3、检查HH是否在范围内。
4、检查MM是否在范围内。
5、转换成方便你的格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T22:30:24.527

对于这个特定的问题，它可能是矫枉过正，但这种任务非常适合状态机。基本上，您需要一次读取一个字符，每个字符都可以更改机器的状态，直到您最终处于成功或错误状态。例如：

1.  第一个字符
    *   如果不是数字，则更改为错误状态
    *   否则存储值并更改为状态 2
2.  第二个字符
    *   如果不是数字，则更改为错误状态
    *   否则将存储的值乘以 10 并添加第二个字符。如果结果超出范围，则更改为错误状态。否则，更改为状态 3
3.  第三个字符
    *   如果`:`，则更改为状态 4，否则更改为错误状态
4.  第四个字符
    *   与第一个字符类似，成功后变为状态 5。
5.  第五个字符
    *   类似于第二个字符，成功后变为状态 6。
6.  成功状态
    *   赢家是你！
7.  错误状态
    *   处理错误，呵呵。

# java - 日志4j。唯一的日志文件名

> ID：14005845
> 
> 赞同：3
> 
> 时间：2012-12-22T19:26:34.863
> 
> 标签：java, log4j

如何使用`log4j`? 创建唯一命名的日志文件。当我使用 时`Logback`，我可以这样做：

```
 <!-- current time formatted as "yyyyMMdd'T'HHmmss".  This value will be available to all 
    subsequent configuration elements. -->
<timestamp key="bySecond" datePattern="yyyyMMdd'T'HHmmss" /> 
```

并在 logger appender 内部定义文件名模式：

```
<file>${bySecond}.log</file> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T17:01:06.943

将[`DailyRollingFileAppender`](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/DailyRollingFileAppender.html)当前日期附加到滚动到下一个文件之后，因此您将获得一个唯一的名称，该名称以每个文件的日志日期结尾。引用 JavaDoc：

> 例如，如果 File 选项设置为 /foo/bar.log 并且 DatePattern 设置为 '.'yyyy-MM-dd，则在 2001 年 2 月 16 日午夜，日志文件 /foo/bar.log 将是复制到 /foo/bar.log.2001-02-16 并记录 2001-02-17 将继续在 /foo/bar.log 中，直到它在第二天滚动。

将类似[这样](https://stackoverflow.com/a/192548/1515052)的内容添加到您的属性 XML 文件中：

```
<appender name="roll" class="org.apache.log4j.DailyRollingFileAppender">
    <param name="File" value="application.log" />
    <param name="DatePattern" value=".yyyy-MM-dd" />
    <layout class="org.apache.log4j.PatternLayout"> 
      <param name="ConversionPattern" 
          value="%d{yyyy-MMM-dd HH:mm:ss,SSS} [%t] %c %x%n  %-5p %m%n"/>
    </layout>
  </appender> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:37:56.650

我相信 log4j 1.7 开箱即用不支持此功能。但是您可以通过更改参数来扩展[`RollingFileAppender`](http://www.docjar.com/html/api/org/apache/log4j/RollingFileAppender.java.html)'s方法以支持基于时间的功能。`setFile``fileName`

# java - 无法在 Java 中连接到 MySQL 数据库

> ID：14005848
> 
> 赞同：1
> 
> 时间：2012-12-22T19:26:48.550
> 
> 标签：java, mysql, eclipse

> **可能重复：**
> [Java 连接到远程 MySQL 数据库](https://stackoverflow.com/questions/7747597/java-connecting-to-remote-mysql-database)

我正在尝试使用以下代码连接到 Eclipse 和 Java 中的 MySQL 数据库：

```
System.out.println("MySQL Connect Example.");
      Connection conn = null;
      String url = "jdbc:mysql://localhost:3306/";
      String dbName = "RS";
      String driver = "com.mysql.jdbc.Driver";
      String userName = "root"; 
      String password = "root";
      try {
      Class.forName(driver).newInstance();
      conn = DriverManager.getConnection(url+dbName,userName,password);
      System.out.println("Connected to the database");
      conn.close();
      System.out.println("Disconnected from database");
      } catch (Exception e) {
      e.printStackTrace();
      } 
```

但是，我收到以下错误：

```
 MySQL Connect Example.
java.lang.ClassNotFoundException: com.mysql.jdbc.Driver
    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:186)
    at Expertise.main(Expertise.java:57) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T19:29:56.233

您需要将 mysql jdbc 驱动程序 jar 添加到您的类路径中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T19:34:00.863

从这里下载 mysql-connector 到本地目录[http://www.mysql.com/products/connector/](http://www.mysql.com/products/connector/)

1.  转到 Eclipse 并通过右键单击它来选择您的项目。
2.  然后将显示一个弹出菜单。在那里查找项目属性并选择它。
3.  将出现属性窗口，在左侧查找项目 Java Build-path 选择它
4.  然后在窗口右侧，您将看到一个带有“添加库”标题的按钮。单击它并查找您刚刚下载的 .jar 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T19:34:45.310

1.  确保 MySQL jar 在您的类路径中
2.  确保您在课堂上有正确的导入。

# javascript - 有没有办法在opera mini中模拟“Enter”键？

> ID：14005850
> 
> 赞同：2
> 
> 时间：2012-12-22T19:26:55.540
> 
> 标签：javascript, opera-mini

在阅读了一些文档后，我了解到 Opera mini 不支持按键事件。不过我对一件事很好奇：输入文本时，我们使用手机的文本输入法，然后以一种或另一种方式按下“确定”。有什么方法（甚至是特定于浏览器的）来模拟可以测试 13 keyCode 的 keydown 侦听器吗？

我正在使用最简单的方法来捕捉事件（我知道这是基本的，它适用于一个超级简单的项目）

```
<input type="text" id="query" onkeydown="if (event.keyCode == 13) document.getElementById('btnSearch').click()" /> 
```

注意：我使用的是 Opera mini 4.4，但出于好奇，我会接受任何版本的技巧 :)

**编辑**：当听众在场时，肯定会发生一些事情，Opera 做了一些“处理”，这意味着它正在执行客户端代码。如果我删除监听器，处理就会消失。尽管如此，我仍然无法让它执行任何操作。它只是处理并返回页面顶部

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-01T17:41:31.187

`Keydown`是Opera Mini 中[不支持的 DOM 事件](http://dev.opera.com/articles/view/opera-mini-and-javascript/#unsupporteddom)。使用事件更改您的应用程序会更好`change`，但输入键不会触发更改事件。您可以尝试方法，但恕我直言，`document.createEvent`它也不起作用。`initKeyboardEvent``keydown`

# java - 自定义线程本地随机数生成器

> ID：14005853
> 
> 赞同：0
> 
> 时间：2012-12-22T19:27:21.240
> 
> 标签：java, concurrency, executorservice, prng

到目前为止，我一直只是用老式的方式创建自己的线程（在 1.5 java 并发之前）。但我想看看 Executors 和其他东西。我基本上知道如何使用它们，但就我而言，我需要每个线程都有自己的随机数生成器。我知道 Java 1.7 具有 ThreadLocalRandom 这正是我想要实现的，但使用我自己的 PRNG（无论是 QMC 还是其他任何东西）。

再说一遍：

我想创建一个由 8 个线程组成的执行器池，并给它一堆任务，这些任务使用我自己的随机生成器，每个线程都是本地的（每个线程都有自己的实例，用不同的种子创建）。最好的方法是什么？最好是最干净、性能最好的。ThreadLocal 也许？我从来没有用过它，但谁知道......

谢谢，迈克尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:42:39.910

如果您需要每个线程都有自己的 RNG，使用 ThreadLocal 可能是最简单的方法。

然而，在我看来，这不是一个非常干净的解决方案，因为它将属于执行程序的线程与特定任务耦合在一起。我认为总的来说，将 RNG 分配给任务对象会更有意义。

有了给出的附加信息，我认为最好的办法是创建一个类，即 MyTask，实现 Runnable，它表示从列表中读取图像区域、处理它们，然后继续下一个的任务。当没有更多区域要处理或遇到错误时，任务将完成。MyTask 将有自己的私有 RNG 用于图像生成。

```
MyTask  implements Runnable {
    private final Random random;
    // Queue is shared
    private final Queue<ImageArea> areasToProcess;

    public MyTaks(Random random, Queue<ImageArea areasToProcess) {
        this.random = random;
        this.areasToProcess = areasToProcess;
    }

    public void run() {
        ImageArea areaToProcess;
        while((areaToProcess = areasToProcess.poll()) != null) {
            process(areaToProcess);
        }
    }
} 
```

使用这样的可运行类，您可以轻松地直接使用线程或 ExecutorService。请注意，该类假定包含要处理的图像区域的队列在处理开始之前已填满。

# git - 合并后分支如何处理

> ID：14005854
> 
> 赞同：422
> 
> 时间：2012-12-22T19:27:40.947
> 
> 标签：git, merge, branch

我有两个分支：`master`和`branch1`. 我刚刚合并`branch1`回来`master`，我已经完成了那个分支。我应该删除它还是让它坐在那里？删除它会导致任何数据丢失吗？

* * *

## 回答 #1

> 赞同：500
> 
> 时间：2012-12-22T19:32:20.253

合并后，删除分支是安全的：

```
git branch -d branch1 
```

此外，如果 git 认为你还没有完全合并它，它会警告你（并拒绝删除分支）。`git branch -D`如果您强行删除尚未完全合并的分支（带有），您必须采取一些技巧来恢复未合并的提交（见下文）。

不过，有一些理由保留一个分支。例如，如果它是一个功能分支，您可能希望能够对该功能仍然在该分支内进行错误修复。

如果您还想删除远程主机上的分支，您可以执行以下操作：

```
git push origin :branch1 
```

这将强制删除远程上的分支（但这不会影响已经签出的存储库，也不会阻止任何具有推送访问权限的人重新推送/创建它）。

* * *

`git reflog`显示最近签出的修订。您在最近的存储库历史记录中签出的任何分支也将显示在那里。除此之外，`git fsck`它将成为 git 中任何提交丢失情况下的首选工具。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2015-07-29T02:20:31.677

我更喜欢**重命名**而不是**删除**

我所有的分支都以以下形式命名

*   `Fix/fix-<somedescription>`或者
*   `Ftr/ftr-<somedescription>`或者
*   等等

使用 Tower 作为我的 git 前端，它将所有 , 等整齐地组织`Ftr/`到`Fix/`文件`Test/`夹中。
完成分支后，我**将**它们重命名为`Done/...-<description>`.

这样它们仍然在那里（可以方便地提供历史记录），我总是可以回去知道它是什么（功能、修复、测试等）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-10-23T05:35:12.030

如果您在合并后删除分支，请注意您的 DELETED 分支的所有超链接、URL 和引用都将是**BROKEN**。

# javascript - Backbone - 未定义的请求正文

> ID：14005860
> 
> 赞同：1
> 
> 时间：2012-12-22T19:28:26.783
> 
> 标签：javascript, node.js, backbone.js, restify

这一定是我不能正确理解的东西。

我有一个名为 Album 的 Backbone 模型：

```
var Album = Backbone.Model.extend({
idAttribute: "_id",
urlRoot: "http://localhost:8000/albums",
defaults:{
    "_id": null,
    "title": "",
    "year": "",
    "genre": ""
    }
}); 
```

我有一个使用 Restify 的 Node.js 服务器：

```
var server = restify.createServer();
server.put('/albums/:id', putAlbum); //putAlbum is a function defined above.
server.use(restify.bodyParser({ mapParams: false })); 
```

我的问题是，当我保存现有的专辑模型时（以及当我使用集合中的 create 方法发布新模型时），服务器会收到请求并调用正确的函数，但是当我这样做时：

```
console.log(req.body); 
```

身体是“未定义的”。我总是试图检查 params 属性，但它只有 id 。是我配置错误吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T19:32:37.820

在调用路由处理程序之前重新排序代码以解析正文：

```
var server = restify.createServer();
server.use(restify.bodyParser({ mapParams: false }));
server.put('/albums/:id', putAlbum); 
```

# windows-phone - 清除 FlipTileData 背景图片

> ID：14005862
> 
> 赞同：3
> 
> 时间：2012-12-22T19:28:30.680
> 
> 标签：windows-phone, windows-phone-8

我有一个定期任务来更新我的动态磁贴。基本上它看起来像这样：

```
 var tileData = new FlipTileData()
    {
        BackgroundImage = mediumFrontUrl,
        BackBackgroundImage = mediumBackUrl,
        WideBackgroundImage = wideFrontUrl,
        WideBackBackgroundImage = wideBackUrl
    };

    ShellTile primaryTile = ShellTile.ActiveTiles.First();
    if (primaryTile != null)
    {
        primaryTile.Update(tileData);
    } 
```

在某些情况下，我不想显示背景图像和宽背景图像。如何清除值？简单地设置东西`null`是行不通的（它只是保留以前的东西）。根据文档，如果我使用 XAML 创建我可以设置的活动磁贴`Action="Clear"`。我如何在代码中设置它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T22:18:42.587

您可以清除每个 Tile 属性的属性。

对于 BackBackgroundImaga，它是空 URI：BackBackgroundImage = new Uri("", UriKind.Relative)

有关 Windows Phone 的 msdn 页面瓷砖概述的更多信息：http: [//msdn.microsoft.com/en-us/library/hh202948%28v=vs.92%29.aspx](http://msdn.microsoft.com/en-us/library/hh202948%28v=vs.92%29.aspx)

希望这有助于最好的问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T12:37:36.427

和齐克

一招而已。使用 WideBackContent 并放置我自己的图像（我有更多的可能性使用这个方法）我在重置 WideBackContent 时遇到了问题。帮助我的不是 WideBackContent =""，而是 WideBackContent = " " 所以，一个空白就解决了我的问题。此致

# sql-server-2005 - 总结玩家的时间并选择前5名

> ID：14005865
> 
> 赞同：1
> 
> 时间：2012-12-22T19:28:58.810
> 
> 标签：sql-server-2005

我想总结一下玩家的时间，选择前5名，请问可以帮我查询吗？

```
peter 10
peter 2
paul 3
paul 6
.
.
.
. 
```

要修复的 sql 2005 查询：

```
select top 5 sum(time),player from TimeLog order by time desc 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:30:36.933

你快到了，但你的陈述有两个问题

*   你错过了一个`GROUP BY`条款
*   由于您想要前 5 名玩家的时间，因此`ORDER BY`应该根据每个玩家的时间总和而不是每个单独的时间来完成。

然后最后的语句变成

```
SELECT TOP 5 player, SUM(time) 
FROM   TimeLog 
GROUP BY 
       player 
ORDER BY 
       SUM(time) DESC 
```

# css - 使用填充而不是宽度（或高度）来构建 div 是一种好习惯吗？

> ID：14005869
> 
> 赞同：5
> 
> 时间：2012-12-22T19:29:30.710
> 
> 标签：css, html, height, width, padding

我有下一个 CSS

```
.button {
width:0; 
height:18px; 
padding: 8px 0px 2px 30px; 
overflow:hidden;
transition: padding .5s ease;
}
.button:hover {
padding: 8px 170px 2px 35px
} 
```

我有这个简单的 html

```
<div class="button"> A text </div> 
```

我正在寻找仅在一个 div 中创建，如果您将鼠标悬停在一个白框上，它会向右展开以平滑地显示文本。

这就是问题所在：

**在这些情况下，一个好的做法是用宽度/高度替换填充吗？还是将文本放在不同的div中并使用相应的宽度和高度而不是填充更好？**

我不知道我是否解释清楚

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-23T20:34:26.353

通常最好使用填充，因为按钮将支持不同的文本长度，并让填充根据按钮内的文本控制宽度和高度，但是，如果您希望按钮为一种尺寸且仅一种尺寸，例如：A带有提交的按钮和带有下载的按钮将有 2 种不同的尺寸，如果您将它们并排显示，您可能希望它们的尺寸彼此相同，在这种情况下，设置宽度、高度会更理想。

我个人更喜欢填充，但如果您希望所有按钮的大小相同，请手动设置它们。

顺便说一句，您不需要使用 height:18px 或 Width:0; 只需删除这些值并设置填充以控制这些值并在按钮内使用跨度。

例子：

```
<p>Simple - One Button</p>
<div class="button"><span>A Button</span></div>

<p>3 Simple Buttons with Float Elements</p>
<div class="button floatleft"><span>A Button</span></div>
<div class="button floatleft"><span>A Button</span></div>
<div class="button floatleft"><span>A Button</span></div>
<div class="clearfix"> </div>

p {padding:15px 5px;}
.button {position:relative;transition:padding .5s ease;padding:5px;}
.button.floatleft {float:left;}
.button span:hover {padding:5px 20px 5px;}
.button span {background:#ccc;padding:5px;color:white;}
.clearfix {clear:both;} 
```

这是我 5 分钟前为您制作的东西：[JsFiddle](http://jsfiddle.net/yrgnW/)

希望这可以帮助。

# list - 循环遍历工作表 2 上的列表并从工作表 1 取回信息所需的宏

> ID：14005871
> 
> 赞同：1
> 
> 时间：2012-12-22T19:29:39.197
> 
> 标签：list, macros, summary

我经常使用这个网站来解决复杂的 Excel 问题，并且发现知识库令人震惊 - 谢谢 :)

现在我有一个“难以解释”的 Excel 查询，希望有人能提供帮助——我会尽力解释它。

我有一张 Excel 表格，用于在 B1 单元格中输入证券交易所代码（例如 VOD.L）

然后，该表为我从互联网上提取了大量有关该特定股票的信息。

由于每张纸的复杂性和大小，简单地创建 500 张是不可维护的。

我有一个包含 500 个股票代码的列表，这就是我想做的：

*   对于列表 A 列中的每个条目（存储在工作表 2 上）
    放入工作表 1 的 B1

*   提取数据后（大约需要 2 秒） - 将单元格 AE200 中的数据发送回表 2 到 Col B。

这可能吗？

提前感谢您的帮助。

肖恩

# wpf - 没有 ObservableCollection 的 Wpf 更新 UI

> ID：14005872
> 
> 赞同：1
> 
> 时间：2012-12-22T19:29:41.560
> 
> 标签：wpf, bytearray, observablecollection

我有一个具有字节数组属性的客户类。应用程序使用字节数组作为图像源。当我更改此数组时，UI 不会更新（因为 byte[] 不是 ObservableCollection）。

我什么时候可以强制刷新 UI？

编辑：图像保存为字节数组，因为它位于 DB（varbinary（MAX））中。我尝试将类型更改为 IList 但在 nhibernate 中弹出错误：无法确定 System..IList 的类型

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:33:29.600

让你的班级实施[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)

一旦 Byte 数组发生变化，就引发`PropertyChanged`事件。

例如：

```
class Customer : INotifyPropertyChanged
{
    private byte[] byteArray;

    public byte[] ByteArray
    {
        get
        {
            return byteArray;
        }
        set
        {
            if (value != byteArray)
            {
                byteArray = value;
                RaisePropertyChanged("ByteArray");
            }
        }
    }

    private void RaisePropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName);
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

# visual-c++ - 防止应用程序崩溃 HRESULT

> ID：14005873
> 
> 赞同：0
> 
> 时间：2012-12-22T19:29:42.177
> 
> 标签：visual-c++, mfc

我有一个大问题，希望能得到你的帮助。我有一个名为**pRstEmployDB的****_RecordsetPtr**变量。在我的代码中，我有一行可以打开 Recordset

```
pRstEmployDB->Open("SOCIETE", _variant_t((IDispatch *) theApp.pConEmployDB, true),  adOpenStatic, adLockReadOnly, adCmdTable); 
```

问题是当这个函数崩溃（访问冲突）时，它会显示一个消息框来说明发生了错误并崩溃。我怎样才能捕捉到错误，以便程序不再崩溃并被关闭？

我尝试使用 ASSERT(... ==S_OK) 但也崩溃了。

我也试过这种方法，但没有希望

```
Try
{
 pRstEmployDB->Open("SOCIETE", _variant_t((IDispatch *) theApp.pConEmployDB, true),   adOpenStatic, adLockReadOnly, adCmdTable);
}
catch (CException* e)
{
  return FALSE;
} 
```

供参考：打开函数的代码。(msdao15.tli)

```
inline HRESULT Recordset15::Open ( const _variant_t & Source, const _variant_t & ActiveConnection, enum CursorTypeEnum CursorType, enum LockTypeEnum LockType, long Options ) {
    HRESULT _hr = raw_Open(Source, ActiveConnection, CursorType, LockType, Options);
    if (FAILED(_hr)) _com_issue_errorex(_hr, this, __uuidof(this));
    return _hr;
} 
```

# javascript - 将标头插入数据 URI？

> ID：14005879
> 
> 赞同：2
> 
> 时间：2012-12-22T19:30:07.210
> 
> 标签：javascript, download

我正在尝试在以 .csv 扩展名下载的 JavaScript 中动态创建数据，但无法将文件名与下载相关联。这是一个代码片段：

```
var data = '1,2,3';
window.location = 
    "data:application/csv;charset=UTF-8;content-disposition:attachment;filename=export.csv," 
    + encodeURIComponent(data); 
```

这会下载，但文件名是通用的，没有 .csv 扩展名。

我可以使用以下 PHP 代码在服务器端执行此操作：

```
<?php
   header('Content-type: text/csv');
   header('Content-disposition: attachment;filename=export.csv');
   echo "1,2,3";
?> 
```

此外，如果我背对墙，我可以修改我的 Javascript 以将 Ajax 发送到服务器并得到它作为回报，但我更喜欢纯 Javascript 解决方案。是否有独立于浏览器、无 Flash 的方式来执行此操作？

***编辑***

有人指出这个问题可能是重复的。我做了很好的努力并检查了以前的 SO 文章。我仍然在问这个问题，因为这些问题已经过去了一段时间，所以我希望：

1.  浏览器功能可能发生了有利的变化。
2.  较旧的浏览器限制较少，因此某些解决方案现在可能比以前提出问题时更可行。

此外，如果它使问题更明显，我特意询问是否将一种内容标头插入数据 URI（根据主题），这是对其他问题的一个转折。

提前致谢。

# java - 我想制作受密码保护的 android 应用程序

> ID：14005896
> 
> 赞同：1
> 
> 时间：2012-12-22T19:31:34.877
> 
> 标签：java, android, if-statement, passwords

我想制作受密码保护的 android 应用程序，但是在这个简单的程序系统中，两个字符串不匹配。

```
package com.pokmgr;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.text.Editable;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;

public class MainPM extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.pm_layout);

        final EditText pin = (EditText) findViewById(R.id.pinET); 
        final String pass = pin.getText().toString();
        final String code = "ajaj";
        Button enter = (Button) findViewById(R.id.enterBtn);
        enter.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                if (pass.equals(code)) {
                    Intent in = new Intent(MainPM.this, Menu.class);
                    startActivity(in);
                }
                else {
                    Intent in = new Intent(MainPM.this, Menu2.class);
                    startActivity(in);
                }

            }
        });
    }

    /*@Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.pm_layout, menu);
        return true;
    }*/
} 
```

我已经制作了 Menu 和 Menu2 类，但每次访问 Menu2 类。即使我输入了“ajaj”[在此代码中进行测试]，我已经在清单文件中定义了这两个活动。

不明白为什么 pass.eqals(code) 不起作用

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T19:38:26.000

问题是您正在设置活动创建时`pass`的内容。`EditText`相反，您必须`EditText`检索`OnClickListener`.

像这样：

```
public void onClick(View v) {
    final String pass = pin.getText().toString();
    if (pass.equals(code)) {
        // do something
    } else {
        // do something different
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T19:39:10.340

放在`pin.getText().toString();`里面。`onClick`_ 在用户实际在*EditText*`button`中输入内容之前，您正在设置变量。`pass``pinEt`

# python - 我不理解 Euler 项目中的元素 103？

> ID：14005902
> 
> 赞同：0
> 
> 时间：2012-12-22T19:31:50.473
> 
> 标签：python

通过欧拉项目，我正在慢慢解决我的问题。我遇到了[问题 103](https://projecteuler.net/problem=103)，但我不了解集合的标准。给出的两个规则是（1），没有两个集合应该有相​​同的和，（2），如果一个集合的元素比另一个集合多，那么它的总和也更高。在这两种情况下，我希望这些将是最佳总和：

```
n=1:{1}
n=2:{1,2}
n=3:{1,2,3}
n=4:{1,2,3,4}
n=5:{1,2,3,4,5}
... 
```

我的逻辑哪里有问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:37:38.677

问题表明集合的任何子集都不能具有相同的和，因此在 n=3 中，如果我们取子集`{1, 2}`和`{3}`，它们具有相同的和 - 3。

我认为您是在比较整个集合，而问题是关于子集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:40:24.183

他们在问

> 任意两个非空不相交子集

# asp.net - ASP.NET 网页的性能测试 - 请求限制设置为 10

> ID：14005903
> 
> 赞同：0
> 
> 时间：2012-12-22T19:31:52.143
> 
> 标签：asp.net

为了测试可以同时处理多少个异步请求，我创建了一个示例控制台应用程序，它向我的 Web 应用程序发送请求：

```
 static void Main(string[] args)
    {
        const string url = "http://localhost/cip/AsyncPage.aspx";

        ThreadStart del = delegate
        {
            Console.WriteLine("Starting request");
            WebRequest request = WebRequest.Create(url);
            request.GetResponse();
            Console.WriteLine("Response ready");
        };

        for (int i = 0; i < 50; i++)
        {
            new Thread(del).Start();
        }

        Console.ReadLine();
    } 
```

AsyncPage.aspx 是一个 Async="true" 页面，包含一个从 1 到 10 循环的任务，每次迭代休眠 1 秒并写入响应虚拟数据（因此单个请求需要 10 秒）。

我注意到响应以 10 个批次返回。因此，10 秒后我收到 10 个响应，接下来的 10 秒后，我收到下 10 个响应。我用 Fiddler 做了类似的测试，结果是一样的 - 10 个请求似乎使用了所有 .... ASP.NET 资源？

我想知道哪个 ASP.NET 设置是造成这种行为的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:41:41.783

在这种情况下，消费者平台上的本地负载测试不是一个选项。

有请求限制的不是 ASP.NET，而是 IIS 本身，它取决于您运行的 Windows 版本。本质上，除非您在服务器平台上，否则您最多只能使用 10 个。

如果您真的想对此进行负载测试，最好的想法是在真实服务器上运行它，您可能可以虚拟化以获得您需要的东西，尽管您显然不会从虚拟化服务器获得真实世界的结果。

参考：[http ://technet.microsoft.com/en-us/library/cc268241.aspx](http://technet.microsoft.com/en-us/library/cc268241.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T16:33:05.673

对于 Microsoft 软件的工作站版本的 Windows 上的十个连接的硬限制可追溯到 1993/4。

从一个人的角度来看，这就是明显推动限制的原因。直到那时 (93/94)，Windows NT 在企业中的采用是由 Microsoft SQL Server 和 Microsoft SNA Server 这两个项目推动的。即使在非 Microsoft 环境（Banyan | Novell | Generic IP）中，这两种解决方案都可以在 Windows 的工作站版本上运行良好。从 SQL Svr 4.21 和类似日期的 SNA Server 版本开始，Microsoft 更改了服务器代码库，以便在 Windows 工作站版本上运行时只允许 10 个连接。毫不奇怪，由于组织必须购买服务器版本来支持现有服务器以实现与更新之前相同级别的功能，因此 NT Server 的采用率达到了顶峰。

此限制仅适用于在 Microsoft 平台上运行的 Microsoft 软件。因此，如果您将 Apache for Windows 或 ORACLE for Windows 放置在同一工作站版本的 Windows 上，那么您将不再局限于只有十个连接。您可以感谢 Redmond 的决定，这些决定对您的技术生活产生了积极影响。

# python - Django 查询 - 检索没有其他对象指向它们的对象

> ID：14005904
> 
> 赞同：3
> 
> 时间：2012-12-22T19:31:52.643
> 
> 标签：python, django

我有一个名为 String 的模型，它看起来像这样：

```
class String(models.Model):
    text = models.TextField()
    language = models.ForeignKey(Language, default=get_english)
    original_string = models.ForeignKey('self', null=True, blank=True) 
```

字符串的默认语言是英文，然后，在数据库的同一张表中，我有不同语言的翻译字符串，每个都指向对应的英文字符串`original_string`。

我需要的是检索没有与另一种语言相关的字符串的英文字符串，即没有翻译的字符串。

现在我正在遍历所有英文字符串并将我需要的字符串附加到列表中，例如：

```
translatable_strings = String.objects.filter(language__name="English")

strings = []

for string in translatable_strings:
    if not String.objects.filter(language=translator_lang,
                                 original_string=string).exists():
        strings.append(string) 
```

但我认为这是一段非常讨厌的代码。有没有办法在一个查询中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T19:46:32.157

**第一个条件**：语言是英文

**第二个条件**：不存在引用它的另一个字符串。

```
String.objects.filter( language = 'english', 
                       string__original_string__isnull = True ) 
```

需要[外键向后引用](https://stackoverflow.com/a/1115053/842935)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:40:51.520

试试这个

```
String.objects.filter(language__name="English", original_string__isnull=True) 
```

# c - 如何在 C 中获取 alt 和 control 键的扫描码？

> ID：14005907
> 
> 赞同：0
> 
> 时间：2012-12-22T19:31:56.480
> 
> 标签：c

> **可能重复：**
> [如何读取或捕获 C 中的 Ctrl+某个键或 Alt+某个键？](https://stackoverflow.com/questions/471980/how-to-read-or-capture-ctrlsome-key-or-altsome-key-in-c)

代码片段：

```
char ks;
ks=getch(); // getting the keystroke : if non ascii then 2 bytes returned : 1st 0 then //scancode
if(ks==0) // if there's no ascii then get the scan code 
ks=getch();
printf("%d",ks); // would print ascii if ks !=0 else scan code 
//end 
```

alt 和 control 键不输出，而 ctrl+e 输出为 5 。没看懂，求解释

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:43:56.850

`Ctrl, Alt, Shift`不是字符，不会在要读取的字符流中找到。

# c++ - 如何使用 .h 文件中的按钮单击事件调用 .cpp 的功能？

> ID：14005909
> 
> 赞同：1
> 
> 时间：2012-12-22T19:32:04.687
> 
> 标签：c++, button, onclick

在我的项目中有一个 .cpp 文件，其中包括 main() 函数和一个我想在按钮单击事件中从 Form1.h 调用的函数。

**我的代码：**

我的东西.cpp

```
main()
{

Application::Run(gcnew Form1());
return 0;
}

my_function()
{
 /code
} 
```

我的 Form1.h

```
namespace somthing {
    //auto generated code

   private: System::Void button1_Click(System::Object^  sender, System::EventArgs^  e)
   {  
       my_function();   
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:40:11.877

那是因为 .h 文件不知道 .cpp 文件的内容。

尝试在 .cpp 文件中声明 onClick 的主体。

# c++ - ISO C++ 禁止声明没有类型的“元组”

> ID：14005911
> 
> 赞同：9
> 
> 时间：2012-12-22T19:32:21.907
> 
> 标签：c++, g++, tuples, std, std-pair

当尝试编译一个简单的类 ( `g++ myclass.cpp`) 时，我收到以下错误：

> ISO C++ 禁止声明没有类型的“元组”

我搜索了这个问题，在大多数情况下，人们似乎忘记`std::`或包含`<tuple>`在标题中。但我两者都有。这是我的代码：

**我的班级.h**

```
#ifndef MYCLASS
#define MYCLASS

#include <iostream>
#include <tuple>

class MyClass {
    std::tuple<bool, int, int> my_method();
};

#endif 
```

**我的类.cpp**

```
#include "myclass.h"

using namespace std;

tuple<bool, int, int> MyClass::my_method() {
    return make_tuple(true, 1, 1);
} 
```

如果我`pair`改为使用相同的方法，省略第二个`int`并包括`<set>`，它可以工作。

我错过了什么？

**编辑：**

这是完整的输出：

> $ g++ myclass.cpp -o prog
> 在 myclass.cpp:1 中包含的文件中：
> myclass.h:7: 错误：ISO C++ 禁止声明没有类型
> myclass.h:7 的“元组”：错误：无效使用“： :'<br> myclass.h:7: 错误：预期 ';' 在'<'之前 token
> myclass.cpp:5: 错误: '<' 之前的预期构造函数、析构函数或类型转换 令牌
> 
> $ g++ --version
> i686-apple-darwin11-llvm-g++-4.2 (GCC) 4.2.1 (基于 Apple Inc. build 5658)
> (LLVM build 2336.11.00)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-22T20:00:06.630

每台 Mac 附带的 GCC 4.2.1 已经过时。它不会识别 C++11。

您需要使用以下命令编译代码：c++ 而不是调用 clang 的 g++，这是 mac 上官方更新的编译器。

```
c++ -std=c++11 -stdlib=libc++ myclass.cpp -o prog 
```

您需要链接 libc++，它是 clang lib，它知道 c++11 的特性，而不是 gcc 使用的默认 libstdc++。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-22T19:59:02.950

更新！这些天我们在 GCC 4.7 上。

GCC 4.2.1 是从[2007 年 7 月 18 日开始的](http://gcc.gnu.org/releases.html)。它支持C++11 中的*任何*特性的可能性很小。

也就是说，它可能会提供一些 in `std::tr1`(ie `std::tr1::tuple<T1, T2, ...>`)，这是标准化之前的一些 C++11 特性所在的地方，尽管我没想到这些只是在 4.4 中引入 GCC。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-22T20:08:48.813

使用 gcc 4.2，`tuple`位于 namespace 中`std::tr1`。您必须`<tr1/tuple>`或多或少像这样包含并指定您的方法

```
#ifndef MYCLASS
#define MYCLASS

#include <tr1/tuple>

class MyClass {
    std::tr1::tuple<bool, int, int> my_method();
};

#endif 
```

尽管正如其他人已经建议的那样，更新到更新的 gcc 可能更合适。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T19:52:40.987

如果添加`-std=c++11`（或，对于旧版本`g++`的`-std=c++0x`）选项并在成员函数中的表达式后添加分号，则代码编译。如果这不起作用，您可能有一个仅`tuple`在命名空间中定义的版本`std::tr1`（似乎，实现提供了一个`<tuple>`标头，因为没有关于`<tuple>`未找到的错误）。

# ruby-on-rails - 在 Rails 中使用 Markdown

> ID：14005913
> 
> 赞同：12
> 
> 时间：2012-12-22T19:32:26.573
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, markdown, erb

我希望用户在文本区域中输入 Markdown 文本，当他们发布它时，我会显示相应的 html。我读到 Rails 曾经有一个`markdown`方法或类似的方法，您可以在 ERB 文件中的该字段上调用它：

```
<%= markdown(@post.content) %> 
```

显然，Rails 取消了该功能。再次获得该功能的最佳方法是什么？这似乎解决了我的需求。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-22T19:39:47.077

我会使用[Redcarpet](https://github.com/vmg/redcarpet)进行 markdown-html 转换。此外，我会将转换从视图移动到其他对象。您可以使用[回调](http://guides.rubyonrails.org/active_record_validations_callbacks.html#callbacks-overview)（`before_save`）或使用[观察者](http://guides.rubyonrails.org/active_record_validations_callbacks.html#observers)。

从[文档](https://github.com/vmg/redcarpet#and-its-like-really-simple-to-use)：

```
markdown = Redcarpet::Markdown.new(Redcarpet::Render::HTML,
    :autolink => true, :space_after_headers => true)

markdown.render("This is *bongos*, indeed.")
#=> "<p>This is <em>bongos</em>, indeed</p>" 
```

您可能希望将结果存储在另一列中，例如`@post.content_parsed`以便用户可以稍后对帖子进行编辑，而且这样您就不需要对每个请求进行转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-12T03:06:36.893

提供的解决方案已变成宝石`emd`。[你可以在这里](https://github.com/ytbryan/emd)阅读更多

将这些行添加到应用程序的 Gemfile 中：

```
gem 'coderay' #optional for Syntax Highlighting
gem 'redcarpet'
gem 'emd' 
```

然后执行：

```
bundle 
```

要在代码块上创建 markdown 部分、查看或启用语法高亮，请访问[emd 的用法](https://github.com/ytbryan/emd#usage)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-23T11:10:00.353

这是我的解决方案

#### 宝石文件

```
gem "redcarpet" 
```

#### 配置/初始化程序/markdown_renderer.rb

```
module MarkdownRenderer
  def self.markdown
    @@markdown ||=
      Redcarpet::Markdown.new(
        Redcarpet::Render::HTML.new(
          escape_html: true,
          hard_wrap: true,
          safe_links_only: true,
          with_toc_data: true
        ),
        autolink: true,
        fenced_code_blocks: true,
        no_intra_emphasis: true,
        space_after_headers: true,
        tables: true
      )
  end

  def self.render(text)
    markdown.render(text)
  end
end 
```

#### app/helpers/application_helper.rb

```
def markdown(text)
  MarkdownRenderer.render(text).html_safe
end 
```

#### 你的看法

```
<%= markdown(@post.content) %> 
```

# android - Android 活动启动画面

> ID：14005919
> 
> 赞同：2
> 
> 时间：2012-12-22T19:33:32.627
> 
> 标签：android, android-activity

我有一个闪屏，它会在消失之前显示 2-3 秒。我想在加载下一个活动时添加淡入效果。我在 Facebook 黑客示例中看到了一个示例，我正在使用它。它使用了一个finish(); 如果有人单击返回，则从 DashboardActivity 结束该活动，它不会返回到 SplashAcitivty。但是使用它并不会创建如 API 演示示例中所示的淡入效果。

```
public class SplashActivity extends Activity {
    private long splashDelay = 3000;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);

        // Remove title bar
        this.requestWindowFeature(Window.FEATURE_NO_TITLE);

        // Remove notification bar
        /*
         * this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
         * WindowManager.LayoutParams.FLAG_FULLSCREEN);
         */

        setContentView(R.layout.activity_splash);

        TimerTask task = new TimerTask() {

            @Override
            public void run() {
                finish();
                startActivity(new Intent().setClass(SplashActivity.this,
                        MainActivity.class));
                overridePendingTransition(R.anim.fade, R.anim.hold);
            }
        };

        Timer timer = new Timer();
        timer.schedule(task, splashDelay);

    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T21:11:21.613

为此使用处理程序：

```
new Handler().postDelayed(new Runnable() {
    @Override
    public void run() {
        startActivity(new Intent(SplashActivity.this,
                MainActivity.class));
        overridePendingTransition(R.anim.fade, R.anim.hold);
        finish();
    }
}, splashDelay); 
```

# jquery - 在微小的 MCe 抛出错误中添加插件

> ID：14005922
> 
> 赞同：0
> 
> 时间：2012-12-22T19:34:02.060
> 
> 标签：jquery, tinymce

我正在添加一个名为 akindicplugin 的插件，以支持在我的 Tinymce 编辑器中输入的印度语言，我已从该站点获取该插件。 [http://amiworks.co.in/talk/akindicplugin-transliteration-in-indian-lanuguages-for-tinymce/](http://amiworks.co.in/talk/akindicplugin-transliteration-in-indian-lanuguages-for-tinymce/)

并按示例中所示的方式使用，但由于某些未知原因，它在 Firefox 控制台中抛出错误“ReferenceError：TinyMCE_Menu 未定义”

```
<script type="text/javascript">
tinyMCE.init({
        theme : "advanced",
        language : "en",
        mode : "specific_textareas",
        safari_warning : false,
        plugins : "advlink, advimage,  preview, visualchars, media, nonbreaking, akIndicPlugin",
        theme_advanced_buttons3_add : "styleprops, visualchars, media, nonbreaking, akIndicPlugin",
        debug : false,
        fullscreen_settings : {
            theme_advanced_path_location : "top"
        }
    });
</script> 
```

它已尝试编辑插件的插件 editor_plugin.js 文件，但似乎版本问题任何人都知道这会发生什么......

# java - 如何隐藏手/光标？

> ID：14005930
> 
> 赞同：0
> 
> 时间：2012-12-22T19:34:48.447
> 
> 标签：java, android, teechart

我想隐藏我的圆形仪表的手（那是中间的东西，对吗？）。到目前为止，我试过这个：

```
myCircularGauge.getHand().setVisible(false); 
```

但是，当绘制图表时，这似乎会产生崩溃。我怎样才能成功隐藏手？

*Choreographer.doCallbacks(int, long) 行：558*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T10:41:56.077

你用的是什么版本？这里使用 TeeChart Java for Android v3.2012.0808。

您是对的，以下内容似乎崩溃了：

```
getHand().setVisible(false); 
```

但是，这似乎工作正常：

```
getCenter().setVisible(false); 
```

我们将调查手的情况。感谢您报告它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:41:51.223

尝试将光标**替换**为 **gif 不可见**。

```
 int[] pixels = new int[16 * 16];

 Image image = Toolkit.getDefaultToolkit().createImage(new MemoryImageSource(16, 16, pixels, 0, 16));

 Cursor transparentCursor = Toolkit.getDefaultToolkit().createCustomCursor(image, new Point(0, 0), "Transparent");

 // set cursor 
 frame.setCursor(Cursor); 
```

# mongodb - 在 MongoDB 的聚合框架中对数组进行切片

> ID：14005934
> 
> 赞同：4
> 
> 时间：2012-12-22T19:35:26.120
> 
> 标签：mongodb

我将游戏结果保存在 MongoDB 中，并想计算每个玩家的 3 个最佳结果的总和。

使用聚合框架，我能够从我的已完成游戏数据库中构建以下中间管道结果（下面的每个玩家都完成了 5 场比赛并获得了分数）：

```
 {
        "_id" : "Player1",
        "points" : [ 324, 300, 287, 287, 227]
    },
    {
        "_id" : "Player2",
        "points" : [ 324, 324, 300, 287, 123]
    } 
```

现在我需要总结每个玩家的三个最佳值。我能够对数组进行排序，因此在这里也可以只获取每个数组的前 3 个元素，以在下一个管道步骤中构建数组的总和。

如果我只需要一个玩家的结果，$limit 就可以正常工作。我也尝试过使用 $slice ，但这似乎在聚合框架中不起作用。

那么如何获得每个玩家的三个最佳结果的总和呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T18:53:01.243

你提到过`it would also be ok here to get only the first 3 elements of each array to build the sum of the array in the next pipeline step.`，所以先这样做，然后使用：

```
db.test.aggregate({'$unwind':'$points'},{'$group':{'_id':'$_id','result':{'$sum':'$points'}}} 
```

得到结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-09T05:55:48.557

3.2 版本的 mongo 中添加[了聚合框架的 $slice 方法。](https://docs.mongodb.org/manual/release-notes/3.2-reference/#exp._S_slice)如需更详细的答案，请查看[此处](https://stackoverflow.com/a/33603226/1090562)。

还有来自 mongo 页面的几个例子：

```
{ $slice: [ [ 1, 2, 3 ], 1, 1 ] }   // [ 2 ]
{ $slice: [ [ 1, 2, 3 ], -2 ] }     // [ 2, 3 ]
{ $slice: [ [ 1, 2, 3 ], 15, 2 ] }  // [  ]
{ $slice: [ [ 1, 2, 3 ], -15, 2 ] } // [ 1, 2 ] 
```

# c++ - 如何使继承相同基类的类的虚拟方法弄清楚如何处理它们的参数？

> ID：14005935
> 
> 赞同：1
> 
> 时间：2012-12-22T19:35:35.180
> 
> 标签：c++, inheritance, polymorphism, abstract-class

这里用代码解释：

```
//Sphere and Box inherit from IShape
//
//Sphere methods:
//bool Sphere::Intersect(Sphere* sphere)
//bool Sphere::Intersect(Box* box);
//
//Box methods:
//bool Box::Intersect(Sphere* sphere)
//bool Box::Intersect(Box* box)

IShape* shapeA;
IShape* shapeB;

shapeA= new Sphere();
shapeB= new Box();

bool areTheyIntersecting = shapeA->Intersect(shapeB); //problem is here? 
```

这种使用多态性的方法会起作用吗，还是我必须寻找另一种方法来让类识别彼此的类型，以便他们知道要调用的正确方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:53:54.627

您描述的问题称为双重调度。有很多解决方案。他们都以各种方式吸吮。

它们糟糕的根本原因是双重调度的大小随着类型的数量呈二次方增长，而编写二次方数量的代码总是很糟糕。

一种方法是找出一种方法，将一般的双重分派减少为具有一些特殊情况（如球体球体）的单次分派。

如果类型数量有限，可以有两组虚函数。第一个将 other 作为抽象基类。另一组函数将每个实现类作为可能的参数。抽象基类在每个实现中都实现，调用另一个对象，并将 this 作为不将抽象基作为参数的“其他函数集”的第一个参数。

即，`collide(base* other)`调用`other->collideSpecific (this)`.

CRTP 可用于减少一些样板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:50:53.847

对于这种情况，您需要一种称为双重调度的东西。看看 Scott Meyers 的 More Effective C++ 和 Alexendrescu 的 Modern C++ Design。

这是另一篇也讨论它的文章 [http://www.drdobbs.com/double-dispatch-revisited/184405527](http://www.drdobbs.com/double-dispatch-revisited/184405527)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T20:16:10.657

一种解决方法是在每个类中声明 uint 变量（或从类中提取，见下文）和一个为相关对象返回此变量的虚函数。然后我会声明一个哈希`<std::pair<uint,uint>,std::function<bool(IShape*, IShape*)>>`

哈希将包含知道如何处理特定对象类型的函数，典型的调用如下：

```
auto key = std::pair<uint,uint>(obj1.typeNumber(), obj2.typenumber())
funchash[key](obj1, obj2); 
```

如本手册所示，该数字甚至不需要硬编码：http: [//shaderop.com/2010/09/uniquely-identifying-types-in-c-without-using-rtti/index.html](http://shaderop.com/2010/09/uniquely-identifying-types-in-c-without-using-rtti/index.html) 这基本上显示了如何将类名转换为类型 id。

当然，这仍然意味着很多样板，但我不喜欢在我的课程中使用它，而且这种类型的机制本身还是很有用的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T20:28:54.037

双重调度通常通过[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)使用，但在您的情况下，这有点奇怪，因为访问者本身就是元素......坚持住！

简而言之，这个想法：

*   从一对`IShape`/开始`IShape`，命名`left`并`right`从现在开始
*   在作为参数传递时调用该`intersect`方法，在该方法中知道它*的确切*类型（它是一个！）并通过调用on的正确重载来通知它（接受 a 的那个）`left``right``intersect``left`*`Sphere``right``intersect``right``Sphere`*
**   在`intersect`调用中`right`，`right`知道它的确切类型，*嘿*，我们也传递了确切的类型`left`，所以现在我们都知道了！*

 *一个简单的实现：

```
class IShape {
public:
    virtual ~IShape() {}

    virtual bool intersect(IShape const& other) const = 0;

    virtual bool intersect(Box const& other) const = 0;
    virtual bool intersect(Sphere const& other) const = 0;
}; // class IShape

class Box: public IShape {
public:
    virtual bool intersect(IShape const& other) const override {
        std::cout << "-> Box::intersect(IShape)\n";
        return other.intersect(*this);
    }

    virtual bool intersect(Box const& other) const override {
        std::cout << "-> Box::intersect(Box)\n";
        /* compute intersection of two boxes */
        return false;
    }

    virtual bool intersect(Sphere const& other) const override {
        std::cout << "-> Box::intersect(Sphere)\n";
        /* compute intersection of a box and a sphere */
        return false;
    }
}; // class Box

// Likewise implementation of Sphere 
```

一个[完整的实现](http://liveworkspace.org/code/2X3kgs%242)给出了这个输出：

```
int main() {
   Box const box;
   Sphere const sphere;
   IShape const& ibox = box;
   IShape const& isphere = sphere;

   box.intersect(sphere);
   // output
   // -> Box::intersect(Sphere)

   ibox.intersect(sphere);
   // output
   // -> Box::intersect(Sphere)

   sphere.intersect(ibox);
   // output
   // -> Sphere::intersect(IShape)
   // -> Box::intersect(Sphere)

   isphere.intersect(ibox);
   // output
   // -> Sphere::intersect(IShape)
   // -> Box::intersect(Sphere)
} 
```

这种策略被命名为双重分派，因为从 IShape/IShape 开始时有两个连续的双重分派，每个变量一个分派，需要为其“推导”动态类型。*

# android - ListView 需要 2 个 setSelection 才能滚动到项目

> ID：14005936
> 
> 赞同：2
> 
> 时间：2012-12-22T19:35:45.823
> 
> 标签：android, listview, android-cursoradapter, android-listfragment

我在 listfragment 中使用 cursoradapter 时遇到的特殊问题。

在我的 onLoadFinished 中，我选择了先前选择的项目，以便将列表视图滚动到上一个位置（然后突出显示该项目）。

除了滚动部分之外，这非常有效。

**如果我只使用一个帖子并延迟它（甚至说 5 秒），则该项目被选中但列表不会滚动（此时所选项目可能不在视图中）** 有或没有延迟与只有一个帖子相同的行为。

我必须再次发布 setSelection 以使列表视图滚动，以便选中的项目在视图中。

我延迟第一个或第二个滚动帖子多长时间都没关系。

这是我肮脏的解决方法，但我对此并不满意。有任何想法吗？

```
@Override
public void onLoadFinished(Loader<Cursor> loader, Cursor data) {
    mAdapter.swapCursor(data);
    getListView().post(new Runnable() {
        @Override
        public void run() {
            getListView().requestFocusFromTouch();
            getListView().setSelection(selectedposition);
            getListView().performItemClick(getListView().getAdapter().getView(selectedposition, null, null), selectedposition, selectedid);
            getListView().clearFocus();
        }    
    });
    getListView().postDelayed(new Runnable() {
        @Override
        public void run() {
            getListView().requestFocusFromTouch();
            getListView().setSelection(selectedposition);
            getListView().performItemClick(getListView().getAdapter().getView(selectedposition, null, null), selectedposition, selectedid);
            getListView().clearFocus();
        }    
    }, 500);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:59:11.983

**改写：**

> 如果我将它们从 runnable 中取出，它只需调用一次 setselection 即可。但是，我没有得到延迟滚动效果（向用户显示它滚动），我想我有点喜欢。

当我仔细查看您的代码时，我注意到您正在`getView()`手动调用适配器。适配器以非常特殊但不可预测的顺序回收他们的视图，并且尝试调用`getView()`自己可能会产生不需要的行为......你应该避免这样做，尝试不同的策略：

```
@Override
public void onLoadFinished(Loader<Cursor> loader, Cursor data) {
    mAdapter.swapCursor(data); // or changeCursor(data) as explained below
    getListView().postDelayed(new Runnable() {
        @Override
        public void run() {
            ListView listView = getListView(); // Save a local reference rather than calling `getListView()` three times
            listView.setSelection(selectedposition);
            listView.performItemClick(listView.getChildAt(0), selectedposition, selectedposition);
        }
    }, 500);
} 
```

# c++ - 以编程方式将原始数据发送到打印机

> ID：14005940
> 
> 赞同：0
> 
> 时间：2012-12-22T19:36:16.263
> 
> 标签：c++, windows, visual-c++

我想将我从文件加载的数据发送到我的打印机，以便它可以打印条形码（ITF 2/5）。

如果我使用命令提示符并执行“print c:\test lpt1”，它就像一个魅力，它会打印预期的条形码。但是，当我尝试以编程方式执行此操作时，打印机无法提供所述条形码。可读文本工作正常，它（到目前为止）完全是我在条形码打印方面遇到的问题。

我有以下代码（我认为）我将发送打印机原始数据（不以任何方式呈现），以便打印机可以决定如何解码我发送给它的那些字节。

```
std::FILE* fd = fopen("c:\\test", "rb");
std::fseek(fd, 0L, SEEK_END);
int size = std::ftell(fd);
std::fseek(fd, 0L, SEEK_SET);
int beginning = std::ftell(fd);
if(fd == NULL)
{
    std::cerr << "Error opening file\n";
    return;
}
char* buffer = (char*)malloc(size);
std::fread(buffer, 1, size, fd);
std::ofstream output("lpt1", std::ios_base::out);
output << buffer; 
```

我唯一的猜测（而且是盲目的猜测）是我错误地假设 ofstream 正在接收原始数据，而事实并非如此......而且我不知道为什么或如何解决这个问题。

我不是在要求“为我做功课”的答案（尽管一个非常清晰和史诗般的答案会很棒），但至少如果你能以正确的方式指出我为什么没有得到预期的结果，我会真的很感激。甚至一些用于我自己搜索和研究的关键字也会很棒。老实说，我不知道我做错了什么。

这是我尝试使用 IOStreams 的一些新代码，再次，当我尝试编辑 input.rdbuf() 的内容时，我得到的不是预期的结果。

```
static void ImprimirArchivo(unsigned char* path)
{
    std::ifstream input((char*)path, std::ios::binary);
    std::ofstream output("lpt1", std::ios::binary);

    std::istreambuf_iterator<char> eos;
    std::istreambuf_iterator<char> streamInputIterator (input.rdbuf());

    bool codeBarStarted = false;
    int iterationsCounter = 0;
    while(streamInputIterator!=eos)
    {
        if(*streamInputIterator == 0x14)
        {
            output << '1d';
            output << '6b';
            output << '05';
            output << '30';
            codeBarStarted = true;
        }
        else
        {
            output << *streamInputIterator;
        }

        if(codeBarStarted)
        {
            iterationsCounter++;
            if(iterationsCounter == 10)
            {
                output << 0x00;
                codeBarStarted = false;
                iterationsCounter = 0;
            }
        }

        streamInputIterator++;
    } 
```

请注意，当我执行 if(*streamInputIterator == 0x14) { output << '1d'; 输出 << '6b'; 输出 << '05'; codeBarStarted = true; }

如果我用 if(*streamInputIterator == 0x14) { output << 0x1d; 输出 << 0x6b; 输出 << 0x05; codeBarStarted = true; }

相应的输出仍然是错误的，但完全不同。当我使用 0xXY 时，打印的是十进制数，如下所示： output << 0x1d 使打印机打印“29”（文本）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:58:49.363

dar 中的一个缺点：以二进制模式打开两个文件，特别是`std::ofstream`：

```
std::ofstream output("lpt1", std::ios::binary); 
```

（无需同时指定`std::ios::out`，因为它是在打开 a 时添加的`std::ofstream`，但您可以`std::ios::out | std::ios_binary`根据需要使用）。

就个人而言，我会将 IOStreams 用于输入和输出：

```
std::ifstream input("c:\\test", std::ios::binary);
if (input) {
    std::ofstream("lpt1", std::ios::binary) << input.rdbuf();
}
else {
    std::cerr << "ERROR: failed to open 'c:\\test' for reading\n";
} 
```

# algorithm - 这个谜题子集总和？

> ID：14005942
> 
> 赞同：2
> 
> 时间：2012-12-22T19:36:39.273
> 
> 标签：algorithm, language-agnostic, subset-sum

在今天的《卫报》（英国报纸）中，在 Chris Maslanka 第 43 页的“Pyrgic 谜题”部分，给出了以下谜题：

> 三位智者……去*赫罗德*做圣诞购物。Caspar 买了 Gold，Melchior 买了 Frankincense，Balthazar 买了一份*Daily Myrrh*。收银员输入了每件物品的欧元数，并打算将这三个数字相加，但是却将它们相乘。...令人惊奇的是，结果完全相同：65.52 欧元。三个总和是多少[我假设他的意思是三个*数字*]？

我的解释是：找到*a*、*b*和*c*使得*a* + *b* + *c* = *abc* = 65.52 （确切）其中*a*、*b*和*c*是不超过两位小数的正十进制数。因此*a*、*b*和*c*也必须小于 65.52（大约）。

*因此，我的方法是：我将找到a*、*b*和*c*的所有候选集，其中*a* + *b* + *c* = 6552 和*a*、*b*和*c*是 {1 ... 6550} 的整数（理论上我已经将所有操作数相乘为方便起见，减 100）。然后，对于所有候选集，通过将所有操作数除以 100 然后将它们相乘（使用任意精度算术）来满足另一个条件是微不足道的。

正如我所看到的，这是子集和问题的一个实例。所以我实现了一个脏（指数时间）算法，它找到了一个不同的解决方案：a=0.52，b=2，c=63。

好的，对于子集和问题有更好的算法，但你不认为这对于普通的卫报读者来说有点遥不可及吗？

第 40 页列出了答案：

> 这很容易，通过反复试验。猜猜*每日没药的*价格为 52 便士。但是乘以 0.52 大约是减半，所以我们需要一个和大约为 2；所以试试 2 X 63 X 0.52。等等瞧。这个答案是独一无二的吗？

好吧，我们知道答案是独一无二的（忽略 2、63 和 0.52 的其他排列）。

我想知道的是：这怎么可能“容易”？我将这个谜题描述为子集和问题的一个例子是否正确？我是否忽略了可用于简化解决方案的难题的某些特征？是否有人能够采用类似的“反复试验”方法，如果可以，他们可以带我完成吗？Chris Maslanka 是否对 NP 完全问题毫不畏惧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:42:19.367

不，它不是子集和问题的一个实例，因为：

1.  子集大小限制为 3，使其成为`O(n^3)`最坏情况的解决方案，使用天真的穷举搜索（而不是指数）
2.  这里有额外的数据，数字的乘积。
3.  您实际上并没有得到一个集合，所有整数的集合只是子集和的一个子问题，一个更容易的问题。

这里要理解的重要一点是：如果一个问题可以通过一个 NP-Hard 问题来解决——这并不意味着它也是 NP-Hard，反之亦然——如果你有一个问题，你可以解决一些NP-Hard问题（多项式），那么你的问题是NP-Hard。它被称为[多项式归约](http://en.wikipedia.org/wiki/Polynomial-time_reduction)¹。

* * *

该方法很简单，因为您所要做的就是“猜测”（通过迭代所有候选者） 的值`a`，并且从中您可以推导出`b`, `c`- （2 个变量，两个方程，如果`a`已知）的可能解决方案 - 并且在每次迭代 - 它是），因此解决方案甚至是线性的 - 不仅仅是次指数。

它甚至可能被优化为使用二进制搜索的变体来获得亚线性优化，但我目前无法想到这种优化。

* * *

(1) 注意：这是一些直观的解释，而不是正式的定义。

# java - NetBeans IDE 问题添加网格布局

> ID：14005944
> 
> 赞同：1
> 
> 时间：2012-12-22T19:37:07.440
> 
> 标签：java, netbeans, grid-layout, sudoku

![在此处输入图像描述](../Images/3b7f32ad95af7a7912d4e1b5bb03ebe0.png) 我已经使用 net beans program 创建了我的应用程序设计。我想添加一个类似于数独的 30*30 网格布局。实际上我正在尝试为地图绘制一个 30*30 的正方形。但是，我无法将该视图添加到我的代码中。我搜索了很多地方，但找不到答案。我对您的想法持开放态度。有人可以帮我解决这个问题吗？谢谢 ！

```
/*
* To change this template, choose Tools | Templates
* and open the template in the editor.
*/

import java.awt.Color;
import java.awt.Container;
import java.awt.Font;
import java.awt.GridLayout;

import javax.swing.JTextField;

public class NewJFrame extends javax.swing.JFrame {

/**
 * Creates new form NewJFrame
 */
public NewJFrame() {
    initComponents();
}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">
private void initComponents() {

    getDirectionButton = new javax.swing.JButton();
    questionTitle = new java.awt.Label();
    questionText = new javax.swing.JTextField();
    jScrollPane1 = new javax.swing.JScrollPane();
    directionDescriptionArea = new javax.swing.JTextArea();
    walkingManButton = new javax.swing.JButton();
    java.awt.Panel mapPanel = new java.awt.Panel();

    jButton1 = new javax.swing.JButton();

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
    setTitle("DSL For Streets\n");
    setPreferredSize(new java.awt.Dimension(1365, 730));

    getDirectionButton.setText("Get Direction");

    questionTitle.setFont(new java.awt.Font("Dialog", 3, 12)); // NOI18N
    questionTitle.setText("Please enter your question");

    directionDescriptionArea.setColumns(20);
    directionDescriptionArea.setRows(5);
    jScrollPane1.setViewportView(directionDescriptionArea);

    walkingManButton.setFont(new java.awt.Font("Tahoma", 3, 11)); // NOI18N
    walkingManButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("walk.png"))); // NOI18N
    walkingManButton.setText("Get Suggested Route");
    walkingManButton.setFocusable(false);

    jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("map.png"))); // NOI18N

    cells = new int[ROWS][COLS];
    tfCells = new JTextField[ROWS][COLS]; // allocate JTextField array

   // Container cp = getContentPane();
    //cp.setLayout(new GridLayout(ROWS, COLS));
mapPanel.setLayout(new GridLayout(ROWS, COLS));
    // Create 9x9 JTextFields and place on the GridLayout
    for (int row = 0; row < ROWS; row++) {
       for (int col = 0; col < COLS; col++) {
          tfCells[row][col] = new JTextField(); // allocate element of array
         mapPanel. add(tfCells[row][col]);  // ContentPane adds JTextField
          int number = puzzle[row][col];

          tfCells[row][col].setText("");  // empty
          tfCells[row][col].setHorizontalAlignment(JTextField.CENTER);
          tfCells[row][col].setFont(new Font("Monospaced", Font.BOLD, 20));
       }
    }

    javax.swing.GroupLayout mapPanelLayout = new javax.swing.GroupLayout(mapPanel);
    mapPanel.setLayout(mapPanelLayout);
    mapPanelLayout.setHorizontalGroup(
        mapPanelLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(mapPanelLayout.createSequentialGroup()
            .addGap(181, 181, 181)
            .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addContainerGap(239, Short.MAX_VALUE))
        .addGroup(mapPanelLayout.createSequentialGroup()

            .addGap(0, 0, Short.MAX_VALUE))
    );

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addGap(36, 36, 36)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                .addComponent(getDirectionButton, javax.swing.GroupLayout.PREFERRED_SIZE, 106, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(questionTitle, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 177, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(questionText, javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(jScrollPane1)
                .addComponent(walkingManButton, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 451, Short.MAX_VALUE))
            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(mapPanel, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addGap(46, 46, 46))
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGroup(layout.createSequentialGroup()
            .addGap(39, 39, 39)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addComponent(questionTitle, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(18, 18, 18)
                    .addComponent(questionText, javax.swing.GroupLayout.PREFERRED_SIZE, 36, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(18, 18, 18)
                    .addComponent(getDirectionButton, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(25, 25, 25)
                    .addComponent(walkingManButton, javax.swing.GroupLayout.PREFERRED_SIZE, 48, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 359, Short.MAX_VALUE))
                .addComponent(mapPanel, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
    );

    pack();
}// </editor-fold>

/**
 * @param args the command line arguments
 */
public static void main(String args[]) {
    /* Set the Nimbus look and feel */
    //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
    /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
     * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
     */
    try {
        for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (ClassNotFoundException ex) {
        java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
        java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        java.util.logging.Logger.getLogger(NewJFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    }
    //</editor-fold>

    /* Create and display the form */
    java.awt.EventQueue.invokeLater(new Runnable() {
        public void run() {
            new NewJFrame().setVisible(true);
        }
    });
}
// Variables declaration - do not modify
private javax.swing.JTextArea directionDescriptionArea;
private javax.swing.JButton getDirectionButton;
private javax.swing.JButton jButton1;
private javax.swing.JScrollPane jScrollPane1;
private javax.swing.JTextField jTextField3;
private javax.swing.JTextField questionText;
private java.awt.Label questionTitle;
private javax.swing.JButton walkingManButton;
private javax.swing.JTextField a[]=new JTextField[30];
// End of variables declaration

public static final int ROWS = 9; // ROWS by COLS cells
public static final int COLS = 9;
public static final int CELL_SIZE = 10; // Cell width/height
public static final int CANVAS_WIDTH = CELL_SIZE * COLS;
public static final int CANVAS_HEIGHT = CELL_SIZE * ROWS;
private int[][] cells;
private JTextField[][] tfCells;
private int[][] puzzle =new int[9][9]; 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T12:09:06.937

如果您使用的是 Netbeans，则可以使用 GUI Builder 来完成。只需转到设计视图，右键单击要用于此的底层容器（一些 JPanel），转到上下文菜单中的“设置布局”选项并选择“网格布局”。要编辑其属性，请转到导航器窗口（通常在左侧），浏览您的组件，直到看到有问题的容器，折叠它并选择 GridLayout。您现在可以在属性窗口（通常在右侧）上更改一些属性，例如行和列。然后，您将其他组件拖到该容器的顶部。

不过，根据您的描述，我想知道您真正要查找的是否是[JTable](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)，它是一个可让您在网格中显示数据的组件。

# core-data - 避免在自定义设置器中获取

> ID：14005946
> 
> 赞同：0
> 
> 时间：2012-12-22T19:37:15.337
> 
> 标签：core-data

我有两个实体，项目和类别。每个项目都有一个类别，一个类别可以有 0-多个项目。

我有一个特殊的类别，杂项类别。我用一个布尔属性 isMisc 来表示它，所以 category.isMisc=YES。

当我删除一个类别时，我想将它的任何项目重新分配给“misc”类别。所以我为项目编写了以下自定义设置器：

```
- (void)setCategory:(Category *)category
{
    [self willChangeValueForKey:@"category"];
    if (category == nil) {
        category = [Database theMiscCategory];
    }
    [self setPrimitiveValue:category forKey:@"category"];
    [self didChangeValueForKey:@"category"];
} 
```

问题是，[Database theMiscCategory] ​​执行提取，我认为这是不鼓励的。还有另一种方法可以做到这一点吗？

我只看过让 item.category = nil，但这在代码的其他领域引入了足够的复杂性，我更愿意有一个“杂项”类别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:41:21.610

您可以在程序中创建或获取“misc”类别对象一次，例如在创建托管对象上下文之后。然后您的自定义 setter 方法始终可以使用此实例。

如果您使用多个托管对象上下文，则必须为每个上下文创建一个对象。

# android - 实现“更快”的 backToTop - ListView

> ID：14005949
> 
> 赞同：4
> 
> 时间：2012-12-22T19:37:47.887
> 
> 标签：android, android-listview, android-actionbar, smooth-scrolling

我在 Fragment 中有一个 ListView，它作为选项卡添加到 ViewPager 中。我希望用户能够通过简单地点击他们已经在的选项卡（**onTabReselected()**）来滚动“backToTop”。我已经有一个工作代码来做到这一点；但是，我使用的代码需要太长时间才能滚动回位置 0，这在小型列表中非常简洁，但在 250 首歌曲的集合中，它肯定会惹恼用户。

这是我的代码：

```
@Override
public void onTabReselected(Tab tab, FragmentTransaction ft) {
    switch (tab.getPosition()) {
    case 0:
        if (tab.getPosition() == mCurPagerItem) {
            final ListView list = (ListView) findViewById(android.R.id.list);
            list.smoothScrollToPosition(0);
        }
        break;
    case 1: 
        if (tab.getPosition() == mCurPagerItem) {
            final GridView list = (GridView) findViewById(R.id.artist_grid);
            list.smoothScrollToPosition(0);
        }
        break;
    case 2:
        if (tab.getPosition() == mCurPagerItem) {
            final ExpandableListView list = (ExpandableListView) findViewById(R.id.exp_list);
            list.smoothScrollToPosition(0);
        }
        break;
    default:
        break;
    }
} 
```

当我的不同片段具有不同的“列表”类型时，我在位置之间切换。正如我所说，这段代码运行良好，但是有没有更快的方法来滚动回到顶部？那是更即时的东西。

澄清一下，当我说它“花费太长时间”时，那是因为**smoothScrollToPosition**本身就是一种在列表上滚动的缓慢方式，据说是为了让它看起来更好看。

**注意**我确实尝试过：

```
list.scrollTo(0, 0); 
```

但这实际上似乎对 listView 的当前位置没有任何作用。我想这更像是一个 View 调用，一个 ListView 方法本身。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T19:52:46.860

尝试调用`setSelection()`，它不执行任何动画：

```
list.setSelection(0); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T07:43:17.130

```
int position = 10; // 10 or other

if (list.getFirstVisiblePosition() > position) {
    list.setSelection(position);
    list.smoothScrollToPosition(0);
} else {
    list.smoothScrollToPosition(0);
} 
```

**更新时间：2013-10-27** 从 API 级别 11，您可以使用[**smoothScrollToPositionFromTop (int position, int offset, int duration)**](http://developer.android.com/reference/android/widget/AbsListView.html#smoothScrollToPositionFromTop%28int,%20int,%20int%29)

# mysql - 公交线路数据库查询错误

> ID：14005951
> 
> 赞同：0
> 
> 时间：2012-12-22T19:38:15.573
> 
> 标签：mysql, sql

我有 3 张桌子：

```
Buses:
    id   |   bus_name
    1    |   2D
    2    |   1D

Routes:
id   |   route_name
1    |   Garden
2    |   Malir

Bus_Route
id......|....bus_id...|....route_id
1.......|......1......|....1   
2.......|......1......|....2   
3.......|......2......|....1 
```

我想要一辆从“花园”和“马里尔”（即 2D）经过的公共汽车。我已经尝试过，并且我成功地绘制了一条路线，例如公共汽车仅从花园经过，但有一个条件是有两个组合框，一个是公共汽车开始的地方，第二个是结束的地方..我想要整个路线从公共汽车经过的地方像我在上面的示例中提到的 1D 花园和 malir 仅来自 Malir 而不是来自花园，因此如果 Start 来自 Garden 并且 end 在 malir 上，则仅显示 2D .. 我的查询如下：

```
select b.bus_name 
from buses b, route r, bus_route br 
where (b.id = br.bus_id AND r.id = br.route_id) 
  AND (r.id=1 AND r.id=2) 
```

它给出空的结果集

想要解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:07:47.707

```
SELECT bus_name
FROM buses
WHERE id in
(SELECT b.bid
FROM bus_route b
JOIN bus_route _b  
ON b.bid = _b.bid  
WHERE b.rid = 1 AND _b.rid = 2) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:14:46.780

您应该能够使用以下查询：

```
select *
from buses b
left join bus_route br
  on b.id = br.bus_id
where br.route_id = 1
  and exists (select *
              from buses b1
              left join bus_route br2
                on b1.id = br2.bus_id
              where br2.route_id=2
               and b.id = b1.id) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/f6dee/24)

返回结果：

```
| ID | BUS_NAME | BUS_ID | ROUTE_ID |
-------------------------------------
|  1 |       2D |      1 |        1 | 
```

# c# - 如何通过委托使用事件

> ID：14005953
> 
> 赞同：1
> 
> 时间：2012-12-22T19:38:39.417
> 
> 标签：c#, events, delegates

据我所知，关于代表的唯一事情是，代表是：

*   指向方法的指针。

*   它可以一次调用多个方法。

但我无法理解的是，一些用户正在使用委托的事件处理程序声明一个事件。例如：

```
public void delegate MyDelegate(string Name);
public event MyDelegate EventOfDelegate; 
```

但我不知道委托的事件处理程序的事件是什么。有人可以向我解释一下这个事件是怎么回事吗？我可以在哪里使用它，如果事件处理程序是委托的名称，这意味着什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:15:00.260

花一些时间阅读[这篇](http://csharpindepth.com/Articles/Chapter2/Events.aspx)描述委托及其与事件的关系的文章。我相信它是由著名的[Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)写的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:06:00.813

您将一些委托分配给 EventOfDelegate（正如您在代码中声明的那样）。例子`EventOfDelegate+= new MyDelegate(arg);`

其中 arg 是调用事件获取时要执行的操作。

然后，当我们想使用该事件时，我们会

```
if (EventOfDelegate != null) // check if we assigned it
    EventOfDelegate(arg); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T20:18:25.880

```
public delegate void MyDelegate(string Name); 
```

这一行声明了一个具有 void 返回类型和一个字符串类型的输入参数的委托。然后在以下事件声明中使用它，这基本上意味着此事件的订阅者必须具有先前在委托定义中定义的相同签名（或多或少，请阅读[此处](http://msdn.microsoft.com/en-us/library/ms173174%28v=vs.80%29.aspx)以获取有关该主题的更多信息）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T20:26:47.847

正如您在@Oded 发布的[问题中看到的那样：](https://stackoverflow.com/questions/29155/what-are-the-differences-between-delegates-and-events)

> 事件声明在委托实例上添加了一层抽象和保护。此保护可防止委托的客户端重置委托及其调用列表，并且只允许在调用列表中添加或删除目标。

这是必需的，因为使用委托和事件，会出现两个角色：**广播**者和**订阅者**。

从“ [C# 4 in a Nutshell](https://rads.stackoverflow.com/amzn/click/com/0596800959) ”一书中：

> 广播者是一种包含委托字段的类型。广播者通过调用委托来决定何时广播。
> 
> 订阅者是方法目标接收者。订阅者通过在广播者的委托上调用 += 和 -= 来决定何时开始和停止收听。订阅者不知道或不干扰其他订阅者。

然后，事件是一种构造，用于公开此模型（订阅者/广播者模型）所需的委托功能。事件的主要目的是防止订阅者相互干扰。例如：

考虑一个朋友和你自己。你和你的朋友签署了一份协议。本协议包括：

*   当您完成一项活动时，您的朋友必须通知其他朋友您的活动结束。那些朋友必须做其他活动。

在这种情况下，您是**广播**者，您的朋友是**订阅者**，您的活动结束是**事件**。代表呢？**代表**是您的朋友，因为他必须将您活动结束的消息告诉其他朋友，以便让他们进行其他活动。

换句话说：

```
public delegate void PriceChangedHandler(decimal oldPrice, decimal newPrice);

public class Stock
{
    string symbol;
    decimal price;

    public Stock(string symbol) { this.symbol = symbol; }

    public event PriceChangedHandler PriceChanged;

    public decimal Price
    {
        get {return Price;}
        set
        {
            if(price == value) return;
            if(PriceChanged != null) /* if invocation list is not empty, fire the event */
                PriceChanged(price, value);
            price = value;
        }
    } 
```

您可以看到每次更改时`Stock`该类都会触发其事件。`PriceChanged``Price``Stock`

# jquery - 带有 youtube 视频的 HTML 轮播停止旋转直到视频结束

> ID：14005955
> 
> 赞同：3
> 
> 时间：2012-12-22T19:39:01.960
> 
> 标签：jquery, html, web, youtube, carousel

第一次在这里发海报！所以我有这个我一直在试验的旋转木马。我知道它是如何工作的基础知识，并决定开始研究 YouTube 视频在轮播中的工作方式。这是目前的代码：

```
<br>
<!------------------------------------- THE CONTENT ------------------------------------------------->
<div id="jslidernews2" class="lof-slidecontent" style="width:600px; height:300px;">
<div class="preload">
<div></div>
</div>
<!-- MAIN CONTENT -->
     <div class="main-slider-content" style="width:450px; height:278px;">
     <ul class="sliders-wrap-inner">
     <li><a href="index1.html">
     </a><a href="http://www.facebook.com/events/186540518133184/"><img src="/images/video_wall.png" title="" height="278" width="450">   </a>
     </li>
     <li>
     <a href="t-lessons.aspx"><img src="/images/lessons_registering.png" title="" height="278" width="450"></a>
     </li>
     <li>
     <a href="aeRntSchoolSelect.aspx"><img src="/images/e_rentals.png" height="278" width="450"></a>
    </li>
     <li>
     <a href="http://stores.ebay.com/Brass-Bell-Music-Store"><img src="/images/ebay_event.png" height="278" width="450"></a>
     </li>
     <li>
     <iframe height="278" width="450" src="http://www.youtube.com/embed/ZkK4D3eOYb0" frameborder="0" allowfullscreen></iframe>
     </li>
</ul>
</div>
<!-- END MAIN CONTENT -->
<!-- NAVIGATOR -->
<div class="navigator-content">
<div class="navigator-wrapper">
<ul class="navigator-wrap-inner">
     <li>
     <div>
     <img src="/images/thumbs/video_wall_2.png">
     </div>
     </li>
     <li>
     <div>
     <img src="/images/thumbs/lessons_registering_2.png">
     </div>
     </li>
     <li>
     <div>
     <img src="/images/thumbs/e_rentals_2.png">
     </div>
     </li>
     <li>
     <div>
     <img src="/images/ebay_event.png">
     </div>
     </li>
     <li>
     <div>
     <img src="/images/ebay_event.png">
     </div>
     </li>
</ul>
</div>
</div>
<!----------------- END OF NAVIGATOR --------------------->
<div><a href="#" id="carouselstop"></a></div>
</div> 
```

所以你可以看到代码在运行，这是链接：[http](http://www.brassbellmusic.com/t-test1.aspx) ://www.brassbellmusic.com/t-test1.aspx 正如你所看到的，有侧面标志，以及主图像/视频。我对视频的第一个问题是，我如何获取视频的侧面图像，例如 YouTube 上视频的实际 YouTube 缩略图？第二个问题是如何在视频播放完毕后更换幻灯片？就像我连续有多个视频一样，我如何让它结束一个并移动到下一个？我不希望它们自动播放，只需在视频结束后立即更改幻灯片，否则我根本不希望轮播移动。因此这条线：

```
<div><a href="#" id="carouselstop"></a></div> 
```

那是我暂时能想到的最好的解决办法。我不知道还有什么，因为我是 html 代码的新手。（我来自 Java 和 C++）如果这令人困惑，请告诉我！我提前道歉以及我的感谢！

# c++ - opengl glut制作hud

> ID：14005957
> 
> 赞同：0
> 
> 时间：2012-12-22T19:39:25.487
> 
> 标签：c++, opengl, glut

我正在创建一个 3d 小行星游戏，您可以在其中导航宇宙飞船穿过一些小行星。当我单击小行星时，我会摧毁它，我想在小行星被摧毁之前添加一个 hud，就像你在科幻电影中看到的目标锁定和像这样的东西。所以选择小行星，动画平视显示器，摧毁小行星。实现这一目标的最佳方法是什么？我是否应该简单地创建一些平面并仅在需要时才使它们可见，或者是否有另一种方法，例如在创建文本并设置新投影以在主窗口上呈现文本时。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T19:50:08.100

哇，哇，你在这里一次解决了几个问题。

首先，您必须确定小行星在屏幕上的位置（可能还有边界）。您可以通过模仿小行星重心位置上的顶点变换管道来做到这一点。通常的方法是

```
 p_clip = Projection · (Modelview · p)
 p_ndc = p_ndc / p_ndc.w 
```

绘制 HUD 叠加层需要消除新的误解。如果您遵循通常的糟糕教程之一，那么您会在窗口重塑功能中找到投影矩阵设置。那不属于它。

如果将整个视口和投影设置放入绘图函数中，事情就会变得显而易见。您可以根据需要经常设置和重置视口和投影。因此，首先使用您通常的投影和视口设置来绘制场景。*然后*清除深度缓冲区并切换到适合渲染叠加层的投影。

# ios - 画布应用移动链接

> ID：14005958
> 
> 赞同：2
> 
> 时间：2012-12-22T19:39:38.820
> 
> 标签：ios, mobile, url-routing, facebook-canvas

我们有一个 Facebook 画布应用程序，该应用程序已配置并在移动浏览器上正常运行。但是，如果我在 Facebook 上提供了指向该应用程序的链接，并且有人从 iOS Facebook 应用程序中单击了该链接，则 Facebook 会给出一个错误，指出画布应用程序配置不正确。如果我采用相同的 URL 并将其粘贴到移动 Safari 浏览器中，它会加载得很好。我该怎么做才能让它从 Facebook 应用程序中正确加载？

# modx - 从外部/其他服务器革命 2.2.5 登录到 modx

> ID：14005966
> 
> 赞同：0
> 
> 时间：2012-12-22T19:40:22.563
> 
> 标签：modx, modx-revolution

我从 2 天开始就对这个问题感到恼火。

我正在使用**MODx Revolution 2.2.5（传统）**并且想从外部服务器登录到 modx 只是为了获取一些用户详细信息。

1）我知道 runprocessor 方法只有在我登录到管理器时才有效（不幸的是，这是我知道登录用户的唯一方法）所以我尝试了 IFRAME 方法来避免（跨脚本）它工作得很好但我不能由于同样的问题，跨域访问策略，使用 javascript 从 IFRAME 读取数据。

当我尝试使用 CURL 等其他方法发布数据时，Ajax 使用

```
header("Access-Control-Allow-Origin: *"); 
```

我能够登录（我看到 $response->response['success'] == 1）但无法访问任何数据，它说

```
Fatal error: Call to a member function get() on a non-object 
```

下面是我正在使用的代码片段

```
if(isset($_POST) && count($_POST)){
    $c = array(
        'username' => $_POST['username'],
        'password' => $_POST['password']
    );
    $response = $modx->runProcessor('security/login',$c);
    if($response->response['success'] == 1){
        $user['id'] = $modx->user->get('id');
                $profile = $modx->user->getOne('Profile');
        $user['fullname'] = $profile->get('fullname');
        $user['email'] = $profile->get('email');
        echo json_encode($user);
    }else{
        echo json_encode($response->response); 
    }
} 
```

2）我可以使用登录片段，但它不会返回我期望的输出。我们已经准备好了站点，并且我们已经在使用登录插件，所以我什至无法修改登录插件以响应预期的数据

**我如何使用 api 或任何其他方法登录 modx ？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T20:55:10.587

在我看来，你真的完全错误地攻击了这个问题。如果您想从另一个访问服务器/网页，则不要使用 iFrame 并按照您的方式进行操作。这就是黑客攻击，这个漏洞很可能会在未来的版本中得到修复。

您应该做的是连接到数据库并从用户表中收集信息。

没有黑客攻击，没有“技巧”，不会停止工作并且更安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T19:16:52.327

好吧，我今天整理了这个，下面是完美运行的完整版本。注意

```
header("Access-Control-Allow-Origin: http://www.xyz.com"); 
```

使用上述 CORS 规范，您可以允许 2 个服务器进行通信。

```
header("Access-Control-Allow-Origin: http://www.xyz.com");
if(isset($_POST['username']) && isset($_POST['password'])){

// get username and password from POST array
$username = $modx->sanitizeString($_POST['username']);
$password = $modx->sanitizeString($_POST['password']);
if(trim($username) != "" and trim($password) != ""){
    // Load lexicons to show proper error messages
    if (!isset($modx->lexicon) || !is_object($modx->lexicon)) {
        $modx->getService('lexicon','modLexicon');
    }
    $modx->lexicon->load('login');

    $loginContext= isset ($scriptProperties['login_context']) ? $scriptProperties['login_context'] :
    $modx->context->get('key');

    $addContexts= isset ($scriptProperties['add_contexts']) && !empty($scriptProperties['add_contexts']) ? explode(',', $scriptProperties['add_contexts']) : array();

    $mgrEvents = ($loginContext == 'mgr');

    $givenPassword = $password;

    /** @var $user modUser */
    $user= $modx->getObjectGraph('modUser', '{"Profile":{},"UserSettings":{}}', array ('modUser.username' => $username));

    if (!$user) {
        $ru = $modx->invokeEvent("OnUserNotFound", array(
            'user' => &$user,
            'username' => $username,
            'password' => $password,
            'attributes' => array(
                'loginContext' => $loginContext,
            )
        ));

        if (!empty($ru)) {
            foreach ($ru as $obj) {
                if (is_object($obj) && $obj instanceof modUser) {
                    $user = $obj;
                    break;
                }
            }
        }

        if (!is_object($user) || !($user instanceof modUser)) {
            //echo "cant locate account";
            echo $modx->toJSON($modx->error->failure($modx->lexicon('login_cannot_locate_account')));
            exit;
        }
    }

    if (!$user->get('active')) {
        //echo "inactivated accout";
        echo $modx->toJSON($modx->error->failure($modx->lexicon('login_user_inactive')));
            exit;
        }

    if (!$user->passwordMatches($givenPassword)) {
        if (!array_key_exists('login_failed', $_SESSION)) {
            $_SESSION['login_failed'] = 0;
        }
        if ($_SESSION['login_failed'] == 0) {
            $flc = ((integer) $user->Profile->get('failedlogincount')) + 1;
            $user->Profile->set('failedlogincount', $flc);
            $user->Profile->save();
            $_SESSION['login_failed']++;
        } else {
            $_SESSION['login_failed'] = 0;
        }
        //echo "wrong username pass";
        echo $modx->toJSON($modx->error->failure($modx->lexicon('login_username_password_incorrect')));
            exit;
        }

        $fullname =  $user->Profile->get('fullname');
        echo '{"success":true,"message":"Welcome '.$fullname.'!"}';
 }else{
        echo '{"success":false,"message":"Please enter username and password"}';
 } 
```

}

# xslt - 在 xslt 1.0 转换中实现有点棘手的逻辑

> ID：14005969
> 
> 赞同：1
> 
> 时间：2012-12-22T19:40:24.683
> 
> 标签：xslt, xslt-1.0

在使用 xslt 1.0 进行转换时，我发现实现以下逻辑有点困难。这是我的要求：我需要根据员工的工作时间定义以下逻辑。1\. 任何超过 8 的东西都会在一天内 OT else Regular。2\. 如果连续工作 3 天，那么第 3 天的时间将是双倍时间。

这是一个例子：

输入：

```
<Input>
          <Record>
            <EmpId>1</EmpId>
            <Date></Date>
            <Hours></Hours>
          </Record>
          <Record>
            <EmpId>1</EmpId>
            <Date>12/1/2012</Date>
            <Hours>6</Hours>
          </Record>
          <Record>
            <EmpId>1</EmpId>
            <Date>12/1/2012</Date>
            <Hours>4</Hours>
          </Record>
          <Record>
            <EmpId>1</EmpId>
            <Date>12/2/2012</Date>
            <Hours>4</Hours>
          </Record>
          <Record>
            <EmpId>1</EmpId>
            <Date>12/2/2012</Date>
            <Hours></Hours>
          </Record>
          <Record>
            <EmpId>1</EmpId>
            <Date>12/3/2012</Date>
            <Hours>3</Hours>
          </Record>
          <Record>
            <EmpId>2</EmpId>
            <Date>12/1/2012</Date>
            <Hours>4</Hours>
          </Record>
          <Record>
            <EmpId>2</EmpId>
            <Date>12/1/2012</Date>
            <Hours></Hours>
          </Record>
      </Input> 
```

输出：

```
 <Output>
          <Record>
            <EmployeeId>1</EmployeeId>
            <Detail>
              <Date>12/1/2012</Date>
              <RegHours>8</Reghours>
               <OTHours>2</OTHours>
            </Detail>
            <Detail>
              <Date>12/2/2012</Date>
              <RegHours>4</Reghours>
             </Detail>
            <Detail>
              <Date>12/3/2012</Date>
              <DTHours>3</DThours>
            </Detail>
          </Record>
          <Record>
            <EmployeeId>2</EmployeeId>
            <Detail>
              <Date>12/1/2012</Date>
              <RegHours>4</Reghours>
             </Detail>
            <Detail>
          </Record>
    </Output> 
```

将不胜感激任何帮助。

谢谢..阿比

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T15:26:34.887

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kRecByEmpId" match="Record[Date/node() and Hours/node()]"
          use="EmpId"/>
 <xsl:key name="kRecByEmpIdDate" match="Record[Date/node() and Hours/node()]"
          use="concat(EmpId,'+',Date)"/>

 <xsl:template match=
  "Record[generate-id()=generate-id(key('kRecByEmpId',EmpId)[1])]">
   <Record>
     <EmployeeId>
        <xsl:value-of select="EmpId"/>
     </EmployeeId>
     <xsl:apply-templates mode="datetime" select=
      "key('kRecByEmpId', EmpId)
               [generate-id()
               =
                generate-id(key('kRecByEmpIdDate',
                                 concat(EmpId,'+',Date)
                                 )[1]
                        )
            ]
      "/>
   </Record>
  </xsl:template>

  <xsl:template match="Record" mode="datetime">
    <Detail>
      <xsl:copy-of select="Date"/>
      <xsl:variable name="vTotal" select=
       "sum(key('kRecByEmpIdDate', concat(EmpId,'+',Date))/Hours)"/>
      <RegHours>
        <xsl:value-of select="8*($vTotal >= 8) + $vTotal*(not($vTotal >= 8))"/>
      </RegHours>
      <xsl:if test="$vTotal > 8">
          <OTHours>
            <xsl:value-of select="$vTotal -8"/>
          </OTHours>
      </xsl:if>
    </Detail>
  </xsl:template>
  <xsl:template match="text()"/>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<Input>
    <Record>
        <EmpId>1</EmpId>
        <Date></Date>
        <Hours></Hours>
    </Record>
    <Record>
        <EmpId>1</EmpId>
        <Date>12/1/2012</Date>
        <Hours>6</Hours>
    </Record>
    <Record>
        <EmpId>1</EmpId>
        <Date>12/1/2012</Date>
        <Hours>4</Hours>
    </Record>
    <Record>
        <EmpId>1</EmpId>
        <Date>12/2/2012</Date>
        <Hours>4</Hours>
    </Record>
    <Record>
        <EmpId>1</EmpId>
        <Date>12/2/2012</Date>
        <Hours></Hours>
    </Record>
    <Record>
        <EmpId>1</EmpId>
        <Date>12/3/2012</Date>
        <Hours>3</Hours>
    </Record>
    <Record>
        <EmpId>2</EmpId>
        <Date>12/1/2012</Date>
        <Hours>4</Hours>
    </Record>
    <Record>
        <EmpId>2</EmpId>
        <Date>12/1/2012</Date>
        <Hours></Hours>
    </Record>
</Input> 
```

**产生想要的正确结果**：

```
<Record>
   <EmployeeId>1</EmployeeId>
   <Detail>
      <Date>12/1/2012</Date>
      <RegHours>8</RegHours>
      <OTHours>2</OTHours>
   </Detail>
   <Detail>
      <Date>12/2/2012</Date>
      <RegHours>4</RegHours>
   </Detail>
   <Detail>
      <Date>12/3/2012</Date>
      <RegHours>3</RegHours>
   </Detail>
</Record>
<Record>
   <EmployeeId>2</EmployeeId>
   <Detail>
      <Date>12/1/2012</Date>
      <RegHours>4</RegHours>
   </Detail>
</Record> 
```

# jquery - jquerymobile 动态选择选项以错误的选择值结束

> ID：14005973
> 
> 赞同：1
> 
> 时间：2012-12-22T19:40:36.103
> 
> 标签：jquery, jquery-mobile

当我单步执行点击事件代码时，我看到了我期望的确切行为，将 ddlValues 设置为正确的选定选项）但是在我的代码之后运行事件冒泡代码后，选定的选项每次都设置回第一个选项。这是页面中的所有代码，仅显示相关，因为我检查了我的其他代码没有运行，因为事件被触发。

此选择控件位于两页页面 jquery 移动样式的 page2 上。在点击事件中，最后一个事件中，注意 changepage 方法，之后我开始我的设置被覆盖。

找不到运行得足够晚以重置值的事件，因为这会解决它，因为我有我想要在全局 hdn 控件中设置的值。

```
 <script>
    $(document).ready(function () {
      function GetPricing(cardid) {
        var prices = $('#ddlValues');
        var cardp = {};
        cardp.cardid = cardid;
        var datax = JSON.stringify(cardp);
        $.ajax({
          type: "POST",
          url: "cardedit.aspx/GetPricing",
          data: datax,
          contentType: "application/json; charset=utf-8",
          dataType: "json",
          success: function (response) {
            prices.empty();
            $.each(response.d, function (index, item) {
              prices.append(new Option(item.Name, item.ID));
            });
            prices.selectmenu("refresh");
          },
          error: function () {
            alert("Failed to load data");
          }
        });
      }
      function GetDetail(id) {
        var cardd = {};
        cardd.id = id;
        var datax = JSON.stringify(cardd);
        $.ajax({
          type: "POST",
          url: "cardedit.aspx/GetDetail",
          data: datax,
          contentType: "application/json; charset=utf-8",
          dataType: "json",
          success: function (response) {
            var vals = response.d;
            $('#txtNumber').val(vals[0]);
            $('#txtPrice').val(vals[1]);
            $('#txtTrade').val(vals[2]);
            $('#txtSell').val(vals[3]);
            $('#txtWholesale').val(vals[4]);
          },
          error: function () {
            alert("Failed to load data");
          }
        });
      }
      function GetDetailx(id) {
        var cardd = {};
        cardd.id = id;
        var datax = JSON.stringify(cardd);
        $.ajax({
          type: "POST",
          url: "cardedit.aspx/GetDetailx",
          data: datax,
          contentType: "application/json; charset=utf-8",
          dataType: "json",
          success: function (response) {
            var vals = response.d;
            $('#txtPrice').val(vals[0]);
            $('#txtTrade').val(vals[1]);
            $('#txtSell').val(vals[2]);
            $('#txtWholesale').val(vals[3]);
          },
          error: function () {
            alert("Failed to load data");
          }
        });
      }
      $('#ddlCards').change(function () {
        var cardid = $(this).attr('value');
        GetPricing(cardid);
      });
      $('#ddlValues').change(function () {
        var priceid = $(this).attr('value');
        $('#hdnPriceid').val(priceid)
        GetDetailx(priceid);
      });
      $('.cardxx').on('tap', function () {
        var x = $(this);
        var id = x.data("id");
        $('#hdnCardid').val(id);
        var cardid = x.data("cardid");
        var priceid = x.data("priceid");
        $('#hdnPriceid').val(priceid);
        var pagex = $('#page2');
        $.mobile.changePage(pagex);
        var cards = $('#ddlCards');
        cards.val(cardid);
        cards.selectmenu("refresh");
        GetPricing(cardid);
        GetDetail(id);
        var pricexs = $('#ddlValues');
        pricexs.val(priceid);
        pricexs.selectmenu("refresh", true);
        event.stopPropagation();
      });
    });
  </script> 
```

运行我的代码后，我看到 jquery 和 jquerymobile 代码正在运行，但对它的理解还不够，无法理解为什么它将 ddlValues 重置为第一个选项。

如果我将 set select 选项推迟四分之一秒，问题就解决了，但这似乎太粗糙了。

# javascript - CreateJS 未能通过 Windows 8 应用程序的认证

> ID：14005974
> 
> 赞同：0
> 
> 时间：2012-12-22T19:40:43.310
> 
> 标签：javascript, windows-8, createjs

我已经完成了我的 Javascript 游戏/应用程序，并且在没有错误或警告的情况下运行构建后，我确信认证 SDK 会以优异的成绩通过我。相反，它给我带来了两次失败，都与一些教程推荐用于开发 Win 8 JS 应用程序的 CreateJS 库有关。具体来说，我得到：

```
preloadjs-NEXT.min.js has JavaScript syntax or other problems
easeljs-0.5.0.min.js has JavaScript syntax or other problems 
```

和

```
easeljs-0.5.0.min.js is not properly UTF-8 encoded. Re-save the file as UTF-8 (including Byte Order Mark)
preloadjs-NEXT.min.js is not properly UTF-8 encoded. Re-save the file as UTF-8 (including Byte Order Mark) 
```

我是否需要做一些事情来“准备”这些库以便通过？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:58:09.580

使用 File -> Save As 保存每个文件，然后单击 Save 按钮上的下拉箭头并选择 Save with Encoding。在新对话框中选择 UTF-8 作为您的编码，这应该可以解决您的问题。

# c# - VS2010上的硬盘性能日志？

> ID：14005976
> 
> 赞同：0
> 
> 时间：2012-12-22T19:40:49.600
> 
> 标签：c#, visual-studio-2010

如何检查程序调试期间访问硬盘的次数？如果我可以使用内置工具执行此操作，我还可以监视特定文件以查看调试程序访问它们的次数吗？我有一个程序的性能受到了巨大的影响，我偷偷怀疑它读取 XML 文件的次数太多了。

# javascript - Javascript/HTML：命名时使用 id 与 class

> ID：14005978
> 
> 赞同：0
> 
> 时间：2012-12-22T19:40:54.523
> 
> 标签：javascript, html

我开始使用 Meteor 学习一些 Javascript 并查看他们的示例。

当我添加一个用于输入的文本字段并在其旁边有一个按钮时，发生了一个让我有点不知所措的错误；用户将输入他们想要添加到列表中的名称，然后单击按钮实际添加它。

我的问题是：为什么在 html 中，文本字段必须用 id="..." 命名，而按钮必须用 class="..." 命名？

作为其他参考，在我的 javascript 文件中，我使用的是 textfieldname.value 和“单击 input.buttonname”。id 与 class 的要求是否源于我如何使用它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:43:41.647

“id”属性用于为元素提供全局唯一标识符。“类”属性用于根据元素的含义、预期用途、与其他元素的关系或您的应用程序需要的任何其他内容对元素进行分类或典型化。

*通常*使用类来识别事物更灵活，因为可以给多个元素赋予同一个类，并且一个元素可以根据需要具有多个类。任何单个元素只能有一个“id”，并且这些值不得在同一个文档中重复使用。这两个属性都有明确的用例，其中一个显然更合适，还有许多其他情况不太清楚，可以使用其中任何一个。

这实际上不是 JavaScript 问题，而是“Web 应用程序设计”问题。如何标记 HTML 元素取决于内容的性质 (HTML)、呈现的需求 (CSS) 和预期的行为 (JavaScript)。

# jquery - 如何访问插件中的链接函数之一？

> ID：14005980
> 
> 赞同：0
> 
> 时间：2012-12-22T19:41:15.387
> 
> 标签：jquery, jquery-plugins, chaining, jquery-chaining

如何访问插件中的链接函数之一？

这是我的插件，我需要在其中返回文档上的附加元素。

```
(function($){

        $.fn.extend({ 

            selection: function(options) {

                var defaults = {
                    element:     "selection"
                }

                var options =  $.extend(defaults, options);
                var o = options;

                var $this = this;

               $this.function_1 = function(object)
                {
                    alert('function 1');

                }

                $this.function_2 = function(object)
                {
                    alert('function 2');
                }

                $(document.body).append("<div class='element'>Loading</div>");

                var element = $('.element');

                return element;

            }
        });

    })(jQuery);​ 
```

单击按钮时，它应该警告“功能 2”，但它会在 Firefox 上返回错误。

下面是我的jsffiddle，

[http://jsfiddle.net/dm3ft/](http://jsfiddle.net/dm3ft/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:22:58.850

一种方法是向插件函数添加一个参数以将方法作为字符串传递。基础知识取自[jQuery 插件创作文档](http://docs.jquery.com/Plugins/Authoring)：

```
(function($) {

    var methods = {
        function_1: function(object) {
            alert('function 1');
        },
        function_2: function(object) {
            alert('function 2');
        }
    };

$.fn.selection = function(method, options) {

    return this.each(function(){

        $(this).click(function() {

              // Method calling logic
               if (methods[method]) {
                   return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
               } else if (typeof method === 'object' || !method) {
                   return methods.init.apply(this, arguments);
               } else {
                   $.error('Method ' + method + ' does not exist on jQuery.tooltip');
               }
          });
    });

})(jQuery); 
```

然后调用插件方法：

```
 $('.chain-function').selection('function_2'/* optional options object*/); 
```

演示：http: [//jsfiddle.net/dm3ft/1/](http://jsfiddle.net/dm3ft/1/)

注意：重要的是您要意识到`this`插件函数内部是 DOM 元素，不要将其与`this`您的类的一部分混淆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:09:02.577

你也可以使用**jQuery.fn**

```
$(document).ready(function(){

   $('.chain-function').function_2();

});

(function($){

    $.fn.function_2 = function(object){

        alert("yay!");
        var element = $("<div />").addClass("element").text("Loading");
        element.appendTo(  $(document.body) );
        return element;

    };

})(jQuery);​ 
```

# mysql - 如何用更少的代码编写 SQL 请求？

> ID：14005983
> 
> 赞同：1
> 
> 时间：2012-12-22T19:42:00.410
> 
> 标签：mysql

我有这样的代码：

```
SELECT 
  `cabinet`.`name_test`, 
  `answers`.`answer_id`,
  (
    SELECT `answer_id` 
    FROM `answers` 
    WHERE `user_id` = '353281' AND `answers`.`test_id` = `cabinet`.`test_id`
  ) as answer_2
FROM `cabinet` 
INNER JOIN `answers`
WHERE
  `user_id` = '184918649' 
  AND `friend_id` = '353281' 
  AND `answers`.`test_id` = `cabinet`.`test_id` 
```

如何不写两次：`answers`。`test_id`= `cabinet`。`test_id`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:51:06.260

这并不是真正的代码少，但您也可以通过加入`answers`表格两次来做到这一点：

```
SELECT 
  c.`name_test`, 
  a1.`answer_id` answer_1,
  a2.`answer_id` answer_2
FROM `cabinet` c
INNER JOIN `answers` a1
  ON c.`test_id` = a1.`test_id`
  AND a1.`user_id` = '184918649' 
  AND  `friend_id` = '353281'
INNER JOIN `answers` a2
  ON c.`test_id` = a2.`test_id`
  AND a2.`user_id` = '353281' 
```

或者您可以使用子查询：

```
SELECT 
  c.`name_test`, 
  a1.`answer_id` answer_1,
  a2.`answer_id` answer_2
FROM `cabinet` c
INNER JOIN
(
  select `answer_id`
  from `answers`
  where `user_id` = '184918649' 
    AND  `friend_id` = '353281'
) a1
  ON c.`test_id` = a1.`test_id`
INNER JOIN
(
  select `answer_id`
  from `answers`
  where `user_id` = '353281'
) a2
  ON c.`test_id` = a2.`test_id`; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:53:13.883

`ON`你在你的 sql中缺少子句

尝试这个

```
 SELECT 
  `cabinet`.`name_test`, 
   `answers`.`answer_id`,
  (
     SELECT `answer_id` 
    FROM `answers` 
     WHERE `user_id` = '353281' AND `answers`.`test_id` = `cabinet`.`test_id`
   ) as answer_2
 FROM `cabinet` 
 INNER JOIN `answers` on `answers`.`test_id` = `cabinet`.`test_id`
 WHERE

 `user_id` = '184918649' 
 AND `friend_id` = '353281' 
```

删除了最后一行是 double

# jquery - Magento OPCheckout.js

> ID：14005985
> 
> 赞同：0
> 
> 时间：2012-12-22T19:42:06.210
> 
> 标签：jquery, magento

在从第一个结帐步骤（ billing-info ）移动到下一个（ shipping-info 或 shipping-method ）时，如何`opcheckout.js`从 magento 商店编辑它以使其添加到元素中？`display:none;`

我问这个是因为我在使用 Internet Explorer 时遇到了一些问题：在我完成第一步并单击“继续”按钮后，一些元素只是拒绝从第一步中消失。

我试图`$('#element').css('display','none');`在函数内部添加`setBilling`，但无济于事。

我应该把代码放在哪里？

PS：这个问题与[this](https://stackoverflow.com/questions/13998550/magento-checkout-small-error/14000667#14000667)密切相关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:24:53.797

`$('#element').css('display','none');`您的结帐页面中是否包含jquery库？（看看 jQuery.noConflict();[将 jQuery 添加到 Magento](https://stackoverflow.com/questions/7598431/adding-jquery-to-magento)）

尝试使用prototypejs $('element').hide() 或查看[使用PrototypeJS 添加CSS 样式](https://stackoverflow.com/questions/10810947/add-css-styles-with-prototypejs)

您确定将元素添加到正确的模板和正确的 div 中吗？尝试使用 chrome 或 firebug 进行“检查元素”

/app/design/frontend/default/[theme]/template/persistent/checkout/onepage/* /app/design/frontend/default/[theme]/template/checkout/onepage/*

# ruby-on-rails - 实现 ajax 请求以创建/编辑 rails 对象

> ID：14005992
> 
> 赞同：0
> 
> 时间：2012-12-22T19:42:49.203
> 
> 标签：ruby-on-rails, ajax

我正在尝试在我的编辑用户页面中创建一个添加/编辑信用卡表单。为此，我试图在我的客户控制器中实现对编辑和创建函数的 ajax 调用。

这是我在模式窗口中更新按钮的代码：

```
<%= button_tag "Update", :class =>"btn submit-button", :type => 'button', :onclick => "onUpdateCard('#{current_user.id}');"%> 
```

这是它调用的函数：

```
function onUpdateCard(id) {
this.id = id;

// disable the submit button to prevent repeated clicks
$('.submit-button').attr("disabled", "disabled");
var card_number = document.getElementById('card_number').value;
var card_code = document.getElementById('card_code').value;
var card_month = document.getElementById('card_month').value;
var card_year = document.getElementById('card_year').value;

var response = Stripe.createToken({
    number: $('#card_number').val(),
    cvc: $('#card_code').val(),
    exp_month: $('#card_month').val(),
    exp_year: $('#card_year').val()
}, stripeResponseHandler);        
// allow the form to submit with the default action
return false;
};

function stripeResponseHandler(status, response) {
if (response.error) {
    $(".payment-errors").text(response.error.message);
    $(".submit-button").removeAttr("disabled");
} else {
    var token = response['id'];
    var new_url = "/users/" + this.id + "/customers/new";
    var edit_url = "/users/" + this.id + "/customers/1/edit";
    $.ajax({
        type:'GET',
        url:  edit_url,
        data: {'stripe_card_token': token}
    });
}
return false;
}; 
```

在控制器中有编辑功能：

```
def edit
    @user = current_user
    @customer = @user.customer    
    stripe_customer = Stripe::Customer.retrieve(@customer.stripe_customer_token)
    stripe_customer.card = params[:stripe_card_token]
    stripe_customer.save
end 
```

你能帮我弄清楚如何正确处理ajax吗？我不确定如何正确调试...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T10:09:53.637

在这里，我建议使用 AJAX 处理更新请求的替代方法。

我不是在改进或更正您的代码，而是为您提供一种在 Rails 3 中处理 AJAX 请求的方法。

一个。看法

无论您想使用 AJAX 调用在数据库中更新什么信息，您都将通过一个表单。因此，要发出 AJAX 请求，您需要在表单中添加 :remote => true 。Rails 提供了这个助手。

```
<%= form_for @customer, :url => admin_customers_path, :method => :post, :remote => true, :html => { :id => "customer-form" } do |form|-%>
      <%= render :partial => 'admin/customers/form', :object => form %>
      <%= form.submit 'Update' %>
<% end %> 
```

在 _form.html.erb 中，您可以添加文本字段或其他任何您想在编辑表单中添加的内容

湾。控制器

因为 " :remote => true " 你的表单提交会发出一个 JS 请求，所以在保存客户控制的数据后的更新操作中，它将为 format.js，然后它会在视图中查找 update.js.erb。

```
def update
  if @customer.update_attributes(params[:customer])
    respond_to do |format|
      format.html {
                  flash[:success] = "customer's info was updated Successfully."
                  redirect_to customers_path
      }
      format.js
    end
  else
    respond_to do |format|
      format.html {
                  flash[:error] = @customer.errors.present? ? @customer.errors.full_messages.join('<br />') : "Oops! There is some problem with category update."
                  render :edit
      }
      format.js
    end
  end
end 
```

C。更新.js.erb

更新成功后就可以做事了。假设您想突出显示一些 div，那么您可以这样做。

```
 $('.target-div').effect("highlight", {}, 2500); 
```

# java - 更灵活的工厂

> ID：14005993
> 
> 赞同：2
> 
> 时间：2012-12-22T19:43:16.887
> 
> 标签：java, enums, factory

我目前正在为学校做一个小项目。在我的 Java 应用程序中，我需要一个数据库，并且我想让我的应用程序能够使用不同类型的数据库。所以我目前实现了一个 txt 数据库和一个 PostgreSQL。将来，应该可以添加其他数据库类型。像 XML 或 MySQL，...

为了创建一个数据库实例，我设计了一个使用枚举的工厂。它工作得很好，但在我的opionio中它并不是真正的灵活。所以，我做了一些研究，但没有找到一个对我来说很清楚的好例子。

这是我的枚举：

```
public enum DatabaseType {
    TXT,
    SQL,
    XML;
} 
```

这是我的工厂：

```
public class DatabaseFactory {      

    public Database createDatabase(DatabaseType type, String databaseName) throws DatabaseException {
        if(type.equals(DatabaseType.TXT)) {
            return new FileDatabase(databaseName);
        }else if(type.equals(DatabaseType.SQL)) {
            return new SQLDatabase(databaseName);
        }else if(type.equals(DatabaseType.XML)) {
            return new XMLDatabase(databaseName);
        }else {
            //default
            return new FileDatabase(databaseName);
        }
    }
} 
```

我的目标是将来只编辑枚举，而不涉及工厂本身。这应该给我足够的灵活性，但我不知道我该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T20:02:32.860

你可以把工厂放在`enum`里面。

```
public enum DatabaseType {
    TXT {
        @Override
        public Database createDatabase(String databaseName) {
            return new FileDatabase(databaseName);
        }
    },
    SQL {
        @Override
        public Database createDatabase(String databaseName) {
            return new SQLDatabase(databaseName);
        }
    },
    XML {
        @Override
        public Database createDatabase(String databaseName) {
            return new XMLDatabase(databaseName);
        }
    };

    public abstract Database createDatabase(String databaseName);
} 
```

在 Java 中，`enum`s 不仅仅是整数值的好名字（就像在 C 中一样）。将 an`enum`视为具有固定数量实例的类的更好方法。结合匿名类的概念，您可以为枚举中的每个值赋予特定于该值的不同属性和方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T19:55:38.350

使用反射：

**你的枚举：**

```
public enum DatabaseType {
    FILE(FileDatabase.class),
    SQL(SQLDatabase.class);

    private Database db;

   DatabaseType(Class<Database> db) {
      this.db = db;
   }

   /*package friendly*/ Class<Database> getDatabase() {
      return this.db;
   }
} 
```

**您的工厂：**

```
public class DatabaseFactory {

    public static Database create(DatabaseType type, String dbName) throws Exception {
       Database db = null;
       Constructor cons = type.getDatabase().getDeclaredConstructor(new Class[] { String.class });
       cons.setAccessible(true);
       db = cons.newInstance(dbName);

       return db;
    }

} 
```

**您的数据库实施者：**

```
public class FileDatabase extends Database {

    /* can only be instantiated via reflection */
    private FileDatabase(String databaseName) {
        // init db.
    }
} 
```