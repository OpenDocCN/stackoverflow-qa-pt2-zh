# StackOverflow 问答 15179000-15179999

# javascript - 在 JavaScript 中访问内部变量

> ID：15179004
> 
> 赞同：0
> 
> 时间：2013-03-02T20:18:54.617
> 
> 标签：javascript, properties, private, gecko

我正在为某个网站编写[用户脚本。](https://userscripts.org/)我需要访问函数中的内部变量。例如，在以下代码中，我需要访问对象 c 的“私有财产”b

```
function a(){
    var b;
    //assignment to b and other stuff
};
var c=new a(); 
```

我不能更改站点的代码，我只能更改 BORWSER 扩展[脚本](https://github.com/scriptish/scriptish/)并[编写用户脚本](https://userscripts.org/)。我的浏览器是最新的firefox。即使我必须更改[Scriptish](https://github.com/scriptish/scriptish/) ，我也需要获得访问权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:35:11.863

您无法访问函数的内部变量，您应该将其设为全局变量以从外部获取它。

```
var b;
function a(){
 b=1;
    //assignment to b and other stuff
};
var c=new a();
document.write(c.b); 
```

输出将为 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:18:58.020

这很简单，非常适合继承应用程序：

您只需返回您想要的任何内容，并且可能通过方法返回它，然后在其他函数中重用它并在其上构建。

示例如下：

```
 function a(){
        var b;
        //assignment to b and other stuff
        return b;
      };

     // or

   function a(){
        var b, result;
        //assignment to b and other stuff
        returnInitial: function() {
           return b;
         }
        // other stuff with b
        return result;
   }; 
```

稍后您可以使用所谓的“寄生继承”并使用所有局部变量并添加新方法在其他函数中启动整个函数，如下所示：

```
var a function() {
        var b, result;
        //assignment to b and other stuff
        returnInitial: function() {
           return b;
         }
        // other stuff with b
        return result;
}
var extendedA function() {
    var base = new a;
    var b = a.returnInitial();
    a.addToB = function (c) {
    var sum = c + a.returnInitial();
    return sum;
    }
} 
```

所以你现在可以得到

```
var smt = new extendA();
var c = 12; //some number
var sumBC = extendA.addToB(c); 
```

对于这些伟大的实践，我建议 yutube 搜索 doug crockford 的关于 js 对象处理的讲座。

请注意，您需要使用 new，因为如果您不初始化新实例，javascript 使用的动态对象处理可能会使您的原始对象崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:35:51.987

在您的代码`b`中不是私有变量，而是局部变量。并且在执行`var c=new a();`b 之后不再存在。因此，您无法访问它。

但是如果你使用[闭包](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures)，一切都会改变：

```
function a(){
    var b;
    //assignment to b and other stuff
    this.revealB = function() {
        return b;
    }
};
var c = new a();
alert(c.revealB()); 
```

这里`b`仍然是一个局部变量，但它的生命周期受到闭包的影响，因此当我们调用`revealB`.

# javascript - 如何在jQuery中引用一堆刚刚添加的列表项？

> ID：15179005
> 
> 赞同：1
> 
> 时间：2013-03-02T20:18:56.103
> 
> 标签：javascript, jquery, html

您如何获得对刚刚附加到 ul 的一堆 li 的引用

假设我有一个清单：

```
<ul id="mylist">
  <li>1</li>
  <li>2</li>
</ul> 
```

现在我在上面的 ul 中附加了几个 li，所以：

```
$('mylist').append(response); 
```

响应如下所示：

```
"<li>3</li>
 <li>4</li>
 <li>5</li>" 
```

我想将一个点击处理程序附加到新附加的 li 上，但是我如何获得这些 li 的引用？

更新： ul#mylist 在弹出窗口中，最初不可见，单击另一个按钮时会显示此弹出窗口：

```
$mybtn.click(function(){
  $('#mylist').show();
}); 
```

那么，我将在哪里定义“on”处理程序？如果我在他的按钮单击处理程序中执行此操作，那么它将多次附加“on”处理程序，对，每次单击按钮时？我也无法在页面加载时定义“on”处理程序，因为那时 mylist 不可见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T20:21:06.663

在追加元素之前创建元素。

```
var els = $(response).appendTo('#mylist')
                     .on("click", function() { /* your code */ }); 
```

* * *

或者，如果它仅适用于处理程序，您可以在您的 上设置一个委托处理程序`ul`，而不必担心。

```
// on page load
$('#mylist').on("click", "li", function() { /* your code */ }); 
```

* * *

```
// on response
$('#mylist').append(response); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T20:24:08.290

尝试

```
$('#mylist').on('click', 'li', function() { console.log('whatever'); }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:37:02.293

如果要严格访问最后添加的元素，可以通过多种方式遍历它：

您可以转到 $("ul#mylist li:last-child") 或 $("ul#mylist li:nth-child(n)") 或编辑它们，在附加之前添加它们一个类，以便您可以标记它们视觉上作为最后的添加。

# c++ - 如何使矩形平滑地越过显示边框，同时出现在对面？

> ID：15179006
> 
> 赞同：2
> 
> 时间：2013-03-02T20:18:58.210
> 
> 标签：c++, allegro5

这就是我通过按下按钮使矩形移动的方式：

```
#include <stdio.h>
#include <allegro5/allegro.h>
#include <allegro5/allegro_native_dialog.h>
#include <allegro5/allegro_primitives.h>

#define ScreenWidth 1440
#define ScreenHeight 790

int main()
{
    if (!al_init())
    {
        al_show_native_message_box(NULL, NULL, NULL, "Could not initialize Allegro 5", NULL, NULL);
        return -1;
    }

    al_set_new_display_flags(ALLEGRO_WINDOWED);
    ALLEGRO_DISPLAY *display = al_create_display(ScreenWidth, ScreenHeight); 
    al_set_window_position(display, 0, 0);
    al_set_window_title(display, "Lab 14"); 

    if (!display)
    {
        al_show_native_message_box(display, "Error", NULL, "Display window was not created succesfully", NULL, ALLEGRO_MESSAGEBOX_ERROR);
        return -1;
    }

    al_init_primitives_addon();
    al_install_keyboard();

    ALLEGRO_COLOR orange = al_map_rgb(255, 160, 0);

    ALLEGRO_EVENT_QUEUE *event_queue = al_create_event_queue();

    al_register_event_source(event_queue, al_get_keyboard_event_source());

    bool done = false;
    int x = 10, y = 10;
    int moveSpeed = 5;

    int state = NULL;

    while (!done)
    {
        ALLEGRO_EVENT events;
        al_wait_for_event(event_queue, &events);

        if(events.type = ALLEGRO_EVENT_KEY_DOWN)
        {
            switch(events.keyboard.keycode)
            {
                case ALLEGRO_KEY_DOWN:
                    y += moveSpeed;
                    break;
                case ALLEGRO_KEY_UP:
                    y -= moveSpeed;
                    break;
                case ALLEGRO_KEY_RIGHT:
                    x += moveSpeed;
                    break;
                case ALLEGRO_KEY_LEFT:
                    x -= moveSpeed;
                    break;
                case ALLEGRO_KEY_ESCAPE:
                    done = true;
                    break;
            }
        }

        al_draw_rectangle(x, y, x + 20, y + 20, orange, 2.0);
        al_flip_display();
        al_clear_to_color(al_map_rgb(0, 0, 0));
    }
    al_draw_rectangle(300, 600, 500, 200, orange, 2.0);
    al_destroy_display(display);
    al_destroy_event_queue(event_queue);

    return 0;
} 
```

如何修改代码以使矩形平滑地越过显示边框，同时出现在另一侧？平滑意味着它不应该完全出现在对面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:26:11.343

你有你的矩形的屏幕尺寸和位置和大小，因此你知道它会从屏幕上切掉多少。
在将它传送到屏幕之前，您必须检查每个矩形。
如果您检测到剪切，只需计算多少，然后在屏幕另一侧的位移坐标上对同一个矩形进行另一个 blit 调用，因此只是矩形的一部分。可见。

在您的代码中

```
 al_draw_rectangle(x, y, x + 20, y + 20, orange, 2.0); 
```

如果矩形（部分）在屏幕外，则添加另一个具有不同坐标的调用。

# javascript - MVC 控制器属性无法识别参数的集合

> ID：15179007
> 
> 赞同：0
> 
> 时间：2013-03-02T20:19:11.460
> 
> 标签：javascript, jquery, asp.net-mvc-4

我正在调用一个 MVC 控制器方法并将其传递给一个`Entity`对象。在其他属性中，`Entity`也有一个`Contacts`属性。使用这种方法，控制器获取实体，以及实体中正确数量的联系人，但所有联系人的属性均为空。

这是原始方法：

```
$.post('/Home/Save', $.param(entity), SaveComplete); 
```

使用强类型控制器：

```
public ActionResult Save(Entity entity) 
```

这会导致每个`Entity.Contact`都具有空属性：

![在此处输入图像描述](../Images/a29ec77842b3fd5ef5ab204c4a7b25ff.png)

并且 Fiddler 显示联系人被传递到服务器。

为了让控制器识别实体的联系人属性，我必须这样做：

JavaScript：

```
$.post('/Home/Save', { entityAsJson: JSON.stringify(entity) }, SaveComplete); 
```

控制器方法：

```
public ActionResult Save(string entityAsJson)
{
    try
    {        
        Entity entity = JsonConvert.DeserializeObject<Entity>(entityAsJson);
        // more code here
    }
} 
```

这很不幸，因为现在我的控制器采用字符串而不是强类型实体。有没有办法让第一个选项起作用，还是我需要对 JSON 进行字符串化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T20:31:17.677

为了在控制器操作中使用强类型参数并使用正确绑定的 ajax 发送数据（包括集合属性），您需要执行以下操作：

*   使用`$.ajax`而不是`$.post`因为`$.post`不允许配置`contentType`选项
*   您需要发送 JSON。所以你需要`JSON.stringfy`你的数据
*   设置为`contentType`，`"application/json"`因为这告诉 ASP.NET MVC 为 JSON 使用正确的模型绑定器

因此，以下代码应与您的原始控制器操作一起使用：

```
$.ajax({ 
    url: '/Home/Save', 
    type: 'POST', 
    data: JSON.stringify(entity), 
    contentType: "application/json",
    success: SaveComplete 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:39:25.463

在您的情况下，我不知道您为什么要发布 javascript 帖子。如果它是强类型绑定，那么只需执行以下操作：

（1）包装您的控件，在使用块（表单）下提交按钮。
(2) 调用你的动作，它应该有你的类名作为参数。

例如：

```
    公共操作结果（YourClassName 模型）
    {
          您的示例代码
    }

```

在模型中，您将获得您在视图中填写的任何内容...

# mysql - 使用并集从同一列中选择两个数字，但具有两个不同的排序依据

> ID：15179011
> 
> 赞同：1
> 
> 时间：2013-03-02T20:19:38.093
> 
> 标签：mysql, union

所以我需要使用 Union 语句在同一查询中选择人口最多和最低的城市......我已经尝试了网站、谷歌、mysql.com 和 mysql 教程上的几乎所有答案......没有任何效果，所以这是我的代码

```
(select name, population from city order by population asc limit 1)
union
( select name, population from city order by population desc limit 1) 
```

它显然不起作用，我不想要答案，我只需要了解它为什么不起作用以及要解决的问题，谢谢

# c# - 在 .NET 和三点运算符中解析 XDocument

> ID：15179012
> 
> 赞同：0
> 
> 时间：2013-03-02T20:19:39.013
> 
> 标签：c#, xml, vb.net, linq-to-xml

在`VB.NET`我使用以下内容获取标签值：

```
Dim endval = cint(googleXMLdocument...<s:currentItemCount>.Value) - 1 
```

我该怎么做`C#`？

我尝试了以下，但它有一个语法错误

```
var endval = (short)googleXMLDoc...<s:currentItemCount>.Value) - 1; 
```

零件有什么问题`C#`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:43:28.960

这是 VB.NET 上的快捷方式的传说：http: [//msdn.microsoft.com/en-us/library/bb384974.aspx](http://msdn.microsoft.com/en-us/library/bb384974.aspx)

没有 C# 等效项，因此您必须使用标准 LINQ to XML 方法：

```
.<name>                .Elements("name")
...<name>              .Descendants("name")
.Value                 .First()
.@name                  .Attribute("name") 
```

关于您的示例-您应该在 C# 中尝试：

```
var endval = (short)googleXmlDoc.Descendants("currentItemCount").First() - 1; 
```

但是，如果您向我们展示示例 XML 和预期结果，会容易得多。

# git - 为什么从分支切换回 master 不会更改我的文件？

> ID：15179013
> 
> 赞同：1
> 
> 时间：2013-03-02T20:19:41.277
> 
> 标签：git, visual-studio-2012

我创建了一个名为`test`.

```
git branch test
git checkout test 
```

然后我做了很多改变。添加文件，更改文件等。

当我`checkout` `master`所有的分支更改仍然存在时。我以为代码会回到分支之前的状态？我没有正确理解分支概念吗？

我正在使用 Visual Studio 和在这里找到的 Git 插件：http: [//visualstudiogallery.msdn.microsoft.com/63a7e40d-4d71-4fbb-a23b-d262124b8f4c](http://visualstudiogallery.msdn.microsoft.com/63a7e40d-4d71-4fbb-a23b-d262124b8f4c)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T20:21:58.277

你从来没有提到提交，只是改变和添加。当您签出分支时，您尚未提交的任何更改都会随之发生。如果您希望更改保留在特定分支中，则必须在移动到其他分支之前提交它们。否则，如果您只是想暂时隐藏更改，您可以使用[`git stash`](https://www.kernel.org/pub/software/scm/git/docs/git-stash.html)将它们收起来并`git stash pop`稍后将它们带回来（在任何分支上）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:25:01.423

当您添加、更改等这些文件时，您提交了吗？如果你不提交它们然后移动到另一个分支，它们会和你一起出现。对于那些由于更改未完成而您不想提交的情况，您可以隐藏它们。使用 git stash 您将更改存储在 stash 部分中，您可以稍后在返回分支时将其取回

# ajax - 如何使用 jQuery 上传文件和表单数据？

> ID：15179021
> 
> 赞同：1
> 
> 时间：2013-03-02T20:20:40.500
> 
> 标签：ajax

我想用 Jquery 上传文件和表单数据。我的html；

```
<form id="kayit" action="" method="post" enctype="multipart/form-data">
<input type="text" name="yazi" />
<input type="file" id="resim" name="resim"/>
<a onclick="kontrolet();" id="yolla">Yolla</a>
</form>
<div id="sonuc"></div> 
```

和我的js；

```
 function kontrolet()
            {
                var veriler = jQuery("#kayit").serialize();
                //console.log(veriler);
                jQuery.ajax({
                    type:'POST',
                    url:'form.php',
                    data: veriler,
                    processData: false,
                    beforeSend: function () {
                        jQuery("#sonuc").html("Lütfen Bekleyin....");
                    },
                    success: function(sonuc)
                    {
                        jQuery('#sonuc').html(sonuc);
                    }
                });
            } 
```

我有文件名，但这不起作用。帮助 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:18:36.227

我使用 jQuery 使用[AjaxUpload 插件](https://code.google.com/p/ajax-upload)在后台上传文件- 它在后台构建一个 iFrame，克隆您的表单并将克隆提交给它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:26:51.710

您不能使用简单的 javascript 通过 ajax 上传文件（原因之一是 javascript 目前无法访问文件系统，因此它无法读取内容以通过 AJAX 请求发送它）。

对于这种功能，您必须使用一些使用动作脚本或 java 的插件。网上有很多可用的（搜索 ajax 文件上传），但我认为你最好使用老式的 POST。

# autoload - 无法使用 Composer 自动加载类

> ID：15179025
> 
> 赞同：1
> 
> 时间：2013-03-02T20:20:59.637
> 
> 标签：autoload, composer-php

我有一个项目结构，如下所示：

```
app/
app/models/
app/controllers/
app/views/
public/
vendor/
composer.json 
```

在 app/controllers/IndexController.php 内部，我有：

```
require '../vendor/autoload.php';

use MyApp\Models\Test;

class IndexController {

    public function __construct() {
       $t = new Test(); // can't be found
    }
} 
```

这是我的composer.json：

```
{
  "require": {
    "aws/aws-sdk-php": "*",
  },
  "autoload": {
    "psr-0": {
        "MyApp": "app/"
    }
  }
} 
```

更新 composer.json 后，我运行 composer.phar update 来更新生成的自动加载文件。

仅供参考 - 我没有使用任何类型的 MVC 框架。这只是我喜欢用于小型项目的自定义轻量级结构。

如何修复我的项目，以便我可以从我的模型文件夹中自动加载类并在我的控制器中正确使用它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:54:30.120

如果你使用`psr-0`自动加载，那么你需要遵循 psr-0 规范。这意味着，如果您指定`"MyApp": "app/"`，则 MyApp\Models\Test 类必须在`app/MyApp/Models/Test.php`.

# android - 如何为套接字连接实现 asyncTask

> ID：15179029
> 
> 赞同：0
> 
> 时间：2013-03-02T20:21:21.740
> 
> 标签：android, sockets, networking, android-asynctask

我看到了一个在线示例，说明如何在 pc 上的 android 应用程序和 java 服务器之间实现套接字连接。该应用程序在模拟器（运行 2.3.3）上完美运行，但在我的安卓智能手机上强制关闭。

经过一些研究，我得出结论，解决方案是实现 asynctask 方法。但是我在知道如何实施它时遇到了问题。我看到了很多解释，但它们对我的情况没有帮助。这是我正在使用的示例代码，我将将此代码用作我开发的任何其他应用程序的参考模板。

我知道这个问题已经被问了很多（很多很多！），但直到现在我还没有设法完成这项工作。那么任何人都可以帮助我使用以下代码：

```
package com.exercise.AndroidClient;

import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.net.Socket;
import java.net.UnknownHostException;

import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class AndroidClient extends Activity {

EditText textOut;
TextView textIn;

 /** Called when the activity is first created. */
 @Override
 public void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
     setContentView(R.layout.activity_main);

     textOut = (EditText)findViewById(R.id.textout);
     Button buttonSend = (Button)findViewById(R.id.send);
     textIn = (TextView)findViewById(R.id.textin);
     buttonSend.setOnClickListener(buttonSendOnClickListener);
 }

 Button.OnClickListener buttonSendOnClickListener
 = new Button.OnClickListener(){

@Override
public void onClick(View arg0) {
 // TODO Auto-generated method stub
 Socket socket = null;
 DataOutputStream dataOutputStream = null;
 DataInputStream dataInputStream = null;

 try {
  socket = new Socket("192.168.1.101", 8888);
  dataOutputStream = new DataOutputStream(socket.getOutputStream());
  dataInputStream = new DataInputStream(socket.getInputStream());
  dataOutputStream.writeUTF(textOut.getText().toString());
  textIn.setText(dataInputStream.readUTF());
 } catch (UnknownHostException e) {
  // TODO Auto-generated catch block
  e.printStackTrace();
 } catch (IOException e) {
  // TODO Auto-generated catch block
  e.printStackTrace();
 }
 finally{
  if (socket != null){
   try {
    socket.close();
   } catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
   }
  }

  if (dataOutputStream != null){
   try {
    dataOutputStream.close();
   } catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
   }
  }

  if (dataInputStream != null){
   try {
    dataInputStream.close();
   } catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
   }
  }
 }
 ;
}};
} 
```

**日志猫**

```
03-03 21:35:59.643: E/Trace(3472): error opening trace file: No such file or directory (2)
03-03 21:36:01.073: D/gralloc_goldfish(3472): Emulator without GPU emulation detected.
03-03 21:36:12.045: D/AndroidRuntime(3472): Shutting down VM
03-03 21:36:12.045: W/dalvikvm(3472): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
03-03 21:36:12.103: E/AndroidRuntime(3472): FATAL EXCEPTION: main
03-03 21:36:12.103: E/AndroidRuntime(3472): android.os.NetworkOnMainThreadException
03-03 21:36:12.103: E/AndroidRuntime(3472):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at libcore.io.BlockGuardOs.recvfrom(BlockGuardOs.java:163)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at libcore.io.IoBridge.recvfrom(IoBridge.java:513)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at java.net.PlainSocketImpl.read(PlainSocketImpl.java:488)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at java.net.PlainSocketImpl.access$000(PlainSocketImpl.java:46)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at java.net.PlainSocketImpl$PlainSocketInputStream.read(PlainSocketImpl.java:240)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at libcore.io.Streams.readFully(Streams.java:81)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at java.io.DataInputStream.readShort(DataInputStream.java:169)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at java.io.DataInputStream.readUnsignedShort(DataInputStream.java:182)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at java.io.DataInputStream.readUTF(DataInputStream.java:186)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at com.exercise.AndroidClient.AndroidClient$LongOperation.onPostExecute(AndroidClient.java:80)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at com.exercise.AndroidClient.AndroidClient$LongOperation.onPostExecute(AndroidClient.java:1)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at android.os.AsyncTask.finish(AsyncTask.java:631)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at android.os.AsyncTask.access$600(AsyncTask.java:177)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:644)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at android.os.Looper.loop(Looper.java:137)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at android.app.ActivityThread.main(ActivityThread.java:4745)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at java.lang.reflect.Method.invokeNative(Native Method)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at java.lang.reflect.Method.invoke(Method.java:511)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
03-03 21:36:12.103: E/AndroidRuntime(3472):     at dalvik.system.NativeStart.main(Native Method)
03-03 21:36:14.722: I/Process(3472): Sending signal. PID: 3472 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:27:52.620

我假设 Activity 具有打开套接字的正确权限。

我猜想运行代码的问题是您正在 UI 线程上建立互联网连接。这是非常不鼓励的，有时只会导致应用程序停止。

你是正确的，你需要用你的代码创建一个 AsyncTask 并触发它。有两个地方可以了解这一点：[如何在自己的线程中执行 Web 请求？](https://stackoverflow.com/questions/2022170/how-to-execute-web-request-in-its-own-thread)在 Android中[发出异步 HTTP 请求是否有公认的最佳实践？](https://stackoverflow.com/questions/828280/is-there-an-accepted-best-practice-on-making-asynchronous-http-requests-in-andro)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T19:35:25.080

正如 Neil 之前所说：您必须在 doInBackgroud 中使用套接字。也接收字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-03T21:23:29.123

@nick28：您在第 45 行有一个未捕获的异常，您的第 45 行是什么？在初始化控件之前尝试以下代码，希望您的应用程序不会关闭：

```
if (android.os.Build.VERSION.SDK_INT > 9) {
StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
StrictMode.setThreadPolicy(policy);
} 
```

# mobile-safari - 在 iPhone 和 iPad 的 Safari 中，Divs 没有占据整页高度

> ID：15179031
> 
> 赞同：2
> 
> 时间：2013-03-02T20:21:39.680
> 
> 标签：mobile-safari, mobile-website, mobile-webkit

我一直无法让我的页面元素填充移动 Safari（iPhone 和 iPad）中 100% 的视口高度。我有一个元素，其中包含我的页面元素设置为 100% 高度（以及 HTML 和正文设置为 100% 高度），这确实填充了 100% 的视口高度。

问题是容器的 3 个子元素（.main-header:10%、.main-content:80% 和 .main-footer:10%）加起来 100% 的高度仍然很小（大约 2px ) 页面底部的空白处，我可以在其中看到父 (.page) 元素的背景。

如果其他人经历并解决了这个问题，我将非常感谢任何帮助。

谢谢！

你可以在这个小提琴上看到我精简的 HTML/CSS：http: [//jsfiddle.net/Rockstar79/zpTtF/](http://jsfiddle.net/Rockstar79/zpTtF/)

这是带有元标记等的完整代码：

CSS

```
html {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
}

body {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
}

div {
    margin: 0;
    padding: 0;
}

h1,h2,h3,h4,h5,h6,
p {
    font-size: 100%;
    margin: 0;
    padding: 0;
}

.page {
    width: 100%;
    height: 100%;
    position: relative;
    margin: 0;
    padding: 0;
}

.main-header {
    width: 100%;
    height: 10%;
    position: relative;
}

.main-content {
    width: 100%;
    height: 80%;
    position: relative;
    background-color: yellow;
}

.main-footer {
    width: 100%;
    height: 10%;
    position: relative;
}

.main-header,
.main-footer {
    background-color: blue;
} 
```

HTML

```
<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Plain Mobile Test</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link type="text/css" rel="stylesheet" href="css/main.css" />
</head>
<body>
    <div class="page" id="page-1">
        <div class="main-header">
            <h1>Header</h1>
        </div>
        <div class="main-content">
            <p>
                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Amet sunt aut libero sequi distinctio molestias nulla quidem fugiat. Maxime voluptates.
            </p>
        </div>
        <div class="main-footer">
            <h3>Footer</h3>
        </div>
    </div>
</body>
</html> 
```

# google-translate - 带有可编辑词汇表的个人翻译工具

> ID：15179037
> 
> 赞同：0
> 
> 时间：2013-03-02T20:21:59.993
> 
> 标签：google-translate, bing-api

我知道很多人会因为发表这篇文章而对我大喊大叫，因为这不是一个正确的问题，但如果可以的话，请在这篇文章关闭之前给我一些反馈:)

我想在我的网站上实现一个自动翻译脚本。我网站的内容会不断变化，我想要一个可以不断翻译它的脚本。我找到了 Microsoft Translate，当然还有 Google Translate API。

基本上我的问题是：有什么我可以个性化的吗？我可以在其中添加经常出现在我的网站中的单词，并为其添加翻译？或者只是用术语更新词汇表以获得更好的翻译？在 Google 翻译工具包中，您必须更新文档或网站并手动进行更改。我想更新翻译数据库，它会翻译我的网站。有什么建议吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:29:58.567

正如你所说，这不是一个合适的 SO 问题，所以这也不是一个合适的 SO 答案，但它足以让你开始。

我会去做你想做的事情的方式是拥有一个数据库，其中包含你的特殊单词的翻译，你有一个特殊的翻译（1 个索引列用于基本语言，更多列用于所有其他语言）。

然后，我将创建一个循环遍历一段文本中的所有单词的方法，并尝试在您的数据库中为它们找到翻译，如果找不到，它将获得谷歌/微软 API 的翻译表格.

当然，这不是一个完美的方法，但是您可以在该概念的基础上进行开发，以实现更适合您需求的东西。

# c# - 接口中的函数，它返回实现它的任何类的类型的对象

> ID：15179041
> 
> 赞同：2
> 
> 时间：2013-03-02T20:22:30.890
> 
> 标签：c#, function, inheritance, interface

这可能最好用一个例子来描述。

我有两个结构：Dog 和 Cat，它们都属于 IAnimal。

IAnimal 有一个函数 ConvertFrom(IAnimal) ，它将任何从 IAnimal 继承的对象转换为与调用该函数相同的类型。

例如：

我调用 Dog.ConvertFrom(cat) 并得到一只狗，其字段映射自 cat。

我调用 Cat.ConvertFrom(dog) 并得到一只猫，其字段映射自 dog。

有没有办法用接口做到这一点？指定函数必须返回与实现该函数的类相同的类型？

我想简单地把它写成：

```
IAnimal ConvertFrom(IAnimal) 
```

但我宁愿能够指定它作为狗或猫回来，而不是作为 IAnimal （从而减轻进一步的演员表）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T20:30:35.757

您可能正在谈论诸如[奇怪重复模板模式](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)之类的东西来实现静态多态性。您可以使用泛型来拥有：

```
public interface IAnimal

public interface IAnimal<T> : IAnimal where T : IAnimal<T>

public class Dog : IAnimal<Dog>

public class Cat : IAnimal<Cat> 
```

然后你的方法变成这样：

```
T ConvertFrom(IAnimal someAnimal) 
```

# mysql - MySQL5中如何实现跨表全局唯一ID（用于注释赋值）

> ID：15179047
> 
> 赞同：3
> 
> 时间：2013-03-02T20:23:09.367
> 
> 标签：mysql, sql

我有几个数据库表，它们对于不同类型的信息具有完全不同的字段。这些表代表应用程序前端中不同类别的数据。我想为所有这些数据集实现评论功能，无论它们属于什么类别（数据库表）。

所以我会设置一个“评论”表，其中每个条目都将作为 1:n 关系分配给某个数据集。当然，如果所有数据都存储在单个表中，这根本不是问题，但是我如何通过存储在多个表中的数据来解决这个问题，因为我只有每个表的唯一 ID？我需要所有表的某种全局 ID。

我正在考虑一个特定的表（类似于“glob_id，table，id”）来分配全局唯一 ID，但我一直在寻找一种方法，将表对应的 ID 分配给唯一的全局 ID。

任何尝试，如何解决这个问题？这是一个好方法吗？有什么不同的做法吗？

如果可能的话，我想在数据库级别解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:30:49.657

我不会继续使用 GUID / UID / 全局唯一标识符。相反，我会在主消息表和存储要评论的实体的单个表之间创建映射表。

每次插入到评论表中都会有一个 ID，然后该 ID 将被插入到包含要评论的原始实体的 ID 和评论 ID 的映射表中。

例如

**产品**：

```
id
name 
```

**产品评论**

```
product_id
comment_id 
```

**另一张桌子**

```
id
anothervalue 
```

**anothertable_comments**

```
some_id
comment_id 
```

**comments table**

```
id
comment 
```

The reason I would use a mapping table is because you would be required to create a new global identifier in each of your existing tables. The mapping table would also allow a many – many as well as a one to one relationship so someone could apply the same comment to more than one existing table.

**Edit:**

Single mapping table:

If there are lots of tables you want to add this to you can just create a single mapping table. For example:

**comments_table**

```
id
comment 
```

**table_map**

```
table_name
table_id
comment_id 
```

This way you would add the table name and the id of the row along with the comment id to this single mapping table. This reduces the number of tables you have to insert but you must then think about appropriate indexing for performance reasons as you don’t want to do a full table scan on mapping tables.

# google-chrome-extension - 如何使用 Chrome 扩展编辑当前查看的页面 html 源？

> ID：15179055
> 
> 赞同：1
> 
> 时间：2013-03-02T20:23:54.773
> 
> 标签：google-chrome-extension

我想构建一个 chrome 扩展，在加载时从页面中隐藏特定的 div（带 id）。

我想知道如何编辑源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T02:47:53.790

只需使用 jQuery，并在您的内容脚本中编写此代码：

```
$("#you_div_id").hide(); 
```

它是如此容易：）

# notepad++ - 在 Notepad++ 中手动突出显示选定的文本

> ID：15179057
> 
> 赞同：75
> 
> 时间：2013-03-02T20:24:00.257
> 
> 标签：notepad++, highlight

我试图找到一种方法来突出显示 Notepad++ 中的选定代码块，例如 Microsoft Word 允许您为文档执行此操作。这可能吗？

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2013-03-04T01:15:50.297

要在 Notepad++ 中突出显示代码块，请执行以下步骤

1.  选择所需的文本。
2.  右键单击以显示上下文菜单
3.  选择`Style token`并选择可用的五个选项中的任何一个（样式从`Using 1st style` 到`using 5th style`）。每个都有不同的颜色。如果你想要黄色，请选择`using 3rd style`。

如果您想创建自己的样式，可以`Style Configurator`在`Settings`菜单下使用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-02T20:34:19.890

> “选择您的文本，右键单击，然后选择`Style Token`并使用第一种样式（第二种样式等......）。目前无法保存样式标记，但有一个想法待定在 Idea torrent 上，如果您是，您可以投票对此感兴趣。”

它应该是默认的，但它可能是隐藏的。

> “可能是您发生了某些事情，`contextMenu.xml`因此您只能获得基本标准。如果存在，请查看 NPPs 配置文件夹 ( `%appdata%\Notepad++\`) `contextMenu.xml`。如果没有：那将是答案；如果是：这可能是缺陷。无论如何你可以[**从这里**](http://svn.tuxfamily.org/viewvc.cgi/notepadplus_repository/trunk/PowerEditor/src/contextMenu.xml?content-type=text%2Fplain&view=co)获取原始的标准 contextMenu.xml并将其放入配置文件夹（或替换现有的 xml）。启动 NPP，你应该有一个相当长的上下文菜单。**提示：**看看`contextmenu.xml`它本身 - 因为你重新允许将其更改为您自己的需要。”

有关更多信息，请参阅[此](http://sourceforge.net/p/notepad-plus/discussion/482781/thread/d30914d7)

# c# - 如何让 HttpClient Json 序列化程序忽略空值

> ID：15179060
> 
> 赞同：10
> 
> 时间：2013-03-02T20:24:07.617
> 
> 标签：c#, .net, json

我目前正在使用一个控制台应用程序，我正在使用 HttpClient 与 Apache CouchDB 数据库进行交互。我正在使用这篇文章：[http ://www.asp.net/web-api/overview/web-api-clients/calling-a-web-api-from-a-net-client](http://www.asp.net/web-api/overview/web-api-clients/calling-a-web-api-from-a-net-client)

当我通过 PostAsJsonSync 序列化并将文档发送到我的数据库时，我想忽略我的类中的 null 属性，但我不确定如何：

```
public static HttpResponseMessage InsertDocument(object doc, string name, string db)
    {
      HttpResponseMessage result;
      if (String.IsNullOrWhiteSpace(name)) result = clientSetup().PostAsJsonAsync(db, doc).Result;
      else result = clientSetup().PutAsJsonAsync(db + String.Format("/{0}", name), doc).Result;
      return result;
    }

    static HttpClient clientSetup()
    {
      HttpClientHandler handler = new HttpClientHandler();
      handler.Credentials = new NetworkCredential("**************", "**************");
      HttpClient client = new HttpClient(handler);
      client.BaseAddress = new Uri("*********************");
      //needed as otherwise returns plain text
      client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue("application/json"));
      return client;
    } 
```

这是我正在序列化的课程......

```
class TestDocument
  {
    public string Schema { get; set; }
    public long Timestamp { get; set; }
    public int Count { get; set; }
    public string _rev { get; set; }
    public string _id { get; set; } - would like this to be ignored if null
  } 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-02T20:43:23.043

假设您使用 Json.NET 序列化您的对象，您应该使用 JsonProperty 属性的 NullValueHandling 属性

```
[JsonProperty(NullValueHandling=NullValueHandling.Ignore)] 
```

查看这篇精彩的[文章](http://james.newtonking.com/archive/2009/10/23/efficient-json-with-json-net-reducing-serialized-json-size.aspx)和[在线帮助](http://james.newtonking.com/projects/json/help/html/T_Newtonsoft_Json_JsonIgnoreAttribute.htm)以获取更多详细信息

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-04-15T08:04:13.800

如果您要发送的所有类的所有属性都需要这种行为（正是这种情况导致我提出这个问题），我认为这会更干净：

```
using ( HttpClient http = new HttpClient() )
{
    var formatter = new JsonMediaTypeFormatter();
    formatter.SerializerSettings.NullValueHandling = Newtonsoft.Json.NullValueHandling.Ignore;

    TestDocument value = new TestDocument();
    HttpContent content = new ObjectContent<TestDocument>( value, formatter );
    await http.PutAsync( url, content );
} 
```

这样就无需向您的类添加属性，并且您仍然不必手动序列化所有值。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-05-30T01:42:35.843

使用 HttpClient.PostAsync

```
JsonMediaTypeFormatter jsonFormat = new JsonMediaTypeFormatter();
jsonFormat.SerializerSettings.DefaultValueHandling = Newtonsoft.Json.DefaultValueHandling.Ignore;
jsonFormat.SerializerSettings.NullValueHandling = Newtonsoft.Json.NullValueHandling.Ignore;

HttpResponseMessage res = c.PostAsync<T>(url, TObj, jsonFormat).Result; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-02T20:44:36.460

我不确定你现在可以用`PutAsJsonAsync`它来做到这一点。但是，如果您能够使用[Json.NET ，它可以做到这一点，并且如果有帮助，则存在 NuGet 包。](http://james.newtonking.com/projects/json-net.aspx)如果您可以使用它，我会将`InsertDocument`函数重写为：

```
public static HttpResponseMessage InsertDocument(object doc, string name, string db)
    {
      HttpResponseMessage result;
      string json = JsonConvert.SerializeObject(doc, Formatting.Indented, new JsonSerializerSettings { NullValueHandling = NullValueHandling.Ignore });
      if (String.IsNullOrWhiteSpace(name)) result = clientSetup().PostAsync(db, new StringContent(json, null, "application/json")).Result;
      else result = clientSetup().PutAsync(db + String.Format("/{0}", name), new StringContent(json, null, "application/json")).Result;
      return result;
    } 
```

# java - 将 ByteArrayOutputStream 转换为 BufferedImage

> ID：15179062
> 
> 赞同：3
> 
> 时间：2013-03-02T20:24:09.093
> 
> 标签：java, android, image, bufferedimage, bytearrayoutputstream

我有一个使用 ByteArrayOutputStream 创建的`QRGen Qr code generation library`，我想把它变成一个`BufferedImage`对象并在 Android 的 ImageView 中呈现它。如何实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:30:48.643

将 ByteArrayOutputStream 转换为 Byte 数组

```
byte[] data = baos.toByteArray(); //baos is your ByteArrayOutputStream object 
```

他们使用[BitmapFactory 从中创建一个位图](http://developer.android.com/reference/android/graphics/BitmapFactory.html#decodeByteArray%28byte%5B%5D,%20int,%20int,%20android.graphics.BitmapFactory.Options%29)

```
Bitmap bmp = BitmapFactory.decodeByteArray (data,0,data.length, null); 
```

他们拿你的[ImageView](http://developer.android.com/reference/android/widget/ImageView.html#setImageBitmap%28android.graphics.Bitmap%29)并设置它的位图

```
imageView.setImageBitmap(bmp); 
```

# java - 如何从电子表格中读取这些坐标？

> ID：15179063
> 
> 赞同：0
> 
> 时间：2013-03-02T20:24:29.907
> 
> 标签：java, spreadsheet

好的，所以我有一个 x、y 和 z 坐标的电子表格。x 和 y 是整数，z 是浮点数。我想读取所有坐标，但是当我尝试运行它时出现错误。这是错误：

```
Exception in thread "main" java.lang.NumberFormatException: For input string: "XCoord"
at java.lang.NumberFormatException.forInputString(Unknown Source)
at java.lang.Integer.parseInt(Unknown Source)
at java.lang.Integer.parseInt(Unknown Source 
```

这是我的代码：

```
BufferedReader br = new BufferedReader(new FileReader("./data/graphXYZ.csv"));
    String dataRow = br.readLine(); // Read first line.

    // The while checks to see if the data is null. If 
    // it is, we've hit the end of the file. If not, 
    // process the data.
    int i = 0;
    int xCoord, yCoord;
    float zCoord;

    while (dataRow != null) {
        String[] dataArray = dataRow.split(",");
        xCoord = Integer.parseInt(dataArray[0]);
        yCoord = Integer.parseInt(dataArray[1]);
        zCoord = Float.parseFloat(dataArray[2]);
        for(String item:dataArray) {
            System.out.print(xCoord + "\t");
            System.out.print(yCoord + "\t");
            System.out.print(zCoord + "\t");
        }
        System.out.println(); // Print the data line.
        dataRow = br.readLine(); // Read next line of data.
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T22:24:47.607

您的答案就在抛出的异常中。正如 esej 在评论中所说，您正在解析第一行列名（而不是数字）。因此输入字符串“XCoord”的 NumberFormatException

解决方案是跳过第一行，或将其从数据文件中删除。

# c# - 将字符串转换为 HtmlTableRow 控件

> ID：15179069
> 
> 赞同：2
> 
> 时间：2013-03-02T20:24:58.430
> 
> 标签：c#, asp.net, asp.net-webcontrol

我`<tr>`在客户端生成了一个 HTML 行 ()，我想转换包含`HtmlTableRow`控件中行单元信息的字符串。到目前为止，这就是我使用[Convert string to WebControls - asp.net](https://stackoverflow.com/questions/7013733/convert-string-to-webcontrols-asp-net)上的示例所做的。谢谢

```
 string row = "<tr><td>item</td><td><input name=\"radio0\" type=\"radio\"/></td></tr>";
    Dictionary<string, HtmlContainerControl> controlConstructor = new Dictionary<string, HtmlContainerControl>
                                                {

                                                    {"tr", new HtmlTableRow()},
                                                    {"td", new HtmlTableCell()}
                                                };
    var htmlDoc = XElement.Parse(row);
    Func<XElement, HtmlControl> constructHtmlStructure = null;
    constructHtmlStructure = (o =>
                                {
                                    var control = controlConstructor[o.Name.ToString()];
                                    if (o.HasElements)
                                    {
                                        control.Controls.Add(constructHtmlStructure(o.Elements().Single())); //Exception: Sequence contains more than one element (When is a input item)
                                    }
                                    else
                                    {
                                        control.InnerText = o.Value;
                                    }
                                    return control;
                                });

    HtmlTableRow structure = (HtmlTableRow)constructHtmlStructure(htmlDoc); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:23:42.800

为什么不使用更简单的方法将字符串解析为 HtmlTableRow。

您`Dictionary<string, HtmlContainerControl> controlConstructor` 只考虑`tr`和`td`，嵌套在其中的输入控件呢？

所以即使你通过那个“ `sequence contains more than one element`”，使用foreach循环，你也会得到一个错误`"key doesn't exist`“。

即使您设法克服了这一点（通过在字典中添加输入键），您也无法将其解析为`HtmlContainerControl`.

即使你这样做了，通过更新你的`Dictionary<string, HtmlContainerControl>`to `Dictionary<string, HtmlControl>`，你也必须想办法处理那个输入控件，因为你不能这样做`control.InnerText = o.value;`

因此有一个更简单的方法：

```
string row = "<tr><td>item</td><td><input name=\"radio0\" type=\"radio\"/></td></tr>";
        XmlDocument doc = new XmlDocument();
        doc.LoadXml(row);

        HtmlTableRow tblRow = new HtmlTableRow();
        foreach (XmlNode node in doc.SelectSingleNode("tr").ChildNodes)
        {
            HtmlTableCell cell = new HtmlTableCell();
            cell.InnerText = node.InnerXml;
            foreach (XmlNode childNode in node.ChildNodes)
            {
                if (childNode.Name == "input")
                {
                    if (childNode.Attributes["type"] != null)
                    {
                        switch (childNode.Attributes["type"].Value.ToString())
                        {
                            case "radio":
                                HtmlInputRadioButton rad = new HtmlInputRadioButton();
                                rad.Name = childNode.Attributes["name"].ToString();
                                cell.Controls.Add(rad);

                                break;

                            ///other types of input controls
                            default:
                                break;
                        }

                    }
                    else
                    {
                        HtmlInputButton button = new HtmlInputButton("button");
                        cell.Controls.Add(button);
                    }
                }
            }
            tblRow.Cells.Add(cell);
        } 
```

正如你所看到的，这是一个非常粗略和严格的逻辑：你能做的最好的事情就是想出一个递归函数来构造你的 HtmlTableRow

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:13:51.333

Linq 的`Single`方法返回序列的第一个也是唯一一个元素 - 如果有多个元素，它会抛出您看到的异常。由于您的表格行包含两个表格单元格，它的`o.Elements()`方法返回一个具有两个成员的可枚举，并且 using`Single`使它翻倒。

而不是使用：

```
control.Controls.Add(constructHtmlStructure(o.Elements().Single())); 
```

...利用：

```
foreach(var element in o.Elements())
{
    control.Controls.Add(constructHtmlStructure(element));
} 
```

这样您就可以遍历表格行的每个单元格，并将每个单元格添加到控件中。

**编辑**

您还需要进行另一项更改。您的字典包含准确`HtmlTableRow`的和准确的一个`HtmlTableRow`，两者都在您进入时已经创建`constructHtmlStructure`。您应该让字典根据需要创建每种类型的新实例，而不是预先存在对象（因此每个对象只有一个实例）。

所以代替这个（调整间距）：

```
var controlConstructor = new Dictionary<string, HtmlContainerControl>
{
    { "tr", new HtmlTableRow() },
    { "td", new HtmlTableCell() }
};

...

var control = controlConstructor[o.Name.ToString()]; 
```

...尝试这个：

```
var controlConstructor = new Dictionary<string, Func<XElement, HtmlControl>>
{
    { "tr", o => new HtmlTableRow() },
    { "td", o => new HtmlTableCell() }
};

...

var control = controlConstructor[o.Name.ToString()].Invoke(o); 
```

您还需要一个函数来从 中创建输入`XElement`，如下所示：

```
private static HtmlControl CreateInputFromElement(XElement element)
{
    // Create an appropriate HtmlInputControl...
} 
```

...您可以像这样将其添加到字典中：

```
var controlConstructor = new Dictionary<string, Func<XElement, HtmlControl>>
{
    { "tr", o => new HtmlTableRow() },
    { "td", o => new HtmlTableCell() },
    { "input", CreateInputFromElement }
}; 
```

# oracle - 更新和删除 Oracle 触发器

> ID：15179073
> 
> 赞同：1
> 
> 时间：2013-03-02T20:25:15.230
> 
> 标签：oracle, triggers

几天前发布了一个问题，并成功让我的触发器工作！但是遇到了一些新问题。

我有两张桌子：

```
CREATE TABLE  "ASSESSMENT" 
  (     "ASSESSMENT_NAME" VARCHAR2(50) NOT NULL ENABLE, 
        "DEADLINE_DATE" DATE NOT NULL ENABLE, 
         CONSTRAINT "ASSESSMENT_PK" PRIMARY KEY ("ASSESSMENT_NAME") ENABLE
  )

CREATE TABLE  "ASSESSMENT_ANNOUNCEMENT" 
  (    "ASSESSMENT_NAME" VARCHAR2(50) NOT NULL ENABLE, 
        "DEADLINE_DATE" DATE NOT NULL ENABLE, 
        "ATTENTION" VARCHAR2(500) NOT NULL ENABLE, 
        CONSTRAINT "ASSESSMENT_ANNOUNCEMENT_PK" PRIMARY KEY ("ASSESSMENT_NAME")  ENABLE
  ) 
```

我的触发器：

```
CREATE OR REPLACE TRIGGER  "TEST"
  AFTER INSERT OR UPDATE OR DELETE 
  ON ASSESSMENT
FOR EACH ROW
BEGIN
  IF :new.DEADLINE_DATE >= SYSDATE - 7
  THEN
    INSERT INTO ASSESSMENT_ANNOUNCEMENT(ASSESSMENT_NAME, DEADLINE_DATE ,ATTENTION)
      VALUES(:new.ASSESSMENT_NAME, :new.DEADLINE_DATE, 'DEADLINE IS 7 DAYS OR LESS!');
  END IF;
END; 
```

插入在表格中正常工作。但是，当我更新`ASSESSMENT`表格时，表格中会插入一个新行`ASSESSMENT_ANNOUNCEMENT`- 它没有更新。

从表中删除会从`ASSESSMENT`表中删除行，`ASSESSMENT`但不会从表中删除条目`ASSESSMENT_ANNOUNCEMENT`。

任何帮助和/或指导都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:02:04.843

如果要更新或删除 中的行`ASSESSMENT_ANNOUNCEMENT`，则应使用`update`or`delete`语句显式执行。
在触发器中使用以下结构：

```
IF INSERTING THEN
  -- actions for inserting
ELSIF UPDATING THEN
  -- actions for updating
ELSE
  -- actions for deleting
END IF; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T07:12:35.327

只是为了给你一个完整的样本

```
CREATE OR REPLACE TRIGGER  "TEST"
    AFTER INSERT OR UPDATE OR DELETE 
    ON ASSESSMENT
FOR EACH ROW
BEGIN
    IF INSERTING THEN
        IF :new.DEADLINE_DATE >= SYSDATE - 7
        THEN
            INSERT INTO ASSESSMENT_ANNOUNCEMENT(ASSESSMENT_NAME, DEADLINE_DATE ,ATTENTION)
            VALUES(:new.ASSESSMENT_NAME, :new.DEADLINE_DATE, 'DEADLINE IS 7 DAYS OR LESS!');
        END IF;

    ELSIF UPDATING THEN
        UPDATE ASSESSMENT_ANNOUNCEMENT SET 
          ASSESSMENT_NAME=:new.ASSESSMENT_NAME,
          DEADLINE_DATE=:new.DEADLINE_DATE,
          ATTENTION='Deadline Updated'
        WHERE ASSESSMENT_NAME=:old.ASSESSMENT_NAME;

    ELSE
       DELETE ASSESSMENT_ANNOUNCEMENT
         WHERE ASSESSMENT_NAME=:old.ASSESSMENT_NAME;
    END IF; 
END; 
```

根据你真实的业务逻辑和 PL/SQL 代码的大小，创建三个触发器可能会更清楚

```
CREATE OR REPLACE TRIGGER "TEST_AI_TRG" AFTER INSERT ON ASSESSMENT ...
CREATE OR REPLACE TRIGGER "TEST_AU_TRG" AFTER UPDATE ON ASSESSMENT ...
CREATE OR REPLACE TRIGGER "TEST_AD_TRG" AFTER DELETE ON ASSESSMENT ... 
```

# ruby - 为什么将 gems 安装到 1.9.1 中。即使我安装了 1.9.3 目录？

> ID：15179074
> 
> 赞同：3
> 
> 时间：2013-03-02T20:25:16.230
> 
> 标签：ruby, binary, filesystems, gem

我试图弄清楚如何在 Chef 中引用 gem 二进制文件，我突然想到 gem 总是加载在一个`1.9.1`目录中，而不是`1.9.3`....

谁能解释一下？

如果/当我迁移到 Ruby 2 时，这会改变吗？`1.9.1`如果它会改变，不想硬编码......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:34:39.343

在 chef 中，您可以找到 ruby​​gems 创建可执行文件的目录`node["languages"]["ruby"]["bin_dir"]`。因此，您永远不应该在您的食谱中对这些路径进行硬编码，因为它们可能会改变。

至于您的确切问题：在 Ruby >= 1.9.1 和 < 2.0.0 中， ruby​​gems 将 gems 安装到一个`1.9.1`目录中以表示其对 1.9.1 [ABI](http://en.wikipedia.org/wiki/Application_binary_interface)的使用。其目的是针对它编译的 gem 可以在使用此 ABI 的不同 ruby​​ 版本之间互换使用。然而，在实践中，这变得更加困难......

Ruby 2.0.0 使用该`2.0.0`目录。同样，您不应该对路径进行硬编码，而是使用节点属性（由 OHAI 使用 ruby​​gem 自己的工具设置）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:56:25.137

您可以随时使用：

```
$ gem env gemdir 
```

或者

```
$ gem env gempath 
```

获取您的 gems 目录。

# jquery - 当我单击一个按钮时，IE9 问题会触发其他按钮的所有事件？

> ID：15179075
> 
> 赞同：-1
> 
> 时间：2013-03-02T20:25:24.023
> 
> 标签：jquery, onclick, internet-explorer-9

我有 4 个按钮，它们在提交表单之外？当我单击一个按钮时，它会触发其他按钮的所有单击事件。我看到了这篇文章，将我的输入更改为按钮。它没有帮助，有什么建议吗？

我的页面：

```
 @using (Html.BeginForm("ReportQuestionaire", "Question", FormMethod.Post, new { id = "SignupForm" }))
       {
           // code removed 
       }

 <button type="button" id="review_btn" onclick="reviewScreen();"></button>
            <button type="button" id="SaveAccount" onclick="SaveComplete();"></button>
            <button type="button" id="Next"></button>
            <button type="button" id="Previous"></button> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:29:35.067

检查您的 DOM 结构以确认 IE 没有误解它并将第一个按钮包裹在接下来的三个周围。

此外，这个问题不仅仅是 jquery 相关的。

# java - 如何在eclipse中将一个类的引用更改为另一个类

> ID：15179079
> 
> 赞同：2
> 
> 时间：2013-03-02T20:25:43.593
> 
> 标签：java, eclipse, class

我已经从具有不同方法实现的旧类中创建了一个新类。现在，我想将那个旧类的所有引用更新到这个新类。无论如何在eclipse中自动执行此操作？

实际上，我可以对这个旧类进行重命名（使用更新引用）并将新代码复制到其中，但是整个代码都在源代码管理中，这让我的生活变得更加艰难。

我只是想知道是否有一种简单的方法可以做到这一点，并在最后拥有两个类并将引用更新到新类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:30:07.893

使用重构功能应该可以解决问题。将旧类重构为新类：

右键单击类名，重构 > 重命名 > 输入类的新名称 > 按 Enter。

这应该这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:30:50.637

我不知道有任何现有的重构可以做到这一点，但它很简单：

1.  暂时将您的新课程重命名为其他名称。
2.  将旧类重构/重命名为新类名。
3.  手动（非重构）将旧类重命名为其原始名称。
4.  手动（非重构）将新类重命名为其原始名称。

通过这种方式，您可以获得重命名重构的强大功能来帮助您更新引用，但最终，这些类仍然与以前相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:36:41.407

右键单击您的类文件选择重构，然后将其重命名为您想要的任何内容..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T20:48:04.930

我的猜测是，问这个问题的人正在使用 Perforce 或 ClearCase 之类的东西，临时重命名文件很痛苦。

最好的办法是做一个简单的 Eclipse 全局文件搜索和替换。单击搜索-> 文件，然后单击底部的替换按钮。

![Eclipse 文件替换搜索](../Images/b57c0300e027bc5903cf0bbd72f4d086.png)

# wordpress - wordpress 博客页面将年/月文件夹添加到其他页面 url

> ID：15179081
> 
> 赞同：0
> 
> 时间：2013-03-02T20:25:45.967
> 
> 标签：wordpress

我似乎将年/月文件夹添加到我所有的 WordPress 博客页面 url 中。

所以在这个页面上：www.mydomain.co.uk/2013/03/handleless-kitchens/

我会得到：www.mydomain.co.uk/2013/03/talk-to-us/

而不仅仅是：www.mydomain.co.uk/talk-to-us/

有任何想法吗？这只发生在实际的博客本身中，而不是博客/新闻摘要页面等。

TIA

使用 WordPress 3.5.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:31:12.883

在管理菜单

```
Settings->Permalinks 
```

选择自定义结构并写入

```
/%postname& 
```

到编辑框

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:34:52.933

从管理面板转到设置->永久链接并选择要显示的结构类型..

# c++ - 如何用 Winsock2 处理短读？

> ID：15179084
> 
> 赞同：0
> 
> 时间：2013-03-02T20:26:03.657
> 
> 标签：c++, winsock2

我在使用 Windows 的 Winsock2 通过网络接收数据时遇到问题。我正在尝试使用简单的客户端和服务器系统来实现文件传输程序。使用我们当前的代码，最后进来的数据包不会附加到文件中，因为它不是缓冲区的大小。因此，文件传输并不完全，会引发错误并中断。它并不总是最后一个数据包，有时它更早。

这是**服务器代码**的片段：

```
int iResult;
ifstream sendFile(path,  ifstream::binary);
char* buf;

if (sendFile.is_open()) {
printf("File Opened!\n");
// Sends the file
while (sendFile.good()) {
    buf = new char[1024];
    sendFile.read(buf, 1024);
    iResult = send(AcceptSocket, buf, (int)strlen(buf)-4, 0 );
    if (iResult == SOCKET_ERROR) {
        wprintf(L"send failed with error: %d\n", WSAGetLastError());
        closesocket(AcceptSocket);
        WSACleanup();
        return 1;
    }
    //printf("Bytes Sent: %d\n", iResult);
}
sendFile.close(); 
```

}

这是**客户端代码**的片段：

```
int iResult;
int recvbuflen = DEFAULT_BUFLEN;
char recvbuf[DEFAULT_BUFLEN] = "";

do {
    iResult = recv(ConnectSocket, recvbuf, recvbuflen, 0);
    if ( iResult > 0){
        printf("%s",recvbuf);
        myfile.write(recvbuf, iResult);
    }
    else if ( iResult == 0 ) {
        wprintf(L"Connection closed\n");
    } else {
        wprintf(L"recv failed with error: %d\n", WSAGetLastError());
    }

} while( iResult > 0 );

myfile.close(); 
```

尝试传输作为字典的文件时，它可能会随机中断。例如，一个运行在 S 的早期中断并在末尾附加了奇怪的字符，这并不罕见：

```
...
sayable
sayer
sayers
sayest
sayid
sayids
saying
sayings
╠╠╠╠╠╠╠╠recv failed with error: 10054 
```

我能做些什么来处理这些错误和奇怪的字符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:40:28.347

错误发生在服务器端。您收到“对等方重置连接”错误。

这条线 - `buf = new char[1024];`- 显然是有问题的，并且很可能导致服务器崩溃，因为它耗尽了内存。没有清理发生。首先添加适当的`delete`语句，最好放在`send`调用之后。如果那不能解决它，我将使用一个小测试文件并逐步执行服务器代码中的 while 循环。

PS 比在循环中使用`new`and更好的解决方案`delete`是重用现有的 buff。编译器可能会优化这个错误，但如果不是这样，你就会严重阻碍应用程序的性能。我认为您实际上应该移出`buf = new char[1024];`循环。`buf`是一个 char 指针，所以如果你传递它`read`，它将继续覆盖它的内容。一遍又一遍地重新分配缓冲区是不好的。`buf``buf`

关于错误 MSDN 说：

现有连接被远程主机强行关闭。如果远程主机上的对等应用程序突然停止，主机重新启动，主机或远程网络接口被禁用，或者远程主机使用硬关闭，这通常会导致（有关远程主机上 SO_LINGER 选项的更多信息，请参阅 setsockopt插座）。如果在一个或多个操作正在进行时，由于保活活动检测到故障而导致连接中断，则也可能导致此错误。正在进行的操作因 WSAENETRESET 而失败。后续操作因 WSAECONNRESET 而失败。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-02T20:41:43.153

首先，在循环中使用**new**运算符可能不好，尤其是没有相应的**delete**。我不是 C++ 专家，虽然（只有 C）但我认为值得检查。

其次，套接字错误 10054 是“对等连接重置”，它告诉我服务器没有在套接字上执行所谓的*正常关闭。*通过优雅关闭，WinSock 将等到对方接收到所有待处理的数据，然后再发送中断连接的 FIN 消息。您的服务器很可能只是在将最终缓冲区提供给 WinSock 后立即关闭，而没有任何时间进行传输。您需要查看`SO_LINGER`套接字选项——它们解释了优雅关闭与非优雅关闭。

简单来说，要么需要在连接中添加自己的协议，以便客户端可以确认收到最终数据块，要么服务器端需要调用`setsocketopt()`设置`SO_LINGER`超时，以便 WinSock 等待来自 TCP/IP 的确认客户端在通过网络发出套接字关闭之前的最后一个数据块。如果你不做这些事情中的至少**一件**，那么就会出现这个问题。

您可能还想查看另一篇关于此的文章：

[套接字错误 10054](https://stackoverflow.com/questions/8558738/socket-error-10054)

祝你好运！

# android - 如何故意用 viewpager 重新创建片段？

> ID：15179086
> 
> 赞同：0
> 
> 时间：2013-03-02T20:26:17.803
> 
> 标签：android, overriding, android-viewpager, fragment

我正在使用带有一些片段的 ViewPager。我想实现下一个小效果：如果我滑动到 viewpager 的第一页（因此页面的索引等于 0），我想重新创建它。所以我不希望它从内存中被拉出来，我想在每次滑动到那个页面时重新创建它。我读到我需要重写 instantiateItem 方法，但我做不到。

```
public class PagerAdapter1 extends FragmentPagerAdapter {

    private List<String> fragments;
       private static final String TAG = "FragmentPagerAdapter";
        private static final boolean DEBUG = false;

        private final FragmentManager mFragmentManager;
        private FragmentTransaction mCurTransaction = null;

    /**
     * @param fm
     * @param fragments2
     */
    public PagerAdapter1(FragmentManager fm, List<String> fragments2) {
        super(fm);
        mFragmentManager=fm;
        this.fragments = fragments2;
    }
    /* (non-Javadoc)
     * @see android.support.v4.app.FragmentPagerAdapter#getItem(int)
     */
    @Override
    public Fragment getItem(int position) {
        //return this.fragments.get(position);
        return Fragment.instantiate(ViewPagerActivity.context, fragments.get(position));
    }

    /* (non-Javadoc)
     * @see android.support.v4.view.PagerAdapter#getCount()
     */
    @Override
    public int getCount() {
        return this.fragments.size();
    }

    @Override
    public Object instantiateItem(View container, int position) {
       Log.i("OVERRIDE", "OVERRIDE");

        if (mCurTransaction == null) {
            mCurTransaction = mFragmentManager.beginTransaction();
        }

        // Do we already have this fragment?
        String name = makeFragmentName(container.getId(), position);
        Fragment fragment = mFragmentManager.findFragmentByTag(name);
        if (fragment != null) {
            if (DEBUG) Log.v(TAG, "Attaching item #" + position + ": f=" + fragment);
            mCurTransaction.attach(fragment);
        } else {
            fragment = getItem(position);
            if (DEBUG) Log.v(TAG, "Adding item #" + position + ": f=" + fragment);
            mCurTransaction.add(container.getId(), fragment,
                    makeFragmentName(container.getId(), position));
        }

        return fragment;
    }
    private static String makeFragmentName(int viewId, int index) {
        return "android:switcher:" + viewId + ":" + index;
    }
} 
```

我从来没有得到 OVERRIDE 标签。所以我的第一个问题是，为什么我不明白呢？以及我应该如何重写这个方法（如果这是我需要的）以达到我之前写的效果？我想要它，因为我在第 0 页保存了一个复选框的状态，但是优化扭曲了它，因为如果我滑动到第 1 页，第 0 页不会被破坏，所以它不会重新创建它并且复选框的状态不会被保存（除非我滑动到第 2 页，因为我使用 setOffScreenLimit(1)）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:41:33.070

`mAdapter.notifyDataSetChanged()`是一个解决方案。但是，这会删除所有页面并通过再次实例化将它们放回原处。好消息是尚未引起任何副作用。（强制关闭，或异常）

# django - django LOGIN_REDIRECT_URL 奇怪的行为

> ID：15179091
> 
> 赞同：0
> 
> 时间：2013-03-02T20:26:28.890
> 
> 标签：django, wsgi, django-settings

我在子路径 /foo 上有一个 django (1.4.5) 站点。

在我的 setting.py 中，我有以下设置。所有访问都需要登录。

```
LOGIN_URL='/foo/login/'
LOGIN_REDIRECT_URL='/foo/' 
```

我遇到了奇怪的行为。当我去时，`https://my.site.com/foo/` 我会被正确的查询字符串重定向..`https://my.site.com/foo/login/?next=/foo/`

但是当我去`https://my.site.com/foo`（没有斜杠）时，我被重定向到 `https:// my.site.com/foo/login/?next=/`

有没有人见过这个问题？

# php - 单击文章时出现 404 错误

> ID：15179094
> 
> 赞同：1
> 
> 时间：2013-03-02T20:26:41.653
> 
> 标签：php, oop, codeigniter, codeigniter-routing

我正在构建我的第一个 CodeIgniter 网站，并且我正在克服一个似乎难以解决的问题..

当我点击一篇文章阅读它时，我不断得到一个 404 页面。（ 未找到 ）

我得到的链接如下

index.php/articles/articlename

在我的控制器中，我有以下视图部分

```
 public function view($slug) {
    $data['article_item'] = $this->articles_model->get_article($slug);

    if (empty($data['article_item']))
    {
        show_404();
    }

    $data['title'] = $data['article_item']['title'];

    $this->load->view('templates/header', $data);
    $this->load->view('articles/view', $data);
    $this->load->view('templates/side', $data);
    $this->load->view('templates/footer');
} 
```

如您所见，它必须在文章目录中包含 view.php

在我的路由器中，我有以下内容

```
 $route['articles/(:any)'] = 'articles/view/$1';
$route['articles/create'] = 'articles/create';
$route['(:any)'] = 'pages/view/$1';
$route['gallery'] = 'gallery';
$route['articles'] = 'articles';
$route['default_controller'] = 'home';
$route['404_override'] = ''; 
```

只是为了确保我在这里发布了所有相关的东西是我创建的链接

```
<a href="articles/<?php echo $article_item['slug'] ?>" class="button">Read more</a> 
```

和模型

```
 <?php
class Articles_model extends CI_Model {

    public function __construct() {
        $this->load->database();
    }

    public function get_article($slug = FALSE) {
        if ($slug === FALSE) {
            $query = $this->db->get('articles');
            return $query->result_array();
        }

        $query = $this->db->get_where('articles', array('slug' => $slug));
        return $query->row_array();
    }
} 
```

我希望有人能告诉我我在这里做错了什么..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-30T08:16:39.773

您在链接中缺少函数名称。

您的网址应该是：index.php/articles/view/articlename

在您的 URL 中 index.php 之后的第一部分是您的类的名称，第二部分是您的函数名称，然后是您的输入值

# ios - MpMovieplayerController 点击手势识别器在全屏时不会触发

> ID：15179095
> 
> 赞同：4
> 
> 时间：2013-03-02T20:26:45.840
> 
> 标签：ios, objective-c, mpmovieplayercontroller, uitapgesturerecognizer

我正在尝试使用`UITapGestureRecognizer`以处理全屏视频上的点击。如果我忽略`[self.player setFullscreen:YES animated:NO];`它，那么我的视频将无法缩放以适应屏幕。

从我的.m：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSString *videoPath = [[NSBundle mainBundle] pathForResource:@"test" ofType:@"mov"];
    player =  [[MPMoviePlayerController alloc] initWithContentURL:[NSURL fileURLWithPath:videoPath]];

    player.shouldAutoplay = NO;
    player.view.frame = self.view.bounds;
    player.scalingMode = MPMovieScalingModeAspectFit;
    player.controlStyle = MPMovieControlStyleNone;
    player.fullscreen = YES;
    self.player = player;
    [self.player prepareToPlay];

    UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTap:)];
    UIView *aView = [[UIView alloc] initWithFrame:player.view.bounds];
    [aView addGestureRecognizer:tapGesture];
    [self.player.view addSubview:aView];
}

- (IBAction)playMovie:(id)sender {
    //add the MPMoviePlayerViewController to this view (as subview)
    //Play movie
    [self.view addSubview:self.player.view];
    [self.player setFullscreen:YES animated:NO]; //commenting out this will make it work
    [self.player play];
}

- (void)handleTap:(UITapGestureRecognizer *)recognizer {
    NSLog(@"tap tap");
} 
```

从我的.h：

```
@property (retain, nonatomic) MPMoviePlayerController *player;
- (void)handleTap:(UITapGestureRecognizer *)recognizer; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:14:34.317

你可以试试这个：

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(willEnterFullScreen:)
                                             name:MPMoviePlayerWillEnterFullscreenNotification
                                           object:nil];

- (void)willEnterFullScreen:(NSNotification*)notification
{
    UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTap:)];
    UIView *aView = [[UIView alloc] initWithFrame:self.player.backgroundView.bounds];
    [aView addGestureRecognizer:tapGesture];
    [self.view.window addSubview:aView];
} 
```

然后在发布 MPMoviePlayerWillExitFullscreenNotification 时删除您的子视图

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:52:01.390

在我的评论中，我草拟了如何在使用正确的全屏 ( `[self.player setFullscreen:YES animated:NO];`) 时覆盖它。

我建议您通过相应地设置其框架来简单地调整播放器视图的大小以覆盖整个屏幕。

您初始化代码将不得不摆脱它`player.fullscreen = YES;`，但我想现在很明显。

# javascript - JS 字符串/数字和垃圾回收

> ID：15179103
> 
> 赞同：6
> 
> 时间：2013-03-02T20:27:52.330
> 
> 标签：javascript, string, garbage-collection

## tl;博士

以下代码行是否创建了一个对象（如 JavaScript String 对象或 JavaScript Number 对象）来组合字符串原语和数字？

```
var scouterSays = "powerlvl" + 9001; 
```

## 完整问题

我正在用 JavaScript 编写游戏引擎，并试图非常小心垃圾收集。我已经阅读了[http://www.scirra.com/blog/76/how-to-write-low-garbage-real-time-javascript](http://www.scirra.com/blog/76/how-to-write-low-garbage-real-time-javascript)和[http://buildnewgames.com/garbage-collector-friendly-code /](http://buildnewgames.com/garbage-collector-friendly-code/)这非常有帮助。我已经实现了对象池，并且尽可能地避免了数组操作以支持链表。

现在，如果我理解正确，如果我在原始字符串上调用字符串方法，则会创建一个字符串对象并替换我的原始字符串。示例是长度、子字符串、indexOf 等。由于我使用字符串来识别具有对象池的对象类型，因此我担心每次从池中拉出对象时都会产生垃圾。

简而言之，以下是否会导致创建对象（如 JavaScript String 对象或 JavaScript Number 对象）？

```
var byteSize = 4;
var objectType = "msg" + byteSize; //does this create a JS String/Number object?
var message = gameengine.pool.acquire(objectType); 
```

另外，一个相关的问题是，使用按位运算（如 ~~() 或 << 或 >>）是否也会导致创建 JavaScript 对象？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-02T22:16:12.330

我对 JavaScript GC 的信任度为零，这是我远离这种语言的基本原因。无论如何，我试图回复的是：

```
var x = 1;
alert(typeof x); //number

var n = new Number(1);
alert(typeof n); //object

var scouterSays = "powerlvl" + 9001;
alert(typeof scouterSays); //string

var txt = new String("string");
alert(typeof txt); //object

var test1 = new Boolean(true);
var test2 = String(test1); //convert object to string
alert(typeof test2); //string 
```

# jquery-ui - $scope.slider - 未更新

> ID：15179108
> 
> 赞同：2
> 
> 时间：2013-03-02T20:28:33.073
> 
> 标签：jquery-ui, angularjs, angular-ui

我有一个 jquery-ui 滑块，它使用滑块的值更新文本框。

文本框具有 ng-model，因此我可以从控制器获取值 - 但在移动滑块后该值不会更新（文本框内的值在视觉上发生变化，但 $scope.slider 保持不变）。

如果我在文本框中手动更改值，一切都会按预期工作，并且 $scope.slider 的值会使用新值进行更新。

有没有办法让滑块也更新范围的值？

```
 <input type="text" id="rent"  ng-model="rent" style="border: 0; color: #f6931f; font-weight: bold;" />
  <div id="slider-rent" style="width: 80%;"></div>

  $("#slider-rent").slider({
        range: false,
        min: 0,
        max: 20000,
        step: 10,
        value: 0,
        slide: function (event, ui) {
            $("#rent").val(ui.value);
        }
    });
    $("#rent").val($("#slider-rent").slider("value"));
    $("#rent").change(function () {

        $("#slider-rent").slider("value", $("#rent").val());
    }); 
```

（这是一个 rtl 滑块，这就是为什么值为负数）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T22:06:33.960

最好将滑块代码放入角度指令中，以便您可以访问控制器范围。

但是，如果您触发它`input event`，`input element`它将更新角度`model`

```
function updateInputValue( newVal){
     $("#rent").val(newVal).trigger('input');    
}

$(function () {
    $("#slider-rent").slider({
        range: false,
        min: 0,
        max: 20000,
        step: 10,
        value: 0,
        slide: function (event, ui) {
            updateInputValue(ui.value);
        }
    });
    updateInputValue($("#slider-rent").slider("value"));
    $("#rent").change(function () {
        $("#slider-rent").slider("value", $("#rent").val());
    });
}) 
```

演示：http: [//jsfiddle.net/zwHQs/](http://jsfiddle.net/zwHQs/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T22:10:01.703

试试这个：

```
slide: function (event, ui) {
    $scope.rent = ui.value;

} 
```

以上假设您显示的代码在指令内部/包装在指令中。

# java - 将 2 个数组列表添加到另一个数组列表

> ID：15179112
> 
> 赞同：0
> 
> 时间：2013-03-02T20:29:28.673
> 
> 标签：java

我有 2 个这样的数组列表，但我不确定如何将它们组合在一起。我已经尝试过 Collections.copy() 和 addAll 方法，但它不起作用，我想知道是否有任何方法可以将它们组合到另一个数组列表中？我真正想要的是让第一个数组列表存储来自第二个数组列表的数据，所以每个点里面都会有几行。也许你们可以给我一些关于我如何做到这一点的建议，谢谢。

```
 static ArrayList<Vertex> getPoints() {
      Scanner input = Reader(Vertex.airports);
      ArrayList<Vertex> result = new ArrayList<Vertex>();

      while(input.hasNext()){
          String point = input.nextLine();
          result.add(new Vertex(point));

      }
      input.close();
      return result;

  }

  static ArrayList<Edge> getlines(){
          Scanner input = Reader(Vertex.graph);
          ArrayList<Edge> result = new ArrayList<Edge>();

          while(input.hasNext()){
              String route = input.nextLine();
              result.add(new Edge(route));
          }
          input.close();
          return result;

      } 
```

数据来自 2 个文本文件，文件如下所示。它们只是其中的一部分，以展示我在这里尝试做的事情。（索引，名称）

```
1 England
2 France 
```

## 3 荷兰

（索引，开始，成本，结束）

```
1 1 2 2
2 1 3 1
3 1 6 3
4 1 7 3
5 2 1 2
6 2 3 1
7 2 4 1
8 2 5 2
9 2 6 2
10 3 1 1
11 3 2 1
12 3 4 1
13 3 8 1
14 3 10 2 
```

感谢福特船长，这已经完成了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:45:17.657

好吧，我的理解是第一个列表包含一个机场列表，第二个列表连接第一个列表中的机场。

如果要存储对具有关联点的线的引用，则需要在包含另一个列表的点周围创建一个包装器。

```
class Airport {
    public Vertex point;
    public List<Edge> routes = new ArrayList<Edge>();

    public Airport(Vertex p){
        this.point = p;
    }
} 
```

然后，当您加载列表时，您将执行以下操作：

```
static ArrayList<Airport> getAirports() {
    Scanner input = Reader(Vertex.airports);
    ArrayList<Vertex> result = new ArrayList<Vertex>();

    while(input.hasNext()){
        String point = input.nextLine();
        //  Note the small change on the next line
        result.add(new Airport(new Vertex(point)));

    }
    input.close();
    return result;
}

static ArrayList<Edge> getlines(){
    Scanner input = Reader(Vertex.graph);
    ArrayList<Edge> result = new ArrayList<Edge>();

    while(input.hasNext()){
        String route = input.nextLine();
        result.add(new Edge(route));
    }
    input.close();
    return result;

}

static void combineLists(List<Airport> airports, List<Edge> lines){
    for(Edge edge : lines){
        //  This is where we add the routes to both airports
        //  Since I don't know the structure of the edge class, I'm making a guess that you're using the integer indices that were described in the file to describe the endpoints. Note, however, that you will need to find a way to guarantee that they match the indices of the list of airports.
        airports.get(edge.p1).routes.add(edge);
        airports.get(edge.p2).routes.add(edge);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:16:41.207

我想我可以改进我的其他答案。

更完整的解决方案如下所示：

```
import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Scanner;

public class Airport {
    public final int id;
    public String name;
    public List<Route> outboundRoutes = new ArrayList<Route>();
    public List<Route> inboundRoutes = new ArrayList<Route>();

    public double minDistance;
    public Airport previous;

    public Airport(int id, String name){
        this.id = id;
        this.name = name;
    }

    public static class Route {
        public final int id;
        public double cost;
        public Airport departure;
        public Airport destination;

        public Route(int id, double cost, Airport departure, Airport destination){
            this.id = id;
            this.cost = cost;
            this.departure = departure;
            this.destination = destination;
        }
    }

    public static Map<Integer,Airport> readAirports(Scanner input){
        Map<Integer,Airport> airports = new HashMap<Integer,Airport>();
        while(input.hasNext()){
            //  Using a map rather than a list simplifies the process of loading 
            //  your routes, and eliminates problems that would crop up if some
            //  airports are listed out of order or removed.
            Airport port = new Airport(input.nextInt(), input.next());
            airports.put(port.id, port);
        }
        return airports;
    }

    //  Note that the list of airports must be passed when loading the routes, 
    //  but that nothing is returned -- the routes are loaded directly 
    //  into the airports.
    public static void readRoutes(Scanner input, Map<Integer,Airport> airports){

        while(input.hasNext()){
            int id = input.nextInt();
            int departureId = input.nextInt();
            int destinationId = input.nextInt();
            double cost = input.nextDouble();

            if(!(airports.containsKey(departureId) && 
                    airports.containsKey(destinationId))){
                //  You'll have to decide how to handle a situation when a route 
                //  refers to airports that don't exist
                throw new RuntimeException(
                        "Undefined airport referenced in route #" + id);
            }

            Route route = new Route(id, cost, airports.get(departureId), 
                    airports.get(destinationId));
            route.departure.outboundRoutes.add(route);
            route.destination.inboundRoutes.add(route);
        }
    }

    public static Map<Integer,Airport> loadAirports() throws FileNotFoundException {
        Scanner inAirports = new Scanner(new File("airports.txt"));
        Scanner inRoutes = new Scanner(new File("routes.txt"));
        Map<Integer,Airport> airports = readAirports(inAirports);
        readRoutes(inRoutes, airports);
        return airports;
    }

    public static void main(String[] args){
        try {
            Map<Integer,Airport> airports = loadAirports();
            for(Airport port : airports.values()){
                System.out.println(port.name + " has " + port.inboundRoutes.size() + " inbound routes and " + port.outboundRoutes.size() + " outbound routes ");
                for(Route r : port.inboundRoutes){
                    System.out.println("\tin from " + r.departure.name + " at a cost of $" + r.cost);
                }
                for(Route r : port.outboundRoutes){
                    System.out.println("\tout to " + r.destination.name + " at a cost of $" + r.cost);
                }
            }

        } catch (IOException e){
            e.printStackTrace();
        }
    }
} 
```

如果您想要一个简单、直接的答案，那么如果不进行某种嵌套，就无法完成您想要对 ArrayLists 执行的操作。

由于您正在处理具有 ID 的数据，因此我强烈建议您无论如何都使用 HashMap，这样您就不必担心数据的顺序不完美。由于您有元数据（机场名称），因此创建这些类是对数据建模的好方法。

编辑：代码现在已更改为全部适合一个文件。使用您提供的示例文件分别称为“airports.txt”和“routes.txt”，它应该可以正常工作。当你运行它时，你应该得到以下输出：

```
England(LHR) has 4 inbound routes and 4 outbound routes 
    in from France(CDG) at a cost of $2.0
    in from Holland(AMS) at a cost of $1.0
    in from Portugal(LIS) at a cost of $3.0
    in from Iceland(KEF) at a cost of $3.0
    out to France(CDG) at a cost of $2.0
    out to Holland(AMS) at a cost of $1.0
    out to Portugal(LIS) at a cost of $3.0
    out to Iceland(KEF) at a cost of $3.0
France(CDG) has 5 inbound routes and 5 outbound routes 
    in from England(LHR) at a cost of $2.0
    in from Holland(AMS) at a cost of $1.0
    in from Germany(FRA) at a cost of $1.0
    in from Italy(LIN) at a cost of $2.0
    in from Portugal(LIS) at a cost of $2.0
    out to England(LHR) at a cost of $2.0
    out to Holland(AMS) at a cost of $1.0
    out to Germany(FRA) at a cost of $1.0
    out to Italy(LIN) at a cost of $2.0
    out to Portugal(LIS) at a cost of $2.0
Holland(AMS) has 5 inbound routes and 5 outbound routes 
    in from England(LHR) at a cost of $1.0
    in from France(CDG) at a cost of $1.0
    in from Germany(FRA) at a cost of $1.0
    in from Denmark(CPH) at a cost of $1.0
    in from Finland(HEL) at a cost of $2.0
    out to England(LHR) at a cost of $1.0
    out to France(CDG) at a cost of $1.0
    out to Germany(FRA) at a cost of $1.0
    out to Denmark(CPH) at a cost of $1.0
    out to Finland(HEL) at a cost of $2.0
Germany(FRA) has 4 inbound routes and 4 outbound routes 
    in from France(CDG) at a cost of $1.0
    in from Holland(AMS) at a cost of $1.0
    in from Italy(LIN) at a cost of $1.0
    in from Sweden(ARN) at a cost of $2.0
    out to France(CDG) at a cost of $1.0
    out to Holland(AMS) at a cost of $1.0
    out to Italy(LIN) at a cost of $1.0
    out to Sweden(ARN) at a cost of $2.0
Italy(LIN) has 3 inbound routes and 3 outbound routes 
    in from France(CDG) at a cost of $2.0
    in from Germany(FRA) at a cost of $1.0
    in from Portugal(LIS) at a cost of $3.0
    out to Portugal(LIS) at a cost of $3.0
    out to France(CDG) at a cost of $2.0
    out to Germany(FRA) at a cost of $1.0
Portugal(LIS) has 3 inbound routes and 3 outbound routes 
    in from England(LHR) at a cost of $3.0
    in from France(CDG) at a cost of $2.0
    in from Italy(LIN) at a cost of $3.0
    out to England(LHR) at a cost of $3.0
    out to France(CDG) at a cost of $2.0
    out to Italy(LIN) at a cost of $3.0
Iceland(KEF) has 1 inbound routes and 1 outbound routes 
    in from England(LHR) at a cost of $3.0
    out to England(LHR) at a cost of $3.0
Denmark(CPH) has 2 inbound routes and 2 outbound routes 
    in from Holland(AMS) at a cost of $1.0
    in from Norway(OSL) at a cost of $1.0
    out to Holland(AMS) at a cost of $1.0
    out to Norway(OSL) at a cost of $1.0
Norway(OSL) has 2 inbound routes and 2 outbound routes 
    in from Denmark(CPH) at a cost of $1.0
    in from Sweden(ARN) at a cost of $1.0
    out to Denmark(CPH) at a cost of $1.0
    out to Sweden(ARN) at a cost of $1.0
Finland(HEL) has 2 inbound routes and 2 outbound routes 
    in from Holland(AMS) at a cost of $2.0
    in from Sweden(ARN) at a cost of $1.0
    out to Sweden(ARN) at a cost of $1.0
    out to Holland(AMS) at a cost of $2.0
Sweden(ARN) has 3 inbound routes and 3 outbound routes 
    in from Germany(FRA) at a cost of $2.0
    in from Norway(OSL) at a cost of $1.0
    in from Finland(HEL) at a cost of $1.0
    out to Germany(FRA) at a cost of $2.0
    out to Norway(OSL) at a cost of $1.0
    out to Finland(HEL) at a cost of $1.0 
```

# spring - 添加 spring-context-3.0.0.RELEASE.jar 后 Tomcat 7 不启动

> ID：15179120
> 
> 赞同：0
> 
> 时间：2013-03-02T20:30:00.893
> 
> 标签：spring, tomcat, spring-mvc

您好我正在尝试启动简单的 spring mvc 应用程序。所以我添加到`tomcat/lib`

```
> spring-context-3.0.0.RELEASE.jar
> spring-web-3.0.0.RELEASE.jar
> spring-core-3.0.0.RELEASE.jar 
```

我得到了这样的错误， `java.lang.ClassNotFoundException: org.springframework.context.ApplicationListener` 所以我添加了`spring-context-3.0.0.RELEASE.jar`，但现在 tomcat 没有启动。表明

```
SEVERE: A child container failed during start
java.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/test]]
    at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:252)
    at java.util.concurrent.FutureTask.get(FutureTask.java:111)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:800)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.Thread.run(Thread.java:722)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/test]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    ... 7 more
Caused by: java.lang.NoClassDefFoundError: org/springframework/beans/BeansException
    at java.lang.Class.getDeclaredFields0(Native Method)
    at java.lang.Class.privateGetDeclaredFields(Class.java:2317)
    at java.lang.Class.getDeclaredFields(Class.java:1762)
    at org.apache.catalina.util.Introspection.getDeclaredFields(Introspection.java:87)
    at org.apache.catalina.startup.WebAnnotationSet.loadFieldsAnnotation(WebAnnotationSet.java:261)
    at org.apache.catalina.startup.WebAnnotationSet.loadApplicationServletAnnotations(WebAnnotationSet.java:140)
    at org.apache.catalina.startup.WebAnnotationSet.loadApplicationAnnotations(WebAnnotationSet.java:67)
    at org.apache.catalina.startup.ContextConfig.applicationAnnotationsConfig(ContextConfig.java:405)
    at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:881)
    at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:369)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5173)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more
Caused by: java.lang.ClassNotFoundException: org.springframework.beans.BeansException
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    ... 21 more

mar 02, 2013 9:29:08 PM org.apache.catalina.core.ContainerBase startInternal
SEVERE: A child container failed during start
java.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]
    at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:252)
    at java.util.concurrent.FutureTask.get(FutureTask.java:111)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1123)
    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:684)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:451)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina].StandardHost[localhost]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.Thread.run(Thread.java:722)
Caused by: org.apache.catalina.LifecycleException: A child container failed during start
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1131)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:800)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more

mar 02, 2013 9:29:08 PM org.apache.catalina.startup.Catalina start
SEVERE: Catalina.start: 
org.apache.catalina.LifecycleException: Failed to start component [StandardServer[8005]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:684)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:451)
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardService[Catalina]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:732)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 7 more
Caused by: org.apache.catalina.LifecycleException: Failed to start component [StandardEngine[Catalina]]
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:154)
    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 9 more
Caused by: org.apache.catalina.LifecycleException: A child container failed during start
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1131)
    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    ... 11 more

mar 02, 2013 9:29:08 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 1681 ms 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:43:49.747

`spring-context`取决于`spring-beans`，因此您还需要添加该 jar。检查它有哪些其他依赖项，例如在[maven central 中](http://search.maven.org/#artifactdetails%7Corg.springframework%7Cspring-context%7C3.0.0.RELEASE%7Cjar)。

或者通过查看以下代码段可能更容易：

```
$ mvn dependency:tree
[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building spring-security-basic-example 1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- maven-dependency-plugin:2.1:tree (default-cli) @ spring-security-basic-example ---
[INFO] com.zagyvaib:spring-security-basic-example:war:1.0-SNAPSHOT
[INFO] +- org.springframework:spring-web:jar:3.2.1.RELEASE:compile
[INFO] |  +- org.springframework:spring-aop:jar:3.2.1.RELEASE:compile
[INFO] |  +- org.springframework:spring-context:jar:3.2.1.RELEASE:compile
[INFO] |  +- org.springframework:spring-beans:jar:3.2.1.RELEASE:compile
[INFO] |  +- aopalliance:aopalliance:jar:1.0:compile
[INFO] |  \- org.springframework:spring-core:jar:3.2.1.RELEASE:compile
[INFO] |     \- commons-logging:commons-logging:jar:1.1.1:compile
[INFO] +- org.springframework:spring-webmvc:jar:3.2.1.RELEASE:compile
[INFO] |  \- org.springframework:spring-expression:jar:3.2.1.RELEASE:compile 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-22T05:36:14.077

在 EAR 下添加了多少个 jar？因为我能够看到 webinf/lib 中的所有 jar，但是这些 jar 没有添加到 SERVER?EAR 下。

# jenkins - CloudBees 上的 Jenkins 执行器饥饿

> ID：15179123
> 
> 赞同：0
> 
> 时间：2013-03-02T20:30:29.157
> 
> 标签：jenkins, cloudbees, hubot

我已经在 Cloudbees、Janky 和 ​​Hubot 上使用 Jenkins 正确设置了作业。Hubot 和 Janky 工作并将工作推送到 Jenkins 服务器。

这项工作已经在 J​​enkins 队列中等待了一个多小时。我看不到任何地方可以配置执行器的数量，这是来自 Cloudbees 的完全默认实例。

CloudBees 服务需要一段时间还是配置错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T02:21:13.763

这是 3 月初的一个问题，原因是构建容器有时无法干净启动。

根本原因是构建容器在启动时发生了内核错误。

这已经解决了，你不应该经历这些等待执行者的长时间停顿。

任何超过 10 分钟的时间都绝对是一个错误，通常超过 5 秒是不寻常的（尽管同时启动大量作业时，获取容器的时间可能在 3 分钟左右）。

# django - 聊天应用程序：将 Django 与 sockjs-tornado 和 redis 一起使用

> ID：15179124
> 
> 赞同：1
> 
> 时间：2013-03-02T20:30:30.547
> 
> 标签：django, websocket, redis, tornado, sockjs

我正在尝试编写聊天应用程序，这里有一些设计想法：
Django 做主网站服务。
Sockjs-tornado 提供聊天服务，我想在他们之间设置 redis。

当 sockjs-tornado 在聊天中接收到消息时，它会对其进行处理并发送给其他连接的客户端，并将其放入 redis 中，因此 Django 可以将此消息保存在持久数据库中。我知道我应该使用 redis 的 pubsub 功能。我知道如何在 tornado（brukva 库）中设置它，但是如何在 django 中订阅 redis 的频道？所以我可以在 django 中接收消息并将其保存到数据库中？你有什么想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-03T23:52:28.457

我不知道 sockjs 是如何使用的，但是这个例子说明了如何在 django 模型中保存
#in tornado

```
import brukva  
import tornado.web  
import tornado.websocket

c = brukva.Client()  
c.connect()

class MessagesHandler(tornado.websoket.WebsocketHandler):

    def open(self):
        #....

    def handle_request(self, response):
        pass

    def on_message(self, message):
        #....
        c.publish(self.channel, json.dumps({
            "sender": self.sender_name,
            "text": message,
        }))

        http_client = tornado.httpclient.AsyncHTTPClient()
        request = tornado.httpclient.HTTPRequest(
              '/to/django_project/url/chat_save_base/',

                method="POST",
                body=urllib.urlencode({
                "message": message.encode("utf-8"),
                "sender": self.sender.name,
            })
        http_client.fetch(request, self.handle_request) 
```

#in django_url

```
url(r'/to/django_project/url/chat_save_base/','app.my_view') 
```

＃我的观点

```
from django.views.decorators.csrf import csrf_exempt  
from messages.models import Message

@csrf_exempt
def my_view(request):  
    message_text = request.POST.get("message")  
    sender = User.objects.get(id=request.POST.get("sender_id"))  

    message = Message()
    message.text = message_text
    message.sender_id = sender_id    
    message.save() 
```

更多信息来源：http: [//habrahabr.ru/post/160123/](http://habrahabr.ru/post/160123/)

# codeigniter - 在 Codeigniter 中打印出失败的 SQL 语句

> ID：15179126
> 
> 赞同：0
> 
> 时间：2013-03-02T20:30:45.537
> 
> 标签：codeigniter

我想在 CodeIgniter 中打印出一条失败的 SQL 语句。在我的第一次尝试中，我使用了一个打印 db->last_query() 的 try/catch 块。但是，正如您从日志中看到的那样，没有打印 SQL 语句。我究竟做错了什么？

```
public function get($limit = NULL, $offset = NULL, $sort = NULL, $search = NULL)
{
    try {
        if ($limit !== NULL) $limit = (int) $limit;
        if ($offset !== NULL) $offset = (int) $offset;
        if (is_array($sort)) {
            foreach ($sort as $field => $order) {
                $this->db->order_by($field, $order);
            }
        }
        if (is_array($search)) {
            foreach ($search as $field => $match) {
                $this->db->where($field, $match);
            }
        }
        $this->db->select($this->select_fields);
        $query = $this->db->get($this->table_name, $limit, $offset);

        // Set the results
        $this->last_query = $this->db->last_query();    
        $this->num_rows = $query->num_rows();
        $this->result_array = $query->result_array();
        $this->db_result = $query;
        $this->error_number = $this->db->_error_number();
        $this->error_message = $this->db->_error_message();
    } catch(Exception $e) {
        log_message('error',$e->getMessage());  
        log_message('error',$this->db->last_query());   
        $this->error_number = 500;      
    }
} 
```

我得到的错误是：

```
DEBUG - 2013-03-02 15:16:50 --> DB Transaction Failure
ERROR - 2013-03-02 15:16:50 --> Query error: Unknown column 'template' in 'where clause' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:37:34.723

The $this->db->last_query() line returns the last query **that was run**.

But your SQL log file show us that you have a error in your SQL query. So, your query was not run. The last_query() line can not return anything.

```
Query error: Unknown column 'template' in 'where clause' 
```

Do you have a template column in your table?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-01T10:15:01.193

- 简单的解决方案。- 如果您使用的是 firfox。比安装 firbug 并启用它，在 firebug 控制台中，您可以查看与您的请求相关的任何内容，例如 - 您的 http 请求 - 发布/获取数据 - 响应等

# user-interface - Autohotkey - 如何将 GUI 链接到窗口以与其父窗口相同

> ID：15179134
> 
> 赞同：0
> 
> 时间：2013-03-02T20:31:00.343
> 
> 标签：user-interface, window, parent, autohotkey

我想将 GUI 链接到某个窗口，这样它就可以像它的一部分一样。

这是我的 GUI，我希望它遵循计算器（用于测试）。如果计算器被最小化，则 gui 也会被最小化。

提前致谢！

```
#SingleInstance Force
#Persistent

BC = 0

Gui, Color, EEAA99
Gui, Margin , 0, 0
GUI, +AlwaysOnTop -Border -SysMenu -Caption +ToolWindow +Owner
Gui, Font, S48 CDefault Bold CBlue, Verdana
Gui, Add, Text, BackgroundTrans , Units completed:
Gui, Font, S72 CDefault Bold CGreen, Verdana
Gui, Add, Text, BackgroundTrans vBuildCounter, %BC%
WinSet, TransColor, EEAA99
Gui +LastFound +AlwaysOnTop +ToolWindow
WinSet, TransColor, EEAA99
Gui -Caption
Gui, Show, % "x" A_ScreenWidth - 400 " y" A_ScreenHeight / 4

:?*:asd:: ;count up
    SoundBeep, 500,500
    BC := BC += 1
    GuiControl,, BuildCounter, %BC%
Return

:?*:qwe:: ;reset the counter
    SoundBeep, 500,500
    BC := 0
    GuiControl,, BuildCounter, %BC%
Return

Esc::
ExitApp 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:06:28.300

您可以（据我所知）只能使用 settimer 执行此操作。

伪代码，未经测试！

```
SetTitleMatchMode := 2
SetTimer, CheckWindow, 200

CheckWindow:
    If WinActive("Calculator")
    {
       Gui, Show, % "x" A_ScreenWidth - 400 " y" A_ScreenHeight / 4, Popup
    }
    Else If !WinActive("Popup")
    {
        Gui, Hide
    }
Return 
```

编辑：添加了一个条件以避免在弹出窗口被激活时隐藏它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T11:57:55.590

我最终得到了两个脚本。也许以后可以结合起来。

一个脚本用于 ToolMenu，第二个用于激活。由于我无法控制 GUI，从激活脚本中显示/隐藏，我通过使用`Ctrl`+ `Alt`+ `Win`+`F1`和`Ctrl`+ `Alt`+ `Win`+ “解决”了它`F2`。不是最优雅的方式，但它有效......

# 工具菜单.ahk

```
#SingleInstance Force
#installKeybdHook
#Persistent

Gui, Destroy
Gui,+AlwaysOnTop
Gui,+ToolWindow
Gui,+Border
Gui, Add, Button, y5 w60, &LowBeep
Gui, Add, Button, y5 w60, &HighBeep
Gui, Add, Button, y8 h18, X
Gui, Show, y0, MyToolWindow
Return

ButtonLowBeep:
    SoundBeep, 300, 300
Return

ButtonHighBeep:
    SoundBeep, 500, 300
Return

ButtonX:
ButtonCancel:
    Gui, Destroy
ExitApp

^!#F1::
    Gui, Hide
Return

^!#F2::
    Gui, Show, y0, MyToolWindow
Return 
```

# DetectWindowChange.ahk

```
#SingleInstance
#installKeybdHook
#Persistent
Global SwitchCounter

Gui +LastFound 
hWnd := WinExist()
DllCall( "RegisterShellHookWindow", UInt,Hwnd )
MsgNum := DllCall( "RegisterWindowMessage", Str,"SHELLHOOK" )
OnMessage( MsgNum, "ShellMessage" )
Return

ShellMessage( wParam )
{
    If (wParam = 4)
    { 
        WinGetTitle, CurrName, A
        If (CurrName = "Calculator" OR CurrName = "MyToolWindow")
        {
            If ( SwitchCounter = 0)
            {
                ;WinRestore, MyToolWindow
                Send, ^!#{F2} ; Send Ctrl+Alt+Win+F2 to trigger GUI Show in GUI script
            }
            SwitchCounter += 1
        }
        Else
        {
            If ( SwitchCounter > 0)
            {
                ;WinMinimize, MyToolWindow
                Send, ^!#{F1} ; Send Ctrl+Alt+Win+F1 to trigger GUI Hide in GUI script
            }
            SwitchCounter := 0
        }
    }
}
Return 
```

让我知道这是如何工作的...

# c++ - 实例对象的 C++ 函数指针

> ID：15179136
> 
> 赞同：0
> 
> 时间：2013-03-02T20:31:06.007
> 
> 标签：c++, function-pointers

我有一个简单的模板类，它有两个函数指针和一个值。一个指针是比较运算符，另一个是对象（例如 getX()）。

标题：

```
template<class T>
class A {

public:
    A(T (*function)(), const bool (*op)(T,T),const T value) : 
        function(function), value(value), op(op){}
    bool valid();

private:
    T value;
    T (*function)();
    bool (*op)(T, T);
}; 
```

共产党：

```
#include "A.h"

template<class T>
bool A<T>::valid(){
    return (op(function(),value));
} 
```

因此，如果您创建了 A 的实例：

```
A<float> a = A<float>(x->getX,operator==,20); 
```

当 valid 被调用时，将等同于：

```
x->getX() == 20; 
```

实际的标头/类定义工作正常。问题是在创建 A 的实例时；它不起作用。我认为这是因为 'x->getX' 但有没有办法做我想做的事？

谢谢。

编辑：：

确切的编译器错误如下：

....\Classes\Objects\B.cpp:42: 错误：没有匹配函数调用'A::A(未解析的重载函数类型，未解析的重载函数类型，float)' ....\Classes\Objects /Ah:30: 注意：候选人是：A::A(T ( *)(), const bool (* )(T, T), T) [with T = float] ....\Classes\Objects/Ah: 26：注意：A::A(const A&)

请注意：'x->getX' 返回一个浮点数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T04:42:04.510

如果可以使用 C++11：

做你想做的事情的方法是使用[std::bind](http://en.cppreference.com/w/cpp/utility/functional/bind)和[std::function](http://en.cppreference.com/w/cpp/utility/functional/function)。

此外，如果您想将基本类型（int、float ...）的比较运算符作为参数传递，您可以使用`Comparison function objects`< [functional](http://en.cppreference.com/w/cpp/header/functional) > 标头中定义的（std::less、std::greater ...）

```
#include <functional>
#include <iostream>

template<class T, typename BinaryPredicate>
class A {

public:
    A(std::function<T()> function, BinaryPredicate pred,const T value) : 
        function_(function), pred_(pred), value_(value){}
    bool valid();

private:
    std::function<T()> function_;
    BinaryPredicate    pred_;
    T                  value_;
};

template<class T, typename BinaryPredicate>
bool A<T, BinaryPredicate>::valid(){
    return (pred_(function_(), value_));
}

class X {

   private:
   float val_;

   public:
   X(float val) : val_(val) {}

   float getX() {return val_;}
};

int main(void)
{
   X x(20);

   A<float, std::equal_to<float>> a(std::bind(&X::getX, &x), std::equal_to<float>(), 20);

   std::cout << std::boolalpha << a.valid() << std::endl;

   return (0);
} 
```

# objective-c - 通过电子邮件邀请玩家加入 Game Center

> ID：15179145
> 
> 赞同：2
> 
> 时间：2013-03-02T20:32:00.750
> 
> 标签：objective-c, ios6, game-center

我正在开发一款回合制 Game Center 游戏，想知道是否可以通过电子邮件邀请玩家，而不仅仅是准备好游戏和用户 ID @ Game Center 的玩家？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:34:20.390

要使用 Game Center 邀请玩家参加在线多人游戏，用户必须拥有注册的 Apple ID。用户还必须拥有游戏才能接受，但我相信用户仍会在 Game Center 中收到有关邀请的通知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:58:47.120

由 GameKit 提供支持的回合制游戏需要以 Apple-ID 为中心的邀请。您不能以编程方式邀请朋友，如果您要发送电子邮件邀请，则需要这样做。

如果您想进行基于电子邮件的邀请，则必须编写自己的解决方案，并且仅将 Game Center 用于成就和排行榜等内容。

# wordpress - 在这种情况下我应该使用 Wordpress Transient API 吗？

> ID：15179150
> 
> 赞同：0
> 
> 时间：2013-03-02T20:32:50.013
> 
> 标签：wordpress, caching

我正在为工作编写一个简单的 Wordpress 插件，我想知道在这种情况下使用 Transients API 是否实用，或者我是否应该寻找另一种方式。

该插件的目的很简单。我正在调用 USZip Web 服务 ( [http://www.webservicex.net/uszip.asmx?op=GetInfoByZIP](http://www.webservicex.net/uszip.asmx?op=GetInfoByZIP) ) 以检索数据。我们的销售团队正在使用插件将在其上运行的 Lead Intake 表。

我想减少 API 调用的次数，所以我想为每个邮政编码设置一个瞬态作为键并存储传入的数据（城市和邮政编码）。如果给定邮政编码的相应数据已经存在，则无需进行 API 调用。

以下是我的担忧： 1\. 快速搜索后，我意识到临时数据存储在 wp_options 表中，存储数据会立即使该表膨胀。如果数据库变得巨大，这会导致显着的性能问题吗？2\. 创建这么多临时键是可怕的做法吗？它很容易在几个月内变成数千。

如果使用瞬态不是最好的方法，你能帮我指出正确的方向吗？谢谢！

PS 我选择了 Transients API 和 Options API。我知道邮政编码不会经常更改，但有时会更改。我设置了3个月的到期时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:39:00.440

一个不那么膨胀的解决方案是：

1.  在选项内存储一个`uszip`使用序列化数组调用的选项
2.  每次抓取整个数组并简单地检查邮政编码是否存在
3.  如果它不存在，则抓取数据并再次保存整个瞬态

考虑到美国有 43,000 个邮政编码，您应该确保没有达到此表中序列化数组的上限（9,000 个元素）。但是，您很可能会有一个非常本地化的邮政编码子集。

# python - 安装时删除旧版本的 Python 包

> ID：15179152
> 
> 赞同：0
> 
> 时间：2013-03-02T20:32:52.603
> 
> 标签：python, django, python-module

我正在创建一个 Django 包，其中包含一些我将在多个 Web 应用程序中使用的核心功能。

现在，这是我第一次创建 Django/Python 包。我已经阅读了现有的文档和教程。

我的问题是，每次我对包进行更改并重新创建包，并使用“python setup.py install”方法重新安装它时，实际上已经安装了新包，但之前的版本仍然存在。

因此，例如，现在我的机器上安装了最新的 3 个版本的软件包。

我该如何做到这一点，以便软件包的安装删除同一软件包的所有先前安装？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T22:02:29.680

看来这是一个已知问题。

[问题 5342](http://bugs.python.org/issue5342)的报告者对安装目录中保留的旧文件也有同样的问题。

根据[Issue 4673](http://bugs.python.org/issue4673)，`distutils2`现在有一个`uninstall`命令可用于在安装时清理目录。也许您可以覆盖该`install`命令，使其首先尝试卸载旧软件包？

* * *

否则，似乎解决方案是：

> 将一些旧文件检测破解到每个包中，或告诉用户“先删除旧安装”。两者都不是很好。

# c++ - 从套接字读取少于可读取

> ID：15179153
> 
> 赞同：1
> 
> 时间：2013-03-02T20:33:06.397
> 
> 标签：c++, c, sockets

我找不到这个答案：如果我从套接字读取 4 字节（我设置了 4 字节的限制）但实际上有 256 字节等待读取会发生什么？他们会丢失还是会等到下一次调用 read 函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T20:34:04.017

如果是 TCP 套接字，则不会丢失任何数据；它会排队。

请记住，您必须准备好处理部分读取，即您获得的字节数少于请求的字节数，并且必须`read()`再次调用才能获得更多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T21:18:00.250

这取决于您使用哪种插座。如果是流套接字（使用 SOCK_STREAM 创建），那么它支持数据流，你甚至可以读取 1 个字节（虽然效率不高），另一方面你可能请求 1024 个字节但只能得到 1 个字节。这几乎与发送者将它们放入流中的部分无关（存在依赖性，但您不应该依赖它）。因此，对于流，您需要通过更高级别的协议定义数据的结尾。您可以在末尾发送带有 \n 的字符串，或者使用以零结尾的字符串，或者在该数据之前发送一些字节大小的即将到来的数据。
另一方面，如果您使用数据报协议（使用 SOCK_DGRAM 创建），您将通过数据包获取数据 - 无论发送者发送它们的大小。如果您提供的缓冲区小于可用数据，它将被截断并丢弃剩余的数据。

# python - Httplib 无法处理特定域

> ID：15179157
> 
> 赞同：1
> 
> 时间：2013-03-02T20:34:06.653
> 
> 标签：python, http, exception, dns

`httplib`我有一个脚本，它使用Python获取 Internet 上许多页面的 HTTP 标头。

我的问题在[特定域](http://iswtc.la)（可能还有其他域）上，`httplib`引发异常，我不明白为什么。

```
>>> import httplib
>>> http = httplib.HTTPConnection('iswtc.la')
>>> http.request('GET', '/a')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib64/python2.6/httplib.py", line 914, in request
    self._send_request(method, url, body, headers)
  File "/usr/lib64/python2.6/httplib.py", line 951, in _send_request
    self.endheaders()
  File "/usr/lib64/python2.6/httplib.py", line 908, in endheaders
    self._send_output()
  File "/usr/lib64/python2.6/httplib.py", line 780, in _send_output
    self.send(msg)
  File "/usr/lib64/python2.6/httplib.py", line 739, in send
    self.connect()
  File "/usr/lib64/python2.6/httplib.py", line 720, in connect
    self.timeout)
  File "/usr/lib64/python2.6/socket.py", line 553, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
socket.gaierror: [Errno -2] Name or service not known 
```

这个特定域有什么不同，我该如何处理？

PS：这不是我的代码，因为它工作正常：

```
>>> http = httplib.HTTPConnection('bit.ly')
>>> http.request('GET', '/a') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:38:12.173

`bit.ly`存在，而不存在`iswtc.la`：

```
$ nslookup bit.ly

Non-authoritative answer:
Name:   bit.ly
Address: 69.58.188.39
Name:   bit.ly
Address: 69.58.188.40

$ nslookup iswtc.la

** server can't find iswtc.la: NXDOMAIN 
```

# php - 使用距离连接两个表的结果

> ID：15179161
> 
> 赞同：0
> 
> 时间：2013-03-02T20:34:20.973
> 
> 标签：php, mysql

我正在尝试从某个半径返回结果的搜索。我有第一步工作，但是当我尝试通过包含它停止工作的第二个表来扩展结果时。我不认为 UNION 是要走的路，但为了更好地解释我正在尝试做的事情，请输入它：

```
SELECT *, 3956 * 2 * ASIN(SQRT( POWER(SIN((48.4284207 -abs(dest.lat)) * pi()/180 / 2),2) + COS(48.4284207 * pi()/180 ) * COS( abs(dest.lat) * pi()/180) * POWER(SIN((-123.3656444 - dest.lng) * pi()/180 / 2), 2) )) 
      as distance 
FROM business dest having distance < 10500 and 
     (businessName LIKE '%web%') ORDER BY distance
UNION 
(
 SELECT b.* 
   FROM business b, keywords k 
  WHERE k.keyword 
   LIKE '%web%' and b.businessID=k.businessID
) 
```

第二个表有两列“关键字”，然后是第一个表中的业务 ID 的 fk。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:11:55.110

从您评论中的查询来看，您似乎想在一些遥远的地方找到企业名称或链接关键字表中的相关关键字中包含“网络”的企业。

如果是这样，这样的查询应该这样做：

```
SELECT DISTINCT dest.*, 3956 * 2 * ASIN(SQRT( POWER(SIN((48.4284207 -abs(dest.lat)) * pi()/180 / 2),2) + COS(48.4284207 * pi()/180 ) * COS( abs(dest.lat) * pi()/180) * POWER(SIN((-123.3656444 - dest.lng) * pi()/180 / 2), 2) )) 
      AS distance 
FROM business dest
LEFT JOIN keywords k
ON k.businessID = dest.businessID
WHERE dest.businessName LIKE '%web%' OR k.keyword LIKE '%web%'
HAVING distance < 10500 
ORDER BY distance 
```

# sql-server - Sharepoint 环境设置

> ID：15179162
> 
> 赞同：0
> 
> 时间：2013-03-02T20:34:27.137
> 
> 标签：sql-server, sharepoint, windows-server-2008

如果我有域环境，则有域控制器和权限管理服务器（RMS 用于文档安全......这意味着你可以根据他们的权限为某些用户设置复制、打印、编辑等权限。）这个 RMS必须与 SQL server 集成作为其数据库.. 并且需要 sharepoint 服务器现在用户将连接到 sharepoint，sharepoint 将授予他们在 RMS 服务器上授予的权限我需要知道设置该 sharepoint 和 SQL server 的要求，以及我需要知道 SQL 和共享点是单独的可下载产品还是 Windows Server 2008 中包含的角色

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:12:59.700

SQL Server 和 Sharepoint Server 不是 Windows 角色，它们完全是独立的产品。

# cuda - cudaStreamWaitEvent 会阻塞主机吗？

> ID：15179166
> 
> 赞同：3
> 
> 时间：2013-03-02T20:34:56.070
> 
> 标签：cuda, cuda-events

我知道 cudaEventSynchronize 会阻止主机，直到事件被触发。但是，cudaStreamWaitEvent 呢？cudaStreamWaitEvent 将仅阻止指定的流，而主机将继续进行，还是主机也将被阻止？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T20:40:32.040

它仅在将 WaitEvent 插入流队列时阻塞指定的流处理。主机处理将继续。您可以使用[cudaStreamSynchronize()](http://docs.nvidia.com/cuda/cuda-runtime-api/index.html#group__CUDART__STREAM_1geb3b2f88b7c1cff8b67a998a3a41c179)强制主机等待特定流中的处理完成。

# c++ - CMake冲突的头文件

> ID：15179169
> 
> 赞同：0
> 
> 时间：2013-03-02T20:35:11.110
> 
> 标签：c++, c, cmake

我正在使用 boost（它使用 time.h）和一个 C 库（libav），它有一个也称为 time.h 的头文件。因此，当 boost 尝试使用 time.h 时，它会从 libav 调用 time.h，就像 ANSI C 标准 time.h 一样。

如何强制 libav 找到它自己的 time.h 并提升使用 ANSI C 标准 time.h？而且我根本不想修改库，因为这段代码需要在任何地方构建。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:57:45.990

libav 中的 time.h 不应与 /usr/include 中的 time.h 冲突，因为它包含在 libav 源中：

```
#include "libavutil/time.h" 
```

至少它以这种方式包含在来自 git 存储库的最新版本的 libav 中。如果您有旧版本，则不会这样做，您可能应该升级。如果您错误地将 libavutil 目录设置在包含路径中，则应将其删除（或更改为不包含 dir libavutil 本身的路径）。

# jquery - jQuery UI 自动完成部分匹配

> ID：15179180
> 
> 赞同：0
> 
> 时间：2013-03-02T20:35:53.120
> 
> 标签：jquery, jquery-ui, jquery-autocomplete

我试图让 jQuery UI 自动完成搜索只搜索我的字符串的前几个字母。我想我可以用 jQuery UI 做一个键/值的事情，但我不确定这是否适用。

我有以下字符串：

```
AGREE Agreement by and between BLANK, in BLANK, of the county records. 
```

只`AGREE`应搜索，而不是字符串的其余部分。 `AGREE`是用户将搜索的文本代码。

这是我的简单代码：

```
var availableTags = [
            "AGREE Agreement by and between BLANK, in BLANK, of the county records.",
            "CONDO Covenants, conditions, restrictions, reservations, terms, provisions, easements, liens for assessments, options, powers of attorney and limitations on title as set forth in the Ohio Revised Code Chapter 5311, or as set forth in the Declaration of Condominium ownership and Bylaws as recorded in BLANK, as amended, plat BLANK, of the county records."
        ];

$( "#tags" ).autocomplete({
 source: availableTags
}); 
```

只有第一个单词`AGREE`和`CONDO`应该被搜索，而不是其余的字符串。这可能/可行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:40:26.197

如果您只是在搜索标签，那么为什么不将标签放入数组中呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T21:04:39.703

我的解决方案是这样的：

```
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>autocomplete demo</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css">
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
</head>
<body>
<label for="autocomplete">Select a programming language: </label>
<input id="autocomplete">
<script>
var tags = [ "c++", "java", "php", "coldfusion", "javascript", "asp", "ruby" ];
$( "#autocomplete" ).autocomplete({
source: function( request, response ) {
var matcher = new RegExp( "^" + $.ui.autocomplete.escapeRegex( request.term ), "i" );
response( $.grep( tags, function( item ){
return matcher.test( item );
}) );
}
});
</script>
</body>
</html> 
```

参考。 [http://api.jqueryui.com/autocomplete/#event-search](http://api.jqueryui.com/autocomplete/#event-search) （页面底部）

# python - python 3中所有操作系统的“subdir”定义的var是什么？

> ID：15179186
> 
> 赞同：0
> 
> 时间：2013-03-02T20:36:35.060
> 
> 标签：python, windows, unix, path, operating-system

我有一个 Python 脚本，我从用户那里获得了 3 个参数
其中一个参数是一个文件夹路径，其中有一些我需要使用的文件
因为我的程序是为所有操作系统设计的，所以我想知道如何使用
如果我得到以下路径，则从参数正确获取所需文件IE 的路径：

```
c:\windows 
```

我希望能够在此文件夹中获取 1.exe，
在 Windows 中它将是斜杠或反斜杠，但在 unix 系统中它可能会有所不同，
据我所知，有一个来自 'os' 模块的 const 或定义的 var我可以用作这个子目录标志，我在哪里可以找到它？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:40:28.163

只需使用`os.path.join`，Python 就会为您处理斜线：

```
path = os.path.join(sys.argv[1], '1.exe') 
```

特定于平台的路径分隔符存储为`os.sep`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:38:42.763

使用`os.path.join()`. 例如：

```
os.path.join(dirname, "1.exe") 
```

# xaml - 在 WinRT XAML 中找不到元素

> ID：15179188
> 
> 赞同：0
> 
> 时间：2013-03-02T20:36:39.847
> 
> 标签：xaml, windows-runtime, custom-controls

我有以下 CustomControl 想用作横幅的基础：

XAML：

```
<UserControl x:Name="userControl"
    x:Class="Nova.WinRT.Controls.BannerPanel"
    ...>

    <Grid Background="#BF8B8B8B">
        <Grid Height="400" Background="#FF050A7C" VerticalAlignment="Center">
            <Grid.RowDefinitions>
                <RowDefinition Height="50"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="50"/>
            </Grid.RowDefinitions>
            <TextBlock x:Name="_Title" Text="Title" FontSize="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
            <ContentPresenter x:Name="_Content" Grid.Row="1"/>
            <StackPanel Orientation="Horizontal" Grid.Row="2" HorizontalAlignment="Center">
                <Button x:Name="_OK" Content="OK" HorizontalAlignment="Center" Click="OkPressed" FontSize="18" Width="100" Margin="20,0" />
                <Button x:Name="_Cancel" Content="Cancel" HorizontalAlignment="Center" Click="CancelPressed" FontSize="18" Width="100" Margin="20,0" />
            </StackPanel>
        </Grid>
    </Grid>
</UserControl> 
```

C＃：

```
public sealed partial class BannerPanel : UserControl
{
    /// <summary>
    /// Title of the Banner
    /// </summary>
    public string Title
    {
        get { return _Title.Text; }
        set { _Title.Text = value; }
    }

    /// <summary>
    /// The visibility of the OK button
    /// </summary>
    public Visibility OKVisibility
    {
        get { return _OK.Visibility; }
        set { _OK.Visibility = value; }
    }

    /// <summary>
    /// The visibility of the Cancel button
    /// </summary>
    public Visibility CancelVisibility 
    {
        get { return _Cancel.Visibility; }
        set { _Cancel.Visibility = value; }
    }

    /// <summary>
    /// The inner content of the panel
    /// </summary>
    public FrameworkElement InnerContent 
    {
        get { return (FrameworkElement)_Content.Content; }
        set { _Content.Content = value; }
    }

    /// <summary>
    /// Fires when the Ok button is clicked
    /// </summary>
    public event RoutedEventHandler OkClick;

    /// <summary>
    /// Fires when the Cancel button is clicked
    /// </summary>
    public event RoutedEventHandler CancelClick;
}; 
```

但是当我使用它时（参见下面的 XAML），自动生成的代码在内部内容中找不到元素：

XAML：

```
<Controls:BannerPanel x:Name="Banner" Title="Terms and Policy" CancelVisibility="Collapsed" OkClick="OnTermsAccepted">
    <Controls:BannerPanel.InnerContent>
        <ScrollViewer Width="500">
            <TextBlock x:Name="TermsText" TextWrapping="Wrap" FontSize="12" />
        </ScrollViewer>
    </Controls:BannerPanel.InnerContent>
</Controls:BannerPanel> 
```

C＃：

```
public sealed partial class TermsBanner : UserControl
{
    /// <summary>
    /// Constructor
    /// </summary>
    public TermsBanner()
    {
        this.InitializeComponent();

        // Why do I have to find TermsText Manually like this??????
        TermsText = (Banner.InnerContent as ScrollViewer).Content as TextBlock;
        TermsText.Text = TermsOfUse;
    }
}; 
```

为什么我必须手动将变量 TermsText 指向正确的东西？为什么它不能像通常那样使用 FindName() 自动找到它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T21:38:21.543

1.  您应该定义`DependencyProperty`属性而不是常规属性。
2.  派生自`ContentControl`而不是`UserControl`.
3.  将您的 XAML 放在 Themes/Generic.xaml 中的`Style/Setter/Property="Template" Value="...`. 如果您使用 Templated Control VS item 模板创建控件，它会自动发生。
4.  使用 TemplateBinding 将内部模板元素的属性绑定到您的控件属性。

FindName 可能无法跨名称范围工作。我从不使用它。

原谅错别字。在手机上打字。

这是一个解决方案：

创建**模板化控件**（也称为自定义控件 - 不要与 UserControl 混淆）并将其修改为派生自`ContentControl`而不是`Control`：

```
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;

// The Templated Control item template is documented at http://go.microsoft.com/fwlink/?LinkId=234235

namespace App124
{
    [TemplatePart(Name = "_OK", Type = typeof(Button))]
    [TemplatePart(Name = "_Cancel", Type = typeof(Button))]
    public sealed class BannerPanel : ContentControl
    {
        #region Title
        /// <summary>
        /// Title Dependency Property
        /// </summary>
        public static readonly DependencyProperty TitleProperty =
            DependencyProperty.Register(
                "Title",
                typeof(string),
                typeof(BannerPanel),
                new PropertyMetadata(null, OnTitleChanged));

        /// <summary>
        /// Gets or sets the Title property. This dependency property 
        /// indicates ....
        /// </summary>
        public string Title
        {
            get { return (string)GetValue(TitleProperty); }
            set { SetValue(TitleProperty, value); }
        }

        /// <summary>
        /// Handles changes to the Title property.
        /// </summary>
        /// <param name="d">
        /// The <see cref="DependencyObject"/> on which
        /// the property has changed value.
        /// </param>
        /// <param name="e">
        /// Event data that is issued by any event that
        /// tracks changes to the effective value of this property.
        /// </param>
        private static void OnTitleChanged(
            DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            var target = (BannerPanel)d;
            string oldTitle = (string)e.OldValue;
            string newTitle = target.Title;
            target.OnTitleChanged(oldTitle, newTitle);
        }

        /// <summary>
        /// Provides derived classes an opportunity to handle changes
        /// to the Title property.
        /// </summary>
        /// <param name="oldTitle">The old Title value</param>
        /// <param name="newTitle">The new Title value</param>
        private void OnTitleChanged(
            string oldTitle, string newTitle)
        {
        }
        #endregion

        #region OKVisibility
        /// <summary>
        /// OKVisibility Dependency Property
        /// </summary>
        public static readonly DependencyProperty OKVisibilityProperty =
            DependencyProperty.Register(
                "OKVisibility",
                typeof(Visibility),
                typeof(BannerPanel),
                new PropertyMetadata(Visibility.Visible, OnOKVisibilityChanged));

        /// <summary>
        /// Gets or sets the OKVisibility property. This dependency property 
        /// indicates ....
        /// </summary>
        public Visibility OKVisibility
        {
            get { return (Visibility)GetValue(OKVisibilityProperty); }
            set { SetValue(OKVisibilityProperty, value); }
        }

        /// <summary>
        /// Handles changes to the OKVisibility property.
        /// </summary>
        /// <param name="d">
        /// The <see cref="DependencyObject"/> on which
        /// the property has changed value.
        /// </param>
        /// <param name="e">
        /// Event data that is issued by any event that
        /// tracks changes to the effective value of this property.
        /// </param>
        private static void OnOKVisibilityChanged(
            DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            var target = (BannerPanel)d;
            Visibility oldOKVisibility = (Visibility)e.OldValue;
            Visibility newOKVisibility = target.OKVisibility;
            target.OnOKVisibilityChanged(oldOKVisibility, newOKVisibility);
        }

        /// <summary>
        /// Provides derived classes an opportunity to handle changes
        /// to the OKVisibility property.
        /// </summary>
        /// <param name="oldOKVisibility">The old OKVisibility value</param>
        /// <param name="newOKVisibility">The new OKVisibility value</param>
        private void OnOKVisibilityChanged(
            Visibility oldOKVisibility, Visibility newOKVisibility)
        {
        }
        #endregion

        #region CancelVisibility
        /// <summary>
        /// CancelVisibility Dependency Property
        /// </summary>
        public static readonly DependencyProperty CancelVisibilityProperty =
            DependencyProperty.Register(
                "CancelVisibility",
                typeof(Visibility),
                typeof(BannerPanel),
                new PropertyMetadata(Visibility.Visible, OnCancelVisibilityChanged));

        /// <summary>
        /// Gets or sets the CancelVisibility property. This dependency property 
        /// indicates ....
        /// </summary>
        public Visibility CancelVisibility
        {
            get { return (Visibility)GetValue(CancelVisibilityProperty); }
            set { SetValue(CancelVisibilityProperty, value); }
        }

        /// <summary>
        /// Handles changes to the CancelVisibility property.
        /// </summary>
        /// <param name="d">
        /// The <see cref="DependencyObject"/> on which
        /// the property has changed value.
        /// </param>
        /// <param name="e">
        /// Event data that is issued by any event that
        /// tracks changes to the effective value of this property.
        /// </param>
        private static void OnCancelVisibilityChanged(
            DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            var target = (BannerPanel)d;
            Visibility oldCancelVisibility = (Visibility)e.OldValue;
            Visibility newCancelVisibility = target.CancelVisibility;
            target.OnCancelVisibilityChanged(oldCancelVisibility, newCancelVisibility);
        }

        /// <summary>
        /// Provides derived classes an opportunity to handle changes
        /// to the CancelVisibility property.
        /// </summary>
        /// <param name="oldCancelVisibility">The old CancelVisibility value</param>
        /// <param name="newCancelVisibility">The new CancelVisibility value</param>
        private void OnCancelVisibilityChanged(
            Visibility oldCancelVisibility, Visibility newCancelVisibility)
        {
        }
        #endregion

        /// <summary>
        /// Fires when the Ok button is clicked
        /// </summary>
        public event RoutedEventHandler OkClick;

        /// <summary>
        /// Fires when the Cancel button is clicked
        /// </summary>
        public event RoutedEventHandler CancelClick;

        public BannerPanel()
        {
            this.DefaultStyleKey = typeof(BannerPanel);
        }

        protected override void OnApplyTemplate()
        {
            base.OnApplyTemplate();

            var cancelButton = (Button)GetTemplateChild("_Cancel");
            var okButton = (Button)GetTemplateChild("_OK");
            cancelButton.Click += CancelClick;
            okButton.Click += OkClick;
        }
    }
} 
```

**将Themes/Generic.xaml**更新为：

```
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:App124">

    <Style
        TargetType="local:BannerPanel">
        <Setter
            Property="HorizontalContentAlignment"
            Value="Left" />
        <Setter
            Property="VerticalContentAlignment"
            Value="Top" />
        <Setter
            Property="Title"
            Value="Title" />
        <Setter
            Property="OKVisibility"
            Value="Visible" />
        <Setter
            Property="CancelVisibility"
            Value="Visible" />
        <Setter
            Property="Template">
            <Setter.Value>
                <ControlTemplate
                    TargetType="local:BannerPanel">
                    <Grid
                        Background="#BF8B8B8B">
                        <Grid
                            Height="400"
                            Background="#FF050A7C"
                            VerticalAlignment="Center">
                            <Grid.RowDefinitions>
                                <RowDefinition
                                    Height="50" />
                                <RowDefinition
                                    Height="*" />
                                <RowDefinition
                                    Height="50" />
                            </Grid.RowDefinitions>
                            <TextBlock
                                x:Name="_Title"
                                Text="{TemplateBinding Title}"
                                FontSize="30"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center" />
                            <ContentPresenter
                                Grid.Row="1"
                                ContentTemplate="{TemplateBinding ContentTemplate}"
                                ContentTransitions="{TemplateBinding ContentTransitions}"
                                Content="{TemplateBinding Content}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                Margin="{TemplateBinding Padding}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                            <StackPanel
                                Orientation="Horizontal"
                                Grid.Row="2"
                                HorizontalAlignment="Center">
                                <Button
                                    x:Name="_OK"
                                    Content="OK"
                                    Visibility="{TemplateBinding OKVisibility}"
                                    HorizontalAlignment="Center"
                                    FontSize="18"
                                    Width="100"
                                    Margin="20,0" />
                                <Button
                                    x:Name="_Cancel"
                                    Content="Cancel"
                                    Visibility="{TemplateBinding CancelVisibility}"
                                    HorizontalAlignment="Center"
                                    FontSize="18"
                                    Width="100"
                                    Margin="20,0" />
                            </StackPanel>
                        </Grid>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary> 
```

这是它在**MainPage.xaml**中的使用方式：

```
<Page
    x:Class="App124.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:App124"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <Grid
        Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
        <local:BannerPanel
            x:Name="Banner"
            Title="Terms and Policy"
            CancelVisibility="Collapsed"
            OkClick="OnTermsAccepted">
            <ScrollViewer
                Width="500">
                <TextBlock
                    x:Name="TermsText"
                    Text="Terms and Conditions"
                    TextWrapping="Wrap"
                    FontSize="12" />
            </ScrollViewer>
        </local:BannerPanel>
    </Grid>
</Page> 
```

和**MainPage.xaml.cs 后面的代码**：

```
using Windows.UI.Popups;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;

// The Blank Page item template is documented at http://go.microsoft.com/fwlink/?LinkId=234238

namespace App124
{
    /// <summary>
    /// An empty page that can be used on its own or navigated to within a Frame.
    /// </summary>
    public sealed partial class MainPage : Page
    {
        public MainPage()
        {
            this.InitializeComponent();
        }

        private void OnTermsAccepted(object sender, RoutedEventArgs e)
        {
            new MessageDialog(TermsText.Text).ShowAsync();
        }
    }
} 
```

# macos - 将源目录复制到两个目标目录的 Bash 脚本，如果成功，则验证并删除源

> ID：15179190
> 
> 赞同：1
> 
> 时间：2013-03-02T20:36:46.253
> 
> 标签：macos, bash, rsync, nfs

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:47:28.237

对于您的`kill ... ps`问题，您可以使用[`killall`](https://developer.apple.com/library/mac/documentation/Darwin/Reference/Manpages/man1/killall.1.html)，它会杀死所有具有给定名称的进程

```
killall bitcasa 
```

或查看[`man ps`](https://developer.apple.com/library/mac/documentation/Darwin/Reference/Manpages/man1/ps.1.html)并使用用户定义的格式，这简化了选择

```
ps -o pid,comm | awk '/bitcasa/ { print $1; }' | xargs kill 
```

对于 nas，如果您可以登录并安装 rsync 和 ssh（或已经安装），则无需安装任何东西。您可以`192.168.1.106:/media/`将目标作为 rsync 的目标，而 rsync 将做所有必要的事情。

在任何情况下，首先检查并在必要时挂载，然后在一切设置正确时启动 rsync，而不是相反

```
if [ ! -f "/Volumes/Bitcasa Infinite Drive/file.ext" ]; then
    # kill bitcasa, restart bitcasa
fi

rsync -avz /Users/username/source "/Volumes/Bitcasa Infinite Drive/destination/" 
```

nas也一样

```
if [ ! -f "/Volumes/media/file.ext" ]; then
    # mount nas nfs share
fi

rsync -avz /Users/username/source "/Volumes/media/" 
```

或者如果你的 nas 上有 rsync 和 ssh，只需

```
rsync -avz /Users/username/source 192.168.1.106:/media/ 
```

# go - 为什么通过 TeeReader 的 tar.gz 的 tar 部分的 md5 哈希是错误的？

> ID：15179194
> 
> 赞同：5
> 
> 时间：2013-03-02T20:37:12.943
> 
> 标签：go, md5, tar, gzip

我只是在尝试使用 archive/tar 和 compress/gzip，以便自动处理我拥有的一些备份。

我的问题是：我有各种 .tar 文件和 .tar.gz 文件浮动，因此我想提取 .tar.gz 文件的哈希 (md5) 和 .tar 文件的哈希 (md5)同样，理想情况下是一次运行。

到目前为止，我的示例代码对于 .tar.gz 中文件的哈希以及 .gz 都可以正常工作，但是 .tar 的哈希是错误的，我无法找出问题所在.

我查看了 tar/reader.go 文件，发现其中有一些跳过，但我认为一切都应该在 io.Reader 接口上运行，因此 TeeReader 仍然应该捕获所有字节。

```
package main

import (
    "archive/tar"
    "compress/gzip"
    "crypto/md5"
    "fmt"
    "io"
    "os"
)

func main() {
    tgz, _ := os.Open("tb.tar.gz")
    gzMd5 := md5.New()
    gz, _ := gzip.NewReader(io.TeeReader(tgz, gzMd5))
    tarMd5 := md5.New()
    tr := tar.NewReader(io.TeeReader(gz, tarMd5))
    for {
        fileMd5 := md5.New()
        hdr, err := tr.Next()
        if err == io.EOF {
            break
        }
        io.Copy(fileMd5, tr)
        fmt.Printf("%x  %s\n", fileMd5.Sum(nil), hdr.Name)
    }
    fmt.Printf("%x  tb.tar\n", tarMd5.Sum(nil))
    fmt.Printf("%x  tb.tar.gz\n", gzMd5.Sum(nil))
} 
```

现在看下面的例子：

```
$ echo "a" > a.txt
$ echo "b" > b.txt
$ tar cf tb.tar a.txt b.txt 
$ gzip -c tb.tar > tb.tar.gz
$ md5sum a.txt b.txt tb.tar tb.tar.gz

60b725f10c9c85c70d97880dfe8191b3  a.txt
3b5d5c3712955042212316173ccf37be  b.txt
501352dcd8fbd0b8e3e887f7dafd9392  tb.tar
90d6ba204493d8e54d3b3b155bb7f370  tb.tar.gz 
```

在带有来自 Ubuntu 存储库的 go 1.02 的 Linux Mint 14（基于 Ubuntu 12.04）上，我的 go 程序的结果是：

```
$ go run tarmd5.go 
60b725f10c9c85c70d97880dfe8191b3  a.txt
3b5d5c3712955042212316173ccf37be  b.txt
a26ddab1c324780ccb5199ef4dc38691  tb.tar
90d6ba204493d8e54d3b3b155bb7f370  tb.tar.gz 
```

因此，除了 tb.tar 之外的所有哈希都符合预期。（当然，如果您重试该示例，您的 .tar 和 .tar.gz 将与此不同，因为时间戳不同）

任何有关如何使其工作的提示将不胜感激，但我真的更希望它在 1 次运行中运行（使用 TeeReaders）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T22:51:32.553

出现此问题是因为 tar 不会从您的阅读器读取每个字节。在对每个文件进行散列后，您需要清空阅读器以确保读取和散列每个字节。我通常这样做的方式是`io.Copy()`阅读直到EOF。

```
package main

import (
    "archive/tar"
    "compress/gzip"
    "crypto/md5"
    "fmt"
    "io"
    "io/ioutil"
    "os"
)

func main() {
    tgz, _ := os.Open("tb.tar.gz")
    gzMd5 := md5.New()
    gz, _ := gzip.NewReader(io.TeeReader(tgz, gzMd5))
    tarMd5 := md5.New()
    tee := io.TeeReader(gz, tarMd5) // need the reader later
    tr := tar.NewReader(tee)
    for {
        fileMd5 := md5.New()
        hdr, err := tr.Next()
        if err == io.EOF {
            break
        }
        io.Copy(fileMd5, tr)
        fmt.Printf("%x  %s\n", fileMd5.Sum(nil), hdr.Name)
    }
    io.Copy(ioutil.Discard, tee) // read unused portions of the tar file
    fmt.Printf("%x  tb.tar\n", tarMd5.Sum(nil))
    fmt.Printf("%x  tb.tar.gz\n", gzMd5.Sum(nil))
} 
```

另一种选择是`io.Copy(tarMd5, gz)`在 tarMd5.Sum() 调用之前添加。我认为第一种方法更清晰，即使我需要添加/修改四行而不是一行。

# c - Given an OID, how do I find the corresponding MIB?

> ID：15179199
> 
> 赞同：0
> 
> 时间：2013-03-02T20:37:34.137
> 
> 标签：c, net-snmp, mib

I'm using net-snmp. Given a specific OID such as `.1.3.6.1`, how do I find the corresponding `MIB/module/filename/anything` where that OID is described?

I've looked through all the `#include file in <net-snmp/*>` but I cannot figure it out.

I was expecting something along the lines of:

```
struct module *netsnmp_get_module_from_oid( oid *, int oidlen ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:06:30.390

我想到了。这是一个 3 步过程：

```
struct tree *head = get_tree_head();
struct tree *t = get_tree( o, l, head );
struct module *m = find_module( t->modid ); 
```

这给出了模块名称、文件名和模块所做的导入列表，然后可以进一步查找。当用`.1.3.6.1`原始问题中的示例调用它时，这给了我：

```
NAME=SNMPv2-SMI
FILE=/usr/share/mibs/ietf/SNMPv2-SMI
COUNT=3
#0: LABEL=joint-iso-ccitt, ID=-1
#1: LABEL=ccitt, ID=-1
#2: LABEL=iso, ID=-1 
```

# actionscript-3 - As3, OOP strategy for custom class DrawVectorLineArt

> ID：15179202
> 
> 赞同：0
> 
> 时间：2013-03-02T20:37:46.927
> 
> 标签：actionscript-3, oop, subclass

I am doing some math projects that require a lot of vector line art--that is a line drawn between to points with a circle at the start point and an arrow at the end point. A call to Math.atan2() keeps the arrow aligned. I call this class **DrawVectorLineArt()** and it creates instances of 2 other custom classes **DrawArrow()** and **DrawCircle()**.

So far so good--DrawVectorLineArt() draws just what I need. Now I need to **animate** the vector art. So in a function onEnterFrame I want to update the postion of arrow and circle, the objects created by DrawArrow() and DrawCircle(), respectively. I also need to clear and redraw the line drawn between them. At this point I am not sure how to proceed in an OOP framework. Do I need to create methods of my custorm class DrawVectorLineArt() to update the position of arrow and circle and subsequently clear and redraw the connecting line?

Any advice or links appreciated. Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:53:30.633

“我是否需要创建我的 custorm 类 DrawVectorLineArt() 的方法来更新箭头和圆圈的位置，然后清除并重绘连接线？”

是的。

箭头和圆圈都是 DrawVectorLineArt 的成员，按照名称和成员的选择，线也应如此（如果它是通过实际数据实现的）。DrawVectorLineArt 应该包含并实现圆、箭头和线之间的整个动画。因此，如果动画应该能够在创建后更改，则 DrawVectorLineArt 的同一实例应该能够获取提供给它的任何两个合法点（或者它会在内部意识到，这取决于你在做什么），重新定位三个组件，并在其自己的代码中适当地转动箭头和线。

# javascript - how to stop double javascript trigger at the bottm of the page

> ID：15179203
> 
> 赞同：0
> 
> 时间：2013-03-02T20:38:00.387
> 
> 标签：javascript, jquery, html, scroll

How to prevent this double triggering at the bottom of the webpage.

Here is the option when you reach 100px from the bottom you see alert message but when you hit bottom you see it too and I only want to see it once even if you hit the bottom of the webpage.

Here is the link:

[double triggering](http://jsfiddle.net/nick_craver/gWD66/1/)

And the code:

```
 $(window).scroll(function() {   
   if($(window).scrollTop() + $(window).height() > $(document).height() - 100) {
       alert("bottom!");
   }
}); 
```

EDIT:

Problem is that I am appending multiple divs to the website and I do not have fixed number of them, so that is why I need to check if I have hit the bottom of the page.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:45:10.287

您可以设置一个标志来控制此行为：

```
var alerted = false;
$(window).scroll(function () {
    if ($(window).scrollTop() + $(window).height() > $(document).height() - 100) {
        if (!alerted) {
            alert("bottom!");
            alerted = true;
        }
    }
    else alerted = false;
}); 
```

[http://jsfiddle.net/gWD66/1117/](http://jsfiddle.net/gWD66/1117/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:40:35.197

一般的答案是在事件处理程序触发后简单地删除它。

然而，jQuery 可以通过它的[`.one()`](http://api.jquery.com/one)事件处理函数为你做这件事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:40:46.473

尝试这个：

```
 var beenOnBottom = false;
 $(window).scroll(function() {  

   if($(window).scrollTop() + $(window).height() > $(document).height() - 100) {
       if(!beenOnBottom)
       {
           alert("bottom!");
           beenOnBottom = true;
       }
   }
}); 
```

如果您想在再次上升时显示消息，您可以在`beenOnBottom`超过 100px 值时重新设置变量

# database - lock conversion update locks

> ID：15179206
> 
> 赞同：0
> 
> 时间：2013-03-02T20:38:39.120
> 
> 标签：database, transactions, locking

I am reading chapter 6 of your book, Principles of Transaction Processing and the concept of update lock explained in there is not very clear to me. Basically, what I am not clear about is that won't locking conversion deadlock occur when you try to upgrade a update lock to the write lock. Say we say the deadlock does not occur during conversion of update lock to write lock. Can you then not have the following scenario

u1[x]r2[x]w1[x]w1[z]w2[z].

u1[x] means transaction 1 has a update lock on x.

So in the above history transaction 2 is before 1 on x but after 1 on z. Doesnt that violate serializability?

I would really appreciate if you can clear this for me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:01:20.723

哦，nvm，我刚读到书上说，如果您有并发读取操作，则不能从更新锁升级到写锁。所以是的，它不会以这种方式违反可序列化性:)。此外，如果有人碰巧遇到这种情况，您不能将读锁升级为更新锁，因为这也会因锁转换而导致死锁。

# java - 细胞编辑器是如何工作的？

> ID：15179211
> 
> 赞同：0
> 
> 时间：2013-03-02T20:38:58.927
> 
> 标签：java, swing, jtable, tablecelleditor, cellrenderer

我在理解 CellEditor 如何在 Java 中工作时遇到问题。

我有一个带有模型的 JTable（扩展 AbstractTableModel）。JTable 有它的 CellRenderer 和 CellEditor。CellEditor 仅覆盖 isCellEditable() （添加了一个条件）。

我在一个单元格中所做的更改如何进入模型？模型是否必须实现 CellEditorListener 并对 stopEditing() 做出反应？

我已阅读，更改将自动存储在模型中。真的吗？如果是，它是如何工作的？那我必须对 tableChanged() 做出反应吗？

请解释数据的方式，已更改以及我必须在哪些步骤中做某事。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:47:54.883

[`TableModel`更改通过'`.setValueAt()`](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/TableModel.html#setValueAt%28java.lang.Object,%20int,%20int%29)方法应用于模型。JTable 本身负责接收 CellEditor 返回的值并将其传递给 TableModel。

# mysql - SQL-query in cakephp-style

> ID：15179220
> 
> 赞同：0
> 
> 时间：2013-03-02T20:39:51.383
> 
> 标签：mysql, cakephp-2.1

I'm working on a cakephp issue. I know how we do queries in cakephp. In certain circumstances you have to use the sql statement itself as query($sql). Below is a query to get the nearest points from a database. The SQL works fine. Now, I want to have it in cakephp-style to add the common pagination form cakephp. Unfortunately I can't find any information about how to do it. It's not easy to find information to do that in general. So I don't want to have a solution from you, I would be happy to get links how to transform a complicated query into cakephp.

Here is my codesnippet (it's working as already mentioned).

```
 public function getRestAroundMe($lat, $lng, $radius, $limit) {  // Get some data to validate login.
        /* Source: http://funkjedi.com/technology/308-search-using-geolocation-data-in-mysql/ */

        // Constants related to the surface of the Earth
        $earths_radius = 6371;
        $surface_distance_coeffient = 111.320;

        // Spherical Law of Cosines
        $distance_formula = sprintf('%s * ACOS( SIN(RADIANS(geolatitude)) * SIN(RADIANS(%s)) + COS(RADIANS(geolongitude - %s)) * COS(RADIANS(geolatitude)) * COS(RADIANS(%s)) )', $earths_radius, $lat, $lng, $lat); 

        // Create a bounding box to reduce the scope of our search
        $lng_b1 = $lng - $radius / abs(cos(deg2rad($lat)) * $surface_distance_coeffient);
        $lng_b2 = $lng + $radius / abs(cos(deg2rad($lat)) * $surface_distance_coeffient);
        $lat_b1 = $lat - $radius / $surface_distance_coeffient;
        $lat_b2 = $lat + $radius / $surface_distance_coeffient;

        // Construct our sql statement
        $sql = sprintf('SELECT *, (%s) AS distance FROM restaurants AS Restaurant WHERE (geolatitude BETWEEN %s AND %s) AND (geolongitude BETWEEN %s AND %s) HAVING distance < %s ORDER BY distance ASC LIMIT 0, %s', $distance_formula, $lat_b1, $lat_b2, $lng_b1, $lng_b2, $radius, $limit);

        return $this->query($sql);
} 
```

Thank you for any help

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T20:14:17.663

现在我有我的解决方案：

```
 public function geoRest($lat, $lng, $radius, $limit) {
        /* Source: http://funkjedi.com/technology/308-search-using-geolocation-data-in-mysql/ */

        // Constants related to the surface of the Earth
        $earths_radius = 6371;
        $surface_distance_coeffient = 111.320;

        // Spherical Law of Cosines
        //$distance_formula ='$earths_radius * ACOS( SIN(RADIANS(geolatitude)) * SIN(RADIANS($lat)) + COS(RADIANS(geolongitude - $lng)) * COS(RADIANS(geolatitude)) * COS(RADIANS($lat)) )';
        $distance_formula = sprintf('%s * ACOS( SIN(RADIANS(geolatitude)) * SIN(RADIANS(%s)) + COS(RADIANS(geolongitude - %s)) * COS(RADIANS(geolatitude)) * COS(RADIANS(%s)) )', $earths_radius, $lat, $lng, $lat); 
        // Create a bounding box to reduce the scope of our search
        $lng_b1 = $lng - $radius / abs(cos(deg2rad($lat)) * $surface_distance_coeffient);
        $lng_b2 = $lng + $radius / abs(cos(deg2rad($lat)) * $surface_distance_coeffient);
        $lat_b1 = $lat - $radius / $surface_distance_coeffient;
        $lat_b2 = $lat + $radius / $surface_distance_coeffient;

        // Construct our sql statement
        //$sql = sprintf('SELECT *, (%s) AS distance FROM restaurants AS Restaurant WHERE (geolatitude BETWEEN %s AND %s) AND (geolongitude BETWEEN %s AND %s) HAVING distance < %s ORDER BY distance ASC LIMIT 0, %s', $distance_formula, $lat_b1, $lat_b2, $lng_b1, $lng_b2, $radius, $limit);
        //return $this->query($sql);
        //$options['fields'] = array('*',$distance_formula.' AS distance');

        $this->virtualFields['distance'] = $distance_formula;
        $options['fields'] = array('*');
        $options['conditions'] = array(
                            'Restaurant.geolatitude BETWEEN ? AND ?' => array($lat_b1, $lat_b2),
                            'AND' => array('Restaurant.geolongitude BETWEEN ? AND ?' => array($lng_b1, $lng_b2)),
                            'AND' => array('NOT' => array('Restaurant.geolongitude' => 0)),
                            'AND' => array('NOT' => array('Restaurant.geolatitude' => 0)),
                            'AND' => array('NOT' => array('Restaurant.geolongitude' => null)),
                            'AND' => array('NOT' => array('Restaurant.geolatitude' => null))
                            );
        $options['contain'] = array(
                            'Menu' => array(
                                            'conditions' => array(
                                                                  'Menu.active' => '1'
                                                                  )
                                            )
        );

        $options['order'] = 'Restaurant.distance ASC';
        $options['limit'] = $limit;

        //return $options;

        return $this->find('all', $options); 
```

不幸的是，“包含”不起作用，但这是我正在解决的另一个问题。如果有人对此有解决方案，那就太好了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T11:48:37.647

看看[自定义查询分页](http://book.cakephp.org/2.0/en/core-libraries/components/pagination.html#custom-query-pagination)。有一些方法可以使用自定义查询进行分页。

# java - 在 Java 中也有与 Delphi 中的“结果”变量相媲美的东西吗？

> ID：15179222
> 
> 赞同：0
> 
> 时间：2013-03-02T20:40:07.533
> 
> 标签：java

在使用 Delphi 时，我真正喜欢的一件事是`result`函数有一个变量。Delphi 函数结束如下：

```
result:="My Result"; 
```

结果变量的数据类型是函数的返回类型。不需要额外的代码。现在，当我用 Java 写东西时，它大部分时间看起来像这样：

```
function List<Foo> myFunc(){
  List<Foo> myResultVar = new ArrayList<>();
  //--now i do some clever stuff--
  return myResultVar;
} 
```

如您所见，与 Delphi 相比，至少当您必须编写的不仅仅是单行代码时，它的样板代码更多。有没有可以与 Java中的变量相媲美的东西`result`，我只是不知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:41:52.393

不，没有那样的。在 Java 中表示返回什么的唯一方法是使用`return`语句。

在你的代码中，你为什么不只`myResultVar`在你真正知道要返回的值的地方声明呢？或者，如果您决定在各种不同的分支中，声明变量*而不*给它一个初始值：

```
int result;
if (something) {
   // Do some work...
   result = foo();
} else {
   // Do some other work...
   result = bar();
}
// Do some post work...
return result; 
```

*如果在那之后*您不需要做任何事情，那么无论如何都立即返回......如果您可以给出一些代码的具体示例，您真的认为拥有一个特殊变量会使代码变得更加简单，我们可以尝试用 Java 编写最干净有效的等效代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:42:37.397

不，Java 编程语言的语法源自 C 语言的语法，而 Delphi 源自 Pascal。

没有什么比得上德尔福的`result`伪变量了。

# python - 选择相关问题

> ID：15179224
> 
> 赞同：1
> 
> 时间：2013-03-02T20:40:24.757
> 
> 标签：python, django, django-orm

这是我的模型：

```
class Brand(models.Model):
    name         = models.CharField(max_length=30)
    order        = models.SmallIntegerField()

class FeatureGroup(models.Model):
    name         = models.CharField(max_length=30)

class Feature(models.Model):
    name         = models.CharField(max_length=30, blank=True)
    order        = models.SmallIntegerField()
    group        = models.ForeignKey(FeatureGroup)

class FeatureDetail(models.Model):
    description         = models.TextField()
    feature             = models.ForeignKey(Feature)

class Phone(models.Model):
    name         = models.CharField(max_length=30)
    brand        = models.ForeignKey(Brand)
    features     = models.ManyToManyField(FeatureDetail) 
```

我试图获取当前手机的功能和功能详细信息并循环数据对但无法这样做。

我试过这个，它只适用于获得品牌：

```
p = get_object_or_404(Phone.objects.select_related('brand', 'feature__featuredetail'), id=id) 
```

做的时候：

```
print p.featuredetail_set.all() 
```

我得到了这个错误：

```
Django Version: 1.4.3
Exception Type: AttributeError
Exception Value:    
'Phone' object has no attribute 'featuredetail_set' 
```

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T08:29:39.973

您不能使用类名作为`select_related`. 该参数必须是您的模型字段的字符串。

在你的情况下，它应该是`'features__feature'`

另一个问题是`select_related` **不能遵循多对多关系**。这就是为什么`prefetch_related`来。

因此，您的查询集将是：

```
Phone.objects.select_related('brand').prefetch_related('features__feature') 
```

请注意，这`prefetch_related`会创建一个附加查询并在 Python 中加入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:16:48.730

你的关系叫`features`，不是`featuredetail_set`。

请注意`select_related`，这与 无关，在这种情况下它什么都不做（它只适用于正向 ForeignKeys，无论如何）。

# python - 特殊方法（“魔术方法”）的哪些实现/使用在 python 中是不好的做法？

> ID：15179233
> 
> 赞同：1
> 
> 时间：2013-03-02T20:41:21.950
> 
> 标签：python, interface-implementation

我正在设计一个 python 模块，它与模拟 API 的几个部分（通过 windows dll）接口。我想充分利用python，使库既干净又易于使用。

在实现我自己的类以与 API 的一部分接口时，我发现自己想要实现`__getitem__`并`__setitem__`作为 API`getValue()`和`setValue()`方法的访问者。它为模拟软件中的内部十六进制值提供了一个更清晰的接口，但这是不好的做法，还是可能不是 Pythonic？

以下是我想要实现的示例：

```
# Note that each word is identified by a unique integer and each has a
# settable/retrievable hex value within the simulation software.

class sim:
    ...
    ...
    def __getitem__(self, key):
        ''' check for valid key range (int)'''
        ''' else throw exception '''
        val = simAPI.getValue(key) # returns the value of the word at the key in the 
                                   # software, None on failure
        if val:
            return val
        '''else throw exception '''

    def __setitem__(self, key, value):
        ''' check for valid key range and value (int, int)'''
        ''' else throw exception '''

        if not simAPI.setValue(key, value): # sets the value of the word at the key in the 
        ''' throw exception'''              # software, None on failure

    ...
    ... 
```

这将允许：

```
Word = sim() 

Word[20] = 0x0003 # set word 20 to hex value 0x0003 in the simulation software

if Word[23] == 0x0005: # check if word 23 is equal to 0x0005 
    pass 
```

也许随着更多的发展，切片以设置多个单词：

```
Word[1:5] = 0x0004 # set words 1-5 to 0x0004 
```

虽然我已经描述了我的具体案例，但我真诚地欢迎就特殊方法的哪些实现/使用是不好的做法进行一般性讨论。

在此先感谢您抽出宝贵时间回答我的问题！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:45:57.820

这不一定是坏习惯。关于获取和设置项目的事情是您只能为它们进行一次操作。也就是说，只有一种语法可以让您`object[index]`使用方括号。所以主要的事情是确保你真的想用你定义的操作“用完”那个语法。

如果在 SimAPI 中这些`getValue`方法确实看起来是一个显而易见的选择——也就是说，如果`getValue`真的得到*了*值而不仅仅是*一个*值——那似乎很好。您要避免的是选择一个相对随机或非特殊的操作，并通过`__getitem__`访问它来赋予它特殊的状态。

# google-app-engine - ndb get & get_or_insert 怎么用？（总是引发异常）

> ID：15179240
> 
> 赞同：1
> 
> 时间：2013-03-02T20:42:05.240
> 
> 标签：google-app-engine, google-cloud-datastore, app-engine-ndb

我写代码如下

```
from google.appengine.ext import ndb

__metaclass__ = type

class UserSession(ndb.Model):
    session = ndb.BlobProperty()

class KV:
    @staticmethod
    def get(id):
        r = ndb.Key(UserSession, int(id)).get()
        if r:
            return r.session

    @staticmethod
    def set(id, value):
        return UserSession.get_or_insert(int(id), session=value)

    @staticmethod
    def delete(id):
        ndb.Key(UserSession, int(id)).delete() 
```

我写的地方

```
id = 1
key = ndb.Key(UserSession, int(id))
UserSession.get_or_insert(key, session=1) 
```

sdk 加薪

```
TypeError: name must be a string; received Key('UserSession', 1) 
```

当我调用 KV.get ()

sdk 加薪

文件“/home/bitcoin/42btc/zapp/_plugin/auth/model/gae/user.py”，第 14 行，在 get

```
 r = ndb.Key(UserSession,int(id)).get() 
```

...

BadRequestError：缺少密钥 ID/名称

那么，如何使用 NDB？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-03T16:43:32.753

get_or_insert() 方法接受一个字符串，该字符串只是密钥的 ID 部分，而不是密钥。它不能使用数字 ID。

# javascript - IE、FF 和 Opera 中的 Div 定位行为

> ID：15179244
> 
> 赞同：-1
> 
> 时间：2013-03-02T20:42:29.350
> 
> 标签：javascript, html, css

我的站点右栏中有 div，由于某种原因，它在 IE、FF 和 Opera 中的行为很奇怪。但在 Chrome 和 Safari 中可以正常工作。

这是有问题的页面：[链接](http://compare-best-kettlebells-dvds.com/visitsite/link)。

如果您想知道，滑块基于[此处找到的稍微修改的代码。](http://jqueryfordesigners.com/fixed-floating-elements/)

所以问题是：为什么在不同的浏览器中有不同的行为以及如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:50:11.783

我能够通过`width="700"`从单元格中删除属性来解决问题`.content2`。由于您已经将表格指定为 900 并将右侧单元格指定为 200，因此无需添加其他单元格的宽度，并且它修复了奇怪的行为。

# android - ImageView，更改 DemoArrayAdapter 以显示图像

> ID：15179246
> 
> 赞同：0
> 
> 时间：2013-03-02T20:42:40.613
> 
> 标签：android, listview, youtube, android-arrayadapter

每个人。这是来自 youtube api 演示的代码。我只是想自定义列表视图，而不仅仅是显示文本，我想在文本之前为列表视图中的每个项目添加一个特定的图像。为了澄清，“显示我的频道”出现在哪里......“我的播放列表1”......它应该在这些文本之前出现一个图像以点击它。

我知道我应该修改 DemoArrayAdapter 上的 getview()。但是怎么做？我是新手。这就是为什么我将 DemoArrayAdapter.Java 的代码放在下面

IntentDemoActivity.Java

```
package com.examples.youtubeapidemo;

import com.google.android.youtube.player.YouTubeIntents;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListView;
import android.widget.TextView;

import com.examples.youtubeapidemo.adapter.DemoArrayAdapter;
import com.examples.youtubeapidemo.adapter.DemoListViewItem;

import java.util.ArrayList;
import java.util.List;

/**
* A sample activity which shows how to use the {@link YouTubeIntents} static methods     to create
* Intents that navigate the user to Activities within the main YouTube application.
*/
public final class IntentsDemoActivity extends Activity implements OnItemClickListener   {

 // This is the value of Intent.EXTRA_LOCAL_ONLY for API level 11 and above.
 private static final String EXTRA_LOCAL_ONLY = "android.intent.extra.LOCAL_ONLY";
 private static final String VIDEO_ID = "tKIISemrwJ8";
 private static final String PLAYLIST_ID = "PL75F25C99BA786497";
 private static final String PLAYLIST_ID2 = "PL75F25C99BA786497";
 private static final String USER_ID = "felipeneto";
 private static final int SELECT_VIDEO_REQUEST = 1000;

 private List<DemoListViewItem> intentItems;

 @Override
 public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.intents_demo);

intentItems = new ArrayList<DemoListViewItem>();
intentItems.add(new IntentItem("Show My Channel", IntentType.OPEN_USER));
intentItems.add(new IntentItem("My Playlist 1", IntentType.OPEN_PLAYLIST));
intentItems.add(new IntentItem("My Playlist 2", IntentType.OPEN_PLAYLIST2));
intentItems.add(new IntentItem("Featured", IntentType.PLAY_VIDEO));
intentItems.add(new IntentItem("Search", IntentType.OPEN_SEARCH));

ListView listView = (ListView) findViewById(R.id.intent_list);
DemoArrayAdapter adapter =
    new DemoArrayAdapter(this, R.layout.list_item, intentItems);
listView.setAdapter(adapter);
listView.setOnItemClickListener(this);

TextView youTubeVersionText = (TextView) findViewById(R.id.youtube_version_text);
String version = YouTubeIntents.getInstalledYouTubeVersionName(this);
if (version != null) {
  String text = String.format(getString(R.string.youtube_currently_installed), version);
  youTubeVersionText.setText(text);
} else {
  youTubeVersionText.setText(getString(R.string.youtube_not_installed));
}
 }

 public boolean isIntentTypeEnabled(IntentType type) {
  switch (type) {
  case PLAY_VIDEO:
    return YouTubeIntents.canResolvePlayVideoIntent(this);
  case OPEN_PLAYLIST:
    return YouTubeIntents.canResolveOpenPlaylistIntent(this);
  case OPEN_PLAYLIST2:
      return YouTubeIntents.canResolveOpenPlaylistIntent(this);
  case PLAY_PLAYLIST:
    return YouTubeIntents.canResolvePlayPlaylistIntent(this);
  case OPEN_SEARCH:
    return YouTubeIntents.canResolveSearchIntent(this);
  case OPEN_USER:
    return YouTubeIntents.canResolveUserIntent(this);

}

return false;
 }

  public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
  IntentItem clickedIntentItem = (IntentItem) intentItems.get(position);

Intent intent;
switch (clickedIntentItem.type) {
  case PLAY_VIDEO:
    intent = YouTubeIntents.createPlayVideoIntentWithOptions(this, VIDEO_ID, true, false);
    startActivity(intent);
    break;    
  case OPEN_PLAYLIST:
    intent = YouTubeIntents.createOpenPlaylistIntent(this, PLAYLIST_ID);
    startActivity(intent);
    break;
  case OPEN_PLAYLIST2:
      intent = YouTubeIntents.createOpenPlaylistIntent(this, PLAYLIST_ID2);
      startActivity(intent);
      break;
  case PLAY_PLAYLIST:
    intent = YouTubeIntents.createPlayPlaylistIntent(this, PLAYLIST_ID);
    startActivity(intent);
    break;
  case OPEN_SEARCH:
    intent = YouTubeIntents.createSearchIntent(this, USER_ID);
    startActivity(intent);
    break;
  case OPEN_USER:
    intent = YouTubeIntents.createUserIntent(this, USER_ID);
    startActivity(intent);
    break;

   }
   }

   @Override
 protected void onActivityResult(int requestCode, int resultCode, Intent returnedIntent) {
if (resultCode == RESULT_OK) {
  switch (requestCode) {
    case SELECT_VIDEO_REQUEST:
      Intent intent = YouTubeIntents.createUploadIntent(this, returnedIntent.getData());
      startActivity(intent);
      break;
  }
}
super.onActivityResult(requestCode, resultCode, returnedIntent);
   }

  private enum IntentType {
PLAY_VIDEO,
OPEN_PLAYLIST,
OPEN_PLAYLIST2,
PLAY_PLAYLIST,
OPEN_USER,
OPEN_SEARCH,

  }

  private final class IntentItem implements DemoListViewItem {

   public final String title;
    public final IntentType type;

   public IntentItem(String title, IntentType type) {
     this.title = title;
     this.type = type;
    }

    public String getTitle() {
    return title;
    }

   public boolean isEnabled() {
     return isIntentTypeEnabled(type);
   }

    public String getDisabledText() {
     return getString(R.string.intent_disabled);
    }

    }

   } 
```

DemoArrayAdapter.java。举一个例子，我应该修改或放置以获得我想要的东西（每个项目的不同图像）。

```
 package com.examples.youtubeapidemo.adapter;

import android.content.Context;
import android.graphics.Color;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
 import android.widget.TextView;

import com.examples.youtubeapidemo.R;

import java.util.List;

/**
* A convenience class to make ListViews easier to use in the demo activities.
*/
public final class DemoArrayAdapter extends ArrayAdapter<DemoListViewItem> {

  private final LayoutInflater inflater;

  public DemoArrayAdapter(Context context, int textViewResourceId, List<DemoListViewItem> objects) {
    super(context, textViewResourceId, objects);
   inflater = (LayoutInflater)    context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
  }

  @Override
  public View getView(int position, View view, ViewGroup parent) {
   if (view == null) {
    view = inflater.inflate(R.layout.list_item, null);
    }

     TextView textView = (TextView) view.findViewById(R.id.list_item_text);
     textView.setText(getItem(position).getTitle());
     TextView disabledText = (TextView) view.findViewById(R.id.list_item_disabled_text);
    disabledText.setText(getItem(position).getDisabledText());

    if (isEnabled(position)) {
     disabledText.setVisibility(View.INVISIBLE);
     textView.setTextColor(Color.WHITE);
    } else {
     disabledText.setVisibility(View.VISIBLE);
     textView.setTextColor(Color.GRAY);
    }

    return view;
    }

   @Override
   public boolean areAllItemsEnabled() {
    // have to return true here otherwise disabled items won't show a divider in the list.
    return true;
   }

   @Override
  public boolean isEnabled(int position) {
   return getItem(position).isEnabled();
  }

   public boolean anyDisabled() {
    for (int i = 0; i < getCount(); i++) {
     if (!isEnabled(i)) {
       return true;
      }
   }
    return false;
  }

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:25:36.683

在下面的 getView 方法中，适配器在更新 View 时引用了一个图像数组。

mContext 在 ArrayAdapter 构造函数中初始化

mThumbs 是一个 id 数组，引用您希望显示的图像

```
public Integer[] mThumbs{/*R.drawable.img1, R.drawable.img2,....*/};
private Context mContext;

@Override
public View getView(int position, View convertView, ViewGroup parent){

    if (view == null) {
        view = inflater.inflate(R.layout.list_item, null);
    }

    ImageView imageView;
    if(convertView == null)// Recycled View
    {
        imageView = new ImageView(mContext); 
        imageView.setScaleType(ImageView.ScaleType.FIT_CENTER);
    }
    else // Re-use the view
    {
        imageView = (ImageView) convertView;
    }

    imageView.setImageResource(mThumbs[position]);
    return imageView;
} 
```

希望这可以帮助！

# xcode - 如何将 Box2d 添加到现有的 Xcode/Cocos2d 项目中

> ID：15179253
> 
> 赞同：5
> 
> 时间：2013-03-02T20:43:46.950
> 
> 标签：xcode, cocos2d-iphone, box2d, box2d-iphone

我有一个工作 Xcode 项目，其中一个视图中包含 Cocos2d。我现在需要添加 Box2d。我尝试将 Box2D 文件夹拖到我的 cocos2d-2.x-ARC-iOS 文件夹的 libs 目录中并添加到该目标，但我在编译时得到了这个：

```
(in b2BroadPhase.cpp)
'Box2D/Collision/b2BroadPhase.h' file not found 
```

我确信这只是我会遇到的许多错误中的第一个。为了在我的项目中编译所有 Box2d 文件，我缺少什么步骤？

所有 box2d 文件都列在 cocos2d-library 目标的编译源中。

为什么这很难做到？为什么它不像其他图书馆那样工作？

并且 - 我是否必须将项目中的每个 .m 重命名为 .mm？这几乎是不可能的，因为这是一个包含许多文件的大型 xcode 项目。我只是想在一个视图中使用 Box2d。

* * *

针对LearnCocos2D给出的答案的附加信息-

我的文件夹结构（在 Finder 中）如下所示：

Root = MyProject.xcodeproj，MyProject 文件夹，cocos2d-2.x-ARC-iOS 文件夹在cocos2d-2.x-ARC-iOS 文件夹中有一个名为libs 的文件夹。在该文件夹中，我有 Box2D 文件夹，以及 Cocos2d、CocosDenshion 等。

在 XCode 中，我有一个 PROJECT (MyProject) 和 2 个 TARGETS (cocos2d-library, MyProject) PROJECT 和 TARGETS 都有“标题搜索路径”。我设置哪一个？它应该是递归的还是非递归的？当我将 Box2D 文件夹拖到 Xcode 中时，我将它设置为哪个目标？

我的项目文件位于 /Users/me/Dropbox/iOS/MyProject。那么我究竟为标题搜索路径输入了什么？/Users/me/Dropbox/iOS/MyProject/cocos2d-2.x-ARC-iOS/libs 似乎不起作用。

* * *

另一个更新 - /Users/me/Dropbox/iOS/MyProject/cocos2d-2.x-ARC-iOS/libs 作为 MyProject TARGET 中的标题搜索路径似乎让我摆脱了 Box2D 错误。然后我有一个'cassert'文件未找到错误。通过将视图控制器、它的父级和 AppDelegate 更改为您建议的“Objective-C++ Source”文件类型来解决这个问题。现在...

现在我在 NSObjCRuntime.h NSZone.h、NSObject 中遇到了一系列错误（预期的不合格 ID、未知类型名称“NSString”等）。所以看起来你要么使用 Box2d/Cocos2d 创建一个应用程序，要么创建一个 UIKit 应用程序。试图两者兼得是一场彻头彻尾的噩梦。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T23:43:18.743

最简单的解决方案：开始一个已经集成了 Box2D 的新项目。然后将您的源文件和资源添加到其中。相信我，它不会变得更容易。

我想到了 Box2D 需要的几件事：

作为搜索路径，使用 Box2D.h 文件的路径**减去一级**。好的，这需要一个更好的解释：

如果 Box2D.h 在`/Projects/MyProject/libs/Box2D`

...那么搜索路径应该是`/Projects/MyProject/libs`

这是因为 Box2D #include 语句总是包含 Box2D 路径：

```
#include <Box2D/Common/b2Settings.h> 
```

总之，标题搜索路径加上#include/#import 路径应该给出文件的完整路径：

```
/Projects/MyProject/libs/Box2D/Common/b2Settings.h 
```

然后很容易检查您的搜索路径是否正确。

确保将搜索路径添加到**Header Search Path**而不是 User Header Search Path 设置，就像其他库一样。这是因为 Box2D 使用尖括号`<file.h>`包含。大多数其他库都使用`"file.h"`，它们使用用户头文件搜索路径来查找他们的头文件。

为什么难？编译器设置。他们有很多。错误和警告并不总是显而易见的。其实，这是常态。还有很多编写和添加代码的方法。哦，还有这么多不同的语言和语言版本。这主要是经验问题。5级以上就容易多了，10级就麻烦了。:)

您必须直接（`#import "Box2D.h"`）或间接（包括包含 Box2D 的标头）重命名每个包含 Box2D 的 .m 文件。如果您将 Box2D 标头添加到 Prefix.pch 文件，这与将其包含在每个文件中是一样的 - 所以在您的情况下我不会这样做。

您可以通过将 Xcode 中 .m 文件的文件类型设置为“Objective-C++”来避免重命名。尽管这将同样乏味，如果不是更多的话。提示：对于像这样的情况，有大量重命名文件的好工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-09T20:27:17.937

将此添加到标题搜索路径并查看神奇的工作： $[PROJECT_DIR]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-27T03:05:15.590

您可能会遇到以下编译错误：

1.  “未找到头文件”：解决方法是修改用户头文件搜索路径以包含 Box2D 的目录。如果将 Box2D 放在项目目录下，则可以使用以下环境变量 ${PROJECT_DIR}。记得检查“递归”。注意：从标题路径中删除所有到 Box2D 的链接。例如：TestGame/Libraries/Box2D -> ${PROJECT_DIR}/TestGame/Libraries

2.  找不到 Cpp 头文件，例如`<cassert>`...：将文件重命名为扩展名 *.mm 而不是 *.m 将解决此问题。

# android - 如何制作可以“管理”其他 Android 应用的 Android 应用

> ID：15179260
> 
> 赞同：2
> 
> 时间：2013-03-02T20:44:48.177
> 
> 标签：android

例如，谷歌市场上有一个名为“Lookout Security & Antivirus”的流行应用程序。

此应用程序可以显示所有访问您的位置、联系人、短信和彩信数据的应用程序。

我想知道如何在 Android 中做到这一点的总体思路（我不是要源代码！）

这个应用程序不需要root权限来做所有这些，所以我相信Android SDK实际上提供了这些功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:53:33.023

因此，有一些称为[PackageManager](http://developer.android.com/reference/android/content/pm/PackageManager.html)的东西可以为您提供有关[PackageInfo](http://developer.android.com/reference/android/content/pm/PackageInfo.html)的信息，您可以从中探索更多信息并提取 PERMISSION_GRANTED。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:58:32.360

我的想法是获取所有已安装软件包（应用程序）的列表，并检查他们在清单中注册的权限。

这可以使用`PackageManager`-class 来完成，命名为[`getInstalledPackages()`-method](http://developer.android.com/reference/android/content/pm/PackageManager.html#getInstalledPackages%28int%29)，与[`GET_PERMISSIONS`-flag 一起](http://developer.android.com/reference/android/content/pm/PackageManager.html#GET_PERMISSIONS)提供。

```
PackageManager manager = context.getPackageManager();
for (PackageInfo info : manager.getInstalledPackages(PackageManager.GET_PERMISSIONS){
  for (PermissionInfo perm : info.permissions){
    // Check if your requested permission is in the list
  }
} 
```

# c++ - 为什么这个随机生成器不起作用？

> ID：15179261
> 
> 赞同：1
> 
> 时间：2013-03-02T20:44:50.590
> 
> 标签：c++, function, random

每次我运行这段代码时，它都会返回这个值：1804289383 如果我在 main() 中移动 random() 的主体，它运行得很好。

```
#include <iostream>
#include <ctime>
#include <cstdlib>
using namespace std;

int random(int);

int main()
{

    cout << random();
    cin.get();
    return 0;
}

int random(int) 
{
    unsigned seed = time(0); 
    srand(seed);              

    int randomNum = rand()%4 + 1;
    return randomNum;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:47:47.220

问题是它`random()`需要一个论点，而您没有提供论点。

如果你这样称呼它：

```
cout << random(0); 
```

它会工作的。

然而，更好的方法是消除该参数，因为它没有被使用。

最后但同样重要的是，您应该只`srand()`在程序启动时调用一次。

# shell - 如何通过 Unix join 获取外连接中的所有字段？

> ID：15179262
> 
> 赞同：11
> 
> 时间：2013-03-02T20:44:52.193
> 
> 标签：shell, unix, join, gnu, gnu-coreutils

假设我有两个文件`en.csv`和`sp.csv`，每个文件都包含两个逗号分隔的记录：

`en.csv`：

```
1,dog,red,car
3,cat,white,boat 
```

`sp.csv`：

```
2,conejo,gris,tren
3,gato,blanco,bote 
```

如果我执行

```
join -t, -a 1 -a 2 -e MISSING en.csv sp.csv 
```

我得到的输出是：

```
1,dog,red,car
2,conejo,gris,tren
3,cat,white,boat,gato,blanco,bote 
```

请注意，所有缺少的字段都已折叠。要获得“正确”的完全外连接，我需要指定一种格式；因此

```
join -t, -a 1 -a 2 -e MISSING -o 0,1.2,1.3,1.4,2.2,2.3,2.4 en.csv sp.csv 
```

产量

```
1,dog,red,car,MISSING,MISSING,MISSING
2,MISSING,MISSING,MISSING,conejo,gris,tren
3,cat,white,boat,gato,blanco,bote 
```

这种产生完全外连接的方法的一个缺点是需要显式指定最终表的格式，这在编程应用程序中可能不容易做到（连接表的身份仅在运行时才知道）。

最新版本的 GNU`join`通过支持特殊格式消除了这个缺点`auto`。因此，使用`join`上面最后一个命令的这样一个版本，可以用更通用的命令代替

```
join -t, -a 1 -a 2 -e MISSING -o auto en.csv sp.csv 
```

如何使用`join`不支持该`-o auto`选项的版本实现相同的效果？

* * *

**背景和细节**

我有一个 Unix shell (zsh) 脚本，旨在处理多个 CSV 平面文件，并通过*广泛*使用 GNU`join`的 '-o auto' 选项来实现。我需要修改此脚本，以便它可以在可用`join`命令不支持该`-o auto`选项的环境中工作（例如 BSD`join`以及旧版本的 GNU的情况`join`）。

脚本中此选项的典型用法如下：

```
_reccut () {
    cols="1,$1"
    shift
    in=$1
    shift
    if (( $# > 0 )); then
        join -t, -a 1 -a 2 -e 'MISSING' -o auto \
          <( cut -d, -f $cols $in | sort -t, -k1 ) \
          <( _reccut "$@" )
    else
        cut -d, -f $cols $in | sort -t, -k1
    fi
} 
```

我展示这个例子是为了说明`-o auto`用显式格式替换是很困难的，因为要包含在这种格式中的字段直到运行时才知道。

上面的函数`_reccut`基本上是从文件中提取列，并沿着它们的第一列连接结果表。要查看`_reccut`实际效果，想象一下，除了上面提到的文件之外，我们还有文件

`de.csv`

```
2,Kaninchen,Grau,Zug
1,Hund,Rot,Auto 
```

然后，例如，要并排显示 的第 3`en.csv`列、第 2 列和第 4`sp.csv`列以及 de.csv 的第 3 列，可以运行：

```
% _reccut 3 en.csv 2,4 sp.csv 3 de.csv | cut -d, 2-
red,MISSING,MISSING,Rot
MISSING,conejo,tren,Grau
white,gato,bote,MISSING 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-28T12:02:15.070

这是一个可能适用于您的数据的解决方案，也可能不适用于您的数据。它通过按行号对齐 csv 文件中的记录来解决问题，即记录`2`在 line 上`2`，record `3123`on line number`3123`等等。缺少的记录/行用`MISSING`字段填充，因此输入文件将被修改为如下所示：

`en.csv`：

```
1,dog,red,car
2,MISSING,MISSING,MISSING
3,cat,white,boat 
```

`de.csv`：

```
1,Hund,Rot,Auto
2,Kaninchen,Grau,Zug
3,MISSING,MISSING,MISSING 
```

`sp.csv`：

```
1,MISSING,MISSING,MISSING
2,conejo,gris,tren
3,gato,blanco,bote 
```

从那里很容易剪下感兴趣的列，然后使用`paste`.

为此，我们*首先*对输入文件进行排序，然后应用一些愚蠢的`awk`魔法：

*   如果记录出现在他们预期的行号上，打印它
*   否则，打印包含预期数量的尽可能多的行（这基于文件中第一行的字段数，与`join -o auto`所做的相同）`MISSING`字段，直到对齐再次正确
*   并不是所有的输入文件都会有相同数量的记录，所以在所有这些之前搜索最大值。然后，`MISSING`打印更多带有字段的行，直到达到最大值。

# 代码

`reccut.sh`：

```
#!/bin/bash

get_max_recnum()
{
    awk -F, '{ if ($1 > max) { max = $1 } } END { print max }' "$@"
}

align_by_recnum()
{
    sort -t, -k1 "$1" \
        | awk -F, -v MAXREC="$2" '
            NR==1 { for(x = 1; x < NF; x++) missing = missing ",MISSING" }
            {
                i = NR
                if (NR < $1)
                {
                    while (i < $1)
                    {
                        print i++ missing
                    }
                    NR+=i
                }
            }1
            END { for(i++; i <= MAXREC; i++) { print i missing } }
            '
}

_reccut()
{
    local infiles=()
    local args=( $@ )
    for arg; do
        infiles+=( "$2" )
        shift 2
    done
    MAXREC="$(get_max_recnum "${infiles[@]}")" __reccut "${args[@]}"
}

__reccut()
{
    local cols="$1"
    local infile="$2"
    shift 2

    if (( $# > 0 )); then
        paste -d, \
            <(align_by_recnum "${infile}" "${MAXREC}" | cut -d, -f ${cols}) \
            <(__reccut "$@")
    else
        align_by_recnum "${infile}" "${MAXREC}" | cut -d, -f ${cols}
    fi
}

_reccut "$@" 
```

# 跑

```
$ ./reccut.sh 3 en.csv 2,4 sp.csv 3 de.csv
red,MISSING,MISSING,Rot
MISSING,conejo,tren,Grau
white,gato,bote,MISSING 
```

# objective-c - 修饰符标志：NSInteger 够用吗？

> ID：15179263
> 
> 赞同：1
> 
> 时间：2013-03-02T20:44:51.947
> 
> 标签：objective-c, xcode, cocoa

NSInteger 是否足以跟踪修饰符标志？（cmd / alt / ctrl 等）。

我注意到在一个事件上它返回一个 NSUinteger（无符号）（[theEvent modifierFlags]）而不是一个 NSInteger，但是从我的测试来看，当我将修饰符掩码保存在 NSInteger 中时，它似乎工作得很好。

我需要一个 NSInteger 因为我将修饰符掩码保存为某些控件的标记。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T21:18:54.243

NSInteger 和 NSUInteger 的大小相同（即相同的位数）。不同之处在于，在执行算术等操作时，这些位是否被认为代表有符号数或无符号数。如果您只是通过按位运算来操作数字，那并不重要。也就是说，您应该使用相关方法返回的相同类型，在本例中为 NSUInteger。在这里使用无符号的原因是，当所讨论的值实际上是一堆要独立设置/清除的位时，从概念上讲，该值具有符号位是没有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:28:35.223

正如安德鲁所说，我只想添加一些东西。如果您使用的是位标志，从您在 iOS 6 中的问题来看，他们引入了一个新宏，这似乎是新的“Apple 方式”

```
typedef NS_OPTIONS(NSInteger, CustomType) {
    kCmdKey = 1 << 0,
    kAltKey = 1 << 1,
    ctrlKey = 1 << 2,
}; 
```

还有一个宏 NS_ENUM，用于不用作位掩码的枚举。在 NS_OPTIONS 和 NS_ENUM 中，您都可以指定要使用的类型（NSInteger）和您的 typedef 类型名称。

# javascript - 如何在 firefox 扩展中使用“targetObj”参数来 loadSubScript()？

> ID：15179265
> 
> 赞同：1
> 
> 时间：2013-03-02T20:44:55.713
> 
> 标签：javascript, firefox, firefox-addon

从阅读示例来看，这似乎应该很容易。这是我的代码：

```
rhkTest = {
  onPageLoad: function(event) {
    var doc = event.originalTarget;
    var wnd = doc.defaultView;
    var loader = Components.classes["@mozilla.org/moz/jssubscript-loader;1"]
      .getService(Components.interfaces.mozIJSSubScriptLoader);
    loader.loadSubScript("chrome://rhkoshi-extension/content/testfoo.js", wnd);
    alert('typeof(wnd) = ' + typeof(wnd));
    alert('typeof(wnd.window.rhk_test1) = ' + typeof(wnd.window.rhk_test1));
    alert('typeof(wnd.window.rhk_test2) = ' + typeof(wnd.window.rhk_test2));
    alert('typeof(wnd.window.rhk_test3) = ' + typeof(wnd.window.rhk_test3));
    alert('typeof(wnd.rhk_test1) = ' + typeof(wnd.rhk_test1));
    alert('typeof(wnd.rhk_test2) = ' + typeof(wnd.rhk_test2));
    alert('typeof(wnd.rhk_test3) = ' + typeof(wnd.rhk_test3));
    alert('typeof(rhk_test1) = ' + typeof(rhk_test1));
    alert('typeof(rhk_test2) = ' + typeof(rhk_test2));
    alert('typeof(rhk_test3) = ' + typeof(rhk_test3));
    alert('typeof(this.rhk_test1) = ' + typeof(this.rhk_test1));
    alert('typeof(this.rhk_test2) = ' + typeof(this.rhk_test2));
    alert('typeof(this.rhk_test3) = ' + typeof(this.rhk_test3));
    alert('typeof(window.rhk_test1) = ' + typeof(window.rhk_test1));
    alert('typeof(window.rhk_test2) = ' + typeof(window.rhk_test2));
    alert('typeof(window.rhk_test3) = ' + typeof(window.rhk_test3));
  },
  onLoad: function(event) {
    var appcontent = document.getElementById("appcontent");
    if (appcontent) {
      appcontent.addEventListener("DOMContentLoaded", rhkTest.onPageLoad, true);
    }
  },
};  

window.addEventListener("load", function(e) { rhkTest.onLoad(e); }, false); 
```

其中 testfoo.js 包含：

```
window.rhk_test1 = 'testval1';
rhk_test2 = 'testval2';
var rhk_test3 = 'testval3';

window.alert('Running testfoo.js'); 
```

我收到警报“正在运行 testfoo.js”，因此找到并执行了该文件。我还收到一条警告，指出 wnd 是一个“对象”（正如预期的那样——它已在其他地方初始化）。但是，对于各种 typeof() 调用，所有其他警报都显示“未定义”。当然，我不希望*所有*这些都具有价值，但我希望其中至少有*一个*可以显示一些东西。

我的价值观怎么了？他们不应该在 wnd 的属性中吗？

我在 Windows 7 上运行 Firefox 19.0（如果重要的话）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-03T22:25:46.520

它实际上有点复杂，取决于是什么`wnd`。您可以使用常规对象作为下标的范围：

```
var myScope = this;
var subscriptScope = {};
loader.loadSubScript("testfoo.js", subscriptScope); 
```

但是，那时范围并没有完全隔离。这里有一些代码示例`testfoo.js`：

```
var foo = "bar;      // Creates subscriptScope.foo
xyz = 1;             // Creates myScope.xyz
function dummy() {}  // Creates subscriptScope.dummy
var outer = myScope; // Assigns a value from outer scope 
```

因此，虽然下标的变量和函数在其作用域中定义，但它仍然可以访问加载它的脚本的作用域——未声明的变量仍将在外部作用域中创建，并且将在外部作用域中搜索不能被在下标范围内解析。

如果您真的想隔离下标，那么您应该使用“适当的”全局对象，例如窗口对象或沙箱：

```
var myScope = this;
var subscriptScope = new Components.utils.Sandbox("about:blank");
loader.loadSubScript("testfoo.js", subscriptScope); 
```

现在`testfoo.js`将无法再访问外部范围：

```
var foo = "bar;      // Creates subscriptScope.foo
xyz = 1;             // Creates subscriptScope.xyz
function dummy() {}  // Creates subscriptScope.dummy
var outer = myScope; // Exception: myScope is not defined 
```

请注意，该变量没有什么特别之处`window`- 如果您希望下标具有该变量，则必须在范围对象中定义它，例如：

```
subscriptScope.window = subscriptScope; 
```

范围对象本身可以在下`this`标的顶层访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:47:24.427

注意：有关更一般的概述，请参阅 Wladimir Palant 的回答。

在我的示例中，我实际上是正确地使用了该函数，并且具有或多或少的合理期望。该问题是由 Firefox 的 XPCNativeWrapper 功能引起的。

我仍在努力理解细节，但简而言之，我的`wnd`对象被包装在 XPCNativeWrapper 中，并且`testfoo.js`被认为是“受保护”脚本，这意味着一旦控制权传回，我就看不到对对象所做的任何更改从`testfoo.js`.

解决方案是在将对象传递给下标之前（或之后——也可以）解开对象，如下所示：

```
var wnd = XPCNativeWrapper.unwrap(doc.defaultView); 
```

一旦我这样做，由 修改的变量/属性`testfoo.js`对父脚本可见。

我还不太了解完整的基础设施，无法知道这是否“安全”。毕竟，这是一种安全机制，旨在保护我的扩展免受浏览器页面上的恶意代码的影响。

我还看到将对象传递给由下标定义的方法时存在一些问题（在我的示例中未显示）。为此，我将提出一个单独的问题。

长话短说：展开是我的问题中提出的直接问题的（可能是“该”）解决方案，但似乎并不是解决我首先遇到的困难的完整解决方案。

# jquery - jQuery Ui 对话框不显示

> ID：15179267
> 
> 赞同：0
> 
> 时间：2013-03-02T20:45:07.387
> 
> 标签：jquery, dialog

我有一个 div 容器，在页面加载时最初是隐藏的。在那个 div 里面我有一个容器，里面有我的对话内容：

```
<div style="display:none;" id="dialog-container">
    content
</div> 
```

我遇到的问题是，当用户单击链接打开对话框时：

```
jQuery("#dialog-link").click(function() {

    //shows modal box

    jQuery( "#dialog-container" ).dialog({
        width:"820",
        resizable: false, 
        modal: true,
        buttons: {
            Ok: function() {
                jQuery( this ).dialog( "close" );
            }
        }
    });

});//close click 
```

覆盖显示，但对话框本身无处可见。我究竟做错了什么？div最初隐藏的事实与它有关吗？

谢谢。

**更新**

我找到了问题，但仍然没有解决方案。.ui-dialog 类的 'top' 属性太高了，因此对话框打开时远离屏幕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:47:32.783

确保显示要删除的对话框容器`display:none`

```
jQuery("#dialog-link").click(function() {

//shows modal box

  jQuery( "#dialog-container" ).dialog({
     width:"820",
     resizable: false, 
     modal: true,
     buttons: {
        Ok: function() {
          jQuery( this ).dialog( "close" );
        }
     }
   });

   jQuery( "#dialog-container" ).show(); //make visible
}); 
```

工作示例：http: [//jsfiddle.net/](http://jsfiddle.net/)

# iphone - UI 按钮网格视图 - 单元格之间的间距 (UIButtons)

> ID：15179270
> 
> 赞同：0
> 
> 时间：2013-03-02T20:45:21.993
> 
> 标签：iphone, xcode, uibutton, grid, spacing

![截图 1](../Images/506891349079e4f0e4724d78386694b4.png) ![截图 2](../Images/a63a2e42d761fd2c549ba7567eb104c6.png) ![截图 3](../Images/b2142bb1569cad49621e9ddda0bb40de.png)

我想知道如何设置网格中 UI 按钮之间的间距大小。目前我知道如何更改按钮的大小，但这会改变网格的整体大小而不仅仅是按钮。包括目前应用程序的一些屏幕截图（忽略 UI 按钮边框）。代码如下：

```
- (void)setupBoard:(GameBoard *)board;
{
NSUInteger rows = [[currentGame mainBoard] rows];
NSUInteger cols = [[currentGame mainBoard] columns];
CGSize cellSize = { gridView.frame.size.width/ cols, gridView.frame.size.height/ rows          };
CGPoint insertPoint = CGPointZero;

for (int x = 0; x <= rows; x++) {
    for (int y = 0; y <= cols; y++) {
        UIButton *newButton = [UIButton buttonWithType:UIButtonTypeCustom];
        CGRect newButtonFrame = { insertPoint, cellSize };
        [newButton associateValue:[NSNumber numberWithInt:x] withKey:@"xrow"];
        [newButton associateValue:[NSNumber numberWithInt:y] withKey:@"ycol"];
        [newButton setFrame:newButtonFrame];
        [newButton setSelected:NO];
        [newButton setBackgroundColor:[UIColor colorWithRed:(164.0/255.0)   green:(240.0/255.0) blue:(254.0/255.0) alpha:1.0]];
        [[newButton layer] setCornerRadius:5.0f];
        [[newButton layer] setBorderColor:[[UIColor colorWithRed:(0.0/255.0) green:(0.0/255.0) blue:(0.0/255.0) alpha:0.5] CGColor]];
        [[newButton layer] setBorderWidth:5.0f];
        [newButton addTarget:self action:@selector(toggleCellState:) forControlEvents:UIControlEventTouchUpInside];
        [gridView addSubview:newButton];
        [newButton setAlpha:0.10];
        insertPoint.x += cellSize.width;
    }
    insertPoint.x   = 0;
    insertPoint.y += cellSize.height;
} 
```

}

如果您想查看更多代码，请不要犹豫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T09:26:58.870

您可以使用以下代码在按钮的每一侧插入 3 的填充。这涉及将像元大小减少 6。

```
 CGFloat padding = 3;
    cellSize.width -= 2*padding; //new code
    cellSize.height -= 2*padding; //new code

    for (int x = 0; x <= rows; x++) {
        insertPoint.y += padding; //new code

        for (int y = 0; y <= cols; y++) {
            insertPoint.x += padding; //new code

            UIButton *newButton = [UIButton buttonWithType:UIButtonTypeCustom];
            CGRect newButtonFrame = { insertPoint, cellSize };
            [newButton associateValue:[NSNumber numberWithInt:x] withKey:@"xrow"];
            [newButton associateValue:[NSNumber numberWithInt:y] withKey:@"ycol"];
            [newButton setFrame:newButtonFrame];
            [newButton setSelected:NO];
            [newButton setBackgroundColor:[UIColor redColor]];
            [[newButton layer] setCornerRadius:5.0f];
            [[newButton layer] setBorderColor:[[UIColor blueColor] CGColor]];
            [[newButton layer] setBorderWidth:5.0f];
            [newButton addTarget:self action:@selector(toggleCellState:) forControlEvents:UIControlEventTouchUpInside];
            [gridView addSubview:newButton];
            [newButton setAlpha:0.10];

            insertPoint.x +=  padding+cellSize.width; //updated code
        }
        insertPoint.x   = 0;

        insertPoint.y +=  padding+cellSize.height; //updated code
   } 
```

# ios6 - 点击后 iAd 自动布局问题

> ID：15179278
> 
> 赞同：1
> 
> 时间：2013-03-02T20:47:23.093
> 
> 标签：ios6, iad, autolayout

当我**点击**“测试广告商”iAd 横幅时，我遇到了一些布局问题：

![广告点击](../Images/207a080ed1bf5d9692d5543134136422.png)

![点击后查看](../Images/0aa8876020a0a1e19caa8381531244e4.png)

我不明白，因为在我点击横幅之前，**一切都很好地展示了。**

![点击前查看](../Images/f6f8b1df0b35e0b8746d3dd550702b78.png)

**我正在使用自动布局。**

这是我的视图层次结构 UIView | 内容视图 |导航栏 |表格视图 |横幅视图

我保留了 contentView 底部约束和bannerView 底部约束的参考

这是我的代码：

```
- (id)init
{
    self = [super init];
    if (self)
    {
        _eventsController = [[EventsController alloc]init];
        if ([[NSUserDefaults standardUserDefaults] boolForKey:@"showADs"])
        {
            NSLog(@"Show ADs");
            _bannerView = [[ADBannerView alloc] initWithAdType:ADAdTypeBanner];
            [self.bannerView setDelegate:self];
        }
    }
    return self;
} 
```

**ViewDidAppear**

```
- (void)viewDidAppear:(BOOL)animated
    {
    [super viewDidAppear:animated];

    NSLog(@"viewDidAppear");
    if ([[NSUserDefaults standardUserDefaults] boolForKey:@"showADs"])
    {
        [self.view addSubview:self.bannerView];
        [self.bannerView setTranslatesAutoresizingMaskIntoConstraints:NO];

        [self.view addConstraint:[NSLayoutConstraint constraintWithItem:self.bannerView
                                                             attribute:NSLayoutAttributeLeading
                                                             relatedBy:NSLayoutRelationEqual
                                                                toItem:self.contentView
                                                             attribute:NSLayoutAttributeLeading
                                                             multiplier:1.0 constant:0]];

        self.bannerviewBottomConstraint = [NSLayoutConstraint constraintWithItem:self.bannerView
                                     attribute:NSLayoutAttributeBottom
                                     relatedBy:NSLayoutRelationEqual
                                        toItem:self.contentView
                                     attribute:NSLayoutAttributeBottom
                                    multiplier:1.0 constant:50];
        [self.view addConstraint:self.bannerviewBottomConstraint];
        [self.view setNeedsUpdateConstraints];
        [self.view setNeedsLayout];
    }
} 
```

**AdBannerViewDelegate**

```
#pragma mark - ADBannerView Delegate
- (void)updateLayoutForAD
{
    if (self.bannerView.bannerLoaded)
    {
        self.contentViewBottomConstraint.constant = -50.0;
        self.bannerviewBottomConstraint.constant = 0;
    }
    else
    {
        self.contentViewBottomConstraint.constant = 0;
        self.bannerviewBottomConstraint.constant = 50;
    }

    [self.view setNeedsUpdateConstraints];
    [UIView animateWithDuration:0.25 animations:^{
        [self.view layoutIfNeeded];
    }];
}

- (void)bannerViewDidLoadAd:(ADBannerView *)banner
{
    NSLog(@"GOT AD");    
    [self updateLayoutForAD];
}

- (void)bannerView:(ADBannerView *)banner didFailToReceiveAdWithError:(NSError *)error
{
    NSLog(@"DIDN'T GOT AD");
    [self updateLayoutForAD];
} 
```

# java - 将字符串与 JSON 字符串属性进行比较

> ID：15179281
> 
> 赞同：0
> 
> 时间：2013-03-02T20:47:40.733
> 
> 标签：java, json, string

我有一个 JSON 字符串作为-

```
[{"lv":[{"v":{"nt":"10;1341943000000","userId":622},"cn":0},
{"v":{"nt":"20;1234567890123","userId":622},"cn":0},
] 
```

在这个 JSON 字符串中，我将拥有`userId`每个值的属性。在单个 JSON 字符串中，我可能有 10 个 userId 属性或 15 个 userId 属性。并且`userId`总会有一些数字。

每个 JSON 字符串在`userId`. 如果您看到上面的 JSON 字符串，我将`622`每个`userId`.

现在我试图在 JSON 字符串中进行`id`比较。`userId`我`id`从其他方式获得价值，比如这样-

```
final int id = generateRandomId(random); 
```

所以`id`值应该与`userId`单个 JSON 字符串中的所有属性匹配。

我将所有 JSON 字符串存储在`colData` `List<String>`. 目前我正在尝试使用类的方法进行匹配`id`，`userId`我`contains`认为`String`这是不正确的，因为一旦找到一个匹配项，那么条件就会变为真（这是错误的）。

可能`Single JSON String` `20 userId properties`存在并且`19 userId values`匹配`id`但一个`userId`属性值不同。所以这个用例在我下面的代码中会失败。那么我怎样才能实现这个问题定义

```
for (String str : colData) {

   if (!str.contains(String.valueOf(id))) {

// log the exception here
handleException(ReadConstants.ID_MISMATCH, Read.flagTerminate);

   }
} 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:03:22.117

一种方法是使用 Matcher

```
public class Uid {
    private static final Pattern USER_ID_PATTERN = Pattern.compile("userId\":\\d+");
    private static final String GENERATED_USER_ID = "userId\":622";
    public static void main(String[] args) {

        List<String> jsonData = new ArrayList<String>();
        jsonData.add("[{\"lv\":[{\"v\":{\"nt\":\"10;1341943000000\",\"userId\":621},\"cn\":0},{\"v\":{\"nt\":\"20;1234567890123\",\"userId\":622},\"cn\":0},]"); // this string contains multiple uids

        for (String s : jsonData) {
            Matcher matcher = USER_ID_PATTERN.matcher(s);
            while (matcher.find()) {
                String currentUid = matcher.group();
                 if (!currentUid.equals(GENERATED_USER_ID))
                    System.out.println("LOG exception, " + currentUid + " doesn't exists");

            }
        }
    }
} 
```

# php - DOMDocument 和 DOMXPath 错误

> ID：15179286
> 
> 赞同：0
> 
> 时间：2013-03-02T20:47:54.290
> 
> 标签：php, map, domdocument, domxpath

我想使用 DOMDocument 映射我所有的区域形状标签，但我的代码只适用于 DIV，而不适用于地图标签。为什么？这是我的代码。我得到的问题是返回空字符串。

代码：

```
$DOM = new DOMDocument; 
$DOM->loadHTML($conteudo['ambiente']->mapeamento);
$xpath = new DOMXPath($DOM);
$tags = $xpath->query('//area');
foreach ($tags as $tag) {
    var_dump(trim($tag->nodeValue));
} 
```

示例代码：

```
<map name="Map" id="Map">
  <area shape="poly" coords="0,916,86,880,527,854,520,819,536,818,547,818,564,819,563,855,627,851,620,813,640,810,653,810,664,813,660,847,804,837,816,820,766,823,756,821,752,815,743,414,755,407,782,406,1282,430,1286,432,1279,775,1290,775,1306,775,1311,777,1305,804,1337,801,1335,775,1341,772,1353,772,1370,774,1370,797,1711,793,1792,802,1789,365,1795,360,1804,0,-1,0,0,916,1,915,1144,804" href="#" />
  <area shape="poly" coords="1143,803,1271,792,1274,808,1151,816,1143,812,1142,803" href="#" />
  <area shape="poly" coords="1800,-1,2052,-1,2054,1033,1907,1003,1909,973,2024,967,2016,315,1866,328,1794,360,1803,2" href="#" />
  <area shape="poly" coords="1899,975,1894,1002,1876,998,1879,974,1901,974" href="#" />
</map> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:52:20.280

您的`<area>`标签没有内容，因此输出是正确的。如果要获取`coords`属性的值，则应使用

```
$tags = $xpath->query('//area/@coords'); 
```

# cocoa - 带有圆角的自定义 NSWindow 可以剪切子视图

> ID：15179288
> 
> 赞同：8
> 
> 时间：2013-03-02T20:48:03.300
> 
> 标签：cocoa, calayer, nswindow

我正在尝试创建一个 custom `NSWindow`，所以我创建了一个具有适当的无边框窗口掩码并且可以正常工作。我提供了我自己的内容视图，这很好。但我想做的是用圆角绘制，**也可以**将子视图剪辑到这些角。这可能吗？

在我的内容视图中，我可以覆盖`drawRect:`并绘制圆角路径，但是当我向其中添加子视图时，它们不会被剪裁。

我可以改为让我的内容视图层支持并给它一个角半径（`masksToBounds`设置为`YES`）但是当我添加子视图时，它们仍然没有被我的圆角剪裁。

有没有办法做到这一点？或者以某种方式绘制没有标题栏的 NSWindow 并且我可以完全控制绘图，同时保持圆角的剪裁角？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-02T21:51:42.710

我能够做的是提供我的 NSWindow 的自定义子类：

```
@implementation ELGRoundWindow

- (id)initWithContentRect:(NSRect)contentRect styleMask:(NSUInteger)aStyle backing:(NSBackingStoreType)bufferingType defer:(BOOL)flag
{
    self = [super initWithContentRect:contentRect styleMask:NSBorderlessWindowMask backing:bufferingType defer:flag];

    if ( self )
    {
        [self setStyleMask:NSBorderlessWindowMask];
        [self setOpaque:NO];
        [self setBackgroundColor:[NSColor clearColor]];
    }

    return self;
}

- (void) setContentView:(NSView *)aView
{
    aView.wantsLayer            = YES;
    aView.layer.frame           = aView.frame;
    aView.layer.cornerRadius    = 20.0;
    aView.layer.masksToBounds   = YES;

    [super setContentView:aView];

}

@end 
```

然后在 IB 中，我将内容视图的类更改为 ELGRoundView：

```
@implementation ELGRoundView

- (void)drawRect:(NSRect)dirtyRect
{
    [[NSColor colorWithCalibratedRed:0.0 green:0.5 blue:1 alpha:1] set];
    NSRectFill(dirtyRect);
}

@end 
```

我在内容视图中放置了另一个方形子视图，其中包含以下内容：

```
@implementation ELGSquareView

- (void)drawRect:(NSRect)dirtyRect
{
    [[NSColor colorWithCalibratedRed:0.0 green:0 blue:1 alpha:1] set];
    NSRectFill(dirtyRect);
}

@end 
```

我最终得到：

![带有剪裁子视图的圆角窗口](../Images/a8da809a0bbe340d03383eb8a8de1330.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-21T06:44:41.860

@ericgorr 的建议是正确的。此外，如果您希望窗口可移动且可调整大小，请按如下方式更改 NSWindow 的 init，

```
- (id)initWithContentRect:(NSRect)contentRect
                 styleMask:(NSUInteger)aStyle
                   backing:(NSBackingStoreType)bufferingType
                     defer:(BOOL)flag
{
    self = [super initWithContentRect:contentRect
                            styleMask:aStyle
                              backing:bufferingType
                                defer:flag];
    if (self) {            
        [self setOpaque:NO];
        [self setBackgroundColor:[NSColor clearColor]];
        [self setMovableByWindowBackground:YES];
        [self setStyleMask:NSResizableWindowMask];
    }
    return self;
} 
```

如需进一步定制，请参阅[Apple 示例代码](http://developer.apple.com/library/mac/#samplecode/RoundTransparentWindow/Introduction/Intro.html) [http://developer.apple.com/library/mac/#samplecode/RoundTransparentWindow/Introduction/Intro.html](http://developer.apple.com/library/mac/#samplecode/RoundTransparentWindow/Introduction/Intro.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-25T17:11:36.443

子类化是最灵活的方式。如果您不想子类化，请使用此代码。

```
// unfortunately the window can't be moved
// but this is just an alert type window, so i don't care
//
[window setOpaque:NO];
[window setBackgroundColor:[NSColor clearColor]];

NSView*  contentView = window.contentView;

contentView.wantsLayer = YES;
contentView.layer.backgroundColor = [NSColor windowBackgroundColor].CGColor;
contentView.layer.masksToBounds = YES;
contentView.layer.cornerRadius = 16.0;

[window makeKeyAndOrderFront:self];
[window center]; 
```

# ruby-on-rails - 在rails（或ruby的其他地方）中是否可以防止块返回？返回数组中的 50,000 条记录需要一段时间

> ID：15179291
> 
> 赞同：1
> 
> 时间：2013-03-02T20:48:14.510
> 
> 标签：ruby-on-rails, ruby, activerecord, return, block

因此，我在表中的所有 50,000 多条记录中运行了一些逻辑（实际上有几条，但我们在这里只讨论一条它们都是相同的操作）并标记布尔指标：

```
ActiveRecord::Base.silence do
  CoreRevenue.where('core_revenues_usd IS NOT NULL').each do |c|
    c.ok = true
    c.save
  end
end 
```

您可能已经注意到，我已经“关闭”了数据库，不再向控制台输出一堆 SQL 响应，但是在操作结束时总会出现大数组转储，有时可能需要长达 5-10秒。

所以我想知道我是否可以在操作完成后停止从`x`哪里倾倒。`x = CoreRevenue.where('core_revenues_usd IS NOT NULL')`谢谢。

同样“令人兴奋”的答案将解释为什么这是不可能的，因为某种 lambda 演算计算或者你有什么

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T20:52:55.327

您不能阻止块返回，但您可以只返回其他内容：

```
ActiveRecord::Base.silence do
  CoreRevenue.where('core_revenues_usd IS NOT NULL').each do |c|
    c.ok = true
    c.save
  end

  nil
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T20:54:10.100

我会这样写：

```
CoreRevenue.where('core_revenues_usd IS NOT NULL').update_all(:ok, true) 
```

所以它会比你的版本运行得快得多。

**编辑：**用@John Neagle 建议更正

# javascript - 如何将数据从按钮传递到 coffeescript 函数？

> ID：15179293
> 
> 赞同：0
> 
> 时间：2013-03-02T20:48:35.627
> 
> 标签：javascript, jquery, coffeescript

我是 Web 开发的新手，并且有以下基本问题。

我的 HTML 看起来像这样：

```
<a class="btn-select" data-myId="10091" data-myDescr="The thing we delete">Click me!</a> 
```

我的咖啡脚本如下所示：

```
$(document).on 'click', '.btn-select', ->
requestId = $(this).data('myId');
alert 'hello ' + requestId; 
```

但是当我点击按钮时，我得到“你好未定义”。我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:53:46.907

规范要求 HTML5 数据属性为小写。

采用：`$(this).data('myid')`

[http://jsfiddle.net/6RW79/](http://jsfiddle.net/6RW79/)

# r - 返回与 R 中指定的 Ascii 代码关联的字符

> ID：15179295
> 
> 赞同：17
> 
> 时间：2013-03-02T20:48:45.570
> 
> 标签：r, character, ascii

下午好，

我正在尝试使用字母表在 R 中创建笛卡尔积。

我实际上正在尝试的是：

首先我用字母创建一个矩阵

```
a <- as.matrix(seq(97,122,by=1)) 
```

然后我创建一个包含所有组合的 2 列数据框

```
b <- expand.grid(a, a) 
```

最后我结合了 2 列

```
apply(b,1,paste,collapse=" ") 
```

我遇到的问题是我找不到将这些“小数”转换为其 Ascii 字符的方法。

我已经尝试了一些类似 rawToChar 和 gsub 的方法，但都没有成功。

有人可以指出我正确的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2014-01-23T14:06:58.463

根据 ASCII 码返回字符的一种非常简单的方法是函数`intToUtf8`。它也适用于包含多个整数的向量，并将相应的字符作为一个字符串返回。

```
vec <- 97:122
intToUtf8(vec)
# [1] "abcdefghijklmnopqrstuvwxyz"

intToUtf8(65)
# [1] "A" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-02T21:04:20.887

第一种直接法：

```
res <- do.call(paste, expand.grid(letters, letters)) 
```

如果您有其他一些 ascii 值并且想要获得等效字符：

```
val <- 65:96 # whatever values you want the equivalent characters for
mode(val) <- "raw" # set mode to raw
# alternatively, val <- as.raw(65:96)
a   <- sapply(val, rawToChar)
res <- do.call(paste, expand.grid(a, a)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T20:55:14.227

要在 R 中打印 ASCII 字符，您可以在 ASCII 码前使用`print`带有反斜杠的函数。`\`例如要打印相当于 150 的字符，请使用`print("\150")`.

或者对于上面的示例，您可以尝试：

```
a <- sapply(97:122,function(x) rawToChar(as.raw(x)))

b <- expand.grid(a,a)

c <- t(apply(b,1,function(x) paste(x[1],x[2]))) 
```

# python - 创建具有多对多关系的对象

> ID：15179297
> 
> 赞同：1
> 
> 时间：2013-03-02T20:49:35.023
> 
> 标签：python, web-applications, sqlalchemy, flask-sqlalchemy

如何使用属于**组的成员列表初始化组对象（并且用户必须知道他们所属的组）**？

用户有很多组。组有很多用户。

我还尝试了`add_to_group`User 类中的一个方法，但这并没有真正奏效。

这是我第一次处理多对多关系，所以我还没有弄清楚如何去做，所有的 SO 帖子都指查询多对多关系而不是创建使用它们的对象。

```
class User(db.Model):
    __tablename__ = 'User'
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(80), unique = False, nullable = False)
    username = db.Column(db.String(80), unique = True, nullable = False)
    fb_id = db.Column(db.String(80), unique = True, nullable = False)
    groups = db.relationship('Groups', secondary=groups, backref=db.backref('User', lazy='dynamic'))

groups = db.Table('groups',
    db.Column('group_id', db.Integer, db.ForeignKey('Group.id')),
    db.Column('user_id', db.Integer, db.ForeignKey('User.id'))
)

class Group(db.Model):
    __tablename__ = 'Group'
    id = db.Column(db.Integer, primary_key=True)
    last_updated = db.Column(db.DateTime, mutable=True)

    def __init__(self):
        self.last_updated = datetime.utcnow(); 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T21:51:41.097

在 SQLAlchemy 中，多对多关系被建模为属性，其值为列表。

```
u = User()
g = [Group(), Group(), Group()]

u.groups = g 
```

您还可以就地更改列表：

```
g1 = Group()
u.groups.append(g) 
```

关系的另一端将以相同的方式工作：

```
g.users.append(User()) 
```

当您更改多对多关系的一侧时，SQLAlchemy 会使另一侧保持最新状态——换句话说，如果您`User`从 a`Group`的`users`列表中删除 a，那么`Group`它将不再出现在该列表`User`中`groups`.

# javafx-2 - Java FX 中所有场景的通用菜单项

> ID：15179299
> 
> 赞同：3
> 
> 时间：2013-03-02T20:49:52.303
> 
> 标签：javafx-2

我想开发一个多场景 Java FX 应用程序。但我希望在所有场景中都有通用菜单。我认为使用 FXML 可以在场景中创建菜单。但是即使在我导航到其他屏幕后，我是否可以在所有场景中使用相同的菜单？

如果是这样是怎样的。否则让我知道任何替代方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-03T09:36:26.750

是的，这是可能的。我在自己的应用程序中使用了这种机制。

我首先要做的是使用菜单栏和包含内容的 AnchorPane 制作 FXML。此 FXML 在应用程序启动时加载。

我使用一个 Context 类（基于 Sergey 在这个问题中的回答：[Multiple FXML with Controllers, share object](https://stackoverflow.com/questions/12166786/multiple-fxml-with-controllers-share-object)），它包含一个方法 ShowContentPane(String url) 方法：

```
public void showContentPane(String sURL){
    try {
        getContentPane().getChildren().clear();
        URL url = getClass().getResource(sURL);

        //this method returns the AnchorPane pContent
        AnchorPane n = (AnchorPane) FXMLLoader.load(url, ResourceBundle.getBundle("src.bundles.bundle", getLocale()));
        AnchorPane.setTopAnchor(n, 0.0);
        AnchorPane.setBottomAnchor(n, 0.0);
        AnchorPane.setLeftAnchor(n, 0.0);
        AnchorPane.setRightAnchor(n, 0.0);

        getContentPane().getChildren().add(n);

    } catch (Exception ex) {
        System.out.println(ex.getMessage());
    }
} 
```

所以基本上发生的是：

程序启动时，在 Context 中设置内容窗格：

```
@Override
public void initialize(URL url, ResourceBundle rb) {
    Context.getInstance().setContentPane(pContent); //pContent is the name of the AnchorPane containing the content
    ...
} 
```

选择按钮或菜单项后，我将 FXML 加载到内容窗格中：

```
@FXML
private void handle_FarmerListButton(ActionEvent event) {
    Context.getInstance().showContentPane("/GUI/user/ListUser.fxml");
} 
```

希望这可以帮助 ：）

# php - SPLObjecStorage 中的 Detach() 和 offsetUnset() 区别

> ID：15179304
> 
> 赞同：0
> 
> 时间：2013-03-02T20:50:27.497
> 
> 标签：php, spl

SPLObjecStorage 中的 Detach() 和 offsetUnset() 之间有什么区别。看起来他们做同样的事情。如果是这样，为什么同一工作有两种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:10:24.383

绝对没有区别，一个[是另一个的别名](http://www.php.net/manual/en/splobjectstorage.offsetunset.php)：

> 笔记：
> 
> SplObjectStorage::offsetUnset() 是 SplObjectStorage::detach() 的别名。

# java - 需要像流一样连续打印到 JTextArea 而不是一大块

> ID：15179306
> 
> 赞同：0
> 
> 时间：2013-03-02T20:50:35.450
> 
> 标签：java, swing, jtextarea

我正在调用一个递归方法，它每次都继续打印一个字符串。该方法有 textArea.append(String) 和 system.out.print(string)。system.outs 会按应有的方式打印（如字符串流）。但是 JTextArea 只打印一次

# php - 致命错误：调用未定义的函数 session_register()

> ID：15179308
> 
> 赞同：0
> 
> 时间：2013-03-02T20:50:40.703
> 
> 标签：php

我是 php 新手，想知道是否有人可以帮助我调试，出现以下错误。致命错误：调用未定义的函数 session_register()

它发生在我让用户登录时。

PHP

```
<?php
include("config.php");
session_start();
if($_SERVER["REQUEST_METHOD"] == "POST")
{
// username and password sent from Form 
$myusername=addslashes($_POST['username']); 
$mypassword=addslashes($_POST['password']); 

$sql="SELECT id FROM admin WHERE username='$myusername' and passcode='$mypassword'";
$result=mysql_query($sql);
$row=mysql_fetch_array($result);
$active=$row['active'];
$count=mysql_num_rows($result);

// If result matched $myusername and $mypassword, table row must be 1 row
if($count==1)
{
session_register("myusername");
$_SESSION['login_user']=$myusername;

header("location: welcome.php");
}
else 
{
$error="Your Login Name or Password is invalid";
}
}
?> 
```

它在第 16 行抛出的错误是

```
$active=$row['active']; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T20:54:32.003

如果您查看 php 手册，您会看到它已被[弃用](http://php.net/manual/en/function.session-register.php)

你如何使用`$_SESSION`变量？

```
$_SESSION["myusername"] = $username; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T20:54:55.710

首先你只`select id`来自数据库，所以没有`$row['active']`. 更改`$row['active']`为`$row[0]['id']`。

并且不要使用`session_register("myusername");`使用`$_SESSION['myusername']=="something"`

您可以将查询更改为`select id,username ...`然后设置`$_SESSION['myusername']=$row[0]['username'];`

当然这种方法不好，但是对于初学者来说应该这样做；

# html - 为打印和屏幕应用样式表

> ID：15179311
> 
> 赞同：2
> 
> 时间：2013-03-02T20:50:46.380
> 
> 标签：html, css, media-queries

如何为打印和屏幕设置 CSS 文件？

我试图在标签上设置两个值（比如类属性），但它不起作用：

```
<link href="style.css" rel="stylesheet" media="screen print"> 
```

这个问题也适用于正文中的 CSS。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T20:51:28.207

你需要一个逗号：

```
<link href="style.css" rel="stylesheet" media="screen, print"> 
```

> 这个问题也适用于正文中的 CSS。

如果您指的是`style`属性，则无法这样做，因为您无法将媒体查询嵌入到内联样式中。

# haskell - 消除 cabal 文件中的重复

> ID：15179316
> 
> 赞同：27
> 
> 时间：2013-03-02T20:51:31.573
> 
> 标签：haskell, cabal

我的`.cabal`文件的许多节中经常有类似的属性。例如

```
Library x
    ...
    ghc-options:
       -O2 -Wall -fno-warn-missing-signatures -fwarn-incomplete-patterns
       -fno-warn-name-shadowing

Executable y
    ...
    ghc-options:
       -O2 -Wall -fno-warn-missing-signatures -fwarn-incomplete-patterns
       -fno-warn-name-shadowing 
```

使它们保持一致既乏味又容易出错。有没有更好的办法？

更棘手的是当字段相似但不完全相同时，例如当我有几个可执行文件具有共同的构建依赖关系但变化很小时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T10:47:37.563

我认为这`cabal`不提供该功能。前段时间我也想过这个问题。您可以[在 Johan Tibell 的博客上看到我的评论以及 Johan 的回答](http://blog.johantibell.com/2012/04/cabal-bench.html?showComment=1351087383653#c3552556086157441246)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-04T01:42:42.593

我编写了一个工具，可以更轻松地在 Haskell 中指定 Cabal 文件，这有助于处理这个问题和其他一些问题。

[https://hackage.haskell.org/package/cartel](https://hackage.haskell.org/package/cartel)

# ruby-on-rails - 名字和姓氏正则表达式测试失败

> ID：15179321
> 
> 赞同：0
> 
> 时间：2013-03-02T20:52:29.873
> 
> 标签：ruby-on-rails, regex, unit-testing

我在 Rails 的单元测试中遇到了一个非常奇怪的错误。我有以下测试由于某种原因失败：

```
should_not allow_value('@!>::<>').for(:first_name) 
```

以及我的模型中的以下验证：

```
validates_format_of :first_name, :last_name, with: (/[\w]*/), allow_blank: true 
```

关于为什么测试失败的任何想法？

**PS：**`*`当我将正则表达式中的a更改为时，错误似乎消失`+`了……但是为什么！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:09:05.990

正则表达式`/[\w]*/`匹配输入中的**零**个或多个单词字符。由于您的测试字符串中没有单词字符，因此它很乐意验证它。`/[\w]+/`至少需要一个单词字符才能匹配，这就是它适用于您的测试字符串的原因。

我认为您应该使用`/^[\w]*$/`来指定从字符串的开头到结尾，您只需要单词字符（特殊字符`^`并`$`分别在正则表达式中匹配输入的开头和结尾）。请注意，这允许空白输入。

# jenkins - 使用 Jenkins 执行 HTML 测试套件

> ID：15179323
> 
> 赞同：0
> 
> 时间：2013-03-02T20:52:45.383
> 
> 标签：jenkins

我用 Selenium IDE 记录了一些简单的 selenium 测试。现在我想在 Jenkins 中运行这些测试。我需要 Jenkins 的哪个插件来做到这一点？以及如何逐步运行测试？我的测试套件是 HTML 格式的。

你能提供详细的步骤吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:59:05.790

为什么通过詹金斯从 Maven 运行硒测试还不够？这就是我们让它发挥作用的方式。如果您的 jenkins 在 unix 环境中运行，您应该记住需要对系统进行额外配置。

# objective-c - 应用程序启动时加载图像 - Objective-c

> ID：15179326
> 
> 赞同：-2
> 
> 时间：2013-03-02T20:52:50.293
> 
> 标签：objective-c, cocoa-touch

我将这样的图像设置为我的视图：

```
self.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"map3.jpg"]]; 
```

现在我有一个按钮操作方法。但是如何在应用程序启动时直接设置它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:55:46.623

如果您想设置`backgroundColor`a`UIViewController`的视图，请将您的代码移入`viewDidLoad`并同样调整：

```
self.view.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"map3.jpg"]]; 
```

A`UIViewController`没有`backgroundColor`直接的 a，但它的视图有，就像任何其他`UIView`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:54:57.067

一种方法是将该逻辑放在视图控制器的 UIImageView 属性的 -viewDidLoad 方法中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T22:00:50.257

界面视图

如果您在`UIView`课堂上，请将代码放在`initWithFrame:`或`initWithCoder:`

`initWithFrame`当您从代码实例化视图时`UIView *myView = [[UIView alloc] initWithFrame:CGRectZero];` `initWithCoder:`调用（例如，每当从 XIB 文件加载 UIView 时调用。

[http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)

UIViewController

如果在`UIViewController`一个共同的地方放置它会在`viewDidLoad`

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)

# java - java泛型如何在构造函数中使用泛型

> ID：15179337
> 
> 赞同：0
> 
> 时间：2013-03-02T20:53:53.930
> 
> 标签：java, android

```
public class DbManager<T extends Dao> {

    public DbManager(Context c) {
        setCreateDatabaseScript(T);
    }

    public void setCreateDatabaseScript(T dao) {
        this.createDatabaseScript = ((Dao)dao).createTable();
    }

    //..
} 
```

我如何在构造函数内部调用 setCreateDatabaseScript。我尝试像示例但不工作。什么是正确的语法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:59:11.313

`setCreateDatabaseScript(T dao)`需要实例，`T`所以你可能应该在构造函数中传递它

```
public DbManager(Context c, T dao) {
    setCreateDatabaseScript(dao);
} 
```

另外，由于`T extends Dao`您不需要将其转换为 Dao，因此只需使用`dao.createTable();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:57:52.210

```
public DbManager(Context c) {
    setCreateDatabaseScript(T);
} 
```

您必须使用 T 类型的对象作为参数调用 setCreateDatabaseScript，而不仅仅是使用 T。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:59:31.133

对象 T 在构造函数中使用时从未被声明或实例化。

# php - PHP排序/排序一维数组键或任何排序顺序

> ID：15179340
> 
> 赞同：0
> 
> 时间：2013-03-02T20:54:24.570
> 
> 标签：php, arrays, sorting

考虑以下列表：

```
$list = array(
        0 => A, 
        1 => X, 
        2 => B, 
        3 => Z, 
        4 => K, 
        5 => M
        ); 
```

我想将 A 的位置从 0 更改为 2 然后 $list 变为：

```
$list = array(
        0 => X, 
        1 => B, 
        2 => A, 
        3 => Z, 
        4 => K, 
        5 => M
        ); 
```

### 以下代码是我迄今为止尝试过的，还有其他使用数组函数的方法吗？或任何更短的方式？

```
<?php
  $list = array(0 => 'A', 1 => 'X', 2 => 'B', 3 => 'Z', 4 => 'K', 5 => 'M');
  function change_position($oldposition, $newposition, $list){
    echo "Changing $oldposition to $newposition :\n";
    foreach($list as $k => $v){
         if($oldposition < $newposition){
            if( $k < $oldposition ){
              $newlist[$k] = $list[$k];
            }
            if($k >= $oldposition && $k < $newposition){
              $newlist[$k] = $list[$k+1];
            }
            if($k == $newposition){
             $newlist[$k] = $list[$oldposition];
            }
            if($k > $newposition){
             $newlist[$k] = $list[$k];
            }
         }
         if($oldposition > $newposition){
            if( $k > $oldposition ){
              $newlist[$k] = $list[$k];
            }
            if($k <= $oldposition && $k > $newposition){
              $newlist[$k] = $list[$k-1];
            }
            if($k == $newposition){
             $newlist[$k] = $list[$oldposition];
            }
            if($k < $newposition){
             $newlist[$k] = $list[$k];
            }
         }
   }
   return $newlist;
}
echo '<pre>';
print_r($list);
print_r(change_position(5, 0, $list));
print_r(change_position(0, 5, $list));
?> 
```

输出：

```
Array
(
    [0] => A
    [1] => X
    [2] => B
    [3] => Z
    [4] => K
    [5] => M
)
Changing 5 to 0 :
Array
(
    [0] => M
    [1] => A
    [2] => X
    [3] => B
    [4] => Z
    [5] => K
)
Changing 0 to 5 :
Array
(
    [0] => X
    [1] => B
    [2] => Z
    [3] => K
    [4] => M
    [5] => A
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:56:42.743

只需使用[`array_splice`](http://www.php.net/manual/en/function.array-splice.php)：

```
function move_element(&$array, $element, $position)
{
    $key = array_search($element, $array, true);
    if ($key === false) {
        return;
    }

    array_splice($array, array_search($key, array_keys($array)), 1);
    array_splice($array, $position, 0, $element);
} 
```

您的示例将通过

```
move_element($list, 'A', 2); 
```

如果您不想将目标指定为值，而是指定为位置，则更容易：

```
function move_element(&$array, $from, $to)
{
    $removed = array_splice($array, $from, 1);
    array_splice($array, $to, 0, $removed);
}

move_element($list, 0, 2); 
```

# ruby - Ruby：对文本文件应用过滤器（条件打印）

> ID：15179344
> 
> 赞同：0
> 
> 时间：2013-03-02T20:54:40.520
> 
> 标签：ruby, text, conditional, filtering

我有一个包含三种信息的 CSV：userID、wordID、ct

（基本上，14k 不同的推文，他们使用的每个单词都有不同的行，包括该单词的计数）

我希望能够仅针对具有至少 2000 个不同 wordID 的用户 ID 过滤此文件。

我了解如何浏览文件并计算每个用户 ID 的 wordID，但我不知道如何将其与“现在只为真正频繁使用的用户 ID 放置 'userID,wordID,ct'”相结合。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T21:37:02.683

这是我当前处理文件的方式。我怀疑有更有效的方法可以做到这一点，因为文件本身是 19m 行——对效率的思考肯定会受到赞赏。

```
filename = ARGV[0]

file = File.new(filename, "r")

entry = {}

file.each do |line|
        user, word, ct = line.chomp.split(",")
        entry[user] = entry[user].to_i + 1
end

file = File.new(filename, "r")

file.each do |line| 
line.strip!
        user, word, ct = line.chomp.split(",")
        if entry[user] >= 2000
                puts line   
        end
end 
```

# installation - gen update rake -bash: gen: command not found

> ID：15179355
> 
> 赞同：1
> 
> 时间：2013-03-02T20:55:38.890
> 
> 标签：installation, rvm

我已经在装有 OS X 10.7 的 Mac 上安装了 Ruby、Rails、RVM、Git 和 Homebrew。我还安装了 Jewelry box 并安装了以下版本的 Ruby：（1.9.1、2.0.0）。

我可以转到终端窗口并执行 gem list 命令，但是当我尝试 gem update rake 时，我收到以下错误：

```
-bash: gen: command not found 
```

我担心在我所有的安装、卸载和安装过程中，由于单用户安装和多用户安装之间可能存在冲突并且不知道如何解决，我会以某种方式得到一个混乱的环境。

Ruby 和 Rails的 A`whereis`显示它们都在`usr/bin`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:17:10.703

没有这样的命令`gen`- try `gem`，你可能有一个`alias gem=gen`or `function gem(){ gen "$@"; }`which 可以做到这一点

# android - 使用 PendingIntents 取消警报

> ID：15179356
> 
> 赞同：0
> 
> 时间：2013-03-02T20:55:39.670
> 
> 标签：android, android-intent

我正在尝试取消上次运行我的应用程序时设置的警报。这个警报有一个用 设置的 PendingIntent`PendingIntent.getBroadcast`和一个包含由 设置的一些变量的内部 Intent `intent.putExtra`。我的问题是，我知道可以通过调用`alarmManager.cancel(pendingIntent)`where pendingIntent 与用于设置警报的相同来取消警报。但是，如果放置在意图中的变量发生变化，警报仍然会被取消吗？例如，我使用 intent.putExtra("Joe") 设置警报，其中 Joe 是联系人姓名。后来我的应用程序关闭，当它重新运行时，我尝试取消“Joe”的警报，但用户已将联系人的姓名更改为“Jones”。我可以在不知道我放入意图的变量的情况下取消警报吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:11:35.350

根据[这个问题](https://stackoverflow.com/a/7219859/1788910)（参考文档），`putExtra`在检查意图是否等于另一个意图时，您添加的任何内容都不会被考虑在内。

是否更改了额外的数据无关紧要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T21:12:47.323

我认为无论如何它都应该取消警报，即使某些数据不同。该`cancel`方法说：

> 任何类型的任何警报，其 Intent 与此匹配（由 filterEquals(Intent) 定义）都将被取消。

并`filterEquals`说：

> 出于意图解析（过滤）的目的，确定两个意图是否相同。也就是说，如果它们的动作、数据、类型、类和类别相同。**这不会比较意图中包含的任何额外数据**。

无论如何，我仍然会自己测试它。

# objective-c - 如何检查 Audioplayer 的播放时间增加 2 秒

> ID：15179357
> 
> 赞同：0
> 
> 时间：2013-03-02T20:55:48.220
> 
> 标签：objective-c, xcode, ios6, avaudioplayer, nstimer

我正在尝试编写一个循环来检查每当音频 player.currenttime 增加 2 秒时它应该执行更新视图方法

```
- (void)myTimerMethod{

 NSLog(@"myTimerMethod is Called");

myTimer = [NSTimer scheduledTimerWithTimeInterval:1.0
                                           target:self
                                         selector:@selector(checkPlaybackTime:)
                                         userInfo:nil
                                          repeats:YES];

  }

- (void)checkPlaybackTime:(NSTimer *)theTimer
  {
    float seconds =  audioplayer.currenttime;

    NSLog(@"Cur: %f",audioPlayer.currentTime ); 

    if (seconds = seconds + 2){

    [self update view];
}

 - (void)UpdateView{

if  (index < [textArray count])
 {
     self.textView.text = [self.textArray objectAtIndex:index];
   self.imageView.image = [self.imagesArray objectAtIndex:index];
   index++;
}else{

    index = 0;

   }
 } 
```

如果音频 player.currenttimer 增加 2 秒，那么正确的写入方法是什么，然后执行此操作。

当前时间的 NSLog 始终显示 0.00。这是为什么。它应该随着音频播放器的播放而增加。

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T03:58:52.093

首先，尝试在 NSLog 中使用浮点“秒”而不是当前时间。

```
NSLog(@"Cur: %f", seconds); 
```

当前时间不是浮点数，它是一个 NSTimer 对象，因此您必须在 NSLog 文本中使用 %@ 所以

```
NSLog(@"Cur: %@",audioPlayer.currentTime ); 
```

也应该工作。

假设您的 audioPlayer 设置正确，如果您正在寻找计时器何时为 2 秒，您的 if 语句将是

```
if(seconds == 2){
    [self update view];
} 
```

if you're looking for each time the timer hits an even number, i.e. 2, 4, 6, etc. your if statement will be

```
if(seconds % 2 == 0){
    [self update view];
} 
```

The % in an if statement is the modulo sign: [http://www.cprogramming.com/tutorial/modulus.html](http://www.cprogramming.com/tutorial/modulus.html)

Also, your current if statement is assigning rather than checking the seconds variable. To check it, you need == not =. However, your current if statement will never be true since you're checking a variable by itself + 2\. To put this another way, if seconds equals 2, your if statement is asking if 2 == (2+2) or if it it is 4, it's asking if 2 == (4+2). This statement cannot validate as true.

Hope this helps!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T21:26:57.230

What i understood from your given explanation that you want to increment the time-interval something like this

```
Timer calls after 0.55
Timer calls after 0.60
Timer calls after 0.65
Timer calls after 0.70 
```

& so on.

如果那是你想要做的。然后我认为你可以这样做，通过将repeats:YES 更改为repeats:NO 以便计时器不重复，然后在onTimer 中，只需启动一个间隔更长的新计时器。

您需要一个变量来保存您的时间间隔，以便您可以通过 onTimer 将其延长一点。

此外，您可能不再需要保留计时器，因为它只会触发一次，当它触发时，您将获得一个新计时器。

```
float gap = 0.50;

[NSTimer scheduledTimerWithTimeInterval:gap target:self selector:@selector(onTimer) userInfo:nil repeats:NO];

-(void) onTimer {
gap = gap + .05;
[NSTimer scheduledTimerWithTimeInterval:gap target:self selector:@selector(onTimer) userInfo:nil repeats:NO];
} 
```

希望这可以帮助你

# c# - Fluent NHibernate 自动删除数据

> ID：15179360
> 
> 赞同：3
> 
> 时间：2013-03-02T20:56:26.830
> 
> 标签：c#, asp.net-mvc, postgresql, fluent-nhibernate

我在 ASP.NET MVC4 应用程序中使用带有代码优先实体和映射的 PostgreSQL 和 Fluent NHibernate。

当我运行应用程序时，它会自动从数据库中删除每条记录。

这是我的 NHibernateHelper 类

```
public class NHibernateHelper
{
    private static ISessionFactory _sessionFactory;

    private static ISessionFactory SessionFactory 
    {
        get 
        {
            if (_sessionFactory == null)
                InitializeSessionFactory();
            return _sessionFactory;
        }
    }

    private static void InitializeSessionFactory()
    {
        _sessionFactory = Fluently.Configure()
            .Database(PostgreSQLConfiguration.Standard
                        .ConnectionString(
                            @"Server=localhost;Port=5432;Database=TestDB;User=postgres;Password=postgre;")
                        .ShowSql()
            )
            .Mappings(m => m.FluentMappings.AddFromAssemblyOf<ProductCategory>())
            .ExposeConfiguration(cfg => new SchemaExport(cfg)
                            .Create(true, true))
            .BuildSessionFactory();
    }

    public static ISession OpenSession() 
    {
        return SessionFactory.OpenSession();
    } 
```

有什么不正确的配置吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T21:30:21.277

我想说问题出在这里：

```
.ExposeConfiguration(cfg => new SchemaExport(cfg).Create(true,true)) 
```

每次构建会话工厂时，您似乎都在导出模式。现在我不是 100% 确定（我从来没有使用代码优先来生成表，只映射到我事先创建的现有数据库），但我敢打赌，导出会覆盖你已经拥有的（删除和重新创建或其他） .

[在这里](https://stackoverflow.com/q/1253474/1180426)，有人在使用 Fluent NHibernate 导出架构时遇到了 SQLite 文件被覆盖的类似问题，所以我想说你必须小心何时以及如何（重新）创建数据库:)

# c - setpgrp/setpgid 失败（？），适用于 Mac OSX，不适用于 Linux

> ID：15179361
> 
> 赞同：0
> 
> 时间：2013-03-02T20:56:30.020
> 
> 标签：c, fork, kill, sigint

我正在尝试编写一个执行子命令的程序，并且不允许该子命令被 Ctrl+C 杀死。

我读过我可以用 setpgid/setpgrp 完成这个。

以下代码适用于 OSX，但在 Linux（2.6.32，Ubuntu 10.04）上运行类似，

```
./a.out ls 
```

导致没有输出发生并且程序不能被 SIGINT 杀死。

```
#include <unistd.h>
#include <stdlib.h>
#include <errno.h>
#include <stdio.h>

int main(int argc, char **argv) {
    if (argc < 2) {
        printf("Please provide a command\n");
        exit(1);
    }

    int child_pid = vfork();

    if (child_pid == 0) {
        if (setpgrp() == -1) {
            perror("setpgrp error");
            exit(1);
        }

        printf("Now executing the command:\n");

        argv++;
        if (execvp(argv[0], argv) == -1) {
            perror("Could not execute the command");
            exit(1);
        }
    }

    int child_status;
    wait(&child_status);
} 
```

如果您注释掉对 setpgrp 的调用，您将看到剩余的代码可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T06:03:17.047

我必须修改这部分代码才能在两个平台上工作。我想这只是内核处理会话和进程组的方式之间的区别。

```
if (setsid() == -1) {
   #ifdef LINUX
   perror("setsid error");
   exit(1);
   #else
   if (setpgrp() == -1) {
       perror("setpgrp error");
       exit(1);
   }   
   #endif
} 
```

# python - 正则表达式中的 OR'ed 反向引用

> ID：15179362
> 
> 赞同：1
> 
> 时间：2013-03-02T20:56:30.897
> 
> 标签：python, regex, backreference

有人可以解释一下这个正则表达式应该如何工作：

```
^(a)|\1$ 
```

?

我将其解释为：

*1。字符串的开头，

其次是：

*2。任何一个：

*2a。一个`a`，

或者：

*2b。先前匹配的`(a)`组，

其次是：

*3。字符串结尾

但是，2b 是不可能的，因为`(a)`如果选择 2b 而不是 2a，则没有先前匹配的组。因此，解释等价于：

*1。字符串的开头，

其次是：

*2。一个`a`，

其次是：

*3。字符串结尾

换句话说，该正则表达式等价于：（`^a$`也可以说 OR'ed 反向引用是无意义的。）

但是，在 Python 中，我得到：

```
>>> import re

>>> re.findall(r'^a$', r'aa')
[] # as expected

>>> re.findall(r'^(a)|\1$', r'a')
['a'] # as expected

>>> re.findall(r'^(a)|\1$', r'aa')
['a'] # NOT as expected 
```

怎么`aa`可能匹配`^(a)|\1$`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-20T19:33:35.623

这实际上是一个无法访问的正则表达式代码的情况：

原则上，当且仅当已经匹配了行首的单个`a`时，这匹配行首的单个或行尾的单个。但是，由于在行首匹配单个意味着匹配已经完成，因此永远不会到达正则表达式的第二部分，而只会返回第一部分。`a``a``a``a`

我猜你有一个更复杂的组，而不仅仅是“a”，所以这里有一个与短语匹配的组`a`，第二个`a`（可选），然后是行尾：`^(a)\1?$`

这意味着“`a`在行首匹配，然后允许另一个 foo（如果它在那里），然后是字符串的结尾，其中`a`可以是任何正则表达式模式。如果`a`真的只是字母“a”，那么`^aa?$`是一个更简单的选择.

如果您只想匹配以 开头或结尾的任何整行`a`，那么`^(a.*|.*a)$`将起作用，或者`^(a[^\n]*|[^\n]*a)$`如果使用单行模式，则简化为`^(a.*?|.*?a)$`支持`*?`运算符的正则表达式风格。不幸的是，在这种情况下，模式 for`a`必须同时写在整个模式的开头和结尾，因为反向引用不会起到作用。如果`a`是带有`|`运算符的模式，则将其括在括号中，如`^((a).*|.*(a))$`.

# c++ - 在 C++ 中修改 3D 坐标

> ID：15179364
> 
> 赞同：0
> 
> 时间：2013-03-02T20:56:43.690
> 
> 标签：c++, opengl, coordinates

我正在尝试用 C++ 为骨架制作动画。我目前有所有关节的坐标以及哪些关节连接到哪个关节。

有谁知道我将如何进行，例如，将手臂抬高 90 度，然后计算手臂下方所有关节的新坐标？

我猜我必须获取每个骨骼的向量并旋转它们并从那里获取它，但我不确定如何去做。

（我正在使用 openGL 来显示它们）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:06:39.237

计算要旋转的点和轴。轴垂直于旋转平面。关键是你的肩膀。您将旋转手臂层次结构中的所有点相同的量。网上有很多关于任意轴旋转的例子。这是一个： http: [//paulbourke.net/geometry/rotate/](http://paulbourke.net/geometry/rotate/)

另一种解决方法是使用局部变换重新解释您的骨架：*即*每个新骨骼都从其父骨骼的世界空间进行变换。这对于前向运动学 (FK) 很有用，您只需根据局部旋转来设置骨架。大多数运动捕捉数据都是以这种方式存储的。要计算每个关节的世界坐标，您必须将所有局部矩阵乘上层级。

如果您目前在世界空间中只有骨架关节位置，那么生成局部变换矩阵会很痛苦，因为您不一定知道每个关节的局部矩阵。这是一个更大的话题。几年前，当我在一个名为 CAT 的 3dsmax 插件中开发动作捕捉重定向模块时，我就这样做了。

我使用了两种流行的格式：BVH 和 HTR。从记忆中，BVH 使用全局位置（并且很痛苦），而 HTR 使用局部联合矩阵并且更容易导入。

# php - 如何为没有 Gravatar 的用户更改默认个人资料图片（在 Wordpress 中）

> ID：15179367
> 
> 赞同：0
> 
> 时间：2013-03-02T20:56:57.837
> 
> 标签：php, facebook, wordpress, gravatar

我想用不同的图片替换默认的“神秘人”头像。

如您所知，您可以通过访问[http://graph.facebook.com/](http://graph.facebook.com/) /picture 访问某人的 Facebook 个人资料图片（替换为所请求帐户的 UID。

所以我基本上做的是添加我的主题的函数文件这几行：

```
 add_filter( 'avatar_defaults', 'newgravatar' );  

function newgravatar ($avatar_defaults) {  
    $myavatar = 'http://graph.facebook.com/'.get_current_user_id().'/picture';
    $avatar_defaults[$myavatar] = "FB Profile Picture";  
    return $avatar_defaults;  
} 
```

问题是 wordpress 不直接显示这个 URL。它将图片存储在 WordPress.com 的服务器上。因此，图片始终是同一张图片，并且在不同用户登录时不会更改。

有什么办法可以阻止 WordPress 在他们的服务器上缓存图片？或者有没有其他方法可以做我想做的事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:00:29.247

如果某人有一个带有自定义头像的 gmail 帐户，并且该电子邮件地址用于注册，它将自动使用该头像。我知道这可能不是您正在寻找的东西，但我认为了解它非常有用。

更新：

在这里找到你的答案：

[http://buildinternet.com/2009/02/how-to-change-the-default-gravatar-in-wordpress/](http://buildinternet.com/2009/02/how-to-change-the-default-gravatar-in-wordpress/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T11:53:12.337

我终于设法通过使用这个过滤器来修复它：

```
 add_filter('get_avatar', 'new_fb_insert_avatar', 1, 5);

function new_fb_insert_avatar($avatar = '', $id_or_email, $size = 96, $default = '', $alt = false) {

  $id = 0;

  if (is_numeric($id_or_email)) {

    $id = $id_or_email;

  } else if (is_string($id_or_email)) {

    $u = get_user_by('email', $id_or_email);

    $id = $u->id;

  } else if (is_object($id_or_email)) {

    $id = $id_or_email->user_id;

  }

  if ($id == 0) return $avatar;

  $pic = get_user_meta($id, 'fb_profile_picture', true);

  if (!$pic || $pic == '') return $avatar;

  $avatar = preg_replace('/src=("|\').*?("|\')/i', 'src=\'' . $pic . '\'', $avatar);

  return $avatar;

} 
```

带来了`get_user_meta($id, 'fb_profile_picture', true);`用户的自定义头像图片。每个用户都有不同的图片，并存储在他的用户元信息中。

# php - Php：带有标题的卷曲不起作用

> ID：15179373
> 
> 赞同：0
> 
> 时间：2013-03-02T20:58:06.853
> 
> 标签：php, curl

我正在尝试在 curl 中设置标题。但是如果我使用标题，我的 curl 将不起作用。下面是我的代码。

```
 $ch = curl_init();
    $headers = array("Content-Type: multipart/form-data; boundary=---------------------------643932844140921187526840362", "Content-Length: 1927");
    curl_setopt($ch,CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
    curl_setopt($ch, CURLOPT_REFERER, 'http://domain.com/submit/');
    curl_setopt($ch, CURLOPT_RETURNTRANSFER,true);
    curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/0.A.B.C Safari/525.13");
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
    curl_setopt($ch,CURLOPT_COOKIEJAR, "cookie.txt");
    curl_setopt($ch,CURLOPT_COOKIEFILE, "cookie.txt");
    curl_setopt($ch,CURLOPT_POST, count($fields));
    curl_setopt($ch,CURLOPT_POSTFIELDS, $fields_string);
    $result = curl_exec($ch); 
    $last = curl_getinfo($ch, CURLINFO_EFFECTIVE_URL);
    return array($result,$last);
    curl_close($ch); 
```

但是如果我删除下面的代码，代码就可以正常工作。

```
$headers = array("Content-Type: multipart/form-data; boundary=---------------------------643932844140921187526840362", "Content-Length: 1927");
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers); 
```

这是设置标题的正确方法吗？还是我错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T22:10:43.027

尝试更换：

`"Content-Length: 1927"`

和

`"Content-Length: " . strlen($fields_string)`

# javascript - 在 jQuery 中处理 Infinite Load 并且无法让 Load 函数只加载一次

> ID：15179375
> 
> 赞同：1
> 
> 时间：2013-03-02T20:58:21.953
> 
> 标签：javascript, jquery

我正在研究`Infinite Load`（例如延迟加载）类型功能，这是迄今为止的功能：

```
$(window).scroll(function() {
       var ScrollPosition = $(window).scrollTop() + $(window).height();
       var LoadMorePosition = $(document).height()-100;
       if( ScrollPosition == LoadMorePosition ) {
           console.log('loading more');
           loadMoreItems();
       }
    }); 
```

它在大多数情况下都在工作，只是`loadMoreItems`一旦人滚动到阈值，该函数就会被调用 20-30 次。

我在想一个 setTimeout 类型的东西可能会起作用，但后来我意识到它只有在 Ajax 内容加载足够快的情况下才会起作用（这不能保证）。

我需要的是一种方法来检测它们是否达到阈值，然后只调用一次函数，直到它们再次达到滚动阈值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:11:12.820

你可以这样做：

```
var loadOnce = function(fn) {
  var loadedPages = {};
  return function(page) {
    var key = 'p'+page;
    if (typeof loadedPages[key] === 'undefined') {
      fn.apply(fn, arguments);
      loadedPages[key] = true;
    }
  };
};

var loader = loadOnce(function(page) {
  /* Ajax Request */
});

// Will only fire the ajax request once:
loader(1);
loader(1);
loader(1);
loader(1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:02:09.433

> 我在想一个 setTimeout 类型的东西可能会起作用，但后来我意识到它只有在 Ajax 内容加载足够快的情况下才会起作用（这不能保证）。

然后不要依赖超时，而是在 AJAX 请求的成功\完成时重置标志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T21:58:48.573

AJAX 调用的成功部分应该设置加载更多内容标志，因此如果您没有更多内容，则不要加载更多内容。

对于滚动，设置超时以检测用户何时停止滚动，然后执行显示加载 gif 并执行 ajax，成功时隐藏 gif 并加载更多：D

```
$(window).scroll(function(){
  clearTimeout(scrolled);
  scrolled = setTimeout(function(){
  //Your function when user stops scrolling
  }, 100);
}); 
```

# c# - 解析具有多个表的制表符分隔文件

> ID：15179379
> 
> 赞同：0
> 
> 时间：2013-03-02T20:58:42.703
> 
> 标签：c#, csv

谁能推荐一个使用 c#（可能是 filehelper）的好方法，它可以让我在 c# 中解析像这样格式化的文件？

```
%T  person
%F  id  name    address city
%R  1   Bob 999 Main St Burbank
%R  2   Sara    829 South st    Pasadena
%T  houses
%F  id  personid    housetype  Color
%R  25  1       House   Red
%R  26  2       condo   Green 
```

我想把这两个表变成一个数据表或者我可以用 linq 查询的东西。

该文件是制表符分隔的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-03T21:35:34.830

此类数据的示例解析器

```
public IEnumerable<Dictionary<string, string>> Parse(TextReader reader)
{
    var state = new State { Handle = ExpectTableTitle };
    return GenerateFrom(reader)
        .Select(line => state.Handle(line.Split('\t'), state))
        .Where(returnIt => returnIt)
        .Select(returnIt => state.Row);
}

private bool ExpectTableTitle(string[] lineParts, State state)
{
    if (lineParts[0] == "%T")
    {
        state.TableTitle = lineParts[1];
        state.Handle = ExpectFieldNames;
    }
    else
    {
        Console.WriteLine("Expected %T but found '"+lineParts[0]+"'");
    }
    return false;
}

private bool ExpectFieldNames(string[] lineParts, State state)
{
    if (lineParts[0] == "%F")
    {
        state.FieldNames = lineParts.Skip(1).ToArray();
        state.Handle = ExpectRowOrTableTitle;
    }
    else
    {
        Console.WriteLine("Expected %F but found '" + lineParts[0] + "'");
    }
    return false;
}

private bool ExpectRowOrTableTitle(string[] lineParts, State state)
{
    if (lineParts[0] == "%R")
    {

        state.Row = lineParts.Skip(1)
            .Select((x, i) => new { Value = x, Index = i })
            .ToDictionary(x => state.FieldNames[x.Index], x => x.Value);
        state.Row.Add("_tableTitle",state.TableTitle);
        return true;
    }
    return ExpectTableTitle(lineParts, state);
}

public class State
{
    public string TableTitle;
    public string[] FieldNames;
    public Dictionary<string, string> Row;
    public Func<string[], State, bool> Handle;
}

private static IEnumerable<string> GenerateFrom(TextReader reader)
{
    string line;
    while ((line = reader.ReadLine()) != null)
    {
        yield return line;
    }
} 
```

然后只需根据 _tableTitle 条目将每个结果字典转换/映射到您的域对象之一。

这是使用您的示例数据的测试工具。要从文件中读取，请传入 StreamReader 而不是 StringReader。

```
const string data = @"%T\tperson
%F\tid\tname\taddress\tcity
%R\t1\tBob\t999 Main St\tBurbank
%R\t2\tSara\t829 South st\tPasadena
%T\thouses
%F\tid\tpersonid\thousetype\tColor
%R\t25\t1\tHouse\tRed
%R\t26\t2\tcondo\tGreen";

var reader = new StringReader(data.Replace("\\t","\t"));

var rows = Parse(reader);
foreach (var row in rows)
{
    foreach (var entry in row)
    {
        Console.Write(entry.Key);
        Console.Write('\t');
        Console.Write('=');
        Console.Write('\t');
        Console.Write(entry.Value);
        Console.WriteLine();
    }
    Console.WriteLine();
} 
```

输出：

```
id    =    1
name    =    Bob
address    =    999 Main St
city    =    Burbank
_tableTitle    =    person

id    =    2
name    =    Sara
address    =    829 South st
city    =    Pasadena
_tableTitle    =    person

id    =    25
personid    =    1
housetype    =    House
Color    =    Red
_tableTitle    =    houses

id    =    26
personid    =    2
housetype    =    condo
Color    =    Green
_tableTitle    =    houses 
```

# java - 将editText添加到customView

> ID：15179383
> 
> 赞同：0
> 
> 时间：2013-03-02T20:59:10.313
> 
> 标签：java, android, android-canvas

我想在特定坐标中将 EditText 添加到画布。像这样的东西：![在此处输入图像描述](../Images/282a7926c81bab663a18f3cc3786131f.png)

我尝试使用代码：

```
 LinearLayout layout = new LinearLayout(context);

        EditText textView = new EditText(context); 
        textView.setVisibility(View.VISIBLE);
        textView.setText("Hello world");

        layout.addView(textView);

        layout.measure(canvas.getWidth(), canvas.getHeight());
        layout.layout(0, 0, canvas.getWidth(), canvas.getHeight());
        layout.setGravity(Gravity.BOTTOM);

        layout.draw(canvas); 
```

但是这个 EditText 没有在点击时显示键盘。你能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:16:09.710

假设你真的需要在画布上绘制它......

在 res/layout 文件夹中创建一个新的 canvaslayout.xml。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:ems="5" >
        <requestFocus />
    </EditText>
    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/editText1"
        android:layout_toRightOf="@+id/editText1"
        android:text="Edit Text"
        android:textAppearance="?android:attr/textAppearanceMedium" />
</RelativeLayout> 
```

也改代码

```
LinearLayout layout = findViewById(R.layout.canvaslayout); 
//LinearLayout layout = youractivity.findViewById(R.layout.canvasLayout); 
layout.draw(canvas); 
```

**以编程方式：**

如果您不想使用 XML（我不明白为什么不这样做），您可以使用[此](https://stackoverflow.com/questions/12238164/how-to-align-a-textview-to-the-right-of-another-text-view-programmatically-in-an)方法。您将线性布局更改为相对布局，并使用类似的方法将视图放在另一个视图的右侧。

```
RelativeLayout.LayoutParams relativeLayoutParams=
            new RelativeLayout.LayoutParams((RelativeLayout.LayoutParams.WRAP_CONTENT),(RelativeLayout.LayoutParams.WRAP_CONTENT));//create params for new textview

    relativeLayoutParams.addRule(RelativeLayout.RIGHT_OF, textView.getId());//to align the textview side by side 
```

# ios - 调用 popViewController 后 UINavigationController 的 viewControllers 的计数将为 0

> ID：15179387
> 
> 赞同：0
> 
> 时间：2013-03-02T20:59:51.093
> 
> 标签：ios

我有三个 UIViewController，所以我使用 UINavigationController 作为窗口的 rootViewController。当我记录 [navigationController.viewControllers count] 的计数时，我发现当您调用 popViewControllerAnimated 时计数将为 0。奇怪的是，当你回到之前的 ViewController 时，你记录了计数，计数将是正常的，堆栈上控制器的实际计数。popViewController 做了什么来做出如此奇怪的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:27:43.217

当您弹出第三个视图控制器时，它的`navigationController`属性`nil`将`viewControllers`返回`nil`并将`count`返回 0。

# ruby-on-rails - 将来自 text_field_tag 的输入文本作为 URL 的变量传递...？

> ID：15179388
> 
> 赞同：1
> 
> 时间：2013-03-02T21:00:06.770
> 
> 标签：ruby-on-rails, ruby

好的，所以我真的不知道如何正确表达这个词，但这基本上就是我想要做的。我正在尝试将用户输入到我的搜索框中的文本传递给 URL。到目前为止，这是我的视图页面：

```
<h1>What's the weather like by you?</h1>
<br />

<%= form_tag('http://api.wunderground.com/api/myAPIkey/conditions/q/**USER_TEXT_FROM_TEXT_FIELD_TAG**.json',:method =>
'get') do %>

<p>
    <%= text_field_tag 'zipcode', params[:search] %>
    <%= submit_tag "Check It Out!", :name => nil %>
</p>
<% end %> 
```

我知道这可能是一件很容易的事情，但我似乎找不到任何方法来正确地做到这一点。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:32:08.383

看起来您正在尝试根据用户输入将表单提交重定向到不同的 url。

我没有**JavaScript**的建议是通过您自己的控制器和 redirect_to 自定义 url。像这样的东西：

将您的视图更改为：

```
<h1>What's the weather like by you?</h1>
<br />

<%= form_tag('/weather') do %>
  <p>
    <%= text_field_tag 'zipcode' %>
    <%= submit_tag "Check It Out!", :name => nil %>
  </p>
<% end %> 
```

创建天气控制器：

```
rails g controller weather create 
```

将此行添加到您的 config/route.rb 文件中：

```
match 'weather' => 'weather#create', via: :post 
```

并将您的 app/controllers/weather_controller.rb 修改为如下所示：

```
class WeatherController < ApplicationController
  def create
    redirect_to "http://api.wunderground.com/api/myAPIkey/conditions/q/#{params[:zipcode].split.join('+')}.json"
  end
end 
```

这不是一个好的解决方案，也不是最聪明的解决方案，它只是使用 rails stack 复制您的代码。你的问题没有提供很多关于你想用 api 返回的日期做什么的信息？您真的想简单地重定向到给定的 url 并将数据视为 json 吗？

我只是想给你另一个想法如何解决这个问题，它不是最终的解决方案。

# javascript - 如何将多个图像附加到跨度元素

> ID：15179389
> 
> 赞同：0
> 
> 时间：2013-03-02T21:00:09.057
> 
> 标签：javascript, jquery, html

当我从数据库中读取数字时，我想在 span 元素中动态插入多个图像。

代码：

```
$.ajax({
        type: "POST",
        url: "all_data.php",
        dataType: 'json',
        cache: false,
        success: function(response) {
            for (var i = 0, len = response.data.length; i < len; i++) {
            $('.item_holder').append('<span class="rating_images">'+response.data[i].number+'</span>');
        }
        }
    }); 
```

我需要检查变量中的数字`response.data[i].number`，然后 `<img class="rating_img" src="../images/star.png" alt="rating"/>`根据该数字插入 x 次

我知道如何检查值，但我不知道如何在此内联文本中多次插入

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:18:14.720

尝试这个：

```
$.ajax({
    type: "POST",
    url: "all_data.php",
    dataType: 'json',
    cache: false,
    success: function(response) {
        var star_html = '<img class="rating_img" src="../images/star.png" alt="rating"/>';
        var make_stars = function(rating){
            var tpl = '';
            for(i=0; i<rating; i++){
                tpl += star_html;
            }
            return tpl;
        };

        $.each(response.data, function(){
            $('.item_holder').append('<span class="rating_images">'+make_stars(response.data[i].number)+'</span>');                
        });            
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:11:23.940

我不确定我是否正确理解了您的问题，但也许是这样的？：

```
for (var i = 0; i < response.data.length; i++) {
    var number = response.data[i].number;
    var images = "";

    for(var j = 0; j < number; j++)
        images += '<img class="rating_img" src="../images/star.png" alt="rating"/>';

    $('.item_holder').append('<span class="rating_images">'+ images +'</span>');
} 
```

# javascript - Javascript 确认和导航

> ID：15179391
> 
> 赞同：0
> 
> 时间：2013-03-02T21:00:14.430
> 
> 标签：javascript, if-statement, window.location

我有以下片段，这些片段是不言自明的：

HTML：

```
<input
    class="button"
    style="height:30px; margin-left: 5px; margin-right: auto; vertical-align: middle;"
    onclick="disp_confirm();"
    tabindex="3"
    type="submit"
    value="Delete"> 
```

JavaScript：

```
function disp_confirm() {
    if (window.confirm('Are you sure you want to delete this user?')) {
        window.location.href = 'https://sub.domain.com/details.php?action=delete';
    }
} 
```

出于某种原因，这不会导航此页面。我想要的只是基本上重新加载页面并添加一个`action=delete`.

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:02:59.933

尝试使用：

```
window.location.search = 'action=delete'; 
```

# sql - 检查后从表中返回值的 PL/SQL 函数

> ID：15179395
> 
> 赞同：2
> 
> 时间：2013-03-02T21:01:08.640
> 
> 标签：sql, database, function, plsql

我是 php 和 sql 的新手，我正在构建一个小游戏来学习更多后者。

这是我的三个表的简单数据库：

```
 -- *********** SIMPLE MONSTERS DATABASE

 CREATE TABLE  monsters (

 monster_id         VARCHAR(20),
 haunt_spawn_point  VARCHAR(5)  NOT NULL,
 monster_name       VARCHAR(30) NOT NULL,
 level_str          VARCHAR(10) NOT NULL,
 creation_date      DATE NOT NULL,

 CONSTRAINT monster_id_pk PRIMARY KEY (monster_id)
 );

 -- ****************************************

 CREATE TABLE  spawntypes (

 spawn_point            VARCHAR(5),
 special_tresures       VARCHAR (5) NOT NULL,
 maximum_monsters       NUMBER NOT NULL,
 unitary_experience     NUMBER NOT NULL,

 CONSTRAINT spawn_point_pk PRIMARY KEY (spawn_point)
 );

 -- ****************************************

 CREATE TABLE  fights (

 fight_id           NUMBER,
 my_monster_id      VARCHAR(20),
 foe_spawn_point    VARCHAR(5),
 foe_monster_id     VARCHAR(20) NOT NULL,
 fight_start        TIMESTAMP NOT NULL,
 fight_end          TIMESTAMP NOT NULL,
 total_experience   NUMBER NOT NULL
 loot_type          NUMBER NOT NULL,

 CONSTRAINT my_monster_id_fk FOREIGN KEY (my_monster_id)
 REFERENCES monsters (monster_id),

 CONSTRAINT foe_spawn_point_fk FOREIGN KEY (foe_spawn_point)
 REFERENCES spawntypes (spawn_point),

 CONSTRAINT fight_id_pk PRIMARY KEY (fight_id)
 ); 
```

鉴于这些数据，我如何轻松执行这两项任务：

1）我想创建一个pl/sql函数，它只传递一个fight_id作为参数并给定foe_spawn_point（在战斗表内）返回与这个参考spawntypes表的生成点相关的unitary_experience，我该怎么做? :-/ [f(x)]

为了计算从一场战斗中获得的总经验（unitary_experience * fight_length），我创建了一个函数，给定一场特定的战斗，它将用fight_start减去fight_end，所以现在我知道战斗持续了多长时间。[f(y)]

2）在数据库填充任务期间是否可以使用这两个函数（乘以它们返回的结果）？

插入战斗值（....，f（x）* f（y），'战利品A'）；

为了填充战斗表中的所有 total_experience 条目？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:17:12.117

在 SQL 中，您通常不会谈论构建函数来做事。SQL 的构建块是查询、视图和存储过程（大多数 SQL 方言*都*具有函数，但这不是开始的地方）。

因此，给定一个带有 $FIGHTID 的变量，您将通过一个使用该`join`操作的简单查询来获取单一体验：

```
select unitary_experience
from fight f join
     spawnTypes st
     on st.spawn_point = f.foe_spawn_point
where fightid = $FIGHTID 
```

如果您要插入一系列值以及一个函数，我建议使用以下`select`形式`insert`：

```
insert into fights(<list of columns, total_experience)
    select <list of values>,
           ($FIGHT_END - $FIGHT_START) * (select unitary_experience from spawnTypes where spawnType ='$SPAWN_POINT) 
```

关于表格的一条评论。最好让表中的所有 id 都是自动递增的整数。在 Oracle 中，您通过创建一个序列来做到这一点（在大多数其他数据库中它更简单）。

# html - css位置相对不需要的额外空间

> ID：15179398
> 
> 赞同：1
> 
> 时间：2013-03-02T21:01:50.977
> 
> 标签：html, css

我的 CSS 出现了奇怪的效果。当我将鼠标悬停在一个框上时，它会将下一个框移动 32 像素。为什么？我假设它是因为复选框，但我将它向左移动了 32px。

[演示](http://jsfiddle.net/NPXFZ/)

html:

```
<div class="Z"> <a href="http://google.com"><img src="http://25.media.tumblr.com/tumblr_m9p3n1vJmZ1rexr16o1_400.jpg" class="A"/><img src="http://suvendugiri.files.wordpress.com/2012/02/checkbox.png" class="B"/></a>
    <a
    href="http://google.com">
        <img src="http://25.media.tumblr.com/tumblr_m9p3n1vJmZ1rexr16o1_400.jpg"
        class="A" />
        <img src="http://suvendugiri.files.wordpress.com/2012/02/checkbox.png"
        class="B" />
        </a>
</div> 
```

CSS：

```
/*.B { display: none; }/**/
 a:hover .B {
    display:inline-block;
}
.B {
    display:none;
    width: 32px;
    position: relative;
    left:-32px;
    vertical-align:top;
}
/
/*/
//.Z > * {vertical-align:top; } 
```

JS（不需要）：

```
$('.B').click(function () {
    alert('a');
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:06:29.747

`left: -32px`不移动元素的盒子模型，只移动它显示的地方。我会以不同的方式处理这个问题：

```
a {
    position: relative;
}
 a:hover .B {
     display: inline;
}
.B {
    display:none;
    width: 32px;
    position: absolute;
    right: 0;
} 
```

[http://jsfiddle.net/NPXFZ/1/](http://jsfiddle.net/NPXFZ/1/)

# r - facet_wrap 中的不同轴值

> ID：15179402
> 
> 赞同：1
> 
> 时间：2013-03-02T21:02:30.547
> 
> 标签：r, ggplot2, facet-wrap

我正在处理按原籍国和年龄组划分的丹麦移民数据集。我对数据进行了转换，以便查看每个年龄组的主要原籍国。我正在使用 facet_wrap 绘制它。我想做的是，由于不同的年龄组来自完全不同的地区，因此在每个方面为一个轴显示一组不同的值。例如，0 到 10 岁的人来自 x、y 和 z 国，而 10-20 岁的人来自 q、r、z 等国家。

在我当前的版本中，它显示了整个值集，包括不在前 10 名中的国家/地区。我只想显示每个方面的前 10 个原产国，实际上每个方面都有不同的轴标签。（并且，如果可能的话，按每个方面从高到低排序）。这是我到目前为止所拥有的：

```
library(ggplot2)
library(reshape)
###load and inspect data
load(url('http://dl.dropbox.com/u/7446674/dk_census.rda'))
head(dk_census)

###reshape for plotting--keep just a few age groups
dk_census.m <- melt(dk_census[dk_census$Age %in% c('0-9 år', '10-19 år','20-29 år','30-39 år'),c(1,2,4)])

###get top 10 observations for each age group, store in data frame
top10 <- by(dk_census.m[order(dk_census.m$Age,-dk_census.m$value),], dk_census.m$Age,     head, n=10)
top10.df<-do.call("rbind", as.list(top10))
top10.df

###plot
ggplot(data=top10.df, aes(x=as.factor(Country), y=value)) +
  geom_bar(stat="identity")+
  coord_flip() +
  facet_wrap(~Age)+
  labs(title="Immigrants By Country by Age",x="Country of Origin",y="Population") 
```

![移民图表](../Images/ed2ec8448ec93c49183828c87488d32c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:39:23.987

一种选择（我实际上强烈怀疑您不会满意）是：

```
p <- ggplot(data=top10.df, aes(x=Country, y=value)) +
  geom_bar(stat="identity")+
  coord_flip() +
  facet_wrap(~Age)+
  labs(title="Immigrants By Country by Age",x="Country of Origin",y="Population")

pp <- dlply(.data=top10.df,.(Age),function(x) {x$Country <- reorder(x$Country,x$value); p %+% x})
library(gridExtra)
do.call(grid.arrange,pp) 
```

（编辑以对每个图表进行排序。）

请记住，faceting 存在的唯一原因是绘制多个*具有共同比例的*面板。因此，当您开始要求对某个变量进行刻面时，**但**尺度不同（哦，并且还在每个面板上分别对它们进行排序）时，您正在做的实际上不再是刻面。它只是制作四个不同的情节并将它们安排在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T23:21:29.577

使用`lattice`（这里我使用 ``latticeExtra`for ggplot2 theme), you can set to`关系 = 免费`between panels. Here I am using`缩写 = TRUE' 来缩短长标签。

```
library(latticeExtra)

barchart(value~ Country|Age,data=top10.df,layout=c(2,2),
         horizontal=T, 
         par.strip.text =list(cex=2),
         scales=list(y=list(relation='free',cex=1.5,abbreviate=T,
                            labels=levels(factor(top10.df$Country)))),
#         ,cex=1.5,abbreviate=F),
         par.settings = ggplot2like(),axis=axis.grid,
         main="Immigrants By Country by Age",
         ylab="Country of Origin",
         xlab="Population") 
```

![在此处输入图像描述](../Images/e0a1e6279c9c557af1a0d88c109cfacb.png)

# html - 内联时边距正常工作，但在 css 规则中不起作用

> ID：15179403
> 
> 赞同：0
> 
> 时间：2013-03-02T21:02:40.973
> 
> 标签：html, css, jsf-2, margin

当我写类似的东西时：

```
<table style="margin-left: 30px;" >
</table> 
```

或者：

```
<div style="margin-left: 30px;">
            <h:commandButton value="add" action="a"></h:commandButton>
            <h:commandButton value="cancel" action="b" immediate="true"></h:commandButton>
</div> 
```

边距正确显示。

但是当我写：

```
<table class="marg" >
</table> 
```

或者：

```
<div class="marg">
    <h:commandButton value="add" action="a"></h:commandButton>
    <h:commandButton value="cancel" action="b" immediate="true"></h:commandButton>
</div> 
```

有了这个规则：

```
.marg {
    margin-left: 50px;
    margin-top: 30px; 
} 
```

HTML 生成代码：

```
<table class="marg">
</table>
<div class="marg">
<input id="j_id1109917403_4227fec1:j_id1109917403_4227feb3" type="submit" value="add" name="j_id1109917403_4227fec1:j_id1109917403_4227feb3">
<input id="j_id1109917403_4227fec1:j_id1109917403_4227feae" type="submit" value="cancel" name="j_id1109917403_4227fec1:j_id1109917403_4227feae">
</div> 
```

表格和按钮无边距显示。为什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:21:48.000

1.  通过添加一个来测试是否应用了 CSS 规则`background-color`：

    ```
    .marg {
      margin-left: 50px;
      margin-top: 30px;
      background-color: pink;
    } 
    ```

2.  如果是，则添加`!important`到您现有的说明中以进行测试：

    ```
    .marg {
      margin-left: 50px !important;
      margin-top: 30px !important;
      background-color: pink;
    } 
    ```

    1.  在 Firebug/Inspector 中查看应用了哪些规则；如果有许多声明，其中一个具有 !important 修饰符或比其他声明更具体或最后并最终应用。

你的 CSS 应用了吗？有什么`!important`改变吗？你在 Firebug 中看到了什么？如果您仍然有问题，请返回小提琴（无需 CSS 重置！）：HTML 和 CSS 代码可以帮助我们理解您的问题；生成 HTML 的后端代码不会

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:39:32.160

哦，对不起，这是我非常愚蠢的错误。我忘记在 HTML 中添加：

```
<link rel="stylesheet" type="text/css" href="style/myCSS.css"   media="all" /> 
```

我以为我添加了它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-02T21:07:06.540

.marg css 类的 margin-left 设置为 50px，这与属性内部设置为 30px 不同。

# c# - EF：关于跨数据库关系的数据库设计问题

> ID：15179407
> 
> 赞同：2
> 
> 时间：2013-03-02T21:03:06.853
> 
> 标签：c#, entity-framework, database-design, ef-code-first

## 概括

我目前正在原型设计一个（非常简单的？）多租户 Web 应用程序，其中用户（存储在数据库**1**中）可以注册到不同的租户（存储在**每个**租户的数据库中（相同的数据库模式）。我认为的架构适用于很多多租户解决方案。

遗憾的是，我发现 Entity Framework 不支持跨数据库关系（我认为 EF6 仍然是这种情况）。我提供了下面的链接。

接下来的简短部分解释了我的问题，最终解释了我的问题。

## 设计背后的理性

我选择拥有单独的数据库；一份用于用户 (1)，一份用于每个租户及其客户特定信息。这样，用户在加入另一个租户时不必创建新帐户（一个客户可以为不同的部门拥有不同的域）。

## 它是如何实施的

我使用两个不同`DbContext`的 s 来实现这一点，一个用于用户，一个用于租户信息。在`TenantContext`I define `DbSet`s 中，它包含引用`User`实体（导航属性）的实体。

“每个租户”上下文：

```
public class CaseApplicationContext : DbContext, IDbContext
{
    public DbSet<CaseType> CaseTypes { get; set; } 
    public DbSet<Case> Cases { get; set; }

    // left out some irrelevant code
} 
```

`Case`实体：

```
[Table("Cases")]
public class Case : IEntity
{
    public int Id { get; set; }
    public User Owner { get; set; } // <== the navigation property
    public string Title { get; set; }
    public string Description { get; set; }

    public Case()
    {
        Tasks = new List<Task>();
    }
} 
```

`User`实体_

```
[Table("Users")]
public class User : IEntity
{
    public int Id { get; set; }

    public string Name { get; set; }
    public string EmailAddress { get; set; }
    public string Password { get; set; }
} 
```

这个`User`实体也包含在`Users`我的其他 DbContext 衍生数据库中：

```
public class TenantApplicationContext : DbContext, IDbContext
{
    public DbSet<Tenant> Tenants { get; set; }
    public DbSet<User> Users { get; set; } // <== here it is again

    // left out irrelevant code
} 
```

## 现在，出了什么问题？

**预期的：**

我（愚蠢地）**认为**会发生的是我实际上会创建一个跨数据库关系：

“每租户”数据库包含一个表“案例”。此表包含具有“用户 ID”的行。“用户 ID”指的是“用户”数据库。

**实际的：**

当我开始添加`Case`s 时，我还在我的“每个租户”数据库中创建*另一个表“用户”。*在我的“案例”表中，`UserID`指的是同一数据库中的表。

## EF 中不存在跨数据库关系

所以我开始搜索，发现这个功能根本不支持。这让我想，我什至应该将 EF 用于这样的应用程序吗？我应该改用 NHibernate 吗？

但我也无法想象**巨大**市场竟然被微软的实体框架忽略了？！所以我很可能正在做一些相当愚蠢的事情。

## 最后，问题...

我认为主要问题是关于我的“数据库设计”。由于我是 EF 的新手并且边走边学，因此我可能有好几次都走错了方向（我的设计有问题吗？）。由于 EF 专家很好地代表了 SO，我非常渴望了解我可以使用哪些替代方案来实现相同的目标（多租户、共享用户、可在 azure 中部署）。我是否应该使用一个`DbContext`并且仍然能够部署具有共享的多租户 Web 应用程序？`Users`数据库的多租户 Web 应用程序？

我真的很感谢你的帮助！

* * *

学到的东西：

*   NHibernate 确实支持跨数据库关系（但我想部署到 Azure 并坚持使用微软技术）
*   视图或同义词可以作为替代方案（不确定这是否会在 Azure 中造成更多困难）
*   EF 不支持跨数据库关系：
    *   [EF4 跨数据库关系](https://stackoverflow.com/questions/2723917/ef4-cross-database-relationships)
    *   [跨多个数据库的 ADO.Net 实体框架](https://stackoverflow.com/questions/610197/ado-net-entity-framework-across-multiple-databases)
    *   [实体框架4和多数据库](https://stackoverflow.com/questions/2659942/entity-framework-4-and-multiple-database/2788108)
    *   （与 EF 开发人员合作的 msdn 论坛）[http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/cad06147-2168-4c20-ac23-98f32987b126](http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/cad06147-2168-4c20-ac23-98f32987b126)

* * *

*   PS：我意识到这是一个很长的问题。随意编辑问题并删除不相关的部分以提高可读性。
*   PPS：如果需要，我可以分享更多代码

非常感谢你。我很乐意为您的所有努力点赞！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T23:33:58.400

我不太明白你为什么需要跨数据库关系。假设您的应用程序可以与用户数据库和租户数据库这两个数据库进行通信，它可以轻松地使用第一个数据库进行身份验证，然后按照“按名称”约定在租户数据库中查找相关用户。

例如，如果您使用用户数据库对用户 JOHN 进行身份验证，则您在租户数据库中搜索用户 JOHN。

这将更容易实现并且仍然符合您的要求，用户与他们的密码和用户记录的“影子副本”一起存储在用户数据库中，但没有密码存储在租户数据库中，并且这两者之间没有物理关系。

# c++ - 如何在 C++ 中解析 http 请求

> ID：15179409
> 
> 赞同：10
> 
> 时间：2013-03-02T21:03:13.430
> 
> 标签：c++, parsing, http

我正在尝试编写一个处理 GET、POST、HEAD 请求的小型 c++ 网络服务器。我的问题是我不知道如何解析标头、消息正文等。它正在侦听套接字，我什至可以将内容写到浏览器中就好了，但我很好奇我应该如何在 C++ 中做到这一点。

Afaik 一个标准的 GET/POST 请求应该是这样的：

```
GET /index HTTP/1.1
Host: 192.168.0.199:80
Connection: keep-alive
Accept: */*
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.22 (KHTML, like Gecko)     Chrome/25.0.1364.97 Safari/537.22
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3

this is the message body 
```

所有行都以 '\r\n' 结尾。

我是否应该在 '\n' 处拆分请求并修剪它们（如果是这样的话）？另外如何处理帖子数据中的文件？

我想要实现的主要目标是获取包含标题键=> 值对的向量、带有请求方法的字符串、发布数据（如在 PHP 中，如果存在）和查询字符串（例如 /index）作为字符串或由“/”分割的向量。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:06:11.840

在自己做所有事情之前，我向您介绍[Poco](https://pocoproject.org/)：

```
class MyHTTPRequestHandler : public HTTPRequestHandler
{
public:
    virtual void handleRequest(HTTPServerRequest & request,
                               HTTPServerResponse & response) {
        // Write your HTML response in res object
    }
};

class MyRequestHandlerFactory : public HTTPRequestHandlerFactory
{
    MyHTTPRequestHandler handler;

public:
    MyRequestHandlerFactory(){}
    HTTPRequestHandler* createRequestHandler(const HTTPServerRequest& request)
    {
        const string method = request.getMethod();
        if (method == "get" || method == "post")
            return &handler;
        return 0;
    }
};

int main()
{
    HTTPServerParams params;
    params.setMaxQueued(100);
    params.setMaxThreads(16);
    ServerSocket svs(80);
    MyRequestHandlerFactory factory;
    HTTPServer srv(&factory, svs, &params);
    srv.start();
    while (true)
        Thread::sleep(1000);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T15:44:40.080

Boost.Asio 是一个很好的库，但相对低级。你真的很想使用更高级别的库。[**有一个名为node.native**](https://github.com/d5/node.native)[的现代 C++ 库](https://github.com/d5/node.native)**，您应该查看它。一个very server可以实现如下：**

 **```
#include <iostream>
#include <native/native.h>
using namespace native::http;

int main() {
    http server;
    if(!server.listen("0.0.0.0", 8080, [](request& req, response& res) {
        res.set_status(200);
        res.set_header("Content-Type", "text/plain");
        res.end("C++ FTW\n");
    })) return 1; // Failed to run server.

    std::cout << "Server running at http://0.0.0.0:8080/" << std::endl;
    return native::run();
} 
```

没有比这更简单的了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T21:10:51.777

[是的，这基本上只是字符串解析，然后按照规范](http://www.w3.org/Protocols/rfc2616/rfc2616.html)创建返回到浏览器的响应。

但是，如果这不仅仅是一个爱好项目，并且您不想承担非常大的任务，那么您应该使用 Apache，如果您需要一个需要扩展的 Web 服务器，或者[tntnet](http://www.tntnet.org/)，如果您需要一个 C++ Web 框架，或者[cpp-netlib](http://cpp-netlib.org/latest/index.html)如果你需要 C++ 网络的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-19T16:22:08.020

您可能需要考虑[Proxygen](https://github.com/facebook/proxygen)，Facebook 的 C++ HTTP 框架。它是在 BSD 许可下开源的。**

# plist - 如何打开 iCloud CDT 文件

> ID：15179410
> 
> 赞同：3
> 
> 时间：2013-03-02T21:03:17.157
> 
> 标签：plist, icloud, eclipse-cdt

我发现[这个网站](http://mentalfaculty.tumblr.com/post/23231176783/under-the-sheets-with-icloud-and-core-data-how-it)更详细地介绍了 iCloud，它讨论了 .CDT 文件以及如何将它们“解压缩”并作为 .plist 读取。当我遇到 iCloud 问题时，我想我至少可以看到其中的内容并查看上传的内容。

但是，当右键单击 .CDT 文件时，没有解压缩它们的选项，也没有在 Xcode 中打开它们。

感谢您的回复！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T00:13:52.120

它们是 zip 文件，但 cdt 扩展名让 Mac OS X 认为它们是别的东西。你可以

*   将它们复制到某处并将“cdt”扩展名更改为“zip”，或者
*   使用“解压缩”在命令行解压缩它们。

它们包含一个名为“contents”的二进制属性列表文件。

# php - 发送联系表不起作用

> ID：15179411
> 
> 赞同：0
> 
> 时间：2013-03-02T21:03:18.313
> 
> 标签：php

我已经按照发送联系表单的简单教程进行操作，但它似乎不起作用。请有人帮忙。

表格如下：

```
<table width="400" border="0" cellspacing="1" cellpadding="0" align="center">
    <tbody>
        <tr>
            <td>
                <form action="send.php" method="post" name="form1">
                    <table width="100%" border="0" cellspacing="1" cellpadding="3">
                        <tbody>
                            <tr>
                                <td width="16%">Name</td>
                                <td width="2%">:</td>
                                <td width="82%"><input id="Name" type="text" name="Name" size="50" /></td>
                            </tr>
                            <tr>
                                <td>Email</td>
                                <td>:</td>
                                <td><input id="customer_mail" type="text" name="customer_mail" size="50" /></td>
                            </tr>
                            <tr>
                                <td>Subject</td>
                                <td>:</td>
                                <td><input id="Subject" type="text" name="Subject" size="50" /></td>
                            </tr>
                            <tr>
                                <td>Detail</td>
                                <td>:</td>
                                <td><textarea id="detail" cols="50" name="detail" rows="4"></textarea></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><input type="submit" name="Submit" value="Submit" /> <input type="reset" name="Submit2" value="Reset" /></td>
                            </tr>
                        </tbody>
                    </table>
                </form>
            </td>
        </tr>
    </tbody>
</table> 
```

这是我的PHP：

```
<?php
    $to ='kirsty.harris1985@gmail.com';

    $header="from: $name <$mail_from>";

    $mail_from="$customer_mail";
    $Subject="$Subject";
    $detail="$detail";

    $send_contact=mail($to,$header,$Subject,$detail);

    if($send_contact){
        echo "We've recived your contact information";
    } else {
        echo "ERROR";
    }
?> 
```

这是错误：

[服务器错误网站在检索http://nqmedia.co.uk/send_contact.php](http://nqmedia.co.uk/send_contact.php)时遇到错误。它可能因维护而停机或配置不正确。以下是一些建议： 稍后重新加载此网页。HTTP 错误 500（内部服务器错误）：服务器尝试完成请求时遇到意外情况。

该网站也是 www.nqmedia.co.uk 供人们查看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:08:24.993

将您的 PHP 更改为以下内容：

```
<?php
    $to ='kirsty.harris1985@gmail.com';
    $name = $_POST['name'];
    $customer_mail = $_POST['customer_mail'];
    $Subject = $_POST['Subject'];
    $detail = $_POST['detail'];

    $header="From: $name <$customer_mail>";

    $send_contact=mail($to,$Subject,$detail,$header);

    if($send_contact){
        echo "We've recived your contact information";
    } else {
        echo "ERROR";
    }

?> 
```

1.  没有正确定义变量，您需要使用`$_POST`它从表单中检索值。

2.  `$mail_from`(now `$customer_mail`) 在定义之前使用。

3.  函数中使用的参数`mail()`顺序错误。看[http://php.net/manual/en/function.mail.php](http://php.net/manual/en/function.mail.php)

4.  检查`action`表单上的属性。它说“send.php”，但错误显示“send_contact.php”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:13:37.207

鉴于您的输入已相应命名，请尝试以下操作：

```
$name = $_POST['Name'];
$mail_from = $_POST['customer_mail'];
$header = "from: $name <$mail_from>";
$Subject = $_POST['Subject'];
$detail = $_POST['detail']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T21:14:59.723

你从来没有真正抓住所有的帖子价值。

将此作为 send.php 的代码：

```
<?php 
$name = $_POST['Name'];
$mail_from = $_POST['customer_mail'];
$subject = $_POST['Name'];
$body = $_POST['detail'];

$to ='kirsty.harris1985@gmail.com';

$header="from: $name <$mail_from>";

$send_contact=mail($to,$Subject,$body,$header);

if($send_contact){
echo "We've received your contact information";
}
else {
echo "ERROR";
}
?> 
```

此外，您在回声中拼写错误“received”，所以我修正了拼写错误。

# numpy - numpy 数组赋值

> ID：15179416
> 
> 赞同：1
> 
> 时间：2013-03-02T21:03:54.347
> 
> 标签：numpy, python-2.7

从技术上讲有什么区别

```
import numpy as np
a = np.random.random((100,3))
b = numpy.empty((100))

# what the difference between
b = a[:,0]
# and
b[:] = a[:,0] 
```

我之所以要求我使用 fortran 编译函数读取 b 并且 b 中的切片产生了很大的不同。这与 C 和 fortran 之间的列和行读取样式有关。在默认的 numpy 约定中是 C 的约定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T21:05:31.870

主要区别在于

```
b = a[:,0] 
```

在 的数据上创建一个视图`a`，而

```
b[:] = a[:,0] 
```

制作数据的副本。

前者使用与 相同的内存布局`a`，而后者保留原始的内存布局`b`。特别是这意味着在后一种情况下，所有数据都被压缩到连续的内存位置：

```
In [29]: b = numpy.empty((100))

In [30]: b = a[:,0]

In [31]: b.strides
Out[31]: (24,)

In [32]: b = numpy.empty((100))

In [33]: b[:] = a[:,0]

In [34]: b.strides
Out[34]: (8,) 
```

# sql - “<>”的 SQL 运算符名称是什么？

> ID：15179419
> 
> 赞同：43
> 
> 时间：2013-03-02T21:04:11.417
> 
> 标签：sql, operators

我很困惑，在谷歌中没有找到。谁能告诉我什么是`Sql <>`运营商名称？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2013-03-02T21:05:43.210

`<>`不等于，等于`!=`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-02T21:05:49.520

这是“不相等”。查看您正在使用的数据库的运算符列表，并找到适当的部分（通常是“比较运算符”）。例如：

*   [SQL 服务器](http://msdn.microsoft.com/en-us/library/ms176020.aspx)
*   [MySQL](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_not-equal)
*   [甲骨文](http://docs.oracle.com/html/A95915_01/sqopr.htm#i1004774)
*   [Postgres](http://www.postgresql.org/docs/9.2/static/functions-comparison.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-02T21:05:50.827

它是`not equals`运营商。用法：

```
select *  
from table
where foo <> 0 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-02T21:06:15.463

它是 Not Equal 运算符，但由于我还没有输入足够的字符，所以我必须很详细才能发布我的答案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-06T12:01:00.350

`<>`表示不等于`!=`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-22T18:02:34.137

检查两个操作数的值是否相等，如果值不相等则条件为真。(a <> b) 或 (a != b) 为真。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-02T19:50:42.740

这是答案——从技术上讲，!= 和 <> 之间没有区别。它们都以相同的方式工作，并且在性能或结果方面绝对没有区别。如果 != 和 <> 都相同，那么在 SQL 查询中应该使用哪一个？

您可以在查询中使用 != 或 <> 两者在技术上相同，但我更喜欢使用 <> 因为这是 SQL-92 标准。

# oop - NHibernate 无法解析继承属性的属性

> ID：15179421
> 
> 赞同：3
> 
> 时间：2013-03-02T21:04:30.480
> 
> 标签：oop, nhibernate, nhibernate-mapping

为什么 NHibernate 不能访问从抽象基类继承的属性。当我尝试`QueryOver`在`Where`子句中使用属性时，我得到

> 无法解析属性：ID：TheWorkshop.Web.Models.Customer

```
var customer = Session.QueryOver<Customer>()
                      .Where(c=>c.ID ==id)
                      .SingleOrDefault<Customer>(); 
```

Intelisense 帮助我构建查询并编译解决方案，因此类上**有**一个`ID`属性`Customer`。Customer的`ID`属性继承自抽象`Contact`类，抽象类又继承自`DomainEntity<T>`暴露受保护字段的 a。

```
public abstract class DomainEntity<T>
{
    protected Guid _persistenceId;
    //... 
}

public abstract class Contact : DomainEntity<Contact>
{
    public virtual Guid ID
    {
        get { return _persistenceId; }
    }

    public virtual Address Address
    {
        get { return _address; }
        set { _address = value; }
    }

    //... 
} 
```

并在映射文件中

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" 
                   assembly="TheWorkshop.Web" 
                   namespace="TheWorkshop.Web.Models" 
                   default-access="field.camelcase-underscore" 
                   default-lazy="true">
    <class name="Contact" table="Contacts" abstract="true">
        <id name="_persistenceId" column="ID" type="Guid" access="field" 
            unsaved-value="00000000-0000-0000-0000-000000000000">
        <generator class="guid.comb" />
        </id>
        <!-- ... -->
        <union-subclass name="Customer" table="Customers"> 
```

在[回答了一个类似问题](https://stackoverflow.com/a/14777221/96505)后，我更新为`NHibernate 3.3.3-CR1`from`NHibernate 3.3.2.4000`但我仍然遇到同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T16:40:34.907

问题是 NHibernate 无法从我的映射中推断出如何解析 ID 属性。因此，尽管类编译得很好并且`_persistenceId`抽象基类上的属性可以通过`getter`实现类上的 a 访问，但由于名称不匹配，`_persistenceId`NHibernate`ID`无法遵循这一点。

（更简单的）解决方案是更改我的名字以匹配。有一个更难的解决方案涉及实现[IProperyAccessor](http://elliottjorgensen.com/nhibernate-api-ref/NHibernate.Property/IPropertyAccessor.html)、[IGetter](http://elliottjorgensen.com/nhibernate-api-ref/NHibernate.Property/IGetter.html)和[ISetter](http://elliottjorgensen.com/nhibernate-api-ref/NHibernate.Property/ISetter.html)接口，以便提供传递字符串的路径`ID`，以便使用`ClassName` [访问策略](http://nhforge.org/doc/nh/en/index.html#mapping-declaration-property)。

两种解决方案中较简单的只是重命名`_persistenceId`为`_id`（并更新对它的所有引用）所以

```
<id name="_persistenceId" column="ID" type="Guid" access="field" 
    unsaved-value="00000000-0000-0000-0000-000000000000"> 
```

变成

```
<id name="Id" column="Id" type="Guid" 
    unsaved-value="00000000-0000-0000-0000-000000000000"> 
```

**注意**我还能够删除`access="field"`更新的 id 映射

# c# - “访问路径 'a-guid.8Event' 被拒绝。” 启动时

> ID：15179426
> 
> 赞同：3
> 
> 时间：2013-03-02T21:04:51.093
> 
> 标签：c#, .net, winforms, exception

我有一个免费分发的 C# WinForms 应用程序。我设置了一个最小崩溃服务器，这样当实例崩溃时，我会收到堆栈跟踪和一些硬件详细信息。我的一些用户遇到了我无法复制的崩溃，我也无法在线找到解决方案（稍后会介绍）。

异常类型是：**System.UnauthorizedAccessException** 顺便说一句：我的应用程序不需要是管理员，可以由普通用户运行。

异常消息（英文，我也有其他三种语言）是：

> 拒绝访问路径“6cbb4993-b127-4668-937e-f64c83b6e6b30.8Event”。

如您所见，路径根本不像路径，它更像是一个向导。guid 不会改变，所有用户都一样。我怀疑它以某种方式绑定到我的应用程序，但我无法在文件系统或注册表中找到这样的值。

堆栈跟踪是：

> 在 System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
> 在 System.Threading.EventWaitHandle..ctor(Boolean initialState, EventResetMode 模式, String name, Boolean& createdNew, EventWaitHandleSecurity eventSecurity)
> 在 Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Run (String[] commandLine)
> 在 VisualSEO.WinFormGui.Program.Main(String[] args)

一些遇到问题的用户看起来他们后来成功启动了程序（他们很友好地与我联系，但无法告诉我如何重现问题），其他人没有（我没有与他们直接联系，因为我不要求注册才能使用该程序，所以我不能问他们，但我知道他们没有再次启动它，因为我使用硬件标识符跟踪更新请求）。

当然，我做了功课并在网上搜索。我发现的唯一类似的事情是：

在专家交流（我无法发布网址）上，我遇到了类似错误消息和不同 guid 的问题。他使用的是 Windows XP，并写道“重新启动解决了问题”。我的一些用户 - 正如我所说 - 成功地重新启动，但这不是“解决方案”。作为记录，到目前为止，受影响的用户具有以下操作系统：

*   Win7 SP1
*   WinServer 2088 标准 SP2
*   Win8

在这里他们有一个类似的[错误消息](https://code.google.com/p/siren-of-shame/issues/detail?id=13)
他们是一个开源项目，我也可以看到 [他们所做的修复他们](https://code.google.com/p/siren-of-shame/source/diff?spec=svnea9491b9e5b4bba3d7b70a01662ff73c035065e5&name=ea9491b9e5b4&r=ea9491b9e5b4bba3d7b70a01662ff73c035065e5&format=side&path=/SirenOfShame/Program.cs)
的修复很遗憾只是一个实施得很糟糕的解决方法：他们假设语言总是英语（在我的情况下，我之前总是将文化线程设置为英语记录 exception.Message，但它仅在用户安装还安装了英文词典时才有效，并且在许多情况下它们没有）而且他们的诊断对我的情况没有帮助：他们认为问题是由他们的另一个实例引起的客户端已经在另一个用户帐户中运行（在他们的情况下可能是正确的）；我测试了它，这不是我的情况。

我找不到根本原因。我的想法不多了。过去有没有人解决过类似的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:50:38.873

您的问题被标记为 C#，但例外似乎是 VB。那是对的吗？

我在程序启动时看到了类似的异常（不同的 guid），我使用[Process Monitor](http://technet.microsoft.com/en-gb/sysinternals/bb896645.aspx)来查找违规者。在我的例子中，它涉及 CLR 访问被最终用户的防病毒软件阻止的注册表项。

# javascript - 如何增加 span 元素内的文本

> ID：15179427
> 
> 赞同：0
> 
> 时间：2013-03-02T21:04:56.627
> 
> 标签：javascript, jquery, html, twitter-bootstrap

我有一个使用 twitter bootstrap 的类似链接。

```
 <a href="#"><i class="icon-thumbs-up"></i></a><span class="badge">${fn:length(page.likes)}</span>

  When the user clicks on like link the value within the span should be incremented. 
```

由于我对每条评论都有一个赞按钮，因此我不知道如何从单个 javascript 执行此任务，因为我如何确定要更新哪个跨度。

还有一件事我有这个like按钮作为带有href="#"的超链接。所以页面跳到顶部eveytime 我点击了like 链接。知道如何解决问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T21:17:08.693

对于您的第二个问题，您可以使用 `<a href="javascript:void(0)">`

对于第一个问题，你的like按钮在哪里？您始终可以为每个跨度分配一个唯一的 id，然后单击类似按钮，您可以使用： `document.getElementById("spanUiqueId").innerHTML = parseInt(document.getElementById("spanUiqueId").innerHTML)+1;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T21:45:19.403

对于您现有的 dom 结构，只需

```
$('.icon-thumbs-up').parent('a').click(function() {
     var count = parseInt($('badge').text())+1;
     $('badge').text(count);
} 
```

如果您想为 a 提供 id 或类，则将 $('.icon-thumbs-up').parent('a') 替换为任何新的选择器

这里需要说明两点：

**首先**： parseInt 确保传递数字以进行增量，这是推荐的方式，因为这可能会在 js 中创建静默错误，传递计数器的错误值 tu 文本并破坏您的页面

**第二：**我使用 +1 而不是 ++，因为 ++ 和 -- 往往不稳定，这取决于很多事情，所以我从不使用它们或只在 for 循环中使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T21:19:27.953

您可以为此使用[jQuery](http://jquery.com/)：

使`<a>`标签有一个类，例如“likeLink”：

```
<a class="likeLink" href="#"><i class="icon-thumbs-up"></i></a><span class="badge">${fn:length(page.likes)}</span>
<script>
$("a.likeLink").click(function() {
    $(this).next().text($(this).next().text()+1);
});
</script> 
```

`$(this).next()`获取元素的下一个兄弟元素，在本例中为`<span>`.

对于你的第二个问题，你想让like按钮做什么？如果您只是希望它显示为链接，则可以更改链接的“href”属性：

```
<a href="javascript:void('0')"> 
```

这不会做任何事情，但保持链接。

# java - 如何使用 Java 从 UUID 中提取日期？

> ID：15179428
> 
> 赞同：18
> 
> 时间：2013-03-02T21:05:04.333
> 
> 标签：java, date, uuid

如何转换`UUID`为日期格式`2011-04-22`？

例如，我有这样的 UUID

```
118ffe80-466b-11e1-b5a5-5732cf729524. 
```

如何将其转换为日期格式？

我试过

```
 String uuid="118ffe80-466b-11e1-b5a5-5732cf729524"; 
    UUID uid = UUID.fromString(uuid);
    long ls=convertTime(uid.timeStamp()); // it returns long value

    public String convertTime(long time){
            System.out.println("====="+time);
            Date date = new Date(time);
            Format format = new SimpleDateFormat("yyyy/MM/dd");
            return format.format(date).toString();
        } 
```

**我得到的输出：4294744/11/02**

**对于 perl，同样的情况下工作正常**

```
$uuid='ef802820-46b3-11e2-bf3a-47ef6b3e28e2';
$uuid =~ s/-//g;

my $timelow = hex substr( $uuid, 2 * 0,     2 * 4 );
my $timemid = hex substr( $uuid, 2 * 4,     2 * 2 );
my $version = hex substr( $uuid, 2 * 6,     1 );
my $timehi  = hex substr( $uuid, 2 * 6 + 1, 2 * 2 - 1 );

my $time = ( $timehi * ( 2**16 ) + $timemid ) * ( 2**32 ) + $timelow;
my $epoc = int( $time / 10000000 ) - 12219292800;
my $nano = $time - int( $time / 10000000 ) * 10000000;

#$time_date = scalar localtime $epoc;
#print strftime( '%d-%m-%Y %H:%M:%S', localtime($epoc) );
#print "\n Time: ", scalar localtime $epoc, " +", $nano / 10000, "ms\n"; 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-02T21:14:35.300

javadoc for[`UUID`](http://docs.oracle.com/javase/7/docs/api/java/util/UUID.html#timestamp%28%29)对时间戳字段进行了以下说明：

> 60 位时间戳值由该 UUID 的 time_low、time_mid 和 time_hi 字段构成。生成的时间戳**从 UTC 1582 年 10 月 15 日午夜开始以 100 纳秒为单位**进行测量。

（强调我的）

Java 时间戳从 1970-01-01 开始以毫秒为单位。为了从 UUID 中获得有意义的日期，您需要做两件事：从 100ns 转换为 1ms 精度（除以 10000）和从 1582-10-15 变基到 1970-01-01，您可以这样做通过添加一个常数值。

[WolframAlpha 告诉我们](http://www.wolframalpha.com/input/?i=convert+1582-10-15+UTC+to+unix+time)1582-10-15 对应于 UNIX 时间戳`-12219292800`，因此要获得正确的日期，您必须加上`12219292800`除以 10000 后得到的毫秒数。

作为旁注：

> 时间戳值仅在基于时间的 UUID 中有意义，其版本类型为 1。如果此 UUID 不是基于时间的 UUID，则此方法将引发 UnsupportedOperationException。

...因此请确保您的代码要么只遇到类型 1 UUID，要么可以处理它们没有时间戳。

# c++ - 我有两个 GPU，我怎样才能让一个做某些 CUDA 任务？

> ID：15179430
> 
> 赞同：4
> 
> 时间：2013-03-02T21:05:11.263
> 
> 标签：c++, cuda, gpu, nvidia

CUDA 新手，但有一些时间花在计算上，我在家里有 geforces，在办公室有 tesla（同一代）。

在家里，我在同一台计算机上安装了两个 gpus，一个是 GK110（计算能力 3.5），另一个是 GF110（计算能力 2.0），我更喜欢将 GK110 仅用于计算任务，将 GF110 用于显示，除非我告诉它这样做计算，有没有办法通过驱动程序设置来做到这一点，或者我仍然需要重写我的一些代码？

另外，如果我理解正确，如果GK110的显示端口没有连接，那么烦人的windows超时检测即使计算时间很长也不会尝试重置它？

顺便说一句，我的 CUDA 代码是使用 compute_35 和 compute20 编译的，因此代码可以在两个 GPU 上运行，但是我计划使用 GK110 独有的功能，因此将来的代码可能根本无法在 GF110 上运行，操作系统是windows 7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T23:48:27.427

在 Windows 上使用 GeForce GTX Titan（或任何 GeForce 产品），我认为没有办法阻止 GPU 在 WDDM 模式下出现在系统中，这意味着 Windows 将在其上构建显示驱动程序堆栈，甚至如果该卡没有附加物理显示器。所以你可能会被windows TDR机制卡住。您可以尝试对其进行试验以确认这一点。（Windows TDR 行为可以通过注册表黑客来修改）。

关于将 CUDA 任务转向 GTX Titan，显示驱动程序控制面板应该有一个可选设置。它可能位于“管理 3D 设置”区域或其他区域，具体取决于您拥有的驱动程序。当您找到适当的设置区域时，将出现一个名为 CUDA - GPU 之类的选项，可能会设置为“全部”。如果您将“全局预设”选项更改为“基本配置文件”，您应该能够更改此 CUDA-GPU 设置。单击它应该为您选择“全部”或检测到的每个 GPU 的一组复选框。如果取消选中 GF110 设备并选中 GK110 设备，则应根据此复选框选择将未通过 cudaSetDevice() 选择特定 GPU 的 CUDA 程序引导到 GK110 设备。

除此之外，正如评论中提到的，使用编程方法，您始终可以查询设备属性，然后选择将自身报告为 cc3.5 设备的设备。

# java - 随机点的平面图

> ID：15179441
> 
> 赞同：0
> 
> 时间：2013-03-02T21:06:25.050
> 
> 标签：java, algorithm, graph, planar-graph

我正在尝试创建一个在点之间具有尽可能多的直边的图形，而不允许任何边在 Java 中相交。基本上，我正在尝试制作一个带有随机点数的平面图。当给定一个已经有边的图时，我有点理解如何检测平面图，但我对如何从随机节点实际创建平面图感到困惑。想到的唯一方法是随机创建图表然后测试它们，但这似乎非常低效。

谢谢

# bash - 为什么我的 Bash 代码在我使用 'sh' 运行时会失败？

> ID：15179446
> 
> 赞同：36
> 
> 时间：2013-03-02T21:06:58.720
> 
> 标签：bash, sh, substitution

我有一行代码在我的终端中运行良好：

```
for i in *.mp4; do echo ffmpeg -i "$i" "${i/.mp4/.mp3}"; done 
```

然后我将完全相同的代码行放入脚本中`myscript.sh`：

```
#!/bin/sh
for i in *.mp4; do echo ffmpeg -i "$i" "${i/.mp4/.mp3}"; done 
```

但是，现在运行它时出现错误：

```
$ sh myscript.sh
myscript.sh: 2: myscript.sh: Bad substitution 
```

基于其他问题，我尝试将[shebang](https://en.wikipedia.org/wiki/Shebang_(Unix))更改为`#!/bin/bash`，但我得到了完全相同的错误。为什么我不能运行这个脚本？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-03-03T12:28:28.347

TL;DR：由于您使用的是 Bash 特定功能，因此您的脚本必须使用 Bash 而不是`sh`：

```
$ sh myscript.sh
myscript.sh: 2: myscript.sh: Bad substitution

$ bash myscript.sh
ffmpeg -i bar.mp4 bar.mp3
ffmpeg -i foo.mp4 foo.mp3 
```

请参阅*[sh 和 Bash 之间的区别](https://stackoverflow.com/questions/5725296/difference-between-sh-and-bash)*。要找出您正在使用的 sh `readlink -f $(which sh)`：.

### 确保 bash 特定脚本始终正确运行的最佳方法

最佳做法*是*：

1.  替换`#!/bin/sh`为`#!/bin/bash`（或您的脚本所依赖的任何其他 shell）。
2.  `./myscript.sh`使用or运行此脚本（以及所有其他脚本！）`/path/to/myscript.sh`，不带前导`sh`or `bash`。

这是一个例子：

```
$ cat myscript.sh
#!/bin/bash
for i in *.mp4
do
  echo ffmpeg -i "$i" "${i/.mp4/.mp3}"
done

$ chmod +x myscript.sh   # Ensure script is executable

$ ./myscript.sh
ffmpeg -i bar.mp4 bar.mp3
ffmpeg -i foo.mp4 foo.mp3 
```

（相关：[为什么 ./ 在脚本前面？](https://stackoverflow.com/questions/6331075/why-do-you-need-dot-slash-before-executable-or-script-name-to-run-it-in-bas)）

### 的意思`#!/bin/sh`

shebang 建议系统应该使用哪个 shell 来运行脚本。这使您可以指定`#!/usr/bin/python`或`#!/bin/bash`不必记住哪个脚本是用什么语言编写的。

人们`#!/bin/sh`只使用一组有限的功能（由 POSIX 标准定义）以实现最大的可移植性。`#!/bin/bash`非常适合利用有用 bash 扩展的用户脚本。

`/bin/sh`通常符号链接到最小的 POSIX 兼容 shell 或标准 shell（例如 bash）。即使在后一种情况下，`#!/bin/sh`也可能会失败，因为`bash`它将在[手册页](http://linux.die.net/man/1/bash)中解释的兼容模式下运行：

> 如果使用名称 sh 调用 bash，它会尝试尽可能地模仿 sh 的历史版本的启动行为，同时也符合 POSIX 标准。

### 的意思`sh myscript.sh`

shebang 仅在您运行`./myscript.sh`,`/path/to/myscript.sh`或删除扩展名时使用，将脚本放在您的目录中`$PATH`，然后运行`myscript`​​.

如果您明确指定解释器，则将使用该解释器。无论shebang说什么，`sh myscript.sh`都会强制它运行。`sh`这就是为什么仅仅改变 shebang 是不够的。

您应该始终使用其首选解释器运行脚本，因此`./myscript.sh`无论何时执行任何脚本时都应首选或类似。

### 对脚本的其他建议更改：

*   引用变量（`"$i"`而不是`$i`）被认为是一种很好的做法。如果存储的文件名包含空格字符，带引号的变量将防止出现问题。
*   我喜欢你使用高级[参数扩展](http://linux.die.net/man/1/bash)。我建议使用`"${i%.mp4}.mp3"`（而不是`"${i/.mp4/.mp3}"`），因为`${parameter%word}`仅在末尾替换（例如名为 的文件`foo.mp4.backup`）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-03T17:18:57.457

该`${var/x/y/}`构造不是 POSIX。在*您的*情况下，您只需在变量末尾删除一个字符串并附加另一个字符串，便携式 POSIX 解决方案是使用

```
#!/bin/sh
for i in *.mp4; do
    ffmpeg -i "$i" "${i%.mp4}.mp3"
done 
```

甚至更短，`ffmpeg -i "$i" "${i%4}3"`.

这些构造的最终决定是关于[POSIX shell 的参数扩展](http://pubs.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html#tag_02_06_02)一章。

# php - 您如何保护 API 密钥和第 3 方站点凭据 (LAMP)？

> ID：15179447
> 
> 赞同：12
> 
> 时间：2013-03-02T21:06:59.673
> 
> 标签：php, mysql, api, credentials, api-key

我正在创建一个站点，该站点将使用其他 3rd 方站点的 ID、密码和 API 密钥 - 以便服务器相应地访问信息。出于本次对话的目的，我们假设它用于支付网关——这意味着暴露存储在数据库中的这些信息可能意味着恶意用户可以从其凭据被泄露的账户中提取现金。

不幸的是，这不像密码/散列情况，因为用户不是每次都输入凭据 - 他们输入*一次*，然后将其保存在服务器上以供应用程序将来使用。

我能想到的唯一合理的方法（这将是一个 MySQL/PHP 应用程序）是通过 PHP 应用程序中的硬编码“密码”来加密凭据。这里唯一的好处是，如果恶意用户/黑客获得了对数据库的访问权，但没有获得 PHP 代码，他们仍然一无所有。话虽如此，这对我来说似乎毫无意义，因为我认为我们可以合理地假设，如果黑客得到其中一个，他们就会得到一切——对吧？

如果社区决定了一些好的解决方案，最好收集其他来源的示例/教程/更深入的信息，以便将来可以为每个人实施。

我很惊讶我没有在堆栈上看到这个问题有任何好的答案。我确实找到了这个，但在我的情况下，这并不适用：[我应该如何在道德上处理用户密码存储以便以后进行明文检索？](https://stackoverflow.com/questions/2283937/how-should-i-ethically-approach-user-password-storage-for-later-plaintext-retrie)

谢谢大家。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-11T11:37:27.867

根据我在问题、答案和评论中看到的内容；我建议利用 OpenSSL。这是假设您的站点需要定期访问此信息（这意味着可以安排）。正如你所说：

> 服务器将需要此信息来为各种情况发送付款。它不需要所述密钥的“所有者”登录，事实上，一旦他们第一次提供它们，所有者可能再也不想看到它们了。

正是来自此评论，并且可以将访问要存储的数据的假设放在 cron 作业中。进一步假设您的服务器上有 SSL (https)，​​因为您将处理机密的用户信息，并且有可用的`OpenSSL`和`mcrypt`模块。此外，关于“如何”实现它，以下内容将是相当通用的，但并不是根据您的情况执行此操作的详细信息。还应注意，此“操作方法”是一般性的，您应该在实施之前进行更多研究。话虽如此，让我们开始吧。

首先，我们来谈谈 OpenSSL 提供了什么。OpenSSL 为我们提供了[公钥密码术](http://en.wikipedia.org/wiki/Public_key)：使用公钥加密数据的能力（如果泄露，不会损害用它加密的数据的安全性。）其次，它提供了一种使用公钥访问该信息的方法'私钥。由于我们不关心创建证书（我们只需要加密密钥），因此可以通过一个简单的函数（您只会使用一次）获得这些证书：

```
function makeKeyPair()
{
    //Define variables that will be used, set to ''
    $private = '';
    $public = '';
    //Generate the resource for the keys
    $resource = openssl_pkey_new();

    //get the private key
    openssl_pkey_export($resource, $private);

    //get the public key
    $public = openssl_pkey_get_details($resource);
    $public = $public["key"];
    $ret = array('privateKey' => $private, 'publicKey' => $public);
    return $ret;
} 
```

现在，您有一个*公钥*和*私钥*。保护私钥，使其远离您的服务器，并将其远离数据库。将其存储在另一台服务器上，一台可以运行 cron 作业的计算机等上。除非您每次需要处理付款并使用 AES 加密或其他东西加密私钥时都可以要求管理员在场，否则就离公众视线很远相似的。但是，公钥将被硬编码到您的应用程序中，并且每次用户输入要存储的信息时都会使用。

接下来，您需要确定计划如何验证解密数据（这样您就不会开始向支付 API 发送无效请求。）我将假设需要存储多个字段，并且我们只想要加密一次，它将在一个可以[序列化的 PHP 数组中](http://www.php.net/manual/en/function.serialize.php)'d。根据需要存储的数据量，我们可以直接对其进行加密，也可以生成密码以使用公钥进行加密，然后使用该随机密码对数据本身进行加密。我将在解释中走这条路线。要走这条路，我们将使用 AES 加密，并且需要一个方便的加密和解密功能 - 以及一种为数据随机生成体面的一次性填充的方法。我将提供我使用的密码生成器，虽然我是从我不久前编写的代码中移植它的，但它可以达到目的，或者您可以编写一个更好的。^^

```
public function generatePassword() {
    //create a random password here
    $chars = array( 'a', 'A', 'b', 'B', 'c', 'C', 'd', 'D', 'e', 'E', 'f', 'F', 'g', 'G', 'h', 'H', 'i', 'I', 'j', 'J',  'k', 'K', 'l', 'L', 'm', 'M', 'n', 'N', 'o', 'O', 'p', 'P', 'q', 'Q', 'r', 'R', 's', 'S', 't', 'T',  'u', 'U', 'v', 'V', 'w', 'W', 'x', 'X', 'y', 'Y', 'z', 'Z', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0', '?', '<', '>', '.', ',', ';', '-', '@', '!', '#', '$', '%', '^', '&', '*', '(', ')');

    $max_chars = count($chars) - 1;
    srand( (double) microtime()*1000000);

    $rand_str = '';
    for($i = 0; $i < 30; $i++)
    {
            $rand_str .= $chars[rand(0, $max_chars)];
    }
    return $rand_str;

} 
```

这个特定的函数将生成 30 位数字，这提供了不错的熵 - 但您可以根据需要对其进行修改。接下来，做AES加密的函数：

```
/**
 * Encrypt AES
 *
 * Will Encrypt data with a password in AES compliant encryption.  It
 * adds built in verification of the data so that the {@link this::decryptAES}
 * can verify that the decrypted data is correct.
 *
 * @param String $data This can either be string or binary input from a file
 * @param String $pass The Password to use while encrypting the data
 * @return String The encrypted data in concatenated base64 form.
 */
public function encryptAES($data, $pass) {
    //First, let's change the pass into a 256bit key value so we get 256bit encryption
    $pass = hash('SHA256', $pass, true);
    //Randomness is good since the Initialization Vector(IV) will need it
    srand();
    //Create the IV (CBC mode is the most secure we get)
    $iv = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), MCRYPT_RAND);
    //Create a base64 version of the IV and remove the padding
    $base64IV = rtrim(base64_encode($iv), '=');
    //Create our integrity check hash
    $dataHash = md5($data);
    //Encrypt the data with AES 128 bit (include the hash at the end of the data for the integrity check later)
    $rawEnc = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $pass, $data . $dataHash, MCRYPT_MODE_CBC, $iv);
    //Transfer the encrypted data from binary form using base64
    $baseEnc = base64_encode($rawEnc);
    //attach the IV to the front of the encrypted data (concatenated IV)
    $ret = $base64IV . $baseEnc;
    return $ret;
} 
```

（我最初编写这些函数是为了作为类的一部分，并建议您将它们实现到您自己的类中。）此外，使用此函数可以很好地使用创建的一次性便笺簿，但是，如果与不同应用程序的用户特定密码，您肯定需要在密码中添加一些盐。接下来，解密并验证解密后的数据是否正确：

```
/**
 * Decrypt AES
 *
 * Decrypts data previously encrypted WITH THIS CLASS, and checks the
 * integrity of that data before returning it to the programmer.
 *
 * @param String $data The encrypted data we will work with
 * @param String $pass The password used for decryption
 * @return String|Boolean False if the integrity check doesn't pass, or the raw decrypted data.
 */
public function decryptAES($data, $pass){
    //We used a 256bit key to encrypt, recreate the key now
    $pass = hash('SHA256', $this->salt . $pass, true);
    //We should have a concatenated data, IV in the front - get it now
    //NOTE the IV base64 should ALWAYS be 22 characters in length.
    $base64IV = substr($data, 0, 22) .'=='; //add padding in case PHP changes at some point to require it
    //change the IV back to binary form
    $iv = base64_decode($base64IV);
    //Remove the IV from the data
    $data = substr($data, 22);
    //now convert the data back to binary form
    $data = base64_decode($data);
    //Now we can decrypt the data
    $decData = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $pass, $data, MCRYPT_MODE_CBC, $iv);
    //Now we trim off the padding at the end that php added
    $decData = rtrim($decData, "\0");
    //Get the md5 hash we stored at the end
    $dataHash = substr($decData, -32);
    //Remove the hash from the data
    $decData = substr($decData, 0, -32);
    //Integrity check, return false if it doesn't pass
    if($dataHash != md5($decData)) {
        return false;
    } else {
        //Passed the integrity check, give use their data
        return $decData;
    }
} 
```

查看这两个函数，阅读评论等。弄清楚它们的作用以及它们是如何工作的，这样你就不会错误地实现它们。现在，加密用户数据。我们将使用公钥对其进行加密，并且以下函数假定到目前为止（以及将来）的每个函数都在同一个类中。我将同时提供 OpenSSL 加密/解密功能，因为稍后我们将需要第二个功能。

```
/**
 * Public Encryption
 *
 * Will encrypt data based on the public key
 *
 * @param String $data The data to encrypt
 * @param String $publicKey The public key to use
 * @return String The Encrypted data in base64 coding
 */
public function publicEncrypt($data, $publicKey) {
    //Set up the variable to get the encrypted data
    $encData = '';
    openssl_public_encrypt($data, $encData, $publicKey);
    //base64 code the encrypted data
    $encData = base64_encode($encData);
    //return it
    return $encData;
}

/**
 * Private Decryption
 *
 * Decrypt data that was encrypted with the assigned private
 * key's public key match. (You can't decrypt something with
 * a private key if it doesn't match the public key used.)
 *
 * @param String $data The data to decrypt (in base64 format)
 * @param String $privateKey The private key to decrypt with.
 * @return String The raw decoded data
 */
public function privateDecrypt($data, $privateKey) {
    //Set up the variable to catch the decoded date
    $decData = '';
    //Remove the base64 encoding on the inputted data
    $data = base64_decode($data);
    //decrypt it
    openssl_private_decrypt($data, $decData, $privateKey);
    //return the decrypted data
    return $decData;
} 
```

这些`$data`总是一次性的，而不是用户信息。接下来，结合一次性密钥的公钥加密和AES进行加密和解密的功能。

```
/**
 * Secure Send
 *
 * OpenSSL and 'public-key' schemes are good for sending
 * encrypted messages to someone that can then use their
 * private key to decrypt it.  However, for large amounts
 * of data, this method is incredibly slow (and limited).
 * This function will take the public key to encrypt the data
 * to, and using that key will encrypt a one-time-use randomly
 * generated password.  That one-time password will be
 * used to encrypt the data that is provided.  So the data
 * will be encrypted with a one-time password that only
 * the owner of the private key will be able to uncover.
 * This method will return a base64encoded serialized array
 * so that it can easily be stored, and all parts are there
 * without modification for the receive function
 *
 * @param String $data The data to encrypt
 * @param String $publicKey The public key to use
 * @return String serialized array of 'password' and 'data'
 */
public function secureSend($data, $publicKey)
{
    //First, we'll create a 30digit random password
    $pass = $this->generatePassword();
    //Now, we will encrypt in AES the data
    $encData = $this->encryptAES($data, $pass);
    //Now we will encrypt the password with the public key
    $pass = $this->publicEncrypt($pass, $publicKey);
    //set up the return array
    $ret = array('password' => $pass, 'data' => $encData);
    //serialize the array and then base64 encode it
    $ret = serialize($ret);
    $ret = base64_encode($ret);
    //send it on its way
    return $ret;
}

/**
 * Secure Receive
 *
 * This is the complement of {@link this::secureSend}.
 * Pass the data that was returned from secureSend, and it
 * will dismantle it, and then decrypt it based on the
 * private key provided.
 *
 * @param String $data the base64 serialized array
 * @param String $privateKey The private key to use
 * @return String the decoded data.
 */
public function secureReceive($data, $privateKey) {
    //Let's decode the base64 data
    $data = base64_decode($data);
    //Now let's put it into array format
    $data = unserialize($data);
    //assign variables for the different parts
    $pass = $data['password'];
    $data = $data['data'];
    //Now we'll get the AES password by decrypting via OpenSSL
    $pass = $this->privateDecrypt($pass, $privateKey);
    //and now decrypt the data with the password we found
    $data = $this->decryptAES($data, $pass);
    //return the data
    return $data;
} 
```

我保留了完整的评论以帮助理解这些功能。现在是我们进入有趣部分的地方，实际使用用户数据。该方法`$data`中`send`的用户数据是序列化数组中的。请记住，发送方法`$publicKey`是硬编码的，您可以将其作为变量存储在您的类中并以这种方式访问​​它，以便更少的变量传递给它，或者每次都从其他地方输入它以发送到该方法。加密数据的示例用法：

```
$myCrypt = new encryptClass();
$userData = array(
    'id' => $_POST['id'],
    'password' => $_POST['pass'],
    'api' => $_POST['api_key']
);
$publicKey = "the public key from earlier";
$encData = $myCrypt->secureSend(serialize($userData), $publicKey));
//Now store the $encData in the DB with a way to associate with the user
//it is base64 encoded, so it is safe for DB input. 
```

现在，这是简单的部分，下一部分是能够使用这些数据。为此，您需要在您的服务器上接受一个页面，`$_POST['privKey']`然后以您的网站所需的方式循环访问用户等，获取`$encData`. 从中解密的示例用法：

```
$myCrypt = new encryptClass();
$encData = "pulled from DB";
$privKey = $_POST['privKey'];
$data = unserialize($myCrypt->secureReceive($encData, $privKey));
//$data will now contain the original array of data, or false if
//it failed to decrypt it.  Now do what you need with it. 
```

接下来，使用私钥访问该安全页面的具体使用理论。在单独的服务器上，您将有一个 cron 作业，该作业运行一个特别不`public_html`包含私钥的 php 脚本，然后用于[`curl`](http://www.php.net/manual/en/book.curl.php)将私钥发布到您正在寻找它的页面。**（确保您呼叫的地址以*https*开头）**

我希望这有助于回答如何将用户信息安全地存储在您的应用程序中，而不会因访问您的代码或数据库而受到损害。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T00:16:20.060

让我看看我是否可以总结这个问题 - 然后我对我所理解的问题的回答。

您希望用户登录到您的应用程序，然后存储第 3 方凭据。（这些凭据是什么并不重要...）为了安全起见，您不希望有一种简单的方法可以在黑客获得对数据库的访问权的情况下解密这些凭据。

这是我的建议。

1.  为用户创建一个身份验证系统以登录您的应用程序。用户每次访问该站点时都必须登录。在存储对所有这些其他凭据的访问权限时，“记住我”只是一个可怕的想法。身份验证是通过组合和散列用户名、密码和盐来创建的。这样，这些信息都不会存储在数据库中。

2.  用户名/密码组合的散列版本存储在会话中。这成为万能钥匙。

3.  输入第 3 方信息。此信息使用 MASTER KEY 哈希加密。

所以这意味着...

如果用户不知道他们的密码，他们就不走运了。但是，对于黑客来说，获取信息将是一个非常困难的情况。他们需要了解用户名、密码、salt 的散列，以破坏身份验证，然后拥有主密钥的 hte 用户名/密码的散列版本，然后使用它来解密数据。

仍有可能被黑客入侵，但非常困难 - 不太可能。我还要说这给了你相对的否认性，因为根据这种方法，你永远不知道服务器上的信息，因为它在存储之前是加密的。这种方法类似于我假设 OnePassword 等服务的工作方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-13T03:47:27.950

如果你开箱即用，有几种可能的解决方案......并且可以开箱即用，这不一定是你的情况，但无论如何我都会建议它们。

1.  从第 3 方站点获取具有有限权限的帐户。在您的支付网关示例中，允许您授权和结算付款但不能调用 TransferToBankAccount($accountNumber) API 的帐户。

    *   同样，要求提供者进行限制。$accountNumber 必须是您提供的几个之一，或者只需与您所在的国家/地区相同*。
2.  一些安全系统依靠硬件令牌来提供身份验证。（我主要考虑创建密钥和签署加密狗。）我不确定这在您的情况下究竟是如何工作的。假设您有一个请求身份验证的加密狗，它只会在某些情况下回复。如果它所能做的只是提供（或不提供）用户名/密码，这很困难。（比方说，签署一个请求，它可以检查请求参数）。您可以使用 SSL 客户端证书执行此操作，其中对第 3 方的请求需要用户名/通行证/和客户端签名——如果您的第 3 方接受这样的事情。

3.  #1 和 #2 的组合。设置另一台服务器作为中间人。该服务器将实现我建议您的第 3 方可以在 #1 中执行的基本业务逻辑。在获取身份验证详细信息并直接发出请求之前，它公开了一个 API 并检查以确保请求是“有效的”（可以结算付款，但只能向您的帐户 # 发出转帐等）。API 可以包括 SetAuthDetails，但不能包括 GetAuthDetails。这里的好处是攻击者妥协是另一回事。而且，服务器越简单，就越容易加固。（无需运行 SMTP、FTP 和任何可能有问题的 PHP 堆栈，您的主服务器有......只需几个 PHP 脚本、端口 443、SSH 和一个例如 sqlite 实例。保持 HTTPD 和 PHP 是最新的应该更容易，因为有'

4.  假设您将受到威胁并监控/审核潜在影响。让另一台服务器（是）具有身份验证详细信息以登录并检查身份验证日志（或者，理想情况下，只读权限）。让它每分钟检查一次并检查未经授权的登录和/或交易并做一些激烈的事情（也许将密码更改为随机的密码并寻呼你）。

*无论我们是否真的在谈论支付网关，您担心被黑客入侵的任何第 3 方也应该关注他们自己的安全，包括您（或其他客户）是否被黑客入侵。他们在某种程度上也有责任，所以他们应该愿意采取保障措施。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T21:15:28.080

如果您使用基于 X 标准的随机盐，您可以预测但黑客无法预测，那么根据您编写代码的方式，即使黑客获得了对所有内容的访问权限，它仍然可能不清楚是什么。

例如，您使用当前时间和日期加上用户 IP 地址作为盐。然后，您将这些值与哈希一起存储在他的数据库中。您混淆了用于创建哈希的函数，并且盐是什么可能并不那么明显。当然，任何坚定的黑客最终都可以打破这一点，但它可以为您赢得时间和一些额外的保护。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-14T22:06:28.757

用户并非都非常精通技术，但被要求为第三方网站提供凭据的用户应该尽快逃离您的网站。这简直是​​个坏主意。关于存储明文密码的问题在这里也肯定适用。不要这样做。

您没有提供有关第三方以及您与他们的关系的太多背景信息。但是您应该与他们讨论他们是否愿意进行一些更改以支持您的用例。他们实施 oauth 将是一个很好的解决方案。

如果您想四处寻找替代方案，请查找[联合身份](http://en.wikipedia.org/wiki/Federated_identity)

# asp.net - DbContext VS 对象上下文

> ID：15179448
> 
> 赞同：4
> 
> 时间：2013-03-02T21:07:05.260
> 
> 标签：asp.net, entity-framework

我曾经使用`DbContext`过我所有的数据库模型，直到我阅读[了优化实体框架的方法](http://msdn.microsoft.com/en-us/library/bb896240.aspx)，按照这些步骤后我发现自己被迫切换到`ObjectContext`，所以，有很多代码更改要做，但我不是确保我做的是正确的事情，特别是在谷歌搜索后，我注意到我注意到`DbContext`比 更新更好`ObjectContext`，而且我注意到在切换到`ObjectContext`“迁移”和“查找”方法等等时我丢失了很多东西。 ..

那么，更改我的代码以使用`ObjectContext`而不是`DbContext`通过预生成视图来提高速度是正确的吗？还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T07:24:28.400

您不必切换到 ObjectContext 即可获得预生成的视图。我创建了 T4 模板来为 CodeFirst 生成预生成的视图。看看这里：[实体框架初始化很慢——我能做些什么来更快地引导它？](https://stackoverflow.com/questions/10757019/entity-framework-initialization-is-slow-what-can-i-do-to-bootstrap-it-faster/10757821#10757821) T4 模板在 Visual Studio Gallerry 上可用。这是我的博客文章的[链接](http://blog.3d-logic.com/2012/06/13/entity-framework-codefirst-view-generation-templates-on-visual-studio-code-gallery/)，描述了如何获取和使用它们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:30:21.127

我鼓励您使用 DbContext，因为它是 ObjectContext 的简化版本。如果 DbContext 不够用，可以从 DbContext 中访问包装好的 ObjectContext：

```
((IObjectContextAdapter)dbContext).ObjectContext 
```

“生成视图”选项也可用于 EF Power Tools 中的 Code First (DbContext)。右键单击从 DbContext 派生的文件并选择“实体框架”=>“生成视图”。有关更多信息，请参阅[生成预编译视图](http://msdn.microsoft.com/en-us/data/jj593170.aspx)

# php - 在 php 中获取和解析 XML 文件，然后将 xml 值放入数据库

> ID：15179450
> 
> 赞同：0
> 
> 时间：2013-03-02T21:07:10.463
> 
> 标签：php, mysql, sql, xml, phpmyadmin

编辑：解决方案是我忘记了要执行的查询。如果您不执行查询，当然不会发生任何事情。初学者错误。

我正在尝试获取我的 XML 内容并使用 PHP 将它们放入我的数据库中。我无法成功完成这项任务，所以我尝试退后一步：尝试将变量值插入我的数据库表中。此外，这失败了，所以我尝试从同一个数据库但从另一个表中获取内容，并且确实有效。我仍在处理我的问题以填充另一个表中的列，但它不起作用。

我的代码：

```
<!doctype HTML> 

<html>
<head>

<?php  require_once("../includes/constants.php");
       require_once("../includes/connection.php"); 
       $connect = connectDB();   
 ?>

</head>
<body>

<?php

$xml = simplexml_load_file("file.xml");
$test = "dit is een naam";
$nodes = new SimpleXMLElement('file.xml', null, true)
         or die("cannot create");

foreach ($nodes->children() as $child)
{
$naam = $child->name;
$desc = $child->description;
$sql = "INSERT INTO feeds (name, description) VALUES('". $naam ."','". $desc ."')";

    print_r($sql);
}
?>
</body>

</html> 
```

我的表（称为：提要）：

```
id - INT(ai) 
name - varchar 
url - varchar
description - varchar 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T09:11:37.383

您实际上并没有在任何地方执行 SQL。你需要包括

```
mysql_query($sql) 
```

# php - 使用PHP在Cassandra的超级列族中选择X个列族？

> ID：15179455
> 
> 赞同：1
> 
> 时间：2013-03-02T21:07:54.603
> 
> 标签：php, cassandra

我正在使用 Kallaspriit 的 Cassandra/PHP 库（[https://github.com/kallaspriit/Cassandra-PHP-Client-Library](https://github.com/kallaspriit/Cassandra-PHP-Client-Library)）。

我正在尝试选择超级列族中的前 x 个列族，但是，我绝对没有运气，而且谷歌搜索似乎并没有带来太多。

我正在使用随机分区，并且不特别希望更改为 OPP，因为我已经阅读过涉及更多工作。

任何帮助将非常感激。

# hadoop - Mapper类如何将SequenceFile识别为hadoop中的输入文件？

> ID：15179456
> 
> 赞同：3
> 
> 时间：2013-03-02T21:08:05.253
> 
> 标签：hadoop, mapper, sequencefile

在我的一个 MapReduce 任务中，我将 BytesWritable 覆盖为 KeyBytesWritable，并将 ByteWritable 覆盖为 ValueBytesWritable。然后我使用 SequenceFileOutputFormat 输出结果。

我的问题是当我开始下一个 MapReduce 任务时，我想使用这个 SequenceFile 作为输入文件。那么如何设置作业类，以及 Mapper 类如何识别我之前覆盖的 SequenceFile 中的键和值？

我知道我可以通过 SequenceFile.Reader 读取键和值。

```
Configuration config = new Configuration();
Path path = new Path(PATH_TO_YOUR_FILE);
SequenceFile.Reader reader = new SequenceFile.Reader(FileSystem.get(config), path, config);
WritableComparable key = (WritableComparable) reader.getKeyClass().newInstance();
Writable value = (Writable) reader.getValueClass().newInstance();
while (reader.next(key, value)) 
```

但我不知道如何使用这个 Reader 将键和值作为参数传递给 Mapper 类。如何将 conf.setInputFormat 设置为 SequenceFileInputFormat，然后让 Mapper 获取键和值？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T23:14:55.330

您不需要手动读取序列文件。只需将输入格式类设置为序列文件：

```
job.setInputFormatClass(SequenceFileInputFormat.class); 
```

并将输入路径设置为包含您的序列文件的目录。

```
FileInputFormat.setInputPaths(<path to the dir containing your sequence files>); 
```

您需要注意 Mapper 类的参数化类型的输入的 (Key,Value) 类型，以匹配序列文件中的 (key,value) 元组。

# python - MINIX 上的 Python C 扩展

> ID：15179462
> 
> 赞同：3
> 
> 时间：2013-03-02T21:08:40.313
> 
> 标签：python, minix

我试图构建[我写的这个包](http://pypi.python.org/pypi/uptime)（我知道它正在工作），首先以通常的方式通过`distutils`：

```
# python2.7 setup.py build
running build
running build_py
running build_ext
building 'uptime._posix' extension
gcc -fno-strict-aliasing -Wno-error -march=i586 -DHAVE_DB_185_H -I/usr/pkg/include -I/usr/include -DNDEBUG -Wno-error -march=i586 -DHAVE_DB_185_H -I/usr/pkg/include -I/usr/include -I/usr/pkg/include/python2.7 -c src/_posix.c -o build/temp.minix-3-i686-2.7/src/_posix.o
ld -L/usr/tmp/work/lang/python27/work/Python-2.7.2 -lcompat_minix -minlib -L/usr/pkg/lib -Wl,-R/usr/pkg/lib -L/usr/lib -Wl,-R/usr/lib build/temp.minix-3-   i686-2.7/src/_posix.o -o build/lib.minix-3-i686-2.7/uptime/_posix.so
ld: unrecognized option '-Wl,-R/usr/pkg/lib'
ld: use the --help option for usage information
build failed: uptime._posix (no big deal) 
```

好吧，好吧；`distutils`是那些经常在不太流行的平台上中断的模块之一。所以我尝试手动编译扩展部分：

```
# gcc -fno-strict-aliasing -march=i586 -DNDEBUG -I/usr/pkg/include/python2.7 -fPIC -shared -o _posix.so src/_posix.c 
```

这行得通——也就是说，它`_posix.so`毫无怨言地生成了——但是，尝试在 Python 中导入生成的模块并没有：

```
>>> import _posix
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: Service unavailable 
```

谷歌认为这与操作系统加载共享库（Python 扩展是）的能力有关。我去看了，结果发现 MINIX 直到[去年](http://wiki.minix3.org/en/UsersGuide/UsingSharedLibraries)才支持共享库，但现在应该支持了。事实上，`/usr/pkg/include/python2.7/pyconfig.h`定义了`HAVE_DLOPEN`和`HAVE_DYNAMIC_LOADING`，所以它显然是这样的。

这是怎么回事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T21:08:40.313

MINIX 现在确实支持共享库，但是提供的二进制 Python 包`pkgin`是静态链接的，这使它们无论如何都无法加载共享库。解决这个问题的唯一方法是自己编译 Python，最好是通过[`pkgsrc`](http://wiki.minix3.org/en/UsersGuide/InstallingSourcePackages). 默认情况下，所有`pkgsrc`包都是动态构建的。

（您仍然必须手动构建扩展。）

# javascript - 区分页面的第一次下载和同一页面的所有后续下载

> ID：15179463
> 
> 赞同：1
> 
> 时间：2013-03-02T21:08:40.353
> 
> 标签：javascript, nginx, http-headers, tornado

我有一个静态页面（静态，我的意思是 html、css 和 javascript 都固定在页面上）。

在服务器端，我可以判断（基于服务器端会话信息）这是否是特定用户首次加载页面。现在，基于这个细节，我想向前端发出信号（例如，通过在响应头中设置一些东西，也许？），以便页面上的 javascript 函数可以根据用户是否是第一次来执行一些操作已登陆此页面。

实际服务页​​面的服务器是 Nginx，处理逻辑、会话等的服务器是 Tornado。所以想必我需要在tornado中做点什么，然后指示nginx下发静态页面。

这是可行的吗？如果是这样，那么最稳健的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T21:17:52.573

您可以使用 cookie 来实现这一点：[http:](http://www.quirksmode.org/js/cookies.html) //www.quirksmode.org/js/cookies.html 使用 cookie，您将在第一个视图上发送带有响应标头的特定 cookie。然后每次页面加载时，让您的 javascript 检查特定的 cookie

或使用本地存储：[http](http://diveintohtml5.info/storage.html) ://diveintohtml5.info/storage.html 类似于 cookie 方法，但在第一个视图中，javascript 在本地存储中存储一个 key=value 对，并在每次页面加载时检查。这些方面的东西：

```
(function () {
    window.onload = function () {
        if (localStorage.getItem("SeenBefore")) {
            // Not first time viewed
        } else {
            localStorage.setItem("SeenBefore", true);
            // First view
        }
    }
}()) 
```

另一种选择是，在服务器端，您可以在第一次查看页面时设置一个会话变量，然后在每次用户发送对该页面的请求时进行检查。这也可以使用 cookie 来实现。

# forms - Codeigniter - 使用复选框从表单更新表格

> ID：15179467
> 
> 赞同：1
> 
> 时间：2013-03-02T21:09:22.083
> 
> 标签：forms, codeigniter, checkbox, updates, multiple-records

我正在尝试`MySQL`使用`Codeigniter`.

我的模型代码是：

```
function update_customer_records($updatedrow)
{
    $this->db->where('id',$this->input->post('id'));
    $this->db->update('customers',$updatedrow);
} 
```

我的看法是：

```
 $attributes=array(
        'name'=>'updatecustomer',
        'id'=>'updatecustomer',
        );
    echo form_open('masterdata/manage_customers',$attributes);
?>

<table>
    <tr>
        <td>&nbsp;</td><td>&nbsp;</td><td>Customer Name</td><td>postalcode</td>
    <tr>

<?php if(isset($records)) : foreach ($records as $row) : ?>
    <tr>
        <td>
<?php echo anchor('masterdata/customers_updated/'.$row->id, img(array('src'=>'images/delete_icon.png','border'=>'0','alt'=>'Delete'))); ?>
        </td>
        <td>
            <input type=checkbox name="editcustomer[]" id="editcustomer[]" value="<?php echo $row->id ?>">
        </td>
        <td>
            <input type="text" name="customername_<?php echo $row->id ?>" id="customername_<?php echo $row->id ?>" value="<?php echo $row->customer_name ; ?>" >
        </td>
        <td>
            <input type="text" name="customername_<?php echo $row->id ?>" id="customername_<?php echo $row->id ?>" value="<?php echo $row->postalcode ; ?>" >
        </td>
    </tr>
<?php endforeach ; ?>
    </table>
<input type="submit" value="Update Selected">
<?php else : ?>
<h2> No Records Found</h2>
<?php endif; ?>
<?php echo form_close(); ?> 
```

我的控制器是：

```
function manage_customers()
    {

        $data['title']="Manage Customers";

            //query model to get data results for form
            $data=array();

            if($query=$this->model_master_data->get_records()){
                $data['records']=$query;

            $this->load->view("master_data/view_master_data_header",$data);
            $this->load->view("master_data/view_master_data_nav");
            $this->load->view("master_data/view_content_master_data_manage_customers",$data);
            $this->load->view("master_data/view_master_data_footer");

            $editcustomer = $this->input->post('editcustomer');

            if(isset($editcustomer)){

                //begin outputting id of selected checkbox
                foreach ($editcustomer as $row) :
                    echo $row;

                $updatedrow=array(
                    'id'=>$row,
                    'postalcode'=>'44444'
                    );

                $this->model_master_data->update_customer_records($updatedrow);

                endforeach;
            } 
```

**我有两个问题：**

1.  如果未选中复选框，如何停止 foreach 运行。
2.  如何正确地将数组传递给模型以便更新运行？

一如既往地提前感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T23:16:51.937

首先，我在表单中找到了两个具有相同名称和 id 的字段（如下所示），在一个字段中设置它的值`customer_name`，在另一个字段中设置`postalcode`。

```
<td>
    <input type="text" name="customername_<?php echo $row->id ?>" id="customername_<?php echo $row->id ?>" value="<?php echo $row->customer_name ; ?>" >
                                --^^--
</td>
<td>
    <input type="text" name="customername_<?php echo $row->id ?>" id="customername_<?php echo $row->id ?>" value="<?php echo $row->postalcode ; ?>" >
                                --^^--
</td> 
```

所以我认为（可能）第二个字段的名称和 id 应该`postalcode`根据它的值。

此外，您不必担心`foreach`循环，因为循环内的代码只有在表单上有选中的复选框时才会运行，因为不会提交未选中的复选框，但您可以使用以下代码检查并运行循环

```
if( $this->input->post('editcustomer') != false )
{
    foreach ($editcustomer as $row)
    {
        // code here
    }
} 
```

如果未找到或未与表单一起提交，则`if`条件将返回 false 。`editcustomer`您的表单中也没有`id`字段，在这种情况下您不能使用`$this->input->post('id')`，因此如果您需要检查模型中的复选框 id，`where clause`那么您可以使用

**在控制器中：**

```
if( $this->input->post('editcustomer') != false )
{
    $this->load->model('model_master_data');
    foreach ($editcustomer as $row_id)
    {
        $data = array( 'postalcode' => '44444' );
        $this->model_master_data->update_customer_records( $row_id, $data );
    }
} 
```

我认为您不需要通过`'id'=>$row,`，因为您可能不想更新此字段。此外，您应该在更新记录之前使用[**表单验证**](http://ellislab.com/codeigniter/user-guide/libraries/form_validation.html)来检查表单输入（您可以设置绑定用户输入邮政编码所需的邮政编码字段）。

**在模型中：**

```
function update_customer_records( $id, $data )
{
    $this->db->where( 'id', $id );
    $this->db->update( 'customers', $data );
} 
```

所以它会做这样的事情（伪代码）

```
update the customers table set `postalcode` = '44444' where `id` = $id 
```

**更新：** 我认为您也可以使用[**update_batch**](http://ellislab.com/codeigniter/user-guide/database/active_record.html#update)。

**在控制器中：**

```
if( $this->input->post('editcustomer') != false )
{
    $data = array();
    foreach ($editcustomer as $row_id)
    {
        $data[] = array( 'id' => $row_id, 'postalcode' => '44444';
    }
    $this->load->model('model_master_data');
    $this->model_master_data->update_customer_records( $data );
} 
```

**在模型中：**

```
function update_customer_records( $data )
{
    $this->db->update_batch('customers', $data, 'id');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T21:32:45.033

[与“Codeigniter 从带有 CI 的表单更新 mysql 表”的](https://stackoverflow.com/questions/15176228/codeigniter-update-mysql-table-data-from-form-with-checkbox)重复主题？

> 如果未选中复选框，如何停止 foreach 运行。

如果未选中复选框，则不必停止 foreach 运行。因为`$editcustomer`变量只包含选中的复选框。

> 如何正确地将数组传递给模型以便更新运行？

你的模型是错误的。它应该是：

```
public function update_customer_records($updatedrow)
{
    $this->db->update('customers', $updatedrow);
} 
```

你不需要写`$this->db->where('id',$this->input->post('id'));`（这是错误的，因为你不能在你的模型中使用 $this->input->post() ）因为你已经传入`id`了`$updaterow`.

编辑：对不起，我读你的代码太快了！

```
function update_customer_records($updatedrow)
{
    $this->db->where('id',$this->input->post('id'));
    $this->db->update('customers',$updatedrow);
} 
```

...是正确的。或者，您可以用更短的方式编写它：

```
function update_customer_records($updatedrow)
{
    $this->db->update('customers', $updatedrow, array('id' => $this->input->post('id')));
} 
```

# angularjs - 在隔离范围指令监视中未观察到表单元素 ng-model 更改

> ID：15179468
> 
> 赞同：4
> 
> 时间：2013-03-02T21:09:43.850
> 
> 标签：angularjs, angularjs-directive

在发布这个小提琴之前，我检查了类似的问题。得到的答案很少，但所有这些都不是表单元素。[http://jsfiddle.net/dgQAd/](http://jsfiddle.net/dgQAd/)

我有以下问题：

1）文本框绑定到模型`uname`，但加载文本框不显示值。为什么会这样？

2）在寻找这个答案时，我看到了类似的东西`require:ngModel`，并在链接函数中注入了一个控制器，我如何在指令的链接函数中使用这个注入的控制器。

3）如何`ng-model`从隔离作用域指令的链接函数内部查找父作用域的变化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T22:56:18.980

我能够让 ng-model 与隔离范围一起工作的唯一方法是对隔离范围属性使用相同的名称： `scope:{ "uname":"=ngModel" }`. 你的 $watch 现在可以工作了。有关这方面的更多信息，另请参阅[https://stackoverflow.com/a/14792601/215945](https://stackoverflow.com/a/14792601/215945)

当一个指令`require`是另一个指令的控制器时，该控制器可用作链接功能的第四个选项。在你的小提琴中，这就是你所说的`ngModel`：

```
link:function(scope,el,attrs,ngModel){ 
```

通常，我更喜欢命名这个 ngModelCtrl 来提醒我它是一个控制器。

$observe 仅与使用“@”语法的隔离范围属性一起使用。

# linux - 汇编：将 x86 代码转换为 x64 的简单示例

> ID：15179469
> 
> 赞同：2
> 
> 时间：2013-03-02T21:09:48.347
> 
> 标签：linux, assembly, 64-bit, x86-64, nasm

在学习 x64 汇编时，我正在尝试使用 add 方法来添加两个整数并使用汇编返回整数。我有 x86 的工作代码，我试图转换为 x64

只是我将寄存器的名称更改为 x64 的名称，并且生成的目标文件没有错误，但是当我在 C 函数中使用它时，我总是得到 sum = 0。

我认为参数位置存在问题，并且我没有找到解决此类问题的良好文档。

```
section .text
    global addi
addi:
    push    rbp
    mov     rbp, rsp
    mov     rax,[rbp+12]
    mov     rdx,[rbp+8]
    add     rax, rdx
    pop     rbp
    ret 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:11:47.277

x64 ABI 要求前几个参数在寄存器中传递，而不是在堆栈中。

请参阅[x86-64 上](http://eli.thegreenplace.net/2011/09/06/stack-frame-layout-on-x86-64/)的堆栈框架布局以获得很好的解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-03T02:26:17.367

x86-64 有 amd 定义的调用转换，这个平台的所有工具链都应该遵循这个：

*   第一个参数-> rdi
*   第二个-> rsi
*   第三 -> rdx
*   第 4 -> rcx
*   第 5 -> 拉克斯

所以它应该看起来像：

```
section .text
    global addi
addi:
    mov rax, rsi
    add rax, rdi
    ret 
```

# xcode - QuickLook 插件是“损坏/丢失的资源”。为什么？

> ID：15179472
> 
> 赞同：6
> 
> 时间：2013-03-02T21:10:04.907
> 
> 标签：xcode, cocoa, frameworks, quicklook

**设置：**
OS X 10.8.2
Xcode4.5.2 (4G2008a)
带有 QuickLook 插件的基于文档的 Cocoa 应用程序

* * *

**问题：**

我正在尝试将 QuickLook 插件添加到我的基于文档的 OS X 应用程序中，但 QL 插件不会启动。

我的 QuickLook 插件需要嵌入并链接到我自己创建的*两个框架*`IDEKit`（称为和`TDAppKit`）。我已经阅读了这篇[关于在 QuickLook PlugIns 中链接框架的 SO 帖子](https://stackoverflow.com/questions/5750032/linking-frameworks-into-quicklook-plugins "目标 c - 将框架链接到 QuickLook 插件 - 代码日志")，并按照那里的说明进行操作（我将`DYLIB_INSTALL_NAME_BASE`两个框架中的一个设置为`@loader_path/../Frameworks`）。

下面是关于我的 QuickLook 插件构建后的一些相关信息：

```
% otool -L /Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/MacOS/ShapesQuickLook 
/Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/MacOS/ShapesQuickLook:
    /usr/lib/libcrypto.0.9.8.dylib (compatibility version 0.9.8, current version 47.0.0)
    @loader_path/../Frameworks/IDEKit.framework/Versions/A/IDEKit (compatibility version 1.0.0, current version 1.0.0)
    @loader_path/../Frameworks/TDAppKit.framework/Versions/A/TDAppKit (compatibility version 1.0.0, current version 1.0.0)
    /System/Library/Frameworks/QuickLook.framework/Versions/A/QuickLook (compatibility version 1.0.0, current version 555.4.0)
    /System/Library/Frameworks/IOKit.framework/Versions/A/IOKit (compatibility version 1.0.0, current version 275.0.0)
    /System/Library/Frameworks/Security.framework/Versions/A/Security (compatibility version 1.0.0, current version 55179.0.2)
    /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore (compatibility version 1.2.0, current version 1.8.0)
    /System/Library/Frameworks/Cocoa.framework/Versions/A/Cocoa (compatibility version 1.0.0, current version 19.0.0)
    /System/Library/Frameworks/ApplicationServices.framework/Versions/A/ApplicationServices (compatibility version 1.0.0, current version 45.0.0)
    /System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices (compatibility version 1.0.0, current version 57.0.0)
    /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 744.1.0)
    /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation (compatibility version 300.0.0, current version 945.11.0)
    /usr/lib/libobjc.A.dylib (compatibility version 1.0.0, current version 228.0.0)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 169.3.0)
    /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit (compatibility version 45.0.0, current version 1187.33.0) 
```

链接/嵌入式框架已到位：

```
% file /Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/MacOS/ShapesQuickLook 
/Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/MacOS/ShapesQuickLook: Mach-O universal binary with 2 architectures
/Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/MacOS/ShapesQuickLook (for architecture x86_64):    Mach-O 64-bit bundle x86_64
/Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/MacOS/ShapesQuickLook (for architecture i386):  Mach-O bundle i386
% file /Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/Frameworks/IDEKit.framework/IDEKit 
/Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/Frameworks/IDEKit.framework/IDEKit: Mach-O universal binary with 2 architectures
/Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/Frameworks/IDEKit.framework/IDEKit (for architecture x86_64):   Mach-O 64-bit dynamically linked shared library x86_64
/Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/Frameworks/IDEKit.framework/IDEKit (for architecture i386): Mach-O dynamically linked shared library i386
% file /Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/Frameworks/TDAppKit.framework/TDAppKit 
/Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/Frameworks/TDAppKit.framework/TDAppKit: Mach-O universal binary with 2 architectures
/Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/Frameworks/TDAppKit.framework/TDAppKit (for architecture x86_64):   Mach-O 64-bit dynamically linked shared library x86_64
/Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/Contents/Frameworks/TDAppKit.framework/TDAppKit (for architecture i386): Mach-O dynamically linked shared library i386 
```

但是，当我尝试使用测试文档启动我的 QuickLook 插件时`qlmanage`，我收到以下错误：

```
dyld: DYLD_ environment variables being ignored because main executable (/System/Library/Frameworks/QuickLook.framework/Versions/A/Resources/quicklookd.app/Contents/MacOS/qlmanage) is code signed with entitlements
Testing Quick Look preview with files:
    /Users/itod/Desktop/test.shapes
[ERROR] Can't load plug-in at file://localhost/Users/itod/Library/Developer/Xcode/DerivedData/Shapes-bqzarhutlkqukverhbjatfvaextg/Build/Products/Debug/Shapes.app/Contents/Library/QuickLook/ShapesQuickLook.qlgenerator/: The bundle “ShapesQuickLook” couldn’t be loaded because it is damaged or missing necessary resources. 
```

请注意：

```
The bundle “ShapesQuickLook” couldn’t be loaded because it is damaged or missing necessary resources. 
```

我不确定这个问题是由嵌入式框架的问题引起的（但我认为它可能是）。

我可能会错过什么？如何让我的 QuickLook 插件启动？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-03T06:16:20.350

在这里。我在这篇[关于 Dylibs、Install Names 和 rpaths 的博客文章](http://www.mikeash.com/pyblog/friday-qa-2009-11-06-linking-and-install-names.html)中找到了解决方案。

具体来说，**@rpath**部分下的建议对我有用。

所以在我的嵌入式框架中，我`DYLIB_INSTALL_NAME_BASE`将`@rpath/`.

然后我有一个应用程序和一个 QL 插件，每个都嵌入了框架：

在我的应用程序目标的构建设置中，我添加了以下*其他链接器标志*：`-rpath @executable_path/../Frameworks/`.

在我的 QuickLook 插件目标的构建设置中，我添加了以下*其他链接器标志*：`-rpath @loader_path/../Frameworks/`.

这解决了这个问题。现在应用程序和 QL 插件可以正常工作。

# java - 特定表数据上的 Jsoup

> ID：15179474
> 
> 赞同：1
> 
> 时间：2013-03-02T21:10:12.573
> 
> 标签：java, html, jsoup, html-table

首先，我很抱歉页面的色情内容，但看过去，这与页面本身无关。

我正在尝试从此页面获取某些东西的价格：[JSFiddle](http://jsfiddle.net/E5LFH/)

在第 67 行上写着“Adviesprijs：”，之后我需要下一个值`td`，没有 btw 的东西（如果你想知道，这是比利时的税）

例如：“19.95”作为字符串

如何使用 JSoup 获取此内容？

这是我到目前为止所拥有的：

```
Element element = doc.getElementById("productdetails");

if (element.text().contains("Adviesprijs:")) { 
   String price = element.parent().ownText(); 
   System.out.println(price); 
} 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T01:20:06.460

您最好为此使用[选择器](http://jsoup.org/cookbook/extracting-data/selector-syntax)：

```
/* select all tags with "Adviesprijs:" text */
Elements result = doc.select("*:containsOwn(Adviesprijs:)");

/* iterate over all elements found */
for( Element e : result )
{
    String key = e.text(); /* "Adviesprijs:" */
    String value = e.nextElementSibling().text(); /* text of next element */

    System.out.println(key + "\t" + value);
} 
```

印刷：`Adviesprijs: € 19,95 (incl. 21% btw)`

# regex - 正则表达式 - 如果有破折号则不匹配

> ID：15179478
> 
> 赞同：-1
> 
> 时间：2013-03-02T21:10:23.520
> 
> 标签：regex

我有两种字符串。

index_12323（只有数字，没有破折号）。index_12a-dcd-edff（基本上是一个 uuid）。

什么是只匹配第一个而不是第二个的正则表达式，基本上，如果它有破折号，那就不是匹配。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:17:54.633

因为“_”（下划线）被包含在单词字符类中，所以不需要显式检查它。使用此正则表达式匹配第一个模式：

```
^\w+\d+$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:16:14.250

这种东西就是你要找的东西：

```
^index_[0-9]+$ 
```

# c - 如何计算二维矩阵中两点之间的距离

> ID：15179481
> 
> 赞同：2
> 
> 时间：2013-03-02T21:10:29.297
> 
> 标签：c, matrix, distance

我既是这个网站的新手，也是 C 的新手。我需要一个程序来找到所有点的平均“跳跃”。

![在此处输入图像描述](../Images/2b0d400d067b4d08759061d50c550bd3.png)

这个想法是这样的：找到从 1 到 2、1 到 3、1 到 4 ... 1 到 9 的“跳跃”距离，或者找到 2 到 1、2 到 3、2 到 4、2 到 5 等。

在第一行执行它们很简单，只需 (2-1) 或 (3-1) 即可获得正确的数字。但如果我想找到 1 到 4 或 1 到 8 之间的距离，那我完全不知道。矩阵的维度应该是可变的。但我只需要 3x3 矩阵的帮助。

任何人都可以告诉我如何找到它？

跳跃是指从一个点垂直或水平移动到另一个点。从 1 到 2 = 1，从 1 到 9 = 4（仅最短路径）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T21:31:38.077

这类问题上“距离”的定义总是很棘手。

想象一下，这些点是田野上的标记，你可以在上面自由走动。然后，您可以选择从一个点到另一个点的任何路径。那么最短的路线将是一条直线；它的长度将是连接点的向量的长度，这恰好是两个点位置之间的差向量。这个长度可以借助毕达哥拉定理来计算：`dist = sqrt((x2-x1)^2 + (y2-y1)^2)`。这被称为点之间的欧几里得距离。

现在想象你在一个城市，每个点都是一座建筑物。你不能走过建筑物，所以唯一的选择是上/下或左/右。然后，最短距离由差向量的分量之和给出；这是数学上的说法，“走 2 个街区，然后向左走 1 个街区”意味着步行 3 个街区的距离：`dist = abs(x2-x1) + abs(y2-y1)`. 这被称为点之间的曼哈顿距离。

但是，在您的问题中，似乎唯一可能的移动是跳到相邻点，一步，允许对角线。然后问题变得有点棘手，因为路径非常不规则。您需要一些图论，这在使用链接元素或“节点”建模问题时非常有用。每个点都是一个节点，连接到它们的邻居，问题是找到到另一个给定点的最短路径。如果跳跃有不同的权重（例如，对角线跳跃更难），解决这个问题的简单方法是使用 Dijkstra 算法；[Wikipedia](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)上有关实施的更多详细信息。

如果成本始终相同，那么问题就归结为计算从源点到目标点的广度优先搜索中的跳跃次数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-20T19:30:31.523

让我们定义“跳跃”距离：“从 A 点 [A [x] ,A [y] ] 到 B 点 [B [x] ,B [y] ] 所需的跳数。”

现在可以有两种方式允许跳跃：

1.  水平/垂直
    在这种情况下，您可以上/下或左/右。由于您必须独立移动 X 轴和 Y 轴，因此您的答案是：
    `jumpDistance = abs(B[x] - A[x]) + abs(B[y] - A[y]);`

2.  水平/垂直和对角线
    在这种情况下，您也可以向上/向下或向左/向右和对角线。不同之处`Case 1`在于，现在您只需一次跳跃即可同时更改 X 轴和 Y 轴。你现在的答案是：
    `jumpDistance = Max(abs(B[x] - A[x]),abs(B[y] - A[y]));`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-02T21:20:48.333

“跳跃距离”的定义是什么？

如果你的意思是一个人从 M 到 N 需要跳多少次，如果他只能垂直和水平跳跃，那么一种可能性可以：

```
dist = abs(x2 - x1) + abs(y2 - y1); 
```

例如 1 到 9 之间的跳跃距离是：`|3-1|+|3-1| = 4`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-24T07:04:27.757

有两种计算跳跃距离的方法。1）当只允许水平和垂直移动时，在这种情况下，您需要做的就是在两点之间形成一个矩形并计算两个相邻边的长度。就像如果你想从 1 移动到 9，那么首先从 1 移动到 3，然后从 3 移动到 9。（将其转换为代码）2）当所有八个方向的移动都被允许时，事情就变得棘手了。就像你想从 1 移到 6 假设一样。您需要做的是，您必须从 1 到 5。然后从 5 到 6。在代码中执行此操作的方法是找到 x 和 y 坐标差之间的最大值。在此示例中，在 x 坐标中，差异为 2 (3-1)，在 y 坐标中，差异为 1 (2-1)。所以这个最大值是2。所以这就是答案。（转换为代码）

# asp.net - 使用 ASP.NET 4 在 IIS 6 上进行 URL 路由/URL 重写？（没有 IIS 访问）

> ID：15179482
> 
> 赞同：0
> 
> 时间：2013-03-02T21:10:34.693
> 
> 标签：asp.net, url, url-rewriting, urlrewriter

我知道这个问题已经被问了很多次，也被回答了很多次，但是我遇到了一些非常奇怪的情况，因为昨天我的代码在我的生产服务器和开发机器上都可以工作，但是当我今天尝试运行我的网站时，它用它的 404 嘲笑我

我被困在我网站原始页面的路由/重写 SEO 友好 URL 上，无法在 IIS 上进行任何更改。首先，我尝试使用 UrlRewriter.NET，它可以在我的开发机器（Windows Server 2008、IIS 7）上运行，但不能在临时服务器（Windows Server 2003 R2、IIS 6）上运行，因为它会引发 404 错误。然后我尝试使用 UrlRewriting.NET，它也和我记得的一样。

编辑：当我尝试使用 UrlReWriting.NET 时，他们在我的 Visual Studio ASP.NET 开发服务器上工作，但不在 IIS 上

然后我的一位同事和一些搜索说服我使用 Url Routing 而不是 URL ReWriting，所以我在 Global.asax 中使用以下代码进入 ASP.NET Url Routing

```
 protected void Application_Start(object sender, EventArgs e)
    {
        RegisterRoutes(RouteTable.Routes);
    }

    void RegisterRoutes(RouteCollection routes)
    {
        routes.MapPageRoute("GalleryCategory", "Gallery/", "~/Gallery.aspx");
        routes.MapPageRoute("Gallery", "Gallery/{*image}", "~/Gallery.aspx");
    } 
```

是的，我也在 web.config 中尝试了以下解决方案，但没有用

```
 <modules runAllManagedModulesForAllRequests="true">
      <remove name="UrlRoutingModule"/>
      <add name="UrlRoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
    </modules> 
```

但他们也让我在所有这些 404 中无处可去。

PS。我的网站上只有一个页面需要有 SEO 友好的 URL，页面名称是 Gallery.aspx，PathInfo/QueryString 参数是动态的。

重要提示：我的生产服务器是带有 IIS 6 的 WINDOWS SERVER 2003，而我的开发机器是 WINDOWS SERVER 2008 IIS 7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T16:19:35.430

好吧，这听起来可能很疯狂，但经过所有这些搜索和拉扯我的头发后，我试了一下，我确实重置了运行近 30 个网站的生产 IIS（我不愿意尝试任何疯狂的事情，包括重置 IIS，但毕竟事实证明，只需重置 IIS 就可以使用命令`iisreset`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T09:16:23.397

在全局文件应用程序启动中使用此路由代码作为参数：例如 www.domain.com/gallery/imgFile1/

```
void Application_Start(object sender, EventArgs e) 
{
    Routes.MapPageRoute("GalleryFile", "Gallery/{CatID}", "~/Gallery.aspx");
} 
```

至于重写 Gallery Category 页面，将这段代码放在 Web.Config 中：

```
<system.web>
<urlMappings enabled="true">
<add url="~/Gallery/"  mappedUrl="~/Gallery.aspx" />
</urlMappings>
</system.web> 
```

# actionscript-3 - 带有套接字服务器和多人游戏的远程共享对象

> ID：15179483
> 
> 赞同：0
> 
> 时间：2013-03-02T21:10:47.683
> 
> 标签：actionscript-3, sockets, air, multiplayer

开发基于 AIR 的多人 Andoid 游戏，需要保存高分。我正在考虑使用本地共享对象将分数保存在服务器应用程序上，但在阅读文档后想知道远程共享对象是否也可以工作。

谁能告诉我是否必须使用闪存媒体服务器才能使用远程共享对象？

也许甚至我选择的套接字服务器类也是错误的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:21:40.223

你用什么来开发AIR游戏？我正在使用 Flash Professional 和单独的 as3 代码编辑器。您不需要使用闪存媒体服务器。

我通过 Amazon EC2 云服务器使用 Electroserver。Electroserver 基本上构建到 as3 多人游戏（房间、区域、消息系统）的外壳中。

套接字服务器是要走的路。Electroserver 也是套接字服务器。

# matlab - Matlab如何显示存储在单元格中的值？

> ID：15179488
> 
> 赞同：0
> 
> 时间：2013-03-02T21:10:58.300
> 
> 标签：matlab, cell

我有 G=cell(3,1)

我`100 | 500`在每个单元格中存储两个值。例如，每当我尝试打印该值 `G(1)`时，我都会得到：

```
ans = 

    [2x1 double] 
```

如何显示实际的单元格内容而不是`[2x1 double]`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:19:07.850

```
cell2mat(G(1)) 
```

这应该可以解决您的问题。您也可以使用 cell2mat(G) 它将连接 G 中的所有矩阵（但 G 中的所有元素必须具有相同的大小）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T00:35:42.273

`G{1}`会给你第一个单元格的内容。命令`reshape([G{:}]',[],length(G))'`将为您提供整个单元格的内容。

# inheritance - JPA/Hibernate SingleTable Inheritance - 子类不能保留超类中定义的关系

> ID：15179492
> 
> 赞同：0
> 
> 时间：2013-03-02T21:11:32.227
> 
> 标签：inheritance, jpa, null, cascade, persist

我在 jpa 中有一个单表继承层次结构，如下所示：

```
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@Table(catalog = "onedb", name = "content")
@DiscriminatorColumn(name = "oid_content_type", discriminatorType = DiscriminatorType.INTEGER)
public abstract class Content implements Serializable {
   ...
   @OneToMany(cascade = CascadeType.PERSIST)
   @JoinColumn(name = "oid_content", referencedColumnName = "oid_content")
   private List<ContentKeyword> keywords;
   ...

@Entity
public abstract class RichMedia extends Content {
  ... 
    @OneToMany(mappedBy="richMedia", cascade =CascadeType.PERSIST)
    private Set<RichMediaFile> richMediaFiles;
 ...

 }

 @Entity
 @DiscriminatorValue("1")
 public class RichMediaImage extends RichMedia {} 
```

可以看出 Content 是最顶层的基类，RichMedia 是 RichMediaImage 的基类，Content 有一个 ContentKeyword 列表，定义如下：

```
 @Entity
 @Table(catalog = "onedb", name="content_keyword")
 public class ContentKeyword implements Serializable {
    ...
     @ManyToOne
     @JoinColumn(name = "oid_content")
     private Content content;
 } 
```

我构造了一个 RichMediaImage 并在其上设置了 ContentKeyword 列表并尝试保留整个对象。单个表，内容插入新行并生成新 id，但是当插入到 content_keyword 表中时，该新 id 未在 sql jpa 生成中提供：

```
 insert into onedb.content_keyword (oid_content, keyword) values (NULL, 'test') 
```

投掷

```
MySQLIntegrityConstraintViolationException: Column 'oid_content' cannot be null 
```

我将不胜感激任何指针。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:37:48.613

您的映射不正确。在双向 OneToMany 关联中，一侧必须是多侧的反面：

```
@OneToMany(mappedBy = "content", cascade = CascadeType.PERSIST)
private List<ContentKeyword> keywords; 
```

而 JPA 在关联方面只考虑所有者方面。因此，向内容添加关键字是不够的。您还必须在关键字中设置内容：

```
content.getKeywords().add(keyword);
keyword.setContent(content); 
```

# java - 如何使用 Spring DSL 使 Camel 主线程保持活力

> ID：15179497
> 
> 赞同：0
> 
> 时间：2013-03-02T21:11:51.010
> 
> 标签：java, multithreading, apache-camel, middleware

我正在开发我的第一个真正的基于 Camel 的 Java 应用程序，并且遇到了一个奇怪而复杂的问题，我*认为*这是主 Camel 线程死亡/完成的结果。

基本上，路由本身仅由几个处理器组成，其中一个处理器执行一些需要 20 到 25 秒才能完成的繁重计算。整个应用程序正在终止而没有抛出任何异常/错误/日志语句是任何其他表明出现问题的迹象，并且在执行这些昂贵的计算时正在死亡。

我不是在寻找任何人来诊断我的问题，我只是想要一种强制骆驼路线保持活力的方法，因为我*认为*正在发生的事情是骆驼主线程正在到达路线的尽头，停止它，并且关闭应用程序。我想强制 Camel 主线程保持活动状态，例如 60 秒，看看我是否至少可以排除它作为一个因素。

如果使用 Java DSL，我只需将以下内容放在路由的末尾：

```
.to(new Processor() {
    @Override
    public void process(Exchange exchange) {
        try {
            Thread.sleep(60000);
        } catch(Throwable t) {
            // ...
        }
    }
})
.to("direct:endOfRoute"); 
```

我正在使用 Spring DSL (XML) - 有什么想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-03T05:48:44.520

路由完成不会终止您的 Camel 应用程序/上下文，您只需要确保实例化上下文的容器继续运行...

见[http://camel.apache.org/running-camel-standalone-and-have-it-keep-running.html](http://camel.apache.org/running-camel-standalone-and-have-it-keep-running.html)

也就是说，对于您的具体问题，您可以使用[延迟器 EIP](http://camel.apache.org/delayer.html)在您的路线中引入显式延迟

# c# - ResourceDictionary 中的 IValueConverter

> ID：15179503
> 
> 赞同：0
> 
> 时间：2013-03-02T21:13:15.973
> 
> 标签：c#, wpf, visual-studio-2010, xaml, .net-3.5

我正在尝试在`ResourceDictionary`. 这就是我的代码：

```
<Window x:Class="Metro.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:cnv="clr-namespace:Metro.converters">
    <Window.Resources>
        <cnv:DarkenColorConverter x:Key="Darken" />
        <Color x:Key="Red">#FF0000</Color>
        <SolidColorBrush Color="{StaticResource Red}"
                         x:Key="Accent" />
        <SolidColorBrush Color="{Binding Source={StaticResource Red}, Converter={StaticResource ResourceKey=Darken}}"
                         x:Key="DarkAccent" />
    </Window.Resources>
    <StackPanel>
        <Grid Background="{StaticResource Accent}">
            <TextBlock>grid 1</TextBlock>
        </Grid>
        <Grid Background="{StaticResource DarkAccent}">
            <TextBlock>grid 2</TextBlock>
        </Grid>
    </StackPanel>
</Window> 
```

这是转换器：

```
public class DarkenColorConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return Brushes.Blue;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return Brushes.Gray;
    }
} 
```

但不知何故，它不起作用。一旦我`Grid`直接在内部使用转换器，一切正常：

```
 <Grid Background="{Binding Source={StaticResource Red}, Converter={StaticResource ResourceKey=Darken}}">
        <TextBlock>grid 2</TextBlock>
    </Grid> 
```

第一个 xaml 样本有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:56:44.547

在第一次转换中，您正在转换 a `Color`，其中的一个`Grid`正在转换 a `SolidColorBrush`。

您还必须修改转换器以接受颜色。

```
public class DarkenColorConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        double percentage = 0.8;
        if (parameter != null)
        {
            double.TryParse(parameter.ToString(), out percentage);
        }

        if (value is SolidColorBrush)
        {
            Color color = (value as SolidColorBrush).Color;
            return new SolidColorBrush(Color.FromRgb((byte)(color.R * percentage), (byte)(color.G * percentage), (byte)(color.B * percentage)));
        }
        else if (value is Color)
        {
            Color color = (Color)value;
            return Color.FromRgb((byte)(color.R * percentage), (byte)(color.G * percentage), (byte)(color.B * percentage));
        }
        return value;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotSupportedException();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:36:51.053

问题是错误的转换器返回类型。

工作转换器：

```
public class DarkenColorConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return Colors.Blue;
    }

    public object ConvertBack(object value, Type targetType, object parameter,     System.Globalization.CultureInfo culture)
    {
        return Colors.Gray;
    }
} 
```

# c++ - 调用函数使我的代码慢得离谱

> ID：15179504
> 
> 赞同：2
> 
> 时间：2013-03-02T21:13:22.283
> 
> 标签：c++, performance, function, call

我正在尝试实现一种算法，该算法给定一个矩形和多个由用户决定的多边形，可以识别它们是在矩形内部、外部还是与矩形相交，并提供所述多边形的数量。

我编写了一个算法并且它可以工作，但我注意到在编译之后至少需要 20 秒才能启动（如果我第二次、第三次或任何其他时间启动它就不会发生这种情况）。

试图弄清楚是什么让我的代码如此缓慢，我注意到如果我删除对确定多边形相对于矩形位置的函数的调用，程序会立即运行。

我试图找出错误但什么也没找到

这里是

```
// struct used in the function
struct Polygon
{
    int ** points;
    int vertices;
};
// inside, outside and over are the number of polygons that are inside, outside or intersect the rectangle,
// they're initialized to 0 in the main.
// down_side, up_side are the y_coordinate of the two horizontals sides.
// left_side, right_side are the x_coordinate of the two vertical sides.
void checkPolygons( Polygon * polygon, int & inside, int & outside, int & over, unsigned int polygons, const unsigned int down_side, const unsigned int up_side, const unsigned int left_side, const unsigned int right_side )
{
    for ( unsigned int pol = 0; pol < polygons; ++pol )
    {
        unsigned int insideVertices = 0;
        unsigned int vertices = polygon[ pol ].vertices;

        for ( unsigned int point = 0; point < vertices; ++point )
        {
            unsigned int x_coordinate = polygon[ pol ].points[ point ][ 0 ];
            unsigned int y_coordinate = polygon[ pol ].points[ point ][ 1 ];

            if ( ( x_coordinate <= right_side ) and ( x_coordinate >= left_side ) and ( y_coordinate <= up_side ) and ( y_coordinate >= down_side ) )
            {
                insideVertices++;
            }

        }

        if ( insideVertices == 0 )
            ++outside;
        else if ( insideVertices == vertices ) 
            ++inside;
        else
            ++over;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:42:35.180

检查您的防病毒活动和配置。它可能正在扫描新编译的可执行文件以查找病毒。如果是这种情况，您可能希望从病毒扫描中排除您正在编译的目录。

# java - 如何在 Lucene 中检索“命中”的字段

> ID：15179510
> 
> 赞同：5
> 
> 时间：2013-03-02T21:14:14.817
> 
> 标签：java, lucene

也许我真的错过了一些东西。

我在 Lucene 中索引了一堆键/值对（如果重要，v4.1）。假设我有 key1=value1 和 key2=value2，例如从属性文件中读取。

它们被索引为特定字段和包罗万象的“ALL”字段，例如

```
new Field("key1", "value1", aFieldTypeMimickingKeywords);
new Field("key2", "value2", aFieldTypeMimickingKeywords);
new Field("ALL", "key1=value1", aFieldTypeMimickingKeywords);
new Field("ALL", "key2=value2", aFieldTypeMimickingKeywords);
// then get added to the Document of course... 
```

然后我可以使用通配符搜索

```
new WildcardQuery(new Term("ALL", "*alue1")); 
```

它会找到成功的。

但是，最好能获得更多信息，例如“与该命中相关的完整值是什么（例如“key1=value1”）？”。

最好的办法是获取文档，然后获取 IndexableFields 的列表，然后遍历所有这些并查看 field.stringValue().contains("alue1") 是否。（我可以查看调试器中的数据结构，所有信息都在那里）

这似乎完全是疯狂的原因，这不是*Lucene 刚刚所做*的吗？命中信息不应该返回一些字段吗？

Lucene 是否缺少看似“明显”的功能？谷歌并从 API 开始并没有透露任何直接的信息，但我觉得我一定是在搜索错误的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T17:46:11.163

您可能想尝试使用[IndexSearcher.explain()](http://lucene.apache.org/core/4_0_0-ALPHA/core/org/apache/lucene/search/IndexSearcher.html#explain%28org.apache.lucene.search.Query,%20int%29)方法。获得匹配文档的 ID 后，为每个字段准备一个查询（使用相同的搜索关键字）并为每个查询调用[Explanation.isMatch()](http://lucene.apache.org/core/4_0_0/core/org/apache/lucene/search/Explanation.html#isMatch%28%29)：产生 true 的将为您提供匹配的字段。例子：

```
for (String field: fields){
    Query query = new WildcardQuery(new Term(field, "*alue1"));
    Explanation ex = searcher.explain(query, docID);
    if (ex.isMatch()){
        //Your query matched field
    }
} 
```

# clojure - 在 Clojure 中使用自定义方法漂亮地打印记录

> ID：15179515
> 
> 赞同：10
> 
> 时间：2013-03-02T21:14:41.883
> 
> 标签：clojure, pretty-print, multimethod, pprint

在 Clojure 1.5.0 中，如何为我自己的记录类型提供一个自定义的漂亮打印机，用 defrecord 定义。

```
(defrecord MyRecord [a b])

(defmethod print-method MyRecord [x ^java.io.Writer writer]
  (print-method (:a x) writer))

(defmethod print-dup MyRecord [x ^java.io.Writer writer]
  (print-dup (:a x) writer))

(println (MyRecord. 'a 'b)) ;; a -- OK
(clojure.pprint/pprint (MyRecord. 'a 'b)) ;; {:a a, :b b} -- not OK, I want a 
```

我还想`clojure.pprint/pprint`使用我的 cutsom 打印机（现在，`a`为了说明目的，它应该可以漂亮地打印记录字段中的任何内容）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-03T07:27:51.363

`clojure.pprint``clojure.core`命名空间使用与打印函数不同的调度机制。您需要使用`with-pprint-dispatch`才能自定义`pprint`。

```
(clojure.pprint/with-pprint-dispatch print  ;; Make the dispatch to your print function
  (clojure.pprint/pprint (MyRecord. 'a 'b))) 
```

要自定义简单的调度程序，请添加如下内容：

```
(. clojure.pprint/simple-dispatch addMethod MyRecord pprint-myrecord) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-03-23T17:23:05.833

这非常令人困惑，问题的不同部分的正确答案分布在各个地方，所以我把它们放在一起，希望有人可以节省一些时间。

我经历了为 defrecord 定义 multimethods `print-method`、`print-dup`和`simple-dispatch`以及设置动态变量`*print-pprint-dispatch*`和`*print-dup*`. 我通过两者放置了一个示例 defrecord `pr`，`pprint`并提出了以下流程图。现在我可以立即看到所有内容，这很有意义。

[![在此处输入图像描述](../Images/da225c0c6ac475685be764f3824e2723.png)](https://i.stack.imgur.com/AODOb.png)

排列代码是蛮力的；我只是查看了输出并直接创建了 Visio 图表。没有什么花哨。

```
(ns print-test
  (:require [clojure.pprint :as pp]))

(defrecord tr000 [val])
(defrecord tr001 [val])
(defrecord tr010 [val])
(defrecord tr011 [val])
(defrecord tr100 [val])
(defrecord tr101 [val])
(defrecord tr110 [val])
(defrecord tr111 [val])

;;(defmethod print-method       tr000 [obj writer]  (.write writer "tr000 print-method"))
;;(defmethod print-dup          tr000 [obj writer]  (.write writer "tr000 print-dup"))
;;(defmethod pp/simple-dispatch tr000 [obj]         (.write *out* "tr000 simple-dispatch"))

;;(defmethod print-method       tr001 [obj writer]  (.write writer "tr001 print-method"))
;;(defmethod print-dup          tr001 [obj writer]  (.write writer "tr001 print-dup"))
(defmethod pp/simple-dispatch tr001 [obj]         (.write *out* "tr001 simple-dispatch"))

;;(defmethod print-method       tr010 [obj writer]  (.write writer "tr010 print-method"))
(defmethod print-dup          tr010 [obj writer]  (.write writer "tr010 print-dup"))
;;(defmethod pp/simple-dispatch tr010 [obj]         (.write *out* "tr010 simple-dispatch"))

;;(defmethod print-method       tr011 [obj writer]  (.write writer "tr011 print-method"))
(defmethod print-dup          tr011 [obj writer]  (.write writer "tr011 print-dup"))
(defmethod pp/simple-dispatch tr011 [obj]         (.write *out* "tr011 simple-dispatch"))

(defmethod print-method       tr100 [obj writer]  (.write writer "tr100 print-method"))
;;(defmethod print-dup          tr100 [obj writer]  (.write writer "tr100 print-dup"))
;;(defmethod pp/simple-dispatch tr100 [obj]         (.write *out* "tr100 simple-dispatch"))

(defmethod print-method       tr101 [obj writer]  (.write writer "tr101 print-method"))
;;(defmethod print-dup          tr101 [obj writer]  (.write writer "tr101 print-dup"))
(defmethod pp/simple-dispatch tr101 [obj]         (.write *out* "tr101 simple-dispatch"))

(defmethod print-method       tr110 [obj writer]  (.write writer "tr110 print-method"))
(defmethod print-dup          tr110 [obj writer]  (.write writer "tr110 print-dup"))
;;(defmethod pp/simple-dispatch tr110 [obj]         (.write *out* "tr110 simple-dispatch"))

(defmethod print-method       tr111 [obj writer]  (.write writer "tr111 print-method"))
(defmethod print-dup          tr111 [obj writer]  (.write writer "tr111 print-dup"))
(defmethod pp/simple-dispatch tr111 [obj]         (.write *out* "tr111 simple-dispatch"))

(def t000 (->tr000 10))
(def t001 (->tr001 20))
(def t010 (->tr010 30))
(def t011 (->tr011 40))
(def t100 (->tr100 50))
(def t101 (->tr101 60))
(def t110 (->tr110 70))
(def t111 (->tr111 80))
(def recs [t000 t001 t010 t011 t100 t101 t110 t111])

(def dt (java.time.LocalTime/now))
(defmethod print-dup java.time.LocalTime [obj writer] (.write writer "datetime_dup"))

(println "(pr ...) outputs the following")
(doseq [rec recs]
  (doseq [prppd [nil #(.write *out* "pprint-dispatch with" %)]]
    (binding [pp/*print-pprint-dispatch*
              (if prppd #(.write *out* (str "pprint-dipatch-with" %))
                  pp/*print-pprint-dispatch*)]
      (doseq [pd [false true]]
        (binding [*print-dup* pd]
          (let [ppdstr (format "%6s" (boolean pp/*print-pprint-dispatch*))
                dupstr (format "%6s" *print-dup*)
                outstr (pr-str rec)]
            (binding [*print-dup* false]
              (println ppdstr dupstr ":" outstr))))))))

(println "\n(pprint ...) outputs the following")
(doseq [rec recs]
  (doseq [prppd [false true]]
    (binding [pp/*print-pprint-dispatch*
              (if prppd #(.write *out* (str "pprint-dipatch-with" %))
                  pp/*print-pprint-dispatch*)]
      (doseq [pd [false true]]
        (binding [*print-dup* pd]
          (let [outstr
                (with-out-str
                  (pp/pprint {:ppdstr prppd
                              :dupstr pd
                              :dt dt
                              :strobj rec}))]
            (binding [*print-dup* false]
              (println outstr "\n")))))))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-30T13:52:23.080

也许不理想，但我还没有找到比[`pr`](https://clojuredocs.org/clojure.core/pr)and更好的[`pr-str`](https://clojuredocs.org/clojure.core/pr-str)。

示例 REPL 会话：

```
 (ns my-ns)

  (defprotocol Foo
    (bazfn [this]))

  (defrecord Bar [a]
    Foo
    (bazfn [this] 123))

  (pr-str (Bar. "ok")) ;;=> "#my_ns.Bar{:a \"ok\"}"
  (pr (Bar. "ok"))     ;; prints the same as above 
```

# java - 在网络调用期间显示 ProgressDialog 直到它完成

> ID：15179517
> 
> 赞同：3
> 
> 时间：2013-03-02T21:14:43.693
> 
> 标签：java, android

我**很**沮丧，因为我在等待网络调用时一直在尝试实现一个超级简单的加载轮。我已经搜索并阅读了数十个 SO 问题，我只是觉得我一定错过了一些东西，除非没有人真正做我想做的事情。我试过沿着这`AsyncTask`条路线走，但这不是我想要的。

我还要说，现在我的应用程序运行良好，只是从屏幕到屏幕的转换似乎挂起，因为它在网络上等待。我只想要一个加载轮，以便在 1-2 秒内用户知道应用程序正在运行并且没有冻结。

这是我当前的网络调用的样子：

```
 private static String sendDataToServer(String arg1, String arg2)
 {        
    Thread dbThread = new Thread()
    {
        public void run()
        {
             // do the call that takes a long time    
        }
    };
    dbThread.start();
    try {
        // I do this so that my program doesn't continue until
        // the network call is done and I have received the information
        // I need to render my next screen
        dbThread.join();
    }
    catch (InterruptedException e) {
        e.printStackTrace();
    }
 } 
```

现在，为什么我不能`ProgressDialog`像这样添加？如果我这样做，progressDialog 永远不会出现。

```
 private static String sendDataToServer(String arg1, String arg2)
 {
    final ProgressDialog progress = new ProgressDialog(BaseActivity.getInstance());
    progress.setIndeterminate(true);
    progress.setMessage("Loading...");
    progress.show();

    Thread dbThread = new Thread()
    {
        public void run()
        {
             // do the call that takes a long time    
        }
    };
    dbThread.start();
    try {
        dbThread.join();
        progress.dismiss();
    }
    catch (InterruptedException e) {
        e.printStackTrace();
    }
 } 
```

我想我被卡住了，因为网络调用需要在与 UI 线程不同的线程上，但我不想在我的应用程序中继续，因为我需要该调用的结果才能继续。但如果我这样做，`thread.join()`我会举起一切。我以为我需要，`AsyncTask`但很快就走下坡路了。如果你好奇的话，这是我的问题。 [Android的AsyncTask：多参数，返回值，等待](https://stackoverflow.com/questions/15153919/androids-asynctask-multiple-params-returning-values-waiting)

当这个调用发生而不继续我的应用程序的其余部分时，我怎么只显示一个加载对话框？

**编辑**

这是我的`AsyncTask`尝试。

```
private class PostToFile extends AsyncTask<PostToFile, Void, Void>{
    private String functionName;
    private ArrayList<NameValuePair> postKeyValuePairs;
    private String result = "";

    public PostToFile(String function, ArrayList<NameValuePair> keyValuePairs){
        functionName= function;
        postKeyValuePairs = keyValuePairs;
    }

    @Override
    protected void onPreExecute() {
        progressDialog = ProgressDialog.show(BaseActivity.getInstance(), "Loading", "Please wait...", true, false);
    }

    @Override
    protected Void doInBackground(PostToFile... params) {                       
        ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
        nameValuePairs.add(new BasicNameValuePair(FUNCTION_KEYWORD, functionName));
        for (int i = 0; i < postKeyValuePairs.size(); i++)            {
            nameValuePairs.add(postKeyValuePairs.get(i));
        }

        try{
            // ***do the POST magic.***
            result = response.toString();
        }
        catch (Exception e){
             // clean up my mess
        }

        return null;
    }

    private String getResult(){
        return result; // can I use this somehow???
    }

    @Override
    protected void onPostExecute(Void result) {
        progressDialog.dismiss();
    }
 } 
```

当我使用它时：

```
 new PostToPHP(FUNCTION_NAME, postPairings){
            @Override
            protected void onPostExecute(String result) {
                super.onPostExecute(result);
                try
                {
                    if (result != null && !result.startsWith("null"))
                    {
                        JSONArray jArray = new JSONArray(result);
                        parseData(jArray);
                    }
                }
                catch (JSONException e)
                {
                    Log.e(Constants.LOG_TAG, e.toString());
                }
            };
        }.execute() 
```

问题是，我有几个这样的电话是背靠背的，它们都是相互依赖的。所以第一个开始，第二个在第一个开始之后**立即**开始，但**在**第一个**完成**之前开始。所以我得到错误的行为。只有在第一个电话完全完成后，我才能开始第二个电话？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:28:58.453

也许这会起作用，我还没有测试过，但你可以试试：

```
public class MyTask extends AsyncTask<String, Void, String> {
    private int flag;

    public MyTask(int flag) {
        this.flag = flag;
    }

    @Override
    protected String doInBackground(String... params) {
        switch (flag) {
            case 1:
                return doNetworking1();
            break;
            case 2:
                return doNetworking2();
            break;
            case 3:
                return doNetworking3();
            break;
            default:
                return doNetworking1();

        }
    }

    @Override
    protected void onPreExecute() {
        //show progress dialog
    }

    @Override
    protected void onPostExecute(String s) {
        //hide progress dialog
        switch (flag) {
            case 1: //do something with result
                new MyTask(2).execute();
                break;
            case 2: //do other stuff
                new MyTask(3).execute();
                break;
            case 3: //do event more stuff
                break;
            default:
                //do something
        }
    }
} 
```

和用法：

```
new MyTask(1).execute(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:20:52.607

在网络连接的情况下，我会使用`IntentService`而不是`AsyncTask`.

例如为网络连接创建 IntentServices：

```
 public class NetworkCallIntentService extends IntentService {
    public static final String BROADCAST_ACTION = "com.yourpackage:NETWORK_CALL_BROADCAST";
    public static final String RESULT = "com.yourpackage:NETWORK_CALL_RESULT";

    public NetworkCallIntentService() {
        super(NetworkCallIntentService.class.getSimpleName());
    }

    @Override
    protected void onHandleIntent(Intent intent) {
        // get data from intent if needed
        // do the call that takes long time  
        // send broadcast when done
        Intent intent = new Intent(BROADCAST_ACTION);
        intent.putExtra(RESULT, "some_result");//and more results
        LocalBroadcastManager.getInstance(this).sendBroadcast(intent);
    }
} 
```

接下来，从活动启动该服务，显示进度对话框并将负责显示下一个屏幕的代码移动到`BroadcastReceiver#onReceive()`方法：

```
 public class SomeActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        //start service
        Intent serviceIntent = new Intent(this, NetworkCallIntentService.class);
        //put extras into intent if needed
        //serviceIntent.putExtra("some_key", "some_string_value");
        startService(serviceIntent);
        //here just show progress bar/progress dialog
    }

    @Override
    protected void onResume() {
        super.onResume();
        LocalBroadcastManager.getInstance(getApplicationContext()).registerReceiver(mNetworkCallReceiver,
                new IntentFilter(NetworkCallIntentService.BROADCAST_ACTION));
    }

    @Override
    protected void onPause() {
        super.onPause();
        LocalBroadcastManager.getInstance(getApplicationContext()).unregisterReceiver(mNetworkCallReceiver);
    }

    private BroadcastReceiver mNetworkCallReceiver = new BroadcastReceiver() {

        @Override
        public void onReceive(Context context, Intent intent) {
            //hide progress bar/progress dialog
            //here get results from intent extras
            String result = intent.getStringExtra(NetworkCallIntentService.RESULT);
            //process results and continue program(go to next screen, show error message etc.)
        }

    }

} 
```

在清单文件中声明服务：

```
<service
    android:name="com.yourpackage.DownloadSvtValuesIntentService"
    android:exported="false" >
</service> 
```

# jquery - 如何强制 jquery ui 菜单或类似菜单水平显示第二个子菜单项

> ID：15179521
> 
> 赞同：0
> 
> 时间：2013-03-02T21:15:27.670
> 
> 标签：jquery, css, jquery-ui, jquery-plugins, jquery-ui-menu

菜单有 3 个级别。第一级只有一个名为“全部显示”的项目。第二级包含产品类别。第三级包含子类别。没有更多的菜单级别。

子类别必须水平显示：

```
Show all
+-----------+
|Category1  |+-----------------------------------------------------------+
|Category2 >|| Subcategory21  Subcategory24  Subcategory27  Subcategory2A|
|Category3  || Subcategory22  Subcategory25  Subcategory28  Subcategory2B|
+-----------+| Subcategory23  Subcategory26  Subcategory28               |
             +-----------------------------------------------------------+ 
```

我尝试了 jquery ui menu menu 小部件来实现这一点。子类别垂直显示。如何更改它以使子类别水平显示？

可以为此修补jquery ui，还是有其他一些允许这样做的控件。子菜单必须在鼠标悬停时打开。jquery-ui 菜单允许使用鼠标悬停打开，但我还没有找到水平渲染第三级的方法。

在运行时从数据库中读取数据。使用jquery、jquery ui、ASP.NET/Mono MVC2

**更新**

演示位于[http://jsfiddle.net/cNgG5/](http://jsfiddle.net/cNgG5/)

```
<ul id="menu" style="width:110px">
    <li><a href="#">Category</a>

        <ul>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
            <li><a href="#">Submenu</a>
            </li>
        </ul>
    </li>
<script>    
$(function () {
    $("#menu").menu();
} );
</script> 
```

将光标移动到类别和单列菜单出现。如何将其呈现到多个列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:19:44.477

你可以使用 CSS。例如，给所有子类别一个类并设置 float:left。当然，我需要更多信息来更好地帮助你。如果您可以在 jsfiddle 中上传您的代码，那就更好了。

好的，我在这里尽可能简单地为您的组水平菜单提供现场演示。您应该为每个组包含 1 li，并为每个实时输入 div，并且仅借助 css 就可以做您想做的事情。

[jQuery UI 水平分组菜单](http://jsfiddle.net/c7DUb/)

```
<ul id="menu" style="width:110px">
    <li><a href="#">Category</a>

        <ul>
            <li>
                <div><a href="">submenu</a></div>
                <div><a href="">submenu</a></div>
                <div><a href="">submenu</a></div>
            </li>
            <li>
                <div><a href="">submenu</a></div>
                <div><a href="">submenu</a></div>
            </li>
            <li>
                <div><a href="">submenu</a></div>
                <div><a href="">submenu</a></div>
                <div><a href="">submenu</a></div>
                <div><a href="">submenu</a></div>
            </li>
        </ul>
    </li>
</ul> 
```

而css会是这样的：

```
#menu{width:400px;float:left;}
#menu  li ul li{
    width:100px;
    float:left;
    word-wrap: break-word;
}
#menu li ul li div{
    width:100px;
    float:left;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T07:29:43.697

在 jquery-ui-1.10.1.custom.ss （或您在它下使用的任何等效项）中输入：

```
.ui-menu {
    width: 30em; /* or whatever width you want it to be */
} 
```

和

```
.ui-menu-item {
    display: inline-block;
    width: 100% /* TAKE THIS OUT! */
} 
```

**更新：**

对不起..我没有做足够的测试..改为这样做（代码中提供的解释） [http://jsfiddle.net/cNgG5/7/](http://jsfiddle.net/cNgG5/7/)

```
/* this only applies to the first level submenu.. the 30em can be replaced with whatever width 
   you want the menu to appear in */
#menu>.ui-menu-item .ui-menu {
    width: 30em;
}
/* this only applies to the items in the first level submenu.. for them to 
stack up next to each other, we want to override the width: 100% given in 
.ui-menu .ui-menu-item, without affecting the first level menu
(that was the problem with my previous answer) */
#menu>.ui-menu-item .ui-menu .ui-menu-item {
    display: inline-block;  
    width: auto;
} 
```

**技巧：**使用[直接子](http://reference.sitepoint.com/css/childselector)选择器。

**注意：**如果您的最终解决方案有多个级别的子菜单（即 menue->submenu->submenu 等）..那么您可以重复上述过程..只需将上述样式应用到正确的级别即可。

# r - xts 赋值更改列类

> ID：15179528
> 
> 赞同：2
> 
> 时间：2013-03-02T21:16:34.563
> 
> 标签：r, xts

我有一个 data.frame earlyCloses 定义如下：

```
earlyCloses <- read.table('EarlyCloses.txt', header=T, colClasses= c(rep("character", 3)))
earlyCloses

   StartDate    EndDate EarlyClose
1 2012-12-24 2012-12-24      13:00 
```

我定义了一个 xts 对象 priceXts，如下所示：

```
prices <- read.table('sample.txt', header=T, colClasses=c("character", "numeric"))
pricesXts = xts(prices$Close, as.POSIXct(prices$Date, tz='America/New_York'))
colnames(pricesXts) = c("Close")
pricesXts$CloseTime = NA
pricesXts

              Close CloseTime
2012-12-21 13190.84        NA
2012-12-24 13139.08        NA
2012-12-26 13114.59        NA
2012-12-27 13096.31        NA
2012-12-28 12938.11        NA 
```

现在我在 earlyClose 的行上执行一个 for 循环并设置 priceXts 的 CloseTime。

```
for (i in 1:nrow(earlyCloses)) {
   pricesXts[paste(earlyCloses[i,"StartDate"], earlyCloses[i,"EndDate"], sep='/'), 2] = earlyCloses[i,"EarlyClose"]
}
pricesXts

           Close      CloseTime
2012-12-21 "13190.84" NA       
2012-12-24 "13139.08" "13:00"  
2012-12-26 "13114.59" NA       
2012-12-27 "13096.31" NA       
2012-12-28 "12938.11" NA 
```

为什么 xts 对象中 Close 列的类从数字变为字符？这是因为 xts 对象在内部表示为矩阵吗？有没有办法避免这种转换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:04:17.663

`xts`在内部编码为矩阵（更好的性能）。由于您只想存储 Early Close，因此可以将其转换为 numeric ，例如：

```
strptime(earlyCloses$EarlyClose,'%H:%M')$hour 
```

然后

```
for (i in 1:nrow(earlyCloses))
   pricesXts[paste(earlyCloses[i,"StartDate"], 
                   earlyCloses[i,"EndDate"], 
                   sep='/'), 2] <- strptime(earlyCloses$EarlyClose,'%H:%M')$hour

           Close CloseTime
2012-12-21 13191        NA
2012-12-24 13139        13
2012-12-26 13115        NA
2012-12-27 13096        NA
2012-12-28 12938        NA 
```

# c# - 如何遍历网格算法

> ID：15179531
> 
> 赞同：2
> 
> 时间：2013-03-02T21:16:45.323
> 
> 标签：c#

我正在寻找一种可以遍历网格并将其转换为具有新顺序索引的另一个网格的算法。

基本上，给定一个大小为 n*m 的网格：

```
1_1 1_2 1_3 ... 1_n
2_1 2_2 2_3 ... 2_n
.
.
.
m_1 m_2 m_3 ... m_m 
```

我怎样才能将其转换为：

```
1_1 1_2 1_4 ...
1_3 1_5 ...
1_6 ...
...
.
.
. 
```

假设您遍历第一个网格，在顶行从左到右，然后在第二行从左到右，一直到，在底行从左到右。

基本上我将元素推入一个上三角形。

另一个问题是我如何仅通过知道 n 和 m 来计算用于存储三角形的网格的长度和宽度？有公式吗？

例如，一个 5*6 的网格，变成了 8*7...

```
1  2  3  4  5
6  7  8  9  10
11 12 13 14 15
16 17 18 19 20
21 22 23 24 25
26 27 28 29 30 
```

变成：

```
 1  2  4  7  11 16 22 29
 3  5  8  12 17 23 30
 6  9  13 18 24
 10 14 19 25
 15 20 26
 21 27
 28 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:59:38.337

以下似乎对我有用：

```
public static T[,] ConvertToUpperTriangle<T>(T[,] arr)
{
    // calculate the dimensions
    int elements = arr.GetLength(0) * arr.GetLength(1);

    double rows = 0.5 * (Math.Sqrt(8 * elements + 1) - 1);

    int newHeight = (int)rows;
    int newWidth = (int)Math.Ceiling(rows);

    // create the new array
    var arr2 = new T[newHeight, newWidth];

    int j = 0;
    int i = 0;
    foreach (T element in arr)
    {
        arr2[j, i] = element;
        i--;
        j++;
        if (i < 0)
        {
            i = j;
            j = 0;
        }
    }

    return arr2;
} 
```

来自`0.5 * (Math.Sqrt(8 * elements + 1) - 1)`运行`sum from 1 to n of n`，然后`solve a = 0.5 * n * (n + 1) for n`通过[Wolfram Alpha](http://www.wolframalpha.com/)。

**编辑：**

您可以获得索引`i`和`j`给定`index`的如下：

```
int rows = (int)(0.5 * (Math.Sqrt(8 * index + 1) - 1));

int bottomLeft = (int)(0.5 * rows * (rows + 1));
int difference = index - bottomLeft;

int i;
int j;

if (bottomLeft == index)
{
    i = 0;
    j = rows - 1;
}
else
{
    i = rows + 1 - difference;
    j = difference - 1;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T21:25:40.423

让我们定义起始网格 NxM 中每个网格元素 (i,j) 的“序数位置”O(i,j)，即函数 (i,j) -> i*N + j。

现在对于小于 O(i,j) 的最大三角形数，将其称为 T == (k(k+1)/2 对于某个 k，我们的 (i,j) 的新网格位置将是： (i, j) -> ( O(i,j) - T, k + T - O(i,j) )

* * *

现在替换 O(i,j) 和 T 得到：

(i,j) -> ( i*N + j - k(k+1)/2, k + (k+1)(k+2)/2 - i*N + j)

= ( i*N + j - k(k+1)/2, (k+1)(k+2)/2 - i*N + j)

* * *

这是我现在所能得到的。

**更新：** 再次注意 k 是三角形数 T == k(k+1)/2 的边长。

# php - 优化使用大量 for 循环的 PHP 代码

> ID：15179533
> 
> 赞同：-4
> 
> 时间：2013-03-02T21:16:50.493
> 
> 标签：php, c++, c, actionscript-3, optimization

我的 PHP 代码包含很多 foreach 循环，结果绝对是灾难性的。运行时间太长了。

有没有替代方案。我愿意接受所有建议。

我在想可能正在实现一个基于 Flash 的客户端并使用 actionscript 来利用客户端的 CPU 来运行逻辑。

或者有没有办法使用 C/C++ 来处理服务器本身的计算要求高的部分并返回 PHP 结果。

以下函数被调用 1,000,000 次。

```
public function performEnrichmentAnalysis($geneSet) {
    /**
     * $mainArray is a multi dimentional array.
     * EntrezID | Set (0/1) | pValue | rank
     */
    $mainArray = array();
    $finalArray = array();
    $originalGenesScore = 0;
    $randomGenesScore = 0;
    $u = 0;
    $EntrezID = array();
    $Set = array();
    $pValue = array();
    $Rank = array();
    $originalGenes = $geneSet->getGenes();
    $memeberCount = $geneSet->getGeneCount();
    $randomGenes = $this->geneExpressionData->getRandomGenes($memeberCount);
    /**
     * Copy the elements of original and random gene sets to main array.
     */
    foreach ($originalGenes as $key => $value) {
        $pVal = $this->geneExpressionData->getExpressionValue($value);
        $array = array('EntrezID' => $value, 'Set' => 0, 'pValue' => $pVal, 'Rank' => 999);
        array_push($mainArray, $array);
        unset($array);
    }
    foreach ($randomGenes as $key => $value) {
        $pVal = $this->geneExpressionData->getExpressionValue($value);
        $array = array('EntrezID' => $value, 'Set' => 1, 'pValue' => $pVal, 'Rank' => 999);
        array_push($mainArray, $array);
        unset($array);
    }
    /**
     * sort the multi dimentaional array based on p-values
     */
    foreach ($mainArray as $key => $row) {
        $EntrezID[$key] = $row['EntrezID'];
        $Set[$key] = $row['Set'];
        $pValue[$key] = $row['pValue'];
        $Rank[$key] = $row['Rank'];
    }
    array_multisort($pValue, SORT_ASC, $mainArray);

    /**
     * Assign ranks to the genes
     */
    for ($index = 0; $index < count($mainArray); $index++) {
        $row = $mainArray[$index];
        $row['Rank'] = $index + 1;
        $row['Score'] = 0;
        //print_r($row['Rank']);
        array_push($finalArray, $row);
    }

    /**
     * Calculate scores for each gene
     */
    for ($i = 0; $i < count($finalArray); $i++) {
        for ($j = $i + 1; $j < count($finalArray); $j++) {
            if ($finalArray[$j]['Set'] != $finalArray[$i]['Set']) {
                $finalArray[$i]['Score']++;
            }
        }
    }

    /**
     * Calculate score for the entire set and get universal U and z score.
     */
    for ($counter = 0; $counter < count($finalArray); $counter++) {
        if ($finalArray[$counter]['Set'] == 0) {
            $originalGenesScore += $finalArray[$counter]['Score'];
        }
        if ($finalArray[$counter]['Set'] == 1) {
            $randomGenesScore += $finalArray[$counter]['Score'];
        }
    }

    if ($originalGenesScore > $randomGenesScore) {
        $u = $randomGenesScore;
    } else {
        $u = $originalGenesScore;
    }

    $zNumerator = $u - (($memeberCount * $memeberCount) / (2));
    $zDenominatorSquared = ($memeberCount * $memeberCount * ($memeberCount + $memeberCount + 1)) / 12;

    $z = $zNumerator / sqrt($zDenominatorSquared);

    if (abs($z) > 2.303) {
        $this->temp001++;
    } elseif (abs($z) > 1.605) {
        $this->temp005++;
    } else {
        $this->tempRemaining++;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T23:42:11.957

嗯，这不是一个可以轻易回答的问题。是的，假设你知道 C++，代码可以用 C++ 重写。我认为这没有任何重大障碍。

您必须想出一种方法将您的原始`geneSet`代码转换为 C++ 代码，然后构建一个结构来表示您`$mainArray`和其他 . 用于`std::vector`您的阵列。

由于此代码本身实际上并不生成任何 Web 内容，因此您可以很容易地用调用安装在服务器上的 C++ 程序替换该函数。我建议你实际上在 C++ 中实现 CALLS 这个函数的功能，因为如果这被调用了 1M 次，那么你最好在 C++ 中进行 1M 次调用，而不是调用一段 C++ 代码 1M 次。

# arrays - 排序矩阵中的第 K 个最小元素

> ID：15179536
> 
> 赞同：26
> 
> 时间：2013-03-02T21:17:11.600
> 
> 标签：arrays, algorithm, data-structures, matrix, multidimensional-array

这是一道面试题。

找到具有已排序行和列的矩阵中的第K^(个最小元素。)^(第 K个) 最小的元素是其中之一是否
正确？^(`a[i, j]``i + j = K`)

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-03-02T21:28:23.133

错误的。

考虑一个像这样的简单矩阵：

```
1 3 5
2 4 6
7 8 9 
```

9 是最大（第 9 小）的元素。但是 9 在 A[3, 3] 和 3+3 != 9 处。（无论您使用什么索引约定，它都不正确）。

* * *

您可以在 O(k log n) 时间内通过增量合并行来解决此问题，并增加一个堆以有效地找到最小元素。

基本上，您将第一列的元素放入堆中并跟踪它们来自的行。在每一步中，您从堆中删除最小元素并从它所在的行中推送下一个元素（如果您到达行的末尾，那么您不会推送任何东西）。删除最小值和添加新元素都需要 O(log n)。在第 j 步，您删除了`j`第 th 个最小的元素，因此在`k`步骤之后，您完成了`O(k log n)` 操作的总成本（其中 n 是矩阵中的行数）。

对于上面的矩阵，您最初从`1,2,7`堆中开始。您删除`1`并添加`3`（因为第一行是`1 3 5`）以获得`2,3,7`. 您删除`2`并添加`4`以获取`3,4,7`. 删除`3`并添加`5`以获取`4,5,7`. 删除`4`并添加`6`以获取`5,6,7`. 请注意，我们正在按全局排序顺序删除元素。你可以看到继续这个过程将`k`在 k 次迭代后产生第 th 个最小的元素。

（如果矩阵的行多于列，则改为对列进行操作以减少运行时间。）

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-09-23T18:18:50.393

`O(k log(k))`解决方案。

*   建立一个minheap。

*   添加`(0,0)`到堆中。然而，我们还没有找到`kth`最小的元素，`(x,y)`从堆中删除顶部元素并添加接下来的两个元素`[(x+1,y)`，`(x,y+1)]`如果它们之前没有被访问过。

我们正在`O(k)`对大量大小`O(k)`和复杂性进行操作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2020-04-19T10:56:32.897

这个问题可以使用二进制搜索和排序矩阵中的优化计数来解决。二进制搜索需要*O(log(n))*时间，对于每个搜索值，平均需要*n*次迭代才能找到小于搜索数字的数字。二分搜索的搜索空间仅限于矩阵中的最小值`mat[0][0]`和最大值`mat[n-1][n-1]`。

对于从二进制搜索中选择的每个数字，我们需要计算小于或等于该特定数字的数字。因此![第k^th](../Images/057110e8bf914fc4a8c07720873e926d.png)可以找到最小的数字。

为了更好地理解，您可以参考此视频：

[https://www.youtube.com/watch?v=G5wLN4UweAM&t=145s](https://www.youtube.com/watch?v=G5wLN4UweAM&t=145s)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-11T23:55:10.423

从左上角 (0,0) 开始遍历矩阵，并使用二进制堆来存储“边界”——矩阵的已访问部分与其其余部分之间的边界。

Java中的实现：

```
private static class Cell implements Comparable<Cell> {

    private final int x;
    private final int y;
    private final int value;

    public Cell(int x, int y, int value) {
        this.x = x;
        this.y = y;
        this.value = value;
    }

    @Override
    public int compareTo(Cell that) {
        return this.value - that.value;
    }

}

private static int findMin(int[][] matrix, int k) {

    int min = matrix[0][0];

    PriorityQueue<Cell> frontier = new PriorityQueue<>();
    frontier.add(new Cell(0, 0, min));

    while (k > 1) {

        Cell poll = frontier.remove();

        if (poll.y + 1 < matrix[poll.x].length) frontier.add(new Cell(poll.x, poll.y + 1, matrix[poll.x][poll.y + 1]));
        if (poll.x + 1 < matrix.length) frontier.add(new Cell(poll.x + 1, poll.y, matrix[poll.x + 1][poll.y]));

        if (poll.value > min) {
            min = poll.value;
            k--;
        }

    }

    return min;

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-10-30T20:34:41.193

上述解决方案无法处理对角线条件，不能应用于以下矩阵

```
int arr2[][] = { { 1, 4, 7, 11, 15 }, 
                 { 2, 5, 8, 12, 19 }, 
                 { 3, 6, 9, 16, 22 }, 
                 { 10, 13, 14, 17, 24 },
                 { 18, 21, 23, 26, 30 } } 
```

k=5

返回 7 而答案是 5

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-22T04:04:46.733

似乎这只是使用该功能：每一行都已排序，但不使用其按列排序的功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-16T20:25:30.703

正如人们之前提到的，最简单的方法是构建一个`min heap`. 这是使用 PriorityQueue 的 Java 实现：

```
private int kthSmallestUsingHeap(int[][] matrix, int k) {

    int n = matrix.length;

    // This is not necessary since this is the default Int comparator behavior
    Comparator<Integer> comparator = new Comparator<Integer>() {
        @Override
        public int compare(Integer o1, Integer o2) {
            return o1 - o2;
        }
    };

    // building a minHeap
    PriorityQueue<Integer> pq = new PriorityQueue<>(n*n, comparator);
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < n; j++) {
            pq.add(matrix[i][j]);
        }
    }

    int ans = -1;
    // remove the min element k times
    for (int i = 0; i < k; i++) {
        ans = pq.poll();
    }

    return ans;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-28T18:38:20.957

矩阵中的第 K 个最小元素：

问题可以缩小如下。

如果 k 为 20，则取 k*k 矩阵（答案肯定在哪里。）

现在您可以重复合并成对的行以构建排序数组，然后找到第 k 个最小的数字。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-03-22T05:33:01.233

```
//int arr[][] = {{1, 5, 10, 14},
//        {2, 7, 12, 16},
//        {4, 10, 15, 20},
//        {6, 13, 19, 22}
//};
// O(k) Solution
public static int myKthElement(int arr[][], int k) {
    int lRow = 1;
    int lCol = 0;
    int rRow = 0;
    int rCol = 1;
    int count = 1;

    int row = 0;
    int col = 0;

    if (k == 1) {
        return arr[row][col];
    }

    int n = arr.length;
    if (k > n * n) {
        return -1;
    }

    while (count < k) {
        count++;

        if (arr[lRow][lCol] < arr[rRow][rCol]) {
            row = lRow;
            col = lCol;

            if (lRow < n - 1) {
                lRow++;
            } else {
                if (lCol < n - 1) {
                    lCol++;
                }

                if (rRow < n - 1) {
                    lRow = rRow + 1;
                }
            }
        } else {
            row = rRow;
            col = rCol;

            if (rCol < n - 1) {
                rCol++;
            } else {
                if (rRow < n - 1) {
                    rRow++;
                }
                if (lCol < n - 1) {
                    rCol = lCol + 1;
                }
            }
        }
    }

    return arr[row][col];
} 
```

# linq - Linq 不存在多个表

> ID：15179539
> 
> 赞同：1
> 
> 时间：2013-03-02T21:17:15.320
> 
> 标签：linq

我想对查询 MULTIPLE TABLES 执行 LINQ NOT EXISTS。

Google 或 SO 上的所有示例都在处理**两个表**，我正在使用三个表，所以我作为 LINQ 的新手正在努力如何正确引用它们。

首先我尝试了这个 LINQ 查询

```
 var nocertificates = (
  from x in rmdb.t_certificates
  from ce in rmdb.t_user_certificates
  from u in rmdb.t_users
  where u.id == ce.uid && ce.value != x.id
  select x).AsEnumerable().Select(x => new ViewModelCheckBox()
      {
         Value = x.id.ToString(),
         Name = x.name,
         Checked = false
      }); 
```

我使用了丑陋的 3 次，因为我不太擅长创建连接类型。但这给出了错误的结果，我意识到我必须选择**NOT EXISTS**

所以我在 T-SQL 中构建了一个新查询

这是它工作的 SQL 查询！

```
select distinct * from t_certificates tc
where NOT EXISTS
(
select distinct * from t_users tu, t_user_certificates tuc
WHERE tu.email = 'user@email.com'
and tu.id = tuc.[uid]
and tuc.value = tc.id
) 
```

**我将如何在 LINQ 中做到这一点？**

***这就是问题，我将为此奖励我的答案！***

**但！**

当我们这样做时...我真的很好奇答案..是否可以执行一个 LINQ 查询，该查询返回一个 Ienumerable 与那些 EXISTS 和 NOT EXISTS 导致一个对象在选中时将持有不同的值属性 **EXISTS -> CHECKED = true
不存在 -> CHECKED = false**

这就是我创建对象的方式。

```
 .Select(x => new ViewModelCheckBox()
      {
         Value = x.id.ToString(),
         Name = x.name,
         Checked = this should be different based on exists or not
      }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:58:41.830

LINQ 答案应如下所示（未经测试）：

```
 var nocertificates = 
  from x in rmdb.t_certificates
  join tuc in (
    from u in rmdb.t_users
    join ce in rmdb.t_user_certificates on u.id == ce.uid 
    select ce.value 
  ) on tuc.value = tc.id into tuc
  from y in tuc.DefaultIfEmpty()
  where y == null
  select x; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-03T00:19:25.963

这就是我最终使用的！

```
var query = (from tc in rmdb.t_certificates 
             where !(
                     from tu in rmdb.t_users
                     from tuc in rmdb.t_user_certificates
                     where tu.email == username
                     && tu.id == tuc.uid
                     && tuc.value == tc.id select tc).AsEnumerable().Any() 
                     select new ViewModelCheckBox()
                                { Checked = false,
                                  intconverter = tc.id,
                                  Name = tc.name
                                }); 
```

# c# - 实体框架、WCF 和用户权限：如何实现

> ID：15179542
> 
> 赞同：0
> 
> 时间：2013-03-02T21:17:39.493
> 
> 标签：c#, entity-framework-4, permissions

我有一个应用程序，它使用存储库的库来对数据库执行所有操作。这个库有很多方法，一些用户有权执行所有操作，而其他用户则没有。

我有一个客户端应用程序，如果它安装在局域网内的计算机上，该客户端直接使用存储库连接到数据库。这样，出于性能原因，客户端不必通过 WCF 主机。

如果应用程序安装在局域网外的计算机上，则它通过 WCF 服务连接，然后使用存储库连接到数据库。

我的问题是**如何检查用户是否有权执行存储库方法**。

我正在考虑两种选择。一种是当我在存储库中创建一个对象时，它在我启动应用程序时创建，在我关闭应用程序时销毁。当我创建存储库时，我得到了所有用户的所有权限配置，所以我只对数据库执行一个查询。但是，如果应用程序很大或者我有很多用户，这会消耗大量内存，这并不好。

另一种选择是，对于存储库上的每个方法，传递两个额外的参数，用户和密码，所以每个方法做的第一件事就是向数据库查询权限。这会消耗更少的内存，但会对数据库进行更多查询。查询很简单，但是会消耗资源（连接）。

所以我想知道是否有更多选项来控制权限，或者我的第一个选项是否是一个好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T01:52:23.257

我的建议是密码或唯一访问密钥，这是第二选择，例如使用 GUID 或其他东西。您将需要单个持久性对象来服务多个请求。在每个连接上创建和销毁似乎没用。单个对象、多个连接、多个项目的多个键。跟踪对象的所有键。它是在资源方面的给予和接受。

# qt - 使用外部源在 QAbstractItemModel 中实现更改通知

> ID：15179547
> 
> 赞同：2
> 
> 时间：2013-03-02T21:18:05.970
> 
> 标签：qt, qt4, qabstractitemmodel

我正在实现一个`QAbstractItemModel`表示可以在外部更改的数据。我的模型将在更改发生后收到有关更改数据的通知，而在更改发生之前我无法收到通知。当我的模型收到更改通知时，旧数据不再可用。

据我了解文档，方法`beginInsertRows`等`beginRemoveRows`必须在更改之前调用，而旧数据仍然可用。

我的理解正确吗？如果是这样，我的替代方案是什么？

# c++ - 提升 scoped_lock 与普通锁定/解锁

> ID：15179553
> 
> 赞同：44
> 
> 时间：2013-03-02T21:18:39.417
> 
> 标签：c++, boost, thread-safety, mutex

我将使用`boost::mutex`from `boost/thread/mutex.hpp`。有几种方法可以锁定/解锁互斥锁：with `scoped_lock`, `unique_lock`, `lock_guard`, mutex 的成员函数`::lock()`and`::unlock()`和非成员函数`lock()`and `unlock()`。

我注意到，这`boost::scoped_mutex`是使用互斥锁的最流行的方式之一。为什么它比成员函数更`::lock()`可取`::unlock()`？

特别是，我为什么要使用

```
{
  boost::scoped_lock lock(mutex)
  // ...
  // read/output sharing memory.
  // ...
} 
```

而不是

```
mutex.lock()
// ...
// read/output sharing memory.
// ...
mutex.unlock() 
```

仅仅`scoped_lock`因为某些样式编码的观点而更好还是`::lock()/::unlock()`“线程足够安全”？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-03-02T21:21:37.903

> 为什么比成员函数 ::lock() 和 ::unlock() 更可取？

[与RAII 习语](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)普遍流行的原因相同（这只是其无数实例之一）：因为您可以确定在不解锁互斥锁的情况下不会离开当前范围。

请注意，这不仅仅是*忘记*调用`unlock()`：当您的互斥锁被锁定时可能会发生异常，并且您的调用可能永远无法到达，即使您的调用和调用之间`unlock()`没有任何`return`语句。`lock()``unlock()`

```
m.lock() // m is a mutex
// ...
foo(); // If this throws, your mutex won't get unlocked
// ...
m.unlock() 
```

在这种情况下，你的守卫的析构函数`scoped_lock`将在堆栈展开期间被调用，确保相关联的互斥锁*总是*被释放。

```
{
    boost::scoped_lock lock(m); // m is a mutex
    // ...
    foo(); // If this throws, your RAII wrapper will unlock the mutex
    // ...
} 
```

此外，在许多情况下，这将提高代码的可读性，因为您不必`unlock()`在每个`return`语句之前添加调用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-04-26T14:21:31.457

您可以使用

`std::lock_guard<std::mutex> lock(mutex);`

如果不想使用 boost 库。

# c++ - 需要帮助来查找错误（与指向堆栈上的变量的指针有关）

> ID：15179559
> 
> 赞同：0
> 
> 时间：2013-03-02T21:19:04.663
> 
> 标签：c++, pointers, binary-search-tree

有人可以告诉我我的程序有什么问题吗？这基本上是一个在二叉搜索树中插入新节点的程序。

问题是我的插入功能正常工作并且节点正在被插入，我正在通过行在主程序中进行验证

```
 cout<<a.left->right->right->data; 
```

其输出正确，即 5

但是当我尝试打印二叉树的级别顺序遍历时，一些垃圾值被传递来代替新节点并且程序正在崩溃

有人可以看看并向我解释我做错了什么以及如何在主程序中显示正确的值。

```
#include<iostream>
#include<string>
#include<conio.h>
#include<array>
#include<stack>
#include<sstream>
#include<algorithm>
#include<vector>
#include<ctype.h>//isdigit
#include<deque>
#include<queue>
#include<map>
using namespace::std;
struct BST
{
    int data;
    BST *left;
    BST *right;
    BST(int d,struct BST* l,BST *r):data(d) , left(l) ,right(r)
    {
    }
};

void levelOrder(struct BST *root)
{
    struct BST *temp=NULL;
    int count =0;
    deque<struct BST*> dq;
    if(!root)
    {
        return;
    }
    dq.push_back(root);
    count=dq.size();
    while(!dq.empty())
    {
        temp=dq.front();
        cout<<temp->data<<" ";
        if(temp->left)
        {
            dq.push_back(temp->left);
        }
        if(temp->right)
        {
            dq.push_back(temp->right);
        }
        dq.pop_front();
        if(--count==0)
        {
            cout<<endl;
            count=dq.size();
        }
    }
}
void Insert(struct BST*root,int data)
{
    struct BST temp(data,NULL,NULL);
    if(!root)
    {
        return;
    }
    while(root)
    {
        if((root)->data >data)
        {
            (root)=(root)->left;
            if(!(root)->left)
            {
                (root)->left=&temp;
                break;
            }
        }
        else
        {
            (root)=(root)->right;
            if(!(root)->right)
            {
                (root)->right=&temp;
                break;
            }
        }
    }
}
int main()
{
    deque<struct BST> dq1,dq2;
    BST e(4,NULL,NULL);
    BST f(3,NULL,NULL);
    BST d(1,&f,NULL);
    //BST g(4,NULL,NULL);
    BST b(2,&d,&e);
    BST c(8,NULL,NULL);
    BST a(6,&b,&c);
    levelOrder(&a);
    Insert(&a,5);
    cout<<a.left->right->right->data;
    cout<<endl;
    levelOrder(&a);
    _getch();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T21:27:37.113

`Insert`原因是因为您在函数的树中放入了指向局部变量的指针。

当一个函数返回时，它的所有局部变量都不再“活着”，并且访问指向这些局部变量之一的指针是*未定义的行为*。事实上，这些变量曾经占用的内存可能会被下一个函数调用覆盖，无论你调用什么函数。

如果要添加新节点，则需要使用 eg 在堆上分配它`new`。但是，由于您对树的设计，这将导致内存泄漏，因为您没有释放任何子节点。事实上，当您在`main`函数中使用指向局部变量的指针时（没关系，因为这些变量的生命周期`main`是整个程序的持续时间），您不能只是简单地`delete`使用指针。

# c# - WPF 效果差异

> ID：15179563
> 
> 赞同：1
> 
> 时间：2013-03-02T21:19:34.490
> 
> 标签：c#, wpf

我在两台不同的 PC 上运行相同的应用程序，两台计算机都相对较新。

其中一台 PC 显示带有效果的控件，另一台非常原始地显示它。

区别如下所示：

PC1：

![PC1](../Images/50c0f37971231428b5c42be9ae219c56.png)

PC2：

![PC2](../Images/ec66d2b3f04cfcb7fc6db89d2142dee7.png)

任何线索为什么？

构建程序时，我收到此警告：

> 正在构建的项目“MSIL”的处理器架构不匹配

但我不认为这与这个问题有任何关系。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T21:33:23.687

我有同样的问题：显示取决于运行程序的计算机的显示配置。

示例：在我的笔记本电脑上，我使用 Windows 7 中的所有效果（在高级配置中，您启用所有内容），在我的桌面上，我取消选中所有这些效果，以获得更好的性能。

两台电脑的结果会有很大的不同。（一个看起来像旧的 Windows 98，它会影响它可以显示的内容）

# php - 在 PHP 和 Mysql 中，如何在循环结束前执行 Mysql 语句并显示结果？

> ID：15179571
> 
> 赞同：0
> 
> 时间：2013-03-02T21:20:37.237
> 
> 标签：php, mysql, loops, show

我在下面有以下代码。目标是执行一个 select 语句，显示结果，然后再次执行该语句。我无法让它正常工作。当代码在没有循环的情况下执行时，它可以正常工作，但是当代码在循环内时，它就不起作用了。目标是让它永远循环，但在“当前循环运行”期间显示每个选择语句的结果。我错过了什么？我希望它显示循环的每个“运行”的结果，然后在每次成功的循环迭代将结果发送到浏览器时返回并再次执行。我试过 ob_implicit_flush 和 flush 命令。

提前致谢。

```
$query = "SELECT * FROM dict WHERE ID in (FLOOR(1 + (RAND() * 662337))) ";

for ($i=1; $i =>1; $i++) {

$result = mysql_query($query);
$row = mysql_fetch_array($result);
echo $row['word'];

}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:22:32.587

我认为最好的方法是使用 php/ajax。

```
 <html>
    <head>
    <script>
    function showQueryResult()
    {
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
        document.getElementById("txtHint").innerHTML+=xmlhttp.responseText;
        }
      }
    xmlhttp.open("GET","getQuery.php",true);
    xmlhttp.send();
    }
    </script>
    </head>
<body>
<script>setInterval("showQueryResult()",100);
<div id="txtHint" ></div>
</body>
</html> 
```

您的 getQuery.php 页面应如下所示：

```
<?php
$query = "SELECT * FROM dict WHERE ID in (FLOOR(1 + (RAND() * 662337))) ";

$result = mysql_query($query);
$row = mysql_fetch_array($result);
echo $row['word'];

?> 
```

# javascript - 将值从文本字段传递到 HTML 画布

> ID：15179578
> 
> 赞同：1
> 
> 时间：2013-03-02T21:21:12.423
> 
> 标签：javascript, jquery, html, canvas, html5-canvas

我希望将坐标从文本字段传递到 HTML5 画布。我正在使用下面的代码在画布上绘制一个矩形。坐标应该是`0,0,50,50`

```
function displayObject(currentObject){
    var imageNumber = $(currentObject).find('div.objectDd input.objectImageNum').val();
    var objectCoordinates = $(currentObject).find('div.objectDd input.objectCoordinates').val();
    var imageId = "";
    var canvasId = "";
    var context = "";
    var canvas = "";

    if(imageNumber != "" && objectCoordinates != ""){
        imageId = "#imgNum".concat(imageNumber);
        canvasId = $('#objectData').find('#miImages '+imageId+' .imageContainer canvas').attr("id");
        canvas = document.getElementById(canvasId);
        context = canvas.getContext("2d");
        context.fillStyle = "#FF0000";
        context.fillRect(objectCoordinates);
    }
} 
```

我尝试将它们作为变量传递，`objectCoordinates`但未绘制矩形。

如何传递用户输入的坐标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:26:23.713

现在，objectCoordinates 是一个字符串。您需要提取用户传入的数字：

```
var coordinateArray = objectCoordinates.split(",") 
```

然后一一传入：

```
context.fillRect(coordinateArray[0],
                 coordinateArray[1],
                 coordinateArray[2],
                 coordinateArray[3]) 
```

此外，无需使用字符串初始化变量，尤其是像 canvas 和 context 这样最终根本不是字符串的变量。

# c# - 使用 GetFileSystemInfos() 获取 DirectoryInfo 时出错

> ID：15179580
> 
> 赞同：0
> 
> 时间：2013-03-02T21:21:29.837
> 
> 标签：c#, directory, directoryinfo

当我尝试获取 a 时出现错误，`DirectoryInfo`因为有一些只读文件和文件夹。

我怎样才能跳过它们？

```
var dirinfo = new DirectoryInfo(Path_Tb_Path.Text);
var entries = dirinfo.GetFileSystemInfos("**", SearchOption.AllDirectories); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:01:37.650

在 .NET 4.0 中，您可以使用该[`EnumerateFileSystemInfos`](http://msdn.microsoft.com/en-us/library/dd383689.aspx)方法。例如，您可以编写以下递归方法，该方法将吞下`UnauthorizedAccessException`某些文件，并且仅将那些文件包含在您有权访问的结果中：

```
public static IEnumerable<FileSystemInfo> SafeGetFileSystemInfosRecursive(DirectoryInfo directory, string searchPattern)
{
    try
    {
        return directory
            .EnumerateFileSystemInfos(searchPattern)
            .Concat(
                directory
                    .EnumerateDirectories()
                    .SelectMany(x => SafeGetFileSystemInfosRecursive(x, searchPattern))
            );
    }
    catch (UnauthorizedAccessException)
    {
        return Enumerable.Empty<FileSystemInfo>();
    }
} 
```

然后像这样调用方法：

```
var dirInfo = new DirectoryInfo(Path_Tb_Path.Text);
FileSystemInfo[] entries = SafeGetFileSystemInfosRecursive(dirInfo, "**").ToArray(); 
```

# java - Java将对象转换为类型？

> ID：15179584
> 
> 赞同：0
> 
> 时间：2013-03-02T21:21:42.263
> 
> 标签：java

我想选择 JList 中特定于患者已经单击的项目。如果我点击第三位患者，JList 将选择患者选择的项目。

PatientConList 中是该患者的条件对象。

**添加患者时，请执行以下操作：**

```
List PatientConditions1 = new ArrayList();
PatientConditions1 =  ConditionsJList.getSelectedValuesList(); 
```

**然后，当您单击患者时，它会执行此操作**

```
public void MakePatientJListSelected(ArrayList PatientConList) {
    //this makes selected, so get condition array off patient.
    //so call this from patient jlist listener
    ConditionsJList.clearSelection();
    //get number - 1, so then 0 = first
    ArrayList<Conditions> PassedIn = PatientConList;
    ArrayList SelectList = new ArrayList();

    for(Conditions p: PassedIn)
    {
       int Num = p.getNumber();
       Num = Num - 1;
       SelectList.add(Num);
    }    

    //int startSel = 0;
    //int endSel = 0;
    //ConditionsJList.setSelectionInterval(startSel, endSel);

    for(int k=0;k<PassedIn.size();k++)
    {
        int startSel2 = k;
        int endSel2 = k;
        ConditionsJList.addSelectionInterval(startSel2, endSel2);
    }    
} 
```

对不起，基本上我有一个 JList，你可以选择你想要的条件，然后单击添加。这会将条件列表添加到患者。

基本上，当您选择要查看的患者时，我想要它以便在 jlist 上选择该患者的 jlist 条件。

我在线程“AWT-EventQueue-0”java.lang.ClassCastException 中收到此错误异常：java.lang.String 无法转换为 DentistAppNew.Conditions

我的病人班：

```
import java.util.*;

public class Patient {

private int AccountNumber;
private String Name;
private int Age;
private String Address;
private String  Sex;
private String Phone;
private List<Conditions> ConditionNames;

public Patient( int AccountNumber1,
                String Name1, 
                int Age1, 
                String Address1, 
                String Sex1, 
                String Phone1, 
                List<Conditions> ConditionNames1)
{                
    this.AccountNumber = AccountNumber1;
    this.Name = Name1;
    this.Age = Age1;
    this.Address = Address1;
    this.Sex = Sex1;
    this.Phone = Phone1;
    this.ConditionNames = ConditionNames1
}

public  int getAccountNumber() { return AccountNumber; }

public  String getName() { return Name; }

public int getAge() { return Age; }

public String getAddress() { return Address; }

public String getSex() { return Sex; }

public String getPhone() { return Phone; }

public List getConditionsList() { return ConditionNames; }

public  void setName(String Name1) { this.Name = Name1; }

public void setAge(int Age1) { this.Age = Age1; }

public void setAddress(String Address1) { this.Address = Address1; }

public void setSex(String Sex1) { this.Sex = Sex1; }

public void setPhone(String Phone1) { this.Phone = Phone1; }

} 
```

我的条件类：

```
public class Conditions {

    private int Number;
    private String Name;

    public Conditions( int Number1,String Name1) {
        this.Number = Number1;
        this.Name = Name1;      
    }   

    public  int getNumber() {
        return Number;
    }

    public  String getName() {
        return Name;
    }   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:27:32.593

我怀疑您通过的列表是字符串列表，而不是您在此处假设的条件列表：

```
for(Conditions p: PassedIn) 
```

然而，你给我们的东西很少。完整的错误信息是什么？

另外，尝试将 的类型更改`MakePatientJListSelected`为`ArrayList<Condition>`。我想你会发现编译器会告诉你它需要一个`ArrayList<String>`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T21:29:10.423

您的方法采用输入 ArrayList 您必须向下转换它

```
ArrayList<Conditions> PassedIn = (ArrayList<Conditions>)PatientConList; 
```

# php - 无法从 PHP 创建 SQL 事件

> ID：15179587
> 
> 赞同：0
> 
> 时间：2013-03-02T21:21:50.737
> 
> 标签：php, mysql, phpmyadmin

我正在尝试从我的 PHP 脚本创建 SQL 事件。我不想使用 cron。当我在 PhpMyAdmin 上键入此查询时，一切正常：

```
CREATE EVENT clean_followers ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 30 SECOND DO DELETE FROM `test`.`countdown`; 
```

但是当我在我的 PHP 脚本中使用它时，它就不起作用（mysql_query 返回 false）。该脚本可以连接到数据库并执行任何其他类型的查询。

有人有想法吗？谢谢

# fastcgi - Rebol 在 FCGI 设置中的扩展性如何？

> ID：15179595
> 
> 赞同：3
> 
> 时间：2013-03-02T21:23:39.770
> 
> 标签：fastcgi, rebol, rebol3, rebol2

我计划在 Rebol 中编写一个相当大的 Web 应用程序（目前是 Apache 2 上的 CGI），但最初的性能测试非常令人沮丧。当我在应用程序上运行 apache 基准测试时，我得到了 4-5 个请求/秒。我想知道其他人是否有类似的问题，以及 FastCGI 是否真的帮助了他们。

而且 afaik，Rebol 仅在 Command 和 SDK 版本中支持 FastCGI，自从 R3 开源以来，这种变化是否已经或将很快发生变化？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T22:19:57.083

自从我在 Rebol 中使用 FastCGI 工具已经有一段时间了，所以我不能很好地回答第一个问题，但我可以帮助你解决第二个问题，尽管你可能不喜欢它。

还没有人为 R3重新创建该`fastcgi://`方案。我说“重新创建”是因为 R3 具有与 R2 完全不同的端口模型，因此端口方案根本不能在两个平台之间移植。此外，R2/Command 端口方案是内置的本地代码，即使它是开源的，也无法移植到 R3，因为 R3 的系统模型也不同。而且不管它的可移植性如何，R2 都包含许多 Rebol Technologies 无权开源的商业许可代码——几乎所有它可以开源的东西都已经进入了 R3。因此，如果它不存在，则可以安全地假设它根本不兼容或不可打开。

`fastcgi://`在 R3 中使用遵循 R3 模型的全新方案从头开始会更快、更容易。即使我们拥有 R2 源代码，最大的帮助也将是记录 FastCGI 协议，并且 AFAIK 该协议在其他地方有更好的文档记录。在这种情况下，创建一个针对此类事情优化的主机端口可能是一个好主意，这在 R3 中更容易做到。

从好的方面来说，据我记忆，FastCGI 协议做起来并不难，而且新的 R3 端口模型更适合这种事情，所以从头开始可能不会太难。如果幸运的话，这一切都可以在仅在常规 R3 解释器上运行的用户代码中完成，无需主机代码调整。因此，新闻不必那么糟糕。

*现在尝试回答您的第一个问题*：这取决于。

这实际上取决于您要做什么，以及您如何设置。CGI 每次都有启动进程的开销，所以只有当进程启动开销明显小于请求的其余开销（例如文件系统或数据库访问）时，它才会很快。Rebol，尤其是 R2，有大量的进程启动开销，因为它是一个解释器，在启动时有一些内置的解释代码要加载。您可以通过使用 SDK 仅使用您需要的代码创建您的应用程序来最小化启动开销，但这在您的特定情况下可能仍然没有足够的帮助（不知道您正在尝试做什么）。

FastCGI 是一种通过运行进程外应用服务器而不是为每个请求启动一个新进程来消除该进程启动开销的方法。对于像 Rebol 这样具有显着流程启动开销的东西，节省的成本同样显着。

您需要考虑的一件事是，R2 在大多数情况下都有一个单线程/进程模型，因此如果您想处理多个并发请求，您要么必须在同一进程中分部分执行它们（例如 Node.js）。 js) 或让 FastCGI 分配多个服务器进程来独立处理多个请求，或者两者兼而有之。如果这种情况令人生畏，请务必向 Rebol 专家寻求建议，或者只是设置 FastCGI 以启动更多应用程序服务器以同时运行。

因此，使用 FastCGI 设置每秒可以执行多少个请求取决于您如何配置 FastCGI、如何编写 FastCGI 处理程序代码以及您的请求正在执行多少工作和什么样的工作。

尽管在 CGI 模式下您每秒收到 4-5 个请求，但它说明了这一点。这异常缓慢。在最坏的情况下，Rebol 的启动开销并没有那么慢。这意味着要么你的请求做*了很多*，要么你没有足够的内存来一次运行两个以上的 CGI 进程，或者你的 CGI 配置不正确。在这种情况下，我不确定 FastCGI 是否能像使用更好的硬件或更好地配置 Apache 一样提供帮助。尽管如此，请确保您有足够的 FastCGI 工作进程并编写处理程序以同时处理多个请求，您将尽可能多地节省开销。

祝你好运！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-03T17:17:11.533

当我们不知道您要运行什么脚本时，很难回答任何性能问题。:-) 下面的一些问题可能看起来很愚蠢，但我真的不太了解您尝试 Rebol CGI 的背景。

对于在 Apache 下运行的 CGI 应用程序，每秒 4-5 个请求是不正常的。我可以向你保证，对于任何一种已经有十年历史的硬件，你应该得到的远不止这些。

你在做什么样的测试？对我来说，rebol 启动得如此之快，以至于它可以打开、显示其控制台并在两次刷新之间退出（60Hz），所以我什至看不到它出现。

也许您的代码（或您使用的库）的一小部分有延迟或短暂的等待（可能对数据库服务器造成一些网络延迟）。

另外，你有没有测试过服务器的传出网络速度？

你也可以试试 cheyenne，这是一个用 Rebol 构建的 Web 服务器，它每秒能够处理数百个请求，而脚本本身显然不会花费太多时间。

事实上，cheyenne 和 apache 应该能够相对容易地使服务器的网络速度饱和......如果您有冗长的脚本，并且需要更多的吞吐量，只需添加更多的工作人员来执行更多的并行任务（只要内存使用在可接受的范围内限制）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-11T21:36:35.013

如果您可以在使用 Ruby 的同一个机器上获得大约 30 rps 并且在 Windows 机器上的 Ruby 和 Rebol 之间具有相同的性能，那么很可能是您的 Rebol CGI 和/或配置有问题。

尝试在循环中从命令行运行您的 Rebol CGI 脚本，以查看缓慢的原因是脚本还是您的 Apache 配置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-11T18:57:40.497

其他一些方法：

*   让 apache 充当真正的 rebol-webserver 的代理，比如 cheyenne。让它在启动时运行等更复杂。

*   通过管道在另一种语言后面运行 rebol。使用具有 fastcgi 的语言。

*   运行 rebol 作为 tcp-daemon，让 fastcgi 语言联系它。

# python - 读取文本文件并将其与 python 中的字典键匹配

> ID：15179597
> 
> 赞同：0
> 
> 时间：2013-03-02T21:24:01.087
> 
> 标签：python, text, dictionary

我有一本用python制作的字典。我还有一个文本文件，其中每一行都是一个不同的单词。我想根据字典的键检查文本文件的每一行，如果文本文件中的行与我想将该键的值写入输出文件的键匹配。是否有捷径可寻。这甚至可能吗？我是编程新手，无法完全掌握如何访问字典。感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:28:34.697

像这样逐行读取文件：

```
with open(filename, 'r') as f:
    for line in f:
        value = mydict.get(line.strip())
        if value is not None:
            print value 
```

这会将每个值打印到标准输出。如果你想输出到一个文件，它会是这样的：

```
with open(infilename, 'r') as infile, open(outfilename, 'w') as outfile:
    for line in infile:
        value = mydict.get(line.strip())
        if value is not None:
            outfile.write(value + '\n') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-17T02:29:10.927

以下代码对我有用。

```
# Initialize a dictionary
dict = {}

# Feed key-value pairs to the dictionary 
dict['name'] = "Gautham"
dict['stay'] = "Bangalore"
dict['study'] = "Engineering"
dict['feeling'] = "Happy"

# Open the text file "text.txt", whose contents are:
####################################
## what is your name
## where do you stay
## what do you study
## how are you feeling
####################################

textfile = open("text.txt",'rb')

# Read the lines of text.txt and search each of the dictionary keys in every 
# line

for lines in textfile.xreadlines():
    for eachkey in dict.keys():
        if eachkey in lines:
            print lines + " : " + dict[eachkey]
        else:
            continue

# Close text.txt file
textfile.close() 
```

# php - PHP PDO 警告：mysql_real_escape_string()：拒绝用户访问

> ID：15179601
> 
> 赞同：-4
> 
> 时间：2013-03-02T21:24:56.523
> 
> 标签：php, mysql, pdo

我在类文件中使用 PHP 和 PDO 以及准备好的语句。我不断收到错误：警告：mysql_real_escape_string()：用户访问被拒绝。当方法被调用。我真的不知道如何解决这个问题。

这是类文件中的方法：

```
public function insertReview() {
    $fk_employee = $_POST['fk_employee'];

    // Current Date returned from JQuery and formatted to add to DB.
    $cdate = $_POST['current_date'];
    $current_date = explode("/", $cdate);
      $cmonth = $current_date[0];
      $cday = $current_date[1];
      $cyear = $current_date[2];
      $current_dateA = array($cyear, $cmonth, $cday);
    $review_date = implode("-", $current_dateA);

    // Review Begin Date returned from JQuery Datepicker and formatted to add to DB.              
    $bdate = $_POST['r_period_begin'];
    $begin_date = explode("/", $bdate);
      $bmonth = $begin_date[0];
      $bday = $begin_date[1];
      $byear = $begin_date[2];
      $begin_dateA = array($byear, $bmonth, $bday);
    $r_period_begin = implode("-", $begin_dateA);

    // Review End Date returned from JQuery Datepicker and formatted to add to DB.
    $edate = $_POST['r_period_end'];
    $end_date = explode("/", $edate);
      $emonth = $end_date[0];
      $eday = $end_date[1];
      $eyear = $end_date[2];
      $end_dateA = array($eyear, $emonth, $eday);
    $r_period_end = implode("-", $end_dateA);

    // Criteria 
      $criterias = $_POST['criteria'];
      $criteriaValue = $_POST['criteriaValue'];
      $comments = $_POST['Comments'];

      foreach ($criteriaValue as $key => $value ){
          foreach( $criterias as $crit ){
              if( $crit == $key ){
                  $string1 = $key;
                  foreach( $comments as $comment => $comm ){
                      if( $string1 == $comment ){
                          $string3 = $comm;
                      }
                  }
              }
          }
          foreach ( $value as $result ){
              $string2 = $result;
          }

      $criteria .= mysql_real_escape_string( $string1 . '|' . $string2 . '|' . $string3 . '|' );
      }

    $overall_rating = $_POST['overall_rating'];
    $additional_comments = $_POST['additional_comments'];
    $goals = $_POST['goals'];

  $conn = parent::connect();
  $sql = "INSERT INTO " . TBL_EMPLOYEE_REVIEW . " (
            fk_employee,
            review_date,
            r_period_begin,
            r_period_end,
            criteria,
            overall_rating,
            additional_comments,
            goals  
          ) VALUES (
            :fk_employee,
            :review_date,
            :r_period_begin,
            :r_period_end,
            :criteria,
            :overall_rating,
            :additional_comments,
            :goals
          )";

  try {
    $st = $conn->prepare( $sql );
    $st->bindValue( ":fk_employee", $fk_employee, PDO::PARAM_STR );
    $st->bindValue( ":review_date", $review_date, PDO::PARAM_STR );
    $st->bindValue( ":r_period_begin", $r_period_begin, PDO::PARAM_STR );
    $st->bindValue( ":r_period_end", $r_period_end, PDO::PARAM_STR );
    $st->bindValue( ":criteria", quote($criteria), PDO::PARAM_STR );
    $st->bindValue( ":overall_rating", $overall_rating, PDO::PARAM_STR );
    $st->bindValue( ":additional_comments", $additional_comments, PDO::PARAM_STR );
    $st->bindValue( ":goals", $goals, PDO::PARAM_STR );

    $st->execute();
    parent::disconnect( $conn );
  } catch ( PDOException $e ) {
            echo $e->getFile();
            echo $e->getTraceAsString();
            echo "The exception was created on line: " . $e->getLine();

    die( "Query failed: " . $e->getMessage() );
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T21:28:00.350

`mysql_real_escape_string()`使用 PDO 时请勿使用。PDO 类自己处理转义。

每次您使用 时`bindValue()`，它都会为您服务。

替换这一行：

```
$criteria .= mysql_real_escape_string( $string1 . '|' . $string2 . '|' . $string3 . '|' ); 
```

有了这条线：

```
$criteria .=  $string1 . '|' . $string2 . '|' . $string3 . '|'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T21:33:19.433

PDO 和 PDO`mysql_*`是两个完全不同的扩展。`mysql_real_escape_string`需要一个数据库连接来完成它的工作。如果您之前没有使用`mysql_connect`过建立连接，`mysql_real_escape_string`将在您调用它时尝试使用默认凭据创建新连接。这失败了，因此出现错误消息。

正如@Shackrock 所说，`mysql_real_escape_string`如果您不使用`mysql_*`. 使用 PDO 的转义函数，更准确地说是 PDO 的参数化查询和绑定值。无论如何，这比手动转义要好得多。

# java - 了解摆动计时器

> ID：15179603
> 
> 赞同：0
> 
> 时间：2013-03-02T21:25:13.627
> 
> 标签：java, swing, timer

我有这个计时器用来`Star.png`移动`JFrame & JPanel`

移动具有计时器的星星的功能：

```
private final static int HEIGHT = 300;
.
.//more code here
.
.
  x=y=0;
.
. 

public void downRight() {
    Timer localTimer = new Timer(100, null);
      localTimer.setRepeats(false);
    localTimer.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) {    
                x++;
                y++;
                repaint();
        }
    });
    int xTest=0;
    while (y < HEIGHT) {
        System.out.println("x "+(++xTest)+" y "+y);
        localTimer.start();
   }
    System.out.println("Reached");
} 
```

运行计时器并测试 xTest 时，y 值发现如下：

```
x 1 y 0

x 2 y 0

x 3 y 0

..... More Outputs here

.....

x 1653 y 1

x 1654 y 1

......

......

x 285836 y 299

x 285837 y 299

Reached 
```

那么这里发生了什么？尽管两者都在同一范围内，但为什么要`xTest`大于？`y`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T21:37:12.260

`xTest`和`y`不具有相同值的原因是因为 a具有`Timer`初始[延迟](http://docs.oracle.com/javase/7/docs/api/javax/swing/Timer.html#getInitialDelay%28%29)（设置为构造函数中提供的延迟）。调用后需要 100 毫秒`start`才能使`y`' 的值增加 1。同时，`xTest`允许尽可能快地增加。

# ruby - 无法使用 require 加载文件

> ID：15179605
> 
> 赞同：2
> 
> 时间：2013-03-02T21:25:32.360
> 
> 标签：ruby, ruby-2.0

`require`我刚刚下载了 Ruby 2.0，当我尝试运行一个简单的 Sinatra 应用程序时遇到了一个严重的问题：

```
/Users/Kuba/.rvm/rubies/ruby-2.0.0-p0/lib/ruby/site_ruby/2.0.0/rubygems/core_ext/kernel_require.rb:45:in `require': cannot load such file -- sinatra (LoadError)
from /Users/Kuba/.rvm/rubies/ruby-2.0.0-p0/lib/ruby/site_ruby/2.0.0/rubygems/core_ext/kernel_require.rb:45:in `require'
from test.rb:1:in `<main>' 
```

此外，我现在遇到问题的这个程序和其他程序在我使用 Ruby 1.8.7 时工作得非常好。

我应该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-08T21:19:54.050

我今天升级到 >= 1.9 时也遇到了这个问题，我收到了这篇文章：“[从 REE 1.8.7 升级到 Ruby 1.9.3](http://nerds.airbnb.com/upgrading-from-ree-187-to-ruby-193/) ”

如您的评论中所述，您问题的相关部分：

> 但是我不使用任何宝石的程序，而只是我自己制作的其他文件，给了我相同的结果

来自第^([1条](http://nerds.airbnb.com/upgrading-from-ree-187-to-ruby-193/))

> **加载路径：**
> 
> 在 Ruby 1.9.3 中，LOAD_PATH 不再包含“.” 因为它被认为是一种安全风险。您可以在需要文件时显式添加它、使用绝对路径或使用`require_relative`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T21:29:56.440

你也安装了宝石吗？

Ruby 2.0 是一个全新的安装。安装 ruby​​ 2.0 并不意味着您保留已安装的 gem。

这不是 Ruby 2.0 特定的。据我所知，每个新的 ruby​​ 安装都有自己的宝石。

有一些工具可以管理不同的红宝石：

*   [rvm](https://rvm.io/)（红宝石版本管理器）
*   用于 windows 的[pik](https://rubygems.org/gems/pik)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T21:29:35.620

您使用的库可能位于 Ruby 1.8 的目录下。我认为在 Ruby 2.0 下重新安装所需的库是个好主意。

# android - “iwconfig”命令是否需要 root android 设备？

> ID：15179615
> 
> 赞同：0
> 
> 时间：2013-03-02T21:26:17.257
> 
> 标签：android, linux, android-ndk, java-native-interface, root

我需要在我的 android 设备上创建 iwconfig 命令，所以我编写了 c++ 代码并通过 ndk 加入它以获得本机方法，这是我的方法：

```
jstring Java_com_example_ndk1_MainActivity_exec(JNIEnv* env, jobject javaThis , jstring cmd) {
const char * res;

jboolean isCopy;
res = env->GetStringUTFChars(cmd, &isCopy);

if (isCopy == JNI_TRUE) {
    (env)->ReleaseStringUTFChars(cmd, res);
}

std::string result = exec(res);
return (env)->NewStringUTF((const char* )result.c_str());
} 
```

但是在这样做之后，当我调用此方法并传递“iwconfig”时，应用程序停止并导致异常：

```
03-03 00:07:15.674: E/AndroidRuntime(11872): FATAL EXCEPTION: main
03-03 00:07:15.674: E/AndroidRuntime(11872): java.lang.IllegalStateException: Could not     execute method of the activity
03-03 00:07:15.674: E/AndroidRuntime(11872):    at   android.view.View$1.onClick(View.java:3660)
03-03 00:07:15.674: E/AndroidRuntime(11872):    at   android.view.View.performClick(View.java:4162)
03-03 00:07:15.674: E/AndroidRuntime(11872):    at   android.view.View$PerformClick.run(View.java:17082)
03-03 00:07:15.674: E/AndroidRuntime(11872):    at android.os.Handler.handleCallback(Handler.java:615)
03-03 00:07:15.674: E/AndroidRuntime(11872):    at android.os.Handler.dispatchMessage(Handler.java:92)
03-03 00:07:15.674: E/AndroidRuntime(11872):    at android.os.Looper.loop(Looper.java:137)
03-03 00:07:15.674: E/AndroidRuntime(11872):    at android.app.ActivityThread.main(ActivityThread.java:4856)
03-03 00:07:15.674: E/AndroidRuntime(11872):    at java.lang.reflect.Method.invokeNative(Native Method)
03-03 00:07:15.674: E/AndroidRuntime(11872):    at java.lang.reflect.Method.invoke(Method.java:511)
03-03 00:07:15.674: E/AndroidRuntime(11872):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1007)
03-03 00:07:15.674: E/AndroidRuntime(11872):    at  com.android.internal.os.ZygoteInit.main(ZygoteInit.java:774)
03-03 00:07:15.674: E/AndroidRuntime(11872):    at dalvik.system.NativeStart.main(Native Method)
03-03 00:07:15.674: E/AndroidRuntime(11872): Caused by: java.lang.reflect.InvocationTargetException
 03-03 00:07:15.674: E/AndroidRuntime(11872):   at java.lang.reflect.Method.invokeNative(Native Method)
 03-03 00:07:15.674: E/AndroidRuntime(11872):   at java.lang.reflect.Method.invoke(Method.java:511)
  03-03 00:07:15.674: E/AndroidRuntime(11872):  at android.view.View$1.onClick(View.java:3655)
03-03 00:07:15.674: E/AndroidRuntime(11872):    ... 11 more
03-03 00:07:15.674: E/AndroidRuntime(11872): Caused by: java.lang.UnsatisfiedLinkError: Native method not found: com.example.ndk1.MainActivity.exec:(Ljava/lang/String;)Ljava/lang/String;
 03-03 00:07:15.674: E/AndroidRuntime(11872):   at com.example.ndk1.MainActivity.exec(Native Method)
 03-03 00:07:15.674: E/AndroidRuntime(11872):   at  com.example.ndk1.MainActivity.command(MainActivity.java:34)
 03-03 00:07:15.674: E/AndroidRuntime(11872):   ... 14 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T17:34:36.163

您看到的错误是“UnsatisfiedLinkError”——这意味着您使用 JNI 做错了。

你编译了你的原生库吗？你能在 lib\armeabi\ 中看到它吗？您是否使用“System.loadLibrary”在 java 代码中加载了本机库？

当然，除了这个之外，您还假设 iwconfig 实际上是 Android linux 中的有效二进制/命令，我担心在大多数情况下 iwconfig 不存在。

关于权限，我认为如果您要查看界面列表，那么您将拥有足够的权限。但是，如果您尝试更改某些内容，它不会给您没有root（您是否见过许多无需您的意愿就可以将您连接到wifi的应用程序？）

您还可以使用 Java、Ex 执行命令。

Runtime.getRuntime().exec(new String[] { "ls", "\tmp"});

因为您的 java 代码和本机代码在相同的权限上下文中运行，所以在哪里运行它并不重要。希望能帮助到你。

# java - Gson 序列化一个 bean

> ID：15179618
> 
> 赞同：2
> 
> 时间：2013-03-02T21:26:35.450
> 
> 标签：java, json, serialization, gson

当我有这样的实体时

```
class Foo
{
   private String Bar = "someBarValue";
} 
```

和以下声明

```
String json = new Gson().toJson(new Foo()); 
```

结果是`{ "bar" : "someBarValue"}`

我有很多遵循标准 java bean 约定的类

```
class FooBean
{
    String getBar() { return "someBarValue"; }
} 
```

和以下声明

```
String json = new Gson().toJson(new FooBean()); 
```

结果是`{}`

如何`FooBean`使用 Gson 从上面的示例中序列化（如果我有设置器，最终反序列化），而不必依赖类的私有成员变量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T21:40:13.770

这在今天是不可能的。看看[Gson 设计文档](https://sites.google.com/site/gson/gson-design-document)：

> **使用字段与 getter 来指示 Json 元素**
> 
> 一些 Json 库使用类型的 getter 来推断 Json 元素。我们选择使用非瞬态、静态或合成的所有字段（在继承层次结构上）。我们这样做是因为并非所有类都是用适当命名的 getter 编写的。此外，getXXX 或 isXXX 可能是语义而不是指示属性。
> 
> 但是，也有很好的论据来支持属性。我们打算在后一个版本中增强 Gson 以支持属性作为指示 Json 字段的替代映射。目前，Gson 是基于字段的。

您可能会考虑的另一件事是序列化/反序列化的概念：为什么要序列化/反序列化一个对象？一般来说，在持久化、通信（即主要是I/O）之后拥有它的副本。不依赖 getter 和 setter 这样做是有道理的。它们可能会更改对象的内容，因此序列化/反序列化将无法实现它们的构建目的。

# soot - 使用 Soot 运行函数

> ID：15179629
> 
> 赞同：2
> 
> 时间：2013-03-02T21:28:04.307
> 
> 标签：soot

我正在尝试使用 soot 来测量特定类中每个函数的执行时间。我试图阅读 Eric Bodden 的 Soot Framework 的所有教程。

到现在为止我想到的是这个，

```
package test;

import java.util.Map;

import soot.Body;
import soot.BodyTransformer;
import soot.PackManager;
import soot.Scene;
import soot.SootClass;
import soot.SootMethod;
import soot.Transform;

public class MyMain {
    public static void main(String[] args) {

        PackManager
                .v()
                .getPack("jtp")
                .add(new Transform("jtp.GotoInstrumenter", GotoInstrumenter.v()));

        System.out.println(Scene.v().defaultClassPath());
        SootClass sootClass = Scene.v().loadClassAndSupport("test.TestClass");

        if (sootClass == null || !(sootClass instanceof SootClass)) {
            System.out.println("sootClass not initialized");
            System.exit(0);
        } else {
            System.out.println(sootClass.getMethodCount());
        }
        sootClass.setApplicationClass();
        for (SootMethod m : sootClass.getMethods()) {

            try {
                new Transform("jtp.GotoInstrumenter", GotoInstrumenter.v())
                        .apply(m.retrieveActiveBody());
            } catch (Exception e) {
                System.out.println("Exeception in for loop : " + e);
            }
        }

    }

}

@SuppressWarnings("all")
class GotoInstrumenter extends BodyTransformer {
    private static GotoInstrumenter instance = new GotoInstrumenter();

    private GotoInstrumenter() {
    }

    public static GotoInstrumenter v() {
        return instance;
    }

    protected void internalTransform(Body body, String phaseName, Map options) {

        System.out.println("Processing method : "
                + body.getMethod().getSignature());
    }
} 
```

这是我的TestClass

```
package test;

public class TestClass {
    public static void main(String[] args) {
        System.out.println("I am in test class");
    }
    public void f1(){
        System.out.println(Math.pow(2, 10));
    }
} 
```

我通过在 Eclipse 中使用添加变量并像 Java 应用程序一样执行它来添加烟灰类。

这是我的程序输出：

```
C:\Users\Aks\Java\soot-2.5.0.jar;C:\Users\Aks\workspace\SootAnalysis\bin;D:\Installs\eclipse\plugins\ca.mcgill.sable.soot.lib_2.5.2\lib\sootclasses.jar;;C:\Program Files\Java\jre7\lib\rt.jar
3
Processing method : <test.TestClass: void <init>()>
Processing method : <test.TestClass: void main(java.lang.String[])>
Processing method : <test.TestClass: void f1()> 
```

现在我知道 Soot 已经读取了字节码，并且正在逐步执行所有方法。我想要做的是，运行它们中的每一个。这可以使用 Soot 框架吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T09:29:47.063

可能这不是人们想要使用烟灰的原因。我不知道是否有任何优雅的方法可以使用烟灰来做到这一点。但是，绝对可以在这里利用反射的力量。*在internalTransform()*方法的末尾添加以下行应该可以工作：

`TestClass.class.getMethod(body.getMethod().getName()).invoke(new TestClass());`

当然，在*TestClass类中没有像**init()*方法这样的东西。因此，您不想调用该方法。此外，对于*main()*方法，您需要根据反射的语法指定正确的参数。否则，会有例外。

 **希望它会有所帮助。谢谢。**

# scala - 在 Windows 7 上使用 Playframework 2.1.0 的安装问题

> ID：15179635
> 
> 赞同：-1
> 
> 时间：2013-03-02T21:28:54.367
> 
> 标签：scala, playframework, playframework-2.1

我正在尝试运行 Play 框架 2.1.0 的新副本。我已经设置了环境变量并满足了所有要求，但是当我在控制台中输入“播放帮助”时出现以下控制台错误：

```
 setting 'ivy.default.settings.dir' to 'jar:file:/F:/Play/framework/sbt/sbt-launch.jar!/org/apache/ivy/core/settings'
setting 'ivy.basedir' to 'C:\Users\user M\.'
setting 'ivy.default.conf.dir' to 'jar:file:/F:/Play/framework/sbt/sbt-launch.jar!/org/apache/ivy/core/settings'
impossible to define new type: class not found: org.apache.ivy.plugins.resolver.SshResolver in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.resolver.VsftpResolver in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.version.PatternVersionMatcher in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.trigger.LogTrigger in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.ant.AntBuildTrigger in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.resolver.IvyRepResolver in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.signer.bouncycastle.OpenPGPSignatureGenerator in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.conflict.RegexpConflictManager in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.resolver.SFTPResolver in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.osgi.updatesite.UpdateSiteResolver in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.ant.AntCallTrigger in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.resolver.MirroredURLResolver in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.resolver.packager.PackagerResolver in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.resolver.DualResolver in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.resolver.VfsResolver in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.plugins.resolver.JarResolver in [] nor Ivy classloader
impossible to define new type: class not found: org.apache.ivy.osgi.obr.OBRResolver in [] nor Ivy classloader
impossible to define glob matcher: org.apache.ivy.plugins.matcher.GlobPatternMatcher was not found.
setting 'sbt.ivy.home' to 'F:\Play\framework\..\repository'
setting 'java.runtime.name' to 'Java(TM) SE Runtime Environment'
setting 'sun.boot.library.path' to 'C:\Program Files\Java\jre7\bin'
setting 'java.vm.version' to '21.0-b17'
setting 'user.country.format' to 'BG'
setting 'java.vm.vendor' to 'Oracle Corporation'
setting 'java.vendor.url' to 'http://java.oracle.com/'
setting 'path.separator' to ';'
setting 'java.vm.name' to 'Java HotSpot(TM) 64-Bit Server VM'
setting 'file.encoding.pkg' to 'sun.io'
setting 'user.country' to 'US'
setting 'user.script' to ''
setting 'sun.java.launcher' to 'SUN_STANDARD'
setting 'sun.os.patch.level' to 'Service Pack 1'
setting 'java.vm.specification.name' to 'Java Virtual Machine Specification'
setting 'user.dir' to 'C:\Users\user M'
setting 'java.runtime.version' to '1.7.0-b147'
setting 'sbt.boot.properties' to 'file:///F:/Play/framework/sbt/sbt.boot.properties'
setting 'java.awt.graphicsenv' to 'sun.awt.Win32GraphicsEnvironment'
setting 'java.endorsed.dirs' to 'C:\Program Files\Java\jre7\lib\endorsed'
setting 'os.arch' to 'amd64'
setting 'java.io.tmpdir' to 'C:\Users\ALEXAN~1\AppData\Local\Temp\'
setting 'line.separator' to '
'
setting 'java.vm.specification.vendor' to 'Oracle Corporation'
setting 'user.variant' to ''
setting 'os.name' to 'Windows 7'
setting 'sun.jnu.encoding' to 'Cp1251'
setting 'java.library.path' to 'C:\Windows\system32;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;%CommonProgramFiles%\Microsoft Shared\Windows Live;C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files (x86)\QuickTime\QTSystem\;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;c:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\;c:\Program Files\Microsoft SQL Server\100\Tools\Binn\;c:\Program Files\Microsoft SQL Server\100\DTS\Binn\;c:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\;c:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\;C:\Program Files\nodejs\;C:\Program Files (x86)\scala\\bin;C:\Program Files\Java\jdk1.7.0\bin;C:\Program Files\Microsoft\Web Platform Installer\;C:\Program Files (x86)\Microsoft ASP.NET\ASP.NET Web Pages\v1.0\;C:\Program Files (x86)\Windows Kits\8.0\Windows Performance Toolkit\;C:\Program Files\Microsoft SQL Server\110\Tools\Binn\;C:\Program Files\Calibre2\;C:\Program Files\Common Files\Microsoft Shared\Windows Live; C:\Program Files\Java\jdk1.7.0\bin;C:\wamp\bin\php\php5.3.8;C:\wamp\www\yii\framework;C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;F:\Play;.'
setting 'java.specification.name' to 'Java Platform API Specification'
setting 'java.class.version' to '51.0'
setting 'play.home' to 'F:\Play\framework\.'
setting 'sun.management.compiler' to 'HotSpot 64-Bit Tiered Compilers'
setting 'os.version' to '6.1'
setting 'user.home' to 'C:\Users\user M'
setting 'user.timezone' to 'Europe/Helsinki'
setting 'java.awt.printerjob' to 'sun.awt.windows.WPrinterJob'
setting 'file.encoding' to 'UTF-8'
setting 'java.specification.version' to '1.7'
setting 'java.class.path' to 'F:\Play\framework\sbt\sbt-launch.jar'
setting 'user.name' to 'user M'
setting 'play.version' to '2.1.0'
setting 'java.vm.specification.version' to '1.7'
setting 'sun.java.command' to 'F:\Play\framework\sbt\sbt-launch.jar help'
setting 'java.home' to 'C:\Program Files\Java\jre7'
setting 'sun.arch.data.model' to '64'
setting 'user.language' to 'en'
setting 'java.specification.vendor' to 'Oracle Corporation'
setting 'user.language.format' to 'bg'
setting 'awt.toolkit' to 'sun.awt.windows.WToolkit'
setting 'java.vm.info' to 'mixed mode'
setting 'java.version' to '1.7.0'
setting 'java.ext.dirs' to 'C:\Program Files\Java\jre7\lib\ext;C:\Windows\Sun\Java\lib\ext'
setting 'sun.boot.class.path' to 'C:\Program Files\Java\jre7\lib\resources.jar;C:\Program Files\Java\jre7\lib\rt.jar;C:\Program Files\Java\jre7\lib\sunrsasign.jar;C:\Program Files\Java\jre7\lib\jsse.jar;C:\Program Files\Java\jre7\lib\jce.jar;C:\Program Files\Java\jre7\lib\charsets.jar;C:\Program Files\Java\jre7\classes'
setting 'java.vendor' to 'Oracle Corporation'
setting 'file.separator' to '\'
setting 'java.vendor.url.bug' to 'http://bugreport.sun.com/bugreport/'
setting 'sun.io.unicode.encoding' to 'UnicodeLittle'
setting 'sun.cpu.endian' to 'little'
setting 'sun.desktop' to 'windows'
setting 'sun.cpu.isalist' to 'amd64'
setting 'ivy.default.ivy.user.dir' to 'F:\Play\framework\.\..\repository'
setting 'ivy.home' to 'F:\Play\framework\.\..\repository'
setting 'ivy.cache.dir' to 'F:\Play\framework\.\..\repository\cache'
no default cache defined: set to F:\Play\framework\.\..\repository\cache
setting 'ivy.checksums' to 'sha1,md5'
setting 'ivy.basedir' to 'F:\Play\framework\.\sbt\boot'
setting 'basedir' to 'F:\Play\framework\.\sbt\boot'
setting 'scala' to '2.9.2'
:: resolving dependencies :: org.scala-sbt#boot-app;1.0
    confs: [default]
    validate = true
    refresh = false
resolving dependencies for configuration 'default'
== resolving dependencies for org.scala-sbt#boot-app;1.0 [default]
loadData of org.scala-sbt#boot-app;1.0 of rootConf=default
== resolving dependencies org.scala-sbt#boot-app;1.0->org.scala-sbt#sbt;${{sbt.version}} [default->default(compile)]
loadData of org.scala-sbt#sbt;${{sbt.version}} of rootConf=default
    using redefined-public to resolve org.scala-sbt#sbt;${{sbt.version}}
redefined-public: Checking cache for: dependency: org.scala-sbt#sbt;${{sbt.version}} {default=[default(compile)]}
redefined-public: no namespace defined: using system
    no ivy file in cache for org.scala-sbt#sbt;${{sbt.version}}: tried F:\Play\framework\.\..\repository\cache\org.scala-sbt\sbt\ivy-${{sbt.version}}.xml
redefined-public: no latest strategy defined: using default
local: no namespace defined: using system
    no ivy file in cache for org.scala-sbt#sbt;${{sbt.version}}: tried F:\Play\framework\.\..\repository\cache\org.scala-sbt\sbt\ivy-${{sbt.version}}.xml
     trying F:\Play\repository\local\org.scala-sbt\sbt\${{sbt.version}}\ivys\ivy.xml
        tried F:\Play\repository\local\org.scala-sbt\sbt\${{sbt.version}}\ivys\ivy.xml
    local: resource not reachable for org.scala-sbt#sbt;${{sbt.version}}: res=F:\Play\repository\local\org.scala-sbt\sbt\${{sbt.version}}\ivys\ivy.xml
    local: no ivy file found for org.scala-sbt#sbt;${{sbt.version}}
Maven2 Local: no namespace defined: using system
    no ivy file in cache for org.scala-sbt#sbt;${{sbt.version}}: tried F:\Play\framework\.\..\repository\cache\org.scala-sbt\sbt\ivy-${{sbt.version}}.xml
     trying file://C:\Users\user M/.m2/repository/org/scala-sbt/sbt/${{sbt.version}}/sbt-${{sbt.version}}.pom
        tried file://C:\Users\user M/.m2/repository/org/scala-sbt/sbt/${{sbt.version}}/sbt-${{sbt.version}}.pom
    Maven2 Local: resource not reachable for org/scala-sbt#sbt;${{sbt.version}}: res=file://C:/Users/user M/.m2/repository/org/scala-sbt/sbt/${{sbt.version}}/sbt-${{sbt.version}}.pom
    Maven2 Local: no ivy file found for org.scala-sbt#sbt;${{sbt.version}}
typesafe-ivy-releases: no namespace defined: using system
    no ivy file in cache for org.scala-sbt#sbt;${{sbt.version}}: tried F:\Play\framework\.\..\repository\cache\org.scala-sbt\sbt\ivy-${{sbt.version}}.xml
     trying http://repo.typesafe.com/typesafe/ivy-releases/org.scala-sbt/sbt/${{sbt.version}}/ivys/ivy.xml
        tried http://repo.typesafe.com/typesafe/ivy-releases/org.scala-sbt/sbt/${{sbt.version}}/ivys/ivy.xml
HTTP response status: 404 url=http://repo.typesafe.com/typesafe/ivy-releases/org.scala-sbt/sbt/$%7B%7Bsbt.version%7D%7D/ivys/ivy.xml
CLIENT ERROR: Not Found url=http://repo.typesafe.com/typesafe/ivy-releases/org.scala-sbt/sbt/$%7B%7Bsbt.version%7D%7D/ivys/ivy.xml
    typesafe-ivy-releases: resource not reachable for org.scala-sbt#sbt;${{sbt.version}}: res=http://repo.typesafe.com/typesafe/ivy-releases/org.scala-sbt/sbt/${{sbt.version}}/ivys/ivy.xml
    typesafe-ivy-releases: no ivy file found for org.scala-sbt#sbt;${{sbt.version}}
Maven Central: no namespace defined: using system
    no ivy file in cache for org.scala-sbt#sbt;${{sbt.version}}: tried F:\Play\framework\.\..\repository\cache\org.scala-sbt\sbt\ivy-${{sbt.version}}.xml
     trying http://repo1.maven.org/maven2/org/scala-sbt/sbt/${{sbt.version}}/sbt-${{sbt.version}}.pom
        tried http://repo1.maven.org/maven2/org/scala-sbt/sbt/${{sbt.version}}/sbt-${{sbt.version}}.pom
HTTP response status: 404 url=http://repo1.maven.org/maven2/org/scala-sbt/sbt/$%7B%7Bsbt.version%7D%7D/sbt-$%7B%7Bsbt.version%7D%7D.pom
CLIENT ERROR: Not Found url=http://repo1.maven.org/maven2/org/scala-sbt/sbt/$%7B%7Bsbt.version%7D%7D/sbt-$%7B%7Bsbt.version%7D%7D.pom
    Maven Central: resource not reachable for org/scala-sbt#sbt;${{sbt.version}}: res=http://repo1.maven.org/maven2/org/scala-sbt/sbt/${{sbt.version}}/sbt-${{sbt.version}}.pom
    Maven Central: no ivy file found for org.scala-sbt#sbt;${{sbt.version}}
WARN:   module not found: org.scala-sbt#sbt;${{sbt.version}}
WARN: ==== local: tried
WARN:   F:\Play\repository\local\org.scala-sbt\sbt\${{sbt.version}}\ivys\ivy.xml
WARN: ==== Maven2 Local: tried
WARN:   file://C:\Users\user M/.m2/repository/org/scala-sbt/sbt/${{sbt.version}}/sbt-${{sbt.version}}.pom
WARN: ==== typesafe-ivy-releases: tried
WARN:   http://repo.typesafe.com/typesafe/ivy-releases/org.scala-sbt/sbt/${{sbt.version}}/ivys/ivy.xml
WARN: ==== Maven Central: tried
WARN:   http://repo1.maven.org/maven2/org/scala-sbt/sbt/${{sbt.version}}/sbt-${{sbt.version}}.pom
Nbr of module to sort : 0
    resolved ivy file produced in F:\Play\framework\.\..\repository\cache\resolved-org.scala-sbt-boot-app-1.0.xml
:: downloading artifacts ::
:: resolution report :: resolve 2500ms :: artifacts dl 0ms
WARN:   ::::::::::::::::::::::::::::::::::::::::::::::
WARN:   ::          UNRESOLVED DEPENDENCIES         ::
WARN:   ::::::::::::::::::::::::::::::::::::::::::::::
WARN:   :: org.scala-sbt#sbt;${{sbt.version}}: not found
WARN:   ::::::::::::::::::::::::::::::::::::::::::::::

Nbr of module to sort : 0
    report for org.scala-sbt#boot-app;1.0 default produced in F:\Play\framework\.\..\repository\cache\org.scala-sbt-boot-app-default.xml
    resolve done (2500ms resolve - 0ms download)

:: problems summary ::
:::: WARNINGS
        module not found: org.scala-sbt#sbt;${{sbt.version}}

    ==== local: tried

      F:\Play\repository\local\org.scala-sbt\sbt\${{sbt.version}}\ivys\ivy.xml

    ==== Maven2 Local: tried

      file://C:\Users\user M/.m2/repository/org/scala-sbt/sbt/${{sbt.version}}/sbt-${{sbt.version}}.pom

    ==== typesafe-ivy-releases: tried

      http://repo.typesafe.com/typesafe/ivy-releases/org.scala-sbt/sbt/${{sbt.version}}/ivys/ivy.xml

    ==== Maven Central: tried

      http://repo1.maven.org/maven2/org/scala-sbt/sbt/${{sbt.version}}/sbt-${{sbt.version}}.pom

        ::::::::::::::::::::::::::::::::::::::::::::::

        ::          UNRESOLVED DEPENDENCIES         ::

        ::::::::::::::::::::::::::::::::::::::::::::::

        :: org.scala-sbt#sbt;${{sbt.version}}: not found

        ::::::::::::::::::::::::::::::::::::::::::::::

:: USE VERBOSE OR DEBUG MESSAGE LEVEL FOR MORE DETAILS
java.lang.RuntimeException: not found
    at org.apache.ivy.core.resolve.IvyNode.loadData(IvyNode.java:238)
    at org.apache.ivy.core.resolve.VisitNode.loadData(VisitNode.java:292)
    at org.apache.ivy.core.resolve.ResolveEngine.fetchDependencies(ResolveEngine.java:695)
    at org.apache.ivy.core.resolve.ResolveEngine.doFetchDependencies(ResolveEngine.java:780)
    at org.apache.ivy.core.resolve.ResolveEngine.fetchDependencies(ResolveEngine.java:703)
    at org.apache.ivy.core.resolve.ResolveEngine.getDependencies(ResolveEngine.java:575)
    at org.apache.ivy.core.resolve.ResolveEngine.resolve(ResolveEngine.java:233)
    at xsbt.boot.Update.xsbt$boot$Update$$lockedApply(Checks.java:105)
    at xsbt.boot.Update$$anon$3.call(Update.scala:99)
    at xsbt.boot.Locks$GlobalLock.withChannel$1(Locks.scala:75)
    at xsbt.boot.Locks$GlobalLock.withChannelRetries$1(Locks.scala:58)
    at xsbt.boot.Locks$GlobalLock$$anonfun$withFileLock$1.apply(Locks.scala:79)
    at xsbt.boot.Using$.withResource(Using.scala:11)
    at xsbt.boot.Using$.apply(Using.scala:10)
    at xsbt.boot.Locks$GlobalLock.liftedTree1$1(Locks.scala:51)
    at xsbt.boot.Locks$GlobalLock.withLock(Locks.scala:51)
    at xsbt.boot.Locks$.apply0(Locks.scala:30)
    at xsbt.boot.Locks$.apply(Locks.scala:27)
    at xsbt.boot.Update.apply(Checks.java:100)
    at xsbt.boot.Launch.update(Launch.scala:275)
    at xsbt.boot.Launch.retrieve$1(Launch.scala:145)
    at xsbt.boot.Launch$$anonfun$3.apply(Launch.scala:153)
    at scala.Option.getOrElse(Option.scala:108)
    at xsbt.boot.Launch$$anon$2.call(Launch.scala:138)
    at xsbt.boot.Locks$GlobalLock.withChannel$1(Locks.scala:75)
    at xsbt.boot.Locks$GlobalLock.withChannelRetries$1(Locks.scala:58)
    at xsbt.boot.Locks$GlobalLock$$anonfun$withFileLock$1.apply(Locks.scala:79)
    at xsbt.boot.Using$.withResource(Using.scala:11)
    at xsbt.boot.Using$.apply(Using.scala:10)
    at xsbt.boot.Locks$GlobalLock.liftedTree1$1(Locks.scala:51)
    at xsbt.boot.Locks$GlobalLock.withLock(Locks.scala:51)
    at xsbt.boot.Locks$.apply0(Locks.scala:30)
    at xsbt.boot.Locks$.apply(Locks.scala:27)
    at xsbt.boot.Launch.locked(Launch.scala:174)
    at xsbt.boot.Launch.app(Launch.scala:91)
    at xsbt.boot.Launch.app(Launch.scala:89)
    at xsbt.boot.Launch$.run(Launch.scala:51)
    at xsbt.boot.Launch$$anonfun$explicit$1.apply(Launch.scala:45)
    at xsbt.boot.Launch$.launch(Launch.scala:69)
    at xsbt.boot.Launch$.apply(Launch.scala:16)
    at xsbt.boot.Boot$.runImpl(Boot.scala:31)
    at xsbt.boot.Boot$.main(Boot.scala:20)
    at xsbt.boot.Boot.main(Boot.scala)
Error during sbt execution: Error retrieving required libraries
    at xsbt.boot.Pre$.error(Pre.scala:22)
    at xsbt.boot.Update.xsbt$boot$Update$$lockedApply(Checks.java:105)
    at xsbt.boot.Update$$anon$3.call(Update.scala:99)
    at xsbt.boot.Locks$GlobalLock.withChannel$1(Locks.scala:75)
    at xsbt.boot.Locks$GlobalLock.withChannelRetries$1(Locks.scala:58)
    at xsbt.boot.Locks$GlobalLock$$anonfun$withFileLock$1.apply(Locks.scala:79)
    at xsbt.boot.Using$.withResource(Using.scala:11)
    at xsbt.boot.Using$.apply(Using.scala:10)
    at xsbt.boot.Locks$GlobalLock.liftedTree1$1(Locks.scala:51)
    at xsbt.boot.Locks$GlobalLock.withLock(Locks.scala:51)
    at xsbt.boot.Locks$.apply0(Locks.scala:30)
    at xsbt.boot.Locks$.apply(Locks.scala:27)
    at xsbt.boot.Update.apply(Checks.java:100)
    at xsbt.boot.Launch.update(Launch.scala:275)
    at xsbt.boot.Launch.retrieve$1(Launch.scala:145)
    at xsbt.boot.Launch$$anonfun$3.apply(Launch.scala:153)
    at scala.Option.getOrElse(Option.scala:108)
    at xsbt.boot.Launch$$anon$2.call(Launch.scala:138)
    at xsbt.boot.Locks$GlobalLock.withChannel$1(Locks.scala:75)
    at xsbt.boot.Locks$GlobalLock.withChannelRetries$1(Locks.scala:58)
    at xsbt.boot.Locks$GlobalLock$$anonfun$withFileLock$1.apply(Locks.scala:79)
    at xsbt.boot.Using$.withResource(Using.scala:11)
    at xsbt.boot.Using$.apply(Using.scala:10)
    at xsbt.boot.Locks$GlobalLock.liftedTree1$1(Locks.scala:51)
    at xsbt.boot.Locks$GlobalLock.withLock(Locks.scala:51)
    at xsbt.boot.Locks$.apply0(Locks.scala:30)
    at xsbt.boot.Locks$.apply(Locks.scala:27)
    at xsbt.boot.Launch.locked(Launch.scala:174)
    at xsbt.boot.Launch.app(Launch.scala:91)
    at xsbt.boot.Launch.app(Launch.scala:89)
    at xsbt.boot.Launch$.run(Launch.scala:51)
    at xsbt.boot.Launch$$anonfun$explicit$1.apply(Launch.scala:45)
    at xsbt.boot.Launch$.launch(Launch.scala:69)
    at xsbt.boot.Launch$.apply(Launch.scala:16)
    at xsbt.boot.Boot$.runImpl(Boot.scala:31)
    at xsbt.boot.Boot$.main(Boot.scala:20)
    at xsbt.boot.Boot.main(Boot.scala)
Error during sbt execution: Error retrieving required libraries 
```

我真的很生气，并试图修复它至少 2 个小时，但没有任何结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:35:27.420

我对 Play 不太熟悉，但看起来您的配置将 sbt 版本指定为`"${{sbt.version}}"`，这并没有按照您期望的方式进行插值。

进一步推测，我猜这`sbt.version`应该是一个 Java 系统属性，但我没有在设置的变量列表中看到它。

重新检查你如何指定 sbt 版本，以及它是如何在你的配置中使用的。

# php - php类访问变量

> ID：15179636
> 
> 赞同：0
> 
> 时间：2013-03-02T21:28:54.843
> 
> 标签：php

我有以下 PHP 类：

```
class connect {

public function __construct() {

$sql = new mysqli(...);

return $sql;

} 
```

（当然，这不是全部代码，只是给你一个思路。

然后我有：

```
class two {

public function validateInput($input) {

$dbconn = new connect();

return $dbconn->real_escape_string($input); 
```

}

但是，这会产生错误。如何从类 connect 调用 $sql 变量的 real_escape_string 方法？

干杯!

PS：更新，报错是 Fatal error: Call to undefined method connect::real_escape_string()

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T21:32:19.630

构造函数不能返回值；返回值是隐含的（一个新的对象实例）。

在您的示例中，`$dbconn`是 class 的对象`connect`。它不是 class 的对象`mysqli`，所以它没有`real_escape_string`方法。该`return $sql`声明无效，因为它没有意义。

您可能打算扩展`mysqli`（这会很痛苦，因为您必须转发所有构造函数参数），或者改为公开一个`mysqli`成员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T21:33:18.450

类 connect 将返回一个 connect 实例，而不是 mysqli。也许尝试：

```
class connect extends mysqli {
  function __construct() {
    parent::__construct(..);
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T21:36:30.970

您可能正在寻找类似的东西：

```
class connect {
    public function __construct() {
        $this->sql = new mysqli(...);
    }

    public function real_escape_string($string) {
        // Process $string using $this->sql;
        return $string
    }
}

class two {
    public function validateInput($input) {
        $dbconn = new connect();

        return $dbconn->real_escape_string($input);
    }
} 
```

# cobol - 编写从单独的 vsam 文件中提取信息的 Cobol 程序时遇到问题

> ID：15179641
> 
> 赞同：2
> 
> 时间：2013-03-02T21:29:26.573
> 
> 标签：cobol, mainframe, vsam

我有三个 VSAM 文件。一种用于客户、视频和租赁。在这些 VSAM 文件中，每个客户、视频和租赁都有一个 ID。以下是客户文件的示例：

300，鲍勃，315-123-1414

301，瑞恩，315-213-2617

302，史密斯，315-123-1234

303，罗伯塔，212-125-1234

视频文件和租借文件的设置方式相同。

我需要做的是编写一个 cobol 程序来读取这些 VSAM 文件，然后列出客户、视频以及客户租用的视频。我计划通过为每个客户设置一个 ID 号，然后将该 ID 号与租借的视频一起使用来做到这一点。

我到目前为止的cobol代码如下：

```
ID DIVISION.
    PROGRAM-ID. PROG3

    ENVIRONMENT DIVISION.
    CONFIGURATION SECTION.
    SOURCE-COMPUTER. IBM-Z10.
    OBJECT-COMPUTER. IBM-Z10.
    INPUT-OUTPUT SECTION.
    FILE-CONTROL.
         SELECT CUR-FILE ASSIGN TO MYFILE1
         ORGANIZATION INDEXED ACCESS IS SEQUENTIAL
         RECORD KEY IS EMP-NO FILE STATUS IS F13.

    DATA DIVISION.
    FILE SECTION.
    FD  CUR-FILE
        RECORD CONTAINS 80 CHARACTERS
        DATA RECORD IS CUR-REC.
      01 CUR-REC.
        02 EMP-NO      PIC X(6).
        02 EMP-NAME    PIC X(24).
        02 EMP-ADDRESS PIC X(50).
      WORKING-STORAGE SECTION.
      77 F13 PIC 99 VALUE ZEROS.

      PROCEDURE DIVISION.
      0001-MAIN.
          DISPLAY ' I M IN MAIN '.
          DISPLAY ' I M IN MAIN '.
          OPEN OUTPUT CUR-FILE. IF F13 = 00
          DISPLAY ' I M OPENED SUCCESSFULLY ' ELSE
          DISPLAY 'OPEN-ERROR ' F13 STOP RUN.
          MOVE '822655' TO EMP-NO.
          DISPLAY EMP-NO.
          MOVE 'MUSADDIQ USMAN' TO EMP-NAME.
          MOVE 'P-5/01 STEEL TOWN' TO EMP-ADDRESS.
          DISPLAY CUR-REC.
          WRITE CUR-REC.
          IF F13 = 00 DISPLAY 'WRITE SUCCESSFUL' ELSE
          DISPLAY 'WRITE ERROR ' F13 STOP RUN.
          CLOSE CUR-FILE.
          STOP RUN. 
```

下面我添加了 Read 程序，我认为这将帮助您，希望对我有所帮助：

```
ID DIVISION.
    PROGRAM-ID. RDVSAM.

    ENVIRONMENT DIVISION.
    CONFIGURATION SECTION.
    SOURCE-COMPUTER. IBM-Z10.
    OBJECT-COMPUTER. IBM-Z10.
    INPUT-OUTPUT SECTION.
    FILE-CONTROL.
         SELECT CUR-FILE ASSIGN TO MYFILE1
         ORGANIZATION INDEXED ACCESS IS SEQUENTIAL
         RECORD KEY IS EMP-NO FILE STATUS IS F13.

    DATA DIVISION.
    FILE SECTION.
    FD  CUR-FILE
        RECORD CONTAINS 80 CHARACTERS
        DATA RECORD IS CUR-REC.
      01 CUR-REC.
        02 EMP-NO PIC 9(6).
        02 EMP-NAME PIC X(24).
        02 EMP-ADDRESS PIC X(50).
    WORKING-STORAGE SECTION.
    77 F13 PIC 99 VALUE ZEROS.

    PROCEDURE DIVISION.
    0001-MAIN.
       OPEN INPUT CUR-FILE. IF F13 = 00
       DISPLAY ' I M OPENED SUCCESSFULLY ' ELSE
       DISPLAY 'OPEN-ERROR ' F13 STOP RUN.
    REAd-FILE.
       READ CUR-FILE AT END GO TO CLOSE-UP.
       DISPLAY EMP-NO ' ' EMP-NAME ' ' EMP-ADDRESS.
       GO TO READ-FILE.
    CLOSE-UP.
       CLOSE CUR-FILE.
       STOP RUN. 
```

我被卡住了，不知道如何列出所有信息。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T23:49:53.453

请参阅[http://opencobol.add1tocobol.com/#does-opencobol-support-isam](http://opencobol.add1tocobol.com/#does-opencobol-support-isam)的示例，而不是扫描 INDEXED 文件，也许还有[http://opencobol.add1tocobol.com/#relative](http://opencobol.add1tocobol.com/#relative)（不同的文件组织）

注意：这只是为了提示。查看 START 和 READ NEXT 以获取线索

```
OCOBOL >>SOURCE FORMAT IS FIXED
      *> ***************************************************************
      *><* ================
      *><* indexing example
      *><* ================
      *><* :Author:    Brian Tiffin
      *><* :Date:      17-Feb-2009
      *><* :Purpose:   Fun with Indexed IO routines
      *><* :Tectonics: cobc -x indexing.cob
      *> ***************************************************************
       identification division.
       program-id. indexing.

       environment division.
       configuration section.

       input-output section.
       file-control.
          select optional indexing
          assign to "indexing.dat"
          organization is indexed
          access mode is dynamic
          record key is keyfield of indexing-record
          alternate record key is splitkey of indexing-record
              with duplicates
          .

      *> ** OpenCOBOL does not yet support split keys **
      *>  alternate record key is newkey
      *>      source is first-part of indexing-record
      *>                last-part of indexing-record
      *>      with duplicates

       data division.
       file section.
       fd indexing.
       01 indexing-record.
          03 keyfield          pic x(8).
          03 splitkey.
             05 first-part     pic 99.
             05 middle-part    pic x.
             05 last-part      pic 99.
          03 data-part         pic x(54).

       working-storage section.
       01 display-record.
          03 filler            pic x(4)  value spaces.
          03 keyfield          pic x(8).
          03 filler            pic xx    value spaces.
          03 splitkey.
             05 first-part     pic z9.
             05 filler         pic x     value space.
             05 middle-part    pic x.
             05 filler         pic xx    value all "+".
             05 last-part      pic z9.
          03 filler            pic x(4)  value all "-".
          03 data-part         pic x(54).

      *> control break
       01 oldkey               pic 99x99.

      *> In a real app this should well be two separate flags
       01 control-flag         pic x.
          88 no-more-duplicates          value high-value
             when set to false is              low-value.
          88 no-more-records             value high-value
             when set to false is              low-value.

      *> ***************************************************************
       procedure division.

      *> Open optional index file for read write
       open i-o indexing

      *> populate a sample database
       move "1234567800a01some 12345678 data here" to indexing-record
       perform write-indexing-record
       move "8765432100a01some 87654321 data here" to indexing-record
       perform write-indexing-record
       move "1234876500a01some 12348765 data here" to indexing-record
       perform write-indexing-record
       move "8765123400a01some 87651234 data here" to indexing-record
       perform write-indexing-record

       move "1234567900b02some 12345679 data here" to indexing-record
       perform write-indexing-record
       move "9765432100b02some 97654321 data here" to indexing-record
       perform write-indexing-record
       move "1234976500b02some 12349765 data here" to indexing-record
       perform write-indexing-record
       move "9765123400b02some 97651234 data here" to indexing-record
       perform write-indexing-record

       move "1234568900c13some 12345689 data here" to indexing-record
       perform write-indexing-record
       move "9865432100c13some 98654321 data here" to indexing-record
       perform write-indexing-record
       move "1234986500c13some 12349865 data here" to indexing-record
       perform write-indexing-record
       move "9865123400c13some 98651234 data here" to indexing-record
       perform write-indexing-record

      *> close it ... not necessary, but for the example
       close indexing

      *> clear the record space for this example
       move spaces to indexing-record

      *> open the data file again
       open i-o indexing

      *> read all the duplicate 00b02 keys
       move 00 to first-part of indexing-record
       move "b" to middle-part of indexing-record
       move 02 to last-part of indexing-record

      *> using read key and then next key / last key compare
       set no-more-duplicates to false
       perform read-indexing-record
       perform read-next-record
           until no-more-duplicates

      *> read by key of reference ... the cool stuff
       move 00 to first-part of indexing-record
       move "a" to middle-part of indexing-record
       move 02 to last-part of indexing-record

      *> using start and read next
       set no-more-records to false
       perform start-at-key
       perform read-next-by-key
           until no-more-records

      *> read by primary key of reference
       move "87654321" to keyfield of indexing-record

      *>
       set no-more-records to false
       perform start-prime-key
       perform read-previous-by-key
           until no-more-records

      *> and with that we are done with indexing sample
       close indexing

       goback.
      *> ***************************************************************

      *><* Write paragraph
       write-indexing-record.
         write indexing-record
             invalid key
                 display
                     "rewrite key: " keyfield of indexing-record
                 end-display
                   rewrite indexing-record
                       invalid key
                           display
                               "really bad key: "
                               keyfield of indexing-record
                           end-display
                   end-rewrite
         end-write
       .

      *><* read by alternate key paragraph
       read-indexing-record.
           display "Reading: " splitkey of indexing-record end-display
           read indexing key is splitkey of indexing-record
         invalid key
             display
                "bad read key: " splitkey of indexing-record
             end-display
               set no-more-duplicates to true
           end-read
       .

      *><* read next sequential paragraph
       read-next-record.
           move corresponding indexing-record to display-record
           display display-record end-display
           move splitkey of indexing-record to oldkey

           read indexing next record
               at end set no-more-duplicates to true
               not at end
                   if oldkey not equal splitkey of indexing-record
                       set no-more-duplicates to true
                   end-if
           end-read
       .

      *><* start primary key of reference paragraph
       start-prime-key.
           display "Prime < " keyfield of indexing-record end-display
           start indexing
              key is less than
                  keyfield of indexing-record
              invalid key
                  display
                      "bad start: " keyfield of indexing-record
                  end-display
                  set no-more-records to true
              not invalid key
                  read indexing previous record
                      at end set no-more-records to true
                  end-read
           end-start
       .

      *><* read previous by key of reference paragraph
       read-previous-by-key.
           move corresponding indexing-record to display-record
           display display-record end-display

           read indexing previous record
               at end set no-more-records to true
           end-read
       .
      *><* start alternate key of reference paragraph
       start-at-key.
           display "Seeking >= " splitkey of indexing-record end-display
           start indexing
              key is greater than or equal to
                  splitkey of indexing-record
              invalid key
                  display
                      "bad start: " splitkey of indexing-record
                  end-display
                  set no-more-records to true
              not invalid key
                  read indexing next record
                      at end set no-more-records to true
                  end-read
           end-start
       .

      *><* read next by key of reference paragraph
       read-next-by-key.
           move corresponding indexing-record to display-record
           display display-record end-display

           read indexing next record
               at end set no-more-records to true
           end-read
       .
       end program indexing. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T06:51:42.607

好的，IBM Cobol 手册，我假设 IBM 由于 VSAM，可以在线获得。为您的编译器版本搜索“语言参考”和“编程指南”（这是每个编译列表的首页）。

您将需要带有 KEY 的 READ 来查找单个记录，或者，如果您有一组记录，您也可以使用带有 key/START 和 READ NEXT 的 READ。如果您只有部分密钥，则使用 START 和 READ NEXT。这已经由布赖恩提出。

你在学习 Cobol 吗？您应该努力避免 GO TO 并以不同的方式格式化您的程序，每行只有一个动词，也可以帮助您进一步减少句号/句号（请查看 Brian 的示例，以了解末尾的“仅句号”行每个段落，除了段落/SECTIONS和PROCEDURE DIVISION语句本身之外，这是您最需要的句号，如果没有段落/SECTIONS，则结束程序。

您不应该从 Brian 的代码中复制一件事，那就是“环境”。在大型机上，如果您在文件打开之前或文件关闭之后访问记录区域，您将获得 S0C4 异常终止（除非它是直接应用或通过 AWO 编译选项仅应用写入的 QSAM 文件）。

在读取之前无需将记录区域设置为初始值。

# python - 在openGL中拖动对象

> ID：15179643
> 
> 赞同：0
> 
> 时间：2013-03-02T21:29:41.073
> 
> 标签：python, opengl, drag, glut

我想要做的是使用这样的运动功能在屏幕上拖动一行的结尾：

```
def motion(a, b):
b=wh-b
global MOVING

if (MOVING == 1):
    table[0].x=a
    table[0].y=b
    display()
    drawObjects() 
```

现在，我的线对象存储在一个名为 table 的列表中，并使用函数 drawObjects 重新绘制。每当我调用 display 时，屏幕上的所有内容都会被删除。现在我有一个叫做使用的运动功能

```
glutMotionFunc(motion) 
```

我想要做的是让这条线在被鼠标拖动时始终可见。但是，每当我尝试拖动一条线时，它就会消失，并且只有在我拖动鼠标后才会重新出现。有没有办法让线条在屏幕上拖动时始终可见？

# powershell - Powershell - 在字符串中计算 X

> ID：15179649
> 
> 赞同：2
> 
> 时间：2013-03-02T21:30:31.073
> 
> 标签：powershell, powershell-3.0

所以本质上我将域名存储到一个变量中 - 然后我需要稍后在我的代码中将其拆分为各个部分，即

```
$domainName = "testdomain.co.uk"
$domainNameSplit = $domainName.split(".")

echo $domainNameSplit[0]
echo $domainNameSplit[1]
echo $domainNameSplit[2] 
```

在这种情况下，这很好，因为我知道它是 .co.uk，所以会有 3 个部分 - 但是我的代码允许输入，因此可能会采用`testdomain.local`格式。如何查看 $domainName 变量并找到数量 `'.'`以便知道如何处理它？

然后我还需要使用它来创建一个要使用的`$ou`变量，所以：

```
$ou = "DC=WhatWouldIPutHere?,DC=AndHere" 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T22:12:14.987

只是另一个建议：

```
$domainName = "testdomain.co.uk"

# Get Count
$PartCount = $domainName.Split(".").Count

# Make an OU
$ou = "DC=" + $domainName -replace "\.", ",DC=" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T21:34:00.673

只计算数组长度还不够吗？

```
$domainName = "testdomain.co.uk"
$domainNameSplit = $domainName.split(".")

$domainNameSplitCount = $domainNameSplit.count 
```

或创建一个 DN：

```
$domainName = "testdomain.co.uk"
$domainNameSplit = $domainName.split(".")
$a = [string]::empty
$domainNameSplit | % { $a+="DC=$_," }
$a.trim(',') 
```

# javascript - 整数计算是否比 JavaScript 中的实数值计算提高了性能？

> ID：15179658
> 
> 赞同：1
> 
> 时间：2013-03-02T21:32:01.353
> 
> 标签：javascript, performance

我正在试验一些我在课堂上学到的图形功能。在书中，它说整数计算提高了 C++ 的性能。但我是在 JavaScript 上做的。它在 Javascript 中重要吗？

在 Chrome 上，它运行流畅。毫不奇怪，它的性能在 Firefox 19 和 IE10 中显着下降

```
function circ(cx, cy, rad, color){  //Using second-order differential
            var x = 0;
            var y = rad;
            var d = 1 - rad;
            var deltaE = 3;
            var deltaSE = -2*rad+5;
            ctx.beginPath();
            ctx.strokeStyle = color;
            ptc(cx,cy,x,y);
            while(y>x){
                if(d<0){                //Select E
                    d+=deltaE;
                    deltaE +=2;
                    deltaSE +=2;
                }
                else{                   //Select SE
                    d+=deltaSE;
                    deltaE+=2;
                    deltaSE+=4;
                    y--;
                }
                x++;
                ptc(cx,cy,x,y);
            }
            ctx.stroke();

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:33:44.683

如果您正在处理非常大的分数，那么可以肯定，数字越简单，它运行的速度就越快，但基于该数字的任何动画都会越不流畅。

# php - 计算来自 2 个不同表的总条目数

> ID：15179663
> 
> 赞同：1
> 
> 时间：2013-03-02T21:32:51.177
> 
> 标签：php, mysql, sql, ranking

我正在尝试根据他们提交到 2 个不同表的条目数对我的用户进行排名。

表 gvr：

```
rid | jid 
---------------
1     54
2     54
3     54
4     75
5     75 
```

表去：

```
sid | jid
---------------
1     54
2     54
3     75
4     75
5     23
6     23 
```

期望的结果：

```
jid | overall_cnt | gvr_cnt | gos_cnt
----------------------------------
54    5            3          2
75    4            2          2
23    2            0          2 
```

我有：

```
(SELECT jid, count(*) gvr_count
FROM gvr 
WHERE jid IS NOT NULL
GROUP BY jid)
UNION ALL 
(SELECT jid, count(*) gos_count
FROM gos
WHERE jid IS NOT NULL
GROUP BY jid) 
```

但这是非常不正确的。我一直在寻找与我的情况类似的其他帖子，但还没有找到任何有价值的东西。我正在考虑将数据操作加载到 PHP 上，但在一个查询中完成它会很方便。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:52:09.667

您的查询非常接近。你想要`union all`然后做一个`group by`：

```
select jid, sum(gvr_count) + sum(gos_count) as Overall_Count,
        sum(gvr_count) as gvr_count, sum(gos_count) as gos_count
from ((SELECT jid, count(*) gvr_count, 0 as gos_count
       FROM gvr 
       WHERE jid IS NOT NULL
       GROUP BY jid
      )
      UNION ALL 
      (SELECT jid, 0 as gvr_count, count(*) gos_count
       FROM gos
       WHERE jid IS NOT NULL
       GROUP BY jid
      )
     ) t
group by jid 
```

我认为这是 MySQL 中确保您获得所有“jid”的最佳方法，即使是那些仅在一个表中的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T22:01:17.950

我更新了 Gordon 的答案，这是最好的方法。

```
 select jid ,sum(gvr_count)+ sum(gos_count) as OverallCount ,
  sum(gvr_count) as gvr_count, sum(gos_count) as gos_count
   from ((SELECT jid, count(*) gvr_count, 0 as gos_count
   FROM gvr 
   WHERE jid IS NOT NULL
   GROUP BY jid
  )
  UNION ALL 
  (SELECT jid, 0 as gvr_count, count(*) gos_count
   FROM gos
   WHERE jid IS NOT NULL
   GROUP BY jid
  )
 ) t
group by jid 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T21:47:21.317

```
SELECT temp.jid,gvr_cnt + gos_cnt as totals,temp.*
FROM
(
SELECT gos1.jid
,(SELECT COUNT(*) from gvr where gvr.jid = gvr1.jid) AS gvr_cnt
,(SELECT COUNT(*) from gos where gos.jid = gos1.jid) AS gos_cnt
FROM gos gos1 left join gvr gvr1 on gos1.jid = gvr1.jid
group by gos1.jid
  ) as temp
group by temp.jid 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/117109/27)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T21:46:00.583

这可能不完全正确，但我希望你能从这里得到它：

```
SELECT innerQuery_1.jid AS jid, 
       (innerQuery_1.gvr_count + innerQuery_2.gos_count) AS overall_cnt, 
       innerQuery_1.gvr_count AS gvr_count,
       innerQuery_2.gos_count AS gos_count
FROM   (SELECT jid, count(*) gvr_count
        FROM   gvr 
        WHERE  jid IS NOT NULL
        GROUP BY jid) AS innerQuery_1,
       (SELECT jid, count(*) gos_count
        FROM   gos
        WHERE jid IS NOT NULL
        GROUP BY jid) AS innerQuery_2
GROUP BY innerQuery_1.jid 
```

# r - R中的散点图最佳拟合线错误 - formula.default（object，env = baseenv（））中的错误

> ID：15179666
> 
> 赞同：1
> 
> 时间：2013-03-02T21:33:03.360
> 
> 标签：r, scatter-plot

我正在尝试为散点图绘制一条简单的最佳拟合线。

这个例子有效：

```
plot(dist ~ speed, data= cars, xlab="Speed", ylab="Distance", col= "blue")
title(main="Scatter plot with best-fit line", font.main= 4)
abline(lm(dist ~ speed, data= cars), col= "red") 
```

但是使用我的数据，我收到一条错误消息：

```
plot(log(datatest$MEAN_intact_for),log(datatest$ERmammal_0_1), col= "blue")
title(main="Scatter plot with best-fit line", font.main= 4)
abline(lm(log(datatest$ERmammal_0_1)~log(datatest$MEAN_intact_for)), col= "red")
Error in lm.fit(x, y, offset = offset, singular.ok = singular.ok, ...) : 
  NA/NaN/Inf in 'x' 
```

我试过搜索它，但我是 R 新手，所以如果有人能给我任何简单的建议，那就太好了。
- 当我只是绘制它工作正常的图表时，问题是当我添加 abline 命令以获得最佳拟合线时。我也试过

希望有人可以提供帮助。道歉，如果它真的很明显。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-31T20:38:28.630

当您使用 abline() 时，您需要输入截距 (a) 和斜率 (b) 作为参数，而不是仅仅将 lm() 粘贴在那里。所以让我们说：

```
fmla = lm(log(datatest$ERmammal_0_1)~log(datatest$MEAN_intact_for)) 
```

那么你想要：

```
abline(a = fmla$coefficients[1], b = fmla$coefficients[2]) 
```

# sql - 在 SQL Server 的 select 语句中有动态 sql？

> ID：15179670
> 
> 赞同：0
> 
> 时间：2013-03-02T21:33:22.483
> 
> 标签：sql, sql-server, stored-procedures, dynamic

我有一份动态内容调查表，并且我有需要使用 SQL 进行推广的控件？

我试图从表中选择`Questionnaire`并运行存储在下面“PrepopulateContentSQL”列中的 SQL 语句。查询返回单个值。

前任：

```
Select name from Agency 
```

我的桌子`Questionnaire`：

```
QuestionID int 
Required bit
Data_Type int
Control_Type int 
Data_Choices nvarchar
Data_Max_Length int  
Question_Group_Id int
Question_Label nvarchar
Question_Order int  
PrepopulateContentSQL nvarchar
PrePopulated bit 
```

我在想也许是一个功能？

```
Select 
    QuestionID, Required, Control_Type, Data_Choices, 
    GetPrepopulated(PrepopulateContentSQL) As PreValue
From 
    Questionnaire 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:59:50.167

您确定要存储每次执行的 sql 字符串吗？如果它们像“从机构中选择名称”一样简单，我想它们可以很容易地实现为类似宏的系统，您可以在其中预定义许多查询，而预填充列可以简单地保存一个参考.

这将为您提供更多安全性（因为您不再需要过多担心该 sql 的内容），并且可能为您提供自定义 UI 以显示 @AgencyName 而不是“从代理机构中选择名称”的范围

只是一个想法...

# django - Django：使用父模板中的 forloop 值

> ID：15179677
> 
> 赞同：0
> 
> 时间：2013-03-02T21:34:11.190
> 
> 标签：django, django-templates

我可以从父模板 forloop 中获取 forloop 值吗？IE：

```
parent.html
{% extends 'base.html' %}
{% block content %}
    {% for i in nnn %}
        {% include child.html %}
    {% endfor %}
{% end block %}

child.html
{% extends 'base.html' %}
{% block content %}
    {{ forloop.counter from parent.html }}
{% endblock %}

def ViewParent(request):
    return render_to_response('parent.html', {}, context_instance) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:32:39.587

`include`模板标签支持使用关键字[`with`传递参数](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#include)。

父.html：

```
{% extends 'base.html' %}
{% block content %}
    {% for i in nnn %}
        {% include child.html with loop_counter=forloop.counter %}
    {% endfor %}
{% end block %} 
```

child.html:

```
{{ loop_counter }} 
```

请注意，您实际上可能并不是要从与父模板相同的基本模板扩展子模板，因此在此示例中我省略了它。

# regex - \W 是否包含回车 (\r) 或换行 (\n) 字符？

> ID：15179678
> 
> 赞同：0
> 
> 时间：2013-03-02T21:34:13.313
> 
> 标签：regex, regex-negation

IOWs，\w 字符类的否定形式。我应该期望我使用正则表达式的不同语言有不同的行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:32:13.073

当然`\W`包括`\r`和`\n`。

`\W`是`\w`和`\w`包含字母、数字和连接标点符号（如下划线）的否定。

现在有3种可能：

1.  `\w`是基于 ASCII 的 ==>`[a-zA-Z0-9_]`

2.  `\w`是基于 Unicode 的 ==> 类似`[\p{L}\p{Nd}\p{Pc}]`表示所有语言的字母、数字以及更多类似于下划线的字符[请参阅 Unicode on regular-expressions.info](http://www.regular-expressions.info/unicode.html)

3.  `\w`风味允许您使用修饰符切换 的行为。

但是由于换行符从未包含在其中，`\w`因此它们在所有情况下都包含在`\W`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:37:01.920

\w 是一个简写形式，`[a-zA-Z0-9_]`所以它只匹配 az（小写和大写）、数字和下划线。否定的 \w 是 \W 将匹配除 \w 之外的所有内容

[在这里](http://www.regular-expressions.info/wordboundaries.html)阅读更多。

基本上有两种类型的正则表达式，POSIX 和 Perl。从理论上讲，posix 正则表达式应该独立于编程语言，但也有一些已知的例外。请参阅此线程了解 Java 和 .NET 之间的差异（理论上相同的 posix，实际上不一样） [Java 和 C# 正则表达式是否兼容？](https://stackoverflow.com/questions/538579/are-java-and-c-sharp-regular-expressions-compatible)

# php - 用php提取数组

> ID：15179680
> 
> 赞同：0
> 
> 时间：2013-03-02T21:34:37.293
> 
> 标签：php, arrays, multidimensional-array

我对数组多维 print_r 数组的提取值有疑问：

```
Array
(
[0] => Array
    (
        [0] => Array
            (
                [referent] => vespucci
            )

        [1] => Array
            (
                [referent] => colombo
            )

    )

[1] => eb38f736ef826180218c8c0c804f7bebe6d995c1
) 
```

我想提取“参考”值，但如果我收到嵌套 foreach 的错误：

```
Warning: Invalid argument supplied for foreach() in 
```

完全符合第二个 foreach：

```
foreach($posts as $post)
            {
                foreach($post as $po)
                {
                    $change[] = $po;
                }
            } 
```

我在哪里做错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:37:18.777

您的变量在到达时不是数组`$post[1]`。

所以它应该在第一个上工作正常，但第二个失败，因为你不能`foreach`进入不是数组的东西=）。

您是否必须遍历数组，或者您可以直接获取值，因为您知道它在哪里？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:38:35.187

这是因为数组的第二个元素不是数组；你可以这样做：

```
foreach($posts[0] as $post)
    $change[] = $post; 
```

如果您只想要参考值，您可以使用：

```
foreach($posts[0] as $post)
    $change[] = $post['referent']; 
```

这是一般的：

```
foreach($posts as $post){
   if( is_array($post)){
      foreach($post as $po){
          if(isset($po['referent']))
            $change[] = $po['referent'];
      }
   }
} 
```

# android - 文本渲染：optimizeLegibility 崩溃 Android 股票浏览器

> ID：15179681
> 
> 赞同：1
> 
> 时间：2013-03-02T21:34:50.480
> 
> 标签：android, css, text-rendering

今天我注意到我*所有*的网页都在我的 HTC 上崩溃了股票浏览器。经过一些调试，我发现这是`text-rendering: optimizeLegibility;`导致这种情况的原因。从我的代码中删除它后，一切正常。
有人可以证实这一点吗？我能做些什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T10:23:59.820

我在 Nexus 7 上使用 WebView（基本上是普通浏览器）进行文本渲染时遇到问题。它没有崩溃任何东西，但它忽略了 CSS 中的所有字体系列声明。它只是在所有内容上使用默认字体。

# xcode - 工作副本需要比 Xcode 支持的更新版本的 Subversion

> ID：15179683
> 
> 赞同：9
> 
> 时间：2013-03-02T21:35:13.513
> 
> 标签：xcode, software-update

我刚刚安装`Xcode 4.6`（我有`Xcode 4.5.1`）。我刚刚打开一个现有项目并收到此消息：

> 工作副本“path/to/my project”需要比 Xcode 支持的更新版本的 Subversion。

我目前正在将*Cornerstone*用于 svn，并且了解我可能会忽略此消息 - 但由于我想保持最新状态，我需要做些什么来解决这个问题？

![警告截图](../Images/363ab863b9e9beefba90e869629044f3.png)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-03T04:34:55.743

Xcode 4.6 默认使用 SVN 1.6.X，但您项目的 SVN 信息可能是 1.7.X（可能由 Cornerstone 更新）。因此，当您尝试更新时，会显示错误消息。所以我们必须让Xcode使用最新的1.7.X SVN。

* * *

我也遇到了同样的问题。这就是我的解决方案：

1.  安装 Homebrew，我们将使用它来安装最新的 SVN：

    > ruby -e "$(curl -fsSL [https://raw.github.com/mxcl/homebrew/go](https://raw.github.com/mxcl/homebrew/go) )"

2.  安装最新的 SVN：

    > 冲泡安装颠覆

3.  备份旧的 SVN 文件并链接最新的 SVN：

    > ```
    > cd /Applications/Xcode.app/Contents/Developer/usr/bin/        
    > mkdir bak.svn
    > mv svn* bak.svn
    > ln -s /usr/local/Cellar/subversion/1.7.8/bin/svn* /Applications/Xcode.app/Contents/Developer/usr/bin/ 
    > ```

4.  重启 Xcode

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-19T09:45:03.250

就我而言，最新的 SVN 位于路径 /usr/bin/，因此第 3 步将如下所示：

```
cd /Applications/Xcode.app/Contents/Developer/usr/bin/        
mkdir bak.svn
mv svn* bak.svn
ln -s /usr/bin/svn* /Applications/Xcode.app/Contents/Developer/usr/bin/ 
```

# ios - Frank (Cucumber) - 检测首次运行

> ID：15179685
> 
> 赞同：0
> 
> 时间：2013-03-02T21:35:24.370
> 
> 标签：ios, cucumber, frank, acceptance

我想写一个测试，说明如果这是第一次启动应用程序，那么应该显示方向。我如何检测到 Frank 的第一个应用程序启动？我在考虑使用 NSUserDefaults，但我仍然不知道该怎么做。示例步骤定义代码会很棒。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:39:34.020

`NSUserDefaults`利用先前未设置为 nil的事实：

```
NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
NSNumber *firstRun = [userDefaults valueForKey:@"firstRun"];
if (firstRun == nil)
{
    [userDefaults setValue:@YES forKey:@"firstRun"];
    [userDefaults synchronize];
    // Do what you want here
} 
```

# jquery - 结合 jQuery UI 自动完成源

> ID：15179687
> 
> 赞同：1
> 
> 时间：2013-03-02T21:35:37.510
> 
> 标签：jquery, jquery-ui, jquery-autocomplete, jquery-ui-autocomplete

我使用以下源标签实现了我喜欢的功能：

```
source: function (request, response) {
                 // delegate back to autocomplete, but extract the last term
                 response($.ui.autocomplete.filter(availableTags, extractLast(request.term)));
             }, 
```

我通过使用以下源标签实现了新功能：

```
source: function (request, response) {
                // Using a custom source callback to match only the beginning of terms
                var matcher = new RegExp("^" + $.ui.autocomplete.escapeRegex(request.term), "i");
                response($.grep(availableTags, function (item) {
                    return matcher.test(item);
                }));
            } 
```

我怎样才能结合这两个源标签，以便我可以同时拥有两者的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:00:09.600

我认为您正在寻找这样的东西（只需将结果传递`extractLast`到正则表达式而不是整个术语）：

```
source: function (request, response) {
    var term = extractLast(request.term),
        matcher = new RegExp("^" + $.ui.autocomplete.escapeRegex(term), "i");

    response($.grep(availableTags, function (item) {
        return matcher.test(item);
    }));
} 
```

**示例：http:** [//jsfiddle.net/Aa5nK/6/](http://jsfiddle.net/Aa5nK/6/)

两者都在做什么：

*   第一个是根据用户键入的最后一项过滤自动完成术语（由 a 描绘`,`）
*   第二个是根据用户键入的术语创建一个[正则表达式。](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)意思是“从`^`”开始，然后是从术语中删除任何特殊字符的实用函数，最后`i`是使正则表达式不区分大小写的参数。
*   将它们组合起来只需提取最后一个术语（使用`extractLast`，然后基于该术语创建一个正则表达式。

# cx-oracle - 插入语句 cx_Oracle

> ID：15179689
> 
> 赞同：2
> 
> 时间：2013-03-02T21:35:49.877
> 
> 标签：cx-oracle

我是 cx_Oracle 的新手，正在使用 Python3 开发一个项目，但遇到了一些错误。这是我的代码：

```
 uemail="jack@gmail.com"
    uname="Jack"
    upassword="asdasd"
    cursInsert=connection.cursor()
    insert_stat="insert into users(email,name,pass,last_login) values (:uemail,:uname,:upassword,NULL)"
    cursInsert.execute(insert_stat)
    connection.commit()
    cursInsert.close() 
```

这是我得到的错误消息：并非所有变量都绑定

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-19T15:16:02.090

您必须像这样将值传递给 oracle 的绑定变量

```
cursInsert.execute(insert_stat, uemail=uemail, uname=uname, upassword=upassword) 
```

# php - 用户使用 php 和 mysql 数据库登录

> ID：15179691
> 
> 赞同：0
> 
> 时间：2013-03-02T21:36:19.633
> 
> 标签：php, mysql, login

我是 mysql 和 php 的新手。

一直致力于为用户创建一个带有表的数据库。

我已经成功地将用户添加到数据库，他们的密码使用 md5（是的，我知道它不安全），它不会在线启动。

我的问题是，如何根据用户正确的用户名和密码登录用户。

这是我的代码

查询运行后我的逻辑是正确的，它将返回真或假。

如果为真，则显示登录成功，否则显示登录失败。

但是，即使我输入了正确的用户名和密码，我仍然会收到不成功的登录消息

我检查了mysql数据库，并且uesrname在那里正确

想法？

```
if(!empty($_POST['userLog']) && !empty($_POST['passLog']))
{
    //set the username and password variables from the form
    $username = $_POST['userLog'];
    $password = $_POST['passLog'];

    //create sql string to retrieve the string from the database table "users"
    $sql = "SELECT * FROM `users` WHERE userName = '$username' AND password = md5('$password')";
    $result = mysql_query($sql);
        if ($result == true) {
            $return = "<font color=#008000><Center><b>**Successful Login**</b></Center></font>";
        } else {
            $return = "<font color=#ff0000><Center><b>**Failed Login**</b></Center></font>";
        }
        print($return);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:41:59.720

我不完全确定你的 SQL 会运行，但只是为了安全起见。

改变它，以便

```
$password_hash = md5($password);

$sql = "SELECT * FROM `users` WHERE userName = '$username' AND password = '$password_hash'"; 
```

对于你原来的问题

```
if(mysql_num_rows($result) == 1) { //If the SQL returns one row, that means that a user was found with `userName = $username` and `password = md5($password)`
    // Login
} else {
    // Authentication Failed
} 
```

此外，考虑使用 MySQLi 而不是 MySQL，因为它已被贬值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:42:26.303

首先，保护您的代码免受[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。

然后，确保数据库中的密码确实使用 md5() 函数进行了哈希处理。确保您的表单使用 POST 方法将数据传递给脚本。

试试下面的代码：

```
if(!empty($_POST['userLog']) && !empty($_POST['passLog']))
{
    //set the username and password variables from the form
    $username = $_POST['userLog'];
    $password = $_POST['passLog'];

    //create sql string to retrieve the string from the database table "users"
    $sql = "SELECT * FROM `users` WHERE userName = '". addslashes($username) ."' AND password = '". md5('$password')."'";
    $result = mysql_query($sql);
        if (mysql_num_rows($result)>0) {
            $return = "<font color=#008000><Center><b>**Successful Login**</b></Center></font>";
        } else {
            $return = "<font color=#ff0000><Center><b>**Failed Login**</b></Center></font>";
        }
        print($return);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T21:43:04.383

`mysql_query`不返回 TRUE 或 FALSE。根据文档（[http://php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)），如果成功则返回资源，如果出现错误则返回 FALSE。您需要评估资源以查看它是否有效。

```
if(!empty($_POST['userLog']) && !empty($_POST['passLog']))
{
    //set the username and password variables from the form
    $username = $_POST['userLog'];
    $password = $_POST['passLog'];

    //create sql string to retrieve the string from the database table "users"
    $sql = "SELECT * FROM `users` WHERE userName = '$username' AND password = md5('$password')";
    $result = mysql_query($sql);
    if ($result && $row = mysql_fetch_assoc($result)) {
        $return = "<font color=#008000><Center><b>**Successful Login**</b></Center></font>";
    } else {
        $return = "<font color=#ff0000><Center><b>**Failed Login**</b></Center></font>";
    }
    print($return);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T21:47:37.147

正如我的评论中提到的，问题似乎是你的 sql 字符串。您将方法放入字符串中，而不是散列。所以改变

```
$sql = "SELECT * FROM `users` WHERE userName = '$username' AND password = md5('$password')"; 
```

到

```
$sql = "SELECT * FROM `users` WHERE userName ='$username' AND password = '".md5('$password')."'"; 
```

您的结果不会是 true 或 false，但由于 php 将任何非 0 的值视为 true，因此它将按原样工作。此外，强烈建议转义进入 sql 字符串的所有数据，以防止 sql 注入。另一个注意事项：mysql 已被弃用，所以现在是迁移到 mysqli 之类的好时机。

# c# - 在月历上的选定日期存储用户输入

> ID：15179694
> 
> 赞同：0
> 
> 时间：2013-03-02T21:36:46.057
> 
> 标签：c#, winforms, forms, monthcalendar

我创建了一个表单，它接受用户输入的几个不同信息（标题、位置、日期（来自一个月日历）等），当单击添加按钮时，信息存储在当前数组元素和标题中显示在列表框中。当列表框中的标题被选中时，该特定标题的其余信息将重新填充到相应的文本框中。

我一直试图更进一步，但没有成功。单击“添加”按钮时，我希望将用户输入保存到月份日历上选择的日期。因此，如果用户单击没有保存信息的日期，则 listBox 保持为空。如果在某个日期保存了信息，则列表框将显示标题。

代码片段：

```
class MeetingManager
{
    private Meeting[] meetings; 
    public int currentIndex;  
    public int maxIndex;   
    private string title;       
    private string location;  
    private string startTime; 
    private string endTime; 
    private string notes;    

    public MeetingManager()
    {
        meetings = new Meeting[10];
        currentIndex = -1;
        maxIndex = -1;
    }

   // excluded getter/setters + basic error checking 

    public void Add()
    {
        try
        {
            if (maxIndex >= meetings.Length - 1)
            {
                throw new ApplicationException("YOU CAN ONLY CREATE 10 MEETINGS");
            }
            else
            {
                maxIndex++;
                currentIndex = maxIndex;
                Meeting temp = new Meeting(Title, Location, StartTime, EndTime, Notes);
                meetings[maxIndex] = temp;
                Title = meetings[maxIndex].Title;
                Location = meetings[maxIndex].Location;
                StartTime = meetings[maxIndex].StartTime;
                EndTime = meetings[maxIndex].EndTime;
                Notes = meetings[maxIndex].Notes;

            }
        }
        catch (ApplicationException ex)
        {
            throw ex; // toss it up to the presentation

        }
    }

    public void Add(string title, string location, string startTime, string endTime, string notes)
    {
        try
        {
            Title = title;
            Location = location;
            StartTime = startTime;
            EndTime = endTime;
            Notes = notes;
            Add();
        }
        catch (ApplicationException ex)
        {
            throw ex;
        }
    }
     public override string ToString()
    {
        return Title;
    } 
```

}

```
 public partial class CalendarForm : Form
{
     private MeetingManager mManager; // reference to business layer object

     private void calendarSaveChangesButton_Click(object sender, EventArgs e)
    {
        try
        {
            mManager.Title = textBoxTitle.Text;
            mManager.Location = textBoxLocation.Text;
            mManager.StartTime = maskedStartTimeTextBox.Text;
            mManager.EndTime = maskedEndTimeTextBox.Text;
            mManager.Notes = notesTextBox.Text;
            mManager.Add();

            meetingListBox.Enabled = true;
            meetingListBox.Items.Add(mManager);

            //clears the textBoxes after clickng saveChanges
            textBoxTitle.Text = "";
            textBoxLocation.Text = "";
            maskedStartTimeTextBox.Text = "";
            maskedEndTimeTextBox.Text = "";
            notesTextBox.Text = "";

        }
        catch (ApplicationException ex)
        {
            MessageBox.Show(this, ex.Message);
        }

    }

        /// <summary>
    ///  When a meeting is selected from the listBox, it re-populates
    /// the empty fields with the information stored in the array element
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    private void meetingListBox_SelectedIndexChanged(object sender, EventArgs e)
    {
        MeetingManager m = meetingListBox.SelectedItem as MeetingManager;
        if (m != null)
        {
            textBoxTitle.Text = m.Title;
            textBoxLocation.Text = m.Location;
            maskedStartTimeTextBox.Text = m.StartTime;
            maskedEndTimeTextBox.Text = m.EndTime;
            notesTextBox.Text = m.Notes;

        }
    } 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T22:57:42.917

好吧，我想你可以尝试这样的事情：

```
class MeetingManager
{
    ...

    //add and implement a find method which returns a Meeting-object if there is a
 //corresponding meeting date (in private Meeting[] meetings;)

    public Meeting MeetingFinder(DateTime meetingTime)
    {
        //if there is a corresponding meeting-object for the date, return the meeting object
        //if there isn't, return null
    }

    ...
} 
```

* * *

```
public partial class CalendarForm : Form
{

    ...

    private void monthCalendar_DateChanged(object sender, DateRangeEventArgs e)
    {
        //which date was selected?
            var selectedDate = monthCalendar.SelectionRange.Start;

        //do we have that date in the meetings?
        var meetingOnTheSelectedDate = mManager.MeetingFinder(selectedDate);

        if(meetingOnTheSelectedDate != null)
        {
            //populate your winform with the data from meetingOnTheSelectedDate
        }
    }

    ...

} 
```

# http - Glassfish - 没有主机的路线

> ID：15179697
> 
> 赞同：0
> 
> 时间：2013-03-02T21:37:04.507
> 
> 标签：http, networking, glassfish, connection, appserver

在我们的企业应用程序中，App-server (Glassfish) 连接到内容管理系统以获取一些要在网页上显示的静态内容。通过以下方式进行连接：

```
org.apache.commons.httpclient.HttpClient 
```

有 4 个 App-Server 用于服务器用户的 HTTPRequest，它们都连接到该内容管理系统以获取静态内容。

假设 App-Server 连接到的 CMS URL 是：`http://somedomain.com/content`

这种机制可以正常工作，没有任何问题，但有时这些 App-server 之一开始抛出：

```
java.net.NoRouteToHostException: No route to host 
```

此异常仅出现在其中一台服务器上，表明与 Content Management System 的连接不存在全局问题。发生此异常时，我什至尝试通过在地址栏中输入通过 Web 浏览器访问 CMS `http://somedomain.com/content`，并且效果很好。

当我们重新启动受影响的服务器时，问题就消失了。

想知道什么可以动态引入这个错误？

# jquery - mCustomScrollbar 不适用于 html 5 音频播放器

> ID：15179699
> 
> 赞同：2
> 
> 时间：2013-03-02T21:37:14.480
> 
> 标签：jquery, scroll, custom-scrolling

我有一个纯 html 5 音频播放器的问题，在 mCustomScrollbar 滚动器内，当我尝试拖动播放器的跟踪器时它发疯了，鼠标连接到播放器跟踪器这里是一个链接[http://jsfiddle.net/ FhWez/10/embedded/result/](http://jsfiddle.net/FhWez/10/embedded/result/) 谢谢。

```
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title></title>
<meta name="description" content="">
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="http://manos.malihu.gr/tuts/custom-scrollbar-plugin/jquery.mCustomScrollbar.css" />

<style>
.tracks
{
margin-left: 72px;
padding-top: 30px;
height: 150px;
width: 860px;
}
</style>    
</head>
<body>
<div class="container">
<div id="playlist">
<div class="tracks">
<div class="track">
<div class="track-title">Around Mountains 2</div>
<div class="track-audio">
<audio src="http://mos.futurenet.com/intermusic/audio/samples/funk-demo-loops/GuitarD_90A-01.mp3" type="audio/mpeg" controls="controls" />
</div>
<div class="track-download"></div>
</div>
<div class="track">
<div class="track-title">Around Mountains 2</div>
<div class="track-audio">
<audio src="http://mos.futurenet.com/intermusic/audio/samples/funk-demo-loops/GuitarD_90A-01.mp3" type="audio/mpeg" controls="controls" />
</div>
<div class="track-download"></div>
</div>
<div class="track">
<div class="track-title">Around Mountains 2</div>
<div class="track-audio">
<audio src="http://mos.futurenet.com/intermusic/audio/samples/funk-demo-loops/GuitarD_90A-01.mp3" type="audio/mpeg" controls="controls" />
</div>
<div class="track-download"></div>
</div>
<div class="track">
<div class="track-title">Around Mountains 2</div>
<div class="track-audio">
<audio src="http://mos.futurenet.com/intermusic/audio/samples/funk-demo-loops/GuitarD_90A-01.mp3" type="audio/mpeg" controls="controls" />
</div>
<div class="track-download"></div>
</div>                     
</div>  
</div>

</div> <!-- /container -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="http://manos.malihu.gr/tuts/custom-scrollbar-plugin/jquery.mCustomScrollbar.concat.min.js"></script>
<script>
(function($){
$(window).load(function(){
$(".tracks").mCustomScrollbar({
theme:"dark-thick"
});
});
})(jQuery);
</script>
</body>
</html> 
```

# android - 你可以在 Windows 服务器上设置 GCM 吗？

> ID：15179701
> 
> 赞同：4
> 
> 时间：2013-03-02T21:37:27.450
> 
> 标签：android, push-notification, google-cloud-messaging

我想使用[GCM (Google Cloud Messaging)](http://developer.android.com/google/gcm/demo.html#server-setup)并且想知道是否可以在 Windows Server (IIS) 上设置它？

目前，我的 Web 服务都作为 WCF 服务托管在 Windows 服务器上。我想避免为 GCM 配备专用服务器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-03T00:56:48.910

而不是什么？任何连接到 Internet 的服务器都可以用作 GCM 消息的发送者。您的 Android 应用程序必须能够连接您的服务器才能将设备注册 ID 传递给它。并且您的服务器必须能够发送 POST 请求`https://android.googleapis.com/gcm/send`才能发送消息。

或如[GCM 文档](http://developer.android.com/google/gcm/gcm.html)中所述：

> 在编写使用 GCM 功能的客户端 Android 应用程序之前，您必须有一个满足以下条件的应用程序服务器：
> 
> 1.  能够与您的客户沟通。
> 2.  能够向 GCM 服务器发出 HTTPS 请求。
> 3.  能够使用指数回退处理请求并根据需要重新发送它们。
> 4.  能够存储 API 密钥和客户端注册 ID。API 密钥包含在发送消息的 POST 请求的标头中。

# algorithm - 为什么这个与算法成本相关的表达式会有这个结果？

> ID：15179705
> 
> 赞同：1
> 
> 时间：2013-03-02T21:38:06.450
> 
> 标签：algorithm

嗨，对不起我的英语不好。我正在学习计算机科学，但我不明白为什么这个表达式（在图像中）有这个结果。

![Tmedio 是](../Images/67dca935b1874ef51775e4ffe59b3ef9.png)

Tmedio 是线性搜索算法的“中等”成本，根据我的想法和总结性的定义，如果例如 n = 4，结果应该是：(1/4)*(1+2+3+ 4）......我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:42:36.053

前 n 个数字的总和是 n*(n+1)/2。因此你得到 (1/n) * n * (n+1)/2 = (n+1)/2。

在此处查看与此身份相关的 wiki 页面：[http ://en.wikipedia.org/wiki/1_%2B_2_%2B_3_%2B_4_%2B_%E2%8B%AF](http://en.wikipedia.org/wiki/1_%2B_2_%2B_3_%2B_4_%2B_%E2%8B%AF)

# linux - 当我在我的包的配置文件中添加一个新的配置参数时，我应该怎么做？

> ID：15179706
> 
> 赞同：1
> 
> 时间：2013-03-02T21:38:15.767
> 
> 标签：linux, package, configuration-files, package-managers

我正在处理一些项目的一些包。

假设我的项目中有一个这样的配置文件。

```
name=foo
mail=foo@foo.com 
```

安装后，用户使用他/她的信息编辑配置文件。

```
name=user
mail=user@somedomain.com 
```

当更新到来时，为了不破坏用户配置文件，我不会像所有软件包一样用新文件替换 conf 文件。

到目前为止没有问题。

如果我在我的配置文件中添加一个新参数怎么办？例如，

```
name=foo
mail=foo@foo.com
age=23 
```

如果我用新的配置文件替换，用户将丢失其设置。如果我不这样做，我的新参数将无法使用。我想知道这种情况的一般程序是什么？无论它是什么包类型（即 rpm、deb 或 tbz），我的问题都是有效的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T01:49:09.500

我不确定我是否看到了问题。只要软件可以处理config文件中没有字段的情况（即使用合理的默认值），那么你描述的两种场景没有区别。如果您的软件无法处理该字段的缺失，我认为这是一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-11T07:41:16.990

@William Pursell：仅仅因为您没有看到问题，并不意味着没有问题。

这绝对是一个问题，自从我维护 deb 包以来，它一直困扰着我。例如：许多配置文件包含注释的配置项和其他注释，包用户在应用他的配置更改之前应该阅读和理解。如果在正常的软件开发过程中，有新的配置项、新的默认值或与现有的不同的语义，则必须修改注释。这是包维护者的工作。但同时，包不能与用户已经应用的配置更改混为一谈。

当我在 Debian/Ubuntu 中执行此操作时，软件包用户会遇到这个令人生畏的问题：

```
Configuration file `/etc/...'
==> Modified (by you or by a script) since installation.
==> Package distributor has shipped an updated version.
What would you like to do about it ? Your options are:
Y or I : install the package maintainer's version
N or O : keep your currently-installed version
D : show the differences between the versions
Z : start a shell to examine the situation
The default action is to keep your current version.
*** ... (Y/I/N/O/D/Z) [default=N] ? 
```

对于每个文件。也就是说，对于某些软件包升级，用户每次都必须多次键入 yes/no/maybe :-)。事实上，包用户通常不知道这是怎么一回事。她必须深入研究文件，比较版本，并进行一些猜测才能找出合理的答案。顺便说一句，如果包装系统允许的话，包装维护者可能已经做出了回答。

我认识到这个问题可能不存在通用解决方案。但我很想听听其他包维护者如何应对这种情况。

# perl - Perl用正则表达式解析文本文件

> ID：15179710
> 
> 赞同：1
> 
> 时间：2013-03-02T21:38:27.607
> 
> 标签：perl

我有一个包含以下随机结构的文件：

```
USMS 1362224754632|<REQ MSISDN="00966590832186" CONTRACT="580" SUBSCRIPTION="AAA" FORMAT="ascii" TEXT="L2" 
```

或者

```
USMS 1362224754632|<REQ MSISDN="00966590832186" CONTRACT="580" SUBSCRIPTION="BBB" THRESHOLDID="1" FORMAT="ascii" TEXT="L2" 
```

我正在尝试用 perl 解析它以获得如下值：

1362224754632;00966590832186;580;AAA;L2

下面是代码：

```
if($Record =~ /USMS (.*?)|<REQ MSISDN="(.*?)" CONTRACT="(.*?)" SUBSCRIPTION="(.*?)" FORMAT="(.*?)" THRESHOLDID="(.*?)" TEXT="(.*?)"/)
{
                              print LOGFILE "$1;$2;$3;$4;$5;$6;$7\n";
}
elsif($Record =~ /USMS (.*?)|<REQ MSISDN="(.*?)" CONTRACT="(.*?)" SUBSCRIPTION="(.*?)" FORMAT="(.*?)" TEXT="(.*?)"/)
{
                              print LOGFILE "$1;$2;$3;$4;$5;$6\n";
} 
```

但我总是：

```
;;;;; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T21:50:23.550

Pipe ( `|`) 是正则表达式中的特殊字符。逃避它，就像：`\|`它会工作。

```
if($Record =~ /USMS (.*?)\|<REQ MSISDN="(.*?)" CONTRACT="(.*?)" SUBSCRIPTION="(.*?)" FORMAT="(.*?)" THRESHOLDID="(.*?)" TEXT="(.*?)"/) 
```

`else`分支也是如此。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T23:31:35.980

我不会使用单个正则表达式，而是先将数据拆分为单独的部分，然后分别处理它们。

```
my($usms_part, $request) = split / \s* \|<REQ \s* /x, $Record;

my($usms_id) = $usms_part =~ /^USMS (\d+)$/;

my %request;
while( $request =~ /(\w+)="(.*?)"/g ) {
    $request{$1} = $2;
} 
```

不必对所有可能的键/值对及其可能的顺序进行硬编码，您可以在一段代码中对其进行一般解析。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T21:46:52.457

改变

```
(.*?) 
```

至

```
([a-zA-Z0-9]*) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-03T14:38:06.480

看起来您想要的只是双引号中包含的字段。

看起来像这样

```
use strict;
use warnings;

while (<DATA>) {
  my @values = /"([^"]+)"/g;
  print join(';', @values), "\n";
}

__DATA__
USMS 1362224754632|<REQ MSISDN="00966590832186" CONTRACT="580" SUBSCRIPTION="AAA" FORMAT="ascii" TEXT="L2"
USMS 1362224754632|<REQ MSISDN="00966590832186" CONTRACT="580" SUBSCRIPTION="BBB" THRESHOLDID="1" FORMAT="ascii" TEXT="L2" 
```

**输出**

```
00966590832186;580;AAA;ascii;L2
00966590832186;580;BBB;1;ascii;L2 
```

# html - 如何正确对齐文本？

> ID：15179711
> 
> 赞同：1
> 
> 时间：2013-03-02T21:38:28.637
> 
> 标签：html, css, alignment, font-size

我正在尝试在 html 中制作链接列表。默认情况下，链接都对齐到容器的左侧，![法线对齐](../Images/0c1a7be1044e96f46752ded2e6c455fa.png) 但是当字体更改时（即字体大小：1.5em;），这些线条形成金字塔图案并且不包含最后一个数字。![金字塔模式中的链接](../Images/49d189dde2ee6c38185b9fb913041c87.png)

Firefox 和 chrome 都会出现此问题。

这是html

```
 <div id="container">
        <div id="content">
            <div class="links">
                <span class="rank" style="width:2.20ex;" >1</span>
                <a href="http://www.youtube.com/">this is a test</a>
            </div>
            <div class="links">
                <span class="rank" style="width:2.20ex;" >2</span>
                <a href="http://www.youtube.com/">this is a test</a>
            </div>
            <div class="links">
                <span class="rank" style="width:2.20ex;" >3</span>
                <a href="http://www.youtube.com/">this is a test</a>
            </div>
            <div class="links">
                <span class="rank" style="width:2.20ex;" >4</span>
                <a href="http://www.youtube.com/">this is a test</a>
            </div>
            <div class="links">
                <span class="rank" style="width:2.20ex;" >5</span>
                <a href="http://www.youtube.com/">this is a test</a>
            </div>
            <div class="links">
                <span class="rank" style="width:2.20ex;" >6</span>
                <a href="http://www.youtube.com/">this is a test</a>
            </div>
            <div class="links">
                <span class="rank" style="width:2.20ex;" >7</span>
                <a href="http://www.youtube.com/">this is a test</a>
            </div>
            <div class="links">
                <span class="rank" style="width:2.20ex;" >8</span>
                <a href="http://www.youtube.com/">this is a test</a>
            </div>
            <div class="links">
                <span class="rank" style="width:2.20ex;" >9</span>
                <a href="http://www.youtube.com/">this is a test</a>
            </div>
            <div class="links">
                <span class="rank" style="width:2.20ex;" >10</span>
                <a href="http://www.youtube.com/">this is a test</a>
            </div>
        </div>
    </div> 
```

这是CSS

```
#container {
    margin: 0 auto;
    width: 1024px;
}

#content {
    background-color: green;
}

.rank {
    color: #c63131;
    float: left;
    font-family; arial;
    font-size: 1.5em;
    margin-right: 0.2em;
    text-align: right;
}

.links {
    margin-left: 3px;
}

.links a {
    text-decoration: none;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:43:17.183

```
.links {
    overflow:hidden;
} 
```

或者`Clear:both;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T21:46:33.173

只需从您的等级课程中删除浮动

```
.rank 
{
/*float:left*/
} 
```

# java - java中\"的正则表达式

> ID：15179716
> 
> 赞同：3
> 
> 时间：2013-03-02T21:38:59.647
> 
> 标签：java, regex, parsing, csv, pattern-matching

我需要为从文件中读取的字符串编写一个正则表达式

```
apple,boy,cat,"dog,cat","time\" after\"noon"

```

我需要把它分成

```
苹果
男生
猫
狗猫
中午之后的时间

```

我尝试使用

```
Pattern pattern = 
Pattern.compile("[\\\"]");
String items[]=pattern.split(match); 
```

第二部分，但我无法得到正确的答案，你能帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T22:40:32.093

由于您的问题更多的是解析问题而不是正则表达式问题，因此这是另一种可行的解决方案：

```
public class CsvReader {

    Reader r;
    int row, col;
    boolean endOfRow;

    public CsvReader(Reader r){
        this.r = r instanceof BufferedReader ? r : new BufferedReader(r);
        this.row = -1;
        this.col = 0;
        this.endOfRow = true;
    }

    /**
     * Returns the next string in the input stream, or null when no input is left
     * @return
     * @throws IOException  
     */
    public String next() throws IOException {
        int i = r.read();
        if(i == -1)
            return null;

        if(this.endOfRow){
            this.row++;
            this.col = 0;
            this.endOfRow = false;
        } else {
            this.col++;
        }

        StringBuilder b = new StringBuilder();
outerLoop:  
        while(true){
            char c = (char) i;
            if(i == -1)
                break;
            if(c == ','){
                break;
            } else if(c == '\n'){
                endOfRow = true;
                break;
            } else if(c == '\\'){
                i = r.read();
                if(i == -1){
                    break;
                } else {
                    b.append((char)i);
                }
            } else if(c == '"'){
                while(true){
                    i = r.read();

                    if(i == -1){
                        break outerLoop;
                    }
                    c = (char)i;
                    if(c == '\\'){
                        i = r.read();
                        if(i == -1){
                            break outerLoop;
                        } else {
                            b.append((char)i);
                        }
                    } else if(c == '"'){
                        r.mark(2);
                        i = r.read();
                        if(i == '"'){
                            b.append('"');
                        } else {
                            r.reset();
                            break;
                        }
                    } else {
                        b.append(c);
                    }
                }
            } else {
                b.append(c);
            }
            i = r.read();
        }

        return b.toString().trim();
    }

    public int getColNum(){
        return col;
    }

    public int getRowNum(){
        return row;
    }

    public static void main(String[] args){

        try {
            String input = "apple,boy,cat,\"dog,cat\",\"time\\\" after\\\"noon\"\nquick\"fix\" hello, \"\"\"who's there?\"";
            System.out.println(input);
            Reader r = new StringReader(input);
            CsvReader csv = new CsvReader(r);
            String s;
            while((s = csv.next()) != null){
                System.out.println("R" + csv.getRowNum() + "C" + csv.getColNum() + ": " + s);
            }
        } catch(IOException e){
            e.printStackTrace();
        }
    }
} 
```

运行此代码，我得到输出：

```
R0C0: apple
R0C1: boy
R0C2: cat
R0C3: dog,cat
R0C4: time" after"noon
R1C0: quickfix hello
R1C1: "who's there? 
```

这应该非常适合您的需求。

不过，有一些免责声明：

*   它不会捕获 CSV 格式的语法错误，例如值中间的非转义引号。
*   它不会执行任何字符转换（例如将“\n”转换为换行符）。反斜杠只会导致以下字符被逐字处理，包括其他反斜杠。（如果您需要额外的功能，这应该很容易改变）
*   一些 csv 文件通过将引号加倍而不是使用反斜杠来转义引号，此代码现在查找两者。

编辑：查找 csv 格式，发现没有真正的标准，但更新了我的代码以捕获通过加倍而不是反斜杠转义的引号。

编辑2：已修复。应该像现在宣传的那样工作。还对其进行了修改以测试行号和列号的跟踪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:43:46.467

第一件事： String.split() 使用正则表达式来查找分隔符，而不是子字符串。

编辑：我不确定这是否可以用 String.split() 来完成。我认为在只匹配逗号的同时处理引号的唯一方法是预读和后视，这在很多情况下都会中断。

Edit2：我很确定它可以用正则表达式来完成。而且我确信这种情况可以用 string.split() 解决——但一般的解决方案并不简单。

基本上，您正在寻找不是逗号作为输入的任何内容 [^,]，您可以将引号作为单独的字符处理。我自己已经走了大部分路。我得到这个作为输出：

```
apple

boy

cat

dog

cat

time\" after\"noon 
```

但我不确定为什么它有这么多空行。

我的完整代码是：

```
String input = "apple,boy,cat,\"dog,cat\",\"time\\\" after\\\"noon\"";

Pattern pattern =
        Pattern.compile("(\\s|[^,\"\\\\]|(\\\\.)||(\".*\"))*");
Matcher m = pattern.matcher(input);

while(m.find()){
    System.out.println(m.group());
} 
```

但是，是的，我会回应上面的那个人并说如果不需要使用正则表达式，那么手动执行它可能更简单。

但后来我想我快到了。它吐出来了……哦，嘿，我明白这里发生了什么。我想我可以解决这个问题。

但是我要回应上面的那个人，并说如果不需要使用正则表达式，最好一次使用一个字符并手动实现逻辑。如果您的正则表达式不完美，那么它可能会导致各种不可预知的怪异现象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T23:07:43.167

我不太确定，但你可以试试**`Pattern.compile("[\\\\"]");`**

`\`是一个转义字符，可以使用来检测`\`表达式中的a。`\\\\`

在[**另一种情况下**](https://stackoverflow.com/questions/13939925/remove-all-occurrences-of-from-string)，类似的事情对我有用，我希望它也能解决你的问题。

# mercurial - HG PUSH 不会推送到本地目录。未找到存储库

> ID：15179717
> 
> 赞同：0
> 
> 时间：2013-03-02T21:39:11.470
> 
> 标签：mercurial, push, tortoisehg

我在本地机器上的几个项目中使用 Tortoise HG 两个句柄源代码控制。我正在推送到 HD 上其他地方的本地目录，作为处理修订历史的一种方式。

我的目录设置如下：

项目位于此处：例如 MyDocuments\Project1。

我将提交推送到这里：

C:\Repository\Project1 C:\Repository\Project2

对于其中一个项目，这是可行的。另一方面，当我尝试推送时，我收到一个找不到目录的错误。两个目录的安全设置 (Windows 7) 相同。

MyDocuments\Project2 曾一度处于此源代码控制之下，但后来出现了问题。因此，我删除了 .hg 文件和 hg 目录并重新开始，在那里创建了一个新存储库并添加了所有文件以进行初始提交。但是初始提交不会推送。它说：

**未找到存储库 C:\Repository\Project2**

我不知所措。我已经删除了 HG 文件和目录 3 次并重新开始，但我无法推送。我试过推送到不同的目录 - 没有运气。我猜想重新开始会出现一些问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T14:27:40.160

您不应该删除该`.hg`文件夹，因为这使它成为 Mercurial 存储库。

我会说解决方案是将`MyDocuments\Project2`存储库重新克隆到`C:\Repository\Project2`并从那里重新开始。

以后如果到了觉得需要删除`.hg`文件夹的位置，就不要了。回到这里，看看我们能不能做些什么来帮助解决这个问题。

# php - 使用 php 以相同的形式添加更多值

> ID：15179718
> 
> 赞同：-2
> 
> 时间：2013-03-02T21:39:19.960
> 
> 标签：php, javascript, mysql, ajax

我正在研究预订系统

我有一个输入凭证信息的表格

凭证可以有一个组，一个组可以有很多乘客

现在我想要做的是以相同的形式获取有关凭证的所有信息，并在用户输入所有内容后将与该凭证相关的所有内容添加到数据库中。

我打算怎么做：我放置了一个 Anchor 标签，上面写着“添加更多乘客”，并且将调用 onclick() 函数来重置这些字段，然后 ajax 将转到一个 php 页面并将这些值临时保存在某个地方临时位置/变量应该是全局或超级全局，因为当我最终必须一次将所有内容添加到数据库时，我必须全部访问它们，但问题是我在哪里存储用户先前输入的那些值

我真的希望我已经把我的问题说清楚了，任何帮助都会很棒，并且在此先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:40:43.763

将数据存储在 Session 中。见[http://php.net/manual/en/features.sessions.php](http://php.net/manual/en/features.sessions.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:41:39.573

我建议在每一步都将数据增量保存到数据库中。这样，您的会话将保持轻松。会话实际上是用于必须存储在那里以便在所有页面上轻松访问的数据。

唯一的缺点是，如果用户通过表单/页面获得了 3/4 的路径，然后退出，那么您将看到一行信息不完整。我认为保留这是一件好事，然后您可以在他们重新登录时提示他们“完成他们开始的工作”！

所以你看，没有必要暂时保存任何东西。只需将它真正保存在数据库中，它应该放在哪里。在接下来的页面中，您的表单可以更新 MySQL 而不是 INSERTing。

# javascript - 通过 AJAX 使用单个提交按钮提交多个 HTML 表单

> ID：15179719
> 
> 赞同：0
> 
> 时间：2013-03-02T21:39:19.787
> 
> 标签：javascript, html, ajax, forms, post

我有一个名为的页面`publish.php`，允许用户输入他们刚刚上传到上一页的每张图片的详细信息（名称、描述、位置等），每张图片都有自己的表单来输入这些信息。不是所有的表格都同时显示，而是所有的图片都以缩略图的形式显示在页面的顶部，点击图片会隐藏上一张图片的表格并显示当前图片的表格，所以它类似于选项卡式布局。

我想要做的是通过单个提交按钮提交所有这些表单，该按钮与每个表单隔离并位于`publish.php`页面的单独区域 - 如果有任何错误，我也想回应它们。我的简短研究表明，仅使用 HTML 是不可能的，因此需要 AJAX。

这是显示每个图像和表单的 PHP 代码的精简版本：

```
// Display each image
$i = 0;
foreach ($images as $image) {
   echo '<img src="imageSrc'.$i.'" />';
   $i++;
}

// Further down the page... display each form...
$i = 0;
foreach ($images as $image) {
    include 'publishform.php';
    $i++;
} 
```

`publishform.php`看起来有点像这样：

```
<form id="image<?php echo $i; ?>">
   <label>Name</label>
   <input name="image[<?php echo $i; ?>][Name]" />

   <label>Location</label>
   <input name="image[<?php echo $i; ?>][Location]" />

   <!-- etc, etc, for description, coordinates, camera etc -->

</form> 
```

所以基本上，每个图像都通过变量链接到每个表单，该变量`$i`根据需要递增，直到`$images`到达数组的末尾。在页面的右上角，我放置了一个提交按钮，如果没有错误，我想提交所有这些表单，如果有，只需将它们回显而不提交。

我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T21:51:44.627

这样的事情呢？

```
function post_form_data(data) {
    $.ajax({
        type: 'POST',
        url: 'somewhere',
        data: data,
        success: function () {},
        error: function () {}
    });
}

$('button').on('click', function () {
    $('form').each(function () {
        post_form_data($(this).serialize());
    });
}); 
```

[http://jsfiddle.net/MxHQe/](http://jsfiddle.net/MxHQe/)

# android - Google Play 市场替代付款方式

> ID：15179725
> 
> 赞同：-1
> 
> 时间：2013-03-02T21:39:44.960
> 
> 标签：android, payment, google-play

我来自您可以从 Google Play Market 购买应用程序的国家/地区，但您不能出售，例如，如果我为 android 创建应用程序，我只能将其发布以免费下载。任何人都可以建议任何替代服务或方法，我如何销售我的应用程序？请思考/建议你会怎么做？像用户下载应用程序，通过 PayPal 付款，应用程序检查是否付款，然后应用程序启动......

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:51:53.580

使用第三方计费供应商（如 PayPal 等）违反 Google Play 的服务条款。如果这样做，您将面临帐户被暂停的风险。

在正式支持之前，我开始从印度销售应用程序。为此，我在美国注册了一家有限责任公司。我向[LegalZoom](http://www.legalzoom.com/)支付了大约 200 美元来处理注册等问题。到目前为止，它对我来说效果很好，而且我觉得没有必要改变这种方法，尽管印度现在被支持为直接商家。

# c# - 将数百万个项目从一个存储帐户转移到另一个

> ID：15179726
> 
> 赞同：5
> 
> 时间：2013-03-02T21:39:53.460
> 
> 标签：c#, azure, parallel-processing, azure-blob-storage, parallel.foreach

作为利用 Azure VM 支持的大规模迁移的一部分，我需要将大约 420 万张图像从美国中北部迁移到美国西部（对于那些不知道的人，美国中北部不支持他们）。图像都在一个容器中，分为大约 119,000 个目录。

我正在使用 Copy Blob API 中的以下内容：

```
public static void CopyBlobDirectory(
        CloudBlobDirectory srcDirectory,
        CloudBlobContainer destContainer)
{
    // get the SAS token to use for all blobs
    string blobToken = srcDirectory.Container.GetSharedAccessSignature(
        new SharedAccessBlobPolicy
        {
            Permissions = SharedAccessBlobPermissions.Read |
                            SharedAccessBlobPermissions.Write,
            SharedAccessExpiryTime = DateTime.UtcNow + TimeSpan.FromDays(14)
        });

    var srcBlobList = srcDirectory.ListBlobs(
        useFlatBlobListing: true,
        blobListingDetails: BlobListingDetails.None).ToList();

    foreach (var src in srcBlobList)
    {
        var srcBlob = src as ICloudBlob;

        // Create appropriate destination blob type to match the source blob
        ICloudBlob destBlob;
        if (srcBlob.Properties.BlobType == BlobType.BlockBlob)
            destBlob = destContainer.GetBlockBlobReference(srcBlob.Name);
        else
            destBlob = destContainer.GetPageBlobReference(srcBlob.Name);

        // copy using src blob as SAS
        destBlob.BeginStartCopyFromBlob(new Uri(srcBlob.Uri.AbsoluteUri + blobToken), null, null);          
    }
} 
```

问题是，它太慢了。哇哇太慢了。以发出命令复制所有这些东西的速度，它将需要大约四天的时间。我不太确定瓶颈是什么（连接限制客户端、Azure 端的速率限制、多线程等）。

所以，我想知道我的选择是什么。有什么办法可以加快速度，还是我只是坚持需要四天才能完成的工作？

**编辑：我如何分发工作以复制所有内容**

```
//set up tracing
InitTracer();

//grab a set of photos to benchmark this
var photos = PhotoHelper.GetAllPhotos().Take(500).ToList();

//account to copy from
var from = new Microsoft.WindowsAzure.Storage.Auth.StorageCredentials(
    "oldAccount",
    "oldAccountKey");
var fromAcct = new CloudStorageAccount(from, true);
var fromClient = fromAcct.CreateCloudBlobClient();
var fromContainer = fromClient.GetContainerReference("userphotos");

//account to copy to
var to = new Microsoft.WindowsAzure.Storage.Auth.StorageCredentials(
    "newAccount",
    "newAccountKey");
var toAcct = new CloudStorageAccount(to, true);
var toClient = toAcct.CreateCloudBlobClient();

Trace.WriteLine("Starting Copy: " + DateTime.UtcNow.ToString());

//enumerate sub directories, then move them to blob storage
//note: it doesn't care how high I set the Parallelism to,
//console output indicates it won't run more than five or so at a time
var plo = new ParallelOptions { MaxDegreeOfParallelism = 10 };
Parallel.ForEach(photos, plo, (info) =>
{
    CloudBlobDirectory fromDir = fromContainer.GetDirectoryReference(info.BuildingId.ToString());

    var toContainer = toClient.GetContainerReference(info.Id.ToString());
    toContainer.CreateIfNotExists();

    Trace.WriteLine(info.BuildingId + ": Starting copy, " + info.Photos.Length + " photos...");

    BlobHelper.CopyBlobDirectory(fromDir, toContainer, info);
    //this monitors the container, so I can restart any failed
    //copies if something goes wrong
    BlobHelper.MonitorCopy(toContainer);
});

Trace.WriteLine("Done: " + DateTime.UtcNow.ToString()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T02:54:47.440

在同一个数据中心内，异步 blob 复制操作将非常快（最近我在大约 1-2 秒内将 30GB vhd 复制到另一个 blob）。跨数据中心，操作排队并发生在没有 SLA 的备用容量中（请参阅[这篇文章](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/06/12/introducing-asynchronous-cross-account-copy-blob.aspx)，其中特别指出了这一点）

从这个角度来看：我跨数据中心复制了相同的 30GB VHD，大约花了 1 小时。

我不知道您的图像大小，但假设平均图像大小为 500K，您将看到大约 2,000 GB。在我的示例中，我在大约一个小时内看到了 30GB 的吞吐量。推断，这将估计您的 2000 GB 数据在大约 (2000/30) = 60 小时内。同样，没有 SLA。只是一个最好的猜测。

其他人建议禁用 Nagle 的算法。这应该有助于更快地推出 400 万条复制命令并让它们更快地排队。我认为它不会对复制时间产生任何影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T00:35:09.787

这有点远，但我在表存储方面遇到了类似的问题，即小请求（我认为`BeginStartCopyFromBlob`应该如此）开始运行非常缓慢。这是[Nagle 算法](http://en.wikipedia.org/wiki/Nagle%27s_algorithm)和[延迟 TCP 确认](http://en.wikipedia.org/wiki/TCP_delayed_acknowledgment)的问题，这是对网络流量的两个优化。有关详细信息，请参阅[MSDN](http://blogs.msdn.com/b/windowsazurestorage/archive/2010/06/25/nagle-s-algorithm-is-not-friendly-towards-small-requests.aspx)或[此人。](http://robertgreiner.com/2012/06/why-is-azure-table-storage-so-slow/)

结果 - 关闭 Nagle 的算法 -在执行任何 Azure 存储操作**之前调用以下命令。**

```
ServicePointManager.UseNagleAlgorithm = false; 
```

或者只是 blob：

```
var storageAccount = CloudStorageAccount.Parse(connectionString);
ServicePoint blobServicePoint = ServicePointManager.FindServicePoint(account.BlobEndpoint);
blobServicePoint.UseNagleAlgorithm = false; 
```

很高兴知道这是否是您的问题！

# android - 使用 libgdx 连接两个设备

> ID：15179727
> 
> 赞同：5
> 
> 时间：2013-03-02T21:39:54.420
> 
> 标签：android, connection, p2p, libgdx, device

我正在使用 libgdx 在 pc 和 android 上开发视频游戏。我想通过本地网络上的 Wifi 或蓝牙连接它们。这个想法是在 p2p 中玩，轻松建立这种连接。请任何人都可以为此提供帮助或源代码，知道连接可以是：android/android 也可以是 PC/PC（因为 libgdx 允许这样做）？我完全不知道。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-03T12:14:41.187

好吧，因为 libgdx 没有很好的网络支持，您可以自己编写，但我发现[Kryonet](https://github.com/EsotericSoftware/kryonet)非常好。编写应用程序的网络层需要很多麻烦，我已经用它来连接移动设备和桌面，没有任何问题。绝对值得快速浏览。它也有一些很好的例子来让你开始和运行网络游戏。

我还发现Valve 的[这篇文章](https://developer.valvesoftware.com/wiki/Source_Multiplayer_Networking)非常有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-03T05:27:10.470

网络在某种程度上超出了 Libgdx 的范围。对 HTTP GET/POST/PUT 有一些基本支持，但这意味着您已经有一个 DNS 名称或 IP 地址可以连接，这通常意味着您有一个相对固定的“服务器”可以连接（而不是任意对等点）。点对点网络绝对超出了 Libgdx 的范围。

从好的方面来说，由于 Android 和桌面网络已经非常接近，您可以使用大多数支持点对点的纯 Java 网络基础设施。查看其他 Stack Overflow 问题，例如：[点对点通信选项](https://stackoverflow.com/questions/5041426/peer-to-peer-communication-options) 我认为您会发现点对点网络真正困难的部分是“发现”（即计算您关心的点的地址）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-29T14:38:58.657

几乎没有文档，但 LibGDX 确实有一个**独立于平台的** *（Android、桌面、iOS 和 GWT）*套接字类。
我会将您链接到它的用法示例，但正如我所说；没有书面文档/示例。

但是，我可以给你这个链接作为一个很好的起点。

> [http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/Net.html](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/Net.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-29T04:39:19.927

libgdx-net 看起来不错。[https://github.com/pepedeab/libGDX-Net](https://github.com/pepedeab/libGDX-Net)

我自己还没有测试过。

# jquery - 这个事件在 jQuery 中的名称是什么？

> ID：15179728
> 
> 赞同：1
> 
> 时间：2013-03-02T21:40:05.450
> 
> 标签：jquery

此页面中 jQuery 的此事件的名称是什么：

[https://stackoverflow.com/about](https://stackoverflow.com/about) 请注意播放动画（当我查看页面的特定部分时）。

Facebook 中的另一个示例，当我查看页面或查看包含它的浏览器选项卡时，内容会自动刷新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:41:53.247

一般模式被称为“滚动间谍”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:43:01.587

您可以跟踪`scroll`事件，即

```
$(window).on('scroll', ...); 
```

或使用轮询连续查看`$(window).scrollTop()`以找到页面相对于顶部的当前位置。

# javascript - 从网页获取图像 src 的代码

> ID：15179729
> 
> 赞同：0
> 
> 时间：2013-03-02T21:40:11.207
> 
> 标签：javascript, image

我对这段代码有疑问：

```
 var someStr = "";
    var txtBox=document.createElement("textarea");
    for(var i = 0;i < 10;i++)
    {           
           var a=document.getElementsByTagName("img")[i];
           var urll = a.getAttribute("src");
           someStr += "\n" + urll;
    }
    document.body.appendChild(txtBox).innerHTML = someStr; 
```

我正在尝试制作一个脚本，从给定的网页中获取所有图像 src 并列出它们。然后通过其他已经完成的代码，我将下载它们。通过`[i]`我尝试在每个循环中移动到下一个图像，但它给了我 10 倍于相同的图像。有任何想法吗？

PS：感谢您的快速回复！！！

有人知道如何使用js下载数组中的图像吗？我知道用 c#、c++、VB.net 做这件事很热，但我不想让用户下载任何软件。我想不出任何简单的方法来使用 js，因为它必须在不同的站点上工作。有任何想法吗？我真的很感激。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-02T22:17:36.557

您可以尝试将所有来源添加到数组中

```
var array = new Array();
var images = document.getElementsByTagName("img");

for (var i = 0; i < images.length; i++)
{
array.push(images[i].src);
} 
```

# pointers - C++ 指针被编译器初始化为 null

> ID：15179733
> 
> 赞同：0
> 
> 时间：2013-03-02T21:40:35.067
> 
> 标签：pointers, memory, null, allocation

所以我已经被困在记忆问题上好几天了。我有一个使用 c++ 运行的多线程程序。我初始化了一个 double* 指针。根据我的阅读和以前的编程经验，指针被初始化为垃圾。如果将其初始化为 0 或分配的内存对程序来说太多，它将为 Null。对我来说，我的指针初始化，没有分配，给了我一个空指针。我编写的解析器函数假设返回指向已解析信息数组的指针。当我调用该函数时，

```
double* data;
data = Parser.ReadCoordinates(&storageFilename[0]); 
```

现在返回的指向数组的指针应该设置为数据。然后我尝试从数组中打印出一些东西。我收到内存损坏错误。我已经运行了 gdb，它给了我一个内存损坏错误：

```
*** glibc detected *** /home/user/kinect/openni/Platform/Linux/Bin/x64-Debug/Sample-NiHandTracker: free(): corrupted unsorted chunks: 0x0000000001387f90 ***
*** glibc detected *** /home/user/kinect/openni/Platform/Linux/Bin/x64-Debug/Sample-NiHandTracker: malloc(): memory corruption: 0x0000000001392670 *** 
```

有人可以向我解释发生了什么吗？我尝试将指针初始化为全局指针，但这也不起作用。我尝试分配内存，但仍然出现内存损坏错误。解析器工作。我已经用一个简单的程序对其进行了测试。所以我不明白为什么它在我的其他程序中不起作用。我究竟做错了什么？如果需要，我还可以提供更多信息。

解析器代码

双* csvParser::ReadCoordinates(char* 文件名){

```
int x;              //counter
int size=0;         //
char* data;
int i = 0;          //counter

FILE *fp=fopen(filename, "r");

if (fp == NULL){
 perror ("Error opening file");
}

while  (( x = fgetc(fp)) != EOF ) {  //Returns the character currently pointed by the internal file position indicator
    size++;     //Number of characters in the csv file
}

rewind(fp);                         //Sets the position indicator to the beginning of the file
printf("size is %d.\n", size);      //print

data = new char[23];                //Each line is 23 bytes (characters) long
size = (size/23) * 2;               //number of x, y coordinates

coord = new double[size];           //allocate memory for an array of coordinates, need to be freed somewhere

num_coord = size;                   //num_coord is public

//fgets (data, size, fp);
//printf("data is %c.\n", *data);

for(x=0; x<size; x++){
    fgets (data, size, fp);
    coord[i] = atof(&data[0]);          //convert string to double
    coord[i+1] = atof(&data[11]);       //convert string to double
    i = i+2;
}

delete[] data;

fclose (fp);

return coord; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:51:35.057

当您在数组或向量的范围之外写入时，会发生损坏的内存。
它被称为[**堆欠载和溢出**](http://www.informit.com/articles/article.aspx?p=1081496&seqNum=2)（取决于它在哪一侧）。

堆的分配数据已损坏，因此您看到的症状是 free() 或 new() 调用中的异常。
您通常不会遇到访问冲突，因为内存已分配并且属于您，但它被堆的逻辑使用。

找到您可能在数组边界之外写入的位置。

# javascript - 使用 javascript 动态插入带有样式的文本

> ID：15179735
> 
> 赞同：0
> 
> 时间：2013-03-02T21:40:52.483
> 
> 标签：javascript, html, css, dynamic

我正在开发一个小文本框，它将主动显示不同的文本而无需重新加载页面。我使用 javascript 根据用户点击的链接插入文本段落。它可以工作，但是，我还想将样式属性插入到动态插入的内容中。我想这样做是因为 div 的背景将是黑色的。

这是我的 JS

```
 function navClicked(x){

        //alert("function activated");
        //alert(x);
        if (x == "aboutButton"){
            //alert("About Button");
            document.getElementById('information').innerHTML = "About Click";
        }
        else if(x == "faqButton"){
            //alert("FAQ Button");
            document.getElementById('information').innerHTML = "FAQ Click";
        }
        else if(x == "servicesButton"){
            //alert("Services Button");
            document.getElementById('information').innerHTML = "Services Click";
        }
        else{
            //alert("Contact Button");
            document.getElementById('information').innerHTML = "Contact Click";
        }
    } 
```

这是随之而来的html

```
<body>
        <div id="navigation">
            <table cellpadding="5">
                <tr>
                    <td>
                        <a onClick="navClicked('aboutButton');" style="cursor: pointer; cursor: hand;">ABOUT ATS</a>
                    </td>
                </tr>
                <tr>
                    <td>
                        <a onClick="navClicked('faqButton');" style="cursor: pointer; cursor: hand;">FAQ</a>
                    </td>
                </tr>
                <tr>
                    <td>
                        <a onClick="navClicked('servicesButton');" style="cursor: pointer; cursor: hand;">SERVICES</a>
                    </td>
                </tr>
                <tr>
                    <td>
                        <a onClick="navClicked('contactButton');" style="cursor: pointer; cursor: hand;">CONTACT</a>
                    </td>
                </tr>               
            </table>
        </div>
        <div id="information">
            <p>
                content
            </p>
        </div>
    </body> 
```

最后是 CSS

```
<style>
body, div, h1, h2, h3, h4, h5, h6, p, ul, img {margin:0px; padding:0px; }
    p
    {
    color:white;
    }

    #navigation
    {   
        height:145px;
        float:left;
        width:155px;
        background:grey;
    }
    #navigation table
    {
        margin-left:auto;
        margin-right:auto;
        color:white;
    }

    #information
    {
        height:145px;
        float:left;
        width:290px;
        background:black;
    }
</style> 
```

最终产品有效。但是，每当将新文本插入到框中时，它就会变成黑色。然后你无法阅读文本。

这是一个 jsFiddle [http://jsfiddle.net/9xahg/](http://jsfiddle.net/9xahg/)

虽然它在小提琴中不起作用，我不知道为什么。但无论如何，它在所有浏览器中都按预期工作，但您无法阅读新文本。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:47:19.990

尝试添加

```
color: white; 
```

改为#information

这是因为我用它设置了 p 元素的样式，而你在编写新文本时没有打印出 ap 元素......

或者你也可以在编写文本时放入 ap 元素：

```
document.getElementById('information').innerHTML = "<p>About Click</p>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T21:48:54.147

只需添加“颜色：白色；” 在#information CSS 声明中：

```
#information
{
    height:145px;
    float:left;
    width:290px;
    background:black;
    color: white;
} 
```

它的工作;）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T21:45:50.303

JQuery 正是为此而设计的，因此您可以像在 CSS 中一样引用 HTML 元素。如果您想使用 JavaScript 为元素设置样式，我强烈建议您使用 jQuery。从长远来看，它会在节省时间方面得到回报。一旦你有了它，就有一个特定的`.css()`功能可以帮助你。

# javascript - 解析 Javascript 日期

> ID：15179738
> 
> 赞同：1
> 
> 时间：2013-03-02T21:41:06.450
> 
> 标签：javascript, python, date

我正在查看的网站具有以下代码。

```
var d = new Date(1362236400000); 
```

这个 javascript 日期对象以某种方式编码以下 HTML 输出，

```
"2/3/2013 10:00" 
```

有人可以解释一下这种编码吗？我需要制作一个 python 脚本来操作这些 javascript 数字以重新创建 HTML 输出。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T21:43:14.373

该值是[自 epoch 以来的毫秒数](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)。在 Python 中可以使用[`datetime.datetime.fromtimestamp()`构造函数](http://docs.python.org/2/library/datetime.html#datetime.datetime.fromtimestamp)处理：

```
>>> import datetime
>>> datetime.datetime.fromtimestamp(1362236400000/1000)
datetime.datetime(2013, 3, 2, 16, 0) 
```

# java - 从 Java 中读取文件时，FileNotFoundException 捕获错误

> ID：15179740
> 
> 赞同：1
> 
> 时间：2013-03-02T21:41:23.053
> 
> 标签：java, file, input, output

我正在尝试编写一个简单的程序，该程序从文本文件中读取整数，然后将总和输出到输出文件。我得到的唯一错误是在第 38 行“未解决的编译问题：文件无法解析”的 catch 块中。请注意，“文件”是我的输入文件对象的名称。如果我注释掉这个异常块，程序运行良好。任何意见，将不胜感激！

```
import java.io.*;
import java.util.Scanner;

public class ReadWriteTextFileExample 
{
    public static void main(String[] args) 
    {
        int num, sum = 0;

        try
        {
            //Create a File object from input1.txt
            File file = new File("input1.txt");
            Scanner input = new Scanner(file);

            while(input.hasNext())
            {
            //read one integer from input1.txt
                num = input.nextInt();
                sum += num;
            }
            input.close();  

        //create a text file object which you will write the output to
        File output1 = new File("output1.txt");
        //check whether the file's name already exists in the current directory
        if(output1.exists())
        {
            System.out.println("File already exists");
            System.exit(0);
        }
        PrintWriter pw = new PrintWriter(output1);
        pw.println("The sum is " + sum);
        pw.close();
    }
    catch(FileNotFoundException exception)
    {
        System.out.println("The file " + file.getPath() + " was not found.");
    }
    catch(IOException exception)
    {
        System.out.println(exception);
    }
}//end main method
}//end ReadWriteTextFileExample 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T21:44:12.480

该`file`变量在`try`块内声明。它超出了`catch`块的范围。（尽管在这种情况下不可能发生，想象一下如果在执行甚至到达变量声明之前抛出异常。基本上，您无法访问`catch`在相应`try`块中声明的块中的变量。）

您应该在 try 块*之前声明它：*

```
File file = new File("input1.txt");
try
{
    ...
}
catch(FileNotFoundException exception)
{
    System.out.println("The file " + file.getPath() + " was not found.");
}
catch(IOException exception)
{
    System.out.println(exception);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T21:45:04.613

Java 中的作用域是基于块的。您在块内声明的任何变量都只在同一块结束之前的范围内。

```
try 
{ // start try block
    File file = ...;

} // end try block
catch (...) 
{ // start catch block

  // file is out of scope!

} // end catch block 
```

但是，如果您在块`file`之前声明`try`，它将保留在范围内：

```
File file = ...;

try 
{ // start try block

} // end try block
catch (...) 
{ // start catch block

  // file is in scope!

} // end catch block 
```

# ios - CGPDFDocumentCreateWithURL(filePath) 在设备上返回 null，但在模拟器上不返回

> ID：15179741
> 
> 赞同：1
> 
> 时间：2013-03-02T21:41:36.463
> 
> 标签：ios, ios5, ios6, xamarin.ios

我正在使用以下行来创建 PDF 参考：

```
CGPDFDocumentRef thePDFDocRef = CGPDFDocumentCreateWithURL(filePath); 
```

在我的模拟器上，这是有效的。但是当我将它部署到我的设备时，调用返回“null”

文件路径完全相同。作为测试，如果文件路径（PDF）存在并且确实存在，我也会打印。

我还检查了区分大小写的东西。我的设备运行 iOS 6.1.2，我正在使用 Simulator 6.0 进行测试。

有任何想法吗？

# java - Java 多线程 - 我将如何生成两个额外的线程来增加数组中的值？

> ID：15179744
> 
> 赞同：1
> 
> 时间：2013-03-02T21:41:52.203
> 
> 标签：java, multithreading

场景：

1.  我有一个包含 15 个索引的整数数组。（每个都填充了一些值）
2.  我希望两个线程将两个（+2）添加到索引的值。每个人都知道已经添加了哪个索引。
3.  然后加入线程并退出。

到目前为止（到我做它的地方）我只是实现了 Runnable 接口并将数组提供给 runnable 内部的计算。我不知道如何从这里进行握手。在此先感谢您的帮助

```
public class FooRunnable implements Runnable
{
    private int[] myArray = {0,1,2,3,4,5,6,7,8,9,10,11,12,13,14};

    @Override
    public void run()
    {
        for(int i=0; i<myArray.length; i++)
        {
            myArray[i] = myArray[i] +2;
            System.out.println("Thread "+Thread.currentThread().getName()+" Finished index: "+i);
            atomicCount.incrementAndGet();
        }
    }

    public static void main(String[] args)
    {
        FooRunnable r = new FooRunnable();
        Thread t1 = new Thread(r);
        Thread t2 = new Thread(r);
        t1.setName("Thread One");
        t2.setName("Thread Two");
        t1.start();
        t2.start();
    }
} 
```

结果（目标）：

当程序退出时。数组应该通过两个不同的线程使数组的每个元素增加 2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:57:03.453

这行不通。线程一有可能与线程二同时读取 myArray[0]。然后两个线程都加 2。您必须在数组中同步或使用 AtomicIntegers。我认为这是某种练习。你想要完成什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:37:32.550

您的代码必须是`synchronized`. 这需要两个线程之间进行适当的线程间通信，以增加后续索引处的值。虽然这可以通过使用`wait`和的旧方法来实现`notify`。但现在你应该切换到`java.util.concurrent`包。代码看起来像这样：

```
import java.util.concurrent.locks.Condition;
import java.util.concurrent.locks.Lock;
import java.util.concurrent.locks.ReentrantLock;
public class Foo
{
    private int[] myArray = {0,1,2,3,4,5,6,7,8,9,10,11,12,13,14};//This array can be of any length.
    private volatile int lastIndex = 0;
    private final Lock lock = new ReentrantLock(true);
    private final Condition condition = lock.newCondition();
    public void increment()
    {
        lock.lock();
        try
        {
            if (isDone())
            {
                return;
            }
            myArray[lastIndex] = myArray[lastIndex]+2;
            System.out.println("Incremented arr["+lastIndex+"] to "+myArray[lastIndex]+" via thread "+Thread.currentThread().getName());
            lastIndex++;
            condition.signal();
            if (!isDone())
            {
                condition.await();
            }
        }
        catch (Exception ex){}
        finally{lock.unlock();}
    }

    public boolean isDone()
    {
        return lastIndex == myArray.length;
    }
    public static void main(String[] args)
    {
       final Foo foo = new Foo();
       Thread th1 = new Thread("Thread1")
        {
           public void run()
            {
               while (!foo.isDone())
               {
                    foo.increment();
               }
            }
        };
        Thread th2 = new Thread("Thread2")
        {
            public void run()
            {
                while (!foo.isDone())
                {
                    foo.increment();
                }
            }
        };
        th2.start();th1.start();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T22:32:24.420

您可以使用整数对象同步整数访问。而且，每当一个线程想要增加一个整数时，它应该检查该整数之前是否已经增加，方法是检查`if(myArray[i].intVal() == i)`this 是否返回 false ，然后另一个线程已经增加了这个整数。需要注意的是，增量之前的整数值等于索引，在这种情况下，i。

```
public class FooRunnable implements Runnable
{
    private Integer[] myArray = {new Integer(0),new Integer(1),new Integer(2),new Integer(3),new Integer(4),new Integer(5),new Integer(6),new Integer(7),new Integer(8),new Integer(9),new Integer(10),new Integer(11),new Integer(12),new Integer(13),new Integer(14)};

    @Override
    public void run()
    {
        for(int i=0; i<myArray.length; i++)
        {
            synchronized(myArray[i]) {
            if(myArray[i].intVal() == i) {
            myArray[i] = myArray[i] +2;
            System.out.println("Thread "+Thread.currentThread().getName()+" Finished index: "+i); }
             }
            atomicCount.incrementAndGet();
        }
    }

    public static void main(String[] args)
    {
        FooRunnable r = new FooRunnable();
        Thread t1 = new Thread(r);
        Thread t2 = new Thread(r);
        t1.setName("Thread One");
        t2.setName("Thread Two");
        t1.start();
        t2.start();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-02T23:51:47.297

而且 - 当然 - 还有其他使用 Atomics 的方法：

```
public class FooRunnable implements Runnable {

    private int[] myArray = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14};
    // Copy myArray into my Atomic version.
    private AtomicInteger[] myAtomicArray = new AtomicInteger[myArray.length];
    {
        for(int i = 0; i < myArray.length; i++ ) {
            myAtomicArray[i] = new AtomicInteger(myArray[i]);
        }
    }

    @Override
    public void run() {
        for (int i = 0; i < myArray.length; i++) {
            myAtomicArray[i].addAndGet(2);
        }
    }

    public static void main(String[] args) throws InterruptedException {
        FooRunnable r = new FooRunnable();
        Thread t1 = new Thread(r);
        Thread t2 = new Thread(r);
        t1.setName("Thread One");
        t2.setName("Thread Two");
        t1.start();
        t2.start();
        // Wait for them both to finish.
        t1.join();
        t2.join();
        // Print my results.
        System.out.println("Results: "+Arrays.toString(r.myAtomicArray));
    }
} 
```

哪个打印

```
Results: [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18] 
```

# c++ - Boost C++ - 入口点？

> ID：15179748
> 
> 赞同：0
> 
> 时间：2013-03-02T21:42:06.540
> 
> 标签：c++, boost, main, entry-point, winmain

基本上，我从项目中的 main() 入口点继续前进并更改为 Windows 项目 - WINAPI WinMain(...)

但是 Boost 抱怨说 cpp_main() 丢失了。我怎样才能避免这种情况？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:41:09.447

如果您在 MS Visual Studio 中工作，请创建 Win32Project，然后使用 WinMain() 函数。如果您创建控制台应用程序，则使用 main() 函数。与boost库无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T19:37:27.227

它`Boost.Test`是需要一个特殊的用户定义入口点的库。请阅读[其手册](http://www.boost.org/doc/libs/1_53_0/libs/test/doc/html/prg-exec-monitor.html)了解详情。

# php - 如何让 PHP 和 C/C++ 相互交互

> ID：15179755
> 
> 赞同：3
> 
> 时间：2013-03-02T21:42:52.543
> 
> 标签：php, c++, c

我有通常的 PHP 和 MYSQL 服务器正在运行，但我想执行一些 CPU 密集型计算。因此，我希望运行一个 C 程序来处理该部分。

是否可以在服务器本身上的 PHP 和 C/C++ 程序之间交换数据？

问候 PP

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:45:45.737

为什么不编写一个 C++ 程序，然后在执行时使用[popen](http://php.net/manual/en/function.popen.php)来获取结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T22:03:11.700

这是可能的，您有多种方法可以实现这一目标。

*   写一个扩展名（正如已经建议的那样）
*   用 'exec()' 调用你的 C 程序
*   使用[Gearman](http://gearman.org/)
*   将 C 程序作为服务运行并通过管道或套接字与其通信

从上面我会选择一个扩展或 Gearman。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T21:54:34.620

写一个扩展:)

[C++ 的 PHP 扩展包装器](https://stackoverflow.com/questions/2445428/php-extension-wrapper-for-c)

```
#include "php.h" 
```

# asp.net-mvc-4 - Mvc 规则和概念

> ID：15179762
> 
> 赞同：0
> 
> 时间：2013-03-02T21:43:16.490
> 
> 标签：asp.net-mvc-4

一个视图只能有一个`@model Folder.ModelName`，但如果我想在一个视图中显示来自两个不同表的数据怎么办？我应该怎么做，正确的方法是什么？例如，如果我想在一个视图中选择当前用户的所有利润并选择当前用户的所有成本，那么显然这是具有 2 个不同模型的 2 个表。基本上我的问题是，我在哪里可以找到该`asp.net mvc`模式的一些规则和概念？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:54:01.267

您将创建一个称为 ViewModel 的东西。ViewModel 可以包含一个或多个实体、方法、附加字段等。然后您将这个 ViewModel 传递给您的 View。例如，

```
namespace Sample
{
    public class ProfitCostViewModel
    {
        public Profit Profit { get; set; }
        public Cost Cost { get; set; }

        public decimal DoSomeCalculations()
        {
            // Do something
        }
    }
} 
```

在您的 Action 中，创建此 ViewModel 类的实例并初始化属性 Profit 和 Cost。然后将此对象传递给视图。在您的视图中，您可以声明模型，例如：

```
@model Sample.ProfitCostViewModel 
```

并将其用作

```
<p>Current profit or something: @Model.Profit.SomeProfitProperty</p>
<p>Sample cost: @Model.Profit.SomeCostProperty</p> 
```

这就是您将两个或多个实体作为模型传递给您的视图的方式。

更新：您的操作可能类似于：

```
public ActionResult YourAction()
{
    var profitCostVm = new ProfitCostViewModel();
    profitCostVm.Profit = LoadProfitFromSomewhere();
    profitCostCm.Cost = LoadCostFromSomewhere();

    return View(profitCostCm);
} 
```

# php - 向 URL 添加附加变量

> ID：15179764
> 
> 赞同：0
> 
> 时间：2013-03-02T21:43:27.390
> 
> 标签：php, mysql, url, url-parameters, urlvariables

我正在尝试向 url 添加其他变量。例如：

example.co.uk/searchtestingv2.php?categories=rockandpop

并添加：&prices=PriceLow

example.co.uk/searchtestingv2.php?categories=rockandpop&value=PriceLow

我试过这个：

```
$query = parse_url($url, PHP_URL_QUERY);

// Returns a string if the URL has parameters or NULL if not
if( $query ) {
    $url .= '&categories';
}
else {
    $url .= '?categories';
} 
```

另一件事是我尝试手动添加它，即：

[http://www.example.co.uk/searchtestingv2.php?categories=rockandpop&value=PriceLow](http://www.example.co.uk/searchtestingv2.php?categories=rockandpop&value=PriceLow)

它不起作用。

这是我的代码：

```
if($_GET['categories'] == 'rockandpop') {   

        $query = "SELECT * FROM searchacts WHERE category='Rock and Pop'";   
    } 

        if($_GET['categories'] == 'tributebands') {   

        $query = "SELECT * FROM searchacts WHERE category='Tribute Bands'";   
    } 
```

和

```
if(isset($_GET['value'])) { 
    if($_GET['value'] == 'PriceLow') { 

        $query = "SELECT * FROM searchacts ORDER BY price ASC";   
    }   
    elseif($_GET['value'] == 'PriceHigh') {   

        $query = "SELECT * FROM searchacts ORDER BY price DESC";   
    }
    elseif($_GET['value'] == 'NameAZ') {   

        $query = "SELECT * FROM searchacts ORDER BY name ASC";   
    } 

    elseif($_GET['value'] == 'NameZA') {   

        $query = "SELECT * FROM searchacts ORDER BY name DESC";  

    }

    else {   

        $query = "SELECT * FROM searchacts";   
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:55:36.757

```
function UpdateUrlParam(name, value)
{
  var href = window.location.href;
  var regex = new RegExp("[&\\?]" + name + "=");
  if(regex.test(href))
  {
    regex = new RegExp("([&\\?])" + name + "=\\d+");
    window.location.href = href.replace(regex, "$1" + name + "=" + value);
  }
  else
  {
    if(href.indexOf("?") > -1)
      window.location.href = href + "&" + name + "=" + value;
    else
      window.location.href = href + "?" + name + "=" + value;
  }
}
UpdateUrlParam('value', 'priceLow); 
```

# java - Java中s15.16定点数的平方根

> ID：15179770
> 
> 赞同：3
> 
> 时间：2013-03-02T21:43:55.750
> 
> 标签：java, fixed-point, square-root

我想编写一个函数来计算 s15.16 定点数的平方根。我知道它是一个有 15 位整数和 16 位小数的有符号数。无论如何，没有任何图书馆就可以做到吗？任何其他语言也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T07:48:54.053

我假设您问这个问题是因为您所在的平台不提供浮点，否则您可以通过浮点平方根实现 15.16 定点平方根，如下所示（这是 C 代码，我假设 Java 代码将看起来很相似）：

```
int x, r;
r = (int)(sqrt (x / 65536.0) * 65536.0 + 0.5); 
```

如果您的目标平台提供快速整数乘法（特别是双宽度结果的乘法或乘高指令），并且您可以为小表格腾出一些内存，请使用 Newton-Raphson 迭代和表格 -基于起始近似值通常是要走的路。通常，一个近似倒数平方根，因为它具有更方便的 NR 迭代。这给出了 rsqrt(x) = 1 / sqrt(x)。通过将它与 x 相乘得到平方根，即 sqrt(x) = rsqrt(x) * x。以下代码显示了如何以这种方式计算正确舍入的 16.16 定点平方根（因为平方根的参数必须是正数，这对于 s15.16 定点同样适用）。通过最小化残差 x - sqrt(x)*sqrt(x) 来执行舍入。

很抱歉，平方根函数本身是 32 位 x86 内联汇编代码，但我上次需要它大约是在 10 年前，这就是我所拥有的。希望大家能从相当广泛的评论中提炼出相关的操作。我包括了用于起始近似值的表格的生成以及详尽地测试函数的测试框架。

```
#include <stdlib.h>
#include <math.h>

unsigned int tab[96];

__declspec(naked) unsigned int __stdcall fxsqrt (unsigned int x)
{
  __asm {
    mov    edx, [esp + 4]      ;// x
    mov    ecx, 31             ;// 31
    bsr    eax, edx            ;// bsr(x) 
    jz     $done               ;// if (!x) return x, avoid out-of-bounds access

    push   ebx                 ;// save per calling convention
    push   esi                 ;// save per calling convention
    sub    ecx, eax            ;// leading zeros = lz = 31 - bsr(x)
    // compute table index
    and    ecx, 0xfffffffe     ;// lz & 0xfffffffe
    shl    edx, cl             ;// z = x << (lz & 0xfffffffe)
    mov    esi, edx            ;// z
    mov    eax, edx            ;// z
    shr    edx, 25             ;// z >> 25
    // retrieve initial approximation from table
    mov    edx, [tab+4*edx-128];// r = tab[(z >> 25) - 32]
    // first Newton-Raphson iteration
    lea    ebx, [edx*2+edx]    ;// 3 * r
    mul    edx                 ;// f = (((unsigned __int64)z) * r) >> 32
    mov    eax, esi            ;// z
    shl    ebx, 22             ;// r = (3 * r) << 22
    sub    ebx, edx            ;// r = r - f
    // second Newton-Raphson iteration
    mul    ebx                 ;// prod = ((unsigned __int64)r) * z
    mov    eax, edx            ;// s = prod >> 32
    mul    ebx                 ;// prod = ((unsigned __int64)r) * s
    mov    eax, 0x30000000     ;// 0x30000000
    sub    eax, edx            ;// s = 0x30000000 - (prod >> 32)
    mul    ebx                 ;// prod = ((unsigned __int64)r) * s
    mov    eax, edx            ;// r = prod >> 32
    mul    esi                 ;// prod = ((unsigned __int64)r) * z;
    pop    esi                 ;// restore per calling convention
    pop    ebx                 ;// restore per calling convention
    mov    eax, [esp + 4]      ;// x
    shl    eax, 17             ;// x << 17
    // denormalize
    shr    ecx, 1              ;// lz >> 1
    shr    edx, 3              ;// r = (unsigned)(prod >> 32); r >> 3
    shr    edx, cl             ;// r = (r >> (lz >> 1)) >> 3
    // round to nearest; remainder can be negative
    lea    ecx, [edx+edx]      ;// 2*r
    imul   ecx, edx            ;// 2*r*r
    sub    eax, ecx            ;// rem = (x << 17) - (2*r*r))
    lea    ecx, [edx+edx+1]    ;// 2*r+1
    cmp    ecx, eax            ;// ((int)(2*r+1)) < rem))
    lea    ecx, [edx+1]        ;// r++
    cmovl  edx, ecx            ;// if (((int)(2*r+1)) < rem) r++
  $done:
    mov    eax, edx            ;// result in EAX per calling convention
    ret    4                   ;// pop function argument and return
  }
}

int main (void)
{
  unsigned int i, r;
  // build table of reciprocal square roots and their (rounded) cubes
  for (i = 0; i < 96; i++) {
    r = (unsigned int)(sqrt (1.0 / (1.0 + (i + 0.5) / 32.0)) * 256.0 + 0.5);
    tab[i] = ((r * r * r + 4) & 0x00ffffff8) * 256 + r;
  }
  // exhaustive test of 16.16 fixed-point square root
  i = 0;
  do {
    r = (unsigned int)(sqrt (i / 65536.0) * 65536.0 + 0.5);
    if (r != fxsqrt (i)) {
      printf ("error @ %08x: ref = %08x  res=%08x\n", i, r, fxsqrt (i));
      break;
    }
    i++;
  } while (i);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T05:23:41.300

使用[你最喜欢的整数平方根算法](https://stackoverflow.com/questions/1100090/looking-for-an-efficient-integer-square-root-algorithm-for-arm-thumb2)，简单的观察是 √(2 ^(-16) a) = 2 ^(-8) √a。

# php - 为什么这个无限滚动在 IE 中不起作用？

> ID：15179773
> 
> 赞同：4
> 
> 时间：2013-03-02T21:44:15.863
> 
> 标签：php, jquery, infinite-scroll

下面的代码适用于 Chrome 和 Firefox。对于 IE，它滚动浏览相同的内容。我广泛搜索了解决方案，但一无所获。

**标题**

```
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script type="text/javascript">

$(window).scroll(function()
{
   if($(window).scrollTop() == $(document).height() - $(window).height())
   {

   $('div#loadmoreajaxloader').show();
   $.ajax(
   {
      url: "http://www.hackedflashgames.com/loadmore.php",
      success: function(html)
      {
         if(html)
         {
             $("#wrapper").append(html);
             $('div#loadmoreajaxloader').hide();
         }else
         {
             $('div#loadmoreajaxloader').html('<center>No more posts to show.</center>');
         }
      }
   });
}
});
</script> 
```

**加载更多.php**

```
<?php
   include('db.php');
   $stmt = $db->prepare("SELECT * FROM games ORDER BY RAND() LIMIT 6");
   if($stmt->execute()){
      while ($row = $stmt->fetch()) {
         echo'
         content here
         ';
      }
   }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:52:57.293

IE 以其积极的缓存而闻名，尤其是使用 AJAX。

尝试将一些随机查询字符串添加到 ajax 调用的 URL（如时间戳）。

您也可以在代码中指定这一点：`$.ajaxSetup({ cache: false });`

因此，您不必手动添加查询字符串，jQuery 会处理它。

# ruby-on-rails-3 - Apache、Ruby（不是 RVM）、Passenger LoadPath - (Bundler::GemNotFound)

> ID：15179775
> 
> 赞同：2
> 
> 时间：2013-03-02T21:44:23.247
> 
> 标签：ruby-on-rails-3, apache, passenger, gitlab

我在使用 Ruby 1.9.3p327、RubyGems 1.8.23 和Passenger 3 的AWS Micro 实例上。

我的服务器（当我没有尝试修复问题时）位于[http://shaanan.cohney.info/gitlab/](http://shaanan.cohney.info/gitlab/)

我正在尝试将 Gitlab 安装到 Apache2 上。

这一切都顺利到我尝试通过乘客部署安装的地步。

我得到错误：

```
Could not find multi_json-1.5.0 in any of the sources (Bundler::GemNotFound)

/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.3.0/lib/bundler/spec_set.rb   95  in `block in materialize' 
```

我打印的加载路径是：

```
["/usr/local/lib/ruby/gems/1.9.1/gems/passenger-3.0.19/lib", "/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.3.0/lib", "/usr/local/lib/ruby/site_ruby/1.9.1", "/usr/local/lib/ruby/site_ruby/1.9.1/x86_64-linux", "/usr/local/lib/ruby/site_ruby", "/usr/local/lib/ruby/vendor_ruby/1.9.1", "/usr/local/lib/ruby/vendor_ruby/1.9.1/x86_64-linux", "/usr/local/lib/ruby/vendor_ruby", "/usr/local/lib/ruby/1.9.1", "/usr/local/lib/ruby/1.9.1/x86_64-linux"] 
```

缺少安装我的 gem 的目录。

我在网上搜索过，但在尝试了多种方法后还没有找到解决办法。

当我访问 myhostname.com/gitlab 时出现错误

我目前的猜测是，这与我为其安装 ruby​​ 的用户、应用程序的用户以及用户乘客的运行身份有关。

更新：我已经升级到乘客的测试版，看看它是否会有所作为。出错时，它给我的环境如下：

```
APACHE_PID_FILE = /var/run/apache2.pid
SHELL = /bin/bash
APACHE_RUN_USER = www-data
PASSENGER_DEBUG_DIR = /tmp/passenger.spawn-debug.27672-140235446962704
USER = gitlab
APACHE_LOG_DIR = /var/log/apache2
PATH = /usr/local/bin:/usr/bin:/bin
PWD = /home/gitlab/gitlab
APACHE_RUN_GROUP = www-data
LANG = C
SHLVL = 0
HOME = /home/gitlab
LOGNAME = gitlab
APACHE_LOCK_DIR = /var/lock/apache2
APACHE_RUN_DIR = /var/run/apache2
IN_PASSENGER = 1
PYTHONUNBUFFERED = 1
RAILS_ENV = production
RACK_ENV = production
WSGI_ENV = production
PASSENGER_ENV = production
RAILS_RELATIVE_URL_ROOT = production
RACK_BASE_URI = production
PASSENGER_BASE_URI = production
REQUEST_METHOD = GET
SERVER_PORT = 80
SERVER_ADDR = 10.244.35.233
QUERY_STRING = 
SERVER_PROTOCOL = HTTP/1.1
REMOTE_PORT = 4789
REMOTE_ADDR = 72.13.132.134
REQUEST_URI = /gitlab/
SERVER_SOFTWARE = Apache/2.2.22 (Ubuntu)
DOCUMENT_ROOT = /var/www/
SERVER_NAME = shaanan.cohney.info
GEM_PATH = 
SERVER_ADMIN = webmaster@localhost
BUNDLE_GEMFILE = /home/gitlab/gitlab/Gemfile
_ORIGINAL_GEM_PATH = /home/ubuntu/.rvm/gems/ruby-1.9.3-p392
GEM_HOME = /home/gitlab/gitlab/vendor/bundle/ruby/1.9.1 
```

我还注意到 _ORIGINAL_GEM_PATH 设置为我安装时的 RVM 值。

# php - Doctrine 2 复合键和 DQL 连接

> ID：15179776
> 
> 赞同：5
> 
> 时间：2013-03-02T21:44:26.533
> 
> 标签：php, join, doctrine-orm, dql, composite-key

我正在尝试过滤掉父项由复合主键组成的子项，父项称为主题，子项是课程：

学科：

```
class Subject
{
   /**
     * @var integer
     *
     * @Column(type="integer")
     * @Id
     * @GeneratedValue(strategy="NONE")
     */
    protected $id;

    /**
     * @var integer
     *
     * @Column(type="integer")
     * @Id
     */
    protected $customer_id;

    /**
     * @var ArrayCollection
     *
     * @OneToMany(targetEntity="Course", mappedBy="subject")
     */
    private $courses;

    ...
} 
```

课程：

```
class Course
{
    ...

    /**
     * @var Subject
     *
     * @ManyToOne(targetEntity="Subject", inversedBy="courses")
     * @JoinColumns({
     *   @JoinColumn(name="subject_id", referencedColumnName="id"),
     *   @JoinColumn(name="subject_customer_id", referencedColumnName="customer_id")
     * })
     */
    private $subject;
} 
```

我有“subject_id”和“subject_customer_id”，我的问题是我不能在没有加入主题的情况下过滤掉课程，当我写这个时：

```
$this->em->createQuery("SELECT c FROM Course c WHERE c.subject = :subject")
    ->setParameters( array('subject' => array( 'subject_id' => $subject_id, 'subject_customer_id' => $subject_customer_id ) ) )
    ->getResult(); 
```

我收到以下错误：

> Doctrine\ORM\Query\QueryException [ 0 ]：不支持到具有复合主键的实体的单值关联路径表达式。在查询中显式命名复合主键的组件。

我能得到这个工作的唯一原因是通过内部加入主题，例如：

```
$this->em->createQuery("SELECT c FROM Course c INNER JOIN c.subject s WITH s.id = :subject AND s.customer_id = :customer")
    ->setParameters( array( 'subject' => $subject_id, 'customer' => $customer_id ) )
    ->getResult(); 
```

有没有什么方法可以在不加入学科的情况下根据学科主键检索课程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T12:19:21.817

截至目前，[DQL 尚不支持](https://github.com/doctrine/doctrine2/blob/2.3.2/lib/Doctrine/ORM/Query/SqlWalker.php#L615-L618)此逻辑（另请参阅[https://github.com/doctrine/doctrine2/blob/2.3.2/lib/Doctrine/ORM/Persisters/BasicEntityPersister.php#L1641-L1643](https://github.com/doctrine/doctrine2/blob/2.3.2/lib/Doctrine/ORM/Persisters/BasicEntityPersister.php#L1641-L1643)） .

您将必须加入以下内容：

```
SELECT
    c
FROM
    Course c
INNER JOIN 
    c.subject s 
WHERE 
    s.id = :subject 
    AND 
    s.customer_id = :customer 
```

考虑通过最终添加这样的逻辑来为项目做出贡献：它可能会被合并到新的`2.4`系列中。

# symfony - Payum 捆绑包配置

> ID：15179780
> 
> 赞同：0
> 
> 时间：2013-03-02T21:44:56.007
> 
> 标签：symfony, symfony-2.1, payum

我正在努力定义在这里找到的实体映射器： [https ://github.com/Payum/PayumBundle/blob/master/Resources/doc/capture_funds_with_paypal_express_checkout.md#2-a-configure-doctrine-storage](https://github.com/Payum/PayumBundle/blob/master/Resources/doc/capture_funds_with_paypal_express_checkout.md#2-a-configure-doctrine-storage)

```
 payum:
    contexts:
        your_context_name:
            doctrine_storage:
                driver: orm
                model_class: AcmeDemoBundle\Entity\PaypalPaymentInstruction

doctrine:
    orm:
        entity_managers:
            default:
                mappings: 
                    payum_paypal_express_checkout_nvp:                          
                        is_bundle: false
                        type: xml 
                        dir: %kernel.root_dir%/../vendor/payum/paypal-express-checkout-nvp/src/Payum/Paypal/ExpressCheckout/Nvp/Bridge/Doctrine/Resources/mapping
                        prefix: Payum\Paypal\ExpressCheckout\Nvp\Bridge\Doctrine\Entity 
```

我目前的学说配置是自动加载为真。我的问题是让这个映射与我的自动加载一起工作：true

当我删除我的时，我可以让映射工作，`autoload: true`但任何提示将不胜感激，但问题是我如何从这个映射信息创建一个表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T06:35:16.553

这个配置对我很有效。它添加了一个 id 字段（它来自捆绑并被自动映射），其余字段来自手动定义的映射。

我在沙箱中添加了一个示例。它工作正常。

```
doctrine:
    dbal:
        driver:   %database_driver%
        host:     %database_host%
        port:     %database_port%
        dbname:   %database_name%
        user:     %database_user%
        password: %database_password%
        charset:  UTF8
        # if using pdo_sqlite as your database driver, add the path in parameters.yml
        # e.g. database_path: %kernel.root_dir%/data/data.db3
        # path:     %database_path%

    orm:
        auto_generate_proxy_classes: %kernel.debug%
        auto_mapping: true

        mappings:
            payum_paypal_express_checkout_nvp:                          
                is_bundle: false
                type: xml 
                dir: %kernel.root_dir%/../vendor/payum/paypal-express-checkout-nvp/src/Payum/Paypal/ExpressCheckout/Nvp/Bridge/Doctrine/Resources/mapping
                prefix: Payum\Paypal\ExpressCheckout\Nvp\Bridge\Doctrine\Entity 
```

# javascript - 如何在原生 javascript 中捕获事件

> ID：15179784
> 
> 赞同：3
> 
> 时间：2013-03-02T21:45:11.210
> 
> 标签：javascript, events

我必须检查屏幕上的元素是否可见（用户是否滚动到元素？）。我的功能是回答“是”或“否”，但我怎样才能永久检查它？我怎样才能永久执行这个功能？如何捕捉元素的可见性？

只有本机javascript。

谢谢

# c - 尝试更改链表节点中的数据

> ID：15179785
> 
> 赞同：1
> 
> 时间：2013-03-02T21:45:17.527
> 
> 标签：c, pointers, linked-list, nodes

我已将数据（从 1.0 - 9.0 的双值）添加到我的每个节点。现在我正在尝试访问每个数据以修改它，以便每个节点中的双精度值都是负数（-1.0 到 -9.0）：

```
void traverseList(struct List *list, void (*func) (void *)) {
    struct Node *current = list->head;
    while(current) {
        func(current->data);
        current = current->next;
    }
}

void changeToNegative(void *data) {
    double newData = *((double*)data) * -1.0;
    data = &newData;
} 
```

我用以下方式调用上述内容：

```
traverseList(&list, &changeToNegative);
traverseList(&list, &print); 
```

但是，它仍然只打印出正值...我正在为数据重新分配一个新的内存位置，所以我不明白它如何仍然指向旧的内存位置。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:47:22.603

如下修改您的代码。而不是将指针分配给数据分配值，如下所示

```
void changeToNegative(void *data) {
   double newData = *((double*)data) * -1.0;
   *data = newData;
} 
```

这样，您将修改数据指向的值，并且更改将是持久的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T21:49:47.887

**你的错误：**

```
void changeToNegative(void *data) {
    double newData = *((double*)data) * -1.0;
    data = &newData;
} 
```

在`changeToNegative(void *data)`您正在修改的功能中`data`。当你要修改`*data`. 请参阅参数是`void* data`按地址传递，以便反映调用函数的变化。

只需喜欢：

```
 void changeToNegative(void *data) { 
      *((double*)data) *=-1;   // nagt value pointed data pointer
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T21:51:23.767

```
void changeToNegative(void *data) {
    double* theData = (double*)data;
    *theData = (*theData) * -1.0;
} 
```

`data`您正在为函数内的本地副本分配`changeToNegative`修改数据的地址，这不会反映在调用者的函数中。而是取消引用并`data`就地修改，以便将更改反映回调用者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T21:55:28.543

```
void changeToNegative(void *data) {
    double newData = *((double*)data) * -1.0;
    data = &newData;
} 
```

该函数的最后一行将命名*指针*`data`设置为指向一个新位置，而不是最初传递给函数的位置。它不会*影响*存储在原始内存位置的数据。相反，您想取消引用指针并将其设置为新值：

```
*data = *((double*)newData); 
```

# android - 如何查找函数是否未被调用？

> ID：15179787
> 
> 赞同：0
> 
> 时间：2013-03-02T21:45:33.780
> 
> 标签：android, timer

我正在开发一个 Android 应用程序，我只想知道一个函数什么时候没有被调用。例如，假设你有这个功能

```
void foo()
{
 ...//do something here;
} 
```

如果函数没有被调用，我想做的是时间，比如说 10 秒，然后记录 10 秒之后的时间。之后，如果调用该函数并调用它，我想记录它再次开始函数的时间。我正在考虑使用 Timer 函数，但我不确定如何测试函数是否已被调用。

我正在开发一个应用程序，您可以在其中查看一个人是否开始或停止行走。例如，如果有人停止了 10 秒的步行，我想记录那个时间。当他们恢复行走时，我也想记录下那段时间。希望这更有意义。任何帮助，将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:49:37.920

一种可能的解决方案是在代码中添加一个布尔标志；也许叫它`fooWasCalled`。将此变量初始化`false`并设置为`true`inside `foo()`。然后，当您需要知道该函数是否被调用时，您可以简单地检查标志。

这是一个非常常见的习惯用法，用于检查是否发生了某些操作。

ps 由于您使用的是计时器，因此您可能需要同步访问此布尔标志或使用其他一些线程安全机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T01:19:04.527

这可能是你想要的（不是完整的代码，只是想法）

```
protected boolean mIsCountDownOn;

private class CountDownTimer mCountDownTimer = new CountDownTimer(10000, 10000)
{
    @Override
    public void onTick(long millisUntilFinished)
    {

    }

    @Override
    public void onFinish()
    {
        mIsCountDownOn = false;
    }
}; 
```

在富

```
foo
{

    if (mIsCountDownOn)
    {
         // less than 10 seconds since the last time foo is called
         mCountDownTimer.cancel();
     }
     else
     {
          // more than 10 seconds since last call
          mIsCountDownOn = true;  // will start the timer at the end of foo body

          // Code to save mTime to wherever you want to save it.
     }

     // Whatever else foo supposes to do

     mTime = // get the time now
     mCountDownTimer.start();
} 
```

# android - 从 Fragments 改变 ActionBar

> ID：15179788
> 
> 赞同：0
> 
> 时间：2013-03-02T21:45:39.093
> 
> 标签：android, android-actionbar

我需要对 Activity`ActionBar`的`Fragment`.

父 FragmentActivity`onCreateOptionMenu`并`onPrepareOptions`处理整个应用程序的菜单。

但是，在包含的主`Fragment`视图中，我希望`ActionBar`标题为了导航而改变。每一次的`Fragment`变化。

此外，在一个实例中，我想添加一个在布局中定义的菜单项。我宁愿不重复这部分的代码，我是否必须`override`使用相同的方法并再次设置整个菜单，包括`onOptionSelected`？或者...？

编辑：

在我的菜单`xml`布局上，我有这个项目：

```
 <item
        android:id="@+id/Add"
        android:title="Add Items"/> 
```

这个项目需要在`ActionBar`唯一的一个特定的地方看到`Fragment`。菜单的其余部分与应用程序其余部分应看到的相同。在我需要这个新项目的片段中，我是否还必须再次执行`onCreateOptionsMenu`, `onPrepareOptionsMenu`,`onOptionsItemSelected`并复制其他菜单项？或者我可以`override`只`Fragment`弹出一个额外的菜单项吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:49:12.157

1.

```
getActivity().getActionBar().setTitle(); 
```

或者

```
getActivity.getSupportActionBar().setTitle(); 
```

1.  请进一步澄清:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T23:45:01.720

这回答了我第 2 部分所需的内容。

把它放在 onActivityCreated 中：

```
 setHasOptionsMenu(true); 
```

然后也添加这个：

```
 @Override
    public void onPrepareOptionsMenu(Menu menu) {
        super.onPrepareOptionsMenu(menu);

        ActivityCompat.invalidateOptionsMenu(getActivity());

        MenuItem Add = menu.findItem(R.id.Add);
        Add.setVisible(true);

    } 
```

父 Activity`R.id.Add`默认设置为不可见。

# iframe - 如何使透明框中的表单（iframe）不透明？

> ID：15179790
> 
> 赞同：1
> 
> 时间：2013-03-02T21:45:48.177
> 
> 标签：iframe, transparency, transparent, css

我有一个指向表单的 iframe。该 iframe 在我已设为透明的 css 类中。表单和按钮的字段也是透明的，但我不希望它们是透明的。但是，我确实希望表单的背景保持透明。我的网站位于 avidest.com/zamchick。我该怎么办？这是我的CSS：

```
.formbox{
  float: right; 
  width: 48%;
  padding-top: 90px; 
  padding-right: 40px;
  background-color:#ffffff;
  border:1px solid black;
  opacity:0.6;
  filter:alpha(opacity=60); /* For IE8 and earlier */
 } 
```

这是带有 iframe 的 html：

```
 <div class="formbox">
    <script type="text/javascript">
     document.write(unescape("%3Ciframe id=\"fb_iframe\" src=\"testform4.php" 
     + window.location.search + "\" width=\"548\" height=\"787\"allowtransparency=\"true\" scrolling=\"no\" frameborder=\"0\"%3E&lt;a href=\"formio.php\" title=\"formio\"&gt;formio&lt;/a&gt;%3C/iframe%3E"));</script>
    <noscript>
     <iframe width="548" height="787" 
       style="border:none; background:transparent;overflow:hidden;"
     id="fb_iframe" src="testform4/testform4.html">
    &lt;a href="testform4.php" title="testform4"&gt;formio&lt;/a&gt;
    </iframe>
    </noscript>
  </div> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:07:44.373

您可以使用 RGBA 值对其应用透明背景，而不是使整个元素透明：

`opacity:0.6;`从类中删除`.formbox`并添加

`background-color: rgba(255,255,255,0.6);`

前 3 个参数代表 Red、Green 和 Blue 值，而最后一个接受 Alpha 值，范围从 0 到 1。这适用于[所有支持 CSS3 的现代](http://caniuse.com/css3-colors)浏览器。不过，您可能希望为旧版浏览器提供回退：

```
 background: rgb(255, 255, 255); /* The Fallback */
   background: rgba(255, 255, 255, 0.6); 
```

如果您想支持*真正旧的*浏览器，我建议您查看令人惊叹的 Lea Verou 撰写的[这篇文章](http://lea.verou.me/2009/02/bulletproof-cross-browser-rgba-backgrounds/)，该文章建议使用半透明的 png 图像和 PHP 脚本来自动化它。

# clickonce - ClickOnce 在启动时给出奇怪的错误

> ID：15179795
> 
> 赞同：0
> 
> 时间：2013-03-02T21:46:23.427
> 
> 标签：clickonce

我部署了一个小型 ClickOnce 应用程序。我注意到，在我的机器上，我收到了奇怪的启动错误，例如“Windows 无法访问指定的设备、路径或文件。您可能没有访问此项目的适当权限。” 尝试以管理员身份运行它，它甚至没有开始加载。手动访问exe，一切正常。有没有办法解决这个问题？谢谢。

编辑：尝试重新安装，同样的错误。

EDIT2：得到一个错误xml：

```
<?xml version="1.0" encoding="utf-16"?>
<Answers Version="1.0">
    <Interaction ID="IT_LaunchMethod">
        <Value>ContextMenu</Value>
    </Interaction>
    <Interaction ID="IT_SelectProgram">
        <Value>NotListed</Value>
    </Interaction>
    <Interaction ID="IT_BrowseForFile">
        <Value>C:\Users\MyUserPath\AppData\Local\Apps\2.0\RN7Y3C3O.4KQ\P64V6E15.NWW\somelongfoldername\MyFile.exe</Value>
    </Interaction>
</Answers> 
```

知道这意味着什么吗？

EDIT3：就在有人说路径错误之前：我没有修改任何东西，我试图让 ClickOnce 完成它的工作。如果路径错误，那是 ClickOnce 的错，因为我所做的只是安装它，然后尝试打开它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T10:01:36.290

好的，这只是我的防病毒软件正在完善。糟糕的启发式使它阻止了它，但是，它并没有告诉我。我只是发现，因为当我更改了我的防病毒软件时，我让它工作了。很奇怪...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T06:58:46.730

你能解释一下你在哪里看到上面的 XML 吗？我以前从未见过这样的事情。那么你什么时候看到错误？当用户安装它时，它是第一次工作，还是只是在以后不工作？

你的安装地址是什么？它是发布到 Web 服务器，还是发布到文件共享并且用户无权访问它？或者您是否正在做一些完全不同的事情，例如将部署复制到用户的机器并以这种方式安装？

# android - 如何做 findViewById (R.id.>> StringVarHere << )？

> ID：15179797
> 
> 赞同：6
> 
> 时间：2013-03-02T21:46:51.163
> 
> 标签：android, findviewbyid

搜索并为此工作了很长时间-没有运气。（一定很简单吧？谢谢你的帮助。）

尝试获取/设置一个充满 EditTexts 文本的屏幕，但不是使用通常的、更硬编码的方式：

```
... findViewById (R.id.SomeTextWidgetId) ; 
```

相反，我试图通过保存（字符串）name_of_widget 的变量找出可重用的方法。

在伪代码中：

**findViewById (R.id.>> StringVarHere << ); // 怎么做 ？**

我也试过这个[findViewById](https://stackoverflow.com/questions/6679434/android-findviewbyid-with-a-variant-string)方法，但它没有用（！？）

```
//// given:

static final String FIELD_TV_FEE   = "TextViewFee" ;
static final String FIELD_TV_FOO   = "TextViewFoo" ;
static final String FIELD_TV_FUM   = "TextViewFum" ;
//// and some arbitrary number more of similar fields  

static final String [] ALL_FIELDS = {

    FIELD_TV_FEE ,
    FIELD_TV_FOO ,  
    FIELD_TV_FUM   // ...
 } ; 

//// ...

    //// this part works
    int ResourceID;
    String stringVarHere = FIELD_TV_FEE; 

    //// outputs a correct id, say '0x7f05000f' as in R.id.xxx below
    ResourceID = context
                       .getResources()
                       .getIdentifier ( stringVarHere,
                                        "id", 
                                        context 
                                          .getApplicationInfo()
                                          .packageName
                                      ) ;
    Log.d ("MyClass" , "RESID = " + Integer.toHexString(ResourceID) ) ;  
/*
 * that's where I'm stuck ^^^ ... how do I do:
 */

String field_name ;

for ( field_name : ALL_FIELDS ) {
    (EditText) SomethingLike_a_findViewById(field_name).setText ("Hello Wurld") ;
} 
```

我试过 .setId ...

```
//// details

    <!-- excerpt from working xml layout -->
    <EditText
        android:id="@+id/TextViewFee"
        android:inputType="text"
        android:layout ... etc ...         
        />
    <EditText
        android:id="@+id/TextViewFoo"
        android:inputType="text"
        android:layout ... etc ...         
        />
    <EditText
        android:id="@+id/TextViewFum"
        android:inputType="text"
        android:layout ... etc ...         
        /> 
```

正如预期的那样，生成的 R 文件具有以下内容：

```
// ...
public static final class id {
    public static final int TextViewFee=0x7f05000f;
    public static final int TextViewFum=0x7f05001c;
    public static final int TextViewFoo=0x7f05001d;
    // ... etc 
```

* * *

是的，谢谢 - 在活动中这样做是有意义的。我试图防止它变得过于庞大的代码。根据您和 AC 的有用建议，这就是我现在正在做的事情。目的是将表单字段的所有文本返回到一个 String[] 中。（我知道我也可以暴力破解所有领域。）

大家对此有何看法 - 似乎与您的建议非常相似，疯狂？我想知道这是否是一种糟糕的设计方法？

```
public class FoodBar {

private Activity activity; 
private Context ctx;

public  FoodBar ( Activity _activity ) {        
    this.activity = _activity;
    this.ctx = this.activity.getApplicationContext() ;
}

public String[] getTextFromAllEditTexts () { // the UI views

    int res_id = 0;
    int i = 0;   

    String [] retValues = new String [MyClassName.ALL_FIELDS_LENGTH] ;

    for (String field : MyClassName.ALL_FIELDS_ALL_VEHICLES) {

       res_id = this.ctx.getResources()
                        .getIdentifier ( field, "id", this.ctx.getPackageName() );

           ((EditText) this.activity
                           .findViewById (res_id))
                           .setText( "Meat and Potatoes" ) ;

               // redundant - get it right back to make sure it really went in !  
        retVal[i++] = ((EditText) this.activity
                                        .findViewById (res_id))
                                        .getText().toString() ;
    }

     return retVal;

} // end func
} // end class 
```

然后从 Activity 类，它只是：

```
String [] theFields = null;
FoodBar = new FoodBar (this);

try {

     theFields = FoodBar.getTextFromAllEditTexts ();

} catch (Exception e) {
     Log.d ("OOPS", "There's a big mess in the Foodbar: " + e.toString() );
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T23:57:59.460

你可以这样做的方式是（据我了解你正在尝试的方式）：

这可以在非 Activity (YourClassname.java) 中：

```
public static int getMyId(Context context, String field) {
     return context.getResources().getIdentifier (field, "id", context.getPackageName());
} 
```

在活动类中：

```
for ( String field_name : YourClassname.ALL_FIELDS ) {
    int resid = YourClassname.getMyId(context, field_name);
    if(resid != 0) { // 0 = not found 
       EditText et = (EditText) findViewById(resid);
       if (et != null) {
          et .setText ("Hello Wurld") ;
       }
    }
} 
```

* * *

但我认为最好在活动类中编写代码，例如：

```
String packageName = getPackageName();
Resources res = getResources();
for ( String field_name : YourClassname.ALL_FIELDS ) {
    int resid = res.getIdentifier (field_name, "id", packageName);
    if(resid != 0) {// 0 = not found 
       EditText et = (EditText) findViewById(resid);
       if (et != null) {
          et .setText ("Hello Wurld") ;
       }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T23:05:57.533

AC 提出了以下建议：

```
res_id = getResources().getIdentifier (field, "id", getPackageName());
((EditText)findViewById (res_id)).setText("NoLongerFubar"); 
```

这确实有效 - 当我在测试台上独立尝试时。谢谢 ！仍然不确定发生了什么，但我怀疑是无法访问上下文或资源项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-03T00:45:48.037

请注意，变量名称（例如`R.id.some_id`）仅在编译时可用，在运行时无法从 String 值访问。由于这些 id 被声明为`int`s，您可以考虑使用`int[]`or`List<Integer>`来存储 id。根据您的布局的动态程度以及您对其中的视图所做的操作，您甚至可能只想在运行时创建视图并存储它们的数组或列表，而根本不使用任何 id。

# symfony - 未知标签名称“form_rest”

> ID：15179804
> 
> 赞同：2
> 
> 时间：2013-03-02T21:47:23.990
> 
> 标签：symfony, doctrine-orm, twig

我无法使用 Twig 和 Sf2 制作表格。

```
Unknown tag name "form_rest" in MyBundle:Default:home.html.twig at line 40 
```

在视图中显示：

```
{% form_rest(form) %} 
```

我可以尝试任何`form*`方法。结果相同。控制器有这样的东西：

```
public function userEmailAddressFormAction()
{
  $userEmailAddress = new UserEmailAddress();
  $form = $this->createForm(new UserEmailAddressType(), $userEmailAddress);

  return $this->render('MyBundle:Default:userEmailAddress.html.twig', array('form' => $form->createView()));
} 
```

为什么 Twig 不加载帮助程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T21:56:02.920

这不是标签；这是一个功能。因此，使用`{{`and`}}`代替`{%`and `%}`：

```
{{ form_rest(form) }} 
```

# php - PHP - 在特殊字符前渲染 - 编码问题？

> ID：15179812
> 
> 赞同：0
> 
> 时间：2013-03-02T21:47:44.523
> 
> 标签：php

[从我之前的问题](https://stackoverflow.com/questions/15147874/rendering-in-front-of-special-characters)分支。

在我的 CMS (CQ5) 中，我正在获取使用 ASCII 编码输入的值。有时输入的这些字符串中的一些包含特殊字符（即版权） ，当我在 PHP 中输​​出它时，会在其前面插入`®`一个奇怪的字符 。`Â`

我研究过将其编码为 UTF-8，但这不起作用。我尝试了以下方法：

```
//$title is the CMS input that contains special characters
$strA = iconv('ASCII', 'UTF-8//IGNORE', $title);
$strB = mb_convert_encoding($title, "UTF-8");
$strC = utf8_encode($title); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:49:55.653

如果您的字符串包含版权符号，那么*它们不是 ASCII！*

它们要么已经是 UTF-8，要么是 ISO-8859-1 之类的东西。可以通过查看字符串的实际字节编码来找出哪个。

您还必须确保您的 CMS 生成正确的 HTML 字符集标记，以便用户浏览器知道正在使用哪个字符集，即

```
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
...
</head> 
```

该`Â`字符是由发送 UTF-8 但没有告诉接收者您已经这样做而引起的常见伪像。

# css - CSS中的页脚透明度

> ID：15179814
> 
> 赞同：3
> 
> 时间：2013-03-02T21:47:54.977
> 
> 标签：css, footer

我正在尝试使我的页脚透明，我已经成功地做到了，但为什么我在页脚中的内容也会更改为相同的透明度？

CSS -

```
**.footer {
background: #000000;
opacity:0.6;
filter:Alpha(opacity=60); /* IE8 and earlier */
margin-top: 2em;
float: left;
width: 800px;
height: 175px;
clear:both
margin-left: auto;
margin-right: auto;
line-height: 1.0em;}** 
```

然后我的内容在顶部的单独类中。如何使该内容位于顶部并且仅对页脚背景/页脚包装进行着色？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T21:52:17.727

您最好的选择是使用透明背景，例如

```
.footer {
  opacity: 1; // Leave this as 1
  background-color: rgba(0,0,0,0.6); // This is in the form rgba(R,G,B,a) where a is your opacity
  // The rest of your CSS
} 
```

此外，为了保持对 IE 的支持，您必须在`<head>`标签中添加类似的内容

```
<!--[if IE]>

 <style type="text/css">
   .footer { 
     background:transparent;
     filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#3C000000,endColorstr=#3C000000); 
     zoom: 1;
   } 
 </style>

<![endif]--> 
```

其中`#3C000000`是 aRGB 的形式，不透明度为十六进制（即`3C`60%）。有关详细信息，请参阅[csstricks](http://css-tricks.com/rgba-browser-support/)。

弗雷德。

# mysql - MySQL如何从同一列中选择多个值，以便它们出现在不同的列中？

> ID：15179816
> 
> 赞同：1
> 
> 时间：2013-03-02T21:48:08.173
> 
> 标签：mysql, sql, pivot

我有两张桌子：

```
wp_posts

ID  post_title                      post_date
20  Título de tuit de ejemplo       2012-12-03 20:24:58
23  Título de teletipo de ejemplo   2012-12-04 13:56:33
25  Título de Clipping de ejemplo   2012-12-04 14:16:14
28  Título 4 diciembre 2012         2012-12-04 14:48:05
32  Título de noticia Actualidad    2012-12-04 17:35:57
78  Título de Destacado de ejemplo  2012-12-05 23:19:38
110 Título de Clipping radio        2012-12-09 15:57:28
112 Título de Clipping televisión   2012-12-09 15:59:31 
```

和`wp_postmeta`

```
meta_id  post_id  meta_key            meta_value
61       20       wpcf-custom-author  John Doe
134      28       wpcf-custom-author  John Smith
85       23       wpcf-custom-author     
111      25       wpcf-custom-author     
176      32       wpcf-custom-author  John Smith
614      110      wpcf-custom-author     
524      78       wpcf-custom-author     
627      112      wpcf-custom-author     
538      80       wpcf-custom-author     
48       20       wpcf-source    
132      28       wpcf-source         El País
83       23       wpcf-source         El País
109      25       wpcf-source         El País
174      32       wpcf-source         El País
612      110      wpcf-source         El Mundo 
```

没错，这些是 wordpress 表，但我的问题是关于 mysql，我需要一个查询来从 wp_postmeta 检索属于同一 wp_posts.ID 的几个字段，以便我可以在同一行上获取所有信息。到目前为止，我想出了：

```
SELECT DISTINCT posts.post_title AS title,
posts.post_date AS publish_date, 
(SELECT subpostmeta.meta_value FROM wp_postmeta AS subpostmeta WHERE subpostmeta.post_id = postmeta.post_id AND subpostmeta.meta_key =  'wpcf-lead-in') AS lead_in,
(SELECT subpostmeta.meta_value FROM wp_postmeta AS subpostmeta WHERE subpostmeta.post_id = postmeta.post_id AND subpostmeta.meta_key =  'wpcf-custom-body') AS custom_body,
(SELECT subpostmeta.meta_value FROM wp_postmeta AS subpostmeta WHERE subpostmeta.post_id = postmeta.post_id AND subpostmeta.meta_key =  'wpcf-custom-author') AS custom_author,
(SELECT subpostmeta.meta_value FROM wp_postmeta AS subpostmeta WHERE subpostmeta.post_id = postmeta.post_id AND subpostmeta.meta_key =  'wpcf-source') AS source
FROM wp_posts AS posts, wp_postmeta AS postmeta
WHERE posts.ID = postmeta.post_id
AND posts.post_status = 'publish'
AND posts.post_type = 'contenido'
AND posts.post_date < NOW()
ORDER BY posts.post_date DESC 
```

据我所知，这工作正常，因为我得到：

```
post_title                          post_date               lead_in                                                 custom_body                                             custom_author   source
Título de noticia de ejemplo        2013-02-04 15:10:25     En un lugar de la Mancha, de cuyo nombre no quiero...   En un lugar de la Mancha, de cuyo nombre no quiero...   Juan García     ABC
Título de Clipping televisión       2012-12-09 15:59:31                                                             Clipping TV: Your bones don't break, mine do. That...                   La Vanguardia
Título de Clipping radio            2012-12-09 15:57:28                                                             Clipping radio: Now that we know who you are, I kn...                   El Mundo
Título de Destacado de ejemplo      2012-12-05 23:19:38                                                             Really?! We'll go deliver this crate like professi... 
```

但是我不确定这是否是获得我想要的东西的最佳方法，我已经阅读过 LEFT JOIN 并在过去使用过它，但不确定我是否可以在这里使用它或者有什么优势。

欢迎任何反馈！

编辑：我终于使用了 LEFT JOIN 所以我不知道如何投票或关闭这个话题。它比我第一次在这里写的要复杂一些，无论如何这是我的最终查询：

```
 SELECT DISTINCT posts.*,
        posts.post_date                  AS publish_date,
        tbl_lead_in.meta_value           AS lead_in,
        tbl_custom_author.meta_value     AS custom_author,
        tbl_source.meta_value            AS source,
        tbl_category_terms.slug          AS category_term_slug,
        tbl_category_terms.term_id   AS category_term_id
    FROM $wpdb->posts AS posts
        LEFT JOIN $wpdb->postmeta AS tbl_lead_in
               ON ( posts.ID = tbl_lead_in.post_id
                    AND tbl_lead_in.meta_key = 'wpcf-lead-in' )
        LEFT JOIN $wpdb->postmeta AS tbl_custom_body ON
                  ( posts.ID = tbl_custom_body.post_id
                    AND tbl_custom_body.meta_key = 'wpcf-custom-body' )
        LEFT JOIN $wpdb->postmeta AS tbl_custom_author
               ON ( posts.ID = tbl_custom_author.post_id
                    AND tbl_custom_author.meta_key = 'wpcf-custom-author' )
        LEFT JOIN $wpdb->postmeta AS tbl_source
               ON ( posts.ID = tbl_source.post_id
                    AND tbl_source.meta_key = 'wpcf-source' )
        LEFT JOIN $wpdb->term_relationships AS tbl_category_rel
               ON (posts.ID = tbl_category_rel.object_id)
        RIGHT JOIN $wpdb->term_taxonomy AS tbl_category
               ON (tbl_category_rel.term_taxonomy_id = tbl_category.term_taxonomy_id
                    AND tbl_category.taxonomy = 'category')
        LEFT JOIN $wpdb->terms AS tbl_category_terms
               ON ( tbl_category_terms.term_id = tbl_category.term_id )
    WHERE posts.post_status = 'publish' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:05:55.650

您正在尝试*透视*将数据从行转换为列的数据。MySQL 没有数据透视函数，但您可以重写查询以使用聚合函数，并`CASE`为您返回的每个列使用一个表达式：

```
SELECT p.post_title,
  max(case when pm.meta_key = 'wpcf-lead-in' then pm.meta_value end) as lead_in,
  max(case when pm.meta_key = 'wpcf-custom-body' then pm.meta_value end) as custom_body,
  max(case when pm.meta_key = 'wpcf-custom-author' then pm.meta_value end) as custom_author,
  max(case when pm.meta_key = 'wpcf-source' then pm.meta_value end) as source
FROM wp_posts p
LEFT JOIN wp_postmeta pm
  ON p.id = pm.post_id
WHERE p.post_status = 'publish'
  AND p.post_type = 'contenido'
  AND p.post_date < NOW()
GROUP BY p.post_title
ORDER BY p.post_date DESC 
```

# json - 使用 Jackson 和 Spring 修改 @ManyToOne 关联的 JSON 响应

> ID：15179817
> 
> 赞同：0
> 
> 时间：2013-03-02T21:48:12.413
> 
> 标签：json, spring, jackson

我有两节课：

```
public class Team {
    private Long id;
    private String name;
        ...
}
public class Event {
    private Long id;

    @ManyToOne
    private Team homeTeam;

    @ManyToOne
    private Team guestTeam;
...
} 
```

控制器：

```
public @ResponseBody List<Event> getAll() {...
} 
```

现在我有Json：

```
[{"id":1,"homeTeam":{"id":2,"name":"Golden State"},"guestTeam":{"id":1,"name":"Philadelphia"},... 
```

我想要的是：

```
[{"id":1,"homeTeam":"Golden State","guestTeam":"Philadelphia",... 
```

我怎样才能让杰克逊只输出团队的名称而不是完整的对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T05:48:37.157

Benoit 的答案不会生成所需形式的 JSON，它会产生如下内容：

```
[{"id":1,"homeTeam":{"name":"Golden State"},"guestTeam":{"name":"Philadelphia"},... 
```

相反，你想要做的是让你的`Team`类看起来像这样：

```
public class Team {
    private Long id;
    private String name;

    public Long getId() {
        return id;
    }

    @JsonValue
    public String getName() {
        return name;
    }

    ...
} 
```

这将产生所需的 JSON：

```
[{"id":1,"homeTeam":"Golden State","guestTeam":"Philadelphia",... 
```

但可能需要额外的反序列化处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T00:05:22.917

排除`Team`对象的所有属性，除了`name`using ：@JsonIgnoreProperties

```
@JsonIgnoreProperties
public String getPropertyToExclude() {
    return propertyToExclude;
} 
```

这样杰克逊将只序列化 JSON 中的团队名称。

# image - 可运行 jar 中的图像不起作用 - 抛出 NullPointer

> ID：15179820
> 
> 赞同：1
> 
> 时间：2013-03-02T21:48:27.740
> 
> 标签：image, jar, executable

我在整个网站上都看到了这个问题。我已经阅读了几乎所有的回复。我觉得我正在做需要做的事情，但我就是无法让它发挥作用！我正在尝试将一些图像打包到一个 Runnable Jar 中，以便我的程序是独立的。当我在 Eclipse 中运行代码时，它按预期工作。但是当我使用可执行 Jar 时，程序不会启动。它在我创建图像的行上给了我一个 NullPointerException。这些文件位于项目源文件夹中名为 Resources 的文件夹中。这是代码。它是不完整的，因为这只是我一直试图开始工作的一个测试程序。

```
import java.awt.Graphics;
import java.awt.GridLayout;
import java.awt.Image;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.util.ArrayList;

import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;

public class testgui extends JFrame{
private static JLabel label = new JLabel();
private static testgui gui = new testgui();
private static ArrayList<ImageIcon> sprites;

public static void main(String[] args) {

    // TODO Auto-generated method stub
    sprites = getImages();
    BufferedImage backgroundImage;
    try {
        backgroundImage = ImageIO.read(new testgui().getClass().getClassLoader().getResource("resources/runescapemap.png"));
        gui.setContentPane(gui.new ImagePanel(backgroundImage));
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    gui.setLayout(new GridLayout(1,2));
    label.setIcon(sprites.get(0));
    gui.add(label);
    gui.setSize(1000,900);
    gui.setVisible(true);
}

private static ArrayList<ImageIcon> getImages(){
    ImageIcon autoTalkerLogo = new ImageIcon(new testgui().getClass().getClassLoader().getResource("Resources/autotalker-logo.png"));
    ImageIcon meterNormal = new ImageIcon(new testgui().getClass().getClassLoader().getResource("Resources/meter.png"));
    ImageIcon meterSafe = new ImageIcon(new testgui().getClass().getClassLoader().getResource("Resources/meter-safe.png"));
    ImageIcon meterNotSafe = new ImageIcon(new         testgui().getClass().getClassLoader().getResource("Resources/meter-notsafe.png"));
    ArrayList<ImageIcon> sprites = new ArrayList<ImageIcon>();
    sprites.add(autoTalkerLogo);
    sprites.add(meterNormal);
    sprites.add(meterSafe);
    sprites.add(meterNotSafe);
    return sprites;
}

class ImagePanel extends JComponent {
    private Image backgroundImage;
    public ImagePanel(Image image) {
        this.backgroundImage = image;
    }
    @Override
    protected void paintComponent(Graphics g) {
        g.drawImage(backgroundImage, 0, 0, null);
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:52:15.813

如果该文件夹真正被称为`Resources`而不是`resources`，那可能是问题所在。虽然 Windows 文件系统不区分大小写，但 jar 文件不区分大小写。

尝试

```
...getResource("Resources/runescapemap.png") 
```

我注意到您以后调用`getResource` *do* use`Resources`而不是`resources`.

当然，也可能反过来——也许你的文件夹实际上是`resources`，这是第一次调用没问题，其他四个应该使用`resources`. 无论哪种方式，*两者*都不太可能是正确的...

# arrays - 如何在 Matlab 中查找分配给某个值的变量？

> ID：15179822
> 
> 赞同：2
> 
> 时间：2013-03-02T21:48:35.003
> 
> 标签：arrays, matlab

如果我有一个数组：

```
A1=100 ; 
A2=200 ; 
A3=300 ; 
A4=500 ;  
A=[A1 A2 A3 A4]; 
```

`A(2)`将给出一个值`200.`

但我怎样才能知道`A(2)=A2`呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T23:39:46.437

```
[row,col]=find(A==200);

Answer:
row=2 -> Corresponds to A2 
```

这是你想要的吗？

# ruby-on-rails - 按父属性的rails范围顺序

> ID：15179825
> 
> 赞同：2
> 
> 时间：2013-03-02T21:48:58.137
> 
> 标签：ruby-on-rails, scope

假设我有一个属于 Foo 的类 :bar。

Bar 有一个属性名称。我想创建一个按 bar.name 订购 Foos 的范围。我如何使用范围来做到这一点？

像，范围：按名称，订单（''）？

我对 Rails 很陌生，所以如果这个问题没有意义，我很抱歉。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-03T00:28:24.800

试试这个...

```
scope :by_bar_name, order('bars.name').includes(:bar) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-29T20:23:51.667

或更少的内存密集型：

`scope :by_bar_name, joins(:bar).order('bars.name')`

# python - Python中最有效的对值数据结构，支持重复和排序？

> ID：15179827
> 
> 赞同：3
> 
> 时间：2013-03-02T21:49:32.943
> 
> 标签：python, data-structures

Python 中支持重复和排序的最有效的对值数据结构是什么？

我需要一个类似结构的字典，但它必须支持重复，我正在寻找一种可以根据每对的第一个值快速排序的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:04:00.617

[使用bisect](http://docs.python.org/2/library/bisect.html)模块保留一个排序列表。使用一个列表`data`，对于每个新对`(a,b)`，`data.insert`在返回的索引`bisect(data,(a,LARGE_NUMBER))`处添加一个新条目，以在所有以 开头的现有条目之后添加一个新条目`a`。该列表始​​终按排序顺序维护，因此您不必担心“排序速度”。

```
>>> from bisect import bisect
>>> from random import randint
>>> data = []
>>> for x in range(20):
...   a,b = randint(1,10),randint(1,100)
...   data.insert(bisect(data,(a,1000)),(a,b))
...
>>> for d in data: print (d)
...
(1, 67)
(1, 85)
(1, 38)
(2, 78)
(3, 57)
(3, 37)
(4, 76)
(4, 74)
(5, 47)
(5, 24)
(5, 59)
(5, 91)
(6, 85)
(6, 41)
(7, 18)
(7, 41)
(7, 24)
(9, 48)
(9, 77)
(9, 82)
(10, 80) 
```

# html - 有哪些方法可以在 CSS 中使用不同的背景颜色？

> ID：15179834
> 
> 赞同：0
> 
> 时间：2013-03-02T21:50:22.867
> 
> 标签：html, css, media-queries

假设我有 5 个网页，并且在每个网页上我希望背景颜色不同。我只使用 1 个 css 文件。每个网页的访问方式如下：domain.com/page1

我是简单地使用 5 个不同的 CSS 文件并更改正文中的背景颜色，还是有更简单的方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:52:53.877

在每个站点上添加不同`class`的`<body>`内容，然后使用该类来获得正确的背景颜色。

当然，您不必增加代码，这对所有站点都是通用的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:00:41.610

像这样在每个页面的 body 标签中添加一个简单的内联样式怎么样？

第01页

```
 <body style="background-color:#111;"> 
```

第02页

```
 <body style="background-color:#222;"> 
```

第 03 页

```
 <body style="background-color:#333;"> 
```

请记住，在设计方面，这种提议的配色方案变化通常是一个坏主意。你的想法背后可能有一些有意义的功能，但否则我会推荐极简主义，并在整个设计过程中保持一致性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T21:54:07.573

例如：

在“第 1 页”上：

```
<body id="page1"> 
```

在“第 2 页”上：

```
<body id="page2"> 
```

你的 CSS：

```
body#page1 {
    background: red;
}

body#page2 {
    background: blue;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-02T21:54:18.347

好吧，如果所有页面都使用相同的 css 文件，那么所有页面都将使用相同的背景...

一种简单的方法是否决正文中现有的背景颜色。所以如果你有一个包含以下内容的css文件：

```
body
{
   background-color: aqua;
} 
```

然后在它下面（在实现 css 文件之后）并且在页面上你需要一个新的颜色，你可以用以下命令否决它：

```
<style type="test/css">
body
{
    background-color: blue;
}
</style> 
```

# python - 如何配置python+uwsgi+nginx？

> ID：15179836
> 
> 赞同：3
> 
> 时间：2013-03-02T21:50:32.470
> 
> 标签：python, nginx, uwsgi

我正在尝试使用 uwsgi+nginx 运行 python 脚本。它在浏览器中导致此错误：

```
uWSGI Error
Python application not found 
```

`var/log/uwsgi/app/pyec.loc.log`字符串中有：

```
Sun Mar  3 01:34:36 2013 - added /home/lunochkinma/py_projects/pyec/ to pythonpath.
Sun Mar  3 01:34:36 2013 - mounting hello on /home/lunochkinma/py_projects/pyec/
Sun Mar  3 01:34:36 2013 - *** no app loaded. going in full dynamic mode ***
Sun Mar  3 01:34:36 2013 - *** uWSGI is running in multiple interpreter mode *** 
```

我的 uwsgi 应用程序配置：

```
<uwsgi>
        <plugin>python</plugin>
        <socket>/run/uwsgi/app/pyec.loc/pyec.loc.socket</socket>
        <pythonpath>/home/lunochkinma/py_projects/pyec</pythonpath>
        <app mountpoint="/">
                <script>hello</script>
        </app>
        <master/>
        <processes>4</processes>
        <harakiri>60</harakiri>
        <reload-mercy>8</reload-mercy>
        <cpu-affinity>1</cpu-affinity>
        <stats>/tmp/stats.socket</stats>
        <max-requests>2000</max-requests>
        <limit-as>512</limit-as>
        <reload-on-as>256</reload-on-as>
        <reload-on-rss>192</reload-on-rss>
        <no-orphans/>
        <vacuum/>
</uwsgi> 
```

Python wsgi 文件：

```
# /home/lunochkinma/py_projects/pyec/hello.py

def application(environ, start_response):
    start_response('200 OK', [('Content-Type', 'text/plain')])
    return b'Hello World!' 
```

Nginx 配置：

```
server {
        listen 80;
        server_name paec.loc;
        access_log /var/log/nginx/pyec.loc.access.log;
        error_log /var/log/nginx/pyec.loc.error.log;
        location / {
                uwsgi_pass unix:///run/uwsgi/app/pyec.loc/pyec.loc.socket;
                include uwsgi_params;
                uwsgi_param UWSGI_SCHEME $scheme;
                uwsgi_param SERVER_SOFTWARE nginx/$nginx_version;
        }
        location /static {
                root /home/lunochkinma/py_projects/pyec/static/;
                index index.html index.htm;
        }
} 
```

软：ubuntu 12.04、nginx 1.2.1、uwsgi 1.4.8、python 3.2.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-07T22:09:11.530

（在问题编辑中回答。转换为社区 wiki 答案。请参阅[将问题的答案添加到问题本身时的适当操作是什么？](https://meta.stackoverflow.com/questions/267434/what-is-the-appropriate-action-when-the-answer-to-a-question-is-added-to-the-que)）

OP写道：

> 通过添加到 uwsgi 应用程序配置参数“模块”来解决问题：
> 
> ```
> <uwsgi>
>         <plugin>python</plugin>
>         <socket>/run/uwsgi/app/pyec.loc/pyec.loc.socket</socket>
>         <pythonpath>/home/lunochkinma/py_projects/pyec</pythonpath>
>         <app mountpoint="/">
>                 <script>hello</script>
>         </app>
>         <module>hello</module>
>         <master/>
>         <processes>4</processes>
>         <harakiri>60</harakiri>
>         <reload-mercy>8</reload-mercy>
>         <cpu-affinity>1</cpu-affinity>
>         <stats>/tmp/stats.socket</stats>
>         <max-requests>2000</max-requests>
>         <limit-as>512</limit-as>
>         <reload-on-as>256</reload-on-as>
>         <reload-on-rss>192</reload-on-rss>
>         <no-orphans/>
>         <vacuum/>
> </uwsgi> 
> ```

# ruby-on-rails - 限制返回的 JSON 行数

> ID：15179841
> 
> 赞同：0
> 
> 时间：2013-03-02T21:51:08.137
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.2

假设在控制器中我们有这样的东西：

```
@org = Org.includes(programs: :patient_counts]).find(params[:id])
respond_with(@org) 
```

现在我将它传递给 JBuilder：

```
json.program @org.programs do |program|
  json.(program, :name)
  # more code to also return some info from patien_counts table too
end 
```

因此，如果我有 200 个程序并且在 1-1 关系中我也有 200 个患者计数，那么返回的 JSON 将有 200 个对象。但就我而言，我只想要一定数量的。例如，我假设 patient_counts 表有两个名为 Salary 和 Bonus 的字段，我想在 JSON 中返回 15 个对象，而不是所有这 200 个对象......其中只有 15 个具有最高 Salary+Bonus。

对于这种情况下的逻辑和计算，我该怎么办？

**编辑：关于模型的信息：**

```
program.rb :
name:string
has_many: patient_conuts

patient_count.rb:
belongs_to: program
program_id  # from the program above
total_amount: integer 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:19:29.013

为什么你不能让模型根据你所拥有的条件将数据集返回给你，这样你就不必处理 JSON 进行过滤

更新：

```
class Program < ActiveRecord::Base
  has_many :patient_counts
 scope :salary_and_bonus, ->(salary,bonus) {where("salary >= :salary AND bonus >= :bonus ', {salary: salary, bonus: bonus}).limit(15)} 
end
end 
```

例如

```
Program.includes(:patient_counts).salary_and_bonus(15,20) #15 and 20 are my assumed limits 
```

# c++ - 如何正确关机？

> ID：15179844
> 
> 赞同：0
> 
> 时间：2013-03-02T21:51:41.663
> 
> 标签：c++, shared-ptr

这可能是 C++ 编码标准中解释的关闭规则的一种情况，我想知道我是否正确执行。我想知道，因为我在切换功能中仍然有 if 子句。

类`A`永远不会被直接实例化，它总是要么`B`动态`C`创建，要么通过指向`A`. `foo`根据是 an`B`还是来切换和选择操作`C`。

```
class A {
public:
  virtual ~A(){}
};

class B : public A {};
class C : public A {};

typedef std::shared_ptr<A> Aptr;
typedef std::shared_ptr<B> Bptr;
typedef std::shared_ptr<C> Cptr;

template<class T>
std::shared_ptr<T> get(const Aptr& pA) {
  return std::dynamic_pointer_cast< T >( pA );
}

void foo( const Bptr& pB ) {
  std::cout << "operate on B\n";
}

void foo( const Cptr& pC ) {
  std::cout << "operate on C\n";
}

void foo( const Aptr& pA ) {
  if ( auto x = get<B>(pA) ) {
    foo(x);
    return;
  }
  if ( auto x = get<C>(pA) ) {
    foo(x);
    return;
  }
  assert(!"oops");
}

int main()
{
  Aptr pA( new C );

  foo( pA );
} 
```

我的问题是是否`void foo( const Aptr& pA )`可以更优雅地实现。这可能意味着没有`if`. 在这种情况下是否推荐投入`get`和追赶`foo`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:54:58.370

除非你有充分的理由不这样做（如果你有它们，你的代码不会显示它们），在我看来，这就像通过虚函数实现的动态多态性的典型用例：

```
class A 
{
public:
    virtual ~A() {}
    virtual void foo() = 0;
};

class B : public A 
{
    virtual void foo() 
    {
        std::cout << "operate on B\n";
    }
};

class C : public A 
{
    virtual void foo() 
    {
        std::cout << "operate on B\n";
    }
}; 
```

此外，在 C++11 中，最好使用裸分配`std::make_shared<>()`的 a 构造（同样，除非您有充分的理由不这样做）：`shared_ptr``new`

```
int main()
{
    Aptr pA = std::make_shared<C>();
    pA->foo();
} 
```

* * *

如果你有理由不使用虚函数并且更喜欢不同的、非侵入式的多态性，你可以将 Boost.Variant 与`boost::static_visitor`. 这甚至不需要`B`和`C`相关。

```
#include <boost/variant.hpp>
#include <memory>
#include <iostream>

class B /* ... */ {};
class C /* ... */ {};

// ...
typedef std::shared_ptr<B> Bptr;
typedef std::shared_ptr<C> Cptr;

struct foo_visitor : boost::static_visitor<void>
{
    void operator () (Bptr p)
    {
        std::cout << "operate on B\n";
    }

    void operator () (Cptr p)
    {
        std::cout << "operate on C\n";
    }
};

int main()
{
    boost::variant<Bptr, Cptr> ptr;
    ptr = std::make_shared<C>();

    foo_visitor v;
    ptr.apply_visitor(v);
} 
```

这种方法与您选择的方法非常相似，除了 Boost.Variant 还确保您不会忘记为变体可能假设的每个值（在本例中为`Bptr`和`Cptr`）包含一个处理案例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T21:55:41.590

只需使用虚拟成员函数。没有什么可以代替真实的

```
class A {
public:
  virtual ~A(){}
  virtual void foo() = 0;
};

class B : public A {
public:
  virtual void foo() {
     std::cout << "operate on B\n";
  }
};

class C : public A {
public:
  virtual void foo() {
     std::cout << "operate on C\n";
  }
}; 
```

并选择一本好的[C++ 入门书](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)。

# python - 在 Django 包中包含 Django 视图和模板

> ID：15179852
> 
> 赞同：0
> 
> 时间：2013-03-02T21:52:07.733
> 
> 标签：python, django, python-module

我正在创建一个 Python 包，其中包含一个 Django webapp 的核心功能，我想将其用作多个未来 Web 应用程序的基础。

在这种情况下，我想在所述模块中包含所有基本视图和模板，以便基本 webapp 前端/后端是相同的。

我想要一些关于如何实现这一点的提示。特别是在 Django 包中包含视图和模板。如果有人能指出我的具体例子，那就太好了。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T22:23:58.543

Django 文档[详细说明](https://docs.djangoproject.com/en/dev/intro/reusable-apps/)了这一点。

# c++ - 虚拟赋值运算符重载——如何选择正确的重载函数？

> ID：15179854
> 
> 赞同：2
> 
> 时间：2013-03-02T21:52:10.160
> 
> 标签：c++, inheritance, virtual, overloading, assignment-operator

以下代码（来自 C++ FAQs 24.11）正在实现虚拟赋值运算符重载和覆盖：

> ```
> #include <iostream>
> using namespace std;
> 
> class B{
> public:
>     virtual ~B() throw();
>     virtual B& operator= (const B& b) throw();
> };
> 
> B::~B() throw(){}
> 
> B& B::operator= (const B& b) throw()
> { cout << "B::operator=(const B&)\n"; return *this; }
> 
> class D : public B{
> public:
>     virtual D& operator= (const B& b) throw();
>     D& operator= (const D& d) throw();
> };
> 
> D& D::operator= (const B& b) throw()
> {cout << "D::operator= (const B&)\n"; return *this;}
> 
> D& D::operator= (const D& d) throw()
> {cout << "D::operator= (const D&)\n"; return *this;}
> 
> void sample(D& d, B& b, D& d2, B& b2){
>     cout << "d = d2:   "; d = d2;
>     cout << "d = b2:   "; d = b2;
>     cout << "b = b2:   "; b = b2;
>     cout << "b = d2:   "; b = d2;
> }
> 
> int main()
> {
>     D d, b, d2, b2;
>     sample(d,b,d2,b2);
> } 
> ```

它说输出是：

*   d = d2: D::operator=(const D&)
*   d = b2: D::operator=(const B&)
*   b = b2: D::operator=(const B&)
*   b = d2: D::operator=(const B&)

它说：

> “因为编译器会根据参数的静态类型来解析要调用的覆盖，所以第一个赋值是唯一调用接受 D 的赋值运算符的赋值运算符；所有其他最终都调用采用 B 的赋值运算符。”

和

> “最后两个调用解析为覆盖 (D::operator= (const B&))，因为 sample() 中 b 的实际类是 D。如果 b 实际上是 B，最后两个调用将解析为 ( B::operator= (const B&))"

我有点困惑，第一段说编译器查看参数静态类型以确定使用哪个（重载？）函数调用，那么为什么最后一种情况调用 B 参数类型的运算符，当参数传递时, d2,`D& d2`在 sample() 中被声明为类型？

**编辑参考下面的答案，我看不到对 B::=(D) 的请求如何导致 D::=(B)。如果有另一个子类 E 怎么办？为什么会调用 D::=(B) 而不是 E::=(B)？我们是说如果 B 没有参数 (D) 的函数“=”，那么运行时开始查看是否有任何派生对象包含这样的签名？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T22:03:39.423

重载解决方案是使用静态类型完成的。一旦选择了重载，动态类型将用于确定使用哪个重写版本的函数。让我解释一下每个结果：

```
//Every object is a D object, so in
//each case, we expect the virtual calls
//to dispatch to the D version.

//lhs: D, rhs: D, so we expect
//D::operator=(D const&)
cout << "d = d2:   "; d = d2;

//lhs: D, rhs: B, so we expect
//D::operator=(B const&)
cout << "d = b2:   "; d = b2;

//lhs: B, rhs: B, so we expect
//B::operator=(B const&).
//This is virtual, and has been overridden
//in D, so the D version gets called.
cout << "b = b2:   "; b = b2;

//lhs: B, rhs: D, so we expect
//B::operator(D const&).
//This does not exist, so the closest match is used:
//B::operator(B const&). (This is a legal match, 
//because D is a subclass of B).
//This is virtual, and has been overridden
//in D, so the D version gets called.
cout << "b = d2:   "; b = d2; 
```

# python - 用 Python 控制 TCP 服务器

> ID：15179859
> 
> 赞同：0
> 
> 时间：2013-03-02T21:52:37.280
> 
> 标签：python, network-programming, tcpserver

我使用单元测试来检查 TCP 客户端通信的正确性，所以我需要一些我可以控制它并将它发送到客户端（以及何时）的 TCP 服务器。
一个简单的测试应该如下所示：

```
server = Server("localhost", 5555)
server.start()
client.connect()
self.assertTrue("login_message" in server.received_data)
server.send_to_client(reject_messages)
self.assertTrue("login_again" in server.received_data)
time.sleep(10)
self.assertTrue("login_again_and_again" in server.newest_received_data)
server.stop()
self.assertTrue("login failed" in client.logs) 
```

我需要完整的流量控制，什么可以用于实现服务器？
现在我尝试使用线程化的 SocketServer，但我既不能访问数据，也不能控制它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T12:21:03.113

我不知道是否有人需要这个，但无论如何：我使用了 gevent 服务器

```
from gevent import sleep, socket
from gevent.server import StreamServer

class Connection:
    def __init__(self, host, port):
        self.server = StreamServer((host, port), self.handle)
        self.data = []
        self.socks = []
        self.pointer = 0

    def handle(self, sock, address):
        self.socks.append(sock)
        while True:
            line = sock.recv(1024)
            if line:
                self.data += [line]
            else:
                break
        sock.close()
        self.socks.remove(sock)

    def send(self, msg):
        if self.socks:
            sock2send = self.socks[-1]
            try:
                sock2send.send(msg)
            except IOError, e:
                print "Can't send message '%s'! Exception:" % msg, e
        else:
            print "No sockets to send the message to"

    def start(self):
        self.server.start()

    def serve_forever(self):
        self.server.serve_forever()

    def close(self):
        self.server.stop()
        for sock in self.socks:
            sock.close()

    def new_data(self):
        newest = self.data[self.pointer:]
        self.pointer = len(self.data)
        return newest 
```

然后 unittest 看起来像这样：

```
def testTCPClient(self):    
    j = lambda x: "".join(x)

    server = Connection("", 5555)            
    server.start()
    client.run()
    sleep(3)
    data = j(server.new_data())
    self.assertTrue("login" in data)
    sleep(2)
    server.send("login approve")
    sleep(2)
    data = j(server.new_data())
    self.assertTrue("after_login" in data)
    server.send("logout")
    sleep(2)
    data = j(server.new_data())
    self.assertTrue("received_logout" in data)
    server.close()
    self.assertTrue("disconnected" in client.logs) 
```

# android - 使 actionBar 选项卡之一具有视图寻呼机

> ID：15179861
> 
> 赞同：0
> 
> 时间：2013-03-02T21:52:41.127
> 
> 标签：android, android-actionbar, android-viewpager

我正在尝试制作一个应用程序来执行以下功能：我需要一个带有 3 个选项卡的 ActionBar，以便其中一个选项卡必须实现 ViewPager，而其他 2 个选项卡必须具有单独的布局。虽然我知道如何创建带有带有片段的选项卡的 ActionBar，我不知道如何（或者是否有可能）在其中一个选项卡内实现 ViewPager。非常感谢您的帮助。

编辑：Nvm 我找到了解决方案。您必须使用嵌套片段。有关更多信息，请参阅 [如何使用嵌套片段（Android 4.2）在 ViewPager 中添加片段](https://stackoverflow.com/questions/13379194/how-to-add-a-fragment-inside-a-viewpager-using-nested-fragment-android-4-2)

# inline - RNGscope 分段错误

> ID：15179862
> 
> 赞同：2
> 
> 时间：2013-03-02T21:52:41.570
> 
> 标签：inline, rcpp

我一直在使用 inline/RcppArmadillo 编写一些模拟代码，并偶然发现了 RNGScope 的问题。这是一个错误还是我在做一些非常愚蠢的事情？我已经清空了函数以使其可读（见下文）。

干杯，埃德

```
library(inline)
code_cpp <- '
using namespace arma;
// From R  
uvec               x0 = as<uvec>(x0_r);
vec          time_vec = as<vec>(time_vec_r);
// Declare variables
umat        simulation_data=zeros<umat>(x0.n_elem, time_vec.n_elem);
RNGScope scope;
return wrap(simulation_data);
'

gillespie_sim <- cxxfunction(body = code_cpp, 
                              sig = signature(x0_r = "integer", time_vec_r= "numeric"), 
                        plugin = "RcppArmadillo") 

x0    <- c(1,0,0,0,0,0)
time_vec <- 1:800
set.seed(23) 
for(i in 1:100000) out2  <- gillespie_sim(x0_r=x0,time_vec_r=time_vec) 
```

我得到的错误

R(43305) malloc: *** 对象 0x108c30a00 的错误：已释放对象的校验和不正确 - 对象可能在被释放后被修改。***在 malloc_error_break 中设置断点以调试 Abort 陷阱：6

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T13:19:29.300

嗯，我看到两个问题：

a) 你使用`umat`，但我们`unsigned int`在 R 中没有，所以这会得到很多非常低效的副本。我将其更改为`mat`，但`imat`也应该可以工作。

b ）你循环*很多*。`for(i in 1:100000)`我们已经看到与“数以千计”的对象创建类似的问题。我们不确定错误在哪里。

使用较小的 N 它似乎不会发生（经常）。我们将看看是否`RNGScope`与它有关——但这是一个非常简单的对象。

感谢您的错误报告。请考虑`rcpp-devel`下次使用。

*编辑：*另请注意，使用`Rcpp`向量时，错误似乎并没有表现出来。因此，您可以使用两步方法，首先初始化 Rcpp 对象，然后从中初始化 Armadillo 对象——`fastLm.r`包中的文件有一个示例。

```
suppressMessages(library(Rcpp))
suppressMessages(library(inline))

useRcpp <- function() {
    code_cpp <- '
// From R
NumericVector  x0(x0_r);
NumericVector  time_vec(time_vec_r);
// Declare variables
NumericMatrix  simulation_data(x0.size(), time_vec.size());
RNGScope scope;
return simulation_data;
'

cxxfunction(body = code_cpp,
            sig = signature(x0_r = "integer", time_vec_r= "numeric"),
            plugin = "Rcpp")
}

gillespie_sim <- useRcpp()

x0    <- c(1,0,0,0,0,0)
time_vec <- 1:800
set.seed(23)
for(i in 1:100000) out2  <- gillespie_sim(x0_r=x0,time_vec_r=time_vec)
cat("Done\n") 
```

# wordpress - 将登录/注销添加到菜单 Woocommerce Wordpress

> ID：15179863
> 
> 赞同：1
> 
> 时间：2013-03-02T21:52:43.177
> 
> 标签：wordpress, woocommerce

我想弄清楚如何在菜单中添加登录/注销。当我将此代码添加到 wordpress 标题时，内容和侧边栏消失了。如何在不丢失页面其余部分的情况下将登录/注销添加到菜单。我尝试在设置菜单中添加它，但它不适用于我正在使用的主题。

```
<ul>
<?php
$myaccount_page_id = get_option( 'woocommerce_myaccount_page_id' );
if ( $myaccount_page_id  && !is_user_logged_in()) {
    $myaccount_page_url = get_permalink( $myaccount_page_id );
    ?>
    <li><a href="<?php echo $myaccount_page_url; ?>" class="login-header"><?php _e('Login', 'woocommerce'); ?></a></li>
    <?php
}
$myaccount_page_id = get_option( 'woocommerce_myaccount_page_id' );
if ( $myaccount_page_id && is_user_logged_in()) {
    $logout_url = wp_logout_url( get_permalink( $myaccount_page_id ) );
    if ( get_option( 'woocommerce_force_ssl_checkout' ) == 'yes' )
        $logout_url = str_replace( 'http:', 'https:', $logout_url );
    ?>
    <li><a href="<?php echo $logout_url; ?>" class="login-header"><?php _e('Logout', 'woocommerce'); ?></a></li>
    <?php } ?>
    <li><a href="<?php echo $woocommerce->cart->get_cart_url(); ?>" class="cart-header"><?php _e('Shopping Cart', 'woocommerce'); ?> <?php echo sprintf(_n('(%d)', '(%d)', $woocommerce->cart->cart_contents_count, 'woothemes'), $woocommerce->cart->cart_contents_count);?></a></li>
    <li><a href="<?php echo $woocommerce->cart->get_checkout_url(); ?>" class="check-header"><?php _e('Checkout', 'woocommerce'); ?></a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-25T03:51:07.303

注销链接：/?customer-logout=true

登录链接发送到我的帐户页面以触发登录：/my-account/

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-04T23:01:55.943

如果您使用[Theme My Login](http://wordpress.org/extend/plugins/theme-my-login/)之类的插件，您只需在菜单中创建指向登录页面的链接。如果此人未登录，它将显示“登录”，如果该人已登录，它将显示“注销”。希望这有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-23T03:05:58.817

有很多代码不起作用。我刚刚找到了一个完美的工作。启动*functions.php*：

```
add_filter( 'wp_nav_menu_items', 'my_account_loginout_link', 10, 2 );
/**
 * Add WooCommerce My Account Login/Logout to Menu
 * 
 * @see https://support.woothemes.com/hc/en-us/articles/203106357-Add-Login-Logout-Links-To-The-Custom-Primary-Menu-Area
 */
function my_account_loginout_link( $items, $args ) {
    if (is_user_logged_in() && $args->theme_location == 'top') { //change your theme location menu to suit
        $items .= '<li><a class="nav-link" href="'. wp_logout_url( get_permalink( wc_get_page_id( 'shop' ) ) ) .'">Sair</a></li>'; //change logout link, here it goes to 'shop', you may want to put it to 'myaccount'
    }
    elseif (!is_user_logged_in() && $args->theme_location == 'top') {//change your theme location menu to suit
        $items .= '<li><a class="nav-link" href="' . get_permalink( wc_get_page_id( 'myaccount' ) ) . '">Entrar</a></li>';
    }
    return $items;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-24T15:16:28.917

更简单的方法是更改​​菜单结构

登录（下拉菜单）

*   忘记密码

我的帐户（下拉菜单）

*   更改密码
*   忘记密码
*   登出

然后在 woocommerce-functions.php (:123) 中显示或隐藏以下页面 ID

```
function woocommerce_nav_menu_items( $items, $args ) {
    if ( ! is_user_logged_in() ) {

        $hide_pages   = array();
        $hide_pages[] = 20;
        $hide_pages   = apply_filters( 'woocommerce_logged_out_hidden_page_ids', $hide_pages );

        foreach ( $items as $key => $item ) {
            if ( ! empty( $item->object_id ) && ! empty( $item->object ) && in_array( $item->object_id, $hide_pages ) && $item->object == 'page' ) {
                unset( $items[ $key ] );
            }
        }
    } else {
        $hide_pages   = array();
        $hide_pages[] = 18;
        $hide_pages   = apply_filters( 'woocommerce_logged_out_hidden_page_ids', $hide_pages );

        foreach ( $items as $key => $item ) {
            if ( ! empty( $item->object_id ) && ! empty( $item->object ) && in_array( $item->object_id, $hide_pages ) && $item->object == 'page' ) {
                unset( $items[ $key ] );
            }
        }
    }

    return $items;
} 
```

我的登录页面 ID 是“20”，我的帐户页面 ID 是“18”

希望对有需要的人有所帮助

# php - 如何将此 HTML 表格转换为 XML？

> ID：15179866
> 
> 赞同：1
> 
> 时间：2013-03-02T21:53:01.837
> 
> 标签：php, javascript, jquery, xml

这是两个包含我希望以 XML 格式保存的数据的表。实际情况不止两个，行数是随机的。

```
<table width="100%" align="center" class="mytable" border="1" cellspacing="1">
  <tr><td width="100%"><b>Δ.Ο.Υ. Α' ΑΘΗΝΩΝ (Α',Β',Γ',ΙΕ',ΚΒ') Κ.Α.: 1101</b> Αναξαγόρα 6-8, T.K. 100 10 Αθήνα</a><a name="aa8inon"></a></td></tr>
    <tr><td width="8%">Προϊστάμενος</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>-52.72.810, 770</td></tr>
    <tr><td width="8%">Υποδιευθυντής Φορολογίας</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>-52.72.804</td></tr>
    <tr><td width="8%">Υποδιευθυντής Ελέγχου</td><td width="8%"><b>213</b> 1604121</td><td width="8%"><b>210</b>-52.72.807</td></tr>
</table>

<table width="100%" align="center" class="mytable" border="1" cellspacing="1">
  <tr><td width="100%"><b>Δ.Ο.Υ. ΚΑΤΟΙΚΩΝ ΕΞΩΤΕΡΙΚΟΥ Κ.Α.: 1125</b> Μετσόβου 4-T.K.  106 82 Αθήνα</td></tr>
    <tr><td width="8%">Προϊστάμενος</td><td width="8%"><b>213</b> 1607155</td><td width="8%"><b>210</b>- 8204607</td></tr>
    <tr><td width="8%">Υποδιευθυντής Φορολογίας</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>- 8204604</td></tr>
</table> 
```

table 标记下方的第一行是根元素，所有其他行都是子元素。如果我在正确命名元素时犯了一些错误，请原谅我。

例如在`<tr><td>`你看到的第一个之间

```
<b>Δ.Ο.Υ. Α' ΑΘΗΝΩΝ (Α',Β',Γ',ΙΕ',ΚΒ') Κ.Α.: 1101</b> Αναξαγόρα 6-8, T.K. 100 10 Αθήνα</a><a name="aa8inon"></a> 
```

这将是根元素中的属性名称。

下面的第一`<td></td>`行`Προϊστάμενος`是子元素，从下一行`<td>`到最后一行`</td>`是该子元素`<tr>`的数据。

这就是我想要的

```
<note doy="<b>Δ.Ο.Υ. Α' ΑΘΗΝΩΝ (Α',Β',Γ',ΙΕ',ΚΒ') Κ.Α.: 1101</b> Αναξαγόρα 6-8, T.K. 100 10 Αθήνα</a><a name="aa8inon"></a>">
  <Προϊστάμενος>&nbsp;</td><td width="8%"><b>210</b>-52.72.810, 770</Προϊστάμενος>
  <Υποδιευθυντής Φορολογίας>&nbsp;</td><td width="8%"><b>210</b>-52.72.810, 770</Υποδιευθυντής Φορολογίας>
</note> 
```

这可能吗？任何代码表示赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-11T09:00:05.187

首先，我应该注意您要输出的 XML 似乎无效。

您可以使用优秀的查询路径库（[http://querypath.org/](http://querypath.org/)），最终您可以将相同的逻辑从 PHP 应用到 Javascript（使用 JQuery 的选择器引擎）

这是一段从您的输入中生成**有效 XML**的代码（顺便说一句，我是希腊人，所以对我来说更有意义）：

```
libxml_use_internal_errors(true);

$html = '<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /></head><body><table width="100%" align="center" class="mytable" border="1" cellspacing="1">
           <tr><td width="100%"><b>Δ.Ο.Υ. Α\' ΑΘΗΝΩΝ (Α\',Β\',Γ\',ΙΕ\',ΚΒ\') Κ.Α.: 1101</b> Αναξαγόρα 6-8, T.K. 100 10 Αθήνα</a><a name="aa8inon"></a></td></tr>
           <tr><td width="8%">Προϊστάμενος</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>-52.72.810, 770</td></tr>
           <tr><td width="8%">Υποδιευθυντής Φορολογίας</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>-52.72.804</td></tr>
           <tr><td width="8%">Υποδιευθυντής Ελέγχου</td><td width="8%"><b>213</b> 1604121</td><td width="8%"><b>210</b>-52.72.807</td></tr>
         </table>
         <table width="100%" align="center" class="mytable" border="1" cellspacing="1">
           <tr><td width="100%"><b>Δ.Ο.Υ. ΚΑΤΟΙΚΩΝ ΕΞΩΤΕΡΙΚΟΥ Κ.Α.: 1125</b> Μετσόβου 4-T.K.  106 82 Αθήνα</td></tr>
           <tr><td width="8%">Προϊστάμενος</td><td width="8%"><b>213</b> 1607155</td><td width="8%"><b>210</b>- 8204607</td></tr>
           <tr><td width="8%">Υποδιευθυντής Φορολογίας</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>- 8204604</td></tr>
         </table></body></html>';

$results = qp($html, 'table.mytable');

$xml   = new \SimpleXMLElement('<?xml version="1.0" encoding="UTF-8"?><notes/>');

foreach( $results as $result ) {
  $note = $xml->addChild("note");

  foreach( $result->children('tr') as $idx => $tr ) {
    if( $idx == 0 ) {
      $note->addAttribute("doy", $tr->children('td')->text());
      continue;
    }

    $tds    = $tr->children('td');

    foreach( $tds as $tidx => $td ) {
      if( $tidx == 0 ) {
        $person = $note->addChild("person");
        $person->addAttribute("title", trim($td->text()));

        continue;
      }

      $phoneValue = $td->text();
      $phoneValue = str_replace( array(" ", ".", "-", "\xc2\xa0"), "", $phoneValue );

      if( $phoneValue != '' )
        $phone = $person->addChild("phone", $phoneValue);
    }
  }
}

$dom = dom_import_simplexml($xml)->ownerDocument;
$dom->formatOutput = true;
echo $dom->saveXML(); 
```

输出：

```
<?xml version="1.0" encoding="UTF-8"?>
  <notes>
    <note doy="Δ.Ο.Υ. Α' ΑΘΗΝΩΝ (Α',Β',Γ',ΙΕ',ΚΒ') Κ.Α.: 1101 Αναξαγόρα 6-8, T.K. 100 10 Αθήνα">
      <person title="Προϊστάμενος">
        <phone>2105272810,770</phone>
      </person>
      <person title="Υποδιευθυντής Φορολογίας">
        <phone>2105272804</phone>
      </person>
      <person title="Υποδιευθυντής Ελέγχου">
        <phone>2131604121</phone>
        <phone>2105272807</phone>
      </person>
    </note>
    <note doy="Δ.Ο.Υ. ΚΑΤΟΙΚΩΝ ΕΞΩΤΕΡΙΚΟΥ Κ.Α.: 1125 Μετσόβου 4-T.K.  106 82 Αθήνα">
      <person title="Προϊστάμενος">
        <phone>2131607155</phone>
        <phone>2108204607</phone>
      </person>
      <person title="Υποδιευθυντής Φορολογίας">
        <phone>2108204604</phone>
      </person>
    </note>
  </notes> 
```

**请注意：**我已将您的 html 代码包装在`<html><head><body>`标签中，添加`<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />`标签以帮助 querypath 识别编码。如果您需要更多信息，请参阅[https://github.com/technosophos/querypath/issues/94 。](https://github.com/technosophos/querypath/issues/94)如果您坚持创建粘贴在问题中的 XML，您可以相应地更改示例。

此外，querypath 奇怪地转换`&nbsp;`为`0xC2 0xA0 (c2a0)`(Unicode character no-break-space) ( [http://www.fileformat.info/info/unicode/char/a0/index.htm](http://www.fileformat.info/info/unicode/char/a0/index.htm) ) 因此`"\xc2\xa0"`在`str_replace`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-08T00:57:05.453

回首往事，我不知道您的问题是针对 php 还是针对 javascript，但这里有一个 Javascript 的答案。只需将其保存为 HTML 文件并将其加载到新的浏览器窗口中即可查看输出。

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<table width="100%" align="center" class="mytable" border="1" cellspacing="1">
  <tr><td width="100%"><b>Δ.Ο.Υ. Α' ΑΘΗΝΩΝ (Α',Β',Γ',ΙΕ',ΚΒ') Κ.Α.: 1101</b> Αναξαγόρα 6-8, T.K. 100 10 Αθήνα</a><a name="aa8inon"></a></td></tr>
    <tr><td width="8%">Προϊστάμενος</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>-52.72.810, 770</td></tr>
    <tr><td width="8%">Υποδιευθυντής Φορολογίας</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>-52.72.804</td></tr>
    <tr><td width="8%">Υποδιευθυντής Ελέγχου</td><td width="8%"><b>213</b> 1604121</td><td width="8%"><b>210</b>-52.72.807</td></tr>
</table>
<table width="100%" align="center" class="mytable" border="1" cellspacing="1">
  <tr><td width="100%"><b>Δ.Ο.Υ. ΚΑΤΟΙΚΩΝ ΕΞΩΤΕΡΙΚΟΥ Κ.Α.: 1125</b> Μετσόβου 4-T.K.  106 82 Αθήνα</td></tr>
    <tr><td width="8%">Προϊστάμενος</td><td width="8%"><b>213</b> 1607155</td><td width="8%"><b>210</b>- 8204607</td></tr>
    <tr><td width="8%">Υποδιευθυντής Φορολογίας</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>- 8204604</td></tr>
</table>
<textarea id="output" rows="24" cols="140"></textarea>
</body>
<script type="text/javascript">
var tables=document.getElementsByTagName("table");
var doc, note, el, elName, txt,txtContent;

doc=document.implementation.createDocument("AnyNamespaceYouWantForYourXML","RootElementName"); //In older versions of IE, I believe you'll have to resort to an ActiveX object
for(var t =0; t<tables.length;t++){
    el=doc.createElement("note");
    note=doc.documentElement.appendChild(el);
    rows=tables[t].getElementsByTagName("tr");
    for(var r=0; r<rows.length; r++){
        var tds=rows[r].getElementsByTagName("td");
        if(r==0){
            note.setAttribute("doy",tds[0].innerHTML); //Unlike in your example output, the real output will have 'special' characters correctly html encoded
        } else {
            elName=tds[0].innerText;
            elName=elName.trim(); //You probably want to discard leading or trailing whitespace
            elName=elName.replace(/[\s]+/g,"_"); //XML element names cannot contain spaces, so replace with underscores
            //There are other rules relating to valid XML element names which you may need to add here. Greek letters should be fine.
            el=doc.createElement(elName);
            //It wasn't clear from your example whether you wanted the xml element to contain the text of the html or some text and a td element
            //The first case seemed more likely, so here it is
            txtContent=" </td>";
            for(var d=1;d<tds.length;d++){
                txtContent+=tds[d].outerHTML;
            }
            txt=doc.createTextNode(txtContent);
            el.appendChild(txt); //Put the text in the element
            note.appendChild(el); //Add the element to the note
        }
    }
}
console.log(doc); //Check the console, you have a useful XML document object
document.getElementById("output").value=xml2Str(doc.documentElement); //Output a string representation

function xml2Str(xmlNode) {
  try {
      // Pretty printing available?
      return XML((new XMLSerializer()).serializeToString(xmlNode)).toXMLString();
  }
  catch (e) {}
  try {
      // Gecko- and Webkit-based browsers (Firefox, Chrome), Opera.
      return (new XMLSerializer()).serializeToString(xmlNode).replace(/<([^\/])/g,"\n<$1");
  }
  catch (e) {}
  try {
     // Internet Explorer.
     return xmlNode.xml.replace(/<([^\/])/g,"<\1");
  }
  catch (e) {}  
  //Other browsers without XML Serializer
  alert('Xmlserializer not supported');
  return false;
}
</script>
</html> 
```

示例输出（手动添加缩进）：

```
<RootElementName xmlns="AnyNamespaceYouWantForYourXML">
<note doy="&lt;b&gt;Δ.Ο.Υ. Α' ΑΘΗΝΩΝ (Α',Β',Γ',ΙΕ',ΚΒ') Κ.Α.: 1101&lt;/b&gt; Αναξαγόρα 6-8, T.K. 100 10 Αθήνα&lt;a name=&quot;aa8inon&quot;&gt;&lt;/a&gt;">
  <Προϊστάμενος> &lt;/td&gt;&lt;td width="8%"&gt;&amp;nbsp;&lt;/td&gt;&lt;td width="8%"&gt;&lt;b&gt;210&lt;/b&gt;-52.72.810, 770&lt;/td&gt;</Προϊστάμενος>
  <Υποδιευθυντής_Φορολογίας> &lt;/td&gt;&lt;td width="8%"&gt;&amp;nbsp;&lt;/td&gt;&lt;td width="8%"&gt;&lt;b&gt;210&lt;/b&gt;-52.72.804&lt;/td&gt;</Υποδιευθυντής_Φορολογίας>
  <Υποδιευθυντής_Ελέγχου> &lt;/td&gt;&lt;td width="8%"&gt;&lt;b&gt;213&lt;/b&gt; 1604121&lt;/td&gt;&lt;td width="8%"&gt;&lt;b&gt;210&lt;/b&gt;-52.72.807&lt;/td&gt;</Υποδιευθυντής_Ελέγχου>
</note>
<note doy="&lt;b&gt;Δ.Ο.Υ. ΚΑΤΟΙΚΩΝ ΕΞΩΤΕΡΙΚΟΥ Κ.Α.: 1125&lt;/b&gt; Μετσόβου 4-T.K.  106 82 Αθήνα">
  <Προϊστάμενος> &lt;/td&gt;&lt;td width="8%"&gt;&lt;b&gt;213&lt;/b&gt; 1607155&lt;/td&gt;&lt;td width="8%"&gt;&lt;b&gt;210&lt;/b&gt;- 8204607&lt;/td&gt;</Προϊστάμενος>
  <Υποδιευθυντής_Φορολογίας> &lt;/td&gt;&lt;td width="8%"&gt;&amp;nbsp;&lt;/td&gt;&lt;td width="8%"&gt;&lt;b&gt;210&lt;/b&gt;- 8204604&lt;/td&gt;</Υποδιευθυντής_Φορολογίας>
</note>
</RootElementName> 
```

[编辑] 注意事项：

1.  您的示例输出令人困惑，因为它包含不匹配的标签（例如，您的 doy 属性内的标记和希腊命名标签的内部）。我试图尽可能地解释您的示例输出，并将属性内和希腊命名元素内的所有内容都转换为文本。这意味着 < 表示为 & lt; 和 " 作为 & quot; 和 ' 作为 & apos; 但是，另一种可能性是用 <[!CDATA[ ... ]]> 包围标记，以告诉 XML 解释器不要解析该区域中的字符。
2.  虽然您可以使用希腊字符命名 XML 元素，但请注意，并非所有字符都是有效的或 XML 元素名称，因此您必须对可以在第一个单元格中显示的文本进行某种控制，或者明确纠正您的代码。请参阅[http://www.w3schools.com/xml/xml_elements.asp](http://www.w3schools.com/xml/xml_elements.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-14T11:08:45.737

您可以将有效的 XHTML 解析为 XML，并使用 XML 样式表将其转换为所需的 XML 格式。由于 HTML 不是有效的 XHTML，您必须首先使用工具来整理它，例如[在线整理网站](http://infohound.net/tidy/)。如果您需要在运行时执行此操作，也有一个[php 库](http://php.net/manual/en/book.tidy.php)（带有[示例代码）。](http://www.php.net/manual/en/tidy.examples.basic.php)

我在该站点上整理了您的 HTML，并对其应用了以下样式表：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    xmlns:xhtml="http://www.w3.org/1999/xhtml"
    xmlns:fn="http://www.w3.org/2005/xpath-functions">

    <xsl:template match="/xhtml:html/xhtml:body">
        <xsl:element name="notes">
            <xsl:apply-templates />
        </xsl:element>
    </xsl:template>

    <xsl:template match="xhtml:table">
        <xsl:element name="note">
            <xsl:attribute name="doy">
                <xsl:value-of select="xhtml:tr[1]/xhtml:td" />
            </xsl:attribute>
            <xsl:for-each select="xhtml:tr[position() != 1]">
                <xsl:element name="{translate(xhtml:td,' ','_')}">
                    <xsl:for-each select="xhtml:td[position() != 1]">
                        <!-- filter out empty / &nbsp; td elements -->
                        <xsl:if test="normalize-space(translate(.,'&#xc2;&#xa0;','  '))">
                            <xsl:element name="τηλέφωνο">
                                <xsl:value-of select="."  />
                            </xsl:element>
                        </xsl:if>
                    </xsl:for-each>
                </xsl:element>
            </xsl:for-each>
        </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

这产生：

```
<notes>
    <note
        doy="Δ.Ο.Υ. Α' ΑΘΗΝΩΝ (Α',Β',Γ',ΙΕ',ΚΒ') Κ.Α.: 1101 Αναξαγόρα 6-8, T.K. 100 10 Αθήνα">
        <Προϊστάμενος>
            <τηλέφωνο>210-52.72.810, 770</τηλέφωνο>
        </Προϊστάμενος>
        <Υποδιευθυντής_Φορολογίας>
            <τηλέφωνο>210-52.72.804</τηλέφωνο>
        </Υποδιευθυντής_Φορολογίας>
        <Υποδιευθυντής_Ελέγχου>
            <τηλέφωνο>213 1604121</τηλέφωνο>
            <τηλέφωνο>210-52.72.807</τηλέφωνο>
        </Υποδιευθυντής_Ελέγχου>
    </note>

    <note
        doy="Δ.Ο.Υ. ΚΑΤΟΙΚΩΝ ΕΞΩΤΕΡΙΚΟΥ Κ.Α.: 1125 Μετσόβου 4-T.K. 106 82 Αθήνα">
        <Προϊστάμενος>
            <τηλέφωνο>213 1607155</τηλέφωνο>
            <τηλέφωνο>210- 8204607</τηλέφωνο>
        </Προϊστάμενος>
        <Υποδιευθυντής_Φορολογίας>
            <τηλέφωνο>210- 8204604</τηλέφωνο>
        </Υποδιευθυντής_Φορολογίας>
    </note>
</notes> 
```

一些注意事项：

*   在生成的 XML 中期望 HTML 标记对我来说似乎很奇怪。XML 包含数据且数据未格式化为粗体且不包含锚点。
*   XML 元素名称不允许包含空格，因此我将它们替换为下划线
*   必须为整洁的站点指定 UTF-8，否则会使非 ascii 字符乱码
*   我首先尝试坚持使用问题的 XML 格式，直到我在不同的答案中看到您希望所有电话号码都出现在 XML 中。因此我给了他们一个单独的周围元素标签。
*   XML 样式表与语言无关，有一种方法可以在大多数语言中应用它们。例如在 php 中，见下文，或者在 javascript 中，甚至在浏览器中，因为您可以使用此样式表提供 .xhtml，然后浏览器将呈现 XML。但它通常以相反的方式完成，为 XML 数据创建 HTML 表示。我不太确定何时何地需要创建 XML。

示例 php 代码：

```
<?php
$xhtml_file = 'doc.xhtml';
$xsl_file = 'doc.xsl';
$doc = new DOMDocument();
$xsl = new XSLTProcessor();

$doc->load($xsl_file);
$xsl->importStyleSheet($doc);

$doc->load($xhtml_file);
echo $xsl->transformToXML($doc);
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-07T20:58:09.757

我自己不是 php 编码器，对任何错误表示歉意。我使用[[1]](https://stackoverflow.com/questions/4881255/generating-xml-from-html-list-using-php)作为参考，并对那里的答案进行了快速更改，以接近您的问题：

**代码作为一个粗略的想法：**

```
<?php

  # Create new DOM object
  $domOb = new DOMDocument();

  # Grab your HTML file
  $html = $domOb->loadHTMLFile(sections.html);

  # Remove whitespace
  $domOb->preserveWhiteSpace = false; 

  # Set the container tag
  $container = $domOb->getElementsByTagName('table'); 

  # Loop through td values
  foreach ($container as $row) 
  { 
      # Grab all <td>
      $items = $row->getElementsByTagName('td'); 
    } 

?> 
```

**进化来完全回答这个问题：**

这样，几乎直接取自该来源[[1]](https://stackoverflow.com/questions/4881255/generating-xml-from-html-list-using-php)，`$container`具有所有表格并`$items`具有`<td>`元素内容。

我想您可以使用一些 php，因此现在执行以下操作并不是什么大问题（*这里只有伪代码，抱歉*）：

```
1) Take one table item from `$container` with that `foreach`
2) Take first td item, write the needed xml tag `<note doy="`
3) Print td content there
4) Close tag `">`
5) Print the rest of the rows, adding the <td> tags manually to the sides (I suppose this code removes them
6) Add trailing `</node>` tag and iterate to next one on `$container` 
```

*抱歉，我的 php 技能为零，尝试使用这些进行管理，或者如果其他人可以改进这一点，请随时使用我的开头作为来源并做出新的答案。我只是想帮助@Kaoukkos，如果我不能给出最完整的答案而另一个人可以的话，我不想要任何分数。*

***需要的是不要用 foreach 而是用其他方式迭代它*** *，你可以说* ***对第一行执行 2-4 对其余内容执行 5*** *，就是这样，伙计们！*

**我的消息来源：**

[1][使用 PHP 从 HTML 列表生成 XML](https://stackoverflow.com/questions/4881255/generating-xml-from-html-list-using-php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-09T09:35:44.553

可以用一些正则表达式来完成。即使您的代码格式不正确（但您的 table 和 td 标记必须正确格式化），这些也将起作用。

```
// your original string    
$string = <<<heredoc
    <table width="100%" align="center" class="mytable" border="1" cellspacing="1">
      <tr><td width="100%"><b>Δ.Ο.Υ. Α' ΑΘΗΝΩΝ (Α',Β',Γ',ΙΕ',ΚΒ') Κ.Α.: 1101</b> Αναξαγόρα 6-8, T.K. 100 10 Αθήνα</a><a name="aa8inon"></a></td></tr>
        <tr><td width="8%">Προϊστάμενος</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>-52.72.810, 770</td></tr>
        <tr><td width="8%">Υποδιευθυντής Φορολογίας</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>-52.72.804</td></tr>
        <tr><td width="8%">Υποδιευθυντής Ελέγχου</td><td width="8%"><b>213</b> 1604121</td><td width="8%"><b>210</b>-52.72.807</td></tr>
    </table>

    <table width="100%" align="center" class="mytable" border="1" cellspacing="1">
      <tr><td width="100%"><b>Δ.Ο.Υ. ΚΑΤΟΙΚΩΝ ΕΞΩΤΕΡΙΚΟΥ Κ.Α.: 1125</b> Μετσόβου 4-T.K.  106 82 Αθήνα</td></tr>
        <tr><td width="8%">Προϊστάμενος</td><td width="8%"><b>213</b> 1607155</td><td width="8%"><b>210</b>- 8204607</td></tr>
        <tr><td width="8%">Υποδιευθυντής Φορολογίας</td><td width="8%">&nbsp;</td><td width="8%"><b>210</b>- 8204604</td></tr>
    </table>

heredoc;

$patternTable = "/<table(.+?)table>/s"; // simple regExp for table tags
$patternTd = '/<td[^>]*>(.+?)<\/td>/s'; // simple regExp for individual tds

$xml = new SimpleXMLElement('<?xml version="1.0" encoding="UTF-8"?><root/>');

preg_match_all($patternTable, $string, $matches); 

for($i=0; $i<sizeof($matches[1]); $i++){   
    $tds  = array();
    $attribute = "";
    $content = "";
    $tagName = "";
    preg_match_all($patternTd,$matches[1][$i], $tds); 
    for($j=0; $j<sizeof($tds[1]); $j++){
        if($j==0){ // first TD, add as attribute of note, taking the CONTENT of the td
            $attribute =  $tds[1][$j];
            $note = $xml->addChild("note");
            $note->addAttribute("doy", $attribute);
        } else { // other tds 
            // there are 3 tds, the first is the name of the tag, the other two the contents
            if($j %3 == 1){
                if($tagName != ""){
                    $note->addChild($tagName, $tagContent);
                    $tagContent = "";
                }
                $tagName = str_replace(" ", "_", $tds[1][$j]);
            } else {
                $tagContent.= $tds[1][$j];
            } 
        }
    }
    $note->addChild($tagName, $tagContent); // add the last opened node

}

$dom = dom_import_simplexml($xml)->ownerDocument;
$dom->formatOutput = true;
echo $dom->saveXML(); 
```

这个脚本对我的结果是：

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
  <note doy="&lt;b&gt;Δ.Ο.Υ. Α' ΑΘΗΝΩΝ (Α',Β',Γ',ΙΕ',ΚΒ') Κ.Α.: 1101&lt;/b&gt; Αναξαγόρα 6-8, T.K. 100 10 Αθήνα&lt;/a&gt;&lt;a name=&quot;aa8inon&quot;&gt;&lt;/a&gt;">
    <Προϊστάμενος>&nbsp;&lt;b&gt;210&lt;/b&gt;-52.72.810, 770</Προϊστάμενος>
    <Υποδιευθυντής_Φορολογίας>&nbsp;&lt;b&gt;210&lt;/b&gt;-52.72.804</Υποδιευθυντής_Φορολογίας>
    <Υποδιευθυντής_Ελέγχου>&lt;b&gt;213&lt;/b&gt; 1604121&lt;b&gt;210&lt;/b&gt;-52.72.807</Υποδιευθυντής_Ελέγχου>
  </note>
  <note doy="&lt;b&gt;Δ.Ο.Υ. ΚΑΤΟΙΚΩΝ ΕΞΩΤΕΡΙΚΟΥ Κ.Α.: 1125&lt;/b&gt; Μετσόβου 4-T.K.  106 82 Αθήνα">
    <Προϊστάμενος>&lt;b&gt;213&lt;/b&gt; 1604121&lt;b&gt;210&lt;/b&gt;-52.72.807&lt;b&gt;213&lt;/b&gt; 1607155&lt;b&gt;210&lt;/b&gt;- 8204607</Προϊστάμενος>
    <Υποδιευθυντής_Φορολογίας>&nbsp;&lt;b&gt;210&lt;/b&gt;- 8204604</Υποδιευθυντής_Φορολογίας>
  </note>
</root> 
```

标签的属性和内容中的所有 HTML 都被转义，因为在内容中包含标签是无效的。但是，如果您再次打印出来，它将保留您的内容。

请记住，此解决方案使用正则表达式以及 SimpleXML 和 Dom（用于漂亮地打印带有换行符和缩进的 XML）——就性能而言，它不会很快。如果你想跳过 Dom 部分，你可以使用

```
echo $xml->asXML() 
```

代替

```
$dom = dom_import_simplexml($xml)->ownerDocument;
$dom->formatOutput = true;
echo $dom->saveXML(); 
```

希望这可以帮助。

# wpf - 组合框宽度不同于弹出框宽度

> ID：15179867
> 
> 赞同：0
> 
> 时间：2013-03-02T21:53:15.657
> 
> 标签：wpf, windows-8, wpf-controls, windows-runtime, winrt-xaml

如何`ComboBox`根据内容更改其宽度，但使包含项目的弹出列表具有恒定宽度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T22:59:32.347

我已经想通了。我创建了一个新的 ItemContainerStyle 并在那里设置了项目的宽度，并且没有指定 ComboBox 的宽度。

# windows - 在 WinRT 中，EasClientDeviceInformation.Id 可以用作特定设备上特定用户的唯一标识符吗？

> ID：15179869
> 
> 赞同：4
> 
> 时间：2013-03-02T21:53:25.983
> 
> 标签：windows, windows-runtime

在我们的 WinRT 应用程序中，我们需要一个登录用户的唯一标识符，该标识符在同一设备上的应用程序启动之间 100% 一致，并且在同一设备上的应用程序卸载和重新安装之间保持一致*。*标识符只需要对于相同的登录用户是一致的。

我们已经研究了[ASHWID](http://msdn.microsoft.com/en-us/library/windows/apps/jj553431.aspx)，但“硬件漂移”会以不可预知的方式置换这个 ID，它不适合我们的设计。

问题：[EasClientDeviceInformation.Id](http://msdn.microsoft.com/en-us/library/windows/apps/windows.security.exchangeactivesyncprovisioning.easclientdeviceinformation.id.aspx)是否合适？听起来不错，但我找不到太多文档或用例。此 ID 何时以及如何更改？

> ***EasClientDeviceInformation.Id | id 属性***
> 
> 返回本地计算机的标识符。Id 属性表示使用从 MachineID、用户 SID 和应用程序 ID 的 SHA256 哈希的前 16 个字节截断的 GUID 的 DeviceId，其中 MachineID 使用本地用户组的 SID。GUID 的每个组件都按网络字节顺序返回。

# c - GtkScale 小部件

> ID：15179871
> 
> 赞同：0
> 
> 时间：2013-03-02T21:53:34.283
> 
> 标签：c, gtk

我正在尝试实现一些 Gtk Scale 滑块小部件。

我的问题是我实际上无法拖动滑块。我知道这看起来应该很明显，但我不知道该怎么做。通过谷歌搜索，我发现了一些功能`gtk_range_set_update_policy()`，这似乎很有希望，但文档中不再存在。在文档中搜索缩放小部件和范围小部件，我找不到任何使`slider`可拖动的功能（似乎默认情况下它应该是可拖动的）。

PS：作为一个附带问题，GtkAdjustment 中的“page_increment”和“page_size”是什么？文档简单地将它们描述为“页面增量”和“页面大小”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T22:29:15.480

这对我有用：只需使用`lower`和`upper`值设置调整。不要在 C 中进行实验，编写起来很慢。使用您喜欢的任何脚本语言，例如 Python：

```
from gi.repository import Gtk

window = Gtk.Window ()
scale  = Gtk.Scale ()

scale.props.adjustment = Gtk.Adjustment (0, 0, 100)
# That's it ^^^^^^^^^^

window.add (scale)
window.show_all ()

window.set_size_request (400, 100)
window.present ()
window.connect ('destroy', lambda *ignored: Gtk.main_quit ())

Gtk.main () 
```

编辑：`page_increment`将影响`Page Up`/`Page Down`键的步骤。`page_size`据我了解，仅用于滚动条。

# javascript - setTimeout 的语法是什么？

> ID：15179876
> 
> 赞同：0
> 
> 时间：2013-03-02T21:54:16.543
> 
> 标签：javascript, audio, syntax, settimeout

的语法是`setTimeout()`什么？我无法让它工作。

我有两个功能：

```
audioPlayer.pause();
audioPlayer.currentTime = 0; 
```

如何添加 settimeout 使其在例如 2000 毫秒后执行？我试过了：

```
setTimeout('audioPlayer.pause()',1500);
setTimeout('audioPlayer.currentTime = 0',1500); 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:58:09.000

```
setTimeout(function(){audioPlayer.pause()},2000)
setTimeout(function(){audioPlayer.currentTime = 0},2000) 
```

[http://docs.webplatform.org/wiki/dom/methods/setTimeout](http://docs.webplatform.org/wiki/dom/methods/setTimeout)
编辑：[MDN on setTimeout()](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)

# java - 处理“java.lang.NullPointerException”

> ID：15179886
> 
> 赞同：1
> 
> 时间：2013-03-02T21:55:26.313
> 
> 标签：java, nullpointerexception

所以我是第一次学习Java。以下代码在另一个类中调用`NullPointer`时会引发异常`square.toString()`（其中 square 是此类中定义的对象的实例），我对为什么这不起作用有点模糊。有人可以向我解释吗？

```
public class SquareBuilder {

String box;
String[] parts;
final private String beam = "----";
final private String collumn = "|";
private int size;

public SquareBuilder(int firstSize)
{
    size = firstSize;

}

public static String repeatString(String s, int n) 
{   
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < n; i++) 
    {
        sb.append(s);
    }

    return sb.toString();
}

public void changeSize(int newSize)
{
    size = newSize;

}

public String toString( )
{
        parts[0] = repeatString(beam,size) + "\n";
        parts[1] = collumn + repeatString(" ",4*size-2) + collumn + "\n";
        box = parts[0] + repeatString(parts[1],size-2) + parts[0];
    return box;

}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T21:58:04.793

不清楚为什么你声明了一个*实例*变量`parts`，然后你在其中取消引用 ( `parts[0] = ...`) `toString()`- 但你从来没有初始化它，所以值是`null`......因此是例外。

为什么您的实施不只是：

```
public String toString( )
{
    String ends = repeatString(beam,size) + "\n";
    String middle = collumn + repeatString(" ",4*size-2) + collumn + "\n";
    return ends + middle + ends;
} 
```

*想要*修改`toString()`. _

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T21:58:14.117

您的问题没有正确构建，但是我猜您在 toString() 方法中得到了 NPE。原因是您从未`String[] parts;`在代码中真正初始化过您的数组。

你必须先初始化它：

```
public SquareBuilder(int firstSize)
{
    size = firstSize;
    this.parts = new int[give the size here];

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T22:07:34.523

当您尝试对空对象使用方法时会出现 NullPointerException。您应该在构造函数中`parts`使用表达式初始化数组

`parts = new String[whateverSizeYouWant];`

我不清楚你在用数组做什么。

# php - 使用静态变量调用变量函数

> ID：15179893
> 
> 赞同：4
> 
> 时间：2013-03-02T21:55:52.270
> 
> 标签：php

*方法 1*会起作用，但*方法 2*不会——它会导致致命错误（*函数名称必须是...中的字符串*）

```
# Approach 1
$function = self::$function and $function();

# Approach 2
self::$function and self::$function(); 
```

这不是有点奇怪吗？我希望有人能解释一下。

* * *

编辑：为了提供一些背景信息，这是一个完整的课程：

```
class Example
{
    static $function;

    static function method()
    {
        self::$function();
    }
}

function callback() {}

Example::$function = 'callback';
Example::method(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:20:35.817

语法对我来说似乎模棱两可。可能它也适用于 PHP。将函数名称保存在局部变量中会更干净，更实用：

```
static function method()
  $method = self::$function;
  $method();
} 
```

或使用`call_user_func()`：

```
static function method()
  call_user_func(self::$function);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:41:48.890

## 为什么方法＃1有效

这是 PHP 运算符优先级的产物。

```
$function = self::$function and $function(); 
```

相当于

```
($function = self::$function) and $function(); 
```

这当然相当于

```
$function = self::$function;
if ($function) $function(); 
```

最后一行工作正常，因为这是[变量函数](http://php.net/manual/en/functions.variable-functions.php)的语法。

## 为什么方法＃2不起作用

因为存在歧义，编译器会以“错误的方式”解决。

考虑一下：

```
self::$function(); 
```

这是否意味着 PHP 应该调用存储在`static`属性中的回调`$function`，或者它应该调用名称为变量值的静态方法`$function`？

PHP 与后者一起使用，但范围内没有变量`$function`，首先导致通知，然后导致错误（`$function`计算结果为`null`，这不是字符串）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T23:13:09.003

如果您不想深入了解优先级和歧义的技术细节，简短的解释是`self::$function()`根据与 ; 相同的逻辑工作`$obj->$method()`。它试图调用 的变量函数`$function()`。`self`

# python - Python int 浮点舍入

> ID：15179897
> 
> 赞同：4
> 
> 时间：2013-03-02T21:56:48.383
> 
> 标签：python, casting, integer, rounding

在玩python时，我遇到了这个：

```
a = 1/(2.2 - 2)

print a       #prints out 5.0
print int(a)  #prints out 4 
```

我怀疑这个问题与二进制数表示有关（用二进制表示 1/5 就等于用十进制表示 1/3）。有人可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T21:59:05.987

你的怀疑是完全正确的。根本原因是 2.2 不能完全表示为`float`：

```
In [38]: '%.20f' % 2.2
Out[38]: '2.20000000000000017764' 
```

其余的由此而来：

```
In [45]: '%.20f' % (2.2 - 2)
Out[45]: '0.20000000000000017764'

In [46]: '%.20f' % (1 / (2.2 - 2))
Out[46]: '4.99999999999999555911' 
```

# ruby-on-rails - 我的 update_attribute 没有发出 UPDATE 查询，为什么？

> ID：15179898
> 
> 赞同：0
> 
> 时间：2013-03-02T21:56:57.027
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个不更新任何东西的模型。我一直在寻找是否有更深层次的日志可以指出我的问题但没有成功。

我这里的简单代码不会在我的“开发”日志中发出 UPDATE 查询（它应该在调用“update_attribute”时）。没有更新：

```
task sandbox: :environment do

  Rails.logger.level = Logger::DEBUG

  reminder = Reminder.create(ended: true)
  reminder.update_attribute(:ended, false)
end 
```

我尝试了另一个模型，我有一个“update_attribute”确实发出了一个“UPDATE”查询。

反正有调试这种东西吗？经过数小时的尝试，我对发生的事情一无所知。

# internet-explorer-9 - video-js 不适用于 IE 9

> ID：15179900
> 
> 赞同：2
> 
> 时间：2013-03-02T21:57:15.690
> 
> 标签：internet-explorer-9, video-processing

我在我的网站上使用 video-js 播放器：webplustest.com/videos.html。使用 Chrome 可以正常工作，但使用 IE9 时视频无法加载且无法播放。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-06-19T13:11:35.187

添加库 `<script src="http://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>`

# django - Django - 内联表单集在 POST 上总是有错误

> ID：15179901
> 
> 赞同：0
> 
> 时间：2013-03-02T21:57:27.537
> 
> 标签：django, django-forms

我有一个内联表单集：

```
OptionFormset = inlineformset_factory(App, AppOptions, can_delete=True, extra=1,
            fields = ['options', 'conditions']) 
```

提交表单时，我在模板中进行验证：

```
 {% if formset.errors %}
          <p style="color: red;">
              Please correct the error:
          {{ formset.errors }}
          </p>
      {% endif %} 
```

打印返回：

```
Please correct the error [{}, {}] 
```

很明显，form中没有错误，他们的formset.errors中也没有错误，错误大概是在视图中吧？

视图.py：

```
 def setAppOption(request, app_name):
      app_selected = App.objects.get(app_name=app_name, created_by=request.user)
      formset = OptionsFormSet(instance=fusionTable_selected)
      if request.method == 'POST':
          formset = OptionFormset(request.POST, instance=fusionTable_selected)
            if formset.is_valid():   
              formset.save()

      return render_to_response("ezApp/manage__Options.html", {'formset': formset}, context_instance=RequestContext(request)) 
```

模型.py

```
 class App(models.Model):
        layer_name = models.SlugField(max_length=50)

        def __unicode__(self):
            return self.layer_name

    class AppOptions(models.Model):
        app = models.ForeignKey(EzApp)
        condition = models.CharField('SQL Query Conditions', max_length=100, blank=True)
        option = models.CharField('SQL Query Conditions', max_length=100, blank=True 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T02:48:33.333

正确显示 formset.errors

```
{% for dict in formset.errors %}
    {% for error in dict.values %}           
        Please correct the error: {{ error }}
    {% endfor %}
{% endfor %} 
```

# xaml - Syncfusion TabControl 和 TabItems 数据绑定

> ID：15179903
> 
> 赞同：0
> 
> 时间：2013-03-02T21:57:42.167
> 
> 标签：xaml, windows-runtime, tabcontrol, syncfusion

我正在`TabControl`为 WinRT 使用 Syncfusion。工作正常，但是当我尝试将它绑定到一些无法理解的数据时，如何正确执行。我的代码是这样的：

```
<navigation:SfTabControl 
    DisplayMemberPath="FullName">
    <navigation:SfTabItem Name="tabItemPosition" Content="{Binding Position}">
        <navigation:SfTabItem.ContentTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding}"/>
            </DataTemplate>
        </navigation:SfTabItem.ContentTemplate>
    </navigation:SfTabItem> 
</navigation:SfTabControl> 
```

但它只显示标题，但没有出现内容。欢迎任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T04:00:29.180

我怀疑你喜欢在 TabItem 的标题中显示“FullName”，在 TabItem 的内容中显示“Position”。要同时装饰 Header 和 Content，我们必须分别使用 HeaderTemplate 和 ContentTemplate。

由于我们要使用 DataTemplates，我们不再需要“DisplayMemberPath”。按照下面的代码片段，它应该可以工作。

```
<navigation:SfTabControl TabStripPlacement="Left" Margin="0 60"
                             Grid.ColumnSpan="2" HorizontalAlignment="Stretch"
                             x:Name="ParticipantsList" >                        
        <!--For Header-->
        <navigation:SfTabControl.HeaderTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding FullName}" Style="{StaticResource HeaderTextStyle}"  
                           VerticalAlignment="Top"/>
            </DataTemplate>
        </navigation:SfTabControl.HeaderTemplate>

        <!--For Content-->
        <navigation:SfTabControl.ContentTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding Position}" Style="{StaticResource HeaderTextStyle}"  
                           VerticalAlignment="Top"/>
            </DataTemplate>
        </navigation:SfTabControl.ContentTemplate>
    </navigation:SfTabControl> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T19:03:16.027

页面代码如下：

```
<Page
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="using:voteme"
DataContext="{Binding Participants, RelativeSource={RelativeSource Self}}"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
xmlns:navigation="using:Syncfusion.UI.Xaml.Controls.Navigation"
xmlns:input="using:Syncfusion.UI.Xaml.Controls.Input"
x:Class="voteme.RateAll"
mc:Ignorable="d">
<Grid Style="{StaticResource LayoutRootStyle}">
    <Grid.RowDefinitions>
        <RowDefinition Height="140"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!-- Back button and page title -->
    <Grid Background="#FF939D46">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Button x:Name="backButton" Style="{StaticResource BackButtonLightStyle}" Margin="36"
                VerticalAlignment="Top" Click="backButton_Click"/>
        <StackPanel>
            <TextBlock x:Name="pageTitle" Foreground="White" Grid.Column="1" Text="{StaticResource AppName}" 
                    Style="{StaticResource PageHeaderTextStyle}" Margin="120 38" VerticalAlignment="Top"/>
        </StackPanel>
    </Grid>

    <Grid Grid.Row="1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid Grid.Column="1" Background="#FFEDEDEB" />
        <navigation:SfTabControl TabStripPlacement="Left" Margin="0 60"
                                 Grid.ColumnSpan="2" HorizontalAlignment="Stretch"
                                 x:Name="ParticipantsList"
                                 DisplayMemberPath="FullName">
            <navigation:SfTabItem>
                 <TextBlock Text="{Binding Position}" Style="{StaticResource HeaderTextStyle}"  VerticalAlignment="Top"/>
            </navigation:SfTabItem>
        </navigation:SfTabControl>
    </Grid>
</Grid> 
```

类代码（与 TabContent 和 TabItem 相关）是这样的：

```
public List<ParticipantRatesView> Participants = new List<ParticipantRatesView>();
foreach (var participant in _persons)
            {
                Participants.Add(
                        new ParticipantRatesView()
                            {
                                FullName = participant.FullName,
                                Position = participant.Position,
                                Email = participant.Email,
                                PersonId = participant.Id,
                                AverageRate = participant.TotalRate,
                                OfficeRate = ((Rates) _ratesAll.CurrentItem).OfficeRate,
                                WindowsRate = ((Rates) _ratesAll.CurrentItem).WindowsRate,
                                EmoRate = ((Rates) _ratesAll.CurrentItem).EmotionalRate,
                                CustRate = ((Rates) _ratesAll.CurrentItem).CustomerRate,
                                RateId = ((Rates) _ratesAll.CurrentItem).Id
                            });
             }
    ParticipantsList.ItemsSource = Participants; 
```

这种方式是 Syncfusion 推荐的，但他们根本没有记录 TabItem，标准方式效果不佳。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-03T03:09:12.073

试试这个：
删除`Content="{Binding Position}"`并`<navigation:SfTabItem`替换

```
 <navigation:SfTabItem.ContentTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding}"/>
        </DataTemplate>
    </navigation:SfTabItem.ContentTemplate> 
```

与`<TextBlock Text="{Binding Position}"/>`. 并假设“位置”变量是单值变量（不是数组）并且它在您的 DataContext 上可用。

# c# - 安装自定义 DNN 模块时出错

> ID：15179910
> 
> 赞同：2
> 
> 时间：2013-03-02T21:58:18.867
> 
> 标签：c#, dotnetnuke, dotnetnuke-module

我创建了一个自定义 DNN 模块，但安装时失败：

*发生严重错误。找不到文件“C:\inetpub\wwwroot\Customers\RevIndex\RevIndexDNN.Web\Install\Temp\hlivdv1q\Test.dnn”。*

以下是我采取的步骤：

1.  我用这个清单创建了一个名为 test.dnn 的模块：

[http://pastebin.com/qKVqNYEg](http://pastebin.com/qKVqNYEg)

我压缩了项目，它看起来像这样：

![在此处输入图像描述](../Images/2d907a82d844492b5757c91c24606095.png)

我将 zip 文件夹放在 Install/Modules 文件夹中。我去了主机>扩展，然后单击了管理。我选择了 Install/Modules/MyModule.zip 文件夹，我收到了这个错误：

发生严重错误。找不到文件“C:\inetpub\wwwroot\Customers\RevIndex\RevIndexDNN.Web\Install\Temp\hlivdv1q\Test.dnn”。

为什么它找不到我的清单？

我的网站作为本地系统运行，我从桌面上传了它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T05:27:02.413

很多时候，这有点误导。我将首先检查以确保 ASP.NET 工作进程能够写入站点的根目录和所有子文件夹。

这种假设的原因是，因为它知道它正在寻找 Test.dnn，它能够读取 zip，只是无法读取应该放在磁盘上的物理文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:32:23.960

转到主机/扩展页面，选择安装扩展向导并为您的模块上传 ZIP 文件（从您拥有的任何位置）

从那里您应该查看是否有任何错误，并希望获得更详细的问题日志。

# c++ - 如何通过存储在另一个变量中的名称来寻址变量（C++）

> ID：15179911
> 
> 赞同：-4
> 
> 时间：2013-03-02T21:58:27.657
> 
> 标签：c++

再会，

我想通过使用变量来存储其名称来引用函数中的结构。这有可能在 C++ 中做这样的事情吗？

当然，在进行任何调用（可能是全局的）之前，所有现有结构都将被声明和初始化，我将进行检查以确保仅引用现有结构。

我想要本着这种精神的东西：

```
struct StructName
{
...stuff
}a,b,c;

StructName a;
StructName b;
.
.
. 
```

等，包括设置所需的值（根据需要在初始化或代码中的其他地方）

然后我会从另一部分代码中调用这样的东西：

```
void myFunction(char someInput)
{
some stuff
some stuff
externalFunction(static parameter, static parameter, _someInput_, static parameter);
yet some other stuff
} 
```

其中 somInput 是 a、b 或 c。

请记住，我是 C 的初学者，几乎没有接受过正式的主题培训。

谢谢你。

编辑：如果只是我自己，我会为 someInput 使用 case switch，在每种情况下都直接引用结构，但是这部分代码是由非程序员自己提供结构的，我会向他提供结构初始化代码模板，他会将初始化代码添加到代码中的指定位置，修改允许名称列表并编译库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:04:35.707

您不能将 a`char`或 a `char const *`（运行时数据）转换为类型（编译时信息）。

**[编辑]**好吧，实际上你可以使用类似下面的代码，但由于它使用模板，它仍然只在编译时可用，所以你将无法传递函数参数，例如。

```
template < char C >
struct GetType;

template < >
struct GetType< 'a' > {
    typedef struct { int foo; } type; };

template < >
struct GetType< 'b' > {
    typedef struct { int bar; } type; };

GetType< 'a' >::type foo;
GetType< 'b' >::type bar; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T22:51:05.480

变量名称`disappear`作为 C 和 C++ 中编译步骤的一部分。

通常，有两种方案可以解决您所描述的问题类型：

1.  用户输入对应于特定的变量名称。
2.  您实际上并不想要变量的“名称”，而只需要一种将不同数据与代码的不同部分相关联的方法。

在第二种更简单的情况下，只需使用数组，并使用您想要的元素的索引作为关联正确数据的方式。

在第一种情况下，您可以使用`std::map<std::string, structname&>`. A 的`std::map`行为有点像数组，但它由模板参数中给出的第一种类型索引`std::map`- 所以在这种情况下，您可以`std::string`用作索引。

像这样的东西：

```
#include <map>
#include <iostream>
#include <string>

struct StructName
{
    int x;
};

std::map<std::string, StructName *> vars;

StructName a;
StructName b;

void registerVars()
{
    vars["a"] = &a;
    vars["b"] = &b;
}

int main()
{
    std::string v;

    registerVars();

    while(std::cin >> v)
    {
    std::cin.ignore(1000, '\n');

    if (vars.find(v) == vars.end())
    {
        std::cout << "No such variable" << std::endl;
    }
    else
    {
        vars[v]->x++;
        std::cout << "variable " << v << " is " << vars[v]->x << std::endl;
    }
    }
    return 0;
} 
```

# google-app-engine - 提供具有“image/png”内容类型的静态 PNG 文件，而不是“image/x-png”

> ID：15179915
> 
> 赞同：13
> 
> 时间：2013-03-02T21:58:47.767
> 
> 标签：google-app-engine, png, mime-types

我正在使用带有 Python 的谷歌应用程序引擎，并且有几个静态 .png 图像文件，但它们都以“image/x-png”内容类型提供。当我使用像 chrome 这样的浏览器并尝试查看这些图像时，这是一个问题，因为内容类型无法识别，这会迫使 chrome 将其下载为二进制文件，而不是显示图像。

如何让 App Engine 使用正确的“image/png”mime 类型来提供这些服务？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-02T22:35:36.227

假设您使用的是 Java，这通常在文件的`mime-mapping`部分中指定`web.xml`。参见例如[这里](https://developers.google.com/appengine/docs/java/config/appconfig#Changing_the_MIME_Type_for_Static_Files)或[这里](http://docs.oracle.com/cd/E13222_01/wls/docs81/webapp/web_xml.html#1017395)。

在你的情况下，我会尝试

```
 <mime-mapping>
        <extension>png</extension>
        <mime-type>image/png</mime-type>
 </mime-mapping> 
```

在 Python 中，您似乎应该使用适当的添加一些处理[程序](https://developers.google.com/appengine/docs/python/gettingstartedpython27/staticfiles)，例如（替换为您自己的and ）：`app.yaml``mime_type``url``static_dir`

```
handlers:
- url: /static/*.png
  static_dir: static
  mime_type: image/png 
```

# php - WordPress 联系表格

> ID：15179918
> 
> 赞同：1
> 
> 时间：2013-03-02T21:58:53.117
> 
> 标签：php, wordpress, forms, contact

我的 Wordpress 网站上有一个非常基本的联系表格（硬编码），但我无法正常工作。它通过 XAMPP 在本地运行良好，我确信这是我刚刚缺少的东西，但任何帮助将不胜感激。提前致谢！。我也在使用我创建的模板

```
<?php /* Template Name: contact */?>

<?php get_header(); ?>

<?php

//vars declared to store form input
$name=$email=$comment=$phone="";
//Error vars - to relay error message to the form 
$nameError=$emailError=$commentError="";
$error_message="";
$sentMessage="";
$status=0; //Will monitor if all fields have no errors and increment if so.

function sanitise_var($string){
    htmlentities($string);
    strip_tags($string);
    return stripslashes($string);
}

if(isset($_POST['submitted'])){

if($_POST['name']==""){ 
    $nameError="Please enter a name";
    $error_message="Oops, error in the form. Please check";

}

else {
    $name=$_POST['name'];
    ++$status;

}

if($_POST['email'] == "" || !preg_match("/^[a-z0-9_.-]*@[a-z0-9.-]+\.[a-z]{2,4}$/i", $_POST['email'])){ 
    $error_message="Oops, error in the form. Please check";
    $emailError="Please enter a valid email";

}

else{
    $email=$_POST['email'];
    ++$status;
}

if(!$_POST['phone']=="") $phone=$_POST['phone'];

if($_POST['comment']==""){ 
    $error_message="Oops, error in the form. Please check";
    $commentError="Please enter a message";
}

else{
    $comment=$_POST['comment'];  
    ++$status;

 }

}//submitted if statement

if($status==3 && $_POST['submitted']){ 
    $sentMessage="From: $name, email: $email, Phone: $phone, Comment: $comment";
    wp_mail("mathornley@gmail.com", "From Android Scoop contact form", $sentMessage);
    echo "Thanks, your email was sent successfully!";
}

else{

echo<<<SOQ

<div class="entry-content">         

    <h1 class="entry-title">Contact</h1>

        <p class="contact">
            If you have a query drop us a line using the form below. We're always  happy to hear from people with ideas for posts and content they'd like to           feature or maybe write about. Or maybe you just have some feedback you'd like to share with us. Why not just swing by and say hello. 
        </p>       
        <p class="requiring">* Denotes required fields</p>       

        <div class="form_left">     

    <form action="/contact/" method="POST">
                <p><label>Name:</label><input type="text" name="name" value="$name"/></p> 
                <p class="error">$nameError</p> 
                <p><label>Email</label><input type="text" name="email" value="$email"/></p>
                <p class="error">$emailError</p> 
                <p><label>Phone:</label><input type="text" name="phone" value="$phone"/></p> 
                <input type="hidden" name="submitted" value="yes"/>
                <input type="submit" value="Send your message"/>                        
        </div>

        <div class="form_right">        
                <p><label>Message:</label><br/><textarea name="comment" rows="20" cols="20">$comment</textarea></p>
                <p class="error">$commentError</p> 
            </form>
        </div>
</div> 
```

质量保证；

```
}
?> 

<?php get_footer();?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T22:50:25.077

尝试将空白值用于以下操作：

```
<form action="" method="POST"> 
```

如果这不起作用，请尝试将第一个输入字段的名称参数重命名为其他名称，例如：

```
<input type="text" name="myname" value="$name"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T22:02:54.617

我不知道 wordpress，但随着一般 PHP 规则的发展，根据您在评论中回复我的内容，错误就在这里

```
<form action="/contact/" method="POST">
              ----^---- 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-03-18T19:39:21.910

为什么不使用一些现成的 WordPress 联系表格？例如，[Contact Form 7](https://wordpress.org/plugins/contact-form-7/)非常好。

Contact Form 7 是一个开源软件，可以管理多个联系表单，而且您可以通过简单的标记灵活地自定义表单和邮件内容。该表单支持基于 Ajax 的提交、CAPTCHA、Akismet 垃圾邮件过滤等。

**安装**

*   将整个 contact-form-7 文件夹上传到 /wp-content/plugins/ 目录。
*   通过 WordPress 中的“插件”菜单激活插件。
*   您将在 WordPress 管理面板中找到“联系”菜单。
*   创建一个联系表格，复制它，将它`url`粘贴到任何你想要的地方。
*   联系表格将准确显示在其位置。

如果你想要一个例子，你可以[看看这个网站](https://www.onlinetoolsexpert.com)看看它的外观和感觉。

# c++ - ifstream::open() 函数使用字符串作为参数

> ID：15179924
> 
> 赞同：6
> 
> 时间：2013-03-02T21:59:35.543
> 
> 标签：c++, string, fstream, ifstream

我正在尝试制作一个程序来询问他们用户想要读取的文件，当我尝试时`myfile.open(fileName)`我得到错误：“没有匹配的函数调用`std::basic_ifstream<char, std::char_traits<char> >::open(std::string&)'`”在该行。

```
string filename;
cout<<"Enter name of file: ";
cin>>filename;
ifstream myFile;
myFile.open(filename); //where the error occurs.
myFile.close(); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-02T22:00:32.093

在以前版本的 C++ (C++03) 中，第一个参数`open()`仅采用 a ，而不是. 调用它的正确方法是：`const char *``std::string`

```
myFile.open(filename.c_str()); 
```

不过，在当前的 C++ (C++11) 中，该代码很好，所以看看你是否可以告诉你的编译器启用对它的支持。

# php - 如何使用 php 动态更新站点地图？

> ID：15179925
> 
> 赞同：0
> 
> 时间：2013-03-02T21:59:50.193
> 
> 标签：php, xml, sitemap

我有一个动态站点，其中不断生成帖子，我对其进行了编码，因此每次添加新帖子时，它都会将站点地图 url 条目附加到 sitemap.xml 文件的底部。

```
 $lastID = $db->lastInsertId();
    $file = 'sitemap.xml';
    $current = file_get_contents($file);
    $current .= "<url>
    <loc>http://website.net/viewpost.php?ID=".$lastID."</loc>
    <changefreq>monthly</changefreq>
    </url>";
    file_put_contents($file, $current); 
```

这可行，但 xml 文件 urlset 中的结束标记需要位于文件末尾。因此，当我附加此数据时，它会在 urlset 之后进行，即使我将其添加到字符串中，也会有多个结束标记。我如何更新文件，使其不在结束标记之后。每次都重新生成整个站点地图是可行的，但看起来工作量很大，因为目前有近 100 个页面，并且需要查询多个表来获取数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:02:35.467

这是一个用于在另一个元素之前、之后或内部插入元素的简单函数。

```
<?php 

public function myInsertNode($newNode, $refNode, $insertMode=null) {

    if(!$insertMode || $insertMode == "inside") {

        $refNode->appendChild($newNode);

    } else if($insertMode == "before") {

        $refNode->parentNode->insertBefore($newNode, $refNode);

    } else if($insertMode == "after") {

        if($refNode->nextSibling) {
            $refNode->parentNode->insertBefore($newNode, $refNode->nextSibling);
        } else {
            $refNode->parentNode->appendChild($newNode);
        }      

    }

}

?> 
```

# web-applications - 为使用 webapp+webkit 创建的 nativeapp 设置 localstorage 的大小

> ID：15179929
> 
> 赞同：0
> 
> 时间：2013-03-02T22:00:04.880
> 
> 标签：web-applications, cross-platform, local-storage

我想创建一个游戏，不想考虑平台/操作系统。所以我想是否有可能创建一个 webapp（html5、css 和 js）并包装像 webkit 这样的浏览器引擎来为不同的操作系统（Linux、IOS、Android、Windows、Macosx、Bada、Windows Phone）创建一个本机应用程序。 ..)。

如果我使用 QT+webkit 创建例如“浏览器”，是否可以设置 localStorage？还是我只有 5 MB 的 localStorage？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T18:14:30.097

您是否尝试过 Phonegap (Cordova) [Mobile Web App] ？ [http://cordova.apache.org/](http://cordova.apache.org/)

PhoneGap 是一个免费的开源框架，允许您使用标准化的 Web API 为您关心的平台创建移动应用程序。

您可以使应用程序独立于操作系统，实际上您可以使用 HTML、CSS 等以及用于多个操作系统的嵌入式应用程序，例如：Apple iPad/iPhone、Android、Bada、Windows 8、Blackberry 等（但文档没有提及Linux）。

您只需编写一次代码并部署在我所说的所有最后一个操作系统上。

好吧，有了 5 MB 的存储限制，我可以说在 Android OS (4.1) 中我没有 5 MB 的限制，因为我管理 5-10MB 的数据库，并且可以很好地管理超过 70000 到 100000 个寄存器。

如果您计划将 webapp（HTML、CSS 等）与本地存储数据库一起使用，例如我对 Chrome 的 5MB 限制没有问题。

希望对您的决定有所帮助。

# php - While 循环呈现意外结果

> ID：15179938
> 
> 赞同：0
> 
> 时间：2013-03-02T22:01:10.657
> 
> 标签：php, pdo, while-loop

我是 PHP 中的 OOP 新手，我在以我想要的方式显示结果时遇到了一些麻烦。我的查询确实收集了所有结果，问题是在尝试添加`<br />`标签进行格式化时。我得到了我的结果，然后是一些中断标签，然后是结果和不同数量的中断标签等等。我希望从我编码的方式来看，每个结果后面都应该有一个`<br />`，但每个结果后面都有不同数量的`<br />`标签。任何意见将是有益的。这是我的代码：

```
public function getForumActivity(){
        $user = $this->uid;
        $pdo = $this->db;
        $stmt = $pdo->prepare("SELECT title FROM board WHERE user=:user");
        $stmt->bindValue(':user',$user,PDO::PARAM_STR);
        try{
                $title = "";
            $stmt->execute();
            while($row = $stmt->fetch(PDO::FETCH_ASSOC)){
                  $title .= $row['title']."<br />";
               }
               return $title;

        }
        catch(PDOException $e){
            echo $e->getMessage();
        }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T22:06:49.923

我假设您数据库中的某些行的标题值为空；

# android - Android：ListView 不更新

> ID：15179946
> 
> 赞同：0
> 
> 时间：2013-03-02T22:02:01.770
> 
> 标签：android, android-listview, android-adapter

我的程序由两个页面的 ViewPager 组成。这些页面之一具有列表视图。***onResume***方法然后我的应用程序返回到前台我想通过向列表中添加新项目来用新数据刷新我的列表。

```
 @Override
    public void onResume() {
        super.onResume();       

        if(wasPaused) {             
            int currentPage = getCurrentItem();

            if(LIST_PAGE == currentPage) {
                final CustomListAdapter listAdapter = pageAdapter.getListAdapter();

                if(null != listAdapter && !listAdapter.isEmpty()) {
                    CustomObject last = listAdapter.getItem(0);
                    Long someLastValue = last.getDate();

                    final List<CustomObject> recentData = DataSource.getInstance(this).getList(someLastValue, null);

                    if(!recentData.isEmpty()) {
                        adapter.getListAdapter().addAll(recentCalls);
                        adapter.getListAdapter().notifyDataSetChanged();            
                    }
                }           
            }
        }
    } 
```

在***onResume***执行之后，我的列表视图没有更新，尽管在***addAll***方法之后有新数据和适配器增加。我做错了什么？

编辑：我为我的列表创建了自定义 ArrayAdapter。我应该添加到 CustomArrayAdapter 还是 CustomArrayAdapter 的 ArrayList？

# php - jquery ajax 文件上传

> ID：15179951
> 
> 赞同：-5
> 
> 时间：2013-03-02T22:02:39.007
> 
> 标签：php, jquery, html, ajax

我需要一个异步文件上传器。不，我不是在寻找插件。我只是在寻找一个简单的 jquery+AJAX 上传器，它将异步上传文件。我检查了谷歌，但没有发现任何有用的东西。

这是我的html：

```
 <form method="post" enctype="multipart/form-data" "> 

File Name:<input type="text" name="name"/> <br/><br/>

Browse: <input type="file" name="file"/> <br/><br/> 

<input type="submit" id='button' Value="Upload the video file" name="submit"/>

 </form> 
```

我的PHP代码：

```
<?php
if(isset($_POST["submit"]))
{
$filename=$_POST["name"];
$ext = pathinfo($_FILES['file']['name'], PATHINFO_EXTENSION);
$size=$_FILES["file"]["size"];
$size=$size/1000000;
$size=round($size, 2);
$size.="MB";
$namewithext=$filename." (".$size.")".".".$ext;
  if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br>";
    }
  else
    {
    if (file_exists("file/" . $_FILES["file"]["name"]))
      {
      echo "<script> alert('".$_FILES["file"]["name"] . " already exists. "."');</script>";
      }
    else
      {

      move_uploaded_file($_FILES["file"]["tmp_name"],
      "file/" . $namewithext);
      echo "<script> alert('"."success"."');</script>";

      }
    }
}
  else
  {

  }
?> 
```

我没有使用 jquery 的经验。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T23:49:58.857

不可避免地，您将不得不对您的定义使用“插件”，但是......

**这是个好消息：**

blueimp 提供了一个非常好、易于使用、易于编码的 jQuery-File-Upload，您可以[在此处下载](https://github.com/blueimp/jQuery-File-Upload#download)。

**你想要它简单：**

由于您正在寻找它是一个简单的、基本的 jQuery... 您可以[在此处查找](https://github.com/blueimp/jQuery-File-Upload/wiki/Basic-plugin)有关您正在寻找的内容的基本教程。

**边注：**

它与其说是一个站点插件，不如说是一个 javascript 库，可以为“基本文件 jQuery 上传器”做你想做的事情。

**其他选项：**

如果不上传 javascript 库，您唯一的其他选择是使用一个 iFrame，您可以将上传的 iFrame 发布到该 iFrame，它可以模拟 jQuery，您无需重新加载页面即可上传文件。

# php - 使用 PHP 作为 'file=' 参数将视频文件从远程 URL 传递到 jwplayer

> ID：15179959
> 
> 赞同：2
> 
> 时间：2013-03-02T22:03:28.893
> 
> 标签：php, curl, cross-domain, jwplayer, remote-server

我正在尝试直接播放位于远程服务器上的视频（本示例中为 www.nowvideo.eu），使用 curl() 和 preg_match() 获取视频直接 URL，然后使用[此处](https://stackoverflow.com/questions/10991443/curl-get-remote-file-and-force-download-at-same-time)找到的下载脚本直接呈现.php 文件作为视频文件本身。

下载视频有效，但是当我尝试向 jwplayer 添加参数 'file=video_file.php' 时出现此错误：“***任务队列在第 5 步失败：由于跨域策略限制，无法加载播放列表。*** ”我有一个跨域.xml 文件，它被设置为允许从所有域访问，但我不知道为什么它甚至很重要，因为 video_file.php 与 play.php 位于同一域（其中包含 jw 播放器代码）。

这是**video_file.php**的代码：

```
<?php
$url = 'http://www.nowvideo.eu/video/qdu0vx7m3m3xd';
$content = curl($url);
preg_match('%video/(.[^/]*+)%', $url, $videoID);
preg_match('/filekey="(.[^\"]*?)"/',$content,$key);
$key = str_replace('"','',$key[0]);
$video_data = 'http://www.nowvideo.eu/api/player.api.php?user=undefined&pass=undefined&file='.$videoID[1].'&key='.$key;
$content_key = curl($video_data);
preg_match('/url=(.[^&]*+)/',$content_key,$file);
$file = str_replace('url=','',$file[0]);
download($file,2000);

/*
Set Headers
Get total size of file
Then loop through the total size incrementing a chunck size
*/
function download($file,$chunks){
    set_time_limit(0);
    header('Content-Description: File Transfer');
    header('Content-Type: video/x-flv');
    header('Content-disposition: inline; filename='.basename($file));
    header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
    header('Expires: 0');
    header('Pragma: public');
    $size = get_size($file);
    header('Content-Length: '.$size);

    $i = 0;
    while($i<=$size){
        //Output the chunk
        get_chunk($file,(($i==0)?$i:$i+1),((($i+$chunks)>$size)?$size:$i+$chunks));
        $i = ($i+$chunks);
    }

}

function curl($url){  
    $ch = curl_init();  
    curl_setopt($ch, CURLOPT_URL, $url);  
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);  
    $result = curl_exec($ch);  
    curl_close($ch);  
return $result;
}

//Callback function for CURLOPT_WRITEFUNCTION, This is what prints the chunk
function chunk($ch, $str) {
    print($str);
    return strlen($str);
}

//Function to get a range of bytes from the remote file
function get_chunk($file,$start,$end){
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $file);
    curl_setopt($ch, CURLOPT_RANGE, $start.'-'.$end);
    curl_setopt($ch, CURLOPT_BINARYTRANSFER, 1);
    curl_setopt($ch, CURLOPT_WRITEFUNCTION, 'chunk');
    $result = curl_exec($ch);
    curl_close($ch);
}

//Get total size of file
function get_size($url){
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_HEADER, true);
    curl_setopt($ch, CURLOPT_NOBODY, true);
    curl_exec($ch);
    $size = curl_getinfo($ch, CURLINFO_CONTENT_LENGTH_DOWNLOAD);
    return intval($size);
}
?> 
```

这是**play.php**的代码：

```
<html>
<head>
</head>
<body>
<object id="flashplayer" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="830" height="490">
<param name="movie" value="http://example.com/player.swf">
<param name="allowFullScreen" value="true">
<param name="allowScriptAccess" value="always">
<param name="FlashVars" value="file=http://example.com/video_file.php&autostart=true&smoothing=true&stretching=exactfit">
<embed name="flashplayer" src="http://example.com/player.swf" flashvars="file=http://example.com/video_file.php&autostart=true&smoothing=true&stretching=exactfit" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="830" height="490">
</object>
</body>
</html> 
```

**crossdomain.xml**的代码（位于根目录）：

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM
"http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
<allow-access-from domain="*" secure="false"/>
<allow-http-request-headers-from domain="*" headers="*" secure="false"/>
</cross-domain-policy> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:55:18.453

改变：

&拉伸=精确匹配

到：

&stretching=exactfit&provider=视频

现在，这将在 JW Player 中工作（我假设您在这里使用 JW5）。

-伊森

# c - 是否可以重复getopt

> ID：15179963
> 
> 赞同：9
> 
> 时间：2013-03-02T22:04:11.127
> 
> 标签：c, getopt

我正在尝试使用内置命令创建一个基本 shell，但我遇到了一些关于 getopt 的问题。这是输出（使用 valgrind）：

```
$ mkdir -p foo/bar
mkdir
-p
foo/bar
FLAGON
$ mkdir -p foo/test
mkdir
-p
foo/test
==15377== Invalid read of size 1
==15377==    at 0x5201BBE: _getopt_internal_r (in /usr/lib/libc-2.17.so)
==15377==    by 0x5202CEA: _getopt_internal (in /usr/lib/libc-2.17.so)
==15377==    by 0x5202D37: getopt (in /usr/lib/libc-2.17.so)
==15377==    by 0x40351A: shell_ns_cmd_mkdir (shell.c:542)
==15377==    by 0x403AB4: normal_shell_cb (shell.c:610)
==15377==    by 0x402E8E: shell_mainloop (shell.c:402)
==15377==    by 0x401B67: main (main.c:52)
==15377==  Address 0x54e0912 is 2 bytes inside a block of size 3 free'd
==15377==    at 0x4C2AD3C: free (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==15377==    by 0x402C93: shell_mainloop (shell.c:384)
==15377==    by 0x401B67: main (main.c:52)
==15377== 
$ 
```

这是来源（剪辑）：

```
for (i = 0; i < argc; i++) {
    puts(argv[i]);
}
while ((c = getopt(argc, argv, "p")) != -1) {
    switch (c) {
        case 'p':
            puts("FLAGON");
            mkparents = true;
            break;
        case '?':
            fprintf(stderr, "invalid option -- %c", optopt);
            ret = 127;
            goto end;
            break;
    }
} 
```

所以它第一次运行它（`mkdir -p`）识别它（`-p`），它第二次运行，它没有。有任何想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-02T22:08:24.973

如果要扫描多个向量，则需要`getopt`通过设置`optind`为 1 来重置。

> 变量 optind 是要处理的 argv[] 向量的下一个元素的索引。**它应该由系统初始化为 1**，并且 getopt() 应该在它完成 argv[] 的每个元素时更新它。

如果设置`optind`为 1 不起作用，也尝试一下`0`，我想我记得在某处读过它。

# r - Hmisc 包将原始代码从 0:1 更改为 1:2

> ID：15179966
> 
> 赞同：2
> 
> 时间：2013-03-02T22:05:02.753
> 
> 标签：r, label, levels, hmisc

我使用 Hmisc 对因子名称和变量名称进行签名，非常方便。但是我发现这里有一个问题是代码

```
a <- c(1,0,1,0,1,0,1,0,1,0)
b <- c("a","b","a","b","a","b","a","b","a","b")
df.new <- data.frame(a,b)
library(Hmisc)
df.new.1 <- upData(df.new,lowernames=TRUE,a=factor(a,labels=c("No","Yes")),b=factor(b,labels=c("No","Yes"))) 
```

对于字符向量，给出以下编码和标签

```
str(df.new.1$b)

 Factor w/ 2 levels "No","Yes": 1 2 1 2 1 2 1 2 1 2 
```

，这很好。

当您在第一种情况下使用 str 查找编码和标签时，它会给出

```
str(df.new.1$a)

 Factor w/ 2 levels "No","Yes": 2 1 2 1 2 1 2 1 2 1 , 
```

这很奇怪！原来的 0 1 编码不见了。我该如何解决这个问题？我想保留我原来的 0 1 变量用于以后的回归目的。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T22:17:09.757

这与`Hmisc`. 这是在基础 R 中创建因子的方式：

```
R> a <- c(1,0,1,0,1,0,1,0,1,0)
R> factor(a,labels=c("No","Yes"))
 [1] Yes No  Yes No  Yes No  Yes No  Yes No 
Levels: No Yes
R> str(factor(a,labels=c("No","Yes")))
 Factor w/ 2 levels "No","Yes": 2 1 2 1 2 1 2 1 2 1 
```

如`?factor`帮助页面中所述：

> 'factor' 返回一个 '"factor"' 类的对象，它具有一组长度为 'x' 的整数代码，具有模式 'character' 的 '"levels"' 属性和唯一性 ('!anyDuplicated(.)')条目。如果参数 'ordered' 为真（或使用 'ordered()'），则结果具有类 'c("ordered", "factor")'。

因此，当您`factor`在变量上使用时`a`，0 和 1 值将被您给出的“是”和“否”替换。在内部，R 在计算事物时不会操纵级别，而是它赋予它们的底层整数值。这就是为什么您会在 的输出中看到一系列 1 和 2 值`str`。这些整数值供 R 内部使用，您不应该真正打扰它们。

如果您想跟踪您的 0 和 1 值，您可以保留它们，例如通过将变量保留为整数，或者，如果您确实需要一个因子，您可以使用“0”和“1”定义一个水平：

```
R> factor(a,labels=c("0","1"))
 [1] 1 0 1 0 1 0 1 0 1 0
Levels: 0 1 
```

请注意，即使在这种情况下，您仍然会在使用 1/2 时获得基础值`str`：

```
R> str(factor(a,labels=c("0","1")))
 Factor w/ 2 levels "0","1": 2 1 2 1 2 1 2 1 2 1 
```

另一种方法是直接将您的级别从“是”、“否”更改为“0”、“1”。您可以使用以下`levels()`功能来做到这一点：

```
R> v <- factor(a,labels=c("No","Yes"))
R> v
 [1] Yes No  Yes No  Yes No  Yes No  Yes No 
Levels: No Yes
R> levels(v) <- c("0","1")
R> v
 [1] 1 0 1 0 1 0 1 0 1 0
Levels: 0 1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T22:36:12.937

正如朱巴的回答所解释的，这是因素起作用的预期方式。但是，如果您确实需要描述性因子标签和原始数值，则可以将值添加为因子的属性，例如，

```
> a <- c(1,0,1,0,1,0,1,0,1,0)
> tmp <- a
> a <- factor(a, labels=c("No","Yes"))
> attr(a, "values") <- tmp
> a
 [1] Yes No  Yes No  Yes No  Yes No  Yes No 
attr(,"values")
 [1] 1 0 1 0 1 0 1 0 1 0
Levels: No Yes
> str(a)
 Factor w/ 2 levels "No","Yes": 2 1 2 1 2 1 2 1 2 1
 - attr(*, "values")= num [1:10] 1 0 1 0 1 0 1 0 1 0
> attributes(a)$values
 [1] 1 0 1 0 1 0 1 0 1 0
> 
```

# html - 仅使用 HTML5 和 CSS3 更改正文背景颜色 ..？

> ID：15179968
> 
> 赞同：1
> 
> 时间：2013-03-02T22:05:03.700
> 
> 标签：html, css, colors, transition

是否可以实现与此处相同的效果：[www.lutmedia.com](http://www.lutimedia.com/index.php)只需使用 CSS3 和 HTML5 ......而不是 jquery ......？将鼠标悬停在列表项链接上时，正文背景颜色会发生变化..？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:41:45.680

是的，您可以使用纯 CSS 获得类似的效果，但它不会是主体更改背景，而是该菜单中的最后一个列表项，它具有`position: fixed`并覆盖整个页面。

# [*快速演示*](http://codepen.io/thebabydino/pen/vmfyw)

相关**HTML**：

```
<ul class='menu'>
  <li><a href='#'>contact</a></li>
  <li><a href='#'>blog</a></li>
  <!-- and so on, menu items -->
  <li class='bg'></li>
</ul> 
```

相关**CSS**：

```
.menu li { display: inline-block; }
.menu li:first-child a { color: orange; }
.menu li:nth-child(2) a { color: lime; }
/* and so on for the other menu items */
.menu:hover li a { color: black; }
.menu li a:hover { color: white; }
.bg {
  position: fixed;
  z-index: -1;
  top: 0; right: 0; bottom: 0; left: 0;
  background: dimgrey;
  transition: .5s;
  pointer-events: none;
}
.menu li:first-child:hover ~ .bg { background: orange; }
.menu li:nth-child(2):hover ~ .bg { background: lime; }
/* and so on for the other menu items */ 
```

# css - CSS：直接后代选择器。它选择不是直接子元素的元素

> ID：15179969
> 
> 赞同：0
> 
> 时间：2013-03-02T22:05:08.540
> 
> 标签：css, css-selectors

css(>) 中的直接子选择器选择直接后代并将颜色传递给它们，但是当涉及到文本装饰时，它也会选择其他元素。怎么会？

[http://codepen.io/anon/pen/dDJmE](http://codepen.io/anon/pen/dDJmE)

对于颜色，我看到它只选择直接后代，但为什么文本装饰的行为不正确？我错过了什么？

CSS

```
li {
  text-decoration: none;
  color: black;
}
ol.numbers > li {
  text-decoration: underline;
  color: red;
} 
```

HTML

```
 <ol class="numbers">
    <li> First! </li>
    <li> Second! 
       <ul>
        <li> hehe </li>
        <li> huhu 
          <ol>
            <li> nested! </li>
          </ol>
         </li>
      </ul>
    </li>
    <li> Third! </li>
    <li> Fourth! 
      <ol>
       <li> oh lala </li>
      </ol>
    </li>

   </ol> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:22:03.823

在您的标记中：

```
<div>

  <ol class="numbers">
    <li> First! </li>
    <li> Second! 
       <ul>
        <li> hehe </li>
        <li> huhu 
          <ol>
            <li> nested! </li>
          </ol>
         </li>
      </ul>
    </li>
    <li> Third! </li>
    <li> Fourth! 
      <ol>
       <li> oh lala </li>
      </ol>
    </li>

   </ol>

  <ol class="letters">
    <li> A </li>
    <li> B </li>
  </ol> 
```

（非特定的）`ol`和相应`li`的子级只是应用于 any 中的任何文本内容的样式主题`ol.numbers>li`。您必须覆盖未指定子级`ol`和`li`s 继承的样式。您可以将其`ol.numbers>li li`用作选择器。

*添加*

似乎我对 text-decoration 与其他文本样式机制不一致的说法是正确的：[如何让这个 CSS text-decoration override 起作用？](https://stackoverflow.com/questions/1823341/how-do-i-get-this-css-text-decoration-override-to-work)

你将不得不以不同的方式解决这个问题。我建议用适当的标签（`p`s、`span`s 等）包装你的文本，并在 CSS 中专门处理它们以获得所需的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:10:58.837

这是由于 CSS 应用样式的顺序。 `ol.numbers > li`比 更具体`li`。所以这种风格优先。

# java - 在 Java 中使用 readlines 时忽略标签

> ID：15179971
> 
> 赞同：0
> 
> 时间：2013-03-02T22:05:29.703
> 
> 标签：java, text, readline

假设您有一个包含以下内容的 txt 文件：

```
<tag><info>George 34 Washington Professor 

Alexander 22 London Student

Jessica 18 Moscow Student<info><tag> 
```

当您使用 readline 从文本文件中提取参数时，如何忽略标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:28:36.437

正则表达式有什么问题？

```
Scanner s = new Scanner(new File("file.txt"));
while (s.hasNext())
{
  String line = s.nextLine().replaceAll("<[^>]*>", "");
  System.out.println(line);
} 
```

但是，上述方法不适用于跨多行拆分的标签，您必须做一些更复杂的事情：

```
Scanner s = new Scanner(new File("file.txt"));
boolean inTag = false;
while (s.hasNext())
{
  String lineTemp = s.nextLine();
  for (char c: line.toCharArray())
  {
    switch (c)
    {
      case '<': inTag = true; break;
      case '>': inTag = false; break;
      default:
        if (!inTag)
          sb.append(c);
    }
  }
  String line = sb.toString();
  System.out.println(line);
} 
```

除了指示标签的开始和结束之外，上述任何一个都没有说明出现`<`和任何地方。`>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T02:55:13.127

您可以使用正则表达式从行中删除标签

```
String line = line.replaceAll("<.+?>", ""); 
```

# algorithm - 以变 化的频率产生正弦波

> ID：15179972
> 
> 赞同：0
> 
> 时间：2013-03-02T22:05:32.670
> 
> 标签：algorithm, audio, signal-processing, trigonometry

我正在使用以下函数生成正弦波以在我的音频应用程序中播放：

```
public double NextSample(double frequency)
{
    Math.Sin(2.0 * Math.PI * frequency * position++ / sampleRate);
} 
```

其中'位置'只是已请求的样本总数（因此'位置'除以'sampleRate'代表当前时间）。

只要传递给它的频率保持不变，该函数就会产生预期的结果。但是，例如，如果我尝试在频率之间进行扫描，结果会很奇怪。我无法真正描述它，只能说当频率发生变化时，函数的输出听起来不像传递给它的频率。

谁能解释一下？

编辑：为了将来参考，这里是解决方案：

```
public double NextSample(double frequency)
{
    Math.Sin(phase += 2 * Math.PI * frequency / sampleRate);
} 
```

# javascript - 瓷砖之间的平滑过渡

> ID：15179975
> 
> 赞同：1
> 
> 时间：2013-03-02T22:06:24.360
> 
> 标签：javascript, jquery, html, canvas

正如您在此[JSFiddle](http://www.jsfiddle.net/kmHZt/10/)中看到的，当您使用箭头键移动红色方块时，图块之间的过渡非常不稳定，看起来不太好。

我想知道是否有一种方法可以在瓷砖之间进行平滑过渡，使其看起来像一个平滑的运动？

```
var canvas, context, board, imageObj, tiles, board, display;
var NUM_OF_TILES = 2;

// viewport
var vX = 0,
    vY = 0,
    vWidth = 15,
    vHeight = 10;

var playerX = 0,
    playerY = 0;

var worldWidth = 29,
    worldHeight = 19;

function loadMap(map) {
    if (map == 1) {
        return [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], [0, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 0], [0, 1, 1, 2, 1, 1, 1, 1, 1, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 0], [0, 1, 1, 2, 1, 1, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 0], [0, 1, 1, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 0], [0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 2, 1, 1, 0], [0, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 2, 1, 2, 1, 1, 1, 2, 1, 1, 0], [0, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 2, 1, 1, 0], [0, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 2, 1, 1, 0], [0, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 0], [0, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 0], [0, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 2, 2, 1, 1, 2, 1, 1, 0], [0, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 1, 0], [0, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 0], [0, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 1, 1, 1, 1, 0], [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0], [0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]];
    }
}

$(document).ready(function() {

    canvas = document.getElementById("canvas");
    context = canvas.getContext("2d");

    canvas.tabIndex = 0;
    canvas.focus();
    canvas.addEventListener('keydown', function(e) {
        console.log(e);
        var key = null;
        switch (e.which) {
        case 37:
            // Left
            if (playerX > 0) playerX--;
            break;
        case 38:
            // Up
            if (playerY > 0) playerY--;
            break;
        case 39:
            // Right
            if (playerX < worldWidth) playerX++;
            break;
        case 40:
            // Down
            if (playerY < worldHeight) playerY++;
            break;
        }
        // Okay! The player is done moving, now we have to determine the "best" viewport.
        // Ideally the viewport centers the player,
        // but if its too close to an edge we'll have to deal with that edge

        vX = playerX - Math.floor(0.5 * vWidth);
        if (vX < 0) vX = 0;
        if (vX+vWidth > worldWidth) vX = worldWidth - vWidth;

        vY = playerY - Math.floor(0.5 * vHeight);
        if (vY < 0) vY = 0;
        if (vY+vHeight > worldHeight) vY = worldHeight - vHeight;

        draw();
    }, false);

    var board = [];

    canvas.width = 512;
    canvas.height = 352;

    board = loadMap(1);
    imageObj = new Image();
    tiles = [];

    var loadedImagesCount = 0;
    for (x = 0; x <= NUM_OF_TILES; x++) {
        var imageObj = new Image(); // new instance for each image
        imageObj.src = "http://mystikrpg.com/canvas/img/tiles/t" + x + ".png";

        imageObj.onload = function() {
            // console.log("Added tile ... "+loadedImagesCount);
            loadedImagesCount++;
            if (loadedImagesCount == NUM_OF_TILES) {
                // Onces all tiles are loaded ...
                // We paint the map
                draw();
            }
        };
        tiles.push(imageObj);
    }

    function draw() {
        context.clearRect(0,0,canvas.width, canvas.height);
        for (y = 0; y <= vHeight; y++) {
            for (x = 0; x <= vWidth; x++) {
                theX = x * 32;
                theY = y * 32;
                context.drawImage(tiles[board[y+vY][x+vX]], theX, theY, 32, 32);
            }
        }
        context.fillStyle = 'red';
        context.fillRect((playerX-vX)*32, (playerY-vY)*32, 32, 32);
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:40:47.497

我玩了一下，得到了一些工作：

```
 case 39:
       // Right
       if (playerX < worldWidth) {
           var start = playerX;
           var end   = Math.round(playerX + 1);
           $({ i : start }).animate({ i: end}, {
                duration: 400,
                step: function(now) {
                   playerX = now;
                   draw();
                }
            });
        }
        break; 
```

我使用 jquery animate 函数在值之间进行插值。我意识到draw函数只被调用一次，为了得到一个动画我不得不每一步都调用它。

为了避免重新定心时的错误，`Math.round()`也在那里使用。

```
 vX = Math.round(playerX) - Math.floor(0.5 * vWidth);
    if (vX < 0) vX = 0;
    if (vX+vWidth > worldWidth) vX = worldWidth - vWidth;

    vY = Math.round(playerY) - Math.floor(0.5 * vHeight);
    if (vY < 0) vY = 0;
    if (vY+vHeight > worldHeight) vY = worldHeight - vHeight; 
```

当然，您必须做额外的工作，例如起点和终点可能会以这种方式变化。正如建议的那样，您可能应该为您的字符使用像素位置而不是图块。但我不知道你的意图。

您可以通过检查瓷砖是否处于“完整”位置来避免卡在 keydown 上

```
if (playerY < worldHeight && playerY % 1 == 0) {... 
```

# fabricjs - 如何更改fabric.Image对象属性src的图像？

> ID：15179976
> 
> 赞同：15
> 
> 时间：2013-03-02T22:06:32.013
> 
> 标签：fabricjs

`fabric.Image`如果我已经制作了动画，如何更改对象属性 src 的图像？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-03T08:13:47.793

您可以使用`.setElement()`来更改图像。

例如，假设您有一个名为`myFabricObect`.

然后，如果你`<img id="newImage">`的页面上有一个 html 图像元素，你可以像这样加载你`myFabricObject`的`"newImage"`：

```
myFabricObject.setElement(document.getElementById("newImage")); 
```

您还可以创建一个 javascript`Image()`并将其分配给`myFabricObject`：

```
var img=new Image();
img.onload=function(){
    myFabricObject.setElement(img);
}
img.src="myNewImage.png"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-07-22T10:18:49.377

你可以使用`setSrc()`：

```
var activeObject = canvas.getActiveObject();
activeObject.setSrc('images/my-image.png', function(img) {
    canvas.renderAll();
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-22T17:15:11.430

这是我发现的最佳选择

```
 var activeObject = canvas.getActiveObject();
 activeObject.setSrc(data.url); 
```

# linux - 通过 mesa 在旧硬件上运行 OpenGL 程序

> ID：15179981
> 
> 赞同：-1
> 
> 时间：2013-03-02T22:07:26.527
> 
> 标签：linux, opengl, graphics, installation, mesa

出于教学目的，我需要在显卡可能不支持 2.0 以上版本的几台计算机上安装 OpenGL3.X。

显然在 Windows 上，这不起作用，因为驱动程序没有更新。但是我听说过 Mesa 以及它如何为大多数 Opengl 功能提供软件实现。

所以我有两个问题：

1.  如果我安装了带有 mesa 9.0 的 Linux 发行版，我是否能够编译和运行新的 opengl 程序（需要 opengl 3.2）？（不需要硬件加速
2.  它在虚拟机上工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T22:25:01.380

> 1\. 如果我安装了带有 mesa 9.0 的 Linux 发行版，我可以编译和运行新的 opengl 程序（需要 opengl 3.2）吗？

如果您计算机中的 GPU 确实受到 Mesa 的开源驱动程序的支持，那么 Mesa 将退回到那些 GPU 可以做的任何事情

> 2\. 可以在虚拟机上运行吗？

如果您真的想要软件光栅化模式，那么是的，在 VM 上执行它就可以了。我完全支持 Linux 和开源，但有预先构建的 Mesa DLL 二进制文件，名为`opengl32.dll`. 如果你把它和你想运行它的可执行文件放在同一个目录中，它将使用 Mesa 的软件光栅化器。请不要替换系统的opengl32.dll

然而：在没有适当硬件支持的情况下使用 OpenGL-3 并不好玩。今天，您可以以便宜的价格获得支持 OpenGL-3 的 GPU。它们并不快，但是大约 30 美元，您至少可以获得所有硬件功能，并且它总是比任何软件光栅化器都快（除非您在 Xeon Phi 上运行它，但这并不经济 - 就价格而言Xeon Phi 你可以获得 3 GeForce GTX 690）。

# sql - sql从一个字段创建一个字段

> ID：15179982
> 
> 赞同：1
> 
> 时间：2013-03-02T22:07:29.973
> 
> 标签：sql, ms-access

我需要运行一个查询，该查询将从具有 2 种数据类型的字段中提取信息。

字段为地址，数据为 123 大道，bb@yahoo.com。

我需要创建 2 个字段，一个用于电子邮件，一个 STaddress 来自表客户和字段地址？

任何人都可以帮助.. 它的访问和 vb 查询

我想到了这个

选择customer.address from customer where address like " *@* "

但我仍然需要将地址字段的数据显示到 2 个不同的字段...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T17:42:31.883

根据这个问题和您的重复问题，我了解您的表格有一个包含街道地址和电子邮件地址的字段*，*您希望将它们拆分为单独的字段。

所以你的桌子包括这个......

```
YourField
------------------------------
1234 ave willie haha@yahoo.com
123 avenue bb@yahoo.com 
```

而你想要这个...

```
YourField                       street_address  email_address
------------------------------  --------------- --------------
1234 ave willie haha@yahoo.com  1234 ave willie haha@yahoo.com
123 avenue bb@yahoo.com         123 avenue      bb@yahoo.com 
```

如果正确，您可以使用该`InstrRev()`函数来确定最后一个空格在`YourField`. 最后一个空格之前的所有内容都是街道地址；之后的所有内容都是电子邮件地址。

```
SELECT
    y.YourField,
    Left(y.YourField, InstrRev(y.YourField, ' ') -1) AS street_address,
    Mid(y.YourField, InstrRev(y.YourField, ' ') +1) AS email_address
FROM YourTable AS y; 
```

您可能需要添加一个`WHERE`子句以确保查询仅尝试评估包含您的预期`YourField`值模式的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:15:31.717

这是获取两个不同字段的查询：

```
select iif(field like '*@*', field, NULL) as email,
       iif(field like '*@*, NULL, field) as address
from t 
```

在 Access 中的使用`like`与其他数据库有点不同。

我建议您使用此逻辑创建一个视图。如果您真的想修改表格，则必须添加列并使用上述逻辑填充它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-03T03:10:02.033

如果您在同一字段中有街道地址和电子邮件地址，并且想要拆分它们，请使用此地址。
我们会将您的原始字段称为 Addy，并将新字段称为 Street & Email。

```
SELECT Left(Addy, InStrRev(Addy, " ", InStr(Addy, "@")) - 1) AS Street, mid(Addy, InStrRev(Addy, " ", InStr(Addy, "@")) + 1) AS Email. 
```

它的作用是查找@，然后向后查找第一个空格。第一个函数占据该空间的每个左侧并称之为 Street，而第二个函数占据右侧的所有空间。

该函数实际上是嵌套在一起的 3 个函数。为了真正了解它在做什么，我将对其进行剖析。

```
I = InStr(Addy, "@")
J = InStrRev(Addy, " ", I)
Street = Left(Addy,J-1) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T22:14:24.093

尝试这样的事情：

```
select *, 
       (case locate('@', address) when 0 then null else address) as email,
       (case locate('@', address) when 0 then address else null) as street
from table; 
```

您可能需要调整“定位”功能的名称 - 我不确定它在访问数据库中是否相同。

# objective-c - Restkit 0.20.rc 需要但不包含多个 0.10 项

> ID：15179985
> 
> 赞同：0
> 
> 时间：2013-03-02T22:07:57.087
> 
> 标签：objective-c, restkit

这些 0.10 协议（re: [http://restkit.org/api/0.10.3/](http://restkit.org/api/0.10.3/)）在 Restkit 0.20.rc 中被引用，但是已经过时并且不包括在内（re: [http://restkit.org/api/0.20 .0-rc1/](http://restkit.org/api/0.20.0-rc1/)）：

RKRequestDelegate RKRequestSerializable

并且这些过时的类也在 0.20.rc 代码中被引用但不包括在内：RKRequest RKResponse

都在 0.20 rc 的 RKObjectLoader.h 中引用（它本身是一个 0.10.x 类，在 0.20 rc 中似乎已经过时，所以为什么它在新的 0.20.0-rc1 下载中？）

也许有更多 Objective C/RestKit 经验的人可以建议：处理这个问题的最佳方法是什么？由于插件似乎已在 Git 存储库中被拉到 0.10.x 上，迫使每个人都使用 0.20.0 ，因此在哪里可以找到 0.10 代码？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:14:56.840

我从框架中删除了 RKObjectLoader.h，它构建得很好。希望事情能在一起。也许有人错误地检查了它。

# spotify - “我的文档”中的 Spotify 文件夹

> ID：15179986
> 
> 赞同：2
> 
> 时间：2013-03-02T22:08:15.983
> 
> 标签：spotify

我正在尝试为 Spotify 制作应用程序，但我无法迈出第一步。我在“我的文档”（我使用 Windows 7 64 位）中创建了一个名为“Spotify”的文件夹，并在其中创建了一个名为“test”的文件夹。在“测试”中，我放置了一个文件“index.html”来测试我是否可以在 Spotify 中打开它，但我不能。我有一个开发者帐户，所以这不是问题。当我在搜索栏中输入 'spotify:app:test' 时，我得到如下信息：

![http://img834.imageshack.us/img834/7153/spotifyh.png](../Images/2d3c2afda76fc096ab53693f8a497302.png)

（注意，在屏幕截图中显示的是 spotify:app:tutorial，但我得到的结果与我输入 spotify:app:test 时显示的结果完全相同，说加载应用程序失败）

另外，我使用 Spotify 版本 0.8.7.111.gaf8d06ed-245

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T23:00:11.410

除非应用程序具有有效的清单文件，否则 Spotify 无法加载应用程序。可以在[此处](http://developer.spotify.com/technologies/apps/guidelines/integration/#applicationmanifest)找到清单文档。

或者，请参阅[Spotify Apps Tutorial](https://github.com/spotify/apps-tutorial)应用程序以获取有效清单的工作示例。请注意，您至少需要一个标识符、版本和名称才能使清单被视为有效。

# jquery - 获取一组 jQuery 元素的 data-foo 属性列表

> ID：15179991
> 
> 赞同：27
> 
> 时间：2013-03-02T22:08:27.323
> 
> 标签：jquery, each

我可以使用“获取匹配元素集中**第一个元素**`attr`的属性值......”

 **要获取属性列表，我需要手动构建它`$(..).each`还是方便？

```
$('tr.food-row')
[
<tr class=​"food-row" data-pk=​"11457">​…​&lt;/tr>​
, 
<tr class=​"food-row" data-pk=​"11429">​…​&lt;/tr>​
]
$('tr.food-row').attr('data-pk')
"11457" 
```

我想得到`["11457", "11429"]`。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-03-02T22:09:37.530

```
var allAttributes = $('tr.food-row').map(function(){
    return $(this).data('pk');
}).get(); 
```

[**现场演示**](http://jsfiddle.net/WuJHP/)**

# c# - 如何以消息正文作为参数并使用线程发送邮件 - C#

> ID：15179993
> 
> 赞同：1
> 
> 时间：2013-03-02T22:08:39.230
> 
> 标签：c#, multithreading, smtpclient

我有一个问题，我正在尝试使用这样的一种结构发送邮件：

```
private void SendMail()
{

    var client = new SmtpClient("smtp.gmail.com", 587)
    {
        Credentials = new NetworkCredential("mymail@mail.com", "mypassword"),
        EnableSsl = true
    };
    client.Send("mymail@mail.com", "AdressClient@mail.com", "Subject", "Body");
} 
```

好吧，这个结构工作得很好，但是会导致我的主程序出现延迟，因此我想在另一个线程中执行 SendMail 函数，如下所示：

```
private void ButtonTestSendMail_Click(object sender, EventArgs e)
    {
        //THREAD
        Thread ThreadSendEmail = new Thread(new ThreadStart(this.SendMail));
        ThreadSendEmail .IsBackground = true;
        ThreadSendEmail .Start();
    }

private void SendMail()
{   
   var client = new SmtpClient("smtp.gmail.com", 587)
   {
      Credentials = new NetworkCredential("mymail@mail.com", "mypassword"),
      EnableSsl = true
   };
   client.Send("mymail@mail.com", "AdressClient@mail.com", "Subject", "Body");
} 
```

好吧，此时我注意到我需要更改邮件的参数，例如 AdressClient@mail.com、Suject 和 Body。

但我不知道如何：/

如何编写一个接受参数的线程，如下所示：

```
private void ButtonTestSendMail_Click(object sender, EventArgs e)
        {
            string Body = "BodyTest";
            string AdressMail = "AdressMail@test.com";
            string Subject = "SubjectTest";
        //THREAD
        Thread ThreadSendEmail = new Thread(new ThreadStart(this.SendMail(Body,AdressMail,Subject));
        ThreadSendEmail .IsBackground = true;
        ThreadSendEmail .Start();
    }

    private void SendMail(string Body, string Adress, string Subject)
    {   
       var client = new SmtpClient("smtp.gmail.com", 587)
       {
          Credentials = new NetworkCredential("mymail@mail.com", "mypassword"),
          EnableSsl = true
       };
       client.Send("mymail@mail.com", Adress, Subject, Body);
    } 
```

我试过但没有用，我有一个 MethodName Expected 和一个错误通知在这一行：

```
Thread ThreadSendEmail = new Thread(new ThreadStart(this.SendMail(Body,AdressMail,Subject)); 
```

如何编写接受参数的线程？谢谢你的帮助！此致！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:20:24.227

您快到了：

```
Thread ThreadSendEmail = new Thread(() => this.SendMail(Body,AdressMail,Subject)); 
```

lambda 可以解决问题。您不能直接调用 SendMail，您想将其作为未调用的函数传递。

请注意，如果您的 ASP.NET 进程回收（可能是因为您正在部署），该线程将被粗鲁地中止。然后邮件将丢失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T22:27:50.580

如果您需要做的只是异步发送邮件消息，您可以使用**SmtpClient.SendAsync**方法并且您的调用线程不会被阻塞（[http://msdn.microsoft.com/en-us/library/x5x13z6h.aspx](http://msdn.microsoft.com/en-us/library/x5x13z6h.aspx)） .

但是如果你真的想要一个新线程来完成这项工作，你需要创建一个包含你的参数值的类，并使用**ParameterizedThreadStart**委托来实例化它。这是一个带有一个示例的 SO 条目： [带参数的 ThreadStart](https://stackoverflow.com/questions/1195896/c-sharp-threadstart-with-parameters)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T22:31:57.977

显式地创建自己的线程通常没有必要，有时甚至是个坏主意。相反，您可以利用 .NET ThreadPool 在现有但非主线程上启动工作。例如：

```
ThreadPool.QueueUserWorkItem(state => { /* threadpool work */ }, null); 
```

无论哪种方式，在另一个线程上工作都可能很危险，因为如果抛出（而不是捕获）任何异常，您的应用程序将终止。此外，唯一的效果`Thread.IsBackground = true`是不阻止您的应用程序在运行时退出。如果您的意图是更改线程优先级，则应设置不同的属性。

如果您使用的是 .NET 4.0，则可以使用更高级别的抽象来帮助您处理异常：

```
Task task = Task.Factory.StartNew(() => { /* threadpool work */ }); 
```

稍后，如果在任务中引发异常，您可以观察它并根据需要使用 Task 对象上的各种属性和方法做出反应。在 .NET 4.0 上，如果您*没有*观察到异常，而只是让任务获得 GC，它也会使您的应用程序崩溃（尽管在一个不确定的时间，每当终结器运行时）。在 .NET 4.5 上，您的应用*不会*在这种情况下崩溃。

最后，如果您使用的是 .NET 4.5，则可以变得更短：

```
Task task = Task.Run(() => { /* threadpool work */ }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T22:21:23.627

该`Thread.Start()`方法具有`object`传递给线程方法的第二个参数的重载 - 因此您可以执行以下操作：

```
Thread ThreadSendEmail = new Thread(new ThreadStart(this.SendMail));
ThreadSendEmail.IsBackground = true;
ThreadSendEmail.Start("Body test");

. . . .

private void SendMail(object data)
{
  string body = (string)data;
  . . . 
} 
```

如果您想/需要传递更多参数，请将它们捆绑在一个对象中，然后传递该对象。

除了创建线程之外，您还可以使用线程池，它可以更好地扩展并且更易于使用，只需一行代码：

```
ThreadPool.QueueUserWorkItem(new WaitCallback(SemdMail), "Body test"); 
```

PS这是“旧式”解决方案，“现代”解决方案是使用 lambdas - 请参阅@usr 答案。

# c++ - 我应该如何为 c-string char 数组分配内存？

> ID：15179996
> 
> 赞同：7
> 
> 时间：2013-03-02T22:08:51.303
> 
> 标签：c++, c, memory-management, string-concatenation, cstring

因此，在尝试学习如何在 C++ 中使用 C-Strings 时，我遇到了内存分配问题。

这里的想法是创建一个格式为 (s1 + sep + s2) 的新字符串。我使用的文本提供了标题，所以我无法更改它，但我在尝试设置大小时遇到​​了问题的字符 str []。我收到一条错误消息，说 sLength 不是常量，因此不能用于设置数组的大小。我对 C++ 比较陌生，所以这是一个两部分的问题。

1.  这个策略实际上是为新数组分配内存吗？

2.  如果无法使用 strlen(char*) 获得常量值，如何正确设置数组大小？

    ```
    char* concatStrings(char* s1, char* s2, char sep){
        int sLength = strlen(s1) + strlen(s2) + 3; 
        //+1 for char sep +2 for \0 at end of string
        char *str = new char[sLength];
        strcpy (str, s1);
        str [sLength(s1)] = sep;
        strcat (str, s2);
        return str;
    } 
    ```

进行了编辑，所以现在我没有收到编译器错误，但是...

该函数的调用在这里：

```
 char* str = concatStrings("Here is String one", "Here is String two" , c);
    cout<< str; 
```

我的输出变为：

这是字符串 onec==================22221/21/21/21/2 / *(等)* / 这是字符串二

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-02T22:13:43.357

错误是*返回本地数组变量的地址`str`。*它的作用域`concatStrings()`在你声明的函数内，一旦控制从函数返回就无法访问。

要在外部访问它，您需要使用`new`运算符从堆中为字符串动态分配内存。

```
char* concatStrings(char* s1, char* s2, char sep){
    int s1Length = strlen(s1);
    int sLength = s1Length + strlen(s2) + 2; 
    // +1 for sep and +1 \0 at end of string
    char* str = new char[sLength];
    strcpy (str, s1);
    // Use strlen here instead of sizeof()
    str [s1Length] = sep;
    str [s1Length + 1] = '\0';
    strcat (str, s2);
    return str;
} 
```

并且在程序使用从`concatStrings`它返回的字符串完成后，应该确保通过调用来释放内存`delete`

```
char* str = concatStrings(s1, s2, sep);

// Do something

// Free up memory used by str
delete[] str; 
```

此处必须使用 delete[] 而不是 delete，否则会导致[未定义的行为](https://stackoverflow.com/questions/2425728/delete-vs-delete-operators-in-c)

我还编辑了`concatStrings()`要使用的函数，`strlen`而不是`sizeof`

更新：感谢您指出我们只需要 +2 而不是 +3 并确保需要在调用之后`str1`和之前附加一个 '\0'`sep``strcat`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-02T22:21:13.713

**您可以动态**分配生成的字符串内存（在运行时，在堆上），`new[]`在 C++ 中使用（或`malloc`更类似于 C 的风格）：

```
char* concatStrings(const char* s1, const char* s2, char sep) // enforced const correctness
{
    const size_t totalLength = strlen(s1) + strlen(s2) 
                            + 2; // +1 for sep char, +1 for '\0' 

    // Dynamically allocate room for the new string (on the heap)
    char* str = new char[totalLength];    

    strcpy(str, s1);
    str[strlen(s1)] = sep; // note that you had a typo with sizeof(s1) here
    strcat(str, s2);
    return str;
} 
```

请注意，此内存必须在代码中的某处释放，`delete[]`如果它是用 分配的`new[]`，或者`free()`如果它是用 分配的`malloc()`。

这是相当复杂的。

如果你使用一个**健壮的 C++ 字符串类**，你会大大简化你的代码**`std::string`**，它有方便的构造函数来分配内存，析构函数来自动释放它，`operator+`以及`operator+=`重载来连接字符串。查看如何使用以下代码简化代码`std::string`：

```
#include <string> // for std::string

std::string str = s1;
str += sep;
str += s2; 
```

（请注意，使用原始 C 字符串也可能使您的代码更容易受到安全问题的影响，因为您必须非常注意正确调整目标字符串的大小，避免*缓冲区溢出*等。这是更喜欢 RAII 健壮的字符串类（如`std::string`. )

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T22:11:49.180

`sizeof(s1)`返回指针变量的大小，*而不是*它指向的数组的长度。由于您知道它`s1`指向 C 字符串，因此您应该改用该`strlen()`函数。

# html - 如何确保我的页脚一直显示在页面末尾而不是中间？

> ID：15179998
> 
> 赞同：1
> 
> 时间：2013-03-02T22:09:01.930
> 
> 标签：html, css, footer

这是我的页脚CSS：

```
 .footer {
      background-color: #CACACA;
      font-size: 20px;
      height: 50px;
      padding-top: 10px;
      position: absolute;
      text-align: center;
      width: 100%;
      } 
```

在多个页面上，我有包含文本的容器。在某些页面上，只有足够的内容，页脚才会出现在页面末尾。但在某些情况下，内容不足，因此页脚仍显示在容器下方，但与页面末尾之间存在间隙。我该如何解决这个问题，以便无论容器的长度如何都能调整？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T22:23:37.077

像这样

```
 <!DOCTYPE html>
<html>
<head>
    <title>My Amazing Footer</title>
    <style>
    html, body {
       margin:0;
       padding:0;
       height:100%;
    }
    .wrapper {
       min-height:100%;
       position:relative;
    }
    footer{
        background:#F1F1F1;
        position: absolute;
        bottom: 0px;
        left: 0px;
        width: 100%;
        height:300px;
    }

    footer p{
        text-align: center;
        padding-top:100px;
    }
    </style>
</head>
<body>
    <div class="wrapper">
        <div class="Content">
            <p>HTML Ipsum Presents</p>
        </div>
        <footer>
            <p>&copy; My Website 2013\. All Rights Reserved!</p>
        </footer>

    </div>
</body>
</html> 
```

看到我们在包装器中有页脚，页脚绝对位于包装器的底部和左侧，然后我们只需将页脚的高度添加到包装器底部填充以及包装器和主体上的一些默认高度，然后排序，取看看这里的 jsfiddle - [http://jsfiddle.net/eTwJh/2/](http://jsfiddle.net/eTwJh/2/)这是一个没有内容的 - [http://jsfiddle.net/eTwJh/3/](http://jsfiddle.net/eTwJh/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T22:17:51.793

如果没有看到相应的 HTML，很难猜测您的问题可能是什么。听起来您的主要内容有一个底部边距，当该主要部分内只有有限的内容时，它会将页面底部向下推到页脚之外。

要修复它，要么调整该边距，要么更改页脚的位置。目前，位置是绝对的，这意味着页脚是根据其在 HTML 中的父元素定位的。将定位切换为相对将使其出现在 HTML 中任何元素之前的任何元素之后。

我建议您在尝试进一步解决这个问题之前阅读[更多关于 CSS 定位的信息。](http://www.w3schools.com/css/css_positioning.asp)

# javascript - 手机间隙的响应式设计支持

> ID：15179999
> 
> 赞同：1
> 
> 时间：2013-03-02T22:09:07.797
> 
> 标签：javascript, ios, cordova, jquery-mobile

所以我有一个应用程序，我使用手机间隙作为包装器，专门针对 iPad。现在我想合并一个 iPhone 版本的应用程序，但要让它在一个应用程序中整合在一起。所以我想我的问题是，电话间隙是否允许特定于设备的布局并让您使用 JavaScript 来检测这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-03T00:17:14.140

是的，但最快的方法可能是获取设备的屏幕尺寸并从那里开始：

```
var widthScreen = window.innerWidth;
var heightScreen = window.innerHeight; 
```

根据您获得的尺寸，您可以放心地假设您是在使用 iPad、iPhone5 还是 iPhone4 并进行更改。