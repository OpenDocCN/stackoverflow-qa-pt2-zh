# StackOverflow 问答 13071000-13071999

# php - Custom curl CURLOPT_HTTPHEADER with result [Authentication-API-Key] => 123456

> ID：13071000
> 
> 赞同：2
> 
> 时间：2012-10-25T14:37:52.337
> 
> 标签：php, curl

A http connection requires a HTTP POST request with a custom header object Authentication-API-Key

With CURL it's automatically converted to [HTTP_AUTHENTICATION_API_KEY] => 12345 Cannot figure out why

A simplle extract from a php class for testing is

Please help me out, how to get a $_SERVER result with [Authentication-API-Key] => 123456

```
<?php
    $contentType = 'text/xml';
    $method = 'POST';
    $auth = '';
    $header1 = 'Authentication-API-Key: 12345';
    $charset= 'ISO-8859-1';

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "http://localhost/test/returnurl.php");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLINFO_HEADER_OUT, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, Array('Content-type: ' . 
                $contentType . '; charset=' . $charset,
                $header1));
curl_exec($ch);

?>

<?php
//http://localhost/test/returnurl.php
Print_r($_SERVER,true)
?> 
```

output:

```
Array
(
    [HTTP_HOST] => localhost
    [HTTP_ACCEPT] => */*
    [CONTENT_TYPE] => text/xml; charset=ISO-8859-1
    [HTTP_AUTHENTICATION_API_KEY] => 12345
    ...
)

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:44:51.630

如果我运行你的代码，我会收到`$header2`未定义的消息，所以我认为你需要修复它。如果我删除`$header2`，这是输出：

```
GET /test/returnurl.php HTTP/1.1
Host: localhost
Accept: */*
Content-type: text/xml; charset=ISO-8859-1
Authentication-API-Key: 12345 
```

所以这似乎没问题。你的输出是什么？请注意，当前请求是使用 GET 发送的，而不是 POST。

`/test/returnurl.php`编辑：我创建了简单地转储数组的脚本`$_SERVER`，现在我明白你的意思了。它在接收端结束的事实并不意味着您没有正确设置标头，因此您正在使用的服务应该按预期接收它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-02T15:07:42.103

就是这样`_SERVER`工作的；它不会逐字地为您提供 HTTP 标头键。

这不是 CURL 做的。检查*实际*的HTTP 请求，您会发现标头没有问题。

另一个示例是`$_SERVER['CONTENT_TYPE']`，它为您提供`Content-Type`HTTP 标头的值。

这里没有问题。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2013-02-16T03:18:58.900

我正在使用的脚本传递一个数组，如 array("Content-type: image/png")。

也许通过将它放在一个数组中，您可以防止它在以下位置进入数组：

我是 cURL 的新手，所以我什至还不能测试这个理论..

# sql - Strange (Caching?) Issue (Bug?) with T-SQL View

> ID：13071003
> 
> 赞同：2
> 
> 时间：2012-10-25T14:38:01.067
> 
> 标签：sql, sql-server, tsql, sql-server-2005

**This issue was resolved by scripting the view as a create, dropping the view, and then recreating the view using the script, so obviously nothing was *wrong* with the view, per se. However, I am very curious as to what the cause could be...**

I have a created like this:

```
CREATE VIEW [dbo].[Employees_V]
AS
SELECT  cast(right(EmployeeNo,4) as int) as EmployeeID
,*
,cast(0 as bit) AS [IsTerritoryManager]
,cast(0 as bit) AS [IsCoordinator]
FROM    AD.dbo.ADEmployees_V 
```

The `AD.dbo.ADEmployees_V` has a lot of different fields, but the relevant fields are `Status` and `ISStatus`, defined in the creation of the view as:

```
,CASE WHEN c.[Status] = 'Active' THEN 'Active' ELSE 'Terminated' END AS [Status]
,CASE WHEN c.[Status] = 'Active' OR ad.[AccountStatus] LIKE '%Enabled%' THEN 'Active' ELSE 'Terminated' END AS [ISStatus] 
```

Today, I added the `ISStatus` column to `AD.dbo.ADEmployees_V` (`Status` was there previously).

After making that change, I did a:

```
SELECT * FROM [Employees_V] 
```

Surprisingly, this did not return the proper results. `ISStatus` did not appear as a column header, and instead of being populated with 0s, `IsTerritoryManager` was populated with the new `ISStatus` values!

I am guessing that this is some sort of caching issue, but I would *love* an explanation of what is going on under the covers. Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T08:20:40.497

视图的列列表是在 CREATE 或 ALTER 时生成的。如果您`SELECT * FROm table`在视图定义中使用 a ，则视图的列列表将填充`table`的当前字段列表。

向表中添加新列不会更改视图定义，这就是为什么您需要重新创建它以“刷新”它的列。

# delphi - conversion error from string, when using params in SQL

> ID：13071007
> 
> 赞同：3
> 
> 时间：2012-10-25T14:38:18.933
> 
> 标签：delphi, delphi-2010, firebird

using Delphi 2010 (Firebird [testing], MS Sql Server, Oracle [production])

The following is my SQL

```
SELECT p.script_no, MIN(p.start_Time) as startTime, MAX(p.end_Time) as endTime, 
SUM(p.duration) as TotalDuration
FROM phase_times p
WHERE (p.script_no=:scriptNo) AND (Trunc(p.start_time) >= :beginDateRange) AND (Trunc(p.start_time) <= :endDateRange) 
GROUP BY p.script_no

ParamByName('beginDateRange').AsDate:= Date - 30;
ParamByName('endDateRange').AsDate:= Date; 
```

I am getting a "conversion error from string - 10-25-2012" and i am not sure why, since my datetime fields are in the "10/25/2012 9:20:49 AM" format in the database.

If i change it to the following : ParamByName('beginDateRange').AsString := formatDateTime('mm/dd/yyyy',Date - 30).....i get the error "conversion error from string - 10/25/2012"

reserching this error has provided me no new avenues, do you have any ideas?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T10:28:17.537

根据 Interbase 6.0 手册，嵌入式 SQL 指南，第 7 章，Firebird 支持从 YYYY-MM-DD 和 YYYY-MM-DD HH:MM:SS.qqq 转换。我也相信它支持美式速记日期（例如 1-JAN-2012）进行转换。

可能支持一些依赖于语言环境的转换，但总的来说：使用实际的日期/时间戳类型而不是字符串。

**更新** 我最初没有`TRUNC`在您的查询中发现 ：这是转换错误的原因，因为此功能仅适用于数字，请参阅[TRUNC 的手册条目](https://www.firebirdsql.org/file/documentation/html/en/refdocs/fblangref25/firebird-25-language-reference.html#fblangref25-functions-scalarfuncs-trunc)。

鉴于您的评论（以及*ain*的回应），我假设您只对日期部分感兴趣，并且想忽略时间。如果是这样，请将您的使用重写`TRUNC`为：

```
CAST(<your-timestamp-field> AS DATE) 
```

条件`(Trunc(p.start_time) >= :beginDateRange) AND (Trunc(p.start_time) <= :endDateRange)`是：

```
CAST(p.start_time AS DATE) BETWEEN :beginDateRange AND :endDateRange 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:44:22.323

如果字符串是 12 小时格式，Firebird 不支持从字符串到日期和时间值的转换。使用 'dd.mm.yyyy hh:mm:ss' 或 'mm/dd/yyyy hh:mm:ss' 格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T16:40:31.470

字符串到日期/时间的转换通常使用用户的语言环境。因此，如果您使用与您的语言环境的日期部分不匹配的字符串提供日期/时间转换函数 - 您将收到类似的错误。

此外，指定日期/时间值（如“2012 年 10 月 25 日”）取决于区域设置。因此，如果您在不同于美国语言环境（如我的）的计算机上执行程序 - 如果使用“2012 年 10 月 25 日”，它可能会失败。

要独立于语言环境，我建议两个选项：

*   使用[StrToDateTime](http://docwiki.embarcadero.com/Libraries/XE3/en/System.SysUtils.StrToDateTime)，指定 TFormatSettings
*   使用 ISO 8601 指定日期/时间字符串（但我认为 Delphi 不支持...）

顺便说一句，MS Sql、Excel 等程序接受 ISO 8601 中的日期。但你必须检查 FB。

关于这一点：

> ...因为我的日期时间字段在数据库中采用“10/25/2012 9:20:49 AM”格式...

日期/时间字段的内部存储因不同的数据库引擎而异。您在数据库管理软件中看到的内容（在您的情况下为“10/25/2012 9:20:49 AM”）是数据字段的字符串表示形式，通常（再次）根据您的用户区域设置格式化

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-09T16:18:00.107

如果您从服务器 Firebird 2.1 下的 Firebird 1.0 连接数据库（例如），您需要在 Firebird 2.1 下进行备份和恢复

# javascript - Javascript - Matching a hyphen in regex

> ID：13071008
> 
> 赞同：2
> 
> 时间：2012-10-25T14:38:19.280
> 
> 标签：javascript, regex

I'm trying to match a string using regex (of which I am new to) but I can't get it to match.

These should be accepted:

*   GT-00-TRE
*   KK-10-HUH
*   JU-05-OPR

These should not:

*   HTH-00-AS
*   HM-99-ASD
*   NM-05-AK

So the pattern goes 2 letters, hyphen, 2 digits (between 00 and 11 inclusive), hyphen, 3 letters.

So far the best I can come up with is:

```
var thePattern = /^[a-z]{2}[-][00-11][-][a-z]{3}$/gi; 
```

I can't help but feel that I'm pretty close.

Can anyone give me any pointers?

Thanks.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:41:00.947

这应该是您需要的：

```
var thePattern = /^[a-z]{2}[-](0\d|1[0-1])[-][a-z]{3}$/gi; 
```

为了执行 00-11 的范围，您必须说“（0 后跟 0-9）或（1 后跟 0 或 1）”。这是因为指定范围内`[]`仅适用于单个数字。幸运的是，您的案例非常简单，否则解决此问题可能会变得非常复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:42:40.023

你的正则表达式没问题，但有一件事：数字匹配有点复杂

```
(0\d|10|11) 
```

您想匹配一个零，后跟一个数字 ( `\d`) 或 ( `|`) 一个十或一个十一。

方括号中的内容仅表示范围内的*单个*字符。`[0-5]`表示 0 到 5 之间的任何单个数字，`[a-q]`表示从 a 到 q 的任何小写字母。没有这样的事情，`[00-11]`因为它需要一次处理多个角色。

# drupal - Reports on Drupal Usage

> ID：13071010
> 
> 赞同：0
> 
> 时间：2012-10-25T14:38:20.590
> 
> 标签：drupal, content-management-system

I'm benchmarking some CMS's for future use. I would like to know if with Drupal it's possible to have (extensions or api's) reports of back office usage.

Examples:

1.  Users that don't create/update content for more than X days?
2.  Content Areas that don't have new content for more than X days?
3.  Number of contents waiting approval?

Thank you.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:56:31.457

有几个贡献给 Drupal 的模块可以显示站点的统计信息，请查看统计类别：[http ://drupal.org/project/statistics](http://drupal.org/project/statistics)

例如，有一个显示用户统计信息的模块：http: [//drupal.org/project/user_stats](http://drupal.org/project/user_stats)

更好的选择是构建一个自定义模块，在数据库中搜索您需要的统计信息。

# switch-statement - ExpressionEngine 开关标签工作不一致

> ID：13071011
> 
> 赞同：3
> 
> 时间：2012-10-25T14:38:21.527
> 
> 标签：switch-statement, expressionengine

在 ExpressioneEngine 中，我正在创建一个带有返回一些奇怪行为的条件的列表。下面的代码是更大集合的一部分：

```
<li><h4>DERMATOLOGY</h4>
  <ul>
    {exp:channel:entries channel="specialist" dynamic="no" orderby="sp_order" sort="asc"}
      {if sp_specialty == "sp_dermatology"}
        <li>
          <a href="{title_permalink='meet'}"><img src="{sp_headshot}" /></a>
          <a href="{title_permalink='meet'}"><p>{title}</p></a>
        </li>                           
      {/if}
    {/exp:channel:entries}
  </ul>
</li>
<li><h4>EMERGENCY AND CRITICAL CARE</h4>
  <ul>
    {exp:channel:entries channel="specialist" dynamic="no" orderby="sp_order" sort="asc"}
      {if sp_specialty == "sp_emergency"}
        <li class="{switch='one|two'}">
          <a href="{title_permalink='meet'}"><img src="{sp_headshot}" /></a>
          <a href="{title_permalink='meet'}"><p>{title}</p></a>
        </li>                           
      {/if}
    {/exp:channel:entries}
  </ul>
</li> 
```

在紧急和重症监护的情况下，会发生什么情况，我在该条目下有 5 个条目，类返回如下：二、一、一、一、二。关于获得我需要的行为的任何建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T14:45:47.600

我明白你的意思了。switch 变量将其逻辑应用于条目循环返回的所有条目 - 这就是您在呈现的页面中看到奇数编号的原因 - 因为它将它们应用于循环返回的条目，然后您将条件应用到这样做你的分组。您可以使用搜索参数为您做一些事情，只返回您在每个循环中寻找的条目。像这样：

```
<li><h4>DERMATOLOGY</h4>
    <ul>
    {exp:channel:entries channel="specialist" search:sp_specialty="=sp_dermatology"  dynamic="no" orderby="sp_order" sort="asc"}
    <li>
      <a href="{title_permalink='meet'}"><img src="{sp_headshot}" /></a>
      <a href="{title_permalink='meet'}"><p>{title}</p></a>
    </li>                           
{/exp:channel:entries}
</ul>
</li>
<li><h4>EMERGENCY AND CRITICAL CARE</h4>
<ul>
{exp:channel:entries channel="specialist" search:sp_specialty="=sp_emergency" dynamic="no" orderby="sp_order" sort="asc"}
    <li class="{switch='one|two'}">
      <a href="{title_permalink='meet'}"><img src="{sp_headshot}" /></a>
      <a href="{title_permalink='meet'}"><p>{title}</p></a>
    </li>                           
{/exp:channel:entries}
</ul>
</li> 
```

这样，每个循环仅返回您正在寻找的匹配项，从而消除了对条件的需要并允许 switch 参数按它想要的方式运行 - 以交替方式将自身应用于循环中的每个返回条目。

# regex - 用于拆分以下数据的正则表达式

> ID：13071016
> 
> 赞同：1
> 
> 时间：2012-10-25T14:38:32.990
> 
> 标签：regex, posix

我在文件的每一行都有一个数据，如下所示

```
BMT.PQ
DMZ.IV
VLD.Q
WPS.T 
```

我正在寻找一个正则表达式来分成两类输出

`A`一个数据的起始字母介于`M`

和别的

数据的起始字母是从`N`到`Z`

我试过这个

`[A-M].*`用于获取第一个开头字母 from `A`to的数据的前半部分`M`

我期待结果/正则表达式文本匹配

只要 ：

```
BMT.PQ 
DMZ.PQ 
```

但它也匹配了

`LD.Q`这对我来说是不正确的。

我什至没有成功尝试`[(A-M)(A-M)(A-M)].*`

基本上我想根据数据中的起始字母进行拆分。一半用于以字母 from `A`to开头的数据，另一半用于以字母to`M`开头的数据。`N``Z`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:43:48.930

你很接近，你所需要的只是添加`^`字符串的开头和字符串`$`的结尾。

```
^[A-M].*$ 
```

和

```
^[N-Z].*$ 
```

确保启用多行模式。多行模式（通常是`m`标志）允许`^`并`$`分别检测行首和行尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:41:41.860

克拉符号表示正在搜索/匹配的字符串的开始。您可能需要的两个正则表达式是：

```
^[A-M]

^[N-Z] 
```

# css - 容器中的 3 个 div 响应页面宽度

> ID：13071017
> 
> 赞同：2
> 
> 时间：2012-10-25T14:38:35.677
> 
> 标签：css, html

我现在整天都在摆弄这个问题。我需要创建一个 3 列设计，其中中间 div 具有固定宽度，左/右 div 是动态的（响应页面宽度）。例如：

```
#container {
float:left;
width:100%;
}

#left {
min-width: 200px;
width: 100%;
}

#middle {
width: 250px;
}

#right {
min-width: 200px;
width: 100%;
} 
```

HTML：

```
<div id="container">
    <div id="left">
        Left column should expand with the width of the browser - with a min-width.
    </div>

    <div id="middle">
        Middle column with fixed width.
    </div>

    <div id="right">
        Right column should expand with the width of the browser - with a min-width.
    </div>
</div> 
```

我为此创建了一个小提琴：http: [//jsfiddle.net/2jGAe/](http://jsfiddle.net/2jGAe/) 你能帮我解决这个造型问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T14:43:53.750

关键是使用：

```
#container > div {
    display: table-cell;
} 
```

#left 和 #right div 上没有宽度。见[演示](http://jsfiddle.net/2jGAe/1/)。

# php - fill textbox with values based on selected table cell value (ajax call & mysql)

> ID：13071018
> 
> 赞同：0
> 
> 时间：2012-10-25T14:38:40.800
> 
> 标签：php, mysql, ajax

I have a table which is populated by values obtained from mysql database. I want to use an ajax call function so that when I click a cell - based on the cell value the textboxes get filled. Now the data in the textboxes will be from another table in the mysql database.

So an example of how it would work is:

I have one table for credentials, which shows user name and their user id.

On the website this is shown as a table. Now when i click the a cell which has a user name. The textbox would be populated by the users say total exams taken which is obtained from exams table in the mysql.

I am totally stumped on how to go about doing this. Please can someone help!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:44:36.483

您可以通过使用 ajax 来做到这一点。

用这个

```
$("#cell").click(function(){
$.get("file.php?id="+$(this).val(),function(data){
$("#textboxid").val(data);
})
}) 
```

该`file.php`文件将对数据库执行反向调用并进行输出。

# c# - async long blocking method running in the UI thread after awaiting

> ID：13071019
> 
> 赞同：0
> 
> 时间：2012-10-25T14:38:41.310
> 
> 标签：c#, multithreading, asynchronous, async-await

Its something around:

```
async Task foo(...)
{
   await Task.Yield();
   [long blocking I/O statements]
} 
```

But the problem is that it still runs in the UI thread after the await. I made sure by getting the Thread.CurrentThread.ManagedThreadId for both the UI thread and the thread after await, and the UI thread is becoming not responsive.

So what should I do ? Should I use threads in the traditional way instead of relying on async/await ? or is there a way to make it run in a new non-UI thread after the await ?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:40:37.447

> 但问题是它在等待之后仍然在 UI 线程中运行。

是的，它会的。这是`async`/的一半`await`- 你可以回到正确的上下文。

听起来你真的*应该*为后台操作启动一个新线程（或者最好使用 a `Task<T>`），如果你不能避免阻塞 IO。然后您可以在异步方法中*使用结果：*

```
async Task Foo(...)
{
    string result = await Task.Run(...);
    // Now update the UI with the result
} 
```

# ruby-on-rails - Rails exception notifier -- add to database

> ID：13071021
> 
> 赞同：0
> 
> 时间：2012-10-25T14:38:42.257
> 
> 标签：ruby-on-rails, exception-handling, exception-notification

We have exception notifier set up on our server, though would like a back-up solution, if the email server is down, that would let us log exceptions in the database.

How is exception notifier listening to every method call and can I listen too?

Or.. is there a gem that already does both sending emails and logging to the database for exceptions?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T17:21:00.357

使用 Exception Notifier 的最佳选择是`rescue_from`在`ApplicationController`查找所有异常时使用，然后打扰您的日志记录和手动调用 Exception Notifier。

例子：

```
class ApplicationController < ActionController::Base
  rescue_from Exception, :with => :log_and_notify

  def log_and_notify(error)
    # Save to the DB

    # This manual call example is straight from the Exception Notifier github page.
    ExceptionNotifier::Notifier.exception_notification(request.env, exception, :data => {:message => "was doing something wrong"}).deliver
  end
end 
```

因此，如果控制器在其中一个操作期间出现错误，它将转到此方法，您可以在发送电子邮件之前将其保存到数据库中。

# android - android TabHost 的问题

> ID：13071025
> 
> 赞同：0
> 
> 时间：2012-10-25T14:38:52.547
> 
> 标签：android, android-layout

我正在做一个应用程序，在这个应用程序上我想使用标签。

这是我管理标签的活动：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);

    Resources res = getResources();
    tabHost = getTabHost();
    TabHost.TabSpec spec;
    Intent intent;

    intent = new Intent().setClass(this, WUL4Bus.class);

    spec = tabHost.newTabSpec("mapa");
    spec.setIndicator("Mapa",res.getDrawable(R.drawable.ic_tab_mapa));
    spec.setContent(intent);
    tabHost.addTab(spec);

    intent = new Intent().setClass(this, Esquematico.class);
    spec = tabHost.newTabSpec("esquemático");
    spec.setIndicator("Esquemático",res.getDrawable(R.drawable.ic_tab_listado));
    spec.setContent(intent);
    tabHost.addTab(spec);

    intent = new Intent().setClass(this, ListaTickets.class);
    spec = tabHost.newTabSpec("tickets");
    spec.setIndicator("Tickets",res.getDrawable(R.drawable.ic_tab_bono));
    spec.setContent(intent);
    tabHost.addTab(spec);

    intent = new Intent().setClass(this, ListaFavoritos.class);
    spec = tabHost.newTabSpec("favoritos");
    spec.setIndicator("Favoritos",res.getDrawable(R.drawable.ic_tab_directo));
    spec.setContent(intent);
    tabHost.addTab(spec);

    intent = new Intent().setClass(this, About.class);
    spec = tabHost.newTabSpec("acerca de");
    spec.setIndicator("Acerca de",res.getDrawable(R.drawable.ic_tab_info));
    spec.setContent(intent);
    tabHost.addTab(spec);

    tabHost.setCurrentTab(0);
    instancia = this;
} 
```

这是布局：

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <HorizontalScrollView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:fillViewport="true"
        android:scrollbars="none" >

        <TabWidget
            android:id="@android:id/tabs"
            android:layout_width="match_parent"
            android:layout_height="wrap_content" />
    </HorizontalScrollView>

    <FrameLayout
        android:id="@android:id/tabcontent"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />
</LinearLayout> 
```

我的第一个问题是，当我运行应用程序时，它工作正常，但不显示图标。没有 Horizo​​ntalScrollView 没有问题，但现在，它不显示图标。

另一个问题是我希望我的应用在每个屏幕上只显示一个标签（就像 Google Play 一样）而不是几个标签。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:50:34.927

每次我们只添加相同的值时，我们都会像这样添加，就像这样改变

```
intent1 = new Intent().setClass(this, Esquematico.class);
spec1 = tabHost.newTabSpec("esquemático");
spec.setIndicator("Esquemático",res.getDrawable(R.drawable.ic_tab_listado));
spec.setContent(intent1);
tabHost.addTab(spec1);

intent2 = new Intent().setClass(this, ListaTickets.class);
spec2 = tabHost.newTabSpec("tickets");
spec.setIndicator("Tickets",res.getDrawable(R.drawable.ic_tab_bono));
spec.setContent(intent2);
tabHost.addTab(spec2);

intent3 = new Intent().setClass(this, ListaFavoritos.class);
spec3 = tabHost.newTabSpec("favoritos");
spec.setIndicator("Favoritos",res.getDrawable(R.drawable.ic_tab_directo));
spec.setContent(intent3);
tabHost.addTab(spec3);........
 ............................................... 
```

看[这个](http://www.mkyong.com/android/android-tablayout-example/)例子....

# java - 使用 Guice 的通用类型提供程序

> ID：13071028
> 
> 赞同：2
> 
> 时间：2012-10-25T14:38:55.237
> 
> 标签：java, dependency-injection, guice

我正在尝试将类型化对象注入服务类但得到

```
 com.google.inject.ConfigurationException: Guice configuration errors:

1) No implementation for com.bookpac.utils.appserver.ILookup<com.bookpac.server.common.IWS> was bound.
  while locating com.bookpac.utils.appserver.ILookup<com.bookpac.server.common.IWS>
    for parameter 0 at com.bookpac.server.LookupService.<init>(LookupService.java:13)
  while locating com.bookpac.server.LookupService 
```

要注入的字段是`ILookup<IWS> lookup`，绑定是`bind(ILookup.class).toProvider(LookupProvider.class)`

使用 @Provides 注释时一切正常，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:43:33.257

当您使用泛型类型时，您需要使用 TypeLiteral，例如：

`bind(new TypeLiteral<ILookup<IWS>>(){}).toProvider(LookupProvider.class);`

从[文档](http://google-guice.googlecode.com/git/javadoc/com/google/inject/TypeLiteral.html)中 ：

> Java 还没有提供表示泛型类型的方法，所以这个类提供了。

# mysql - SQL查询以提取所有具有类别的WordPress帖子

> ID：13071035
> 
> 赞同：13
> 
> 时间：2012-10-25T14:39:24.210
> 
> 标签：mysql, sql, wordpress, posts

我需要从我的 WordPress 数据库中提取所有帖子以及相关的类别，并且不知道如何编写此查询。我已经毫无乐趣地尝试了几次，希望能得到帮助吗？

**编辑：这是我已经尝试过的：**

```
SELECT post_title, wpr.object_id, wp_terms.name
FROM wp_terms
INNER JOIN wp_term_taxonomy ON wp_terms.term_id = wp_term_taxonomy.term_id
INNER JOIN wp_term_relationships wpr ON wpr.term_taxonomy_id = 
wp_term_taxonomy.term_taxonomy_id
INNER JOIN wp_posts ON ID = wpr.object_id
WHERE taxonomy = 'category' 
AND post_type = 'post' 
ORDER by post_title 
```

这似乎有效，但它返回 1,553，我知道我的数据库中只有 1343。

**编辑：** 不久前我们在另一个 SQL 查询上做了同样的事情，发现它正在拉入修订和其他帖子类型，但认为这是使用 post_type = 'post' 解决的

**编辑：** 查看数据库中的类别数量后，我得出的总数为 216，如果减去 1553 - 1343 = 216，则为 6。所以我认为 1553 的总数来自 wp_terms 表哪些需要被排除，并且只显示那些活跃于已发布帖子的内容？

**编辑：** 另一种可能性是每个帖子可以有多个类别，因此有更多帖子的原因（1553）。那么如何将每个帖子分成多个类别呢？

非常感谢！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-11-07T07:52:17.137

这是对我有用的最终答案。

```
SELECT DISTINCT
post_title
, post_content
,(SELECT meta_value FROM wp_postmeta WHERE wp_postmeta.meta_key = 'Asking Price (US\$)' AND wp_postmeta.post_id = wp_posts.ID) AS "Asking Price (US\$)"
,(SELECT group_concat(wp_terms.name separator ', ') 
    FROM wp_terms
    INNER JOIN wp_term_taxonomy on wp_terms.term_id = wp_term_taxonomy.term_id
    INNER JOIN wp_term_relationships wpr on wpr.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id
    WHERE taxonomy= 'category' and wp_posts.ID = wpr.object_id
) AS "Categories"
,(SELECT group_concat(wp_terms.name separator ', ') 
    FROM wp_terms
    INNER JOIN wp_term_taxonomy on wp_terms.term_id = wp_term_taxonomy.term_id
    INNER JOIN wp_term_relationships wpr on wpr.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id
    WHERE taxonomy= 'post_tag' and wp_posts.ID = wpr.object_id
) AS "Tags"
FROM wp_posts
WHERE post_type = 'post' 
ORDER BY
post_title
, post_content 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-20T09:15:32.967

```
/* Query for fetch post/posts using post user, post category and post_title */ 
```

```
$query ="SELECT wp_posts.post_title, wp_posts.post_content, wp_posts.comment_count, wp_users.display_name, wp_terms.name  
                                        来自 wp_posts
                                        加入 wp_term_relationships ON (wp_posts.ID = wp_term_relationships.object_id)
                                        加入 wp_term_taxonomy ON (wp_term_relationships.term_taxonomy_id = wp_term_taxonomy.term_taxonomy_id)
                                        左连接 wp_terms ON (wp_terms.term_id = wp_term_taxonomy.term_id)
                                        加入 wp_users ON (wp_posts.post_author = wp_users.ID)
                                        WHERE wp_term_taxonomy.term_id IN ($bycat)
                                        和 wp_users.ID = $byuser
                                        和 wp_posts.post_type = 'post'
                                        AND（wp_posts.post_content LIKE '$bytitle' 或 wp_posts.post_title LIKE '$bytitle'）
                                        和 wp_posts.post_status = '发布'
                                        按 wp_posts.post_modified DESC 排序";

/*---- 显示结果 -----*/
$resultfirst = $wpdb->get_results($query);

foreach($resultfirst as $result){
回声 $result->post_title 。
';
回声 $result->display_name。' 
';
回声 $result-> 名称。' 
';
回声 $result->comment_count。
';
}
```

# matlab - 切片矩阵matlab没有循环

> ID：13071036
> 
> 赞同：2
> 
> 时间：2012-10-25T14:39:27.907
> 
> 标签：matlab

我有以下代码，其中`d`是一个尺寸为 94x290 的矩阵：

```
samples=268;
dim_cov=23;
for q=1:samples
    D(:,q)=(sum(d(:,q+(1:dim_cov)-1),2));
end 
```

有没有办法在没有循环的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:46:45.237

这行得通吗？

```
dim_cov = 23;
cs = [zeros(size(d,1), 1) cumsum(d, 2)];
result = cs(:,1+dim_cov:end) - cs(:,1:end-dim_cov); 
```

# c++ - 如何在这种环境中设置截止时间计时器？

> ID：13071037
> 
> 赞同：0
> 
> 时间：2012-10-25T14:39:29.857
> 
> 标签：c++, boost, timer, boost-asio

我有点迷失在图书馆的结构中，我不得不把它们纠缠在一起。我需要帮助将一些计时器引入这个结构。

我有以下内容：

*   *com.cpp*包含`main`并包含*com.hpp*
*   *com.hpp*包含一个*host.h*和需要的 boost 包含并定义了一个类*comClient*
*   *包含*host.h的**host.c**
**   *wrapper.cpp*包含*com.hpp*和一些需要的提升包括*

 *现在，我的*com.cpp*正在创建一个*comClient*并将其用于 com 端口上的异步通信。使用`boost::asio::serial_port`和`boost::asio::io_service`。

我需要使用一些计时器，以便捕捉一个包需要太长时间才能传输的时间。

创建*comClient*的实例时，应初始化 paket-timer。

在comClient`asynch_read_some`的私有函数中使用，我调用*comClient*的私有处理程序，然后此处理程序调用 host.c 的函数，该函数调用*wrapper.cpp**的*函数*以*重新启动计时器。

这是初始化计时器的函数：

```
//wrapper.cpp
void    IniPacketTimer(void *pCHandle){

    boost::asio::io_service io;
    boost::asio::deadline_timer t(io, boost::posix_time::milliseconds(25));
    t.async_wait(&hostOnTimeout(pCHandle));
    io.run();
} 
```

简而言之，这就是命令链：

```
//comClient.cpp
main{
  comClient cc();
}
//comClient.hpp
class comClient(boost::asio::io_service& io_service){
  comClient(){
   hostInit();
   aread();
  }
  private:
    aread( call aread_done)
    areaddone(call hostNewData())
}

//host.c
hostInit(){ 
   IniPacketTimer()
}
hostNewData(){
  resetTimer
}

//wrapper.cpp
resetTimer(){
  t.expires_from_now
} 
```

**问题：**

如何提供一个异步定时器，它不会影响我的串口上的异步读/写操作，但会在达到截止日期时触发函数的执行？

我应该使用已经存在的`io_service`还是可以的，如果我只是创建另一个？

为什么我会收到错误 C2102 '&' expects L-Value for my line `t.async_wait`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:14:44.200

您的问题不清楚，并且由于您没有发布真实代码，因此很难猜测您的问题是什么。
特别是您的线程不清楚，但对于 asio 非常重要。

下面是一个将编译但不运行的示例。我希望它能给你一个关于如何进行的提示。
它将打开一个串行端口和一个计时器。每当计时器到期时，它将开始一个新的。这是我前段时间使用的代码的剥离版本，所以也许它会对你有所帮助。

```
#include <boost/asio.hpp>
#include <boost/asio/serial_port.hpp>
#include <boost/function.hpp>
#include <boost/bind.hpp>
#include <vector>

class SerialCommunication
{
    public:
    SerialCommunication(boost::asio::io_service& io_service, const std::string& serialPort)
        : m_io_service(io_service)
        , m_serialPort(m_io_service)
        , m_timeoutTimer(m_io_service, boost::posix_time::milliseconds(5))
    {
        configureSerialPort(serialPort);
    }

    void configureSerialPort(const std::string& serialPort)
    {
        if(m_serialPort.is_open())
        {
            m_serialPort.close();
            m_timeoutTimer.cancel();
        }
        boost::system::error_code ec;
        m_serialPort.open(serialPort, ec);
        if(m_serialPort.is_open())
        {
            // start Timer
            m_timeoutTimer.async_wait(boost::bind(&SerialCommunication::TimerExpired, this, _1));
            header_sync();
        }
    }

    void header_sync()
    {
        m_serialPort.async_read_some(boost::asio::buffer(&m_header.back(), 1),
            boost::bind(&SerialCommunication::header_sync_complete, this,
                    boost::asio::placeholders::error,
                    boost::asio::placeholders::bytes_transferred));
    }

    void header_sync_complete(
        const boost::system::error_code& error, size_t bytes_transferred)
    {
        // stripped
        read_payload(&m_payload[0], 0);
    }

    void read_payload(uint8_t* buffer, uint8_t length)
    {
        m_serialPort.async_read_some(boost::asio::buffer(buffer, length),
            boost::bind(&SerialCommunication::payload_read_complete, this,
                    boost::asio::placeholders::error,
                    boost::asio::placeholders::bytes_transferred));
    }

    void payload_read_complete(
        const boost::system::error_code& error, size_t bytes_transferred)
    {
        // stripped
        // timer cancel and reset
        m_timeoutTimer.cancel();
        m_timeoutTimer.expires_at(boost::posix_time::microsec_clock::local_time() +
                            boost::posix_time::milliseconds(5));
        m_timeoutTimer.async_wait(boost::bind(&SerialCommunication::TimerExpired, this, _1));
        memset(&m_header[0], 0, 3);
        header_sync();
    }

    void TimerExpired(const boost::system::error_code& e)
    {
        m_timeoutTimer.expires_at(m_timeoutTimer.expires_at() + boost::posix_time::milliseconds(5));
        m_timeoutTimer.async_wait(boost::bind(&SerialCommunication::TimerExpired, this, _1));
    }

    boost::asio::io_service& m_io_service;
    boost::asio::deadline_timer m_timeoutTimer;
    boost::asio::serial_port m_serialPort;
    std::vector<uint8_t> m_header;
    std::vector<uint8_t> m_payload;
};

int main()
{
    boost::asio::io_service io_service;
    SerialCommunication cc(io_service, "/dev/ttyS0");

    io_service.run();
    return 0;
} 
```*

# c# - 预填充的抽象方法

> ID：13071047
> 
> 赞同：1
> 
> 时间：2012-10-25T14:39:59.913
> 
> 标签：c#, abstract

我有一个类需要一些抽象方法来调用 LinQ 表达式来获取我不知道类型的集合。

像这样的东西：

```
abstract List<object> Find(IEnumerable<object> items, object objectToFind) 
```

因此，覆盖方法必须开始强制转换对象才能对它们执行 LinQ 查询。

类似的东西：

```
List<StrongType> things = items.Cast<StrongType>().ToList();
var thingToFind = (StrongType) objectToFind;
// <- PERFORM LINQ HERE
return result.Cast<object>().ToList(); 
```

一切正常，但如果其他人需要从抽象的类中创建另一个子类，他可能会犯一个大错误。

所以...我只需要一些建议来帮助我，也许可以通过一些代码而不仅仅是注释来简化我的技术，或者是否有可能有一些代码来强制在 Visual Studio 中预填充覆盖的类（可能带有属性？）。

我希望被理解（我的英语有点差）

谢谢 ;）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:43:51.143

为什么不能在抽象方法或类定义中使用泛型？

```
abstract List<T> Find(IEnumerable<T> items, T objectToFind) 
```

然后继承你的类

```
public class Foo : Bar<StrongType>
{
   public override List<StrongType> Find(IEnumerable<StrongType> items, StrongType objectToFind)
   {
       // perform LINQ here
       return result.ToList();
   }
} 
```

# wpf - 棱镜：贝壳之间的导航？

> ID：13071048
> 
> 赞同：3
> 
> 时间：2012-10-25T14:40:01.010
> 
> 标签：wpf, silverlight, navigation, prism, regions

我想用 Silverlight & Prism 创建一个应用程序，用户可以像这样导航：

![在此处输入图像描述](../Images/5a3c95dbc67ce27c99226553ea0898df.png)

红色矩形描绘了内部具有不同 Prism 模块的区域（本例中为 6 个不同的模块）。

解决以下问题的最佳方法是什么：

*   AFAIK 外壳中的区域不会改变，但是我无法通过使用相同的区域来创建我想要的不同布局（例如，一旦模块水平堆叠和垂直堆叠一次）。在这里拥有多个外壳是一个不错的选择吗？

*   我知道可用于在区域中的视图之间切换的区域导航管道。这也可以用来在不同的Shell之间切换吗？

*   在 shell 之间导航感觉不对，但我还能如何解决这个问题？

这似乎是一种常见的情况，但我找不到有关它的信息。大多数应用程序，甚至是复杂的应用程序[（](http://www.codeproject.com/Articles/165370/Creating-View-Switching-Applications-with-Prism-4)即[http://blogs.msdn.com/b/erwinvandervalk/archive/2009/03/02/how-to-build-an-outlook-style-application.aspx，http://](http://blogs.msdn.com/b/erwinvandervalk/archive/2009/03/02/how-to-build-an-outlook-style-application.aspx) [www.codeproject.com/Articles/165370/Creating-View-Switching-Applications-with-Prism-4](http://www.codeproject.com/Articles/165370/Creating-View-Switching-Applications-with-Prism-4)，StockTrader RI ）只使用一个布局永远不会改变的shell，但如果布局必须改变怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-29T17:57:09.823

免责声明：我是 WPF Prism 程序员，所以我的回答可能不适用于 Silverlight。

我不会选择多壳路线。相反，我会在区域内有区域。

注意：在您进行设计之前，您需要询问是否可以使您的内容既可以水平也可以垂直（即绑定到 Orientation 并使用 WrapPanels）。如果可以，那么您可以重用您的实际内容区域。

你可以通过一个 shell 来设计这个，其中包含几个区域，这些区域的可见性由你的应用程序控制。

例如：成功登录后，登录区域被隐藏，而 StyleSelector 区域显示（带有 A 和 B 按钮）。

按下其中之一后，StyleSelector 区域将被隐藏，您将显示 VerticalContentPresenter 区域或 Horizo​​ntalContentPresenter 区域。

每个 xxxxxxxContentPresenter 区域内部都有两个区域。

正如我上面所说，根据您的控件如何，您可以在 xxxxxxContentPresenter 区域内重复使用相同的区域（甚至可以让这些区域也是相同的区域）。

# python - python从列表中的字符串中删除空格

> ID：13071053
> 
> 赞同：6
> 
> 时间：2012-10-25T14:40:13.630
> 
> 标签：python, list

我有一个列表列表。我想从它们中删除前导和尾随空格。该`strip()`方法返回没有前导和尾随空格的字符串副本。单独调用该方法不会进行更改。通过这个实现，我得到了一个`'array index out of bounds error'`. 在我看来，对于列表中的每个列表 (0-len(networks)-1) 和每个字符串 (0-len(networks[x]) aka i 和 j 应该完全映射到合法的索引而不是越界？

```
i = 0
j = 0
for x in networks:
    for y in x:
    networks[i][j] = y.strip()
        j = j + 1
     i = i + 1 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-25T14:43:46.293

`j`遍历第一个列表后，您忘记重置为零。

这是您通常不在 Python 中使用显式迭代的原因之一 - 让 Python 为您处理迭代：

```
>>> networks = [["  kjhk  ", "kjhk  "], ["kjhkj   ", "   jkh"]]
>>> result = [[s.strip() for s in inner] for inner in networks]
>>> result
[['kjhk', 'kjhk'], ['kjhkj', 'jkh']] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-25T14:42:18.933

这会生成一个新列表：

```
>>> x = ['a', 'b ', ' c  ']
>>> map(str.strip, x)
['a', 'b', 'c']
>>> 
```

`string`编辑：当您使用内置类型 ( ) 时无需导入`str`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-25T14:44:37.820

您不需要计算`i, j`自己，只需枚举，看起来您也没有递增`i`，因为它不在循环中并且`j`不在最内循环中，这就是您有错误的原因

```
for x in networks:
    for i, y in enumerate(x):
        x[i] = y.strip() 
```

另请注意，您不需要访问网络，但访问“x”并替换值会起作用，因为 x 已经指向`networks[index]`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-25T14:51:21.647

所以你有类似的东西：`[['a ', 'b', ' c'], [' d', 'e ']]`，你想生成`[['a', 'b',' c'], ['d', 'e']]`. 你可以这样做：

```
mylist = [['a ', 'b', ' c'], ['  d', 'e  ']]
mylist = [[x.strip() for x in y] for y in mylist] 
```

通常不需要在列表中使用索引，并且在迭代时更改列表，尽管它可能会产生多种不良副作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-26T06:29:06.423

```
c=[]
for i in networks:
    d=[]
    for v in i:
         d.append(v.strip())
    c.append(d) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-05T15:14:36.150

可以使用递归来实现更简洁的清理列表版本。这将允许您在列表中拥有无限数量的列表，同时保持代码的非常低的复杂性。

旁注：这也进行了安全检查，以避免条带出现数据类型问题。这允许您的列表包含整数、浮点数等。

```
 def clean_list(list_item):
        if isinstance(list_item, list):
            for index in range(len(list_item)):
                if isinstance(list_item[index], list):
                    list_item[index] = clean_list(list_item[index])
                if not isinstance(list_item[index], (int, tuple, float, list)):
                    list_item[index] = list_item[index].strip()

        return list_item 
```

然后只需使用您的列表调用该函数。所有值都将在列表列表中被清除。

clean_list（网络）

# c - 如何使用 netfilter 钩子在内核空间中回显数据包？

> ID：13071054
> 
> 赞同：6
> 
> 时间：2012-10-25T14:40:16.530
> 
> 标签：c, linux, linux-kernel, netfilter

我想在内核空间中回显一个数据包。我在这台机器上使用端口 6000 运行一个回显服务器。现在一个客户端在另一台机器上运行，向回显服务器发送数据。现在，我想做的是从内核空间回显数据包。我不想用数据包打扰服务器，它会从内核空间默默地回显。我在下面展示我的代码：

```
#include <linux/kernel.h>
#include <linux/module.h>
#include <linux/skbuff.h>
#include <linux/netfilter.h>
#include <linux/netdevice.h>
#include <linux/ip.h>
#include <linux/udp.h>
#include <linux/mm.h>
#include <linux/err.h>
#include <linux/crypto.h>
#include <linux/init.h>
#include <linux/crypto.h>
#include <linux/scatterlist.h>
#include <net/ip.h>
#include <net/udp.h>
#include <net/route.h>
#include <net/checksum.h>
#include <linux/netfilter_ipv4.h>

#define IP_HDR_LEN 20
#define UDP_HDR_LEN 8
#define TOT_HDR_LEN 28

static unsigned int pkt_echo_begin(unsigned int hooknum,
                        struct sk_buff *skb,
                        const struct net_device *in,
                        const struct net_device *out,
                        int (*okfn)(struct sk_buff *));

static struct nf_hook_ops pkt_echo_ops __read_mostly = {
    .pf = NFPROTO_IPV4,
    .priority = 1,
    .hooknum = NF_INET_PRE_ROUTING,
    .hook = pkt_echo_begin,
};

static int __init pkt_echo_init(void)
{
    printk(KERN_ALERT "\npkt_echo module started ...");
    return nf_register_hook(&pkt_echo_ops);
}

static void __exit pkt_echo_exit(void)
{
    nf_unregister_hook(&pkt_echo_ops);
    printk(KERN_ALERT "pkt_echo module stopped ...");
}

static unsigned int pkt_echo_begin (unsigned int hooknum,
                        struct sk_buff *skb,
                        const struct net_device *in,
                        const struct net_device *out,
                        int (*okfn)(struct sk_buff *))
{
    struct iphdr *iph;
    struct udphdr *udph;
    unsigned char *data;

    unsigned char *temp;

    __u16 dst_port, src_port;
    int data_len;

    if (skb) {
        iph = (struct iphdr *) skb_header_pointer (skb, 0, 0, NULL);

        if (iph && iph->protocol &&(iph->protocol == IPPROTO_UDP)) {
            udph = (struct udphdr *) skb_header_pointer (skb, IP_HDR_LEN, 0, NULL);
            src_port = ntohs (udph->source);
            dst_port = ntohs (udph->dest);

            if (dst_port == 6000) {
                printk(KERN_ALERT "\nUDP packet goes in");

                data = (unsigned char *) skb_header_pointer (skb, TOT_HDR_LEN, 0, NULL);
                data_len = skb->len - TOT_HDR_LEN;

                struct sk_buff *newskb;
                struct iphdr *newiph;
                struct udphdr *newudph;
                unsigned char *newdata;
                unsigned int newdata_len;

                newskb = skb_copy(skb, GFP_ATOMIC);
                newiph = (struct iphdr *) skb_header_pointer (newskb, 0, 0, NULL);
                newudph = (struct udphdr *) skb_header_pointer (newskb, IP_HDR_LEN, 0, NULL);
                newdata = (unsigned char *) skb_header_pointer (newskb, TOT_HDR_LEN, 0, NULL);

                newiph->saddr = iph->daddr;
                newiph->daddr = iph->saddr;

                newudph->source = udph->dest;
                newudph->dest = udph->source;

                struct sk_buff *tempskb;

                tempskb = skb_copy(skb, GFP_ATOMIC);

                *tempskb = *skb;
                *skb = *newskb;
                *newskb = *tempskb;

                kfree_skb(newskb);

            }
        }
    }
    return NF_ACCEPT;
}

module_init(pkt_echo_init);
module_exit(pkt_echo_exit);

MODULE_AUTHOR("Rifat Rahman Ovi: <rifatrahmanovi@gmail.com>");
MODULE_DESCRIPTION("Echoing a packet from kernel space.");
MODULE_LICENSE("GPL"); 
```

现在我不明白需要什么。我在 PRE_ROUTING 钩子中捕获了数据包。然后我创建了一个新的skb，从收到的旧skb中填充，然后更改了源地址（saddr）、目的地址（daddr）、源端口（source）和目的端口（dest），这样数据包就可以从 PRE_ROUTING 钩子转发。由于路由决策是在数据包从挂钩通过后做出的，因此我寻找要转发到其原始源的数据包。但由于某种原因，它不是那样做的。数据包被接收，一切都被改变了，但数据包似乎没有向后移动。我不明白缺少什么，以及使它工作需要什么。更具体地说，从 PRE_ROUTING 挂钩向网络发送数据包需要什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T15:34:40.823

很多东西都不见了。

首先，您使用的 netfilter 钩子是 PRE-ROUTING，它捕获传入的数据包，因此除非您使用一些内核函数来传输您构建的数据包，否则返回 NF_ACCEPT 只会让您更改（或没有）的数据包继续在途中（这是本地系统，而不是本地系统）。
阅读类似的功能`dev_queue_xmit(struct sk_buff *)`，但请注意，在使用此功能之前，您的 SKB 必须具有链路层标头，因为此功能实际上将您的数据包排队在队列中以立即发送到 NIC，并且您的工作是设置链路层地址.

其次，请记住，在更改 IP 标头地址后，您必须重新计算数据包的校验和，否则您的数据包将在另一端被丢弃。

第三，请注意，在内核空间中做你想做的事情在很大程度上被认为是一种非常糟糕的做法。内核模块的存在是有原因的，这不是其中之一，netfilter 是一个很棒的工具，但它实际上不应该用于发送正常流量。

**编辑：**

阅读您的最新评论；我建议您阅读有关 libPCap 库的信息，它应该可以很好地为您服务，并且仍然可以将您的工作保持在正确的位置，即用户空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-12T11:24:26.540

In addition to the previous answer, another technique that can be used to echo an UDP packet from the netfilter callback is:

send the packet back, as a new UDP packet, using:

`int sock_sendmsg(struct socket *sock, struct msghdr *msg, size_t size)`

in net/socket.c

or also using the netpoll library, as said in the answer [here](https://stackoverflow.com/questions/10499865/sending-udp-packets-from-the-linux-kernel).

The original packet can than be dropped using NF_DROP.

In the netfilter callback, that runs in an "interrupt context" is possible to send packets, but is not possible to receive them (since every attempt to wait causes a kernel panic). For this reason the solution I proposed works with UDP, but cannot work with TCP (the TCP handshake requires that the ACK message must be received).

Anyway, as already said, doing this kind of things in kernel space is BAD and should be used only for learning purposes.

# jquery - 将另一个背景添加到 div 并将其一起移动 jquery

> ID：13071057
> 
> 赞同：1
> 
> 时间：2012-10-25T14:40:22.547
> 
> 标签：jquery, css

我有一个用 php 和 jquery 开发的网站。我想在 div 中动态附加第二个背景并在第一个背景的同时向下滑动。如果用户单击菜单中的某个部分，我将新背景附加在第一个背景的顶部，然后在两个背景向下滑动直到第二个背景进入旧背景的旧位置。动画结束后，我删除了旧背景。我怎样才能做出类似的事情？我不知道如何动态附加新的 div 并同时向下滑动两个背景。如何？

这是一个简单的代码，在我开发了其余代码之后。

[JSFIDDLE](http://jsfiddle.net/Q5prn/)

html

```
<div></div> 
```

css

```
html, body, div { height: 100%;}
div {
    opacity: .3; /*just to see there is no overlap*/
    position: relative;
    z-index: 2;
    background: url(http://www.dummyimage.com/643x12/001aff/ffffff.png&text=643+x+12) top left no-repeat;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:01:59.563

试试这个 -[**演示**](http://jsfiddle.net/Q5prn/6/)

***HTML***

```
<button> click </button>
<div></div> 
```

***CSS***

```
div {
    position: absolute;
    border: solid;
    top:100px;
    left:0;
    z-index: 2;
    height: 120px;
    width: 400px;
    overflow: hidden;
    background-image:    
        url(http://www.dummyimage.com/400x120/00ff00/ffffff.png),
        url(http://www.dummyimage.com/400x120/00ff00/ffffff.png);
    background-position: 0 -120px, 0 0;
    background-repeat:   no-repeat;

    -webkit-transition: all 1s;
       -moz-transition: all 1s;
         -o-transition: all 1s;
            transition: all 1s;
}

.hover {
    background-position: 0 0, 0 120px;
} 
```

***jQuery***

```
var bgImg  = $("div").css("background-image"),
    bgImg2 = 'url(http://www.dummyimage.com/400x120/001aff/ffffff.png)';   

$("button").on("click", function() {
    $("div")
        .css({ "backgroundImage" : bgImg2 + ", " + bgImg })
        .addClass("hover");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:57:49.007

显然，我并没有真正理解你的所有愿望，但我可以给你一些建议。使用更大的图像，其中一条为（无论如何）红色，另一条为（无论如何）蓝色。使用`background-position`CSS 属性更改位置。您可以使用`.animate()`jquery的功能滑动位置。

这只是一个建议，我真的希望你向我们展示你在 javascript 方面的进展，或者你想要复制的一些参考或任何东西。

CSS

```
div {
  background-position-y:-100px;
} 
```

JS

```
$('div').animate({'background-position-y':'0'}, 1000); 
```

此图像应该有 2 条高度为 100px 的条带，每条带不同的颜色，您必须从任何操作按钮调用 javascript。

# android - 移动“云” - 随手指移动的径向渐变

> ID：13071060
> 
> 赞同：3
> 
> 时间：2012-10-25T14:40:39.327
> 
> 标签：android, android-layout, ontouchlistener, radial-gradients

第一个问题。我有工作代码可以在文件的其他位置进行此移动——这不是问题。问题是如何创建可以移动的径向渐变（API 16 以下）。

先发制人，我在这里花了很多时间：

[http://developer.android.com/reference/android/graphics/drawable/GradientDrawable.html](http://developer.android.com/reference/android/graphics/drawable/GradientDrawable.html)

使用 GradientDrawable（如下），似乎没有办法在不设置非径向方向的情况下设置颜色。

```
public class CustomView extends View {
    int width = (sWidth/8); // sWidth defined elsewhere as width of screen
    int height = (sWidth/8);
    GradientDrawable gradient;
    int[] colors = {0x60ffffff,0x000000};

    public CustomView(Context context) {
        super(context);
        gradient = new GradientDrawable(GradientDrawable.Orientation.BL_TR,colors);
    }

    protected void onDraw(Canvas canvas) {
        if(x != 0 && y != 0){ // OnTouch calls invalidate on this view for movement
            gradient.mutate();
            gradient.setShape(GradientDrawable.RADIAL_GRADIENT);
         // This just makes it disappear:
         // setGradientType (GradientDrawable.RADIAL_GRADIENT);
            gradient.setBounds(x-width/2, y-height/2, x + width, y + height);
            gradient.draw(canvas);
        }
    }
} 
```

还有这个：

[http://developer.android.com/reference/android/graphics/RadialGradient.html](http://developer.android.com/reference/android/graphics/RadialGradient.html)

但似乎没有办法移动那个梯度。您可以将径向渐变放在某种可以移动的透明圆圈上吗？我不知所措。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T03:49:43.763

编辑：

第 1 步，在您的可绘制文件夹中定义一个椭圆形。这是“cloud.xml”：

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
android:shape="oval" >

<gradient
    android:centerX="0.5"
    android:centerY="0.5"
    android:endColor="#00000000"
    android:gradientRadius="30"
    android:startColor="#f0ffffff"
    android:type="radial" />
<size
    android:width="60dp"
    android:height="60dp" />
 </shape> 
```

半径、宽度和高度可能需要动态更改。所以随便放。上面的配色方案会给完全透明的稍微透明的颜色。云效果。

第二步，你的自定义视图的构造函数：

```
// actually before the constructor this, of course:
GradientDrawable circle;

// now the constructor:

circle = (GradientDrawable) context.getResources().getDrawable(R.drawable.cloud); 
```

第三步，onDraw方法：

```
 // x & y being coordinates updated from onTouch method,
            // circleRad being some constant dependent on screen dp
            if(x != 0 && y != 0){
            circle.setGradientRadius(circleRad);
            circle.setBounds(x-circleRad, y-circleRad,
                    x+circleRad, y+circleRad);
            circle.draw(canvas);
        } 
```

------------- 下面保留了原始的、流程效率较低的解决方案 ------------

等待几个星期，您就可以回答自己的问题了。原来它一直是 RadialGradient。

```
public class CustomView extends View implements OnTouchListener {
    Shader radialGradientShader;
    Paint paint;
    private int circleDiam;
    private int x = 0;
    private int y = 0;
    private int lastScreenColor;

    public CustomView(Context context, int circleDiam) {
        super(context);
        this.circleDiam = circleDiam;
        paint = new Paint();
    }

    protected void onDraw(Canvas canvas) {
        if(x != 0 && y != 0){       
            paint.setStyle(Paint.Style.FILL);
            paint.setAntiAlias(true);
            radialGradientShader = new
    RadialGradient(x, y, circleDiam,
    0xf0ffffff,0x00000000,Shader.TileMode.MIRROR);
            paint.setShader(radialGradientShader);
            canvas.drawCircle(x, y, circleDiam, paint);
        }
    }

    public boolean onTouch(View v, MotionEvent event) {
        x = (int)event.getX();
        y = (int)event.getY();

        if(event.getAction() == MotionEvent.ACTION_DOWN 
     && event.getAction() == MotionEvent.ACTION_MOVE){
            invalidate();
            return true;
        }
        else{ 
            x = 0;
            y = 0;
            invalidate();
            return false;
        }
    }
} 
```

蓬松的云！

此解决方案的唯一问题是当您在 onDraw 方法中实例化对象时 Eclipse 会发疯。但是，如果您尝试在构造函数中实例化它，事情就会变得非常难看。

避免上述问题的解决方案加分。

# ios - 在 iOS 下操作现有 PDF 文档的最佳方法是什么？

> ID：13071069
> 
> 赞同：1
> 
> 时间：2012-10-25T14:41:03.937
> 
> 标签：ios, xcode, pdf

我需要在 iOS 应用程序中个性化文档。我可以提供 DOCX、PDF、PPT 等原始文档。输出格式必须是 PDF。

我的最低要求是填写一些文本字段。很高兴也可以替换图像。

我非常习惯于使用`UIGraphicsBeginPDFContextToFile`等以编程方式生成 PDF。但在我目前的情况下，我不想以编程方式创建整个文档，我只想替换一些内容。

任何提示/提示？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T01:08:40.330

DOCX 是一个 zip 格式的文件，因此您可以以编程方式处理内容并重建 zip 文件。PPT 是一种二进制格式，尽管较新版本的 PowerPoint 也可能构建您可以通过编程方式处理的面向 zip 的版本。尽管您提到您不需要以编程方式处理这些文档 - 我也可能只是作为最后的手段。

对于您的 DOCX 原始/源文档（或 doc、odt、rtf 但不是 ppt/pdf），如果您的应用程序可以具有外部依赖项，则可以使用[Docmosis云服务。](http://www.docmosis.com)作为一次性/偶尔的任务，您可以上传带有文本字段或图像占位符的 DOCX 原始文档。然后，您的 iOS 应用程序调用 Docmosis 发送指令和数据以创建输出 PDF 并将其流式传输回应用程序或通过电子邮件发送/存储它或两者兼而有之。

好处是它将所有负载和编码从 iOS 应用程序（有一个 SDK）中移开。缺点是它是外部依赖。请注意，我为创建 Docmosis 的公司工作。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:45:41.813

为什么不在指向您创建的页面的 URL 的 webView 模式中加载页面？页面的主要部分是静态的，然后您需要自定义的字段将通过 Javascript 或 PHP 填充。

例如，我们的应用程序中有一个联系表格，您可以在提交后查看已完成表格的详细信息。当用户单击按钮查看联系人确认时，它会加载`example.com/confirmation.php`到 iOS 应用程序中的模式视图中。

在`confirmation.php`页面上（在网络上），我使用 PHP`$_GET`从 URL 参数中提取变量，然后使用我的静态内容填充页面，以及他们在表单中输入的自定义信息。

# ruby-on-rails - 为什么从 Fixtures 加载的 Rails 数据会损坏？

> ID：13071071
> 
> 赞同：0
> 
> 时间：2012-10-25T14:41:06.407
> 
> 标签：ruby-on-rails, fixtures

我有两个用于区域设置和翻译的固定文件。语言环境加载正常，但翻译被破坏：

夹具

```
translation_05064:
  id: 5064
  key: control.base_search_users.panel.title
  value: Поиск пользователей
  interpolations: 
  locale: ru
  locale_id: 16
  is_proc: false 
```

成为记录：

```
#<Translation id: 5064, 
key: "control.base_search_users.panel.title", 
value: "Поиск пользователей", 
interpolations: nil, 
locale: nil, 
locale_id: 1019186233, 
is_proc: false> 
```

出于某种原因， **locale**而不是*'ru'*变为 nil，而**locale_ib**而不是*16*变为*1019186233*对于文件中的每个夹具。

我以这种方式加载固定装置：

```
require 'active_record/fixtures'
ActiveRecord::Fixtures.reset_cache  
fixtures_folder = File.join(Rails.root, 'test', 'fixtures')
fixtures = Dir[File.join(fixtures_folder, '*.yml')].map {|f| File.basename(f, '.yml') }
ActiveRecord::Fixtures.create_fixtures(fixtures_folder, fixtures) 
```

翻译模型

```
class Translation < ActiveRecord::Base
  validates :key, :uniqueness => {:scope => :locale_id}
  validates :key, :locale, :locale_id, :value, :presence => true
  belongs_to :locale
  attr_accessible :key, :value, :locale_id, :locale
end 
```

迁移

```
 class CreateTranslations < ActiveRecord::Migration
    def change
      create_table :translations do |t|
        t.string  :key
        t.text    :value
        t.text    :interpolations
        t.string  :locale
        t.integer :locale_id
        t.boolean :is_proc, :default => false
      end
      add_index :translations, [:key, :locale]
    end
  end 
```

我在插入到数据库的 test.log 中看到包含损坏的数据。当我在 rails concole 中加载夹具文件时，`YAML.load_file 'test/fixtures/translations.yml'`我得到了正确的哈希数据。

为什么会这样？如何解决？ **Rails-2.3.8** , **PostgreSql-8.4**

* * *

**更新：** 尝试命名固定装置。在 locales.yml 中：

```
locale_00016:
  id: 16
  code: ru
  name: Русский 
```

并在 translations.yml 中将所有**语言环境**键值设置为 locale_00016

```
translation_05064:
  id: 5064
  key: control.base_search_users.panel.title
  value: Поиск пользователей
  locale: locale_00016
  is_proc: false 
```

**是的，这行得通！**

翻译*id*引用了现有且正确的语言环境记录，但*语言环境*仍然为零，为了修复它我跑了`Locale.find_by_code('ru').translations.update_all(:locale => 'ru')`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:26:31.623

如果`locale_id`设置了，看起来还可以；`locale`将在您需要时由 Rails 填充（第一次请求时）。1019186233是rais在创建fixture时生成的id。

大多数时候，您不需要在夹具中指定 id，rails 会为您生成它们，所以像下面这样的夹具应该没问题（您不应该在 Translation 夹具中同时定义`locale`和定义）：`locale_id`

*locales.yml：*

```
ru:
  what_ever_attr: value
  ... 
```

*翻译.yml：*

```
ru_title_translation:
  key: control.base_search_users.panel.title
  value: Поиск пользователей
  interpolations: 
  locale: ru
  is_proc: false 
```

# html - 无论文本大小如何，如何在图像下居中显示文本

> ID：13071074
> 
> 赞同：2
> 
> 时间：2012-10-25T14:41:14.437
> 
> 标签：html

假设我有一个图像。

```
<img src="lala.png" /> 
```

此图像具有`width=400px;`.

我想在这张图片下输入“Lala”。

```
<img src="lala.png" />
<br>
<span>Lala</span> 
```

请注意，我将从数据库中获取这些图像和那些文本，图像的宽度固定为 400 像素，但是文本的大小当然会有所不同，所以我不能`margin-left:100px;`用来将文本推到中间因为它会在其他文本上看起来不对...

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:43:46.760

您可以使用 div 代替 span。

HTML：

```
<div class="underImage">Blah</div> 
```

风格：

```
.underImage {
    width: 400px;
    text-align: center;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:42:30.270

你可以这样做`text-align:center;`

```
<div style="text-align:center;">
<img src="lala.png" />
<br>
<span>Lala</span>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T14:44:29.700

只需将图像和文本包装在一个元素中，并在包装​​元素上使用 text-align CSS 属性。

HTML

```
<p class="center-wrapper">
 <img src="lala.png" />
 <br>
 <span>Lala</span>
</p> 
```

CSS

```
.center-wrapper { text-align: center; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:56:29.863

有[几种方法](http://www.cs.tut.fi/~jkorpela/www/captions.html)可以实现这一点，但最灵活和最有效的方法是使用一个单元格表格，在一个`caption`元素中包含标题文本：

```
<table class="image">
<caption align="bottom">caption text</caption>
<tr><td><img ...></td></tr>
</table> 
```

有很多人以准宗教为由反对使用表格，但它仍然是一种灵活的方式，不需要您明确设置文本的宽度（与让其由图像的宽度决定相反） ) 并且独立于 CSS 支持工作。

# testflight - TestFlight：我向 PP 添加了新设备，我应该将新版本上传到 testflight 吗？

> ID：13071083
> 
> 赞同：0
> 
> 时间：2012-10-25T14:41:43.657
> 
> 标签：testflight

我将构建上传到 testFlight，然后我的朋友让我给他从 testFlight 下载应用程序的可能性。所以我得到了他的 UDID 并添加到配置文件中。

1.  我应该创建新版本并将其上传到 testFlight 吗？如果是，是否有任何选择不这样做？我不想将其他用户与新版本混淆，因为那里没有任何变化......

2.  我的朋友应该安装 testFlight 应用程序并在 iPhone 上注册试飞吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-25T17:03:57.583

是的，您可以在 testflight 的权限部分上传新的配置文件，而无需上传新的 ipa

# sql - SQL 查询。一个不寻常的加入。在 sqlite-3 中实现的数据库

> ID：13071084
> 
> 赞同：3
> 
> 时间：2012-10-25T10:39:13.797
> 
> 标签：sql, sqlite

这本质上是一个关于构建 SQL 查询的问题。db 是用 sqlite3 实现的。我是一个相对较新的 SQL 用户。

我有两张桌子，想以一种不寻常的方式加入它们。下面是一个例子来解释这个问题。

表1（t1）：

```
id  year    name
-------------------------
297 2010    Charles
298 2011    David
300 2010    Peter
301 2011    Richard 
```

表 2 (t2)

```
id  year    food
---------------------------
296 2009    Bananas
296 2011    Bananas
297 2009    Melon
297 2010    Coffee
297 2012    Cheese
298 2007    Sugar
298 2008    Cereal
298 2012    Chocolate
299 2000    Peas
300 2007    Barley
300 2011    Beans
300 2012    Chickpeas
301 2010    Watermelon 
```

我想加入关于 id 和 year 的表格。问题是 (1) id 必须完全匹配，但是如果表 2 中没有与表 1 中年份的完全匹配，那么我想选择下一个（较低）可用的年份。我想要制作的那种选择会给出以下结果

```
id  year    matchyr name    food
-------------------------------------------------
297 2010    2010    Charles Coffee
298 2011    2008    David   Cereal
300 2010    2007    Peter   Barley
301 2011    2010    Richard Watermelon 
```

总而言之，id=297 与表 1 中给出的 year=2010 完全匹配，因此从表 2 中选择了 id=297, year=2010 的对应行。id=298, year=2011 没有匹配的年份在表 2 中，因此选择了下一个可用年份（小于 2011 年）。如您所见，我还想知道匹配的年份（准确或不准确）实际上是什么。

我非常感谢（1）一个指示（是/否的答案）这是否可以单独在 SQL 中完成，或者我是否需要查看 SQL 之外，以及（2）一个解决方案，如果这不是太繁琐的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T11:02:27.897

当然，您可以在 SQL 中执行此操作。第一步您需要的是一个查询，它在 id 上连接 t1 和 t2，并为您提供各种可能的年份（编辑：修复了这句话，原来的句子也将下一步纳入其中）。您可以创建一个名为 t3 的视图，如下所示：

`CREATE VIEW [t3] AS SELECT t1.id as id, t2.year as year FROM t1 INNER JOIN t2 ON (t1.id = t2.id AND T2.year <= t1.year)`

从这里，您需要从每个 id 的 t3 中获取最大年份：

`CREATE VIEW [t4] AS SELECT id, MAX(year) FROM t3 GROUP BY id`

您应该能够将 t4 重新加入 t1 和 t2 以获得您想要的东西。当然，有一些方法可以缩短它，但它应该让你沿着正确的思路思考。另外，我猜这只是一个示例，但请不要将您的表称为 t1、t2 等。

# jquery - jQuery如何同时做事

> ID：13071086
> 
> 赞同：1
> 
> 时间：2012-10-25T14:41:57.710
> 
> 标签：jquery, image, fadein, fadeout

我似乎无法弄清楚如何以一种好的方式执行以下操作。

我需要淡出图像。更改图像的来源。然后将其淡入。

但问题是fadeOut 和fadeIn 应该同时出现。当然，我现在这样做的方式（向下阅读几行）将在淡出期间更改源，这非常明显。

```
$('#lightboxImage').fadeOut('slow');
$('#lightboxImage').attr('src', 'an imagesource');
$('#lightboxImage').fadeIn('fast'); 
```

当我刚刚运行这个。它会在淡出之前更改图像。

**当我将第二行放在 fadeOut 回调函数中时。在新图像淡入之前有一小段白屏。**

希望有人可以帮助我解决这个问题。:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:42:59.763

您应该使用`fadeOut`回调函数。见下文，

```
$('#lightboxImage').fadeOut('slow', function () {
   // Callback function that will be called after fadeOut
   $('#lightboxImage').attr('src', 'an imagesource').fadeIn('fast');
}); 
```

以下是来自 jQuery 文档，

> `.fadeOut( [duration] [, easing] [, callback] )`
> 
> *   `durationA`字符串或数字确定动画将运行多长时间。
> *   `easingA` 指示用于过渡的缓动函数的字符串。
> *   `callback`动画完成后调用的函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T14:43:17.057

使用回调函数。

```
$('#lightboxImage').fadeOut('fast', function() {
    $('#lightboxImage').attr('src', 'an imagesource').fadeIn('fast');
}); 
```

维基[百科页面](http://en.wikipedia.org/wiki/Callback_%28computer_programming%29)很好地解释了回调函数。

> 在计算机编程中，回调是对可执行代码或一段可执行代码的引用，它作为参数传递给其他代码。这允许较低级别的软件层调用在较高级别层中定义的子例程（或函数）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T14:47:22.517

我不知道人们给出的答案是不是你想要的。

我认为您希望第一张图像“淡入”第二张图像。

在这种情况下，您需要有两张图像，一张在另一张后面。

后面的将需要`display: none`在 css 中。

然后你可以这样做：

```
$('img#image1').fadeOut();
$('img#image2').fadeIn(); 
```

第一个图像应该淡入第二个图像。

您需要绝对定位这两张图片，以便前景一张在淡入淡出之前覆盖背景一张。

例如[http://jsfiddle.net/vre4M/](http://jsfiddle.net/vre4M/)

这也允许您前后移动：http: [//jsfiddle.net/vre4M/1/](http://jsfiddle.net/vre4M/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T14:45:05.590

排队他们会做的伎俩：

```
$('#lightboxImage').fadeOut('slow', function () {
  $(this).attr('src', 'an imagesource').fadeIn('fast');
  });
}); 
```

使用 $(this) 一次又一次地找不到它。

编辑：更新了我的答案，因为 attr 函数没有回调。多谢你们。

# iphone - 使用字符串对象的内容填充数组

> ID：13071088
> 
> 赞同：0
> 
> 时间：2012-10-25T14:42:03.000
> 
> 标签：iphone, ios, xcode, arrays, string

我有一个从 URL 获取内容的字符串。我试图将这些内容放入将填充表格视图的数组中。这是我的代码。我在这里做错了什么？提前致谢。

```
 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSString *strURL = [NSString stringWithFormat:@"http://10.247.245.87/index.php"];

    NSData *dataURL = [NSData dataWithContentsOfURL:[NSURL URLWithString:strURL]];

    NSString *strResult = [[NSString alloc] initWithData:dataURL encoding:NSUTF8StringEncoding];

    NSArray *nameArray = [[NSArray alloc]initWithContentsOfURL:<#(NSURL *)#>;

    return nameArray.count;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:24:44.773

我相信有几种方法可以做到这一点，但这里有一种将 JSON 结果解析为数组的简单方法。[从此处](http://stig.github.com/json-framework/)下载 SBJSON 框架 并将其添加到您的项目中。然后将 JSON.h 文件导入到您的`#import "JSON.h"`. 之后，您可以使用这行代码将字符串解析为数组`nameArray = [responseString JSONValue];`。

1.  [从这里](http://stig.github.com/json-framework/)获取 SBJSON 。
2.  将 SBJSON 添加到您的项目并像这样导入 JSON.h`#import "JSON.h"`
3.  像这样解析为数组`nameArray = [responseString JSONValue];`

快乐编码！

编辑：在将 JSON 解析为数组后，您可以尝试执行以下操作来检查是否有字符串数组：

> for (NSString* myString in nameArray){
> NSLog(@"%@",myString);
> }

如果上述方法可行，那么您可以从数组中获取字符串并在`cellForRowAtIndexPath`委托中填充表格视图，如下所示：

```
cell.textLabel.text = [nameArray objectAtIndex:indexPath.row]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:50:25.300

在这一行：

```
return nameArray.count; 
```

您将始终得到 0，因为您不等待 serwer 的响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:03:48.787

`NSData`在..之后使用这个

```
NSArray *array =   [NSJSONSerialization JSONObjectWithData:dataURL options:NSJSONReadingAllowFragments error:nil];

return array; 
```

# windows-8 - WinRT-XAML 中是否有类似复选框的按钮

> ID：13071091
> 
> 赞同：1
> 
> 时间：2012-10-25T14:42:11.007
> 
> 标签：windows-8, winrt-xaml

WinRT-XAML 中是否有类似复选框的按钮？

我的意思是，是否有一个具有 IsPressed （或等效）属性的按钮在用户点击它后会保持按下状态？然后在用户再次点击后“取消选择”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T17:17:55.083

[ToggleSwitch](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.ui.xaml.controls.toggleswitch.aspx)是您正在寻找的

![拨动开关](../Images/470a22ca1f9f1ea67c490d8fefed48c0.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T15:22:11.893

是的，它被称为“切换按钮”或“切换开关”。有关详细信息，请参阅 MSDN：[WinRT 控件列表](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh465351.aspx)

# mysql - 基于年和年+月的排序表

> ID：13071092
> 
> 赞同：1
> 
> 时间：2012-10-25T14:42:13.437
> 
> 标签：mysql, sorting

我有一个包含年份和 ID 列的表

```
YEAR              ID
1988                29
1989                 89
1990                22
1992                9
1994                8
1998                23
1922                 20
August 1990          12
September 2009         14
August 1991            11
November 2009           33
October 1990            30
January 1990            55
March 2001              24 
```

有没有办法我可以对表格进行排序，使我的最终结果是有序的。我正在寻找类似的结果

```
YEAR              ID
1922                20
1988                29
1989                 89
1990                22
1992                9
1994                8
1998                23
January 1990            55
August 1990          12
October 1990            30
August 1991            11
March 2001              24
September 2009         14
November 2009           33 
```

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:49:08.787

只需替换`myYear`为您的表名...

```
select year,id
from
(select year,id,
case when STR_TO_DATE(year,'%Y') is not null then STR_TO_DATE(year,'%Y') else STR_TO_DATE(year,'%M %Y') end as d,
case when STR_TO_DATE(year,'%Y') is not null then 0 else 1 end as ob
from myYear
) y
order by ob asc,d asc; 
```

# android - Android Java SQL 连接

> ID：13071095
> 
> 赞同：0
> 
> 时间：2012-10-25T14:42:17.390
> 
> 标签：android, sql, connect

所以我是一名网络开发人员，但目前正在制作一个应用程序。

我的电脑上有一个程序，可以将数据从我的电脑发送到我的虚拟主机上的数据库。

我现在所追求的是创建一个能够通过一系列查询下载该数据的应用程序。

是否有任何好的资源可以帮助我开发一些 Java 代码，当我外出时通过我的平板电脑连接到服务器，并在不同的 wifi 网络上从我的网络主机下载信息？

谢谢小伙子，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:56:53.467

我处理它的方式是我只是根据我想做的事情创建一个网页。例如，如果我想验证应用程序的登录，我会创建一个包含用户名和密码的页面。在设备上，我只是使用 HTTP 发布事务发布用户名和密码值。

例子：

```
public boolean LoginUser()
{
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("your URL comes here...");

    try
    {
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
        DataCrypt crypt = new DataCrypt();

        try
        {
            this.Cryptemail = crypt.bytesToHex(crypt.encrypt(this.Email));;
            this.Cryptpass = crypt.bytesToHex(crypt.encrypt(this.Password));
        }
        catch (Exception e)
        {
            DebugLog.log(e.getMessage());
        }

        nameValuePairs.add(new BasicNameValuePair("Password", this.Cryptpass));
        nameValuePairs.add(new BasicNameValuePair("Mail", this.Cryptemail));

        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        // Execute HTTP Post Request
        BasicHttpResponse response = (BasicHttpResponse) httpclient.execute(httppost);
        HttpEntity entity = response.getEntity();
        String response = EntityUtils.toString(entity);

      return true;
    }
    catch (Exception e)
    {
        DebugLog.log(e.getMessage());
        return false;
    }

    return false;
} 
```

编辑：因此，您可以只创建一个页面，该页面包含您想要查询的一些参数并以某种方式返回结果（例如通过 XML）。

希望这可以帮助你！:)

# php - Zend 从 url 获取参数

> ID：13071097
> 
> 赞同：1
> 
> 时间：2012-10-25T14:42:19.340
> 
> 标签：php, zend-framework, url, zend-route

我的路线设置：

```
Zend_Controller_Front::getInstance()
    ->getRouter()
    ->addRoute('view', new Zend_Controller_Router_Route('controller/action/:name')) 
```

我在视图中的链接：

```
$this->url(array("name" => "John"), "view", TRUE);

// returns "controller/action/John" as should 
```

现在，当我在时`controller/action/John`，**如何获取`name`from URL**？我试过了

```
$this->getRequest()->getParam("name"); 
```

但名称参数不存在 -`getRequest()`仅返回控制器、操作和模块参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T17:30:56.890

当您设置路由配置时，路由定义应直接匹配控制器/操作名称或设置为默认值。实际上在任何情况下设置默认值都是一种很好的做法，可以帮助您避免此类问题。

因此，在您的情况下，根据评论，您的路线可能看起来像这样。

```
$defaults = array(
    'controller'=> 'offers',
    'action'    => 'view',
    'name'      => ''
);
$route = new Zend_Controller_Router_Route('offers/view/:name',$defaults); 
```

正如评论中提到的，您始终可以检查使用了什么路线`Zend_Controller_Front::getInstance()->getRouter()->getCurrentRouteName()`。如果它没有显示您的预期路由，则路由器无法找到匹配并继续前进，直到它通常以“默认”路由结束。

作为您问题的旁注：当您使用时，`$this->url(array("name" => "John"), "view", TRUE)`您仅根据路线创建链接。这个方法只是视图的一部分，在分派给控制器或动作方面没有任何作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T20:29:20.480

对于那些发现这个问题并供将来参考的人，您`$this->params()->fromRoute('param1', 0);`至少可以在 Zend Framework 2 中使用以下方法从路由中获取参数：这就是我在这个问题中寻找的。

# javascript - 将插入符号设置为焦点上的文本框末尾

> ID：13071106
> 
> 赞同：4
> 
> 时间：2012-10-25T14:42:49.497
> 
> 标签：javascript, html, cross-browser

**问题：**

当某个文本框获得焦点时，将插入符号设置为文本框的末尾。该解决方案需要与 IE7、Opera、Chrome 和 Firefox 兼容。
为了使事情变得更简单，仅当文本框的当前值为固定值时才需要此行为。（说“初始化”）

**不完整的解决方案：**

有人会认为这很简单，但我找不到适用于所有浏览器的 SO 答案。以下答案*不起作用*：

```
$("#test").focus(function() {
  // This works for Opera only
  // Also tested with $(this).val($(this).val());
  if (this.value == "INIT") {
    this.value = "";
    this.value = "INIT";
  }
});

$("#test").focus(function() {
  // This works for IE and for Opera
  if (this.value == "INIT") {
    setCaretPosition(this, 4);
  }
}); 
```

我从 SO questions 中得到了 setCaretPosition 函数，并在不同的博客上看到了它：

```
function setCaretPosition(ctrl, pos) {
        if (ctrl.setSelectionRange) {
            //ctrl.focus(); // can't focus since we call this from focus()
            // IE only
            ctrl.setSelectionRange(pos, pos);
        }
        else if (ctrl.createTextRange) {
            // Chrome, FF and Opera
            var range = ctrl.createTextRange();
            range.collapse(true);
            range.moveEnd('character', pos);   // Also tested with this
            range.moveStart('character', pos); // and this line in comment
            range.select();
        }
} 
```

**小提琴**

我已经设置了一个[jsFiddle](http://jsfiddle.net/SwRAu/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T14:46:08.950

试试这个：

```
$("input").on("focus", function() {
    if (this.value === "INIT") {
        var input = this;
        setTimeout(function() {
            if (input.createTextRange) {
                var r = input.createTextRange();
                r.collapse(true);
                r.moveEnd("character", input.value.length);
                r.moveStart("character", input.value.length);
                r.select();
            }
            else {
                input.selectionStart = input.selectionEnd = input.value.length;
            }

        }, 13);
    }
}); 
```

[http://jsfiddle.net/azBxU/4/](http://jsfiddle.net/azBxU/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:48:40.820

这应该有效：

```
$("#test").focus(function() {
    var $this = $(this);
    var value = $this.val();
    if (value === "INIT") {
        setTimeout(function() {
            $this.val(value);
        }, 0);
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:57:32.143

我找到了一个为我工作了很长时间的 jQuery 插件。虽然不记得在哪里。

```
(function($)
{
    jQuery.fn.putCursorAtEnd = function() {
    return this.each(function() {
        $(this).focus()

        // If this function exists...
        if (this.setSelectionRange) {
            // ... then use it
            // (Doesn't work in IE)

            // Double the length because Opera is inconsistent about whether a carriage return is one character or two. Sigh.
            var len = $(this).val().length * 2;
            this.setSelectionRange(len, len);
        } else {
            // ... otherwise replace the contents with itself
            // (Doesn't work in Google Chrome)
            $(this).val($(this).val());
        }

        // Scroll to the bottom, in case we're in a tall textarea
        // (Necessary for Firefox and Google Chrome)
        this.scrollTop = 999999;
    });
    };
})(jQuery); 
```

# c++ - 它是如何打破这个 C++ 代码中的 for 循环的？

> ID：13071116
> 
> 赞同：3
> 
> 时间：2012-10-25T14:43:17.150
> 
> 标签：c++

这是代码：

```
for (int i=0;i<someClass::someList.entries();i++)
    returnBool |= (someOtherClass.get_something() == 
                  ((someClass*)(someClass::someList[i]))->get_something_else()); 
```

我认为它的作用是遍历所有实例，即 someList 中保存的 someClass 的 ptr。如果 get_something() == get_something_else() 则我们将值 1 分配给 returnBool，否则将 0 作为它的按位或运算符。

但是在调试器中，我注意到的是，无论 someList 有多长，只要 returnBool 为 1，它就会跳出 for 循环 - 这听起来对吗？

谢谢你的时间=]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:44:40.990

其实，只要`returnBool`是`true`，再多`|=`也做不到`false`，因为`true | false == true`。

实际上，您可以安全地从第一次循环中中断`returnBool`（`true`除非方法`get_something`正在变异，而按照它们的名称，它不是）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:18:37.093

可能是编译器优化。我假设这些函数足够简单，以至于可以看出它们没有副作用。

如果您确定可以跳过它们，我建议让这种优化对其他不太聪明的编译器（或人类）更加明显和强制性：

```
for (int i=0;i<someClass::someList.entries() && !returnBool;i++)
    returnBool |= (someOtherClass.get_something() == 
                  ((someClass*)(someClass::someList[i]))->get_something_else()); 
```

或者，如果编译器错误（不太可能）或者您希望明确表示您想要测试整个列表，只需执行以下操作：

```
for (int i=0;i<someClass::someList.entries();i++)
    returnInt += (someOtherClass.get_something() == 
                  ((someClass*)(someClass::someList[i]))->get_something_else());
return returnInt > 0; 
```

# c# - 如何在用户选中复选框时仅动态计算 CheckedListBox 中的选中项？

> ID：13071125
> 
> 赞同：4
> 
> 时间：2012-10-25T14:43:44.970
> 
> 标签：c#, checkedlistbox

我的 Windows 窗体应用程序上有一个 CheckedListBox 控件，它提供了可供选择的项目列表。我想在用户仍在检查它们时计算并仅显示已选中（未选中）的项目。我的意思是当你检查它们时计数。

我曾尝试使用 ItemCheck 事件和 CheckedListBox.CheckedItems.Count 但问题是即使该项目未选中，它也会每隔一次点击计数。当我检查某些东西时，它很重要，如果我再次取消选中它，它也很重要。

我认为这与 MSDN 上给出的评论[“直到 ItemCheck 事件发生后检查状态才会更新”有关。](http://msdn.microsoft.com/en-us/library/system.windows.forms.checkedlistbox.itemcheck.aspx)我不完全理解这里的问题。

谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T14:48:17.333

ItemCheckEventArgs 参数具有属性 (NewValue)，它告诉您更改是选中、取消选中还是两者都不是。

如果 CheckedItems.Count 直到事件触发后才更新（这是我从该评论中理解的） - 那么您可以添加该计数，并查看 ItemCheckedItems.Count 是选中（+1）还是取消选中（-1 ) 并且您可以获得正确的总数。

（除非我错误地理解了这句话，否则它非常模糊）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-04T20:23:37.763

Haedrian 正确回答了这个问题，但我认为原始代码也有很长的路要走。所以这里是 C# 代码：

```
private void CheckedListBox_ItemCheck(Object sender, ItemCheckEventArgs e)
{
    int sCount = checkedListBox.CheckedItems.Count;
    if (e.NewValue == CheckState.Checked  ) { ++sCount; }
    if (e.NewValue == CheckState.Unchecked) { --sCount; }
    // now sCount is count of selected items in checkedListBox.
} 
```

我有同样的问题，这个问题和答案给了我解决方案。感谢您的问题和已经存在的答案！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T14:47:01.703

添加事件处理程序`SelectedIndexChanged`并从中获取计数`CheckedItems.Count`。

`ItemCheck`您没有实际值，而是处理最后一次更改之前的值，您需要根据 Haedrian 建议的 EventArgs 调整计数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-13T09:35:10.790

由于我们不会立即在 CheckedItems.Count 中获取更新的值，因此我们使用`e.NewValue`获取更新的值来获取状态是否为 Checked。

声明一个全局变量来获取计数

```
int chkListCount = 0; 
```

在`ItemCheck`事件中给出以下代码

```
private void chkList_ItemCheck(object sender, ItemCheckEventArgs e)
{
     if (e.NewValue == CheckState.Checked)
     {
         chkListCount++;
     }
     else if(e.NewValue == CheckState.Unchecked)
     {
         chkListCount--;
     }
} 
```

它是获取所选项目计数的简单逻辑

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T16:34:00.510

作为初学者，这并不是一件真正明智和聪明的工作，但最终解决了我的问题。

```
private void CheckedListBox_ItemCheck(Object sender, ItemCheckEventArgs e)
    {
        int count = 0;
        if (e.NewValue.ToString() == "Checked")
        {
            // first get all the checked items
            foreach (object checkeditem in CheckedListBox.CheckedItems)
            {
                string checkItem = CheckedListBox.GetItemCheckState(CheckedListBox.Items.IndexOf(checkeditem)).ToString();
                if (checkItem == "Checked")
                {
                    count = count + 1;
                }
            }
            // Now, below is the most important part considering the remark on MSDN
            // "The check state is not updated until after the ItemCheck event occurs."
            count = count + 1; // Plus 1 as the NewValue was Checked
            labelCount.Text = "You have selected " + count + "Items.";
        }
        else if (e.NewValue.ToString() == "Unchecked")
        {
            // first get all the checked items
            foreach (object checkeditem in CheckedListBox.CheckedItems)
            {
                string checkItem = CheckedListBox.GetItemCheckState(CheckedListBox.Items.IndexOf(checkeditem)).ToString();
                if (checkItem == "Checked")
                {
                    count = count + 1;
                }
            }
            // Now, below is the most important part considering the remark on MSDN
            // "The check state is not updated until after the ItemCheck event occurs."
            count = count - 1; // minus 1 as the NewValue was Unchecked,
            labelCount.Text = "You have Selected " + count + "Items.";
        }
    } 
```

我非常感谢对此代码的评论。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-04T02:06:38.030

我知道很久以前就已经回答了这个问题，但我发现只处理 MouseUp 和 KeyUp 事件更容易。当这些事件被触发时，CheckedItems.Count 属性是准确的。因为他们都做同样的事情，我创建了一个方法来工作，并从两个事件处理程序中调用该方法。

```
 private void clbFolders_KeyUp(object sender, KeyEventArgs e) { Update(); }
    private void clbFolders_MouseUp(object sender, MouseEventArgs e) { Update(); }

    private void Update()
    {
        btnDelete.Enabled = clbFolders.CheckedItems.Count > 0;
    } 
```

# inno-setup - 如何使用 inno setup 重命名文件

> ID：13071129
> 
> 赞同：3
> 
> 时间：2012-10-25T14:43:49.100
> 
> 标签：inno-setup

我想首先将现有文件“我的程序旧”重命名为“我的程序 v2”，但前提是“我的程序 v2”不存在。

然后我想将“我的程序”重命名为“我的程序旧”，但前提是“我的程序旧”不存在。

然后我想从安装程序安装“我的程序”，但前提是“我的程序”不存在。

我将非常感谢任何指导！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T15:05:13.323

我会尝试这样的事情。在安装过程开始之前发生`ssInstall`的事件阶段[`CurStepChanged`](http://www.jrsoftware.org/ishelp/index.php?topic=scriptevents&anchor=CurStepChanged)，只需检查该文件是否不存在该[`FileExists`](http://www.jrsoftware.org/ishelp/index.php?topic=isxfunc_fileexists)函数，如果不存在，则调用该[`RenameFile`](http://www.jrsoftware.org/ishelp/index.php?topic=isxfunc_renamefile)函数，如果源文件不存在，它将静默失败存在，所以你不需要关心源文件是否存在。然后，在该[`[Files]`](http://www.jrsoftware.org/ishelp/index.php?topic=filessection)部分中，您可以使用该[`onlyifdoesntexist`](http://www.jrsoftware.org/ishelp/index.php?topic=filessection&anchor=onlyifdoesntexist)标志来满足您的最后一个要求。如果你愿意，你可以按照[`commented version`](https://stackoverflow.com/revisions/13071561/4)这个脚本：

```
[Setup]
AppName=My Program
AppVersion=1.5
DefaultDirName={pf}\My Program

[Files]
Source: "My program"; DestDir: "{app}"; Flags: onlyifdoesntexist

[Code]
function GetFileName(const AFileName: string): string;
begin
  Result := ExpandConstant('{app}\' + AFileName);
end;

procedure CurStepChanged(CurStep: TSetupStep);
begin
  if (CurStep = ssInstall) then
  begin
    if not FileExists(GetFileName('My program v2')) then
      RenameFile(GetFileName('My program old'), GetFileName('My program v2'));
    if not FileExists(GetFileName('My program old')) then
      RenameFile(GetFileName('My program'), GetFileName('My program old'));
  end;
end; 
```

# listview - 我对 .getText 有错误

> ID：13071133
> 
> 赞同：0
> 
> 时间：2012-10-25T14:43:58.963
> 
> 标签：listview

我想点击 listview 然后显示文本但它有错误 .getText

```
 ListView listView = getListView();
   listView.setTextFilterEnabled(true);

    listView.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

            Toast.makeText(getApplicationContext(),
                    ((TextView) view).findViewById(R.id.line_a).getText(), 
                    Toast.LENGTH_SHORT).show();
        }

              }); 
```

}

# meteor - 我可以阻止使用流星身份验证访问 html 页面吗？

> ID：13071136
> 
> 赞同：2
> 
> 时间：2012-10-25T14:44:03.097
> 
> 标签：meteor

我在文档中读到流星支持数据库级别的用户授权我如何使用它来防止用户在未登录时访问 Html 页面？可能吗 ？谢谢让-路易斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:39:53.257

是的你可以。Meteor 0.5.0 带有一个经过修改和完全加载的 Accounts API。在您的应用程序中启用对这组 API 的访问的一种方法是安装`accounts-password`包。

```
meteor add accounts-password 
```

使用使用手动创建用户`Accounts.createUser`并登录用户使用`Meteor.loginWithPassword`（或许多可用的外部授权服务之一）。或者只是使用[accounts-ui](http://docs.meteor.com/#accountsui)功能使用内置登录 UI 自动处理身份验证内容。

实施身份验证部分后，使用以下条件限制对您的网页（或部分网页）的访问：

```
if (Meteor.user()) {
    // do stuff
}
else {
    $('body').html('<div class="error">You must be logged in to use this application!</div>');
} 
```

# java - 签名恶意软件检测

> ID：13071139
> 
> 赞同：5
> 
> 时间：2012-10-25T14:44:12.913
> 
> 标签：java, security, signature, malware

我正在编写基于签名扫描的恶意软件检测。据我了解，主要思想是将扫描文件的签名与黑名单中的签名进行比较。 [在这里](http://computer-programming-languages.knoji.com/create-your-own-professional-antivirus-program-using-the-programming-software-visual-basic/)我发现签名是某种 MD5 哈希，但是我怎样才能从文件中获取它呢？还有其他类型的签名吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:23:23.543

MD5 哈希是文件内容的摘要。如果您有 MD5 哈希的黑名单，是的，您可以将文件与它们进行比较。我认为这代表了一种非常简单和脆弱的恶意软件扫描方式，但这绝对是一个开始。这将是脆弱的，因为比较 MD5 哈希只能识别两个文件何时完全相同。任何类型的随机性引入恶意文件都会使这种扫描方法失效。

大多数语言都有一些标准的方法来生成 MD5 哈希。C#、VB 和 VC++ 可以使用[MD5](http://msdn.microsoft.com/en-us/library/system.security.cryptography.md5.aspx#Y0)类，PHP 有[散列](http://php.net/manual/en/function.hash.php)函数（使用“MD5”作为第一个参数），在 java 中有[MessageDigest](http://docs.oracle.com/javase/6/docs/api/java/security/MessageDigest.html)等。

有许多其他可用的[散列算法](http://en.wikipedia.org/wiki/Cryptographic_hash_function#Cryptographic_hash_algorithms)可用于此目的。MD5 已被证明缺乏某些应用程序，因此 SHA 算法正成为这些应用程序的标准。对于此应用程序，您不会期望恶意攻击会尝试创建匹配，而是尝试阻止匹配的相反，任何散列标准算法，包括 MD5 应该足以合理地确保不会出现误报可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:07:42.200

要在 java 中挖掘消息，您可以使用[MessageDigest](http://docs.oracle.com/javase/7/docs/api/java/security/MessageDigest.html)。根据其 javadoc，它支持 MD5、SHA-1 和 SHA-256。

# java - Guava Optional 类型，当转换返回另一个 Optional

> ID：13071143
> 
> 赞同：5
> 
> 时间：2012-10-25T14:44:18.530
> 
> 标签：java, generics, guava

我有一种方法可以产生`Optional<String>`

但是这个 String 必须在另一个应用程序级别解析为 Integer 或 Long。

这我有一个`Function<String, Integer>`可以应用于字符串，以产生一个整数。此转换可能会失败，因为 String 可能不是 Integer 可解析值。

* * *

我想在转换失败时返回 Optional，而不是抛出解析异常。

我不能让 STRING_TO_INTEGER_FUNCTION 返回 null，因为 Guava 不允许这样做：

```
Exception in thread "main" java.lang.NullPointerException: Transformation function cannot return null. 
```

因此，我唯一能做的就是得到一个`Function<String,Optional<Integer>>`，但最终结果是一个`Optional<Optional<Integer>>`，这并不是很酷，因为我可能需要对其进行其他转换。

* * *

有人知道我怎么能在番石榴做这样的事情吗？

```
Optional.of("Toto").transform(STRING_TO_INTEGER_FUNCTION) = // Optional<Integer> ? 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T15:09:02.443

我想你可以这样做：

```
public static void main(final String[] args) {
  final Optional<Integer> valid = Optional.of("42")
      .transform(STR_TO_INT_FUNCTION)
      .or(Optional.<Integer>absent());
  System.out.println(valid); // Optional.of(42)
  final Optional<Integer> invalid = Optional.of("Toto")
      .transform(STR_TO_INT_FUNCTION)
      .or(Optional.<Integer>absent());
  System.out.println(invalid); // Optional.absent()
  final Optional<Integer> absent = Optional.<String>absent()
      .transform(STR_TO_INT_FUNCTION)
      .or(Optional.<Integer>absent());
  System.out.println(absent); // Optional.absent()
}

private static final Function<String, Optional<Integer>> STR_TO_INT_FUNCTION =
    new Function<String, Optional<Integer>>() {
      @Override
      public Optional<Integer> apply(final String input) {
        return Optional.fromNullable(Ints.tryParse(input));
      }
    }; 
```

当您使用 Optional -> transform -> 或在一行中（分配转换后的可选整数会产生）时，用法并不是*那么笨拙。*`Optional<Optional<Integer>>`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-26T00:33:15.123

使用`Optional.transform`just 似乎与可​​能失败的转换不兼容 - 从理论上讲，这意味着一个*可选*的选项，当您想要做的是巩固缺勤时。我建议使用以下内容：

```
Optional<String> strOptional = Optional.of("Toto");
Optional<Integer> intOptional =
        strOptional.isPresent()
        ? Optional.fromNullable(Ints.tryParse(strOptional.get()))
        : Optional.<Integer>absent(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-14T07:27:32.513

除上述以外的其他选择：

*   使用普通的 if/else（Guava 团队建议不要过度使用此类结构，遵循这些建议通常是明智的 - 否则您将不会节省太多代码行并使可读性变差）
*   使用肮脏的技巧：`from(singleton("Toto")).transform(STRING_TO_INTEGER_FUNCTION).filter(notNull()).first().orNull()`- 只是假设的想法，恕我直言，它的可读性也很差。至少它不包含泛型、?: 运算符或匿名类，但代价是更多的静态导入。
*   等待 Java 8，其中 Optional.map 允许空转换结果

[您可以为http://code.google.com/p/guava-libraries/issues/detail?id=1171](http://code.google.com/p/guava-libraries/issues/detail?id=1171)投票。不幸的是，Guava 团队似乎对将这个问题转化为某种结果犹豫不决。

# c# - “数据结构”和“编译代码”有什么区别

> ID：13071144
> 
> 赞同：1
> 
> 时间：2012-10-25T14:44:25.140
> 
> 标签：c#, expression-trees

> 表达式树目的：
> 
> 表达式树必须先编译后才能使用。这是因为表达式树实际上是一种**数据结构**，而不是**编译代码**。为什么？因为此代码预计将跨网络使用，或者 - 换句话说 - 在**其他进程中**（可能在其他计算机上运行）。

**来自： http:** [//geekswithblogs.net/Martinez/archive/2009/06/29/understanding-expression-trees.aspx](http://geekswithblogs.net/Martinez/archive/2009/06/29/understanding-expression-trees.aspx)

“数据结构”和“编译代码”有什么区别；编译后的代码在 C# 中是什么样子的？！通过这篇文章，我了解到每一行不包含 Array 或 List 的都是编译代码（例如：“Human H1=new Human(18);”）。

*请不要用示例向我解释什么是表达式树，我想要一个关于这个问题的明确答案。*

感谢您的时间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:04:03.023

如果不先编译表达式树，就无法执行它，因为表达式树有不同的用途：它们作为可执行代码的灵活蓝图，而不是可执行代码本身（相当不灵活）。

表达式树是在高于代码本身的抽象级别*描述*代码（编译或未编译）的数据结构。与代码不同，数据结构可以被操纵以形成描述其他一些代码的不同结构。与数据结构不同，可以对代码进行评估以产生结果。

考虑这个例子：

```
Expression p1 = Expression.Parameter(typeof(int), "a");
Expression p2 = Expression.Parameter(typeof(int), "b");
Expression expr = Expression.Add(p1, p2); 
```

它显示了一个`expr`正在创建的表达式，描述了一个简单的表达式树`a+b`。至此，我们有了一个树状数据结构，其中包含三个节点——两个节点代表参数，一个节点代表加法。我们可以用表达式树做很多事情，比如检查它的内容，找到它的返回类型等等。我们甚至可以操纵它的结构来基于它制作其他表达式：例如，我们可以添加第三个参数，然后 make `a+b+c`，如下所示：

```
Expression p3 = Expression.Parameter(typeof(int), "c");
expr = Expression.Add(expr, p3); 
```

然而，我们不能做的一件事是传递两个整数值并获得它们的总和：表达式树不提供评估它们的方法。为此，您需要真正的代码，而不是代码描述。

表达式树提供了一种通过编译将代码描述转换为代码的方法。将表达式树制作成 lambda 并`Compile()`在其上调用方法后，您将返回编译后的[CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)代码，如下所示：

```
ldarg.0
ldarg.1
add
ret 
```

此代码可以传递两个值进行评估，并将总和返回给您。但是，一些信息在翻译过程中丢失了：具体来说，参数的名称`a`并`b`不再存在于编译的代码中：它们不是执行计算所必需的，因此它们已被删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:52:43.207

您必须在其编写的上下文中阅读该语句：表达式树是一种数据结构，因此在编译表达式树之前无法评估它所代表的表达式。

让我们这样说吧：当你构建你的项目时，下面的表达式将被编译。然而，当您运行您的应用程序时，将要发生的只是它将构建一个表达式树（即数据结构）。

```
Expression<Func<int, int, bool>> f = (a, b) => a < b; 
```

为了实际执行表达式`f`，您必须对其进行编译`f.Compile()`。请注意，有两个编译发生：

*   第一次编译是在您编译代码时（即如上所示）。
*   第二次编译是当您运行代码并编译由树表示的实际表达式时。

## 更新

> 为什么我不能在没有 f.Compile() 的情况下执行它？这就是我真正要问的

该`Expression.Compile`方法“将表达式树描述的 lambda 表达式编译为可执行代码……”如果您没有可执行代码，则无法执行表达式树。**这与问为什么在编译之前不能执行程序没有什么不同。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T14:56:44.670

在 C# 中，来自 C# 源代码的“编译代码”是所谓的 IL（中间语言）代码。（这类似于 Java 字节码。）根据官方标准，它也称为 CIL（通用中间语言）。（MSIL 的意思相同，它是微软对 CIL 的实现。）

当然，当您的 .NET 应用程序运行时，此 IL 代码将由 CLR（Common Language Runtime，.NET 的虚拟机）进一步翻译为本机代码（机器代码）。（在某些情况下，IL 代码在安装时被编译为本机代码，例如，`mscorlib.dll`在您的 Windows 中的 .NET 程序集是预先编译的；这称为 NGEN，即*本机映像生成*。）

当文章提到*数据结构*时，这意味着您的表达式树表达式本身并没有像您“通常的”C# 表达式或指令那样*编译为 IL 代码（在您的应用程序的编译时）。*相反，即使在 IL 代码中，它们仍然是**数据**（不要忘记：您的“常用”表达式成为IL 代码中的**指令**，因为它们在编译时由 C# 编译器转换为直接 IL 代码）。**稍后**，可以（明确地）要求它们被编译，即树将在运行时被评估（编译）。在那之前，它们仍然是数据结构。

相同问题的另一种方法：您的 C# 源代码具有明确定义的语法，对吗？当您的 C# 编译器解析和编译它时，它还需要解析您的所有表达式（“通常”的表达式，即在这里忘记表达式树）。例如，当它解析时`x = y + 5*z;`，它需要根据这些数据构建自己的树，但这只会在***编译时*****在 C# 编译器内部发生***。完成后，例如，您的 Visual Studio 显示“构建成功”，然后生成您的 IL 代码，即构建您的应用程序。在此构建过程中，C# 编译器还使用树和此类结构作为表达式。*

 *现在您可以以非常相似的方式查看表达式树：它们表示树结构中的表达式，但这些树在您的应用程序中可用并且可以在运行时编译（与 C# 编译器的内部树结构不同，它们是在构建应用程序时在内部使用，并且在构建应用程序后将被丢弃。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T14:57:57.760

表达式树（数据结构）可以被认为是关于由 lambda 或代码表示的代码的元数据。表达式树被编译成可执行代码（lambda）。表达式树是抽象语法树 (AST)——它是一个对象，表示您要执行的代码的结构。（[丑陋的细节在这里](http://en.wikipedia.org/wiki/Abstract_syntax_tree)）

所以，为了回答你的问题，表达式树是元数据（我猜你可以考虑一个数据结构），而 lambda 是可以执行的实际位。

在我看来，表达式树的目的不是您引用的文章所维护的。在我看来，表达式树允许您在代码中组合 lambda（或代码），以便您的 LINQ 语句（或其他代码）可以灵活和动态。我不认为它真的归结为通过电线传输你的结构。我想这可能是一种用途，但在我看来，表达式树的一个非常有用的目的是功能代码的组合。

我希望这有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T14:47:52.403

这两个概念非常不同，目前还不清楚您要将它们与什么衡量标准进行比较。这就像问苹果和爱情有什么区别......

*   数据结构是数据如何建模和存储的概念。

*   编译后的代码是编译后的结果。

您可以编写实现特定数据结构的代码并由他们编译。*

# iphone - 将图像添加到 iPhone 应用程序的 XCode .m 文件

> ID：13071151
> 
> 赞同：-3
> 
> 时间：2012-10-25T14:44:38.587
> 
> 标签：iphone, ios, xcode

我想在我的 XCode 项目中添加一个图像 (joke.png)。它应该具有 0,190,320,60 的 GCRectMake 设置。我如何将它添加到 .m 文件代码中？假设我已经将它添加到 UIButton 列表下的 .h 文件中。它只是为了展示 - 没有交互。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:05:23.970

您需要做的是将 UIImageView 添加到您的视图中。

在您的 viewdidload 中创建该 imageview 并将其添加到视图中。

例如

```
 UIImageView* imageView = [[UIImageView alloc] initWithImage:[Uiiimage: imagenamed:@"joke.png"];
imageView.frame = cgrectmake( 0,190,320,60);
[self.view addSubview:image view]; 
```

# java - ace:dataTable 默认过滤器

> ID：13071156
> 
> 赞同：1
> 
> 时间：2012-10-25T14:44:46.777
> 
> 标签：java, jsf, datatable, icefaces, icefaces-3

我的 Web 应用程序使用一个`<ace:dataTable>`并且我想向列添加一个默认过滤器。数据表使用延迟加载。我知道我可以将托管 bean 中的过滤器添加到“加载”方法中。

但是我需要在渲染页面开始时将过滤器设置为视图中的过滤器“文本框”，而不是在托管 bean 中实现过滤器。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T08:42:46.947

如果我能理解你的问题。如果你有这样的数据表：

```
<ace:dataTable id="carTable"
                  value="#{dataTableBean.carsData}"
                  var="car"
                  paginator="true"
                  paginatorPosition="bottom"
                  rows="10">
        <ace:column id="id" headerText="ID" sortBy="#{car.id}"
                    filterBy="#{car.id}" filterMatchMode="contains">
            <h:outputText id="idCell" value="#{car.id}"/>
        </ace:column>
    </ace:dataTable> 
```

你有一个这样的html代码：

```
<div class="ui-datatable ui-widget" id="form:carTable">
<div>
    <table>
        <thead>
            <tr>
                <th class="ui-widget-header">
                    <div class="ui-header-column ui-sortable-column clickable" id="form:carTable:id">
                        <span>
                            <span class="ui-header-text" id="form:carTable:id_text">ID</span>
                        </span>
                        <span class="ui-header-right">
                            <span class="ui-sortable-control">
                                <span class="ui-sortable-column-icon">
                                    <a class="ui-icon ui-icon-triangle-1-n" tabindex="0"
                                       style="opacity: 0.33; "></a>
                                    <a class="ui-icon ui-icon-triangle-1-s" tabindex="0"
                                       style="opacity: 0.33; "></a>
                                </span>
                                <span class="ui-sortable-column-order"></span>
                            </span>
                        </span>
                        <input class="ui-column-filter" id="form:carTable:id_filter" name="form:carTable:id_filter"
                               size="1" tabindex="0" value=""/>
                    </div>
                </th>
            </tr>
        </thead>
        <tbody class="ui-datatable-data ui-widget-content">
            <tr class=" ui-datatable-even  " id="form:carTable_row_0" tabindex="0">
                <td>
                    <span id="form:carTable:0:idCell">1</span>
                </td>
            </tr>
            <tr class=" ui-datatable-odd  " id="form:carTable_row_1" tabindex="0">
                <td>
                    <span id="form:carTable:1:idCell">2</span>
                </td>
            </tr>
        </tbody>
    </table>
</div> 
```

在那里你可以看到输入。然后我会使用jQuery：

```
$(document).ready(function() {
$('[id$=id_filter]').html("default_text_for_filtering");}); 
```

# android - Android Gradle 构建中不使用 libs 文件夹中的 Jar 文件

> ID：13071158
> 
> 赞同：26
> 
> 时间：2012-10-25T14:44:50.553
> 
> 标签：android, adt, gradle

我刚开始玩 Android 的 gradle 构建系统。

但是我无法构建我的项目之一。它取决于 libs/ 文件夹中的 jar。

由于缺少jar文件中的所有类，因此任务`gradle build`失败。`compileDebug`

这是一个图书馆项目！这是我的 build.gradle 文件：

```
buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:0.2'
    }
}

apply plugin: 'android-library'

android {
    target='android-16'
    sourceSets {
        main {
            manifest {
                srcFile 'AndroidManifest.xml'
            }
            java {
                srcDir 'src'
            }
            res {
                srcDir 'res'
            }
            assets {
                srcDir 'assets'
            }
            resources {
                srcDir 'src'
            }
        }
    }
} 
```

我错过了一些明显的东西吗？

戈登

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-10-25T16:06:21.237

刚刚自己找到了答案：

似乎当前版本的 Android Gradle 插件不会在 libs/ 文件夹中查找 jar。所以你必须自己添加它们：

```
dependencies {
    compile files('libs/mylib.jar')
} 
```

或者

```
dependencies {
    compile fileTree(dir: 'libs', include: '*.jar')
} 
```

将其放置在`android`命名空间中，如下所示：

```
android {
    target = "android-15"

    dependencies {
        compile fileTree(dir: 'libs', include: '*.jar')
    }
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-20T06:58:33.177

万一这些解决方案都不适合您，您可能需要尝试手动提供 *.jar 的路径：

```
compile files('../<your-library-folder>/<your-library>.jar') 
```

The `'../'` part means that Gradle will search for the library starting from the root projects folder (not app module).

# java - 带有 jax-rs 的 REST 服务：BeanCreationException

> ID：13071161
> 
> 赞同：5
> 
> 时间：2012-10-25T14:45:00.240
> 
> 标签：java, web-services, spring, rest, jax-rs

您好，我对 apache cxf 和休息服务（使用 jax-rs 和 spring）有疑问。

我正在尝试发布休息服务：userService

错误是：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userService': Invocation of init method failed; nested exception is org.apache.cxf.service.factory.ServiceConstructionException
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1422)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:518)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:455)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:293)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:290)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:192)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:895)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:425)
    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:282)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:204)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:47)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4791)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680)
Caused by: org.apache.cxf.service.factory.ServiceConstructionException
    at org.apache.cxf.jaxrs.JAXRSServerFactoryBean.create(JAXRSServerFactoryBean.java:194)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeCustomInitMethod(AbstractAutowireCapableBeanFactory.java:1546)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1487)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1419)
    ... 22 more
Caused by: javax.ws.rs.WebApplicationException
    at org.apache.cxf.jaxrs.AbstractJAXRSFactoryBean.checkResources(AbstractJAXRSFactoryBean.java:315)
    at org.apache.cxf.jaxrs.JAXRSServerFactoryBean.create(JAXRSServerFactoryBean.java:144)
    ... 29 more
25 oct. 2012 16:42:21 org.apache.catalina.core.StandardContext listenerStart
GRAVE: Exception lors de l'envoi de l'évènement contexte initialisé (context initialized) à l'instance de classe d'écoute (listener) org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userService': Invocation of init method failed; nested exception is org.apache.cxf.service.factory.ServiceConstructionException
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1422)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:518)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:455)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:293)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:290)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:192)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:895)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:425)
    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:282)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:204)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:47)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4791)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680)
Caused by: org.apache.cxf.service.factory.ServiceConstructionException
    at org.apache.cxf.jaxrs.JAXRSServerFactoryBean.create(JAXRSServerFactoryBean.java:194)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeCustomInitMethod(AbstractAutowireCapableBeanFactory.java:1546)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1487)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1419)
    ... 22 more
Caused by: javax.ws.rs.WebApplicationException
    at org.apache.cxf.jaxrs.AbstractJAXRSFactoryBean.checkResources(AbstractJAXRSFactoryBean.java:315)
    at org.apache.cxf.jaxrs.JAXRSServerFactoryBean.create(JAXRSServerFactoryBean.java:144)
    ... 29 more 
```

web.xml ：

```
 <display-name>CXF REST Example</display-name>
<description>CXF REST Example</description>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/applicationContext-cxf.xml</param-value>
</context-param>

<listener>
    <listener-class>
        org.springframework.web.context.ContextLoaderListener
    </listener-class>
</listener>

<servlet>
    <servlet-name>CXFServlet</servlet-name>
    <servlet-class>
        org.apache.cxf.transport.servlet.CXFServlet
    </servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>CXFServlet</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping> 
```

applicationContext-cxf.xml ：

```
<import resource="classpath:META-INF/cxf/cxf.xml" />

<jaxrs:server id="userService" address="/">
    <jaxrs:serviceBeans>
        <ref bean="userService" />
    </jaxrs:serviceBeans>
</jaxrs:server> 
```

服务接口：

```
@Path("v1")
public interface UserService {
    @GET
    @Path("user")
    @Produces({ MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON })
    public User getUser();
} 
```

服务实现：

```
@Service("userService")
public class UserServiceImpl implements UserService {

    public User getUser() {
        User u = new User();
        u.setFirstName("plop");
        u.setLastName("plop");
        u.setEmail("plop@plop.com");
        u.setUuid("1");

        return u;
    }

} 
```

非常感谢您的帮助 ！这个问题要了我的命！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:19:48.477

我认为你的问题在这里：

```
<jaxrs:server id="userService" address="/">
    <jaxrs:serviceBeans>
        <ref bean="userService" />
    </jaxrs:serviceBeans>
</jaxrs:server> 
```

您正在创建一个名为“userService”的 bean，它引用了一个名为“userService”的 bean。也许将 jaxrs:server 端点的 bean 名称更改为与“userService”不同的名称？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-08T21:02:58.083

如果您正在使用 Spring Boot，请转到 application.properties 或 application.yaml 设置 cxf.jaxrs.component-scan=true 然后使用 @Service 注释您的服务实现类，这只是避免编写 xml 配置文件的一种捷径

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-20T06:12:02.587

尝试这个：

```
<jaxrs:server address="/">
<jaxrs:serviceBeans>
<ref bean="userService" />
</jaxrs:serviceBeans>
</jaxrs:server> 
```

移除 id 属性，bean 名称应以小写字母开头。

# php - 我收到日期功能的警告如下

> ID：13071164
> 
> 赞同：0
> 
> 时间：2012-10-25T14:45:08.943
> 
> 标签：php

> 警告：`date()`[function.date]：依赖系统的时区设置是不安全的。您*需要*使用 date.timezone 设置或`date_default_timezone_set()`功能。如果您使用了这些方法中的任何一种，但仍然收到此警告，您很可能拼错了时区标识符。

我们在第 8 行选择`Asia/Calcutta`了 for`5.5/no DST``E:\xampp\htdocs\suraj\central_db_system\dwnld_reg_data.php`

我通过调用函数解决了这个警告

```
date_default_timezone_set('America/Los_Angeles'); 
```

但是每次我都必须在每个页面上添加这个功能。

有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:49:52.907

添加`date.timezone = "America/Los_Angeles"`到您的 php.ini 文件中。

或者：

`date_default_timezone_set('America/Los_Angeles');`在您的应用程序中的全局位置（引导程序）或入口点。

或者：

`ini_set("date.timezone","America/Los_Angeles");`在您的应用程序中的全局位置（引导程序）或入口点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:49:40.910

解决方案：

1.  创建一个初始化脚本并将其包含在每个文件中
2.  在文档根目录中创建一个 .htaccess 文件并写入`php_value date.timezone America/Los_Angeles`
3.  在您的 php.ini 中全局应用选项 2

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:47:16.463

是的，在您的`php.ini`文件中，或者在基本配置文件中使用`include()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T14:49:19.723

php.ini

```
[Date]
; Defines the default timezone used by the date functions
; http://php.net/date.timezone
date.timezone = 'America/Los_Angeles' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T14:51:03.973

使用以下代码创建一个 php 文件，您应该能够看到该属性当前设置为：

```
<?php phpinfo(); ?> 
```

php.ini 通常是一个巨大的文本文件，因此您只需使用简单的文本编辑器打开它并搜索设置。

在我的测试服务器上，时区设置如下所示：

```
;;;;;;;;;;;;;;;;;;;
; Module Settings ;
;;;;;;;;;;;;;;;;;;;

[Date]
; Defines the default timezone used by the date functions
; http://php.net/date.timezone
date.timezone = UTC 
```

您只需将“UTC”更改为您需要的任何时区。注意：如果您在与托管公司共享的服务器上，您可能无法自己编辑 PHP ini，托管公司可能会拒绝这样做，但如果是您自己的服务器，您可以更改您喜欢的内容。

小心 php.ini，如果你删除了错误的行，它可能会完全停止 php 的工作。首先备份 php.ini 总是明智的。

# java - 使用Java中的Jsoup从网站的url读取输入隐藏标签值

> ID：13071165
> 
> 赞同：1
> 
> 时间：2012-10-25T14:45:21.877
> 
> 标签：java, jsoup

我正在编写一个 Java 应用程序，它试图从网页中获取内容。我尝试编写下面给出的代码。

当我尝试`<a>`从网站获取所有链接（html 标记）时，我的代码运行良好，但是当我尝试从`input type="hidden"`标记中获取值时出现问题。

```
 String url = "http://www.justdial.com/Bangalore/pc-repair-%3Cnear%3E-jp-nagaer";
 Document doc = Jsoup.connect(url).get();
 Elements input = doc.select("a[href]");
 System.out.print(input); 
```

此代码工作正常.. 它提供了该网站中包含的所有链接.. 但我想要来自`input type="hidden"`. 我该怎么办？

如果我这样做了，`doc.select("input[hidden]")`那么结果就会有一个`null`值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:10:23.743

你应该使用

```
doc.select("input[type=hidden]") 
```

得到你想要的标签。您提议的版本将返回所有`<input hidden="..">`标签，而不是带有`<input type="hidden">`.

# php - CodeIgniter + Grocery Crud - 如何将字段设置为开/关（布尔，复选框）以及如何将其设置为数字的选择下拉列表（1-10）

> ID：13071171
> 
> 赞同：1
> 
> 时间：2012-10-25T14:45:39.807
> 
> 标签：php, html, mysql, codeigniter, grocery-crud

CodeIgniter + Grocery Crud - 如何将字段设置为开/关（布尔，复选框）以及如何将其设置为数字的选择下拉列表（1-10）？

我设置了杂货店，在某些领域，它们是：

bool 值（但设置为 ints 或 varchars，因此 groceycrud 将其显示为

或者

选择值为 0-10 的下拉列表（这些存储为整数，但它用于评级系统）

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T22:03:36.963

为此，您可以检查 [field_type](http://www.grocerycrud.com/documentation/options_functions/field_type)方法。在您的情况下，您需要：

字段类型 true_false 用于开/关布尔值。例如：

```
$crud->field_type('my_field','true_false'); 
```

杂货店 CRUD 的默认开/关是活动/非活动 (1/0)，但您可以将 lang 文件中的文本更改为：assets/grocery_crud/languages/english.php（或您的语言）为 on off。

对于下拉列表的第二种情况，您可以使用类型为“dropdown”或“enum”的 field_type。有关更多信息，您可以访问：[http://www.grocerycrud.com/documentation/options_functions/field_type#dropdown-field](http://www.grocerycrud.com/documentation/options_functions/field_type#dropdown-field) 和 [http://www.grocerycrud.com/documentation/options_functions/field_type#enum-field](http://www.grocerycrud.com/documentation/options_functions/field_type#enum-field)也有示例.

还要考虑下拉类型仅适用于 >= 1.3.2 的版本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-02-12T11:29:36.650

您可以根据您的语言更改配置文件中单选按钮的值。对于英语，它在这里：

assets\grocery_crud\languages\english.php

只需更改以下两行：

```
$lang['form_inactive']            = 'inactive';
$lang['form_active']            = 'active'; 
```

无论您想要什么，就您而言，例如：

```
$lang['form_inactive']            = 'female';
$lang['form_active']            = 'male'; 
```

并确保将字段更改为布尔值，如果您还没有：

$this->grocery_crud->change_field_type('field_name','true_false');

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-12T09:33:48.050

```
// now This part is for update or edit
$crud->callback_edit_field('government',array($this,'radio_edit_callback'));

//Function for the callback_edit_field 
public function radio_edit_callback($value) {
    //$value will be having the present value(Y or N) that is in the list or database.
    if($value == 'Y') {
        return '<input type="radio" name="government" value=" '.$value.' " checked="checked" /> Yes &nbsp;
       <input type="radio"  name="government" value="N" /> No ';
    } else {
        return '<input type="radio" name="government" value="Y" /> Yes &nbsp;
        <input type="radio" name="government" value=" '.$value.' " checked="checked" /> No';
    }
} 
```

# c# - 如何在 vspackage 中获取当前的解决方案配置？

> ID：13071175
> 
> 赞同：2
> 
> 时间：2012-10-25T14:45:49.503
> 
> 标签：c#, visual-studio, vspackage

我正在制作 Visual Studio 包，我需要知道打开的解决方案名称和配置。我怎样才能得到这些信息？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:39:35.787

如果您有对 EnvDTE 的引用，则可以使用`dte.Solution`and `dte.Solution.SolutionBuild.ActiveConfiguration`。

# asp.net - ASP.NET MVC4 创建具有导航属性的新模型

> ID：13071178
> 
> 赞同：0
> 
> 时间：2012-10-25T14:45:58.850
> 
> 标签：asp.net, asp.net-mvc-4

我是 ASP.NET 的新手，我正在尝试实现以下目标：

我正在使用 MVC4 和代码优先方法开发 EF，我有以下模型：

```
public class Booking {
  // Lot of standard int/string attributes

  // And a navigation attribute
  public virtual Teaching teaching {get;set;}
} 
```

教学是另一种非常基础的模式。我使用初始化程序引导我的数据库，一切都很好，EF 为我创建了我的 SQL 结构并自动将 Teaching_Id 添加到 Booking 表。我的模型也正确填充（我猜是延迟加载），我可以打印 model.Teaching.name 例如在我的索引视图中。

我现在正在寻找创建表单以将新的预订添加到我的数据库中，并且我希望用户能够从列表中选择教学。到目前为止，我设法实现了这一点，我的观点非常标准（自动生成）：

```
 <div class="editor-label">
        @Html.LabelFor(model => model.BookingDate)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.BookingDate)
        @Html.ValidationMessageFor(model => model.BookingDate)
    </div> 
```

到目前为止，对于简单的属性。我为选择列表制作了这个

在我的控制器中：

```
var id = (int)Membership.GetUser().ProviderUserKey;
ViewBag.listTeachings = db.Teachings.Where(x => x.Teacher.UserId == id).ToList(); 
```

在我看来（在表格内）

```
 @Html.DropDownListFor(model => model.Teaching.Id, new SelectList(ViewBag.listTeachings, "Id", "Id")) 
```

（出于测试目的，我在下拉列表中标出了 Id）

当我发布我的表单时，一切正常（没有模型状态错误），但数据库中没有添加任何内容。在我的 POST 内容表单中，我有一个 Teachings.Id 条目。我还尝试使用 DropDownListFor model => model.Teaching 而不是 model.Teaching.Id 但是一个 Teaching 条目被传递给 PostData 我猜他不知道如何将纯 int 转换为一个对象。

任何帮助表示赞赏，感谢您的阅读并提前感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T09:00:46.797

好的，所以我在 Create() 函数中传递的模型实际上包含了 Teaching.Id，但似乎 EF 无法将它映射到好的外键或其他任何东西。

我通过在 POST Create 控制器中使用此解决方案使其工作：

```
 model.Teaching = teachingRepo.Find(model.Teaching.Id); 
```

注意到这不起作用：

```
 model.Teaching = new Teaching() { Id = model.Teaching.Id } 
```

（如果有人对此有解释，我不反对）

# objective-c - 我需要返回 tableView:heightForRowAtIndexPath 什么？

> ID：13071179
> 
> 赞同：0
> 
> 时间：2012-10-25T14:46:00.087
> 
> 标签：objective-c, cgfloat

我有一个带有几个表的视图控制器。我希望一张桌子比其他桌子有更大的单元格。现在，我有：

```
- (CGFloat *)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (tableView != myBigTable)
    {
        return 44;
    }
    else
    {
        return 88;
    }
} 
```

我收到警告说

> 从结果类型为“CGFloat *”（又名“float *”）的函数返回“int”的不兼容整数到指针转换

当我运行它时，它崩溃了。

我也试过：

*   `return 44.0`- double 到 float* 转换的错误
*   `return 44.0f`- float 到 float* 转换的错误
*   `CGFloat *height; height = 44; return height;`- 与直接返回我想要的值相同的错误

我一直在寻找类似`[CGFloat floatWithDouble:44.0];`NSNumber 的东西，但我没有找到任何东西。我应该使用什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:49:26.467

你的函数声明是错误的。一定是

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath 
```

返回类型 is`CGFloat`和 not `CGFloat *`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:50:29.927

你应该使用

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath; 
```

并删除您的返回类型后的 *。

# ruby - 修改一个数组并 push 形成另一个数组

> ID：13071181
> 
> 赞同：0
> 
> 时间：2012-10-25T14:46:02.147
> 
> 标签：ruby

还有什么比这更好的方法：

```
X = %w(a b c)
Y = %w()
  X.each do |x|
    Y << "good_" + x
  end 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T14:56:45.983

```
%w(a b c).map{|x| "good_#{x}"} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T14:48:38.123

数组上的收集方法会做

```
Y = X.collect{|e|'good_'+e} 
```

或者

直接地

```
Y = %w(a b c).collect{|e|'good_'+e} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T18:27:21.327

将它们都定义在同一行：

```
y = ( x = %w[a b c] ).map { |i| 'good_%s' % i }

y
=> ["good_a", "good_b", "good_c"]

x
=> ["a", "b", "c"] 
```

# php - JSON - 使用 Javascript 从文件中收集数据时出错

> ID：13071182
> 
> 赞同：0
> 
> 时间：2012-10-25T14:46:01.657
> 
> 标签：php, javascript, json, uncaught-exception

我有一个使用 JSON 收集数据的 jQuery 商店定位器文件，但每次我尝试加载页面时它都会出错。

***未捕获的类型错误：无法读取未定义的属性“0”***

显示代码的行在下面突出显示

```
if(settings.jsonData == true){ dataType = "json"; }
    else{ dataType = "xml"; }

    $.ajax({
    type: "GET",
    url: settings.dataLocation,
    dataType: dataType,
    success: function(data) {

        //After the store locations file has been read successfully
        var i = 0;
    if(settings.jsonData == true)
        {
          //Process JSON
          $.each(data, function() {
            console.log(data);
            var name = this.locname;
            var lat = this.lat;
            var lng = this.lng;
            var address = this.address;
            var address2 = this.address2;
            var city = this.city;
            var postcode = this.postcode;
            var phone = this.phone;
            var web = this.web;
            web = web.replace("http://","");
            var hours1 = this.hours1;
            var hours2 = this.hours2;
            var hours3 = this.hours3;

            var distance = GeoCodeCalc.CalcDistance(orig_lat,orig_lng,lat,lng, GeoCodeCalc.EarthRadiusInMiles);

            //Create the array
            locationset[i] = new Array (distance, name, lat, lng, address, address2, city, postcode, phone, web, hours1, hours2, hours3);

            i++;
          });
        }
        else
        {
          //Process XML
          $(data).find('marker').each(function(){
            //Take the lat lng from the user, geocoded above
            var name = $(this).attr('name');
            var lat = $(this).attr('lat');
            var lng = $(this).attr('lng');
            var address = $(this).attr('address');
            var address2 = $(this).attr('address2');
            var city = $(this).attr('city');
            var postcode = $(this).attr('postcode');
            postcode = postcode.replace(" ","");
            var phone = $(this).attr('phone');
            var web = $(this).attr('web');
            web = web.replace("http://","");
            var hours1 = $(this).attr('hours1');
            var hours2 = $(this).attr('hours2');
            var hours3 = $(this).attr('hours3');

            var distance = GeoCodeCalc.CalcDistance(orig_lat,orig_lng,lat,lng, GeoCodeCalc.EarthRadiusInMiles);

            //Create the array
            locationset[i] = new Array (distance, name, lat, lng, address, address2, city, postcode, phone, web, hours1, hours2, hours3);

            i++;
          });
        }

      //Sort the multi-dimensional array numerically
      console.log(locationset);
      locationset.sort(function(a, b) {
        var x = a[0];
        var y = b[0];
        return ((x < y) ? -1 : ((x > y) ? 1 : 0));
      });

      //Check the closest marker
      **********if(locationset[0][0] > settings.distanceAlert)***********
      {
        alert("Unfortunately, our closest location is more than " + settings.distanceAlert + " miles away.");
      } 
```

即使我尝试 console.log 位置集，它也是空白的

**编辑**

这是我的 json 代码，根本不认为标题是正确的

```
<?php

header('Content-Type: application/json');

$results = mysql_query("SELECT sl_store AS locname, sl_latitude AS lat, sl_longitude AS lng, sl_address AS address, sl_address2 AS address2, sl_city AS city, sl_zip AS postcode, sl_phone AS phone, sl_url AS web, sl_hours AS hours1 FROM `wp_store_locator`");
$rows = array();
while($r = mysql_fetch_assoc($results)) {
$rows[] = $r;
}
echo json_encode($rows);

?> 
```

# excel - xla 与 xlam 插件，有什么区别？

> ID：13071185
> 
> 赞同：5
> 
> 时间：2012-10-25T14:46:10.773
> 
> 标签：excel, vba, add-in

有人可以解释一下 xla Excel 插件格式和 xlam Excel 插件格式之间的区别吗？谷歌搜索没有提供任何有用的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T15:10:16.477

m 代表启用宏，这是新格式（从 Excel 2007 开始）。
这些是可以调用宏的加载项。另一方面，您也可以拥有 xlax 扩展，这些扩展适用于宏自由工作簿。

还要注意 xls 和 xlsm 之间的区别，其中 xlsx 文件也不包含宏。

为什么？我的猜测是主要原因是安全性。
有些人不喜欢接收文件，不知道其中是否有潜在有害的宏。在旧格式中，您无法根据文件扩展名进行区分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-25T14:28:57.780

这两个文件都是启用宏的文件：

*   XLA 文件是 Office 97 的 excel 文件 - 作为插件加载
*   XLAM 文件是 excel 2003+ 文件，它们实际上是 zip 文件，其中包含每个 opendocument 协议的 xml 文档。

# php - 如何获取运行时确定的可调用参数的数量？

> ID：13071186
> 
> 赞同：15
> 
> 时间：2012-10-25T14:46:25.060
> 
> 标签：php, reflection, callback

*注意：通过写这个问题，我已经发现我对使用新的语言功能过于热情了。更清洁的解决方案是使用策略模式......不过，我很好奇是否有适当的方法来解决这个问题。*

TL；DR：您能否在不求助于手动类型检查各种可调用对象的情况下反思 PHP 中的通用可调用对象？

在 PHP 5.4 中，我们有了一个新的类型提示：callable。这似乎很有趣。我想我会通过以下方式利用它：

```
<?php
    public function setCredentialTreatment(callable $credentialTreatment) {
       // Verify $credentialTreatment can be used (ie: accepts 2 params)
       ... magic here ...
    }
?> 
```

到目前为止，我的思路是对可调用对象进行一系列类型检查，并从中推断要使用哪个 Reflection* 类：

```
<?php
if(is_array($callable)) {
    $reflector = new ReflectionMethod($callable[0], $callable[1]);
} elseif(is_string($callable)) {
    $reflector = new ReflectionFunction($callable);
} elseif(is_a($callable, 'Closure') || is_callable($callable, '__invoke')) {
    $objReflector = new ReflectionObject($callable);
    $reflector    = $objReflector->getMethod('__invoke');
}

// Array of ReflectionParameters. Yay!
$parameters = $reflector->getParameters();
// Inspect parameters. Throw invalidArgumentException if not valid.
?> 
```

现在，对我来说，这感觉过于复杂。我是否错过了某种捷径来实现我在这里尝试做的事情？欢迎任何见解:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-09-03T01:50:38.630

我创建了一个与 call_user_func() 非常相似的较短版本，并在 PHP 手册中针对回调/可调用对象的所有不同类型上对其进行了测试。这样您几乎可以在任何地方使用它。call_user_func() 不仅接受对象，而且对我来说这个函数也没有意义，因为它只处理回调。

下面包括有关如何使用它的测试和建议，我希望这会有所帮助：

```
function getNrOfParams($callable)
{
    $CReflection = is_array($callable) ? 
    new ReflectionMethod($callable[0], $callable[1]) : 
    new ReflectionFunction($callable);
    return $CReflection->getNumberOfParameters();
} 
```

整个测试及其结果：

```
<?php   
class Smart
{
    public function __invoke($name)
    {

    }

    public function my_callable($one, $two, $three)
    {

    }

    public static function myCallableMethod($one, $two) 
    {

    }

    public static function who()
    {
            echo "smart the parent class";
    }
}

class Smarter extends Smart
{
    public static function who()
    {
        echo "smarter";
    }
}

function my_ca($one)
{

}

function getNrOfParams($callable)
{
    $CReflection = is_array($callable) ? new ReflectionMethod($callable[0], $callable[1]) : new ReflectionFunction($callable);
    return $CReflection->getNumberOfParameters();
}
// Test 1 Callable Function
echo "Test 1 - Callable function:" . getNrOfParams('my_ca');

// Test 2 Static method
echo " Test 2 - Static class method:" . getNrOfParams(array('Smart', 'myCallableMethod'));

// Test 3 Object method
$smart = new Smart();
echo " Test 3 - Object method:" . getNrOfParams(array($smart, 'my_callable'));

// Test 4 Static method call (As of PHP 5.2.3)
//echo " Test 4 - Static class method call:" . getNrOfParams('Smart::myCallableMethod');
// Calling a static method this way does not work in ReflectionFunction.
// However, Test 2 provides a solution.

// Test 5 Relative static method (As of PHP 5.3.0)
//echo " Test 5 - Relative static class method:" . getNrOfParams(array('Smarter', 'parent::who'));
// Calling a relative static method doesn't work either. ReflectionMethod lacks support.
// All other tests work.

// Tesy 6 __invoke
echo " Test 6 - __invoke:" . getNrOfParams(array($smart, '__invoke'));

// Test 7 Closure
$closure = function($one, $two, $three)
{
    // Magic
};
echo " Test 7 - Closure:" . getNrOfParams($closure); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-07-03T20:57:29.967

TL; DR 我不这么认为。如果您需要通用解决方案，则需要检查所有可调用类型。

以下函数可用于获取`ReflectionFunctionAbstract`PHP 中任何通用可调用对象的实例：

```
function reflectionOf(callable $callable): ReflectionFunctionAbstract
{
    if ($callable instanceof Closure) {
        return new ReflectionFunction($callable);
    }
    if (is_string($callable)) {
        $pcs = explode('::', $callable);
        return count($pcs) > 1 ? new ReflectionMethod($pcs[0], $pcs[1]) : new ReflectionFunction($callable);
    }
    if (!is_array($callable)) {
        $callable = [$callable, '__invoke'];
    }
    return new ReflectionMethod($callable[0], $callable[1]);
} 
```

那么就可以得到参数个数如下：

```
reflectionOf($func)->getNumberOfParameters(); 
```

希望这对某人有所帮助。这个答案可能迟到了，但其他解决方案都没有提供对通用可调用对象的全面覆盖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-21T06:06:18.347

您可以使用参数传递数组，并且可以计算数组值以了解传递给回调函数的参数。

# java - 使用 Maven 和 ParameterSupplier 组织项目

> ID：13071188
> 
> 赞同：0
> 
> 时间：2012-10-25T14:46:30.630
> 
> 标签：java, junit

我想知道在以下情况下对项目/模块组织有什么建议：

1.  我有一个项目`DomainObjects`，我有一个课程`MyObject`
    1.  在我`/src/test/java`有`DomainObjects`测试`MyObject`
2.  我有一个项目`Client`依赖于`DomainObjects`

我想添加一个`ParameterSupplier`被调用的`MyObjectTestSupplier`类来提供测试实例`MyObject`供`Client`.

`MyObjectTestSupplier`在`DomainObjects`项目中提供似乎是最有意义的。这是我的困境...

1.  如果我将供应商放入其中`src/test/java`，`DomainObjects`它将无法提供给`Client`.
2.  我不想把它放进去`src/main/java`，`DomainObjects`因为这意味着 JUnit 必须作为编译依赖`DomainObjects`包含在我的生产代码中。
3.  如果我把供应商放在某个项目中，`DomainObjectsTest`我有三个选择
    1.  只放供应商是测试项目，但这意味着测试`DomainObjects`不能使用这个供应商。
    2.  将所有测试和供应商放入其中`DomainObjects`，`DomainObjectsTest`但这意味着`DomainObjects`即使测试失败，maven 也会成功编译
    3.  `src/test/java`在of`DomainObjects`和`src/main/java`of中复制供应商`DomainObjectsTest`。

我想过尝试制作`DomainObjectsTest`一个模块，`DomainObjects`但只有在包装在`DomainObjects`这里`pom`不起作用的情况下才有效。

想法？建议？

编辑：作为解释，`MyObject`是一个简单的 bean（只是 getter 和 setter），我使用该`ParameterSuppier`模式来提供填充的 bean 实例。供应商提供实用方法来轻松创建 bean 的填充实例以用于测试。我这样做是为了在我的项目中不重复这个人口代码（或模拟等价物）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:25:17.123

这是您所描述的一个糟糕的设计示例。您的单元测试不能依赖外部依赖项成为“单元”。

您需要做的是模拟所有依赖项并仅测试`Client`代码。根据您期望此类执行的操作，使用[Mockito](http://code.google.com/p/mockito/)或您选择的其他库在客户端项目中创建模拟实例。在自己的项目中`MyObject`测试行为 - .`MyObject``DomainObjects`

在 mockito 创建一个 mock 只是：

```
import static org.mockito.Mockito.*;
...
MyObject myMock = mock(MyObject.class);
when(myMock.doWhatYouNeed(params)).thenReturn(whatYouExpect); 
```

**编辑：**

另一个想法

将 DomainObjects 的测试发布`test-jar`为[此处](http://maven.apache.org/guides/mini/guide-attached-tests.html)描述的类型工件，并将其用作客户端中的测试范围依赖项。但这实在是太丑了……

不错的设计是：

*   `DomainObjectAPI`项目`MyObject`，
*   `DomainObjectTestSupplier`使用`DomainObjectAPI`供应商，
*   `DomainObject`用于`DomainObjectAPI`编译和`DomainObjectTestSupplier`测试
*   `Client`使用`DomainObjectAPI`,`DomainObject`进行编译和`DomainObjectTestSupplier`测试。

这只是一个矫枉过正。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T04:24:45.337

正如[有关此特定主题的官方 Maven 迷你指南](http://maven.apache.org/guides/mini/guide-attached-tests.html)所说，您应该将项目的测试工件发布`DomainObjects`到本地 Maven 存储库（或您想要或能够的任何地方），并将该`DomainObjects-X.Y-tests`工件用作项目中的测试范围依赖项`Client`。

发布测试工件是通过使用[Maven JAR 插件](http://maven.apache.org/plugins/maven-jar-plugin/test-jar-mojo.html)[的*jar:test-jar*](http://maven.apache.org/plugins/maven-jar-plugin/test-jar-mojo.html)目标来完成的。

If you include this artifact as a test-scoped dependency in your `Client` project then any other project that depends on the `Client` project won't inherit your `DomainObjects` project's test artifact, because *test-scoped dependencies are not transitive* by default as stated by [the official guide on Maven's dependency mechanism](http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Dependency_Scope).

# php - 如果第一个语句成立，则执行第二个语句

> ID：13071189
> 
> 赞同：0
> 
> 时间：2012-10-25T14:46:37.913
> 
> 标签：php, codeigniter

如果目录不存在，我创建目录并保存文件，如果目录存在，我也可以只保存文件。应该一次创建一个文件，而不是像下面的代码那样同时创建一个文件。如果现在创建了第一个文件，那么只应在调用函数时创建下一个文件。这些文件被命名为 R1,R2....Rn。我怎样才能做到这一点，这会同时创建它们

```
$fileName1=$fileName1='somedir/'.$thedir.'/'.$thefile.'_R1.xlsx';

...

if (!dir($dirName)) 
{
    mkdir('somedir/' . thedir, 0777);
    $objWriter->save($fileName);
}

if (dir($dirName) && (!file_exists($fileName))) 
{
    $objWriter->save($fileName);
} 

if (dir($dirName) && file_exists($fileName)) 
{
    $objWriter->save('somedir/' . $thedir . '/' . $thefile . '_R1.xlsx');
}

if (dir($dirName) && file_exists($fileName1)) 
{
    $objWriter->save('somedir/' . $thedir . '/' . $thefile . '_R2.xlsx');
}

... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:55:34.903

```
if (!is_dir($dir))
  mkdir($dir, 0777);

$suffixes = array('_R1.xlsx', '_R2.xlsx');
foreach($suffixes as $suffix) {
  $fileName = $dir.'/' . $thefile . $suffix;
  if (! file_exists($fileName)) {
    $objWriter->save($fileName);
    break;
  }
} 
```

您必须添加错误处理，并注意仅检查文件可能会产生并发问题（两个进程都尝试查看文件不存在并尝试创建它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:55:57.790

您将需要使用该`[is_dir][1]`功能来检查文件夹是否存在。

查看此代码 - 对您的代码进行了一些修改

```
$fileName1=$fileName1='somedir/'.$thedir.'/'.$thefile.'_R1.xlsx';
....

// Directory does not exist - create it
if (!is_dir($dirName)) 
{
    mkdir('somedir/' . thedir, 0777);
    $objWriter->save($fileName);
}

// Directory exists
if (is_dir($dirName))
{
    // File does not exist - create it
    if (!file_exists($fileName))) 
    {
        $objWriter->save($fileName);
    } 

    // Check one more time if the file exists
    if (file_exists($fileName))) 
    {
        $objWriter->save('somedir/' . $thedir . '/' . $thefile . '_R1.xlsx');
        $objWriter->save('somedir/' . $thedir . '/' . $thefile . '_R2.xlsx');
    }
}

....... 
```

# java - Spring 3 Web MVC - @Controller method() 通过注解的前后处理功能

> ID：13071191
> 
> 赞同：3
> 
> 时间：2012-10-25T14:46:45.797
> 
> 标签：java, spring, spring-mvc

我希望能够拥有以下内容：

```
@Controller    
public class MyController {

    @RequestMapping(value="/someurl", method=RequestMethod.GET)
    @PreProcess
    @PostProcess
    public String doStuff(ModelMap map) {
        //do stuff
        return "someurl";
    }

} 
```

`@PreProcess`和是任意命名的`@PostProcess`注解。

我一直在寻找一个可行的例子，但我找不到。我查看了 AOP 和`@Aspect`注释的使用，但我发现它非常复杂。我正在尝试做的一个工作示例会很棒。

我过去曾对 Spring Security 进行过采样，但这并不是我所需要的，因为我需要自定义处理，几乎是我想要的任何东西。

我知道这个功能在 .Net MVC 中可用。希望它也能在春天上市。

非常感谢任何帮助或指示。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T15:16:20.973

您可以注释方法以[`@ModelAttribute`](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/web/bind/annotation/ModelAttribute.html)在控制器方法之前执行方法。或使用[`interceptor`](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-handlermapping-interceptor)

示例`@ModelAttribute`

```
@Controller    
public class MyController {

    @RequestMapping(value="/someurl", method=RequestMethod.GET)
    public String doStuff(@ModelAttribute("something") Something something, ModelMap map) {
        //do stuff
        // here you can do what you want with something it has been provided to you in the method parameters
        return "someurl";
    }

    @ModelAttribute("something")
    public Something something() {
        // do what you need
        return new Something();
    }
} 
```

该`something()`方法将在每个具有`@RequestMapping`注释的方法之前调用，因此在`doStuff()`方法之前。

# javascript - 多个 Javascript 文件，我想将 URL 常量取出到一个单独的文件中

> ID：13071192
> 
> 赞同：0
> 
> 时间：2012-10-25T14:46:46.527
> 
> 标签：javascript

正如标题所说，我有一些 javascript 文件。有些部分调用了一些网站。我希望能够将网站存储在不同的文件中，这样如果网站发生更改，我们只需要进行一项更改而不是多次更改。

有什么建议么？

我试着做类似的事情

```
/**
 * Returns URLs
 */
var URLCONTEXT = "/root-url/context/";
var URLROOT = "/root-url/";

function getContextUrl(){
    return URLCONTEXT;
}

function getRootUrl(){
    return URLROOT;
} 
```

但这没有办法与其他 JS 文件进行通信 =/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:50:23.633

将您的 url 常量包含在 js 文件中，例如

```
url-constants.js

var URLCONTEXT = "/root-url/context/";
var URLROOT = "/root-url/"; 
```

并在其他 js 文件之前首先引用此 js 文件。

并且您将能够在任何其他 js 文件中使用 url-constants 变量。

```
other.js

function getContextUrl(){
    return URLCONTEXT;
}

function getRootUrl(){
    return URLROOT;
} 
```

将这些包含在您的页面中，例如

```
<script language="text/javascript" src="url-constants.js"></script>
<script language="text/javascript" src="other.js"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:49:45.373

var 定义在函数之外，而用名称定义的函数位于全局命名空间中。只要首先加载此 JS 文件，您就可以从其他 JS 文件中访问它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:54:40.613

你应该能够做到这一点。只需确保在访问它的文件*之前包含带有 url 的文件。*

另外，我不建议用这些来污染全局范围，即使你用大写字母命名它们。怎么定义

```
var URLS = {
    urlContext: '/root-url/context',
    urlRoot: '/root-url'
}; 
```

并在带有 URLS.urlContext 和 URLS.urlRoot 的其他文件中使用它们？

# objective-c - UIWebView 仅在输入焦点上向下滚动 iOS 6

> ID：13071195
> 
> 赞同：15
> 
> 时间：2012-10-25T14:46:53.263
> 
> 标签：objective-c, ios, uiwebview, ios6

我正在以模式加载 UIWebView。该网页的一些输入与 iOS 5 中的预期完全一样。但是在 iOS 6 中，只要输入获得焦点，键盘就会自动将表单“居中”，即使输入有足够的空间显示在上面键盘。由于某些输入位于页面顶部，这会迫使它们离开视图，因此用户无法看到他们正在输入的内容。向上滚动以查看输入会导致键盘停止工作，直到关闭并重新聚焦输入（进而再次将其滚动到视野之外）。这是 iOS 6 中的预期行为吗？当输入获得焦点时（如 iOS 5 的工作方式），有什么方法可以防止 webview 滚动？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-27T04:41:37.677

在不了解您的代码的内部工作原理的情况下，我将尽我所能提供帮助。如果不出意外，我希望能提供一些思考。你问了两个问题：

**它是 iOS6 中的预期行为吗？**

你所看到的肯定很奇怪。奇怪的是，webView 是居中表单而不是居中输入字段。它绝对不应该导致活动输入字段滚动到视图之外。此外，键盘似乎停止工作，这很奇怪。但是，预计在 iOS 5 和 6 中会看到关于 webView 滚动的不同行为。正如您所说，iOS 5 将 inputField 滚动到视图中，而 iOS6 将其置于中心位置。

**当输入获得焦点时（如 iOS 5 的工作方式），有什么方法可以防止 webview 滚动？**

是的。我在下面提供了执行此操作的代码——即阻止 webView 滚动。如果这正是您想要做的，那就太好了。但是，停止滚动 webView 与获得与 iOS5 相同的行为不同。尽管如此，我还是想按照您的要求为您提供此选项。

```
#import "ViewController.h"

@interface ViewController () <UIScrollViewDelegate> {
    CGPoint origin;
}

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    NSURLRequest *request = [[NSURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://www.google.com"]];
    [self.webView loadRequest:request];
    self.webView.scrollView.delegate = self;

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(keyboardWillShow)
                                                 name:UIKeyboardWillShowNotification
                                               object:nil];

    // NOTE THAT SIMPLY DISABLING THE SCROLL WILL NOT PREVENT KEYBOARD SCROLL
    //[self.webView.scrollView setScrollEnabled:NO];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)keyboardWillShow {
    NSLog(@"keyboard");
    origin = self.webView.scrollView.contentOffset;

}

-(void)scrollViewDidScroll:(UIScrollView *)scrollView {
    NSLog(@"scroll");
    [self.webView.scrollView setContentOffset:origin];
}

@end 
```

**如果你想要一致的滚动行为......**

我花了一些时间来编写这个滚动修改。您可以将其用作参考，以使您自己的滚动行为在 iOS 5 和 6 中保持一致。在这段代码中：当用户点击网页上的文本输入框时，代码将通过保持页面滚动到其当前位置来停止默认滚动行为。不幸的是，没有办法取消所有滚动，而是您必须覆盖滚动。一旦默认滚动被“抑制”，它就会获取活动输入框的位置并滚动到该位置。这会将活动输入框放在屏幕顶部。您可以根据自己的喜好进行修改。例如，可以使用 [UIScrollView scrollRectToVisible] 使其更像 iOS5。

```
#import "ViewController.h"

@interface ViewController () <UIScrollViewDelegate> {
    CGPoint origin;
    CGPoint activeElementOrigin;
    BOOL pauseScroll;
}

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    NSURLRequest *request = [[NSURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://www.google.com"]];
    [self.webView loadRequest:request];
    self.webView.scrollView.delegate = self;

    pauseScroll = NO;
    origin = CGPointZero;

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(keyboardWillShow)
                                                 name:UIKeyboardWillShowNotification
                                               object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(keyboardDidShow)
                                                 name:UIKeyboardDidShowNotification
                                               object:nil];
}

- (void)keyboardWillShow {
    NSLog(@"keyboard");
    pauseScroll = YES;
    origin = self.webView.scrollView.contentOffset;
}

- (void)keyboardDidShow {
    NSLog(@"keyboard DID SHOW");
    pauseScroll = NO;
    [self.webView.scrollView setContentOffset:activeElementOrigin animated:YES];
}

-(void)scrollViewDidScroll:(UIScrollView *)scrollView {
    NSLog(@"scroll");

    if (pauseScroll) {
        [self.webView.scrollView setContentOffset:origin animated:NO];

        NSString *javaScript = [NSString stringWithFormat:@"function f(){ var textField = document.activeElement; return textField.getBoundingClientRect().top; } f();"];
        NSString *textFieldRectTop = [self.webView stringByEvaluatingJavaScriptFromString:javaScript];
        activeElementOrigin = origin;
        activeElementOrigin.y = [textFieldRectTop floatValue]-10;
    }
}

@end 
```

如果此代码对您有所帮助，您将非常高兴将赏金奖励给我。我将不胜感激。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T08:05:33.220

一种解决方法可能是禁用此 UIWebView 中的滚动：

```
UIScrollView *scrollView = webView.scrollView;
[scrollview setScrollEnabled:NO];
[scrollView bounces:NO]; 
```

另一个可能是设置此滚动视图的 UIEdgeInsets，但我对此知之甚少。

我认为这是 iOS 5 和 6 中的标准行为，滚动以使输入字段位于键盘顶部（就像 Safari 一样）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T21:41:48.193

这篇文章的选中答案有你的答案： [How to make a UITextField move up when keyboard is present?](https://stackoverflow.com/questions/1126726/how-to-make-a-uitextfield-move-up-when-keyboard-is-present)

简而言之，您需要向上移动包含被推出视图的输入的视图。该帖子还包含有关如何执行此操作的示例代码。

希望这可以帮助。

# django - ExpatError+标签不匹配+expatbuilder.py

> ID：13071198
> 
> 赞同：1
> 
> 时间：2012-10-25T14:47:00.817
> 
> 标签：django, python-2.7, e-commerce

我正在尝试通过 Jim McGaw 开始 Django 电子商务。在完成第 5 章时，在引入 google-checkout 选项后，我遇到了以下错误。谁能给我一些建议/可能的解决方案？

代码片段如下，

```
$

    def get_checkout_url（请求）：
        重定向网址 =''
        req = _create_google_checkout_request（请求）
        尝试：
            response_xml = urlopen(req).read()
        除了 HTTPError，错误：
            提出错误
        除了 URLError，错误：
            提出错误
        别的：
            redirect_url = _parse_google_checkout_response(response_xml)
        返回重定向网址

    $ def _parse_google_checkout_response(response_xml):
        重定向网址 = ""
        打印 response_xml
        xml_doc = minidom.parseString(response_xml) # -- 在这里打断 --
    # xml_doc = minidom.parse(response_xml)
        根 = xml_doc.documentElement
        节点 = root.childNodes[1]
        如果 node.tagName == 'redirect-url'：
            redirect_url = node.firstChild.data
        如果 node.tagName == '错误消息'：
            引发 RuntimeError(node.firstChild.data)
        返回重定向网址

```

错误日志如下：

```
**环境：**

Django 版本：1.4.1
Python版本：2.7.1

追溯：
get_response 中的文件“/Users/username/work/pythonwork/djtrunk/django/core/handlers/base.py”
  111\. 响应 = 回调（请求，*callback_args，**callback_kwargs）
show_cart 中的文件“/Users/username/work/pythonwork/ecomstore/cart/views.py”
  19\. checkout_url = checkout.get_checkout_url(请求)
get_checkout_url 中的文件“/Users/username/work/pythonwork/ecomstore/checkout/checkout.py”
  6\. 返回 google_checkout.get_checkout_url(request)
get_checkout_url 中的文件“/Users/username/work/pythonwork/ecomstore/checkout/google_checkout.py”
  27.redirect_url = _parse_google_checkout_response(response_xml)
_parse_google_checkout_response 中的文件“/Users/username/work/pythonwork/ecomstore/checkout/google_checkout.py”
  46\. xml_doc = minidom.parseString(response_xml)
parseString 中的文件“/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/xml/dom/minidom.py”
  1924\. 返回 expatbuilder.parseString(string)
parseString 中的文件“/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/xml/dom/expatbuilder.py”
  940.返回builder.parseString(string)
parseString 中的文件“/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/xml/dom/expatbuilder.py”
  223\. parser.Parse（字符串，真）

异常类型：/cart/ 处的 ExpatError
异常值：不匹配的标记：第 1460 行，第 4 列

```

# django - Django 在查询关系上的错误行为

> ID：13071199
> 
> 赞同：0
> 
> 时间：2012-10-25T14:47:00.867
> 
> 标签：django

最近我在 Django 中发现了一个奇怪的行为。然后，我开始认为问题出在我做这项工作的方式上。

假设我们有 2 个模型

```
class A(models.Model):
    attr1 = models.CharField()
...

class B(models.Model):
    a = models.ForeignKey("A",
        related_name = "bs"
        blank = True,
        null = True) 
```

所以，如果我有一些 B 的项目，没有与 A 的关联，比如 b1、b2、b3，当我设置 A 的新实例时，比如 a1，如果我查询

```
a.bs.all()
b1, b2 and b3 are returned. 
```

它出什么问题了？当我创建一个新实例时，它不应该产生任何关系。我知道 b1,b2 和 b3 没有关系，但默认情况下它们不能关联到任何新实例。

有人知道如何以 Django 方式进行吗？

我知道如果 a1.id: return [] else: a1.bs.all() 我可以做到这一点

但我认为这不是正确的做法。

谁能帮我？

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:02:05.243

这是 Django 中的一个错误，目前被标记为“需要设计决策”：

[https://code.djangoproject.com/ticket/14615](https://code.djangoproject.com/ticket/14615)

# php - Wordpress - 特色图像元框未显示在自定义帖子类型上

> ID：13071202
> 
> 赞同：15
> 
> 时间：2012-10-25T14:47:06.053
> 
> 标签：php, wordpress, thumbnails, custom-post-type

我刚刚创建了一个自定义帖子类型，但由于某种原因，特色图片元框没有出现。

它确实显示在“帖子”帖子类型上。

我为缩略图启用了主题支持，并在我的自定义帖子类型代码中添加了以下代码。

```
<?php

function register_cpt_product() {

    $labels = array( 
        'name' => _x( 'Products', 'product' ),
        'singular_name' => _x( 'Product', 'product' ),
        'add_new' => _x( 'Add New', 'product' ),
        'add_new_item' => _x( 'Add New Product', 'product' ),
        'edit_item' => _x( 'Edit Product', 'product' ),
        'new_item' => _x( 'New Product', 'product' ),
        'view_item' => _x( 'View Product', 'product' ),
        'search_items' => _x( 'Search Products', 'product' ),
        'not_found' => _x( 'No products found', 'product' ),
        'not_found_in_trash' => _x( 'No products found in Trash', 'product' ),
        'parent_item_colon' => _x( 'Parent Product:', 'product' ),
        'menu_name' => _x( 'Products', 'product' ),
    );

    $args = array( 
        'labels' => $labels,
        'hierarchical' => false,
        'description' => 'Allows the user to create products',
        'supports' => array( 'title', 'editor', 'thumbnail', 'revisions' ),
        'public' => true,
        'show_ui' => true,
        'show_in_menu' => true,
        'show_in_nav_menus' => true,
        'publicly_queryable' => true,
        'exclude_from_search' => false,
        'has_archive' => true,
        'query_var' => true,
        'can_export' => true,
        'rewrite' => true,
        'capability_type' => 'post'
    );

    register_post_type( 'product', $args );
}

add_action( 'init', 'register_cpt_product' );

?> 
```

奇怪的是，在列出我的帖子类型条目的页面上，有一个名为 Thumbnail 的列。

![在此处输入图像描述](../Images/3cd01884a6fd434c8bb6b6e183c22f4a.png)

有谁知道发生了什么？

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-25T14:49:05.903

缩略图默认情况下是禁用的，WordPress Codex[在这里](https://codex.wordpress.org/Post_Thumbnails)明确指出，

> 在分配这些图像的界面将出现在“编辑帖子”和“编辑页面”屏幕上之前，主题必须声明它们对帖子缩略图的支持。

如果您已经为每个帖子类型启用它，请确保您还在`add_theme_support('post-thumbnails')`主题/插件中的某个地方完成了操作，或者您的帖子类型在提供给上述函数的帖子类型列表中（第二个参数是帖子类型的可选数组） .

似乎可以将精选帖子的“屏幕选项”设置设置为隐藏/显示每种帖子类型。虽然它很牵强，但它可能已被停用，尽管我猜它应该默认激活。还可以尝试检查返回值`post_type_supports('project', 'thumbnail')`以确定设置是否实际设置为预期，这表明问题仅与管理部分有关。

通过以下代码行将特色帖子元框添加到管理部分：

```
if ( current_theme_supports( 'post-thumbnails', $post_type ) && post_type_supports( $post_type, 'thumbnail' ) )
    add_meta_box('postimagediv', __('Featured Image'), 'post_thumbnail_meta_box', null, 'side', 'low'); 
```

也许您可以在主题/插件中运行该 if 语句并确保它按预期返回 true。如果是这样，您可能还想检查编辑页面的源代码以查看是否`#postimagediv`在标记中但未显示。

**更新**：

我刚刚在 211 主题的末尾粘贴了以下代码，在`functions.php`没有激活插件的 WordPress 3.4.2 安装上，它工作正常 - 类型出现了，我能够看到帖子缩略图元框编辑屏幕。

```
add_theme_support('post-thumbnails');
function setup_types() {
    register_post_type('mytype', array(
        'label' => __('My type'),
        'supports' => array( 'title', 'editor', 'thumbnail', 'revisions' ),
        'show_ui' => true,
    ));
}
add_action('init', 'setup_types'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-05-16T07:59:16.080

我有同样的问题。我使用“自定义帖子类型 ui”插件来创建“投资组合”帖子类型。我尝试了很多东西，但没有奏效。最后我试过这段代码

```
add_action('init', 'my_custom_init');
    function my_custom_init() {
        // 'portfolio' is my post type, you replace it with yours
        add_post_type_support( 'portfolio', 'thumbnail' ); 
    } 
```

有效 ！！我从 codex 得到了这个代码！！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-09T14:52:51.793

如果您正在运行自定义主题，则该主题可能在其自定义文件中的某处有一个 theme_support 调用，这可能会覆盖您的主题支持调用。

如果您可以追踪该主题的调用，则可以将其复制到您自己的主题文件中，然后将您的自定义帖子类型添加到其中。

你可以把它放在一个函数中，然后使用一个动作钩子，比如 after_setup_theme。

这是自定义主题原始支持电话的示例：

```
add_theme_support('post-thumbnails', array('slide-items','post','gallery-items','audio-items','video-items','page','event-items', 
```

我在该主题之外运行了一个子主题，并且需要一个名为“员工”的自定义帖子类型。即使我声明支持包含缩略图的自定义帖子类型，特色图像元框也没有显示。

我将以下代码添加到我的子主题 functions.php 文件中。请注意，我在函数末尾添加了“员工”。

```
add_action( 'after_setup_theme', 'add_theme_support' );

function add_theme_support (){
    add_theme_support('post-thumbnails', array('slide-items','post','gallery-items','audio-items','video-items','page','event-items','staff'));
    } 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-10T02:40:04.530

我意识到这是一个较老的问题，但这些解决方案都不适合我。原来有两个问题，第一：多个插件试图调用`add_theme_support`. 第二个是他们假设某些类型，或者在添加支持时需要了解主题。

在下面的代码片段中，我首先安全地确定主题支持是什么，然后将我的自定义类型添加到列表中。通过在您的插件中执行此操作，它将与其他友好的主题或插件兼容。事实上，我认为a`safe_add_theme_support`会很好。无论如何，我希望这对某人有所帮助，并将他们从一个令人沮丧的夜晚中解救出来。

```
$currentPostThumbnails = get_theme_support('post-thumbnails');
if(is_array($currentPostThumbnails)) {
    add_theme_support( 'post-thumbnails', array_merge($currentPostThumbnails, array( 'mytype' )) );
}else{
    add_theme_support( 'post-thumbnails', 'mytype');
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-19T19:35:26.890

我遇到过几次这个问题。我禁用了 BackupBuddy 插件，特色图像元框又回来了。可能不适用于您的实例，但希望这对其他人有帮助。

可能想尝试禁用所有插件并重新打开它们以查看是否是插件的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-25T15:39:07.410

![wordpress 屏幕选项](../Images/78d4ed180fca7ef9aefedf370d19105d.png)

确保在帖子编辑器页面的屏幕选项中将特色图片设置为在屏幕上显示

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-04T20:40:37.623

虽然这是一个老问题，但它已经被问过很多次了。我遇到了同样的问题，没有修复——直到我意识到，用户还必须有上传图像的能力。如果您使用自定义角色（或以贡献者或订阅者身份登录），您的角色（或用户）必须具有`upload_files`.

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-10-25T16:58:16.623

好吧，我似乎已经解决了这个问题。我运行的是 3.4.2，所以我删除了所有的 wordpress 安装文件（除了 wp-config.php 和我的主题），然后使用升级功能再次进入 3.4.2。在 3.4.1 上有效，但在 3.4.2 上无效。

我再次降级，将等待未来的更新。我只能说这是一个奇怪的错误。

谢谢你们的帮助。

# wordpress - Register_Post_Type URL 重写

> ID：13071203
> 
> 赞同：1
> 
> 时间：2012-10-25T14:47:15.937
> 
> 标签：wordpress

我已经为我的 wordpress 网站上的帖子创建了一个新部分，但是我无法重写 URL，因为它们现在都搞砸了，这是我的代码，任何人都可以将我推向正确的方向吗？

```
 register_post_type('services', array(
'label' => __('Services'),
'singular_label' => __('Services'),
'public' => true,
'show_ui' => true,
'capability_type' => 'post',
'hierarchical' => false,
'rewrite' => false,
'query_var' => false,
'supports' => array( 'title', 'editor', 'thumbnail', 'excerpt', 'custom-fields' )
)); 
```

现在我的网址目前看起来像这样......

[http://examplesite.com/?post_type=services&p=52](http://examplesite.com/?post_type=services&p=52)

我希望它看起来像这样

[http://examplesite.com/services/postname](http://examplesite.com/services/postname)

谁能帮我？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:32:57.190

改为！`'rewrite' => false`_`'rewrite' => true`

或者你可以更明确：

```
'rewrite' => array ('slug' => 'services'), 
```

# c - 如何列出具有 .o 扩展名的静态库中的文件名

> ID：13071205
> 
> 赞同：0
> 
> 时间：2012-10-25T14:47:16.250
> 
> 标签：c, build, static-libraries, disassembly, nm

我有两个 c 程序文件`temp1.c`和`temp2.c`. 我`dot o`为此`temp1.o`和`temp2.o`. 之后，我生成`final.o`并`final.a`结合了这两个`dot o`文件。现在这两个静态库工作正常。

现在 nm 报告`final.a`正在显示所有文件名和符号。但是 nm 报告`final.o`不显示文件名，它只显示符号。

获取我用于创建的文件名列表的方法是什么`final.o`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T14:35:01.383

如果我们`.a`从`.o`files(`temp1.o`和`temp2.o`) 创建文件，那么`.a`将具有所有`.o`文件的文件名及其内容。但是`.o`从某些`.o`文件创建时，它将仅包含所有`.o`文件的内容，并且每个文件的文件名都`.o`不会出现。

# c# - 从 Type 的变量中声明参数的类型？

> ID：13071208
> 
> 赞同：2
> 
> 时间：2012-10-25T14:47:31.600
> 
> 标签：c#

如何将变量的类型放入方法参数中，因为某些东西是由类变量定义的？例如：

```
class MyClass {
   private Type _type;

   public MyClass(Type type) {
      _type = type;
   }

   public void SomeMethod(_type param) { //... }
   public _type OtherMethod() {}

} 
```

所以，我的想法是，我可以将动态类型设置为类中的变量，并将该`Type`变量用作其他对象的类型。

是否可以在 C# 中执行此操作？

**编辑：**

我决定让我的问题更清楚，并解释我为什么要求这样的功能。我试过泛型。然而，泛型的问题在于，每次引用该类的对象时，我都必须声明该类的类型，例如：`MyClass<TSomeType> param`

在我的场景中，我有一个`List<MyClass> dataList`包含`MyClass`. 如果我在 MyClass 上有一个泛型，那么 dataList 必须是`List<MyClass<TSomeType>>`. 在这种情况下，我被卡住了，因为列表只能包含`MyClass<TSomeType>`. 一旦我为整个班级声明了类型，我就不能拥有其他类型的类型。这就是为什么我想知道是否有更动态的方式来声明一个类型，就像我可以将一个类的类型存储到一个变量中，然后像一个类类型一样使用这个变量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T14:49:00.490

> 是否可以在 C# 中执行此操作？

不，编译器会用 a 做什么`MyClass`？它不可能知道方法调用是否有效。

不过，您*可以*使用泛型：

```
class MyClass<T>
{
    public void SomeMethod(T param) { ... }
    public T OtherMethod() { ... }
} 
```

此时，当编译器看到 a 时，`MyClass<string>`它知道它`SomeMethod("foo")`是有效的，但`SomeMethod(10)`不是。

如果您在执行之前*真的*不知道类型，那么您不妨使用`object`：

```
class MyClass
{
    public void SomeMethod(object param) { ... }
    public object OtherMethod() { ... }
} 
```

`Type`...如果您真的愿意，可能会针对 a 进行执行时检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:48:56.890

我认为您在这里寻找的是[泛型](http://msdn.microsoft.com/en-us/library/512aeb7t%28v=vs.80%29.aspx)- 这将为您提供您所追求的以及编译时类型安全的好处。

```
public MyClass<T>
{
    public void SomeMethod(T param)
    {
        ...
    }

    public T OtherMethod()
    {
        ...
    }
} 
```

**用法**

```
var intClass = new MyClass<int>();
intClass.SomeMethod("10"); // would cause a compile error
intClass.SomeMethod(10); // would compile ok
string result = intClass.OtherMethod(); // would cause a compile error    
int result = intClass.OtherMethod(); // would compile ok 
```

# javascript - 如何确定 Javascript 应用程序的范围

> ID：13071211
> 
> 赞同：0
> 
> 时间：2012-10-25T14:47:35.980
> 
> 标签：javascript, oop, scope, this, prototype

> **可能重复：**
> [在 Javascript 中使用“原型”与“这个”？](https://stackoverflow.com/questions/310870/use-of-prototype-vs-this-in-javascript)

我正在阅读这篇关于制作 JS 框架[的博客文章。](http://dailyjs.com/2010/02/25/djscript-part-1-structure/)我（在一定程度上）熟悉 ECMA 原型的概念，以及一般的范围和闭包。但是，我不确定我是否确定以下代码的来龙去脉：

```
var myFramework = (function (window, document) {
    var /* Global variables */

    myFramework = function (el, options) {
        // code
    };

    myFramework.prototype = {
        // code
    };

    return myFramework;
})(window, document); 
```

我理解为什么要传递窗口和文档（以节省资源，如[本视频](http://www.youtube.com/watch?v=mHtdZgou0qU)所述）。尤其让我感到困惑的是，为什么必须同时拥有`myFramework = function () {}`和`myFramework.prototype`？它是干什么用的？为什么不在`this`里面使用声明`myFramework = function () {}`呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:28:48.503

在 javascript 中，原型对象（在您的情况下为 myFramework.prototype）允许该类的所有实例共享相同的方法和属性。例如：

```
myFramework.prototype = {
    version: "0.0.1",
    fancyMethod: function(){//...//}
};

//...// Somewhere else in code.

var framework = new myFramework();
var framework2 = new myFramework();

framework.version; // ---> "0.0.1"
framework2.version; // ---> "0.0.1"

//What if?
myFramework.prototype.version = "0.0.2";
framework.version; // ---> "0.0.2"
framework2.version; // ---> "0.0.2" //This will surprise most developers. 
```

这是因为如果属性不在直接实例上，它会在原型对象中查找属性或方法。但是一旦将属性设置为实例，它就不再查找原型链来查找值。例如。

```
framework.version = "0.0.3";

framework2.version; // ---> "0.0.2" Still looks up the prototype chain.
framework.version; // ---> "0.0.3" Now it finds the property on the instance. 
```

原型对象主要用于方法。在原型对象上使用属性时会有点混乱。

我相信如何使用它的最好例子是 jQuery。如果我是正确的，jQuery.fn 等于 jQuery.prototype。这就是任何先前创建的 jQuery 实例如何获取新分配的方法。这是一个有趣的概念，但很难理解何时使用它。

原型对象使您能够使用新方法和属性（即使已创建实例）即时扩充所有实例，而无需在创建实例时进行分配。

[这是关于 jsFiddle 的示例](http://jsfiddle.net/jaredjbarnes/K2zx7/)

# excel - 连接公式（出现#REF 错误）

> ID：13071218
> 
> 赞同：1
> 
> 时间：2012-10-25T14:47:52.797
> 
> 标签：excel, if-statement, excel-formula

整个下午:)

这有点难以解释，但我很高兴地澄清了哪里需要它。感谢您抽出宝贵的时间阅读这篇文章 ^^ 来吧..

我目前正在创建一个从数据库中提取的电子表格，我的任务是连接来自 2 个相邻单元格的数据。我经常更改数据库，在必要时添加或删除数据，因此数据范围总是不同的。要连接两个单元格，我使用以下公式：

例如：=IF(ISBLANK(B8&H8),"",B8&H8)

当我处理越来越多的数据时，这个公式效果很好，因为我可以简单地将公式向下拖动到我想要的地方，而且我知道每当我刷新数据库时它都会选择公式，而无需在公式最终引用了一个空白单元格。这里的障碍（以及我的查询）是如果我的数据较少，那么在最后一组单元格中的公式看起来像这样之前：

例如：=IF(ISBLANK(#REF!&#REF!),"",#REF!&#REF!)

我之前在其他电子表格中处理过#REF，我只是在语句中使用了 ISERROR，但我不知道是否有可能将其包含在我的公式中。我需要那里的 ISBLANK，所以我有更多的控制权，并且不必经常拖动公式。

如果有更好的解决方法或修改当前公式的方法我感谢您的帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:04:38.647

你会得到这样的东西的唯一方法：

```
=IF(ISBLANK(#REF!&#REF!),"",#REF!&#REF!) 
```

如果您（或您正在使用的系统）以某种方式删除最初引用的单元格，则在公式栏中。这应该是可以避免的。您可以*清除*引用的单元格而不是完全删除它们 - 这样您就不会收到此错误 - 您的公式将保持不变。现在您当然可以使用评论中提供的公式来隐藏错误 - 但在我看来，您问题的根源在于错误首先发生。祝你好运。

# c# - 获取作为字符串传入的属性的值

> ID：13071219
> 
> 赞同：1
> 
> 时间：2012-10-25T14:47:54.027
> 
> 标签：c#, asp.net-mvc, validation

我正在尝试创建一个自定义验证，上面写着“如果 otherValue 为真，则该值必须大于 0。我能够获取该值，但我目前设置 otherValue 的方式，我只有属性的名称，而不是值。可能是因为它作为字符串传入。这个属性将在 5 或 6 个不同的属性上，每次都会调用不同的 otherValue。寻求有关如何获取的帮助otherValue 的实际值（它是一个布尔值）。

这是我当前的代码：

```
public class MustBeGreaterIfTrueAttribute : ValidationAttribute, IClientValidatable
{
    // get the radio button value
    public string OtherValue { get; set; }

    public override bool IsValid(object value)
    {
        // Here is the actual custom rule
        if (value.ToString() == "0")
        {
            if (OtherValue.ToString() == "true")
            {
                return false;
            }
        }
        // If all is ok, return successful.
        return true;
    } 
```

======================编辑=========================

这就是我现在的位置，它有效！现在我需要参考如何制作它，以便在模型中添加属性时可以输入不同的 errorMessage：

```
public class MustBeGreaterIfTrueAttribute : ValidationAttribute, IClientValidatable
{
    // get the radio button value
    public string OtherProperty { get; set; }

    protected override ValidationResult IsValid(object value, ValidationContext context)
    {
        var otherPropertyInfo = context.ObjectInstance.GetType();
        var otherValue = otherPropertyInfo.GetProperty(OtherProperty).GetValue(context.ObjectInstance, null);      

        // Here is the actual custom rule
        if (value.ToString() == "0")
        {
            if (otherValue.ToString().Equals("True", StringComparison.InvariantCultureIgnoreCase))
            {
                return new ValidationResult("Ensure all 'Yes' answers have additional data entered.");
            }
        }
        // If all is ok, return successful.
        return ValidationResult.Success;
    }

    // Add the client side unobtrusive 'data-val' attributes
    public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
    {
        var rule = new ModelClientValidationRule();
        rule.ValidationType = "requiredifyes";
        rule.ErrorMessage = this.ErrorMessage;
        rule.ValidationParameters.Add("othervalue", this.OtherProperty);
        yield return rule;
    }

} 
```

所以我应该能够做到这一点：

```
 [MustBeGreaterIfTrue(OtherProperty="EverHadRestrainingOrder", ErrorMessage="Enter more info on your RO.")]
    public int? ROCounter { get; set; } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T17:21:03.540

有`ValidationAttribute`两种`IsValid`方法，对于您的场景，您必须使用其他人。

```
 public class MustBeGreaterIfTrueAttribute : ValidationAttribute
  {
    // name of the OtherProperty. You have to specify this when you apply this attribute
    public string OtherPropertyName { get; set; }

    protected override ValidationResult IsValid(object value, ValidationContext validationContext)
    {
      var otherProperty = validationContext.ObjectType.GetProperty(OtherPropertyName);

      if (otherProperty == null)
        return new ValidationResult(String.Format("Unknown property: {0}.", OtherPropertyName));

      var otherPropertyValue = otherProperty.GetValue(validationContext.ObjectInstance, null);

      if (value.ToString() == "0")
      {
        if (otherPropertyValue != null && otherPropertyValue.ToString() == "true")
        {
          return null;
        }
      }

      return new ValidationResult("write something here");
    }
  } 
```

**示例用法：**

```
public class SomeModel
{
    [MustBeGreaterIf(OtherPropertyName="Prop2")]
    public string Prop1 {get;set;}
    public string Prop2 {get;set;}
} 
```

参考： http: [//www.concurrentdevelopment.co.uk/blog/index.php/2011/01/custom-validationattribute-for-comparing-properties/](http://www.concurrentdevelopment.co.uk/blog/index.php/2011/01/custom-validationattribute-for-comparing-properties/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:54:11.977

我有点难以理解你想要做什么，但是，

如果你想得到 OtherValue 的布尔表示，你可以这样做

```
bool.Parse(this.OtherValue); 
```

此外，对于字符串比较，有时有助于将大小写和空格从图片中剔除

```
if (this.OtherValue.ToString().ToLower().Trim() == "true") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-20T15:33:28.787

validationContext 具有 ObjectInstance ，它是 SomeModel 类的一个实例，因此您可以使用： `(validationContext.ObjectInstance as SomeModel).Prop1/Prop2`

# x86 - x86 RISC 还是 CISC？

> ID：13071221
> 
> 赞同：49
> 
> 时间：2012-10-25T14:48:11.940
> 
> 标签：x86, cpu, cpu-architecture

根据 Wikipedia，x86 是一种 CISC 设计，但我也听说/读过它是 RISC。什么是正确的？我也想知道**为什么**它是 CISC 或 RISC。什么决定了设计是 RISC 还是 CISC？仅仅*是*微处理器具有的机器语言指令的数量，还是有任何其他特性决定了架构？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-10-25T14:59:16.477

x86 是一种 CISC 架构。指令的数量是一个重要因素，因为所有具有更多指令的 cisc 架构。此外，由于指令在 cisc 中很复杂，它们可能需要 >1 个周期才能完成，而在 RISC 中它们应该是单周期。主要区别在这里：

> ```
> +------------------------------+------------------------------+
> | CISC                         | RISC                         |
> +------------------------------+------------------------------+
> | Emphasis on hardware         | Emphasis on software         |
> | .                            |                              |
> | Includes multi-clock         | Single-clock,                |
> | complex instructions         | reduced instruction only     |
> | .                            |                              |
> | Memory-to-memory:            | Register to register:        |
> | "LOAD" and "STORE"           | "LOAD" and "STORE"           |
> | incorporated in instruction  | are independent instructions |
> | .                            |                              |
> | Small code sizes,            | Low cycles per second,       |
> | high cycles per second       | large code sizes             |
> | .                            |                              |
> | Transistors used for storing | Spends more transistors      |
> | complex instructions         | on memory registers          |
> +------------------------------+------------------------------+ 
> ```

如需进一步研究，请点击此处： [http ://www-cs-faculty.stanford.edu/~eroberts/courses/soco/projects/risc/risccisc/](http://www-cs-faculty.stanford.edu/~eroberts/courses/soco/projects/risc/risccisc/)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-10-25T14:59:02.520

早期的 x86（8086 / 186 / 286 / 386）绝对是 CISC。

然而，最近的处理器可以被视为混合处理器，具有[RISC 内核](https://stackoverflow.com/questions/5806589/why-does-intel-hides-internal-risc-core-in-their-processors)

[此处的](http://sunnyeves.blogspot.com/2009/07/intel-x86-processors-cisc-or-risc-or.html)附加参考

# javascript - JavaScript 对象字面量范围

> ID：13071222
> 
> 赞同：1
> 
> 时间：2012-10-25T14:48:13.630
> 
> 标签：javascript, object, scope, literals

> **可能重复：**
> [Javascript 对象如何引用自身的值？](https://stackoverflow.com/questions/2787245/how-can-a-javascript-object-refer-to-values-in-itself)

我有一些JS如下：

```
var Wrap = {

    Inner : {

        site_base : "http://site.com/",
        marker_purple : site_base + "images/icon/marker-puple.png"
    }
} 
```

`site_base`未定义。 `Wrap.Inner.site_base`未定义。

如何在同一个对象中访问我的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:51:37.460

您遇到的错误是由于未定义的事实`site_base`，因此对象创建失败。

尝试这个：

```
var site_base = "http://site.com/";

var Wrap = {
    Inner : {
        site_base : site_base,
        marker_purple : site_base + "images/icon/marker-puple.png"
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:51:25.387

单独声明的替代方案：

```
var Wrap = { // variable names starting with capital letters make me uncomfortable
  Inner: function() {
    var base = "http://site.com/";
    return {
      site_base: base,
      marker_purple: base + "images/icon/marker-purple.png"
    };
  }()
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:49:53.233

您必须在不同的语句中执行此操作，因为该对象尚不存在。

```
var Wrap = {
    Inner:{
        site_base: "http://site.com/"
    }
};
Wrap.Inner.marker_purple = Wrap.Inner.site_base + "images/icon/marker-puple.png" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:02:36.290

它有效吗？

```
marker_purple : this.site_base + "images/icon/marker-puple.png" 
```

编辑：我可以对其进行测试，并且效果很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T14:50:46.067

[在立即调用函数表达式](http://cnx.org/content/m43269/latest/)中使用闭包：

```
var Wrap = (function(){
  var site_base = "http://site.com/"
  return {
      Inner: {marker_purple : site_base + "images/icon/marker-puple.png"}
  };
}()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-25T14:51:14.070

如其他答案中所述，在实际创建对象之前，您无法访问对象属性。因此你的代码失败了。

但是，当使用 ECMAScript 5 和`Object.create()`函数时，您可以通过使用如下`get()`函数来模仿您想要的行为：

```
var Wrap ={
  Inner: Object.create(Object.prototype, {

    site_base: { writable:true, configurable:true, value: "http://site.com/" },

    marker_purple: {
      get: function() { return this.site_base + "images/icon/marker-puple.png" }
    }
  })
}; 
```

更多信息可以在 MDN 上找到，例如浏览器支持

*   [`Object.create()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)
*   [`Object.defineProperty()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty)

# facebook - Facebook：多个赞按钮和自定义元标签

> ID：13071229
> 
> 赞同：0
> 
> 时间：2012-10-25T14:48:55.123
> 
> 标签：facebook, facebook-like, meta-tags

我在使用 FB 时遇到问题，例如 Button。我的标题中有一个按钮，在每个页面中都带有指向我的站点根目录的 href，因此元标记（og：image，og：title：og：type 等）已针对 index.php 或根页面进行了优化。

现在，在帖子或新闻页面中，我有带有自己按钮的文章，它们必须更改元标记。

是否有可能在每个按钮中设置此按钮配置？我试图不使用 iframe！我认为使用带有按钮的 iframe 到我的根页面，也许可行，但不是最佳做法！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:57:37.477

不，你不能。因为如您所知，Facebook 使用 Open Graph 元标记，并且页面具有独特的元标记。

您唯一能做的就是为您的全球网站创建一个页面（例如，创建 mysite.com 的 FB 粉丝页面）并使用页面插件：

```
<fb:fan profile_id="222496653719" href="http://www.facebook.com/mysite" stream="0" connections="1" logobar="0" width="260" height="100"></fb:fan> 
```

顺便说一句，按照您的意愿“喜欢一个网站”会很奇怪。现在 Facebook 的行为是“分享文章”和“喜欢（网站或其他）页面”。

对于您的帖子，标准 Like Plugin ：

```
<div id="fb-root"></div>
<fb:like href="YOURSPECIFICPOSTURL" layout="button_count" show_faces="false"></fb:like> 
```

# git - 无法推送到新的 gitlab 安装

> ID：13071234
> 
> 赞同：5
> 
> 时间：2012-10-25T14:49:03.237
> 
> 标签：git, vagrant, gitlab

大家下午好

备份了几个旧的 git 存储库，并且正在将它们添加到已知的 gitlab 安装中。安装看起来像这里的指南[https://github.com/gitlabhq/gitlabhq/wiki/VirtualBox-Image](https://github.com/gitlabhq/gitlabhq/wiki/VirtualBox-Image)

像这样添加新的时`origin remote`；

```
git remote add origin git@1.2.3.4:project.git 
```

并尝试推动我得到以下信息

```
fatal: 'project.git' does not appear to be a git repository
fatal: The remote end hung up unexpectedly 
```

Gitlab 安装的行为符合预期，并且可以通过 LAN 中的 HTTP 和 SSH 访问。

gitlab status 任务也能正常返回

```
bundle exec rake gitlab:app:status RAILS_ENV=production 
```

有人知道我现在应该在哪里看吗？难住了。

编辑。

存在 SSH 密钥

我也尝试使用该`ssh://git@example.com/usr/local/project.git`样式添加 git repo

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-05T08:10:09.940

这个问题有点老了，所以我不确定这是否仍然有帮助，但我遇到了同样的问题并最终解决了它。

我在[此错误报告](https://github.com/gitlabhq/gitlabhq/issues/3424#issuecomment-16618595)的其中一条评论中找到了解决方案。

在`/etc/nginx/sites-available/gitlab`中，有一行，如果您关注有用的评论，将拥有您的 IP。改为收听`*:80`。它应该如下所示：

```
listen *:80 default_server;         # e.g., listen 192.168.1.1:80; 
```

然后，重启 Gitlab 和 Nginx：

```
sudo service gitlab restart
sudo service nginx restart 
```

这为我解决了问题。

为了确认这是问题所在，我删除了`*`并输入了 IP，重新启动它又坏了。把它放回去，它起作用了。

我不完全确定为什么会解决它，但我希望这可以帮助那里的人；这是一个非常令人沮丧的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:25:57.087

作为您尝试连接的同一用户执行以下操作：

```
ssh git@1.2.3.4 "ls /usr/local/project.git" 
```

并确保你看到了回购。

然后添加做一个 git clone：

```
git clone git@1.2.3.4:/usr/local/project.git 
```

作为同一个用户。

我怀疑您没有正确的回购位置。

# javascript - 文本框值 onclick onblur 问题

> ID：13071238
> 
> 赞同：0
> 
> 时间：2012-10-25T14:49:08.970
> 
> 标签：javascript, asp.net

```
<asp:TextBox ID="TxtBOX" 
        runat="server"              
        CssClass="text"
        Height="32px" 
        Width="360px"  
        TextMode=MultiLine         
        TextWrapping="Wrap"
        AcceptsReturn="True"
        VerticalScrollBarVisibility="Visible"
        onclick="if(this.value='<%=_data.Obsprevia.ToString()%>'){this.value=''}"             
        onblur="if(this.value=''){this.value='<%=TxtObservaciones.Text.ToString()%>'}">

     </asp:TextBox> 
```

那是我的代码。

默认 TxtBOX.Text 来自后面的代码 (_data_obsprevia)。我想要实现的是，一旦用户单击文本框，就清除该默认文本。如果 txbox 在用户没有写任何东西时失去焦点，则取回该默认文本。

我无法做到这一点，如果用户确实写了一些东西，并且再次失去焦点，文本框又会变空。

谢谢。

**编辑**

修复了 IF 中的 ==，现在看起来像这样

```
<asp:TextBox ID="TxtBOX" 
        runat="server"              
        CssClass="text"
        Height="32px" 
        Width="360px"  
        TextMode=MultiLine         
        TextWrapping="Wrap"
        AcceptsReturn="True"
        VerticalScrollBarVisibility="Visible"
        onclick="if(this.value=='<%=_data.Obsprevia.ToString()%>'){this.value=''}"             
        onblur="if(this.value==''){this.value='<%=TxtObservaciones.Text.ToString()%>'}">

     </asp:TextBox> 
```

但是当我第一次点击它时，它并没有清理默认数据。如果我删除它，然后失去焦点，它会显示`<%=TxtObservaciones.Text.ToString()%>` 不是它内部的价值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:52:27.050

它应该是：

```
if (this.value == '') {} 
```

As`==`比较值并`=`分配一个值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T14:58:46.993

试试这个，一个基于 insertusernamehere 的建议的构建..

```
onclick="if(this.value=='<%=_data.Obsprevia.ToString()%>'){this.value=''}"             
onblur="if(this.value==''){this.value=document.getElementById('<%= TxtObservaciones.ClientID %>').value}" 
```

这会从 javascript 获取文本框中设置的内容，以防在浏览器中更改。

您可能还需要将代码分解为函数

```
 function TxtBOX_OnClick() {
         var TxtBOX = document.getElementById("<%= TxtBOX.ClientID %>");
         if (TxtBOX.value == "<%=_data.Obsprevia.ToString()%>") {
             TxtBOX.value = '';
         }
     }
     function TxtBOX_OnBlur() {
         var TxtBOX = document.getElementById("<%= TxtBOX.ClientID %>");
         if (TxtBOX.value == '') {
             TxtBOX.value = document.getElementById("<%= TxtObservaciones.ClientID %>").value;
         }
     } 
```

和

```
onclick="TxtBOX_OnClick();"             
onblur="TxtBOX_OnBlur();" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:52:19.450

像这样的东西？

```
<input type="text" value="Search..." onclick="if(this.value=='Search...'){this.value=''}" onblur="if(this.value==''){this.value='Search...'}"> 
```

我不熟悉 ASP，但希望这可以帮助:)

# ruby-on-rails - 将 Devise 与 Ruby on Rails 一起使用，如果用户使用无效的 auth_token，我如何将用户发送到登录路径？

> ID：13071239
> 
> 赞同：0
> 
> 时间：2012-10-25T14:49:09.590
> 
> 标签：ruby-on-rails, devise

当我将用户发送到`/dashboard?auth_token=XXX`并且`auth_token`不正确时，用户会被带到`root_path`.

在这种情况下，我希望用户被带到`sign_in`路径，然后`/dashboard`在他们登录后被带到。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T10:14:18.203

Devise 中的默认设置是重定向到“new_#{scope}_session_path”路由（如果可用）。如此处所示：

[https://github.com/plataformatec/devise/blob/master/lib/devise/failure_app.rb#L89](https://github.com/plataformatec/devise/blob/master/lib/devise/failure_app.rb#L89)

因此，假设您使用的是用户范围，请确保您`new_user_session_path`的路由器定义了一个。

关于重定向回原始页面，试试这个 wiki 页面：

[https://github.com/plataformatec/devise/wiki/How-To:-Redirect-back-to-current-page-after-sign-in](https://github.com/plataformatec/devise/wiki/How-To:-Redirect-back-to-current-page-after-sign-in)

请注意，在调用 Devise 的身份验证过滤器之前，需要添加 wiki 页面中的过滤器。

# visual-studio-2010 - Visual Studio 更新后，此 linq 查询将超出索引

> ID：13071240
> 
> 赞同：1
> 
> 时间：2012-10-25T14:49:17.063
> 
> 标签：visual-studio-2010, linq

```
var temp = this.ObjectContext.ActiveDepViews
    .Where(p => p.id== id)
    .Join(this.ObjectContext.Departments.Where(p => p.ida == ida),
        p => p.Id, q => q.Id,
        (p, q) => new { ActiveDepViews = p})
    .Select(p => p.ActiveDepViews)
    .OrderBy(p => p.Name)
    .ToList(); 
```

在我更新 Visual Studio 之前，此查询一直在运行。现在它给了我一个索引超出范围的错误。

我检查了数据，一切都在那里——这没有任何意义。

谁能告诉我如何恢复我在 Visual Studio 2010 上的更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:54:03.100

linq 在这里有一个错误，我很惊讶你可以构建这个 linq

试试这个，这应该工作：

```
var temp = this.ObjectContext.ActiveDepViews.Where(p => p.id== id)
        .Join(this.ObjectContext.Departments.Where(p => p.ida== ida),
        p => p.Id, q => q.Id, (p, q) => new { ActiveDepViews = p, Departments = q})
        .Select(p => p.ActiveDepViews).OrderBy(p => p.Name).ToList(); 
```

# bash - Bash 调用 cmd /c %ProgramFiles(x86)%\

> ID：13071242
> 
> 赞同：3
> 
> 时间：2012-10-25T14:49:20.900
> 
> 标签：bash, msysgit, cmd

从 bash 脚本（来自 msysgit 的 bash），我想运行 MS VB 2010 Express 编译，但以下行均无效：

```
$ $PROGRAMFILES/Microsoft\ Visual\ Studio\ 10.0\\Common7\\ide\\vbexpress.exe path/to/solution.sln /build 
```

结果是`sh.exe": C:\Program: No such file or directory`

```
$ "$PROGRAMFILES/Microsoft\ Visual\ Studio\ 10.0\\Common7\\ide\\vbexpress.exe" path/to/solution.sln /build 
```

结果是`sh.exe": C:\Program Files (x86)/Microsoft\ Visual\ Studio\ 10.0\Common7\ide\vbexpress.exe: No such file or directory`

```
$ cmd /c "$PROGRAMFILES(X86)/Microsoft\ Visual\ Studio\ 10.0\\Common7\\ide\\vbexpress.exe" path/to/solution.sln /build 
```

这将仅打开 cmd-shell，因为 cmd 似乎无法识别参数的参数`/c`

```
$ cmd "/c $PROGRAMFILES(X86)/Microsoft\ Visual\ Studio\ 10.0\\Common7\\ide\\vbexpress.exe" path/to/solution.sln /build 
```

错误消息：命令`C:\Program`“未找到

```
$ /c/Program\ Files\ \(x86\)/Microsoft\ Visual\ Studio\ 10.0/Common7/IDE/vbexpress.exe IOS\\IOS.sln /build 
```

有点工作，但虽然它启动了 VB Express，但它抱怨`C:\Program Files (x86)/Git/build`无法加载 - 显然 shell 扩展`/build`为一条路径。这个解决方案是有缺陷的，因为我想使用环境变量来区分 Windows 的 32 位和 64 位安装。

转义路径分隔符和空间以使其正常工作的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:26:03.423

虽然我没有这个特定的软件，但我相信这样的东西可以工作：

```
"$PROGRAMFILES/Microsoft Visual Studio/10.0/Common7/IDE/vbexpress.exe" 'IOS\IOS.sln' '//build'

```

我尝试使用它来调用其他一些软件，例如：

```
"$PROGRAMFILES/Internet Explorer/iexplore" 'T:\public_html\index.html'

```

# javascript - Pentaho Kettle 修改的 Java 脚本 setVariable

> ID：13071245
> 
> 赞同：3
> 
> 时间：2012-10-25T14:49:23.107
> 
> 标签：javascript, pentaho, kettle

我想从数据流中的现有字段动态创建一个变量（不是新字段），然后修改该变量。原因是，我需要在 Sql 语句的子句中使用的字符串列表周围加上
单引号。Kettle 消除了字段中的单引号，但它们保留在变量中。我最好的猜测是在修改后的 Java 脚本中使用 setVariable，但从那里我被难住了。`'``IN`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T22:34:52.523

I must not have enough rep to attach files to answers. Too bad because I have a ktr that does this nicely.

I first add the "'" as a new field to the rows. I then pass the rows with the values I want to transform into a list into a Group By step. I choose an aggregate of 'Concatenate strings separated by' and use a value of `','`, and give the result a new name like 'list'.

Then I pass that result row to a Calculator step where the calculation is A + B + C. I specify the "'" field for values A and C and the list field for value B. Then I pass that result to a Set Variables step.

In the parent job I get a variable that looks just as you would expect: `'val1','val2','val3'`. No JavaScript needed.

# python - xmlsec1 标志在命令行上工作，但在 Python 代码上失败

> ID：13071246
> 
> 赞同：5
> 
> 时间：2012-10-25T14:49:23.410
> 
> 标签：python, x509certificate, libxml2, xmlsec

我正在尝试使用 pyxmlsec/xmlsec/libxml2 对 XML 文件进行签名，但它失败了（`sigCtx->signValueNode == NULL:error=100:assertion`）。

当我从命令行运行时，它运行顺利：

```
xmlsec1 sign --output signed.xml --pkcs12 c.pfx --pwd mypwd tobesigned.xml 
```

我的 Python 代码：

```
libxml2.initParser()
libxml2.substituteEntitiesDefault(1)
xmlsec.init()
xmlsec.cryptoAppInit(None)
xmlsec.cryptoInit()

doc_xml = libxml2.parseMemory(xml, len(xml))
signature_node = xmlsec.findNode(
    doc_xml.getRootElement(),
    xmlsec.NodeSignature,
    xmlsec.DSigNs,
)

signer = xmlsec.DSigCtx()

key = xmlsec.cryptoAppKeyLoad(
    filename=str(self.issuer.certificate.path),
    format=xmlsec.KeyDataFormatPkcs12,
    pwd=str(self.issuer.certificate_password),
    pwdCallback=None,
    pwdCallbackCtx=None,
)

signer.signKey = key
signer.sign(signature_node) # error!
... 
```

完整的错误跟踪：

```
func=xmlSecDSigCtxProcessSignatureNode:file=xmldsig.c:line=463:obj=unknown:subj=dsigCtx->signValueNode == NULL:error=100:assertion:
func=xmlSecDSigCtxSign:file=xmldsig.c:line=303:obj=unknown:subj=xmlSecDSigCtxSigantureProcessNode:error=1:xmlsec library function failed: 
```

有小费吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T23:42:40.627

xmlsec 使用 -DXMLSEC_NO_SIZE_T 选项编译，pyxmlsec 使用 -UXMLSEC_NO_SIZE_T 编译。

编辑 setup.py 并在后面添加以下行`t = tuple(flag[2:].split('='))`

```
 if len(t) == 1: t = tuple([t[0],""]) 
```

打补丁后效果很好。

确保清洁、重建和重新安装！

# google-analytics - 跟踪站点搜索 - 谷歌分析

> ID：13071249
> 
> 赞同：1
> 
> 时间：2012-10-25T14:49:33.303
> 
> 标签：google-analytics

我正在尝试在 Google Analytics 中跟踪网站搜索。我的个人资料设置设置为“跟踪站点搜索”。

在站点上搜索时，URL 字符串输出为：`www.website.com/Search.aspx?searchtext=keyword&searchmode=AnyWord`. 搜索模式实际上是一个下拉框，您可以选择“任何单词”、“精确短语”或“所有单词”。我已设置`searchtext=`为我的查询参数，并设置`searchmode=`为 GA 界面中的类别参数。不过，我还没有看到任何数据被记录下来。

我通过阅读 GA 帮助部分的理解是，不需要以任何方式操纵网站上的 GA 跟踪代码。这是不正确的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T17:42:14.200

我似乎将等号作为查询参数的一部分包括在内，而实际上它不应该只使用“searchtext”和“searchmode”，没有引号。

例如：

![站点搜索示例](../Images/284b69be1638a05882f8ac1e08558996.png)

# python - python异常源，调度器

> ID：13071255
> 
> 赞同：2
> 
> 时间：2012-10-25T14:49:48.303
> 
> 标签：python, exception

我正在开发一个通过网络服务器进行 RPC 调用的调度程序。webserver 类有一些方法，如 rpc_echo、rpc_add、...（以 rpc_ 为前缀），它们应该可以从远程访问。在调度程序方法中，我可以找到相应的方法并使用字典中准备好的参数调用它：

```
try:
  handler = getattr(self, 'rpc_' + request['method'])  # identify handler
  response['result'] = handler(**params)  # assign arguments and call handler
except (AttributeError, KeyError):
  # exceptions: requested method -> key, call method -> attr, callable -> attr
  raise JSONRPCError('unknown method.')
except TypeError:
  raise JSONRPCError('parameters don\'t match method prototype.') 
```

这工作正常：但是如果在处理程序内部抛出异常，错误检查就会受到干扰并导致错误的结论。如何确定异常是否在处理程序中引发？因此是错误的调用或服务器错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T18:02:13.717

您可能想花一些时间使用[回溯模块](http://docs.python.org/library/traceback.html)

这是一个简化的例子：

```
import sys, traceback

def outer(b):
    def inner(b):
        return [0,2,99][b]
    return "abcd"[inner(b)]

# "abcd"[[0,2,99][1]] => "abcd"[2] => "c"
print(outer(1))

try:
    # "abcd"[[0,2,99][2]] => "abcd"[99] => IndexError
    print(outer(2))
except IndexError:
    fname = traceback.extract_tb(sys.exc_info()[2])[-1][2]
    print("Exception from: {}".format(fname))

try:
    # "abcd"[[0,2,99][3]] => IndexError
    print(outer(3))
except IndexError:
    fname = traceback.extract_tb(sys.exc_info()[2])[-1][2]
    print("Exception from: {}".format(fname)) 
```

输出：

```
c
Exception from: outer
Exception from: inner 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:54:33.097

只需将您的处理程序调用从该 try/except 块中取出并将其放入另一个块中：

```
try:
  handler = getattr(self, 'rpc_' + request['method'])  # identify handler      
except (AttributeError, KeyError):
  # exceptions: requested method -> key, call method -> attr, callable -> attr
  raise JSONRPCError('unknown method.')
except TypeError:
  raise JSONRPCError('parameters don\'t match method prototype.')

try:
    response['result'] = handler(**params)  # assign arguments and call handler
except Exception:
    handle_exceptions 
```

# java - java浮点数：==等于compareTo

> ID：13071256
> 
> 赞同：3
> 
> 时间：2012-10-25T14:49:51.517
> 
> 标签：java, equals, compareto

我有 2 个问题。

1）有人告诉我，在比较两个`Float`or`Double`数据时，使用`compareTo`代替`equals`. 我不知道原因。是否有任何示例表明使用`equals`会导致错误？

2）查看此代码：

```
 float f2=(float)1.123450;
  Float f3=new Float(1.123450);

  System.out.println(f3==f2);   // result is true 
```

我认为 using`==`意味着两个数据指向相同的内存地址。但是`f3`有`f2`相同的地址吗？不`new Float(...)`创造一个新的空间？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-25T14:53:09.230

如果两个参数都是引用类型，那么`==`将测试内存位置。但是，如果`==`(or `!=`) 的参数之一是数字，而另一个可转换为数字（使用拆箱），则通过在拆箱后比较数值来完成比较。因此，这种情况下的比较是基于浮点值（在这种情况下是相同的）进行的。有关详细信息，请参阅[Java 语言规范 §15.21.1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.21.1)。

但是请注意，这`Float.NaN == Float.NaN`是`false`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-25T14:54:24.887

一般来说`==`，除非您需要处理舍入或算术错误，否则 compareTo() 对您没有多大帮助。

如果你想在一个错误中比较两个双打，你可以使用

```
if (Math.abs(a - b) < ERR) // within error. 
```

或相对误差

```
if (Math.abs(a - b) < ERR * (Math.abs(a) + Math.abs(b))/2) // within error. 
```

或在四舍五入内，该因子是否通常是十的幂，如 10000 意味着小数点后 4 位。

```
if (Math.round(a * factor) == Math.round(b * factor)) // within a multiple 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T15:16:31.323

在 Java 中，您有两种（主要）类型，

1.  原语
2.  参考

    当且仅当它们的类型为`double`、`float`、`int`、`long`等时，基本类型才被视为基本类型。

    引用类型是任何使用“对象”来存储数据的类型。当您在课堂上创建时，您实际上是在“变相”创建引用类型。引用类型的一些示例是`String`、`Double`、`Integer`等。

    因此，就类型而言，当您比较`float x`时`Float y`，您实际上是在比较两种不同的类型！

    在 Java 中，`==`' 运算符大多数时候只比较相同类型的对象。然而，有时，该语言将允许比较其他类型，例如`x == y`在`x`原始类型和`y`引用类型（如上定义）的情况下。

    `x`当执行和之间的比较时，`y`执行称为装箱和拆箱的操作。但是要理解装箱，就必须了解原始类型和引用类型在内存语义方面的区别。（不要让那吓到你！）

    原始类型存储在称为堆栈的内存位置中，这在碎片访问方面速度很快且不是很灵活。这很容易。

    但是引用类型是不同的：当使用操作符**实例化**`new`引用类型时（在做时隐式调用`Float x = <something>;`- 即`Float x = <something>;`转换为`Float x = new Float(<something>);`）所以当`Float`实例化一个或其他引用类型时，对象被创建并存储在堆上，但指向该对象（位于堆上）的指针存储在堆栈中。

    这意味着为了检索存储在 中的值，`x`计算机必须使用存储在堆栈中的地址，并转到堆中的该内存地址。

    我们使用堆来存储引用类型，因为堆栈不太擅长所谓的“动态内存分配”，即在不关心周围其他对象的情况下分配和释放内存。

    现在进行装箱和拆箱：

    装箱（也称为包装）是获取原始类型对象并将其存储为引用类型（因此`float x`成为`Float x`）的过程，因此这两个对象是**相同**的类型。（这有点像用纸包圣诞礼物）所以，在幕后，`Integer k = 6`是一种拳击（自动装箱）

    另一方面，拆箱与拆箱相反，因此您可以将其称为拆箱。拆箱采用“装箱”对象并将其从引用类型带回原始类型，因此语句可以毫不费力地工作：

    `Integer k = 6; //Boxing`

    `int m = k; //Unboxing`

    就您的问题而言，这真正意味着什么：在您发布的代码中，发生了自动装箱和拆箱，这使得该声明有效。JVM 足够聪明，可以按照你的意思去做——但这并不意味着你应该养成它的常规习惯，因为装箱和拆箱会对代码的性能产生严重影响！

    此外，如果两者`x`都是`y`类型`Float`，您将比较参考！

    祝你好运！

# path-finding - 如何处理 A* 寻路中的障碍以达到“下一个最佳”目标？

> ID：13071260
> 
> 赞同：5
> 
> 时间：2012-10-25T14:49:55.987
> 
> 标签：path-finding, a-star

我正在为基于网格的自上而下游戏进行 A* 寻路。我遇到的问题可能在下图中最容易理解。星号是玩家/NPC。黄色星号是当前想要前往 X 的 NPC。红色星号是在这种情况下是障碍物的 NPC。黄色单元格是墙壁，白色单元格是地板。虽然通往目标的整个路径确实无法到达，但我仍然想找到通往下一个最佳位置的路径（在这种情况下，点编号为 8）。

我可以很容易地让它绕过障碍物，但不确定如何完全按照我的描述去做。如果我在它遇到障碍物后停止它，它不会在 3 处停止正常运行。如果我重新路径到封闭列表中与最终目标距离最短的图块，如果最终目标在另一个以墙的一侧为例，它也会把事情搞得一团糟。

有什么建议么？我觉得我错过了一些明显的东西，所以请原谅这里的白痴。

![在此处输入图像描述](../Images/4cfcc7446a88bf756beb6d71191fb2da.png)

谢谢，蒂姆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T15:30:41.573

这是一个基于[问题放松](https://en.wikipedia.org/wiki/Relaxation_%28approximation%29)的想法：

首先，解决没有 NPC 的图的所有顶点的最短路径问题。您可以使用从目标节点开始的[Dijkstra 算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)的单个应用程序，以获取到每个顶点的目标的最短路径。

然后尝试在完整问题中找到最短路径。将 A* 与通过运行 Dijkstra's 作为启发式获得的最短路径信息一起使用；这是可以接受的，因为 NPC 问题中的最短路径总是至少与松弛问题中的最短路径一样长。跟踪迄今为止的最佳路径，并在搜索空间用尽时返回（正如我在评论中发布的那样）。

如果您认为这很昂贵，请意识到您只需要运行一次 Dijkstra's；您可以在同一张图上重复使用每次运行 A* 获得的信息。

（警告购买者：我没有尝试过这些。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T21:02:01.533

一种方法是在不考虑阻塞 NPC 的情况下计算从源到目的地的路径，然后检查路径上是否有任何阻塞 NPC。如果是这样，考虑路径上的第一个阻塞 NPC，然后再次计算路径。冲洗并重复，直到您无法再到达目的地。发生这种情况时，您可以将最后成功路径上最后一个阻塞 NPC 之前的点作为“下一个最佳”目的地。

这应该适用于您的示例，但如果目的地有两个被阻塞的入口，则此方法适用于更远的入口。此外，在最坏的情况下，您必须运行最短路径算法的次数与 NPC 的次数一样多。

larsmans 提出的方法比这要好得多，因为您只需运行一次 Dijkstra 和 A*。我仅将此作为您可以采取的各种方法的想法。

# redis - 执行 SET 命令和保存的数据实际更改之间的延迟？

> ID：13071261
> 
> 赞同：1
> 
> 时间：2012-10-25T14:50:01.953
> 
> 标签：redis

对于我正在构建的应用程序，我们使用 Redis 作为会话存储介质。

前几天，我们的一位测试人员注意到，当他注销并*立即*尝试访问受保护的 URI 时（在注销后大约 1 秒内），他的旧会话数据仍在使用中。

阶梯式：

1.  用户以账户 A 登录。
2.  用户注销。
3.  用户立即访问受保护的 URI。
4.  用户再次以账户 A 登录。

我认为正在发生的事情是这样的：

1.  用户注销，因此应用程序清除用户的会话并将空会话发送到 Redis 进行存储。
2.  在更改“生效”之前，用户访问不同的资源（例如，登录表单或受保护的 URI）。
3.  应用程序从 Redis 请求会话，它仍然包含登录的会话值。
4.  应用程序将更新后的会话发送回 Redis，覆盖注销的会话。

这是一个正确的诊断吗？`SET`Redis 在接受 a和实际更新存储值之间是否有延迟？还是我应该调查我的应用程序逻辑中的某些内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:25:59.890

SET 命令的执行没有延迟。如果 redis-server 成功返回，并且您的客户端库报告成功 - 您可以确定 redis 已写入数据。

我建议查看您的应用程序堆栈。也许会话处理程序正在异步使会话无效？

# php - 从给定的字符串数据中将透明像素变为白色：image/png;base64

> ID：13071263
> 
> 赞同：0
> 
> 时间：2012-10-25T14:50:04.093
> 
> 标签：php, string, image, transparent

我知道这可以用纯 PHP 完成，但找不到解决方案。

这是我到目前为止所拥有的：

```
<?php 

// posted canvas image data (string), such as: 
// "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArcAAAHbCAYAAADRQ7"
$data = $_POST['data'];

// remove the "data:image/png;base64," part
$uri =  substr($data,strpos($data,",")+1);

$imgData = base64_decode($uri);

// NOT WORKING: transparent to white pixels
$im = imagecreatefromstring($imgData);
$white = imagecolorallocate($im, 255, 255, 255);
imagefill($im, 0, 0, $white);
// END NOT WORKING

// put the data to a file
file_put_contents('yourimage.png', $imgData);

// force user to download the image
if(file_exists('yourimage.png')){
    // save dialog box
    header('Content-Disposition: attachment; filename="yourimage.png"');
    // output png format
    header('Content-type: image/png');
    // read from server and write to buffer
    readfile('yourimage.png');
}

?> 
```

首先，我试图找出 PHP 是否可以直接更改 image/png-String 并修改透明部分，但找不到任何东西。现在我尝试从发布的字符串创建图像，但也失败了......

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:57:07.053

您正在写出错误的文件，首先是：

```
file_put_contents('yourimage.png', $imgData); 
```

只是要写出从客户端发送的原始解码图像。您正在使用 GD 来操作该图像，这意味着您必须让 GD 写出修改后的图像，例如

```
imagepng($im, 'yourimage.png'); 
```

但是，由于您似乎只是将该图像转储给用户，因此您可以消除更多代码和中间的“yourimage.png”文件：

```
header('Content-type: image/png');
imagepng($im); // no filename specified, write data out to PHP's output buffer directly. 
```

# java - JSoup 的替代品或如何清理空格

> ID：13071264
> 
> 赞同：4
> 
> 时间：2012-10-25T14:50:04.923
> 
> 标签：java, html, jsoup

有人知道**JSoup**的替代品吗？

或者如何清理序列`<p>&nbsp;</p>`？

**用于 jQuery 的 HTML Clean 插件**对我来说效果很好，但我有兴趣在**服务器端**进行 html 代码清理，而不是在**客户端**。

或者，replaceAll 表达式是做什么的？？：

```
String cleanS = dirtyS.replaceAll("<p>&nbsp;</p>", ""); //This doesnt work 
```

我发现脏 html 带有混合的空格序列**#160**和其他类似的**#32**。

所以，我需要一个表达式来删除它们的任何混合物。

![混合空间空白](../Images/571b35f9922ded02d744d07aff344216.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T15:34:56.977

您可以`OutputSettings`为此更改：

**例子：**

```
final String html = ...;

OutputSettings settings = new OutputSettings();
settings.escapeMode(Entities.EscapeMode.xhtml);

String cleanHtml = Jsoup.clean(html, "", Whitelist.relaxed(), settings); 
```

这也可以`Document`通过 Jsoup 解析：

```
Document doc = Jsoup.parse(...);
doc.outputSettings().escapeMode(Entities.EscapeMode.xhtml);

// ... 
```

* * *

**编辑：**

删除标签：

```
doc.select("p:matchesOwn((?is) )").remove(); 
```

请注意：后面`(?is)`不是空格，而是**char** *#160* (= nbsp)。这将删除所有自己的文本仅为`&nbsp;`. 如果您想对所有其他标签执行此操作，可以将 替换`p:`为`*:`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T11:59:05.903

如果您有文档对象，则可以遍历段落元素并删除所有其中没有文本（或非空白文本）的元素。在检查文本是否为空之前，您可以替换 NBSP 的出现；与空白。假设您使用 UTF-8 文档，以下可能对您有用：

```
public static final String NBSP_IN_UTF8 = "\u00a0"; 
```

假设您知道如何获取 Document 对象，清理循环很简单：选择段落元素并删除空元素：

```
org.jsoup.nodes.Document doc= ...   //obtain your document object  
for (org.jsoup.nodes.Element element : doc.select("p")) {
    if ( !element.hasText() || element.text().replaceAll(NBSP_IN_UTF8, "").trim().equals("") ) {
       element.remove();
    }
  } 
```

# permissions - django-nonrel：用户的组属性导致错误

> ID：13071265
> 
> 赞同：0
> 
> 时间：2012-10-25T14:50:05.600
> 
> 标签：permissions, authorization, backend, django-nonrel, usergroups

我正在努力使用*django-nonrel*的“默认”用户类，它是组属性。我正在尝试通过给定用户的名称（又名 user.belongs_to_group(name)）来查找特定组。可悲的是，我只是得到一个**“数据库不支持此查询。”** - 调用此方法时出错。

我在项目中添加了*djangotoolbox*和*django-permission-backend-nonrel*，但没有成功。

**更新**：对不起，我有点不清楚，也许。问题似乎是，*ManyRelatedManager*似乎不适用于 django-nonrel。有谁知道，如果它应该工作还是有某种解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:13:49.420

django-nonrel 本身不支持多对多关系。

您可能有一些运气使用 dbindexer 来支持这一点，但我不确定 dbindexer 的实际效果如何。Dbindexer 生成某些查询可能需要的额外索引字段。我不是一个大粉丝，因为它经常会产生很多额外的重复数据。

你在 mongo 或 Google App Engine 上运行 django-nonrel 吗？

# java - 是否可以创建一个 int 名称变量数组

> ID：13071267
> 
> 赞同：0
> 
> 时间：2012-10-25T14:50:09.853
> 
> 标签：java, arrays, int

我想知道是否可以构建一个 int names 变量数组。下面的示例，我希望它们初始化为 0；

```
int[] h1i1ctrlk, h1i2ctrlk, h1i3ctrlk, h1i4ctrlk, h1i5ctrlk; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:56:25.977

> 我不确定创建数组的方法是否正确，我无法对其进行初始化。

尝试

```
int[] h1i1ctrlk, h1i2ctrlk, h1i3ctrlk, h1i4ctrlk, h1i5ctrlk;
h1i1ctrlk = new int[length]; // an array of length full of 0s.
....
h1i5ctrlk = new int[length]; // an array of length full of 0s. 
```

为数组的所有元素设置一个值`1.0`

```
Arrays.fill(hii1ctrlk, 1.0); 
```

如果您有特定的价值观，您可以使用

```
int[] h1i1ctrlk = { 0, 1, 2, 10 }; 
```

或者

```
int[] h1i1ctrlk;
hii1ctrlk = new int[] { 0, 1, 2, 10 }; 
```

或使用循环

```
int[] h1i1ctrlk = new int[length];
for(int i = 0; i < length; i++)
    h1i1ctrlk[i] = i * i; 
```

你也可以使用`Map<String, int[]>`这样的

```
Map<String, int[]> ctrlk = new LinkedHashMap<>();
for(int h = 1; h <= 9; h++) {
   for(int i = 1; i <= 5; i++) {
       String key = "h"+h+"i"+i;
       ctrlk.put(key, new int[length]);
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:34:32.953

请尝试这将为您做一些工作尝试一一打印所有数组，我们将初始化为 0 并且所有数组长度将为 1

```
 public class IntName{

        public static void main(String args[])
            {
               int[] h1i1ctrlk, h1i2ctrlk, h1i3ctrlk, h1i4ctrlk, h1i5ctrlk = {0};
               h1i1ctrlk = h1i2ctrlk = h1i3ctrlk = h1i4ctrlk = h1i5ctrlk;
               System.out.println(h1i1ctrlk.length);
            }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-27T04:13:22.283

我想我找到了我的 int 变量数组问题的答案。我尝试了下面的代码，它似乎工作。

```
int h1i1ctrlk, h1i2ctrlk, h1i3ctrlk, h1i4ctrlk, h1i5ctrlk;
int counter[] = {h1i1ctrlk, h1i2ctrlk, h1i3ctrlk, h1i4ctrlk, h1i5ctrlk};

\\ display the value of int, int that's in array;
tvpwlikectr.setText("" + counter[0]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T14:57:26.307

对的，这是可能的。像这样：

```
int[] h1i1ctrlk = {1, 2, 3}; 
```

或者

```
int[] h1i1ctrlk = new int[3]; //array length of 3 
```

# sql - 通过 sqlpus 导入大型 SQL 转储

> ID：13071268
> 
> 赞同：1
> 
> 时间：2012-10-25T14:50:21.203
> 
> 标签：sql, oracle, oracle10g, sqlplus, dump

有一个 .sql 格式的转储，要导入到服务器。从工具只有 sqlplus。问题是 sqlplus 要求在每个 CREATE TABLE 之后`/`并且仅在`/`开始创建表之后。转储看起来像这样：

```
DROP TABLE ...;
CREATE TABLE ...;
INSERT INTO ...;
...
DROP TABLE ...;
CREATE TABLE ...;
INSERT INTO ...;
...
... 
```

当涉及到 INSERT 时，没有插入任何内容，因为没有创建表。无法编辑该文件，因为它很大（约 700 MB）。如何导入转储？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:56:17.200

给定文件 /tmp/foo.sql：

```
CREATE TABLE foo (
    a integer primary key,
    b integer
);

INSERT INTO foo VALUES (1, 2); 
```

运行 sqlplus：

```
$ sqlplus user/pass@db @/tmp/foo

SQL*Plus: Release 11.2.0.2.0 Production on Thu Oct 25 10:54:39 2012

Copyright (c) 1982, 2010, Oracle.  All rights reserved.

Connected to:
Oracle9i Release 9.2.0.4.0 - 64bit Production
JServer Release 9.2.0.4.0 - Production

Table created.

1 row created.

SQL> 
```

听起来你已经在`/`某个地方设置了分隔符。改回`;`.

如果您需要编辑文件，您可以使用`perl -p -E "s/pattern/replacement/" oldfile.sql > newfile.sql`或类似方式进行。（或者，老实说，许多编辑可以在具有许多 GB RAM 的现代机器上处理 700MB 的文件）。

# iphone - 指向 void 的指针的算术（看起来很容易解决，但我不明白如何做到这一点）

> ID：13071272
> 
> 赞同：0
> 
> 时间：2012-10-25T14:50:26.953
> 
> 标签：iphone, objective-c, ios

我无法找到如何执行此操作我收到以下错误，如图所示

![在此处输入图像描述](../Images/a9569fd19fc6099ec3d4dd1508280a73.png) 我搜索了很多，但我不明白如何做到这一点

我在 ASIHttpRequest.m 中遇到了这个错误

请指导我

非常感谢你提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:19:33.597

您的 ASIHttpRequest 副本有多新？我的版本看起来不同——围绕指针算法有一些类型转换。另外，您使用的是哪个版本的 XCode？

# python - url_for 中的烧瓶 jinja 宏变量

> ID：13071275
> 
> 赞同：3
> 
> 时间：2012-10-25T14:50:31.083
> 
> 标签：python, flask, jinja2

我有一个带有 jinja 宏的烧瓶应用程序，看起来像这样

```
{% macro icon(site, title="") %}
    <img src="{{ url_for('static', filename="icons/XXX.png") }}" alt="{{ title }}" class="img-icon">
{% endmacro %} 
```

我需要做的是让文件名等于`site`传递给宏的变量。所以它的值应该是`site`.而不是 XXX

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T14:56:38.570

这应该有效：

```
{% macro icon(site, title="") %}
    <img src="{{ url_for('static', filename='icons/%s.png' % site) }}" alt="{{ title }}" class="img-icon">
{% endmacro %} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-25T13:16:47.773

[自 2.6 ( pep-3101](http://www.python.org/dev/peps/pep-3101/) )以来，python 中字符串格式化的推荐方法是使用[`str.format()`](http://docs.python.org/2/library/stdtypes.html#str.format)：

```
{% macro icon(site, title="") %}
    <img src="{{ url_for('static', filename='icons/{0}.png'.format(site)) }}" alt="{{ title }}" class="img-icon">
{% endmacro %} 
```

# javascript - GWT 计算 div 中的行数

> ID：13071278
> 
> 赞同：0
> 
> 时间：2012-10-25T14:50:40.800
> 
> 标签：javascript, css, gwt, layout, html

> **可能重复：**
> [如何获取 <textarea > 中的行数？](https://stackoverflow.com/questions/1760629/how-to-get-number-of-rows-in-textarea)

我在页面布局中有一个 div，用户将在其中输入文本：

```
 <div> user text will go here </div> 
```

一旦用户输入文本，我想计算 div 在布局中实际占据的文本行数。请注意，这将根据屏幕分辨率或窗口大小而有所不同。

有没有办法这样做？

更好的是，有没有办法以像素为单位获取 div 高度？

我正在使用 GWT，但 JavaScript 解决方案也可以。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:18:03.543

> 更好的是，有没有办法以像素为单位获取 div 高度？

如果你有一个`com.google.gwt.user.client.Element`，那么就打电话

```
element.getClientHeight() 
```

来自 getClientHeight() 的 Javadoc：

> 返回元素的内部高度（以像素为单位），包括填充，但不包括水平滚动条高度、边框或边距。

如果您有一个小部件，例如 a `com.google.gwt.user.client.ui.Label`，请使用

```
label.getElement().getClientHeight() 
```

在某些情况下，在 内调用它可能很有用`Scheduler.scheduleDeferred`，以确保在执行高度计算之前已应用所有样式。

# xml - XML 模式中的条件

> ID：13071282
> 
> 赞同：2
> 
> 时间：2012-10-25T14:50:53.100
> 
> 标签：xml, xsd

考虑以下（设计不佳？）XML 文档：

```
<?xml version="1.0" ?>
<command_result>
<param name="protocol_version" value="3"/>
<param name="player_state" value="navigator"/>
</command_result> 
```

我想要做的是创建一个 XML 模式（XSD 格式），它根据`value`属性的实际值指定属性的数据类型`name`。

示例（伪代码）：

```
if (param name = "protocol_version") then (param value type="xs:integer")
if (param name = "player_state") then (param value type="xs:string") 
```

有没有办法在不修改源 XML 的情况下在模式文件中引入这样的条件语句？我查看了各种解决方案，但所有这些都需要以某种方式更改源（例如设置 xsi:type）。

**编辑**

我当前的架构：

```
<?xml version="1.0" ?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="command_result">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="param" minOccurs="2" maxOccurs="unbounded">
                    <xs:complexType>
                        <xs:attribute name="name" type="xs:string" use="required"/>
                        <!-- the following line needs to be modified somehow -->
                        <xs:attribute name="value" type="xs:string" use="optional"/>
                    </xs:complexType>
                </xs:element>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:10:12.123

我不认为这是可能的。我能想到的唯一方法是这样的：

```
<schema xmlns="http://www.w3.org/2001/XMLSchema"
    targetNamespace="http://www.example.org/schema"
    xmlns:tns="http://www.example.org/schema" elementFormDefault="qualified">

    <element name="command_result">
        <complexType>
            <sequence>
                <choice>
                    <element name="param" type="tns:protocol_version_type" />
                    <element name="param" type="tns:player_state_type" />
                </choice>
            </sequence>
        </complexType>
    </element>

    <complexType name="protocol_version_type">
        <attribute name="name" type="string" fixed="protocol_version" />
        <attribute name="value" type="integer" />
    </complexType>

    <complexType name="player_state_type">
        <attribute name="name" type="string" fixed="player_state" />
        <attribute name="value" type="string" />
    </complexType>
</schema> 
```

但显然这是不允许的。当我在 Eclipse 中验证此模式时，它给了我以下错误：

> *   cos-nonambig: "http://www.example.org/schema":param 和 "http://www.example.org/schema":param（或它们的替换组中的元素）违反了“唯一粒子属性”。在针对此模式进行验证期间，将为这两个粒子创建歧义。
> *   cos-element-consistent：类型“#AnonType_command_result”的错误。**模型组中出现多个名称为“param”且类型不同的元素。**

如您所见，您不能有两个具有相同名称但具有不同类型的元素。但这是您的 XML 所需要的。

**编辑：**你甚至不能像这样定义一个更简单的模式：

```
<element name="command_result">
    <complexType>
        <sequence>
            <element name="param" type="tns:proptocol_version_type" />
            <element name="param" type="tns:type2" />
        </sequence>
    </complexType>
</element> 
```

在这个版本中，没有`<choice>`给出，这意味着你的参数必须以给定的顺序出现。但是，虽然这消除了`nonambig`错误，但`element-consistent`错误仍然存​​在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T19:54:47.197

如果您有权访问 XSD 1.1 验证器，则可以使用条件类型分配`param`根据其`name`属性的值为元素指定不同的绑定。（您将其绑定到的不同复杂类型在为`value`属性分配不同类型时会有所不同。）

但总的来说，您是对的：为每个元素使用相同的元素名称是一种简化某些事情的设计选择，但代价是您尝试验证参数。

# javascript - ASP.NET - 将文本输入限制为动态值的倍数

> ID：13071285
> 
> 赞同：2
> 
> 时间：2012-10-25T14:51:07.670
> 
> 标签：javascript, asp.net, textbox, onblur

我需要限制文本框上的输入。在页面加载时，转发器中的文本框会自动填充转发器中项目的纸箱数量。我正在使用以下代码在 OnItemCreated 方法中执行此操作：

```
txt.Text = DataBinder.Eval(e.Item.DataItem, "CtnQty").ToString(); 
```

我需要做的是重新输入输入（最好使用 Javascript），这样如果选择的值超过默认值，则该值会自动设置为下一个倍数。如果小于，则接受输入的任何值。因此，例如，如果默认值为 12 并输入 13，则需要将其自动更正为 24。如果输入 11，则该值保持为 11。

我一直在玩 Math.round 函数，如下所示：

```
<input type="text" onblur="this.value=Math.round(parseInt(this.value)/12)*12" /> 
```

但我无法让它接受动态值。这样做会导致“服务器标签格式不正确”解析错误：

```
<input type="text" onblur="this.value=Math.round(parseInt(this.value)/<%# DataBinder.Eval(Container.DataItem, "CTNQTY") %>)*<%# DataBinder.Eval(Container.DataItem, "CTNQTY") %>" /> 
```

然后如果小于默认值，我将遇到接受的问题，如果更多，则乘以。我想我需要一个更详细的 Javascript 函数，但经过多次谷歌搜索后找不到我想要的。任何想法都将受到欢迎。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:37:15.820

首先，我会说使用 DataItem 的代码应该位于 ItemDataBound 中，除非您在每次回发时绑定数据，这并不总是好的做法。

关于格式不正确的标签，您可以尝试这样的事情，对您的 onblur 使用单引号：

```
<input type="text" onblur='this.value=Math.round(parseInt(this.value)/<%# DataBinder.Eval(Container.DataItem, "CTNQTY") %>)*<%# DataBinder.Eval(Container.DataItem, "CTNQTY") %>' /> 
```

关于 js 函数，也许这个例子会有所帮助（顺便说一句：使用 jQuery 等库进行事件处理应该是更好的选择）：

[http://jsfiddle.net/nqCGp/](http://jsfiddle.net/nqCGp/)

```
<html>
    <body>

      <script>
            function verify(qty){
               return function(event){event.target.value=Math.round(parseInt(event.target.value)/qty)*qty;};
            }
              </script>
      <form>
              <input type='text' onblur="(verify(12))(event)"/>
              <input type='text' onblur="(verify(14))(event)"/>        
      </form>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:24:37.023

这是针对您的问题的 html5 + 纯 javascript 解决方案 - 使用[jQuery](http://jquery.com/)或[功能检测](https://stackoverflow.com/q/1294586/1176601)进行跨浏览器和处理**更改**事件的未来兼容性（类似于**blur**，但只有在某些内容发生更改时，如果用户`enter`在表单之前按下应该可以工作已提交，但我没有测试）

```
<input type="number" id="ctnQty" value="14" data-default-value="14">
<script>
    var changeHandler = function(e) {
        var defaultValue = e.target.dataset.defaultValue;
        var v = e.target.value;
        if (v > defaultValue) {
            v = (Math.floor(v / defaultValue) + 1) * defaultValue;
            e.target.value = v;
        };
    };
    document.getElementById("ctnQty").onchange = changeHandler;
</script> 
```

**更新**：具有可重用函数和局部变量的更通用解决方案

[http://jsfiddle.net/Aprillion/CcQ6t/3/](http://jsfiddle.net/Aprillion/CcQ6t/3/)

# mysql - MySQL 时区混淆

> ID：13071287
> 
> 赞同：2
> 
> 时间：2012-10-25T14:51:19.897
> 
> 标签：mysql, datetime, timezone, timestamp

几天前我发了一个帖子，并使用了回复中给出的建议。我有一个大型 Web 应用程序，它托管在我们时区的服务器上，在那里我使用了当前时区的所有日期时间/时间戳。我应该使用 UTC 并在代码级别将其转换为适当的时区。

好吧，我现在正在这样做，但我遇到了问题。我现在使用的服务器不在我的时区，并且 TIMESTAMP（插入时）设置为他们的系统（O/S）时间。不是UTC时间。

为什么不：

```
SET time_zone = '+00:00'; 
```

修复插入 TIMESTAMP 值？如何确保 MySQL 服务器将时间戳默认为 UTC？

**解决了：**

这真的很令人困惑，因为 MySQL 会自动将数据库中的 TIMESTAMP 转换并显示为当前时区，因此我所有的 TIMESTAMP 都被转换并显示为 SYSTEMS 时区。实际上，所有 TIMESTAMPS 都存储为 UTC。所以如果你去：

```
SET SESSION time_zone = '+00:00'; SELECT * FROM what_ever_table; 
```

它将显示该时区的时间戳。

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-10-25T14:54:00.033

MySQL 在插入/更新值时不关心时区。它看到的只是时间/日期值和字符串。其标准日期格式不包含时区数据：`yyyy-mm-dd hh:mm:ss`. 时区仅在您检索数据并希望格式化值时进入图片，例如使用[convert_tz()](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_convert-tz)函数

# format - Fortran：将文本文件中的值分配给变量

> ID：13071289
> 
> 赞同：2
> 
> 时间：2012-10-25T14:51:23.383
> 
> 标签：format, fortran

我们最近在 Uni 开始了关于 fortran 的讲座，我们的讲师有非常有限的时间来实际解释一些东西。因此，由于我从来没有使用过那种编程语言的经验，所以我在一些问题上苦苦挣扎。特别是*格式*的整个想法。我正在尝试为文本文件中的变量赋值。

```
program interpolation

implicit none
integer :: i,N
real :: T1,Hfg1,T2,Hfg2,T,Hfg
!-------------------------------------
open(20,file='values.txt')
!Input temperature to be interpolated
print*,'Input temperature to be interpolated'
read(*,*) T
!Read number of values from file
read(20,1000) N
1000 format(I5) 
```

代码从这里开始，但我真正难以理解的是整个格式概念。我看到它的方式是我打开一个文件' **values.txt** '并将**单元20**分配给它，所以每当我调用单元20时，我都会引用该文件。正确的 ？之后，我要求用户为 T 输入一些初始值。这并不重要。现在，我从 unit=20 文件中读取一个值，分配给变量**N**。现在数字**1000**是什么意思？下一步的目的是什么，“ **1000 格式（I5）** ”？据我了解，' **I5** ' 是指最大字符数为 5 的整数？还是我错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:54:17.807

“1000”是将读取连接到格式语句的语句标签。读取时，“I5”表示整数需要在前五列中右对齐。

有关该语言的功能，请参见[http://en.wikipedia.org/wiki/Fortran_95_language_features](http://en.wikipedia.org/wiki/Fortran_95_language_features)。

# android - 字符 & 和 < 让一切在 HttpPost 和 HttpResponse 之间迷路

> ID：13071291
> 
> 赞同：0
> 
> 时间：2012-10-25T14:51:28.120
> 
> 标签：android, http-post, special-characters, httpresponse

我将一些 XML 作为 SOAP 请求发送，但是当该 XML 包含字符`&`或`<`时，我得到一个空响应。以下是一些相关代码：

```
String myXml = "<?xml version=\"1.0\" encoding=\"utf-8\"?>" +
               "<soap12:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap12=\"http://www.w3.org/2003/05/soap-envelope\">" +
                   "<soap12:Body>" +
                      "[XML THAT DOESN'T WORK WITH '&' AND '<']" +
                   "</soap12:Body>" +
               "</soap12:Envelope>";

HttpPost httpPost = new HttpPost("http://website.com");
StringEntity stringEntity = new StringEntity(myXml, HTTP.UTF_8);
stringEntity.setContentType("text/xml");
httpPost.setHeader("Content-Type", "application/soap+xml;charset=UTF-8)";
httpPost.setEntity(stringEntity);

HttpClient httpClient = new DefaultHttpClient();
BasicHttpResponse httpResponse = (BasicHttpResponse) httpClient.execute(httpPost);

HttpEntity httpEntity = httpResponse.getEntity();
InputStream inputStream = responseEntity.getContent();
//Checking inputStream here reveals that it is empty (not null) when xml has '&' or '<' 
```

我认为这可能是因为[这些预定义的实体](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references#Predefined_entities_in_XML)，但我尝试过的所有其他特殊字符都没有引起任何问题。

你知道这是为什么，以及我该如何解决它（除了捕捉`&`and的特定情况`<`）？

我找到了一个建议的解决方案

```
httpPost.setEntity(new UrlEncodedFormEntity(List<NameValuePair>, String encoding)) 
```

但我没有`NameValuePair`s，只有一个`StringEntity`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:21:03.173

> 我认为可能是因为这些预定义的实体

确切地。这些应该被转义为值，因此正确版本的数据将是：

```
[XML THAT DOESN'T WORK WITH '&amp;' AND '&lt;'] 
```

# security - JAX-RS，如何防止用户A访问用户B的restful资源

> ID：13071295
> 
> 赞同：8
> 
> 时间：2012-10-25T14:51:43.337
> 
> 标签：security, rest, authorization, jax-rs, glassfish-3

我在 Glassfish 上使用 JAX-RS 来实现一组资源，这些资源只能由特定用户访问。

考虑两个用户，userA 和 userB，他们都在我的网站上注册。

1.  userA 创建了自己的资源`http://{localhost}/service/user/A`；
2.  userB 创建了自己的资源`http://{localhost}/service/user/B`；

然后 Glassfish 的默认安全实现被配置为：

1.  用户角色可以访问`/services/user/*`
2.  userA 和 userB 都属于用户角色。

所以登录后，userA 和 userB 都可以访问`/service/user/A`and `/service/user/B`。

现在的问题是，有没有可能

*   userA 只能访问`/services/user/A`，但不能`/services/user/B`

同时

*   userB 只能访问`/services/user/B, but not`/services/user/A`

我想我一定错过了什么，因为我相信这是一个普遍的需求。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T21:02:31.127

这是您必须在应用程序级别实现的东西。应用程序服务器无法知道您的安全策略，这可能非常复杂。您可以自己做（在用户资源中添加逻辑），如果您的安全策略很简单，这可能是正确的方法。否则，您应该查看可以与 JAX-RS 集成的 Spring Security。这会给你很大的灵活性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T02:33:03.013

搜索了一下，似乎使用 JAX-RS 和 JAAS 解决上述问题并非易事。

所以我决定看一下**OAuth**，看看是否可以轻松处理授权。

经过几个小时的阅读，我开始意识到 Olivier 在说什么。我想要的是将用户身份绑定到 URI。但是 JAAS 或 OAuth 确实是为解决其他问题而设计的。

1.  **JAAS**或基于角色的身份验证系统旨在授权一组用户访问一组 URI。就像一个装满玩具的房间，一旦用户扮演室友ROLE，这个用户就拥有了房间的钥匙，然后他可以玩弄房间里的每一个玩具，甚至将它们全部摧毁。如果您想用用户名标记每个玩具并阻止他们玩其他人的玩具，您需要在 JAAS 之外实现逻辑。

2.  **OAuth**，甚至更糟。它甚至与用户和 URI 之间的绑定无关。它致力于让第 3 方代客软件以有限的访问权限使用您的数据。考虑一下关于 JAAS 的房间玩具故事，您希望打开房间的窗户，但您没有时间这样做。所以你雇了一个代客，做了一把代客钥匙，让他进入房间，打开窗户，同时远离玩具。OAuth 的神奇之处在于，为代客提供了足够的资源来完成主人的任务，更重要的是，房间通过识别代客钥匙来知道是谁派了代客。

现在从开发人员的角度来看，您可能会问为什么代客可以访问窗口而不是玩具？换句话说，如何让第 3 方软件访问某些 URI 而不是其他 URI？这不是由 OAuth 处理的。OAuth 只会告诉您哦，这是 Bob 的代客，其他一切都由您自己决定。

OAuth 并不完全是一件坏事，它让你有机会决定这个代客拥有什么 ROLE，或者这种代客可以访问哪个 URI，或者 Bob 的代客可以访问哪些资源等。

希望这能帮助任何阅读的人节省一些时间。请不要责怪我可怜的故事，我努力了 1 个小时让故事更简单。:)

# c# - 错误：必须在顶级静态类中定义扩展方法 (CS1109)

> ID：13071296
> 
> 赞同：6
> 
> 时间：2012-10-25T14:51:46.123
> 
> 标签：c#, .net, extension-methods, static-classes

我正在尝试制作一个倒计时程序，如果需要，我可以启动和停止并将倒计时的值设置为 10 分钟。

但是我遇到了一个我不太明白的错误。我不是那么喜欢 C#，所以这里是代码：

有人可以帮我一下吗？认为我在框架 3.0 或什么上运行？

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Timers;

namespace PauseMaster
{   
    public partial class MainForm : Form
    {           
        public MainForm()
        {           
            InitializeComponent();
        }

        private void MainForm_Load(object sender, EventArgs e)
        {               
        }

        private DateTime endTime;
        private void btnStartStop_Click(object sender, EventArgs e)
        {
            if(btnStartStop.Text == "START")
            {
                int hours = int.Parse(string.IsNullOrEmpty(txtCountFromHour.TextBox.Text) || txtCountFromHour.TextBox.Text == "timer" ? "0" : txtCountFromHour.TextBox.Text);
                int mins = int.Parse(string.IsNullOrEmpty(txtCountFromMin.TextBox.Text) || txtCountFromMin.TextBox.Text == "minutter" ? "0" : txtCountFromMin.TextBox.Text);
                int secs = int.Parse(string.IsNullOrEmpty(txtCountFromSec.TextBox.Text) || txtCountFromSec.TextBox.Text == "sekunder" ? "0" : txtCountFromSec.TextBox.Text);

                endTime = DateTime.Now.AddHours(hours).AddMinutes(mins).AddSeconds(secs);

                timer1.Enabled = true;  
                btnStartStop.Text = "STOP";
            }
            else
            {
                timer1.Enabled = false;
                btnStartStop.Text = "START";
            }
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            if (endTime <= DateTime.Now)
            {
                timer1.Enabled = false;
                lblTimer.Text = "00:00:00";
                btnStartStop.Text = "Start";
                return;
            }

            TimeSpan ts = endTime - DateTime.Now;
            lblTimer.Text = string.Format("{0}:{1}:{2}.{3}", ts.Hours.AddZero(), ts.Minutes.AddZero(), ts.Seconds.AddZero());
        }

        public static class IntExt
        {
            public static string AddZero(this int i) // GETTING ERROR HERE AT 'AddZero'
            {
                int totLength = 2;
                int limit = (int)Math.Pow(10, totLength - 1);
                string zeroes = "";
                for (int j = 0; j < totLength - i.ToString().Length; j++)
                {
                    zeroes += "0";
                }
                return i < limit ? zeroes + i : i.ToString();
            }
        }     
    }       
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-25T14:53:31.860

错误消息准确地说明了问题所在：您的`IntExt`方法*不是*顶级静态类。这是一个*嵌套*的静态类。把它拔出`MainForm`来就好了。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2017-09-15T18:05:26.097

我知道这个问题很老，但万一其他人遇到这个问题......

检查以确保关键字“this”不在参数名称定义中（通常来自复制/粘贴或拖动）

所以，替换：

```
public static string AddZero(this int i) 
```

有了这个：

```
public static string AddZero(int i) 
```

那应该可以解决您的问题。

# asp.net-mvc - 动作方法被多次调用

> ID：13071298
> 
> 赞同：5
> 
> 时间：2012-10-25T14:51:50.743
> 
> 标签：asp.net-mvc, actionmethod

我刚刚在我的 MVC 3 站点中通过简单地单击链接发现了一些关于正在调用的操作方法的非常奇怪的东西。由于某种原因，此操作方法被多次调用。不仅如此，后续的调用也会在之前的调用完成之前被调用。我的意思是，假设我的操作方法中有 10 行代码，编号为 1、2 ... 10。该方法的第一次调用将执行第 1,2 和 3 行。第二次调用将执行第 1,2 行， 3 和 4，然后第三个调用执行第 1、2、3 和 4 行，然后第一个调用从第 4 行继续，依此类推。就好像多个线程正在调用此操作方法一样，但据我所知，没有发生任何此类事情，因为我要做的就是单击一个链接。有什么理由会发生这种情况吗？

**更新**

实际上，完成分析后，我可以看到正在拨打 2 个电话。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:01:49.853

对于任何感兴趣的人，这是罪魁祸首

```
<div class="listing-holder" onclick="window.location='/Lot/Details/@auction.Id'">
   <a href="/Lot/Details/@auction.Id"><img src="@auctionLineModel.ImageUrl" alt="auction Image"/></a>
   ...
</div> 
```

如您所见，在 div 和 href 上有一个 onclick。两人都被叫了。嗬！

# jquery - Web 应用程序 - 适用于智能手机和台式机

> ID：13071299
> 
> 赞同：1
> 
> 时间：2012-10-25T14:51:52.017
> 
> 标签：jquery, asp.net, css, smartphone

我正在设计一个简单的在线商店应用程序。

对于最初的试点，我希望避免为智能手机和桌面浏览器创建单独的 UI。

因此，我正在寻找是否有一些实用的方法可以在一个 UI 中同时满足这两种需求，例如，如果我对设计很明智，是否有 Jquery 插件/其他选项可以提供一种适合所有解决方案的尺寸。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T14:55:43.873

您描述的响应式布局。试试 Twitter Bootstrap 来弄湿你的脚趾。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T14:55:50.490

你需要看看[响应式设计](http://blog.teamtreehouse.com/beginners-guide-to-responsive-web-design)：

[响应式网页设计](http://www.alistapart.com/articles/responsive-web-design/)

[Scott Hanselman 谈响应式设计](http://www.hanselman.com/blog/EasyStepsToAMobilefriendlyResponsiveDesignWithAnEmbeddedYouTubeVideoAndAFluidResize.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T14:57:03.067

研究响应式设计。[http://www.html5boilerplate.com](http://www.html5boilerplate.com)提供了一个响应式模板，您可以开始使用，Twitter Bootstrap 和其他 CSS 框架还为您提供了创建基于 @media-query 的布局的选项，这些布局可以根据显示的大小进行修改。

# android - XML SAX 解析在 android 4.0 但在 2.x 中不起作用

> ID：13071302
> 
> 赞同：0
> 
> 时间：2012-10-25T14:52:04.733
> 
> 标签：android, android-asynctask, saxparser, android-4.0-ice-cream-sandwich, ui-thread

我正在使用 XML sax 解析来通过 Web 服务获取数据。它在 2.2 和 2.3 中运行良好，但在 4.x(ICS) 等更高版本中却不行。这里我的代码是...

```
btnlogin.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                checkNetworkStatus();
                try
                {
                if(edtMailId.getText().toString().trim().equals(""))
                {
                    showDialog(1);
                }
                else if(edtPwd.getText().toString().trim().equals(""))
                {
                    showDialog(2);
                }
                else
                {
            final ProgressDialog progressdialog=ProgressDialog.show(Signin.this, "abc....", "Signing In...",true,true);
            Handler handler=new Handler();
                    Runnable r=new Runnable() {

                        public void run() {
                            try
                            {

                                String _EmailID =edtMailId.getText().toString();

                                String _Password=edtPwd.getText().toString();

                                if(chkRem.isChecked())
                                {
                                getSharedPreferences("UserData", MODE_PRIVATE).edit().putString("remUsername",edtMailId.getText().toString()).commit();
                                }
                                else
                                {
                                    getSharedPreferences("UserData", MODE_PRIVATE).edit().putString("remUsername","UnChecked").commit();
                                }
                                WebService ws=new WebService();

                                boolean loginResult=ws.checkUser(_EmailID, _Password);

                                if(loginResult){

                                    //SAXParserFactory spf=SAXParserFactory.newInstance();
                                    String URL = "http://10.0.2.2:2291/Ras.asmx/getUserDetails";
                                    String charset = "UTF-8";
                                    String query1;

                                    try {
                                    query1 = String.format("MailId=%s", URLEncoder.encode(_EmailID, charset));

                                    URLConnection url = new URL(URL + "?" + query1).openConnection();

                                    url.setRequestProperty("Accept-Charset", charset);
                                    url.setDoOutput(true);

                                    InputStream input =url.getInputStream();

                                    SAXParserFactory saxParserFactory = SAXParserFactory.newInstance();
                                    SAXParser saxParser = saxParserFactory.newSAXParser();
                                    XMLReader xmlReader = saxParser.getXMLReader();

                                    //saxParser=saxParserFactory.newSAXParser();
                                    //xmlReader=saxParser.getXMLReader();
                                    MyHandler mh=new MyHandler();
                                    xmlReader.setContentHandler(mh);
                                    xmlReader.parse(new InputSource(input));
                                    Intent in=new Intent(getApplicationContext(),TabBar.class);
                                    in.setAction(Intent.ACTION_MAIN);
                                    in.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                                    startActivity(in);

                                    }

                                    catch (UnsupportedEncodingException e3) {
                                    // TODO Auto-generated catch block
                                    e3.printStackTrace();
                                    }
                                    catch (IOException e2) {
                                    // TODO Auto-generated catch block
                                    e2.printStackTrace();
                                    }
                                    catch (ParserConfigurationException e) {
                                    // TODO Auto-generated catch block
                                    e.printStackTrace();
                                    }
                                    catch (SAXException e) {
                                    // TODO Auto-generated catch block
                                    e.printStackTrace();
                                    }

                                    catch (Exception e2) {
                                    // TODO Auto-generated catch block
                                    e2.printStackTrace();
                                    }

                                    }

                                else
                                {
                                    txtErrormsg.setVisibility(View.VISIBLE);
                                    txtErrormsg.setText("Incorrect Email Address or Password");
                                }   

                            }
                            catch(Exception e)
                            {
                                //txtErrormsg.setVisibility(View.VISIBLE);
                                txtErrormsg.setText("Server Busy");
                                 Log.e("SignIn", e.getMessage());
                            }
                            progressdialog.dismiss();

                        }
                    };

                handler.postDelayed(r, 1000);
            }
            }

            catch(Exception ex)
            {
                Log.e("Server Busy",ex.getMessage().toString());
            }
                 }

        }); 
```

这是我的处理程序类代码...

```
class  MyHandler extends DefaultHandler
        {
           boolean is_FirstName=false;
           boolean is_UserID=false;

           @Override
            public void startDocument() throws SAXException {
                // TODO Auto-generated method stub
                super.startDocument();
            }

            @Override
            public void startElement(String uri, String localName, String name,
                    Attributes attributes) throws SAXException {
                // TODO Auto-generated method stub

                super.startElement(uri, localName, name, attributes);
                if(localName.equals("FirstName")){
                    is_FirstName=true;
                }
                else if(localName.equals("UserID")){
                    is_UserID=true;
                }

        }

            @Override
            public void characters(char[] ch, int start, int length)
                    throws SAXException {
                // TODO Auto-generated method stub
                SharedPreferences.Editor edit=splogin.edit();
                super.characters(ch, start, length);
                if(is_FirstName){

                    edit.putString("FirstName", new String(ch,start,length));
                }
                else if(is_UserID){

                    edit.putString("UserID", new String(ch,start,length));
                }

                edit.commit();
            }

            @Override
            public void endElement(String uri, String localName, String name)
                    throws SAXException {
                // TODO Auto-generated method stub
                super.endElement(uri, localName, name);
                if(localName.equals("FirstName")){
                    is_FirstName=false;
                }
                else if(localName.equals("UserID")){
                    is_UserID=false;
                }

            }

            @Override
            public void endDocument() throws SAXException {
                // TODO Auto-generated method stub
                super.endDocument();
            }

} 
```

这是我的日志猫。

```
10-25 21:52:09.090: W/System.err(546): java.io.FileNotFoundException: http://0.0.0.0/rWS/r.asmx/getUserDetails?MailId=tej%40gmail.com
10-25 21:52:09.090: W/System.err(546):  at libcore.net.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java:177)
10-25 21:52:09.090: W/System.err(546):  at com.eist.stats.Signin$1$2$1.run(Signin.java:194)
10-25 21:52:09.090: W/System.err(546):  at android.os.Handler.handleCallback(Handler.java:605)
10-25 21:52:09.133: W/System.err(546):  at android.os.Handler.dispatchMessage(Handler.java:92)
10-25 21:52:09.140: W/System.err(546):  at android.os.Looper.loop(Looper.java:137)
10-25 21:52:09.140: W/System.err(546):  at android.app.ActivityThread.main(ActivityThread.java:4340)
10-25 21:52:09.140: W/System.err(546):  at java.lang.reflect.Method.invokeNative(Native Method)
10-25 21:52:09.140: W/System.err(546):  at java.lang.reflect.Method.invoke(Method.java:511)
10-25 21:52:09.140: W/System.err(546):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
10-25 21:52:09.151: W/System.err(546):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
10-25 21:52:09.151: W/System.err(546):  at dalvik.system.NativeStart.main(Native Method) 
```

在 Android 4.x 版本中，SAX 解析不会从 Web 服务读取/获取数据。我应该在这里改变什么才能在 4.0 中工作。请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:53:33.030

你确定它没有抛出一个`NetworkOnMainThreadException`？看起来您的代码`onClickListener`在您的 main`Activity`中，在这种情况下，您在那里创建的处理程序附加到您的主线程。因此，当您创建一个可运行对象并将其传递给`postDelayed`它时，它将在主线程上运行。由于您不能再在 4.0 版的主线程上执行网络操作，这将抛出一个`NetworkOnMainThreadException`，而相同的代码在 2.x 上可以正常工作。

# ember.js - Ember.js 属性初始化说明

> ID：13071307
> 
> 赞同：4
> 
> 时间：2012-10-25T14:52:29.873
> 
> 标签：ember.js

我刚刚开始使用 Ember，在编写一些 jasmine 测试时遇到了这个问题。

鉴于我有以下代码

```
App.RecipeController = Ember.Controller.extend
  selectedGrain: null
  amount: null
  recipeGrains: Ember.A()

  totalWeight: (->
    weight = 0
    @get('recipeGrains').forEach (grain) ->
      weight += grain.get('weight')
    weight
  ).property('recipeGrains.@each')

  addGrain: ->
    grain = Ember.Object.create
      name: @get('selectedGrain').get('name')
      weight: parseFloat(@get('amount'))
    @get('recipeGrains').pushObject(grain)
    @set('selectedGrain', null)
    @set('amount', null) 
```

我写了以下测试。

```
describe("Controllers", function() {
  describe("NewRecipeController", function() {
    var controller;

    beforeEach(function() {
      controller = Brewery.NewRecipeController.create();
    });

    it("calculates the correct total weight", function() {
      var grains = controller.get('recipeGrains');
      grains.pushObject(Ember.Object.create({weight: 4.0}));
      grains.pushObject(Ember.Object.create({weight: 3.2}));
      expect(controller.get('totalWeight')).toEqual(7.2);
    });

    it ("adds grains based on its selected grain", function() {
      controller.set('selectedGrain', Ember.Object.create({name: "Wheat"}));
      controller.set('amount', '10.2');
      controller.addGrain();
      expect(controller.get('totalWeight')).toEqual(10.2);
    });
  });
}); 
```

我预计两个测试都会通过，但是第二个测试失败并显示消息

> 预计 17.4 等于 10.2。

似乎第一个测试的状态正在溢出第二个测试。比我更有知识的人能否解释 Ember 如何处理控制器状态以及为什么会发生这种情况？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:01:47.610

您的测试失败的原因是默认值初始化@第 4 行。

您应该在`init`方法中设置初始值`App.RecipeController`或在实例创建时传递值：

```
App.RecipeController = Ember.Controller.extend
  init: ->
    @set 'recipeGrains', Ember.A() 
```

或者

```
controller = Brewery.NewRecipeController.create({ recipeGrains: Ember.A() }); 
```

你应该看看[这篇文章的第 6 节](http://codebrief.com/2012/03/eight-ember-dot-js-gotchas-with-workarounds/)。

# algorithm - 如何确定一个范围内的数字？

> ID：13071308
> 
> 赞同：1
> 
> 时间：2012-10-25T14:52:30.787
> 
> 标签：algorithm, data-structures

给定范围如 0..5.....20....25..40...50......100，我必须确定一个数字在哪个范围内。所以问题是确定数字在哪个范围内的最快方法，例如 aNum = 56 在 50....100 范围内。确定范围后，我将范围的起始编号分配给 aNum，在本例中为 50。所以最后，aNum = 50。

我只是想知道它是否可以花费恒定的时间 O(1) 。

任何建议将不胜感激。您可以使用任何数据结构来执行此操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:05:52.647

对于显示的范围类型（​​可被 5 整除），以下算法很好：

1.  将所有范围划分为 5（因此，例如 25-40 实际上是 3 个范围：25-29、30-34 和 35-39。

2.  制作一个查找数组，将分段键为范围。因此，例如，如果范围 25-39 是 #4，段 25-29 是 #15，则 30-34 是 #16，而 35-39 是 #17。然后lookup[15] = 4，lookup[16]=4，lookup[17]=4，等等。

3.  现在是分工问题。将数字除以 5 得到 D，然后范围 # = lookup[D]。

如果您的范围是不规则的并且不能被一个公共数字整除，那么可以以内存为代价创建一个包含所有可能值的查找表。

这是一个线性时间算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:09:44.493

假设存在`N`有序范围，则可以`O(Log N)`使用二进制搜索算法找到目标范围。少于那将是不可能的。例如，您可以考虑所有范围都相等的情况，例如：

```
1..2..3..4.. .. 99..100 
```

在这种情况下，查找目标范围相当于在已排序的数组中查找数字，而在`O(1)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T03:14:40.893

这是一个示例算法：

1.  确定范围的数量以及每个范围的最小值和最大值。
2.  遍历所有范围并将数字与每个范围的最小值和最大值进行比较。
3.  如果它在任何范围内，请将其设置为等于该范围的最小值。
4.  如果它不在任何范围内，请执行所需的任何操作。

以下代码说明了在 C 中实现此算法的示例：

```
#include <stdio.h>
#include <stdlib.h>

/*We assume there is a fixed number of ranges*/
#define RANGE_COUNT 4

int main(int argc, char** argv){
   /*Set the minimum and maximum values for each range*/
   int ranges[RANGE_COUNT][2] = {{0, 5}, {20, 20}, {25, 40}, {50, 100}};
   int x = 0, num = 0;

   /*In this example, we are using the command-line for input*/
   if(argc != 2){
      fprintf(stderr, "Usage: %s <number>", argv[0]);
      exit(1);
   }

   /*We need to ensure that the input is a number*/
   if(!(num = atoi(argv[1])) && argv[1][0] != '0'){
      fprintf(stderr, "Error: \"%s\" is not a number", argv[1]);
      exit(1);
   }

   /*See if the number is in any of the ranges*/
   for(x = 0; x < RANGE_COUNT; x++){
      if(num >= ranges[x][0] && num <= ranges[x][1]){
         /*If the number is in a range, say which one it is*/
         printf("The number %d is in the range %d..%d\n",
            num, ranges[x][0], ranges[x][1]);

         /*Set the number equal to the minimum value of the range it is in*/
         num = ranges[x][0];
         printf("num = %d\n", num);
         exit(0);
      }
   }

   /*If the number is not in any of these ranges, indicate that it is not*/
   printf("The number %d is not in any of these ranges\n", num);

   return 0;
} 
```

# java - 有没有办法让“相对路径”成为在 netbeans 中添加 JAR 文件的默认值？

> ID：13071313
> 
> 赞同：0
> 
> 时间：2012-10-25T14:52:51.490
> 
> 标签：java, netbeans, jar, relative-path, absolute-path

在 netbeans 中，如果您右键单击一个项目，`Properties`然后单击`Libraries`，它会显示当前添加到您的项目的 JAR 文件的列表。然后您可以通过单击添加更多库`Add JAR/Folder`。但是，当您单击 JAR 文件时，它默认为`Absolute Path`. 在我的特殊情况下，这**绝不**是我想要的，我经常只是`Open`错误地点击并添加文件。当我检查我的项目更改为 SVN 时，绝对路径会中断我所有团队成员的构建。

那么，有没有办法让`Relative Path`默认值呢？

更新：澄清一下，我在 netbeans 中打开了多个项目。

Main - /lib/ 包含我所有的 JAR 文件。main 是指 lib 文件夹中的一些 JAR 文件，默认添加 JAR 文件描述使用`Relative Path`。

PluginA - 使用并引用 Main/lib 中的一些 JAR 文件。我正在按照描述添加 JAR 文件，它们默认为`Absolute Path`. 我希望**这些**默认使用`Relative Path`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T17:59:41.570

可悲的是，我怀疑[这个错误](http://netbeans.org/bugzilla/show_bug.cgi?id=169967)的存在意味着答案是没有办法将**相对路径**设为默认值。

寻找替代方案：在同一个错误中，有[这样的 NB 行为描述](http://netbeans.org/bugzilla/show_bug.cgi?id=169967#c4)：

> 1.  如果根据此信息的某些提供者（通常是检查文件路径是否在同一签出中的版本控制系统），JAR 被认为与基于项目的项目“并置”，则默认情况下会检查相对。（因为可以确保检查相同来源的其他人确实能够使用相同的路径。）
>     
>     
> 2.  如果可以使用命名变量引用 JAR，则使用该变量。

因此，如果项目位于同一个 SVN 存储库中，则使用单个工作副本（我直到最近才这样做，以及为什么我从未注意到**绝对**/**相对**问题）可以工作。

否则，为该`/lib`目录定义一个变量可能是一种解决方法。

# interop - 使用 Direct 2D GdiInteropRenderTarget 的 GDI 对象泄漏

> ID：13071318
> 
> 赞同：3
> 
> 时间：2012-10-25T14:53:11.377
> 
> 标签：interop, gdi, memory-leaks, direct2d

我正在尝试在兼容的渲染目标上同时使用 Gdi 和 Direct 2D 渲染位图。我使用 D2D1_COMPATIBLE_RENDER_TARGET_OPTIONS_GDI_COMPATIBLE 选项创建兼容目标，然后执行以下操作：

```
HDC hdc=NULL;
ID2D1GdiInteropRenderTarget *gdiTarget=NULL;
target->QueryInterface(__uuidof(ID2D1GdiInteropRenderTarget), (void**)&gdiTarget);
target.BeginDraw();
HRESULT hr=gdiTarget->GetDC(D2D1_DC_INITIALIZE_MODE_CLEAR, &hdc);
if(SUCCEEDED(hr))
{
    /* Gdi drawing code(hdc)*/

gdiTarget->ReleaseDC(NULL);
}
/* Direct2D drawing code
target->EndDraw();
gdiTarget->Release(); 
```

但似乎出了点问题，因为每次我调用这个渲染方法我都会得到很多 GDI 对象泄漏。我也尝试这样做：

```
HDC hdc=NULL;
ID2D1GdiInteropRenderTarget *gdiTarget=NULL;
target->QueryInterface(__uuidof(ID2D1GdiInteropRenderTarget), (void**)&gdiTarget);
target.BeginDraw();
HRESULT hr=gdiTarget->GetDC(D2D1_DC_INITIALIZE_MODE_CLEAR, &hdc);
if(SUCCEEDED(hr))
gdiTarget->ReleaseDC(NULL);
target->EndDraw();
gdiTarget->Release(); 
```

我也有泄漏。我还尝试在由 ID2D1GdiInteropRenderTarget 创建的 HDC 上使用 DeleteDC() 或 ReleaseDC() 但没有成功。

有什么建议吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:31:22.913

如果渲染目标使用加速，那么结果将不会非常高效。您应该强烈考虑在 D2D 中进行本机渲染。原因是您会产生从 GPU 转移到系统的成本。我已经将很多绘图代码移植到本机 D2D。有一些 api 您可能需要 GDI（xor 等），但通常即使是那些也应该尝试另一种方法。

我不确定您为什么会泄漏，但您需要遵循此处的指南：http: [//msdn.microsoft.com/en-us/library/windows/desktop/dd370971 (v=vs.85 ).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd370971(v=vs.85).aspx)

我不建议使用 dc 渲染目标，它比使用 GDI+ 慢。对于需要的几次调用，请使用概述的第二种方法。
此外，您将需要处理可能在 D2D 中生效的任何剪辑/图层。

最后，您需要在调用 EndDraw*之前释放 GDI 接口。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T11:06:57.983

我发现了问题。这是一个未释放的 d2dBitmap，有时会导致内存泄漏，并且当我尝试释放 ID2D1GdiInteropRenderTarget 时，它会导致 Gdi 对象泄漏。

```
HDC hdc=NULL;
ID2D1GdiInteropRenderTarget *gdiTarget=NULL;
compatibleTarget->QueryInterface(__uuidof(ID2D1GdiInteropRenderTarget),(void**)&gdiTarget);
compatibleTarget.BeginDraw();
HRESULT hr=gdiTarget->GetDC(D2D1_DC_INITIALIZE_MODE_CLEAR, &hdc);
if(SUCCEEDED(hr))
{
    /* Gdi drawing code(hdc)*/

gdiTarget->ReleaseDC(NULL);
}
/* Direct2D drawing code
compatibleTarget->EndDraw();
gdiTarget->Release();
ID2D1Bitmap *bitmap=NULL;
compatibleTarget->GetBitmap(&bitmap);
target->BeginDraw();
target->DrawBitmap(bitmap);
target->EndDraw();
compatibleTarget->Release();    // I thought this only enough
bitmap->Release();              // This solved the problem 
```

我仍然对使用哪种类型的目标（DC 或 Hwnd）更好感到有些困惑，因为我发现不同的性能取决于我是否使用 Gpu。特别是，我发现了以下问题：

*   如果我使用 DCRenderTarget 我不能使用硬件加速（或默认），因为我继续违反内存的保护区。如果我使用 HwndRenderTarget，这不会发生。
*   如果我使用 HwndRenderTarget，通常一切都很好，但是我失去了对窗口的关注，它无法识别 KeyPressed 消息，并且，如果我使用 Gpu，性能会下降很多并且很大程度上取决于活动目标的数量（如果我使用软件加速就不会发生这种情况）。

有没有人遇到过同样的问题？你能推荐一些关于它的东西吗？

# perl - perl：“不包括”模块

> ID：13071319
> 
> 赞同：4
> 
> 时间：2012-10-25T14:53:14.467
> 
> 标签：perl, perl-module

所以，我有一个这样的程序：

```
#!/usr/bin/perl -w  
use strict;  
foreach (@data) {  
    if($_ eq "foo") {  
        use Foo;
        process();
    }  
    if($_ eq "bar") {  
        use Bar;
        process();
    }  
...  
} 
```

每个包含的模块都有些相似，唯一的区别是 process()-sub 的作用。

```
#!/usr/bin/perl -w  
use strict;  
sub process {  
...  
} 
```

我的问题：主脚本的输入是一个（可能很长）列表，在处理该列表时，我得到连续的“子程序重新定义”错误（显然）。有没有办法“取消使用”一个模块？
由于将来可能包含的“动作”库可能会增长，我认为这种动态包含模块的方式将是最好的方法。非常感谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T15:05:43.840

正如@pilcrow 所说，您可以通过使用`require`而不是快速解决此问题`use`，但是，我认为这是使用[多态性](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)的一个很好的例子。

您可以创建一个基类，如：

```
package Processors::Base;

sub new{
  my $class = shift;
  return bless {}, $class;
}

sub process{
  die "You can only use a subclass of me";
}

1; 
```

然后，将您的*处理器*创建为从该基本包继承的包。

```
package Processors::Foo;

sub process{
  ... do stuff ...
}

1; 
```

然后您的代码可能如下所示：

```
#!/usr/bin/perl -w  
use strict;  
for my $pkg (@data) { 
    (my $path = $pkg) =~ s{::}{/}g;
    require "$path.pm";
    $pkg->process; 
    ...  
} 
```

当然，修改假设是例如`$_`的形式。`Processors::Foo`即使你不能修改你的内容`@data`，我认为你可以生成处理器的名称，以便你能够调用它的`process()`方法。

如果您想炫耀，您可以创建一个[`Factory`](http://en.wikipedia.org/wiki/Factory_method_pattern)对象，该对象将根据以下值返回处理器实例`$_`：

```
package Processors::Factory;

sub get_instance{
  my ($self, $processor_name) = @_;

  my $full_processor_name = sprintf('Processors::%s', ucfirst($processor_name) );

  (my $full_processor_path = $full_processor_pkg) =~ s{::}{/}g;
  require "$full_processor_path.pm";

  my $processor = $full_processor_name->new();

  return $processor;
}

1; 
```

然后，您的代码将如下所示：

```
#!/usr/bin/perl -w  
use strict;
use Processors::Factory;

foreach (@data) { 
    Processors::Factory->get_instance( $_ )->process();
    ...  
} 
```

# c# - 如何访问父表单功能？

> ID：13071320
> 
> 赞同：1
> 
> 时间：2012-10-25T14:53:17.540
> 
> 标签：c#, winforms

我正在尝试访问父表单功能（方法）。即使使用 static 关键字，它也不起作用。

父窗体是类型 (MDI) 并具有正常的子窗体。这是 C# 应用程序。我正在尝试使用这种方式来访问方法，但没有提前！

```
this.MdiParent 
```

请帮我 ！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-25T14:54:47.650

如果你声明了静态方法，那么你应该通过父表单的类名来调用它们：

```
YourParentFormType.YourStaticMethod(); 
```

如果要使用实例方法，则应将它们声明为`public`并通过强制转换 MDI 父引用调用：

```
((YourParentFormType)this.MdiParent).YourInstanceMethod(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T14:55:32.147

您必须转换`this.MdiParent`为正确的类型。

如果您的父表单是 type `MyForm`，请使用

```
 ((MyForm)this.MdiParent).MyMethod(); 
```

静态方法也一样：通过正确的类型调用它们

```
MyForm.MyStaticMethod(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T14:57:00.833

this.MdiParent 返回 Form 类型的实例

这意味着它只会显示在 Form 类定义中定义的函数。

为了达到其他方法，您需要将其转换为实现表单的类类型，例如

((MyForm)Form).MyFunction()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T14:57:17.413

静态方法可以使用`Type.Method()`.

如果要访问实例方法，则需要将其`MdiParent`转换为正确的类型。

```
MyParentType parent = (MyParentType)this.MdiParent;
parent.SomeMethod(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T15:05:32.453

[`MdiParent`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.mdiparent.aspx)创建表单时需要设置表单的属性：

```
// Make the new form a child form.
child.MdiParent = this;
// Display the child form.
child.Show(); 
```

然后您可以访问父表单。如果您只想要 Form 属性，则不需要强制转换：

```
Form parent = this.MdIParent;
string parentTitle = parent.Text; 
```

如果您需要访问 cusotm 属性/方法，只需将其转换为正确的类型：

```
ParentForm parent = this.MdIParent as ParentForm;   // using your own type name of course
string title = parent.MyStringProperty; 
```

# javascript - Javascript作为单线程工作，jquery如何完成ajax

> ID：13071325
> 
> 赞同：0
> 
> 时间：2012-10-25T14:53:25.517
> 
> 标签：javascript, asynchronous

> **可能重复：**
> [javascript 是否保证是单线程的？](https://stackoverflow.com/questions/2734025/is-javascript-guaranteed-to-be-single-threaded)

Javascript作为单线程工作。但是ajax工作是异步的，那么它的机制是什么。它调用了setTimeouts和setInterval？

javascript 代码如何知道 ajax 调用已完成。通过投票？它询问服务器呼叫是否每 1ms 完成一次？

# cookies - 我收到了不是由我的服务器设置的 cookie

> ID：13071333
> 
> 赞同：2
> 
> 时间：2012-10-25T14:54:07.867
> 
> 标签：cookies

我经营一个商业网站并使用 cookie。我记录了所有用户流量，并且经常可以看到用户浏览器发送给我的不是我设置的 cookie。规则规定浏览器不能发送由另一个域设置的 cookie。也许javascript可以设置一个cookie，但是我的服务器不会寻找除了我的PHP软件设置的cookie之外的任何cookie。

由于我经常收到网络攻击，我将中止任何请求的页面，其中包含任何 GET、POST 或 COOKIE 数据以及我不使用的变量以及包含我不会使用的字符的任何数据，并且如果变量的字符串长度超出限制我设置。

我担心我的一些客户群由于这个 cookie 问题而无法使用该网站。通过查看用户代理信息，我发现蜘蛛主要负责我的网站中止请求的页面。

有谁了解这种行为，并且可能知道向服务器发送未知 cookie 的意义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:28:50.940

这些可能来自几个地方。

正如您所猜测的，cookie 可以在客户端使用 JavaScript 设置。也可以为整个域及其所有子域设置它们，例如，`yoursite.example.com`可以为 设置 cookie `.example.com`，然后将其发送到example.com 的*任何子*域。

无论哪种情况，您的服务器都可能不是 cookie 的目标。就像 JavaScript 可以设置一个 cookie（带有`document.cookie`）一样，它也可以从这些 cookie 中读取。这是在浏览会话中使数据在页面之间持久保存的最广泛支持的方法之一；数据被发送到服务器的事实可能只是一个意想不到的副作用。您在分析脚本或广告网络跟踪等方面经常看到这一点。

一般来说，这些 cookie 没什么好担心的。只要您*始终*验证用户输入，就可以了。

如果您担心 JavaScript 设置的 cookie 会覆盖*您的*cookie，您可以将 cookie 设置为仅 HTTP。请参阅[setcookie 上的 PHP 文档以](http://php.net/manual/en/function.setcookie.php)了解如何执行此操作。

# android - 如何在循环中检查文件夹是否为空？

> ID：13071338
> 
> 赞同：1
> 
> 时间：2012-10-25T14:54:14.830
> 
> 标签：android, for-loop, directory, is-empty

我有一个问题，我知道如何检查文件夹是否为空，但是当我在循环中检查文件夹是否为空时总是出错，这是我的代码示例，它不起作用。

```
String sdcard = Environment.getExternalStorageDirectory().toString();
        File file = new File(sdcard);
        File subFiles[] = file.listFiles();
        for(int i=0; i<subFiles.length; i++) {
            File subFile = new File(sdcard +"/"+ subFiles[i].getName());
            if(subFile.isDirectory() && subFile.listFiles().length==0) {

            }
        } 
```

我总是在我的情况下得到错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:06:58.147

这是您的代码的更好版本，它也是一个递归版本，这意味着它将搜索存储中的所有空文件夹。实际上，在这里进行空检查不是正确的，因为[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html#listFiles%28%29)告诉它只有在不是目录`null`时才会返回。`file`

```
public static void traverseEmptyFolders(File root) {
        if (root.isFile()) {
            throw new IllegalArgumentException("Argument should be a directory.");
        }
        for (File file : root.listFiles()) {
            if (file.isDirectory()) {
                File[] contents = file.listFiles(); 
                if (contents == null || contents.length == 0) {
                    // do something for an empty folder
                } else {
                    traverseEmptyFolders(file);
                }
            }
        }
    }

    public static void someOtherMethod() {
        traverseEmptyFolders(Environment.getExternalStorageDirectory());
    } 
```

让我知道这个是否奏效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:01:32.927

```
String sdcard = Environment.getExternalStorageDirectory().toString();
    File file = new File(sdcard);
    File subFiles[] = file.listFiles();
    for(int i=0; i<subFiles.length; i++) {
        File subFile = new File(sdcard +"/"+ subFiles[i].getName()); 
```

文件 temp[] = subFiles.length;

```
 if(subFile.isDirectory() && (temp != null && temp.length == 0)) {

        }
    } 
```

# c++ - 如何在编译时检查两种类型是否相同（如果它与 Boost strong typedef 一起使用则加分）

> ID：13071340
> 
> 赞同：27
> 
> 时间：2012-10-25T14:54:22.320
> 
> 标签：c++, c++11, template-meta-programming, constexpr, static-assert

我想知道是否可以在编译时检查两种类型是否相同。我想出的是（idk，如果它有效，因为它感觉很hackish并且IDK标准很好，所以IDK在测试时要寻找什么）。

```
#include <boost/strong_typedef.hpp>
BOOST_STRONG_TYPEDEF(double, cm);
BOOST_STRONG_TYPEDEF(double, inch);
template<typename T, typename U>
static constexpr void __help() 
{
}
template<typename T, typename U>
class AreSameType
{
    public:
    constexpr operator bool()
    {
     return &__help<T,U> == &__help<U,T>;
    };
}; 
```

用法 ：

```
int main()
{
        static_assert(AreSameType<double,float>()== false, "oh noes1");
        static_assert(AreSameType<double,double>()== true, "oh noes2");
        static_assert(AreSameType<int*,double*>()== false, "oh noes3");
        static_assert(AreSameType<double*,double>()== false, "oh noes4");
        static_assert(AreSameType<const double,double>()== false, "oh noes5");
        static_assert(AreSameType<inch,cm>()== true, "oh expected"); //fires
} 
```

所以

1）有更好的方法吗？
2）这个函数hack的地址是否保证按标准工作（我敢打赌不是:)）？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-10-25T14:56:51.100

使用`std::is_same`. `std::is_same<T,U>::value`如果 T 和 U 是同一类型，则为 true，否则为 false。

如果你没有 C++11，那么很容易实现

```
template<class T, class U>
struct is_same {
    enum { value = 0 };
};

template<class T>
struct is_same<T, T> {
    enum { value = 1 };
}; 
```

# c# - 隐藏某些 XAML 定义的上下文菜单项，除非按下 shift

> ID：13071341
> 
> 赞同：0
> 
> 时间：2012-10-25T14:54:23.843
> 
> 标签：c#, wpf, xaml, contextmenu

我有一个定义上下文菜单的 DataTemplate：

```
<DataTemplate>
    <TextBlock>
        <TextBlock.ContextMenu>
            <ContextMenu>
                <MenuItem Command="{Binding SendToRecycleBin}" Header="Delete">
            </ContextMenu>
        </TextBlock.ContextMenu>
    </TextBlock>
</DataTemplate> 
```

我想将另一个菜单项添加到上下文菜单中，仅当用户在打开上下文菜单时按住 Shift 时才显示，仅使用 XAML（也许创建一个新的附加属性 App.PowerUserOnly？）：

```
<MenuItem Command="{Binding Delete}" Header="Permanently Delete"
                                     local:App.PowerUserOnly="true"> 
```

这可以仅在 XAML 中完成（如果可以，如何？），还是必须使用后面的代码？

编辑：当在打开上下文菜单时按住 Shift 时，Windows shell 还会显示高级选项。我试图模仿这种行为。例如，应用程序的高级选项之一是以不同用户身份运行它。

我简化了我的代码来帮助测试人们的建议。该项目是在 VS2010 中使用名为 ShiftContextMenu 的默认 WPF 应用程序创建的。App.xaml 和 App.xaml.cs 文件未修改。

MainWindow.xaml：

```
<Window x:Class="ShiftContextMenu.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <DataTemplate x:Key="DummyItemTemplate">
            <TextBlock Text="{Binding Name}">
                <TextBlock.ContextMenu>
                    <ContextMenu>
                        <MenuItem Command="{Binding SendToRecycleBin}" Header="Delete" />
                        <MenuItem Command="{Binding Delete}" Header="Permanently Delete" />
                    </ContextMenu>
                </TextBlock.ContextMenu>
            </TextBlock>
        </DataTemplate>
    </Window.Resources>
    <TreeView Name="tvMain" ItemTemplate="{StaticResource DummyItemTemplate}" ItemsSource="{Binding DummyItems}" />
</Window> 
```

MainWindow.xaml.cs：

```
using System.Collections.Generic;
using System.Windows;
using System.Collections.ObjectModel;

namespace ShiftContextMenu
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            DummyItem[] dummyItems = new DummyItem[] {
                new DummyItem("First"),
                new DummyItem("Second"),
                new DummyItem("Third")
            };
            DummyItems = new ReadOnlyCollection<DummyItem>(new List<DummyItem>(dummyItems));
            this.DataContext = this;
            InitializeComponent();
        }

        public ReadOnlyCollection<DummyItem> DummyItems { get; protected set; }
    }
} 
```

ViewModelBase.cs：

```
using System.ComponentModel;

namespace ShiftContextMenu
{
    public class ViewModelBase : INotifyPropertyChanged
    {
        protected PropertyChangedEventHandler _propertyChangedEvent;

        protected void SendPropertyChanged(string propertyName)
        {
            if (_propertyChangedEvent != null)
            {
                _propertyChangedEvent(this, new PropertyChangedEventArgs(propertyName));
            }
        }

        public event PropertyChangedEventHandler PropertyChanged
        {
            add
            {
                _propertyChangedEvent += value;
            }
            remove
            {
                _propertyChangedEvent -= value;
            }
        }
    }
} 
```

DummyItem.cs：

```
using System;
using System.Windows.Input;
using System.Windows;

namespace ShiftContextMenu
{
    public class DummyItem : ViewModelBase
    {
        public string Name { get; protected set; }

        public DummyItem(string name)
        {
            Name = name;
            _sendToRecycleBinCommand = new SendToRecycleBinCommand();
            _deleteCommand = new DeleteCommand();
        }

        protected SendToRecycleBinCommand _sendToRecycleBinCommand;
        protected DeleteCommand _deleteCommand;

        public ICommand SendToRecycleBin { get { return _sendToRecycleBinCommand; } }
        public ICommand Delete { get { return _deleteCommand; } }

        protected class SendToRecycleBinCommand : ICommand
        {
            public void Execute(object parameter)
            {
                MessageBox.Show("Send To Recycle Bin");
            }

            public bool CanExecute(object parameter)
            {
                return true;
            }

            public event EventHandler CanExecuteChanged { add { } remove { } }
        }

        protected class DeleteCommand : ICommand
        {
            public void Execute(object parameter)
            {
                MessageBox.Show("Permanently Delete");
            }

            public bool CanExecute(object parameter)
            {
                return true;
            }

            public event EventHandler CanExecuteChanged { add { } remove { } }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:57:01.193

Windows shell 行为解决方案：

在此解决方案中，我使用了两个程序集：

1.  System.Windows.Interactivity
2.  System.Windows.Forms

将以下命名空间添加到窗口：

```
xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity" 
```

数据模板应如下所示：

```
<DataTemplate x:Key="DummyItemTemplate">
            <TextBlock Text="{Binding Name}">
                <TextBlock.ContextMenu>
                    <ContextMenu> 
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Opened">
                                <i:InvokeCommandAction Command="{Binding ShowMoreOptions}" />
                            </i:EventTrigger>
                            <i:EventTrigger EventName="Closed">
                                <i:InvokeCommandAction Command="{Binding HideMoreOptions}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                        <MenuItem Command="{Binding SendToRecycleBin}" Header="Delete" />
                        <MenuItem Command="{Binding Delete}" Header="Permanently Delete">
                        <MenuItem.Style>
                            <Style TargetType="MenuItem">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsVisibleDelete}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.Style>    
                    </MenuItem>
                    </ContextMenu>
                </TextBlock.ContextMenu>
            </TextBlock>
        </DataTemplate> 
```

在`DummyItem`课堂上，您必须添加两个命令和一个属性：

```
private bool _isVisibleDelete;
public bool IsVisibleDelete
{
    get { return _isVisibleDelete; }
    set { _isVisibleDelete = value; SendPropertyChanged("IsVisibleDelete"); }
}

public ICommand ShowMoreOptions { get; private set; }
private void OnShowMoreOptions()
{
    if (System.Windows.Forms.Control.ModifierKeys == System.Windows.Forms.Keys.Shift)
        IsVisibleDelete = true;
}

public ICommand HideMoreOptions { get; private set; }
private void OnHideMoreOptions()
{
    IsVisibleDelete = false;
} 
```

在我的示例中，我`DelegateCommand`从`Microsoft.Practices.Prism`程序集中使用。

所以在ctor中`DummyItem`我有：

```
 ShowMoreOptions = new DelegateCommand(this.OnShowMoreOptions);
 HideMoreOptions = new DelegateCommand(this.OnHideMoreOptions); 
```

*第二种解决方案允许您动态更改此菜单：*

你可以尝试这样的事情：

XAML 文件：

```
<TextBlock>
            <TextBlock.ContextMenu>
                <ContextMenu>
                    <ContextMenu.InputBindings>
                        <KeyBinding Modifiers="Shift" Key="Shift" Command="{Binding ShowMoreOptions}" />
                    </ContextMenu.InputBindings>
                    <MenuItem Command="{Binding SendToRecycleBin}" Header="Delete" />
                    <MenuItem Command="{Binding Delete}" Header="Permanently Delete">
                        <MenuItem.Style>
                            <Style TargetType="MenuItem">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsVisibleDelete}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </MenuItem.Style>    
                    </MenuItem>
                </ContextMenu>
            </TextBlock.ContextMenu>
        </TextBlock> 
```

在您的 ViewModel 类中，您应该添加属性和命令来更改`MenyItem`可见性属性：

```
private bool _isVisibleDelete;
public bool IsVisibleDelete
{
    get { return _isVisibleDelete; }
    set { _isVisibleDelete = value; RaisePropertyChanged(() => IsVisibleDelete); }
}

public ICommand ShowMoreOptions { get; private set; }
private void OnShowMoreOptions()
{
    IsVisibleDelete = !IsVisibleDelete;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T20:48:30.367

kmatyaszek 的回答有效，但我不喜欢修改我的 ViewModel。所以我最终创建了我在问题中提出的附加依赖属性：

```
public static readonly DependencyProperty PowerUserOnlyProperty =
    DependencyProperty.RegisterAttached(
        "PowerUserOnly", 
        typeof(bool), 
        typeof(App), 
        new UIPropertyMetadata(false, new PropertyChangedCallback(PUOChanged)));

public static bool GetPowerUserOnly(MenuItem obj)
{
    return (bool)obj.GetValue(PowerUserOnlyProperty);
}

public static void SetPowerUserOnly(MenuItem obj, bool value)
{
    obj.SetValue(PowerUserOnlyProperty, value);
}

public static void PUOChanged(object sender, DependencyPropertyChangedEventArgs e)
{
    MenuItem menuItem = sender as MenuItem;
    if (menuItem == null) return;

    bool value = (bool)e.NewValue;
    if (!value) return;

    new PowerUserOnlyHelper(menuItem);
}

public class PowerUserOnlyHelper
{
    public MenuItem Item { get; protected set; }

    public PowerUserOnlyHelper(MenuItem menuItem)
    {
        Item = menuItem;

        ContextMenu parent = VisualUpwardSearch<ContextMenu>(menuItem);
        if (parent != null)
        {
            parent.Opened += new RoutedEventHandler(OnContextMenuOpened);
        }
    }

    protected void OnContextMenuOpened(object sender, RoutedEventArgs e)
    {
        Visibility v;
        if ((Keyboard.Modifiers & ModifierKeys.Shift) == ModifierKeys.Shift)
        {
            v = Visibility.Visible;
        }
        else v = Visibility.Collapsed;

        Item.Visibility = v;
    }
}

public static T VisualUpwardSearch<T>(DependencyObject source)
    where T : DependencyObject
{
    DependencyObject returnVal = source;
    DependencyObject tempReturnVal;

    while (returnVal != null && !(returnVal is T))
    {
        tempReturnVal = null;
        if (returnVal is Visual || returnVal is Visual3D)
        {
            tempReturnVal = VisualTreeHelper.GetParent(returnVal);
        }
        if (tempReturnVal == null)
        {
            returnVal = LogicalTreeHelper.GetParent(returnVal);
        }
        else
        {
            returnVal = tempReturnVal;
        }
    }

    return returnVal as T;
} 
```

# ruby - 带虾的图形

> ID：13071344
> 
> 赞同：5
> 
> 时间：2012-10-25T14:54:31.003
> 
> 标签：ruby, prawn

寻找一个可以为虾添加绘图功能的宝石，我找到[了这个](https://github.com/HHRy/prawn-graph/)，但它似乎有点过时了。有没有更活跃的宝石呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-19T09:14:26.923

直接在 Prawn 中绘图没有什么非常活跃的，但是[Gruff](https://github.com/topfunky/gruff)是一个高度可配置的活跃 gem，可以让你制作各种图表。

事实上，prawn-graph 基本上是 gruff 的包装器！

我的建议是使用 gruff 生成所需的图表和图形，然后将它们作为图像嵌入到 Prawn 文档中。

所以代码看起来像这样：

```
g = Gruff::Line.new(400)
g.title = "Transparent Background"
g.theme = {
  :colors => ['black', 'grey'],
  :marker_color => 'grey',
  :font_color => 'black',
  :background_colors => 'transparent'
}
g.labels = {
  0 => '5/6',
  1 => '5/15',
  2 => '5/24',
  3 => '5/30',
}
g.data(:apples, [-1, 0, 4, -4])
g.data(:peaches, [10, 8, 6, 3])
g.write(path_to_save)

Prawn::Document.generate("graphed-pdf.pdf") do
    text "The image will go right below this line of text."
    image "#{path_to_save}"
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-23T22:56:18.040

@eggie5 关于使用 gruff 和 prawn 插入图像而不将其保存到磁盘，这很简单：

```
image StringIO.new(g.to_blob) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-17T18:48:45.423

我创建了一个名为[PrawnCharts](https://github.com/MrPowers/prawn_charts?source=c)的虾图形库，它只依赖于 Prawn，不依赖于 rMagick 和 ImageMagick。rMagick 和 ImageMagick 是令人讨厌的依赖项（大文件，安装起来很痛苦等），与像 PrawnCharts 这样的原生解决方案相比，它们会创建更大的文件。

这是我使用 PrawnCharts 生成的图表示例：

![在此处输入图像描述](../Images/9d53dae71ea67e5ab1ed770ec25092d0.png)

随意提交拉取请求 - 我将合并它们。

# c# - 通过 WPF DataGrid 中的列标题获取列索引

> ID：13071346
> 
> 赞同：7
> 
> 时间：2012-10-25T14:54:33.347
> 
> 标签：c#, wpf, datagrid

如何获取`Column`索引或`Column.DisplayIndex`从其`Column Header`in `WPF` `DataGrid`？

我知道了`Column Header`，想得到`column index`。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-25T14:58:29.620

您可以使用`DisplayIndex`（请注意，如果使用列，这会改变）

```
var index = dataGrid.Columns.Single(c => c.Header.ToString() == "HeaderName").DisplayIndex; 
```

编辑：感谢@AnHX 的建议

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-19T04:10:29.663

看起来像“保罗”有一个小错误。这是我的代码：

```
var index = dataGrid.Columns.Single(c => c.Header.ToString() == "HeaderName").DisplayIndex; 
```

# objective-c - Objective-C：可以用只读属性替换所有访问器吗？

> ID：13071349
> 
> 赞同：3
> 
> 时间：2012-10-25T14:54:37.823
> 
> 标签：objective-c, properties, styles

如果我用Objective-C 中的**只读属性替换我的所有****访问器**（get-like const 方法），有什么缺点吗？它们可以互换吗？

 ***我更喜欢文档/可读性的只读属性。*

来自 C++，我正在考虑用ObjC 中的**只读属性替换我的所有 const 方法（非可变方法）。**

如果我遵守这个约定，那么我可以自动假设任何常规方法都会改变状态（C++ 中的非常量方法）。同样从函数式编程的角度来看，知道只读属性不会改变任何状态（没有副作用）是有用的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:28:35.930

是的，当然——如果您愿意，也可以采用这种方式实现。从上下文来看，这样做有很多潜在的好处。

需要注意的*缺点*是生成属性的成本——它们可能会[慢 20 倍以上](https://stackoverflow.com/questions/588866/atomic-vs-nonatomic-properties/12017579#12017579)。如果（例如）您的财产不可重新分配，那么执行所有参考计数循环/自动释放活动是一种巨大的浪费。

另一个（次要）缺点是您会经常发现自己实现或声明私有设置器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:04:16.647

可以以相同的方式访问它们（点语法或方法语法）。做任何感觉最好的事情。尽管我更喜欢将方法作为方法，但当它们执行（某些）逻辑时。如果它只是一个返回一些数据的访问器/获取器，那么属性更适合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T15:09:46.217

这与[键值编码](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/KeyValueCoding.html)有关。采取以下措施：

```
@interface Boat : NSObject {
   NSString *name;
}
@property (nonatomic, retain) NSString *name;
@end 
```

和...

```
@interface Boat
@synthesize name;
@end 
```

合成器所做的（在这种情况下）是创建两种方法：

```
-(NSString *)name;
-(void)setName; 
```

它使用所谓的“驼峰式”命名选择器，将 ivar 的第一个字母更改为大写字母，然后将“set”添加到 setter 的前面。getter 的名称只是 ivar 的名称。

如果您的 ivar 名称和现有方法遵循此模式，那么用属性替换您的手写访问器将完美无缺，无论您使用点语法还是显式消息：

`boat.name = @"Pequod"`编译为`[boat setName:@"Pequod"]`. 并`boat.name`编译为`[boat name]`.

如果您的访问器不是这样命名的，那么您将需要重新处理代码中使用它们的位置以匹配此模式。根据这种模式进行编码是所有 Objective-C / Cocoa 编程的最佳方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T15:20:28.480

是的，它们是可以互换的。

```
@interface MyClass : NSObject
@property (nonatomic, readonly) NSString *myStr;
@end 
```

是相同的

```
@interface MyClass : NSObject
-(NSString *)myStr;
@end
@interface MyClass() { NSString *_myStr } 
@end
@implementation MyClass
-(NSString *)myStr { return _myStr; }
@end 
```

尽管您不会在代码中看到它，但属性确实会创建一个可访问的 myStr 方法。在这两种情况下，您都可以使用 `self.myStr`或`[self myStr]`调用该方法。

旁注：如果您使用的是 iOS 6，则不需要包含 @synthesize 语句。否则你会写：`@synthesize myStr = _myStr;`在实现文件中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-25T15:31:20.707

您仍然需要一些方法来设置它们，并且拥有一个合适的设置器对于自动化内存管理目的通常非常方便。创建类扩展正是为了实现这个目的；公开只读，私人读写。

富.h：

```
@interface Foo : NSObject
@property(readonly, copy) NSString* bar;
@end 
```

Foo.m: @interface Foo() @property(readwrite, copy) NSString* bar; @结尾

```
@implementation Foo
... no need to @synthesize ...
- randomMethod 
```

{ [self setBar:@"bas"]; ... self.bar; _bar = [NSString stringWithFormat:@"%@ %@", [self bar], self.bar]]; }

是的，你想要`copy`@interface 声明中的。接口中的修饰符，即使是只读属性，也可以修改 getter 和 setter 的 codegen。

你可能会[发现我对这个问题的回答](https://stackoverflow.com/questions/1933489/objective-c-2-0-properties-why-both-retain-and-readonly/2322207#2322207)也很相关。**

# variables - 使用 Typo3，是否有可能拥有某种数据存储？

> ID：13071351
> 
> 赞同：1
> 
> 时间：2012-10-25T14:54:39.943
> 
> 标签：variables, global-variables, environment-variables, typo3, datastore

我已经使用 Typo3 几年了，但我主要将它用作 CMS。现在我有一个特定的需求，不知道是否需要找到扩展、编写 TypoScript 或者是否可以使用现有的 Typo3 功能来满足这种需求。

文档就是这样，我在这里。

我的需要类似于需要一个税率表（这不是我的情况，所以不要指向我一些税率管理扩展）。

我需要在一些数据存储中设置变量，并根据日期在前端显示这些数据。例如 ：

```
Effective date             Rate

2010-10-01                 10,00$
2011-10-01                 10,50$
2012-10-01                 11,00$ 
```

基本上，我需要一个非技术用户来编辑这个数据存储，并且我需要能够在前端使用这个速率作为变量。

我很确定过去有人有类似的东西。我对 Typo3 有点迷失了。

任何人都知道**最好**的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:38:41.827

只是粗略的猜测：

您可以使用 kickstarter 使用表“tx_yourextension_rate”创建一个新的扩展“yourextension”。添加字段“生效日期”和“费率”，包括开始/停止时间。安装插件——你只需要表格，不需要插件！

创建用户存储记录的文件夹。

```
lib.rate = CONTENT
lib.rate {
  select {
    # create a folder, where your users stores the records:
    pidInList = 100 
    # just one record
    max = 1
    orderBy = effective_date ASC
  }
  table = tx_yourextension_rate
  renderObj = TEXT
  renderObj {
     field = rate
     wrap = actual rate: <span class="rate">|</span>
  }
} 
```

在需要的地方使用 lib.rate。

# java - 我无法将具有已定义 DTD 的 XML 转换为 JAVA 中的文档类型

> ID：13071353
> 
> 赞同：1
> 
> 时间：2012-10-25T14:54:41.253
> 
> 标签：java, xml-parsing, dtd-parsing

> **可能重复：**
> [使 DocumentBuilder.parse 忽略 DTD 引用](https://stackoverflow.com/questions/155101/make-documentbuilder-parse-ignore-dtd-references)

这是我的示例 XML

```
<?xml version="1.0" standalone="no"?>
<!DOCTYPE factory-requirements SYSTEM "factory.7.0.dtd">
<data name="product">
  <product name="container">
    <one>20 feet</one>
    <two>50 feet</two>
  </product>
</data> 
```

当我尝试将此文件传递到我的文档中时，我收到一个错误。

```
java.io.FileNotFoundException: C:\Documents and Settings\johnB\workspace\project\factory.7.0.dtd (The system cannot find the file specified) 
```

似乎它也在寻找我没有的 DTD。我只需要将这个文件解析为 XML 并获取产品。我不会根据 DTD 验证这个 XML，因为我没有 DTD，而且我们只能从我们的供应商那里得到这个 XML。

这是我的代码：

```
File fstream = new File("C:/Documents and Settings/johnB/workspace/project/factory_product.xml");
DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
Document doc = dBuilder.parse(fstream);
doc.getDocumentElement().normalize(); 
```

我该怎么做才能`<!DOCTYPE factory-requirements SYSTEM "factory.7.0.dtd">`在解析时忽略它？

# javascript - 我在 Android 上的 handleOpenURL 实现不起作用，我错过了什么？

> ID：13071356
> 
> 赞同：1
> 
> 时间：2012-10-25T14:55:02.693
> 
> 标签：javascript, android, cordova

我正在开发一个 PhoneGap 项目，并且我正在尝试实现一个简单的机制来在将 URL 传递给应用程序时调用该`handleOpenURL`方法（根据此示例：[http://goo.gl/FKmFL ）。](http://goo.gl/FKmFL)可悲的是，我遇到了一些绊脚石。问题有两个方面：

**首先**，我的调用`sendJavascript`似乎根本不起作用——没有调用 JavaScript，没有错误，什么都没有。我读过这个功能在活动开始时不起作用，但似乎没有其他人遇到问题......

**其次**，当我打电话时`loadUrl`（参见下面的示例），我收到如下错误消息：

```
ReferenceError: Can't find variable: handleOpenURL at undefined:1 
```

下面是我的Java代码：

```
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    super.loadUrl("file:///android_asset/www/index.html");

    final Intent intent = getIntent();

    Log.d("myApp","Start");
    Log.d("myApp","Data string: " + intent.getDataString());

    if(intent.getDataString() != "" && intent.getDataString() != null) {

        Log.d("myApp","Calling handleOpenURL");         
        String url = intent.getDataString();
        // this.sendJavascript("handleOpenURL(\"" + url +"\");");
        super.loadUrl("javascript:handleOpenURL('"+url+"')");
    }
} 
```

下面是我的 JavaScript 代码：

```
<script>    
    function handleOpenURL(url) {
    $("body").append("<h2>Url:</h2>");
    $("body").append("<p>"+url+"</p>");
}
</script> 
```

您能提供的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-23T18:00:39.700

我在带有 DroidGap 的 Android 上遇到了这个问题......

第一次启动应用程序时，意图数据对 DroidGap 子类方法可见，但是无法将数据导入 Javascript 执行环境以使其可用。

我尝试了一个 sendJavascript 调用（如上所示），但我怀疑这会失败，因为页面尚未完成加载并且 onDeviceReady 尚未触发。

我也尝试在 CookieManager 中设置一个 cookie，但无法让它发挥作用。

将数据附加到查询字符串，即 super.loadURL("file://..." + "#" + url)

然后在 onDeviceReady 事件处理程序中解析 location.href 效果最好。它在第一次启动应用程序时不起作用，但是在应用程序关闭+杀死然后启动之后它会起作用。

它太糟糕了 InvokeString 在 Android 上不起作用并且已被弃用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-25T15:22:45.873

首先，一个小问题，您对 'intent.getDataString() != ""' 的检查将不可靠。它需要是 '!intent.getDataString().equals("")'。

我没有看到对“setJavaScriptEnabled(true)”的调用，这似乎是让它工作的最低要求。

您可能会尝试为此类事情找到一个工作教程，然后开始包含与您的应用程序相关的元素。

# lua - 电晕 - 碰撞检测

> ID：13071357
> 
> 赞同：2
> 
> 时间：2012-10-25T14:55:03.967
> 
> 标签：lua, collision-detection, coronasdk, collision

我有一系列定义如下的圆形对象：

```
local myBalloon = display.newImageRect("images/cracker.png", 20, 20);
myBalloon:setReferencePoint(display.CenterReferencePoint);
myBalloon.x = Random(50, _W-50);
myBalloon.y = (-10);
myBalloon.myName="balloon"
myBalloon.isSleepingAllowed = false;    
physics.addBody(myBalloon, "dynamic", {density=3.0, friction=1.0, bounce=0.0, radius=9}); 
```

然后我有一个这样定义的可移动对象：

```
local threeWay = display.newImageRect("images/3way.png", 80, 43);
threeWay:setReferencePoint(display.CenterReferencePoint);
threeWay.x = (display.contentWidth / 2);
threeWay.y = (display.contentHeight -15);
threeWay.myName = "threeway"
pentagonShape = { -40,-5, 0,-22, 40,-5, 35,20, -35,20 }
physics.addBody(threeWay, "static", {density=4.0, friction=1.7, bounce=0.0, shape=pentagonShape}); 
```

我还为圆形物体设置了碰撞检测，如下所示：

```
function myBalloon:collision(e)
if (timeLeft ~= false) then
    if (playerReady == true) then
        if (e.phase == "ended") then
            if ( e.other.myName == "threeway" ) then
                audio.play(balloonPop);
                removeBalloons(self);
            end 
        end
    end
end
end 
```

碰撞在很大程度上起作用，但有时圆形物体会落在可移动物体上并滚下一点，然后才被碰撞检测处理。

如何为碰撞提供更即时的效果？物体的属性是否需要不同以便碰撞有更多的“力”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T11:55:41.523

将“isSensor”设置为“true”在气球上，这样它会触发你的碰撞功能，而不会碰撞，滚动等......

:)

# matlab - 从matlab中的单元格数组中删除包含零的行

> ID：13071359
> 
> 赞同：4
> 
> 时间：2012-10-25T14:55:07.013
> 
> 标签：matlab, cells

我有一个由某个代码产生的单元格数组，如下所示：

```
m = 

    [         0]    'GO:0008150'
    'GO:0008150'    'GO:0016740'
    'GO:0016740'    'GO:0016787'
    'GO:0016787'    'GO:0006810'
    'GO:0008150'    'GO:0006412'
    'GO:0016740'    'GO:0004672'
    'GO:0016740'    'GO:0016779'
    'GO:0016787'    'GO:0004386'
    'GO:0016787'    'GO:0003774'
    'GO:0016787'    'GO:0016298'
    'GO:0006810'    'GO:0016192'
    'GO:0006412'    'GO:0005215'
    'GO:0004672'    'GO:0030533'
    [         0]    'GO:0008150'
    [         0]    'GO:0016740'
    'GO:0008150'    'GO:0016787'
    'GO:0008150'    'GO:0006810'
    'GO:0006810'    'GO:0006412'
    [         0]    'GO:0004672'
    [         0]    'GO:0016779'
    [         0]    'GO:0004386'
    'GO:0016192'    'GO:0003774'
    [         0]    'GO:0016298'
    [         0]    'GO:0016192'
    'GO:0006810'    'GO:0005215'
    'GO:0005215'    'GO:0030533' 
```

我需要删除包含零的行（例如：应该删除第一行，因为我们在第一列中有一个零）。那么如何从这个不包含零的数组创建一个数组呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T14:59:40.813

你可以在一个漂亮的单行中做到这一点：

```
m(any(cellfun(@(x)x(1)==0, m),2), :) = [] 
```

或者：

```
m(any(~cellfun(@ischar, m),2), :) = [] 
```

这有点快。

如果您可以确定只有第一列将包含零，请使用

```
m = m(cellfun(@ischar, m(:,1)),:) 
```

最后，您可以使用

```
m = m(cellfun('isclass', m(:,1), 'char'),:) 
```

看起来“旧”，但实际上具有更大的性能。

在您的示例数组上测试这些一千次，给出

```
Elapsed time is 1.382801 seconds.
Elapsed time is 0.138519 seconds.
Elapsed time is 0.075245 seconds.
Elapsed time is 0.014674 seconds. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:00:00.427

```
 zerosLocation = cellfun(@(x)isEqual(x, 0 ) , m);
  zeroRows = any(zerosLocation,2);
  m(zeroRows,:) = []; 
```

# java - 如何通过 API 查找 youtube 评论的赞成或反对票数

> ID：13071362
> 
> 赞同：2
> 
> 时间：2012-10-25T14:55:21.707
> 
> 标签：java, youtube, youtube-api

我正在使用 Youtube 的 Java API 获取视频的评论。我想知道我能找到所有评论的赞成票或反对票的数量。如果是，那么如何。目前我正在使用下面给出的代码。我正在为每条评论获得totalRating 以找到赞成票，但每次它输出0。我知道这是错误的，但我如何让评论上下投票。任何正确方向的指针将不胜感激。谢谢。

```
private void AddComments(YouTubeVideo ytv,VideoEntry videoEntry,YouTubeService service) 
{    
        try
       {
        //Get Comments                
       String commentUrl = videoEntry.getComments().getFeedLink().getHref();       

       LinkedList<YouTubeComment> commentsLinkedList = new LinkedList<YouTubeComment>();
       if(commentUrl!= null && commentUrl.length() > 0)
       {
                CommentFeed commentFeed = service.getFeed(new URL(commentUrl), CommentFeed.class);

                if(commentFeed != null)
                {

                    for(CommentEntry comment : commentFeed.getEntries()) 
                    {
                        YouTubeComment youtubeComment = new YouTubeComment();

                        if(comment.getTotalRating()!=null)
                        **//comment.getTotalRating() is always equal to 0.**
                        youtubeComment.setLike(comment.getTotalRating());
                        else
                            youtubeComment.setLike(0);

                        youtubeComment.setSpamStatus(comment.hasSpamHint());
                        String commentinVideo = comment.getPlainTextContent();
                        if(commentinVideo != null)
                            youtubeComment.setComment(comment.getPlainTextContent());
                        else
                            youtubeComment.setComment(" ");

                        commentsLinkedList.add(youtubeComment);
                    }
                    ytv.setComments(commentsLinkedList);
                }
                else
                    ytv.setComments(commentsLinkedList);              
        }
       else
        {
                ytv.setComments(commentsLinkedList);   
        }

        }            
        catch(Exception ex)
        {   // This means that "Comments are disabled for this video."
            LinkedList<YouTubeComment> comments = new LinkedList<YouTubeComment>();
            ytv.setComments(comments);

            System.out.println("Could not add comments for video := " + videoUrl);
             System.out.println("This happens when comments are disabled for the video");
            System.out.println("Exception in function AddComments  : " + ex.toString());
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T21:28:50.343

不幸的是，这些值没有通过 API 公开，也没有添加它们的计划。

# c++ - 为什么我们在这里需要一个“朋友”？(C++)

> ID：13071366
> 
> 赞同：2
> 
> 时间：2012-10-25T14:55:33.407
> 
> 标签：c++, qt, qml, qt-quick, friend-class

qml 查看器（适用于 4.8 和 5.0）是这样实现的：

在 .h(eader) 我们有：

```
class QtQuick2ApplicationViewer : public QQuickView
{
    Q_OBJECT

...

private:
    class QtQuick2ApplicationViewerPrivate *d;
}; 
```

然后在 .CPP 文件中：

```
class QtQuick2ApplicationViewerPrivate
{
    QString mainQmlFile;
    friend class QtQuick2ApplicationViewer;
    static QString adjustPath(const QString &path);
};

QtQuick2ApplicationViewer::QtQuick2ApplicationViewer(QWindow *parent)
    : QQuickView(parent)
    , d(new QtQuick2ApplicationViewerPrivate())
{
    connect(engine(), SIGNAL(quit()), SLOT(close()));
    setResizeMode(QQuickView::SizeRootObjectToView);

#ifdef Q_OS_ANDROID
    engine()->setBaseUrl(QUrl::fromLocalFile("/"));
#endif
} 
```

为什么`friend`在这里使用是必要的？我看不出任何人为什么要使用`friend`课程。朋友课程有什么真正用途吗（除了任何人都可以没有的外来生物）？

**.h** #包括

```
class QtQuick2ApplicationViewer : public QQuickView
{
    Q_OBJECT

public:
    explicit QtQuick2ApplicationViewer(QWindow *parent = 0);
    virtual ~QtQuick2ApplicationViewer();

    void setMainQmlFile(const QString &file);
    void addImportPath(const QString &path);

    void showExpanded();

private:
    class QtQuick2ApplicationViewerPrivate *d;
}; 
```

**.cpp**

```
#include "qtquick2applicationviewer.h"

#include <QtCore/QCoreApplication>
#include <QtCore/QDir>
#include <QtQml/QQmlEngine>

class QtQuick2ApplicationViewerPrivate
{
    QString mainQmlFile;
    friend class QtQuick2ApplicationViewer;
    static QString adjustPath(const QString &path);
};

QString QtQuick2ApplicationViewerPrivate::adjustPath(const QString &path)
{
#ifdef Q_OS_UNIX
#ifdef Q_OS_MAC
    if (!QDir::isAbsolutePath(path))
        return QString::fromLatin1("%1/../Resources/%2")
                .arg(QCoreApplication::applicationDirPath(), path);
#elif !defined(Q_OS_ANDROID)
    const QString pathInInstallDir =
            QString::fromLatin1("%1/../%2").arg(QCoreApplication::applicationDirPath(), path);
    if (QFileInfo(pathInInstallDir).exists())
        return pathInInstallDir;
#endif
#endif
    return path;
}

QtQuick2ApplicationViewer::QtQuick2ApplicationViewer(QWindow *parent)
    : QQuickView(parent)
    , d(new QtQuick2ApplicationViewerPrivate())
{
    connect(engine(), SIGNAL(quit()), SLOT(close()));
    setResizeMode(QQuickView::SizeRootObjectToView);

#ifdef Q_OS_ANDROID
    engine()->setBaseUrl(QUrl::fromLocalFile("/"));
#endif
}

QtQuick2ApplicationViewer::~QtQuick2ApplicationViewer()
{
    delete d;
}

void QtQuick2ApplicationViewer::setMainQmlFile(const QString &file)
{
    d->mainQmlFile = QtQuick2ApplicationViewerPrivate::adjustPath(file);
    setSource(QUrl::fromLocalFile(d->mainQmlFile));
}

void QtQuick2ApplicationViewer::addImportPath(const QString &path)
{
    engine()->addImportPath(QtQuick2ApplicationViewerPrivate::adjustPath(path));
}

void QtQuick2ApplicationViewer::showExpanded()
{
#if defined(Q_WS_SIMULATOR)
    showFullScreen();
#else
    show();
#endif
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T14:58:50.503

朋友检查朋友的私处。您当然可以完全不受访问限制，但是一旦您使用它，在亲密的情况下保持友好会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:28:57.373

```
class Me;
class You {
    friend class Me;
private:
    Home _home;
    Car _car;
public:
    void bar(Me my);
};

class Me {
    Stuff _stuff;
public:
    foo(You you) {
       //If you consider me a friend
       you._home.enter(); //I can enter your `private _home`
       you._car.drive();  //I can drive your `private _car`.
    }
};

void You::bar(Me my) {
     my.stuff //this is an error because I don't consider you a friend so you can't touch my `private _stuff`.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T15:14:24.537

知道你总是可以依靠我，当然。这就是朋友的作用。[http://www.youtube.com/watch?v=xGbnua2kSa8](http://www.youtube.com/watch?v=xGbnua2kSa8)

但我猜你是在询问 C++ 中的朋友类。

“范围”的全部意义在于准确定义谁可以在另一个类中看到什么。您不再需要“朋友”，就像您需要“受保护”或“私人”一样，您可以将所有类中的所有内容公开，并且您的程序将成功编译和运行。但是这个想法是要建立——并记录——一个类的公共接口到底是什么，因此如果不考虑对其他类的影响就不能改变，什么是内部实现，可以自由地重新工作或重新组织，而不必担心影响其他班级。

所以“朋友”的意思是说：嘿，我有这个班级 X，还有另一个班级 Y。一般来说，其他班级不需要知道 X 是如何完成它的工作的。但是 Y 与 X 中的一些低级事物交互，所以它需要看到它。因此，我让 Y 成为 X 的朋友。就像，我有一个 Investor 类，它有一个函数（可能除其他外）有一个函数来计算客户的投资总额。一般来说，其他班级不应该关心我如何计算：他们只想要总数。但是现在我有一个 TaxReporting 类，它需要知道有多少余额是在应税证券中，有多少是在非应税证券中。也许我不想公开这些功能，因为这些信息是机密的，并且出于现实世界的隐私原因，我想限制访问。更多时候，我不想公开它，因为计算很棘手或经常更改，我想严格控制访问它的类以限制当事情发生变化时引起的问题。所以我让 TaxReporting 成为朋友，这样它就可以访问一些与众不同的功能，而无需向世界开放这些功能。

实际上，当我在做 C++ 时，我很少使用朋友。但“很少”不是“从不”。如果你发现自己说，“哦，我必须公开它，这样其他班级才能看到它”，那么也许你应该交一个朋友而不是公开它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:14:35.830

“朋友”非常有用，是您一直想使用的东西。

典型的用例是：

您有一个使用子类的类，其中允许子类使用拥有子类的类的私有函数：

```
class ManagedObject
{
public:
   void doStuff() { mMgr->updateManager(); }

private:
   Manager* mMgr;
};

class Manager
{
   friend ManagedObject;
public:
   ManagedObject* createManagedObject();

private:
   void updateManager() { }
}; 
```

因此，在这种情况下，您有一个创建和处理“managedObject”的类。每当操作此对象时，它都需要更新创建它的对象。您希望您的类的用户知道他们不需要调用“updateManager”，事实上，如果他们这样做，就会生成编译时错误。

另一个常见的情况是当你有一个函数，它像一个类成员，但由于某种原因不能成为一个类成员。一个例子是运算符<<。如果您编写自己的 io 流类，或者如果您想创建用户 operator<< 的序列化系统：

```
class serializedObject
{
public:
   friend Serializer& operator<< ( Serializer& s, const serializedObject& obj );
protected:
   u32 mSecretMember;
};

Serializer& operator<<( Serializer& s, serializedObject& obj )
{
    serializer << obj.mSecretMember;
    return s; 
} 
```

在这种情况下，序列化函数不能是serializedObject的成员，而是需要查看serializedObject的内部来对其进行序列化。您将看到创建其他运算符（如加法）的类似模式，其中运算符的 RHS 与 LHS 的类不同

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-05T00:33:44.137

在 Qt 中，有一种称为“二进制兼容性保证”的东西，这意味着您的应用程序可以在 Qt4.8、4.8.1 和 4.8.2 等环境下运行而无需重新编译。

为了实现这一点，对象的 vtable 不能更改。因此，Qt 类是使用“PIMPL”（指向实现的指针）习语编写的。

“Private”类是公共类的 PRIVATE 实现——它是 QtQuick2ApplicationViewer 的实现细节。全世界除了公开课外，没有人知道私人课。这两个类在设计上深深地交织在一起。事实上，它们实际上是单个对象的不同方面，为了实现二进制兼容性保证，已经按照 c++ 进行了分区。

在这种情况下，私有类可以访问公共类是合理的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-25T15:07:42.113

2) 在这种情况下`quit`，不是`QApplication::quit()`，那是`slot`原因，而是 的一些内部信号`engine()`。

# php - PHP 清理输入

> ID：13071369
> 
> 赞同：1
> 
> 时间：2012-10-25T14:55:42.397
> 
> 标签：php, mongodb, sanitize

我知道这个话题已经被广泛讨论，因为我已经阅读并阅读了超过 15 篇关于该主题的帖子，但仍然找不到我的问题的答案。

我正在寻找一种功能来清理表单中的数据。由于绝对没有 HTML 是可以接受的，我该如何转义所有 html 实体，以便用户绝对不能注入任何东西？我不需要白名单，因为不允许输入 HTML。

此外，不需要运行 mysql_real_escape_string，因为我不使用 MySQL 数据库。我使用 MongoDB。我只是存储名字，姓氏，电话号码，基本的东西。没有 HTML。但是我仍然不希望用户能够输入`<script>whatever</script>`他们的名字，当它显示给他们时，它会解析它。

我想到了[HTML Purifier](http://htmlpurifier.org/)和[htmLAWED](http://www.bioinformatics.org/phplabware/internal_utilities/htmLawed/)，但它们似乎对我想做的事情来说太多了。我只是构建一个花哨的 preg_replace 函数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:32:18.217

没有通用的“使其安全”过滤器。字符串仅在放入特定*上下文*时才危险。

例如，如果上下文是一个纯文本文档，你真的不用担心。

如果上下文是文本节点（不在尖括号内），则[htmlspecialchars就足够了。](http://www.php.net/htmlspecialchars)指定正确的字符集/编码，即服务器发送的 http 标头中的字符集/编码。

行

```
 <p><?= htmlspecialchars($input, ENT_QUOTES, 'UTF-8'); ?></p> 
```

但是，如果您需要在尖括号内输出，则使上下文类似于 html 属性，例如：

```
<p <?= htmlspecialchars($input, ENT_QUOTES, 'UTF-8'); ?>   ></p>
or
<p title="<?= htmlspecialchars($input, ENT_QUOTES, 'UTF-8'); ?>"   ></p> 
```

在许多情况下，“使其安全”的任务变得极其困难（旧版浏览器有一些绝对令人困惑的错误，这些错误违背了软件开发人员的普遍期望）。如果您不站在巨人的肩膀上并使用 htmlpurifier 之类的东西，那您将是愚蠢的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T14:58:13.857

我不是这类事情的专家，但你不能[str_replace](http://php.net/manual/en/function.str-replace.php)尖括号吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:01:35.710

我会说使用 preg_replace 但你需要小心可能出现在一个人的名字中的重音和其他不常见的字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:06:01.897

定义清理：您要转义尖括号还是要删除 HTML 标记？

逃走看看

```
htmlentities() 
```

删除看看

```
strip_tags() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T15:07:22.880

我喜欢使用的一种只是格式化所有 HTML 特殊字符的方式，以便将它们从 HTML 页面的流程中删除：

```
htmlspecialchars($string); 
```

它从来没有让我失望过，解决了必须使用复杂而缓慢的替换功能等问题，这也意味着用户可以`>`在他们的用户名或评论等中使用而不被删除（即互联网上非常有效的用户名是`>3`）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-25T15:09:31.583

看看 PHP 的数据过滤怎么样，[http ://php.net/manual/en/book.filter.php](http://php.net/manual/en/book.filter.php)

Sanatize：[http ://php.net/manual/en/filter.filters.sanitize.php](http://php.net/manual/en/filter.filters.sanitize.php)

如果您真的想要一个可靠且安全的库，请查看 OWASP 的 ESAPI for PHP

> 不要编写自己的安全控制！在为每个 Web 应用程序或 Web 服务开发安全控制时重新发明轮子会导致时间浪费和大量安全漏洞。OWASP 企业安全 API (ESAPI) 工具包可帮助软件开发人员防范与安全相关的设计和实施缺陷。

*   [http://code.google.com/p/owasp-esapi-php/](http://code.google.com/p/owasp-esapi-php/)
*   [https://www.owasp.org/index.php/OWASP_PHP_Filters](https://www.owasp.org/index.php/OWASP_PHP_Filters)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-25T15:15:13.217

使用 php 5.3 的 filter_input [http://php.net/manual/en/function.filter-input.php](http://php.net/manual/en/function.filter-input.php)

$string = filter_input(INPUT_POST, 'string', FILTER_SANITIZE_SPECIAL_CHARS);

这很像 $_POST['string'] 但内置了清洁器。

# php - 内存泄漏故障排除

> ID：13071371
> 
> 赞同：1
> 
> 时间：2012-10-25T14:55:45.293
> 
> 标签：php, mamp

我在 php.ini 中将我的 PHP MAMP 服务器设置为最大“256M”，但突然出现内存错误。这有两点很奇怪：

1.  对于脚本来说，这是一个惊人的高内存量。也许我太容易震惊了，但脚本应该运行超过 256M 吗？我不会这么想的。
2.  即使我现在将设置更改为“512M”，我仍然会收到内存错误，并且它仍然报告在 256M 范围内/附近耗尽（好像我的设置被忽略了）。我确实回收了我认为足以让新设置发挥作用的网络服务器。

我得到的确切信息是这样的：

```
[25-Oct-2012 14:27:53] PHP Fatal error:  Allowed memory size of 268435456 bytes exhausted (tried to allocate 222300161 bytes) in [FILE_PATH]/wp-content/themes/lifegadget-pagelines/sections/lg_content/section.php on line 42
[25-Oct-2012 14:27:53] PHP Fatal error:  Call to a member function get() on a non-object in [FILE_PATH]/wp-content/object-cache.php on line 52 
```

所以我的问题如下：

1.  **故障排除**。有没有办法解决内存使用问题？
2.  **规模**。超过 256M 限制是一个明显的问题，还是在某些情况下这是合理的？
3.  **新天花板**。为什么我的 512M 的新上限被忽略了？并不是说我很高兴让它保持在 512M，但我认为它至少可以让我恢复运行（我的机器上有 16GB，所以有足够的物理内存）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T12:53:30.590

无限循环可能会导致这种情况，或者如果您在 PHP 5.3 之前的版本中有循环引用。请参阅：[垃圾收集](http://php.net/manual/en/features.gc.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T22:44:59.047

在您怀疑内存泄漏的类/页面的最开始注入此函数`ini_set('memory_limit', -1);`，这是使事情正常工作的临时解决方案，但它不会帮助您知道您的脚本究竟在哪里泄漏内存。

# objective-c - self.TableView 不适用于 ViewController 内的 TableViewController？

> ID：13071379
> 
> 赞同：0
> 
> 时间：2012-10-25T14:56:19.223
> 
> 标签：objective-c, ios, xcode, uitableview

我正在制作一个里面有 2 个表视图的 ViewController。我将其构建为 ViewController -> 2 x TableViewController 类。我不明白的是，如果我在 TableViewControllers 中执行 [self.tableView reloadData] ，它不会做任何事情。

如果我在 ViewController 中执行 [tableViewA reloadData]，它将执行 TableViewController 中的数据源方法。

如何在 TableViewControllers 中调用 reloadData？

谢谢，艾伦

编辑 - 这就是我设置 ViewController 的方式

```
if(self.reviewController == nil)
{
    self.reviewController = [[ReviewerTableViewController alloc] init];
}
if(self.approverController == nil)
{
    self.approverController = [[ApproverTableViewController alloc] init];
}
[self.reviewerTableView setDataSource:reviewController];
[self.approversTableView setDataSource:approverController];

[self.reviewerTableView setDelegate:reviewController];
[self.approversTableView setDelegate:approverController];

self.reviewController.view = self.reviewController.tableView;
self.approverController.view = self.approverController.tableView; 
```

似乎数据源方法在我初始化它们时运行一次，但 reloadData 在内部不起作用。

我基本上只是使用 UITableViewControllers 中的数据源方法，我正在调用一种方法从网络中提取数据。获取数据后，我调用 reloadData，但不执行数据源方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:11:56.083

确保 TableViewControllers 的 tableView 属性连接到正确的表视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:52:13.717

你是从 rootViewController 调用 reloadData 吗？如果是这样，你打电话

```
[self.reviewerTableView reloadData]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:10:28.880

我将创建一个实现 UITableViewDataSource 和 UITableViewDelegate 协议的 UIVIewController。创建两个插座，每个表视图一个，并确保在界面构建器中将它们连接起来。

然后调用 [tableView1 reloadData];

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T16:16:21.217

这看起来很奇怪：您试图将子 UITableViewControllers 的 dataSource 和委托设置为在您的主视图控制器中声明的（可能）一些本地 UITableViews。它不应该像这样工作 - 子 UITableViewControllers 已经是数据源并委托给他们自己的隐式表视图。无需将它们连接到单独的 UITableView。

编辑：我假设您的“TableViewController”类是 UITableViewControllers。如果不是，那么您所做的可能是有效的，但我需要查看所有代码，包括标题。

# ruby - 如何使用 Mongoid 删除特定数据库？

> ID：13071380
> 
> 赞同：1
> 
> 时间：2012-10-25T14:56:18.370
> 
> 标签：ruby, ruby-on-rails-3, mongodb, mongoid, mongoid3

`Mongoid.default_session.database_names`给我一个数据库名称数组。我想删除一个特定的数据库。我该怎么做？

`Mongoid.default_session.drop()`即使我使用覆盖当前数据库，似乎总是删除默认数据库`Mongoid.override_database("test_database")`

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-21T06:31:03.200

在 Mongoid v2.0.2

```
Mongoid.purge! 
```

[Rdoc：Mongoid.purge！](http://rdoc.info/github/mongoid/mongoid/master/Mongoid/Config%3apurge!)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:55:38.493

您是否尝试过`Session.use`和的组合`Session.drop`？

示例： http: [//mongoid.org/en/moped/docs/driver.html](http://mongoid.org/en/moped/docs/driver.html)

# c# - 如何以编程方式即时更改网站默认文档

> ID：13071382
> 
> 赞同：1
> 
> 时间：2012-10-25T14:56:23.187
> 
> 标签：c#, asp.net, .net

使用 ASP.NET 4.0、IIS 7.5。

我有一个网站引擎，我刚刚实现了一种方法来判断它是否正在加载到移动设备上，而不是加载`Controls\MyControl.ascx`它`Mobile\Controls\MyControl.ascx`。这适用于我的控件和我的`MasterPage.Master`文件。

然而，我想不通的是如何使用 Default.aspx 做同样的事情。这需要以编程方式即时完成，因为我需要能够检查它是否是移动版本。我正在考虑在全局变量的预初始化事件上做点什么，但不确定这是否是最好的方法。

注意：我不想在 Default.aspx 上使用内联代码，而只是根据我的`Mobile`标志显示不同的内容，因为我的场景更进一步，也将文件基于客户，这意味着有一个巨大的 Default.aspx 用于所有无法管理的客户。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:13:23.223

**在任何实际**意义上，动态更改默认文档是不可能的。

即时写入 web.config 以加载默认页面的移动版本，坦率地说，这很糟糕，并且不能回答**您问题的真实背景**。如果我什至建议将此作为加载默认页面的移动版本的答案，作为开发人员，我会感到不负责任。

我试图帮助您解决问题，而不仅仅是回答标题中的基本问题。众所周知，更改 web.config 将重新启动您的应用程序，并且不会作为真正的解决方案，因为您无法这样做并获得任何类型的性能。

这是处理移动浏览器的最佳替代方案（恕我直言）。 [http://51degrees.codeplex.com/](http://51degrees.codeplex.com/)

！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T08:36:08.653

对于其他看到这个的人，我已经找到了一个解决方案，但我不确定我是否会实施它，因为我不喜欢在运行时更新 web.config 文件的想法。使用命名空间，您可以以编程`Microsoft.Web.Administration`方式更新该部分。`server.webServer -> defaultDocument`这样做允许您更改 default.aspx 的路径，它将根据您设置的变量加载。

此链接应提供更多信息：http: [//blogs.msdn.com/b/saurabh_singh/archive/2007/11/24/accessing-iis-7-0-features-programmatically-from-configuration-file-sc.aspx](http://blogs.msdn.com/b/saurabh_singh/archive/2007/11/24/accessing-iis-7-0-features-programmatically-from-configuration-file-s-c.aspx)

此外，该`Microsoft.Web.Administration`dll 不能直接在 VS 中使用，因此您需要从`%windir%\syswow64\inetsrv`（64 位版本）添加它。

# python - 将日期时间限制为下一刻钟

> ID：13071384
> 
> 赞同：21
> 
> 时间：2012-10-25T14:56:25.607
> 
> 标签：python, datetime, ceil

让我们想象一下`datetime`

```
>>> import datetime
>>> dt = datetime.datetime(2012, 10, 25, 17, 32, 16) 
```

我想把它限制到下一刻钟，为了得到

```
datetime.datetime(2012, 10, 25, 17, 45) 
```

我想像

```
>>> quarter = datetime.timedelta(minutes=15)
>>> import math
>>> ceiled_dt = math.ceil(dt / quarter) * quarter 
```

但是，当然，这是行不通的

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-25T15:07:46.197

这需要微秒！

```
import math

def ceil_dt(dt):
    # how many secs have passed this hour
    nsecs = dt.minute*60 + dt.second + dt.microsecond*1e-6  
    # number of seconds to next quarter hour mark
    # Non-analytic (brute force is fun) way:  
    #   delta = next(x for x in xrange(0,3601,900) if x>=nsecs) - nsecs
    # analytic way:
    delta = math.ceil(nsecs / 900) * 900 - nsecs
    #time + number of seconds to quarter hour mark.
    return dt + datetime.timedelta(seconds=delta)

t1 = datetime.datetime(2017, 3, 6, 7, 0)
assert ceil_dt(t1) == t1

t2 = datetime.datetime(2017, 3, 6, 7, 1)
assert ceil_dt(t2) == datetime.datetime(2017, 3, 6, 7, 15)

t3 = datetime.datetime(2017, 3, 6, 7, 15)
assert ceil_dt(t3) == t3

t4 = datetime.datetime(2017, 3, 6, 7, 16)
assert ceil_dt(t4) == datetime.datetime(2017, 3, 6, 7, 30)

t5 = datetime.datetime(2017, 3, 6, 7, 30)
assert ceil_dt(t5) == t5

t6 = datetime.datetime(2017, 3, 6, 7, 31)
assert ceil_dt(t6) == datetime.datetime(2017, 3, 6, 7, 45)

t7 = datetime.datetime(2017, 3, 6, 7, 45)
assert ceil_dt(t7) == t7

t8 = datetime.datetime(2017, 3, 6, 7, 46)
assert ceil_dt(t8) == datetime.datetime(2017, 3, 6, 8, 0) 
```

解释`delta`：

*   900 秒是 15 分钟（一刻钟*没有闰秒，我认为 datetime 无法处理......*）
*   `nsecs / 900`是已经发生的一刻钟块的数量。取`ceil`这个四舍五入的四分之一小时块的数量。
*   将四分之一小时的块数乘以 900 以计算出“舍入”后从一小时开始以来已经发生了多少秒。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-09-18T17:05:16.063

[@Mark Dickinson 提出](https://stackoverflow.com/questions/13071384/python-ceil-a-datetime-to-next-quarter-of-an-hour/32657466#comment53190737_32657466)了迄今为止最好的公式：

```
def ceil_dt(dt, delta):
    return dt + (datetime.min - dt) % delta 
```

* * *

在 Python 3 中，对于任意时间增量（不仅仅是 15 分钟）：

```
#!/usr/bin/env python3
import math
from datetime import datetime, timedelta

def ceil_dt(dt, delta):
    return datetime.min + math.ceil((dt - datetime.min) / delta) * delta

print(ceil_dt(datetime(2012, 10, 25, 17, 32, 16), timedelta(minutes=15)))
# -> 2012-10-25 17:45:00 
```

为了避免中间浮动，`divmod()`可以使用：

```
def ceil_dt(dt, delta):
    q, r = divmod(dt - datetime.min, delta)
    return (datetime.min + (q + 1)*delta) if r else dt 
```

例子：

```
>>> ceil_dt(datetime(2012, 10, 25, 17, 32, 16), timedelta(minutes=15))
datetime.datetime(2012, 10, 25, 17, 45)
>>> ceil_dt(datetime.min, datetime.resolution) 
datetime.datetime(1, 1, 1, 0, 0)
>>> ceil_dt(datetime.min, 2*datetime.resolution)
datetime.datetime(1, 1, 1, 0, 0)
>>> ceil_dt(datetime.max, datetime.resolution)
datetime.datetime(9999, 12, 31, 23, 59, 59, 999999)
>>> ceil_dt(datetime.max, 2*datetime.resolution)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 3, in ceil_dt
OverflowError: date value out of range
>>> ceil_dt(datetime.min+datetime.resolution, datetime.resolution)
datetime.datetime(1, 1, 1, 0, 0, 0, 1)
>>> ceil_dt(datetime.min+datetime.resolution, 2*datetime.resolution)
datetime.datetime(1, 1, 1, 0, 0, 0, 2)
>>> ceil_dt(datetime.max-datetime.resolution, datetime.resolution)
datetime.datetime(9999, 12, 31, 23, 59, 59, 999998)
>>> ceil_dt(datetime.max-datetime.resolution, 2*datetime.resolution)
datetime.datetime(9999, 12, 31, 23, 59, 59, 999998)
>>> ceil_dt(datetime.max-2*datetime.resolution, datetime.resolution)
datetime.datetime(9999, 12, 31, 23, 59, 59, 999997)
>>> ceil_dt(datetime.max-2*datetime.resolution, 2*datetime.resolution)
datetime.datetime(9999, 12, 31, 23, 59, 59, 999998)
>>> ceil_dt(datetime.max-timedelta(1), datetime.resolution)
datetime.datetime(9999, 12, 30, 23, 59, 59, 999999)
>>> ceil_dt(datetime.max-timedelta(1), 2*datetime.resolution)
datetime.datetime(9999, 12, 31, 0, 0)
>>> ceil_dt(datetime.min, datetime.max-datetime.min)
datetime.datetime(1, 1, 1, 0, 0)
>>> ceil_dt(datetime.max, datetime.max-datetime.min)
datetime.datetime(9999, 12, 31, 23, 59, 59, 999999) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-25T15:05:24.300

```
def ceil(dt):
    if dt.minute % 15 or dt.second:
        return dt + datetime.timedelta(minutes = 15 - dt.minute % 15,
                                       seconds = -(dt.second % 60))
    else:
        return dt 
```

这给了你：

```
>>> ceil(datetime.datetime(2012,10,25, 17,45))
datetime.datetime(2012, 10, 25, 17, 45)
>>> ceil(datetime.datetime(2012,10,25, 17,45,1))
datetime.datetime(2012, 10, 25, 18, 0)
>>> ceil(datetime.datetime(2012,12,31,23,59,0))
datetime.datetime(2013,1,1,0,0) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-25T15:06:09.113

您只需要在将分钟、秒设置为零后计算正确的分钟并将它们添加到 datetime 对象中

```
import datetime

def quarter_datetime(dt):
    minute = (dt.minute//15+1)*15
    return dt.replace(minute=0, second=0)+datetime.timedelta(minutes=minute)

for minute in [12, 22, 35, 52]:
    print quarter_datetime(datetime.datetime(2012, 10, 25, 17, minute, 16)) 
```

它适用于所有情况：

```
2012-10-25 17:15:00
2012-10-25 17:30:00
2012-10-25 17:45:00
2012-10-25 18:00:00 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-18T19:45:48.617

[@Mark Dickinson 在这里提出](https://stackoverflow.com/a/32657466)的公式效果很好，但我需要一个同时处理时区和夏令时 (DST) 的解决方案。

使用`pytz`，我到达：

```
import pytz
from datetime import datetime, timedelta

def datetime_ceiling(dt, delta):
    # Preserve original timezone info
    original_tz = dt.tzinfo
    if original_tz:
        # If the original was timezone aware, translate to UTC.
        # This is necessary because datetime math does not take
        # DST into account, so first we normalize the datetime...
        dt = dt.astimezone(pytz.UTC)
        # ... and then make it timezone naive
        dt = dt.replace(tzinfo=None)
    # We only do math on a timezone naive object, which allows
    # us to pass naive objects directly to the function
    dt = dt + ((datetime.min - dt) % delta)
    if original_tz:
        # If the original was tz aware, we make the result aware...
        dt = pytz.UTC.localize(dt)
        # ... then translate it from UTC back its original tz.
        # This translation applies appropriate DST status.
        dt = dt.astimezone(original_tz)
    return dt 
```

`floor`通过更改一行代码可以实现几乎相同的功能：

```
def datetime_floor(dt, delta):
    ...
    dt = dt - ((datetime.min - dt) % delta)
    ... 
```

以下日期时间是从 DST 转换回标准时间 (STD) 之前的三分钟：

```
datetime.datetime(2020, 11, 1, 1, 57, tzinfo=<DstTzInfo 'US/Eastern' EDT-1 day, 20:00:00 DST>) 
```

假设以上为`dt`，我们可以使用我们的 floor 函数向下舍入到最接近的五分钟增量：

```
>>> datetime_floor(dt, timedelta(minutes=5))
datetime.datetime(2020, 11, 1, 1, 55, tzinfo=<DstTzInfo 'US/Eastern' EDT-1 day, 20:00:00 DST>) 
```

时区和与 DST 的关系被保留。（天花板函数也是如此。）

在此日期，DST 将在凌晨 2 点结束，此时时间将“回滚”到 STD 凌晨 1 点。如果我们使用上限函数从夏令时凌晨 1:57 开始向上取整，我们不应该*在*夏令时凌晨 2 点结束，而是在夏令时凌晨 1:00 结束，这是我们得到的结果：

```
>>> datetime_ceiling(dt, timedelta(minutes=5))
datetime.datetime(2020, 11, 1, 1, 0, tzinfo=<DstTzInfo 'US/Eastern' EST-1 day, 19:00:00 STD>) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-25T11:33:14.347

这是我使用任何句点的代码：

```
def floorDT(dt, secperiod):
    tstmp = dt.timestamp()
    return datetime.datetime.fromtimestamp(
        math.floor(tstmp/secperiod)*secperiod).astimezone().astimezone(datetime.timezone.utc)

def ceilDT(dt, secperiod):
    tstmp = dt.timestamp()
    return datetime.datetime.fromtimestamp(
        math.ceil(tstmp/secperiod)*secperiod).astimezone().astimezone(datetime.timezone.utc) 
```

注意：我们必须使用 astimezone().astimezone() 技巧，否则它在从时间戳转换期间使用本地时区

# c# - 请求.GetResponse(); 即使提供了正确的凭据，也返回 407（需要代理身份验证）

> ID：13071389
> 
> 赞同：0
> 
> 时间：2012-10-25T14:56:38.760
> 
> 标签：c#, .net, proxy

我正在开发一个发送 http 请求的应用程序（在 C# 中）。只要没有涉及身份验证的代理，一切都可以正常工作。

这是我的代码：

```
request = (HttpWebRequest) WebRequest.Create(uri);
request.Method = "POST";
request.ContentType = "application/x-www-form-urlencoded";
request.ContentLength = length;
request.Proxy.Credentials = new NetworkCredential("hans", "maulwurf"); 
request.Credentials = new NetworkCredential("hans", "maulwurf");

using (var requestStream = request.GetRequestStream())
        {
            // now send it
            requestStream.Write(postBytes, 0, postBytes.Length);
            requestStream.Flush();
            requestStream.Close();
        }
WebResponse webResponse = request.GetResponse(); 
```

在最后一行我总是得到 407。凭证在 ie/ff 中工作。

有没有人建议问题可能是什么？任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:00:56.400

我认为您可能还需要指定代理服务器。像这样，例如，

```
IWebProxy proxy = new WebProxy("<Server IP>", <Server Port>);
proxy.Credentials = new NetworkCredential("hans", "maulwurf"); 
request.Proxy = proxy; 
```

# r - 向堆叠条形图添加统计信息后如何删除额外的图例？

> ID：13071390
> 
> 赞同：0
> 
> 时间：2012-10-25T14:56:41.787
> 
> 标签：r, ggplot2

我想用轴中变量的绝对值创建堆积条形图，但在每个条形上添加百分比。这是我的数据的样子：

```
BAM  Mapping    Reads   fraction
bam1   Mapped 22493091 0.88940452
bam1 Unmapped  2796966 0.11059548
bam2   Mapped 27018375 0.88256156
bam3 Unmapped  3595212 0.11743844
bam3   Mapped 27238774 0.89441821
bam4 Unmapped  3215407 0.10558179
bam4   Mapped 19791746 0.82984107
bam4 Unmapped  4058298 0.17015893
bam5   Mapped 23298155 0.83144569
bam5 Unmapped  4723104 0.16855431
bam6   Mapped 22563538 0.83990722
bam6 Unmapped  4300784 0.16009278
bam7   Mapped 23940480 0.88134856
bam7 Unmapped  3222984 0.11865144 
```

我快到了（别管 x-labels - 我在这里使用长名称）：

```
gp <- ggplot(data=to_graph, aes(x=BAM, y=Reads, fill=Mapping, label=paste(round(fraction*100),"%", sep=""), size = 3,vjust=0, position = "stack")) +
     geom_bar(stat="identity") + 
    geom_text(position="stack") 
```

![在此处输入图像描述](../Images/7733ae5c6042c53616da14cd56be641b.png)

但是在我想摆脱的传说之上还有一个小问题。重要的是如何做到这一点，为什么它会出现在第一位？

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:08:13.330

那个虚假的传说出现是因为你在里面放了所有`aes`不需要的东西。试试这个：

```
ggplot(data=to_graph, aes(x=BAM, y=Reads, fill=Mapping)) +
     geom_bar(stat="identity",position = "stack") + 
    geom_text(aes(label=paste(round(fraction*100),"%", sep="")),size = 3,vjust=0,position="stack") 
```

`aes`通常，当您将美学映射到数据中的变量时，事情就会进入内部。如果您只是*设置*它（即`size = 3`）超出`aes`. 您放入其中的任何内容`aes`通常都会导致 ggplot 尝试为该美学创建传奇。

我想我从来没有见过`position`内部映射`aes`。

# sql - 分隔文本并将其传递给 SQL

> ID：13071393
> 
> 赞同：-3
> 
> 时间：2012-10-25T14:56:46.353
> 
> 标签：sql, shell

我正在使用最新的 Debian 版本。

我有这个文件：

```
2301,XT_ARTICLES
2101,XT_HOUSE_PHOTOS
301,XT_PDF
101611,XT_FIJOS 
```

我想分隔此文本，以便将 ID 和名称添加到一个 SQL 中。SQL必须根据文件的行数重复，但我不知道该怎么做。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:00:50.907

这符合您的需求吗？

```
awk -F',' '{print "INSERT INTO foobar VALUES("$1,",\047"$2"\047);"}' file.txt
INSERT INTO foobar VALUES(2301, 'XT_ARTICLES');
INSERT INTO foobar VALUES(2101, 'XT_HOUSE_PHOTOS');
INSERT INTO foobar VALUES(301, 'XT_PDF');
INSERT INTO foobar VALUES(101611, 'XT_FIJOS'); 
```

如果没问题，只需在 MySQL 中进行管道传输：

```
awk -F',' '
BEGIN{
    print "USE qux;"
}
{
    print "INSERT INTO foobar VALUES("$1,",\047"$2"\047);"
}' file.txt | mysql 
```

# wcf - WCF 客户端生成的 XML 缺少某些元素

> ID：13071399
> 
> 赞同：1
> 
> 时间：2012-10-25T14:56:54.047
> 
> 标签：wcf, soap, xml-serialization, jax-ws

我正在编写一个 WCF 客户端来与 JAX-WS Web 服务进行通信。基本上与服务的通信是有效的。但是在调查 WCF 客户端生成的 XML 时，缺少一些元素。所有属性均已正确生成，并且我已在代码中进行了设置。我一般是 WCF 和 Web 服务的新手，所以我很难分析这里可能出现的问题。什么可能导致 XML 中缺少元素？我注意到所有这些缺失属性的唯一共同点是它们都是枚举类型。但除此之外，我什么也没发现。例如，有一个国家代码的枚举。一个实体具有该枚举类型的 3 个属性。在 XML 中仅生成 3 个相关元素中的一个。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-08-13T12:48:28.220

正如 OP 所发现的，当 WCF 客户端（包括`XSD.exe`实用程序生成的代理类）从 WSDL 或 XSD 导入枚举器时，代理也具有相应的`bool`属性。对于名为“Foobar”的枚举元素，还必须设置“FoobarSpecified”，`true`否则 WCF 将不会序列化数据元素。

在提出问题 6 年后仍然如此，即使在 .NET Core 和 Visual Studio 2017 中使用新的 WCF 客户端，也不是特别明显，所以我想我会宣传 OP 对 wiki 答案的评论响应.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:14:40.963

这很可能发生，因为 WCF 合同对枚举的处理方式不同。对于数据协定，您用属性标记类，用`DataContract`属性标记成员`DataMember`。不太为人所知的是，枚举有自己的属性`EnumMember`，称为 WCF 用来正确序列化它们的属性。

有一篇名为[Enumeration Types in Data Contracts](http://msdn.microsoft.com/en-us/library/aa347875.aspx)的 MSDN 文章更详细地介绍了用法。文章中的示例代码显示了带有枚举的合约的外观：

```
[DataContract]
public class Car
{
    [DataMember]
    public string model;
    [DataMember]
    public CarConditionEnum condition;
}

[DataContract(Name = "CarCondition")]
public enum CarConditionEnum
{
    [EnumMember]
    New,
    [EnumMember]
    Used,
    [EnumMember]
    Rental,
    Broken,
    Stolen
} 
```

请注意，在他们的示例中（我在上面已经包含），如果需要，您可以将枚举值的子集设置为数据协定的一部分。

除此之外，任何未使用该属性标记的`DataMember`属性都不会通过网络进行序列化。这应该是确保序列化适用于 WCF 的清单：

1.  检查类是否标有该`DataContract`属性。
2.  检查属性是否标记有该`DataMember`属性。
3.  检查各个枚举值是否标有该`EnumMember`属性。

# objective-c - 可以在应用程序中转推

> ID：13071411
> 
> 赞同：1
> 
> 时间：2012-10-25T14:57:27.247
> 
> 标签：objective-c, ios, twitter, social

我正在制作一个 iPhone 应用程序，我可以在其中获取某个用户的所有提要。现在我想知道当你按下按钮时是否可以转推？我正在使用社交框架。在搜索了社交框架 API 之后，我什么也没找到。

亲切的问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:17:04.130

Apple 有限的 Twitter API 似乎并未涵盖转推。
要在 iOS 中转发，您需要使用 Twitter 的[API](https://dev.twitter.com/docs/api/1/post/statuses/retweet/%3Aid) 看起来您需要自己发送 POST 请求，它看起来像 [http://api.twitter.com/1/statuses/retweet/3962807808.json](http://api.twitter.com/1/statuses/retweet/3962807808.json) //取自 API 页面。

我也找到了这个 SO 帖子，但似乎没有一个公认的答案 [如何在 ios 5 中实现 RETWEET？](https://stackoverflow.com/questions/8398297/how-to-implement-retweet-in-ios-5)

[这是Cocoanetics](http://www.cocoanetics.com/2012/05/twitter-framework-tutorial/)转发的一些示例代码

```
- (void)_retweetMessage:(TwitterMessage *)message
{
    NSString *retweetString = [NSString stringWithFormat:@"http://api.twitter.com/1/statuses/retweet/%@.json", message.identifier];
    NSURL *retweetURL = [NSURL URLWithString:retweetString];
    TWRequest *request = [[TWRequest alloc] initWithURL:retweetURL parameters:nil requestMethod:TWRequestMethodPOST];
    request.account = _usedAccount;

    [request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {
        if (responseData)
        {
            NSError *parseError = nil;
            id json = [NSJSONSerialization JSONObjectWithData:responseData options:0 error:&amp;parseError];

            if (!json)
            {
                NSLog(@"Parse Error: %@", parseError);
            }
            else
            {
                NSLog(@"%@", json);
            }
        }
        else
        {
            NSLog(@"Request Error: %@", [error localizedDescription]);
        }
    }];
} 
```

编辑：Keab42 指出该链接适用于明年年初将弃用的 Twitter API。这是更新的 API 页面。[https://dev.twitter.com/docs/api/1.1/get/statuses/retweets/%3Aid](https://dev.twitter.com/docs/api/1.1/get/statuses/retweets/%3Aid)

# dependency-injection - 通过嵌套容器的 Web API、DI 和对象生命周期？

> ID：13071412
> 
> 赞同：0
> 
> 时间：2012-10-25T14:57:27.433
> 
> 标签：dependency-injection, structuremap, asp.net-web-api

好的，我将 StructureMap 连接到我的 Web Api 应用程序（在 StackOverflow 和 Internet 上的其他地方有大量示例如何执行此操作）。我对 Web Api 中对象生命周期维护的理解是它是通过嵌套容器完成的。

对于通过嵌套容器进行对象生命周期维护的整个想法，Raven 的会话对象必须在子容器中创建为瞬态单例。现在我已经`IDocumentStore`在父容器中定义并限定为单例。`IDocumentSession`也在父容器中定义，但范围为 HttpContext。当请求进来时，`BeginScope()`被调用，嵌套容器被创建，但`IDocumentSession`其中的对象是从父级继承的，而不是被创建的。

我不明白这应该如何工作。如果对象不是在子容器中作为瞬态单例创建的，而是从父容器继承的，那么当嵌套容器被释放时，它将返回到父容器。这会破坏整个想法。另一方面，如果要在嵌套容器中创建会话作为瞬态单例，那么如何实现呢？如何验证此类设置的正确性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T20:30:44.363

> 如果我将 IDocumentSession 设置为 Per Web Request 那么为什么首先需要嵌套容器？

在这种情况下不需要嵌套容器。

一般来说，对嵌套容器本身的需求甚至是值得怀疑的。甚至Castle Windsor （支持子容器的容器）[的设计者](http://kozmic.pl/)也在考虑在下一个版本的 Castle Windsor 中一起[取消对子容器的支持。](http://kozmic.pl/2010/06/01/castle-windsor-and-child-containers/)

# mysql - 更新 MySQL 表，但只查询最大值

> ID：13071414
> 
> 赞同：1
> 
> 时间：2012-10-25T14:57:28.903
> 
> 标签：mysql, drupal, group-by, sql-update, max

我已经安装了带有事件模块的 Drupal 安装。我编写了一个简短的插件，用于搜索结束日期已过的所有事件，然后使其不存在。它基本上是一个 SQL 查询，如下所示：

```
UPDATE node LEFT JOIN content_field_dates on node.nid = content_field_dates.nid SET node.status = 0 WHERE node.type = 'event' AND field_dates_value2 < NOW() AND node.status = 1 
```

但是，某些事件可能有多个日期，即使某个日期已过且某些日期仍在未来，此查询也会将状态设置为 0。我设法做一个`SELECT`查询，只查询`MAX()`日期，如下所示：

```
SELECT * FROM node LEFT JOIN content_field_dates on node.nid = content_field_dates.nid WHERE node.type = 'event' AND field_dates_value2 < NOW() GROUP BY field_dates_value2 HAVING field_dates_value2 = MAX(field_dates_value2) 
```

但我不知道这将如何转换`UPDATE`为我无法使用的查询`GROUP BY`。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:37:12.987

您可以将其`max`放入内联视图中，然后加入反对该视图。请注意，由于您在`content_field_dates`表上有一个谓词，因此您不会通过`LEFT JOIN`对它执行 a 来获得任何东西。

无论如何，这应该有希望让你得到你想要的：

```
UPDATE node n
join (
select nid,max(field_dates_value2) as maxDate
from content_field_dates
group by nid
) t on n.nid = t.nid
SET n.status = 0 
where t.maxDate < now() and n.status = 1; 
```

# c# - c# 将下拉列表中的选定值传递给访问数据源选择参数

> ID：13071417
> 
> 赞同：0
> 
> 时间：2012-10-25T14:57:43.997
> 
> 标签：c#

我有一个加载列表框值的访问数据源。我正在尝试将参数传递给 accessdatasource，但我不确定我做错了什么。

```
<asp:DropDownList ID="customerName" runat="server">
    <asp:ListItem value="69" Text="Danny"></asp:ListItem>
    <asp:ListItem value="23" Text="Sarah"></asp:ListItem>
</asp:DropDownList>

<asp:AccessDataSource ID="AccessDataSource1" runat="server" DataFile="/App_Data/data.mdb" SelectCommand="SELECT * FROM table WHERE customerID='?'">

<selectparameters>
    <asp:ControlParameter Name="customerID" ControlID="customerName" PropertyName="SelectedValue" />
</selectparameters>

<asp:ListBox ID="lstCustomers" runat="server" AutoPostBack="True" 
        DataSourceID="AccessDataSource1" DataTextField="customerName" 
        DataValueField="customerID" Width="175px" Height="365px" 
            onselectedindexchanged="lstCustomers_SelectedIndexChanged"></asp:ListBox> 
```

列表返回为空白......不知道我做错了什么！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T11:53:29.643

只是为了澄清..这已由 Richard Deeming 解决，但没有答案。我会在这里发布代码

通过删除 ? 周围的单引号解决了这个问题 SQL中的参数

```
<asp:AccessDataSource ID="AccessDataSource1" runat="server" DataFile="/App_Data/data.mdb" SelectCommand="SELECT * FROM table WHERE customerID=?"> 
```

# ios6 - iOS SDK 似乎无法在 iOS 6 中处理撤销的访问令牌

> ID：13071419
> 
> 赞同：4
> 
> 时间：2012-10-25T14:57:47.930
> 
> 标签：ios6, single-sign-on, facebook-ios-sdk

在我的应用程序获得了在 iOS 6 设置中注册的 Facebook 帐户的访问权限后，我从我的 Facebook 隐私设置中撤消了该应用程序。然后我尝试通过调用 [FBSession openActiveSessionWithReadPermissions...] 将我的应用程序与 facebook 重新连接，并且该方法使用旧访问令牌创建 facebook 会话，该令牌已经是无效的，而无需再次请求权限授予。

我认为这个问题与这个问题有关（[Facebook SDK 3.1 - 验证访问令牌时出错](https://stackoverflow.com/questions/12601191/facebook-sdk-3-1-error-validating-access-token)），据说它已在 SDK 3.1.1 中得到修复。

但是，我正在使用 SDK 3.1.1 并通过在发生无效访问令牌错误时手动调用 accountStore renewCredentialsForAccount 来解决此问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T21:18:47.173

基于[这个线程](https://stackoverflow.com/questions/12644871/how-do-i-simulate-an-expired-access-token-in-ios-facebook-sdk-3-1)，我发现验证有效会话的唯一方法是执行简单的图形 API 调用。如果发生错误，`FBSession.activeSession.isOpen`将返回`NO`，这很好地表明令牌已过期。

```
+ (void) ValidateSession
{    
    FBRequest *userDetails = [[FBRequest alloc] initWithSession:FBSession.activeSession graphPath:@"/me"];
    [userDetails startWithCompletionHandler:^(FBRequestConnection *connection, NSDictionary *result, NSError *error) {

        if (error) {
            if (FBSession.activeSession.isOpen) {
                // Less probable, so check error code.
            } else {
                // Bingo: here we know for sure that the token was useless.
                // Expected behavior: reauthorize.
            }
        } else if (result) {
            NSLog(@"%@", result);
            // token is valid, continue
        }

    }];
} 
```

即使在应用程序被删除之后，iOS 似乎也会保留 Facebook 令牌，因此最好在需要时重新确保令牌有效。

# c++ - C++：如何重用我的模板代码

> ID：13071422
> 
> 赞同：1
> 
> 时间：2012-10-25T14:57:56.523
> 
> 标签：c++, templates, machine-learning, function-pointers, random-forest

我正在编写一些算法来构建随机森林，每个森林都将使用单独的函数在单独的数据上进行训练（每棵树将使用一组具有固定签名的函数，但是不同的树将使用不同的函数集进行训练，这些函数可能具有不同的签名），但是我想使用模板编写一次构建随机树的代码。我目前有以下内容：

模板类 T 对应训练数据类型（即图像补丁，或像素） 模板类 V 对应函数指针类型

```
template<class T, class V>
class RandomTree{

    void build(RandomTreeNode<T>& current_node,
               vector<V>& functions,
               vector<T>& data) {
        ... some code that basically calls a function passing in data T
    }
} 
```

我像这样创建对象：

```
typedef double (*function_ptr)(TrainingDataPoint& data_point);

RandomTree<TrainingDataPoint, function_ptr> tree = ... 
```

问题是，出于效率原因，对于我正在构建的一棵树，我希望函数集（function_ptr's）不仅包含 TrainingDataPoint（模板类型 T），还包含数据缓存。这样我的函数指针将如下所示：

```
typedef double (*function_ptr)(TrainingDataPoint&,
                               unordered_map<string, cv::Mat>& preloaded_images); 
```

现在的问题是，我想不出一种方法来保持 RandomTree 类的通用性，但有一些函数集（模板类型 V）不仅仅需要训练点（模板类型 T）。

到目前为止，我想到了：

1.  使缓存全局化，以便函数可以访问它
2.  为每个训练数据点添加一个指向缓存的指针（但谁负责清理？）
3.  将第三个模板参数添加到 RandomTree，但在这种情况下，如果我正在构建不需要第三个参数的树，我应该放什么？

这些选项似乎都没有对我特别有吸引力，希望有人可以提供一些经验并告诉我更好的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:20:36.077

对需要状态的函数使用仿函数。C++ 中的仿函数是具有重载的 operator() 的类（或结构），因此仿函数的实例可以像函数一样“调用”。RandomTree 中函子的参数应该正是那些变化并受 RandomTree 控制的参数，其余的应该绑定在外部。具有包装函数的附加状态的示例仿函数：

```
template<typename Retval, typename Arg1, typename ExtraData>
struct BindExtraData
{
  typedef Retval(*func_type)(Arg1, ExtraData);
  BindExtraData( ExtraData const& d_, func_type func_ ):d(d_), func(func_) {};
  ExtraData d;
  func_type func;
  Retval operator()( Arg1 a1 )
  {
    return func(a1, d);
  }
}; 
```

但你可以做得更好。如果这是一次性的，则无需将其设为模板。bind2nd(well, binder2nd) 是上面的标准库版本，会写得更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:14:41.567

你能在 RandomTree 中添加另一个参数来接收缓存吗？如果未提供，则默认值为空缓存。例如

```
template<typename T, typename V, typename CacheDataType = EmptyCache>
class RandomTree{ ... }

RandomTree<TrainingDataPoint, function_ptr, ProloadedImageCache> 
```

# c# - 在事件中使用语句和资源使用情况

> ID：13071427
> 
> 赞同：1
> 
> 时间：2012-10-25T14:58:25.423
> 
> 标签：c#, memory-management

我只是想澄清一下。就处置客户而言，这是否安全：

```
using (WebClient client = new WebClient(TimeoutInSeconds))
{
   client.DownloadDataAsync(new Uri(par.Base_url));
   client.DownloadDataCompleted += (sender, e) =>
   {
       //code that checks e.Result
   }
} 
```

和相关的问题：假设我的客户超出范围（没有引用它），如果没有正确处理，内存是否可以从其数据中清除？

而且如果客户被处置，那么在哪里`e.Result`居住？有人可以澄清一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:26:34.157

在 .NET 4.0 中，`WebClient`该类`Dispose`从`System.ComponentModel.Component`. 由于它不会覆盖该`protected virtual void Dispose(bool disposing)`方法，因此处理该类仅从基类运行清理 - 即，它从`ISite`的容器中删除组件（如果有）并引发`Disposed`事件。由于您没有分配站点并且您没有订阅该`Disposed`事件，因此实际上根本不需要调用`Dispose`。

虽然代码看起来肯定会失败，但至少在 .NET 4.0 中不会。

# css - 如何在css中将主要内容定位在页眉和页脚下方

> ID：13071429
> 
> 赞同：2
> 
> 时间：2012-10-25T14:58:29.113
> 
> 标签：css, z-index

我有这段 html：

```
<html>
    <body>
        <header></header>
        <div></div>
        <footer></footer>
    </body>
</html> 
```

和这段CSS：

```
header {
    width: 500px;
    height: 100px;
    background: red;
    box-shadow:  0px 0px 10px 5px rgba(0, 0, 0, 0.5);
    z-index: 10;
}

div {
    width: 500px;
    height: 700px;
    background: yellow;
    box-shadow:  0px 0px 10px 5px rgba(0, 0, 0, 0.5);
    z-index: 5;
}

footer {
    width: 500px;
    height: 50px;
    background: blue;
    box-shadow:  0px 0px 10px 5px rgba(0, 0, 0, 0.5);
    z-index: 10;
} 
```

您也可以在这里看到：http: [//jsfiddle.net/XGTtT/](http://jsfiddle.net/XGTtT/)基本上，我希望在其他两个区域下方有黄色区域，但 z-index 似乎不起作用。出了什么问题以及如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:13:57.063

要实现位于彼此前面或下方的元素，您需要混合使用绝对定位和 z-index，因为 z-index 目前不适用于默认定位，这是静态的。

根据您想要实现的目标，添加`position: relative`到 div 中可能会更容易，然后在 div 上使用负边距将其向上/拉到页眉和页脚下方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:25:53.947

```
header {
    width: 500px;
    height: 100px;
    background: red;
    box-shadow:  0px 0px 10px 5px rgba(0, 0, 0, 0.5);
    z-index: 10;
    position: absolute;
    top:0;
}

div {
    width: 500px;
    height: 450px;
    background: yellow;
    box-shadow:  0px 0px 10px 5px rgba(0, 0, 0, 0.5);
    z-index: 5;
    position: absolute;
}

footer {
    width: 500px;
    height: 50px;
    background: blue;
    box-shadow:  0px 0px 10px 5px rgba(0, 0, 0, 0.5);
    z-index: 10;
    position: absolute;
    bottom: 0;
} 
```

[http://jsfiddle.net/XGTtT/8/](http://jsfiddle.net/XGTtT/8/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:08:12.823

较高的数字将在前面，较低的数字将在后面。并为每个元素给出一些不同的数字。与 div 1、页眉 2 和页脚 3 一样。

# iphone - 弃用 UILineBreakModeCharacterWrap 警告

> ID：13071431
> 
> 赞同：7
> 
> 时间：2012-10-25T14:58:38.753
> 
> 标签：iphone, ios6, xcode4.5

使用时我收到 ios6 中已弃用的警告

```
 label.lineBreakMode=UILineBreakModeCharacterWrap; 
```

还有其他方法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-25T15:16:53.577

从[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UILabel_Class/Reference/UILabel.html)中，使用 NSLineBreakByCharWrapping 消除警告。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-25T15:03:10.390

改为使用`NSLineBreakByCharWrapping`。的文档`UILineBreakModeCharacterWrap`指出了这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-16T12:20:44.757

根据文档

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UILabel_Class/Reference/UILabel.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UILabel_Class/Reference/UILabel.html)

使用 NSLineBreakByCharWrapping 消除警告。

```
label.lineBreakMode = NSLineBreakByCharWrapping; 
```

并用于测试对齐使用..

```
label.textAlignment = NSTextAlignmentLeft; 
```

快乐编码！！！

# c# - 从 UML 类图生成代码

> ID：13071432
> 
> 赞同：2
> 
> 时间：2012-10-25T14:58:44.387
> 
> 标签：c#, enterprise-architect

我在企业架构师中有一个带有 2 个类 A 和 B 的 UML 类图（示例简化）。类图显示了 A 和 B 之间的关联。A 和 B 的关联分别为 0..1 到 0..m。这意味着 A 可以有 0 ... m B 个实例，而 B 属于 0 或 1 个 A 实例。我与企业架构师一起生成了这个 C# 代码（简化）：

```
class A
{
   public B _b;
}

class B
{

} 
```

但是，不应该是：

```
class A
{
   public IList<B> _bs;
}

class B
{

} 
```

在代码生成过程中我需要考虑什么（我还选择了这两个类，但没有成功生成代码）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T05:46:14.000

转到工具 - 选项 - 源代码工程 - C# 并单击集合类按钮以指定用于代码生成的集合类（忽略 1..* 标签）。

您在连接器的“属性”中的“目标角色”选项卡上指定多重性属性（有序等）（我很确定 EA 会忽略源角色上的 0..1 多重性；它实际上并不能做很多事情）。

最后，确保所有类和包都指定为 C#。最简单的方法是在项目浏览器中右键单击包并选择代码工程 - 重置此包的选项，然后在对话框中指定“语言为 <All>”、“转换为 C#”和处理子包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T05:04:17.880

您需要定义希望代码生成使用哪个集合类。它是，从内存中，工具 > 选项 > 代码工程 > C#

# asp.net - 使用绝对路径.NET在客户端下载文件

> ID：13071438
> 
> 赞同：0
> 
> 时间：2012-10-25T14:58:54.283
> 
> 标签：asp.net, .net, download

```
 string FilePath = HttpUtility.UrlDecode(Request.QueryString.ToString());
   string[] s = FilePath.Split(new char[] { ',' });
   string path = s[0];
   string FileName = s[1];
    String str = HttpContext.Current.Request.Url.AbsolutePath;
      System.Web.HttpResponse response = System.Web.HttpContext.Current.Response;
      response.ClearContent();
      response.Clear();
      //  response.ContentType = "text/plain";
      response.AddHeader("Content-Disposition", "attachment; filename=" + FileName+ ";");
      response.TransmitFile(path+FileName);
      response.Flush();
      response.End(); 
```

以上是我从另一个页面获取音频文件位置的代码。音频文件位于远程机器上，可以使用 URL 访问，例如 http:\servername\audiofiles\filename.wav 。response.Transmit 和 .WriteFile 需要虚拟路径，而 response.Write() 不下载文件。如何提供绝对 url 而不是下载文件的虚拟路径

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:09:39.790

从另一个地方找到我自己的答案：

```
 string FilePath = HttpUtility.UrlDecode(Request.QueryString.ToString());
    string[] s = FilePath.Split(new char[] { ',' });
    string path = s[0];
    string FileName = s[1];

    int bytesToRead = 10000;

    byte[] buffer = new Byte[bytesToRead];

    try
    {
        HttpWebRequest fileReq = (HttpWebRequest)HttpWebRequest.Create(path+FileName);

        HttpWebResponse fileResp = (HttpWebResponse)fileReq.GetResponse();

        if (fileReq.ContentLength > 0)
            fileResp.ContentLength = fileReq.ContentLength;

        stream = fileResp.GetResponseStream();

        var resp = HttpContext.Current.Response;

        resp.ContentType = "application/octet-stream";

        resp.AddHeader("Content-Disposition", "attachment; filename=\"" + FileName + "\"");
        resp.AddHeader("Content-Length", fileResp.ContentLength.ToString());

        int length;
        do
        {
            if (resp.IsClientConnected)
            {
                // Read data into the buffer.
                length = stream.Read(buffer, 0, bytesToRead);

                // and write it out to the response's output stream
                resp.OutputStream.Write(buffer, 0, length);

                resp.Flush();

                //Clear the buffer
                buffer = new Byte[bytesToRead];
            }
            else
            {
                // cancel the download if client has disconnected
                length = -1;
            }
        } while (length > 0); //Repeat until no data is read
    }
    finally
    {
        if (stream != null)
        {
            //Close the input stream
            stream.Close();
        }
    }
} 
```

# c# - 底层连接已关闭：无法为 SSL/TLS 安全通道建立信任关系

> ID：13071440
> 
> 赞同：3
> 
> 时间：2012-10-25T14:59:00.557
> 
> 标签：c#, windows-8, microsoft-metro

我正在使用 C# 和 xaml 开发 Metro 风格的应用程序。

在我的应用程序中，调用 Web 服务时出现错误：

> 基础连接已关闭：无法为 SSL/TLS 安全通道建立信任关系。

这个错误的原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T07:10:20.307

我有一个爬虫程序，不久前我遇到了同样的异常。就我而言，原因是（我一直在抓取的网站的）安全证书已过期。

在我的情况下，一个快速修复是添加这行代码：

```
 ServicePointManager.ServerCertificateValidationCallback = new
RemoteCertificateValidationCallback
(
   delegate { return true; }
); 
```

注意：这个黑客可能是一个安全威胁

# c# - 将不同的点击处理程序分配给全局控件模板

> ID：13071442
> 
> 赞同：1
> 
> 时间：2012-10-25T14:59:10.720
> 
> 标签：c#, wpf, xaml

我正在使用这个 SimpleExpander 的稍微修改过的版本，以便我的扩展器标题是可点击的。

[http://www.codeproject.com/Articles/248112/Templating-WPF-Expander-Control](http://www.codeproject.com/Articles/248112/Templating-WPF-Expander-Control)

以下是相关的源代码：

```
<ControlTemplate x:Key="SimpleExpanderTemp" TargetType="{x:Type Expander}">

            <DockPanel>

                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                    <ToggleButton x:Name="ExpanderButton" />

                    <!-- button with hard coded click handler -->
                    <Button Name="SharerHeader" Click="SharerHeader_Click_1"> 
                        <ContentPresenter Content="{TemplateBinding Header}" />
                    </Button>
                </StackPanel>

            </DockPanel>
        </ControlTemplate> 
```

效果很好。现在我想在我的应用程序中重用这个控件模板，所以我将代码移到了我的 app.xaml 中。但是，我的标题被硬编码为单击事件，并且我希望能够根据正在使用扩展器的页面设置单击处理程序。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T06:12:04.853

1.  将一个新的 ResourceDictionary 添加到您的项目（将其命名为 RD1.xaml），将您的模板移动到其中。

2.  使用此签名添加一个新类（将其命名为 RD1.xaml.cs）

    ```
    public partial class SomeClassName : ResourceDictionary 
    ```

3.  将这行代码添加到 ResourceDictionary 标记（在 RD1.xaml 中）

    ```
    x:Class="WpfApplication1.SomeClassName" 
    ```

4.  将这些代码行添加到 App.xaml（如果 RD1 在文件夹中，则添加 FolderName）

    ```
    <Application.Resources>
            <ResourceDictionary>
                <ResourceDictionary.MergedDictionaries>
                    <ResourceDictionary Source="FolderName\RD1.xaml"/>
                </ResourceDictionary.MergedDictionaries>
            </ResourceDictionary>
    </Application.Resources> 
    ```

5.  现在您可以在 RD1.xaml.cs 中实现事件处理程序

# xml - xsl for-each 语句的问题

> ID：13071443
> 
> 赞同：1
> 
> 时间：2012-10-25T14:59:12.797
> 
> 标签：xml, xslt

我对 XSL 语句有另一个问题。我正在尝试添加一个条件，以便如果找到某个值，在这种情况下“调用”，那么它的行为会略有不同。我知道这是一件简单的事情我做错了，但不知道是什么！

基本上在下面的代码中似乎返回了正确的布尔值，但是它继续进行并且仍然保留了调用成本的措辞。类和 URL 位置都正确输出。

提前致谢！

XML

```
<rhs_options>
<title>RHS title</title>
<service>
    <option>call</option>
    <text>telephone number text</text>
    <telephone>telephone number</telephone>
    <link>telephone number link</link>
</service>
<service>
    <option>branch</option>
    <text>branch text</text>
    <telephone/>
    <link>branch link</link>
</service>
<service>
    <option>online</option>
    <text>online text</text>
    <telephone/>
    <link>online link</link>
</service> 
```

XSL

```
<aside class="cta">
<h4><xsl:value-of select="/Properties/Data/Datum[@ID='ID1']/DCR[@Type='RHS_Options']/rhs_options/title"/></h4>
    <xsl:for-each select="/Properties/Data/Datum[@ID='ID1']/DCR[@Type='RHS_Options']/rhs_options/service">  
        <xsl:choose>
            <xsl:when test="/Properties/Data/Datum[@ID='ID1']/DCR[@Type='RHS_Options']/rhs_options/service/option='call'">
                <p class="{./option}">
                    <xsl:value-of select="./text"/>
                        <br/>
                    <xsl:value-of select="./telephone"/>
                        <br/>
                    <a href="{./link}">
                        Call charges
                    </a>
                </p>
            </xsl:when>
            <xsl:when test="/Properties/Data/Datum[@ID='ID1']/DCR[@Type='RHS_Options']/rhs_options/service/option='phone'or'online'">
                <p class="{./option}">
                    <a href="{./link}">
                        <xsl:value-of select="./text"/>
                    </a>
                </p>
            </xsl:when>
        </xsl:choose>   
    </xsl:for-each> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:40:41.077

**你想要**：

```
 <xsl:choose>
        <xsl:when test="option='call'">
            <p class="{option}">
                <xsl:value-of select="text"/>
                    <br/>
                <xsl:value-of select="telephone"/>
                    <br/>
                <a href="{link}">
                    Call charges
                </a>
            </p>
        </xsl:when>
        <xsl:when test="option='phone' or option = 'online'">
            <p class="{option}">
                <a href="{link}">
                    <xsl:value-of select="text"/>
                </a>
            </p>
        </xsl:when>
    </xsl:choose> 
```

**说明**：

所提供代码的问题是使用了*绝对*XPath 表达式，但必须使用*相对*Xpath 表达式。

**当然，最好*不要*使用 `xsl:for-each* 并且*不要*使用任何显式的 XSLT 条件指令**。

这是等效但更紧凑和可维护的代码：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
    <aside class="cta">
        <h4><xsl:value-of select="title"/></h4>
        <xsl:apply-templates/>
    </aside>
 </xsl:template>

 <xsl:template match="service[option='call']">
   <p class="{option}">
     <xsl:value-of select="text"/>
     <br/>
     <xsl:value-of select="telephone"/>
     <br/>
     <a href="{link}">
      Call charges
     </a>
   </p>
 </xsl:template>

 <xsl:template match="service">
   <p class="{option}">
     <a href="{link}">
       <xsl:value-of select="text"/>
     </a>
   </p>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<rhs_options>
    <title>RHS title</title>
    <service>
        <option>call</option>
        <text>telephone number text</text>
        <telephone>telephone number</telephone>
        <link>telephone number link</link>
    </service>
    <service>
        <option>branch</option>
        <text>branch text</text>
        <telephone/>
        <link>branch link</link>
    </service>
    <service>
        <option>online</option>
        <text>online text</text>
        <telephone/>
        <link>online link</link>
    </service>
</rhs_options> 
```

**产生了想要的结果：**

```
<aside class="cta">
   <h4>RHS title</h4>RHS title<p class="call">telephone number text<br/>telephone number<br/>
      <a href="telephone number link">
      Call charges
     </a>
   </p>
   <p class="branch">
      <a href="branch link">branch text</a>
   </p>
   <p class="online">
      <a href="online link">online text</a>
   </p>
</aside> 
```

# java - 将 Informix-4GL 程序中的 SQL 查询“SELECT UNIQUE 1...”转换为 Java 代码

> ID：13071444
> 
> 赞同：4
> 
> 时间：2012-10-25T14:59:13.997
> 
> 标签：java, sql, informix, 4gl

我想将 Informix-4GL 程序转换为 Java，但我遇到了一些问题。我有一个 Java 代码并成功连接到 Informix，但我遇到了一些问题。

1.  我如何在方法 executeQuery() 中使用“SELECT UNIQUE 1 ...”，因为 UNIQUE 1 不是 TSQL。
2.  SQLCA.SQLCODE 表示 SQL 查询正确然后返回 0。如何在 Java 中获取 SQLCA.SQLCODE 变量，或者 Java 可以提供相同的功能。

查看下面的 4GL 代码段；这意味着如果 SQL 查询返回任何行，则 SQLCA.SQLCODE 返回 0 并设置`SW_FBCHK = 1`。

```
SELECT  UNIQUE  1  FROM  FBFIL:FBRDPF1
       WHERE  COMPID  =  G_DEPTWN
         AND  FPRDAT  =  IO_FONLY.PRTDAT
         AND  INSU01  =  '5'
      IF  SQLCA.SQLCODE  =  0  THEN
          LET  SW_FBCHK  =  1
      ELSE
          LET  SW_FBCHK  =  0
      END IF 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:36:28.917

在 Informix 中，`SELECT UNIQUE`非标准等效于标准`SELECT DISTINCT`。

该查询正在测试您的表`FBFIL:FBRDPF1`（即`FBRDPF1`数据库中的表`FBFIL`）中是否有满足条件的行：

```
WHERE COMPID = g_deptwn
  AND FPRDAT = io_fonly.prtdat
  AND INSU01 = '5' 
```

在这种情况下，合理的猜测`g_deptwn`是全局变量（很多人使用`g_`前缀来表示全局变量），并且`io_fonly.prtdat`可能也是变量。因此，您需要将这些值传递给您的 Java SQL 语句。条件的 LHS 上的名称可能是表中的列，而不是更多的 I4GL 变量。您需要确定引用的表在 SQL Server 系统中的位置。

在 Java 中，您将使用 JDBC，因此您需要执行查询并尝试获取一行（可能提供一个变量来接收值 1）。如果该查询成功，那么您将把 Java 类似物设置`SW_FBCHK`为 1；否则，您将其设置为 0。不要忘记从查询中释放资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T20:34:48.727

由于您只是在测试成功，因此还有其他一些选择。

```
SELECT DISTINCT INSU01 ... 
```

似乎是最明显的候选人。如果您的查询中没有像这样的固定谓词，您可能必须考虑测试 的输出`SELECT COUNT(*) ...`，这意味着稍微改变您的逻辑。

# c - pthread 指针数组

> ID：13071448
> 
> 赞同：1
> 
> 时间：2012-10-25T14:59:39.703
> 
> 标签：c, arrays, pthreads, malloc, realloc

我试图动态分配一个 pthread 指针数组，但得到这个 glibc 错误：

```
*** glibc detected *** ./test: realloc(): invalid next size: 0x00000000084d2010 *** 
```

编码：

```
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>

int main(int argc, char** argv) {
    pthread_t **threads;
    int i;

    for(i=1;i<100;i++) {
        threads = realloc(threads, sizeof(pthread_t*)*i);
        threads[i] = malloc(sizeof(pthread_t));
    }

   return EXIT_SUCCESS;
} 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:00:28.567

*   你应该初始化`threads`（重点是我的）。

> **C11 (n1570)，第 7.22.3.5 节 realloc 函数**
> 
> 如果`ptr`是空指针，则 realloc 函数的行为类似于指定大小的 malloc 函数。*否则，如果 ptr 与内存管理函数先前返回的指针不匹配，或者如果空间已通过调用 free 或 realloc 函数被释放，则行为未定义。*

*   `sizeof(pthread_t *) * i`没有分配足够的内存来访问`thread[i]`. 你必须分配`((sizeof(pthread_t *) * (i + 1))`.

# asp.net - 使用 xPath 的 asp.net RadRotator

> ID：13071451
> 
> 赞同：0
> 
> 时间：2012-10-25T14:59:45.293
> 
> 标签：asp.net, xpath, telerik, rad-controls

我正在使用以下 RadRotator 从谷歌获取 RSS 提要：

```
 <telerik:RadRotator ID="RadRotator1" RotatorType="AutomaticAdvance" ScrollDirection="Up"
            ScrollDuration="2000" runat="server" DataSourceID="XmlDataSource1" Width="493"
            ItemWidth="493" Height="192" ItemHeight="75" FrameDuration="1" InitialItemIndex="-1"
            CssClass="rotator"> 
```

```
 <%#   XPath("item") %>    

      </ItemTemplate> 
```

发生的事情是，当我这样做时，radgrid 中没有显示任何内容

```
 <%#   XPath("item") %> 
```

请注意，我需要项目，因为它具有标题、说明等。您可以在下面的片段中看到

但如果我这样做

```
 <%#   XPath("description") %> 
```

我看到了描述，但该项目是我需要的..

以下是 google rss xml 文件的片段：

```
 <rss version="2.0"><channel><generator>NFE/1.0</generator><title>malaria - Google News</title><link>http://news.google.com/news?pz=1&ned=us&hl=en&q=malaria</link><language>en</language><webMaster>news-feedback@google.com</webMaster><copyright>&copy;2012 Google</copyright><pubDate>Thu, 25 Oct 2012 14:56:08 GMT</pubDate><lastBuildDate>Thu, 25 Oct 2012 14:56:08 GMT</lastBuildDate><image><title>malaria - Google News</title><url>https://ssl.gstatic.com/news/img/logo/en_us/news.gif</url><link>http://news.google.com/news?pz=1&ned=us&hl=en&q=malaria</link></image><item><title>Malaria and Acquired Immunity - AllAfrica.com</title><link>http://news.google.com/news/url?sa=t&fd=R&usg=AFQjCNHNkVuoonL7HkcwkSoAldZPsWUvNg&url=http://allafrica.com/stories/201210251151.html</link><guid isPermaLink="false">tag:news.google.com,2005:cluster=http://allafrica.com/stories/201210251151.html</guid><pubDate>Thu, 25 Oct 2012 12:16:20 GMT</pubDate><description><table border="0" cellpadding="2" cellspacing="7" style="vertical-align:top;"><tr><td width="80" align="center" valign="top"><font style="font-size:85%;font-family:arial,sans-serif"></font></td><td valign="top" class="j"><font style="font-size:85%;font-family:arial,sans-serif"><br /><div style="padding-top:0.8em;"><img alt="" height="1" width="1" /></div><div class="lh"><a href="http://news.google.com/news/url?sa=t&amp;fd=R&amp;usg=AFQjCNHNkVuoonL7HkcwkSoAldZPsWUvNg&amp;url=http://allafrica.com/stories/201210251151.html"><b><b>Malaria</b> and Acquired Immunity</b></a><br /><font size="-1"><b><font color="#6f6f6f">AllAfrica.com</font></b></font><br /><font size="-1">Even though the economic impact in Zambia has not yet been quantified, it is likely to be substantial due to the number of productive days lost due to the number of productive days lost due to <b>malaria</b>. The intensity of <b>malaria</b> in an area determines the <b>...</b></font><br /><font size="-1" class="p"></font><br /><font class="p" size="-1"><a class="p" href="http://news.google.com/news/more?ncl=dPdXW_JAl88mIRM&amp;ned=us"><nobr><b>and more&nbsp;&raquo;</b></nobr></a></font></div></font></td></tr></table></description></item> 
```

请注意，我只是想获取它的项目部分，因为该项目是描述等的包装。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T15:43:03.867

这是您的方案的代码片段：

XML 数据源定义：

```
<asp:XmlDataSource ID="XmlDataSource1" runat="server" DataFile="http://news.google.com/news?pz=1&amp;cf=all&amp;ned=us&amp;hl=en&amp;q=malaria&amp;output=rss" 
                XPath="rss/channel/item"></asp:XmlDataSource> 
```

RadRotator 定义：

```
 <telerik:RadRotator ID="RadRotator1" RotatorType="AutomaticAdvance" ScrollDirection="Up"
            ScrollDuration="1000"  runat="server" DataSourceID="XmlDataSource1" Width="493"
            ItemWidth="493" Height="250" ItemHeight="250" FrameDuration="2000" InitialItemIndex="-1"
            CssClass="rotator">
            <ItemTemplate>
                <div style="border: 1px solid darkgray; padding : 10px;background-color:lightgrey">
                    <a href='<%# XPath("link") %>'><%# XPath("title") %></a>
                    <div>
                        <%# XPath("description") %>
                    </div>
                </div>

            </ItemTemplate>
        </telerik:RadRotator> 
```

到达 RSS 提要中的项目的方法是通过路径 rss/channel/item - 这将给出文档中的所有项目。然后在项目模板中，我只是抓取链接、标题和描述。项目是父节点，这就是为什么

以下是上述代码的输出：

![在此处输入图像描述](../Images/5035a757783528e38c93b9e295d10e55.png)

# java - 使用java在矩阵中添加行

> ID：13071459
> 
> 赞同：0
> 
> 时间：2012-10-25T15:00:09.197
> 
> 标签：java

我只使用循环在 java 中创建了一个矩阵。但我想在最后显示行的总数。我一直在试图解决这个问题，但我无法提出解决方案。任何帮助，将不胜感激。

这是我到目前为止的代码

```
public class Main {
    public static void main(String[] args) {

        int num = 4;
        int product = 0;

        for (int i = 1; i <= num; i++) {

            for (int j = 1; j <= num; j++) {

                 product = j * i;

                System.out.printf("\t" + product);

            }

            System.out.println();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:02:15.383

如果我理解正确，您只需要实现以下内容：`int total = 0;`然后在循环的每个循环中相应地更新......`total = total + x;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:04:41.477

基本上你应该做的是有一个字段来跟踪列的累积总和。

我将根据您的代码给出一个示例：

```
public class Main {
    public static void main(String[] args) {

    int num = 4;
    int product = 0;
    int rowSum = 0;

    for (int i = 1; i <= num; i++) {
        rowSum = 0; //reset for each row.
        for (int j = 1; j <= num; j++) {

            product = j * i;
            rowSum += product; //rowSum = rowSum + product.

            System.out.printf("\t" + product);

        }
        System.out.printf("\t = " + rowSum); //this should give you = SUM at the end of the line.
        System.out.println();
    }

} 
```

}

# php - 如何在 php 中使用 shell_exec() 获取参数

> ID：13071460
> 
> 赞同：1
> 
> 时间：2012-10-25T15:00:12.030
> 
> 标签：php, cron

我有两个 php 文件。

第一个执行第二个我想用 exec 发送一个参数

我不知道如何获取我在第二个文件中发送的参数

**第一个.php：**

```
$params="hello";
shell_exec('php file.php $params > /dev/null 2>/dev/null &') 
```

**文件.php**：

```
echo $params; 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:03:16.400

使用[`$argv`](http://php.net/manual/en/reserved.variables.argv.php)数组

在你的情况下

```
echo $argv[1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:04:05.413

`$argv`包含传递给脚本的任何参数。

见[http://php.net/manual/en/reserved.variables.argv.php](http://php.net/manual/en/reserved.variables.argv.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:05:16.873

尝试`echo $argv[1]`

[从文档](http://php.net/manual/en/reserved.variables.argv.php)中查看此页面

# facebook-graph-api - 如何获取用户使用过的应用程序列表

> ID：13071465
> 
> 赞同：0
> 
> 时间：2012-10-25T15:00:24.183
> 
> 标签：facebook-graph-api

我希望使用 Graph API 来检索用户当前在其帐户中拥有的应用程序列表 - 他们正在使用或已经使用但尚未删除的应用程序。这与通过单击应用中心和我的应用找到的列表相同。

我不想获取有关特定应用程序的信息（但是；我不知道要查看*哪个应用程序，也不知道如何获取其 ID）。*

本文：[如何使用 Graph API 获取用户的 Facebook 应用程序列表](http://facebook.stackoverflow.com/questions/12881964/how-to-get-the-list-of-facebook-applications-for-a-user-using-graph-api)

似乎是正确的答案（而且 OP 肯定喜欢它），但对我来说，虽然它有效，但它返回一个空数组 - 但我的个人资料中列出了大约 20 个应用程序（主要是游戏），其中一半在收藏夹中. 我不需要知道哪些是最喜欢的；我只是想知道用户对哪些应用感兴趣。

我意识到这被认为是敏感信息，但由于我找不到用于 api() 方法的字符串，我无法确定我需要哪些权限；我目前要求 read_stream 但由于调用本身成功，我假设我有足够的特权。

我看到您可以使用 /me/apprequests 列出应用程序*请求*，这表明您应该能够检索应用程序列表（通常是请求的来源，除了新游戏的邀请） - 但我找不到任何看起来正确的事情。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-27T05:10:24.423

不，不可能检索用户已使用 TOS 的应用程序的完整列表。

如对 OP 的评论中所述，假设他们已授予 user_games_activity 权限，则可以从 /[user]/scores 中推断出其中一些。

# issue-tracking - 使用自动生成的问题进行问题跟踪

> ID：13071468
> 
> 赞同：0
> 
> 时间：2012-10-25T15:00:32.530
> 
> 标签：issue-tracking

在我的公司，我们现在正在寻求开始使​​用问题跟踪器。到目前为止，我们一直在使用我们的任务管理系统进行问题跟踪，现在我们需要更高级的东西。

我们发现我们有很多（1000 多个）可以自动生成的小问题，我们希望根据优先队列来处理它们。这样的小问题通常是内容问题。有时问题是出现的直接错误，我们希望根据错误的严重程度和遇到的用户数量来确定这些错误的优先级。

我们正在寻找的另一个功能是能够基于我们可以生成的一些标识字符串来聚合相同的问题。我们还希望能够手动聚合问题 - 即通过 UI 以简单的方式将两个问题标记为重复。

最后，我们对问题跟踪器感兴趣，以便拥有一组用于手动管理问题的可用工具——确定优先级、设置所有者、生成报告等。

我的问题是：您建议我们使用什么问题跟踪器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-23T14:58:21.310

如果问题仍然存在，我是开发者@ [bontq.com](http://www.bontq.com)。它是一个问题跟踪系统，具有 Web 访问和 Win/Mac 桌面应用程序、SVN、GIT 集成、公共 API、优先级和许多其他有用的功能，您在问题中没有提到这些功能。您可以在那里创建一个免费帐户并试用该系统 - 也许它就是您正在寻找的那个。

如果您对系统（尤其是 Web 界面和 API）有任何疑问 - 您可以在这里问我。我很乐意帮助你。

PS：此回复不是广告 - 只是想提供帮助。

# android - 如何从 ListView 调用 WebView

> ID：13071469
> 
> 赞同：0
> 
> 时间：2012-10-25T15:00:36.420
> 
> 标签：android

我有以下 XML：

```
<string-array name="bookmark_titles">
    <item>Google</item>
    <item>Android</item>
    <item>Offspot</item>
</string-array>

<string-array name="bookmark_urls">
    <item>http://www.google.com</item>
    <item>http://www.android.com/</item>
    <item>http://www.offspot.com</item>
</string-array> 
```

这个 ListView 在一个单独的文件中：

```
<ListView
    android:id="@+id/favoritos_listView"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:divider="#ECECEC"
    android:dividerHeight="1sp" /> 
```

微博

```
WebView wv = (WebView) findViewById(R.id.webview); 
```

这就是我实现 ListView 的方式

```
 ArrayAdapter<CharSequence> aa = ArrayAdapter.createFromResource(this, R.array.bookmark_titles, android.R.layout.simple_list_item_1);
    lv.setAdapter(aa); 
```

当我单击 ListView 中的项目时，如何调用我的 WebView？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:05:47.397

实现一个[`OnItemClickListener`](https://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html)并将其设置为您`ListView`喜欢的：

```
listView.setOnItemClickListener(new OnItemClickListener() {
  onItemClick(AdapterView<?> parent, View view, int position, long id) {
    String url = getContext().getResources().getStringArray(R.array.bookmark_urls)[position];
    //opens the url in one of the Android Browsers.
    Intent intent = new Intent(Intent.ACTION_VIEW);
    intent.setData(Uri.parse(url));
    getContext().startActivity(intent);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:08:08.760

您的 WebView 的名称是什么？

首先，您需要参考您的网络视图。

```
WebView mWebView = (WebView)MyLayout.findViewById(R.id.webView1); 
```

然后您的列表视图需要一个 itemOnClick 方法，该方法决定您单击列表视图项目时要执行的操作

```
 //Show webview
        lv.setOnItemClickListener(new OnItemClickListener(){
            public void onItemClick(AdapterView<?> parent, View view, int position, long id){
                mWebView.setVisibility(View.VISIBLE); //Show the webview
                mWebView.refreshDrawableState();
                mWebView.loadUrl("www.google.com");
            }
        }); 
```

如果您需要从您单击的项目中获取特定数据，请使用位置变量来获取它 - lv.getItemAtPosition(position)

如果这对您有帮助，请点赞！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:21:01.217

如果在同一个活动中

```
WebView lWebView = (WebView)MyLayout.findViewById(R.id.webView);
    lWebView.setVisibility(View.GONE);//you can use View.INVISIBLE also if you need to keep the space
    String[] lTestArray =  = getResources().getStringArray(R.array. bookmark_urls);
    listView.setOnItemClickListener(new OnItemClickListener(){
                public void onItemClick(AdapterView<?> parent, View view, int position, long id){
                    lWebView.setVisibility(View.VISIBLE); //Show the webview
                    lWebView.loadUrl(lTestArray[position]);
                }
            }); 
```

**编辑** **另一个活动**
***ListView 类***

```
listView.setOnItemClickListener(new OnItemClickListener(){
                public void onItemClick(AdapterView<?> parent, View view, int position, long id){
                    Intent intent=new Intent(this,YOURCLASS.class);
                    intent.putExtra("Link",lTestArray[position]);
                    startActivity(intent);
                }
            }); 
```

***WebView 类***

```
 Bundle bundle=getIntent().getExtras();
    String link=bundle.getString("Link",null);
    if(!link.equals(null)){
    WebView lWebView = (WebView)MyLayout.findViewById(R.id.webView);
    lWebView.loadUrl(link);

} 
```

# php - 使用 Apache .htaccess 和 Zend Framework 以文件夹分隔同一域上的多个客户端

> ID：13071473
> 
> 赞同：0
> 
> 时间：2012-10-25T15:00:50.790
> 
> 标签：php, apache, .htaccess, zend-framework, mod-rewrite

我有一个为多个客户端实现的 Zend Framework 应用程序。目前，每个客户端都有一个带有自己的 SSL 证书的单独域。我想要实现的是使用相同的公共域并通过如下子文件夹分隔每个客户端的应用程序实例。每个子文件夹都包含一个完全独立的 ZF 应用程序实例。我的问题是，如何结合 mod_rewrite、.htaccess 和 ZF 路由来实现这一点，而 ZF 路由不会受到影响。

[https://www.somedomain.com/client1_app](https://www.somedomain.com/client1_app)
[https://www.somedomain.com/client2_app](https://www.somedomain.com/client2_app)
[https://www.somedomain.com/client3_app](https://www.somedomain.com/client3_app)

# resharper - Resharper - 仅在包装中使用检查而不使用其他任何东西

> ID：13071476
> 
> 赞同：1
> 
> 时间：2012-10-25T15:00:53.263
> 
> 标签：resharper

我一直在评估 Resharper，听说它有多棒。我同意它的代码检查很棒，但我不得不严重不同意大多数其他功能的伟大。

它为 Visual Studio 添加的所有缺陷都在扼杀我的工作效率。它已经吃掉了 Visual Studio 的快捷键，即使我告诉它不要这样做，而且即使我将“查找所有引用”重新映射到 Visual Studio，Resharper 仍然会选择它。

我们希望能够使用代码检查功能，而*不是*别的。这可以通过记录或未记录的方法实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:11:22.983

如果仅在键盘快捷键中出现问题，您可以将键盘方案更改为 Visual Studio。转到菜单`Resharper -> Options -> Keyboard and Menus`。检查`Visual Studio`窗口右侧的键盘方案并应用它。

# sql - 全文的 Postgresql 前缀通配符

> ID：13071479
> 
> 赞同：28
> 
> 时间：2012-10-25T15:01:05.993
> 
> 标签：sql, postgresql, full-text-search, full-text-indexing

我正在尝试使用 Postgresql 运行全文查询，该查询可以使用通配符满足部分匹配。

在搜索词之后有一个后缀通配符似乎很容易，但是我不知道如何指定前缀通配符。

例如，我可以使用类似的东西很容易地执行后缀搜索。

```
SELECT "t1".* 
FROM "t1" 
WHERE (to_tsvector('simple', "t1"."city") @@ to_tsquery('simple', 'don:*') ) 
```

应该返回匹配“伦敦”的结果

但是我似乎无法进行前缀搜索，例如...

```
SELECT "t1".* 
FROM "t1" 
WHERE (to_tsvector('simple', "t1"."city") @@ to_tsquery('simple', ':*don') ) 
```

理想情况下，我希望在搜索词的开头和结尾添加一个通配符，例如...

```
SELECT "t1".* 
FROM "t1" 
WHERE (to_tsvector('simple', "t1"."city") @@ to_tsquery('simple', ':*don:*') ) 
```

我可以使用 LIKE 条件，但是我希望从 Postgres 中全文搜索功能的性能中受益。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-25T15:36:25.553

全文搜索适用于查找单词，而不是子字符串。

对于子字符串搜索，您最好使用PostgreSQL 9.1 和/或索引`like '%don%'`提供的`pg_trgm`扩展。但是您的索引会非常大（甚至比您的表大几倍）并且写入性能不是很好。`using gin (column_name gin_trgm_ops)``using gist (column_name gist_trgm_ops)`

有一个[很好的例子，使用 pg_trgm](http://www.depesz.com/2011/02/19/waiting-for-9-1-faster-likeilike/)对[select * from depesz blog](http://www.depesz.com/)进行子字符串搜索。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-08-01T01:26:03.343

一种疯狂而疯狂的方法是创建所有文档的 tsvector 索引，反向。并反转您对后缀搜索的查询。

这基本上就是 Solr 使用其[ReversedWildcardFilterFactory所做的事情](http://lucene.apache.org/solr/4_1_0/solr-core/org/apache/solr/analysis/ReversedWildcardFilterFactory.html)

```
select
reverse('brown fox')::tsvector @@ (reverse('rown') || ':*')::tsquery --true 
```

# javascript - 循环表单以填充 json 对象以进行发布

> ID：13071481
> 
> 赞同：0
> 
> 时间：2012-10-25T15:01:16.273
> 
> 标签：javascript, json, post

我有一个购物车，想把它发布到我的登录窗口，这样我就可以在验证后继续结帐。但在此之前，我在购物车窗口加载时使用 Web 服务调用，因此我可以获得我的购物车项目的哈希值并保护我们之间的通信。如何序列化数据对象中的所有购物车项目，以便将其发送到我的网络服务器？

这是我目前正在尝试的，但它不起作用......

```
$(document).ready(function () {
  getCartHashCode();
});

function getCartHashCode() {
  var url = 'home/GetHashRequest';
  var data = new Array();

  //put all items from the cart on the data object
  for (i = 1; i <= $('.product-name').length; i++) {
    //setting up json parameter names
    var CART_NAME = 'CART_'+i+'_NAME';
    var CART_PRICE = 'CART_'+i+'_PRICE';

    var obj = { CART_NAME: $('input[name=Cart['+i+'].Name').val(),
                CART_PRICE: $('input[name=Cart['+i+'].Price').val() }

    data.push(obj);
  }

  $.ajax({
    type: 'POST',
    url: url,
    data: data,
    success: function (hash) {
      alert("It worked! Hash = " + hash.toString());
    }
  }); 
```

***编辑***

ferrants评论后跟进：我把它取下来了，真的去了服务器！谢谢

问题是如何获取我在服务器端发布的项目？

我有一个`item`定义为这样的域类：

```
public class Item
{
  public string Name { get; set; }
  public int UnitPrice { get; set; }
} 
```

我的控制器动作是这样的：

```
public string GetHashRequest(List<Item> cart)
{
  GetSecureHashPOCORequest hashRequest = new GetSecureHashPOCORequest();
} 
```

# parallel-processing - Matlab用分布式阵列进行慢速并行处理

> ID：13071485
> 
> 赞同：5
> 
> 时间：2012-10-25T15:01:27.803
> 
> 标签：parallel-processing, distributed, distributed-computing, matlab

我不熟悉在 matlab 中使用分布式和协同分布式数组。我生成的并行代码有效，但比串行版本慢得多，我不知道为什么。下面的代码示例根据体积数据计算 hessian 矩阵的特征值。

系列版本：

```
S = size(D);
Dsmt=imgaussian(D,2,20);
[fx, fy, fz] = gradient(Dsmt);
DHess = zeros([3 3 S(1) S(2) S(3)]);
[DHess(1,1,:,:,:), DHess(1,2,:,:,:), DHess(1,3,:,:,:)] = gradient(fx);
[DHess(2,1,:,:,:), DHess(2,2,:,:,:), DHess(2,3,:,:,:)] = gradient(fy);
[DHess(3,1,:,:,:), DHess(3,2,:,:,:), DHess(3,3,:,:,:)] = gradient(fz);

d = zeros([3 S(1) S(2) S(3)]);
for i = 1 : S(1)
    fprintf('Slice %d out of %d\n', i, S(1));
    for ii = 1 : S(2)
        for iii = 1 : S(3)
            d(:,i,ii,iii) = eig(squeeze(DHess(:,:,i,ii,iii)));
        end
    end
end 
```

并行版本：

```
S = size(D);
Dsmt=imgaussian(D,2,20);
[fx, fy, fz] = gradient(Dsmt);
DHess = zeros([3 3 S(1) S(2) S(3)]);
[DHess(1,1,:,:,:), DHess(1,2,:,:,:), DHess(1,3,:,:,:)] = gradient(fx);
[DHess(2,1,:,:,:), DHess(2,2,:,:,:), DHess(2,3,:,:,:)] = gradient(fy);
[DHess(3,1,:,:,:), DHess(3,2,:,:,:), DHess(3,3,:,:,:)] = gradient(fz);
CDHess = distributed(DHess);
spmd  
    d = zeros([3 S(1) S(2) S(3)], codistributor('1d',4));
    for i = 1 : S(1)
        fprintf('Slice %d out of %d\n', i, S(1));
        for ii = 1 : S(2)
            for iii = drange(1 : S(3))
                d(:,i,ii,iii) = eig(squeeze(CDHess(:,:,i,ii,iii)));
            end
        end
    end
end 
```

如果有人能对这个问题有所了解，我将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T13:12:22.213

这是您的代码的重写版本。我已将工作分配到最外层循环，而不是像您的情况 - 最内层循环。我还明确分配了`d`结果向量的局部部分，以及 Hessian 矩阵的局部部分。

在您的代码中，您依赖`drange`拆分工作，并直接访问分布式数组以避免提取本地部分。诚然，如果 MATLAB 一切都正确，它不应该导致如此大的减速。最重要的是，我不知道您的代码为什么这么慢 - 很可能是因为 MATLAB 进行了一些远程数据访问，尽管您分发了矩阵。

无论如何，下面的代码运行并使用 4 个实验室在我的计算机上提供了相当不错的加速。我已经生成了合成随机输入数据以进行处理。看看评论。如果有不清楚的地方，我可以稍后再详细说明。

```
clear all;

D = rand(512, 512, 3);
S = size(D);
[fx, fy, fz] = gradient(D);

% this part could also be parallelized - at least a bit.
tic;
DHess = zeros([3 3 S(1) S(2) S(3)]);
[DHess(1,1,:,:,:), DHess(1,2,:,:,:), DHess(1,3,:,:,:)] = gradient(fx);
[DHess(2,1,:,:,:), DHess(2,2,:,:,:), DHess(2,3,:,:,:)] = gradient(fy);
[DHess(3,1,:,:,:), DHess(3,2,:,:,:), DHess(3,3,:,:,:)] = gradient(fz);
toc

% your sequential implementation
d = zeros([3, S(1) S(2) S(3)]);
disp('sequential')
tic
for i = 1 : S(1)
    for ii = 1 : S(2)
        for iii = 1 : S(3)
            d(:,i,ii,iii) = eig(squeeze(DHess(:,:,i,ii,iii)));
        end
    end
end
toc

% my parallel implementation
disp('parallel')
tic
spmd
    % just for information
    disp(['lab ' num2str(labindex)]);

    % distribute the input data along the third dimension
    % This is the dimension of the outer-most loop, hence this is where we
    % want to parallelize!
    DHess_dist  = codistributed(DHess, codistributor1d(3));
    DHess_local = getLocalPart(DHess_dist);

    % create an output data distribution - 
    % note that this time we split along the second dimension
    codist = codistributor1d(2, codistributor1d.unsetPartition, [3, S(1) S(2) S(3)]);
    localSize = [3 codist.Partition(labindex) S(2) S(3)];

    % allocate local part of the output array d
    d_local = zeros(localSize);

    % your ordinary loop, BUT! the outermost loop is split amongst the
    % threads explicitly, using local indexing. In the loop only local parts
    % of matrix d and DHess are accessed
    for i = 1:size(d_local,2)
        for ii = 1 : S(2)
            for iii = 1 : S(3)
                d_local(:,i,ii,iii) = eig(squeeze(DHess_local(:,:,i,ii,iii)));
            end
        end
    end

    % assemble local results to a codistributed matrix
    d_dist = codistributed.build(d_local, codist);
end
toc

isequal(d, d_dist) 
```

和输出

```
Elapsed time is 0.364255 seconds.
sequential
Elapsed time is 33.498985 seconds.
parallel
Lab 1: 
  lab 1
Lab 2: 
  lab 2
Lab 3: 
  lab 3
Lab 4: 
  lab 4
Elapsed time is 9.445856 seconds.

ans =

     1 
```

**编辑**我已经检查了重塑矩阵的性能`DHess=[3x3xN]`。性能也好不到哪里去（10%），所以并不显着。但也许你可以实现`eig`一点不同？毕竟，这些是`3x3`您正在处理的矩阵。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T09:24:33.153

您没有指定打开 matlabpool 的位置，这将是决定您获得何种加速的主要因素。

如果您使用的是“本地”调度程序，那么使用分布式数组通常没有任何好处。特别是，如果耗时的操作在 MATLAB 中已经是多线程的，那么在使用本地调度程序时它们几乎肯定会变慢，因为 matlabpool 工作程序以单线程模式运行。

如果您在单独的机器上使用其他调度程序和工作人员，那么您可能可以获得加速，但这取决于您在做什么。这里有一个示例[http://www.mathworks.com/products/parallel-computing/examples.html?file=/products/demos/shipping/distcomp/paralleldemo_backslash_bench.html](http://www.mathworks.com/products/parallel-computing/examples.html?file=/products/demos/shipping/distcomp/paralleldemo_backslash_bench.html)显示了 MATLAB`\`运算符的一些基准。

最后，值得注意的是，索引分布式数组很不幸，特别是与 MATLAB 的内置索引相比。如果您可以在 spmd 块内提取您的共同分布式数组的“本地部分”并专门使用这些数组，那也可能会有所帮助。

# java - 每条消息都需要 Cipher.init() 吗？

> ID：13071489
> 
> 赞同：9
> 
> 时间：2012-10-25T15:01:35.287
> 
> 标签：java, cryptography, aes, encryption

假设两个客户端来回交换安全消息。

必须每次为每条消息运行此块，还是可以在开始时只执行一次任何步骤：

```
cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
cipher.init(Cipher.ENCRYPT_MODE, keySpec);
output = cipher.doFinal(content); 
```

我想提供一些背景信息——虽然我（还）不完全了解内部结构，但我的理解是，出于安全目的，更改每条消息的 IV 很重要。所以我认为这个问题的答案将取决于该步骤是否发生在 doFinal() 阶段或 init()....？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T15:35:28.243

你是对的：为了安全起见，你需要为每条消息使用一个新的、随机的 IV。这意味着您要么需要重新创建密码，要么自己为每条后续消息随机设置 IV。前者可能更安全，因为如果您更改密码或模式，可能还需要随机设置一些其他状态，并且重新初始化密码应该可以处理所有这些。

如果您不这样做，您最终会遇到 SSL 与 IV[重用](https://crypto.stackexchange.com/questions/1078/how-does-a-cipher-block-chaining-cbc-attack-work-against-ssl)相同的相当糟糕的错误。

Cipher.doFinal 不会将密码重置为随机 IV。事实上，它比这更糟糕，它似乎将内部状态重置为您开始使用的相同 IV。如这段代码所示。

```
 Cipher f = Cipher.getInstance("AES/CBC/PKCS5Padding");
     byte[] keyBytes = new byte[] { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09,
                0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f };

            SecretKeySpec key = new SecretKeySpec(keyBytes, "AES");
    f.init(Cipher.ENCRYPT_MODE, key);
    byte[] iv = f.getIV();
    System.out.println(Arrays.toString(f.doFinal("hello".getBytes())));
    System.out.println(Arrays.toString(f.getIV()));
    System.out.println(Arrays.toString(f.doFinal("hello".getBytes())));
    System.out.println(Arrays.toString(f.getIV()));
    System.out.println( Arrays.equals(f.getIV(), iv)); // true 
```

# javascript - 在项目单击时呈现视图模型

> ID：13071492
> 
> 赞同：1
> 
> 时间：2012-10-25T15:01:41.217
> 
> 标签：javascript, jquery, asp.net-mvc, view, render

情况如下：我有一个`Product`模型，它有很多属性，一个是`Photo`对象列表，每个`Photo`对象都有一个`ID`和一个`Name`。有一个轮播视图有一个模型列表`Photos`。在`Product`视图中我有这样的东西：

```
@if (Model.Photos.Count > 0)
{
    ....
    <a href="javascript:jsFunction()"....... 
```

在javascript中，`jsFunction`看起来像这样：

```
function jsFunction()
{
  alert('@Html.Action("GetPhotosCarousel", Model.Photos)');
} 
```

控制器函数返回部分视图`_PhotosCarousel`。

现在，`@Html.Action`在渲染主视图时执行的问题，**NOT ON CLICK**。

如何`PhotosCarousel`仅在单击时而不在显示页面时呈现视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:07:00.227

我建议`jsFunction`从您的实际调用中删除`href`，然后使用 jQuery 处理它。

```
<a href="#" id="photoCarouselHref">Click Me</a>

$(document).ready(function(){
    $("#photoCarouselHref").click(function(){
        $.ajax({
            url: '@Url.Action("GetPhotosCarousel"),
            //other ajax settings here
        });
    });
}); 
```

jQuery ajax 文档[在这里](http://api.jquery.com/jQuery.ajax/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T12:25:12.127

你可以试试这个：

代码已准备好具有多个锚元素：

HTML：

```
<div class="container">

    <a href="@Url.Action("GetPhotosCarousel")" 
        data-id="@Model.Id" 
        data-name="@Model.Name" 
        class="call-get-photos-carousel">click</a>

    <div class="result"></div>

</div> 
```

JS：

```
$(document).ready(function(){

    $('.call-get-photos-carousel').bind('click', function(event) {

        var 
            _this = this, 
            data = {'Id': $(this).data('id'), 'Name': $(this).data('name')};

        $.get($(this).attr('href'), data,  function(html) {
            $(_this).siblings('.result').html(html);
        });

        return false;
    });
}); 
```

但是如果你只有一个锚元素，你可以在元素中使用 ID 以这种方式工作：

HTML：

```
<div>

    <a href="@Url.Action("GetPhotosCarousel")" 
        data-id="@Model.Id" 
        data-name="@Model.Name" 
        id="call-get-photos-carousel">click</a>

    <div id="result"></div>

</div> 
```

JS：

```
$(document).ready(function(){

    $('#call-get-photos-carousel').bind('click', function(event) {

        var 
            _this = this, 
            data = {'Id': $(this).data('id'), 'Name': $(this).data('name')};

        $.get($(this).attr('href'), data,  function(html) {
            $('#result').html(html);
        });

        return false;
    });
}); 
```

在这两种情况下，动作都会发送到 和 的`Id`值`Name`。

# c - 简单宏导致编译错误

> ID：13071498
> 
> 赞同：3
> 
> 时间：2012-10-25T15:01:58.970
> 
> 标签：c, macros, compiler-errors

我正在尝试定义一个允许我传入 2 个数字以及一个运算符的宏。我希望宏对两个数字进行指定的操作并返回结果。

我的定义是：

```
#define GENERAL_OP(x,y,op) ((x) op (y)) 
```

当我打电话时效果很好

```
int result = GENERAL_OP(1, 2, -); 
```

但是一旦我尝试向它传递一个字符（这是我在调用宏的通用函数中实际需要做的），如下例所示：

```
void Evaluate(char op)...

int result = GENERAL_OP(1, 2, op); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T15:08:40.593

```
void Evaluate(char op)...

int result = GENERAL_OP(1, 2, op); 
```

宏替换是在编译前完成的，但是 的参数`Evaluate`只在运行时可用，所以宏展开导致

```
int result = ((1) op (2)); 
```

那里，并且`op`不是可以出现在那里的令牌（可能是未声明的标识符）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:10:07.397

预处理器在编译时运行，您不能使用`op`宏内部的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:17:33.370

我明白你要做什么......这有点像试图[unstringify](https://stackoverflow.com/questions/6982179/opposite-of-c-preprocessor-stringification)。我很确定它不能按照你想要的方式工作。您最好的选择是执行以下操作：

```
void Evaluate(char op, int x, int y)
{
    int result;
    if(op == '-')
      GENERAL_OP(x, y, -);
    ... 
```

但这并不能使它非常“普遍”......

# android - 选项菜单项之间不显示水平线

> ID：13071505
> 
> 赞同：0
> 
> 时间：2012-10-25T15:02:15.493
> 
> 标签：android, line, android-menu

我在我的应用程序中使用`menu.xml`. 菜单分两行显示。但是这些菜单项之间没有水平分隔线。但其他应用程序默认显示带有行分隔符的菜单项。

```
<menu xmlns:android="http://schemas.android.com/apk/res/android">
      <item android:id="@+id/scan"
            android:icon="@drawable/scan"
            android:title="Scan" />

      <item android:id="@+id/imei"
            android:icon="@drawable/imei"
            android:title="IMEI" />

      <item android:id="@+id/serno"
            android:icon="@drawable/serno"
            android:title="SerialNo" />

      <item android:id="@+id/update"
            android:icon="@drawable/update"
            android:title="Updates" />

      <item android:id="@+id/about"
            android:icon="@drawable/about"
            android:title="About" /> 

      <item android:id="@+id/exit"
            android:icon="@drawable/exit"
            android:title="Exit" />
</menu> 
```

我错过了什么吗？提前致谢。

# .net - 如何从 Team city 运行使用来自不同固定构建的代码的构建？

> ID：13071507
> 
> 赞同：0
> 
> 时间：2012-10-25T15:02:15.807
> 
> 标签：.net, deployment, build-automation, teamcity-7.0

我有 3 种不同的 TeamCity 构建配置。

1.  持续集成
2.  质量保证
3.  训练
4.  生产（尚不存在）

当我的 QA 构建运行时，它的版本是我的程序集，带有来自 Subversion 的 xx{build}.{revision} 编号。我想做的是能够固定 QA 认为可以接受的构建，并让培训和生产构建有效地提取最新固定的构建修订，并**使用相同的重建、单元测试和部署构建编号作为 QA build**。

单元测试和部署确实超出了这里的范围，我已经处理了它们，它的版本号让我现在卡住了。我也不太了解 TeamCity 在构建固定时会做什么，我什至需要担心拉动修订版还是由 TC 保留？

这是 TeamCity 可以做到的吗？有没有我没看到的文档？

I am by no means a deployment engineer, but for now, I have been elected, so I need to make it happen.

一些细节：我使用的是 TeamCity 7.1.1 VS2012 .NET 4.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T14:45:07.123

TC 中的 pinning 用于确保构建没有被清理，对 pinning 操作没有依赖关系，因此当构建被 pin 时，您不能执行单独的操作。

相反，您可以添加另一个构建，您只能手动启动，并将执行必要的任务。关于内部版本号，更好的方法是使用从手动启动的构建中生成的内部版本号。

另一种方法是在持续构建中执行所有任务。这称为[持续部署](http://en.wikipedia.org/wiki/Continuous_integration#Automate_deployment)。

# jquery - Jquery 多个滑块：ui.slider.handle 起始值？

> ID：13071508
> 
> 赞同：1
> 
> 时间：2012-10-25T15:02:22.733
> 
> 标签：jquery, slider, handler

我面临一些问题：我正在使用多个 ui 滑块。它从数据库中收集数据。因此，在打开页面时，它已经有了一个起始值和结束值。

我在处理程序上方使用两个“框”来显示当前值。他们正在与处理程序一起移动。

但是：我想出了如何在页面加载时显示起始值，但无法获取处理程序的 css 值以从一开始就显示它们上方的框。

代码：

```
$(function() {
    $("#<?php echo $site; ?>").slider({
        range: true,
        min: 16,
        max: 1024,
        values: [ < ? php echo $from; ? > , < ? php echo $to; ? > ],
        step: < ? php echo $step; ? > ,
        slide : function(event, ui) {
            if (ui.values[1] < 1024) {
                $("#<?php echo $fi; ?>").html(ui.values[0] + " kbps");
                $("#<?php echo $la; ?>").html(ui.values[1] + " kbps");
            }
            else {
                $("#<?php echo $fi; ?>").html(ui.values[0] + " kbps");
                $("#<?php echo $la; ?>").html(ui.values[1] + " kbps <");
            }

            $("#<?php echo $field; ?>").val(ui.values[0] + '-' + ui.values[1])

            alert($(this).children('.ui-slider-handle').first().css('left'));

            var offset1 = $(this).children('.ui-slider-handle').first().css('left');
            var offset2 = $(this).children('.ui-slider-handle').last().css('left');

            $("#<?php echo $fi; ?>").css('left', offset1);
            $("#<?php echo $la; ?>").css('left', offset2);
        },

    });
}); 
```

希望你能帮忙:)

编辑：

```
 $("#<?php echo $fi; ?>").css('left', offset1);
 $("#<?php echo $la; ?>").css('left', offset2); 
```

错误一定在上面。offset1+2 得到了错误的 css 值（滑动条的开始和结束）。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T09:08:07.997

这是一张图片：

[http://i47.tinypic.com/w1ybua.jpg](http://i47.tinypic.com/w1ybua.jpg)

如您所见，框不在滑块上方，而是在栏的开始和结束处。如何在初始化滑块时更改它？

# java - 在 Java 中找不到存在的文件

> ID：13071511
> 
> 赞同：2
> 
> 时间：2012-10-25T15:02:40.847
> 
> 标签：java, file

我有一个 Java 程序，它可以搜索您的 cookie 文件，然后将每个文件保存到一个数组中。然后我尝试在每个文件中搜索某个字符串，但是当我尝试搜索我知道存在的文件时，java 告诉我它们不存在。有任何想法吗？

到目前为止，这是我的代码：

```
 import java.io.*;
   import java.util.*;

   public class CheckCookie 
   {
      static String[] textFiles = new String[100];
        static String userName = "";

      public static void findCookies()
      {

         String path = "pathtocookies"; 

         String files;
         File folder = new File(path);
         File[] listOfFiles = folder.listFiles(); 

         for (int i = 0; i < listOfFiles.length; i++) 
         {

            if (listOfFiles[i].isFile()) 
            {
               files = listOfFiles[i].getName();
               if (files.endsWith(".txt") || files.endsWith(".TXT"))
               {
                  textFiles[i] = files;
               }
            }
         }
      }

      public static boolean searchCookies()
      {
         for(int j = 0; j < textFiles.length; j++) {
                String path2 = "pathtocookies"+textFiles[j];
            File file = new File(path2);

            try {
               Scanner scan = new Scanner(file);
               while (scan.hasNext()) {
                  String line = scan.nextLine();
                  if(line.contains("ineligible_age")) { 
                            System.out.println("A cookie for ineligible age was set.");             
                            return true;
                  }
               }

            } 
               catch(FileNotFoundException e) { 
               System.out.println("File was not found.");
                    return false;
               }
         }
            System.out.println("A cookie for ineligible age was not set.");
         return false;
      }

      public static void main(String[] args) 
      {
         findCookies();
            searchCookies();
            System.out.println();
            System.out.println("Finished searching for cookies. Yum.");
      }

   } 
```

实际路径：

```
C:/Users/lucas.brandt/AppData/Roaming/Microsoft/Windows/Cookies 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:26:19.970

使用列表而不是数组来存储文本文件。

想象一个有 2 个文件的目录。第一个是“abc.doc”，第二个是“itsme.txt”

您的 textFiles 数组将如下所示：

*   文本文件 [0]：空
*   文本文件[1]：“itsme.txt”

所以你尝试访问“pathtocookies”+“null”，这将失败，你去catch并从函数中返回。

进一步提示：

*   从第一个函数返回列表，将其用作第二个函数的参数
*   使用调试器或“调试”打印语句来调试代码以查看发生了什么

更多提示取决于实际用例。

--待定

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T15:13:26.103

在这一行：

```
String path2 = "pathtocookies"+textFiles[j]; 
```

您缺少目录名和文件名之间的文件分隔符。java.io.File 有一个构造函数，它将父路径和文件名作为单独的参数。您可以使用它或插入 File.separator：

```
String path2 = "pathtocookies" + File.separator + textFiles[j]; 
```

您还可以在阵列中获取目录。在尝试扫描它之前检查它是否是一个文件。

另外，请考虑将文件保存在列表中的其他答案，从而消除目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:19:46.610

```
 files = listOfFiles[i].getName(); 
```

尝试更改为

```
files = listOfFiles[i].getAbsolutePath(); 
```

**编辑**
您也可以直接启动一个文件数组（而不是字符串），
并且您必须使用`.canRead()`方法来验证文件访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:37:30.077

为什么不将`File`实例存储在`File[]`or中`List<File>`？

我认为在进行大量字符串连接时，您也会从使用 StringBuilder 中受益……

# jsf - 为什么将“立即”属性添加到 EditableValueHolders？

> ID：13071512
> 
> 赞同：6
> 
> 时间：2012-10-25T15:02:43.533
> 
> 标签：jsf, design-decisions, immediate-attribute

最初`immediate`标志仅用于`ActionSource`接口。但后来它也被添加到`EditableValueHolder`界面中。设计决策的原因是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-25T15:36:52.360

它用于对`EditableValueHolder`同一表单中的多个组件进行优先级验证。

想象一个包含输入组件和`immediate="true"`没有这个属性的输入组件的表单。即时输入将在应用请求值阶段（比平时早一个阶段）进行验证。非即时输入将在验证阶段（通常阶段）进行验证。如果至少有一个立即输入的验证失败，则非立即输入将根本不会被转换/验证，因此不会生成任何转换/验证错误消息。这在具有复杂验证规则的表单中特别有用，当对（立即）组件 X 的验证无论如何都失败时验证组件 Y 是没有意义的。

当与相同形式的命令按钮结合使用`immediate="true"`时，这将导致所有非立即输入被完全跳过。一个很好的真实示例是一个登录表单，其中包含 2 个字段“用户名”和“密码”`required="true"`以及 2 个按钮：“登录”和“忘记密码”。您可以`immediate="true"`点击“用户名”字段和“忘记密码”按钮来跳过`required="true"`对密码字段的检查。

在黑暗的 JSF 1.x 时代， the`immediate="true"`也经常（ab）用作与`valueChangeListener`and组合的黑客，`FacesContext#renderResponse()`在级联下拉列表中更常见。长话短说，这是一篇关于此的[旧博客文章](http://balusc.blogspot.com/2007/10/populate-child-menus.html)。至此，它使开发人员能够在更改 a 时执行支持 bean 方法，`<h:selectOneMenu>`而无需验证相同表单中的所有其他输入。但是这些天来，由于 ajax 非常棒，这种 hack 是不必要的。[您可以在我们的`<h:selectOneMenu>`wiki 页面](https://stackoverflow.com/tags/selectonemenu/info)底部找到该案例的具体示例。

这些天来，`immediate="true"`仍然经常（ab）使用，以便有一个完全绕过所有其他输入的特定按钮，例如“上帝形式”反模式中的注销按钮（*所有东西*都被放在一个巨大的 中`<h:form>`），或错误提交表单的取消按钮。当您开始`immediate="true"`在其中一个输入上实际需要正确的方式时，这样的按钮会损坏。您最好以自己的形式放置这样的注销按钮，或者将其更改为仅处理自身（`process="@this"`在 PrimeFaces 中）。而且你最好把这样的取消按钮改成只同步刷新页面`<h:button value="Cancel" />`。如果表单绑定到请求/视图范围的 bean 并且在动态页面上[禁用了浏览器缓存，则此方法可以正常工作。](https://stackoverflow.com/questions/10305718/avoid-back-button-on-jsf-web-application/)

### 也可以看看：

*   [在处理 AJAXified JSF 2.0 组件时，是否应该永远不使用 immediate="true" ？](https://stackoverflow.com/questions/10502326/should-immediate-true-never-be-used-when-dealing-with-an-ajaxified-jsf-2-0-com)
*   [试图理解 immediate="true" 在不应该的时候跳过输入](https://stackoverflow.com/questions/12960718/trying-to-understand-immediate-true-skipping-inputs-when-it-shouldnt/)

# datetime - 如何让日期和时间显示在 Crystal 报表中？

> ID：13071515
> 
> 赞同：1
> 
> 时间：2012-10-25T15:02:51.570
> 
> 标签：datetime, crystal-reports-2010

我正在使用适用于 Visual Studio 2010 的 Crystal Reports。数据位于 SQL Server 2005 数据库中。该字段是数据库/表中的日期时间字段。它有日期和时间。但我的报告拒绝将该字段视为日期字段以外的任何内容。啊？？？根据C# Corner 上的[这篇文章](http://www.c-sharpcorner.com/UploadFile/mahesh/DateFormatInCR06132007092248AM/DateFormatInCR.aspx)，自定义显示时应该有一个日期、一个时间和一个日期和时间选项卡。不，没有；当我尝试自定义它时，我看到的唯一数据类型选项卡是日期。

那么，当 VS 2010 的 CR 只想将其视为日期字段时，如何从存储过程返回的日期时间字段中获取日期和时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T19:33:20.950

我们终于找到了解决方案。我正在使用的报告真的很旧。它是由 10 多年前的某个人使用的，当时谁知道 Crystal Reports 的版本。我的同事决定开始一个全新的报表，并首先将字段从表中拖出，然后从用于报表的存储过程中拖到新报表上。好吧，数据类型现在是 DateTime！我们能想到的最好的结果是原始 .rpt 文件一定没有 DateTime 数据类型（表中的该字段已经是 15 年以上的 DateTime）。我们甚至发现基于现有报告创建新报告并不能解决问题；它仍然只将该字段视为日期数据类型。因此，我们必须创建一个新报告并从头开始。坦率地说，做起来很糟糕，只针对报告中的 1 个字段，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-22T16:33:45.900

这向您展示了如何设置 CR 以设置它如何解释`DateTime`为`Date`or `DateTime`：

[SAP 社区网络问题](http://scn.sap.com/thread/1386314)

# javascript - 带或不带逗号的十进制正则表达式

> ID：13071519
> 
> 赞同：0
> 
> 时间：2012-10-25T15:03:10.890
> 
> 标签：javascript, jquery, regex

我正在尝试编写一个允许带或不带逗号的小数的正则表达式。

我有 -

```
^[0-9]*((,\d{3})?(,\d{3})?(,\d{3})?)*(\.[0-9]{1,10})?$ 
```

这似乎在 reg ex tester 中工作，但是当我把它放在我的代码中时它不起作用。如果失败 1,000.00，但不是 1,000

我需要它来接受 1, 1000, 1000.00, 1,000,000.123, 1223.456, 1,000,123.928 等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:09:34.980

这个正则表达式似乎可以工作（[在这里](http://regexpal.com/)试试），但它有点过于复杂，同时允许不一致的使用`,`（即 12345,789,000.123）。这应该可以解决这个问题：

```
^\d{1,3}(?:(,?)\d{3}(?:\1\d{3})*)?(?:\.\d{1,10})?$ 
```

通过使用反向引用 ( `\1`)，您可以确保`,`始终使用或从不使用。

也可以在可选项前面添加数字，`.`同时在 a 前面仍然需要它们`,`，但稍微复杂一些：

```
^(?:\d{1,3}(?:(,?)\d{3})?)?(?:\1\d{3})*(\.\d{1,10})?$ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T15:13:16.037

这是允许格式正确的数字的另一个选项，最多 10 位小数：

```
^\d{1,3}((?:\,\d{3})*|\d*)(\.\d{1,10})?$ 
```

如果您想允许`.123`没有整数（小数的左侧），您可以将第一个更改`{1,3}`为`{0,3}`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-26T00:04:27.997

```
^(?=[\d.])\d{0,3}(?:\d*|(?:,\d{3})*)(?:\.\d+)?$ 
```

这强制使用一致的逗号，允许没有左侧，并且不会匹配空字符串，确保用户在您的表单中输入了某种数字。

要进行更改：

*   消除开头的 Lookahead 以允许空字符串
*   更改`{0,3}`为`{1,3}`需要 LHS
*   将最终更改为`+`以`{1,N}`最大精度。
*   要设置最大值，请更改（或添加，以保持不匹配空字符串。）开头的前瞻：
*   `(?=(?:,?\d){0,N})`其中 N 是最大位数。
*   要设置最小值，请将开始前瞻更改为：
*   `(?=(?:,?\d){M})`其中 M 是最小位数。
*   将它们组合为最小/最大。

享受！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T13:41:19.050

以下正则表达式对我有用：

```
^[0-9]{1,3}(,[0-9]{3})*(\\.[0-9]+)?$ 
```

我在 W3Schools 网页上使用此页面进行了测试：[http](http://www.w3schools.com/js/tryit.asp?filename=tryjs_regexp_test) ://www.w3schools.com/js/tryit.asp?filename=tryjs_regexp_test 。它接受最多三位数字，后跟逗号的任意序列，后跟 3 位数字，并以可选的点结尾，至少一个数字后跟任意数量的数字。

希望有帮助。

# nhibernate - 意外的 NHibernate 获取行为

> ID：13071523
> 
> 赞同：0
> 
> 时间：2012-10-25T15:03:18.903
> 
> 标签：nhibernate

我有一个带有 5 个域对象的棕地应用程序：CreditMemo、CreditMemoDetail、SalesInvoice、ReceivablesRecord、TransactionType。CreditMemo 是一个--多个 CreditMemoDetail。它也与 SalesInvoice 是多对一的。SalesInvoice 与 ReceivablesRecord 是一对多的，而 ReceivablesRecord 与 TransactionType 是多对一的（下面的 xml 映射）。没有任何关系依赖于其直接父/子之外的任何值。

当我执行 Get(id) 时，我正确地恢复了整个结构：CreditMemo 中的列已正确填写，ISet 正确，并且整个 SalesInvoice/ReceivablesRecord/TransactionType 层次结构已完全填充。当我执行 Get(invoiceNumber) 时，SalesInvoice 对象已正确填写，但 ISet 为空。使用 NHProfiler，执行完全相同的查询，包括参数。我已经敲了这个几个小时了，还没有想出任何有意义的东西。

我知道我可以强行处理事情，但是当从 CreditMemo 开始时，关系会自动运行，但在从 SalesInvoice 开始时却不能，这一事实让我发疯了。有任何想法吗？

对象和映射：

```
public class CreditMemo
{
    public virtual int CreditMemoId { get; set; }
    public virtual string CreditMemoNumber { get; set; }
    public virtual DateTime CreditDate { get; set; }
    public virtual string InvoiceNumber { get; set; }
    public virtual string ReturnToStock { get; set; }
    public virtual string Posted { get; set; }
    public virtual string Notes { get; set; }
    public virtual Iesi.Collections.Generic.ISet<CreditMemoDetail> Details { get; set; }
    public virtual SalesInvoice InvoiceInfo { get; set; }
}

<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" auto-import="true" schema="aladdin" namespace="Receivables.Models">
  <class name="Receivables.Models.CreditMemo, Receivables" lazy="false" table="credit_memo">
    <id name="CreditMemoId" column="credit_memo_id">
      <generator class="identity" />
    </id>
    <property name="InvoiceNumber" column="invoice_no" />
    <property name="CreditMemoNumber" column="credit_memo_no" />
    <property name="CreditDate" column="credit_date" type="DateTime" />
    <property name="ReturnToStock" column="return_to_stock" />
    <property name="Posted" column="posted" />
    <property name="Notes" column="notes" />
    <many-to-one name="InvoiceInfo" class="SalesInvoice" column="invoice_no" update="false" insert="false" />
    <set name="Details" cascade="delete">
      <key column="credit_memo_id" />
      <one-to-many class="CreditMemoDetail"/>
    </set>
  </class>
</hibernate-mapping>

public class CreditMemoDetail
{
    public virtual int CreditMemoDetailId { get; set; }
    public virtual int CreditMemoId { get; set; }
    public virtual string CreditType { get; set; }
    public virtual decimal Amount { get; set; }
    public virtual string AffectCommission { get; set; }
}

<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" auto-import="true" schema="aladdin" namespace="Receivables.Models">
  <class name="Receivables.Models.CreditMemoDetail, Receivables" lazy="false" table="cr_memo_detail">
    <id name="CreditMemoDetailId" column="crmemodetailid">
      <generator class="identity" />
    </id>
    <property name="CreditMemoId" column="credit_memo_id" />
    <property name="CreditType" column="credit_type" />
    <property name="Amount" column="amount" />
    <property name="AffectCommission" column="affect_commission" />
  </class>
</hibernate-mapping>

public class SalesInvoice
{
    public virtual string InvoiceNumber { get; set; }
    public virtual string Customer { get; set; }
    public virtual DateTime InvoiceDate { get; set; }
    public virtual string SalesPerson { get; set; }
    public virtual string ClassOfSale { get; set; }
    public virtual Iesi.Collections.Generic.ISet<ReceivablesRecord> Transactions { get; set; }
}

<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" auto-import="true" schema="aladdin" namespace="Receivables.Models">
  <class name="Receivables.Models.SalesInvoice, Receivables" lazy="false" table="invoice">
    <id name="InvoiceNumber" column="invoice_no">
      <generator class="assigned" />
    </id>
    <property name="Customer" column="customer" />
    <property name="InvoiceDate" column="invoice_date" type="DateTime" />
    <property name="SalesPerson" column="salesman" />
    <property name="ClassOfSale" column="class" />
    <set name="Transactions">
      <key column="invoice_no" />
      <one-to-many class="ReceivablesRecord"/>
    </set>
  </class>
</hibernate-mapping>

public class ReceivablesRecord
{
    public virtual string InvoiceNumber { get; set; }
    public virtual DateTime AccrecDate { get; set; }
    public virtual string TxType { get; set; }
    public virtual decimal Amount { get; set; }
    public virtual string Note { get; set; }
    public virtual TransactionType TypeInfo { get; set; }
    public override bool Equals(object obj)
    {
        bool result = false;
        try
        {
            ReceivablesRecord input = (ReceivablesRecord)obj;
            if (InvoiceNumber == input.InvoiceNumber && AccrecDate == input.AccrecDate && TxType == input.TxType)
            {
                result = true;
            }
        }
        catch (Exception ex)
        {
        }

        return result;
    }

    public override int GetHashCode()
    {
        return string.Format("{0}{1}{2}", InvoiceNumber, AccrecDate, TxType).GetHashCode();
    }
}

<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" auto-import="true" schema="aladdin" namespace="Receivables.Models">
  <class name="Receivables.Models.ReceivablesRecord, Receivables" lazy="false" table="accrec">
    <composite-id>
      <key-property name="InvoiceNumber" column="invoice_no" />
      <key-property name="AccrecDate" column="accrec_date" type="DateTime" />
      <key-property name="TxType" column="tx_type" />
    </composite-id>
    <property name="Amount" column="amount" />
    <property name="Note" column="note" />
    <many-to-one name="TypeInfo" class="TransactionType" column="tx_type" />
  </class>
</hibernate-mapping>

public class TransactionType
{
    public virtual string TransactionCode { get; set; }
    public virtual string Description { get; set; }
    public virtual decimal GLAccountNumber { get; set; }
    public virtual string Taxable { get; set; }
}

<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" auto-import="true" schema="aladdin" namespace="Receivables.Models">
  <class name="Receivables.Models.TransactionType, Receivables" lazy="false" table="txtype">
    <id name="TransactionCode" column="tx_code">
      <generator class="assigned" />
    </id>
    <property name="Description" column="description" />
    <property name="GLAccountNumber" column="gl_account_no" type="Decimal" />
    <property name="Taxable" column="taxable" />
  </class>
</hibernate-mapping> 
```

存储库代码：

```
 public CreditMemo GetById(int id)
    {
        return NhSession.Get<CreditMemo>(id);
    }

    public SalesInvoice GetInvoiceByInvoiceNumber(string id)
    {
        SalesInvoice salesInvoice = NhSession.Get<SalesInvoice>(id);
        return salesInvoice;
    } 
```

备用 GetInvoiceByInvoiceNumber*确实*有效（即，它返回 SalesInvoice 下面的所有详细级别，而不更改映射）：

```
 return NhSession.CreateQuery("from SalesInvoice where InvoiceNumber = :invoice_no")
        .SetString("invoice_no", id).UniqueResult<SalesInvoice>(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T10:20:16.727

ReceivablesRecord 的 Equals 方法可能是问题，将其更改为

```
public override bool Equals(object obj)
{
    ReceivablesRecord other = obj as ReceivablesRecord;
    return other != null &&
           InvoiceNumber == input.InvoiceNumber &&
           AccrecDate == input.AccrecDate &&
           TxType == input.TxType;
} 
```

# python - 从外部模块返回格式化列表

> ID：13071524
> 
> 赞同：-1
> 
> 时间：2012-10-25T15:03:20.070
> 
> 标签：python

我觉得我在问一个非常愚蠢的基本问题，但我已经昏迷了，无法理解它。

我有一个为我解析 pdf 的模块，在模块内部有将 pdf 内容解析为列表的函数。

```
def pdfToList(inFile):
    #Do all kinds of stuff with inFile
    list = inFile 
```

我从一个单独的文件中调用 pdfToList。因为 pdfToList 解析一个文件，所以当我稍后在我的主程序中需要结果时，我不想再次调用它。所以我想我会在我的模块中用一个单独的函数返回这个值：

```
def getList():
    return list 
```

不用说，由于范围问题，这不起作用。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:32:45.867

做这样的事情

```
g_lis t= None
def pdfToList(inFile):
    global g_list
    if g_list is None:
       #Do all kinds of stuff with inFile and set g_list once
       g_list = inFile

    return g_list 
```

因此，`pdfToList`首先检查您是否已经设置了全局变量`g_list`并返回它，否则设置它，这样您只需要一个可以再次调用的函数，而不必担心再次加载文件

# tridion - 在 GetItems(filter) 调用之后在方法之间传递它们时访问 TOM.NET 对象的属性

> ID：13071526
> 
> 赞同：5
> 
> 时间：2012-10-25T15:03:33.153
> 
> 标签：tridion, tridion-2011

在使用 GetItems 方法并将返回集合中的每个项目传递给另一个方法时，我们遇到了一个奇怪的问题。

我们在 Tridion 2011 GA 上。

以下代码正在破坏：

```
private void foo(StructureGroup structureGroup, Session session, int counterTemp, int levels)
{
    OrganizationalItemItemsFilter filtersg= new OrganizationalItemItemsFilter(session);
    filtersg.Recursive = false;
    IEnumerable<ItemType> itemtype = new List<ItemType> { ItemType.StructureGroup};
    filtersg.ItemTypes = itemtype;

    foreach (StructureGroup sg in structureGroup.GetItems(filtersg))
    {
        GetSiteMap(sg, counterTemp, levels);
    }
}

private void GetSiteMap(StructureGroup sg, int counter, int levels)
{
    logger.Info(sg.Id);  //ok
    logger.Info(sg.Title);  //ok
    logger.Info(sg.Directory);  // null !?
} 
```

但是，如果在将 sg 传递给下一个方法之前访问 sg.Directory，则一切正常：

```
private void foo(StructureGroup structureGroup, Session session, int counterTemp, int levels)
    OrganizationalItemItemsFilter filtersg= new OrganizationalItemItemsFilter(session);
    filtersg.Recursive = false;
    IEnumerable<ItemType> itemtype = new List<ItemType> { ItemType.StructureGroup};
    filtersg.ItemTypes = itemtype;

    foreach (StructureGroup sg in structureGroup.GetItems(filtersg))
    {
        logger.Info(sg.Directory); //if printed here, all works fine down the line.
        GetSiteMap(sg, counterTemp, levels);
    }
}

private void GetSiteMap(StructureGroup sg, int counter, int levels)
{
    logger.Info(sg.Id);  //ok
    logger.Info(sg.Title);  //ok
    logger.Info(sg.Directory);  // ok   }
} 
```

感觉 GetItems() 方法发生了一些事情，它没有返回完整的对象，并且一旦将部分加载的对象传递给 next 方法，它就无法加载属性，就好像丢失了原始引用一样.

有人可以解释一下这里发生了什么吗？另外，在方法之间传递 TOM.NET 对象是不是很糟糕？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T21:56:54.500

这看起来真的很奇怪——事实上我无法在 2011 GA 上重现——我将你的函数粘贴到 .NET TBB 中并从模板生成器中执行——这两种方法都可以很好地输出目录。这可能不会作为纯粹的猜测工作，但有几件事可以尝试：

1.  `filter.BaseColumns = ListBaseColumns.Extended`- 我认为这仅适用于 GetListItems，但你永远不知道......
2.  尝试输出`sg.LoadState`以查看它是否以某种方式未完全加载

如果所有其他方法都失败，请使用`GetListItems`，然后为您要处理的每个项目创建一个 StructureGroup 对象（假设您将从基于 sg.Title 的站点地图中跳过一些 SG）。有点遗憾的是，从 GetListItems 返回的数据没有 url 属性，否则您可以一次性完成所有操作`Publication.GetListItems()`，使用仅用于 SG（或 SG 和 Pages）的递归过滤器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T08:03:33.657

If Will's suggestion doesn't work you can always try to have a SG class variable as a buffer, which would be set for each item in the loop, then you just call the method GetSiteMap without passing the sg. Not the cleanest solution but it's worth a try if nothing else works.

# android - Android 4.1.1 上的 HTML5 画布问题

> ID：13071528
> 
> 赞同：13
> 
> 时间：2012-10-25T15:03:34.947
> 
> 标签：android, html, canvas, android-browser

现在 Android 4.1.1 在一些手机上出现了，我注意到使用默认浏览器和这个操作系统开始出现问题。

就我而言，我有一个使用 Web 视图（即默认浏览器）和大量画布的应用程序。

我希望通过这个主题让每个人都发布发现的问题和解决方案，如果你知道的话。

我将从：

**问题：**重复的画布更多信息位于：[http ://code.google.com/p/android/issues/detail?id=35474](http://code.google.com/p/android/issues/detail?id=35474) **解决方案**画布父元素不应具有值为“隐藏”的 css 属性“溢出”

**问题**画布绘图看起来像素化更多信息：您可以阅读：[http](http://www.html5rocks.com/en/tutorials/canvas/hidpi/) : //www.html5rocks.com/en/tutorials/canvas/hidpi/ 并测试 //html5rocks.com/en/tutorials/canvas/hidpi/demo/demo .html 来查看自己（在我的情况下，我不使用使用画布构建的图像，并且我的绘图看起来像素化）也可以在 //code.google.com/p/android/issues/detail?id= 找到一些信息38470 **解决方案**（正在寻找）

**绘制的问题**画布消失更多信息：我找不到其他人遇到此问题，在我的情况下它有时会重现。 **解决方案**（寻找一个）

PS：由于反垃圾邮件，我无法发布链接

**更新**（2013 年 9 月 3 日）：重复画布问题现在出现在具有 Android 4.2.2 和/或 4.3 的 Nexus 7 上此外，您可能想知道只有在您的设备启用了“强制 GPU 渲染”时才会出现“重复画布”问题.

# ruby-on-rails-3 - 如果超过 X 天，突出显示记录的最简洁方式？

> ID：13071531
> 
> 赞同：2
> 
> 时间：2012-10-25T15:03:38.917
> 
> 标签：ruby-on-rails-3, datetime, view, dry, helper

在 Rails 3 应用程序中，根据其年龄突出显示表行的最整洁的 DRY 方式是什么？

```
<% @faults_open.each do |fault| %>
  <tr>
    <td><%= fault.name %></td>  
    <td><%= fault.faulttype %></td>
    <td><%= fault.priority %></td>
    <td><%= time_ago_in_words(fault.created_at) %> ago</td>
    <td><%= link_to 'Show', fault %></td>
  </tr>
<% end %> 
```

我想要一个应用于表格行的类，并指示其年龄，然后我可以使用 CSS 设置样式。

```
<% @faults_open.each do |fault| %>
  <tr <% if fault.created_at > Date.1.week.ago %>class="weekold"<% end %>>
    <td><%= fault.name %></td>  
    <td><%= fault.faulttype %></td>
    <td><%= fault.priority %></td>
    <td><%= time_ago_in_words(fault.created_at) %> ago</td>
    <td><%= link_to 'Show', fault %></td>
  </tr>
<% end %> 
```

类似上面的东西，但显然将它们添加到视图中会很混乱。我计划添加几个年龄，例如：

```
weekold
twoweeksold
monthold
sixmonthold
yearold
ancient 
```

我想帮助者是最整洁的方式，但我不确定帮助者将如何工作。任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:30:13.907

我最近做了类似的事情，在行中添加一个类名，以对应它的大致年龄（以周为单位），然后我使用 CSS 进行实际突出显示。

为什么不使用助手..（只是一个例子）

```
def highlight_age_class (created_at)
  @@today ||= Date.today
  num_weeks = ((@@today - created_at.to_date) / 7).floor
  class_name = "aged_#{num_weeks}_weeks"
  num_weeks == 1 ? class_name.singularize : class_name
end 
```

用你的 HTML ..

```
<tr class="<%= highlight_age_class fault.created_at %>"> 
```

结合一些 CSS ..

```
.aged_1_week
.aged_1_weeks
.aged_4_weeks
.aged_24_weeks
.aged_56_weeks

etc 
```

然后，您可以专注于扩展和优化年龄突出显示的辅助方法。

# css - GWT 自动缩放文本字体大小以适应边界

> ID：13071538
> 
> 赞同：0
> 
> 时间：2012-10-25T15:03:56.757
> 
> 标签：css, gwt, text, bounds, autoscaling

如何自动缩放网页中的文本字体大小以使 div 或 p 中的文本适合给定范围？

Android 有很好的解决方案，比如[这个](https://stackoverflow.com/questions/8066642/auto-scale-textview-text-to-fit-within-bounds-in-4-0)，但我还没有找到任何适用于 GWT 的解决方案。

你们有吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:55:26.817

这个问题有几种解决方案：

(1) 渲染文本，测量其宽度（myLabel.getOffsetWidth()，与所需宽度进行比较，如果不适合则更改字体大小并重新开始（请记住在调度程序的延迟命令中执行此操作，否则您的偏移宽度将为零）；

(2) 使用 FitText.js (http://fittextjs.com/)；

(3) 使用画布，可以将文本自动适应提供的空间；

(4) 文本溢出时使用省略号；

(5) 对文本字体使用视口单位（目前浏览器支持有限）：[http ://css-tricks.com/viewport-sized-typography/](http://css-tricks.com/viewport-sized-typography/)

(6) 创建一个不同的、更流畅的 UI 设计，以更好地处理内容大小。

# asp.net - MSBuild：Web 应用程序，一次构建，打包部署多次

> ID：13071540
> 
> 赞同：2
> 
> 时间：2012-10-25T15:04:01.507
> 
> 标签：asp.net, deployment, msbuild, packaging

我确定这个问题之前已经出现过，但我似乎无法找到一个优雅的解决方案。

我有一个基于部署环境（测试、QA、生产）的具有多种配置的 Web 应用程序项目，以及每个环境的 web.config 转换。我们正在使用 Web 部署包来自动创建可以通过 MSDeploy 部署的应用程序的 .zip。多次调用包目标很容易，每次都有不同的配置：

> msbuild MyProject.csproj /t:Package /p:Configuration=QA
> 
> msbuild MyProject.csproj /t:Package /p:Configuration=Test

但这会在每次打包之前触发 Web 项目的完整重建。我想构建一次，然后应用 web.config 转换，并为每个环境创建单独的包。有没有一种简单的方法可以在不强制对每个环境进行完全重建的情况下完成此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T19:13:22.413

使用msdeploy[和 Visual Studio 2012 重复构建一次并部署到多个环境](https://stackoverflow.com/questions/13170493/build-once-and-deploy-to-multiple-environments-with-msdeploy-visual-studio-201)

我也一直想要一个解决方案，但显然我所知道的没有任何真正的 COMPLETE MS 解决方案。Visual Studio 提供以下功能（如此[处](http://vishaljoshi.blogspot.com/2010/06/parameterization-vs-webconfig.html)所述）：

1.  Web.Config 转换
2.  参数化

Vishal Joshi 总结如下：

> 如果您可以在构建时了解您的环境设置，请使用 Web.Config 转换。
> 
> 如果您只想创建一次部署包，然后在安装时输入设置，请使用 Parameters.xml

不过，我希望看到的是两全其美。我想“打包”一个嵌入了**所有配置转换的目标。**因此，当 IT 人员运行 WebDeploy cmd 文件（在您“打包”时生成）时，他们可以提供他们想要的环境配置的切换（即 Dev、Test、Stage、Prod、Release 等）。我不相信 MS 有解决方案可以做到这一点。:(

# ruby-on-rails - 如何制作具有像 Devise 这样的应用程序布局的引擎？

> ID：13071542
> 
> 赞同：0
> 
> 时间：2012-10-25T15:04:02.983
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.1, devise, ruby-on-rails-3.2

我想做一个引擎。我的引擎可能是可安装的，也可能不是，这并不重要。但我想使用我的主要应用程序布局，如 Devise 来渲染引擎的视图。这也很容易。

**但！**当我的应用程序的布局和 Rails 引擎的视图模板呈现时，我遇到了一个异常，因为我在我的布局中使用了 url 助手，但是这个 url 助手在我的 main_app 中。所以我知道我可以在布局文件中的所有 url 助手之前编写一个 main_app 上下文，但我不想这样做。设计就是这样工作的。例如，如果您查看会话/新视图，则不必在应用程序布局中编写 main_app.pages_url。但我不知道他们是怎么做到的。我想知道它，我已经阅读了我已经阅读了文档的代码，但我什么也没找到。请有人告诉我他们是如何做到的。如何制作一个引擎来处理像 Devise 这样的 main_app url 助手。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T10:09:31.627

这取决于您的引擎类型。如果您的引擎包含该行`isolate_namespace SomeModule`，则意味着`url_helpers`（和一般的助手）不会在您的应用程序和引擎之间共享。所以你需要求助于诸如此类的工具`main_app`。

也就是说，Devise 共享布局所做的只是不调用`isolate_namespace`，这就是引擎在 Rails 2.2 中引入时的工作方式。该`isolate_namespace`功能是在 Rails 3.1 中添加的，供那些希望进行更强解耦的人使用。

# php - 用 PHP 解析 xml 如何处理这些字符

> ID：13071545
> 
> 赞同：2
> 
> 时间：2012-10-25T15:04:14.073
> 
> 标签：php, xml, encoding, xml-parsing

我正在使用 php 解析一个 xml 文档。

当我在浏览器中看到结果时，我得到以下字符：

Ã± 而不是西班牙语 ñ

Ã 而不是 í

ÃƒÂ¡ 代替 á

Ã³ 而不是 ó

é而不是é

我打算使用 str_replace 并将每个奇数字符替换为好字符，但遗憾的是，之前的模式仅偶尔发生，而且通常我有大量奇数字符 :(

xml标题是：

```
<?xml version="1.0" encoding="iso-8859-1"?> 
```

但是，如果我将其更改为 utf-8，则根本不会打印..

我使用 simplexml_load_string 将 xml 作为字符串加载（来自类似的数据库）

你能给我一些关于如何解决这个问题的想法吗？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:15:59.287

您有 2 个选项：

a)`header('Content-Type: text/html; charset=iso-8859-1');`在您的 php 文件中的任何输出之前包含 a 。

b) 将输出转换为 utf-8`$str = mb_convert_encoding($str, 'UTF-8', 'ISO-8859-1');`

两者都应该做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:10:15.120

`SimpleXML`使用 UTF-8 编码存储的字符串。您可以使用带有 iso-8859-1 的 XML 文件，但如果您想使用这种编码打印 XML 值，则必须先使用`utf8_decode`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:10:41.190

$string = preg_replace('/[\x00-\x1F\x80-\xFF]/', '', $string);

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-18T22:56:54.360

```
// new xml
$xml = new SimpleXMLElement('new.xml'); 

// Displaying XML in textual form
echo $xml->asXML(); 
```

# git - 可以为本地存储库创建 Git 参考存储库吗？

> ID：13071550
> 
> 赞同：2
> 
> 时间：2012-10-25T15:04:27.297
> 
> 标签：git

我可以通过 NFS 访问 Git 存储库，但我正在制作的克隆位于不同的挂载上，因此我无法创建指向它的硬链接。我宁愿不做一个完整的克隆，因为它需要大量的时间和磁盘空间。我可以使用参考克隆吗？这似乎很奇怪，因为参考存储库与目标相同。

```
git clone --reference=/path/to/repo /path/to/repo 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:06:16.333

您可以在指定工作树和/或 git repo 本身（的`.git`）时在其他地方进行操作

```
git --work-tree=/path/to/repo --git-dir=/path/to/repo/.git xxxx 
```

# backbone.js - Backbone.js 和渲染表

> ID：13071554
> 
> 赞同：2
> 
> 时间：2012-10-25T15:04:31.403
> 
> 标签：backbone.js

我是 Backbone.js 的新手，我遇到了一个真正的问题。我想列出成员的名字和姓氏并将它们放在一个表中。由于某些原因，我错过了一个重要的点并且它不起作用。我的代码：

```
var members = Backbone.Model.extend({
    urlRoot: "/get_members",
});

var member_collection = Backbone.Collection.extend({
    model : members,
    url : "/get_members",
});

var member_list_view = Backbone.View.extend({
    el : $('#members'),
    initialize : function() {
        this.collection.bind("add", this.render, this);
    },

    render: function() {
        var $tbody = this.$("tbody");
        _.each(this.model.models, function(data) {
            this.$el.append(new member_view({model : data}).render().el);
        }, this);
        return this;
    }
});

var member_view = Backbone.View.extend({
    tagName : "tr",
    template : _.template($("#member-template").html()),

    render : function() {
        this.$el.html(this.template(this.model.toJSON()));
        return this;
    }
});

var router = Backbone.Router.extend({
    routes : {"members" : "member_router"},
    member_router : function() {
        var member_colls = new member_collection();
        var member_viewer = new member_list_view({collection : member_colls});
        member_colls.fetch();
    }
}); 
```

我的 HTML：

```
<script type="text/template" id="member-template">
<table id="members">
  <thead>
    <tr><td>Firstname</td><td>Lastname</td></tr>
  </thead>
  <tbody>
    <tr><td><%= firstname %></td><td><%= lastname %></td></tr>
  </tbody>
</table>
</script> 
```

任何帮助是极大的赞赏。谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:37:45.150

行。上面的代码有很多问题：

1) 模板`member-template`

您使用成员模板，`member_view`但它包含整个表，而不仅仅是成员行。你的模板应该是这样的：

```
<script type="text/template" id="member-template">
    <td><%= firstname %></td><td><%= lastname %></td>
</script>​ 
```

2）`member_list_view`有`this.collection.bind`同时`render()`使用`this.model.models`

你应该让它保持一致：

```
var member_list_view = Backbone.View.extend({
    el : $('#members'),
    initialize : function() {
        this.model.bind("add", this.render, this);
    },

    render: function() {
        _.each(this.model.models, function(data) {
            this.$el.append(new member_view({model : data}).render().el);
        }, this);
        return this;
    }
}); 
```

**有关代码的完整工作版本，请[查看此 JSFiddle](http://jsfiddle.net/T6rYw/)**

# cloudbees - Enterprise Jenkins HA 插件无法正常工作

> ID：13071562
> 
> 赞同：4
> 
> 时间：2012-10-25T15:05:14.127
> 
> 标签：cloudbees

我一直在尝试使用高可用性设置来设置 Enterprise Jenkins。当前的设置包括两个 jenkins master 共享同一个 jenkins home，比如 master1 和 master2，在这两个 master 上安装 jenkins-ha-monitor-1.1-1.1 rpm，比如 monitor1 和 monitor2。使用此设置，至少根据文档，HA 插件应该可以按预期工作。升级和降级脚本与文档中的类似（只是ip和接口不同，方法相同）。IE

降级

> ifconfig eth0:2 关闭

用于促销

> ifconfig eth0:2 the.floating.ip

现在要正确注册节点，我必须按顺序启动 master1、master2、monitor1 和 monitor2。跟踪两者的日志，我看到当服务以该顺序启动时，它们被两个监控服务正确注册为集群中的节点，并在 jenkins 控制台的 HA 状态 gui 中正确注册。

现在，当 master1 通过发送 KILL 信号被杀死时，monitor2 会识别到这一点并运行升级脚本。但是监视器一直在抛出：

> 2012 年 10 月 24 日下午 3:47:36 com.cloudbees.jenkins.ha.singleton.HASingleton$3 可疑信息：怀疑集群中的节点故障：jenkins-master-1-285 2012 年 10 月 24 日下午 3:47:39 com.cloudbees.jenkins.ha.singleton.HASingleton$3 可疑信息：怀疑集群中的节点故障：jenkins-master-1-285

连续不断地运行降级脚本。现在由于 master2 通过其提升脚本占用了浮动 ip，而 master1 仍然拥有该 ip，因为降级脚本未运行，因此设置最终会出现两个声称相同 ip 的框。此外，重启master1并没有做任何事情，即master1没有作为辅助节点添加到集群中，monitor1仍然不断吐出上述消息记录，浮动ip不断返回“无法连接”，master2和monitor2显示集群为master2、monitor2 和 monitor1。所以我的问题/问题是双重的 - 为什么 master1 没有被接受回集群？为什么降级脚本没有按应有的方式运行？

另外仅供参考我已经尝试过

> 詹金斯服务站

在这种情况下，降级脚本会运行，但是当

> 服务詹金斯开始

在之前停止的主服务器上运行，因为无论是否存在主 jenkins 都会运行升级脚本。在这种情况下，两个监视器注册不同的集群，例如 monitor1 : master1,monitor1 和 monitor2 : master2,monitor2。运行 ifconfig 显示此时两个 master 都占用了浮动 ip。

任何帮助表示赞赏！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T16:18:00.317

在支持下仍在调查中。最初报告的问题（此处）表明两个节点通信正常，但升级/降级运行不正确——JGroups 中的错误或其在 Jenkins 高可用性中的使用。

But further tests turned up problems with UDP multicast communication, which has been reported for RedHat/CentOS hosts. Work is underway to offer an alternate JGroups stack which does not rely on multicast (or UDP) at all, using the shared `$JENKINS_HOME` directory to register Jenkins and monitor instances (as TCP address:port records).

# sql-server - HAVING 子句 SQL Server 2008 中的派生表与相关子查询

> ID：13071566
> 
> 赞同：1
> 
> 时间：2012-10-25T15:05:22.250
> 
> 标签：sql-server, sql-server-2008, tsql

在此示例中，我只有两个正在使用的表。我正在检查哪个可能运行得更快并且执行计划是相同的。这些查询的目的是查找与一个记录关联的最小日期，该日期大于另一个记录的最大日期。第一个查询更简洁（尽管它不允许`DATEDIFF`第二个查询的列）。从长远来看，我觉得第二种方式编写查询会在性能方面更加昂贵，也许当我有很多连接时。是否有关于哪种方法的一般规则，或者是逐案场景，您让优化器解决？

第一的

```
select c.patid,min(c.admitDate) as minDiabetesDate
    from clm_extract as c
    inner join icdClm as ic on ic.clmid=c.clmid
    where ic.icd like '250%' 
    group by c.patid
    having min(c.admitdate) > 
    (
        select MAX(c2.admitDate) as maxPreDiabetesDate
            from clm_extract as c2
            inner join icdClm as ic2 on ic2.clmid = c2.clmid
            where ic2.icd ='79029' and c2.patid=c.patid
            group by c2.patid
    ) 
```

第二

```
select distinct x.patid,x.minDiabetesDate,y.maxPreDiabetesDate 
from
(   

select c.patid, min(c.admitdate) as minDiabetesDate
    from clm_extract as c 
    inner join icdClm as ic on ic.clmid=c.clmid
    where ic.icd like '250%'
    group by c.patid
)x
inner join 
(
select c2.patid, MAX(c2.admitdate) as maxPreDiabetesDate
    from clm_extract as c2
    inner join icdClm as ic2 on ic2.clmid=c2.clmid
    where ic2.icd ='79029'
    group by c2.patid
)y on x.patid=y.patid
group by x.minDiabetesDate,y.maxPreDiabetesDate,x.patid
having DATEDIFF(dd,y.MaxPreDiabetesDate,x.minDiabetesDate) > 0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T16:05:25.487

您已经观察到这两个查询具有相同的执行计划。这并不奇怪。SQL 是*描述性*语言而不是*过程性*语言。也就是说，语言描述的是正在生产的东西，而不是生产它的方法。

当您执行一条`in`语句或`exists`带有子查询的语句时，您*正在*执行连接。语法不同，但逻辑处理是一样的。这只是表达联接的另一种方式。引擎需要考虑一些差异。`distinct`例如，“IN”在子查询上进行隐式连接。

作为偏好，我更喜欢第二个版本。`from`如果可能，我喜欢在子句中提到的查询中使用表。

在考虑您的查询之后，有一种更简单的方法来编写它：

```
select c.patid,
       min(case when ic.icd like '250%' then c.admitDate end) as minDiabetesDate,
       MAX(case when ic.icd = '79029' then c.admitDate end) as maxPreDiabetesDate
from clm_extract c
     inner join
     icdClm ic
     on ic.clmid=c.clmid
where ic.icd like '250%' or ic.icd = '79029' 
group by c.patid
having MAX(case when ic.icd = '79029' then c.admitDate end) <
       min(case when ic.icd like '250%' then c.admitDate end) 
```

这将`case`语句与聚合函数结合使用来计算您想要的日期。顺便说一句，您`datediff`在`having`子句中使用了 a 。这对于简单的比较是不必要的。您可以只使用“=”、“<”等来比较日期。

# javascript - 处理：形状如何形成文本？

> ID：13071583
> 
> 赞同：0
> 
> 时间：2012-10-25T15:06:07.943
> 
> 标签：javascript, html, canvas, processing

我想知道这是如何制作的：[http ://workshop.chromeexperiments.com/examples/gui/#1--Basic-Usage](http://workshop.chromeexperiments.com/examples/gui/#1--Basic-Usage)

这些点形成一个文本，当点击时，它们会爆炸。

形状如何形成文本？我可以用 processing.js 实现这一点吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T15:55:26.630

我不确定您是要在处理中还是在 javascript 中编写它。这是一个 javascript 库，因此您可以在 javascript 上下文中使用它。要使其处理并使用 processingjs 在 Web 上显示它，您必须使用处理资源来实现相同的结果或设法将数据从/传递到 javascript 和处理。有一个来自 processingjs 站点的[示例](http://processingjs.org/articles/PomaxGuide.html#interface)，用于将您的页面与处理草图连接起来。请注意 processingjs 不支持使用处理库，因此您不能在此工作流程中使用任何[Precessing 排版库。](http://processing.org/reference/libraries/#typography_geometry)我认为它们可能非常方便......

至于如何在处理中执行此操作，我想我会在未显示的 PGraphics 中绘制字母，并在此表面上使用像素颜色测试来驱动圆圈的绘制。这将允许在运行时更改文本。就像，在伪代码中

```
PGraphics matteImage = new PGraphics(size, size, render);//
matteImage.background(black);
matteImage.fill(255);
matteImage.text("A", x,y);
matteImage.loadPixels();

for(i; i < matteImage.length;i++)
{
 color c = matteImage.pixels[i];
  if ( c == white)
{
   doDrawEllipses();
}  
} 
```

在画圈方法/类中，我会添加一些噪音/随机性，爆炸句柄......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:10:55.670

我想一种方法是为每个角色建立一个模型。例如，通过形状手动创建字母“A”。然后对于消息中的每个字母，您将显示字母的字符模型

# validation - primefaces 编辑器的验证

> ID：13071587
> 
> 赞同：3
> 
> 时间：2012-10-25T15:06:22.817
> 
> 标签：validation, jsf-2, primefaces

我对 primefaces 编辑器的第一个问题是它不接受来自 chrome 和资源管理器中的 MS word 文档的文本，但在 Firefox 中可以正常工作。有没有办法直接接受 MS word 中的内容，而不是在`p:editor`.

我的代码如下所示：

```
 <p:editor id="courseSummary" value="#{course.courseSummary.courseSummary}"    required="true" requiredMessage="#{messageBundle['productManagement.product.descriptionRequired']}"/> 
```

我的第二个是我输入了一些包含多行的字符串值，然后按下保存，将值存储到我的支持 bean 中。然后，如果我在 UI 上手动清除我的编辑器，并且如果我不清除这些行，则它不会验证，而是`courseSummary`作为 br/>存储到字符串中
。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2019-05-30T19:11:48.943

CKeditor 连同一些 java 脚本和 FacesContext 应该替换 p:editor。支持从 MSWord 和 HTML 内容复制。

```
 FacesContext fc = FacesContext.getCurrentInstance();       
 Map<String,String> params = fc.getExternalContext().getRequestParameterMap();
 reviewCommentsText = params.get("myObj"); 
```

# jquery - jquery 日期时间选择器

> ID：13071588
> 
> 赞同：3
> 
> 时间：2012-10-25T15:06:26.373
> 
> 标签：jquery, jquery-ui, jquery-plugins, datetimepicker, timepicker

我对 Trent Richardson 的日期和时间选择器（[链接](http://trentrichardson.com/examples/timepicker/)）有疑问。时间选择器现在会弹出。完全不工作。

我的代码：

jQuery 包括：

```
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.0/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script src="http://code.jquery.com/ui/1.9.0/jquery-ui.js"></script>
<script src="http://mydomain.org/folder/wp-content/themes/twentyeleven/jquery/development-bundle/ui/jquery-ui-timepicker-addon.js"></script> 
```

对于函数调用，我有：

```
<script>
$('#datumodhoda').datetimepicker({
timeFormat: "h:m t",
ampm: true
});
</script> 
```

有什么问题？其他 jquery 调用正常工作。新插件的路径是正确的，浏览器会加载它（用萤火虫检查）。

一个多星期以来一直有这个问题。

如果有人帮助我会很高兴，谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T23:20:33.040

这个版本好像坏了。看看[这个](http://web.archive.org/web/20130509002354/http://timjames.me/themes/timjames.me/scripts/libs/jquery-ui-timepicker.js)版本。为我工作。

*原始链接已失效。当前使用 WayBackMachine。*

# ruby - 我可以在 MacVim 中运行 bundle open 命令吗？

> ID：13071589
> 
> 赞同：1
> 
> 时间：2012-10-25T15:06:34.427
> 
> 标签：ruby, vim, bundler

当我在终端中发出`bundle open`命令时，“vi”编辑器出现了，但它似乎没有我习惯的所有默认值和设置，而且它看起来也相当难看。有没有办法`bundle open`在终端外的 MacVim 中启动，或者我可以`bundle open`在 MacVim 中发布它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:12:34.567

您可以`bundle open`为您将文件发送到 MacVim。首先，你需要确保`mvim`安装了 MacVim 自带的脚本；[这里](https://github.com/b4winckler/macvim/wiki/FAQ)的说明。

然后，正如@Randy Morris 在评论中所说，您需要将 EDITOR 环境变量设置为`mvim`. 您可以将其添加到您`.bash_profile`的主目录中的文件中以使其永久化；几乎每个启动编辑器的 Unix 命令都会使用它。

# delphi - 用省略号缩短 Firemonkey 中的标签

> ID：13071591
> 
> 赞同：4
> 
> 时间：2012-10-25T15:06:38.777
> 
> 标签：delphi, firemonkey, ellipsis, delphi-xe3

Firemonkey中是否有用于缩短按钮或标签文本的省略号/省略例程？例如，转：

**"C:\a really\really\really long\very long path\even long path name"** 转换为 **"C:\a really\re..."** 或 **"C:\a really\re...path name"**

VCL 有一些例程，但看起来查找 Firemonkey 的文本大小会更复杂。

我在 Delphi XE3 上使用 Firemonkey 2

提前致谢

...好吧，我根据 Mike Sutton 的建议创建了一个笨重的程序。它只在字符串第一部分的末尾添加省略号，但可以很容易地修改中间或结尾省略号的位置。它还考虑了当前对象的字体大小和样式。

用法是：

```
ShortenText(Button1, 'Start of text blah blah blah blah the END is here');

procedure ShortenText(anFMXObject: TTextControl; newText: string);
var
  aTextObj: TText;
  shortenTo: integer;
  modText: string;
begin
  if Length(newText) > 2 then
  begin
    modText:= newText+'...';
    aTextObj:=TText.Create(anFMXObject.Parent);
    aTextObj.Font.SetSettings(anFMXObject.Font.Family,
                          anFMXObject.Font.Size,
                          anFMXObject.Font.Style);
    aTextObj.WordWrap:= false;
    aTextObj.AutoSize:= true;
    aTextObj.Text:= newText;
    // this next bit generates the change necessary to redraw the new text (bug in XE3 as of Oct 2012)
    aTextObj.HorzTextAlign:= TTextAlign.taCenter;
    aTextObj.HorzTextAlign:= TTextAlign.taLeading;
    // now shorten the text:
    shortenTo:= round((Length(modText)/aTextObj.Width)*anFMXObject.Width)-1;
    modText:= LeftStr(modText, shortenTo-3)+'...';
    anFMXObject.Text:= modText;
    FreeAndNil(aTextObj);
  end;
end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:35:07.683

我建议使用 AutoSize 设置为 True 和 Wrap 设置为 False 的 TText 然后你可以简单地阅读 Width 属性。

请注意，XE3 中存在一个错误，并且在运行时设置 Text 属性不会更新内容，因此您需要手动调用 Realign （这是受保护的，因此您需要子类化 TText 以使其工作）。

# vb.net - vb.net 控制台应用程序只工作一次

> ID：13071593
> 
> 赞同：2
> 
> 时间：2012-10-25T15:06:38.993
> 
> 标签：vb.net, loops, console, readline

我刚刚学习在 vb.net 中编码，目前正在搞乱 VB.net 控制台应用程序。我一辈子都想不通。可能以前在这里被问过，但我无法通过搜索找到任何东西。我刚刚编写了一个简单的“检查是否输入了 Y 或 N。如果输入了 y/n，则显示“您已输入 y/n””程序，它第一次运行良好。但是，在第一次进入后，我无法重复该过程。我得到的只是空白。例如，如果我输入 y，我会得到相应的消息。但是，如果在那之后我输入 n 我什么也得不到。

这是代码：

```
Module Module1

Sub Main()

    Console.Title = "Hello"
    Console.WriteLine("Y or N")
    Dim line As String
    line = Console.ReadLine()
    Do Until line = "exit"
        If line = "y" Then
            Console.WriteLine("you have chosen y")
            Console.ReadLine()
        ElseIf line = "n" Then
            Console.WriteLine("you have chosen n")
            Console.ReadLine()
        End If
        line = ""
    Loop
End Sub

End Module 
```

我假设答案非常简单，但我似乎无法弄清楚或在线找到答案。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:09:59.273

您需要在 Do Loop中分配`Console.Readline()`给：`line`

```
Do Until line = "exit"
    If line = "y" Then
        Console.WriteLine("you have chosen y")
    ElseIf line = "n" Then
        Console.WriteLine("you have chosen n")            
    End If
    line = Console.ReadLine()
Loop 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:11:12.373

您必须将 Console.ReadLine() 的值存储在 Line 字符串中。

```
Module Module1

Sub Main()

    Console.Title = "Hello"
    Console.WriteLine("Y or N")
    Dim line As String
    line = Console.ReadLine()
    Do Until line = "exit"
        If line = "y" Then
            Console.WriteLine("you have chosen y")
        ElseIf line = "n" Then
            Console.WriteLine("you have chosen n")
        End If
        line = Console.ReadLine()
    Loop
End Sub 
```

端模块

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:10:38.347

这条线是你的问题：

```
line = "" 
```

您正在阅读控制台，但没有将其分配给您的变量。

应该是这样的：

```
Do Until line = "exit"
    If line = "y" Then
        Console.WriteLine("you have chosen y")
    ElseIf line = "n" Then
        Console.WriteLine("you have chosen n")
    End If
    line = Console.ReadLine()
Loop 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:10:38.380

您需要重新分配`line`从控制台读取的下一行，如下所示：

```
Module Module1

    Sub Main()

        Console.Title = "Hello"
        Console.WriteLine("Y or N")
        Dim line As String
        line = Console.ReadLine()
        Do Until line = "exit"

            If line = "y" Then
                Console.WriteLine("you have chosen y")
            ElseIf line = "n" Then
                Console.WriteLine("you have chosen n")
            End If

            line = Console.ReadLine()   ''here

        Loop
    End Sub

End Module 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T15:11:23.607

在你的循环中，你`Console.ReadLine()`没有对值做任何事情，然后你正在做`line = ""`. 您的循环以空行无限循环，并忽略用户输入。

删除这两行`Console.ReadLine()`，然后替换`line = ""`为`line = Console.ReadLine().`

# unity3d - 应用后处理着色器

> ID：13071599
> 
> 赞同：5
> 
> 时间：2012-10-25T15:06:55.057
> 
> 标签：unity3d, shader

我有一个灰度着色器，可以在应用于材质时工作。我想将它应用于相机渲染的内容。

我找到了一些关于 void OnRenderImage (RenderTexture source, RenderTexture destination) 的教程

但我无法让它和我的一起工作。

着色器：

```
Shader "Custom/Grayscale" {

SubShader {
    Pass{

        CGPROGRAM

        #pragma exclude_renderers gles
        #pragma fragment frag

        #include "UnityCG.cginc"

        uniform sampler2D _MainTex;

        fixed4 frag(v2f_img i) : COLOR{
            fixed4 currentPixel = tex2D(_MainTex, i.uv);

            fixed grayscale = Luminance(currentPixel.rgb);
            fixed4 output = currentPixel;

            output.rgb = grayscale;
            output.a = currentPixel.a;

            //output.rgb = 0;

            return output;
        }

        ENDCG
    }

}

FallBack "VertexLit"
} 
```

以及附加到相机的脚本：

```
using UnityEngine;
using System.Collections;

public class Grayscale : ImageEffectBase {

void OnRenderImage (RenderTexture source, RenderTexture destination) {
    Graphics.Blit (source, destination, material);
}
} 
```

有什么建议么 ？非常感谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-26T12:37:56.130

您必须添加一个顶点着色器，因为没有默认的顶点着色器。这只是从顶点缓冲区复制数据。

```
#pragma vertex vert
v2f_img vert (appdata_base v) {
    v2f_img o;
    o.pos = mul(UNITY_MATRIX_MVP, v.vertex);
    o.uv = v.texcoord;
    return o;
} 
```

**而且**你还需要`ZTest Always`在`Pass {`.

这显然是一个错误，但 Unity3d 支持人员表示他们以这种方式保留它（使用默认 ZTest）而不是改变着色器行为。我希望他们会重新考虑这一点，并使其`ZTest Always`默认用于`Graphics.Blit`.

# datasource - 数据源注入

> ID：13071607
> 
> 赞同：1
> 
> 时间：2012-10-25T15:07:26.640
> 
> 标签：datasource, code-injection, java-ee-5

我需要帮助来理解 DataSource 注入。

*   我已经在 WebSphere 服务器中定义了 jndi 数据源，并在控制台中测试了连接返回成功。

*   当我尝试在 servlet 中注入资源时

    `private @Resource(name = "jdbc/order_inquiry") DataSource ds;`

*   当代码试图从 ds 获取连接时，ds 为空。

    `Connection conn = ds.getConnection();`

我的问题是我需要在 web.xml 或其他配置文件中添加任何内容吗？

# android - android java的libspotify 12是否存在任何lib？

> ID：13071610
> 
> 赞同：5
> 
> 时间：2012-10-25T15:07:35.017
> 
> 标签：android, spotify

我想将 libspotify 集成为声音/播放器服务，并将 spotify 集成到一个以上的 java 应用程序中。

任何人都可以建议我任何库或任何代码示例让我开始吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-26T08:04:24.210

*免责声明：我为 Spotify 工作*

目前，Spotify 没有一个很好的用于 libspotify 的 Java 包装器，但这绝对是我们将来考虑做的事情。我无法估计它何时可用，所以如果你渴望开始编写与 Spotify 集成的应用程序，你应该使用原生编译的 Android 版 libspotify，而不是等待 Java 包装器。

当前使用 libspotify 进行 Android 工作的首选方式是使用可在[libspotify 网站](https://developer.spotify.com/technologies/libspotify/)上找到的本机编译库。您必须围绕它编写自己的 JNI 包装器，这可能有点棘手，但绝对不是不可能完成的任务。:) 不幸的是，在 Android 下使用 libspotify 的文档有点缺乏。同样，这是 Spotify 正在努力改进的东西。

[有一个名为jlibspotify](http://code.google.com/p/jlibspotify/)的第三方项目，它提供了一个围绕 libspotify 的 Java 包装器。我个人以前没有使用过它，所以我不能评论这个项目有多好，但如果我没记错的话，它是基于旧版本的 libspotify，所以你最好选择上面详述的 JNI 路线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-07T16:13:54.010

我注意到那里还有[libjahspotify](https://github.com/nvdweem/libjahspotify)，它似乎比 jlibspotify 更新。我还没有尝试过。

# c# - 未调用从 AuthorizeAttribute 覆盖 AuthorizeCore

> ID：13071615
> 
> 赞同：5
> 
> 时间：2012-10-25T15:07:59.313
> 
> 标签：c#, asp.net-mvc, security

出于某种原因，只有方法`OnAuthorization`被调用，而`AuthorizeCore`不是。
这就是我所说的：

```
[AuthorizeWithRoles(Roles = "Affiliate")]
public string TestOnlyAffiliate()
{
     return "ok";
} 
```

这是实际的属性。

```
public class AuthorizeWithRolesAttribute : AuthorizeAttribute
{

    public string Roles { get; set; }

    //
    //AuthorizeCore - NOT INVOKING!
    //
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        return true;
    }
    public  void OnAuthorization(AuthorizationContext filterContext)
    {

    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-21T15:12:24.147

你不应该覆盖`OnAuthorization`. 它处理潜在的缓存问题和调用`AuthorizeCore`。

[http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/1acb241299a8#src/System.Web.Mvc/AuthorizeAttribute.cs](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/1acb241299a8#src/System.Web.Mvc/AuthorizeAttribute.cs)

```
// In the worst case this could allow an authorized user
// to cause the page to be cached, then an unauthorized user would later be served the
// cached page. 
```

将您的自定义逻辑放入`AuthorizationCore`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-20T20:17:22.493

不确定这是否对您有帮助，但我遇到了同样的事情并确定，至少就我的目的而言，我根本不需要覆盖 AuthorizeCore。老实说，我不确定它为什么会在那里。正如 MSDN 所说，“当进程请求授权时”会调用 OnAuthorization。这意味着它将为具有您的 AuthorizeWithRoles 属性的任何方法调用。您可以将自定义代码放在 OnAuthorization 中以检查用户是否具有权限，并且由于您可以从 filterContext 获取 httpContext，因此实际上不需要 AuthorizeCore。这是一个对我有用的简单示例：

```
public class LoginRequired : AuthorizeAttribute
{
    public override void OnAuthorization(AuthorizationContext filterContext)
    {
        if (Common.ValidateCurrentSession(filterContext.HttpContext))
        {
            //this is valid; keep going
            return;
        }
        else
        {
            //this is not valid; redirect
            filterContext.Result = new RedirectResult("/login");
        }
    }
} 
```

我希望这会有所帮助。除此之外，显然您需要声明 OnAuthorization 是一个覆盖。

编辑：我相信基本的 OnAuthorization 方法是调用 AuthorizeCore 的方法。由于您正在覆盖 OnAuthorization，显然该调用丢失了。我相信仅当您单独离开 OnAuthorization 或在被覆盖的方法中调用 base.OnAuthorization(filterContext) 时，覆盖 AuthorizeCore 才有意义。

# javascript - FancyBox 上的关闭按钮不起作用

> ID：13071616
> 
> 赞同：2
> 
> 时间：2012-10-25T15:08:03.840
> 
> 标签：javascript, jquery, html, fancybox

当我单击 FancyBox 的关闭按钮时，什么也没有发生。只有当我在框架外单击时它才会关闭。我怎样才能让关闭按钮工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:11:35.633

只需致电`$.fn.fancybox.close()`或`$.fancybox.close(true)`在您的 onClick 事件上

# c - Visual C++ 2010 堆损坏

> ID：13071621
> 
> 赞同：1
> 
> 时间：2012-10-25T15:08:14.937
> 
> 标签：c, linked-list, free, heap-corruption, memory-corruption

我的代码中有一些链接列表。每个链表是 C 代码中大型结构的一部分，它是函数的局部变量。该代码使用另一个函数来填充列表，执行一些其他操作，然后调用第三个函数来打印和删除它。第一个节点不需要删除。

**问题：** 该函数正确打印所有数据，因此没有悬空指针等。但是当我尝试释放内存时，出现堆损坏错误。引发此错误的代码示例是：

```
flag = 0;

while( stpBS_current != NULL && stpFlags_current != NULL ){
// Linked list printing code is removed for clarity
    if( flag == 1 ){
        stpPrev = stpBS_current;
        stpFlags_prev = stpFlags_current;

        stpBS_current = (struct BasicService *)stpBS_current->pNext;
        stpFlags_current = (struct BasicService_Flags *)stpFlags_current->pNext;

        free( stpPrev );
        free( stpFlags_prev );
    }
    else
    {
        stpBS_current = (struct BasicService *)stpBS_current->pNext;
        stpFlags_current = (struct BasicService_Flags *)stpFlags_current->pNext;

        flag = 1;
    }
} 
```

`stpPrev`和`stpFlags_prev`是局部变量，`stpBS_current`在`stpFlags_current`打印/删除函数中作为参数传递。执行强制转换是因为原始链表具有`void *`. 由于相同的函数正确打印了所有存储的数据，并且该内存尚未在其他地方释放，所以我确定指针是正确的。

我在这里完全不知所措。Google 上的所有内容都与缓冲区溢出有关，但我确信情况并非如此。我正在使用 MS Visual C++ 2010，它显示的错误是：

> Windows 在 ZTE Parser [24.04.2012].exe 中触发了断点。
> 
> 这可能是由于堆损坏，这表明 ZTE Parser [24.04.2012].exe 或其已加载的任何 DLL 中存在错误。
> 
> 这也可能是由于用户在 ZTE Parser [24.04.2012].exe 具有焦点时按 F12。

当然我没有按F12，所以这是不可能的。如果我忽略第一个错误并继续代码的执行，那么在它返回之前我会从同一次调用中得到几个断言失败，`free()`并最终得到：

![MS VS 2010 堆损坏快照](../Images/229b53b7809224c86962f9b52a9924ed.png)

空指针是罪魁祸首吗？但毕竟 malloc() 和 free() 使用 void 指针，所以 IMO 这应该不是问题。我相信堆是一个全局内存，所以在不同的函数中分配和取消分配应该不是问题。

分配内存的代码很简单（2个链表）。为了清楚起见，我删除了头节点初始化代码：

```
stpBSC_current->pNext   =   malloc( sizeof(struct BasicServiceCode) );
stpFlags_current->pNext =   calloc( 1, sizeof(struct BasicServiceCode_Flags) );

if( stpBSC_current->pNext == NULL || stpFlags_current->pNext == NULL )
    exit( 1 );
else
{
    stpBSC_current      =   (struct BasicServiceCode *)stpBSC_current->pNext;
    stpFlags_current    =   (struct BasicServiceCode_Flags *)stpFlags_current->pNext;
} 
```

我认为如果内存分配或链接列表管理中存在任何漏洞，那么在打印列表时应该出现错误，或者至少某些数据必须作为垃圾出现，但它工作得很好。当我尝试释放内存时出现错误。任何帮助和想法将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T08:09:29.057

结果表明标志条件不正确（问题中未显示某些打印代码）。

**原因：**试图`free()`释放没有使用分配的头节点`malloc()`。这是一个静态分配的变量。因此，从技术上讲，这并不是最初错误所暗示的堆损坏，而是指定的断言失败错误，`free()`它试图释放位于堆缓冲区开始*之前的一些内存，当然是在堆栈上。*这是导致错误的原因。

@everyone 感谢您的帮助和建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:11:18.627

仅仅因为您可以打印数据并不意味着您没有损坏堆。当您释放内存时，数据会一直保留在那里，直到内存被再次分配并被覆盖。因此，您的链表可能包含指向已释放内存的指针，您仍然可以读取它，但稍后会遇到问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-27T08:17:41.507

这几乎肯定是由缓冲区溢出引起的：这会导致您的代码覆盖堆控制信息，这些信息可能存储在您分配的内存块之前和/或之后。在您尝试释放内存之前，可能不会检测到此类错误。

需要考虑的事项：

如果您正在解析数据（正如程序名称所暗示的那样），您确定将解析后的输入复制到的缓冲区足够大吗？

结构 BasicServiceCode 和 BasicServiceCode_Flags 是否包含任何 C 样式的字符串？如果是这样，您很可能会遇到缓冲区溢出。特别注意空终止符。

# c# - 是否有 api 或扩展来翻译 IQueryable lambda 表达式到 SQL 字符串？

> ID：13071622
> 
> 赞同：9
> 
> 时间：2012-10-25T15:08:21.670
> 
> 标签：c#, linq, linq-to-sql, iqueryable

我正在阅读一篇关于[Linq to Sql](http://weblogs.asp.net/dixin/archive/2010/05/12/understanding-linq-to-sql-10-implementing-linq-to-sql-provider.aspx)的文章并遇到了这个问题：

```
IQueryProvider provider = new QueryProvider(database.GetCommand, database.ExecuteQuery);
IQueryable<Product> source = new Queryable<Product>(provider, database.GetTable<Product>());
IQueryable<string> results = source.Where(product => product.CategoryID == 2)
                                   .OrderBy(product => product.ProductName)
                                   .Select(product => product.ProductName)
                                   .Skip(5)
                                   .Take(10); 
```

然后作者将结果翻译成纯 sql：

```
exec sp_executesql N'SELECT [t1].[ProductName]
FROM (
SELECT ROW_NUMBER() OVER (ORDER BY [t0].[ProductName]) AS [ROW_NUMBER], [t0].[ProductName]
FROM [dbo].[Products] AS [t0]
WHERE [t0].[CategoryID] > @p0
) AS [t1]
WHERE [t1].[ROW_NUMBER] BETWEEN @p1 + 1 AND @p1 + @p2
ORDER BY [t1].[ROW_NUMBER]',N'@p0 int,@p1 int,@p2 int',@p0=2,@p1=5,@p2=10 
```

我心想，“天啊！如果有一个 IQueryable 的扩展可以在调试时为你生成这些字符串，那不是很好吗？”

任何人都听说过这样的事情，如果是这样，你能指出我正确的方向吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:24:43.420

使用 Linq to Sql 您可以调用`query.Provider.ToString()`，这将返回查询文本（顺便说一句，您可以在调试时在 Visual Studio 中查看相同的属性）。

更新：（复杂部分）它是如何实现的？

实际的字符串生成是按`System.Data.Linq.SqlClient.SqlProvider`类完成的。它有 hidden 方法`string IProvider.GetQueryText(Expression query)`，它基于传递的表达式构建 SQL 查询文本。这个方法被内部接口隐藏了`IProvider`，所以调用它并不是一件小事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:10:40.223

我认为[Linqpad](http://www.linqpad.net/)可以用来在 SQL 和 Linq 之间进行转换，希望对您有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T15:14:00.750

您可以将该[`DataContext.Log`](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.log.aspx)属性设置为`TextWriter`（例如`Console.Out`）以查看*生成*的 SQL ，但我认为这不会让您在*不执行 SQL 的情况下输出它*。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T15:56:32.993

一个可怕的hacky解决方案：

`DataContext.Log`如前所述使用，但只需将所有内容包装在事务中并回滚。;p

# django - django 表单包含 stackoverflow 样式的标签输入

> ID：13071623
> 
> 赞同：0
> 
> 时间：2012-10-25T15:08:23.000
> 
> 标签：django, forms, django-forms

您将如何创建包含此类输入的表单？它需要能够处理多个输入（未定义的数字），那么您使用哪种字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:14:26.350

这是一个[预先输入](http://en.wikipedia.org/wiki/Typeahead)的变体。网络上有许多“操作方法”和免费赠品。您需要对 HTML 表单和 Javascript 有基本的了解。

这是 Twitter 的一个流行示例：[Bootstrap Typeahead](http://twitter.github.com/bootstrap/javascript.html#typeahead)

# java - JFace 向导：如何让进度条不禁用向导 GUI

> ID：13071624
> 
> 赞同：2
> 
> 时间：2012-10-25T15:08:29.347
> 
> 标签：java, user-interface, progress-bar, jface, wizard

我有一个向导，我需要在后台运行一个作业。我希望进度条显示作业正在运行的事实，但同时，我不希望向导的 GUI 组件被禁用。换句话说，我想在进度条在后台显示作业时继续使用向导。可能吗？

谢谢大家会帮助我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:23:25.150

你可以，你只需要确保你启动一个新的 Job 来做后台工作，但是 UI 更新仍然发生在 UI 线程中：

```
 Job job = new Job("name") {
        @Override
        protected IStatus run(IProgressMonitor monitor) {
            // Do some work

            Display.getDefault().asyncExec(new Runnable() {
                @Override
                public void run() {
                    // Update UI
                }});
            return Status.OK_STATUS;
        }
    };
    job.schedule(); 
```

# sql - 如何在 SELECT 中没有列的情况下按顺序排序

> ID：13071625
> 
> 赞同：4
> 
> 时间：2012-10-25T15:08:31.907
> 
> 标签：sql, sql-server

我正在使用 MS-SQL，我有一个这样的表：

```
Count  Code
1      A
2      C
3      A
4      B
5      C
6      B 
```

我只需要获取代码列的不同行，但我需要保持列的顺序来创建一个逗号分隔的字符串，如下所示：

```
 A, C, B 
```

我尝试使用以下代码未收到消息 145、级别 15 的 SQL 错误 - 如果指定了 SELECT DISTINCT，则 ORDER BY 项必须出现在选择列表中。

```
SELECT @tlist = ISNULL(@tlist+', ','') + Code 
FROM (SELECT DISTINCT t.Code  
     FROM @Table t) 
```

但我得到 A、B、C 的输出

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:20:37.990

所以，你不想要`distinct`. 你想要`group by`：

```
select t.code
from @Table t
group by t.code
order by min(count) 
```

您可以按`select`子句中未提及的列排序。

要将逗号分隔的列表作为单个变量获取，请使用以下技术：

```
select stuff((select ', '+t.code
              from @Table t
              group by t.code
              order by min(count)
              for xml path ('')
             ), 1, 2, '') 
```

`Order by`在子查询中通常是未定义的。而且，您将列表按顺序连接在一起的方法不能保证有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T15:10:06.680

在您的子查询中订购它们

```
SELECT DISTINCT t.Code  
FROM @Table t
ORDER BY t.Code 
```

# visual-studio-2012 - Visual Studio：在哪里可以找到“浏览”？

> ID：13071632
> 
> 赞同：0
> 
> 时间：2012-10-25T15:09:19.603
> 
> 标签：visual-studio-2012

我已经安装了 Visual Studio 2012，并在新版本中打开了 2010 年的项目。但是当我运行我的网络应用程序时，它会在 Chrome 中运行。在 2010 中，您可以右键单击该项目并选择“浏览方式”来更改网络浏览器。在 2012 中，它不在右键菜单中，而是在工具栏中： ![在此处输入图像描述](../Images/b954263afd4a6d866d96af2424aa449d.png)

但是我没有这个工具栏，也找不到。有人可以帮我找到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:14:02.023

“我没有这个工具栏”是什么意思？
去这里`View`-> `Toolbars`->`Standard`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:54:37.610

您必须在解决方案资源管理器中选择正确类型的文件（aspx、html、cshthml 等），才能看到工具栏。

# mysql - 将子查询转换为连接以提高性能

> ID：13071634
> 
> 赞同：0
> 
> 时间：2012-10-25T15:09:29.743
> 
> 标签：mysql, join, subquery

我接手了一个大项目，随着数据库越来越大，部分代码停止工作，

这是查找`rendering_requests`最后一个`rending_log`的查询`pending`，有时有一些日志条目没有状态变化并记录下来，因为`noaction`我们不需要统计它们。这就是我从查询中了解到的。

```
SELECT
    COUNT(rr.rendering_id) AS recordCount
FROM
    rendering_request rr, rendering_log rl
WHERE
    rl.rendering_id = rr.rendering_id 
AND rl.status = 'pending'   AND
    rl.log_id = (
            SELECT rl1.log_id
            FROM rendering_log rl1
            WHERE 
            rl.rendering_id = rl1.rendering_id  AND 
            rl1.status = 'pending' 
            AND rl1.log_id = (
                SELECT rl2.log_id
                FROM rendering_log rl2
                WHERE rl1.rendering_id = rl2.rendering_id AND rl2.status!='noaction'
                ORDER BY rl2.log_id DESC LIMIT 1
                    )
            ORDER BY rl1.log_id DESC
            LIMIT 1
            ) 
```

例如

`rendering_id=1`有多个日志

```
status=noaction
status=noaction
status=pending 
```

和

`rendering_id=2`有多个日志

```
status=noaction
status=assigned
status=noaction
status=pending 
```

当我们运行这个查询时，它应该`count=1`只显示`rendering_id=1`我们想要的记录。

现在这个查询已经停止工作，它挂起 mysql 服务器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:40:37.417

不是 100% 确定我做对了，但是像这样。认为您仍然需要使用几个子选择，但是（取决于 MySQL 的版本）以这种方式使用 JOIN 应该会快得多

```
SELECT COUNT(rr.rendering_id) AS recordCount
FROM rendering_request rr
INNER JOIN rendering_log rl
ON rl.rendering_id = rr.rendering_id 
INNER JOIN (SELECT rendering_id, MAX(log_id) FROM rendering_log  WHERE status = 'pending' GROUP BY rendering_id) rl1
ON rl1.rendering_id = rl.rendering_id 
AND rl1.log_id = rl.log_id
INNER JOIN (SELECT rendering_id, MAX(log_id) FROM rendering_log  WHERE status!='noaction' GROUP BY rendering_id) rl2
ON rl2.rendering_id = rl1.rendering_id 
AND rl2.log_id = rl1.log_id
WHERE rl.status = 'pending' 
```

# mysql - 无法更新存储函数/触发器中的表“tbl”，因为它已被调用此存储函数/触发器的语句使用

> ID：13071643
> 
> 赞同：0
> 
> 时间：2012-10-25T15:09:48.813
> 
> 标签：mysql, sql, mysql-error-1442

```
 INSERT INTO `category_sport` (
`id` ,
`category_id` ,
`sport_id` ,
`ordering`
)
VALUES (
NULL , '1', '1', ''
) 
```

我想要做的是手动向表中添加几行以进行测试。但是当我尝试添加时，它给了我以下错误

**#1442 - 无法更新存储函数/触发器中的表“tbl”，因为它已被调用此存储函数/触发器的语句使用。**

表结构

![表结构](../Images/730199045d37e6d9f2fe5682ea83c833.png)

扳机

```
CREATE TRIGGER `update_category_sport_order` AFTER INSERT ON `category_sport`
FOR EACH
ROW UPDATE `category_sport` SET `ordering` = NEW.id WHERE `id` = NEW.id; 
```

如何添加数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:18:28.940

尝试用 scope_identity() 替换 NEW.id

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T11:30:33.597

不得不手动编写 PHP 代码来解决这个问题。

[http://forums.mysql.com/read.php?99,122354,240978#msg-240978](http://forums.mysql.com/read.php?99,122354,240978#msg-240978)

# block - 阻止来自 google seacrch 的特定文件类型

> ID：13071644
> 
> 赞同：0
> 
> 时间：2012-10-25T15:09:55.103
> 
> 标签：block, robots.txt

我想阻止来自 Google bot 的 XML 文件，但 sitemap.XML 除外。我正在为我的 WordPress 图片库使用 Lazyest Gallery。每个画廊文件夹都有一个包含图像详细信息的 XML 文件。问题是，现在谷歌索引这些 XML 文件而不是画廊。我的站点搜索还显示 XML 文件而不是专辑。将要

```
Disallow: /*/*.xml$ 
```

工作？

我通过添加排除了提要

```
Disallow: /*/rss/$ 
```

到我的 robots.txt

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T04:13:46.000

要阻止某种类型的所有文件，最简单的方法是：

```
Disallow: /*.xml$
Disallow: /*.XML$ 
```

Robots.txt 区分大小写，因此这两个条目（如果您知道它们都是一个大小写，则可以省略 1）。现在要确保我们没有阻止 sitemap.xml，我们需要先允许它：

```
Allow: /sitemap.xml
Disallow: /*.xml$
Disallow: /*.XML$ 
```

robots.txt 中还有一个站点地图指令来引用站点地图的位置，因此我们也可以添加它：

```
Allow: /sitemap.xml
Disallow: /*.xml$
Disallow: /*.XML$

Sitemap: http://example.com/sitemap.xml 
```

# android - setFocusable 按钮点击

> ID：13071651
> 
> 赞同：1
> 
> 时间：2012-10-25T15:10:13.387
> 
> 标签：android, android-edittext

我有一个名为 的小型计时器应用程序和 EditText 小部件，`etH`它们允许输入并显示时间滴答作响。单击开始按钮并启动计时器时，我通过执行以下操作来禁止交互：`etM``etS`

```
btnS.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
    if (calculateMS() != 0) {
        OnTimerStartButtonClicked();
        initiateTimer();
        DisableEditTexts();
                    ... 
```

方法：

```
public void DisableEditTexts() {
    etH.setFocusable(false);
    etM.setFocusable(false);
    etS.setFocusable(false);
} 
```

通过按下重置按钮，我想通过调用执行相反操作的方法来重新启用交互（将可聚焦设置为 true）：

```
btnR.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        OnTimerResetButtonClicked();
        clearValues();
        EnableEditTexts();
        ... 
```

问题：通过单击重置按钮，edittexts 不会成为焦点。我在最后一种方法中所做的只是

```
etH.setFocusable(true);
etM.setFocusable(true);
etS.setFocusable(true); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:15:20.920

尝试调用[`EditText#setFocusableInTouchMode()`](http://developer.android.com/reference/android/view/View.html#setFocusableInTouchMode%28boolean%29)：

```
etH.setFocusableInTouchMode(true);
// etc. 
```

* * *

当你打电话时`setFocusable(false)`，在幕后，`setFocusableInTouchMode(false)`为你打电话。但是，当您调用`setFocusable(true)`时，幕后没有其他任何事情发生，`setFocusableInTouchMode()`留下`false`.

当你打电话`setFocusableInTouchMode(true)`时，会发生类似的事情，`setFocusable(true)`为你打电话。和以前一样`setFocusableInTouchMode(false)`，不叫`setFocuable(false)`。

[看一看源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/view/View.java#View.setFocusable%28boolean%29)，看看这个怪癖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:15:05.437

您是否尝试过调试以确保在按下重置按钮时实际调用 EnableEditTexts()？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:18:07.137

尝试 _myEditText.clearFocus() 失去焦点并尝试 _myEditText.requestFocus() 重新获得它

# c# - 将 RTSP 存储到文件位置

> ID：13071652
> 
> 赞同：5
> 
> 时间：2012-10-25T15:10:12.707
> 
> 标签：c#, winforms, rtsp, vlc

我能够通过 C# Winform 应用程序在 Windows 7 64 位机器上流式传输 rtsp。这是我使用的库 - [VLCDotNet](http://vlcdotnet.codeplex.com/)，这是播放 RTSP 流的代码示例：

```
LocationMedia media = new LocationMedia(@"rtsp://192.168.137.73:554/live.sdp");
vlcControl1.Media = media;
vlcControl1.Play(); 
```

我想通过单击按钮将流存储到我的 PC 中的文件中，然后用另一个按钮停止相同的操作。我如何实现这一目标？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T18:50:28.077

Here is the code:

```
Vlc.DotNet.Core.Medias.MediaBase media1
= new Vlc.DotNet.Core.Medias.PathMedia("rtsp://192.168.137.73:554/live.sdp");

media.AddOption(":sout=#transcode{vcodec=theo,vb=800,
scale=1,acodec=flac,ab=128,channels=2,samplerate=44100}:std{access=file,mux=ogg,
dst=D:\\123.mp4}");

VlcControl control = new VlcControl();
control.Media = media;
control.Play(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-07T19:02:16.223

```
VlcContext.StartupOptions.IgnoreConfig = true;
VlcContext.StartupOptions.LogOptions.LogInFile = true;
VlcContext.StartupOptions.LogOptions.ShowLoggerConsole = true;
VlcContext.StartupOptions.LogOptions.Verbosity = VlcLogVerbosities.Debug;

// Disable showing the movie file name as an overlay
// VlcContext.StartupOptions.AddOption("--no-video-title-show");                
// VlcContext.StartupOptions.AddOption("--no-audio");
VlcContext.StartupOptions.AddOption("--rtsp-tcp"); //this line was important to make this work 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-24T14:11:27.483

从 Vlc.DotNet.Core 2.1.62 开始，执行此操作的方法是使用vlc 控件上的额外`opts`参数。`.Play`

```
var opts = new string[] { @":sout=file/ogg:C:\video.ogg" };
vlc.MediaPlayer.Play(new Uri(videoURI), opts); 
```

`

# android - Facebook 安卓 sdk 3.0 SSO

> ID：13071655
> 
> 赞同：5
> 
> 时间：2012-10-25T15:10:15.887
> 
> 标签：android, facebook, single-sign-on, facebook-android-sdk

在以前版本的 Facebook SDK 中，我们可以使用令牌检查用户是否仍然登录。在新的 3.0 版本中，除了调用`openSession()`检查用户是否仍然使用`SSO`. 但是`openSession()`如果用户没有被保存并且我不想这样，它会自动调用登录。我只想检查 SSO。我该怎么做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-21T11:09:06.550

我创建了一个辅助函数来检查用户在我的应用程序中是否仍为我登录（或实际上有一个活动会话）：

```
public static boolean isActive() {
    Session session = Session.getActiveSession();
    if (session == null) {
        return false;
    }
    return session.isOpened();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T10:47:02.477

或者，您可以调用 Session.openActiveSession(Context context)，根据 javadocs，它只会在不需要用户交互的情况下打开会话。——李明

# xslt - 测试参数是否是 XSLT 中的几个值之一

> ID：13071661
> 
> 赞同：3
> 
> 时间：2012-10-25T15:10:36.540
> 
> 标签：xslt, xslt-2.0, xpath-2.0

> **可能重复：**
> [用于检查变量是否属于元素集的 XSLT 表达式](https://stackoverflow.com/questions/1007018/xslt-expression-to-check-if-variable-belongs-to-set-of-elements)

给定一个参数 ，`$name`什么是检查其值是否等于有限数量值之一的简洁明了的方法？

例如，假设我想合并这些`when`测试中的前 3 个，因为它们的内容完全相同。

```
<choose>
  <when test="$name='Alice'">
  <when test="$name='Bob'">
  <when test="$name='Cindy'">
  <when test="$name='Dave'">
  <otherwise> 
```

类似的东西`test="$name in ['Alice','Bob','Cindy']"`，除了实际上有效：P

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T15:41:23.477

在 XSLT 2.0 中，使用`$name = ('Alice', 'Bob', 'Cindy')`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:35:51.170

**使用（在 XSLT 1.0 和 XSLT 2.0 中）**：

```
contains('|Alice|Bob|Cindy|', concat('|', $name, '|')) 
```

而且，正如 Martin Honnen 已经提到的，**仅在 XPath 2.0 (XSLT 2.0) 中，可以简单地编写**：

```
$name = ($seqOfNames) 
```

# c# - MSIInstallProduct 引发 System.AccessViolationException x64 Windows 操作系统

> ID：13071664
> 
> 赞同：1
> 
> 时间：2012-10-25T15:10:39.067
> 
> 标签：c#, .net, windows-installer

我有以下问题：我用 C# 编写了一个`MSIInstallProduct` 用于安装 .msi 文件的应用程序。我使用以下签名：

```
[DllImport("msi.dll", CharSet = CharSet.Auto, SetLastError = true)]    
public static extern UInt32 MsiInstallProduct(string packagePath, string commandLine); 
```

如果我在 x86 Windows 下运行它，一切正常。但是如果我在 x64 Windows 下运行它，我会收到以下错误消息：

> System.AccessViolationException：试图读取或写入受保护的内存。这通常表明其他内存已损坏。

这主要发生在 MSI 行动`InstallFiles`或`WritingRegistryKeys`

有人知道我该如何解决吗？

# php - 在 Joomla 模块上安装 Hook

> ID：13071667
> 
> 赞同：0
> 
> 时间：2012-10-25T15:10:45.013
> 
> 标签：php, joomla, installation, joomla-extensions

我试图在安装 Joomla 模块时运行安装钩子，我的模块中有这个，但它不起作用！我需要调用这个类在某个地方的文件吗？

```
class mod_impalawifiInstallerScript
{
/**
 * method to install the component
 *
 * @return void
 */
function install($parent)
{ 
```

我看过文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:15:22.200

我找到了，你需要把它放在你的 xml 文件中。

```
<scriptfile>script.php</scriptfile> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:20:46.670

在 Joomla 1.6+ 中，您有两种选择。

`install.*componentname*.php`一，您可以在 .zip 文件的根目录中包含一个名为的文件。该文件应包含一个函数，`com_install`. 在安装组件期间将调用此函数。（更多信息[在这里](http://docs.joomla.org/Using_the_installer_API_to_support_package_installation)）

另一种选择是使用`<scriptfile>`标记定义要在 XML 中运行的脚本。这应该放在元数据之后，但在文件位置之前（与 SQL 等其他安装内容一起）。文档和示例[在这里。](http://docs.joomla.org/Manifest_files)

# r - 如何将计数器分配给由因子组合定义的 data.frame 的特定子集？

> ID：13071669
> 
> 赞同：7
> 
> 时间：2012-10-25T15:10:50.143
> 
> 标签：r, indexing, combinations, tapply

我的问题是：我有一个包含一些因子变量的数据框。我现在想为这个数据框分配一个新向量，它为这些因子变量的每个子集创建一个索引。

```
 data <-data.frame(fac1=factor(rep(1:2,5)), fac2=sample(letters[1:3],10,rep=T)) 
```

给了我类似的东西：

```
 fac1 fac2
     1     1    a
     2     2    c
     3     1    b
     4     2    a
     5     1    c
     6     2    b
     7     1    a
     8     2    a
     9     1    b
     10    2    c 
```

我想要的是一个组合计数器，它计算每个因素组合的出现。像这样

```
 fac1 fac2  counter
     1     1    a        1
     2     2    c        1
     3     1    b        1
     4     2    a        1
     5     1    c        1
     6     2    b        1
     7     1    a        2
     8     2    a        2
     9     1    b        2
     10    1    a        3 
```

到目前为止，我考虑过使用 tapply 来获取所有因子组合的计数器，效果很好

```
counter <-tapply(data$fac1, list(data$fac1,data$fac2), function(x) 1:length(x)) 
```

但我不知道如何在不使用低效循环的情况下将计数器列表（例如未列出）分配给数据帧中的组合：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T15:53:11.283

这是该`ave()`功能的工作：

```
# Use set.seed for reproducible examples 
#   when random number generation is involved
set.seed(1) 
myDF <- data.frame(fac1 = factor(rep(1:2, 7)), 
                   fac2 = sample(letters[1:3], 14, replace = TRUE), 
                   stringsAsFactors=FALSE)
myDF$counter <- ave(myDF$fac2, myDF$fac1, myDF$fac2, FUN = seq_along)
myDF
#    fac1 fac2 counter
# 1     1    a       1
# 2     2    b       1
# 3     1    b       1
# 4     2    c       1
# 5     1    a       2
# 6     2    c       2
# 7     1    c       1
# 8     2    b       2
# 9     1    b       2
# 10    2    a       1
# 11    1    a       3
# 12    2    a       2
# 13    1    c       2
# 14    2    b       3 
```

注意步骤`stringsAsFactors=FALSE`中的使用`data.frame()`。如果你没有那个，你仍然可以得到输出：`myDF$counter <- ave(as.character(myDF$fac2), myDF$fac1, myDF$fac2, FUN = seq_along)`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T22:35:28.510

数据表解决方案

```
library(data.table)
DT <- data.table(data)
DT[, counter := seq_len(.N), by = list(fac1, fac2)] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:42:01.940

这是避免（显式）循环的基本 R 方式。

```
data$counter <- with(data, {
    inter <- as.character(interaction(fac1, fac2))
    names(inter) <- seq_along(inter)
    inter.ordered <- inter[order(inter)]
    counter <- with(rle(inter.ordered), unlist(sapply(lengths, sequence)))
    counter[match(names(inter), names(inter.ordered))]
}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:57:21.920

这是一个带有一点循环的变体（我已将您的变量重命名为“x”，因为“数据”被用于其他方式）：

```
x <-data.frame(fac1=rep(1:2,5), fac2=sample(letters[1:3],10,rep=T))
x$fac3 <- paste( x$fac1, x$fac2, sep="" )
x$ctr <- 1
y <- table( x$fac3 )
for( i in 1 : length( rownames( y ) ) )
  x$ctr[x$fac3 == rownames(y)[i]] <- 1:length( x$ctr[x$fac3 == rownames(y)[i]] )
x <- x[-3] 
```

不知道这是否对大型 data.frame 有效，但它有效！

# c# - 如何比较 Asp.net 中两个不同位置的目录？

> ID：13071670
> 
> 赞同：0
> 
> 时间：2012-10-25T15:10:53.143
> 
> 标签：c#, asp.net, directory

我想比较来自两个不同位置的目录。我想知道是否可以访问我的服务器外部的目录？还是有其他方法可以进行文件比较？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:16:16.773

要使用标准`System.IO`方法（即不是 FTP）访问另一台服务器上的文件，您需要做两件事：

1.  允许您访问该位置的机制设置（简单共享、DFS、WebDAV 等）
2.  访问共享和文件的权限

从那里您可以使用它们的 UNC 路径访问这些文件夹：

```
\\{ServerName}\{ShareName}\folder1\sub1\... 
```

# ruby-on-rails - 使用 gem Tire 和 ElasticSearch 构建正确的搜索请求

> ID：13071672
> 
> 赞同：0
> 
> 时间：2012-10-25T15:11:03.013
> 
> 标签：ruby-on-rails, elasticsearch, tire

我正在尝试为我的 Flower Store 实现简单的搜索请求，但由于我是轮胎和 ElasticSearch 的新手，所以我不知道该怎么做。

我有可搜索的模型和`Product`habtm 模型`Category`，，，`Colour`。`Flower`我想要的是每个关联的复选框，产生与此类似的请求：

```
http://example.com/search?q=some%20query&category_names[]=bouquet&category_names[]=marriage&colour_names[]=red&colour_names[]=yellow&colour_names[]=white&flower_names[]=rose&flower_names[]=tulip&price_min=100&price_max=1000 
```

但我只需要展示以下产品：

```
a) prestent in any of the requested categories (OR);
b) have all of the requested colours (AND);
c) have all of the requested flowers (AND);
d) enter the price range between price_min and price_max. 
```

参数是搜索任何文本，输入到文本字段中，在关联的`q`名称中（比如说，`red roses bouquet`），并用上面的标准显示它。

目前我只有

```
class Product
  include Mongoid::Document

  include Tire::Model::Search
  include Tire::Model::Callbacks

  has_and_belongs_to_many :categories
  has_and_belongs_to_many :colours
  has_and_belongs_to_many :flowers

  def self.search(params)
    tire.search(load: true, page: params[:page], per_page: 8) do |search|
      search.query  { string params[:query] } if params[:query].present?
    end
  end

  def to_indexed_json
    self.to_json(methods: [:category_names, :colour_names])
  end

  def category_names
    self.categories.collect { |c| c.name }
  end

  def colour_names
    self.colours.collect { |c| c.name }
  end
end 
```

并且不知道如何配置它。我读过`filters`and `facets`，但因为英语不是我的母语，我无法理解什么是什么以及如何使用它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T18:56:46.533

我这样做了：

```
def self.search(params)
  tire.search(load: true, page: params[:page], per_page: 8) do
    query do
      boolean do
        must { string params[:query], default_operator: "AND" } if params[:query].present?
        must { string params[:category_names] } if params[:category_names].present?
        must { string params[:colour_names], default_operator: "AND" } if params[:colour_names].present?
        must { range :price, { gte: params[:price_min], lte: params[:price_max] } } if params[:price_min].present? && params[:price_max].present?
      end
    end

    # raise to_curl
  end
end 
```

# cakephp - 无法使用相关模型信息填充选择选项 - CakePHP

> ID：13071677
> 
> 赞同：0
> 
> 时间：2012-10-25T15:11:19.800
> 
> 标签：cakephp

用这个拉我的头发，我知道它很简单，但我一直在努力解决它。作为记录，我使用的是 cakePHP 2.2。

我正在尝试使用相关模型数据填充选择输入。

基本上我有用户和用户状态。用户模型属于 UserStatus 模型。在 user/add() 函数中，我想要一个下拉选择框，其中填充来自 UserStatus 模型的数据。

继承人的代码：

用户控制器/添加（）

```
$groups = $this->User->Group->find('list');
$UserStatus = $this->User->UserStatus->find('list');
$this->set(compact('groups', 'UserStatus')); 
```

查看/用户/add.ctp

```
echo $this->Form->input('user_status_id', array('class' => 'span9')); 
```

users 表中建立关系的字段是 user_status_id，它链接到 user_statuses 表中的 id。

基于上述，选择框不会填充来自 user_statuses 表的状态。有趣的是，如果我将视图代码更改为：

```
echo $this->Form->input('user_status_id', array('class' => 'span9')); 
```

但是，当我这样做时，不会写入数据库。

任何帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:30:20.123

选项参数应该解决显示问题，只要您的用户表中有一个 user_status_id，下面的代码应该在保存时将值保存在您的用户模型中。

```
echo $this->Form->input('User.user_status_id', array('options'=>$UserStatus,'class' => 'span9')); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:42:33.277

应该：

```
$userStatus = $this->User->UserStatus->find('list'); 
```

（注意小写“u”）

# c# - 本地化 winform 并在运行时更改语言

> ID：13071684
> 
> 赞同：0
> 
> 时间：2012-10-25T15:11:40.587
> 
> 标签：c#, localization

我在更改表单中的语言时遇到问题。我的表格中的文本都是英文文本。当我在组合框中选择西班牙语时，什么也没有发生。选择法语时也一样。我的表单中的可本地化是 TRUE。我的语言是默认的。我的代码有什么问题？需要帮忙。对于我的项目。

```
private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (comboBox1.SelectedItem.ToString() == "English")
        {
            ChangeLanguage("en");
        }
        else if (comboBox1.SelectedItem.ToString() == "Spanish")
        {
            ChangeLanguage("es-ES");
        }
        else if (comboBox1.SelectedItem.ToString() == "French")
        {
            ChangeLanguage("fr-FR");
        }
    }

    private void ChangeLanguage(string lang)
    {
        foreach (Control c in this.Controls)
        {
            ComponentResourceManager resources = new ComponentResourceManager(typeof(UserLogin));
            resources.ApplyResources(c, c.Name, new CultureInfo(lang));
        }
    } 
```

我添加的命名空间

```
using System.Globalization; 
```

`using System.Threading;`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-08T08:39:23.077

您应该更改 Thread.CurrentUICulture 以匹配所选的文化。即使 AFAIK，如果您在 ApplyResources 方法中指定应用哪种文化，这无关紧要，但对于本地化字符串（例如，对于 MessageBoxes）和此后加载的任何其他表单，它确实很重要。

此外，请确保将新资源也应用于子 GroupBox 控件，这对我来说非常有用。这将是代码：

```
private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    if (comboBox1.SelectedItem.ToString() == "English")
    {
        Thread.CurrentThread.CurrentUICulture = new CultureInfo("en");
        ChangeLanguage("en");
    }
    else if (comboBox1.SelectedItem.ToString() == "Spanish")
    {
        Thread.CurrentThread.CurrentUICulture = new CultureInfo("es-ES");
        ChangeLanguage("es-ES");
    }
    else if (comboBox1.SelectedItem.ToString() == "French")
    {
        Thread.CurrentThread.CurrentUICulture = new CultureInfo("fr-FR");
        ChangeLanguage("fr-FR");
    }
}

private void ChangeLanguage(string lang)
{
    foreach (Control c in this.Controls)
    {
        ComponentResourceManager resources = new ComponentResourceManager(typeof(UserLogin));
        resources.ApplyResources(c, c.Name, new CultureInfo(lang));
        if (c.ToString().StartsWith("System.Windows.Forms.GroupBox"))
        {
            foreach (Control child in c.Controls)
            {
                ComponentResourceManager resources_child = new ComponentResourceManager(typeof(UserLogin));
                resources_child.ApplyResources(child, child.Name, new CultureInfo(lang));
            }
        }
    }
} 
```

对自己来说可能会迟到，但如果是这样，我希望它对其他人有所帮助。

# php - PHP：计算循环中的条目并在计算中使用它们

> ID：13071685
> 
> 赞同：0
> 
> 时间：2012-10-25T15:11:42.700
> 
> 标签：php

我在 PHP 中有一个循环，如下所示：

```
$getDetails = mssql_query ("SELECT * FROM BasketItems 
WHERE BasketID = '".$_GET['id']."' ");

while ($detailsrow = mssql_fetch_array($getDetails)) {     
  $TotalSetPrice = $detailsrow['FinalPrice'] * $detailsrow['Qty'];
  echo $TotalSetPrice;

  $numberofent = count($detailsrow['FinalPrice']);
  echo "######NUMBER#####: $numberofent";

  $TotalPrice = ?????;

  ######VARIOUS DATA##############
} 
```

所以好吧，无论如何我都不是PHP专家，这是第一件事。`FinalPrice`是某人在数据库中选择的项目的价格。但是，客户可以拥有任意数量的这些物品。

所以`FinalPrice * Qty = TotalSetPrice`

然而，顾客也可能在篮子内有不同的物品组。

所以我需要计算`TotalSetPrice * (Number of sets of items Within the DB)`

所以我用谷歌搜索，并想出了count（），但如果我只是`count($detailsrow)`返回`56`条目，如果有意义的话，这就是整体数据的数量。我只想计算实际数据集的笨拙。我试着数数`finalprice`，但这只是返回`1`，这也不正确。

谁能给我一些关于如何计算数组循环中的条目数的指导，例如这个。我希望这比我感觉的更有意义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T15:14:19.750

```
$TotalPrice += $TotalSetPrice; 
```

这是以下简称：`$TotalPrice = $TotalPrice + $TotalSetPrice;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:19:49.643

选择最终价格，数量，（最终价格 * 数量）作为 TotalSetPrice

只需使用mysql，这样您就不再使用php，您需要编写更长的代码

# php - .load jQuery 不受父 .php 文件的影响

> ID：13071696
> 
> 赞同：0
> 
> 时间：2012-10-25T15:12:03.203
> 
> 标签：php, javascript, jquery, load

.load 的功能有问题。

当我使用 jQuery 动态加载文件时，插入到我的 PHP 文件中的文件不受我的名为`master.php`. `Master.php`具有处理该文件中在 jQuery 函数中动态加载的所有内容所必需的所有`.load`函数。

那么，有没有办法让它加载呢？我不能只`master.php`在那个文件中，因为我正在使用该`.load`函数加载的文件已经在同一个文件中，它再次被调用`.load`。

原始文件代码：

```
<?php 
     include 'include/master.php';
?>
<div id='loadingDock'>
    <?php
         include 'include/sequence.php'; 
    ?>
</div> 
```

但是在我动态地将一些东西添加到数据库中之后，我想再次加载 sequence.php 以显示结果。

```
 $(document).ready(function(){
        $("#hoverElement").click(function(){
             $("#loadingDock").load('include/sequence.php');
        });
    }); 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:39:47.067

您需要将master.php 和sequence.php 之间共享的函数分开，并仅将它们包含在两个文件中。

例如：

```
// Master.php
<?php 
    include_once('common.php');

    // ... Do things you don't want in sequence.php
?>

// Sequence.php
<?php
    include_once('common.php');

    // ... Do things you don't want in master.php
?>

// Any other files that need common functions
<?php
    include_once('common.php');

    // ... Do things
?>

// Common.php
<?php
    // Shared functions
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:48:12.047

在调用加载中传递一个参数

```
$(document).ready(function(){
    $("#hoverElement").click(function(){
         $("#loadingDock").load('include/sequence.php',{a:1});
    });
}); 
```

文件文件 sequence.php 的开头

```
<?
if(isset($_POST["a"])){
    include 'master.php';
}
?> 
```

# java - JPA + JSF 字段列多描述

> ID：13071697
> 
> 赞同：1
> 
> 时间：2012-10-25T15:12:07.610
> 
> 标签：java, jsf, jpa

对于实体 bean 中的每一列，我有 2 个描述（针对 2 种不同的语言），我想在会话 bean 的不同情况下使用这些描述。

如果用户选择语言 X ，我想获得 X 语言的字段描述，并相应地获得 Y 语言。

我的问题是如何为每个字段保存这两个不同的描述？

是否可以创建一个包含 2 个不同值的注释，并且根据我想要的，我可以从这些注释中提取它？

# php - 如何在短代码中回显此插件

> ID：13071698
> 
> 赞同：0
> 
> 时间：2012-10-25T15:12:14.720
> 
> 标签：php, wordpress, echo

如何在短代码中回显 Wordpress 插件，我将在我称为治疗 1 的帖子中放入自定义元字段中？

短代码是

```
[table id=6 /] 
```

我无法工作的php是

```
<?php 
$post_meta = get_post_meta($post->ID, "Treatment Right 1", true);
if (!empty($post_meta)) {
?>
<?php echo do_shortcode($post_meta;); ?>
<?php
}
?> 
```

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:21:58.883

```
<?php echo do_shortcode($post_meta); ?> 
```

您的简码函数中有一个分号作为开始。

不是 100% 确定您要达到的目标。

自定义元字段是否只包含短代码的名称或完整的字符串？即它是否包含方括号 [shortcode] 而不仅仅是返回“shortcode”

你可以试试：

echo do_shortcode('['.$post_meta.']');

你自己写过'table'的简码函数吗？

# java - 不支持文本对象。Java Excel API

> ID：13071704
> 
> 赞同：1
> 
> 时间：2012-10-25T15:12:50.747
> 
> 标签：java, excel, jxl

我有这段代码可以从 xls 文件中读取：

```
fileName = "...."

WorkbookSettings settings = new WorkbookSettings();
settings.setEncoding("Cp1252");

System.out.println("BEFORE");

Workbook w = Workbook.getWorkbook(new File(fileName), settings);
Sheet sheet = w.getSheet(1);

System.out.println("AFTER"); 
```

这是我在控制台中得到的：

```
BEFORE
Warning:  Text Object on sheet "Detalle" not supported - omitting
jxl.common.AssertionFailed
    at jxl.common.Assert.verify(Assert.java:37)
    at jxl.read.biff.SheetReader.handleObjectRecord(SheetReader.java:1811)
    at jxl.read.biff.SheetReader.read(SheetReader.java:1059)
    at jxl.read.biff.SheetImpl.readSheet(SheetImpl.java:716)
    at jxl.read.biff.WorkbookParser.getSheet(WorkbookParser.java:257)
    at MapMovInfoResource.postService(MapMovInfoResource.java:77) 
```

当我尝试打开该文件中的第二张工作表时，问题就来了。当我使用第一张纸 ( `w.getSheet(0)`) 时，它工作正常。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-25T09:29:57.073

[在此处输入图像描述](http://i.stack.imgur.com/8tGRT.jpg)

看起来你在 excel 中有一些不是文本的价值。请检查图像中的 excel 值，如果和特殊引号可用，则将其删除并重试。

# c++ - 使用 SpatialIndex 库为 R* 树选择参数

> ID：13071706
> 
> 赞同：5
> 
> 时间：2012-10-25T15:13:02.843
> 
> 标签：c++, indexing, spatial, spatial-index, r-tree

我正在使用来自[http://libspatialindex.github.com/的空间索引库](http://libspatialindex.github.com/)

我正在主内存中创建一个 R* 树：

```
size_t capacity = 10;
bool bWriteThrough = false;
fileInMem = StorageManager
    ::createNewRandomEvictionsBuffer(*memStorage, capacity, bWriteThrough);

double fillFactor = 0.7;
size_t indexCapacity = 10;
size_t leafCapacity = 10;
size_t dimension = 2;
RTree::RTreeVariant rv = RTree::RV_RSTAR;
tree = RTree::createNewRTree(*fileInMem, fillFactor, indexCapacity,
   leafCapacity, dimension, rv, indexIdentifier); 
```

然后我插入了大量的边界框，目前大约 250 万（德国巴伐利亚州的道路网络）。稍后我的目标是插入欧洲的所有道路。

存储管理器和 rtree 的参数有哪些好的选择？大多数情况下，我使用 rtree 来查找到给定查询（bbox 交叉点）的最近道路。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T10:56:07.287

由于您的数据是静态的，因此良好的批量加载可能对您有用。最流行（也是相当简单）的 bluk 加载是 Sort-Tile-Recursive。但是，它在某种程度上是围绕点数据设计的。当您插入空间对象时，它可能会也可能不会正常工作。

如果您使用批量加载，它将不再是 R*-tree，而是普通的 R-tree。

*容量 10 对我来说*听起来太少了。你想要一个更大的扇出。但是您需要进行基准测试，这取决于数据集和查询什么是好的。我肯定会尝试100个或更多。

# css - 有角度的，将 CSS 丝带包裹在图像上

> ID：13071715
> 
> 赞同：5
> 
> 时间：2012-10-25T15:13:48.353
> 
> 标签：css, ribbon

是否可以仅使用 CSS 来实现此功能区？

![我试图在 CSS 中创建的功能区示例图像](../Images/add0f38c61a5e2add2f857a9b3f88f3b.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-26T00:13:22.817

的HTML：

```
<div class="box">
    <div class="ribbon">
        <div class="txt">
            Example Text
        </div>
    </div>
<div>​ 
```

CSS：

```
.box {
    width: 300px;
    height: 300px;
    background-color: #a0a0a0;
    position: relative;
}
.ribbon {
  -webkit-transform: rotate(-45deg); 
     -moz-transform: rotate(-45deg); 
      -ms-transform: rotate(-45deg); 
       -o-transform: rotate(-45deg); 
          transform: rotate(-45deg); 
    border: 25px solid transparent;
    border-top: 25px solid #757575;
    position: absolute;
    bottom: 20px;
    right: -50px;
    padding: 0 10px;
    width: 120px;
    color: white;
    font-family: sans-serif;
    size: 11px;
}
.ribbon .txt {
    position: absolute;
    top: -20px;
    left: 20px;
}​ 
```

例子：

[http://codepen.io/gilluminate/pen/jusoI](http://codepen.io/gilluminate/pen/jusoI)

（PS。除了旋转之外的所有东西仍然可以在旧版浏览器中使用。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:12:39.037

一些 CSS 转换是可能的，不幸的是，这些转换并没有得到普遍支持。请参阅此处的（快速）示例：http: [//codepen.io/anon/pen/kBpcK](http://codepen.io/anon/pen/kBpcK)

# javascript - 如何识别用户输入的是 RTL 还是 LTR 语言？

> ID：13071717
> 
> 赞同：5
> 
> 时间：2012-10-25T15:13:53.720
> 
> 标签：javascript, jquery, html, cross-browser

我想模仿谷歌的输入法，它会根据你输入的语言自动改变输入法的输入方向。

如何识别用户是在使用 RTL 还是 LTR 语言输入？它必须跨浏览器工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T06:57:08.157

您应该使用属性 dir="auto"

例如

```
<html dir="auto"> 
```

这样，浏览器将查看第一个强类型字符并自动调整文本。

作为参考，这里是 W3C 文档：[http ://www.w3.org/International/tutorials/new-bidi-xhtml/qa-html-dir](http://www.w3.org/International/tutorials/new-bidi-xhtml/qa-html-dir)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-16T07:11:40.617

如果你想模仿谷歌的方向性识别算法，你需要听输入变化，识别插入的字符是 RTL 还是 LTR（或中性）并`dir=""`相应地更改文本框的属性。

在大多数情况下，Google 的算法似乎计算了字符串中的大多数强字符并据此决定方向性。如果您键入 RTL，它会将上下文切换到 RTL，如果您随后为同一段落切换到 LTR，如果这些字符的数量超过 RTL 字符，它可能会再次将上下文切换到 LTR。

相比之下，Facebook 也使用了方向算法，但略有不同——它似乎使用第*一个*强字符来决定段落的方向，而不是总数。

（作为记录，谷歌似乎也有几种算法；Gmail 的行为与谷歌环聊略有不同，这与谷歌搜索中的输入对齐方式不同。在这些事情中，几乎没有“正确”或“错误” “答案，而是适合您的用例）

无论您选择实施哪种方法，您首先需要识别用户正在输入的内容。有几种方法可以做到这一点，但我会推荐以下方法：

*   阅读一些关于 Unicode 双向算法（尤其是关于“强”类型字符）[http://unicode.org/reports/tr9/](http://unicode.org/reports/tr9/)
*   找到一种在您的上下文中识别强字符的好方法。可以在 MediaWiki 的语言文件中找到执行此操作的正则表达式示例（其中第 1 组是 LTR，第 2 组是 RTL）：[https ://github.com/wikimedia/mediawiki/blob/6f19bac69546b8a5cc06f91a81e364bf905dee7f/languages/Language.php# L174](https://github.com/wikimedia/mediawiki/blob/6f19bac69546b8a5cc06f91a81e364bf905dee7f/languages/Language.php#L174)

您可以创建一个 JavaScript 方法来侦听用户的输入，使用上面的正则表达式来识别使用了哪个强字符（通过第一个字符或全部计数，以最适合您的使用和规模的方式） - 并更改文本框的`dir=""`相应的属性。

确保稍后以正确的对齐方式显示提交的文本，因此您可能必须使用某些东西来存储您选择的对齐方式，或者在渲染时重新识别它。无论哪种方式，不要忘记显示也需要相同的`dir=""`属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-16T04:44:44.520

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<html>

    <head>

        <script> 
            function checkRTL(s) {
                var ltrChars = 'A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02B8\u0300-\u0590\u0800-\u1FFF' + '\u2C00-\uFB1C\uFDFE-\uFE6F\uFEFD-\uFFFF',
                    rtlChars = '\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC',
                    rtlDirCheck = new RegExp('^[^' + ltrChars + ']*[' + rtlChars + ']');

                return rtlDirCheck.test(s);
            };

            // BIND KEYPRESS
            var input = $('input').on('keypress', keypress)[0];

            function keypress(e) {
                // need to wait for the character
                setTimeout(function () {
                    var isRTL = checkRTL(String.fromCharCode(e.charCode)),
                        dir = isRTL ? 'RTL' : 'LTR';

                    input.style.direction = dir;
                }, 0);
            }
        </script>

    </head>

    </body>

        <h1>Auto Direction
            <sup>(RTL | LTR)</sup>
        </h1>
        <input type="text" onkeypress="keypress()" placeholder="Type something&hellip;" />

    </body>

    </html>
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-13T18:59:14.427

为时已晚，但也许有一天它可以帮助某人。该函数将根据第一个输入的字符为输入字段添加方向属性，当用户清除输入文本时，该函数将再次检测文本的新语言。

```
$.fn.Set_Input_Direction = function()
{
    $(this).off('keypress').on('keypress',function(e){
        _This = $(this);
        setTimeout(function()
        {
            if(_This.val().length > 1)
            {
                return;
            }
            else
            {
                var RTL_Regex = /[\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC]/;
                var isRTL     = RTL_Regex.test(String.fromCharCode(e.which));
                var Direction = isRTL ? 'rtl' : 'ltr';
                _This.css({'direction' : Direction});
            }
        });
    });
}; 
```

要使用它：

```
$('input').Set_Input_Direction(); 
```

# emacs - Emacs epa模式：pinentry加密保存文件失败

> ID：13071720
> 
> 赞同：5
> 
> 时间：2012-10-25T15:13:59.427
> 
> 标签：emacs, tmux, gnupg, gnu-screen, passphrase

我正在尝试在 emacs 中使用 epa 模式和 org 模式，如[本文所述](http://emacs.wordpress.com/2008/07/18/keeping-your-secrets-secret/)。

我使用屏幕会话和 ssh 连接到计算机。因此，我需要更改 /usr/bin/pinentry 以将 /usr/bin/pinentry-curses 指向 /usr/bin/pinentry-gtk-2。

我有

```
pinentry-program /usr/bin/pinentry-curses 
```

作为我的 .gnupg/gpg.conf 中的最后一行。当我尝试保存文件时，我看到了这个菜单：

```
Select recipients for encryption.
If no one is selected, symmetric encryption will be performed.
- `m' to mark a key on the line
- `u' to unmark a key on the line
[Cancel][OK] 
```

我选择“确定”但只得到

```
Opening output file: Encrypt failed, Exit 
```

我没有提示输入密码，也没有给出其他输出。它不会提示输入密码。它甚至没有将我的 gpg 'user' 列为 foo@bar.com。

但是，当 .gnupg/gpg.conf 文件中不存在该行时，我确实会在“选择加密的收件人”对话框中看到我的 gpg“用户”。但是，cpu 与以下消息挂钩：

```
Encrypting /home/user/test.gpg... 
```

（我假设它正在尝试生成 gtk 窗口并绕圈运行）

我有点困惑为什么我需要将 /usr/bin/pinentry 链接到 /usr/bin/pinentry-curses 并在我的 gpg.conf 文件中包含该行。

在 /usr/bin/pinentry 链接到 /usr/bin/pinentry-gtk-2 之前，如果我在本地计算机上，我会得到“选择收件人加密”提示，并列出我的 gpg 用户。我会得到一个对话框来输入我的密码，这一切都奏效了。我会得到

```
Encrypting /home/user/test.gpg... 
```

这一切都会成功。

我在一个截至今天早上是最新的 Arch 系统上运行 GNU Emacs 24.2.1。

我很好奇我做错了什么。我已经查看了 arch wiki 上有关 pinentry 和 gpg 的文章，但它们并没有帮助解决问题。提前致谢。

更新：26-10-2012 今天早上对 cryptsetup 软件包的更新似乎影响了行为。现在，当我打开一个 .gpg 文件时，我会收到“请输入密码”提示，但它似乎永远不会过去。输入我的密码后，提示永远不会消失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-14T08:26:34.630

如果此提示来自 pinentry-curses，您可以尝试：1.输入密码（可能后面没有回车，请尝试），2.按tab键，3.按两次回车键。

原因是您看不到 pinentry-curses 呈现的整个形式。也许尝试在 emacs 之外尝试 pinentry-curses（并输入命令 GETPIN）来理解上面建议的盲导航。如果您在 emacs（终端或 tmux 中）中使用 Mew 邮件客户端（和 gpg），也会存在类似的问题。

任何人都知道如何将 pinentry-curses 对话框强制为适合 emacs 的一行？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-31T14:18:56.923

有两种主要方法，但它们的有效性可能会因使用的 GPG 版本而异。此答案适用于当前的现代分支（即 2.2.x），而不是提出问题时的任何当前版本。

选项 1a。编辑`~/.gnupg/gpg-agent.conf`以使用 ncurses：

```
pinentry-program /usr/bin/pinentry-curses 
```

选项 1b。编辑`~/.gnupg/gpg-agent.conf`以使用 Emacs pinentry（如果可用）：

```
pinentry-program /usr/bin/pinentry-emacs 
```

选项 2\. 通过 SSH 连接使用本地 gpg-agent 和 GUI，如此处[所述](https://wiki.gnupg.org/AgentForwarding)

选项 2 需要更多的努力来设置，但不会太多，而且好处是相当可观的。特别是如果您不想在远程服务器上留下密钥。

# sql-server - SSIS 中的 Foreach 循环容器

> ID：13071725
> 
> 赞同：0
> 
> 时间：2012-10-25T15:14:17.647
> 
> 标签：sql-server, for-loop, ssis

我正在为 ssis 中的每个循环容器使用。我需要从我的文件夹中提取 excel 文件。示例文件名：- 2012 年 1 月、2012 年 3 月等。我的问题是我只需要提取当前月份的文件（即 2012 年 10 月）。任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:37:55.373

如果您正在处理一个文件，则不需要循环。您只需要一个可以将日期转换为英语（天或月）的表达式。

此处显示了解释这两种情况的一个示例：http: [//sqlage.blogspot.ch/2011/03/monthname-and-day-name-in-ssis.html](http://sqlage.blogspot.ch/2011/03/monthname-and-day-name-in-ssis.html)

解决您的问题的表达式是：

```
 (MONTH(getdate()) == 1 ? "January" :
    MONTH(getdate()) == 2 ? "February" :
    MONTH(getdate()) == 3 ? "March" :
    MONTH(getdate()) == 4 ? "April" :
    MONTH(getdate()) == 5 ? "May" :
    MONTH(getdate()) == 6 ? "Jun" :
    MONTH(getdate()) == 7 ? "July" :
    MONTH(getdate()) == 8 ? "August" :
    MONTH(getdate()) == 9 ? "September" :
    MONTH(getdate()) == 10 ? "October" :
    MONTH(getdate()) == 11 ? "November" :
    MONTH(getdate()) == 12? "December":"") + " " + 
    (DT_WSTR,4)YEAR(getdate()) + ".xlsx" 
```

结果是（目前）：2012 年 10 月.xlsx

# php - GroceryCRUD - 如何在回调中设置变量？（我上传了一个文件，想调整它的大小 3 次并将所有 3 个都放入数据库中 - 我如何保存该数据）？

> ID：13071731
> 
> 赞同：0
> 
> 时间：2012-10-25T15:14:33.097
> 
> 标签：php, codeigniter, grocery-crud

我正在使用 codeigniter + 杂货店。我有一个图片上传回调。

我在表单中上传了一张图片，但想要这样做：

复制 3 次

将每个调整为一定大小

然后将每一个保存在数据库中。

任何想法如何做到这一点？回调似乎只让我编辑图像（并做类似的事情） - 不更改提交数据的变量，以便我们可以保存操作数据。

查看他们的回调教程，看起来大多数回调都是这样的：

```
function callback_for_this_field($posted_data) {

$posted_data = $posted_data .= "append me";

return $posted_data;
} 
```

（即返回修改后的数据）

但上传回调只返回 true

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T21:14:03.063

您可以简单地使用`callback_before_insert`and来完成`callback_before_update`。当在杂货店 CRUD 中上传文件时，会插入一个隐藏字段，其值为文件名。例如，假设您有：

```
$crud->set_field_upload('image_url','assets/uploads/images'); 
```

你可以简单地做这样的事情：

```
$crud->callback_before_insert(array($this,'_append_uploaded_file'));
$crud->callback_before_update(array($this,'_append_uploaded_file')); 
```

并在您的控制器中添加如下内容：

```
public function _append_uploaded_file($post_array) 
{
    if (!empty($post_array['image_url'])) {
        $post_array['image_url'] =  "append-me-".$post_array['image_url'];
    }

    //You can add or insert to other tables too

    return $post_array;
} 
```

当然，您可以在有问题`callback_after_insert`和`callback_after_update`没有问题的情况下做同样的事情。

# javascript - 从前一个 TD 设置 TD 值

> ID：13071733
> 
> 赞同：0
> 
> 时间：2012-10-25T15:14:36.910
> 
> 标签：javascript, html, css, struts2

我有一个表，其中填充了依赖于前一页的值，这些值显然是用 struts 填充的

但是我对所有这些东西都不是很好，所以有一个简单的方法是我可以做这样的事情，要么只用 HTML，要么我可以在页面中放入一个小的 javascript？

```
<Table>
<TR>
<TH>ID</TH>
<TD><s:property value="groupID" /><TD> <--Number generated by the page with struts
</TR>
<TR>
<TH>ID Value</TH>
<TD>foobar</TD> <-- the text I want to add in dependant on the number from the previous TD
</TH>
</Table> 
```

那么，有没有一种简单的方法可以做到这一点？HTML、CSS、JavaScript 解决方案可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:23:26.943

给定那个确切的 HTML，一个像这样的简单脚本就可以做到。但是，如果您不了解 JavaScript，则应该真正学习它，以便了解自己在做什么。

```
<body>
    <Table>
        <TR>
            <TH>ID</TH>
            <TD><s:property value="groupID" /><TD>
        </TR>
        <TR>
            <TH>ID Value</TH>
            <TD>foobar</TD>
        </TR>
    </Table>
       <!-- The script is here so it won't run until the TABLE has loaded -->
    <script type="text/javascript">

          // This is a map of the struts values to your values
        var valueMap = {
            "1": "foo",
            "2": "bar",
            "3": "baz"
        };
          // Browser compatibility. Older IE uses 'innerText' instead of 'textContent'
        var textContent = ('textContent' in document) ? 'textContent' : 'innerText';

          // Get all the TD elements on the page
        var tds = document.getElementsByTagName('td');

          // Get the text content of the first TD (index 0)
        var text = tds[0][textContent];

          // Get the value from the map using the text we fetched above
        var value = valueMap[text];

          // Set the text content of the second TD (index 1) to the mapped value
        tds[1][textContent] = value;
    </script>
</body> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:55:51.907

假设您想将值“groupID”（设置在第一个 tr 的 td 中）放入第二行的 td 元素中，那么下面的 jQuery 就可以解决问题：

```
$(document).ready(function() {
    // Scrape the XML out of the TD containing the xml
    var tdXml = $('table tr').eq(0).find('td').html();
    // Grab the value of the value attribute (groupID)
    var value = $(tdXml).attr('value');
    // Set this value in the second row's TD
    $('table tr').eq(1).find('td').text(value);
}​);​ 
```

[jsFiddle在这里](http://jsfiddle.net/xnkdu/)

# node.js - Express + Socket.IO + RabbitMQ (node-amqp)

> ID：13071734
> 
> 赞同：3
> 
> 时间：2012-10-25T15:14:39.093
> 
> 标签：node.js, express, socket.io, rabbitmq, amqp

我很难将所有这三个放在一起，可能是因为我没有正确理解 Express 路由的概念。

我有一个带有事件更新的 RabbitMQ 队列。我们可以通过它们的 id 来识别这些事件。所以我想在一个给定的页面上找到一个事件，只是对应于它的 id 的更新。

队列：1316, 1539, 3486, 3479, 1316, 3890, 3479, ... -> 无限期地从数据库馈送。www.example.com/event/1316 -> 从队列中获取 ID 为 1316 的消息 www.example.com/event/3479 -> 从队列中获取 ID 为 3479 的消息

当我加载第一个事件时，我的代码运行良好，但是当我在不同的窗口中加载第二个事件时，它会从两个事件中获取消息，如果我加载第三个事件，猜对了，它会从三个 id 中获取消息。

**应用程序.js**

```
var express = require('express')  
, http = require('http');
var app = express();
var server = http.createServer(app);
var io = require('socket.io').listen(server, { log: false });
require('./io')(io);

var amqp = require('amqp');
var rabbitMQ = amqp.createConnection({ host: 'localhost' });

rabbitMQ.on('ready', function() {
  console.log('Connected to RabbitMQ');
  io.sockets.on('connection', function (socket) {
    console.log('Socket connected: ' + socket.id);
    rabbitMQ.queue('offer', { autoDelete: false, durable: false, exclusive: false }, function(q) {    
      q.bind('#'); // Catch all messages    
      q.subscribe(function (message) {
        obj = JSON.parse(message.data.toString());
        //socket.broadcast.to(obj.id).emit('message', obj);
        io.sockets.in(obj.id).emit('message', obj);
      });
    });
  });
});

var routes = require('./routes')
, event = require('./routes/event');

app.get('/', routes.index);
app.get('/event/:id', event.index);

server.listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

**io.js**

```
var socketio = function (io) { 
  if (!io) return socketio._io;  
  socketio._io = io;
} 

module.exports = socketio; 
```

**路线/事件.js**

```
var io = require('../io')();

exports.index = function(req, res) {
  io.sockets.on('connection', function (socket) {
    socket.join(req.params.id);
  });
  res.render('event', { title: 'Event' });
}; 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T17:31:06.233

你收到它们都是因为你`join`，而不是`leave`房间。如果您从 wiki 中查看[Socket IO Rooms](https://github.com/LearnBoost/socket.io/wiki/Rooms)，在底部，它提供`io.sockets.manager.roomClients[socket.id]`了一种获取套接字已加入的房间列表的方法（如果您访问了所有三个链接，我怀疑这将包括所有三个）。

您可能想尝试浏览此房间列表以及`leave`任何不是当前房间的房间，看看是否能解决问题。

## 编辑

好的，所以，有两个原因/解决方案。我刚刚测试了我的理论，它是有效的——你会收到你`join`编辑过的每个房间的消息，并且会继续这样做，直到你收到`leave`它们为止。所以这里是选项：

### 1.`leave`所有其他房间当他们`join`一个房间

```
io.sockets.on('connection', function (socket) {
    var room = req.params.id;

    var roomKeys = Object.keys(io.sockets.manager.roomClients[socket.id]);
    roomKeys.forEach(function(key) {
        if (key === '' || key === '/' + room) return;
        socket.leave(key.slice(1));
    });

    socket.join(room);
}); 
```

如前所述，我对此进行了测试。有用。

### 2.不发送`message`事件，发送`{room name}`事件

您可以发出 '{room name}' 事件，而不是发出 'message' 事件。而不是您的`q.subscribe()`回调包含`io.sockets.in(obj.id).emit('message', obj);`，您只需这样做`socket.emit(obj.id, obj);`，并且您将让 javascript 客户端仅侦听该页面的事件类型（基于 URL 路径）。

我也测试了这个。它也有效。它也更简单（我认为）因为它只需要`.emit()`在你的`q.subscribe()`回调中，这意味着你保存了“房间管理”的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T08:45:30.537

在尝试和失败之后，我明白我做错了什么，因为`io.sockets.on('connection')`在路由器内部使用是复制事件。所以归根结底，最简单的思维方式是正确的。

**应用程序.js**

```
var room = '';
var roomHandler = function(req, res, next) {
  if (req.path.match('event')) {
    room = req.params.id;
  } 
  next(); // Passing the request to the next handler in the stack.
}

io.sockets.on('connection', function (socket) {    
  socket.join(room);
});

rabbitMQ.on('ready', function() { 
  rabbitMQ.queue('offer', { autoDelete: false, durable: false, exclusive: false }, function(q) {      
    q.bind('#'); // Catch all messages  
    q.subscribe(function (message) {
      obj = JSON.parse(message.data.toString());
      io.sockets.in(obj.id).emit('message', obj);
    });
  });
});

app.get('/', routes.index);
app.get('/event/:id', roomHandler, event.index); 
```

# actionscript-3 - AS3 如何创建一个声明变量的循环？

> ID：13071737
> 
> 赞同：0
> 
> 时间：2012-10-25T15:14:40.437
> 
> 标签：actionscript-3, flash, loops, var

我将这三个变量声明为 MovieClip：

```
var bg_mc_1:MovieClip;
var bg_mc_2:MovieClip;
var bg_mc_3:MovieClip; 
```

然后我把它们放在一个数组中：

```
var bg_mc:Array = [bg_mc_1, bg_mc_2, bg_mc_3]; 
```

然后我执行此循环以将 MovieClips 添加到已经在舞台上的 MC 中：

```
for(i=0; i<=2; i++){
    bg_mc[i] = new bg_class_1() as MovieClip;
    bg_holder.addChild(bg_mc[i]);
} 
```

无论如何要使第一步充满活力吗？例如：

```
for(i=0; i<=2; i++){
    var this["bg_mc_"+i]:MovieClip;
    bg_mc.push(this["bg_mc_"+i])
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:20:25.280

动态创建影片剪辑：

```
for(var i=0; i<=2; i++){
    this["bg_mc_"+i] = new MovieClip();
    bg_mc.push(this["bg_mc_"+i]);
} 
```

尽管如此，如果您不需要对`bg_mc`数组外部的 MovieClip 的引用，您总是可以这样做

```
for(var i=0; i<=2; i++){
    bg_mc.push(new MovieClip());
} 
```

# mercurial - Mercurial：改变相位的后果是什么？

> ID：13071742
> 
> 赞同：9
> 
> 时间：2012-10-25T15:14:51.167
> 
> 标签：mercurial, phase

在 Mercurial 中，可以任意更改修订的阶段。*对于所有可能的转换（公共、草案、秘密）x（公共、草案、秘密），*相变的后果是什么？哪些相变是安全的？哪些可能会引起麻烦，哪些麻烦？哪些或多或少是无操作的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-25T21:54:14.877

提交的默认阶段是`draft`，这就是当阶段不存在时它们的处理方式。推送`draft`变更集时，mercurial 会自动将其阶段更改为`public`. 您可以使用它来了解您已经发布了哪些变更集。

但真正的问题是，当变更集处于同一`public`阶段时，mercurial 不会让您使用历史编辑扩展（如 、 等）来更改`mq`它们`rebase`。这非常重要，因为历史编辑*只*发生在本地存储库中，它们不会通过`pull`/`push`操作传播。因此，一旦发布变更集，它就会失控，更改它是危险的。

您可以从任何阶段更改为任何其他阶段。“正常流程”是移动到更高的阶段（秘密->草稿->公开），但 Mercurial 允许通过`--force`选项更改到较低的阶段。单独的相变是无害的。例如，当从`public`到`draft`或时发生的唯一事情`secret`是历史编辑的保护被删除，没有别的，拉和推仍然可以正常工作，Mercurial 永远不会对变更集感到困惑，因为它们具有唯一的标识符。像这样的相变*之后*发生的历史编辑操作可能会导致问题。这就是为什么 Mercurial 在相变中发出警告并要求`--force`选择，以确认这就是您真正想要的。

一般来说，发布的提交不应该被修改，这就是阶段试图确保的。但也许您确实可以控制所有存储库。或者也许你推了一些东西，你知道还没有其他人拉它。无论是什么原因，您都可以选择强制变更集的阶段回到草稿和编辑它们。但是这个版本必须在每个具有变更集的存储库中完成。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-25T23:39:43.400

*   无法使用历史编辑工具（即，）编辑*公共*修订。`mq``rebase`
*   不能将*秘密*修订推送到另一个存储库（当您发出 push 命令或另一个存储库尝试拉取时，它将被忽略）。
*   *修订草案*允许两者，但如果它被推送到另一个存储库，它将自动更改为*公开。*

阶段系统的目的是防止您在将修订推送到另一个存储库后对其进行修改，这是一个坏主意，除非您能够从它被推送到的所有存储库中删除修订的旧版本.

所有阶段变化或多或少都是无操作的；它只是一个标记，用于指示对修订进行什么是安全的或不安全的。

# jquery - HTML5 中的交互式图像

> ID：13071744
> 
> 赞同：2
> 
> 时间：2012-10-25T15:14:55.240
> 
> 标签：jquery, html, canvas, interactive

这是我第一次发帖，所以我会尽量把问题说清楚。我一直在使用库来操作 HTML5 画布元素以在背景上创建可拖动、可调整大小的图像，如下[所示](http://slides.html5rocks.com/#canvas-2d-example)

该库使用 MIT 许可的库，用于`canvasImg`和`canvasElement`Yahoo 实用程序。由于第一次发布状态，我无法包含指向这些库的超链接，但它们都包含在示例中。

我正在尝试通过一些修改来实现类似的目标。首先，上述所有示例都是在一个`iframe`- 我希望它是一个恒定大小的画布，在我的页面上具有相对定位，我认为这`iframe`对于我正在做的事情不是必需的。

由于它将用于帮助人们说明数学问题，因此我的目标是让整个事物在出现问题时多次显示为新画布，这些问题是通过按下“新问题”按钮在客户端创建的. 如果这还不够，我还需要设置它们以不干扰同一页面上的其他一些 MathDox 画布。

到目前为止，这是我的代码：

```
<script type="text/javascript">

    //<![CDATA[
    $(init);
    probNum = 1;//global var for problem printing
    //CANVAS STUFF
    canvas = [];
    img = [];

    //MATHDOX OPTIONS
    //Define mathdox options
    if (org) {
      alert("org already defined, could not set options");
    } else {
      var org = { mathdox: { formulaeditor: { options: {
        dragPalette:true, 
        paletteShow: "none", 
        useBar:true
      }}}};
    }

    function init(){

        //PROBLEM ADDING
        $("#add_problem").click(addProblem);
        addProblem();

        //TOPIC SELECTION
        //load list from database
        $("#topic0").load("<?=base_url()?>ajax/load_topic_list", {"parent_topic":0});
        //when new topic is selected make a new list
        $("#topic0").change(nextList);
        //if no topic is selected, prevent submit
        $("form").submit( function() {
            if ($("#topic").val() == '-1') 
            {
                $('#error').html("You must select a valid topic");
                return false;
            }
        });

    }//end init

    function addProblem()
    {
        //write everything, but of course without any values
        $('#output').append("<br /><h4>Problem Number " + probNum + "</h4>");
        $('#output').append("<canvas id='canvas"+probNum+"'></canvas>")
        $('#output').append("<textarea class='mathdoxformula' id='formula"+probNum+"' rows='10' cols='80'></textarea><br />\n");
        $('#output').append("<textarea id='txt"+probNum+"'></textarea>\n");
        $("#num_probs").val(probNum);
        //Make a new canvas
        canvas[probNum] = new Canvas.Element();
        canvas[probNum].init(('canvas'+probNum), { width: 400, height: 400});
        img[img.length] = new Canvas.Img('img1', {});
        img[img.length] = new Canvas.Img('img2', {});
        img[img.length] = new Canvas.Img('img3', {});
        canvas[probNum].addImage(img[0]);
        canvas[probNum].addImage(img[1]);
        canvas[probNum].addImage(img[2]);
        canvas[probNum].setCanvasBackground(img[2]);
        //make new formula box
        if (!org) 
        {
            alert("no org");
        }
        org.mathdox.formulaeditor.FormulaEditor.updateByTextAreas();
        //increment problem
        probNum++;
    }

    //More javascript to make the problem selector. I should really start organizing this stuff
    var numSelects = 1;

    function nextList() {
        //define default values for current id, parent and next index
        var topicID = $(this).val();
        var parIndex = $('li').index($(this).parent());
        var nextIndex = $('li').index($(this).parent())+1;
        //when selecting a new topic, destroy all old subselections
        $("#topic_list").children().slice(nextIndex).remove();
        //set new topic id
        $("#topic").val(topicID);
        //if it didn't go to zero, append a new topic
        if (topicID != "-1")
        {
            $('#topic_list').append("<li><select id='topic"+nextIndex+"'></select></li>");
            $('#topic'+nextIndex).load("<?=base_url()?>ajax/load_topic_list", {"parent_topic":topicID});
            $('#topic'+nextIndex).change($.proxy(nextList, $('#topic'+nextIndex)));
        }
    }

    //]]>
    </script>

    <img id="img1" class="canvas-img" src="<?=base_url()?>images/canvas/7.jpg" /> 
    <img id="img2" class="canvas-img" src="<?=base_url()?>images/canvas/8.jpg" /> 
    <img id="img3" class="canvas-img" src="<?=base_url()?>images/canvas/9.jpg" />

    <!--Button to replicate and form closing-->
    <div class="container">
        <button id="add_problem" type="button">Add another problem</button>
    </div>

//and more stuff 
```

主题选择不是我正在做的事情，我只是为了完整性而将其包括在内。

现在，我遇到的一些问题可能与样式有关——一方面，画布没有正确堆叠，而是排成一排，图像确实插入但不拖动或调整大小。我很难找到适合初学者的文档，所以如果这实际上是一个我没有正确研究的非常简单的问题，请让我知道并抱歉给您带来麻烦。

最终我希望通过按钮插入图像，但现在如果我能让画布像示例中那样正常工作，但可以通过我的`addProblem()`功能重现，我会很高兴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T15:39:35.323

我已经回答了我自己的问题：雅虎库是一个糟糕的选择。我已经开始使用[fabric.js](http://fabricjs.com/)并且发现它更加灵活，另外它也不需要任何样式编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:35:15.307

您找到的示例似乎正在使用 Yahoo YUI 库。这并不意味着它不好，但如果你做错了什么，我不能打电话，因为我不使用这个库。首先，验证您是否已包含示例中的库文件。

然后尝试在 Javascript 控制台中查看代码中的错误。您可以通过按 CTRL+ALT+I（或 Mac 上的 CMD+ALT+I）来显示控制台（取决于您的浏览器）。如果您找到它，当您尝试拖动/调整图像大小时，您可能会看到一些错误。

对于“同时多个画布”部分，我认为您的代码看起来不错。

# php - PHP - Curl - multipart/form-data 与 application/octet-stream 用于空白文件

> ID：13071747
> 
> 赞同：1
> 
> 时间：2012-10-25T15:14:59.090
> 
> 标签：php, file, curl, upload, multipartform-data

我需要能够通过 PHP 和 CURL 向服务器发送 multipart/form-data 发布请求。

我能够获得正确的内容类型以及发送常用变量，如下所示。

```
------------------------------2f860b21c344
Content-Disposition: form-data; name="contactId"

8
------------------------------2f860b21c344
Content-Disposition: form-data; name="wt"

00:00:00
------------------------------2f860b21c344 
```

此部分出现问题：

```
-----------------------------221901842288
Content-Disposition: form-data; name="attchmnt[0]"; filename=""
Content-Type: application/octet-stream

-----------------------------221901842288 
```

我得到的最接近的是：

```
------------------------------2f860b21c344
Content-Disposition: form-data; name="attchmnt[0]"

filename="";type=application/octet-stream
------------------------------2f860b21c344 
```

我正在为 POST 数据使用一个数组，因为需要多部分标头，所以就 CURL 代码而言，它 100% 工作，只是这个数组不工作。以下是完整的数据数组：

```
<?PHP
$dataArray = array(
'tid' => '',
'parentId' => '',
'contactId' => '8',
'wt' => '00:00:00',
'ts' => 'OFF',
'smtl' => '',
'ctctCombo' => 'John Hawkins',
'contact' => '8',
'location' => '16',
'priority' => '-2',
'group' => '1',
'status' => '2',
'category' => '5',
'categoryOption' => '8',
'estimatedDate' => '',
'assignedTo' => '16',
'asset' => '',
'zenAsset' => '',
'cf_20_new' => '512',
'subject' => 'Subject',
'cc' => '',
'bc' => '',
'note' => 'Message',
'attchmnt[0]' => 'filename="";type=application/octet-stream',
'notifyTech' => 'on',
'_notifyTech' => '',
'_notifyUser' => ''
);
?> 
```

所以问题是，如何让 CURL 将 'filename="";type=application/octet-stream' 添加到 name="attchmnt[0]"; ?

如果我可以只上传一个文件会很简单，但是我需要指定它是一个文件流，只是没有上传文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T13:49:23.127

恐怕没有**干净的方法可以做到这一点。**您可以使用 @ 语法上传现有文件（然后 cURL 指定`octet-stream`并且还使用您在 中提供的文件名`filename`。但您不能以这种方式指定*空*文件名。

你可以这样做......针对你自己的代码的多行注入攻击。cURL 似乎并不介意，但我不知道它是否是*设计*使然，允许你做肮脏的行为，或者它是否是*偶然的*并且可能在下一个版本中停止工作：

```
$dataArray['attchmnt[0]"; filename=""'."\r\n".'Content-Type: octet-stream'] = ''; 
```

这转化为：

```
 0x0a30:  2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
    0x0a40:  2d2d 2d2d 2d2d 2d2d 2d2d 2d33 6331 3837  -----------3c187
    0x0a50:  3162 6630 3132 360d 0a43 6f6e 7465 6e74  1bf0126..Content
    0x0a60:  2d44 6973 706f 7369 7469 6f6e 3a20 666f  -Disposition:.fo
    0x0a70:  726d 2d64 6174 613b 206e 616d 653d 2261  rm-data;.name="a
    0x0a80:  7474 6368 6d6e 745b 305d 223b 2066 696c  ttchmnt[0]";.fil
    0x0a90:  656e 616d 653d 2222 0d0a 436f 6e74 656e  ename=""..Conten
    0x0aa0:  742d 5479 7065 3a20 6f63 7465 742d 7374  t-Type:.octet-st
    0x0ab0:  7265 616d 220d 0a0d 0a0d 0a2d 2d2d 2d2d  ream"......-----
    0x0ac0:  2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
    0x0ad0:  2d2d 2d2d 2d2d 2d2d 2d33 6331 3837 3162  ---------3c1871b
    0x0ae0:  6630 3132 362d 2d0d 0a                   f0126--.. 
```

这应该是你所追求的。

## 测试

```
// $dataArray as defined by you

// Change the 'attchmnt[0]' entry
$dataArray['attchmnt[0]"; filename=""'."\r\n".'Content-Type: octet-stream'] = '';

$ch = curl_init();
curl_setopt($ch, CURLOPT_HEADER,         False);
curl_setopt($ch, CURLOPT_VERBOSE,        False);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, True);
curl_setopt($ch, CURLOPT_URL,            'http://127.0.0.1/');
curl_setopt($ch, CURLOPT_POST,           True);
curl_setopt($ch, CURLOPT_POSTFIELDS,     $dataArray);
curl_exec($ch); 
```

# c++ - 比较运算符重载中第一个参数为空时的 C++ 分段错误

> ID：13071748
> 
> 赞同：3
> 
> 时间：2012-10-25T15:15:00.113
> 
> 标签：c++, parameters, null, segmentation-fault, operator-keyword

我正在编写一个名为 的类`Word`，它处理 ac 字符串并重载 `<`, `>`, `<=`,`>=`运算符。

**`word.h`：**

```
friend bool operator<(const Word &a, const Word &b); 
```

**`word.cc`：**

```
bool operator<(const Word &a, const Word &b) {
  if(a == NULL && b == NULL)
    return false;

  if(a == NULL)
    return true;

  if(b == NULL)
    return false;

  return strcmp(a.wd, b.wd) < 0;  //wd is a valid c string, EDIT: changed to strcmp
} 
```

**`main`：**

```
char* temp = NULL;     //EDIT: i was mistaken, temp is a char pointer
Word a("blah");    //a.wd = [b,l,a,h]
cout << (temp<a); 
```

我`operator<`在`main`. 我可以通过写来纠正问题

```
cout << (a>temp); 
```

类似的`operator>`定义并且我没有收到任何错误，但我的任务需要`(temp < a)`工作，所以这是我寻求帮助的地方。

**编辑：**我第一次犯了一个错误，我说 temp 是 type `Word`，但它实际上是 type `char*`。所以我假设编译器`Word`使用我的一个构造函数将 temp 转换为 a 。我不知道它会使用哪个，以及为什么这会起作用，因为第一个参数不是`Word`.

这是我认为用于使用的构造`Word`函数`temp`：

```
Word::Word(char* c, char* delimeters="\n") {
  char *temporary = "\0";
  if(c == NULL)
    c = temporary;
  check(stoppers!=NULL, "(Word(char*,char*))NULL pointer"); // exits the program if the expression is false
  if(strlen(c) == 0)
    size = DEFAULT_SIZE;  //10
  else
    size = strlen(c) + 1 + DEFAULT_SIZE;
  wd = new char[size];
  check(wd!=NULL, "Word(char*,char*))heap overflow");
  delimiters = new char[strlen(stoppers) + 1];      // EDIT: changed to []
  check(delimiters!=NULL,"Word(char*,char*))heap overflow");
  strcpy(wd,c);
  strcpy(delimiters,stoppers);
  count = strlen(wd);
} 
```

`wd`是类型`char*`

感谢您查看这个大问题并提供帮助。让我知道您是否需要更多代码来查看

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:48:07.793

I'm almost positive you did not mean to construct a `char` on the heap with an initial value of some integer based on the size of `stoppers`:

```
delimiters = new char(strlen(stoppers) + 1); // Should use [] not () 
```

Also you are using C++ and I would never tell you what to do, but please, unless you know exactly that there is no danger, do not use `strcpy`. For exactly this reason.

It is a blind copy of strings, and when the destination does not have enough space (as is the case from your typo-ed allocation), things go BAD.

EDIT:

I also see in your overload of `operator<` that you use

```
a.wd < b.wd 
```

and claim that .wds are valid C strings. If that is the case, you cannot apply a simple < operator to them and must use `strcmp`, `strncmp` or some other full compare function

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T17:01:23.707

删除构造函数的其他部分：

```
Word::Word(char* c, char* delimeters=NULL) {
    check(stoppers!=NULL, "(Word(char*,char*))NULL pointer");  //exits the program if the expression is false
    delimiters = new char[strlen(stoppers) + 1];
    check(delimiters!=NULL,"Word(char*,char*))heap overflow");
    strcpy(delimiters,stoppers);
} 
```

您正在分配和复制到输入参数 ( `delimiters`) 而不是成员变量 ( `stoppers`)。因此，当您调用时：

```
delimiters = new char[strlen(stoppers) + 1]; 
```

在这里，`stoppers == NULL`（从`check`调用中推断）所以`strlen(NULL)`崩溃了。

此外，在：

```
bool operator<(const Word &a, const Word &b) 
```

您检查诸如`a == NULL`. 这不是必需的，因为`a`它们`b`是引用，因此对象是非空的。

如果`wd`可以为空，则需要将这些更改为检查`a.wd`和`b.wd`。

# php - 如何设置自动换行 PhpExcel？

> ID：13071752
> 
> 赞同：2
> 
> 时间：2012-10-25T15:15:07.740
> 
> 标签：php, phpexcel

我正在使用 PHPExcel 生成一些 excel 导出。Excel 具有自动换行功能。我怎样才能激活它？

我的客户只使用 Microsoft Excel，因此它不必支持其他程序。

有任何想法吗 ？

我可能会使用这样的东西：[how to make New lines in a cell using phpexcel](https://stackoverflow.com/questions/5960242/how-to-make-new-lines-in-a-cell-using-phpexcel)但这更像是一种 hack，而不是真正的解决方案。

**更新：** 请参阅，一旦合并列，换行文本失败。我尝试在合并的每一列上添加换行文本，但它不影响结果。

![在此处输入图像描述](../Images/7f929dd46a39d499f1b4ba0e79a0d573.png)

**更新 2：**

单元格被合并，然后我添加换行文本，然后我添加文本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:30:53.687

将列设置为固定宽度；setWrapText(true) 为单元格，看看会发生什么。

以 /Tests/05featuredemo.php 中创建的第二张表为例。

如果你想精确控制换行的位置，你只需要使用 \n

# c++-cli - 将参数传递给 C++/CLI 中的任务？

> ID：13071753
> 
> 赞同：13
> 
> 时间：2012-10-25T15:15:11.850
> 
> 标签：c++-cli, arguments, action, task

我在 Visual Studio 2012 中有这个 C# 代码。

```
public Task SwitchLaserAsync(bool on)
{
   return Task.Run(new Action(() => SwitchLaser(on)));
} 
```

这将执行`SwitchLaser`方法（类的公共非静态成员`MyClass`）作为带有参数 bool 的任务。

我想在托管 C++/CLI 中做类似的事情。但是我无法找到如何运行任务的任何方法，该任务将执行一个采用一个参数的成员方法。

目前的解决方案是这样的：

```
Task^ MyClass::SwitchLaserAsync( bool on )
{
    laserOn = on;   //member bool 
    return Task::Run(gcnew Action(this, &MyClass::SwitchLaserHelper));
} 
```

功能实现`SwitchLaserHelper`：

```
void MyClass::SwitchLaserHelper()
{
     SwitchLaser(laserOn);
} 
```

必须有一些像 C# 这样的解决方案，而不是创建辅助函数和成员（这不是线程安全的）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-25T16:27:28.097

目前还没有任何方法可以做到这一点。

在 C# 中，您有一个闭包。在编写 C++/CLI 编译器时，仍在讨论 C++ 中闭包的标准化语法。值得庆幸的是，微软选择等待并使用标准 lambda 语法，而不是引入另一种独特的语法。不幸的是，这意味着该功能尚不可用。如果是，它看起来像：

```
gcnew Action([this, on](){ SwitchLaser(on) }); 
```

当前的线程安全解决方案是做 C# 编译器所做的事情——将帮助函数和数据成员不放入当前类，而是放入嵌套子类型。当然`this`，除了本地变量之外，您还需要保存指针。

```
ref class MyClass::SwitchLaserHelper
{
    bool laserOn;
    MyClass^ owner;

public:
    SwitchLaserHelper(MyClass^ realThis, bool on) : owner(realThis), laserOn(on) {}
    void DoIt() { owner->SwitchLaser(laserOn); }
};

Task^ MyClass::SwitchLaserAsync( bool on )
{
    return Task::Run(gcnew Action(gcnew SwitchLaserHelper(this, on), &MyClass::SwitchLaserHelper::DoIt));
} 
```

C++ lamdba 语法将为您简单地创建该帮助程序类（目前它适用于本机 lambda，但不适用于托管 lambda）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-17T01:13:35.623

这是我今天下午写的通用代码，它可能会有所帮助（尽管它与这个问题不完全匹配）。也许这会帮助下一个偶然发现这个问题的人。

```
generic<typename T, typename TResult>
ref class Bind1
{
    initonly T arg;
    Func<T, TResult>^ const f;
    TResult _() { return f(arg); }

public:
    initonly Func<TResult>^ binder;
    Bind1(Func<T, TResult>^ f, T arg) : f(f), arg(arg) {
        binder = gcnew Func<TResult>(this, &Bind1::_);
    }
};

ref class Binder abstract sealed // static
{
public:
    generic<typename T, typename TResult>
    static Func<TResult>^ Create(Func<T, TResult>^ f, T arg) {
        return (gcnew Bind1<T, TResult>(f, arg))->binder;
    }
}; 
```

用法是

```
const auto f = gcnew Func<T, TResult>(this, &MyClass::MyMethod);
return Task::Run(Binder::Create(f, arg)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-03-13T05:15:06.200

这是有效的答案..已经测试过..将参数（int）传递给动作sampleFunction。

```
#include "stdafx.h"
#include "CLRSamples.h"

using namespace System;
using namespace System::Threading;
using namespace System::Threading::Tasks;
using namespace System::Collections;
using namespace System::Collections::Generic;

void CLRSamples::sampleFunction(Object^ number)
{
    Console::WriteLine(number->ToString());
    Thread::Sleep((int)number * 100);
}

void CLRSamples::testTasks()
{
    List<Task^>^ tasks = gcnew List<Task^>();

    for (int i = 0; i < 10; i++)
    {
        tasks->Add(Task::Factory->StartNew((Action<Object^>^)(gcnew Action<Object^>(this, &CLRSamples::sampleFunction)), i));
    }

    Task::WaitAll(tasks->ToArray());

    Console::WriteLine("Completed...");
}

int main(array<System::String ^> ^args)
{
    CLRSamples^ samples = gcnew CLRSamples();
    samples->testTasks();

    Console::Read();
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-06T07:06:48.397

当我想为执行不返回值的方法（retuns `void`）的任务提供参数时，我遇到了类似的问题。因为那`Func<T, TResult>`不是我可以使用的选项。有关更多信息，请查看页面[Using void return types with new Func](https://stackoverflow.com/q/4244359/679890)。

所以我最终得到了一个解决方案，我创建了一个帮助类

```
template <typename T>
ref class ActionArguments
{
public:
    ActionArguments(Action<T>^ func, T args) : m_func(func), m_args(args) {};
    void operator()() { m_func(m_args); };

private:
    Action<T>^ m_func;
    T m_args;
}; 
```

它使用`Action<T>`委托来封装具有单个参数且不返回值的方法。

然后我会以下列方式使用这个助手类

```
ref class DisplayActivationController
{
public:
    DisplayActivationController();

    void StatusChanged(EventArgs^ args) { };
}

Action<EventArgs^>^ action =
    gcnew Action<EventArgs^>(this, &DisplayActivationController::StatusChanged);
ActionArguments<EventArgs^>^ action_args =
    gcnew ActionArguments<EventArgs^>(action, args);
Threading::Tasks::Task::Factory->
    StartNew(gcnew Action(action_args, &ActionArguments<EventArgs^>::operator())); 
```

使用 helper 类的方法可能不是最优雅的解决方案，但它是我能找到的在不支持 lambda 表达式的 C++/CLI 中使用的最佳解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-10T09:18:48.287

如果您使用的是 c++/CLR，则制作一个 C# dll 并添加对它的引用

```
namespace TaskClrHelper
{
  public static class TaskHelper
  {
    public static Task<TResult> StartNew<T1, TResult>(
     Func<T1, TResult> func,
     T1 arg)
      => Task.Factory.StartNew(() => func(arg));

    public static Task<TResult> StartNew<T1, T2, TResult>(
     Func<T1, T2, TResult> func,
     T1 arg1, T2 arg2)
      => Task.Factory.StartNew(() => func(arg1, arg2));
  }
} 
```

```
 bool Device::Stop(int timeout)
        {
            _ResetEvent_Running->Set();
            return _ResetEvent_Disconnect->WaitOne(timeout);
        }
        Task<bool>^ Device::StopAsync(int timeout)
        {
            auto func = gcnew Func<int, bool>(this, &Device::Stop);
            return TaskClrHelper::TaskHelper::StartNew<int,bool>(func,timeout);
        } 
```

# ruby-on-rails - 如何在 Rails 的 url 中输入电子邮件地址

> ID：13071758
> 
> 赞同：6
> 
> 时间：2012-10-25T15:15:26.110
> 
> 标签：ruby-on-rails, ruby, email, url

我想邀请在这样的网址中传递电子邮件的人：

```
localhost:3000/invite_me/email@gmail.com 
```

我试过这个`match`，但它不工作。

```
match "/invite_me/:email" => "application#invite_me",
    :constraints => { :email => '/.+@.+\..*/' } 
```

我收到以下错误：

```
No route matches [GET] "/invite_me/waldyr.ar@gmail.com" 
```

耙路线输出：

```
root  /                           application#index
  /invite_me/:email(.:format) application#invite_me {:email=>"/.+@.+\\..*/"} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-25T15:20:12.957

您的约束需要是实际的正则表达式而不是字符串

```
match "/invite_me/:email" => "application#invite_me",
    :constraints => { :email => '/.+@.+\..*/' } 
```

应该

```
match "/invite_me/:email" => "application#invite_me",
    :constraints => { :email => /.+@.+\..*/ } 
```

# css - 禁用 CSS 规则

> ID：13071760
> 
> 赞同：0
> 
> 时间：2012-10-25T15:15:36.923
> 
> 标签：css, content-management-system

这是我的问题：
我使用的 CMS 带有我不想修改的默认 CSS 文件，因为 CMS 更新可能会替换此文件。因此，除了默认 CSS 文件之外，我还使用自定义 CSS 文件来更改 CMS 主题。
但有时我只想禁用写在默认 CSS 文件中的规则。由于我无法删除或评论该规则，因此我在自定义 CSS 文件中使用属性中的默认值重新编写了相同的规则。

**例子 ：**

```
/* default CSS file */
.class { background-color : black; }

/* cutom CSS file */
.class { background-color : none; } 
```

所以我想知道是否有办法在不重写相同规则的情况下禁用规则？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:28:39.327

我想……基本上没有。您必须指定要禁用的完全相同的规则。

但是您可以向 css 文件添加一些后处理器。在 apache 中，所有 css 请求都会路由到 postprocessor.php 之类的东西，在那里您可以使用某些解析器、替换器删除不需要的代码。

第二个选择是为 cms 制作一些插件，其中有一些设置。

第三种方法是使用一些动态/元/脚本 css 语言等 SASS，LESS 来生成此禁用规则。

# sql - SQL Server - 前一个日期不为空时获取最高值

> ID：13071766
> 
> 赞同：2
> 
> 时间：2012-10-25T15:16:10.933
> 
> 标签：sql, sql-server

我有一个表格，其中包含玩家在任何一天所采取的步骤的信息，我想从数据库中获取 3 个最高的总数，当高总数的前一天为该玩家增加了价值。由于有些玩家不是每天都登录，而是将多天的时间集中在一次更新中。

数据结构：

```
|---------------------------------------------------------------|
| id | player_id | steps | date       | submitted               |
|----|-----------|-------|------------|-------------------------|
| 1  | 16        | 5718  | 2012-09-06 | 2012-09-10 08:31:35.000 |
| 2  | 16        | 9837  | 2012-09-07 | 2012-09-10 08:31:17.000 |
| 3  | 16        | 10432 | 2012-09-09 | 2012-09-10 08:30:54.000 |
| 4  | 30        | 3973  | 2012-09-07 | 2012-09-10 09:34:42.000 |
| 5  | 30        | 7104  | 2012-09-08 | 2012-09-10 09:35:05.000 |
| 6  | 30        | 10916 | 2012-09-09 | 2012-09-10 09:35:29.000 |
| 7  | 9         | 6437  | 2012-09-07 | 2012-09-10 09:39:15.000 |
| 8  | 9         | 9032  | 2012-09-08 | 2012-09-10 09:40:02.000 |
|---------------------------------------------------------------| 
```

所以我要返回的是行：

```
|---------------------------------------------------------------|
| 6  | 30        | 10916 | 2012-09-09 | 2012-09-10 09:35:29.000 |
| 2  | 16        | 9837  | 2012-09-07 | 2012-09-10 08:31:17.000 |
| 8  | 9         | 9032  | 2012-09-08 | 2012-09-10 09:40:02.000 |
|---------------------------------------------------------------| 
```

我的查询目前是：

```
SELECT TOP 3 p.name,
             player_id,
             steps,
             date
FROM   steppers_step_log
       JOIN steppers_players P
         ON player_id = P.id
ORDER  BY steps DESC 
```

这没有考虑到前 3 个步骤中是否有一个日期条目，我的当前形式的查询将返回 10432、10916 和 9837 作为顶部步骤。

我在弄清楚如何执行 WHERE 命令以确保前一天有该 player_id 的条目时遇到了麻烦，并且希望能提供任何帮助以使其正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:22:27.760

像这样的东西？

```
SELECT TOP 3 p.name,
             player_id,
             steps,
             date
FROM   steppers_step_log
       JOIN steppers_players P
         ON player_id = P.id
WHERE EXISTS
(
   SELECT 1 FROM steppers_step_log ssp
   WHERE ssp.player_id = P.id
   AND date = DATEADD(day, -1, steppers_step_log.date)
)
ORDER  BY steps DESC 
```

[日期添加 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms186819.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:24:35.010

您可以简单地`WHERE`使用`EXISTS`条件添加子句...

```
SELECT TOP 3
  p.name,
  player_id,
  steps,
  date
FROM
  steppers_step_log    AS log
INNER JOIN
  steppers_players     AS players
     ON log.player_id = players.id
WHERE
  EXISTS (
    SELECT *
      FROM steppers_step_log
     WHERE player_id = players.id
       AND date      = log.date - 1
  )
ORDER BY
  log.steps DESC 
```

但是，这*可以*多次返回同一玩家；如果他们在前 3 名中有多个条目。这就是你想要的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T15:30:01.733

有几种方法可以解决这个问题。其他人可能会使用连接/存在类型查询来解决问题。我喜欢另一种方法，它使用排名函数来获取适当的行。

您正在寻找的是上传序列，然后您不想要第一个。您可以通过枚举播放器的行来定义序列。然后，对于每个序列，日期和序列之间的差异是一个常数。然后，额外的排名得到你想要的。

要定义序列：

```
select stl.*,
       row_number() over (partition by player_id, groupid order by date) as seqnum
from (select stl.*,
             datediff(day, date,
                      row_number() over (partition by player_id order by date) as groupid
      from steppers_step_log stl
     ) stl 
```

现在，您可以使用以下方法获取“合格”行：

```
where seqnum > 1 
```

要获得每个玩家的三个最高值，您可以执行以下操作：

```
with stl as (<above query>)
select *
from (select stl.*,
             row_number() over (partition by player_id order by steps desc) as scorenum
      from stl
      where seqnum > 1
     ) stl
where scorenum <= 3 
```

# ios - 用动画隐藏导航控制器和标签栏控制器

> ID：13071767
> 
> 赞同：0
> 
> 时间：2012-10-25T15:16:15.147
> 
> 标签：ios, uinavigationcontroller, uitabbarcontroller, uiviewanimation

我试图在触摸按钮时同时隐藏 UITabBarController 和 UINavigationController 。我在这里找到了一个非常好的代码片段[How to hide uitabbarcontroller](https://stackoverflow.com/questions/5272290/how-to-hide-uitabbarcontroller/5272497#comment17733937_5272497)但是在尝试隐藏 UINavigationController 和 tabbarcontroller 并为其设置动画时遇到问题。当他们使用隐藏标签栏时，我还在互联网上找到了很多示例，`self.tabBarController.tabBar.hidden = YES`但这仅隐藏了按钮项而不是底部的黑条。

在玩了很多之后，我可以正确地制作动画，因为我认为它与导航控制器的隐藏有关，这使得整个窗口的大小可以即时改变。

```
-(IBAction)touchImage:(id)sender {

    if (isImageFullScreen) {

        isImageFullScreen = NO;

        [self.navigationController setNavigationBarHidden:NO animated:YES];
        [UIView transitionWithView:self.view
                          duration:0.5
                           options:UIViewAnimationOptionCurveLinear
                        animations:^
         {
             hotelImageButton.frame = CGRectMake(0,20,320,92);
             [self showTabBar:self.tabBarController];
         }
                        completion:^(BOOL finished)
         {
         }];

    } else {

        isImageFullScreen = YES;

        [self.navigationController setNavigationBarHidden:YES animated:YES];
        [UIView transitionWithView:self.view
                          duration:0.5
                           options:UIViewAnimationOptionCurveLinear
                        animations:^
         {
             hotelImageButton.frame = CGRectMake(0,0,320,480);
             [self hideTabBar:self.tabBarController];
         }
                        completion:^(BOOL finished)
         {                                  
         }];
    } 
```

}

hideTabBar 和 showTabBar 方法是我在上面链接的另一篇文章中的方法。

我也尝试了一些其他的组合，但我不能让它看起来很好。有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-29T16:18:39.663

我现在尝试了该代码，我发现 UITabBar 显示动画没有顺利进行。我设法通过将显示动画的选项卡栏的持续时间调整为较低来使其更平滑。

`[UIView setAnimationDuration:0.2];`

希望这行得通。

编辑：请尝试此代码，它会在 1 个动画事务中将父视图的大小调整为更大，从而仅隐藏条形并显示内容。

```
- (IBAction)TestButton1:(UIButton *)sender {

if(!isAnimating){
    if(isTabBarAndNavBarHidden){

        [UIView transitionWithView:self.view
                          duration:0.5
                           options:UIViewAnimationOptionTransitionNone
                        animations:^
         {
             isAnimating=YES;

             CGFloat statusBar_height=[[UIApplication sharedApplication] statusBarFrame].size.height;
             CGFloat screen_height=[UIScreen mainScreen].bounds.size.height;

             [self.tabBarController.view setFrame:CGRectMake(self.tabBarController.view.frame.origin.x, 0, self.tabBarController.view.frame.size.width, screen_height)];
             [self.navigationController.navigationBar setFrame:CGRectMake(self.navigationController.navigationBar.frame.origin.x, statusBar_height, self.navigationController.navigationBar.frame.size.width, self.navigationController.navigationBar.frame.size.height)];
         }
                        completion:^(BOOL finished)
         {
             isTabBarAndNavBarHidden=NO;
             isAnimating=NO;
         }];

    }else{

        [UIView transitionWithView:self.view
                          duration:0.5
                           options:UIViewAnimationOptionTransitionNone
                        animations:^
         {
             isAnimating=YES;

             CGFloat statusBar_height=[[UIApplication sharedApplication] statusBarFrame].size.height;
             CGFloat screen_height=[UIScreen mainScreen].bounds.size.height;

             [self.tabBarController.view setFrame:CGRectMake(self.tabBarController.view.frame.origin.x, statusBar_height-self.navigationController.navigationBar.frame.size.height, self.tabBarController.view.frame.size.width, screen_height+self.navigationController.navigationBar.frame.size.height+self.tabBarController.tabBar.frame.size.height-statusBar_height)];
             [self.navigationController.navigationBar setFrame:CGRectMake(self.navigationController.navigationBar.frame.origin.x, 0, self.navigationController.navigationBar.frame.size.width, self.navigationController.navigationBar.frame.size.height)];

         }
                        completion:^(BOOL finished)
         {
             isTabBarAndNavBarHidden=YES;
             isAnimating=NO;
         }];

    }
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-17T11:31:19.490

此代码适用于 iPhone 4/4S。

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    if (self.lastContentOffset > scrollView.contentOffset.y)
    {
          NSLog(@"Scrolling up");

        [UIView animateWithDuration:.5 delay:0.0 options:UIViewAnimationOptionCurveEaseIn animations:^{

            [self.tabBarController.tabBar setFrame:CGRectMake(0, 430, 320, 50)];
             [self.navigationController.navigationBar setFrame:CGRectMake(0, 20, self.navigationController.navigationBar.frame.size.width,self.navigationController.navigationBar.frame.size.height)];

             } completion:
           ^(BOOL finished) {

                [UIView animateWithDuration:.5 delay:0 options:UIViewAnimationOptionCurveEaseIn animations:^{

                      } completion:^(BOOL finished) {
                              //
                        }];

            }];

    }
    else if (self.lastContentOffset < scrollView.contentOffset.y)
    {
        [UIView animateWithDuration:.5 delay:0.0 options:UIViewAnimationOptionCurveEaseIn animations:^{
               [self.navigationController.navigationBar setFrame:CGRectMake(0, -60, self.navigationController.navigationBar.frame.size.width, self.navigationController.navigationBar.frame.size.height)];
            [self.tabBarController.tabBar setFrame:CGRectMake(0, 480, 320, 50)];

        } completion:
         ^(BOOL finished) {

             [UIView animateWithDuration:.5 delay:2.0 options:UIViewAnimationOptionCurveEaseIn animations:^{

             } completion:^(BOOL finished) {

             }];

         }];

        NSLog(@"Scrolling Down");

    }

    self.lastContentOffset = scrollView.contentOffset.y;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    [self.tabBarController.tabBar setFrame:CGRectMake(0, 430, 320, 50)];
     [self.navigationController.navigationBar setFrame:CGRectMake(0, 20, self.navigationController.navigationBar.frame.size.width,self.navigationController.navigationBar.frame.size.height)];

    // Do any additional setup after loading the view.
} 
```

# php - 如何在 Mac OS X 10.8 Mountain Lion 上安装 OCI8 PHP 扩展

> ID：13071768
> 
> 赞同：2
> 
> 时间：2012-10-25T15:16:14.100
> 
> 标签：php, osx-mountain-lion, apache2.2, oci8

我需要在 Mountain Lion 上为 PHP 使用 OCI8 模块，该模块将使用 oracle 即时客户端，目前仅支持 32 位。

我已经安装了 32 位版本的 oracle 即时客户端并使用 sqlplus 对其进行了测试，一切似乎都很好。

但是现在我需要让 PHP 扩展 OCI8 工作，这导致我用自制软件为 apache 构建了一个 32 位 PHP 模块。这似乎再次起作用，但据我了解，这现在需要 32 位的 Apache 构建，内置版本似乎只有 64 位。我不知道如何将 Apache 构建为 32 位，我什至不确定这是必需的，所以有点不知所措。非常感谢阿拉斯泰尔的任何帮助

**编辑：**

现在我已经放弃了原生安装，转而使用 Vagrant 和 Ubuntu 进行虚拟化开发：[https ://github.com/afhole/vagrant-lamp](https://github.com/afhole/vagrant-lamp)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T14:28:09.367

去那里：[http ://www.oracle.com/technetwork/topics/intel-macsoft-096467.html](http://www.oracle.com/technetwork/topics/intel-macsoft-096467.html)

使用文件的版本**11.2.0.3.0（64 位）**。

编辑：在下面提供的说明中，更改行：

```
sudo ln -s libclntsh.dylib.10.1 libclntsh.dylib 
```

到

```
sudo ln -s libclntsh.dylib.11.1 libclntsh.dylib 
```

安装说明在这里：[http ://www.enavigo.com/2012/01/04/enabling-oracle-oci8-php-extension-on-os-x-snow-leopard/](http://www.enavigo.com/2012/01/04/enabling-oracle-oci8-php-extension-on-os-x-snow-leopard/)

它适用于 10.8.2 下的 Macbook Air

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T22:32:54.703

我正在尝试做同样的事情，并且该线程中的答案似乎有效：

[强制 Apache HTTPD 以 32 位运行](https://stackoverflow.com/questions/261927/force-apache-httpd-to-run-in-32bit)

例如你可以跑

```
(sudo) arch -i386 apachectl start
(sudo) arch -i386 apachectl stop
(sudo) arch -i386 apachectl restart 
```

强制 Apache 以 32 位模式运行。

如果您总是想在 32 位模式下运行，您可以将 arch 命令添加到`<string>`.`<key>ProgramArguments</key>``/System/Library/LaunchDaemons/org.apache.httpd.plist`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-19T00:21:21.287

经过大量研究，我找到了在 OS X 上使用 PHP 和 OCI8 配置 Apache 的可持续解决方案。您可以在任何地方安装 Oracle Instant Client 库，然后您需要做的就是编辑 Apache 的`launchd`配置`.plist`文件以指定所需`DYLD_LIBRARY_PATH`的`ORACLE_HOME`、 和`LD_LIBRARY_PATH`环境变量以便 PHP 可以实际看到它们（`~/.bash_profile`当 PHP 作为 Apache 模块运行时，它不会从您那里看到这些环境变量）。

我还成功地让 OCI8 在 OS X 10.7.4 和 OS X 10.8.4 上的 64 位版本的 Apache 和 PHP 下工作。我最初将 32 位和 64 位版本的 Oracle Instant Client 库组合成多架构胖二进制文件。这允许不同的工具在我的系统上使用相同的 Oracle Instant Client 库，其中一些以 32 位模式运行，而另一些以 64 位模式运行。在 OS X 10.8 上，您应该可以成功使用最近发布的 64 位版本的 Oracle Instant Client 库，而不必求助于在 32 位模式下运行 Apache。当我有更多时间时，我会尝试写下我所做的事情，因为它也可能对其他人有所帮助。

您可以在此处查看有关配置 Apache“进程特定”环境变量的完整答案：[https ://stackoverflow.com/a/20670810/1914455](https://stackoverflow.com/a/20670810/1914455)

# jquery - 垂直和水平的表头

> ID：13071770
> 
> 赞同：1
> 
> 时间：2012-10-25T15:16:16.757
> 
> 标签：jquery, html, django

任何人都可以帮助我如何实现这个输出。如果有可能。

我想水平和垂直地查看我的标题。

例如

```
 Header 4  Header 5 Header 6 Calendar
Header 1    a        b        c        10/10
Header 2    d        e        f        11/10
Header 3    g        h        i        12/10 
```

垂直标题是硬编码的，但水平标题应该从数据库上传（由用户输入），我希望日历显示在列的末尾。这意味着如果让说用户确实输入了 5 个输入并且它显示在水平标题中，并且日历应该显示在第 7 列。

这是我的html

```
{% if solutions%}
<div id ="person_table">
<form action="{% url Solution_view person_NOID %}" method="post">
{% csrf_token %}
<table border="1" id="thetable">
<thead>
      <tr>
      <th>NOID {{ person_NOID }}</th>
      <th>SMOKING</th>
      <th>WEIGHT</th>
      <th>BP</th>
      </tr>
</thead>
<tbody>
{% for solution in solutions %}

<tr>
    <td>{{ solution.NEW_DATE }}</td>
    <td><input type="text" name="solution" id="solution{{ forloop.counter }}" value="{{ solution.SMOKING}}" /></td>
    <td><input type="text" name="solution" id="solution{{ forloop.counter }}" value="{{ solution.WEIGHT}}" /></td>
    <td><input type="text" name="solution" id="solution{{ forloop.counter }}" value="{{ solution.BP}}" /></td>
    <td><input type="text" name="solution" id="solution{{ forloop.counter }}" value="{{ solution.BP}}" /></td>
</tr>
{% endfor %}                
</tbody>
</table>
<input type="submit" value="Save" />
</form>
{% else %}
<p>No Data.</p>
{% endif %}
</body> 
```

我不知道这是否可以做到。看来我与[这个](https://stackoverflow.com/questions/7354906/vertical-and-horizontal-headers-in-a-table?rq=1)SO 无关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:01:50.473

您始终可以根据需要使用自定义模板来显示数据。如果您需要具有分页、排序等功能的现有插件，我会推荐[jqgrid](http://www.trirand.com/blog/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T20:17:28.617

您可以使用很多 jquery 插件，我自己也使用过 datatables 和 jquery powertable。以下是网站，最后一个链接是一个示例

1\. [Datatables](http://datatables.net/)：可能是我遇到的最强大的 jquery 表插件。

2\. [jQuery Powertable](http://trentrichardson.com/examples/jQuery-Powertable/index.html)：jquery中著名的日期时间选择器的作者。

3\. [JQ Grid](http://www.trirand.com/blog/jqgrid/jqgrid.html)：自己没有测试过，但是看起来很扎实。

[4.powertable](http://fundapass.blogspot.com/2012/06/jquery-powertable.html)上的示例链接

# php - 在mysqli中将这行代码更改为什么

> ID：13071771
> 
> 赞同：1
> 
> 时间：2012-10-25T15:16:19.523
> 
> 标签：php, mysql, pdo, mysqli

我正在尝试将我的代码从 mysql 更改为 mysqli，但我在更改这段代码时遇到了麻烦：

```
while($sqlrow = mysql_fetch_array($sqlresult)) 
{ 
     $room = $sqlrow['Room']; 
     $roomHTML .= "<option value='".$room."'>" . $room . "</option>".PHP_EOL;  
} 

echo $roomHTML; 
```

我在 mysqli 代码中没有变量 $sqlrow ，下面，我该如何将行更改`$room = $sqlrow['Room'];`为以下内容：

完整代码：

```
 $building = isset($_POST['building']) ? $_POST['building'] : ''; 

  $sql = "SELECT Room FROM Room WHERE Building = ?"; 

 $sqlstmt=$mysqli->prepare($sql);

 $sqlstmt->bind_param("s",$building);

     $sqlstmt->execute(); 

     $sqlstmt->bind_result($dbRoom);

    $roomHTML  = "";  

     while($sqlstmt->fetch()) { 
         $room = $sqlrow['Room']; 
         $roomHTML .= "<option value='".$room."'>" . $room . "</option>".PHP_EOL;  
    } 

    echo $roomHTML; 

     $sqlstmt->execute(); 
```

上面的代码试图在下拉菜单中显示与它们所属的建筑物匹配的所有房间。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:06:26.970

您没有使用绑定的结果 var `$dbRoom`。

```
// Your output value of interest is $dbRoom as you have bound here:
$sqlstmt->bind_result($dbRoom);
$roomHTML  = "";  

 while($sqlstmt->fetch()) { 
     // $dbRoom holds the value fetched from the result set, since that is what you bound above.
     // Note: added htmlentities() to encode quotes if there are any embedded in the room value.
     $roomHTML .= "<option value='". htmlentities($dbRoom, ENT_QUOTES) ."'>" . htmlspecialchars($dbRoom) . "</option>".PHP_EOL;  
} 
```

# java - 将 double 转换为 byte[] 数组

> ID：13071777
> 
> 赞同：0
> 
> 时间：2012-10-25T15:16:39.820
> 
> 标签：java, double, bytearray

如何在 Java 中将 double 转换为字节数组？我看了很多其他帖子，但找不到正确的方法。

```
Input = 65.43 
byte[] size = 6
precision = 2   (this might change based on input)

expected output (byte[]) = 006543 
```

我可以不使用 doubleToLongBits() 之类的函数吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-25T15:48:40.697

**实际转换`double`_`byte[]`**

```
double d = 65.43;
byte[] output = new byte[8];
long lng = Double.doubleToLongBits(d);
for(int i = 0; i < 8; i++) output[i] = (byte)((lng >> ((7 - i) * 8)) & 0xff);
//output in hex would be 40,50,5b,85,1e,b8,51,ec 
```

**`double`到 BCD 转换**

```
double d = 65.43;
byte[b] output = new byte[OUTPUT_LENGTH];
String inputString = Double.toString(d);
inputString = inputString.substring(0, inputString.indexOf(".") + PRECISION);
inputString = inputString.replaceAll(".", "");
if(inputString.length() > OUTPUT_LENGTH) throw new DoubleValueTooLongException();
for(int i = inputString.length() - 1; i >= 0; i--) output[i] = (byte)inputString.charAt(i)
//output in decimal would be 0,0,0,0,6,5,4,3 for PRECISION=2, OUTPUT_LENGTH=8 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-07-01T07:33:51.537

```
ByteBuffer.allocate(8).putDouble(yourDouble).array() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T15:41:31.417

```
public static byte[] encode(double input, int size, int precision) {
    double tempInput = input;

    for (int i = 0; i < precision; i++) tempInput *= 10;

    int output = (int) tempInput;

    String strOut = String.format("%0"+size+"d", output);

    return strOut.getBytes();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:47:25.520

```
double doubleValue = 10.42123;
DecimalFormat df = new DecimalFormat("#.##");
String newDouble = df.format(doubleValue);
byte[] byteArray = (newDouble.replace(",", "")).getBytes();

for (byte b : byteArray) {
    System.out.println((char)b+"");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-26T13:09:04.323

这是我根据您的输入得到的，它符合我的目的。感谢您的帮助！

```
static int formatDoubleToAscii(double d, int bytesToUse, int minPrecision, byte in[], int startPos) {

        int d1 = (int)(d * Math.pow(10, minPrecision));

        String t = String.format("%0"+bytesToUse+"d", d1).toString();
        System.out.println("d1 = "+ d1 + " t="+ t + " t.length=" + t.length());

        for(int i=0 ; i<t.length() ; i++, startPos++) {
            System.out.println(t.charAt(i));
            in[startPos] = (byte) t.charAt(i);
        }           

        return startPos;
    } 
```

# android - 我们可以限制在我们的设备中安装 .apk 文件吗？

> ID：13071779
> 
> 赞同：0
> 
> 时间：2012-10-25T15:16:44.900
> 
> 标签：android

我是android应用程序开发的新手。

我开发了一些 android 应用程序，并在客户端设备中安装了 .apk 文件，它们工作正常。

但我的要求是，我必须制作客户端设备，以支持仅安装我公司的 .apk 文件。如果客户端尝试安装任何外部 .apk 文件，则必须出现错误。

请帮助我前进。

谢谢你，再见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:34:15.523

我想这是唯一可能的，如果你对 Android OS 源本身进行更改，应该有一些 java 文件，我猜这个文件[负责](http://developer.android.com/reference/android/content/pm/PackageManager.html)安装/卸载，阻止非市场应用程序。只是说清楚。没有它，大多数情况下是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:55:30.590

将所有设备 ID 保存到一个 xml 文件中，并在应用程序启动时将其与您的应用程序捆绑只需获取设备 ID 并将其与您拥有的列表进行比较，如果 id 匹配则启动应用程序或显示错误

您不能阻止其他用户阻止安装，但我认为如果您按照上述步骤操作，他们将无法使用该应用程序，甚至无法打开该应用程序

# php - HTML 模板——php?

> ID：13071784
> 
> 赞同：12
> 
> 时间：2012-10-25T15:16:58.157
> 
> 标签：php, html, templates, templating

所以，我正在创建一个关于第一次世界大战的网站作为学校作业，我希望它出现在每个文档中：

```
<!DOCTYPE html>

<html>
<head>
    <title>1914</title>
    <script src="modernizr-1.5.js"></script>
    <link href="styles.css" type="text/css" rel="stylesheet" />
    <meta charset="utf-8" />

</head>
<body>
  <div id="container">
    <header>
    <img src="images/banner.png" alt="World War I" style="border: none"/>
    <nav>
        <ul>
        <a href="index.htm"><li><span>Home</span></li></a>
        <a href="1914.htm"><li><span>1914</span></li></a>
        <a href="1915.htm"><li><span>1915</span></li></a>
        <a href="1916.htm"><li><span>1916</span></li></a>
        <a href="1917.htm"><li><span>1917</span></li></a>
        <a href="1918.htm"><li><span>1918</span></li></a>
        </ul>
    </nav>
    </header>
    <section>
    <article>
    <br style="clear: both" />
    </article>
    <aside>
    </aside>
    </section>
    <footer style="font-weight: bold; letter-spacing: .1em">
    <a href="citations.htm">Citations</a> &bull;
    <a href="about.htm">About</a>
    </footer>
  </div>
</body>
</html> 
```

我认为将所有这些内容复制粘贴到每个文档中，如果我只想更改一个单词或标签，那么煞费苦心地进入并分别更改每个页面是一种愚蠢的做法。有没有办法我可以把它放在 template.htm （或类似的东西）中，让 php 或 javascript 代码接受它并将所请求文件中的所有内容插入`<article>`标签内？我不太了解php，所以这对各位大师来说可能是小菜一碟，但我将不胜感激。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-25T15:34:54.307

使用 php 包括：

将此保存为 top.php

```
<html>
<head>
<title><?php echo $title; ?></title>
<script src="modernizr-1.5.js"></script>
<link href="styles.css" type="text/css" rel="stylesheet" />
<meta charset="utf-8" />

</head>
<body>
<div id="container">
<header>
<img src="images/banner.png" alt="World War I" style="border: none"/>
<nav>
    <ul>
    <a href="index.htm"><li><span>Home</span></li></a>
    <a href="1914.htm"><li><span>1914</span></li></a>
    <a href="1915.htm"><li><span>1915</span></li></a>
    <a href="1916.htm"><li><span>1916</span></li></a>
    <a href="1917.htm"><li><span>1917</span></li></a>
    <a href="1918.htm"><li><span>1918</span></li></a>
    </ul>
</nav>
</header>
<section> 
```

将此另存为bottom.php

```
<aside>
</aside>
</section>
<footer style="font-weight: bold; letter-spacing: .1em">
<a href="citations.htm">Citations</a> &bull;
<a href="about.htm">About</a>
</footer>
</div>
</body>
</html> 
```

那么您的个人页面将是这样的：

```
<?php $title = '1914'; include("top.php");?>
//This would be where you would make the changes that need to be made on each page.

<article>
<br style="clear: both" />
</article>

<?php include("bottom.php");?> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-13T21:16:04.160

您可以考虑以下流行的模板引擎之一：

*   **[Smarty](http://www.smarty.net/)**（变得过时）

*   **[拿铁](https://github.com/nette/latte)**（主要由**[Nette](http://nette.org/)**社区使用）

*   **[Twig](http://twig.sensiolabs.org/documentation)**（主要由**[Symfony](http://symfony.com/)**社区使用）

*   **[Mustache](http://mustache.github.io/)**（这个模板引擎的官方实现存在于超过两​​打编程/脚本语言中）

我倾向于**[Mustache](http://mustache.github.io/)**，主要是因为它有**[官方 JS 版本](https://github.com/janl/mustache.js)**、 **[官方 Ruby 版本](https://github.com/defunkt/mustache)**、**[官方 Java 版本](https://github.com/spullara/mustache.java)**等。它允许您使用相同的模板前端和后端，这对于第一次渲染的小部件非常有用背景并在更新时在前台重新渲染。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T15:19:01.363

将内容放入文件**abc.php**

然后将此添加到您想要所需内容的每个页面：

```
<?php
include("abc.php");
?> 
```

因此，如果您的代码是：

```
<nav>
        <ul>
        <a href="index.htm"><li><span>Home</span></li></a>
        <a href="1914.htm"><li><span>1914</span></li></a>
        <a href="1915.htm"><li><span>1915</span></li></a>
        <a href="1916.htm"><li><span>1916</span></li></a>
        <a href="1917.htm"><li><span>1917</span></li></a>
        <a href="1918.htm"><li><span>1918</span></li></a>
        </ul>
    </nav>
    </header>
    <section>
    <article>
    <br style="clear: both" />
    </article>
    <aside>
    </aside>
    </section> 
```

并且您希望`<nav>`在每个页面中重复其中的部分，您可以将内容放在**abc.php**`<nav>`和`</nav>`（包括标签）之间，并将**abc.php**包含在您的文件中，如下所示：

 ****```
<?php
    include("abc.php");
?>
    </header>
    <section>
    <article>
    <br style="clear: both" />
    </article>
    <aside>
    </aside>
    </section> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:55:59.510

将模板文件创建为单个文件，就像您已经拥有它一样，但在您想要内容的地方打印 PHP 变量。

例如：

```
....
<article>
<?php print $mainContent; ?>
</article>
.... 
```

然后编写一个PHP函数如下：

```
<?php
function insertContentIntoTemplate($mainContent) {
    require_once('/path/to/template.php');
}
?> 
```

现在，您只需调用函数并将每个页面的内容传递给模板，就可以将页面内容加载到模板中。

因此，例如，1914.php 可能如下所示：

```
<?php
require_once('/path/to/insertFunction.php');

//the text could be loaded from a DB, or from another file, or just as a plain string like this:
$text = "The year was 1914, and the war was just starting.";

insertContentIntoTemplate($text);

?> 
```

恭喜。您现在有了一个工作（尽管非常简单）的模板系统。根据需要向您的模板添加更多变量/占位符。****

# c# - Linq to Entitites 查询无法将 Int 转换为 String

> ID：13071786
> 
> 赞同：0
> 
> 时间：2012-10-25T15:17:00.490
> 
> 标签：c#, asp.net, linq

我正在做一个搜索索引。我让它工作得很好，但我无法在我的搜索中合并 ItemID（项目编号），因为我无法将 TextBox.Text 中的 String 转换为 int 以使其成为可比较的类型。

```
var q = (from t0 in db.Item
         join t1 in db.Categories on t0.CategoryID equals t1.CategoryID
         join t2 in db.Divisions on t0.DivisionID equals t2.DivisionID
         where t0.DivisionID == DDLInt &&
         //Contains
         (t0.ItemName.Contains(txtSearch.Text.Trim()) ||
         t0.Email.Contains(txtSearch.Text.Trim()) ||
         t0.Description.Contains(txtSearch.Text.Trim()) ||
         t0.Phone.Contains(txtSearch.Text.Trim()) ||
         t0.ItemID.Equals(txtSearch.Text.Trim())) 
               // ^ This is the line where  
               //   it breaks because it is not a comparable type
         group t0 by new
         { 
```

我不确定如何转换或解析它并且仍然可以正常搜索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:18:28.350

将 解析`string`为`int`：

```
t0.ItemID.Equals(Convert.ToInt32(txtSearch.Text.Trim()))) 
```

或将其转换`int`为`string`：

```
t0.ItemID.ToString().Equals(txtSearch.Text.Trim())) 
```

或从查询中取出转换：

```
int searchID;
if !int.TryParse(txtSearch.Text.Trim(),out searchID)
    searchID = -1;  // set to an invalid ID

var q = (from t0 in db.Item
     <snip>
     t0.ItemID.Equals(searchID)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:18:28.503

应该只是：

```
t0.ItemID.Equals(int.Parse(txtSearch.Text.Trim())) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T15:18:38.873

```
t0.ItemID.Equals(Int32.Parse(txtSearch.Text.Trim()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T15:18:48.270

如果您确定它将是一个有效的整数，您可以使用`int.Parse`. 如果你不确定它是否是一个有效的整数，你可以使用它，如果它无效`int.TryParse`，可能会提示用户重新输入。

通常最好在构建查询之前验证所有项目（检查数字是数字，日期是日期，选择值是有效选择等）。如果某些内容无效，您可以通过在开始时检查它来为自己保存一个数据库查询。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-25T15:19:21.647

您可以使用[**int.Parse**](http://msdn.microsoft.com/en-us/library/system.int32.parse.aspx)

```
t0.ItemName.Contains(txtSearch.Text.Trim()) 
```

**将会**

```
int.Parse(t0.ItemName.Contains(txtSearch.Text.Trim())) 
```

# javascript - 将枚举序列化为 const JsonNet

> ID：13071788
> 
> 赞同：2
> 
> 时间：2012-10-25T15:17:01.910
> 
> 标签：javascript, asp.net-mvc-3, serialization, enums, json.net

我正在使用 Asp MVC 3 应用程序。

我有一个枚举：

```
public enum EmployeesOptions
    {
        John = 1,
        Peter = 2,
        Andrew = 3
    } 
```

和一`MyViewModel`堂课

```
 public class MyViewModel
    {
        public MyViewModel()
        {
            Employees = new List<EmployeesOptions>()
            {
                EmployeesOptions.John,
                EmployeesOptions.Peter,
                EmployeesOptions.Andrew
            };
        }

        public IEnumerable<EmployeesOptions> Employees { get; set; }
    } 
```

我的控制器：

```
public ActionResult Index()
        {
            var vm = new MyViewModel();
            return View(vm);
        } 
```

在我的索引视图中：

```
@model MyViewModel

    <script type="text/javascript">
        var jsonString = '@Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(this.Model))';

        var data = ko.mapping.fromJSON(jsonString);
        omega.franchiseInfo = ko.mapping.fromJS(data);
     </script> 
```

我来自服务器的序列化数据如下所示：

```
 Emplyees:[1,2,3] 
```

我想变成这样：

```
Emplyees:["John","Peter","Andrew"] 
```

我错过了什么？

更新：

```
var jsonString = '@Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(this.Model, Newtonsoft.Json.Formatting.None, new Newtonsoft.Json.Converters.StringEnumConverter()))'; 
```

这做的工作！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T14:04:19.427

如果您希望此枚举类型*始终*使用其字符串值进行序列化，您可以使用`JsonConverter`属性和`StringEnumConverter`类来装饰它，如下所示：

```
using Newtonsoft.Json;
using Newtonsoft.Json.Converters;

[JsonConverter(typeof(StringEnumConverter))]
public enum EmployeesOptions
{
    John = 1,
    Peter = 2,
    Andrew = 3
} 
```

然后，您不再需要在序列化程序选项中指定任何转换器类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-12T18:29:40.283

我尝试装饰一个`List`包含`Enum`值的属性，`[JsonConverter(typeof(StringEnumConverter))]`但可以理解的是它不起作用，因为它应该`Enum`直接装饰类型。

```
// Did not work!
[JsonConverter(typeof(StringEnumConverter))]
public List<Assessment.AssessmentFunction> SelectedFunctions { get; set; } 
```

然后我按照你的建议做了，它按预期工作。

```
var selectedFunctions = @Html.Raw(JsonConvert.SerializeObject(Model.SelectedFunctions,
                                                              new StringEnumConverter())) 
```

现在，我在.cshtml 视图中的 JavaScript 代码中获取字符串，而不是`Enum`int 值。正是我在特定情况下所需要的。`Enum``Razor`

**前**

```
var selectedFunctions = @Html.Raw(Json.Encode(Model.SelectedFunctions))

// Output
var selectedFunctions = [3, 3, 2, 2, 2, 3, 2, 2] 
```

**后**

```
var selectedFunctions = @Html.Raw(JsonConvert.SerializeObject(Model.SelectedFunctions,
                                                              new StringEnumConverter()))

// Output
var selectedFunctions = ["Nurse","Nurse","Doctor","Doctor","Doctor","Nurse","Doctor","Doctor"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T04:25:39.200

您正在返回枚举，默认情况下它将显示枚举值。你可以像这样修改你的模型。

```
public class MyViewModel
{
    public MyViewModel()
    {
        Employees = new List<EmployeesOptions>()
        {
            EmployeesOptions.John.ToString(),
            EmployeesOptions.Peter.ToString(),
            EmployeesOptions.Andrew.ToString()
        };
    }

    public IEnumerable<EmployeesOptions> Employees { get; set; }
} 
```

通过使用`.ToString()`扩展方法，我们可以将枚举转换为它们所表示的字符串格式的确切内容。

# jquery - jquery显示/隐藏div不起作用

> ID：13071790
> 
> 赞同：0
> 
> 时间：2012-10-25T15:17:04.270
> 
> 标签：jquery, html, show-hide

我正在尝试使用 jquery 显示和隐藏 div 内容，尽管我倾向于快速学习，但我对 jquery 只有一点了解。我正在尝试同时使用图像和链接来打开 div，并将图像从 + 交换为 -。我将图像作为一个包含 + 和 - 符号的文件，并且我可以使用 CSS 分割图像。现在的问题是当我单击加号或链接时没有任何反应，它不显示 div。我有多个 div。这是我到目前为止所做的。

```
<div class="topic">
<a href="#" class="article_toggle" onclick="article_toggle();" style="display: block; cursor: pointer;">bla bla bla</a>
        <div class="plusminus">
        <div class="plus" onclick="art_toggle();" style="display: block; cursor: pointer;">&nbsp;</div>
        <div class="minus" onclick="art_toggle();" style="display: none; cursor: pointer;">&nbsp;</div>
        </div>
</div>
<br />
<div class="section" style="display: none;">   // this is the div i want to show and hide.
    <table class="three-column">
    </table>
</div> 
```

糟糕，我忘了在脚本中添加代码。

```
function article_toggle(show) {
var currentart = $(show + ' .article-arrow .article-plus').attr('style');
if(currentart.search('display: none;')==-1) {
    $(show + ' .article-arrow .article-minus').attr('style', 'display: none; cursor: pointer;');        
    $(show + ' .article-arrow .article-plus').attr('style', 'display: block; cursor: pointer;');        
    $(show + ' .faq-content .article-section').attr('style', 'display: none;');
    $(show).stop();
    $(show).css('backgroundColor', '#ffffff');
} else {
    $(show + ' .article-arrow .article-minus').attr('style', 'display: block; cursor: pointer;');       
    $(show + ' .article-arrow .article-plus').attr('style', 'display: none; cursor: pointer;');     
    $(show + ' .faq-content .article-section').attr('style', 'display: block;');
    $(show).css('backgroundColor', '#fff8de');
    $(show).css('backgroundColor', $(view).css('backgroundColor')).animate({
        backgroundColor: '#ffffff'
    }, 3000);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:23:59.143

试试这个，即使你没有包含你的脚本

```
$(document).ready(function(){

    $('.article_toggle').click(function(){

         $('.section').toggle();
     }
);​​​ 
```

## [JS小提琴](http://jsfiddle.net/5uU9g/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:32:59.907

这是我的建议

HTML：

```
<div class="topic">
    <a href="#" class="article_toggle" style="display: block; cursor: pointer;">bla bla bla</a>
    <div class="plusminus">
        <div class="plus article_toggle" style="display: block; cursor: pointer;">&nbsp;</div>
        <div class="minus article_toggle" style="display: none; cursor: pointer;">&nbsp;</div>
    </div>
</div>
<br />
<div class="section" id="section" style="display: none;">   // this is the div i want to show and hide.
    <table class="three-column">
    </table>
</div> 
```

Javascript：

```
$(document).ready(function(){
    $('.article_toggle').click(function(){
        $('.section').toggle();
        $('.plusminus div').toggle();
    });
}); 
```

笔记：

*   HTML 和 Javascript 已分离 - 所有点击事件已从 HTML 中删除，并在页面加载时使用 jQuery 注册
*   类 article_toggle 也被添加到“加号”和“减号”图像中，以允许 jQuery 也可以在它们上添加点击事件
*   代码显示`$('.section').toggle();`/隐藏内容
*   `$('.plusminus div').toggle();`切换加号和减号按钮的可见性

# html - 输入类型文本中的背景文本

> ID：13071791
> 
> 赞同：29
> 
> 时间：2012-10-25T15:17:05.913
> 
> 标签：html, css

我认为这是一个简单的问题，但我不知道如何在谷歌中搜索这个问题

我需要输入文本字段中的背景文本。喜欢：插入你的名字。当我按下该字段以插入我的名字时，文本消失了

好的，感谢您的解决方案。

```
<input id="textfield" name="textfield" type="text" placeholder="correct" /> 
```

现在我得到第二个问题。如何更改占位符的颜色？这是我的文本区域：http: [//jsfiddle.net/wy8cP/1/](http://jsfiddle.net/wy8cP/1/)

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-10-25T15:22:15.840

以下是使用 HTML5 获取占位符的方法：

```
<input id="textfield" name="textfield" type="text" placeholder="enter something" /> 
```

编辑：

我不再推荐将你自己的 polyfill 组合在一起，如下所示。您应该首先使用 Modernizr 检测是否需要 polyfill，然后激活适合您需要的 polyfill 库。[Modernizr wiki 中列出](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills#web-forms-input-placeholder)了很好的占位符 polyfills 的选择。

原件（续）：

这是一个用于兼容性的 polyfill：

```
<input id="textfield" name="textfield" type="text" value="enter something" onfocus="if (this.value == 'enter something') {this.value = '';}" onblur="if (this.value == '') {this.value = 'enter something';}"> 
```

[http://jsfiddle.net/q3V4E/1/](http://jsfiddle.net/q3V4E/1/)

更好的 shim 方法是在页面加载时运行此脚本，并将占位符放在 data-placeholder 属性中，因此您的标记如下所示：

```
<input id="textfield" name="textfield" type="text" data-placeholder="enter something"> 
```

你的js看起来像这样：

```
var inputs = document.getElementsByTagName("input");
for (var i = 0; i < inputs.length; i++) {
    inputs[i].value = inputs[i].getAttribute('data-placeholder');
    inputs[i].addEventListener('focus', function() {
        if (this.value == this.getAttribute('data-placeholder')) {
            this.value = '';
        }
    });
    inputs[i].addEventListener('blur', function() {
        if (this.value == '') {
            this.value = this.getAttribute('data-placeholder');
        }
    });
} 
```

[http://jsfiddle.net/q3V4E/4/](http://jsfiddle.net/q3V4E/4/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T15:19:10.350

HTML5 提供了一个`placeholder`属性来解决这个特定问题。有关更多信息，请参阅[此链接](http://davidwalsh.name/html5-placeholder)( [JSFiddle](http://jsfiddle.net/yuhes/) )

```
<input type="text" placeholder="insert your name" /> 
```

您始终可以提供非 HTML5 javascript 后备，就像[这里](http://www.morethannothing.co.uk/2010/01/placeholder-text-in-html5-a-js-fallback/)解释的那样，或者在[None jquery placeholder fallback?](https://stackoverflow.com/q/7553816/851811) 如果您不使用 JQuery。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T15:19:15.027

我认为您正在寻找 HTML5 表单字段占位符... :)

[http://webdesignerwall.com/tutorials/cross-browser-html5-placeholder-text](http://webdesignerwall.com/tutorials/cross-browser-html5-placeholder-text)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-14T15:16:44.813

非 html 5 接受的答案的 jquery 版本：

```
 var inputs = $("input[type='text']", context);
    $.each(inputs, function (i, obj) {
        $(obj).val($(obj).attr('data-placeholder'));
        $(obj).on('focus', function () {
            if ($(this).val() == $(this).attr('data-placeholder')) {
                $(this).val('');
            }
        });
        $(obj).on('blur', function () {
            if ($(this).val() == '') {
                $(this).val($(this).attr('data-placeholder'));
            }
        });
    }); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-21T18:51:53.777

改变占位符的颜色可以通过 CSS 实现：

```
::-webkit-input-placeholder { /* Chrome/Opera/Safari */
  color: pink;
}
::-moz-placeholder { /* Firefox 19+ */
  color: pink;
}
:-ms-input-placeholder { /* IE 10+ */
  color: pink;
}
:-moz-placeholder { /* Firefox 18- */
  color: pink;
} 
```

来源：[https ://css-tricks.com/almanac/selectors/p/placeholder/](https://css-tricks.com/almanac/selectors/p/placeholder/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-25T15:27:46.007

对于非 HTML5，我建议使用不错的 javascript 解决方案，例如 toggleval.js - 这使您不必自己做每个输入字段内联；这将是全球性的。

[http://snipplr.com/view/9077/](http://snipplr.com/view/9077/)

之后您将调用的脚本将是这样的：

```
 <script type="text/javascript">
    $(document).ready(function() {
        // Input Box ToggleVal
        $("input[type=text]").toggleVal();
        $("input[type=password]").toggleVal();
    });
    </script> 
```

# php - 带有获取请求的 file_get_contents 中的错误处理和内容类型

> ID：13071792
> 
> 赞同：0
> 
> 时间：2012-10-25T15:17:09.437
> 
> 标签：php

我在这里有一个 PHP 函数：

```
function TryGetJSON($URL) { //Attempts to retrieve the JSON at a URL, script terminates if failure
    function LogAndDie($msg) { error_log($msg); die(); }
    for($attempt = 0; $attempt < 3; $attempt++) { //Try 3 times to fetch URL
        $JSON = file_get_contents($URL); //Attempt to fetch, then check Response Header
        if( !$JSON && isset($http_response_header) && strstr($http_response_header[0], '503'))
            continue; //503 response: server was busy, so try again
        else
            break; //$JSON is populated, must be a 200 response
    }//$JSON is always false on 404, file_get_contents always returns false on read failure

    if(isset($http_response_header)) {
        if(strstr($http_response_header[0], '503')) //If still 503, then all our attempts failed
            LogAndDie('Could not get JSON file (' . $URL . '): ' . $http_response_header[0] . ' after 3 attempts.');
        if(!strstr($http_response_header[0], '200')) //If not a 200
            LogAndDie('Could not get JSON file (' . $URL . '): ' . $http_response_header[0]);
        if(!strstr($http_response_header[7], 'application/json') ) //Check Correct Content-Type
            LogAndDie('Wrong Content Type for (' . $URL . '). Received: ' . $http_response_header[7]);
        return $JSON;
    }
    if(!$JSON) LogAndDie('Could not get JSON file (' . $URL . ').'); //Catch all
} 
```

该函数的要点是，如果它无法从指定的 URL 检索 JSON，它会`die()`写入并写入。在's`error_log`的情况下它会重新尝试 3 次。`503`

我对此有几个主要问题：

1.  `Content-Type`检查并不总是正确的，因为 GET 请求上的索引并不总是 7 。我是否想`$http_response_header`用`strstr`for遍历整个`Content-Type`内容然后检查它？对我来说似乎很笨拙。[手册页](http://php.net/manual/en/reserved.variables.httpresponseheader.php)对此几乎没有任何内容。必须有一种更简单的方法来处理它？

2.  我`error_log`在 a 上有这样的行`404`：

* * *

```
[25-Oct-2012 09:02:23] PHP Warning:  file_get_contents(...) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: HTTP request failed! HTTP/1.1 404 Not Found in ... on line 8
[25-Oct-2012 09:02:23] Could not get JSON file (...): HTTP/1.1 404 Not Found 
```

* * *

我只对保留我的（第二行）感兴趣，而不是`error_log`两者都填满。我发现`@`可以用来抑制它`file_get_contents`，但这可能会抑制我可能需要知道的其他我无法预测的警告。有没有办法在这个函数中抑制特定的警告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:52:46.427

根据[this](https://stackoverflow.com/questions/5519802/get-content-type-header-of-request-in-php) question，您可以`content-type`从超全局获取标题`$_SERVER["CONTENT_TYPE"]`（我没有检查，所以我不能确定）。编辑：现在已经检查过了，它似乎只适用于 POST 请求。

对于这个`file_get_contents`问题，如果你不想要它，你也可以抑制警告，你可以明确地测试它是否返回错误。

只是一个注释；在函数中定义函数不是一个好主意 - 如果`TryGetJSON`在同一个脚本中调用该函数两次，则会出现错误，因为您无法定义与已定义函数同名的函数。

# php - PHP csv 解析库

> ID：13071794
> 
> 赞同：0
> 
> 时间：2012-10-25T15:17:15.010
> 
> 标签：php, parsing, file-io, csv

> **可能重复：**
> [如何从 php 中的 csv 文件中提取数据](https://stackoverflow.com/questions/2805427/how-to-extract-data-from-csv-file-in-php)

有谁知道一个 PHP csv 解析库/类，它可以与各种程序生成的 csv 一起使用，并且理想情况下会自动找到分隔符？到目前为止，我尝试的一切都因一个文件或另一个文件而失败。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:18:26.530

有原生函数，比如[`str_getcsv()`](http://www.php.net/manual/en/function.str-getcsv.php)

记住要[成为更好的 PHP 开发人员](http://jason.pureconcepts.net/2012/08/better-php-developer/)和 RTM。

# spring - 如何在不使用 messages.properties 的情况下获取 Spring mvc 验证消息？

> ID：13071801
> 
> 赞同：0
> 
> 时间：2012-10-25T15:17:32.040
> 
> 标签：spring, spring-mvc, validation

我有一个带有控制器、模型、服务和验证类的 Spring mvc 应用程序。一切正常。在开发我目前拥有的东西时，我将验证消息存储在一个 messages.properties 文件中——我在这样的配置类中注册了该文件：

```
@Bean
public MessageSource messageSource() {

    final ResourceBundleMessageSource messageSource = new ResourceBundleMessageSource();
    messageSource.setBasename("[package name]/messages/messages");

    return messageSource;
} 
```

在验证器中，如果用户没有回答这样的字段，我会添加一条验证消息：

```
ValidationUtils.rejectIfEmptyOrWhitespace(errors, "age", "required", new Object[] {"Age"}); 
```

在 messages.properties 文件中我有这个（'age' 上面是模型对象的名称，'required' 是用于在 messages.properties 文件中检索消息的键）：

```
required = {0} is required. 
```

好的，再次 - 这一切都很好。但我想做的是将消息外部化到数据库（基本上，这些是所有应用程序都使用的公司消息）。

我的问题是 - 如何让 Spring 使用数据库而不是 messages.properties？还是我确实使用messages.properties，只存储消息的id（数据库键）而不是消息本身？

我对该怎么做有几个想法 - 但不知道如何做任何一个。我“认为”Spring-form 标记库最终会执行获取实际消息的工作。也许我可以以某种方式拦截那个电话？或者也许以某种方式将 messageSource 更改为其他内容，而不是定义 messages.properties 文件。

无论如何，有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-04-11T10:25:44.023

你可以试试`Errors.rejectValue(String field, String errorCode, String defaultMessage)`方法。我也有同样的问题。在我的情况下，我使用`...errors.rejectValue("firstName", "error.firstName", "plz enter ur first name!!.");`

理想情况下，这应该`defaultMessage`在无法从消息源中找到错误代码的情况下使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T23:39:57.530

而不是使用 ResourceBundleMessageSource 使用自定义 MessageSource 实现，该实现返回到数据库中。不幸的是 Spring 本身没有这样的实现，如 jira 问题中所述： [https ://jira.springsource.org/browse/SPR-364](https://jira.springsource.org/browse/SPR-364)

但是实现 MessageSource 接口很简单，您甚至可以看到 jira 问题附带的示例实现：[https ://jira.springsource.org/secure/attachment/10261/JdbcMessageSource.java](https://jira.springsource.org/secure/attachment/10261/JdbcMessageSource.java)

# java - 我需要什么库才能将“文件”类型与硒一起使用？

> ID：13071802
> 
> 赞同：-1
> 
> 时间：2012-10-25T15:17:36.470
> 
> 标签：java, file, selenium

我想使用 Selenium 来控制 Firefox，但我想控制 Firefox 的自定义配置文件。

我找到了这个：

```
 File profileDirectory = new File(profileDirectory);
    FirefoxProfile profile = new FirefoxProfile(profileDirectory);
    WebDriver webDriver = new FirefoxDriver(profile); 
```

但是`File`找不到该符号，我不知道哪个库包含它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:26:17.620

授人以鱼，授人以渔……

如果你在谷歌上搜索“java File”，它会带你到这个链接：

[http://docs.oracle.com/javase/6/docs/api/java/io/File.html](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)

该页面的最顶部显示了一个微型树，它告诉您在 Java 版本 1.4.2 中，符号：“文件”是一个对象，它扩展了`java.io.File`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:20:26.273

[`java.io.File`是标准 Java 库的一部分。](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)

以下应该允许您的代码编译：

```
import java.io.File; 
```

# ruby-on-rails-3 - simple_form - 如何创建带有嵌套输入文本框的单选按钮

> ID：13071804
> 
> 赞同：4
> 
> 时间：2012-10-25T15:17:50.393
> 
> 标签：ruby-on-rails-3, simple-form

我正在使用 simple_form 呈现我的表单并尝试获得以下行为：我希望客户端从 3 个选项中进行选择。在每个选项中，他都会提供一两个额外的字段。
所以我想要这样的东西：

```
Please set your preferences:  
 o Pay me on a specific day - [input field to get the day]  
 o Pay me a specific amount of money - [input field for the amount]  
 o Pay me on a regular basis - [radio buttons to choose between weekly/monthly basis] 
```

我可以按如下方式创建单选按钮，但不能在它们下添加嵌套字段：

```
<%= simple_form_for @client, action: 'edit_payment_method' do |f| %>
    <%= f.input :payment_type, label: 'Please set your preferences:',
        collection: [ ['Pay me on a specific day', :specific_day],
        ['Pay me a specific amount of money', :specific_money],
        ['Pay me on a regular basis', :regular_basis]
     ], as: :radio_buttons %>

  <%= f.button :submit, 'Submit' %>
<% end %> 
```

创建嵌套文本框的最佳方法是什么？
至于字段，我不需要将它们发送到不同的控制器（每个 payment_type），如果我将它们全部发送到一种方法并根据他选择的付款类型读取相关值就可以了。

谢谢！扎克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T13:13:24.020

simple_form [collection_radio_buttons](https://github.com/plataformatec/simple_form/blob/master/lib/simple_form/action_view_extensions/builder.rb#L91)可能是您想要的。它的 options 参数接受一个块，该块允许您自定义每个单选按钮呈现的内容。[在此处查看](https://github.com/plataformatec/simple_form/blob/master/lib/simple_form/action_view_extensions/builder.rb#L64)rdocs 中的示例。

**编辑：**

这基本上是您需要以相对通用的方式做的事情（尚未经过测试，但我正在运行类似的东西）。将您的附加控件放在每个单选按钮的部分中：

```
<% radio_buttons = [
       { :text => 'Pay me on a specific day', :value => :specific_day, :partial => "<textbox_partial_name>", :locals => { :any_locals => :your_partial_needs} },
       { :text => 'Pay me a specific amount of money', :value => :specific_money, :partial => "<textbox_partial_name>", :locals => { :any_locals => :your_partial_needs} },
       { :text => 'Pay me on a regular basis', :value => :regular_basis, :partial => "<radio_partial_name>", :locals => { :any_locals => :your_partial_needs} }, 
  ] %>

<%= simple_form_for @client, action: 'edit_payment_method' do |f| %>
  <%= f.label t("account.update_payment_method.title") %>
  <%= f.collection_radio_buttons :payment_type, (collection.collect do |r| [r[:text], r[:value], r[:partial].nil? ? "" : r[:partial], r[:locals].nil? ? {} : r[:locals]] end), :second, :first do |builder| %>
    <%= builder.label{builder.radio_button(:class => 'payment_method_options') + builder.text} %>
    <% unless builder.object[2].blank? %>
      <%= render :partial => builder.object[2], :locals => builder.object[3] %>
    <% end %>
  <% end %>
  <%= f.button :submit, 'Submit' %>
<% end %> 
```

您可以省略`:partial`任何不需要额外控件的单选按钮，以及`:locals`如果您的部分不需要它。还有一些方法可以根据您的情况简化此代码，但此示例说明了如何在需要时向每个单选按钮添加更复杂的控制结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T09:34:18.923

好的..我设法以某种方式解决了这个问题，不确定它是否是最好的选择，但我正在发布它，所以如果将来有人需要它，他至少有一些东西可以开始。

我使用 simpleform 创建了一个“常规”表单，然后使用 JQuery 将内部输入字段（定期创建）移动到单选按钮旁边。

**将 JQuery 支持添加到您的 rails 应用程序：**

*   添加`gem "jquery-rails"`到您的 Gemfile
*   `bundle install`
*   `rails generate jquery:install`

**我使用的形式（常规简单形式）：**

请注意附加到单选按钮的类和附加到输入字段的 ID。稍后我将使用它来移动元素。

```
<%= simple_form_for @client, url: 'update_payment_data' do |f| %>
    <%= f.input :payment_type, label: t('account.update_payment_method.title'),
          input_html: { class: 'payment_method_options' },
          collection: [ [t('account.update_payment_method.sum_based.title'), :amount],
                        [t('account.update_payment_method.days_in_month_based.title'), :days_in_month],
                        [t('account.update_payment_method.optout.title'), :optput]
          ], as: :radio_buttons %>
    <%= f.input :payment_amount, label: "Payment amount threshold", 
          input_html: { id: 'payment_amount_box' } %>
    <%= f.input :payment_days_in_month, label: "Payment days in month", 
          input_html: { id: 'payment_days_in_month_box' } %>
    <%= f.button :submit, t('account.update_payment_method.update') %>
<% end %> 
```

**在同一页面中 - JQuery 代码：**

```
<script>
    $(document).ready(function() {
        var amount_box = $("#payment_amount_box");
        var amount_box_parent = amount_box.parent();
        amount_box.detach().appendTo($(".payment_method_options:eq(0)").parent());
        amount_box_parent.remove();

        var dim_box = $("#payment_days_in_month_box");
        var dim_box_parent = dim_box.parent();
        dim_box.detach().appendTo($(".payment_method_options:eq(2)").parent());
        dim_box_parent.remove();

    });
</script> 
```

我认为这是不言自明的，它只是查找内部输入字段（按 id）并将它们移动到为每个单选按钮创建的下面`span`的适当位置。 我不得不对 css 进行一些操作以使其看起来像我想要的那样（例如），但这或多或少是这样。`simpleform`
`display:block`

希望它有帮助.. 扎克

# c# - 使用命名参数动态调用方法

> ID：13071805
> 
> 赞同：4
> 
> 时间：2012-10-25T15:17:55.557
> 
> 标签：c#, .net, reflection, named-parameters, roslyn

我们目前正在使用 .NET 3.5，我们的部分应用程序使用动态调用（使用[MethodBase.Invoke](http://msdn.microsoft.com/en-us/library/system.reflection.methodbase.invoke.aspx)）

我想知道是否可以将命名参数（在.NET 4中）与动态调用混合，以执行类似于：

```
// Dictionary that holds parameter name --> object mapping
var parameters = new Dictionary<string, object>();

// Add parameters ....

// Invoke where each parameter will match the one from the method signature.
methodInfo.Invoke(obj, parameters); 
```

是否有任何 API 允许此选项开箱即用？如果没有，是否有可能开发一些解决方案来执行此操作？

编辑：

重新考虑这个问题，这听起来类似于编译器实际上可能需要根据参数列表匹配方法调用。也许有一些编译器 API（或新的 Roslyn 项目）可以轻松做到这一点？（没有自己编码，可能容易出错）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-25T16:02:03.337

你可以使用这样的代码：

```
public static class ReflectionExtensions {

    public static object InvokeWithNamedParameters(this MethodBase self, object obj, IDictionary<string, object> namedParameters) { 
        return self.Invoke(obj, MapParameters(self, namedParameters));
    }

    public static object[] MapParameters(MethodBase method, IDictionary<string, object> namedParameters)
    {
        string[] paramNames = method.GetParameters().Select(p => p.Name).ToArray();
        object[] parameters = new object[paramNames.Length];
        for (int i = 0; i < parameters.Length; ++i) 
        {
            parameters[i] = Type.Missing;
        }
        foreach (var item in namedParameters)
        {
            var paramName = item.Key;
            var paramIndex = Array.IndexOf(paramNames, paramName);
            if (paramIndex >= 0)
            {
                parameters[paramIndex] = item.Value;
            }
        }
        return parameters;
    }
} 
```

然后这样称呼它：

```
var parameters = new Dictionary<string, object>();
// Add parameters ...
methodInfo.InvokeWithNamedParameters(obj, parameters); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:31:23.293

您可以在本文的帮助下获取参数名称[如何获取方法参数的名称？](https://stackoverflow.com/questions/214086/how-can-you-get-the-names-of-method-parameters-in-c)然后您可以重新排序它们以调用它们，如此处所述[反射：如何使用参数调用方法](https://stackoverflow.com/questions/2202381/reflection-how-to-invoke-method-with-parameters)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T20:06:31.353

使用 .net4，我有一个开源框架 ImpromptuInterface（在 nuget 中找到），可以轻松使用 DLR api 进行[后期调用，包括命名/可选参数](http://code.google.com/p/impromptu-interface/wiki/UsageReallyLateBinding#Named/Optional_Arguments)。

```
var result = Impromptu.InvokeMember(target, "MyMethod", parameters.Select(pair=>  InvokeArg.Create(pair.Key, pair.Value)).Cast<object>().ToArray()); 
```

# php - php脚本可以停止吗？

> ID：13071812
> 
> 赞同：0
> 
> 时间：2012-10-25T15:18:11.717
> 
> 标签：php, paypal, paypal-ipn

我正在尝试制作一个贝宝 IPN 系统，这是一个贝宝自动检查汇款的系统。他们提供了一个基本的系统脚本来做到这一点。

该系统很简单，您在脚本上获得 $_POST[]，然后打开一个套接字与贝宝，它们会响应您在套接字中的有效或无效单词。

我的问题是打开套接字，我有 50% 的时间会丢失连接。当脚本连接时，我没有任何问题。所以我将其更改为 20 次尝试，而不是 1 次：

```
<?

//...

mail("mi@mail.com", "subject", "executing", "some headers"); //mailme when this is execute

$try = 20;
do{
  $fp = @fsockopen ('ssl://www.paypal.com', 443, $errno, $errstr, 15);
  $try--;
}while($try>0 && !$fp);

if (!$fp) { // HTTP ERROR

mail("mi@mail.com", "subject", "error_message_not_connecting", "some headers");

} else {

mail("mi@mail.com", "subject", "connected_reading_socket", "some headers");

//fputs(..); and the loop reading working.

}

?> 
```

在我的测试中，它现在可以 100% 的多次尝试。但在实际传输中，它不会在 20-30% 的时间内起作用。我收到了第一封邮件，但第二封邮件从未失败。

我在想.. 如果贝宝只打开到我的服务器的连接 1 秒，php 脚本可以在尝试后停止并停止继续吗？或者知道这里有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:23:22.297

发送邮件也可能失败，尤其是当您遇到网络问题时。您应该记录 mail() 和 fsockopen 的失败条件，以便之后重新访问它们。

此外，您的 fsockopen 可能会卡住。您有 15 秒的超时时间，并且您尝试了 20 次，因此您的脚本将工作 20*15=300 秒 = 5 分钟，这可能比您的 PHP 脚本超时时间长 - > PHP 会在中途中止您的脚本，对吧？默认情况下，PHP 的最大执行时间仅为 30 秒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:24:16.570

PHP 脚本可以用`exit;`. 您可以使用 暂停 php 脚本处理`sleep(nr_sec)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-11T17:13:40.957

我发现了错误。当用户关闭与服务器的连接时（通常通过单击浏览器上的停止按钮，或者在这种情况下是由贝宝关闭的套接字），可以停止 php。

有 3 种方法可以停止脚本。

1-通过完成脚本 2-通过用户关闭与服务器的连接 3-通过超时

我使用了函数ignore_user_abort(true)，我没有更多问题。

[http://php.net/manual/en/function.ignore-user-abort.php](http://php.net/manual/en/function.ignore-user-abort.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:42:02.353

我曾经遇到过类似的问题。使用套接字时的奇怪行为。最好改用 CURL，它更稳定。

[http://leepeng.blogspot.com/2006/04/standard-paypal-php-integration.html](http://leepeng.blogspot.com/2006/04/standard-paypal-php-integration.html)

# capybara - RSpec-rails-capybara - 不同的失败：js => true 和没有

> ID：13071813
> 
> 赞同：9
> 
> 时间：2012-10-25T15:18:15.780
> 
> 标签：capybara, factory-bot, rspec-rails

我正在为个人计费构建一个设置屏幕。控制器/视图位于 Admin 命名空间中。

当在没有 :js => true 的情况下运行第一个测试时，我遇到了一个失败，我认为这是因为链接不能作为它的帮助器工作，它使用 js 脚本来构建一组嵌套的字段（基于 Railscasts单个表单，多个表 - 嵌套属性）。

```
Failures:

  1) Patient Setup create patient bill heading - with extended details -with valid data
     Failure/Error: fill_in "Extended Bill Heading", :with => 'Regular Registration'
     Capybara::ElementNotFound:
       cannot fill in, no text field, text area or password field with id, name, or label 'Extended Bill Heading' found
     # (eval):2:in `fill_in'
     # ./spec/requests/admin/patient_setup_pages_spec.rb:52:in `block (4 levels) in <top (required)>'

Finished in 0.83047 seconds
3 examples, 1 failure, 2 pending 
```

但是当我使用 :js = true 时，我遇到了一个失败，这似乎来自登录，运行时无效的用户/密码在屏幕上闪烁。

![在此处输入图像描述](../Images/1c685f0aa462d4cce03c6ed4c21e603b.png)

```
Failures:

  1) Patient Setup create patient bill heading - with extended details -with valid data
     Failure/Error: click_link 'System'
     Capybara::ElementNotFound:
       no link with title, id or text 'System' found
     # (eval):2:in `click_link'
     # ./spec/requests/admin/patient_setup_pages_spec.rb:22:in `block (2 levels) in <top (required)>'

Finished in 6.33 seconds
3 examples, 1 failure, 2 pending 
```

这是支持这一切的代码。

```
spec/requests/admin/patient_setup_spec.rb

require 'spec_helper'

feature 'Patient Setup' do

  let!(:ci_user) { FactoryGirl.create(:user, 
                                       name: "configuration engineer", 
                                       password: "password",
                                       password_confirmation: "password"
                                     ) }
  let!(:admin_role) { FactoryGirl.create(:admin_role) }
  let!(:assignment) { FactoryGirl.create(:assignment, 
                                         :role => admin_role, 
                                         :user => ci_user 
                                         ) } 

  before do 
    visit login_path
    fill_in "Name", with: "configuration engineer"
    fill_in "Password", with: "password"
    click_button "Login"
    save_and_open_page
    click_link 'System'
    click_link 'Patient Setup'
  end

  describe "create patient bill heading" do
    before do
      click_link 'New Bill Heading'
      fill_in 'Bill heading', :with => 'Consultation' 
      fill_in 'Abbreviation', :with => "CON"       
    end

    context "- no extended details" do
      pending

      scenario "- with valid data" do
        pending
        click_button 'Create Patient bill heading' 
        page.should have_content('Patient Bill Heading created.')
      end
    end

    context "- with extended details", :js => true do #(without :js => true 1st error)
      before do
        # save_and_open_page
        click_link "Extended Bill Heading"
        # save_and_open_page        
      end

      scenario "-with valid data" do
        save_and_open_page
        fill_in "Extended Bill Heading", :with => 'Regular Registration'
      end
    end

  end
end 
```

这是我的出厂设置。

```
spec/factories.rb

FactoryGirl.define do

  # Users, Roles
  factory :user do
    name     "Joesephine Bloggs"
    password "testmenow"
    password_confirmation "testmenow"
  end

  factory :admin, :class => User do
    sequence(:name) { |n| "Administrator-#{n}" }
    password "adminiam"
    password_confirmation "adminiam"
    after(:create) do |user|
      FactoryGirl.create(:assignment, :role => FactoryGirl.create(:admin_role), :user => user )
    end
  end

  factory :role do
    description { "Clerical-#{rand(99)}" }

    factory :admin_role do
      description "Admin"
    end
  end

  factory :assignment do
    user
    role
  end

  # Patients Module

  factory :patient_bill_heading do

      sequence(:bill_heading) { |n| "bill-heading-#{n}" }
      sequence(:abbreviation) { |n| "abbreviation-#{n}" }

      factory :delete_patient_bill_heading, :class => PatientBillHeading do
        bill_heading :bill_heading
        abbreviation :abbreviation
      end

  end  
end 
```

这是我认为调用生成嵌套属性字段的帮助程序的链接。

```
<p>
  <%= link_to_add_fields "Extended Bill Heading", f, :patient_extended_bill_headings %>
</p> 
```

这里是帮手。

```
helpers/application_helper.rb

  def link_to_add_fields(name, f, association, options={})
    defaults = {
      :partial_name => nil
    }
    options = defaults.merge(options)

    new_object = f.object.send(association).klass.new
    id = new_object.object_id
    fields = f.fields_for(association, new_object, child_index: id) do |builder|
      if options[:partial_name].nil?
        render(association.to_s.singularize + "_fields", f: builder)
      else
        render(options[:partial_name], f: builder)
      end
    end
    link_to("#{name} <i class='icon-plus icon-white'></i>".html_safe, 
            '#', 
            class: "btn btn-success add_fields",
            data: {id: id, fields: fields.gsub("\n", "")}
           )
  end 
```

我正在努力提高我的 RSpec 测试知识，因为我在一个小时试图弄清楚为什么我的测试失败后已经成功地在我的应用程序中构建了这个工作。所以在应用程序中它可以工作，但我想了解如何让我的测试通过。

我是否断言一个错误是由于使用 js 创建链接，而 capybara 没有运行它，因为我不使用 :js => true 选项？

使用 :js => true 选项时，谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-05T15:15:50.970

您可能`config.use_transactional_fixtures = true`在您的 spec_helper.rb 中有。它不适用于 Capybara javascript 规范，因为服务器和浏览器客户端在不同的线程上运行。由于服务器上的数据库事务对客户端不可见，客户端不知道您在 let!() 中创建的用户，因此用户无法登录系统。

您需要在每次运行之前/之后为您的 js 规范关闭事务装置并清理数据库（考虑 gem [database_cleaner ）。](https://github.com/bmabey/database_cleaner)

```
RSpec.configure do |config|
  config.use_transactional_fixtures = false

  config.before(:suite) do
    DatabaseCleaner.clean_with :truncation
  end

  config.before(:each) do
    if example.metadata[:js]
      DatabaseCleaner.strategy = :truncation
    else
      DatabaseCleaner.strategy = :transaction
    end
    DatabaseCleaner.start
  end

  config.after(:each) do
    DatabaseCleaner.clean
  end
end 
```

上面的代码片段取自[联系人管理器应用程序自述](https://github.com/lailsonbm/contact_manager_app)文件并稍作修改

# c# - 在后面的代码中将表达式从文本框转换为数学表达式

> ID：13071823
> 
> 赞同：2
> 
> 时间：2012-10-25T15:18:40.267
> 
> 标签：c#, math, equation, equations

> **可能重复：**
> [我需要一个快速的运行时表达式解析器](https://stackoverflow.com/questions/4392022/i-need-a-fast-runtime-expression-parser)

当有人在我页面上的文本框中输入**x*y^z**以计算后面代码中的方程式并获得结果时，我该如何做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:26:42.607

使用**内置的 .NET 功能**，用户[https://stackoverflow.com/users/1670022/matt-crouch将](https://stackoverflow.com/users/1670022/matt-crouch)[操作员作为字符串](https://stackoverflow.com/questions/174664/operators-as-strings)回答：

 **“如果你只需要简单的算术，那就这样做吧。

```
 DataTable temp = new DataTable();
    Console.WriteLine(temp.Compute("15 / 3",string.Empty)); 
```

编辑：更多信息。查看 System.Data.DataColumn 类的 Expression 属性的 MSDN 文档。“表达式语法”上的内容概述了除算术运算符之外您可以使用的命令列表。（例如 IIF、LEN 等）。”

编辑2：为方便起见，您可以将其放入一个小函数中，例如：

```
public string Eval(string expr)
{
    var temp = new System.Data.DataTable();
    string result = null;
    try
    {           
        result = $"{temp.Compute(expr, string.Empty)}"; 
    }
    catch (System.Data.EvaluateException ex)
    {
      if (ex.Message.ToLower().Contains("cannot find column"))
            throw new System.Data.SyntaxErrorException($"Syntax error: Invalid expression: '{expr}'."
                                           + " Variables as operands are not supported.");
      else
            throw;
    }

    return result;
} 
```

所以你可以像这样使用它：

```
Console.WriteLine(Eval("15 * (3 + 5) / (7 - 2)")); 
```

给出预期的输出：

> 24

**请注意**，错误处理程序有助于处理由于使用此处不允许的变量而导致的异常。示例：`Eval("a")`- 而不是返回`"Cannot find column [a]"`，这在这个上下文中没有多大意义（我们没有在数据库上下文中使用它）它正在返回`"Syntax error: Invalid expression: 'a'. Variables as operands are not supported."`

[在DotNetFiddle](https://dotnetfiddle.net/Rf5spM)上运行它

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-25T15:28:26.980

.NET 没有用于评估任意字符串的内置函数。[但是，一个名为NCalc](http://ncalc.codeplex.com/)的开源 .NET 库可以。

> NCalc 是 .NET 中的数学表达式求值器。NCalc 可以解析任何表达式并评估结果，包括静态或动态参数和自定义函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T17:21:00.213

这个问题有两种主要方法，每种方法都有一些变化，如各种答案所示。

*   选项 A：查找现有的数学表达式评估器
*   选项 B：编写自己的解析器和计算结果的逻辑

在详细介绍这一点之前，有必要强调解释任意数学表达式并**非易事**，对于“玩具”语法以外的任何表达式语法，例如只接受一两个算术运算并且不允许括号等等

理解这样的任务是微不足道的，并承认，毕竟，解释平均复杂度的算术表达式是各种应用程序的相对经常性需求[因此应该有成熟的解决方案]，尝试和凑合可能是明智的与“选项 A”。
**因此，我赞同 Jed 对现成表达式评估器（例如*NCalc*** ）的建议。

**然而，花时间去理解与解析和解释算术表达式相关的各种概念和方法**可能会很有用，就好像一个人要开始自己的实现一样。

关键概念是[***形式语法***](http://en.wikipedia.org/wiki/Formal_grammar)的概念。评估者将接受的算术表达式必须遵循一组规则，例如允许的算术运算列表。例如，评估器是否支持三角函数，或者如果支持，这是否也包括*atan2()*。规则还指出了操作数的构成，例如是否允许输入大到 45 位的数值。等等。关键是所有这些规则都以语法形式化了。

通常，语法适用于先前从原始输入文本中提取的***标记。***本质上在过程中的某个时间，一些逻辑需要*逐个字符*地分析输入字符串，并确定哪些字符序列一起出现。例如，在`123 + 45 / 9.3`表达式中，标记是整数值`123`、`plus`运算符、整数值`45`、`division`运算符，最后是`9.3`实际值。识别标记并将它们与标记类型相关联的任务是[***词法分析器的工作***](http://en.wikipedia.org/wiki/Lexical_analysis). 词法分析器可以建立在语法（“标记”是单个字符的语法，与算术表达式解析器的语法相反，它的标记是词法分析器生成的短字符串。）

顺便说一句，语法用于定义算术表达式之外的许多其他事物。计算机语言遵循 [相当复杂的] 语法，但引入***领域特定语言***（也称为 DSL）以支持计算机应用程序的各种功能是相对常见的。

对于非常简单的语法，也许可以从头开始编写相应的词法分析器和解析器。但迟早，语法可能会变得复杂到手写这些模块变得挑剔、容易出错并且可能更重要的是难以阅读。因此，[***Lexer 和 Parser Generators***](http://en.wikipedia.org/wiki/Parser_generator)的存在是独立的程序，它们从规则列表（以特定于生成器的语法表示，尽管许多生成器倾向于使用类似的语法，但松散地基于[BNF](http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form)）。

当使用这样的词法分析器/解析器生成器时，工作分多个步骤完成：
- 第一个编写语法定义（在生成器特定的语言/语法中）
- 通过生成器运行此语法。
- 经常多次重复上述两个步骤，因为编写语法是一项严格的练习：生成器会抱怨许多可能的歧义，人们可能会在语法中写入。
- 最终生成器生成一个源文件（使用所需的目标语言，如 C# 等）
- 此源包含在整个项目中
- 项目中的其他源文件可能会调用由生成器生成的源文件中公开的函数和/或与在解析期间识别的各种模式相对应的一些逻辑可以很容易地嵌入到生成器生成的代码中。
- 然后可以像往常一样构建项目，即好像解析器和词法分析器是手写的。

这就是关于使用正式语法和代码生成器**的过程的 20,000 英尺高的演示。**
可以在此[链接](http://en.wikipedia.org/wiki/Parser_generator#Several_compiler-compilers)中找到解析器生成器（又名编译器编译器）的列表。对于 C# 中的简单工作，我还想提一下[Irony](http://irony.codeplex.com/)。细读这些网站可能会非常有见地，以更好地了解这些概念，即使此时没有成为从业者的意图。
如前所述，我想强调的是，**对于这个特定的应用程序，现成的算术评估器可能是更好的方法**。这些的主要缺点是

*   关于允许的表达式语法的一些限制（允许的语法过于严格：您还需要说 stddev() 或过于宽泛：您不希望您的用户使用三角函数。对于更成熟的评估者，有将是某种形式的配置/扩展功能，可以处理这个问题。
*   这种第 3 方模块的学习曲线。希望其中许多应该是相对“即插即用”的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-27T07:54:17.530

用这个库解决了[http://www.codeproject.com/Articles/21137/Inside-the-Mathematical-Expressions-Evaluator](http://www.codeproject.com/Articles/21137/Inside-the-Mathematical-Expressions-Evaluator)

我的最终代码

```
Calculator Cal = new Calculator();
txt_LambdaNoot.Text = (Cal.Evaluate(txt_C.Text) / fo).ToString(); 
```

现在当某个类型 3*10^11 他会得到 300000000000

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T15:25:18.783

你需要的——如果你想自己做的话——是一个**[扫描器（也称为词法分析器）](http://en.wikipedia.org/wiki/Lexical_analysis) +[解析器](http://en.wikipedia.org/wiki/Parser)**在解释表达式的代码中。或者，您可以找到一个 3rd 方库，它可以完成这项工作并且与 JavaScript`eval(string)`函数的工作方式相似。

请看[这里](http://en.wikipedia.org/wiki/Recursive_descent_parser)，它描述了一个**递归下降解析器**。该示例是用**C**编写的，但是一旦您掌握了文章中描述的想法，您应该能够轻松地将其适应**C# 。**

它没有听起来那么复杂，特别是如果您要支持的操作员数量有限。

优点是您可以完全控制将执行的表达式（以防止您网站的最终用户注入恶意代码）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-25T15:25:54.947

您将需要实现（或查找第三方来源）表达式解析器。这*不是*一件小事。**

# java - 无论我做什么，Eclipse SVN 总是包含自动生成的 bin 目录和类

> ID：13071826
> 
> 赞同：1
> 
> 时间：2012-10-25T15:18:46.280
> 
> 标签：java, eclipse, svn, subversive

我正在使用带有 Subversive 插件的 Eclipse Juno。

我有一个设置为自动编译的 java 项目，它创建了很多 bin 目录

无论我在窗口-> 首选项->-> 团队-> 忽略的资源中放置什么模式，最终我都会在团队同步透视图中看到 bin 目录及其所有子目录作为新的未提交文件。

我尝试了以下语法： `*/bin`, `**/bin`, `*/bin/`,`*/bin/*`

没运气。

另外，我注意到有时如果我关闭 eclipse 并重新启动它，忽略的文件会根据需要从团队同步的角度消失，但仍然存在一些 bin 目录。这整件事非常不一致。

任何想法 ？

我忘了提到我正在使用两个工作集，一个是另一个的子集，这显然给整个过程增加了错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:34:37.597

试试“Subversive SVN JDT Ingnore Extensions”。它位于[Juno 更新站点](http://download.eclipse.org/releases/juno)的“协作”下。它的描述说：

> 该功能对 Java 开发很有用，因为它允许将输出文件夹自动解释为被忽略的资源。

似乎正是您想要的。此外，它应该独立于输出文件夹的名称工作，例如，如果您使用 Maven，这是一个优势（在这种情况下，您的输出文件夹可能会被调用`target`而不是`bin`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T16:59:50.810

我放弃并切换到`Subclipse`. 现在一切似乎都运行良好，或者至少少了错误。

# python - 中断计时器

> ID：13071831
> 
> 赞同：3
> 
> 时间：2012-10-25T15:18:56.163
> 
> 标签：python, multithreading, timer, interrupt

我现在正在为一个个人项目创建一个程序的一部分，我需要一些帮助。

以下是该程序的工作原理：

1.  用户输入运行时间
2.  用户输入文本 - 文件已修改
3.  定时器启动
4.  *可选*用户可以输入“密码”来中断定时器
5.  动作反转

除了计时器之外，我已经对所有步骤进行了编码，因为我正在尝试找出最好的方法来做到这一点。理想情况下，我希望计时器显示倒计时，如果用户输入某个“密码”，计时器就会中断并跳到第 5 步。

最好的方法是使用线程吗？过去我对线程的工作不多。我只需要以某种方式显示计时器，同时还可以将控制权交还给用户，以防他们想输入该密码。

感谢您提供的任何帮助。

这是代码：

```
import time
import urllib
import sys

def restore():
     backup = open(r'...backupfile.txt','r')
     text = open(r'...file.txt', 'w+')
     text.seek(0)

     for line in backup:
         text.write(line)

     backup.close()
     text.close()

text = open(r'...file.txt', 'a+')
backup = open(r'...backupfile.txt','w+')
text.seek(0)

for line in text:
    backup.write(line)

backup.close()

while True:
    url = raw_input('Please enter a URL: ')
    try:
        if url[:7] != 'http://':
            urllib.urlopen('http://' + url) 
        else:
            urllib.urlopen(url)
    except IOError:
        print "Not a real URL"
        continue 

    text.write(url)

    while True:
        choice = raw_input('Would you like to enter another url? (y/n): ')
        try:
            if choice == 'y' or choice == 'n':
                break
        except:
            continue

        if choice == 'y':
            text.seek(2)
            continue

        elif choice == 'n':
            while True:
                choice = raw_input('Would you to restore your file to the original backup (y/n): ')
                try:
                    if choice == 'y' or choice == 'n':
                        break
                except:
                    continue

            if choice == 'y':
                text.close()
                restore()
                sys.exit('Your file has been restored')
            else:
                text.close()
                sys.exit('Your file has been modified') 
```

如您所见，我还没有添加计时部分。这很简单，只需将 url 添加到文本文件然后关闭它们。如果用户想要原始文件，则调用 reverse()。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:25:44.793

在 Windows 下，您可以使用 msvcrt 请求密钥。询问密码实际上更复杂，因为您必须跟踪多个密钥。该程序以 F1 停止。

```
import time
import msvcrt

from threading import Thread
import threading

class worker(Thread):

    def __init__(self,maxsec):
        self._maxsec = maxsec
        Thread.__init__(self)
        self._stop = threading.Event()

    def run(self):
        i = 1
        start = time.time()
        while not self.stopped():
            t = time.time()
            dif = t-start
            time.sleep(1) # you want to take this out later (implement progressbar)

            # print something once in a while
            if i%2==0: print '.',

            #check key pressed
            if msvcrt.kbhit():
                if ord(msvcrt.getch()) == 59:
                    self.stop()

            #do stuff

            # timeout
            if dif > self._maxsec:
                break

            i+=1

    def stop(self):
        print 'thread stopped'
        self._stop.set()

    def stopped(self):
        return self._stop.isSet()

print 'number of seconds to run '
timeToRun = raw_input()

#input files
#not implemented

#run
w = worker(timeToRun)
w.run()

#reverse actions 
```

# .net - 在 Task.Run() 中包装同步调用以使其异步有益吗？

> ID：13071833
> 
> 赞同：3
> 
> 时间：2012-10-25T15:19:01.500
> 
> 标签：.net, async-await, asp.net-web-api

我提出这个问题的动机是因为我正在创建一个 .net Web API 项目，该项目将使用具有同步方法的现有 neo4j rest api 客户端。我想通过使用异步方法来利用一些性能提升，但我想避免进入 neo4j api 库并重构同步方法以返回异步方法。我想知道是否将对同步方法的调用包装在 await Task.Run() 中是否有益。具体来说，在第一个示例中，当来自 httpClient 的异步结果调用 Wait() 方法时会发生什么，但整个事情都包装在另一个 await 中。

还要记住，我将在 AppHarbor 云上运行它，我认为它是一个单一的虚拟核心。

以下也是

```
 //what happens with the synchronous rest api client I am using
  HttpResponseMessage SendHttpRequest(HttpRequestMessage request)
  {

        var requestTask = httpClient.SendAsync(request);
        requestTask.Wait();
        return requestTask.Result;

  }

  object result = await Task.Run(() =>
  {
      return SendHttpRequest(request);
  }); 
```

性能类似

```
 return httpClient.SendAsync(request) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-26T04:20:28.953

> 我想通过使用异步方法来利用一些性能提升，但我想避免进入 neo4j api 库并重构同步方法以返回异步方法。

抱歉，`async`如果您只是将同步代码包装在`Task.Run`.

`async`在服务器上很好，因为异步操作比线程更好地扩展。但是，如果您正在使用`Task.Run`，那么无论如何您都在使用线程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T16:35:05.180

不同之处在于 Task.Run 方法只是在线程池上运行相同的阻塞代码。这意味着虽然它不会阻塞您的调用线程，但它会阻塞执行线程。

这有多重要完全取决于资源和性能方面的考虑。

如果 SendHttpRequest 方法真的只是在等待 httpClient.SendAsync 任务，您可以简单地避免该方法并编写：

```
object result = await httpClient.SendAsync(request); 
```

或者：

```
object result = await Task.Run(async () => await httpClient.SendAsync(request)); 
```

如果 SendAsync 任务仍应在单独的线程上运行。

# regex - 正则表达式匹配单词或缺少单词

> ID：13071836
> 
> 赞同：1
> 
> 时间：2012-10-25T15:19:12.460
> 
> 标签：regex, cucumber

我正在尝试匹配单词`group`或匹配单词的缺失`group`

[http://rubular.com/r/TKJPFvnzZ0](http://rubular.com/r/TKJPFvnzZ0)

我可以匹配一个空间，但我希望它实际上什么都不匹配。我正在努力寻找正确的语法。

匹配组 3 应包含其中一个`group`或空字符串。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:22:48.290

不确定我是否理解正确，但这会解决您的问题：

```
^I post a "(.*?)" to the "(.*?)"(?: (group))? which the entire world can see$ 
```

?

基本上说该组是可选的。

括号内将该`?:`组标记为“非捕获组”，这意味着我们只是将表达式的那部分括在括号中以对其进行分组，但我们不想捕获要在之后使用的内容。`group`只是用括号括起来，因为我们想将该匹配捕获为一个组。

# unit-testing - MonoTouch 和 NUnitLite：什么是“主机”设置？

> ID：13071839
> 
> 赞同：3
> 
> 时间：2012-10-25T15:19:15.550
> 
> 标签：unit-testing, xamarin.ios, nunit, touch.unit

我经常使用 NUnitLite，但一直想知道选项菜单中的主机设置是什么。此处的文档中未解释这些选项：

[http://docs.xamarin.com/ios/tutorials/Unit_Testing](http://docs.xamarin.com/ios/tutorials/Unit_Testing)

如果我知道的话，有人能解释一下这个可能永远改变我生活的功能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T18:06:33.660

这是为了测试自动化（例如来自构建机器人），测试输出结果通常发送到控制台，然后发送到 TCP 套接字服务器。

subjet 上的博客条目：

*   [触控单元自动化](http://spouliot.wordpress.com/2011/10/13/touch-unit-automation/)
*   [重新审视 Touch.Unit 自动化](http://spouliot.wordpress.com/2012/04/02/touch-unit-automation-revisited/)

touch.unit github 存储库中[提供](https://github.com/spouliot/Touch.Unit/tree/master/Touch.Server)了一个简单的服务器。

# jquery - 改变颜色专注于改变模糊

> ID：13071854
> 
> 赞同：1
> 
> 时间：2012-10-25T15:20:17.387
> 
> 标签：jquery, forms

我正在尝试控制长表格的颜色。我希望输入颜色改变焦点（已经完成）和模糊只有当用户做出改变时。是否可以？

我有这个例子可以玩：http: [//jsfiddle.net/pEqvK/](http://jsfiddle.net/pEqvK/)

```
$(function(){

    $('input').css("color", "grey"); //initial value

    $("input").focus(function () {
        $(this).css("color", "black");
    });

    $("input").blur(function () {
        // if it changed $(this).css("color", "black");                   
        // if it nas NOT changed $(this).css("color", "grey");
    });

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:35:25.417

Giving what I believe you are trying to achieve, I would use some deeper semantic attributes on the tag, to specify the default value and then use that as a comparison:

HTML:

```
<form id="form1">
    <input type="text" value="name" data-default="name" />
    <input type="text" value="mail" data-default="mail" />
</form> 
```

JQUERY:

```
$(function(){

    $('input').css("color", "grey"); //initial value

    $("input").focus(function () {
        $(this).css("color", "black"); // or "red" if I understood correctly what you want to do
    });

    $("input").blur(function () {
        if ($(this).val() != $(this).data('default'))     
            $(this).css("color", "black");   
        else                
            $(this).css("color", "grey");
    });   
});​ 
```

Fiddle: [http://jsfiddle.net/pEqvK/8/](http://jsfiddle.net/pEqvK/8/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:23:51.640

有一个名为的布尔变量 `haschanged`在焦点时设置为 false，在更改时设置为 true，并在模糊时检查是否为真。

```
$(function(){
    var haschanged = false;  //stores changed state since focus

    $('input').css("color", "grey"); //initial value

    $("input").focus(function () {
        haschanged = false;
        $(this).css("color", "black");
    });

    $("input").change(function () {
        haschanged = true;
    });

    $("input").blur(function () {
        if(haschanged) $(this).css("color", "black");                   
        else           $(this).css("color", "grey");
    });

}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T15:23:41.897

为什么其他答案如此复杂？（除非我在这里遗漏了什么）尝试一行：

```
$("input").change(function() { $(this).css("color", "black"); // or set some boolean } 
```

这不是您要找的功能吗？只有在发生变化时才调用它，否则什么都不调用。因此，您首先希望将颜色默认为灰色。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-25T15:24:55.117

The following will save the previous value to your input's data then look for and compare that value upon blur. It also makes use of jQuery's chaining ability. You don't have to recall input everytime.

## [jsFiddle](http://jsfiddle.net/SpYk3/eavXX/)

```
$('input').css("color", "grey")
    .focus(function () {
        $(this).css("color", "black")
            .data("prevValue", $(this).val());
    })
    .blur(function () {
        if ($(this).val() == $(this).data("prevValue")) $(this).css("color", "grey");
    }); 
```

> **HOWEVER** If you want something more like the forms you see on other sites, you might try the following:

```
$(function(){
    $('input').css("color", "grey")
        .each(function(i) { $(this).data("baseValue", $(this).val()) })
        .focus(function(e) {
            $(this).css("color", "black");
            if ($(this).val() == $(this).data("baseValue")) $(this).val("");
        })
        .blur(function(e) {
            if ($(this).val() == "") $(this).css("color", "grey").val($(this).data("baseValue"));
        });
}) 
```

## [jsFiddle](http://jsfiddle.net/SpYk3/eavXX/4/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T15:26:31.797

Something like this?

[http://jsfiddle.net/pEqvK/5/](http://jsfiddle.net/pEqvK/5/)

JS

```
$(function(){

    $('input').css("color", "grey"); //initial value

    var t1;
    var t2;

    $("input").focus(function () {
        t1 = $('#t1').val();
        t2 = $('#t2').val();
        $(this).css("color", "black");
      }).blur(function () {
        // if it changed $(this).css("color", "black");                      
        // if it nas NOT changed $(this).css("color", "grey");
        if($(this).attr('id')=='t1'&&$('#t1').val()==t1) {
            $(this).css("color", "grey");
        }
        if($(this).attr('id')=='t2'&&$('#t2').val()==t2) {
            $(this).css("color", "grey");
        }
      });

});​ 
```

# gwt - HeaderControls 中 HeaderIcon 上的标签

> ID：13071855
> 
> 赞同：1
> 
> 时间：2012-10-25T15:20:22.943
> 
> 标签：gwt, smartgwt

我想在图标旁边放一个标签，以便用户更好地了解这个可点击图标的用途。
此图标出现在 com.smartgwt.client.widgets.Window 的 HeaderControl

```
String promptNewThing = "Add some thing";
String imgNewThingText = "../servlet/servletOperation?cmd=Icon&time=" + System.currentTimeMillis() + "&text=" + promptNewThing;
HeaderIcon iconNewThing = new HeaderIcon("buttons/new.png");
HeaderIcon iconNewThingLabel = new HeaderIcon(imgNewThingText);
newThing = new HeaderControl(iconNewThing, clickHandlerNewThing);
newThing.setPrompt(promptNewThing);
newThingLabel = new HeaderControl(iconNewThingLabel, clickHandlerNewThing);
newThingLabel.setPrompt(promptNewThing);

setHeaderControls(HeaderControls.HEADER_LABEL, NewThing, NewThingLabel, HeaderControls.MINIMIZE_BUTTON, HeaderControls.MAXIMIZE_BUTTON, HeaderControls.CLOSE_BUTTON); 
```

有关信息：在此代码中，Servlet URL 返回由文本制成的图像`promptNewThing`
但是 iconNewThingLabel 是一个具有图标宽度的图标，太小了。

这段代码的结果： ![带有文本图标的结果太小](../Images/0186e55e561a9ff6484074f282a22628.png) 我们可以在第一个 Icon 之间看到的白色小方块是`newThingLabel`.

**有没有办法在 HeaderIcon 的右侧添加标签？**

例如，我会有类似的东西：

![图标和标签](../Images/b833a1174d5cb92c7d881a9ad613a2c3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T06:48:00.517

你好 Manu 我做了和你一样的事情。唯一的变化是我没有添加`HeaderIcon`(`iconNewThingLabel`在你的情况下 - 如果它代表文本)，我使用了`com.smartgwt.client.widgets.Label`& 将其添加为`headerControl`. 代码片段如下：

```
Label label = new Label("test header");
setHeaderControls(HeaderControls.HEADER_LABEL, NewThing, label, HeaderControls.MINIMIZE_BUTTON, HeaderControls.MAXIMIZE_BUTTON, HeaderControls.CLOSE_BUTTON); 
```

让我知道这是否对您有帮助。

# javascript - 用 span 标签替换标签

> ID：13071860
> 
> 赞同：0
> 
> 时间：2012-10-25T15:20:30.600
> 
> 标签：javascript, jquery

我想在下面提到的代码中使用 javascript 或 jquery 将标签替换为 span 标签。

```
<a class="multi-choice-btn" id="abcd123">
     <img class="x-panel-inline-icon feedback-icon " src="../images/choice_correct.png" id="pqrs123">
</a> 
```

这应该改变如下。

```
<span class="multi-choice-btn" id="abcd123">
     <img class="x-panel-inline-icon feedback-icon " src="../images/choice_correct.png" id="pqrs123">
</span> 
```

替换必须在类“multi-choice-btn”的基础上进行，因为 id 是动态的。

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T15:22:39.110

```
var anchor = document.getElementById("abcd123"),
    span = document.createElement("span");

span.innerHTML = anchor.innerHTML;
span.className = anchor.className;
span.id = anchor.id;

anchor.parentNode.replaceChild(span,anchor);​ 
```

[http://jsfiddle.net/tCyVH/](http://jsfiddle.net/tCyVH/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T15:26:48.243

您可以执行以下操作：

```
$('a').contents().unwrap().wrap('<span></span>');​ 
```

**演示：http:** [//jsfiddle.net/XzYdu/](http://jsfiddle.net/XzYdu/)

如果要保留该属性，可以执行以下操作：

```
// New type of the tag
var replacementTag = 'span';

// Replace all a tags with the type of replacementTag
$('a').each(function() {
    var outer = this.outerHTML;

    // Replace opening tag
    var regex = new RegExp('<' + this.tagName, 'i');
    var newTag = outer.replace(regex, '<' + replacementTag);

    // Replace closing tag
    regex = new RegExp('</' + this.tagName, 'i');
    newTag = newTag.replace(regex, '</' + replacementTag);

    $(this).replaceWith(newTag);
}); 
```

**演示：http:** [//jsfiddle.net/XzYdu/1/](http://jsfiddle.net/XzYdu/1/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T15:29:09.580

不是最短但有效：

```
$('.multi-choice-btn').replaceWith(function() {
    return $('<span>', {
        id: this.id,
        `class`: this.className,
        html: $(this).html()
    })
});​ 
```

见[http://jsfiddle.net/dfsq/unVfp/](http://jsfiddle.net/dfsq/unVfp/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:25:36.340

请参阅此附加[的 jsFiddle](http://jsfiddle.net/TheJoeFletch/TVneM/1/)。

```
var props = $(".multi-choice-btn").prop("attributes");

var span = $("<span>");

$.each(props, function() {
    span.attr(this.name, this.value);
});

$(".multi-choice-btn").children().unwrap().wrapAll(span);​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T15:40:06.350

尝试使用 replaceWith 和一个小的 attrCopy 逻辑。见下文，

**演示：http:** [//jsfiddle.net/4HWPC/](http://jsfiddle.net/4HWPC/)

```
$('.multi-choice-btn').replaceWith(function() {

    var attrCopy = {};
    for (var i = 0, attrs = this.attributes, l = attrs.length; i < l; i++) {
        attrCopy[attrs.item(i).nodeName] = attrs.item(i).nodeValue;
    }       

    return $('<span>').attr(attrCopy).html($(this).html());

}); 
```

# windows - 查找正在使用文件的进程

> ID：13071863
> 
> 赞同：0
> 
> 时间：2012-10-25T15:20:37.287
> 
> 标签：windows, io, filesystems, process

我正在尝试从我正在开发的应用程序中访问一个文件，但我收到一条错误消息，指出该文件已被另一个程序打开。

好的，我启动了第一个句柄，然后是进程资源管理器，然后是进程监视器，它们都说了同样的话：

```
Handle v3.45
Copyright (C) 1997-2011 Mark Russinovich
Sysinternals - www.sysinternals.com

No matching handles found. 
```

我还能做什么（目前重启似乎是唯一的解决方案）来使用我的文件查找进程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:25:30.193

LockHunter (http://lockhunter.com) 可以帮助您。

它已在此处进行了审核[http://dottech.org/10534/unlocker-vs-lockhunter-which-one-should-you-get-for-your-file-unlocking-needs/](http://dottech.org/10534/unlocker-vs-lockhunter-which-one-should-you-get-for-your-file-unlocking-needs/)如果您愿意，可以在 Google 上搜索更多评论要双重肯定。我用过它，它很有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:24:08.773

Windows 7 上的一个方便技巧（不确定其他版本）是尝试删除文件（或修改它），当它告诉你它不能删除它因为它正在使用时它有时会告诉你正在使用它的程序.

如果仍然没有快乐，那么我认为你的权利，只需重新启动。

# php - 当所有其他字段都映射到实体时，验证 Symfony2 表单类中的非映射字段

> ID：13071865
> 
> 赞同：2
> 
> 时间：2012-10-25T15:20:40.657
> 
> 标签：php, symfony

我的 Symfony2 应用程序中有一个表单，主要用于持久化实体，但我添加了一个额外的非映射字段，用于上传文件，然后处理和删除该文件。但是，我不知道如何验证这个附加字段。

这里是在`buildForm()`我的表单类的方法中定义的：

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder
        ->add('name', 'text', array('label' => 'Name'))
        // ...
        ->add('data', 'file', array(
            'label'    => 'CSV Data File',
            'mapped'   => false,
            'required' => false,
        ));
} 
```

我最初尝试像这样将该字段的验证添加到包的`validation.yml`文件中，但由于该字段不是实体的一部分，因此它抛出了一个错误。

```
My\Bundle\Entity\MyEntity:
  properties:
    data:
      - File:
          maxSize: 1024k
          mimeTypes: text/*
          mimeTypesMessage: Please upload a CSV file 
```

我的下一个尝试是在表单类本身中添加约束，就像这样，但看起来你只能以这种方式验证数组，而不是对象，我猜这是因为它主要与我的实体相关联。

```
public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $collectionConstraint = new Collection(array(
        'data' => new File(array(
            'maxSize'          => '1024k',
            'mimeTypes'        => 'text/*',
            'mimeTypesMessage' => 'Please upload a CSV file',
        )),
    ));

    $resolver->setDefaults(array(
        'data_class'  => 'My\Bundle\Entity\MyEntity',
        'constraints' => $collectionConstraint,
    ));
} 
```

从文档看来，我可以使用`$this->get('validator')->validateValue();`它自己来验证额外的字段，但我很想一次验证整个表单并显示与字段本身的非映射字段相关的任何错误。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T15:35:58.337

您可以简单地将 property_path=null 传递给数据表单字段。属性路径用于确定相关的实体字段，通过将其值设置为 null 您告诉表单不向实体提供字段的值。

```
// ...
->add('data', 'file', array(
      'label'         => 'CSV Data File',
      'mapped'        => false,
      'required'      => false,
      'property_path' => null,
));
// ... 
```

**升级版：**

要验证此字段 id，最好创建嵌入式表单并传递数据字段和验证约束：

```
class dataType extends AbstractType

    // ...

    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('data', 'file', array(
            'label'    => 'CSV Data File',
            'required' => false,
        ));
    }

    public function getDefaultOptions(array $options)
    {
        $collection = new Collection(array(
            'data' => new NotBlank(),
            // ...
        ));

        return array(
            'validation_constraint' => $collection,
        );
    }

    //... 
```

并编辑实体表单类：

```
->add('data', 'file', array(
      'label'         => 'CSV Data File',
      'mapped'        => false,
      'required'      => false,
)); 
```

用。。。来代替：

```
->add('custom', new DataType(), array(
      'mapped'        => false,
)); 
```

# php - 使用单选按钮进行问卷调查以显示另一个

> ID：13071867
> 
> 赞同：0
> 
> 时间：2012-10-25T15:20:47.667
> 
> 标签：php, javascript, html, object

我有一份问卷调查表，答案是是或否。仅当您勾选“是”时，某些答案才会与下一个问题相关联。我想检查是，然后它向我显示与该问题相关的下一个问题。

例如，您想向我购买通话时间是/否 如果是，您想要多少通话时间？如果没有，请不要显示您想要多少通话时间问题只看到下一个问题可能会问您想在未来向我们购买通话时间吗？我使用 wordpress 自定义插件。不过想要剧本。

PHP页面1：

```
$output = '<script type="text/javascript" language="javascript"> function output()
{    alert("testing RadioButton events");   
}</script>';
PHP page cont…:
$output .= '<tr style="display:none"><td class="celllabel">Would you like to buy airtime from me? </td><td>'. doradiobutton('airtime',array('Yes','No'), 0,'output()') . '</td></tr>';
PHP page cont…:
$output .= '<tr><td class="celllabel">For how much airtime would you like?</td><td>'.ppi_dodropdown(ppi_dorange(5,200,5), 'airtimeamount', '[\'select\',\'validation\',null, null, /--select--/, \'Please select aitime amount\']'). '</td></tr>';

PHP function page:
function ppi_doradiobutton($name, $values, $checkedarray, $javascriptaction = null, $textvalue = null){ if($textvalue) {    for ($x=0;$x<count($values);$x++) { if ($textvalue == $values[$x]) { 
$output .= '<input type="radio" name="'.$name.'" value="'.$values[$x].'" checked="checked"  '. $onclickaction .'  />&nbsp;'.$values[$x].'<br />' ;        } }   $output .= '<input type="radio" name="'.$name.'" value="'.$values[$x].'"'  . $onclickaction .  '/>&nbsp;'.$values[$x].'<br />' ;        }    }     return $output;       } else {   $onclickaction = null;      if ($javascriptaction!=null) { $onclickaction = 'onclick="' . $javascriptaction .'"';   }
for ($x=0;$x<count($values);$x++) { if ($checkedarray == null) {    $output .= '<input type="radio" name="'.$name.'" id="'.$name.'" value="'.$values[$x].'"' . $onclickaction . ' >&nbsp;'.$values[$x].'<br />' ;  } else if ($checkedarray == $x) { $output .= '<input type="radio" name="'.$name.'" id="'.$name.'" value="'.$values[$x].'" checked="checked"  '. $onclickaction .'/>&nbsp;'.$values[$x].'<br />' ;
else {      $output .= '<input type="radio" name="'.$name.'" id="'.$name.'" value="'.$values[$x].'"'  . $onclickaction .  '/>&nbsp;'.$values[$x].'<br />' ; } }   return $output; }  } } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:50:18.600

如果您可以控制 html 和 css，那么使用 javascript/jquery 会非常简单。

在您需要在点击时显示的每个元素上放置一个类，例如：class="interactive"

理想情况下，这应该在包含元素上，例如 div 或 fieldset

将 .interactive 设置为在你的 CSS 中显示：'none'

这将隐藏所有包含的元素。

然后我们为所有包含元素的 id 属性赋予与单选按钮的 name 属性相同的属性。

例如：

```
 <input type="radio" name="q1" value="true" id="q1_t"><label for="q1_t">True</label>
    <input type="radio" name="q1" value="false" id="q1_f"><label for="q1_f">False</label>

<div class="interactive" id="q1">
<input type="text" name="how_many" value="" id="how_many" /><label for="how_many">How Many?</label>
</div> 
```

然后在你的javascript / jquery中：在所有单选按钮上放置一个点击处理程序，检查值是真还是假，获取名称 - 如果为真则显示：阻止具有该名称的ID的容器，如果为假则显示：无具有该名称 id 的容器：

```
 $('input:radio').change(function(){
     var name = $(this).attr('name');
     var val = $('input[name='+name+']:checked').val();

     if(val == 'true')
     {
       $('#'+name).css('display:block');
     }
     else
     {
       $('#'+name).css('display:none');
     }

}); 
```

我没有检查过这段代码，只是自上而下写的。但我希望它至少应该给出一个好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:35:01.203

您总是可以使用 ":checked" JQuery 选择器来检查是否选中了半径按钮。在这里，我给你举个例子：

```
var yourvar    = $('input[name=thenameofyourinput]:checked').val(); 
```

假设它是一个半径按钮，它应该有一个默认值，该值应该是是或否。因此，您从该按钮获取值并将其发布到检查发送值的页面。因此，您将在 PHP 页面中获得该页面的输出，然后如果值为“是”，您将显示一个新问题，或者更好的是，您可以使用 JQuery 进行检查，通过检查里面的值`yourvar`是否为“是的”。你可以在这里找到更多关于 ":checked" JQuery 选择器的信息：http: [//api.jquery.com/checked-selector/](http://api.jquery.com/checked-selector/)

# oracle - 让第二个表中的对象 id 是唯一的

> ID：13071870
> 
> 赞同：1
> 
> 时间：2012-10-25T15:21:00.773
> 
> 标签：oracle, object, user-defined-types

我得到以下sql：

```
create or replace type MEDIUM_TYPE AS OBJECT
(
me_movie REF MOVIE_TYPE,
me_rating varchar2(2),
me_runtime number(3,0),
me_release_year number(4,0),
me_list_price number(3,2),
me_our_price number(3,2),
me_availability varchar2(128),
me_aspect_ratio varchar2(8),
me_encoding number (1,0),
me_subtitle_language SUBTITLE_LANGUAGE_TYPE,
me_number_of_discs number (1,0)
)not final
/
create table DVD of MEDIUM_TYPE
object id system generated 
/ 
```

如何确保 dvd 表中的 me_movie 是唯一的？

而且，我怎么能做这样的事情？

```
mo_release_year number(4,0) BETWEEN 1900 AND 2100, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:51:35.397

它与关系表的语法几乎相同：

```
create table DVD of MEDIUM_TYPE
   ( me_movie primary key )  
object id system generated 
/ 
```

您遇到的一个问题是您将遇到此错误：

```
ORA-02329: column of datatype REF cannot be unique or a primary key 
```

诚然，这有点引人注目。您将需要重新考虑您的整个模型。对于那个很抱歉。

# c# - 为什么分支会锁定项目构建以复制 .DLL 文件？

> ID：13071875
> 
> 赞同：1
> 
> 时间：2012-10-25T15:21:26.730
> 
> 标签：c#, tfs, branch

我有一个`MAIN`包含大量项目的解决方案 - 整个解决方案构建良好。所以，我继续将 的一个分支`MAIN`带到一个名为 的新分支`DEVELOPMENT`，现在那里有一个项目，由于某种原因现在正在显示错误消息：

> 无法将文件“obj\x86\Debug\Delta.PDF.dll”复制到“bin\x86\Debug\Delta.PDF.dll”。拒绝访问路径“bin\x86\Debug\Delta.PDF.dll”。

对于我的生活，我无法理解看到我所做的只是一个 TFS 分支 - 只是想知道是否有人对此有任何建议

[无法将文件从 obj\Debug 复制到 bin\Debug](https://stackoverflow.com/questions/2625239/unable-to-copy-a-file-from-obj-debug-to-bin-debug)

从上面的答案中，我认为我可以锁定某种进程，所以我注销了我的机器，但它仍然存在。该分支与 main 位于同一父目录中，只是位于不同的子文件夹中。有什么建议么？

编辑：

我一直在尝试清理解决方案以执行 Jacooobley 所说的（清除调试），但出于某种原因，我的 .DLL 保留在其中，手动删除就可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:44:24.950

尝试从调试文件夹中删除 .DLL，然后重建解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:30:07.083

使用[Sysinternals](http://technet.microsoft.com/en-us/sysinternals/bb545021.aspx)的 Process Explorer 查找锁定此文件的进程 - 使用 Find 菜单搜索 Delta.PDF.dll；这应该为您提供有关文件被锁定的原因以及您可以做些什么的线索（例如，退出锁定过程）。

# c++ - 我应该如何设计 GLSL 着色器以在交火/SLI 上运行

> ID：13071882
> 
> 赞同：4
> 
> 时间：2012-10-25T15:21:41.067
> 
> 标签：c++, glsl, shader, gpgpu, sli

如果我正在用 glsl 编写可视化工具，我如何保证它会利用更多的 gpu？开箱即用，它只适用于一个，软件的什么样的步骤/设计将允许像素着色器在多张卡上并行运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T15:50:41.557

GLSL 中所需的零步骤。SLI/crossfire 驱动程序负责为您在 GPU 之间分配工作负载。nVidia 环绕和 AMD Eyefinity 也是如此：就着色器而言，它只是一个更大的渲染目标。

请参阅 nVidia 的这些幻灯片：[OpenGL 中的 SLI](http://http.download.nvidia.com/developer/presentations/2005/GDC/OpenGL_Day/OpenGL_SLI.pdf)，尤其是幻灯片“Things Interfering with SLI”。

您要确保正确设置了渲染循环（即调用了 SwapBuffers），并且您至少为 AFR 模式 SLI 进行了双缓冲。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T18:17:32.220

从 Jarrod 的回答中的评论看来，您遇到的“问题”是 AFR 模式（交替帧渲染）与 SFR 模式（拆分帧渲染），这是一个驱动程序模式设置问题。

在 AFR 模式下，驱动程序将每个完整帧发送到单个 GPU，并将交替帧发送到另一个 GPU。这对于您对最大化帧速率最感兴趣并且不太关心帧延迟的游戏和动画来说非常有用。以这种方式使用 GPU，您可以毫不费力地为 SLI 提供 2 倍的 fps 加速。但是，如果您只绘制一个帧（从您的评论看来就是这种情况），它将只使用一个 GPU。

在 SFR 模式下，驱动程序将分割每一帧并在每个 GPU 上渲染每一帧的一部分。这种模式的问题是两个 GPU 都需要为每一帧进行所有设置，因此您不会获得 2 倍的加速。事实上，几乎唯一会加速的是片段着色器（因为每个 GPU 将运行一半的片段），所以如果只有 50% 的（单 GPU）渲染时间是片段着色器，你只会得到（在最好）33% 的加速。由于拆分可能不平衡，您可能会得到更少（因此一个 GPU 最终会包含大部分片段）。

由于 SFR 通常较慢，因此 AFR 往往是默认设置。您可以通过控制面板控制 AFR 与 SFR。

# c# - 从 Form 启动外部 exe，然后等待它生成文件，或者关闭

> ID：13071884
> 
> 赞同：2
> 
> 时间：2012-10-25T15:21:49.850
> 
> 标签：c#, visual-studio-2010

我想做一些非常简单的事情，我希望有一个简单的方法来做！

1.  按下按钮从我的用户表单应用程序启动一个外部 exe（`Process.Start()`例如使用？）。
2.  在我的应用程序中等待此 exe 生成已知文件或关闭。（除了等待之外，我不需要在我的应用程序中进行任何其他活动）
3.  如果 exe 生成了所需的文件，它应该被自动杀死（`Process.Kill()`大概使用）

在这个阶段，我的表单输入应该恢复为活动状态。

启动的 exe 有自己的 UI，我的用户将在它处于活动状态时使用它。我认为关键在于有效地等待。我假设我可以启动一个计时器循环，它将每隔几百毫秒监视文件的出现和启动的 exe 的关闭。

当时，PC 几乎不会做任何其他事情，在我感觉的这些情况下，简单性胜过效率。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T15:26:12.013

你有基本的想法。

1.  `Process.Start`将启动该过程。
2.  [`Process.WaitForExit`](http://msdn.microsoft.com/en-us/library/fb4aw7b8.aspx)将阻塞直到应用程序完成
3.  您不需要杀死它，因为它会根据您的第二点完成（见上文）

如果可执行文件实际上没有成功完成，您还可以使用 a[`FileSystemWatcher`](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)来监视输出文件的更改，然后在正确生成输出后使用[`Process.CloseMainWindow`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.closemainwindow.aspx)or终止它。[`Process.Kill`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.kill.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T15:25:25.760

您可以使用[`WaitForExit`](http://msdn.microsoft.com/en-us/library/fb4aw7b8.aspx)on 方法`Process`等待进程退出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:30:01.603

您可以在没有循环的情况下进行等待。“流程”的 API 有其他选项来完成所需的任务。

```
 var procStartInfo = new ProcessStartInfo(@"cmd", "/c " + @"ping 127.0.0.1 -n 10")
            {
                RedirectStandardOutput = true,
                UseShellExecute = false,
                CreateNoWindow = true
            };

            var proc = new Process { StartInfo = procStartInfo };
            result = await Task<string>.Factory.StartNew(() =>
            {
                proc.Start();
                proc.WaitForExit();
                return proc.StandardOutput.ReadToEnd();
            }, TaskCreationOptions.PreferFairness); 
```

该代码适用于 .NET 4.5，以便您的 UI 在等待期间保持响应。如果您愿意，可以使用 .NET 4.0 对简单调用执行相同操作。使进程执行等待的代码行是：proc.WaitForExit(); 在这个例子中，我使用 shell 命令来执行。但是您可以调用任何可执行进程。

和

以“只读模式”观看文件的示例，以便它不会给出“另一个进程正在使用它”错误

```
this.fileFullPath = filePath + @"\" + fileName;
        this.fileSystemWatcher = new FileSystemWatcher(filePath);
        this.fileSystemWatcher.Filter = fileName;
        this.fileSystemWatcher.NotifyFilter = NotifyFilters.FileName;
        this.fileSystemWatcher.Created += new FileSystemEventHandler(FileSystemWatcherCreated);
        this.fileSystemWatcher.Changed += new FileSystemEventHandler(FileSystemWatcherChanged);
        ////this.fileSystemWatcher.Error += new ErrorEventHandler(FileSystemWatcherError);
        ////this.fileSystemWatcher.Renamed += new RenamedEventHandler(FileSystemWatcherRenamed);
        ////this.fileSystemWatcher.Deleted += new FileSystemEventHandler(FileSystemWatcherDeleted);
        this.fileSystemWatcher.EnableRaisingEvents = true; 
```

最后一行“EnableRaisingEvents 将实现事件通知，而“NotifyFilter”将帮助您观察目录或文件的不同属性和行为。

希望有帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:28:20.917

您可以使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)来监视您的新文件，您可以查找[Process.Exited](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.exited.aspx)事件以查看您的应用程序是否已关闭。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T15:32:44.980

导入 System.Diagnostics，将其添加到您的使用中，然后尝试以下代码：

```
Process extProc = new Process();
extProc.StartInfo.FileName = "extProc.exe";
extProc.StartInfo.Arguments = "argument string";
extProc.Exited += new EventHandler(extProc_Exited);
extProc.Start(); 
```

然后处理退出的事件

```
private void extProc_Exited(object sender, EventArgs e)
{
     Process thisProc = (Process)sender;
     if(thisProc.ExitCode == 1)
     {
         // success
     }
     else 
     {
         // error encountered
     }
} 
```

# batch-file - 如何使用批处理文件单击按钮？

> ID：13071885
> 
> 赞同：11
> 
> 时间：2012-10-25T15:21:53.277
> 
> 标签：batch-file

我需要在名为 Arthropod 的 Adob​​e Air 应用程序中单击一个名为“保存”的按钮。我可以使用以下命令在 bat 文件中启动应用程序：

```
cd C:\Program Files\Arthropod
start /w Arthropod.exe 
```

一旦它弹出，用户界面上有一个保存按钮。如何使用 bat 文件单击它？

我在读这个：

[http://www.ehow.com/how_7788761_press-buttons-batch-file.html](http://www.ehow.com/how_7788761_press-buttons-batch-file.html)

它展示了如何在 MS Word 中模拟对文件菜单和其他选项卡的单击，但是如何在任何其他按钮上执行此操作？

PS按钮上的文本是“保存”，这是我能想到的那个按钮的唯一唯一标识符。有没有什么是批处理的，我可以说类似（伪代码）：

```
$('button[text="Save"]').click(); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-26T05:04:26.583

没有本地方法可以干净地做到这一点。

但是如果你愿意，你可以用它`VBS`来模拟击键，类似于 AutoIT，但没有那么灵活。在加号方面，您不需要下载 VBS。自 95 年以来，它已包含在每个版本的 Windows 中。

* * *

我包含一个启动的示例`notepad.exe`，然后在其中键入以下内容：

```
Hello World!
abcDEF 
```

.
调用以下单行`LaunchNotepad.bat`：

```
cscript /nologo LaunchNotepad.vbs 
```

.
以下是 的内容`LaunchNotepad.vbs`：

```
' Create WScript Shell Object to access filesystem.
Set WshShell = WScript.CreateObject("WScript.Shell")

' Start / Run NOTEPAD.EXE
WshShell.Run "%windir%\notepad.exe"

' Select, or bring Focus to a window named `NOTEPAD`
WshShell.AppActivate "Notepad"

' Wait for 5 seconds
WScript.Sleep 5000

WshShell.SendKeys "Hello World!"
WshShell.SendKeys "{ENTER}"
WshShell.SendKeys "abc"
WshShell.SendKeys "{CAPSLOCK}"
WshShell.SendKeys "def" 
```

请注意，如果有一个或多个`Notepad.exe`已打开的实例，并且打开记事本的时间超过 5 秒，则上述代码可能会选择记事本的最后一个活动实例并输入。

* * *

要使`VBS`代码按您的意愿工作，您需要学习如何通过键盘在 Adob​​e Air 中导航。通常选项卡和/或箭头键就足够了。有时您可能需要使用`ALT`键进入菜单。

此外，您实际上可能能够使用一系列键盘命令，例如`ALT`+ `F``S``ENTER`，甚至是键盘快捷键，例如`CTRL`+ `S`。

To send `TAB`, `ALT`+`F`, and `CTRL`+`S` :

```
WshShell.SendKeys "{TAB}"        ' TAB                TAB Key
WshShell.SendKeys "%F"           ' ALT-F              (F)ile Menu
WshShell.SendKeys "^S"           ' CTRL-S             Save File
WshShell.SendKeys "%(Fa){ENTER}" ' ALT-F+ALT-A ENTER  (F)ile -> Save (A)s -> (ENTER)
WshShell.SendKeys "{UP}"         ' Up Arrow           Up Arrow
WshShell.SendKeys "{DOWN}"       ' Down Arrow         Down Arrow
WshShell.SendKeys "{LEFT}"       ' Left Arrow         Left Arrow
WshShell.SendKeys "{RIGHT}"      ' Right Arrow        Right Arrow 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-25T15:30:33.527

您可以使用[AutoIt](http://www.autoitscript.com/site/autoit/)来执行此操作。您可以生成一个可以单击“保存”按钮的脚本，并从批处理文件中调用生成的 EXE 文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-29T23:09:55.807

Winbatch is another program that can send keystrokes, but unlike AutoIt I don't believe it's free.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T15:29:29.833

您不能使用 bat 文件自动单击按钮。如果可能的话，您仍然需要某种用于 Adob​​e Air 的 API 来访问控件本身。但是，如果此按钮有键盘快捷键，您可以模拟击键并将其发送到应用程序。

# applescript - 在 AppleScript 中关闭时需要密码：如何在关闭前运行脚本？

> ID：13071887
> 
> 赞同：0
> 
> 时间：2012-10-25T15:21:56.523
> 
> 标签：applescript, shutdown

人们有一个讨厌的习惯，就是在我不看的时候关闭我的电脑，所以我想要求输入密码才能关闭我的电脑。但是，我不知道如何让脚本在关机时运行。我该怎么做呢？（感谢您帮助获取密码，但我想我可以处理它。）

编辑：一个想法是它会在计算机打开时运行，然后继续监听关机直到它被请求，然后拦截它。我可以做第一部分，但剩下的呢？

# wcf - 如何通过网络公开 net.tcp wcf 服务？

> ID：13071889
> 
> 赞同：0
> 
> 时间：2012-10-25T15:22:08.073
> 
> 标签：wcf, networking, configuration

我的客户端-服务器应用程序有问题，如果您能帮助我，我将不胜感激。我有一个自托管服务器，问题是在我的本地机器上，该服务在开发环境中运行良好。我试图在整个网络中做同样的事情。我在 net.tcp://localhost:8990/ 上配置了这个，但我通过 netstat 意识到该服务位于我的本地主机 127.0.0.1 上，所以我尝试了 net.tcp://192.168.0.12 :8990/ ，这是我的网络IP，但仍然可以看到它，客户端也无法连接。我尝试将其注册为 Windows 服务，但我无法公开该服务。我已经禁用了所有的防火墙，所以我不知道还有什么可以尝试的。谢谢你的帮助！亚历杭德拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T13:15:58.217

问题是我没有运行 netsh 命令来端口保留。我之前尝试过，但是该命令在参数上给了我一个错误，这与示例是 user=\Everyone 的事实有关，而在我的本地配置中它必须是 user=\Todos。完成此操作后，我可以看到该端口上公开的程序。谢谢

# drupal - drupal分类网站中的图片

> ID：13071897
> 
> 赞同：0
> 
> 时间：2012-10-25T15:22:35.997
> 
> 标签：drupal

嗨，我正在做一个分类网站，我需要帮助，当发布广告的用户没有图片时，我想默认放置一张图片，例如，当你发布广告但你没有图片时系统默认显示图片不可用或类似gumtree之类的图片我在drupal 7中找不到此选项，请有人可以帮助我吗？多谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:47:20.620

**图片字段**类型使您能够在其设置页面 (http://yoursite/admin/structure/types/manage/page/fields/field_testimage) 上上传默认图片。

您可以为您配置的每个图像字段上传默认图像。

它唯一不会在一组图像中旋转。对于不上传图片的每个人来说，这只是一张默认图片。

# sqlite - MS Access：联合查询：靠近“（”语法错误；未使用括号

> ID：13071901
> 
> 赞同：1
> 
> 时间：2012-10-25T15:22:46.617
> 
> 标签：sqlite, ms-access, union

我正在使用 MS Access 2010，我有以下查询

```
SELECT id FROM car

UNION

SELECT id FROM user 
```

当我尝试运行它时，Access 说“ODBC 查询失败。靠近“（”：语法错误（1）（#1）”。但是，正如您所看到的，查询中没有单括号。

当我在 MySQL 中运行查询时，它工作得很好。这些表是从一个 sqlite 源链接到的。

PS：当然原始查询要复杂得多。但是当我试图减少错误时，我最终得到了这个同样不起作用的简单查询。

# javascript - SVG动画有一个属性dur，但是有没有办法设置动画的速度呢？

> ID：13071905
> 
> 赞同：1
> 
> 时间：2012-10-25T15:22:59.987
> 
> 标签：javascript, svg, svg-animate

此 SVG 动画代码为每个矩形生成不同的速度。我需要相似的速度（不同的持续时间）。是否有一个我找不到的属性，或者一个简单的解决方案。

* * *

```
<animate attributeName="x" attributeType="XML" begin="0s" dur="10s" from="0" to="500" fill="freeze"/> 
```

```
<animate attributeName="x" attributeType="XML" begin="0s" dur="10s" from="0" to="800" fill="freeze"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-11T08:43:24.373

以下是设置速度动画的方法：

```
<animate attributeName="x" attributeType="XML" begin="0s" dur="10s" from="0" to="800" fill="freeze" calcMode="spline" keySplines="0 0 1 0" /> 
```

**calcMode="spline"**和**keySplines="0 0 1 0"**负责速度

在“手动模式”下设置正确的速度相当不方便。所以这个工具在帮助： http: [//www.carto.net/svg/samples/keysplines.svg](http://www.carto.net/svg/samples/keysplines.svg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-28T23:41:23.433

不，SVG 动画是基于时间的。calcmode="paced" 您可能指的是简单的默认动画模式（与动画从开始到结束跳转的离散模式相比）。如果你想要一个 JavaScript 风格的“setInterval()”动画，你必须使用 JavaScript。

# java - Java深度优先搜索无限循环

> ID：13071909
> 
> 赞同：4
> 
> 时间：2012-10-25T15:23:17.200
> 
> 标签：java, infinite-loop, depth-first-search

我正在尝试在 Java 中实现深度优先搜索算法。知道为什么这种方法会进入无限循环吗？谢谢。

```
public Node search(Graph graph, String nodeName, int ID) {

    //Get the root node
    Node root = graph.getRoot();

    Stack<Node> stack = new Stack<Node>();
    //Add the root to the stack
    stack.push(root);

    while(!stack.isEmpty()) 
    {
        Node n = stack.pop();
        //Check to see if node n is the requested node
        if(n.getName().equals(nodeName))
        {
            //Found
            return n;
        }else
        {
            //Create an array of the leaf nodes to node n
            Node[] children = n.getNeighbours();
            for(int i =0; i<children.length; i++)
            {
                //Add the leaf nodes to the stack
                stack.push(children[i]);
                System.out.println(stack.peek());
            }
        }
    }
    //Not found so return null
    return null;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T15:27:50.500

如果你的图有循环（或者是无向的），你必须在访问它们之后“标记”节点，否则你会不断地回到它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T15:27:34.150

除非您的图表是一棵树，否则它将有循环。一个节点可以是它自己的孙子。您需要防止已经访问过的节点被添加到搜索树中。

一个简单的方法是通过另一个数据结构：

```
Set<Node> visitedNodes = new HashSet<Node>();

//...
if ( !visitedNodes.contains(children[i]) ) {
   stack.push(children[i]);
   visitedNodes.add(children[i]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:32:43.713

如果您的图表包含任何循环，这是预期的行为；简单的深度优先搜索将访问一个已经访问过的孩子，无限循环。

A straightforward way to avoid it is to add every node to a HashSet after checking if it's the node you're looking for, and then refusing to add it to the stack if it has already been inspected.

# php - 使用 Glob() 时如何删除文件路径？

> ID：13071910
> 
> 赞同：7
> 
> 时间：2012-10-25T15:23:18.770
> 
> 标签：php, glob

我只想显示我的图像的名称，没有路径（`../uploadedImages/`）

```
<?php $images = glob("../uploadedImages/[kK]*.{jpg,png,gif,bmp}",GLOB_BRACE);   
foreach($images as $image) {echo "$image<br>"} ?> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-25T15:26:09.873

采用[`basename`](http://php.net/manual/en/function.basename.php)

```
echo basename($image) . "<br>"; 
```

# c# - 带有基本调用的 lambda 中的 BadImageFormatException

> ID：13071923
> 
> 赞同：2
> 
> 时间：2012-10-25T15:23:45.570
> 
> 标签：c#, .net

> **可能重复：**
> [编译器为匿名方法生成了不正确的代码](https://stackoverflow.com/questions/12813535/compiler-generated-incorrect-code-for-anonymous-methods)

为什么下面的代码原因`BadImageFormatException`？

```
public static void Main()
{
    var c = new Child();
    Console.WriteLine(c.Something());
}

public class Base<T>
{
    public virtual T Something()
    {
        return default(T);
    }
}

public class Child : Base<int>
{
    public override int Something()
    {
        //return base.Something(); //This one works well

        //Func<int> func = base.Something;
        //func(); //Works well too

        Func<int> func = () => base.Something();
        return func(); //BadImageFormatException
    }
} 
```

`BadImageFormatException: An attempt was made to load a program with an incorrect format. (Exception from HRESULT: 0x8007000B)`

.NET 4.0。x64 和 x86 机器。

**UPD。**等待 MS 的回复。[票#768801](https://connect.microsoft.com/VisualStudio/feedback/details/768801/using-base-qualifier-in-anonymous-method-causing-badimageformatexception)

# wpf - 超链接无法与关联的命令一起正常工作

> ID：13071931
> 
> 赞同：3
> 
> 时间：2012-10-25T15:24:11.030
> 
> 标签：wpf, xaml, data-binding, hyperlink

我有`Hyperlink`一个`Grid`. 我将命令绑定到启用/禁用它的超链接。然后我使用命令禁用它。然后在其父 ( `Grid`) 上设置`IsEnabled=False`属性。之后我用我的命令启用我的超链接并启用网格，但超链接没有激活！

这是示例：

```
Command testCommand = new Command();

public MainWindow() {
  InitializeComponent();
  hl.Command = testCommand;
}

private void Start(object sender, RoutedEventArgs e) {

  //Disable Hyperlink
  testCommand.Enabled = false;
  //Disable Grid
  grid.IsEnabled = false;
  //Enable Hyperlink
  testCommand.Enabled = true;
  //Enable Grid
  grid.IsEnabled = true;
  //hl.IsEnabled = true; //if uncomment this all will be work
} 
```

XAML：

```
<Window x:Class="WpfApplication25.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow"
        Height="172"
        Width="165">
  <StackPanel>
    <Grid x:Name="grid">
      <TextBlock>
        <Hyperlink x:Name="hl">Test</Hyperlink>
      </TextBlock>
    </Grid>
    <Button Content="Start"
            Name="button1"
            Click="Start" />
  </StackPanel>
</Window> 
```

并注册一个 ICommand：

```
public class Command : ICommand {
  private bool enabled;
  public bool Enabled {
    get {
      return enabled;
    }
    set {
      enabled = value;
      if (CanExecuteChanged != null)
        CanExecuteChanged(this, EventArgs.Empty);
    }
  }
  public bool CanExecute(object parameter) {
    return Enabled;
  }
  public event EventHandler CanExecuteChanged;
  public void Execute(object parameter) { }
} 
```

**更新：**

如果 Hyperlink 被 Button 替换，即使它的父级被禁用（grid.IsEnabled = false）也会启用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:45:57.640

哇，我明白了这就是你所缺少的

```
 public class Command : ICommand
    {
        private bool enabled;
        public bool Enabled
        {
            get
            {
                return enabled;
            }
            set
            {
                enabled = value;
                //if (CanExecuteChanged != null)
                //    CanExecuteChanged(this, EventArgs.Empty);
            }
        }

        public bool CanExecute(object parameter)
        {
            return Enabled;
        }
        public event EventHandler CanExecuteChanged
        {
            add { CommandManager.RequerySuggested += value; }
            remove { CommandManager.RequerySuggested -= value; }
        }

        public void Execute(object parameter) { }
    } 
```

CanExecuteChanged 将命令订阅委托给 CommandManager

# php - 数组工作一次，循环后不再工作

> ID：13071932
> 
> 赞同：1
> 
> 时间：2012-10-25T15:24:14.727
> 
> 标签：php, arrays, actionscript-3, loops

我正在做一个 Flash 测验，我从 PHP 中提取数据以在我的游戏中用作问题和答案。一切都很好，但我在确定正确答案时遇到了问题。测验是多项选择，4个可能的答案。当您单击一个按钮时，它将激活我的功能 -

```
button1.addEventListener(MouseEvent.CLICK,returnAnswerOne);
function returnAnswerOne(event:Event){
answeredQuestion()
} 
```

这工作得很好。它激活以下功能 -

```
function answeredQuestion() {
    if(correctoneArray[numLoops] == 1){
        trace(correctoneArray[numLoops]);
        trace("right answer");
        gotoAndStop(4);
    } else { 
            trace(correctoneArray[numLoops]);
        trace("wrong answer");
        gotoAndStop(5);
    } 
```

我的闪光灯知道答案是否正确的方式是通过查看数字“1”是否存在。我的正确答案的 PHP 输出如下所示

```
&correctone=0/0/0/0/0/0/0/0 &correcttwo=0/1/0/0/1/0/1/0 &correctthree=1/0/1/0/0/0/0/1 &correctfour=0/0/0/1/0/1/0/0 
```

这是我用来导入这些数组的方法，效果很好 -

```
var loader3:URLLoader = new URLLoader();
loader3.addEventListener(Event.COMPLETE, completeHandler2);
loader3.dataFormat = URLLoaderDataFormat.VARIABLES;
loader3.load(request);

function completeHandler2(event:Event) :void{
var correctone:String = event.target.data.correctone;
var correctoneArray:Array=correctone.split("/")
trace("Correctone Loaded"); 
```

尽量避免向我的整个脚本发送垃圾邮件，所以想象一下其中有 4 个函数，每个函数都检查“1”。框架 5 是您被告知问题错误的地方，框架 4 是您被告知问题正确的地方。上面发布的所有脚本都发生在第 3 帧。

*深呼吸*我的问题是，这对于第一个问题来说一切正常，但是当我开始提问第二个问题时，当您单击它们时所有答案都是错误的，并且在整个测验中都会继续。有谁知道可能出了什么问题？我的跟踪显示，在问题 1 之后，所有按钮都产生值 0。

如果您需要任何其他信息，请告诉我，这个让我难过...

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T16:23:48.950

如果不查看所有内容，很难确切地知道出了什么问题。让我建议你把事情整理一下。首先，利用您可以按名称引用变量的事实，以避免重复所有用于数组解析和按钮处理程序的代码。其次，确保你只在一个地方增加你的问题编号。第三，使用更有意义的变量名。

总之，这应该让你去：

**笔记：**

*   我已经调整了你的帧，所以问答按钮首先出现在第 3 帧，但扩展到第 4 帧。现在正确答案在第 5 帧，错误答案在第 6 帧。这样你就不会一直重新加载答案并重新创建事件处理程序每次返回*第 4*帧。
*   我假设您的答案按钮被命名为“button1”、“button2”等。

```
// ----------------------------- FRAME 1 -----------------------------//
// Declare answers array and questionNumber counter
var answers:Array = [];
var questionNumber:int = 0;

// ----------------------------- FRAME 3 -----------------------------//
//  Just load the answers and hook up the  event handlers
// -------------------------------------------------------------------//

// Load the answers 
var answerKeyLoader:URLLoader = new URLLoader();
answerKeyLoader.addEventListener(Event.COMPLETE, answerKeyCompleteHandler);
answerKeyLoader.dataFormat = URLLoaderDataFormat.VARIABLES;
answerKeyLoader.load(request);

function answerKeyCompleteHandler(event:Event):void {
    var numberNames:Object = { one:1, two:2, three:3, four:4 };
    for(var nName:* in numberNames) {
        var index:int = numberNames[nName];
        var answerString:String = e.target.data["correct" + nName];
        answers[index] = answerString.split("/");
    }
}

// Attach button handlers (all buttons can use the same handler)
for(var i:uint = 1; i < 5; i++) {
    var button:DisplayObject = this["button" + i.toString()];
    button.addEventListener(MouseEvent.CLICK, onClickAnswerButton);
}

function onClickAnswerButton(e:MouseEvent):void {
    var buttonName:String = DisplayObject(e.currentTarget).name;
    var buttonNumber:int = int(buttonName.substring(6,1));
    var correct:Boolean = answers[buttonNumber][questionNumber] == 1;
    // Double check:
    trace("buttonName =", buttonName, ", buttonNumber =",buttonNumber,
          ", questionNumber =", questionNumber, ", correct =", correct);

    // Increment questionNumber here and nowhere else
    questionNumber++;
    if(correct) {
        trace("right answer");
        gotoAndStop(5);
    } else{
        trace("wrong answer");
        gotoAndStop(6);
    }
}

// ----------------------------- FRAME 4 -----------------------------//
//  Just show the new question
// -------------------------------------------------------------------//
someLabel.text = questions[questionNumber];
stop();

// ----------------------------- FRAME 5 -----------------------------//
someButton.addEventListener(MouseEvent.CLICK, onClickButton);
function onClickButton(e:MouseEvent):void {
    someButton.removeEventListener(MouseEvent.CLICK, onClickButton);
    goToAndPlay(4);
}

// ----------------------------- FRAME 6 -----------------------------//
someButton.addEventListener(MouseEvent.CLICK, onClickButton);
function onClickButton(e:MouseEvent):void {
    someButton.removeEventListener(MouseEvent.CLICK, onClickButton);
    goToAndPlay(4);
} 
```

# iis - 为什么/如何在获取与设置时 ManagedPipelineMode 是不同的类型？

> ID：13071933
> 
> 赞同：5
> 
> 时间：2012-10-25T15:24:14.110
> 
> 标签：iis, powershell, iis-7.5

在尝试编写一些脚本来管理我们的 IIS 站点时，我遇到了 IIS 中的 ManagedPipelineMode 的一些奇怪行为。我的代码相当通用，使用 Get-ItemProperty 读取旧值，如果不是我们想要的值，则使用 Set-ItemProperty 更新它。

但是，如果我运行这个：

```
Get-ItemProperty "IIS:\AppPools\MyAppPool" "managedPipelineMode" 
```

我拿回*字符串* `Classic`。但是，如果我运行这个：

```
Set-ItemProperty "IIS:\AppPools\MyAppPool" "managedPipelineMode" "Classic" 
```

我找回了错误`Classic is not a valid value for Int32`。

所以，我知道我可以使用 设置值，但我不明白为什么使用vs`([int][Microsoft.Web.Administration.ManagedPipelineMode]::Classic)`时类型似乎不同，或者我如何以一致的方式查询它。`Get-ItemProperty``Set-ItemProperty`

注意：我真的不想为 ManagedPipelineMode 设置一个特殊情况，因为其他所有属性似乎都按预期运行。所以，两个问题：

1.  这种奇怪的行为是什么，它允许一个属性`string`在读取时是一个，但`int`在设置时是什么？这是所有枚举的情况吗？
2.  有没有办法使用相同的类型读/写这个属性，所以我可以编写能够读取值的代码，检查它是否是我们想要的，如果不是，更新它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-05-16T20:55:40.613

使用以下值： 0 = 集成；1 = 经典

```
Set-ItemProperty "IIS:\AppPools\MyAppPool" "managedPipelineMode" "1" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-12T21:17:34.127

尝试使用

```
Set-ItemProperty -Path:'IIS\AppPools\MyAppPool' -Name:'managedPipelineMode' -Value:Classic 
```

请注意 Classic 中缺少引号

注意：我更喜欢专门调用参数名称，这样以后就不会混淆，如果他们更新/更改命令，就不会发生奇怪的事情

我还使用冒号绑定运算符。这清楚地表明该值属于该名称的参数。

# wpf - 优化 WPF 加载项激活

> ID：13071935
> 
> 赞同：2
> 
> 时间：2012-10-25T15:24:18.223
> 
> 标签：wpf, add-in, maf

激活 WPF 加载项是否有任何优化技巧？我当前的 AddIn 在大约 5-6 秒内激活，但由于它正在 UI 线程上加载，因此 UI 在此期间被阻止。我试图简单地显示一个进度条，但由于 UI 阻塞，它永远不会更新。我实现了一个简单的 hack，它启动一个线程，等待 2 秒，然后通过 Dispatcher 加载 AddIn。此解决方案不错，但两秒钟后进度条冻结。

# c# - ModalPopupExtender，它的 ID 和它的 BehaviorID 在被 javascript 调用时返回 null

> ID：13071937
> 
> 赞同：1
> 
> 时间：2012-10-25T15:24:30.087
> 
> 标签：c#, javascript, asp.net, gridview, modalpopupextender

我已经按如下方式初始化了我的 MPE：

```
<asp:modalpopupextender ID                  ="ModalPopupExtender1"
                    BehaviorID          ="ModalBehavior"
                    runat               ="server"
                    OkControlID         ="btnCancel"
                    CancelControlID     ="btnCancel"
                    TargetControlID     ="dead"
                    PopupControlID      ="Panel1"
                    BackgroundCssClass  ="ModalPopupBG"/> 
```

`ModalPopupExtender`是`TargetControlID`：_

```
<asp:Button id="dead" runat="server"/> 
```

然后我将我的 gridview 行分配 onclick 属性来调用`mpe.Show`：

```
switch (e.Row.RowType)
{
    case DataControlRowType.DataRow:
        e.Row.Attributes.Add("onmouseover", "this.style.cursor='hand'");
        e.Row.Attributes.Add("onclick", "ShowPopup()");
        break; 
```

我*在 MasterPage 中的*`ShowPopup()`功能：

 *```
function ShowPopup() {
    var mpe = $find('ModalBehavior');
    mpe.show()
} 
```

当单击 GridView 行时，我尝试了很多方法来尝试生成除空值之外的任何内容，但它们也没有工作。如：

```
switch (e.Row.RowType)
{
    case DataControlRowType.DataRow:
        e.Row.Attributes.Add("onmouseover", "this.style.cursor='hand'");
        e.Row.Attributes.Add("onclick", String.Format("javascript:$find('{0}').show();", ModalPopupExtender1.ClientID));
        break; 
```

这也是

```
String.Format("javascript:$find('{0}').show();", ModalPopupExtender1))
String.Format("javascript:$find('{0}').show();", ModalBehavior)) 
```

单击 gridview 行时，出现以下错误：

> 错误：'null' 为 null 或不是对象

我也尝试过实现：[Trouble getting a reference to a ModalPopupExtender using javascript](https://stackoverflow.com/questions/996910/trouble-getting-a-reference-to-a-modalpopupextender-using-javascript)

```
function pageLoad() {
    var mpe = $find('ModalBehavior');
    mpe.show();
    debugger;
    $find('ModalBehavior').add_showing(
        function () {
            alert("Modal Popup will be showing");
        }
    );
} 
```

但得到了相同的结果。任何帮助将不胜感激。*

# webgl - 将 TEXTURE_2D 与 Three.js 一起使用

> ID：13071943
> 
> 赞同：0
> 
> 时间：2012-10-25T15:25:05.760
> 
> 标签：webgl, three.js

有没有办法在 Three.js 中使用 TEXTURE_2D 作为纹理？

我尝试在 Three.js 图像查看器中使用非常高分辨率的图像。性能现在是个问题，所以我正在尝试将图像转换为 POT 以查看它是否有任何区别。我正在使用这里建议的脚本：[http ://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences](http://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences)

```
function createTextureFromImage(image) {
   var gl = renderer.context;
   var texture = gl.createTexture();
   gl.bindTexture(gl.TEXTURE_2D, texture);
   if (!isPowerOfTwo(image.width) || !isPowerOfTwo(image.height)) {
       // Scale up the texture to the next highest power of two dimensions.
       var canvas2 = document.createElement("canvas");
       canvas2.width = nextHighestPowerOfTwo(image.width);
       canvas2.height = nextHighestPowerOfTwo(image.height);
       var ctx = canvas2.getContext("2d");
       ctx.drawImage(image, 0, 0, image.width, image.height);
       image = canvas2;
   }
   gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);
   gl.generateMipmap(gl.TEXTURE_2D);
   gl.bindTexture(gl.TEXTURE_2D, null);
   return texture;
} 
```

但我不知道如何将返回的纹理对象与 THREE.Texture 一起使用。有任何想法吗？

**编辑 1：** 我正在查看 Three.js 代码，发现它隐含地做了我想要实现的事情： [https ://github.com/mrdoob/three.js/blob/master/src/loaders/Loader .js](https://github.com/mrdoob/three.js/blob/master/src/loaders/Loader.js)

有人可以确认吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T16:23:36.243

像这样的东西应该工作：

```
function createTextureFromImage( image ) {

   var canvas = document.createElement( "canvas" );

   canvas.width = nextHighestPowerOfTwo( image.width );
   canvas.height = nextHighestPowerOfTwo( image.height );

   var ctx = canvas2.getContext( "2d" );

   ctx.drawImage( image, 0, 0, image.width, image.height );

   return canvas;
}

var texture = new THREE.Texture( createTextureFromImage( image ) ); 
```

# asp.net-mvc - 如何在剃刀视图引擎中路由到 aspx？

> ID：13071944
> 
> 赞同：0
> 
> 时间：2012-10-25T15:25:09.377
> 
> 标签：asp.net-mvc, razor

我使用剃刀视图引擎。我需要获取路由 url aspx 视图。

例子：

`<tag src="/ReportViewer.aspx" />`- 当前的实施。网站根目录下的文件。

`<tag src="@Url.Action("ReportViewer", "Reports") />`- 我需要这个结构。文件路径 Views/Reports/ReportViewer.aspx

有人知道解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T17:00:35.343

```
routes.MapRoute("ReportViewer", "Views/Reports/ReportViewer.aspx");

@Url.RouteUrl("ReportViewer") --> /Views/Reports/ReportViewer.aspx 
```

# mysql - SQL：选择 5 个 url，尽可能快地访问最少的域

> ID：13071948
> 
> 赞同：2
> 
> 时间：2012-10-25T15:25:23.967
> 
> 标签：mysql, sql

我有`url_stack`一张桌子`urlid`和`domainid`一张`domain_stack`桌子`domainid`和一张桌子`domain_count`。

`url_stack`有`urlid`作为它的主键和一个`BTREE`索引`domainid`。`domain_stack`有`domainid`作为它的主要和一个`BTREE`索引`domain_count`。

我不断地将 url 添加到堆栈中。当从堆栈中弹出一个 url 时，我添加`1`到它的`domain_count`.

当我弹出一个 url 时，我会保留它的域的计数，这就是为什么有很多域没有任何 url（这就是为什么@moj 答案有问题）。

弹出时，我想`url`为每个可用选择一个`domain_counts`并将自己限制在前 5 名。

例如，一个常见的结果是：

```
+------------+------------+--------------+
| urlid      | domainid   | domain_count |
+------------+------------+--------------+
|  852336945 | -184315873 |            1 |
| 1930023009 |  -43391685 |            2 |
| -112137768 | 1607144692 |            4 |
| 1673460622 |  567460239 |            8 |
|  612511843 | 1444323871 |           11 |
+------------+------------+--------------+  
5 rows in set (5.37 sec) 
```

通过调用：

```
SELECT urlid,domain_stack.domainid,domain_stack.domain_count
FROM  domain_stack
INNER JOIN url_stack
ON url_stack.domainid = domain_stack.domainid
GROUP BY domain_stack.domain_count LIMIT 5; 
```

问题是这太慢了——每次查询我必须在 0.5 秒以下。我应该如何更改我的查询/我的表以使其更快？

*编辑*：这是一个描述情况的链接[http://sqlfiddle.com/#!2/70ded/1/0](http://sqlfiddle.com/#!2/70ded/1/0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T21:00:01.473

试试这个（加入前 domain_count 的组值）：

```
select 
    us.*, -- random row from group is ok
    top5.domain_count 
from 
    url_stack us
    inner join 
         (  
           select 
               domainid, -- random domain id from group is ok
               domain_count
           from 
               domain_stack
           group by 
               domain_count asc
           limit 5 -- all domains must have a counter > 0
         ) top5
         on top5.domainid = us.domainid
group by
    top5.domain_count asc
limit 5 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/70ded/55/0)

# svn - 更改密码后 SVN 通知程序不会更新

> ID：13071956
> 
> 赞同：4
> 
> 时间：2012-10-25T15:25:53.793
> 
> 标签：svn, tortoisesvn, change-password

我最近不得不更改我的网络密码，现在 SVN Notifier 不会更新。

我怀疑是新密码导致了这个问题，知道如何更新 SVN Notifier 用来访问存储库的密码吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T16:22:40.477

只有当您使用像 TortoiseSVN 这样可以为您存储密码的工具时，我的回复才有效。

您首先必须通过转到 TortoiseSVN->Settings->Saved Data->Authentication Data->Clear 删除您在 SVN 中存储的密码。这将删除 Tortoise 的旧密码。在此之后，当您尝试更新或提交时，您将需要重新验证您的登录。如果您保存此身份验证，SVN 通知程序可以访问该保存的信息并能够再次连接到您的存储库。

# c++ - 如何强制 CListCtrl 始终选择一项？

> ID：13071965
> 
> 赞同：2
> 
> 时间：2012-10-25T15:26:21.967
> 
> 标签：c++, visual-c++, mfc, clistctrl

我希望 CListCtrl 始终具有选定的项目，例如单选按钮的集合。

我使用了以下样式：`LVS_SHOWSELALWAYS|LVS_SINGLESEL`

我一直在寻找这种风格，但一直找不到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-13T20:15:50.790

处理 WM_LBUTTONDOWN。在 CListCtrl 派生类中，添加

MyListCtrl.cpp：

```
BEGIN_MESSAGE_MAP(CMyListCtrl, CListCtrl)
    ON_WM_LBUTTONDOWN()
END_MESSAGE_MAP()

void CMyListCtrl::OnLButtonDown(UINT nFlags, CPoint point)
{
    UINT uHitFlags;
    int nItem = HitTest(point, &uHitFlags);

    if (uHitFlags & LVHT_NOWHERE)
    {
        // eat the message by just returning
        return;
    }

    CListCtrl::OnLButtonDown(nFlags, point);
} 
```

这将防止鼠标点击进入控件并吃掉消息。您仍然可以通过编程方式删除选择，但用户将无法单击项目下方空白区域中的任何位置来删除选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T08:26:13.127

我认为没有对此的内置支持。

从一开始就进行选择的部分很简单：只需在填充列表后选择一个项目：

```
// Populate the list
// ...

c_MyList.SetItemState(nItem, LVIS_SELECTED|LVIS_FOCUSED, LVIS_SELECTED|LVIS_FOCUSED); 
```

另一部分，当用户在所有项目之外单击时防止取消选择所有项目，则比较棘手。您可以轻松检测列表是否取消选择项目，但不能检测项目为何失去选定状态。即，您无法判断它是取消选择它以选择另一个还是未选择所有项目。原因是控件先发送“item X has been deselected”通知，然后是“item Y has been selected”通知。如果未选择任何项目，您将获得第一个，但不会获得第二个。

我想到的一个小想法是捕获 NM_CLICK 通知并防止控件取消选择该项目。问题是在所有选择/取消选择通知*之后*发送 NM_CLICK 。

所以，这是我想出的小技巧：当一个项目失去选定状态时，存储它的项目索引。然后在 NM_CLICK 通知中，如果激活的项为-1，则再次选择最后一个未选中的项：

```
void CMyDialog::OnLvnItemchangedListaEjesPane(NMHDR *pNMHDR, LRESULT *pResult)
{
    LPNMLISTVIEW pNMLV = reinterpret_cast<LPNMLISTVIEW>(pNMHDR);

    if (pNMLV->uChanged & LVIF_STATE)
    {
        UINT oldSelectionState = (pNMLV->uOldState & LVIS_SELECTED);
        UINT newSelectionState = (pNMLV->uNewState & LVIS_SELECTED);

        if ( oldSelectionState == LVIS_SELECTED && newSelectionState == 0 )
        {   // Deselect item
            m_LastDeselectedItem = pNMLV->iItem;
        }
        // ...
    }

    *pResult = 0;
}

void CMyDialog::OnNMClickListaEjesPane(NMHDR *pNMHDR, LRESULT *pResult)
{
    LPNMITEMACTIVATE pNMItemActivate = reinterpret_cast<LPNMITEMACTIVATE>(pNMHDR);

    if (pNMItemActivate->iItem == -1)
    {
        c_ListaEjes.SetItemState(m_LastDeselectedItem, LVIS_SELECTED|LVIS_FOCUSED, LVIS_SELECTED|LVIS_FOCUSED);
    }
    *pResult = 0;
} 
```

它可能无法完全满足您的需求，因为它实际上会取消选择该项目然后再次选择它。

可能有更好的解决方案，包括创建您自己的 CListCtrl 子类并拦截点击，检查它们是否会强制进行空选择并阻止它，但您必须确定额外的工作是否值得麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:47:53.437

这可以在您设计 clistctrl 时简单地在对话框编辑器中完成，将“属性”中的“始终显示选择”和“单一选择”选项设置为 true。如果您想通过代码执行此操作，那么您有正确的方法，但可能是错误的地方。覆盖 OnInitDialog 并在其中首先调用 CDialog::OnInitDialog，然后设置新样式（使用 ModifyStyle）。问题是基类覆盖了您的样式更改。除此之外，它可能是一些事情，MFC 并不以其直观性而闻名！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-22T08:14:55.617

我解决了这个问题如下：

1.  我在对话框中添加名为 lastItem 的新变量
2.  处理 LVN_ITEMCHANGING 消息并添加以下行：

    ```
    lastItem = pNMLV->iItem; 
    ```

3.  处理 NM_CLICK、NM_DBLCLK、NM_RCLICK 和 NM_RDBLCLK 消息并将这些行添加到所有消息中：

    ```
    CListCtrl * listCtrl = (CListCtrl *)FromHandle(pNMHDR->hwndFrom);
    if (pNMItemActivate->iItem == -1)
        listCtrl->SetItemState(m_lastItem, LVIS_SELECTED, LVIS_SELECTED); 
    ```

# javascript - 添加一个 onclick 函数以转到 JavaScript 中的 url？

> ID：13071967
> 
> 赞同：117
> 
> 时间：2012-10-25T15:26:27.380
> 
> 标签：javascript, jquery, hyperlink

当用户将鼠标悬停在某个字段上时，我正在使用这个花哨的小 JavaScript 来突出显示该字段。您能否告诉我是否有一种方法可以添加一个`onclick`充当链接并转到 URL 的函数？

```
<script>
         $(function() {
            $('tr').hover(function() {
                $(this).css('background-color', '#eee');
                $(this).contents('td').css({'border': '0px solid red', 'border-left': 'none', 'border-right': 'none'});
                $(this).contents('td:first').css('border-left', '0px solid red');
                $(this).contents('td:last').css('border-right', '0px solid red');
            },
            function() {
                $(this).css('background-color', '#FFFFFF');
                $(this).contents('td').css('border', 'none');
                $('a#read_message.php').click(function(){ URL(); });
            });
        });
        </script> 
```

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2012-10-25T15:28:59.367

尝试

```
 window.location = url; 
```

也使用

```
 window.open(url); 
```

如果你想在新窗口中打开。

* * *

## 回答 #2

> 赞同：154
> 
> 时间：2013-07-05T07:54:22.100

只需使用这个

```
onclick="location.href='pageurl.html';" 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2012-10-25T15:31:46.170

在 jquery 中将用户发送到不同的 URL，您可以这样做：

```
$("a#thing_to_click").on('click', function(){
     window.location = "http://www.google.com/";    
}); 
```

这种方式也可以，但以上是这些天更新更正确的方式

```
$("a#thing_to_click").click(function(e){
         e.preventDefault();
         window.location = "http://www.google.com/";    
}); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-10-25T15:30:49.727

```
function URL() {
    location.href = 'http://your.url.here';
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-04-29T13:56:49.823

**HTML**

```
<input type="button" value="My Button" 
onclick="location.href = 'https://myurl'" /> 
```

**MVC**

```
<input type="button" value="My Button" 
onclick="location.href='@Url.Action("MyAction", "MyController", new { id = 1 })'" /> 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2018-06-07T10:21:50.937

如果您想在新标签页中打开链接，您可以：

```
$("a#thing_to_click").on('click',function(){
    window.open('https://yoururl.com', '_blank');
}); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-07-13T08:43:11.400

如果您正在处理`<a>`标签，并且想要中断`href`您应该使用的默认设置`this`。

转到默认网址（雅虎）：

```
<a href="https://yahoo.com" onclick="location.href='https://google.com';"> 
```

转到新网址（谷歌）`onclick`：

```
<a href="https://yahoo.com" onclick="this.href='https://google.com';"> 
```

通过使用`this`您正在中断当前浏览器`onclick`事件并`href`在继续默认行为之前进行更改`<a href='...`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-25T15:32:08.607

不完全确定我理解这个问题，但你的意思是这样的吗？

```
$('#something').click(function() { 
    document.location = 'http://somewhere.com/';
} ); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-16T05:04:15.357

尝试

```
location = url; 
```

```
function url() {
    location = 'https://example.com';
}
```

```
<input type="button" value="Inline" 
onclick="location='https://example.com'" />

<input type="button" value="URL()" 
onclick="url()" />
```

# gcc - psycopg2 安装失败，因为缺少 gcc-4.0，即使 gcc-4.2 可用

> ID：13071971
> 
> 赞同：2
> 
> 时间：2012-10-25T15:26:33.103
> 
> 标签：gcc, psycopg2

对不起这个基本问题。我是新手，我一直在拔头发。

**环境：**

*   Python2.7.3 + Django 1.4 + PostgreSQL 9.2。
*   OSX 10.8.2 + Xcode 4.5.1

**错误：**

我尝试以不同的方式安装 psycopg2：从源代码、easy_install 和 pip。我总是遇到同样的错误：无法执行 gcc-4.0：没有这样的文件或目录 + 错误：命令“gcc-4.0”失败，退出状态为 1

我一开始没有安装 gcc，所以下载了 Xcode 和相关的开发者工具。现在我有 gcc-4.2。这是版本：i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1

但是 psycopg2 一直坚持使用 gcc-4.0，但我（现在）有 4.2。同时，我从其他 Stackoverflow 帖子中注意到，可以使用 gcc-4.2 编译 psycopg2。为了访问 Gcc-4.0，我宁愿不做这些涉及 Xcode3 的不受支持的黑客攻击之一。

**我的问题**：

在安装 psycopg2 时，我可以指定使用 gcc-4.2，而不是 gcc-4.0 吗？Django + PostgreSQL 非常常用，所以肯定有一个简单的方法来解决这个问题吗？非常感谢！！

# php - 如何从 MySQL 表中提取两行，其中一个字段值相同，另一个字段值不同？

> ID：13071977
> 
> 赞同：0
> 
> 时间：2012-10-25T15:26:47.253
> 
> 标签：php, mysql

如果我的问题不太合理，我深表歉意。让我详细解释一下这个场景。

我有一个名为“元素”的 MySQL 表。该表中有两个 MEDIUMINT 字段，一个称为“user_id”，一个称为“element_id”。

我想拉出在表中有一行具有 element_id=8 并且在表中有一行具有 element_id=9 的用户（一次单独检查一个）。

我已经尝试了以下查询，但它不起作用。有任何想法吗？

```
SELECT * FROM elements WHERE user_id=2 AND (element_id=8 AND element_id=9) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:06:16.940

Nanne 的解决方案有效：

```
SELECT * FROM elements as e, elements as ee WHERE e.user_id=2 AND e.element_id=8 AND e.user_id=ee.user_id AND ee.element_id=9 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:29:51.393

这个

> a) “user_id”值为 2 且“element_id”值为 8 的行，以及 b) “user_id”值为 2 且“element_id”值为 9 的行。

翻译成

```
(user_id = 2 AND element_id = 8) OR (user_id = 2 AND element_id = 9) 
```

与（更接近您自己的尝试）相同

```
user_id=2 AND (element_id=8 OR element_id=9) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:52:04.550

根据 Aleks G 的说法，他的建议应该可行。

```
SELECT * FROM elements WHERE user_id=2 AND (element_id=8 OR element_id=9) 
```

应该检索 user_id 等于“2”且 element_id 等于“8”（如果存在）且 element_id 等于“9”（如果存在）的所有行，即使它说“OR”的工作方式类似于“如果结果中存在则包含它”也一样”。

# iphone - 带有 NSURLConnection 的 GCD

> ID：13071978
> 
> 赞同：7
> 
> 时间：2012-10-25T15:26:50.767
> 
> 标签：iphone, ios, objective-c-blocks, grand-central-dispatch

我正在使用异步`GCD`发送请求。`HTTP`这是不起作用的代码：

```
dispatch_async(connectionQueue, ^{
        NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];

        [request setURL:[NSURL URLWithString:[NSString stringWithFormat:someURL]]];

        NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
        [connection start];//Not working
    }); 
```

上面的代码根本不起作用。我在 NSURLConnectionDelegate 的方法中没有收到任何回叫。

但是当我尝试以下代码时，一切正常，我得到了正确的回调

```
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];

[request setURL:[NSURL URLWithString:[NSString stringWithFormat:someURL]]];

NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];

dispatch_async(connectionQueue, ^{

    [connection start]; // working fine. But WHY ????
}); 
```

有人可以解释块/ GCD的这种奇怪行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T19:35:09.410

在代码示例的第一部分尝试这个 -

```
dispatch_async(dispatch_get_main_queue(), ^(void){
    NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
    [connection start];
} 
```

如果您将连接放在后台队列中，它会在队列完成后被推开，因此您不会获得委托回调。连接可以在主队列中，因此它留在主运行循环中以发生回调。或者，您可以创建自己的运行循环，按照其他人的建议为您处理后台操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-07T17:39:22.833

当使用 NSURLConnection 进行异步通信时，您需要让它实例化的线程将连接附加到它的 RunLoop 以便让该线程轮询同一连接的委托方法。

不依赖主线程的 RunLoop 异步实例化 NSURLConnection 的正确方法如下：

```
// Done within a Grand Central Dispatch block, or NSOperation.

// We do not start the connection here because we still need to attach the connection to the RunLoop of the current thread and handle how it will communicate responses back to the caller.   
theConnection = [[NSURLConnection alloc]initWithRequest:request delegate:self startImmediately:NO];

// A previously instantiated NSOperationQueue for managing the delegate callbacks if-and-when they occur.
// [theConnection setDelegateQueue:delegateQueue];
/*
// Other NSURLConnection logic, etc.
*/    
// We start the connection manually after properly establishing how it will poll and respond to events.
[theConnection start];

// This is for the RunLoop of the current thread. (Only needed for < iOS 6 compatibility)
// If this method is executed inside a GCD block or NSOperation, it will be the RunLoop of the thread run in-parallel to the Main Thread.
[[NSRunLoop currentRunLoop] runUntilDate:[NSDate dateWithTimeIntervalSinceNow:30.0]];
// From here, you can alter the time interval to coincide with a specific "time-out" event you'd like to occur. 
```

其中“theConnection”是“NSURLConnection”类型的当前类的成员变量。此外，一旦您的连接收到响应，您将需要创建一个 NSOperationQueue 成员变量来管理委托回调。这些调用将异步传回运行连接的线程。

从那里，您可以使用正确的 NSURLConnection 委托方法返回数据。

为线程使用 Grand Central Dispatch 或 Operation Queues 的好处是已经内置了 Threading 和 RunLoop 机制；您不必手动分配一个带有自己的 RunLoop 的附加线程。这消除了创建后台线程来管理异步服务器调用的两步冗余。

我希望这足以让您走上正确的道路，为您的应用程序创建一个真正的异步网络模型。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T19:48:07.353

NSURLConnection 将始终在创建它的线程（alloc init）上执行数据获取。这解释了为什么它会以第二种方式工作。第一种方法确实有效，但是在您能够从 NSURLConnection 接收任何信息之前，线程就死了。NSURLConnection 已经允许异步下载，但是如果您甚至想异步运行数据处理，您应该使用以下方法：

```
+ (void)sendAsynchronousRequest:(NSURLRequest *)request queue:(NSOperationQueue *)queue completionHandler:(void (^)(NSURLResponse*, NSData*, NSError*))handler 
```

该方法有一些限制，例如身份验证受到限制，并且您无法跟踪迄今为止已下载了多少文档。您还必须指定您创建的 NSOperationQueue，默认队列是主循环队列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-18T22:15:54.393

您可以为该连接启动一个临时的 NSOperationQueue。该队列仅在连接需要时才存在。基本上 NSOperationQueue 确保您通过旋转线程来处理每个委托回调来排队和处理委托回调。（在大多数情况下，当下载新数据或连接失败、连接完成加载等时，相同的后台线程会进入睡眠状态并恢复）。一旦你有了这个队列设置委托回调将开始进入你的应用程序。

```
dispatch_async(connectionQueue, ^{
    connection = [[NSURLConnection alloc] initWithRequest:request delegate:self     startImmediately:NO];
    NSOperationQueue __autoreleasing *tempQueue = [[NSOperationQueue alloc] init];
    [connection setDelegateQueue:tempQueue];
    [connection start];
}); 
```

如果您选择 RunLoop，那么管理 runloop 对您来说是额外的负担。

# jquery - 带有输入数组的 jQuery 验证插件

> ID：13071980
> 
> 赞同：1
> 
> 时间：2012-10-25T15:26:56.117
> 
> 标签：jquery, forms, validation, expressionengine

我目前有一组如下所示的输入：

```
<li class="required">
    <label>First Name</label>
    <input type="text" name="cf_member_address[row_id_52][col_id_19]" value="">
</li>
<li class="required">
    <label>Surname</label>
    <input type="text" name="cf_member_address[row_id_52][col_id_20]" value="">
</li> 
```

我正在使用 jQuery validate 在表单提交之前对其进行验证。我正在尝试向每个项目添加自定义消息，但由于数组（[row_id_52]）我遇到了问题

此外，根据加载的表单，取决于显示的行 ID ([row_id_52]) - 但 Col ID 保持不变。

我该如何声明：

*   一个包含动态数字的数组输入字段？

在我的 JS 文件中？我目前正在这样做：

```
cf_member_first_name: "Please enter your First Name", 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T15:44:04.977

jQuery validate 将允许您使用输入名称以外的选择器添加验证规则，因此避免动态名称问题的一种方法是为每个输入分配一个 css id 或类，并为每个 id 设置验证规则或班级。[http://docs.jquery.com/Plugins/Validation/rules](http://docs.jquery.com/Plugins/Validation/rules)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-27T09:30:47.230

如果您在 ExpressionEngine 上，您可以尝试“ [Forms JS Validation](http://devot-ee.com/add-ons/forms-js-validation) ”来使用 EE 标签验证您的表单。否则，您可以将[验证库](https://github.com/posabsolute/jQuery-Validation-Engine)用作 jQuery 库，它非常适用于输入数组。

# sql-server - 在 INSERT 语句中为表名使用变量

> ID：13071984
> 
> 赞同：0
> 
> 时间：2012-10-25T15:27:05.680
> 
> 标签：sql-server, tsql, stored-procedures, sql-server-2008-r2

> **可能重复：**
> [有没有办法将表名指定为字符串？](https://stackoverflow.com/questions/6877624/is-there-a-way-to-specify-table-name-as-a-string)

以下脚本将无错误地执行：

```
DECLARE @SourceDB sysname, @SourceTable sysname, 
        @UserID NVARCHAR(500), @DMLType CHAR(1), @SourceIdent uniqueidentifier, @ChangedData XML,
        @SQL as NVARCHAR(MAX)

-- xml datatype and its capabilities rock
SELECT  @SourceDB = T.c.query('/AuditMsg/SourceDb').value('.[1]', 'sysname'),
        @SourceTable = T.c.query('/AuditMsg/SourceTable').value('.[1]', 'sysname'),
        @SourceIdent = T.c.query('/AuditMsg/SourceIdent').value('.[1]', 'uniqueidentifier'),
        @UserID = T.c.query('/AuditMsg/UserId').value('.[1]', 'NVARCHAR(50)'),
        @DMLType = T.c.query('/AuditMsg/DMLType').value('.[1]', 'CHAR(1)'),
        @ChangedData = T.c.query('*')
FROM    @msgBody.nodes('/AuditMsg/ChangedData') T(c)

INSERT INTO dbo.AVE_Stamm(SourceDB, SourceIdent, UserID, DMLType, ChangedData)
SELECT @SourceDB, @SourceIdent, @UserID, @DMLType, @ChangedData 
```

但是当我将`INSERT`声明更改为

```
SET @sql = 'INSERT INTO @SourceTable (SELECT @SourceDB, @SourceIdent, @DMLType, @ChangedData, @UserID)';
EXEC (@sql); 
```

它不再起作用了。有人可以帮我吗，这里有什么问题？

我在 SQL Server 2008 R2 的存储过程中使用此脚本。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T15:37:31.910

我认为您需要使用连接将参数值插入到字符串中：

```
SET @sql = 'INSERT INTO ' + @SourceTable + ' SELECT ....';
EXEC (@sql); 
```

或使用[sp_executesql](http://msdn.microsoft.com/en-us/library/ms188001.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T15:57:23.940

```
SET @SQL = 'INSERT INTO '+@SourceTable+' (VALUES '''+@SourceDB+''', '''+
    @SourceIdent+''', '''+@DMLType+''', '''+@ChangedData+''', '''+@UserID+''')'; 
```

将字符串传递到 EXECUTE 后，变量不再在范围内。您需要通过连接值来构建传入的字符串。此外，对于这种类型的 INSERT，VALUES 比 SELECT 更合适。

如果您的 XML 可能包含引号字符，则需要执行以下操作...

```
SET @SQL = 'INSERT INTO '+@SourceTable+' (VALUES '''+@SourceDB+''', '''+
    @SourceIdent+''', '''+@DMLType+''', '''+REPLACE(@ChangedData,'''','''''')+''', '''+@UserID+''')'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T15:37:55.637

您的代码在我看来并不完整，但您应该使用[sp_ExecuteSQL](http://msdn.microsoft.com/en-us/library/ms188001.aspx)并定义语句的参数。有关 sp_ExecuteSQL 的详细信息，请参阅 MSDN。

# f# - 将元组序列写入 csv 文件 f#

> ID：13071986
> 
> 赞同：2
> 
> 时间：2012-10-25T15:27:10.100
> 
> 标签：f#, tuples, export-to-csv

我试图将一个元组序列写入 csv，但正常的 File.WriteAllLines 被一个元组序列重载。

因此，我试图将我的元组扁平化为一系列字符串。

这是我的代码：-

```
open System;;
open Microsoft.FSharp.Reflection;;

let tupleToString (t: string * float) = 
        if FSharpType.IsTuple(t.GetType()) 
        then String.Format("{0},{1}", fst t, snd t)
        else "";;

    let testTuple = ("monkey", 15.168);;

    tupleToString(testTuple);;

let testSeqTuple = [("monkey", 15.168); ("donkey", 12.980)];;

let allIsStrings (t:seq<string * float>) = Seq.collect tupleToString t;;

allIsStrings(testSeqTuple);; 
```

当我只在一个元组上使用“tupleToString”时，结果就很好了。

然而， allIsStrings 的 Seq.collect 部分返回按字符分解的元组。

我也尝试过 Seq.choose 和 Seq.fold，但这些只会抛出错误。

任何人都可以建议我应该使用序列模块中的什么功能 - 或者建议可以在元组上工作的 File.WriteAllLines 的替代方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-25T15:33:30.630

您需要使用`Seq.map`将列表的所有元素转换为`string`然后`Array.ofSeq`获取可以传递给的数组`WriteAllLines`：

```
let allIsStrings (t:seq<string * float>) = 
  t |> Seq.map tupleToString
    |> Array.ofSeq 
```

此外，在您的`tupleToString`函数中，您不需要使用反射来检查参数是否为元组。它总是一个元组，因为这是由类型系统保证的。所以你可以写：

```
let tupleToString (t: string * float) = 
  String.Format("{0},{1}", fst t, snd t) 
```

如果您想对具有任意数量参数的元组进行这项工作，您*可以*使用反射（但这是一个更高级的主题）。以下获取元组的元素，将它们全部转换为字符串，然后使用逗号连接它们：

```
let tupleToString t = 
  if FSharpType.IsTuple(t.GetType()) then
    FSharpValue.GetTupleFields(t)
    |> Array.map string
    |> String.concat ", "
  else failwith "not a tuple!"

// This works with tuples that have any number of elements
tupleToString (1,2,"hi")
tupleToString (1.14,2.24)

// But you can also call it with non-tuple and it fails
tupleToString (new System.Random()) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-25T15:49:24.287

接受的答案要好得多，但我现在已经写了这个，所以在那里。

```
let testSeqTuple = [("monkey", 15.168); ("donkey", 12.980)]

let tupleToString t = String.Format("{0},{1}", fst t, snd t)
let tuplesToStrings t = Array.ofSeq (Seq.map tupleToString t)

for s in tuplesToStrings(testSeqTuple) do
    printfn "s=#%s" s 
```

# c# - bin 文件夹中的两个“.compiled”文件未发布 - 为什么？

> ID：13071994
> 
> 赞同：3
> 
> 时间：2012-10-25T15:27:40.423
> 
> 标签：c#, asp.net

直到上周，我们的构建脚本将编译我们的应用程序（一个运行 MCMS 的非常古老的 .net 2.0 站点）并将其转储到我们的测试服务器上。昨天运行后，站点突然出现各种错误，其中大部分似乎是由于 global.ashx.cs 文件中的方法没有被调用（例如构建缓存等）引起的。

在我找到答案之前提示 5 小时的头发拉扯。

有两个文件：**app_code.compiled**和**app_global.asax.compiled**，直到上周，它们一直与该版本一起部署。现在，他们不是。我将它们从以前的构建中放回，现在该站点按预期运行。

这里没有人声称已经改变了配置......谁能告诉我为什么当我们运行构建时这些重要文件突然没有被发布！？

# 编辑

当我在本地发布时，它会创建文件。然后我使用 TFS 签入和构建，这两个文件没有出现在放置位置。

# 另一个编辑

[http://forums.asp.net/t/1723066.aspx/1](http://forums.asp.net/t/1723066.aspx/1) <--这是正在发生的事情，但那里没有答案。我在这里扯头发，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-29T22:07:07.543

似乎在 TFS/VS 2010 中更改了 ASP.NET 网站的预编译，因为[http://msdn.microsoft.com/en-us/library/399f057w%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/399f057w%28v=vs.85%29.aspx)仅存在对于 VS 2005 和 .NET 3.0。

也许这个答案有助于解决问题：[VS 2010 pre-compile web sites with build process？](https://stackoverflow.com/questions/7560429/vs-2010-pre-compile-web-sites-with-build-process#8391459)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T18:06:28.797

仔细检查，在解决方案中，两个文件的构建操作被标记为“无”以外的东西。

# osgi - 在 ServiceMix 中使用 HAPI XMLParser 时出现 LinkageError

> ID：13071995
> 
> 赞同：1
> 
> 时间：2012-10-25T15:27:42.420
> 
> 标签：osgi, apache-servicemix, hapi

我创建了一个简单的 Camel 路由，带有一个转换器 bean，它使用 HAPI 库将 HL7 消息转换为 XML。该路线在使用“mvn camel:run”运行时有效。当我将（作为 OSGi 包）部署到 ServiceMix 时，当尝试将消息解析为 XML 时，路由会在运行时引发异常：

```
Caused by: java.lang.LinkageError: loader constraint violation: when resolving method "org.apache.xerces.parsers.DOMParser.<init>(Lorg/apache/xerces/xni/parser/XMLParserConfiguration;)V" the class loader (instance of org/apache/felix/framework/ModuleImpl$ModuleClassLoaderJava5) of the current class, ca/uhn/hl7v2/parser/XMLParser, and the class loader (instance of <bootloader>) for resolved class, org/apache/xerces/parsers/DOMParser, have different Class objects for the type org/apache/xerces/xni/parser/XMLParserConfiguration used in the signature
at ca.uhn.hl7v2.parser.XMLParser.<init>(XMLParser.java:108)[194:ca.uhn.hapi.osgi-base:1.2]
at ca.uhn.hl7v2.parser.XMLParser.<init>(XMLParser.java:99)[194:ca.uhn.hapi.osgi-base:1.2]
at ca.uhn.hl7v2.parser.DefaultXMLParser.<init>(DefaultXMLParser.java:77)[194:ca.uhn.hapi.osgi-base:1.2]
at simple.messaging.app.SimpleTransformer.transform(SimpleTransformer.java:26)[223:SimpleMessagingApp2:0.0.1.SNAPSHOT]
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)[:1.6.0_29]
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)[:1.6.0_29]
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)[:1.6.0_29]
at java.lang.reflect.Method.invoke(Method.java:597)[:1.6.0_29]
at org.apache.camel.component.bean.MethodInfo.invoke(MethodInfo.java:329)[89:org.apache.camel.camel-core:2.8.0.fuse-06-11]
at org.apache.camel.component.bean.MethodInfo$1.proceed(MethodInfo.java:231)[89:org.apache.camel.camel-core:2.8.0.fuse-06-11]
at org.apache.camel.component.bean.BeanProcessor.process(BeanProcessor.java:171)[89:org.apache.camel.camel-core:2.8.0.fuse-06-11]
... 43 more 
```

我正在使用安装了 Camel-HL7 功能的 ServiceMix 4.4.2。JDK 1.6u29。用于构建捆绑包的 Apache Felix maven 插件。

SimpleTransformer.java 的第 26 行：

```
XMLParser xmlParser = new DefaultXMLParser(); 
```

XMLParser/DefaultXMLParser 是从 hapi-osgi-base 包中导入的，该包似乎在安装 Camel-HL7 功能时自动部署。hapi-osgi-base 包嵌入了 xercesImpl-2.4.0.jar。