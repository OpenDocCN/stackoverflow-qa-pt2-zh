# StackOverflow 问答 13629000-13629999

# linux - x86-64架构上的gnu汇编RET指令失败

> ID：13629010
> 
> 赞同：1
> 
> 时间：2012-11-29T15:24:21.167
> 
> 标签：linux, assembly, return, x86-64, callstack

以下程序会导致分段故障。该`RET`指令不恢复返回到系统的地址。

使用 gdb 调试会话，我可以读到返回地址不在堆栈上。在第一条指令之前`pushq %rbp`，`%rsp`堆栈指针引用不是返回地址的 0x00000000 地址并导致 SEGMENTATION DEFAULT。

在调试会话中，当我在 _start 标签上设置断点时，要执行的第一条指令不是 Epilogue.... 它是 Prologue。

很明显，系统调用操作没有正确操作堆栈指针，也没有保存返回地址。

我在旧的 32 位平台上没有这个问题。

¿ 一些想法？提前致谢。

gdb 会话：

```
Reading symbols from /home/candido/tutoriales/as_tutorial/examples/basicos_64/nada/ret_fault...done.
(gdb) b _start
Breakpoint 1 at 0x40007c: file ret_fault.s, line 15.
(gdb) run
Starting program: /home/candido/tutoriales/as_tutorial/examples/basicos_64/nada/ret_fault 
(gdb) x /x $rsp
0x7fffffffe068: 0x00000000
(gdb) 
```

作为源代码：

```
###  Simple Prologue Epilogue Module
###  System call don't save the RETURN ADDRESS
###  Assembling: as -gstabs -o ret_fault.o ret_fault.s
###  Linking: ld -o ret_fault ret_fault.o
###  Execution: ./ret_fault
###  System warning:    SEGMENTATION FAULT
###  System platform: Linux lur 3.2.0-33-generic #52-Ubuntu SMP  x86_64 GNU/Linux
    .text           
    .globl  _start      
_start:             
    ## Epilogue
    pushq   %rbp        # save calling frame pointer
    movq    %rsp, %rbp  # set called frame pointer
    ## Prologue
    movl    $0, %eax    # set return value
    popq    %rbp        # restore calling frame pointer
    ret         # return to system. Get return address from stack and load on RIP register.
    .end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:48:15.443

你不能`ret`用来结束一个程序。您可以使用例如。`syscall`：

```
movq $0x60, %rax
xorq %rdi, %rdi
syscall 
```

# openlaszlo - OpenLaszlo 滚动问题

> ID：13629011
> 
> 赞同：1
> 
> 时间：2012-11-29T15:24:25.060
> 
> 标签：openlaszlo, lzx

我有一个如下所述的视图，我正在向内容视图动态添加很多视图，问题是滚动条不可见。所以我深入研究了一下，发现在动态添加视图后内容的高度没有更新。

我在这里做错了什么？相同的代码在 Openlaszlo 3.3 中正常工作

```
<view name="wrapper">
 <view name="scrollablecontainer"
                  width="${this.contentwrapper.width &gt; parent.width
                         ? this.contentwrapper.width : parent.width}"
                  height="${this.contentwrapper.height &gt; parent.height 
                          ? this.contentwrapper.height : parent.height}">
                <view name="contentwrapper" >
                    <view name="contents"/>
                </view>
  </view>
 <vscrollbarnew name="vscroll"
                        height="${this.height}"
                        pagesize="${this.height}"
                        visible="${this.scrollable}"/>
</view> 
```

当组件初始化我将 contentwrapper 的宽度和高度设置为 0 时，我错过了一件事情。

运行时：swf 测试浏览器：firefox、windows xp

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T16:23:56.787

你的结构看起来很复杂。为什么你有一个内容包装器和一个内容视图。我创建了一个在 OpenLaszlo 3.4（swf7 和 swf8）和 OpenLaszlo 5.0 主干（SWF10 和 DHTML）中编译的示例。我已在视图上将剪辑设置为 true，并向`wrapper`视图添加了一个布局，`scrollablecontainer`动态创建的视图将添加到该视图中。

```
<canvas height="400">

    <attribute name="counter" type="number" value="0" />

    <class name="rectangle" width="200" height="30" bgcolor="blue">
        <text name="label" align="center" valign="middle" />
    </class>

    <!-- Wrapping view needs to have a width and height set and clip set to true -->
    <view name="wrapper" x="100" y="10"
          width="236" height="150"
          bgcolor="#ff9999"
          clip="true">

        <view x="10" name="scrollablecontainer"
              bgcolor="#aaaaaa">

            <simplelayout axis="y" spacing="8" />

        </view>

        <vscrollbar name="vscroll"
                    visible="${this.scrollable}"/>
    </view>

    <method name="addView">
        var v = null;
        if ( $swf7 || $swf8 ) {
            v = new rectangle( canvas.wrapper.scrollablecontainer );
        } else {
            v = new lz.rectangle( canvas.wrapper.scrollablecontainer );
        }
        canvas.counter++;
        v.label.setAttribute( 'text', 'View #' + canvas.counter );
    </method>

    <view>
        <checkbox value="true" onvalue="canvas.wrapper.setAttribute('clip', this.value)" />
        <text x="20" >Clipping of view 'wrapper'</text>
    </view>

    <button y="25" text="Add view" onclick="canvas.addView()" />

</canvas> 
```

命名的视图`wrapper`应该启用了裁剪，并且需要为宽度和高度设置一个值。通过单击复选框，您可以切换`clip`包装器的属性值以查看效果。

这是在 OpenLaszlo 5.0 主干 SWF10 中运行的应用程序： ![OpenLaszlo 滚动条和动态视图生成](../Images/0a0b0445632b04aa303607383e5c936d.png)

这里是在 OpenLaszlo 3.4 SWF8 中运行的相同代码： ![在此处输入图像描述](../Images/bb0057e0c5470e32ab609925dcba1a28.png)

# coldfusion - CFWheels 使用 In 查询

> ID：13629015
> 
> 赞同：0
> 
> 时间：2012-11-29T15:24:44.067
> 
> 标签：coldfusion, cfwheels

我有一个简单的值数组（缩写），我需要遍历它们并检查另一个数据库表中的外键。在 MySQL 中，我会使用 IN 子句，但对于 CFWheels 和 MS SQL，我不知道该怎么做。

我首先查询 users 表并获取用户所属的组列表。此信息（不是我做的）以逗号分隔的列表形式存储在 users.groups 列中。然后我需要遍历该列表并从 groups.title 列中获取每个组的标题。我认为它应该类似于下面的代码，但它会出错，有什么想法吗？

此外，如何使用“include”（即 CFWheels 中的连接）将其作为一个查询来完成？

```
user = model("user").findAll(
    select="groups",
    where="userid = '#params.userid#'"
);

// remove trailing comma from list
groups = left(user.groups,len(user.groups)-1);

groups = listToArray(groups);

group_titles = model("groups").findAll(
    select="title",
    where="abbr IN (#groups#)"
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:22:56.603

您需要将列表中的每个值都用单引号括起来，而不是将列表转换为数组。

```
user = model("user").findAll(
  select="groups",
  where="userid='#params.userid#'"
);

group_titles = model("groups").findAll(
  select="title",
  where="abbr IN (#ListQualify(groups, "'")#)"
); 
```

在 CFWheels ORM 查询中，您需要用单引号将字符串括起来，或者如果您传入数字或布尔值，则将引号留在外面。

# jsf - 检查记住我的cookie后如何“自动登录”用户？

> ID：13629020
> 
> 赞同：2
> 
> 时间：2012-11-29T15:24:51.837
> 
> 标签：jsf, login, remember-me

我需要在我的 JSF 网站上实现“记住我”功能，我一直在研究这个主题，试图找到最佳实践。我找到了很多答案，但我仍然有一个基于我使用的技术和我在数据库中存储用户密码的方式的问题。

**总结我的发现**

*   创建一个包含用户和难以猜测的长序列的数据库表。
*   当用户在选中记住我选项的情况下登录时，在 db 表上生成一个注册表并向用户发送一个包含用户名和序列号的 cookie。
*   如果同一用户未登录，并且根据数据库具有有效的 cookie，则**自动登录**该用户。

**我如何实际登录用户**

基于 Java EE 标准，我使用 JAAS 并存储用户密码的 MD5 版本。我通过 HttpServletRequest 类的 login 方法登录我的用户，该方法需要**用户名和密码**才能验证身份验证并设置用户主体。

* * *

基于这两个事实，如果我需要用户名和密码才能登录用户，如何根据此最佳实践进行自动登录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:01:37.183

> *如果我需要用户名和密码才能登录用户，如何根据此最佳实践进行自动登录？*

只需根据“记住我”cookie 的值直接从数据库中获取用户名和密码。然后您可以将它们提供给该`HttpServletRequest#login()`方法。

请注意，“记住我”cookie 的值绝对不应包含有关用户名、密码或 ID 的任何提示。它应该是一个绝对随机的值。在`java.util.UUID`这里很有帮助。

### 也可以看看：

*   [登录后自动登录 JSF 应用程序](https://stackoverflow.com/questions/9810224/automatic-login-to-jsf-application-on-revisits-after-once-logged-in)

# javascript - 响应式图像映射 - 不会比原始图像大小缩放

> ID：13629021
> 
> 赞同：1
> 
> 时间：2012-11-29T15:24:52.803
> 
> 标签：javascript, jquery, html, jquery-plugins

我正在尝试找到一种方法来创建响应式图像映射。现在我正在尝试使用这个 jquery 插件（[https://github.com/stowball/jQuery-rwdImageMaps](https://github.com/stowball/jQuery-rwdImageMaps)）

问题是（据我所知）-我无法将图像显示为宽度：100%-

因此，例如，如果我的图像宽度是 1200 像素，而我的屏幕是 1500 像素 - 将会有一个 300 像素的空白空间，图像不会被填充。但是，它将按比例缩小。它只是不会按比例放大（超出原始尺寸）以适应 100% 的大型显示器。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T16:28:38.100

除了更改 JS，您还可以像这样在 CSS 中定位 img：

```
img[usemap] {
    width:100% !important;
    max-width: none !important;
    height: auto !important;
} 
```

# eclipse - 如何确保更改集保留在 Eclipse 中

> ID：13629025
> 
> 赞同：3
> 
> 时间：2012-11-29T15:24:56.450
> 
> 标签：eclipse

更改集对于组织未签入的更改非常有用，但是当创建更改集时，它不会立即持久化，这意味着如果 Eclipse 稍后死掉（有时它必须被杀死，因为某些操作不会完成并且它不会't respond to cancel)，新创建的变更集丢失，很烦人。那么有没有办法确保保存新创建的更改集？或者，是否有更安全的方法来组织未在 Eclipse 中签入源代码控制的更改？

# javascript - 在移动浏览器上缩放或滚动

> ID：13629028
> 
> 赞同：4
> 
> 时间：2012-11-29T15:25:05.843
> 
> 标签：javascript, android, html, dom-events, pinchzoom

在桌面浏览器中，我通过标准鼠标滚轮或 DOMMouseScroll 事件检测鼠标滚轮的使用。因此，我可以更改画布（放大一种地图）。

现在我想把这个功能带给我的移动用户：我需要拦截标准的捏缩放手势（不缩放页面）。今天可能吗？是否可以获得手势的中心（用于本地化缩放和取消缩放）？

请注意，它需要在 Android 4.2 的标准浏览器上运行。其他浏览器/设备不在此问题的范围内，这可能会使其更容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:43:05.193

这似乎[固定在 3.0 上](http://code.google.com/p/android/issues/detail?id=11909)。这是一个似乎可以在我的 ICS 平板电脑上运行[的测试页面。](http://www.snappymaria.com/misc/TouchEventTest_v2.html)这是链接测试页面的摘录：

```
// Touch events seem to work in iOS, Android browser 3.0 and up,
// and various 3rd-party Android browsers, now including FireFox
// (Nightly as of 03-Feb-2012, not enabled by default yet).
eventTarget.addEventListener('touchstart', HandleTouchStart, false);
document.addEventListener('touchmove', HandleTouchMove, false);
document.addEventListener('touchend', HandleTouchEnd, false);
document.addEventListener('touchcancel', HandleTouchCancel, false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:05:29.350

这个问题有一个指向可能有用的库（Hammer.js）的答案：[How to detect android pinch zoom in javascript](https://stackoverflow.com/questions/11517086/how-to-detect-android-pinch-zoom-in-javascript/11517102#11517102)

# git - 如何形成正确的 git clone 路径？

> ID：13629036
> 
> 赞同：0
> 
> 时间：2012-11-29T15:25:34.523
> 
> 标签：git, url, version-control, git-clone

我创建了一个远程 Git 存储库，现在我正在尝试使用 Sourcetree 将它克隆到另一台计算机上。但是，每次我在“源路径/URL”字段中输入内容时，都会出现一个错误，提示“这不是有效的源路径/URL”。这是我迄今为止尝试过的：

*   “git://12.345.678.90/”
*   “git://12.345.678.90/.git/”
*   “http://12.345.678.90/.git/”
*   “http://12.345.678.90/”
*   “ftp://12.345.678.90/”
*   “ftp://12.345.678.90/.git/”
*   “rsync://12.345.678.90/”
*   “rsync://12.345.678.90/.git/”

我一直在使用[Git 文档](http://git-scm.com/docs/git-clone)和通过搜索谷歌找到的东西。我注意到的一件事是，很多人的克隆 URL 看起来类似于以下之一：

*   12.345.678.90/path/to/repo.git
*   ssh://12.345.678.90/path/to/repo.git

主存储库所在的服务器不支持 SSH。此外，存储库位于网站的根文件夹（不是服务器的根文件夹）中。另一件事是我的存储库没有名称。当我在文件资源管理器（它是一个 Windows 服务器）中查看它时，它只是被列为“.git”。

**注意 1：**我使用的所有 URL，我使用的都是不带引号的。当我第一次输入它时，它会自动将其中的一半转换为链接。

**注意 2：**为了保护隐私，我使用占位符 IP 地址代替真实的 IP 地址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:06:45.237

由于您的 Web 服务器可能未设置为使用 git 的智能 HTTP 协议提供访问权限，因此 git 将需要使用较旧、较慢的哑 HTTP 协议。这也意味着您需要`git update-server-info`在每次更新后在存储库上运行，以便客户端可以使用这些更新。第一次不这样做可能是您的 http URL 都不起作用的原因。

我还建议给存储库一个名称，将`.git`目录重命名为`something.git`. 此时，您应该能够使用`http://12.345.678.90/something`克隆存储库。没有名称的存储库是非常不寻常的，并且可能会导致混乱。如果需要，这也将使将来添加其他存储库变得更加容易。

# visual-c++ - 使用 MXXMLWriter 将 XML 文档输出为字符串

> ID：13629037
> 
> 赞同：0
> 
> 时间：2012-11-29T15:25:38.587
> 
> 标签：visual-c++, atl, msxml

我正在尝试将格式化的 XML 文档从 DOM 对象输出到字符串中，如下面的代码所示。问题是，虽然 dom->get_xml() 方法确实返回了一个值，但 MXXMLWriter->output 没有，正如您在屏幕截图中看到的那样。所有方法调用都返回 S_OK。这里可能是什么问题？

这是我的代码：

```
CComPtr<IMXWriter> w;
HRESULT hr;
hr = w.CoCreateInstance(__uuidof(MXXMLWriter), NULL, CLSCTX_INPROC_SERVER);

hr = w->put_indent(VARIANT_TRUE);

CComPtr<ISAXXMLReader> rd;
hr = rd.CoCreateInstance(__uuidof(SAXXMLReader60), NULL, CLSCTX_INPROC_SERVER);

CComPtr<ISAXContentHandler> hc;
hr = w.QueryInterface<ISAXContentHandler>(&hc);
CComPtr<ISAXErrorHandler> he;
hr = w.QueryInterface<ISAXErrorHandler>(&he);
CComPtr<ISAXDTDHandler> hd;
hr = w.QueryInterface<ISAXDTDHandler>(&hd);

hr = rd->putContentHandler(hc);
hr = rd->putErrorHandler(he);
hr = rd->putDTDHandler(hd);
hr = rd->putProperty(L"http://xml.org/sax/properties/lexical-handler", CComVariant(w));
hr = rd->putProperty(L"http://xml.org/sax/properties/declaration-handler", CComVariant(w));

BSTR body = ::SysAllocStringLen(NULL, 1024);
ZeroMemory(body, 1024 * sizeof(OLECHAR));
CComVariant out(body);
w->put_encoding(CComBSTR(L"utf-8"));
hr = w->put_output(out);
hr = rd->parse(CComVariant(dom));

dom->get_xml(&xmlStr);

return std::wstring(xmlStr); 
```

![在此处输入图像描述](../Images/06d284fc3600bde95afc01a5c4b20954.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T07:56:24.247

该文件指出

输出可以是：

> *   IStream 接口的任何实现。（生成的文档将写入提供的 IStream）。
> *   一个字符串。
> *   一个 DOMDocument 对象。
> 
> 有关将输出属性设置为 DOMDocument 对象的更多信息，请参阅从 SAX 事件创建 DOMDocument 对象。
> 
> 将此属性设置为空值（VT_EMPTY 或“”）会将输出返回到内部字符串并重置它

您显然希望作者填写字符串。因此建议使用空字符串来指示 writer 填充其内部缓冲区，然后您可以通过属性 getter 获取它。

相反，您尝试提供自己的缓冲区来填充，这是编写器的广告行为。

# php - 搜索引擎友好的 URL，但不应将 URL 插入数据库中

> ID：13629043
> 
> 赞同：0
> 
> 时间：2012-11-29T15:25:51.743
> 
> 标签：php, joomla, sef, joomla-sef-urls

我有一个搜索页面，我想要一个 SEF URL，但我不想将它插入数据库。例如。www.abc.com/facility-search/types/state/city/

www.abc.com/facility-search/school/california/los-angeles/ 或 www.abc.com/facility-search/school+hospital/california/los-angeles/ 其中类型使用“+”分隔

有成千上万的组合，所以我不想在数据库中索引它们有没有办法在没有 SH404SEF 将它们插入数据库的情况下做到这一点？

我希望能够将 url 粘贴到浏览器，然后只解析设施搜索之后的任何内容。（我不会有一个带参数的等效 url）

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:36:24.400

当然。您可以`.htaccess`用于`QSA`查询附加字符串。因此，在您给定的示例中，这将类似于：

```
RewriteRule ^facility-search/(.*)$ index.php?search=$1 [QSA,L] 
```

你可以在你的 php 中捕获它以执行操作将它们剥离或其他任何东西，因此将其捕获为：

```
$pathArray = explode('/', $_GET['rt']); 
```

现在你爆炸了它，你可以用它做任何你喜欢的事情。url:`www.abc.com/facility-search/school/california/los-angeles/`将给出以下输出

```
$pathArray[0]; // returns 'school'
$pathArray[1]; // returns 'california'
$pathArray[2]; // returns 'los-angeles' 
```

我希望你理解这个概念。

# jquery - 在加载时显示特定幻灯片，暂停然后滚动所有幻灯片并从 Timeline.js 开始

> ID：13629044
> 
> 赞同：1
> 
> 时间：2012-11-29T15:25:53.330
> 
> 标签：jquery, json, wordpress, jquery-plugins

我正在建立一个公司网站，其中一个部分是“历史”页面。我正在使用[Timeline JS](http://timeline.verite.co/)来做到这一点。通过从我的 Wordpress 安装中提取 JSON 提要，我已经非常成功地使其工作；但是，有一件事我无法弄清楚。我的客户想要显示“封面图片”并说：“探索我们的历史”，等待几秒钟，然后让时间线自动滚动到公司历史开始时的第一张幻灯片。

我在[文档](https://github.com/VeriteCo/TimelineJS)中读到我可以指定一张开始幻灯片，我可以让时间线从最后开始，但是我需要编写某种回调函数，它在我想要的幻灯片上开始后运行。我想我可以在 start_at_slide 选项中做到这一点，但我不知道如何去做：

```
var timeline_config = {
  width: "100%",
  height: "580",
  source: "/plugins/timeline/timeline.json",
  start_at_slide: $(function(){
     // some code that says, start at the last slide, delay and then scroll to slide 1
  });,
  hash_bookmark: true,
  start_zoom_adjust: "2",
  css: "/plugins/timeline/css/themes/font/Helvetica.css"
} 
```

另一种选择可能是在timeline_config之外编写一个单独的函数来覆盖正常行为，但在我进入那个兔子洞之前，我想看看你们是否有任何建议。

一旦我启动并运行它，我计划将它作为一个 Wordpress 插件发布，因为 TimelineJS 和 Wordpress 的选项不太理想。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:38:02.107

利用

```
this.setSlide = function(n) {
        goToSlide(n);
    }; 
```

在***/complied/js/timeline.js***上， 我只是查看了 js 文件，我认为操纵它可以解决问题。明天有空的时候，我会尽力做你想做的。

# node.js - 节点 - 视图中的everyauth.user 助手未定义？

> ID：13629045
> 
> 赞同：1
> 
> 时间：2012-11-29T15:25:54.983
> 
> 标签：node.js, mongodb, express, helper, everyauth

嘿，我正在尝试将 findUserById 配置为在视图中使用 everyauth.user 辅助方法。

这是我的配置：

```
everyauth.everymodule.userPkey('_id');

everyauth.everymodule.findUserById( function (userId, callback) {
  dbManager.findById('brands', userId, function(error, brand) { 
    console.log(brand)
    if (error) return callback(error);
    callback(null, brand);
  });
}); 
```

console.log(brand) 给了我：

```
{ fbID: '507246960',
  brandName: '',
  email: 'alexfoxy@gmail.com',
  created_at: Thu Nov 29 2012 11:01:53 GMT+0000 (GMT),
  comments: [],
  _id: 50b740a1b47637ac54000001 } 
```

所以我知道数据库正在返回用户，但是视图中的 #{everyauth.user.email} 给了我错误：

无法读取未定义的属性“名称”所以它仍然未定义？！

# c++ - C++ 通用数据结构 - 数据字段赋值运算符 vs 复制 c'tor

> ID：13629049
> 
> 赞同：-2
> 
> 时间：2012-11-29T15:26:08.850
> 
> 标签：c++, templates, generics, constructor, variable-assignment

在通用结构中使用赋值运算符而不是复制 c'tor 是否被认为是错误的编码？或者这无关紧要，因为也许人们普遍认为，如果某个数据类型有一个特殊的 c'tor，那么也应该有一个适当的赋值运算符？

例如，如果我正在制作自己的通用链表，使用模板和 DATA 数据；每个节点内的字段。所以问题是，如果在我的列表代码的某个地方，我可以在两个 DATA 变量之间使用赋值运算符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:37:29.190

> 在通用结构中使用赋值运算符而不是复制 c'tor 是否被认为是错误的编码？

这个问题是笼统的，所以我的回答也是笼统的。

不，使用赋值运算符本身并不是不好的编码。像任何事情一样，它可能会被误用或不正确地实现，但作为一个概念，使用赋值运算符并没有错。这就是他们的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:41:19.813

> 例如，如果我正在制作自己的通用链表，使用模板和 DATA 数据；每个节点内的字段。所以问题是，如果在我的列表代码的某个地方，我可以在两个 DATA 变量之间使用赋值运算符。

在此示例中，两者都不使用，使用`swap`. 这更快且异常安全。

```
using std::swap;
swap(old, new); 
```

如果使用赋值运算符，首先会创建一个副本，然后调用析构函数。

如果使用复制构造函数，则调用两个析构函数和一个复制构造函数。

如果使用交换，则`swap`调用一对一的析构函数。`swap`通常很便宜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T15:42:26.490

赋值运算符和复制构造函数和两个不同的东西虽然具有相似的功能。至于它是否被认为是一种不良做法的问题，通常这样做并不是一个坏主意。它的优点是几乎可以在程序中的任何时间从任何地方调用它。复制构造函数通常只在对象初始化时调用。

赋值运算符有时会导致非常危险的情况。程序员负责检查某些条件，例如自赋值。在这里，如果是您的链表，您还必须销毁对象在新分配之前确实持有的前一个列表。

我希望这是你想问的。

# c# - .NET 事件引发和 NullObject 模式

> ID：13629051
> 
> 赞同：6
> 
> 时间：2012-11-29T15:26:10.950
> 
> 标签：c#, .net, events, design-patterns

我们可以通过两种方式引发事件：

```
public event EventHandler MyEvent;

private void DoSomething()
{
    ...
    var handler = MyEvent;
    if (handler != null)
        handler(this,EventArgs.Empty);
} 
```

和

```
public event EventHandler MyEvent = (o,e) => {} ;

private void DoSomething()
{
    ...
    MyEvent(this, EventArgs.Empty);
} 
```

我更喜欢最后一个。它更短。
我的同事坚持第一个变体。

**第一个比第二个有什么优势吗？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T15:40:58.717

**C# 6 的更新**

在 C# 6 中，您只需像这样使用空条件运算符：

```
PropertyChanged?.Invoke(this, args); 
```

这是[Roslyn wiki 推荐的](https://github.com/dotnet/roslyn/wiki/New-Language-Features-in-C%23-6#null-conditional-operators)

**原始答案**

Eric Lippert 有[一篇很棒的关于 Events and Races 的博文](http://blogs.msdn.com/b/ericlippert/archive/2009/04/29/events-and-races.aspx)，如果你还没有的话，你应该阅读一下。

第一个选项可能被认为比第二个更安全，因为事件可能会被设置为 null。有人可能会不小心修改类。此外，如果您反序列化实例，则第二种方法将不起作用（取决于您使用的序列化机制）。

我有时使用辅助方法来引发事件

```
static class Raiser
{
    public static void Raise<T>(this EventHandler<T> evnt, object sender, T args)
        where T : EventArgs
    {
        if (evnt != null)
        {
            evnt(sender, args);
        }
    }
}

class SomeClass
{
    public event EventHandler<EventArgs> MyEvent;

    private void DoSomething()
    {
        MyEvent.Raise(this, EventArgs.Empty);
    }
} 
```

# python - 基于值是否在其他列表中的 Numpy 掩码

> ID：13629061
> 
> 赞同：16
> 
> 时间：2012-11-29T15:26:42.783
> 
> 标签：python, numpy

我已经搜索了高低，但找不到方法（可能我正在搜索错误的术语。）

我想根据每个值是否在其他列表中创建一个掩码（例如 [True False False True True]）。

```
a=np.array([11,12,13,14,15,16,17])
mask= a in [14,16,8] #(this doesnt work at all!)
#I would like to see [False False False True False True False] 
```

到目前为止，我能想到的最好的方法是列表理解

```
mask = [True if x in other_list else False for x in my_numpy_array] 
```

如果你知道一些秘诀可以用 numpy 和快速（计算）做到这一点，请告诉我，因为这个列表实际上是巨大的......

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-29T15:29:29.993

使用[`numpy.in1d()`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.in1d.html#numpy.in1d)：

```
In [6]: np.in1d(a, [14, 16, 18])
Out[6]: array([False, False, False,  True, False,  True, False], dtype=bool) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-01-12T10:35:08.330

接受的答案是正确的，但目前`numpy`的文档建议使用[`isin`函数](https://docs.scipy.org/doc/numpy/reference/generated/numpy.isin.html)而不是`in1d`

# android - 如何克隆 Parcel 对象

> ID：13629063
> 
> 赞同：2
> 
> 时间：2012-11-29T15:26:42.737
> 
> 标签：android, clone, parcelable, cloneable, parcel

我想克隆一个 Parcel 对象（不可打包）。

我不能使用 clone() 方法，因为它受到保护。我也不能使用反射来调用它，因为 Parcel 类没有实现“可克隆”

我尝试执行问题的解决方案： [创建包裹对象的副本，](https://stackoverflow.com/questions/7467761/create-a-copy-of-parcel-object) 但它不适用于包裹类型本身 - 原因是没有为包裹类型本身定义“writeToParcel”。所以对于对象'Parcel a'，a.writeToParcel(parcel, 0) 不会编译。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-06T01:43:23.613

利用`Parcel.appendFrom()`

这比编组和解组更有效，并且不会丢失有关对象引用或`FileDescriptor`包裹中的任何数据。

资料来源：无意中听到 Android 框架开发人员谈论这个，并决定更新 Stackoverflow 问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-06-30T13:03:22.963

你可以通过编组/解组来做到这一点

```
byte[] rawData = original.marshall();
Parcel clone = Parcel.obtain();
clone.unmarshall(rawData, 0, rawData.length);
clone.setDataPosition(original.dataPosition()); 
```

但它不适用于所有包裹。我认为它在带有活动对象的 Parcels 上失败了，但我还没有测试过以确定。

# api - 视图是否应该在 RESTful API 中使用

> ID：13629065
> 
> 赞同：3
> 
> 时间：2012-11-29T15:26:48.020
> 
> 标签：api, rest

我想这与 API 的最佳实践有关。我正在考虑实现 API，但不确定是否需要在 API 设计中使用视图或将它们留给用户的前端实现。我认为在 API 中实现视图不是一个好主意，但如果知道通常会做什么，那就太好了。我认为 API 调用应该总是返回 JSON 或 XML；添加视图会使一切复杂化...

您是否在 API 中使用视图，是/否，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:44:20.437

API 代表应用程序编程接口。它是您的应用程序公开的东西，可以调用它与之交互。REST 是一种哲学，它不会告诉您如何设计应用程序，它只是定义了一种通信结构（资源、表示、动词、名词）。

视图不是 REST 中的概念，但在最常见的情况下，视图将是 REST 中资源的表示。虽然这种视图表示可以由服务器直接返回，但大多数开发人员更喜欢只返回数据并分离可视化。

如果您的 API 返回 HTML，这不会违反 REST，但会在用户界面和应用程序数据之间引入耦合。我建议您不要这样做，不是因为 REST，而是因为您违反了基本的软件设计原则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:35:26.973

对于我的 REST API，只有 JSON 数据。在 REST API 中，您必须返回 JSON 或 XML，因为您的 API 需要独立于前端实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T15:54:41.163

您建议的视图只是 html 类型的视图。但是视图也可以是 json、xml 等许多其他类型。

视图是资源的表示。是您导出应用程序处理的数据的方式。

这样想，你会注意到even和api项目都可以使用MVC。

有几个 gem 可以处理 api 项目上的视图，例如：[rabl](https://github.com/nesquena/rabl)和[active_model_serializers](https://github.com/rails-api/active_model_serializers)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T15:55:38.263

答案是肯定的和否定的。输出简单机器可解析格式（XML、JSON、CSV）的 REST API 不需要视图，但它可以帮助 API 用户，如果他们可以看到人类可读格式的输出，那么他们可以使用它来验证输出他们的应用程序使用 REST API。如果您通过处理模型中的数据处理来最大程度地减少代码重复，并且您有单独的 JSON/XML REST API 视图和另一个供人类使用的视图，这也是一个有效的选项。在这种情况下，“视图”将模型创建/检索的对象转换为各种输出格式，以提供给各种消费者——人类和程序。

# symfony - Doctrine2 批量更新失败并出现致命的内存错误。“订购”有问题吗？

> ID：13629071
> 
> 赞同：1
> 
> 时间：2012-11-29T15:27:23.137
> 
> 标签：symfony, batch-file, doctrine-orm

我尝试按照[http://docs.doctrine-project.org/en/2.0.x/reference/batch-processing.html#iterating-results编写批量更新片段](http://docs.doctrine-project.org/en/2.0.x/reference/batch-processing.html#iterating-results)

我使用框架 symfony2 并尝试迭代大约一百万行以使用 gedmo 学说 2 扩展更新我的“slug”列。

**我最终得到的代码：**

```
$this->container->get('profiler')->disable(); // should disable logging and profiler
$batchSize = 20;
$i = 0;
$q = $em->createQuery('select a from ACMEArtistBundle:Artist a order by a.touch ASC')
        ->setMaxResults(40); // a.touch is a DateTime Column
$q->setHint(Query::HINT_FORCE_PARTIAL_LOAD, true); // some tipp i read somewhere
$iterableResult = $q->iterate();
while (($row = $iterableResult->next()) !== false) {
    $row[0]->setSlug('');
    if (($i % $batchSize) == 0) {
        $em->flush(); // Executes all deletions.
        $em->clear(); // Detaches all objects from Doctrine!
    }
    ++$i;
} 
```

**如果我以 256 内存大小运行此代码**，我会收到此错误：/symfony2_installation/vendor/doctrine/orm/lib/Doctrine/ORM/Internal/Hydration/ArrayHydrator 中允许的内存大小为 268435456 字节已用尽（尝试分配 72 字节） .php 在第 230 行

**如果我以 512 内存大小运行此代码，**则会出现此错误并出现空白屏幕：324 (net::ERR_EMPTY_RESPONSE)

事实证明，通过在我的 SQL 中删除“order by a.touch ASC”，它一次可以很好地处理 2000 多个条目。

#doctrine 中的一个人提到一对一的关系（自我引用）可能是一个问题？但删除这种关系并没有解决它。

**问题：** 我该如何管理它？我只需要更新表中最旧的条目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:09:26.933

哦，伙计，我查看了 /app/logs/dev.log 并执行了语句 sql。我发现第一行（在名称列中）有一些中文标志。

我删除了条目，现在脚本继续工作......似乎是字符集的问题。该表是utf8 ...我想知道我必须在数据库连接中更改这个字符集的位置吗？

# c++ - 访问被拒绝错误

> ID：13629075
> 
> 赞同：-1
> 
> 时间：2012-11-29T15:27:30.647
> 
> 标签：c++

我在这里将字符串转换为类复杂的代码...

```
void StrtoComplex(char *temp)
    {
        int i;

        for(i = 0; i < strlen(temp); i++)
        {
            if(temp[i] == 'j' || temp[i] == 'i')
                break;
        }

        real = atof(temp);//takes till the last valid char so after + or whitespace it ignores
        imag = atof(temp + i + 1);

        sprintf(complexStr, "%f +j%f", real, imag);
    } 
```

它可以编译，但是在运行时它会执行所有语句（具有正确的值....complexStr 也有正确的字符串...），然后返回 sprintf 语句并说拒绝访问

好的，这是其余的代码....

```
#include <iostream>
#include <conio.h>
#include <string.h>

#include <cstdlib>
#include <cctype>
#include <cstring>

//Most string operations require the std namespace
using namespace std;

//namespace helps divide global access into subaccess blocks providing data encapsulation
//If required to use any defined within a namespace use scope resolution
namespace Complex
{
    /*This is the Complex class which is asscociated with its corresponding string holding
    the complex representation
    DATA MEMBERS:
    real --------- real part of the complex number
    imag --------- imaginary part of the complex number
    complexstr --- string stream which holds the complex representation
    MEMBER FUNCTIONS
    */
    class complex
    {
        double real;
        double imag;
        char complexStr[50];

    public:
        complex(double re = 0, double im = 0)
        {
            real = re;
            imag = im;
            sprintf(complexStr, "%f +j%f",real,imag);
        }

        complex(complex &t)
        {
            real = t.real;
            imag = t.imag;
        }

        void StrtoComplex(char *temp)
        {
            int i;

            for(i = 0; i < strlen(temp); i++)
            {
                if(temp[i] == 'j' || temp[i] == 'i')
                    break;
            }

            real = atof(temp);//takes till the last valid char so after + or whitespace it ignores
            imag = atof(temp + i + 1);

            sprintf(complexStr, "%f +j%f", real, imag);
        }

        friend complex operator+(complex &a, complex &b);
        friend complex operator-(complex &a, complex &b);
        friend complex operator-(complex &a);
        friend complex operator*(complex &a, complex &b);
        friend complex operator/(complex &a, complex &b);
        friend ostream &operator<<(ostream &s, complex &t);
        friend istream &operator>>(istream &s, complex &t);
    };

    //overloading + to add complex numbers
    complex operator +(complex &a, complex &b)
    {
        complex t;
        t.real = a.real + b.real;
        t.imag = a.imag + b.imag;
        sprintf(t.complexStr, "%f +j%f", t.real, t.imag);
        return(t);
    }
    //overaloading - to subtract 2 complex no's
    complex operator -(complex &a, complex &b)
    {
        complex t;
        t.real = a.real - b.real;
        t.imag = a.imag - b.imag;
        sprintf(t.complexStr, "%f +j%f", t.real, t.imag);
        return(t);
    }

    //overloading unary -
    complex operator -(complex &a)
    {
        complex t(-a.real, -a.imag);
        sprintf(t.complexStr, "%f +j%f", t.real, t.imag);
        return(t);
    }

    //overloading * to multiply 2 complex no's
    complex operator *(complex &a, complex &b)
    {
        complex t;
        t.real = (a.real*b.real) - (a.imag*b.imag);
        t.imag = (a.real*b.imag) + (a.imag*b.real);
        sprintf(t.complexStr, "%f +j%f", t.real, t.imag);
        return(t);
    }
    //overloading / to divide 2 complex no's
    complex operator /(complex &a, complex &b)
    {
        complex t;
        t.real = ((a.real*b.real) + (a.imag*b.imag))/(b.real*b.real + b.imag*b.imag);
        t.imag = ((a.real*b.imag) - (a.imag*b.real))/(b.real*b.real + b.imag*b.imag);
        sprintf(t.complexStr, "%f +j%f", t.real, t.imag);
        return(t);
    }

    ostream &operator<<(ostream &s, complex &t)
    {
        s<<t.complexStr;
        return s;
    }

    istream &operator>>(istream &s, complex &t)
    {
        char *temp;

        s>>temp;
        t.StrtoComplex(temp);
        return s;
    }
}

namespace Discrete
{
    using Complex::complex;
    class signal
    {
        complex *sig_Data;

        int range_start, range_end, zero_pt;

    public:
        signal()
        {
            sig_Data = NULL;
            range_start = range_end = zero_pt = 0;
        }

        signal(complex i)
        {
            sig_Data = new complex(i);
            range_start = range_end = zero_pt = 0;
        }

        signal(int r_start, int r_end, int z_pt)
        {
            range_start = r_start;
            range_end = r_end;
            zero_pt = z_pt;
            int arr_ind = r_end - r_start;

            sig_Data = new complex [arr_ind];
        }

        signal(signal &s)
        {
            sig_Data = s.sig_Data;
            range_start = s.range_start;
            range_end = s.range_end;
            zero_pt = s.zero_pt;
        }

        void StrtoSig(char *temp)
        {
            int arr_ind = 0;
            char *tok;

            if(!*temp) return;

            tok = temp;
            zero_pt = 0;
            //
            int flag;

            for(int i = 0; i < (flag = strlen(temp)); i++)
            {
                tok++;
                if(*tok == '^') zero_pt = arr_ind;
                if(*tok == ',') arr_ind++;
            }
            range_start = 0 - zero_pt;
            range_end = arr_ind - zero_pt;

            sig_Data = new complex [arr_ind];
            tok = temp+1;
            for(int i = 0; i <= arr_ind; i++)
            {
                if(*tok == '^') tok++;
                sig_Data[i].StrtoComplex(tok);
                while(*tok != ',' || *tok != '}'|| *tok != '\0') tok++;
            }
        }

        complex operator[](int i)
        {
            if(i >= range_start && i <= range_end) return sig_Data[zero_pt+i];
            else return complex(0);
        }

        void timeScale(float t)
        { 
            if(t!=0)
            {
                int range = abs((int)((range_end - range_start)/t));
                int flag = 0;
                complex *sig=new complex[range];
                for(int i = 0; i < range; i++)
                {   
                    if(((long)(range_start + i)/t) == (range_start + i)/t)
                        sig[flag++] = sig_Data[i];
                }
                sig_Data = sig;
                range_start = (range_start)/t;
                range_end = (range_end)/t;
                zero_pt = (zero_pt)/t;
            }
            else
            {
                cout<<"time scaling not possible. Scaling factor is invalid.";
                return;
            }
        }

        //time shifting function
        void timeShift(int i)
        {
            if(i != 0)
            { 
                range_start -= i; 
                range_end -= i;
                zero_pt += i;
            }
            return;
        }

        friend signal operator+(signal &a, signal &b);
        friend signal operator-(signal &a, signal &b);
        friend signal operator-(signal &a);
        friend signal operator*(signal &a, signal &b);

        friend ostream &operator<<(ostream &s, signal &t);
        friend istream &operator>>(istream &s, signal &t);
    };

    //Overloading + operator
    signal operator+(signal &a, signal &b)
    {
        int r_start = min(a.range_start, b.range_start);
        int r_end = max(a.range_end, b.range_end);
        int z_pt = max(a.zero_pt, b.zero_pt);
        signal temp(r_start, r_end, z_pt);
        for(int i = r_start; i < r_end; i++)
        {
            temp[i] = a[i] + b[i];
        }
        return temp;
    }

    //Overloading - operator
    signal operator-(signal &a, signal &b)
    {
        int r_start = min(a.range_start, b.range_start);
        int r_end = max(a.range_end, b.range_end);
        int z_pt = max(a.zero_pt, b.zero_pt);
        signal temp(r_start, r_end, z_pt);
        for(int i = r_start; i < r_end; i++)
        {
            temp[i] = a[i] - b[i];
        }
        return temp;
    }

    //Overloading unary- operator
    signal operator-(signal &a)
    {
        signal temp = a;
        for(int i = a.range_start; i < a.range_end; i++)
        {
            temp[i] = -a[i];
        }
        return temp;
    }

    //Overloading * operator
    signal operator*(signal &a, signal &b)
    {
        int r_start = min(a.range_start, b.range_start);
        int r_end = max(a.range_end, b.range_end);
        int z_pt = max(a.zero_pt, b.zero_pt);
        signal temp(r_start, r_end, z_pt);
        for(int i = r_start; i < r_end; i++)
        {
            temp[i] = a[i] * b[i];
        }
        return temp;
    }

    ostream &operator<<(ostream &s, signal &t)
    {
        int arr_ind = t.range_end - t.range_start;
        s<<"{";
        for(int i = 0; i < arr_ind; i++)
        {
            if(i == t.zero_pt)
                s<<" ^"<<t[i];
            else
                s<<" "<<t[i];
        }
        s<<"}";
        return s;
    }

    istream &operator>>(istream &s, signal &t)
    {
        char *ip;
        s>>ip;
        t.StrtoSig(ip);
        return s;
    }
}

namespace Parser
{
    using Discrete::signal;
    enum types { DELIMITER = 1, VARIABLE, NUMBER, SIGNAL };

    const int NUMVARS = 26; // No. of variable names .....the alphabet
    class parser
    {
        char *exp_ptr; //points to the expression
        char token[80]; //holds current token
        char tok_type; //holds token's type
        signal vars[NUMVARS]; //holds variable's values

        void eval_exp1(signal &result);
        void eval_exp2(signal &result);
        void eval_exp3(signal &result);
        void eval_exp4(signal &result);
        void eval_exp5(signal &result);
        void eval_exp6(signal &result);
        void eval_time1(signal &result);
        void eval_time2(signal &result);

        void atom(signal &resutl);
        void get_token(), putback();
        void serror(int error);
        signal find_var(char *s);
        int isdelim(char c);

    public:
        parser();
        signal eval_exp(char *exp);
    };

    //Parser constructor
    parser::parser()
    {
        int i;

        exp_ptr = NULL;
        for(i = 0; i < NUMVARS; i++) vars[i] = (signal) 0;
    }

    //Parser entry point
    signal parser::eval_exp(char *exp)
    {
        signal result;

        exp_ptr = exp;

        get_token();
        if(!*token)
        {
            serror(2);//no expression present
            return (signal) 0;
        }

        eval_exp1(result);
        if(*token) serror(0); //last token must be null
        return result;
    }

    //Process an assignment
    void parser::eval_exp1(signal &result)
    {
        int slot;
        char ttok_type;
        char temp_token[80];

        if(tok_type == VARIABLE)
        {
            //save old token
            strcpy(temp_token, token);
            ttok_type = tok_type;
            //compute the index of the variable
            slot = toupper(*token) - 'A';

            get_token();
            if(*token != '=')
            {
                putback();//return curent token
                //restore old token - not assignment
                strcpy(token, temp_token);
                tok_type = ttok_type;
            }

            else
            {
                get_token(); //get the next part of the exp
                eval_exp2(result);
                vars[slot] = result;
                return;
            }
        }

        eval_exp2(result);
    }

    //Add or subtract two terms
    void parser::eval_exp2(signal &result)
    {
        register char op;
        signal temp;

        eval_exp3(result);
        while((op = *token) == '+' || op == '-')
        {
            get_token();
            eval_exp3(temp);
            switch (op)
            {
            case '-':
                result = result - temp;
                break;
            case '+':
                result = result + temp;
                break;
            }
        }
    }

    //Multiply or divide two factors
    void parser::eval_exp3(signal &result)
    {
        register char op;
        signal temp;

        eval_exp4(result);
        while((op = *token) == '*' || op == '&')
        {
            get_token();
            eval_exp4(temp);
            switch(op)
            {
            case '*':
                result = result * temp;
                break;
            case '&':
                //Convolution if possible
                break;
            }
        }
    }

    //Evaluate a unary + or -
    void parser::eval_exp4(signal &result)
    {
        register char op;

        op = 0;
        if((tok_type == DELIMITER) && *token == '+' || *token == '-')
        {
            op = *token;
            get_token();
        }

        eval_exp5(result);
        if(op == '-') result = -result;
    }

    //Process a parenthesized expression
    void parser::eval_exp5(signal &result)
    {
        if(*token == '(')
        {
            get_token();
            eval_exp2(result);
            if(*token != ')')
                serror(1);
            get_token();
        }
        else atom(result);
    }

    //Get the value of a number or a variable
    void parser::atom(signal &result)
    {
        switch(tok_type)
        {
        case VARIABLE:
            result = find_var(token);
            eval_time1(result);
            get_token();
            return;
        case NUMBER:
            result = (signal)atof(token);
            get_token();
            return;
        case SIGNAL:
            result.StrtoSig(token);
            get_token();
            return;
        default:
            serror(0);
        }
    }

    //Time scaling
    void parser::eval_time1(signal &result)
    {
        int i = 0;
        while(token[i] != '[' || token[i] != 0) i++;
        if(token[i] == '[')
        {
            eval_time2(result);
            i++;
            float x;
            if((x = atof(&token[i])) != 0)
                result.timeScale(x);//atoi takes care of the + and - if existing in the string
        }
    }

    //Time shifting
    void parser::eval_time2(signal &result)
    {
        int i = 0;
        while(token[i] != '[' || token[i] != 0) i++;
        if(token[i] == '[')
        {
            i++;
            while(token[i] != '+' || token[i] != '-' || ']') i++;
            result.timeShift(atoi(&token[i+1]));//atoi takes care of the + and - existing in the string
        }
    }

    //Return a token to the input stream
    void parser::putback()
    {
        char *t;

        t = token;
        for(; *t; t++) exp_ptr--;
    }

    //Display a syntax error
    void parser::serror(int error)
    {
        static char *e[] = {
            "Syntax Error",
            "Unbalanced Parenthesis",
            "No expression present"
        };
        cout<<e[error]<<endl;
    }

    //Obtain next token
    void parser::get_token()
    {
        register char *temp;

        tok_type = 0;
        temp = token;
        *temp = '\0';

        if(!*exp_ptr) return; //at end of expression

        while(isspace(*exp_ptr)) ++exp_ptr; //skip over the white spaces

        if(strchr("+-*&=()", *exp_ptr))
        {
            tok_type = DELIMITER;
            //advance to the next char
            *temp++ = *exp_ptr++;
        }

        else if(isalpha(*exp_ptr))
        {
            while(!isdelim(*exp_ptr))
            {
                *temp++ = *exp_ptr++;
                if(*exp_ptr == '[')
                {
                    do
                    {
                        *temp++ = *exp_ptr++;
                    } while(*exp_ptr != ']');
                }
            }
            tok_type = VARIABLE;
        }

        else if(isdigit(*exp_ptr))
        {
            while(!isdelim(*exp_ptr)) *temp++ = *exp_ptr++;
            tok_type = NUMBER;
        }

        else if(*exp_ptr == '{') 
        {
            do
            {
                *temp++ = *exp_ptr++;
            } while(*exp_ptr != '}');
            tok_type = SIGNAL;
        }
        *temp = '\0';
    }

    //Return true if c is delimiter
    int parser::isdelim(char c)
    {
        if(strchr("+-*&=()", c) || c == 9 || c == '\r' || c == 0)
            return 1;
        return 0;
    }

    //return value of a variable
    signal parser::find_var(char *s)
    {
        if(!isalpha(*s))
        {
            serror(1);
            return signal(0);
        }
        return vars[toupper(*token) - 'A'];
    }
}

void main()
{
    using Parser::parser;

    parser eQuation;
    char expression[100];

    cout<<"Basic Signal Arithmetic Calculator"<<endl;
    cout<<"Use this program to perform basic addition, subtraction and multiplication of signals with time scaling and time shifting"<<endl;
    cout<<endl<<"Instructions:"<<endl<<"1\. Use assignment operation to give values to variables. Enter signals within '{' and '}' and elements seperaed by ','";
    cout<<endl<<"\tExample: x = {12+i6, 13+i5}";
    cout<<endl<<"2\. Use '^' before an element to indicate zero position. By default the 1st element is assumed to be at zero position";
    cout<<endl<<"3\. You can include time scaling and shifting within the equation by using the '[' and ']'";
    cout<<endl<<"\tExample: x[2n+3] = y + z[n+5] +{2+i3, ^4+i1}";
    cout<<endl<<"4\. Type 'exit' to exit the program";
    cout<<endl<<"%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%"<<endl;

    do
    {
        cout<<"Enter your equation:"<<endl;
        cin.get(expression, 100);

        if(!strcmp(expression, "exit"))
            break;

        cout<<endl<<"ans: ";
        cout<<endl<<eQuation.eval_exp(expression);
    }while(1);

    getch();
} 
```

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:05:22.913

我认为问题出在函数的最后一个代码中`StrToSig()`：

```
while(*tok != ',' || *tok != '}'|| *tok != '\0') tok++; 
```

当然，`*tok`总是与其中*之一*不同（实际上，至少与其中两个不同）。这将永远运行，最终`tok`进入无法访问的内存。只需将其更正为：

```
while(*tok != ',' && *tok != '}'&& *tok != '\0') tok++; 
```

然后你有第二个问题：复制构造函数 for`complex`很糟糕，因为它不 copy `complexStr`，所以你最终会得到一个未初始化的字符串。

使用 const 引用而不是值也可以改进您的程序，但这超出了您的问题范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:45:40.793

你的问题在`istream &operator>>(istream &s, complex &t)`.

您创建一个`char*`指向无处的对象，然后要求`cin`将数据弹出到其中。不幸的是`cin`，它没有为您分配内存，因此您将垃圾传递给您的`StrtoComplex`函数，导致它崩溃。

您真正想要做的是（以尽量减少代码更改）将输入输入到 a中`std::string`，然后从中提取`.c_str()`以传递给您的解析器。例如，有更多惯用的方式使用 through `std::string`，`std::find`但这应该会让你走得更远。

```
istream &operator>>(istream &s, complex &t)
{
    std::string temp;

    std::getline(s, temp);
    t.StrtoComplex(temp.c_str());
    return s;
} 
```

最后请注意，我建议您使用`std::string`而不是`char[50]`您的 complexStr 表示，因为它将确保始终有足够的内存来满足您的需求。

最后，我想说“`sprintf`即使您知道不会溢出，也不要使用”，因为有时有人会对您的代码或输入进行无害的更改并溢出缓冲区。*始终*使用`snprintf`（或者`_snprintf`如果您的编译器决定不支持 C99）。

# java - javax.inject.Inject 不起作用

> ID：13629076
> 
> 赞同：1
> 
> 时间：2012-11-29T15:27:32.237
> 
> 标签：java, spring, dependency-injection, openjpa

在我们的项目中，我们做了一些 Maven pom.xml 清理并且依赖注入停止工作。例如，这曾经有效，但不再有效：

```
@Inject
private ItemService itemService;

public void whatever() {
    itemService.whatever();
} 
```

当`itemService`我们运行时为空`whatever()`，日志中没有错误/警告消息。只有一个 bean 实现了该接口：

```
public interface ItemService { ... }

@ContainerManaged
@TransactionAttribute(TransactionAttributeType.REQUIRED)
public class ItemServiceBean implements ItemService { ... } 
```

我们尝试将所有依赖项放回发生此错误的项目中，但这没有帮助。我不知道从哪里开始寻找。其中任何一个都会有所帮助：

*   @Inject 在哪里使用？在运行时，通过 Spring？是否有一些源代码会有所帮助？也许该代码的 jar 是我们所缺少的？
*   有什么方法可以在日志中打印一些提示吗？更好的当然是在编译时出现一些错误，但这可能会推动我的运气......
*   最好的当然是你知道我们缺少什么依赖。:) 我们正在运行 Spring、OpenJPA 等，但不知道与列表相关的内容。如果你知道要问什么，我会尽力找到答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T15:32:56.313

在 pom.xml 中包含以下依赖项

```
<dependency>
  <groupId>javax.inject</groupId>
  <artifactId>javax.inject</artifactId>
  <version>1</version>
</dependency> 
```

# c# - 在可视化 Web 部件中显示共享点列表值

> ID：13629077
> 
> 赞同：2
> 
> 时间：2012-11-29T15:27:35.023
> 
> 标签：c#, sharepoint-2010, web-parts

我想知道如何从自定义 WebPart 中的 SharePoint 列表列中获取值，并且我想在可视化 WebPart 中显示它。

```
 splist lists = web.list["list name"];
 spitem item = list.additem();
 item["Title"] = "doc";
 item["No"] = "1";' 
```

我可以使用类似于上面的代码在可视 WebPart 的列表列中分配值。是否有相反的解决方案——从 SharePoint 列表中获取值并将其显示在可视 WebPart 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:58:26.967

有很多示例可以用列表的内容填充文字、标签等。您可能还想过滤您想要显示的内容。这是一些帮助您入门的代码，如果您需要更精确的结果，请告诉我们您希望获得的最终结果是什么：

```
 using (SPSite site = new SPSite(url))
            {
                using (SPWeb web = site.OpenWeb())
                {
                    SPList lists = web.Lists["list name"];
                    foreach (SPListItem itemin lists.Items)
                    {
                       string test = Convert.ToString( item["test"]);
                        TextBox1.Text = test;

                    }
                }
             } 
```

# r - 在 roxygen2 中提供两种用法

> ID：13629080
> 
> 赞同：4
> 
> 时间：2012-11-29T15:27:49.970
> 
> 标签：r, roxygen2

我在同一个家庭中有两个职能。我正在使用 roxygen2 进行记录，可以将它们放在同一个帮助文件中，但不知道如何使文档中的使用字段同时具有这两种功能。

我试过：

```
#' @usage matrix2vectors(cor.mat) vectors2matrix(cor.vect) 
```

这给出了：

```
matrix2vectors(cor.mat) vectors2matrix(cor.vect) 
```

我尝试用逗号分隔，它只给出第一个，我尝试了单独的使用标签，它只使用第一个。

如何使用 roxygen 在使用字段中制作两个项目，以便它们位于不同的行（例如`?lapply`）？

**编辑：根据 GeeSee 的问题，整个 .R 文件**

```
#' Convert Between Correlation Matrix and Upper Triangle Dataframe  
#' 
#' Tools to convert between a correlation matrix and a dataframe of upper triangle 
#' values and variable components.  The dataframe is more intuitive for applying 
#' functions while the correlation matrix is more intuitive to visualize.
#' 
#' @aliases matrix2vectors, vectors2matrix
#' @usage matrix2vectors(cor.mat)
#' @usage vectors2matrix(cor.vect)
#' @rdname matrix2vectors
#' @param cor.mat A square, symetrical matrix with a diagonas of 1s (a correlation matrix).
#' @param cor.vect A dataframe with the row variables of the correlation matrix in the first 
#' column, the column names in the second column and the corresponding correlations in the 
#' third column.
#' @export
#' @examples
#' (mat <- round(cor(mtcars[, 1:5]), 2))
#' matrix2vectors(mat)
#' cor.vect <- matrix2vectors(round(cor(mtcars[, 1:5]), 2))
#' vectors2matrix(cor.vect)
matrix2vectors <- function(cor.mat) {
    nmscor <- colnames(cor.mat)
    rows <- nmscor[1:(length(nmscor)-1)]
    cols <- nmscor[2:length(nmscor)]
    rowdim <- 1:length(rows)
    row.var <- rows[unlist(lapply(seq_along(rowdim), function(i) rowdim[1:i]))]
    col.var <- rep(cols, 1:length(cols))
    cors <- cor.mat[upper.tri(cor.mat)]
    data.frame(row.var, col.var, cors)
}
#' @export

#' @export
vectors2matrix <- function(cor.vect) {
    dimnms <- unique(c(as.character(cor.vect[, 1]), 
        as.character(cor.vect[, 2])))
    mat <- matrix(NA, length(dimnms), length(dimnms))
    mat[upper.tri(mat)] <- cor.vect[, 3]
    diag(mat) <- 1
    dimnames(mat) <- list(dimnms, dimnms)
    mat[lower.tri(mat)] <- t(mat)[lower.tri(mat)]
    mat
}
#' @export 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T15:33:59.190

我认为你想使用`@rdname`并放弃使用的想法`@usage`

因此，选择一个名称并将其用于所有人。例如，将其添加到所有 roxygen 块中

`#' @rdname matrix2vectors`

# ruby-on-rails - 如何列出 Rails 中的所有自动加载路径

> ID：13629082
> 
> 赞同：14
> 
> 时间：2012-11-29T15:27:59.213
> 
> 标签：ruby-on-rails, ruby-on-rails-3, autoload

你如何列出 Rails 中的所有自动加载路径？

当我这样做时，在 Rails 控制台中，它只列出添加到配置中的自定义路径：

```
$ rails c
Loading development environment (Rails 3.2.9)
1.9.3p194 :001 > MyRailsApp::Application.config.autoload_paths
=> [] 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2016-04-07T07:46:10.693

您可以通过以下方式访问所有自动加载路径`ActiveSupport::Dependencies.autoload_paths`

从控制台调用它或从命令行运行`rails r 'puts ActiveSupport::Dependencies.autoload_paths'`。

更多信息在这里（对于 Rails 4，但它也适用于 Rails 3）： http: [//guides.rubyonrails.org/autoloading_and_reloading_constants.html#autoload-paths](http://guides.rubyonrails.org/autoloading_and_reloading_constants.html#autoload-paths)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-11-29T15:27:59.213

*更新：请使用下面的 ActiveSupport::Dependencies.autoload_paths 查看劳拉的回答。我把这个答案留在这里作为另一种方法。*

其中包含在`Rails::Engine`Rails 应用程序的模块中，有如下方法：

```
def _all_autoload_paths
  @_all_autoload_paths ||= (config.autoload_paths + config.eager_load_paths + config.autoload_once_paths).uniq
end 
```

所以，你可以这样做：

```
(MyRailsApp::Application.config.autoload_paths + MyRailsApp::Application.config.eager_load_paths + MyRailsApp::Application.config.autoload_once_paths).uniq 
```

或者：

```
[:autoload_paths, :eager_load_paths, :autoload_once_paths].collect{|m|MyRailsApp::Application.config.send(m)}.flatten.uniq 
```

要不就：

```
MyRailsApp::Application._all_autoload_paths 
```

Rails 3.2.9 中的默认结果是：

```
["/path/to/my_rails_app/app/assets", "/path/to/my_rails_app/app/controllers", "/path/to/my_rails_app/app/helpers", "/path/to/my_rails_app/app/mailers", "/path/to/my_rails_app/app/models"] 
```

这应该包括由其他 gem 添加的所有自动加载路径和自定义加载路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-03-14T07:37:15.137

```
Rails.application.instance_variable_get(:"@_all_autoload_paths") 
```

# android - 开发软键盘输入法

> ID：13629085
> 
> 赞同：-1
> 
> 时间：2012-11-29T15:28:04.727
> 
> 标签：android

我正在寻找为 android 开发自定义 IME/softkeybard。我在这里看到了一些关于 SO 的信息，但是一些链接像这个答案一样被破坏： [如何为 Android 开发软键盘？](https://stackoverflow.com/questions/3480715/how-to-develop-a-soft-keyboard-for-android/3480756#3480756)

有谁知道自定义 IME/软键盘或教程的任何示例以供参考？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T09:12:14.790

发生这种情况是因为您尝试运行的代码只能在具有 api 版本 15 或更高版本的设备上成功执行。

具有较低 api 版本的设备没有 android.preference.preferenceFragment 类。

您的清单文件中也没有任何活动。实际上，系统正在尝试查找扩展 PreferenceFragment 的 ImePreference 活动，因为该活动不可用，因此无法找到导致崩溃的活动。

# java - 外键引用目标不存在

> ID：13629087
> 
> 赞同：1
> 
> 时间：2012-11-29T15:28:24.153
> 
> 标签：java, synchronization, foreign-keys, constraints, firebird

我需要同步来自不同 Firebird 数据库的两个表中的数据。准确地说，我需要使用表用户（第二个数据库）中的记录来更新表人（第一个数据库）中的记录。不仅是“姓名”、“电子邮件”、“生日”，还有 ID（！）。问题是 - 有些表通过外键约束依赖于人员的 ID。

我正在尝试这样做：

1.  删除依赖表中的外键约束。
2.  同步两个表（这意味着更新/更改表 Person 中的 ID）
3.  更改从属表中的适当 ID。
4.  在依赖表中添加外键约束。

最后一步导致错误（来自 java 应用程序的日志，但如果我直接在 IBExpert 中执行这些步骤，它是相同的）：

```
com.bssys.db.jdbc.DBSQLException: GDS Exception. 335544466\. violation of FOREIGN KEY constraint "FK_EMPLOYEE_PERSON" on table "EMPLOYEE"
Foreign key reference target does not exist, error code: HY000
Reason: violation of FOREIGN KEY constraint "FK_EMPLOYEE_PERSON" on table "EMPLOYEE" 
```

（Employee - 是从属表之一）

我的问题是，我是否可以避免这个错误。或者也许有一些关于如何更改相关表中的 ID 的想法。同步数据库可能有特殊的 RDBMS 工具，但我需要通过 Java 应用程序同步它们，因此只使用 sql 和 java。我使用火鸟 2.5.1。

完整的 SQL 语句（示例）：

1.  ```
    ALTER TABLE employee DROP CONSTRAINT fk_employee_person 
    ```

2.  ```
    UPDATE person SET id = 555555 WHERE id = 3000005 
    ```

3.  ```
    UPDATE employee SET person_id = 555555 WHERE person_id = 3000005 
    ```

4.  ```
    ALTER TABLE employee ADD CONSTRAINT fk_employee_person FOREIGN KEY (person_id) REFERENCES person(id) 
    ```

一些新信息：似乎有时 IBExpert 允许我完成这些步骤。实际上，如果我在其中一个表处于“DATA”模式时更改了所有 ID，它会给出错误（我想，它也是某种事务，例如`CREATE VIEW`）。

我还发现删除/添加外键至少在 Firebird 2.1（甚至 2.5）之前需要对整个数据库进行独占锁定

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T16:27:26.707

您应该创建表，以便外键确实具有`ON UPDATE CASCADE`子句 - 然后当您更新`ID`它时，它也会在相关表中更新，而无需您付出任何额外的努力。因此，对于引用该`Person`表的每个表，您需要执行以下操作：

```
-- delete the original FK constraint
ALTER TABLE _table_ DROP CONSTRAINT _fk_constraint_name_;
-- (re)add the FK constraint with ON UPDATE CASCADE
ALTER TABLE _table_ ADD CONSTRAINT _fk_constraint_name_ FOREIGN KEY (person_id) REFERENCES person(id) ON UPDATE CASCADE; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T11:02:29.997

不是重新编号主键，而是使用正确的主键插入新记录`person`，然后更新外键值`employee`并删除旧`person`记录。

注意：以下部分是主观的，更多的是观点而不是事实。

顺便说一句：需要对主键重新编号通常表明存在设计问题。主键在您的数据库之外应该没有意义，并且它们通常应该在给定记录的生命周期内保持稳定。在您的情况下，密钥显然也意味着您的数据库之外的某些东西，并且也不稳定。

*如ain*的答案所示，您可以使用`ON UPDATE CASCADE`，但恕我直言，这通常是问题的补丁，而不是解决方案。解决方案是：如果您的主键不稳定：制作这些唯一键并添加不需要更改的无意义主键。

# sql-server - 如何修改以下代码以添加交易？

> ID：13629090
> 
> 赞同：1
> 
> 时间：2012-11-28T05:52:34.907
> 
> 标签：sql-server

我是存储过程和事务的新手。

我编写了一个将数据插入两个表的存储过程。这是SP：

```
Begin

SET NOCOUNT ON 

Declare @Parcel_Id int

INSERT INTO 
        Parcel([Code],[Title],
               [Is_Parcel_Equal_To_Property],
               [Property_Id],[Property_Type_Id],
               [Plot_No],[Phone],[Fax],[Email],
               [Administrator_Name],
               [Watchman_Name],
               [Remark],
               [List_in_Retail_Leasing_Module],
               [Landlord_Id],
               [Country_Id],[State_Id],[Community_Id],[MainRoad_Id],
               [Address],
               [Is_Active],
               [Added_On_Date],[Added_By]) 
        VALUES(@Code,@Title,
               @Is_Parcel_Equal_To_Property,
               @Property_Id,@Property_Type_Id,
               @Plot_No,@Phone,@Fax,@Email,
               @Administrator_Name,
               @Watchman_Name,
               @Remark,
               @List_in_Retail_Leasing_Module,
               @Landlord_Id,
               @Country_Id,@State_Id,@Community_Id,@MainRoad_Id,
               @Address,
               @Is_Active,
               @Added_On_Date,@Added_By) 

Set @Parcel_Id = SCOPE_IDENTITY()

INSERT INTO Parcel_Spacifications
        ([Parcel_Id],[Apartments],[Villas],[Retails],[Offices],[Labour_Camp],
         [Warehouses],[Total_Car_Parks],[Floors],[Year_Of_Construction],
         [Built_Up_Area],[Plot_Area],[No_Of_Basements],[Is_Special_Project])
        VALUES (@Parcel_Id,@Apartments,@Villas,@Retails,@Offices,@Labour_Camp,
                @Warehouses,@Total_Car_Parks,@Floors,@Year_Of_Construction,
                @Built_Up_Area,@Plot_Area,@No_Of_Basements,@Is_Special_Project)               
End
RETURN @Parcel_Id 
```

现在我想使用交易，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:33:54.580

`BEGIN TRAN`你用和`COMMIT`像这样包装你的代码：

```
BEGIN

SET NOCOUNT ON

Declare @Parcel_ID int

BEGIN TRAN

...

COMMIT

END

RETURN @Parcel_ID 
```

[您应该在此处](http://msdn.microsoft.com/en-us/library/ms188929.aspx)阅读文档中的备注。他们解释了交易是如何运作的。

# c# - 文本标签更新时表单闪烁

> ID：13629095
> 
> 赞同：2
> 
> 时间：2012-11-29T15:28:41.233
> 
> 标签：c#, winforms, textlabel

我完全意识到这是一个被多次询问的问题，但我还没有找到完美的解决方案。

问题：我有一个简单的 Windows 窗体，其中包含几个表格面板、一个文本区域和一个用作字符计数器的文本标签 - 非常简单的设置。但是，当我开始更新该字符计数器文本标签时，我在其中一个文本区域中输入的每个字符都会闪烁（即闪烁白色）。

我读过的最常见的解决方案是使用各种缓冲和渲染参数。我已经修改了失效、双缓冲参数、[一系列 ControlStyle 参数](http://www.dreamincode.net/forums/topic/238661-flickering-when-changing-text-of-labels/)，以及一些其他甚至[奇怪的强制双缓冲方法](https://stackoverflow.com/questions/2612487/how-to-fix-the-flickering-in-user-controls)。

在所有这些解决方案中，只有[2 个](https://stackoverflow.com/questions/2612487/how-to-fix-the-flickering-in-user-controls)似乎有明显的改进。但是，如果我只是将手指放在某个键上，最终仍会出现闪烁。所以我正在寻找的是一个更好的解决方案，可以完全消除闪烁。由于字符计数器是一个基本概念，我相信它是一个具有已知解决方案的热门领域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T16:59:24.010

*在我需要帮助的时候，我会更改我的代码以隐藏其中包含的私人细节。*

如果这不可能，我会建议以下方法来减少闪烁：

在击键之间使用计时器（注册 keyup 事件）。如果在 500 毫秒内没有发生 keyup 事件，则允许 textchanged 事件继续进行，否则，什么也不做。

# java - 如何使用各种屏幕调整应用程序（JFrame）？

> ID：13629097
> 
> 赞同：1
> 
> 时间：2012-11-29T15:28:43.937
> 
> 标签：java, swing, jframe, screen-size, jinternalframe

我一直在研究一个**Swing**应用程序，它有一个**JFrame**作为主框架，它里面包含很多**JInternalFrames**，当我在公司的每台计算机上安装它时，似乎有些计算机的屏幕尺寸更小更紧凑然后希望我开发了我的应用程序的屏幕，这没有用，所以我问我是否可以将我的应用程序（框架）调整为各种屏幕尺寸，我正在使用**Swing** API。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T15:41:56.007

您可以像这样检查屏幕的大小：

```
 Dimension screen = Toolkit.getDefaultToolkit().getScreenSize(); 
```

然后，您可以决定要覆盖多少屏幕。说屏幕大小的一半。

```
 int h = screen.height / 2;
 int w = screen.width / 2; 
```

然后将您的 JFrame 设置为这个新的高度和宽度。

```
myFrame.setSize(new Dimension(w, h)); 
```

当然，您必须进行一些试验才能了解适合所有屏幕尺寸的尺寸。或者，您可以简单地在启动时最大化 Frame。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:44:51.650

你可以得到局部最大分辨率

```
GraphicsEnvironment env = GraphicsEnvironment.getLocalGraphicsEnvironment();
            Rectangle desktopBounds = env.getMaximumWindowBounds(); 
```

然后您可以相应地调整您的应用程序，请注意这是在 AWT 中，但对我来说它仍然得到了正确的结果

# wpf - PreviewMouseDown 发生在 SelectionChanged 之前

> ID：13629098
> 
> 赞同：1
> 
> 时间：2012-11-29T15:28:45.573
> 
> 标签：wpf

我尝试通过检查 PreviewMouseDown 事件处理程序中的 SelectedItem 来获取 ListView 的选定值。

但是， PreviewMouseDown 发生在 SelectedItem 之前，所以我得到了旧的选定值。

如何获取更新后的选定值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T14:00:52.123

我这样做了，正如“ArsenMkrt”和“Wallstreet Programmer”向我建议的那样：

在 xaml 中，我的控制：

```
 <loc:RecipeListsControl x:Name="recipeListsControl" DataContext="{Binding Path=RecipeLists}"/> 
```

在后面的代码中：

```
 recipeListsControl.AddHandler(UIElement.MouseDownEvent, new MouseButtonEventHandler(Mouse_Down), true);
 recipeListsControl.AddHandler(UIElement.KeyDownEvent, new KeyEventHandler(Key_Down), true); 
```

多谢你们

# python - 尝试在 django 中创建缩略图时无法识别图像文件

> ID：13629099
> 
> 赞同：1
> 
> 时间：2012-11-29T15:28:45.803
> 
> 标签：python, django, python-imaging-library

> **可能重复：**
> [保存时调整图像大小](https://stackoverflow.com/questions/623698/resize-image-on-save)

我正在尝试在 django 中创建缩略图，正在尝试构建一个专门用于生成缩略图的自定义类。如下

```
from cStringIO import StringIO
from PIL import Image

class Thumbnail(object):

    SIZE = (50, 50)

    def __init__(self, source):
        self.source = source
        self.output = None

    def generate(self, size=None, fit=True):
        if not size:
            size = self.SIZE

        if not isinstance(size, tuple):
            raise TypeError('Thumbnail class: The size parameter must be an instance of a tuple.')

        # resize properties
        box = size
        factor = 1
        image = Image.open(self.source)
        # Convert to RGB if necessary
        if image.mode not in ('L', 'RGB'): 
            image = image.convert('RGB')
        while image.size[0]/factor > 2*box[0] and image.size[1]*2/factor > 2*box[1]:
            factor *=2
        if factor > 1:
            image.thumbnail((image.size[0]/factor, image.size[1]/factor), Image.NEAREST)

        #calculate the cropping box and get the cropped part
        if fit:
            x1 = y1 = 0
            x2, y2 = image.size
            wRatio = 1.0 * x2/box[0]
            hRatio = 1.0 * y2/box[1]
            if hRatio > wRatio:
                y1 = int(y2/2-box[1]*wRatio/2)
                y2 = int(y2/2+box[1]*wRatio/2)
            else:
                x1 = int(x2/2-box[0]*hRatio/2)
                x2 = int(x2/2+box[0]*hRatio/2)
            image = image.crop((x1,y1,x2,y2))

        #Resize the image with best quality algorithm ANTI-ALIAS
        image.thumbnail(box, Image.ANTIALIAS)

        # save image to memory
        temp_handle = StringIO()
        image.save(temp_handle, 'png')
        temp_handle.seek(0)

        self.output = temp_handle

        return self

    def get_output(self):
        self.output.seek(0)
        return self.output.read() 
```

该课程的目的是让我可以在不同的位置使用它来动态生成缩略图。该类完美运行，我直接在视图下对其进行了测试。我在表单的保存方法中实现了缩略图类，以在保存时调整原始图像的大小。

在我的设计中，我有两个缩略图字段。我能够生成一个缩略图，如果我尝试生成两个它会崩溃并且我已经卡了几个小时不知道是什么问题。

这是我的模型

```
class Image(models.Model):
    article         = models.ForeignKey(Article)
    title           = models.CharField(max_length=100, null=True, blank=True)
    src             = models.ImageField(upload_to='publication/image/')
    r128            = models.ImageField(upload_to='publication/image/128/', blank=True, null=True)
    r200            = models.ImageField(upload_to='publication/image/200/', blank=True, null=True)

    uploaded_at     = models.DateTimeField(auto_now=True) 
```

这是我的表格

```
class ImageForm(models.ModelForm):
    """

    """
    class Meta:
        model = Image
        fields = ('src',)

    def save(self, commit=True):
        instance = super(ImageForm, self).save(commit=True)

        instance.r128 = SimpleUploadedFile(
                    instance.src.name,
                    Thumbnail(instance.src).generate((128, 128)).get_output(),
                    content_type='image/png'
                )

        instance.r200 = SimpleUploadedFile(
            instance.src.name,
            Thumbnail(instance.src).generate((200, 200)).get_output(),
            content_type='image/png'
        )

        if commit:
            instance.save()
        return instance 
```

奇怪的是，当我在保存表单中删除包含 instance.r200 的行时。它工作正常，它会生成缩略图并成功存储它。一旦我添加了第二个缩略图，它就会失败..

有什么想法在这里做错了吗？

谢谢

**更新：**

根据评论请求，我附加了错误跟踪

```
IOError at /en/publication/new/

cannot identify image file

Request Method:     POST
Request URL:    http://127.0.0.1:8000/en/publication/new/?image-extra=
Django Version:     1.4.2
Exception Type:     IOError
Exception Value:    

cannot identify image file

Exception Location:     /Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/PIL/Image.py in open, line 1980
Python Executable:  /Users/mo/Projects/pythonic/snowflake-env/bin/python
Python Version:     2.7.2 
```

更新

试图创建打印语句，下面是输出

```
Source: publication/image/tumblr_m9o7244nZM1rykg1io1_1280_11.jpg
Source: publication/image/tumblr_m9o7244nZM1rykg1io1_1280_11.jpg
ERROR:root:cannot identify image file
ERROR:django.request:Internal Server Error: /en/publication/new/
Traceback (most recent call last):
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/core/handlers/base.py", line 111, in get_response
    response = callback(request, *callback_args, **callback_kwargs)
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/contrib/auth/decorators.py", line 20, in _wrapped_view
    return view_func(request, *args, **kwargs)
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/db/transaction.py", line 209, in inner
    return func(*args, **kwargs)
  File "/Users/mo/Projects/pythonic/snowflake-env/snowflake/snowflake/apps/publication/views.py", line 69, in new
    formset.save()
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/forms/models.py", line 497, in save
    return self.save_existing_objects(commit) + self.save_new_objects(commit)
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/forms/models.py", line 628, in save_new_objects
    self.new_objects.append(self.save_new(form, commit=commit))
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/forms/models.py", line 727, in save_new
    obj = form.save(commit=False)
  File "/Users/mo/Projects/pythonic/snowflake-env/snowflake/snowflake/apps/publication/forms.py", line 113, in save
    Thumbnail(instance.src).generate((200, 200)).get_output(),
  File "/Users/mo/Projects/pythonic/snowflake-env/snowflake/snowflake/apps/core/utils.py", line 23, in generate
    image = Image.open(self.source)
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/PIL/Image.py", line 1980, in open
    raise IOError("cannot identify image file")
IOError: cannot identify image file 
```

如图所示，第一张图像打印并成功处理，第二张图像失败。

**更新**

在缩略图类中应用 copy() 后追溯错误更新

```
ERROR:root:cannot identify image file
ERROR:django.request:Internal Server Error: /en/publication/new/
Traceback (most recent call last):
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/core/handlers/base.py", line 111, in get_response
    response = callback(request, *callback_args, **callback_kwargs)
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/contrib/auth/decorators.py", line 20, in _wrapped_view
    return view_func(request, *args, **kwargs)
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/db/transaction.py", line 209, in inner
    return func(*args, **kwargs)
  File "/Users/mo/Projects/pythonic/snowflake-env/snowflake/snowflake/apps/publication/views.py", line 69, in new
    formset.save()
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/forms/models.py", line 497, in save
    return self.save_existing_objects(commit) + self.save_new_objects(commit)
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/forms/models.py", line 628, in save_new_objects
    self.new_objects.append(self.save_new(form, commit=commit))
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/django/forms/models.py", line 727, in save_new
    obj = form.save(commit=False)
  File "/Users/mo/Projects/pythonic/snowflake-env/snowflake/snowflake/apps/publication/forms.py", line 113, in save
    f128.write(Thumbnail(instance.src).generate((128, 128)).get_output())
  File "/Users/mo/Projects/pythonic/snowflake-env/snowflake/snowflake/apps/core/utils.py", line 15, in __init__
    self._pilImage = Image.open(self.source)
  File "/Users/mo/Projects/pythonic/snowflake-env/lib/python2.7/site-packages/PIL/Image.py", line 1980, in open
    raise IOError("cannot identify image file")
IOError: cannot identify image file 
```

**更新**

最后，我设法让它工作，但我不得不将文件流式传输到 self.source 作为 belo

```
def __init__(self, source):
    self.source = StringIO(file(source.path, "rb").read())
    self.output = None

    self._pilImage = Image.open(self.source) 
```

以上是理想的方法吗？每次点击时读取文件是个好主意吗？如果没有，我的替代方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T17:00:58.430

我看到的问题在于您设计`Thumbnail`课程的方式。它使用类属性来存储实例变量，这意味着当您尝试多次使用该类时会发生冲突。

不需要静态`load`方法，因为一旦将属性移动到实例，它的作用就与类的构造函数完全相同。通过在构造函数中要求 a ，您可以确保稍后在查找空字符串值时`source`不会发生崩溃。`generate`

此外，我认为您面临的主要问题之一是当您使用 django 模型为`ImageField`'s. 如果您传入字符串路径，则不会看到这一点，但当您传入文件对象时，该`generate`方法会将其读取到最后。然后你`generate`用相同的源对象第二次调用，但它在最后，你得到一个`IOError`. 现在一种方法是确保在再次`0`调用之前先找到源代码`Thumbnail`，但是您可以省去麻烦，只需`Thumbnail`打开您的类并在构造函数中缓存一次 PIL 图像。然后`generate`就不需要每次都不断地重读一遍。

```
# Example from your code #
def generate(self, size=None, fit=True):
    ...
    # The first time you do this, it will read
    # self.source to the end, because in Django, you
    # are passing a file-like object.
    image = Image.open(self.source)

# this will work the first time
generate()
# uh oh. self.source was a file object that is at the end
generate() # crash 
```

**重写的缩略图类**

```
from cStringIO import StringIO
from PIL import Image

class Thumbnail(object):

    SIZE = (50, 50)

    def __init__(self, source):
        self.source = source
        self.output = None

        self._pilImage = Image.open(self.source)

    def generate(self, size=None, fit=True):
        if not size:
            size = self.SIZE

        if not isinstance(size, tuple):
            raise TypeError('Thumbnail class: The size parameter must be an instance of a tuple.')

        # resize properties
        box = size
        factor = 1
        image = self._pilImage.copy()

        # Convert to RGB if necessary
        if image.mode not in ('L', 'RGB'): 
            image = image.convert('RGB')
        while image.size[0]/factor > 2*box[0] and image.size[1]*2/factor > 2*box[1]:
            factor *=2
        if factor > 1:
            image.thumbnail((image.size[0]/factor, image.size[1]/factor), Image.NEAREST)

        #calculate the cropping box and get the cropped part
        if fit:
            x1 = y1 = 0
            x2, y2 = image.size
            wRatio = 1.0 * x2/box[0]
            hRatio = 1.0 * y2/box[1]
            if hRatio > wRatio:
                y1 = int(y2/2-box[1]*wRatio/2)
                y2 = int(y2/2+box[1]*wRatio/2)
            else:
                x1 = int(x2/2-box[0]*hRatio/2)
                x2 = int(x2/2+box[0]*hRatio/2)
            image = image.crop((x1,y1,x2,y2))

        #Resize the image with best quality algorithm ANTI-ALIAS
        image.thumbnail(box, Image.ANTIALIAS)

        # save image to memory
        temp_handle = StringIO()
        image.save(temp_handle, 'png')
        temp_handle.seek(0)

        self.output = temp_handle

        return self

    def get_output(self):
        self.output.seek(0)
        return self.output.read() 
```

用法：`Thumbnail(src).generate((200, 200)).get_output()`

`source`和`output`需要对于每个实例都是唯一的。但是在您的版本中，您将设置`output`为类级别，这意味着两个实例`Thumbnail`使用共享的最新版本的`output`.

```
# your code #
    # this is assigning the most recently processed
    # object to the class level. shared among all.
    self.output = temp_handle

    return self

def get_output(self):
    # always read the shared class level
    return self.output.read() 
```

另外，我觉得有一种更简单的方法来执行调整大小/适合/裁剪。如果您解释要对图像进行的确切转换，我也可以将其简化。

**更新**

我忘了特别提到我建议保存一次源图像，你的用法应该是这样的：

```
def save(self, commit=True):
    instance = super(ImageForm, self).save(commit=True)

    thumb = Thumbnail(instance.src)

    instance.r128 = SimpleUploadedFile(
        instance.src.name,
        thumb.generate((128, 128)).get_output(),
        content_type='image/png'
    )

    instance.r200 = SimpleUploadedFile(
        instance.src.name,
        thumb.generate((200, 200)).get_output(),
        content_type='image/png'
    ) 
```

请注意，我们只创建了一个使用源的实例，`Thumbnail`它只会在 PIL 中打开一次。然后，您可以从中生成任意数量的图像。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-02T01:16:19.880

的参数`PIL.Image.open(...)`可以是文件名或文件对象。如果使用类似对象的文件，则读取位置应位于文件的开头。您使用文件对象。（这是肯定的，因为你使用`instance.src.name`然后你通过了`Thumbnail(instance.src)`。）

**解决方案**：在创建第二个缩略图之前将文件倒回到开头，`instance.src.seek(0)`或者只传递文件名，而不是文件对象：`Thumbnail(instance.src.name)`.

# sql-server - 缓存调用 Web 服务的 CLR UDF 的结果

> ID：13629100
> 
> 赞同：1
> 
> 时间：2012-11-29T15:28:50.047
> 
> 标签：sql-server, sql-server-2008, .net-2.0

我有一个查询 Web 服务的 SQL CLR UDF。由于这可能代价高昂，尤其是在函数内是多行查询的一部分，因此我希望尽可能避免调用 Web 服务。在每种情况下，相同的输入将产生相同的输出（例如，如果我的输入是'abc'，我将始终得到'xyz'并且没有什么不同，同样'def'将始终产生'tuv'等）。

我做了一些测试，似乎 SQL 没有做任何类型的缓存，所以总是会调用 Web 服务。

**示例案例：**我有一个`MyTable`带有字段的表`MyField1`。虽然`MyTable`有 500 行，但`MyField1`始终只有 3 个可能值之一。示例查询：

```
SELECT MyFunction(MyField1) FROM MyTable 
```

发生的情况是 Web 服务将被调用 500 次，表中的每一行调用一次。我更喜欢的是 Web 服务只被调用 3 次（每个不同的值一次），并从一些缓存中读取重复值。

**示例代码：**

```
[SqlFunction]
public static SqlString MyFunction(SqlString input)
{
    if (input.IsNull) return SqlString.Null;

    using (var webService = new MyWebService())
    {
        string result = webService.Call(input.Value);

        return new SqlString(result);
    }
} 
```

我真正希望将其保存在特定于上下文的缓存中。也就是说，缓存只存在于在单个存储过程的调用中或在单个查询窗口等中缓存结果。是否有任何可用的机制来完成我所追求的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T12:52:04.280

**编辑说明接近尾声的更新版本**

尽管此答案不使用缓存，但它应该最大限度地减少对您的函数的调用次数。使用多个`CTEs`来查找 myField1 的不同值，然后使用您的函数在 web 服务中查找不同的值，然后将这些值加入 MyTable。下面的例子可能更清楚：

[SQL小提琴](http://sqlfiddle.com/#!3/92c16/5)

**MS SQL Server 2008 架构设置**：

```
CREATE TABLE MyTable
(
    ID int PRIMARY KEY IDENTITY,
    MyField1 VARCHAR(1)
);

CREATE FUNCTION MyFunction
(
    @input As VARCHAR(1)
)
RETURNS VARCHAR(10)
AS
BEGIN
    -- This could be a CLR Function
    -- Return the result of the function
    RETURN  CASE @input WHEN 'A' THEN 'aaaaaaaaaa' WHEN 'B' THEN 'bbbbbbbbbb' ELSE 'ccccccccc' END

END;

-- DATA SET UP
DECLARE @i INT = 0
DECLARE @Field VARCHAR(1)
WHILE @i < 1000
BEGIN
    SELECT @Field = CASE @i % 3 WHEN 1 THEN 'A' WHEN 2 THEN 'B' ELSE 'C' END
    INSERT INTO MyTable (MyField1) VALUES  (@Field)
    SET @i = @i + 1
END 
```

**查询 1**：

```
;WITH DistinctMyField1CTE
AS
(
    SELECT DISTINCT MyField1
    FROM MyTable
),
LookupValuesCTE
AS
(
    SELECT MyField1, dbo.MyFunction(MyField1) As MyOutputField
    FROM DistinctMyField1CTE
)
SELECT TOP 20 T1.Id, T1.MyField1, T2.MyOutputField
FROM MyTable T1
INNER JOIN LookupValuesCTE T2
    ON T1.MyField1 = T2.MyField1
ORDER BY T1.ID 
```

**[结果](http://sqlfiddle.com/#!3/92c16/5/0)**：

```
| ID | MYFIELD1 | MYOUTPUTFIELD |
---------------------------------
|  1 |        C |     ccccccccc |
|  2 |        A |    aaaaaaaaaa |
|  3 |        B |    bbbbbbbbbb |
|  4 |        C |     ccccccccc |
|  5 |        A |    aaaaaaaaaa |
|  6 |        B |    bbbbbbbbbb |
|  7 |        C |     ccccccccc |
|  8 |        A |    aaaaaaaaaa |
|  9 |        B |    bbbbbbbbbb |
| 10 |        C |     ccccccccc |
| 11 |        A |    aaaaaaaaaa |
| 12 |        B |    bbbbbbbbbb |
| 13 |        C |     ccccccccc |
| 14 |        A |    aaaaaaaaaa |
| 15 |        B |    bbbbbbbbbb |
| 16 |        C |     ccccccccc |
| 17 |        A |    aaaaaaaaaa |
| 18 |        B |    bbbbbbbbbb |
| 19 |        C |     ccccccccc |
| 20 |        A |    aaaaaaaaaa | 
```

**编辑：** 请注意，当我检查 aboce 的 SQL Profiler 跟踪时，我看到对 UDF 的 1000 次调用，换句话说，查询分析器正在生成一个扩展 CTE 并为每一行调用一次 UDF 的计划。

下面使用一个表变量来确保 UDF 只被调用 3 次。我在 SQL Profiler 中对此进行了跟踪，并且效率更高。这使用与上面相同的表和函数。需要附加 SQLFiddle

[SQL小提琴](http://sqlfiddle.com/#!3/92c16/11)

**MS SQL Server 2008 架构设置**：

```
CREATE TABLE MyTable
(
    ID int PRIMARY KEY IDENTITY,
    MyField1 VARCHAR(1)
);

CREATE FUNCTION MyFunction
(
    @input As VARCHAR(1)
)
RETURNS VARCHAR(10)
AS
BEGIN
    -- This could be a CLR Function
    -- Return the result of the function
    RETURN  CASE @input WHEN 'A' THEN 'aaaaaaaaaa' WHEN 'B' THEN 'bbbbbbbbbb' ELSE 'ccccccccc' END

END;

-- DATA SET UP
DECLARE @i INT = 0
DECLARE @Field VARCHAR(1)
WHILE @i < 1000
BEGIN
    SELECT @Field = CASE @i % 3 WHEN 1 THEN 'A' WHEN 2 THEN 'B' ELSE 'C' END
    INSERT INTO MyTable (MyField1) VALUES  (@Field)
    SET @i = @i + 1
END 
```

**查询 1**：

```
DECLARE @TempTable TABLE
(
    MyField1 VARCHAR(1) PRIMARY KEY,
    MyOutputField VARCHAR(10) NULL
)

INSERT INTO @TempTable (MyField1)
SELECT DISTINCT MyField1
FROM MyTable

-- UPDATE Separately otherwise the function gets called
-- for every row in MyTable
UPDATE @TempTable
    SET MyOutputField = dbo.MyFunction(MyField1)

SELECT TOP 20 T1.ID, T1.MyField1, T2.MyOutputField
FROM MyTable T1
INNER JOIN @TempTable T2
    ON T1.MyField1 = T2.MyField1 
```

**[结果](http://sqlfiddle.com/#!3/92c16/11/0)**：

```
| ID | MYFIELD1 | MYOUTPUTFIELD |
---------------------------------
|  2 |        A |    aaaaaaaaaa |
|  5 |        A |    aaaaaaaaaa |
|  8 |        A |    aaaaaaaaaa |
| 11 |        A |    aaaaaaaaaa |
| 14 |        A |    aaaaaaaaaa |
| 17 |        A |    aaaaaaaaaa |
| 20 |        A |    aaaaaaaaaa |
| 23 |        A |    aaaaaaaaaa |
| 26 |        A |    aaaaaaaaaa |
| 29 |        A |    aaaaaaaaaa |
| 32 |        A |    aaaaaaaaaa |
| 35 |        A |    aaaaaaaaaa |
| 38 |        A |    aaaaaaaaaa |
| 41 |        A |    aaaaaaaaaa |
| 44 |        A |    aaaaaaaaaa |
| 47 |        A |    aaaaaaaaaa |
| 50 |        A |    aaaaaaaaaa |
| 53 |        A |    aaaaaaaaaa |
| 56 |        A |    aaaaaaaaaa |
| 59 |        A |    aaaaaaaaaa | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:28:50.047

我想出了这个解决方案，但我知道所有的锁定本身都可能代价高昂，而且我不确定我是否保证了这个线程的安全并且没有死锁。此外，它不符合我仅在特定上下文中保持缓存活动的愿望。

**缓存助手：**

```
private class CustomCache
{
    private class CacheObject
    {
        private DateTime _expires;
        private string _value;

        public string Value { get { _expires = DateTime.Now.AddSeconds(5.0); return _value; } }
        public DateTime Expires { get { return _expires; } }

        public CacheObject(string value)
        {
            _value = value;
            _expires = DateTime.Now.AddSeconds(5.0);
        }
    }

    private Dictionary<string, CacheObject> _cache = new Dictionary<string,CacheObject>();
    private object _cacheLock = new object();

    public string this[string key]
    {
        get
        {
            return _cache[key].Value;
        }
    }

    public void Add(string key, string value)
    {
        lock (_cacheLock)
        {
            if (!_cache.ContainsKey(key))
            {
                // Add the key and value to the dictionary.
                _cache.Add(key, new CacheObject(value));

                // Create a thread to check expiration on the object and remove from the dictionary.
                var t = new System.Threading.Thread(arg =>
                {
                    var k = (string)arg;
                    bool exists;
                    do
                    {
                        System.Threading.Thread.Sleep(2000);
                        lock (_cacheLock)
                        {
                            exists = ((_cache.ContainsKey(k)) && (_cache[k].Expires > DateTime.Now));
                        }
                    }
                    while (exists);
                    lock (_cacheLock)
                    {
                        _cache.Remove(k);
                    }
                });
                t.Start(key);
            }
        }
    }

    public bool Contains(string key)
    {
        bool contains;
        lock (_cacheLock)
        {
            contains = _cache.ContainsKey(key);
        }
        return contains;
    }
} 
```

**修改后的 UDF 代码：**

```
private static CustomCache Cache = new CustomCache();

[SqlFunction]
public static SqlString MyFunction(SqlString input)
{
    if (input.IsNull) return SqlString.Null;

    if (!Cache.Contains(input.Value))
    {
        // Not in cache; retrieve from the service.
        using (var webService = new MyWebService())
        {
            string result = webService.Call(input.Value);

            Cache.Add(input.Value, result);
        }
    }

    return new SqlString(Cache[input.Value]);
} 
```

# android - Android：如何将 getMaxAmplitude 转换为 db？

> ID：13629102
> 
> 赞同：7
> 
> 时间：2012-11-29T15:28:50.497
> 
> 标签：android, decibel, amplitude

我有一段代码可以为我提供来自麦克风的音频的 getMaxAmplitude()。它有效，但价值肯定很奇怪。我需要将其转换为分贝。我怎样才能？我找到了这个公式：double db = 20 * Math.log10(recorder.getMaxAmplitude() / 2700.0); 但我不知道它是否正确。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-30T10:41:21.913

公式是正确的，但我不知道 2700.0，因为：假设这种情况：我们有一个 16 位深度的声音。这意味着我们将有 2^16（“2 的 16 次方”）不同的幅度值可供我们使用，即 65,536 步。由于步数分为正值和负值（我们之前的波峰和波谷），这意味着它分为 32,767 个正值（加零）和 32,768 个负值。然后：

```
db = 20 * log10(peaks/ 32767); 
```

“2700.0”表示信号的最大幅度值，但我不知道位深度。问候。

# iphone - cocos2d 和 box2d：相机旋转

> ID：13629106
> 
> 赞同：2
> 
> 时间：2012-11-29T15:28:55.267
> 
> 标签：iphone, cocos2d-iphone, box2d, box2d-iphone

[我和这个问题](https://stackoverflow.com/questions/7655892/cocos2d-top-down-camera-view-with-rotation)有类似的情况。我想保持相机与玩家在中心和玩家的旋转。

但我使用的是 box2d，所以我无法旋转环境并保持播放器静止。我怎么能用 cocos2d 做到这一点？

我只有旋转代码，我敢肯定这是错误的：

```
self.rotation = car.body->GetAngle()*(180.0/M_PI); 
```

这是一个糟糕的草图： ![糟糕的草图](../Images/b65d0c46bd50e685a4220698a60318aa.png)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T17:18:18.007

这个答案有很多关于移动背景的信息。

[如何在 cocos 2d 中移动背景](https://stackoverflow.com/questions/4395959/how-to-move-background-in-cocos-2d)

您需要做的是创建一个 CCLayer，然后旋转图层。只要上面的屏幕截图准确，那将是最好的方法。

这是一个更详细的代码链接。 [http://www.cocos2d-iphone.org/forum/topic/22376](http://www.cocos2d-iphone.org/forum/topic/22376)

# internet-explorer - IE 7-10 的多级线性渐变

> ID：13629107
> 
> 赞同：0
> 
> 时间：2012-11-29T15:29:08.860
> 
> 标签：internet-explorer, css, linear-gradients

所以我只熟悉使用过滤器和 PIE 的简单渐变，但我如何使用相同的工具进行多个停止/开始渐变？：

```
background-image: -moz-linear-gradient(center bottom , #0C355C 0%, #082540 50%, #0C355C 51%, #0F4476 100%);
background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0, #0C355C), color-stop(0.5, #082540), color-stop(0.51, #0C355C), color-stop(1, #0F4476)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:42:48.067

你应该使用这个：

[http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

例子：

```
background: #1e5799; /* Old browsers */
background: -moz-linear-gradient(top,  #1e5799 0%, #2989d8 50%, #207cca 51%, #7db9e8 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#1e5799), color-stop(50%,#2989d8), color-stop(51%,#207cca), color-stop(100%,#7db9e8)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* IE10+ */
background: linear-gradient(to bottom,  #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#1e5799', endColorstr='#7db9e8',GradientType=0 ); /* IE6-9 */ 
```

# c# - 邮件插入一个链接作为正文

> ID：13629109
> 
> 赞同：1
> 
> 时间：2012-11-29T15:29:18.740
> 
> 标签：c#, html, mailto

我正在尝试在电子邮件正文中插入一个链接：

> string.Format("mailto:email@address.com?subject{0}&body{1}", "主题邮件", "Http://hostname/default.aspx?id={0000000-00000-0000-00000000000) &language=en");

我的问题是链接在 { 之前停止并且完整的链接不可点击。

我试图用 %7B 替换 { 并用 %7D 替换 } 但它不起作用。您对如何实现这种 URL 有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:45:34.067

尝试使用以下内容作为正文（即用十六进制代码替换特殊字符 - 请参阅[http://www.ascii-code.com/](http://www.ascii-code.com/)以供参考）

```
Http://hostname/default.aspx%3Fid=%7B0000000-00000-0000-00000000000%7D%26language=en 
```

你提到你已经用括号试过这个 - 但你也做了和号和问号吗？

附言。您还缺少代码中的等号。完整的代码应该是：

```
string.Format("mailto:email@address.com?subject={0}&body={1}", "Subject Message", "Http://hostname/default.aspx%3Fid=%7B0000000-00000-0000-00000000000%7D%26language=en"); 
```

示例独立 HTML：

```
<html>
    <body>
        <a href="mailto:person@host.com?subject=test&body=http://hostname/default.aspx%3Fid=%7B0000000-00000-0000-00000000000%7D%26language=en">test</a>
    </body>
</html> 
```

# php - 使用备用 ip 使用 fsock 使用 php 获取网站数据/信息

> ID：13629112
> 
> 赞同：0
> 
> 时间：2012-11-29T15:29:22.207
> 
> 标签：php, fsockopen

> **可能重复：**
> [使用 fsockopen 指定源 ip](https://stackoverflow.com/questions/4765269/specify-source-ip-using-fsockopen)

我有一个有几个 IP 地址的 VPS。我希望它像代理一样连接到网站以获取该网站。该脚本运行良好，但我需要它来使用我必须连接到不同站点的不同 IP 地址，因为网站已经设置，因此某些 IP 地址只能获取一定数量的数据。

示例：
IP1 连接到站点 1 并获取数据 1
IP2 连接到站点 1 并获取数据 2
IP3 连接到站点 1 并获取数据 3

这可能吗？

# windows-8 - 当用户从魅力设置中单击共享时，如何在 Windows 8 xaml 应用程序中共享文本框内容？

> ID：13629113
> 
> 赞同：0
> 
> 时间：2012-11-29T15:29:23.893
> 
> 标签：windows-8, windows-runtime, winrt-xaml, winrt-async

我的 Windows8 应用商店应用程序 (xaml) 应用程序中有一个文本文本框，当用户从 Charm 设置中选择共享选项时，我想使其可共享？这可能在 Windows 8 商店 xaml 应用程序中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T17:49:52.393

是的，您需要响应“DataRequested”事件并将文本框的内容添加到数据包中。这是一个代码示例：

JavaScript：

```
// Call this during initialization
function registerForShare() {
    var dataTransferManager = Windows.ApplicationModel.DataTransfer.DataTransferManager.getForCurrentView();
    dataTransferManager.addEventListener("datarequested", shareTextHandler);
}

function shareTextHandler(e) {
    var request = e.request;
    request.data.properties.title = "Your title";
    request.data.properties.description = "Description of what you're sharing";
    request.data.setText(yourTextBox.Text);
} 
```

C＃：

```
// Call this during initialization
private void ShareSourceLoad()
{
    var dataTransferManager = DataTransferManager.GetForCurrentView();
    dataTransferManager.DataRequested += DataRequested;
}

private void DataRequested(DataTransferManager sender, DataRequestedEventArgs e)
{
    DataRequest request = e.Request;
    request.Data.Properties.Title = "Your title";
    request.Data.Properties.Description = "Description of what you're sharing";
    request.Data.SetText(yourTextBox.Text);
} 
```

# c# - 我可以手动启动Win 8后台任务吗

> ID：13629119
> 
> 赞同：0
> 
> 时间：2012-11-29T15:30:00.107
> 
> 标签：c#, windows, windows-8

我在我的应用程序中使用 C#，在用户登录他的 PC 后，实时磁贴开始更新至关重要。现在更新开始时间不早于 15 分钟，因为我正在使用时间触发器进行实时磁贴更新。有什么方法可以手动触发任务，还是有其他方法可以让我的动态磁贴从用户登录系统开始更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T03:05:58.523

DispatcherTimer 可以帮助您以设定的时间间隔触发事件。您可以在 App() 构造函数中添加代码：

```
 // _dispatcherTimer is probably a class level variable.
    DispatcherTimer _dispatcherTimer;

    // How often
    uint _DoSomethingInterval = 500;

    // Set up a DispatchTimer
    _dispatcherTimer = new DispatcherTimer();
    _dispatcherTimer.Tick += DoSomething;

    // If you like lambdas, do this
    //_dispatcherTimer.Tick += (sender, object ) => 
    // { Debug.WriteLine("time passed so do something"); }

    _dispatcherTimer.Interval = new TimeSpan(0, 0, 0, 0, (int)_desiredReportInterval);

    // The callback for the timer
    private void DoSomething(object sender, object args)
    {
        Debug.WriteLine("time passed so do something"); 
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T08:35:25.357

UserPresent SystemTriggerType 可能是您所追求的。我正在考虑这样做的方式是同时拥有时间和系统触发器，因此每 15 分钟以及当用户解锁设备时。我不认为您使用 SystemTrigger 可以获得尽可能多的 CPU 时间，但总比没有好 [http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.background.systemtriggertype .aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.background.systemtriggertype.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T17:09:58.920

您不能手动调用后台任务，但您可以简单地使用您的后台任务运行的代码创建一个共享库，并直接从后台任务中调用它。然后，只要您想从应用程序手动触发它，您就可以手动调用该代码。

# jquery - jquery .remove() 没有按预期工作

> ID：13629120
> 
> 赞同：1
> 
> 时间：2012-11-29T15:30:01.237
> 
> 标签：jquery, footer, removechild

我只是想从我的主页中删除页脚。

```
if (OBJECT.Homepage.isHomePage == true){
    jQuery('footer').remove();
} 
```

似乎 .remove() 正在做更多的显示：无；而不是从 DOM 中实际删除节点。当我查看页面源时，页脚仍然存在 - 虽然它没有显示内容，但有一个很大的垂直滚动，好像页脚的高度仍然适用。

我认为这可能与使用页脚标签而不是#footer 有关，但是当我这样做时，我得到了相同的结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T15:37:59.650

```
<input type="button" value="remove footer"/>
<footer>test</footer>​ 
```

JS：

```
$("input").click(function(){$("footer").remove();})​ 
```

[http://jsfiddle.net/9unpH/](http://jsfiddle.net/9unpH/)看到这个演示。它工作正常。

> 当我查看页面源时，页脚仍然存在

我猜你正在使用鼠标右键单击 - > View Page Source 之类的东西，如果是这样的话 - 一切都是正确的。它不会包含 JS 所做的更改，只是显示它从服务器获取的内容（甚至更多 - 浏览器可能会向服务器发送另一个请求以获取 HTML 以获取查看源代码）。

尝试使用开发者工具查看 JS 所做的更改（所有浏览器按 F12，在 FF 中可能需要安装 firebug）

> 有一个大的垂直滚动，好像页脚的高度仍然适用。

假设这是因为您页面上的其他一些样式，而不是因为`footer`

# c# - 选择值大于阈值的数组的索引

> ID：13629121
> 
> 赞同：2
> 
> 时间：2012-11-29T15:30:05.037
> 
> 标签：c#, linq

我有一个双精度数组和一个阈值。我想选择我的数组中的第一个索引，其中索引处的值大于阈值。

我如何做到这一点`LINQ`？

我得到了它的工作：

```
var n = acc_avg.Select((val, index) => new {Val = val, Index = index})
               .Where(l => l.Val > threshold)
               .First()
               .Index 
```

但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T15:51:29.237

您可以使用[`Array.FindIndex`](http://msdn.microsoft.com/en-us/library/03y7c6xy.aspx)：

```
var n = Array.FindIndex(acc_avg, x => x > threshold); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T16:00:59.610

您的解决方案在我看来相当不错，但我相信如果序列中没有符合您标准的元素，它会抛出异常。我会考虑 FirstOrDefault 而不是 First 并在访问之前测试 null 。

```
var n = acc_avg.Select((val,index) => new {Val= val, Index = index}).Where(l=> l.Val > threshold).FirstOrDefault();    
if(n != null)
  DoSomething(n.Index); 
```

当然，如果您的对象已经具有索引属性（或者如果序列中的位置对您不重要），您可以将其缩短为：

```
var n = acc_avg.FirstOrDefault(l => l > threshold); 
```

但你可能知道这一点。:)

# javascript - 带有新参数的 Javascript 继承

> ID：13629123
> 
> 赞同：3
> 
> 时间：2012-11-29T15:30:09.240
> 
> 标签：javascript, class, object, inheritance

**[已编辑：并不是很好的例子`vector2d`。`vector3d`我现在使用`pt`and`ptMass`代替。]**

我一直在为此寻找答案，但似乎没有好的解决方案。

假设我有一个对象如下。

```
function pt(x,y){
    this.x = x;
    this.y = y;
} 
```

现在，我想要一个点质量，如下所示。

```
function ptMass(x,y,m){
    this.x = x;
    this.y = y;
    this.m = m;
} 
```

最好使用继承来创建`ptMass`类。

我目前正在使用以下方式来做到这一点。

```
function ptMass(x,y,m){
    pt.apply(this.arguments);
    this.m = m;
} 
```

**有没有办法做到这一点`prototype`？** 我尝试了以下方法，但它不起作用。

```
pt = function(m){this.m = m};
ptMass.prototype = new pt(); 
```

还有一个问题，使用原型继承有何进步？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T15:54:27.463

首先，为什么继承更好？
尽管我自己更喜欢组合（模块/组件和依赖注入），但我得到了几个继承参数。

其次，您可以通过以下方式重用：

```
function Vector2D (x, y) {
    this.x = x;
    this.y = y;
}

function Vector3D (x, y, z) {
    Vector2D.call(this, x, y);
    this.z = z;
} 
```

第三，在大型 JS 应用程序中，创建数万（或数百万）个多边形，额外的函数调用只会不必要地减慢它的速度。

四、不能用

```
Vector3D.prototype = new Vector2D(); 
```

首先，您没有初始化Vector2D 内部的任何内容`x`。 其次，如果您来自其他语言，则意味着保存***STATIC属性和函数。***`y`
`prototype`

 *即使您进行了初始化`Vector2D`，对于您的 Vector3D 类的每个实例，它仍然是***完全相同的 Vector2D***。

为什么不只是：

```
var point2D = function (x, y) {
        return { x : x,
                 y : y  };
    },
    point3D = function (x, y, z) {
        return { x : x,
                 y : y,
                 z : z };
    }; 
```

...当你有那些特定的构建块作为你的基本元素时，组成使用它们的不同模块？

* * *

***编辑***

```
function anObj (x, y) {
    var privateFunc = function () { return y; };

    return {
        x : x,
        method : function () { return privateFunc(); }
    };
}

var myObj = anObj(1, 2);
myObj.x;        // 1
myObj.method(); // 2 
```

这里的好处是你现在有了私有变量（`privateFunc`和`y`）。
缺点是在内存使用方面，对象的每个实例都需要拥有任何私有方法的***OWN***副本。
因此，如果您正在制作数十万个这样的对象（例如顶点/多边形），并且它们不需要具有***私有***状态，那么这不是使用的方法。

但是，如果您正在制作玩家或敌人、控制器或任何您不想被***篡改***的东西，那么您确实想要使用这样的方法（或更高级）。

如果您可能需要100% 私有的***STATIC***数据/方法，那么您应该尝试如下格式：

```
var objectMaker = (function () {
    var staticData = 32,
        staticFunc = function (num) { return num + staticData; };

    return function (x, y) {
        var privateData = 12,
            privateMethod = function (num) {
                return y + privateData + staticFunc(num);
            };

        return { x : x,
                 method : function (num) { return privateMethod(num); }
        };
    };
}());

var myObj = objectMaker(3, 4);
myObj.x;          // 3;
myObj.method(12); // 12 + y(y === 4) + privateData + staticData; 
```

所以我们在这里所做的是我们有一个立即触发的函数（它在定义后立即触发，并将函数的***值***返回给变量）。
所以在我们的特殊情况下，这个函数会立即返回我们想要用来创建新实例的*实际函数。*

*立即函数内部的私有变量和函数（不是我们返回的构造函数）是静态的，因为您创建的每个实例都可以访问该闭包*内完全相同的函数/数据。
缺点是这些静态函数无法***访问***私有（甚至是特定于实例的）数据。
这意味着您必须将值传递给静态函数，并捕获静态函数的返回，因为您不能依赖静态方法来修改实例值（从技术上讲，您可以直接修改对象/数组，如果您将它们传递给函数，否则您必须捕获返回值）。

现在您可以拥有大量在实例之间共享的辅助函数（较低的内存），同时仍然是私有和安全的。

如果您想要的是公共属性、公共方法和静态方法/属性，那么您可以像这样访问它们：

```
var Obj = function (x, y) {
    this.x = x;
    this.per_instance_method = function () { return y; };
};

Obj.prototype.staticData = { z : 32 };
Obj.prototype.staticMethod = function () { return this.x + this.staticData.z; };

var myObj = new Obj(3, 4);
myObj.staticMethod(); 
```

...只是不要期望任何原型方法可以访问任何实例的私有数据（如`y`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:56:27.950

不，您的第一个几乎是正确的：

```
function vector3d(x,y,z){
    vector2d.apply(this, arguments);
    // you might also use vector2d.apply(this, [].slice.call(arguments, 0,2));
    // or simpler vector2d.call(this, x, y);
    this.z=z;
} 
```

所以是的，你*必须*从构造函数中调用它。调用它一次以创建原型对象将正确设置继承，但会创建一个实例`vector2D`- 您既不需要也不想要它。甚至可能造成伤害。[*查看有关[不]*](https://stackoverflow.com/q/12592913/1048572)[使用“新”关键字](https://stackoverflow.com/q/12592913/1048572)[*[用于继承]*](https://stackoverflow.com/q/12592913/1048572)[的原因是什么](https://stackoverflow.com/q/12592913/1048572)**的详细答案[？](https://stackoverflow.com/q/12592913/1048572).**

 **> 有没有办法用原型做到这一点？

```
vector3d.prototype = Object.create(vector2d.prototype); 
```

将使所有实例`vector3`都从中继承的原型对象继承自 的原型对象`vector2d`。我不确定您是否需要，通常的二维方法都不适用于三维向量。

> 使用原型继承有何进步？

*   [原型继承优于经典继承的好处？](https://stackoverflow.com/q/2800964/1048572)
*   [Javascript 是一种基于原型的语言是什么意思？](https://stackoverflow.com/q/186244/1048572)***

# windows - 无法让 Docpad 在 Windows 上运行

> ID：13629124
> 
> 赞同：1
> 
> 时间：2012-11-29T15:30:10.637
> 
> 标签：windows, node.js, npm, docpad

我在让 Docpad 在 Windows 上运行时遇到问题。

我做了以下。

*   安装了最新版本的Node
*   “NPM 安装文档”
*   然后在一个空目录中输入“docpad run”

我收到一条错误消息，说“docpad”不被识别为内部或外部命令、可运行程序或批处理文件。

也许我在某个地方错过了一步？我还尝试将命令提交到节点命令提示符，并且还检查了故障排除指南并进行了一般的谷歌搜索。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T15:51:23.943

除非您使用 -g 选项安装了 NPM 模块（在 docpad 网站上没有说明，所以我怀疑您没有）该模块在您的 PATH 上不可用。

您仍然可以通过指示完整路径来运行它，例如从您运行 npm install 命令的文件夹中运行以下命令：

```
node_modules\.bin\docpad.cmd 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-18T23:40:18.603

我遇到了同样的问题，重新启动对我没有帮助。

对我有用的是通过“nodejs 命令提示符”而不是标准的 Windows 安装。

我运行 npm install -g docpad 然后导航到我的空文件夹并运行 docpad run 并且它立即工作（在与 windows 命令提示符混在一起 1 小时后）。

# javascript - Javascript 闭包和“this”

> ID：13629127
> 
> 赞同：0
> 
> 时间：2012-11-29T15:30:26.353
> 
> 标签：javascript

我的问题是......在TestObj 中的CallMeLaterTestObj 函数中，“this”是窗口对象而不是TestObj。我该如何重构它，以便在 CallMeLater 函数中我不必将调用包装`function() { v.CallMeLaterTestObj(); }`在闭包中或使用 bind 函数，因为它对较新的浏览器的支持有限。两个目标：

*   在对象内的函数调用中保留“this”
*   为每个单独的对象维护一个单独的“值”值，这样它们就不会共享相同的值。

    // 模拟公共 api、私有方法、私有变量、公共字段。

    //问题的新部分

*   重新编写以包括绑定功能和原型符号。如何将 Binding 函数移动到所有新对象都会获得的基础对象中？

*   这是我尽可能接近使用两全其美的方法。我不知道这种方法的陷阱是什么

    ```
     var BaseObject = function ()
        {
            _getBinding = function (method)
            {
                var _self = this;
                return function ()
                {
                    _self[method].apply(_self, arguments);
                };
            };
            return {
                CallInline: _getBinding
            }
        }();

        var TestObj = function (value)
            {
                $.extend(this, BaseObject);
                // public var
                this._value = value;
            };

        TestObj.prototype = function()
        {
            var privateVar = false;
            // these are private
            _giveMe = function () {
                return this._value;
            },
            _callMeLaterTestObj = function () {
                console.log('I am ' + this.constructor.name + ' my value is ' + this._value);
            };

            // public API
            return {
                GiveMe : _giveMe,
                CallMeLaterTestObj : _callMeLaterTestObj
            }

        }();

        function CallMeLater(v, i)
        {
            setTimeout(v.CallInline('CallMeLaterTestObj'), 10);
        }

        var V1 = new TestObj(1);
        var V2 = new TestObj(2);
        var V3 = new TestObj(3);

        console.log('V1= ' + V1.GiveMe());
        console.log('V2= ' + V2.GiveMe());
        console.log('V3= ' + V3.GiveMe());
        console.log('---');

        V1.CallMeLaterTestObj();

        console.log('---'); 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:16:58.200

不，你不能。这就是这样做的方法。顺便说一句，您可以轻松地[填充该`bind`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind#Compatibility)，以便它也可以在旧版浏览器中使用。

如果您知道始终需要绑定实际函数，则另一种方法是将闭包移动到原型方法中：

```
TestObj.prototype.getCallMeLaterTestObj = function () {
    var that = this;
    return function() {
        console.log('I am ' + that.constructor.name + ' my value is ' + that._value);
    };
};
setTimeout(v.getCallMeLaterTestObj(), 10); 
```

顺便说一句，您的原型没有`constructor`属性，因此日志不会按预期工作。

您唯一的机会是完全避免使用该[`this`关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)：

```
TestObj = function() {
    var privateVar = false; // these are private static
    function TestObj(value) {
        function giveMe() {
            return value;
        }
        function callMeLaterTestObj() {
            console.log('I am TestObj my value is ' + giveMe());
        }
        this._value = value;
        this.giveMe = giveMe;
        this.callMeLaterTestObj = callMeLaterTestObj;
        /* you could do this as well:
        return {
           _value: value,
           giveMe: giveMe,
           callMeLaterTestObj: callMeLaterTestObj
        }; */
    }
    return TestObj;
})();
var v = new TestObj;
setTimeout(v.callMeLater, 10); 
```

但这不是非常节省内存，因为它根本不使用原型继承。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:36:54.120

我认为您正在寻找的是：

```
function TestObj(value) {
    var _value = value;

    this.giveMe = function() {
        return _value;
    };

    this.callMeLaterTestObj = function() {
        console.log('I am ' + this.constructor.name + ' my value is ' + _value);
    };

    return this;
};

function callMeLater(v, i) {
    setTimeout(function() {
        v.callMeLaterTestObj();
    }, 10);    
}

var v1 = new TestObj(1);
var v2 = new TestObj(2);
var v3 = new TestObj(3);

console.log('V1= ' + v1.giveMe());
console.log('V2= ' + v2.giveMe());
console.log('V3= ' + v3.giveMe());
console.log('---');

callMeLater(v1, 1);
callMeLater(v2, 2);
callMeLater(v3, 3);​ 
```

要访问constructor.name，您需要使用`function name()`语法而不是`var name = function()`语法来声明函数。

要保留私有变量并公开公共 api，请将公共变量作为`this`函数中的属性公开。

确保`this`从构造函数返回以使其工作。

对类名（TestObj 是其中之一）遵循 CamelCase 的命名约定和对变量/方法/对象/等遵循 lowerCamelCase 的命名约定也是一种很好的做法。有助于清楚哪些变量是实例，哪些是类。

[测试并查看此处预期的控制台输出](http://jsfiddle.net/XfFJH/)。

**笔记**

关于`v.callMeLaterTestObj()`在 setTimeout 的闭包中包装，这种技术是完全跨浏览器兼容的。你不会有任何问题。

该`bind`方法较新，尽管有许多库会在较旧的浏览器中为您填充该方法。我个人最喜欢的是[下划线](http://underscorejs.org/#bind)。

**笔记2**

您不能在 setTimeout 中调用对象上的方法而不将其包装在某个地方的闭包中，但是如果您愿意，您可以在不使用泛型`bind`函数（如 Underscore 或 jQuery 等提供）的情况下抽象 Class 中的闭包，您可以像这样在类中“滚动你自己的”：

```
function TestObj(value) {

    var _value = value;
    var _self = this;

    this.giveMe = function() {
        return _value;
    };

    this.callMeLaterTestObj = function() {
        console.log('I am ' + this.constructor.name + ' my value is ' + _value);
    };

    this.getBinding = function(method) {
        var _self = this;
        return function() {
            _self[method].apply(_self, arguments);
        };
    };

    return this;
};

function callMeLater(v, i) {
    setTimeout(v.getBinding('callMeLaterTestObj'), 10);    
}

var v1 = new TestObj(1);
var v2 = new TestObj(2);
var v3 = new TestObj(3);

console.log('V1= ' + v1.giveMe());
console.log('V2= ' + v2.giveMe());
console.log('V3= ' + v3.giveMe());
console.log('---');

callMeLater(v1, 1);
callMeLater(v2, 2);
callMeLater(v3, 3);​ 
```

**解释：**

您需要使用*某种*绑定，因为当您将方法传递给 时`setTimeout`，您通过引用传递它。所以所有 setTimeout 看到的是一个函数——而不是它所在的对象，这就是为什么你会丢失`this`.

由于 setTimeout 将因此在默认范围内执行该函数 - 即浏览器窗口 - 您需要一种`this`通过引用返回的方法，或者通过内联匿名函数，或者通过返回使用该`apply`方法的闭包来 'reset' `this`。

**注3**

如果您想拥有自己的绑定方法，并且不包含为您提供它或将其包含在每个类中的库，那么您可以使用 Underscore 中的这个，它遵循较新浏览器中的本机方法：

```
function bind(func, context) {
  var bound, args;
  if (func.bind === nativeBind && nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));
  if (!_.isFunction(func)) throw new TypeError;
  args = slice.call(arguments, 2);
  return bound = function() {
    if (!(this instanceof bound)) return func.apply(context, args.concat(slice.call(arguments)));
    ctor.prototype = func.prototype;
    var self = new ctor;
    var result = func.apply(self, args.concat(slice.call(arguments)));
    if (Object(result) === result) return result;
    return self;
  };
}; 
```

然后像这样使用它：

```
function callMeLater(v, i) {
    setTimeout(bind(v.callMeLaterTestObj, v), 10);    
} 
```

这适用于所有浏览器。

# c# - 泛型上的 InvalidCastException

> ID：13629128
> 
> 赞同：4
> 
> 时间：2012-11-29T15:30:28.490
> 
> 标签：c#, generics, .net

来自 Java 世界，使用泛型和 C# 进行编程常常令人头疼。像这个：

```
interface ISomeObject { }
class SomeObjectA : ISomeObject { }
class SomeObjectB : ISomeObject { }

interface ISomething<T> where T : ISomeObject
{
    T GetObject();
}
class SomethingA : ISomething<SomeObjectA>
{
    public SomeObjectA GetObject() { return new SomeObjectA(); }
}
class SomethingB : ISomething<SomeObjectB>
{
    public SomeObjectB GetObject() { return new SomeObjectB(); }
}

class SomeContainer
{

    private ISomething<ISomeObject> Something;

    public void SetSomething<T>(ISomething<T> s) where T : ISomeObject
    {
        Something = (ISomething<ISomeObject>)s;
    }
}

class TestContainerSomething
{
    static public void Test()
    {
        SomeContainer Container = new SomeContainer();
        Container.SetSomething<SomeObjectA>(new SomethingA());
    }
} 
```

结果是`InvalidCastException`at `Something = (ISomething<ISomeObject>)s;`。在 Java 中，这会起作用，我什至可以使用（如果一切都失败了）泛型通配符`<?>`。这在 C# 中是不可能的。

虽然这只是我用来解释问题的一个例子，但是如何消除这个异常呢？唯一的主要约束是`SomeContainer` **不能**是泛型类

****注意****：关于这个有很多问题，但没有一个（我能找到）解决非泛型类中的泛型类成员。

****更新****

在方法内部`SetSomething`，我添加了以下几行：

```
Console.WriteLine(s.GetType().IsSubclassOf(typeof(ISomething<SomeObjectA>)));
Console.WriteLine(s.GetType().ToString() + " : " + s.GetType().BaseType.ToString());
foreach (var i in s.GetType().GetInterfaces())
{
    Console.WriteLine(i.ToString());
} 
```

令我惊讶的输出

```
False
SomeThingA : System.Object
ISomething`1[SomeObjectA] 
```

这就是我得到这个例外的原因吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T15:35:18.533

[Out](http://msdn.microsoft.com/en-us/library/dd469487.aspx)关键字将是一个修复，如果您`ISomething`只有返回 T 的方法

```
interface ISomething<out T> where T : ISomeObject 
```

创建泛型接口时，可以指定具有不同类型参数的接口实例之间是否存在隐式转换。

它被称为[协方差和逆变](http://en.wikipedia.org/wiki/Covariance_and_contravariance_%28computer_science%29)

Eric Lippert 有一个很好的[系列文章](http://blogs.msdn.com/b/ericlippert/archive/2007/10/16/covariance-and-contravariance-in-c-part-one.aspx)为什么我们需要考虑这个，这里使用[接口方差](http://blogs.msdn.com/b/ericlippert/archive/2007/10/26/covariance-and-contravariance-in-c-part-five-interface-variance.aspx)

这是我的代码，它按预期工作

```
interface ISomeObject { }
class SomeObjectA : ISomeObject { }
class SomeObjectB : ISomeObject { }

interface ISomething<out T> where T : ISomeObject
{
    T GetObject();
}
class SomethingA : ISomething<SomeObjectA>
{
    public SomeObjectA GetObject() { return new SomeObjectA(); }
}
class SomethingB : ISomething<SomeObjectB>
{
    public SomeObjectB GetObject() { return new SomeObjectB(); }
}

class SomeContainer
{

    private ISomething<ISomeObject> Something;

    public void SetSomething<T>(ISomething<T> s) where T : ISomeObject
    {
        Something = (ISomething<ISomeObject>)s;
    }
}

class TestContainerSomething
{
    static public void Test()
    {
        SomeContainer Container = new SomeContainer();
        Container.SetSomething<SomeObjectA>(new SomethingA());
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T15:47:36.143

有时让一个泛型接口实现一个非泛型接口来规避缺失是很有用的`<?>`

```
interface ISomething
{
    object GetObject();
}

interface ISomething<T> : ISomething
    where T : ISomeObject
{
    T GetObject();
}

public class SomeImplementation<T> : ISomething<T>
{
    public T GetObject()
    {
        ...
    }

    object ISomething.GetObject()
    {
        return this.GetObject(); // Calls non generic version
    }
} 
```

然后可以使用非泛型接口键入集合

```
var list = new List<ISomething>();
list.Add(new SomeImplementation<string>());
list.Add(new SomeImplementation<int>()); 
```

# javascript - 将特定于应用程序的 Backbone.js 资产嵌套在常见资产下是否有任何问题？

> ID：13629130
> 
> 赞同：0
> 
> 时间：2012-11-29T15:30:52.093
> 
> 标签：javascript, backbone.js, requirejs

我正在构建一个具有多个离散客户端应用程序的大型应用程序。我使用 Backbone.js 作为结构，使用 Require.js 来管理依赖项。

以下是我想对事物建模的方式，以便我可以为任何这些应用程序提供通用功能：

```
-- libs
-- models
-- collections
-- templates
-- views
-- apps
  -- app_one
    -- libs
    -- models
    -- collections
    -- templates
    -- views    
  -- app_two
    -- libs
    -- models
    -- collections
    -- templates
    -- views
main.js 
```

我很想知道是否有人做过类似的事情，并且我没有考虑到这个设计是否有任何明显的缺陷。

我看到的主要好处是我可以在结构的根目录中对公共库、模型、集合、模板和视图进行分组，并且任何子应用程序都可以根据需要导入它们或在它们自己的嵌套中定义应用程序特定的资产结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:13:55.337

你甚至不需要用 requirejs 嵌套任何东西。您的主库可以位于其自己的文件夹中，并且不同的应用程序也可以在硬盘驱动器的任何位置拥有自己的文件夹。唯一的问题在于您使用 requirejs 调用所有依赖项的方式，以及是否使用 r.js 将不同的应用程序捆绑在一个文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T19:50:31.233

这是有道理的，我认为大多数人都是这样做的。

我通常与此不同，因为我不分离模型/集合和视图。相反，我有一个“模块”目录。一个模块通常由具有一个或多个模型、相关集合和视图的单个文件组成。

另请注意，您最终可能会在您的 lib 文件夹中拥有多个版本的 jQuery，因为您可能有时间更新一个应用程序而不是另一个应用程序。

尽管 require.js 确实使您的结构无关紧要，但保持代码井井有条仍然是个好主意。

# objective-c - ios 从我的应用程序中启动应用程序商店导致我的应用程序终止

> ID：13629131
> 
> 赞同：1
> 
> 时间：2012-11-29T15:30:52.743
> 
> 标签：objective-c, ios, app-store

我正在尝试将 My App 的用户带到 AppStore 以获得几个不同的功能 - 例如升级到完整版、评分/评论或只是查看我开发的另一个应用程序。但是，所有这些都导致我的应用程序在设备上启动 iTunes 时终止。我正在使用一些简单的代码，并尝试了许多 URL 组合，所有这些都成功地到达了它们要去的地方。以下是行为：

*   用户点击评分应用
*   代码通过以下方式将他们定向到网络：

    ```
    [[UIApplication sharedApplication] openURL:
    [NSURL URLWithString:[[MyApp defaultApp] itunesLink]]]; 
    ```

*   我的App进入后台，成功调用了我的delegate的applicationDidEnterBackground

*   随着 iTunes 的出现，我的应用程序被终止。无论我是通过 X-Code 运行还是直接在设备上运行，都会发生这种情况。
*   当我退出商店并查看设备上正在运行的进程时，我的应用程序仍然显示在那里。我知道它已从 X-Code 控制台终止，当我尝试重新启动它时，它会重新开始。

我已经尝试将 itunesLink 作为 itms://itunes.apple.com/app/ 或 http - 所有这些都到达了正确的终点。如果我使用 www.google.com 它工作正常并且我的应用程序没有终止，只是发送到后台并且网站显示正常。

其他要点是，当我通过模拟器运行时，openURL 调用返回失败并且不打开任何 URL。

关于我的应用程序为什么会终止的任何见解？它就像一个 iOS 安全功能或关闭我的应用程序的东西，但我认为我所做的是非常标准的东西。

如果有人看到过类似的情况，我非常感谢您对这种情况提出建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:48:33.243

您的应用程序可能因多种原因而终止。最好的办法是使用 Xcode 的 Organizer 查看设备控制台：

![在此处输入图像描述](../Images/28c434f157be8ef35706986ffe36f375.png)

您的应用程序可能只是由于内存不足通知而终止。一旦它移动到后台并且应用商店启动（iTunes 和应用商店都使用大量内存），它可以被杀死以释放内存。在这种情况下，您将设置来自“jetsam”的消息，如下所示：

```
<Notice>: jetsam: kernel termination snapshot being created
<Warning>: Application 'UIKitApplication:com.yourapp[0x6337]' exited abnormally with signal 9: Killed: 9 
```

您应该使用 Instruments 中的活动监视器来查看您的应用程序正在使用多少内存。iOS 将首先终止最占用内存的应用程序，因此您应该尝试减少应用程序的内存占用。

# vba - 在工作簿之间复制和粘贴

> ID：13629134
> 
> 赞同：1
> 
> 时间：2012-11-29T15:31:10.547
> 
> 标签：vba, excel

这是一个问题，可能会或可能不会实现，但非常感谢任何建议。

是否可以打开一个包含所有数据和 vba 代码的工作簿 (wrkbookA)。单击按钮打开/导航到一个目录并选择另一个工作簿 (wrkbookB)。打开 wrkbookB，选择一列，将该列复制并粘贴到 A 列的 wrkbookA 中，然后关闭 wrkbookB。

我知道这可以使用 wrkbookB 中的常量列来实现，但数据位于 wrkbookB 中每个工作簿的不同列中。

我还查看了列标题并以这种方式进行复制，但这不是一个选项，因为不同的列具有相似的标题/单词。

感谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T17:17:16.887

由于您无法知道需要从工作簿 B 中选择哪一列，因此您将需要用户交互。既然如此，为什么不写一个 sub 来做以下事情：

1.  让用户选择要打开的工作簿 B
2.  在工作簿 B 中放置一个按钮，附加到工作簿 A 中的代码

然后，用户在工作簿 B 中选择他们想要复制的列，然后按下将该列复制到工作簿 A 的按钮并关闭工作簿 B 而不保存更改。

## 示例代码理念：

```
Workbooks.Open ...
ActiveSheet.Buttons.Add(427.5, 12.75, 104.25, 36).OnAction = "WorkBookA!MoveColumn" 
```

# eclipse - Yourkit profiler eclipse 调试模式启动

> ID：13629136
> 
> 赞同：3
> 
> 时间：2012-11-29T15:31:12.773
> 
> 标签：eclipse, profile, yourkit

我知道 yourkit 可以很容易地集成到 Eclipse 中，您可以启动程序“Profile As”，它会自动连接到 Yourkit API 和统计分析。这总是运行程序并对其进行配置文件。

现在，如果我必须在调试模式下进行。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T08:50:05.600

如果要在调试模式下启用分析，则需要在 Eclipse 运行配置中手动将 -agentpath 选项添加到 JVM 参数中。请在此处找到详细信息[http://www.yourkit.com/docs/11/help/agent.jsp](http://www.yourkit.com/docs/11/help/agent.jsp)

请注意，将调试器和分析器代理一起使用不是很安全。例如，调试器可能会挂起探查器内部线程，探查器 UI 将无法与探查器代理通信。这并不重要，但请考虑到这一点。

免责声明：我是 YourKit 开发人员。

# java - 为什么 Erlang 在所有这些小型数学基准测试中都比 Java 慢？

> ID：13629142
> 
> 赞同：35
> 
> 时间：2012-11-29T15:31:28.640
> 
> 标签：java, performance, erlang, compare

在为分布式/并发/故障转移/可扩展后端环境考虑 Java 的替代方案时，我发现了 Erlang。我花了一些时间阅读书籍和文章，其中几乎所有人（甚至是 Java 上瘾的人）都说 Erlang 在这种环境中是更好的选择，因为许多有用的东西都是开箱即用的，而且不易出错。

我确信 Erlang 在大多数情况下更快，主要是因为不同的垃圾收集策略（每个进程）、没有共享状态（b/w 线程和进程）以及更紧凑的数据类型。但是当我发现[Erlang 与 Java 数学示例的比较](http://benchmarksgame.alioth.debian.org/u64q/erlang.html)时，我感到非常惊讶，其中 Erlang 慢了几个数量级，例如从 x10 到 x100。

即使在并发任务上，也包括多个内核和单个内核。

原因是什么？我想到了这些答案：

*   在大多数任务中使用 Java 原语 (=> no heap/gc)
*   Java 代码和 Erlang 进程中的线程数相同，因此 Actor 模型在这里没有优势
*   或者只是 Java 是静态类型的，而 Erlang 不是
*   还有什么？

如果那是因为这些是非常具体的数学算法，那么任何人都可以展示更多真实/实践性能测试吗？

更新：到目前为止，我得到的答案总结说，Erlang 不是这种特定“快速 Java 案例”的正确工具，但我不清楚的事情 - 这里 Erlang 效率低下的主要原因是什么：动态类型，GC还是糟糕的原生编译？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-29T15:53:37.867

Erlang 不是为数学而构建的。它在构建时考虑到了通信、并行处理和可扩展性，因此针对数学任务对其进行测试有点像测试您的手提钻是否能给您带来耳目一新的按摩体验。

话虽如此，让我们稍微提一下：
如果您想在 JVM 中进行 Erlang 风格的编程，请查看[Scala Actors](http://www.scala-lang.org/node/242)或[Akka 框架](http://akka.io/)或[Vert.x](http://vertx.io)。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-29T15:43:56.887

除了他们真正测试的内容之外，基准测试永远不适合说任何其他内容。如果您觉得基准测试只是测试原语和经典线程模型，那您就知道了。您现在可以自信地说，Java 在原语数学以及针对这些类型问题的经典线程模型方面比 Erlang 更快。您对大量线程的性能或更多涉及的问题一无所知，因为基准测试没有对此进行测试。

如果您正在做基准测试所测试的数学类型，请使用 Java，因为它显然是适合该工作的工具。如果您想做一些高度可扩展且几乎没有共享状态的事情，请为此找到一个基准，或者至少重新评估 Erlang。

如果你真的需要在 Erlang 中做大量的数学运算，可以考虑使用 HiPE（无论如何考虑一下）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-29T16:20:03.027

正如其他答案所指出的 - Erlang 旨在有效地解决现实生活中的问题，这与基准问题有点相反。

但是我想进一步说明一个方面 - erlang 代码的简洁性（在某些情况下意味着开发的快速性），在比较基准实现之后可以很容易地得出结论。

例如，k-核苷酸基准：
Erlang 版本：[http](http://benchmarksgame.alioth.debian.org/u64q/program.php?test=knucleotide&lang=hipe&id=3)
://benchmarksgame.alioth.debian.org/u64q/program.php?test=k核苷酸&lang=hipe&id=3 Java 版本：[http ://benchmarksgame.alioth.debian.org /u64q/program.php?test=k核苷酸&lang=java&id=3](http://benchmarksgame.alioth.debian.org/u64q/program.php?test=knucleotide&lang=java&id=3)

如果您想要更多真实的基准测试，我建议您[比较摩托罗拉电信软件的 C++ 和 Erlang](http://www.slideshare.net/Arbow/comparing-cpp-and-erlang-for-motorola-telecoms-software)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-02-15T21:57:56.693

我对此很感兴趣，因为一些基准非常适合 erlang，例如基因测序。所以在[http://benchmarksgame.alioth.debian.org/](http://benchmarksgame.alioth.debian.org/)上，我做的第一件事是查看 C 和 Erlang 的反向补码实现，以及测试细节。我发现测试是有偏差的，因为它没有考虑 erlang 启动 VM /w 调度程序所需的时间，本地编译的 C 启动速度要快得多。这些基准衡量的方式基本上是： `time erl -noshell -s revcomp5 main < revcomp-input.txt`

现在基准测试显示 Java 用了 1.4 秒，而 erlang /w HiPE 用了 11 秒。运行（单线程）Erlang 代码花了我 0.15 秒，如果不考虑启动 vm 的时间，实际工作负载只用了 3000 微秒（ 0.003 秒）。

所以我不知道这是如何进行基准测试的，如果它做了 100 次，那么它是没有意义的，因为启动 erlang VM 的成本将是 x100。如果输入比给出的长很多，那是有道理的，但我在网页上看不到任何细节。为了使托管语言的基准测试更加公平，让代码（Erlang/Java）向 python（正在执行基准测试）发送一个 Unix 信号，表明它达到了启动功能。

现在抛开基准测试不谈，erlang VM 本质上只是在最后执行机器代码，Java VM 也是如此。因此，Erlang 中的数学运算不会比 Java 中花费更长的时间。

Erlang 不擅长的是需要经常改变的数据。例如链式块密码。假设您有字符“0123456789”，现在您的加密将前 2 个字符与 7 相异或，然后通过前两个相加的结果对接下来的两个字符进行异或，然后将前两个字符与当前减去的 2 个字符相异或，然后异或接下来的4个字符..等

因为 Erlang 中的对象是不可变的，这意味着每次改变它时都需要复制整个 char 数组。这就是为什么 erlang 支持称为 NIFS 的东西，它是你可以调用的 C 代码来解决这个确切的问题。事实上，Erlang 附带的所有加密（ssl、aes、blowfish..）和压缩（zlib、..）都是用 C 实现的，从 Erlang 调用 C 的成本也接近 0。

因此，使用 Erlang 可以两全其美，获得 C 的速度和 Erlang 的并行性。

如果我要以最快的方式实现反向补码，我将使用 C 编写变异代码，但使用 Erlang 编写并行代码。假设输入是无限的，我会让 Erlang 在 > `<<Line/binary, ">", Rest/binary>> = read_stream` Dispatch the block to the first available scheduler via round robin，由无限的 EC2 私有网络隐藏节点组成，每毫秒实时添加到集群中。

然后这些节点通过 NIFS 调用 C 进行处理（C 是 alioth 网站上最快的反向恭维实现），然后将输出发送回节点主控以发送到输入器。

为了在 Erlang 中实现所有这些，我必须像编写单线程程序一样编写代码，创建这段代码需要不到一天的时间。

要在 Java 中实现这一点，我必须编写单线程代码，我必须承担从托管调用到非托管调用的性能损失（因为我们显然将使用 C 实现来完成繁重的工作），然后重写以支持64 核。然后重写它以支持多个CPUS。然后再次重写它以支持集群。然后再次重写以修复内存问题。

简而言之，这就是 Erlang。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-03-10T20:25:40.377

Erlang 解决方案使用 ETS，Erlang Term Storage，它就像一个在单独进程中运行的内存数据库。由于它位于一个单独的进程中，因此必须对进出该进程的所有消息进行序列化/反序列化。我应该认为，这会导致很多缓慢。例如，如果你看一下“regex-dna”基准，Erlang 只比 Java 慢一点，而且它不使用 ETS。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-21T22:41:40.333

事实上，erlang 必须为每个值分配内存，而在 java 中，如果你希望它更快，你通常会重用变量，这意味着它对于“紧密循环”基准测试总是更快。

使用 -client 标志和盒装原语对 java 版本进行基准测试并将其与 erlang 进行比较会很有趣。

我认为使用 hipe 是不公平的，因为它不是一个活跃的项目。我很想知道是否有任何关键任务软件在此运行。

* * *

## 回答 #7

> 赞同：-8
> 
> 时间：2012-11-29T16:13:11.183

我对 Erlang 一无所知，但这似乎是一种比较苹果和橘子的方法。您必须知道，十多年来，为了将 Java 性能提高到今天的水平，我们付出了相当大的努力。

（对我来说）志愿者或小公司完成的语言实现无法超越这种努力并不奇怪。

# c# - 播放视频文件时如何显示剩余播放时间？

> ID：13629143
> 
> 赞同：1
> 
> 时间：2012-11-29T15:31:28.617
> 
> 标签：c#

例如在标签上或文本框中。这是我现在尝试使用 DirectShowLib-2005.dll 的代码

```
private void button5_Click(object sender, EventArgs e)
        {
            f = new WmvAdapter(_videoFile);
            TimeSpan ts = TimeSpan.FromTicks(f._duration);
            MessageBox.Show(ts.ToString());
            int t = 1;
            const int WS_CHILD = 0x40000000;
            const int WS_CLIPCHILDREN = 0x2000000;
            _videoFile = Options_DB.get_loadedVideo();
            FilgraphManager graphManager = new FilgraphManager();

            graphManager.RenderFile(_videoFile);
            videoWindow = (IVideoWindow)graphManager;
            videoWindow.Owner = (int)pictureBox1.Handle;
            videoWindow.WindowStyle = WS_CHILD | WS_CLIPCHILDREN;
            videoWindow.SetWindowPosition(
              pictureBox1.ClientRectangle.Left,
              pictureBox1.ClientRectangle.Top,
              pictureBox1.ClientRectangle.Width,
              pictureBox1.ClientRectangle.Height);
            mc = (IMediaControl)graphManager;
            mc.Run(); 
```

当我单击文件正在播放的按钮时，我首先在 MessageBox.Show 中看到持续时间，它显示：00:02:47.4800000

所以第一件事是持续时间是错误的，因为当我查看硬盘上的文件时，文件播放长度是：00:04:36。

我的目标是现在仅在标签上显示一些进度条或不显示进度条，以便向后播放视频。如果持续时间是 00:04:36，那么我想显示它返回 00:04:35 ... 00:04:34 等等。

变量 _duration 很长，我尝试将其转换为 TimeSpan。但是视频长度与我查看硬盘上的文件时不同。

这是我没有从 WmvAdapter 类中使用它创建的功能：

```
private void SetupGraph(string file)
        {
            ISampleGrabber sampGrabber = null;
            IBaseFilter capFilter = null;
            IBaseFilter nullrenderer = null;

            _filterGraph = (IFilterGraph2)new FilterGraph();
            _mediaCtrl = (IMediaControl)_filterGraph;
            _mediaEvent = (IMediaEvent)_filterGraph;

            _mSeek = (IMediaSeeking)_filterGraph;

            var mediaFilt = (IMediaFilter)_filterGraph;

            try
            {
                // Add the video source
                int hr = _filterGraph.AddSourceFilter(file, "Ds.NET FileFilter", out capFilter);
                DsError.ThrowExceptionForHR(hr);

                // Get the SampleGrabber interface
                sampGrabber = new SampleGrabber() as ISampleGrabber;
                var baseGrabFlt = sampGrabber as IBaseFilter;

                ConfigureSampleGrabber(sampGrabber);

                // Add the frame grabber to the graph
                hr = _filterGraph.AddFilter(baseGrabFlt, "Ds.NET Grabber");
                DsError.ThrowExceptionForHR(hr);

                // ---------------------------------
                // Connect the file filter to the sample grabber

                // Hopefully this will be the video pin, we could check by reading it's mediatype
                IPin iPinOut = DsFindPin.ByDirection(capFilter, PinDirection.Output, 0);

                // Get the input pin from the sample grabber
                IPin iPinIn = DsFindPin.ByDirection(baseGrabFlt, PinDirection.Input, 0);

                hr = _filterGraph.Connect(iPinOut, iPinIn);
                DsError.ThrowExceptionForHR(hr);

                // Add the null renderer to the graph
                nullrenderer = new NullRenderer() as IBaseFilter;
                hr = _filterGraph.AddFilter(nullrenderer, "Null renderer");
                DsError.ThrowExceptionForHR(hr);

                // ---------------------------------
                // Connect the sample grabber to the null renderer

                iPinOut = DsFindPin.ByDirection(baseGrabFlt, PinDirection.Output, 0);
                iPinIn = DsFindPin.ByDirection(nullrenderer, PinDirection.Input, 0);

                hr = _filterGraph.Connect(iPinOut, iPinIn);
                DsError.ThrowExceptionForHR(hr);

                // Turn off the clock. This causes the frames to be sent
                // thru the graph as fast as possible
                hr = mediaFilt.SetSyncSource(null);
                DsError.ThrowExceptionForHR(hr);

                // Read and cache the image sizes
                SaveSizeInfo(sampGrabber);

                //Edit: get the duration
                hr = _mSeek.GetDuration(out _duration);
                DsError.ThrowExceptionForHR(hr);
            }
            finally
            {
                if (capFilter != null)
                {
                    Marshal.ReleaseComObject(capFilter);
                }
                if (sampGrabber != null)
                {
                    Marshal.ReleaseComObject(sampGrabber);
                }
                if (nullrenderer != null)
                {
                    Marshal.ReleaseComObject(nullrenderer);
                }
                GC.Collect();
            }
        } 
```

在我将其转换为 TimeSpan 之前的持续时间在变量 _duration: 1674800000 我尝试了很多示例和东西，但我离 TimeSpan 转换不远了。

请问我该怎么做？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T21:09:04.720

这个问题似乎相关：[使用 DirectShow 确定音频文件的长度](https://stackoverflow.com/questions/2205122/determine-length-of-audio-file-using-directshow)

那里的答案是：

> GetDuration 返回一个 64 位整数值，表示播放文件需要多长时间。
> 
> 您将需要调用 GetTimeFormat 方法来找出持续时间的单位。最可能的默认值是 TIME_FORMAT_MEDIA_TIME，即 10 微秒。
> 
> 在这种情况下，您可以将持续时间除以 10*1000*1000 以获得秒数。
> 
> 如果要强制使用单位，也可以在调用 GetDuration 之前调用 SetTimeFormat。

所以在你的情况下，我会用`GetTimeFormat()`它来计算单位并用它来将它转换为`TimeSpan`对象的正确单位。

# google-apps-script - 对于具有相同索引值的行，将数据从一个文件复制到另一个文件

> ID：13629145
> 
> 赞同：1
> 
> 时间：2012-11-29T15:31:33.983
> 
> 标签：google-apps-script, google-sheets

我试图寻找以前的答案，但我找到的脚本都不能满足我的需要。

我有两个 Google 电子表格：

源文件`file2`有 8 列。第一列是`offernumber`： ![http://i.stack.imgur.com/BnV6S.png](../Images/27242bda1c88372409f60054083c4a28.png)

另一个电子表格`file1`具有相应的 `ordernumber`列。 ![http://i.stack.imgur.com/QYqiE.png](../Images/414a57fbd73b6c033b99aba5c73517ad.png)

在匹配`ordernumber`到的地方`offernumber`，我需要一种自动的方式将数据复制`file 2`到`file 1`.

当我在电子表格中输入查询时，我设法手动复制了值，例如：

```
=QUERY( ImportRange( "keyspreadsheet" ;"Sheet1!A2:H1000"),
        "select Col2,Col3,Col4,Col5,Col6,Col7,Col8 where Col1='6/2012' ";0) 
```

但我无法弄清楚如何编写脚本。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T05:17:03.537

您可以完全使用电子表格功能完成此操作，无需脚本。（虽然我认为脚本会更有效地处理非常大的电子表格。）

在 file1 中，将此函数放在单元格 AG2 中，将“keyspreadsheet”的两个实例替换为 file2 的 ID，然后复制到 AG 列中的其余行：

```
=index(ImportRange( ʺkeyspreadsheetʺ ;ʺSheet1!$B$2:$Hʺ),match(AF2,ImportRange( ʺkeyspreadsheetʺ ;ʺSheet1!$A$2:$Aʺ),0)) 
```

这将在 File2 中找到 A 列中的值与 File1 列 AF 中的 ordernumber 匹配的行，并从整行中复制值，从 B 列开始（因此跳过“Offer N.”）。结果如下所示：

![具有导入匹配行的 File1](../Images/69957175d0f1b495e8181745eb7e3d41.png)

# xslt - 将模板应用于一段文本中的元素？

> ID：13629146
> 
> 赞同：1
> 
> 时间：2012-11-29T15:31:36.447
> 
> 标签：xslt

如果我有以下 XML 文档...

```
<?xml version="1.0"?>
<document>
  <title>Foobar</title>
  <article>
    Phasellus ultrices arcu suscipit velit laoreet eu dignissim 
    dolor pulvinar. Proin ac libero a diam laoreet iaculis nec eu risus.

    <ref url="http://en.wikipedia.org/wiki/FooBar">Foobar</ref> potenti. 
    Duis placerat laoreet est nec fringilla. Quisque vitae semper erat.
  </article>
</document> 
```

...我如何将`article`元素翻译成以下内容？

```
<p>
  Phasellus ultrices arcu suscipit velit laoreet eu dignissim 
  dolor pulvinar. Proin ac libero a diam laoreet iaculis nec eu risus.

  <a href="http://en.wikipedia.org/wiki/FooBar">Foobar</a> potenti. 
  Duis placerat laoreet est nec fringilla. Quisque vitae semper erat.
</p> 
```

具体来说，这是我感兴趣的翻译，因为它嵌入在纯文本块中`ref`。`a`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T15:59:25.973

如果您在标准 XSTL 身份转换的基础上构建，这是一个简单的任务，您只需要一个模板来匹配一个**ref**元素并输出一个**a**元素。

```
<xsl:template match="ref">
   <a>
      <xsl:apply-templates select="@*|node()"/>
   </a>
</xsl:template> 
```

并替换属性，然后你有另一个模板

```
<xsl:template match="ref/@url">
   <xsl:attribute name="href">
      <xsl:value-of select="." />
   </xsl:attribute>
</xsl:template> 
```

请注意，如果您的**ref**元素保证始终具有**url**属性，您还可以将这两个模板简化为一个，如下所示：

```
<xsl:template match="ref">
   <a href="{@url}">
      <xsl:apply-templates select="node()"/>
   </a>
</xsl:template> 
```

然后，您将添加其他模板以根据需要替换任何其他元素，例如将**article**更改为**p**，以及不输出**title**元素的模板。

这是完整的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="/document">
         <xsl:apply-templates />
   </xsl:template>

   <xsl:template match="title" />

   <xsl:template match="article">
      <p>
         <xsl:apply-templates />
      </p>
   </xsl:template>

   <xsl:template match="ref">
      <a>
         <xsl:apply-templates select="@*|node()"/>
      </a>
   </xsl:template>

   <xsl:template match="ref/@url">
      <xsl:attribute name="href">
         <xsl:value-of select="." />
      </xsl:attribute>
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

应用于您的示例 XML 时，将输出以下内容

```
<p>
    Phasellus ultrices arcu suscipit velit laoreet eu dignissim 
    dolor pulvinar. Proin ac libero a diam laoreet iaculis nec eu risus.

    <a href="http://en.wikipedia.org/wiki/FooBar">Foobar</a> potenti. 
    Duis placerat laoreet est nec fringilla. Quisque vitae semper erat.
  </p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T12:32:28.720

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"> 

<xsl:template match="/">
<xsl:apply-templates select="document"/>
</xsl:template>

<xsl:template match="document">
<document>
<xsl:apply-templates/>
</document>
</xsl:template>

<xsl:template match="title">
<xsl:copy-of select="."/>
</xsl:template>

<xsl:template match="article">
<p>
<xsl:apply-templates/>
</p>
</xsl:template>

<xsl:template match="ref">
<a>
<xsl:attribute name="href">
<xsl:value-of select="@url"/>
</xsl:attribute>
<xsl:apply-templates/>
</a>
</xsl:template>
</xsl:stylesheet> 
```

# java - 来自 Servlet 的有效 URL 出现 404 错误

> ID：13629148
> 
> 赞同：1
> 
> 时间：2012-11-29T15:31:41.060
> 
> 标签：java, jsf

我有一个项目到期（实际上是过度的）学校，但不能让一些简单的工作。

我正在运行 Netbeans 7.2.1、Glassfish 3.1.2.2 和最新的 Java JDK。

我有四个 JSF 页面，index.xhtml ItemAdd.xhtml、ItemCatalog.xhtml 和 ItemDetail.xhtml 以及一个 servlet SessionServlet。我已经验证我可以直接访问每个页面，即

```
http://localhost:8080/CMIS440Spitzer-Project2/faces/ItemDetail.xhtml 
```

作品。但是，当我从其中一个 JSF 页面转到我的 servlet 并转发请求时，我收到 glassfish 404 错误。

这是我进行转发的极其简单的 servlet 代码：

```
if (request.getParameter("target").contains("Add Item")) {
        String URL = request.getContextPath() + "/faces/ItemAdd.xhtml";
        System.out.print(URL);
        RequestDispatcher dispatcher = request.getRequestDispatcher(URL);
        dispatcher.forward(request, response);
    } 
```

一个控制台我得到以下内容，我可以将其粘贴到我的浏览器中并且它可以工作：

```
INFO: /CMIS440Spitzer-Project2/faces/ItemAdd.xhtml 
```

由于我收到控制台消息，我知道请求正在到达 servlet，并且它正在访问正确的代码块，并且因为我收到 Glassfish 404 错误，我知道它正在正确端口上转发到我的机器。

RequestDispatcher 有什么问题？为什么这不起作用？

谢谢。

```
<rant> 
```

这比这个问题包含更多，但我使用过 PHP、perl、C++、C、Java 和其他一些。我以前从来没有感觉到一种语言（在这种情况下是 Java 的 JSF 实现）正在积极地试图让我的生活尽可能地困难。例如，这个环境中许多需要的东西都是以映射的形式：需要所有请求参数的列表，你得到一个映射，需要一个所有会话参数的列表，你得到一个映射等。但是在 JSF 中你不能轻易循环地图！为什么，因为它很慢。我发现一个链接基本上是来自 Java 开发人员的 Mea Culpa，他提到这将是 O(N) 速度，所以它会很慢。换句话说，Java JSF 开发人员预先优化了我的代码并要求我将映射转换为列表。

在这一点上，我遇到了一些关于反射和访问私有方法/属性的奇怪错误，而现在——我在代码中的什么地方做任何类似的事情。我使用标准的 getter/setter 来返回地图键集。

甚至不要让我开始了解 getter/setter 的命名约定（大写转换为小写，在前面添加一个 get/set）

也许是我，但整个设置似乎过于迟钝，难以理解并且不必要地复杂。

感谢您阅读我的咆哮。我在这种方式上的时间比我认为的要长，而且在尝试做简单的事情时几乎要流泪。

```
</rant> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:38:36.787

为什么要混合用于会话管理和 JSF 页面的 servlet？使用 JSF 时，您必须停止考虑 http 请求/响应范式，它是一个事件驱动的框架，与桌面 GUI 编程有更多的共同点。诚然，JSF*不是*最友好的 Web 框架，但是您让它变得比它需要的更复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:47:04.160

您传递到的路径[`getRequestDispatcher`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getRequestDispatcher%28java.lang.String%29)是相对于上下文根的。

通过向其添加上下文路径，您将`/CMIS440Spitzer-Project2/CMIS440Spitzer-Project2/faces/ItemAdd.xhtml`得到不存在的 。

（实际上，如果它以斜线开头，它是相对于上下文根的，就像这个一样。如果它不以斜线开头，它是相对于 servlet。）

# r - 在 R 中使用嵌套循环加速蒙特卡罗模拟

> ID：13629149
> 
> 赞同：0
> 
> 时间：2012-11-29T15:31:44.480
> 
> 标签：r, nested-loops, montecarlo

我想加快 DEA 估计的以下蒙特卡罗模拟

```
A<-nrow(banks)
effm<-matrix(nrow=A, ncol=2)
m<-20
B<-100

pb <- txtProgressBar(min = 0,
                     max = A, style=3)
for(a in 1:A) {
  x1<-x[-a,]
  y1<-y[-a,]
  theta=matrix(nrow=B,ncol=1) 

  for(i in 1:B){

    xrefm<-x1[sample(1:nrow(x1),m,replace=TRUE),]
    yrefm<-y1[sample(1:nrow(y1),m,replace=TRUE),]
    theta[i,]<-dea(matrix(x[a,],ncol=3),
                   matrix(y[a,],ncol=3),
                   RTS='vrs',ORIENTATION='graph',
                   xrefm,yrefm,FAST=TRUE)
  }

  effm[a,1]=mean(theta)
  effm[a,2]=apply(theta,2,sd)/sqrt(B)
  setTxtProgressBar(pb, a) 
}
close(pb)
effm 
```

一旦 A 变大，模拟就会冻结。我从在线研究中了解到，apply 函数可以快速加速此类代码，但不确定如何在上述过程中使用它。

任何帮助/方向将不胜感激

巴里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:55:40.900

以下应该更快....但是如果您在 A 很大时锁定，则可能是内存问题，并且以下内容更占用内存。更多信息，例如是什么`banks`、是什么`x`、您从`y`哪里获得`dea`以及目的是什么会有所帮助。

基本上我所做的就是尽可能多地走出内循环。越短，你就会越好。

```
A <- nrow(banks)
effm <- matrix(nrow = A, ncol = 2)
m <- 20
B <- 100
pb <- txtProgressBar(min = 0,
                     max = A, style=3)
for(a in 1:A) {
  x1 <- x[-a,]
  y1 <- y[-a,]
  theta <- numeric(B)
  xrefm <- x1[sample(1:nrow(x1), m * B, replace=TRUE),] # get all of your samples at once
  yrefm <- y1[sample(1:nrow(y1), m * B, replace=TRUE),]
  deaX <- matrix(x[a,], ncol=3)
  deaY <- matrix(y[a,], ncol=3)

  for(i in 1:B){
    theta[i] <- dea(deaX, deaY, RTS = 'vrs', ORIENTATION = 'graph',
                   xrefm[(1:m) + (i-1) * m,], yrefm[(1:m) + (i-1) * m,], FAST=TRUE)
  }

  effm[a,1] <- mean(theta)
  effm[a,2] <- sd(theta) / sqrt(B)
  setTxtProgressBar(pb, a) 
}
close(pb)
effm 
```

# maven - Maven：如何跳过中央仓库中存在的构建工件？

> ID：13629170
> 
> 赞同：0
> 
> 时间：2012-11-29T15:33:14.610
> 
> 标签：maven

我的情况：我有一个包含几个 Maven 模块的项目。我对其中之一进行了更改。我突然发现，由于其他模块的错误，我的项目不再可能构建。为了解决这个问题，我需要运行 SVN UPDATE 并重建项目。

我的假设：可能，在我的模块的构建过程中，一些工件来自中央存储库并具有最新版本，而其他工件仍然过时并来自我的本地存储库。

一个问题：我不想在每次有人更新另一个 Maven 模块时重建我的项目。我想从中央存储库下载已经构建的工件，而不是自己重建它们。是否可以？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:29:34.673

你可以告诉 Reactor 要构建哪些模块。在您只更改单个模块并希望加快构建速度的情况下，您可以将 -pl （项目位置）参数传递给 maven。例如：

```
mvn -pl module-with-changes 
```

这将构建单个模块，同时从本地 Maven 存储库获取其他依赖项或从 Central 下载（无论是最新的）。也就是说，如果您已经为整个项目运行了 mvn install 并且其他工件尚未在中央存储库中更新，那么 Maven 会将您的本地工件视为最新并且不会重新下载它们。

使用 -pl 参数可能会遇到的另一个问题是，当您的项目中的其他模块依赖于您正在构建的模块时。如果依赖模块中存在问题，您将不会通过仅构建依赖模型来看到它。为避免这种情况，您可以通过 -amd （也使依赖项）。像这样：

```
mvn -pl module-with-changes -amd 
```

这将触发带有更改的模块+依赖于带有更改的模块+它们的依赖项的模块的构建。

您可以从此处获取有关 Reactor 参数的更多信息：http: [//www.sonatype.com/people/2009/10/maven-tips-and-tricks-advanced-reactor-options/](http://www.sonatype.com/people/2009/10/maven-tips-and-tricks-advanced-reactor-options/)

# amazon-s3 - 上传到 Amazon s3 时如何保留文件日期/时间戳？

> ID：13629171
> 
> 赞同：4
> 
> 时间：2012-11-29T15:33:15.463
> 
> 标签：amazon-s3

每当我们将文件上传到 S3（使用 cloudberry 之类的客户端）时，文件日期都会更改为上传日期。有没有办法保持当前的日期/时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-04T19:50:24.317

您不能更改 LastModified 字段。但是您可以添加自定义元数据（亚马逊称之为“用户元数据”）来存储信息：[http ://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMetadata.html](http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMetadata.html)

您可以在此处存储日期，然后使用 S3 API 检索它。

# java - 使用 Eclipse 导入项目时出错：JavaCC

> ID：13629173
> 
> 赞同：3
> 
> 时间：2012-11-29T15:33:21.167
> 
> 标签：java, eclipse, m2eclipse

每次我想在 Eclipse 中导入一些 Maven 项目时，我都会收到此错误：

![花式错误](../Images/4cbdc5f322c9fe05fd28b363ba09fce9.png)

我已经为 Eclipse 安装了 JavaCC 插件和 CheckStyle，但我无法通过这个，因为如果我稍后通过解析完成，许多项目将不会显示或检测不到源文件夹。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T00:22:12.100

[您可以尝试从https://github.com/objectledge/maven-extensions](https://github.com/objectledge/maven-extensions)安装 m2e javacc 连接器。

连接器在[http://objectledge.org/confluence/display/TOOLS/javacc-maven-plugin+connector中描述](http://objectledge.org/confluence/display/TOOLS/javacc-maven-plugin+connector)

稳定的 p2 更新站点位于： http: [//objectledge.github.com/maven-extensions/connectors/updates/milestones](http://objectledge.github.com/maven-extensions/connectors/updates/milestones)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-01T07:22:53.613

无法在 Eclipse Neon 中安装该插件...

而[javacc-maven-plugin](http://central.maven.org/maven2/org/codehaus/mojo/javacc-maven-plugin/2.6/javacc-maven-plugin-2.6.jar)也提供了依赖项。

# java - 绘制方法 java - 带轮廓的矩形

> ID：13629192
> 
> 赞同：3
> 
> 时间：2012-11-29T15:34:33.700
> 
> 标签：java, graphics, paint, fill, rectangles

我想创建一堵蓝线轮廓和黑色填充的墙。我现在只有一面蓝色的墙，我尝试了几种图形方法，但没有奏效。

```
public void paint(Graphics g) {
    g.setColor(Color.blue);
    g.fillRect(x, y, size, size);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T15:38:15.930

用于[`Graphics#drawRect`](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics.html#drawRect%28int,%20int,%20int,%20int%29)绘制轮廓：-

```
g.setColor(Color.black);
g.fillRect(x, y, size, size);
g.setColor(Color.blue);
g.drawRect(x, y, size, size); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T15:44:24.477

首先，覆盖`paintComponent`，而不是`paint`。其次，没有必要像那样重新发明轮子。相反，使用现有的 Swing 组件（例如`JPanel`），

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.FlowLayout;
import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class Main 
{
    public static void main(String[] args) 
    {        
        SwingUtilities.invokeLater(new Runnable(){
            @Override
            public void run() {
                createAndShowGUI();             
            }
        });
    }

    private static void createAndShowGUI()
    {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(new FlowLayout());
        frame.add(getWallComponent());
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    private static JPanel getWallComponent()
    {
        JPanel panel = new JPanel();

        panel.setBackground(Color.black);
        panel.setBorder(BorderFactory.createLineBorder(Color.blue, 5));
        panel.setPreferredSize(new Dimension(200, 200)); // for demo purposes only

        return panel;
    }
} 
```

![在此处输入图像描述](../Images/900e6849973edce24ae206d1e8813586.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T15:37:53.113

只需在蓝色矩形上绘制另一个矩形，比蓝色矩形小，如下所示

```
public void paint(Graphics g) {
    g.setColor(Color.blue);
    g.fillRect(x, y, size, size);
    g.setColor(Color.black);
    g.fillRect(x-width/2,y-width/x,size-width,size-with);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-17T11:30:14.943

```
package painting;

import java.awt.*;
import javax.swing.*;

public class RectangleOutline extends JPanel {

    int x = 100;
    int y = 200;

    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        outline(g);
    }

    public void outline(Graphics g) {
        super.paintComponent(g);
        Graphics2D g2 = (Graphics2D) g;
        g2.setColor(new Color(255, 0, 0));
        g2.fillRect(x, y, 30, 30);

        g2.setStroke(new BasicStroke(5));
        g2.setColor(new Color(0, 0, 0));
        g2.drawRect(x, y, 30, 30);
    }

    public static void main(String[] args){
        JFrame f = new JFrame();
        RectangleOutline graphics = new RectangleOutline();
        f.add(graphics);
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.setVisible(true);
        f.setSize(400, 400);

    }
} 
```

# macos - 调用 IOHIDDeviceOpen 时，守护程序用户如何在不获取 kIOReturnNotPrivileged 的 情况下访问 HID 设备

> ID：13629199
> 
> 赞同：2
> 
> 时间：2012-11-29T15:35:04.623
> 
> 标签：macos, hid, hidapi

我正在使用 hidapi 访问 HID 设备（**不是鼠标或键盘**）。要支持的最旧的操作系统版本是 10.6，我目前使用的是 Mac OX X 10.6.8。如果我的 Mac OS X 可执行文件以普通用户权限运行，它可以枚举设备，识别要由其供应商和产品 ID 使用的设备，然后像这样打开它：

```
IOHIDDeviceRef os_dev = ...
IOReturn ret = IOHIDDeviceOpen(os_dev, kIOHIDOptionsTypeNone);
if (ret == kIOReturnSuccess) { ... } // here I get kIOReturnNotPrivileged for daemon 
```

实际上可执行文件应该作为守护进程运行，但随后`IOHIDDeviceOpen`失败并显示`kIOReturnNotPrivileged`. 对于 Linux，我通过 udev 规则绕过了热插拔脚本触发的类似问题，从而更改了新连接（匹配）设备的权限。我想坚持守护进程用户。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-05T17:26:27.997

如果您的应用程序没有沙盒化，则您不需要任何权利，所以听起来这不是您的问题。并且该应用程序是否是守护程序也无关紧要。

相关的是操作系统是否将您的设备视为键盘。为了降低键盘记录器滥用的风险，OS X 要求任何想要直接与键盘对话的应用程序都必须以 root 身份运行。不幸的是，许多非键盘 HID 设备将自己呈现为键盘（例如无线演示者遥控器）。这可能就是你所看到的。

您可以通过以 root 身份运行来解决此问题，或者，如果您可以控制硬件本身，则可以将其使用页面值更改为 7（键盘）以外的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T10:44:54.857

我打开了 Apple Developer Support Ticket 并得到了一些答案。问题不在于我的应用程序作为用户“守护进程”运行。至少，不完全是……

应用程序必须以经过身份验证的（登录交互式）用户或“root”身份运行。所以，如果我可以作为“守护进程”登录，它可能会运行。实际上，这并没有帮助。我需要一个（launchd）守护进程，因为我的应用程序的功能是一种可通过网络访问的服务器。因此，我必须以用户“root”身份运行应用程序——无论如何，这对于 lauchd 守护进程来说都是危险的默认设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T00:04:08.780

IIRC Lion 将必要的 priv 提升了一个档次……现在你需要一个[沙盒权利](https://developer.apple.com/library/mac/#documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/AboutEntitlements.html)；可能是“com.apple.security.device.usb”。

# mysql - 多个处理程序冲突

> ID：13629204
> 
> 赞同：1
> 
> 时间：2012-11-29T15:35:18.957
> 
> 标签：mysql, sql, stored-procedures

我有嵌套的游标循环，我想在外循环上捕获错误 1329，没有数据提取。我怎样才能做到这一点？

我尝试为这个外部循环游标添加第二个 CONTINUE HANDLER，但它会捕获嵌套循环错误（不需要），并且最终不会触发嵌套处理程序。

我有这个：

```
DECLARE cur1 CURSOR FOR select data, valor_split, valor_div from tbl1 where data >= primeira_mov and id_papel = idpapel order by data DESC;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;
DECLARE CONTINUE HANDLER FOR 1329 BEGIN
        SET nodata_issue = 1;
        SET dateof_issue = datasplit;
    END; 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:24:51.663

进入内部循环时将标志设置为 1，离开时将其设置为 0。

然后：

```
DECLARE CONTINUE HANDLER FOR 1329 BEGIN
    IF flag_innerloop = 0 THEN do_something;
    ELSE do_something_else;

END; 
```

# css - 如何在此滑块中对齐此图片旁边的文本

> ID：13629209
> 
> 赞同：-1
> 
> 时间：2012-11-29T15:35:25.890
> 
> 标签：css, twitter-bootstrap, carousel

我买了这个滑块：[OnebyOne Slider](http://codecanyon.net/item/jquery-onebyone-slider-plugin/684613)，但我在编辑它时遇到了问题。正如你[在这里](http://www.donvos.nl/stack)看到的，我在对齐方面遇到了问题。我想把文字放在图片旁边。

有人知道如何正确对齐吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T20:47:54.520

我只能重复@vlex 写的内容——在你的样式表中添加类似下面的 CSS：

```
.text3, .text {
  top: -60px;
} 
```

对我来说很好。一个更明智的解决方案是将没有图像的标题包装在 a 中`div`并将其定位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:39:47.067

你为什么不只使用简单的 CSS 并添加类似的东西`style="position:relative; top:-100px (or whatever works for you);"`

干杯!

# java - ContentProposalAdapter 接受通过键盘而不是鼠标选择的建议

> ID：13629211
> 
> 赞同：2
> 
> 时间：2012-11-29T15:35:29.917
> 
> 标签：java, eclipse, swt, rcp

我正在合作`ContentProposalAdapter`向表格中的单元格提出建议。

当我使用键盘时（通过键盘选择哪个建议并按 Enter），表格单元格中的值将被替换（由于`adapter.setProposalAcceptanceStyle(ContentProposalAdapter.PROPOSAL_REPLACE)`）。

但是当我双击提案时，单元格中的值保持不变。有什么解决办法吗？

请注意，RCP 应用程序基于 3.4.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T17:03:25.580

上述场景在 3.7.0 中运行。我不确定 3.4.0

示例测试代码：

```
public class ContentProposalTest {

  public static void main(String[] args) {

    final Display display = new Display();
    final Shell shell = new Shell(display);
    shell.setLayout(new GridLayout(1, false));
    IContentProposalProvider proposalProvider = new SimpleContentProposalProvider(new String[]{"Test","Test1","Test2","Test4"});
    Control text = new Text(shell, SWT.BORDER);
    ContentProposalAdapter adapter = new ContentProposalAdapter(text, new TextContentAdapter(), proposalProvider, null, null);
    adapter.setProposalAcceptanceStyle(ContentProposalAdapter.PROPOSAL_REPLACE);
    shell.open();
    while (!shell.isDisposed()) {
        if (!display.readAndDispatch()) {
            display.sleep();
        }
    }
    display.dispose();
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T08:28:49.223

我用 解决了同样的问题`ContentProposalAdapter`，但是我使用的是 JFace 3.8（似乎是最新的，在 Eclipse 4.2 Juno 中使用）。您最初的问题可能不是这种情况，但我会试一试。

基本上，文本内容提议与鼠标事件一起正常工作，[sambi reddy](https://stackoverflow.com/a/13630905/1969277)提供的示例将证明这一点。

但是，当 Text 在 Table 内用作 CellEditor 时，内容建议弹出窗口会在您通过鼠标单击选择其中一个建议后立即关闭。在我的情况下，它是由 CellEditor 的“FocusOut”侦听器引起的，每当您将焦点移出单元格时，它都会**提交编辑的值。**当然，这种行为看起来很自然。然而，除了提交之外，它还**处理**了底层的 Text 控件。问题是内部使用的弹出窗口`ContentProposalAdapter`正在侦听它建议的控制处置，并在发生这种情况时自行关闭。就是这样。

**因此，在这种特殊情况下**，明显的解决方案是：避免提交 CellEditor 值，并且如果内容提议弹出窗口打开，则不释放底层控制，可以通过`contentProposalAdapter.isProposalPopupOpen()`.

# php - 使用 RecursiveArrayIterator 获取所有父节点

> ID：13629214
> 
> 赞同：0
> 
> 时间：2012-11-29T15:35:35.170
> 
> 标签：php, optimization, spl

本质上，我想使用

```
$foo = new RecursiveIteratorIterator(new RecursiveArrayIterator($haystack)); 
```

方法论，但不是返回一个平面数组，`foreach()`而是保留结构，但只返回一个曾孙节点及其父节点。这在PHP中可能吗？

* * *

我的任务是优化我公司的一些（可怕的）代码库。我找到了一个通过数组递归搜索键的函数。我*不能*用简单的`array_search()`or替换它，`array_key_exists()`因为自定义函数还返回匹配（找到）键的父节点，而不仅仅是 a `true`or `false`。

我如何使用或失败`RecursiveArrayIterator`，`RecursiveIteratorIterator`其他内置函数（即尽可能少的自定义代码）从搜索数组返回与其父树匹配的节点？我想获得最快的函数，因为目前这个函数需要 8 秒执行 14000 次，因此我需要使用内置函数。

我现有的尝试（下）非常慢。

```
function search_in_array($needle, $haystack) {
    $path = array();

    $it = new RecursiveArrayIterator($haystack);
    iterator_apply($it, 'traverse', array($it, $needle, &$path));

    return $path;
}

function traverse($it, $needle, &$path) {
    while($it->valid()) {
        $key = $it->key();
        $value = $it->current();

        if(strcasecmp($value['id'], $needle) === 0) {
            $path[] = $key;
            return;
        } else if($it->hasChildren()) {
            $sub = null;
            traverse($it->getChildren(), $needle, &$sub);
            if($sub) {
                $path[$key] = $sub;
            }
        }

        $it->next();
    }
} 
```

的示例输出`$needle = TVALL`如下所示：

```
Array (
    [HOMECINEMA] => Array (
        [children] => Array (
            [HC-VISION] => Array (
                [children] => Array (
                    [0] => TVALL
                )
            )
        )
    )
) 
```

搜索数组看起来像这样（对不起，太庞大了）。有两个以上的顶级节点，但为简洁起见，我将其截断：

```
Array(2) (
    [HOMECINEMA] => Array (
        [id] => HOMECINEMA
        [position] => 2
        [title] => TV & Home Cinema
        [children] => Array (
            [HC-VISION] => Array (
                [id] => HC-VISION
                [title] => LCD & Plasma
                [children] => Array (
                    [TVALL] => Array (
                        [id] => TVALL
                        [title] => All TVs
                    )
                    [LCD2] => Array (
                        [id] => LCD2
                        [title] => LCD/LED TVs
                    )
                    [PLASMA] => Array (
                        [id] => PLASMA
                        [title] => Plasma TVs
                    )
                    [3DTV] => Array (
                        [id] => 3DTV
                        [title] => 3D TV
                    )
                    [LED] => Array (
                        [id] => LED
                        [title] => SMART TVs
                    )
                    [PROJECTORS] => Array (
                        [id] => PROJECTORS
                        [title] => Projectors
                    )
                    [SYS-HOMECINEMATV] => Array (
                        [id] => SYS-HOMECINEMATV
                        [title] => TV Home Cinema Systems
                    )
                )
            )
            [HC-SEPARATES] => Array (
                [id] => HC-SEPARATES
                [title] => Home Cinema Separates
                [children] => Array (
                    [DVDRECORDERS] => Array (
                        [id] => DVDRECORDERS
                        [title] => DVD Recorders
                    )
                    [HDDVD] => Array (
                        [id] => HDDVD
                        [title] => Blu-ray
                    )
                    [AVRECEIVERS] => Array (
                        [id] => AVRECEIVERS
                        [title] => AV Receivers
                    )
                    [DVDPLAYERS] => Array (
                        [id] => DVDPLAYERS
                        [title] => DVD Players
                    )
                    [FREEVIEW] => Array (
                        [id] => FREEVIEW
                        [title] => Digital Set Top Boxes
                    )
                    [DVDPACKAGESYSTEMS-3] => Array (
                        [id] => DVDPACKAGESYSTEMS-3
                        [title] => 1 Box Home Cinema Systems
                    )
                    [HOMECINEMADEALS] => Array (
                        [id] => HOMECINEMADEALS
                        [title] => Home Cinema System Deals
                    )
                )
            )
            [SPEAKER2] => Array (
                [id] => SPEAKER2
                [title] => Speakers
                [children] => Array (
                    [SPEAKERPACKAGES] => Array (
                        [id] => SPEAKERPACKAGES
                        [title] => Speaker packages
                    )
                    [SOUNDBARS] => Array (
                        [id] => SOUNDBARS
                        [title] => Soundbars
                    )
                    [CENTRES] => Array (
                        [id] => CENTRES
                        [title] => Centres
                    )
                    [SUBWOOFERS] => Array (
                        [id] => SUBWOOFERS
                        [title] => Subwoofers
                    )
                    [FLOORSTANDING] => Array (
                        [id] => FLOORSTANDING
                        [title] => Floorstanders
                    )
                    [INSTALLATIONSPEAKERS] => Array (
                        [id] => INSTALLATIONSPEAKERS
                        [title] => Installation Speakers
                    )
                    [STAND-MOUNT] => Array (
                        [id] => STAND-MOUNT
                        [title] => Bookshelf Speakers
                    )
                )
            )
            [HC-ACCYS] => Array (
                [id] => HC-ACCYS
                [title] => Accessories
                [children] => Array (
                    [AVESSENTIALS] => Array (
                        [id] => AVESSENTIALS
                        [title] => AV Interconnects
                    )
                    [PLASMALCDSTANDSBRACKETS1] => Array (
                        [id] => PLASMALCDSTANDSBRACKETS1
                        [title] => TV Accessories
                    )
                    [RACKS] => Array (
                        [id] => RACKS
                        [title] => TV Racks
                    )
                    [HIFIRACKS] => Array (
                        [id] => HIFIRACKS
                        [title] => HiFi Racks
                    )
                    [PROJECTORACCYS] => Array (
                        [id] => PROJECTORACCYS
                        [title] => Projector Screens/Accessories
                    )
                )
            )
        )
    )
    [SPEAKERS] => Array (
        [id] => SPEAKERS
        [position] => 3
        [title] => Speakers
        [children] => Array (
            [SPK-HIFI] => Array (
                [id] => SPK-HIFI
                [title] => Hi-Fi
                [children] => Array (
                    [STAND-MOUNT] => Array (
                        [id] => STAND-MOUNT
                        [title] => Bookshelf Speakers
                    )
                    [FLOORSTANDING] => Array (
                        [id] => FLOORSTANDING
                        [title] => Floorstanders
                    )
                    [INSTALLATIONSPEAKERS] => Array (
                        [id] => INSTALLATIONSPEAKERS
                        [title] => Installation Speakers
                    )
                )
            )
            [SPK-HOMECINEMA] => Array (
                [id] => SPK-HOMECINEMA
                [title] => Home Cinema
                [children] => Array (
                    [SPEAKERPACKAGES] => Array (
                        [id] => SPEAKERPACKAGES
                        [title] => Speaker Packages
                    )
                    [SOUNDBARS] => Array (
                        [id] => SOUNDBARS
                        [title] => Soundbars
                    )
                    [CENTRES] => Array (
                        [id] => CENTRES
                        [title] => Centres
                    )
                    [SUBWOOFERS] => Array (
                        [id] => SUBWOOFERS
                        [title] => Subwoofers
                    )
                )
            )
            [SPK-ACCYS] => Array (
                [id] => SPK-ACCYS
                [title] => Accessories
                [children] => Array (
                    [SPEAKERESSENTIALS1] => Array (
                        [id] => SPEAKERESSENTIALS
                        [title] => Speaker Cables
                    )
                    [SPEAKERSTANDS] => Array (
                        [id] => SPEAKERSTANDS
                        [title] => Speaker Stands
                    )
                    [SPEAKERBRACKETS] => Array (
                        [id] => SPEAKERBRACKETS
                        [title] => Speaker Wall Brackets
                    )
                )
            )
        )
    )
) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T21:54:49.163

下面的示例不一定具有更高的性能（在时间或内存要求方面），但避免了手动递归遍历结构并显示了一种更简单的（恕我直言）方式来构建所需的输出数组。

```
function search_in_array($needle, $haystack) {
    $path = array();

    $it = new RecursiveIteratorIterator(
        new ParentIterator(new RecursiveArrayIterator($haystack)),
        RecursiveIteratorIterator::SELF_FIRST
    );

    foreach ($it as $key => $value) {
        if (array_key_exists('id', $value) && strcasecmp($value['id'], $needle) === 0) {
            $path = array($needle);
            for ($i = $it->getDepth() - 1; $i >= 0; $i--) {
                $path = array($it->getSubIterator($i)->key() => $path);
            }
            break;
        }
    }

    return $path;
} 
```

**参考**

*   [RecursiveIteratorIterator::SELF_FIRST](http://php.net/manual/en/class.recursiveiteratoriterator.php#recursiveiteratoriterator.constants.self-first)迭代模式 - 需要查看非“叶”项
*   [ParentIterator](http://php.net/manual/en/class.parentiterator.php) - 过滤掉“叶子”项目的简单方法
*   [RecursiveIteratorIterator::getDepth()](http://php.net/manual/en/recursiveiteratoriterator.getdepth.php)
*   [RecursiveIteratorIterator::getSubIterator()](http://php.net/manual/en/recursiveiteratoriterator.getsubiterator.php)

**奖金**

如果您的数组也更深，您还可以使用[RecursiveIteratorIterator::setMaxDepth()](http://uk3.php.net/manual/en/recursiveiteratoriterator.setmaxdepth.php)方法将递归限制在深度级别。`n`

# jquery - jQuery & 确认对话框事件未触发

> ID：13629215
> 
> 赞同：0
> 
> 时间：2012-11-29T15:35:41.190
> 
> 标签：jquery, events, confirm

这是当我通过单击按钮来关注文本框时的正常事件顺序：

1.  按下鼠标按钮
2.  文本框聚焦
3.  按钮鼠标向上
4.  按钮点击

现在，假设我添加了一个确认（'some questions bla bla bla'）; 在焦点事件中，事件的完成方式如下：

1.  按下鼠标按钮
2.  文本框聚焦

按钮鼠标向上和按钮单击事件不会以某种方式被触发....

我尝试使用自定义 jQuery 对话框，最后两个事件仍未触发。这是我使用的自定义确认对话框的链接：http: [//tutorialzine.com/2010/12/better-confirm-box-jquery -css3/](http://tutorialzine.com/2010/12/better-confirm-box-jquery-css3/)

我想了解如何让确认对话框显示模式，然后触发最后两个事件。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:38:09.837

在按钮单击处理程序中显示`confirm`，而不是鼠标按下处理程序。模态对话框暂停 JS 的执行，并且事件处理程序被异步触发，因此最后两个被跳过。

# java - 寻找可以插入 Spring MVC 应用程序的 CMS

> ID：13629222
> 
> 赞同：6
> 
> 时间：2012-11-29T15:36:04.683
> 
> 标签：java, spring, spring-mvc, content-management-system

我正在寻找一个可以插入 Spring MVC 应用程序的简单 CMS，而不是可以插入 Spring 应用程序的 CMS。

让我先解释一下我不想要的东西：我不想要像 Magnolia/Blossom 这样的 CMS，我可以在其中将一些 Spring 插件添加到 CMS 中。

我需要的是相反的方式；我需要一些由我的应用程序控制的 CMS。（CMS 只是其中很小的一部分，不是主要部分。）

假设这两个用例：

*   （**静态页面**）我有 Spring Web 应用程序，现在需要一些功能，让（管理员）用户可以更新“条款和条件”页面，修改起始页面上的一些内容（文本和图像）...... - 差不多编辑“静态”页面。
*   （域对象的**内容**）我的应用程序有一些域对象，用户需要为此域对象添加一些大描述（文本和图像）。一个例子是：某种商店系统，店主希望为每种产品提供精美的单独描述页面。

有人知道这样的CMS吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T20:24:30.120

我还没有任何直接的经验，但是几年前的[这个 SO 讨论推荐](https://stackoverflow.com/questions/4410445/what-is-a-good-java-based-content-management-system-for-us-and-why#answer-4463250)[Riot CMS](http://www.riotfamily.org/index.html)，它是基于 Spring 构建的，并且似乎被设计为嵌入式，而不是用作支架-单独申请。

我在演示上花了几分钟，看起来还不错。我肯定会更详细地检查它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:19:28.470

[Walrus CMS](http://sourceforge.net/projects/walruscms/)非常简单，基于 Spring、Tiles、Hibernate 和 Freemarker。它允许管理员用户直接就地[编辑网站。](http://www.cmscritic.com/cms-admin-dashboard-not/)它依赖于功能，但似乎正是您所寻求的。

# vb.net - 当数据网格失去焦点时，绑定源更改当前项目

> ID：13629226
> 
> 赞同：1
> 
> 时间：2012-11-29T15:36:15.413
> 
> 标签：vb.net, winforms, data-binding, datagridview, observablecollection

我在 VB.Net 2010 中有一个带有 6 个 DataGridViews 的 WinForm，每个都有自己的绑定源。我有一个额外的主 DataGridView 来控制其他网格中的内容。这是唯一允许添加新记录的网格。所有其他都以编程方式控制。主网格绑定源绑定到可观察的对象集合，并为集合中的类对象之一附加绑定源。

我的问题是，当我单击主网格中的新行时，一切都会通过实例化一个新的单个类对象来清除，但是当我从网格中跳出或单击或其他任何东西时，绑定源网格将其当前项重置为网格中的第一项。如果我将单个对象绑定源设置为新的实例化对象，它也会清除集合中的第一项。这不会发生在我们使用绑定到可观察集合的 DataGridView 的任何其他屏幕上。我错过了什么？

网格点击实现示例代码

```
Private Sub dgvReports_CellClick(sender As Object, e As DataGridViewCellEventArgs) Handles dgvReports.CellClick
If e.RowIndex < 0 Or dgvReports.SelectedRows.Count < 0 Then
    Exit Sub
End If

If Not dgvReports.Rows(e.RowIndex).IsNewRow Then
    objReport = dgvReports.Rows(e.RowIndex).DataBoundItem
    objReport.SerializeToDB()
    intSelIndex = e.RowIndex
    objReport = objReport.Deserialize()
    If objReport.MsgObject.ErrMsg > "" Then
        objReport.MsgObject.DisplayErrMsg()
    End If
    btnDelete.Enabled = True And Not blnReadOnly
Else
    objReport = New RBL.Report
    objReport.GlobalID = Guid.NewGuid.ToString
    intSelIndex = e.RowIndex
    btnDelete.Enabled = False
End If
' The following 3 lines of code causes the first record in grid to be reset
' but works in other implementations    
'If objReport IsNot Nothing Then
    'bsReport.DataSource = objReport
'End If

btnApply.Enabled = False
UpdateReportObjects()
End Sub

Private Sub UpdateReportObjects()
Dim objRprt As RBL.Report = Nothing

If dgvReports.SelectedRows.Count = 1 Then
    objRprt = dgvReports.SelectedRows(0).DataBoundItem
End If

' Set all local observable collections to Report properties
If objReport.GlobalID = objRprt.GlobalID Then
    RptFieldLst = objReport.ReportFields
    RptTableLst = objReport.TableList
    DisplayFieldLst = objReport.DisplayFields
    SortFldLst = objReport.SortList
Else
' Instantiate new collections and set to new Report object properties
    RptTableLst = New RBL.ReportTables()
    RptFieldLst = New RBL.ReportFields()
    DisplayFieldLst = New RBL.ReportFields()
    NonDisplayFieldLst = New RBL.ReportFields()
    SortFldLst = New RBL.ReportSortOrders()
    objReport.TableList = RptTableLst
    objReport.ReportFields = RptFieldLst
    objReport.DisplayFields = DisplayFieldLst
    objReport.SortList = SortFldLst
End If
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T17:55:35.420

问题被发现了，和往常一样，手指又指向了我自己。可观察集合的绑定源和单个项目的绑定源的 DataSource 设置为相同的变量对象，即单个类对象。问题解决了。

# android - 格式化异常消息以包含 Google Analytics for Android 中的整个堆栈跟踪？

> ID：13629228
> 
> 赞同：10
> 
> 时间：2012-11-29T15:36:17.960
> 
> 标签：android, google-analytics, stack-trace

我想在 Google Analytic 的报告中为我的移动应用程序提供整个堆栈跟踪。

我编写了打印堆栈跟踪的类并将其放入字符串中，但它不起作用。

我的习惯`ExceptionParser`：

```
@Override
public String getDescription(String threadName, Throwable throwable) {
    return threadName + " " + getStackTrace(throwable);
}

private String getStackTrace(Throwable throwable) {
    final Writer result = new StringWriter();
    final PrintWriter printWriter = new PrintWriter(result);
    throwable.printStackTrace(printWriter);

    return result.toString();
} 
```

我这样设置：

```
EasyTracker.getTracker().setExceptionParser(new StacktraceExceptionParser()); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-08T04:56:39.303

下面的方法将整个堆栈跟踪合并到一个逗号分隔的行中，如果 Analytics 只返回第一行，这可能会有所帮助。但是仍然可能有长度限制，因此进行过滤以消除您不需要的项目可能是谨慎的（见评论）

```
 public String getCombinedStackTrace(Throwable aThrowable) {

    final StringBuilder result = new StringBuilder();
    result.append(aThrowable.toString());
    result.append(',');

    String oneElement;

    for (StackTraceElement element : aThrowable.getStackTrace() ) {
        // you can do some filtering here, selecting only the elements you need
        oneElement = element.toString();
        result.append( oneElement );
        result.append( ",");
    }
    return result.toString();
} 
```

我赞同 Nikolay 关于使用错误报告库的评论。我发现它非常有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-04T10:34:11.683

我知道这个线程很旧，但我试图弄清楚如何让它工作，但为了完整起见，Log 上有一个有用的方法可以满足你的需求

```
String stackTraceStr = Log.getStackTraceString(exception); 
```

编辑：响应 100 字符限制评论

我永远无法`EasyTracker.getTracker().setExceptionParser(...)`工作，事实上我认为它不起作用，所以我在这里关注了博客文章[http://dandar3.blogspot.co.uk/2013/03/google-analytics-easytracker-detailed.html](http://dandar3.blogspot.co.uk/2013/03/google-analytics-easytracker-detailed.html)

博客文章中的重点是确保在 GA 异常处理程序上设置 ExceptionParser：

```
// Make sure you set the context on EasyTracker first
EasyTracker.getInstance().setContext(this);

// As in in the blog post, we have to get the ExceptionReporter
// in order to set the ExceptionParser
Thread.UncaughtExceptionHandler uncaughtExceptionHandler = Thread.getDefaultUncaughtExceptionHandler();
if (uncaughtExceptionHandler instanceof ExceptionReporter) {
  ExceptionReporter exceptionReporter = (ExceptionReporter) uncaughtExceptionHandler;
  exceptionReporter.setExceptionParser(new AnalyticsExceptionParser());
} 
```

这对我有用并记录了 100 多个字符。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-05T08:56:44.683

分析可能会限制您可以发送的消息的大小。我建议改用[ACRA](http://acra.ch/)或[BugSense](http://bugsense.com)等真正的错误报告库。您将获得额外的功能，例如设备信息、配置详细信息和更好的错误报告（如果它们具有相同的跟踪，则组合多个异常等）。

# database - sqlite 数据库基础

> ID：13629233
> 
> 赞同：1
> 
> 时间：2012-11-29T15:36:29.910
> 
> 标签：database, sqlite

我是数据库新手。现在我要学习sqlite。我下载了 sqlite shell 3.7.14.1。我试图创建一个数据库和谷歌搜索了很长时间。但找不到答案。
在shell中我给出了命令`sqlite3 test.db`然后它显示`...>`然后我用命令退出`.exit`但我看到没有创建数据库。请有人在这个问题上帮助我。

![在此处输入图像描述](../Images/e1441cfeb264bac470e4cfd6655d9849.png) ![在此处输入图像描述](../Images/52630e1c121c5760cb0a1fb30f354604.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:41:40.750

命令：

```
sqlite3 test.db 
```

将在名为`test.db`. 您可以继续创建表，您将能够在此数据库中查找和查询数据。

试试这个：

```
sqlite3 test.db "create table test_table (someid INTEGER PRIMARY KEY, somedata TEXT);"
sqlite3 test.db "insert into test_table values (1, 'Some Text');" 
```

然后

```
sqlite3 test.db "select * from test_table;" 
```

这是 Windows 上的示例“会话”

![在此处输入图像描述](../Images/25a6ff248f1a03abcf846b48e2205b86.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:44:44.883

你确定它没有被创建？

尝试 sqllite 命令`.databases`以确保

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T16:26:14.987

这

```
...> 
```

是来自 SQLite 的行继续提示。请按照以下步骤操作。

```
$ sqlite3 test.db
SQLite version 3.7.9 2011-11-01 00:52:41
Enter ".help" for instructions
Enter SQL statements terminated with a ";"
sqlite> create table test (n integer primary key);
sqlite> .quit

$ ls test.db 
test.db 
```

您也可以将 SQL 字符串通过管道传输到 SQLite。

```
$ echo "create table test_2 (n integer primary key);" | sqlite3 test.db 
```

你可以看看这样的表格。

```
$ sqlite3 test.db
SQLite version 3.7.9 2011-11-01 00:52:41
Enter ".help" for instructions
Enter SQL statements terminated with a ";"
sqlite> .tables
test    test_2 
```

或者将 SQL 字符串作为参数提供给 sqlite3 可执行文件。

```
$ sqlite3 test.db "create table test3 (n integer primary key);" 
```

# google-maps - 是否可以广泛定制嵌入式谷歌地图以生成动态信息？

> ID：13629234
> 
> 赞同：0
> 
> 时间：2012-11-29T15:36:35.523
> 
> 标签：google-maps, embed

我真正想做的事：

*   嵌入谷歌地图搜索框供用户输入他们的地址，完成谷歌地图上可用的自动完成/检测功能，这样他们就不必输入完整的地址。

*   计算从固定位置（我们的仓库）到他们输入的地址的距离，并将此数字信息用于 Javascript 计算。

对于我工作的公司来说，这将是**非常**有用和有益的，我可以理解这是否确实不可能，但我真的希望它是可行的，并欢迎任何和所有建议。

我不是要代码，只是要我可以学习如何做到这一点的资源。

**提前致谢。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T17:46:38.677

要制作特别精美的地图，您需要使用 Google Maps API。

您可以了解什么是 Google Maps API，请访问官方网站。 [https://developers.google.com/maps/](https://developers.google.com/maps/)

# c - libpq - PQsendQuery 等待完整的结果

> ID：13629237
> 
> 赞同：5
> 
> 时间：2012-11-29T15:36:55.010
> 
> 标签：c, postgresql, asynchronous, libpq

我遇到了 libpq 的`PQexec`函数挂在间歇性连接上的问题。查看邮件列表后，解决方案是使用异步函数`PQsendQuery`/`PQgetResult`并实现自己的超时。

现在我面临的问题是`PQgetResult`需要多次调用，直到它返回`null`，然后你就知道它已经完成了。`PQresult`但是，我的应用程序的其余部分需要每个查询一个对象。

所以我的问题是：

1.  有没有办法连接/加入多个`PQresult`s？
2.  我可以在调用之前以某种方式使用`PQisBusy`&`PQconsumeInput`等到所有结果都准备好了吗`PQgetResult`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T14:17:37.383

**感谢Laurenz** Albe在 postgresql 邮件列表上[回答了这个问题。](http://postgresql.1045698.n5.nabble.com/libpq-PQsendQuery-wait-for-complete-result-td5734111.html#a5734321)

如果你有一个 SQL 语句，你将只得到一个 `PQresult`. 如果您发送带有多个语句的查询字符串，您会得到多个，例如

```
PQsendQuery(conn, "SELECT 42; SELECT 'Hello'"); 
```

将导致两个`PQresults`.

您`PQresults`只能使用异步命令处理来获取多个；相应的 PQexec 将仅返回执行的*最后一条*语句的 PQresult。

因此，您可以获得与`PQexec`丢弃`PQresults`除最后一个之外的所有内容相同的行为。

# ms-access - VBA中的计算

> ID：13629238
> 
> 赞同：0
> 
> 时间：2012-11-29T15:36:56.120
> 
> 标签：ms-access, vba

有一个带有多个用于生产数据的文本框的表单的访问数据库。我需要用一些盒子做一个计算，它们被设置为

* * *

txtA * txtB * txtC = txtD

我需要从每个框中获取值并在幕后执行此计算。所以我需要来自 txtA * txtB * txtC 的值，并在 txtD 中显示该计算的答案。由于表单上的文本框数量，我一直遇到问题，它总是会选择错误的数据？帮助！

```
Private Sub btnCalculate_Click()
    Dim ctrl As Control
    Dim txt As TextBox

    For Each ctrl In Form.Controls
        If TypeOf ctrl Is TextBox Then
            Set txt = ctrl
            If txt.Name = "txtD" Then
                Set txt = ctrl
                ctrl.SetFocus
                ctrl.Text = calculate
            End If
        End If
    Next ctrl
End Sub

Public Function calculate()
    Dim calc1 As Double        
    calc1 = txtA.Value * txtB.Value * txtC.Value / 144
End Function 
```

我不断收到此错误：

> 运行时错误“2185”：除非控件具有焦点，否则不能引用控件的属性或方法。

这是关于 txtA、txtB、txtC 的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:54:57.583

尝试

```
txtD = calculate() 
```

或者

```
Me!txtD = calculate() 
```

如果出于某种原因，您想按名称访问控件，请这样做

```
Dim name As String

name = "txtD"
Me(name) = calculate() 
```

您的计算函数必须将结果分配给函数名称。一个潜在的问题是您忽略了类型。函数的结果属于哪种类型？它将被键入，就`Variant`好像您没有指定类型一样（并且变体可以包含任何内容）。更好的

```
Public Function calculate() As Double
    calculate = CDbl(txtA.Value) * CDbl(txtB.Value) * CDbl(txtC.Value) / 144
End Function 
```

现在，每个查看函数的人都知道文本框应该包含什么样的数据，更重要的是，函数返回什么样的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:55:01.590

首先，线

```
 ctrl.Text = calculate 
```

应该

```
 ctrl.Text = calculateBoardFeet() 
```

接下来是代码

```
 calc1 = txtA.Value * txtB.Value * txtC.Value / 144 
```

应该

```
 calculateBoardFeet = txtA.Value * txtB.Value * txtC.Value / 144 
```

# jquery - jquery 显示/隐藏一个最初处于活动状态的 div

> ID：13629243
> 
> 赞同：0
> 
> 时间：2012-11-29T15:37:20.453
> 
> 标签：jquery, css

```
<script type="text/javascript">
var _hidediv = null;
function showdiv(id) {
    if(_hidediv)
        _hidediv();
    var div = document.getElementById(id);
    div.style.display = 'block';
    _hidediv = function () { div.style.display = 'none'; };
}
</script>

#nav li { width: 100px; height: 20px; margin: 2px; background: green; cursor: pointer; }
#filtration {
    display: none;
    width: 100px; height: 100px;
    background: #000;
}
#solid {
    display: none;
    width: 100px; height: 100px;
    background: #c0c0c0;
}    
#chemistry {
    display: none;
    width: 100px; height: 100px;
    background: red;
}

<ul id="nav">
    <li onclick="showdiv('filtration');">Filtration</li>
    <li onclick="showdiv('solid');">Solidification</li>
    <li onclick="showdiv('chemistry');">Chemistry</li>
</ul>

<div id="filtration">&nbsp;</div>
<div id="solid">&nbsp;</div>
<div id="chemistry">&nbsp;</div>​ 
```

设置一个导航栏来显示/隐藏内容，上面的代码工作正常，但问题是我希望一个 div 在你最初进入页面时显示内容。上面的代码仅在所有 div 最初都被隐藏时才有效。

您可以将一个 div 设置为 display:block，但是如果您单击另一个导航链接而不是显示的链接，则不会发生任何事情。您必须先单击设置为 display:block 的相应 div 的链接，然后才能继续单击其他链接-无用。

我该如何修改它，使第一个内容 div (#filtering) 最初设置为 display:block，然后用户可以继续单击 UL 中的任何链接并显示该内容？

[http://jsfiddle.net/2MpmK/3/](http://jsfiddle.net/2MpmK/3/)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T15:43:25.663

您应该在显示选定的 div 之前隐藏其他 div：

```
function showdiv(id) {
    var divs = document.getElementsByTagName('div'),
        div  = document.getElementById(id);
    for (var i=0; i<divs.length; i++) {
        divs[i].style.display = 'none';
    }
    div.style.display = 'block';
}
​ 
```

[**小提琴**](http://jsfiddle.net/2MpmK/6/)

或者使用 jQuery 并且没有这些 onclick 函数，您可以执行以下操作：

```
<ul id="nav">
    <li data-id="filtration">Filtration</li>
    <li data-id="solid">Solidification</li>
    <li data-id="chemistry">Chemistry</li>
</ul> 
```

--

```
$(function() {
    $('#nav li').on('click', function() {
        $('#'+$(this).data('id')).show().siblings('div').hide();
    });
});
​ 
```

[**小提琴**](http://jsfiddle.net/2MpmK/9/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:50:22.133

用jQuery：

```
function showdiv(id) 
{
    $('.content').hide();
    $('#'+id).toggle();
}

#filtration {
    width: 100px; height: 100px;
    background: #000;
}
​
<div id="filtration" class="content">&nbsp;</div>
<div id="solid" class="content">&nbsp;</div>
<div id="chemistry" class="content">&nbsp;</div>​ 
```

​</p>

# python - 在list-to-numpy-to-list之后python中的异常小数位

> ID：13629245
> 
> 赞同：2
> 
> 时间：2012-11-29T15:37:29.613
> 
> 标签：python, numpy, floating-point, python-2.7

在我的 ubuntu linux 机器上用全新的 Python 2.7.3 解释器执行以下代码，会得到代码后显示的输出。

```
import numpy as np
p = [1/3., 1/2., 23/25., 1]
q = np.array(p)
r = list(q)
print p; print q; print r 
```

输出：

```
[0.3333333333333333, 0.5, 0.92, 1]
[ 0.33333333  0.5         0.92        1\.        ]
[0.33333333333333331, 0.5, 0.92000000000000004, 1.0] 
```

我试图弄清楚为什么 p 和 r 的打印结果不同，但到目前为止还没有一个合理的理论。关于它们为什么不同的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T15:39:35.447

它们的打印方式不同，因为`p`是 和 的列表`float`，`int`而`r`是 的列表`numpy.float64`：

```
In [23]: map(type, p)
Out[23]: [float, float, float, int]

In [24]: map(type, r)
Out[24]: [numpy.float64, numpy.float64, numpy.float64, numpy.float64] 
```

发生这种情况是因为 NumPy 数组是统一类型的，所以`float64`当你创建`q`.

两个列表中的值比较相等，因此纯粹是格式上的差异：

```
In [22]: p == r
Out[22]: True 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:39:13.067

我认为这只是 a与 a python`__repr__`实现方式的区别。 `np.float64``float`

当您从 numpy 数组中创建一个列表时，您将元素（使用 type `np.float64`）放入列表中。因此，您实际上已将原始数据的类型从 转换`float`为`np.float64`.

# sqlite - 将现有 SQLite 数据库导入 iOS Phonegap 应用程序

> ID：13629247
> 
> 赞同：2
> 
> 时间：2012-11-29T15:37:32.247
> 
> 标签：sqlite, cordova

我有一个名为 data_items.sqlite 的现有 SQLite 数据库。该数据库包括大约 10 个表和一些初始数据，我想将它们导入 XCode 以通过 Phonegap 插件以这种方式打开数据库：

```
function onDeviceReady() {
    var db = window.sqlitePlugin.openDatabase("data_items.sqlite", "1.0", "PhoneGap Demo", 200000);
    ...
} 
```

如何导入数据文件？我必须在哪里复制文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-02T12:37:56.200

首先创建数据库，因为您使用名称 data_items.sqlite 并删除 .sqlite 扩展名。然后将这个 db 拖到 xCode 中的 Resources 目录并按照 next 。

选择添加文件框的选项将出现选中复选框，显示“将项目复制到目标组的文件夹（如果需要）”并完成。

您将看到数据库文件作为资源目录的子列表

*抱歉，我没有足够的声望在这里发布图片*

现在点击链接将此数据库文件复制到位置

[在iOS中启动应用程序时如何复制sqlite数据库？](https://stackoverflow.com/questions/15491238/how-to-copy-sqlite-database-when-application-is-launched-in-ios)

我在 AppDelegate.m 的最后一行的 @end 之前使用了以下代码

```
 - (void) copyDatabaseIfNeeded{
        NSFileManager *fileManager = [NSFileManager defaultManager];
        NSError *error;
        _dbPath = [self getDBPath];

        BOOL success = [fileManager fileExistsAtPath:_dbPath];

    if(!success){
        NSString *defaultDBPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"data_items"];
        success = [fileManager copyItemAtPath:defaultDBPath toPath:_dbPath error:&error];
        if (!success)
            NSAssert1(0, @"Failed to create writable database file with message '%@'.", [error localizedDescription]);
    }}
/********* Database Path *********/
- (NSString *) getDBPath
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask,YES);
    NSString *documentsDir = [paths objectAtIndex:0];

    return [documentsDir stringByAppendingPathComponent:@"data_items"];
} 
```

并复制该行

```
[self copyDatabaseIfNeeded]; 
```

在代码之后

```
- (BOOL)application:(UIApplication*)application didFinishLaunchingWithOptions:(NSDictionary*)launchOptions
{
    CGRect screenBounds = [[UIScreen mainScreen] bounds]; 
```

而已。使用您的代码

```
function onDeviceReady() {
    var db = window.sqlitePlugin.openDatabase("data_items", "1.0", "data_items", 200000);
    ...
} 
```

您还可以直接从复制的位置编辑数据库。使用以下链接

[iPhone 模拟器在哪里存储它的数据？](https://stackoverflow.com/questions/1108076/where-does-the-iphone-simulator-store-its-data)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T09:46:19.640

似乎无法从 PhoneGap 访问 assets 文件夹，因此您必须编写一个本机插件来复制数据库文件：
[Prepopulate SQLite DataBase in PhoneGap Application](http://gauravstomar.blogspot.de/2011/08/prepopulate-sqlite-in-phonegap.html)

# c++ - 本地化字体

> ID：13629249
> 
> 赞同：2
> 
> 时间：2012-11-29T15:37:37.557
> 
> 标签：c++, localization

我对本地化非常陌生，我正在尝试本地化一个小软件，它有 19 个文件夹“en”、“jp”、“tw”作为名称。每个内部都是一个保存为 utf-8 的文本文件，其中包含语言数据。

问题是当我尝试从中文网站复制和粘贴时，我会得到像这样的奇怪字形 [][][][] 我认为它是因为我的系统字体不是中文并且它不支持它。

作为开发人员，我应该以某种方式更改我的整个系统字体以支持所有这些语言吗？有这样的字体吗？我不确定软件公司如何处理这些事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:05:19.297

> 作为开发人员，我应该以某种方式更改我的整个系统字体以支持所有这些语言吗？

不，你不应该。将本地化字符串视为数据。

> 问题是当我尝试从中文网站复制和粘贴时，我会得到像这样的奇怪字形 [][][][] 我认为它是因为我的系统字体不是中文并且它不支持它。

但是应该向您提供此类数据，并且您应该知道它的编码。

另外，我建议您检查国际化库（如 gettext）以防止重新发明轮子。

# mongodb - 这是正常的还是由于 mongodb 中的错误？

> ID：13629253
> 
> 赞同：1
> 
> 时间：2012-11-29T15:37:45.587
> 
> 标签：mongodb, xen

我是 mongodb 的新手，我将它安装在**xen para virtual vm**上，并且在给出命令时

**“mongo”**终端冻结，**顶部**输出命令 mongo 占用了几乎**100% CPU**。

这是一个错误，还是 mongo 命令使调度程序考虑进程**交互**并导致更多的 cpu 使用？

**运行 Mongo 2.0.4，Ubuntu 12.04，kernel-3.2.0-23-generic 作为 VM**

# c++ - 带向量的核心分段错误

> ID：13629255
> 
> 赞同：0
> 
> 时间：2012-11-29T15:37:50.680
> 
> 标签：c++, vector, runtime-error

以下与家庭作业有关。限制宠物项目类型的东西，任务是更新它以使用向量。我遇到的问题是：这最终导致核心分段错误，但在我使用 valgrind 时能够正确检索所有信息。

```
void Table::partyCheckout(void)
{
        if(status == SERVED)
        {
                cout << " ---------------- " << endl;
                cout <<"Table: " << tableId << "\nParty Size: " << numPeople << "\nWaiter: " << waiter->getName() << "\nSummary: " <<endl;
                order->requestSummary();
                cout << "Total: " << endl;
                order->requestTotal();
                cout << " ---------------- " << endl;
                status = IDLE;
        }
        else
        {
                cout << "Error: " << tableId << " ";
                if(numPeople == 0)
                {
                        cout << "No one is at this table." << endl;
                }
                else
                {
                        cout << "This party hasn't been served." << endl;
                }
        }
} 
```

设置：我将服务员和订单存储在向量中。
在运行时：当它执行 waiter->getName() 时，它会抱怨这是一次无效的读取，并且内存位置已被向量通过释放程序释放。
我对此事的逻辑：它向前看，发现向量本身不再被访问，因此将其释放。由于在此之后我不再写，内存位置保持不变。当它尝试读取它看到它已被释放的位置时，因此读取无效，但它仍然获得适当的数据。
所以我的问题是，我想有两个方面：
这个逻辑听起来对吗？
我应该怎么做才能修复它？

```
#ifndef HW3_H
#define HW3_H
#include <vector>
#include "Table.h"
#include "Waiter.h"

class hw3
{
private:

        vector<Table> tables;
        vector<Waiter> waiters;
        vector<Order> orders;
public:
        void begin();

};
#endif 
```

.cpp 文件，大部分分配：

```
 ifstream configFile("config.txt"); //This guy is for initializing things
        string line;

        Menu theMenu;
        getline(configFile, line);
        stringstream intMaker;
        int t1;
        int t2;
        string temp;
        string temp2;
        string temp3;
        while (true)
        {
                getline(configFile, line);
                Tokenizer str(line, " \n");
                if(line =="")
                {

                        break;
                }
                else
                {
                        temp = str.next();
                        temp2 = str.next();
                        intMaker << temp;
                        intMaker >> t1;
                        intMaker.str("");
                        intMaker.clear();
                        intMaker << temp2;
                        intMaker >> t2;
                        intMaker.str("");
                        intMaker.clear();
                        tables.push_back(*(new Table(t1,t2)));

                }

        }

        getline(configFile, line);
        while (true)
        {
                getline(configFile, line);
                Tokenizer name(line, " ");
                string tabl = "";
                //Siphon off the name and the tables.
                temp = name.next();
                tabl = name.next();
                Tokenizer strink(tabl, ",\n");
                int numTables = (int) tables.size();
                Table * tabs[numTables];
                t1 = 0;
                int keepinTabs = 0;
                while(true)
                {
                        string temp2 = strink.next();

                        if (temp2 == "")
                        {

                                 break;
                        }
                        else
                        {
                                 intMaker << temp2;
                                 intMaker >> t1;

                                 intMaker.str("");
                                 intMaker.clear();
                                 for(int i = 0; i < numTables; i++)
                                 {
                                        if(tables.at(i).getTableId() == t1)
                                        {
                                                tabs[keepinTabs] = &tables.at(i);
                                        }
                                 }
                                 keepinTabs++;
                        }

                }

                waiters.push_back(*(new Waiter(temp, tabl, *tabs))); //Waiter(name, list of tables, and an array of table numbers.
                for(int j = 0; j < keepinTabs; j++)
                {
                        for(int i = 0; i < tables.size(); i++)
                        {
                                if(tabs[j]->getTableId() == tables[i].getTableId())
                                {
                                        tables.at(i).assignWaiter(&(waiters.back()));
                                }
                        }
                }
                if(line == "")
                {
                        break;
                }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:58:17.613

我可以看到多个问题：

```
tables.push_back(*(new Table(t1,t2))); 
```

此代码动态分配类型的对象，然后将该对象的**副本**`Table`推送到中，然后忘记动态分配的对象的地址-您正在泄漏内存。**`tables`**

 **```
waiters.push_back(*(new Waiter(temp, tabl, *tabs))); 
```

如上所述，`Waiter`这次。

```
tabs[keepinTabs] = &tables.at(i); 
```

这需要向量内的对象的地址。虽然合法，但它非常脆弱。`std::vector`当它调整大小时（例如，当你推入它时）可以在内存中移动它的内容。

这（或其他地方的类似代码）可能是您的段错误的原因。看到你动态分配对象，也许你应该声明你的向量只保存指针：

```
vector<Table*> tables;
vector<Waiter*> waiters;
vector<Order*> orders; 
```

然后你会做例如`tables.push_back(new Table(t1, t2));`。`delete`当然，当您从向量中删除它们时，您必须确保动态分配的对象。另一种方法是使用智能指针，例如：

```
vector<std::shared_ptr<Table> > tables;
vector<std::shared_ptr<Waiter> > waiters;
vector<std::shared_ptr<Order> > orders; 
```**

# php - 检查 URL 时 cURL 奇怪的状态代码

> ID：13629261
> 
> 赞同：0
> 
> 时间：2012-11-29T15:38:03.563
> 
> 标签：php, curl

我正在检查不同 URL 上是否存在 xml 站点地图。如果我提供一个 URL example.com/sitemap.xml，并且它对 www.example.com/sitemap.xml 有一个 301，我显然会得到一个 301。如果 www.example.com/sitemap.xml 不存在，我不会看到 404。因此，如果我得到 301，我会执行另一个 cURL 来查看 www.example.com/sitemap.xml 是否返回 404。但是，出于某种原因，我得到了随机的 404 和 303 状态码。

```
private function check_http_status($domain,$file){

        $url = $domain . "/" . $file;

        $curl = new Curl();

        $curl->url = $url;
        $curl->nobody = true;
        $curl->userAgent = 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.1) Gecko/20060601 Firefox/2.0.0.1 (Ubuntu-edgy)';
        $curl->execute();
        $retcode = $curl->httpCode();

        if ($retcode == 301 || $retcode == 302){

            $url = "www." . $domain . "/" . $file;

            $curl = new Curl();
            $curl->url = $url;
            $curl->nobody = true;
            $curl->userAgent = 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.1) Gecko/20060601 Firefox/2.0.0.1 (Ubuntu-edgy)';
            $curl->execute();
            $retcode = $curl->httpCode();

        }

        return $retcode;

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:45:26.147

查看返回的响应代码列表 - [http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)。

通常 Web 浏览器会自动处理这些，但是当您使用 curl 手动执行操作时，您需要了解每个响应的含义。`301`or`302`表示您应该使用提供的替代 url 来访问资源。这可能是一个简单`www`的请求插件，但它也可能更复杂，因为重定向到一个不同的域。

这`303`意味着您正在`POST`尝试访问资源，并且应该使用`GET`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:42:34.963

好吧，当您收到 301 或 302 时，您应该使用在响应中找到的位置，而不仅仅是假设另一个位置并尝试。

正如您在此示例中看到的，来自服务器的响应包含文件的新位置。将其用于您的下一个请求： [http ://en.wikipedia.org/wiki/HTTP_301#Example](http://en.wikipedia.org/wiki/HTTP_301#Example)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-11T16:39:41.653

“followLocation”效果很好。以下是我的实现方式：

```
$url = "http://www.YOURSITE.com//"; // Assign you url here.

$ch = curl_init(); // initialize curl.
curl_setopt($ch, CURLOPT_URL, $url); // Pass the URL as the option/target.
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); // 0 will print html. 1 does not.
curl_setopt($ch, CURLOPT_HEADER, 0); // Please curl, inlude the header in the output.
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); // ..and yes, follow what the server sends as part of the HTTP header.

$response_data = curl_exec($ch); // execute curl with the target URL.
$http_header = curl_getinfo($ch); // Gets information about the last transfer i.e. our URL
// Print the URLs that are not returning 200 Found.
if($http_header['http_code'] != "200") {
    echo " <b> PAGE NOT FOUND => </b>"; print $http_header['http_code'];
}
// print $http_header['url']; // Print the URL sent back in the header. This will print the page to wich you were redirected.
print $url; // this will print the original URLs that you are trying to access

curl_close($ch); // we are done with curl; so let's close it. 
```

# css - CSS 错误/黑客和 W3C 验证

> ID：13629266
> 
> 赞同：0
> 
> 时间：2012-11-29T15:38:19.447
> 
> 标签：css, w3c-validation

我正在查看的样式表中有以下几行（单独的）：

```
.Ex1.Ex2 {
color:#333;
font-family:Verdana,Arial,sans-serif;
font-size:9pt;
font-weight:bold;
margin:24px 0 5px;
border-bottom:1px solid #333
}

{
background-color:#ffe;
border:1px solid #aaa;
color:#000;
font-family:Verdana,Arial,sans-serif;
font-size:9pt;
height:auto;
margin-top:5px
} 
```

和

```
.box_title_container {
height:29px;
width:225px;
margin:0 auto;
background:url(../best_images/boxts.gif);
repeat-x
} 
```

通过 W3C 验证器时，两者都返回解析错误。由于创建样式表的人在 CSS 方面比我有更多的经验，我可能认为这是两种用于跨浏览兼容性的 hack，但我无法谷歌（现在它是一个动词，对吗？）与此相关的任何内容。

至于第一行，它有两个封闭的属性集，第二行有一个独立的 repeat-x 值（并且这个“错误”在接下来的 5 或 6 行中重复）。

有人能告诉我这些是出于某种目的还是纯粹的错误？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T15:48:38.420

在您的第一个 CSS 块中，您必须为第二个 {} 指明 ID、类或 HTML 元素

```
.Ex1.Ex2 {
color:#333;
font-family:Verdana,Arial,sans-serif;
font-size:9pt;
font-weight:bold;
margin:24px 0 5px;
border-bottom:1px solid #333 /* missing ;*/
}

#IDneeded .CLASSneeed {
background-color:#ffe;
border:1px solid #aaa;
color:#000;
font-family:Verdana,Arial,sans-serif;
font-size:9pt;
height:auto;
margin-top:5px /* missing ;*/
} 
```

对于第二个，“repeat-x”是“background”的值，而不是 CSS 属性，只需移动 ;

```
.box_title_container {
height:29px;
width:225px;
margin:0 auto;
background:url(../best_images/boxts.gif) repeat-x;
} 
```

# android - 如何实现activity和FragmentActivity的父方法？

> ID：13629267
> 
> 赞同：2
> 
> 时间：2012-11-29T15:38:22.577
> 
> 标签：android, android-activity, android-fragmentactivity

我正在开发一个 android 应用程序，并且我有许多从自定义活动扩展而来的活动。

现在我创建了一个新的 FragmentActivity，我需要在自定义活动中实现的相同功能。

我怎样才能做到这一点？

**编辑**

这是一个简单的例子

```
public class BaseActivity extends Activity
{
    protected void someFunction()
    {
        Log.i("TEST","This is a test");
    }
}

public class MainActivity extends BaseActivity
{
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        someFunction();
    }
} 
```

这是我的 FragmentActivity：

```
public class MyFragmentActivity extends FragmentActivity
{
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        // here I want to use someFunction()..
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:39:38.440

在 Java 中，你不能扩展一个以上的类。所以我想你应该从 FragmentActivity 而不是 Activity 扩展 BaseActivity

# javascript - 我将使用什么正则表达式来检索此字符串后面的数字？

> ID：13629269
> 
> 赞同：0
> 
> 时间：2012-11-29T15:38:23.683
> 
> 标签：javascript, regex

我正在使用 jQuery 来检索类属性，我需要获取子字符串后面的数字的子字符串`"position"`

例如 `"position7 selected"`我需要检索`"7"`

例如 `"navitem position14 selected"`我需要检索`"14"`

我开始写：

```
$(this).attr('class').match(/(\d+)$/)) 
```

但是我迷失了正则表达式，非常感谢任何帮助。我实际上真的很喜欢正则表达式，但我还在学习！

由于第一个答案而更新：可能还有另一组我需要忽略的数字例如“navitem2 position14 selected”我需要检索“14”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T15:50:01.703

```
"navitem position14 selected".match(/position(\d+)/)[1] 
```

调用返回`["position14", "14"]`，所以`[1]`元素是 14。

您在正确的轨道上使用`(\d+)`，它将匹配一组连续的数字。这只是说仅当它直接跟随文字 string 时才匹配该组`"position"`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T15:50:26.127

您的尝试有两个问题。第一个是你用 . 将它锚定到字符串的末尾`$`。因此，与其给你后面的数字，`position`不如给你字符串末尾的数字。同时你根本不提`position`。您正在寻找的是：

```
var matches = str.match(/position(\d+)/); 
```

现在`matches`将

```
["position14", "14"] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T15:40:08.473

你可以替换所有不是数字的东西

```
str.replace(/\D/g,""); 
```

如果字符串中存在其他数字，您仍然可以使用替换

```
str.replace(/^.*position(\d+).*$/,"$1"); 
```

但是，您可能想在其他答案中选择其他正则表达式之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T15:49:38.633

```
 var r = "aaa 1 bb 2 position 113 dd".match(/position\s*(\d+)/)
  if (r instanceof Array )
      return r.pop() 
```

# php - 使用链接：识别外部链接和链接的完整地址

> ID：13629271
> 
> 赞同：0
> 
> 时间：2012-11-29T15:38:26.233
> 
> 标签：php

我正在尝试为我的网站创建站点地图，所以基本上我会扫描主页中的链接并提取链接并递归地对提取的链接执行相同的操作

```
 function get_contents($url = '' ) {
    if($url == '' ) { $url = $this->base_url; }
    $curl = new cURL;
    $content = $curl->get($url);
    $this->get_links($content);
 }

 public function get_links($contents){

                $DOM = new DOMDocument();
                $DOM->loadHTML($contents);
                $a = $DOM->getElementsByTagName('a');
                foreach($a as $link){

                     $h =  $link->getAttribute('href'); 
                     $l =  $this->base.'/'.$h;
                     $this->links[] = $l ;
                     $this->get_contents($l);

                }
 } 
```

它工作正常，但有几个问题

1-

我得到了一些链接 ike

```
www.mysite.com/http://www.external.com 
```

我可以做类似的事情

```
 if( stripos( $link  , 'http')  !== false
        ||
        stripos( $link  , 'www.')  !== false
        ||
        stripos( $link  , 'https') !== false
     )
    {
            if(stripos( $link  , 'mysite.com') !== false)
            {
               //ignor this link (yeah i suck at regex and string mapping)
            }
    } 
```

但它似乎非常复杂和缓慢，是否有任何标准和干净的方法来找出链接是否是外部链接？

2 -

有没有办法处理相对路径？我得到了一些类似的东西

```
www.mysite.com/../Domain/List3.html 
```

显然这是不对的，我可以从链接中删除（../），但它可能不适用于所有链接，无论如何要找出链接的完整地址？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:47:36.707

对于相对路径，您可以查看`realpath()`

例如，用于`parse_url()`获取域，以便您可以轻松检查域是否等于您的域。请注意，`parse_url()`需要定义 SCHEME，因此如果没有 http[s]，则可以添加 http://。

# java - Java：将常量存储在非方法接口或类中是否更合适？

> ID：13629272
> 
> 赞同：0
> 
> 时间：2012-11-29T15:38:31.487
> 
> 标签：java, oop

这个问题一直困扰着我。我可以等待听到答复。我经常看到这个

```
public interface Istuff
{
    public static final int STATE_B = 4;
    public static final int STATE_L = 5;
    public static final int STATE_U = 6;
} 
```

还有这个

```
public class MyStuffConstants
{
    public static final String STATUS = "STATUS";
    public static final String RUNNING = "RUNNING";

} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T15:40:01.920

我会说[**Enum**](http://docs.oracle.com/javase/1.5.0/docs/guide/language/enums.html)。因为它们的唯一目的是表示一组固定的常数。

简单示例：

```
enum Season { WINTER, SPRING, SUMMER, FALL } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T15:40:20.250

你应该使用`enum`它。它太强大了，不能使用它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T15:45:45.037

不要为此使用接口。一旦您有许多接口（可能来自扩展其他接口的接口），它就会变得非常混乱：然后您需要精确选择哪些接口来选择常量，这会抵消在接口中定义常量的好处。

干净的解决方案是为此设置一个不可实例化的类。当然，当枚举适用时（即值是同一语义字段中的不同可能值），您应该使用枚举。但是不要对这种常量使用枚举：

```
public final static int DEFAULT_WIDTH = 666; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-29T15:55:56.193

如果您还可以通过添加构造函数将任意数据与枚举常量相关联：

```
public enum Season {

    WINTER(1, 15), SPRING(2, 92), SUMMER(3, 40), FALL(50, 9);

    private final int foo;
    private final int bar;

    Season(int foo, int bar) {
        this.foo = foo;
        this.bar = bar;
    }

    public int getFoo() {
        return foo;
    }

    public int getBar() {
        return bar;
    }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-29T15:48:58.177

对于 IStuff 示例，如果您实际上不需要整个排他排序位，我认为枚举有点尴尬-您最终将基本上创建一个用于包装整数的类。

MyStuffs 示例中的枚举是有意义的，只要常量的名称对您有用。

这取决于谁将使用常量——有时在类内部使用常量是有意义的（避免使用魔法值）。在那种情况下“私有静态最终 * *;” 工作正常。

如果您希望常量作为 API 的一部分有用，那么请确保像 iStuff 中那样使用常量（顺便说一句，您可能会丢失“public static final”位，这是将它们像这样放在接口中时的默认设置）。

编辑：如果你没有一个接口开始，并且你有明显属于特定的常量，即使常量需要是公共的，我不认为需要创建一个单独的接口只是为了拥有放置常量的地方。但是，如果常量将在两个或多个类/api 中使用并且属于一个位置而不是另一个位置，那么请确定为什么不将常量放在单独的接口中。

我认为常量的概念太复杂了，无法用一般的“做这个”陈述来回答。

# oop - MVC 中的“流程模型”与“数据/对象模型”

> ID：13629275
> 
> 赞同：2
> 
> 时间：2012-11-29T15:38:37.647
> 
> 标签：oop, model-view-controller, web-applications, language-agnostic, model

是的，另一个关于 Web 应用程序的 MVC 架构中职责分离的问题 - 我认为这个有一个微妙的区别......

我现有的实现如下所示：

*   控制器：非常“薄”；A除了调用模型和视图，仅路由和表示逻辑
*   型号：非常“厚”；所有业务逻辑
*   视图：非常“薄”；除了内容和标记，代码仅限于循环和数据格式

此外，该项目使用 ORM 作为数据库之上的抽象层，并使用“连接器”作为外部服务的包装类。

我的问题涉及模型之间的职责分离。在大多数情况下，我们的模型模仿了我们系统中的“事物”——“用户”、“产品”、“订单”等。

我发现这对于服务简单的数据检索请求非常有效——控制器实例化正确的模型并调用相关的“getter”。

当启动更复杂的流程（例如“PlaceOrder”或“RegisterUser”）时，就会出现问题。有时这些过程可以在单个模型中实现，有时它们需要模型之间的通信或协调才能实现。

就目前而言，在这些情况下，模型直接相互通信，而不是由控制器管理的过程。将流程保留在模型中似乎是正确的（例如，控制器不需要知道“注册用户”的业务规则需要发送确认电子邮件）。

我在这个实现中发现了两个让我有些担心的问题：

1.  模型通常似乎对其他模型了解太多 - 在此实现中模型似乎过于紧密耦合。
2.  模型中的方法有两种一般类型：“getter/setter”和我用来调用“流程方法”的方法，管理流程的方法，调用模型中的其他方法或其他适当的模型 - 这些方法似乎' un-model-like'，因为缺乏更好的描述。

实现两种模型是否合适 - “数据/对象模型”（主要填充“getter/setter”，也许是简单的“流程方法”，它们完全是内部的和“流程模型”（填充有“流程方法”，其中需要多个（“数据/对象”）模型的协作）？

在这个实现中，我们有代表“用户”、“产品”、“订单”以及“注册”、“订单”等的模型。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:52:45.413

这个问题的解决方案是在模型之上有一个单独的层，一个薄层。该层有时称为服务层或应用层。这一层并没有过多的状态，而是调用了各种模型方法和数据访问方法。

例如，您可能有一个用于管理订单的服务类。

```
class OrderService {

placeOrder(Order order) {
   order.doModelStuff();
   orderDao.save(order);

}

removeOrder(order){
    order.cancel();
    orderDao.delete(order);

...
} 
```

或者

```
class UserService {

registerUser(User user) {
    if(userDao.userExists(user)) {
       throw exception: user exists;
    } 
    user.doRegistrationStuff();
    userDao.save(user);
} 
```

服务层中的方法并不局限于操作单个实体。通常，他们可以访问和操作多个模型。例如，

```
placeOrder(Customer customer, Order order) {
     customer.placeOrder(order);
     save customer, if necessary.
     save order, if necessary
     customer.sendEmail();
     Shipper shipper = new shipper;
     shipper.ship(order, customer.getAddress());
     ...

} 
```

这一层的想法是，它的方法做一个工作单元（通常对应于一个用例）。这实际上更多的是程序性质。您可以从 Martin Fowler 和其他人那里了解有关该层的更多信息。

注意：我的意思是展示什么是服务/应用层，而不是展示订单、客户等的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:46:47.570

Martin Fowler 在他的“重构”一书中似乎认为，由数据、访问器和其他任何东西组成的“数据”模型是重构为另一个类的良好候选者。他在他的代码“难闻气味”库中称其为“数据类”。

这表明，简化不同流程之间的交互可能会更好，但允许流程与自己的数据紧密耦合

例如，PlaceOrder 和 OrderData 可以紧密耦合，但 PlaceOrder 涉及最少的交互，例如与客户流程的 AddOrderToCustomerRecord。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T17:21:27.753

在设计模式术语中，将您的模型对象分离为简单对象（使用 getter 和 setter）和流程对象（使用流程逻辑）会将您的领域模型变成带有事务脚本的贫血领域模型。

你不想那样做。模型对象告诉对方做事（你的过程方法）是好的。这种耦合比使用 getter 和 setter 获得的耦合更可取。

对象必须相互交互，因此必须存在某种程度的耦合。如果您将这种耦合限制为旨在向外界公开的方法（如果您愿意，可以使用对象的 API），您可以更改对象的实现而不会产生副作用。

一旦公开了实现细节（getter 和 setter 公开了对象内部，它们是特定于实现的），就不能在没有副作用的情况下更改实现。那是糟糕的耦合。有关更详尽的解释，请参阅[Getter 和 Setter Are Evil 。](http://www.javaworld.com/javaworld/jw-09-2003/jw-0905-toolbox.html)

回到你的过程方法和过度耦合，有一些方法可以减少模型对象之间的耦合。查看得[墨忒耳法则，](http://c2.com/cgi/wiki?LawOfDemeter)了解什么是合理的，什么应该是危险信号。

还可以查看[Domain Driven Design](http://domaindrivendesign.org)以了解减少耦合的模式。像聚合根这样的东西可以减少耦合和复杂性。

tl;dr 版本：不要分离你的数据和方法，隐藏你的数据，只公开你的 API。

# c# - 分析wav并绘制图形

> ID：13629277
> 
> 赞同：9
> 
> 时间：2012-11-29T15:38:44.570
> 
> 标签：c#, graph, wav

我正在尝试从 wav 文件中打印出波形，但我有点迷失了样本的长度。

这就是我想要归档的（没有颜色）： ![音乐](../Images/bb10f7aa79bbf6b61b53ab7c17e65b56.png)

因此，为了读取我的数据，我使用以下代码：

```
// first we need to read our wav file, so we can get our info:
byte[] wav = File.ReadAllBytes(filename);

// then we are going to get our file's info
info.NumChannnels = wav[22];
info.SampleRate = bytesToInt(wav[24], wav[25]);

// nr of samples is the length - the 44 bytes that where needed for the offset
int samples = (wav.Length - 44) / 2;

// if there are 2 channels, we need to devide the nr of sample in 2
if (info.NumChannnels == 2) samples /= 2;

// create the array
leftChannel = new List<float>();
if (info.NumChannnels == 2) rightChannel = new List<float>();
else rightChannel = null;

int pos = 44; // start of data chunk
for (int i = 0; i < samples; i++) {
    leftChannel.Add(bytesToFloat(wav[pos], wav[pos + 1]));
    pos += 2;
    if (info.NumChannnels == 2) {
        rightChannel.Add(bytesToFloat(wav[pos], wav[pos + 1]));
        pos += 2;
    }
} 
```

BytesToFloat = 将 2 个字节转换为 -1 和 1 之间的浮点数

所以现在我有 2 个数据列表，但是现在我应该用多少个数字来创建 1 行？

最让我困惑的是：当你播放一首歌时，你可以在大多数音乐播放器中看到以下数据，这在我看来是 1 个样本的表示。 ![在此处输入图像描述](../Images/3930546996811d8ff5f9106796b9a0b3.png)

但是你怎么知道每个条的值，以及样本中有多少条

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-30T10:57:54.777

您的问题是关于两种不同的音频可视化。要绘制波形，您发布的代码已接近准备就绪，但您正在将每个样本添加一个条目到您的列表中。由于音频通常是每秒 44100 个样本，因此一首 3 分钟歌曲的波形将需要近 800 万像素。所以你要做的就是批量处理它们。对于每一个 4410 像素（即 100 毫秒），找到具有最高和最低值的像素，然后用它来画线。实际上，您通常只需找到最大 Abs 值并绘制对称波形即可。

这是一些在 WPF 中绘制音频文件的基本波形的代码，使用 NAudio 可以更轻松地访问示例值（它可以处理 WAV 或 MP3 文件）。我没有将左右声道分开，但这应该很容易添加：

```
var window = new Window();
var canvas = new Canvas();
using(var reader = new AudioFileReader(file))
{
    var samples = reader.Length / (reader.WaveFormat.Channels * reader.WaveFormat.BitsPerSample / 8);
    var f = 0.0f;
    var max = 0.0f;
    // waveform will be a maximum of 4000 pixels wide:
    var batch = (int)Math.Max(40, samples / 4000);
    var mid = 100;
    var yScale = 100;
    float[] buffer = new float[batch];
    int read;
    var xPos = 0;
    while((read = reader.Read(buffer,0,batch)) == batch)
    {
        for(int n = 0; n < read; n++)
        {
            max = Math.Max(Math.Abs(buffer[n]), max);
        }
        var line = new Line();
        line.X1 = xPos;
        line.X2 = xPos;
        line.Y1 = mid + (max * yScale); 
        line.Y2 = mid - (max * yScale);
        line.StrokeThickness = 1;
        line.Stroke = Brushes.DarkGray;
        canvas.Children.Add(line);
        max = 0;    
        xPos++;
    }
    canvas.Width = xPos;
    canvas.Height = mid * 2;
}
window.Height = 260;
var scrollViewer = new ScrollViewer();
scrollViewer.Content = canvas;
scrollViewer.HorizontalScrollBarVisibility = ScrollBarVisibility.Auto;
window.Content = scrollViewer;
window.ShowDialog(); 
```

第二种可视化有时称为频谱图或频谱分析仪。它不代表 1 个样本，而是代表样本块中存在的频率。要获取此信息，您需要通过快速傅里叶变换 (FFT) 传递样本。通常你会通过 1024 个样本块（它应该是 2 的幂）。不幸的是，如果您是 DSP 新手，使用 FFT 可能会很棘手，因为您需要学习如何做几件事：

*   应用窗口函数
*   将您的音频转换为正确的输入格式（许多 FFT 期望输入为复数）
*   计算出哪些 bin 编号对应于哪个频率，
*   找到每个 bin 的大小并将其转换为分贝标度。

您应该能够在 StackOverflow 上找到有关每个主题的更多信息。我在本文中写了一些关于如何在 C# 中使用 FFT 的[文章](http://channel9.msdn.com/coding4fun/articles/AutotuneNET)。

# ios - 执行“END”时，Sqlite 数据库被锁定

> ID：13629290
> 
> 赞同：1
> 
> 时间：2012-11-29T15:39:18.457
> 
> 标签：ios, sqlite, xamarin.ios

为了加快我在 iOS6 上的 Sqlite3 数据库上的数据库插入，我将插入包装在“BEGIN”和“END”命令中。数据库设置为以序列化模式运行。有趣的是，我在执行“END”时遇到了一个异常：错误说数据库被锁定。好吧，我希望它会被锁定，毕竟据我所知，我正在进行交易。有人可以解释什么条件会导致这种行为吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T21:17:25.110

我发现了问题。要使序列化访问工作，您可能只有一个连接。在我的测试项目中，我忘记实现连接缓存。这样，我最终为每个数据库获得了很多（打开的）连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T18:15:48.600

它一定很简单，因为 BEGIN/END 命令没有什么花哨的。我努力重现您的问题（消除`sqlite3_finalize`、消除`BEGIN`等），但我做不到。我知道生成该错误的唯一方法是多次打开数据库或使用后台队列执行某些操作。

您必须与我们共享源代码。也许您正试图重新打开数据库？或者你在后台队列中有什么东西可以保存它？等等。

您提到以串行模式打开数据库。我是否从中推断出您有多个队列/线程进行数据库操作？我个人通过将我的数据库调用发送到的串行队列来序列化我的数据库操作，这保证了串行操作，因此我不必担心以特定模式打开数据库。也许您可以描述以串行模式打开数据库的基本原理。

但是，无论如何，这是一个直接使用调用的示例插入方法`sqlite`（尽管我承认我通常使用[FMDB](https://github.com/ccgus/fmdb)来消除这样的丑陋代码）：

```
- (void)sqlInsert
{
    sqlite3_stmt *statement;
    sqlite3 *database = NULL;
    int rc;
    char *errmsg;

    if ((rc = [self openDatabase:&database]) != SQLITE_OK) // my open does the necessary parsing of the path, copying files, etc.
    {
        NSLog(@"%s database open error %d", __FUNCTION__, rc);
        return;
    }

    sqlite3_exec(database, "BEGIN", NULL, NULL, &errmsg);
    if (errmsg != NULL)
    {
        NSLog(@"%s exec BEGIN SQL error '%s'", __FUNCTION__, errmsg);
        sqlite3_free(errmsg);
    }

    const char *insertSql = "INSERT INTO CONTACTS (name, address, phone) VALUES (?, ?, ?)";

    if (sqlite3_prepare_v2(database, insertSql, -1, &statement, NULL) != SQLITE_OK)
        NSLog(@"%s prepare SQL error '%s' (%1d)", __FUNCTION__, sqlite3_errmsg(database), sqlite3_errcode(database));

    if (sqlite3_bind_text(statement, 1, [self.contactName.text UTF8String], -1, NULL) != SQLITE_OK)
        NSLog(@"%s bind contactName error '%s'", __FUNCTION__, sqlite3_errmsg(database));

    if (sqlite3_bind_text(statement, 2, [self.contactAddress.text UTF8String], -1, NULL) != SQLITE_OK)
        NSLog(@"%s bind contactAddress error '%s'", __FUNCTION__, sqlite3_errmsg(database));

    if (sqlite3_bind_text(statement, 3, [self.contactPhone.text UTF8String], -1, NULL) != SQLITE_OK)
        NSLog(@"%s bind contactPhone error '%s'", __FUNCTION__, sqlite3_errmsg(database));

    if (sqlite3_step(statement) == SQLITE_DONE)
        NSLog(@"%s Contact added", __FUNCTION__);
    else
        NSLog(@"%s step SQL error '%s' (%1d)", __FUNCTION__, sqlite3_errmsg(database), sqlite3_errcode(database));

    sqlite3_finalize(statement);

    sqlite3_exec(database, "END", NULL, NULL, &errmsg);
    if (errmsg != NULL)
    {
        NSLog(@"%s exec END SQL error '%s'", __FUNCTION__, errmsg);
        sqlite3_free(errmsg);
    }        

    sqlite3_close(database);
} 
```

# android - Android 截屏命令 - 从哪个 android 版本开始？

> ID：13629294
> 
> 赞同：1
> 
> 时间：2012-11-29T15:39:34.597
> 
> 标签：android, version, screenshot

我使用 root 访问权限和位于 /system/bin/screencap的命令*screencap截屏*

问：/system/bin/screencap 有哪些安卓版本？它适用于我的 ICS，我想知道我可以为哪些 android 版本发布我的应用程序。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-23T08:01:45.127

正如我在[源代码](https://github.com/android/platform_frameworks_base/commit/88a5df93668cb2079d10fd55de25a333f5f43842#diff-7f01b3c71f03ea738aadc95cf9d5d8f6)`cmds/screencap/screencap.cpp`中看到的那样：设置为的第一个标记`android-3.2.4_r1`然后这个工具首先出现在`Android 3.2.4 release 1`.

但我应该注意，并非此实用程序的所有选项都可以立即使用。因此，您最好查看[代码历史](https://github.com/android/platform_frameworks_base/commits/master/cmds/screencap/screencap.cpp)以准确了解您需要哪些版本是受支持的选项。

例如：

*   另存为 png[可](https://github.com/android/platform_frameworks_base/commit/5cff0630eb970faf1682095ca434b204628b4d62#diff-7f01b3c71f03ea738aadc95cf9d5d8f6)从`android-3.2.4_r1`.
*   选项`-d` [可](https://github.com/android/platform_frameworks_base/commit/0b722fe9ce98d97dbcb6fefd170b85ab7037e528#diff-7f01b3c71f03ea738aadc95cf9d5d8f6)从`android-4.2.1_r1`.

另一个注意事项：在自定义固件中，此命令可能不是。它只是应用程序`/system/bin/`，它可能不存在。

# vba - 如何自动删除Excel中包含“总计”的所有行？

> ID：13629297
> 
> 赞同：2
> 
> 时间：2012-11-29T15:39:41.343
> 
> 标签：vba, excel

在我名为报告的活动表中，我有 2 列 I 和 F。

它具有包含文本**"Grand Total"**的重复单元格。

如果它自动包含总计，我想删除整行。

VBA代码会很好。

![在此处输入图像描述](../Images/dd3fdd52b84964bc2037a3405826c0a1.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T15:48:25.170

使用下面的 VBA 代码，可以快速删除具有特定单元格值的行，请按以下步骤操作：

1.  选择要删除特定行的范围。

2.  点击 Developer>Visual Basic，会弹出一个新的 Microsoft Visual Basic for applications 窗口，点击 Insert > Module，在 Module 中输入以下代码：

    根据单元格值（即总计）删除整行的 VBA 代码：

    ```
    Sub Delete_Rows()
        Dim rng As Range, cell As Range, del As Range
        Set rng = Intersect(Range("A1:D22"), ActiveSheet.UsedRange)
        For Each cell In rng
        If (cell.Value) = "Grand Total" _
        Then
        If del Is Nothing Then
        Set del = cell
        Else: Set del = Union(del, cell)
        End If
        End If
        Next cell
        On Error Resume Next
        del.EntireRow.Delete
        End Sub 
    ```

3.  然后单击“播放/运行”按钮运行代码，具有一定值的行已被删除。

（注意：如果您在 Excel 中看不到“开发人员”选项卡，请执行以下步骤： 1）单击“Office”按钮，然后单击“Excel 选项”。2) 在“流行”类别中，在“使用 Excel 的热门选项”下，选中“功能区”复选框中的“显示开发人员”选项卡，然后单击“确定”。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T00:49:31.817

使用`AutoFilter`效率很高。这也可以在没有`VBA`（即手动）的情况下完成

**主副**

```
Sub Main()
Dim ws As Worksheet
Dim rng1 As Range
Dim StrIn As String
Dim rng2  As Range
Set ws = Sheets("Sheet1")
Application.ScreenUpdating = False
Set rng1 = ws.Range("F:F,I:I")
StrIn = "Grand Total"
For Each rng2 In rng1.Columns
Call FilterCull(rng2, StrIn)
Next
Application.ScreenUpdating = True
End Sub 
```

**删除子**

```
Sub FilterCull(ByVal rng2, ByVal StrIn)
With rng2
    .Parent.AutoFilterMode = False
    .AutoFilter Field:=1, Criteria1:=StrIn
   .EntireRow.Delete
    .Parent.AutoFilterMode = False
    End With
End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T15:43:45.723

这应该可以帮助您入门。

[http://msdn.microsoft.com/en-us/library/office/ee814737%28v=office.14%29.aspx#odc_Office14_ta_GettingStartedWithVBAInExcel2010_VBAProgramming101](http://msdn.microsoft.com/en-us/library/office/ee814737%28v=office.14%29.aspx#odc_Office14_ta_GettingStartedWithVBAInExcel2010_VBAProgramming101)

另见类似问题： [Delete a row in Excel VBA](https://stackoverflow.com/questions/7851859/delete-a-row-in-excel-vba)

# breeze - BreezeJS core.config 更改

> ID：13629298
> 
> 赞同：1
> 
> 时间：2012-11-29T15:39:43.760
> 
> 标签：breeze

在之前的构建中，我使用了 setProperties 并省略了 trackingImplementation，我决定手动使用淘汰赛来加快速度，（我有很多实体）。

现在它更改为这种语法，即使我注释掉“ko”行，它仍然会创建 observables，有没有办法防止这种情况发生？

```
core.config.initializeAdapterInstances({
//        modelLibrary: "ko",
          dataService: "webApi"
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T01:17:13.690

我正在将大约 5000-10000 个实体加载到缓存中，这些是“客人”，它们将在一个晚上从客人列表中剔除，我需要将它们离线存储，因为如果我失去连接，那么应用程序将无法完成其工作。我也在移动设备上运行，它有一个额外的命中，当我使用 KO 时，从服务器带来的每个实体都成为一个可观察属性的列表，这显然是矫枉过正并且在 iPhone 上崩溃了 safari。相反，我等待用户使用微风本地查询从 10,000 个实体中进行搜索，然后为搜索结果中的每个访客实例化一个带有可观察对象的访客。这使我可以使用敲除进行绑定，而让其余实体单独使用，它运行良好并且在 ios 设备上也表现良好。现在只是阅读“扩展实体”

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:24:06.943

我在您的评论中看到您尝试过`...modelLibrary: backingStore...`。我打算建议这个。但是后来我担心您的手动 KO 属性会绕过 backingStore 属性并且轮子会脱落。我认为如果您添加 KO 计算来读取和写入 backingStore 属性，它可能会起作用（没有尝试过）......但是它们必须具有不同的、不冲突的名称，对吧？

让我们暂时回到根本原因。使用 ko 模型库有什么太慢的地方，而你在做什么更快？我无法想象 KO 属性的定义如何成为性能问题。你是如何测量速度差异的？速度差异是什么？

[此外，您是否尝试在您自己的实体类型构造函数中定义 KO 属性并使用“扩展实体](http://www.breezejs.com/documentation/extending-entities)`MetadataStore`”中描述的那样注册该构造函数？

# android - 在遍历 ArrayList 时添加到 Sqlite 数据库

> ID：13629300
> 
> 赞同：1
> 
> 时间：2012-11-29T15:39:48.293
> 
> 标签：android, sqlite, arraylist

我有一个简单的预算程序，允许您按下发薪日按钮，该按钮将通过预算制定时设置的金额增加预算中的当前金额。我无法从数组列表中获取值，同时仍然能够将它们准确地添加到数据库中，这就是我到目前为止所拥有的

```
 for(String amount: pds)
        {
            t2.put(KEY_AMOUNT, amount);
        }

        for(String Id: bIds)
        {
            t2.put(KEY_TRANSACTION,a);
            t2.put(KEY_DATE, date);
            t2.put(KEY_CATEGORYID, Id);
        }

        ourDatabase.insert(DATABASE_TABLE2,null,t2);
        return ourDatabase; 
```

所有这一切都是将最后一个值放入每个列表中。我已经尝试了其他几种方法，但无法做到正确，所有帮助都得到了极大的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:47:46.833

我假设这`t2`是一个 ContentValues 对象。它们对每个键都有一个值，因此将键设置 12 次只会覆盖每次。如果您想为每个值创建不同的记录，则需要在每个值之后插入。如果您希望将它们连接到 CSV 列表或其他内容中，则需要使用[TextUtils](http://developer.android.com/reference/android/text/TextUtils.html)连接方法来连接这些值。如果这样做，请确保您的列类型为`TEXT`.

# asp.net-mvc - 在 mvc 3 表单上显示子项目？

> ID：13629305
> 
> 赞同：0
> 
> 时间：2012-11-29T15:40:02.510
> 
> 标签：asp.net-mvc, entity-framework, list

（警告新手）我正在使用 codefirst 实体框架（使用 MVC3）并尝试显示步骤列表及其相关问题。不知道为什么我的语法会引发异常“ObjectContext 实例已被释放，不能再用于需要连接的操作。”：

```
@model IEnumerable<COPSGMIS.Models.Step>

@{
    ViewBag.Title = "Questionaire";
}

<h2>Questionaire</h2>
   @using (Html.BeginForm("Questionaire", "Question", FormMethod.Post, new { id = "SignupForm" }))
   {
       <div>
            @foreach (var item in Model)
            {
              <fieldset class="wizard">
                <legend class="wizard">@Html.DisplayFor(modelItem => item.Title)</legend>
                @foreach (var question in item.Questions)
                //*** item.Questions is throwing an exception  ****
                {
                <label for="question">@Html.DisplayFor(modelItem => question.QuestionText)</label>
                <input id="question" type="text" /> 
                }
              </fieldset>
            }            
        <p>
            <input id="SaveAccount" type="button" value="Save" />
        </p>
    </div>
   } 
```

我的模型：

```
public int StepID { get; set; }
        public int ReviewID { get; set; }
        public string Title { get; set; }
        public string Description { get; set; }
        public int StepOrder { get; set; }
        public virtual ICollection<Question> Questions { get; set; } 
```

我的控制器：

```
var steps = from b in db.Steps
                            orderby b.StepOrder
                            select b;
                return View(steps.ToList()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:53:12.067

当 item.Questions 被访问时，EF 将尝试访问数据库以获取该项目的问题。如果上下文已被释放，它将失败。由于您将遍历视图中的问题，因此建议您使用“包含”将它们添加到您的初始查询中。

```
var steps = from b in db.Steps.Include(s => s.Questions)
            orderby b.StepOrder
            select b;

return View(steps.ToList()); 
```

# bit-manipulation - 逐位读取文件形成霍夫曼编码树

> ID：13629310
> 
> 赞同：1
> 
> 时间：2012-11-29T15:40:30.713
> 
> 标签：bit-manipulation, huffman-code

这个问题需要我从一个文件中读取一个标题，即基于位的压缩文件，以提取形成树所需的必要信息。通常头部看起来是这样的：“1g1o01s1 01e1h01p1r0000013\n” 1 代表叶节点，0 代表我们何时需要形成一棵树。还有一个额外的 0 将标题信息与文件中的字符数分开。我拥有所有可以创建树并打印其内容的东西，但是我在阅读信息时遇到了麻烦。当我执行代码时，我的输出之一在叶子中包含一个'1'，而它不应该包含一个'1'。这是否意味着当我想获取位时我错过了处理字节？

![命令行输出](../Images/79be421cafb5b7befd177047436b607c.png)

> 这是来自主要的代码：

```
while((num = ReadBit(fp, 'b')))
{
    //printf("num = %c\n", num);
    if(num == '1')
    {
        letter = ReadBit(fp, 'c');
        printf("letter = %c\n\n", letter);
        new_node = CreateNode(letter);
        Push(&Fake, new_node);
        Onecount++;
    }
    if(num == '0')
    {
        First = Pop(&Fake);
        Second = Pop(&Fake);
        new_node = malloc(sizeof(LEAF));
        new_node-> rchild = First;
        new_node-> lchild = Second;
        Push(&Fake, new_node);
        Zerocount++;
    }

    if(Onecount == Zerocount)
    {
        break;
    }

} 
```

> 这是来自 ReadBit 功能的代码

```
int ReadBit(FILE *fp, char mode)
{  
unsigned char value;
unsigned static int count = 0;
unsigned static char letter = 0;
unsigned static char byte;
unsigned static int place;

    /* This is the bit mode, it will grab the first bit from the current byte and return it */
if(mode == 'b')
{
    if(count == 0)
    {
        fread(&byte, 1, 1, fp);
    }

    value = (((byte & (1 << (7 - count))) == 0) ? '0' : '1');
    count++;
    letter = byte << count;

    if(count == 8)
    {
        count =  0;
    }

    place = 8 - count;
}

/*This is "character" mode. It will grab enough bits in order to create a byte that will be a letter */
if(mode == 'c')
{
    if(count == 0)
    {
        fread(&letter, 1, 1, fp);
    }
    else
    {
        /* This will read in a new byte and add in as many bits as we need to complete a byte from the previously saved bits */
        fread(&byte, 1, 1, fp);
        value = letter + (byte >> place);
    }
}

return(value);
 } 
```

# email - 在 Magento 中为电子邮件模板设置区域设置

> ID：13629313
> 
> 赞同：1
> 
> 时间：2012-11-29T15:40:43.083
> 
> 标签：email, magento, locale, magento-1.4, transactional-email

我有一个 Mageneto 1.4 安装，当订单被搁置时会发送一封定制的电子邮件。这一切都很完美，但它只会发送英文电子邮件。当订单从英语和德语商店进来时，他们仍然会收到英语电子邮件。

我目前使用的 holdAction 方法如下所示：

```
public function holdAction()
{
    if ($order = $this->_initOrder()) {
        try {
            $order->hold()
                ->save();
            $this->_getSession()->addSuccess(
                $this->__('Order was successfully put on hold.')
            );
            $emailTemplate  = Mage::getModel('core/email_template')
                    ->loadDefault('customer_payment_declined');
            $emailTemplateVariables = array();
            $emailTemplateVariables['order'] = $order;
            $emailTemplateVariables['customername'] = $order->getCustomerName();
            $processedTemplate = $emailTemplate->getProcessedTemplate($emailTemplateVariables);
            $emailTemplate->setSenderName('example.com');
            $emailTemplate->setSenderEmail('customerservice@example.com');
            $emailTemplate->setTemplateSubject('Your order – '.$order->getIncrementId());
            $emailTemplate->send($order->getCustomerEmail(),$order->getCustomerName(), $emailTemplateVariables);

        }
        catch (Mage_Core_Exception $e) {
            $this->_getSession()->addError($e->getMessage());
        }
        catch (Exception $e) {
            $this->_getSession()->addError($this->__('Order was not put on hold.'));
        }
        $this->_redirect('*/sales_order/view', array('order_id' => $order->getId()));
    }
} 
```

我尝试过以各种方式通过语言环境，但我没有任何运气。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:59:38.257

不同语言的不同电子邮件模板在我们的一个网站上运行良好。这也是 Magento v.1.4

我们有两组语言环境：
app/locale/nl_NL/template/email/
app/locale/en_US/template/email/

我们还为每个网站范围设置了不同的区域设置：
配置 -> 常规 -> 区域设置选项

# c# - 如何在asp:ListView LayoutTemplate ItemTemplate中使用asp:Table

> ID：13629317
> 
> 赞同：1
> 
> 时间：2012-11-29T15:41:10.097
> 
> 标签：c#, asp.net, listview

调用 ListView 的 DataBind() 方法时收到以下异常消息

`'Table' cannot have children of type 'ListViewDataItem'.`

这是我的标记

```
<asp:ListView ID="lv" runat="server">
    <LayoutTemplate>
        <asp:Table ID="t" runat="server" CssClass="contentframework">
            <asp:TableHeaderRow>
                <asp:TableHeaderCell>1</asp:TableHeaderCell>
                <asp:TableHeaderCell>2</asp:TableHeaderCell>
            </asp:TableHeaderRow>

            <asp:TableRow ID="itemPlaceHolder" runat="server" />

        </asp:Table>

    </LayoutTemplate>

    <ItemTemplate>
        <asp:TableRow>
            <asp:TableCell><%# Eval("1") %></asp:TableCell>
            <asp:TableCell><%# Eval("2") %></asp:TableCell>
        </asp:TableRow>
    </ItemTemplate>

    <EmptyDataTemplate>
        <h2>No Records!</h2>
    </EmptyDataTemplate>
</asp:ListView> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-19T13:13:43.303

Asp.net 服务器端控件有一些[层次结构](http://msdn.microsoft.com/en-us/library/aa310919%28v=vs.71%29.aspx)。所以它不允许`ListViewDataItem`作为 element 的子`asp:Table`元素。

因此，最好尝试简单的 html 表格标签而不是服务器端标签，例如：

```
<asp:ListView ID="lv" runat="server">
    <LayoutTemplate>
        <table id="t" class="contentframework">
            <thead>
                <th>
                    1
                </th>
                <th>
                    2
                </th>
            </thead>
           <tr id="itemPlaceholder" runat="server"></tr>
        </table>
    </LayoutTemplate>
    <ItemTemplate>
        <tr>
            <td>
                <%# Eval("1") %>
            </td>
            <td>
                <%# Eval("2") %>
            </td>
        </tr>
    </ItemTemplate>
    <EmptyDataTemplate>
        <h2>
            No Records!</h2>
    </EmptyDataTemplate>
</asp:ListView> 
```

作为列表视图的参考，您可以查看[这篇](http://www.codeproject.com/Articles/24570/Complete-ListView-in-ASP-NET-3-5)文章。

**更多细节：**

您正面临异常，因为[ListViewDataItem](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listviewdataitem%28v=vs.90%29.aspx)类表示 ListView 控件（即 DataBoundControl）中的单个数据项，因此它不能直接是 Table 类的子控件，但当您直接嵌入时，它显然可以是 HTML 表的子控件将其转换为 html 标签（如上面的代码所示）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:58:18.533

尝试这个：

```
<LayoutTemplate>
    <asp:Table ID="t" runat="server" CssClass="contentframework">
        <asp:TableHeaderRow>
            <asp:TableHeaderCell>1</asp:TableHeaderCell>
            <asp:TableHeaderCell>2</asp:TableHeaderCell>
        </asp:TableHeaderRow>

        <asp:PlaceHolder id="itemPlaceholder" runat="server" />

    </asp:Table>

</LayoutTemplate> 
```

这应该允许列表项填充为实际行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-01T17:42:20.040

您必须在 asp:TableRow 中嵌套一个 asp:tableCell ，然后占位符应该在 tablecell 中工作

```
<asp:TableRow runat="server">
    <asp:TableCell ID="TableCell2" runat="server">
        <asp:PlaceHolder runat="server" ID="itemplaceholder" />
    </asp:TableCell>
</asp:TableRow>` 
```

# internet-explorer-8 - IE Mobile 条件注释由 ie8 及更低版本读取

> ID：13629318
> 
> 赞同：0
> 
> 时间：2012-11-29T15:41:15.680
> 
> 标签：internet-explorer-8, responsive-design, conditional-comments, ie-mobile

我正在开发一个响应式站点并使用媒体查询，IE8 以及 Windows Phone 上的 Internet Explorer 都无法读取这些查询。因此，我对这些使用条件注释。对于 IE8 及更低版本，我使用以下代码段来包含屏幕 css：

```
<!--[if lt IE 9]>
...some stylesheets...
<![endif]--> 
```

对于 windows phone，我必须包含移动分辨率的 css，并且我正在使用以下代码段：

```
<!--[if IEMobile]> 
...some stylesheets...
<![endif]--> 
```

我的问题是 IE 8 似乎也在 IE Mobile 的条件注释中使用样式表，因为一旦我在 IE Mobile 的条件注释中包含样式，IE8 及以下版本的整个站点就会崩溃。

我也试过这个组合：

```
<!--[if (IEMobile)&!(lt IE 9)]> 
```

但没有成功。也许组合的想法是正确的，我只是在语法上犯了一个错误，或者 IE8 和关于 IE Mobile 的相当新的条件注释存在一些问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-27T13:07:39.527

据此：[http ://dev.bowdenweb.com/html/ie-conditional-comments.html](http://dev.bowdenweb.com/html/ie-conditional-comments.html)

您应该能够使用此语法来组合条件：

```
<!--[if IEMobile]><![if gt IE 8]> Yo IE 9+ on mobiles <![endif]><![endif]--> 
```

# python - 使用 py2exe 处理动态导入

> ID：13629321
> 
> 赞同：4
> 
> 时间：2012-11-29T15:41:18.283
> 
> 标签：python, py2exe, dynamic-import

使用 py2exe 为我的应用程序准备 .exe 时遇到问题。这个问题的根源是我创建的以下函数来使用动态定义模块中的类。

```
def of_import(module, classname, country = None):
    '''
    Returns country specific class found in country module
    '''
    if country is None:
       country = CONF.get('simulation', 'country')
    _temp = __import__(country + '.' + module, 
                       globals = globals(), 
                       locals = locals(), 
                       fromlist = [classname], 
                       level=-1)
    return getattr(_temp, classname, None) 
```

当我尝试使用以下方法加载某些类时：

```
self.InputTable = of_import('model.data', 'InputTable') 
```

运行.exe时出现以下错误：

```
File "core\utils.pyc", line 900, in of_import
ImportError: No module named france.model.data 
```

我应该准确地说 france.model.data.py 确实存在。

处理这个问题的适当方法是什么？

此处的信息是安装文件的链接：[https ://github.com/openfisca/openfisca/blob/dev/src/setup_x64.py](https://github.com/openfisca/openfisca/blob/dev/src/setup_x64.py)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T11:08:55.030

我有类似的设置

确保在 py2exe 的“包”部分添加动态模块

```
setup(windows=[{
                "script" : "openFisca.pyw"
                }], 
      options={"py2exe" : {"includes" : ["sip", "encodings.*", "numpy.*"],
                           "packages": ["france","tunisia"],
                           "dist_dir": dist_dir,
                           "bundle_files":3,
                           "dll_excludes": ["MSVCP90.dll"]
                           }}, 
      data_files=data_files) 
```

# scala - SORM：我如何声明外键？

> ID：13629324
> 
> 赞同：5
> 
> 时间：2012-11-29T15:41:29.897
> 
> 标签：scala, sorm

我对 SORM 很感兴趣，但是当我尝试使用它时遇到了问题。假设我有两个实体：

```
case class User(login: String, firstName: String, lastName: String)
case class UserSite(userId: Int, name: String, url: String) 
```

如何声明外键关系 UserSite.userId -> User.id？我看到类 ForeignKey，但没有任何使用它的例子。

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-29T16:21:51.843

一个展示 SORM 力量的绝佳机会。

正如 SORM 的[特性](http://sorm-framework.org/#features)中所指出的，它从**所有**关系概念中抽象出来。这包括外键。

外键抽象是通过对您想用外键引用的这些实体的自然直接引用来提供的。因此，您应该使用属性指向自身，而不是`userId`指向`id`of ：`User``User``user`

```
case class User(login: String, firstName: String, lastName: String)
case class UserSite(user: User, name: String, url: String) 
```

在引擎盖下，这将完全转化为您希望使用外键实现的目标。但问题是你不必关心它。

*旁注。使用 SORM 时，您应该按照您希望在 Scala 中使用它的方式来设计您的模型，几乎没有任何限制，并且您绝对应该抛开您在设计模型时习惯的所有关系概念。这就是 SORM 的方式。*

关于文档和库结构。该方法非常简单：如果没有记录，则不打算将其用作公共 API 的一部分。此外，对于 SORM 的当前 (v. `0.3.x`) 结​​构，公共 API 的所有组件都驻留在`sorm._`包中，因此另一条规则是，如果它不存在，则它不适用于公共 API。

# php - 在for循环php中更改匹配字符串字符的颜色

> ID：13629325
> 
> 赞同：0
> 
> 时间：2012-11-29T15:41:37.473
> 
> 标签：php

我有这个循环：

```
for ($m=0; $m<7; $m++){
if ($myextra[$m] == $drawextra[$m]) {
$myextra[$m] = '<span class="matchx">'.$myextra[$m].'</span>';
}
}
echo $myextra; 
```

我的回声输出如下：

```
 3445<<8
<11<<6<
<45<<<< 
```

中的类来自我的样式表，应该为字符串中匹配的字符着色，但匹配的字符只需用“<”替换。他们处于正确的位置，但我怎样才能正确分配该类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:02:33.850

您不能使用 [] 表示法更改字符串中的多个字符。您必须使用新变量：

```
$result = '';
for ($m=0; $m<7; $m++){
    if ($myextra[$m] == $drawextra[$m]) {
        $result .= '<span class="matchx">'. $myextra[$m] .'</span>';
    } else {
        $result .= $myextra[$m];
    }
}
echo $result; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:04:36.750

尝试使用临时变量，即：

```
$rez = "";
for ($m=0; $m<7; $m++){
  if ($myextra[$m] == $drawextra[$m]) {
    $rez .= '<span class="matchx">'.$myextra[$m].'</span>';
  }else{
    $rez .=$myextra[$m];
  }
}
$myextra = $rez;
unset($rez);

echo $myextra; 
```

# ios - 带有文本字段的自定义单元格未保存在 UITableView 的内存中

> ID：13629327
> 
> 赞同：1
> 
> 时间：2012-11-29T15:41:41.523
> 
> 标签：ios, uitableview

我正在尝试创建一个注册表单，其中包含大约 20 个不同的字段，分为四个不同的部分。我为此创建了一个自定义单元格，其中包含一个标签和一个 UITextField，并且我的 tableview 上有一个字典数组，指示标签的名称应该是什么，以及 texftield 的标签（因为根据我使用 UIPicker 输入数据的标签）。

问题是，当我开始编辑字段时，向下滚动和备份所有内容都会变得混乱，并且在字段上更改它不应该......我发现这显然正在发生，因为我正在对单元格进行出队所以它是创建重复的引用，所以我每次都尝试创建一个新单元格，但这不起作用，因为它只会用我需要的确切数量的单元格初始化一个表格视图，但里面只有没有内容（标签或文本字段）的空白单元格.

考虑到按下按钮时我必须检索它们的值这一事实，最简单的方法是什么，这样我就可以为每个单元格保留不同的内存引用？

我已经阅读了[这篇](https://stackoverflow.com/questions/7202647/what-are-the-best-practices-for-implementing-form-in-ios)文章的建议，但仍然不知道如何创建一个单元格数组。

有什么帮助吗？

这是我的定义的代码：

```
NSArray *section1 = [[NSArray alloc] initWithObjects:
                     [NSDictionary dictionaryWithObjectsAndKeys:@"100",@"tag",@"Title",@"title",@"title",@"fieldName",nil],
                     [NSDictionary dictionaryWithObjectsAndKeys:@"0",@"tag",@"First Name",@"title",@"first_name",@"fieldName",nil],
                     [NSDictionary dictionaryWithObjectsAndKeys:@"0",@"tag",@"Last Name",@"title",@"last_name",@"fieldName",nil],
                     [NSDictionary dictionaryWithObjectsAndKeys:@"0",@"tag",@"Job Title",@"title",@"job_title",@"fieldName",nil],
                     [NSDictionary dictionaryWithObjectsAndKeys:@"0",@"tag",@"Email",@"title",@"email",@"fieldName",nil],
                     [NSDictionary dictionaryWithObjectsAndKeys:@"0",@"tag",@"Confirm Email",@"title",@"confirm_email",@"fieldName",nil],
                     [NSDictionary dictionaryWithObjectsAndKeys:@"0",@"tag",@"Password",@"title",@"password",@"fieldName",nil],
                     [NSDictionary dictionaryWithObjectsAndKeys:@"0",@"tag",@"Confirm Password",@"title",@"conf_password",@"fieldName",nil],
                     [NSDictionary dictionaryWithObjectsAndKeys:@"0",@"tag",@"Phone",@"title",@"phone",@"fieldName",nil],
                     nil];

....

self.formItems = [[NSArray alloc] initWithObjects:
                  section1,
                  section2,
                  section3,
                  section4,
                  section5,
                  nil]; 
```

然后我在 cellForRowAtIndexPath 上使用的代码如下：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"freeTrialFormCell";
    TSIFreeTrialFormCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[TSIFreeTrialFormCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    NSArray* sectionData = [self.formItems objectAtIndex:indexPath.section];
    NSDictionary* myFieldInfo = [sectionData objectAtIndex:indexPath.row];

    if ([[myFieldInfo objectForKey:@"fieldName"] rangeOfString:@"password"].location != NSNotFound) {
        cell.textField.secureTextEntry = YES;
    }

    cell.fieldName = [myFieldInfo objectForKey:@"fieldName"];
    cell.textField.placeholder = [myFieldInfo objectForKey:@"title"];
    cell.textField.tag = [[myFieldInfo objectForKey:@"tag"] integerValue];
    cell.label.text = [myFieldInfo objectForKey:@"title"];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:20:26.670

UITableView 在您上下滚动时重用单元格，因此您将丢失仅输入该单元格的信息。我所做的是创建一个数组来保存这些单元格的输入。

基本上：

```
enteredText = [[NSMutableArray alloc] init]; //iVar, not local variable
for (int i=0; i<numTableRows; i++) {
   [enteredText addObject:@""]; //fill with dummy values that you will replace as user types
} 
```

然后在您的表格视图文本字段中，将自己设置为文本字段的代表并实现`textFieldDidEndEditing`. 在该方法中，将该行的值替换`enteredText`为用户的文本。

制作单元格时，将文本字段文本设置为数组中的值：

```
myCell.textField.text = [enteredText objectAtIndex:indexPath.row]; 
```

一开始它是空白的，然后在用户放东西后会保留用户的文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:50:13.927

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
        TSIFreeTrialFormCell *cell = [[TSIFreeTrialFormCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"cell"] autorelease];

    NSArray* sectionData = [self.formItems objectAtIndex:indexPath.section];
    NSDictionary* myFieldInfo = [sectionData objectAtIndex:indexPath.row];

    if ([[myFieldInfo objectForKey:@"fieldName"] rangeOfString:@"password"].location != NSNotFound) {
        cell.textField.secureTextEntry = YES;
    }

    cell.fieldName = [myFieldInfo objectForKey:@"fieldName"];
    cell.textField.placeholder = [myFieldInfo objectForKey:@"title"];
    cell.textField.tag = [[myFieldInfo objectForKey:@"tag"] integerValue];
    cell.label.text = [myFieldInfo objectForKey:@"title"];

    return cell;
} 
```

但这会影响性能，因为您正在为每一行创建单元格

# c# - DataGrid 绑定字段抛出 TargetInvocationExeption

> ID：13629331
> 
> 赞同：1
> 
> 时间：2012-11-29T15:42:03.530
> 
> 标签：c#, asp.net, gridview, properties

这是我的网格视图代码隐藏。

```
gridViewLog.DataSource = LogManager.getEntriesByUser(UserManager.getCurrentUser());
gridViewLog.AutoGenerateColumns = false;

BoundField ev = new BoundField();
ev.DataField = "getMessage";
ev.HeaderText = "Ereignis";
gridViewLog.Columns.Add(ev);

BoundField name = new BoundField();
name.DataField = "User.Name";
name.HeaderText = "Name";
gridViewLog.Columns.Add(name);

gridViewLog.DataBind(); 
```

LogManager.getEntriesByUser(int id) 返回一个 LogEntry-Objects 列表。LogEntry-Class 如下所示：

```
public class LogEntry
{
    private User user;
    public User User
    {
        get {
            if(user == null)
                user = UserManager.getUserById(userId);
            return user;
        }
    }

public virtual String getMessage
    {
        get
        {
    return "test";
        }
    }
} 
```

这工作正常。但是当我的列表包含以下类的对象时，我得到一个例外。

```
 class NeuerKunde : LogEntry
{

    public override String getMessage
    {
        get { return "Test2"; }
    } 
} 
```

例外：“Der Eigenschaftenaccessor getMessage für das Model.LogEntry-Objekt hat folgende Ausnahme verursacht: Das Objekt stimmt mit dem Zieltyp nicht überein”

翻译：“Model.LogEntry-Object 的 Property-Accessor getMessage 导致异常：对象与目标类型不匹配。”

innerExeption 是一个 TargetExeption 并表示相同。

尝试在没有反射的情况下访问属性可以正常工作。

我认为它与试图调用 getMessage-Property 的 gridView 有关，但我不知道如何修复它......

任何人？

# vba - 计算半年周期的分子和分母

> ID：13629339
> 
> 赞同：0
> 
> 时间：2012-11-29T15:42:33.593
> 
> 标签：vba, excel, excel-2007

嗨，我有一个用于计算季度利率的 ocde。要从日期计算季度，我在代码中有“YYYYq”。任何人都可以帮助用半年一次的时间段替换季度。我已经尝试过“YYYY/2”，但这确实是工作。我也尝试过使用“YYYYmm”，但也没有用。

我想有半年期的分子和分母。例如：如果访问日期是 2012 年 1 月 1 日，那么这将计入今年上半年。2012 年 1 月 1 日至 2012 年 6 月 30 日期间的所有访问将计入第一个半年期，2012 年 6 月 30 日至 2012 年 12/31 日将计入第二个半年期。

非常感谢您的时间和建议。

```
 Function Visits(target_timeframe)

        Target_Quarter = Format(target_timeframe, "YYYYq")

        For vRow = 2 To 2000

            entered_timeframe = Format(Sheets("sheet1").Range("A" & vRow).Value, "YYYYq")

            Entered_Visits = Sheets("sheet1").Range("B" & vRow).Value 'equals value of column

            If (entered_timeframe = Target_Quarter) Then
                denominator = denominator + 1
                If (Entered_Visits > 0) Then
                    numerator = numerator + 1
                End If
            End If
        Next

        If denominator > 0 Then
            Average = numerator / denominator
        Else
            Average = "N/A"
        End If

    End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:19:51.190

测试格式的“q”部分，看它是1还是2，并相应地设置字符串。

```
Target_Half = Format(target_timeframe, "YYYY") & _
     IIf(Format(target_timeframe, "q") <= "2", "/1", "/2") 
```

这将使上半年`Target_Half`和下半年`YYYY/1``YYYY/2`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:25:03.993

半年没有自定义日期格式，因此您必须自己构建字符串。将函数中的第一行替换为：

```
Target_Quarter = Year(target_timeframe) & IIf(Month(target_timeframe) <= 6, 1, 2) 
```

您将不得不对循环中的第一行执行类似的操作。

# jquery - JQuery 确认对话框焦点导致主窗口上的下拉菜单失去焦点

> ID：13629341
> 
> 赞同：0
> 
> 时间：2012-11-29T15:42:36.137
> 
> 标签：jquery, jquery-ui, dialog, jquery-ui-dialog, confirmation

我设置了一个 JQuery 下拉菜单，以便在进行特定选择时显示一个确认对话框（也是 JQuery），其中包含一个注释字段和一个是/否按钮。我希望用户能够输入文本并在此确认窗口上单击是或否，而后台下拉菜单的状态保持不变。

不幸的是，只要我单击“确认”窗口中的任意位置，后台下拉菜单的状态就会丢失——它会回到默认状态。有一些简单的选择来处理这个吗？使其模态化没有影响。

以下是我的确认窗口定义：

```
 $(".change_status").Confirmation({
      header: "#{t.global.conf_header}",
      onload: function(){
        $("#newSync > .date_chooser").each( function(index, element){
          var minDate = new Date().addDays("#{medsync_post_offset}");
          var maxDate = new Date().addDays(100);
          calenderize(element, $(this).next(), null, minDate, maxDate);
        });
      },
      message: function(){
        if ($(this).html()=="#{t.medsync.resume}"){
          $("#activate").show();
          return $("#activate").html();
        }
        if ($(this).html()=="#{t.medsync.hold}"){
          $("#hold").show();
          return $("#hold").html();
        }
        if ($(this).html()=="#{t.medsync.remove}"){
          $("#activate").show();
          return $("#remove").html();
        }
      },

      buttons:
      [
        {text:"#{t.global.button_yes}", label: "Yes_btn", action: function(e)
           {
             //if ($(this).html()=="#{t.medsync.hold}" && $.trim($("input:text.comment:visible").val()).length < 1)
             if($("input.required:visible").size() > 0 && $.trim($("input.required:visible").val()) == "")
             {
               e.stopImmediatePropagation();
               $("input.required:visible").css("border","2px solid red").focus();
             }
             else
             {
               if ($(".required input:text:visible").size()>0 && $.trim($(".required input:text:visible").val()) == "")
               {
                 //e.stopImmediatePropagation();
                 $(".required input:text:visible").css("border","2px solid red !important;").focus();
               }
               else
               {
                 $.post($(this).attr("href"), $("form#sync_form").serialize()+"&"+$("form.status:visible").serialize(), function(response)
                 {
                   if (response=="OK") { window.location.reload(true);}
                 });
               }
             }
           }},
        {text:"#{t.global.button_no}", label: 'No_btn', action: function(){return false;}}
      ]
  }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:47:17.610

虽然不是一个完美的解决方案并且有点小技巧，但您可以存储下拉列表的选定索引和/或将其传递给您的对话框，然后在对话框关闭时将下拉列表设置为选定的索引，并可选择将焦点设置回下拉菜单。

# macos - 如何在 Mac OS X 中保留 USB 设备系统文件权限，例如 /dev/disk2？

> ID：13629342
> 
> 赞同：2
> 
> 时间：2012-11-29T15:42:37.457
> 
> 标签：macos, file-permissions, automount

除了使用磁盘仲裁器，它可以阻止设备自动挂载，我想更改特定 USB 设备的权限以备将来使用。例如，我的 diskXXX 可能是从 disk1 或 disk2 更改，但我希望设备权限从 rw-r----- 到 rw-rw---- 是否有在线文档可以理解设备创建过程和用户空间自动挂载模型。

# html - 在顶部添加一个 bg-image 用于活动链接 ， 可能的？

> ID：13629344
> 
> 赞同：0
> 
> 时间：2012-11-29T15:42:45.303
> 
> 标签：html, css, html-lists, background-image

我正在尝试在活动的链接上方添加小箭头类型的图像。我尝试了一些基本的东西，但我根本没有得到图像。可能我做错了什么，或者不可能......？

这就是我试图让它看起来像：

![我正在努力实现的示例](../Images/28f27f46016eaf63accc51766ae4fa3c.png)

当前的html：

```
<li><li class="currentlink"><a href="nieuws.php" target="_parent">nieuws</a></li>
<li><a href="behandelingen.php" target="_parent">behandelingen</a></li>
<li><a href="producten.php" target="_parent">producten</a></li> 
```

当前的 CSS：

```
.currentlink{background-image:url(images/naviarrow.png) no-repeat;width:25px;height:14px;} 
```

我在这里做错了什么......？有人可以解释或至少指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:54:37.340

而不是试图用“宽度”和“高度”放置图像。您可以声明样式“顶部”和“中心”，这会将您的图像完全放在那里。

例如：

```
.currentlink { background: #000 url(images/naviarrow.png) no-repeat top center } 
```

[jsFiddle 示例](http://jsfiddle.net/kEaVb/)

# domain-driven-design - 有界上下文找到边界？

> ID：13629350
> 
> 赞同：1
> 
> 时间：2012-11-29T15:43:08.843
> 
> 标签：domain-driven-design, aggregate, bounded-contexts

在我当前的项目（电子商务网站）中，我们有不同的限界上下文，例如：结算过程中的计费、交付或付款。

最重要的是，根据客户将购买什么，结帐过程会有所不同。因此，根据她购物车的内容，结帐过程中的步骤数可能会有所不同，否则我们不会/不会询问她某些信息。

那么是否应该为每种不同类型的结帐流程创建不同的有界上下文？

例如，Order 聚合根将根据结帐流程而有所不同 EticketsOrder（在这种情况下，我们不需要送货地址，因此我们不会向用户询问） Ticket BillingAddress

ClothesOrder （在这种情况下，我们需要一个送货地址，并且在结帐过程中将有一个额外的步骤来获得这个） Clothes BillingAddress DeliveryAddress

这种分离将意味着创建两个不同的域实体，即使它们具有相似的属性。

模拟此类问题的最佳方法是什么？如何找到上下文边界？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T16:20:45.013

有界上下文主要是语言边界。蓝皮书的引述（突出显示的关键部分）：

> **有界上下文界定了特定模型的适用性，**以便团队成员对什么必须保持一致以及它与其他上下文的关系有清晰和共同的理解。在该 CONTEXT 中，努力保持模型在逻辑上的统一，但不要担心超出这些界限的适用性。在其他 CONTEXTS 中，其他模型适用，但在术语、概念和规则以及无处不在的语言方言方面存在差异。

要问的一个问题是，创建的不同类型的订单是完全不同的聚合，还是它们都是具有不同值的订单聚合。不管它们是如何创建的，是否有必要考虑整个顺序？我已经构建并使用过电子商务系统，其中不同类型的订单都被建模为相同聚合的实例，只是具有不同的设置并且没有语言问题。另一方面，您域中的顺序可能不同，足以保证不同的上下文。

[我经常从功能凝聚力](http://en.wikipedia.org/wiki/Cohesion_%28computer_science%29)的角度考虑 BC 边界。如果你把订单分成两个BC，它们之间会不会有高度的耦合？如果是这样，这可能表明它们应该合并为一个 BC。另一方面，如果 BC 交互的唯一地方是为了报告目的，则无需将它们合并。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T08:10:11.580

看起来好像您可能错过了有界上下文。当这种情况发生时，人们倾向于尝试将功能融入现有的 BC。聚合根也会发生同样的事情。如果某些东西看起来很笨拙或没有意义，请尝试看看您是否错过了某些东西。

在您的示例中，我建议使用 Shopping BC（或任何有意义的名称）。您正在尝试将结帐流程融入您的 Order BC。您的 Shopping BC 将负责收集所有数据，然后将其传送到相关部分。

选择的产品类型将决定是否需要实物交付。

希望有帮助。

# php - PHP DOMDocument->getElementByID 添加 Â 代替空

> ID：13629351
> 
> 赞同：0
> 
> 时间：2012-11-29T15:43:11.870
> 
> 标签：php, dom, domdocument

我正在使用 PHP 的 DOMDocument 对象来解析一些 HTML（使用 cURL 获取）。当我通过 ID 获取元素并输出它时，任何空`<span> </span>`标签都会获得一个附加字符并变为`<span>Â </span>`.

编码：

```
<?php
    $document = new DOMDocument();
    $document->validateOnParse = true;

    $document->loadHTML( curl_exec($handle) );
    curl_close($handle);

    $element = $document->getElementById( __ELEMENT_ID__ );

    echo $document->saveHTML(); 
    echo $document->saveHTML($element);
?> 
```

该`$document->saveHTML()`命令按预期运行并打印出整个页面。但是，就像我上面说的，在`echo $document->saveHTML($element)`命令中将空`<span>`标签转换为`<span>Â </span>`.

这发生`<span> </span>`在`$element`.

*在这个过程中（通过 ID 获取元素并输出元素）插入这个额外的字符是什么？*我可以解决它，但我对找到根更感兴趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T18:44:53.440

我可以通过设置页面的字符编码来解决这个问题。我正在获取的页面没有定义的字符编码，我的页面只是一个没有定义标题信息的片段。当我添加

```
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head> 
```

问题消失了。

# wpf - 指定元素已经是另一个元素的逻辑子元素。先断开它。拆除后

> ID：13629353
> 
> 赞同：0
> 
> 时间：2012-11-29T15:43:27.003
> 
> 标签：wpf, vb.net

首先是我想要做的事情：我需要动态反转一个堆栈面板中项目的顺序，并在一秒钟内以相反的顺序添加它们。这是我正在使用的代码：

```
 Dim cp As ContentPresenter = TryCast(Utilities.GetDescendantFromName(TitleLegend, "ContentPresenter"), ContentPresenter)
        If cp IsNot Nothing Then
            Dim sp As StackPanel = TryCast(cp.Content, StackPanel)
            If sp IsNot Nothing Then
                Dim nsp As New StackPanel() With {.Orientation = System.Windows.Controls.Orientation.Vertical}
                Dim count As Integer = sp.Children.Count
                For i As Integer = count - 1 To 0 Step -1
                    Dim cc As ContentControl = TryCast(sp.Children(i), ContentControl)
                    If cc IsNot Nothing Then
                        sp.Children.Remove(cc)
                        nsp.Children.Add(cc)
                    End If
                Next
                cp.Content = Nothing
                cp.Content = nsp
            End If
        End If 
```

它很好地运行了这段代码，但在加载用户控件之前我收到了错误。我在这里环顾四周，似乎可行的解决方案是将孩子从我已经做的第一个集合中删除。任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T16:53:22.240

这是我用来解决我的问题的解决方案，以防其他人遇到这种情况

```
 Dim cp As ContentPresenter = TryCast(Utilities.GetDescendantFromName(TitleLegend, "ContentPresenter"), ContentPresenter)
        If cp IsNot Nothing Then
            Dim sp As StackPanel = TryCast(cp.Content, StackPanel)

            If sp IsNot Nothing Then
                If tempList Is Nothing Then
                    tempList = New List(Of ContentControl)
                End If
                Dispatcher.BeginInvoke(New Action(Function()
                                                      Dim count As Integer = sp.Children.Count
                                                      For i As Integer = count - 1 To 0 Step -1
                                                          Dim cc As ContentControl = TryCast(sp.Children(i), ContentControl)
                                                          sp.Children.Remove(TryCast(sp.Children(i), ContentControl))
                                                          If cc IsNot Nothing Then
                                                              tempList.Add(cc)
                                                          End If
                                                      Next

                                                      For i As Integer = count - 1 To 0 Step -1
                                                          Dim cc As ContentControl = TryCast(tempList(0), ContentControl)
                                                          tempList.Remove(TryCast(tempList(0), ContentControl))
                                                          If cc IsNot Nothing Then
                                                              sp.Children.Add(cc)
                                                          End If
                                                      Next

                                                  End Function), System.Windows.Threading.DispatcherPriority.Background, Nothing)
            End If
        End If 
```

# mysql - 在 MySQL 中按多列分组的总和

> ID：13629356
> 
> 赞同：-4
> 
> 时间：2012-11-29T15:43:35.240
> 
> 标签：mysql, sum, pivot

我有下表

```
color       shape         material       value    qt
----------------------------------------------------
green       cylinder      plastic         12       2
white       cube          wood            5        1
green       cylinder      plastic         6        2
white       cube          wood            5        2
green       cylinder      plastic         2        2 
```

我想要具有相同标准的值的总和。我想要类似下面的东西。

```
color       shape         material       sum
-----------------------------------------------
green       cylinder      plastic        28
white       cube          wood           15
green       cylinder      plastic        12 
```

我有很多颜色、形状和材料，所以我想要一个动态查询。我不知道从哪里开始。

编辑

还有其他特征使每条记录都不同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:51:50.780

如果它像您的描述一样简单

```
SELECT color, shape, material, SUM(value)
FROM SomeTable
GROUP BY color, shape, material 
```

但不确定您的示例输出表是否与您的描述和原始数据相关

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:53:07.300

```
select color, shape, material, sum( value * qt )
from tbl
group by color, shape, material 
```

# c# - 为什么 DataAdapter 不是一次性的

> ID：13629359
> 
> 赞同：3
> 
> 时间：2012-11-29T15:43:40.037
> 
> 标签：c#, .net, database-connection, dataadapter

我知道可能有一个明显的原因，但我找不到它..

我通常`using`在数据库连接和数据读取过程中使用该语句，但我不能使用它，`DataAdapter`因为它没有实现`IDisposable`.

另外：填充数据集后它的行为如何？

它会自行关闭连接吗？

只关闭它还是丢弃它？

数据集填充后是否必须自己处理内部连接？如果是这样，为什么`IDataAdapter`没有相关的属性/方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T15:56:44.757

`DataAdapter`实例不包含对非托管代码的引用。它只是充当命令和数据集之间的“桥梁”。

> DataAdapter 充当 DataSet 和数据源之间的桥梁，用于检索和保存数据。DataAdapter 通过映射Fill 和Update 来提供这个桥梁，Fill 改变DataSet 中的数据以匹配数据源中的数据，Update 改变数据源中的数据以匹配DataSet 中的数据。

来源：http: [//msdn.microsoft.com/en-us/library/system.data.common.dataadapter.aspx](http://msdn.microsoft.com/en-us/library/system.data.common.dataadapter.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T15:52:46.573

`DataAdapter`不会关闭连接，因为您可能希望继续使用此连接来填充其他`DataSets`.

`Fill`例外情况是在调用方法之前连接未处于打开状态（Thanx Richard）： [https ://stackoverflow.com/a/2472886/2258](https://stackoverflow.com/a/2472886/2258)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T16:02:55.253

DataAdapter 没有实现 IDisposable，因为它没有任何需要在正常垃圾回收之外处理的成员变量。换句话说，它不需要实现 IDisposable。

如果您有兴趣，可以在这里查看 Mono DataAdapter 的源代码：[http ://www.java2v.com/Open-Source/CSharp/2.6.4-mono-.net-core/System.Data/System/Data/通用/DataAdapter.cs.htm](http://www.java2v.com/Open-Source/CSharp/2.6.4-mono-.net-core/System.Data/System/Data/Common/DataAdapter.cs.htm)

一般来说，如果您要在使用后关闭连接，请继续将连接放在 using 范围内，但也可以使用单例并在使用相同连接的多方范围内拥有多方 DataAdapter。

希望这是有道理的。

# asp.net - 提取数组中文本框的值？

> ID：13629368
> 
> 赞同：3
> 
> 时间：2012-11-29T15:43:57.807
> 
> 标签：asp.net

我在 asp.net 中动态创建了文本框。现在我正在通过以下代码提取值。

```
string[] sublist = new string[] { };
int[] maxmarkslist = new int[] { };
int i;
for (i = 0; i < Convert.ToInt32(Label15.Text); i++)
{
    string sub = "subject" + i;
    string marks = "maxmarks" + i;
    TextBox subject = (TextBox)PlaceHolder1.FindControl(sub);
    TextBox maxmarks = (TextBox)PlaceHolder1.FindControl(marks);
    sublist[i] = subject.Text;
    maxmarkslist[i] = Convert.ToInt32(maxmarks.Text);
} 
```

但是对于以下两行，我收到错误“*索引超出了数组的范围”：*

```
sublist[i] = subject.Text;
maxmarkslist[i] = Convert.ToInt32(maxmarks.Text); 
```

当我调试它时，值会出现在 subject.Text 和 maxmarks.Text 中，但不会进入数组。

我是否以错误的方式定义了数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:05:24.733

您将两个数组都定义为空数组。因此，如果您尝试索引这些错误，您将获得索引超出范围的错误。

数组不是动态扩展的。如果需要，请使用集合类型，以后可能会转换为数组。

试试这个：

```
int length = Convert.ToInt32(Label15.Text);
string[] sublist = new string[length-1];
int[] maxmarkslist = new int[length-1];

for (int i = 0; i < length; i++)
{
    string sub = "subject" + i;
    string marks = "maxmarks" + i;
    TextBox subject = (TextBox)PlaceHolder1.FindControl(sub);
    TextBox maxmarks = (TextBox)PlaceHolder1.FindControl(marks);
    sublist[i] = subject.Text;
    maxmarkslist[i] = Convert.ToInt32(maxmarks.Text);
} 
```

或者这里是如何使用集合（列表）类型执行此操作：

```
 int length = Convert.ToInt32(Label15.Text);
        List<string> sublist1 = new List<string>();
        List<int> maxmarkslist1 = new List<int>();

        for (int i = 0; i < Convert.ToInt32(Label15.Text); i++)
        {
            string sub = "subject" + i;
            string marks = "maxmarks" + i;
            TextBox subject = (TextBox)PlaceHolder1.FindControl(sub);
            TextBox maxmarks = (TextBox)PlaceHolder1.FindControl(marks);
            sublist1.Add(subject.Text);
            maxmarkslist1.Add(Convert.ToInt32(maxmarks.Text));
        }

        string[] sublist = sublist1.ToArray();
        int[] maxmarkslist = maxmarkslist1.ToArray(); 
```

请注意，您不必预先指定集合的​​大小。但是继续向其中添加项目，因为它可以根据需要扩展。但是数组不能做到这一点。

您 `string[] sublist = new string[] { };`是创建和初始化数组的快捷方法。因为您不必指定大小，但编译器会计算 {} 之间的元素并适当地设置大小。在您的情况下，由于 {} 内没有元素，它将创建一个空数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:14:55.547

```
 string[] sublist = new string[100];
        int[] maxmarkslist = new int[100]; 
```

把这个..用你的循环的最大可能值替换 100 ......但这不是一个好习惯......如果我发现更好的东西会回到这个线程......

# c# - 考虑到性能，会话变量比静态变量好？如果不是，解决方案是什么？

> ID：13629369
> 
> 赞同：2
> 
> 时间：2012-11-29T15:44:00.107
> 
> 标签：c#, asp.net-mvc, static, session-variables

我在几个屏幕中使用了静态变量。看到这一点，我的前辈建议我不要使用它们，因为它们会妨碍性能。仅供参考，我正在开发**MVC**应用程序。

我得到的替代方法是使用 Session 变量。但是我不确定是否要使用它来代替我需要您的建议。会话变量是正确的选择吗？如果没有，有什么更好的选择。
请建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T15:49:36.827

对如何使用这个变量知之甚少，我想说远离静态变量不是因为性能，而是主要是因为并发性。使用会话变量将保证每个用户的隔离，除非您确实希望在用户之间共享值。

性能明智的静态变量会更快，因为不需要在会话之间序列化它们（如果您在进程会话管理中使用则更少。）

# c# - 删除 Windows 应用商店应用程序中的元素后保存 xDocument (Windows 8 Metro)

> ID：13629372
> 
> 赞同：0
> 
> 时间：2012-11-29T15:44:10.513
> 
> 标签：c#, xml, windows-8, linq-to-xml, windows-store-apps

首先我想再次提及我的平台是**Windows 商店应用程序**（因为有些用户认为我在谈论桌面环境并将我的问题作为重复的主题关闭）。我有一个 xml 文档，我通过以下方法删除了一个元素：

```
public async void DeleteDocument(Word deletedItem)
{
   StorageFile storageFile = await _fileloc.StorageFile();
   var file = await storageFile.OpenAsync(FileAccessMode.ReadWrite);
   Stream inStream = file.AsStreamForWrite();
   XDocument xDoc = XDocument.Load(inStream);
   xDoc.Descendants("Word").Single(p =>((Guid)p.Element("Id")).Equals(deletedItem.Id)).Remove();
   xDoc.Save(inStream);   
} 
```

元素已成功删除，但是当我保存 xDocument 时，新的 xDocument 会像这样附加到最后的 xml 文件中

```
<XML ....>
<Word id="1">
     <Item x="...."/>
     <Item x="...."/>
</Word>
<Word id="2">
     <Item x="...."/>
     <Item x="...."/>
</Word>
</XML><XML ....>
<Word Id="2">
    <Item x="...."/>
     <Item x="...."/>
</Word>
</XML> 
```

请给我建议并感谢您的帮助。

更新：

在吉姆奥尼尔建议后，保存的文件就像

```
<XML ....>
<Word id="1">
     <Item x="...."/>
     <Item x="...."/>
</Word>
 x="...."/>
     <Item x="...."/>
</Word>
</XML> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T07:47:10.177

您已打开文件进行读/写访问，当您加载 XML 时，文件指针现在位于文件末尾。因此，当您保存它时，它开始写入文件指针所在的任何位置 - 在文件末尾。

看看这是否效果更好：

```
var file = await storageFile.OpenAsync(FileAccessMode.ReadWrite);
using (Stream inStream = file.AsStreamForWrite())
{
    XDocument xDoc = XDocument.Load(inStream);
    xDoc.Descendants("word").Remove();
    inStream.Seek(0, SeekOrigin.Begin);
    xDoc.Save(inStream);
    await inStream.FlushAsync();
} 
```

这不完全是您的代码（我无法调用 Single 进行编译），但您可以看到模式；即调用[Seek](http://msdn.microsoft.com/en-us/library/system.io.stream.seek%28v=vs.110%29.aspx)。

# templates - Kendo UI Treeview Sprite-Altering 模板

> ID：13629373
> 
> 赞同：0
> 
> 时间：2012-11-29T15:44:13.690
> 
> 标签：templates, kendo-ui, kendo-treeview

我有一个绑定到远程分层数据源（JSON 文件）的剑道 Treeview。

我想根据节点是什么在每个节点旁边添加精灵。如果节点没有子节点，那么我希望它具有“文件”精灵，如果节点有子节点，我希望它具有“文件夹”精灵。（精灵来自剑道，演示中的精灵）

我对模板的工作方式有点困惑，我可以使用模板动态更改每个节点的精灵吗？任何好的例子和一些解释让我继续前进会有很大帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:09:34.310

在下面的代码中，我所做的是定义一个`template`检查正在呈现的节点是否具有`items`（子节点）。如果有，它会显示一个`icon`来自默认精灵文件 ( `k-i-plus`)，否则它会显示一个不同的图标 ( `k-i-refresh`)。

```
function loadMore() {
    var uuid = $(this).data("uid");
    var node = tree.findByUid(uuid);
    tree.insertBefore(content, node);
    tree.remove(node);
    tree.expand(".k-item");
    addLoadMore(".k-i-refresh");
}

function addLoadMore(clss) {
    $(clss, tree.element).closest(".k-item").on("click", loadMore);
}

var content = [
    {
        text :"node1",
        items:[
            { text:"node1.1" },
            { text:"node1.2" },
            { text   :"node1.3",
                items:[
                    { text:"node1.3.1" },
                    { text:"node1.3.2" },
                    { text:"node1.3.3" },
                    { text:"node1.3.4" }
                ] },
            { text:"node1.4" }
        ]
    }
];

var tree = $("#tree").kendoTreeView({
    dataSource:content,
    template  :"<span class='k-icon #= item.items ? 'k-i-plus' : 'k-i-refresh' #'></span>#= item.text #"
}).data("kendoTreeView");
tree.expand(".k-item");
addLoadMore(".k-i-refresh"); 
```

`k-i-plus`如果替换为定义文件的 CSS 类名`folder`并更改`k-i-refresh`为文件的 CSS类名，您需要做什么。

[如果您需要有关编写模板的信息，这里](http://docs.kendoui.com/getting-started/framework/templates/overview)有一个很好的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-10T16:32:14.397

我知道我为此迟到了 3 年以上。但万一有人遇到同样的问题。这是我实现它的方法：

```
 schema: {
        model: {
            children: "folder",
            hasChildren: function (node) {
                var hasChildren =  (node.folder && node.folder.length > 0);
                if (hasChildren === true) {
                    node.spriteCssClass = "folder";
                } else {
                    node.spriteCssClass = "html";
                }
                return hasChildren;
            }
        }
    } 
```

# sql - 从 VS2005 Reporting Services 到 SSMS 的 SQL 语句

> ID：13629380
> 
> 赞同：0
> 
> 时间：2012-11-29T15:44:44.837
> 
> 标签：sql, reporting-services, visual-studio-2005, ssms, reportingservices-2005

当我在 Reporting Services 中制作报告时，我想要一种方法来自动在我的数据库中填写报告的一些配置。

例如，我有一个表“参数”和一个表“报告”，如何从我刚刚使用 VS2005 创建的报告中自动插入参数和报告名称到我的数据库中？

我正在寻找使用/编写插件或类似的东西，或者是否有一种更容易但我只是忽略的方法？

非常感谢您的帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:12:06.877

将插入代码放入存储过程中，并在数据选项卡中调用它。确保您具有 sql 用户的插入/更新权限。

希望能帮助到你！

# codeigniter - DOMPDF + Codeigniter，库升级，但现在不工作

> ID：13629381
> 
> 赞同：0
> 
> 时间：2012-11-29T15:44:46.393
> 
> 标签：codeigniter, dompdf

我一直在 codeigniter 中使用旧版本的 dom pdf 生成 pdf，最近我将核心 dompdf 目录更改为较新版本的 dompdf-0.5.2.zip。下面是我用来连接 dompdf 类的代码：

```
class Pdf{

var $_dompdf = NULL;

/**
 * Constructor Method
**/
function __construct(){
    ini_set("memory_limit", "1G");
    require_once("Dompdf/dompdf_config.inc.php");
    if(is_null($this->_dompdf)){
        $this->_dompdf = new DOMPDF();
    }
}

/**
 * HTML to PDF Conversion method
**/
function convert_html_to_pdf($_html, $_filename = '', $_stream = false, $_orientation = "portrait"){
    $this->_dompdf->set_paper("a4", $_orientation);
    $this->_dompdf->load_html($_html);
    $this->_dompdf->render();
    if($_stream){
        $this->_dompdf->stream($_filename);
    } else{
        file_put_contents($_filename, $this->_dompdf->output()); 
    }
} 
```

}

现在，当我尝试生成 pdf 时，它给了我以下错误： Fatal error: Class 'DOMPDF' not found in D:\xampp\htdocs\app\application\libraries\Pdf.php on line 21

任何解决方案将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T13:20:39.607

我通过将 dompdf 版本上传到最新版本自己解决了这个问题，虽然它是 beta 版，但现在似乎一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:15:05.903

请先试试这个例子。只需将其存储在 xampp 或您正在使用的任何服务器的 htdocs 目录下的文件中。

```
<?php
require_once("dompdf_config.inc.php");

$html =
 '<html><body>'.
 '<p>Put your html here, or generate it with your favourite '.
 'templating system.</p>'.
 '</body></html>';

 $dompdf = new DOMPDF();
 $dompdf->load_html($html);
 $dompdf->render();
 $dompdf->stream("sample.pdf");

?> 
```

只需根据您的要求更改 dompdf 目录路径。

# sql - 使用唯一的递增值更新表中的 int 列

> ID：13629382
> 
> 赞同：63
> 
> 时间：2012-11-29T15:44:46.740
> 
> 标签：sql, sql-server, sql-server-2008

我正在尝试`InterfaceID (INT)`用每行唯一的值填充其列中缺少值的任何行。

我正在尝试执行此查询：

```
UPDATE prices SET interfaceID = (SELECT ISNULL(MAX(interfaceID),0) + 1 FROM prices) 
       WHERE interfaceID IS null 
```

我希望`(SELECT ISNULL(MAX(interfaceID),0) + 1 FROM prices)`对每一行进行评估，但它只完成一次，所以我所有受影响的行都获得相同的值而不是不同的值。

这可以在单个查询中完成吗？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2012-11-29T15:57:12.553

```
declare @i int  = (SELECT ISNULL(MAX(interfaceID),0) + 1 FROM prices)

update prices
set interfaceID  = @i , @i = @i + 1
where interfaceID is null 
```

应该做的工作

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-03-03T10:31:13.303

```
DECLARE @IncrementValue int
SET @IncrementValue = 0 
UPDATE Samples SET qty = @IncrementValue,@IncrementValue=@IncrementValue+1 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-01-14T12:26:54.987

simple query would be, just set a variable to some number you want. then update the column you need by incrementing 1 from that number. for all the rows it'll update each row id by incrementing 1

```
SET @a  = 50000835 ;  
UPDATE `civicrm_contact` SET external_identifier = @a:=@a+1 
WHERE external_identifier IS NULL; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-01-26T09:55:34.320

对于 Postgres

```
ALTER TABLE table_name ADD field_name serial PRIMARY KEY 
```

参考：[https ://www.tutorialspoint.com/postgresql/postgresql_using_autoincrement.htm](https://www.tutorialspoint.com/postgresql/postgresql_using_autoincrement.htm)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-11-14T12:28:06.370

假设你有这个表的主键（你应该有），以及使用 CTE 或 WITH，也可以使用带有自连接的更新到同一个表：

```
UPDATE a
SET a.interfaceId = b.sequence
FROM prices a
INNER JOIN
(
   SELECT ROW_NUMBER() OVER ( ORDER BY b.priceId ) + ( SELECT MAX( interfaceId ) + 1 FROM prices ) AS sequence, b.priceId
   FROM prices b
   WHERE b.interfaceId IS NULL
) b ON b.priceId = a.priceId 
```

我假设主键是 price-id。

派生表别名 b 用于通过 ROW_NUMBER() 函数与主键列一起生成序列。对于列 interface-id 为 NULL 的每一行，这将生成具有唯一序列值和主键值的行。

可以按其他顺序而不是主键对序列进行排序。

该序列通过子查询被当前 MAX interface-id + 1 偏移。MAX() 函数忽略 NULL 值。

WHERE 子句将更新限制为那些为 NULL 的行。

然后将派生表连接到同一个表（别名 a），并在主键列上连接，其中要更新的列设置为生成的序列。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-11-22T08:32:54.633

在基于 oracle 的产品中，您可以使用以下语句：

```
update table set interfaceID=RowNum where condition; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-29T16:00:27.470

尝试这样的事情：

```
with toupdate as (
    select p.*,
           (coalesce(max(interfaceid) over (), 0) +
            row_number() over (order by (select NULL))
           ) as newInterfaceId
    from prices
   )
update p
    set interfaceId = newInterfaceId
    where interfaceId is NULL 
```

这并不能完全使它们连续，但它确实分配了新的更高的 id。要使它们连续，请尝试以下操作：

```
with toupdate as (
    select p.*,
           (coalesce(max(interfaceid) over (), 0) +
            row_number() over (partition by interfaceId order by (select NULL))
           ) as newInterfaceId
    from prices
   )
update p
    set interfaceId = newInterfaceId
    where interfaceId is NULL 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2020-02-27T09:57:40.380

你可以试试 ：

```
DECLARE @counter int
SET @counter = 0
UPDATE [table]
SET [column] = @counter, @counter = @counter + 1``` 
```

# vim - 从插入模式下的 Vim 转义键错误中恢复 ^[

> ID：13629389
> 
> 赞同：2
> 
> 时间：2012-11-29T15:45:09.620
> 
> 标签：vim

我使用[Pydiction](http://www.vim.org/scripts/script.php?script_id=850)插件进行插入模式代码完成，99% 的时间它都很棒，但偶尔我会遇到一个问题，即（完成后）我的转义键被删除，当这种情况发生时，我无法退出插入模式，打字逃逸打印`^[`。

我必须杀死 Vim 才能恢复。

Vim 仍然响应，我可以做些什么来重置？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-17T03:33:50.113

尝试将 Esc 重新映射到其他东西（我发现将它映射到大写锁定更有用）

# iphone - 发送带有照片附件的应用内电子邮件后，即使我点击发送或取消，电子邮件窗口也不会关闭

> ID：13629390
> 
> 赞同：0
> 
> 时间：2012-11-29T15:45:09.937
> 
> 标签：iphone, screenshot, email-attachments, dismiss

我有点麻烦，我花了半天时间来解决这个问题，在 iOS6 和其他问题的所有弃用之后，我没有取得重大成果。这个 iOS 应用程序有一个发送电子邮件选项，当按下按钮后，该应用程序会截取我的 WebView 的屏幕截图，将其附加到电子邮件中，然后从那里，具有取消或发送电子邮件并返回应用程序的正常选项。我到达了弹出电子邮件的部分，实际上这里有两个问题：一个是按下取消或发送后，电子邮件视图不会关闭，应用程序卡在电子邮件视图中。我遇到的第二个问题是附加的图像只是一个小图标（带有问号的蓝色，就像它未被识别或丢失一样......有人可以指出我正确的方向吗？我要疯了。我 我在没有运气的情况下前后研究了网络。不幸的是，许多类似的线程但不同的问题与我的问题并不完全相关。对不起，提前谢谢。这是我的代码：

```
// in my LiveView.h file
#import <UIKit/UIKit.h>
#import <QuartzCore/QuartzCore.h>
#import <MessageUI/MessageUI.h>
#import "CamSetup.h"

@interface LiveView : UIViewController < MFMailComposeViewControllerDelegate ,   ADBannerViewDelegate >  
....
-(IBAction)shotAndSend:(id)sender;

// in my LiveView.m file:

- (void)mailComposer:(MFMailComposeViewController *)controller
      didFinishWithResult:(MFMailComposeResult)result error:(NSError *)error 
{
NSLog(@"in didFinishWithResult:");
switch (result) 
   {
    case MFMailComposeResultCancelled:
        NSLog(@"cancelled");
        break;
    case MFMailComposeResultSaved:
        NSLog(@"saved");
        break;
    case MFMailComposeResultSent:
        NSLog(@"sent");
        break;
    case MFMailComposeResultFailed: {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:NSLocalizedString(@"Error sending mail",@"Error sending mail")
        message:[error localizedDescription] delegate:nil
                                              cancelButtonTitle:NSLocalizedString(@"test",@"test")
                                              otherButtonTitles:nil];
        [alert show];
        break;
    }
    default: break;
 }
  [self dismissViewControllerAnimated:NO completion:Nil];
   }

 -(IBAction)shotAndSend:(id)sender
{
   UIGraphicsBeginImageContext(_myWebView.frame.size);
   [_myWebView.layer renderInContext:UIGraphicsGetCurrentContext()];
   UIImage * image = UIGraphicsGetImageFromCurrentImageContext();
   UIGraphicsEndImageContext();

   NSData * imageData = UIImageJPEGRepresentation (image, 2.1);

  if ([MFMailComposeViewController canSendMail])
  {
     MFMailComposeViewController * mailComposer = [[MFMailComposeViewController alloc] init];
     mailComposer.mailComposeDelegate = self;
    [mailComposer addAttachmentData:imageData mimeType:@"image/jpeg" fileName:@"attachment.jpeg"];
    [mailComposer setSubject:@"A screenshot from my App"];
    [mailComposer setToRecipients:[NSArray arrayWithObjects:@"123@yexample.com", nil]];
    [self presentViewController: mailComposer animated:YES completion:NULL];
 }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:20:53.043

您的代码不起作用，因为您使用了错误的方法。你有：

```
- (void)mailComposer:(MFMailComposeViewController *)controller
    didFinishWithResult:(MFMailComposeResult)result error:(NSError *)error 
```

但应该是：

```
- (void)mailComposeController:(MFMailComposeViewController*)controller
    didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:02:07.910

您需要您的视图的代表，它将为您关闭该视图。
您没有看到日志的事实表明您没有正确实现委托协议。看看苹果文档中的一些例子。

# java - 如何使用特殊字符保存和编码 xml 字符串？

> ID：13629400
> 
> 赞同：0
> 
> 时间：2012-11-29T15:45:41.260
> 
> 标签：java, file-io

我有一个带有 xml 内容的字符串。当我将它保存到`File`时，结果包含像这样的标签`&lt; &quot; &gt`

如何正确保存这样的字符串以便使用编码字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:47:12.293

你不能。
XML 规范说`<`,`&`和`>`必须被*转义*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:49:10.723

如果您决心打破 XML 规范，请使用...

[http://commons.apache.org/lang/api-2.6/org/apache/commons/lang/StringEscapeUtils.html](http://commons.apache.org/lang/api-2.6/org/apache/commons/lang/StringEscapeUtils.html)

方法“unes​​capeHtml”将满足您的要求。

> 将包含实体转义的字符串取消转义为包含与转义对应的实际 Unicode 字符的字符串。支持 HTML 4.0 实体。
> 
> 例如，字符串`"&lt;Fran&ccedil;ais&gt;"`将变为 `"<Français>"`
> 
> 如果一个实体无法识别，则将其单独放置，并逐字插入结果字符串中。例如`"&gt;&zzzz;x"`将成为`">&zzzz;x"`.

# python - Python - 运行命令然后在自动提示时输入

> ID：13629404
> 
> 赞同：1
> 
> 时间：2012-11-29T15:46:09.060
> 
> 标签：python, ssh-keys

作为更大脚本的一部分，我正在运行`ssh-keygen`以生成 RSA 公钥。我不打算使用密码或更改默认文件夹位置。但是，我仍然需要处理来自`ssh-keygen`文件名和密码的提示。我怎样才能避免不得不处理这些提示，无论是使用选项`ssh-keygen`还是在脚本中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:50:00.383

您可以将它们作为参数传递以避免需要任何输入：

```
ssh-keygen -q -N '' -C 'generated key' -t rsa -f /path/to/key 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:53:01.690

一般来说，这些问题可以用 pexpect 解决：[http](http://www.noah.org/python/pexpect/#doc) ://www.noah.org/python/pexpect/#doc这是 Python 的 expect 包装器。它让您等待某个字符串被打印出来，然后通过发送响应来做出反应，就像在终端中键入它一样。

# uiscrollview - UIScrollView 不滚动 - 即使启用了有效的内容大小和滚动

> ID：13629406
> 
> 赞同：0
> 
> 时间：2012-11-29T15:46:13.837
> 
> 标签：uiscrollview, autolayout

在我的`viewDidAppear`方法（我调用超级方法）中，我有以下代码：

```
UIScrollView *navbar = [[UIScrollView alloc] init];

[navbar setScrollEnabled:YES];
[navbar setBackgroundColor:[UIColor redColor]];
[navbar setTranslatesAutoresizingMaskIntoConstraints:NO];

[self.view addSubview:navbar];

NSDictionary *viewsDictionary2 = NSDictionaryOfVariableBindings(navbar);

[self.view addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"|[navbar]|"
                                                                  options:0
                                                                  metrics:nil
                                                                    views:viewsDictionary2]];
 [self.view addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"V:|[navbar]|"
                                                                   options:0
                                                                   metrics:nil
                                                                     views:viewsDictionary2]];

NSArray *categories = @[@"nav1", @"nav2", @"nav3", @"nav4", @"nav5", @"nav6", @"nav7", @"nav8", @"nav9", @"nav10", @"nav11", @"nav12", @"nav13"];

NSMutableArray *tempCategoryImages = [NSMutableArray array];

for (NSInteger i = 0; i < categories.count; i++)
{
    [tempCategoryImages insertObject:[UIImage imageNamed:categories[i]] atIndex:i];
}

NSArray *categoryImages = [tempCategoryImages copy];

//          Add subviews.
//
CGFloat xPadding = 25.0f;

UIView *previousImageView = NULL;

for (NSInteger i = 0; i < categoryImages.count; i++)
{
    UIImageView *imageView = [[UIImageView alloc] initWithImage:categoryImages[i]];

    [imageView setTranslatesAutoresizingMaskIntoConstraints:NO];

    [navbar addSubview:imageView];

    if (i == 0) {
        //
        //  First category.
        //
        [navbar addConstraint:[NSLayoutConstraint constraintWithItem:imageView
                                                                    attribute:NSLayoutAttributeLeft
                                                                    relatedBy:NSLayoutRelationEqual
                                                                       toItem:imageView.superview
                                                                    attribute:NSLayoutAttributeLeft
                                                                   multiplier:1
                                                                     constant:0]];
    } else {
        //
        //  End categories.
        //
        [navbar addConstraint:[NSLayoutConstraint constraintWithItem:imageView
                                                                    attribute:NSLayoutAttributeLeft
                                                                    relatedBy:NSLayoutRelationEqual
                                                                       toItem:previousImageView
                                                                    attribute:NSLayoutAttributeRight
                                                                   multiplier:1
                                                                     constant:xPadding]];
    }

    [navbar addConstraint:[NSLayoutConstraint constraintWithItem:imageView
                                                                attribute:NSLayoutAttributeCenterY
                                                                relatedBy:NSLayoutRelationEqual
                                                                   toItem:imageView.superview
                                                                attribute:NSLayoutAttributeCenterY
                                                               multiplier:1
                                                                 constant:0]];

    previousImageView = imageView;
}

//          Set content size.
//
CGSize scrollContentSize = CGSizeZero;

for (NSInteger i = 0; i < categories.count; i++)
{
    UIImage *tempImage = [UIImage imageNamed:categories[i]];

    //  Width.
    //
    scrollContentSize.width += tempImage.size.width;

    //  Height.
    //
    if (tempImage.size.height > scrollContentSize.height) {
        scrollContentSize.height = tempImage.size.height;
    }
}

navbar.contentSize = scrollContentSize; 
```

当我记录滚动视图属性时，它具有子视图、足够大的内容大小并启用了滚动。

即使我将其添加`UIScrollView`到 IB 并将其链接到相同的代码，它仍然可以工作吗？（我注释掉`NSAutoLayout`代码。

这让我相信 UIScrollView 工作，我不能使用自动布局。

我错过了什么吗？

谢谢

***编辑***

`initWithFrame:`*当我尝试使用框架*时，代码也无法以编程方式工作`setTranslatesAutoresizingMaskIntoConstraints:YES`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T19:37:22.260

Check the attributes inspector for your scrollview in IB. Make sure that bounce vertically is checked.

Fixed this problem for me.

# api - 使用搜索 API 获取推文的位置

> ID：13629407
> 
> 赞同：1
> 
> 时间：2012-11-29T15:46:22.730
> 
> 标签：api, twitter, maps

我正在尝试获取其中包含特定关键字的推文列表，但我需要知道它们发布的坐标。我正在使用以下 URL，但 GEO 似乎总是为空，我认为我还没有看到它填充，即使在文档中的示例中也是如此。

[http://search.twitter.com/search.json?q=lorem&rpp=100&include_entities=true&with_twitter_user_id=true&result_type=recent&geocode=53.429147,-2.93335,100mi&page=1](http://search.twitter.com/search.json?q=lorem&rpp=100&include_entities=true&with_twitter_user_id=true&result_type=recent&geocode=53.429147,-2.93335,100mi&page=1)

它确实返回了一个位置、一个城市名称或类似的东西，我用它来使用谷歌的地图 api 生成坐标，但我因为使用​​它太多次而被阻止了..

有人有什么想法吗？

谢谢！

# sql - 在 select 语句中使用函数结果

> ID：13629408
> 
> 赞同：0
> 
> 时间：2012-11-29T15:46:23.193
> 
> 标签：sql, oracle

我在 oracle 中有一个简单的选择语句（示例）：

```
SELECT * FROM organisation WHERE ID=15 
```

这将返回一行：

```
 **ID   | NAME   |   NOTES      | VALUE**
   15   | BEST   | Just Notes...|  112 
```

现在我想取值 (112) 并将其用作 oracle 函数中的参数：

```
function get_session_text (
     in_value in number
     ) 
```

返回 varchar2 是....

所以我想构建一个 select 语句，它将返回类似的内容：

```
 **ID   | NAME   |   NOTES      | VALUE  |  TEXT **  
   15   | BEST   |Just Notes... |  112   | function's result 
```

选择 * 从

我尝试构建它，但我不熟悉函数，所以你能帮我处理那个 SQL 语句吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:48:06.007

```
SELECT id, 
       name,
       notes,
       value,
       get_session_text( value )
  FROM organization 
```

应该这样做。

# android - 如果facebook已注销，如何检查accessToken是否有效？

> ID：13629409
> 
> 赞同：0
> 
> 时间：2012-11-29T15:46:25.330
> 
> 标签：android, facebook

这是我的场景，

1.  在android app中登录facebook，并保存访问令牌以备下次使用。
2.  更改我的脸书密码。
3.  再次使用我的应用程序 --> 测试 facebook.isSessionValid() --> 它应该返回“false”，但返回“true”。

我查看了“isSessionValid”实现，但它只是测试“accessExpries”。

在这种情况下，如何在继续调用 Graph API 之前检查访问令牌是否真的有效？

多谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T21:37:07.047

唯一的方法是发出图形请求（例如“/me”），并检查请求是否成功。没有其他有保证的方法是严格的客户端。

# jquery - 将输入创建为输入的子项

> ID：13629410
> 
> 赞同：4
> 
> 时间：2012-11-29T15:46:27.720
> 
> 标签：jquery, html, dom

是否可以创建一个作为文本子级的按钮？

```
<input type="text">
    <input type="button" />
</input> 
```

我问的原因是我想做一个组合框。看到[这个小提琴](http://jsfiddle.net/Sw6FQ/1/)。在 jquery 中执行此操作，按钮不会出现。在常规 html 中执行此操作，第二个输入不是第一个输入的子项（至少在 Chrome 中）。

我可以将文本和按钮放在一个跨度中，但我更喜欢像示例中那样创建文本框，以便稍后可以像这样检索值：$("#test).val();

PS 我知道存在其他组合框插件。我想自己动手学习。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-29T15:47:18.263

这是不可能的，因为`input`它是内联元素 - 它不能有子元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T15:51:05.520

这将导致无效的 HTML，因此不可能这样做。你可以做的是创建一个div，它是一个块元素，并用一个文本框+按钮的内联元素填充它。

在你的 CSS 中添加一些样式，你可以让你的 div 看起来像一个文本框，你的文本框像一个 div，没有边框和斜面。导致一些看起来像你在这里想要实现的东西。

要摆脱输入框上的文本框，请使用`#YourTextBox {border: none;}`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-07T02:36:47.897

正确答案是`input`标签是一个不能有任何子元素的[void 元素。](https://www.w3.org/TR/html5/syntax.html#void-elements)span 等内联元素可以有子元素。

> void 元素只有一个开始标签；不得为 void 元素指定结束标记。

ie 在 HTML5 中永远不可能有一个结束标签，即不要使用`</input>`. HTML5 不是 XML，它强烈反对使用自闭合标签 ( `/>`)，即`<input />`不是严格正确的 HTML5（尽管它可以用于兼容性目的）。HTML5 中定义的 void 元素标签列表是：`area, base, br, col, embed, hr, img, input, keygen, link, meta, param, source, track, wbr`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T16:35:12.313

这不是以这种方式嵌套 HTML 元素的有效方法。如果你看一下 jQuery 插件的作用，它们通常会`<select>`用 div 和其他东西来包装你的元素。恕我直言，您可以按照类似的方法解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-28T17:32:44.720

输入不能有孩子，因为它们没有结束。这里有一些信息：[https ://www.w3schools.com/tags/tag_input.asp](https://www.w3schools.com/tags/tag_input.asp)

# vba - 我可以使用 dateadd 函数指定前一天的时间吗

> ID：13629412
> 
> 赞同：2
> 
> 时间：2012-11-29T15:46:40.980
> 
> 标签：vba, outlook, outlook-2010

每次运行宏时，我都希望它移动昨天晚上 10 点之前收到的电子邮件。我可以让它工作一段时间（例如 2 天前，4 小时前），但是这个宏可以在一天中的任何时间运行，我希望它总是检查昨天晚上 10 点之前收到的电子邮件。我可以调整下面的代码吗？提前致谢！

```
If .ReceivedTime < DateAdd("d", -1, "Now") Then 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:57:42.363

您可以只添加昨天的日期，不包括它的时间：

```
if .ReceivedTime < dateadd("d", -1, date) + timeserial(22, 0, 0) then 
```

# matlab - 如何向量化矩阵子集，以便 find() 返回一个矩阵？

> ID：13629419
> 
> 赞同：1
> 
> 时间：2012-11-29T15:46:51.717
> 
> 标签：matlab, octave, vectorization

给定一个矩阵`A`，我需要找到对应于值 1 和 2 的索引。我可以按如下顺序执行此操作：

```
>> B

B =

     1     2     3
     4     1     6
     7     8     9
     4     5     1

>> find(B==1)

ans =

     1
     6
    12

>> find(B==2)

ans =

     5 
```

但是如果我循环执行这种操作，Matlab 将只使用我处理器的一个内核。如何对其进行矢量化，以便从中获得矩阵`find`？我想要这个结果：

```
>> my_find( B, [1 2] )

ans =

    1 5
    6 0
   12 0 
```

（或其他一些填充）

我怎样才能得到这个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T16:40:46.460

只是不要使用`find`

```
B==1

ans =

 1     0     0
 0     1     0
 0     0     0
 0     0     1

B==2

ans =

 0     1     0
 0     0     0
 0     0     0
 0     0     0 
```

然后将它们相加或逻辑或。

IE

```
(B==1) + (B==2)

ans =

 1     1     0
 0     1     0
 0     0     0
 0     0     1 
```

或者

```
(B==1) | (B==2)

ans =

 1     1     0
 0     1     0
 0     0     0
 0     0     1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:55:44.270

[i, j] = ind2sub(size(B), find(逻辑(sum(bsxfun(@eq, B(:), [1 2]), 2))))

# c# - 在 .NET HTTPHandler 中释放连接

> ID：13629422
> 
> 赞同：1
> 
> 时间：2012-11-29T15:47:03.257
> 
> 标签：c#, asp.net, .net

我目前正在实现一个 HTTP 处理程序，它将从某个 3rd 方获取一些 XML 数据的 POST，然后对其进行一些工作。我将对 XML 进行的处理可能需要一些时间。一旦我从 POST 中取出 XML，就无需在处理数据时保持与客户端的连接打开。由于我无法控制客户端何时超时向我发帖，我只想获取 XML 并释放连接。

有什么简单的方法可以解决这个问题吗？使用 Response.Close() 是不正确的，因为它不能正确关闭连接。Response.End() 一起退出我的 HTTP 处理程序。我可以将处理放入后台线程，但我听说这在 ASP.NET 中可能有点冒险，因为 AppDomain 可以被拆除，这可能会在中间杀死我的进程。

任何想法将不胜感激。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:53:37.690

1.  将接收到的数据保存到某种永久队列（例如 MSMQ）。
2.  退出处理程序。
3.  在另一个应用程序中处理来自队列的数据，例如在 Windows 服务中。

这并不完全是“简单的方法”，但对客户来说安全快捷。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T19:08:32.363

谢谢各位的意见。我这样做的方式，因此其他人可以将其视为解决方案：

排队可能是最“正确”的方法，但它需要一些额外的实现，这对于我打算做的事情来说确实是最重要的。使用来自[http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx的信息](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)

首先，我创建我的处理类，并在从客户端获取 XML 后在后台线程中启动它以完成工作。当我的工作线程在后台继续时，这会释放连接。

我将我的处理类注册为`IRegisteredObject`. 我实现了这个`Stop(bool immediate)`方法

```
 public void Stop(bool immediate)
    {
        if (!immediate && _working)
            return;//don't unregister yet, give it some time

        if(immediate && _working)
        {
            //TODO: Log this instance
        }
        HostingEnvironment.UnregisterObject(this);
    } 
```

我在处理工作时将我的 _working 变量设置为 true，并在完成后取消设置。如果在极少数情况下我正在处理工作并且因为 AppDomain 被删除而调用 stop ，它首先会返回而不注销自身。这让我的过程有更多的时间来完成。如果在第二次调用该方法并将立即标志设置为 true 时，它​​会快速记录问题，然后自行注销。

这可能不是最终的解决方案，但出于我的目的，这将负责在非常罕见的情况发生时提醒我，并且在我处理数据时不会阻止客户端的连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T16:06:54.270

如果您使用的是 .NET 4.5，请查看[HttpTaskAsyncHandler](http://www.asp.net/vnext/overview/aspnet/whats-new#_Toc318097378)。

从链接页面：

> 异步 HTTP 处理程序 在 ASP.NET 中编写异步处理程序的传统方法是实现 IHttpAsyncHandler 接口。ASP.NET 4.5 引入了可以派生的 HttpTaskAsyncHandler 异步基类型，这使得编写异步处理程序变得更加容易。HttpTaskAsyncHandler 类型是抽象的，需要您重写 ProcessRequestAsync 方法。在内部，ASP.NET 负责将 ProcessRequestAsync 的返回签名（一个 Task 对象）与 ASP.NET 管道使用的旧异步编程模型集成。以下示例展示了如何使用 Task 和 await 作为异步 HTTP 处理程序实现的一部分：

```
public class MyAsyncHandler : HttpTaskAsyncHandler 
{ 
        // ... 

        // ASP.NET automatically takes care of integrating the Task based override 
        // with the ASP.NET pipeline. 
        public override async Task ProcessRequestAsync(HttpContext context) 
        { 
           WebClient wc = new WebClient(); 
           var result = await  
                   wc.DownloadStringTaskAsync("http://www.microsoft.com"); 
           // Do something with the result 
        } 
} 
```

# asp.net - 拆分 Jquery.ajax 返回的数据

> ID：13629427
> 
> 赞同：0
> 
> 时间：2012-11-29T15:47:12.790
> 
> 标签：asp.net, jquery

我有一个jQuery代码：

```
 $(document).ready(function () {
                $("#populateNav").click(function () {
                    $.ajax({
                        contentType: "text/html; charset=utf-8",
                        data: "Name=David",
                        url: "Fetchdata.aspx",
                        dataType: "html",
                        success: function (data) {
                            $("#data").html(data);
                        }
                    });
                });
            }); 
```

从 fetchdata.aspx 返回的“数据”是一个字符串数组。

有没有办法拆分数组并将这些字符串放在3个不同的地方（）？

返回的数据是：

```
protected void Page_Load(object sender, EventArgs e)
    {
        String []data = new string[3];
        data[0] = "New York";
        data[1] = "01914";
        data[2] = "111-111-1111";

        Response.Write(data);

        Response.End();
    } 
```

# ubuntu - 使用 openCV 编译代码时出错

> ID：13629428
> 
> 赞同：0
> 
> 时间：2012-11-29T15:47:12.930
> 
> 标签：ubuntu, opencv, cmake

我按照这个网站[http://docs.opencv.org/trunk/doc/tutorials/introduction/linux_gcc_cmake/linux_gcc_cmake.html](http://docs.opencv.org/trunk/doc/tutorials/introduction/linux_gcc_cmake/linux_gcc_cmake.html)的指示来编译我使用 openCV 的代码。当我第一次创建和编译代码时我没有问题，但是当我更改 .cpp 文件的代码然后尝试再次编译它时，“cmake”。给我以下错误：

```
CMake Error: CMake can not determine linker language for target:DisplayImage
CMake Error: Cannot determine link language for target "DisplayImage". 
```

我知道我对原始代码所做的更改是有效的，因为我创建了一个新文件夹并按照与新代码相同的指示进行操作，我没有问题，但是当我再次运行“cmake”时。再次出现同样的错误。

如何更改 .cpp 文件的代码，然后编译/“make”而不会出现任何错误？我想避免每次更改 .cpp 文件中的内容时都必须使用新代码创建一个新文件夹。

预先感谢有人可以提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T03:34:39.517

我相信你需要运行“cmake”。只有一次。如果你改变你的 .cpp 文件，那么你只需要再次运行“make”。

如果你真的想运行“cmake”。再次对于示例 DisplayImage 代码，您可以简单地删除 DisplayImage 可执行文件（“rm DisplayImage”），然后您应该能够运行“cmake”。再次。

（也许有更多cmake经验的人可以分享为什么会这样......）

# html - iPad Portrait 的响应式网页设计和媒体查询在调整窗口大小时未显示任何更改

> ID：13629429
> 
> 赞同：0
> 
> 时间：2012-11-29T15:47:12.293
> 
> 标签：html, css, responsive-design, media-queries

我希望为我的 iPad Portrait 网站添加一些响应式网页设计。我有我的主 css 文件（style.css），然后我添加了以下行：

```
<link rel="stylesheet" href="ipad-portrait.css" media="only screen and (min-device-width : 768px) and (max-device-width : 1024px) and (orientation : portrait)" /> 
```

但是，当我尝试将 div 的背景颜色设置为红色或其他东西然后调整窗口大小时，当它达到 iPad 纵向大小时，我看不到任何变化。

我链接到的样式表如下所示：

```
/* iPads (portrait) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) 
and (orientation : portrait) {
/* Styles */

.myTile{background:red;}

} 
```

我试过有没有这个，调整大小时没有区别。

我究竟做错了什么？

任何帮助都会很棒，我只是在选择响应式设计。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-28T16:55:56.983

我会使用：

```
@media screen and (max-width: 768px) {
  /*styles*/
} 
```

我也用`max-width`. `max-width`vs 和有什么不一样`max-device-width`？不同之处在于，max-device-width 仅影响最大宽度为 XYZpx 的设备，因此在桌面上重新调整浏览器窗口的大小不会产生与特定媒体查询相关的样式更改。最大宽度，将在适合媒体查询的任何设备/浏览器上产生样式更改。因此，重新调整桌面浏览器的大小并让媒体查询使用最大宽度，您会像使用 iPad 的人一样看到该网站。

这是一个很好的参考：[响应式网页设计](http://coding.smashingmagazine.com/2011/01/12/guidelines-for-responsive-web-design/)

# c# - 长轮询实际上如何在客户端调用回调？

> ID：13629430
> 
> 赞同：5
> 
> 时间：2012-11-29T15:47:13.427
> 
> 标签：c#, wcf, long-polling, basichttpbinding

客户端启动长轮询，调用服务器上的一个方法并传入一个`AsyncCallback`包含回调委托的实例，该回调委托将在服务器异步返回客户端时调用。

现在我对此的理解是有限的，但似乎在`BasicHttp`WCF 中，`AsyncCallback`参数被序列化并发送到服务器，然后服务器对其进行反序列化、缓存并最终调用它以“返回”给客户端。

首先，上面的解释正确吗？其次，`AsyncCallback`客户端上的调用如何一路跨网络？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T15:53:03.977

连接保持打开状态，因此服务器通过现有连接进行响应，包括响应中的回调处理程序名称。

客户端了解消息的格式，然后可以使用来自服务器响应的数据调用适当的本地方法（基于回调处理程序）。

我通常不喜欢引用维基百科，但在这种情况下，对长轮询[的解释还不错......](http://en.wikipedia.org/wiki/Push_technology#Long_polling)

> 长轮询是传统轮询技术的一种变体，允许模拟从服务器到客户端的信息推送。使用长轮询，客户端以与正常轮询类似的方式从服务器请求信息。但是，如果服务器没有任何可用于客户端的信息，则服务器不会发送空响应，而是保留请求并等待某些信息可用。一旦信息可用（或在适当的超时后），就会向客户端发送完整的响应。客户端通常会立即从服务器重新请求信息，因此服务器几乎总是有一个可用的等待请求，它可以用来传递数据以响应事件。在 web/AJAX 上下文中，长轮询也称为 Comet 编程。

### 澄清

*   客户端向服务器发送一个 POST，包括一个回调句柄并保持连接打开
*   一段时间后，服务器使用来自 POST 的回调句柄和响应数据进行响应（当您`AsyncCallback`在服务器上调用 's 方法时会发生这种情况）
*   客户端从服务器读取响应，识别已返回的回调句柄并使用它来识别要执行的方法，
*   客户端执行回调句柄指定的方法并传入服务器响应的其余部分。

这类似于 JSONP 的工作方式（回调部分，不是长轮询），如果您熟悉的话？本质上，回调句柄只传递给服务器，以便它可以与响应一起发回，并允许客户端调用正确的方法。

在后台进行了额外的检查，以确保只调用预期的方法，并且恶意服务器不能只执行它在客户端代码中选择的任何方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T20:42:56.453

@Basic 的回答非常好，但我想写一个希望对某些人更容易理解的描述。

1.  您的代码调用本地类中的一个方法，该类表示服务器上的 webmethods
2.  该本地类与服务器建立连接，并将该连接连同对`AsyncCallback`传入的引用一起放入对象中
3.  包含信息的对象被放入后台，其中包含某种触发器以了解何时收到响应
4.  与此同时，主线程被返回以继续处理它想要的任何东西
5.  一旦服务器响应（在长轮询的情况下，它将等待一段时间再返回错误响应）对象被拉起并`AsyncCallback`使用信息调用

所以它真的是框架（仍然在客户端）等待异步部分的响应。TCP连接和服务器处理都是标准的（除了长轮询无返回的情况下等待响应）

这应该描述任何语言的任何异步 Web 请求的基本过程，无论是长轮询、下载图像等。

# jquery - Chrome 错误还是 jQuery 错误？

> ID：13629434
> 
> 赞同：4
> 
> 时间：2012-11-29T15:47:16.520
> 
> 标签：jquery, google-chrome

为什么以下代码在 IE 7 和 FF 15.0.1 上按预期执行（根据选择调整下拉列表的大小），但在 Chrome 23.0.1271.91 上总是以 1 结束？

我尝试添加 console.log 并实际查看发生了什么，似乎 resize 函数在 Chrome 中触发了两次，但作为 jQuery 的新手，我不确定我是否完全理解传递对象。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=windows-1250">
  <title></title>

  <script type="text/javascript" src="jquery-1.8.3.min.js"></script>          
  <script type="text/javascript">                                         

   var vt = new Array('1','2','3','4','5');
   var x = 1;

   function addopts(ddl) {
       console.log(ddl);
       for ( var i = 0; i < vt.length; i++ ) {
           var v = i * x;
           $(ddl).append("<option value='" + v + "'>" + v + "</option>");
       }
       console.debug(ddl);

       vt.push(x);
       x++; // our list changes
   }

   function resize(ddl) {

       console.log(ddl);

       ddl.size = $(ddl).val();
       $(ddl).empty();  // in case our list needs to change completely
       console.log(ddl);

       addopts(ddl);
       console.log(ddl);
   }

    jQuery(document).ready(function() {   
        console.log(this);
        $('#group').change(function() {
            console.log(this);
            resize(this);
        });
    });

  </script>                                                               

  </head>
  <body>
    <form>
     <select id='group' size='1'>
      <option value='1'>1</option>
      <option value='2'>2</option>
      <option value='3'>3</option>
      <option value='4'>4</option>
      <option value='5'>5</option>
     </select>
    </form>
  </body>
</html> 
```

↪[在 JSFiddle 查看此代码](http://jsfiddle.net/BVqML/)

任何见解表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:38:42.023

在 2 个方面，这确实是 Chrome 的一个问题。**经过大量测试，我在Chrome** 23 和 24中都发现了以下问题

1.  jQuery 的 .change && .on("change"**以及**JavaScript 的 .onchange 函数确实只在 chrome 中触发了两次
    *   我对此没有答案，但我找到了解决方法，我将在下面发布
2.  Chrome 似乎没有可用于呈现选择框的*奇数尺寸。*

    *   Chrome 似乎将大小调整为最接近的偶数（我想我注意到它向上取整）以重新渲染选择框。

    *   ***更新***进一步的测试表明（至少在第 24 版中）这种呈现为偶数的问题，仅适用于尺寸 0 到 4！

我提到的解决方法就像扔一个计时器一样简单，以便将选择设置为一个新实例，从而消除双重触发。如果我的术语是 sux，请原谅我，它有助于 chrome 在更改时仅触发一次并且不会影响其他浏览器（据我所知）

我还冒昧地重写了你的代码，只是为了让我更容易阅读（你的代码似乎有点“扩展”）

# [示例 jsFiddle](http://jsfiddle.net/SpYk3/TyVu3/)

> **我使用的**脚本****

 **```
var vt = new Array('1','2','3','4','5'),
    x = 1;

//  Since jQuery 1.1+ (i think) you no longer need the long written `$(document).ready`.
//  Now you can do the same thing with the short-hand below
$(function() {
    //  The selector you get. The .on() function is relativly new to jQuery and simply provides an easy way to bind events to elements
    //  You can also use .off to unbind a function to an element, for instance, i could wrap the inner function in a func named `reSize`
    //      and then add it and remove it with:
    //          - To add event: $("#group").on("change", reSize)
    //          - To remove event: $("#group").off("change", reSize)
    $("#group").on("change", function(e) {
        //  I create a variable of $(this) simply to pass it to the Timer function
        var $this = $(this);
        setTimeout(function() { //  basic JavaScript here
            //  Prop is also kind of new to jQuery. You used to just use `.attr()`, but now jQuery distinguishes between Attributes and Properties
            //  Since "size" is a Property of the select element, I use .prop to get/set the value
            //      In this case I'm of course setting the size to the current value
            //  One nice feature of jQuery you'll see here is "chaining"
            //      as you notice, i added the `.empty` to the end, since each jquery function generally returns the element object you started with
            //          Of course, had I only been GETting the value of size, this would not be the case
            $this.prop("size", $this.val()).empty();
            for (i=0;i<vt.length;i++) { //  basic JavaScript here
                var v = i*x;    //  your initial setup
                //  Here I replaced the append function you had with much more readable code.
                //  There are several ways to do this in jQuery, however
                //      fragmented Strings are not ever really suggested
                //  This could have also been written:
                //      $this.append($("<option />", { text: v, value: v }));
                $this.append($("<option />").val(v).text(v));
            }
            vt.push(x); //  more basic JavaScript
            x++;
            //      The following was used for debugging on the fiddle
            console.log(x)
            $("#selectSize").text($this.prop("size"));
        });
    });
}) 
```

### 一些有用的 **jQuery** 链接

*   [StackOverflow 在 jQuery 上的 NFO](https://stackoverflow.com/tags/jquery/info)（很多很好的例子）
*   [。准备好（）](http://api.jquery.com/ready/)
*   [.on()](http://api.jquery.com/on/) , .off( [)](http://api.jquery.com/off/)
*   [.prop()](http://api.jquery.com/prop/) , [.attr()](http://api.jquery.com/append/)
*   [。附加（）](http://api.jquery.com/append/)

> 只是为了帮助你。如果你又想把它放在一个独立的函数中，下面和上面的完全一样，只是函数是独立的，因此适用于任何选择。

```
var vt = new Array('1','2','3','4','5'),
    x = 1;

function reSizeSelect(e) {
    var $this = $(this);
    setTimeout(function() {
        $this.prop("size", $this.val()).empty();
        for (i=0;i<vt.length;i++) {
            var v = i*x;
            $this.append($("<option />").val(v).text(v));
        }
        vt.push(x);
        x++;
        console.log(x)
        $("#selectSize").text($this.prop("size"));
    });
}

$(function() {
    $("#group").on("change", reSizeSelect);
}) 
```**

# c# - 如何更改萨米路线

> ID：13629436
> 
> 赞同：0
> 
> 时间：2012-11-29T15:47:21.293
> 
> 标签：c#, routes, sammy.js

我在 spa 模板 (c#, mvc 4) 中使用 sammy 脚本。默认链接如下：/#/home、/#/contacts、/#/faq 等。如何仅在 /home、/contacts、/faq 上更改它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T19:13:52.040

散列描述了 URL 的本地部分，可以使用该`location.hash`方法进行修改。如果修改整个 URL，即`location.href`，浏览器会加载修改后的 URL。

看起来您想要做的是将 Sammy 使用的本地 URL 更改为`#home`或者`#contacts`您在开始时没有空哈希。

下面，Sammy 正在捕获对 URL 的更改，例如用户单击锚元素，`href="#Home"`然后发送 AJAX 请求以获取模板：

```
Sammy(function () {
/* Navigation requests
*/
    this.get("#:view", function () {
        switch (this.params.view) {                
            case "Home":
                $.ajax("Home/Index", {
                    type: "GET",
                    success: function (result) {
                        //Append result to page
                    },
                    cache: false
                });
                break;
            case "Search":
                $.ajax("Search/Index", {
                    type: "GET",
                    success: function (result) {
                        //Append result to page
                    },
                    cache: false
                });
                break;                
        };
    });
}).run(); 
```

# javascript - 将 firstchild 添加到新添加的元素

> ID：13629440
> 
> 赞同：1
> 
> 时间：2012-11-29T15:47:35.817
> 
> 标签：javascript

我需要为现有元素创建一个新子元素。[将 onclick 事件添加到 javascript 中新添加的元素](https://stackoverflow.com/q/3316207/505893)的问题对我帮助很大。

我只是不能把它定义为第一个孩子。我可以使用 放置它`position`，但这仍然不够。我在有关 JavaScript 的网站上进行了搜索，但一无所获。

这是我的代码：

```
if( !document.getElementById('callbackButton')){
  callback = function(){
  var button = document.createElement('button');
  button.id= 'callbackButton';
  var textbutton =document.createTextNode("Liste des années d'étude");
  button.appendChild(textbutton );
  button.style.position='absolute';
  button.style.top="60px";
  button.style.left="45px";
  button.style.width="200px";
  button.style.height="18px";
  button.onclick = function(){
    getElementsByIdStarWith('etageres-virtuelle')[0].innerHTML = oldInnerHtml;
    document.getElementById('etageres-virtuelles-etudes-germaniques').innerHTML =      oldInnerHtml;   
    wrapPager();
  };
  document.getElementById('etageres-virtuelles-etudes-germaniques').appendChild(button);
 }; 
```

这段代码工作得很好。

但是这段代码不起作用：

```
document.getElementById('etageres-virtuelles-etudes-germaniques').firstChild.nodeValue = button;
document.getElementById('etageres-virtuelles-etudes-germaniques').firstChild.nodeData = button; 
```

这不是我想要的。我想首先展示这个新元素。

任何帮助，将不胜感激。感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:00:15.943

试试这个（未经测试）：

```
var yourEl = document.getElementById('etageres-virtuelles-etudes-germaniques');
yourEl.insertBefore(button, yourEl.firstChild); 
```

# dwolla - 如何使用 Dwolla API 注册新用户

> ID：13629443
> 
> 赞同：2
> 
> 时间：2012-11-29T15:47:35.597
> 
> 标签：dwolla

这开始是一个问题，但在发布这个问题的过程中，我解决了它。所以现在，这是一个仅供参考的帖子......

==========

起初，每当我尝试发布到此 URL 时，都会收到一条错误消息：

*   https://www.dwolla.com/oauth/rest/register --> 错误的 URL

    没有监听http://phx-dwol-web1.cloudworks.com/oauth/rest/register的操作，但是有监听http://www.dwolla.com/oauth/rest/register/的操作，所以你被重定向到那里。

我通过将身份验证值附加到帖子 URL 来修复：

*   [https://www.dwolla.com/oauth/rest/register/?client_id=](https://www.dwolla.com/oauth/rest/register/?client_id=) {id}&client_secret={secret} --> 好网址

然后，我在请求格式方面遇到了问题。要解决此问题，请确保在帖子的正文中发布 JSON。不要附加到 URL，或作为表单字段提交。

最后，当我终于从 Dwolla API 得到正确的响应时，我收到了这个错误：

*   “新用户必须接受服务条款。”

这是因为 Dwolla API 是区分大小写的，因此 JSON 正文中的“ACCEPTTERMS”参数必须作为“acceptTerms”提交才能正常工作。

这是我引用的文档：http: [//developers.dwolla.com/dev/docs/register](http://developers.dwolla.com/dev/docs/register)

快乐编码！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T16:28:38.467

感谢您的回答......它最终导致我也解决了我的问题。

为了完整起见，我在向 api 发送格式不正确的请求时遇到了这个错误，我在获取参数 {oauth_token} 之前省略了尾随 /。

不正确：

```
http://www.dwolla.com/oauth/rest/users?oauth_token={oauth_token} 
```

正确的：

```
http://www.dwolla.com/oauth/rest/users/?oauth_token={oauth_token} 
```

# java - TestNG 命令行不工作（java org.testng.TestNG）

> ID：13629445
> 
> 赞同：1
> 
> 时间：2012-11-29T15:47:47.517
> 
> 标签：java, testng

我正在尝试使用这样的命令行运行 testng 测试：

```
C:\Documents and Settings\Administrateur\Bureau\automatic tests testNG>java -cp
C:\Documents and Settings\Administrateur\.m2\repository\org\testng\testng\6.3.1\
 testng-6.3.1.jar org.testng.TestNG testng.xml 
```

但我收到了这个错误：

```
 Exception in thread "main" java.lang.NoClassDefFoundError: and
 Caused by: java.lang.ClassNotFoundException: and
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
   Could not find the main class: and.  Program will exit. 
```

那么如何将 testNG 添加到类路径中。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:49:40.607

文件名中的空格令人困惑——Java 认为只有`c:\Documents`部分在类路径参数中。尝试这个：

```
java -cp
   "C:\Documents and Settings"\Administrateur\.m2\repository\org\
   testng\testng\6.3.1\testng-6.3.1.jar org.testng.TestNG testng.xml 
```

（整个事情都在一条线上，当然在“org”之后没有休息）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:50:36.400

如果您想在命令行上通过 java 运行，您需要引用您的路径 ( `"C:\Documents and Settings\Administrateur\.m2\repository\org\testng\testng\6.3.1\"`) 或稍作更改，如下所示`C:\Documents%20and%20Settings\Administrateur\.m2\repository\org\testng\testng\6.3.1\`：您可能还想通过 maven 运行以避免必须指定此类路径信息。

# postgresql - VB 脚本 PostgreSQL pg_dump

> ID：13629446
> 
> 赞同：2
> 
> 时间：2012-11-29T15:47:49.833
> 
> 标签：postgresql, windows-7, vbscript, dump, pg

我正在 VBScript 中为`PostgreSQL 9.1`Window 7 上的数据库编写备份脚本。

```
Set objShell = WScript.CreateObject("WScript.Shell")
objShell.Run postgresqlPath & "pg_dump.exe " & ServerId & " > " &  backupFolder & "Database.dump.out"
Wscript.Sleep 500
 objShell.SendKeys "Password~" 
```

该脚本似乎运行了两次，并且在目标文件夹中没有返回任何文件。

为了排除路径中的错误，我在命令行工具中尝试了命令，一切正常。

任何提示表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:51:22.893

您也可以使用 DOS 脚本

`pg_dump --host 192.168.0.1 --port 5432 --username "postgres" --role "postgres" --no-password --format plain --encoding UTF8 --inserts --verbose --file "C:\backup\mydatabase%ldt%.sql" "mydatabase"`

# java - Eclipse RCP - 响应来自 sourceProvider 的属性更改的应用程序范围的代码

> ID：13629448
> 
> 赞同：0
> 
> 时间：2012-11-29T15:47:53.537
> 
> 标签：java, eclipse-rcp

我正在尝试创建一个应用程序范围的侦听器，该侦听器将在布尔 sourceProvider 属性更改时切换视角。

我的 RCP 经验扩展到视图和源提供程序，有没有办法注册一些代码以在源更改时全局执行，但不位于视图或提供程序中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:45:10.353

如果您使用的是 e4，您可以以发布订阅样式发布事件。Eclipse 平台将充当您的全局消息总线。这是一个简短的介绍：[http://wiki.eclipse.org/Eclipse4/RCP/Event_Model](http://wiki.eclipse.org/Eclipse4/RCP/Event_Model) 事件的接收者然后切换透视图。

如果您有一个 RCP 3.x 应用程序，您可能会考虑使用上述功能在兼容模式下运行它（我没有尝试过）。

仅使用 3.x 功能我可以想到以下解决方案： 1\. 在主插件的激活器类中创建一个属性更改侦听器并注册此侦听器以侦听源的属性更改（必须实现属性更改支持，即必须触发事件并且必须接受侦听器）。如果您在启动时无法访问源代码，请稍后再做。2.如果监听者接收到适当的事件切换视角。

我想不出平台的任何原生功能可以做到这一点。

# google-maps - 仅在一侧在 Google 地图上绘制路径？

> ID：13629455
> 
> 赞同：0
> 
> 时间：2012-11-29T15:48:23.270
> 
> 标签：google-maps, google-maps-api-3, google-maps-styled

我想复制这张地图上显示的轮廓效果：[https ://maps.google.co.uk/maps?hl=en&safe=off&q=switzerland&ie=UTF-8&hq=&hnear=0x478c64ef6f596d61:0x5c56b5110fcb7b15,Switzerland&gl=uk&ei= PXO3UK3UPMS1hAfmjoDgBQ&sqi=2&ved=0CKQBELYD](https://maps.google.co.uk/maps?hl=en&safe=off&q=switzerland&ie=UTF-8&hq=&hnear=0x478c64ef6f596d61:0x5c56b5110fcb7b15,Switzerland&gl=uk&ei=PXO3UK3UPMS1hAfmjoDgBQ&sqi=2&ved=0CKQBELYD)

换句话说，我想画一条路径：

*   仅沿 GeoJSON 中定义的路径的一侧显示
*   从路径的外侧到内部的透明度逐渐消失？

使用 Google Maps API 可以实现以上任何一项吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T15:28:32.730

我相信要做到这一点，您需要创建一个自定义叠加层——这可能是一项艰巨的任务。有关基本示例，请参阅有关[自定义叠加层的文档。](https://developers.google.com/maps/documentation/javascript/overlays#CustomOverlays)

如果我实现了这个，我会创建一个覆盖层，它使用 HTML5 画布元素作为图块。

# mysql - MYSQL同一张表有不同的日期格式

> ID：13629460
> 
> 赞同：1
> 
> 时间：2012-11-29T15:48:35.010
> 
> 标签：mysql, datetime

我有一个表，其中填充了来自外部源的数据。问题是我为同一列获得了两种不同格式的日期，有一些格式的记录`'%Y-%m-%d %H:%i'`和其他`'%Y-%d-%m %H:%i%s'`格式的记录，它们都是`VARCHAR`类型。

我知道如何将字符串类型的日期字段转换为日期/日期时间字段，但如何处理日期出现方式的差异？是否可以根据其各自的格式更新日期，以便我可以应用`WHERE`更新的条件仅`WHERE date_field`是`'%Y-%m-%d %H:%i'`格式，然后另一个查询以`'%Y-%d-%m %H:%i%s'`格式更新日期字段？

现在，当我尝试使用常见查询更新表时，我收到与格式不匹配的字段的错误：

```
UPDATE my_table 
SET my_date_field = STR_TO_DATE(my_date_field,'%Y-%m-%d %H:%i:%s'); 
```

**响应：错误代码：1411。日期时间值不正确：函数 str_to_date 的“10-22-12 15:00”**

```
UPDATE my_table 
SET my_date_field = STR_TO_DATE(my_date_field,'%Y-%d-%m %H:%i'); 
```

**响应：错误代码：1292。截断不正确的日期时间值：'2010-01-01 00:00:00'**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T15:51:05.317

`10-22-12 15:00`对于你应该使用的这个值，`%y-%d-%m %H:%i`

而对于`2010-01-01 00:00:00`，它应该是`%Y-%m-%d %H:%i:%s`

所以您的查询将使用`CASE`

```
UPDATE my_table 
SET my_date_field = (CASE WHEN CHAR_LENGTH(my_date_field) = 14 
                          THEN STR_TO_DATE(my_date_field,'%y-%d-%m %H:%i')
                          ELSE STR_TO_DATE(my_date_field,'%Y-%m-%d %H:%i:%s')
                      END) 
```

*   [请参阅 SQLFiddle 演示](http://sqlfiddle.com/#!2/2ae1d/1)

其他来源

*   [日期格式](http://davidwalsh.name/format-date-mysql-date_format)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:55:24.023

你不能这样更新，因为如果该列中有数据并且它是不同类型的，那么你不能更新表列，所以你应该删除该列或为此创建一个程序，你可以检查并替换或更新表.

# java - Scalac 行为 - 无用的扫描？

> ID：13629467
> 
> 赞同：6
> 
> 时间：2012-11-29T15:49:02.333
> 
> 标签：java, scala, compiler-construction, compilation

在 Martin Odersky 的“Scala 编程”一书中，它解释了为什么`scalac`看起来很慢的原因（第 114 页）：

> 原因是每次编译器启动时，它都会花时间扫描 jar 文件的内容并执行其他初始工作，甚至在查看您提交给它的新源文件之前。

每次开始编译时扫描 jar 文件对编译有什么好处？事实上，如果大多数开发人员使用 FSC（Fast Scala 编译器）来避免这种默认行为，为什么 scala 的作者没有删除这些扫描？

为什么`javac`行为不相似？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T13:31:16.393

这可能是因为只是在文件`scalac`中调用了一个类。`.jar`我的猜测是他们不想创建临时（或缓存）文件。

# java - Android：替换缺少的安全架构

> ID：13629469
> 
> 赞同：1
> 
> 时间：2012-11-29T15:49:05.103
> 
> 标签：java, android, security, osgi, apache-felix

我正在开发一个允许插件通过 OSGi（使用 Apache Felix）运行的 Android 应用程序。但是，我想在每个插件的基础上强制执行某些安全方面。即允许哪个插件访问文件系统。另外，我想总体上防止反射。

到目前为止，我发现的所有教程都提到了结合使用 OSGi 安全性和加载标准 Java SecurityManager。但是，后者在 Android 上不存在，因此使整个方法完全无法使用。我不想使用 Bytecode Manipulation 来防止各种插件中发生事情，因为这既麻烦又我总是会错过一些东西。

那么，有没有人知道，我如何才能在 Android 上获得类似于标准 Java 安全的安全架构？最重要的是，如何防止使用反射？

而且，有没有办法阻止 I/O 访问，即基于每个线程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T02:27:47.430

除非您愿意修改核心操作系统，否则您不能。Android 标准权限可以限制对文件和 API 的访问，但没有什么可以阻止反射。操作系统使用它，所以如果你完全阻止它，事情就会崩溃。通过 UID 阻塞，进程可能是可行的，但您必须修改核心 Java API 的实现（在 libcore 中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T07:38:48.943

沙盒中的沙盒！出于性能原因，这听起来不是一个特别有吸引力的想法，但据我所知，仍然可以设置 SecurityManager。因此，您可以设置自己的安全管理器并随时检查检查。然而，[这个讨论](https://groups.google.com/forum/?fromgroups=#!topic/android-security-discuss/hH6Zv7Inbv8)表明，Android 团队对基础库的质量不是很有信心。（我可能会删除所有检查以获得一些性能，但我现在觉得进程内安全的整个想法是一个简单、清晰和错误的解决方案......）

# visual-studio-2010 - 加载 some.dll 时出错：无法加载测试容器“e:\some.dll”或其依赖项之一

> ID：13629470
> 
> 赞同：5
> 
> 时间：2012-11-29T15:49:06.883
> 
> 标签：visual-studio-2010, pinvoke, mstest

我有一个`VS2010` `C#`项目，它引用了大量的本地 .dll（商业 java 运行时）。这些文件在项目中被称为“内容”文件，因为需要与项目一起复制。

这些库中的代码使用 调用`PInvoke`，没有程序集引用。

每次我编译解决方案时，Visual Studio 测试框架都会尝试加载所有引用的 dll 文件，期望找到可能包含单元测试的 .net 程序集。由于没有 .net 程序集，因此引发以下异常：

> 加载 some.dll 时出错：无法加载测试容器“e:\some.dll”或其依赖项之一。如果您将测试项目程序集构建为 64 位程序集，则无法加载它。构建测试项目程序集时，为平台选择“任何 CPU”。要在 64 位处理器上以 64 位模式运行测试，您必须更改主机选项卡中的测试设置以在 32 位进程中运行测试。错误详细信息：**无法加载文件或程序集“file:///e:\some.dll”或其依赖项之一。该模块应包含程序集清单。**

这需要很多时间，我想告诉 Visual Studio 不要尝试加载这些文件。

如何告诉 Visual Studio 停止尝试加载这些文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T07:10:01.143

如果我弄错了，请纠正我：您将 P/Invoke 目标二进制文件包含在 VS 解决方案中，因为您希望在构建解决方案时将二进制文件复制到目标目录。您需要这样做，因为一旦构建了 VS 解决方案，项目就会从目标目录执行。正确的？

VS 包（默认和第 3 方）通常会尝试了解解决方案内容，并会遵循某些触发器（我们自己难以包含和控制）并以自己的方式加载解决方案和项目内容。与采用更简单的解决方法（下图）相比，在该领域进行战斗的投资回报率较低。

虽然我无法为您提供有关如何告诉 VS 的测试包不加载所有二进制文件的权威答案，但我建议将此类二进制文件作为“内容”从项目中删除，并将它们留在您的源代码管理中。添加一个构建后任务，将上述二进制文件复制到目标。这仍然会为您提供与今天相同的结果，但会使这些二进制文件无法用于测试探针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T11:20:11.803

我尝试重现此问题，发现根本原因是您已将测试项目设置为编译为！AnyCpu。对于托管测试代码，您有什么特别的原因吗？

因此，除非您更改此设置，否则您将继续看到此消息。

如果您想继续将此配置用于您的测试项目，您需要按照消息中的建议更新您的 .testsettings 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T10:17:24.313

您必须通过右键单击解决方案名称并单击“配置管理器”来检查配置设置。它将打开配置管理器的弹出窗口。不要检查您的项目正在使用的平台，最好选择任何 CPU。希望这可以帮助。试一试:)因为这就是你引用的例外所说的谢谢

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-19T07:56:46.363

# c# - 以月和周为间隔调度存储过程

> ID：13629473
> 
> 赞同：0
> 
> 时间：2012-11-29T15:49:28.190
> 
> 标签：c#, .net, date, datetime, azure

由于 Windows Azure 没有 SQL 代理，您必须创建自己的辅助角色才能像 SQL 代理一样工作，以便安排存储过程的运行。

好吧，除了日期部分之外，我已经准备好这部分了。这应该是非常合乎逻辑的，但在我看来并非如此。那么如何检查今天是否是本月的第一天和一周的第一天。

这是我到目前为止所拥有的：

```
Trace.WriteLine("SqlWorkerRole entry point called", "Information");

while (true)
{
    DateTime firstDayOfMonth = new DateTime(DateTime.UtcNow.Year, DateTime.UtcNow.Month, 1, 0, 0, 0);
    if (DateTime.UtcNow > firstDayOfMonth)
    {
        Guid? jobId = StartJob("MonthJob");

        if (jobId.HasValue)
        {
            Trace.WriteLine("Working", "Information");
            ExecuteMonthJob();
            StopJob(jobId.Value);
        }
    }
    else
    {
        Thread.Sleep(60000);
    }

    DateTime firstDayOfWeek = new DateTime(DateTime.UtcNow.Year, DateTime.UtcNow.Month, 1, 0, 0, 0);
    if (DateTime.UtcNow > firstDayOfWeek)
    {
        Guid? jobId = StartJob("WeekJob");

        if (jobId.HasValue)
        {
            Trace.WriteLine("Working", "Information");
            ExecuteWeekJob();
            StopJob(jobId.Value);
        }
    }
    else
    {
        Thread.Sleep(60000);
    }
} 
```

我需要这部分的帮助（每月的第一天）

```
DateTime firstDayOfMonth = new DateTime(DateTime.UtcNow.Year, DateTime.UtcNow.Month, 1, 0, 0, 0);
if (DateTime.UtcNow > firstDayOfMonth) 
```

和（一周的第一天）

```
DateTime firstDayOfWeek = new DateTime(DateTime.UtcNow.Year, DateTime.UtcNow.Month, 1, 0, 0, 0);
if (DateTime.UtcNow > firstDayOfWeek) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:19:53.453

好吧，您也可以使用 Enzo Cloud Backup Community Edition（免费软件）。它有一个内置的调度程序（需要一个 x-small worler 角色），您可以调度 T-SQL 调用。调度器可以每周做一次，但此时不是每月做一次；在存储过程本身中添加逻辑以确定您的过程是否在本月运行仍然是微不足道的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T03:00:32.857

如果您不想为工作人员角色付费，您还可以考虑使用 Cotega，这是一项能够安排[存储过程执行的](http://cotega.com/docs/sql_azure_scheduled_job)服务。

完全披露，我从事 Cotega 服务。

# javascript - 使用 javascript 从 JSON 响应中删除内联样式

> ID：13629477
> 
> 赞同：1
> 
> 时间：2012-11-29T15:49:37.567
> 
> 标签：javascript, jquery, json

我正在使用 JSON 从 Wordpress 网站接收内容并将其显示在我的移动应用程序上。我收到的 JSON 响应中有一些我不需要的内联样式。但是，我确实喜欢保留实际的 html 结构。这是我可以用 Javascript/jQuery 做的吗？

例如，我喜欢这样：

```
<span style="color: red;">some text</span>
<p style="text-align: right;">Other stuff</p> 
```

转向这个：

```
<span>some text</span>
<p>other stuff</p> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T16:00:54.750

从您的 HTML 字符串创建一个 jQuery 对象，然后`.removeAttr()`像其他人所说的那样使用：

```
var $result = $(yourHTMLString);

$result.find('[style]').removeAttr('style'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:50:55.550

您可以使用该[`removeAttr()`](http://api.jquery.com/removeattr/)方法删除属性，试试这个：

```
$("span").removeAttr('style'); 
```

* * *

**更新**

> 我的 JSON 响应只是文本，它不是我可以使用 removeAttr 的 DOM 元素

在这种情况下，您可以将响应文本转换为 jQuery 对象并在其`removeAttr()`上运行：

```
var $html = $(jsonResponseData);
$html.find('span').removeAttr('style'); 
```

# jquery - 从右到左滑动切换

> ID：13629479
> 
> 赞同：2
> 
> 时间：2012-11-29T15:49:39.170
> 
> 标签：jquery, animation, slidetoggle

我在看一个教程时做了这个，但我看不到任何选项可以让它从右侧到左侧工作。我不希望它贴在身体的右侧。

[链接到小提琴](http://goo.gl/JmFGn)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T15:55:49.153

来自[jQuery 文档](http://api.jquery.com/slideToggle/)：

> 该`.slideToggle()`方法对匹配元素的高度进行动画处理。这会导致页面的下部向上或向下滑动，似乎显示或隐藏项目。如果元素最初被显示，它将被隐藏；如果隐藏，它将显示。

所以看起来从一边到另一边做这件事**不是**一种选择（使用那种方法），如果你正在看一个教程，你最容易的赌注就是将 jQuery UI 添加到你的项目中并使用它的动画方法。这将使它变得简单：

```
$(this).hide('slide',{direction:'left'},1000); //or show 
```

但是，您可能想在没有 jQuery UI (yaiii) 的情况下学习它，毕竟这并不难。您需要分解 jQuery UI（我假设）正在做什么，例如：

```
$(this).animate({ marginLeft: "100%"} , 1000); 
```

在这两个例子中，你当然需要`this`用你的选择器替换你想要动画的元素，但是既然你正在学习，我想我会指出它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:50:49.023

你也可以考虑插件：

[http://www.webinventif.fr/wslide-plugin/](http://www.webinventif.fr/wslide-plugin/)

该页面是法语的，但插件是不言自明的。

希望这可以帮助

# python - 如何在python 2.7中将列表列表的值转换为int

> ID：13629483
> 
> 赞同：0
> 
> 时间：2012-11-29T15:49:42.773
> 
> 标签：python

我有一个列表列表，例如

```
T =[[0.10113], [0.56325], [0.02563], [0.09602], [0.06406], [0.04807]] 
```

我想找到这些数字的总和。

我是 python 编程的新手，当我尝试一个简单的`int(T[1])`转换时，我得到了错误

```
TypeError: int() argument must be a string or a number, not 'list' 
```

我很感激任何意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:51:18.643

简单的：

```
sum(x[0] for x in T) 
```

你完成了 ：）

* * *

当然，你可以使用

```
import itertools
sum(itertools.chain.from_iterable(T)) 
```

也。如果您的子列表每个都有超过 1 个元素，这将起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T15:51:34.850

您可以[`map`](http://docs.python.org/2/library/functions.html#map)为此使用：

```
sum(map(sum, T)) 
```

```
>>> 总和（地图（总和，T））
0.89816000000000007

```

从文档中`map`：

> **映射**（函数，可迭代，...）
> 
> 将函数应用于可迭代的每个项目并返回结果列表。

因此，您正在使用`map`总计内部列表，然后调用`sum`总计这些值以获得最终答案。

如果您的内部列表包含多个项目，则此方法将起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T15:53:41.270

您可以使用 numpy sum 模块

```
 import numpy as np
 result = int(np.sum(T, axis=0)) 
```

或内置地图功能

```
 result = int(sum(map(sum, T))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T15:51:40.183

```
In [31]: T =[[0.10113], [0.56325], [0.02563], [0.09602], [0.06406], [0.04807]]

In [32]: sum(t[0] for t in T)
Out[32]: 0.8981600000000001 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-29T15:51:51.677

```
>>> T =[[0.10113], [0.56325], [0.02563], [0.09602], [0.06406], [0.04807]]
>>> sum(x[0] for x in T)
0.8981600000000001 
```

# jquery - 如何在移动网站中管理轮播上的水平滚动？

> ID：13629491
> 
> 赞同：0
> 
> 时间：2012-11-29T15:50:09.020
> 
> 标签：jquery, jquery-mobile, mobile, scroll

我有一个带有图像轮播的网站。在移动设备上，当我水平移动手指时，我想“移动”这个旋转木马。

这个轮播已准备好工作，已经使用 jquery 完成（但使用点击处理程序处理）。我需要通过水平移动来处理它。

是否有一个 jquery 插件可以让我处理这个动作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:55:41.967

如果您使用 jQuery mobile，您可以轻松使用滑动事件。

例子：

```
$("#carousel").bind('swipeleft',function(event, ui){

}); 
```

如果您不使用 jQM，请查看以下框架：[http](http://wipetouch.codeplex.com/) ://wipetouch.codeplex.com/ 。它很轻。还有一些其他框架，但我从未使用过它们。几个月前，我创建了一个带有轮播和 jQM 滑动事件的 jQM 应用程序。它工作得很好，没有性能问题。

**编辑 ：**

这是一个工作轮播示例（使用 swipeleft 事件，您也可以实现 swiperight，但这只是一个示例）：http: [//jsfiddle.net/Gajotres/Np3G4/](http://jsfiddle.net/Gajotres/Np3G4/)我已经在我的 PC 上对其进行了测试（只需将鼠标拖动到左侧）和 Android 4.1（向左滑动），但根据我过去的经验，它也适用于 iPad（所以我相信它应该适用于 iPhone）。这段代码是这个[轮播](http://caroufredsel.dev7studios.com/download.php)和我对常见 jQM 滑动事件的实现的组合。您仍然可以将 jQM 框架仅用于滑动事件。

**编辑2：**

此版本适用于没有 jQuery 移动框架的 iPad：http: [//jsfiddle.net/Gajotres/qCB6w/](http://jsfiddle.net/Gajotres/qCB6w/)。它使用 touchwipe 框架： http: [//www.netcu.de/jquery-touchwipe-iphone-ipad-library](http://www.netcu.de/jquery-touchwipe-iphone-ipad-library)。我希望这就是让它工作所需的一切。

# java - Scala的演员，java等价物是什么？权衡？

> ID：13629497
> 
> 赞同：1
> 
> 时间：2012-11-29T15:50:32.663
> 
> 标签：java, scala, concurrency, actor

我正在阅读有关 Scala 的演员的信息，所以说我们有类似的内容：

```
object Worker extends Actor {
  def act() {
    while(true) {
      receive {
        case "exit" => {
          println("exiting...")
          sender ! Exit
        }
        case s:String if s.startsWith("scp") => {
          println("Starting scp")
          Thread.sleep(2000)
          sender ! Done(s)
        }
        case s:String => {
          println("Starting " + s)
          sender ! Done(s)
        }
      }
    }
  }
} 
```

（[http://www.naildrivevin5.com/scalator/wiki_pages/ActorsAndConcurrency](http://www.naildrivin5.com/scalatour/wiki_pages/ActorsAndConcurrency)）

*Java 的等效模式是什么样的？* 我知道在 Java 中执行此操作要麻烦得多。

**Scala 的演员是否有任何性能影响？当然，从我收集的内容中实现和理解都更容易，但好奇是否有任何权衡。**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T15:55:20.310

看看[akka](http://akka.io)框架。有了它，您将拥有 Java 中 Actor 模型的强大功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T16:14:50.313

正如其他人提到的，Akka 可能是最好的候选者，虽然它是用 Scala 编写的，但它的编写方式也使得它可以从 Java 中访问。作为旁注，Akka 实现将在未来取代当前的实现。

此外，Scala actor 实现并不是语言本身的特性，只是标准库包含了该实现。

就性能影响而言，当前的 Scala 实现无论如何都不是那么好，所以这将是一个坏例子。但是，我不能强烈推荐 Akka 的文档：http: [//doc.akka.io/docs/akka/2.0.4/](http://doc.akka.io/docs/akka/2.0.4/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-29T16:42:16.507

Scala 的actor（不与akka 的actor 混合）实际上是一个带有输入队列的线程，它的等价物可以在java 中轻松实现：

```
 interface Port<T>{
   public void send(T msg);
 }
 class StringMessage {
   String value;
   Port sender;
 }
 class Worker extends Thread implements Port<StringMessage>{
     ConcurrentLinkedQueue<StringMessage > q=new ConcurrentLinkedQueue<StringMessage >();

     public send(StringMessage m) {
       q.put(m);
     }

     public void run() {
        while(true) {
          StringMessage msg=q.take();
          String s=msg.value;
          if (s.equals("exit") {
             println("exiting...");
             msg.sender.send(Exit);
             return;
          } else if (s.startsWith("scp") {
             println("Starting scp")
             Thread.sleep(2000)
             msg.sender.send(Exit);
          } else {
             println("Starting " + s)
             msg.sender.send(Done(s));
          }
       }
    }
  } 
```

这只是一个草图，要使其可行，您必须在通信线程之间开发合同和协议。或者您可以采用现有的 java 演员框架（有很多）。要明智地选择，您必须回答以下问题：

*   演员应该基于线程或在线程池上执行的轻量级任务吗？线程消耗大量内存，但允许阻塞操作。最广为人知的 Akka 框架使用轻量级任务。

*   演员模型对你来说足够了吗？经典actor有单个输入端口，更广泛的数据流模型允许actor节点有多个输入端口，并且当所有输入端口不为空时触发。这允许在[另一个问题](https://stackoverflow.com/questions/10695152/java-pattern-for-nested-callbacks)中构造“嵌套回调” 。Java 数据流框架很少见，我知道的唯一开源库是我的[df4j](https://github.com/rfqu/df4j)。它允许基于线程和基于任务的 Actor 节点，并具有带有单个输入的子类 Actor。

# ruby-on-rails - 在预先加载的关联上指定条件后无法获取对象

> ID：13629500
> 
> 赞同：2
> 
> 时间：2012-11-29T15:50:37.257
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有这些模型：

```
class Question
  has_many :answers
end

class Answer
  belongs_to :question
end

class Exam
  belongs_to :general_exam
  belongs_to :user
  has_many :questions, through: :exam_questions
end

class ExamQuestion
  belongs_to :exam
  belongs_to :question
end 
```

目前，我想获得考试中的所有问题和问题的答案，所以我使用**了 Specifying Conditions on Eager Loaded Associations**，我在控制台中运行了这个：

```
exam = Exam.find(16)
questions = Question.includes(:answers).where("id = ?", exam.question_ids) 
```

运行后在控制台输出`questions = ...`：

```
SELECT "questions".id FROM "questions" INNER JOIN "exam_questions" ON "questions"."id" = "exam_questions"."question_id" WHERE "exam_questions"."exam_id" = 16 ORDER BY questions.created_at DESC
  Question Load (0.8ms)  SELECT "questions".* FROM "questions" WHERE (id = 170,162,160) ORDER BY questions.created_at DESC
=> #<ActiveRecord::Relation:0x4c07ebc> 
```

第一个奇怪的是，我在查询中看到，它做了一个**INNER JOIN**，但在[**rails guide**](http://guides.rubyonrails.org/active_record_querying.html#specifying-conditions-on-eager-loaded-associations)，它说查询会做一个**LEFT OUTER JOIN**，我不知道为什么会有所不同。

第二件事，现在我想得到问题对象`questions`，我跑了：

```
questions.each do |q|
  puts q.content
end 
```

它返回错误：

```
SELECT "questions".* FROM "questions" WHERE (id = 170,162,160) ORDER BY questions.created_at DESC
ActiveRecord::StatementInvalid: PG::Error: ERROR:  argument of WHERE must be type boolean, not type record
LINE 1: SELECT "questions".* FROM "questions"  WHERE (id = 170,162,1... 
```

我现在如何获得问题对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:08:22.987

看起来你的 where 子句是错误的。尝试：

```
where(:id => exam.question_ids) 
```

当您提供字符串版本“id = ?”时，数据库适配器不会将其转换为 in-clause。当您提供哈希版本时，数据库适配器将识别出该值是一个数组并使用 in。

也许更有效的方法是以不同的方式解决问题：

```
class Question
  has_many :exam_questions
end

questions = Question.joins(:exam_questions).where(:exam_questions => {:exam_id => 16}) 
```

请参阅[高效的 ActiveRecord has_and_belongs_to_many 查询](https://stackoverflow.com/questions/13625171/efficient-activerecord-has-and-belongs-to-many-query)

# python - Celery：如何忽略和弦或链中的任务结果？

> ID：13629507
> 
> 赞同：41
> 
> 时间：2012-11-29T15:51:06.267
> 
> 标签：python, asynchronous, task, celery

我正在使用芹菜，我有几个需要按顺序执行的任务。

例如我有这个任务：

```
@celery.task
def tprint(word):
    print word 
```

我想做这样的事情：

```
>>> chain(tprint.s('a') | tprint.s('b'))() 
```

然后我得到`TypeError: tprint() takes exactly 1 argument (2 given)`.

和弦一样，在这种情况下，我需要在一组任务之后执行一个任务：

```
>>> chord([tprint.s('a'), tprint.s('b')])(tprint.s('c')) 
```

那么如何处理这种情况呢？我不在乎每个任务的结果，但它们需要按顺序执行。

* * *

添加第二个参数不起作用：

```
@celery.task
def tprint(word, ignore=None):
    print word

>>> chain(tprint.s('a', 0) | tprint.s('b'))() 
```

这将打印出“a”和“None”。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-12-09T14:51:37.047

有一个内置功能可以忽略链接和其他结果 - 不可变子任务。您可以使用 .si() 快捷方式而不是 .s() 或 .subtask(immutable=True)

更多细节在这里：[http ://docs.celeryproject.org/en/master/userguide/canvas.html#immutability](http://docs.celeryproject.org/en/master/userguide/canvas.html#immutability)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-10T08:33:51.590

一种可能的解决方案已经发布，但我想进一步澄清和替代解决方案（在某些情况下是更好的解决方案）。

您看到的错误表明您的任务签名需要考虑第二个参数，这是由于在 a 中调用任务时`chain`，Celery 会自动将每个任务推送`result`为以下任务的第一个参数。

从[文档：](http://docs.celeryproject.org/en/latest/userguide/canvas.html#chains)

> 任务可以链接在一起，这实际上意味着添加一个回调任务：

```
>>> res = add.apply_async((2, 2), link=mul.s(16))
>>> res.get()
4 
```

> 链接的任务将应用其父任务的结果作为第一个参数

因此，在您的情况下，您可以像这样重写您的任务：

```
@celery.task
def tprint(result, word):
    print word 
```

~~如果你不打算对结果做任何事情，你也可以通过[改变装饰器](http://docs.celeryproject.org/en/latest/userguide/tasks.html#Task.ignore_result)来忽略它：~~

 ~~```
@celery.task(ignore_result=True) 
```~~ 

~~然后您就不必更改您的任务签名。~~

抱歉，最后一点需要进一步研究。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-03T05:08:30.930

你可以尝试做这样的事情。您可以有两个参数，而不是函数 tprint 的单个参数

```
def tprint(word, x=None):
    print word 
```

然后

```
chain(tprint.s('a', 0) | tprint.s('b'))() 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-04T09:56:35.223

最后找到解决方法，链装饰器将完成这项工作。

我不知道 celery 究竟是如何做到的，但 celery 似乎强制将上一个任务的结果绑定到下一个任务的第一个参数。

所以这里有一个例子：

```
def chain_deco(func):

    @functools.wraps(func)
    def wrapper(chain=None, *args, **kwargs):
        if chain is False:
            return False

        func(*args, **kwargs)
        return True

    return wrapper

@celery.task
@chain_deco
def hello(word):
    print "hello %s" % word 
```

现在这将给出正确的输出。

```
>>> (hello.s(word='a') | hello.s(word='b'))() 
```

或者

```
>>> (hello.s('a') | hello.s('b'))(True) 
```

并且装饰器还提供了在中间停止链的能力（使后面的级联失败。）

同样的机制也应该适用`chord`。

# objective-c - iOS基于第三个数组值将对象从另一个数组添加到数组

> ID：13629508
> 
> 赞同：0
> 
> 时间：2012-11-29T15:51:07.020
> 
> 标签：objective-c, ios

编辑：我的项目中使用的所有数组都是`NSMutableArray`类

我想要做的概述来自我的 selectClueView，用户可以从 3-10 中选择一个数字。这代表他们将播放的线索数。然后它将生成 0 和 之间的随机数列表，并将其`objectArray.count`添加`NSNumber`到另一个称为 dataArray 的数组中。一切正常，包括`prepareForSegue`转移`SelectClueViewController.dataArray`到`GamePageViewController.clueToSelect`

但是，我坚持将数据`ds`从包含所有对象的数组加载到新数组中`allDataObject`。我对 iOS 相当陌生，因为我在 c# 中有一个工作函数，所以我试图在 Objective-C 中复制它，不幸的是，我似乎无法完全复制它。

简而言之，我正在尝试将数组中的数据添加`allDataObject`到`ds`具有数组`NSNumber`值的`cluesToSelect`数组中。

以下是使用的编码。任何解决此问题的帮助将不胜感激。如果我应该提供更多信息，请告诉我。

SelectClueViewController.m

```
- (IBAction)onGoPress:(id)sender {
    [self chooseNumber];
     NSLog(@"Array got %d numbers",dataArray.count);
}

-(void)chooseNumber
{
    [dataArray removeAllObjects];
    maxCount = [numberOfClues.text intValue];

    int count = 0;
    do {

        NSInteger rdmNumber = arc4random()%objectArray.count;
        if (![dataArray containsObject:[NSNumber numberWithInt:rdmNumber]])
        {
            NSNumber* number = [NSNumber numberWithInt:rdmNumber];
            [dataArray addObject:number];
            count++;
            NSLog(@"random no - %d",rdmNumber);
        }
    } while (count < maxCount);

}

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
    if ([[segue identifier] isEqualToString:@"sendNumber"]) {

        GamePageViewController *gpViewController = [segue destinationViewController];
        gpViewController.cluesToSelect = self.dataArray;
        NSLog(@"Success");
    }
} 
```

游戏页面视图控制器.m

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
    daoDS = [[ClueDataDAO alloc]init];
    self.allDataObject = daoDS.PopulateDataSource;
    NSLog(@"%d",cluesToSelect.count);

    [self fillDataSample];

    //for keyboard
    self.answer.delegate = self;        
}

    -(void)fillDataSample
{
    int count = 0;
    do {
       // [self.ds addObject:[allDataObject objectAtIndex:[[cluesToSelect objectAtIndex:count]intValue] ]];
        ds = [[NSMutableArray alloc]init];
        currentClueData = [[ClueData alloc]init];        
        int firstIndex = [[cluesToSelect objectAtIndex:count]intValue];
        currentClueData = [allDataObject objectAtIndex:firstIndex];
        [ds addObject:currentClueData];

        count++;
    } while (count < cluesToSelect.count);
    NSLog(@"ds got %d object",ds.count);
} 
```

编辑：

我现在可以让它将对象添加到`ds`数组中，不幸的是它只添加了一次。有人可以看看我的`fillDataSample`功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:57:17.690

在您指向开头的行中：

```
[self.ds addObject:[allDataObject objectAtIndex:[cluesToSelect objectAtIndex:count]]]; 
```

只是一个疯狂的猜测，但`[cluesToSelect objectAtIndex:count]`返回一个对象。你试图将它传递给另一个`objectAtIndex:`，它需要一个`int`作为参数。我猜错误可能来自于此。`.intValue`如果是数字，您可以尝试使用。

编辑 ：

这是更具可读性的内容，考虑`cluesToSelect`并`allDataObject`仅包含 NSNumbers ：

```
int firstIndex = [[cluesToSelect objectAtIndex:count] intValue];
int secondIndex = [[allDataObject objectAtIndex: firstIndex] intValue];
[self.ds addObject:secondIndex]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:59:57.780

根据我们的讨论，

请检查这个：

```
[self.ds addObject:[allDataObject objectAtIndex:[[cluesToSelect objectAtIndex:count] intValue]]]; 
```

会做你的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T02:38:37.107

为什么它不适用于我将对象从类对象加载到类对象的新方法是`allClueData`因为我没有，并且将类对象添加到. 该对象无法像在其他语言中那样覆盖自己的值。（这可能就是为什么我在目标 C 中这样做而破坏我的大脑）但是在添加了 object 和 cast之后，它现在工作得很好。谢谢大家:)`currentClueData``ds``nil``alloc init``ds``nil``alloc and init`

-(void)fillDataSample { int count = 0; currentClueData = [[ClueData alloc]init]; ds = [[NSMutableArray alloc]init]; do { // [self.ds addObject:[allDataObject objectAtIndex:[[cluesToSelect objectAtIndex:count]intValue] ]];

```
 int firstIndex = [[cluesToSelect objectAtIndex:count]intValue];
    currentClueData = [allDataObject objectAtIndex:firstIndex];
    [ds addObject:currentClueData];
    currentClueData =nil;
    currentClueData = [[ClueData alloc]init];

    count++;
} while (count < cluesToSelect.count);
NSLog(@"ds got %d object",ds.count); 
```

}

# c# - 使用 C# 解析复杂的 JSON 对象

> ID：13629511
> 
> 赞同：3
> 
> 时间：2012-11-29T15:51:13.337
> 
> 标签：c#, json

我有一个像这样的 JSON：

```
{
    "name" : "MyCustomName",
    "my_node" : {
        "name" : "my_node_name"
    },
    "dict1":"value1",
    "dict2":"value2",
    "dict3":"value3",
    ...
} 
```

和一个对象：

```
class Node{
    string value;
}

class Sample:IDictionary<string, string>{ 
    Node node;
    string name; 
} 
```

*Sample 类中的节点*和*名称*始终存在。问题是我不知道会有多少“dictN”字段......这就是重点。

问题是：如何将 JSON 反序列化为此对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:57:41.537

编辑：显然，即使字段名称协调一致，您的反序列化器也无法处理与通用字典字段相结合的特定字段。

在这种情况下，我只是建议反序列化为 a`Dictionary<string, object>`并构建结果：

```
var d = new JavaScriptSerializer().Deserialize<Dictionary<string, object>>(json);
Sample s = new Sample();
s.name = (string)d["name"];
Node n = new Node();
n.value = (string)((Dictionary<string, object>)d["my_node"])["name"];
foreach (var key in d.Keys.Except(new string[] { "name", "my_node" }))
{
    s.Add(key, (string)d[key]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:09:59.810

您可以简单地以 的形式输出`Dictionary<string, object>`，尝试使用这段代码。

```
System.Web.Script.Serialization.JavaScriptSerializer s = 
    new System.Web.Script.Serialization.JavaScriptSerializer();

var nodes = s.Deserialize<Dictionary<string, object>>(jsonString);
var dictNodes = nodes.Where(w => w.Key.StartsWith("dict")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T16:06:51.103

**最初的想法**

下面是一个字典序列化器。它有一种不接受空字符串的特殊情况。

```
private void SerializePerinatalModel<T>(IDictionary<string, object> dataModel, T perinatalModel)
    {
        Type sourceType = typeof(T);
        foreach (PropertyInfo propInfo in (sourceType.GetProperties()))
        {
            if (dataModel.ContainsKey(propInfo.Name))
            {
                //  if an empty string has been returned don't change the value
                if (dataModel[propInfo.Name].ToNullSafeString() != String.Empty)
                {
                    try
                    {
                        Type localType = propInfo.PropertyType;
                        localType = Nullable.GetUnderlyingType(localType) ?? localType;
                        propInfo.SetValue(perinatalModel, Convert.ChangeType(dataModel[propInfo.Name], localType), null); 
                    }
                    catch (Exception e)
                    {
                        //  ToDo: log update value errors
                    }

                }
            }

        }
    } 
```

但可以使 null 安全。它确实处理可为空的类型。

由于 JSON 本质上是一种字典类型，因此遍历顶级类型应该可以让您到达那里。

这是匆忙写的，所以只是一个想法的草图。

**更好的想法** 也尝试使用

```
foreach (var item in JsonData.Where(m => m.Key.Substring(0,4) == "dict"))
{
   // add item to collection
} 
```

也可以做生意。

# repository-pattern - 在 N 层架构中处理非删除实体

> ID：13629514
> 
> 赞同：0
> 
> 时间：2012-11-29T15:51:19.767
> 
> 标签：repository-pattern, n-tier-architecture

在 N 层架构中处理非删除实体的最佳实践方法是什么。所讨论的架构有一个服务层和一个存储库层。存储库是唯一可以直接访问数据库的层（嗯，通过 ORM）。目前，存储库层主要处理 CRUD 操作。该层是否应该根据给定状态处理实体的检索？

让我解释一下我们系统中状态的使用。我们想使用状态来删除实体。因此，我们不会删除用户实体，而是将其状态设置为已删除。现在，用户存储库公开了一个 Get 方法。不带任何参数调用 Get 应该返回系统中的所有用户，不管它的状态如何，但是如果我们只想获取活动用户，最好在 Service 层或 Repository 层处理。如果我们要在服务层执行此操作，我们将需要对 Repository Get 方法响应提出一个过滤器。如果我们在 Repository 层这样做，我们会让 Get 获取一个 Status 枚举，因此您可以调用 Get(Status.Active)。处理此类事情的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:11:40.903

我建议将 Get(id) 限制为检索特定实体的详细信息，然后实现某种类型的 Find/Search 功能，该功能接受 SearchCriteria 对象来定义您的搜索参数（例如状态）。为了回答您关于在哪里进行过滤的问题，我建议使用数据库，因为它针对查询执行进行了优化。

# c - 将指向枚举的指针传递给指向 int 的指针输出参数

> ID：13629515
> 
> 赞同：4
> 
> 时间：2012-11-29T15:51:23.043
> 
> 标签：c, casting, enums

我有类似于以下的代码：

```
void generateInt(int *result)
{
  /* chosen by fair dice roll*/
  *result = 1;
}

typedef enum colour
{
  RED,
  GREEN,
  BLUE
} COLOUR;

int main(int, char**)
{
  COLOUR col, col2;
  int i;

  generateInt(&i);
  col = (COLOUR)i;

  generateInt((int*)(&col2));

  return 0;
} 
```

在第二次调用之后，`generateInt`是否都保证等于？我知道第一个版本设置是合法的，但我不知道它是否定义了如果将指针到枚举转换为指针到int，然后通过指针分配会发生什么。`col``col2``GREEN``col`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T15:53:17.740

那肯定*不行*。您没有理由相信枚举的基础类型是`int`，因此强制转换指针可能非常不合适。

为什么不只是改变功能？

```
void generateInt(COLOUR * c)
{
    *c = GREEN;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:58:39.813

这应该是正确的方法：

```
void generateInt(COLOUR * c)
{
    //Roll number given here
    switch(roll_result)
    {
      case 0 :
        *c = RED;
      break;
      case 1 :
         *c = GREEN;
      break;          
      case 2 :
         *c = BLUE;
      break;
      //...
      default :
      break;
   }
} 
```

# c++ - 列号相等的模板矩阵

> ID：13629518
> 
> 赞同：0
> 
> 时间：2012-11-29T15:51:29.420
> 
> 标签：c++, templates

我有一个作业告诉我们为矩阵创建一个模板，其中 matrix1 的列号等于第 2 列的行号

我试过了：

```
 #define TEMPLATEMATRIXCR template<class T, int , int > 
 TEMPLATEMATRIXCR Matrix<T, R> operator* (Matrix<T, int, R> a, Matrix<T, R, int> b); 
```

例如，它不起作用

矩阵 [10][30]
矩阵 [20][10]
所以我需要带有 [20][30] 的矩阵；//对不起，如果我的逻辑混乱。它告诉我 E 没有定义。

第一时间我做到了

```
TEMPLATEMATRIX Matrix<T, C, R> operator* (Matrix<T, C, R> a, Matrix<T,R, C> b); 
```

但这不是他想要的，所以现在我不能只修复两个数字并让其他数字“自由”

我怎样才能使用模板做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:25:58.980

我可能不太明白您的要求，但这最终不是您想要做的吗？

```
template<typename T, size_t R1, size_t C1, size_t R2>
Matrix<T, R2, C1> operator *(const Matrix<T, R1, C1>&, const Matrix<T, R2, R1>&); 
```

或者您是否试图以编程方式使 C1 和 R2 变得任意？

# jquery - 新创建元素上的事件 - on() 与 live()

> ID：13629519
> 
> 赞同：-1
> 
> 时间：2012-11-29T15:51:30.800
> 
> 标签：jquery

我将以下代码放在一起作为实验：

HTML：

```
<button>Click Me</button> 
```

jQuery：

```
$('button').on('click', function() {

    $newButton = $('<button />');
    $newButton.addClass('newButton');
    $newButton.attr('href', '#');
    $newButton.html('A New Button');

    $('body').append($newButton);

}); 
```

代码本身工作正常，当单击按钮时，jQuery 会生成一个新按钮，正如预期的那样。让我摸不着头脑的问题是，新创建的按钮不会对被点击做出反应，换句话说，即使 jQuery 代码针对所有元素，它也不会创建新按钮。

我知道 live() 自 1.7 起不再受支持，并已被 on() 取代。如您所见，上面的代码使用了 on() 事件，但是我没有得到 live() 用来提供的结果。

显然我在某个地方出错了，有人可以建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T15:52:59.080

使用时，`.on()`您需要将事件处理程序委托给 DOM 树的更高层：

```
$("#someCommonAncestor").on("click", "button", function () {
    // Do stuff
}); 
```

这正是`.live()`幕后所做的（它将事件处理程序委托给`document`）。这不是很有效，因为`document`你可以走的尽可能远。您可以委托事件处理程序越接近目标元素越好。

这是有效的，因为大多数 DOM 事件从它们起源的元素（*目标*）通过所有祖先元素在树中冒泡。当事件到达您绑定事件处理程序的元素时，jQuery 会检查目标是否与选择器（的第二个参数`.on()`）匹配，如果匹配则执行处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T15:53:32.543

`.on`应该在特定语法中用作委托事件。见下文，

```
$(container).on('click', 'child-el-selector', function() {
      //your stuff
}); 
```

但我建议您在创建元素时绑定处理程序，而不是使用委托事件（直接绑定）。如下图，

```
function myButtonFx () {
    var $newButton = $('<button />');
    $newButton
        .addClass('newButton')
        .attr({'href': '#'})
        .html('A New Button')
        .on('click', myButtonFx);

    $('body').append($newButton);
}

$('button').on('click', myButtonFx); 
//Note: The above binds only to the button that existed in DOM. 
```

# brainfuck - 如何在BF中添加两个一位数

> ID：13629522
> 
> 赞同：1
> 
> 时间：2012-11-29T15:51:34.537
> 
> 标签：brainfuck

> **可能重复：**
> [如何用 BrainFuck 计算 2 个数字的总和](https://stackoverflow.com/questions/10670510/how-to-calculate-the-sum-of-2-numbers-with-brainfuck)

有谁知道如何编写一个简单的 BF 程序，将两个一位数相加？我是这门语言的新手，需要一些帮助来掌握这些概念。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-30T13:58:24.137

如果您有两个单元格，每个单元格的值都为 0 到 9，您可以将一个单元格添加到另一个单元格中。假设您有两个单元格 A 和 B。A 位于位置 0，B 位于位置 1。您可以像这样将 B 添加到 A（假设指针从 A 开始）。我将 A 设置为 4，B 设置为 8，然后将 B 添加到 A：

```
setting A and B
++++>++++++++

remember the pointer is at B now so we can add B to A like this
[<+>-]
and now the pointer is still at B but B contains 0 and A contains 12 
```

如果您想让用户输入这些单个数字，请记住，当您使用 , 字符时，该字符的 ASCII 代码将放在当前单元格中。所以你首先需要从数字中减去 48（48 是字符 '0' 的 ASCII 码）。这是一个用键盘上的两个字符填充 A 和 B 的示例（我假设用户只按下任何数字键，而不是字母或符号）

```
Pointer starts at A so we have the user press a number key
,

we then subtract 48 from it so that it contains the actual value
------------------------------------------------

we move to B and do the same
>,------------------------------------------------

from here on it's the same as the last example
[<+>-] 
```

# node.js - node.js 检索 http csv 文件并加载到 mongoose

> ID：13629524
> 
> 赞同：4
> 
> 时间：2012-11-29T15:51:37.987
> 
> 标签：node.js, http, mongodb, mongoose

一般来说，我对编码很陌生，所以如果这个问题很明显，我提前道歉。这就是我想要做的事情，然后我将发布我到目前为止使用的代码。

我正在尝试从网站获取 gzip 的 csv 排名数据并将其存储到数据库中，用于我正在开发的氏族网站。一旦我弄清楚了，我需要每 5 分钟抓取一次数据。我已经能够完成抓取 csv 数据，尽管它将它存储到一个文本文件中，我需要将它存储到 mongodb 中。

这是我的代码：

```
var DB        =    require('../modules/db-settings.js');
var http      =    require('http');
var zlib      =    require('zlib');
var fs        =    require('fs');
var mongoose  =    require('mongoose');
var db          =   mongoose.createConnection(DB.host, DB.database, DB.port, {user: DB.user, pass: DB.password});

var request = http.get({ host: 'www.earthempires.com',
                     path: '/ranks_feed?apicode=myapicode',
                     port: 80,
                     headers: { 'accept-encoding': 'gzip' } });
request.on('response', function(response) {
  var output = fs.createWriteStream('./output');

  switch (response.headers['content-encoding']) {
    // or, just use zlib.createUnzip() to handle both cases
    case 'gzip':
      response.pipe(zlib.createGunzip()).pipe(output);
      break;
    default:
      response.pipe(output);
      break;
  }
});

db.on('error', console.error.bind(console, 'connection error:'));
db.once('open', function callback () {
  var rankSchema = new mongoose.Schema({
    serverid: Number,
    resetid: Number,
    rank: Number,
    countryNumber: Number,
    name: String,
    land: Number,
    networth: Number,
    tag: String,
    gov: String,
    gdi: Boolean,
    protection: Boolean,
    vacation: Boolean,
    alive: Boolean,
    deleted: Boolean
  })
}); 
```

这是 csv 的外观示例（文件的前 5 行）：

```
9,386,1,451,Super Kancheong Style,22586,318793803,LaF,D,1,0,0,1,0
9,386,2,119,Storm of Swords,25365,293053897,LaF,D,1,0,0,1,0
9,386,3,33,eug gave it to mak gangnam style,43501,212637806,LaF,H,1,0,0,1,0
9,386,4,128,Justpickupgirlsdotcom,22628,201606479,LaF,H,1,0,0,1,0
9,386,5,300,One and Done,22100,196130870,LaF,H,1,0,0,1,0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:30:42.597

希望现在提供帮助还为时不晚，但这是我要做的：

1.  请求 CSV 格式的数据并将其存储在内存或文件中。
2.  解析 CSV 数据以将每一行转换为一个对象。
3.  对于每个对象，用于`Model.create()`创建新条目。

首先，您需要从 Schema 创建一个模型：

```
var Rank = db.model('Rank', rankSchema); 
```

然后你可以解析你的 CSV 文本块（无论你是从文件中读取它还是在你的请求之后直接执行它。）我创建了自己的虚假`data`变量，因为我无权访问 api，但只要由于您的数据是 CSV 文本的换行符分隔块，因此应该可以：

```
/* Data is just a block of CSV formatted text. This can be read from a file                                                                                                  
   or retrieved right in the response. */                                                                                                                                    
var data = '' +                                                                                                                                                              
    '9,386,1,451,Super Kancheong Style,22586,318793803,LaF,D,1,0,0,1,0\n' +                                                                                                  
    '9,386,2,119,Storm of Swords,25365,293053897,LaF,D,1,0,0,1,0\n' +                                                                                                        
    '9,386,3,33,eug gave it to mak gangnam style,43501,212637806,LaF,H,1,0,0,1,0\n' +                                                                                        
    '9,386,4,128,Justpickupgirlsdotcom,22628,201606479,LaF,H,1,0,0,1,0\n' +                                                                                                  
    '9,386,5,300,One and Done,22100,196130870,LaF,H,1,0,0,1,0\n';                                                                                                            

data = data.split('\n');                                                                                                                                                     

data.forEach(function(line) {                                                                                                                                                
    line = line.split(',');   

    if (line.length != 14)
        return;                                                                                                                                               

    /* Create an object representation of our CSV data. */                                                                                                                   
    var new_rank = {                                                                                                                                                         
        serverid: line[0],                                                                                                                                                   
        resetid: line[1],                                                                                                                                                    
        rank: line[2],                                                                                                                                                       
        countryNumber: line[3],                                                                                                                                              
        name: line[4],                                                                                                                                                       
        land: line[5],                                                                                                                                                       
        networth: line[6],                                                                                                                                                   
        tag: line[7],                                                                                                                                                        
        gov: line[8],                                                                                                                                                        
        gdi: line[9],                                                                                                                                                        
        protection: line[10],                                                                                                                                                
        vacation: line[11],                                                                                                                                                  
        alive: line[12],                                                                                                                                                     
        deleted: line[13]                                                                                                                                                    
    };                                                                                                                                                                       

    /* Store the new entry in MongoDB. */                                                                                                                                    
    Rank.create(new_rank, function(err, rank) {                                                                                                                            
        console.log('Created new rank!', rank);                                                                                                                              
    });                                                                                                                                                                      
}); 
```

您可以将其放入脚本中，并使用 cron 作业每 5 分钟运行一次。在我的 Mac 上，我会用 编辑我的 cron 文件`crontab -e`，然后我会用这样的一行设置一个作业：

```
*/5 * * * * /path/to/node /path/to/script.js > /dev/null 
```

# html - 为什么当我将宽度添加到 CSS 列表中时，列表变为垂直而不是水平

> ID：13629527
> 
> 赞同：0
> 
> 时间：2012-11-29T15:51:41.677
> 
> 标签：html, css, xhtml

```
<html>
<head>
<style type="text/css">
 ul {list-style:none; margin:0; padding:0; }
  li{float: left; border:dotted; text-align: center; width: 100px;}

  </style>

</head>

<body>

     <ul>
       <li>home</li>
       <li id="up">pages

       <ul class="down">
       <li>a</li>
       <li>b</li>
       <li>c</li>                  
      </ul>

       </li>

     </ul>

</body>

</html> 
```

这是我的代码，在 css 中：`

```
li{float: left; border:dotted; text-align: center; }` 
```

当我没有放宽度属性时，元素a，b，c是水平的，但是为什么在我放宽度之后它变成了水平的？我以为宽度只设置了元素的宽度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:57:33.110

, `a`,列表项是列表项的子`b`项。您的 CSS 选择器将 100px 宽度应用于页面上的所有列表项，因此, ,列表项尊重其父项的宽度并落在新行上。`c``pages``li``a``b``c`

如果您只想给`a`, `b`,`c`项指定宽度，则使用不同的选择器排除父项，例如：

```
ul li ul li { width:100px; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T15:58:46.380

问题是，您`<ul>`没有足够的空间让`<li>`s 水平扩展。 `float: left`将尝试将所有`<li>`s 保持在同一“行”上，但如果没有空间，它们就会掉下来。尝试将其添加到`ul {}`样式中：

`width: 400px`

# c# - 从 C# 调用 C/C++ 代码

> ID：13629533
> 
> 赞同：1
> 
> 时间：2012-11-29T15:51:59.087
> 
> 标签：c#, c++, .net, visual-c++, c++-cli

我通常使用 C#，但很高兴通过 C++ 调用 C 方法。所以我写了一个这样的 C++ 包装器：

C++ 头文件如下所示：

```
#pragma once

using namespace System;

namespace CSharpToCPP {

    public ref class SomeWrapper
    {
        public:
        double ReturnValue();
    };
} 
```

C++ 代码如下所示：

```
double CSharpToCPP::SomeWrapper::ReturnValue()
{
    return 1;
} 
```

这给了我可以在 C# 中引用的 dll。C# 中的工作代码如下所示：

```
class Program
{
    static void Main(string[] args)
    {
        SomeWrapper Wrapper = new SomeWrapper();

        Console.WriteLine(Wrapper.ReturnValue());
    }
} 
```

现在我想在 C++ 方法 ReturnValue 中创建一些数据并使用此签名调用 C 方法：

```
real_T get_value(const e_struct_T parameters, real_T temp) 
```

有人可以这么好心并指出正确的方向来解释 const e_struct_T 是什么以及如何创建这样的数据吗？C 代码是自动生成的，应该采用具有已知内容的结构。我试图在头文件中定义一个结构，如下所示：

```
struct Parameters{
    double x;
    int y;
    char z1;
    bool z2;
}; 
```

然后用这样的数据填充它：

```
Parameters Ps;
Ps.x = z2;
Ps.x = 2.0; 
```

在像这样调用 get_value 之前：

```
get_value(Ps, 10.0); 
```

这不起作用。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:57:05.707

您必须搜索包含 的定义的头文件`e_struct_t`，包含在调用文件中，并使用该类型的变量传递给`get_value`; 顺便说一句，如果您要调用的目标方法`C#`是 pure `C`，您可能应该考虑更好地直接使用`P/Invoke`（[此处的教程](http://msdn.microsoft.com/en-us/library/aa288468%28VS.71%29.aspx)）而不是创建 C++ 包装器。此外，通过简单的 P/Invoke，您将大大简化部署（无需额外的 dll）

# java - 创建图形查询语言（节点/边缘/超边缘）

> ID：13629534
> 
> 赞同：2
> 
> 时间：2012-11-29T15:52:08.873
> 
> 标签：java, graph, visitor-pattern, edges

我正在创建一个 API，它使用额外的属性和助手来封装[JPA对象。](https://stackoverflow.com/tags/jpa/info)我不希望用户访问数据库，因为我必须为 API 的使用者提供某些查询功能。

我有以下内容：

```
Node1(w/ attributes) -- > Edge1(w/ attr.) -- > Node2(w/ attr.) 
```

和

```
Node1(w/ attributes) -- > |
Node2(w/ attributes) -- > |  -- > HyperEdge1(w/ attr.)
Node3(w/ attributes) -- > | 
```

![节点/边缘/超边缘示例](../Images/02d1b2b186df6896155089da7ac04934.png)

基本上 a`Node`可以是某个`type`，这将决定可用属性的种类。所以我需要能够根据不同的类型和属性来查询这些“路径”。

例如：从一个节点开始，找到一个路径`typeA > typeB & attr1 > typeC`。

所以我需要做一些简单的事情，并且能够将查询编写为字符串，或者可能是构建器模式样式。

到目前为止，我所拥有的是一个访问者模式，它设置为遍历节点/边缘/超边缘，这允许进行某种查询，但这并不是很简单，因为您必须为新类型的查询创建一个新的访问者。

到目前为止，这是我的实现：

```
 ConditionImpl hasMass = ConditionFactory.createHasMass( 2.5 );
    ConditionImpl noAttributes = ConditionFactory.createNoAttributes();

    List<ConditionImpl> conditions = new ArrayList<ConditionImpl>();
    conditions.add( hasMass );
    conditions.add( noAttributes );

    ConditionVisitor conditionVisitor = new ConditionVisitor( conditions );
    node.accept( conditionVisitor );

    List<Set<Node>> validPaths = conditionVisitor.getValidPaths(); 
```

上面的代码执行了一个查询，检查起始节点是否有质量`2.5`并且链接节点（子节点）没有属性。访问者执行 a`condition.check( Node )`并返回一个布尔值。

* * *

我从哪里开始为更简单的图创建查询语言？注意：我没有使用现有图形库的选项，我将拥有数十万个节点，加上边..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T20:41:47.183

就个人而言，我喜欢访问者模式的想法，但是访问所有节点可能会变得很昂贵。

**查询接口**：如果用户/其他开发人员正在使用它，我会使用构建器风格的接口，具有可读的方法名称：

```
 Visitor v = QueryBuilder
                  .selectNodes(ConditionFactory.hasMass(2.5))
                  .withChildren(ConditionFactory.noAttributes())
                  .buildVisitor();
    node.accept(v);
    List<Set<Node>> validPaths = v.getValidPaths(); 
```

正如上面所指出的，这或多或少只是你已经拥有的语法糖（但糖使一切变得不同）。我会将“在图上移动”的代码（例如“检查访问的节点是否满足条件”或“检查连接的节点是否满足条件”）与实际检查（或是）条件的代码分开。此外，在条件下使用复合材料来构建和/或：

```
 // Select nodes with mass 2.5, follow edges with both conditions fulfilled and check that the children on these edges have no attributes. 
    Visitor v = QueryBuilder
                  .selectNodes(ConditionFactory.hasMass(2.5))
                  .withEdges(ConditionFactory.and(ConditionFactory.freestyle("att1 > 12"), ConditionFactory.freestyle("att2 > 23")) 
                  .withChildren(ConditionFactory.noAttributes())
                  .buildVisitor(); 
```

（我现在使用“freestyle”是因为缺少创造力，但它的意图应该很清楚）节点通常这可能是两个不同的界面，以便不构建奇怪的查询。

```
 public interface QueryBuilder {
         QuerySelector selectNodes(Condition c);
         QuerySelector allNodes();
    }

    public interface QuerySelector {
         QuerySelector withEdges(Condition c);
         QuerySelector withChildren(Condition c);
         QuerySelector withHyperChildren(Condition c);
         // ...
         QuerySelector and(QuerySelector... selectors);
         QuerySelector or(QuerySelector... selectors);

         Visitor buildVisitor();
    } 
```

使用这种语法糖可以使查询从源代码中可读，而无需您实现自己的数据查询语言。然后，`QuerySelector`实现将负责在访问节点周围“移动”，而`Conditition`实现将检查条件是否匹配。

这种方法的明显缺点是，您需要预见接口中的大多数查询并且需要已经实现它们。

**节点数量的可扩展性**：您可能需要添加某种索引来加快查找“有趣”节点的速度。出现的一个想法是（为每个索引）向图中添加一个层，其中每个节点对“索引变量”的不同属性设置之一进行建模。然后，正常边可以将这些索引节点与原始图中的节点连接起来。然后索引上的超边缘可以构建一个更小的网络来搜索。当然，将索引存储在具有映射的类映射结构中仍然是一种无聊的方式`attributeValue -> node`。无论如何，这可能比上面的想法更有效。

如果您有某种索引，请确保索引也可以接收访问者，这样它就不必访问图中的所有节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T20:10:15.593

听起来除了一些语法糖之外，您拥有所有的部分。

创建上面的整个列表的不可变样式怎么样

```
Visitor v = Visitor.empty
    .hasMass(2.5)
    .edge()
    .node()
    .hasNoAttributes(); 
```

您可以使用这种风格创建任何类型的线性查询模式；如果您添加一些额外的状态，您甚至可以通过例如 setName("A") 和稍后的 .node("A") 进行分支查询以返回查询的该点。

# javascript - 在 CKEditor 中添加语言列表

> ID：13629535
> 
> 赞同：1
> 
> 时间：2012-11-29T15:52:10.723
> 
> 标签：javascript, ckeditor

我正在尝试在 CKEditor 的工具栏中添加语言列表。这样可以动态更改语言。但是工具栏中没有出现语言列表。请任何人帮助我找出问题。谢谢。

```
CKEDITOR.editorConfig = function( config ) {
    // config.language = 'fr';
    config.extraPlugins = 'language';
    CKEDITOR.config.toolbar = [
         [ 'language','Bold']
    ];
}; 
```

`/source/plugins/language/`还要在目录代码中写plugin.js ：

```
CKEDITOR.plugins.add( 'language', {
    requires: [ 'selection' ],
    init: function( editor ) {
       var pluginName = 'language';
       CKEDITOR.dialog.add( pluginName, this.path + 'dialogs/language.js' );
       editor.addCommand( pluginName, new CKEDITOR.dialogCommand( pluginName ) );
       editor.ui.addButton( 'language', {
           label: 'language',
           command: pluginName
       }
}); 
```

但不工作。请任何人帮助..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:48:20.757

您附加的代码有很多语法错误。你检查过控制台吗？

这是它的固定版本：

```
CKEDITOR.plugins.add( 'language', {
    requires: 'selection',
    init: function( editor ) {
       var pluginName = 'language';
       CKEDITOR.dialog.add( pluginName, this.path + 'dialogs/language.js' );
       editor.addCommand( pluginName, new CKEDITOR.dialogCommand( pluginName ) );
       editor.ui.addButton( 'Language', {
           label: 'language',
           command: pluginName
       });
    }
}); 
```

第二个问题 - 插件应该放在`_source/plugins/language/`目录中。

最后，问题-您正在尝试创建更改语言的插件是什么？编辑还是内容？请注意，第一个是不可能的。必须重新加载（销毁并再次初始化）编辑器才能更改 UI 语言。

# haskell - 一种在类型类中声明常量值的方法

> ID：13629538
> 
> 赞同：16
> 
> 时间：2012-11-29T15:52:32.207
> 
> 标签：haskell, typeclass

我想声明一个类型类，它具有一些实现的函数，这些函数利用未实现的常量值（`table`）：

```
class FromRow a => StdQueries a where
  table :: String
  byId :: Int -> QueryM (Maybe a)
  byId = fmap listToMaybe . queryM sql . Only
    where sql = read $ "SELECT * FROM " ++ table ++ " WHERE id = ?" 
```

这个想法很简单：我想`byId`通过仅指定以下来实例化这个类型类来获得（和其他类似的功能）`table`：

```
instance StdQueries SomeType where
  table = "the_constant_value_for_this_type" 
```

但是编译器一直抱怨以下消息：

```
The class method `table'
mentions none of the type variables of the class StdQueries a
When checking the class method: table :: String
In the class declaration for `StdQueries' 
```

有没有解决这类问题的方法？`newtype`可以借助帮助或类似的东西来欺骗吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-29T16:35:28.933

你能做的最简单的事情是

```
class FromRow a => StdQueries a where
    byId :: Int -> QueryM (Maybe a)

defaultById :: FromRow a => String -> Int -> QueryM (Maybe a)
defaultById table = fmap listToMaybe . queryM sql . Only
    where sql = read $ "SELECT * FROM " ++ table ++ " WHERE id = ?"

instance StdQueries SomeType where
    byId = defaultById "the_constant_value_for_this_type" 
```

这很简单，但如果您有多个函数需要访问该`table`值，则必须多次指定该值。

您可以避免这种情况，并且 sabauma 需要`undefined`这样`{-# LANGUAGE ScopedTypeVariables #-}`：

```
newtype Table a = Table String

class FromRow a => StdQueries a where
    table :: Table a
    byId :: Int -> QueryM (Maybe a)
    byId = defaultById table

defaultById :: StdQueries a => Table a -> Int -> QueryM (Maybe a)
defaultById (Table table) = fmap listToMaybe . queryM sql . Only
    where sql = read $ "SELECT * FROM " ++ table ++ " WHERE id = ?"

instance StdQueries SomeType where
    table = Table "the_constant_value_for_this_type" 
```

这里的神奇之处在于 的类型签名`defaultById`，它强制`byId`提供`table`来自同一实例的 。如果我们提供`defaultById :: (StdQueries a, StdQueries b) => Table a -> Int -> QueryM (Maybe b)`then`defaultById`仍然会编译，但我们仍然会收到与您问题中的错误消息类似的错误消息：编译器将不再知道`table`要使用哪个定义。

如果需要，您可以通过创建`Table a`结构`data`而不是`newtype`包装器来扩展它以指定常量中的许多字段。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T16:03:39.493

问题是 的定义`table`没有提到类的任何类型变量，所以没有办法确定`table`使用哪个版本。一个（诚然骇人听闻的）解决方案可能类似于：

```
{-# LANGUAGE ScopedTypeVariables #-}
class FromRow a => StdQueries a where
  table :: a -> String
  byId :: Int -> QueryM (Maybe a)
  byId = fmap listToMaybe . queryM sql . Only
    where sql = read $ "SELECT * FROM " ++ table (undefined :: a) ++ " WHERE id = ?"

instance StdQueries SomeType where
    table = const "the_constant_value_for_this_type" 
```

然后您可以通过

```
table (undefined :: SomeType) == "the_constant_value_for_this_type" 
```

并不是说我真的建议这样做。

# api - 从 Yahoo! 获取 img 缩略图 屏幕视频播放器（不是较旧的网络播放器）

> ID：13629547
> 
> 赞同：3
> 
> 时间：2012-11-29T15:52:58.913
> 
> 标签：api, video, thumbnails, yahoo, yahoo-api

我试图让雅虎！将屏幕视频的图像缩略图嵌入到我的网站中，就像我们可以在其他网站中轻松执行的操作一样（[从 Vimeo 获取 img 缩略图？](https://stackoverflow.com/questions/1361149/get-img-thumbnails-from-vimeo)，[如何从​​ YouTube API 获取 YouTube 视频缩略图？](https://stackoverflow.com/questions/2068344/how-to-get-thumbnail-of-youtube-video-link-using-youtube-api)等）。

曾经有一个建议：[Get thumbnail image for Yahoo video? (python)](https://stackoverflow.com/questions/3262532/get-thumbnail-image-for-yahoo-video-python)但它现在似乎不适用于新的 Yahoo! 屏幕。

在 Internet 上进行的一些快速搜索使我找到了 Y! 自己的在线帮助：[http ://help.yahoo.com/l/in/yahoo/video/using/using005.html;_ylt=Aj3rNfbhKBNyXODHGK5ONSo1qXtG](http://help.yahoo.com/l/in/yahoo/video/using/using005.html;_ylt=Aj3rNfbhKBNyXODHGK5ONSo1qXtG)

据此，我所要做的就是*复制“共享”选项卡下的缩略图代码*。*不幸的是，我似乎在Share tab*下找不到任何*缩略图代码*。

 *[我在http://developer.yahoo.com/everything.html](http://developer.yahoo.com/everything.html)上也找不到任何 Y!Screen api可以帮助我解决这个...想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-08T10:44:02.853

使用**[YQL](http://developer.yahoo.com/yql/)****和jQuery**进行跨域数据抓取是可行的解决方案。

有些是合理的，有些是hackish，但这就是我认为的刮擦。

这种方法的基础不是由我完成的，而是通过使用 由 Jocelyn Stretton 编写的题为“**[使用 jQuery 和 YQL 创建 Facebook 样式的链接预览”的 Facebook 教程完成的。](http://ninjagirl.com/posts/2012/02/create-facebook-style-link-preview-using-jquery-yql)**

包含在作为起点的修改后的 JavaScript 中，您将可以访问并了解如何检索以下内容：

**1.**雅虎！屏幕视频网页标题
**2.** Yahoo! 屏幕缩略图 URL 链接
**3.** Yahoo! 屏幕视频 URL 链接
**4.**抓取其他`meta`标签内容
**5.**雅虎屏幕播放器本身提供的雅虎屏幕视频嵌入代码。

[**jsFiddle 中的演示！**](http://jsfiddle.net/wzRrU/)

***编辑：jsFiddle DEMO 不再依赖于视频示例的子域（区域）。***

**编辑 2：**对于那些希望看到基于此`.ajax() YQL`过程的另一个教程的人，我为 Pinterest 数据抓取制作了两个 jsFiddles。[**您可以在此处**](https://stackoverflow.com/a/13814799/1195891)看到 SO Answer详细讨论了 XPATH。*

# java - Karaf 中的 XML 解析器类加载问题

> ID：13629549
> 
> 赞同：2
> 
> 时间：2012-11-29T15:53:02.403
> 
> 标签：java, osgi, classloader, apache-karaf

我有一个执行一些 LDAP 操作的 OSGi 包。它使用 Apache 共享目录来执行这些操作。我正在使用 Maven Bundle Plugin 来构建我的包。由于时间和资源不足，我不得不在生成的包中使用 pom.xml，其中包括 Apache 共享目录和它所依赖的其他 jar。依赖项之一是 Xerces，然后是 Xml api。当我将这两个 jar 包包含在包中时，Karaf 会抛出 ClassCastException：

```
java.lang.ClassCastException: org.apache.xerces.jaxp.DocumentBuilderFactoryImpl cannot be cast to javax.xml.parsers.DocumentBuilderFactory 
```

进一步调查显示，该类`javax.xml.parsers.DocumentBuilderFactory`是从两个 jar 中加载的——`Xml-apis.jar`我包含在我的包和 JRE 中`rt.jar`，这导致`ClassCastException`. 由于这个类是从 加载的`rt.jar`，我想我不需要包含`Xml-apis.jar`在我的包中并删除它。但是，现在我看到了`ClassNotFoundException`：

```
Caused by: java.lang.ClassNotFoundException: javax.xml.parsers.DocumentBuilderFactory not found by mybundle.ldap [149]
at org.apache.felix.framework.ModuleImpl.findClassOrResourceByDelegation(ModuleImpl.java:812)[org.apache.felix.framework-3.2.2.jar:]
at org.apache.felix.framework.ModuleImpl.access$400(ModuleImpl.java:72)[org.apache.felix.framework-3.2.2.jar:]
at org.apache.felix.framework.ModuleImpl$ModuleClassLoader.loadClass(ModuleImpl.java:1807)[org.apache.felix.framework-3.2.2.jar:]
at java.lang.ClassLoader.loadClass(ClassLoader.java:247)[:1.6.0_35] 
```

所以，如果我包括`xml-apis.jar`，我得到`ClassCastException`. 如果我不包括它，我会得到`ClassNotFoundException`. 有没有办法解决这个问题？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T08:27:16.743

导入包`javax.xml.parsers`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-17T05:59:58.007

问题解决了！！（至少对我来说）

您可以在此链接中找到对问题的很好解释： [Dealing with "Xerces hell" in Java/Maven?](https://stackoverflow.com/questions/11677572/dealing-with-xerces-hell-in-java-maven)

如您所见，实际上，这是 Xerces 兼容性的问题。也许您不使用 Xerces，但可能您正在使用使用 Xerces 的库。

我的解决方案是使用旧版本的 xerces (lucene-xercesImpl) 并排除对 xml-apis o xerces 的任何引用：

```
<properties>
   <ver.jena>2.10.1</ver.jena>
   <ver.jena-sdb>1.3.6</ver.jena-sdb>
   <ver.h2>1.3.173</ver.h2>
</properties>
<dependencies>
   <dependency>
      <groupId>org.apache.jena</groupId>
      <artifactId>jena-sdb</artifactId>
      <version>${ver.jena-sdb}</version>
      <exclusions>
         <exclusion>
            <groupId>xml-apis</groupId>
            <artifactId>xml-apis</artifactId>
         </exclusion>
         <exclusion>
            <groupId>xerces</groupId>
            <artifactId>xercesImpl</artifactId>
         </exclusion>
      </exclusions>
   </dependency>
   <dependency>
      <groupId>org.apache.lucene</groupId>
      <artifactId>lucene-xercesImpl</artifactId>
      <version>3.5.0</version>
   </dependency>
   <dependency>
      <groupId>org.apache.jena</groupId>
      <artifactId>apache-jena-libs</artifactId>
      <type>pom</type>
      <version>${ver.jena}</version>
      <exclusions>
         <exclusion>
            <artifactId>commons-codec</artifactId>
            <groupId>commons-codec</groupId>
         </exclusion>
         <exclusion>
            <groupId>org.apache.jena</groupId>
            <artifactId>jena-tdb</artifactId>
         </exclusion>
     </exclusions>
   </dependency> 
```

希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T16:36:56.583

你试过注释掉这条线吗

> javax.xml.parsers，\

在 etc/jre.properties 文件中？这应该防止从 rt.jar 加载类。

# c++ - 来自 Josuttis：在给定特定类型的情况下，实例化为相同函数签名的不同模板函数是否会导致 ODR 无效？

> ID：13629552
> 
> 赞同：13
> 
> 时间：2012-11-29T15:53:13.807
> 
> 标签：c++, templates

在 Josuttis 和 Vandevoorde 关于模板的著名书籍[C++ Templates: The Complete Guide](http://amzn.com/0201734842)中，他们讨论了有关函数模板重载的细节。

在他们的一个示例中，与函数签名和重载函数模板的讨论相关，他们提供了用以下术语描述的代码：

```
This program is valid and produces the following output:

(Note: Output shown below) 
```

但是，当我在 Visual Studio 2010 中构建和编译相同的代码时，我得到了不同的结果。这使我相信 VS 2010 编译器生成了不正确的代码，或者 Josuttis 不正确地认为代码是有效的。

这是代码。（Josuttis 2003，第 12.2.1 节）

```
// File1.cpp

#include <iostream>

template<typename T1, typename T2>
void f1(T2, T1)
{
    std::cout << "f1(T2, T1)" << std::endl;
}

extern void g();

int main()
{
    f1<char, char>('a', 'b');
    g();
} 
```

...

```
// File2.cpp

#include <iostream>

template<typename T1, typename T2>
void f1(T1, T2)
{
    std::cout << "f1(T1, T2)" << std::endl;
}

void g()
{
    f1<char, char>('a', 'b');
} 
```

（请注意两个模板函数定义中类型参数的反转。另请注意，当两个类型参数相同时，这种反转无效，因为它们适用`f1()`于此代码示例中的两个函数。）

根据 Josuttis 的说法：

```
This program is valid and produces the following output:

f1(T2, T1)
f1(T1, T2) 
```

当我在 Visual Studio 2010 编译器中构建并运行相同的代码并保持不变时，结果如下：

```
f1(T1, T2)
f1(T1, T2) 
```

此外，我想知道编译器/链接器如何区分`f1`在 file1.cpp 中实例化的函数和在 file2.cpp`f1`中实例化的函数，因为（我认为）编译器剥离了所有“知识”事实上，这些函数是从模板创建的，并且只有函数签名本身的信息（我认为）：`void (char, char)`，这对于两个`f1`函数都是相同的。

由于（如果我是正确的）函数签名在两个翻译单元中是相同的，我认为这是违反[单一定义规则](http://en.wikipedia.org/wiki/One_definition_rule)(ODR) 的一个示例，因此它将是无效的 C++。

然而，正如我刚刚指出的，Josuttis 和 Vandevoorde 声称这是*有效*的C++。

但是由于我的相同代码的编译版本给出的*结果*与 Josuttis 声称的输出不同，这似乎表明 VS 2010 产生了不正确的代码，或者 Josuttis 在这种情况下不正确（即代码无效并且违反ODR）。

Josuttis 和 Vandevoorde 是不正确的，还是 VS 2010 产生的输出不正确？还是有其他解释可以解释 VS 2010 产生的输出与 Josuttis 报告的输出之间的差异？

在调用每个函数时显示 VS 2010 的反汇编可能会很有趣`f1()`。

`f1()`（直接在 内`main()`）的第一次调用：

![f1() 直接从 main() 中调用](../Images/30dd58a20c10c48c3eca7de6bf5136b6.png)

`f1()`（来自内部`g()`）的第二次调用：

![f1() 从 g() 中调用](../Images/354c98848865fcf7d58ae2fabb61df59.png)

请注意，`f1()`编译器在两种情况下选择的地址是相同的 - 13E11EAh。对我来说，这表明实际上编译器无法区分两个实例化的函数签名，这是违反 ODR 的情况，因此代码是*无效的 C++*并且 Josuttis 在他的书中有错误。但这只是 - 一个迹象。我不知道。

（我在书的网站上查过勘误表，没有提到这个例子。）

**附录**根据评论的请求，我附上了来自该程序的 .map 文件的相关输出，该输出显示了用于`f1`：

![.map 文件输出显示 <code>f1</code> 的错位名称](../Images/f871cbba4a86ca0ed608865c652586a8.png)

**附录 2**现在问题已得到解答 - Josuttis 的书是正确的 - 我想指出，在 Josuttis 文本的同一部分 (12.2.1) 中，明确概述了确定唯一函数签名的确切因素，*包括模板方面*。

从文本（以及其他定义函数签名的预期内容）来看，翻译单元是函数签名的一部分；对于模板函数（仅），返回类型是函数签名的一部分，并且

> .6\. 模板参数和模板参数，如果函数是从函数模板生成的。

因此 - 很明显。即使在函数模板被实例化之后，编译器也必须维护和跟踪模板信息，以便编译器/链接器遵守模板的必要特殊规则（如我问题中的代码示例）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T16:32:26.837

为较早的错误答案道歉。该示例确实似乎是正确的，并且标准本身（C++11、14.5.6.1/1-2）中实际上也有一个类似的示例。让我完整地引用它：

> 1.  可以重载函数模板，以便两个不同的函数模板特化具有相同的类型。[*示例：*
>     
>     
>     
>     ```
>     // file1.c
>     
>     template<class T> void f(T*);
>     
>     void g(int* p) {
>         f(p); // calls f<int>(int*)
>     }
>     
>     
>     // file2.c
>     
>     template<class T> void f(T);
>     
>     void h(int* p) {
>         f(p); // calls f<int*>(int*)
>     } 
>     ```
>     
>     
>     
>     —*结束示例*]
>     
>     
> 2.  这样的专业化是不同的功能，并且不违反单一定义规则（3.2）。

在您的情况下，您有两个不同的函数模板，都被调用`f1`（这很好，因为您可以重载函数模板），并且它们恰好具有具有相同类型的特化。

# php - 如何让 MediaWiki 忽略来自 Recommind 的页面浏览量？

> ID：13629553
> 
> 赞同：2
> 
> 时间：2012-11-29T15:53:15.310
> 
> 标签：php, web-crawler, mediawiki

是否可以让 MediaWiki 忽略企​​业搜索工具[Recommind](http://www.recommind.com/products/axcelerate-ediscovery)的页面浏览量？我们希望防止 Recommind 完全掩盖我们的人工页面浏览量。

[我已经看到Google Search Appliance](https://stackoverflow.com/questions/2096170/how-can-i-get-mediawiki-to-ignore-page-views-from-a-google-search-appliance)可以这样做。

感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T17:52:09.377

用户代理字符串在 Recommind 爬虫中是可配置的并且是任意的。您可以调整 Google Search Appliance 示例中的代码以忽略配置的用户代理字符串。

# algorithm - QR 编码器/解码器中的 GS1 支持？

> ID：13629555
> 
> 赞同：5
> 
> 时间：2012-11-29T15:53:17.570
> 
> 标签：algorithm, barcode, qr-code

很少有 QR 编码器/解码器（显式）支持所谓的 GS1 编码。[Zint](http://sourceforge.net/projects/zint/ "Zint 条码生成器")是例外之一（在 QR 下选择 GS-1 数据模式），但它的许可证阻止我使用它。主要来自 Tec-It 的商业报价非常昂贵，特别是因为我对他们支持的所有其他类型的条形码不感兴趣。

**有没有办法在不更改其源的情况下将 GS1 支持添加到任何 QR 编码器/解码器？**例如，我可以应用一些算法将文本 GTIN AI 数据转换为兼容的二进制文件吗？我觉得应该是可以的，因为毕竟还是二维码。请注意，我不是数据编码专家——我只是在寻找一种方法来处理这个标准，而不用花一大笔钱。到目前为止，我发现确实支持它的[postscriptbarcode](https://code.google.com/p/postscriptbarcode/ "postscriptbarcode - 纯 PostScript 中的条码编写器")，并且似乎使用它自己的 QR 引擎，但输出质量一般，而且我的 PostScript 技能太有限，无法弄清楚算法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T20:00:02.767

只要库支持 FNC1 特殊字符的解码，就可以用来读取 GS1 码。FNC1 字符不是数据流中的一个字节，而更像是一个格式化符号。

规范说，前导 FNC1 字符用于识别 GS1 条码，应解码为`"]d2"`(GS1 DataMatrix)、`"]C1"`(GS1-128)、`"]e0"`(GS1 DataBar Omnidirectional) 或`"]Q3"`(GS1 QR Code)。任何其他 FNC1 字符都应解码为 ASCII GS 字符（字节值 29）。

根据库，前导 FNC1 可能丢失，或解码为`GS`（非关键），或者嵌入的 FNC1 字符可能丢失（关键）。嵌入的 FNC1 字符用于分隔可变长度字段。

您可以在[此处](http://www.gs1.se/Global/Om-GS1-Systemet/GS1-General-Specifications.pdf)阅读完整的规范(pdf)。解码数据的算法可在标题**7.9 使用 GS1 应用标识符处理来自 GS1 符号系统的数据**（第 426 页）下找到。

算法是这样的：

```
Peek at the first character.
If it is ']',
    If string does not start with ']C1' or ']e0' or ']d2' or ']Q3',
        Not a GS1 barcode.
        Stop.
    Consume the caracters.
Else if it is <GS>,
    Consume character.
Else,
    No symbology identifier, assume GS1.
While not end of input,
    Read the first two digits.
    If they are in the table of valid codes,
        Look up the length of the AI-code.
        Read the rest of the code.
        Look up the length of the field.
        If it is variable-length,
            Read until the next <FNC1> or <GS>.
        Else,
            Read the rest if the field.
        Peek at the next character.
        If it is <FNC1> or <GS>, consume it.
        Save the read field.
    Else,
        Error: Invalid AI 
```

* * *

QR 码中的二进制数据被编码为 4 位令牌，并带有嵌入数据。

```
0111 -> Start Extended Channel Interpretation (ECI) Mode (special encodings).
0001, 0010, 0100, 1000 -> start numeric, alphanumeric, raw 8-bit, kanji encoded data.
0011 -> structured append (combine two or more QR Codes to one data-stream).
0101 -> FNC1 initial position.
1001 -> FNC1 other positions.
0000 -> End of stream (can be omitted if not enough space). 
```

在编码规范之后是数据长度，然后是实际数据。数据位的含义取决于所使用的编码。在数据块之间，您可以压缩 FNC1 字符。

不幸的是，二维码规范 ( [ISO/IEC 18004](http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=43655) ) 需要花钱 (210 法郎)。不过，您可能会在网上找到一些盗版版本。

要创建 GS1 二维码，您需要能够在数据中指定 FNC1 字符。该库应该识别“]Q3”前缀和 GS 字符，或者允许您通过其他方法编写 FNC1 令牌。

如果你有办法编写 FNC1 字符，你可以对 GS1 数据进行如下编码：

```
Write initial FNC1.
For each field,
    Write the AI-code as decimal digits.
    Write field data.
    If the code is a variable-length field,
        If not the last field,
            Write FNC1 to terminate the field. 
```

如果可能，您应该对字段进行排序，使可变长度字段排在最后。

* * *

正如特里伯顿在评论中指出的那样；GS1 QR 码中的 FNC1 符号可以编码为`%`字母数字数据，也可以编码为 GS 字节模式。要编码一个实际的百分号，你可以把它写成`%%`.

要进行编码`(01) 04912345123459 (15) 970331 (30) 128 (10) ABC123`，首先将其组合到数据字符串中`01049123451234591597033130128%10ABC123`（`%`指示符是编码的 FNC1 符号）。然后这个字符串写成

```
0101 - Initial FNC1, GS1 mode indicator
0001 - QR numeric mode
0000011101 - Data length (29)
<data bits for "01049123451234591597033130128">
0010 - QR alphanumeric mode
000001001 - Data length (9)
<data bits for "%10ABC123"> 
```

（来自 ISO 18004:2006 规范的示例）

# c# - 从一个 c# 生成多个图像

> ID：13629556
> 
> 赞同：0
> 
> 时间：2012-11-29T15:53:17.307
> 
> 标签：c#, image

我正在用 C# 制作一个基于《洛克人》的横向卷轴游戏。我没有使用 XNA 框架来这样做。我正在考虑使用我的游戏类中的一个图像从一个位置创建多个“子弹”。在这一点上我唯一能想到的就是类似的东西：

```
if (shooting == true)
{
    BulletLocation.X += 3.0F;

    Bullet = Properties.Resources.Bullet;
    Charecter = Properties.Resources.shooting;
} 
```

射击在 keyDown 事件上设置为 true，在 keyUp 事件上设置为 false。我很肯定我需要各种各样的数组，但我不确定我应该如何去做。谢谢你的帮助！

编辑：该代码的哪一部分实际上允许您从一个精灵单个精灵生成多个“子弹”？当用户按下空格键时，我想创建一个向前移动直到到达屏幕末尾的子弹。我可以轻松地完成那部分。但是，我不能用多个子弹来做到这一点。我一次只能有一颗子弹活着。我不确定如何从一张图片在论坛上创建多个项目符号。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-29T16:02:34.050

如果我理解正确，您想显示多个项目符号，对吗？我会为# of bullets 和 bulletposition 创建一个变量。

所以让我们说：

```
const DISTBETWEENBULLETS = 3.0;

int distToOpponent = 9.0:
int curBulletDist = 0;
do{
     curBulletDist += DISTBETWEENBULLETS;
     //Draw bullet
}while(distToOpponent <= curBulletDist); 
```

我希望这会有所帮助，如果它不能回答您的问题，或者您的意思是别的，请随时提问。

# sql - 用于 ODBC 驱动程序的 Microsoft OLE DB 提供程序错误“80040e07”

> ID：13629558
> 
> 赞同：1
> 
> 时间：2012-11-29T15:53:24.070
> 
> 标签：sql, asp-classic

好吧，这可能会非常明显，但是在查看相同的代码块 3 天后，我开始对它失去理智。

下面2个代码块。第一个像魅力一样工作，但第二个虽然我认为它的编码正确，但一直给我带来问题。

```
SQL = "EXECUTE sp_AddEvent '" &_
chrEventName & "','" &_
chrEventManager & "','" &_
chrEventAssistant & "','" &_
txtEventDescr & "','" &_
intEventTypeID & "'," &_
intEventCatagoryID & "," &_
intIncomeModelID & "," &_
intEventStatusID & ",'" &_
dtEventStart & "','" &_
dtEventEnd & "','" &_
intMultiArea & "'," &_
intMultiLokation & "," &_
intMultiDay & ",'" &_
dtEventAdded & "','" &_
dtEventChanged & "','" &_
intEventLastChangedBy & "'"

'   Executing Insert statement.
SET rsAddEvent = someconnection.EXECUTE(SQL) 
```

现在是第二块让我现在完全发疯了。

```
SQL = "EXECUTE sp_AddLokation '" &_
chrLokationName & "','" &_
chrLokationStreet & "','" &_
chrLokationCity & "','" &_
chrLokationCountry & "','" &_
chrLokationSNumber & "','" &_
chrLocationZipcode & "','" &_
chrLokationPhone & "','" &_
chrLokationFax & "','" &_
chrLokationEmail & "','" &_
chrLokationWebsite & "','" &_
intLokationTypeID & "'," &_
intMultiArea & "," &_
intLokationStatusID & ",'" &_
dtLokationAdded & "','" &_
dtLokationChanged & "','" &_
intLastChangedBy & "'"

'   Executing Insert statement.
SET rsAddLokation = someconnection.EXECUTE(SQL) 
```

被调用来插入数据的存储过程工作正常，所以它必须是 ASP 级别的东西。

在我开始咀嚼键盘之前，有人对这种怪异有什么建议吗？

另外：我要么得到一个 varchar 到 int 的转换错误，要么在 dtlokationAdded 之前的最后 3 个 int 字段之一中摆弄 ' 时我得到一个语法错误附近（取决于通过摆弄受影响的字段）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T06:46:40.660

假设所有以数字开头的字段`int`都是数字（除了`intLastChangedBy`，在前一个块中用引号括起来；如果是，也删除该引号）：

```
SQL = "EXECUTE sp_AddLokation '" &_
chrLokationName & "','" &_
chrLokationStreet & "','" &_
chrLokationCity & "','" &_
chrLokationCountry & "','" &_
chrLokationSNumber & "','" &_
chrLocationZipcode & "','" &_
chrLokationPhone & "','" &_
chrLokationFax & "','" &_
chrLokationEmail & "','" &_
chrLokationWebsite & "'," &_
intLokationTypeID & "," &_
intMultiArea & "," &_
intLokationStatusID & ",'" &_
dtLokationAdded & "','" &_
dtLokationChanged & "','" &_
intLastChangedBy & "'" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T10:41:03.773

Ok, thanks all for trying to help me out here!

It seems my issue is resolved. It must be code-midgets who payed me a visit last night. Other than that i can't explain what just happened. Cause when i left the project yesterday it sure as hell wasn't working at all.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T19:57:06.770

```
intLokationTypeID & "'," &_ 
```

好吧，我注意到这里有一组引号，但只有一个撇号……这可能会导致错误？或者，等等，我想我知道你把它关在哪里了。（几行下来，对不起！）

# c# - 如何在 C# 中实现嵌套 [] 运算符？

> ID：13629565
> 
> 赞同：4
> 
> 时间：2012-11-29T15:53:47.260
> 
> 标签：c#, oop

考虑一类嵌套数组，每个元素可以是数组或数字：

```
[[1, 2, [3, 4, [5]], [6, 7]], 8] 
```

这是我为它实现 [] 运算符的尝试。

```
class MyArray {

    List<MyArray> elements;
    int value;

    public object this[int index] {
        get {
            if (elements.Count > 0) {
                return elements;
            } else {
                return value;
            }
        }
    }

} 
```

所以，我们的目标是像下面这样使用它：

```
MyArray arr = new MyArray();

... do something with the array here ...

int num = arr[3][5][1]; 
```

如果访问“分支”，而不是“叶子”（例如，arr[3][5][1] 有多个元素），让我们只返回 0、无穷大或任何适合我们的整数。

但是，显然，这种嵌套运算符不适用于我的情况，因为运算符的结果是一个对象，而不是 MyArray 实例。

现在，我看到了唯一的解决方案：将转换运算符定义为 int 并使 [] 运算符始终只返回一个元素（如果我们在这里没有遇到异常，它将是 MyArray）。但是有没有别的办法？也许，使用类似 IList 接口的东西会有所帮助吗？或者也许有一种方法可以以某种方式为一个方法定义多种可能的返回类型？（但到目前为止，我用谷歌搜索这是不可能的，并且 C# 中没有 Either 类型）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T15:55:53.573

您的运营商应该返回`MyArray`. 此外，您应该实现`MyArray`to的隐式转换运算符`int`：

```
class MyArray {

    List<MyArray> elements;
    int value;

    public MyArray this[int index] {
        get {
            return elements[index];
        }
    }
    public static implicit operator int(MyArray d) {
        return d.value;
    }
} 
```

问题是 的结构`MyArray`不是同质的：编译器无法知道它将从`[]`运算符中得到什么，但您必须指定确切的类型。

一种替代方法是`dynamic`在返回中使用，但它的使用会带来显着的性能损失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:21:37.927

您所代表的是一种逻辑“树”类型的数据结构，您只想使用索引器来访问元素（这很好，如果您倾向于在编译时知道树的结构）。

通常对于基于树的数据结构，复合模式是适用的。您有一个定义节点的接口，然后是实现它的两种类型的类；一个用于叶子，一个用于父节点。然后节点接口有一些（或集合）其他节点（可以是实现，或者如果它是叶节点，它可以是空集合）。

这是一个不使用接口的更简单的实现；它不是那么健壮（它更多地依赖于约定来告诉你发生了什么），但概念是一样的：

```
public class Node
{
    private List<Node> children = new List<Node>();

    /// <summary>
    /// This will have a non-null value if it's a leaf.  It will be null if it's not a leaf.
    /// </summary>
    public int? Value { get; set; } 

    public Node this[int index]
    {
        get
        {
            if (children.Count == 0)
            {
                throw new ArgumentException("This node has no children");
            }
            if (children.Count > index)
            {
                throw new ArgumentException("This node doesn't have that many children");
            }

            return children[index];
        }
    }
} 
```

# java - 需要从闪屏重定向到网页

> ID：13629567
> 
> 赞同：0
> 
> 时间：2012-11-29T15:53:53.790
> 
> 标签：java, splash-screen

我需要从我的初始屏幕重定向到网页我该怎么做请用代码建议我。我的启动画面代码是：

```
import java.awt.*;
import javax.swing.*;

public class SplashScreen extends JWindow {

    private int duration;

    public SplashScreen(int d) {
        duration = d;
    }

    // A simple little method to show a title screen in the center
    // of the screen for the amount of time given in the constructor
    public void showSplash() {

        JPanel content = (JPanel)getContentPane();
        content.setBackground(Color.white);

        // Set the window's bounds, centering the window
        int width = 450;
        int height =115;
        Dimension screen = Toolkit.getDefaultToolkit().getScreenSize();
        int x = (screen.width-width)/2;
        int y = (screen.height-height)/2;
        setBounds(x,y,width,height);

        // Build the splash screen
        JLabel label = new JLabel(new ImageIcon("java-tip.gif"));
        JLabel copyrt = new JLabel
                ("Welcome to the Application", JLabel.CENTER);
        copyrt.setFont(new Font("Sans-Serif", Font.BOLD, 12));
        content.add(label, BorderLayout.CENTER);
        content.add(copyrt, BorderLayout.SOUTH);
        Color oraRed = new Color(156, 20, 20,  255);
        content.setBorder(BorderFactory.createLineBorder(oraRed, 10));

        // Display it
        setVisible(true);

        // Wait a little while, maybe while loading resources
        try { Thread.sleep(duration); } catch (Exception e) {}

        setVisible(false);

    }

    public void showSplashAndExit() {

        showSplash();
        System.exit(0);

    }

    public static void main(String[] args) {

        // Throw a nice little title page up on the screen first
        SplashScreen splash = new SplashScreen(50000);

        // Normally, we'd call splash.showSplash() and get on 
        // with the program. But, since this is only a test...
        splash.showSplashAndExit();

    }
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:03:18.933

**在showSplash()**之后编写代码；叫

```
 java.awt.Desktop desktop = java.awt.Desktop.getDesktop();
 desktop.browse(new URI("www.yoursite.com")); 
```

这将使用您的网站打开您的默认浏览器。

# android - 如何克隆一个 TextView？

> ID：13629568
> 
> 赞同：2
> 
> 时间：2012-11-29T15:53:54.180
> 
> 标签：android

假设我有一个从 xml 获得的文本视图。

```
final View popupView = getLayoutInflater().inflate(R.layout.popup, null);  

final TextView tvPop = (TextView)popupView.findViewById(R.id.tvKeyPop); 
```

但我想拥有多个**tvPop**，我应该如何克隆它们？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:01:02.137

你可以这样做：

```
TextView cloned = new TextView(getApplicationContext());
cloned.setText(tvPop.getText());
cloned.setLayoutParams(tvPop.getLayoutParams());
...
cloned.setWhateverFieldYouNeedToBeCloned(tvPop().getWhateverFieldYouNeedToBeCloned()); 
```

希望有帮助。

# css - 在忽略父宽度的同时浮动元素旁边？

> ID：13629570
> 
> 赞同：1
> 
> 时间：2012-11-29T15:53:59.607
> 
> 标签：css, html, width, parent

我以前遇到过这个问题，但我不记得这个问题叫什么，也找不到相关的解决方案，所以我们又来了。

我需要向左浮动两个盒子。这些框具有静态宽度，与父框的宽度相同。现在发生的是盒子堆叠在彼此下方而不是浮动，因为父级不够宽。

这是我想要的（粗略）说明：

[http://i.imgur.com/oHqsH.jpg](http://i.imgur.com/oHqsH.jpg)

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:58:41.073

据我所知，“干净”地做到这一点的唯一方法是拥有这种结构：

```
.window
  .parent
    .child
    .child 
```

父`width`级是其所有子级的总和，而`window`具有一个子级的宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:04:04.370

`white-space: nowrap`我使用with更新了您的代码`display: inline-block`。如果您真的需要这样做`float: left`，请按照@Kurt 的建议进行操作，因为它应该可以工作。但我真的相信`inline-block`这是正确的方法。

检查[小提琴](http://jsfiddle.net/rvNEn/2/)或在此处查看代码：

```
.parent {
    width: 200px;
    white-space: nowrap;
    overflow: hidden;
    font-size: 0;
}

.child {
    display: inline-block;
    width: 200px;
    font-size: 1rem;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T16:59:24.383

要使该`white-space: nowrap`方法起作用，您需要在父项和子项之间使用`position: absolute;`. 子项将需要拥有`position: relative;`，并且您需要为顶级父项分配一个高度。

[http://jsfiddle.net/79LWk/3/](http://jsfiddle.net/79LWk/3/)

# php - PHP MySQL按多列排序

> ID：13629571
> 
> 赞同：4
> 
> 时间：2012-11-29T15:54:00.473
> 
> 标签：php, mysql, sql

我正在寻找基于我表中的多个列的订单 - 所有日期相关。例如：我的列是：`fee_due`, `fee_2_due`, `fee_3_due`- 它们都包含各种日期的结果。但是，我想创建一个组合所有列的顺序，所以`fee_due`可能是`2012-11-03`，`fee_2_due`可能是`2012-11-01`，`fee_3_due`可能是`2012-11-02`。

我的查询需要是：

```
SELECT *
FROM table_name
ORDER BY [date] DESC 
```

...因此，来自 3 列的日期连接形成一个订单，无论它们在哪一列。

希望这是有道理的，并提前感谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-29T16:06:41.943

此外，您还可以：

```
SELECT *
FROM table_name
ORDER BY fee_due ASC,fee_2_due DESC,fee_3_due DESC 
```

您可以根据需要对每一列进行独立排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-16T14:52:31.293

我使用以下方法使其工作：

```
SELECT * FROM table ORDER BY camp1 ASC, camp2 ASC, camp3 DESC 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T15:56:36.843

你试试这个：

```
SELECT *
FROM table_name
ORDER BY fee_due,fee_2_due,fee_3_due DESC 
```

# mysql - 用于计算字符串出现次数的存储 MySQL 函数

> ID：13629574
> 
> 赞同：0
> 
> 时间：2012-11-29T15:54:09.500
> 
> 标签：mysql, sql, function, count, user-defined-functions

之前没有做过很多 MySQL 函数……所以，我希望让我的函数计算下面大海捞针的数量。我不断得到：

`#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 7`

这是“返回”的行，这是我所拥有的：

```
DELIMITER $$

CREATE FUNCTION `str_count`(needle TEXT, haystack TEXT) 
RETURNS INT(5)
BEGIN

  RETURN (LENGTH(haystack) - LENGTH(REPLACE(haystack, needle, ""))) / LENGTH(needle);

END$$ 
```

以前从未做过这种功能，因此非常感谢任何帮助！

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T05:45:07.567

嗯，我觉得很傻。运行这种东西时，请确保在 SQL 文本区域下方的 phpMyAdmin 文本框中定义分隔符……在我的例子中是“$$”，但现在它工作得很好！

# java - Android 通过 UDP 套接字发送对象

> ID：13629577
> 
> 赞同：0
> 
> 时间：2012-11-29T15:54:14.617
> 
> 标签：java, android, sockets, udp, bytearrayoutputstream

我正在尝试通过 UDP 套接字发送对象（ClientModel）。套接字部分工作正常，因为如果我尝试发送一个简单的字符串，它就可以工作。我遇到异常，错误在哪里？客户说“客户：失败。”。这是代码，目前只有客户端，因为问题是发送过程，而不是我可以考虑接收这些东西:)

谢谢

```
 public class ClientActivity extends Activity {
    public static final int SERVERPORT = 5050;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.client);

        try {
            InetAddress serverAddr = getBroadcastAddress();

            DatagramSocket socket = new DatagramSocket();

            //byte[] buf = "whatsup bitches".getBytes();

            ClientModel sendingMessage = new ClientModel();
            sendingMessage.data = 999;
            sendingMessage.name = "sample";
            System.out.println(sendingMessage);

            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            ObjectOutputStream oos = new ObjectOutputStream(baos);
            oos.writeObject(sendingMessage);
            byte[] buf = baos.toByteArray();

            DatagramPacket packet = new DatagramPacket(buf, buf.length,
            serverAddr, SERVERPORT);
            socket.send(packet);
            Log.d("UDP", "Client: Packet sent to server on address: " + serverAddr);
        }
        catch (Exception e) {
            Log.d("UDP", "Client: Fail");
        }
    }

    private InetAddress getBroadcastAddress() throws IOException {
        WifiManager myWifiManager = (WifiManager) getSystemService(WIFI_SERVICE);
        DhcpInfo myDhcpInfo = myWifiManager.getDhcpInfo();
        if (myDhcpInfo == null) {
            System.out.println("Could not get broadcast address");
            return null;
        }
        int broadcast = (myDhcpInfo.ipAddress & myDhcpInfo.netmask)
                    | ~myDhcpInfo.netmask;
        byte[] quads = new byte[4];
        for (int k = 0; k < 4; k++)
        quads[k] = (byte) ((broadcast >> k * 8) & 0xFF);
        return InetAddress.getByAddress(quads);
    }

    class ClientModel {
        public int data;
        public String name;
    }
} 
```

这是日志，对不起：

```
11-29 17:10:09.933: I/System.out(5700): com.example.ClientActivity$ClientModel@4054b800
11-29 17:10:09.964: W/System.err(5700): java.io.NotSerializableException: com.example.ClientActivity$ClientModel
11-29 17:10:09.964: W/System.err(5700):     at java.io.ObjectOutputStream.writeNewObject(ObjectOutputStream.java:1535)
11-29 17:10:09.964: W/System.err(5700):     at java.io.ObjectOutputStream.writeObjectInternal(ObjectOutputStream.java:1847)
11-29 17:10:09.964: W/System.err(5700):     at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:1689)
11-29 17:10:09.964: W/System.err(5700):     at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:1653)
11-29 17:10:09.964: W/System.err(5700):     at com.example.ClientActivity.onCreate(ClientActivity.java:39)
11-29 17:10:09.964: W/System.err(5700):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
11-29 17:10:09.964: W/System.err(5700):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1722)
11-29 17:10:09.964: W/System.err(5700):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1784)
11-29 17:10:09.964: W/System.err(5700):     at android.app.ActivityThread.access$1500(ActivityThread.java:123)
11-29 17:10:09.964: W/System.err(5700):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:939)
11-29 17:10:09.964: W/System.err(5700):     at android.os.Handler.dispatchMessage(Handler.java:99)
11-29 17:10:09.964: W/System.err(5700):     at android.os.Looper.loop(Looper.java:130)
11-29 17:10:09.964: W/System.err(5700):     at android.app.ActivityThread.main(ActivityThread.java:3835)
11-29 17:10:09.964: W/System.err(5700):     at java.lang.reflect.Method.invokeNative(Native Method)
11-29 17:10:09.964: W/System.err(5700):     at java.lang.reflect.Method.invoke(Method.java:507)
11-29 17:10:09.964: W/System.err(5700):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:864)
11-29 17:10:09.964: W/System.err(5700):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:622)
11-29 17:10:09.964: W/System.err(5700):     at dalvik.system.NativeStart.main(Native Method)
11-29 17:10:09.964: D/UDP(5700): Client: Fail 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T16:23:36.817

您需要了解更多关于 java 中的序列化。

```
class ClientModel implements Serializable{
    public int data;
    public String name;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:10:08.620

不要忘记 UDP 连接较少，实际上不会 100% 地获取您的数据。查看[http://cs.nyu.edu/~bacon/phd-thesis/diss/node32.html](http://cs.nyu.edu/~bacon/phd-thesis/diss/node32.html)

所以这就是我要做的。验证您的序列化是否正常工作，但在内存中序列化对象，然后从内存中反序列化它。如果可行，您就知道这是网络问题。

如果是网络问题，您可以尝试切换到基于 TCP 的流并以这种方式发送该数据。此外，您可能希望向数据添加校验和以确保其正确到达。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T20:43:29.337

```
 ByteArrayInputStream bais = new ByteArrayInputStream(packet.getData());
    ObjectInputStream ois = new ObjectInputStream(bais); 
    bais.close(); // move this to end of code
    ois.close();  // move this to end of code

    receivingMessage = (ClientModel) ois.readObject(); //you can't read if you've closed the streams 
```

# regex - 根据 url / nginx 设置内容 dispose

> ID：13629578
> 
> 赞同：3
> 
> 时间：2012-11-29T15:54:17.243
> 
> 标签：regex, nginx, lua, content-disposition

让 nginx 提供带有 url 之类的静态文件，`http://foobar.tld/<random_dir>/<file_md5sum_as_filename>`如果我在 url 的末尾指定`?f="filename.filetype"`- nginx 在末尾解析该查询字符串（如果已指定）并准备新的内容处理匹配指定的参数，并且没有任何动态后端，这是不可能的.

或实例`http://foobar.tld/<random_dir>/<file_md5sum_as_filename>?f="foobar.pdf"`

这样的事情可以用 nginx/lua 模块完成吗？有没有人有任何有用的例子或做过类似的事情？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-30T08:43:25.293

纯 Nginx 配置

```
location / {
  if ($arg_f) {
    add_header Content-Disposition "attachment; filename=$arg_f";
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T08:13:03.157

使用 nginx-lua 确实可以做到这一点；特别是[header_filter_by_lua](http://wiki.nginx.org/HttpLuaModule#header_filter_by_lua)指令。

像下面这样的东西应该可以解决问题：

```
location / {
  header_filter_by_lua '
    local args = ngx.req.get_uri_args()
    if not args.f then return end

    ngx.header["Content-Disposition"] = "attachment; filename=" .. args.f
  ';
} 
```

# c++ - 尝试修改 sqlite3 插入以返回 PK。不知道具体如何使用 sqlite3

> ID：13629580
> 
> 赞同：1
> 
> 时间：2012-11-29T15:54:20.453
> 
> 标签：c++, sql, sqlite, prepared-statement

我试图向表中插入一些数据，但我不确定哪个标志允许我返回主键。我相信我记得使用 RETURNING 的 MSSQL，还有一些人在最后添加了 RETURNS。

有人可以帮忙附加它吗？

我正在尝试返回 TABLEA.a，我的查询和设计看起来像这样：

```
sqlite3 *db;
sqlite3_open("...",&db);
std::string query;
query = "insert into TABLEA (b,c,d,e) values (@b,\"@c\",@d,@e);"; 
            //^--this needs to be modified.
sqlite3_stmt *sqlstmt;
int rc;
rc = sqlite3_prepare_v2(db, query.c_str(), 01, &sqlstmt, 0);
sqlite3_step(sqlstmt);
int ID;
ID = sqlite3_column_integer(sqlstmt,0); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T16:03:49.527

你试过[`sqlite3_last_insert_rowid`](http://www.sqlite.org/c3ref/last_insert_rowid.html)吗？

# excel - excel导出为pdf；图形放置偏移

> ID：13629581
> 
> 赞同：0
> 
> 时间：2012-11-29T15:54:22.980
> 
> 标签：excel, pdf, export

使用 excel (2010) 的内置 pdf 导出功能将文档导出为 pdf 时，我遇到了一些问题。

我在我的工作表上生成了一个图表，周围有一些彩色单元格。从视觉上看，它看起来不错（即使我用 ctrl 键 + 鼠标滚轮放大它）。但是在导出时，图形会与周围的单元格重叠。

例如，在下图中，我在 excel（顶部）和 pdf（底部）中截取了我的图表。红色部分是我的图表（我已经为图表对象的背景着色）。该图有一个黑色边框。就在图表的顶部，我将单元格的背景涂成蓝色。通常，图表不能与蓝色单元格重叠，因为我已手动将其放置在下方（剪切图表，选择蓝色单元格下方的单元格，然后将图表传递到此位置）。

但我们可以看到：

*   黑色边框与蓝色单元格重叠（在 excel 和 pdf 版本中；但这不是我的问题；我知道 excel 对象中的边框位于对象外部；然后重叠环绕对象/单元格）。
*   图表（红色+边框）在excel和pdf中的位置不同，偏移量很大（这不是调整大小的问题，这个偏移量存在并且左侧也存在）。在 pdf 版本中，图表的位置更多地位于左侧和顶部！

（我正在使用它来自动生成报告；结果在视觉上并不好）

![excel图形放置问题](../Images/9c300e01e32663ee247593c346e0ef1a.png)

有没有办法克服这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:43:27.557

嗯，我无法复制您的问题，但我在将 Crystal Reports 导出为 PDF 时遇到了类似的问题。这里有 2 条建议，但都不是完美的，我无法先尝试（再次抱歉，我无法复制问题）：

1.  在图形和单元格之间添加一个高度非常小的白行。它甚至可能在视觉上比一个在另一个之上的 2 个对象更具吸引力。

2.  使图表的背景透明并隐藏边框。也许在图表顶部添加一些额外的空白。这样，它们仍然会重叠，但不会那么明显。

# ruby-on-rails - 有什么办法可以避免过多的 ActiveRecord 调用？

> ID：13629586
> 
> 赞同：1
> 
> 时间：2012-11-29T15:54:31.373
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我在 Rails 控制器（“filings#index”）中有以下 ActiveRecord 调用：

```
@filings = Filing.order("created_at DESC").limit(limit).offset(start).joins("LEFT OUTER JOIN companies ON companies.id=filings.company_id") 
```

每个文件都属于一家公司。我希望能够访问：

```
@filings.first.company 
```

无需进行额外的 SQL 查询，因为这是首先完成 OUTER JOIN 的全部目的。但是，当我调用 @filings.first.company 时，它会执行一个附加查询：

```
SELECT "companies".* FROM "companies" WHERE "companies"."id" = 989 LIMIT 1 
```

如何避免发生第二个查询？作为初始查询的结果，信息不应该已经存储了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T17:15:10.297

您需要包含数据库中的信息：

```
@filings = Filing.includes(:company).order("created_at DESC").offset(start).limit(limit) 
```

*向约翰·内格尔和塔里森致敬*

# c# - 如何在 ASP.Net MVC3 中实现打印

> ID：13629587
> 
> 赞同：10
> 
> 时间：2012-11-29T15:54:31.327
> 
> 标签：c#, jquery, asp.net-mvc, asp.net-mvc-3, jquery-ui

作为给定项目列表中我当前任务的一部分，用户可以选择其中一些并调用“打印”而不是选定的项目。

对于每个选定的项目，我们需要打印详细信息。它类似于在销售系统中打印选定项目的发票。

我创建了一个局部视图来编写每个记录详细信息，但我不确定如何根据我的要求使用它。

我可以在 document.ready 上调用 jQuery print 来满足我的要求吗？

正如@Levib 建议的那样，在我的 PrintView 中调用部分视图。而PrintView的document.reay函数正在调用window.print。但是当我尝试调用“打印”时，我看不到打印对话框。

这是我的看法，

```
@section Styles
{
    <link rel="stylesheet" href="AdminStyle.css" type="text/css" media="all" />
    <link rel="stylesheet" href="AdminPrintOrder.css" type="text/css" media="print" />
}

@foreach (var item in Model)
{
    <div id="content" style="page-break-before: always">
        @{Html.RenderPartial("_OrderDetailView", item);}
    </div>   
}

@section scripts
{
    <script type="text/javascript">
        $(document).ready(function () {
            debugger;
            window.print();
        });
    </script>
} 
```

我的打印调用者视图是

```
 function printInvoices(){
            $.ajax({
                type: 'POST',
                url: '/Batch/PrintInvoices',
                data: '{ "allocationId" : "' + unSelected.toString() + '"}',
                contentType: "application/json; charset=utf-8",
                traditional: true,
                success: printedView,
                error: errorInSubscribing
            });
        } 
```

**我是否需要处理 ajax reposne 来填充打印对话框。**

```
 function printedView() {
            unSelected = [];
        } 
```

控制器动作是

```
[HttpPost]
        public ActionResult PrintInvoices(string allocationId)
        {
            var context = new BatchContext();
            var orderDetails =  context.GetOrderDetails(RetriveList(allocationId));
            return View(orderDetails);
        } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-29T16:03:05.437

*   为您的页面定义一个打印样式表。您可以使用@media 打印声明来执行此操作。
*   然后，您可以将要打印的页面上的每个局部视图包装在一个 div 中，并将`'page-break-before: always'`CSS 属性应用于它。

这将确保每个部分视图最终出现在不同的页面上。调用`'window.print()'`页面加载，您就完成了！

* * *

*鉴于此答案的评论中提出的广泛问题，这里是对需要做什么的更详细的描述：*

## 准备

*   需要定义样式表并将其应用于页面，该页面定义了打印时页面的外观。
    *   这可以通过`@media print { }`在现有样式表中使用声明来完成，或者通过将`media="print"`属性应用于`link`包含样式表的页面中的标记来完成。你似乎已经正确地做到了这一点。
    *   此样式表必须包含`page-break-before: always`您希望在其之前有分页符的所有元素的声明。您似乎已经使用内联样式完成了此操作。就我个人而言，我宁愿在打印样式表中这样做，也不愿作为内联样式。此步骤对于您能够每页打印一个项目是不可或缺的。

## 印刷

*   `window.print()`允许您作为页面作者定义何时打印页面。这与`CTRL`+`P`或单击打印按钮的作用相同，但您可以通过 JavaScript 执行此操作。
*   Ajax 本质上与打印无关。Ajax 是一种从您的页面异步进行 HTTP 调用的方法，而无需更改或重新加载它并因此更新您的页面。如果您想根据用户输入使用要打印的项目来动态填充页面，那么您可以使用 Ajax 很好地做到这一点。如果您只想打印页面，则不需要使用 Ajax。导航器。**

## 两个重要的点：

*   `window.print()`打印当前在屏幕上的页面。如果您想打印不同的页面，您需要以某种形状或形式（可能通过弹出窗口）加载另一个页面并在该页面上调用 window.print()。
*   打印样式表定义了打印页面与屏幕版本相比的外观。这意味着您可以拥有一页项目和许多其他内容，并在用户单击打印按钮时仅打印项目。您可以通过`display: none`在打印样式表中为您不想出现在打印页面上的所有元素设置属性来做到这一点。

## 关于 PDF：

我不反对在必要时将页面导出为 PDF，但由于您没有专门询问 PDF 解决方案，因此我为您提供了 HTML+CSS 解决方案来解决您的问题。PDF 也需要一分钟的时间来生成和加载。但是，当您的用户想要保存他们正在打印的内容的副本时，它们非常棒。如果您的网站属于这种情况，我强烈建议您考虑这样的解决方案。

## 测试：

如何测试打印样式表？最简单的方法是简单地单击 Chrome 中的打印按钮，它会向您展示您的网站在打印时的外观。

## 最后一句话：

现在，忘记`window.print()`并专注于通过应用适当的 CSS 让您的页面看起来像它应该的样子。编写您的 CSS，运行您的页面，查看 Chrome 中的输出，根据需要修改您的打印样式表......冲洗并重复。只有在单击打印按钮时页面完全按照您想要的方式显示后，您才应该考虑在 JavaScript 中自动调用打印功能。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-29T16:01:54.707

我如何在 MVC 中进行打印：

1.  创建一个视图，其中包含您想要打印的内容，并列出您希望它的外观
2.  使用[Rotativa](http://www.codeproject.com/Articles/335595/Rotativa-how-to-print-PDF-in-Asp-Net-MVC)库将您的 MVC 视图转换为 pdf 文档。

就像将您的操作更改为如下所示一样简单

```
public ActionResult PrintInvoice(int invoiceId)
{
  return new ActionAsPdf(
                 "Invoice", 
                 new { invoiceId= invoiceId }) 
                 { FileName = "Invoice.pdf" };
} 
```

我相信它会遵守 css 分页符，所以如果您只需要每页打印一个项目，您可以使用该标记将项目强制到新页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T16:03:16.650

我将创建一个 PDF 以更好地控制页面的布局。

使用 jQuery，我将从用户那里获取选定的项目，而不是对一个接受项目列表作为参数的操作方法进行 ajax 调用或简单的 POST，然后返回包含您的 pdf 的文件流。

有很多免费和商业的库可以在运行时或设计时创建 pdf。

我个人使用[DevExpress](http://www.devexpress.com)，对此我很满意。

作为开源替代方案，您可以考虑[PDFSharp](http://www.pdfsharp.net/Overview.ashx)

# mysql - “ON UPDATE”是否特定于 TIMESTAMP cols？

> ID：13629593
> 
> 赞同：0
> 
> 时间：2012-11-29T15:54:43.913
> 
> 标签：mysql

是`ON UPDATE`针对`TIMESTAMP`cols的吗？

当我在其他类型的 cols 上使用它时，会导致语法错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:57:52.923

虽然我不是 Mysql 专家，但它看起来像特定的语法是 TIMESTAMP 特定的。

从[文档](http://dev.mysql.com/doc/refman/5.0/en/timestamp-initialization.html)中：

> 要指定自动属性，请使用 DEFAULT CURRENT_TIMESTAMP 和 ON UPDATE CURRENT_TIMESTAMP 子句。

然后稍后：

> DEFAULT CURRENT_TIMESTAMP 和 ON UPDATE CURRENT_TIMESTAMP 的使用特定于 TIMESTAMP。

# iphone - 相关实体的 iOS 核心数据持久性

> ID：13629600
> 
> 赞同：0
> 
> 时间：2012-11-29T15:55:01.897
> 
> 标签：iphone, ios, core-data, persistence

在我的核心数据对象模型中，我有两个与一对多关系相关的实体。

示例：表 A 可以有许多表 B 与之关联。

我的问题是，当我添加表B行（对象引用表A）时，我需要独立保存表B，还是表A的保存也会保留表B？

保存表 A 时，表 B 似乎正在保留。但我找不到任何文档来确认这一点。我想确保我不会冒丢失数据的风险。

（Core Data 的保存速度非常慢......并且独立保存表 B 数据很麻烦）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:03:17.133

不要考虑桌子。保存的是托管对象上下文，它转换为：您使用该上下文对托管对象所做的任何更改。

# php - gcm 消息中的空值

> ID：13629602
> 
> 赞同：0
> 
> 时间：2012-11-29T15:55:15.313
> 
> 标签：php, android, json, curl, google-cloud-messaging

我正在尝试使用典型的 php 后端，使用 curl 将 GCM 推送通知发送到 android 设备。 php 脚本如下：

```
<?php
//request url
$url    = 'https://android.googleapis.com/gcm/send';
//your api key
$apiKey = 'AIzaSyB-1uEai2WiUapxCs2Q0GZYzPu7Udno5aA';
//registration ids
$registrationIDs = array('APA91bHun4MxP5egoKMwt2KZFBaFUH-1RYqx...');
//payload data
$data   = array('score' => '1-0', 'scorer' => 'Ronaldo', 'time' => '44');

$fields = array('registration_ids' => $registrationIDs,
            'data' => $data);

//http header
$headers = array('Authorization: key=' . $apiKey,
             'Content-Type: application/json');

//curl connection
$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true );
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($fields));

$result = curl_exec($ch);

curl_close($ch);

echo $result;
?> 
```

我在客户端应用程序中使用广播接收器：

```
private final BroadcastReceiver mHandleMessageReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {
        String newMessage = intent.getExtras().getString("score");
        // Waking up mobile if it is sleeping
        WakeLocker.acquire(getApplicationContext());

        // Showing received message
        lblMessage.append(newMessage + "\n");           
        Toast.makeText(getApplicationContext(), " New Message: " + newMessage, Toast.LENGTH_LONG).show();

        // Releasing wake lock
        WakeLocker.release();
    }
}; 
```

从 php 脚本的结果来看，我很确定 json 消息正在正确发送。我还在注册设备中收到通知。但问题是，我收到一条“空”消息。因为我只是想打印我收到的字符串，所以会打印“null”。这句话有什么问题吗：`String newMessage = intent.getExtras().getString("score");`？或者我应该解码 json 以检索消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T18:20:53.170

我认为问题出在这里

```
$fields = array('registration_ids' => $registrationIDs,
            'data' => $data); 
```

你必须这样做：

```
$fields = array('registration_ids' => $registrationIDs,
            'data.score' => $data); 
```

# .net - 应用程序在 IIS 7.0 2.0 应用程序池中运行，但不在 1.1 应用程序池中

> ID：13629603
> 
> 赞同：0
> 
> 时间：2012-11-29T15:55:18.003
> 
> 标签：.net, iis-7, windows-server-2008-r2

我有一个要从 Server 2003 迁移到 Server 2008r2 的应用程序。该应用程序是用 .NET 1.1 编写的。我已经在 2008r2 机器上安装了 .NET 1.1。该应用程序在 2.0 中运行（有错误），但不在 1.1 中运行。

我为 ASP.NET 1.1 创建了一个应用程序池：

> ![应用程序池截图](../Images/6303d4ac2e36aee6fcebbfe3773c995a.png)

我已将该应用程序池用于该应用程序：

> ![应用程序设置](../Images/73573fabdde017fdf80e4f3b0a5c9843.png)

而且我在 ISAPI 和 CGI​​ 限制中允许了 ASP.NET 1.1：

> ![ISAPI 和 CGI​​ 限制截图](../Images/d1086494a09dae21c3c8852b117eb158.png)

但是，我收到一条无法显示页面的消息：

> ![页面无法显示截图](../Images/01c94252585d7df2f007b75faeee90ed.png)

正如我所提到的，如果我切换应用程序池，网站将呈现（有错误）。

我没有看到 Windows 日志中记录的任何错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T14:33:49.093

该应用程序存在许多问题，阻止它在框架 2.0 上运行。整体问题的解决方案是解决应用程序的许多小问题。这使我们能够推出应用程序以在 2.0 框架上进行测试。

鉴于新的应用程序服务器是 SQL 2008，无论如何进行此升级是有意义的。不幸的是，这比我们希望的要多一点工作。

# javascript - 如何使用 AJAX 从 Javascript 函数更新 Rails 表？

> ID：13629605
> 
> 赞同：3
> 
> 时间：2012-11-29T15:55:20.107
> 
> 标签：javascript, jquery, ruby-on-rails, ajax

我是 Rails 和 AJAX 的新手，我不知道如何使用 AJAX 从 Javascript 函数更新 Rails 表。

具体来说，我正在开发一个计划器，当我将一个可拖动的 div（这代表我数据库中的一个项目）放到日历上时，我想更改该项目的“开始日期”。我可以在放置时检索正确的日期，我只是不知道如何用这个新日期更新 Rails 表变量。

通常，我会访问它：batch_ticket.start_date。

从我所看到的，我需要进行远程 AJAX 调用来更新这个变量，但我被困在如何做到这一点上。任何朝着正确方向的推动都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:14:07.910

查看适用于 rails 表单的 :remote => true 选项。还考虑创建一个 *.js.erb 文件，该文件将呈现回浏览器并在提交远程表单后执行。

# android - android：在接收短信时点亮屏幕（并解锁）

> ID：13629616
> 
> 赞同：0
> 
> 时间：2012-11-29T15:55:46.973
> 
> 标签：android

我想在我的应用程序中接收短信时点亮屏幕。我应该怎么办？是否也可以解锁屏幕？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-03T04:17:02.863

使用 PowerManager 唤醒屏幕

```
PowerManager pm = (PowerManager)   getApplicationContext().getSystemService(Context.POWER_SERVICE);
        WakeLock wakeLock = pm.newWakeLock((PowerManager.SCREEN_BRIGHT_WAKE_LOCK | PowerManager.FULL_WAKE_LOCK | PowerManager.ACQUIRE_CAUSES_WAKEUP), "TAG");
        wakeLock.acquire(); 
```

并在清单中添加权限

```
< uses-permission android:name="android.permission.WAKE_LOCK" /> 
```

# ruby-on-rails-3 - 选项卡内的分页

> ID：13629620
> 
> 赞同：2
> 
> 时间：2012-11-29T15:56:01.637
> 
> 标签：ruby-on-rails-3, twitter-bootstrap, tabs, pagination, kaminari

我有 2 个带有引导用户消息的选项卡 - 收件箱和发件箱，并使用 kaminari

```
<div id="allmessages" >

    <div class="tabbable"> 
      <ul class="nav nav-tabs">
        <li class="active"><a href="#inbox" data-toggle="tab">Inbox</a></li>
        <li><a href="#outbox" data-toggle="tab">outbox</a></li>
      </ul>
      <div class="tab-content">
        <div class="tab-pane active" id="inbox">
            <%= render @incoming_msgs %>
            <%= paginate @incoming_msgs %>
        </div>
        <div class="tab-pane" id="outbox">
            <%= render @outgoing_msgs%>
            <%= paginate @outgoing_msgs%>
        </div>
      </div>
    </div>
</div> 
```

问题是，当进入收件箱中的第 2 页然后单击发件箱选项卡时，我会进入发件箱的第 2 页。

```
http://localhost:3000/users/messages?page=2#outbox 
```

是否可以颠倒顺序或每个标签有分页？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-12T16:41:52.660

将 param_name 选项传递给 paginate 方法将允许您独立地对每个对象数组进行分页。现在他们都使用默认的参数名称'page'。

```
<div class="tab-pane active" id="inbox">
    <%= render @incoming_msgs %>
    <%= paginate @incoming_msgs, param_name: :incoming_msgs_page %>
</div>
<div class="tab-pane" id="outbox">
    <%= render @outgoing_msgs%>
    <%= paginate @outgoing_msgs, param_name: :outgoing_msgs_page %>
</div> 
```

确保在控制器中引用新的参数名称

```
@incoming_msgs = mailbox.inbox.page(params[:incoming_msgs_page]).per(25)
@outgoing_msgs = mailbox.outbox.page(params[:outgoing_msgs_page]).per(25) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T22:46:40.887

简短的回答 - 使用 ajax 分页

[http://railscasts.com/episodes/174-pagination-with-ajax](http://railscasts.com/episodes/174-pagination-with-ajax)

# jquery - 菜单指针通过滚动动画

> ID：13629622
> 
> 赞同：3
> 
> 时间：2012-11-29T15:56:02.813
> 
> 标签：jquery, css

我制作了一个顶部菜单，按钮下方有一个小箭头。我希望这个箭头移动到滚动在我的一页设计上的位置。

我想我已经掌握了基础知识......但不知何故，一旦我尝试为箭头设置动画（而不是让它在按钮之间跳转），它就会不断翻转。我想这与多个 >=... 有关，但我想不出替代方案。谁能给我一些建议？

效果可以看这里：[http ://www.lightwavedesign.nl/](http://www.lightwavedesign.nl/)

我使用的JS如下：

```
 function goToByScroll(id){
        $('html,body').animate({scrollTop: $("#"+id).offset().top-78},'1000');
    };

    window.onload = function() {
      var link1 = $("#Welkom"); var positionLink1 = link1.position();
      var link2 = $("#OverMij"); var positionLink2 = link2.position();
      var link3 = $("#Portfolio"); var positionLink3 = link3.position();
      var link4 = $("#Contact"); var positionLink4 = link4.position();

      function getScrollTop() {
        if (typeof window.pageYOffset !== 'undefined' ) {return window.pageYOffset;}
        var d = document.documentElement;
        if (d.clientHeight) {return d.scrollTop;}
        return document.body.scrollTop;
      }

      window.onscroll = function() {
        var box = document.getElementById('menuAanwijzer'),
        scroll = getScrollTop();
        if (scroll <= positionLink2.top) {$('#menuAanwijzer').animate({left: '665px'}, 100)}
        if (scroll >= positionLink2.top-80) {$('#menuAanwijzer').animate({left: '760px'}, 100)}
        if (scroll >= positionLink3.top-80) {$('#menuAanwijzer').animate({left: '860px'}, 100)}
        if (scroll >= positionLink4.top-80) {$('#menuAanwijzer').animate({left: '960px'}, 100)}
        if (scroll >= positionLink2.top-80) {$('#menuTitel').fadeIn('500');}
        if (scroll <= positionLink2.top-80) {$('#menuTitel').fadeOut('500');}

      };
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:02:52.397

`.stop()`
简单，使用.stop().animate()清除动画队列

```
 if (scroll <= positionLink2.top) {$('#menuAanwijzer').stop().animate({left: '665px'}, 100)}
    if (scroll >= positionLink2.top-80) {$('#menuAanwijzer').stop().animate({left: '760px'}, 100)}
    if (scroll >= positionLink3.top-80) {$('#menuAanwijzer').stop().animate({left: '860px'}, 100)}
    if (scroll >= positionLink4.top-80) {$('#menuAanwijzer').stop().animate({left: '960px'}, 100)}
    if (scroll >= positionLink2.top-80) {$('#menuTitel').stop().fadeIn('500');}
    if (scroll <= positionLink2.top-80) {$('#menuTitel').stop().fadeOut('500');} 
```

# android - 将记录从表1复制到表2时出错。sqlite约束异常错误代码19约束失败

> ID：13629624
> 
> 赞同：1
> 
> 时间：2012-11-29T15:56:22.963
> 
> 标签：android, sqlite

我正在将同一数据库中的所有记录（备份）从 table1 复制到 table2。这是我的第一个数据库应用程序。

这是表1结构：

```
private static final String CREATE_SELECTED_CAND_TABLE = " CREATE TABLE if not exists "
        + TABLE_SELECTED_CAND
        + "("
        + KEY_ID
        + " integer PRIMARY KEY autoincrement,"
        + KEY_NAME1
        + " TEXT,"
        + KEY_NAME2
        + " TEXT,"
        + KEY_NAME3
        + " TEXT,"
        + KEY_NAME4
        + " TEXT," + KEY_NAME5 + " TEXT" + ")"; 
```

表2结构：

```
private static final String CREATE_SELECTED_CAND_RECOUNT1 = " CREATE TABLE if not exists "
        + TABLE_RECOUNT1
        + "("
        + KEY_ID
        + " integer PRIMARY KEY autoincrement,"
        + KEY_NAME1
        + " TEXT,"
        + KEY_NAME2
        + " TEXT,"
        + KEY_NAME3
        + " TEXT,"
        + KEY_NAME4
        + " TEXT," + KEY_NAME5 + " TEXT" + ")"; 
```

我正在像这样复制：

```
 mDb.execSQL(" INSERT INTO " + TABLE_RECOUNT1 + " SELECT * FROM "
            + TABLE_SELECTED_CAND); 
```

现在的问题是，***只有当所有列都不为空时才复制*** 我有一些列为空，但我也想复制它们。我该如何实现这一目标。？任何帮助将是非常可观的..！

这些是堆栈跟踪：

> E/AndroidRuntime(30294): android.database.sqlite.SQLiteConstraintException:*错误代码 19: 约束失败*
> E/AndroidRuntime(30294): at android.database.sqlite.SQLiteStatement.native_execute(Native Method)
> E/AndroidRuntime(30294): at android.database.sqlite.SQLiteStatement.executeUpdateDelete(SQLiteStatement.java:92)
> E/AndroidRuntime(30294)：在 android.database.sqlite.SQLiteDatabase.executeSql(SQLiteDatabase.java:2028)
> E/AndroidRuntime(30294)：在 android. database.sqlite.SQLiteDatabase.execSQL(SQLiteDatabase.java:1968)
> E/AndroidRuntime(30294)：在 com.dana.db.SelectedCandidatesDB.copyToRecount1(SelectedCandidatesDB.java:257)
> E/AndroidRuntime(30294)：在 com.dana.votecount.VoteRecount.fetchAllFromRecount1(VoteRecount.java:161) E/AndroidRuntime(30294)：在 com.dana.votecount.VoteRecount.access$1(VoteRecount.java:158)
> E /AndroidRuntime(30294)：在 com.dana.votecount.VoteRecount$2$1.onClick(VoteRecount.java:107)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T09:59:10.193

实际上可以[将自动增量列设置为特定值](http://www.sqlite.org/autoinc.html)，但前提是该值尚不存在。

记录很可能已经存在于`RECOUNT1`表中。

为确保没有旧记录，请在插入之前将其删除：

```
mDb.execSQL("DELETE FROM " + TABLE_RECOUNT1);
mDb.execSQL("INSERT INTO " + TABLE_RECOUNT1 + " SELECT ..."); 
```

或者，如果您知道所有记录都没有更改，则可以使用[INSERT OR IGNORE 命令](http://www.sqlite.org/lang_insert.html)仅插入 ID 尚不存在于目标表中的那些记录：

```
mDb.execSQL("INSERT OR IGNORE INTO " + TABLE_RECOUNT1 + " SELECT ..."); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:01:33.347

该错误是由于**自动增量**造成的，因为您不能或为自动增量列分配值，您应该在查询中分配 null 或更改

mDb.execSQL("插入"+TABLE_RECOUNT1+"SELECT * FROM"+TABLE_SELECTED_CAND);

replce * 与列名未提及自动增量列名以及同一查询中的 table1

# iphone - Objective c将字符串对象添加到数组中

> ID：13629632
> 
> 赞同：7
> 
> 时间：2012-11-29T15:56:51.780
> 
> 标签：iphone, objective-c, ios, arrays, ipad

我到处寻找这个，在线，堆栈溢出，但仍然无法弄清楚我做错了什么。

我正在尝试向现有的 NSMutableArray 添加一个元素。但它在第 4 行崩溃：

```
-[__NSArrayI addObject:]: unrecognized selector sent to instance 0x897b320 
```

编码：

```
NSMutableArray *mystr = [[NSMutableArray alloc] init];

mystr = [NSArray arrayWithObjects:@"hello",@"world",@"etc",nil];

NSString *obj = @"hiagain";

[mystr addObject:obj]; 
```

我究竟做错了什么？这真让我抓狂！！！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-29T15:58:49.200

你的数组是不可变的！采用`NSMutableArray`

```
mystr = [NSMutableArray arrayWithObjects:@"hello",@"world",@"etc",nil]; 
```

您得到 **无法识别的选择器**，因为`NSArray`不包含**addObject**方法

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T15:59:42.830

您的代码应该是：

```
NSMutableArray *mystr = [[NSMutableArray alloc] initWithObjects:@"hello",@"world",@"etc",nil];

NSString *obj = @"hiagain";

[mystr addObject:obj]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T15:59:08.070

啊啊啊已经看出来了

第 2 行应该是：

```
[NSMutableArray arrayWithObjects:@"hello",@"world",@"etc",nil]; 
```

很抱歉浪费你的时间！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T15:59:46.830

第二行你将一个实例重新分配`NSArray`给`NSMutableArray`你的`mystr`变量。

尝试这样的事情：

```
NSMutableArray *mystr = [NSMutableArray  arrayWithObjects:@"hello",@"world",@"etc",nil];

[mystr addObject:@"hiagain"] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-29T16:00:05.560

您最初将 mystr 创建为可变数组，但随后将其分配给下一行中的标准 NSArray。而不是调用“arrayWithObjects”，而是使用“addObjects”或其他一些不会创建新的不可变数组的函数添加每个项目。

# c# - 在堆栈中添加新项目时引发事件

> ID：13629633
> 
> 赞同：1
> 
> 时间：2012-11-29T15:56:53.417
> 
> 标签：c#, stack

> **可能重复：**
> [可观察堆栈和队列](https://stackoverflow.com/questions/3127136/observable-stack-and-queue)

我的应用程序中有一个`stack<String>`。我可以使用`Stack.Push(Object)`和`Stack.Pop()`。但是我想知道何时在堆栈中添加了一个新对象。我不知道它是否可能。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T16:03:07.850

创建从 Stack 继承的类：

```
class StackHolder: Stack
{

    public delegate void ItemAddedDelegate(object item);
    public event ItemAddedDelegate ItemAdded;

    public override void Push(object obj)
    {
        base.Push(obj);
        if (ItemAdded != null)
        {
            ItemAdded(obj);
        }
    }
} 
```

以下是您应该如何使用它：

```
 StackHolder sh = new StackHolder();
        sh.ItemAdded += new StackHolder.ItemAddedDelegate(sh_ItemAdded); 
```

这是事件的处理程序：

```
 void sh_ItemAdded(object item)
    {
       //TODO: handle event
    } 
```

# ruby - 在嵌套目录结构中查找文件

> ID：13629634
> 
> 赞同：2
> 
> 时间：2012-11-29T15:56:55.987
> 
> 标签：ruby

我试图在目录中按文件名查找文件。我不确定解决这个问题的最佳方法是什么。该文件可以嵌套在根目录中的其他目录中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T16:13:15.163

您可以使用[`Dir.glob`](http://ruby-doc.org/core-1.9.3/Dir.html#method-c-glob)或[`Dir[]`](http://ruby-doc.org/core-1.9.3/Dir.html#method-c-5B-5D)：

```
Dir['the_directory/**/the_filename'] 
```

`**`递归匹配 0 个或多个目录。它返回匹配的文件名数组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T16:18:36.763

您可以使用*Dir.glob*，例如：

```
Dir.glob(File.join("**","*.rb")) 
```

它将递归地在当前目录中查找“*.rb”文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T16:03:51.307

这应该适合你：

```
require 'find'

file_name = /log\Z/
path = './'

found_files = Find.find(path).inject([]) do |files, entry|
  File.file?(entry) && File.basename(entry) =~ file_name ?
    files << entry : files
end

p found_files
#=> ["./Maildir/dovecot.index.log", "./pgadmin.log"] 
```

改变`file_name`和`path`你的需要。

# database - 确定具有功能依赖关系的候选键很简单

> ID：13629637
> 
> 赞同：2
> 
> 时间：2012-11-29T15:57:07.350
> 
> 标签：database, relational-database, functional-dependencies

令 R(A,B,C,D,E) 为关系模式，F = {A→C, B→D, C→E, E→A}，找到所有候选键。

我相信由于无法映射，该集合中不存在CK。B 或 D 除了 B -> D 之外的任何其他关系。这是否意味着没有候选键？尽管我能够将 A 映射到除 B 和 D 之外的所有其他实体。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-28T13:46:11.487

规范化的第一步是找到关系的所有键。以下是一些有助于找到钥匙的事实：

1.  如果属性不在任何 FD 中，则它在每个键中。

2.  如果一个属性出现在 FD 的右侧，但从未出现在左侧，则它永远不会出现在键中。

3.  如果一个属性出现在 FD 的左侧，但从未出现在右侧，则它存在于每个键中。

4.  如果一个属性同时出现在 FD 的右侧和 FD 的左侧，那么就无法说明该属性。

要查找键，请确定上述每种情况中的属性。第一种和第三种情况中的那些必须在每个键中。称这组属性为核心。计算由核心确定的属性。这称为核心的闭合。如果所有的属性都在封闭的核中，那么核不仅是一把钥匙，它也是唯一的钥匙。如果关闭的核心不是整个属性集，那么就会丢失一些。写下这组属性，并删除上面第二组中的任何属性（即，它出现在 FD 的右侧，但从不出现在左侧）。这些是外在属性。要获得一把钥匙，必须向核心添加一个或多个外部属性。因此，将它们添加到核心，一次添加一个，然后一次添加两个，依此类推，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T16:19:31.830

有三个候选键。

B 不会出现在任何函数依赖项的右侧。这意味着 B 必须是每个候选键的一部分。我认为*仅此一项*并不能保证至少有一个候选键，但通过检查应该清楚 AB 是这里的三个候选键之一。

你的教科书应该至少包含一个算法来确定所有候选键的集合。如果幸运的话，它包括一种适用于纸和铅笔的算法，以及另一种适用于通过编程实现自动化的算法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-23T02:56:36.887

在所有功能依赖项中严格仅位于左侧的每个属性都是必须构成每个候选键的一部分的属性。

下一步是实现单独这样一个属性是否可以生成，或者确定模式内的所有属性。如果是，则该属性是其原始独立形式的候选键。如果不是，则将该属性与其他每个属性分组，一次一个，一次两个，依此类推。所有这些遍历整个属性集的最小集合都可以称为*候选键*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-02T16:17:57.183

由于 B 不在右手边，所以 B 应该是候选键的一部分，并且 A 和 C 出现在两侧，因此它们可以与 B 形成超级键。在映射上 AB 和 BC 是超级键并作为候选键是最小的超级键，所以 AB 和 BC 是候选键。

# c# - 使用 c# 调试访问令牌

> ID：13629638
> 
> 赞同：1
> 
> 时间：2012-11-29T15:57:07.767
> 
> 标签：c#, facebook, facebook-c#-sdk

我想知道访问令牌何时到期

我正在使用 httprequest 并从包含链接的请求中获取响应：

[https://developers.facebook.com/tools/debug/access_token?q=ACCESS_TOKEN](https://developers.facebook.com/tools/debug/access_token?q=ACCESS_TOKEN)

并搜索单词`Expires`并尝试读取括号之间的字符串，其中包含（大约 x 分钟）

但是出现注销的错误可以请任何人帮助我吗？

```
string site = "https://developers.facebook.com/tools/debug/access_token?q=";
string token = "";
getRequest = (HttpWebRequest)WebRequest.Create(site + token);
string result;
HttpWebResponse res = (HttpWebResponse)getRequest.GetResponse();
using (StreamReader sr = new StreamReader(res.GetResponseStream()))
{
result = sr.ReadToEnd();
}
Console.WriteLine(result);
Console.WriteLine(result.Contains("Expires")); 
```

我弄错了我需要一个包含字符串“Expires”的结果并读取将过期的时间

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T03:24:04.373

[您可以在https://developers.facebook.com/docs/howtos/login/debugging-access-tokens/](https://developers.facebook.com/docs/howtos/login/debugging-access-tokens/)阅读文档

提出请求`https://graph.facebook.com/debug_token?input_token=INPUT_TOKEN&access_token=ACCESS_TOKEN`

**input_token**：要调试的访问令牌

**access_token**：您的应用访问令牌或来自应用开发者的有效用户访问令牌。

如果您使用的是 FB C# SDK (http://csharpsdk.org/)

```
var fb = new FacebookClient("app_access_token");
dynamic result = fb.Get("debug_token", new { input_token = "access_token_to_debug" });
var appId = result.data.app_id;
var isValid = result.data.is_valid;
var application = result.data.application;
var userId = result.data.user_id;
var expiresAt = result.data.expires_at;
var scopes = result.data.scopes; 
```

[您可以在http://csharpsdk.org/docs/faq](http://csharpsdk.org/docs/faq)了解如何获取应用程序访问令牌。我还更新了文档以包括调试访问令牌。

注意：当您从用户那里获得访问令牌时，请确保也存储到期日期，这样您就可以避免此调用。

# wpf - 如何将 DataTrigger 绑定到单独的 ListBox ScrollViewer 的 ComputedVerticalScrollBarVisibility 属性？

> ID：13629650
> 
> 赞同：2
> 
> 时间：2012-11-29T15:57:37.753
> 
> 标签：wpf, binding, listbox, scrollviewer, datatrigger

如果列表框的垂直滚动条折叠，我想调整放置在单独列表框上方的边框或边距的宽度或可见性。

我正在尝试这样的事情，但无法弄清楚如何到达 ListBox ScrollViewer。显然，DataTrigger 中的 Path 不正确。

```
<Border Width={Binding Source={x:Static SystemParameters.ScrollWidth}}">
   <Border.Style>
      <Style>
         <Setter Property="Border.Visibility" Value="Visible"/>
         <Style.Triggers>
            <DataTrigger Binding="{Binding ElementName=listBox, 
                         Path=***ScrollViewer.ComputedVerticalScrollBarVisibility***}"
                         Value="Collapsed">
               <Setter Property="Border.Visibility" Value="Collapsed"/>
            </DataTrigger>
         </Style.Triggers>
      </Style>
   </Border.Style>
</Border>

<ListBox Name="listBox" ItemsSource="{Binding MyItems}"/> 
```

有没有办法获得那个 ListBox 属性？如果没有，有没有更好的方法来解决这个问题？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T15:07:56.647

将 ListBox 包装在另一个 ScrollViewer 中的解决方法允许以冗余 ScrollViewer 控件为代价的全 XAML 解决方案（请参阅问题中的评论）。最后，我的队友决定采用如下代码隐藏解决方案。

这是具有我们需要访问的 ScrollViewer 的 ListBox 的相关属性。

```
<ListBox Name="_listBox" ScrollViewer.HorizontalScrollBarVisibility="Disabled"
         Loaded="InitializeListBoxScrollViewerProperty"/> 
```

这是公开滚动查看器以供外部控件使用的代码隐藏。

```
private static readonly DependencyPropertyKey ListBoxScrollViewerPropertyKey =
   DependencyProperty.RegisterReadOnly("ListBoxScrollViewer", typeof(ScrollViewer),
   typeof(MyEditView), new PropertyMetadata());

protected static readonly DependencyProperty ListBoxScrollViewerProperty =
   ListBoxScrollViewerPropertyKey.DependencyProperty;

protected ScrollViewer ListBoxScrollViewer
{
   get { return (ScrollViewer)GetValue(ListBoxScrollViewerProperty); }
   private set { SetValue(ListBoxScrollViewerPropertyKey, value); }
}

private void InitializeListBoxScrollViewerProperty(object sender, RoutedEventArgs args)
{
   if (ReferenceEquals(args.OriginalSource, _listBox))
   {
      var scrollViewer = _listBox.GetFirstDescendantBreadthFirst<ScrollViewer>();
      if (scrollViewer != null)
      {
         ListBoxScrollViewer = scrollViewer;
      }
   }
} 
```

以下是使用的扩展方法：

```
public static class DependencyObjectExtensions
{
   public static TDescendant GetFirstDescendantBreadthFirst<TDescendant>
      (this DependencyObject dependencyObject) where TDescendant : DependencyObject
   {
      if (dependencyObject == null) { throw new ArgumentNullException(); }
      return GetFirstDescendantBreadthFirst<TDescendant>(GetAllChildren(dependencyObject));
   }

   private static TDescendant GetFirstDescendantBreadthFirst<TDescendant>
      (IEnumerable<DependencyObject> descendants) where TDescendant : DependencyObject
   {
      if (!descendants.Any()) return null;
      var descendant = descendants.OfType<TDescendant>().FirstOrDefault();
      if (descendant != null) return descendant;
      return GetFirstDescendantBreadthFirst<TDescendant>(descendants.SelectMany(GetAllChildren));
   }

   private static IEnumerable<DependencyObject> GetAllChildren(DependencyObject dependencyObject)
   {
      return Enumerable
         .Range(0, VisualTreeHelper.GetChildrenCount(dependencyObject))
         .Select(i => VisualTreeHelper.GetChild(dependencyObject, i));
   }
} 
```

最后，可以在 XAML 的另一部分访问滚动查看器。

```
<Grid>
   <Grid.Style>
      <Style TargetType="Grid">
         <Style.Triggers>
            <DataTrigger Binding="{Binding ListBoxScrollViewer.ComputedVerticalScrollBarVisibility,
               RelativeSource={RelativeSource AncestorType=l:MyEditView}}" Value="Visible">
               <Setter Property="Margin" Value="{StaticResource myWidenedMargin}"/>
            </DataTrigger>
         </Style.Triggers>
      </Style>
   </Grid.Style>
</Grid> 
```

# spring - 在 Spring MVC 中使用 PUT 和 DELETE 方法

> ID：13629653
> 
> 赞同：22
> 
> 时间：2012-11-29T15:57:49.377
> 
> 标签：spring, spring-mvc, http-post, http-delete, http-put

我正在尝试在 Spring MVC 控制器（版本 3.0.2）中使用`RequestMethod.PUT`和。`RequestMethod.DELETE`Spring 控制器类中有如下三种方法映射到一个 URL （分别为 PUT、GET 和 POST，仅用于演示目的）。

```
@RequestMapping(method = {RequestMethod.PUT}, value = {"admin_side/Temp"}, headers = {"content-type=multipart/form-data"})
public String update(@ModelAttribute("tempBean") TempBean tempBean, BindingResult error, Map model, HttpServletRequest request, HttpServletResponse response) {
    if (ServletFileUpload.isMultipartContent(request)) {
        System.out.println("true");
    }

    System.out.println("Request method PUT");
    return "admin_side/Temp";
}

@RequestMapping(method = {RequestMethod.GET}, value = {"admin_side/Temp"})
public String showForm(@ModelAttribute("tempBean") TempBean tempBean, BindingResult error, Map model, HttpServletRequest request, HttpServletResponse response) {
    System.out.println("Request method GET");
    return "admin_side/Temp";
}

@RequestMapping(method = {RequestMethod.POST}, value = {"admin_side/Temp"})
public String onSubmit(@ModelAttribute("tempBean") TempBean tempBean, BindingResult error, Map model, HttpServletRequest request, HttpServletResponse response) {
    System.out.println("Request method POST");
    return "admin_side/Temp";
} 
```

当页面被加载时，该`GET`方法被调用是显而易见的，但在所有其他情况下（当页面被提交时），唯一被调用的方法是`POST`，指定的方法`RequestMethod.PUT`永远不会被调用。

* * *

Spring 表单仅包含一个提交按钮和一个图像浏览器，

```
<form:form id="mainForm"
           name="mainForm"
           method="PUT"
           action="Temp.htm"
           enctype="multipart/form-data"
           commandName="tempBean">

    <input type="file" id="myFile" name="myFile"/>
    <input type="submit" id="btnSubmit" name="btnSubmit" value="Submit"/>
</form:form> 
```

生成的HTML如下，

```
<form id="mainForm"
      name="mainForm"
      action="Temp.htm"
      method="post"
      enctype="multipart/form-data">

    <input type="hidden" name="_method" value="PUT"/>
    <!--This hidden field is implicitly included-->

    <input type="file" id="myFile" name="myFile"/>
    <input type="submit" id="btnSubmit" name="btnSubmit" value="Submit"/>
</form> 
```

在我的`spring-config.xml`（`dispatcher-servlet.xml`就我而言）中，我添加了对以下内容的引用[`CommonsMultipartResolver`](https://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/multipart/commons/CommonsMultipartResolver.html)：

```
<bean id="filterMultipartResolver"
      class="org.springframework.web.multipart.commons.CommonsMultipartResolver"/> 
```

在我的`web.xml`文件中，[`HiddenHttpMethodFilter`](http://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/filter/HiddenHttpMethodFilter.html)配置如下，

```
<filter>
    <filter-name>MultipartFilter</filter-name>
    <filter-class>org.springframework.web.multipart.support.MultipartFilter</filter-class>
    <init-param>
        <param-name>multipartResolverBeanName</param-name>
        <param-value>filterMultipartResolver</param-value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>MultipartFilter</filter-name>
    <servlet-name>/*</servlet-name>
</filter-mapping>

<filter>
    <filter-name>HiddenHttpMethodFilter</filter-name>
    <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>HiddenHttpMethodFilter</filter-name>
    <servlet-name>/*</servlet-name>
</filter-mapping> 
```

( `PUT`and `DELETE`too) 方法永远不会被调用（没有异常或错误）。我在这里想念什么？

* * *

**更新 ：**

使用以下配置`web.xml`，

```
<filter>
    <filter-name>MultipartFilter</filter-name>
    <filter-class>org.springframework.web.multipart.support.MultipartFilter</filter-class>
    <init-param> <!-- Makes no difference, if excluded. -->
        <param-name>multipartResolverBeanName</param-name>
        <param-value>filterMultipartResolver</param-value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>MultipartFilter</filter-name>
    <servlet-name>dispatcher</servlet-name>  <!--Changed from /* to dispatcher-->
</filter-mapping>

<filter>
    <filter-name>HiddenHttpMethodFilter</filter-name>
    <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>HiddenHttpMethodFilter</filter-name>
    <servlet-name>dispatcher</servlet-name> <!--Changed from /* to dispatcher-->
</filter-mapping> 
```

**它引发以下异常。**

> org.springframework.beans.factory.NoSuchBeanDefinitionException：没有定义名为“filterMultipartResolver”的bean

其中名称`dispatcher`是 Servlet 的名称 -`org.springframework.web.servlet.DispatcherServlet`已在 web.xml 中映射，如下所示。

```
<servlet>
    <servlet-name>dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>2</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>dispatcher</servlet-name>
    <url-pattern>*.htm</url-pattern>
</servlet-mapping> 
```

我不确定还需要什么？过滤器是否[`HiddenHttpMethodFilter`](http://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/filter/HiddenHttpMethodFilter.html)需要在我们自己的扩展中实现，[`OncePerRequestFilter`](http://docs.spring.io/spring/docs/4.2.x/javadoc-api/org/springframework/web/filter/OncePerRequestFilter.html)例如[此处](http://code.google.com/p/parancoe/source/browse/parancoe-web/src/main/java/org/parancoe/web/filter/HiddenHttpMethodFilter.java?r=8d63b047e8218191390ffedb1b70e3f9ddc626c3)显示的过滤器？（它是一个内置类）

[此处](http://dev.anyframejava.org/docs.en/anyframe/plugin/springrest/1.0.2/reference/html/ch08.html)列出了要点。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-30T19:37:10.953

大多数浏览器不支持`action=PUT`HTML 表单。他们只会发送`POST`请求。HiddenHttpMethodFilter将帮助您解决问题，但您必须在表单中包含一个隐藏[字段](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/filter/HiddenHttpMethodFilter.html)`_method=PUT`。如果您使用 spring:form taglib 这将自动为您完成，但您的示例似乎使用纯 HTML。

这`NoSuchBeanDefinitionException`很可能是一个不相关的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-31T11:02:03.650

你应该改变你的配置。

```
<servlet-name>/*</servlet-name> 
```

到

```
<servlet-name>[dispatch servlet name]</servlet-name> 
```

# javascript - Facebook like 按钮导致网站不安全

> ID：13629657
> 
> 赞同：0
> 
> 时间：2012-11-29T15:58:00.723
> 
> 标签：javascript, facebook, security, twitter

我用 Volusion 建立了一个店面网站（*这令人沮丧*），他们只允许控制他们希望你控制的文件。这使得找到定制网站以及在您想要的地方获得 SEO 的变通方法变得有点棘手。我已经在网站上实现了 Facebook 喜欢/分享和 Twitter 按钮。为了保持按钮在所有页面上的位置一致（我想要它）是将它放在模板页面中；否则我必须把它放在每一页上（而且有很多）。

我遇到的问题是，由于将按钮放置在模板文件中，需要安全的页面（结帐、帐户等）已被破坏并且不再安全。我已经搜索了禁用按钮的 javascript 的方法，以便它不会运行，从而使其再次安全，但我没有找到。我可能一直在使用错误的关键字甚至错误的想法进行搜索。

对于禁用某些页面上的 Facebook 和 Twitter 按钮的任何帮助，甚至是另一种解决方法，我们将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:13:45.567

如果您在安全页面 (ssl) 上，您想签入 javascript？

```
document.location.protocol === 'https:' 
```

如果您使用的是非 ssl，则可以反过来运行您的脚本：

```
if(document.location.protocol === 'http:') {
  // run your script
} 
```

编辑：如果您使用此代码段（来自 facebook 网站），则不应出现 ssl 警告，因为您不使用协议（//connect.facebook ...）

```
 <div id="fb-root"></div>
 <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/de_DE/all.js#xfbml=1&appId=106146976149656";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script> 
```

如果你不这样做，请粘贴你如何渲染你的 fb 按钮

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T17:49:17.463

如果以下内容不能回答您的问题，请发布您的渲染代码。但一般来说，最有可能导致您的问题的原因是指向硬编码为“http://.../your_image.gif”的按钮图像的链接。这会导致页面不安全的警告，因为 http 链接未加密。

为了解决这个问题，您需要将正确的 url 方案硬编码到图像源中，或者动态确定运行时使用的 url 方案（http 或 https）并在图像 URL 中使用此方案。

例如，如果您的页面使用 HTTPS，则图像源必须是“https://.../your_image.gif”，这不会产生任何警告，因为整个页面都是安全的。如果您使用 http 前缀而不是 https，则会收到警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T16:30:37.160

无论如何，默认的 Like 按钮代码都应该在安全或不安全的页面上工作。这是通过使用 // 而不是 http:// 启动 Facebook 包含的 JS 来完成的。

你的代码是什么样的？

# r - 基于列输出数据框子集的有效方法

> ID：13629659
> 
> 赞同：1
> 
> 时间：2012-11-29T15:58:07.197
> 
> 标签：r

和

```
df <- data.frame(week = rep(1:7, each = 2), value = round(rnorm(14), 2)) 
```

我想每周`df`写成 7 个（取决于列）单独的文件作为一个文件。`week`例如：

```
1.tsv
1   0.49
1   1.04

2.tsv
2   0.40
2   0.97

...

7.tsv
7   -0.03
7   0.52 
```

我想出了这个：

```
for (wk in unique(df$week)) {
    write.table(df[df$week == wk, ]
          , file = paste(wk, ".tsv", sep = "")
          , sep = "\t", row.names = F, col.names = F, quote = F)
} 
```

但很好奇是否有更好的方法可以在不使用`for`循环的情况下完成这项工作。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T16:13:56.130

您通常可以使用`for`在函数循环中使用的相同构造，并与其中一个`apply`系列结合使用：

```
myfun <- function(wk) {
   write.table(df[df$week == wk, ]
          , file = paste(wk, ".tsv", sep = "")
          , sep = "\t", row.names = F, col.names = F, quote = F)
}

lapply(unique(df$week), myfun) 
```

但是，为了清楚起见，我认为`for`循环选项更好。此外，对于这样的操作，两者的速度将非常相似。家庭的真正优势`apply`是当您需要“增长”一个您事先无法知道其大小的数据结构时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T16:19:07.537

使用`split`and`Map`是一种选择。

```
df.split <- split(df, df$week)
invisible( # hide Map return value, just a list of NULLs.
    Map(write.table, x=df.split, file=paste(names(df.split), "tsv", sep="."), 
        row.names=F, col.names=F, quote=F)
) 
```

# javascript - 如何在 flash 和 javascript 之间传递数据

> ID：13629660
> 
> 赞同：0
> 
> 时间：2012-11-29T15:58:07.040
> 
> 标签：javascript, apache-flex

我有一个基于用户交互生成 xml 的 flash/flex 对象。我想将一个 xml 字符串传递给 javascript，以便它可以进行 Web 服务调用。

**如何将 XML 传递回 Javascript？**

例子：

html:

```
 <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"
                id="My">
 <param name="movie" value="My.swf" />
            <param name="quality" value="high" />
            <param name="bgcolor" value="#ffffff" />
            <param name="allowScriptAccess" value="sameDomain" />
            <param name="allowFullScreen" value="true" />
      </object> 
```

初始化的javascript

```
 var swfVersionStr = "10.2.0";
 var xiSwfUrlStr = "playerProductInstall.swf";
 var flashvars = {};

 var attributes = {};
 flashvars.servicePath = "services/";
 flashvars.isSaved = "false";
 flashvars.savedXML;
 var params=   {
            quality = "high";
            bgcolor = "#ffffff";
            allowscriptaccess = "sameDomain";
            allowfullscreen = "true";
            wmode = "transparent";
        };

  swfobject.embedSWF(
                "My.swf", "flashContent",
                "100%", "100%",
                swfVersionStr, xiSwfUrlStr,
                flashvars, params, attributes); 
```

Javascript 从 flash/flex 获取 XML

```
var flashObject = document.contentWindow.getFlashObject();
flashObject.saveXml();
var xmlFromFlex = flashObject.savedXML; /*This is where I don't know how to get/set*/ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T16:01:55.977

您需要使用**ExternalInterface.call**：

```
import flash.external.*; 
var JSvalue:String; 
JSvalue = ExternalInterface.call('JsTestFunction','Work_Damn_It'); 
```

更多信息[在这里](http://meshfields.de/externalinterface-call-as3-javascript/)

# wordpress - 从实时 [wordpress,magento] 站点创建 git 存储库，忽略核心 php 文件，但能够在多个本地服务器上克隆存储库

> ID：13629667
> 
> 赞同：0
> 
> 时间：2012-11-29T15:58:29.657
> 
> 标签：wordpress, git, magento, repository, localhost

所以我有很多网站，150 多个。从较大的站点开始，我开始设置 git 存储库以跟踪对这些站点的更改。我可以创建站点的本地服务器版本并设置存储库，一切运行良好。

我已经设置了一个 .gitignore 文件来忽略所有核心文件和插件文件夹等。这很好，这些文件仍然在我的本地机器上，并且已从我的存储库中删除。

我想做的是在多台计算机上设置这个存储库（我的同事做的开发工作较少，但仍需要访问存储库）。我想克隆将不起作用，因为所有核心文件都不再位于存储库中。我该如何解决这个问题？

谢谢大家！

编辑：

我应该提到我们正在使用 BitBucket 作为中央存储库，如果这有什么不同的话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:50:01.577

有几种方法可以做到这一点。

1.  您可以在一个位置设置本地环境，并将 git 存储库保存在另一个位置。克隆或拉取存储库后，您可以运行脚本，将文件从存储库复制到本地环境。

2.  您可以将所有文件添加到存储库，只忽略 var/、.htaccess、app/etc/local.xml 和 .gitignore。请记住，您可以通过更改不应更改的文件来破坏网站。然后调试就变成了一场噩梦。在 git 中完成所有操作后，您立即知道出了什么问题。

我们已经设法使用 beanstalk.com 建立了出色的工作流程。他们可以选择共享存储库（如 github），然后通过 SSH 将它们部署在不同的服务器上。像魅力一样工作 - 强烈推荐。

# javascript - 如何嵌套基于数组的异步函数？

> ID：13629672
> 
> 赞同：0
> 
> 时间：2012-11-29T15:58:38.377
> 
> 标签：javascript, node.js, asynchronous, plural

我有一个异步函数，它将它的回调分解为一个对象`success`，并且`error`这个函数需要一个参数（除了回调）`"pink"`。

```
async("pink",{
    success:function(){

    },
    error:function(){

    }
}); 
```

我想制作这个函数的复数版本，它接受一个数组并返回操作的`true`or`false`值`async`。

```
asyncs(["blue","red","green"],function(values){
    console.log(values); // [true,true,true];
}); 
```

诀窍是每个`acync`动作都需要在下一个动作中，函数（`true`或`false`）的值需要`pushed()`进入“全局”（范围更高）变量`values`，并在最后返回主控`callback(values)`（当`count`到达数组时） `length`)

这是嵌套每个`async()`函数并返回的一种非常基本的方法`values`，它是有限的，因为它仅手动跟踪`3`数组值。

```
var asyncs = function(params,mstrCB){
    var length = params.length;
    var values = [];
    async(param[0],{
        success:function(){
            values.push(true);
            async(param[1],{
                success:function(){
                    values.push(true);
                    async(param[2],{
                        success:function(){
                            values.push(true);
                            mstrCB(values);
                        },
                        error:function(){
                            values.push(false);
                            mstrCB(values);
                        }
                    });
                },
                error:function(){
                    values.push(false);
                     mstrCB(values);
                }
            });
        },
        error:function(){
            values.push(false);
            mstrCB(values);
        }
    });
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:06:46.920

使用计数器而不是手动嵌套。将请求放在自己的函数中，然后在 each`success`上增加计数器，如果小于`length`，则发出新请求。

时`i === length`，调用`mstrCB()`.

```
var asyncs = function(params,mstrCB){
    var length = params.length;
    var values = [];
    var i = 0;

    if (length)
        makeRequest();

    function makeRequest() {
        async(params[i], {
            success:function(){
                values.push(true);

                 // Increment the counter
                i++;

                if (i === length)  // we're at the end
                    mstrCB(values);
                else
                    makeRequest(); // there's still more, so make another request
            },
            error:function(){
                values.push(false);
                mstrCB(values);
            }
        });
    }
}; 
```

# html - 防止页面提交缓存

> ID：13629681
> 
> 赞同：0
> 
> 时间：2012-11-29T15:59:12.477
> 
> 标签：html, forms, caching, submit

出于安全原因，我们不希望存储某人提交的信息。例如，通过表单提交进入页面后，当我刷新时，它会询问我是否要再次发送相同的数据（至少在 Chrome 中）。

我们正在尝试创建一个会话式的行为。我们不维护服务器会话 - 登录后，用户会返回一个页面。由于一旦登录就没有其他页面可供用户导航（根本没有服务器调用），因此以这种方式处理它似乎更简单。但是，刷新页面允许重新提交数据，我们不希望这样。您也可以单击返回按钮，然后单击前进按钮，页面仍然存在，或者转到其他站点，然后返回按钮返回页面。

我找到`<meta http-equiv="CACHE-CONTROL" content="NO-CACHE">`了，但它似乎没有任何效果。

Javascript 解决方案是可以接受的，因为访问需要 javascript（不是我，不要射击信使）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:05:23.927

为了确保页面不会缓存，您还需要在文档底部放置另一组“HEAD”标签。

例如：

```
<HTML>
<HEAD>
<TITLE>No Cache</TITLE>
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Expires" CONTENT="-1">
</HEAD>
<BODY>

...

</BODY>
<HEAD>
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Expires" CONTENT="-1">
</HEAD>
</HTML> 
```

[资源](http://www.htmlgoodies.com/beyond/reference/article.php/3472881/So-You-Dont-Want-To-Cache-Huh.htm)

--**或**--

```
<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" /> 
```

指定的日期应该是过去的日期，以便浏览器立即丢弃缓存的副本或根本不缓存它。

# android - Android：出现软键盘时移动EditText

> ID：13629682
> 
> 赞同：3
> 
> 时间：2012-11-29T15:59:16.657
> 
> 标签：android, android-softkeyboard

有什么方法可以定义软键盘出现时视图向上移动的距离？在我的情况下，我的视图底部有一个用户名和一个密码 EditText，当用户现在单击用户名字段时，软键盘会出现并且视图会自动向上移动，以便您可以看到用户名 EditText。但随后用户无法看到密码 EditText，这有点违反直觉。当用户单击密码字段然后返回用户名字段时，一切看起来都像我想要的那样。

我正在使用 Android 2.3.3 API 级别 10

我确实添加了

```
android:windowSoftInputMode="adjustPan" 
```

在我的活动中，因为我不希望在键盘出现时调整视图的大小。

**不带键盘：**

![无键盘查看](../Images/9789354368972598eb3a3558d2eea70c.png)

**键盘和用户名焦点：**

![点击用户名后查看](../Images/1fd08279bde9027d070d84055c185a7c.png)

**单击密码后-单击用户名后也是所需的行为：**

![点击密码后查看](../Images/8e3a825df28375c2d09ad6f0a8cd007a.png)

# grep - 如何将 grep 结果发送到每个输入文件的不同输出文件中？

> ID：13629683
> 
> 赞同：1
> 
> 时间：2012-11-29T15:59:20.157
> 
> 标签：grep

我有一个包含文本文件的文件夹。我需要从这些文本文件中提取具有“BA”的行。我使用 grep 命令打印带有 BA 的行。我想将输出保存到另一个具有相同文件名的文件夹中。如何更改以下代码？

```
grep "  BA  "  dir/*.txt 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:01:09.347

```
for i in dir/*.txt; do
   grep "  BA  " $i > $newdir/`basename $i`
done 
```

注意[basename](http://ss64.com/bash/basename.html)的使用，它接受`dir/a.txt`（比如说）并返回`a.txt`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T19:57:44.303

听起来像是 GNU 并行的工作：

```
parallel --dry-run grep '"  BA  "' '{} > otherdir/{/}' ::: dir/{a,b,c}.txt 
```

输出：

```
grep "  BA  " dir/a.txt > otherdir/a.txt
grep "  BA  " dir/b.txt > otherdir/b.txt
grep "  BA  " dir/c.txt > otherdir/c.txt 
```

`--dry-run`当您对所看到的内容感到满意时移除。

`{}`被替换为之后的输入`:::`（这些也可以来自标准输入或文件），`{/}`是`{}`.

# c# - 特定于 ASP.NET Web API 中控制器的自定义委托处理程序

> ID：13629684
> 
> 赞同：14
> 
> 时间：2012-11-29T15:59:22.430
> 
> 标签：c#, .net-4.0, asp.net-web-api

我编写了一个自定义委托处理程序，它将自定义标头添加到响应中并在请求中检查。

我在 WebAPI 配置中添加了句柄

`config.MessageHandlers.Add(new customHandler());`

但这个问题适用于所有控制器。我需要应用特定于控制器的自定义标头。是否可以添加特定于控制器的自定义处理程序？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-29T16:08:02.457

在本文末尾，它解释了如何仅将处理程序应用于某些路由：[http](http://www.asp.net/web-api/overview/working-with-http/http-message-handlers) ://www.asp.net/web-api/overview/working-with-http/http-message-handlers 。您可能必须为您的控制器创建一个唯一的处理程序，以便它仅适用于该控制器。

```
 config.Routes.MapHttpRoute(
        name: "MyCustomHandlerRoute",
        routeTemplate: "api/MyController/{id}",
        defaults: new { controller = "MyController", id = RouteParameter.Optional },
        constraints: null,
        handler: HttpClientFactory.CreatePipeline(new HttpControllerDispatcher(config), new MyCustomDelegatingMessageHandlerA());
    ); 
```

关于每个路由消息处理程序的管道是什么样的，您可以查看[**此处**](http://blogs.msdn.com/cfs-filesystemfile.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-46-38-WebApiStackDiagramsNew/6428.ASP.NET_5F00_MVC4_5F00_WebAPI_5F00_StackDiagram_5F00_Future.jpg)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-29T16:33:44.093

您可以做的是使用每个路由消息处理程序，但在这里要小心。作为@Nick 在他的回答中链接的文章，您可以链接处理程序并确保`HttpControllerDispatcher`涉及。否则，您将无法进入 Controller 管道。

我喜欢的另一种选择是将`HttpControllerDispatcher`用作自定义处理程序的基类：

```
public class CustomerOrdersDispatcher : HttpControllerDispatcher {

    public CustomerOrdersDispatcher(HttpConfiguration config) 
        : base(config) {
    }

    protected override Task<HttpResponseMessage> SendAsync(
        HttpRequestMessage request, 
        CancellationToken cancellationToken) {

        // Do some stuff here...

        return base.SendAsync(request, cancellationToken);
    }
} 
```

在这里，您将如何注册它：

```
protected void Application_Start(object sender, EventArgs e) {

    var config = GlobalConfiguration.Configuration;

    config.Routes.MapHttpRoute(
        name: "CustomerOrdersHttpRoute",
        routeTemplate: "api/customers/{customerKey}/orders/{key}",
        defaults: new { controller = "CustomerOrders", key = RouteParameter.Optional },
        constraints: null,
        handler: new CustomerOrdersDispatcher(config)
    );

    config.MessageHandlers.Add(new SomeOtherHandler1());
    config.MessageHandlers.Add(new SomeOtherHandler2());
} 
```

在`SomeOtherHandler1`和`SomeOtherHandler2`被执行之后，您`CustomerOrdersDispatcher`将被执行为**CustomerOrdersHttpRoute**路由。因此，您可以看到您保留了默认处理程序行为并设置了一些全局处理程序，同时您也有一个特定于路由的处理程序。

这是我的完整实现`CustomerOrdersDispatcher`：[​​https://github.com/tugberkugurlu/AdvancedWebAPI/blob/master/PerRouteMHOwnershipSample/Dispatcher/CustomerOrdersDispatcher.cs](https://github.com/tugberkugurlu/AdvancedWebAPI/blob/master/PerRouteMHOwnershipSample/Dispatcher/CustomerOrdersDispatcher.cs)。

您也可以查看完整的示例应用程序源代码以了解其工作原理：[https ://github.com/tugberkugurlu/AdvancedWebAPI/tree/master/PerRouteMHOwnershipSample](https://github.com/tugberkugurlu/AdvancedWebAPI/tree/master/PerRouteMHOwnershipSample)

# javascript - jQuery 防止默认 - 在某些情况下似乎不起作用

> ID：13629689
> 
> 赞同：0
> 
> 时间：2012-11-29T15:59:29.383
> 
> 标签：javascript, jquery

我在各个地方都使用过`event.preventDefault()`，`event.stopPropagation()`但要让它发挥作用似乎总是有点困难。

我现在遇到了实例：-

```
$("#existing_Flavours").on("keydown", function(event){
    switch(event.which){
        case 9:
            //tab called permit
            break;
        default:
            event.preventDefault();
            event.stopPropagation();
    } // end switch
}); 
```

我希望制表键工作，但没有别的。

无休止地绕了这个圈子，无论如何我都无法阻止正常的击键发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:07:27.030

如果元素是动态的，则需要将事件委托给绑定 keydown 时实际存在的元素：

```
$(document).on("keydown", "#existing_Flavours", function(event){
   switch(event.which){
      case 9:
           //tab called permit
          break;
      default:
           //event.preventDefault();
           //event.stopPropagation();
           // or just use return false
           return false;
    }
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:04:08.153

我的猜测是它与哪些事件实际导致角色出现有关。我会尝试绑定以`keydown keyup keypress`确保您抓住所有这些。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-29T16:06:58.527

好吧，首先，我不太喜欢切换（可能这无关），尝试：

```
$("#existing_Flavours").live("keydown", function(event){
    var keyCode = event.keyCode || event.which; 

    if (keyCode != 9) { 
      event.preventDefault(); 
    }

}); 
```

# javascript - 使用 mootools 在页面上的数组迭代中出现未定义的 var 错误

> ID：13629690
> 
> 赞同：-1
> 
> 时间：2012-11-29T15:59:29.513
> 
> 标签：javascript, arrays, mootools

```
 var makeModelYearSelect = document.getElementById("<%= MakeModelYearFilterLB.ClientID %>").control;
 var selectedMakeModelYearItems = makeModelYearSelect.get_checkedItems();
 var selectedMakeModelYearItemIds = [];

 for (var index = 0; index < selectedMakeModelYearItems.length; index++) {
   selectedMakeModelYearItemIds.push(selectedMakeModelYearItem[index].get_value(index));
 } 
```

为什么这会触发一个错误`Microsoft JScript runtime error: 'selectedMakeModelYearItem' is undefined`？

Mootools 不允许我使用简单的 for...in 进行迭代。

我已经查看了周日的 6 种方式，所以我到底错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:00:52.523

因为`selectedMakeModelYearItem`是未定义的。

`selectedMakeModelYearItems`但不是。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-29T16:25:31.023

也许你尝试调用这个代码 berofe 页面已加载。在这种情况下，您尝试访问的选择标签不会呈现并且无法从 JavaScript 访问。你可以尝试类似的东西

```
window.addEventListener("load",
(function() {
return function setMakeModelYearFilter() {
        var makeModelYearSelect = document.getElementById("<%= MakeModelYearFilterLB.ClientID %>").control;
        var selectedMakeModelYearItems = makeModelYearSelect.get_checkedItems();
        var selectedMakeModelYearItemIds = [];

for (var index = 0; index < selectedMakeModelYearItems.length; index++) {
   selectedMakeModelYearItemIds.push(selectedMakeModelYearItem[index].get_value(index));
}
    window.removeEventListener('load', setMakeModelYearFilter, false);
}})()
, false); 
```

# android - 如何在 Android throun 代码中检索呼叫转移状态？

> ID：13629691
> 
> 赞同：7
> 
> 时间：2012-11-29T15:59:31.097
> 
> 标签：android, android-intent, phone-call

是否可以在 Android 上检索呼叫转移状态？

[![在此处输入图像描述](../Images/2ab40d89d4f269be839bf815e22469ef.png)](https://i.stack.imgur.com/RmhH6.png)

使用此代码仅显示当前状态的弹出窗口，但我想知道是否可以获取设置的实际数字（如果有）

```
Intent intentCallForward = new Intent(Intent.ACTION_CALL);                               
Uri uri = Uri.fromParts("tel", "*#21#", "#"); 
intentCallForward.setData(uri);                                
startActivity(intentCallForward); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-26T09:47:59.977

这很简单。您所需要的`BroadCast`只是跟踪您的手机状态。尝试这样的事情：

```
public class CallBroadcastReceiver extends BroadcastReceiver
{
    public static String numberToCall;
    public void onReceive(Context context, Intent intent) {
        Log.d("CallForwardingBroadCast", "CallBroadcastReceiver::onReceive got Intent: " + intent.toString());
        if (intent.getAction().equals(Intent.ACTION_NEW_OUTGOING_CALL)) {
            numberToCall = intent.getStringExtra(Intent.EXTRA_PHONE_NUMBER);
            Log.d("CallRecorder", "CallBroadcastReceiver intent has EXTRA_PHONE_NUMBER: " + numberToCall);
        }
    }
} 
```

# sql - 意外行为 - 在 FULL OUTER JOIN 中的“加入”字段中获取重复项

> ID：13629695
> 
> 赞同：0
> 
> 时间：2012-11-29T15:59:53.377
> 
> 标签：sql, sql-server-2008, tsql

我正在加入四个视图以在 ReportingMonth 上显示 A/R、销售额、存款等。但我在几个月里得到了重复。向下看，特别是 2014 年 1 月、2014 年 2 月、2012 年 12 月。

[![重复的月份](../Images/251c38692291370bfe0dcc8ccdd31b4d.png)](https://i.stack.imgur.com/x22g2.png)

是）我有的：

```
SELECT ISNULL(ISNULL(ISNULL(outf.ReportingMonth, sales.ReportingMonth), dep.ReportingMonth), ar.ReportingMonth) AS ReportingMonth
    ,ar.AR_100_Percent AS EndOfMonthARBalance
    ,ar.AR_85_Percent AS MLOCCeiling
    ,sales.MonthlySales AS Sales
    ,dep.Deposits
    ,outf.Outflow
    ,dep.Deposits + outf.Outflow AS CashPerformance
FROM vCI_MLOC_MONTHLYAR ar
FULL OUTER JOIN vCI_MLOC_MONTHLYSALES sales
ON ar.ReportingMonth = sales.ReportingMonth
FULL OUTER JOIN vCI_MLOC_MONTHLYDEPOSITS dep
ON sales.ReportingMonth = dep.ReportingMonth
FULL OUTER JOIN vCI_MLOC_MONTHLYOUTF outf
ON dep.ReportingMonth = outf.ReportingMonth
GROUP BY outf.ReportingMonth
    ,dep.ReportingMonth
    ,ar.ReportingMonth
    ,sales.ReportingMonth
    ,ar.AR_100_Percent
    ,ar.AR_85_Percent
    ,sales.MonthlySales
    ,dep.Deposits
    ,outf.Outflow 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:06:01.193

这样做时会遇到问题`full outer joins`，因为您最终会丢失关键列中的数据。

以下版本使用驱动程序表来获取所有月份，并对该表进行所有连接：

```
SELECT driver.ReportingMonth
    ,(other fields here)
FROM (select distinct ReportingMonth
      from ((select ReportingMonth
             from vCI_MLOC_MONTHLYAR
            ) union all
            (select ReportingMonth
             from vCI_MLOC_MONTHLYSALES
            ) union all
            (select ReportingMonth
             from vCI_MLOC_MONTHLYDEPOSITS
            ) union all
            (select ReportingMonth
             from vCI_MLOC_MONTHLYOUTF
            )
           ) t
     ) driver
FULL OUTER JOIN vCI_MLOC_MONTHLYAR ar on driver.ReportingMonth = ar.ReportingMonth
FULL OUTER JOIN vCI_MLOC_MONTHLYSALES sales
ON driver.ReportingMonth = sales.ReportingMonth
FULL OUTER JOIN vCI_MLOC_MONTHLYDEPOSITS dep
ON driver.ReportingMonth = dep.ReportingMonth
FULL OUTER JOIN vCI_MLOC_MONTHLYOUTF outf
ON driver.ReportingMonth = outf.ReportingMonth 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:04:53.967

用连接连接 4 个表（或视图，没关系）`FULL`很棘手。在第二次和第三次连接时，您尝试连接的某些列可能是`NULL`（由于第一次或第二次外连接）。

这是可能解决问题的方法。`FROM`将该子句替换为：

```
FROM vCI_MLOC_MONTHLYAR ar
  FULL OUTER JOIN vCI_MLOC_MONTHLYSALES sales
    ON ar.ReportingMonth = sales.ReportingMonth
  FULL OUTER JOIN vCI_MLOC_MONTHLYDEPOSITS dep
    ON COALESCE(ar.ReportingMonth, sales.ReportingMonth) 
       = dep.ReportingMonth
  FULL OUTER JOIN vCI_MLOC_MONTHLYOUTF outf
    ON COALESCE(ar.ReportingMonth, sales.ReportingMonth, dep.ReportingMonth) 
       = outf.ReportingMonth 
```

或与：

```
FROM 
        vCI_MLOC_MONTHLYAR ar
      FULL OUTER JOIN vCI_MLOC_MONTHLYSALES sales
          ON ar.ReportingMonth = sales.ReportingMonth
  FULL OUTER JOIN 
        vCI_MLOC_MONTHLYDEPOSITS dep
      FULL OUTER JOIN vCI_MLOC_MONTHLYOUTF outf
          ON dep.ReportingMonth = outf.ReportingMonth
    ON COALESCE(ar.ReportingMonth, sales.ReportingMonth)
     = COALESCE(dep.ReportingMonth, out.ReportingMonth) 
```

* * *

另一种解决方案是有一个`calendar`带有`ReportingMonth`列的表，或者如果没有，则动态创建它（类似于@Gordon 的解决方案）：

```
SELECT cal.ReportingMonth
       --- all the other columns do not change
FROM 
    ( SELECT ReportingMonth
      FROM vCI_MLOC_MONTHLYAR ar
    UNION 
      SELECT ReportingMonth
      FROM vCI_MLOC_MONTHLYSALES sales
    UNION 
      SELECT ReportingMonth
      FROM vCI_MLOC_MONTHLYDEPOSITS dep
    UNION 
      SELECT ReportingMonth
      FROM vCI_MLOC_MONTHLYOUTF outf
    ) AS cal
LEFT JOIN
    vCI_MLOC_MONTHLYAR ar
        ON ar   .ReportingMonth = cal.ReportingMonth
LEFT JOIN
    vCI_MLOC_MONTHLYSALES sales
        ON sales.ReportingMonth = cal.ReportingMonth
LEFT JOIN
    vCI_MLOC_MONTHLYDEPOSITS dep
        ON dep  .ReportingMonth = cal.ReportingMonth
LEFT JOIN
    vCI_MLOC_MONTHLYOUTF outf
        ON outf .ReportingMonth = cal.ReportingMonth 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T17:12:43.243

这也有效...

```
SELECT ReportingMonth
    ,SUM(EndOfMonthARBalance) AS EndOfMonthARBalance
    ,SUM(MLOCCeiling) AS MLOCCeiling
    ,SUM(Sales) AS Sales
    ,SUM(Deposits) AS Deposits
    ,SUM(Outflow) AS Outflow
    ,SUM(Deposits) + SUM(Outflow) AS CashPerformance

FROM(
    SELECT ReportingMonth AS ReportingMonth
         , NULL AS EndOfMonthARBalance
         , NULL AS MLOCCeiling
         , NULL AS Sales
         , NULL AS Deposits
         , Outflow AS Outflow
    FROM vCI_MLOC_MONTHLYOUTF

    UNION ALL
    SELECT ReportingMonth AS ReportingMonth
         , NULL AS EndOfMonthARBalance
         , NULL AS MLOCCeiling
         , MonthlySales AS Sales
         , NULL AS Deposits
         , NULL AS Outflow
    FROM vCI_MLOC_MONTHLYSALES

    UNION ALL
    SELECT ReportingMonth AS ReportingMonth
         , NULL AS EndOfMonthARBalance
         , NULL AS MLOCCeiling
         , NULL AS Sales
         , Deposits AS Deposits
         , NULL AS Outflow
    FROM vCI_MLOC_MONTHLYDEPOSITS

    UNION ALL  
    SELECT ReportingMonth AS ReportingMonth
         , AR_100_Percent AS EndOfMonthARBalance
         , AR_85_Percent AS MLOCCeiling
         , NULL AS Sales
         , NULL AS Deposits
         , NULL AS Outflow
    FROM vCI_MLOC_MONTHLYAR
) AS a    
GROUP BY ReportingMonth 
```

# java - 使用条件查询 Sum 和 GroupBy

> ID：13629701
> 
> 赞同：0
> 
> 时间：2012-11-29T16:00:18.027
> 
> 标签：java, database

我有下表：

```
Order(idOrder, address, cap, price, quantity, date, idProduct, idUser, idCountry) 
```

现在，我想要一个具有相同字段的表，其中字段数量是 idProduct 相同的数量之和。

例如，如果我有以下元组：

```
1, street1, 123, 4, 6, 2000-12-12, 1, 2, 3
2, street1, 123, 4, 1, 2000-12-12, 2, 2, 2
3, street1, 123, 4, 5, 2000-12-12, 2, 2, 2
4, street1, 123, 4, 1, 2000-12-12, 4, 2, 2 
```

我希望有：

```
1, street1, 123, 4, 6, 2000-12-12, 1, 2, 3
2, street1, 123, 4, 6, 2000-12-12, 2, 2, 2
4, street1, 123, 4, 1, 2000-12-12, 4, 2, 2 
```

我必须使用标准

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:06:17.200

对新表使用 group by 运算符...（如果问题特定于 DB...）

```
INSERT INTO NEW_TABLE (ID(may be auto generated), Select address, cap, price, sum(quantity), date, idProduct, idUser, idCountry from old_table group by address, cap, price, date, idProduct, idUser, idCountry ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:03:48.620

假设休眠：您需要使用预测来按标准应用分组。

例子：

```
 Criteria crit = session.createCriteria(Order.class);
    ProjectionList projList = Projections.projectionList();
    projList.add(Projections.groupProperty("quantity"));

    crit.setProjection(projList); 
```

有关更多信息，请参阅此[示例](http://www.java2s.com/Code/Java/Hibernate/CriteriaGroupByCriteria.htm)和[求和示例](http://www.kodejava.org/examples/400.html)。

# android - 正确使用9个补丁图像

> ID：13629702
> 
> 赞同：1
> 
> 时间：2012-11-29T16:00:26.300
> 
> 标签：android, android-layout, android-widget, android-image

我正在为我的应用程序进行布局设计，以解决多种屏幕尺寸问题。我参考了以下文件：

1.  [支持不同的密度](http://developer.android.com/training/multiscreen/screendensities.html)
2.  [支持不同的屏幕尺寸](http://developer.android.com/training/multiscreen/screensizes.html)
3.  [图标设计指南](http://developer.android.com/guide/practices/ui_guidelines/icon_design.html)和
4.  [绘制 9-patch](http://developer.android.com/tools/help/draw9patch.html)

我越是阅读这些文件，我就越感到困惑和纠结。虽然这可能已经在这里讨论过，但我认为我在这一点上需要专家的建议。

我发现的是：

1.  制作一组 9-patch 图像。

2.  制作适应性布局，让 Android 为我拉伸 9-patch 图像。

我的理解正确吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:04:18.010

对，那是正确的。适用于背景和简单图像的可调整布局和 9-patch。

请注意，如果您有复杂的图像，可能 9 个补丁不太适合它。将其转换为 xhdpi、hdpi、mdpi 和 ldpi 密度，就可以了。

好看 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:20:39.830

好吧，如果您想支持大多数可用设备，这并不容易；仅一组 9-patch 图像是不够的，除非您仅将它们用于背景图案。

对于每个密度文件夹，您至少需要一组 9-patch 图像，再加上经过深思熟虑的布局（对于大型和超大型设备可能会有所不同），以及对 Fragments 的良好使用，您可以设法开发一个不错的在大多数设备上寻找应用程序:)

# json - jquery 验证 onSubmit ajax 发布 JSON 响应

> ID：13629705
> 
> 赞同：1
> 
> 时间：2012-11-29T16:00:42.400
> 
> 标签：json, jquery, validation, return-value

我有一个非常复杂的帖子，使用 jquery 验证和一个 AJAX 帖子，它从服务器获取 JSON 响应并将其放入 jqGrid 中......但似乎我的 onsuccess 在任何时候都不会被调用......

```
$(document).ready(function () {
    $("#formSearchByMRN").validate({
        rules: {
            MRN: { required: true, minLength: 6 }
        },
        messages: {
            MRN: 'Please Enter a Valid MRN'
        },            
        submmitHandler: function (form) {
            e.preventDefault();
            animateLoad();
            debugger;                
            var theURL = form.action;
            var type = form.methd;
            var data = $(this).serialize();
            $.ajax({
                url: theURL,
                type: type,
                data: data,
                dataType: "json",
                success: function (result) {
                    debugger;
                    var data = result;
                    if (data.split(':')[0] == "Empty record") {
                        $("#list").unblock();
                        $('#resultDiv').html('<b><p style="color: #ff00ff">' + data + '</p></b>');
                        setTimeout(function () {
                            $('#resultDiv').html("");
                        }, 10000);
                    }
                    else {
                        binddata(data);
                    }
                }
            });
            return false;
        }
    });
}); 
```

看来我永远不会进入submmitHandler。事件虽然我设法访问我的服务器端函数并且它确实返回，但它会提示我的 UI 保存一个包含 JSON 结果的文件......不好。
我要在我的 AJAX 以错误的方式发布之前验证我的表单吗？有人对验证 AJAX 帖子的最佳实践有什么建议吗？

更新... MARK R. 这就是我尝试的。好像我从来没有进入成功功能......我怀疑我并不是真的通过 ajax 发布，而是在做一个完整的帖子。我不明白为什么。

```
$('#submitMRN').click(function () {
    $("#formSearchByMRN").validate({
        rules: {
            MRN: { required: true, minLength: 6 }
        },
        messages: {
            MRN: 'Please Enter a Valid MRN'
        }
    });
    if ($('#submitMRN').valid()) {
        $("#list").block({ message: '<img src="../../Images/ajax-loader.gif" />' });
        $.ajax({
            url: $('#submitMRN').action,
            type: $('#submitMRN').method,
            data: $('#submitMRN').serialize(),
            dataType: "json",
            success: function (result) {
                debugger;
                var data = result;
                if (data.split(':')[0] == "Empty record") {
                    $("#list").unblock();
                    $('#resultDiv').html('<b><p style="color: #ff00ff">' + data + '</p></b>');
                    setTimeout(function () {
                        $('#resultDiv').html("");
                    }, 10000);
                }
                else {
                    binddata(data);
                }
            }                    
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T19:20:46.173

```
 $('#SubmitButton').click(function (){
        //Check that the form is valid
        $('#FormName').validate(); 
        //If the Form is valid 
        if ($('#FormName').valid()) { 
            $.post(...........
        }
        else { 
            //let the user fix their probems
            return false; 
        }
    });//$('#SubmitButton').click(function (){ 
```

# javascript - TweenMax js 旋转未按预期工作

> ID：13629707
> 
> 赞同：1
> 
> 时间：2012-11-29T16:00:47.840
> 
> 标签：javascript, rotation, gsap

我有这段代码，它基本上定义了一个在转换结束时旋转图像的循环：http: [//jsfiddle.net/bolaoch8/k8XtU/1/](http://jsfiddle.net/bolaoch8/k8XtU/1/)

```
$('#avion').css('left', '0%');

var animacionAvion = TweenMax.to($('#avion'), 5, {css:{left:'100%'}, delay:0, repeat:-1, yoyo:true});

setInterval(giraAvion, 5000);

var rotationValue = 180;

function giraAvion()
{
    console.log('giraAvion a:', rotationValue);
    TweenMax.to($('#avion'), 0.8, {css:{transform:'rotate('+rotationValue+'deg)'}, delay:5});
    rotationValue == 180?rotationValue = 0:rotationValue = 180;
}
giraAvion(); 
```

只是想知道为什么图像第二次旋转它会做那种奇怪的事情......有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T16:34:07.020

我建议你使用 TimelineMax，它会帮助你链接补间： http: [//api.greensock.com/js/](http://api.greensock.com/js/)

它将使您的动画更简单。

```
var tl = new TimelineMax({repeat:-1});    
tl.to($('#avion'), 5, {css:{left:'100%'}});
tl.to($('#avion'), 0.8, {css:{rotation:180}});
tl.to($('#avion'), 5, {css:{left:'0%'}});
tl.to($('#avion'), 0.8, {css:{rotation:0}});
tl.play(); 
```

没有更多的间隔和功能！

我修改了你的 jsfiddle 以获得它的力量：http: [//jsfiddle.net/xavier_seignard/k8XtU/3/](http://jsfiddle.net/xavier_seignard/k8XtU/3/)

# java - 将 xjc 用于 SVG.xsd 时遇到问题

> ID：13629714
> 
> 赞同：0
> 
> 时间：2012-11-29T16:01:13.080
> 
> 标签：java, svg, jaxb, xjc

我正在使用 xjc.bat 为 svg 模式创建 jaxb 文件。

在命令行我输入：

`xjc [http://www.w3.org/TR/2002/WD-SVG11-20020108/SVG.xsd](http://www.w3.org/TR/2002/WD-SVG11-20020108/SVG.xsd) -verbose`

我的输出是： `parsing a schema... [ERROR] [http://www.w3.org/TR/2002/WD-SVG11-20020108/datatypes.dtd](http://www.w3.org/TR/2002/WD-SVG11-20020108/datatypes.dtd) unknown location`

`Failed to parse a schema.`

这是一个简单的问题，我不知道自己做错了什么，也找不到任何调查线索。

有谁知道如何正确运行它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T19:31:26.280

我在上一个问题中找到了答案：

[我在哪里可以找到有效的 SVG XML 模式（用于生成 ecore）？](https://stackoverflow.com/questions/3510986/where-can-i-find-a-valid-svg-xml-schema-for-ecore-generation)

如上所述，没有有效的 SVG 模式。

您可以通过运行以下命令生成 jaxb 类：

xjc -dtd [http://www.w3.org/Graphics/SVG/1.1/DTD/svg11-flat-20110816.dtd](http://www.w3.org/Graphics/SVG/1.1/DTD/svg11-flat-)

# php - 返回一个数组不像一个数组

> ID：13629717
> 
> 赞同：0
> 
> 时间：2012-11-29T16:01:27.803
> 
> 标签：php, arrays, return

我想知道为什么这不起作用。

至少从 PHP 5.3 开始，返回对象的函数或类方法就像一个对象。

```
<?php

class A {
function test() {
    echo "Yay!";
    }
}

function get_obj() {
    return new A();
}

function get_array() {
    return array("foo", "bar", "hallo", "world");
}

get_obj()->test();  // "works
echo get_array()[1]; // and this fails 
?> 
```

我在[http://php.net/manual/en/functions.returning-values.php找到了这个](http://php.net/manual/en/functions.returning-values.php)

有人会澄清为什么它不适用于数组但适用于对象。

编辑：

添加了 get_array()

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T16:04:39.567

函数数组解引用是在 PHP 5.4 中[添加](http://php.net/manual/en/migration54.new-features.php)的，所以除非你在 5.4+ 上，否则你必须这样做

```
$temp = get_array();
echo $temp[0]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:02:47.167

在`get_array()`某处定义？如果是这样，请粘贴该代码。

# c# - 用于访问的 SQL 语句的 OleDb 参数

> ID：13629726
> 
> 赞同：0
> 
> 时间：2012-11-29T16:01:51.680
> 
> 标签：c#, asp.net, ms-access, parameters, oledb

我一直在寻找和调试这段代码，但看不到任何错误。目前的错误是`No Value given for one or more required Parameters`

唯一需要的列是`prodName`并且始终检查以确保字符串不为空，否则它可能是我的整数和货币值的长度参数吗？我只是想让它们尽可能大以接受最合理大小的数据字段。

我还担心我的布尔值不适合“为空，不为空”类别，但如果未单击复选框，则会返回 false。

这是我的参数，如果你们简单地查看一下我可能犯的语法或逻辑错误，我将不胜感激，我在 c# 中相当中级

```
public int updateProducts(int prodId, string productName, string supplier, string category, string quantityPerUnit, string unitPrice, string unitsInStock, string unitsOnOrder, string reorderLevel, bool discontinued)
{
    int rows = 0;
    int PId = prodId;
    string prodName = productName;
    int supp = int.Parse(supplier);
    int? categoryID = 0;
    string qPerUnit = quantityPerUnit;
    Decimal? uPrice = 0;
    int? uInStock = 0;
    int? uOnOrder = 0;
    int? reorderLvl = 0;
    bool disc = discontinued;
    if (!string.IsNullOrWhiteSpace(unitPrice))
    {
        uPrice = Decimal.Parse(unitPrice);
    }
    if (!string.IsNullOrWhiteSpace(category))
    {
        categoryID = int.Parse(category);
    }
    if (!string.IsNullOrWhiteSpace(unitsInStock))
    {
        uInStock = int.Parse(unitsInStock);
    }
    if (!string.IsNullOrWhiteSpace(unitsOnOrder))
    {
        uOnOrder = int.Parse(unitsOnOrder);
    }
    if (!string.IsNullOrWhiteSpace(reorderLevel))
    {
        reorderLvl = int.Parse(reorderLevel);
    }

    string dbString = "UPDATE [Products] SET [ProductName]= ?,[Supplier]= ?,[Category]= ?,[QuantityPerUnit]= ?,[UnitPrice]= ?,[UnitsInStock]= ?,[UnitsOnOrder]= ?,[ReorderLevel]= ?, [Discontinued]= ? WHERE [SupplierID]= " + PId;

    try
    {
        conn.Open();
        oleCommand = new OleDbCommand(dbString, conn);

        oleCommand.Parameters.Add(new OleDbParameter("@prodName", OleDbType.VarChar, 30, ParameterDirection.Input, false, 10, 0, "ProductName", DataRowVersion.Original, null)).Value = prodName;
        oleCommand.Parameters.Add(new OleDbParameter("@supp", OleDbType.Integer, 40, ParameterDirection.Input, false, 10, 0, "Supplier", DataRowVersion.Original, null)).Value = supp;
        oleCommand.Parameters.Add(new OleDbParameter("@cat", OleDbType.Integer, 30, ParameterDirection.Input, true, 10, 0, "Category", DataRowVersion.Original, null)).Value = categoryID.HasValue ? (object)categoryID : DBNull.Value;
        oleCommand.Parameters.Add(new OleDbParameter("@qPU", OleDbType.VarChar, 20, ParameterDirection.Input, true, 10, 0, "QuantityPerUnit", DataRowVersion.Original, null)).Value = string.IsNullOrWhiteSpace(qPerUnit) ? DBNull.Value : (object)qPerUnit;
        oleCommand.Parameters.Add(new OleDbParameter("@uPrice", OleDbType.Currency, 6, ParameterDirection.Input, true, 10, 0, "UnitPrice", DataRowVersion.Original, null)).Value = uPrice.HasValue ? (object)uPrice : DBNull.Value;
        oleCommand.Parameters.Add(new OleDbParameter("@uInStock", OleDbType.Integer, 50, ParameterDirection.Input, true, 10, 0, "UnitsInStock", DataRowVersion.Original, null)).Value = uInStock.HasValue ? (object)uPrice : DBNull.Value;
        oleCommand.Parameters.Add(new OleDbParameter("@uOnOrder", OleDbType.Integer, 50, ParameterDirection.Input, true, 10, 0, "UnitsOnOrder", DataRowVersion.Original, null)).Value = uOnOrder.HasValue ? (object)uOnOrder : DBNull.Value;
        oleCommand.Parameters.Add(new OleDbParameter("@reorderLvl", OleDbType.Integer, 50, ParameterDirection.Input, true, 10, 10, "ReorderLevel", DataRowVersion.Original, null)).Value = reorderLvl.HasValue ? (object)reorderLvl : DBNull.Value;
        oleCommand.Parameters.Add(new OleDbParameter("@discontinued", OleDbType.Boolean, 10, ParameterDirection.Input, true, 10, 0, "Discontinued", DataRowVersion.Original, null)).Value = disc;
        rows = (int)oleCommand.ExecuteNonQuery();

    }
    catch (Exception ex)
    {
        dbError = "Add Supplier command Error: " + ex.Message;
    }
    finally
    {

        conn.Close();
    }
    return rows;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:14:33.087

是方括号。方括号表示 Jet Sql 的参数。但这也意味着“这个标识符里面有一个空格”

您的所有标识符都没有空格，因此只需删除方括号即可。如果您确实有带空格的标识符，则必须完全限定名称。

参考：[JET SQL for Access 2003](https://stackoverflow.com/questions/1386214/jet-sql-for-access-2003)

# iphone - iOS 核心数据对象模型在生产应用中的变化

> ID：13629730
> 
> 赞同：2
> 
> 时间：2012-11-29T16:02:08.027
> 
> 标签：iphone, ios, database, sqlite, core-data

我有一个目前正在生产使用的应用程序。我对该应用程序的核心数据模型的下一个版本进行了重大更改。

为了避免从旧数据模型到新数据模型的大量转换工作，我只是简单地重命名了新的对象模型和数据库，从而导致新版本的应用程序不再引用旧数据库（这不是问题，因为旧的数据库数据很小，不需要）。

但是，我确实需要旧数据库中的一条数据，并且我不希望用户需要手动将其重新输入到新数据库中。

我的问题：我有哪些选择可以将这条数据放入新数据库？

我可以对 sqlite 数据库运行查询并简单地输入新数据库吗？还是我需要创建一个完整的其他持久存储和对象模型来提取数据？

还是我一起错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:08:00.820

似乎您只需要在用户首次运行更新的应用程序时将数据复制到新数据库即可。那时你可能会清除旧的，所以它会占用空间。不知道还需要什么更复杂的解决方案。似乎足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:17:02.280

我同意，我认为您应该使用核心数据连接到旧数据库并提取数据，然后将其移动到新数据库。完成后，您应该使用以下内容删除旧的数据库文件（注意我假设您将核心数据结果存储到 SQLite 中）：

```
- (NSURL *)urlForDocumentsDirectoryWithFile:(NSString *)fileName {
    NSURL *docPath = [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject];
    return [docPath URLByAppendingPathComponent:fileName];
}

- (void)deleteFileFromDocumentsIfExists:(NSString *)fileName {
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSError *error;
    NSURL *filePath = [self urlForDocumentsDirectoryWithFile:fileName];
    NSLog(@"Deleting file: %@", filePath.absoluteString);
    if ([fileManager fileExistsAtPath:[filePath path]])
    {
        BOOL success = [fileManager removeItemAtURL:filePath error:&error];
        if (!success) NSLog(@"Error: %@", [error localizedDescription]);
    }
} 
```

删除代码：

```
[self deleteFileFromDocumentsIfExists:@"MyOldDatabaseName.sqlite"]; 
```

如果您只使用一次旧的对象模型，我不会担心拥有 2 个对象模型......永远。我可以看到在您的应用程序中“使用一次”代码是一种浪费，但即使跳过核心数据并手动查询仍然需要您拥有它。

另外，我有一个 DataAccessManager 单元，我将所有核心数据的荒谬初始化代码转储到其中，这样我就可以轻松访问多个上下文，如果您担心您正在手动编写所有内容，您可能希望将其移动到一个可共享的单元。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T18:58:20.363

感谢以上两个建议。我最终使用以下方法来解决我的问题：

脚步：

*   尝试连接到旧的 SQLite 数据库。
*   如果连接成功，读取记录。
*   在托管对象上下文中创建一个新的托管对象。
*   使用 sql 结果中的值填充托管对象中的值。
*   持久化托管对象。
*   删除旧数据库。

```
NSString *dbFilePath = [[self applicationDocumentsDirectoryString] stringByAppendingPathComponent:@"RPS.sqlite"];

sqlite3 *数据库；

if (sqlite3_open([dbFilePath UTF8String], &database)) {
    NSLog(@"sqlite3_open: 失败");
} 别的 {
    NSString *nsquery = [[NSString alloc] initWithFormat:@"SELECT * FROM ztable"];
    const char *query = [nsquery UTF8String];

    sqlite3_stmt *语句；
    int prepareCode = (sqlite3_prepare_v2(database, query, -1, &statement, NULL));
    如果（准备代码 == SQLITE_OK）{
        我的表 *myTableRecord;
        NSLog(@"即将开始添加数据");
        而（sqlite3_step（语句）== SQLITE_ROW）
        {
            NSLog(@"**************** 行返回 ******************");

            myObject = [NSEntityDescription insertNewObjectForEntityForName:@"myTable" inManagedObjectContext:self.managedObjectContext];

            [myTable setValue:[NSString stringWithFormat:@"%s",(char *)sqlite3_column_text(statement, 7)] forKey:@"field1"];
            [myTable setValue:[NSString stringWithFormat:@"%s",(char *)sqlite3_column_text(statement, 8)] forKey:@"field2"];

            [自我保存上下文];

        }

        sqlite3_finalize（语句）；
        NSLog(@"添加了 sqlite3 数据");
    } 别的 {
        NSLog(@"准备代码不正确：%d",prepareCode);
    }

    NSError *错误；
    NSFileManager *filemgr = [[NSFileManager alloc] init];
    [filemgr removeItemAtPath:dbFilePath 错误：&err];
    NSLog(@"删除了旧的 sqlite3 数据库");
}

```

# node.js - Tower.js - 如何使用缩小/组合资产管道？

> ID：13629732
> 
> 赞同：0
> 
> 时间：2012-11-29T16:02:10.240
> 
> 标签：node.js, assets, towerjs

我知道我必须创建一个`assets.coffee`文件来配置如何将文件编译和组合在一起以及运行蛋糕`assets:compile`来实际执行此操作。

但是，我试过了，我得到了消息：`No such task: assets:compile`

一个相关的问题 - Tower 是否还会处理将文件插入到实际 HTML 中（例如，布局、页眉或页脚视图）？因为每次编译的资源名称都是随机的，我无法想象它是某种手工工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T22:37:42.460

编译资产的命令是`cake assets:bundle`，[https](https://github.com/viatropos/tower/blob/master/test/example/Cakefile#L15) ://github.com/viatropos/tower/blob/master/test/example/Cakefile#L15 ，它运行这个方法：[https ://github.com/viatropos/tower/blob/ master/packages/tower-application/server/assets.coffee#L22](https://github.com/viatropos/tower/blob/master/packages/tower-application/server/assets.coffee#L22)

# opencv - 裁剪和旋转图片 OpenCV

> ID：13629737
> 
> 赞同：2
> 
> 时间：2012-11-29T16:02:30.630
> 
> 标签：opencv, rotation, crop

我是 OpenCV 的新手，所以请宽容。我正在做一个 Android 应用程序来识别正方形/矩形并裁剪它们。查找正方形/矩形的函数将找到的对象放入矢量>正方形。我只是想知道如何根据存储在vector> squares中的点中的数据裁剪图片，以及如何计算图片应该旋转的角度。感谢您的任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T17:46:40.463

这篇文章引用了[OpenCV QA：Extract a RotatedRect area](http://answers.opencv.org/question/497/extract-a-rotatedrect-area/)。

[Felix Abecassis](http://felix.abecassis.me)有一篇很棒的文章，关于旋转和去偏斜图像。这也向您展示了如何提取 RotatedRect 中的数据：

*   [http://felix.abecassis.me/2011/10/opencv-rotation-deskewing/](http://felix.abecassis.me/2011/10/opencv-rotation-deskewing/)

您基本上只需要[cv::getRotationMatrix2D](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#getrotationmatrix2d)来获取仿射变换的旋转矩阵，使用[cv::warpAffine](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#warpaffine)和[cv::getRectSubPix](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#getrectsubpix)来裁剪旋转的图像。我的应用程序中的相关行是：

```
// This is the RotatedRect, I got it from a contour for example...
RotatedRect rect = ...;
// matrices we'll use
Mat M, rotated, cropped;
// get angle and size from the bounding box
float angle = rect.angle;
Size rect_size = rect.size;
// thanks to http://felix.abecassis.me/2011/10/opencv-rotation-deskewing/
if (rect.angle < -45.) {
    angle += 90.0;
    swap(rect_size.width, rect_size.height);
}
// get the rotation matrix
M = getRotationMatrix2D(rect.center, angle, 1.0);
// perform the affine transformation on your image in src,
// the result is the rotated image in rotated. I am doing
// cubic interpolation here
warpAffine(src, rotated, M, src.size(), INTER_CUBIC);
// crop the resulting image, which is then given in cropped
getRectSubPix(rotated, rect_size, rect.center, cropped); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T11:12:22.813

周围有很多有用的帖子，我相信您可以进行更好的搜索。

庄稼：

*   [最有效地裁剪 IplImage](https://stackoverflow.com/a/12587204/176769)

旋转：

*   [OpenCV：如何旋转 IplImage？](https://stackoverflow.com/questions/2289690/opencv-how-to-rotate-iplimage)
*   [在 OpenCV 中旋转或调整图像大小](http://www.shervinemami.info/imageTransforms.html)

计算角度：

*   [OpenCV - 边界框和倾斜角](http://felix.abecassis.me/2011/10/opencv-bounding-box-skew-angle/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-26T00:55:55.920

虽然这个问题已经很老了，但我认为需要一个不像旋转整个图像那样昂贵的答案（参见@bytefish 的答案）。您将需要一个边界矩形，*由于某种原因`rotatedRect.boundingRect()`对我不起作用*，所以我不得不使用`Imgproc.boundingRect(contour)`. 这是适用于 Android 的 OpenCV，其他环境的操作几乎相同：

```
Rect roi = Imgproc.boundingRect(contour);
// we only work with a submat, not the whole image:
Mat mat = image.submat(roi); 
RotatedRect rotatedRect = Imgproc.minAreaRect(new MatOfPoint2f(contour.toArray()));
Mat rot = Imgproc.getRotationMatrix2D(rotatedRect.center, rotatedRect.angle, 1.0);
// rotate using the center of the roi
double[] rot_0_2 = rot.get(0, 2);
for (int i = 0; i < rot_0_2.length; i++) {
    rot_0_2[i] += rotatedRect.size.width / 2 - rotatedRect.center.x;
}
rot.put(0, 2, rot_0_2);
double[] rot_1_2 = rot.get(1, 2);
for (int i = 0; i < rot_1_2.length; i++) {
    rot_1_2[i] += rotatedRect.size.height / 2 - rotatedRect.center.y;
}
rot.put(1, 2, rot_1_2);
// final rotated and cropped image:
Mat rotated = new Mat();
Imgproc.warpAffine(mat, rotated, rot, rotatedRect.size); 
```

# c# - 如何在c#中完成一项任务后停止所有任务

> ID：13629742
> 
> 赞同：5
> 
> 时间：2012-11-29T16:02:41.173
> 
> 标签：c#, parallel-processing, task, multiprocessing

我有不同的任务要从不同的文件中读取并在其中找到一个单词。我已将它们放入一个任务数组中，我以 waitAny 方法开始，如下所示：

```
foreach (string file in filesList)
        {
            files[i] = Task.Factory.StartNew(() =>
            {
                mySearch.Invoke(file);
            });
            i++;
        }
        System.Threading.Tasks.Task.WaitAny(files); 
```

我想在其中一项任务完成后立即停止所有其他任务（它在找到单词时完成）。目前，使用waitany，我可以知道一项任务何时完成，但我不知道如何知道哪一项已完成以及如何停止其他任务。实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:07:54.943

您可以使用`CancellationToken`所有任务将共享的单个。内部`mySearch.Invoke`方法验证`token.IsCancellationRequested`取消任务的值。当某些任务完成时，通过取消其他任务`CancellationTokenSource.Cancel()`。

```
var tokenSource = new CancellationTokenSource();
var token = tokenSource.Token; 

foreach (string file in filesList)
{
   // pass cancellation token to your task
   files[i] = Task.Factory.StartNew(() => mySearch.Invoke(file, token), token);
   i++;
}

Task.WaitAny(files);
tokenSource.Cancel(); 
```

*顺便说一句*`OperationCanceledException`，您可以通过调用取消源时强制抛出令牌`token.ThrowIfCancellationRequested()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T16:08:17.277

创建任务时，您可以传递**[CancelationToken](http://social.msdn.microsoft.com/Forums/en-US/parallelextensions/thread/c2f614f6-c96c-4821-84cc-050b21aaee45)**。当其中一项任务完成时设置此令牌。这将导致具有此令牌的剩余任务[无法执行](https://stackoverflow.com/a/3713113/1379664)。正在运行的任务也可以接收`OperationCanceledException`并停止。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T16:09:49.443

我强烈建议阅读[如何取消不可取消的异步操作？](http://blogs.msdn.com/b/pfxteam/archive/2012/10/05/how-do-i-cancel-non-cancelable-async-operations.aspx)斯蒂芬·图布。本质上，您需要做的是取消所有这些任务，但目前您没有取消它们的机制。

理想的方法是`CancellationTokenSource`在 foreach 之前创建一个，将`CancellationToken`来自该源的 传递给每个子任务，定期检查该令牌并在您注意到它被指示取消时停止工作。然后，您可以继续取消令牌源`WhenAny`。

如果这不是一个选项，您需要决定是否真正停止任务很重要（这实际上是无法完成的），或者您是否只需要继续编写代码而不等待它们完成（这很容易去做）。

# java - 传输文件的协议

> ID：13629750
> 
> 赞同：0
> 
> 时间：2012-11-29T16:03:08.217
> 
> 标签：java, io, protocols, network-protocols

您如何决定使用哪种协议来跨服务器传输/移动/复制文件？我正在编写一项服务来将文件从 Windows 服务器文件系统复制到基于 oracle 的数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:07:00.833

用于传输文件的[文件传输协议](http://en.wikipedia.org/wiki/File_Transfer_Protocol)怎么样。

由于 Oracle 不存储文件，我怀疑您需要的不仅仅是传输文件。我怀疑无论如何你都需要使用 JDBC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:46:27.907

我不确定你正在构建什么，为什么它是一个 java 问题？

您是否需要在 Java 中实现自定义协议来传输您正在构建的 Web 服务的文件？或者您可以使用现成的产品和一堆 shell 脚本来处理文件传输吗？

如果这是您需要在 Java 中构建的自定义内容（问题用 java 标记），那么还有更多问题：

它是一个为最终用户提供允许他们提交文件的 GUI 的 Web 应用程序吗？- 您需要使用 http post 处理文件传输。Apache httpclient 库可以帮助您。

1.  是否是将传入数据保存到 oracle 的 SOAP Web 服务？
      - 然后 SOAP 实现再次提供了答案。

2.  它是在 Windows 机器上运行的与 Oracle 数据库对话的命令行工具吗？
      -then 协议无关紧要，因为您可以使用 file.io 库读取文件并使用 jdbc 将它们保存到 oracle 中。

3.  它是具有尚未构建协议的自定义服务器以及随后将使用该协议的自定义客户端吗？
      - 然后我将使用 https 上的二进制文件来实现自定义服务器/服务。

4.如果您使用COTS 做任何事情，FTP 简单快速，但不安全且不可靠。SFTP 几乎总是会变得更好。 [http://geekswithblogs.net/bvamsi/archive/2006/03/23/73147.aspx](http://geekswithblogs.net/bvamsi/archive/2006/03/23/73147.aspx)

5.如果您的问题真的是关于如何使用 jdbc 将文件保存到 Oracle 数据库中，那么您需要找到一种方法来流式传输它们（否则您将耗尽内存）。

例如，这可能会有所帮助[http://www.coderanch.com/t/415625/JDBC/databases/save-files-oracle-database-java](http://www.coderanch.com/t/415625/JDBC/databases/save-files-oracle-database-java)

# vb.net - EWS Exchange 服务无需确认即可在账户中进行预约

> ID：13629757
> 
> 赞同：0
> 
> 时间：2012-11-29T16:03:26.607
> 
> 标签：vb.net, exchangewebservices

每次我预约时，它都会转换为会议，所以我调整了我的代码以将预约发送到 SendInvitationsMode.SendToNone 因为我读到当你使用与会者时它将成为会议，但现在我需要将预约发送到 EmailAdres2 而无需 EmailAdres2确认我知道这样它会保存在 Emailadres 但我需要它在 EmailAdres2 上（Emailadres 有所有特权写约会到 EmailAdres2）

```
Dim _service As New ExchangeService(ExchangeVersion.Exchange2010_SP1)
_service.UseDefaultCredentials = False
_service.Credentials = New WebCredentials(Emailadres, Password)
_service.AutodiscoverUrl(EmailAdres2)
_service.TraceEnabled = False
Dim _appointment As New Appointment(_service)
_appointment.Subject = onderwerp

_appointment.Body = "Nieuw Afspraak <br><br> deb_nr en Klant: " & deb_nr & ": " & Label16.Text & " <br> Locatie: " & Label18.Text & " in " & Label17.Text & " <br><br>Omschrijving: " & onderwerp & " <br><br>Telefoon 1: " & tel1 & "<br>Telefoon 2: " & tel2 & "<br>Telefoon 3: " & tel3 & ""

                _appointment.Start = datum
                _appointment.[End] = _appointment.Start.AddHours(endhours)
                _appointment.ReminderMinutesBeforeStart = reminder
                _appointment.Location = Label16.Text & " " & adres
                _appointment.Save(SendInvitationsMode.SendToNone) 
```

您需要为每个电子邮件地址找到正确的文件夹，因此首先像这样连接，然后找到像这样的正确文件夹。

```
Dim _service As New ExchangeService(ExchangeVersion.Exchange2010_SP1)
_service.UseDefaultCredentials = False
_service.Credentials = New WebCredentials("email", "password")
_service.AutodiscoverUrl("email")

Dim mbox As New Mailbox(email)
Dim folder As New FolderId(WellKnownFolderName.Calendar, mbox) 
```

如果您只发送给 1 个人而不是主要电子邮件地址，请使用 send to none

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T14:28:15.053

我认为您需要的是模拟 EmailAdres2 并为其创建约会。你可以这样做

```
 _service.ImpersonatedUserId = new ImpersonatedUserId(ConnectingIdType.SmtpAddress, Emailadres2); 
```

注意：您需要从 Exchange 服务器配置中启用 Emailadres2 的模拟。

# testing - Grails 自定义标记库在集成测试期间无法使用自定义工件

> ID：13629765
> 
> 赞同：1
> 
> 时间：2012-11-29T16:03:57.873
> 
> 标签：testing, grails, grails-plugin, taglib, grails-2.0

我编写了一个包含自定义 TagLib 的插件，该插件本身使用自定义人工制品实例。当插件包含在应用程序中时，标签库的工作方式与预期完全一样。但是，我无法为它编写集成测试。

假设自定义人工制品类型是“Foo”，人工制品处理程序类是`FooArtefactHandler`

（简化的）`FooTagLib`类如下所示：

```
class FooTagLib {

    static namespace = "bar"

    def eachFoo = { attrs, body ->
        grailsApplication.fooClasses.each { foo ->
            out << body()
        }
    }
} 
```

关联的`FooTagLibTests`类如下所示：

```
import grails.test.mixin.*

@TestFor(FooTagLib)
class FooTagLibTests {

    void testEachFoo() {
        grailsApplication.registerArtefactHandler(new FooArtefactHandler())
        // Classes AFoo and BFoo are in the test/integration folder
        grailsApplication.addArtefact(FooArtefactHandler.TYPE, AFoo)
        grailsApplication.addArtefact(FooArtefactHandler.TYPE, BFoo)
        // just to check if artefacts are correctly loaded
        assert grailsApplication.fooClasses.length == 2

        assert applyTemplate("<bar:eachFoo>baz</bar:eachFoo>") == "bazbaz"
    }
} 
```

当我运行这个测试时，结果如下：

```
| Failure:  testeachFoo(com.my.package.FooTagLibTests)
|  org.codehaus.groovy.grails.web.taglib.exceptions.GrailsTagException: Error executing tag <bar:eachFoo>: No such property: fooClasses for class: org.codehaus.groovy.grails.commons.DefaultGrailsApplication 
```

taglib 中的`grailsApplication`似乎与测试中的实例不同。谁可以给我解释一下这个？我在这里做错什么了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T17:49:08.947

如果这是一个集成测试，您不应该使用`@TestFor`，而是扩展`GroovyPagesTestCase`并声明 grailsApplication：

```
class FooTagLibTests extends GroovyPagesTestCase {

    def grailsApplication

    void testEachFoo() {
        grailsApplication.registerArtefactHandler(new FooArtefactHandler())
        // Classes AFoo and BFoo are in the test/integration folder
        grailsApplication.addArtefact(FooArtefactHandler.TYPE, AFoo)
        grailsApplication.addArtefact(FooArtefactHandler.TYPE, BFoo)
        // just to check if artefacts are correctly loaded
        assert grailsApplication.fooClasses.length == 2

        assert applyTemplate("<bar:eachFoo>baz</bar:eachFoo>") == "bazbaz"
    }
} 
```

这是因为 TestFor 注释将模拟 grailsApplication 的实例（用于单元测试）。

# android - 如何延迟活动直到用户接受警报对话框

> ID：13629772
> 
> 赞同：0
> 
> 时间：2012-11-29T16:04:17.447
> 
> 标签：android, delay, android-alertdialog, oncreate

我有一个测验应用程序。我希望用户从警报对话框中选择问题类型。所以警报对话框有一个复选框按钮，所以如果用户可以选择更多然后类型。当用户单击警报对话框中的肯定按钮时，它将向 if 条件发送信息，然后条件将过滤问题，然后将其传递给数组。问题是它在 oncreate 内部的数组，我希望警报对话框在同一个类中，所以当我运行类时 oncreate 将启动并且我得到空异常，因为我没有将任何信息传递给数组。我如何才能延迟 oncreate() 并使其仅在用户单击警报对话框的正按钮后才加载。警报对话框将在同一类中。那么我该怎么做呢？是否可以？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:11:07.913

[onCreate() 是根据android 活动生命周期](http://developer.android.com/guide/components/activities.html)创建活动时第一个调用的，所以，不。如果您不希望它启动，除非他们单击“确定”，否则我不确定为什么您希望它在同一个活动中。把它放在它自己的班级或以前的活动中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:25:34.190

不，您不能，如果您尝试在活动中延迟 OnCreate() 方法中的某些内容，它将引发异常，因为您当时没有上下文来放置警报对话框。正如 codeMagic 之前所说，如果您在此之前有一个先前的活动，最好的办法是在调用 startActivity 之前创建警报。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T16:45:56.077

我建议在这种情况下使用[Fragments 。](http://developer.android.com/guide/components/fragments.html)加载 Activty，显示对话框并根据答案显示“正确答案片段”或“无效答案片段”。使用此解决方案加载活动（无需延迟），您只需动态更改活动的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T16:09:29.667

尝试使用*AsyncTask*类。onPostExecute方法可能会*完成*您正在寻找的工作..

# core-animation - 通过添加和删除 NSLayoutConstraints 来制作动画，而不是调整常量

> ID：13629780
> 
> 赞同：6
> 
> 时间：2012-11-29T16:04:52.807
> 
> 标签：core-animation, osx-mountain-lion, autolayout, nslayoutconstraint

我有一个 NSButton，它的底部与其父视图齐平，我想动画它向上移动，使其顶部与其父视图齐平。

WWDC 2012 Session 228: Best Practices for Mastering Auto Layout 提到了两种动画布局更改的方法 (31:16)，我正在尝试使用 CoreAnimation 技术。下面的示例确实正确地移动了 NSButton，但它是立即移动的，并且没有动画。

```
[button.superview removeConstraint:pointerToBottomSpaceConstraint] ;
NSArray* topSpaceConstraintArray = [NSLayoutConstraint constraintsWithVisualFormat: @"V:|[button]"
                                                                           options: 0
                                                                           metrics: nil
                                                                             views: NSDictionaryOfVariableBindings(button)] ;
[button.superview addConstraints:topSpaceConstraintArray] ;
[NSAnimationContext runAnimationGroup:^(NSAnimationContext* context) {
    context.duration = 2 ;
    context.allowsImplicitAnimation = YES ;
    [button.superview layoutSubtreeIfNeeded] ;
} completionHandler:nil] ; 
```

我可以添加和删除 NSLayoutConstraints 并让 CoreAnimation 弄清楚如何为更改设置动画吗？这似乎比我确定按钮的旧位置和新位置之间的距离要简单，然后将 NSLayoutConstraint 的常量调整该数量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-01T23:57:44.883

添加后`button.superview.wantsLayer = YES`，上面的示例动画正确。

# domain-driven-design - 富域模型的缺点

> ID：13629784
> 
> 赞同：0
> 
> 时间：2012-11-29T16:05:10.000
> 
> 标签：domain-driven-design, design-patterns

我正在阅读有关贫血的领域模型是一种反模式的内容，我对此有一些疑问。我有一个数据库，其中三个客户使用，每个客户都有不同的业务规则来将产品插入数据库。因此，如果我使用富域模型，我的代码将是这样的：

```
public class Product: IValidatableObject
{
     public int Id;
     public Client Client;
     public int ClientId;

     public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
     {
          if (ClientId == 1)
               DoValidationForClientOne();
          else if (ClientId == 2)
               DoValidationForClientTwo();
          else if (ClientId == 3)
               DoValidationForClientThree();
     }
} 
```

好吧，这很可怕，不是吗？现在，如果我有一个贫乏的领域模型，我可以简单地创建三个服务层类，其中每个类都包含对一个特定客户端的验证。不是很好吗？

我的第二个论点是：如果我有一个桌面和一个使用相同富域模型的 Web 应用程序，我怎么知道何时抛出 HttpException 以及何时抛出一些桌面异常？分开不是更好吗？那么，最后，为什么在我的项目中这种情况下，贫血的领域模型是一种反模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T13:51:22.427

1.  如前所述 - 您只显示了 DTO，而不是域实体。
2.  在 DDD 中，您将有一些直接在 Product 实体中的恒定规则和一些 ProductPolicies 来封装在不同上下文中处理产品时可能不同的内容。可怕？不，美丽而强大。但前提是您的域足够复杂。如果不是 - 使用贫血模型。
3.  您的域不应该依赖于任何东西。不应该对 Web 平台、桌面平台、正在使用的 ORM、正在使用的 DI 容器一无所知。所以如果抛出异常，应该是域自定义异常。阅读洋葱架构或六边形架构以获得更详细的解释：http: [//jeffreypalermo.com/blog/the-onion-architecture-part-1/](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:55:32.487

AnaemicDomainModel 有它的位置：[https ://softwareengineering.stackexchange.com/questions/160782/are-factors-such-as-intellisense-support-and-strong-typing-enough-to-justify-the](https://softwareengineering.stackexchange.com/questions/160782/are-factors-such-as-intellisense-support-and-strong-typing-enough-to-justify-the)

您的域模型不应该抛出特定于演示平台的异常。让您的演示文稿代码解决这个问题。您的目标应该是使您的域模型与其表示无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-15T06:43:53.207

我将推荐以下内容：

*   定义`IProductValidator`接口，并提供3个实现：

    ```
    interface IProductValidator {
        void validateProduct(Product product);
    } 
    ```

*   更改`Client`类，并为其添加以下方法

    ```
    class Client {
        void validateProduct(Product product) {
            getProductValidator().validate(product);
        }

        IProductValidator getProductValidator() {
           // this method returns validator, and it's better the method 
           // be abstract, and be implemented in sub-classes according 
           // to their type
        }

    } 
    ```

*   并将`Product`类更改为：

    ```
    public class Product: IValidatableObject {
        public int Id;
        public Client client;

        public IEnumerable<ValidationResult> Validate(ValidationContext validationContext) {
            client.validate(this);
        }
    } 
    ```

现在你

# .net - 类成员的内存分配

> ID：13629786
> 
> 赞同：0
> 
> 时间：2012-11-29T16:05:11.613
> 
> 标签：.net

我有以下课程：

```
public class A
{
   int i;
 } 
```

当我创建和类对象如下：

```
 A obj=new A(); 
```

我可以理解对象是在堆中分配的。现在这个类得到了一个整数变量。成员变量“i”在哪里分配（在堆栈或堆中）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:08:38.930

`i`是一个字段，因此它是实例本身的一部分。由于实例在堆上，并且由`i`... 组成，因此`i`在堆上。

这对于类型来说变得更加有趣`struct`，因为实例（值）几乎可以在任何地方，因此`i`可以在任何地方。您只能说“在实例内部”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:08:55.380

> 成员变量“i”在哪里分配（在堆栈或堆中）？

它在堆上——它是对象内存的一部分。（如果变量*最终没有*成为对象数据的一部分，您希望对象的数据由什么组成？）

当然，正如 Eric Lippert 所指出的，堆栈是一个实现细节（[第一部分](http://blogs.msdn.com/b/ericlippert/archive/2009/04/27/the-stack-is-an-implementation-detail.aspx)；`[part two][2]`）。通常你不应该太担心它。在实践中，越来越多的局部变量开始在堆上分配：

*   迭代器块
*   为匿名函数捕获的变量
*   异步方法

我还没有看到太多相反的证据，尽管未来的 CLR 可能会使用转义分析来证明特定对象永远不必*在*堆上分配，而是在堆栈上分配。（我相信一些 JVM 会这样做。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-01T15:20:58.817

所有类成员都将进入堆并继续分配内存。方法中的所有变量（局部变量）都分配在堆栈上。

# android - 在 Android 2.2 上的 ActionBarSherlock 中用作自定义视图时的微调器下拉样式

> ID：13629788
> 
> 赞同：1
> 
> 时间：2012-11-29T16:05:13.483
> 
> 标签：android, android-actionbar, actionbarsherlock, android-spinner

我正在使用 ActionBarSherlock。在我的应用程序中，我需要在操作栏中使用 2 个微调器，因此我使用列表导航 + 添加第二个微调器和自定义视图。

我使用以下代码将微调器添加到自定义视图：

```
ActionBar bar = getSupportActionBar();

// FALLBACK: Use native actionbar dropdown style for 11+ API. Or use ActionBarSherlock style.
int dropDownStyle = (VERSION.SDK_INT < 11) ? R.attr.actionDropDownStyle : android.R.attr.actionDropDownStyle;           

MyAdapter someAdapter = new MyAdapter(this, list);          

Spinner mySpinner = new Spinner(this, null, dropDownStyle);                    
mySpinner.setAdapter(someAdapter);        
mySpinner.setOnItemSelectedListener(this);

bar.setCustomView(mySpinner);
bar.setDisplayShowCustomEnabled(true); 
```

在 Android 4.0.3 上一切正常。

**Android 2.2 行为**：

列表导航微调器在 Android 4.0.4 上看起来像（作为下拉菜单）。但是自定义视图中的微调器在微调器视图单击时显示对话框而不是下拉列表。

所以**我需要在 Android 2.2 上的自定义视图中显示 Spinner 作为下拉菜单，**就像在 Android 4.0.4 上一样。

![在此处输入图像描述](../Images/07d38f4585f346aa4d61530df037b6ae.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T16:30:20.713

ActionBarSherlock 使用自定义微调器控件 ，`IcsSpinner`它提供下拉功能。虽然这确实存在于`internal`包中，但它是一个公共类，因此您可以切换代码以使用它。这应该为您提供列表导航控件使用的下拉列表的精确镜像。

但是，请记住，此控件并非设计用于任何地方，而是用作内置列表导航，因此可能缺少您想要的功能或特性。

# css - 如何在固定父级中居中相对层？

> ID：13629789
> 
> 赞同：0
> 
> 时间：2012-11-29T16:05:16.827
> 
> 标签：css, css-position

```
#mbFrameHolder {
  background: rgba(0, 0, 0, 0.8);
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}

#mbFrame {
  position: relative;
  top: 50%;
  left: 50%;
  width: 300px;
  height: 300px;
  margin-top: -150px;
  margin-left: -150px;
  background: #FFF;
}
```

```
<div id="mbFrameHolder">
  <div id="mbFrame">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer elementum, dolor in tincidunt facilisis, nisl ligula cursus nibh, a rutrum sapien justo et lorem.
  </div>
</div>
```

如何在上面的代码中居中内层？CSS 在 FF 和 IE 中有效，但在 Chrome 和 Safari 中无效。 [http://jsfiddle.net/HVHxq/](http://jsfiddle.net/HVHxq/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:22:31.773

您需要`absolute`在 #mbFrame 上使用定位，而不是`relative`.

示例：http: [//jsfiddle.net/HVHxq/16/](http://jsfiddle.net/HVHxq/16/)

# cordova - phonegap ios plugin notificationEx CDVPlugin.h 文件未找到

> ID：13629796
> 
> 赞同：0
> 
> 时间：2012-11-29T16:05:26.313
> 
> 标签：cordova, phonegap-plugins

我安装了 phonegap 插件 NotificationEx 但在尝试编译时出现此错误：

> **未找到 CDVPlugin.h 文件。**

我正在使用 Xcode 4.5、cordova 2.2.0 和 JQM 1.2.0

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-12T07:12:11.830

我在 Xcode 4.5、cordova 2.1.0 和 JQM 1.2.0 上安装 ShareKit 插件时遇到了同样的问题。有问题的块是：

```
#ifdef CORDOVA_FRAMEWORK
#import <Cordova/CDVPlugin.h>
#import <Cordova/CDVPluginResult.h>
//#import <Cordova/JSONKit.h>

#else
#import "CDVPlugin.h"
#import "CDVPluginResult.h"
#import "JSONKit.h"
#endif 
```

对我有用的是注释掉该`#ifdef`行以及注释掉整个`#else`块。

此外，该`#import <Cordova/JSONKit.h>`行已经在我使用插件下载的源代码中注释掉了，所以我没有打扰它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T14:16:49.410

我删除了整个#ifdef 混乱和

```
#import <Cordova/CDVPlugin.h> 
```

让我开心:)

# c# - 用于 C++ 回调的 C# 委托

> ID：13629798
> 
> 赞同：12
> 
> 时间：2012-11-29T16:05:31.507
> 
> 标签：c#, c++, delegates, callback, dllimport

我想我已经基本了解了如何为回调编写 c# 委托，但这让我感到困惑。c++定义如下：

```
typedef int (__stdcall* Callback)(
long lCode,
long lParamSize,
void* pParam 
); 
```

我的 c# 方法是：

```
 unsafe delegate int CallbackDelegate (int lCode, int lParamSize, IntPtr pParam); 
```

虽然这似乎是不正确的，因为我收到了 PInvokeStackInbalance 错误，这意味着我对委托的定义是错误的。

该函数的其余参数是字符串或整数，这意味着它们不会导致错误，如果我只传递一个 IntPtr.Zero 而不是委托（这意味着我指向一个不存在的回调函数）我收到一个 AccessViolation 错误，这也很有意义。

我究竟做错了什么？

编辑：

完整的 c++ 函数是：

```
int
__stdcall
_Initialize (
const char*         FileName,
Callback            cbFunction,
int                 Code,
const char*         Name,
unsigned int        Option,
unsigned int        Option2
); 
```

我的 C# 版本是：

```
[DllImport("MyDll.dll", CallingConvention = CallingConvention.StdCall)]
public static extern int _Initialize (string FileName, CallbackDelegate cbFunction, int Code, string Name, uint Options, uint Options2); 
```

该函数（用于测试）只是在控制台应用程序的主例程中调用：

```
static void Main(string[] args)
{
    CallbackDelegate del = new CallbackDelegate(onCallback);

    Console.Write(_Initialize("SomeFile.dat", del, 1000, "", 0, 4));
    Console.Read();
} 
```

这是哪里`onCallback`：

```
static int onCallback(int lCode, int lParamSize, IntPtr pParam)
{
    return 0;
} 
```

如果我通过 a而不是委托，`PInvokeStackInbalance`我在调用的行上收到错误，并将函数的定义更改为，而不是然后我得到 a 。`_Initialize``IntPtr.Zero``IntPtr``CallbackDelegate``AccessViolationException`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T15:05:25.980

我将您的代码添加到我当前的项目中，我在 VS2012 中做了很多 C#/C++ 互操作。虽然我讨厌使用“它在我的机器上工作”，但它对我来说效果很好。下面列出了我运行它的代码，只是为了说明我没有做出根本性的改变。

我的建议是，您为 _Initialize 构建一个带有存根函数的新本机 dll，如下所示，并在您可以控制界面的两侧时查看它是否有效。如果这有效，但真正的 dll 没有，则它归结为本机端的编译器设置，或者它们是本机端的错误并且它在堆栈上踩踏。

```
extern "C" {

    typedef int (__stdcall* Callback)(long lCode,long lParamSize,void* pParam );

    TRADITIONALDLL_API int __stdcall _Initialize (const char* FileName,Callback cbFunction, int                 Code,
                                const char*         Name,unsigned int        Option,unsigned int        Option2)
    {
        cbFunction(0, 0, nullptr);
        return 0;
    }
} 
```

在 C# 方面，我将声明添加到我的接口类中：

```
 public delegate int CallbackDelegate(int lCode, int lParamSize, IntPtr pParam);

 [DllImport("XXX.dll", CallingConvention = CallingConvention.StdCall)]
 public static extern int _Initialize(string FileName, CallbackDelegate cbFunction, int Code, string Name, uint Options, uint Options2); 
```

然后在我的主要内容中：

```
private int onCallback(int lCode, int lParamSize, IntPtr pParam)
{
       return 0;
}
XXXInterface.CallbackDelegate del = new XXXInterface.CallbackDelegate(onCallback);

Console.Write(XXXInterface._Initialize("SomeFile.dat", del, 1000, "", 0, 4)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T13:31:00.137

```
[UnmanagedFunctionPointerAttribute(CallingConvention.StdCall)]
unsafe delegate int CallbackDelegate (int lCode, int lParamSize, IntPtr pParam); 
```

如果 .NET 假定使用 cdecl 而不是 stdcall，那么您的堆栈肯定会被冲洗掉。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T16:08:15.910

.NET`long`是 64 位的。C++`long`可能只有 32 位。检查编译该定义的 C++ 编译器的大小`long`。

# java - 如何有效地实现 java.awt.Composite？

> ID：13629803
> 
> 赞同：7
> 
> 时间：2012-11-29T16:05:42.470
> 
> 标签：java, image, graphics, awt, graphics2d

背景：我需要能够以“禁用”外观创建图像。通常建议的方法是将图像转换为灰度并显示灰度图像。缺点是它仅适用于图像，因此在您无法立即访问处于禁用状态的图像时显示图形很麻烦。现在我认为这可以使用 java.awt.Composite 即时完成（然后我不需要知道如何实现图标以使其禁用）。只有似乎没有转换为灰度的实现，所以我不得不创建自己的......

也就是说，我拼凑了一个实现（它呈现了我所期望的）。但我不确定它是否真的适用于所有情况（对于如此复杂的操作，Composite/CompositeContext 的 Javadocs 似乎非常薄）。正如您从我的实现中看到的那样，我采用一种迂回的方式逐个像素地处理，因为似乎没有简单的方法可以以不由相关栅格规定的格式批量读取/写入像素。

欢迎任何指向更广泛的文档/示例/提示的指针。

这是 SSCCE - 它通过 DisabledComposite 渲染（彩色）GradientPaint 以将渐变转换为灰度。请注意，在*现实世界*中，您将不*知道*调用了什么渲染了什么。渐变实际上只是一个示例（抱歉，但人们经常不明白这一点，所以这次我会明确说明）。

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Composite;
import java.awt.CompositeContext;
import java.awt.Dimension;
import java.awt.GradientPaint;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.RenderingHints;
import java.awt.image.ColorModel;
import java.awt.image.Raster;
import java.awt.image.WritableRaster;

import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.SwingUtilities;

public class CompositeSSCE implements Runnable {

    static class DisabledComposite implements Composite {
        @Override
        public CompositeContext createContext(
            final ColorModel srcColorModel,
            final ColorModel dstColorModel,
            final RenderingHints hints) {
            return new DisabledCompositeContext(srcColorModel, dstColorModel);
        }
    } 

    static class DisabledCompositeContext implements CompositeContext {

        private final ColorModel srcCM;
        private final ColorModel dstCM;

        final static int PRECBITS = 22;
        final static int WEIGHT_R = (int) ((1 << PRECBITS) * 0.299); 
        final static int WEIGHT_G = (int) ((1 << PRECBITS) * 0.578);
        final static int WEIGHT_B = (int) ((1 << PRECBITS) * 0.114);
        final static int SRCALPHA = (int) ((1 << PRECBITS) * 0.667);

        DisabledCompositeContext(final ColorModel srcCM, final ColorModel dstCM) {
            this.srcCM = srcCM;
            this.dstCM = dstCM;
        }

        public void compose(final Raster src, final Raster dstIn, final WritableRaster dstOut) {
            final int w = Math.min(src.getWidth(), dstIn.getWidth());
            final int h = Math.min(src.getHeight(), dstIn.getHeight());
            for (int y = 0; y < h; ++y) {
                for (int x = 0; x < w; ++x) {
                    int rgb1 = srcCM.getRGB(src.getDataElements(x, y, null));
                    int a1 = ((rgb1 >>> 24) * SRCALPHA) >> PRECBITS;
                    int gray = (
                        ((rgb1 >> 16) & 0xFF) * WEIGHT_R +
                        ((rgb1 >>  8) & 0xFF) * WEIGHT_G +
                        ((rgb1      ) & 0xFF) * WEIGHT_B
                        ) >> PRECBITS;
                    int rgb2 = dstCM.getRGB(dstIn.getDataElements(x, y, null));
                    int a2 = rgb2 >>> 24;
                    int r2 = (rgb2 >> 16) & 0xFF;
                    int g2 = (rgb2 >>  8) & 0xFF;
                    int b2 = (rgb2      ) & 0xFF;
                    // mix the two pixels
                    gray = gray * a1 / 255;
                    final int ta = a2 * (255 - a1);
                    r2 = gray + (r2 * ta / (255*255));
                    g2 = gray + (g2 * ta / (255*255));
                    b2 = gray + (b2 * ta / (255*255));
                    a2 = a1 + (ta / 255);
                    rgb2 = (a2 << 24) | (r2 << 16) | (g2 << 8) | b2; 
                    Object data = dstCM.getDataElements(rgb2, null);
                    dstOut.setDataElements(x, y, data);
                }
            }
        }

        @Override
        public void dispose() {
            // nothing for this implementation
        }
    }

    // from here on out its only the fluff to make this a runnable example
    public static void main(String[] argv) {
        Runnable r = new CompositeSSCE();
        SwingUtilities.invokeLater(r);
    }

    // simple component to use composite to render
    static class DemoComponent extends JComponent {
        // demonstrate rendering an icon in grayscale with the composite
        protected void paintComponent(Graphics g) {
            Graphics2D g2d = (Graphics2D) g;
            GradientPaint p = new GradientPaint(0, 0, Color.GREEN, 127, 127, Color.BLUE, true);
            g2d.setComposite(new DisabledComposite());
            g2d.setPaint(p);
            g2d.fillRect(0, 0, getWidth(), getHeight());
        }
    }

    // Fluff to use the Composite in Swing 
    public void run() {
        try {
            JFrame f = new JFrame("Test grayscale composite");
            DemoComponent c = new DemoComponent();
            c.setPreferredSize(new Dimension(500, 300));
            f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            f.setLayout(new BorderLayout());
            f.add(c, BorderLayout.CENTER);
            f.pack();
            f.setVisible(true);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T15:58:06.307

您始终可以创建一个`BufferedImage`，使用 为该图像绘制任何需要灰度到`Graphics`对象的内容`bufferedImage.createGraphics()`，然后使用`javax.swing.GreyFilter`创建图像的灰度副本。

[本页向您展示如何使用`Filter`](http://journals.ecs.soton.ac.uk/java/tutorial/ui/drawing/useFilter.html).

您可能还想将您的方法与 SwingX 的方法进行比较`BlendComposite`，我希望它与您正在做的事情相同。BlendComposite 具有允许灰度的饱和模式。（它也有更多的模式。）

[这个页面有一个 BlendComposite 的演示。](http://www.java2s.com/Code/Java/2D-Graphics-GUI/BlendCompositeDemo.htm)

关于效率，我希望它们之间没有重要区别，因为有中间步骤，并且据我所知，两者都是图像数据的完整副本。但是如果您使用我建议的第一种方法保留灰度图像，您可以防止重新计算非动态控件。

如果您执行上述任一操作，性能将是正确的，我希望这就是您真正想要的。

根据您的评论，我猜您可能只想将效果应用于组件。为此，您可以使用`JLayer`，仅在 Java 7 中可用。从[Javadoc](http://docs.oracle.com/javase/7/docs/api/javax/swing/JLayer.html)中有一个覆盖半透明绿色的示例。您可以将其替换为灰色。如果你想在以前的 Java 版本中使用 JLayer，你可以使用`JXLayer`SwingX 项目的一部分。

# asp.net - ASP.NET MVC 4 控制器继承

> ID：13629804
> 
> 赞同：1
> 
> 时间：2012-11-29T16:05:47.467
> 
> 标签：asp.net, inheritance, controller, http-status-code-404

我有以下设置：
**BaseController1**继承***System.Web.Mvc.Controller***。这个控制器被编译成一个单独的 dll，从我的项目中引用。
**BaseController2**在我的项目中继承**了 BaseController1 。**
**MyController**继承**BaseController2**。

当我使用此设置运行应用程序时，出现 404 错误。

但是，如果**BaseController2**直接继承***System.Web.Mvc.Controller***，并且我使用此设置运行应用程序，那么一切都会按预期工作。

我有所有继承的控制器的默认构造函数：调用 base()。**BaseController1**
_**在程序集中使用对 asp.net mvc 3 的引用进行编译，而我的项目完全依赖于 asp.net mvc 4。

这可能是问题吗？或者我做错了什么。

提前致谢！**

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:11:52.690

你没有做错任何事，但你必须让 MVC 在特定的程序集/命名空间中查找：

```
ControllerBuilder.Current.DefaultNamespaces.Add(
    "ExternalAssembly.Controllers"); 
```

这个问题已经回答了这个问题：[asp.net mvc put controllers into a separate project](https://stackoverflow.com/questions/401376/asp-net-mvc-put-controllers-into-a-separate-project)**

# php - 在 div 中循环图像并在 div 包含 4 个图像后循环

> ID：13629807
> 
> 赞同：1
> 
> 时间：2012-11-29T16:05:54.860
> 
> 标签：php, codeigniter

目前我有这个结构

```
<div class="col">
   img1
   img2
   img3
   img4

</div>

<div class="col">
   img1
   img2
   img3
   img4

</div> 
```

然后当我试图循环它时

我得到了这个结果

> 图像[0] 图像[1] 图像[2]

我怎样才能实现这种结构

```
<div class ="col"[0]>
    img[0]
    img[1]
    img[2]
    img[3]
</div>
<div class ="col"[1]>
    img[0]
    img[1]
    img[2]
    img[3]
</div> 
```

循环代码：

```
<?php 
foreach ($images as $k => $v){
    $imagesrc ='graph.facebook.com/'.$v['fbid'].'/picture';; 
?> 

<div class="col" >
    <img [<?php echo $k; ?>] src="<?php echo $imagesrc; ?>" width="29px" height="31px" alt="name">
</div> 

<?php 
} 
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:18:52.820

在循环中，您要在每个图像之后添加一个`<br>`或。`<p>`

循环内示例

```
$counter = 0;
$firstTime = true;
$column = 0;

 <?php foreach ($images as $k => $v): 
  $imagesrc ='graph.facebook.com/'.$v['fbid'].'/picture'; 

  if ($firstTime) {
     echo '<div class="col'.$column.'" >';
     $firstTime = false;
  }

  if ($counter > 3) {
    echo '</div>';
    $column++;
    echo '<div class="col'.$column.'" >';
    $counter = 0;
  } ?>

  <img src="<?php echo $imagesrc; ?>" width="29px" height="31px" alt="name"> 
  <?php $counter++; ?>
 <?php endforeach; ?>
</div> 
```

# c# - C#中的类设计

> ID：13629810
> 
> 赞同：0
> 
> 时间：2012-11-29T16:06:12.143
> 
> 标签：c#, oop, class

我正在学习 C#，目前我们正在研究 OOP 概念。我们已经收到了这个问题，我正在努力理解其中的某些部分。

问题的要点是这样的。

定义一个名为`Operator`.

该类应实现以下方法。

*   `IsPositive`- 接收一个整数类型的值，如果为正则返回 true，否则返回 false。
*   `IsDayOfWeek`- 接收日期时间值和工作日名称（例如星期六），如果该值表示给定的工作日名称，则返回 true，否则返回 false。
*   `GetWords`- 接收包含单词（比如段落）的文本并返回包含所有单词的一维字符串数组。如果文本中没有可用的单词，则为空字符串数组。

它应该能够从 Operator 类派生，然后从派生类创建对象。

允许开发人员从派生类中为给定类型使用这些方法。换句话说，**当 type = 'N'（数字）时可以使用第一种方法，当 type 为 'D'（日期）时可以使用第二种方法，而当 type 是 'S'（字符串）时可以使用第三种方法。因此，在实例化对象时应该提供类型，并且它应该在整个类操作中都可用。**

我有足够的知识来编写方法，但我不明白的是我加粗的部分。*当给定某种*类型并且在实例化对象时应该提供该类型并且它应该在整个类中可用时，可以使用*某种*方法是什么意思？他们在谈论属性吗？

 *我试了一下。下面是我的代码。

```
public class Operator
    {
        private int _n;
        private DateTime _d;
        private string _s;

        public DataProcessor(int n, DateTime d, string s)
        {
            this.N = n;
            this.D = d;
            this.S = s;
        }

        public int N
        {
            set { _n = value; }
        }

        public DateTime D
        {
            set { _d = value; }
        }

        public string S
        {
            set { _s = value; }
        }

        public bool IsPositive()
        {
            //method code goes here
            return false;
        }

        public bool IsDayOfWeek()
        {
            //method code goes here
            return false;
        }

    } 
```

我不确定我是否走对了路。有人可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:57:13.970

我是这样读的：

```
public class Operator
{
    public char TypeChar { get; set; }

    public Operator(char operatorType) { this.TypeChar = operatorType; }

    public bool IsPositive(int N)
    {
        if (TypeChar != 'N')
           throw new Exception("Cannot call this method for this type of Operator");

    // method implementation code
    }

    // same for the other methods
}

public NumericOperator : Operator
{
    public NumericOperator() : base('N') {}
} 
```*

# macos - OpenTK 不绘制 Mac/VMWare Win7

> ID：13629812
> 
> 赞同：2
> 
> 时间：2012-11-29T16:06:18.480
> 
> 标签：macos, opengl, graphics, vmware, opentk

我有一台 Macbook Pro Summer 2011 13" 2.3GHz，它有板载图形，我正在尝试通过 OpenTK 绘制简单的多边形。最终我将进行更高级的绘图（等待构建我的 PC）但现在我'正在通过 VMWare 开发。我正在使用 OpenTK 在 C# 中使用 OpenGL。为了确保一切正常，我使用这段代码绘制了一个三角形： [http ://www.opentk.com/node/2292](http://www.opentk.com/node/2292)

它清除了我设置的颜色，但它不绘制任何多边形。我也在 Mac OSX 中运行过代码，但仍然没有运气。完整的 3d 游戏（刺客信条 2、地牢防御者、巫师）都可以正常绘制，但由于某种原因我的代码没有。一切都正确编译，我什至没有收到任何警告。

有人可以帮我弄清楚这是为什么吗？另外：我之前在同一台计算机上使用 OpenTK 编码并正确绘制，与那时没有任何不同的设置，它现在不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T06:47:36.833

我发现有几个具有相同名称但在不同名称空间中的类。我发现的“解决方案”（更多的是 hack）是在开头添加以下几行：

```
using GL = OpenTK.Graphics.OpenGL.GL;
using EnableCap = OpenTK.Graphics.OpenGL.EnableCap;
using MatrixMode = OpenTK.Graphics.OpenGL.MatrixMode;
using ClearBufferMask = OpenTK.Graphics.OpenGL.ClearBufferMask;
using BeginMode = OpenTK.Graphics.OpenGL.BeginMode; 
```

我用这些来运行即时模式示例；在此之前，我遇到了与您相同的错误-打开了一个窗口，根本没有显示任何图形。

我知道您的问题并不是那么新，我不知道您是否真的找到了答案，但无论哪种方式，我仍然希望这会有所帮助。

# java - Android：当活动死亡时，计时器被孤立

> ID：13629813
> 
> 赞同：1
> 
> 时间：2012-11-29T16:06:22.130
> 
> 标签：java, android, multithreading, timer, persistent

我是一个相对的 Android 新手，正在编写一个计时器应用程序。我正在使用一个自定义倒数计时器类，它是主要活动类的成员，它产生一个处理程序以每秒运行一次。

当我关闭应用程序时，主要活动停止，但计时器继续在后台运行，如我所愿。问题是当活动重新启动时，原来的计时器现在是一个孤儿，我找不到重新附加它的方法。

即使在活动重新启动之间，保持与计时器对象的持久连接的最佳方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T16:09:44.640

有几种不同的方法。

*   您可以使用系统的[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)。
*   您可以制作自己的[Service](http://developer.android.com/guide/components/services.html)。
*   你可以让你的 TimerObject[持久](http://developer.android.com/reference/android/app/Activity.html#SavingPersistentState)化。

由于我不知道您的确切要求，我建议您按照上面的~~白兔~~链接自行判断。

如果您必须坚持上述模型，那么第三种可能是您的最佳选择。

即使关闭活动，这个对象实际上每秒都会**做任何事情吗？**也许保留一个引用时间戳并在退出（）时销毁 TimerObject/Handler`onPause`并在启动 Activity 时使用持久状态（如果有）创建一个新的时间戳就足够了？

# html - 离线时清除 HTML5 Appcache

> ID：13629818
> 
> 赞同：0
> 
> 时间：2012-11-29T16:06:35.090
> 
> 标签：html, cache-manifest

我有一个可以离线工作的网络应用程序。我想为缓存设置一个过期日期，这样如果用户在一定时间内没有重新连接到服务器，缓存就会被清除，用户就不能再使用该应用程序了。

我认为计时器部分很简单，但是当我离线时我找不到任何方法以编程方式删除缓存。我只有在线时才找到路

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-03T22:37:29.427

目前没有办法以编程方式删除应用缓存，您必须使用 404 响应对清单的请求。 W3C 对[扩展当前的离线功能](http://lists.w3.org/Archives/Public/public-webapps/2013JanMar/0977.html)有些兴趣，您可以考虑将您的[用例添加到列表中](http://www.w3.org/wiki/Webapps/AppCacheUseCases).

# python - 传递 cx_oracle 错误代码

> ID：13629822
> 
> 赞同：0
> 
> 时间：2012-11-29T16:06:43.563
> 
> 标签：python, cx-oracle

我正在使用 cx_oracle 在 4 个不同的表中执行插入操作，并且需要传递 return_Val、error.code 和 error.message。

```
func1 
  try:
     insert1()
     insert2()
     insert3()
     insert4()
     return_val = True
  except cx_Oracle.DatabaseError, ex:
     return_val = False
     print error.code
     print error.message

  return return_val, error.code, error.message 
```

插入成功后，我收到以下错误消息，

UnboundLocalError：分配前引用的局部变量“错误”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T17:47:46.600

嗯，`error`是未绑定的，你可能想用`ex`……替换它。</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-21T18:46:44.350

您需要在异常处理程序中包含第一行：

```
error, = ex.args 
```

# jquery - 在 Windows XP 边缘的 IE8 中的 slideToggle 消失后

> ID：13629825
> 
> 赞同：0
> 
> 时间：2012-11-29T16:06:47.467
> 
> 标签：jquery, css, windows-xp, margin, slidetoggle

[问题在这里](http://jsfiddle.net/hNvzx/1/)演示

两次点击“点击我”后，#content2 的边距消失。它只发生在 Windows XP 上的 IE8 中。最简单的解决方案是将 #content 2 的上边距替换为`<div style="height:30px">&nbsp;</div>`. 但这是不可接受的，因为有很多滑动 div。CSS 解决方案是可以接受的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:13:23.920

只需删除`overflow: hidden`

```
#content {
    position:relative;
/*  overflow:hidden; */
    width:300px;
    height:300px;
    background-color:#432234;
    color:#ffffff;
    display:none;
} 
```

[http://jsfiddle.net/hNvzx/7/](http://jsfiddle.net/hNvzx/7/)

# algorithm - 莱因哈德色调映射 2002

> ID：13629836
> 
> 赞同：1
> 
> 时间：2012-11-29T16:07:18.337
> 
> 标签：algorithm, graphics, rendering, hdrimages

我正在阅读 Erik Reinhard 等人的论文。被称为“数字图像的摄影色调再现”，它也在这里：

[http://www.cs.utah.edu/~reinhard/cdrom/](http://www.cs.utah.edu/~reinhard/cdrom/)

有这个等式＃4：

```
Ld(x,y) = L(x,y)(1 + L(x,y)/L_white^2) / (1 + L(x,y)) 
```

“[如果] L_white 值设置为场景中的最大亮度 L_max...”

还有作者的源代码和在线的各种实现。

我的问题是，上面的公式有一个变体，我无法理解它是如何以及从什么推导出来的。以 Luxrender 源代码为例：

[http://src.luxrender.net/lux/rev/f48943145d29#l3.77](http://src.luxrender.net/lux/rev/f48943145d29#l3.77)

```
scale[i] = ( post_scale * (1.0f + lum*recip_Y_white2) / (1.0f + lum) ); //* maxDisplayY; 
```

论文没有提到的新变量“pre_scale”、“post_scale”和“burn”。他们还以非常不同的方式计算 L_white (= Y_white)：

```
const float Y_white = pre_scale * alpha * burn; 
```

请问，谁能向我解释如何推导出这样的算法？我认为它是基于论文的，但我不明白如何......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:20:26.647

在该论文中，等式（4）在“3.1初始亮度映射”部分中。这不是最终的转变。“3.2 自动闪避”小节是`burn`变量的由来；燃烧时> 1，闪避< 1。在没有阅读代码的情况下，我假设`pre_scale`并将`post_scale`它们的内部任意亮度值转换为实际的色彩空间。

# scala - SORM：我该如何管理 String 应该是 VARCHAR 还是 CLOB？

> ID：13629837
> 
> 赞同：3
> 
> 时间：2012-11-29T16:07:20.100
> 
> 标签：scala, sorm

我在文档中读过“如果字符串字段被索引，它是 VARCHAR(255)，否则它是 CLOB”

如果我不想索引字段，但需要 VARCHAR 表示怎么办？例如：

```
case class User(login: String, passwordHash: String, firstName: String, lastName: String, email: String, country: String, city: String, aboutMe: String); 
```

只有登录名和电子邮件被索引，但 passwordHash、firstName、lastName、country、city 不应该是 CLOB，因为它是短字段，CLOB 对他们来说是压倒性的。如何将此字段标记为 VARCHAR？否则，aboutMe 可以包含长文本，所以应该是 CLOB。如果我不需要 max（255 个字符），如何限制 VARCHAR 字段的长度？例如，passwordHash 不能超过 32 个字符（当然取决于散列方法）

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T16:53:23.477

`CLOB`值声明的开销`VARCHAR`只是几个字节。SORM 背后的理念是所有约定优于配置。这种方法是在 SORM 中实现消除样板的基石。由于在当今时代，额外的几个千兆字节 - 这可能是填充数据库的这种开销的结果 - 存储空间几乎不是问题，因此决定使用这些设置以获得最大的兼容性。

由于 SORM 的样板方法，您无法对 API 公开的这些内容进行微调。尽管它们可能会在未来出现，但如果该问题引起关注，可能会作为`Entity`.

但是，如果您坚持要控制这些事情，则存在一个非常简单的解决方案：您让 SORM 以它的方式生成模式，然后使用您选择的数据库管理工具，您可以通过更改列、索引或任何。在列的文本类型（CLOB、VARCHAR 等）之间切换不会造成任何麻烦。

# asp.net - 单击按钮时如何添加ID？

> ID：13629841
> 
> 赞同：0
> 
> 时间：2012-11-29T16:07:33.347
> 
> 标签：asp.net

我想在`viewdatesbutton.jpg`单击时添加 TID 的值，以便可以将其传递到另一个网页。

我怎样才能做到这一点？

代码：

```
<asp:repeater id="Repeater1" datasourceid="SqlDataSource1" runat="server">

<itemtemplate>

<div class="content-1g">
    <div class="content-1-1g">
        </div>
    <div class="content-1-2g"><p class="none"><%# Eval("TName")%></p><p><span style="color:#FFFFFF"><%# Eval("TDetails")%></span></p>
        <div class="content-1-2ag">
            <div class="content-1-3g">Duration: <%# Eval("TDuration")%> </div>
            <div class="content-1-3g">Adult: £<%# Eval("TPriceadult")%> </div>
            <div class="content-1-3g">Senior/Student: £<%# Eval("TPricesenior")%> </div>
            <div class="content-1-3g">Child: £<%# Eval("TPricechild")%> </div>
        </div>
        <div class="content-1-2bg"><img alt="" src="/images/viewdatesbutton.jpg" />
        </div>
    </div>
</div>

    <div class="line"><hr class="top" /></div>

</itemtemplate>

</asp:repeater>

    <asp:sqldatasource id="SqlDataSource1"  runat="server" 
        ConnectionString="<%$ ConnectionStrings:ChinatowndbConnString %>" 
        SelectCommand="SELECT TID, TName, TDetails, TDuration, TPriceadult, TPricesenior, TPricechild FROM [Tour] WHERE TEventCategory=2">
 </asp:sqldatasource> 
```

我假设我可以在点击按钮时拥有一个功能？如何在其上传递 TID 的值？

问候，茶

编辑：

```
 <asp:LinkButton ID="lbYear" runat="server" CausesValidation="false" OnCommand="redirectnewpage" CommandArgument='<%#Eval("TourId")%>'>
            <asp:Image ID="imgFolder" runat="server" ImageUrl="/images/viewdatesbutton.jpg" />
        </asp:LinkButton>

protected void redirectnewpage(object sender, CommandEventArgs e)
{
    Response.Redirect("book.aspx?tourid="+ e.CommandArgument.ToString());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:25:47.097

您可以使用[`<asp:ImageButton>`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.imagebutton.aspx)服务器端控制和使用`CommandArgument`它的属性：

```
<div class="content-1-2bg">
    <asp:ImageButton runat="server" 
         ImageUrl="/images/viewdatesbutton.jpg" 
         CommandArgument='<%# Eval("TID") %>' 
         OnCommand="ImgButton_OnCommand" />

</div> 
```

然后在事件处理程序中获取`TID`值：`OnCommand`

```
private void ImgButton_OnCommand(object sender, CommandEventArgs e)
{
    var tid = int.Parse(e.CommandArgument.ToString());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:26:19.463

您可以将 ImageButton 添加到模板中，并使用`CommandArgument`插入 TID。例如：

```
<asp:ImageButton ImageUrl="~/icon.png" ID="TIDButton" runat="server"  
                 CommandArgument=<%# Eval("TID") %> OnClick="TIDButton_Click" /> 
```

然后，将其放入您的代码中：

```
 protected void TIDButton_Click(object sender, EventArgs e)
    {
        ImageButton b = sender as ImageButton;
        if (b == null)
          return; 

        string TID = b.CommandArgument;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T16:30:52.343

```
<asp:LinkButton ID="lbYear" runat="server" CausesValidation="false" OnCommand="redirectnewpage" CommandArgument='<%#Eval("TourId")%>'>
            <asp:Image ID="imgFolder" runat="server" ImageUrl="/images/viewdatesbutton.jpg" />
        </asp:LinkButton>

protected void redirectnewpage(object sender, CommandEventArgs e)
{
    Response.Redirect("book.aspx?tourid="+ e.CommandArgument.ToString()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T16:33:53.423

```
 <asp:LinkButton ID="lbYear" runat="server" CausesValidation="false" OnCommand="redirectnewpage" CommandArgument='<%#"tourId="+Eval("TourId").ToString()+"&TID="+Eval("TID").ToString()%>'>
        <asp:Image ID="imgFolder" runat="server" ImageUrl="/images/viewdatesbutton.jpg" />
    </asp:LinkButton>

protected void redirectnewpage(object sender, CommandEventArgs e)
{
   Response.Redirect("book?"+ e.CommandArgument.ToString());
} 
```

# css - 带有包装问题的导航栏

> ID：13629845
> 
> 赞同：0
> 
> 时间：2012-11-29T16:07:52.020
> 
> 标签：css, wrapper, navigationbar

我网站的整个主题都有一个包装器，它在网页的左侧和右侧将我的导航栏缩短了大约 20 像素。有没有人对如何将导航栏放在包装器顶部有任何想法，这样它就不会被缩短？

有没有办法让导航栏水平地包含整个网站，而不必从包装器中删除它以及其他所有内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:41:25.740

使用`position:absolute`or a`float`会将元素从文档流中取出。这意味着可以将其视为在包装器之外，而无需更改 HTMl 的实际结构。

如果不显示您的代码示例，很难更具体，但是使用定位应该可以为您解决问题。

# php - 在存储在 webroot 之外的浏览器中打开 PDF

> ID：13629847
> 
> 赞同：3
> 
> 时间：2012-11-29T16:07:57.093
> 
> 标签：php, pdf

我有一些只有会员才能访问的 PDF（他们必须登录才能获得它们）。我想让它们显示在浏览器中，而不是显示一个对话框，要求保存/打开文件。PDF 存储在常规根目录之外。这是代码：

```
$filepath='/var/www/vhosts/Reports/';
$filename='CA.pdf';
header('Content-Disposition:inline; filename="'.$filename.'"');
header('Content-type:application/octet-stream');
header('Pragma:no-cache');
header('Expires:0');
if ($file=fopen($filepath.$filename,'r')) {
fpassthru($file);
fclose($file); 
```

我读到将配置设置为内联应该可以解决它，但没有好处。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:14:28.277

我试图对你的帖子发表评论，但我是个菜鸟。我只是想分享一些谷歌搜索结果。你试过@readfile 吗？

[通过 PHP/Perl 在用户浏览器中显示 PDF 文件](https://stackoverflow.com/questions/4679756/show-a-pdf-files-in-users-browser-via-php-perl)

[使用 PHP 在浏览器中打开 PDF](https://stackoverflow.com/questions/4750252/open-pdf-in-browser-with-php)

[http://php.net/manual/en/function.readfile.php](http://php.net/manual/en/function.readfile.php)

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:16:50.673

内容类型应该是“application/pdf”，浏览器会将其识别为 pdf 并将其打开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-09T18:41:34.073

```
$file = "../../somewherebehindthatroot/FileName.pdf";

if ( file_exists($file) ) {     

    if (copy($file, "OpenThisFile.pdf")) { echo "<br /><br /><a href='OpenThisFile.pdf'  target='_blank'>Open File...</a>"; }

} 
```

# javascript - 如何禁用/停止 jQuery 函数？

> ID：13629852
> 
> 赞同：0
> 
> 时间：2012-11-29T16:08:03.367
> 
> 标签：javascript, jquery, drag-and-drop

我有一个带有 jQ​​uery.pep（拖放 jQuery 插件）的 JavaScript 文件。我正在使用以下代码启动插件：

```
Drag.pep(); 
```

现在，我不知道如何禁用/停止它。这是文件中的代码部分：`jquery.pep.js`. 我想它可能会帮助你回答：

```
$[pluginName] = {
  stopAll: function () {
    disable = true;
    return this;
  },
  startAll: function () {
    disable = false;
    return this;
  }
}; 
```

变量“pluginName”是“pep”。这是[完整的 jQuery pep 代码](https://github.com/briangonzalez/jquery.pep.js)（github）：

请帮忙。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T16:21:42.143

那可能应该这样做：

```
$.pep.stopAll(); // stops all peps 
```

编辑：

在代码中有一个可以在实例对象上调用的函数：

```
Pep.prototype.forceStop = function(){
  $(this.el).trigger( this._endTrigger );
}; 
```

该实例在此处构建并保存到数据属性中：

```
// A really lightweight plugin wrapper around the constructor,
// preventing against multiple instantiations
$.fn[pluginName] = function ( options ) {
    return this.each(function () {
        if (!$.data(this, 'plugin_' + pluginName)) {
            $.data(this, 'plugin_' + pluginName, new Pep( this, options ));
        }
    });
};

$('your-selector').data('plugin_pep').forceStop(); 
```

我试图这样做，它调用了 forceStop 方法，但最终并没有这样做。我研究并认为它的作用是停止当前正在进行的动画。

您现在可以做的是覆盖可以在需要时使用选项提供的拖动方法，并在触发动画时立即强制停止。

我不太喜欢，但是当我现在看到代码时，我看不到任何其他方式的机会（此处缺少文档；-()

这应该工作：

```
var myPep = $('your-selector').data('plugin_pep');
myPep.options.drag = function(ev, obj) {
  obj.forceStop();
}; 
```

edit2：如果你想让它再次可拖动，只需用一个空函数再次覆盖该函数：

```
myPep.options.drag = function() {}; 
```

# c# - 如何确定 WCF 3 和 ASP.NET 是否以编程方式向 IIS 7 注册

> ID：13629857
> 
> 赞同：3
> 
> 时间：2012-11-29T16:08:19.400
> 
> 标签：c#

我被要求编写一个工具来检测所有要求并告诉用户机器是否满足所有要求，以便能够安装我正在实习的公司开发的不同软件解决方案。

我需要检查 WCF3 和 ASP.NET 是否正确注册到 IIS，代码是用 C# 编写的。我需要一种防弹方法来知道它是否正确注册。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:14:26.230

检查此线程：[使用 C# 在 IIS 中以编程方式创建网站并设置端口号](https://stackoverflow.com/questions/1286831/programatically-create-a-web-site-in-iis-using-c-sharp-and-set-port-number)，如果您使用的是 IIS 7，则可以以编程方式访问所有已注册的站点。请记住我提供的线程讨论了如何以编程方式添加站点，您应该能够使用“站点”集合访问所有注册的服务并按名称或其他条件搜索这些服务（您必须检查哪些属性可用）。

```
ServerManager iisManager = new ServerManager();
iisManager.Sites; //Use this collection to find the services you need to know exist 
```

同样重要的是要注意，如果您也对应用程序池感兴趣，您可以像这样访问它们：

```
ServerManager serverManager = new ServerManager();
ApplicationPoolCollection applicationPoolCollection = serverManager.ApplicationPools; 
```

最后，您的应用程序将需要在具有适当权限的帐户下运行才能读取此信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:12:37.860

使用ServiceHostFactory，工厂构造好ServiceHost之后

```
protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
{
  var hostname = base.CreateServiceHost(serviceType, baseAddresses);
  hostname.Extensions.Add(new CustomConfigurer());
  return hostname;
} 
```

或者你可以使用 HttpContext

```
private string ConnectionString()
        {
            if (HttpContext.Current!=null)
                return ConfigurationManager.ConnectionStrings["MyDatabase"].ConnectionString;
            else
                return GetConnectionStringFromRegistry();
        } 
```

# javascript - 发送 GET 变量而不用 javascript 重新加载页面

> ID：13629859
> 
> 赞同：0
> 
> 时间：2012-11-29T16:08:26.673
> 
> 标签：javascript, ajax, get

我要做的是`GET`在按下下载链接时在 javascript 中运行请求。当链接被按下时，它会向`GET`一个 php 脚本发送一个请求，该脚本基本上计算链接被按下的次数。这是我的代码，但我似乎无法让它正常工作。我对javascript很陌生，但仍然知道我的方式。我已经测试并且我的 getrulvars() 函数有效，并且当按下链接时我的函数有效，所以我确信它是我的 GET 请求，它不起作用

```
function getUrlVars() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m, key, value) {
        vars[key] = value;
    });
    return vars;
}
// Wait for page to load
window.onload = function() {
    var a = document.getElementById("downloadLink");
    var app = getUrlVars()["app"];

    a.onclick = function() {    
        var xmlhttp;
        if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else { // code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.open("GET", "download_count.php?app=" + app, true);
        xmlhttp.send();
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T18:07:06.703

所以我让它工作我必须做的是返回 false 然后在我的 php 脚本中让它下载文件。我猜当我下载文件时它不允许 jQuery 发送 GET 值。

# java - RHEL6 服务器 - jsp 查看器上的字体乱码，但如果字体添加到 java 字体目录，则在导出时完美（来自同一查看器），否则为空指针异常

> ID：13629864
> 
> 赞同：1
> 
> 时间：2012-11-29T16:08:45.687
> 
> 标签：java, linux, fonts, crystal-reports

这是一个奇怪的。因此，到目前为止，我一直在 Mac 上运行它，一切都很好（服务器即设计器显然在 Windows 上）。刚刚部署到 linux 机器（Red Hat），最初 pdf 导出在 OpenTypeFontManager 上有一个空指针异常。这表明它找不到字体，所以我将相关的 ttfs 复制到 $JAVA_HOME/lib/fonts 并且 pdf 运行良好。不利的一面是，查看器上的图表突然变得非常乱码（所有字体输出都被弄乱了，使用 fonts ）。再次删除文件并按原样返回所有文件，将它们放回原处，pdfs 工作和图表都是乱码。

一个例子...

![坏字体](../Images/a9ff36e4d2dcb2000a3ea5f79e619ffa.png)

请注意，这不会在 PDF 导出中发生，仅在查看器中发生。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-23T08:49:34.277

之后是另一种从结果 PDF 中关闭字体嵌入的可能性，这是可行的。CrystalReportsRuntime.jar 中有一个初始化文件，它定义了此处的行为。它位于 com\crystaldecisions\reports\exporters\page\pdf\PDF_properties.xml，有 4 个布尔定义。去编辑这个文件，并将“embedFonts”的默认值设置为“false”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T17:34:10.883

对不起，我又厚了一个。服务器有水晶讨厌的openjdk，我用合适的sun jdk换掉了它，一切都很好。排序。

# php - 我可以使用 ob_start 来包含一个包含变量的外部 php 文件吗？

> ID：13629871
> 
> 赞同：0
> 
> 时间：2012-11-29T16:09:23.533
> 
> 标签：php

这可能吗？如果可以，我将如何采用这种方法，我真的不明白 ob_start 的目的是什么，因为我没有使用过这个函数，我也不知道什么时候使用这个函数。

我已经在这里问了一个类似的问题，但没有得到任何答案，所以我希望有了这个更准确的问题，我现在可以更好地回答这个困境，我也知道我还有其他方法可以通过 SVN 做到这一点但我想继续使用包含外部文件的方法。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T16:18:05.867

OB（输出缓冲）系统只影响**OUTPUT**。它捕获通常会发送到远程浏览器的任何内容并将其存储在内存缓冲区中。就您的普通 PHP 代码而言，没有任何变化，只是输出暂时被困住了。

OB 在某些情况下很方便，例如无论出于何种原因您可能会产生输出，但还不能将其发送出去，例如

```
echo 'this will break the next line';
header("Location: otherpage.php"); 
```

添加输出缓冲将允许标头重定向工作：

```
ob_start();
echo 'this would have broken the next line, but output has been trapped';
header("Location: otherpage.php");
echo ob_get_clean(); // output actually occurs here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T16:24:51.213

正如另一张海报提到的，ob_start 对程序的输入没有任何影响。

如果您想在单个脚本中包含一个充满变量的 PHP 文件，我建议使用 require_once (http://php.net/manual/en/function.require-once.php)。当且仅当它之前没有被评估过时，这将评估当前范围内的给定 PHP 文件。我说使用 require_once 函数是因为 include 不会告诉您文件是否加载失败，并且结构的 _once 方面确保在访问多个 PHP 文件时您不会重新加载文件（这可能会让人头疼）。

如果您希望将文件中的变量引入服务器上运行的每个 php 程序，请考虑使用 php.ini 指令 auto_prepend_file (http://us3.php.net/manual/en/ini.core.php#ini .auto 前置文件）。在评估您的脚本之前，该指令将为每个请求加载一个文件（很像 include 或 require）。

如果这不是您要查找的内容，您能否说明您要查找的内容？

编辑：评论示例

```
$myStringArray = file('http://somewhere.com/file.txt');  //get the file contents as an array of lines

$myEvaluationString = ''; //set up a string which we will eventually evaluate

foreach ($myStringArray as $line) {

  $myEvaluationString = "$line\n"; //loop over each line and add it to our evaluation string

}

$myEvaluationString = rtrim($myEvaluationString); //clean off the trailing newline

eval($myEvaluationString); //evaluate the string 
```

# cordova - 原生封装限制PhoneGap

> ID：13629875
> 
> 赞同：2
> 
> 时间：2012-11-29T16:09:29.927
> 
> 标签：cordova

我打算开发一个多平台的移动应用程序。我在两个框架之间做出选择：Sencha Touch 2 或 JQuery Mobile。如果我使用 JQuery Mobile，我必须使用 PhoneGap 打包我的应用程序。我读到 PhoneGap 不允许大于 9.5 MB 的包。谁能告诉我这是不是真的？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T04:22:00.333

我的一个 PhoneGap 应用程序接近 2GB（大量视频内容），因此框架没有限制。

但是，Phonegap Build（或任何其他基于云的构建服务）会有更多的限制，因此如果您正在做更复杂的应用程序，则需要在本地构建。

# intersystems-cache - 在缓存 sql 存储映射中使用 IDLocaltion 属性

> ID：13629876
> 
> 赞同：3
> 
> 时间：2012-11-29T16:09:34.233
> 
> 标签：intersystems-cache

我有一个全局索引（XWES.ETI），我想用它来拉取花药表的下标。XWES.ETI 全局有一个下标（一个序列号），并且有两条数据我想用作缓存 sql 存储映射 (^ZIDETRP) 中定义的实际全局的下标。我的类编译没有错误，但不会加载并在 %AcquireLock 中出现错误，因为我创建的一个变量（edt）未定义。我知道这段代码很接近，但我似乎无法发现问题。建议任何人？课程如下：

```
Class System.ErrTest Extends (%Persistent, %XML.Adaptor) [ StorageStrategy = Legacy ] 
{

Property ErrID As %Library.Integer;

Property ErrDt As %Library.Date;

Property ErrNum As %Library.Integer;

Property EDat As %Library.String;

///  Index iMaster on ErrID [IDKey,Unique]; 
Index iMaster On ErrID [ IdKey, Unique ];

<Storage name="Legacy"> 
  <ExtentSize>100000</ExtentSize> 
  <IdLocation>^XWES.ETI</IdLocation> 
  <SequenceNumber>6</SequenceNumber> 
<SQLMap name="Map1"> 
  <Data name="EDat"> 
   <Delimiter>$c(0)</Delimiter> 
   <Node>1</Node> 
   <Piece>1</Piece> 
  </Data> 
  <Data name="ErrDt"> 
   <RetrievalCode> Set {*}=edt</RetrievalCode> 
  </Data> 
  <Data name="ErrNum"> 
   <RetrievalCode> Set {*}=enum</RetrievalCode> 
   </Data> 
 <Global>^ZIDETRAP</Global> 
 <RowReference>^ZIDETRAP(edt,enum)</RowReference> 
 <Subscript name="1"> 
   <AccessType>Other</AccessType> 
   <Accessvar name="1"> 
     <Code> S edt=$p(^XWES.ETI({L1}),"^",1)</Code> 
     <Variable>edt</Variable> 
   </Accessvar> 
   <Accessvar name="2"> 
     <Code> S enum=$p(^XWES.ETI({L1}),"^",2)</Code> 
     <Variable>enum</Variable> 
   </Accessvar> 
   <Expression>{ErrID}</Expression> 
   <NextCode> s {L1}=$Order(^XWES.ETI({L1}))</NextCode> 
 </Subscript> 
<Type>data</Type> 
</SQLMap> 
<StreamLocation>^WSandlin.System.ErrTestS</StreamLocation> 
<Type>%CacheSQLStorage</Type> 
</Storage> 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T19:48:26.890

我没有用数据尝试过这个，但是 %AquireLock 问题消失了，因为它是一个只读映射。这是一种 hack，但它可能会起作用或有帮助，而且评论时间太长了。

```
{

Property ErrID As %Library.Integer;

Property ErrDt As %Library.Date;

Property ErrNum As %Library.Integer;

Property EDat As %Library.String;

///  Index iMaster on ErrID [IDKey,Unique]; 
Index iMaster On (ErrID, ErrDt, ErrNum) [ IdKey, Unique ];

<Storage name="Legacy">
<ExtentSize>100000</ExtentSize>
<IdLocation>^XWES.ETI</IdLocation>
<SequenceNumber>6</SequenceNumber>
<SQLMap name="Map1">
<Data name="EDat">
<Delimiter>$c(0)</Delimiter>
<Node>1</Node>
<Piece>1</Piece>
</Data>
<Global>^ZIDETRAP</Global>
<RowIdSpec name="1">
<Expression>{ErrID}</Expression>
<Field>ErrID</Field>
</RowIdSpec>
<RowIdSpec name="2">
<Expression>$P(^XWES.ETI({ErrID}),"^",1)</Expression>
<Field>ErrDt</Field>
</RowIdSpec>
<RowIdSpec name="3">
<Expression>$P(^XWES.ETI({ErrID}),"^",2)</Expression>
<Field>ErrNum</Field>
</RowIdSpec>
<Subscript name="1">
<Expression>{ErrID}</Expression>
<NextCode>s {L1}=$Order(^XWES.ETI({L1}))</NextCode>
</Subscript>
<Subscript name="2">
<AccessType>Other</AccessType>
<DataAccess>$p(^XWES.ETI({L1}),"^",1)</DataAccess>
<Expression>{ErrDt}</Expression>
<NextCode>S {L2}=""</NextCode>
<StopExpression>1</StopExpression>
</Subscript>
<Subscript name="3">
<AccessType>Other</AccessType>
<DataAccess>$p(^XWES.ETI({L1}),"^",1)</DataAccess>
<Expression>{ErrNum}</Expression>
<NextCode>S {L3}=""</NextCode>
<StopExpression>1</StopExpression>
</Subscript>
<Type>data</Type>
</SQLMap>
<StreamLocation>^WSandlin.System.ErrTestS</StreamLocation>
<Type>%CacheSQLStorage</Type>
</Storage>
} 
```

# .net - 使用 .net 中的命名空间检索 xml 中的节点

> ID：13629877
> 
> 赞同：1
> 
> 时间：2012-11-29T16:09:36.043
> 
> 标签：.net, vb.net, xpath

我来自vb6背景。.net 新手和 xml 新手。我正在尝试从 xml 文件中检索节点。我发现了几种使用的方法（xmltextreader/serialization、xmldocument、xpath） 我使用 xpath 只是因为我首先得到了一些结果:) 我的问题我确定与命名空间相关，但我发现的所有示例都比简单得多我有的xml。这是我需要访问的 xml 的一部分和我的代码片段。

```
<?xml version="1.0" encoding="utf-8"?>
<MTConnectStreams xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:mtconnect.org:MTConnectStreams:1.2 http://mtconnect.org/schemas/MTConnectStreams_1.2.xsd" xmlns="urn:mtconnect.org:MTConnectStreams:1.2">
  <Header creationTime="2012-11-29T12:30:19Z" instanceId="2" nextSequence="1918272" sender="Tarus MTConnect Instance" bufferSize="5000" firstSequence="1913272" lastSequence="1918271" version="1.2" />
  <Streams>
    <DeviceStream name="Vertical Bridge" uuid="TPIVB1">
      <ComponentStream component="Device" name="Vert" componentId="TPIVert">
        <Events>
          <Availability dataItemId="avail" timestamp="2012-11-27T23:19:40Z" sequence="44">AVAILABLE</Availability>
        </Events>
      </ComponentStream>
      <ComponentStream component="Linear" name="X" componentId="X">
        <Samples>
          <AxisFeedrate dataItemId="xs1" timestamp="2012-11-29T12:29:54Z" sequence="1717806" name="x_feed_cmd" subType="COMMANDED" units="MILLIMETER/SECOND">0</AxisFeedrate> 
```

试图检索 AxisFeedrate 我有这个：

```
Dim xDoc As XPathDocument = New XPathDocument(sUrl)
Dim xNav As XPathNavigator = xDoc.CreateNavigator
Dim xIt As XPathNodeIterator = xNav.Select("//AxisFeedrate")
Dim i As Integer

For i = 1 To xIt.Count
    xIt.MoveNext()
    msgbox (xIt.Current.Value) 
```

如果我将根节点更改为简单的“MTConnectStreams”，一切正常。在在线命名空间示例之后，我对我的代码进行了以下更改。但是在恢复原始根节点时，我仍然得到零结果。

```
Dim nsMgr = New XmlNamespaceManager(xNav.NameTable)
nsMgr.AddNamespace("ns", "http://www.w3.org/2001/XMLSchema-instance")
Dim xIt As XPathNodeIterator = xNav.Select("//ns:AxisFeedrate", nsMgr) 
```

有人可以帮我克服这个障碍吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T17:16:28.503

您的根节点声明默认命名空间是“urn:mtconnect.org:MTConnectStreams:1.2”，因此您需要使用它：

```
Dim nsMgr = New XmlNamespaceManager(xNav.NameTable)
nsMgr.AddNamespace("mt", "urn:mtconnect.org:MTConnectStreams:1.2")
Dim xIt As XPathNodeIterator = xNav.Select("//mt:AxisFeedrate", nsMgr) 
```

# sql - 搜索序列化为 yaml（存储在 PostgreSQL 数据库中）的项目的最快方法是什么？

> ID：13629878
> 
> 赞同：0
> 
> 时间：2012-11-29T16:09:36.970
> 
> 标签：sql, ruby-on-rails, ruby, database, performance

我们需要解析已序列化到 PostgreSQL 数据库中的 YAML 配置，该数据库托管在 heroku 上。

包含我们需要的数据的表目前大约有 250 万行，但可能会很快增长。

YAML 数据本身只包含简单的配置数据，带有一些散列和一些小数组。

我们需要能够以最快的方式从我们的 Rails 应用程序中检索 YAML 数据，该应用程序也将托管在 heroku 上。检索数据的最佳方法是什么？

简单地遍历数据库并动态反序列化 YAML 数据就足够了吗？还是我们应该创建一个新表来存储反序列化的配置数据？此外，PostgreSQL 对这种任务是否足够快，还是我们应该研究另一个数据库？例如nosql？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:31:32.267

哇。首先，PostgreSQL 是一个非常快速的关系数据库。但是，虽然将 YAML 作为文本存储在数据库中并没有错，但您真正在做的（我假设）是将结构化数据（YAML）存储在单个字段中。如果数据是有规律的结构化的，即大部分包含相同的字段和值，那么它应该作为结构化数据存储在关系数据库中。如果它是结构松散的数据，那么键值存储机制（无论是某种 NoSQL 数据库，还是就此而言，文件系统）可能确实值得考虑。

如果您正在遍历数据库并反序列化整个记录集，全部为 2.5M 并且还在增长，那么您已经将它们存储在内存中，所以像`memcached`（Rails 支持的缓存存储之一）这样的工具可能是一个很好的解决方案. PostgreSQL 可能适合存储数据，除非它很大——如今 250 万条记录并不是一个大数字，而且进行全表扫描很可能不会成为限制因素——更有可能是 CPU将 YAML 反序列化为 ruby​​ 哈希/数组。

但是你真的需要一次内存中的所有 2.5M+ 记录吗？为什么不根据需要获取它们？当您说“最快的方法”时，答案取决于需要快速的方法。如果您愿意等待几秒钟让您的应用程序加载，然后从那里自行管理数据（可能在发生更改时存储更改，处理锁定、并发等），那么是的，内存是去。如果您确实需要内存中最常用的 2500 条记录，那么标准的延迟加载缓存策略可能会很容易管理。

我认为您在实现方面提出了一个相当普遍的架构和设计问题。如果没有更完整地描述为什么，什么和你的限制是什么，我认为我或其他任何人都无法提供明确的答案。编辑问题以提供更多上下文和详细信息，也许您将能够获得更具体的答案。

# html - Nokogiri：使用图像定位表的兄弟姐妹

> ID：13629881
> 
> 赞同：0
> 
> 时间：2012-11-29T16:09:42.293
> 
> 标签：html, ruby, parsing, nokogiri

我正在尝试针对`tr`外部表中的表。外部表的第一个`tr`包含一个`table`带有标识表数据的图像。有几个带有不同图像的外部表，每种数据类型都有一个。我可以使用 Nokogiri 定位图像

```
page.css('table tr table tr img[@src="images/bicycyles.gif"]') 
```

我想获取位于`tr`外部表第三个表中的数据。我可以使用页面上的所有数据

```
page.css('table[bgcolor="#FFFFFF"] tr[valign="top"]') 
```

但这也会从其他数据类型中提取数据（例如，在“cars.gif”下）。

我怎样才能结合这些搜索来只找到自行车数据？我基本上想说“从`tr`with`valign=top`中提取文本`table`with `bgcolor=#ffffff`，这是`tr`包含`img src=bicycles.gif`

这是 HTML 的示例：

```
<!-- Outer Table -->
<table>
    <tr>
        <td><img src="images/spacer.gif" width="1" height="10" /></td>
    </tr>
    <tr>
        <td>
            <table> 
                <tr>
                    <!-- Info must have this particular image preceding it -->
                    <td><img src="images/bicycle.gif" /></td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td><img src="images/spacer.gif" width="100" height="10" /></td>
    </tr>
    <tr>
        <td>
            <table width="532"> 
                <tr>
                    <td>Info</td>
                </tr>
            </table>
            <table bgcolor="#FFFFFF">
                <tr valign="top">
                    <!-- The info I want to extract -->
                    <td>Bicycle Name</td>
                </tr>
            </table>
        </td>
    </tr>
    <!-- More trs with different data types --> 
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:32:42.603

> `tr`“从with`valign=top`中的`table`with 中提取文本`bgcolor=#ffffff`，它是`tr`包含 an的兄弟`img src=bicycles.gif`”

基于示例 HTML 的轻微修正：

> `tr`“从with`valign=top`中的`table`with 中提取文本，该文本`bgcolor=#ffffff`包含在`tr`具有前一个`tr`兄弟的 a 中，该兄弟本身包含一个`img src=bicycles.gif`”

转换为 XPath：

```
page.xpath('//tr[preceding-sibling::tr//img/@src = "images/bicycle.gif"]//table[@bgcolor="#FFFFFF"]//tr[@valign="top"]').text.strip

#=> "Bicycle Name" 
```

请注意，在您给出的示例中，您要么需要，要么不需要`[bgcolor="#FFFFFF"]`两者`[valign="top"]`。由于依赖硬编码样式并不理想，因此您需要指定的越少越好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T00:31:38.150

我认为使用 css 仍然很混乱但更具可读性：

```
page.at('img[src="images/bicycle.gif"]').ancestors('tr')[1].at('~ tr tr[valign=top] td').text
#=> "Bicycle Name" 
```

# soap - Java Document Literal WebService - MonoTouch 客户端在 WS 响应期间出现异常

> ID：13629887
> 
> 赞同：3
> 
> 时间：2012-11-29T16:09:59.180
> 
> 标签：soap, xamarin.ios, jax-ws, webservice-client

我在 HTTPS 上使用 JAX-WS 在 tomcat 上运行 Java Document Literal WebService。Java 和 .Net WS 客户端工作正常，而 iOS 上的 MonoTouch 客户端在 WebService 响应期间抛出异常。我检查了请求是否在服务器上正确命中，但返回到 MonoTouch 客户端的响应在随机 WebService 响应上抛出以下异常（一些响应是成功的）：

```
[System.Xml.XmlException: Document element did not appear.  Line 1, position 1.
  at Mono.Xml2.XmlTextReader.Read () [0x00168] in /Developer/MonoTouch/Source/mono/mcs/class/System.XML/System.Xml/XmlTextReader.cs:629 
  at System.Xml.XmlTextReader.Read () [0x0006b] in /Developer/MonoTouch/Source/mono/mcs/class/System.XML/System.Xml/XmlTextReader2.cs:564 
  at System.Xml.XmlReader.MoveToContent () [0x00050] in /Developer/MonoTouch/Source/mono/mcs/class/System.XML/System.Xml/XmlReader.cs:563 
  at System.Web.Services.Protocols.WebServiceHelper.ReadSoapMessage (System.Xml.XmlTextReader xmlReader, System.Xml.Serialization.XmlSerializer bodySerializer, System.Xml.Serialization.XmlSerializer headerSerializer, Boolean soap12, System.Object& body, System.Web.Services.Protocols.SoapHeaderCollection& headers) [0x00000] in /Developer/MonoTouch/Source/mono/mcs/class/System.Web.Services/System.Web.Services.Protocols/WebServiceHelper.cs:187 
  at System.Web.Services.Protocols.WebServiceHelper.ReadSoapMessage (System.Xml.XmlTextReader xmlReader, System.Web.Services.Protocols.SoapMethodStubInfo method, SoapHeaderDirection dir, Boolean soap12, System.Object& body, System.Web.Services.Protocols.SoapHeaderCollection& headers) [0x00011] in /Developer/MonoTouch/Source/mono/mcs/class/System.Web.Services/System.Web.Services.Protocols/WebServiceHelper.cs:182 
  at System.Web.Services.Protocols.SoapHttpClientProtocol.ReceiveResponse (System.Net.WebResponse response, System.Web.Services.Protocols.SoapClientMessage message, System.Web.Services.Protocols.SoapExtension[] extensions) [0x00149] in /Developer/MonoTouch/Source/mono/mcs/class/System.Web.Services/System.Web.Services.Protocols/SoapHttpClientProtocol.cs:322 
  at System.Web.Services.Protocols.SoapHttpClientProtocol.Invoke (System.String method_name, System.Object[] parameters) [0x000b8] in /Developer/MonoTouch/Source/mono/mcs/class/System.Web.Services/System.Web.Services.Protocols/SoapHttpClientProtocol.cs:379 
```

在 iOS 客户端，我们正在监视网络流量并通过对等方重置连接以及所有响应，即使某些响应返回正常。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T02:17:00.767

您似乎没有收到有效的 XML 响应。可能是服务不喜欢您的请求并返回 (HTML) 错误消息（例如 500）。

查看正在发生的事情的一种简单方法是使用 WireShark（或类似的工具来嗅探网络流量）并从 iOS 模拟器运行应用程序。捕获的数据应显示您的请求和来自服务器的响应。这将肯定地告诉您它是否是 XML 响应，或者，如果不是，您将返回的错误消息。

# c# - nHibernate Log4Net 日志记录异常

> ID：13629888
> 
> 赞同：0
> 
> 时间：2012-11-29T16:10:03.470
> 
> 标签：c#, .net, nhibernate, orm, log4net

我有一个项目，完全设置并使用 nHibernate 成功测试，我试图在 Visual Studio 2010 的调试模式下运行。在设置 log4net 之前运行项目显然运行良好，但添加对 log4net 程序集的引用，适当的行int web\Global.Asax文件，而web.config文件中的配置参数导致如下错误

> 覆盖成员时违反了继承安全规则：'log4net.Util.ReadOnlyPropertiesDictionary.GetObjectData(System.Runtime.Serialization.SerializationInfo, System.Runtime.Serialization.StreamingContext)'。重写方法的安全可访问性必须与被重写方法的安全可访问性相匹配。

在线

> 配置配置 = new Configuration().Configure();

在下面的代码块中

```
public static ISessionFactory SessionFactory;
    public static ISession OpenSession()
    {
        if (SessionFactory == null) //not threadsafe
        { //SessionFactories are expensive, create only once
            Configuration configuration = new Configuration().Configure();
            configuration.AddAssembly(Assembly.GetCallingAssembly());
            SessionFactory = configuration.BuildSessionFactory();
        }
        return SessionFactory.OpenSession();
    } 
```

我明确遵循本指南：[Configure Log4Net for use with NHibernate](http://nhforge.org/wikis/howtonh/configure-log4net-for-use-with-nhibernate.aspx) from the nHibernate project。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T18:14:26.977

您需要在 log4net 源中添加`SecurityCritical`属性，详见[https://stackoverflow.com/a/2977020/43846](https://stackoverflow.com/a/2977020/43846)`Util.ReadOnlyPropertiesDictionary.GetObjectData`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T06:55:10.003

您应该下载 log4net 的 1.2.11 版本。它包括一个针对 .NET 4.0 的程序集，其中包含更多固定属性，而不仅仅是一个属性。

# ruby-on-rails - 活动记录查询到 mongoid

> ID：13629891
> 
> 赞同：0
> 
> 时间：2012-11-29T16:10:12.850
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, mongoid

我想更改此查询：

```
messages = messages.where("name like :search or category like :search", search: "%#{params[:sSearch]}%") 
```

查询`mongoid`。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:20:31.467

对于 Mongoid 2.x：

```
messages = messages.any_of({ name:     /#{params[:sSearch]}/ }, 
                           { category: /#{params[:sSearch]}/ }) 
```

# scala - 元组的高阶函数

> ID：13629892
> 
> 赞同：7
> 
> 时间：2012-11-29T16:10:16.100
> 
> 标签：scala

我有以下问题。我试图制作一个接受两个参数的高阶函数：字符串和函数类型。函数类型是这样定义的：

```
(String, List[String]) => List[(String, List[String])] 
```

我还定义了两个具有相同类型的`f1`函数。`f2`之后我试图`myfun`用`f1`or打电话`f2`。这是代码：

```
object Main extends App {

def f1(t: (String,List[String])): List[(String,List[String])] = ...

def f2(t: (String,List[String])): List[(String,List[String])] =  ...

def myfun(tableName: String)(fn: (String,List[String]) => List[(String,List[String])]):  List[(String,List[String])] =
 ...

val res: List[(String,List[String])] = myfun("...")(f1)
res foreach println
val res2: List[(String,List[String])] = myfun("...")(f2)
res2 foreach println
} 
```

这是错误：

```
[error]  found   : (String, List[String]) => List[(String, List[String])]
[error]  required: (String, List[String]) => List[(String, List[String])]
[error]   val res: List[(String,List[String])] =  myfun("...")(f1) 
```

我不明白为什么编译器会抱怨。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-29T16:24:07.560

试试这个。请注意围绕参数列表的额外括号集`fn`。

```
def myfun(tableName: String)
         (fn: ((String,List[String])) => List[(String,List[String])]):  List[(String,List[String])] = ... 
```

不幸的是，需要这组额外的括号来区分

```
Function1[(String, List[String]), List[(String,List[String])]] 
```

从

```
Function2[String, List[String], List[(String, List[String])]] 
```

# android - Android 服务未启动

> ID：13629893
> 
> 赞同：4
> 
> 时间：2012-11-29T16:10:19.150
> 
> 标签：android, android-service

我试图向我的 android 应用程序添加服务，但该服务根本无法启动。我将它添加到我的 android 清单中，以便它在自己的进程中启动并创建一个广播接收器，它应该在 BOOT_COMPLETED 之后启动服务。

这是我清单的一部分

```
 <service android:process=":attachServiceBackground"
             android:name=".AttachService"
             android:icon="@drawable/camera"
             android:label="@string/attachServiceName" />

    <receiver android:name="AttachmentStartupReceiver"
                android:process=":attachServiceBackground">
        <intent-filter >
            <action android:name="android.intent.action.BOOT_COMPLETED"></action>      
        </intent-filter>

        </receiver> 
```

我的服务......刚刚添加了日志记录

```
public class AttachService extends Service {
    private static final String TAG = AttachService.class.getSimpleName();

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onCreate() {
        super.onCreate();
        Log.d(TAG, "onCreate service");

    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        Log.d(TAG, "onDestroy");
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Log.d(TAG, "onStartCommand");
        return super.onStartCommand(intent, flags, startId);
    }   
} 
```

还有我的广播接收器

```
public class AttachmentStartupReceiver extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {
    Intent attachSvc = new Intent(context, AttachService.class);
    context.startService(attachSvc);
}
} 
```

我看不到该服务在启动设备后启动，日志中没有“oncreate 服务”，而且我查看了设置->应用程序->运行服务。有人知道我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T16:23:08.323

您需要在清单文件中添加以下权限

```
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" /> 
```

BOOT_COMPLETED 默认不发送广播。

# android - Cordova Android 应用中的 Google Publisher Tag 广告

> ID：13629894
> 
> 赞同：4
> 
> 时间：2012-11-29T16:10:24.780
> 
> 标签：android, cordova, google-dfp

我正在使用 Cordova 2.2.0 框架内的 Android 应用程序，并且在基于 GPT 的广告上获得点击时遇到了很多麻烦。（当然我不是第一个尝试这个的人。）

GPT 使用广告素材呈现友好的 IFRAMES，主要包含`<a href="http://www.example.com/clickthrough/yadayadayada" target="_blank">(ad creative)</a>`

在浏览器和 iOS 上，点击广告将在新的浏览器窗口中打开点击，这就是我想要在这里发生的事情。但是在我的 Kindle Fire HD 和 Droid 4 上的原生应用程序上，点击广告会在 IFRAME 空间中打开点击槽页面，因此您会在我的另一个页面中看到页面的左上角 320x50。

我尝试编辑白名单，但这不是一个选项，因为广告素材可以来自任何地方（我们使用多个广告网络来填充我们的剩余广告），并且因为广告呈现在我无法控制的 IFRAME 中我没有能够将 HREF 包装在 中`javascript:window.open()`，但我还没有找到让 Android Java 代码拦截这些点击的方法。

我也研究过 AdMob，但我的老板不想改变我们移动网站的广告体验，移动网站有 1 到 3 个随页面滚动的广告。

*编辑*能够在广告所在的页面上呈现 AdMob 视图，以便视图随网站滚动，将起作用。

我该怎么做才能在新窗口中打开这些点击？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T15:45:29.327

我将此 JavaScript 代码添加到加载或刷新广告的函数中：

```
$('.advertisement iframe').each(function() {
    $(this).one('load', function() {
        makeOpenWindowHref(this);
    });
}); 
```

具有以下功能：

```
function makeOpenWindowHref(element) {
    if (isNativeApp){
        $(element).contents().find('a[href^="http"]').each(function() {
            $(this).click(function(event){
                event.preventDefault();
                navigator.app.loadUrl($(this).attr("href"), {
                    openExternal:true
                });
            });
        });
    }
} 
```

这实质上会修改 IFRAME 内容，以使用 Cordova`navigator.app.loadUrl()`函数将点击打开到新窗口中。

# javascript - 我将如何手动读取 CSS 文件

> ID：13629896
> 
> 赞同：1
> 
> 时间：2012-11-29T16:10:27.487
> 
> 标签：javascript, css

我正在寻找无效的 CSS 值，例如 'left: 50%-@@this.width;' 但是当然，浏览器在加载时会去除无效的 CSS，因此在加载之前解析 CSS 似乎是唯一的方法。

现在我能看到的唯一解决方案是扫描所有链接和脚本标签，然后为链接的 href 发出 ajax 请求。这感觉很草率，我觉得必须有一种更简单的方法来做到这一点。任何有关获得原始 CSS 的更简单方法的帮助将不胜感激。

我知道 lesscss 与我想要完成的事情类似，但是我需要一个无库的解决方案。

# sql-server - 在什么情况下逻辑读取会增加但执行时间会减少？

> ID：13629897
> 
> 赞同：0
> 
> 时间：2012-11-29T16:10:28.630
> 
> 标签：sql-server, performance

在对查询进行性能调优时，是否可以减少执行时间但增加逻辑读取次数？这似乎发生在我的一个查询中，我对联接进行了修改并分组到一个大表上（我认为主要的变化是先进行 Group BY，然后对派生的查询进行联接）并且它加快了速度执行但增加了逻辑读取的数量。为什么会这样，什么样的变化可能会导致这种情况？

SQL 服务器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T18:36:26.093

逻辑读取度量不是一个好的度量，因为它不考虑从缓冲池（缓存）读取。我认为这个指标除了少数例外几乎没有用处。

> 在什么情况下逻辑读取会增加但执行时间会减少？

带有索引查找的嵌套循环连接至少会产生一次逻辑读取。如果所有读取的页面都被缓存，尽管此操作的实际成本将非常低。

因此，您会看到逻辑读取是一个非常具有误导性的计数器。尝试针对实际的物理 IO、CPU 使用率和延迟进行优化。

# php - Joomla - MVC 模型/视图注册

> ID：13629898
> 
> 赞同：1
> 
> 时间：2012-11-29T16:10:43.333
> 
> 标签：php, joomla

我有一个组件，我需要为其注册第二个视图。当我编码我的网址以设置视图变量时：

```
http://www.mysite.com/index.php?option=com_mycom&view=view1 
```

至

```
http://www.mysite.com/index.php?option=com_mycom&view=view2 
```

View2 不会显示。

我需要在控制器中注册第二个视图吗？你能给我指个参考吗？谷歌搜索结果为零。

**编辑**

view2 代码：

```
defined( '_JEXEC' ) or die( 'Restricted access' );

jimport( 'joomla.application.component.view');

/**
 * HTML View class for the mls Component
 *
 * @package    UniversalDynamicMedia.com
 * @subpackage  Components
 */
class mlsViewlist extends JView
{
function display($tpl = null)
{
    $model = &$this->getModel();
    $array = $model->mlsListData();
    $disparray =    foreach ($array as list($a,$b,$c,$d,$e)) {
                echo <tr><td>$a</td><td>$b</td><td>$c</td><td>$d</td><td>$e</td></tr>
            }
    $this->assignRef( 'disparray', $disparray );
    parent::display($tpl);
}
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:36:23.230

你在这里有一个语法错误：

```
echo <tr><td>$a</td><td>$b</td><td>$c</td><td>$d</td><td>$e</td></tr> 
```

应该

```
echo "<tr><td>$a</td><td>$b</td><td>$c</td><td>$d</td><td>$e</td></tr>"; 
```

回显字符串文字时需要引号。不过，您甚至不应该在这里呼应任何东西。所有输出都应该在视图的 Default.php 而不是 view.html.php 中完成。这样做的原因是因为Joomla 需要首先输出您的组件（即页眉）之前的所有内容。

# c++ - C++ thrift 实现作为一个类

> ID：13629900
> 
> 赞同：1
> 
> 时间：2012-11-29T16:10:44.833
> 
> 标签：c++, boost, thrift

因此，我正在尝试将大多数教程提供的以下 C++ thrift 服务器实现转换为类形式：

```
int port = 9090;
  shared_ptr<SomethingHandler> handler(new SomethingHandler());
  shared_ptr<TProcessor> processor(new SomethingProcessor(handler));
  shared_ptr<TServerTransport> serverTransport(new TServerSocket(port));
  shared_ptr<TTransportFactory> transportFactory(new TBufferedTransportFactory());
  shared_ptr<TProtocolFactory> protocolFactory(new TBinaryProtocolFactory());

  TSimpleServer server(processor, serverTransport, transportFactory, protocolFactory); 
```

为此，我创建了所有 shared_ptrs 和 TSimpleServer 成员，但我在初始化分配方面遇到了麻烦。

在初始化列表中构造 shared_ptr 似乎会导致 badmalloc 错误，因此我的解决方法是将它们声明为成员并通过分配进行初始化：

```
 handler = shared_ptr<type>(new Type). 
```

这里的问题是 TSimpleServer 没有赋值运算符或构造函数采用 void，因此它需要在构造函数时构造它所依赖的 shared_ptrs 以便可以构造它。
有什么想法我在这里想念的吗？

更多伪代码：

```
class myclass {
 int port;
 shared_ptr<MyHandlder> handler;
 shared_ptr<TProcessor> processor;
 shared_ptr<TServerTransport> serverTransport;
 shared_ptr<TTransportFactory>  transportFactory;
 shared_ptr<TProtocolFactory> protocolFactory;
 TSimpleServer server;

  public: 
        explicit myclass(): port(9090), handler(new MyHandler()), processor(new MyProcessor(handler)), serverTransport(new TServerSocket(port)), transportFactory(new TBufferedTransportFactory()), protocolFactory(new TBinaryProtocolFactory()), server(processor, serverTransport, transportFactory, protocolFactory) { }

 int start () { server.serve() } 
```

# php - 具有根属性的 Json 解码

> ID：13629902
> 
> 赞同：3
> 
> 时间：2012-11-29T16:10:47.940
> 
> 标签：php, json

我似乎无法弄清楚，或找到任何信息来帮助我解决应该是一个简单的问题.. 我有一些 php 代码，它使用 curl get request 与 api 对话，我从 api 得到的响应是

```
{"styleHolder":[{"id":100000929,"makeId":200005143,"year":2001,"makeName":"Ford","makeNiceName":"ford","modelId":"Ford_F_150","ect....... 
```

我需要的是获取 id，并将其转换为 php 变量..

我知道如何使用类似的东西：

```
$myArray = json_decode($resp);
$id = $myArray->id;
echo $id; 
```

但是因为响应将 styleHolder 作为根属性，我似乎无法弄清楚如何分配 id ..任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T16:11:57.720

`styleHolder`是一个数组，所以你需要先访问数组元素，然后是`id`属性。

```
$myArray = json_decode($resp);
$id = $myArray->styleHolder[0]->id;
echo $id; 
```

# codeigniter - DataTables 列过滤器加载项显示，但未过滤输出

> ID：13629903
> 
> 赞同：0
> 
> 时间：2012-11-29T16:10:53.783
> 
> 标签：codeigniter, datatables

我刚刚将 DataTables Column Filter Add-on 添加到我的数据表中，它在页脚上显示了列搜索字段。但是，如果我输入“处理”会在短时间内完成，但结果不会更新。即过滤。

我在后端使用 codeIgniters ignitedDatatables。其他一切都很好（分页，右上角的全局搜索，）我在网上没有发现我是否需要配置其他东西才能使过滤器工作。

这是我的看法-

```
<html>
<head>
    <link rel="stylesheet" type="text/css" href="http://localhost/eshop/css/admin/style.css" />

    <script type="text/javascript" language="javascript" src="<?php echo base_url() ?>js/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" language="javascript" src="<?php echo base_url() ?>js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" language="javascript" src="<?php echo base_url() ?>js/jquery.dataTables.columnFilter.js"></script>

    <link rel="stylesheet" type="text/css" href="<?php echo base_url() ?>css/jquery.dataTables_themeroller.css"/>

    <link rel="stylesheet" href="http://localhost/eshop/css/admin/smoothness/jquery-ui-custom.css"/>

    <script>

        $(document).ready(function() {   
            $('#data_table').dataTable( {
                "bProcessing": true,
                "bServerSide": true,
                "bJQueryUI": true,           
                "sPaginationType": "full_numbers",
                "sAjaxSource": "<?php echo base_url() ?>grid/getCustomers"
            } ).columnFilter(
            {
                aoColumns: [
                    {
                        type: "number"
                    },
                    {
                        type: "text",
                        bRegex: true,
                        bSmart: true
                    },
                    null
                ]
            }
        );

        } );

    </script>

</head>
<body>
    <div class="widget_body">
        <table id="data_table" class="data_table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
            </tbody>
            <tfoot style="background-color: whitesmoke;">
                <tr>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
            </tfoot>
        </table>
    </div>
</body> 
```

我的控制

```
//display
public function index()
{
    $this->load->view('datatableview');
}

//ajax request handler
public function getCustomers()
{
    $this->load->library('datatables');

    $this->datatables->select('id,first_name,last_name')
            ->from('data_table');
    echo $this->datatables->generate();

} 
```

正如我之前所说，ID 和名字的底部出现了 2 个输入框，但是一旦我输入这些框，我就看不到显示的变化

如果我在第二列的输入框中键入 =“Bjo”，我发现来自 firebug 的获取请求是

```
_=1354249241305
bRegex=false
bRegex_0=false
bRegex_1=true
bRegex_2=false
bSearchable_0=true
bSearchable_1=true
bSearchable_2=true
bSortable_0=true
bSortable_1=true
bSortable_2=true
iColumns=3
iDisplayLength=10
iDisplayStart=0
iSortCol_0=0
iSortingCols=1
mDataProp_0=0
mDataProp_1=1
mDataProp_2=2
sColumns=
sEcho=22
sRangeSeparator=~
sSearch=
sSearch_0=
sSearch_1=Bjo
sSearch_2=
sSortDir_0=asc 
```

找到响应

```
{"sEcho":22,"iTotalRecords":30,"iTotalDisplayRecords":30,"aaData":[["1","Shabab","Haider"],["2","Anas","Numan"],["3","Bjoy","Manik"],["4","Bjoy","Manik"],["5","Bjoy","Manik"],["6","Bjoy","Manik"],["7","Bjoy","Manik"],["8","Bjoy","Manik"],["9","Bjoy","Manik"],["10","Bjoy","Manik"]],"sColumns":"id,first_name,last_name"} 
```

编辑：自从我使用该插件以来已经有一段时间了。我在 github 中使用我的过滤代码创建了一个分支。但它需要一些测试。当我有时间时，我会自己测试它-同时，如果有人想成为亲爱的并为他人做这件事-

```
https://github.com/shababhsiddique/Ignited-Datatables/blob/Branche_Column_Filter/application/libraries/Datatables.php 
```

这是我很久以前使用的实际代码。它很旧，看看它是否适用于你的版本

```
https://drive.google.com/file/d/0BzKzAVzAWPRgcmNCbGhnU3pqaW8/view?usp=sharing 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-18T10:02:05.917

我只是认为 json 生成库有问题。

[点燃](https://github.com/IgnitedDatatables/Ignited-Datatables/)的数据表库不完整。我不得不修改他们的图书馆

我不记得我所做的所有更改（那里有很多）但我记得我更改了所有输入->获取输入->发布和所有 $_GET 到 $_POST

我想我也修改了这个功能

```
protected function get_filtering() 
```

这是我使用的当前编辑库-

> `{ http://162.212.134.58/shabab/Datatables.zip }`

您可以将您的图书馆与我的图书馆相匹配以找出答案。

我还没有更新到最新的数据表。

# linux - 字符串操作 - 替换某些字符

> ID：13629906
> 
> 赞同：1
> 
> 时间：2012-11-29T16:11:11.673
> 
> 标签：linux, bash, sed

我有一个 linux 命令输出如下文件列表：

```
 folder/folder/folder/file_1
    folder_1/folder/folder/file2 
```

我想格式化此输出，以便满足以下条件：

*   最后一个斜杠 (/) 始终替换为三个下划线
*   除最后一个斜线外，每个斜线都替换为一个下划线
*   文件夹名称中的任何下划线都将替换为两个下划线
*   文件名中的任何下划线都保持原样

上面看起来像：

```
 folder_folder_folder___file_1
    folder__1_folder_folder___file2 
```

如果您还可以解释您的解决方案，那将很有帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T16:16:59.753

```
# Assume each line in a variable called $value
# Split the values up into dirname and basename
val_dir="${value%/*}"
val_base="${value##*/}"

# Replace underscores in dirname with two underscores
val_dir="${val_dir//_/__}"
# Replace slashes in dirname with single underscore
val_dir="${val_dir//\//_}"

# Re-join dirname and basename with three underscores
result="${val_dir}___${val_base}" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T18:48:20.440

一个 awk 解决方案：

```
awk '
  BEGIN {FS="/";OFS="_"}
  {for (i=1; i<NF; i++) gsub("_","__",$i); $NF="__" $NF; print}
' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T19:38:18.080

这是您可以使用 sed 完成的一种方法（使用 GNU sed 测试）：

```
<infile rev | sed -r 'h; s,_,__,g; G; s,[^/]+/([^\n]+)\n([^/]+/).*,\2\1,; :a; s,/,_,2; ta; s,/,___,' | rev 
```

输出：

```
folder_folder_folder___file_1
folder__1_folder_folder___file2 
```

`rev`使其更易于解析，它所做的只是反转行中字符的顺序。我将分解下面的 sed 脚本：

```
h;                                  # save a copy of PS in HS, prepare to replace folder underscores
s,_,__,g;                           # replace folder underscores 
G;                                  # append HS to PS
s,[^/]+/([^\n]+)\n([^/]+/).*,\2\1,; # reorder into correct order
:a;
s,/,_,2;                            # replace most / with _, leave the first alone
ta;
s,/,___,                            # replace the first / with ___ 
```

# jquery - 带有 Knockout.js 的 jQuery UI 日期选择器

> ID：13629910
> 
> 赞同：4
> 
> 时间：2012-11-29T16:11:35.027
> 
> 标签：jquery, jquery-ui, knockout.js, datepicker

我正在使用 knockout.js 来添加和删除表单中的字段。到目前为止它工作正常，但是我需要一个 datepicker 选项，所以我使用了 jQuery 的 UI datepicker。这有效，但仅适用于第一个日期选择器，不适用于其他任何地方。因此，每当我单击“添加”时，我都会得到新字段，但没有日期选择器。

我用谷歌搜索并搜索了[StackExchange](https://stackoverflow.com/questions/6612705/knockout-with-jquery-ui-datepicker)，但没​​有找到复制字段的解决方案。

**HTML**

```
<table data-bind='visible: beschikkingen().length > 0'>
            <thead>
                <tr>
                    <th>Beschikkingsdatum</th>
                    <th>Beschikkingsnr</th>
                    <th />
                </tr>
            </thead>
            <tbody data-bind='foreach: beschikkingen'>
                <tr>
                    <td><input name="beschikkingsdatum[]" type="text" class="beschikkingsdatum" value="" data-bind='value: beschikkingsdatum, uniqueName: true' /> </td>
                    <td><input class='required number' data-bind='value: beschikkingsnummer, uniqueName: true' /></td>
                    <td><a href='#' data-bind='click: $root.removebeschikking'>Delete</a></td>
                </tr>
            </tbody>
        </table> 
```

**淘汰赛.JS**

```
var beschikkingModel = function(beschikkingen) {
    var self = this;
    self.beschikkingen = ko.observableArray(beschikkingen);

    self.addbeschikking = function() {
        self.beschikkingen.push({
            beschikkingsdatum: "",
            beschikkingsnummer: ""
        });
    };

    self.removebeschikking = function(beschikking) {
        self.beschikkingen.remove(beschikking);
    };

    self.save = function(form) {
        alert("Could now transmit to server: " + ko.utils.stringifyJson(self.beschikkingen));
        // To actually transmit to server as a regular form post, write this: ko.utils.postJson($("form")[0], self.beschikkingen);
    };
};

var viewModel = new beschikkingModel([
    {
        beschikkingsdatum: "",
        beschikkingsnummer: ""
    }
]);
ko.applyBindings(viewModel);

// Activate jQuery Validation
$("form").validate({ submitHandler: viewModel.save });
//]]> 
```

**日期选择器**

```
$(window).load(function(){
$('.beschikkingsdatum').datepicker({
    dateFormat: 'dd-mm-yy',
    constrainInput: false
});
}); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-29T16:31:28.137

使用自定义绑定处理程序可以解决您的问题：

```
ko.bindingHandlers.datepicker = {
    init: function (element, valueAccessor, allBindingsAccessor) {
        var options = allBindingsAccessor().datepickerOptions || {};
        $(element).datepicker(options);

        //handle the field changing
        ko.utils.registerEventHandler(element, "change", function () {
            var observable = valueAccessor();
            observable($(element).datepicker("getDate"));
        });

        //handle disposal (if KO removes by the template binding)
        ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
            $(element).datepicker("destroy");
        });
    }
}; 
```

在 HTML 中：

```
<input data-bind='datepicker: beschikkingsdatum' /> 
```

这是工作小提琴：http: [//jsfiddle.net/QUxyy/](http://jsfiddle.net/QUxyy/)

# maven - 将 ant 任务构建的 jar 安装到本地 maven 存储库中

> ID：13629911
> 
> 赞同：1
> 
> 时间：2012-11-29T16:11:36.080
> 
> 标签：maven, ant, maven-ant-tasks

这是我想在我的 Ant 脚本末尾运行的命令：

```
 mvn install:install-file -Dfile=C:\dev\common\somejar.jar -DgroupId=com.myco.gt -DartifactId=somejar-Dversion=1.0.0 -Dpackaging=jar -DgeneratePOM=true 
```

如果我在 Ant 脚本的末尾输入以下目标：

```
<target name='install_mvn_dependencies' depends='build_jars'>
    <exec executable="mvn">
        <arg value="install:install-file"/>
        <arg value="-Dfile=c:\dev\common\somejar.jar"/>
        <arg value ="-DgroupId=com.myco.gt"/>
        <arg value="-DartifactId=somejar"/>
        <arg value="-Dversion=1.2.0"/>
        <arg value="-Dpackaging=jar"/>
        <arg value="-DgeneratePOM=true"/>       
    </exec>   
</target> 
```

我明白了`CreateProcess error=2\. The system cannot find the path specified.`

即使我可以在命令行上运行 mvn。是什么赋予了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T16:51:37.713

该`mvn`命令实际上是一个批处理命令，所以不能直接执行。尝试这个：

```
<exec executable="cmd.exe">
    <arg value="/c"/>
    <arg value="mvn.bat"/>
    <arg value="install:install-file"/>
    <arg value="-Dfile=c:\dev\common\somejar.jar"/>
    <arg value ="-DgroupId=com.myco.gt"/>
    <arg value="-DartifactId=somejar"/>
    <arg value="-Dversion=1.2.0"/>
    <arg value="-Dpackaging=jar"/>
    <arg value="-DgeneratePOM=true"/>       
</exec> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:14:41.840

因为它是 ant / java，所以我希望这样：（未经测试！）

```
 <arg value="-Dfile=c:\\dev\\common\\somejar.jar"/> 
```

注意双反斜杠，否则它将是一个转义并且可能找不到路径。IIRC 你也可以使用正斜杠。

```
 <arg value="-Dfile=c:/dev/common/somejar.jar"/> 
```

另请参阅：[Ant 使用反斜杠而不是斜杠生成 jsfl](https://stackoverflow.com/questions/1799684/ant-produces-jsfl-with-backslashes-instead-of-slashes)

# xml - CouchDB 以 XML 格式返回数据

> ID：13629914
> 
> 赞同：2
> 
> 时间：2012-11-29T16:11:40.837
> 
> 标签：xml, view, couchdb, show

我正在尝试使用 CouchDB，但我对它很陌生。

我存储了数据，我想查询它并以 XML 格式返回数据。

我是写视图还是显示函数？在蒲团上哪里写一个显示功能？

有没有人有任何例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T15:20:50.873

如果您不想使用 CouchApp 并且只想将您的视图作为 xml 获取，您可以使用这个衬里 (-ish) 列表：

```
"xml": "function element(name, row){send('<' + name + '>\\n');   for(field in row) {  if (typeof(row[field])=='object') {element(field, row[field])} else {send('<field name=\"' + field + '\">');  send((''+row[field]).replace(/&/g,'&amp;').replace(/</g,'&lt;'));  send('</field>\\n');}  }   send('</' + name + '>\\n');};        function(head, req) {    provides('xml', function() {    send('<xml>\\n');    while (row=getRow()) {   element('row', row)   }    send('</xml>');   });    }" 
```

我将其保留为一行，因为它必须在设计文档中作为单行函数输入。

**创建设计文档**

如果您还没有设计文档，最简单的创建方法是在 futons Temporary View 和 [Save As...] 您选择的 design_document_name 和您选择的 view_name 中创建一个视图。我将在此使用设计文档“select”和一个名为“by_id”的视图。我的 by_id 视图如下所示：

```
function(doc) {
  emit(doc._id, null);
} 
```

**将列表输入到设计文档中**

创建完成后，从蒲团的下拉菜单中选择查看“设计文档”。单击新（可能）创建的设计文档_design/select。

选择选项卡 Source 并双击 Source。在“views”之前再次单击：...并确保您将插入符号放在那里。

在该行上方新建一行并输入：

```
"lists": {
    |
} 
```

在花括号的中间（管道字符所在的位置）从上方粘贴单衬。保存文档。

**使用新列表并获取 XML**

现在，您可以从任何视图获取任何数据作为 XML。请注意，您只能直接使用视图而不是整个数据库内容，即使我的视图就是这样做的。

要查看您的数据，请在浏览器中使用此 URL：

```
http://localhost:5984/content/_design/select/_list/xml/by_id?include_docs=true&limit=10 
```

*   参数 include_docs=true 使每个文档成为结果列表的一部分。这是标准的 CouchDB 功能。
*   参数 limit=10 将结果列表保持在最多 10 个文档，以限制如果您有一个大型数据库所花费的时间。
*   如果视图中有 reduce 函数，也可以输入参数 reduce=false。

**它在我的电脑上的外观**

当我直接使用视图时，我有一个如下所示的数据库：

url=localhost:5984/cartoons/_design/select/_view/by_id?include_docs=true

```
{"total_rows":6,"offset":0,"rows":[
{"id":"Batman","key":"Batman","value":null,"doc":{"_id":"Batman","_rev":"1-0ec5a1032c2fa8486c921924e13a31cf","publisher":"DC Comics"}},
{"id":"Donald Duck","key":"Donald Duck","value":null,"doc":{"_id":"Donald Duck","_rev":"1-1c431dfb2c46991ec999743830a5363b","publisher":"Walt Disney"}},
{"id":"Iron Man","key":"Iron Man","value":null,"doc":{"_id":"Iron Man","_rev":"1-4f3a3d862b3601a74d6277f4be930e33","publisher":"Marvel Comics"}},
{"id":"Mickey Mouse","key":"Mickey Mouse","value":null,"doc":{"_id":"Mickey Mouse","_rev":"1-1c431dfb2c46991ec999743830a5363b","publisher":"Walt Disney"}},
{"id":"Spider-Man","key":"Spider-Man","value":null,"doc":{"_id":"Spider-Man","_rev":"1-4f3a3d862b3601a74d6277f4be930e33","publisher":"Marvel Comics"}},
{"id":"Superman","key":"Superman","value":null,"doc":{"_id":"Superman","_rev":"1-0ec5a1032c2fa8486c921924e13a31cf","publisher":"DC Comics"}}
]} 
```

**在 XML 中**

url=localhost:5984/cartoons/_design/select/_list/xml/by_id?include_docs=true

```
<xml>
    <row>
        <field name="id">Batman</field>
        <field name="key">Batman</field>
        <value>
        </value>
        <doc>
            <field name="_id">Batman</field>
            <field name="_rev">1-0ec5a1032c2fa8486c921924e13a31cf</field>
            <field name="publisher">DC Comics</field>
        </doc>
    </row>
    <row>
        <field name="id">Donald Duck</field>
        <field name="key">Donald Duck</field>
        <value>
        </value>
        <doc>
            <field name="_id">Donald Duck</field>
            <field name="_rev">1-1c431dfb2c46991ec999743830a5363b</field>
            <field name="publisher">Walt Disney</field>
        </doc>
    </row>
    <row>
        <field name="id">Iron Man</field>
        <field name="key">Iron Man</field>
        <value>
        </value>
        <doc>
            <field name="_id">Iron Man</field>
            <field name="_rev">1-4f3a3d862b3601a74d6277f4be930e33</field>
            <field name="publisher">Marvel Comics</field>
        </doc>
    </row>
    <row>
        <field name="id">Mickey Mouse</field>
        <field name="key">Mickey Mouse</field>
        <value>
        </value>
        <doc>
            <field name="_id">Mickey Mouse</field>
            <field name="_rev">1-1c431dfb2c46991ec999743830a5363b</field>
            <field name="publisher">Walt Disney</field>
        </doc>
    </row>
    <row>
        <field name="id">Spider-Man</field>
        <field name="key">Spider-Man</field>
        <value>
        </value>
        <doc>
            <field name="_id">Spider-Man</field>
            <field name="_rev">1-4f3a3d862b3601a74d6277f4be930e33</field>
            <field name="publisher">Marvel Comics</field>
        </doc>
    </row>
    <row>
        <field name="id">Superman</field>
        <field name="key">Superman</field>
        <value>
        </value>
        <doc>
            <field name="_id">Superman</field>
            <field name="_rev">1-0ec5a1032c2fa8486c921924e13a31cf</field>
            <field name="publisher">DC Comics</field>
        </doc>
    </row>
</xml> 
```

# windows - 我如何知道哪个 PDB 文件包含给定结构的类型信息？

> ID：13629915
> 
> 赞同：0
> 
> 时间：2012-11-29T16:11:46.690
> 
> 标签：windows, debugging, winapi, debug-symbols

我正在将一些 Windows 头文件翻译成 Delphi。为了验证相关 C 结构的对齐，我需要转储某些 PDB 文件以查看相关的类型信息。为此，我尝试使用[PdbXtract](https://www.mandiant.com/blog/archives/2512)，但此工具要求我选择要检查的 PDB 文件。我如何知道哪个 PDB 文件包含所需的结构定义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T14:12:10.263

使用 SysInternals（现为 MS）的 strings.exe 命令行实用程序。我在符号文件夹中运行了以下`strings -s . | findstr /i critical_section`命令，得到了很多有趣的输出：

`C:\debuggers-v6.12.2.633-x86\sym\verifier.pdb\8878279C450C4F4DA6B252A4B824B4981\verifier.pdb: _RTL_CRITICAL_SECTION C:\debuggers-v6.12.2.633-x86\sym\verifier.pdb\8878279C450C4F4DA6B252A4B824B4981\verifier.pdb: U_RTL_CRITICAL_SECTION@@ C:\debuggers-v6.12.2.633-x86\sym\wntdll.pdb\B193CACD9AB340E7BF3434EA1ABBE0482\wntdll.pdb: _RTL_CRITICAL_SECTION C:\debuggers-v6.12.2.633-x86\sym\wntdll.pdb\B193CACD9AB340E7BF3434EA1ABBE0482\wntdll.pdb: U_RTL_CRITICAL_SECTION@@ C:\debuggers-v6.12.2.633-x86\sym\wntdll.pdb\B193CACD9AB340E7BF3434EA1ABBE0482\wntdll.pdb: _RTL_CRITICAL_SECTION_DEBUG`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T07:00:12.073

*在使用十六进制编辑器调查 PDB 文件后，我通过使用类似grep 的*工具搜索包含以下正则表达式模式的 PDB 文件名来了解哪个 PDB 文件包含所需的结构定义：

```
\x15\x00\x00\x80\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00_Struct_Name\x00 
```

# asp.net - 在不阻塞工作线程的情况下延迟 ASP.NET 响应

> ID：13629920
> 
> 赞同：1
> 
> 时间：2012-11-29T16:12:00.643
> 
> 标签：asp.net

因此，我一直在阅读有关通过使用呈指数增长的延迟来限制来自 IP 地址或针对用户的登录请求的领域。这是服务器不会响应的人为延迟，有效地坐在响应上。到目前为止，我几乎没有找到很好地实现这种延迟的方法。

我的选择是：

Thread.Sleep() - 它可以工作，但 DDOS 攻击很容易吃掉 ASP.NET 中所有可用的工作线程

或者

返回类似 429（请求过多）的内容，直到延迟到期。

所以有两种不同的方法，一种是立即回复并将工作交给客户端再试一次，另一种是服务器将坐在请求上并延迟响应。

理想情况下，我希望使用后者，让服务器延迟响应。我已经按照这个答案尝试了 HttpAsyncHandler：[https ://stackoverflow.com/a/1614625](https://stackoverflow.com/a/1614625)

我在 HttpAsyncHandler 中发生了 Thread.Sleep，但问题是响应已经返回到客户端。答案说我应该在让响应返回之前阻止 WaitHandle，但我不知道该怎么做，从我所见，我仍然会阻止工作线程同时处理另一个请求一定。

就好像我需要工作线程来接收新请求和接收延迟请求以发出响应。这可以在 ASP.NET Web 窗体中执行吗？MVC AsyncController 看起来非常适合我的需要，但在这种情况下我不能使用它。

# javascript - 无限循环中的字体颜色变化

> ID：13629922
> 
> 赞同：2
> 
> 时间：2012-11-29T16:12:09.040
> 
> 标签：javascript, jquery, html, css

我有这个 HTML 标签：

```
<div id="alert">Warning!!</div>​ 
```

我想给它一个动画效果，在红黑无限循环中改变它的字体颜色。

我尝试使用 Webkit 颜色转换循环作为带有字体颜色的背景颜色：

```
#alert {font-color: #39f !important;}
@-webkit-keyframes colours {
      0% {font-color: #000;}
     50% {font-color: #990000;}
     100% {font-color: #FF0000;}

}
#alert {
    -webkit-animation-direction: normal;
    -webkit-animation-duration: 60s;
    -webkit-animation-iteration-count: infinite;
    -webkit-animation-name: colours;
    -webkit-animation-timing-function: ease;
}​ 
```

但它不起作用。

参考：[http](http://snipplr.com/view/33728/)
://snipplr.com/view/33728/ 我的代码：http: [//jsfiddle.net/LDRR7/9/](http://jsfiddle.net/LDRR7/9/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-29T16:16:10.083

您想使用颜色，因为 font-color 属性不存在。

另请注意，您使用的教程适用于 webkit 浏览器，但不适用于 firefox！所以我添加了firefox前缀。

见[http://jsfiddle.net/LDRR7/21/](http://jsfiddle.net/LDRR7/21/)

```
 #alert {color: #39f !important;}
@-webkit-keyframes colours {
     0% {color: #39f;}
 25% {color: #8bc5d1;}
 50% {color: #f8cb4a;}
 75% {color: #8bc5d1;}
100% {color: #39f;}

}
@-moz-keyframes colours {
      0% {color: #39f;}
 25% {color: #8bc5d1;}
 50% {color: #f8cb4a;}
 75% {color: #8bc5d1;}
100% {color: #39f;}

}

#alert {
    -webkit-animation-direction: normal;
    -webkit-animation-duration: 10s;
    -webkit-animation-iteration-count: infinite;
    -webkit-animation-name: colours;
    -webkit-animation-timing-function: ease;
    -moz-animation-direction: normal;
    -moz-animation-duration: 10s;
    -moz-animation-iteration-count: infinite;
    -moz-animation-name: colours;
    -moz-animation-timing-function: ease;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T16:20:16.243

使用`color`，不使用`font-color`。

此外，您的动画是错误的，它不会褪色回原来的颜色，试试这个：

```
#alert {color: #39f !important;}
@-webkit-keyframes colours {
      0% {color: #39f;}
     25% {color: #8bc5d1;}
     50% {color: #f8cb4a;}
     75% {color: #8bc5d1;}
    100% {color: #39f;}

}
#alert {
    -webkit-animation-direction: normal;
    -webkit-animation-duration: 20s;
    -webkit-animation-iteration-count: infinite;
    -webkit-animation-name: colours;
    -webkit-animation-timing-function: ease;
}​ 
```

示例：http: [//jsfiddle.net/pitaj/LDRR7/13/](http://jsfiddle.net/pitaj/LDRR7/13/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T16:21:11.627

css 无法识别“字体颜色”。尝试“颜色”，并将持续时间更改为喜欢 1 秒以获得“闪光”效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-22T14:36:27.087

使用 Css 更改颜色很容易。调用类并使用**动画**， **-webkit-animation**属性。这两个属性调用了一种函数，你会以秒为单位传递时间（例如：`animation: colorchange 50s; -webkit-animation: colorchange 50s;`

）。然后你改变函数内部的颜色，在我们的例子中它被称为“colorchange”。使用函数的方法是使用`@keyframes colorchange`或`@-webkit-keyframes colorchange`。很简单。另外要注意的是浏览器。对于像chrome safari这样的浏览器使用@-webkit -keyframes colorchange 并指定颜色。U 可以 c 魔术。一个明确的例子如下：

```
#Class .inner {
        -moz-transition: height 0.2s ease-in-out, width 0.2s ease-in-out;
        -webkit-transition: height 0.2s ease-in-out, width 0.2s ease-in-out;
        -ms-transition: height 0.2s ease-in-out, width 0.2s ease-in-out;
        transition: height 0.2s ease-in-out, width 0.2s ease-in-out;
        display: -moz-flex;
        display: -webkit-flex;
        display: -ms-flex;
        display: flex;
        -moz-flex-direction: column;
        -webkit-flex-direction: column;
        -ms-flex-direction: column;
        flex-direction: column;
        -moz-justify-content: center;
        -webkit-justify-content: center;
        -ms-justify-content: center;
        justify-content: center;
        -moz-align-items: center;
        -webkit-align-items: center;
        -ms-align-items: center;
        align-items: center;
        display: -ms-flexbox;
        -ms-flex-align: center;
        -ms-flex-pack: center;
        background: #e74c3c;                                  /*circle circle*/
        border-radius: 100%;
        width: 35em;
        height: 35em;
        padding: 4em;
        text-align: center;
        box-shadow: 0 0 0 1em #FFF;
        cursor: default;

        animation: **colorchange** **50s**;
        -webkit-animation: **colorchange** **50s**;
    }

@keyframes colorchange
{
0%   {background: #e74c3c;}
15%  {background: violet;}
30%  {background:indigo;}
45%  {background: blue;}
60% {background: green;}
75% {background: orange;}
90% {background: purple;}
100% {background: #e74c3c;}
}

@-webkit-keyframes colorchange /* Safari and Chrome - necessary duplicate */
{
    0%   {background: #e74c3c;}
    15%  {background: violet;}
    30%  {background:indigo;}
    45%  {background: blue;}
    60% {background: green;}
    75% {background: orange;}
    90% {background: purple;}
    100% {background: #e74c3c;}
} 
```

希望它易于理解（'-'）；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-11T03:34:35.060

```
#alert {color: #FF35CE !important; font-weight:700 ;animation:changecolor 5s;
-moz-animation:changecolor 5s; /* Firefox */
-webkit-animation:changecolor 5s; /* Safari and Chrome */
-o-animation:changecolor 5s; /* Opera */
-moz-animation-iteration-count: infinite;
-webkit-animation-iteration-count: infinite;
-o-animation-iteration-count: infinite;
}

@keyframes changecolor
{
0%   {color:red;}
25%  {color:yellow;}
50%  {color:blue;}
75% {color:green;}
100%   {color:red;}
}

@-moz-keyframes changecolor /* Firefox */
{
0%   {color:red;}
25%  {color:yellow;}
50%  {background:blue;}
75% {color:green;}
100%   {color:red;}
}

@-webkit-keyframes changecolor /* Safari and Chrome */
{
0%   {color:red;}
25%  {color:yellow;}
50%  {color:blue;}
75% {color:green;}
100%   {color:red;}
}

@-o-keyframes changecolor /* Opera */
{
0%   {color:red;}
25%  {color:yellow;}
50%  {color:blue;}
75% {color:green;}
100%   {color:red;}
} 
```

# ios - 如何使 CALayer 可点击？

> ID：13629923
> 
> 赞同：1
> 
> 时间：2012-11-29T16:12:11.197
> 
> 标签：ios, uibutton, core-animation, calayer, catransformlayer

我正在使用 CATransformLayer 创建一堆图层并使用 3D 透视为它们制作动画以制作一个立方体（类似这样）

![带有子层的 CATransformLayer](../Images/92f548d3a65ba1135ff4a7e723b277b5.png)

**将 UIButton 添加到该立方体的一侧的最佳方法是什么？**我希望能够接收事件并从 IBOutlet 访问按钮。

我尝试在我的 XIB 中创建一个带有按钮的 UIView，并将其图层插入 CATransformLayer，它显示但按钮不可点击。我有一种感觉，这是因为 UIKit 处理的是触摸/事件方面的事情，图层只是用来绘制的。

（顺便说一句，我看过[这个问题](https://stackoverflow.com/questions/8110543/how-can-i-make-a-ui-element-added-via-addsublayer-respond-to-touch-events?rq=1)，但觉得这个案例的不同足以保证一个新的帖子）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:23:05.153

托管所有图层的根视图正在获取图层树的所有内容

在那里你必须做

```
CALayer *touchedLayer = [self.rootLayer hitTest:touches.anyObject.locationInWindow]; 
```

来自评论：如果您想在动画期间检查，请询问您的表示层：

```
CALayer *touchedLayer = [self.rootLayer.presentationLayer hitTest:touches.anyObject.locationInWindow]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T10:11:16.580

感谢 Daij 的提示，这是我的解决方案 - 将不胜感激任何评论/改进

```
- (IBAction)viewTapped:(UITapGestureRecognizer *)sender
{
    CGPoint location = [sender locationInView:sender.view];
    CALayer *layer = [sender.view.layer hitTest:location];

    BOOL contains = [self.btnPlay.layer.sublayers containsObject:layer];
    if(contains)
    {
        [self.btnPlay sendActionsForControlEvents:UIControlEventTouchUpInside];

    }

} 
```

# ruby-on-rails - Rails 在多个标签的过滤器上充当标签

> ID：13629924
> 
> 赞同：1
> 
> 时间：2012-11-29T16:12:13.860
> 
> 标签：ruby-on-rails, filter, acts-as-taggable-on

我有一个模型，Tasks，可以在 gem 上标记为可标记的行为。

路线：get 'mainpage/:tag', to: 'mainpage#index', as: :tag

现在，当您单击一个标签时，它会将您带到带有该标签的所有任务。

我想要做的是，一旦你在标签页面上，点击一个额外的标签会进一步过滤带有点击标签名称的结果。

前任。

标签账单页面（主页/账单）显示：

有线电视（标记：电视、信用卡、账单）

椅子（标记：信用卡，账单）

表（标记：家具、账单、沙拉）

当我在账单标签页面上单击“信用卡”标签时，我希望它只显示那些既是账单标签又是信用卡标签的任务。

我对如何做到这一点有点盲目。

感谢您的任何帮助或建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T17:03:16.003

从[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)第 3.11 节：

```
get 'mainpage/*tags, to: 'mainpage#index', as: :tag 
```

添加此路由允许您拥有像`/mainpage/bills`和之类的 URL `/mainpage/bills/tv/furniture`。

第一个 URL 将与 一起进入您的`mainpage#index`方法`params[:tags] == 'bills'`，而第二个 URL 将与`params[:tags] == 'bills/tv/furniture'`. `params[:tags]`然后，您可以简单地拆分`/`.

请注意，出于 seo 的目的，您可能想为 URL 提供一些命名法，即标签在 URL 中总是按字母顺序排列或类似的东西。

# jakarta-ee - 无法排除方法被 JAX-WS 作为 Web 服务操作公开

> ID：13629928
> 
> 赞同：8
> 
> 时间：2012-11-29T16:12:24.477
> 
> 标签：jakarta-ee, jax-ws

我正在 Java EE 6 中创建一个 Web 服务，用`@WebService`. 我只需要公开一些 bean 方法，所以我`@WebMethod`只用所需的方法进行了注释。不幸的是，JAX-WS 忽略了注释并尝试公开所有方法。问题是有一种方法，它不打算用作 Web 服务操作，它返回一个接口，这不能由 JAX-WS 管理，因此没有部署 Web 服务。这是预期的行为还是我错过了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-29T16:16:34.620

您可以将属性“排除”添加到注释并将其设置为 true。Javadoc 声明：将方法标记为不公开为 Web 方法。

# php - 当前和仅数字的正则表达式

> ID：13629929
> 
> 赞同：0
> 
> 时间：2012-11-29T16:12:28.913
> 
> 标签：php, regex

我需要验证 PHP 中的一个数字，特别是在 slug 中传递的 DB ID，但似乎无法正确使用正则表达式......

我不能使用`is_numeric()`，因为它不会过滤我需要的数字，同样处理`ctype_digit()`

```
// Values to Test
$tests = [42, '42', '42a', 'a42', '042', 1337, 0, '0', TRUE, FALSE, '1e4', 'not numeric', 9.1, '9.0', ''];

// RegEx
return !preg_match("/[^0-9]/", $val); 
```

它大部分都在工作，但我还需要在 RegEx 中测试一个值，`FALSE`并且`''`都返回有效......

我试图`return !preg_match("/[^0-9]{1}/", $val);`检查 1 的有效长度（不是值），但我似乎无法正确...

我已经检查了来自[http://davidwalsh.name/php-validatie-numeric-digits](http://davidwalsh.name/php-validatie-numeric-digits)的示例和评论，但无法让任何示例代码工作......

有谁知道 RegEx 的**当前和唯一数字**？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T16:14:19.913

为什么要双重反转逻辑。您可以做的最简单的事情是断言整个字符串由数字组成（准确地说是 1 个或多个数字）：

```
return preg_match('/^[0-9]+$/', $val); 
```

或者

```
return preg_match('/^\d+$/', $val); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:16:44.867

尝试这个：

```
return !preg_match("^[0-9]+$",$val); 
```

# msbuild - 覆盖 MSBuild 任务

> ID：13629936
> 
> 赞同：3
> 
> 时间：2012-11-29T16:13:05.850
> 
> 标签：msbuild, msbuild-task

为了测试我的 MSBuild 3.5 脚本，我想模拟一些内置任务。我的方法是在我的构建脚本中注入 UsingTask 以提供替代实现，例如：

```
<UsingTask TaskName="BuildStep" AssemblyFile="MyMocks.dll" /> 
```

这对于 Message 和 BuildStep 非常有效，但是当我尝试对 MSBuild 任务执行相同操作时，我的模拟被静默忽略并使用内置版本。

有谁知道如何用替代实现覆盖 MSBuild 任务？

谢谢，

# java - 布尔表达式的编译错误

> ID：13629944
> 
> 赞同：0
> 
> 时间：2012-11-29T16:13:34.257
> 
> 标签：java, compilation, boolean

这是一段 Java 代码：

```
static boolean a; // gets false
static boolean b; 
static boolean c;

    public void printA(){

         boolean bool = (a = true) || (b = true) && (c = true);    
         System.out.print(a + ", " + b + ", " + c);     
    } 
```

它不编译，问题是什么？错误：这条线上有多个标记；'bool' 变量行上的语法错误。我希望它打印出来`true, false, true`。虽然根据我的教程书籍它打印`true, false, false`。

我知道它会执行短路，但如果 && 双方都需要进行评估。那不是家庭作业，我正在学习 Java。干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T16:15:47.717

```
(a = true) || (b = true) && (c = true); 
```

相当于： -

```
(a = true) || ((b = true) && (c = true)); 
```

由于`(a = true)`被评估为`true`，因此不评估第二个表达式，因为您在那里使用*短路运算符 (||)*。

因此最后两个任务不会发生。`b`和的价值`c`仍然存在`false`。

**注意： -**短路运算符 -`&&`和`||`, 如果可以通过先前的评估获得某个结果，则不会进一步评估。

**所以： -**

*   `a && b`如果*a*为假，则不会评估*b 。*

**   `a || b`如果*a*为真，则不会评估*b 。** 

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T16:17:21.233

对我来说没有编译错误 - 这工作正常：

```
public class Test {
    static boolean a;
    static boolean b;
    static boolean c;

    public static void main(String[] args) {
        boolean bool = (a = true) || (b = true) && (c = true);
        System.out.print(a + ", " + b + ", " + c);
    }
} 
```

它打印出来

```
true, false, false 
```

这是因为 的 LHS`||`被评估，设置`a`为 true 并且评估为`true`。由于`||`是短路的，所以`||`( 是`(b = true) && (c = true)`) 的 RHS 不会被评估。

注意表达式

```
(a = true) || (b = true) && (c = true); 
```

相当于：

```
(a = true) ||  ((b = true) && (c = true)) 
```

*不是*

```
((a = true) || (b = true)) && (c = true) 
```

如果是后者，你会得到`true, false, true`.

这是因为`&&`具有更高的优先级（“比绑定更紧密”）`||`。有关运算符优先级的完整列表，请参阅[Java 教程](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/operators.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T16:14:09.080

```
static boolean a;
static boolean b; 
static boolean c; 
```

由于您没有使用布尔值进行初始化，因此 java 将分配默认值“false”；

问题是：

```
(a = true) || (b = true) && (c = true); 
```

由于第一次评估返回 true (a = true) -> true 第二部分没有“执行”。

与运算符 || `(true || //do not matter)`=真。是一种优化形式，不需要计算后半部分，因为第一个已经被评估为真。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T16:22:37.383

如果我可以......

看起来有些人不太明白这个问题是什么。

x = (a=true) || (b=true) && (c==true);

由于 && 的优先级高于 ||，似乎 (b=true) && (c==true) 应该首先被评估，因此将 b 和 c 设置为 true。如果 && 具有更高的优先级，为什么 || 的操作数之一 先评价？

到目前为止，Rohit Jain 已经解释得最好。我要补充的是，运算符的优先级并不决定计算操作数的顺序——只是如果短路运算符没有必要，哪些操作必须作为其他运算符的操作数完成。优先级决定了表达式的树（具有讽刺意味的是，较高优先级的运算符在树中较低），但是无论运算符的优先级如何，树的计算都是深度优先和从左到右的。

```
 ||
   /    \
 =      &&
/ \    /   \
a t    =   =
      / \ / \
      b t c t 
```

首先，将 a=true 评估为 true 值，执行赋值的“副作用”。由于|| 短路，另一边甚至没有看。

如果您真的希望首先评估 && （及其操作数），则必须重写表达式：

x = (b=true) && (c=true) || （一=真）；

当然，然后将 b 和 c 设置为 true，而 a 仍然为 false，因为 || 短路。

我认为我没有解释任何新内容，只是以较小的步骤解释了相同的信息。**

# android - 如何在android上显示Json获取的实时图像

> ID：13629945
> 
> 赞同：1
> 
> 时间：2012-11-29T16:13:34.197
> 
> 标签：android, android-layout, android-imageview

我在我的应用程序中使用 3 个选项卡和 shrelock 操作栏。3 个标签有 3 个片段。在第一个片段上，我想显示图像现场歌曲播放图像。所以我通过解析 JSON 文件来获取 URL。而不是我在图像视图上显示。

为了显示图像，我使用了两种方法，一种是异步任务来获取和显示。另一种方法是将图像分配给图像视图的简单方法。

现在的问题是当我滚动选项卡并再次返回到我正在获取图像的那个片段时，它需要时间如下。

1）在 Async_task = 当我交换选项卡并再次返回主选项卡时，我很容易滚动，但显示图像需要 5 秒的延迟，因为我在 post execute 方法中为 imageviewer 分配了 URL。

2) 不使用异步任务的简单方法是直接将 URL 分配给图像视图。当我在选项卡之间滚动并移回主选项卡时，需要时间切换回主选项卡（片段）可能是因为它解析 JSON 而不是如此分配图像URL。

我的问题是我希望它已经加载..或加载一次并将其用于android的生命周期..但是当我从JSON解析器获得不同的URL时它应该改变图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T00:43:28.990

检索图像后尝试缓存图像。这样，您不必重新访问 URL 即可再次显示图像。您只需重新显示已经下载和优化的图像。

Google 有一部分文档专门介绍如何在 Android 中处理图像。它还为您提供示例代码 (BitmapFun.zip)。[你应该检查一下。](http://developer.android.com/training/displaying-bitmaps/index.html)

您还应该检查 Jake Wharton 的[LruCache implementation](https://github.com/JakeWharton/DiskLruCache)。缓存图像的好方法。

# c# - 如何提高 ASP.NET 中 Ajax 扩展的性能并阻止网站宕机？

> ID：13629949
> 
> 赞同：0
> 
> 时间：2012-11-29T16:13:41.467
> 
> 标签：c#, asp.net, ajax, performance, hosting

我正在运行一个讨论网站，人们来这里讨论一个主题并对其进行投票。投票系统是基于 ajax 的，点击 up 按钮增加投票，down 减少投票，就像在 stackoverflow.com 中一样。该网站具有很高的吸引力。

出现的问题是，在连续 5 或 6 次投票或评论后，网站出现故障。意味着每当我投票 4 或 5 条评论时，网站就会崩溃。我问了我的托管服务提供商，他们说我应该购买一个 VPS 或专用主机来消除这个故障。但我想向你们确认，使用共享主机可以解决这个问题吗？由于我们的预算非常少，因此无法负担高价托管计划。所以请告诉任何可用的编程解决方案。并告诉我托管服务提供商提供的解决方案是否正确？

示例投票代码：

```
protected void button1_Click(...)
{
    new DatabaseOps.incrementUp(topicID.text); //topic id is a label
    button1.Enabled=false;
} 
```

该按钮包含在自动更新的更新面板中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:31:28.890

您的网站上一定存在严重错误。默认情况下，在 IIS 中，应用程序池会在连续出现 5 个严重错误后关闭网站。在您修复代码之前，我认为获得专用主机不会解决您的问题。

# signalr - ASP.NET SignalR 不向客户端发送消息

> ID：13629950
> 
> 赞同：2
> 
> 时间：2012-11-29T16:13:44.780
> 
> 标签：signalr, signalr-hub, signalr.client

我意识到 SignalR 和 ASP.NET SignalR 之间存在重大变化，因此我更改了代码以适应这种变化。但由于某种原因，我无法找出正确的改变。

我遇到的问题是服务器没有向客户端发送消息。

***旧 SignalR 代码：***

**服务器**

```
var context = GlobalHost.ConnectionManager.GetHubContext<Dashboard>();
var subscribers = context.Clients;

if (!string.IsNullOrWhiteSpace(message.Source))
{
    var subscriber = subscribers[message.Source];

    subscriber.messageReceived(message);
} 
```

**客户**

```
$.connection.dashboard.messageReceived = function(){...}; 
```

***新代码（ASP.NET SignalR）：***

**服务器**

```
var context = GlobalHost.ConnectionManager.GetHubContext<Dashboard>();
var subscribers = context.Clients;

if (!string.IsNullOrWhiteSpace(message.Source))
{
    var subscriber = subscribers.Group(message.Source);             
    subscriber.messageReceived(message);
} 
```

**客户**

```
$.connection.dashboard.client.messageReceived = function(){...}; 
```

有人可以帮我弄清楚这里出了什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T18:05:13.133

我能够让您的代码逻辑正常工作。这是我根据您的逻辑构建的：

服务器：

```
public class Status : Hub
{
    public override Task OnConnected()
    {
        Groups.Add(Context.ConnectionId, "foo");
        return base.OnConnected();
    }

    public void foo()
    {
        var context = GlobalHost.ConnectionManager.GetHubContext<Status>();
        var subscribers = context.Clients;
        var subscriber = subscribers.Group("foo");
        subscriber.messageReceived("ello");
    }
} 
```

客户：

```
var status = $.connection.status;

status.client.messageReceived = function (val) {
    alert(val);
}

$.connection.hub.start().done(function() {
    status.server.foo();
}); 
```

我对为什么您的实施不起作用的唯一想法是：

1.  您没有将连接 ID 添加到您尝试广播到的组中（请参阅我在服务器上的 OnConnected 函数）。
2.  在 messageReceived 的 .client 方法中，您不允许将值作为参数传递。除非您在函数中解析参数对象，否则您将无法获取消息值。
3.  您的 message.Source 不正确

希望这可以帮助！

# web-services - 在应用程序关闭之前启动事件

> ID：13629957
> 
> 赞同：0
> 
> 时间：2012-11-29T16:13:56.683
> 
> 标签：web-services, flash, shutdown

所以，这是我的问题，我正在运行一个 Flash 应用程序，该应用程序托管在一个 html 页面中，该页面在启动时连接到一个网络服务，我需要的是一种启动/检测与该网络通信的事件的方法服务说：“嘿，我不在这里了”当用户：

*   关闭标签
*   关闭浏览器
*   刷新页面
*   任何不在闪存控制环境中的东西

我该怎么做？，我的意思是，即使应用程序正在关闭，我也需要找到一种将数据发送到 Web 服务的方法。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T18:04:16.020

添加一些javascript：`window.onunload = function(){/*do stuff*/}`

# css - 具有不同高度的绝对定位div的页脚？

> ID：13629958
> 
> 赞同：1
> 
> 时间：2012-11-29T16:14:01.733
> 
> 标签：css, html, position, footer, absolute

我试图把这个设计（[http://revivelab.com/demo_sites/bookthatcondo/](http://revivelab.com/demo_sites/bookthatcondo/)）变成一个wordpress主题，你会注意到页脚有'position：absolute；bottom：0；top：1500px；' 在上面。1500px 是我需要更改的，因为我不想指定每个页面唯一的顶部位置。它上面的 div 是绝对的，因此它们可以分层以获得波浪/滑块效果。

有没有人对如何实现这一目标有任何建议或提示？我*是否必须*对网站的其余部分使用绝对定位来实现这些“层”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T17:53:41.170

好的，所以我找到了一种方法来做到这一点......这可能有点令人困惑，但它有效：

您需要找到具有 id 的 div `canvas`。用给定新 id 的新 div 包装该 div 内的所有内容（而不是 div 本身）（即 canvas2）。那么你应该有这样的东西：

```
<div id="canvas">
   <div id="canvas2">
     <!-- all the other code here -->
   </div>
</div> 
```

完成之后，您需要将整个页脚放在`<div id="canvas">`您现在应该拥有的内容中

```
<div id="canvas">
   <div id="canvas2">
     <!-- all the other code here -->
   </div>
  <div style="<!--Your footer styles here -->">
   <!-- footer content here -->
  </div>
</div> 
```

在你这样做之后，你的网站看起来会很混乱。但那是因为我们需要移动一些 CSS 属性。

现在您的页脚使用`inline styling`如下所示：

`style="width:100%;height:269px; background-image:url(img/footer_Wave.png); background-position:50% 0%; background-repeat:no-repeat; position:absolute;bottom:0;top:1500px;"`

如果您想继续使用内联样式，只需将其更改为： `style="width:100%;height:269px; background-image:url(img/footer_Wave.png); background-position:50% 0%; background-repeat:no-repeat; margin-top:50px"`

接下来，您的`#canvas`div 应用了以下样式：

```
#canvas {
 width: 1024px; 
 height: 1000px; 
 position: absolute; 
 z-index: 5000; 
 left: 50%; 
 margin-left: -512px;
} 
```

将其更改为：

```
#canvas {
 width: 100%; 
 position: absolute; 
 z-index: 5000;
} 
```

最后，给出`#canvas2`这些样式：

```
#canvas2 {
 width: 1024px; 
 margin:auto;
} 
```

这应该为每个页面修复它。它看起来有很多变化，但实际上并没有太大变化。希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:21:27.693

您绝对不必指定您希望页面多长时间才能将页脚粘在底部。

请尝试使用[粘滞页脚](http://www.cssstickyfooter.com/)。它使用负数`margin-top`，因此您只需要知道页脚高度，而不是实际页面的高度。如果您有很多不同的页面高度，它真的很有帮助。

# php - 使用 Doctrine 生成实体到单独的命名空间中

> ID：13629959
> 
> 赞同：0
> 
> 时间：2012-11-29T16:14:03.553
> 
> 标签：php, symfony, namespaces, doctrine, entity

我在这里关注文档：

*   [http://symfony.com/doc/current/cookbook/doctrine/reverse_engineering.html](http://symfony.com/doc/current/cookbook/doctrine/reverse_engineering.html)

这些是命令

```
php app/console doctrine:mapping:convert xml ./src/Acme/BlogBundle/Resources/config/doctrine/metadata/orm --from-database --force
php app/console doctrine:mapping:import AcmeBlogBundle annotation
php app/console doctrine:generate:entities AcmeBlogBundle 
```

我在这里看到了新的实体"

```
Acme/BlogBundle/AcmeBlogBundle/Entity 
```

但我想知道如何像这样将实体添加到他们自己的命名空间中

```
Acme/BlogBundle/AcmeBlogBundle/Entity/Foo
Acme/BlogBundle/AcmeBlogBundle/Entity/Bar 
```

这样我就可以将 Foo 和 Bar 数据库的实体分开。

更新：

或者它应该是这样的结构：

```
Acme/BlogBundle/AcmeBlogBundle/Foo/Entity
Acme/BlogBundle/AcmeBlogBundle/Bar/Entity 
```

想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T20:41:16.910

如果您查看文档的[How to work with Multiple Entity Managers and Connections](http://symfony.com/doc/current/cookbook/doctrine/multiple_entity_managers.html)部分，您会注意到您可以将捆绑实体绑定到一个或多个[实体管理器](http://symfony.com/doc/2.0/cookbook/doctrine/multiple_entity_managers.html)。它们中的每一个都与特定的数据库连接相关。

例如，如果我定义了两个数据库连接（first_connection 和 second_connection），我可以添加两个实体管理器，如下所示，

```
entity_managers:
    first_manager:
        connection:       first_connection
        mappings:
            MyBundle:
                dir:      Path/To/EntityFolder/Foo/
    second_manager:
        connection:       second_connection
        mappings:
            MyBundle:
                dir:      Path/To/EntityFolder/Bar/ 
```

然后，您可以指定要在[实体生成过程](http://symfony.com/doc/2.0/cookbook/doctrine/reverse_engineering.html)的前两个步骤中使用的正确实体管理器，

```
php app/console doctrine:mapping:convert xml ./src/Acme/BlogBundle/Resources/config/doctrine/metadata/orm --from-database --force --em=first_manager --filter=MyTable 
```

**注意：**该`--filter`选项用于允许您单独生成实体。

```
php app/console doctrine:mapping:import AcmeBlogBundle annotation --em=first_manager --filter=MyTable

php app/console doctrine:generate:entities AcmeBlogBundle 
```

然后根据绑定到的连接将您的实体放入正确的文件夹中。

# jquery - css：在悬停时展开 div 而不会取代其他 div

> ID：13629967
> 
> 赞同：9
> 
> 时间：2012-11-29T16:14:25.350
> 
> 标签：jquery, css

我有以下代码：

```
<style>
    #items {width:300px;}
    .item {width:100px;border:solid 1px #ccc;float:left;height:20px;overflow:hidden;}
    .item:hover{height:auto}
</style>

<div id="items">
    <div class="item">text 1<br>text 1<br>text 1</div>
    <div class="item">text 2<br>text 2<br>text 2</div>
    <div class="item">text 3<br>text 3<br>text 3</div>
    <div class="item">text 4<br>text 4<br>text 4</div>
    <div class="item">text 5<br>text 5<br>text 5</div>
    <div class="item">text 6<br>text 6<br>text 6</div>
    <div class="item">text 7<br>text 7<br>text 7</div>
    <div class="item">text 8<br>text 8<br>text 8</div>
    <div class="item">text 9<br>text 9<br>text 9</div>
    <div class="item">text 10<br>text 10<br>text 10</div>
</div> 
```

看看它在行动：http: [//jsfiddle.net/6K7t4/](http://jsfiddle.net/6K7t4/)

当一个 div id 悬停时，它应该扩展而不取代其他 div，如下所示： [http ://shopping.kelkoo.co.uk/ss-shirt.html](http://shopping.kelkoo.co.uk/ss-shirt.html)

另外，请建议如何实现跨浏览器解决方案。

如果可以使用纯 css 完成，我更喜欢该解决方案。

如果没有，是否可以在没有插件的情况下以简单的方式使用 jquery 来完成？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-29T16:28:20.123

看这个演示：http: [//jsfiddle.net/6K7t4/24/](http://jsfiddle.net/6K7t4/24/)

HTML：

```
<div id="items">    
    <div class="item"><div class="inner">text 1<br>text 1<br>text 1</div></div>
    <div class="item"><div class="inner">text 2<br>text 2<br>text 2</div></div>
    <div class="item"><div class="inner">text 3<br>text 3<br>text 3</div></div>
    <div class="item"><div class="inner">text 4<br>text 4<br>text 4</div></div>
    <div class="item"><div class="inner">text 5<br>text 5<br>text 5</div></div>
    <div class="item"><div class="inner">text 6<br>text 6<br>text 6</div></div>
    <div class="item"><div class="inner">text 7<br>text 7<br>text 7</div></div>
    <div class="item"><div class="inner">text 8<br>text 8<br>text 8</div></div>
    <div class="item"><div class="inner">text 9<br>text 9<br>text 9</div></div>
    <div class="item"><div class="inner">text 10<br>text 10<br>text 10</div></div>
</div> 
```

CSS：

```
#items { 
     width:300px; 
}

.item { 
    width:100px; 
    border:solid 1px #ccc;
    float:left;
    height:20px;
    z-index:0;
    overflow:hidden;
    position:relative; 
}  

.item:hover {
    overflow:visible;
    z-index:100;
}

.item:hover .inner { 
    z-index: 100;
}

.inner { 
    position: absolute;
    background: white;
    width: 100%;
} 
```

现在每个`.item`都相对定位，并且有新的子元素，其中包含所有内容。一旦 div 悬停，`.item`'s`overflow:hidden`将更改为`overflow:visible`并且 z-index of`.inner`设置为 100（以便将其显示在其他 div 上方）。

**UPD**：新的演示和更新的代码。对于 IE7（.item:hover 的 z-index 已更改，否则内部 div 隐藏`.item`在 IE7 中的其他 s 下方）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-29T16:35:59.403

您可以`child selector element`通过添加另一个 div 来使用您想要选择的类。这是您在下面使用它更新的代码。希望这可以帮助！

```
<div id="items">
    <div class="item"><div class="item-extend"> 1<br>text 1<br>text 1</div></div>
    <div class="item"><div class="item-extend"> 2<br>text 2<br>text 2</div></div>
    <div class="item"><div class="item-extend"> 3<br>text 3<br>text 3</div></div>
    <div class="item"><div class="item-extend"> 4<br>text 4<br>text 4</div></div>
    <div class="item"><div class="item-extend"> 5<br>text 5<br>text 5</div></div>
    <div class="item"><div class="item-extend"> 6<br>text 6<br>text 6</div></div>
    <div class="item"><div class="item-extend"> 7<br>text 7<br>text 7</div></div>
    <div class="item"><div class="item-extend"> 8<br>text 8<br>text 8</div></div>
    <div class="item"><div class="item-extend"> 9<br>text 9<br>text 9</div></div>
    <div class="item"><div class="item-extend"> 10<br>text 10<br>text 10</div></div>
</div> 
```

​</p>

```
 #items {width:300px;}
.item {width:100px;border:solid 1px #ccc;float:left;height:20px;overflow:hidden;}
.item:hover >.item-extend {position:absolute;width:100px;background:#fff;} 
```

您可以在这里演示更新的代码：http: [//jsfiddle.net/6K7t4/35/](http://jsfiddle.net/6K7t4/35/)

**更新：**您甚至不必使用`child selector element`，而是可以`:hover`通过切换`.item:hover >.item-extend`到`.item-extend:hover`. 以完全相同的方式工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-29T16:42:55.023

您需要一个额外的 div 才能在里面保存一个绝对定位的 div。

HTML

```
<div id="items">
   <div class="itemHolder"><div class="item">text 1<br>text 1<br>text 1</div></div>
</div> 
```

item 是绝对的，并且 itemHolder 浮动。

CSS

```
#items {width:300px; padding:30px;}

// Floats and hides content with height and overflow
.itemHolder {float:left; width:100px; border:solid 1px #ccc; height:20px; overflow:hidden; position:relative;}

// Absolute
.item {position:absolute; top:0; left:0; z-index:1; width:100%; background:#FFF; border:1px solid #999; border-top:0;}

// On hover we make the overflow visible and give the div to show a higher z index
.itemHolder:hover {overflow:visible;}
.itemHolder:hover .item {z-index:2;} 
```

​ 现场解决方案：http: [//jsfiddle.net/vWGCc/](http://jsfiddle.net/vWGCc/)

:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-29T16:34:01.913

你可以用很少的 javascript 来实现它。见下文，

```
$('.item').hover(function () {
    var pos = $(this).position();        
    var $clone = $(this).clone();
    $clone.appendTo(this).addClass('item_clone').css({
        left: pos.left,
        top: pos.top
    });
}, function () {
    $('.item_clone', this).remove();
}); 
```

**演示：http:** [//jsfiddle.net/6K7t4/32/](http://jsfiddle.net/6K7t4/32/)

**注意：**检查其他基于 CSS 的答案，这总是比通过脚本实现更好。

# java - 我在eclipse中有一个java项目。我如何获得它以便您可以在终端中运行它？

> ID：13629977
> 
> 赞同：1
> 
> 时间：2012-11-29T16:14:43.177
> 
> 标签：java, jar, terminal

所以我有一个只有一个java文件的项目

主.java

我的工作区位于 /programming/workspace

我在项目中添加了外部 jar 以使用 apache poi。我可以通过 eclipse 运行我的程序，它工作得很好，但我需要能够把这个程序提供给我的朋友，并能够通过终端运行它。

我试图在 Main.class 文件所在的位置执行 Java main，但得到了：

```
 Exception in thread "main" java.lang.NoClassDefFoundError: Main
     Caused by: java.lang.ClassNotFoundException: Main
at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
at java.lang.ClassLoader.loadClass(ClassLoader.java:247) 
```

如何让我的程序通过我可以让其他人运行它的命令行运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:18:50.677

通过 Eclipse -> 导出 -> 可运行的 jar 文件 -> 设置具有`main`方法的类并且在终端中调用时要运行 -> 完成（注意包含外部 .jar）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T16:16:28.087

选择项目。选择导出，导出为可运行的JAR文件

# sql - 为具有变量根的记录定义递归查询

> ID：13629978
> 
> 赞同：1
> 
> 时间：2012-11-29T16:14:46.827
> 
> 标签：sql, tsql, sql-server-2005

您好我正在尝试将数据导入我的数据仓库并简化一些数据的导入，我想在表中创建一个新列，以便在获取新数据时跟踪最新值。

我的表如下所示：

```
CREATE TABLE CustomerFact(
 Id INT IDENTITY PRIMARY KEY
,CustomerId NVARCHAR(20) NOT NULL --Current Id of a Customer
);

--Track changes to CustomerId
CREATE TABLE CustomerHistoryFact(
 Id INT IDENTITY PRIMARY KEY
,CurrentCustomerId NVARCHAR(20) --Most recent Customer Id
,CustomerId NVARCHAR(20) NOT NULL --Customer Id at time of record insert
,PrvsCustomerId NVARCHAR(20) NOT NULL --Customer Id at time of transaction
,PrvsCustomerIdEffectiveDate DATE NOT NULL --Date when PrvsCustomerId was effective
,PrvsCustomerIdObsoleteDate DATE NOT NULL --When the PrvsCustomerId was expired and replaced with a new Customer Id
); 
```

、`CustomerId`、`PrvsCustomerId`和都是外部的`PrvsCustomerIdEffectiveDate`。`PrvsCustomerIdObsoleteDate`我想在`CurrentCustomerId`插入新记录时分配一个。

这取决于何时插入新记录，`CustomerHistoryFact`检查所有其他记录。如果匹配，则新记录的 成为所有先前记录的 ，否则插入记录并成为。`PrvsCustomerId``CurrentCustomerId``CustomerId``CurrentCustomerId``CustomerId``CurrentCustomerId`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:26:23.153

似乎是一个扭曲的数据库设计。为什么每次更新记录`CustomerId`时都不能继续插入表？如果排序的最新 CustomerId与 Inserted/Deleted 表中的 customerId 不同，您可以在表上编写触发器以进行插入/更新，并在表中输入条目。这样，您就有了从当前 CustomerId 开始到及时返回的 CustomerId 的历史记录。`CustomerHistoryFact``CustomerFact``CustomerFact``CustomerHistoryFact``CustomerIdEffectiveDate desc`

```
CREATE TABLE CustomerFact(
 Id INT IDENTITY PRIMARY KEY
,CustomerId NVARCHAR(20) NOT NULL --Current Id of a Customer
);

--Track changes to CustomerId
CREATE TABLE CustomerHistoryFact(
 Id INT IDENTITY PRIMARY KEY
,CustomerId NVARCHAR(20) --Most recent Customer Id
,PrevCustomerId NVARCHAR(20) NOT NULL --Customer Id at time of record insert
,UpdatedDate DATETIME NOT NULL --Date when PrvsCustomerId was effective
);

CREATE TRIGGER dbo.CustomerFact_IU
ON dbo.CustomerFact
AFTER INSERT, UPDATE
AS 
BEGIN
    SET NOCOUNT ON;

    --
    -- Check if this is an INSERT, UPDATE.
    -- 
    DECLARE @action as char(1);
    DECLARE @oldCustomerId NVARCHAR(20);

    SET @action = 'I'; -- Set Action to Insert by default.
    IF EXISTS(SELECT * FROM DELETED)
    SELECT @oldCustomerId = customerId from DELETED
    BEGIN
        SET @action = 
            CASE
                WHEN EXISTS(SELECT * FROM INSERTED) THEN 'U' -- Set Action to Updated.
                ELSE 'D' -- Set Action to Deleted.       
            END
    END
    ELSE 
        IF NOT EXISTS(SELECT * FROM INSERTED) RETURN; -- Nothing updated or inserted.

    IF @action = 'I' OR @action = 'U'
    BEGIN
         INSERT INTO dbo.CustomerHistoryFact
         SELECT CustomerId, @oldCustomerId, GETUTCDATE() FROM INSERTED 
    END 

    END 
```

# jquery - jquery 可拖动启用和禁用

> ID：13629980
> 
> 赞同：14
> 
> 时间：2012-11-29T16:14:48.500
> 
> 标签：jquery, draggable

我已经尝试过任何事情来做到这一点，但总是得到同样的错误

```
$(".tooltip").draggable('disable'); 
```

错误：在初始化之前无法调用可拖动的方法；试图调用方法“禁用”

初始化之前？所以我不能在它实际被拖动之前删除该选项？我也尝试过 droppable，似乎无法在不出现此错误的情况下启用它们。

编辑：我发现我有一个带有不可拖动类的元素（当您查看错误时这是有道理的）。现在我只需要找到一种方法，这样它就可以禁用所有可拖动而不抛出错误:)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-29T16:22:36.813

试试这个：

```
$(".tooltip").draggable({ disabled: true }); 
```

这会将可拖动对象初始化为禁用状态。然后你可以使用

```
$(".tooltip").draggable("enable"); 
```

稍后当您想要允许拖动时。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-29T16:34:31.420

我能够在这个 jsfiddle 中重新创建您的场景：

[http://jsfiddle.net/dboots/NDZKY/](http://jsfiddle.net/dboots/NDZKY/)

这是使用

```
$('.draggable').draggable('disable'); 
```

和

```
$('.draggable').draggable('enable'); 
```

有什么不同的东西你不能做同样的事情吗？看起来你有相同的语法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-29T16:17:57.383

看看文档[http://api.jqueryui.com/draggable/](http://api.jqueryui.com/draggable/)

和这里的一个例子：

```
http://jqueryui.com/draggable/ 
```

您是否“包含”了 jquery-ui.js 库？

试试这个小提琴！[http://jsfiddle.net/3Lrg2/23/](http://jsfiddle.net/3Lrg2/23/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-26T23:53:39.643

**一**键**启用**和**禁用**_

 **```
$("#container").draggable({disabled:false});
$("#container").draggable({disabled:true}); 
```

下面给出的简单示例：

```
<div id = "container"></div>
<button id = "control"></button>
<script>
  $(document).ready(function()
    {
       $("#control").click(function()
          {
            if($("#control").hasClass("active")
              {
                $("container").draggable({disabled:true});
                $("control").removeAttr("class","active");   
              }
            else
              {
                $("container").draggable({disabled:false});
                $("control").attr("class","active");
              }
          });
    });
</script> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-29T16:19:46.307

尝试使用 .unbind('ondrag') 从元素中删除事件。

抱歉，我认为它应该是 $("tooltip").unbind('draggable') 不是 100% 确定事件名称。**

# windows - 调用 CreateObjectFromFile 时 FORMATETC 结构无效

> ID：13629984
> 
> 赞同：3
> 
> 时间：2012-11-29T16:14:54.243
> 
> 标签：windows, delphi, ms-word, ole

我正在使用 Delphi 7 尝试将 Word 文档加载到 OLEContainer 中。该程序在终端服务 (Windows 2003) 环境中运行。

以下代码为某些用户生成错误：

```
procedure TForm1.Button1Click(Sender: TObject);
begin
  OleContainer1.CreateObjectFromFile('c:\tmp\test.doc', false);
end; 
```

它是一个简单的应用程序，带有一个 OLEContainer 和一个窗体上的按钮。c:\tmp\test.doc 是 Word 2003 文档。

对于某些用户，此代码会生成错误

> 无效的 FORMATETC 结构。

对于其他人则不然。所有用户都在同一台终端服务器上运行，因此运行同一程序访问同一 Word 文档。此外，所有用户都是使用脚本创建的，因此它们具有完全相同的设置，当然除了用户名等。

我尝试让所有用户成为管理员，但这并没有改变行为。

任何人都知道问题可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T17:13:37.893

我相信 Word 自动化支持 IPersistFile，这应该提供另一种加载文件的方法。[在这里查看更多。](https://stackoverflow.com/questions/4345216/opening-a-word-doc-document-from-a-stream)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T07:43:21.560

经过一些测试，我发现 TOleContainer.LoadFromStream 方法始终有效。问题是这个方法需要一个 OLE 流，而不是一个包含 word 文档的流。我对 OLE 流的格式进行了逆向工程，并通过编写页眉、word 文档和页脚手动创建了一个。看起来，页脚由偶数 256 字节的 ASCII-0 组成。

以下是创建 OLE 流的代码：

```
function OLEStreamFromDoc(const inDocFileName : String) : TMemoryStream;
var
  aFileStream : TMemoryStream;
  aPadding    : Array[1..256] of byte;
  aHeader     : Array[1..12] of byte;
  aSize       : int64;
  i           : integer;
begin
  for i := low(aHeader) to High(aHeader) do
    aHeader[i] := 0;

  for i := low(aPadding) to High(aPadding) do
    aPadding[i] := 0;

  Result := TMemoryStream.Create;
  aFileStream := TMemoryStream.Create;
  try
    aFileStream.LoadFromFile(inDocFileName);
    aFileStream.Seek(0,0);
    aSize := aFileStream.Size + SizeOf(aPadding);

    aHeader[1] := Ord('B');
    aHeader[2] := Ord('D');
    aHeader[3] := Ord('O');
    aHeader[4] := Ord('C');
    aHeader[5] := 1;
    aHeader[9]  := aSize and 255;
    aHeader[10] := (aSize shr 8) and 255;
    aHeader[11] := (aSize shr 16) and 255;
    aHeader[12] := (aSize shr 24) and 255;
    Result.Write(aHeader, SizeOf(aHeader));
    aFileStream.SaveToStream(Result);
    Result.Write(aPadding, sizeof(aPadding));
    Result.Seek(0,0);
  finally
    aFileStream.Free;
  end;
end; 
```

# active-directory - 查询 Active Directory/LDAP，查找嵌套组织单元中的用户

> ID：13629985
> 
> 赞同：3
> 
> 时间：2012-11-29T16:14:56.583
> 
> 标签：active-directory, ldap, teamcity, ldap-query, teamcity-7.0

我正在 Windows 域 (Active Directory) 中的 TeamCity 7.1.2 中配置 LDAP 身份验证。

基本上它可以工作（我可以用我的域用户登录！），但是整个公司的每个用户都可以登录。--
> 现在我试图限制对开发人员的访问。

我在 TeamCity 文档中找到[了这个示例：](http://confluence.jetbrains.net/display/TCD7/Typical+LDAP+Configurations#TypicalLDAPConfigurations-BasicLDAPLoginforUsersinaSpecificLDAPGroupOnly)

```
# filtering only users with specified name and belonging to LDAP group "Group1" with DN "CN=Group1,CN=Users,DC=example,DC=com"
teamcity.users.login.filter=(&(sAMAccountName=$capturedLogin$)(memberOf=CN=Group1,CN=Users,DC=example,DC=com)) 
```

所以我只需要替换`CN=Group1,CN=Users,DC=example,DC=com`为我的用户所在的 LDAP 组。
但是查询 LDAP 对我来说是全新的，所以我无法找出正确的语法。

我的用户在这里：

![活动目录屏幕截图](../Images/5f2046e01b6cb773afd9071decbf80a5.png)

所以这是：

```
CompanyName.de/CompanyName/IT/Entwickler/ 
```

“CompanyName”、“IT”和“Entwickler”是组织单位。
我知道语法是：

```
OU=Entwickler,OU=IT,OU=CompanyName,DC=CompanyName,DC=de 
```

当我将其放入 TeamCity 的配置文件时，我无法登录，TeamCity 将其写入其日志文件：

> 在 LDAP 中搜索：base='DC=CompanyName,DC=de', filter='(&(sAMAccountName=MyUser)(memberOf=OU=Entwickler,OU=IT,OU=CompanyName,DC=CompanyName,DC=de)) ', scope=2, attributes=[sAMAccountName, distinctName] 导致错误

和：

> 用户“MyUser”登录失败：javax.security.auth.login.LoginException：[LDAP：错误代码 32 - 0000208D：NameErr：DSID-031001CD，问题 2001（NO_OBJECT），数据 0，最佳匹配：'DC=CompanyName ,DC=de'

我究竟做错了什么？

*注意：
我的查询**可能**是正确的，这是 TeamCity 中的一个问题。
（我使用的版本**确实**有[一些](http://youtrack.jetbrains.com/issue/TW-24518) 关于 LDAP 的[问题](http://youtrack.jetbrains.com/issue/TW-24408)
，但他们收到的错误消息比我做的要多） 也许我会在 TeamCity 的问题跟踪器上发布这个，但在我想确保错误不会发生之前，因为我弄错了 LDAP 查询，因此这里有问题。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T17:08:16.987

memberOf 正在寻找一个组，而不是一个 OU。您应该创建一个组来限制访问，将适当的用户添加到该组，并在过滤器中指定该组的专有名称。您应该注意，简单的“memberOf={DN}”过滤器不考虑嵌套组成员身份。

编辑：如果你真的想把它限制在OU中的用户，那么你需要将搜索的基本DN更改为OU，并取出memberOf参数进行搜索。

# c - 如何计算C中格式字符串的参数数量？

> ID：13629986
> 
> 赞同：1
> 
> 时间：2012-11-29T16:15:00.857
> 
> 标签：c

我有一个程序，它从命令行获取一个格式字符串，该字符串表示多个输出文件的文件名格式。它应该只需要一个可以替换的整数参数来生成真正的输出文件名，我想在进行输入检查时验证这一点。确定格式字符串在 C 中期望的参数数量的好方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T16:27:35.737

接受的参数数量取决于 C 库的版本（例如，`%a`在 C99 中添加了转换说明符）。您可以确定它不大于未转义`%`字符的数量（即，删除`%`所有序列后剩余的字符`%%`数量）加上`*`字符数量（可能是宽度说明符）。

不过，您应该考虑安全问题；如果用户提供`%n`格式说明符，这可能会导致写入任意内存位置。在其他情况下，提供例如`%f`将导致在任意内存内容中输出垃圾值`%s`，甚至使用`%d`允许用户提供字段宽度的说明符，例如`%255d`可能导致缓冲区溢出。考虑不同的格式化方案会更聪明，例如替换令牌（仍然可以是`%d`），但不允许用户提供`printf`格式字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-14T12:50:39.330

GNU C 库包含一个`parse_printf_format`可以在您的情况下使用的函数。来自[glibc 手册，第 12.12.10 节 - *Parsing a template string*](https://www.gnu.org/software/libc/manual/html_node/Parsing-a-Template-String.html)：

> 您可以使用函数 parse_printf_format 来获取有关给定模板字符串预期的参数的数量和类型的信息。此函数允许为 printf 提供接口的解释器避免传递来自用户程序的无效参数，这可能导致崩溃。

> parse_printf_format 返回模板所需的参数总数。如果此数字大于 n，则返回的信息仅描述前 n 个参数。如果您需要有关其他参数的信息，请分配一个更大的数组并再次调用 parse_printf_format。

用例示例：

```
#include <printf.h>
size_t arguments_count = parse_printf_format ("Your discount: %d%%\n", 0, NULL);
/* arguments_count now holds a value of 1 */ 
```

# python - matplotlib 中共享轴方形子图的新 pythonic 样式？

> ID：13629994
> 
> 赞同：15
> 
> 时间：2012-11-29T16:15:17.317
> 
> 标签：python, numpy, matplotlib, scipy

相关：[在 matplotlib 中绘制具有固定限制的自动缩放子图](https://stackoverflow.com/questions/13612610/plotting-autoscaled-subplots-with-fixed-limits-in-matplotlib)

我想制作一组相同比例的子图，使用`subplots`新的紧凑样式，如[http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.subplots](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.subplots)并让它们是正方形的。

我试过：

```
fig, axes = subplots(numplots, 1, sharex=True, sharey=True, adjustable='box', aspect='equal') 
```

但是我发现这些关键字参数并没有在`subplots`包装器中实现。有什么办法呢？

重申一下，目标只是*共享*轴，以便所有数据都处于相同的比例，并且图是正方形的。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-01T20:16:11.930

只需使用`adjustable='box-forced'`而不是`adjustable='box'`.

正如@cronos 所提到的，您可以使用`subplot_kw`kwarg 传递它（附加关键字参数`subplots`传递给`Figure`not the `Axes`，因此需要 for `subplot_kw`）。

相反，我将使用`setp`，它基本上只是`for item in sequence: item.set(**kwargs)`. （所有 matplotlib 艺术家都有一种`set`可以使用类似于 matlab 的方法`set`。）

哪一种是“更好”的方法将取决于你在做什么。很多人会争辩说这`setp`是非常“unpythonic”，但我看不出它有什么问题。

举个简单的例子：

```
import matplotlib.pyplot as plt

fig, axes = plt.subplots(ncols=3, sharex=True, sharey=True)
plt.setp(axes.flat, aspect=1.0, adjustable='box-forced')

axes[0].plot(range(50))

plt.show() 
```

![在此处输入图像描述](../Images/03a6e3987a7ba3c43d8944f28fd706a2.png)

我现在忘记了两种不同的可调节盒子样式的原因。我记得我第一次遇到它时发现它真的很混乱，我挖掘了代码并有一些明显的原因......但我现在不记得那个原因是什么了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T17:17:09.183

您参考的文档建议使用 subplot_kw

```
fig, axes = subplots(numplots, 1, sharex=True, sharey=True, subplot_kw=dict(adjustable='datalim', aspect='equal')) 
```

然而，共享轴似乎需要 datalim 为可调节的，绘图正确缩放但不是正方形。如果您省略了共享轴，则“框”可以工作。你的来电。

# java - 这种睡眠的实现有什么问题吗？

> ID：13629996
> 
> 赞同：1
> 
> 时间：2012-11-29T16:15:32.653
> 
> 标签：java, multithreading, exception

很长一段时间以来，我一直在使用以下函数使当前线程休眠一段时间：

```
class Utils {

static public sleep(int ms) {
  try {
     Thread.sleep(ms);
  } catch(InterruptedException x) {}
}

} 
```

但是由于我默默地忽略了这个异常，我想知道这个函数是否会在某些情况下变得邪恶？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T16:22:57.310

如果您没有在自己的代码中使用中断，则应通过以下方式保持中断状态：

```
catch(InterruptedException x) {
    Thread.currentThread.interrupt();
} 
```

或者你可以通过投掷来处理它`InterruptedException`。这会立即让调用者知道存在中断，否则可以稍后使用 isInterrupted() 进行检查。

如果一定要全部休眠，那么可以在中断后继续休眠，之后再重新中断线程。请参阅番石榴的`Uninterruptibles.sleepUninterruptibly`实现。

通过不清除线程的中断状态，您可以防止您的代码干扰可能使用中断的任何其他内容。因此，如果将来您想中断一个线程，您就不会遇到一些模糊的错误，有时它会起作用，有时却不起作用。

如果您永远不会使用中断，则可以完全忽略它，但最好保持灵活性以防万一。