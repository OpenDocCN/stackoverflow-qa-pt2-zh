# StackOverflow 问答 13866000-13866999

# php - PHP 代理/TCP/IP 桥接器

> ID：13866001
> 
> 赞同：0
> 
> 时间：2012-12-13T18:19:31.477
> 
> 标签：php, proxy, bridge

我正在寻找一个 php 代理，但不是一个 html 代理。

我的意思是，有很多 php 代理可以让你去代理，输入一个 URL 并查看内容。这不是我需要的。

我正在寻找的是，如果我调用[http://mydomain.com/mypage.php](http://mydomain.com/mypage.php)那么这个 php 页面只是调用[http://mydomain2.com/myotherpage](http://mydomain2.com/myotherpage)传递所有参数、流程等代理将收到，并返回 mydomain2 将返回的内容。

所以它可能像“桥”、“流重定向”或类似的东西，但我真的不知道如何称呼它。

我需要能够从应用程序调用此 URL、发送流并重定向它。

任何想法？

# sql - 如果 sql server 中不存在，则创建存储过程

> ID：13866004
> 
> 赞同：21
> 
> 时间：2012-12-13T18:19:37.653
> 
> 标签：sql, sql-server, tsql

Oracle 执行“创建或替换”语句。Sql server 似乎没有——如果您是从企业管理器中编写脚本，它反而建议“删除并创建”。在您对存储过程进行授权的任何情况下，删除和创建都是不可取的，因为它会丢弃您的数据库管理团队所做的任何授权。您确实需要“创建或替换”来帮助分离开发人员和管理员之间的问题。

我最近一直在做的是这样的：

```
use [myDatabase]
go

create procedure myProcedure as
begin
  print 'placeholder'
end
go

alter procedure myProcedure as
begin
  -- real sproc code here
end
go 
```

这就是我想要的。如果该过程不存在，请创建它，然后更改正确的代码。如果该过程确实存在，则创建失败并且alter 使用新代码更新代码。

它给管理员带来了不同的问题，因为如果存储过程已经存在，create 会引发误导性错误。当然，误导性的事实是，当期望的结果发生时，您不应该看到红色错误文本。

有没有人有办法抑制红色文字？我尝试过的一切都会以某种方式导致“CREATE/ALTER PROCEDURE 必须是查询批处理中的第一条语句”错误。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-12-13T18:37:20.420

这将起作用并保持权限不变：

```
use [myDatabase]
go
if object_id('dbo.myProcedure', 'p') is null
    exec ('create procedure myProcedure as select 1')
go
alter procedure myProcedure as
SET NOCOUNT ON
  -- real sproc code here. you don't really need BEGIN-END
go 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-13T18:35:59.753

像这样：

```
IF  NOT EXISTS (SELECT * FROM sys.objects 
                WHERE object_id = OBJECT_ID(N'[dbo].[myProcedure]') 
                  AND type in (N'P', N'PC'))
BEGIN
    EXEC('
        create procedure myProcedure as
        begin
            print ''placeholder''
        end
        ')
END

EXEC('
    alter procedure myProcedure as
    begin
      -- real sproc code here
    end
    ') 
```

笔记：

1.  请记住将动态 SQL 字符串中的引号加倍。
2.  为了便于阅读，我已经缩进了它，但这也会在您的实际程序列表中添加额外的缩进空间。如果您不这样做，那么只需降低动态 SQL 文本的缩进级别。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-02-22T18:59:20.863

终于有一天，SQL Server 实现了创建或替换的等效项。它们的等价物是“创建或更改”。从 SQL Server 2016 SP1 开始提供。示例用法：

```
use [myDatabase]
go

Create or Alter procedure myProcedure as
begin
  -- procedure code here
end
go 
```

# java - JSF 1.2 + JBoss 5 不呈现 jsf 标签。

> ID：13866006
> 
> 赞同：0
> 
> 时间：2012-12-13T18:19:40.673
> 
> 标签：java, jsf, richfaces, jsf-1.2

我正在尝试将 .net 应用程序转换为 JSF 1.2 以位于我们的旧版 JBoss 服务器上，但我无法获取 jsf 标记来呈现。在我的浏览器中，我看到的正是我在 Eclipse 中看到的。

任何建议表示赞赏。

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
         xmlns="http://java.sun.com/xml/ns/javaee" 
         xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" 
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" 
         version="2.5">
  <display-name>WebDataViewer</display-name>

    <context-param>
        <param-name>javax.faces.FACELETS_LIBRARIES</param-name>
        <param-value>/WEB-INF/tlds/formatter-taglib.xml</param-value>
    </context-param>

    <!-- JSF -->
    <context-param>     
        <param-name>javax.faces.CONFIG_FILES</param-name>     
        <param-value>/WEB-INF/faces-config.xml</param-value>     
    </context-param> 

    <context-param>     
        <param-name>javax.faces.DEFAULT_SUFFIX</param-name>     
        <param-value>.xhtml</param-value>     
    </context-param> 

    <context-param>     
        <param-name>javax.faces.STATE_SAVING_METHOD</param-name>     
        <param-value>server</param-value>     
    </context-param>  

    <context-param>
        <param-name>facelets.VIEW_MAPPINGS</param-name>
        <param-value>*.xhtml</param-value>
    </context-param>

    <context-param>
        <param-name>org.ajax4jsf.VIEW_HANDLERS</param-name>
        <param-value>com.sun.facelets.FaceletViewHandler</param-value>
    </context-param>

    <context-param>
        <param-name>org.richfaces.SKIN</param-name>
        <param-value>CLASSIC</param-value>
    </context-param>

    <listener>     
        <listener-class>com.sun.faces.config.ConfigureListener</listener-class>    
    </listener>    

    <!-- Allows you to put html comments in your views without the compiler blowing up -->
    <context-param>
        <param-name>javax.faces.FACELETS_SKIP_COMMENTS</param-name>
        <param-value>true</param-value>
    </context-param>

    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.jsf</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>/faces/*</url-pattern>
    </servlet-mapping>

    <welcome-file-list>
        <welcome-file>index.xhtml</welcome-file>
    </welcome-file-list>
</web-app> 
```

面孔-config.xml

```
<?xml version="1.0" encoding="UTF-8"?>

<faces-config
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_1_2.xsd"
    version="1.2">

    <application>
        <view-handler>org.ajax4jsf.application.AjaxViewHandler</view-handler>
    </application>

    <!-- Backing Beans -->  
    <managed-bean>
        <managed-bean-name>tableBacking</managed-bean-name>
        <managed-bean-class>edu.mayo.ccs.webdataviewer.ui.backing.TableLookupBacking</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
    </managed-bean>

</faces-config> 
```

索引.xhtml

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:a4j="http://richfaces.org/a4j" 
    xmlns:ui="http://java.sun.com/jsf/facelets">

    <ui:composition template="/template.xhtml">

        <ui:define name="title">Web Data Viewer</ui:define>

        <ui:define name="centerColumn">
            <h1>Web Data Viewer</h1>                                
        </ui:define>

    </ui:composition>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T22:36:20.037

根据评论，您在按照他们自己的[docbook](http://facelets.java.net/nonav/docs/dev/docbook.html)配置 Facelets 1.x 时遇到以下异常：

> 找不到完全合格的类：com.sun.facelets.FaceletViewHandler

显然，JBoss 5.x 没有附带 Facelets 1.x（可能非常好，因为它不是标准 Java EE 5 的一部分）。您需要自己在 webapp 的`/WEB-INF/lib`. [您可以从此处](http://mavenhub.com/mvn/thirdparty-releases/com.sun.facelets/jsf-facelets/1.1.15)的 Maven 存储库中获取它。就是`jsf-facelets.jar`文件。

请注意，JSF 2.x 不需要此文件，因为 Facelets 库捆绑在 JSF JAR 本身中。

# c# - 滚动 DataGrid 时出现 InvalidOperationException：绑定表达式已属于 BindingGroup

> ID：13866007
> 
> 赞同：4
> 
> 时间：2012-12-13T18:19:45.153
> 
> 标签：c#, wpf, xaml, datagrid

当尝试在 DataGrid 上向下滚动时，我收到一个 InvalidOperationException 说明，“绑定表达式已经属于一个 BindingGroup；它不能添加到不同的 BindingGroup”。我不知道任何正在使用的 BindingGroups，所以我不确定它在说什么。我已将其缩小到仅出现在下面的列中。我怀疑它也与虚拟化有关。有任何想法吗？

这是 DataGrid 标记：

```
<DataGrid x:Name="dgStudentSNP" 
              AutoGenerateColumns="False"

              Grid.Row="1" Margin="6,10" 
              HorizontalAlignment="Stretch"
              HeadersVisibility="Column"
              CanUserSortColumns="True"
              CanUserAddRows="False"
              CanUserResizeColumns="True"
              CanUserDeleteRows="False"
              BorderThickness="1"
              SelectedValuePath="SNPEnrollmentID" VerticalScrollBarVisibility="Auto" VerticalAlignment="Top" Height="Auto" IsReadOnly="True">
            <DataGrid.Columns>
                <DataGridTemplateColumn Header="Student Name" MinWidth="120">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock>
                                    <Hyperlink Click="GetStudentFamily" >
                                        <Run>
                                            <Run.Text >
                                                <MultiBinding StringFormat="{}{0} {1}">
                                                    <Binding Path="FirstName"/>
                                                    <Binding Path="LastName" />
                                                </MultiBinding>
                                            </Run.Text>                                                              
                                        </Run>
                                    </Hyperlink>
                            </TextBlock>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
              </DataGrid.Columns>
            </DataGrid> 
```

这是异常的堆栈跟踪：

```
Stack Trace :    at System.Windows.Data.BindingExpressionBase.JoinBindingGroup(BindingGroup bg, Boolean explicitJoin)
   at System.Windows.Data.BindingExpressionBase.RejoinBindingGroup(Boolean isReflective, DependencyObject contextElement)
   at System.Windows.Data.BindingExpression.OnDataContextChanged(DependencyObject contextElement)
   at System.Windows.Data.BindingExpression.HandlePropertyInvalidation(DependencyObject d, DependencyPropertyChangedEventArgs args)
   at System.Windows.Data.BindingExpressionBase.OnPropertyInvalidation(DependencyObject d, DependencyPropertyChangedEventArgs args)
   at System.Windows.Data.BindingExpression.OnPropertyInvalidation(DependencyObject d, DependencyPropertyChangedEventArgs args)
   at System.Windows.Data.MultiBindingExpression.HandlePropertyInvalidation(DependencyObject d, DependencyPropertyChangedEventArgs args)
   at System.Windows.Data.BindingExpressionBase.OnPropertyInvalidation(DependencyObject d, DependencyPropertyChangedEventArgs args)
   at System.Windows.DependentList.InvalidateDependents(DependencyObject source, DependencyPropertyChangedEventArgs sourceArgs)
   at System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args)
   at System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType)
   at System.Windows.TreeWalkHelper.OnInheritablePropertyChanged(DependencyObject d, InheritablePropertyChangeInfo info)
   at System.Windows.DescendentsWalker`1._VisitNode(DependencyObject d)
   at System.Windows.DescendentsWalker`1.VisitNode(DependencyObject d)
   at System.Windows.DescendentsWalker`1.WalkLogicalChildren(FrameworkElement feParent, FrameworkContentElement fceParent, IEnumerator logicalChildren)
   at System.Windows.DescendentsWalker`1.IterateChildren(DependencyObject d)
   at System.Windows.DescendentsWalker`1._VisitNode(DependencyObject d)
   at System.Windows.DescendentsWalker`1.VisitNode(DependencyObject d)
   at System.Windows.DescendentsWalker`1.WalkLogicalChildren(FrameworkElement feParent, FrameworkContentElement fceParent, IEnumerator logicalChildren)
   at System.Windows.DescendentsWalker`1.WalkFrameworkElementLogicalThenVisualChildren(FrameworkElement feParent, Boolean hasLogicalChildren)
   at System.Windows.DescendentsWalker`1.IterateChildren(DependencyObject d)
   at System.Windows.DescendentsWalker`1._VisitNode(DependencyObject d)
   at System.Windows.DescendentsWalker`1.VisitNode(FrameworkElement fe)
   at System.Windows.DescendentsWalker`1.VisitNode(DependencyObject d)
   at System.Windows.DescendentsWalker`1.WalkFrameworkElementLogicalThenVisualChildren(FrameworkElement feParent, Boolean hasLogicalChildren)
   at System.Windows.DescendentsWalker`1.IterateChildren(DependencyObject d)
   at System.Windows.DescendentsWalker`1.StartWalk(DependencyObject startNode, Boolean skipStartNode)
   at System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args)
   at System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType)
   at System.Windows.DependencyObject.SetValueCommon(DependencyProperty dp, Object value, PropertyMetadata metadata, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType, Boolean isInternal)
   at System.Windows.Controls.ContentPresenter.OnContentChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args)
   at System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType)
   at System.Windows.DependencyObject.InvalidateProperty(DependencyProperty dp)
   at System.Windows.Data.BindingExpressionBase.Invalidate(Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.TransferValue(Object newValue, Boolean isASubPropertyChange)
   at System.Windows.Data.BindingExpression.Activate(Object item)
   at System.Windows.Data.BindingExpression.OnDataContextChanged(DependencyObject contextElement)
   at System.Windows.Data.BindingExpression.HandlePropertyInvalidation(DependencyObject d, DependencyPropertyChangedEventArgs args)
   at System.Windows.Data.BindingExpressionBase.OnPropertyInvalidation(DependencyObject d, DependencyPropertyChangedEventArgs args)
   at System.Windows.Data.BindingExpression.OnPropertyInvalidation(DependencyObject d, DependencyPropertyChangedEventArgs args)
   at System.Windows.DependentList.InvalidateDependents(DependencyObject source, DependencyPropertyChangedEventArgs sourceArgs)
   at System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args)
   at System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType)
   at System.Windows.DependencyObject.SetValueCommon(DependencyProperty dp, Object value, PropertyMetadata metadata, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType, Boolean isInternal)
   at System.Windows.Controls.ItemContainerGenerator.LinkContainerToItem(DependencyObject container, Object item, Boolean isRecycled)
   at System.Windows.Controls.ItemContainerGenerator.OnItemReplaced(Object oldItem, Object newItem, Int32 index)
   at System.Windows.Controls.ItemContainerGenerator.OnCollectionChanged(Object sender, NotifyCollectionChangedEventArgs args)
   at System.Windows.Controls.ItemContainerGenerator.System.Windows.IWeakEventListener.ReceiveWeakEvent(Type managerType, Object sender, EventArgs e)
   at System.Windows.WeakEventManager.DeliverEventToList(Object sender, EventArgs args, ListenerList list)
   at System.Windows.WeakEventManager.DeliverEvent(Object sender, EventArgs args)
   at System.Collections.Specialized.CollectionChangedEventManager.OnCollectionChanged(Object sender, NotifyCollectionChangedEventArgs args)
   at System.Collections.Specialized.NotifyCollectionChangedEventHandler.Invoke(Object sender, NotifyCollectionChangedEventArgs e)
   at System.Windows.Data.CollectionView.OnCollectionChanged(NotifyCollectionChangedEventArgs args)
   at System.Windows.Controls.ItemCollection.System.Windows.IWeakEventListener.ReceiveWeakEvent(Type managerType, Object sender, EventArgs e)
   at System.Windows.WeakEventManager.DeliverEventToList(Object sender, EventArgs args, ListenerList list)
   at System.Windows.WeakEventManager.DeliverEvent(Object sender, EventArgs args)
   at System.Collections.Specialized.CollectionChangedEventManager.OnCollectionChanged(Object sender, NotifyCollectionChangedEventArgs args)
   at System.Windows.Data.CollectionView.OnCollectionChanged(NotifyCollectionChangedEventArgs args)
   at System.Windows.Data.ListCollectionView.ProcessCollectionChangedWithAdjustedIndex(NotifyCollectionChangedEventArgs args, Int32 adjustedOldIndex, Int32 adjustedNewIndex)
   at System.Windows.Data.ListCollectionView.ProcessCollectionChanged(NotifyCollectionChangedEventArgs args)
   at System.Windows.Data.CollectionView.OnCollectionChanged(Object sender, NotifyCollectionChangedEventArgs args)
   at System.Windows.Controls.MultipleCopiesCollection.OnCollectionChanged(NotifyCollectionChangedEventArgs e)
   at System.Windows.Controls.MultipleCopiesCollection.set_CopiedItem(Object value)
   at System.Windows.Controls.Primitives.DataGridCellsPresenter.OnItemChanged(Object oldItem, Object newItem)
   at System.Windows.Controls.DataGridRow.OnItemChanged(Object oldItem, Object newItem)
   at System.Windows.Controls.DataGridRow.NotifyPropertyChanged(DependencyObject d, String propertyName, DependencyPropertyChangedEventArgs e, DataGridNotificationTarget target)
   at System.Windows.Controls.DataGridRow.OnNotifyRowPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.Controls.DataGridRow.OnPropertyChanged(DependencyPropertyChangedEventArgs e)
   at System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args)
   at System.Windows.DependencyObject.UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType)
   at System.Windows.DependencyObject.SetValueCommon(DependencyProperty dp, Object value, PropertyMetadata metadata, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType, Boolean isInternal)
   at System.Windows.DependencyObject.SetValue(DependencyProperty dp, Object value)
   at System.Windows.Controls.DataGridRow.PrepareRow(Object item, DataGrid owningDataGrid)
   at System.Windows.Controls.DataGrid.PrepareContainerForItemOverride(DependencyObject element, Object item)
   at System.Windows.Controls.ItemsControl.MS.Internal.Controls.IGeneratorHost.PrepareItemContainer(DependencyObject container, Object item)
   at System.Windows.Controls.ItemContainerGenerator.System.Windows.Controls.Primitives.IItemContainerGenerator.PrepareItemContainer(DependencyObject container)
   at System.Windows.Controls.VirtualizingStackPanel.InsertContainer(Int32 childIndex, UIElement container, Boolean isRecycled)
   at System.Windows.Controls.VirtualizingStackPanel.AddContainerFromGenerator(Int32 childIndex, UIElement child, Boolean newlyRealized)
   at System.Windows.Controls.VirtualizingStackPanel.MeasureOverride(Size constraint)
   at System.Windows.Controls.Primitives.DataGridRowsPresenter.MeasureOverride(Size constraint)
   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)
   at System.Windows.UIElement.Measure(Size availableSize)
   at System.Windows.ContextLayoutManager.UpdateLayout()
   at System.Windows.ContextLayoutManager.UpdateLayoutCallback(Object arg)
   at System.Windows.Media.MediaContext.InvokeOnRenderCallback.DoWork()
   at System.Windows.Media.MediaContext.FireInvokeOnRenderCallbacks()
   at System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget)
   at System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
   at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)
   at System.Windows.Threading.DispatcherOperation.InvokeImpl()
   at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)
   at System.Threading.ExecutionContext.runTryCode(Object userData)
   at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Windows.Threading.DispatcherOperation.Invoke()
   at System.Windows.Threading.Dispatcher.ProcessQueue()
   at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)
   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
   at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)
   at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)
   at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)
   at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG& msg)
   at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)
   at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)
   at System.Windows.Application.RunDispatcher(Object ignore)
   at System.Windows.Application.RunInternal(Window window)
   at System.Windows.Application.Run(Window window)
   at Oasis.App.Main() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-17T14:36:25.183

将 BindingGroupName 设置为 null 确实有效。这对我来说很神秘，我希望其他更了解正在发生的事情的人会发布答案。但是，在上面发布的文档 eran otzap 中：

[http://msdn.microsoft.com/en-us/library/system.windows.data.bindinggroup.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.bindinggroup.aspx)

它说：

> 您在 FrameworkElement 或 FrameworkContentElement 上设置 BindingGroup 属性。子元素从其父元素继承 BindingGroup，就像任何其他可继承属性一样。如果发生以下情况之一，则将后代元素上的绑定添加到 BindingGroup：
> 
> *   绑定的源和具有 BindingGroup 的元素的 DataContext 是同一个对象，并且未设置 BindingGroupName 属性。
>     
>     
> *   绑定的 BindingGroupName 属性等于 BindingGroup 的名称，并且它们没有显式设置为 null。在地址的例子中，假设 Panel 的 DataContext 设置为 Address 类型的对象。每个 TextBox 的绑定都添加到面板的 BindingGroup 中。

看起来，当您在数据网格中使用多重绑定时，BindingGroup 与绑定的 BindingGroupName 不匹配，因此当您尝试更新这些绑定时会出现错误。

解决方案是将 MultiBinding 的 BindingGroupName 显式设置为 null，例如

```
 <MultiBinding StringFormat="{}{0} {1}" BindingGroupName="{x:Null}">
      <Binding Path="FirstName"/>
      <Binding Path="LastName" />
   </MultiBinding> 
```

我不知道这会在以后产生什么影响，但它使这个特定的异常消失了。

# php - 我可以安全地假设这个 INSERT 成功了吗？

> ID：13866009
> 
> 赞同：0
> 
> 时间：2012-12-13T18:19:57.087
> 
> 标签：php, mysql, error-handling

我正在使用打开严格模式的 MySQL。我正在通过 HTML 表单插入用户提供的数据。我已经完成了所有的验证，这是最后一步。

**这是我的 PHP 代码的摘录：**

```
$sql = 'SET sql_mode = TRADITIONAL'; //last chance data validation
$mysqli->query($sql) or output_error('Database Error: Failed to set SQL mode');

$db_err_msg = 'Database Error: Failed to update profile summary';
$sql = "INSERT INTO {$tables['text']} (lngProfileId, memProfileText) VALUES(?, ?)
    ON DUPLICATE KEY UPDATE memProfileText = VALUES(memProfileText)";
$stmt = $mysqli->prepare($sql) or output_error($db_err_msg);
$stmt->bind_param('is', $profile_id, $_POST['memProfileText'])
    or output_error($db_err_msg);
$stmt->execute() or output_error($db_err_msg);
$stmt->close();

//if code reaches this point, can it assume insert/update succeeded? 
```

**注意：** `output_error`是我的致命错误的错误处理程序。它不会返回；它退出。

我需要检查警告吗？或者我可以安全地假设插入/更新成功吗？即使打开了严格模式，是否存在一些可能导致警告而不是错误的情况？

**编辑：**我只关心应该被视为*致命*错误的事情。如果它是更新而不是插入，那对我来说无关紧要。那不是错误。

此外，`last_insert_id`并且`affected_rows`在这种情况下毫无意义。如果用户没有进行任何更改，affected_rows 将为 0，并且 last_insert_id 的值不会被更新。

在这种情况下，我对*成功的定义：*

*   它插入了记录或更新了记录，或者如果没有进行任何更改，则什么也不做
*   它没有“默默地破坏我的数据”

许多新手程序员错误地*认为*查询成功而没有检查返回值或警告。他们的代码*工作*......在正常条件下。

*我的问题是：* **“考虑到我的代码，打开了严格模式，并且我已经完成了错误检查，假设查询成功是否安全？这是正确还是不正确的假设？我是否也应该检查警告还是那样是多余的吗？”**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:32:10.293

您应该检查[`mysqli::info()`](http://php.net/manual/en/mysqli.info.php)函数的值。

如果它插入数据，字符串将如下所示，

```
Records: 1 Duplicates: 0 Warnings: 0 
```

另一个功能是[`mysqli::affected_rows`](http://php.net/manual/en/mysqli.affected-rows.php)。它返回上次插入/更新/删除查询受影响的行数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:28:27.623

是的，您可以放心地假设，但只是为了仔细检查获取插入的最新记录的 ID。如果有一个id，那么它就被插入了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-16T14:26:01.393

虽然我认为这可能是一个安全的假设，但我认为*安全总比抱歉好*。我在close语句之前的execute语句之后直接添加了以下代码。

```
//I think this is probably redundant, but just in case
if ($mysqli->warning_count) {
    $warnings = $stmt->get_warnings();
    do {
        trigger_error('Database Warning (' . $warnings->errno . '): '
            . $warnings->message, E_USER_WARNING);
    } while ( $warnings->next() );
} 
```

我添加了评论，以便我记得我为什么这样做。

# java - 如何将自定义 java 对象添加到 HashTable

> ID：13866011
> 
> 赞同：0
> 
> 时间：2012-12-13T18:19:58.103
> 
> 标签：java, collections, hashmap, hashtable

我有一个名为 Items 的类，其中包含一些数据，如下所示：

```
class Items {
    public String item1 ;
    public String item2;
    public int item3;
} 
```

我有另一个 Java 类，它为这个 Items 类设置值，如下所示：

```
Items tempItems1 = new Items();
tempItems1 .item1  = "a";
tempItems1 .item2  = "b";
tempItems1 .item3  = 1;

Items tempItems2 = new Items();
tempItems2 .item1  = "aa";
tempItems2 .item2  = "bb";
tempItems2 .item3  = 11; 
```

现在的问题是我需要将这两个对象（tempItems1，tempItems2）添加到 HashTable 中，这样我就可以遍历 HashTable 来获取它的值。

我如下创建了 HashTable，但无法找到一种方法来添加上述每个 Java 对象并遍历它。

```
HashTable<String,Items> custom = new HashTable<String,Items>(); 
```

任何人都可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:27:24.930

添加

```
custom.put("string_key1", tempItems1);
custom.put("string_key2", tempItems2); 
```

遍历

```
for (Map.Entry<String, Items> entry : custom.entrySet()) {
    // entry.getKey()
    // entry.getValue()
} 
```

# ios - 在 UIAutomation 中获取设备方向

> ID：13866018
> 
> 赞同：0
> 
> 时间：2012-12-13T18:20:33.690
> 
> 标签：ios, orientation, ios-ui-automation, device-orientation

我正在为我的程序编写自动化测试，并希望自动化设备方向......我正在使用下面的代码来设置设备的方向，

```
UIATarget.localTarget().setDeviceOrientation(UIA_DEVICE_ORIENTATION_LANDSCAPERIGHT); 
```

但我也希望获得设备的当前方向。我找不到任何 getDeviceOrientation() 方法来获取方向。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T18:37:29.833

你有没有尝试过：

```
var orientation = UIATarget.localTarget().deviceOrientation() 
```

从[文档](http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Reference/UIATargetClassReference/UIATargetClass/UIATargetClass.html)中：

> **设备方向**
> 
> 讨论
> 
> 返回值是一个常量，表示设备的物理方向，可能与您应用程序用户界面的当前方向不同。可能的值如下：

```
UIA_DEVICE_ORIENTATION_UNKNOWN
UIA_DEVICE_ORIENTATION_PORTRAIT
UIA_DEVICE_ORIENTATION_PORTRAIT_UPSIDEDOWN
UIA_DEVICE_ORIENTATION_LANDSCAPELEFT
UIA_DEVICE_ORIENTATION_LANDSCAPERIGHT
UIA_DEVICE_ORIENTATION_FACEUP
UIA_DEVICE_ORIENTATION_FACEDOWN 
```

* * *

## 编辑

设备方向可能在模拟器上不可用。最好`interfaceOrientation()`在`UIAApplication`对象上使用。

```
var target = UIATarget.localTarget();
var app = target.frontMostApp();
var orientation = app.interfaceOrientation();

if (orientation == UIA_INTERFACE_ORIENTATION_PORTRAIT || orientation == UIA_INTERFACE_ORIENTATION_PORTRAIT_UPSIDEDOWN) {
    UIALogger.logDebug("Portrait");
} else if (orientation == UIA_INTERFACE_ORIENTATION_LANDSCAPELEFT || orientation == UIA_INTERFACE_ORIENTATION_LANDSCAPERIGHT) {
    UIALogger.logDebug("Landscape");    
} 
```

[这个指南](http://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/UsingtheAutomationInstrument/UsingtheAutomationInstrument.html#//apple_ref/doc/uid/TP40004652-CH20)很不错。

# winforms - Windows 窗体设计器代码修改用户控件集合和对象

> ID：13866020
> 
> 赞同：0
> 
> 时间：2012-12-13T18:20:40.973
> 
> 标签：winforms, visual-studio, custom-controls, designer

VS 2010，Windows 7：Windows 窗体 - 我有许多包含引用域模型对象的用户控件的窗体。一些控件引用单个对象和一些域模型对象的引用集合。当我打开项目或单个表单时，IDE 将检查表单并添加虚拟域模型对象。在某些情况下，这没有严重的副作用，而在其他情况下，这会导致应用程序崩溃。为什么会发生这种情况，我该如何防止这种情况在未来发生？我想达到设计师不添加任何无关内容的地步——非常感谢我可以让系统崩溃。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T20:08:26.960

设计器将为当前显示的控件的子用户控件中包含的每个公共属性创建一个默认实例。这可以通过[`DesignerSerializationVisibilityAttribute`](http://msdn.microsoft.com/en-us/library/system.componentmodel.designerserializationvisibilityattribute.visibility.aspx)将可见性设置为来更改`DesignerSerializationVisibility.Hidden`。

这告诉设计师不要管这些属性。

您可能必须检查设计器文件本身并删除您标记的属性的旧分配和分配。

# java - php和flume直接集成还是php和java集成？

> ID：13866029
> 
> 赞同：1
> 
> 时间：2012-12-13T18:20:58.557
> 
> 标签：java, php, hbase, thrift, flume

我正在开发一个使用java在hbase中记录数据的客户端，我使用flume与hbase的集成，我已经开发了客户端并且我的应用程序完美地使用了它，问题是所有使用客户端的应用程序也是在java下开发的，还有一个我在php下开发的应用程序中，问题是：：是否可以在php和java之间进行通信，或者直接在php和flume之间进行通信以在hbase中记录数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:24:21.410

您可以使用 PHP-Java Bridge 同时使用 Java 和 PHP！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:49:30.687

[正如此答案](https://stackoverflow.com/a/4906462/217079)中所建议的，您可以在 PHP 应用程序中将日志写入[syslog](http://php.net/manual/en/function.syslog.php)，并且 Flume 可以使用其[syslog 源](http://flume.apache.org/FlumeUserGuide.html#syslog-sources)之一读取它们。

# c++ - 内存复制向量？

> ID：13866032
> 
> 赞同：-3
> 
> 时间：2012-12-13T18:21:17.653
> 
> 标签：c++, c, arrays, vector

我有一段 C 代码：

```
mel[i] = malloc(sizeof(double)*mellength[i]);           
memcpy(mel[i],&temp[melstart[i]],mellength[i]*sizeof(double)); 
```

我将其转换为 C++ 并使用向量而不是数组：

```
vector< vector< double > > mel; // 2D vector

mel[i].resize(mellength[i]); 
```

我有一个名为“temp”（一维）的数组，我想将“temp”中的所有元素复制到向量 mel 中。我试过这个：

```
for(int k=0; (k < mellength[i]); k++)
{
    mel[i][k] = temp[i];
    cout << mel[i][k] << endl;
} 
```

但是它不起作用，只是打印出不应该存在的值。如果您想深入了解我正在尝试做的事情，我已经包含了 C 函数以及下面的 C++ 函数。

C函数：

```
void Setup_Mel(int fft_size, int sample_rate) {
    int i,j,k,tap;
    double fmax;
    double dphi;
    double fsample;
    double freq;
    double temp[fft_size/2];

    fmax=2595*log10(8000.0f/700+1);
    dphi = fmax/17;
    freq = (double)sample_rate/fft_size;

    for (i=0; i<16; i++) {
            melstart[i]=fft_size/2;
            mellength[i]=0;
            memset(temp,0,sizeof(double)*fft_size/2);
            for (j=0; j<fft_size/2; j++) {
                    fsample = 2595*log10(freq*j/700 + 1);

                    if ((dphi*i <= fsample) && (fsample < dphi*(i+1))) temp[j] = (fsample-dphi*i)/(dphi*(i+1)-dphi*i);
                    if ((dphi*(i+1) <= fsample) && (fsample < dphi*(i+2))) temp[j] = (fsample-dphi*(i+2))/(dphi*(i+1)-dphi*(i+2));
                    if ((temp[j] != 0) && (melstart[i] > j)) melstart[i] = j;
                    if (temp[j] != 0) mellength[i]++;
            }
            mel[i] = malloc(sizeof(double)*mellength[i]);           
            memcpy(mel[i],&temp[melstart[i]],mellength[i]*sizeof(double));
  //              for (k=0; k<mellength[i]; tap++,k++) printf("mel filter: %d, %d, %d, %f,  %f\n",i,melstart[i]+k,tap,mel[i][k],(melstart[i]+k)*freq);
    }
} 
```

C++ 代码：

```
void setUp_Mel(int fft_size, int sample_rate, vector< vector< double > > &mel, int *melstart, int *mellength)
{
    double fmax;
    double dphi;
    double fsample;
    double freq;
    double temp[fft_size/2];

fmax = 2595*log10(8000.0f/700+1);
dphi = fmax / 17;
freq = (double)sample_rate/fft_size;

  for(int i=0; (i < 16); i++)
  { 
      melstart[i] = fft_size/2;
      mellength[i] = 0;
      double temp[fft_size/2];
      //double *temp = new double[fft_size/2];

      for(int j=0; (j < fft_size/2); j++)
      {
          fsample = 2595*log10(freq*j/700 + 1);

          if ((dphi*i <= fsample) && (fsample < dphi*(i+1)))
          {
             temp[j] = (fsample-dphi*i)/(dphi*(i+1)-dphi*i);
          }

          if ((dphi*(i+1) <= fsample) && (fsample < dphi*(i+2))) {

              temp[j] = (fsample-dphi*(i+2))/(dphi*(i+1)-dphi*(i+2));
          }

          if ((temp[j] != 0) && (melstart[i] > j))
          {
              melstart[i] = j;
          }

          if (temp[j] != 0) mellength[i]++;

      }
      mel[i].resize(mellength[i]);

      for(int k=0; (k < mellength[i]); k++)
      {
          mel[i] = temp[i];
      }

  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:35:21.350

首先，您需要确保外部向量具有正确的大小。

```
vector< vector< double > > mel; // 2D vector
mel.resize( numberOfArrays ); 
```

然后您可以使用`assign`成员函数进行复制：

```
mel[i].assign( temp, temp + mellength[i] ); 
```

如果这不起作用，则向量不是问题。

* * *

无论如何，查看您的 C++ 函数，我看不到您首先发布的代码。我看到这个：

```
 mel[i].resize(mellength[i]);

  for(int k=0; (k < mellength[i]); k++)
  {
      mel[i] = temp[i];
  } 
```

`i`用作迭代器而不是（`k`除其他外）。那不会复制临时数组。它甚至不应该编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:37:37.317

```
 for(int k=0; (k < mellength[i]); k++)
      {
          mel[i] = temp[i];
      } 
```

`mel[i]`除了将相同的值分配给值`temp[i]`k 次之外，您在此循环中绝对不做任何事情。我的猜测是您忘记在 for 循环中使用 k 变量。

# java - 在不使用数组的情况下删除字符串中的重复项

> ID：13866036
> 
> 赞同：0
> 
> 时间：2012-12-13T18:21:36.963
> 
> 标签：java

```
 String input = "AAAB";

    String output = "";
    for (int index = 0; index < input.length(); index++) {
        if (input.charAt(index % input.length()) != input
                .charAt((index + 1) % input.length())) {

            output += input.charAt(index);

        }
    }
    System.out.println(output); 
```

但如果我的输入是“ABABAB”或只是“AAAA”，它就不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T18:23:11.283

使用数据结构来了解是否已找到字符，例如[`Set`](http://docs.oracle.com/javase/6/docs/api/java/util/Set.html). 例如，您可以使用它的[`add()`](http://docs.oracle.com/javase/6/docs/api/java/util/Set.html#add%28E%29)方法并检查它的返回值。

此外，您可能会考虑使用[`StringBuilder`](http://docs.oracle.com/javase/6/docs/api/java/lang/StringBuilder.html)重复连接，它更有效。

```
Set<Character> characters = new HashSet<Character>();
String input = "AAAB";
StringBuilder output = new StringBuilder();
for (int index = 0; index < input.length(); index++) {
    char character = input.charAt(index);
    if (characters.add(character)) {
        output.append(character);
    }
}
System.out.println(output.toString()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T18:47:37.830

针对速度版本进行了优化

```
public static void main(String[] args) {
    String input = "AAAB";
    StringBuilder output = new StringBuilder();
    for (int i = 0; i < input.length(); i++) {
        if (!contains(output, input.charAt(i))) {
            output.append(input.charAt(i));
        }
    }
    System.out.println(output);
}

private static boolean contains(StringBuilder output, char c) {
    for(int i = 0; i < output.length();  i++) {
        if (output.charAt(i) == c) {
            return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T18:54:22.500

```
public static void print(String s) {
    List<String> v = new ArrayList<String>();
    for(int j=0; j<s.length(); j++) {
        if(!v.contains("" + s.charAt(j)))
            v.add("" + s.charAt(j));
    }

    for(String e : v)
        System.out.print(e);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T18:45:38.070

（我希望你的意思是重复，而不是重复。）

```
public static String withoutDuplicates(String s) {
    for (int i = 0; i < s.length(); ) {
        boolean removedDuplicate = false;
        for (int duplicateLength = (s.length() - i) / 2; duplicateLength >= 1; 
                --duplicateLength) {
            if (foundDuplicate(s, i, duplicateLength)) {
                s = s.substring(0, i) + s.substring(i + duplicateLength);
                removedDuplicate = true;
                break;
            }
        }
        if (!removedDuplicate) {
            ++i;
        }
    }
    return s;
}

private static boolean foundDuplicate(String s, int i, int duplicateLength) {
    String sought = s.substring(i, i + duplicateLength);
    return s.indexOf(sought, i + duplicateLength) != -1;
} 
```

* * *

***更正：*** duplicateLength 初始化值超出范围。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T18:49:29.540

让我们看看你的循环在做什么：

```
if (input.charAt(index % input.length()) != input
  .charAt((index + 1) % input.length())) 
```

1) 首先，您应该认识到执行 '% input.length()' 操作是在浪费时间和处理能力，因为 index 总是小于 input.length()，所以 index%input。长度（）总是等于索引。

让我们忽略 %input.length() 。

2) 当您比较 input.charAt(index) 和 input.charAt(index+1) 时，您只是将当前字符与下一个字符进行比较。如果我理解正确，最初的问题会要求您删除所有重复项，而不仅仅是那些出现在彼此旁边的重复项。

3）您的算法很可能会引发 IndexOutOfBounds 异常，因为当您到达字符串末尾时（当 index == input.length() - 1 时）检查 input.charAt(index+1) 会在细绳。

正如第一个答案所建议的那样，您将希望利用某种形式的数据结构来存储您遇到的所有 DISTINCT 字符。每当您遇到一个新角色时，您都需要 a) 将其添加到您的数据结构中，并且 b) 将其添加到输出的末尾。

# c# - 使用 jquery 从区域内的操作中呈现 html

> ID：13866038
> 
> 赞同：0
> 
> 时间：2012-12-13T18:21:42.957
> 
> 标签：c#, asp.net-mvc, jquery

我有一个看起来像这样的 jquery 点击方法

```
<script type="text/javascript">
    function clickView(e) {
        e.preventDefault();
        var dataItem = this.dataItem($(e.currentTarget).closest("tr"));
        $.ajax({
            url: "/Jac/ViewCustomDetails",
            data: { productId: dataItem.Id },
            success: function (response) {
                $("#details").html(response);
            },
            error: function (xhr, ajaxOptions, thrownError) {
                alert(xhr.status);
                document.write(xhr.responseText);
            }
        });
    }
</script> 
```

基本上，这会对我的控制器进行 AJAX 调用以呈现操作。

`ViewCustomDetails`区域内和区域内的操作`JacController`如下所示：

```
 public ActionResult ViewCustomDetails(int productId)
    {
        Detail model;

        model = new Detail
        {
            Price = productId.ToString(),
            Origin = productId.ToString()
        };

        return View(model);
    } 
```

当我单击触发 AJAX 调用的按钮时，我可以进入我的操作。但是我认为这个错误

```
The view 'ViewCustomDetails' or its master was not found or no view engine supports the searched locations. The following locations were searched:
~/Views/Jac/ViewCustomDetails.aspx
~/Views/Jac/ViewCustomDetails.ascx
~/Views/Shared/ViewCustomDetails.aspx
~/Views/Shared/ViewCustomDetails.ascx
~/Views/Jac/ViewCustomDetails.cshtml
~/Views/Jac/ViewCustomDetails.vbhtml
~/Views/Shared/ViewCustomDetails.cshtml
~/Views/Shared/ViewCustomDetails.vbhtml 
```

显然我的视图文件夹中没有这样的控制器/操作，因为我的控制器在一个区域内。

如何让它引用我所在地区的控制器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T05:31:08.380

它正在引用您的控制器，但`return View(model);`您的 ViewCustomDetails 方法中的行需要存在一个视图文件，该文件通常称为 ViewCustomDetails.cshtml

此视图文件必须采用模型类型`Detail`

您可能还需要对返回的视图进行 JSON 化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T14:24:45.120

我只需要在 jquery 代码中将区域名称添加到我的 URL 中

```
url: "/Dan/Jac/ViewCustomDetails", 
```

而不仅仅是

```
url: "/Jac/ViewCustomDetails", 
```

# java - 什么是最适合表示 JSON 的 Java 数据结构？

> ID：13866039
> 
> 赞同：3
> 
> 时间：2012-12-13T18:21:43.453
> 
> 标签：java, android, json, data-structures

我正在开发一个 RESTful Android 移动客户端。我的应用程序和服务器之间的信息交换采用 JSON 格式。所以我现在有点困惑选择什么数据结构来表示 JSON 响应和数据，因为它们有很多。我刚刚停止使用 LinkedHashMap<> 但据我所知 JSON 是无序的。在互联网上，我看到人们为此使用 Map<> 或 HashMap<>。

所以问题是——为此目的最好的数据结构是什么？或者，如果没有明确的答案——我已经提到过使用数据结构的利弊。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T18:41:01.113

我不同意第一个答案。开发 REST 范式是为了让您使用对象而不是操作进行操作。

对我来说，最明智的方法是在客户端声明 bean 并解析 json 响应并通过它们请求。我建议使用[GSON 库](http://code.google.com/p/google-gson/)进行序列化/反序列化。`JsonObject`/`JsonArray`几乎从来都不是最好的选择。

也许如果您给出您将要使用的操作的示例，我们可能能够更准确地提供帮助。

**编辑：**让我也举几个 GSON 的例子。让我们使用这个线程来比较不同的库。

在大多数情况下，REST 服务与对象通信。假设您发布了产品的帖子，其中提到了商店。

```
{ "name": "Bread",
  "price": 0.78,
  "produced": "08-12-2012 14:34",
  "shop": {
     "name": "neighbourhood bakery"
  }
} 
```

然后，如果您声明以下 bean：

```
public class Product {
    private String name;
    private double price;
    private Date produced;
    private Shop shop;
    // Optional Getters and setters. GSON uses reflection, it doesn't need them
    // However, better declare them so that you can access the fields
}

public class Shop {
   private String name;
    // Optional Getters and setters. GSON uses reflection, it doesn't need them
    // However, better declare them so that you can access the fields
} 
```

您可以使用以下方法反序列化 json：

```
String jsonString; // initialized as you can
GsonBuilder gsonBuilder = new GsonBuilder();
gsonBuilder.setDateFormat("MM-dd-yyyy HH:mm"); // setting custom date format
Gson gson = gsonBuilder.create();
Product product = gson.fromJson(jsonString, Product.class);
// Do whatever you want with the object it has its fields loaded from the json 
```

另一方面，您可以更轻松地序列化为 json：

```
GsonBuilder gsonBuilder = new GsonBuilder();
gsonBuilder.setDateFormat("MM-dd-yyyy HH:mm"); // setting custom date format
Gson gson = gsonBuilder.create();
String jsonString = gson.toJson(product); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:26:55.040

您是在谈论从服务器请求中接收和解析 JSON 字符串吗？

为此，您可以使用：

```
import org.json.JSONArray;
import org.json.JSONObject; 
```

使用这些，我从我的 POST 请求中读取我的 JSON 数组，并将结果信息存储在我项目中的 Class 对象中。

对于 JSONArray 中的每个项目，您可以像这样提取 JSONObject 和属性：

```
for (int i = 0; i < jsonArray.length(); i++) {
    JSONObject jsonObject = jsonArray.getJSONObject(i);
    jsonObject.getString("text");
} 
```

就实际存储数据而言，如上所述，JSON 数据可以有多种格式，具体取决于来源，因此，它通常在客户端解析并保存在您的应用程序类对象中以供使用。或者更一般地说，您可以使用`Map<String, Object>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-14T20:07:52.267

这很容易是我见过的最佳答案：

[https://dzone.com/articles/which-is-the-right-java-abstraction-for-json](https://dzone.com/articles/which-is-the-right-java-abstraction-for-json)

总结：共有三种抽象：pojo、地图和列表，以及表示对象、数组和原语的自定义类。每个人都有优点和缺点，没有明显的赢家。

Pojos 有最大的优势，但你不能总是使用它们。如果可以，请使用它们，如果必须，请使用其他。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T18:39:38.563

如果您正在做的不是最简单的映射，那么您应该使用完整的类结构。创建您的类层次结构作为 JSON 中数据结构的镜像，并使用[Jackson](http://wiki.fasterxml.com/JacksonInFiveMinutes)使用 ObjectMapper 将 JSON 直接映射到类层次结构。

使用此解决方案，您无需将 Object 转换为 Map 或弄乱 JSONObject 或 JSONArray，并且您的代码中没有任何多级映射遍历。您只需获取 JSON 字符串，将其提供给 ObjectMapper，然后获取您的 Object，其中包含由 ObjectMapper 自动映射的子对象（甚至是集合）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T18:54:43.517

我使用[xstream](http://xstream.codehaus.org)来[序列化 JSON](http://xstream.codehaus.org/json-tutorial.html)，方式如下：

```
XStream xstream = new XStream(new JsonHierarchicalStreamDriver());
xstream.setMode(XStream.NO_REFERENCES);
xstream.alias("myAlias", MyClass.class); // requires a no argument constructor
System.out.println(xstream.toXML(product)); 
```

好的，评论里的先生想要一个反序列化的例子，给你：

```
XStream xstream = new XStream(new JsonHierarchicalStreamDriver());
xstream.alias("myAlias", MyClass.class);
Product product = (Product)xstream.fromXML(json);
System.out.println(product.getName()); 
```

如果您需要进一步的帮助，请告诉我...

# spring - Spring-MVC bean Validation Type mismtach错误

> ID：13866043
> 
> 赞同：-1
> 
> 时间：2012-12-13T18:22:04.313
> 
> 标签：spring, spring-mvc, bean-validation

我正在尝试使用 Spring JSR303 验证来验证对象，我有一个表单对象，其中包含一些嵌套对象以及一些表单属性，这是我的表单签名

```
public class PaymentDetailsForm
{
  private AddressForm billingAddress;
  // other properties and getter and setters

} 
```

在我的`AddressForm`bean 中，我使用 Bean 验证注释来验证数据，但我没有在我的 for中使用任何`@Valid`注释。这是我的 Controller 方法的签名`PaymentDetailsForm``billingAddress`

```
public String createUpdatePaymentInfos(final Model model,
@ModelAttribute("paymentInfo") @Valid final PaymentDetailsForm form, final BindingResult bindingResult)
{
} 
```

如果我从表单发送正确的数据，一切工作正常，但如果我省略任何`billingAddress`标记为必填或不为空的字段，我将收到以下绑定错误异常

```
org.springframework.validation.BeanPropertyBindingResult: 1 errors
Field error in object 'paymentInfo' on field 'billingAddress': 
rejected value [com.xxx.storefront.forms.AddressForm@e39f6f1,true]; 
codes [typeMismatch.paymentInfo.billingAddress,typeMismatch.billingAddress,typeMismatch.com.xxx.storefront.forms.AddressForm,typeMismatch];
arguments [org.springframework.context.support.DefaultMessageSourceResolvable: 
codes [paymentInfo.billingAddress,billingAddress]; arguments []; default message [billingAddress]]; 
default message [Failed to convert property value of type 'java.lang.String[]' 
to required type 'com.xxx.storefront.forms.AddressForm' for property 'billingAddress';
nested exception is java.lang.IllegalStateException: 
Cannot convert value of type [java.lang.String[]] to required type [com.xxx.storefront.forms.AddressForm] for property 'billingAddress': 
no matching editors or conversion strategy found] 
```

我期待由于我没有`@valid`为 billingAddress 属性使用注释，因此不应该对其进行验证，但即使它得到验证，我也无法理解上述异常/错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:04:13.530

您看到的 bindingResult 看起来不是因为验证错误，很可能是因为绑定错误 - 无法将 UI 字段绑定到内部 billingAddress 字段。即使是绑定错误最终也会显示在紧随其后的 bindingresult 参数中，就像您看到的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:46:35.927

这是由于来自 UI 的一些错误映射，在我的 JSP 页面中，我将地址字段映射到`billingAddress`对象，但是有一个隐藏字段，例如

```
<form:hidden path="billingAddress" id="billingAddress"/> 
```

这是错误的原因，因为它试图发送字符串数组并且 Spring 绑定无法区分我正在尝试做什么

# sql-server-2008 - 在安排活动时显示美国假期的日历

> ID：13866044
> 
> 赞同：2
> 
> 时间：2012-12-13T18:22:05.063
> 
> 标签：sql-server-2008, sql-server-2005, coldfusion

我的客户通常会提前几个月为她的客户安排约会。如果预订发生在美国假日日/周期间，我的客户希望获悉计划日期在美国假日期间（她在假日期间的服务收费更高）。

*我的客户只关心以下日期：*

*   新年 12 月 30 日至 1 月 2 日
*   三月春假周（三月第三周）
*   复活节周末（这个日期每年都不同）
*   五月阵亡将士纪念日周末
*   七月的独立日周末
*   九月的劳动节周末
*   11 月的周一至周日的感恩节周
*   圣诞周 12 月 22 日至 28 日

我想尽可能自动化，这样她就不必每年更新数据库，但这不是她的要求，而是我的要求。:D 最好将假期日期/规则输入数据库或使用规则来确定约会日期是否在安排约会时的假期日/周内？

如果数据库是答案，我需要一些关于数据库设计以及如何设置事件重复发生的帮助。如果基于规则，我也需要一些帮助（例如确定春假、复活节等的时间）。

我正在使用 MSSQL 2005（可能很快就会迁移到 mssql 2008）和 ColdFusion 9。

TIA

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:03:37.673

我上个月[写了一个 UDF来帮助处理许多美国假期，但它并没有涵盖所有内容。](http://matthewbusche.com/blog/index.cfm/2012/11/26/get-US-Bank-Holidays-UDF)这应该给你一个体面的开始。

您还可以使用[CFLib](http://cflib.org/udf/getBankHolidays)中的这个 UDF 来获得复活节

一旦你有阵亡将士纪念日，你可以做一个简单的`dateadd()`并带走 1 和 2 天来获得完整的周末。

```
<cffunction name="getUSBankHolidays" access="public" output="false" returntype="struct" hint="general bank holidays for US">
  <cfargument name="iYear" default="#Year(now())#" />

    <cfset var currentYear = arguments.iYear />

    <!--- Static dates per year --->
    <cfset var strResult = 
      { NewYears1      = createDate(currentYear,12,30),
        NewYears2      = createDate(currentYear,12,31),
        NewYears3      = createDate(currentYear,1,1),
        NewYears4      = createDate(currentYear,1,2),
        Independence   = createDate(currentYear,7,4),
        Christmas1     = createDate(currentYear,12,22),
        Christmas2     = createDate(currentYear,12,23),
        Christmas3     = createDate(currentYear,12,24),
        Christmas4     = createDate(currentYear,12,25),
        Christmas5     = createDate(currentYear,12,26),
        Christmas6     = createDate(currentYear,12,27),
        Christmas7     = createDate(currentYear,12,28)
  } />

    <cfset strResult.SpringBreak          = createDate(currentYear,3,GetNthOccOfDayInMonth(3,1,3,currentYear)) />
    <cfset strResult.MemorialDay          = createDate(currentYear,5,(DaysInMonth(createDate(2012,5,1))) - (DayOfWeek(createDate(2012,5,DaysInMonth(createDate(2012,5,1)))) - 2)) />
    <cfset strResult.LaborDay             = createDate(currentYear,9,GetNthOccOfDayInMonth(1,2,9,currentYear)) />
    <cfset strResult.Thanksgiving         = createDate(currentYear,11,GetNthOccOfDayInMonth(4,6,11,currentYear)) />

    <cfreturn strResult />
</cffunction>

<cfdump var="#getUSBankHolidays()#">

<!-- This code will tell you if the date is holiday or not --->
<cfset Today = '2012-01-01' />
<cfdump var="#NOT arrayIsEmpty(structFindValue(getUSBankHolidays(),createDate(year(Today),month(Today),day(Today))))#"> 
```

您还需要来自 CFLib.org 的[UDF来获得一个月中一天的第 n 次出现。](http://cflib.org/udf/GetLastOccOfDayInMonth)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:55:19.307

数据库表将为您提供更多的灵活性。

我帮助维护的数据仓库有一个名为 period 的表，其中包含主键的日期。其他领域包括假期、一些财政年度的东西，以及对我们很重要的其他一些领域。其他表具有对表的外键引用。

除了使我们能够轻松生成必要的报告之外，该表还允许我们使用左连接来识别未发生事件的日期。类似的东西可能对您的情况有用。

就更新而言，我们手动进行。当像圣诞节这样的事情在周末降临时，我们等待被告知我们是周五还是周一休息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T18:58:48.723

在我看来，我会把它放在代码中。几年前我发现了这一点，并根据其许可协议使用了它。它是基于 Java 的，但我相信您可以根据需要更改为 Coldfusion。它目前列出了 66 个假期的代码，并且确保您可以对其进行一些操作来计算您需要的一周。

[http://mindprod.com/applet/holidays.html](http://mindprod.com/applet/holidays.html)

[http://mindprod.com/precis/holidays.txt](http://mindprod.com/precis/holidays.txt)

[https://wush.net/websvn/mindprod/listing.php?repname=mindprod&path=%2Fcom%2Fmindprod%2Fholidays%2F](https://wush.net/websvn/mindprod/listing.php?repname=mindprod&path=%2Fcom%2Fmindprod%2Fholidays%2F)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T16:37:01.753

这是我最终使用的，并且足够灵活，可以在将来进行修改，我可能仍会将其转换为带有 GUI 的数据库驱动系统，以添加未来的日期，但就目前而言，这很好用。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<title>Untitled Document</title> 
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" /> 
<script src="http://code.jquery.com/jquery-1.8.3.js"></script> 
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script> 
<link rel="stylesheet" href="http://jqueryui.com/resources/demos/style.css" /> 
<script> 
$(document).ready(function(){ 
  $( ".datepicker" ).datepicker({ 
    changeMonth: true, 
    changeYear: true 
  }); 
}); 
</script> 
</head> 

<body> 
<cfoutput> 
<form action="#cgi.SCRIPT_NAME#" method="post"> 
  Start Date: <input type="text" name="StartDate" class="datepicker" /> (mm-dd-yyyy)<br /> 
  End Date: <input type="text" name="EndDate" class="datepicker" /> (mm-dd-yyyy) <br /> 
  <input type="submit" value="Save Appointment" /> 
</form> 
<cfif structkeyexists(form,'startDate')> 
<cfdump var="#form#" expand="no"> 
<hr /> 
<cfscript> 
/** 
* Returns the day of the month(1-31) of an Nth Occurrence of a day (1-sunday,2-monday etc.)in a given month. * 
* @param NthOccurrence      A number representing the nth occurrence.1-5\. 
* @param TheDayOfWeek      A number representing the day of the week (1=Sunday, 2=Monday, etc.). 
* @param TheMonth      A number representing the Month (1=January, 2=February, etc.). 
* @param TheYear      The year. 
* @return Returns a numeric value. 
* @author Ken McCafferty (mccjdk@yahoo.com) 
* @version 1, August 28, 2001 
*/
function GetNthOccOfDayInMonth(NthOccurrence,TheDayOfWeek,TheMonth,TheYear) 
{
  Var TheDayInMonth=0; 
  if(TheDayOfWeek lt DayOfWeek(CreateDate(TheYear,TheMonth,1))){ 
    TheDayInMonth= 1 + NthOccurrence*7  + (TheDayOfWeek - DayOfWeek(CreateDate(TheYear,TheMonth,1))) MOD 7; 
  } 
  else { 
    TheDayInMonth= 1 + (NthOccurrence-1)*7  + (TheDayOfWeek - DayOfWeek(CreateDate(TheYear,TheMonth,1))) MOD 7; 
  } 
  //If the result is greater than days in month or less than 1, return -1
  if(TheDayInMonth gt DaysInMonth(CreateDate(TheYear,TheMonth,1)) OR   TheDayInMonth lt 1){ 
    return -1; 
  } 
  else { 
    return TheDayInMonth; 
  } 
} 
/** 
* Returns the date for Easter in a given year.
* Minor edits by Rob Brooks-Bilson (rbils@amkor.com).
* 
* @param TheYear      The year to get Easter for. 
* @return Returns a date object. 
* @author Ken McCafferty (rbils@amkor.commccjdk@yahoo.com) 
* @version 1, September 4, 2001 
*/
function GetEaster() {
  Var TheYear=iif(arraylen(arguments) gt 0,"arguments[1]", "Year(Now())"); 
  Var century = Int(TheYear/100);
  Var G = TheYear MOD 19;
  Var K = Int((century - 17)/25);
  Var I = (century - Int(century/4) - Int((century - K)/3) + 19*G + 15) MOD 30;
  Var H = I - Int((I/28))*(1 - Int((I/28))*Int((29/(I + 1)))*Int(((21 - G)/11)));
  Var J = (TheYear + Int(TheYear/4) + H + 2 - century + Int(century/4)) MOD 7;
  Var L = H - J;
  Var EasterMonth = 3 + Int((L + 40)/44);
  Var EasterDay = L + 28 - 31*Int((EasterMonth/4));
  return CreateDate(TheYear,EasterMonth,EasterDay);
}

function LastDayOfMonth(strMonth) {
  var strYear=Year(Now());
  if (ArrayLen(Arguments) gt 1)
    strYear=Arguments[2];
  return DateAdd("d", -1, DateAdd("m", 1, CreateDate(strYear, strMonth, 1))); 
}
</cfscript>

<cfset StartYear = listlast(StartDate,'/')>
<cfset EndYear = listlast(endDate,'/')>
<cfset HolidaySchedule = structnew()>
<cfloop index="currentYear" from="#dateformat(StartDate,'yyyy')#" to="#dateformat(EndDate,'yyyy')#" step="1"> 
<cfset val = StructInsert( HolidaySchedule, "Independence (#currentYear#)", createDate(currentYear,7,4) )/> 
<cfset val = StructInsert( HolidaySchedule, "New Year (#currentYear#)", createdate(currentYear,1,1) )/> 
<cfset val = StructInsert( HolidaySchedule, "Easter (#currentYear#)", GetEaster(currentYear) )/> 
<cfset val = StructInsert( HolidaySchedule, "Spring Break (#currentYear#)", createDate(currentYear,3,GetNthOccOfDayInMonth(2,2,3,currentYear)) )/>
<cfset val = StructInsert( HolidaySchedule, "Labor Day (#currentYear#)", createDate(currentYear,9,GetNthOccOfDayInMonth(1,2,9,currentYear)) )/>
<cfset val = StructInsert( HolidaySchedule, "Thanksgiving (#currentYear#)", createDate(currentYear,11,GetNthOccOfDayInMonth(4,6,11,currentYear)) )/>
<cfset val = StructInsert( HolidaySchedule, "Christmas Day (#currentYear#)", createdate(currentYear,12,25) )/>
</cfloop>
<cfdump var="#HolidaySchedule#" expand="no">
<cfset normalweek = 'true'>
<cfloop index="x" from="#startDate#" to="#endDate#" step="1">
Checking date: #dateformat(x,'yyyy-mm-dd')#<br />
<cfif NOT arrayIsEmpty(structFindValue(HolidaySchedule,createDate(year(x),month(x),day(x))))> 
<div style="background-color:##009900; color:##ffffff">#dateformat(x, 'mm/dd/yyyy')# is a holiday.</div> 
<cfset normalweek = 'false'>
</cfif>
</cfloop>

<cfif normalweek eq 'false'>
Remember to add on the Holiday Fee.
<cfelse>
No additional charges for this appointment.
</cfif>
</cfif>
</cfoutput>
</body>
</html> 
```

# facebook - 年度回顾 - Facebook 图表 / FQL

> ID：13866045
> 
> 赞同：1
> 
> 时间：2012-12-13T18:22:13.093
> 
> 标签：facebook, facebook-graph-api, facebook-fql

是否可以一次获得 FB 在 Year In Review（特定年份）中使用的所有信息？而不是通过调用各种 Graph API 调用并相应地过滤来合并。有没有直接的方法来完成对我任何朋友的年度回顾？

例如：

```
/me/yearInReview/2012/friendID ? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T22:56:02.950

正如 Igy 所说，从来没有任何文档表明这是一个 API 调用。这是不可能的

# ruby - 动态创建类方法

> ID：13866047
> 
> 赞同：3
> 
> 时间：2012-12-13T18:22:20.773
> 
> 标签：ruby, metaprogramming

我正在编写一个类方法来创建另一个类方法。在类方法的上下文中如何`class_eval`和操作似乎有些奇怪。`instance_eval`为了显示：

```
class Test1
  def self.add_foo
    self.class_eval do # does what it says on the tin
      define_method :foo do
        puts "bar"
      end
    end
  end
end

Test1.add_foo # creates new instance method, like I'd expect
Test1.new.foo # => "bar"

class Test2
  def self.add_foo
    self.instance_eval do # seems to do the same as "class_eval"
      define_method :foo do
        puts "bar"
      end
    end
  end
end

Test2.add_foo # what is happening here?!
Test2.foo # => NoMethodError
Test2.new.foo # => "bar"

class Test3
  def self.add_foo
    (class << self; self; end).instance_eval do # call explicitly on metaclass
      define_method :foo do
        puts "bar"
      end
    end
  end
end

Test3.add_foo # => creates new class method, as I'd expect
Test3.foo # => "bar" 
```

我的理解是类方法是在相关类的元类上定义的实例方法（`Test2`在这种情况下）。基于该逻辑，我希望类方法调用的接收者`add_foo`是元类。

*   `self`方法里面指的是什么`Test2.add_foo`？
*   为什么调用`instance_eval`这个接收器对象会创建一个实例方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T18:34:58.453

`instance_eval`和之间的主要区别在于`class_eval`它`instance_eval`在实例的上下文中`class_eval`工作，而在类的上下文中工作。我不确定你对 Rails 有多熟悉，但让我们看一个例子：

```
class Test3 < ActiveRecord::Base

end

t = Test3.first
t.class_eval { belongs_to :test_25 } #=> Defines a relationship to test_25 for this instance
t.test_25 #=> Method is defined (but fails because of how belongs_to works)

t2 = Test3.find(2)
t2.test_25 #=> NoMethodError

t.class.class_eval { belongs_to :another_test }
t.another_test #=> returns an instance of another_test (assuming relationship exists)
t2.another_test #=> same as t.another_test

t.class_eval { id } #=> NameError
t.instance_eval { id } #=> returns the id of the instance
t.instance_eval { belongs_to :your_mom } #=> NoMethodError 
```

发生这种情况是因为`belongs_to`实际上是在类主体的上下文中发生的方法调用，您不能从实例中调用它。当您尝试调用`id`with 时`class_eval`，它会失败，因为它`id`是在实例上定义的方法，而不是在类中。

使用这两种方法定义方法，`class_eval`并且`instance_eval`在针对实例调用时工作原理基本相同。他们将仅在调用它的对象的实例上定义一个方法。

```
t.class_eval do 
  def some_method
    puts "Hi!"
  end
end

t.instance_eval do
  def another_method
    puts "Hello!"
  end
end

t.some_method #=> "Hi!"
t.another_method #=> "Hello!"

t2.some_method #=> NoMethodError
t2.another_method #=> NoMethodError 
```

但是，在处理类时，它们有所不同。

```
t.class.class_eval do
  def meow
    puts "meow!"
  end
end

t.class.instance_eval do
  def bark
    puts "woof!"
  end
end

t.meow #=> meow!
t2.meow #=> meow!

t.bark #=> NoMethodError
t2.bark #=> NoMethodError 
```

那么树皮去哪儿了？它是在类的单例类的实例上定义的。我将在下面进行更多解释。但现在：

```
t.class.bark #=> woof!
Test3.bark #=> woof! 
```

因此，要回答您关于`self`类主体中所指内容的问题，您可以构建一个小测试：

```
a = class Test4
  def bar
    puts "Now, I'm a #{self.inspect}"
  end

  def self.baz
    puts "I'm a #{self.inspect}"
  end

  class << self
    def foo
      puts "I'm a #{self.inspect}"
    end

    def self.huh?
      puts "Hmmm? indeed"
    end

    instance_eval do
      define_method :razors do
        puts "Sounds painful"
      end
    end

    "But check this out, I'm a #{self.inspect}"
  end
end

puts Test4.foo #=> "I'm a Test4"
puts Test4.baz #=> "I'm a Test4"
puts Test4.new.bar #=> Now I'm a #<Test4:0x007fa473358cd8>
puts a #=> But check this out, I'm a #<Class:Test4> 
```

所以这里发生的情况是，在上面的第一个 puts 语句中，我们看到 inspect 告诉我们`self`在类方法体的上下文中是指类 Test4。在第二个`puts`中，我们看到了相同的东西，只是定义不同（使用`self.method_name`定义类方法的符号）。在第三个中，我们看到`self`指的是 Test4 的一个实例。最后一个有点有趣，因为我们看到的是一个被调用`self`的实例。那是因为当你定义一个类时，你就是在创建一个对象。Ruby 中的一切都是对象。这个对象实例称为元类或特征类或单例类。`Class``Test4`

您可以使用`class << self`成语访问特征类。当您在那里时，您实际上可以访问特征类的内部。您可以在 eigenclass 内部定义实例方法，这与 call 一致`self.method_name`。但是由于您在 eigenclass 的上下文中，您可以将方法附加到 eigenclass 的 eigenclass。

```
Test4.huh? #=> NoMethodError
Test4.singleton_class.huh? #=> Hmmm? indeed 
```

当您`instance_eval`在方法的上下文中调用时，您实际上是在调用`instance_eval`类本身，这意味着您在 Test4 上创建实例方法。我在特征类中调用 instance_eval 的位置怎么样？它在 Test4 的 eigenclass 实例上创建一个方法：

```
Test4.razors #=> Sounds painful 
```

希望这可以解决您的一些问题。我知道我在输入这个答案时学到了一些东西！

# android - Android文本字符串比较

> ID：13866054
> 
> 赞同：0
> 
> 时间：2012-12-13T18:23:05.827
> 
> 标签：android, string, simplecursoradapter

在自定义 SimpleCursorAdapter 中，我试图比较一个状态字符串，结果令人困惑。

我的字符串是这样从光标初始化的（我已经检查过`toast`它是否包含预期值）。

`String visitStatus = cursor.getString(cursor.getColumnIndex(CallData.COLUMN_VisitStatus));`

visitStatus 可以为 null、Open、Canceled 或 Complete。

如果我尝试将 visitStatus 与“引号中的任何字符串”进行比较，应用程序会因 NullPointerException 而崩溃。只有当我与 null 比较时，我才能得到任何东西——这对我没有用

```
if(visitStatus.equals(null)) // the app crashes with a NullPointerException
if(visitStatus == null) // doesn't crash
if(visitStatus != null) // doesn't crash
if(visitStatus == "Complete") // doesn't crash or do anything
if(visitStatus.equals("Complete")) // the app crashes with a NullPointerException. 
```

基本上，我可以与 null 进行比较，但只能以不应该工作的方式进行比较。我无法与“打开”或“完成”等实际字符串进行比较。

我对此有点抓狂，并且非常想念我的 C# 舒适区。这个特定的活动是 listfragments、contentproviders、customadapter、viewpagers、pagertitlestrips 和列表行 xml 模板的噩梦！

住手！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T18:27:13.067

这是因为`visitStatus`是`null`。每当您尝试访问其方法时，它都会崩溃。（*即：`visitString.equals()`、、`visitString.length()`等，都会崩溃。*）

但是，等式运算符 ( `==`) 支持`null`其两侧的参数。（所以，`if (null == null)`是一张有效的支票。）

你应该像这样检查：

```
if (visitStatus != null && visitStatus.equals("Complete")) {
    // ...
} 
```

或者，您可以执行支持`null`参数的“Yoda 语法”（向后检查）：

```
if ("Complete".equals(visitStatus)) {
    // ...
} 
```

另外，最后一点：您不能使用比较字符串内容`==`（如，您不能做`"a" == new String("a")`，也不能`visitString == "Complete"`）。有关详细说明，请参阅[此问答线程](https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:26:19.510

`String`应该使用比较`.equals()`

原因是`NullPointerException`因为`visitStatus`是`null`

# sql - SQLITE：无法解释的行为 - 比较适用于某些数字，而不适用于其他数字

> ID：13866059
> 
> 赞同：3
> 
> 时间：2012-12-13T18:23:17.947
> 
> 标签：sql, sqlite, subquery

我有一个返回正确结果的查询，除了一些值......不知道为什么。我正在使用 Chinook 数据库。

```
SELECT SUM(unitPrice)
FROM invoiceLine
WHERE invoiceId = 5 
```

这将返回 13,86。

```
SELECT invoiceId, total
FROM invoice 
WHERE invoiceId = 5 
```

这也返回 13,86。现在考虑下一个查询：

```
SELECT invoiceId, total
FROM invoice
WHERE total = (SELECT SUM(unitPrice)
            FROM invoiceLine
            WHERE invoiceId = 5) 
```

这返回......什么都没有！当我更改为*invoiceId = 1*时，我确实得到了与该金额匹配的所有结果。

为什么？？（我知道最后一个查询没有多大意义，它只是为了清楚地展示问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:54:19.227

如果您的发票总额对 2dp 是正确的，您也可以使用

```
SELECT invoiceId, total
FROM invoice
WHERE total = (SELECT Round(SUM(unitPrice),2)
            FROM invoiceLine
            WHERE invoiceId = 5) 
```

[SQL Fiddle 演示（带和不带轮）](http://www.sqlfiddle.com/#!5/9cd04/3/0)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:28:04.683

欢迎来到浮点运算的世界，所见即所得。

尝试类似：

```
SELECT invoiceId, total
FROM invoice i cross join
      (SELECT SUM(unitPrice) as total
            FROM invoiceLine
            WHERE invoiceId = 5
      ) i5
WHERE abs(i.total - i5.total) < 0.001 
```

# javascript - jQuery AJAX 200 状态，但神秘的语法错误

> ID：13866063
> 
> 赞同：3
> 
> 时间：2012-12-13T18:23:39.413
> 
> 标签：javascript, php, jquery, ajax, json

我在使用 jQuery AJAX 时返回了状态 200。但是，我也从某个地方收到语法错误。我像这样发布到 PHP：

```
function submit_order(orderInformation) {
    $.ajax({
        type: 'post',
        url: 'queries/submit_order.php?<?=time();?>',
        data: 'orderInformation=' + JSON.stringify(orderInformation),
        dataType: 'json',
        success: function (returnedData) {
            console.log(returnedData);
            $('#content_container').fadeOut(340, function () {
                var new_content = $('#content_container').clone(false);
                $('#content_container').remove();
                new_content.css('display', 'none');
                new_content.children().remove();

                new_content.appendTo('body');
                $('#content_container').vkTemplate('templates/confirm_template.tmpl?<?=time()?>', returnedData, function (el, data, context) {
                console.log('success'); 

                    $('#content_container').fadeIn(340);
                });
            });
        },
      error: function (xhr, ajaxOptions, thrownError) {
        console.log(xhr.status);
        console.log(thrownError);
      }
    });
} 
```

我的 PHP 代码非常简单：

```
$order_information = json_decode($json_str, true);

//go through the array and make an email out of it
//add a few elements to the array
//send the email

//send back a json string with the added elements
echo json_encode($order_information); 
```

然而我明白了：

![错误截图](../Images/e016fd445e03d90318eeb4c313ca8b48.png)

奇怪的是，如果我将 JSON 字符串复制粘贴`console.log(JSON.stringify(orderInformation))`到 PHP 页面中：

```
$json_str = '{"sector_0":{"file":[],"sector_info":{"sector_label":"NIO","purchase_order":"test","proof":false},"lines":{"line_0":{"description":"test","quantity":"2","productId":"1","addressId":"20","shipViaId":"1","notes":false}}}} '; 
```

一切正常。这是什么错误？在错误中看到的这`<`可能来自哪里？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T18:46:51.253

触发并记录的是您的错误处理程序：

*   xhr.status (200)
*   throwedError（语法错误）

请注意，即使服务器返回但响应是无效的 JSON ， `$.ajax`with也会触发错误处理程序。语法错误不在您的 JavaScript 代码中，而是在 JSON 中。确定来自哪里，并确保您的 PHP 脚本正在发送有效的 JSON。`dataType: json``200 OK``<`

提示：打开控制台，查看网络选项卡；所有 XHR 都与标题和正文一起记录在那里。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T18:32:37.353

200 - 是服务器的 Ok 响应`http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html`

您的响应服务器中有语法错误返回无效的 json

由于您的 PHP 代码接缝良好，因此肯定还有其他内容。语法错误或您的框架返回包装在 html 中的 json ...

使用适当的工具查看服务器返回的内容。（firefox 上的 firebug/chrome 上的开发者工具）

在您的图像中，您看到`0: "<"`这意味着返回的字符串以`<`- 开头，这意味着它是返回的 html。

看起来你使用铬。转到 chrome 中的“网络”选项卡，您应该能够看到对您的请求的原始响应。

所以这是一个php错误：

`$sector_index` 是不可迭代的。你能不能 var_dump 看看。这是什么？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-13T18:36:42.850

看起来`<?=time()?>`没有得到处理。在发布到 URL 以进行验证之前，请提醒 URL。

# c# - 如何用 moq 模拟 System.Xml.XmlWriter.WriteAttributeString()？

> ID：13866064
> 
> 赞同：6
> 
> 时间：2012-12-13T18:23:49.067
> 
> 标签：c#, mocking, nunit, moq, xmlwriter

当我在测试中运行以下代码时，

```
Mock<XmlWriter> mockXmlWriter = new Mock<System.Xml.XmlWriter>();
Language language = Language.GetLangauge(langId);
language.WriteXml(mockXmlWriter.Object);
mockXmlWriter.Verify(writer => writer.WriteAttributeString("ID", language.LanguageID.ToString())); 
```

Moq 可以理解地引发以下异常：`System.NotSupportedException : Invalid verify on a non-virtual (overridable in VB) member: writer => writer.WriteAttributeString("ID", .language.LanguageID.ToString())`.

愚蠢的抽象`XmlWriter`仍然有一些非抽象、非虚拟的方法，比如`WriteAttributeString()`:(

我寻找 an`XmlWriterBase`或 a `System.Xml.Abstractions`，就像我寻找`HttpContext`and Co. 一样，但什么也没找到 :(

我将如何克服这个问题，以便我可以测试我的`WriteXml`方法是否正在做它应该做的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T19:25:24.643

根据经验，模拟你不拥有的类是一个坏主意，因为你无法完全控制它们，这可能会导致问题（比如你的）。

我认为您可以在这里安全地使用 real `XmlWriter`，它将其输出写入 a`MemoryStream`并简单地断言流包含预期的 XML：

```
// arrange
MemoryStream underlyingStream = new MemoryStream();
XmlWriter xmlWriter = XmlWriter.Create(underlyingStream);
Language language = Language.GetLangauge(langId);

// act
language.WriteXml(xmlWriter);

// assert
underlyingStream.Position = 0;
using (StreamReader streamReader = new StreamReader(underlyingStream)
{
    string createdXml = streamReader.ReadToEnd();
    Assert.That(createdXml, Is.EqualTo("expectedXml"));
} 
```

断言部分可以很好地重构为辅助方法。最近写了一个处理 XML 创建的代码，我对它很感兴趣 - 起初，我的测试是基于模拟的，而且本质上，它们是生产代码的精确副本。幸运的是，在进行到一半时，我决定将整个事情重构为类似于我的示例中的样式，这确实很有帮助——测试现在变得不那么脆弱了，一切都变得更简单了。

# text - JavaFx 2.x：如何在图表上书写文字？

> ID：13866069
> 
> 赞同：2
> 
> 时间：2012-12-13T18:24:32.007
> 
> 标签：text, javafx-2

通过鼠标左键单击图表，我想通过创建文本区域矩形来编写文本，以便能够调整大小和移动。

任何帮助都非常感谢

**编辑**：嗨，sarcan，非常感谢您的友好回复。

我试过你的代码，它编译并绘制了一个带有注释的面积图，非常棒的工作！

我现在需要更改您的代码，以便能够在单击鼠标左键后使用键盘键入，而不是现在打印注释。

以下是您的完整代码

```
import javafx.application.Application;
import javafx.beans.InvalidationListener;
import javafx.beans.Observable;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.event.EventHandler;
import javafx.scene.Node;
import javafx.scene.Scene;
import javafx.scene.chart.AreaChart;
import javafx.scene.chart.Axis;
import javafx.scene.chart.NumberAxis;
import javafx.scene.chart.XYChart;
import javafx.scene.chart.XYChart.Data;
import javafx.scene.chart.XYChart.Series;
import javafx.scene.control.Label;
import javafx.scene.input.MouseButton;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.Pane;
import javafx.scene.layout.StackPane;
import javafx.scene.paint.Color;
import javafx.scene.shape.Circle;
import javafx.stage.Stage;

/**
*
* @author sarcan
*/
public class SampleApp extends Application {

public class SampleChart extends AreaChart<Number, Number> {
public SampleChart() {
    super(new NumberAxis(), new NumberAxis());

    getXAxis().setLabel("X");
    getYAxis().setLabel("Y");

    final Series<Number, Number> data = new Series<Number, Number>();
    data.setName("Dummy data");
    data.getData().addAll(
            new Data<Number, Number>(0,4),
            new Data<Number, Number>(1,5),
            new Data<Number, Number>(2,6),
            new Data<Number, Number>(3,5),
            new Data<Number, Number>(4,5),
            new Data<Number, Number>(5,7),
            new Data<Number, Number>(6,8),
            new Data<Number, Number>(7,9),
            new Data<Number, Number>(8,7)
    );

    getData().add(data);
}
}

public class ChartAnnotationNode {
private final Node _node;
private double _x;
private double _y;

public ChartAnnotationNode(final Node node, final double x, final double y) {
    _node = node;
    _x = x;
    _y = y;
}

public Node getNode() {
    return _node;
}

public double getX() {
    return _x;
}

public double getY() {
    return _y;
}

public void setX(final double x) {
    _x = x;
}

public void setY(final double y) {
    _y = y;
}
}

public class ChartAnnotationOverlay extends Pane {
private ObservableList<ChartAnnotationNode> _annotationNodes;
private XYChart<Number, Number> _chart;

public ChartAnnotationOverlay(final XYChart<Number, Number> chart) {
    _chart = chart;

    /* Create a list to hold your annotations */
    _annotationNodes = FXCollections.observableArrayList();

    /* This will be our update listener, to be invoked whenever the chart changes or annotations are added */
    final InvalidationListener listener = new InvalidationListener() {
        @Override
        public void invalidated(final Observable observable) {
            update();
        }
    };
    _chart.needsLayoutProperty().addListener(listener);
    _annotationNodes.addListener(listener);

    /* Add new annotations by shift-clicking */
    setOnMouseClicked(new EventHandler<MouseEvent>() {
        @Override
        public void handle(final MouseEvent mouseEvent) {
            if (mouseEvent.getButton() == MouseButton.PRIMARY  && mouseEvent.isShiftDown())
                addAnnotation(mouseEvent.getX(), mouseEvent.getY());
        }
    });
}

/**
 * Invoked whenever the chart changes or annotations are added. This basically does a relayout of the annotation nodes.
 */
private void update(){
    getChildren().clear();

    final Axis<Number> xAxis = _chart.getXAxis();
    final Axis<Number> yAxis = _chart.getYAxis();

    /* For each annotation, add a circle indicating the position and the custom node right next to it */
    for (ChartAnnotationNode annotation : _annotationNodes) {
        final double x = xAxis.localToParent(xAxis.getDisplayPosition(annotation.getX()), 0).getX() + _chart.getPadding().getLeft();
        final double y = yAxis.localToParent(0,yAxis.getDisplayPosition(annotation.getY())).getY() + _chart.getPadding().getTop();

        final Circle indicator = new Circle(3);
        indicator.setStroke(Color.BLUEVIOLET);
        indicator.setCenterX(x);
        indicator.setCenterY(y);

        getChildren().add(indicator);

        final Node node = annotation.getNode();
        getChildren().add(node);
        node.relocate(x + 10, y - node.prefHeight(Integer.MAX_VALUE) / 2);
        node.autosize();
    }
}

/**
 * Add a new annotation for the given display coordinate.
 */
private void addAnnotation(final double displayX, final double displayY){
    final Axis<Number> xAxis = _chart.getXAxis();
    final Axis<Number> yAxis = _chart.getYAxis();

    final double x = (xAxis.getValueForDisplay(xAxis.parentToLocal(displayX, 0).getX() - _chart.getPadding().getLeft())).doubleValue();
    final double y = (yAxis.getValueForDisplay(yAxis.parentToLocal(0, displayY).getY() - _chart.getPadding().getTop())).doubleValue();

    if (xAxis.isValueOnAxis(x) && yAxis.isValueOnAxis(y))
        _annotationNodes.add(new ChartAnnotationNode(new Label("Annotation "+System.currentTimeMillis()), x, y));
}
}

@Override
public void start(final Stage stage) throws Exception {
    final SampleChart chart = new SampleChart();

    final ChartAnnotationOverlay overlay = new ChartAnnotationOverlay(chart);

    final StackPane stackPane = new StackPane();
    stackPane.getChildren().addAll(chart, overlay);

    final Scene scene = new Scene(stackPane);
    stage.setScene(scene);
    stage.setWidth(800);
    stage.setHeight(600);
    stage.show();
}

public static void main(String[] args) {
    Application.launch(args);
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-14T12:29:31.577

1) 我首先将图表放在 StackPane 中。在图表顶部，我会放置一个锚窗格，在鼠标单击时保存文本字段。

2）当用户单击图表时，我将使用图表的轴来确定单击是否在绘图区域内以及单击了哪个“值”（使用`NumberAxis#getValueForDisplay()`.

3) 然后我会在图表中添加侦听器，以便收到任何更改（内容、宽度、高度...）的通知，并调整文本区域的位置以始终显示接近相同的值。

调整大小/直截了当，如果这给您带来任何麻烦，请告诉我们。

编辑：根据要求，这里是一些示例代码。下面的代码提供了一个简化的示例，允许您通过按住 shift 单击来将文本节点（我将它们称为注释）添加到图表中。拖动或编辑注释很简单，但我想保持示例简洁。

让我们从定义一个示例图表开始：

```
public class SampleChart extends AreaChart<Number, Number> {
    public SampleChart() {
        super(new NumberAxis(), new NumberAxis());

        getXAxis().setLabel("X");
        getYAxis().setLabel("Y");

        final Series<Number, Number> data = new Series<Number, Number>();
        data.setName("Dummy data");
        data.getData().addAll(
                new Data<Number, Number>(0,4),
                new Data<Number, Number>(1,5),
                new Data<Number, Number>(2,6),
                new Data<Number, Number>(3,5),
                new Data<Number, Number>(4,5),
                new Data<Number, Number>(5,7),
                new Data<Number, Number>(6,8),
                new Data<Number, Number>(7,9),
                new Data<Number, Number>(8,7)
        );

        getData().add(data);
    }
} 
```

到目前为止没有什么特别的，我只是用一些随机的模拟数据创建了一个面积图。

对于文本节点（或注释），我创建了一个简单的 POJO，其中包含带注释的 X/Y 值（不是显示位置）并采用要呈现的自定义节点：

```
public class ChartAnnotationNode {
    private final Node _node;
    private double _x;
    private double _y;

    public ChartAnnotationNode(final Node node, final double x, final double y) {
        _node = node;
        _x = x;
        _y = y;
    }

    public Node getNode() {
        return _node;
    }

    public double getX() {
        return _x;
    }

    public double getY() {
        return _y;
    }

    public void setX(final double x) {
        _x = x;
    }

    public void setY(final double y) {
        _y = y;
    }
} 
```

有趣的东西发生在我称之为叠加层的地方：一个透明面板，将放置在图表上方。请注意，我没有按照最初的建议选择 AnchorPane，尽管那样也可以。此外，这种实现并不是最有效的方法，但我想让示例保持简单。

```
public class ChartAnnotationOverlay extends Pane {
    private ObservableList<ChartAnnotationNode> _annotationNodes;
    private XYChart<Number, Number> _chart;

    public ChartAnnotationOverlay(final XYChart<Number, Number> chart) {
        _chart = chart;

        /* Create a list to hold your annotations */
        _annotationNodes = FXCollections.observableArrayList();

        /* This will be our update listener, to be invoked whenever the chart changes or annotations are added */
        final InvalidationListener listener = new InvalidationListener() {
            @Override
            public void invalidated(final Observable observable) {
                update();
            }
        };
        _chart.needsLayoutProperty().addListener(listener);
        _annotationNodes.addListener(listener);

        /* Add new annotations by shift-clicking */
        setOnMouseClicked(new EventHandler<MouseEvent>() {
            @Override
            public void handle(final MouseEvent mouseEvent) {
                if (mouseEvent.getButton() == MouseButton.PRIMARY  && mouseEvent.isShiftDown())
                    addAnnotation(mouseEvent.getX(), mouseEvent.getY());
            }
        });
    }

    /**
     * Invoked whenever the chart changes or annotations are added. This basically does a relayout of the annotation nodes.
     */
    private void update(){
        getChildren().clear();

        final Axis<Number> xAxis = _chart.getXAxis();
        final Axis<Number> yAxis = _chart.getYAxis();

        /* For each annotation, add a circle indicating the position and the custom node right next to it */
        for (ChartAnnotationNode annotation : _annotationNodes) {
            final double x = xAxis.localToParent(xAxis.getDisplayPosition(annotation.getX()), 0).getX() + _chart.getPadding().getLeft();
            final double y = yAxis.localToParent(0,yAxis.getDisplayPosition(annotation.getY())).getY() + _chart.getPadding().getTop();

            final Circle indicator = new Circle(3);
            indicator.setStroke(Color.BLUEVIOLET);
            indicator.setCenterX(x);
            indicator.setCenterY(y);

            getChildren().add(indicator);

            final Node node = annotation.getNode();
            getChildren().add(node);
            node.relocate(x + 10, y - node.prefHeight(Integer.MAX_VALUE) / 2);
            node.autosize();
        }
    }

    /**
     * Add a new annotation for the given display coordinate.
     */
    private void addAnnotation(final double displayX, final double displayY){
        final Axis<Number> xAxis = _chart.getXAxis();
        final Axis<Number> yAxis = _chart.getYAxis();

        final double x = (xAxis.getValueForDisplay(xAxis.parentToLocal(displayX, 0).getX() - _chart.getPadding().getLeft())).doubleValue();
        final double y = (yAxis.getValueForDisplay(yAxis.parentToLocal(0, displayY).getY() - _chart.getPadding().getTop())).doubleValue();

        if (xAxis.isValueOnAxis(x) && yAxis.isValueOnAxis(y))
            _annotationNodes.add(new ChartAnnotationNode(new Label("Annotation "+System.currentTimeMillis()), x, y));
    }
} 
```

棘手的部分是视图和显示之间的坐标转换。要获取给定值的显示位置，您可以调用`Axis#getDisplayPosition(...)`，但返回的坐标将位于轴的坐标空间中。调用将其`Axis#localToParent`转换为图表的坐标空间。通常，您希望能够只使用这些坐标，但图表的默认填充为 5 像素，由于某种原因无法正确翻译。

这是一个将所有内容放在一起的小型测试应用程序：

```
public class SampleApp extends Application {
    @Override
    public void start(final Stage stage) throws Exception {
        final SampleChart chart = new SampleChart();

        final ChartAnnotationOverlay overlay = new ChartAnnotationOverlay(chart);

        final StackPane stackPane = new StackPane();
        stackPane.getChildren().addAll(chart, overlay);

        final Scene scene = new Scene(stackPane);
        stage.setScene(scene);
        stage.setWidth(800);
        stage.setHeight(600);
        stage.show();
    }

    public static void main(String[] args) {
        Application.launch(args);
    }
} 
```

现在您已经有了覆盖代码 + 翻译坐标背后的想法，拖动节点也应该很简单。当注释的节点被拖动时，获取其显示位置，添加拖动增量，将其转换为值并将其应用于注释实例。

希望这能让事情更清楚一些。

# c# - 用于管理图像/文件的 ASP.NET 处理程序

> ID：13866071
> 
> 赞同：0
> 
> 时间：2012-12-13T18:24:41.417
> 
> 标签：c#, asp.net, .net

我需要执行以下操作：

1.  在页面上显示图像
2.  显示打开文档的文档（PDF、DOC 等）的链接
3.  上传图片

我在后端具有以下签名的功能：

```
public byte[] GetFile(string fileName)   //For both documents and images

public void AddFile(string fileName, byte[] data)  //For both documents and images 
```

我的问题是，我可以编写一个可以获取图像/文档并上传图像/文档的处理程序，以便我可以通过执行以下操作在我的客户端中使用它：

```
<asp:Image runat="server" ImageUrl="~/Image.ashx?FileName=myFileName" /> 
```

处理程序反过来会调用`GetFile`and`AddFile`方法。

这可能适用于显示图像。显示文件和上传图像/文件怎么样？

此外，与处理程序相关的安全性如何？恶意用户可以使用它吗？

# windows - Windows 8 应用商店计算器应用程序中的逗号

> ID：13866072
> 
> 赞同：0
> 
> 时间：2012-12-13T18:24:42.990
> 
> 标签：windows, vb.net, calculator

我一直在网上寻找可以让我的计算器包含逗号的代码。我找到了一些代码，但 Visual Studio 2012 不允许我使用它。我也去过 MSDN，它谈到使用“N”以便应用程序理解字符是数字并正确格式化它们，但我什至在哪里放置该代码？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:28:07.967

像这样的东西...

```
Dim Value = 1234567.0123
Dim DisplayText = String.Format("{0:#,###,##0.#####}", Value) 
```

`DisplayText`现在包含字符串`1,234,567.0123`

# java - 自动音量控制播放响亮的声音

> ID：13866076
> 
> 赞同：1
> 
> 时间：2012-12-13T18:25:11.113
> 
> 标签：java, android, audio, javasound

我正在开发的应用程序将设备麦克风的声音输出实时播放到设备耳机。应用程序需要在声音太大时自动降低声级，并在声音太低时放大声级。

```
 AudioTrack track = null;
    track.setStereoVolume(2.0f, 2.0f); 
```

`setStereoVolume()`可以改变音量。我可以在不动态使用 FFT 的情况下从原始 PCM 值和 inc/dec 音频音量中检查最大幅度。这是正确的方法吗？为了避免使用滞后，`setStreoVolume()`当声音太大并且当它太安静时将它们乘以 2？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:42:53.670

在某些点将样本减半/加倍可能会导致输出信号中非常明显的下降/尖峰。

你想要的是一个[动态范围压缩器](http://en.wikipedia.org/wiki/Dynamic_range_compression)。手机很可能已经有一个在平台上运行的手机。但如果您对它的性能不满意，您可以添加自己的软件 DRC。基本思想是，当信号达到某个阈值时，您会逐渐衰减信号。由于这会降低最大信号电平（衰减响亮的部分），它允许您添加所谓的补偿增益，这将增加整体信号电平（从而使安静的部分更响亮）。

# python - 转换列表中项目的更有效方法

> ID：13866079
> 
> 赞同：1
> 
> 时间：2012-12-13T18:25:33.803
> 
> 标签：python, list

我有一个字符串列表，我需要组合一些项目。要组合的每个项目都按连续顺序列出，如下所示：

```
info = [u'1', u'be/4', u'root', u'0.00', u'B', u'0.00', u'B', u'0.00', u'%', u'0.00', u'%', u'init']

info[3] = info[3] + info[4]

info.pop(4)

info[4] = info[4] + info[5]

info.pop(5)

info[5] = info[5] + info[6]

info.pop(6)

info[6] = info[6] + info[7]

info.pop(7)

>>> info
[u'1', u'be/4', u'root', u'0.00B', u'0.00B', u'0.00%', u'0.00%', u'init'] 
```

最后一行是所需的输出，但是，我想获得一些更好的方法，而不需要所有的弹出和分配？

更新：哇！这些都很棒，我想对它们进行测试和计时；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:36:52.537

一种可能的解决方案

```
>>> info[:3] + [''.join(e) for e in zip(info[3::2],info[4::2])] + info[-1:]
[u'1', u'be/4', u'root', u'0.00B', u'0.00B', u'0.00%', u'0.00%', u'init'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:37:24.687

解决此类问题的一个好方法是使用生成器函数，即您正在处理一系列项目并希望创建一个新序列。我认为这个会起作用：

```
def combine_items(seq):
    it = iter(seq) # get an iterator

    yield next(it) # yield the first three items unmodified
    yield next(it)
    yield next(it)

    while True: # run until there's an exception
        first = next(it) # grab the first item in a pair
        try:
            second = next(it) # grab the second
            yield first + second # yield the combined pair
        except StopIteration: # if the second was off the end of the sequence
            yield first  # yield the first item unmodified
            raise # and reraise the exception to exit 
```

循环一直运行，`while`直到序列被完全消耗。当没有更多项目时，`next`引发`StopIteration`我们将传播出去的 a，因为这是生成器完成的信号。

要在列表中获取输出，只需在构造函数中包装对生成器的调用`list`：

```
>>> list(combine_items(info))
['1', 'be/4', 'root', '0.00B', '0.00B', '0.00%', '0.00%', 'init'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T18:35:01.823

好吧，一个相当简单的方法就是：

```
>>> lst[:] = lst[:3] + [lst[3] + lst[4], lst[5] + lst[6], lst[7] + lst[8], lst[9] + lst[10], lst[11]] + [lst[11]]
[u'1', u'be/4', u'root', u'0.00B', u'0.00B', u'0.00%', u'0.00%', u'init'] 
```

这只是从现有列表中构造一个新列表，然后成为`lst`该新列表。

可以编写一些处理配对的时髦函数......

为了更清楚，您可以将代码格式化为，

```
lst[:] = (
    lst[:3] +
    [
        lst[3] + lst[4],
        lst[5] + lst[6],
        lst[7] + lst[8],
        lst[9] + lst[10]
    ] +
    [lst[11]]
) 
```

这使得切片、配对和结尾的位置相当清楚......

移动单个字符字段但未经过广泛测试的另一个选项：

```
>>> text = '\t'.join(lst)
>>> re.sub('\t(.)\t', r'\1\t', text).split('\t') # or use ([B%]) instead maybe
[u'1', u'be/4', u'root', u'0.00B', u'0.00B', u'0.00%', u'0.00%', u'init'] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T18:36:33.050

怎么样

```
>>> to_join = iter(info[3:-1])

>>> info[:3] + [x + next(to_join) for x in to_join] + info[-1:]
[u'1', u'be/4', u'root', u'0.00B', u'0.00B', u'0.00%', u'0.00%', u'init'] 
```

# php - CodeIgniter 本地时区到 GMT

> ID：13866080
> 
> 赞同：0
> 
> 时间：2012-12-13T18:25:44.730
> 
> 标签：php, codeigniter, timezone, local, gmt

我需要有关 codeigniter 中多时区网站的帮助。

配置.php：

```
$config['time_reference'] = 'gmt';
date_default_timezone_set('UTC'); 
```

现在，当用户想要查看事件（网站用于事件）时，它会使用**gmt_to_local()**函数显示他的时区的日期，这很好用..

现在的问题是当用户想要添加新事件时，他选择日期和时间，现在它被转换为时间戳：

```
strtotime($event_date); 
```

问题是他在他的时区为事件选择日期和时间，现在我需要将其转换为 gmt，并保存到 db。

例如，如果用户在 UP2(+2:00) 并且他设置**12-25-2012 22:30:00**它将被转换为时间戳并保存在数据库中，但不正确，它应该减去 2:00 并保存该时间戳到 db 作为**12-25-2012 20:30:00**的时间戳（这将转换为 gmt）

希望你能理解。

有什么解决办法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:39:15.517

在您的事件表单中，您应该向服务器发送一个隐藏的输入女巫，其中将包含客户端的时区偏移量。您可以通过 Javascript 的 Date.getTimezoneOffset() 方法获取它（它为您提供 UTC 和用户本地时间之间的分钟偏移量）。

如果您不能这样做，您可以将用户的本地时区保存到数据库中或在您的活动表单中询问。

然后，在您的 INSERT 或 UPDATE 查询中，您可以使用 DATE_ADD('2012-12-13 19:41:00', [user offset] MINUTE) 来转换时间戳。您也可以在提交表单时在 php 或客户端执行此操作...

例如在 PHP 中：

```
strtotime($event_date); 
```

为您提供日期的 Unix 时间戳（因此，以秒为单位）。要将其转换为另一个时区，根据您使用 javascript 方法以分钟为单位的偏移量，您可以执行以下操作：

```
$dbTimestamp = strtotime($event_date) + $_POST['offsetInMinutes']/60; 
```

如果您以这种形式获得偏移量：“+2:00”或“-6:00”，则可以使用正则表达式以小时为单位获得偏移量：

```
preg_match('/(.*)\:00/', '+2:00', $match) 
```

将 '+2' 设置为 $match[1]

# fiddler - Fiddler - 使用颜色语法突出显示和格式化轻松复制 Web 服务 XML 请求/响应

> ID：13866083
> 
> 赞同：1
> 
> 时间：2012-12-13T18:25:55.473
> 
> 标签：fiddler

我使用 Fiddler 调试 web 服务，当我需要通过电子邮件共享特定的 web 服务请求和响应时，我会将请求/响应复制到 Visual Studio 中以进行颜色语法突出显示和格式化，然后将其粘贴到 Outlook 电子邮件客户端。

是否有一个插件可以为我进行颜色语法突出显示和格式化，以便我可以跳过在 Visual Studio 中粘贴请求/响应的步骤？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T17:16:04.247

获取**SyntaxView**检查器。这是此处列出的第一个扩展：[http](http://www.fiddler2.com/Fiddler2/extensions.asp) ://www.fiddler2.com/Fiddler2/extensions.asp 。

# time - VBA在excel中发送电子邮件

> ID：13866084
> 
> 赞同：0
> 
> 时间：2012-12-13T18:25:58.237
> 
> 标签：time, copy, copy-paste

我的部分代码将信息从 Excell 中的一个工作表复制到另一个工作表。每次我运行这个 cood 时，它都会给我最后一行代码（activeSheet.Paste）的运行时错误“1004”。有谁知道如何修理它？

```
Sub CopyData()

    ActiveWindow.SmallScroll Down:=-9
    Sheets("sponsor & contributions 2012").Select
    Range("A1:K93").Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets("remaining payments").Select
    Selection.PasteSpecial Paste:=xlPasteFormats
    ActiveWindow.SmallScroll Down:=-12
    Range("A1:K93").Select
    ActiveSheet.Paste

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-06T14:54:04.627

与模拟用户“复制+粘贴”相比，将目标范围的值设置为源范围的值更容易、更快速、更可靠。例如

```
Public Sub Copy()
    Sheet2.Range("A1:K93").Value = Sheet1.Range("A1:K93").Value
End Sub 
```

如果无法查看电子表格，确定 1004 错误的原因可能非常困难，因此我肯定会推荐上述方法

# r - 如何排除在 R 中不重复 X 次的情况？

> ID：13866086
> 
> 赞同：1
> 
> 时间：2012-12-13T18:26:02.927
> 
> 标签：r, database-design

我有一个长格式的不平衡纵向数据。我想排除所有不包含完整信息的案例。我的意思是所有不重复 8 次的案例。有人可以帮我找到解决方案吗？

下面是一个示例：我有三个主题 {A、B 和 C}。我有 8 个关于 A 和 B 的信息，但只有 2 个关于 C 的信息。如何根据少于 8 次重复测量的信息删除存在 C 的行？

```
temp = scan()
A 1 1 1 0
A 1 1 0 1
A 1 0 0 0
A 1 1 1 1
A 0 1 0 0
A 1 1 1 0
A 1 1 0 1
A 1 0 0 0
B 1 1 1 0
B 1 1 0 1
B 1 0 0 0
B 1 1 1 1
B 0 1 0 0
B 1 1 1 0
B 1 1 0 1
B 1 0 0 0
C 1 1 1 1
C 0 1 0 0 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T18:37:46.567

假设您的变量名称是`V1`, `V2`... 等等，这是一种方法：

```
temp[temp$V1 %in% names(which(table(temp$V1) == 8)), ] 
```

`table(temp$V1) == 8`匹配`V1`列中恰好有 8 个案例的值。该`names(which(...`部分创建了一个我们可以使用匹配的基本字符向量`%in%`。

还有一个：

```
temp[ave(as.character(temp$V1), temp$V1, FUN = length) == "8", ] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T18:40:19.550

这是另一种方法：

```
temp <- read.table(text="
A 1 1 1 0
A 1 1 0 1
A 1 0 0 0
A 1 1 1 1
A 0 1 0 0
A 1 1 1 0
A 1 1 0 1
A 1 0 0 0
B 1 1 1 0
B 1 1 0 1
B 1 0 0 0
B 1 1 1 1
B 0 1 0 0
B 1 1 1 0
B 1 1 0 1
B 1 0 0 0
C 1 1 1 1
C 0 1 0 0", header=FALSE)

do.call(rbind, 
        Filter(function(subgroup) nrow(subgroup) == 8, 
               split(temp, temp[[1]]))) 
```

`split``data.frame`按第一列分解，然后`Filter`删除没有 8 行的子组。最后，`do.call(rbind, ...)`将剩余的子组折叠回单个`data.frame`.

如果 的第一列`temp`是`character`（而不是`factor`，您可以使用 验证`str(temp)`）并且行按子组排序，您还可以执行以下操作：

```
with(rle(temp[[1]]), temp[rep(lengths==8, times=lengths), ]) 
```

# c++ - 在 VS2012 中使用 C++11 条件变量

> ID：13866088
> 
> 赞同：6
> 
> 时间：2012-12-13T18:26:07.493
> 
> 标签：c++, multithreading, c++11, visual-studio-2012, condition-variable

在一个简单的 VS2012 控制台应用程序中，我无法让代码可靠地工作，该应用程序由使用 C++11 条件变量的生产者和消费者组成。我的目标是生成一个小的可靠程序（用作更复杂程序的基础），它使用 3 个参数 wait_for 方法或我在这些网站上收集的代码中的 wait_until 方法：

[条件](http://en.cppreference.com/w/cpp/thread/condition_variable)变量： [wait_for](http://en.cppreference.com/w/cpp/thread/condition_variable/wait_for)， [wait_until](http://en.cppreference.com/w/cpp/thread/condition_variable/wait_until)

我想将 3 个参数 wait_for 与如下所示的谓词一起使用，但它需要使用类成员变量才能在以后对我最有用。仅运行大约一分钟后，我收到“访问冲突写入位置 0x_ ***_*** ”或“无效参数已传递给服务或函数”作为错误。

stable_clock 和 2 参数 wait_until 是否足以替换 3 参数 wait_for？我也试过这个没有成功。

有人可以展示如何让下面的代码无限期地运行而没有错误或奇怪的行为，无论是从夏令时更改挂钟时间还是互联网时间同步？

指向可靠示例代码的链接可能同样有帮助。

```
// ConditionVariable.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"

#include <condition_variable>
#include <mutex>
#include <thread>
#include <iostream>
#include <queue>
#include <chrono>
#include <atomic>

#define TEST1

std::atomic<int> 
//int 
    qcount = 0; //= ATOMIC_VAR_INIT(0);

int _tmain(int argc, _TCHAR* argv[])
{
    std::queue<int> produced_nums;
    std::mutex m;
    std::condition_variable cond_var;
    bool notified = false;
    unsigned int count = 0;

    std::thread producer([&]() {
        int i = 0;
        while (1) {
            std::this_thread::sleep_for(std::chrono::microseconds(1500));
            std::unique_lock<std::mutex> lock(m);
            produced_nums.push(i);
            notified = true;
            qcount = produced_nums.size();
            cond_var.notify_one();
            i++;
        }   
        cond_var.notify_one();
    }); 

    std::thread consumer([&]() {
        std::unique_lock<std::mutex> lock(m);
        while (1) {
#ifdef TEST1
            // Version 1
            if (cond_var.wait_for(
                lock,
                std::chrono::microseconds(1000),
                [&]()->bool { return qcount != 0; }))
            {
                if ((count++ % 1000) == 0)
                    std::cout << "consuming " << produced_nums.front    () << '\n';
                produced_nums.pop();
                qcount = produced_nums.size();
                notified = false;
            }
#else
            // Version 2
            std::chrono::steady_clock::time_point timeout1 =
                std::chrono::steady_clock::now() +
                //std::chrono::system_clock::now() +
                std::chrono::milliseconds(1);

            while (qcount == 0)//(!notified)
            {
                if (cond_var.wait_until(lock, timeout1) == std::cv_status::timeout)
                    break;
            }

            if (qcount > 0)
            {
                if ((count++ % 1000) == 0)
                std::cout << "consuming " << produced_nums.front() << '\n';
                produced_nums.pop();
                qcount = produced_nums.size();
                notified = false;
            }
#endif
        }
    });

    while (1);
    return 0;
} 
```

Visual Studio Desktop Express 安装了 1 个重要更新，而 Windows Update 没有其他重要更新。我正在使用 Windows 7 32 位。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-24T02:39:58.870

可悲的是，这实际上是 VS2012 的 condition_variable 实现中的一个错误，并且不会修补此修复程序。您必须在 VS2013 发布时升级到它。

看：

[http://connect.microsoft.com/VisualStudio/feedback/details/762560](http://connect.microsoft.com/VisualStudio/feedback/details/762560)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T23:46:44.903

首先，在使用`condition_variable`s 时，我个人更喜欢[`AutoResetEvent`](http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent.aspx)C# 中的一些包装类：

```
struct AutoResetEvent
{
    typedef std::unique_lock<std::mutex> Lock;

    AutoResetEvent(bool state = false) :
        state(state)
    { }

    void Set()
    {
        auto lock = AcquireLock();
        state = true;
        variable.notify_one();
    }

    void Reset()
    {
        auto lock = AcquireLock();
        state = false;
    }

    void Wait(Lock& lock)
    {
        variable.wait(lock, [this] () { return this->state; });
        state = false;
    }

    void Wait()
    {
        auto lock = AcquireLock();
        Wait(lock);
    }

    Lock AcquireLock()
    {
        return Lock(mutex);
    }
private:

    bool state;
    std::condition_variable variable;
    std::mutex mutex;
}; 
```

这可能与 C# 类型的行为不同，或者可能没有应有的效率，但它可以为我完成任务。

其次，当我需要实现生产/消费习惯时，我会尝试使用并发队列实现（例如[tbb queue](http://threadingbuildingblocks.org/docs/help/reference/containers_overview/concurrent_queue_cls.htm)）或为自己编写一个。但是您还应该考虑使用[Active Object Pattern](http://channel9.msdn.com/Shows/Going+Deep/C-and-Beyond-2012-Herb-Sutter-Concurrency-and-Parallelism)来解决问题。但是对于简单的解决方案，我们可以使用这个：

```
template<typename T>
struct ProductionQueue
{
    ProductionQueue()
    { }

    void Enqueue(const T& value)
    {
        {
            auto lock = event.AcquireLock();
            q.push(value);
        }
        event.Set();
    }

    std::size_t GetCount()
    {
        auto lock = event.AcquireLock();

        return q.size();
    }

    T Dequeue()
    {
        auto lock = event.AcquireLock();
        event.Wait(lock);

        T value = q.front();
        q.pop();

        return value;
    }

private:
    AutoResetEvent event;
    std::queue<T> q;
}; 
```

这个类有一些异常安全问题并且错过了方法的常量性，但就像我说的，对于一个简单的解决方案，这应该适合。

因此，您修改后的代码如下所示：

```
int main(int argc, char* argv[])
{
    ProductionQueue<int> produced_nums;
    unsigned int count = 0;

    std::thread producer([&]() {
        int i = 0;
        while (1) {
            std::this_thread::sleep_for(std::chrono::microseconds(1500));
            produced_nums.Enqueue(i);
            qcount = produced_nums.GetCount();
            i++;
        }
    }); 

    std::thread consumer([&]() {
        while (1) {
            int item = produced_nums.Dequeue();
            {
                if ((count++ % 1000) == 0)
                    std::cout << "consuming " << item << '\n';
                qcount = produced_nums.GetCount();
            }
        }
    });

    producer.join();
    consumer.join();

    return 0;
} 
```

# solr - 正确的记录访问实现

> ID：13866089
> 
> 赞同：8
> 
> 时间：2012-12-13T18:26:08.453
> 
> 标签：solr, lucene

我正在研究索引引擎，特别是 Apache Lucene Solr。我们愿意将它用于我们的搜索，但我们的框架搜索解决的问题之一是行级访问。

Solr 不提供开箱即用的记录访问：

> <...> Solr 不关心文档级别或通信级别的安全性。

在关于文档级安全性的部分：[http ://wiki.apache.org/solr/SolrSecurity#Document_Level_Security](http://wiki.apache.org/solr/SolrSecurity#Document_Level_Security)

很少有建议 - 要么使用 Manifold CF（它是高度无证的，而且似乎处于非常预测试阶段）或编写你自己的请求处理程序/搜索组件（该部分被标记为存根） - 我猜后者会有对性能的影响更大。

所以我认为在这个领域做的并不多。

在最近发布的 Solr 4.0 版本中，他们引入了连接两个索引实体。加入似乎是一个不错的主意，因为我们的框架也做了一个加入来了解用户是否可以访问记录。这里的问题是，有时我们会进行内部连接，有时会进行外部连接（取决于范围内的乐观（所有不被禁止的东西都是允许的）或悲观的（所有东西都是被禁止的，只有明确允许的）安全设置）。

为了更好地理解我们的结构是什么样的：

**文件**

```
DocumentNr | Name
------------------
1          | Foo
2          | Bar 
```

**文档记录访问**

```
DocumentNr | UserNr | AllowRead | AllowUpdate | AllowDelete
------------------------------------------------------------
1          | 1      | 1         | 1           | 0 
```

因此，例如，为悲观安全设置中的文档生成的查询将是：

```
SELECT * FROM Documents AS d 
INNER JOIN DocumentRecordAccess AS dra ON dra.DocumentNr=d.DocumentNr AND dra.AllowRead=1 AND dra.UserNr=1 
```

这将只返回 foo，但不返回 bar。在乐观的情况下：

```
SELECT * FROM Documents AS d 
LEFT JOIN DocumentRecordAccess AS dra ON dra.DocumentNr=d.DocumentNr AND dra.AllowRead=1 AND dra.UserNr=1 
```

返回两者 - Foo 和 Bar。

回到我的问题 - 也许有人已经这样做并且可以分享他们的见解和经验？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T22:22:33.967

恐怕这里没有简单的解决方案。您必须牺牲一些东西才能让 ACL 与搜索一起工作。

1.  如果您的语料库很小（我会说最多 10K 个文档），您可以创建一个缓存位集的禁止（或允许，以较不冗长的）文档并发送相关的过滤器查询`(+*:* -DocumentNr:1 ... -DocumentNr:X)`。不用说，这不能扩展。发送大型查询会使搜索速度变慢，但这是可以管理的（当然，在一定程度上）。查询解析[很便宜](http://mail-archives.apache.org/mod_mbox/lucene-solr-user/201204.mbox/%3CCAN4YXvdUFLvq3E2760esuk8_i_Z8-G-vA-mWDaFFVtzvXrd0_Q@mail.gmail.com%3E)。

2.  如果您可以以某种方式对这些文档进行分组并在文档组上应用 ACL，这将允许缩短查询长度，并且上述方法将非常适合。这几乎就是我们正在使用的 - 我们的解决方案实现了分类并通过`fq`查询完成了分类权限。

3.  如果您不需要显示总体结果集计数，则可以运行查询并在客户端过滤结果集。再次，不完美。

4.  您还可以对数据结构进行非规范化并将两个表展平在一个文档中，如下所示：

    DocumentNr: 1
    名称: Foo
    Allowed_users: u1, u2, u3 (or Forbidden_​​users: ...)

    其余的就像在查询中发送用户 ID 一样简单。

    仅当 ACL 很少更改**并且**您可以在它们更改时重新索引整个语料库时，上述方法才可行。

5.  您可以编写一个自定义查询过滤器，该过滤器将缓存`BitSet`用户（组？）从数据库中检索到的允许或禁止的文档。这不仅需要为 Solr webapp 提供数据库访问权限，还需要扩展/重新打包 Solr 附带的 .war。虽然这相对容易，但[更难的部分是缓存失效](http://martinfowler.com/bliki/TwoHardThings.html)：当 ACL 数据发生更改时，主应用程序应该以某种方式向 Solr 应用程序发出信号。

如果您可以将 Solr 和您的应用程序放在同一个 JVM 上并使用[javabin](http://wiki.apache.org/solr/javabin)驱动程序，选项 1 和 2 可能更合理。

如果不了解语料库/ACL 的细节，很难提供更多建议。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T13:08:08.800

我同意 mindas 的建议（sol-4），我以同样的方式实现了我的解决方案，但不同之处在于我几乎没有不同类型的 ACL。在用户组级别，用户级别甚至文档级别也是如此（私人访问）。

解决方案工作正常。但在我的案例中，主要担心的是 ACL 经常更改并且需要在索引中更新，这意味着搜索性能也不应该受到影响。

我正在尝试通过负载平衡和向集群中添加更多节点来管理它。

mindas，unicron，你能谈谈你的想法吗？

# asp.net - Url 重写适用于 IIS，但不适用于 localhost

> ID：13866093
> 
> 赞同：0
> 
> 时间：2012-12-13T18:26:25.723
> 
> 标签：asp.net, visual-studio-2010, iis-7, url-rewriting, cassini

我为我的网站使用 url 重写。我在 IIS 上进行了设置，它可以在服务器上运行。但它不适用于本地主机。这是正常的，因为我的项目文件中没有重写 url 的页面。我怎么解决这个问题？我在开发项目时使用 cassini 服务器。我应该在我的计算机中使用本地 IIS 吗？你可以在这里看到我在 web.config 文件中的 url 重写角色：

```
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true" />
        <rewrite>
            <outboundRules>
                <rule name="OutboundRewriteUserFriendlyURL1" preCondition="ResponseIsHtml1">
                    <match filterByTags="A, Form, Img" pattern="^(.*/)ProductDetail\.aspx\?prid=([^=&amp;]+)&amp;(?:amp;)?product=([^=&amp;]+)$" />
                    <action type="Rewrite" value="{R:1}ProductDetail/{R:2}/{R:3}/" />
                </rule>
                <preConditions>
                    <preCondition name="ResponseIsHtml1">
                        <add input="{RESPONSE_CONTENT_TYPE}" pattern="^text/html" />
                    </preCondition>
                </preConditions>
            </outboundRules>
            <rules>
                <rule name="RewriteUserFriendlyURL1" stopProcessing="true">
                    <match url="^urun/([^/]+)/([^/]+)/?$" />
                    <conditions>
                        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
                        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
                    </conditions>
                    <action type="Rewrite" url="ProductDetail.aspx?prid={R:1}&amp;product={R:2}" />
                </rule>

            </rules>
        </rewrite>
        <urlCompression doDynamicCompression="false" />
  </system.webServer> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:32:46.233

为什么不使用 URL 路由呢？这是更好的方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:35:28.630

是的，您必须使用添加/删除 Windows 组件在本地计算机上安装 IIS。

安装后，还要确保在本地 IIS 中启用“URL 重写模块”。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-11-19T14:38:32.600

您需要添加一个否定条件 `<add input="{HTTP_HOST}" pattern="localhost" negate="true" />` ，以便 URL 重写器忽略 localhost 上的任何请求。

```
<rewrite>
  <rules>
    <rule name="HTTP to HTTPS redirect" stopProcessing="true">
      <match url="(.*)" />
      <conditions>
        <add input="{HTTPS}" pattern="off" ignoreCase="true" />
        <add input="{HTTP_HOST}" pattern="localhost" negate="true" />
      </conditions>
      <action type="Redirect" redirectType="Found" url="https://{HTTP_HOST}{REQUEST_URI}" />
    </rule>
  </rules>
</rewrite> 
```

# bundle - Install4j - 创建 OSX Java 7 JRE 包

> ID：13866094
> 
> 赞同：1
> 
> 时间：2012-12-13T18:26:27.443
> 
> 标签：bundle, java, install4j

我正在尝试使用 install4j 的 createbundle 实用程序为 OSX 创建一个 JRE 包。不幸的是，该实用程序不包含在 OSX 安装中。

我尝试使用以下文档中描述的 ant 任务：

[http://resources.ej-technologies.com/install4j/help/doc/indexRedirect.html?http&&&resources.ej-technologies.com/install4j/help/doc/jreBundle.html](http://resources.ej-technologies.com/install4j/help/doc/indexRedirect.html?http&&&resources.ej-technologies.com/install4j/help/doc/jreBundle.html)

但它抱怨 createbundle 不存在。

为 OSX Java 7 创建 JRE 包的推荐方法是什么？是否有适用于 OSX 的 create bundle 版本？我正在寻找最新的 JRE (Java7u10) 捆绑包。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T08:55:51.570

尚不支持在 Mac OS X 上创建新的 JRE 包（从 5.1.3 开始），它将在未来的版本中添加。7u10 捆绑包将在今天晚些时候添加。

# c# - Image.FromStream() 在图像处理时发出 C#

> ID：13866102
> 
> 赞同：0
> 
> 时间：2012-12-13T18:27:04.613
> 
> 标签：c#, imaging

我正在使用 JPG 图像类型，这条线`image = Image.FromStream(ms);`给出了错误`Parameter is not valid`。这段代码有什么问题？

```
 private void button3_Click(object sender, EventArgs e)
        {
          Image partial=null;
          Rectangle bounds;
          Guid id;

          if (diff != null)
          {
            ImageConverter converter = new ImageConverter();
            var data = (byte[])converter.ConvertTo(diff, typeof(byte[]));

            UnpackScreenCaptureData(data, out partial, out bounds,out id);
            Image imgfirst = (Image)firstImg;
            UpdateScreen(ref imgfirst, partial, bounds);
          }
        }

        public static void UnpackScreenCaptureData(byte[] data, out Image image, out Rectangle bounds, out Guid id)
        {
          // Unpack the data that is transferred over the wire.
          // Create byte arrays to hold the unpacked parts.
          const int numBytesInInt = sizeof(int);
          int idLength = Guid.NewGuid().ToByteArray().Length;
          int imgLength = data.Length - 4 * numBytesInInt - idLength;
          byte[] topPosData = new byte[numBytesInInt];
          byte[] botPosData = new byte[numBytesInInt];
          byte[] leftPosData = new byte[numBytesInInt];
          byte[] rightPosData = new byte[numBytesInInt];
          byte[] imgData = new byte[imgLength];
          byte[] idData = new byte[idLength];

          // Fill the byte arrays.
          Array.Copy(data, 0, topPosData, 0, numBytesInInt);
          Array.Copy(data, numBytesInInt, botPosData, 0, numBytesInInt);
          Array.Copy(data, 2 * numBytesInInt, leftPosData, 0, numBytesInInt);
          Array.Copy(data, 3 * numBytesInInt, rightPosData, 0, numBytesInInt);
          Array.Copy(data, 4 * numBytesInInt, imgData, 0, imgLength);
          Array.Copy(data, 4 * numBytesInInt + imgLength, idData, 0, idLength);

          // Create the bitmap from the byte array.          
          MemoryStream ms = new MemoryStream(imgData, 0, imgData.Length);
          ms.Write(imgData, 0, imgData.Length);
          image = Image.FromStream(ms);
          ....
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:39:04.023

我认为您必须将您`MemoryStream`的位置重置为 0。您可以通过调用`Seek()`内存流上的方法来完成此操作：

```
MemoryStream ms = new MemoryStream(imgData, 0, imgData.Length);
ms.Write(imgData, 0, imgData.Length);

ms.Seek(0, SeekOrigin.Begin);  // Set stream position to 0\.    

image = Image.FromStream(ms); 
```

# ruby - Ruby 的 narray gem 安装错误

> ID：13866103
> 
> 赞同：0
> 
> 时间：2012-12-13T18:27:09.380
> 
> 标签：ruby, math, installation, gem, narray

我正在尝试为 Ruby 安装 NArray gem 来执行一些数学函数。我在 OSX Mountain Lion 上运行 Ruby 1.8.7 版

当我尝试安装 NArray gem 时，会产生以下错误：

```
instance of Date needs to have method `marshal_load' 
```

我用谷歌搜索过，没有任何运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T07:44:08.157

这似乎是由于日期的元帅格式发生了变化。 [https://github.com/rubygems/rubygems/issues/266](https://github.com/rubygems/rubygems/issues/266)

# coding-style - 在编程中是否有适当的方法来进行函数/方法调用

> ID：13866109
> 
> 赞同：3
> 
> 时间：2012-12-13T18:27:25.767
> 
> 标签：coding-style

所以，我在编码，我基本上得到了这行代码

> 返回 parseInt(trim(elem.value.substring(1, elem.value.length)))

我在想，这是否合适，或者教授/雇主会因为允许这样一行代码而抨击我。

我觉得，虽然很整洁，但乍一看很难理解我在做什么。这不是那么糟糕 b/c 大多数调用都很常见（确保它是一个 int，修剪字符串以便转换工作并从字符串的开头删除不必要的信息）

但是，这样可以吗？或者我应该把它分解并注释每一行，以便未来的程序员更容易理解？喜欢...

```
var returnInt;
returnInt = elem.value.substring(1, elem.value.length); //remove $ symbol
returnInt = trim(returnInt); //trim whitespace
returnInt = parseInt(returnInt); //convert to int
return returnInt; 
```

我不知道如何搜索这个，所以如果有什么东西我很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:52:32.320

第一种格式很好，除了它会使像 NullPointerExceptions 这样的运行时异常难以调试（因为堆栈跟踪返回一个行号并且它可能在一行上）。因此，如果可能发生 NPE，请将其写成多行。

并且没有必要对每一行进行行尾注释。很明显 trim 和 parseToInt 对除了最新手的程序员以外的任何人都做了什么，而且一个简单的谷歌搜索无论如何都会出现这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T18:55:34.370

只要您很好地格式化代码就可以了。例如，您的线路可能如下所示：

```
return parseInt(
         trim(
           elem.value.substring(1, elem.value.length))) 
```

引用：

> 或者我应该把它分解并注释每一行，以便未来的程序员更容易理解？喜欢...

```
var returnInt;
returnInt = elem.value.substring(1, elem.value.length); //remove $ symbol
returnInt = trim(returnInt); //trim whitespace
returnInt = parseInt(returnInt); //convert to int
return returnInt; 
```

这并不容易。过度的可变性是邪恶的；如果您的值具有不同的类型，这将不起作用。（糟糕，您可能正在使用动态类型语言，但是 var 的名称`returnInt`会产生误导，因为在某些程序状态下 is 确实不是`Int`）。请不要写这样的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T18:49:10.153

我不在乎教授或雇主会怎么想。除非它变得非常长，否则我总是将这些简单的语句内联，因为它们更容易理解和清晰。

我认为当你分解它时它看起来更复杂。我讨厌无用的断言和等号。我只会在我做一些非常复杂的事情并且需要对其他人和将来的我发表评论时才打破陈述。

在您的示例中，所有语句都非常简单明了。他们都不需要对普通开发人员进行评论或解释。

# ruby-on-rails-3 - 找不到字段“名称”（Capybara::ElementNotFound）

> ID：13866110
> 
> 赞同：14
> 
> 时间：2012-12-13T18:27:26.170
> 
> 标签：ruby-on-rails-3, rspec, capybara

我正在尝试使用 capybara+rspec 并收到此错误：无法找到字段“名称”（Capybara::ElementNotFound）

这是我的表格：

```
%h2 Sign up
= simple_form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => {:class => 'form-vertical' }) do |f|
  = f.error_notification
  = display_base_errors resource
  = f.input :name, :autofocus => true
  = f.button :submit, 'Sign up', :class => 'btn-primary'
= render "devise/shared/links" 
```

这是我的 user_steps.rb

```
When /^I sign up with valid user data$/ do
  create_visitor
  sign_up
end

def create_visitor
  @visitor ||= { :name => "Test visitor"}
end

def sign_up
  visit '/users/sign_up'
  fill_in "Name", :with => @visitor[:name]
  click_button "Sign up"
end 
```

怎么了？？？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-17T19:39:04.637

在我看来，您正在寻找一个字段 label `Name`，但是您的 name 字段没有标签，因此您可能需要使用字段的 ID 或名称，这可能是：

`"#{resource_name}[name]"`

此外，正如@nmott 在他的评论中所说，您应该尝试使用`save_and_open_page`，以便您可以实际查看页面，但是请注意，您需要启动 gem 才能使用此方法。

此外，您可能会发现您甚至不在正确的页面上。在测试注册页面以外的页面时，我通常遇到的问题是我被重定向并且不知道。所以在使用之后`visit`，你也应该使用`assert_template`来确保你在正确的页面上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-08-25T18:05:52.557

我遇到了这个问题，意识到Capybara[过滤掉了隐藏字段](https://github.com/jnicklas/capybara/blob/master/lib/capybara/query.rb#L46)——我的元素属于多标签页中的非活动标签（隐藏）。我刚刚传递了 :visible arg 并将其设置为 false，瞧！找到该元素。

```
fill_in "content", with: 'foo bar', visible: false 
```

或者

```
find('#item_content', visible: false).set 'foo bar' 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-12-10T15:43:03.137

我自己也有同样的问题，我不得不一起停止使用 fill_in。我所做的是将所有出现的 fill_in 替换为以下代码：

```
 element = page.find("Name")
    element.set(@visitor[:name]) 
```

我想您可以将其封装到一个方法中，以使您的测试更加流畅

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-29T18:02:58.693

尝试从表格中缩小范围

```
within("form#whatever_form_id") do
  fill_in "Name", :with => @visitor[:name]
  click_button "Sign up"
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-12T14:14:23.847

Ok guys I found it out having the same issue , its very simple : In capybara or rspec they need you to but "Name" and in your form or label field you need to write "name" in small....there you go works for me.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-21T01:56:21.743

对我来说，引起问题的是规范的下一行，而不是 fill_in “name”行。name 是“Name”还是“name”都没有关系。对我来说，下一个 click_button 行有 click_button "Wrong Name"，这是按钮的错误名称，这并没有给出预期的错误“无法点击按钮 "Wrong Name"，而是给出了找不到字段”名称”。对于我的第一篇关于堆栈溢出的帖子来说有点冗长。底线。考虑一下水豚错误消息中给出的行下方的行。

# html - 在单个 div 中使用两个重复的背景图像

> ID：13866112
> 
> 赞同：1
> 
> 时间：2012-12-13T18:27:42.120
> 
> 标签：html, css

我尝试为我的 div 使用 x 方向上的两个重复背景图像。但我不能。如何在我的 div 中使用 x 方向上的两个重复图像（即，我需要将我的单个 div 分成两个相等的部分。对于我的第一部分我需要使用我的第一张图片和背景重复-x，然后其余部分应该用我在重复-x方向的第二张图片填充）。请帮助我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T21:10:41.273

如果没有您的代码，您将无法真正知道您的目标，但我会这样做：

```
<div class="outer_div">
    <div class="left_half"></div>
    <div class="right_half"></div>
</div>

<style>
.outer_div{
    width: 500px; /*or whatever you need the width to be */
}
.left_half{
    background-image: url("your image here") repeat-x;
    width: 50%;
    float:left;
}
.right_half{
    background-image:url("your image here") repeat-x;
    width: 50%;
    float:right;
}
</style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T23:21:27.237

您将需要`CSS3`为***单个******.*** `div`

HTML：

```
<div class="backgrounds"></div> 
```

CSS：

```
.backgrounds {
  background: url(http://userlogos.org/files/logos/pek/stackoverflow2.png),
              url(http://www.gravatar.com/avatar/3807b3e7ad69d363d4490540c663af5f?s=128&d=identicon&r=PG);
  background-repeat: no-repeat, repeat;
  background-position: center, left;
  width: 700px;
  height: 300px;
} 
```

[**jsFiddle 演示：单个 Div 的多个背景**](http://jsfiddle.net/Rgmxs/1/)

**编辑：**修订 jsFiddle 以`repeat-x`阅读更多关于[**CSS3**](https://developer.mozilla.org/en-US/docs/CSS/Using_CSS_multiple_backgrounds)***多背景的*** 信息。[](https://developer.mozilla.org/en-US/docs/CSS/Using_CSS_multiple_backgrounds)

# android - 从可绘制对象中获取资源 id

> ID：13866113
> 
> 赞同：0
> 
> 时间：2012-12-13T18:27:43.977
> 
> 标签：android, resources, drawable, imagebutton

在 xml 中：

```
<ImageButton
    android:id="@+id/b_checkEv" 
    android:src="@drawable/img_huella" 
    ... /> 
```

活动中：

```
 ImageButton ib = (ImageButton) findViewById(R.id.b_checkEv);
     Drawable dr = ib.getDrawble(); 
```

我使用 ib.setDrawable() 在代码中动态更改 ImageButton 的图像。任何人都知道我怎样才能从 Drawable 中获取资源 ID，以便知道每个时刻在 ImageButton 中设置了哪个图像？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-08T11:13:38.003

控制 Android 按钮的最佳方式是标签。

您可以在此处执行“ib.setTag("image1.png")”并管理图像数据。

然后您可以执行“String imageName = ib.getTag()”并获取图像名称。

问候

# php - mysql替换字段php中的文本

> ID：13866114
> 
> 赞同：-3
> 
> 时间：2012-12-13T18:27:51.353
> 
> 标签：php, mysql, database

> **可能重复：**
> [mysql kill process is user don't got enought points PHP](https://stackoverflow.com/questions/13844214/mysql-kill-process-is-user-dont-got-enought-points-php)

我有一个带有用户系统的积分系统，人们可以用 50 积分升级到 [PRO] 用户。当他们注册时，会自动将 [user] 写入我的权限字段。但现在我想在一个动作之后检查他们是否得到 50 分，然后用 [PRO] 替换 [user]，然后减去 50 分。

```
<?php
session_start();
//=============Configuring Server and Database=======
$host        =    'localhost';
$user        =    'root';
$password    =    '';
//=============Data Base Information=================
$database    =    'login';

$conn        =    mysql_connect($host,$user,$password) or die('Server Information is not Correct'); //Establish Connection with Server
mysql_select_db($database,$conn) or die('Database Information is not correct');

//===============End Server Configuration============

//=============Starting Registration Script==========

$username    =    mysql_real_escape_string($_POST['txtusername']);

//=============To Encrypt Password===================

//============New Variable of Password is Now with an Encrypted Value========

$insert = "UPDATE `users` SET `points` = (`points`-50) WHERE `username` = '".$username."' and points > 50";
mysql_query($insert);
if (mysql_affected_rows() > 1)
{
    // other codes

    $insert = "UPDATE `users` SET `rights` = (`rights` [PRO]) WHERE `username` = '".$username."'";
    mysql_query($insert); 
header('location: succesupgrade.php');
}else{
    echo "You don't have enough points to buy [PRO]";
}

?> 
```

再说一遍：我希望在人们购买 [PRO] 之后，[user] 被 [PRO] 替换。然后他们失去了 50 分。如果他们没有得到 50 分。echo 说了些什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:31:24.353

一次完成：

```
UPDATE `users` 
SET `rights` = '[PRO]', points = points - 50
WHERE 
   `username` = 'somename'
   AND points >= 50
   AND rights != '[PRO]' 
```

只需检查您是否有受影响的行。如果他们没有足够的积分，它就不会更新，当他们已经有权利时也不会更新。这避免了竞争条件。

# java - Java - 线程和 CPU 之间的关系

> ID：13866123
> 
> 赞同：11
> 
> 时间：2012-12-13T18:28:33.373
> 
> 标签：java, multithreading, executorservice, threadpool

我对多线程很陌生，我正在做一个项目，我试图在我的 Java 程序中使用 4 个 CPU。我想做类似的事情

```
int numProcessors = Runtime.getRuntime().availableProcessors();
ExecutorService e = Executors.newFixedThreadPool(numProcessors); 
```

这能保证每个 CPU 都有一个线程工作吗？在我创建线程的时候，系统不会很忙，但是之后的一段时间会非常忙。我认为操作系统会选择最不忙的 CPU 来创建线程，但是如果在创建时它们都不是特别忙，它是如何工作的呢？

此外，线程池服务应该重用线程，但是如果它看到另一个 CPU 上有更多的可用性，它会杀死线程并在那里生成一个新线程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:32:55.887

不，它不能保证线程运行的位置

事实上，操作系统线程调度程序可以自由地在它认为合适的情况下迁移内核周围的线程（所以一行你可以在核心 0 上，下一行在核心 4 上）

您可以设置线程的[亲和性](http://en.wikipedia.org/wiki/Processor_affinity)，但这在 java 中不可用（AFAIK）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:33:08.827

> 这能保证每个 CPU 都有一个线程工作吗？

如果您有四个需要同时执行的任务，您可以期望它们每个都有一个线程。在 HotSpot JVM 中，它会在创建池时创建 Thread 对象，这些对象是实际线程的代理。何时创建实际线程以及如何创建对您来说很重要。

> 在我创建线程的时候，系统不会很忙，但是之后的一段时间会非常忙。我认为操作系统会选择最不忙的 CPU 来创建线程，但是如果在创建时它们都不是特别忙，它是如何工作的呢？

线程由操作系统创建，并添加到要调度的线程列表中。

> 此外，线程池服务应该重用线程，但是如果它看到另一个 CPU 上有更多的可用性，它会杀死线程并在那里生成一个新线程吗？

Java 在这件事上没有发言权。操作系统决定。它不会杀死和重新启动线程。

线程不像您建议的那样与 CPU 绑定。操作系统根据需要运行的线程和空闲的 CPU 在 CPU 之间传递线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T09:15:21.537

“如果它发现另一个 CPU 上有更多的可用性，它会杀死线程并在那里产生一个新的吗？”

无需杀死并生成另一个以使用可用的 CPU。线程是未绑定到特定 CPU 的内存对象，并且可以从一个 CPU 浮动到另一个 CPU。线程执行是这样一个循环：

*   `Thread.start()`将线程放入处理器队列
*   当有可用处理器时，调度程序将处理器队列中的第一个线程放入处理器
*   当线程阻塞在一个占用的锁上，或者正在等待 I/O 操作结束时，它会从处理器中取出并放入相应的队列中。当锁被释放或 I/O 操作完成时，线程将从该队列移回处理器队列。
*   当线程在没有阻塞的情况下工作太长时间（依赖于 o/s 的时间，比如 50 毫秒），就会发生中断，调度程序会查看处理器队列中是否有线程。如果有，则将当前线程从处理器中取出并放在处理器队列的末尾，并将队列中的第一个线程放在处理器上。这样，长时间运行的线程也可以让其他线程执行。

结果，线程经常改变它们的状态，但这对程序员来说是透明的。线程的整个想法是线程是处理器的模型，比真正的处理器更方便。使用该模型，不必担心在处理器上映射线程，直到您真正需要为止。

# php - 为每个循环添加事件到完整日历

> ID：13866124
> 
> 赞同：0
> 
> 时间：2012-12-13T18:28:37.123
> 
> 标签：php, jquery, html, web, fullcalendar

我正在使用完整的日历 jQuery 组件，我也在尝试通过 div 循环来添加事件 .. 但它不起作用..

这是Javascript代码..**注释行是添加时有问题的代码..**

```
$(document).ready(function() {

    var date = new Date();
    var d = date.getDate();
    var m = date.getMonth();
    var y = date.getFullYear();

    $('#calendar').fullCalendar({
        editable: true,
        events: [
            //$("div.allEvents").each( function ( index ){      when I add this to the Jquery code .. it doesn't work
                {
                    //title: $(this).children('#event').val(),    replace this by the next line 
                    title: $('#event').val(),

                    //start: new Date( y, m, $(this).children('#date').val() )   replace this by the next line 
                    start: new Date( y, m, $('#date').val() )
                },
            //} );      End of each loop
        ]
    });

}); 
```

这是CSS和HTML代码..

```
<div class="allEvents">
<input type='hidden' id='event' value='Alaa' />
<input type='hidden' id='date' value='21' />
</div>
<div class="allEvents">
<input type='hidden' id='event' value='Waheeb' />
<input type='hidden' id='date' value='29' />
</div> 
```

```
<style type='text/css'>

body {
    margin-top: 40px;
    text-align: center;
    font-size: 14px;
    font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
    }

#calendar {
    width: 900px;
    margin: 0 auto;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T15:58:57.930

HTML

```
<div id="all-events">
  <div class="event">
    <input type="hidden" class="title" value="Alaa"/>
    <input type="hidden" class="date" value="12/21/2012" />    
  </div>
  ... rest of events go here
</div> 
```

JavaScript

注意：您需要将日期值包装到某种类型的转换器中以使其成为 Date 类型，我建议使用 moment.js

```
var myEvents = [];

$.each( $( '.event' ), function( event ) {
  myEvents.push( {
    title : event.find( '.title' ).val(),
    start : event.find( '.date' ).val(),
    allDay : true
  } );  
} );

$myCal.fullCalendar( 'addEventSource', myEvents ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:36:14.540

你不能在`[...]`;里面做循环。相反，使用一个[函数](http://arshaw.com/fullcalendar/docs/event_data/events_function/)来初始化你的事件......

# javascript - WSAPI 查询导致无限请求循环

> ID：13866127
> 
> 赞同：1
> 
> 时间：2012-12-13T18:28:49.310
> 
> 标签：javascript, sdk, rally

我使用 WsapiDataStore 请求创建了一个数据查询。当服务器返回数据时， loadPages 调用工作正常；但是当没有符合过滤条件的数据时，loadPages 方法似乎会向服务器发出无限数量的请求，我可以通过控制台看到这些请求。我尝试检查没有返回数据，然后使用 clearListeners 方法停止请求循环，但调用后似乎没有任何反应。如果第一个请求没有返回数据，是否有一种简单的方法可以停止请求信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T17:52:55.663

看起来 clearListeners 调用必须在实际的 loadPages 对象上进行，而不是存储加载器本身。我发现避免无限循环问题的最佳方法是像这样构造调用：

```
var StoreLoader = Ext.create('Rally.data.WsapiDataStore', {
    // Properties and filters...
    listeners: {
        load: function(model, data) {
            if (data && data.length) {
                // Process data from store
            } else {
                PageLoader.clearListeners();
            }
        }
    }
});

var PageLoader = storeLoader.loadPages({
    callback: function() {
        //Do whatever after the store has been loaded
    }
}); 
```

# performance - 什么时候应该使用 Haskell 的 Data.Map 来支持元组列表？

> ID：13866128
> 
> 赞同：4
> 
> 时间：2012-12-13T18:28:50.230
> 
> 标签：performance, haskell

最近需要比较两组历史数据。由于有时其中一个会丢失一两天，并且我想准确地说，我决定创建一个包含所有可能日期的列表和两个包含日期和属于这两个集合的相应值的元组列表。然后我将后面的列表更改为`Map`s 以改进日期查找。

这个想法是尝试从两个`Map`ped 列表中的完整日期列表中查找每个日期，并创建一个“三元组”列表，`(date, value1, value2)`其中仅包含两个数据集都有日期和值的日期。然后我可以将它们写入文件并正确比较它们。

**不要介意代码，它只包含在良好的衡量标准中**

这是代码（它根本不是最佳的，但对于那个小任务它做得很好）：

```
import qualified Data.Map as M
import Data.List (transpose)
import Data.Maybe (fromJust)

main = do
    dts     <- readFile "dates.txt"
    cts1    <- readFile "eu.txt"
    cts2    <- readFile "usa.txt"
    let
        dates  = lines dts
        cols1  = transpose $ map words $ lines cts1
        cols2  = transpose $ map words $ lines cts2
        prs1   = zip (head cols1) (last cols1)
        prs2   = zip (head cols2) (last cols2)
        map1   = M.fromList prs1
        map2   = M.fromList prs2
        trips  = map fromJust (filter (/=Nothing) (map (\date -> getTrips date map1 map2) dates))
        cols3  = map (\(a,b,c) -> [a,b,c]) trips
        result = unlines $ map unwords $ cols3
    writeFile "trips.txt" result

getTrips :: String -> M.Map String String -> M.Map String String -> Maybe (String, String, String)
getTrips date map1 map2
    | is1 /= Nothing && is2 /= Nothing    = Just (date, fromJust is1, fromJust is2)
    | otherwise                           = Nothing
    where
        is1 = M.lookup date map1
        is2 = M.lookup date map2 
```

TL;DR：代码有效（尽管我很乐意听到一些意见/建议），但我有一些问题：

*   只有大约 2000 个日期，因此我不太关心性能（你可以看到我`String`到处都在使用 s）；是在使用`Data.Map`矫枉过正吗？**什么时候应该`Data.Map`优先于元组列表？**
*   是`Map`从 s 的元组创建`String`的 - 是否可以，或者**键是否应该始终为数字以便平衡和查找正常工作？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T19:55:55.983

> 只有大约 2000 个日期，因此我不太关心性能（你可以看到我到处都在使用字符串）；那时使用 Data.Map 是不是有点矫枉过正？何时应首选 Data.Map 而不是元组列表？

您应该使用适合您的问题和性能/编程时间限制的数据结构，因此使用 a`Map`可能是一个好主意。也许在您的情况下，如果您的数据已经订购，您可以完成

```
union [] _ = []
union _ [] = []
union xss@((dx,vx):xs) yss@((dy,vy):ys) = 
    case compare dx dy of
         EQ -> (dx, vx, vy) : union xs ys
         GT -> union xss ys
         LT -> union xs yss 
```

> Map 是从字符串的元组创建的 - 是否可以，或者键是否应该始终为数字以便平衡和查找正常工作？

不，如果您的代码类型检查您`Map`将正常工作（w/r/t 您定义`Ord`实例的方式）。但正如 CA McCann 所建议的那样，如果您的键是列表，则[特里](http://en.wikipedia.org/wiki/Trie)可能更合适，特别是如果键前缀之间有很多重叠（看看`Ord`列表上的实例是如何实现的，并想象一下必须发生的操作数将键“abcdx”、“abcdy”和“abcdz”插入到一个`Map`vs. 一个 trie 结构中以说服自己）。

# r - 晶格，包括误差线

> ID：13866129
> 
> 赞同：0
> 
> 时间：2012-12-13T18:28:52.443
> 
> 标签：r, lattice

亲爱的stackoverflow专家，

我正在用`lattice`. 我有两个单独的表格，一个带有平均值，另一个带有标准错误。如何在条形图中包含标准误差？

```
table.df<-means 
table.std<-table_error
library(lattice)
library(gridExtra)
graph1<-barchart(value1~Var1|Var2+Var3,data=table.df, ylab=NULL)
graph2<-barchart(value2~Var1|Var2+Var3,data=table.df, ylab=NULL)
grid.arrange(graph1,graph2, nrow=2, ncol=2) 
```

有什么建议吗？这可能吗？

![条形图示例](../Images/59644396ae86dc1f4c2e9eb49bb350b7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-26T08:59:38.840

虽然我同意这可能是一个坏主意的评论，但无论如何这里有一个解决方案：

```
x <- rnorm(100, 10, 1)
ind <- sample(c("one", "two"), 100, TRUE)

dd <- data.frame(
  m = tapply(x, ind, mean),
  ind = unique(ind),
  se = tapply(x, ind, function(x) {sd(x) / sqrt(length(x))})
)

lattice::barchart(ind ~ m, data = dd, xlim = c(8, 12),
                  se = dd$se,
                  panel = function(x, y, ...) {
                    panel.barchart(x, y, ...)
                    panel.segments(y0 = y, x0 = x - dd$se,
                                   y1 = y, x1 = x + dd$se, ...)
                  }) 
```

![伊姆古尔](../Images/1919ed124053f64f3a458a3b7802c7cb.png)

# c# - 切换应用程序时停止 DispatcherTimer（Windows 应用商店）

> ID：13866135
> 
> 赞同：1
> 
> 时间：2012-12-13T18:29:18.590
> 
> 标签：c#, .net, windows-store-apps

我`DispatcherTimer`在我的应用程序中计算了我的应用程序已经激活了多长时间，并且我想`DispatcherTimer.Stop()`在用户导航到其他应用程序时调用（所以它不再计算在内）。然后当用户返回我的应用程序时恢复计数。

怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:37:04.550

在 Application 类的 Suspending 事件中，执行 DispatcherTimer.Stop() 方法。

在 Application 类的 Resuming 事件中，恢复 DispatcherTimer。

Application 类的 Suspending 事件将在用户切换应用程序或离开您的应用程序时执行。当用户聚焦您的应用并将其带到前台时，将执行 Resuming 事件。

请参阅：http: [//msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.application.suspending.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.application.suspending.aspx) http://msdn.microsoft.com/en-us/library/windows /apps/windows.ui.xaml.application.resuming.aspx

# bash - Bash 脚本需要清理

> ID：13866140
> 
> 赞同：-2
> 
> 时间：2012-12-13T18:29:59.037
> 
> 标签：bash, menu, option

我有一个用于处理 Android 文件的脚本。我从其他地方借了很多代码并放在一起，现在差不多完成了。

该脚本在（至少）两件事上有错误：

1.  当用户选择不可用的选项时，我希望它显示消息“无效选择”，然后返回选择屏幕。
2.  无论我是否对选定文件运行操作，如果我返回主菜单（称为“build”的“主”脚本）并返回此脚本，文件列表会以某种方式继续从最后一个文件编号time.. 即第一次运行的最后一个文件是#43。当我再次运行脚本时，第一个文件以 #44 开头。我必须完全退出主（构建）脚本并重新开始

这是脚本：

```
#!/bin/bash

HOME=/home/dan/buildtool

d=$HOME/apk_in/decompiled
clear

a=`ls -d $d/* | grep .apk`
if [[ "$?" == "0" ]] ; then
    echo "Available apks for Recompiling: "
    echo
    cd $d
    for apkName in `ls | grep .apk`
    do
        i=$(($i+1))
        apkArray[$i]=$apkName
        echo "  $i. $apkName" >> temp.list
    done
    cat temp.list
    rm -f temp.list
    echo
    echo -n "Choose Apk number (choose x to return to menu): "
    read ans
    echo

    if [ "$ans" == "" ]; then
        echo "Invalid choice"
        echo
        exit 0
    fi  
    if [ "$ans" == "x" ]; then
        clear           
        . $HOME/build
    fi
    if [ "`echo $ans | sed 's/[0-9]*//'`" == "" ] || [ "ans"=="1" ]; then
        apkDecode=${apkArray[$ans]}
        if [ "$apkDecode" == "" ]; then
            exit 0
        fi
    else
        exit 0
    fi  
    apktool b -f $apkDecode 

else
    echo
    clear
    echo "No valid files"
fi 
```

理想情况下，我希望能够选择的不仅仅是一个文件来使用，但我想这将是对脚本的完全重写。首先，我想清理这个： )

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T00:24:07.430

通常，您不想将 ls 的输出用于任何事情，尤其是当简单的 glob 可以替换它时。Bash 已经有一个按数字选择项目的菜单：select 语句。

您还在 [ "ans"=="1" ] 中遇到了一个陷阱，这始终是正确的。您的意思可能是 [[ $ans == 1 ]] （ShellCheck 有时对这类问题很有帮助）。

基于此，这是重写的起点：

```
#!/bin/bash
HOME=/home/dan/buildtool
d=$HOME/apk_in/decompiled
shopt -s failglob
echo "Enter a number, or x to exit"
select file in *.apk
do
    [[ $REPLY == x ]] && break
    [[ -z $file ]] && echo "Invalid choice" && continue
    apktool b -f "$file"
done 
```

# ruby - 如何为 nanoc 中的每个标签生成页面

> ID：13866141
> 
> 赞同：10
> 
> 时间：2012-12-13T18:30:00.533
> 
> 标签：ruby, tagging, nanoc

我是 nanoc 的新手，我仍然在它周围找到我的。我能够准备好我的网站，它看起来不错，功能也很好。但我需要有一个标签区域。我能够做到这一点

```
<%= tags_for(post, params = {:base_url => "http://example.com/tag/"}) %> 
```

但是如何为标签生成页面？因此，例如有一个名为“NFL”的标签，因此每次用户点击它时，他/她都应该被引导到`http://example.com/tag/nfl`与 NFL 对应的文章列表。

我可以设置一个布局来做到这一点。但是那我应该使用什么样的逻辑呢？而且我还需要一个帮手吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-14T05:32:20.563

您可以在`Rules`文件中使用预处理块来动态生成新项目。这是一个预处理块的示例，其中添加了一个新项目：

```
preprocess do
  items << Nanoc::Item.new(
    "some content here",
    { :attributes => 'here', :awesomeness => 5000 },
    "/identifier/of/this/item")
end 
```

如果您想要每个标签的页面，您需要先收集所有标签。我这样做是因为我不想重复：

```
require 'set'
tags = Set.new
items.each do |item|
  item[:tags].each { |t| tags.add(t.downcase) }
end 
```

最后，遍历所有标签并为它们生成项目：

```
tags.each do |tag|
  items << Nanoc::Item.new(
    "",
    { :tag => tag },
    "/tags/#{tag}/")
end 
```

现在，您可以为 /tags/*/ 创建一个特定的编译规则，以便使用“tags”布局呈现它，该布局将采用 :tag 属性的值，查找具有此标记的所有项目并将它们显示在列表。该布局看起来有点像这样：

```
<h1><%= @item[:tag] %></h1>
<ul>
  <% items_with_tag(@item[:tag]).each do |i| %>
    <li><%= link_to i[:title], i %></li>
  <% end %>
</ul> 
```

概括地说，这应该是你想要的！

# jquery - 如何从该控件包含的字符中获取 html 控件的宽度（以像素为单位）

> ID：13866142
> 
> 赞同：0
> 
> 时间：2012-12-13T18:30:05.917
> 
> 标签：jquery, css, dom

我有一个文本框，其像素宽度应由其中的字符数确定。字符的字体大小是固定的。

我的逻辑是将文本框的 css-width 设置为所需的宽度。

```
requiredWidth = "number of characters" * "fontsize in pixel" 
```

这个简单的公式不起作用。知道如何将字符数转换为像素吗？

如果未设置 css.width 是否可以检索 dom 元素的像素大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:37:41.547

大多数字体的间距不成比例。"WWWW" 比 "iiiiii" 宽，因此计数字符不起作用。

您需要将实际文本放入 DOM 中的 SPAN 中并测量其大小。

# solr - 如何在 SolrJ 中设置 facet 方法？

> ID：13866154
> 
> 赞同：2
> 
> 时间：2012-12-13T18:30:43.393
> 
> 标签：solr, solrj, faceted-search, facet

如何`facet.method=enum`在 SolrJ SolrQuery 中设置？我正在寻找类似的东西 `solrQuery.setFacetMethod(SOLR_FACET_METHOD.enum)`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T18:46:35.010

我认为您将需要使用通用 setParam 方法，因为它没有直接公开。

```
solrQuery.setParam(FacetParams.FACET_METHOD, FacetParams.FACET_METHOD_enum) 
```

# java - Java中的全局对象？

> ID：13866155
> 
> 赞同：0
> 
> 时间：2012-12-13T18:30:50.807
> 
> 标签：java

我有两节课：

```
public class A{
   int money;
   ArrayList<Item> boughtItems;
   .
   .
   public void addBoughtItem(Item item){
      .
      .
   }
   public void adjustMoney(int adjustAmount){
      money = money + adjustamount;
   }
} 
```

和另一个类：

```
public class B{
  ArrayList<Item> itemsForSale;
  .
  .
  public Item sellMeItem(Item item){
    .
    .
    return itemsForSale.get(...);
  }
} 
```

现在主要是，我启动了一个 A 类的实例和一个 B 类的实例。在 B 类内部，每当我向他们出售物品时，我想更新购买的物品并实时调整 A 类实例的钱（即意味着，在 B 类的 sellMeItem 函数中。）因此我认为我需要 A 实例是全局的。如何从 B 类的 sellMeItem 函数内部到达主要的 A 对象？（和B类实例也是主要的）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T18:33:16.717

> 因此我认为我需要 A 实例是全局的。

并非如此，您可以简单地将 A 实例的引用传递给 B，例如通过构造函数：

```
class B {

    private A a;

    public B(A a) {
        this.a = a;
    }
} 
```

然后您可以`a`在 B 中访问。在您的主要内容中：

```
A a = new A();
B b = new B(a); 
```

但是，这两个类如此密切相关的事实可能意味着您在它们之间划分职责的方式不是最佳的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T18:34:03.993

[在这里应用观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)可能会更好。让 A 订阅 B 上的事件（您可以在 main 方法中连接它）。

为此，您可能需要为 B 上的观察者定义一个接口

```
public interface BObserver {

    void itemSold(Item item);

} 
```

并让 A 实现这个接口。这样多个不同类型的观察者可以注册到 B。

# postgresql - 单击 SQL 查询按钮时，PgAdmin 有时会崩溃

> ID：13866157
> 
> 赞同：11
> 
> 时间：2012-12-13T18:31:08.700
> 
> 标签：postgresql, crash, pgadmin

我知道这个问题可能与这个问题[重复](https://stackoverflow.com/q/11838493/1801588)。我什至有几乎相同的配置（PostgreSQL 9.1.3、pgAdmin III 1.14.3、32 位 Windows）。有什么区别，我问一个新问题的原因是我的 PgAdmin 并不总是（只是大部分）崩溃，并且问题的原因是不同的 - 在链接的问题中，问题是缺少 adminpack，但我安装了 adminpack而且效果很好，因此链接问题的答案对我不起作用。

你有什么想法可能是问题所在吗？

编辑： PgAdmin 不会在其他情况下崩溃（好吧，除非我做了一些显然应该崩溃的事情），只是在尝试打开 SQL 查询窗口时。随着时间的推移，情况越来越糟，现在几乎“总是”。问题不是“特定于连接” - 不同服务器连接的崩溃频率相同。

EDIT2：我重新安装了 PgAdmin，没有任何改变。我开始怀疑 PostgreSQL 9.1.3 甚至 PostGIS 2.0.1 的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-05-28T07:25:00.260

1.  转到运行并键入 %appdata% 并进入 postgresql 文件夹。
2.  重命名或删除 pgadmin_histoqueries.xml 文件。
3.  尝试再次打开 SQL 查询编辑器。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T20:51:50.097

PgAdmin 总是在我身上崩溃，但你最终学会了对它温和。

特别是，如果它正在等待来自 PostgreSQL 服务器的响应，则窗口可能会冻结，直到返回并解析响应。发生这种情况时，不要*关闭*窗口，等待。

此外，如果您尝试在同一个父对象上编辑两个不同的对象，保存一个并单击另一个上的保存，这会使程序崩溃。

我的建议是一次只做一件事，要有耐心，不要急于在进程冻结时终止进程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T23:04:23.763

崩溃可能有很多不同的可能原因。[其中一些已](http://www.pgadmin.org/development/changelog.php)在上周刚刚发布的[最新版本 1.16.1中得到修复。](http://www.pgadmin.org/)
您可以尝试新版本，看看是否能解决您的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-25T01:48:15.253

在我的 ubuntu 12.04 LTS 上安装后，Pgadmin3 真的很不稳定。即使在执行非常基本的操作（例如在表中查找数据或在模式中列出表等）时，它也会冻结或崩溃，我几乎放弃并开始使用命令行 psql，幸运的是偶然发现了这个建议删除 pgadmin3 历史记录的[博客](http://jamesseibel.com/blog/?p=31)文件来解决冻结和崩溃。它对我有用。

# winapi - 使用 CreateProcess 函数启动时，cmd.exe 在某些情况下不会终止

> ID：13866158
> 
> 赞同：2
> 
> 时间：2012-12-13T18:31:11.330
> 
> 标签：winapi, batch-file, cmd

我正在通过带有 CreateProcess 函数的 C 程序执行批处理命令。我通过检查进程退出代码是否等于除 STILL_ACTIVE 之外的任何值来检查进程是否已使用 GetExitCodeProcess 函数终止。这适用于“cmd /c echo Hello World”等命令，但对于“cmd /c dir c:\windows”或“cmd /c dir c:\windows & exit”等命令，cmd.exe 将永远不会终止。通过命令提示符启动的任一命令都将按预期终止。有谁知道为什么它在通过 CreateProcess 启动时永远不会终止？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:38:30.043

显然，我必须开始读取循环中的 stdout/stderr 管道，该管道检查进程是否仍在运行，并在进程终止后读取它。而不是在进程终止后阅读它。非常感谢 Wimmel 发布答案。

# objective-c - 当 ParseKit 尝试识别我的语法时，它会进入无限循环。怎么了？

> ID：13866165
> 
> 赞同：1
> 
> 时间：2012-12-13T18:31:52.083
> 
> 标签：objective-c, parsekit

嗨，我正在为一些使用递归的公式创建语法。这个公式要复杂得多，但现在我只测试它的一部分。调用 parse 方法后，它在 allMatchesFor 方法上崩溃。堆栈跟踪充满了 allMatchesFor 调用，因此看起来它处于无限循环中，问题出在哪里。是在我的语法构造逻辑中还是在其他方面？我怎样才能完成类似的事情以避免这种崩溃

我的语法是这样的：   

```
@start = formula;
formula = valueTypeResult;
valueTypeResult = (value | concept | arithmeticStatement);
arithmeticStatement = valueTypeResult (arithmeticOperator valueTypeResult)+;
value = 'V';
concept = 'C';
arithmeticOperator = 'A'; 
```

你能告诉我如何创建使用递归的语法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T07:23:37.540

[ParseKit](http://parsekit.com)的开发者在这里。

ParseKit 的递归没有问题，但是你的语法不正确。这更像是一个 BNF 语法问题而不是 ParseKit 问题。

这是我认为您正在尝试使用上述语法的正确版本：

```
@start = formula;
formula = arithmeticStatement;
arithmeticStatement = valueTypeResult (arithmeticOperator valueTypeResult)+;
valueTypeResult = (value | concept);
value = 'V';
concept = 'C';
arithmeticOperator = 'A'; 
```

# imagemapster - imagemapster IE9 未在热点上呈现悬停

> ID：13866168
> 
> 赞同：0
> 
> 时间：2012-12-13T18:31:58.217
> 
> 标签：imagemapster

我检查了所有其他与 ie9 相关的线程，但似乎无法解决我的问题。在 IE9 中，我的热点都没有悬停。它适用于所有其他浏览器。

我处于 IE9 标准模式。我正在使用 doctype HTML5。代码中的任何内容都没有对我产生影响。

有什么建议么？

链接已删除

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:13:12.087

中的代码在`main.js`Internet Explorer 中引发异常。失败时，mapster 配置永远不会运行。

```
$(document).ready(function() {

Site.init();

if (($.browser.msie) && ($.browser.version <= "9.0")) {

        $('input[placeholder], textarea[placeholder]').placeholder(); 
```

SCRIPT438：对象不支持属性或方法“占位符”

一般来说，要在 IE 中进行故障排除，只需按 F12 并单击“开始调试”即可。如果脚本失败，它将立即显而易见。

# php - PHP/MySQL 字段/列位标志：UNIQUE_KEY_FLAG 与 UNIQUE_FLAG

> ID：13866170
> 
> 赞同：2
> 
> 时间：2012-12-13T18:32:02.273
> 
> 标签：php, mysql, bitflags

在 PHP 中，当从 MySQL 列/字段中提取位标志时，我看到（来自其他 SO 答案）：

```
UNIQUE_KEY_FLAG = 4
UNIQUE_FLAG = 65536 
```

我想知道这两个位标志之间有什么区别？

为什么我找到的列表同时显示 NUM_FLAG 和 GROUP_FLAG = 32768？

我还想知道为什么我似乎无法在 php.net 或 mysql.com (Oracle) 上找到有关字段/列位标志的完整列表的任何信息。SO答案中的少数列表似乎错过了位标志＃8，即“MULTIPLE_KEY_FLAG”（我确实找到了一个确实显示了这一点的SO答案），并且其他一些条目似乎也缺少，例如4096和8192。但是在找到这些位标志的完整列表时，我希望能够揭示每个位标志的描述性答案......我只能猜测我的互联网搜索能力一定会变老。

# java - SoapRequest 作为 xml 字符串

> ID：13866178
> 
> 赞同：0
> 
> 时间：2012-12-13T18:32:42.863
> 
> 标签：java, android, xml, web-services, ksoap2

我一直在开发 Android 应用程序并调用 WCF C# Web 服务。我可以正确调用其中一种方法，但在调用另一种方法时遇到问题。只是为了确保它有效，有什么方法可以使用 KSoap2 使用 XML 请求（我知道这是 Web 服务需要的 XML 请求）？也就是说，我是否可以将 XML 请求用作字符串并将其设置为参数，以便将该字符串请求传递给 Web 服务，以查看是否可以通过 Web 服务将数据添加到数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T18:21:48.910

对于任何有兴趣的人，以下帖子帮助我解决了问题

[http://mobileorchard.com/android-app-development-calling-web-services/](http://mobileorchard.com/android-app-development-calling-web-services/)

# jquery - jQuery，切换（）

> ID：13866181
> 
> 赞同：0
> 
> 时间：2012-12-13T18:32:46.550
> 
> 标签：jquery, hide, toggle, show

我的页面有动态 div，在其中我想在两个 div 之间切换。我需要保留 div 的原始值，所以这可能是错误的方法

到目前为止，这是我的代码，我似乎无法启动它。

```
$(".change").live("click", function() {
  var changeDiv = $(this).parents(".changeContainer").find(".changeDiv");
  changeDiv.toggle();
  changeDiv.html(changeDiv.html() == '<input type='text' />' ? 'Original Value of the DIV' : '<input type='text' />');
}

<div class="changeContainer">
   <div class="changeDiv">Basketball - <a href="#" class="change">Change Sport</a>   </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:01:17.130

而不是切换，只需使用标准显示/隐藏。放入两个 div，让其中一个开始，`style="display:hidden"`然后在适当的 div 上使用 jquery .hide() 和 .show() 在它们之间进行交换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:00:42.367

也许你应该更符合

```
$(".change").live("click", function() {
  var changeDiv = $(this).parents(".changeContainer").find(".changeDiv");

  if(changeDiv.hasClass('orig') {
       orig_html = changeDiv.html();
       changeDiv.html('<input type='text' />');
  else
       changeDiv.html(orig_html);
  }
  changeDiv.toggleClass('orig');
} 
```

并有一个全局变量 orig_html；请注意，我没有测试代码。

# proxy - Paros 代理在监控开放站点时请求 HTTP 身份验证

> ID：13866187
> 
> 赞同：1
> 
> 时间：2012-12-13T18:33:08.327
> 
> 标签：proxy

我正在使用 Paros 代理来检查和监控我的网站。该站点没有任何基于 HTTP 的身份验证，但在通过 paros 代理运行时，它显示“http://XYZ.com 正在请求用户名和密码[。](http://XYZ.com)该站点显示：“XDB”“我尝试了几种不同的paros 设置和站点，但它向我展示了同样的事情。paros 似乎有一些默认的 HTTP 身份验证凭据。我也尝试在 config.xml 中输入登录凭据，但没有成功。任何帮助请...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T11:19:57.477

Paros 已经很多年没有更新了。

尝试使用 OWASP ZAP：[https ://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project](https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project)

它是 Paros 的一个分支，但功能更多，并且正在积极维护。

西蒙（ZAP 项目负责人）

# php - 防止在 PHP 输出左连接中显示重复记录

> ID：13866190
> 
> 赞同：0
> 
> 时间：2012-12-13T18:33:18.710
> 
> 标签：php, mysql, duplicates, left-join, duplicate-removal

所以我有两个表（`l_user`包含我的用户列表并`l_online`显示当前登录的用户）。我想输出得分最多的人的列表，并显示他们是否在线（当前登录到该站点）。

我使用 aa Left Join 将这两个表放在一起。

```
select l_user.id, l_user.firstname, l_user.point, l_online.* from l_user LEFT JOIN l_online ON l_online.user_id = l_user.id order by l_user.point desc 
```

使用下面的代码，我可以显示此查询的结果。

```
<p> <?php $cl = get_leaderboardonline(); ?>
<ul class="lists">
    <?php $i = 1; ?>
    <?php foreach ($cl as $l) :
        ?>
        <?php if (count($l['username'])) : ?>
            <li>
                <?php echo $i; ?>. <?php echo $l['firstname']; ?> - <?php echo number_format($l['point']); ?> pts 
                <?php if ($l['username'] != NULL) : ?>
                    <span style="color:green;">ONLINE</span>
                <?php endif; ?>
            </li>
            <?php $i++; ?>
        <?php endif; ?>
    <?php endforeach; ?> 
```

输出如下所示：

1.) 凯文 - 100 分在线

2.) 凯文 - 在线 100 分

3.) 约翰 - 75 分

4.) 标记 - 50 分在线

5.) 杰里米 - 在线 5 分

6.) 杰里米 - 在线 5 分

7.) 艾米 - 0 分

8.) Deb - 0 分

**我的问题是，如果用户从两个不同的设备或 IP 地址登录，它们被放置在 l_online 表中两次，所以当我执行 LEFT JOIN 时，它会在最终输出中两次引入用户，PHP 中有没有一种方法可以告诉它只显示用户一次，而不是 2 Kevin's，2 Jeremys。**

我希望它看起来像这样：

1.) 凯文 - 100 分在线

2.) 约翰 - 75 分

3.) 标记 - 50 分在线

4.) 杰里米 - 在线 5 分

5.) 艾米 - 0 分

6.) Deb - 0 分

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:35:53.997

采用`group by l_user.id`

```
select l_user.id, l_user.firstname, l_user.point, l_online.* from l_user LEFT JOIN l_online ON l_online.user_id = l_user.id group by l_user.id order by l_user.point desc 
```

# entity-framework - 实体框架是否支持 SQLClient 连接字符串中的 ApplicationIntent=ReadOnly

> ID：13866193
> 
> 赞同：2
> 
> 时间：2012-12-13T18:33:32.397
> 
> 标签：entity-framework, sql-server-2012

实体框架是否支持SQLClient 连接字符串中的[ApplicationIntent=ReadOnly ？](http://msdn.microsoft.com/en-us/library/hh205662.aspx)它是指对[AlwaysOn 可用性组 (SQL Server 2012)](http://msdn.microsoft.com/en-us/library/hh510230.aspx)的可用性副本功能的[只读访问](http://msdn.microsoft.com/en-us/library/hh510184.aspx)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-20T18:17:56.367

到目前为止，我发现的唯一方法是直接使用连接字符串创建上下文，而不是使用连接字符串名称。这样你就可以附加`ApplicationIntent`.

```
string connectionString = string.Format("{0}; ApplicationIntent=READONLY", ConfigurationManager.ConnectionStrings["AppContext"].ConnectionString);

using (AppContext context = new AppContext(connectionString))
{
    var q = from row in context.table
            select row.id;
} 
```

# android - 如何同时使用框架方法和支持库的方法

> ID：13866195
> 
> 赞同：1
> 
> 时间：2012-12-13T18:33:35.420
> 
> 标签：android, compatibility, android-support-library

我正在我的应用程序中实现片段。为了保持与低于 Honeycomb 的 Android 版本兼容，我使用了支持库。但我想知道，Android 是否如此智能，以至于当应用程序在 Honeycomb 或更高版本上运行时，它会使用正确的框架方法更改支持库方法？如果没有，有没有办法使用低版本的支持库方法和高版本的框架方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:53:40.247

支持库只不过是原始框架，它向后兼容旧版本的 Android。旧框架上没有可用的新 API，因此它总是比较应用程序运行的当前 Android 版本，并根据该版本使用自定义实现或本机实现。支持库的示例：

```
final int version = android.os.Build.VERSION.SDK_INT;
        if (version >= 17) {
            IMPL = new JbMr1ViewCompatImpl();
        } else if (version >= 16) {
            IMPL = new JBViewCompatImpl();
        } else if (version >= 14) {
            IMPL = new ICSViewCompatImpl();
        } else if (version >= 11) {
            IMPL = new HCViewCompatImpl();
        } else if (version >= 9) {
            IMPL = new GBViewCompatImpl();
        } else {
            IMPL = new BaseViewCompatImpl();
        } 
```

支持库经过定制，以补偿每个 Android 版本缺少的 API，如您在此屏幕截图中所见：

![在此处输入图像描述](../Images/016b5001766748201341b105ba3dd271.png)

您可以在 Github 上找到镜像的支持库的源代码： [https ://github.com/android/platform_frameworks_support](https://github.com/android/platform_frameworks_support)

# objective-c - 如何将一个 UIDatePicker 用于多个 UITextField？

> ID：13866196
> 
> 赞同：2
> 
> 时间：2012-12-13T18:33:39.803
> 
> 标签：objective-c, uitextfield, uidatepicker, inputview

在我的`viewDidLoad`我有以下代码：

```
UIDatePicker* datePicker = [[UIDatePicker alloc] init];
datePicker.datePickerMode = UIDatePickerModeDate;
[datePicker addTarget:self action:@selector(datePickerChanged:) forControlEvents:UIControlEventValueChanged];
dateField1.inputView = datePicker;
dateField2.inputView = datePicker;
dateField3.inputView = datePicker;
dateField4.inputView = datePicker; 
```

（dateField 都是`UITextField`s）

在我的`-(void)datePickerChanged:(UIDatePicker*)datePicker` 方法中，如何知道正在编辑哪个 dateField，以便填写选择的日期？

目前我正在为每个 UITextField 使用一个新的 UIDatePicker，但我希望有一个更优雅的解决方案来解决这种情况。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-14T05:41:41.623

```
if([textField1 isFirstResponder]) {

}
else if[textField2 isFirstResponder]){

}

...etc... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:43:36.857

您可以为您的 dateFields 设置不同的标签，并检查 datePickerChanged: 方法中更改了哪些字段。但要做到这一点，您应该将原始结果存储在另一个地方（例如在您的日期字段标签将成为键的字典中）。我以前没有尝试过，但应该可以。

# servicestack - ServiceStack - 请求绑定 JSON 编码参数

> ID：13866198
> 
> 赞同：2
> 
> 时间：2012-12-13T18:33:58.293
> 
> 标签：servicestack

我有一个现有的应用程序，它发送一个带有名为“过滤器”的参数的请求。'filters' 参数包含一个 JSON 编码的字符串。例子：

```
[{"dataIndex":"fieldName", "value":"fieldValue"}, {"dataIndex":"field2", "value":"value2"}]. 
```

使用 ServiceStack，我想将它绑定为 C# 对象（网格类）上的属性。**有没有首选的方法来处理这个？**以下是我能想到的选项。我不认为“感觉”是正确的。

**选项 1：** 我确实有一个“ServiceModel”项目，这会创建一个我不太喜欢的依赖项。
在 AppHost.Configure() 方法中添加

```
RequestBinders[typeof(Grid)] => httpReq => { 
  return new Grid() { 
    Filters = new ServiceStack.Text.JsonSerializer<IList<Filter>>().DeserializeFromString(httpReq.QueryString["filters"])
  }
} 
```

**选项2：** 似乎有点“hacky”

```
public class Grid
{
  private string _filters;
  public dynamic Filters { 
    get 
    {
      ServiceStack.Text.JsonSerializer<IList<Filter().DeserializeFromString(_filters);
    }
    set
    {
      _filters = value;
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:07:58.453

您可以使用[JSV 格式](https://github.com/ServiceStack/ServiceStack.Text/wiki/JSV-Format)[在 ServiceStack 中发送复杂对象](https://github.com/ServiceStack/ServiceStack/wiki/Serialization-deserialization)。

如果您想通过 QueryString 发送 JSON，您可以从您的请求服务过滤器内部访问它，例如：

```
public object Any(Request req) {
    var filters = base.Request.QueryString["Filters"].FromJson<List<Filter>>();
} 
```

注意：[DTO 上的接口是不好的做法](https://stackoverflow.com/a/10759250/85785)。

# python - 在同一个脚本上广播服务器和客户端？

> ID：13866203
> 
> 赞同：0
> 
> 时间：2012-12-13T18:34:15.007
> 
> 标签：python, sockets, raspberry-pi

我有以下脚本：

```
import socket
import sys
import traceback
msg = socket.gethostbyname(socket.gethostname())
dest = ('<broadcast>',10100)
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1)
s.sendto(msg, dest)
print "Sent."
while 1:
    (buf,address)=s.recvfrom(10100)
    if not len(buf):
        break
    print "Received from %s: %s" %(address, buf) 
```

进而：

```
import socket
import traceback
import os
host = ''
port = 10100
sx = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sx.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
sx.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1)
sx.bind((host,port))
while 1:
    try:
        message, address = sx.recvfrom(10104)
        print "Got data from", address
        sx.sendto("ola",address)
    except (KeyboardInterrupt, SystemExit):
        raise
    except:
        traceback.print_exc() 
```

我在将它们都放在同一个脚本上时遇到了一些麻烦。
我只是想了解更多关于套接字等的知识，这没什么特别的。
我的想法是在每台机器（Raspberry Pi）中只有一个脚本，只要它们在同一个网络上，一个人就会知道另一个人的存在。
希望我解释得对。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:48:17.327

您可以在同一个套接字上发送和接收，不需要第二个。使用诸如[`select`](http://docs.python.org/2/library/select.html)超时之类的东西来等待其他人与您联系，在超时到期时广播以让其他人了解您自己（您可能希望保留下一次广播的时间，这样您就不会在收到广播时丢失广播时间表一个数据报）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T15:03:06.797

感谢所有的帮助。我找到了这两个链接。第一个真的很棒，很简单，并且可以按需要工作。可以帮助别人： [http ://www.cs.bilgi.edu.tr/~mgencer/Ders%20Malzemeleri/IThingTaggedFile/p2p.py](http://www.cs.bilgi.edu.tr/~mgencer/Ders%20Malzemeleri/IThingTaggedFile/p2p.py)

[https://github.com/zetaron/python-udp-p2p](https://github.com/zetaron/python-udp-p2p)

# c++ - QT4没有这样的插槽错误

> ID：13866206
> 
> 赞同：0
> 
> 时间：2012-12-13T18:34:47.053
> 
> 标签：c++, netbeans, qt4, signals-slots

我知道有很多相同的问题，但没有一个对我有帮助：

```
class Form1 : public QMainWindow {
    Q_OBJECT
public:
    Form1();
    virtual ~Form1();
public slots:
    void langChange(const char* lang_label);
private:
    Ui::Form1 widget;
    void setLangStrings();
}; 
```

From1 构造函数：

```
Form1::Form1() {
    widget.setupUi(this);
    connect(widget.btnL0, SIGNAL(clicked(bool)), this, SLOT(langChange("en")));
    connect(widget.btnL1, SIGNAL(clicked(bool)), this, SLOT(langChange("fr")));
    setLangStrings();
} 
```

我也实现了这个 langChange 函数：

```
void Form1::langChange(const char* lang_label)
{
    GL_LANG = lang_label;
    setLangStrings();
} 
```

**调用连接函数时出现这个愚蠢的错误：**

```
No such slot Form1::langChange("sl") in Form1.cpp:15 
```

我将 NetBeans 与 QDesigner 一起用于 UI。我必须说这个QT4非常难学。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T18:47:32.130

您根本无法将 SIGNAL 与 bool 作为参数连接到 SLOT 与 const char* 作为参数。要执行此类操作，您必须使用[QSignalMapper](http://qt-project.org/doc/qt-4.8/qsignalmapper.html)。您有一个如何在文档中使用它的示例。在您的情况下，它非常简单，因此您应该轻松处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:47:58.350

SLOT 函数必须具有与 SIGNAL 函数相同的签名

**编辑：**来自官方 Qt 文档（http://qt-project.org/doc/qt-4.8/signalsandslots.html）：

> 信号的签名必须与接收时隙的签名相匹配。（事实上​​，一个槽的签名可能比它接收到的信号更短，因为它可以忽略额外的参数。）

# image - 过滤掉小于特定长度的行

> ID：13866208
> 
> 赞同：1
> 
> 时间：2012-12-13T18:34:55.950
> 
> 标签：image, image-processing, feature-detection, edge-detection

如附图所示[仅用于澄清]，有三排随机长度的线。我想删除比恒定 N 像素短的线。

假设：

1.  行都在行中
2.  线条宽度为 1 像素
3.  线可以连接到边界。

我正在寻找任何可以帮助我的想法/指南。谢谢。![在此处输入图像描述](../Images/b11cf5d6e53b2aa8d3f36db288a4da4b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T20:25:55.483

跳过直接处理底层图像的二进制表示的可能性，从而允许对这个特定任务进行非常快速的实现，让我们使用数学形态学来（有效地）解决它。

你需要的只是一个具有水平长度线的侵蚀，`n`然后是形态重建。前者将完全删除长度小于 < 的行`n`。后者将完全恢复未被删除的侵蚀线。

这是一个例子`n = 25`。我使用`ones(1, 25)`而不是`strel('line', 25, 0)`作为结构元素，因为后者不能保证实际的行长是指定的。

```
f = im2bw(imread('http://i.stack.imgur.com/1Uw0x.png'), 0);
g = imerode(f, strel('arbitrary', ones(1, 25)));
h = imreconstruct(g, f); 
```

侵蚀和重建的图像：

![在此处输入图像描述](../Images/1b558e5dd4eae4e2fddd73cc83e7a2a1.png) ![在此处输入图像描述](../Images/f3673e6d78f0ee7c3272268bae8f6347.png)

# algorithm - 与特定数字组的莱文斯坦距离

> ID：13866211
> 
> 赞同：5
> 
> 时间：2012-12-13T18:35:02.043
> 
> 标签：algorithm

我的输入是三个数字 - 一个数字和一个范围`s`的开头`b`和结尾。任务是找到range 和所有数字之间的最小 Levenstein 距离。不需要找到最小化距离的数字，最小距离就足够了。`e``0 <= s,b,e <= 10^1000``s``[b, e]`

显然我必须将数字读取为字符串，因为标准 C++ 类型无法处理如此大的数字。为可能很大范围内的每个数字计算 Levenstein 距离是不可行的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:32:54.400

**[编辑 10/8/2013：DP 算法中考虑的某些情况实际上根本不需要考虑，尽管考虑它们不会导致错误:)]**

在下文中，我描述了一个需要 O(N^2) 时间的算法，其中 N 是b、e 或 s 中的最大**位数。**由于所有这些数字都限制为 1000 位，这意味着最多有几百万个基本操作，这在任何现代 CPU 上都需要**几毫秒。**

假设 s 有 n 个数字。在下文中，“之间”是指“包容”；如果我的意思是“排除它的端点”，我会说“严格介于”。指数以 1 为基础。x[i] 表示 x 的第 i 个数字，例如 x[1] 是它的第一个数字。

## 拆分问题

首先要做的是将问题分解为一系列子问题，其中每个 b 和 e 具有相同的位数。假设 e 的位数比 s 多 k >= 0：将问题分解为 k+1 个子问题。例如，如果 b = 5 和 e = 14032，则创建以下子问题：

*   b = 5, e = 9
*   b = 10，e = 99
*   b = 100，e = 999
*   b = 1000，e = 9999
*   b = 10000，e = 14032

我们可以解决这些子问题中的每一个，并采取最小解决方案。

## 简单的案例：中间

简单的案例是中间的案例。每当 e 的位数比 b 多 k >= 1 时，就会有 k-1 个子问题（例如上面的 3 个），其中 b 是 10 的幂，e 是 10 的下一个幂，减 1。假设 b 是 10^m . 请注意，选择 1 和 9 之间的任何数字，然后选择 0 和 9 之间的任何 m 个数字，会产生一个范围为 b <= x <= e 的数字 x。此外，在这个范围内没有数字不能以这种方式产生。s（或者实际上任何给定的长度为 n 的不以 0 开头的数字字符串）和*任何之间的最小 Levenshtein 距离*10^m <= x <= 10^(m+1)-1 范围内的数字 x 必然是 abs(m+1-n)，因为如果 m+1 >= n 可以简单地选择前 n 位x 与 s 中的相同，并删除余数，如果 m+1 < n 则选择第一个 m+1 与 s 中的相同并插入余数。

**事实上，我们可以在单个恒定时间操作中处理*所有***这些子问题：如果最小的“简单”子问题有 b = 10^m，而最大的“简单”子问题有 b = 10^u，那么最小的 Levenshtein 距离如果 n < m，则为 mn，如果 n > u，则为 nu，否则为 0。

## 困难的情况：结束

困难的情况是 b 和 e 不限于分别具有 b = 10^m 和 e = 10^(m+1)-1 的形式。任何主问题最多可以产生两个这样的子问题：两个“结束”（由 b 和 e 具有不同位数的主问题产生，例如顶部的示例）或单个子问题（即主问题）问题本身，根本不需要细分，因为 b 和 e 已经有相同的位数）。请注意，由于前面对问题的拆分，我们可以假设子问题的 b 和 e 具有相同的位数，我们将其称为 m。

## 超级Levenshtein！

我们要做的是设计 Levenshtein DP 矩阵的变体，它计算给定数字字符串 (s) 与范围 b <= x <= e 内的*任何数字 x 之间的最小 Levenshtein 距离。*尽管增加了“力量”，但该算法仍将在 O(n^2) 时间内运行 :)

首先，观察如果 b 和 e 具有相同的位数并且 b != e，那么它们一定是由一些数字 q >= 0 的左侧相同数字组成，然后是一个更大的数字在 e 中比在 b 中。现在考虑以下生成随机数字字符串 x 的过程：

1.  将 x 设置为 b 的前 q 个数字。
2.  将 b[i] 和 e[i] 之间随机选择的数字 d 附加到 x。
3.  如果 d == b[i]，我们“拥抱”下界：
    *   对于从 q+1 到 m 的 i：
        *   如果 b[i] == 9 则附加 b[i]。 **[编辑 2013 年 10 月 8 日：实际上这不可能发生，因为我们选择了 q，因此 e[i] 将大于 b[i]，并且没有大于 9 的数字！]**
        *   否则，掷硬币：
            *   头：附加 b[i]。
            *   尾部：附加一个随机选择的数字 d > b[i]，然后转到 6。
    *   停止。
4.  否则，如果 d == e[i]，我们“拥抱”上限：
    *   对于从 q+1 到 m 的 i：
        *   如果 e[i] == 0 则附加 e[i]。 **[编辑 10/8/2013：实际上这不可能发生，因为我们选择了 q，因此 b[i] 将小于 e[i]，并且没有小于 0 的数字！]**
        *   否则，掷硬币：
            *   头：附加 e[i]。
            *   尾部：附加一个随机选择的数字 d < e[i]，然后转到 6。
    *   停止。
5.  否则（如果 d 严格介于 b[i] 和 e[i] 之间），则跳至步骤 6。
6.  继续将随机选择的数字附加到 x 直到它有 m 个数字。

基本思想是，在包含所有必须包含的数字之后，您可以“拥抱”下界的数字，只要您愿意，或者只要您愿意，就可以“拥抱”上限的数字，并且尽快当你决定停止“拥抱”时，你可以选择任何你想要的数字。对于合适的随机选择，此过程将生成所有且仅生成满足 b <= x <= e 的数字 x。

在长度分别为 n 和 m 的两个字符串 s 和 x 之间的“通常”Levenshtein 距离计算中，我们有一个从 (0, 0) 到 (n, m) 的矩形网格，并且在每个网格点 (i, j)我们记录前缀 s[1..i] 和前缀 x[1..j] 之间的 Levenshtein 距离。(i, j) 处的分数是使用自下而上的动态规划从 (i-1, j)、(i, j-1) 和 (i-1, j-1) 处的分数计算得出的。为了适应这一点，将 x 视为*一组可能的字符串之一*（特别是对应于 b 和 e 之间的数字的数字字符串）而不是特定的给定字符串，我们需要做的不是为每个网格点记录一个而是两个分数：一个用于我们假设数字位于位置 j 被选择拥抱下限，而我们假设它被选择拥抱上限。第三种可能性（上面的第 5 步）实际上不需要 DP 矩阵中的空间，因为我们可以立即计算出整个其余输入字符串的最小 Levenshtein 距离，这与我们为“简单“第一节中的子问题。

## 超级Levenshtein DP递归

调用网格点 (i, j) v(i, j) 处的总体最低分数。如果字符 a 和 b 不同，则令 diff(a, b) = 1，否则为 0。如果字符 a 在 b..c 范围内，则 inrange(a, b..c) 为 1，否则为 0。计算如下：

```
# The best Lev distance overall between s[1..i] and x[1..j]
v(i, j) = min(hb(i, j), he(i, j))

# The best Lev distance between s[1..i] and x[1..j] obtainable by
# continuing to hug the lower bound
hb(i, j) = min(hb(i-1, j)+1, hb(i, j-1)+1, hb(i-1, j-1)+diff(s[i], b[j]))

# The best Lev distance between s[1..i] and x[1..j] obtainable by
# continuing to hug the upper bound
he(i, j) = min(he(i-1, j)+1, he(i, j-1)+1, he(i-1, j-1)+diff(s[i], e[j])) 
```

在计算 v(i, j) 的时间点，我们还将计算由于选择“停止拥抱”而产生的 Levenshtein 距离，即通过选择严格介于 b[j] 和 e[j 之间的数字] (if j == q) 或 (if j != q) 要么高于 b[j] 要么低于 e[j]，然后自由选择数字以使 x 的后缀与 s 的后缀尽可能匹配：

```
# The best Lev distance possible between the ENTIRE STRINGS s and x, given that
# we choose to stop hugging at the jth digit of x, and have optimally aligned
# the first i digits of s to these j digits
sh(i, j) = if j >= q then shc(i, j)+abs(n-i-m+j)
           else infinity

shc(i, j) = if j == q then
              min(hb(i, j-1)+1, hb(i-1, j-1)+inrange(s[i], (b[j]+1)..(e[j]-1)))
            else
              min(hb(i, j-1)+1, hb(i-1, j-1)+inrange(s[i], (b[j]+1)..9),
                  he(i, j-1)+1, he(i-1, j-1)+inrange(s[i], (0..(e[j]-1))) 
```

shc(i, j) 的公式不需要考虑“向下”移动，因为此类移动不涉及 x 的任何数字选择。

对于所有 0 <= i <= n 和 0 <= j <= m，整体最小 Levenshtein 距离是 v(n, m) 和 sh(i, j) 的最小值。

## 复杂

取 N 为 s、b 或 e 中的最大位数。原始问题可以在线性时间内最多拆分为一组简单问题，这些问题总共需要 O(1) 时间来解决，以及 2 个困难子问题，每个问题需要 O(N^2) 时间来解决，使用超级 Levenshtein 算法，所以总的来说这个问题可以在 O(N^2) 时间内解决，即时间与位数的平方成正比。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T22:21:47.540

加速计算的第一个想法（如果`|e-b|`不是太大也可以）：

*   问题：当我们与比较`s`时，Levestein 距离可以改变多少？`n``n+1`

*   答：不要太多！

`s = 12007`让我们看看两个连续的动态规划表`n`

```
n = 12296

0 1 2 3 4 5 
1 0 1 2 3 4 
2 1 0 1 2 3 
3 2 1 1 2 3 
4 3 2 2 2 3 
5 4 3 3 3 3 
```

和

```
n = 12297

0 1 2 3 4 5 
1 0 1 2 3 4 
2 1 0 1 2 3 
3 2 1 1 2 3 
4 3 2 2 2 3 
5 4 3 3 3 2 
```

如您所见，**只有最后一列发生变化**，因为`n`和`n+1`具有相同的数字，除了最后一个。

`s = 12001`如果你有和的编辑距离的动态规划表`n = 12296`，你已经有了 的表`n = 12297`，你只需要更新最后一列！

显然，如果`n = 12299`那时`n+1 = 12300`并且您需要更新上表的最后 3 列.. 但这每 100 次迭代只会发生一次。

一般来说，你必须

*   更新每次迭代的最后一列（因此，长度单元格）
*   也更新倒数第二个，每 10 次迭代一次
*   每 100 次迭代也更新倒数第三个

所以让`L = length(s)`和`D = e-b`。`s`首先计算和之间的编辑距离`b`。`[b,e]`然后，您可以在区间中的每个整数上循环找到最小 Levenstein 距离。它们有`D`，所以执行时间大约是：

![在此处输入图像描述](../Images/2d51f7e6f2a85b68ac7acfe92a6ffce1.png)

现在自从

![在此处输入图像描述](../Images/a7894590e08c7eabc375778daa072c32.png)

我们有一个算法

![在此处输入图像描述](../Images/b781e370b5c5add761fb46ec0aba4f79.png)

# macos - 使用 Excel 在气泡图的每个气泡内绘制饼图？

> ID：13866212
> 
> 赞同：1
> 
> 时间：2012-12-13T18:35:06.170
> 
> 标签：macos, excel, plot, pie-chart, bubble-chart

-Mac 的办公室。我有以下气泡图：

![在此处输入图像描述](../Images/723c8f7b1605f30f69d80ff772719130.png)

我想在每个气泡中插入一个小饼图来表示特定值。这怎么可能通过 Excel 实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T02:37:30.297

您可以使用的基本方法是为每个气泡创建饼图，修改饼图的格式以从视图中消除除饼图之外的所有内容（关闭边框、任何文本标签、背景等），然后调整大小并覆盖馅饼在相应的气泡上。完成所有气泡后，您可能希望将所有元素组合在一起以避免覆盖层的无意错位。

# java - java中的自定义长度唯一密码

> ID：13866219
> 
> 赞同：1
> 
> 时间：2012-12-13T18:35:28.623
> 
> 标签：java, random, passwords, password-generator

> **可能重复：**
> [创建唯一的 10 个字母数字字符串](https://stackoverflow.com/questions/467444/creating-a-unique-alphanumeric-10-character-string)

我需要生成唯一的随机密码。
所以我想做类似的事情，`MD5(counter+a_random_string+timeInMills)`但这有 32 个字符的输出。
我需要一个 8 个字符的密码。
如何生成**唯一的**自定义长度的人类可读密码？

更新：
我每次生成 N 个（少于 30 个）密码，我需要这些 N 个密码是非冗余的。对独特性的需求不是绝对的。还检查生成的密码是否有重复值并重新生成它可能会导致无限循环

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:55:46.687

这是一个想法：使用[`java.util.UUID`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/UUID.html)类。

UUID 类提供了一个静态工厂方法来生成伪随机生成的 UUID。

您可以将 UUID 转换为字符串。

不要忘记，如果你想保证唯一性，你不能截断/子串 UUID 的值：

MSDN 上的文章：[GUID 是全局唯一的，但 GUID 的子字符串不是](http://blogs.msdn.com/b/oldnewthing/archive/2008/06/27/8659071.aspx).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:57:10.270

假设字母表由大写/小写、数字和 32 个特殊字符（总共 98 个）组成，则有 98 ⁸个可能性或大约 8.5x10 ^(15)。如果您想要“唯一”随机密码，因为您不会在没有首先用尽所有可能性的情况下两次生成相同的密码，那么只有两种选择：

1.  随机生成密码。跟踪所有以前生成的密码，如果发生冲突，请重试……起泡、冲洗、重复。
2.  使用循环伪随机数生成器，即保证选择*看起来*随机但在使用所有值之前不会重复的值。

第二种选择不太安全，因为如果有人确定算法，那么他们可以在给定一个密码的情况下预测下一个密码（和整个序列）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T18:49:05.067

保证随机生成的字符串唯一性的蛮力方法是存储所有字符串并在碰撞时重新生成：

```
protected Collection<String> generatedPasswords = new HashSet<String>();
public String generatePassword(int length) {
  String password = null;
  do {
    StringBuilder buf = new StringBuilder();
    // Append "length" random password characters to "buf".
    password = buf.toString();
  } while (this.generatedPasswords.contains(password));
  return password;
} 
```

但是，如果您只是想为最终用户生成“合理的”随机密码，并且偶尔（非常罕见）的冲突可以接受，那么您可以简单地获取 MD5 方案的前 N ​​个字符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T18:57:05.450

我为我创建了一个随机字符串/密码生成器程序，希望这也对你有用。

```
public class RandomStringGenerator{

    private static int randomStringLength = 25 ;
    private static boolean allowSpecialCharacters = true ;
    private static String specialCharacters = "!@$%*-_+:";
    private static boolean allowDuplicates = false ;

    private static boolean isAlphanum = false;
    private static boolean isNumeric = false;
    private static boolean isAlpha = false;
    private static final String alphabet = "abcdefghijklmnopqrstuvwxyz";
    private static boolean mixCase = false;
    private static final String capAlpha = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    private static final String num = "0123456789";

    public static String getRandomString() {
        String returnVal = "";
        int specialCharactersCount = 0;
        int maxspecialCharacters = randomStringLength/4;

        try {
            StringBuffer values = buildList();
            for (int inx = 0; inx < randomStringLength; inx++) {
                int selChar = (int) (Math.random() * (values.length() - 1));
                if (allowSpecialCharacters)
                {
                    if (specialCharacters.indexOf("" + values.charAt(selChar)) > -1)
                    {
                        specialCharactersCount ++;
                        if (specialCharactersCount > maxspecialCharacters)
                        {
                            while (specialCharacters.indexOf("" + values.charAt(selChar)) != -1)
                            {
                                selChar = (int) (Math.random() * (values.length() - 1));
                            }
                        }
                    }
                }
                returnVal += values.charAt(selChar);
                if (!allowDuplicates) {
                    values.deleteCharAt(selChar);
                }
            }
        } catch (Exception e) {
            returnVal = "Error While Processing Values";
        }
        return returnVal;
    }

    private static StringBuffer buildList() {
        StringBuffer list = new StringBuffer(0);
        if (isNumeric || isAlphanum) {
            list.append(num);
        }
        if (isAlpha || isAlphanum) {
            list.append(alphabet);
            if (mixCase) {
                list.append(capAlpha);
            }
        }
        if (allowSpecialCharacters)
        {
            list.append(specialCharacters);
        }
        int currLen = list.length();
        String returnVal = "";
        for (int inx = 0; inx < currLen; inx++) {
            int selChar = (int) (Math.random() * (list.length() - 1));
            returnVal += list.charAt(selChar);
            list.deleteCharAt(selChar);
        }
        list = new StringBuffer(returnVal);
        return list;
    }   

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T18:40:28.913

创建一个 char 数组并用随机字母填充它。

```
Random r = new Random();
char[] pass = new char[8];
for (int i = 0; i < pass.length; ++i)
{
    pass[i] = r.nextInt(26) + 'a';
}
String passStr = new String(pass); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-13T19:10:10.010

您可以使用任何简单的算法生成随机字符串（例如，请参阅解决方案：[How do I create a random alpha-numeric string in C++?](https://stackoverflow.com/questions/440133/how-do-i-create-a-random-alpha-numeric-string-in-c)）。然后您可以做的是保留一个 Set（或任何其他可以确保唯一性的数据结构）并继续将这些随机字符串插入其中，一旦达到您所需的限制，您就可以返回 Set。由于您需要的字符串数量非常少（~50），碰撞的机会也非常非常小，所以它应该非常有效。

# dynamics-crm-online - 如何调试在线版本的插件？

> ID：13866224
> 
> 赞同：0
> 
> 时间：2012-12-13T18:35:59.810
> 
> 标签：dynamics-crm-online

我创建了一个插件并使用 hte 注册工具注册了它。我还添加了一个步骤，该步骤应该处理*创建*实例的消息。可悲的是，预期的行为没有发生。

我的猜测是插件内部的某些东西崩溃了，但我不知道如何调试它。我理解，设置断点对在线版本不起作用，所以我什至没有尝试。

出于法律和技术原因，我也无法将解决方案转移到本地安装。猜我唯一的选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:39:59.693

对于服务器端（插件），我使用的是*ITracingService*。对于客户端，我将所有内容记录到控制台。第一个的缺点是您实际上需要使执行崩溃才能看到任何内容。后者的缺点是插件有时会在根本没有调用 GUI 的情况下执行。

当涉及到较重的项目时，我只需设置一个从插件调用并写入的 WCF Web 服务。这样，在一个屏幕上，我正在执行插件，而在另一个屏幕上，我得到了一个不错的日志文件（或者只是将发送的信息放在屏幕上）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:42:18.027

例如，您可以从对正在创建的实体实例上的字段进行非常基本的更新开始。当你有那个工作时，你总是可以回退到最后一个工作版本。如果您甚至无法使其正常工作，则可能意味着您错误地设置了插件注册。

一种非常有效的方法是将解决方案提升到您可以完全控制的本地版本，但我在您的问题中看到这不是一个选项。

如果您可以将解决方案提升到本地版本，[这里有一个](http://msdn.microsoft.com/en-us/library/gg328574.aspx)关于如何调试插件的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T07:53:06.170

不要忘记您也可以访问`ITracingService`.

您可以在您的`Execute`方法中获取对它的引用，然后在您的代码中经常写入它以记录您正在尝试或已成功执行的变量或操作过程。您还可以在发生异常时使用它来显示更有价值的信息。

这基本上就像写到控制台。然后，如果有任何事情导致插件在运行时崩溃，那么当您在向用户显示的错误上单击“*下载日志文件”时，您可以看到您跟踪的所有内容。*

但请注意 - 除非您的插件实际上**抛出**异常（故意或其他），否则您无法访问任何被跟踪的内容。

## 例子：

```
public void Execute(IServiceProvider serviceProvider)
{
  // Obtain the execution context from the service provider.
  IPluginExecutionContext context =
    (IPluginExecutionContext)serviceProvider.GetService(
      typeof(IPluginExecutionContext));

  // Get a reference to the tracing service.
  ITracingService tracingService = 
    (ITracingService)serviceProvider.GetService(typeof(ITracingService));

  try
  {
    tracingService.Trace("Getting entity from InputParameters...");
    // may fail for some messages, since "Target" is not present

    var myEntity =  (Entity)context.InputParameters["Target"];
    tracingService.Trace("Got entity OK");

    // some other logic here...
  }
  catch (FaultException<OrganizationServiceFault> ex)
  {
    _trace.Trace(ex.ToString());
    while (ex.InnerException != null)
    {
      ex = (FaultException<OrganizationServiceFault>)ex.InnerException;
      _trace.Trace(ex.ToString());
    }
    throw new InvalidPluginExecutionException(
      string.Format("An error occurred in your plugin: {0}", ex));
  }
catch (Exception ex)
{
  _trace.Trace(ex.ToString());
  while (ex.InnerException != null)
  {
    ex = ex.InnerException;
    _trace.Trace(ex.ToString());
  }
  throw;
}
} 
```

# soap - XSD 验证错误 - xml 命名空间问题

> ID：13866227
> 
> 赞同：0
> 
> 时间：2012-12-13T18:36:42.893
> 
> 标签：soap, xsd, xml-namespaces

我正在运行一个简单的 Web 服务，但在构建和验证响应时遇到问题。此问题与命名空间有关。

在我的 WSDL 中，我有：

```
 <wsdl:definitions targetNamespace="http://me.com/mystuff">
      <wsdl:types><xs:schema targetNamespace="http://me.com/mystuf">
          ....

        <xs:complexType name="MyResponse">
        <xs:all>
           <xs:element name="Value" type="xs:boolean"/>
            <xs:element name="ResponseString" type="xs:string"/>
        </xs:all>
      </wsdl:types>

      //MyResponse is bound as a response for a soap operation
     </wsdl:definitions> 
```

我首先尝试将响应构建为：

```
 String NAMESPACE_URI="http://me.com/mystuff";

    Namespace namespace = Namespace.getNamespace("xyz", NAMESPACE_URI);
    Element response = new Element(txType + "Response", namespace);

    Element value = new Element("Value");
    value.setText("true");
    response.addContent(value);

    Element responseString = new Element("ResponseString");
    response.addContent(responseString);
    responseString.setText(""); 
```

但我会得到：

```
 org.xml.sax.SAXException: Exception in startElement: NAMESPACE_ERR: An attempt  is made to create or change an object in a way which is incorrect with regard to namespaces. 
```

org.jdom.JDOMException：startElement 中的异常：NAMESPACE_ERR：尝试以不正确的命名空间方式创建或更改对象。

所以我在响应中的子元素中添加了命名空间声明：

```
 Element value = new Element("Value", namespace);
    Element responseString = new Element("ResponseString", namespace); 
```

但后来我得到：

```
 ERROR PayloadValidatingInterceptor:238 - XML validation error on response: cvc-complex-type.2.4.a: Invalid content was found starting with element 'xyz:Value'. One of '{Value, ResponseString}' is expected. 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T20:07:58.120

如果您控制架构，请添加`elementFormDefault="qualified"`到架构中的 xs:schema 元素；这应该使您现在生成的 Value 和 ResponseString 的命名空间限定版本有效。

如果您不控制架构，则 Value 和 ResponseString 元素不需要*是*命名空间限定的，这看起来就像您最初的尝试所做的那样；我看不出那里出了什么问题。如果您能找出具体是哪个语句引发了该错误，那将有所帮助。

# dynamics-crm-2011 - 如何使用 JavaScript 将 base64 文件保存到客户端？

> ID：13866232
> 
> 赞同：3
> 
> 时间：2012-12-13T18:36:51.603
> 
> 标签：dynamics-crm-2011, dynamics-crm, dynamics-crm-online

我从“注释”选项卡中得到了一定的结果。

您在 iframe 中看到的链接是文件的名称。

我从注释中获得了某种格式的 DocumentBody，看起来像 base64。

如何下载？

![将 base64 字符串作为文件保存到客户端](../Images/e377ec7d7756aaf9d7d67d776383a23d.png)

谢谢，法比奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T04:55:07.463

对这样的 URL 执行 JQuery 请求

```
Xrm.Page.context.getServerUrl() + "XRMServices/2011/OrganizationData.svc/ActivityMimeAttachmentSet(guid'abc...')?$select=Body" 
```

通过指定选择，您将只请求您想要的。

将结果分配给变量并预先添加

```
data:application/pdf;base64, 
```

从那里您可以将其内联显示为 HTML 对象，或尝试将其作为新窗口打开

```
window.location or window.open or document.location.href 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T10:08:40.990

我已经像这样提取了 base64 documentbody 字符串：

```
function getSla() {
    // Define SOAP message
    var objectId;
    if (typeof crmForm === "undefined") {
        objectId = parent.crmForm.ObjectId;
    }
    else {
        objectId = crmForm.ObjectId;
    }

    var xml =
        [
        "<?xml version='1.0' encoding='utf-8'?>",
        "<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" ",
        "xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" ",
        "xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">",
        GenerateAuthenticationHeader(),
        "<soap:Body>",
        "<RetrieveMultiple xmlns='http://schemas.microsoft.com/crm/2007/WebServices'>",
        "<query xmlns:q1='http://schemas.microsoft.com/crm/2006/Query' ",
        "xsi:type='q1:QueryExpression'>",
        "<q1:EntityName>annotation</q1:EntityName>",
        "<q1:ColumnSet xsi:type='q1:AllColumns' />",
        "<q1:Distinct>false</q1:Distinct><q1:Criteria><q1:FilterOperator>And</q1:FilterOperator>",
        "<q1:Conditions><q1:Condition><q1:AttributeName>objectid</q1:AttributeName><q1:Operator>Equal</q1:Operator>",
        "<q1:Values><q1:Value xsi:type=\"xsd:string\">",
        objectId,
        "</q1:Value></q1:Values></q1:Condition></q1:Conditions></q1:Criteria>",
        "</query>",
        "</RetrieveMultiple>",
        "</soap:Body>",
        "</soap:Envelope>"
        ].join("");
    var resultXml = executeSoapRequest("RetrieveMultiple", xml);

    var result = filter(resultXml.getElementsByTagName("q1:filename"), function (element) {
        return /master.*sla/i.test(element.text);
    });

    if (result.length == 0) {
        return null;
    }
    else {
        return result[0].parentNode;
    }
}

function getSlaDocumentBody(sla) {
    return sla.getElementsByTagName("q1:documentbody")[0].text;
}

window.open("data:application/pdf;base64," + getSlaDocumentBody(sla)); 
```

它在地址栏中打开了一个带有字符串 data:application/pdf .... 的新窗口，但什么也没做。我确实更喜欢这种解决方案。

最终在这里使用了 srasmussen 解决方案：http: [//social.microsoft.com/Forums/en/crm/thread/05134277-dd76-4fbb-8f6e-89b1a2a45af1](http://social.microsoft.com/Forums/en/crm/thread/05134277-dd76-4fbb-8f6e-89b1a2a45af1)。

```
var URL = serverUrl + "/userdefined/edit.aspx?etc=5&id=" + slaId;

$.get(URL, function (data) {
    var WRPCTokenElement = $(data).find("[WRPCTokenUrl]");
    if (WRPCTokenElement) {
        var WRPCTokenUrl = WRPCTokenElement.attr("WRPCTokenUrl");
        if (WRPCTokenUrl) {
            URL = "/Activities/Attachment/download.aspx?AttachmentType=5&AttachmentId=" + slaId + "&IsNotesTabAttachment=undefined" + WRPCTokenUrl;
            window.open(URL);
        }
    }

    return false;
}); 
```

# html - 为什么progress {border:0}去掉默认外观 ?

> ID：13866234
> 
> 赞同：5
> 
> 时间：2012-12-13T18:36:58.630
> 
> 标签：html, css

**测试：** Chrome 23、Firefox 15、Opera 11（没有 IE10 或 Safari 6）

使用此 HTML：

```
<progress value=3 min=1 max=10></progress> 
```

这个CSS：

```
progress { border: 0 } 
```

...元素的默认浏览器呈现消失。相反，它被一个基本的酒吧所取代。Firebug 和 Chrome 的网络检查器表明该元素最初没有边框宽度。

奇怪的是，如果`0`替换为`none`：

```
progress { border: none } 
```

...Chrome 不受影响，但 FF 和 Opera 是一样的。

顺便说一句，这个基本的酒吧如何设计？此类事物（以及其他，例如样式`input[type=file]`）的文档在哪里存在？

* * *

**屏幕截图：**
第一个进度条始终是原生的非样式变体。

铬 23、Windows 8：
![铬 23、Windows 8](../Images/f0a05500c141552bae0bd8721672f79d.png)

IE 10、Windows 8：
![IE 10、Windows 8](../Images/51f14cbed2f7d2f4c1e74eae02be3e97.png)

Chrome 23、Mac OS X 10.6.8：
![铬 23，OS X 10.6.8](../Images/b1de8f849aef1367e31c394b03b63cc5.png)

火狐 15、Mac OS X 10.6.8：
![火狐 15、OS X 10.6.8](../Images/8a66ccc462b12f3cca8bd9ce58c277b4.png)

歌剧 12，Mac OS X 10.6.8：
![歌剧 12、OS X 10.6.8](../Images/ce54f451b758bb5e6b60b9955d8614a3.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T18:57:00.363

出于完全相同的原因，将该样式应用于 a`<button>`使其不再看起来像本机按钮。

许多 UI 组件（例如`<input>`、`<button>`、`<select>`等`<progress>`）都呈现为本机控件。但是，如果将任何演示样式应用于它们，例如`background-color`, `border`... 那么它们就不能在本地呈现，因此由浏览器使用给定样式手动完成。因此，它们可能看起来与它们通常的样子非常不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:00:20.597

可能与它杀死输入按钮/提交样式的原因相同。它们以一种特殊的方式呈现（这不是正确的词，我知道），所以一旦你改变了它们的默认样式，它们就会被破坏。

我建议你坚持使用[jQuery UI](http://jqueryui.com/)，唯一的缺点就是额外的千字节。您可以在保持相同功能和外观的情况下为更广泛的用户提供服务。

请参阅部分，[jQuery UI 进度条示例](http://jqueryui.com/progressbar/)

# javascript - 贝塞尔控制点方向 d3

> ID：13866236
> 
> 赞同：1
> 
> 时间：2012-12-13T18:37:04.397
> 
> 标签：javascript, d3.js

我正在手工制作 D3 的网络图（我不喜欢 Force Directed 的输出）。为此，我生成了一个节点数组，每个节点都有一个 x/y 坐标。

```
{
    "nodes" : [
        {
            "name" : "foo",
            "to"   : ["bar"]
        },
        {
            "name" : "bar",
            "to"   : ["baz"]
        },
        {
            "name" : "baz"
        }
    ]

} 
```

然后，我生成一个带有父 svg:g 的 svg，并将这些数据绑定到一系列挂在父项上的 svg:g 元素。

```
addSvg = function () {
    // add the parent svg element
    return d3.select('#visualisation')
        .append('svg')
        .attr('width', width)
        .attr('height', height);
};

addSvgGroup = function (p) {
    // add a containing svg:g
    return p.append('svg:g').
        attr('transform', 'translate(0,0)');
};

addSvgNodes = function(p, nodes) {
    // attach all nodes to the parent p data
    // and render to svg:g
    return p.selectAll('g')
        .data(nodes)
        .enter()
        .append('svg:g')
        .attr('class', 'node');
}; 
```

然后我手动定位节点（稍后这将是动态的，我只是站起来）

```
transformNodes = function (nodes) {
    // position nodes manually
    // deprecate later for column concept
    nodes.attr('transform', function (o, i) {
        offset = (i + 1) * options.nodeOffset;
        // options.nodeOffset = 150
        o.x = offset;
        o.y = offset / 2;
        return 'translate(' + offset + ',' + offset / 2 + ')';
    });
}; 
```

然后我将这些项目附加到父 svg:g，并将一些文本挂在它们上面。这会导致 svg 内的文本从左到右下降。到目前为止，一切都很好。

接下来，我想生成一些链接，所以我使用一种方法来确定当前节点是否有关系，然后获取该节点的位置。最后，我使用 d3.svg.diagonal 生成一系列链接，并将它们的源/目标设置为适当的节点。为清楚起见，以手写方式书写。

```
getLinkGenerator = function (o) {
    return d3.svg.diagonal()
        .source(o.source)
        .target(o.target)
        .projection(function (d) {
            console.log('projection', d);
            return [d.x, d.y]
        });

}; 
```

现在，到目前为止，一切都很好 - 除了贝塞尔曲线的控制手柄不是我想要的位置。例如，从节点 A 到节点 B，路径 d 属性为：

```
 <path d="M150,75C150,112.5 300,112.5 300,150" style="fill: none" stroke="#000"></path> 
```

但我希望它改变控制手柄的方向 - 即

```
 <path d="M150,75C200,75 250,150 300,150" style="fill: none" stroke="#000"></path> 
```

这将使它看起来更像是示例页面中的树状图。我在可折叠树状图示例中注意到的是它返回了轴的反转：

```
 return [d.y, d.x] 
```

但是如果我这样做，虽然控制点按照我的意愿定向，但点的位置不正常（即它们的 x/y 坐标也颠倒了，有效地翻译了它们。

有没有其他人遇到过这样的问题或知道如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T16:49:59.953

好的，所以我看了一下这个并想出了一个解决方案。似乎某些布局（树状图、折叠树）正在反转路径链接中源/目标的坐标，因此当它们命中投影调用时，它们会被反转回正确的位置，但方向为他们的贝塞尔点旋转。

因此，如果您正在手动调整自定义布局并且想要水平定向贝塞尔控件（如示例），这就是您需要做的。

# ios - iOS - 仅在修改后下载文件（NSURL 和 NSData）

> ID：13866239
> 
> 赞同：3
> 
> 时间：2012-12-13T18:37:16.437
> 
> 标签：ios, uiimage, download, nsdata, nsurl

我正在从服务器下载一堆图像文件，并且我想确保仅在它们较新时才下载它们。此方法目前可以​​很好地下载图像。但是，我不想每次用户登录应用程序时都浪费时间或精力重新下载图像。相反，我只想下载 A）不存在 B）在服务器上比在设备上更新的任何文件

这是我下载图像的方式： *图像 url 与关联的视频一起保存在 Core Data 中。url是使用我构建的简单转换方法生成的（generateThumbnailURL）

```
-(void)saveThumbnails{
    NSManagedObjectContext *context = [self managedObjectContextThumbnails];
    NSError *error;
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription
                                   entityForName:@"Videos" inManagedObjectContext:context];
    [fetchRequest setEntity:entity];
    NSArray *fetchedObjects = [context executeFetchRequest:fetchRequest error:&error];
    NSLog(@"Videos: %i",fetchedObjects.count);
    if (fetchedObjects.count!=0) {
        for(Videos *currentVideo in fetchedObjects){
            // Get an image from the URL below
            NSURL *thumbnailURL = [self generateThumbnailURL:[currentVideo.videoID intValue]];

            UIImage *image = [[UIImage alloc] initWithData:[NSData dataWithContentsOfURL:thumbnailURL]];

            // Let's save the file into Document folder.
            // You can also change this to your desktop for testing. (e.g. /Users/kiichi/Desktop/)
            NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);//Find Application's Document Directory
            NSString *documentsDirectory = [paths objectAtIndex:0];
            NSString *dataPath = [documentsDirectory stringByAppendingPathComponent:@"DownloadedThumbnails"];
            //        NSString *dataPath = @"/Users/macminidemo/Desktop/gt";//DEBUG SAVING IMAGE BY SAVING TO DESKTOP FOLDER

            //Check if Sub-directory exists, if not, try to create it
            if (![[NSFileManager defaultManager] fileExistsAtPath:dataPath]){
                NSError* error;
                if([[NSFileManager defaultManager] createDirectoryAtPath:dataPath withIntermediateDirectories:NO attributes:nil error:&error]){
                    NSLog(@"New Folder Created!");
                }
                else
                {
                    NSLog(@"[%@] ERROR: attempting to write create new directory", [self class]);
                    NSAssert( FALSE, @"Failed to create directory maybe out of disk space?");
                }
            }
            NSArray *splitFilename = [[self generateThumbnailFilename:[currentVideo.videoID intValue]] componentsSeparatedByString:@"."];//Break Filename Extension Off (not always PNGs)
            NSString *subString = [splitFilename objectAtIndex:0];
            NSString *formattedFilename = [NSString stringWithFormat:@"%@~ipad.png",subString];
            NSString *localFilePath = [dataPath stringByAppendingPathComponent:formattedFilename];
            NSData *imageData = [NSData dataWithData:UIImagePNGRepresentation(image)];
            [imageData writeToFile:localFilePath atomically:YES];
            NSLog(@"Image: %@ Saved!",formattedFilename);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T19:00:36.693

我最终使用这种方法来检测文件上的修改日期：*在[这里找到](http://www.learn-cocos2d.com/2012/01/download-modified-files-web-server-cocos2d-webcam-viewer/)

```
-(bool)isThumbnailModified:(NSURL *)thumbnailURL forFile:(NSString *)thumbnailFilePath{
    // create a HTTP request to get the file information from the web server
    NSMutableURLRequest* request = [NSMutableURLRequest requestWithURL:thumbnailURL];
    [request setHTTPMethod:@"HEAD"];

    NSHTTPURLResponse* response;
    [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:nil];

    // get the last modified info from the HTTP header
    NSString* httpLastModified = nil;
    if ([response respondsToSelector:@selector(allHeaderFields)])
    {
        httpLastModified = [[response allHeaderFields]
                            objectForKey:@"Last-Modified"];
    }

    // setup a date formatter to query the server file's modified date
    // don't ask me about this part of the code ... it works, that's all I know :)
    NSDateFormatter* df = [[NSDateFormatter alloc] init];
    df.dateFormat = @"EEE',' dd MMM yyyy HH':'mm':'ss 'GMT'";
    df.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US"];
    df.timeZone = [NSTimeZone timeZoneWithAbbreviation:@"GMT"];

    // get the file attributes to retrieve the local file's modified date
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSDictionary* fileAttributes = [fileManager attributesOfItemAtPath:thumbnailFilePath error:nil];

    // test if the server file's date is later than the local file's date
    NSDate* serverFileDate = [df dateFromString:httpLastModified];
    NSDate* localFileDate = [fileAttributes fileModificationDate];

    NSLog(@"Local File Date: %@ Server File Date: %@",localFileDate,serverFileDate);
    //If file doesn't exist, download it
    if(localFileDate==nil){
        return YES;
    }
    return ([localFileDate laterDate:serverFileDate] == serverFileDate);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:58:55.107

如果你的服务器支持 HTTP 缓存，你可以指定你想要缓存的内容`NSURLRequestReloadRevalidatingCacheData`：

```
`NSURLRequest* request = [NSURLRequest requestWithURL:thumbnailURL cachePolicy:NSURLRequestReloadRevalidatingCacheData timeoutInterval:20];
NSURLResponse* response;
NSError* error;
NSData* data = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
UIImage* image = [UIImage imageWithData:data];` 
```

`有关更多信息，请阅读[NSURLRequest 文档](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSURLRequest_Class/Reference/Reference.html)。`

# jquery - 将 json 字符串解析为对象时出错

> ID：13866241
> 
> 赞同：0
> 
> 时间：2012-12-13T18:37:23.303
> 
> 标签：jquery, json

我尝试了堆栈溢出的一些答案，但它对我不起作用......我在 jquery 中调用 asmx Web 服务这是代码

```
 <script type="text/javascript">
        $(document).ready(function () {
            $.ajax({
                type: "POST",
                url: "http://localhost:4845/service.asmx/HelloWorld",
                cache: false,
                contentType: "application/json; charset=utf-8",
                data: "{}",
                dataType: "json",
                success: handleHtml,
                error: ajaxFailed
            });
        });
        function handleHtml(data, status) {

            debugger
            //var myObject = jQuery.parseJSON(data);
            for (var i = 0; i < data.d.length; i++) {
                alert(data.d[1].date);
            }
        }
        function ajaxFailed(xmlRequest) {
            alert(xmlRequest.status + ' \n\r ' +
              xmlRequest.statusText + '\n\r' +
              xmlRequest.responseText);
        }
</script> 
```

当我解析它返回的 null 并且如果我不解析它的显示身份不明的对象.. 这是我的 json 字符串

```
 [{"name":"jef","date":"10/12/2012","ID":0,"description":"test1"},
    {"name":"sam","date":"18/12/2012","ID":0,"description":"test2"},
   {"name":"dan","date":"1/1/2013","ID":0,"description":"test3"},
    {"name":"san","date":"1/2/2013","ID":0,"description":"test4"}] 
```

我想知道如何解析数据并显示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T19:07:52.707

我终于找到了答案..

```
 function handleHtml(data, status) {

        data = data.d
        var myObject = eval('(' + data + ')');

        for (var i = 0; i < data.length; i++) {
            alert(data.[i].date);
        }
    } 
```

我们必须做 data = data.d .. 我还是不明白为什么我必须做 data.d

[JSON 中的 .d 是什么意思？](https://stackoverflow.com/questions/830112/what-does-d-in-json-mean)

# netty - 通过 java 应用程序对 Rest WebService 的 Http 调用

> ID：13866251
> 
> 赞同：2
> 
> 时间：2012-12-13T18:37:47.540
> 
> 标签：netty, apache-httpclient-4.x

如果必须进行任何调用以从不同的应用程序获取数据，我一直在使用 Apache Http 项目。最近我遇到了[http://netty.io](http://netty.io)项目，它是 apache http 的替代品，并且使用了使用 netty 的弹性搜索项目，我对速度印象非常深刻。如果我需要发出同步请求以从不同的应用程序获取数据，netty 是一个不错的选择吗？它比 apache http 有性能优势吗？或者除了 apache http 和 netty 之外还有其他选项可以提高通过 java 调用 http 的性能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T15:55:09.067

如果您正在构建自己的 REST API，或者正在访问 REST API，并且有专注于 http 或 ssl 协议的网络需求......

与阿帕奇一起去。

如果您正在使用其他协议并且容易被拖到网络上的数据包中的字节数，并且将使用 Wireshark 挖掘更复杂的网络协议，那么请使用 Netty。

# java - 圆边纽扣

> ID：13866252
> 
> 赞同：1
> 
> 时间：2012-12-13T18:37:53.160
> 
> 标签：java, swing, user-interface, button, jbutton

我正在尝试获得一个带有圆形边缘的按钮。我的按钮的背景颜色为黄色。我的按钮无法获得圆边。这是我正在尝试的代码

```
 class RoundedBorder implements Border {
        int radius;
        RoundedBorder(int radius) {
            this.radius = radius;
        }
        public Insets getBorderInsets(Component c) {
            return new Insets(this.radius+1, this.radius+1, this.radius+2, this.radius);
        }
        public boolean isBorderOpaque() {
            return true;
        }
        public void paintBorder(Component c, Graphics g, int x, int y, int width, int height) {
            g.drawRoundRect(x,y,width-1,height-1,radius,radius);
        }
    }

jButton1.setText(aContinue);
        jButton1.setBackground(new java.awt.Color(255, 255, 0));
        jButton1.setBorder(new RoundedBorder(20)); 
```

我无法使用这段代码获得圆边。这是我的按钮的外观。

![在此处输入图像描述](../Images/538cb6e607f45a8f7b0face224d5134e.png)

我想要没有溢出背景颜色的圆形边缘。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T19:27:09.793

**选项 1** - 使用图像

**Option2** - 使用以下代码（从[制作按钮圆形中](https://stackoverflow.com/questions/778222/make-a-button-round)提取）

```
import java.awt.*;
import java.awt.geom.*;
import javax.swing.*;

public class RoundButton extends JButton {
  public RoundButton(String label) {
    super(label);

// These statements enlarge the button so that it 
// becomes a circle rather than an oval.
    Dimension size = getPreferredSize();
    size.width = size.height = Math.max(size.width, 
      size.height);
    setPreferredSize(size);

// This call causes the JButton not to paint 
   // the background.
// This allows us to paint a round background.
    setContentAreaFilled(false);
  }

// Paint the round background and label.
  protected void paintComponent(Graphics g) {
    if (getModel().isArmed()) {
// You might want to make the highlight color 
   // a property of the RoundButton class.
      g.setColor(Color.lightGray);
    } else {
      g.setColor(getBackground());
    }
    g.fillOval(0, 0, getSize().width-1, 
      getSize().height-1);

// This call will paint the label and the 
   // focus rectangle.
    super.paintComponent(g);
  }

// Paint the border of the button using a simple stroke.
  protected void paintBorder(Graphics g) {
    g.setColor(getForeground());
    g.drawOval(0, 0, getSize().width-1, 
      getSize().height-1);
  }

// Hit detection.
  Shape shape;
  public boolean contains(int x, int y) {
// If the button has changed size, 
   // make a new shape object.
    if (shape == null || 
      !shape.getBounds().equals(getBounds())) {
      shape = new Ellipse2D.Float(0, 0, 
        getWidth(), getHeight());
    }
    return shape.contains(x, y);
  }

// Test routine.
  public static void main(String[] args) {
// Create a button with the label "Jackpot".
    JButton button = new RoundButton("Jackpot");
    button.setBackground(Color.green);

// Create a frame in which to show the button.
    JFrame frame = new JFrame();
    frame.getContentPane().setBackground(Color.yellow);
    frame.getContentPane().add(button);
    frame.getContentPane().setLayout(new FlowLayout());
    frame.setSize(150, 150);
    frame.setVisible(true);
  }
} 
```

**选项 3** - 使用支持圆形按钮的外观[http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/NimbusLookandFeel_OBE2012/CustomizingLandF.html](http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/NimbusLookandFeel_OBE2012/CustomizingLandF.html)

**选项 4** - 使用 JavaFX 并使用 CSS。有免费的 CSS 脚本支持这个

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T19:50:58.503

oracle 找到了这个很好的例子，它提供了一个创建[RoundButton](http://docs.oracle.com/javase/1.4.2/docs/guide/awt/demos/lightweight/RoundButtons/actual/RoundButton.java)的类。

![在此处输入图像描述](../Images/9bc0a316603655d03d51d9f5da2b7f1d.png)

这是一个使用已编辑`RoundButton`类创建`RoundedButton`类的示例：

![在此处输入图像描述](../Images/f5bbc42f4dc94ed3eaf6d4868a76404c.png)

```
import java.awt.AWTEvent;
import java.awt.AWTEventMulticaster;
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.FontMetrics;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseEvent;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;

public class Test {

    public Test() {
        initComponents();
    }

    private void initComponents() {
        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        final JTextField tf = new JTextField("");

        RoundedButton rb = new RoundedButton("Go");
        rb.setBackground(Color.yellow);
        rb.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                JOptionPane.showMessageDialog(frame, "You said: " + tf.getText());
            }
        });

        frame.add(tf, BorderLayout.NORTH);
        frame.add(rb);

        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Test();
            }
        });
    }
}

class RoundedButton extends Component {

    ActionListener actionListener;     // Post action events to listeners
    String label;                      // The Button's text
    protected boolean pressed = false; // true if the button is detented.

    /**
     * Constructs a RoundedButton with no label.
     */
    public RoundedButton() {
        this("");
    }

    /**
     * Constructs a RoundedButton with the specified label.
     *
     * @param label the label of the button
     */
    public RoundedButton(String label) {
        this.label = label;
        enableEvents(AWTEvent.MOUSE_EVENT_MASK);
    }

    /**
     * gets the label
     *
     * @see setLabel
     */
    public String getLabel() {
        return label;
    }

    /**
     * sets the label
     *
     * @see getLabel
     */
    public void setLabel(String label) {
        this.label = label;
        invalidate();
        repaint();
    }

    /**
     * paints the RoundedButton
     */
    @Override
    public void paint(Graphics g) {

        // paint the interior of the button
        if (pressed) {
            g.setColor(getBackground().darker().darker());
        } else {
            g.setColor(getBackground());
        }
        g.fillRoundRect(0, 0, getWidth() - 1, getHeight() - 1, 20, 20);

        // draw the perimeter of the button
        g.setColor(getBackground().darker().darker().darker());
        g.drawRoundRect(0, 0, getWidth() - 1, getHeight() - 1, 20, 20);

        // draw the label centered in the button
        Font f = getFont();
        if (f != null) {
            FontMetrics fm = getFontMetrics(getFont());
            g.setColor(getForeground());
            g.drawString(label, getWidth() / 2 - fm.stringWidth(label) / 2, getHeight() / 2 + fm.getMaxDescent());
        }
    }

    /**
     * The preferred size of the button.
     */
    @Override
    public Dimension getPreferredSize() {
        Font f = getFont();
        if (f != null) {
            FontMetrics fm = getFontMetrics(getFont());
            int max = Math.max(fm.stringWidth(label) + 40, fm.getHeight() + 40);
            return new Dimension(max, max);
        } else {
            return new Dimension(100, 100);
        }
    }

    /**
     * The minimum size of the button.
     */
    @Override
    public Dimension getMinimumSize() {
        return new Dimension(100, 100);
    }

    /**
     * Adds the specified action listener to receive action events from this
     * button.
     *
     * @param listener the action listener
     */
    public void addActionListener(ActionListener listener) {
        actionListener = AWTEventMulticaster.add(actionListener, listener);
        enableEvents(AWTEvent.MOUSE_EVENT_MASK);
    }

    /**
     * Removes the specified action listener so it no longer receives action
     * events from this button.
     *
     * @param listener the action listener
     */
    public void removeActionListener(ActionListener listener) {
        actionListener = AWTEventMulticaster.remove(actionListener, listener);
    }

    /**
     * Determine if click was inside round button.
     */
    @Override
    public boolean contains(int x, int y) {
        int mx = getSize().width / 2;
        int my = getSize().height / 2;
        return (((mx - x) * (mx - x) + (my - y) * (my - y)) <= mx * mx);
    }

    /**
     * Paints the button and distribute an action event to all listeners.
     */
    @Override
    public void processMouseEvent(MouseEvent e) {
        Graphics g;
        switch (e.getID()) {
            case MouseEvent.MOUSE_PRESSED:
                // render myself inverted....
                pressed = true;

                // Repaint might flicker a bit. To avoid this, you can use
                // double buffering (see the Gauge example).
                repaint();
                break;
            case MouseEvent.MOUSE_RELEASED:
                if (actionListener != null) {
                    actionListener.actionPerformed(new ActionEvent(
                            this, ActionEvent.ACTION_PERFORMED, label));
                }
                // render myself normal again
                if (pressed == true) {
                    pressed = false;

                    // Repaint might flicker a bit. To avoid this, you can use
                    // double buffering (see the Gauge example).
                    repaint();
                }
                break;
            case MouseEvent.MOUSE_ENTERED:

                break;
            case MouseEvent.MOUSE_EXITED:
                if (pressed == true) {
                    // Cancel! Don't send action event.
                    pressed = false;

                    // Repaint might flicker a bit. To avoid this, you can use
                    // double buffering (see the Gauge example).
                    repaint();

                    // Note: for a more complete button implementation,
                    // you wouldn't want to cancel at this point, but
                    // rather detect when the mouse re-entered, and
                    // re-highlight the button. There are a few state
                    // issues that that you need to handle, which we leave
                    // this an an excercise for the reader (I always
                    // wanted to say that!)
                }
                break;
        }
        super.processMouseEvent(e);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T18:55:26.920

另一种实现这一点的干净方法是定义一个自定义`ButtonUI`来绘制圆角按钮。

# java - Gzip解压返回随机字符

> ID：13866253
> 
> 赞同：2
> 
> 时间：2012-12-13T18:37:58.060
> 
> 标签：java, android, gzip, apache-commons-httpclient

我正在尝试从服务器下载 gzip 压缩的 XML 文件，为此我使用以下代码：

```
 HttpParams httpParameters = new BasicHttpParams();
        int timeoutConnection = 3000;
        HttpConnectionParams.setConnectionTimeout(httpParameters, timeoutConnection);
        int timeoutSocket = 5000;
        HttpConnectionParams.setSoTimeout(httpParameters, timeoutSocket);

        DefaultHttpClient client = new DefaultHttpClient(httpParameters);
        HttpGet response = new HttpGet(urlData);

        client.addRequestInterceptor(new HttpRequestInterceptor() {
            @Override
            public void process(HttpRequest request, HttpContext context) {
                // Add header to accept gzip content
                if (!request.containsHeader("Accept-Encoding")) {
                    request.addHeader("Accept-Encoding", "gzip");
                }
            }
        });

        client.addResponseInterceptor(new HttpResponseInterceptor() {
            @Override
            public void process(HttpResponse response, HttpContext context) {
                // Inflate any responses compressed with gzip
                final HttpEntity entity = response.getEntity();
                final Header encoding = entity.getContentEncoding();
                if (encoding != null) {
                    for (HeaderElement element : encoding.getElements()) {
                        if (element.getName().equalsIgnoreCase("gzip")) {
                            response.setEntity(new InflatingEntity(response.getEntity()));
                            break;
                        }
                    }
                }
            }

        });    

        ResponseHandler<String> responseHandler = new BasicResponseHandler();

        return client.execute(response, responseHandler); 
```

InflatingEntity 方法：

```
private static class InflatingEntity extends HttpEntityWrapper {
        public InflatingEntity(HttpEntity wrapped) {
            super(wrapped);
        }

        @Override
        public InputStream getContent() throws IOException {
            return new GZIPInputStream(wrappedEntity.getContent());
        }

        @Override
        public long getContentLength() {
            return -1;
        }
    } 
```

如果我删除与 Gzip 压缩相关的所有内容并用普通 XML 替换服务器中的压缩 XML 文件，一切正常，但在我实现 Gzip 压缩后，我得到了压缩字符串：

![在此处输入图像描述](../Images/d786056cfbf6115dd3876cd3f07a6cfb.png)

有谁知道我的代码中缺少什么来获取解压缩的 XML？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:40:31.160

我已经解决了这个问题，我的响应没有实体，所以代码没有解压缩响应，因为没有到达那部分代码，这里是 responseinterceptor 中的修改：

```
 client.addResponseInterceptor(new HttpResponseInterceptor() {
                    @Override
                    public void process(HttpResponse response, HttpContext context) {
                            response.setEntity(new InflatingEntity(response.getEntity()));

                    }

                }); 
```

# c# - Dapper : 从 reader 读入字典

> ID：13866255
> 
> 赞同：4
> 
> 时间：2012-12-13T18:37:58.763
> 
> 标签：c#, dapper

我的读者从存储过程中读取内容，该存储过程的第一个选择语句之一为

```
 select id , name from FSubsystem 
```

在 10 个选定的语句中

我声明了字典，如下所示 Dictionary SubsystemMApping = new Dictionary();

```
var reader = connection.QueryMultiple(...); 
```

我需要将第一个 select 语句值读取到字典 SubsystemMApping 。id - 到键和名称 - 到值

我尝试使用 reader.Read.Todictionary() 但无法成功。我对 Func & Action 不是很熟悉。这就是我认为我无法正确理解 Todictionary 的 2 个重载的原因。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-13T19:44:41.147

对于通用 API，Stan 已经对其进行了描述。非通用读取 API 意味着您还可以通过动态绕过 POCO：

```
var lookup = reader.Read().ToDictionary(x => (int)x.id, x => (string)x.name); 
```

基本上，通过“动态”，它将列重新公开为虚拟属性。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-13T19:07:15.250

想象一下，您有一个返回给您的 POCO。就像是

```
public class Item 
{
   public int Id { get; set;}
   public string Name { get; set;}
} 
```

现在假设您有一个`IEnumerable<Item>`并且集合已填充（这很可能是 Dapper 返回的内容）。

要使用该`ToDictionary`方法，您有 2 个重要的重载。

```
var dictionary = itemList.ToDictionary( item => item.Id ); 
```

这会返回一个`Dictionary<int,Item>`. 字典的键是每个`item.Id`属性。

键/值重载：

```
var dictionary = itemList.ToDictionary( item => item.Id , item => item.Name ); 
```

此重载`Dictionary<int,string>`使用指定`item.Id`的 for 键和`item.Name`值创建一个。

还有 2 个重载允许您在确定键时传递要使用的自定义比较器。

# asp.net-mvc - 解析 CSV 列表并匹配 Linq 中的部分值的谓词

> ID：13866261
> 
> 赞同：0
> 
> 时间：2012-12-13T18:38:24.140
> 
> 标签：asp.net-mvc, linq, linq-to-entities

我正在使用下面的代码片段来解析表单中的邮政编码列表，然后构建一个谓词以从实体返回与解析列表中的任何邮政编码匹配的记录。

```
List<string> zips = ParseCSV("90210,56387,20015");
predicate = predicate.And(n => zips.Contains(n.ZIP)); 
```

现在出现了一个新要求，即逗号分隔的列表可能包含部分邮政编码，并且这些邮政编码也应该返回。我通常会用包含来做到这一点。 `n.ZIP.Contains("902")`

但是如果拉链列表现在变成如下：

```
List<string> zips = ParseCSV("902,56387,215"); 
predicate = predicate.And(n => zips.Contains(n.ZIP)); 
```

当我已经在拉链上做一个包含时，我不知道该怎么做。有什么建议么？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:45:17.573

我认为这将检查是否有任何部分邮政编码，它包含在 ZIP 中：

```
predicate = predicate.And(n => zips.Any(z => n.ZIP.Contains(z))); 
```

# c# - 检查枚举是否有任何共同的标志

> ID：13866268
> 
> 赞同：8
> 
> 时间：2012-12-13T18:38:53.760
> 
> 标签：c#, enums, flags, enum-flags

考虑我有这个扩展方法：

```
public static bool HasAnyFlagInCommon(this System.Enum type, Enum value)
{
    var flags = value.ToString().Split(new string[] { ", " }, 
                                    StringSplitOptions.None);
    foreach (var flag in flags)
    {
        if (type.ToString() == flag)
            return true;
    }
    return false;
} 
```

以及以下情况：

```
[Flags]
enum Bla
{
    A = 0,
    B = 1,
    C = 2,
    D = 4
}

Bla foo = Bla.A | Bla.B;
Bla bar = Bla.A;

bar.HasAnyFlagInCommon(foo); //returns true 
```

我想检查 foo 是否有任何与 bar 相同的标志，但必须有更好的方法在扩展方法中实现这种行为。

我也试过这样，但总是返回 true：

```
 public static bool HasAnyFlagInCommon(this System.Enum type, Enum value)
    {
        var flags = Enum.GetValues(value.GetType()).Cast<Enum>()
                                 .Where(item => value.HasFlag(item));
        foreach (var flag in flags)
        {
            if (type == flag)
                return true;
        }
        return false;
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T18:41:12.923

您可以简单地将 Enum 值转换为*ulong*（以考虑基础类型不是*int*的默认值的可能性）。如果结果 != 0，则至少设置了一个标志。

```
ulong theValue = (ulong)value;
return (theValue != 0); 
```

请记住，在一天结束时，枚举由 byte、sbyte、short、ushort、int、uint、long 或 ulong 之一支持。

[http://msdn.microsoft.com/en-us/library/sbbt4032.aspx](http://msdn.microsoft.com/en-us/library/sbbt4032.aspx)

设置的标志与在支持类型中打开的相应位相同。如果所有位都关闭，则上面的*ulong*只会为 0。

**更新**

*在发布此答案后对该问题进行了编辑，因此这里进行了修改以说明该更新：*

然后查看枚举是否与该枚举的另一个实例有任何共同的标志，您可以使用按位与。如果两者都设置了任何公共位位置，则结果将非零：

```
var anyFlagsInCommon = ((ulong)value) & ((ulong)compareTo); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T19:55:30.143

就像是

```
public static bool HasAnyFlagInCommon(this System.Enum type, Enum value)
{
    return (((long)type) & ((long)value)) != 0;
} 
```

`&`给出了在两个枚举中设置的`1`任何位，所以如果有*任何*这样的位，结果是非零的。

（我已经使用`long`过，希望它适用于枚举基础的任何类型；`int`在你的情况下应该没问题。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-09-07T15:41:38.907

我们有一个基于本网站描述的**Has()扩展方法的扩展方法：http:** [//somewebguy.wordpress.com/2010/02/23/enumeration-extensions-2](http://somewebguy.wordpress.com/2010/02/23/enumeration-extensions-2)。它应该比转换为字符串更快，但我还没有检查过性能。相关子集是：

```
 /// <summary>
    /// Checks if an enumerated type contains a value
    /// </summary>
    public static bool Has<T>(this Enum value, T check) {
        Type type = value.GetType();

        //determine the values
        object result = value;
        _Value parsed = new _Value(check, type);
        if (parsed.Signed is long) {
            return (Convert.ToInt64(value)& (long)parsed.Signed) == (long)parsed.Signed;
        }
        else if (parsed.Unsigned is ulong) {
            return (Convert.ToUInt64(value) & (ulong)parsed.Unsigned) == (ulong)parsed.Unsigned;
        }
        else {
            return false;
        }
    }

    //class to simplfy narrowing values between 
    //a ulong and long since either value should
    //cover any lesser value
    private class _Value {

        //cached comparisons for tye to use
        private static Type _UInt64 = typeof(ulong);
        private static Type _UInt32 = typeof(long);

        public long? Signed;
        public ulong? Unsigned;

        public _Value(object value, Type type) {

            //make sure it is even an enum to work with
            if (!type.IsEnum) {
                throw new ArgumentException("Value provided is not an enumerated type!");
            }

            //then check for the enumerated value
            Type compare = Enum.GetUnderlyingType(type);

            //if this is an unsigned long then the only
            //value that can hold it would be a ulong
            if (compare.Equals(_Value._UInt32) || compare.Equals(_Value._UInt64)) {
                this.Unsigned = Convert.ToUInt64(value);
            }
            //otherwise, a long should cover anything else
            else {
                this.Signed = Convert.ToInt64(value);
            }

        }
    } 
```

# c# - 这个列表创建了什么？

> ID：13866269
> 
> 赞同：0
> 
> 时间：2012-12-13T18:38:54.430
> 
> 标签：c#, list

我试图理解我们今天在课堂上讨论的一些代码，我们在下面创建了一个类，

```
 class Datapoint
    {
        private string latitude;
        private string longtitude;
        private string elevation;

        public Datapoint()
        {
            latitude = "no data";
            longtitude = "no data";
            elevation = "no data";
        }

        public Datapoint(string latitude, string longtitude, string elevation)
        {
            this.latitude = latitude;
            this.longtitude = longtitude;
            this.elevation = elevation;
        }

        public string Latitude { get { return latitude; } }
        public string Longtitude { get { return longtitude; } }
        public string Elevation { get { return elevation; } }
    } 
```

然后从这门课上列出一个清单，

```
List<Datapoint> datapoints; 
```

这是一份清单吗

```
latitude 
longtitude
elevation
latitude 
longtitude
elevation
latitude 
longtitude
elevation
latitude 
longtitude
elevation 
```

等等等等？感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:42:52.977

该列表存储`Datapoint`对象。它没有纬度、经度、海拔等的顺序。您可以`Datapoint`从列表中获取一个对象，然后按照您选择的任何顺序获取纬度、经度、海拔，如下所示：

```
Datapoint myPoint = datapoints[0];
Console.WriteLine(myPoint.latitude);
//etc for which ever measurement you want 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:46:15.577

似乎您认为`Datapoint`该类*本身就是*一种列表结构。虽然你*可以*这样想，但大多数程序员不会这样想。

一个更容易理解的实体可能是一个人。你认为一个人是一个*列表*，像这样吗？

*   年龄
*   性别
*   高度
*   重量
*   发色
*   眼睛的颜色

...等等？我想不是。一个人有很多属性或属性；但是，如果您考虑人员列表，则此列表不仅仅是人员属性的串联序列，而是人员实体（或*实例*）的串联序列。

因此，正如其他人所指出的那样，a`List<Datapoint>`或对象列表`Datapoint`不仅是这些对象的属性列表，而且实际上是对象本身的列表（每个对象都有属性）。

* * *

在较低级别上，如果您询问如何*存储*此信息，那么您实际上已经接近了。显然，要`Datapoint`在内存中分配一个对象，它的所有属性都必须有空间。并且这些很可能会被分配在一个连续的块中（尽管此时我们已经达到了大多数开发人员认为您甚至不应该出于编写软件的目的而考虑的实现细节水平——这是我将要讨论的另一个问题为别人存钱！）。

现在，您可能认为*存储*对象列表很有意义，`Datapoint`就像您建议的那样：

```
latitude  // first object
longitude
elevation
latitude  // second object
longitude
elevation
...       // etc. 
```

但是，正如您可能已经在课堂上学到的那样，引用类型在 .NET 中并不是以这种方式存储的。给定一组对象，每个实例都可以存储在任何地方；你在 a`List<Datapoint>`实际上是一堆对这些对象的*引用*，就像我有这个列表一样：

*   主街 123 号
*   布罗德街 456 号
*   栗子街 789 号

...这些地址的建筑物实际上不需要彼此相邻。

希望这可以帮助您理解 a 的`List<Datapoint>`实际含义：对对象的引用列表，这些对象具有属性，但传统上不被认为是列表本身（尽管在某种意义上它们是），并且可以分配并存在于不相邻的位置记忆中的点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T18:40:57.093

此列表将包含数据点的集合。此集合中的数据点将包含公共属性 Latitude、Longitude 和 Elevation。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T18:44:08.963

这是您的 DataPoints 对象的列表。因此，如果您想获取每个对象的属性，您将首先访问列表中的对象。就像是：

```
foreach(DataPoint dp in datapoints)
{
    //do something with dp.Latitude
    //do something with dp.Longitude
    //do something with dp.Elevation
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T18:50:57.380

```
List<Datapoint> datapoints; 
```

此行初始化列表，但实际上不会将项目放入其中。然后，您需要从默认构造函数或自定义构造函数将项目添加到此列表中。像这样的东西。

```
Datapoint thePointToBeInserted = new Datapoint():   //this will cause it to create a Datapoint where the three properties are "no data".
theListOfDataPoints.Add(thePointToBeInserted);   //we add the object to the list.  
theListofDataPoints.Add(new DataPoint("Example latitude", "etc", "etc"));  //adding with custom constructor. 
```

# php - 这是对詹金斯的正确使用吗？

> ID：13866270
> 
> 赞同：0
> 
> 时间：2012-12-13T18:38:58.933
> 
> 标签：php, .net, jenkins

我们是一家使用 PHP 或 .Net 的网络开发商店。以下是建议的发展路径：

```
Developer -> SVN Server -> Jenkins Server -> Dev Server 
```

1.  开发人员向 SVN 服务器提交或创建标签
2.  提交或标签异步触发 Jenkins 上的作业
3.  Jenkins 上的作业将在开发服务器上运行 svn 更新（或清除目标空间，然后 svn 导出），将代码从 SVN 服务器引入
4.  对于.Net，复制代码后，我需要使用 aspnet_compile 对其进行编译

我的问题有两个，这是对詹金斯的正确使用吗？而且，如果我要使用 aspnet_compile.exe 编译 .Net，是否会在 Microsoft 操作系统上安装从属设备（启用此功能）？

**为了进一步回答：**

勾选Restrict where this project can be run，选择slave。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T20:23:28.557

这听起来像是一个相当标准的构建/部署工作流程，因此可以很好地使用 Jenkins，但我建议将步骤 4 作为 Jenkins 构建的一部分，然后也使用 Jenkins 将编译后的工件部署到您的开发服务器。根据@thescientist 的评论，通过这种方式，您将能够让 Jenkins 将编译问题报告为构建失败，并能够作为 Jenkins 工作的一部分对编译后的代码运行测试。

如果您的 Jenkins master 运行在 Windows 以外的操作系统上，您可以使用 Windows slave 进行编译。您甚至可以让从属进程在您的开发服务器上运行以简化部署；我不建议将其用于生产设置，但对于开发人员来说没问题。

以下是一些可能对您有所帮助的链接：

[在 Windows 上运行 Jenkins](http://yakiloo.com/setup-jenkins-and-windows/)

[使用 Jenkins 构建 ASP.NET 代码](http://game-linchpin.com/2012/04/installing-jenkins-as-continuous-integration-builder-on-windows.html)

[詹金斯和 PHP](https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+and+PHP)

# java - 另一个类的edittext

> ID：13866272
> 
> 赞同：1
> 
> 时间：2012-12-13T18:39:01.353
> 
> 标签：java, android, android-edittext

我正在使用自定义脚本引擎创建一个专家系统引擎，其中一些命令与主 xml gui 集成。例如，有一个“响应”命令接受字符串并将它们设置在 EditText 中。响应命令对于应用程序的功能至关重要，但我无法使用 findViewById 访问 EditText，因为命令例程位于另一个类中。即使它是错误的形式，我如何才能从其他类访问 GUI 元素？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:41:55.920

> 如何从其他类访问 GUI 元素？

如果另一个类是 Activity，则不能。您应该通过 Intent 或其他方式传递 EditText 的内容。
如果其他类不是 Activity，只需将 EditText 设为公共字段变量。或者，您可以将其他类传递给您的 Activity 或根视图的引用，并使用类似`findViewById()`的方法而无需大惊小怪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:42:19.367

通过使用自定义方法（如`public void setEditText(EditText myEditText)`或类似的方法）或作为其构造函数中的参数（取决于您的情况）将 EditText 对象提供给“其他类”。

另一种可能性是发送定义 EditText 的完整 Activity，以便您可以`findViewById()`用来抓取 EditText。但我不会推荐它（我认为这是不好的做法），除非您有很多需要访问的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-16T06:14:11.760

我有同样的问题。我的活动中的代码有太多代码，我想创建外部类来在那里进行一些处理。但是，一个过程包括使用`EditText`，并且您不能在没有 UI 的类中实例化它。因此，最简单的解决方案是在活动中创建`EditText myEditText`变量`public`，`static`然后在外部类中使用它时，只需将点表示法与它来自的原始活动一起使用，它应该可以工作。`static`关键字使它成为一个全局变量，其他类/活动可以访问。

`public static EditText myEditText;`// 把它放在你的活动中

`ActivityName.myEditText.someMethod();`// 在你的外部类中使用 EditText

# c# - IOException: 系统资源充足时系统资源不足

> ID：13866282
> 
> 赞同：1
> 
> 时间：2012-12-13T18:39:56.660
> 
> 标签：c#, .net, io, protobuf-net

当我尝试写出一个文件（~50 MB）时遇到一个错误，我会随机收到以下错误：

> IOException: 系统资源不足，无法完成请求的服务

我目前在硬盘驱动器上有 200+ GB 可用空间，内存中有大约 20 GB 可用空间。我正在使用 protobuf 将数据序列化到磁盘。大约有四个线程同时在不同的文件上运行类似的操作。应该没有其他任何东西试图访问该文件，因为它只是使用随机 GUID 创建的。这是我用来将信息写入磁盘的代码：

```
using (FileStream stream = File.Open(file, FileMode.Create, FileAccess.Write, FileShare.None))
{
    Serializer.Serialize<my_object>(stream, data);
} 
```

任何人都可以阐明 IOException 指的是哪个系统资源吗？

谢谢！

# ruby-on-rails - 在 Rails Controller 测试中，有没有办法传递查询（非路由）参数？

> ID：13866283
> 
> 赞同：4
> 
> 时间：2012-12-13T18:39:58.267
> 
> 标签：ruby-on-rails, ruby, testing, rspec

我在 Rails 和 RSpec 中编写控制器测试，从阅读源代码看来，`ActionController::TestCase`不可能将任意查询参数传递给控制器​​——只有路由参数。

为了解决这个限制，我目前正在使用`with_routing`：

```
with_routing do |routes|
  # this nonsense is necessary because
  # Rails controller testing does not
  # pass on query params, only routing params

  routes.draw do 
    get '/users/confirmation/:confirmation_token' => 'user_confirmations#show'
    root :to => 'root#index'
  end

  get :show, 'confirmation_token' => CONFIRMATION_TOKEN
end 
```

您可能已经猜到了，我正在为 Devise 测试一个自定义的 Confirmations 控制器。这意味着我正在插入现有的 API，并且无法更改实际映射的`config/routes.rb`完成方式。

有没有更简洁的方法来做到这一点？`get`传递查询参数的受支持方式？

* * *

编辑：还有*其他*事情发生。[我在https://github.com/clacke/so_13866283](https://github.com/clacke/so_13866283)创建了一个最小示例：

`spec/controllers/receive_query_param_controller_spec.rb`

```
describe ReceiveQueryParamController do
  describe '#please' do
    it 'receives query param, sets @my_param' do
      get :please, :my_param => 'test_value'
      assigns(:my_param).should eq 'test_value'
    end
  end  
end 
```

`app/controllers/receive_query_param_controller.rb`

```
class ReceiveQueryParamController < ApplicationController
  def please
    @my_param = params[:my_param]
  end
end 
```

`config/routes.rb`

```
So13866283::Application.routes.draw do
  get '/receive_query_param/please' => 'receive_query_param#please'
end 
```

这个测试通过了，所以我想是 Devise 对路由做了一些时髦的事情。

* * *

编辑：

确定设计路线的定义位置，并更新我的示例应用程序以匹配它。

```
So13866283::Application.routes.draw do
  resource :receive_query_param, :only => [:show],
    :controller => "receive_query_param"
end 
```

...并且规格和控制器相应更新以使用`#show`. 测试仍然通过，即`params[:my_param]`由 填充`get :show, :my_param => 'blah'`。因此，为什么在我的真实应用程序中不会发生这种情况仍然是个谜。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T00:47:10.213

控制器测试不路由。您正在对控制器进行单元测试——路由超出了它的范围。

一个典型的控制器规范示例测试一个动作：

```
describe MyController do
  it "is successful" do
    get :index
    response.status.should == 200
  end
end 
```

您通过将参数传递给来设置测试上下文`get`，例如：

```
 get :show, :id => 1 
```

您可以在该哈希中传递查询参数。

如果您*确实*想测试路由，您可以编写路由规范或请求（集成）规范。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T21:12:19.087

你确定没有其他事情发生吗？我有一个 Rails 3.0.x 项目并且正在传递参数.. 嗯.. 这是一篇文章.. 也许它与 get 不同，但这似乎很奇怪..

```
before  { post :contact_us, :contact_us => {:email => 'joe@example.com',
         :category => 'Category', :subject => 'Subject', :message => 'Message'} } 
```

以上肯定是在我的控制器中使用的 `params`对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T20:52:20.260

我现在正在这样做：

```
@request.env['QUERY_STRING'] = "confirmation_token=" # otherwise it's ignored
get :show, :confirmation_token => CONFIRMATION_TOKEN 
```

...但它看起来很老套。

如果有人可以向我展示一种简洁而正式的方式来做到这一点，我会很高兴。从我在源代码中看到的`#get`以及它调用的所有内容来看，似乎没有任何其他方式，但我希望我忽略了一些东西。

# jquery - 如何在 GMaps.js 中使用 removeMarker 过滤标记？

> ID：13866288
> 
> 赞同：0
> 
> 时间：2012-12-13T18:40:19.367
> 
> 标签：jquery, json, google-maps

我正在使用 GMaps.js。我添加了带有 JSON 的标记，并希望根据该 JSON 中的值过滤（隐藏）一些标记。即，隐藏所有没有`foo`属性值的标记`bar`。

我可以使用[`map.removeMarkers()`](http://hpneo.github.com/gmaps/documentation.html#GMaps-removeMarkers)，它只是删除所有标记，我在控制台中看到另一种方法称为`removeMarker()`，但我不知道如何指定特定标记。

我知道它不是同一个库，但文档以前很有用，所以我一直在从[jQuery 地图过滤文档中获取提示](https://code.google.com/p/jquery-ui-map/wiki/jquery_ui_map_v_3_sample_code#Example_filter_tags,_categories,_etc_with_find)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-02T13:01:27.253

要使用该 `map.removeMarker()`方法，您需要跟踪您的标记。并将要删除的标记传递给该方法。除此之外，您可以使用`map.map`which 从 google maps api 返回地图对象，并且您可以使用 google maps api 方法。

# protobuf-net - 继承类protobuf-net序列化

> ID：13866296
> 
> 赞同：2
> 
> 时间：2012-12-13T18:41:01.923
> 
> 标签：protobuf-net

继承的类 C2 流序列化后如下所示：

0x5a 0x03

0x08 0x97 0x01

0x08 0x96 0x01

我不明白那是第一组字节（5a 03）？我相信它必须是第二和第三只代表 Z1 和 Z2 值？

我的代码：

```
 [ProtoContract]
    class C1
    {
        [ProtoMember(1, DataFormat = DataFormat.Default)]
        public int Z1 { get; set; }
    }

    [ProtoContract]
    class C2 : C1
    {
        [ProtoMember(1, DataFormat = DataFormat.Default)]
        public int Z2 { get; set; }
    }      

    public static void Main()
    {
        MemoryStream stream = new MemoryStream();
        ProtoBuf.Meta.RuntimeTypeModel.Default.Add(typeof(C1), true).AddSubType(11, typeof(C2));
        C2 c2 = new C2() {Z1 = 150, Z2 = 151};           
        Serializer.Serialize(stream, c2);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:54:09.060

*   0x5a = field-number 11，wire-type 2（长度前缀） - 这表示通过将子类封装为内部消息的继承
*   0x03 = 3（有效载荷长度）
    *   0x08 = 字段 1，线型 0 (varint)
    *   0x97 0x01 = 151（varint = little-endian 使用 MSB 作为延续）
*   0x08 = 字段编号 1，线型 0 (varint)
    *   0x96 0x01 = 150

基本上映射到（在.proto中）

```
message C1 {
    optional int32 Z1 = 1;
    optional C2 c2 = 11;
}
message C2 {
    optional int32 Z2 = 1;
} 
```

# javascript - 更改文档中的第一个标题标签 (

> ID：13866300
> 
> 赞同：4
> 
> 时间：2012-12-13T18:41:23.337
> 
> 标签：javascript, jquery

如果`<h1>`不存在，则查找文档中的第一个标题标签（`<h2>`通过之一`<h6>`），如果标签文本等于标题文本，则将元素更改为`<h1 class="heading1">`.

据我所知，这是可行的，但必须有一种更有效的方式来编写它。

```
var titleText = $('title').html()
var hOne = $('h1:eq(0)');
var hTwo = $('h2:eq(0)');
var hThree = $('h3:eq(0)');
var hFour = $('h4:eq(0)');
if (hOne.html() == titleText)
{
    return;
}
else if (hTwo.html() == titleText)
{
    var hTwoText = hTwo.html();
    hTwo.replaceWith(function () {
        return '<h1 class="heading1">' + hTwoText + "</h1>";
    });
}
else if (hThree.html() == titleText)
{
    var hThreeText = hThree.html();
    hThree.replaceWith(function () {
        return '<h1 class="heading1">' + hThreeText + "</h1>";
    });
}

else if (hFour.html() == titleText)
{
    var hFourText = hFour.html();
    hFour.replaceWith(function () {
        return '<h1 class="heading1">' + hFourText + "</h1>";
    });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T19:15:18.193

[尝试一下](http://jsbin.com/odomoz/1/edit)

```
$(function () {
  var title,
      headerToReplace,
      replacer;

  if ( $('h1').length === 0 ) {
    title = document.title;
    headerToReplace = $(':header').filter(function () {
      return $(this).text() === title;
    });

    if (headerToReplace.length) {
      replacer = $('<h1 />', { 'class': 'heading1', text: 'title' });
      headerToReplace.first().replaceWith(replacer);
    }
  }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T19:10:41.677

> ***确认工作***

我没有一个很好的例子，因为这需要在 jsFiddle 上来回进行多次确认，但我已经针对多个 h-Tag、现有的 h1、不存在的 h1 以及我能为您的问题想到的所有其他变体进行了测试。以下 1 行简单的 jQuery 每次都会完成这项工作，除非有多个“标题”标签，在这种情况下，只需将 .first 或 .last 添加到过滤器中的标题调用。

```
$('h1, h2, h3, h4, h5, h6').filter(function(i) { return $(this).text() == $("title").text() }).first().each(function(i) { $(this).replaceWith($('<h1>' + $(this).html() + '</h1>')); }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T19:05:39.553

你在寻找这样的东西吗？

```
function getHeader() {
    var headers = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];

    for (var i = 0, z = headers.length; i < z; i++)
    if ($(headers[i]).length) {
        return '<h1 class="heading1">' + $(headers[i]).text() + "</h1>";
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-13T19:09:36.277

像下面这样的东西应该可以工作：

```
var hElem, content;

for (var i = 1; i < 7; i++)
{
    //Get the element
    hElem = $("h" + i + ":eq(0)");

    //Make sure at least one element exists
    if ( ! hElem.length)
        continue;

    //If h1 exists, stop here
    if (i == 1)
        break;

    //Get the element's inner text
    content = hElem.text();

    //Replace the element if needed and then stop
    if (content == titleText)
    {
        hElem.replaceWith("<h1 class='heading1'>" + content + "</h1>");
        break;
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-13T19:15:53.340

```
var $firstHeader = ​$('h1, h2, h3, h4, h5, h6').first();​​​​​​​​

if (​​​​​​$firstHeader​[0].tagName !== 'H1' && &firstHeader.text() === $('title').text()) {
    ​​​var headerContent = $firstHeader.html();
    $firstHeader.replaceWith($('<h1 class="heading1"></h1>').html(headerContent);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-13T19:14:23.870

这没有用，如果

*   `h2-h6`元素可能包含标题作为它们的子字符串
*   标题中包含双引号

如果您想要完全匹配，那么您将进一步研究这一点。

```
var titleText = $('title').text();
if (!$('h1:eq(0)').length) {
    var selectors = [], i = 2;
    for (i; i < 7; i++) { 
        selectors.push('h'+i+':contains("'+titleText+'"):eq(0)');
    }
    var $el = $(selectors.join(',')).first();
    $el.replaceWith('<h1 class="heading1">'+$el.text()+'</h1>');
} 
```

[**演示**](http://jsfiddle.net/Shef/7VbRB/)

# actionscript-3 - 如何在 Flex 4 中更改不同状态的组件的可见性

> ID：13866302
> 
> 赞同：2
> 
> 时间：2012-12-13T18:41:24.103
> 
> 标签：actionscript-3, apache-flex, flex4

我的目标是从另一个处于另一种状态的组件中更改组件的可见性。我一直在阅读有关该事件的信息，但我可以灵活地工作，我明白了`TypeError: Error # 1009: Can not access a property or method of a null object reference`。

```
<<fx:Script>
    <![CDATA[
        import mx.controls.Alert;
        import mx.events.FlexEvent;

        protected function buttonChange_clickHandler(event:MouseEvent):void
        {
            Tab.selectedIndex=1;    
            border.visible=true;
            border.setStyle("backgroundColor",'#8000FF');

        }

    ]]>
</fx:Script>
<mx:TabNavigator x="197.7" y="147.35" width="514" id="Tab" height="335">
    <s:NavigatorContent label="State 1" width="100%" height="100%">

        <s:Button x="65" y="103" id="buttonChange" label="Change state" click="buttonChange_clickHandler(event)" />

    </s:NavigatorContent>
    <s:NavigatorContent label="State2" id="state2"  width="100%" height="100%">
        <s:BorderContainer x="191"  y="37" width="249" height="223" visible="false"  cornerRadius="20" borderWeight="5" id="border">
        </s:BorderContainer>
    </s:NavigatorContent>
</mx:TabNavigator>
<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:21:12.347

发生错误是因为当Tab Navigator更改索引时，您的边界符号不是“创建”的。有两种快速的方法可以解决这个问题：

1) 使用 callLater 确保tab改变时会创建边框：

```
 protected function buttonChange_clickHandler(event:MouseEvent):void
        {
            Tab.selectedIndex=1;
            callLater(turnVisible);
        }

        private function turnVisible():void{
                border.visible=true;
                border.setStyle("backgroundColor",'#8000FF');
        } 
```

2）或将[creationPolicy](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/SkinnableContainer.html#creationPolicy "创造政策")设置为第二个的“全部” `</s:NavigatorContent>`。这样会增加应用程序的启动时间：

```
<s:NavigatorContent label="State2" id="state2"  width="100%" height="100%" creationPolicy="all"> 
```

# haskell - 在 Haskell 中检查两个 n-ary 树是否相等

> ID：13866303
> 
> 赞同：0
> 
> 时间：2012-12-13T18:41:28.283
> 
> 标签：haskell, tree, equals

我试图在 Haskell 中实现一个简单的布尔函数来检查两个 n 元树是否相等。

我的代码是：

```
-- This is the n-ary tree definition.
-- (I know "Leaf a" is not necessary but I prefer to write it for clarity)
data Tree a = Leaf a | Node a [Tree a]
    deriving (Show)

-- This is a simple tree used for test purposes
t :: Tree Int
t = Node 3 [Node 5 [Leaf 11, Leaf 13, Leaf 15], Leaf 7, Leaf 9]

treeEquals :: Eq a => Tree a -> Tree a -> Bool
treeEquals (Leaf n1) (Leaf n2) = n1 == n2
treeEquals (Node n1 xs1) (Node n2 xs2) = n1 == n2 && and(zipWith (treeEquals) xs1 xs2)
treeEquals _ _ = False 
```

我的问题是，如果我进行以下测试：

```
treeEquals t t
treeEquals t (Leaf 3)
treeEquals t (Node 3 [Leaf 7]) 
```

它正确返回false，因为树不相等，但是如果我尝试进行以下测试：

```
treeEquals t (Node 3 []) 
```

它不起作用，因为它在树相等时返回 true。

你知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T18:44:23.970

你为什么不直接派生`Eq`和使用`==`？

您当前代码的问题是`zipWith`. 一旦到达较短列表的末尾，它就会停止，所以`zipWith treeEquals foo []`总是返回`[]`（不管是什么`foo`）。

这是一个（未经测试的）替代解决方案：

```
treeEquals :: Eq a => Tree a -> Tree a -> Bool
treeEquals (Leaf n1) (Leaf n2) = n1 == n2
treeEquals (Node n1 xs1) (Node n2 xs2) = n1 == n2 && listTreeEquals xs1 xs2
    where
    listTreeEquals [] [] = True
    listTreeEquals (x1 : xs1) (x2 : xs2) = treeEquals x1 x2 && listTreeEquals xs1 xs2
    listTreeEquals _ _ = False
treeEquals _ _ = False 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T18:46:13.987

在 zipWith 之前添加另一个 && 并检查列表的长度是否相同。

# java - 将 Akka 代理与更改相同数据的遗留代码混合

> ID：13866304
> 
> 赞同：1
> 
> 时间：2012-12-13T18:41:31.907
> 
> 标签：java, akka

我们最近开始在我们的软件中使用 Akka，但我们的大部分代码仍然是“传统”的 Java 代码。我现在处于想要将 Akka 与现有类一起使用的位置，但无法重写所有也使用这些类的现有代码。

特别是，我有一个管理数据对象映射的类。该地图已经被不同的线程同时使用，因此管理器类确保对地图的所有访问都是同步的。我现在必须创建一个清理作业，在它们变得无关紧要后从地图中删除它们。由于该作业应该在后台异步运行，因此我使用了 Akka 代理，即我的代码看起来或多或少像这样：

```
Agent< ObjectManager > myObjectManagerAgent = new Agent< ObjectManager >( myObjectManager, myActorSystem );

...

myObjectManagerAgent.sendOff(
    new Function< ObjectManager, ObjectManager >()
    {
        @Override
        public ObjectManager apply( final ObjectManager objectManager )
        {
           ...

           objectManager.erase( irrelevantObjectIds );

           return objectManager;
        }
     }
  ); 
```

但是，同样的对象管理器也可以直接从软件中的其他几个地方写入，无需代理。如前所述，这种访问是线程安全的，但对 Akka、actor 或代理一无所知。

现在我的问题是：这是……好吧，我确定这是不可取的，但这会起作用吗？还是我在这里开枪打自己的脚？即使它通常会起作用，是否有我应该知道的潜在陷阱或安全措施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:53:25.640

使用 Akka 调用现有代码是很正常的，这就是您在这里所做的一切。您声明 ObjectManager 是线程安全的，并且软件的其他部分也使用它，因此没有理由认为引入 Akka 会固有地导致问题。另一方面，您也可以将核心逻辑移动到 Akka actor 中，然后为您的非 Akka 消费者提供一个简单的外观。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T14:47:52.203

看到这个对象被包装在一个代理中会有点令人困惑（您通常这样做是为了确保在多个线程或执行上下文之间共享一个不同步的可变资源是安全的，而实际上它不仅本身是线程安全的但也没有经过代理就发生了突变。将整个程序迁移到基于代理的方法可能没问题，但如果它打算保持这种状态，我觉得很奇怪。我宁愿根本不让代理参与那个案子。

# ruby-on-rails-3 - 从不同的关联模型访问属性 rails 3

> ID：13866307
> 
> 赞同：3
> 
> 时间：2012-12-13T18:41:43.250
> 
> 标签：ruby-on-rails-3, activerecord, activemodel

我希望更好地了解活动模型/记录关系以及如何根据属性所在的位置（模型）以及我调用它们的位置来调用属性。因此，例如，我可以像这样从配方控制器中访问属性 disc_name

```
 def all_recipes
@recipes = Recipe.all
 end 
```

在视图中

```
<% @recipes.each do |r| %>
<%= r.dish_name %>
<% end %> 
```

现在说我想从我的控制器中访问一个名为 worldrecipes 的食谱属性，我刚刚编写了一个方法来返回同一国家/地区的所有食谱。一个国家有许多食谱作为关系

所以我的方法是

```
def self.top_countries
joins(:recipes).
  select('countries.*, count(*) AS recipes_count').
  group('countries.id').
  order('recipes_count DESC')
 end 
```

我的控制器

```
@worldrecipes = Country.where(:name => params[:name]) 
```

并查看

```
<% @worldrecipes.each do |r|  %>
<%= r.name %>
<% end %> 
```

所以访问国家名称属性很容易，因为它在国家模型中，这就是我的查询结果从（我认为）返回的地方......我的问题是我如何从我的食谱模型访问 disc_name 属性到该链接国家的名字

希望这是有道理的，有没有人有关于如何解决这个问题的指南或一些黄金法则

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T18:50:29.780

我认为你需要的是：

```
@country=Country.where(:name=>params[:name]).first
@worldrecipes=@country.recipes 
```

在视图中：

```
<% @worldrecipes.each do |r|  %>
  <%= r.dish_name %>
<% end %> 
```

这将打印该国家/地区食谱的菜名，名称由`params[:name]`

编辑：好的，让我为你解决这个问题:)

您的模型关系设置为每个国家/地区都有许多食谱。即一个国家有很多食谱。

所以你有了，

```
has_many :recipes 
```

在 country.rb 和

```
belongs_to :country 
```

在recipe.rb中

现在，当您想访问属于某个国家/地区的所有食谱时，您所做的就是调用`country_record.recipes`（country_record 是您需要的国家记录的对象）。

当您调用 Country.where(:name=>params[:name]) 时，您实际得到的是表示 COUNTRY 本身的活动记录对象，而不是该国家/地区的食谱，这就是打印意大利的原因。

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T18:55:59.987

对于初学者，您要确保在模型中设置了关联：

**国家.rb**

```
class Country < ActiveRecord::Base  
  has_many :recipes
end 
```

**食谱.rb**

```
class Recipe < ActiveRecord::Base  
  belongs_to :country
end 
```

如果您还没有这样做，请通过运行以下迁移将 foreign_key 属性添加到您的配方模型：

```
rails g migration add_country_id_to_recipe country_id:integer 
```

现在您的关联已经到位，您可以轻松查询国家/地区的相应食谱。在您的控制器中：

```
@worldrecipes = Country.where(:name => params[:name]) 
```

那么在你看来：

```
<% @worldrecipes.each do |c|  %>
  <% c.recipes.each do |r| %>
   <%= r.dish_name %>
  <% end %>
<% end %> 
```

* * *

关于“黄金法则”，我强烈建议您查看[Association Basics](http://guides.rubyonrails.org/association_basics.html)。这是概述您可以对关联进行哪些操作的首选之地。

# python - web2py 内联可编辑网格

> ID：13866316
> 
> 赞同：4
> 
> 时间：2012-12-13T18:42:08.587
> 
> 标签：python, grid, web2py

我正在使用 web2py 为 MySQL 后端构建动态 web UI，而且我对 web2py 框架和 web 开发一般来说是新手。

我正在寻找的是具有以下功能的库或插件，这些功能是为 web2py 构建或兼容的。

1) 对从表中检索到的记录进行内联编辑（一次多条记录，而不是一次仅一条），所有更改在提交时都发送回数据库。

2) 这些记录的某些字段的值的下拉菜单；下拉列表的值将取决于该记录的另一个字段的值。

3) 创建新记录的能力。

--

以下是一些似乎接近我正在寻找的解决方案。但是所有现成的东西似乎都需要花费或要求我的项目是开源的。包含 [DOT] 以允许两个以上的链接。

[http://datatables.net/index](http://datatables.net/index) - 不购买插件就不能进行内联编辑

[http://wijmo.com/widgets/wijmo-complete/grid/](http://wijmo.com/widgets/wijmo-complete/grid/) - 网格仅附带 wijmo 的许可版本

[http://trirand.com/blog/jqgrid/jqgrid.html](http://trirand.com/blog/jqgrid/jqgrid.html) - 看起来很有希望，但是如何使用 web2py 将数据发送回服务器？另外，我将如何为某些字段创建下拉菜单？

[http://dev.sencha.com/deploy/ext-4.0.0/examples/grid/cell-editing.html](http://dev.sencha.com/deploy/ext-4.0.0/examples/grid/cell-editing.html) - 这似乎是我正在寻找的，但我不想为许可付费.

--

我的偏好是使用已经构建好的东西。然而，很多人似乎认为编写自己的 UI 是最好的方法。

关于前进的好道路有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T09:56:39.107

看到以下插件列表后，[http://dev.s-cubism.com/web2py_plugins](http://dev.s-cubism.com/web2py_plugins) 他们做了大部分你正在寻找的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-25T12:47:33.017

有几个解决方案：[https ://groups.google.com/forum/#!topic/web2py/2AvvmszNrgA](https://groups.google.com/forum/#!topic/web2py/2AvvmszNrgA)

步骤：下载 jeditable，安装在 static/js 文件夹中。将代码添加到模板：

```
<script src="{{=URL('static','js/jquery.jeditable.js')}}"></script> 
```

模型：

```
db.define_table('dogs',
Field('dog_name','string')) 
```

控制器：

```
def populate():
    db.dogs.truncate()
    db.fleas.truncate()

    db.dogs.insert(dog_name='dagwood')
    db.dogs.insert(dog_name='daisy')

def dogs():
    db.dogs.dog_name.represent = lambda value, row: DIV(value if value else '-',_class='dog_name', _id=str(row.id)+'.dog_name')
    g = SQLFORM.grid(db.dogs, searchable=False, csv=False, user_signature=False)
    return dict(form = g)

def upd_dog_name():
    id,column = request.post_vars.id.split('.')
    value = request.post_vars.value
    db(db.dogs.id == id).update(**{column:value})
    return value 
```

看法：

```
{{extend 'layout.html'}}

<script>
jQuery(document).ready(function(){
    jQuery('.dog_name').editable("{{=URL('dogs', 'upd_dog_name')}}",{                   
        tooltip: "Click to edit, enter to save",
 indicator : 'updating',
 });})
</script>

<div id='dogs'>
    {{=form}}
</div> 
```

另一种方法（更少的编程）是使用这个 web2py 切片： [http ://www.web2pyslices.com/slice/show/1714/jqgrid-viewing-and-updating-data](http://www.web2pyslices.com/slice/show/1714/jqgrid-viewing-and-updating-data)

# objective-c - xib vs iPhone：扭曲，重叠的对象

> ID：13866318
> 
> 赞同：0
> 
> 时间：2012-12-13T18:42:17.997
> 
> 标签：objective-c, ios, ios-simulator, xib

下图说明了一切。
![在此处输入图像描述](../Images/c76aba0880a00ecade07bff8a3cadde6.png)

为什么模拟器上的对象重叠？我如何使它们都具有相同的尺寸。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:19:16.260

您的 xib 中的顶级视图使用 iPhone 5 屏幕尺寸，但您在 iPhone 4 屏幕尺寸（更短）中运行模拟器。由于您的 xib 似乎正在使用自动布局，因此您需要调整对象的约束，以便按照您想要的较小屏幕尺寸的方式重新定位和/或调整对象的大小。

# jquery - 复杂选择器中的jquery OR选择器

> ID：13866320
> 
> 赞同：0
> 
> 时间：2012-12-13T18:42:21.700
> 
> 标签：jquery, jquery-selectors

我有以下选择器：

```
$(".product_tile:nth-child(6n) .tile_back select[name='crust']") 
```

它每 6 个 product_tile 查找一次，然后获取具有 tile_back 类的子 div，然后在其中包含名称为外壳的选择框。我现在需要修改它，以便它找到两个选择框之一 - 外壳或底座。

我知道在基本选择器中，我可以使用逗号：

```
$("select[name='crust'], select[name='base']") 
```

但是如果我在原始选择器中使用逗号分隔的选择器，它会知道逗号仅适用于它的最后一部分，还是会将其视为“查找每 6 个 product_tile 的 tile_back 的外壳选择框或查找任何名为根据”？如果是后者，我该如何编写选择器以使其将其视为“查找每 6 个 product_tile 的 tile_back 的外壳选择框或查找每 6 个 product_tile 的 tile_back 的基本选择框”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T18:49:00.607

您可以指定要搜索的上下文..使用这样的上下文[选择器](http://api.jquery.com/jQuery/)

```
$("select[name='crust'], select[name='base']",'.product_tile:nth-child(6n) .tile_back') 
```

最初与

```
$('.product_tile:nth-child(6n) .tile_back').find("select[name='crust'], select[name='base']"); 
```

它将在 .product_tile:nth-child(6n) 下找到所有带有 name=crust 或 name=base 的选择

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:48:46.250

您将无法将逻辑放入选择器中。您要么必须同时拥有带逗号的完整选择器：

```
$(".product_tile:nth-child(6n) .tile_back select[name='crust'], product_tile:nth-child(6n) .tile_back select[name='base']") 
```

或使用一个选择器匹配直到`.tile_back`并使用第二个选择器进行过滤：

```
$(".product_tile:nth-child(6n) .tile_back").find("select[name='crust'], select[name='base']") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T18:48:27.813

不，只需在逗号后添加开头部分：

```
$(".product_tile:nth-child(6n) .tile_back select[name='crust'], .product_tile:nth-child(6n) .tile_back select[name='base']") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T18:48:53.727

.add [()](http://api.jquery.com/add/)方法将选定的元素添加到结果集中：

```
$(".product_tile:nth-child(6n) .tile_back").add("select[name='crust']").add("select[name='base']"); 
```

# php - 如果条件有范围

> ID：13866323
> 
> 赞同：1
> 
> 时间：2012-12-13T18:42:34.577
> 
> 标签：php

我有代码：

```
$firstletter = mb_substr($userData['name'], 0, 1, 'UTF-8');
if ($firstletter=='א') {
    ...
}
if ($firstletter=='a') {
    ...
} 
```

我想让 if 在范围内，比如：

```
if($firstletter>'a' && $firstletter<'c') 
```

或者

```
if($firstletter>'א' && $firstletter<'ה') 
```

有可能写这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T18:43:28.153

是的，这是可能的，你只是写了它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:45:05.000

您可以使用[ord()](http://php.net/manual/en/function.ord.php)函数返回传递的字母的 ASCII 码。但是您必须确保只传递拉丁字母。对于 unicode 支持，请查看 ord() 函数的注释

# pip - Raspberry Pi - Python 中的 GPIO

> ID：13866328
> 
> 赞同：5
> 
> 时间：2012-12-13T18:42:51.003
> 
> 标签：pip, raspberry-pi, gpio

我正在尝试让我的 Raspberry Pi 的 GPIO 引脚正常工作，并且我正在关注*[教程：如何像 Arduino 一样使用您的 Raspberry Pi](http://log.liminastudio.com/writing/tutorials/tutorial-how-to-use-your-raspberry-pi-like-an-arduino)*。

（我正在通过运行 Raspbian 的 SSH 工作。）我已经成功安装了分发。

尝试安装 PIP 时，我收到如下所示的错误。

我该如何解决？

```
 pi@DuckPi ~ $ sudo curl https://raw.github.com/pypa/pip/master/contrib/get-pip.py | python
      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                     Dload  Upload   Total   Spent    Left  Speed
    100 85929  100 85929    0     0  89250      0 --:--:-- --:--:-- --:--:--  103k
    Downloading/unpacking pip
      Running setup.py egg_info for package pip

        warning: no files found matching '*.html' under directory 'docs'
        warning: no previously-included files matching '*.txt' found under directory 'docs/_build'
        no previously-included directories found matching 'docs/_build/_sources'
    Installing collected packages: pip
      Running setup.py install for pip
        error: could not create '/usr/local/lib/python2.7/dist-packages/pip': Permission denied
        Complete output from command /usr/bin/python -c "import setuptools;__file__='/home/pi/build/pip/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /tmp/pip-6djiJW-record/install-record.txt:
        running install

    running build

    running build_py

    running install_lib

    creating /usr/local/lib/python2.7/dist-packages/pip

    error: could not create '/usr/local/lib/python2.7/dist-packages/pip': Permission denied

    ----------------------------------------
    Command /usr/bin/python -c "import setuptools;__file__='/home/pi/build/pip/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --single-version-externally-managed --record /tmp/pip-6djiJW-record/install-record.txt failed with error code 1
    Storing complete log in /home/pi/.pip/pip.log 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-14T22:05:14.600

这是因为`curl`was `sudo`ed 而不是`python`. 你必须这样做：

```
$ curl https://raw.github.com/pypa/pip/master/contrib/get-pip.py | sudo python 
```

或者，如果您愿意，下载文件然后运行它：

```
$ curl -O https://raw.github.com/pypa/pip/master/contrib/get-pip.py
$ sudo python get-pip.py 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T10:17:39.357

我遵循了相同的教程，但没有安装我刚刚使用的 pip：

```
sudo apt-get install rpi.gpio 
```

本教程的其余部分工作得很好，需要四处搜索一些额外的信息。我对简单 GPIO 的整个体验介绍了我的博客文章[Using Raspberry GPIO Interface](http://workingmatt.blogspot.co.uk/2013/04/using-raspberry-pi-gpio-interface.html)的主题，我希望这也能有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-01T17:41:21.900

如今，Debian 软件包被命名为：

```
python-rpi.gpio - Python GPIO module for Raspberry Pi
python3-rpi.gpio - Python 3 GPIO module for Raspberry Pi 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-03T09:02:53.883

您还可以使用wiringPi 库。它非常易于使用。

以下是链接：

对于 C：[https ://github.com/WiringPi/WiringPi](https://github.com/WiringPi/WiringPi)

对于 Python：[https ://github.com/Gadgetoid/WiringPi2-Python](https://github.com/Gadgetoid/WiringPi2-Python)

我希望它有所帮助。

# ios - 推送视图时更改 iOS 应用的背景颜色

> ID：13866334
> 
> 赞同：2
> 
> 时间：2012-12-13T18:43:07.783
> 
> 标签：ios, xcode, image, transition, pushviewcontroller

在我的应用程序中，我使用导航控制器在不同的视图之间切换。我的每个视图都有一个背景图像，但是当我从一个视图转到另一个视图时，在转换时它们之间会出现一点白色。有没有办法改变它？

在表视图类中，我在 viewDidLoad 中有这个：

```
UIImageView *imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"parchment.png"]];
    self.tableView.backgroundColor = [UIColor clearColor];
    self.tableView.backgroundView = imageView;
    [imageView release]; 
```

在详细视图中，我只有一个 HTML 的标准加载请求。HTML 本身具有将羊皮纸作为背景图像的代码。这是他们的样子：

![在此处输入图像描述](../Images/461d2a9920077c098133a6eae8931438.png)

![在此处输入图像描述](../Images/00a2c0c4ccd582f89913dd087be495ce.png)

但是，从带有经文的详细视图回到表格视图，我得到了： ![在此处输入图像描述](../Images/65e71fa2eb045edcb3de8e04242c0724.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-07-17T07:50:22.313

在你的：

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

AppDelegate 的方法。像这样为窗口分配背景颜色：

```
self.window.backgroundColor = [UIColor blackColor]; // or anycolor 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T18:50:55.863

您是否尝试过更改视图的背景颜色属性？

```
[[self view] setBackgroundColor:[UIColor redColor]]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-17T03:06:22.233

问题出在 Web 视图控制器的 viewWillDisappear 中。它被设置为将网页更改为 about:blank page，使其变为白色。我摆脱了那个代码，它工作得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T21:38:53.173

尝试设置导航控制器视图的背景颜色。

在您的导航控制器的根视图控制器中（我猜它是表视图控制器）

```
self.navigationController.view.backgroundColor = // any color ; 
```

# javascript - Web Workers 绩效预期

> ID：13866335
> 
> 赞同：2
> 
> 时间：2012-12-13T18:43:09.023
> 
> 标签：javascript, web-worker

我正在考虑使用 Web Workers 来进行批量图像处理，并且想知道在性能提升方面会发生什么。

我目前的策略是按顺序处理每个图像，只有在当前进程结束后才开始一个新进程。如果我有 10 张图像，每张图像需要 10 秒来处理，那么批处理将在大约 100 秒内完成。

如果我一次使用 10 个 Web Worker，我怀疑我会在 10 秒内完成整个工作。但它会低于 100 秒吗？如果没有，并发运行的 Web Worker 池是否存在最佳大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:47:49.093

我想您的性能提升将在很大程度上取决于您计算机中的内核数量。如果我猜的话，我会说一个好的最佳位置可能是四个网络工作者（对应于四核机器），但唯一确定的方法是尝试一下。

以这样一种方式构建您的代码，您可以简单地更改一个常量来更改工作人员的数量，然后将其设置为一个似乎可以最佳工作的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:17:36.007

您可以尝试使用以下示例进行实验：使用 Web Worker 进行[光线追踪](http://nerget.com/rayjs-mt/rayjs.html) 在这里使用 16 对 4 个 Web Worker 显然会带来巨大的性能提升。

# ruby-on-rails - 帮助内容 html 标记输出中的问题

> ID：13866340
> 
> 赞同：1
> 
> 时间：2012-12-13T18:43:44.567
> 
> 标签：ruby-on-rails

我的模板中有以下助手：

```
= link_to t(:site_count, :count => account.subdomains.count ), "#", :rel => 'tooltip', :title => 'Sites', :class => :nofsite, :'data-placement' => "right", :'data-content' => account_sites_html(account), :'data-html' => true 
```

使用 account_sites_html(account) 助手列出帐户站点及其语言环境

我的助手正在正确生成 html 但我在语言跨度中的 :class 存在问题：

```
 def account_sites_html(account)
    sites = account.subdomains.map {|subdomain| [subdomain.site[:hostname], subdomain.languages]}.uniq
    html = content_tag(:ul) do
        sites.collect do |site|
            content_tag(:li) do
                content_tag(:span, "#{site[0]}")
                site[1].collect do |language| 
                  content_tag(:span, "#{language}", :class => "babFlag-#{language}")
                end.join.html_safe
            end
        end.join.html_safe
    end
    return html.html_safe
  end 
```

本产品：

```
"<ul><li><span class=\"babFlag-en\">en</span><span class=\"babFlag-fr\">fr</span></li></ul>" 
```

这显示得很糟糕....但是如果我在返回之前在控制台中调试和修改 html 变量：

```
"<ul><li><span class='babFlag-en'>en</span><span class='babFlag-fr'>fr</span></li></ul>" 
```

那没关系...我的班级字符串有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T12:58:04.517

在 Rails 3 中，需要使用 concat

concat (content_tag(:span, "#{site[0]}"))

# ios - 需要从 iOS 中的 tableView 选择动态创建 ViewController 对象

> ID：13866342
> 
> 赞同：1
> 
> 时间：2012-12-13T18:43:57.687
> 
> 标签：ios, for-loop, uiviewcontroller, nsmutablearray, nsmutabledictionary

我的`UIViewController`iOS 应用程序中有一个显示从`NSMutableArray`. 此表中的每个单元格都引用了一个唯一的`UIViewController`，当用户进行选择时调用该单元格。我在“didSelectRowAtIndexPath:”方法中尝试做的是动态创建包含与构建表中的值相匹配的键的`UIViewController`通过，以及包含相应类名的值需要调用。因为列表相当长，我认为我需要使用 for 循环来执行此操作，但我对如何执行此操作有点困惑。我的样子是这样的：`NSMutableDictionary``NSMutableArray``UIViewController``NSMutableDictionary`

```
NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];
    [dict setObject:@"aViewController" forKey:@"SelectionA"];
    [dict setObject:@"bViewController" forKey:@"SelectionB"];
    [dict setObject:@"cViewController" forKey:@"SelectionC"]; 
```

作为 TableView 基础的 NSMutableArray 如下所示：

```
NSMutableArray *myArray = [[NSMutableArray alloc] initWithObjects:@"SelectionA", @"SelectionB", @"SelectionC",...,nil]; 
```

我将如何获得对单元格内值的引用，然后构造一个 for 循环，该循环将动态创建与用户从 tableView 所做的选择相对应的正确 viewController，然后通过 navigationController 将用户带到该 viewController ?

提前感谢所有回复的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:47:49.947

创建多个 ViewController 不是一个好主意，您应该创建一个 ViewController，并将它们的 tableCell 的值传递给它。换句话说，您可以通过选择单元格来更改 ViewController 的数据模型。但是您将呈现相同的 ViewController。

只有在您的单元格对应不同类型的情况下（例如，一个单元格是道路毛，另一个是文本值），您必须调用不同的 ViewController。

如果你真的需要不同的视图控制器，那么从单元格数据中获取你想要显示的类型

在`didSelectCellRowAtIndexPath`

```
myAppDelegate *appDelegate = 
    [[UIApplication sharedApplication] delegate];

UIViewController *viewControllerToDisplay;
switch (selection.type) {
  case MapType:  
      viewControllerToDisplay = appDelegate.mapViewController;
  case Picture:
      viewControllerToDisplay = appDelegate.pictureViewController;

} 
```

现在将 viewControllerToDisplay 推送到导航控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:57:16.423

如果您**确实需要**为每个单元格设置一个视图控制器，则无需使用字典来查找它们。由于选择将通过索引路径进行，因此数组是更好的选择。

创建一个具有两个属性的自定义对象：要在单元格中显示的名称和指向要在选择时推送的视图控制器的指针。`myArray`使用这些对象而不是字符串加载。填充单元格时，选择与该行匹配的对象并使用其名称。点击单元格时，选择与该行匹配的对象并推动其控制器。

（但是，正如其他人所说，如果您可以使用相同的控制器并且只更改数据，那就是要走的路！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-09T04:08:44.370

这是解决方案，如果您知道类的名称，则将所有类名称存储在数组中，字典具有键 ClassName 和 Xib。我更喜欢 plist 来存储名称，但您也可以使用其他方式。

在*表或选择器的***didselect**处放置这样的代码，

 *```
Class classobject = NSClassFromString([[ClassArray   objectAtIndex:row]valueForKey:@"ClassName"]);

id object = [[classobject alloc] initWithNibName:[[ClassArray objectAtIndex:row]valueForKey:@"Xib"] bundle:nil];

[self.navigationController pushViewController:object animated:YES]; 
```

第一行会将您的字符串转换为类。现在我们有一个好处是 id 可以保存任何对象，所以使用 id 创建对象。最后你有一个自定义类对象，你可以用它做任何你想做的事情，这里只是一个我做导航的演示。*

# c# - 尝试使用 FileStream 和 StreamWriter 写入 LogFile 时出现异常

> ID：13866343
> 
> 赞同：2
> 
> 时间：2012-12-13T18:43:58.107
> 
> 标签：c#, .net, windows-services

所以基本上我编写了一个 Windows 服务，它扫描任何给定目录中的 zip 文件，然后将其上传到 FTP 服务器。我添加了一个跟踪方法，假设写入一个 txt 文件并记录所有内容。当我将服务发布到 Windows 中时出现问题我在事件查看器中收到一条错误消息（我使用 EventLog 类添加了一个 LogEvent），该消息返回

> System.IO.IOException：该进程无法访问文件“C:\Windows\system32\traceLog.txt”，因为它正被另一个进程使用。

进行跟踪的代码如下

```
private void EscribirTrace(string mensaje)
    {
        if (Tracing)
        {
           try
            {
              using (FileStream archivo2 = new FileStream(string.Format("{0}\\traceLog.txt", Environment.CurrentDirectory), FileMode.Append, FileAccess.Write, FileShare.ReadWrite))
                {
                    mensaje = string.Format("{0} - {1} \r\n", DateTime.Now, mensaje);

                    StreamWriter writer = new StreamWriter(archivo2);
                    writer.WriteLine(mensaje);
                    writer.Flush();
                    writer.Dispose();
                }
            }
            catch (Exception ex)
            {
                LogEvent("Error en escribir tracing", ex);
            }
        }

    } 
```

任何想法，将不胜感激

**编辑**所以经过一些研究，我认为 system32 不是文件的最佳位置。我的意图是在安装了服务的路径上拥有该日志文件。经过一番研究，我更换了

```
Enviroment.CurrentDirectory 
```

为了

```
Path.GetFullPath(System.Reflection.Assembly.GetExecutingAssembly().Location).Replace(
                Path.GetFileName(System.Reflection.Assembly.GetExecutingAssembly().Location) 
```

形成一个字符串。

其余的工作得很好。

感谢您的回复 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:57:47.760

这是因为您的 using 语句尚未发布文件。您将其在蒸汽中打开，因此在关闭流之前您无法写入它。

如果您只想将文本写入文件，只需使用：

```
File.WriteAllText(FILEPATH, TEXTDATA); 
```

该调用将打开文件，写入文件，然后关闭它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:59:35.833

如果它抛出 using ...确保文件上的所有其他流都正确关闭...

如果它抛出 streamwriter 构造函数

使用构造函数中的新文件流将 using 更改为流编写器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:00:26.193

/Windows/system32 需要管理员权限。您的应用程序可能没有以适当的权限运行。您应该尝试将日志写入不同的（限制较少的）位置。如果您需要写入 system32，请确保您的服务以管理员权限运行。

# java - KSoap2 发送复杂的 XML

> ID：13866346
> 
> 赞同：1
> 
> 时间：2012-12-13T18:44:12.820
> 
> 标签：java, android, object, soap, ksoap2

我使用带有 Android 开发者工具的 Eclipse 开发一个 Android 应用程序（构建：v21.0.0-531062）

我正在尝试发送带有类似 XML 结构的肥皂消息

```
<v:Envelope xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:d="http://www.w3.org/2001/XMLSchema" xmlns:c="http://schemas.xmlsoap.org/soap/encoding/" xmlns:v="http://schemas.xmlsoap.org/soap/envelope/">
<v:Header/>
<v:Body>
    <n0:GetContent id="o0" c:root="1" xmlns:n0="http://11Giraffes.com/">
        <SerialNum i:type="d:string">aac3691e</SerialNum>
        <ID i:type="d:string">7fc2cf3f8445ca8e3383ea870f3ae2ce</ID>
                    <SysInfo>
                          <IIP i:type="d:string">127.0.0.1</IIP>
                          <CPU i:type="d:string">15%</CPU>
                    <SysInfo>
    </n0:GetContent>
</v:Body> 
```

但是我无法获取应该在 SysInfo 下嵌套的数据。这一切都进入“GetContent”命名空间。我曾尝试使用各种 ksoap2 jar 文件来获取 SoapObject.adddSoapObject() 但它们都没有按照定义提取该方法。

我实际得到的：

```
<v:Envelope xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:d="http://www.w3.org/2001/XMLSchema" xmlns:c="http://schemas.xmlsoap.org/soap/encoding/" xmlns:v="http://schemas.xmlsoap.org/soap/envelope/">
<v:Header/>
<v:Body>
    <n0:GetContent id="o0" c:root="1" xmlns:n0="http://11Giraffes.com/">
        <SerialNum i:type="d:string">aac3691e</SerialNum>
        <ID i:type="d:string">7fc2cf3f8445ca8e3383ea870f3ae2ce</ID>
        <IIP i:type="d:string">127.0.0.1</IIP>
        <CPU i:type="d:string">15%</CPU>
    </n0:GetContent>
</v:Body> 
```

罐子试过：

*   ksoap2-android-2.5.2.jar
*   ksoap2-android-2.5.5.jar
*   ksoap2-android-2.6.5.jar
*   ksoap2-android-assembly-2.5.5-jar-with-dependencies.jar
*   ksoap2-android-assembly-2.6.4-jar-with-dependencies.jar

该文档指出，任何超过 2.5.5 的 jar 都将包含方法“addSoapObject()”，但事实并非如此。

“将复杂对象数组添加到请求”部分中的[ksoap 文档链接](http://code.google.com/p/ksoap2-android/wiki/CodingTipsAndTricks)

任何帮助获得正确的帮助将不胜感激。

# mysql - Mediawiki的持续备份

> ID：13866347
> 
> 赞同：1
> 
> 时间：2012-12-13T18:44:13.957
> 
> 标签：mysql, backup, mediawiki

我正在为我的组织管理 mediawiki。我们将其用作我们的 Intranet 站点。它积累了庞大的组织知识库。我已确保 mediawiki 始终正常运行。知识库始终备份。
有没有办法连续取回 mediawiki 文件和数据库？我的 mediawiki 托管在带有 Debian OS 的 LAMPP 服务器上。

我正在尝试找到一种自动化备份过程的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:54:34.420

这取决于您所说的“连续”是什么意思。如果您想要运行的数据库副本始终与主数据库相同，则需要设置“复制” - 请参阅[http://dev.mysql.com/doc/refman/5.1/en/replication。 html](http://dev.mysql.com/doc/refman/5.1/en/replication.html)了解如何做到这一点。

如果您想要一个相对最新的数据库备份，那么每隔一小时左右运行一次 mysqldump 是一个很好的解决方案。

您需要单独备份文件，因为它们在您的文件系统中而不是数据库中。看看`rsync`每隔一小时左右跑步一次。

为什么需要“连续”备份以及如何使用它？这些方法中的任何一种都能回答您的问题吗？

# python - Python：如何从 __getattr__ 函数中获取函数名称列表？

> ID：13866353
> 
> 赞同：6
> 
> 时间：2012-12-13T18:44:50.700
> 
> 标签：python

如何从函数中获取类函数列表`__getattr__`？

Python v2.7 如果重要的话。

尝试在`dir`内部使用`__getattr__`会导致无限递归。

```
class Hal(object):
    def __getattr__(self, name):
        print 'I don\'t have a %s function' % name
        names = dir(self) # <-- infinite recursion happens here
        print 'My functions are: %s' % ', '.join(names)
        exit()
    def close_door(self):
        pass
x = Hal()       
x.open_door() 
```

这是我想要的输出：

```
I don't have a open_door function
My functions are: close_door, __getattr__, __init__, __doc__, ... 
```

任何其他能让我得到我想要的输出的解决方案都可以正常工作。我想在函数不存在的情况下进行模糊字符串匹配，以尝试建议用户可能的意思。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:46:07.460

```
names = self.__class__.__dict__ 
```

可能吗？

```
>>> class A:
...   def hello(self,x):
...       print "hello ",x
...   def my_dir(self):
...       print self.__class__.__dict__
...
>>> A().my_dir()
{'__module__': '__main__', 'my_dir': <function my_dir at 0x029A5AB0>, 'hello': <
 function hello at 0x029A5CB0>, '__doc__': None} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:50:39.637

你有什么理由不能这样做吗？

```
names = dir(self.__class__) 
```

您是否希望消费者扩展 Hal 的实例以具有自定义方法？

如果你只想要你已经实现的方法，没有列出内置函数，你也可以试试这个：

```
names = [prop for prop in dir(self.__class__) if prop[1] != "_"] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T18:56:53.237

我认为这很有效：

```
import types

class Hal(object):
    def __getattr__(self, name):
        print ('I don\'t have a %s function' % name)
        funcs = (name for name,func in self.__class__.__dict__.items() if isinstance(func,types.FunctionType))

        #names = dir(self) # <-- infinite recursion happens here
        print ('My functions are: %s' % ', '.join(str(f) for f in funcs))
        exit()

    @staticmethod
    def foo():
        pass

    @classmethod
    def bar(cls):
        pass

    def qux(self):
        pass

    def close_door(self):
        pass

x = Hal()
x.foo = 'bar'
x.open_door() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T19:01:10.183

`dir`一种解决方案是在添加`__getattr__`方法之前制作一个副本：

```
class Hal(object):
    def __init__(self):
        self._names = dir(self)
        def __getattr__(self, name):
            print self.names
        self.__getattr__ = __getattr__ 
```

但是，对于简单的情况，您可以在您的类对象上调用`dir`（同样`getattr`，或`inspect.getmembers`，或其他）来解决问题。如果实例可以在构造后添加方法，这不起作用，但如果这不是问题，这很容易：

```
names = dir(self.__class__) 
```

不管你得到名字，过滤方法，有一些事情要做。

首先，您可以使用`isinstance`on`getattr(self, name)`并确保它是一个方法包装器（或获取绑定版本的类型并确保它是一个实例方法）。如果您直接从 中获取值`self.__class__.__dict__`，则与以您最喜欢的方式获取名称并调用`getattr(self, name)`or的结果完全不同`getattr(self.__class__, name)`。特别是，实例方法将显示为`function`，这比方法包装器更容易测试。尽管其他一些案例现在变得更难被发现。

无论如何，任何基于类型的东西都不会找到像方法一样但不是的东西（例如，因为您已经将内置函数直接分配给对象，将某些东西包装在某些类型的装饰器中，编写自定义描述符，使用将`__callable__`方法作为函数的类等）。如果您正在做任何花哨的事情（或担心有人以后可能会添加一些花哨的东西），您确实需要测试您是否可以显式绑定成员（或将其假绑定到`None`），然后检查结果是否为`callable`，然后可能会做进一步的测试以确保它可以正确调用（因为否则你会被`@staticmethod`s 和类似的东西）。真的，如果出现这种情况（并且您真的仔细考虑了您的设计，并说服自己和至少其他人相信这并不疯狂……），您应该针对您拥有的每个案例测试您能想到的一切……</ p>

如果您想知道方法是否定义在`Hal`实例中，而不是`object`另一个基类中，有几种方法可以做到这一点，但最简单的方法是减去基类的成员。（当然，如果您不关心实例中定义的方法，那么`Hal.__dict__`已经有了您想要的。）

# jquery - jquery：如何找到具有相同类的子 div 的索引

> ID：13866363
> 
> 赞同：0
> 
> 时间：2012-12-13T18:45:32.503
> 
> 标签：jquery, class, indexing, parent-child

这就是问题所在；我有一个 div，它本身包含子 div，我似乎无法访问子 div。我需要的是为每个子 div 找到带有 .eq90 的索引。

这是生成父级的代码。

```
function makeSmallBlockdiv ()
{
var smallBlock = $('<div class="SmallBlock EditBlock"></div>').appendTo("#canvas");
smallBlock.draggable({containment: "#canvas", scroll: false, grid: [10, 10]}, {cursor: "move", cursorAt: {top: 125, left: 150}})
smallBlock.append('<div class="article_title EditBlock fontCenter fontBold font24">Article Title</div>')
smallBlock.append('<div class="article_Image"><img style="width: 250px;" src="<? echo $image1 ?>"></div>')
smallBlock.append('<div class=" article_text font14"><? echo substr($article_text, 0, 200) ?></div>')   
} 
```

可以根据需要经常调用此函数以创建更多父 div。到目前为止，我已经尝试过以下内容：

```
$(".article_text").click(function() {
  alert("Index: " + $(this).index());
}); 
```

我已经将它包装在一个带有更改的函数 ready() 中。这段代码来自我在这里找到的小提琴[http://jsfiddle.net/fY6SU/48/](http://jsfiddle.net/fY6SU/48/)

小提琴代码完美运行，但我的代码什么也没做。当我用 firebug 查看我的 html 时，我可以看到 div 已正确创建。我很困惑，我刚开始使用 jquery 并没有帮助。

任何建议将不胜感激。

谢谢

克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:52:11.017

```
$(".article_text").click(function() {
  alert("Index: " + $(this).index());
}); 
```

选择器只选择了“article_text”类，而你生成的html只包含一个带有“article_text”类的div，所以解决方法是在同名的div中添加一个类或使用多个选择器，如下所示：

```
$(".article_text, .article_Image, .article_title, .SmallBlock").click(function() {
  alert("Index: " + $(this).index());
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:24:24.220

`What I need is to find the index with .eq90 for each of the child divs.`

这里：

```
var ninetyChildren = new Array(); //create an array to hold the children
$(".parent").each(function() { //loop through each parent
    var ninety = $(this).children().eq(89).text(); //get index of 90 - eq starts with 0
    ninetyChildren.push(ninety); //add 90th index to array
});

$.each(ninetyChildren, function(i, data){ //loop through 90th indexes
alert(i +" "+ data); //alert each 90th index
});
​ 
```

希望这是你想要的。 [模拟演示](http://jsfiddle.net/fY6SU/48/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:28:43.320

我能够弄清楚如何为兄弟姐妹获取 index() 。

这是我用来查找它们的代码。

```
$("div").children(".article_text").eq(3).css("color", "red"); 
```

css 选择器只是作为确认其工作的视觉辅助。

感谢所有帮助过我的人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T18:57:11.050

您的解决方案在于您的班级名称。$(".article_text") 仅选​​择最后一个 div 和 ，考虑根据示例小提琴中的类名重命名

# android - 线性渐变是android home小部件上的恒定带

> ID：13866366
> 
> 赞同：0
> 
> 时间：2012-12-13T18:45:52.093
> 
> 标签：android, android-widget

我升级到 Android 4.2，突然间我的家庭小部件上的线性渐变没有按预期运行。而不是梯度，我似乎得到了一个恒定的波段。然后，如果我重新启动设备，渐变将再次开始“工作”，这非常令人费解。我与其他团队成员交谈过，他们的设备似乎没有问题。这是问题的屏幕截图：

![在此处输入图像描述](../Images/3991e9a0763fad3c9b8bec2e561925ee.png)

渐变应用于图像的下半部分，应该从底部的半透明变为顶部的完全透明。相反，您可以在图像的下半部分看到一个基本恒定的半透明区域。布局类似于：

```
<RelativeLayout>
  <ImageView
    android:layout_width="match_parent"
    android:layout_height="match_parent"/>

    <LinearLayout
      android:layout_width="match_parent"
      android:layout_height="wrap_content"
      android:layout_alignParentBottom="true"
      android:layout_alignParentLeft="true"
      android:background="@drawable/gradient"
      android:orientation="vertical" >
... 
```

而渐变背景是

```
<shape>
    <gradient
        android:angle="90"
        android:startColor="#D0000000"
        android:endColor=  "#00000000"
        android:type="linear" />
</shape> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T22:57:48.537

我发现在线性布局（设置`android:layerType="software"`）上强制软件加速解决了这个问题。

# android - android如果显示对话框

> ID：13866369
> 
> 赞同：-1
> 
> 时间：2012-12-13T18:46:08.820
> 
> 标签：android, android-alertdialog, final

我有振动器，并且在摇动时我想显示对话。当执行多次摇动时我遇到问题，因此会显示多个对话框。我想一次只显示一个对话框。

所以我写了这段代码，但它显示错误。一行想要“final AlertDialog”，另一行想要没有“final”

```
 public void onShake() {

        final AlertDialog builder = null;
         if(!builder.isShowing()){

            builder = new AlertDialog.Builder(getParent()).create(); -- error if final is casted on AlertDialog -- "The final local variable builder cannot be assigned. It must be blank and not using a compound assignment"

            builder.setTitle("Shake");

            builder.setButton("OK", new DialogInterface.OnClickListener(){
                public void onClick(DialogInterface dialog, int which){
                    builder.dismiss(); -- requires final AlertDialog -- "Cannot refer to a non-final variable builder inside an inner class defined in a different method"

                }
            });
            builder.show();

      }} 
```

**编辑：**谢谢， dialog.builder(); 看起来工作。但现在我遇到了新问题 - NullPointerException，在我检查是否显示警报对话框的地方抛出。现在我在尝试：

```
if(builder.isShowing() == false) 
```

**修复了 NullPointerException**

```
if(builder == null){
builder.setButton("OK", new DialogInterface.OnClickListener(){
                public void onClick(DialogInterface dialog, int which){
                    dialog.dismiss();
                    builder = null; 
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:48:03.960

更改`builder.dismiss()`为`dialog.dismiss()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:48:41.467

将其删除`builder.dismiss();`并替换为`dialog.dismis()`, 在侦听器上，您将获得一个对话框对象，该对象对应于触发事件的对话框

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T18:49:22.770

将 AlertDialog 声明为您的活动中的一个字段，并且不需要将其设置为最终的。

# tsql - 如何在 T-SQL 中将一个用户随机分配给另一个用户？

> ID：13866372
> 
> 赞同：0
> 
> 时间：2012-12-13T18:46:14.547
> 
> 标签：tsql, random

我正在尝试编写一个存储过程，它将获取一张用户表并将它们随机分配给彼此，没有重复，也没有人分配给自己。

user 表有一个 UserId 列和一个 Username 列。我有一个单独的表来存储 ID。该表有一个 UserId 列和一个 AssignedUserId 列。

我使用这个片段来随机排序行：

```
SELECT ABS(CAST(CAST(NEWID() AS VARBINARY) AS INT)) AS [RandomNumber] 
```

当上面的代码是选择的一部分时，它可以正常工作。我只是很难以数据集的形式思考。我可以逐行或在 C# 中解决问题，但我希望有一位 SQL 大师可以向我展示如何在一个漂亮、高效的查询中做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T15:27:00.263

好的，这是我同时提出的另一种解决方案。我决定用户已经以随机顺序在系统中，所以也许我应该尝试解码器环样式的方法。因此，此代码生成一个移位值，然后移动用户 ID。select 语句使用公式进行“环绕”。它不是完全随机的，它可以使用一些润色，但这就是我所拥有的。用户可能不会意识到缺乏随机性。谢谢您的帮助！

```
DECLARE @people TABLE 
( 
    id INT, 
    name VARCHAR(50)
)

INSERT INTO @people VALUES (1,'Matthew')
INSERT INTO @people VALUES (2,'Mark')
INSERT INTO @people VALUES (3,'Luke')
INSERT INTO @people VALUES (4,'John')
INSERT INTO @people VALUES (5,'Doug')
INSERT INTO @people VALUES (6,'Jamie')
INSERT INTO @people VALUES (7,'John')
INSERT INTO @people VALUES (8,'Cameron')
INSERT INTO @people VALUES (9,'Emily')
INSERT INTO @people VALUES (10,'Tyler')
INSERT INTO @people VALUES (11,'Todd')
INSERT INTO @people VALUES (12,'Kathryn')

DECLARE @Random INT;
DECLARE @Upper INT;
DECLARE @Lower INT;
DECLARE @MaxId INT;

SET @Lower = 1 -- The lowest record ID

SELECT @Upper = (MAX(Id) / 2) FROM @people -- select random int that is somewhere between 1 and half of max ID for shift
SELECT @MaxId = MAX(Id) FROM @people -- select the largest ID in the table

SELECT @Random = ROUND(((@Upper - @Lower -1) * RAND() + @Lower), 0) -- calculate a random number to shift IDs off by

SELECT id, ((id + @Random) % @MaxId) + 1, @Random
from @people 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:06:20.517

可以这样做，但在大桌子上不是很好的做法，但是你的桌子太小了，这会很好用。

```
DECLARE @A TABLE (A1 INT, A2 INT)

INSERT INTO @A VALUES(1, 1)
INSERT INTO @A VALUES(2, 2)
INSERT INTO @A VALUES(3, 3)
INSERT INTO @A VALUES(4, 4)
INSERT INTO @A VALUES(5, 5)

SELECT * FROM @A ORDER BY NEWID()

Result1: 
3   3
1   1
4   4
5   5
2   2

Result2:
2   2
3   3
4   4
5   5
1   1

Result3:
4   4
3   3
1   1
5   5
2   2

Result4:
3   3
5   5
1   1
4   4
2   2

Result5:
5   5
4   4
1   1
3   3
2   2 
```

# youtube - 调用 youtube player api loadPlaylist 返回错误请求错误 400

> ID：13866377
> 
> 赞同：0
> 
> 时间：2012-12-13T18:46:33.880
> 
> 标签：youtube, youtube-api

我试图在由 new YT.Player() 构造函数创建的播放器实例中调用方法 loadPlaylist，所以根据文档

[https://developers.google.com/youtube/iframe_api_reference](https://developers.google.com/youtube/iframe_api_reference)

我可以传递一个名为 list 的参数，其中包含播放列表的 id 或视频 id 数组，如果我尝试播放列表 ID 一切正常，但如果我传递视频 id 数组，收到错误请求错误，我检查了请求api生成的url

[http://www.youtube.com/list_ajax?action_get_list=1&style=xml&list=UOoR27IF7Jk,j67Z9D0rs5s](http://www.youtube.com/list_ajax?action_get_list=1&style=xml&list=UOoR27IF7Jk,j67Z9D0rs5s)

所以 url 是正确的，但是返回了错误，有人知道我是否真的不能传递视频 IDS 并且文档不正确吗？如果是这样，我怎样才能从 api 创建一个播放列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:59:24.813

好的，我想我找到了解决方案，而不是原因，api有两种调用loadPlaylist方法的方法，一种是通过参数传递一个对象，另一种是直接传递args，出于某种原因，在对象内部传递args如果我传递视频 ID，这种方式不起作用，但是如果我使用其他方式（直接传递 args）可以正常工作，嗯，我想知道这是否仍然是一个错误，无论如何希望这对其他人有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-21T00:00:32.673

将 playerVars 中的“列表”更改为“播放列表”，它会立即生效！

```
if (this.listType) {
                playerConfig.playerVars.listType=this.listType;
                playerConfig.playerVars.playlist=this.playlist;
            } 
```

# android - 从edittext获取文本并接收到listview（2种不同的意图）

> ID：13866382
> 
> 赞同：0
> 
> 时间：2012-12-13T18:46:58.540
> 
> 标签：android, listview, android-intent

我在从一个活动意图中的 edittext 接收文本到另一个意图的列表视图时遇到问题。

这是我到目前为止所做的：

活动 B：

```
Button btn = (Button) findViewById(R.id.button2);
        final EditText edit = (EditText) findViewById(R.id.editText1);
        btn.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                Intent i = new Intent(addnote.this, MainActivity.class);

                i.putExtra("text", edit.getText().toString());

                startActivity(i); 
```

活动 A：列表视图在哪里我只是不知道单击按钮 2 时如何接收此文本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:27:22.493

基本上，您要做的就是调用`getStringExtra()`以获取您在`putExtra()`. 例如：在活动 A 中`onCreate()`，您需要这样做：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_a);

    mYourString = getIntent().getStringExtra("text");
} 
```

请记住，Android 建议在您存储的对象名称前加上应用程序的包名称。因此，`"text"`您应该使用`"com.example.myproject.text"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:56:17.387

**谢谢你，但我在接收数据并将其放入我迄今为止所做的活动 A 的列表视图中时遇到问题：**

```
Intent i = getIntent();
String mdata = getIntent().getStringExtra("text");
ListView listv = (ListView) findViewById(R.id.notelist);
ArrayAdapter<String> Adapter = new ArrayAdapter<String>(this,
android.R.layout.simple_list_item_1, mdata);
listv.setAdapter(Adapter); 
```

# coffeescript - 在 Coffeescript 中返回函数值而不是绑定的正确方法

> ID：13866383
> 
> 赞同：0
> 
> 时间：2012-12-13T18:47:15.463
> 
> 标签：coffeescript

我似乎找不到这个问题的简明答案。调用 @_instanceMethod 而不是函数绑定本身时，从 _otherInstanceMethod 返回值的正确咖啡脚本方法是什么？

```
x = _instanceMethod: () ->
    @_otherInstanceMethod key: 'value' 
```

编辑（感谢评论者）

这将返回：

```
x = function () {
    [...] # function body omitted    
}); 
```

代替

```
x = 'some value returned by _otherInstanceMethod' 
```

我希望返回值而不是绑定到 _otherInstanceMethod 的函数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:17:57.733

作为 Coffeescript 的新手，这是我的错。我正在调用实例方法，例如：

```
@_instanceMethod 
```

代替

```
@_instanceMethod() 
```

抱歉给您添麻烦，投票删除

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-13T20:08:52.677

在 CoffeeScript中`@something`翻译成`this.something`不管底层变量类型。这意味着您`@`只能与属性结合使用，您仍然应该使用旧的方法`this`。

# .net - 就在 OutOfMemoryException 之前的 WorkingSet 峰值

> ID：13866386
> 
> 赞同：1
> 
> 时间：2012-12-13T18:47:33.747
> 
> 标签：.net, memory, out-of-memory, perfmon, working-set

我正在调查“传统”.NET 服务器应用程序在生产中引发 OutOfMemoryException 的事件。我的目的是解释通过性能监视器收集的数据的特定部分，并寻求一些关于如何继续前进的建议。让我从一个事实清单开始：

1.  该过程已经运行**了 20 多天**，直到崩溃。
2.  它崩溃是因为抛出了**System.OutOfMemoryException**类型的异常。
3.  过去也发生过类似的事件。同样，应用程序崩溃需要很**长时间**。
4.  该进程已通过以下计数器通过性能监视器进行监视：**# 所有堆中的字节数、% 处理器时间、专用字节数、工作集。**
5.  我们**无法**在生产环境中捕获任何内存转储，也无法重现它。

在第一个屏幕截图中，您可以看到计数器在 7 天内的整体行为。事情非常稳定。第二个屏幕截图显示了崩溃前后最后一分钟的行为。OutOfMemoryException 记录在**3:13:49PM**。

![7天行为](../Images/35f8a89095f46e8526c7d01d58fa43e7.png) ![坠机前的最后一分钟](../Images/4735ce40c782396c6f753838cbb441f7.png)

我的问题是： 1.**工作集突然增加**意味着什么？它总体稳定在 650 多 MB，并在 10 秒内攀升至 1.3GB。2.我应该专注于在崩溃之前找到**触发OOM的东西，还是它可能是一个****累积因素**？如您所见，私有字节和所有堆上的字节非常稳定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:10:08.663

这类问题极难诊断。很可能发生的事情不是触发行为的单一条件的结果，而是一组同时发生的条件。

以下是我们所知道的：

1.  **没有显示累积性问题：** 如果问题是累积性的，我们预计会看到导致事件发生的 20 天期间的一些迹象。这并不意味着前面的操作可以忽略。触发行为的某些条件可能是预先安排的，并且更早开始。这是我们无法通过现有信息知道的事情。

2.  **堆是稳定** 的：Private Bytes 度量告诉我们保留了多少内存（未触及，如 stephbu 建议的那样）。Bytes-in-all-Heaps 告诉我们当前根据内存管理器 (GC) 分配了多少保留内存。由于这两个都是稳定的，因此问题似乎不一定是内存泄漏。危险在于我们只有 10 秒的有趣数据，而且由于 GC 通常是相当被动的，因此不清楚这些统计数据的准确度（尤其是不稳定的工作集）。

3.  **工作集表明颠簸：** 工作集告诉我们操作系统想要保持多少物理内存以确保合理的性能。不断增长的工作集表明抖动。不断增长的工作集通常与两件事相关联：

    *   增加分配率

    *   增加对象寿命（通常是暂时的）

    没有指出增加的对象寿命，因为堆没有显示增长。增加分配率是可能的，但对象仍然是短暂的（因为未指示泄漏）。

这些观察结果向我表明，一些罕见的事件（或一组事件）正在触发以下情况：

*   高分配率

*   中等大小的物体

*   寿命不长

*   GC因此而颠簸

还有[其他关于](https://stackoverflow.com/questions/11974694/avoiding-outofmemoryexception-during-large-fast-and-frequent-memory-allocations)这些情况导致 OutOfMemoryExceptions 的报告。我不太确定它为什么会发生。如果您运行的是 32 位环境，那么一个可能的原因是地址空间的碎片。如果 GC 无法从操作系统获取连续页面，则可能会发生这种情况。

另一种可能性（我无法验证）是 GC 请求操作系统不要分页它正在处理的堆的部分。如果锁定页数变高，可能会导致内存不足。这个想法几乎完全是猜测，因为我对微软 GC 实现的内部了解不够。

我现在没有更好的解释，但如果有人能提供一个更好的解释，我肯定会想要一个更好的解释。

最后，您可能想要验证是否启用了合理的[延迟模式。](http://msdn.microsoft.com/en-us/library/bb384202.aspx)如果这是问题所在，我想我们会看到 Bytes-in-all-Heaps 的升级——所以它可能没问题。

**附言**

你能检查第二张图表中虚线表示的变量是什么吗？如果是处理器使用，则与抖动一致。随着更频繁地调入内容的需求增加，磁盘 IO 应该增加，并且（在某个点）处理器使用百分比应该下降，因为一切都在等待磁盘。这只是一个额外的细节——如果处理器的使用没有过度下降，抖动仍然是一种可能性。这是因为部分软件可能仍然表现出良好的局部性并能够取得进展。

# sql - SQL 列加密的用处

> ID：13866397
> 
> 赞同：2
> 
> 时间：2012-12-13T18:48:05.260
> 
> 标签：sql, encryption, database-security

我已按照[http://msdn.microsoft.com/en-us/library/ms179331.aspx](http://msdn.microsoft.com/en-us/library/ms179331.aspx)对 SQL Server 中的列进行加密。

```
CREATE MASTER KEY ENCRYPTION BY PASSWORD = 'T3stP@ssword'

CREATE CERTIFICATE TestCert WITH SUBJECT = 'SSN Encryption'

CREATE SYMMETRIC KEY HRKey
    WITH ALGORITHM = DES
    ENCRYPTION BY CERTIFICATE TestCert;

OPEN SYMMETRIC KEY HRKey
   DECRYPTION BY CERTIFICATE TestCert;

UPDATE [dbo].[Person]
   SET [EncryptedSSN] = EncryptByKey(Key_GUID('HRKey'), CAST(SSN AS varchar(10)));

SELECT TOP 10 * FROM Person

1   Tom Thomson 111111111 0x0026DA624DBCA04CBCBF621FD5F......
2   Steve   Stephenson  222222222 0x0026DA624DBCA04CBCBF6..... 
```

表明我已经加密了数据，这正是我想要的。

```
OPEN SYMMETRIC KEY HRKey
   DECRYPTION BY CERTIFICATE TestCert;

SELECT PersonID, Firstname, Lastname [SSN], 
    CONVERT(VARCHAR, DecryptByKey([EncryptedSSN])) 
    AS 'Decrypted SSN'
    FROM [dbo].[Person]

1   Tom Thomson     111111111   111111111
2   Steve   Stephenson  222222222   222222222

   Close SYMMETRIC KEY HRKey 
```

忽略我还有一个未加密的列，问题是这有什么真正改进，我很容易打开密钥并用它来解密数据。我想我缺少一些理解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:51:41.357

密钥与用户帐户相关联，这意味着需要凭据才能访问密钥。如果黑客可以劫持该身份，那么您的担忧就存在了。但是，简单地复制或窃取 IO 子系统不足以破解加密，也不能使用不同的帐户访问 IO 子系统。

此外，为了完全安全，备份媒体也必须受到保护。备份未加密的数据会创建另一个攻击媒介。如果您为较大的客户端运行 SaaS，或者您必须遵守 HIPAA 或 PCI 等标准，您可能需要确保备份区域加密。

# c - 输入有效输入后，while循环会挂起程序吗？

> ID：13866403
> 
> 赞同：0
> 
> 时间：2012-12-13T18:48:26.470
> 
> 标签：c, while-loop, freeze

自昨晚以来，我一直断断续续地遇到这个问题，我希望第二双新鲜的眼睛会有所帮助。

问题是，如果在函数中输入了无效输入`userIn`（不是 1-99 之间的数字），则在 while 循环结束时的测试 printf`main`打印“ERR = 1”，while 循环并`userIn`再次被调用. 到目前为止一切顺利，但是当输入有效输入时，while 循环结束时的测试 printf 会打印“ERR = 0”，然后程序挂起。测试 printf 说“HELLO”永远不会被打印出来。

任何关于为什么的建议都是最受欢迎的。

编码：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>

void userIn (int *x)
    {
    char b;
    printf("Please enter a new value for Vm: ");
    scanf(" %i",x);
    while (((b=getchar())!='\n')&&(b!=EOF));
    return; 
    }
int main (void)
    {
    int  fd, x, err;
    char *npipe = "/tmp/fms",
         input[3];
    struct stat info;
    printf("\n");

    //get user input
    err = 1;
    while (err)
        {
        userIn(&x);
        if (x > 0 && x < 100) err = 0;
        //else printf("\033[1A\033[K");

        printf("ERR = %i\n",err);//TEST PRINTF
        }
    printf("HELLO");//TEST PRINTF

    //if pipe exists
    if ( (!lstat(npipe,&info)) && (S_ISFIFO(info.st_mode)) )
        {
        sprintf(input,"%i",x);
        //write user input to named pipe created by 'parent.c'
        fd = open(npipe, O_WRONLY);
        write(fd, input, sizeof(input));
        close(fd);
        }
    else printf("\033[0;31mNamed pipe doesn't exist, %i not passed.\n\n\033[0m",x);
    return 0;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:53:30.817

与您的直觉相反，程序在该行*之后*`printf("HELLO");`的某处冻结。由于您在该 printf 中没有换行符，因此`HELLO`会被缓冲并且不会立即刷新到终端。

是否有从您的管道另一端读取的进程？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T18:55:09.320

如果我在我的系统上运行您的代码，输出如下所示：

```
Please enter a new value for Vm: 101
ERR = 1
Please enter a new value for Vm: 1
ERR = 0
HELLONamed pipe doesn't exist, 1 not passed. 
```

也就是说，循环恰好在您认为应该退出的时候退出。当然，代码然后立即退出，因为`/tmp/fms`我的系统上不存在。

但是，如果我*创建* `/tmp/fms`，那么我会看到：

```
Please enter a new value for Vm: 1
ERR = 0 
```

...并且没有额外的输出。这是因为`printf`语句的输出是缓冲的，而对命名管道的写入是阻塞的，所以输出永远不会被刷新。将 a 添加`\n`到您的 printf 可能会按您的预期显示它。

# algorithm - 在笛卡尔平面上绘制、拖放和重叠形状的基本算法

> ID：13866406
> 
> 赞同：2
> 
> 时间：2012-12-13T18:48:30.263
> 
> 标签：algorithm, drag-and-drop, drawing

我计划构建一个能够在 HTML 5 画布元素上绘制形状的 HTML 5 应用程序。

我的项目旨在创建一种图表工具，该工具将在所有这些工具中使用矩形、三角形、圆形、菱形和线条，用户可以随时调整形状的大小和位置。

市场上有很多工具可以实现这种逻辑。我们可以在多年来以多种不同编程语言实现的许多图表工具中找到它。MS Vision、OmniGraffle、Rational Rose、老ERWin等产品。

所以我想知道在计算机科学领域中是否有任何众所周知的（通用）算法针对在笛卡尔平面上绘制、调整大小、拖动、放下以及因此重绘形状的任务，我应该在编写自己的图形之前研究这些算法从零开始的算法。

欢迎任何参考。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:16:16.437

我认为最接近你所问的领域是[计算几何](http://en.wikipedia.org/wiki/Computational_geometry)，但大多数问题是关于优化而不是关于可视化。

但是如果你想重用某些东西，最好的重用是一个好的[计算机辅助设计](http://en.wikipedia.org/wiki/Computer-aided_design)框架的代码，但这取决于你将选择使用的编程语言。

# xml - XPath 选择具有排除项的元素（具有多个子元素）

> ID：13866414
> 
> 赞同：4
> 
> 时间：2012-12-13T18:48:59.277
> 
> 标签：xml, xpath

我有以下类型的 XML：-

```
 <tagCategory name="Bike" id="10">
  </tagCategory>
  <tagCategory name="Cars" id="22">
    <excludedClass>NonDriver</excludedClass>
    <excludedClass>BannedFromDriving</excludedClass>
  </tagCategory>
  <tagCategory name="PogoStick" id="5">
<excludedClass>NoLegs</excludedClass>
  </tagCategory> 
```

我想在我可以说的地方运行查询：-

给我 excludeClass 不是 X 的所有 tagCategory 元素。例如：-

*   给我所有的 tagCategory 元素，其中 excludeClass 不是 'NoLegs' 应该返回 Cars 和 Bike。
*   给我所有的 tagCategory 元素，其中 excludeClass 不是 'BannedFromDriving' 应该返回 Bike 和 PogoStick。
*   给我所有的 tagCategory 元素，其中 excludeClass 不是 'NonDriver' 应该返回 Bike 和 PogoStick。

我正在使用当前的 XPath，它处理只有一个 excludeClass 的元素，但是在存在多个的地方，它不会像我期望的那样过滤掉这些项目。

`"//tagCategory[excludedClass!='" + classification + "' or not(excludedClass)]"`

有谁知道如何修改我的 XPath 以提供我需要的东西？

真的很感激任何想法。

亲切的问候，

菲尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:16:00.780

尝试使用类似的东西：

```
//tagCategory[not(excludedClass='NonDriver')] 
```

例子：

```
//tagCategory[not(excludedClass='" + classification + "')] 
```

# c# - 关闭 Windows 框 C#

> ID：13866423
> 
> 赞同：5
> 
> 时间：2012-12-13T18:49:35.127
> 
> 标签：c#, windows

我想知道是否有人知道如何使用 ac# 命令打开此框？

![在此处输入图像描述](../Images/1f4abc9d681b9453acd552678ae1ac0b.png)

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T18:56:40.320

您必须添加对 Shell32.dll (COM -> "Microsoft Shell Controls And Automation") 的引用并使用以下代码：

```
 Shell32.Shell shell = new Shell32.Shell();
 shell.ShutdownWindows(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:56:54.793

添加对 C:\Windows\System32\Shell32.dll 的引用。完成此操作后，使用以下代码：

```
Shell32.ShellClass sc = new Shell32.ShellClass();
sc.ShutdownWindows(); 
```

这将正常显示关闭对话框。

# c++ - 如何从c中的dll调用源代码中的函数

> ID：13866424
> 
> 赞同：0
> 
> 时间：2012-12-13T18:49:36.493
> 
> 标签：c++, dll

我已经在 C++ 中创建了一个 DLL，并且已经成功地能够在另一个应用程序中使用它。我想要的是在我的应用程序代码中使用一个函数——而不是 DLL——并且能够在 DLL 中使用该函数。

这可能吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T18:58:26.247

当然 - 如果您可以调用 DLL 中的函数，您可以例如从宿主应用程序（或同一进程中的另一个 DLL）传递函数指针，然后调用它们：

```
// DLL side:
typedef void (*CallbackFunc)();
APISTUFF void dllFunction(CallbackFunc f) {
  f();
}

// hosting app side:
void hostFunction() {
    // ...
}

void doPluginStuff() {
  // ... load DLL, resolve dllFunction, etc.
  dllFunction(&hostFunction);
} 
```

这就是像[NPAPI这样的 C 风格](http://en.wikipedia.org/wiki/NPAPI)[插件 API](http://en.wikipedia.org/wiki/Plug-in_%28computing%29)的工作方式。

# android - 应用程序是否存在？安卓（处理程序问题）

> ID：13866425
> 
> 赞同：0
> 
> 时间：2012-12-13T18:49:49.877
> 
> 标签：android, android-activity, android-handler

```
handler.postDelayed(new Runnable() {
            public void run() {
                if (MainTab.isRunning == true)
                    ;
                {
                    Dialog.show();
                }
            }
        }, Sec * 1000); 
```

isRunning 是一个变量，在我的活动中，只要它调用 onStop 或 onPause 方法，它就会变为 false。但是它不起作用，即使我关闭我的应用程序对话框仍然想添加一个窗口并且我收到错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:51:37.140

删除多余的`;`：

```
handler.postDelayed(new Runnable() {
            public void run() {
                if (MainTab.isRunning == true)
                {
                    Dialog.show();
                }
            }
        }, Sec * 1000); 
```

它会导致您的 if 语句变得无用，因为它指示 java 将下一行解释为新指令，而不是 if 语句的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:54:58.507

即使它现在什么也不做，你的回调仍然会执行，这是不必要的。您应该使用[`removeCallbacksAndMessages()`](http://developer.android.com/reference/android/os/Handler.html#removeCallbacksAndMessages%28java.lang.Object%29)in取消回调`onPause()`：

```
handler.removeCallbacksAndMessages(null); 
```

或者保存对您的可运行文件的引用并调用`handler.removeCallback(runnable)`.

# php - 从php中的self join中检索行

> ID：13866428
> 
> 赞同：0
> 
> 时间：2012-12-13T18:50:14.147
> 
> 标签：php, sql

我对我的表使用了自联接，但我无法检索表行

```
$SQL1 = "SELECT e1.userid, e2.userid
FROM userfield AS e1, userfield AS e2
WHERE e1.field5 = e2.field5 and e1.field5!=' ' and e2.field5!=' ' and e1.userid!=e2.userid";

$result2 = mysql_query($SQL1);

while ($db_field2 = mysql_fetch_assoc($result2)) {
    print $dbfield2[userid];  
} 
```

当我执行此代码时，它只显示空白页。当我在 msql 数据库中触发此查询时，它返回两个用户 ID

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T11:24:50.843

你必须给他们这样的别名：

```
$SQL1 = "SELECT e1.userid AS userid1, e2.userid AS userid2
         FROM userfield AS e1, userfield AS e2
         WHERE e1.field5 = e2.field5 and e1.field5!=' ' and e1.userid!=e2.userid";

$result2 = mysql_query($SQL1);

while ($db_field2 = mysql_fetch_assoc($result2)) {
    print $dbfield2['userid1'];  
} 
```

请考虑切换到 PDO oder mysqli。所有 mysql_* 函数都被正式标记为已弃用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:47:35.803

```
$SQL1 = "SELECT e1.userid, e2.userid
    FROM userfield AS e1, userfield AS e2
    WHERE e1.field5 = e2.field5 and e1.field5!=' ' and e1.userid!=e2.userid";

$result2 = mysql_query($SQL1);

while ($db_row = mysql_fetch_assoc($result2)) {
    print $db_row['e1.userid'];  
} 
```

PS您不需要`and e2.field5!=' '`in`WHERE`子句，因为`e2.field5`必须等于`e1.field5`and `e1.field5!=' '`。

# javascript - 遍历数组的多个 jQuery 命令

> ID：13866429
> 
> 赞同：-1
> 
> 时间：2012-12-13T18:50:20.630
> 
> 标签：javascript, jquery, arrays, loops

我得到了以下 jQuery 东西，我在其中输入了数组编号和选择器位置，我可以用 for 循环在一个块中执行此操作吗？

```
jQuery(document).ready(function(){

    jQuery('.hoverB0x:eq(0)').html('<a style="background:white;" class="imageLink" href="${createLink(uri: "/beirat/")}">Profil von' + names[0]+'</a>');
    jQuery('div.name:eq(0)').html(title[0]+' '+names[0]);
    jQuery('div.description:eq(0)').html(funktion[0]);
    jQuery('a.imageLink:eq(0)').prop('href', 'beirat/'+ident[0]);
    jQuery('a.contentLink:eq(0)').prop('href', 'beirat/'+ident[0]);
    jQuery('.profilBildInner:eq(0) img').attr('src', base+ident[0]+'.png'); 
```

现在大约 10 个块将跟进 eq([arrayPos]) 和 names/ident[arrayPos]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:53:49.723

当然是：

```
for (var i = 0; i < 3; i++){
    $('.hoverB0x:eq(' + i + ')').html('<a style="background:white;" class="imageLink" href="${createLink(uri: "/beirat/")}">Profil von' + names[i]+'</a>');
    $('div.name:eq(' + i + ')').html(title[i]+' '+names[i]);
    $('div.description:eq(' + i + ')').html(funktion[i]);
    $('a.imageLink:eq(' + i + ')').prop('href', 'beirat/'+ident[i]);
    $('a.contentLink:eq(' + i + ')').prop('href', 'beirat/'+ident[i]);
    $('.profilBildInner:eq(' + i + ') img').attr('src', base+ident[i]+'.png');

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:53:52.313

使用 for 循环：

```
for (var i = 0; i < 3; i++) {
    jQuery('.hoverB0x:eq(' + i + ')').html('<a style="background:white;" class="imageLink" href="${createLink(uri: "/beirat/")}">Profil von' + names[i] + '</a>');
    jQuery('div.name:eq(' + i + ')').html(title[i] + ' ' + names[i]);
    jQuery('div.description:eq(' + i + ')').html(funktion[i]);
    jQuery('a.imageLink:eq(' + i + ')').prop('href', 'beirat/' + ident[i]);
    jQuery('a.contentLink:eq(' + i + ')').prop('href', 'beirat/' + ident[i]);
    jQuery('.profilBildInner:eq(' + i + ') img').attr('src', base + ident[i] + '.png');
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T18:54:53.060

我不明白为什么不...只是更改索引以使用`for`循环的增量计数器。您没有展示如何获得`names`、`ident`或`funktion`数组，但推测它们的大小相同，并且在文档中保存了您期望的正确数量，因此使用其中一个来获得您的基本增量范围。

```
for (var i = 0; i < ident.length; i++){
    $('.hoverB0x:eq(' + i + ')').html('<a style="background:white;" class="imageLink" href="${createLink(uri: "/beirat/")}">Profil von' + names[i]+'</a>');
    $('div.name:eq(' + i + ')').html(title[i]+' '+names[i]);
    $('div.description:eq(' + i + ')').html(funktion[i]);
    $('a.imageLink:eq(' + i + ')').prop('href', 'beirat/'+ident[i]);
    $('a.contentLink:eq(' + i + ')').prop('href', 'beirat/'+ident[i]);
    $('.profilBildInner:eq(' + i + ') img').attr('src', base+ident[i]+'.png');

} 
```

此外，如果可能的话，将这些数组组合成一个单独的 hahses 数组会更有意义，例如：

```
var values = [
  {ident: 'ident_value', funktion: 'function_value', name: 'name_value'}
]; 
```

然后你可以这样做：

```
for (var i = 0; i < values.length; i++){
    $('.hoverB0x:eq(' + i + ')').html('<a style="background:white;" class="imageLink" href="${createLink(uri: "/beirat/")}">Profil von' + values[i].name+'</a>');
    $('div.name:eq(' + i + ')').html(title[i]+' '+values[i].name);
    $('div.description:eq(' + i + ')').html(values[i].funktion);
    $('a.imageLink:eq(' + i + ')').prop('href', 'beirat/'+values[i].ident);
    $('a.contentLink:eq(' + i + ')').prop('href', 'beirat/'+values[i].ident);
    $('.profilBildInner:eq(' + i + ') img').attr('src', base+values[i].ident+'.png');

} 
```

# javascript - $(elem) 的目的是什么？

> ID：13866433
> 
> 赞同：1
> 
> 时间：2012-12-13T18:50:53.430
> 
> 标签：javascript, jquery

什么`$(elem)`时候使用它？

我的 javascript 函数有问题，我有 3 个表单，这 3 个表单有时共享相同的字段类，因此当我尝试对表单的 1 个进行验证时，即使它已正确填写，它也会返回错误，因为该函数将获得另一种形式的类，我的一个朋友说要使用 $(elem)，因为它可以解决他的问题，但我不知道如何使用 $(elem)，何时使用，以及如何使用这行得通。

如果有人能向我解释这一点，那就太好了。

一个例子也将不胜感激:)

例子：

```
function dispFields(a, b, c, z, ch) 
{
    var valid;
    var blanks = Array();
    var blanks2 = Array();
    var email_reg = /^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/;
    var myVal = $('#'+a).find('input.required').map(function() {
                               return $(this).val();
                               }).get().join(',');
    var myTitle = $('#'+a).find('input.required').map(function() {
                               return $(this).attr("title");
                               }).get().join(',');

    var myEmail = $('#'+a).find('input.email-field').map(function() {
                               return $(this).val();
                               }).get().join(',');

    var myEmailtitle = $('#'+a).find('input.email-field').map(function() {
                               return $(this).attr("title");
                               }).get().join(',');

        var email_val = myEmail.split(',');
        var email_title = myEmailtitle.split(',');
        var email_error = email_val.length;
        var error_form = myVal.split(',');
        var error_title = myTitle.split(',');
        var errorlength = error_form.length;

        String.prototype.email_match = function(s){
           return this.match(s)!==null 
        }
        for(y=0;y<email_error;y++){
            if (!('indexOf' in Array.prototype)) {
                Array.prototype.indexOf= function(finds, is /*opt*/) {
                    if (is===undefined) is= 0;
                    if (is<0) is+= this.length;
                    if (is<0) is= 0;
                    for (var n= this.length; is<n; is++)
                        if (is in this && this[is]===finds)
                            return is;
                    return -1;
                };
            }
            if((error_title.indexOf(email_title[y])) == -1){    
                if(email_val[y] == ''){
                    valid = true;
                }else{
                    if(email_reg.test(String(email_val[y]).toLowerCase())==false){
                        blanks2[y] = email_title[y]+" - Should be valid email";
                        valid = false;
                    }
                }
            }
        }
        for(x=0;x<errorlength;x++){
            if(error_form[x] == ''){
                    if(myTitle == ''){
                        valid = true;
                    }else{
                        blanks[x] = "Required - "+error_title[x];
                        valid = false;
                    }
            }else{
                var myBool = (String(error_title[x]).toLowerCase()).email_match("email");
                if(myBool == true){
                    if(email_reg.test(String(error_form[x]).toLowerCase())==false){
                        blanks[x] = error_title[x]+" - Should be valid email";
                        valid = false;
                    }
                }else{
                    if(blanks == ''){
                        valid = true;
                    }
                }
            }   
        }
        if(blanks == '' && blanks2 == ''){
            valid = true;
            }else{
            valid = false;
        }

        var blankc = blanks.concat(blanks2);
        var requiredS = blankc.toString();
        var nblank = requiredS.split(',').join("\n");

        if(valid != true){  
            alert("Please review:\n\n"+nblank);
            document.getElementById(a).style.display = "";
            document.getElementById(b).style.display = "none";
        }else{
            var ssplits = z.split(',');
            var fieldlengths = ssplits.length;
            var indexes = fieldlengths - 1;
            var d;
            var e;
            d=parseInt(c,10)+1;
            e=d-1;

            if(b == ssplits[indexes]){
                $("#step"+d).addClass("active");
                $("#step"+e).removeClass("active");
                document.getElementById(a).style.display = "none";
                document.getElementById(b).style.display = "";
                document.getElementById("tbutton").style.display = "";
                document.getElementById("tcont").style.display = "none";    
                document.getElementById("captchas").style.display = "none";     
            }

            $("#step"+d).addClass("active");
            $("#step"+e).removeClass("active");
            document.getElementById(a).style.display = "none";
            document.getElementById(b).style.display = "";
            if(b == ch){
                document.getElementById("captchas").style.display = "";     
            }
        }
    return false;
} 
```

现在，每当我提交表单时都会调用此函数，但在一个页面中，我可以有 2 或 3 个可能具有“必需”类的表单，因此即使表单中的字段已填满，它仍然会警告错误，因为它是获取其他形式的字段的类。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T18:52:18.427

`$`是（通常）[jQuery](http://jquery.com/)函数。

如果您使用 jQuery，那么`$(elem)`将包装`elem`为 jQuery 对象，并让您访问它的所有实用方法。

您的朋友可能建议您使用 jQuery，这样您就可以执行以下操作：

```
if ($(elem).hasClass('<your validation class>')) { 
```

* * *

编辑 - 查看您刚刚添加的代码，看起来您已经在使用 jQuery。如果没有更多关于你朋友所说的内容的背景，很难推测出它的意思。

如果您有关于如何使用 jQuery 完成某事的特定问题，您可以随时发布一个新问题，其中包含更精简的代码片段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:54:02.610

> ** $ 帮助您获取与选择器组合的元素的处理程序。** 例如，您有一个具有类 A 的元素，您可以使用 $ 获取该元素的处理程序 -> $(".A" ) [ . -> 类选择器，# -> id 选择器]。因此，为了使用 jquery，您必须使用 $ 和选择器来操作元素，即 $(".A").text("myText") -> 使用类设置所有元素的文本一个

# php - 如何从 XML 文件中的 HTML 内容中删除命名空间

> ID：13866436
> 
> 赞同：2
> 
> 时间：2012-12-13T18:50:57.300
> 
> 标签：php, xml, xpath, simplexml

我通过 API 接收 XML 文件并使用 PHP/SimpleXML/XPath 对其进行解析。

我需要从包含 HTML 的字段之一获取数据并将其输出，但是 HTML 都以“h:”命名空间为前缀。

示例 XML：

```
<xmlfeed>
 <title>Title Here</title>
  <a:content xmlns:a="http://www.w3.org/2005/Atom" xmlns:h="http://www.w3.org/1999/xhtml">   
    <h:table xmlns:h="http://www.w3.org/1999/xhtml" width="1360" height="259" cellspacing="0" cellpadding="0" border="0">
     <h:tbody><h:tr><h:td width="35%" colspan="3"></h:td></h:tr></h:tbody>
    </h:table>
  <h:h3 xmlns:h="http://www.w3.org/1999/xhtml">Test heading here</h:h3>
  <h:a href="link.php">Link Here</h:a>
 </a:content>
</xmlfeed> 
```

如何解析 a:content 中的所有 HTML 以从每个元素以及命名空间中删除“h:”前缀？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T14:29:34.537

我不精通 PHP 或 simpleXML，但由于没有其他人回答，我会尝试一下。（我确实很了解 XML 和 XPath。）

输入中元素的子`<a:content>`元素是 XHTML 元素。大多数浏览器都可以识别 XHTML。它是 XHTML 名称空间中的一个 XML 词汇表，在其他方面非常接近 HTML。

所以我认为你不需要删除任何命名空间。相反，选择 的孩子`<a:content>`，使用

```
$xml->xpath('//a:content/node()') 
```

并输出每一个。（听起来您需要对每一个进行序列化，而不仅仅是回显它们的值。）

请注意，为了使上述 XPath 表达式起作用，您首先需要注册`a`名称空间前缀（请参阅[registerXPathNamespace](http://php.net/manual/en/simplexmlelement.registerxpathnamespace.php)和那里的示例）。

希望这能让你走得更远。如果您还有其他问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T22:59:17.070

我一定在文档中忽略了[这一点。](http://php.net/manual/en/domelement.removeattributens.php)

花了一点时间才找到，但以下似乎效果很好：

```
$content = $xpath->query('a:content/h:*', $context);
foreach ($content as $piece)
{
    $piece->removeAttributeNS('http://www.w3.org/1999/xhtml', 'h');
    $html_content .= $dom->saveXML($piece);
} 
```

希望这有助于其他人试图解决同样的问题。

# image-processing - 有没有一种快速方法可以从 WebGL / Javascript 中的几个帧缓冲区中获取平均颜色？

> ID：13866438
> 
> 赞同：1
> 
> 时间：2012-12-13T18:51:03.723
> 
> 标签：image-processing, colors, webgl, average, framebuffer

我对 WebGL 主题很陌生。我想要做的是计算 6 个不同帧缓冲区的平均颜色，如下图所示。现在我想知道最好的方法是什么？我试着做

```
gl.readPixels(0, 0, 256, 256, gl.RGBA, gl.UNSIGNED_BYTE, pixelValues); 
```

但这似乎很慢......有没有办法在显卡上发生这种情况？

![在此处输入图像描述](../Images/1b69b7e581307b84b5175a66226a26f3.png)

```
this is how the FBO is set up - I have this from a tutorial:

... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T07:32:18.237

在我的头顶

1.  做6个fbo。
2.  确保每个 fbo 都使用纹理附件，而不是渲染缓冲区。
3.  将 6 个场景渲染到 6 个 fbo
4.  对于每个纹理调用 gl.generateMipmap(...)
5.  编写一个着色器，它采用 6 个纹理并使用带有偏差选项的 texture2D 对它们进行平均。将偏差设置为纹理中的级别数。这是告诉 GPU 使用最小级别。
6.  使用该着色器将单位四边形渲染到 1 像素 fbo（或后缓冲区中的 1 像素）。
7.  在该 1 个像素上调用 gl.readpixels。

我认为着色器看起来像这样

--片段着色器--

```
precision mediump float;

uniform sampler2D u_textures[6];
uniform float u_bias;

void main() {
   // since we know we are rendering only with the last mip
   // then there is only 1 texel.
   vec2 center = vec2(0.5, 0.5);
   vec4 sum = 
     texture2D(u_textures[0], center, u_bias) +
     texture2D(u_textures[1], center, u_bias) +
     texture2D(u_textures[2], center, u_bias) +
     texture2D(u_textures[3], center, u_bias) +
     texture2D(u_textures[4], center, u_bias) +
     texture2D(u_textures[5], center, u_bias);
   gl_FragColor = sum / 6.0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:04:04.147

你有两个选择

1.  编写一个片段着色器，通过渲染一个四边形（1 x 纹理高度），每行（每个纹理）运行一次，并遍历行中的所有像素并对它们进行平均。对平均行重复此过程，您将获得整个图像的平均值。这称为[流减少](http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter36.html)
2.  在您的 FBO 上调用[glGenerateMipMap ，然后访问最高级别的 mipmap（通过](http://www.opengl.org/sdk/docs/man4/xhtml/glGenerateMipmap.xml)[glGetTexLevelParameter](http://www.opengl.org/sdk/docs/man/xhtml/glGetTexLevelParameter.xml)获取此 mipmap 的参数）。现在您可以在大大减少和平均的 mip 图像上使用 ReadPixels 方法，也可以使用 GLSL，这应该会快得多。

# c++ - 可以锁定变量以防止在 C++ 中对其进行更改吗？

> ID：13866440
> 
> 赞同：8
> 
> 时间：2012-12-13T18:51:07.047
> 
> 标签：c++, variables, constants

我正在使用一个成员变量，并且在程序的某个时刻我想更改它，但我更喜欢在其他任何地方“锁定”它以防止意外更改。

代码解释：

```
class myClass {
    int x;  // This should be prevented to being changed most of the time
    int y;  // Regular variable
    myclass() {x = 1;}
    void foo1 () {x++; y++;} // This can change x
    void foo2 () {x--; y--;} // This shouldn't be able to change x
                             // I want it to throw a compile error
}; 
```

问题是：能以某种方式实现吗？像永久 const_cast 之类的东西？

我知道我可以立即使用构造函数初始化列表和常量，但我需要稍后更改我的变量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:31:17.623

好吧，我不喜欢所有其他答案，所以这是我的想法：隐藏变量。

```
#define READONLY(TYPE, VAR) const TYPE& VAR = this->VAR //C++03
#define READONLY(VARIABLE) const auto& VARIABLE = this->VARIABLE //C++11

class myClass {
    int x;  // This should be prevented to being changed most of the time
    int y;  // Regular variable
    myClass() :x(1), y(2) {}
    void foo1 () {// This can change x
        x++; 
        y++;
    } 
    void foo2 () {// This shouldn't be able to change x
        READONLY(x); //in this function, x is read-only
        x++; //error: increment of read-only variable 'x'
        y++;
    } 
}; 
```

仍然有绕过变量锁定的方法（例如`this->x`），但对于这些情况无能为力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:03:08.637

```
class myClass {
    int x;
    mutable int y;
public:
    myclass() : x(1) {}
    void foo1 () {x++; y++}      // this can change x or y
    void foo2 () const { y--; }  // this can't change x by can change y
}; 
```

如果您`const`像这样标记成员函数，则不能在该成员中执行任何会修改对象成员的操作（除非该成员是`mutable`或`static`-- 并且`static`根本不是对象的成员）。

请注意，这不会简单地阻止您调用尝试进行此类修改的函数——相反，标记`const`但尝试修改对象状态的函数根本不会编译。

然而，我应该补充一点，我根本不相信这真的是最好的设计。相反，在我看来，这听起来像是您的要求`x`并且`y`足够复杂，以至于它们作为直接强制执行适当约束的单独类可能更有意义（例如，通过提供`operator=`仅在正确情况下接受输入的重载）。

换句话说，`mutable`我上面显示的使用是（我认为）对您提出的问题的最简单和最直接的答案，*但*您似乎很可能并没有真正提出您应该提出的问题，而您'更有可能从改变设计中受益——不幸的是，你没有告诉我们足够的“大局”来建议更好的设计可能是什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T19:15:17.480

好吧，我不确定这是否值得您付出努力，无论如何，以防万一这是测验或某事，请尝试将私有继承与朋友结合起来：

```
class MyClassX {
protected:
  MyClassX() : x(1) {}
  int x;
public:
  int getX() const { return x; } // read only access
};
class MyClassY {
protected:
  MyClassY() : y(0) {}
  int y;
  friend class MyClass;
public:
  int getY() const { return y; }
};
class MyClassXY : private MyClassX, private MyClassY {
public:
    void foo1 () {x++; y++}      // this can change x or y
};
MyClass : public MyClassXY {
public:
    void foo2 () const { y--; }  // this can't change x but can change y
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T19:56:55.360

成为`x`的`private`成员`subClass`，并成为`foo1`的朋友功能`subClass`。像这样：

```
class myClass {
    int y;  // Regular variable
    myClass() : x (1) {}
    void foo1 () {x.x++; y++;} // This can change x
    void foo2 () {x.x--; y--;} // This shouldn't be able to change x
                            // I want it to throw a compile error
    class subClass {
      friend void myClass::foo1() ; // This must come after the declaration of foo1
      int x ; // private
    public:
      subClass (int x) : x (x) { }
      int read_x() const { return x ; }
      } x ;
}; 
```

这会在您想要的地方引发编译器错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T18:56:25.077

好吧，你不能做你想做的事......如果我错了，有人纠正我。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-13T19:15:42.340

从技术上讲，答案是否定的，只要类可以看到变量并且它不是常量 - 它可以修改它。但是你可以通过将你想要锁定的变量解耦到一个单独的类中来完成你想要的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-13T19:16:19.340

创建一个带有私有 x 变量的类。在里面写下你的方法。

从这个类派生出你的实际类。让 x 持有者成为实际班级的朋友。

X 持有者在 x 持有者中使用 CRTP 之类的强制转换（静态转换为基类）将其转换为指向实际类的指针。

从你的 x 持有者中暴露一个 x getter。

我不会打扰自己，但这比滥用 mutable 和 const 要好。

# javascript - 为什么 Javascript 的“in”运算符始终比严格的成员比较慢于未定义？

> ID：13866442
> 
> 赞同：13
> 
> 时间：2012-12-13T18:51:13.987
> 
> 标签：javascript

请参阅[http://jsperf.com/in-vs-member-object-access](http://jsperf.com/in-vs-member-object-access)

本质上，为什么检查`if ('bar' in foo) {}`明显慢于`if (foo.bar !== undefined) {}`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T18:57:45.997

`foo.bar !== undefined`仅检查这两个值以查看它们是否匹配。

While`'bar' in foo`将不得不使用某种机制来循环遍历 的属性`foo`以查看是否`bar`在其中。

这是来自 Ecma-script 的有趣读物

> # in 运算符
> 
> 产生式 RelationalExpression : RelationalExpression 在 ShiftExpression 中的评估如下：
> 1\. 评估 RelationalExpression。
> 2\. 调用 GetValue(Result(1))。
> 3\. 评估 ShiftExpression。
> 4\. 调用 GetValue(Result(3))。
> 5\. 如果 Result(4) 不是对象，则抛出 TypeError 异常。
> 6\. 调用 ToString(Result(2))。
> 7\. 使用参数Result(6)调用Result(4)的[[HasProperty]]方法。
> 8\. 返回结果(7)。
> 
> # 严格不等于运算符 ( !== )
> 
> 产生式 EqualityExpression : EqualityExpression !== RelationalExpression 评估如下：
> 1\. 评估 EqualityExpression。
> 2\. 调用 GetValue(Result(1))。
> 3\. 评估关系表达式。
> 4\. 调用 GetValue(Result(3))。
> 5\. 执行比较 Result(4) === Result(2)。（见下文。）
> 6\. 如果 Result(5) 为真，则返回假。否则，返回真。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-08T20:13:01.720

你是对的。`"bar" in foo`比 慢是没有意义的`foo.bar`。

唯一的原因是它没有像更常见的语法`in`那样受到 JIT 工程师的关注。`foo.bar`

特别是在您的 jsperf 测试中，该属性*确实*作为其`foo`自身的直接属性（不是原型）存在，因此按理说它`'bar' in foo`不应该比`foo.bar !== undefined`. 如果有的话，它应该更快。两者的主要区别在于，`in`甚至不用检查属性值就可以回答！

在这种`foo.bar`情况下，我希望 V8 引擎和 SpiderMonkey 引擎都会检测到代码没有做任何有用的事情（也就是说，它没有可观察到的效果）并完全优化它。基准没有衡量任何实际工作。

显然引擎还不够聪明，无法优化`"bar" in foo`，但这只是时间问题。和优先事项。

# php - MySQL 获取与 WHERE 子句匹配的列名

> ID：13866444
> 
> 赞同：1
> 
> 时间：2012-12-13T18:51:20.180
> 
> 标签：php, mysql

我有一个包含 4 列的 VIEW，我基本上将其用作全文搜索。用户在文本框中输入一个字符串，它会像这样查询 VIEW：

```
SELECT * FROM vw_clients WHERE
col1 = "'%".$userInput."%'"
OR col2 = "'%".$userInput."%'"
OR col3 = "'%".$userInput."%'"
OR col4 = "'%".$userInput."%'" 
```

我的结果正确返回，但有没有办法确定哪些列包含搜索词？通过 MySQL 还是 PHP？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T18:54:32.407

不是直接在 MySQL 中，但是有一些非常丑陋的 hack：

```
SELECT col1, (col1 LIKE '%$userinput%') AS found_in_col1,
     col2, (col2 LIKE '%$userinput%') AS found_in_col2, 
     etc...
etc...
WHERE ... 
```

在 php 中，只需遍历结果集中的字段并进行`strpos()`检查即可。不管怎样……丑陋。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T18:56:50.407

```
 SELECT 
      *,
      CONCAT_WS(',',
        IF(col1 = "'%".$userInput."%'",'col1',NULL),
        IF(col2 = "'%".$userInput."%'",'col2',NULL),
        IF(col3 = "'%".$userInput."%'",'col3',NULL),
        IF(col4 = "'%".$userInput."%'",'col4',NULL)) as colmatches
   FROM .... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:00:20.280

还有一种更丑陋的方法：在选择查询中使用“case”或“if”：

```
SELECT CASE WHEN col1='%value%' THEN 'col1' WHEN col2='%value%' THEN 'col2' END as found_column
FROM ....
WHERE .... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T19:40:27.127

像这样的东西：

```
SELECT IFNULL(v.col1 LIKE CONCAT('%','$userInput','%'),0) AS col1_match
     , IFNULL(v.col2 LIKE CONCAT('%','$userInput','%'),0) AS col2_match
     , IFNULL(v.col3 LIKE CONCAT('%','$userInput','%'),0) AS col3_match
     , IFNULL(v.col4 LIKE CONCAT('%','$userInput','%'),0) AS col4_match
     , v.*
  FROM vw_clients v
 WHERE v.col1 LIKE CONCAT('%','$userInput','%') = 1
    OR v.col2 LIKE CONCAT('%','$userInput','%') = 1
    OR v.col3 LIKE CONCAT('%','$userInput','%') = 1
    OR v.col4 LIKE CONCAT('%','$userInput','%') = 1 
```

* * *

注意这个结构容易受到 SQL 注入的影响；它取决于`$userInput`不包含 SQL 构造。例如

```
$userInput = "foo')=1 OR '1' LIKE CONCAT('1"; 
```

# ios - 根据数据对数组进行排序

> ID：13866446
> 
> 赞同：0
> 
> 时间：2012-12-13T18:51:24.730
> 
> 标签：ios, objective-c, sorting, xml-parsing, nsarray

我有一个表格视图，它显示存储在 NSObject 中的数组中的数据。NSObject 中的属性之一是 inputtime (currentCall.inputtime)，我想根据它对显示的数据进行排序。我该怎么做呢？谢谢。

这是我的 cellForRowAtIndexPath：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    JointCAD *currentCall = [[xmlParser calls] objectAtIndex:indexPath.row];
    static NSString *cellidentifier1 = @"cell1";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellidentifier1];

    if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:cellidentifier1];
    }

    cell.textLabel.text = currentCall.currentCallType;
    cell.detailTextLabel.text = currentCall.location;
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T18:58:23.320

您应该做的不是对 cellForRow 中的单元格进行排序，而是应该提前对数组进行排序，然后调用`[tableview reloadData]`.

有很多方法可以对数组进行排序，并且在不知道有关对象的所有信息的情况下，按日期排序的一种方法如下。

```
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"inputtime" ascending:TRUE];
[myMutableArray sortUsingDescriptors:[NSArray arrayWithObject:sortDescriptor]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T18:56:43.847

您必须先对数据模型进行排序。但在方法之外`didSelectRowforIndexPath`。

您可以访问代码中的某些位置：

```
currentCall = [[xmlParser calls] objectAtIndex 
```

此时数组必须已经排序。

进行排序，例如在`ViewWillAppear`. 在`cellForRowAtIndexPath`数据中已经必须进行排序。

如果数据模型动态变化，例如通过删除单元格行，那么您必须使用 `[self.tableView reloadData]`

# ruby-on-rails - 如何设置 before_update 来替换 params 给出的特定单词？

> ID：13866447
> 
> 赞同：1
> 
> 时间：2012-12-13T18:51:27.997
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在使用 Rails3、设计和acts_as_taggable_on。
在用户的编辑页面中，我为每个用户添加了标签输入框。
但用户可能会输入这样的内容

> 字 1，字 2。字3

它们应该用 ',(comma)' 分隔

所以我想检查并替换要排除的特定字符。
为此，我将此添加到我的用户模型中

```
before_update :check_taglist

def check_taglist
        tag_list = params[:tag_list].gsub(/[ ]+/," ")
        tag_list = params[:tag_list].gsub(/[.]+/,",")
end 
```

但它现在说的错误:(

> 未定义的局部变量或方法“参数”

我怎样才能解决这个问题？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:58:01.773

问题是您试图从模型中访问 params 哈希，而您的模型不知道 params 是什么。看起来像应该在控制器中的逻辑的任何地方？

此外，这也可能对您有所帮助。

这是另一种无需经过设计即可更新用户的方法

[Rails：设计：如何编辑用户信息？](https://stackoverflow.com/questions/10900664/rails-devise-how-can-i-edit-user-information)

# iphone - MFMailComposeViewController 的取消按钮（可能是操作表）冻结视图

> ID：13866460
> 
> 赞同：14
> 
> 时间：2012-12-13T18:52:27.957
> 
> 标签：iphone, ios, mfmailcomposeviewcontroller, mfmailcomposer, cancel-button

我之前已经看到过几个问题，[但是](https://stackoverflow.com/questions/4274895/action-sheet-doesnt-display-when-the-mfmailcomposeviewcontrollers-cancel-butto)由于缺乏可接受的答案以及根据需要实施了所有内容，我仍然继续面临以下问题：我显示邮件编写器，但单击取消时，编写器视图冻结. 我认为这是由于保存/删除草稿操作表出现在可见框架之外。是的，我已将 mailComposeDelegate 设置为呈现视图控制器，并阅读了用户尚未处理的几个类似问题`(void)mailComposeController:(MFMailComposeViewController*)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error`代表在取消时解雇作曲家。我也处理过这个问题，但我似乎一辈子都无法弄清楚为什么在我的通用应用程序的 iPhone 版本中，操作表不会出现在屏幕的可见区域中。以 NSLogged 模态显示邮件编写器的视图控制器的视图框架是 (0,0,320,480)。我的应用程序是通用的，邮件编辑器在 iPad 上完美运行。下面是在 iPhone Simulator 5.1 上运行的 composer 视图的截图：-

![在此处输入图像描述](../Images/500d1f4949cd2b1a75f0ea57abe1b49f.png)
这是显示 composer 的代码：

```
-(IBAction)mailButtonPressed:(id)sender {

    MFMailComposeViewController *controller = [[MFMailComposeViewController alloc] init];
    controller.mailComposeDelegate = self;
    [controller setSubject:@"Subject"];
    [controller setMessageBody:@"Test" isHTML:YES];
    [controller setToRecipients:nil];

    if(controller) {
        [self presentModalViewController:controller animated:YES];
        [controller release];
    }
}

- (void)mailComposeController:(MFMailComposeViewController*)controller 
          didFinishWithResult:(MFMailComposeResult)result
                        error:(NSError*)error 
{ 
    [self dismissModalViewControllerAnimated:YES];
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-25T14:01:20.577

为什么不尝试删除代码，然后按照在线教程重试，例如：

> [http://iphonedevsdk.com/forum/tutorial-discussion/43633-quick-tutorial-on-how-to-add-mfmailcomposeviewcontroller.html](http://iphonedevsdk.com/forum/tutorial-discussion/43633-quick-tutorial-on-how-to-add-mfmailcomposeviewcontroller.html)

在这种情况下，您总是会忘记工作所需的一行简单代码，因此遵循教程可以帮助我确保所有必要的代码都在那里。

试试这个代码：

```
- (void) mailComposeController:(MFMailComposeViewController *)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError *)error
{
    switch (result)
    {
        case MFMailComposeResultCancelled:
            NSLog(@"Mail cancelled");
            break;
        case MFMailComposeResultSaved:
            NSLog(@"Mail saved");
            break;
        case MFMailComposeResultSent:
            NSLog(@"Mail sent");
            break;
        case MFMailComposeResultFailed:
            NSLog(@"Mail sent failure: %@", [error localizedDescription]);
            break;
        default:
            break;
    }

    // Close the Mail Interface
    [self dismissViewControllerAnimated:YES completion:NULL];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-28T14:26:58.147

您正在尝试的设备可能由于某种原因无法发送邮件

你可以检查这个`[MFMailComposeViewController canSendMail]`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T13:24:01.043

在此处使用整个代码作为消息：

。H

```
 #import <MessageUI/MFMailComposeViewController.h>
    @interface EmailViewController : UIViewController<MFMailComposeViewControllerDelegate> 
```

.m

```
 -(IBAction)Email {

        MFMailComposeViewController *composer = [[MFMailComposeViewController alloc] init];
            [composer setMailComposeDelegate:self];
            if ([MFMailComposeViewController canSendMail]) {
                [composer setToRecipients:[NSArray arrayWithObjects:@"contact_aaron@easy.com", nil]];
                [composer setSubject:@"Idea for Basic Calculator"];
                [composer setMessageBody:@"My idea is:" isHTML:NO];
                [composer setModalTransitionStyle:UIModalTransitionStyleCoverVertical];
                [self presentModalViewController:composer animated:YES];

    }

-(void)mailComposeController:(MFMailComposeViewController *)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError *)error {
    if (error) {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error with message" message:[NSString stringWithFormat:@"Error %@", [error description]] delegate:nil cancelButtonTitle:@"Try Again Later!" otherButtonTitles:nil, nil];
        [alert show];
        [self dismissModalViewControllerAnimated:YES];
    }
    else {
        [self dismissModalViewControllerAnimated:YES];
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T21:06:12.587

看起来您没有使用自动引用计数 (ARC)。您过早地发布了邮件撰写控制器。解散后释放它。

删除此行：[controller release]

```
if(controller) {
    [self presentModalViewController:controller animated:YES];
    /// remove this: ---->  [controller release];
} 
```

并在此处释放此控制器

```
- (void)mailComposeController:(MFMailComposeViewController*)controller 
          didFinishWithResult:(MFMailComposeResult)result
                        error:(NSError*)error 
{ 
    [self dismissModalViewControllerAnimated:YES];

    [controller release]; // <----     add this
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T12:36:37.257

应用这个

```
-(void)displayComposerSheet

if(composer != nil) {

    [composer release];

    composer = nil;

} 
```

在赋予这个对象价值之后

```
[picker composer]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-30T00:46:28.890

将此添加到您的（所有） UIViewControllers 以检查您的 iPhone 是否耗尽或内存。这可以解释奇怪的行为，即 mailComposerSheet 发布了您的基本 viewController，因此 mailComposerDelegate 为 nil。

```
- (void)didReceiveMemoryWarning
{
  NSLog(@"didReceiveMemoryWarning");
  [super didReceiveMemoryWarning];
} 
```

# python - 带有 Celery 配置的 SQS

> ID：13866463
> 
> 赞同：13
> 
> 时间：2012-12-13T18:52:42.817
> 
> 标签：python, django, celery

我试图为 Celery 设置 Amazon SQS，我有以下配置：

```
BROKER_BACKEND = "SQS"
BROKER_TRANSPORT_OPTIONS = {
    'region': 'us-east-1',
}
AWS_ACCESS_KEY_ID = # access id
AWS_SECRET_ACCESS_KEY = # secret access key
os.environ.setdefault("AWS_ACCESS_KEY_ID", AWS_ACCESS_KEY_ID)
os.environ.setdefault("AWS_SECRET_ACCESS_KEY", AWS_SECRET_ACCESS_KEY)

BROKER_URL = 'sqs://'

CELERY_IMPORTS = ("tasks", )
CELERY_TASK_RESULT_EXPIRES = 300

CELERY_DEFAULT_QUEUE = #queue name
CELERY_DEFAULT_EXCHANGE = CELERY_DEFAULT_QUEUE
CELERY_DEFAULT_EXCHANGE_TYPE = CELERY_DEFAULT_QUEUE
CELERY_DEFAULT_ROUTING_KEY = CELERY_DEFAULT_QUEUE
CELERY_QUEUES = {
    CELERY_DEFAULT_QUEUE: {
        'exchange': CELERY_DEFAULT_QUEUE,
        'binding_key': CELERY_DEFAULT_QUEUE,
    }
} 
```

在我对 AWS 账户的 SQS 配置中，我有一个名为`CELERY_DEFAULT_QUEUE`. 当我在本地运行它时，一切正常……但由于某种原因，它在 SQS 上创建了另一个名为 format 的队列`<user_id>-celery-pidbox`。像这样的东西：`MyUser-MacBook-Pro-local-celery-pidbox`。

这是正常的吗？当我创建了一个指定名称的队列时，为什么还要创建另一个队列？否则，它的工作，不确定是否需要其他队列或我错过了什么？任何帮助表示赞赏，我在文档中找不到这个。

**编辑**

原来这是正常的。出于某种原因 django-celery 这样做，它为您访问要访问的队列的每个框创建一个队列。他们将在未来的版本中解决此问题。如果有人知道如何临时解决这个问题，请告诉我，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T19:07:29.227

这实际上是一个很好的行为，因此您可以监控哪些实例（IP 或本地名称）正在访问您的 SQS 帐户。这只是一个请求，因此不会花费您任何费用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-08-08T17:20:40.040

你需要设置这些：

```
 CELERY_ENABLE_REMOTE_CONTROL = False 
 CELERY_SEND_EVENTS = False 
```

禁用它。

# sql-server - 按当前周过滤矩阵

> ID：13866466
> 
> 赞同：1
> 
> 时间：2012-12-13T18:53:01.267
> 
> 标签：sql-server, reporting-services, reportbuilder

我正在尝试在 Report Builder 3.0 中构建一个报告，该报告将从星期一开始的每个工作日填充列标题，其中包含该周每一天的日期。然后，报告将计算这些日期每次出现在给定行条目的“接收日期”字段中的时间（参见下面的**图 1**）。

*我想知道如何在报表生成器中创建一个过滤器或参数，即使报表每天运行，也只显示给定的当前星期的日期，然后仍然能够进行计数。*

**图 1**：矩阵模型（日期为本周） ![在此处输入图像描述](../Images/8b3268cdb466b3197d82284532ba479e.png)

以前我使用此代码获取表格中的列以显示接下来的五个工作日（这在此处不起作用，因为我只需要那一周的工作日）：

```
=IIF(6 - WeekDay(Today()) - X < 0, DateAdd("d", X + 2, Today()), 
DateAdd("d", X, Today())) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T00:03:51.660

最简单的做法是让 SQL 为您完成繁重的工作，并以最方便报告的方式准备数据。所以我们要做的是获取与当前一周的工作日相关的所有数据 - 即从本周的星期一到本周的星期五的任何数据：

```
SELECT PersonId, SomeDate
FROM MyTable
WHERE SomeDate >= DateAdd('d', 0 - (WeekDay(Today())-2), Today())  // Monday
AND SomeDate <=  DateAdd('d', 0 - (WeekDay(Today())-6), Today())  // Friday 
```

然后，您只需将其输入您的矩阵，按人员和日期分组，您就可以开始了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T01:15:26.857

我没有可用的工具，但是如果您将过滤器添加到数据集或表中，基本上：

```
X > today() - day of the week --this will get the date for the sunday 
```

和

```
X < today() + (6 - day of the week) --this will get the date for saturaday 
```

这将确保您的数据在周一和周五之间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-02T07:36:07.877

```
Declare @DateFrm datetime= N'2014-11-04' 
Select 
    [EnquiryTypeValue],
    [CallerValue],
    Created  
FROM [BPU].[dbo].[vwEnquiry]  
WHERE 
    CAST(Created as date) between DATEADD(ww, DATEDIFF(ww,0,@DateFrm), 0) 
        and DATEADD(ww, DATEDIFF(ww,0,@DateFrm), 6) 
```

# r - 跨多个类别分箱

> ID：13866472
> 
> 赞同：2
> 
> 时间：2012-12-13T18:53:42.517
> 
> 标签：r

我正在尝试为我们的 6 台备份服务器创建一个备份持续时间的文本输出，该文本输出排序为 30 分钟增量箱。输入数据（称为 newdata）的示例如下：

```
 backup_server   client      duration  
1     bkp01           server_A    60       
2     bkp01           server_A    34       
3     bkp01           server_A    230     
4     bkp02           server_A    14      
5     bkp02           server_C    29   
6     bkp02           server_C    62 
```

现在我已经能够将*所有内容*与以下内容合并在一起：

```
br.br <-seq(0,max(newdata$duration),by=30)
cbind(table(cut(newdata$duration,br.br,right=FALSE))) 
```

它提供了这种输出：

```
 [,1]
[0,30)              3523
[30,60)             1394
[60,90)              230
[90,120)              35
[120,150)             10
[150,180)              0
[180,210)              3 
```

我想看到的是这样的：

```
[,1]                bkp01      bkp02
[0,30)               523        422
[30,60)              394         30
[60,90)              130         10
[90,120)               5          3
[120,150)              1          2
[150,180)              0         10
[180,210)              2         20 
```

我得到的最接近的是使用聚合函数，但并没有真正做我需要的。

```
> aggregate(newdata$Duration, by=list(newdata$TSM_server),FUN=mean)
  Group.1        x
1 bkp01       31.13307
2 bkp02       16.58491 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:15:25.087

如果这不是您想要的（并且通过将@joran 的解决方案与我的解决方案进行比较，您应该会发现对于所需的汇总措施存在相当大的歧义）......

```
 aggregate(newdata$Duration, 
           by=list(dur.cut=cut(newdata$duration,br.br,right=FALSE) , 
                   server=newdata$TSM_server),
            FUN=mean) 
```

然后试试这个：

```
 tapply( newdata$Duration, 
           INDEX=list(dur.cut=cut(newdata$duration,br.br,right=FALSE) , 
                   server=newdata$TSM_server),
            FUN=mean) 
```

有时设置`INDEX= interaction(var1, var2)`会产生略微不同但有时更理想的结果。（在测试这些时，我确实观察到列名与您的示例不同。）

```
 aggregate(newdata$duration, 
            by=list(dur.cut=cut(newdata$duration,br.br,right=FALSE) , 
                    server=newdata$backup_server),
             FUN=mean)
#------------
  dur.cut server    x
1 [30,60)  bkp01 34.0
2 [60,90)  bkp01 60.0
3  [0,30)  bkp02 21.5
4 [60,90)  bkp02 62.0

 tapply( newdata$duration, 
            INDEX=list(dur.cut=cut(newdata$duration,br.br,right=FALSE) , 
                    server=newdata$backup_server),
             FUN=mean)
#-------------
           server
dur.cut     bkp01 bkp02
  [0,30)       NA  21.5
  [30,60)      34    NA
  [60,90)      60  62.0
  [90,120)     NA    NA
  [120,150)    NA    NA
  [150,180)    NA    NA
  [180,210)    NA    NA 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:24:11.597

如果我对您的理解正确，那么您正在寻找时间箱内每个备份服务器的计数。（即我不确定您尝试使用`mean`...的原因是什么）

如果是这种情况，这里有一个使用**reshape2**包`dcast`的选项：

 **```
dat <- read.table(text = "      backup_server   client      duration  
1     bkp01           server_A    60       
2     bkp01           server_A    34       
3     bkp01           server_A    230     
4     bkp02           server_A    14      
5     bkp02           server_C    29   
6     bkp02           server_C    62",sep = "",header = TRUE,row.names = 1)

#cut altered slightly to make more sense with your small example data
dat$dur <- cut(dat$duration,seq(0,max(dat$duration)+30,by = 30),right = FALSE)
dcast(dat,dur~backup_server,fun.aggregate = length,value.var = "dur")

        dur bkp01 bkp02
1    [0,30)     0     2
2   [30,60)     1     0
3   [60,90)     1     1
4 [210,240)     1     0 
```**

# ios - 找不到协议声明 iOS

> ID：13866478
> 
> 赞同：1
> 
> 时间：2012-12-13T18:53:54.950
> 
> 标签：ios

> **可能重复：**
> [找不到协议声明](https://stackoverflow.com/questions/10160887/cannot-find-protocol-declaration-for)

这是 MyClass 中的代码：

```
@protocol todayUpdateDelegate <NSObject>

-(void) updateTodayTime;

@end

@interface MyClass : BaseViewController                                

@property (nonatomic, weak) id<todayUpdateDelegate> todayDelegate;

@end 
```

这是在委托类中：

```
#import "MyClass.h"

@interface MyDelegateClass : UITableViewController<todayUpdateDelegate>

@end 
```

我收到错误“找不到协议声明”

# ruby - Beanstalkd 的 Stalker 与 Beaneater

> ID：13866479
> 
> 赞同：0
> 
> 时间：2012-12-13T18:53:57.027
> 
> 标签：ruby, beanstalkd

我目前正在为我的 Rails 应用程序使用 Stalker。但我刚刚遇到了 Stalker 的超时错误/限制为 2 分钟。我看到[另一个](https://stackoverflow.com/questions/6465581/stalker-timeout-how-do-i-change-the-timeout-settings/6618723#comment19094015_6618723)关于这个主题的问题，有人回答说 Stalker 没有实现 beanstalkd 的 touch 方法，尽管我看到 beeater 实现了。

那么，有没有人尝试过 beeater 和 Stalker 呢？意见？与功能相比，哪一个更容易使用？对于我的一些任务，我可能会经常遇到超时错误，并且想知道我是应该增加`:ttr`还是切换到 beaneater。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T08:03:47.150

我强烈建议您查看[backburner](http://nesquena.github.com/backburner/)，我们在 beaneater 上构建它，它比不再维护良好的 stalker 更可定制和更强大。如果您有任何问题，请告诉我，backburner 有据可查。（用于在创建 backburner 之前使用 stalker）。

# sql - 选择数据库中的不准确之处

> ID：13866487
> 
> 赞同：0
> 
> 时间：2012-12-13T18:54:38.790
> 
> 标签：sql

我有一个包含高中足球比赛分数的小型数据库，用户可以在其中输入分数。

我需要找出哪些分数报告可能不准确或不一致（自上次分数发布以来哪些分数有所下降）

鉴于数据，我对如何做到这一点有点困惑：

成绩表

```
create table FINAL_score
    ( scoreID varchar2(10) primary key,
    gameID varchar2(5) REFERENCES FINAL_game(gameID),
    userID varchar2(5) REFERENCES FINAL_user(userID),
    curtime timestamp,
    qtr number(1),
    hscore number(2) not null,
    ascore number(2) not null);

insert into FINAL_score values ('s001', 'g001', 'u001', '10-DEC-12 02:10:00', 1, 7, 3);
insert into FINAL_score values ('s002', 'g001', 'u002', '10-DEC-12 02:12:00', 1, 7, 3);
insert into FINAL_score values ('s003', 'g001', 'u001', '10-DEC-12 02:15:00', 1, 7, 10);
insert into FINAL_score values ('s004', 'g001', 'u002', '10-DEC-12 02:28:00', 2, 14,13);
insert into FINAL_score values ('s005', 'g001', 'u001', '10-DEC-12 02:30:00', 2, 14,16);
insert into FINAL_score values ('s006', 'g001', 'u001', '10-DEC-12 02:55:00', 3, 14,19);
insert into FINAL_score values ('s007', 'g001', 'u002', '10-DEC-12 02:57:00', 3, 14,16);
insert into FINAL_score values ('s008', 'g001', 'u001', '10-DEC-12 03:15:00', 4, 17,26);
insert into FINAL_score values ('s009', 'g001', 'u002', '10-DEC-12 03:30:00', 4, 20, 29); 
```

^he 第 7 个插入语句是不一致的。

到目前为止，我有：

```
select *
from FINAL_score
order by hscore, ascore, curtime; 
```

哪个命令他们。

我只需要删除 scoreID 6

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:17:26.430

您可以通过以下方法获得所有低于游戏中较早分数的分数：

```
select fs.*
from Final_Score fs
where fs.hscore < (select max(fs.hscore) from Final_Score fs2 where fs2.gameid = fs.gameid and and fs2.qtr <= f22.qtr fs2.timestamp < fs.timestamp) 
```

然后，对 ascore 重复相同的操作。

# c++ - 奇怪的布尔返回行为

> ID：13866488
> 
> 赞同：0
> 
> 时间：2012-12-13T18:54:42.007
> 
> 标签：c++, boolean, compare, return

我正在尝试使用`bool match(string,string)`我创建的逐个字符比较两个字符串，我相信当我输入两个不相等的字符串时它会正确比较它确实输出假！但是当我检查 bool 时，它没有返回 false。我想不出这种行为的原因，我希望有人能帮助我。编码：

```
#include <iostream>
#include <cassert>
#include <cmath>
#include <fstream>
#include <vector>

using namespace std;

bool match(string pattern, string source)
{
    if(pattern.size() == 0&& source.size() == 0)
    {
        return true;
    }
    else if(pattern[0] == source[0])
    {
        pattern.erase(0,1);
        source.erase(0,1);
        match(pattern,source);
    }
    else
    {
        cout << "false" << endl;
        return false;
    }
}
int main()
{
    string test1 = "hballo";
    string test2 = "hallo";
    bool match_found =  match(test1,test2);
    if(match_found)
    {
        cout << "match found!"<< endl;
    } 
    else if(!match_found)
    {
        cout << "match not found!"<< endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T18:57:06.747

你忘记`return`了

```
pattern.erase(0,1);
source.erase(0,1);
return match(pattern,source);
^^^^^^ 
```

此外，正如@melpomene 所指出的，该`pattern[0] == source[0]`部分已损坏，因为`pattern`或`source`（但不是两者）此时可能为空。

最后，需要说的是，这里递归的方式效率极低。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T18:58:04.113

您在第二个 else 语句中缺少 return 语句：

```
if(pattern.size() == 0&& source.size() == 0)
{
    return true;
}
else if(pattern[0] == source[0])  // no return statement.
{
    pattern.erase(0,1);
    source.erase(0,1);
    return match(pattern,source);
}
else
{
    cout << "false" << endl;
    return false;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T19:23:13.910

试试这个实现：

```
bool match(const string& pattern, const string& source)
{
    int len = source.size();
    if (pattern.size() != len)
    {
        return false;
    }
    for (int i=0; i < len; ++i)
    {
        if (pattern[i] != source[i])
            return false;
    }
    return true;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T18:56:58.660

你的意思是

```
return match(pattern,source); 
```

否则你会得到未定义的行为。

# forms - 构造要插入数据库的 SQL 查询

> ID：13866490
> 
> 赞同：1
> 
> 时间：2012-12-13T18:54:48.433
> 
> 标签：forms, racket

我已将表单提交到同一页面，并且能够显示提交的值，但是当我尝试插入提交/发布的值时，我在语法上遇到了困难。如何将值作为变量访问？编写此行的正确方法是什么，我在哪里引入插入查询？

```
（查询-exec sql-exp
            “插入学生（姓名）值（'`post-body a-post'）”）

```

我可以使用以下代码显示值：

```
; 渲染发布：发布-> xexpr
; 使用帖子，生成帖子的 xexpr 片段。
（定义（render-post a-post）
  `(div ((class "post"))
        “标题 ： ”
        ,（后标题后）
        （p，“帖子：”
         ,(post-body a-post))))

; 渲染帖子：博客-> xexpr
; 使用博客，生成 xexpr 片段
; 其所有职位。
（定义（render-posts a-blog）
  `（div（（类“帖子”））        
        ,@(map render-post a-blog)))

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T21:41:35.987

[query-exec 文档中](http://docs.racket-lang.org/db/query-api.html#%28def._%28%28lib._db/base..rkt%29._query-exec%29%29)的第二个示例显示了如何执行接收参数的数据库查询。

例如，假设我们有一个`food`包含`name`和`calories`列的表，我们可以编写一个可以插入该表的函数。

```
;; insert-food!: database-connection string number -> void
;; Inserts an element into the food table.
(define (insert-food! conn name cals)
  (query-exec conn
              "insert into food (name, calories) values ($1, $2)" 
              name
              cals)) 
```

我们正在使用[参数化查询](http://docs.racket-lang.org/db/query-api.html#%28tech._parameterized._query%29)，假设数据库是 PostgreSQL 或一些支持使用占位符`$1`、`$2`...等的数据库，并将这些占位符的值作为附加参数传递给`query-exec`.

如果您从外部世界获取输入并用它构建 SQL 查询，您**应该**知道如何使用参数化查询，否则您将冒着数据库安全的风险。不要**尝试**格式化将变量的值全部插入到一个查询字符串中的单个字符串：您可能会弄错并打开您的程序以进行[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)漏洞利用。相反，将这些值作为不同的参数传递给`query-exec`.

另外，请注意，上面的函数不需要在 Web 服务器的上下文中使用：例如，它可以在[单元测试](http://docs.racket-lang.org/rackunit/index.html)的上下文中使用。您可能*希望*测试此功能，而不需要在 Web servlet 中使用它。像这样的东西：

```
#lang racket

(require db)

;; We want to export the following functions to outside clients.
(provide [struct-out foo]
         insert-food!
         get-foods!)

;; A food is a:
(struct food (name ;; string
              cals) ;; number
  #:transparent)

;; insert-food!: database-connection food -> void
;; Inserts an element into the food table.
(define (insert-food! conn a-food)
  (query-exec conn
              "insert into food (name, calories) values ($1, $2)" 
              (food-name a-food)
              (food-cals a-food)))

;; get-foods!: database-connection -> (listof food)
;; Get a list of the foods in the database.
(define (get-foods! conn)
  (for/list ([(name cal)
              (in-query conn "select name, calories from food")])
    (food name cal)))

(module+ test
  (require rackunit)
  ;; Internal test.  We'll use an in-memory SQLite database.
  (define conn (sqlite3-connect #:database 'memory))
  (query-exec conn "create table food (name string, calories double)")

  ;; Initially, it should be empty.
  (check-equal? (get-foods! conn) '())

  ;; Now let's add a food:

  ;; http://www.eiyoukeisan.com/JapaneseFoodCalorie/zryouri/misoramen.html
  (insert-food! conn (food "miso ramen" 56000.0))

  ;; Can we get it back?
  (check-equal? (get-foods! conn) (list (food "miso ramen" 56000.0)))) 
```

现在您可以通过在 DrRacket 中运行此文件来测试这些数据库函数的功能。一旦我们知道它们可靠地工作，我们就可以在不同的上下文中使用它们，例如 web servlet。

尝试在与 HTTP 请求处理程序相同的位置执行所有这些操作可能是错误的方法。您希望您的数据模型，即数据库操作，与您的 HTTP 请求处理程序位于一个单独的模块中，否则可能会使数据模型非常难以测试。[这就是Continue web-server 教程](http://docs.racket-lang.org/continue/index.html)不遗余力地谈论将“模型”作为一个单独的模块提取出来的主要原因。

# css - 如何在css中有流体高度？

> ID：13866499
> 
> 赞同：0
> 
> 时间：2012-12-13T18:55:08.680
> 
> 标签：css, responsive-design, percentage, fluid

我正在尝试对某些项目进行向下滑动效果，悬停时图像会向下滑动并显示内容，问题是当您调整浏览器大小时，图像也会调整大小，因为我有

`img { max-width: 100%; }`

但问题是我也不能有流体高度，我不能在它们上使用百分比高度。这就是正在发生的事情：

[http://codepen.io/joe/pen/yLjEx](http://codepen.io/joe/pen/yLjEx)

我将背景设置为黑色以查看发生了什么，我目前的高度为 210 像素。

那么如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T21:30:25.010

我在工作中遇到过类似的问题。不幸的是，只有 CSS 没有干净的解决方案。您可以使用一些在`onresize`事件期间触发的 javascript，或者您可以添加一个看不见的占位符图像，并将`div`' 的大小调整保持在正确的比例。

我所做的是将`.desc`定位绝对高于气球图像的副本，该图像“保持形状” `div`。您可以在我的 codepen中使用透明`.png`或仅将图像设置为喜欢。请参阅我的示例，包括可滚动`opacity:0.0;`的中间部分。`<li>`

[带有自动调整高度和滚动功能的分叉代码笔](http://codepen.io/djfarrelly/pen/wevfb)

**注意：**要跨浏览器工作，这需要更多测试并可能使用 IE`filter`来使图像透明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T21:58:24.987

添加`min-width:300px;`（300px 可以切换为任何你想要的大小），到 img {}。所以你会有`img { max-width: 100%; min-width:300px;}`. 这应该可以防止文本在图像下方用完。

[添加了 300px 的分叉 codepen。](http://codepen.io/m0ose89/pen/rqyjC)

# json - ZF2 JSON 数据大小问题

> ID：13866507
> 
> 赞同：0
> 
> 时间：2012-12-13T18:55:31.380
> 
> 标签：json, rpc, zend-framework2

我是 Zend 的新手，并尽我最大的努力学习和使用 Zend framework2、Dojo 和 Zend Json 服务器构建一个 Web 应用程序。我使用 dojo 组件编写了一个 html 页面。我的页面首先完全下载（此时没有 json 调用）。我添加了一个 onBlur 函数，该函数调用 Json 服务器进行响应并解析响应以加载国家/地区过滤器选择框。Dojo filterselect 使用 json rpc 客户端调用服务器并返回数据。如果我的数据（数据库中的记录）最多有 60 条记录，那么它可以正常工作。但是，如果该列表超过 60 条记录（可能是 200 多条记录），zend 服务器会转储一个异常（作为响应，它包含 json 数据 + 解析失败的异常）“警告：无法修改标头信息 - 标头已由（输出开始在 ”

```
Json server details
    public function populatelistAction() {
    $class = "MO\Model\MOGuest";
    $server = new Server();
    $server->setClass($class);
    if ('GET' == $_SERVER['REQUEST_METHOD']) {
    $server->setTarget('populatelist')->setEnvelope(Smd::ENV_JSONRPC_2);
    $smd = $server->getServiceMap();
    // Set Dojo compatibility:
    $smd->setDojoCompatible(true);
    header('Content-Type: application/json');
    echo $smd;
    return $this->getResponse();
    } else {
    //$server->handle(); 
    }
    $server->handle();
    return $this->getResponse();
} 
```

请在这个问题上指导我，因为我一无所知，因为它可以工作到 60 记录并且失败更多。下面是我得到的例外。这是一个错误还是我错过的任何事情。我验证它与 Dojo 无关，因为直接调用服务（使用 Restclient firefox 插件）也失败了。

```
{"id":"208","catcode":"SR"},{"id":"209","catcode":"SJ"},{"id":"210","catcode":"SZ"},{"id":"211","catcode":"SE"},{"id":"212","catcode":"CH"},{"id":"213","catcode":"SY"},{"id":"214","catcode":"TW"},{"id":"215","catcode":"TJ"},{"id":"216","catcode":"TZ"},{"id":"217","catcode":"TH"},{"id":"218","catcode":"TL"},{"id":"219","catcode":"TG"},{"id":"220","catcode":"TK"},{"id":"221","catcode":"TO"},{"id":"222","catcode":"TT"},{"id":"223","catcode":"TN"},{"id":"224","catcode":"TR"},{"id":"225","catcode":"TM"},{"id":"226","catcode":"TC"},{"id":"227","catcode":"TV"},{"id":"228","catcode":"UG"},{"id":"229","catcode":"UA"},{"id":"230","catcode":"AE"},{"id":"231","catcode":"US"},{"id":"232","catcode":"UM"},{"id":"233","catcode":"UY"},{"id":"234","catcode":"UZ"},{"id":"235","catcode":"VU"},{"id":"236","catcode":"VE"},{"id":"237","catcode":"VN"},{"id":"238","catcode":"VG"},{"id":"239","catcode":"VI"},{"id":"240","catcode":"GB"},{"id":"241","catcode":"WF"},{"id":"242","catcode":"EH"},{"id":"243","catcode":"YE"},{"id":"244","catcode":"ZM"},{"id":"245","catcode":"ZW"}]],"id":"1"}<br />
<font size='1'><table class='xdebug-error' dir='ltr' border='1' cellspacing='0' cellpadding='1'>
<tr><th align='left' bgcolor='#f57900' colspan="5"><span style='background-color: #cc0000; color: #fce94f; font-size: x-large;'>( ! )</span> Warning: Cannot modify header information - headers already sent by (output started at C:\Users\amsh\Documents\NetBeansProjects\myoffice\vendor\zendframework\zendframework\library\Zend\Json\Server\Server.php:182) in C:\Users\amsh\Documents\NetBeansProjects\myoffice\vendor\zendframework\zendframework\library\Zend\Http\PhpEnvironment\Response.php on line <i>62</i></th></tr>
<tr><th align='left' bgcolor='#e9b96e' colspan='5'>Call Stack</th></tr>
<tr><th align='center' bgcolor='#eeeeec'>#</th><th align='left' bgcolor='#eeeeec'>Time</th><th align='left' bgcolor='#eeeeec'>Memory</th><th align='left' bgcolor='#eeeeec'>Function</th><th align='left' bgcolor='#eeeeec'>Location</th></tr>
<tr><td bgcolor='#eeeeec' align='center'>1</td><td bgcolor='#eeeeec' align='center'>0.0236</td><td bgcolor='#eeeeec' align='right'>644056</td><td bgcolor='#eeeeec'>{main}( )</td><td title='C:\Users\amsh\Documents\NetBeansProjects\myoffice\public\index.php' bgcolor='#eeeeec'>..\index.php<b>:</b>0</td></tr>
<tr><td bgcolor='#eeeeec' align='center'>2</td><td bgcolor='#eeeeec' align='center'>0.7178</td><td bgcolor='#eeeeec' align='right'>9273664</td><td bgcolor='#eeeeec'>Zend\Mvc\Application->run( )</td><td title='C:\Users\amsh\Documents\NetBeansProjects\myoffice\public\index.php' bgcolor='#eeeeec'>..\index.php<b>:</b>12</td></tr>
<tr><td bgcolor='#eeeeec' align='center'>3</td><td bgcolor='#eeeeec' align='center'>1.8114</td><td bgcolor='#eeeeec' align='right'>11844912</td><td bgcolor='#eeeeec'>Zend\EventManager\EventManager->trigger( )</td><td title='C:\Users\amsh\Documents\NetBeansProjects\myoffice\vendor\zendframework\zendframework\library\Zend\Mvc\Application.php' bgcolor='#eeeeec'>..\Application.php<b>:</b>303</td></tr>
<tr><td bgcolor='#eeeeec' align='center'>4</td><td bgcolor='#eeeeec' align='center'>1.8114</td><td bgcolor='#eeeeec' align='right'>11845120</td><td bgcolor='#eeeeec'>Zend\EventManager\EventManager->triggerListeners( )</td><td title='C:\Users\amsh\Documents\NetBeansProjects\myoffice\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php' bgcolor='#eeeeec'>..\EventManager.php<b>:</b>208</td></tr>
<tr><td bgcolor='#eeeeec' align='center'>5</td><td bgcolor='#eeeeec' align='center'>1.8138</td><td bgcolor='#eeeeec' align='right'>11847840</td><td bgcolor='#eeeeec'><a href='http://www_php_net/call_user_func' target='_new'>call_user_func</a>
( )</td><td title='C:\Users\amsh\Documents\NetBeansProjects\myoffice\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php' bgcolor='#eeeeec'>..\EventManager.php<b>:</b>468</td></tr>
<tr><td bgcolor='#eeeeec' align='center'>6</td><td bgcolor='#eeeeec' align='center'>1.8138</td><td bgcolor='#eeeeec' align='right'>11847872</td><td bgcolor='#eeeeec'>Zend\Mvc\View\SendResponseListener->sendResponse( )</td><td title='C:\Users\amsh\Documents\NetBeansProjects\myoffice\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php' bgcolor='#eeeeec'>..\EventManager.php<b>:</b>468</td></tr>
<tr><td bgcolor='#eeeeec' align='center'>7</td><td bgcolor='#eeeeec' align='center'>1.8139</td><td bgcolor='#eeeeec' align='right'>11847872</td><td bgcolor='#eeeeec'>Zend\Http\PhpEnvironment\Response->send( )</td><td title='C:\Users\amsh\Documents\NetBeansProjects\myoffice\vendor\zendframework\zendframework\library\Zend\Mvc\View\SendResponseListener.php' bgcolor='#eeeeec'>..\SendResponseListener.php<b>:</b>71</td></tr>
<tr><td bgcolor='#eeeeec' align='center'>8</td><td bgcolor='#eeeeec' align='center'>1.8139</td><td bgcolor='#eeeeec' align='right'>11847872</td><td bgcolor='#eeeeec'>Zend\Http\PhpEnvironment\Response->sendHeaders( )</td><td title='C:\Users\amsh\Documents\NetBeansProjects\myoffice\vendor\zendframework\zendframework\library\Zend\Http\PhpEnvironment\Response.php' bgcolor='#eeeeec'>..\Response.php<b>:</b>100</td></tr>
<tr><td bgcolor='#eeeeec' align='center'>9</td><td bgcolor='#eeeeec' align='center'>1.8142</td><td bgcolor='#eeeeec' align='right'>11848000</td><td bgcolor='#eeeeec'><a href='http://www/php/net/header' target='_new'>header</a>
( )</td><td title='C:\Users\amsh\Documents\NetBeansProjects\myoffice\vendor\zendframework\zendframework\library\Zend\Http\PhpEnvironment\Response.php' bgcolor='#eeeeec'>..\Response.php<b>:</b>62</td></tr>
</table></font>" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T08:08:14.860

我坚信这是一个缺陷，我为此创建了一个修复程序。只有 Zend 团队会确认问题并进行修复。可悲的是，到目前为止，还没有人调查过这个问题。

更多详细信息在下面的链接中：如果您打算使用此修复程序，那么您必须确保修复程序是正确的，因为我不是保证修复程序的合适人选。对于那个联系 Zend 框架团队。由于这是我的修复，我只是 Zend 的初学者，所以修复必须得到 Zend 团队的认证或提供更好的解决方案。 [https://github.com/zendframework/zf2/issues/3225](https://github.com/zendframework/zf2/issues/3225)

# java - Android 混淆了 Proguard 问题

> ID：13866514
> 
> 赞同：2
> 
> 时间：2012-12-13T18:55:50.680
> 
> 标签：java, android, jackson, proguard

我对整个混淆Android的东西很陌生，但最近几天我开始尝试Proguard。无论如何，我被困在所谓的 Proguard 地狱中。

我的应用程序的结构是我有 3 个不同的项目。一个库和两个应用程序项目。这两个应用程序项目都基于包含应用程序的所有逻辑和库的库项目。应用项目中几乎没有放置任何东西。

但是，当我尝试导出启用了 Proguard 的应用程序之一时，我在 Jackson JSON Parsing 库中遇到了一些错误。我尝试了很多不同的东西，我什至试图忽略错误，但这只是让解析部分失败。因此，忽略错误并不是正确的做法。

这是我的 proguard-project.txt 文件

```
-assumenosideeffects class android.util.Log {
    public static *** d(...);
    public static *** v(...);
}
-keep public class com.google.android.vending.licensing.ILicensingService
-keep class org.codehaus.** { *; } 
```

这些是我得到的错误。

```
Warning: org.codehaus.jackson.map.ext.JodaSerializers$LocalDateTimeSerializer: 
  can't find referenced class org.joda.time.LocalDateTime
      You should check if you need to specify additional program jars.
Warning: there were 99 unresolved references to classes or interfaces.
         You may need to specify additional library jars (using '-libraryjars'). 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:48:55.943

尝试`-keep`为 joda 时间课程添加选项：

```
-keep public class org.joda.time.** {public private protected *;}
-dontwarn org.joda.time.** 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T07:56:41.683

“找不到引用的类”意味着需要用 指定包含这些类的 JAR 文件`-libraryjars`，这与在 的类路径中的工作方式非常相似`javac`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T05:29:35.303

除了 proguard 本身，要做的一件事是确保您使用 Jackson 2.x，而不是 1.x——它具有较少的动态（可选）依赖项。这通过 PG 减少了噪音。

# sql - 按组返回查询

> ID：13866515
> 
> 赞同：1
> 
> 时间：2012-12-13T18:55:54.143
> 
> 标签：sql

假设我有以下表格：

表格1

```
Name     Food 
______________
Sam      Chips
Tom      Chips
Larry    Chips 
```

表 2

```
Name     Type
_____________
Sam      Dip
Tom      Dip
Larry    Dip
Marry    Soda
Peter    Soda
Sam      Soda
Larry    Soda
Sam      Beer
Larry    Beer 
```

是否可以退货

```
Name    Type
____________
Sam     Dip
Tom     Dip
Larry   Dip 
```

使用名称表 1 作为一个组并让该组在表 2 中完全匹配？

Soda Type 不匹配，因为它有 Marry、Peter、Sam、Larry。Beer Type 只有 Sam 和 Larry。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:05:53.857

如果我正确理解了您的问题，您可以使用这样的子查询。

```
 select * 
 from table2 
 where name in (select name 
                from table 1 
                group by name); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:02:13.073

我想这就是你想要的。

```
SELECT t1.Name, MIN(t2.Type)
FROM [Table 1] t1 JOIN [Table 2] t2 ON t1.Name = t2.Name
GROUP BY t1.Name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:35:32.483

您可以通过询问*Table2 中的条目总数与常用名称的数量相同且 Table1 中没有其他条目（名称）的类型*来找到这些。

在 SQL 中：

```
SELECT Table2.Name, Table2.Type
FROM
(
  SELECT Type
  FROM (SELECT DISTINCT Type FROM Table2) AS types
  WHERE (
    SELECT COUNT(*)
    FROM Table2 i2
    JOIN Table1 i1 ON i1.Name = i2.Name
    WHERE i2.Type = types.Type
  ) = (
    SELECT COUNT(*)
    FROM Table2 i2
    WHERE i2.Type = types.Type
  )
  AND (
    SELECT COUNT(*)
    FROM Table1
  ) = (
    SELECT COUNT(*)
    FROM Table2 i2
    WHERE i2.Type = types.Type
  )
) AS result
JOIN Table2 ON result.Type = Table2.Type 
```

在行动中看到它：[http ://sqlfiddle.com/#!2/8d50e/1](http://sqlfiddle.com/#!2/8d50e/1)

在 MySQL 中，您可以使用[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.5/en/group-by-functions.html#function_group-concat)函数来进行更短且更易于阅读的查询：

```
SELECT Table2.Name, Table2.Type
FROM
(
  SELECT Type
  FROM (SELECT DISTINCT Type FROM Table2) AS types
  WHERE (
    SELECT GROUP_CONCAT(Name ORDER BY Name)
    FROM Table2 i2
    WHERE i2.Type = types.Type
  ) = (
    SELECT GROUP_CONCAT(Name ORDER BY Name)
    FROM Table1
  )
) AS result
JOIN Table2 ON result.Type = Table2.Type 
```

请注意[group_concat_max_len](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html)。

演示：[http ://sqlfiddle.com/#!2/af700/1](http://sqlfiddle.com/#!2/af700/1)

您是否真的要匹配整个 Table1 并不是很清楚，但上述解决方案可以很容易地扩展到 Food 和 Type 的每个匹配组合：

```
SELECT result.Food, Table2.Name, result.Type
FROM
(
  SELECT Type, Food
  FROM (SELECT DISTINCT Type, Food FROM Table2 JOIN Table1) AS combinations
  WHERE (
    SELECT COUNT(*)
    FROM Table2 i2
    JOIN Table1 i1 ON i1.Name = i2.Name
    WHERE i2.Type = combinations.Type
    AND i1.Food = combinations.Food
  ) = (
    SELECT COUNT(*)
    FROM Table2 i2
    WHERE i2.Type = combinations.Type
  )
  AND (
    SELECT COUNT(*)
    FROM Table2 i2
    WHERE i2.Type = combinations.Type
  ) = (
    SELECT COUNT(*)
    FROM Table1 i1
    WHERE i1.Food = combinations.Food
  )
) AS result
JOIN Table2 ON result.Type = Table2.Type 
```

演示：[http ://sqlfiddle.com/#!2/d4d4b/1](http://sqlfiddle.com/#!2/d4d4b/1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T19:10:25.780

使用完全外连接，然后检查是否没有引入其他任何内容。以下查询获取匹配的“类型”：

```
select t2.type
from table1 t1 full outer join
     table2 t2
     on t1.name = t2.name
group by t2.type
having count(*) = count(t1.name) and -- all t1.names match
       count(*) = count(t2.name)     -- all t2.names match
       count(*) = (select count(*) from table1) -- all are present 
```

这假定没有重复的名称。`distinct`如有必要，明智地使用可以解决该问题。

一旦你有了类型，你就可以加入到 table2 来获取所有的行。

# ruby-on-rails-3 - 如何创建一个可以通过唯一的自动生成链接访问文件的 Rails 应用程序？

> ID：13866521
> 
> 赞同：6
> 
> 时间：2012-12-13T18:56:13.520
> 
> 标签：ruby-on-rails-3

我有一个文件可供在线下载，但仅供选定的用户使用。

这是我想到的典型场景

> 想要该文件的人通常会访问该网站并填写表格以请求访问该文件。
> 
> 如果我想与他/她共享文件，我将授权用户生成一个唯一链接，该链接将通过电子邮件发送给用户。该链接仅在特定时间段内有效。

我会为此使用导轨。我正在寻找答案的事情：

1.  生成唯一下载链接的正确方法是什么？
2.  当用户在有效时间范围内点击链接时，如何开始下载文件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-13T20:09:42.480

首先，您需要设置一个模型来存储令牌：

```
rails g model DownloadToken token:string expires_at:timestamp 
```

**下载令牌.rb**

```
class DownloadToken < ActiveRecord::Base  

   attr_accessible :token, :expires_at
   before_create :generate_token

   def generate_token
      self.token = SecureRandom.base64(15).tr('+/=lIO0', 'abc123')
   end

end 
```

接下来，设置控制器来处理提交的表单（或更改现有操作）并生成令牌、发送电子邮件等。

```
class FooController < ApplicationController

  def create
    #process submitted form
    ...
    #create a token that expires in 24 hours
    @token = DownloadToken.create(:expires_at => Time.now + 24.hours)
    #send email and redirect..
  end    
end 
```

您需要确保您的邮件视图包含以下内容：

```
<%= link_to "Click Me", "/files/downloads?token=#{@token.token}" %> 
```

您还需要设置一个负责提供下载的控制器，它应该如下所示：

```
class FileController < ApplicationController
  before_filter :check_token

  def check_token
    redirect_to :back, :flash => {:error => "Bad link"} if DownloadToken.where("token = ? and expires_at > ?", params[:token], Time.now).nil?
  end

  def download
    send_file '/home/your_app/downloads/yourfile.zip', :type=>"application/zip", :x_sendfile=>true        
  end

end 
```

**routes.rb**（假设 Foo 已经设置为 RESTful 资源）

```
match 'files/download' => 'files#download' 
```

此代码未经测试，但它应该涵盖您需要的大部分内容，并让您了解您想要采取的方向。

补充阅读：

*   [安全随机](http://apidock.com/rails/ActiveSupport/SecureRandom)
*   [x_sendfile](http://www.therailsway.com/2009/2/22/file-downloads-done-right/)
*   [ActionMailer 基础知识](http://guides.rubyonrails.org/action_mailer_basics.html)

# linux - 如何查看 linux 内核 SNMP 计数器？

> ID：13866522
> 
> 赞同：4
> 
> 时间：2012-12-13T18:56:17.927
> 
> 标签：linux, kernel, snmp

内核有一堆 SNMP 计数器，它会在各种情况下递增，我想获取系统上的当前值。我找到`nstat`了，但这并没有显示所有的计数器（即使有`-z`选项）。例如，我想查看“XfrmInStateSeqError”的值，该值在 net/xfrm/xfrm_input.c 中递增：

```
if (async && x->repl->check(x, skb, seq)) {
  XFRM_INC_STATS(net, LINUX_MIB_XFRMINSTATESEQERROR);
  goto drop_unlock;
} 
```

有问题的系统是运行内核 3.2.0 的 Ubuntu 12.04。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T21:41:34.330

在我的 Debian 上，它只是没有用内核编译：

```
grep XFRM_STATISTICS /lib/modules/3.1.0-1-amd64/build/.config
# CONFIG_XFRM_STATISTICS is not set 
```

因此没有 /proc/net/xfrm_stat

我想设置 CONFIG_XFRM_STATISTICS 并重新编译内核就可以了...

# sql - Betrieve 在没有 DDF 的情况下访问数据

> ID：13866526
> 
> 赞同：1
> 
> 时间：2012-12-13T18:56:29.113
> 
> 标签：sql, pervasive, qbasic, btrieve

我需要帮助才能从 Betrieve 文件中访问数据。

Persasive ODBC 驱动程序需要一个为每个表定义“模式”的 DDF 文件，我的问题是 DDF 文件不存在。

我应该迁移到 C# 的 QBasic 代码，为每种数据类型创建一个子字符串函数和“强制转换”。如果我能理解语法，我可以创建所需的文件。

我使用了 PSQLv11 的 DDF Builder，但应用程序发送错误“无效的整理顺序”

有人可以上传一个带有 BTR 和 DDF 文件的示例，以了解它是否适​​用于 ODBC？

这是代码和数据库：[http ://www.mediafire.com/?mnvfa1tg1d6y64w](http://www.mediafire.com/?mnvfa1tg1d6y64w)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-11-17T16:32:30.103

我意识到这篇文章已经有将近五年的历史了，但我想我会做出贡献，以防其他人在搜索中遇到这个问题。任何用 QBasic 编写的应用程序都不太可能使用 Pervasive SQL，而是使用旧版本的 Windows Btrieve，甚至更有可能使用 DOS Btrieve。Pervasive 很久以前就停止销售和支持相关应用程序可能需要的版本，特别是 Windows 的 6.15。我相信 DOS 的最后一个版本是 5.10a。两者都使用（可选）DDF 文件，特别是 FILE.DDF、FIELD.DDF 和 INDEX.DDF。使用 Pervasive 的 SQL 版本的 DDF 管理器创建的任何东西都不太可能向后兼容，甚至可能无法读取 Btrieve 数据。如果这个问题被标记为 Btrieve，它可能会受到更好的关注。

# python - 创建班级列表不允许重复的条目

> ID：13866527
> 
> 赞同：0
> 
> 时间：2012-12-13T18:56:32.607
> 
> 标签：python

我正在尝试创建一个不允许重复条目的类

```
class QSet(list):
    def __init__(self,*args):
        super(QSet, self).__init__(args[0])
        self=list(set(self)) 
```

并且当尝试测试未删除的类重复条目时

```
d=["a","b","a","z","a"]
z=QList(d)       

print d  
print z 
```

任何解决这个问题的建议谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T19:01:07.203

您可以通过对代码稍作更改来做您想做的事情：

```
class QSet(list):
    def __init__(self, a):
        super(QSet, self).__init__(list(set(a))) 
```

我改变了你使用构造函数 args 的方式，因为它很奇怪接受任意参数，但坚持至少有一个，而忽略所有其他参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T19:00:25.607

重新分配`self`实际上并不会更改对象（您只是将标识符重新绑定`self`到新对象）。您可以将行更改为：

```
 self[:] = list(set(self)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:03:19.217

你知道这[`set`](http://docs.python.org/2/library/stdtypes.html#set)正是你正在建立的课程，对吧？

```
>>> s = set([1,2,3,3,3])
>>> s.add(4)
>>> s
set([1, 2, 3, 4])
>>> s.add(4)
>>> s
set([1, 2, 3, 4]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T19:04:57.740

Python中已经有一个类。它被称为集

```
d=["a","b","a","z","a"]
z=set(d)       

print d  
print z 
```

这对你有用吗？

# windows-8 - 如何在 Visual Studio 2012 中引用文件夹

> ID：13866531
> 
> 赞同：1
> 
> 时间：2012-12-13T18:56:45.523
> 
> 标签：windows-8, visual-studio-2012, windows-phone-8

我正在为 iOS、Android 和 Windows 8 开发一个多平台 C++ 游戏。为了避免拥有我的源代码的 3 个副本（更新可同时适用于所有平台），我正在使用这样的文件夹结构：

```
+-+-[Game project folder]
  |
  +-[Android] (contains Eclipse project files)
  |
  +-[iOS] (contains Xcode project files)
  |
  +-[Win] (contains VS 2012 project files)
  |
  +-+-[Sources] (contains the engine, app and assets)
    |
    +-[engine]
    |
    +-[app]
    |
    +-[resources] 
```

这种结构在 iOS 和 Android 中非常有效，因为它很容易在 Xcode 和 Eclipse 中引用文件夹。

**如何在不复制 win 文件夹内的源代码的情况下引用 Visual Studio 2012 项目中的源文件夹？**.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:16:49.923

当您在 Visual Studio 中选择“添加现有项目”时，您可以选择从“添加”按钮**将其添加为链接**（只需单击其右侧的箭头）。

![在此处输入图像描述](../Images/9fc91be009c5fe99b08ba7869327f1e3.png)

# java - 如何在java中创建一个完整的未来

> ID：13866533
> 
> 赞同：103
> 
> 时间：2012-12-13T18:56:49.293
> 
> 标签：java, future

在 Java 中构建完整的未来的最佳方式是什么？我在下面实现了我自己的`CompletedFuture`，但希望这样的东西已经存在。

```
public class CompletedFuture<T> implements Future<T> {
    private final T result;

    public CompletedFuture(final T result) {
        this.result = result;
    }

    @Override
    public boolean cancel(final boolean b) {
        return false;
    }

    @Override
    public boolean isCancelled() {
        return false;
    }

    @Override
    public boolean isDone() {
        return true;
    }

    @Override
    public T get() throws InterruptedException, ExecutionException {
        return this.result;
    }

    @Override
    public T get(final long l, final TimeUnit timeUnit) throws InterruptedException, ExecutionException, TimeoutException {
        return get();
    }
} 
```

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2015-02-17T14:37:53.840

在 Java 8 中，您可以使用内置的 CompletableFuture：

```
 Future future = CompletableFuture.completedFuture(value); 
```

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2012-12-13T19:02:21.083

Apache Commons Lang 定义了类似的实现，称为 ConstantFuture，您可以通过调用来获取它：

```
Future<T> future = ConcurrentUtils.constantFuture(T myValue); 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2012-12-13T19:25:30.837

[Guava](https://github.com/google/guava)定义了[`Futures.immediateFuture(value)`](https://google.github.io/guava/releases/21.0/api/docs/com/google/common/util/concurrent/Futures.html#immediateFuture-V-)，它完成了这项工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-09-10T18:58:13.117

```
FutureTask<String> ft = new FutureTask<>(() -> "foo");
ft.run();

System.out.println(ft.get()); 
```

将打印出“foo”；

您还可以有一个 Future 在调用 get() 时引发异常：

```
FutureTask<String> ft = new FutureTask<>(() -> {throw new RuntimeException("exception!");});
ft.run(); 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2015-06-25T19:37:00.773

我在 Java rt.jar 中找到了一个与您的非常相似的类

com.sun.xml.internal.ws.util.CompletedFuture

它还允许您指定在调用 get() 时可以抛出的异常。如果您不想引发异常，只需将其设置为 null 即可。

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2016-08-22T06:07:52.953

在 Java 6 中，您可以使用以下内容：

```
Promise<T> p = new Promise<T>();
p.resolve(value);
return p.getFuture(); 
```

# ip - 为测试创建一个特定于区域的 IP 地址

> ID：13866546
> 
> 赞同：8
> 
> 时间：2012-12-13T18:57:16.917
> 
> 标签：ip, cucumber, watir

对于我正在进行的一个项目，我需要伪造一个 IP 地址，以显示我来自另一个国家。

基本上，如果检测到的 IP 来自英国，则显示弹出窗口 A，如果检测到的 IP 来自英国以外，则显示弹出窗口 B。

我希望能够自动执行此操作。目前我们所有的浏览器自动化测试都是用 cucumber/watir 编写的，我想得到一个使用相同框架的解决方案。

有谁知道这样做的可能方法？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T19:01:07.973

一般来说，如果您关心您的 HTTP 请求返回给您的结果，那么 IP 欺骗是不可能的。

[http://en.wikipedia.org/wiki/IP_address_spoofing](http://en.wikipedia.org/wiki/IP_address_spoofing)

如果这是为了*测试*，您可以在本地网络上为“在英国”和“不在英国”的每个用例运行虚拟机。为每个不会更改的 VM 分配一个本地 IP 地址。

在每个 VM 中运行 HTTP 代理服务器，并根据测试用例让您的单元测试通过不同的代理服务器连接。

将覆盖逻辑添加到您的地理位置代码中，以将这些众所周知的本地 IP 地址视为其各自测试位置的一部分。请注意，行为良好的代理服务器将在请求中包含代理服务器的 IP 地址和原始 IP 地址。确保在此单元测试中使用代理服务器的 IP 地址进行地理定位（通常，您会希望在可用于生产地理定位的情况下使用原始 IP 地址）。

请注意，任何关心绕过此类控制的人都*非常容易。*只需支付很少的费用，就可以访问英国有意不转发原始 IP 地址的 HTTP 代理服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T14:35:39.773

最简单的解决方案是添加一些神奇的请求参数，允许您在英国和其他国家之间切换。例如，假设这样的事情会启用“*英国模式*”：

```
browser.goto "localhost/?country=UK" 
```

然后，在服务器端应该有一些 if 语句来检查该参数。在伪代码中：

```
if get_parameters["country"] == "UK"
  enable_uk_mode
end 
```

这将允许您只指定`GET parameter`打开“*英国模式*”或其他模式。我通常会走这条路，因为安装和管理所有 VM-s 和代理服务器以及管理它们的所有配置所花费的时间比在应用程序的开发模式中添加一些控制逻辑所花费的时间要多得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-08T04:04:49.483

您可以添加 HTTP 请求处理程序检查的“FakeIP”cookie，如果应用程序在测试模式下运行，则它会用假 IP 覆盖真实 IP。

示例：我实际上是在我的 Play Framework / Scala 应用程序中执行此操作。在我的 HTTP 请求类中：

```
def ip =
  if (!Play.isTest)
    underlyingRequest.remoteAddress
  else
    underlyingRequest.cookies.get("FakeIP").map(_.value).getOrElse(
                                      underlyingRequest.remoteAddress) 
```

然后在我的 Selenium E2E 测试的顶部：

```
add cookie ("FakeIP", "111.112.113.114") 
```

仅此而已:-)（至少在我的情况下）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T20:32:06.790

根据检测的方式，在某些情况下，您应该使用浏览器语言。这种代码：

```
profile = Selenium::WebDriver::Firefox::Profile.new
profile['intl.accept_languages'] = "fr"
browser = Watir::Browser.new :firefox, :profile => profile 
```

对于ip，为什么不考虑使用代理呢？

```
profile = Selenium::WebDriver::Firefox::Profile.new
profile.proxy = Selenium::WebDriver::Proxy.new :http => 'my.proxy.com:8080', :ssl => 'my.proxy.com:8080'
browser = Watir::Browser.new :firefox, :profile => profile 
```

我认为你应该两者兼而有之：它更像是一个真正的用户使用他的浏览器。

# python - 烧瓶应用程序中的类导入问题

> ID：13866548
> 
> 赞同：2
> 
> 时间：2012-12-13T18:57:40.320
> 
> 标签：python, class, import, sqlite, flask

我正在尝试为我的分析师团队构建一个小型 Web 应用程序。他们只需要一个可以添加和查看他们编写的查询的存储库。

到目前为止，我一直无法实现我的应用程序，因为我无法跨视图/类导入函数。有人可以帮我弄清楚我的问题是什么吗？

我收到此错误：

```
File "C:\Users\Intern2\PycharmProjects\queries-Final2\queries_Final2.py", line 12, in <module>
from search_queries import SearchQueries
ImportError: cannot import name SearchQueries 
```

我认为这个问题与我尝试将每个文件导入另一个文件的事实有关。但是，我不知道有任何其他方法可以做到这一点。

这是我的代码：

**query_Final2.py（主应用程序文件）**

```
from __future__ import with_statement
from sqlite3 import dbapi2 as sqlite3
from flask import Flask, request, session, g, redirect, url_for, abort,\
render_template, flash, _app_ctx_stack
import flask
import settings
import functools

# Views
from main import Main
from login import Login
from search_queries import SearchQueries
from add_queries import AddQueries
from edit_queries import EditQueries

DATABASE = 'C:\\Users\\Intern2\\PycharmProjects\\queries-Final2\\queriesDB.db'

app = flask.Flask(__name__)
app.config.from_object(__name__)
app.config.from_envvar('FLASKR_SETTINGS', silent=True)
app.secret_key = settings.secret_key

app.add_url_rule('/search-queries/',
view_func=SearchQueries.as_view('search-queries'),
methods=["GET", "POST"])

app.add_url_rule('/add-queries/',
view_func=AddQueries.as_view('add-queries'),
methods=["GET", "POST"])

def init_db():
"""Creates the database tables."""
with app.app_context():
    db = get_db()
    with app.open_resource('schema.sql') as f:
        db.cursor().executescript(f.read())
    db.commit()

def get_db():
"""Opens a new database connection if there is none yet for the
current application context.
"""
    top = _app_ctx_stack.top
    if not hasattr(top, 'sqlite_db'):
        top.sqlite_db = sqlite3.connect(app.config['DATABASE'])
    return top.sqlite_db 
```

**显示查询视图/类**

```
from __future__ import with_statement
from sqlite3 import dbapi2 as sqlite3
 from flask import Flask, request, session, g, redirect, url_for, abort,\
render_template, flash, _app_ctx_stack
import flask
import settings
import functools
from queries_Final2 import get_db
import utils

class SearchQueries(flask.views.MethodView):
    @utils.login_required
def get(self):
    db = get_db()
    cur = db.execute('select title, columns, query, notes, tags from entries order by id desc')
    entries = [dict(title=row[0], columns=row[1], query=row[2],notes=row[3],tags=row[4]) for row in cur.fetchall()]
    return render_template('search-queries.html', entries=entries) 
```

**添加查询类/视图**

```
from __future__ import with_statement
from flask import Flask, request, session, g, redirect, url_for, abort,\
render_template, flash, _app_ctx_stack
import flask
import functools
import utils
from queries_Final2 import get_db

class AddQueries(flask.views.MethodView):
    @utils.login_required
def get(self):
    return flask.render_template('add-queries.html')

def post(self):
    db = get_db()
    db.execute('insert into entries (title, columns, query, notes, tags) values (?, ?, ?, ?, ?)',
    [request.form['title'],
     request.form['columns'],
     request.form['query'],
     request.form['notes'],
     request.form['tags']
    ])
    db.commit()
    flash('New entry was successfully posted')
    return flask.render_template('search-queries.html') 
```

任何想法将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:04:19.940

您有一个由 触发的循环导入`from queries_Final2 import get_db`。

您正在有效地执行此操作（伪代码）：

```
# Inside module A
import x from module B
    -> goes to module B to get x
    -> module B begins loading its imports (happens on first import)
    -> module B imports y from module A
    -> module B fails to import y from module A because module A is still being defined 
```

随着时间的推移，您将学习如何以一种可以避免此问题的方式抽象您的工具，但与此同时，您可以通过简单地将行移到您的和函数`from queries_Final2 import get_db`内部来解决它，而不是将它们留在模块级别。`get``post`

# android - Eclipse 恼人的默认格式

> ID：13866560
> 
> 赞同：1
> 
> 时间：2012-12-13T18:58:19.833
> 
> 标签：android, eclipse, formatting

我的原始代码：

```
ListView myListView = (ListView) view.findViewById(R.id.myListView); 
```

格式后的代码（烦人！）：

```
ListView myListView = (ListView) view
                .findViewById(R.id.myListView); 
```

我应该调整什么设置来防止 eclipse 的格式做出这种特殊的改变？我正在查看格式化程序设置，但还没有找到它，因为我不太确定如何描述这种变化......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:07:03.793

避免换行的一种方法是增加“换行”选项卡上“最大线宽”字段的值`Preferences > Java > Code Style > Formatter > Edit...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:21:35.087

原来我真正想要的是...

`Preferences > Java > Code Style > Formatter > Line Wrapping > Function Calls`，然后将 设置`Line wrapping policy`为`Do not wrap (5 of 5)`。

# jquery - 每次点击都可以看到第 n 个孩子 - 遗漏了一些东西

> ID：13866564
> 
> 赞同：0
> 
> 时间：2012-12-13T18:58:27.340
> 
> 标签：jquery

我真的很接近这个，但我错过了一些让它正常工作的东西。我在[这里设置了一个测试页面](http://420dev.com/_lab/)。

将鼠标悬停在第一个过滤器组上并单击命名和语音时，它会正确过滤，并且图像占位符上的边距都是正确的。如果您然后单击数字（不重置过滤器），过滤器仍然有效，但边距被弄乱了，因此第一行只有 3 个图像而不是 4 个。

我不确定每次过滤集合时需要在代码中添加什么才能正确设置边距。或者更具体地说，将其设置为每四个项目都没有利润。

这是JS代码：

```
$(document).ready(function(){

//WORK OVERVIEW FILTERS
$('.nav-secondary.filters .section-inner').each(function(){
    //NAV REVEAL ON HOVER
    var conf = {
        over: function() {
            $(this).find('ul.filter-list,.reset').slideDown(250,'swing');
        },
        timeout: 25,
        out: function() {
            $(this).find('ul.filter-list,.reset').slideUp(250,'swing');
        }
    }
    $(this).hoverIntent(conf);

    //FILTER FUNCTIONS
    var _filter = '';
    var _count = 0;
    $('a.work-filter').click(function(){
        _filter = $(this).data('filter');

        $('.item.work[data-cats*="'+_filter+'"]').each(function(){
            $(this).show(250,'swing');
        });

        $('.item.work:not([data-cats*="'+_filter+'"])').each(function(){
            $(this).hide(250,'swing');
        });

        $('.item.work[data-cats*="'+_filter+'"]:visible').each(function (i) {
            if ((i+1) % 4 == 0) $(this).css('margin-right', '0');
        });

        $('a.work-filter.active').removeClass('active').data('active','no');
        $(this).addClass('active').data('active','yes');
        $('ul.work-filters').find('a.parent.current').removeClass('current');
        $(this).closest('ul').siblings('a.parent').addClass('current');

    });

    $('.reset a').click(function(){
        $('.item.work').each(function(){
            $(this).show(250,'swing');
        });
        $('a.work-filter.active').removeClass('active').data('active','no');
        $('ul.work-filters').find('a.parent.current').removeClass('current');
    });

});

}); 
```

**编辑：**澄清一下，当您第一次单击过滤器时，它会正常工作。任何后续单击都不会在正确的位置删除边距。所以缺少的是某种方法可以再次清除它，并在第一次单击任何过滤器时重新应用 margin-right:0 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T20:07:26.670

看起来您需要在自己的数组/对象中设置所有 .active 并从那里计算它们的边距，因为现在，所有图像都被计算在内，包括“display：none”，因此规则似乎被随意应用.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T23:35:45.873

所以我无法通过 JS/jQuery 来实现它。相反，我扩大了包含 div 以不担心第 4 个元素的额外边距。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:15:23.477

`margin-right`我认为您应该为每个过滤的所有元素重置：

```
if ((i+1) % 4 == 0) $(this).css('margin-right', '0');
else $(this).css('margin-right', '8px'); 
```

# javascript - jQuery UI datepicker 在显示年份菜单时无法可视化完整年份

> ID：13866565
> 
> 赞同：1
> 
> 时间：2012-12-13T18:58:29.553
> 
> 标签：javascript, jquery, jsp, jquery-ui, jquery-ui-datepicker

我有以下在 MVC struts 应用程序的 jsps 中调用的函数。这是一个通用的 jQuery-UI 日期选择器设置。

```
function setUpGenericDate(id) {
    var d=new Date();   
    $("#" + id).datepicker({
          duration: 'fast',
          showAnim: 'drop',
        dateFormat: "dd/mm/yy", 
           maxDate: '0',
            showOn: 'button', 
       buttonImage: '/img/calendar.gif', 
   buttonImageOnly: true,
         yearRange: '1900:'+d.getFullYear(),
       changeMonth: true,
        changeYear: true
    }); 
} 
```

我在 onLoad 正文事件上调用了该函数，如下所示：

```
<body style="margin-top:10px; margin-left:20px;" 
     onLoad="setupJQuery();setUpsetUpGenericDate('meetingDate');jButton('btnCancel');jButton('btnUpdate');"> 
```

上面，“meetingDate”是表单中输入文本对象的 id。

问题是在可视化日期选择器年份菜单以更改它时，它没有可视化年份。例如，2010 到 2012 年仅显示 201，而 2000 到 2009 年仅显示 200。

当用户选择一个日期时，它会在输入文本上显示完整的年份 ('yyyy')。只有在菜单中选择年份时才会出现此问题。会是什么呢？

谢谢指教

![jQuery-UI-datepicker-year-range-incomplete](../Images/7239d4ff1406e30efc313bd3922cc9f8.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T16:56:16.847

我为你创建了小提琴：

[http://jsfiddle.net/MhxMz/](http://jsfiddle.net/MhxMz/)

如您所见，您的代码非常好。

错误在其他地方...

我可以建议你在`alert(d.getFullYear());`之后做`Date d = new Date();`，以检查 javascript Date 是否正常工作......

还要检查您的库，避免重复和冲突的版本。

# iphone - 从 Exif 数据计算照度

> ID：13866567
> 
> 赞同：5
> 
> 时间：2012-12-13T18:58:38.910
> 
> 标签：iphone, objective-c, image-processing, camera, rgb

我如何通过 iPhone 相机计算勒克斯或照度。我计算了所有的 exif 数据，如下所示：

```
key = FocalLength, value = 3.85
key = MeteringMode, value = 5
key = ShutterSpeedValue, value = 4.591759434012097
key = ExposureProgram, value = 2
key = FocalLenIn35mmFilm, value = 32
key = SceneType, value = 1
key = FNumber, value = 2.4
key = PixelXDimension, value = 480
key = ExposureTime, value = 0.04166666666666666
key = BrightnessValue, value = -0.2005493394308445
key = ApertureValue, value = 2.526068811667588
key = Flash, value = 32
key = ExposureMode, value = 0
key = PixelYDimension, value = 360
key = SensingMethod, value = 2
key = ISOSpeedRatings, value = (
        1250
    )
key = WhiteBalance, value = 0 
```

我还阅读了[http://en.wikipedia.org/wiki/Light_meter](http://en.wikipedia.org/wiki/Light_meter)并了解到 Lux 是由**`(N*N*C)/tS`**

```
Where N is the relative aperture (f-number)
t is the exposure time (“shutter speed”) in seconds
S is the ISO arithmetic speed
C is the incident-light meter calibration constant 
```

我不明白这个值指的是什么，例如。N 是来自 Key Value Data 的 ApertureValue 或 FNumber，t 是曝光时间或快门速度。C 的值是多少（320-540 或 250）。我将每个相似的值以不同的组合应用于这个公式，但是当我与一些计算勒克斯值的应用程序进行比较时得到了错误的结果。 **我还需要根据照度计算辐照度。**

此外，我还通过以下方式计算了捕获图像的亮度：

```
UIImage* image = [UIImage imageNamed:@"image.png"];
unsigned char* pixels = [image rgbaPixels];
double totalLuminance = 0.0;
for(int p=0;p<image.size.width*image.size.height*4;p+=4) {
  totalLuminance += pixels[p]*0.299 + pixels[p+1]*0.587 + pixels[p+2]*0.114;
}
totalLuminance /= (image.size.width*image.size.height);
totalLuminance /= 255.0;
NSLog(@"Image.png = %f",totalLuminance); 
```

通过[http://b2cloud.com.au/tutorial/obtaining-luminosity-from-an-ios-camera](http://b2cloud.com.au/tutorial/obtaining-luminosity-from-an-ios-camera)

提前致谢。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:09:08.370

你真的需要照度的绝对值吗？或者你能摆脱可以相互比较的相对值，例如已知值达到恒定比例因子？

如果前者你不走运：exif 数据中没有 C，并且使用校准程序检索它需要具有已知强度的光源，并且可能在积分球中拍照。

如果是后者，只需将表达式重写为 Lux = C * (N*N /St)，其中 N == FNumber，t == ExposureTime，S == ISOSpeedRatings，设置 C == 1（或任意值）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-17T11:24:28.407

这是我建议的代码：

```
(void)imagePickerController:(UIImagePickerController *)anImagePickerController didFinishPickingMediaWithInfo:(NSDictionary *)info 
{
    //NSLog(@"%@",info);

    NSDictionary *temp=[info   objectForKey:@"UIImagePickerControllerMediaMetadata"];
    NSDictionary *temp2=[temp objectForKey:@"{Exif}"];

    float fnumber=[[temp2 objectForKey:@"FNumber"]floatValue];
    float ExposureTime=[[temp2 objectForKey:@"ExposureTime"]floatValue];

    NSArray *iosarray=[temp2 objectForKey:@"ISOSpeedRatings"];

    float ISOSpeedRatings=[[iosarray objectAtIndex:0]floatValue];

    int c=80;//you need to calibrate this value

    float illuminanace=c*(fnumber*fnumber /(ISOSpeedRatings*ExposureTime));

    //NSLog(@"fnumber=%f ",fnumber);
    //NSLog(@"ExposureTime=%f ",ExposureTime);
    //NSLog(@"iosarray=%@",iosarray);
    //NSLog(@"ISOSpeedRatings=%f",ISOSpeedRatings);

    NSLog(@"illiminace =%f lux",illuminanace);
} 
```

# wso2 - wso2 bps 3.0 集群 IllegalArgumentException：没有这样的通道；身份证=74

> ID：13866576
> 
> 赞同：0
> 
> 时间：2012-12-13T18:59:08.737
> 
> 标签：wso2, bpel

我正在运行 wso2 BPS 3.0 集群（BPS 主机、BPS 从机 e G-REG）。

我的 ode BPEL 应用程序**在异步消息回调上使用“pick”**。

```
<bpel:pick name="receiveCommandResponse">

         <bpel:onMessage operation="commandResult" 
                                partnerLink="commandServiceCallback"portType="sl:CommandCallbackPT" variable="slResponse">
                <bpel:correlations>
                    <bpel:correlation initiate="no" set="commandRequestIdCorrelationSet"/>
                </bpel:correlations>

    ....

    <bpel:onAlarm>                   
       <bpel:for><![CDATA['PT2M']]></bpel:for>
       <bpel:sequence>

     </bpel:onAlarm>
</bpel:pick> 
```

我经常收到以下错误：

TID：[] [WSO2 业务流程服务器] [2012-12-13 18:40:47,131] 错误 {org.apache.ode.bpel.engine.BpelEngineImpl} - 计划作业失败；jobDetail=JobDetails（instanceId：null mexId：hqejbhcnphr7txmb25ppt7 processId：{http://wf.tigre.telecomitalia.it/WFSendCommands-BPEL/}WFSendCommands-2 类型：INVOKE_INTERNAL 通道：null correlatorId：null correlationKeySet：null retryCount：null inMem： false detailsExt: {enqueue=true}) {org.apache.ode.bpel.engine.BpelEngineImpl} java.lang.IllegalArgumentException:**没有这样的通道；身份证=74** 在 org.apache.ode.jacob.vpu.ExecutionQueueImpl.findChannelFrame(ExecutionQueueImpl.java:205) 在 org.apache.ode.jacob.vpu.ExecutionQueueImpl.consumeExport(ExecutionQueueImpl.java:232) 在 org.apache.ode.jacob .vpu.JacobVPU$JacobThreadImpl.importChannel(JacobVPU.java:369) 在 org.apache.ode.jacob.JacobObject.importChannel(JacobObject.java:47) 在 org.apache.ode.bpel.engine.BpelRuntimeContextImpl$4.run( BpelRuntimeContextImpl.java:941) 在 sun.reflect.GeneratedMethodAccessor122.invoke(Unknown Source) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 在 java.lang.reflect.Method.invoke(Method.java:597)在 org.apache.ode.jacob.vpu.JacobVPU$JacobThreadImpl.run(JacobVPU.java:451)

有人可以提供有关如何解决此问题的更多信息吗？

PS：我修改了我的 bps.xml conf：

```
<tns:OpenJPAConfig>
        <tns:property name="openjpa.FlushBeforeQueries" value="true"/>
         <!-- added this line as for https://wso2.org/jira/browse/CARBON-7500  (use also Oracle 11g Driver!!) -->
         <tns:property name="openjpa.jdbc.DBDictionary" value="oracle(batchLimit=0)"/>
    </tns:OpenJPAConfig> 
```

谢谢达尼洛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T05:30:50.130

由于初始实例创建中缺少实例锁而发生此问题。您可以从以下问题中找到有关该错误的更多信息。

[https://wso2.org/jira/browse/BPS-218](https://wso2.org/jira/browse/BPS-218)

我们将在下一个版本中修复此错误。

# css - 移动 Safari 灰度滤镜添加模糊

> ID：13866577
> 
> 赞同：9
> 
> 时间：2012-12-13T18:59:10.107
> 
> 标签：css, mobile-safari, svg-filters

我正在使用这些过滤器对图像进行去饱和处理：

```
img {
    filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale");
    filter: gray;
    -webkit-filter: grayscale(1);
} 
```

它工作得很好，尽管过滤器似乎在 Mobile Safari 上对图像进行了像素化。我不知道为什么会这样。是否有保持清晰度的秘诀？还是我必须忍受这个浏览器的缺点？例如，以下是一些并列的屏幕截图，取自 iOS 模拟器：

![带灰度滤镜](../Images/1a47cf0f75f0d2f8603e8dd79e7164b0.png)

![不带过滤器](../Images/7c7d156c90b10f0622b3a76abb7b9f69.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-10T22:14:55.917

有点太晚了，但这应该可以解决问题：

```
-webkit-transform: translateZ(0); 
```

来源： http: [//matthewhappen.com/fixing-css3-filter-blur-on-retina-displays/](http://matthewhappen.com/fixing-css3-filter-blur-on-retina-displays/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T21:09:35.257

我不知道移动 safari 是采用过滤器样式还是 -webkit-filter。

我不相信 -webkit 过滤器允许你指定过滤器分辨率，所以如果你想覆盖这个默认行为，你必须在过滤器定义中添加一个 filterRes=400 或者替代方法是去内联 svg 和为您的过滤器指定一个明确的 filterRes 。

```
<svg>
   <defs>
     <filter id="greyscale" filterRes="1278">
        <feColorMatrix etc...>
     </filter>
   </defs>

Images...

</svg> 
```

# asp.net - 在运行时更改对象数据源

> ID：13866578
> 
> 赞同：1
> 
> 时间：2012-12-13T18:59:21.733
> 
> 标签：asp.net, reporting-services

我试图在运行时切换对象数据源（objectdatasource1 和 objectdatasource2），并在单击 button1 时刷新我的报表查看器。我无法弄清楚如何做到这一点，并且无法使下面的代码正常工作。有任何想法吗？谢谢

```
Dim dataSetName As String = "MyApplication_ModelObject"
        Dim ds As New MyApplication_ModelObjectTableAdapters.DataTableTableAdapter()
        Dim rds As New ReportDataSource("MyApplication_ModelObject", ds.GetData())
        ReportViewer1.LocalReport.DataSources.Clear()
        ReportViewer1.LocalReport.DataSources.Add(rds)
        ReportViewer1.LocalReport.Refresh() 
```

# ruby-on-rails - Capistrano 不包括食谱书

> ID：13866583
> 
> 赞同：0
> 
> 时间：2012-12-13T18:59:52.507
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, capistrano

我写了我在项目中使用的小型 capistrano 书[https://github.com/umerkulovb/crecipes 。](https://github.com/umerkulovb/crecipes)

但是，当我添加`require 'crecipes'`我的 Capfile 时，它​​不起作用。它给了我错误：

```
rubygems/custom_require.rb:36:in `require': cannot load such file -- crecipes (LoadError) 
```

我的宝石文件：

```
gem 'crecipes', git: "git://github.com/umerkulovb/crecipes.git" 
```

怎么了？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:03:58.617

如果您在应用程序根目录中执行

```
gem list 
```

薄饼在列表中吗？或者更好的是，列出

宝石清单 | grep 可丽饼

任何事物？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T11:40:17.847

我发现错误。我必须执行 `bundle update crecipes`

一切都好

# java - JAVA ServerSocket如何同步多个传入连接

> ID：13866599
> 
> 赞同：1
> 
> 时间：2012-12-13T19:01:03.307
> 
> 标签：java, multithreading, synchronization, thread-safety, serversocket

我有一个服务器应用程序，它可能会同时接收来自多个客户端的传入连接。它用于从 Internet 接收数据并将其发送到本地的 POS 打印机。这是代码：

```
public static void main(String args[]) {
    RFServer2 server = new RFServer2();
    while (true) {
        server.run();
    }
}

public RFServer2() {
}

public synchronized void run() {

    try {
        while (printing)
            wait();

        printing = true;
        // 1\. creating a server socket
        providerSocket = new ServerSocket(43520);

        // 2\. Wait for connection
        System.out.println("Waiting connection...");
        connection = providerSocket.accept();
        System.out.println("Connection received from " + connection.getInetAddress().getHostName());
        connection.setSoTimeout(8000);

        // 3\. get Input and Output streams
        out = new ObjectOutputStream(connection.getOutputStream());
        out.flush();
        try {
            in = new ObjectInputStream(connection.getInputStream());
        } catch (Exception e) {
            throw new Exception("Weird connection received, could not read, aborting...");
        }
        // sendMessage("connected");

        // 4\. The two parts communicate via the input and output streams

        try {
            message = (String) in.readObject();

            if (message.contains(".")) {
                Socket printerSocket = new Socket(message, 9100);
                printerSocket.setSoTimeout(3000);
                printer = printerSocket.getOutputStream();
                printer.flush();
                sendMessage("connected");

                while (!message.contentEquals("done")) {

                    try {
                        message = (String) in.readObject();
                        if (!message.contentEquals("done")) {
                            printer.write(message.getBytes("UTF-8"));
                            printer.flush();
                        }
                    } catch (Exception e) {
                        System.err.println("Failed to print.");
                        e.printStackTrace();
                        break;
                    }
                }
                this.message = "";
catch (Exception e) {
        System.err.println(e.getMessage());
    } finally {
        // 5: Closing connection
        try {
            this.message = "";
            if (printer != null) {
                System.out.println("Closing connection to the printer...");
                printer.close();
            }
            if (in != null) {
                System.out.println("Closing input...");
                in.close();
            }
            if (out != null) {
                System.out.println("Closing output...");
                out.close();
            }
            System.out.println(new Date() + " - letting server listening...");

            if (providerSocket != null)
                providerSocket.close();

            printing = false;
            notify();
        } catch (Exception ioException) {
            ioException.printStackTrace();
        }
    }
} 
```

好吧，如果我从同一个客户端（例如我的机器）发送多个连接，应用程序会使用 wait() 和 notify() 处理线程，同步它们。但是，如果我同时从 2 台不同的计算机发送 2 个连接，我的服务器会卡在“从主机收到连接”，并且两个客户端由于超时而掉线。

我所需要的只是解决这个小问题......我已经阅读了这些主题，但未能成功解决我的问题

[JAVA线程（不同栈）同步](https://stackoverflow.com/questions/8689815/java-threads-different-stacks-synchronization?rq=1)

[Java线程简单队列](https://stackoverflow.com/questions/9916264/java-thread-simple-queue)

[停止 ServerSocket accept() 循环线程](https://stackoverflow.com/questions/5660390/synchronizing-threads-with-serversocket)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T20:08:29.090

首先，您的程序在单线程中运行。

对于我在您的代码中看到的内容，您的问题是您为您参加的每个请求/客户端重置服务器。

你应该使用这样的东西：

```
 ServerSocket serverSocket = new ServerSocket(port);
        while (true) {
            Socket client = serverSocket.accept();

            //Do your work

            client.close();
        } 
```

在您的情况下，我认为您不需要多线程，但是如果您想使用，请将客户端套接字委托给另一个线程并接受另一个请求...

如果你想使用线程，我建议你创建一个线程池，并创建一个互斥锁来独占访问你的打印机。一些有用的链接： [线程池](https://stackoverflow.com/questions/3286626/what-is-the-use-of-a-thread-pool-in-java)和 [互斥锁](http://www.oracle.com/technetwork/articles/javase/index-140767.html)

# php - 如何计算从当前日期开始的最后四个星期天的日期

> ID：13866600
> 
> 赞同：0
> 
> 时间：2012-12-13T19:01:05.617
> 
> 标签：php, mysql, date

我们如何获得关于mysql中当前日期的最后四个星期天的日期？谢谢，

假设今天的日期`12/14/2012`如此`sql`查询的输出应该如下所示

```
第一个星期日 | 第二个星期天 | 第三个星期天 | 第四个星期日
2012 年 11 月 11 日 2012 年 11 月 18 日 2012 年 11 月 25 日 2012 年 9 月 12 日

```

**更新：**

使用 PHP 我这样做了：

```
 $date_lastsunday = strtotime("last Sunday");
$w1_sunday = $date_lastsunday - 7 * 24 * 3600;
$w2_sunday = $date_lastsunday - 14 * 24 * 3600;
$w3_sunday = $date_lastsunday - 21 * 24 * 3600;
$w4_sunday = $date_lastsunday - 28 * 24 * 3600; 
```

想知道如何用mysql完成它......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T19:08:14.673

如果您希望它们在每一行中

```
SELECT Curdate() - INTERVAL (Weekday(Curdate())+1) day AS `Sunday` 
UNION 
SELECT Curdate() - INTERVAL (Weekday(Curdate())+1+7*1) day 
UNION 
SELECT Curdate() - INTERVAL (Weekday(Curdate())+1+7*2) day 
UNION 
SELECT Curdate() - INTERVAL (Weekday(Curdate())+1+7*3) day 
```

如果您希望它们在列中，请替换`UNION SELECT`为`,`. 像这样

```
SELECT Curdate() - INTERVAL (Weekday(Curdate())+1) day `1st Sunday`, 
       Curdate() - INTERVAL (Weekday(Curdate())+1+7*1) day `2nd Sunday`, 
       Curdate() - INTERVAL (Weekday(Curdate())+1+7*2) day `3rd Sunday`, 
       Curdate() - INTERVAL (Weekday(Curdate())+1+7*3) day `4th Sunday` 
```

一种**CPU 密集度较低**的方式，

```
SET @OFS=Weekday(Curdate())+1;
SET @CD=curdate();
sELECT @CD - INTERVAL (@OFS) day `1st Sunday`, 
       @CD - INTERVAL (@OFS+7*1) day `2nd Sunday`, 
       @CD - INTERVAL (@OFS+7*2) day `3rd Sunday`, 
       @CD - INTERVAL (@OFS+7*3) day `4th Sunday` 
```

# c# - 在富文本框中显示 IP 地址

> ID：13866605
> 
> 赞同：1
> 
> 时间：2012-12-13T19:01:12.930
> 
> 标签：c#, ip

我正在制作的 C# 应用程序有问题。我试图通过简单地单击一个按钮来让所有 IP 显示在 Windows 窗体内的文本框中。我目前有一个可以使用的基础：

```
 private void btnIP_Click(object sender, EventArgs e)
    {
         NetworkInterface[] ipadapters = NetworkInterface.GetAllNetworkInterfaces();
        string iptemplate = @"
        Network adapter: {0}
        IP:              {1}";

        string IPText = "";

        foreach (NetworkInterface AdapterIP in ipadapters)
        {

            IPText = IPText + String.Format(iptemplate,
            AdapterIP.Name,
            AdapterIP = ipadd());

        }
            txtOutput.Text = IPText;
        } 
```

但是，我只是不明白我是否可以使用

`using System.Net.NetworkInformation;`

如果有人可以向我解释如何从那里获取 IP 并显示它，那将有很大帮助。我见过人们查询 DNS 以检索主机名等，但我只想显示所有适配器的所有 IPv4 和 IPv6 地址。

我只是不明白。我知道我需要保留 foreach() 方法，但不确定如何构建此代码以使其工作。注意：我将它用于所有适配器的描述和所有内容，但我创建了一个单独的按钮，专门用于 IP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:16:18.473

```
var ipEntry = Dns.GetHostEntry(Dns.GetHostName());
foreach (var ip in ipEntry.AddressList)
{
   if (ip.AddressFamily == System.Net.Sockets.AddressFamily.InterNetworkV6)
   {
    //IPv6
   }
   else if (ip.AddressFamily == System.Net.Sockets.AddressFamily.InterNetwork)
   {
    //IPv4
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-02T11:26:56.590

```
string hostName = Dns.GetHostName();

string myIP = Dns.GetHostByName(hostName).AddressList[0].ToString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:11:52.350

下面是一篇关于如何做到这一点的好文章。它提供了您应该需要的所有信息。

[如何获取运行我的 C# 应用程序的服务器的 IP 地址？](https://stackoverflow.com/questions/1069103/how-to-get-my-own-ip-address-in-c)

基本上是这样的：

```
var host = Dns.GetHostEntry(Dns.GetHostName());
foreach (IPAddress ip in host.AddressList)
{
    var localIP = ip.ToString();
    //do more here...
} 
```

# vba - 复制行从文件的一张表中复制并根据条件更新另一个文件中另一张表中的行

> ID：13866609
> 
> 赞同：1
> 
> 时间：2012-12-13T19:01:41.120
> 
> 标签：vba

我有一个文件“From.xls”，其中有一个包含数据的工作表“From”，该数据将更新到另一个具有工作表“To”的文件“To.xls”。

示例：“From”表在 From.xls 文件中有以下数据

```
Sno Name    Assigned    Staus   Delivered   Date    Account No
100 Packet 1    Team 1  Delivered   Yes 12-Dec-12   001
101 Packet 2    Team 1  Delivered   Yes 12-Dec-12   003
103 Packet 4    Team 2  Not Delivered   No      003
105 Packet 6    Team 2  Delivered   Yes 12-Dec-12   001
110 Packet 11   Team 2  Delivered   Yes 12-Dec-12   002
111 Packet 12   Team 2  Not Delivered   No      002
112 Packet 13   Team 2  Delivered   Yes 12-Dec-12   001
115 Packet 16   Team 2  Delivered   Yes 12-Dec-12   001
116 Packet 17   Team 11 Not Delivered   No      002 
```

“To”表在 To.xls 文件中有以下数据

```
Sno Name    Assigned    Staus   Delivered   Date    Account No
100 Packet 1    Team 1      No      
101 Packet 2    Team 1      No      
102 Packet 3    Team 3      No      
103 Packet 4    Team 2      No      
104 Packet 5    Team 5      No      
105 Packet 6    Team 2      No      
106 Packet 7    Team 7      No      
107 Packet 8    Team 8      No      
108 Packet 9    Team 9      No      
109 Packet 10   Team 10     No      
110 Packet 11   Team 2      No      
111 Packet 12   Team 2      No      
112 Packet 13   Team 2      No      
113 Packet 14   Team3       No      
114 Packet 15   Team4       No      
115 Packet 16   Team 2      No      
116 Packet 17   Team 11     No      
117 Packet 18   Team7       No      
118 Packet 19   Team8       No 
```

我想根据检查 Sno 和 Name 的条件将“From”表中的所有行更新为“To”表，并一键获得最终的 To 表，如下所示。

```
Sno Name    Assigned    Staus   Delivered   Date    Account No
100 Packet 1    Team 1  Delivered   Yes 12-Dec-12   001
101 Packet 2    Team 1  Delivered   Yes 12-Dec-12   003
102 Packet 3    Team 3      No      
103 Packet 4    Team 2  Not Delivered   No      003
104 Packet 5    Team 5      No      
105 Packet 6    Team 2  Delivered   Yes 12-Dec-12   001
106 Packet 7    Team 7      No      
107 Packet 8    Team 8      No      
108 Packet 9    Team 9      No      
109 Packet 10   Team 10     No      
110 Packet 11   Team 2  Delivered   Yes 12-Dec-12   002
111 Packet 12   Team 2  Not Delivered   No      002
112 Packet 13   Team 2  Delivered   Yes 12-Dec-12   001
113 Packet 14   Team3       No      
114 Packet 15   Team4       No      
115 Packet 16   Team 2  Delivered   Yes 12-Dec-12   001
116 Packet 17   Team 11 Not Delivered   No      002
117 Packet 18   Team7       No      
118 Packet 19   Team8       No 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T07:08:08.900

这有点难以阅读，我认为很容易回答（如果我理解正确的话）。尽量让一切都清楚。如果 Sno 已交付，您要求复制粘贴数据吗？行是否对齐？Sno 100、101 等在 To 和 From 上是否相同？Sno 是按顺序出现的，还是必须搜索它们？

如果需要进行搜索，您可能希望使用 vba 来完成（尽管对于这么简单的事情，一些 VLOOKUP 和 IF 也可以在单元格内完成）。

复制粘贴条件到底是什么？我确信这可以解决。

编辑——示例代码：

```
Option Explicit

Sub CopyData()

const FIRST_ROW_FROM as Long 1 'Put the first row of the data in From
const LAST_ROW_FROM as Long = 4 'Put the last row of the data in From
const SNO_COL_FROM as Long = 1 'Put the column of the sno in From

const FIRST_ROW_TO as Long 1 'Put the first row of the data in To
const LAST_ROW_TO as Long = 4 'Put the last row of the data in To
const SNO_COL_TO as Long = 1 'Put the column of the sno in To

const NUM_COLS as long = 5 'Number of columns of data

Dim rowCounter as Long

Dim searchVal as String
Dim fileName as String

Dim errHappened as Bool = False

Dim foundCell as Range

Dim xlApp as Excel.Application
Dim fromBook as Workbook
Dim toBook as Workbook
Dim fromSheet as Worksheet
Dim toSheet as Worksheet

'Remove the comment mark (') below if you want the program to exit silently on an error
'On Error Resume Next

set xlApp = CreateObject("Excel.Application")

If xlApp is Nothing Then
    errHappened = True
    GoTo CleanUp
End If

'From

'make these xlsx or xlsm if that is what they are
fileName = Application.GetOpenFileName("Excel Workbooks, *.xls", "Select the From File")

If Instr(fileName, "From.xls") = 0 Then
    errHappened = True
    Goto CleanUp
End If

Set fromBook = xlApp.Open(fileName)

If fromBook is Nothing Then
    errHappened = True
    GoTo CleanUp
Endif

'To

fileName = Application.GetOpenFileName("Excel Workbooks, *.xls", "Select the To File")

If Instr(fileName, "To.xls") = 0 Then
    errHappened = True
    GoTo CleanUp
End If

Set toBook = xlApp.Open(fileName)

If toBook is Nothing Then
    errHappened = True
    GoTo CleanUp
Endif

Set fromSheet = fromBook.Worksheets("From")
Set toSheet = toBook.Worksheets("To")

If (fromSheet is Nothing) Or (toSheet is Nothing) Then
    errHappened = True
    GoTo CleanUp
End If

For rowCounter = FIRST_ROW_FROM to LAST_ROW_FROM

    searchVal = fromSheet.Cells(rowCounter, SNO_COL_FROM)
    Set foundCell = Nothing
    Set foundCell = toSheet.Range(toSheet.Cells(FIRST_ROW_TO, SNO_COL_TO), toSheet.Cells(LAST_ROW_TO, SNO_COL_TO) ).Find(searchVal,, xlValues, xlWhole)

    If foundCell is Nothing Then

        errHappened = True
        MsgBox("Could Not Find Sno " & searchVal & " in To.xls from row " & Cstr(rowCounter) & " in From.")

    Else

        fromSheet.Range(fromSheet.Cells(rowCounter, SNO_COL_FROM), fromSheet.Cells(rowCounter, SNO_COL_FROM + NUM_COLS -1 )).Copy
        foundCell.PasteSpecial Paste:= xlPasteAll

    End If

Next rowCounter

'If you feel comfortable with the results, you can uncomment toBook.Save here and get rid of the
'Safe Ending below.  Delete from Begin Safe Ending to End Safe Ending

'toBook.Save

'''''Begin Safe Ending

'Makes worksheets visible so that you can verify you are happy with the results.  If you are,
'save it.  Otherwise, close without saving.  I will not take responsibility for a Sub that
'Overwrites your files, so I am giving you the Safe Ending!

xlApp.Visible = True
Exit Sub

'''''End Safe Ending

CleanUp:

If Not fromBook is Nothing then
    fromBook.Saved = True
    fromBook.Close
End If

If Not toBook is Nothing then
    toBook.Saved = True
    toBook.Close
End If

If Not xlApp is Nothing Then
    xlApp.Close
End If

If errHappened Then
    MsgBox("There was an error",, "Error")
End If

End Sub 
```

我是在 Mac 上写的，所以未经测试！！！请花时间在中断模式下运行代码并验证其完整性。

# paypal - Paypal Digital Goods 使用 startFlow 方法获取动态项目列表？

> ID：13866610
> 
> 赞同：2
> 
> 时间：2012-12-13T19:01:42.837
> 
> 标签：paypal, express-checkout, digital, paypal-digital-goods

我仍在尝试给同一只猫剥皮：[控制 javascript 执行顺序 PayPal 对象](https://stackoverflow.com/questions/13652519/controlling-order-of-javascript-execution-paypal-objects)

简而言之，我有一个可供购买的数字歌曲数据库。我想要一个不断变化的列表，比如 50 首歌曲供购买。

Paypal 拥有的文档非常糟糕 IMO。并且示例 - 每个人 - 似乎都需要硬编码您要出售的元素（按钮）的 ID，因为您需要页面页脚中的脚本来实际“触发”对 PayPal 的调用

```
<script type="text/javascript">
  var embeddedPPFlow1 = new PAYPAL.apps.DGFlow( {trigger : 'buysong_1'});
</script> 
```

...因此，如果您有 50 个“购买”按钮，则需要在加载时在页脚中声明 50 个 PAYPAL.apps.DGFlow 对象，当然，它们必须具有正确的 ID。这使得从数据库中提取不同的项目有点棘手（更不用说制作非常重的页面了。）

PayPal 文档表明应该能够通过使用单个对象但使用 URL 和 startFlow 方法而不是触发器来解决此问题，但他们的网站上没有示例，我在互联网上找不到任何工作示例。

```
embeddedPPFlow = new PAYPAL.apps.DGFlow();
// url = (paypal url?)
this.embeddedPPFlow.startFlow(url); 
```

但我不明白 URL 应该是什么......它是从 PayPal 获得的令牌吗？如果是这样，在调用 PayPal NVP 之前如何获得令牌？

简而言之：-someone- 是否有一个可行的示例，或者知道如何将 startFlow 与动态分配的购买按钮一起使用？我尝试在 X 开发者论坛上发帖，但没有得到任何回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-14T09:58:44.577

我在搜索同一件事时偶然发现了您的问题，并找到了对我有用的答案，我希望这会有所帮助....

url 是您要在灯箱内调用的位置。根据您使用的 API（和 SDK）而有所不同。就我而言，我使用的是 Merchant API SDK。 [https://github.com/paypal/merchant-sdk-php](https://github.com/paypal/merchant-sdk-php)

SDK里面有一个文件DGsetExpressCheckout.php，文件底部是url：

```
https://www.sandbox.paypal.com/incontext?token=$token 
```

我不太确定“incontext”部分是什么意思，但是当我使用该链接（以及最后的令牌）时，PayPal 弄清楚了事情并定向到：

```
https://www.sandbox.paypal.com/webapps/checkout/webflow/sparta/expresscheckoutvalidatedataflow?execution=e1s3 
```

这允许登录和支付流程的其余部分。

我的 JavaScript 看起来像这样（使用 jQuery）：

```
//setup the PayPal digital goods flow
var dg = new PAYPAL.apps.DGFlow({
  //don't trigger the flow with a button (we're going to submit manually)
  trigger: null
}),
//post object for payment
post = {
  amount: '1.00',
  currencyId: 'USD'
  //.... whatever else you need to pass to $_POST ....
};
//process checkout
$.post("/url/to/your/sdk/method", post, function(token) {
  //if successful...
  if ( token ) {
    //direct the dialog box for our digital goods pay flow to the correct place
    var flowUrl = 'https://www.sandbox.paypal.com/incontext?token='+token;
    dg.startFlow( flowUrl );
  }
}); 
```

您可能需要根据您的情况调整 SDK。您还必须确保在 DGdoExpressCheckout.php 中执行这些操作，它应该设置为在支付流之后运行的 returnUrl，此时您运行：

```
dg.closeFlow(); 
```

关闭对话框并覆盖。

# java - Jersey JAXRS 过滤器，在点击资源（Web 服务）之前提供未编组的实体

> ID：13866613
> 
> 赞同：7
> 
> 时间：2012-12-13T19:02:09.797
> 
> 标签：java, jakarta-ee, jaxb, jersey, jax-rs

是否有一种优雅的方式（过滤器、钩子）在 Jersey 中拦截未编组的实体（及其注释），然后再访问 Web 服务资源方法 - 那些使用 @POST、@PUT 注释的方法。

我真的需要实体本身及其上的任何注释，然后使用验证器注释的属性对该实体执行验证（看起来像 JSR 303，但我们不使用元数据注释整个 bean）。从资源的实现角度来看，我的目标是能够只在资源方法中键入它：

```
@Path("/people")
@Produces({ MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON })
public class PeopleService {
        @POST
        public Response createPerson(@CustomValidator("personValidator") Person person) throws URISyntaxException {
            String uri = someService.createPerson(person);
            return Response.created(new URI(uri)).entity(uri).build();
        }
    } 
```

我开始编写自定义 MessageBodyReader，并且我设法让 JSON 完全工作，因为我只是委托 ObjectMapper 来反序列化 JSON。除此之外，我收到了参数的注释，并且一切正常。但是，当我需要反序列化 XML 时，事情就崩溃了。我不知道如何获得 Jersey 会使用的原始反序列化器并将其委托给它。我也觉得我不必要地重写了 Jersey 的片段，如果 jersey 在 MessageBodyReader 之后和实现调用允许自身扩展的 Web 资源服务之前有一个层，我宁愿停止使用 MessageBodyReader 作为 hacky 集成点，这样我可以向流程中添加自定义行为。

最终，Jersey 是否有任何扩展点可以将未编组的实体及其任何参数注释交给我并允许我进行自定义处理？还是我必须弄清楚如何自己解组实体（使用 JAXBContext 或不使用）？可能诉诸AOP？将验证器注入资源类并放弃该注释想法？

球衣版本：1.5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-16T15:30:26.260

> 最终，泽西岛是否有任何扩展点可以将未编组的实体及其任何参数注释交给我并允许我进行自定义处理？

是的，Jersey 1.x 中有一个 SPI，您可以在其中提供自己的方法调用程序。我从未实现过 SPI，但据我了解，它是在任何 MessageBodyReaders 或过滤器之后调用的。看看[ResourceMethodCustomInvokerDispatchProvider](https://jersey.java.net/apidocs/1.18/jersey/com/sun/jersey/spi/container/ResourceMethodCustomInvokerDispatchProvider.html)。来自 Javadocs：

> 实现（服务提供者）通过在资源目录 META-INF/services 中放置提供者配置文件（如果不存在）“com.sun.research.ws.rest.spi.invoker.ResourceMethodCustomInvokerDispatchProvider”来标识自己，并在文件中包括实现的完全限定的服务提供者类。
> 
> 此接口类似于 ResourceMethodDispatchProvider，但允许使用自定义 JavaMethodInvoker 实例，该实例将用于进行最终的 Java 方法调用。

如果你实现 ResourceMethodCustomInvokerDispatchProvider，你应该能够提供你自己的[JavaMethodInvoker](https://jersey.java.net/apidocs/1.18/jersey/com/sun/jersey/spi/container/JavaMethodInvoker.html)，它可以访问被调用的资源方法，包括它的所有参数和注释。

请注意，以上所有内容都适用于 Jersey 1.x。在 Jersey 2 中，ResourceMethodInvocationHandlerProvider 提供了类似的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T11:11:20.430

看看 EJB 拦截器：http: [//www.adam-bien.com/roller/abien/entry/interceptors_ejb_3_for_absolute](http://www.adam-bien.com/roller/abien/entry/interceptors_ejb_3_for_absolute)

# android - Some good strategies for moving between android activities

> ID：13866619
> 
> 赞同：0
> 
> 时间：2012-12-13T19:02:21.463
> 
> 标签：android, android-intent

OK I've had this problem for a while now. I'm developing a camera app that does some verification and uploads a photo to a website.

My problem is, I keep running into the question of making a chain of activities each returning a result on finishing to the previous activity, or making each activity return to the main activity, which spawns the next activity, depending on the result.

Here's an example: The main activity shows a photo gallery from which you can launch a camera preview. After capturing a photo, another activity opens where you can verify that you want to save that photo. After verifying, you are shown another activity which displays the progress of your upload. This could be implemented as a chain of startactivityforresults:

Gallery -> camera -> Verification -> Upload -> verification -> camera -> Gallery

OR as:

Gallery -> camera

camera -> Gallery

Gallery -> Verification

Verification -> Gallery

Gallery -> Upload

Upload -> Gallery

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:15:24.693

Don't use an activity to show the upload progress. Use a ProgressDialog, or, better yet, offload the operation to an IntentService in the background. Remember to check for network connectivity before you attempt an upload!

As an alternative to "verifying" a save, you could do the save automatically and then allow the user to "undo" it. The UX guidelines suggest that the fewer interactions, the better, especially on small devices.

You could also save all the photos from a "session" to local storage, then allow the user to upload them later on, or asynchronously.

Besides that, you probably want separate activities/fragments if you want to allow the user to move back and forth at will between the steps, and have each step preserve its state.

In short, you should first spend some time thinking about what users *do*. Once you have some hazy model of how a user wants to use your app, then design it to achieve that. Too many developers rush off to build an app according to their understanding of the API. That approach is limiting.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:01:35.263

Did you call activity.finish() every time you want to close your activity ? Do you use an AsyncTask class to perform your network communication and showing your upload progress bar and then start another Activity?

The AsyncTask class [http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html) really help you to do such an operation: ActivityA -> Network connection and manipulation (running in backgroud) -> showing a progress bar or something like while performing the network communication(in your case uploading the photo) -> start another activity in the onPostexecute() methode of the AsyncTask!

This can really help you to have a stable transition from activities and a safe behaviour of your app !

I hope that this answer your question !

# objective-c - iOS 上的 AutoCAD 格式查看器

> ID：13866622
> 
> 赞同：0
> 
> 时间：2012-12-13T19:02:46.687
> 
> 标签：objective-c, ios, 3d, autocad

我希望能够在 iOS 的 UIView 中渲染 autocad DWF 和/或 DWG 文件。

Autodesk 有一个基于 mac 的库，但它不支持 iOS。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:57:00.043

AutoDesk 提供了用 C++ 编写的 DWF 工具包。您可以在 iOS 应用程序中使用 C++ 代码。

[http://usa.autodesk.com/adsk/servlet/index?id=823771&siteID=123112](http://usa.autodesk.com/adsk/servlet/index?id=823771&siteID=123112)

# ios - iOS - 多次点击手势识别器

> ID：13866623
> 
> 赞同：6
> 
> 时间：2012-12-13T19:02:47.567
> 
> 标签：ios, tap, uitapgesturerecognizer

在我的应用程序中，我必须检测单次、两次和三次点击。所以，我正在使用 UITapGestureRecognizer。我正在使用以下代码：

```
 UITapGestureRecognizer *oneTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleSingleTapGestureOnAnimal:)];
    oneTap.numberOfTapsRequired = 1;

    UITapGestureRecognizer *doubleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleDoubleTapGestureOnAnimal:)];
    doubleTap.numberOfTapsRequired = 2;
    [doubleTap requireGestureRecognizerToFail:oneTap];

    UITapGestureRecognizer* tripleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTripleTapGestureOnAnimal:)];
    tripleTap.numberOfTapsRequired = 3;
    [tripleTap requireGestureRecognizerToFail:doubleTap];

    [self addGestureRecognizer:oneTap];
    [self addGestureRecognizer:doubleTap];
    [self addGestureRecognizer:tripleTap]; 
```

但问题是它总是只检测单击和双击。它根本没有检测到三次点击....有人可以指出我在检测三次点击时所犯的错误吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-13T19:09:24.903

检查这个，

```
[oneTap requireGestureRecognizerToFail:doubleTap];
[oneTap requireGestureRecognizerToFail:tripleTap];
[doubleTap requireGestureRecognizerToFail:tripleTap]; 
```

你已经切换了方法中的水龙头，你没有做上面的第二行。理想情况下，只有在双击和三次敲击失败时才应检测到一次敲击。当三次点击失败时，应检测到双击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:11:05.843

将您的 2 个 requireGestureRecognizerToFail 调用更改为：

```
[oneTap requireGestureRecognizerToFail:tripleTap];
[oneTap requireGestureRecognizerToFail:doubleTap];
[doubleTap requireGestureRecognizerToFail:tripleTap]; 
```

# python - 解析文本区域输入

> ID：13866624
> 
> 赞同：0
> 
> 时间：2012-12-13T19:02:53.120
> 
> 标签：python, html, parsing, textarea

所以我有一个 html textarea，它为我提供以下形式的用户输入数据：

```
>Blabhb blabhab blabhahb etc etc 
AJSAKLFALELKNELNEFLKJELKJAELFKJLKEJFLKJF
LAKEFLKJAEFLKJELAJELFJLAEJFAENFANELFJEFJ
EKAFNEFNJEKJKEEKFKEAKJFKEJAFKJKEAJAEJFKJ
EFAA 
```

为了只使用第一行之后的所有内容，并将它们全部连接为一系列没有空格或回车的字母，我写了这个：

```
data_lines = data.split('\n')
data_lines = data_lines[1:]
data_lines = ''.join(data_lines) 
```

但我仍然有一些空间，似乎无法解释为什么。谁能帮助我或者优化这个方法？我想以一长串字母结尾。

查看输出的源代码会显示我想要的连续字母字符串，但它不会在屏幕上以这种方式显示。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:06:09.050

如果您只需要删除新行，这是简单的代码：

```
data_lines = data.replace('\n', '')
print(data_lines) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:05:48.067

尝试：

```
data_lines = data.split('\r\n') 
```

# java - Hibernate 映射类实体名称

> ID：13866626
> 
> 赞同：4
> 
> 时间：2012-12-13T19:03:09.603
> 
> 标签：java, hibernate, session, orm, entity

是否可以使用`entity-name`in 属性`class`来设置实体并引用它？我想这样做是因为我想映射到具有相同实体类的多个表。

表 1 和 adble 2 具有相同的架构

```
@Entity
public class POJO{
    @Id
    @Column(name="column1")
    private String column1;

    @Column(name="column2")
   private String column2;

   //getters and setters

}

<hibernate mapping>
    <class name="package.POJO" entiy-name="EntityTable1" table="table1">
        <id>.....</id>
            <property>....</property>
            <property>....</property>
     </class>

     <class name="package.POJO" entiy-name="EntityTable2" table="table2">
        <id>.....</id>
            <property>....</property>
            <property>....</property>
     </class>
</hibernate mapping>

Session s = SessionFactory.openSession();
List table1List = s.createQuery("FROM EntityTable1").list();

List table1List = s.createQuery("FROM EntityTable2").list(); 
```

[我在Hibernate Documentation](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/persistent-classes.html#persistent-classes-dynamicmodels)中读到这只是在实验阶段。有没有人使用过这种方法并工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:33:53.900

是的，您可以通过 XML 执行此操作，我没有遇到任何问题。[这是这个项目](https://github.com/jtalks-org/poulpe)的一个例子（因为我已经很久没有接触那个项目了，我没有清理代码来展示最小的工作示例）：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
  <class name="org.jtalks.common.model.entity.Property" table="PROPERTIES">

    <id column="PROPERTY_ID" name="id" unsaved-value="0">
      <generator class="native" />
    </id>

    <property column="UUID" name="uuid" not-null="true" unique="true" />
    <property column="NAME" name="name" not-null="true" unique="false" />
    <property column="VALUE" name="value" type="text" not-null="false" unique="false" />
    <property column="VALIDATION_RULE" name="validationRule" not-null="false" unique="false" />

  </class>
</hibernate-mapping> 
```

和：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
  <class name="org.jtalks.common.model.entity.Property" table="DEFAULT_PROPERTIES" entity-name="DefaultProperty">
    <id column="PROPERTY_ID" name="id" unsaved-value="0">
      <generator class="native" />
    </id>
    <property column="UUID" name="uuid" not-null="true" unique="true" />
    <property column="NAME" name="name" not-null="true" unique="false" />
    <property column="VALUE" name="value" not-null="false" unique="false" />
    <property column="VALIDATION_RULE" name="validationRule" not-null="false" unique="false" />
  </class>
</hibernate-mapping> 
```

这是用法＃1的示例

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>

  <class name="org.jtalks.common.model.entity.Component" table="COMPONENTS">
    <id column="CMP_ID" name="id" unsaved-value="0">
      <generator class="native" />
    </id>

    <discriminator column="COMPONENT_TYPE" force="false" insert="false" />

    <property column="UUID" name="uuid" not-null="true" unique="true" />

    <property column="NAME" name="name" not-null="true" unique="true" />
    <property column="DESCRIPTION" name="description" />

    <bag name="properties" cascade="all-delete-orphan" inverse="false" lazy="false">
      <cache usage="nonstrict-read-write" region="org.jtalks.EHCOMMON"/>
      <key column="CMP_ID" foreign-key="FK_COMPONENT" />
      <one-to-many class="org.jtalks.common.model.entity.Property" />
    </bag>

    <property name="componentType" column="COMPONENT_TYPE" unique="true">
      <type name="org.hibernate.type.EnumType">
        <param name="enumClass">org.jtalks.common.model.entity.ComponentType</param>
        <!-- 12 means 'VARCHAR', see java.sql.Types.VARCHAR -->
        <param name="type">12</param>
      </type>
    </property>

    <!-- discriminator - ComponentType.FORUM -->
    <subclass name="org.jtalks.poulpe.model.entity.Jcommune" discriminator-value="FORUM">
      <list name="sections" cascade="all-delete-orphan" inverse="false" lazy="false">
        <cache usage="nonstrict-read-write" />
        <key column="COMPONENT_ID" foreign-key="FK_JCOMMUNE" />
        <list-index column="POSITION" />
        <one-to-many class="org.jtalks.poulpe.model.entity.PoulpeSection" />
      </list>
    </subclass>

    <!-- discriminator - ComponentType.ADMIN_PANEL -->
    <subclass name="org.jtalks.poulpe.model.entity.Poulpe" discriminator-value="ADMIN_PANEL" />

    <subclass name="org.jtalks.common.model.entity.Component" entity-name="Antarticle" discriminator-value="ARTICLE" />
  </class>
</hibernate-mapping> 
```

这里分别是#2：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
  <class name="org.jtalks.poulpe.model.entity.ComponentBase" table="BASE_COMPONENTS">
    <id column="COMPONENT_TYPE" name="componentType">
      <type name="org.hibernate.type.EnumType">
        <param name="enumClass">org.jtalks.common.model.entity.ComponentType</param>
        <!-- 12 means 'VARCHAR', see java.sql.Types.VARCHAR -->
        <param name="type">12</param>
      </type>
    </id>

    <set name="defaultProperties" cascade="all" inverse="false" lazy="false">
      <cache usage="read-only" />
      <key column="BASE_COMPONENT_TYPE" foreign-key="COMPONENT_TYPE" />
      <one-to-many class="org.jtalks.common.model.entity.Property" entity-name="DefaultProperty" />
    </set>
  </class>
</hibernate-mapping> 
```

请注意，您不能对注释做同样的事情，这就是 XML 更灵活的地方。

# java - 在构建路径上找不到资源

> ID：13866631
> 
> 赞同：-1
> 
> 时间：2012-12-13T19:03:33.477
> 
> 标签：java, eclipse, ide, path

当我尝试在 Eclipse 中为从 IntelliJ 项目导入的源代码执行与 Java 相关的功能时，我经常看到“资源不在 Java 项目的构建路径上”。例如 F3、Ctrl+Shift+O 等。

这个问题不会让我在构建代码之前看到编译错误。此外，它不识别导入语句中的类。

尝试：右键单击源文件夹>构建路径>用作源文件夹。

试过：项目清理和刷新。

尝试：修改 .project 文件以包含不同的和

它最终在 Eclipse 中添加了很多红色错误，并在工作区中添加了更多文件，从而改变了我原来的工作区文件。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-13T19:20:26.867

You have to configure a couple of things:

your JRE System Lib (your JAVA_HOME) Add external jar dependencies to the Librairy tab in Configure Build Path. Add project reference if you have multiple project/module

Without seeing what your workspace look like!!! it's hard to tell what is the problem!

That is why i always use Maven now, since all this is taken care automatically.

# wordpress - 将响应式 CMS (WP?) 和 Big Cartel 嵌入响应式站点？

> ID：13866634
> 
> 赞同：3
> 
> 时间：2012-12-13T19:03:52.343
> 
> 标签：wordpress, responsive-design, embed, embedding, bigcartel

首先让我说我目前是 HTML5/CSS 的设计专业学生，这是我在这里的第一篇文章！我一直在寻找一个明确的答案，但没有运气。任何帮助将不胜感激！:)

基本上，在花了四分之一时间了解 RWD 之后，我同意为朋友的零售业务重新设计一个非常简单的 4-5 页网站。没问题。但是，我们一开始谈话，博客的主题就出现了，还有他们的 Big Cartel 购物车。我知道两者都有响应式主题，并且我发现了一些看起来很有希望的主题，但我想知道的是；**这些在另一个响应式网站中播放得好吗？**我实际上是在下个季度从头开始学习 WP，但计划是在新年之前把网站建成。我意识到答案可能是将整个网站创建为 WP 网站，但是，我不知道我现在是否有时间学习。我快速浏览了[这个页面](http://codex.wordpress.org/Integrating_Wordpress_with_Your_Website)但我对 PHP 还不太了解。另外，这仍然会使大卡特尔网站成为一个潜在问题。在最坏的情况下，他们不介意在新窗口中打开购物车，其样式与主站点类似。

几乎所有的“设计”都发生在页眉/页脚中，CMS/购物车就在它们之间。也许这将有助于使它更容易？我想我可以删除所有主题的导航等。此外，它不必是 WP，只是客户端可以用来轻松发布新闻、新项目、事件等的可靠的东西。只有主页会嵌入博客。我做了一个小插图以确保我清楚。这就是我的想法：

（呸，还不能发布图片）[http://i.stack.imgur.com/yXjCj.png](http://i.stack.imgur.com/yXjCj.png)

我的问题真的是，最简单的方法是什么？

我可以将这些元素放入 iframe 中还是..???

我会继续研究和玩，我只是没有很多时间。这个项目很快变得更加困难。或许没有我想的那么难？那会很好。

另外，如果有什么不同的话，我倾向于的 WP(.com) 主题是 humdemo.wordpress.com，而 Big Cartel 主题可能是 tiska.wearenine.com。同样，我不熟悉 WP，并且不确定 wordpress.COM 主题允许多少自定义。

好了，废话不多说。提前感谢您的帮助！鼓励其他解决方案！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-10T13:44:31.863

据我所知，bigcartel.com 本身没有响应，我不完全确定他们如何允许用户在他们的个人网站上实施他们的商店。这些店面中的许多都使用 iframe 或让您设置自定义主题以匹配您的主题，但我敢猜测，由于他们的网站没有响应，所以他们没有响应式店面主题可以使用。现在 Bigcartel 确实有一个 WP 插件，也许如果你的 WP 主题是响应式的，这个插件也会对主题做出反应，但同样从未使用过它，你将不得不尝试看看。

然而，还有其他购物车选项需要更多的工作，例如响应式的 WooCommerce。

希望这可以帮助。

# jquery - jQuery用简单的代码选择所有同一个类？

> ID：13866638
> 
> 赞同：3
> 
> 时间：2012-12-13T19:04:11.477
> 
> 标签：jquery, class, toggle, selector

我想制作一个 div，或者更准确地说，一个“aside”元素，当单击另一个具有相同类的元素时，它会出现一个 id 或类……我知道有标准的类选择器，但我希望有多个具有不同 id 或类的“aside”元素，并且我希望打开与单击的元素具有相同类或 id 的那个元素...

所以，我不想为每个 div 编写这段代码：

```
 $(window).load(function(){
      $('nav ul li#someid').click(function () {
      $('aside#someid').toggleClass('opened');
      });
    }); 
```

我想要这样的代码。有没有办法将示例中的 someid 更改为检测单击的元素具有什么 id 并将其用作“aside”选择器的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:06:52.093

首先，您可能想知道您可以使用它`this`来访问被点击的对象。这意味着您可以获取`this.id`或`this.className`获取被单击对象的 id 或类。现在，您对该信息的确切处理取决于您的 HTML 的结构，因此我们需要查看它以提供更多细节。

同一页面中不能有多个具有相同 ID 的对象。您根本无法做到这一点（当您这样做时，选择器将无法正常工作），因此您想要的方案将无法正常工作。您可以改用类并使用相同的类切换其他项目。这适用于一个特定的`li`.

```
$(document).ready(function(){
    $('nav ul li.foo').click(function () {
        $('aside.foo').toggleClass('opened');
    });
 }); 
```

或者，根据您的 HTML（如果您的 li 标签上只有一个类），您可以执行更通用的版本，如下所示：

```
$(document).ready(function(){
    $('nav ul li').click(function () {
        $('aside.' + this.className).toggleClass('opened');
    });
}); 
```

如果您向我们展示您的实际 HTML，我们可以提供最佳选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:07:59.800

您可以尝试使用：

```
this.id 
```

**this**指向捕获事件的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:06:54.260

你检查过[jQuery 以 selector 开头](http://api.jquery.com/attribute-starts-with-selector/)吗？

jQuery('[属性^="值"]')

```
$('aside[id^="foo_"]').toggleClass('opened'); 
```

这将为属性以开头的所有`aside`标签调用 toggleClass`id``foo_`

正如其他人所提到的，您不能拥有超过 1 个相同的 id 标记，但是您可以将它们全部启动并使用以选择器开头...等`foo_`来定位它们。`foo_1` `foo_2` `foo_3`

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-13T19:07:23.170

试试喜欢

```
 $(function(){
      $('nav ul li.someClass').click(function () {
      $('aside#aside_' + $(this).attr('id')).toggleClass('opened');
      });
    }); 
```

# asp.net - 从 Azure 上的 ASP 返回到 Arduino 的 HTTP 动词无效

> ID：13866642
> 
> 赞同：0
> 
> 时间：2012-12-13T19:04:28.520
> 
> 标签：asp.net, azure, arduino

我有一个 ASP 站点，它具有存储和检索值的简单工作。这是使用该站点存储值的示例 URL：

```
http://oneurloranother.cloudapp.net/default.aspx?store=[{"name":"timsplate","values":[1,2,3,4]},{"name":"miwasplate","values":[2,1,4,3]}] 
```

在运行良好的浏览器中，数据被存储。但我想从 Arduino 调用代码。我正在使用改编自 Arduino wifi 库示例的相当样板代码：

```
 client.println("GET /default.aspx?store=[{\"name\":\"timsplate\",\"values\":[1,2,3,4]},{\"name\":\"miwasplate\",\"values\":[2,1,4,3]}] HTTP/1.1");
  client.println("Host:oneurloranother.cloudapp.net");
  client.println("Connection: close");
  client.println(); 
```

但是我从服务器得到的响应是：

```
HTTP Error 400\. The request verb is invalid. 
```

如果我尝试`HEAD`或`POST`代替`GET`我仍然收到相同的错误。如果我错过了有效载荷并使用以下代码：

```
 client.println("GET /default.aspx HTTP/1.1");
  client.println("Host:oneurloranother.cloudapp.net");
  client.println("Connection: close");
  client.println(); 
```

然后响应很好 - 请求页面的 HTML。

谁能看到我做错了什么？

========== 编辑 ==========

好吧，这让我头疼。`System.Web.Script.Serialization.JavaScriptSerializer`我从 Arduino 论坛获得了一些其他建议，并重写了我的 HTTP 命令以删除ASP 代码中不需要的一些转义引号，并将 HTTP 消息放在单独的行中并将其发送到控制台（所以我可以检查我的转义引号是否正确）。该字符串看起来是正确的，但是这让我很头疼，单独声明 HTTP 消息的行为使它工作！即此代码有效：

```
 String httpMssg = "GET /default.aspx?store=[{name:\"timsplate\",values:[1,2,3,4]},{name:\"miwasplate\",values:[2,1,4,3]}] HTTP/1.1";
  client.println(httpMssg);
  client.println("Host: oneurloranother.cloudapp.net");
  client.println("Connection: close");
  client.println(); 
```

而这会导致服务器回复`HTTP Error 400\. The request verb is invalid`：

```
 client.println("GET /default.aspx?store=[{name:\"timsplate\",values:[1,2,3,4]},{name:\"miwasplate\",values:[2,1,4,3]}] HTTP/1.1");
  client.println("Host: oneurloranother.cloudapp.net");
  client.println("Connection: close");
  client.println(); 
```

那是疯了。我现在有工作代码，但我很感兴趣；为什么第二个代码块会失败而第一个代码块会成功？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:15:20.497

查询字符串中的许多字符都是[保留字符](https://en.wikipedia.org/wiki/Percent-encoding#Types_of_URI_characters)。尝试对它们应用百分比编码。许多 HTTP 库都有相应的功能，但由于您使用`println`的是发送请求，因此您可能必须自己完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:58:12.213

当我在浏览器中发出您的原始 URL 时，它就这样被转义了：`http://oneurloranother.cloudapp.net/default.aspx?store=[{%22name%22:%22timsplate%22,%22values%22:[1,2,3,4]},{%22name%22:%22miwasplate%22,%22values%22:[2,1,4,3]}]`所以您可以尝试一下。

话虽如此，我对您的后续问题没有任何解释。那些看起来和我一模一样。那是什么编程语言？

# ruby-on-rails - 在 RSpec 中为 Gem 编写测试

> ID：13866644
> 
> 赞同：2
> 
> 时间：2012-12-13T19:04:30.530
> 
> 标签：ruby-on-rails, ruby, testing, rspec, gem

我正在尝试为我编写的 gem 编写 RSpec 测试，但是我无法让测试识别我编写的模块以及与这些模块相关的方法。

这是我的 spec_helper.rb：

```
require 'rspec'

RSpec.configure do |config|

end 
```

我的规格文件：

```
require 'spec_helper'

describe MyCompany::SomeHelper do
  describe '#self.get_token' do
    token = MyCompany::SomeHelper.get_token
  end
end 
```

当我运行测试时，我收到此错误消息：MyCompany::SomeHelper:Module (NoMethodError) 的未定义方法 `get_token'。

但是，当我将它包含在另一个应用程序中时，gem 本身可以正常工作。我想我可能没有正确配置 RSpec 中的某些内容，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T23:01:00.903

混乱可能是因为 Rails，因为 Rails 加载所有内容并且需要“spec_helper”是您唯一需要做的事情。

RSpec 会自动将 lib 目录添加到您的加载路径中，因此您可以轻松地从您的规范中获取您的代码。

假设您要测试此文件：`lib/my_gem_name/my_class.rb`，然后将此代码放在您的规范之上：

```
require 'my_gem_name/my_class' 
```

如果你不打算在你的 spec_helper 中配置任何东西，你不需要创建它并需要它。事实上，如果您正在做纯粹的孤立测试，我会建议您不要这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:40:39.147

您需要包含 SomeHelper 模块定义的文件。你的 spec_helper 和你的 spec 文件都没有把它拉进来。这假设你在与 gem 相同的项目中编写测试。

如果您已经打包了 gem 并且正在尝试从不同的项目中对其进行测试，那么在加载路径中的某个位置需要 gem。

# javascript - 如何制作一个用于将 src 和 dest 地址放入其中的 JSON，我们可以在 grunt.js 中调用该 JSON？

> ID：13866655
> 
> 赞同：0
> 
> 时间：2012-12-13T19:05:40.267
> 
> 标签：javascript, json, node.js, gruntjs

我正在努力`grunt`制作构建工具，直到现在我直接在我的 grunt.js 文件中放置`src`和地址，但在这种情况下，如果我想更改我的目标，我必须更改文件的每个任务，这不是一个好习惯。`dest`例如，如果我的 grunt.js 文件有以下任务：

```
concat: {
  js: {
    src: 'src/js/*.js',
    dest: 'dest/js/concat.js'
  },
  css: {
    src: 'src/css/*.css',
    dest: 'dest/css/concat.css'
  }
},
min: {
  js: {
    src: 'dest/js/concat.js',
    dest: 'dest/js/concat.min.js'
  }
}, 
```

在这里，如果我改变我的地址，我必须在每个地方都改变！！！我想要一个`JSON`文件，我可以在其中声明 src 和 dest 并调用我的 grunt.js 文件。我们怎么能这样做？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T23:05:00.910

您可以添加一个属性`package.json`来声明元数据，例如

```
{
   "name": "test",
   "meta":{
     "src":"someSrcFolder",
     "dest":"someDestFolder"
   },
 ....
} 
```

然后在您的 中`Gruntfile.js`，您可以像这样读取这些属性

```
grunt.initConfig({
  pkg: '<json:package.json>',
  concat: {
    js: {
      src: '<%= pkg.meta.src %>/js/*.js',
      dest: '<%= pkg.meta.dest %>/js/concat.js'
    },
    css: {
      src: '<%= pkg.meta.src %>/css/*.css',
      dest: '<%= pkg.meta.dest %>/css/concat.css'
    }
  }
}); 
```

重要的位是`pkg:<json:package.json>`将 json 文件加载到内存中，以及下划线模板插值`<%= pkg.meta.src %>`，它评估`meta`添加到 json 文件中的属性的内容。

请记住，**Gruntfile**只是一个 JavaScript 文件，因此您还可以拥有一个引用路径的对象，然后将它们插入到您的任务中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-05T17:41:21.357

这在 Grunt.js 0.4.0 中发生了变化。

您现在将使用：`pkg: grunt.file.readJSON('package.json')`

# javascript - 在 KineticJS 中创建一个带有 mousedown 事件的矩形

> ID：13866660
> 
> 赞同：1
> 
> 时间：2012-12-13T19:05:53.860
> 
> 标签：javascript, html, html5-canvas, kineticjs

我正在尝试使用带有 mousedown 和拖动事件的 KineticJS 创建一个矩形形状，但运气不佳。有没有人做过类似的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:31:47.037

[http://jsfiddle.net/AYHSM/6/](http://jsfiddle.net/AYHSM/6/)

```
var stage = new Kinetic.Stage({
    container: 'container',
    width: 600,
    height: 400
});

var layer = new Kinetic.Layer();
layer.add(new Kinetic.Rect({
    x:0,
    y:0,
    width:600,
    height:400
}));  // this rect will allow us to use mouse events on the layer. There's probably a better way to do this, but I don't know it.
stage.add(layer);
var rect, down = false; // down is a flag to know whether or not the mouse button is down so that we only resize the new rect when it is down.

layer.on("mousedown", function(e) {

    down = true;
    var r = Math.round(Math.random()*255),
        g = Math.round(Math.random()*255),
        b = Math.round(Math.random()*255);
    rect = new Kinetic.Rect({
        x: e.layerX,
        y: e.layerY,
        width: 11,
        height: 1,
        fill: 'rgb('+r+','+g+','+b+')',
        stroke: 'black',
        strokeWidth: 4
    });
    layer.add(rect);
});

layer.on("mousemove", function(e) {
    if (!down) return;

    var p = rect.attrs;

    rect.setWidth(e.layerX - p.x);
    rect.setHeight(e.layerY - p.y);
    layer.draw();
});

layer.on("mouseup", function(e) {
    down = false;
});​ 
```

# git - 提交发布两次：合并远程跟踪分支'origin'

> ID：13866665
> 
> 赞同：0
> 
> 时间：2012-12-13T19:06:15.087
> 
> 标签：git, version-control, merge, fast-forward

我从存储库（上游）分叉，然后在本地进行更改并推送到我的存储库（源）。

除此之外，我的大部分工作都是在控制台上完成的，今天我在笔记本电脑上完成了一些工作。

我在控制台上推到原点，然后`git fetch origin; git merge origin/master`在第二天在我的笔记本电脑上推。

发生的事情是，我把前一天的所有更改都提交到我的笔记本电脑上，然后将它们推回原点。现在，我的 origin/master 上有两组提交用于相同的工作，一次用于控制台，一次用于笔记本电脑。

我之前读过我应该[发布一次](http://sethrobertson.github.com/GitBestPractices/)，虽然我当然不考虑改变这个推送的历史，但我确实希望在工作站之间发生故障时避免这种情况。提交历史看起来很混乱。

我认为这个[`--no-ff`](http://www.kernel.org/pub/software/scm/git/docs/git-merge.html)选项`git pull`看起来很有希望，但我找到的关于这个主题的大部分信息都是关于保持[本地分支同步](http://nathaniel.themccallums.org/2010/10/18/using-git-fast-forward-merging-to-keep-branches-in-sync/)，因为其他人正在开发 master。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:33:26.507

当您有并行完成的工作（就历史而言）时，可以合并。如果您想要线性历史，请使用`--rebase`pull 上的选项。此外，您可以设置您的配置，以便 pull 每次都执行 rebase 而不是合并。

# mef - SignalR 和 MEF

> ID：13866672
> 
> 赞同：1
> 
> 时间：2012-12-13T19:06:52.003
> 
> 标签：mef, signalr

我正在尝试使用 MEF 为 SignalR 创建一个 DependencyResolver。到目前为止，我有以下内容：

```
public class SignalRMefDependencyResolver : DefaultDependencyResolver
{
    private readonly CompositionContainer _container;

    public SignalRMefDependencyResolver(CompositionContainer container)
    {
        _container = container;
    }

    public override object GetService(Type serviceType)
    {
        var export = _container.GetExports(serviceType, null, null).SingleOrDefault();

        return null != export ? export.Value : base.GetService(serviceType);
    }

    public override IEnumerable<object> GetServices(Type serviceType)
    {
        var exports = _container.GetExports(serviceType, null, null);
        var createdObjects = new List<object>();

        if (exports.Any())
        {
            createdObjects.Concat(exports.Select(x => x.Value));
        }

        createdObjects.Concat(base.GetServices(serviceType));
        return createdObjects;
    }
} 
```

我认为 GetService 正在工作，但 GetServices 无法找到 IHubDescriptorProvider 和 IMethodDescriptorProvider 的导出 - 无论是在 MEF 中还是在基础中。

在我的 Application_Start 中，我有以下作为发生的第二件事 - 首先是创建 MEF 容器：

```
 RouteTable.Routes.MapHubs(new SignalRMefDependencyResolver(MefConfig.Container)); 
```

我也试过：

```
 GlobalHost.DependencyResolver = new SignalRMefDependencyResolver(MefConfig.Container);
        RouteTable.Routes.MapHubs(); 
```

结果相同。

我在这里遗漏了一些明显的东西吗？我发现的所有样本都是针对其他容器的，而且看起来要复杂得多。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T07:30:16.263

看起来这里的问题是您使用了 'Concat()' - 它返回一个新集合，而不是更改调用它的集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T09:00:36.253

Linq-to-objects 运算符（Concat 是其中之一）没有副作用，这意味着当您进行`createdObjects.Concat(exports.Select(x => x.Value));`连接时，不会在 createdObjects 上进行连接，而是在您决定枚举`Concat`. 与几乎所有其他返回的 Linq 运算符一样，它是一个延迟运算符`IEnumerable<T>`。查看[标准查询运算符按执行方式的分类](http://msdn.microsoft.com/en-us/library/bb882641.aspx)。

现在要让您的代码正常工作，请尝试以下操作：

```
public override IEnumerable<object> GetServices(Type serviceType)
{
    var mefExports = _container.GetExports(serviceType, null, null);

    //We need this because 
    var dependencyResolverServices = base.GetServices(serviceType);
    if (dependencyResolverServices == null)
    {
        dependencyResolverServices = Enumerable.Empty<object>();
    }

    return mefExports.Select(x => x.Value).Concat(dependencyResolverServices);
} 
```

您需要检查的返回值，`base.GetServices`因为[DefaultDependencyResolver](https://github.com/SignalR/SignalR/blob/master/src/Microsoft.AspNet.SignalR.Core/Infrastructure/DefaultDependencyResolver.cs) `GetServices`可以返回 null。

然后你所要做的就是枚举你的结果`GetServices`。

# php - PHP在命令行中获得多个参数

> ID：13866675
> 
> 赞同：4
> 
> 时间：2012-12-13T19:06:58.670
> 
> 标签：php, command-line

在 php 命令行上，我只能读取第一个参数。当我添加站点名称时，程序在输入密码之前不会中断。

```
echo "Site name: ";
$handle = fopen ("php://stdin","r");
$base_name = trim(fgets($handle));
fclose($handle);

echo "Password:";
$handle = fopen ("php://stdin","r");
$base_password = trim(fgets($handle));
fclose($handle); 
```

我如何从标准输入读取这两个变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:30:37.293

您在命令时传递的参数将在全局`$argv`以及超级全局`$_SERVER["argv"]`中，`$argv[0]`并且`$_SERVER["argv"][0]`是被调用的命令。

用于解析例如调用的有用函数`./myscript.php --user=root --password=foobar`

```
function parse_argvs(){
    if( $params = $_SERVER["argv"] ){
        $file = array_shift( $params );
        while( $params ){
            $param = array_shift( $params );
            switch( strspn( $param, "-" ) ){
                case( 1 ):
                    $OPTS[ trim( $param, " -" ) ] = array_shift( $params );
                break;
                case( 2 ):
                    list( $key, $value ) = explode( "=", $param );
                    $OPTS[ trim( $key, " -" ) ] = $value;
                break;
                default:
                    $OPTS[ $param ] = true;
                break;
            }
        }
    }
    return $OPTS ?: array();
} 
```

叫做类似的东西

```
$parsed = parse_argvs();
echo $parsed['user']; //root
echo $parsed['password']; //password 
```

这些是调用时传递的*实际命令行参数。*我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:12:14.783

尝试这个：

```
$base_name     = readline("Site Name: ");
$base_password = readline("Password: "); 
```

[PHP Readline 函数](http://php.net/manual/en/function.readline.php)

# php - 如何使用 wordpress 的 do_shortcode 和用户输入的值来格式化此 echo 语句？

> ID：13866676
> 
> 赞同：2
> 
> 时间：2012-12-13T19:06:58.690
> 
> 标签：php, wordpress

我正在运行 wordpress 多站点，用户可以在其中注册免费博客。我已经购买并启用了 wordpress 选项框架工具包，以允许用户自定义选项来配置他们的博客。

使用 nextgen gallery 插件，我在博客模板文件中使用了简码：

```
<?php echo do_shortcode("[jj-ngg-jquery-slider html_id='about-slider' directionnav='true' controlnav='false' gallery='1' effect='fade' ]"); ?> 
```

在 do_shortcode 中，它只会获取 id 为 1 (gallery="1") 的画廊。该简码可以正常工作，除非用户删除了 id 为 1 的画廊，或者他们创建了一个新画廊并想要使用它而不是画廊 id 1。

在后端，我可以选择输入他们想要使用的画廊 ID。我正在使用选项框架来配置后端主题选项。选项框架使用以下代码输出用户的输入：

```
of_get_option('home_slideshow', 'Default'); 
```

我的问题是如何用 of_get_option 替换短代码中显示 gallery="1" 的单个数字“1”？我无法弄清楚实现这一目标的正确格式。先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:57:26.947

所以答案是：

```
$galleryid=of_get_option('home_slideshow', 'Default'); 
echo do_shortcode("[jj-ngg-jquery-slider html_id='about-slider' directionnav='true' controlnav='false' gallery='".$galleryid."' effect='fade' ]"); 
```

# java - 在 Java 中对复杂数组进行排序

> ID：13866677
> 
> 赞同：-2
> 
> 时间：2012-12-13T19:06:59.860
> 
> 标签：java, sorting, multidimensional-array

我在 Java 中对二维整数数组（不是 ArrayList）的内容进行排序时遇到问题。我的问题数组`path_info[ ][ ]`看起来像这样：

```
Node_x Node_y Path_ID Port_x Port_y
  4      6      500     3       2
  6      8      500     3       2      
  4      9      501     2       3
  9      3      501     2       2      
  2      3      502     3       2      
  1      5      503     2       3 
  5      2      503     2       2 
```

每行表示：Path_ID 上的 node_x 到 node_y，通过 Port_x 到 Port_y。请注意，每条路径可以是表格中的一行或多行。

该数组是路由算法从无向无权图上的节点 8 到达节点 1 的结果数组。

从源节点到达目的节点；例如表中节点 8 中的节点 1，path_ID 为 500、501、502 和 503（PATH_ID 已在列中排序`Path_ID`）。问题是我希望这个数组以这样的方式排序，即源节点是“Node_x”列的第一个节点，目标节点是“Node_y”列的最后一个节点。并且所有中间行和列都进行了适当的排序。

结果数组应如下所示（当源节点为 8 且目标节点为 1 时）：

```
Node_x Node_y Path_ID Port_x Port_y
  8      6      500     2      3
  6      4      500     2      3     
  4      9      501     2      3
  9      3      501     2      2
  3      2      502     2      3
  2      5      503     2      2
  5      1      503     3      2 
```

我还没有开始编写代码，所以没有要粘贴的片段。我仍在试图弄清楚如何实现这一目标。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:10:15.480

`Arrays.sort()`与适用于一维数组（二维数组的元素）的自定义比较器一起使用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:56:48.757

假设您的算法正常工作，您不应该多次访问同一个节点。所以你可以贪婪地寻找正确的节点，但你需要一个好的数据结构，这样你就不会不停地循环。此代码假定`path_info[index][0]`is`node_x`和`path_info[index][1]`is `node_y`。尝试这样的事情，它会在`O(n)`每个循环中及时运行：

```
import java.util.*;

public class GraphSorter {
  public static void main(String[] args) {
    int[][] graph = new int[][]{{9, 3}, {6, 4}, {3, 2}, {8, 6}, {5, 1}, {4, 9}, {2, 5} }; 
    LinkedList<int[]> myList = path(graph, 8);
    for (int[] edge : myList) {
      System.out.println(Arrays.toString(edge));
    }
  }

  public static LinkedList<int[]> path(int[][] path_info, int source) {
    HashMap<Integer, int[]> nodeXmap = new HashMap<Integer, int[]>();
    HashMap<Integer, int[]> nodeYmap = new HashMap<Integer, int[]>();
    LinkedList<int[]> foundPath = new LinkedList<int[]>();

    for(int i = 0; i < path_info.length; i++) {
      // We already found an edge with this node_x edge, turn it around
      if(nodeXmap.containsKey(path_info[i][0])) {
        int tmp = path_info[i][0];
        path_info[i][0] = path_info[i][1];
        path_info[i][1] = tmp;
      }
      nodeXmap.put(path_info[i][0], path_info[i]);
      nodeYmap.put(path_info[i][1], path_info[i]);
    }

    int current = source;
    // Use our maps to lookup where the next edge exists in our path,
    // since our input is guaranteed to be unique
    for(int i = 0; i < path_info.length; i++) {
      int[] currentEdge = nodeXmap.get(current);
      if (currentEdge == null) {
        currentEdge = nodeYmap.get(current);
        current = currentEdge[0];
      } else {
        current = currentEdge[1];
      }
      foundPath.add(currentEdge);
      nodeXmap.remove(currentEdge[0]);
      nodeYmap.remove(currentEdge[1]);
    }

    return foundPath;
  }
} 
```

# python - 如何对列表的不同列表中的某些索引执行操作，然后通过另一个索引将它们组合在一起

> ID：13866680
> 
> 赞同：0
> 
> 时间：2012-12-13T19:07:06.337
> 
> 标签：python, list, loops, grouping

下面有很多代码可以向您展示我完成这项任务所必须使用的技能水平。仅限初学者技术。

def get_monthly_averages(original_list):

```
#print(original_list)
daily_averages_list = [ ]
product_vol_close = [ ] # used for numerator
monthly_averages_numerator_list = [ ]
for i in range (0, len(original_list)):
    month_list = original_list[i][0][0:7]        #Cutting day out of the date leaving Y-M 
    volume_str = float(original_list[i][5])        #V
    adj_close_str = float(original_list[i][6])       #C
    daily_averages_sublists = [month_list,volume_str,adj_close_str]    #[Date,V,C]
    daily_averages_list.append(daily_averages_sublists)
for i in range (0, len(daily_averages_list)):      #Attempt at operation
    vol_close = daily_averages_list[i][1]*daily_averages_list[i][2]
    month_help = daily_averages_list[i][0]
    product_vol_sublists = [month_help,vol_close]
    product_vol_close.append(product_vol_sublists)
    print(product_vol_close)
    for i in range (0, len(product_vol_close)):     #<-------TROUBLE STARTS
        for product_vol_close[i][0]==product_vol_close[i][0]:  #When the month is the same
            monthly_averages_numerator = product_vol_close[i][1]+product_vol_close[i][1]
          # monthly_averages_numerator = sum(product_vol_close[i][1])         #tried both
            month_assn = product_vol_close[i][0]
            numerator_list_sublists = [month_assn,monthly_averages_numerator]                
            monthly_averages_numerator_list.append(numerator_list_sublists)
            print(monthly_averages_numerator_list) 
```

原始清单的形式为：

```
[['2004-08-30', '105.28', '105.49', '102.01', '102.01', '2601000', '102.01'],
['2004-08-27', '108.10', '108.62', '105.69', '106.15', '3109000', '106.15'], 
['2004-08-26', '104.95', '107.95', '104.66', '107.91', '3551000', '107.91'],
['2004-08-25', '104.96', '108.00', '103.88', '106.00', '4598900', '106.00'],
['2004-08-24', '111.24', '111.60', '103.57', '104.87', '7631300', '104.87'], 
['2004-08-23', '110.75', '113.48', '109.05', '109.40', '9137200', '109.40'], 
['2004-08-20', '101.01', '109.08', '100.50', '108.31', '11428600', '108.31'],
['2004-08-19', '100.00', '104.06', '95.96', '100.34', '22351900', '100.34']] 
```

第 0 个索引是日期，第 5 个是 V，第 6 个是 C。

我需要为每个月单独执行以下操作，最后有一个包含两个元素的元组；0 是月份-年份，1 是“平均价格”，如下所示。我试图最终从原始列表中的每个列表中获取第 5 个和第 6 个值，并执行如下操作...（我需要为我的课程使用初学者技术...谢谢您的理解）

平均价格 = (V1* C1 + V2 * C2 +...+ Vn * Cn)/(V1 + V2 +...+ Vn)

（V=列表中的每个第 5 个元素 C=列表中的每个第 6 个元素）

我的问题是仅将上述任务执行到一个月而不是整个列表，然后得到如下结果，

```
[('month1',average_price),('month2',average_price),...] 
```

我编了

```
for i in range (0, len(product_vol_close)):     #<-------TROUBLE STARTS
    for product_vol_close[i][0]==product_vol_close[i][0]: 
```

# 在同一月份和同一年将它们组合在一起。

尝试并展示我试图让它做的事情。我找不到任何关于如何让它按照我想要的方式工作的答案。

如果还有不明白的地方请评论！再次感谢您对此事的耐心、理解和帮助！

我完全迷路了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T20:13:02.813

这里的关键是停止使用列表并使用字典，它将为您将事物组合在一起。

通常你会[`defaultdict`](http://docs.python.org/2/library/collections.html)从 collections 模块中使用，但由于这看起来像是不允许的家庭作业，所以这是一个“漫长”的方法。

在您的示例数据中，每个日期只有一行，因此我将在代码片段中假设相同。为了让我们的生活更轻松，我们将按年月存储日期；因为这就是我们计算的基础：

```
>>> date_scores = {}
>>> for i in data:
...    year_month = i[0][:7] # this will be our key for the dictionary
...    if year_month not in date_scores:
...         # In this loop, we check if the key exists or not; if it doesn't
...         # we initialize the dictionary with an empty list, to which we will
...         # add the data for each day.
...         date_scores[year_month] = []
...    
...    date_scores[year_month].append(i[1:]) # Add the data to the list for that
...                                          # for the year-month combination
... 
>>> date_scores
{'2004-08': [['105.28', '105.49', '102.01', '102.01', '2601000', '102.01'], ['108.10', '108.62', '105.69', '106.15', '3109000', '106.15'], ['104.95', '107.95', '104.66', '107.91', '3551000', '107.91'], ['104.96', '108.00', '103.88', '106.00', '4598900', '106.00'], ['111.24', '111.60', '103.57', '104.87', '7631300', '104.87'], ['110.75', '113.48', '109.05', '109.40', '9137200', '109.40'], ['101.01', '109.08', '100.50', '108.31', '11428600', '108.31'], ['100.00', '104.06', '95.96', '100.34', '22351900', '100.34']]} 
```

现在，对于每个年月组合，我们在字典中都有一个列表。该列表包含我们拥有数据的那个月中每*一天*的子列表。现在我们可以执行以下操作：

```
>>> print 'We have data for {} days for 2004-08'.format(len(date_scores['2004-08']))
We have data for 8 days for 2004-08 
```

我认为这解决了你的大部分循环问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:51:57.260

我的建议是在数据行上坚持一个主循环。像这样的东西（伪代码）：

```
current_month = None
monthly_value = []
monthly_volume = []

for row in data:
    date, volume, price = parse(row) # you need to write this yourself
    month = month_from_date(date) # this too

    if month != current_month: # do initialization for each new month
        current_month = month
        monthly_value.append(0)
        monthly_volume.append(0)

    monthly_value[-1] += volume*price # indexing with -1 gives last value
    monthly_volume[-1] += volume 
```

然后，您可以进行第二次循环来计算平均值。请注意，这要求您的数据按月分组。如果你的数据组织得不是很好，你可以用字典（按月份索引）替换上面代码中的列表。或者您可以使用不需要任何每月初始化的`defaultdict`（来自标准库中的[`collections`模块）。](http://docs.python.org/2/library/collections.html)但也许这比你想要的要先进一点。

# android - InstantiationException：无法实例化类..没有空的构造函数

> ID：13866682
> 
> 赞同：-1
> 
> 时间：2012-12-13T19:07:14.777
> 
> 标签：android

以下代码在`run()`_ _ 有人帮助完成基本步骤。这是代码：`@override``run()``draw()`

```
 private class MyWallpaperEngine extends Engine {
            private final Handler handler = new Handler();
            private final Runnable drawRunner = new Runnable() {
                public void run() {
                    draw();
                }
            };
    }

12-14 00:55:24.111: W/dalvikvm(7141): threadid=1: thread exiting with uncaught exception (group=0x409961f8)
12-14 00:55:24.181: E/AndroidRuntime(7141): FATAL EXCEPTION: main
12-14 00:55:24.181: E/AndroidRuntime(7141): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.sri.alinwallpaper/com.sri.alinwallpaper.MyPoint}: java.lang.InstantiationException: can't instantiate class com.sri.alinwallpaper.MyPoint; no empty constructor
12-14 00:55:24.181: E/AndroidRuntime(7141):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1879)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1980)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at android.app.ActivityThread.access$600(ActivityThread.java:122)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1146)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at android.os.Looper.loop(Looper.java:137)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at android.app.ActivityThread.main(ActivityThread.java:4340)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at java.lang.reflect.Method.invokeNative(Native Method)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at java.lang.reflect.Method.invoke(Method.java:511)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at dalvik.system.NativeStart.main(Native Method)
12-14 00:55:24.181: E/AndroidRuntime(7141): Caused by: java.lang.InstantiationException: can't instantiate class com.sri.alinwallpaper.MyPoint; no empty constructor
12-14 00:55:24.181: E/AndroidRuntime(7141):     at java.lang.Class.newInstanceImpl(Native Method)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at java.lang.Class.newInstance(Class.java:1319)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
12-14 00:55:24.181: E/AndroidRuntime(7141):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1870)
12-14 00:55:24.181: E/AndroidRuntime(7141):     ... 11 more
12-14 00:55:37.751: I/Process(7141): Sending signal. PID: 7141 SIG: 9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:13:29.873

删除`@Override`注释。没有它应该可以正常工作。

根据[这个问题的答案](https://stackoverflow.com/questions/6484527/android-override-error)，这是因为*在 Java 5 中，您不能将 @Override 注释与实现接口的方法一起使用，只能使用超类中方法的实际覆盖。*

# c++ - 枚举与数组

> ID：13866683
> 
> 赞同：1
> 
> 时间：2012-12-13T19:07:17.640
> 
> 标签：c++, arrays, enums

我想知道什么会更好：枚举声明或字符串数​​组：

```
enum MonthName{January, February, March, April, May, June, ...) 
```

或者

```
string MonthName[12] = {"January", "February", "March", "April", "May", "June", ...) 
```

因为对我来说这似乎并不重要。

这个变量只能被一个函数访问，根据输入的数字显示月份。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-13T19:10:15.843

如果你想显示月份的*名称*`enum`，那对你没有任何好处。枚举类型定义中的标识符仅对编译器可见；你不能在运行时打印它们。

您需要字符串数组（或者可能是`const char*`s 数组）。

月份的名称也可以通过标准库使用（来自 C 标准库的头文件）`strftime()`中声明的函数获得。使用给定月份编号获取月份名称并不简单（您必须先构建一个对象）。它确实具有使用当前语言环境的月份名称而不是硬连线到英语的优势。`<ctime>``<time.h>``strftime()``struct tm`

并且不要忘记数组索引从 0 开始；12 月的指数为 11，而不是 12。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:11:02.973

这很重要。如果您需要可打印的文本，请使用字符串数组。枚举不会转化为可读的名称；它们只是整数值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:09:29.770

枚举和数组之间没有任何共同点。使用枚举，您无法打印月份的名称，这只是一个整数......

在您的情况下，您应该使用

```
static const char* MonthName[2] = {"January", "February", ...}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T19:15:45.330

在这种情况下，枚举和字符串都是不同的，会产生不同的结果。如果是枚举，您可以将月份名称和月份名称存储在枚举类型的变量中，例如

```
MonthName mn = March; 
```

该变量`mn`将携带整数值`2`。如果是带有月份名称的字符串数组，您需要将月份编号指定为数组索引，您将得到月份的字符串名称而不是月份编号，例如

```
string mn = MonthName[2]; 
```

该变量`mn`将携带字符串`"March"`并可用于显示月份。但是，您可以以更好的方式同时使用枚举和字符串数组，例如

```
string mn = MonthName[March]; 
```

在这里，枚举`March`将作为字符串数组的索引`MonthName`并返回`"March"`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T19:31:49.153

我建议使用以下表格将两者结合起来`structs`：

```
enum Months
{
    JANUARY = 1,
    FEBRUARY,
    APRIL,
//...
    DECEMBER,
    NUMBER_OF_MONTHS
};

struct Month_Enum_Conversion_Entry
{
    Months                month_id;
    char const * const    month_name;
};

Month_Enum_Conversion_Entry month_conversion_table[] =
{
    {JANUARY, "January"},
    {FEBRUARY, "February"},
//...
    {DECEMBER, "December"}
};
static const unsigned int NUM_TABLE_ENTRIES =
    sizeof(month_conversion_table) / sizeof(month_conversion_table[0]); 
```

要将枚举转换为文本，请在表中搜索枚举并访问文本字段：

```
std::string Month_ID_To_Name(Months m)
{
    char const * p_month_name = NULL;
    for (unsigned int i = 0; i < NUM_TABLE_ENTRIES; ++i)
    {
        if (month_conversion_table[i].month_id == m)
        {
            p_month_name = month_conversion_table[i].month_name;
            break;
        }
    }
    return std::string(p_month_name);
} 
```

两个优化：

1.  将表加载到 a`std::map`中以实现更快的转换。
2.  在一月之前在转换表中添加一个空的、未使用的条目，然后使用月份编号对表进行索引。上述方法比索引到数组更健壮，因为数组在索引和值之间具有隐含的关系。上面的示例提供了 ID 和名称之间的显式关系。

# php - 为什么我的 Regexp-Code 不显示 html 代码？

> ID：13866686
> 
> 赞同：0
> 
> 时间：2012-12-13T19:07:28.343
> 
> 标签：php, regex, preg-replace

我想改变类似的`<var title="some text">Something</var>`东西`<abbr title="some text">Something</abbr>`。我有这段代码，但不知何故它没有在我的网页上显示缩写标签：

```
$arr[0] = preg_replace("#<var(.*?)>(.*?)</var>#", "<abbr $1>$2</abbr>", "".$arr[0].""); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:29:51.563

是的，您应该使用 HTML 解析器，并避免使用正则表达式来解析 HTML：

```
// Load the HTML into the parser
$doc = new DOMDocument;
$doc->loadHTML( '<var title="some text">Something</var>');

// Find the <var> tags, and create new <abbr> tags from them.
foreach( $doc->getElementsByTagName( 'var') as $var) {
    $abbr = $doc->createElement( 'abbr', $var->textContent);
    $abbr->setAttribute( 'title', $var->getAttribute( 'title'));
    echo $doc->saveHTML( $abbr); // Here is your new <abbr> tag
} 
```

您可以从[这个演示](http://viper-7.com/E7OBa3)中看到，这会产生：

```
<abbr title="some text">Something</abbr> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:23:28.843

更改`"<abbr $1>$2</abbr>"` 为`'<abbr $1>$2</abbr>'`（注意单引号）。

请参阅[单引号字符串](http://php.net/manual/en/language.types.string.php#language.types.string.syntax.single)。

# javascript - 我可以使用交集来缩短这个正则表达式吗？

> ID：13866690
> 
> 赞同：6
> 
> 时间：2012-12-13T19:07:52.707
> 
> 标签：javascript, regular-language, string-length

我有这种语言 L 只包含一个字符串： ![在此处输入图像描述](../Images/e32f9455754c7e6bc62125ea3df2ea7f.png) 写得更简洁![在此处输入图像描述](../Images/1ba9b66206ea3ef5eafd2ab739893c36.png)

这个字符串有 2(2^n−1) 个字符，我想减少它。我正在考虑使用交集，如果我能找到一些正则语言，它们的正则表达式的交集会产生这个字符串。

我在这里有递归函数，以防万一：

```
function recursiveRegex(charset) {
if(charset.length == 0) {
    return [];
} else {
    var char = charset.splice(charset.length - 1, 1);
    var returnVal = recursiveRegex(charset);
    return returnVal.concat(returnVal) + char ;
}
}

console.log(recursiveRegex(['a1', 'a2', 'a3', 'a4'])); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T20:11:37.190

这不是常规语言，因此您找不到常规语法来定义它。

因此，这种语言没有正则表达式。

```
A_1: a_1

A_2: A_1 A_1 a_2

A_3: A_2 A_2 a_3

A_n: A_{n-1} A_{n-1} a_n 
```

该语法定义了您的语言，它不是常规语法。

该文法没有定义常规语言的一个直接证据是，定义语言需要的内存位置不止一个常数。对于给定的`N`，需要一个取决于`N`保留第`N`th 单词的数字。

* * *

将每个左侧符号视为一个内存位置。如果你想让它有规律，你应该有有限数量的规则。如果您需要使其有限，则应该这样做：

原子：a1

RULE_{n+1}：原子 | RULE_n RULE_n a_{n+1}

要正确创建这种语言，您需要一个 counter ，以便知道`a_n`每时每刻要插入什么。但是不可能使用常规语法创建任何类型的计数器。

# django - django 1.4 在生产中没有看到任何模型和应用程序

> ID：13866691
> 
> 赞同：0
> 
> 时间：2012-12-13T19:07:53.313
> 
> 标签：django, django-admin

在生产中，当我通过管理站点或 shell (is_staff=True) 创建用户时，我无法添加任何模型。我只看到：可以添加/更改/删除日志、组、权限、用户。我的模型不在那里。为什么？但是在开发人员服务器上一切正常。

我使用 django 1.4 我的配置开发人员和生产在 settings_local.py 上是不同的。但只有数据库，

```
DEFAULT_FROM_EMAIL, 
DEBUG = True, 
DEBUG_GRID = False, 
EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend', 
TEMPLATE_DEBUG = False

That's all. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T21:56:04.793

您必须将模型注册到 django-admin 才能在管理站点中对它们进行操作。

例子：

```
models.py
class ModelA():
  ...

admin.py

from django.contrib import admin
admin.site.register(ModelA)

urls.py
from django.contrib import admin
admin.autodiscover() 
```

更新：使用员工登录，您将无法访问模型。员工状态仅允许您登录管理站点。要让他们执行 CRUD 操作，您需要授予他们权限。现在，如果您看不到权限，可能是因为您一开始就没有权限，请检查您的数据库以确定。

# django - 在 django sweetpie 中过滤 GenericForeignKeyField

> ID：13866694
> 
> 赞同：0
> 
> 时间：2012-12-13T19:08:00.990
> 
> 标签：django, tastypie

在 django-tastypie 资源中使用 GenericForeignKeyField，有没有办法根据 content_type 过滤结果？我想向 Meta 类添加一个过滤器，就像使用常规字段一样，但我无法使用 GenericForeignKeyField 来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T21:35:04.117

通过将此方法添加到我的资源中，我最终使内容类型脱水

```
def dehydrate(self,bundle):
    bundle.data['type'] = bundle.obj.content_type
    return bundle 
```

然后我在客户端过滤了数据。它不是一个理想的解决方案，但现在已经足够了

# android - 删除 3 个地图叠加层中的 1 个

> ID：13866695
> 
> 赞同：0
> 
> 时间：2012-12-13T19:08:01.500
> 
> 标签：android, overlay, android-mapview

我有一个在地图上显示点的应用程序。当前用户有 3 个地图叠加层 (1)；(2) 为用户的朋友/联系人；(3) 为他人。我试图允许用户选择地图上显示的内容。目标是允许他们显示每个人（用户、朋友和其他人）或过滤地图以仅显示他们的朋友/联系人。

我可以很好地将不同的叠加层添加到地图中。问题是删除覆盖。

我在这里尝试了这种方法——[如何刷新活动？地图视图刷新失败](https://stackoverflow.com/questions/2756409/how-to-refresh-an-activity-map-view-refresh-fails)- 建议使用以下代码按索引删除项目：

```
private void showFriends(){

mapOverlays = mapView.getOverlays();
int j = othersMapOverlay.size();
for(int i = friendsMapOverlay.size; i < j; i++){
    mapOverlays.remove(i);
}
mapView.invalidate();
} 
```

我的策略是创建所有覆盖的列表 - mapOverlays，然后使用 for 循环，从第一个覆盖的末尾开始，friendsMapOverlay，然后删除，直到我到达第二个地图覆盖的末尾，othersMapOverlay。

那没有用。

我还尝试使用两者来删除列表对象

```
mapOverlays.remove(othersMapOverlay); 
```

或者

```
mapView.getOverlays().remove(othersMapOverlay); 
```

但这些都不起作用。知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T22:58:48.190

最终使用了以下内容。它并没有真正隐藏或删除覆盖，只是清除和重绘。这必须比我想做的效率低 - 即只是删除那里的东西，但它有效。. . 目前。

```
private void showEveryone(){

    mapOverlays = mapView.getOverlays();
    mapOverlays.clear();
    mapView.invalidate();
    JSONArray friends = buildFriendList();
    JSONArray others = buildOthersList();
    getUserDataForMap(friends, "friends");
    getUserDataForMap(others, "others");

} 
```

# python - Python re 模块 - 使用“或”时重复符号限制

> ID：13866696
> 
> 赞同：1
> 
> 时间：2012-12-13T19:08:03.933
> 
> 标签：python, regex

我有个问题。可以说有这样的模式：

```
>>> import re
>>> pt ='^a{1,2}$'
>>> re.search(pt, 'aa') # looks ok
<_sre.SRE_Match object at 0x020B2288>
>>> re.search(pt, 'aaa') # ok too
>>> 
```

现在让我们尝试寻找与另一个模式的匹配：

```
>>> pt = '^a{1,2}|x$'
>>> re.search(pt, 'a') # this one looks ok
<_sre.SRE_Match object at 0x020B25D0>
>>> re.search(pt, 'aaax') # (1) Now this one?
<_sre.SRE_Match object at 0x020B2288>
>>> re.search(pt, 'aaaaaax') # (2) and this one?
<_sre.SRE_Match object at 0x020B25D0>
>>> re.search(pt, 'aaa') # (3) and this one?
<_sre.SRE_Match object at 0x020B25D0> 
```

(1)(2)(3) 对我来说，它看起来应该匹配以一个或两个“a”或一个“x”或两者组合开头并在这些字母之间结束的字符串，但仅此而已。还是我不明白？应该是这样吗？就像当你使用'|'时，它会忽略 {} 中的限制？有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:10:58.537

受`$`分组影响。您的正则表达式被解释为`(^a{1,2})|(x$)`，它匹配“字符串开头的一个或两个”或“字符串末尾的一个 x”。如果您只想将`|`apply 应用于 as 和 xs，则需要将它们分组：

```
pt = '^(a{1,2}|x)$' 
```

或者，如果您不想捕获该组，请使用非捕获组：

```
pt = '^(?:a{1,2}|x)$' 
```

编辑：我不确定我是否理解您要匹配的内容，但也许可以尝试：

```
pt = '^(a{1,2}x?|x)$" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T19:11:40.477

`^foo|bar$`匹配`^foo`或`bar$`.

# python - Python - 读取和/或写入 ini 文件的选项

> ID：13866699
> 
> 赞同：2
> 
> 时间：2012-12-13T19:08:16.673
> 
> 标签：python, options, ini, configparser, defaults

我需要一些（基本）python代码的帮助：

```
from ConfigParser import SafeConfigParser
import os
inifile=os.path.basename(__file__)+".ini"

def GetOption(Section, Option, Default):
 while True:
  parser=SafeConfigParser()
  f=open(inifile,"w")
  f.close()
  parser.read(inifile)
  if parser.has_section(Section):
   if parser.has_option(Option):
    Output=parser.get(Section, Option)
    break
   else: parser.set(Section, Option, str(Default))
  else: parser.add_section(Section)
 return Output

Rate=GetOption("MAIN","Rate",0.2208)
Currency=GetOption("MAIN","Currency","euros") 
```

我要做的是从 .ini 文件（与脚本共享相同的名称）中读取它，如果它不存在则创建它。

同样，如果它不存在，它将读取该部分并创建它。它正在读取的选项相同，如果不存在，请将选项设置为默认值。

照原样，它会创建文件，但它是空的，因此它不会读取任何内容，也不会破坏 while 循环。

我对 python 很陌生，从未使用过 ConfigParser 模块，这可能是我被卡住的原因（或者因为我遗漏了一些明显的东西）

无论哪种方式，我都会感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T19:29:00.157

You're never actually writing to the config file. Take a look at [http://docs.python.org/3/library/configparser.html#examples](http://docs.python.org/3/library/configparser.html#examples) for some usage patterns.

# c - 加法和减法时的数值问题

> ID：13866701
> 
> 赞同：-4
> 
> 时间：2012-12-13T19:08:24.107
> 
> 标签：c, numerical

我想知道以下 C 程序是否有可能打印除 0 之外的其他内容？

```
double f(double x, double y) {
  return x*x/x+x*x*x; // or whatever operations using *, /, +, -
}
int main(int argc, char** argv) {
  double x = 4.0;
  double y = 5.0;
  double z = f(x,y);
  x += 1e-7;
  x -= 1e-7;
  printf("%f\n", (f(x,y+1e-7)-z)/1e-7);      
  return 0;
} 
```

任何人都可以启发我吗？干杯，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T20:13:06.977

如果 x 必须为 4，则否，因为在使用 64 位 IEEE 754 二进制浮点运算时，将 1e-7 加到 x 然后再减去它不会改变 x。这意味着相同的两个 x 值将传递给对 f 的两个调用，因此将返回相同的结果，并且它们的差将为零。

如果 x 可以更改，那么您可以通过将 x 设置为 0x3.ffffffffffff8p0 并将 f 中的语句更改为：

```
return x*x*x*x*x*x; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T21:12:05.727

忽略您的注释“// 或使用 *、/、+、-”的任何操作，您的函数 f 完全忽略 y，并且仅使用 x 返回 x+x^3。跟踪您的代码：

```
z = x + x^3
f(x, y+1e-7) is also x+x^3, hence equal to z. 
```

最后你正在打印

```
(f(x, y+1e-7) - z) / 1e-7 
```

因为我们建立了 f(x, y+1e-7) 等于 z，所以你在做 (zz)/1e-7。根据定义，0除以任意数就是0。

请注意，由于这两个数字都是以相同的方式达到的，因此您甚至没有机会获得任何浮点乐趣（这是两个浮点数实际上相等的罕见情况之一）。因此，对于您拥有的代码，您可以获得非零打印，除非您有一些硬件或编译器，或者......错误。

# python - 子类化 ctypes 指针 - 此代码如何工作，以及如何覆盖它？

> ID：13866706
> 
> 赞同：0
> 
> 时间：2012-12-13T19:09:02.750
> 
> 标签：python, ctypes

我正在使用`pylibtiff`图书馆（托管[在这里](http://code.google.com/p/pylibtiff/)），我正在尝试扩展`class TIFF(ctypes.c_void_p)`. 我在使用以下方法时遇到问题：

```
# lib has been loaded with the path to libtiff.so, or equivalent
libtiff = ctypes.cdll.LoadLibrary(lib)

class TIFF(ctypes.c_void_p):
    @classmethod
    def open(cls, filename, mode='r'):
        """ Open tiff file as TIFF.
        """
        tiff = libtiff.TIFFOpen(filename, mode)
        if tiff.value is None:
            raise TypeError ('Failed to open file '+`filename`)
        return tiff 
```

[（这里](http://code.google.com/p/pylibtiff/source/browse/trunk/libtiff/libtiff_ctypes.py#343)全班）

现在，这里的预期使用模式是我们打开一个文件并接收一个`class TIFF`实例，如下所示：

```
import libtiff
t = libtiff.TIFF.open('myfile.tiff')

# e.g. grab a numpy array of the data:
arr = t.read_image() 
```

这是什么魔法？如何将 libtiff 中的 C 变量[键入为](http://www.remotesensing.org/libtiff/man/TIFFOpen.3tiff.html) `TIFF*`返回 pythonland 并自动成为`class TIFF`实例？大概这与子类化有关`ctypes.c_void_p`

我问是因为我试图覆盖一个方法`class TIFF`：

```
import libtiff
class TIFFdifferent(libtiff.TIFF):
    def read_image(self, verbose=False, different=False):
        if not different:
            return libtiff.TIFF.read_image(self, verbose)

        # my different code ... 
```

但是，当我尝试创建一个`class TIFFdifferent`实例时，我得到了一个`class TIFF`：

```
In [3]: t = libtiffdifferent.TIFFdifferent.open('file.tiff')

In [4]: arr = t.read_image(different=True)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-4-8bdc24ec874c> in <module>()
----> 1 arr = t.read_image(different=True)

TypeError: read_image() got an unexpected keyword argument 'different'

In [5]: t.read_image?
Type:       instancemethod
String Form:<bound method TIFF.read_image of <TIFF object at 0x10b67df80>>
File:       /Library/Python/2.7/site-packages/libtiff/libtiff_ctypes.py
Definition: t.read_image(self, verbose=False)
Docstring:
Read image from TIFF and return it as an array.

In [6]: t
Out[6]: <TIFF object at 0x10b67df80> 
```

所以，我需要做的也是重写——如果不了解从 C到 python实例的魔法转换，没有构造函数、强制转换或任何其他显式的东西`open`，我不知道该怎么做。`TIFF*``class TIFF`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:26:47.107

神奇之处在于[libtiff_ctypes.py](http://code.google.com/p/pylibtiff/source/browse/trunk/libtiff/libtiff_ctypes.py)的第 1041 行：

```
libtiff.TIFFOpen.restype = TIFF 
```

如[15.17.1.8 文档中的返回类型](http://docs.python.org/library/ctypes.html#return-types)中所述`ctypes`，您不必使用`ctypes`类型作为结果类型；您可以指定任何 Python 可调用对象——通常是一个函数，它将验证真正的 C 返回值以引发异常，或者一个类，它将真正的 C 返回值作为其构造函数参数。

您可能会注意到`TIFF`该类没有定义`__init__`方法。这就是继承 from 的来源：您可以从指针`c_void_p`构造 a ；`c_void_p`因此，如果你有一个 的子类`c_void_p`，并且它不需要做任何其他初始化，它可以只依靠基类构造来处理它。

> `TIFF*`所以，我需要做的是也覆盖 open - 如果不了解从 C到 python 类`TIFF`实例的魔法转换，没有构造函数、强制转换或任何其他显式的东西，我不知道该怎么做。

好吧，你显然可以在你的覆盖中做一个显式的构造调用，即使原始版本没有这样做：

```
def myopen(*args):
    tiffpointer = libtiff.cfunc(*args)
    return TIFF(tiffpointer) 
```

但是，如果您不能只定义`libtiff.cfunc.restype`（例如，因为其中的某些其他代码`pylibtiff`依赖于它返回不同内容的事实），您只会想这样做。

无论如何，我不确定这是你真正想要做的。你想要做的是写这样的东西：

```
class TIFFDifferent(TIFF):
    …
    @classmethod
    def open(cls, filename, mode='r'):
        tiff = libtiff.TIFFOpen(filename, mode)
        if tiff.value is None:
            raise TypeError ('Failed to open file '+`filename`)
        return cls(tiff) 
```

这行得通，而您根本不必了解背后的魔力`restype`。除非您担心构造一个短暂的临时`TIFF`对象的成本（正如您所见，除了 a 之外没有成员和构造函数代码`c_void_p`），这还不够简单吗？

还有一种可能性，我通常不会建议，也可能不适合这里，但可能是：如果`pylibtiff`设计的方式很难通过子类覆盖其行为，您可以（a）分叉编写代码并使用您自己的版本，或者 (b) 在运行时对其进行猴子补丁。正如您自己的评论中所建议的那样，如下所示：

```
class TIFFDifferent(TIFF):
    …
    @classmethod
    def open(cls, filename, mode='r'):
        stash = libtiff.TIFFOpen.restype
        libtiff.TIFFOpen.restype = cls
        tiff = libtiff.TIFFOpen(filename, mode)
        libtiff.TIFFOpen.restype = stash
        if tiff.value is None:
            raise TypeError ('Failed to open file '+`filename`)
        return tiff 
```

如果您的构造函数可能抛出异常，您可能希望将存储包装在 a `contextmanager`（或使用`try:`/ ）中；`finally:`否则你会留下`restype`补丁。

# sql - 将列字段作为新行拉入另一个表

> ID：13866709
> 
> 赞同：0
> 
> 时间：2012-12-13T19:09:14.360
> 
> 标签：sql

我偶然发现了这个，希望它很容易，我看错了。

我正在接收格式化的 xls 文件。有一个 C# 应用程序来处理数据并将 SQLBulkCopy 插入到我的表中。有 5 对列，一对是 URL 文本描述，一对是 URL 本身。这些 URL 将引用一个 html 或 pdf 文件，我稍后会将其拉入第二个单独的表中。

省略不相关的字段，我有一个包含字段的表**[Base]**：

> [ID] (identity)
> [BaseID]
> ...一堆其他相关字段，然后...
> [LinkText1]
> [LinkURL1]
> [LinkText2]
> [LinkURL2]
> [LinkText3]
> [LinkURL3]
> [LinkText4]
> [LinkURL4]
> [LinkText5]
> [链接URL5]

URL/文件的存储将在一个表**[Documents]**中，其中包含以下字段：

> [BaseIdentityID] - 引用 [Base] 表中的 ID 字段
> [DocIndex] - 每条 Base 记录可以填写 1 - 5 个 URL。这是为了知道它是哪个 URL。
> [MimeType]
> [Url]
> [Text]
> [Content]
> [Processed] - 位 - 稍后将提取 url 数据，这会标记。

我在 [Base] 表上使用了 INSTEAD OF 触发器。这些记录可以更新，因此我们将存档数据保留在表中。触发器查看我们正在插入的内容，将现有版本标记为旧版本，并将这个新的基本记录插入为 CurrentVersion。

在这个触发器中，我现在想根据 5 对 URL 数据中的每一对向 [Documents] 表中插入一个新行，并传入 Documents 表中 [BaseIdentityID] 的 [Base] ID 身份字段， LinkURL1 的 [DocIndex] 为 1，LinkURL2 的 [DocIndex] 为 2，等等...

很难想象我将如何准确地做到这一点。有什么建议么？我试图避免使用游标，因为我可以插入大量基本记录。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:21:17.787

也许您可以在 AFTER INSERT 触发器中编写这种查询：

```
INSERT INTO [InternationalDR].[dbo].[Documents] ([BaseIdentityID], [DocIndex], [Url], [Text])
SELECT INSERTED.[ID], 1, INSERTED.[LinkURL1], INSERTED.[LinkText1] FROM INSERTED
UNION ALL SELECT INSERTED.[ID], 2, INSERTED.[LinkURL2], INSERTED.[LinkText2] FROM INSERTED
UNION ALL SELECT INSERTED.[ID], 3, INSERTED.[LinkURL3], INSERTED.[LinkText3] FROM INSERTED
UNION ALL SELECT INSERTED.[ID], 4, INSERTED.[LinkURL4], INSERTED.[LinkText4] FROM INSERTED
UNION ALL SELECT INSERTED.[ID], 5, INSERTED.[LinkURL5], INSERTED.[LinkText5] FROM INSERTED; 
```

# xml - 如何使用 xml 和 VB.net 请求和响应？

> ID：13866712
> 
> 赞同：5
> 
> 时间：2012-12-13T19:09:26.547
> 
> 标签：xml, vb.net, winforms, wsdl, request

我被要求向服务器发送请求以在线注册积分收集系统的交易。我对这个请求-响应程序了解不多。

他们告诉我请求应该是这样的：

```
request( 
p1 - loginInfo:UN|PASS|MP1
p2 - XMLTransactionInfo (below)
p3 - returnPointBalance:1
)

<transaction>
  <partnernum>000001</partnernum>
  <trxndate>2012-10->12T07:18:27</trxndate>
  <cardnum>1234567891234567</cardnum>
  <trxnamount>5.4</trxnamount>
  <trxnpoints>729</trxnpoints>
  <posnum>000-001</posnum>
  <contactidnum></contactidnum>
  <contactphone>357</contactphone>
  <trxnseqnum>12345612345612</trxnseqnum>
</transaction> 
```

响应应该是这样的：

```
response(    
<?xml version="1.0" encoding="UTF-8"?> 
<transactionresponse xmlns="C:\path\Sth.ear\Sth.war/xmlschema/TransactionResponse.rng">
  <sequencenum>123123121312</sequencenum> 
  <errorcode>0</errorcode> 
  <errormessage></errormessage> 
  <trxnnum>6399575</trxnnum> 
  <balancebefore>1942</balancebefore> 
  <balanceafter>1213</balanceafter> 
  <mpcontrib>729</mpcontrib> 
  <partnercontrib>0</partnercontrib> 
</transactionresponse>
) 
```

他们还告诉我：“您可以使用以下 URL 获取 WSDL：url1...”和“WS 端点是：url2...”

到目前为止，我已经设法做到以下几点：

```
Dim request As WebRequest = Nothing

  'Create a request for the URL.
  request =WebRequest.Create("URL1")

  'set the credentials.
  Dim credentials As NetworkCredential
  loginUser = "username"
  loginPass = "pass"
  credentials = New NetworkCredential(loginUser, loginPass, "MP1")
  request.Credentials = credentials

  'create the transaction xml
  request.ContentType = "text/xml"
  Dim transaction As XmlElement
  transaction = xml2.CreateElement("transaction")
  xml2.AppendChild(transaction)

  Dim partnernum As XmlElement
  partnernum = xml2.CreateElement("partnernum")
  partnernum.InnerText = "00001"
  transaction.AppendChild(partnernum)

  'and so on until i create the exact same xml as above... 
```

然后我将 XML 文件打印到控制台进行目视检查，然后请求响应

```
 'print to console
  xml2.Save(Console.Out)
  Dim response As WebResponse = request.GetResponse()
  Console.WriteLine(response.ToString())
  'write the response to a textbox
  responseText.Text = response.Headers.ToString() 
```

文本框中响应的结果是

```
Content-Language: el-GR
Transfer-Encoding: chunked
Content-Type: text/xml
Date: Thu, 13 Dec 2012 18:52:33
GMT Server: WebSphere Application Server/6.0 
```

首先，我应该使用他们给我的 2 个网址中的哪一个？

其次，我如何创建他们告诉我的请求以获得我想得到的响应？

有没有分步指南？

我正在使用 VB.net，WinForms。感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T12:23:22.383

在 Visual Studio 中添加对 WSDL url 的引用。

# java - javaSpace 安全错误

> ID：13866713
> 
> 赞同：1
> 
> 时间：2012-12-13T19:09:28.553
> 
> 标签：java, javaspaces

尝试使用 TransactionManager 但每次运行应用程序时都会出现错误（见下文）。

```
Error: java.security.AccessControlException: access denied ("java.net.SocketPermission" "[0:0:0:0:0:0:0:1]:4160" "connect,resolve") 
```

我试图用谷歌搜索这个问题，虽然不是每个人都有同样的错误，但人们建议类似的方法可以解决它（见下文）。我不知道如何应用它，如果它与项目一起进入 Eclipse 或者它是否作为批处理文件运行？

```
java -Djava.security.policy=/local/public/chs2546/policy.all HelloWorldNotify 
```

任何帮助都会很棒，谢谢！

# php - 如何将函数作为参数传递给类的本地变量

> ID：13866717
> 
> 赞同：0
> 
> 时间：2012-12-13T19:09:42.363
> 
> 标签：php

如何将函数作为参数传递给类，然后将其分配给本地类的 var！

这是我的情况，可以解决吗？

```
<?php
class a {
  protected $var;

  function __construct($fun) {
    echo $fun('world'); // This is working perfect
    $this->var = $fun;
  }

  function checkit($x) {
    return $this->var($x);  // This is not working [ Call to undefined method a::var() ]
  }
}
$mth = 'mathm';
$cls = new a(&$mth);    // result [ hello (world) ]

echo $cls->checkit('universe');  // <- not working as it fail

function mathm($i) {
  return 'hello (' . $i . ')';
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T15:00:04.757

我认为你在这里混淆了一些东西。从您的代码中，您只是将变量的地址（包含字符串“mathm”作为其值）传递给`class a`. 引用保存到实例变量`$var`（仍然带有字符串值）。然后在您`checkit()`尝试使用该值（“数学”），就好像它是一个函数一样。函数`mathm()`存在正常但不在`class a`. 所以`class a`对任何调用的函数的位置一无所知`mathm`。因此错误。

如果您在其中插入代码行`print_r($this->var);`，`checkit()`您将看到输出是一个简单的字符串，而不是函数或对函数的引用。

您可以使用闭包（也称为匿名函数）来传递函数。或者您可以创建一个包含该函数的类，`mathm`然后传递该类的一个实例以在类 a 中使用。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:11:44.457

```
return $this-var($x); 
```

需要是：

```
return $this->var($x); 
```

# magento - Magento URL 密钥，包括哈希 (#)

> ID：13866720
> 
> 赞同：2
> 
> 时间：2012-12-13T19:10:10.027
> 
> 标签：magento, url, hashtag

我在 magento 中使用过滤器导航，因此过滤页面的 url 显示如下：www.example.com/page#cat=16&gan_data=true

我想更改我的类别的 URL 键，使它们指向包括过滤器设置的顶级菜单（如上面的 url），而不是子级页面。

问题是，当我像这样保存 URL 键时，哈希标记从 # 变为 - ，所以新的 url 看起来像这样：www.example.com/page-cat-16-gan-data-true

有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T22:31:14.213

格式化 URL 键的方法是 Mage_Catalog_Model_Category::formatUrlKey()：

```
public function formatUrlKey($str)
{
    $str = Mage::helper('core')->removeAccents($str);
    $urlKey = preg_replace('#[^0-9a-z]+#i', '-', $str);
    $urlKey = strtolower($urlKey);
    $urlKey = trim($urlKey, '-');
    return $urlKey;
} 
```

任何非字母数字字符都将替换为破折号。因此，如果没有工作，您将无能为力。

你有几个选择：

*   覆盖类并更改方法。
*   通过安装程序更改后端模型。

第二个选项与升级最兼容，但不幸的是，目录 URL 重写索引将通过相同的方法重新格式化 URL 密钥。因此，您必须重写 Category 类来更改 formatUrlKey() 方法。

# ssl - SSL EOF 发生违反 python httplib 协议

> ID：13866721
> 
> 赞同：2
> 
> 时间：2012-12-13T19:10:13.897
> 
> 标签：ssl, certificate, httplib, httpserver

目前关于这个主题的问题并没有解决我的问题，谷歌也没有。

相关服务器代码：

```
class ReuseHTTPServer(BaseHTTPServer.HTTPServer):
    def __init__(self, address, handler, queue=None):
        BaseHTTPServer.HTTPServer.__init__(self, address, handler)

        self.address = address
        ssl_socket = ssl.wrap_socket(socket.socket(self.address_family, self.socket_type),
                                     keyfile = KEY_PATH,
                                     certfile = CERTIFICATE_PATH,
                                     server_side = True,
                                     cert_reqs = ssl.CERT_REQUIRED,
                                     ssl_version = ssl.PROTOCOL_TLSv1,
                                     ca_certs = CA_PATH)
        s = self.socket.getsockname()

        print "serving:", s[0], "on port:", s[1]

        self.socket = ssl_socket

        self.server_bind()
        self.server_activate() 
```

客户端代码：

```
conn = https.HTTPSConnection(HOST, port=PORT, key_file=KEY_PATH, cert_file=CERT_PATH)

        conn.putrequest("GET", '/cgi-bin/retrieveRunningInstances')

        conn.endheaders()

        response = conn.getresponse() 
```

尝试与客户端连接得到 SSLError errno 8；EOF 发生违反协议。我已经使用 openssl 验证了证书。我正在拔头发。任何帮助，将不胜感激。

编辑：

错误发生在握手过程中`conn.getresponse()`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T00:23:19.633

我想我想通了。我有同样的问题：

> ```
> SSLError errno 8; EOF occurred in violation of protocol 
> ```

原来我丢失了 cert_file。我指定了一个如下，但没有一个。

```
server = HTTPServer( ('',5005), HttpHandler )
server.socket = ssl.wrap_socket( server.socket, certfile='kencert.pem', server_side=True ) 
```

当我添加 .pem 文件时，它起作用了！

希望这可以帮助！

# prolog - 将小正则表达式转换为 DCG

> ID：13866727
> 
> 赞同：3
> 
> 时间：2012-12-13T19:10:40.650
> 
> 标签：prolog, dcg

我知道 Prolog 程序员通常使用 DCG 而不是正则表达式来匹配字符串中的模式。在 Perl 中，可以写

```
if ( '... accd' =~ /a+b*c{2,4}d$/ ) {
    say "matched";
} 
```

在 Prolog 中如何匹配相同的模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:58:56.557

我已经扩展[了这个](https://stackoverflow.com/a/4767227/874024)答案

```
:- op(100, xf, *).
:- op(100, xf, +).

rexp(C) --> [C].

rexp([T|Ts])   --> rexp(T), rexp(Ts).
rexp([])       --> [].

rexp(eps)      --> [].

rexp(_*)       --> [].
rexp(R*)       --> rexp(R), rexp(R*).

rexp(R+)       --> rexp(R), rexp(R*).

rexp((R1|R2))  --> ( rexp(R1) ; rexp(R2) ).

rexp(range(R,N,M)) -->
    {between(N,M,L),
     length(D,L),
     maplist(copy_term(R),D)
    }, rexp(D). 
```

那么你的正则表达式匹配可能是

```
?-  phrase(rexp([a+, b*, range(c,2,4), d]), [a,c,c,d]),
    writeln(matched). 
```

请注意，通过这种方式我们匹配原子而不是单个字符。

**在假'评论后编辑**，我认为第一个条款应该是

```
rexp(C) --> {atomic(C)}, [C]. 
```

例如避免

```
?- phrase(rexp([a+]), [a+]).
true ; 
```

事实上，在修正之后，我们得到了预期的结果：

```
?- phrase(rexp([a+]), [a+]).
false. 
```

**完成编辑**

模式可以“硬编码”而不是解释正则表达式（更容易）

```
% I prefer the equivalent clause below
% p1 --> "a", p1 ; "a", p2.
p1 --> "a", (p1 ; p2).
p2 --> "b", p2 ; p3.
p3 --> ("cc" ; "ccc" ; "cccc"), "d". 
```

然后

```
?- phrase(p1, "accd").
true 
```

这里我们匹配单个字符（Prolog 中的字符串是字符代码列表）

# javascript - 具有现有多选表单的级联选择

> ID：13866730
> 
> 赞同：0
> 
> 时间：2012-12-13T19:10:44.640
> 
> 标签：javascript, jquery, selection, cascadingdropdown

我正在使用与 JavaScript 结合使用的 PHP 输出表单来创建一个可以下载的复合文件名。

我也实施了这篇文章：

[三个选择框交互产生一个结果 - HTML、JavaScript 或 jQuery](https://stackoverflow.com/questions/13849558/three-select-boxes-interacting-to-yield-one-result-html-javascript-or-jquery)

所以现在我有一个现有的多项选择表：

```
<select id="one">
    <option value="default">Select Product</option>
    <option class="s" value="1">product1</option>
    <option class="q" value="2">product2</option>
    <option class="q" value="3">product3</option>
</select>

<select id="two">
    <option value="default">Select Version</option>
    <option class="l" value="4">product4</option>
    <option class="l" value="5">product5</option>
    <option class="c" value="6">product6</option>
</select>

<select id="three">
    <option value="default">Select OS</option>
    <option class="o" value="7">product7</option>
    <option class="o" value="8">product8</option>
    <option class="o" value="9">product9</option>
</select>

<select id="three">
    <option value="default">Select Architecture</option>
    <option class="a" value="10">product10</option>
    <option class="a" value="11">product11</option>
    <option class="a" value="12">product12</option>
</select> 
```

单击该按钮时，它会连接字符串并创建一个作为下载安装程序的 URL。这可以正常工作，并且在大多数情况下会产生一个有效的文件来下载。

但是有几个选项是无效的。我只是为这篇文章添加了上面的类，因为很明显它们在相应的组中。

现在，这里的问题是，我如何获得这种现有形式的级联影响？我使用的 PHP 和 JavaScript 是：

从 PHP 文件：

```
$output .=  '<div><p class="download-button"><a id="viewer-dl"';
$output .=  ' onclick="download_file(document.getElementById(';
$output .=  "'" . $product_id . "'" . ').value, document.getElementById(';
$output .=  "'" . $version_id . "'" . ').value, document.getElementById(';
$output .=  "'" . $os_id      . "'" . ').value, document.getElementById(';
$output .=  "'" . $arch_id    . "'" . ')"></a></p></div>'; 
```

从 JavaScript 文件：

```
$(function() {
    $("#viewer-dl").click(function() {
        download_viewer( $('#product_id').val(), $('#version_id').val(), 
            $('#os_id').val(), $('#arch_id').val());
    });
});

function download_file(version_id, os_id, arch_id) {

    if (product_id == 'default' && version_id == 'default' && 
        os_id == 'default' && arch_id == 'default') {
        return;
    }

    else if (product_id != 'default') {
        window.location = 'mysite.com/download/Install_' +
            product_id + '_' + version_id + '_' + arch_id + '.exe';
    }
} 
```

What I'm trying to do is when the `s`class is selected, I want the the `l`and `c`classes selected for the next selection, but when the `q`class is selected, I only want the `c`class selected. 操作系统，架构选择我希望所有选择都在那里，因此这些类是相同的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T20:10:03.673

我创建了一个小演示，你可以对 JSFiddle 做什么：http: [//jsfiddle.net/nx6yF/](http://jsfiddle.net/nx6yF/)

基本上我所做的是我隐藏了所有其他选择，但首先，如果第一个选择发生变化，你必须检查选择并显示第二个选择

```
$("#one").change(function() {
        var val = $(this).val();
        if (val != "default") {
            $("#two").show();
        }
}); 
```

您还需要决定在第二次选择中显示哪些选项。也许类不是处理这个最实际的事情，但它可能是这样的：

```
 var is_q = $("#one > option[value="+val+"]").hasClass("q");
 $("#two > option").each(function() {
      if (!$(this).hasClass("c") && $(this).val() != "default") {
          if (is_q) {
              $(this).attr("disabled",true);
          }
          else{
              $(this).attr("disabled",false);
          }
      }
 }); 
```

我在这里使用了禁用选项，但也可以隐藏它们。无论如何，如果选中，禁用/隐藏的选择也应更改为默认值，以使表单在多个选择中正常工作

在此之后，您可以检查是否选择了选择二，然后显示选择三。当然，是某些选择具有默认值，那么应该隐藏下一个选择。

我不确定是否有任何简单的答案，如何创建级联效果 - 它只需要编码即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-18T15:12:04.320

我使用列表而不是选择创建了一个演示：http: [//jsfiddle.net/MQ3u3/5/](http://jsfiddle.net/MQ3u3/5/)

```
<ul id="parents"></ul>
<ul id="children"></ul>
<div id="bucket"></div>

var data = [{
    "id": 1,
        "name": "Item1",
        "children": [{
        "id": 1,
            "name": "child one"
    }, {
        "id": 2,
            "name": "child two"
    }]
}, {
    "id": 2,
        "name": "Item2",
        "children": [{
        "id": 1,
            "name": "child three"
    }, {
        "id": 2,
            "name": "child four"
    }]
}, {
    "id": 3,
        "name": "Item3",
        "children": [{
        "id": 1,
            "name": "child five"
    }, {
        "id": 2,
            "name": "child six"
    }]
}];
$(function () {
    for (var i = 0; i < data.length; i++) {
        createParentItem(i);
    }
    $('li.parent').on('click', function () {
        $('#children li').remove();
        var parentId = $(this).attr('data-id');

        for (var i1 = 0; i1 < data.length; i1++) {
            if (parentId == data[i1].id) {
                for (var i2 = 0; i2 < data[i1].children.length; i2++) {
                    createChildItem(i1, i2);
                }
            }
        }
        $('li.child').off();
        $('li.child').on('click', function () {
            var parentId = $(this).attr('parent-data-id');
            var childId = $(this).attr('child-data-id');
            for (var i1 = 0; i1 < data.length; i1++) {
                if (parentId == data[i1].id) {
                    for (var i2 = 0; i2 < data[i1].children.length; i2++) {

                        if (childId == data[i1].children[i2].id) {
                            addToBucket(i1, i2);
                        }
                    }
                }
            }
        });
    });
});
function createParentItem(index) {
    var li = $('<li>', {
        class: 'parent',
            "data-id": data[index].id,
        text: data[index].name
    });
    $('ul#parents').append(li);
}
function createChildItem(pIndex, cIndex) {
    var li = $('<li>', {
        class: 'child',
            "parent-data-id": data[pIndex].id,
            "child-data-id": data[pIndex].children[cIndex].id,
        text: data[pIndex].children[cIndex].name
    });
    $('ul#children').append(li);
}
function addToBucket(pIndex, cIndex) {
    var child = data[pIndex].children[cIndex];
    var childElm = $('<span>', {
        text: child.name + ' '
    });
    $('#bucket').append(childElm);
} 
```

# haskell - FP 对表达式的操作

> ID：13866731
> 
> 赞同：3
> 
> 时间：2012-12-13T19:10:47.340
> 
> 标签：haskell, functional-programming, common-lisp

我的问题是参考[这篇文章](https://stackoverflow.com/questions/2807629/handling-incremental-data-modeling-changes-in-functional-programming?rq=1)，特别是：

```
data Actions a = Actions {
    actEval :: a,
    actMap  :: (a -> a) -> Actions a } 
```

我对`actMap`函数的递归定义感到困惑，因为它递归地返回对 的引用`Actions`，即递归的基本情况是什么，因为没有为 指定类型`a`？

`Actions`Common Lisp 中如何表示结构？

**编辑：**另外，`Actions`构造函数需要 2 个参数（如原帖中所述）。那么`Actions a`返回的? 是什么`actMap`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:53:44.223

首先不要将类型构造函数与数据构造函数混淆。

```
data Actions a = .. 
```

这`Actions`是一个类型构造函数。它接受一个类型`a`并给出一个类型`Actions a`，而

```
data Actions a = Actions .. 
```

第二个`Actions`是数据构造函数。因此，要构造一个类型的值，`Actions a`您需要使用`Actions`具有两个值的数据构造函数，一个是 type `a`，另一个是 type `(a -> a) -> Actions a`。

的定义`Actions`在类型方面是递归的，这并不意味着您需要有一个基本案例。您可以将上述类型的值构造为

```
construct :: a -> Actions a
construct v = Actions v (\fn -> construct $ fn v) 
```

这是一个有效的构造，因为数据构造函数的第一个值是类型`a`，另一个是上述指定类型的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T08:50:49.323

正如@Satvik 提到的，不要将数据类型与其构造函数混淆。定义可以改为

```
data Actions a = ActionsConstructor {
    actEval :: a,
    actMap  :: (a -> a) -> Actions a } 
```

这更好地区分了这两个概念。

这是一种标准的[递归数据类型](https://en.wikipedia.org/wiki/Recursive_data_type)。这与列表非常相似，例如：

```
data List a = Nil | Cons { head :: a, tail :: List a } 
```

只有在 的情况下`Actions`，结构可能是无限的——你总是可以传递另一个函数来`actMap`获得另一个动作，而一个列表可以`Nil`在某个地方终止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T06:08:04.027

好吧，在 Lisp 中，它可以表示为一个结构：

```
(defstruct act eval map) 
```

为了跟进提到的帖子，您可以像这样使用它：

```
(defun mk-lit (x)
  (make-act :eval x
            :map (lambda (f) (mk-lit (funcall f x)))))

(defun mk-sum (x y)
  (make-act :eval (+ (act-eval x) (act-eval y))
            :map (lambda (f)
                   (mk-sum (funcall (act-map x) f)
                           (funcall (act-map y) f)))))

CL-USER> (mk-sum (mk-lit 1) (mk-lit 2))
#S(ACT :EVAL 3 :MAP #<CLOSURE (LAMBDA # :IN MK-SUM) {100471902B}>)

CL-USER> (funcall (act-map (mk-sum (mk-lit 1) (mk-lit 2)))
                  #'print)
1 
2 
#S(ACT :EVAL 3 :MAP #<CLOSURE (LAMBDA # :IN MK-SUM) {1007E476FB}>) 
```

编辑：但这绝对不是在 Lisp 中处理此类问题的最佳方法 - 有更简单和强大的方法。

# asp.net - 为什么 SQL Server 会为字符串返回双倍的换行符？

> ID：13866738
> 
> 赞同：0
> 
> 时间：2012-12-13T19:11:15.987
> 
> 标签：asp.net, sql-server-2008

我有一个 .NET 4.0 网站，其中登录页面和主页上有一些文本存储在 SQL Server 2008 中。站点中有一个页面可以编辑这两个文本。

当我单击要编辑的链接时，它们会在多行文本框中正常显示。但是，当存储过程从数据库中检索换行符时，所有换行符都会加倍。

```
ALTER PROCEDURE [dbo].[usp_WEB_getSiteConfig]
AS
    SELECT login_text, home_text FROM WEB_Site_Config
    RETURN 
```

文本区域包含：

> RHIOTest 主页文本
> 
> RHIOTest 主页文本第 2 行

在主页上显示：

```
RHIOTest Home Page Text

RHIOTest Home Page Text Line 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T17:09:17.143

罪魁祸首是这样的行：

```
lblLoginMessage.Text = login_text.Replace ("\r\n", "<br />&nbsp;<br />"); 
```

我不明白的是，在没有客户报告问题的情况下，这一直是如何投入生产的……

# html - 为什么边界在父母之外？

> ID：13866740
> 
> 赞同：0
> 
> 时间：2012-12-13T19:11:19.760
> 
> 标签：html, css

这是我的测试用例：

[http://codepen.io/jgclifton/pen/hKynd](http://codepen.io/jgclifton/pen/hKynd)

我希望 .outer 上的边框成为 .inner 内的容器

最终我想要达到的效果是浅灰色的盒子顶部和底部比深灰色的盒子薄10px（所以更薄的浅灰色盒子在深灰色的中间）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:15:36.520

您必须控制外部的溢出属性。比如：`overflow: hidden;`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:12:17.677

我们只需要“玩”一点边距：

**CSS更改：**

```
.outer {
  width: 100%;
  height: 80px;
  background-color: #CCCCCC;
  border-top: 10px solid white;
  margin-top: 10px;
}

.inner {
    width: 960px;
    height: 100px;
    background-color: #999999;
    margin: -10px auto 0;
} 
```

我们将`.outer`div从顶部设置为**10px**，然后将`.inner`div从顶部设置为**-10px**。当然，如果我们改变`.inner/.outer`元素的大小，我们也必须改变它们的边距值。

# cakephp - 如何在 CakePHP 中进行这种路由？

> ID：13866741
> 
> 赞同：0
> 
> 时间：2012-12-13T19:11:21.757
> 
> 标签：cakephp, routing

我有一个这样的链接：

```
www.mydomain.com/users/view/1 
```

但我希望用户去：

```
www.mydomain.com/profile/1 
```

当他们键入/单击第一个链接时。我已经阅读了这个页面，我可以用这个做一些基本的事情，但我仍然无法弄清楚这个：

[http://book.cakephp.org/2.0/en/development/routing.html](http://book.cakephp.org/2.0/en/development/routing.html)

我感谢任何帮助和解释（我使用的是 2.x 版）。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T20:28:22.897

有人告诉我使用它并且它有效：

```
Router::connect(
    '/profile/:id', 
    array('controller' => 'users', 'action' => 'view'), 
    array('id' => '[0-9]+', 'pass' => array('id'))
); 
```

现在`/profile/1`做`/users/view/1`.

# javascript - JavaScript null 检查 - 值为 null，但检查仍然失败？

> ID：13866742
> 
> 赞同：-1
> 
> 时间：2012-12-13T19:11:24.080
> 
> 标签：javascript

```
if (this.meta.addText !== 'null')
{
    console.log("hi");
} 
```

因此，当`this.meta.addText`为 null 时，此检查仍会进入`if`并打印`hi`。

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:12:30.573

`'null'`是一个`string`。

将其更改为`null`.

```
var string1 = null,
    string2 = 'null';

console.log(string1 == string2); // false
console.log(null != 'null'); // true 
```

你可以[在这里](http://jsfiddle.net/QVhcH/)看到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T19:12:40.900

因为它是`null`，而**不是字符串** `'null'`。试试这个：

```
if (this.meta.addText !== null) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T19:13:11.997

您正在测试字符串“null”，而不是值 null。

# c++ - 线程安全的 unique_ptr move

> ID：13866743
> 
> 赞同：5
> 
> 时间：2012-12-13T19:11:31.883
> 
> 标签：c++, c++11, thread-safety, move-semantics, unique-ptr

是否可以使用 c++11 原子操作安全地移动 unique_ptr？

目前我有这样的代码

```
std::unique_ptr<SyncToken> DataManager::borrowSyncToken()
{
    std::unique_lock<std::mutex> syncTokenLock(syncTokenMutex);
    return std::move(syncToken);
} 
```

我想知道是否有一些更优雅的方式，比如简单地声明：

```
std::atomic<std::unique_ptr<SyncToken>> syncToken; 
```

并避免使用互斥锁。或者可能我根本不需要关心这里的锁并且 std::move 已经是原子的？

经过我到目前为止所做的研究，在我看来：

*   std::move 本身不是原子的，需要在周围进行一些同步，否则 2 个线程同时调用我的方法可能最终会得到一些未定义指针的 2 个副本。
*   std::atomic 声明为我编译，但我不知道如何初始化它并采取行动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T20:57:42.137

不，这是不可能的。

`T`您传递给的值`std::atomic`需要可以轻松复制，但事实`std::unique_ptr`并非如此。操作喜欢`std::atomic::load`或`std::atomic::store`按值获取 T 个对象。

将某些东西打包在 a`std::atomic`中也不会使值原子操作。

在原子上下文中使用`std::unique_ptr`时，您必须考虑在管理资源时可能会遇到问题的事实。你永远不知道有多少线程仍然在引用你的数据，这个问题可以通过`std::shared_ptr`使用原子引用计数来解决。（你需要通过函数来​​检查它是否真的是原子的`std::atomic_is_lock_free`。）

在查看您的代码时，我还偶然发现的一件事是`borrowSyncToken`函数的意图。它被称为借用，但是您通过移出 将令牌的所有权传递给调用者，`std::unique_ptr`所有权如何传回以及当 DataManager 当前不拥有令牌时其他线程会得到什么？

# tsql - 在不使用 exec 或 tsql 中的存储过程的情况下重用 from 子句中的查询结果

> ID：13866744
> 
> 赞同：2
> 
> 时间：2012-12-13T19:11:35.597
> 
> 标签：tsql, select

我需要一个 select 语句，它在其 from 子句中运行另一个 select 语句，结果（只有一条记录）是外部选择的表名。

为此，我不能使用存储过程、exec 或 @ 变量。

此外，查询文件必须以“select”开头并且只包含该语句。

我知道有更好的方法来完成最终结果，但是供应商的向导认为查询必须通过嗅探来运行，而不是单个 select 语句。这很令人沮丧，但这就是我们所要做的。

这是我正在尝试做的一个例子：

```
select
  plan.TransactionID,
  plan.PlanName,
  sum(plan.Value) as Rate 
from
  (select 'dbo._Result' + ltrim(str(CalculationID)) from dbo.Calculation where Name = 
    'TPRL Transaction Plan Rates'
  ) Plan 
```

当然，这是行不通的。但是，这也不是：

```
select
  plan.TransactionID,
  plan.PlanName,
  sum(plan.Value) as Rate 
from
  exec(select 'dbo._Result' + ltrim(str(CalculationID)) from dbo.Calculation where Name = 'TPRL Transaction Plan Rates') Plan 
```

尽管如此，这本身确实会将我想要的表拉回结果集中：

```
exec(select 'dbo._Table' + ltrim(str(CalculationID)) from dbo.Calculation where Name = 'TPRL Transaction Plan Rates') 
```

我需要做的就是将结果视为上面的文字（如宏替换），但它不是那样工作的。

tsql 中有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:24:35.560

您的第一个查询应该有效。您可以在 FROM 语句中进行子查询。你得到什么样的错误？

在了解了需求之后，我相信动态SQL是需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:37:13.283

不，这不能仅在非动态 TSQL 中完成。在 TSQL 中，表名*不能*是变量或参数化，只能使用动态 TSQL 完成。

动态 TSQL 只能使用`EXEC('sql command')`或来完成`sp_ExecuteSql(..)`。

**解决此问题的可能方法：** 除非您使用的工具有自己的宏替换，否则要么

1.  让您的客户端首先执行内部 SQL 查询以确定表名，然后基于此创建一个新文件/字符串。或者
2.  当您真正执行上述动态 SQL 命令之一时，使用某种黑客 SQL 注入技巧来欺骗您的设备，使其认为您正在执行 SELECT。

# mysql - MySQL CONCAT IFNULL 如何处理两个以上的值？

> ID：13866746
> 
> 赞同：6
> 
> 时间：2012-12-13T19:11:40.353
> 
> 标签：mysql, concatenation, concat, ifnull

我需要`CONCAT`两个字段，如果它们都存在并在第二个字段周围添加括号。否则我只需要列出第一个字段。

这是简单的版本：

```
SELECT id, CONCAT(name,' (',nickname,')') as name FROM user; 
```

只要名称和昵称都存在，您应该得到如下结果：

```
1 | Adam (Alpha Dog)
2 | Bob (Bobby)
3 | Charles (Charlie) 
```

但是，如果没有昵称，它只会跳过整个内容为`null`. 例如： id `4`、 name `Doug`、nickname`null`给出结果：

```
4 | null 
```

我想看到的是它只列出名字......像这样：

```
4 | Doug 
```

于是我开始看`CONCAT` `IFNULL`。但我很难做到正确。你能帮我吗？

以下是我尝试过的一些示例：

```
SELECT id, CONCAT(IFNULL(name, ' (', nickname, ')', name) as name FROM user;
SELECT id, CONCAT(name, IFNULL(' (', nickname, ')')) as name FROM user; 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-13T19:17:21.390

您可以使用 CONCAT_WS 跳过空字符串：

```
SELECT id, CONCAT_WS(' ', name, concat('(',nickname,')')) as name FROM user; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T19:20:22.423

您可以连接括号和`nickname`，然后使用`IFNULL`来检查该表达式的结果是否为 NULL。

如果为空，则将 NULL 替换为空字符串，然后将该表达式连接到`name`列。

```
SELECT id
     , CONCAT(name,IFNULL(CONCAT(' (',nickname,')'),'')) AS name
  FROM user 
```

注意：IFNULL 函数是以下的简写：

```
IF(expr1 IS NULL,expr2,expr1) 
```

或 ANSI 等效项：

```
CASE WHEN expr1 IS NULL THEN expr2 ELSE expr1 END 
```

还有其他方法也可以。但是它们基本上都需要做同样的事情：检查昵称是否为NULL，然后有条件地包含括号和昵称，或者一个空字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T19:17:07.037

试试这个：

```
SELECT id, concat(name , if(nickname is not null, concat(' (', nickname, ')'), '')) as name FROM user; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-13T19:17:31.423

您可以使用以下`CASE`语句：

```
SELECT id, 
  case 
    when nickname is not null 
    then CONCAT(name,' (',nickname,')')
    else name end as name 
FROM user; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/1c671/3)

或者：

```
SELECT id, 
  concat(name, if(nickname is not null, concat(' (',nickname,')'), '')) as name
FROM user; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/1c671/10)

两者都给出相同的结果：

```
| ID |              NAME |
--------------------------
|  1 |  Adam (Alpha Dog) |
|  2 |       Bob (Bobby) |
|  3 | Charles (Charlie) |
|  4 |              Doug | 
```

# mysql - MySQL - 程序问题

> ID：13866748
> 
> 赞同：1
> 
> 时间：2012-12-13T19:11:49.747
> 
> 标签：mysql, sql, procedure

我有两张桌子：

```
`deal` (`value`, `when`, `AccountTo`, `AccountFrom`, `Name`)

`account` (`AccountNumber`, `Value`) 
```

我设置了一个程序：

```
CREATE PROCEDURE transfer
(IN Value_IN float,
IN When_IN int(4),
IN AccountTo_IN varchar(26),
IN AccountFrom_IN varchar(26),
IN Name_IN varchar(30))
NOT DETERMINISTIC
SQL SECURITY DEFINER
COMMENT ''

INSERT INTO deal
(value, when, AccountTo, AccountFrom, Name)
VALUES (Value_IN, When_IN, AccountTo_IN, AccountFrom_IN, Name_IN);

UPDATE account SET Value=(Value+Value_IN) WHERE AccountNumber=AccountTo_IN;
UPDATE account SET Value=(Value-Value_IN) WHERE AccountNumber=AccountFrom_IN; 
```

数据被放入“交易”但“帐户”表未更新

**编辑：**

感谢您的回答。它是这样工作的：

```
CREATE DEFINER=`root`@`localhost` PROCEDURE `transfer`( 
Value_IN FLOAT,
When_IN DATE,
AccountTo_IN VARCHAR(26),
AccountFrom_IN VARCHAR(26),
Name_IN VARCHAR(30))
BEGIN

    INSERT INTO deal 
    (value, when, AccountTo, AccountFrom, Name)
    VALUES (value_IN, When_IN, AccountTo_IN, AccountFrom_IN, Name_IN);

    UPDATE account SET Value = Value+Value_IN) WHERE AccountNumber = AccountTo_IN;
    UPDATE account SET Value = Value-Value_IN) WHERE AccountNumber = AccountFrom_IN;

END; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-12T21:48:59.167

我认为您在 INSERT 之前和最后一次 UPDATE 之后可能需要一个 BEGIN 和一个 END。许多数据库都是这种情况，SQL/Server、MySQL、Sybase、Oracle 都需要 BEGIN/END。

# casting - 在 IDL 中将 2 个字节转换为一个 16 位整数

> ID：13866753
> 
> 赞同：2
> 
> 时间：2012-12-13T19:12:16.507
> 
> 标签：casting, byte, 16-bit, idl-programming-language

我有一个字节数组（char1），我必须将它们转换为特定的数据类型。例如，数组中的前两个字节需要转换为 ascii 字符，所以我只是使用

```
 c = string(char1[0]) 
```

但是对于 char1[2] 和 char1[3] 我需要一个 16 位无符号整数，那么我将如何组合这两个字节并将它们转换为 uint？我正在寻找一个一般性的答案，因为我需要转换为从 1 字节到 8 字节的类型。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T17:12:04.857

`uint`是使用的例程。尝试：

```
IDL> b = bindgen(2) + 1B
IDL> print, b
   1   2
IDL> ui = uint(b[0:1], 0)   
IDL> print, ui
     513
IDL> print, 2^9 + 2^0
     513 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T21:40:02.107

`i = uint(char1[2] + ishft (char1[5], 8))`不起作用的原因是被移位的变量是字节，当移位 8 时它会溢出。而是在进行移位之前转换为 uint：

```
i = uint(char1[2]) + ishft(uint(char1[3]),8) 
```

# c# - 实体框架 我的数据库去哪儿了？

> ID：13866754
> 
> 赞同：0
> 
> 时间：2012-12-13T19:12:18.857
> 
> 标签：c#, entity-framework

我正在使用 EF 编写示例程序。我在没有首先确保我的 SQL 数据库服务正在运行的情况下运行该程序，并且它运行良好。但是当我发现我的错误时，我认为这意味着没有创建数据库，所以我可以简单地再次运行项目并让它在 SQL Express 的运行实例中创建数据库。但相反，我得到了 invalidOperationError 告诉我

```
**The model backing the 'BreakAwayContext' context has changed since the database was created. Consider using Code First Migrations to update the database (http://go.microsoft.com/fwlink/?LinkId=238269).** 
```

我可以通过应用来解决这个错误

```
Database.SetInitializer(
new DropCreateDatabaseIfModelChanges<BreakAwayContext>()); 
```

但我仍然找不到我的数据库。

在配置文件中，对于 defaultConnectionFactory，设置为

```
<defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="v11.0" />
      </parameters>
    </defaultConnectionFactory> 
```

所以，我希望在机器上安装的 SQL 2012 实例上创建数据库，但我找不到数据库。

请问如何重新设置我的项目以便创建一个新的数据库？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:53:16.503

也许您的数据库是作为用户实例创建的？在这种情况下，您不会在使用 Management Studio 的 SQLEXPRESS 默认实例中看到它。您可以在您的连接字符串中检查它。有一个用户实例参数。如果它设置为 true，那么您应该能够在您的应用程序目录中的某个位置找到 .mdf 文件。

# position - 灯箱 - 如何将图像计数移动到图像顶部

> ID：13866755
> 
> 赞同：1
> 
> 时间：2012-12-13T19:12:20.267
> 
> 标签：position, lightbox

我正在使用 Lightbox 为我的网站创建图库，并且我想将图像计数器和关闭图像移动到我的图像顶部，但将标题保留在底部。帮助！我在网上搜索过，我发现的最接近的是在这里解释如何通过交换外部容器和数据容器将图像计数器、标题和关闭按钮移动到顶部，但我只想移动计数器并关闭。

谢谢

# scala - 为什么 scala 编译器说这种类型用于非专用位置？

> ID：13866758
> 
> 赞同：3
> 
> 时间：2012-12-13T19:12:31.413
> 
> 标签：scala, generics, compiler-construction, compiler-warnings, jvm-languages

我在`package`对象中有这个方法：

```
def extractLoop[@specialized T](x: Map[T, T]) = {
    val whatever = x.head
    val stop = whatever._1
    def iteration(
            acc: Seq[T] = Seq(whatever._1, whatever._2),
            last: T = whatever._2): Seq[T] = {
        val next = x(last)
        if (next == stop) acc
        else iteration(acc :+ next, next)
    }
    iteration()
} 
```

但我还不明白，为什么编译器（我有 2.9.2 版）说`type T is unused or used in non-specializable positions.`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T19:33:11.870

我相信原因很简单，因为您使用的`Map[T, T]`是不专业的。

一些插图：

```
scala> class MyMap[A,B]
defined class MyMap
scala> def extractLoop[@specialized T](x: MyMap[T, T]) = {
     |   sys.error("TODO")
     | }
<console>:8: warning: type T is unused or used in non-specializable positions.
       def extractLoop[@specialized T](x: MyMap[T, T]) = {
           ^
extractLoop: [T](x: MyMap[T,T])Nothing 
```

但是如果你专门`MyMap`研究它的两个类型参数，你就没有警告：

```
scala> class MyMap[@specialized A,@specialized B]
defined class MyMap
scala> def extractLoop[@specialized T](x: MyMap[T, T]) = {
     |   sys.error("TODO")
     | }
extractLoop: [T](x: MyMap[T,T])Nothing 
```

# android - 仅通过 wifi 获取 Android 位置不起作用

> ID：13866764
> 
> 赞同：4
> 
> 时间：2012-12-13T19:13:04.973
> 
> 标签：android, gps, location

这种症状经常被提及，但我没有发现另一个相同标准的问题，所以这里......

当设备有服务时，我正在制作一个成功使用 GPS 的应用程序。我有一个带有 2.3.4 版本 Android 的测试设备。它没有 SIM，因此不需要 GPS。但是它可以通过谷歌地图中的 Wifi 获取位置。但是，我的应用无法在此设备上获取位置。在具有服务的设备上，我可以通过将设备置于飞行模式然后重新启用 Wifi 来获得相同的行为。

在我的应用程序中，我有一个实现 LocationListener 的 gps 跟踪类。

在应用程序启动时，运行以下代码：

```
public Location getLocation() {
    try {
        locationManager = (LocationManager) mContext
                .getSystemService(LOCATION_SERVICE);

        // getting GPS status
        isGPSEnabled = locationManager
                .isProviderEnabled(LocationManager.GPS_PROVIDER);

        // getting network status
        isNetworkEnabled = locationManager
                .isProviderEnabled(LocationManager.NETWORK_PROVIDER);

        if (!isGPSEnabled && !isNetworkEnabled) {
            // no network provider is enabled
        } else {
            this.canGetLocation = true;
            // First get location from Network Provider
            if (isNetworkEnabled) {
                Log.d(LOG_TAG, "Requesting updates");
                //TODO once tested, up the time below
                locationManager.requestLocationUpdates(
                        LocationManager.NETWORK_PROVIDER,
                        MIN_TIME_BW_UPDATES,
                        MIN_DISTANCE_CHANGE_FOR_UPDATES, this);
                Log.d("Network", "Network");
                if (locationManager != null) {
                    location = locationManager
                            .getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
                    // *** location is null here ***
                    if (location != null) {
                        latitude = location.getLatitude();
                        longitude = location.getLongitude();
                    }
                }
            }
            // if GPS Enabled get lat/long using GPS Services
            if (isGPSEnabled) {
                if (location == null) {
                    locationManager.requestLocationUpdates(
                            LocationManager.GPS_PROVIDER,
                            MIN_TIME_BW_UPDATES,
                            MIN_DISTANCE_CHANGE_FOR_UPDATES, this);
                    Log.d("GPS Enabled", "GPS Enabled");
                    if (locationManager != null) {
                        location = locationManager
                                .getLastKnownLocation(LocationManager.GPS_PROVIDER);
                        if (location != null) {
                            latitude = location.getLatitude();
                            longitude = location.getLongitude();
                        }
                    }
                }
            }
        }

    } catch (Exception e) {
        e.printStackTrace();
    }

    return location;
} 
```

请参阅评论“此处的位置为空”。几分钟后启动和后续调用就是这种情况。

这些接口函数都没有被调用过： onLocationChanged onProviderEnabled onProviderDisabled onStatusChanged

我有什么基本的东西吗？至少在稍等片刻之后，似乎应该可以到达位置。而且，如前所述，谷歌地图在两种设备上都在仅 wifi 模式下工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T21:58:47.110

事实证明，获取位置的时间比预期的要长得多。我想大约2分钟。

# sql - 将具有多种日期格式的字符列转换为日期

> ID：13866765
> 
> 赞同：0
> 
> 时间：2012-12-13T19:13:09.917
> 
> 标签：sql, oracle, date, oracle10g

我正在尝试使用 varchar 列更新日期列

```
update tbl set columnA = columnB 
```

这里，`columnA`是 varchar 数据类型，`columnB`是日期数据类型。`columnA`具有多种日期格式，例如 09302012、9/30/2012、2012-09-30 和更多不同类型

如何编写单个查询以在单个查询中使用各种类型的日期格式更新列。

编辑:::

抱歉搞砸了..我刚刚意识到这些是 ssis 包中的个别（部分）更新......

我们有不同的品牌类型（6），并且对于每个品牌，他们发送具有不同日期格式的不同文件

类型 1 包含日期格式，如 09/22/2011 9/22/2011 和 2012-09-22

其余所有类型都遵循相同的格式..它的 09222012

所以现在我需要为个别类型编写查询......（直接说只有两个逻辑，一个用于类型 1，另一个用于其余所有类型）

第一个查询逻辑包含三种格式的 case 语句，第二个查询逻辑包含其他格式的逻辑...

最终结果应该显示为 2012-09-22 00:00:00（即 yyyy-dd-mm hh:mm:ss）你能帮我吗

我是一个 T-sql 人，不知道 pl-sql 的任何内容（如果它在 t-sql 中，我会直接使用转换和子字符串）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:21:22.483

You don't.

Firstly you do it properly next time and store dates in a DATE data type; if this is supplied data then you yell¹ at your suppliers.

The simplest way to clean your data would be to create a function that tests if a date is in a certain format:

```
create or replace function is_date ( 
      P_String in varchar2
    , P_Date_Format in varchar2
      ) return number is

   l_date date;

begin

   l_date := to_date(P_String, P_Date_Format);

   return 1;
exception when others then
   return 0;
end; 
```

Next you pick a [format model](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements004.htm#i34924) and update just that one.

```
update my_table
   set date_column = to_date(char_column, 'yyyy-mm-dd')
 where is_date(char_column, 'yyyy-mm-dd') = 1 
```

You then have to pick a different format model and do it all over again until you don't have any records in your date column that are NULL.

[1\. Yelling may be a bit much, but make sure you're heard.]

* * *

This could be distilled into a single query with a large CASE statement:

```
update my_table
   set date_column = case when is_date(char_column, 'yyyy-mm-dd') = 1
                               then to_date(char_column, 'yyyy-mm-dd')
                          when is_date(char_column, 'yyyymmdd') = 1
                               then to_date(char_column, 'yyyymmdd')
                          ...
                          snip
                          ...
                     end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:24:04.530

如果我遇到这样的问题，那么我的第一个问题是如何以编程方式检测每行的日期格式 columnA 是什么。假设它在合理的 LOE 内是可行的（我不知道您的日期格式的完整范围），然后我会看看如何使用 CASE 表达式来检测格式，然后为每种情况相应地格式化日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-07T23:15:31.770

如果我理解您的问题，我认为您应该能够在一个声明中更新您的表格。这不是最优雅的解决方案，但以下应该可行。

```
UPDATE tbl
   SET columnA = DECODE(type, '1', DECODE(INSTR(columnB, '-'), 5, TO_DATE(columnB, 'YYYY-MM-DD'),
                                                                  TO_DATE(columnB, 'MM/DD/YYYY')),
                                   TO_DATE(columnB, 'MMDDYYYY')); 
```

在上面的语句中，我假设您有一个名为**type**的列，指示 B 列所在的日期格式。上面的语句使用 DECODE 来确定类型是否为 1。由于类型 1 有 3 种可能的格式，该语句将然后尝试确定 columnB 的格式。为了使我们的工作更容易，我们只需要测试 YYYY-MM-DD 格式，因为我们可以将 MM/DD/YYYY 格式与 09/22/2011 和 9/22 一起使用/2011。所以我们使用 INSTR 函数来确定第一个 '-' 字符的位置。如果该位置是 5，那么我们知道该列是**YYYY-MM-DD**格式并且可以使用适当的日期掩码。如果位置不是 5，那么我们知道 columnB 在**MM/DD/YYYY**格式。最后，如果类型不是 1，那么我们知道日期掩码应该是**MMDDYYYY**。

# android - 输入类型“时间”在 Nexus-One 上没有“：”我该怎么办？

> ID：13866768
> 
> 赞同：0
> 
> 时间：2012-12-13T19:13:21.140
> 
> 标签：android

我有这个声明的布局

```
android:inputType="time" 
```

我需要输入时间，例如 5:00 以将倒计时计时器显示为 5 分钟或 12:30:15 以显示开始时间小时、分钟、秒。

我不是特别喜欢让用户输入“：”，但我看不到固定格式的方法，所以我决定接受它。但它不适用于我所有的测试手机。

它适用于我的三星平板电脑和我的 Nexus-4，但不适用于我的 Nexus-One。我希望能够支持尽可能多的平台。

有什么想法我能做什么？我考虑过使用数字选择器，但它需要 API 11，而 2.3.5 是 API 10。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:23:15.807

如果您制作三个 EditTexts 和 2 个 TextViews 并像这样排列它们并设置它们以使光标从一个移动到另一个会怎样。

![一些编辑文本](../Images/c2ce1c047d284aa057c7b0fdde84acd3.png)

这会使用更多视图，但作为回报，您会得到一些东西。用户更难输入错误的内容。它以一种不关心它在什么设备上运行（或 API lvl）的方式解决了您的冒号问题。当您从 EditTexts 中提取值时，您只需手动将冒号插入到字符串中。

我知道我已经填写了包含多个像这样彼此靠近的框的表格，所以我认为这不会让您的用户感到困惑。

**编辑：**您应该能够`android:imeOptions`在您的 xml 或`setImeOptions(int)` java 中使用来指定您想要下一个按钮

# c# - 无法访问列表中的第二项

> ID：13866769
> 
> 赞同：1
> 
> 时间：2012-12-13T19:13:21.823
> 
> 标签：c#, list, class

我无法访问列表中的第二项，我不明白为什么会有任何帮助。

```
class Datapoints
    {
        List<Datapoint> datapoints;                                         //Creates a list of datapoints from Datapoint
        private string fileName;
        public string Filename { get { return fileName; } }

        public Datapoint GetDatapoint(int i)                                //Creates an instance of a Datapoint called GetDatapoint                        
        {
            if (i < datapoints.Count)
                return datapoints[i];
            else
                return null;
        }

        public Datapoints(string fName)                                     //Method that creates a new list of datapoints with the objects of Datapoint within it
        {
            this.fileName = fName;
            datapoints = new List<Datapoint>();
            TextReader tr = new StreamReader(fileName);
            string input;
            while ((input = tr.ReadLine()) != null)
            {
                string[] bits = input.Split(',');
                Datapoint a = new Datapoint(bits[0], bits[1], bits[2]);
                datapoints.Add(a);
            }
            tr.Close();

        } 
```

这是表格，我想要做的是让框在按下下一个按钮时显示文件中的三个数字。

```
private void InitTextBoxes()
        {
            if (myDatapoints.Count > 0)
            {
                Datapoint a = myDatapoints.getItem(0);
                textBoxLatitude.Text = a.Latitude;
                textBoxLongtitude.Text = a.Longtitude;
                textBoxElevation.Text = a.Elevation;
                buttonNext.Enabled = true;
                buttonPrevious.Enabled = true;
            }
            count = 0;
            textBoxLatitude.Enabled = false;
            textBoxLongtitude.Enabled = false;
            textBoxElevation.Enabled = false;
            buttonDone.Visible = false;
            buttonDone.Enabled = false;
            addingData = false;
            saved = true;
            openToolStripMenuItem.Enabled = false;
        }

        private void openToolStripMenuItem1_Click(object sender, EventArgs e)
        {

            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "Csv Files (*.csv)|*.csv|Text files (*.txt)|*.txt|All files (*.*)|*.*";
            if (ofd.ShowDialog(this).Equals(DialogResult.OK))
            {
                myDatapoints = new Datapoints(ofd.FileName);
                this.Text = "Data Entry - " + ofd.SafeFileName;
                InitTextBoxes();
                if (myDatapoints.Count > 0)
                {
                    buttonNext.Enabled = true;
                    buttonPrevious.Enabled = true;
                    closeToolStripMenuItem.Enabled = true;
                    saveAsToolStripMenuItem.Enabled = true;
                }
            }

        }

        private void buttonNext_Click(object sender, EventArgs e)
        {

                count++;
                if (count == myDatapoints.Count)
                    count = 0;

            Datapoint a = myDatapoints.getItem(count);
            textBoxLatitude.Text = a.Latitude;
            textBoxLongtitude.Text = a.Longtitude;
            textBoxElevation.Text = a.Elevation;

            textBoxTest.Text = Convert.ToString(myDatapoints.Count);

        }

        private void buttonPrevious_Click(object sender, EventArgs e)
        {

        } 
```

此外，当我启动这些框时，我无法将 datapoints.GetItem 更改为除 (0) 之外的任何内容，就好像我这样做了，下一行中有错误我相信这是问题的核心，但我不明白为什么。错误是

> 你调用的对象是空的。

在我用来测试的文件中，有 9 个数字（1、2、3、4、5、6、7、8、9），所以当我选择 1 时，它应该取中间三个，但它没有！

```
 internal Datapoint getItem(int p)
        {
            if (p < datapoints.Count)
            {
                return datapoints[p];
            }
            else
                return null;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:27:28.327

在 datapoints 构造函数中，您只存储前三个（如果您的文件仅包含一行）

要么将文件格式更改为每行只有 3 个数字，例如：
1,2,3
4,5,6
7,8,9

或更改逻辑以存储单行中的所有值，例如：

```
 while ((input = tr.ReadLine()) != null)
        {
            string[] bits = input.Split(',');
            if (bits.Length % 3 != 0)
            {
               //error bad file 
            }
            else
            {
               int count = bits.Length / 3;
               int i = 0;
               while (count > 0)
               {
                   Datapoint a = new Datapoint(bits[i], bits[i+1], bits[i+2]);
                   datapoints.Add(a);
                   i += 3;
                   count--;
               }
             }
        } 
```

# python - 运行 Python 时出现 AttributeError

> ID：13866772
> 
> 赞同：2
> 
> 时间：2012-12-13T19:13:32.900
> 
> 标签：python

运行进行函数调用的程序时

```
self.getFileButton = Button(self,
                            text = "...",
                            command =
                            tkFileDialog.askopenfilename(mode="r+b", **self.file_opt)) 
```

我得到错误

```
File "C:/Documents and Settings/l/My Documents/Python/csv_GUI.py", line 33, in create_widgets
tkFileDialog.askopenfilename(mode="r+b", **self.file_opt)) 
```

AttributeError：selectFile 实例没有属性“file_opt”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T19:19:04.203

你可能想要这样的东西：

```
self.getFileButton = Button(self,
                            text = "...",
                            command = lambda: tkFileDialog.askopenfilename(mode="r+b", **self.file_opt)) 
```

问题在于，当您编写它时，该`askopenfilename`函数会在创建按钮时运行（而不是在单击时）。根据 AttributeError，您在创建`file_opt`映射之前创建按钮，但是，假设`file_opt`您单击按钮时属性存在，这应该将查找（和函数调用）推迟到适当的时间。

基本上，`lambda`只需创建一个新函数：

```
foo = lambda x : x*x 
```

相当于*：

```
 def foo(x):
     return x*x 
```

以这种方式编写，很容易理解为什么我们推迟调用`askopenfilename`函数，直到按钮实际被点击。

*在某些情况下，lambda 函数的行为与常规函数不同，但出于本文的目的，我们不必担心这些。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T19:45:25.640

您实际上是否在您的方法或其他地方`file_opt`定义了一个成员？`__init__`

如果问题是你正在定义一个，但直到你完成之后`getFileButton`，你可以重新排列顺序吗？如果不是，mgilson 的解决方案是正确的。但除此之外，它要简单得多。

如果你在任何地方都没有`file_opt`成员，那就更简单了：不要试图传递不存在的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T19:40:22.573

我认为，一般来说，您应该避免在 Button 函数本身（使用 lambdas）中将参数传递给回调函数，这很丑陋，而且不是 pythonic。

改为执行以下操作：

```
def __init__(self, ...):
    ...
    Tkinter.Button(self, text='...', command=self.openfile).pack(...)
    ...

def openfile(self):
    return tkFileDialog.askopenfile(mode='r+b', **self.file_opt) 
```

只是为了给出这个想法......

# android - 获取数据按照 SQLite 中的度量单位按降序排序

> ID：13866773
> 
> 赞同：0
> 
> 时间：2012-12-13T19:13:35.750
> 
> 标签：android, sorting, android-sqlite

我有一个包含这些列的表

```
|Name|Quantity|Unit 
```

我想根据测量单位按降序排列数据，例如：

```
|Bread|1.2|Kg
|Pasta|600.21|g
|Flour|200.18|g
|Salt|70.12|mg
|Pepper|60.3|mg
|Venom|700.15|mcg 
```

*1.2*小于*600.21*但单位为*Kg*，因此按照比例*Kg > g > mg >mcg*等顺序优先级在前（假设表格不包含 6000g，因为符号为 6Kg）

这段代码显然不起作用

```
 public Cursor allDataSorted() {
        try {
            Cursor c = mDb.rawQuery(
                    "SELECT * FROM myTable order by Quantity desc", null);
            if (c != null) {
                c.moveToNext();
            }
            return c;
        } catch (SQLException mSQLException) {
            Log.e(TAG, "allDataSorted>>" + mSQLException.toString());
            throw mSQLException;
        }

    }

    } 
```

我表中的所有数据都是文本字符串，例如*956在**99*之后错误地显示，所以我不知道如何解决这个问题，结果完全没有排序。

有什么建议吗？

注意

我无法转换和重新转换表格，这些表格太大了，而且适配器用于太多种类的单位，只能使用一般的基本单位。

**编辑**

按照 Ryan Griggs 的建议，我在同一个数据库文件中包含*了 mapperTb表*

```
Unit|Multipler
hg|100
g|1
dg|0.1
cg|0.01
mg|0.001
mcg|0.000001 
```

我已经以这种方式编辑了 allDataSorted() 方法：

```
 public Cursor allDataSorted() {
        try {
            Cursor c = mDb.rawQuery("SELECT *, (CAST(myTable.Quantity as FLOAT) * mapperTb.Multipler) as Quantity FROM myTable INNER JOIN mapperTb ON myTable.Unit = mapperTb.Unit ORDER BY Quantity desc", null);
            if (c != null) {
                c.moveToNext();
            }
            return c;
        } catch (SQLException mSQLException) {
            Log.e(TAG, "allDataSorted>>" + mSQLException.toString());
            throw mSQLException;
        }

    }

    } 
```

但不起作用并且光标结果为空

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:16:05.397

我建议在您的排序例程中，将所有值转换为基本单位（即克）。然后你就可以正确排序了。您可以创建另一个表，将每个单位映射到适当的乘数（即 Kg = 1000，g = 1），然后计算每个条目的基本单位，并按该值排序。那么你就不用担心6000g vs 6Kg之类的事情了。

示例：使用字段“unit”和“multiplier”创建映射表“unit_map”。添加所有适用的单位和乘数。所以新的查询变成：

```
SELECT *, (CAST(myTable.Quantity as FLOAT) * unit_map.multiplier) as sort_field FROM myTable INNER JOIN unit_map ON myTable.Unit = unit_map.unit ORDER BY sort_field 
```

# javascript - 找到运行 JavaScript 的标签

> ID：13866774
> 
> 赞同：13
> 
> 时间：2012-12-13T19:13:41.790
> 
> 标签：javascript, html

在后端生成 HTML 源代码，我使用单独的独立小部件。

我只是在生成的 HTML 输出中包含这样的标记。

```
 <div>
     I want to work with this DOM element
     <script>
          new Obj(/*but I can't get this <div> as a parameter! */);
     </script>
 </div> 
```

我正在寻找一种方法来查找在其中`obj`创建的 DOM 元素（没有任何唯一 ID）。这将为我的应用程序增加灵活性并加快开发速度。但是在 JavaScript 中这在技术上是可能的吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-13T19:17:41.207

您可以在其中播种一个元素，然后获取它的父元素，然后删除该元素。

```
<div>
 I want to work with this DOM element
 <script>
      document.write("<div id='UniqueGUID_3477zZ7786_' style='display:none;'></div>");
      var thatDivYouWanted;
      (function(){
       var target = document.getElementById("UniqueGUID_3477zZ7786_");
       thatDivYouWanted = target.parentNode;
       target.parentNode.removeChild(target);
      })();
      new Obj(/*but I can't get this <div> as a parameter! */);
 </script>
</div> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-13T19:21:19.753

The following code works:

```
<script>
  function Obj(color) {
    var scriptTags = document.getElementsByTagName("script");
    var scriptTag = scriptTags[scriptTags.length - 1];
    // find parent or do whatsoever
    var divTag = scriptTag.parentNode;
    divTag.style.backgroundColor = color;
  }
</script>

<div>
  I want to work with this DOM element
  <script>new Obj("green");</script>
</div>
<div>
  I want to work with this DOM element
  <script>new Obj("yellow");</script>
</div>
<div>
  I want to work with this DOM element
  <script>new Obj("lime");</script>
</div>
```

This method has very simple code and has almost zero impact on performance.

Note: I am pretty sure this won't work IE6 (as far as I remember it does not support manipulating open tags).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T19:23:36.097

我相信你的方法并不理想。如果您尝试获取`<div>`，则应使用 JavaScript 和 API 以常规方式以编程方式完成，这些 API 使您能够查询目标`<div>`

您可以以受控方式（DOM Ready 然后 Query 然后 Your Method）在单独的范围内执行，而不是内联执行。您可以使用 ID、CSS 类名或 JavaScript 中的任何其他 CSS 选择器来定位您的 div。

这使您几乎可以在任何您想要的地方执行以下操作，**而不是 inline**。

```
// on dom ready...
var div = document.getElementById('myDiv'), // replace with any other selector method
    myObject = new Object(div); 
```

需要找到你的 div 吗？[https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T19:20:24.687

If you know beforehand how the page will be structured, you could use for example:

```
document.getElementsByTagName("div")[4] 
```

to access the 5th div.

# vbscript - vbscript 读取文本文件并提取数据

> ID：13866775
> 
> 赞同：0
> 
> 时间：2012-12-13T19:13:47.253
> 
> 标签：vbscript

我需要脚本来提取所有**html**文件中的数量**`note-ref_`**和**`#ref_`**存在

 **我的文件夹结构将是

**D:\Count_Test**

其中许多文件夹和子文件夹将包含，并且在每个子文件夹中将有一个 ref.html，text.html 文件将包含**`note-ref_`**和**`#ref_`**文本（除了这些文件，还有一些其他文件，例如 xml、txt 和 imges 以及 css 子-文件夹将包含）

我需要为每个文件计算出现次数**`note-ref_`**和**`#ref_`**出现次数，结果需要在 .csv 文件中捕获

任何人都可以通过提供将文本提取到 csv 文件中的解决方案来帮助我吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:39:49.973

建议：

使用 Scripting.FileSystemObject (FSO) 遍历文件和子文件夹以确定您的操作范围。或者，您可以捕获 DIR /s /b D:\Count_Test*.html 的输出。

一旦您知道需要打开的文件列表，您应该使用 FSO 的 OpenTextFile 函数读取每个文件并遍历每一行。当你找到你要找的东西时，增加某种计数器——也许在一个数组中。

最后，一旦您完成了数据收集，您可以通过再次执行 OpenTextFile 来输出结果，但这一次打开您的 CSV 文件位置并以适当的格式写入您收集的数据。**

# wix - 如何将功能状态写入注册表项

> ID：13866786
> 
> 赞同：1
> 
> 时间：2012-12-13T19:15:17.907
> 
> 标签：wix, wix3.5, wix3.6

如果在安装过程中安装了某个功能，那么写入 reg 密钥的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T17:59:34.513

您应该使用指定条件的组件。条件可能会引用功能状态（当前或请求 - 有关更多详细信息，请参阅[此链接](http://msdn.microsoft.com/en-us/library/aa368012%28VS.85%29.aspx)）。我使用“&”符号 - 它被请求（应通过安装实现）功能状态。

```
<Component Id="MyComponentSpecificReg" Guid="YOURGUID">
    <Condition>&MyFeatureId = 3</Condition> <!--install this component only of feature requested state is LOCAL (You may need other condition - please read the link I posted above)-->
    <RegistryKey Root="YOUR REG ROOT" Key="YOUR REGISTRY PATH" Action="create">
        <RegistryValue Name="YourKeyName" Type="string" Value="[YOUR_PROPERTY]"/>
    </RegistryKey>
</Component> 
```

# maven - 如果目标存在，如何阻止 Maven 覆盖

> ID：13866801
> 
> 赞同：2
> 
> 时间：2012-12-13T19:15:54.040
> 
> 标签：maven, maven-dependency-plugin, maven-resources-plugin

我在依赖项中有一个目录，我想在初始化阶段将其复制到 src/main/webapp/mypath 中。但我希望它被准确地复制一次，这意味着：

*   如果 src/main/webapp/mypath 不存在，则从依赖项中复制
*   如果 src/main/webapp/mypath 存在，则永远不要从依赖项中复制，即使依赖项中的一个更新。如果存在，请不要覆盖它。绝不。

我尝试了几种使用 copy-resources 和 dependency:unpack 的方法，但如果来自依赖项的 mypath 更新/更新，即使我将所有可能的覆盖*配置设置为 false， maven 也会**始终覆盖。**

有什么建议或 RTFM + 指向我目前尚未阅读的手册的链接吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T21:40:24.137

您可以使用[配置文件](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)：

```
<profiles>
  <profile>
    <activation>
      <file>
        <missing>src/main/webapp/mypath</missing>
      </file>
    </activation>
    ... copy ...
  </profile>
</profiles> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-25T14:19:31.530

正如@William 所述，您可以使用 ant 插件，将属性导出到 maven 上下文并在“true”时跳过任务。

这是代码：

```
<plugin>
    <artifactId>maven-antrun-plugin</artifactId>
    <version>1.7</version>
    <executions>
        <execution>
            <phase>validate</phase>
            <goals>
                <goal>run</goal>
            </goals>
            <configuration>
                <exportAntProperties>true</exportAntProperties>
                <target>
                    <available file="src/main/resources/my-data" type="dir"
                                                   property="dir-exits"/>
                </target>
            </configuration>
        </execution>
    </executions>
</plugin>
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-dependency-plugin</artifactId>
    <executions>
        <execution>
            <id>copy-zip-dependencies</id>
            <goals>
                <goal>unpack</goal>
            </goals>
            <configuration>
                <skip>${dir-exists}</skip>
                <artifactItems>
                    <artifactItem>
                        <groupId>com.mygroup</groupId>
                        <artifactId>myartifactid</artifactId>
                        <includes>**/*.json</includes>                                                       <outputDirectory>src/main/resources/</outputDirectory>
                    </artifactItem>
                </artifactItems>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

# android - 对话框和敬酒未从 asynTask 显示

> ID：13866802
> 
> 赞同：-1
> 
> 时间：2012-12-13T19:15:58.910
> 
> 标签：android, android-asynctask, android-dialog

下面是我创建的一个异步类，我试图在执行时实现一个对话框，并在完成时实现一个 Toast。

怎么从来没有吐司或对话出现过。

**我的 asykTask：**

```
public class EmailPictureService extends HTTPRequestAsyncTask {
    Context context;
    ProgressDialog dialog;
    public EmailPictureService(Context context){
        this.context = context;
        //dialog = new ProgressDialog(context);
    }
    @Override
    protected void onPreExecute() {

        super.onPreExecute();
    }   

    @Override
    protected String doInBackground(Object... params) {
        Log.v("Start EMAIL SERVICE","START YOPPPPPPPPPPPPPPPPPPPPPP!");
        dialog = new ProgressDialog(context);
        dialog.setMessage("Sending...");
        dialog.setIndeterminate(true);
        dialog.show();
        HTTPInvoker invoker = new HTTPInvoker();
        HttpResponse response = null;

        EmailPicture emailPicture = new EmailPicture();
        emailPicture.setDeviceType("TABLET");
        emailPicture.setStoreId((String)params[1]);
        emailPicture.setNotificationType("E");
        emailPicture.setRecipientName((String)params[2]);
        emailPicture.setRecipientEmail((String)params[3]);

        String jsonString = JSONConverter.toJson(emailPicture);
        response = invoker.invokePOSTFileService((String)params[0], jsonString, (File[])params[4]);
        return parseHttpResponse(response);
    }

    @Override
    protected void onPostExecute(String result) {
        String msg = "";
        if (dialog.isShowing()) {
            dialog.dismiss();
        }
        if (result != null) {
            JSONObject jsonObject = null;
            long errorCode = 0;
            try {
                jsonObject = new JSONObject((String) result);
                errorCode = jsonObject.getLong("errorCode");
                if(errorCode<1){
                    msg ="Success, your picture has been sent";
                }else{
                    msg = "Sorry, there was an error sending your picture. Please try again later.";
                }
                Log.i(Constants.TAG, "Error Code...." + errorCode);
                Toast toast = Toast.makeText(context, msg, Toast.LENGTH_SHORT);
                toast.show();

            } catch (JSONException e1) {
                Log.i(Constants.TAG, "Exception...." + e1);
                Toast toast = Toast.makeText(context, "Failure: "+e1, Toast.LENGTH_SHORT);
                toast.show();
                e1.printStackTrace();
            }
        }

    }

} 
```

**我如何从我的活动中调用它：**

```
new EmailPictureService(this).execute(url,storeID,cusName, cusEmail, new File[]{file}); 
```

**我的日志** ![在此处输入图像描述](../Images/47806971b285fe2243892556ed3466b7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:22:26.587

您不应尝试从`doInBackground()`. AsyncTasks 的目的`doInBackground()`是避免陷入 UI 线程......相反，您应该以适当的方法执行 UI 工作：`onPreExecute()`、、、`onProgressUpdate()`等`onPostExecute()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T21:53:49.617

我怀疑吐司没有显示，因为您的结果始终为空。您的日志在帖子中显示错误

正如其他人所说，从 onPreExecute() 开始您的进度对话框

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:32:28.487

我注意到您在 doInBackground() 中实例化了您的 progressDialog。将其移至 onPreExecute() 。doInBackground() 只应该做非 UI 工作。=)

这应该“解决”您的问题。

# css - 位置：固定内部显示：表格错误

> ID：13866806
> 
> 赞同：2
> 
> 时间：2012-12-13T19:16:05.880
> 
> 标签：css

我遇到了一个非常令人沮丧的问题。我正在努力创建一个位于`<ul>`. 当嵌套`<div>`在表格中`display: {fixed,absolute}`时，空格占位符会显示在另一个表格单元格的位置。我不明白为什么或如何绕过它。

代码的 CodePen 在这里：[http](http://codepen.io/quicksnap/pen/gsHrb) ://codepen.io/quicksnap/pen/gsHrb你可以切换最顶层的类来看看我在说什么。

了解有关为什么或如何保留此标记结构并使其显示固定/绝对而不更改父表显示的任何见解。

标记：

```
<ul>
  <li>
    <a href=""><span>Lorem</span></a>
  </li>
  <li>
    <a href=""><span>Lorem</span></a>
  </li>
  <li>
    <a href=""><span>Lorem</span></a>
  </li>
  <li>
    <a href=""><span>Lorem</span></a>
  </li>
  <div class="fixed"/>
</ul> 
```

CSS：

```
/*
 Why does the display: table show an empty placeholder for
 an element inside that is position: fixed/absolute?
*/

/* Comment out/remove !important to see bug */
.fixed { display: none !important; }

.fixed { 
  display: block;
  position: fixed; top: 60px; left: 0;
  width: 100%; height: 100px;
  background: salmon;
}

ul {
  padding: 0;
  margin: 0;
  width: 100%;
  height: 60px;
  display: table;
  table-layout: fixed;
  position: relative;
  background: #ccc;
}

ul > li {
  display: table-cell;
  text-align: center;
  vertical-align: middle;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T20:03:26.023

我真的不知道这是一个错误还是预期的行为（我没有研究过），因为它似乎在正常`table`元素上做同样的事情。但是，它显然与`table-layout: fixed`正在设置的属性有关。我猜这是因为`table-layout: fixed`它根据列数计算它的大小，并且它似乎在页面渲染时将其计算为“[列元素](http://www.w3.org/TR/CSS2/tables.html#fixed-table-layout)”，显然甚至在认识到css`position: fixed`将其拉出流程之前。`display: none`导致元素不计入列目的（正如人们所期望的那样）。

您的问题似乎可以通过让`table`（在您的情况下`ul`）成为`table-layout: auto`然后将单元格（您的`li`）设置为适当的宽度（在您的情况下为 25%）来解决，除非它们都具有完全相同的宽度文本。

`table`有关在正常元素上发生的所有这些事情的说明，[请参见this fiddle 。](http://jsfiddle.net/ZNhrH/9/)

`div`附带说明一下， a中的裸元素`ul`不是有效的 html 结构（`ul`应该只有`li`元素作为直接子元素）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T20:02:56.477

你的 div / 固定类的目的是什么？但是，您可以嵌套另一个 ul 或列表并将“固定”类放在上面。如果您添加高度 100%，那么整个背景就是您拥有的鲑鱼色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T21:03:52.083

似乎`display: table`将在固定布局中呈现子元素，无论它们的显示是否设置为`absolute`-`fixed`如果它们显示为块元素，则绘制单元格。

这是“错误”的简化版本：

[http://codepen.io/quicksnap/pen/xuDwG](http://codepen.io/quicksnap/pen/xuDwG)（注意 Lorem 项右侧的额外空间）

当使用`table-caption`for an`li`然后嵌套在固定或绝对元素中时，它似乎使元素免于被绘制为单元格。

这是我正在寻找的一个例子：http: [//codepen.io/quicksnap/pen/noBvm](http://codepen.io/quicksnap/pen/noBvm)

感谢 ScottS 指出我的无效 HTML——它让我了解了它为什么会这样工作，尽管我仍然不明白为什么表格正在为一个不是`table-cell`并且定位为绝对/固定的元素绘制一个单元格空间。

# jquery - jQuery 中这两种模式访问 DOM 的方式有什么区别？

> ID：13866810
> 
> 赞同：1
> 
> 时间：2012-12-13T19:16:15.443
> 
> 标签：jquery, dom

这两种模式产生不同的结果，但从概念上讲，我希望它们是相同的。第一个只是更新现有的`<div>`，而第二个`<div>`按顺序附加 s。我预计两者都会产生第二种模式。所以我很好奇这两种模式如何访问 DOM 以给出它们所做的结果的差异。

**模式 1**

```
$(document).ready( function () {
    var list = [
        'My','name','is','Jonas'
        ];

    $(list).each( function (key) {
        $("body").append("<div>").text(list[key]);
                  });
});​ 
```

[http://jsfiddle.net/vtKEq/](http://jsfiddle.net/vtKEq/)

**模式 2**

```
$(document).ready( function () {
    var list = [
        'My','name','is','Jonas'
        ];

    $(list).each( function (key) {
        $("<div />").text(list[key]).appendTo("body")
    });
});​ 
```

[http://jsfiddle.net/MLFbw/](http://jsfiddle.net/MLFbw/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:20:56.663

The difference is that

**Pattern1** Add `div` into `body` and then change `body` text.
**Pattern2** Create `div` change it's `text` and then append to `body`

**Why it happens ?**
Because the first pattern's selector is `body`, so when you use `text` it changes `body` text.

**How to fix ?**

```
$("body").append("<div>" + list[key] + "</div>"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T19:22:26.650

```
$(document).ready( function () {
    var list = [
        'My','name','is','Jonas'
        ];

    $(list).each( function (key) {
        $("body").append($("<div>").text(list[key]));
                  });
}); 
```

考虑到行为相同的第一个场景，您需要创建一个 div 并将其附加到 body

# android - 识别使用缺少 AttributeSet 的 View 构造函数的错误

> ID：13866814
> 
> 赞同：1
> 
> 时间：2012-12-13T19:16:23.807
> 
> 标签：android, eclipse, android-layout, android-view

作为一个不是初级程序员的初级 Android 程序员，我对我花了很长时间才意识到崩溃是由于省略使用构造函数`AttributeSet`作为第二个参数并编写以下代码而导致的在 XML 布局中定义的自定义视图。

////////MyView.java////////

```
public class MyView extends View {

    public SimpleView(Context context) {
        super(context);
    }
    ...

} 
```

我的问题是：我可以做些什么（在 Eclipse 中，ADT 变体）能够快速确定这个错误？我相当仔细地查看 lint 消息，并希望这种习惯能让我为一个错误花费数小时。

该手册当然明确指出，在 XML 布局中定义的自定义视图应该使用`(Context, AttributeSet)`View 构造函数的变体，但是在任何级别进行编程同时精确地调用参考页面中的每一个细节都是没有希望的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T20:52:55.527

图形布局中应该有以下错误：

> 自定义视图 MyView 未使用 2 或 3 参数视图构造函数；XML 属性不起作用

但我同意编译时错误会更好......

# c# - EF 5 Code First：基础提供程序在打开时失败

> ID：13866815
> 
> 赞同：1
> 
> 时间：2012-12-13T19:16:24.247
> 
> 标签：c#, .net, entity-framework, entity-framework-5

我首先使用 EF5 代码。当我尝试使用时`DbContext`，出现以下错误：

> 基础提供程序在打开时失败。

`InnerException`是 ：

> 无法打开登录请求的数据库“MyDb”。登录失败。**用户“ sa** ”登录失败。

数据库不存在。在下面的代码中，我检查数据库是否存在，以根据我的域更改创建它。

```
if (context.Database.Exists() ||
    context.Database.CompatibleWithModel(false))
{
    context.Database.Delete();
} 
```

连接字符串：

```
connectionString="Data Source=.\sql2012; Initial Catalog=MyDb; Persist Security Info=True; User ID=sa; Password=*****" 
```

**更新：** DbContext 用法：

```
public class DomainDbContext : DbContext
{
    public DomainDbContext()
        : base("WebMarkerConnection")
    {

    }

    public IDbSet<ServiceUser> ServiceUsers { get; set; }
    public IDbSet<Favorite> Favorites { get; set; }
    public IDbSet<Category> Categories { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Configurations.Add(new ServiceUserConfig());
        modelBuilder.Configurations.Add(new FavoriteConfig());
        modelBuilder.Configurations.Add(new CategoryConfig());

        base.OnModelCreating(modelBuilder);
    }
} 
```

任何建议都会有所帮助。

# javascript - 单击动态列表创建的项目并显示动态内容

> ID：13866816
> 
> 赞同：0
> 
> 时间：2012-12-13T19:16:24.083
> 
> 标签：javascript, jquery, html, css

我有一种情况，我正在生成一个动态列表。现在我正在尝试单击列表中的每个项目并为每个项目显示一些内容。我知道我可以使用另一个数组，我可以将内容存储为 div，然后指向要显示的位置。就是想不通怎么写。这是我到目前为止所拥有的

```
<ul id="list">
<!--- List items will be added dynamically. --->
</ul>

$(InitPage);

    function InitPage() {

        var jList = $("#list");

        var arrValues = ['<div id="one"></div>', '<div id="two"></div>', '<div id="three"></div>'];

        $.each(
        arrValues,

        function (intIndex, objValue) {

            jList.append(
            $('<li class="thumbItem">' + objValue + "</li>"));
        });
    }

css--
li.thumbItem{
        float:left;
        width:192px;
        height:192px;
        background:gray;
        margin:10px 10px 0 0;
        cursor:pointer;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:18:31.950

Why not use delegation?

```
$(function(){    
   $('#list').on('click','li',function(){
        //do stuff here
    });
}); 
```

For jquery 1.4, use .live():

```
$('#list li').live('click', function(){
            //do stuff here
        }); 
```

# regex - 在多域站点上使用 mod_rewrite htaccess 强制 www 和斜杠

> ID：13866817
> 
> 赞同：0
> 
> 时间：2012-12-13T19:16:31.577
> 
> 标签：regex, .htaccess, mod-rewrite

**我的目标是在多域环境中强制执行 www 和 url 上的斜杠以实现此目的：**

```
http://mydomain.com/company -> http://www.mydomain.com/company/ 
```

问题是某些子域必须从 www 前缀中排除，但仍强制使用尾部斜杠，例如：

```
http://m.mydomain.com/company -> http://m.mydomain.com/company/ 
```

另一个因素是我需要维护任何子域以避免多次重定向。例如：

```
http://dev.mydomain.com/login -> http://dev.mydomain.com/login/ 
```

多次重定向将导致：

```
http://dev.mydomain.com/login -> http://mydomain.com/login/ 
```

需要避免这种情况，以使用户保持在当前的开发或移动站点上。

**到目前为止我所拥有的：**

```
# Convert http://mydomain.com/company -> http://www.mydomain.com/company/
# Enforce www and trailing slash
# If you have subdomains, you can add them to
# the list using the "|" (OR) regex operator
RewriteCond %{HTTP_HOST} !^(www|dev|m)\.
RewriteCond %{HTTPS}s ^on(s)|
RewriteCond %{REQUEST_URI} !(\.[a-zA-Z0-9]{1,5}|/)$
RewriteRule ^ http%1://www.%{HTTP_HOST}%{REQUEST_URI}/ [R=301,L] 
```

这适用于缺少 www 前缀和尾部斜杠的域，并将它们都添加到 1 个重定向中。

```
# Convert http://mydomain.com/company/ -> http://www.mydomain.com/company/
# Enforce www
# If you have subdomains, you can add them to
# the list using the "|" (OR) regex operator
RewriteCond %{HTTP_HOST} !^(www|dev|m)\.
RewriteCond %{HTTPS}s ^on(s)|
RewriteRule ^ http%1://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

如果存在尾部斜杠，则此方法有效，如果缺少，则添加 www 前缀。

**如果存在子域并且缺少尾部斜杠，我无法弄清楚的是一种重定向用户的方法。**

```
RewriteCond %{QUERY_STRING} ^$    [NC]
RewriteRule ^((.*/)?[^/\.]+)$ /$1/ [R=301,L] 
```

此规则用于添加尾部斜杠，但会将子域重定向回根域。

**您能否推荐一个解决方案，将这些规则组合成尽可能少的选项，同时实现我的目标并避免多次重定向？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:51:46.653

对于[`RewriteRule`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriterule)指令，模式与请求对应的文件系统路径匹配。因此，要么将 a[`RewriteCond`](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritecond)与合适的变量一起使用，要么在构建替换时使用适当的变量，以生成 URL 而不是路径。

你有没有尝试过

```
RewriteCond %{QUERY_STRING} ^$    [NC]
RewriteCond %{HTTPS}s ^on(s)|
RewriteRule ^((.*/)?[^/\.]+)$ http%1://%{HTTP_HOST}%{REQUEST_URI}/ [R=301,L] 
```

这应该是与您的其他两个规则最同步的公式。不过，您必须为此添加一个条件。

# sharepoint - 为什么我的图像不显示在 SharePoint 中？

> ID：13866819
> 
> 赞同：1
> 
> 时间：2012-12-13T19:16:52.077
> 
> 标签：sharepoint, sharepoint-2007

我在 SharePoint 中上传了一张图片：

我将图像文件保存在文件夹中：`IMAGES\\imagewebpart\\`

```
 Random rd = new Random(); 
    int db = rd.Next(0, 100); 
    string filename =Path.GetFileNameWithoutExtension(imagefile) + 
      db.ToString() + 
      Path.GetExtension(imagefile); 
    string filepath ="\\_layouts\\IMAGES\\imagewebpart\\" + filename; 
FileUpload1.SaveAs(Server.MapPath(filepath)); 
    //ImageEdit.ImageUrl =filepath; 
    ImageEdit.ImageUrl = Server.MapPath(filepath); 
```

我可以成功保存文件，但无法将图像显示为`ImageEdit`.

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T15:41:58.973

> ImageEdit.ImageUrl = Server.MapPath(filepath);

尝试这个

```
ImageEdit.ImageUrl = filepath; 
```

其中文件路径 = "/_layouts/IMAGES/imagewebpart/" + 文件名

# sql-server - 由于经典 ASP 中的 Excel 电子表格导出，事件日志给出类型不匹配和不正确的语法错误

> ID：13866820
> 
> 赞同：0
> 
> 时间：2012-12-13T19:16:54.347
> 
> 标签：sql-server, excel, asp-classic, export-to-excel

再次感谢您来到这里！

这个问题我们已经有一段时间了，但从来没有花时间解决它。

当我们通过以下方式将页面打印为 excel 文件时：

`Response.ContentType="application/vnd.ms-excel"`

我们应该得到一个下载窗口，以便接收生成的文件。

如果我保存文件而不是打开它，我的服务器事件日志不会显示错误。

选择打开选项时，出现一个加载条。

这个加载栏似乎正在重新查询页面/重新运行 asp，因为我们收到的错误归结为在请求查询字符串的 sql 查询中使用的空变量。

[http://s13.postimage.org/5mmkubzlj/ss2.jpg](http://s13.postimage.org/5mmkubzlj/ss2.jpg)

我是否需要更改将此数据导出到 excel 的方法？我是否缺少某些东西可以让 Excel 看到文件已经完成处理？非常困惑在这里做什么。

想法？经验？再次感谢！

# css - 从悬停到单击的 CSS 选定状态

> ID：13866828
> 
> 赞同：0
> 
> 时间：2012-12-13T19:17:26.463
> 
> 标签：css, drop-down-menu, click, hover, selected

如果有人问过这个问题或者这是一个愚蠢的问题，我深表歉意——这看起来很简单，但我确实搜索过。

在我的网站上，我使用了一个导航栏，我最初是从很久以前有许多免费的罐装导航栏的网站中提取的，并且从那时起通过修改参数对其进行了很多更改。现在，随着移动设备的出现（是的，我落后了），我想将所有下拉菜单从悬停时弹出更改为单击时弹出。我知道这就是 bootstrap 的做法，等等，所以很明显它可以做到。

对我来说，事情开始改变颜色并基于以下内容出现：

```
.menu ul li.selected a.outer1 {color:#000; background:#929292; margin-bottom:250px; 
                               zoom: 1; filter: alpha(opacity=60); opacity: 0.6; } 
```

选择外部列表元素时，内容会发生变化。但是，似乎“.selected”使 li 在悬停时“选中”。有没有办法改变它，让它在点击时被选中？只是一个简单的单词变化？还是我必须改变我的结构？如果需要，我可以提供额外的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:26:13.177

这不是一个简单的单一 CSS 更改。媒体查询为特定视口加载某个 div 并隐藏另一个。

您应该查看媒体查询以及如何在每个视口中加载/隐藏特定元素。

# c++ - Intel pin：检测运行过程

> ID：13866835
> 
> 赞同：8
> 
> 时间：2012-12-13T19:17:45.043
> 
> 标签：c++, x86, intel, instrumentation, intel-pin

我创建了一个简单的 pin 工具，可以转储任何 win32 CreateFileW 调用。它工作正常，但是当我尝试将其附加到已经运行的进程时，该进程只是终止。尝试了几个应用程序（记事本、写字板、Internet Explorer），结果相同。这是我使用的命令：

```
.\pin -pid 8804 -t dumpfile.dll 
```

我有一个提示可以尝试像这样关闭多线程：

```
.\pin -mt 0 -pid 8804 -t dumpfile.dll 
```

但它没有帮助。还尝试了另一个开箱即用的 pintool，但也没有用，所以问题不在我的 pintool 上。有任何想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T17:45:05.310

好的，今天我有时间再次研究这个问题。使用从 cmd 启动的控制台应用程序进行测试，在关闭之前，它实际上转储了一条错误消息，找不到 .dll（pin 工具）...

因此，在运行 pin 时，您实际上必须指定 pin 工具的完整路径，或相对于检测二进制文件位置的路径。

# jquery - 将“touchstart”绑定到文档时的移动 Safari (iPad) 滚动性能

> ID：13866837
> 
> 赞同：2
> 
> 时间：2012-12-13T19:17:57.213
> 
> 标签：jquery, performance, jquery-ui, ipad, jquery-events

我一直在调查在 iPad Safari 上滚动我的网站时的一些性能问题。我们有一些页面是`table`多达 500 行的大型元素；性能影响似乎与表中的行数有关（并且，在没有此类表的页面上，滚动性能似乎很好）。桌面浏览器非常好。

您可以在以下链接中尝试一下。*注意：要复制，请确保将默认值 25/page 更改为 500/page。* [http://www.cellartracker.com/list.asp?table=Notes&iUserOverride=0&T=1000](http://www.cellartracker.com/list.asp?table=Notes&iUserOverride=0&T=1000)

在做了相当多的调试之后，我发现如果我删除了我绑定的任何“touchstart”事件，滚动性能是正常的（并且超快，正如预期的那样）。我`$(document).on('touchstart', '<selector>', function ()...)`配置了一些事件来帮助使触摸设备可以访问一些悬停功能。目前，我绑定到`$(document)`有两个原因：

1.  可能有很多元素与选择器匹配，因此传统上单个委托事件处理程序的性能优于每个元素附加的 500 多个处理程序（我刚刚在 IE8 上修复了一些与此相关的性能问题）。
2.  一些受影响的元素是通过 AJAX 加载的，因此如果我绑定到单个元素，这些元素不会自动获取处理程序。

好的，太好了——我找到了原因——但我不知道*为什么*这只是在带有大表的页面上出现的问题以及如何解决它。对于同时具有触摸和键盘/鼠标的设备**，**我希望每个输入机制都能一致地运行（所以这种`if (touch) bind('click') else bind('mouseenter')`方法不是我想要的）。另外，我还在考虑为某些元素实现[快速按钮](https://developers.google.com/mobile/articles/fast_buttons)方法，这可能需要绑定到当前绑定`$(document)`相应处理程序的位置。`click`

那么......关于如何提高这些页面上的滚动性能同时仍将 touchstart 绑定到的任何想法`$(document)`？HTML 在这一点上是相当固定的，但是如果对 DOM 有一些*简单*的调整会产生很大的影响，我愿意接受它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T22:39:23.093

好吧，在搁置了几天去做别的事情之后，我回来发现性能已经神秘地显着提高了！追溯所做的其他更改，我发现了性能问题的根源：**jQuery UI 1.8.20**。我刚刚升级到 jQuery UI 1.9.2 来修复一些其他问题，现在我不再看到可怕的滚动延迟/性能问题。

`touchstart`现在，我仍然看到绑定到的性能略有下降`$(document)`，但现在它是如此轻微以至于几乎无法察觉。不过，如果有人对如何更好地优化原始问题有其他指导，我仍然很想听听！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T01:01:17.793

我发现 scrollperf 的降级与 DOM 的大小成正比。我还没有进行足够的测试来确定它是 DOM 节点的数量、嵌套级别、像素数、渲染复杂性还是其他什么。可以这么说，随着您添加更多的提要项目，滚动性能变得越来越差。

以下 Codepen 演示了这一点：

[http://codepen.io/ddopson/pen/zgCfj](http://codepen.io/ddopson/pen/zgCfj)

添加大约 40 个提要项（第一个按钮）并切换“touchstart”事件侦听器（第三个按钮）可以清楚地看出在大页面上侦听触摸事件的惩罚有多严重。

我也在尝试解决这个问题，但我还没有理清正确的路径......

# c - 在 C 中将多个参数作为宏传递

> ID：13866838
> 
> 赞同：3
> 
> 时间：2012-12-13T19:18:03.423
> 
> 标签：c

抱歉英语不好。

假设代码：

```
#define FOO(x,y) FOO ## x
#define BAR A, B 
```

`FOO(A, B)`成功扩展为`FOOA`. 但是当我写`FOO(BAR)`的时候，C预处理器（`gcc -E`）给出错误

```
error: macro "FOO" requires 2 arguments, but only 1 given 
```

`FOO`如果我想扩展`FOO(BAR)`为，我应该如何更改宏`FOOA`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:24:56.747

```
#define FOO(X, Y) FOO ## X
#define BAR A, B

#define APPLY(F, X) F(X)

APPLY(FOO, BAR) 
```

或者

```
#define FOO(X) FOO_(X)
#define FOO_(X, Y) FOO ## X
#define BAR A, B

FOO(BAR) 
```

# java - JLabel 的 ActionListener

> ID：13866839
> 
> 赞同：7
> 
> 时间：2012-12-13T19:18:07.067
> 
> 标签：java, swing, awt, jlabel, actionlistener

我想学习如何编写`ActionListener`for `JLabel`。我想制作一个标签，当用户单击标签时为用户打开一个新框架。也许`MouseListener`可以工作，但我不知道怎么做。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-14T02:42:06.090

我建议使用 a`JTextField`而不是 a`JLabel`用于此用途。

基于一个*设计*为可聚焦的组件，它允许一个`ActionListener`看起来和感觉更像一个 HTML 链接。

例如

![链接标签](../Images/0de7a720a15077f6da60d584dbcafb25.png)

这就是鼠标悬停在第一个链接上时的显示方式。

## `LinkLabel`

```
/* License - LGPL
LinkLabel Using the Desktop Class

There are a lot of link labels.  This one uses the Java 1.6+ 
Desktop class for its functionality, and is thereby suitable 
for applets, applications launched using JWS, and 'standard' 
(non-JWS) desktop applications.

Note that the Desktop class can be used with pre 1.6 JREs. It 
is available through JDIC. 
https://jdic.dev.java.net/nonav/documentation/javadoc/jdic/org/jdesktop/jdic/desktop/Desktop.html
*/

import java.awt.Desktop;
import java.awt.Color;
import java.awt.Cursor;
import java.awt.BorderLayout;
import java.awt.GridLayout;

import java.awt.event.*;

import javax.swing.JTextField;
import javax.swing.JPanel;
import javax.swing.JOptionPane;

import javax.swing.border.MatteBorder;
import javax.swing.border.Border;

import java.net.URI;
import java.io.File;

/**
A Java 1.6+ LinkLabel that uses the Desktop class for opening
the document of interest.

The Desktop.browse(URI) method can be invoked from applications,
applets and apps. launched using Java Webstart.  In the latter
two cases, the usual fall-back methods are used for sandboxed apps
(see the JavaDocs for further details).

While called a 'label', this class actually extends JTextField,
to easily allow the component to become focusable using keyboard
navigation.

To successfully browse to a URI for a local File, the file name
must be constructed using a canonical path.

@author Andrew Thompson
@version 2008/08/23
*/
public class LinkLabel
    // we extend a JTextField, to get a focusable component
    extends JTextField
    implements MouseListener, FocusListener, ActionListener {

    /** The target or href of this link. */
    private URI target;

    public Color standardColor = new Color(0,0,255);
    public Color hoverColor = new Color(255,0,0);
    public Color activeColor = new Color(128,0,128);
    public Color transparent = new Color(0,0,0,0);

    public boolean underlineVisible = true;

    private Border activeBorder;
    private Border hoverBorder;
    private Border standardBorder;

    /** Construct a LinkLabel that points to the given target.
    The URI will be used as the link text.*/
    public LinkLabel(URI target) {
        this( target, target.toString() );
    }

    /** Construct a LinkLabel that points to the given target,
    and displays the text to the user. */
    public LinkLabel(URI target, String text) {
        super(text);
        this.target = target;
    }

    /* Set the active color for this link (default is purple). */
    public void setActiveColor(Color active) {
        activeColor = active;
    }

    /* Set the hover/focused color for this link (default is red). */
    public void setHoverColor(Color hover) {
        hoverColor = hover;
    }

    /* Set the standard (non-focused, non-active) color for this
    link (default is blue). */
    public void setStandardColor(Color standard) {
        standardColor = standard;
    }

    /** Determines whether the */
    public void setUnderlineVisible(boolean underlineVisible) {
        this.underlineVisible = underlineVisible;
    }

    /* Add the listeners, configure the field to look and act
    like a link. */
    public void init() {
        this.addMouseListener(this);
        this.addFocusListener(this);
        this.addActionListener(this);
        setToolTipText(target.toString());

        if (underlineVisible) {
            activeBorder = new MatteBorder(0,0,1,0,activeColor);
            hoverBorder = new MatteBorder(0,0,1,0,hoverColor);
            standardBorder = new MatteBorder(0,0,1,0,transparent);
        } else {
            activeBorder = new MatteBorder(0,0,0,0,activeColor);
            hoverBorder = new MatteBorder(0,0,0,0,hoverColor);
            standardBorder = new MatteBorder(0,0,0,0,transparent);
        }

        // make it appear like a label/link
        setEditable(false);
        setForeground(standardColor);
        setBorder(standardBorder);
        setCursor( new Cursor(Cursor.HAND_CURSOR) );
    }

    /** Browse to the target URI using the Desktop.browse(URI)
    method.  For visual indication, change to the active color
    at method start, and return to the standard color once complete.
    This is usually so fast that the active color does not appear,
    but it will take longer if there is a problem finding/loading
    the browser or URI (e.g. for a File). */
    public void browse() {
        setForeground(activeColor);
        setBorder(activeBorder);
        try {
            Desktop.getDesktop().browse(target);
        } catch(Exception e) {
            e.printStackTrace();
        }
        setForeground(standardColor);
        setBorder(standardBorder);
    }

    /** Browse to the target. */
    public void actionPerformed(ActionEvent ae) {
        browse();
    }

    /** Browse to the target. */
    public void mouseClicked(MouseEvent me) {
        browse();
    }

    /** Set the color to the hover color. */
    public void mouseEntered(MouseEvent me) {
        setForeground(hoverColor);
        setBorder(hoverBorder);
    }

    /** Set the color to the standard color. */
    public void mouseExited(MouseEvent me) {
        setForeground(standardColor);
        setBorder(standardBorder);
    }

    public void mouseReleased(MouseEvent me) {}

    public void mousePressed(MouseEvent me) {}

    /** Set the color to the standard color. */
    public void focusLost(FocusEvent fe) {
        setForeground(standardColor);
        setBorder(standardBorder);
    }

    /** Set the color to the hover color. */
    public void focusGained(FocusEvent fe) {
        setForeground(hoverColor);
        setBorder(hoverBorder);
    }

    public static void main(String[] args) throws Exception {
        JPanel p = new JPanel(new GridLayout(0,1));
        File f = new File(".","LinkLabel.java");

        /* Filename must be constructed with a canonical path in
        order to successfully use Desktop.browse(URI)! */
        f = new File(f.getCanonicalPath());

        URI uriFile = f.toURI();

        LinkLabel linkLabelFile = new LinkLabel(uriFile);
        linkLabelFile.init();
        p.add(linkLabelFile);

        LinkLabel linkLabelWeb = new LinkLabel(
            new URI("http://sscce.org/"),
            "SSCCE");
        linkLabelWeb.setStandardColor(new Color(0,128,0));
        linkLabelWeb.setHoverColor(new Color(222,128,0));
        linkLabelWeb.init();

        /* This shows a quirk of the LinkLabel class, the
        size of the text field needs to be constrained to
        get the underline to appear properly. */
        p.add(linkLabelWeb);

        LinkLabel linkLabelConstrain = new LinkLabel(
            new URI("http://sdnshare.sun.com/"),
            "SDN Share");
        linkLabelConstrain.init();
        /* ..and this shows one way to constrain the size
        (appropriate for this layout).
        Similar tricks can be used to ensure the underline does
        not drop too far *below* the link (think BorderLayout
        NORTH/SOUTH).
        The same technique can also be nested further to produce
        a NORTH+EAST packing (for example). */
        JPanel labelConstrain = new JPanel(new BorderLayout());
        labelConstrain.add( linkLabelConstrain, BorderLayout.EAST );
        p.add(labelConstrain);

        LinkLabel linkLabelNoUnderline = new LinkLabel(
            new URI("http://java.net/"),
            "java.net");
        // another way to deal with the underline is to remove it
        linkLabelNoUnderline.setUnderlineVisible(false);
        // we can use the methods inherited from JTextField
        linkLabelNoUnderline.
            setHorizontalAlignment(JTextField.CENTER);
        linkLabelNoUnderline.init();
        p.add(linkLabelNoUnderline);

        JOptionPane.showMessageDialog( null, p );
    }
} 
```

# apache - How are logs ordered by the dumpio (mod_dumpio) module in Apache? (Logs identifiers)

> ID：13866842
> 
> 赞同：3
> 
> 时间：2012-12-13T19:18:19.457
> 
> 标签：apache, logging, dump

Guess that Apache received two POST requests at a same time. They would be normally logged by the dumpio module in the correct order like below. Where you can see that log 3 belongs to POST logged in the post 1 (/mypage_1/) and log 4 belongs to the post logged in log 2 (/mypage_2/).

1.  [Thu Dec 13 11:28:01 2012] [debug] mod_dumpio.c(74): mod_dumpio: dumpio_in (data-HEAP): **POST /mypage_1/** HTTP/1.1\r\n

2.  [Thu Dec 13 11:28:01 2012] [debug] mod_dumpio.c(74): mod_dumpio: dumpio_in (data-HEAP): **POST /mypage_2/** HTTP/1.1\r\n

3.  [Thu Dec 13 11:28:01 2012] [debug] mod_dumpio.c(74): mod_dumpio: dumpio_in (data-HEAP): **xml_request=I_Belong_To_mypage_1**

4.  [Thu Dec 13 11:28:01 2012] [debug] mod_dumpio.c(74): mod_dumpio: dumpio_in (data-HEAP): **xml_request=I_Belong_To_mypage_2**

I wonder if by any chance they could be logged in a different order like below. And in this case I would not know what request belongs to what POST. **Is there any way for me to know the requests that belong to each POST?**

1.  [Thu Dec 13 11:28:01 2012] [debug] mod_dumpio.c (74): mod_dumpio: dumpio_in (data-HEAP): **POST /mypage_1/** HTTP/1.1\r\n

2.  [Thu Dec 13 11:28:01 2012] [debug] mod_dumpio.c (74): mod_dumpio: dumpio_in (data-HEAP): **POST /mypage_2/** HTTP/1.1\r\n

3.  [Thu Dec 13 11:28:01 2012] [debug] mod_dumpio.c (74): mod_dumpio: dumpio_in (data-HEAP): **xml_request=I_Belong_To_mypage_2**

4.  [Thu Dec 13 11:28:01 2012] [debug] mod_dumpio.c (74): mod_dumpio: dumpio_in (data-HEAP): **xml_request=I_Belong_To_mypage_1**

# c++ - Win32：在缓冲区中存储多行文本

> ID：13866846
> 
> 赞同：0
> 
> 时间：2012-12-13T19:18:40.437
> 
> 标签：c++, winapi, gdi

我将如何在 Win32 中显示多行文本？这段代码在我的**GamePaint()**函数中，我想将前 5 个高分（存储在结构的属性中）写到屏幕上。我可以让它使用这种方法成功输出单行...如何使 TCHAR 缓冲区 szText 存储多行？这是我到目前为止所尝试的：

**原始代码：**

```
 //draw rect for normal scores
ChangeTextFormat(hDC, hWnd, 1);
TCHAR szText[64];
RECT  rcNormalScores = { 268, 122, 436, 330};
RECT  rcHardScores = { 37, 122, 198, 330};

//stringstream ssTemp;

for(int i = 0; i < 5; i++)
{
    //ssTemp << i;

    //display nth Normal score
    wsprintf(szText, "%d \n", g_scoreTop[i].num);
    DrawText(hDC, szText, -1, &rcNormalScores, DT_LEFT | DT_WORDBREAK);

} 
```

编辑：感谢您的信息，但我仍然在数据类型之间转换时遇到了一些困难。这是我得到的错误：

> 无法从 'std::basic_string<_Elem,_Traits,_Ax>' 转换为 'std::basic_string<_Elem,_Traits,_Ax>'

EDIT2：感谢您的帮助，女王 3。我在下面发布了工作代码：

**工作代码：**

```
ChangeTextFormat(hDC, hWnd, 1);
RECT  rcNormalScores = { 37, 122, 198, 330}; 
RECT  rcHardScores = { 268, 122, 436, 330};

stringstream ssTemp;

for(int i = 0; i < 5; i++)
{
    ssTemp << g_scoreTop[i].num << " \n";
}

string sTemp = ssTemp.str();
LPCSTR LPTemp = (LPCSTR)sTemp.c_str();

DrawText(hDC, LPTemp, -1, &rcNormalScores, DT_LEFT | DT_WORDBREAK);
DrawText(hDC, LPTemp, -1, &rcHardScores, DT_LEFT | DT_WORDBREAK); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T19:21:40.860

任何一个

1.  用所有行和换行符创建一个字符串并执行单个 DrawText
2.  每次通过添加字符串的高度来调整 rcNormalScores .top（为此，您可以使用 DT_CALCRECT 标志）

如果您稍后决定将 DT_LEFT 更改为 DT_CENTER，第一个可能会更好。

# c# - How to add to the Column the PRODUCT of two other columns?

> ID：13866847
> 
> 赞同：0
> 
> 时间：2012-12-13T19:18:42.220
> 
> 标签：c#, sql, product

I am working on a project for a Market (Mini Market). And I want to create a Storage Table where I have all my products. And in this table there is a `QUANTITY Column` and the `PURCHASE PRICE` Column. And I want to add the TOTAL column. In the total column it should show me the price of:

```
TOTAL = QUANTITY * PURCHASE PRICE 
```

And I wanted to ask you about how should I do this (`TOTAL = QUANTITY * PURCHASE PRICE`)? I there any option to do this while I am creating the Table in *SQL SERVER*? Or I have to do this in the *C#* code?

Please help me guys?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T19:22:51.467

理论上，你根本不*应该这样*做——在关系数据库中，派生字段不应该存储在数据库中，而是根据需要派生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:24:56.517

```
 Update MyTableName Set
    Total = Quantity * PurchasePrice 
```

但是您应该考虑在需要它的选择查询中即时计算它，或者添加一个计算列。

```
Alter Table MyTableName  
Add Column Total = Quantity * PurchasePrice 
```

# emacs - How to save a list of all the installed packages in Emacs 24?

> ID：13866848
> 
> 赞同：53
> 
> 时间：2012-12-13T19:18:46.260
> 
> 标签：emacs, emacs24, dot-emacs, emacs-prelude

I am using prelude as a base Emacs configuration. I have installed lots of packages from the package manager, and I want to use my settings on another machine.

I don't want to carry the installed packages and also I don't want to create a list manually.

What is the way of saving a list all the installed packages into prelude-package.el or any other file so that when I take this configuration to my other machine, they automatically get installed there on first use?

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-12-13T19:29:15.127

您可以从变量中获取当前安装的包（不包括内置包）的列表`package-activated-list`。要在启动时自动安装它们，请参阅这个问题：[如何通过指定包名称列表来自动安装 emacs 包？](https://stackoverflow.com/questions/10092322/how-to-automatically-install-emacs-packages-by-specifying-a-list-of-package-name)

更具体地说，如果你这样做`C-h v package-activated-list`，复制显示的值，并将其作为 的值插入`prelude-packages`，emacs 将自动确保在启动时安装这些包。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-04-03T04:57:54.577

规范方法是最好的（由 ataylor 描述）。这是一个更笨拙的方法。

`M-x list-packages`. `C-s installed`直到你找到安装包的第一行。开始选择`C-SPC`。向下直到你到达内置包。用 复制`M-w`。`C-x b`用于新缓冲区。用 粘贴`C-y`。`C-x C-s`保存文件。

我看到的唯一优点是这更具描述性。显示您的包裹的简短描述。当您安装一些软件包并忘记它时很有用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-10-04T15:01:33.167

[正如在如何通过指定包名称列表来自动安装 emacs 包](https://stackoverflow.com/questions/10092322/how-to-automatically-install-emacs-packages-by-specifying-a-list-of-package-name)中提到的那样？，最好也记录下你需要的包的版本。为此，您可以使用以下功能：

```
(defun list-packages-and-versions ()
  "Returns a list of all installed packages and their versions"
  (mapcar
   (lambda (pkg)
     `(,pkg ,(package-desc-version
                (cadr (assq pkg package-alist)))))
   package-activated-list)) 
```

这会给你一个`(NAME VERSION)`配对列表。不幸的是，我还没有找到安装特定版本软件包的方法。它似乎`package.el`总是抓住最新的可用。我现在正在做的是：

```
(defun install-packages-with-specific-versions (package-version-list)
  "Install the packages in the given list with specific versions.
PACKAGE-VERSION-LIST should be a list of (NAME VERSION) lists,
where NAME is a symbol identifying the package and VERSION is
the minimum version to install."
  (package-download-transaction
   (package-compute-transaction () package-version-list))) 
```

我编写了一个更长的函数来安装与确切版本号匹配的包，但它失败了，因为`package.el`默认情况下只检索每个包可用的最新版本。[要旨](https://gist.github.com/felipeochoa/1f1512dba8fe24601bc1e75b7af1e2ee)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-09-15T11:55:40.700

如上所述，使用 emacs 普通模式。这是另一种邪恶模式的做法：

Mx 列表包；/installed（它们将被突出显示）；v（视觉模式）；j（选择它们）；y（复制它们）；打开一个新的缓冲区并粘贴它们。

# sql-server-2008 - SQL Server - calculate elapsed time between two datetime stamps in HH:MM:SS format

> ID：13866850
> 
> 赞同：15
> 
> 时间：2012-12-13T19:18:52.033
> 
> 标签：sql-server-2008, datetime, elapsedtime

I have a SQL Server table that has a "Time" column. The table is a log table the houses status messages and timestamps for each message. The log table is inserted into via a batch file. There is an ID column that groups rows together. Each time the batch file runs it initializes the ID and writes records. What I need to do is get the elapsed time from the first record in an ID set to the last record of the same ID set. I started toying with select Max(Time) - Min(Time) from logTable where id = but couldn't figure out how to format it correctly. I need it in HH:MM:SS.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-13T19:58:12.517

**更新：**

正确计算 SQL Server 中的时间跨度，**即使超过 24 小时**：

```
-- Setup test data
declare @minDate datetime = '2012-12-12 20:16:47.160'
declare @maxDate datetime = '2012-12-13 15:10:12.050'

-- Get timespan in hh:mi:ss
select cast(
        (cast(cast(@maxDate as float) - cast(@minDate as float) as int) * 24) /* hours over 24 */
        + datepart(hh, @maxDate - @minDate) /* hours */
        as varchar(10))
    + ':' + right('0' + cast(datepart(mi, @maxDate - @minDate) as varchar(2)), 2) /* minutes */
    + ':' + right('0' + cast(datepart(ss, @maxDate - @minDate) as varchar(2)), 2) /* seconds */

-- Returns 18:53:24 
```

特别欢迎显示不准确的边缘案例！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-13T19:59:45.037

SQL Server 不支持 SQL 标准间隔数据类型。最好的办法是以秒为单位计算差异，并使用函数来格式化结果。*只要您的时间间隔小于 24 小时*，本机函数 CONVERT() 可能看起来工作正常。但是 CONVERT() 不是一个好的解决方案。

```
create table test (
  id integer not null,
  ts datetime not null
  );

insert into test values (1, '2012-01-01 08:00');
insert into test values (1, '2012-01-01 09:00');
insert into test values (1, '2012-01-01 08:30');
insert into test values (2, '2012-01-01 08:30');
insert into test values (2, '2012-01-01 10:30');
insert into test values (2, '2012-01-01 09:00');
insert into test values (3, '2012-01-01 09:00');
insert into test values (3, '2012-01-02 12:00'); 
```

值的选择方式使得

*   id = 1，经过的时间是1小时
*   id = 2，经过的时间是 2 小时，并且
*   id = 3，经过的时间是 3 小时。

此 SELECT 语句包括一个计算秒数的列，以及一个使用 CONVERT() 减法的列。

```
select t.id,
       min(ts) start_time,
       max(ts) end_time,
       datediff(second, min(ts),max(ts)) elapsed_sec,
       convert(varchar, max(ts) - min(ts), 108) do_not_use
from test t
group by t.id;

ID  START_TIME                 END_TIME                   ELAPSED_SEC  DO_NOT_USE
1   January, 01 2012 08:00:00  January, 01 2012 09:00:00  3600         01:00:00
2   January, 01 2012 08:30:00  January, 01 2012 10:30:00  7200         02:00:00
3   January, 01 2012 09:00:00  January, 02 2012 12:00:00  97200        03:00:00 
```

请注意 3 号 27 小时时差的误导性“03:00:00”。

[在 SQL Server 中格式化经过时间的函数](https://stackoverflow.com/a/11191244/562459)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-02-04T18:59:18.363

```
DECLARE @EndTime AS DATETIME, @StartTime AS DATETIME

SELECT @StartTime = '2013-03-08 08:00:00', @EndTime = '2013-03-08 08:30:00'

SELECT CAST(@EndTime - @StartTime AS TIME) 
```

结果：`00:30:00.0000000`

按照您认为合适的方式格式化结果。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-05-27T13:45:30.517

最好和最简单的方法：

```
Convert(varchar, {EndTime} - {StartTime}, 108) 
```

就像杏里所说的那样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-11-17T09:18:38.603

使用 DATEDIFF 以毫秒、秒、分钟、小时、...为单位返回值

DATEDIFF（时间间隔，日期 1，日期 2）

**interval** *REQUIRED* - 要返回的时间/日期部分。可以是以下值之一：

```
year, yyyy, yy = Year
quarter, qq, q = Quarter
month, mm, m = month
dayofyear = Day of the year
day, dy, y = Day
week, ww, wk = Week
weekday, dw, w = Weekday
hour, hh = hour
minute, mi, n = Minute
second, ss, s = Second
millisecond, ms = Millisecond 
```

**date1, date2** *REQUIRED* - 计算两者之间差异的两个日期

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-13T15:40:26.567

看看这是否有帮助。我可以为经过的天数、小时、分钟、秒设置变量。您可以根据自己的喜好对其进行格式化或包含在用户定义的函数中。

注意：不要使用 DateDiff(hh,@Date1,@Date2)。这不可靠！它以不可预知的方式循环

给定两个日期...（示例日期：两天，三小时，10 分钟，30 秒差异）

```
declare @Date1 datetime = '2013-03-08 08:00:00'
declare @Date2 datetime = '2013-03-10 11:10:30'
declare @Days decimal
declare @Hours decimal
declare @Minutes decimal
declare @Seconds decimal

select @Days = DATEDIFF(ss,@Date1,@Date2)/60/60/24 --Days
declare @RemainderDate as datetime = @Date2 - @Days
select @Hours = datediff(ss, @Date1, @RemainderDate)/60/60 --Hours
set @RemainderDate = @RemainderDate - (@Hours/24.0)
select @Minutes = datediff(ss, @Date1, @RemainderDate)/60 --Minutes
set @RemainderDate = @RemainderDate - (@Minutes/24.0/60)
select @Seconds = DATEDIFF(SS, @Date1, @RemainderDate)    
select @Days as ElapsedDays, @Hours as ElapsedHours, @Minutes as ElapsedMinutes, @Seconds as ElapsedSeconds 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-13T19:29:11.920

`select convert(varchar, Max(Time) - Min(Time) , 108) from logTable where id=...`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-18T13:16:49.420

希望这可以帮助您获得两个时间戳之间的确切时间

```
Create PROC TimeDurationbetween2times(@iTime as time,@oTime as time) 
As  
Begin  

DECLARE @Dh int, @Dm int, @Ds int ,@Im int, @Om int, @Is int,@Os int     

SET @Im=DATEPART(MI,@iTime)  
SET @Om=DATEPART(MI,@oTime)  
SET @Is=DATEPART(SS,@iTime)  
SET @Os=DATEPART(SS,@oTime)  

SET @Dh=DATEDIFF(hh,@iTime,@oTime)  
SET @Dm = DATEDIFF(mi,@iTime,@oTime)  
SET @Ds = DATEDIFF(ss,@iTime,@oTime)  

DECLARE @HH as int, @MI as int, @SS as int  

if(@Im>@Om)  
begin  
SET @Dh=@Dh-1  
end  
if(@Is>@Os)  
begin  
SET @Dm=@Dm-1  
end  

SET @HH = @Dh  
SET @MI = @Dm-(60*@HH)  
SET @SS = @Ds-(60*@Dm)  

DECLARE @hrsWkd as varchar(8)         

SET @hrsWkd = cast(@HH as char(2))+':'+cast(@MI as char(2))+':'+cast(@SS as char(2))          

select @hrsWkd as TimeDuration   

End 
```

# php - PHP: Scanning dir for files on each load

> ID：13866851
> 
> 赞同：3
> 
> 时间：2012-12-13T19:18:53.250
> 
> 标签：php

> **Possible Duplicate:**
> [Caching readdir()](https://stackoverflow.com/questions/13622677/caching-readdir)

I have my site set up so that I have clean URLs and the files themselves are in various levels of folders. To manage it, I have the following script to direct my include farther down in the page.

```
 function listFolderFiles($dir,$exclude){
    global $flist;
    $ffs = scandir($dir); 
    foreach($ffs as $ff)
    { 
        if(is_array($exclude) and !in_array($ff,$exclude))
        { 
            if($ff != '.' && $ff != '..')
            { 
                if(!is_dir($dir.'/'.$ff))
                {       
            }
            if(is_dir($dir.'/'.$ff)) 
                {
                listFolderFiles($dir.'/'.$ff,$exclude);
            } 
            if((is_dir($dir.'/'.$ff)) != 1 && strtolower(substr($ff, strrpos($ff, '.') + 1)) == 'php')
                {
                    $name = basename($ff, ".php");
                    $flist[] .= $name;                  
                }
            }
        } 
    } 
}
listFolderFiles('content/',array('filelist.php')); 
$removing = array('_en','_es');
$pages = str_replace($removing, "", $flist);
unset($dir, $exclude, $flist);
listFolderFiles('content/Beginner/',array('filelist.php')); 
$removing = array('_en','_es');
$beginner = str_replace($removing, "", $flist);
unset($dir, $exclude, $flist);
listFolderFiles('content/Intermediate/',array('filelist.php', $beginner));
$removingi = array('_en','_es');
$intermediate = str_replace($removingi, "", $flist);
unset($dir, $exclude, $flist);
listFolderFiles('content/Advanced/',array('filelist.php', $beginner));
$removinga = array('_en','_es');
$advanced = str_replace($removinga, "", $flist); 
```

Is there a faster way to execute this code, as it is currently used on every pageload, and I only need to update it when I add a new file.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:27:11.400

除了算法改进之外，这是一个很好的缓存候选者。看起来它可以像序列化数组并将其放入文件一样简单。然后您可以决定您的到期政策是什么。伪代码：

```
if(!file_exists(CACHE_NAME) || dir_cache_expired(CACHE_NAME)) {
  // ... code to build $dirlist
  file_put_contents(CACHE_NAME, serialize($dirlist));
} else {
  $dirlist = unserialize(file_get_contents(CACHE_NAME));
} 
```

这样，您总是可以通过简单地删除缓存文件来触发缓存的重建。

# android - 将 TableLayout 从屏幕顶部隔开

> ID：13866858
> 
> 赞同：0
> 
> 时间：2012-12-13T19:19:53.673
> 
> 标签：android, xml, layout

我目前正在尝试修复我的 UI 以合并背景图像。我当前的显示器在一个 LinearLayout 中有 8 个按钮，它们垂直堆叠在一起。我想将其更改为缺少 1 个按钮的 3x3 网格，但将其与屏幕顶部隔开。

我想把它从屏幕顶部隔开的原因是图像中有作为标题的文本。这是我的布局现在看起来如何的示例...

![在此处输入图像描述](../Images/697a55a0555c9ac51ac7e9547d95b1a2.png)

标题在顶部的两个按钮后面。屏幕底部还有一些我想保留的图形。

这就是我想要复制的内容（对于我在 MS Paint 中制作的糟糕质量感到抱歉）

![在此处输入图像描述](../Images/4c0533a85c845e992989a50f2a54377a.png)

底部的`Blah Blah Blah`和 scribble 都是背景图像的一部分，因此它们不会在 XML 文件中表示。我的 XML 文件中唯一的东西需要是按钮，以及容纳它们的适当布局。有谁知道如何在布局上方/下方创建此间距？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:25:56.970

它很容易做到。使用 LinearLayout 和 layout_weight 属性。我在下面粘贴了一个示例代码，它给了我 3x2 视图。您可以根据自己的需要进行更改。

```
 <ScrollView
        style="@style/Fill"
        android:fillViewport="true" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:orientation="vertical"
            android:padding="6dip" >

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:orientation="horizontal" >

                <Button
                    android:id="@+id/home_btn_feature1"
                    style="@style/HomeButton"
                    android:drawableTop="@drawable/home_button1"
                    android:onClick="onClick"
                    android:text="@string/title_feature1" />

                <Button
                    android:id="@+id/home_btn_feature2"
                    style="@style/HomeButton"
                    android:drawableTop="@drawable/home_button2"
                    android:onClick="onClick"
                    android:text="@string/title_feature2" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:orientation="horizontal" >

                <Button
                    android:id="@+id/home_btn_feature3"
                    style="@style/HomeButton"
                    android:drawableTop="@drawable/home_button3"
                    android:onClick="onClick"
                    android:text="@string/title_feature3" />

                <Button
                    android:id="@+id/home_btn_feature4"
                    style="@style/HomeButton"
                    android:drawableTop="@drawable/home_button4"
                    android:onClick="onClick"
                    android:text="@string/title_feature4" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:orientation="horizontal" >

                <Button
                    android:id="@+id/home_btn_feature5"
                    style="@style/HomeButton"
                    android:drawableTop="@drawable/home_button5"
                    android:onClick="onClick"
                    android:text="@string/title_feature5" />

                <Button
                    android:id="@+id/home_btn_feature6"
                    style="@style/HomeButton"
                    android:drawableTop="@drawable/home_button6"
                    android:onClick="onClick"
                    android:text="@string/title_feature6" />
            </LinearLayout>
        </LinearLayout>
    </ScrollView>
</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:27:33.737

像这样可以工作，将其嵌套在现有布局中或使其成为父级并调整顶部 LL 的边距和背景以满足您的需要：

```
<LinearLayout android:layout_margin="30dp" android:layout_width="fill_parent" android:layout_height="fill_parent" android:orientation="vertical" >
    <LinearLayout android:layout_width="fill_parent" android:baselineAligned="false" android:layout_height="0dip" android:layout_weight="1" android:orientation="horizontal" >
        <Button android:layout_width="0dip" android:layout_height="fill_parent" android:layout_weight="1" />
        <Button android:layout_width="0dip" android:layout_height="fill_parent" android:layout_weight="1" />
        <Button android:layout_width="0dip" android:layout_height="fill_parent" android:layout_weight="1" />
    </LinearLayout>
    <LinearLayout android:layout_width="fill_parent" android:baselineAligned="false" android:layout_height="0dip" android:layout_weight="1" android:orientation="horizontal" >
        <Button android:layout_width="0dip" android:layout_height="fill_parent" android:layout_weight="1" />
        <Button android:layout_width="0dip" android:layout_height="fill_parent" android:layout_weight="1" />
        <Button android:layout_width="0dip" android:layout_height="fill_parent" android:layout_weight="1" />
    </LinearLayout>
    <LinearLayout android:layout_width="fill_parent" android:baselineAligned="false" android:layout_height="0dip" android:layout_weight="1" android:orientation="horizontal" >
        <Button android:layout_width="0dip" android:layout_height="fill_parent" android:layout_weight="1" />
        <Button android:layout_width="0dip" android:layout_height="fill_parent" android:layout_weight="1" />
        <Button android:layout_width="0dip" android:layout_height="fill_parent" android:layout_weight="1" />
    </LinearLayout>
</LinearLayout> 
```

# blackberry - 黑莓 CheckBoxField 中的 Stackoverflow 异常

> ID：13866860
> 
> 赞同：1
> 
> 时间：2012-12-13T19:20:11.763
> 
> 标签：blackberry, java-me, blackberry-jde

我正在实现一个简单的应用程序，用户可以在注册页面中选择新闻类别。要求如下

1.  所有的类别都是 CheckBoxField 的。用户必须至少选择一个类别。
2.  全选复选框将允许选择所有/取消选择所有类别复选框。
3.  如果用户手动选择所有复选框字段，则必须选中“全选”复选框。

方法：我在循环中创建了类别复选框。

```
for(int i=0;i<interests.length;i++){
    allFields[i] = new ColorCheckBoxField(interests[i], false, checkBoxStyle | USE_ALL_WIDTH);
    allFields[i].setCookie(i+"");
    allFields[i].setFont(bodyFont);
    allFields[i].setChangeListener(new FieldChangeListener() {
         public void fieldChanged(Field field, int context) {
            ColorCheckBoxField tempChoice = (ColorCheckBoxField)field;
            int index =Integer.parseInt(tempChoice.getCookie().toString().trim());
            //set the selection
            if(tempChoice.getChecked()){
                parent.selectInterest(index);
            }

            boolean flag = true;
            int[] intrests = parent.getSelectedInterest();
            for (int i = 0; i < intrests.length; i++) {                     
                if(intrests[i]==0){
                    flag = false;
                }
            }

            if(flag==true){
                selectAll.setChecked(flag); // select all is Checkbox object
            }else{
                selectAll.setChecked(false);
            }
        }
    });
    vfm.add(allFields[i]);
} 
```

我的 selectAll 复选框逻辑是

```
 selectAll = new ColorCheckBoxField("Select All", false, checkBoxStyle | USE_ALL_WIDTH);
        selectAll.setChangeListener(new FieldChangeListener() {         
            public void fieldChanged(Field field, int context) {
                ColorCheckBoxField temp = (ColorCheckBoxField) field;
                //if (context == FieldChangeListener.PROGRAMMATIC ) {
                    checkAll(temp.getChecked()); // it loops through all checkbox and set them checked
                //}
            }
        }); 

        innerHfm.add(selectAll); 
```

我理解这个问题，它是由于无限循环。我使用了“FieldChangeListener.PROGRAMMATIC”，但这无济于事，因为我希望现场侦听器既实用又手动地工作。我没有任何选择可以修复。任何黑客都会帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T20:09:56.300

这是正确的，你必须使用`FieldChangeListener.PROGRAMMATIC`. 但是您必须将其与兴趣复选框一起使用，而不是将其用于`selectAll`复选框。

请`FieldChangeListener`为兴趣复选框添加一项防御性检查：

```
if ( nonProgrammaticChange(context) ) {
   ColorCheckBoxField tempChoice = (ColorCheckBoxField)field;
   int index = Integer.parseInt(tempChoice.getCookie().toString().trim());
   ...
} 
```

在哪里`nonProgrammaticChange`：

```
private boolean nonProgrammaticChange (int context) {
    return (context & FieldChangeListener.PROGRAMMATIC) != FieldChangeListener.PROGRAMMATIC;
} 
```

我在您的代码中看到错误 - 如果未选中复选框，您不会明确对父级的兴趣。

对我来说，小的改进 - 使用 Vector 来存储选定复选框的索引。这将允许替换此代码：

```
boolean flag = true;
int[] intrests = parent.getSelectedInterest();
for ( int i = 0; i < intrests.length; i++ ) {                     
     if( intrests[i] == 0 ) {
          flag = false;
     }
} 
```

对此代码：

```
selectedInterestIndexes.size() == interests.length 
```

也许这会让你在其他地方的迭代更少。

同样，我会在删除重复项和代码可读性方面做更多工作。

# .net - Override a default property value in an inherited class

> ID：13866869
> 
> 赞同：1
> 
> 时间：2012-12-13T19:20:56.053
> 
> 标签：.net, vb.net, oop

Suppose I have the following parent class defined:

```
Public Class Parent

    Public Property Prop1 As String = "MyDB1"

End Class 
```

And I wish to inherit it, but want that property to have a different value for the child class.

I figured I could do it as follows:

```
Public Class Child
    Inherits Parent

    Public Sub New()
        MyBase.New()
        MyBase.Prop1 = "MyDB2"
    End Sub

End Class 
```

But I was wondering if this was the best way to do this or if there is something like an Overridable property OR if this is just bad programming practice as a whole?

Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:31:03.413

在 c# 中，为了让一个属性可以被覆盖，你可以将类成员标记为`virtual`，并且这个关键字的 vb.net 等价是`Overridable`.

```
public virtual int MyProperty {get;set;} 
```

这个属性可以在子类中被覆盖，如下所示：

```
 public override int MyProperty {
  get{ 
         //return some other thing
     }
  } 
```

**Vb.NET 等价物：**

在超级班：

```
 Public Overridable Property MyProperty As Integer
        Get

        End Get

        Set

        End Set

    End Property 
```

在子类中：

```
 Public Overrides Property MyProperty As Integer
        Get
                //return some other thing
        End Get

    End Property 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T19:38:22.943

根据您的评论，这是我的看法：

*   如果您可以控制基类，则`Overridable`如果意图是根据派生类型的业务规则更改其值，请执行此操作
*   如果您无法控制基类，并且需要“覆盖”该属性，则可以“隐藏”基类属性；在 C# 中，它看起来像`new public int MyProperty { ... }`，但我不确定这是如何在 VB 中完成的
*   如果您只需要该属性返回不同的值，那么您所做的似乎很好

# ruby - is it bad practice to use instance variables inside modules?

> ID：13866871
> 
> 赞同：1
> 
> 时间：2012-12-13T19:21:05.103
> 
> 标签：ruby

if I want to memoize the result of a method in a module, is that considered bad practice?

imagine I have a rails helper:

```
module FooHelper
  def values_for_thingie
    if some_condition && that_other_condition
      { a: "foo", b: "bar" }
    else
      { a: "bar", b: "baz" }
    end
  end
end 
```

Let's assume a rails view is going to call this helper method multiple times .. one to get the value for "a", and another to get the value of "b"... Let's also assume that some_condition is a method that does something super complicated so we don't want that to get called more than once...

This can be solved by doing:

```
module FooHelper
  def values_for_thingie
    @values_for_thingie ||= \
      if some_condition && that_other_condition
        { a: "foo", b: "bar" }
      else
        { a: "bar", b: "baz" }
      end
  end
end 
```

However, I don't like how this feels because this instance variable has nothing to do with an instance of FooHelper.. It's not really under its control. And so for that reason, it seems like this is not a good solution.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:51:40.647

如果条件在实例之间是恒定的，它可能应该是一个类/模块方法。然后，用于记忆的实例变量将是该类/方法的实例变量。没有错。或者，您可以将其保留为实例方法并使用类变量进行记忆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T22:25:07.063

您的实例变量不在您的模块中，而是在包含该模块的类的实例中。

在您的示例`@values_for_thingie`中，是在 FooHelper 中定义的，但将存在于 ActionView 实例中。

因此，如果 values_for_thingie 的结果必须在请求之间发生变化，那么您做对了。

但是，您应该考虑只记住在您的情况下需要一些时间才能运行的方法`some_condition`

# r - 将逻辑向量与要排除的其他元素相结合

> ID：13866877
> 
> 赞同：1
> 
> 时间：2012-12-13T19:21:27.653
> 
> 标签：r

我正在计算矩阵中列的逻辑向量，我想用它来查看数据的子集。我将如何结合

```
duplicate.ids <- c(1, 10, 100) 
```

和

```
data$Group == data$Group[person] & data$Unit != 13 & data$Unit != 17 
```

得到一个我可以使用的逻辑向量？

预计到达时间：

我有一个值矩阵：

```
R> class(All)
[1] "matrix"
R> dim(All)
[1] 6712 6712
R> All[1:5,1:5]
     [,1] [,2] [,3] [,4] [,5]
[1,]    0    0    0    0    0
[2,]    0    0    0    0    0
[3,]    0    0    0    0    0
[4,]    0    0    0    0    0
[5,]    0    0    0    0    0 
```

我有关于每一列的另一个元数据矩阵，我想选择这个矩阵的一个子集进行进一步分析。我可以运行第二个命令来获取一个逻辑向量，然后我可以使用它来获取一个子集

```
All[,data$Group == data$Group[person] & data$Unit != 13 & data$Unit != 17] 
```

但我也想排除一个特定的索引列表（我之前引用的duplicate.ids）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:00:52.493

您可以使用 将逻辑向量转换为索引向量`which`，然后用于`setdiff`计算集合差异，即第二个表达式选择的所有列不在重复列表中。

综合起来：

```
All[,setdiff(which(data$Group == data$Group[person] & data$Unit != 13 & data$Unit != 17),
             duplicate.ids)] 
```

作为替代方案，您也可以`duplicate.ids`变成一个逻辑向量：

```
non.duplicate <- rep(TRUE, ncol(All))
non.duplicate[duplicate.ids] <- FALSE
ALL[,non.duplicate & data$Group == data$Group[person] & data$Unit != 13 & data$Unit != 17] 
```

# database - Open / Import a DBF file into MSAccess 2003

> ID：13866880
> 
> 赞同：1
> 
> 时间：2012-12-13T19:21:39.160
> 
> 标签：database, ms-access, import

How can I open or import a dbf file into MS Access 2003? I know I can do it with Access07, but I can't use it now...

Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:40:01.293

文件 > 获取外部数据 > 导入... 然后将“文件类型”更改为“dBASE 5”、“dBASE III”或“dBASE IV”

# .htaccess - .htaccess 301 重定向基于倒数第二个和最后一个目录

> ID：13866882
> 
> 赞同：2
> 
> 时间：2012-12-13T19:21:40.327
> 
> 标签：.htaccess, redirect

我在前端开发方面做得更好，所以我非常感谢 .htaccess 301 重定向方面的帮助。

我想 301 重定向 /anything-here/rc/code/ 到 /anything-here/?rc=code

**示例 1：** //www.domain.com/any_directory/other_directory/rc/code/ 应该 301 重定向到 //www.domain.com/any_directory/other_directory/?rc=code

**示例 2：** //www.domain.com/rc/code/ 应该 301 重定向到 //www.domain.com/?rc=code

它还应该保留一个潜在的查询字符串（任意数量的变量）。

**示例 3：** //www.domain.com/any_directory/other_directory/rc/code/?variable1=value1&variable2=value2 应该 301 重定向到 //www.domain.com/any_directory/other_directory/?rc=code&variable1=value1&variable2=value2

如果倒数第二个导演不是“rc”（完全匹配），则不应重定向。

**示例 4：** //www.domain.com/any_directory/rc/other_directory/code/ 不应重定向（'rc' 不是倒数第二个目录）

**示例 5：** //www.domain.com/code/rc/ 不应重定向（'rc' 不是倒数第二个目录）

**示例 6：** //www.domain.com/arc/code/ 不应重定向（没有“rc”目录）

**示例 7：** //www.domain.com/rc/ 不应重定向（'rc' 不是倒数第二个目录）

如果缺少斜杠，我还有另一行添加斜杠，因此在这种情况下不相关。提前谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T20:38:53.520

你可以试试这个：

```
RewriteEngine On
RewriteBase /Test
RewriteCond %{REQUEST_URI}  ^(.*)/rc/(\w+)/?$
RewriteRule  ^   %1/?rc=%2&%{QUERY_STRING}  [R=301,L] 
```

当不重定向时：`http://www.domain.com/code/rc/`文件夹**rc 必须存在**，否则会生成错误 404。

您不应在查询中添加尾部斜杠。

`http://www.domain.com/any_directory/other_directory/?rc=code&variable1=value1`

不同于：

`http://www.domain.com/any_directory/other_directory/?rc=code&variable1=value1/`

最后一个`variable1=value1/`会有错误的值。

# sql - SQL - 慢游标简单存储过程

> ID：13866905
> 
> 赞同：0
> 
> 时间：2012-12-13T19:23:08.163
> 
> 标签：sql, sql-server, stored-procedures, cursor

我有一个相对简单的存储过程，但事务表中的数据量导致它需要永远运行。任何关于我可以优化查询或将其转换为不使用游标的方式的建议将不胜感激。

```
BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;

DECLARE @ItemID uniqueidentifier 

SET @CurrentCount = 0;

DECLARE @TempTransTable TABLE
(
    ID uniqueidentifier
)

-- Insert statements for procedure here
DECLARE curs_GetAllItems CURSOR LOCAL STATIC FORWARD_ONLY READ_ONLY FOR
    select 
        ID
    from 
        item
    where 
        locationid in 
            (
                -- gets corona locations
                select 
                    Locations.ID
                from Locations
                    left outer join unit
                        on unit.locationid = locations.id
                where unit.unittype = '4'
            )
        and stat not in (1,10,11,13) -- only items not in stock

    OPEN curs_GetAllItems

    FETCH NEXT FROM curs_GetAllItems INTO @ItemID
        WHILE (@@FETCH_STATUS =0)
        BEGIN
            -- Clear table to ensure accurate data
            DELETE FROM @TempTransTable

            -- Insert transaction records to delete
            -- Every transaction except the first two and the last
            INSERT INTO @TempTransTable
            select 
                ID 
            from 
                transactions 
            where 
                transactions.id not in
                    (select ID from (select top 2 * from transactions where itemid = @ItemID order by transdate asc) as t1
                    union 
                    select ID from (select top 1 * from transactions where itemid = @ItemID order by transdate desc) as t2)
                and itemid = @ItemID

            -- Delete trans records
            DELETE FROM 
                dbo.transactions 
            WHERE 
                transactions.ID in (select ID from @TempTransTable);

        -- Get next item.id
        FETCH NEXT FROM curs_GetAllItems INTO @ItemID
        END
    CLOSE curs_GetAllItems
    DEALLOCATE curs_GetAllItems
END 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T20:01:26.223

```
;with tmp as (
    select *,
           rn_asc = ROW_NUMBER() over (partition by t.itemid order by transdate asc),
           rn_desc = ROW_NUMBER() over (partition by t.itemid order by transdate desc)
      from transactions t
     where exists (
          select *
          from item i
          join Locations l on i.locationid = l.ID
          join unit u on u.locationid = l.id and u.unittype = '4'
         where i.id = t.itemid)
       and stat not in (1,10,11,13) -- only items not in stock
)
    delete tmp
     where rn_asc > 2 and rn_desc > 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T20:28:31.777

我认为你应该审查你的方法。应该可以在没有光标和循环的情况下进行管理。可能您需要使用中间临时表（考虑为其添加索引）。

另一点：如果这些查询很困难，并且它们在数据库中同时进行更改，那么您很容易遇到问题 - 锁定、超时和不一致的数据。

# java - 节点知道 Java 中其他节点的相对位置

> ID：13866906
> 
> 赞同：0
> 
> 时间：2012-12-13T19:23:10.947
> 
> 标签：java, nodes

所以我正在做一个关于Java编程的小练习，我创建了几个简单地绘制黑色背景的类，然后从中心以90度旋转画出彼此相距一定半径的圆（代码在底部邮政）。

现在，仅使用“随机”种子来确定行进方向，这总是呈下降趋势。每次。所以我现在想做的是尝试向我的圈子展示其他圈子的位置，并让他们倾向于将他们的运动转向另一个圈子（除了父圈之外，不存在另一个圈子）。我可以处理那部分，但我想要一种有效的方式在我的“节点”或“圆圈”之间传达位置。我可以用 x,y 构建一个字符串数组，并在每次构建种子时通读该列表，但这似乎是一种低效的方法。我宁愿找到某种方式，让一个圆圈可以环顾四周，并在附近找到其他圆圈。有没有办法做到这一点？我不介意一些阅读和家庭作业，我

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.RenderingHints;
import java.awt.geom.Ellipse2D;
import java.awt.geom.Line2D;
import java.awt.geom.Rectangle2D;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class FlowerOfLife extends JFrame {
    private Circle Origin = null;

    public FlowerOfLife() {
        // Default layout manager is BorderLayout.  
        // Adding graphic component to center section will expand  
        // it to fill the available space so it does not need to  
        // provide any size hints for this parent container now.  
        GraphicPanel graphicPanel = new GraphicPanel();
        add(graphicPanel);     // default center section  
        setDefaultCloseOperation(EXIT_ON_CLOSE);  
        setSize(400,400);  
        setLocation(200,200);  
        setVisible(true);   
    }

    /** 
     * Container method draws container and passes graphics context 
     * on to components for them to draw themselves. You can draw 
     * over everything in the content pane with this method... 
     */  
    public void paint(Graphics gr)  
    {  
        Graphics2D g = (Graphics2D)gr;
        // see what happens when you remove/move this next line  
        super.paint(g);  

        g.setRenderingHint(RenderingHints.KEY_ANTIALIASING,  
                            RenderingHints.VALUE_ANTIALIAS_ON);  
        int w = getWidth();  
        int h = getHeight();
        g.setPaint(Color.white);//First there is one...
        Origin = new Circle(g, w/2, h/2, ((w+h)/2)/35);
        g.setPaint(Color.white.darker());

        Circle[] circleArray = new Circle[100];
        for(int i=0;i<circleArray.length;i++){
            circleArray[i] = new Circle(g,i>0?circleArray[i-1]:Origin);
        }

    }
    public static void main(String[] args)  
    {  
        new FlowerOfLife();  
    } 

}

class Circle{
    public int x;
    public int y;
    public int r;
    private Circle next;
    private Circle last;
    private int    seed;

    public Circle(Graphics2D g, Circle c){ 
        c.next = this;
        this.last = c;
        this.r  = c.r; //Copy radius
        //We set these now, and modify the necessary ones.
        this.x = c.x;
        this.y = c.y;
        this.r = c.r;

        //Move the new circle into position based on seed.
        this.seed = (int) (Math.random()*4);
        if(this.seed==0){//Stay here, and grow a little...
//          this.r+=1;
        }else if(this.seed==1){//Move left, by r.
            this.x-=c.r;    
        }else if(this.seed==2){//Move up,   by r.
            this.y+=c.r;
        }else if(this.seed==3){//Move right,by r.
            this.x+=c.r;
        }else{//(this.seed==4) //Move down, by r.
            this.y-=c.r;
        }
        sleep((int)(Math.random())*9000+100);//Random(ish) life.
        //Draw the new circle
        g.draw(new Ellipse2D.Double(x,y,r*2,r*2));

    }
    public Circle(Graphics2D g,int x, int y, int r){
        /**
         *  The ellipse draws from the designated point, down and right.
         * The below permits the center to be declared in a more natural
         * way. Used for the first declaration.
        **/
        this.last = null; //Parent.
        this.x = x-r;
        this.y = y-r;
        this.r = r;
        this.seed = 0;
        g.draw(new Ellipse2D.Double(x,y,r*2,r*2));
    }
    private void sleep(int ms){
        try {
            Thread.sleep(ms);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
}

class GraphicPanel extends JPanel  
{  
    protected void paintComponent(Graphics g)  
    {  
        super.paintComponent(g);  
        Graphics2D g2 = (Graphics2D)g;  
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,  
                            RenderingHints.VALUE_ANTIALIAS_ON);
        g2.setPaint(Color.black);
        g2.fill(new Rectangle2D.Double(0,0,getWidth(),getHeight()));
    }  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:31:00.697

您的圈子可以存在于“板”上，这将是一个二维数组。然后，您可以为每个圆圈提供电路板的视图。你也可以让董事会决定在哪里放置下一个圆圈。

# actionlink - 具有两个 URL 参数的自定义 MapRoute 的 ActionLink

> ID：13866911
> 
> 赞同：2
> 
> 时间：2012-12-13T19:23:22.983
> 
> 标签：actionlink, url-parameters

我有一个自定义 MapRoute

```
context.MapRoute("participantByGender",
"Admin/Participants/{id}/{gender}",
new {
    controller = "Admin",
    action = "Participants",
    id = UrlParameter.Optional,
    gender = UrlParameter.Optional
} 
```

我需要一个链接来指定 id 和默认性别。我有这个，它适用于选择 id，但是我将如何更改它以在链接中包含 id 和性别？

```
@Html.ActionLink("Participants", "Participants", new { id = item.termId }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:28:43.750

只需使用：

```
@Html.ActionLink("Participants", "Participants", new { id = item.termId,gender=model.property }) 
```

# ember.js - Jasmine、Ember Views 和 Runloop：无法调用未定义的方法“appendTo”

> ID：13866913
> 
> 赞同：1
> 
> 时间：2012-12-13T19:23:34.467
> 
> 标签：ember.js, jasmine

我正在尝试为 Ember 视图编写一个基本测试，如下所示：http: [//shairez.com/2012/07/ember-js-tdd-how-to-test-your-ember-views/](http://shairez.com/2012/07/ember-js-tdd-how-to-test-your-ember-views/)但我保留得到一个“未捕获的类型错误：无法调用未定义的方法‘appendTo’。

规格：

```
describe "my view", ->

  myView = null

  beforeEach ->
    myView = Sysys.ActView.create()
    Ember.run ->
      myView.append()

  afterEach ->
    Ember.run ->
      myView.remove()
    myView = null

  it "should be defined", ->
    expect(myView).toBeDefined()

  it "should have a button", ->
    expect(myView.$("button.btn-primary").length).toEqual(1); 
```

错误来自[Ember.View.appendTo](https://github.com/emberjs/ember.js/blob/master/packages/ember-views/lib/views/view.js#L1425-L1434)：

```
this.$().appendTo(target) 
```

哪里`target`是`<body class="ember-application">...</body>` （如预期的那样）和`this`是`myView`。但是，`this.state`是“preRender”并且`this.$()`未定义，这就是发生错误的原因。

我不确定我做错了什么：我认为视图正在创建但未呈现。根据教程的建议，我也可以调用`append()`inside 。`Ember.run`

我还注意到，即使我不运行任何测试，我仍然会得到一个未捕获的异常——除了 ApplicationView 之外，它是一样的。所以我想知道我是否为测试正确初始化了所有内容。包含文件如下（使用带有资产管道的 Rails 3.2）

Spec.js.coffee

```
#=require_tree ./
#=require_tree ../../app/assets/javascripts 
```

应用程序/资产/javascripts/application.js.coffee：

```
#= require jquery
#= require jquery_ujs

#= require vendor/handlebars-1.0.0.beta.6
#= require vendor/ember-1.0.0-pre.2
#= require vendor/ember-data

#= require_self
#= require sysys
Sysys = Ember.Application.create();
#= require_tree . 
```

应用程序/资产/javascripts/syssys.js.coffee：

```
#= require ./store
#= require_tree ./models
#= require_tree ./controllers
#= require_tree ./views
#= require_tree ./helpers
#= require_tree ./templates
#= require_tree ./routes
#= require_self

Sysys.initialize() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T14:18:37.943

只有在元素被插入到 DOM 之后才能调用“this.$()”。由于您注意到您仍处于“preRender”状态，而不是 DOM（“inDom”），原因可能是“reRender”（请检查调用堆栈）。
这可能发生（例如）当使用 bindAttr 并且它绑定到的属性已经被修改时，即使视图没有插入到 DOM (*cough* call-stack *cough*)。

# oracle - Oracle：将行类型数据插入另一个表

> ID：13866915
> 
> 赞同：9
> 
> 时间：2012-12-13T19:23:40.817
> 
> 标签：oracle, plsql, insert, rowtype

我有一个名为 **event**的表，并创建了另一个具有相同列和 event 定义的全局临时表**tmp_event 。**是否可以使用 this 将事件中的记录插入 tmp_event ？

```
DECLARE
   v_record event%rowtype;
BEGIN 
   Insert into tmp_event values v_record;
END; 
```

事件表中的列太多，我想试试这个，因为我不想列出所有列。

忘了提一下：我将在触发器中使用它，这个 v_record 可以是对象**：**在 EVENT 表上插入后的新对象吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-13T19:30:06.067

要插入一行 -

```
DECLARE
   v_record event%rowtype;
BEGIN 
   SELECT * INTO v_record from event where rownum=1; --or whatever where clause
   Insert into tmp_event values v_record;
END; 
```

或者更精细的版本来插入所有行`event`-

```
DECLARE
  TYPE t_bulk_collect_test_tab IS TABLE OF event%ROWTYPE;

  l_tab t_bulk_collect_test_tab;

  CURSOR c_data IS
    SELECT *
    FROM event;
BEGIN
  OPEN c_data;
  LOOP
    FETCH c_data
    BULK COLLECT INTO l_tab LIMIT 10000;
    EXIT WHEN l_tab.count = 0;

    -- Process contents of collection here.
    Insert into tmp_event values v_record;
  END LOOP;
  CLOSE c_data;
END;
/ 
```

在触发器中，是的，它是可能的，但它就像鸡或蛋一样。您必须`rowtype`使用`:new`列值初始化 的每个字段，例如-

```
v_record.col1 := :new.col1;
v_record.col2 := :new.col2;
v_record.col3 := :new.col3;
.... 
```

显然，上面的 PLSQL 示例不能在触发器中使用，因为它会引发 mutating trigger 错误。除了像我上面解释的那样单独访问每一列之外，没有其他方法可以让您在触发器中获取整行，因此，如果您执行所有这些操作，为什么不直接`:new.col`在其`INSERT into temp_event`本身中使用，将为您节省大量工作。

* * *

另外，既然您说提及所有列需要做很多工作，（在**Oracle 11gR2**中）这是一种通过生成`INSERT`语句并动态执行它（尽管没有进行性能测试）的快速方法。

```
CREATE OR REPLACE TRIGGER event_air --air stands for "after insert of row"
AFTER INSERT ON EVENT
FOR EACH ROW
   L_query varchar2(2000);   --size it appropriately
BEGIN

   SELECT 'INSERT INTO tmp_event VALUES ('|| listagg (':new.'||column_name, ',') 
                                           WITHIN GROUP (ORDER BY column_name) ||')' 
     INTO l_query
     FROM all_tab_columns
    WHERE table_name='EVENT';

   EXECUTE IMMEDIATE l_query;

EXCEPTION
    WHEN OTHERS THEN
        --Meaningful exception handling here
END; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-07-30T06:25:57.793

有一种方法可以使用 %Rowtype e**将多行插入到表中。**

结帐下面的例子。

```
DECLARE
TYPE v_test IS   TABLE OF TEST_TAB%rowtype;
  v_test_tab v_test ;

 EXECUTE immediate ' SELECT  * FROM TEST_TAB ' bulk collect INTO v_test_tab ;
  dbms_output.put_line('v_test_tab.count -->'||v_test_tab.count);
  FOR i IN 1..v_test_tab.count
  LOOP
    INSERT INTO TEST_TAB_1 VALUES v_test_tab
      (i
      ) ;
  END LOOP;

END; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-25T13:43:01.577

总结完整的工作示例...

```
DECLARE
  TYPE t_bulk_collect_test_tab IS TABLE OF event%ROWTYPE;
  l_tab t_bulk_collect_test_tab;
  CURSOR c_data IS SELECT * FROM event;
BEGIN
  OPEN c_data;
  LOOP
    FETCH c_data
    BULK COLLECT INTO l_tab LIMIT 10000;
    EXIT WHEN l_tab.count = 0;
    FORALL i IN 1..l_tab.count
        Insert into tmp_event values l_tab(i);
    commit;
  END LOOP;
  CLOSE c_data;
END;
/ 
```

# javascript - 如果我在文本区域中按住键，如何只显示一个键

> ID：13866916
> 
> 赞同：0
> 
> 时间：2012-12-13T19:23:41.413
> 
> 标签：javascript, jquery

是否有任何可能的方法在长时间按下键时**仅**显示**一个**字符不希望这种情况发生'ssssssssssssssssssssssssssssssssssss....'。

 **并且不使用这种方法，因为这会带来一个问题，如果用户快速键入并同时按下两个键，则只会显示第二个键，例如，如果我按下“k”并按下而让“k” ' go 'p' 只有 'p' 会被显示。

```
var textarea='';

document.getElementById('textareaID').onkeydown=keydown;
document.getElementById('textareaID').onkeyup=keyup;

function keydown () {

this.value=textarea;

}

function keyup () {
textarea=this.value;
this.value=textarea;

} 
```

请不要说使用计数器，因为由于某种原因它不起作用相信我，我已经尝试了过去 3 天。

[http://toki-woki.net/lab/long-press/](http://toki-woki.net/lab/long-press/)这是我基本上想要做的，但我不明白你按住键并且只显示一个的部分是如何完成的，当然如果我按下一个键，当键按下时，我按下另一个键，它们都显示出来，休息很容易。

所以我会喜欢并解释它让我发疯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T21:43:54.660

好吧，我想我明白了。

1：在 keydown 时取消对 textarea 的输入。

2：在键盘上输入点击的字母。

```
document.getElementById('textareaID').onkeydown=keydown;
document.getElementById('textareaID').onkeyup=keyup;

// keydown is run more than once if held down hence "ssssssss"
function keydown (event) {
    // cancel input
}
// since the keyup event is only fired once we will do most of the work here
function keyup (event) {
    // insert input
} 
```

这是代码（有评论，所以你可以看到发生了什么）：http: [//jsfiddle.net/NerfAnarchist/gXVuC/](http://jsfiddle.net/NerfAnarchist/gXVuC/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T21:53:42.510

正如评论者 PA 所指出的，我认为改变文本框或文本区域的本机行为是不好的做法。在执行此操作之前，请查看您的其他选项。

...但***如果***你必须这样做：

您可以使用`keyDown`事件让事件通过，条件是它后面有一个`keyUp`事件。以下代码[基于此 fiddle](http://jsfiddle.net/remibreton/GWDEy/)。

```
​document.getElementById('box').addEventListener('keydown', function(event){
    // Superglobal window.characterPrinted to detect if the event has already fired.
    if(window.characterPrinted != true){
        window.characterPrinted = true;
        this.value += String.fromCharCode(event.keyCode);
        event.preventDefault();
    }
})​​​​​​​​;

document.getElementById('box').addEventListener('keyup', function(event){
    // Reset superglobal
    window.characterPrinted = false;
}); 
```

请注意，此代码使用`addEventListener`and `preventDefault`，不能保证在较旧的浏览器中工作。您需要使用不同的方法绑定事件。（我在看着你，IE7）。

另一个注意事项：此代码***添加***到`textarea`. 因此，如果按下一个`delete`键，它将尝试**添加**一个`delete`，它什么都不做。您可以`event.keyCode`在自己摆弄之前进行过滤以查看它是否是字母`event`，就像迈克尔建议的那样。**

# python - 是否有 Pytz 时区列表？

> ID：13866926
> 
> 赞同：877
> 
> 时间：2012-12-13T19:24:37.697
> 
> 标签：python, django, pytz

我想知道 Python 库 pytz 中 timezone 参数的所有可能值是什么。怎么做？

* * *

## 回答 #1

> 赞同：492
> 
> 时间：2012-12-13T19:49:16.070

您可以列出所有可用的时区`pytz.all_timezones`：

```
In [40]: import pytz
In [41]: pytz.all_timezones
Out[42]: 
['Africa/Abidjan',
 'Africa/Accra',
 'Africa/Addis_Ababa',
 ...] 
```

还有`pytz.common_timezones`：

```
In [45]: len(pytz.common_timezones)
Out[45]: 403

In [46]: len(pytz.all_timezones)
Out[46]: 563 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2017-01-13T16:34:11.440

**不要创建自己的列表**-`pytz`有一个内置的集合：

```
import pytz
set(pytz.all_timezones_set)  
>>> {'Europe/Vienna', 'America/New_York', 'America/Argentina/Salta',..} 
```

然后，您可以**应用时区**：

```
import datetime
tz = pytz.timezone('Pacific/Johnston')
ct = datetime.datetime.now(tz=tz)
>>> ct.isoformat()
2017-01-13T11:29:22.601991-05:00 
```

或者**，如果您已经有一个`datetime`**TZ**感知的****对象**（不幼稚）：

```
# This timestamp is in UTC
my_ct = datetime.datetime.now(tz=pytz.UTC)

# Now convert it to another timezone
new_ct = my_ct.astimezone(tz)
>>> new_ct.isoformat()
2017-01-13T11:29:22.601991-05:00 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2012-12-13T19:48:23.620

时区名称是指定时区的唯一可靠方法。

您可以在此处找到时区名称列表：[http](http://en.wikipedia.org/wiki/List_of_tz_database_time_zones) ://en.wikipedia.org/wiki/List_of_tz_database_time_zones 请注意，此列表包含许多别名，例如正确称为 America/New_York 的时区的 US/Eastern。

如果您想以编程方式从 zoneinfo 数据库创建此列表，您可以从 zoneinfo 数据库中的 zone.tab 文件编译它。我不认为 pytz 有一个 API 来获取它们，我也不认为它会很有用。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2016-07-14T11:07:37.743

这里是国家代码、名称、大洲、首都和 pytz 时区的 Python 列表。

```
countries = [
{'timezones': ['Europe/Paris'], 'code': 'FR', 'continent': 'Europe', 'name': 'France', 'capital': 'Paris'}
{'timezones': ['Africa/Kampala'], 'code': 'UG', 'continent': 'Africa', 'name': 'Uganda', 'capital': 'Kampala'},
{'timezones': ['Asia/Colombo'], 'code': 'LK', 'continent': 'Asia', 'name': 'Sri Lanka', 'capital': 'Sri Jayewardenepura Kotte'},
{'timezones': ['Asia/Riyadh'], 'code': 'SA', 'continent': 'Asia', 'name': 'Saudi Arabia', 'capital': 'Riyadh'},
{'timezones': ['Africa/Luanda'], 'code': 'AO', 'continent': 'Africa', 'name': 'Angola', 'capital': 'Luanda'},    
{'timezones': ['Europe/Vienna'], 'code': 'AT', 'continent': 'Europe', 'name': 'Austria', 'capital': 'Vienna'},
{'timezones': ['Asia/Calcutta'], 'code': 'IN', 'continent': 'Asia', 'name': 'India', 'capital': 'New Delhi'},
{'timezones': ['Asia/Dubai'], 'code': 'AE', 'continent': 'Asia', 'name': 'United Arab Emirates', 'capital': 'Abu Dhabi'},
{'timezones': ['Europe/London'], 'code': 'GB', 'continent': 'Europe', 'name': 'United Kingdom', 'capital': 'London'},
] 
```

完整列表： [Gist Github](https://gist.github.com/mjrulesamrat/0c1f7de951d3c508fb3a20b4b0b33a98)

希望能帮助到你。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-02-01T15:31:51.873

**编辑：如果您不进一步否决这个答案，我将不胜感激。**这个答案是*错误*的，但我宁愿将其保留为历史记录。虽然 pytz 接口是否容易出错是有争议的，但它可以做 dateutil.tz 不能做的事情，尤其是在过去或未来的夏令时方面。我在[“Python 中的时区”](https://yongweiwu.wordpress.com/2019/09/01/time-zones-in-python/)一文中诚实地记录了我的经验。

* * *

如果您使用的是类 Unix 平台，我建议您避免使用 pytz 并只查看 /usr/share/zoneinfo。dateutil.tz 可以利用那里的信息。

以下代码显示了 pytz 可以给出的问题。当我第一次发现它时，我感到很震惊。（有趣的是，在 CentOS 7 上 yum 安装的 pytz 并没有出现这个问题。）

```
import pytz
import dateutil.tz
from datetime import datetime
print((datetime(2017,2,13,14,29,29, tzinfo=pytz.timezone('Asia/Shanghai'))
     - datetime(2017,2,13,14,29,29, tzinfo=pytz.timezone('UTC')))
     .total_seconds())
print((datetime(2017,2,13,14,29,29, tzinfo=dateutil.tz.gettz('Asia/Shanghai'))
     - datetime(2017,2,13,14,29,29, tzinfo=dateutil.tz.tzutc()))
     .total_seconds())

-29160.0
-28800.0 
```

即 pytz 创建的时区是真正的本地时间，而不是人们观察到的标准本地时间。上海符合+0800，而不是pytz建议的+0806：

```
pytz.timezone('Asia/Shanghai')
<DstTzInfo 'Asia/Shanghai' LMT+8:06:00 STD> 
```

**编辑：**感谢 Mark Ransom 的评论和反对票，现在我知道我以错误的方式使用 pytz。总之，您不应该将结果传递`pytz.timezone(…)`给 to `datetime`，而应该将 传递`datetime`给它的`localize`方法。

尽管有他的论点（而且我没有更仔细地阅读 pytz 文档是我的坏事），但我将保留这个答案。我以一种方式回答了这个问题（如何枚举支持的时区，虽然不是用 pytz），因为我认为 pytz 没有提供正确的解决方案。尽管我的信念是错误的，但这个答案仍然提供了一些信息，恕我直言，这对对此问题感兴趣的人可能有用。Pytz 的*正确*做事方式是违反直觉的。哎呀，如果 pytz 创建的*tzinfo*不应该被 直接使用`datetime`，它应该是不同的类型。pytz 界面设计得很糟糕。**Mark提供的链接显示，很多人，不仅仅是我，都被pytz界面误导了。**

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2020-10-07T06:22:14.367

**可从 Python3.9 获得：**

zoneinfo，Python3.9 中的新模块，适用于 IANA 数据库。为了获取所有可用的时区，首先：

```
pip install tzdata 
```

接着：

```
import zoneinfo

print(zoneinfo.available_timezones()) 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-11-11T22:14:35.207

它们似乎由[此处](http://en.wikipedia.org/wiki/List_of_tz_database_time_zones)找到的*tz 数据库时区*填充。

![在此处输入图像描述](../Images/bff72b6a4074717cc715583bfbd270c5.png)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-10-15T09:17:59.083

您将在`pytz`此处找到所有支持的时区：

[https://gist.github.com/heyalexej/8bf688fd67d7199be4a1682b3eec7568](https://gist.github.com/heyalexej/8bf688fd67d7199be4a1682b3eec7568)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-01-18T15:17:49.490

对于 pytz ，可以在下面的 for 循环中使用。

```
for tz in pytz.all_timezones:
    print(tz) 
```

所以输出将是一行一行的。

```
Africa/Douala
Africa/El_Aaiun
Africa/Freetown
Africa/Gaborone
Africa/Harare 
```

如早期答案中所述，以下也是有效的。

```
print(pytz.all_timezones) 
```

它打印数组中的所有内容，

```
['Africa/Abidjan', 'Africa/Accra', 'Africa/Addis_Ababa', 'Africa/Algiers', 'Africa/Asmara', 'Africa/Asmera', 'Africa/Bamako', 'Africa/Bangui', 'Africa/Banjul', 'Africa/Bissau', 'Africa/Blantyre', 'Africa/Brazzaville', 'Africa/Bujumbura', 'Africa/Cairo', 'Africa/Casablanca', 'Africa/Ceuta', 'Africa/Conakry', 'Africa/Dakar', 'Africa/Dar_es_Salaam', 'Africa/Djibouti', 'Africa/Douala', 'Africa/El_Aaiun', 'Africa/Freetown', 'Africa/Gaborone', 'Africa/Harare', 'Africa/Johannesburg', 'Africa/Juba', 'Africa/Kampala', 'Africa/Khartoum', 'Africa/Kigali', 'Africa/Kinshasa', 'Africa/Lagos', 'Africa/Libreville', 'Africa/Lome', 'Africa/Luanda', 'Africa/Lubumbashi', 'Africa/Lusaka', 'Africa/Malabo', 'Africa/Maputo', 'Africa/Maseru', 'Africa/Mbabane', 'Africa/Mogadishu', 'Africa/Monrovia', 'Africa/Nairobi', 'Africa/Ndjamena', 'Africa/Niamey', 'Africa/Nouakchott', 'Africa/Ouagadougou', 'Africa/Porto-Novo', 'Africa/Sao_Tome', 'Africa/Timbuktu', 'Africa/Tripoli', 'Africa/Tunis', 'Africa/Windhoek', 'America/Adak', 'America/Anchorage', 'America/Anguilla', 'America/Antigua', 'America/Araguaina', 'America/Argentina/Buenos_Aires', 'America/Argentina/Catamarca', 'America/Argentina/ComodRivadavia', 'America/Argentina/Cordoba', 'America/Argentina/Jujuy', 'America/Argentina/La_Rioja', 'America/Argentina/Mendoza', 'America/Argentina/Rio_Gallegos', 'America/Argentina/Salta', 'America/Argentina/San_Juan', 'America/Argentina/San_Luis', 'America/Argentina/Tucuman', 'America/Argentina/Ushuaia', 'America/Aruba', 'America/Asuncion', 'America/Atikokan', 'America/Atka', 'America/Bahia', 'America/Bahia_Banderas', 'America/Barbados', 'America/Belem', 'America/Belize', 'America/Blanc-Sablon', 'America/Boa_Vista', 'America/Bogota', 'America/Boise', 'America/Buenos_Aires', 'America/Cambridge_Bay', 'America/Campo_Grande', 'America/Cancun', 'America/Caracas', 'America/Catamarca', 'America/Cayenne', 'America/Cayman', 'America/Chicago', 'America/Chihuahua', 'America/Coral_Harbour', 'America/Cordoba', 'America/Costa_Rica', 'America/Creston', 'America/Cuiaba', 'America/Curacao', 'America/Danmarkshavn', 'America/Dawson', 'America/Dawson_Creek', 'America/Denver', 'America/Detroit', 'America/Dominica', 'America/Edmonton', 'America/Eirunepe', 'America/El_Salvador', 'America/Ensenada', 'America/Fort_Nelson', 'America/Fort_Wayne', 'America/Fortaleza', 'America/Glace_Bay', 'America/Godthab', 'America/Goose_Bay', 'America/Grand_Turk', 'America/Grenada', 'America/Guadeloupe', 'America/Guatemala', 'America/Guayaquil', 'America/Guyana', 'America/Halifax', 'America/Havana', 'America/Hermosillo', 'America/Indiana/Indianapolis', 'America/Indiana/Knox', 'America/Indiana/Marengo', 'America/Indiana/Petersburg', 'America/Indiana/Tell_City', 'America/Indiana/Vevay', 'America/Indiana/Vincennes', 'America/Indiana/Winamac', 'America/Indianapolis', 'America/Inuvik', 'America/Iqaluit', 'America/Jamaica', 'America/Jujuy', 'America/Juneau', 'America/Kentucky/Louisville', 'America/Kentucky/Monticello', 'America/Knox_IN', 'America/Kralendijk', 'America/La_Paz', 'America/Lima', 'America/Los_Angeles', 'America/Louisville', 'America/Lower_Princes', 'America/Maceio', 'America/Managua', 'America/Manaus', 'America/Marigot', 'America/Martinique', 'America/Matamoros', 'America/Mazatlan', 'America/Mendoza', 'America/Menominee', 'America/Merida', 'America/Metlakatla', 'America/Mexico_City', 'America/Miquelon', 'America/Moncton', 'America/Monterrey', 'America/Montevideo', 'America/Montreal', 'America/Montserrat', 'America/Nassau', 'America/New_York', 'America/Nipigon', 'America/Nome', 'America/Noronha', 'America/North_Dakota/Beulah', 'America/North_Dakota/Center', 'America/North_Dakota/New_Salem', 'America/Nuuk', 'America/Ojinaga', 'America/Panama', 'America/Pangnirtung', 'America/Paramaribo', 'America/Phoenix', 'America/Port-au-Prince', 'America/Port_of_Spain', 'America/Porto_Acre', 'America/Porto_Velho', 'America/Puerto_Rico', 'America/Punta_Arenas', 'America/Rainy_River', 'America/Rankin_Inlet', 'America/Recife', 'America/Regina', 'America/Resolute', 'America/Rio_Branco', 'America/Rosario', 'America/Santa_Isabel', 'America/Santarem', 'America/Santiago', 'America/Santo_Domingo', 'America/Sao_Paulo', 'America/Scoresbysund', 'America/Shiprock', 'America/Sitka', 'America/St_Barthelemy', 'America/St_Johns', 'America/St_Kitts', 'America/St_Lucia', 'America/St_Thomas', 'America/St_Vincent', 'America/Swift_Current', 'America/Tegucigalpa', 'America/Thule', 'America/Thunder_Bay', 'America/Tijuana', 'America/Toronto', 'America/Tortola', 'America/Vancouver', 'America/Virgin', 'America/Whitehorse', 'America/Winnipeg', 'America/Yakutat', 'America/Yellowknife', 'Antarctica/Casey', 'Antarctica/Davis', 'Antarctica/DumontDUrville', 'Antarctica/Macquarie', 'Antarctica/Mawson', 'Antarctica/McMurdo', 'Antarctica/Palmer', 'Antarctica/Rothera', 'Antarctica/South_Pole', 'Antarctica/Syowa', 'Antarctica/Troll', 'Antarctica/Vostok', 'Arctic/Longyearbyen', 'Asia/Aden', 'Asia/Almaty', 'Asia/Amman', 'Asia/Anadyr', 'Asia/Aqtau', 'Asia/Aqtobe', 'Asia/Ashgabat', 'Asia/Ashkhabad', 'Asia/Atyrau', 'Asia/Baghdad', 'Asia/Bahrain', 'Asia/Baku', 'Asia/Bangkok', 'Asia/Barnaul', 'Asia/Beirut', 'Asia/Bishkek', 'Asia/Brunei', 'Asia/Calcutta', 'Asia/Chita', 'Asia/Choibalsan', 'Asia/Chongqing', 'Asia/Chungking', 'Asia/Colombo', 'Asia/Dacca', 'Asia/Damascus', 'Asia/Dhaka', 'Asia/Dili', 'Asia/Dubai', 'Asia/Dushanbe', 'Asia/Famagusta', 'Asia/Gaza', 'Asia/Harbin', 'Asia/Hebron', 'Asia/Ho_Chi_Minh', 'Asia/Hong_Kong', 'Asia/Hovd', 'Asia/Irkutsk', 'Asia/Istanbul', 'Asia/Jakarta', 'Asia/Jayapura', 'Asia/Jerusalem', 'Asia/Kabul', 'Asia/Kamchatka', 'Asia/Karachi', 'Asia/Kashgar', 'Asia/Kathmandu', 'Asia/Katmandu', 'Asia/Khandyga', 'Asia/Kolkata', 'Asia/Krasnoyarsk', 'Asia/Kuala_Lumpur', 'Asia/Kuching', 'Asia/Kuwait', 'Asia/Macao', 'Asia/Macau', 'Asia/Magadan', 'Asia/Makassar', 'Asia/Manila', 'Asia/Muscat', 'Asia/Nicosia', 'Asia/Novokuznetsk', 'Asia/Novosibirsk', 'Asia/Omsk', 'Asia/Oral', 'Asia/Phnom_Penh', 'Asia/Pontianak', 'Asia/Pyongyang', 'Asia/Qatar', 'Asia/Qostanay', 'Asia/Qyzylorda', 'Asia/Rangoon', 'Asia/Riyadh', 'Asia/Saigon', 'Asia/Sakhalin', 'Asia/Samarkand', 'Asia/Seoul', 'Asia/Shanghai', 'Asia/Singapore', 'Asia/Srednekolymsk', 'Asia/Taipei', 'Asia/Tashkent', 'Asia/Tbilisi', 'Asia/Tehran', 'Asia/Tel_Aviv', 'Asia/Thimbu', 'Asia/Thimphu', 'Asia/Tokyo', 'Asia/Tomsk', 'Asia/Ujung_Pandang', 'Asia/Ulaanbaatar', 'Asia/Ulan_Bator', 'Asia/Urumqi', 'Asia/Ust-Nera', 'Asia/Vientiane', 'Asia/Vladivostok', 'Asia/Yakutsk', 'Asia/Yangon', 'Asia/Yekaterinburg', 'Asia/Yerevan', 'Atlantic/Azores', 'Atlantic/Bermuda', 'Atlantic/Canary', 'Atlantic/Cape_Verde', 'Atlantic/Faeroe', 'Atlantic/Faroe', 'Atlantic/Jan_Mayen', 'Atlantic/Madeira', 'Atlantic/Reykjavik', 'Atlantic/South_Georgia', 'Atlantic/St_Helena', 'Atlantic/Stanley', 'Australia/ACT', 'Australia/Adelaide', 'Australia/Brisbane', 'Australia/Broken_Hill', 'Australia/Canberra', 'Australia/Currie', 'Australia/Darwin', 'Australia/Eucla', 'Australia/Hobart', 'Australia/LHI', 'Australia/Lindeman', 'Australia/Lord_Howe', 'Australia/Melbourne', 'Australia/NSW', 'Australia/North', 'Australia/Perth', 'Australia/Queensland', 'Australia/South', 'Australia/Sydney', 'Australia/Tasmania', 'Australia/Victoria', 'Australia/West', 'Australia/Yancowinna', 'Brazil/Acre', 'Brazil/DeNoronha', 'Brazil/East', 'Brazil/West', 'CET', 'CST6CDT', 'Canada/Atlantic', 'Canada/Central', 'Canada/Eastern', 'Canada/Mountain', 'Canada/Newfoundland', 'Canada/Pacific', 'Canada/Saskatchewan', 'Canada/Yukon', 'Chile/Continental', 'Chile/EasterIsland', 'Cuba', 'EET', 'EST', 'EST5EDT', 'Egypt', 'Eire', 'Etc/GMT', 'Etc/GMT+0', 'Etc/GMT+1', 'Etc/GMT+10', 'Etc/GMT+11', 'Etc/GMT+12', 'Etc/GMT+2', 'Etc/GMT+3', 'Etc/GMT+4', 'Etc/GMT+5', 'Etc/GMT+6', 'Etc/GMT+7', 'Etc/GMT+8', 'Etc/GMT+9', 'Etc/GMT-0', 'Etc/GMT-1', 'Etc/GMT-10', 'Etc/GMT-11', 'Etc/GMT-12', 'Etc/GMT-13', 'Etc/GMT-14', 'Etc/GMT-2', 'Etc/GMT-3', 'Etc/GMT-4', 'Etc/GMT-5', 'Etc/GMT-6', 'Etc/GMT-7', 'Etc/GMT-8', 'Etc/GMT-9', 'Etc/GMT0', 'Etc/Greenwich', 'Etc/UCT', 'Etc/UTC', 'Etc/Universal', 'Etc/Zulu', 'Europe/Amsterdam', 'Europe/Andorra', 'Europe/Astrakhan', 'Europe/Athens', 'Europe/Belfast', 'Europe/Belgrade', 'Europe/Berlin', 'Europe/Bratislava', 'Europe/Brussels', 'Europe/Bucharest', 'Europe/Budapest', 'Europe/Busingen', 'Europe/Chisinau', 'Europe/Copenhagen', 'Europe/Dublin', 'Europe/Gibraltar', 'Europe/Guernsey', 'Europe/Helsinki', 'Europe/Isle_of_Man', 'Europe/Istanbul', 'Europe/Jersey', 'Europe/Kaliningrad', 'Europe/Kiev', 'Europe/Kirov', 'Europe/Lisbon', 'Europe/Ljubljana', 'Europe/London', 'Europe/Luxembourg', 'Europe/Madrid', 'Europe/Malta', 'Europe/Mariehamn', 'Europe/Minsk', 'Europe/Monaco', 'Europe/Moscow', 'Europe/Nicosia', 'Europe/Oslo', 'Europe/Paris', 'Europe/Podgorica', 'Europe/Prague', 'Europe/Riga', 'Europe/Rome', 'Europe/Samara', 'Europe/San_Marino', 'Europe/Sarajevo', 'Europe/Saratov', 'Europe/Simferopol', 'Europe/Skopje', 'Europe/Sofia', 'Europe/Stockholm', 'Europe/Tallinn', 'Europe/Tirane', 'Europe/Tiraspol', 'Europe/Ulyanovsk', 'Europe/Uzhgorod', 'Europe/Vaduz', 'Europe/Vatican', 'Europe/Vienna', 'Europe/Vilnius', 'Europe/Volgograd', 'Europe/Warsaw', 'Europe/Zagreb', 'Europe/Zaporozhye', 'Europe/Zurich', 'GB', 'GB-Eire', 'GMT', 'GMT+0', 'GMT-0', 'GMT0', 'Greenwich', 'HST', 'Hongkong', 'Iceland', 'Indian/Antananarivo', 'Indian/Chagos', 'Indian/Christmas', 'Indian/Cocos', 'Indian/Comoro', 'Indian/Kerguelen', 'Indian/Mahe', 'Indian/Maldives', 'Indian/Mauritius', 'Indian/Mayotte', 'Indian/Reunion', 'Iran', 'Israel', 'Jamaica', 'Japan', 'Kwajalein', 'Libya', 'MET', 'MST', 'MST7MDT', 'Mexico/BajaNorte', 'Mexico/BajaSur', 'Mexico/General', 'NZ', 'NZ-CHAT', 'Navajo', 'PRC', 'PST8PDT', 'Pacific/Apia', 'Pacific/Auckland', 'Pacific/Bougainville', 'Pacific/Chatham', 'Pacific/Chuuk', 'Pacific/Easter', 'Pacific/Efate', 'Pacific/Enderbury', 'Pacific/Fakaofo', 'Pacific/Fiji', 'Pacific/Funafuti', 'Pacific/Galapagos', 'Pacific/Gambier', 'Pacific/Guadalcanal', 'Pacific/Guam', 'Pacific/Honolulu', 'Pacific/Johnston', 'Pacific/Kanton', 'Pacific/Kiritimati', 'Pacific/Kosrae', 'Pacific/Kwajalein', 'Pacific/Majuro', 'Pacific/Marquesas', 'Pacific/Midway', 'Pacific/Nauru', 'Pacific/Niue', 'Pacific/Norfolk', 'Pacific/Noumea', 'Pacific/Pago_Pago', 'Pacific/Palau', 'Pacific/Pitcairn', 'Pacific/Pohnpei', 'Pacific/Ponape', 'Pacific/Port_Moresby', 'Pacific/Rarotonga', 'Pacific/Saipan', 'Pacific/Samoa', 'Pacific/Tahiti', 'Pacific/Tarawa', 'Pacific/Tongatapu', 'Pacific/Truk', 'Pacific/Wake', 'Pacific/Wallis', 'Pacific/Yap', 'Poland', 'Portugal', 'ROC', 'ROK', 'Singapore', 'Turkey', 'UCT', 'US/Alaska', 'US/Aleutian', 'US/Arizona', 'US/Central', 'US/East-Indiana', 'US/Eastern', 'US/Hawaii', 'US/Indiana-Starke', 'US/Michigan', 'US/Mountain', 'US/Pacific', 'US/Samoa', 'UTC', 'Universal', 'W-SU', 'WET', 'Zulu'] 
```

* * *

## 回答 #10

> 赞同：-9
> 
> 时间：2016-08-22T08:48:43.910

在我看来，这是 pytz 库的设计缺陷。使用偏移量指定时区应该更可靠，例如

```
pytz.construct("UTC-07:00") 
```

它为您提供加拿大/太平洋时区。

# javascript - 如何使用纯 JavaScript 而不使用其他库或框架来读取文本文件或 XML 文件

> ID：13866927
> 
> 赞同：0
> 
> 时间：2012-12-13T19:24:36.750
> 
> 标签：javascript, xml

我正在尝试读取文本文件或 XML 文件，但我被卡住了。

如何传递我必须阅读的文件名。一旦我得到文件的内容，我确定我将需要使用正则表达式，但我坚持在其中获取文件名和数据。

我确定如何在 jQuery 中执行此操作，但我需要使用纯 JavaScript 进行尝试，仅此而已。任何指示或建议都会有很大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:27:59.903

由于安全原因，仅使用 JavaScript 无法可靠地读取文件名。甚至 JQuery 在某些时候也会失败（Google Chrome 倾向于阻止对本地机器的 Ajax 调用）。

编辑：一个 JSON 配置对象的例子：

```
var config =
{
    color: "blue",
    time: "15:00",
    amount: 1,
    names: ["Bob", "John"]
}

var someName = config.names[1] //John 
```

# mysql - MySQL Cluster：如何解码/解释二进制日志？

> ID：13866933
> 
> 赞同：0
> 
> 时间：2012-12-13T19:25:10.743
> 
> 标签：mysql, logging, mysqlbinlog

我徒劳地试图从我的 4 节点 MySQL 集群的二进制日志中获取一些有用的信息。作为测试，我在上午 11:01 在主服务器上手动执行了一条 UPDATE 语句（它确实成功地更改了表中的一些数据）。不幸的是，我无法让 mysqlbinlog 向我展示执行的语句。

我尝试了 --verbose 选项、--hexdump 选项和 --base64-output=DECODE-ROWS --verbose。不管我做什么，实际的语句似乎仍然被编码（或者当应该有更新时有一个 INSERT INTO）。

下面是我上午 11:01 测试的相关输出，指定了 --base64-output=DECODE-ROWS --verbose 选项。为什么找不到我的 UPDATE 语句？而且，如果数据库将其优化为 INSERT INTO，为什么我至少看不到表名和原始语句的其他部分？

```
# at 1744
#121213 11:01:56 server id 1  end_log_pos 1808  Query   thread_id=0     exec_time=0   error_code=0
SET TIMESTAMP=1355425316/*!*/;
BEGIN
/*!*/;
# at 1808
# at 1899
# at 1961
# at 2022
#121213 11:01:56 server id 1  end_log_pos 1899  Table_map: `source_words`.`players` mapped to number 1826
#121213 11:01:56 server id 1  end_log_pos 1961  Table_map: `mysql`.`ndb_apply_status` mapped to number 1817
#121213 11:01:56 server id 1  end_log_pos 2022  Write_rows: table id 1817
#121213 11:01:56 server id 1  end_log_pos 2071  Write_rows: table id 1826 flags: STMT_END_F
### INSERT INTO mysql.ndb_apply_status
### SET
###   @1=1
###   @2=14197993649471490
###   @3=''
###   @4=0
###   @5=0
### INSERT INTO source_words.players
### SET
###   @1='834770J\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x17yê\x00\x00\x17yê\x00\x00 \x00\x00\x00\x00\x00\x00\x00À'
###   @6=0
# at 2071
#121213 11:01:56 server id 1  end_log_pos 2136  Query   thread_id=0     exec_time=0   error_code=0
SET TIMESTAMP=1355425316/*!*/;
COMMIT
/*!*/;
DELIMITER ;
# End of log file
ROLLBACK /* added by mysqlbinlog */;
/*!50003 SET COMPLETION_TYPE=@OLD_COMPLETION_TYPE*/; 
```

谢谢，罗伯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:31:34.493

二进制日志记录的是什么改变，不一定是什么语句导致它（或者如果更新没有更新任何东西，也不会显示任何内容）。如果您的`BINLOG_FORMAT`is `STATEMENT`， al 将是语句， for `ROW`& `MIXED`，您将在 MySQL 认为合适的位置和时间获得这些条目。binlog 不用于监视/检查数据库上的查询（为此使用通用查询日志），binlog 仅用于记录数据的更改，因此您可以可靠地恢复备份或使用复制。它从未打算供人类阅读。

另请注意，可能会设置和不会记录哪些设置，并且您的“默认架构”对连接有很大影响。如果您真的错过了一个声明（请注意旧日志会被轮换），我建议您`SHOW VARIABLES LIKE '%binlog%';`

# jquery - jquery宽度整数，不是小数

> ID：13866934
> 
> 赞同：0
> 
> 时间：2012-12-13T19:25:19.013
> 
> 标签：jquery, variables

我正在尝试获取变量的值并将其用于元素的宽度，但我想从中删除小数并使其成为整数。我到了这里，但似乎无法让它工作

```
var grid_width= width:($(window).width() / 270)

$("#grid").css({
    width: grid_width.toFixed(0)
}); 
```

JS：

```
<script>

$('#grid').isotope({
  // options
  itemSelector : '.iso',
  masonry: {
    columnWidth: 270
  },
  animationEngine : 'jquery'
});

var grid_width = $(window).width() / 270;

$("#grid").css({
    width: Math.floor( grid_width ) + 'px',
    background: "green"
});

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:26:48.290

尝试这个

```
var grid_width = $(window).width() / 270;

$("#grid").css({
    width: Math.floor( grid_width ) + 'px'
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:40:18.850

将数字解析为对应的整数：

```
$("#grid").css({
    width: parseInt(grid_width)
}); 
```

# c# - 使用 jQuery 加载数据库的搜索引擎优化

> ID：13866938
> 
> 赞同：1
> 
> 时间：2012-12-13T19:25:29.620
> 
> 标签：c#, jquery, sql, database, seo

我目前正在针对搜索引擎优化我的网站。它主要是一个数据库驱动的站点。我在后端使用 C#，但数据库内容是通过 jQuery ajax 和 Web 服务加载的。因此，我的数据库内容不在 html 中，机器人会抓取它。我的网站有点像在线超市格式，因为我的数据库中有数千个项目，用户可以一次将其中一个或多个加载到网页上，加载项目后页面不会发生显着变化。

我的问题是，（*如果有的话*）我怎样才能让我的数据库内容被索引？我正在考虑有一个链接到一个 aspx 页面（*例如称为 mydatabase*）的锚点，它将我的所有数据库项加载为一个大的 html 列表。然后，使用 jQuery，我会让锚点对用户不可见。用户仍然可以访问数据，但不能通过此链接访问数据，可以使用我创建的 jQuery 界面访问数据。

问题是，我真的不希望用户看到这个大而杂乱的列表 - 谷歌结果是否会将此页面显示`www.mysite.com/mydatabase.aspx`为搜索结果？谷歌还会将此视为“关键字丰富”的垃圾邮件页面吗？我做了很多研究，但对此一无所获。仅针对 php 的说明。请帮助我不确定该怎么做，需要知道解决这个问题的最佳方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T22:40:18.380

遗憾的是您没有采用[渐进式增强](http://www.alistapart.com/articles/understandingprogressiveenhancement/)方法，因为这意味着您将从可抓取的标准 HTML 输出开始，然后在顶部添加分层行为 (AJAX) 以获得用户体验。

提供以列表格式列出所有产品的单个文件（例如 mydatabase.aspx）并没有提供真正的价值，因为您给出的原因是 - 它只是一个无用的大列表。每个链接等没有编辑内容相关性。

你最好再看看你的信息架构，并尝试确保每个产品都可以通过它自己的唯一 URL 访问，然后将产品分类为组（结果页面），小心考虑分页。

您仍然可以使用 AJAX 使其像单页应用程序一样工作，但您需要查看[HTML5 的 History API](https://stackoverflow.com/questions/4015613/good-tutorial-for-using-html5-history-api-pushstate)以以搜索引擎友好的方式实现此目的。

# war - 如何在 apache-karaf 启动时部署战争

> ID：13866939
> 
> 赞同：1
> 
> 时间：2012-12-13T19:25:30.977
> 
> 标签：war, apache-karaf

我创建了一个战争文件，通过运行 osgi:install 命令在 karaf 中部署，例如

```
osgi:install -s file:/system/com/mywebapp/1.0.0/mywebapp-1.0.0.war 
```

如何配置 karaf 以便在 karaf 实例启动时发生这种情况？

我已更改 org.apache.karaf.features.cfg 文件以默认启动战争功能

```
featuresBoot=config,ssh,management,kar,war 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T19:37:28.630

这是一个战争文件的示例 features.xml -

```
<?xml version="1.0" encoding="UTF-8"?>
<features name="feature-set">
    <feature name="my-feature" version="1.0.0"
        xmlns="http://karaf.apache.org/xmlns/features/v1.0.0">

        <feature>war</feature>
        <bundle>mvn:com.foo/mywebapp/1.0.0/war</bundle>
    </feature>
</features> 
```

重要的部分是war文件“mvn:com.foo/mywebapp/1.0.0/war”的mvn url。如果您错过了路径中的后缀 /war，maven url 会查找 jar 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T07:58:00.047

最好创建您自己的功能文件并从此功能文件开始您的战争，您还可以设置启动级别及其依赖项。另一种部署方式是将您的战争放在部署文件夹中。

# jquery - $(this).find(':nth-child(2)') 上的 jquery 选择器混淆

> ID：13866940
> 
> 赞同：2
> 
> 时间：2012-12-13T19:25:36.050
> 
> 标签：jquery, selector

我对 jquery 和选择器有点困惑。

在这个网站[http://pelloponisos.telesto.gr/](http://pelloponisos.telesto.gr/)我正在建立一个主菜单。我想要的只是使直接子菜单（主菜单中每个 li 的第二个子菜单）出现在鼠标悬停时并在鼠标悬停时隐藏。

使菜单在鼠标悬停时工作的 jquery 代码是：

```
$("#access ul li").mouseover(function(){
    $(this).find(':nth-child(2)').show();
    }).mouseout(function(){
        $(':nth-child(2)',this).hide();
    }); 
```

但正如您所看到的，代码匹配每个第二个孩子，从而一次展开所有子菜单。

有人可以指出我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:29:08.510

您可以尝试使用直接子选择器：

```
$(this).find('> :nth-child(2)').show(); 
```

或者：

```
$("#access ul li").hover(function(){
    $('> :nth-child(2)', this).toggle();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:31:18.060

试试这样

```
$(this).children(":eq(1)").show() 
```

# c - 在C中将文件1的内容添加到文件2

> ID：13866943
> 
> 赞同：-6
> 
> 时间：2012-12-13T19:25:45.660
> 
> 标签：c

我正在尝试在第二个文件（b.txt）的末尾添加第一个文件（a.txt）的内容......但我不知道该怎么做。我有以下代码。

```
 int i = 0;
        char delims[] = " \n";
        char *result = NULL;
        char * results[10];
        result = strtok( cmdStr, delims );
        while( result != NULL ) {
            results[i] = result;
            i++;
            result = strtok(NULL, " \n");
        }

        // results[1] shows a.txt
        // results[2] shows b.txt

        FILE *fp;
        char ch;

        if((fp = fopen(results[1],"r")) == NULL) {
            printf("Cannot open file.\n");
        } else {
            ...
            // add the content of results[1] in the end of results[2]
            ...
        }
        fclose(fp); 
```

Results[1] 是文件 a.txt 的名称。Results[2] 是文件 b.txt 的名称。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:33:24.977

`results[2]`以追加模式打开：

```
FILE *fp2;

fp2 = fopen(results[2], "a");  // a is for append 
```

然后你可以遍历第一个文件并转储到第二个文件..类似于：

```
char line[100] = {0};
while (fgets(line,sizeof(line),fp) != NULL)
  fputs(line, fp2); 
```

* * *

**编辑：**这是一个完整的编译程序，它获取“test.txt”的内容并将其附加到“test2.txt”：

```
int main(int argc, char** argv) {
    FILE *fp;
    FILE *fp2;
    char line[100] = {0};
    char * results[2] = {"test.txt", "test2.txt"};
    fp = fopen(results[0], "r");
    fp2 = fopen(results[1], "a");  // a is for append

    while (fgets(line,sizeof(line),fp) != NULL)
       fputs(line, fp2);
    fclose(fp);
    fclose(fp2);
    return 0;
} 
```

# php - PDO PHP在BetweenPlaceholders中添加“AND”

> ID：13866946
> 
> 赞同：3
> 
> 时间：2012-12-13T19:25:59.457
> 
> 标签：php, mysql, pdo

我想在我的 sql 查询的键和值对参数之间添加“AND”，但我不知道如何。我已经尝试搜索网络但无法找到解决方案。

```
 $cdatahome = fetchCategory(array("status"=>"1","home"=>"1")); 

       function fetchCategory(array $conditions){
        $db = Core::getInstance();

            $sql = "SELECT id, title FROM ruj_category WHERE ";

            $params = array();
            foreach ($conditions as $column => $value) {
            if (preg_match('/^[a-z-.]+$/', $column)) {

            $sql .= "$column = ?";
            $params[] = $value;

     }
    }           
            $sql .= " order by title asc";  
            $res = $db->dbh->prepare($sql);
            $res->execute(array_values($params));
                $res = $res->fetchAll(PDO::FETCH_ASSOC);        

            return $res; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T19:30:26.130

```
$where = array();
foreach ($conditions as $column => $value) {
    if (preg_match('/^[a-z-.]+$/', $column)) {
        $where[] = "$column = ?";
        $params[] = $value;
    }
}
$sql .= implode(' AND ', $where); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:29:05.883

通常，当我想放置**AND**或**&**（在 URL 的情况下）之类的东西时，我会创建一个数组并将它内爆到我想要的字符串中间。例如：

```
$items = array("a", "b", "c");

$output = implode(" AND ", $items); 
```

输出：

```
"a AND b AND c" 
```

在您的情况下，您可以执行 foreach 循环来构建字符串片段，然后在第二个答案列出的函数中使用**AND**作为胶水。`implode()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T19:31:16.710

```
$cdatahome = fetchCategory(array("status"=>"1","home"=>"1")); 

   function fetchCategory(array $conditions){
    $db = Core::getInstance();

        $sql = "SELECT id, title FROM ruj_category WHERE ";

        $params = array();
        $i = 0;
        foreach ($conditions as $column => $value) {
        if (preg_match('/^[a-z-.]+$/', $column)) {
        if($i != 0){
        $sql .= ' AND ';
        }
        $sql .= "$column = ?";
        $params[] = $value;
        $i++;
 }
}           
        $sql .= " order by title asc";  
        $res = $db->dbh->prepare($sql);
        $res->execute(array_values($params));
            $res = $res->fetchAll(PDO::FETCH_ASSOC);        

        return $res; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T19:33:03.137

首先，您可以将条件放入一个数组中，就像对 $params 的值一样。喜欢`$cond[]="$column = ?"`然后`$sql.=implode(' AND ',$cond);`

在你的 foreach 中解决它：在循环集之前`$first=false;`和循环中做`$sql.=($first?'':' AND ')."$column = ?"; $first=false;`

# windows - 我可以在批处理文件中使用 FIND 命令将变量用作搜索字符串吗？

> ID：13866947
> 
> 赞同：2
> 
> 时间：2012-12-13T19:26:02.287
> 
> 标签：windows, variables, for-loop, batch-file, find

我有一个批处理文件，我想比较两个文本文件（test1.txt 和 test2.txt）的内容。我希望它搜索 test1.txt 中的每个条目并查找 test2.txt 中的每个条目并告知是否已找到该条目。我一直在寻找一些输入，但似乎无法提出任何有用的信息。

例如test1.txt包含：红蓝绿橙

并且 test2.txt 包含：红色蓝色橙色

理想情况下，我希望它告诉我它找不到“绿色”...

我在想它应该是这样的：

```
@ECHO OFF

FOR /F %%A IN (C:\test1.txt) DO (
    FIND /I %%A C:\test2.txt
    IF %ERRORLEVEL% EQU 0 (ECHO Sring found!) ELSE (ECHO string not found!)
) 
```

...但这并不能证明对我有多大帮助。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T20:08:00.003

您的代码有两个问题：

1) FIND 命令需要引用搜索字符串。

2）你的逻辑几乎是正确的。`%ERRORLEVEL%`解析行时，问题被扩展，并且整个带括号的 DO() 块被解析一次。所以它总是扩展为在 FOR 循环执行之前存在的值——而不是你想要的。

有许多简单的解决方案。

使用延迟扩展

```
@ECHO OFF
setlocal enableDelayedExpansion
FOR /F %%A IN (C:\test1.txt) DO (
  FIND /I "%%A" C:\test2.txt
  IF !ERRORLEVEL! EQU 0 (ECHO Sring found^^!) ELSE (ECHO string not found^^!)
) 
```

使用 IF ERRORLEVEL（如果 errorlevel 为 1 或更大，则 IF ERRORLEVEL 1 为真）

```
@ECHO OFF
FOR /F %%A IN (C:\test1.txt) DO (
  FIND /I "%%A" C:\test2.txt
  IF NOT ERRORLEVEL 1 (ECHO Sring found!) ELSE (ECHO string not found!)
) 
```

使用`&&`和`||`条件运算符

```
@ECHO OFF
FOR /F %%A IN (C:\test1.txt) DO (
  FIND /I "%%A" C:\test2.txt && (ECHO Sring found!) || (ECHO string not found!)
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T21:24:36.110

您可以使用`findstr`参数 /V 打印不包含匹配项的行，使用 /G 从文件中读取搜索字符串。正如 dbenham 建议的那样，最好还添加 /L 选项以强制进行文字搜索，如下所示：

```
findstr /L /V /G:text2.txt text1.txt 
```

这将打印所有`text1.txt`不存在的行`text2.txt`

# android - 尝试以编程方式从相机设置位图时，GestureImageView 变为空白

> ID：13866950
> 
> 赞同：0
> 
> 时间：2012-12-13T19:26:12.473
> 
> 标签：android, imageview, gestures

我正在使用： [https ://github.com/jasonpolites/gesture-imageview](https://github.com/jasonpolites/gesture-imageview)

*   在加载应用程序时，它在 GestureImageView 中有一个占位符图像，可以适当地捏/缩放。我有一个按钮，当单击时会触发相机意图，保存文件，然后我希望将该图像设置为手势图像视图中使用的源位图。

    GestureImageView imageView = (GestureImageView) findViewById(R.id.imageViewOne);

    ```
    ContentResolver cr = getContentResolver();

    getContentResolver().notifyChange(imageUriOne, null);

                    try {
    Bitmap mybitmap =  android.provider.MediaStore.Images.Media.getBitmap(cr, imageUriOne);

     imageView.setImageBitmap(mybitmap); 
    ```

    }

对于正常的图像视图，这是有效的。但是对于 GestureImageView，一旦从相机意图返回，图像就会保持原样，如果被触摸，图像就会消失。

为了检查问题不是位图，我试过了

```
int idTwo=getResources().getIdentifier("com.jazz.test1:drawable/second_photo", null, null);

imageView.setImageResource(idTwo); 
```

即将图像视图设置为现有资源，但这有同样的问题。

如果我在意图*之前*调用该 setImageResource 代码，它确实有效。

任何想法如何调试？日志中没有错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:52:47.097

分辨率在这里：

[https://github.com/jasonpolites/gesture-imageview/issues/21](https://github.com/jasonpolites/gesture-imageview/issues/21)

*   当我最初查看 github 问题时并没有注意到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-25T07:46:06.570

您必须替换您的**initMethod**函数。使用此代码，它将正常工作（**com.polites.android 包中的 GestureImageView.java**文件）。

```
protected void initImage() {
        if (this.drawable != null) {
            this.drawable.setAlpha(alpha);
            this.drawable.setFilterBitmap(true);
            if (colorFilter != null) {
                this.drawable.setColorFilter(colorFilter);
            }
            // Keppel.Cao
            layout = false;
            startingScale = -1.0f;
        }

        if (!layout) {
            requestLayout();
            // Keppel.Cao
            // redraw();
            reset();
        }
} 
```

就像戴夫说的。更多你可以在这里找到[第 21 期](https://github.com/jasonpolites/gesture-imageview/issues/21)

# python - 如何从 Django 模板中的 PK 获取对象？

> ID：13866952
> 
> 赞同：15
> 
> 时间：2012-12-13T19:26:14.137
> 
> 标签：python, django, django-templates

在 django 模板中，我想使用对象的 pk 获取对象的名称。例如，假设我有来自 class 的 pk 对象`A`，我想做如下的事情：

```
{{ A.objects.get(pk=A_pk).name }} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-13T19:49:42.887

[来自Django 模板语言](https://docs.djangoproject.com/en/dev/topics/templates/)的文档：

[访问方法调用](https://docs.djangoproject.com/en/dev/topics/templates/#accessing-method-calls)：

> 因为 Django 有意限制模板语言中可用的逻辑处理量，所以无法将参数传递给从模板中访问的方法调用。数据应该在视图中计算，然后传递给模板进行显示。

所以你看，你应该在你的`views.py:`

```
def my_view(request, A_pk):
    ...     
    a = A.objects.get(pk=A_pk)    
    ...
    return render_to_response('myapp/mytemplate.html', {'a': a}) 
```

在您的模板中：

```
{{ a.name }}
{{ a.some_field }}
{{ a.some_other_field }} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-18T06:50:28.613

如果需要，您可以添加自己的标签。像这样：

```
from django import template
register = template.Library()

@register.simple_tag
def get_obj(pk, attr):
    obj = getattr(A.objects.get(pk=int(pk)), attr)
    return obj 
```

然后在模板中加载标签

```
{% load get_obj from your_module %} 
```

并使用它

```
{% get_obj "A_pk" "name" %} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T19:50:36.507

你不能在 Django 中做到这一点。[从文档：](https://docs.djangoproject.com/en/dev/topics/templates/#accessing-method-calls)

> 因为 Django 有意限制模板语言中可用的逻辑处理量，所以无法将参数传递给从模板中访问的方法调用。数据应该在视图中计算，然后传递给模板进行显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T22:05:15.140

目前尚不清楚您要完成什么，但您应该弄清楚如何在视图中实现所需的结果并将变量或对象发送到模板。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-13T05:10:13.983

1.  在模块内创建名为“templatetags”的文件夹。

2.  在模板标签中创建“anyname.py”

任何名字.py

```
from django import template
from Clients.models import Client
register = template.Library()
@register.filter
def get_client_name(pk, attr):
    obj = getattr(Client.objects.get(id=pk),attr)
    return obj 
```

现在在模板中添加

```
{% load get_client_name from anyname %}
{{project.Client_id|get_client_name:'Name_of_client' }} 
```

您也可以查看 [自定义标签上的 django 文档](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/)

# java - 缺少方法体，或在 Java 中声明抽象

> ID：13866953
> 
> 赞同：6
> 
> 时间：2012-12-13T19:26:15.047
> 
> 标签：java

我是 Java 新手，并试图在我的计算机上运行。

一个简单的“hello world 程序”调用方法失败

```
class helloworld
{   
    public static void main(String[] param)
    {
        helloWorld();
        System.exit(0);
    }

    public static void helloWorld();
    {
        System.out.println("hello world");
    }
} 
```

我收到以下错误：

```
.\helloworld.java:11: error: missing method body, or declare abstract
       public static  void helloworld();
                           ^ 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-13T19:27:00.450

删除此行末尾的分号：`public static void helloWorld();`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T19:28:10.893

这一行：

```
public static void helloWorld(); 
```

是你的问题。以分号结束函数意味着您希望它是抽象的并且没有主体。这类似于如何声明接口中的方法，或者如果它们被标记为抽象，即没有主体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-31T11:51:01.247

在此代码行中：

`public static void helloWorld();` 删除分号。

让它像这样：

`public static void helloWorld()`

为进一步避免此错误，请执行以下操作：

`public static void helloWorld() {`

同一行中的左大括号将使错误检测更容易。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-07-24T23:11:31.483

首先你关注你的错误..错误的解决方案是（

```
abstract class HelloWorld
{
public abstract void(String[] args); 
```

你应该试试这个；）

# sql - 获取最后一行的总和，好习惯吗？

> ID：13866955
> 
> 赞同：1
> 
> 时间：2012-12-13T19:26:16.970
> 
> 标签：sql, sql-server, sql-server-2008

我正在使用 sql server 2008。我正在执行一个将由 SSIS 使用的查询。

我有一个选择的数据：

```
 Master_Code   Jan 
    1            4
    2            5 
```

我想在最后一行添加一个总数，如下所示：

```
 Master_Code   Jan 
    1            4
    2            5
    Total        9 
```

是从 sql 执行此操作的好习惯，还是应该从 SSIS 执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:28:33.493

您可以使用`UNION ALL`. 关键是该`master_code`字段必须与字符串的数据类型相同，`total`因此您必须对其进行转换：

```
select cast(master_code as varchar(10)) master_code, jan
from yourtable
union all
select 'Total', sum(jan)
from yourtable 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/1dd04/2)

或者您可以使用`GROUP BY with ROLLUP`：

```
select 
  case 
    when master_code is not null 
    then cast(master_code as varchar(10)) else 'total' end master_code, 
  sum(jan) Jan
from yourtable
group by master_code with rollup 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/1dd04/8)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:37:59.003

查看您的查询，似乎数据类型必须不同（`int`vs`varchar`或`null`可能），这使其成为 SQL 端的一个非常值得商榷的选择。我的意思是从查询重用角度来看，特殊值真的很糟糕。

因此，理想情况下，我会进行两个不同的查询（一个查询详细信息，一个查询总计），都在 SQL Server 中运行并使用 SSIS 在数据转换中合并结果。这可能是最有效和最干净的方式。

# excel - 使用 vbscript 添加时间值

> ID：13866956
> 
> 赞同：1
> 
> 时间：2012-12-13T19:26:21.127
> 
> 标签：excel, vbscript, vba

我可以知道有什么方法可以直接添加两个或多个持续时间吗？还有一件事：它们位于已定义或评估并存储在这些列中的每一行的 Excel 列中。它们以 dd:hh:mm 格式存储在 Excel 列中。无需为每一行逐列添加，是否有任何技术可以通过搜索它们的格式直接添加它们并将它们放入另一列作为它们的总和？

10:23:10（日：时：分）。

***更新***

```
PID     T1Nm             T1SD                   T1FD                T1TotTime     T2Nm        T2SD                     T2FD              T2TotTime      TotalTaskDuration

 10      T1      9/27/2012  12:53:03 PM   9/3/2012  1:52:20 PM       23:23:0      T2   9/26/2012  5:55:32 PM    9/14/2012  1:52:20 PM      12:4:3

 20      T1      9/6/2012  8:29:34 AM     9/17/2012  8:59:36 AM      11:0:30      T4   9/26/2012  5:55:32 PM    9/14/2012  1:52:20 PM      12:4:3 
```

在这里，我只是尝试为您提供图表视图，以便您了解我在寻找什么。每列可以有不同的时间格式。所以我们只需要捕获 dd:hh:mm 格式并将它们相加并需要将其存储到最后一列。希望这个描述能帮助你理解我的整个事情我正在寻找。

***编辑：*** 获取所有列的总时间计算是相同的。请建议修复。 ***意外输出***

![在此处输入图像描述](../Images/ec0aeb6bc52dc1c3d33216d0a5130972.png)

***更新***

格式仍然错误：

![在此处输入图像描述](../Images/1deb4f76f644bf49837a67550733a933.png)

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T05:34:34.530

电子表格/代码示例：[http ://www.bumpclub.ee/~jyri_r/Excel/Summing_time_differences.xls](http://www.bumpclub.ee/~jyri_r/Excel/Summing_time_differences.xls)

```
Sub CalculateTotalTimes()

  Dim rng As Range
  Dim column_counter As Long
  Dim row_counter As Long
  Dim time_sum() As Variant
  Dim dest_rng As Range
  Dim x As Variant

 Set rng = ActiveSheet.UsedRange

 ReDim time_sum(rng.Rows.Count)

     For row_counter = 1 To rng.Rows.Count
         time_sum(row_counter - 1) = 0
           For column_counter = 1 To rng.Columns.Count - 1 'TotalTaskDuration is the last column, not counted
              If rng(row_counter, column_counter).NumberFormat = "dd:hh:mm" Then
                time_sum(row_counter - 1) = time_sum(row_counter - 1) + rng(row_counter, column_counter).Value2
              End If
           Next
     Next
       x = LBound(time_sum)
         For x = LBound(time_sum) To UBound(time_sum) - 1
            time_sum(x) = time_sum(x + 1)
         Next

   ReDim Preserve time_sum(UBound(time_sum) - 1)

   Set dest_rng = ActiveSheet.Cells(2, rng.Columns.Count)
    Set dest_rng = dest_rng.Resize(UBound(time_sum), 1)
  dest_rng.Value = Application.WorksheetFunction.Transpose(time_sum)

End Sub 
```

# c++ - 函数级别的部分模板类专业化

> ID：13866957
> 
> 赞同：2
> 
> 时间：2012-12-13T19:26:26.013
> 
> 标签：c++, templates

> **可能重复：**
> [具有多个模板参数错误的模板部分特化](https://stackoverflow.com/questions/7881362/template-partial-specialization-with-multiple-template-argument-error)

是否可以将模板类专门化为功能级别？

我会给你和我想要实现的例子，但我得到编译错误：

```
template<typename T1, typename T2>
class C
{
    public:
        void f();
};

template<typename T1, typename T2>
void C<T1, T2>::f()
{
}

template<typename T1, int>
void C<T1, int>::f()
{
} 
```

错误：

```
template argument list following class template name must list parameters in the order used in template parameter list
'void C<T1,T2>::f(void)' : function template has already been defined
'C<T1,T2>': template parameter 'T2' is incompatible with the declaration 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T20:25:06.477

如果您想使`C::f`依赖的行为`T2`可以尝试将其实现放入一个单独的类中，如下所示：

```
template <typename T>
class C_aux
{
public:
    void f() {}
};

template <>
class C_aux<int>
{
    void f() {}
};

template <typename T1, typename T2>
class C
{
    public:
        void f();
};

template <typename T1, typename T2>
void C<T1, T2>::f()
{
    C_aux<T2>::f();
} 
```

根据您需要的详细信息，`C_aux::f`必须采用额外的参数。或者你可以让`class C`继承自`class C_aux`，反之亦然。

# mysql - RDBMS 的加权投票处理

> ID：13866959
> 
> 赞同：0
> 
> 时间：2012-12-13T19:26:32.067
> 
> 标签：mysql, sql, algorithm, vote, weighted-average

我的 RDBMS（通常是 MySQL 或 Postgresql）中有三个表，我想在计算选票时使用它们。第一个是用户表，其中用户有不同程度的拉动（权重），第二个是记录他们对项目的投票的表，第三个是项目表本身。

**这个想法是，版主或使用时间较长的用户在投票时应该有更多的“权重”。**

```
USER {
    id,
    weight int,
}

VOTE {
    vote int,
    user_id,
    item_id,
}

ITEM {
    id
} 
```

除了投票数之外，我还想根据用户投票的权重来计算项目的投票。因此，如果用户 100 和 101 的权重均为 1 并且投票得分为“3”，并且权重为 10 的用户 102 出现并投票“5”，那么我们为该用户 102 的投票分配更多的价值。

也许一些简单的事情，比如所有用户的总用户权重被用来划分选票。

```
(user:weight * vote) / sum(user:weight)) 
```

也许我应该使用其他公式来曲线系统中权重最大的用户的力量。

考虑到用户的权力等第三个变量，我如何计算投票？

对于那件事，我应该如何计算重量？也许我可以将所有用户的总权重相加，然后除以用户总数来找到一个平均权重，我可以用来给用户一个介于 1 到 100 之间的权重，这样更容易使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T19:39:11.680

您可以在聚合中进行算术运算：

```
select v.item_id,
       (case when sum(u.weight) > 0 then sum(u.weight * v.vote) / sum(u.weight) end) as weightedVote
from vote v join
     user u
     on v.user_id = u.id
group by v.item_id 
```

*如何*计算权重是另一回事。该查询显示了如何使用它们。

# iphone - 如何在ios中绘制电池

> ID：13866961
> 
> 赞同：0
> 
> 时间：2012-12-13T19:26:38.353
> 
> 标签：iphone, ios, core-graphics, quartz-graphics

我想画一个电池来显示我的一个通过蓝牙连接到手机的设备的电池电量。

我怎样才能做到这一点？我是一个 2d 绘图的菜鸟....任何指针都是有帮助的

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:29:45.663

> 我想画一个电池来显示我的一个通过蓝牙连接到手机的设备的电池电量。

编写代码来绘制像电池这样的非缩放静态图像似乎很麻烦。当然，您可以这样做，但是在绘图程序中绘制图像并将其作为资源添加到您的应用程序中要容易得多。

如果您想在代码中绘制电池，请先在纸上或在绘图程序中绘制形状。然后写下你需要做的所有绘图操作的列表——对于电池，它可能只是一系列的直线和曲线。[UIBezierPath](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIBezierPath_class/Reference/Reference.html)提供了这些操作，从它开始可能比深入 Quartz2D 更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T19:55:16.313

我都做过，使用绘图程序，并编程。今天，我发现编程更容易、更有趣，并且面向未来：
您不必为 ios 分辨率的任何变化提供两张或多少张图片。

绘图中的一个（不是那么秘密）提示是，将绘​​图标准化为 0 和 1 之间。然后你就与电池大小无关了。您可以通过`CGAffineTransformMakeScale()`. 但是您应该立即更改线宽以适应缩放率：

如果按因子 r 缩放：
lineWidth 必须是 origLineWidth / r; // 这花了我一些时间才知道！
例如 origLineWidth = 1.0;

然后你可以画：

1.  电池语料库的一个矩形，（例如，从 x：0 到 0.9）
2.  一个填充矩形用于电池极。（例如从 x：0.9 到 1.0）
3.  并且电池的充电状态可以使用线性梯度（或更好的两个梯度）。一个从 y 0 (+ linewidth) - 0.25 从绿色到白色的渐变，另一个从白色到深绿色的渐变：y: 0.25 - (1.0 - linewWidth)

这真是一部不错的作品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T20:02:09.597

这是我在 PaintCode 中画的一个小东西，可能有点小。

```
CGFloat factor = 0.2; // Something between 0.0 - 1.0

//// Rectangle Drawing
UIBezierPath* rectanglePath = [UIBezierPath bezierPathWithRect: CGRectMake(0.5, 0.5, 15, 5)];
[[UIColor blackColor] setStroke];
rectanglePath.lineWidth = 1;
[rectanglePath stroke];

//// Rectangle 2 Drawing -- THIS IS THE INNER "LEVEL" PART
UIBezierPath* rectangle2Path = [UIBezierPath bezierPathWithRect: CGRectMake(2, 2, 12*factor, 2)];
[[UIColor blackColor] setFill];
[rectangle2Path fill];
[[UIColor blackColor] setStroke];
rectangle2Path.lineWidth = 1;
[rectangle2Path stroke];

//// Bezier Drawing
UIBezierPath* bezierPath = [UIBezierPath bezierPath];
[bezierPath moveToPoint: CGPointMake(15.52, 1.5)];
[bezierPath addCurveToPoint: CGPointMake(17.04, 2.97) controlPoint1: CGPointMake(16.64, 1.49) controlPoint2: CGPointMake(17.05, 1.76)];
[bezierPath addCurveToPoint: CGPointMake(15.52, 4.5) controlPoint1: CGPointMake(17.02,         4.16) controlPoint2: CGPointMake(17.05, 4.48)];
[bezierPath addCurveToPoint: CGPointMake(15.52, 1.5) controlPoint1: CGPointMake(15.55, 4.48) controlPoint2: CGPointMake(15.47, 1.49)];
[bezierPath closePath];
[[UIColor blackColor] setFill];
[bezierPath fill]; 
```

# c++ - 如果内部的总工作量相同，将 for 循环拆分为多个 for 循环的开销是多少？

> ID：13866962
> 
> 赞同：8
> 
> 时间：2012-12-13T19:26:40.570
> 
> 标签：c++, performance, for-loop

`for`像这样拆分 -loop的开销是多少，

```
int i;

for (i = 0; i < exchanges; i++)
{
    // some code
    // some more code
    // even more code
} 
```

`for`像这样进入多个循环？

```
int i;

for (i = 0; i < exchanges; i++)
{
    // some code
}

for (i = 0; i < exchanges; i++)
{
    // some more code
}

for (i = 0; i < exchanges; i++)
{
    // even more code
} 
```

代码*对*性能很敏感，但执行后者会*显着*提高可读性。（以防万一，每个循环内没有其他循环、变量声明或函数调用，除了少数访问器。）

我不完全是一个低级编程大师，所以如果有人可以衡量与基本操作相比的性能损失，那就更好了，*例如*“每个额外`for`的 -loop 将花费相当于两次`int`分配的成本。” 但是，如果不是那么简单，我理解（并且不会感到惊讶）。

提前谢谢了。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-13T20:00:12.733

通常有太多因素在起作用......而且很容易证明两种方式：

例如，拆分以下循环会导致几乎 2 倍的减速（底部有完整的测试代码）：

```
for (int c = 0; c < size; c++){
    data[c] *= 10;
    data[c] += 7;
    data[c] &= 15;
} 
```

这几乎是显而易见的，因为您需要循环 3 次而不是一次，并且您需要 3 次遍历整个数组而不是 1 次。

另一方面，如果你看一下这个问题：[为什么在单独的循环中元素加法比在组合循环中快得多？](https://stackoverflow.com/q/8547778/922184)

```
for(int j=0;j<n;j++){
    a1[j] += b1[j];
    c1[j] += d1[j];
} 
```

由于内存对齐，有时情况正好相反。

* * *

**从中可以得到什么？**

几乎任何事情都可能发生。两种方法都不是更快，它在很大程度上取决于循环内的内容。

因此，确定这种优化是否会提高性能通常需要反复试验。有了足够的经验，您就可以做出相当自信（受过教育）的猜测。但总的来说，期待任何事情。

> “每个额外的 for 循环将花费相当于两个 int 分配的成本。”

你说得对，事情没那么简单。事实上，它是如此复杂，以至于这些数字并没有多大意义。由于[无序执行](http://en.wikipedia.org/wiki/Out-of-order_execution)和数据依赖性等多种因素，循环迭代在一种情况下可能需要 X 个周期，但在另一种情况下需要 Y 个周期。

性能不仅取决于上下文，而且还因不同的处理器而异。

* * *

这是测试代码：

```
#include <time.h>
#include <iostream>
using namespace std;

int main(){

    int size = 10000;
    int *data = new int[size];

    clock_t start = clock();

    for (int i = 0; i < 1000000; i++){
#ifdef TOGETHER
        for (int c = 0; c < size; c++){
            data[c] *= 10;
            data[c] += 7;
            data[c] &= 15;
        }
#else
        for (int c = 0; c < size; c++){
            data[c] *= 10;
        }
        for (int c = 0; c < size; c++){
            data[c] += 7;
        }
        for (int c = 0; c < size; c++){
            data[c] &= 15;
        }
#endif
    }

    clock_t end = clock();
    cout << (double)(end - start) / CLOCKS_PER_SEC << endl;

    system("pause");
} 
```

**输出（一个循环）：** 4.08 秒
**输出（3 个循环）：** 7.17 秒

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T19:48:51.680

处理器更喜欢数据指令与跳转指令的比例更高。
分支指令*可能会*强制您的处理器清除指令流水线并重新加载。

基于指令流水线的重新加载，第一种方法会更快，但并不显着。您将通过拆分添加至少 2 个新的分支指令。

更快的优化是展开循环。展开循环试图通过在分支到循环顶部之前在循环内执行更多指令来提高数据指令与分支指令的比率。

另一个重要的性能优化是组织数据，使其适合处理器的一个高速缓存行。例如，您可以拆分处理单个数据缓存的内部循环，而外部循环会将新项目加载到缓存中。

**只有在程序正确且稳健地运行并且**环境需要更高性能之后，才应应用此优化。环境定义为观察者（动画/电影）、用户（等待响应）或硬件（在关键时间事件之前执行操作）。任何其他目的都是浪费您的时间，因为操作系统（运行并发程序）和存储访问将更多地导致您的程序的性能问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T21:23:31.940

这将很好地指示一个版本是否比另一个版本快。

```
#include <array>
#include <chrono>
#include <iostream>
#include <numeric>
#include <string>

const int iterations = 100;

namespace
{
    const int exchanges = 200;

    template<typename TTest>
    void Test(const std::string &name, TTest &&test)
    {
        typedef std::chrono::high_resolution_clock Clock;
        typedef std::chrono::duration<float, std::milli> ms;

        std::array<float, iterations> timings;

        for (auto i = 0; i != iterations; ++i)
        {
            auto t0 = Clock::now();

            test();

            timings[i] = ms(Clock::now() - t0).count();
        }

        auto avg = std::accumulate(timings.begin(), timings.end(), 0) / iterations;
        std::cout << "Average time, " << name << ": " << avg << std::endl;
    }
}

int main()
{
    Test("single loop",
        []()
        {
            for (auto i = 0; i < exchanges; ++i)
            {
                // some code
                // some more code
                // even more code
            }
        });

    Test("separated loops",
        []()
        {
            for (auto i = 0; i < exchanges; ++i)
            {
                // some code
            }

            for (auto i = 0; i < exchanges; ++i)
            {
                // some more code
            }

            for (auto i = 0; i < exchanges; ++i)
            {
                // even more code
            }
        });
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-12-13T19:51:05.803

事情很简单。第一个代码就像在赛道上跑了一圈，另一个代码就像跑了整整 3 圈。因此，跑三圈而不是一圈需要更多的时间。但是，如果循环正在做一些需要按顺序完成的事情并且它们相互依赖，那么第二个代码将做这些事情。例如，如果第一个循环正在做一些计算，而第二个循环正在对这些计算做一些工作，那么两个循环都需要按顺序完成，否则不会......

# android - 检查是否没有足够的空间容纳字符串（TextView）

> ID：13866963
> 
> 赞同：2
> 
> 时间：2012-12-13T19:26:42.660
> 
> 标签：android

是否有可能检查`String`分配的 a 的长度`TextView`是否比实际设备的屏幕长？换句话说，如何检查文本是否不适合屏幕？

如果文字不合适，我需要腾出一些空间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:47:04.797

显然，您可以对其进行测量。

```
textView.setText("bla");
textView.measure(0, 0);       //must call measure!
textView.getMeasuredHeight(); //get width
textView.getMeasuredWidth();  //get height 
```

取自[这里的问题/答案](https://stackoverflow.com/questions/6734301/get-the-size-of-a-text-in-textview)

然后，您可以使用该测量值与屏幕尺寸进行比较。

# jquery - Jquery在树中编辑样式属性 锚点内的标签

> ID：13866966
> 
> 赞同：0
> 
> 时间：2012-12-13T19:26:49.087
> 
> 标签：jquery

我正在尝试更改 html 上的 ins 标签样式属性，如下所示

```
<ul>
  <li class="pad">
    <a>
     <ins style="margin-left: 5px"></ins>
    </a>
  </li>
  <li class="no_pad">
    <a>
      <ins style="margin-left: 0px"></ins>
    </a>
  </li>
  <li class="pad">
    <a>
      <ins style="margin-left: 5px"></ins>
    </a>
  </li>
<ul> 
```

我只想获取带有“pad”类标签的列表元素。如何获取所有列表元素，然后进入 ins 标记以编辑其样式属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:29:40.650

好吧，这不正是您要寻找的吗？或者我误解了你

```
$('li.pad ins').css('margin-left','20px'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:29:50.400

使用简单的 CSS 选择器：

```
$('li.pad ins').css('cssPropertyName', 'CssPropertyValue'); 
```

这将添加`cssPropertyName`属性，并将其值设置为提供的`cssPropertyValue`.

如果您愿意，尽管不必要，请使用以下`attr()`方法：

```
$('li.pad ins').attr('style', function(i, v) {
    return v + 'cssPropertyName: cssPropertyValue;'
}); 
```

参考：

*   [`attr()`](http://api.jquery.com/attr/).
*   [`css()`](http://api.jquery.com/css/).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T19:31:31.170

你可以试试这个

```
$('li.pad > a > ins').css({
    'color':'red',
    'font-weight':'bold'
}); 
```

[**演示**](http://jsbin.com/oforex/1/edit)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T19:33:13.350

您可以使用`class`, `id`,`attr`或`tags`作为 jQuery 选择器，本例`ins`是一个标签，因此您可以通过以下方式找到它。

```
$('li.pad').find('ins'); 
```

# java - 如果泛型在 Java 中起作用，我如何获取一个“int”并将其转换为“Integer”？

> ID：13866967
> 
> 赞同：1
> 
> 时间：2012-12-13T19:26:52.743
> 
> 标签：java, java-7

我的目标是通过任何方式简单地将我的 int 解释为 Integer，没有变通办法

我有一个对象`Node<T> (int Key, T value)`。

我正在开发一个可以正确使用泛型的程序，现在我只希望它使用整数。但是我不能制作`Node<int>`，我必须使用`Node<Integer>`。

我不知道如何`Integer`从控制台读取 an，我知道如何读取 only `int`。

### 代码

```
public void addNumber (int number) {
   Node<Integer> newNode = new Node<Integer>(number,(Integer)number); //does not work
   this.gd.add(newNode);                                       
} 
```

我尝试了什么：

```
Integer iNumb = new Integer(number);   // Could not instantiate the type integer 
```

和：

```
Node<Integer> newNode = new Node<Integer>(number, number); 
```

我没有为此的构造函数，走那条路毫无意义。

我也试过这个：

```
public void addNumber() throws GenericDictionary_exception {
    Scanner input = new Scanner(System.in);
    int number;
    System.out.print("Number: ");

    if (input.hasNextInt()) { 
    number = input.nextInt();
    } else
    throw new GenericDictionary_exception(
              "Error\n\t**This version only supports input of numbers**");

    Integer integer = number; // Type missmatch
    } 
```

如果泛型在 Java 中起作用，我如何`int`将其转换为？`Integer`

```
 int num = 5;
 Integer integer = num; 
```

这样可行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:51:28.010

假设 number 是一个 int：

```
Integer myInteger = number; 
```

Java 泛型有一些限制，其中之一是您不能使用原语，而必须使用 Java 的原语包装类。

这是一个更复杂的解释：

[为什么 Java 泛型不支持原始类型？](https://stackoverflow.com/questions/2721546/why-dont-generics-support-primitive-types)

编辑：

为了清楚起见，我假设您的 Node 类看起来像这样：

```
public class Test {
    public static void main(String[] args) {
        int number = 2;
        Integer myInteger = number;
        Node<Integer> myNode = new Node<Integer>(number, number);
        System.out.println(myNode.getValue());
    }

    public static class Node<T> {
        private int key;
        private T value;

        public Node(int key, T value) {
            this.key = key;
            this.value = value;
        }

        public T getValue() {
            return value;
        }
    }    
} 
```

我的建议是尝试编译和运行这个测试代码。如果它不起作用，那么你的环境有问题。如果它确实有效，那么问题可能与我们没有看到的代码有关。

编辑2：

这对我有用。同样，我建议将其作为独立程序尝试：

```
public class Test {
    public static void main(String[] args) throws Exception {
        addNumber();
    }

    public static void addNumber() throws Exception {
        Scanner input = new Scanner(System.in);
        int number;
        System.out.print("Number: ");

        if (input.hasNextInt()) {
            number = input.nextInt();
        } else {
            throw new Exception(
                "Error\n\t**This version only supports input of numbers**");
        }

        Integer integer = number; // Type missmatch
        System.out.println(integer);
    }
} 
```

# openssl - Fedora 客户端使用“警报（级别：致命，描述：未知 CA）”断开与 SSL 服务器的连接

> ID：13866979
> 
> 赞同：2
> 
> 时间：2012-12-13T19:27:40.990
> 
> 标签：openssl, fedora, ssl

我目前正在使用网络服务来处理来自运行 apache/fedora 的网络服务器的付款。我嗅探了客户端和服务器之间的通信并得到：

客户端 > 服务器：Cliente Hello

服务器 > 客户端：服务器你好

服务器 > 客户端：证书，服务器 Hello Done

客户端 > 服务器：警报（级别：致命，描述：未知 CA）

然后，TCP 连接被关闭。

服务器地址是[https://secure.internetsecure.com/process.cgi](https://secure.internetsecure.com/process.cgi)

可能有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:09:03.503

确保您的客户端设置为信任信任链中的每个证书颁发机构（在您的情况下，是 VeriSign Class 3 Public Primary Certification Authority 和 VeriSign Class 3 International Server CA）。您的客户出错了，因为它不知道这两个证书。

# javascript - 如何修复强制进入网页上其他 div 顶部的 Google 广告？

> ID：13866981
> 
> 赞同：0
> 
> 时间：2012-12-13T19:27:44.127
> 
> 标签：javascript, jquery, html, adsense

我有一个用 python/django/html 编写的关于 Google App 引擎的网站。站点位于[http://perlesloyfer.no](http://perlesloyfer.no) 它是一种博客，展示了一些我制作的弓的人的图像。我在顶部实施了一个“粘性标题”，并在帖子的第 9 位显示广告。但是，当我滚动列表时，Google Ads 会以某种方式迫使它们自己位于标题的顶部。此图像位于问题的底部。

是什么原因造成的，是否可以解决？我希望广告像其他帖子一样滚动，但它不应该显示，因为它在该位置时“超过”标题。

粘性标题 jquery 代码：

```
$(function(){
    // Check the initial Poistion of the Sticky Header
    var stickyHeaderTop = $('#sticky').offset().top;
    $(window).scroll(function(){
        if( $(window).scrollTop() > stickyHeaderTop ) {
            //$('#sticky').css({position: 'fixed', top: '0px', float: 'right'});
            $('#sticky').addClass("sticky");
        } else {
            $('#sticky').removeClass("sticky");
        }
    });
}); 
```

标题的实际 HTML：

```
<div id="sticky" class="top-area">
<div class="main-header"><a href="./">Perlesløyfer</a></div>
<div class="main-subheader"><p>Av Håkon Bogen</p></div>
<div class="tabs">
    <ul>
        <li><a href=".">Bilder</li></a>
        <li><a class="selected" href="./about">Om</li></a>
        <li><a href="http://epla.no/handlaget/produkter/526979/">Kjøp</li></a>
        <li><a href="./submit">Last opp</li></a>
    </ul>
</div> 
```

用于粘性的 CSS：

```
#sticky {
    background-color: white;
    position:fixed;
    top:0;
    width:100%;
} 
```

谷歌广告代码：

```
<div class="commercial" id="page-wrap-ad">
    <p id="ads">
<!---  google_ad_client = ....  -->
<script type="text/javascript">
    <script type="text/javascript"
            src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
    </script></p> 
```

![网站显示正确](../Images/6278f9125ab017ec37d43b1140700eb8.png)

![谷歌广告显示错误](../Images/c12134c5abea31a9e5a3950b0244bbe7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:32:21.187

不确定我是否可以发布这个，但这里是：

在问题中找到广告的特定目标元素（div、类等），并使用 CSS 覆盖其定位。

```
Example:
#myAnnoyingAd{
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T09:19:35.533

刚刚为粘性标题添加了更大的 z-index。没有比那更难。

```
#sticky {
    background-color: white;
    position:fixed;
    top:0;
    width:100%;
    z-index:1000;
} 
```

# setup-project - Sharpdevelop - 为解决方案设置默认项目

> ID：13866985
> 
> 赞同：1
> 
> 时间：2012-12-13T19:28:00.693
> 
> 标签：setup-project, sharpdevelop

也许这是一个愚蠢的问题，但我走了:)

我在一个解决方案中有两个项目。WinApp 和 ConsoleApp。如果我只从 ConsoleApp 打开文件，那么 sharpdevelop 会启动 WinApp。我必须右键单击 ConsoleApp 并选择“运行项目”。

当我按 F5 时，我如何告诉Sharpdevelop默认运行两者中的哪一个？

我正在使用sharpdevelop 4.2.2 build 8818

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T23:05:08.380

在 Projects 窗口中，右键单击 ConsoleApp 项目并选择**Set as Startup Project**。当您按 F5 时，SharpDevelop 将运行 ConsoleApp。

# ruby-on-rails - 从连接模型 (belongs_to) rails 获取属性

> ID：13866986
> 
> 赞同：0
> 
> 时间：2012-12-13T19:28:05.643
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我有 2 个相关模型。

```
class Store < ActiveRecord::Base
  attr_accessible :name, :subdomain
  belongs_to  :theme
end

class Theme < ActiveRecord::Base
  attr_accessible :name, :description, :screenshot_attributes
  has_many  :stores
end 
```

一切正常问题是当我尝试以下列方式访问主题的名称时。

```
<% @stores.each do |store| %>
  <tr>
    <td><%= link_to store.subdomain, store %></td>
    <td><%= store.name %></td>
    <td><%= store.theme.name %></td>
    <td><%= link_to 'Go to Store', root_url(subdomain: store.subdomain) %></td>
    <td><%= link_to 'Edit', [:edit, store] %></td>
    <td><%= link_to 'Destroy', store, confirm: 'Are you sure?', method: :delete %></td>
  </tr>
<% end %> 
```

这是得到错误的行。

```
 <td><%= store.theme.name %></td> 
```

这是消息：

```
 undefined method `name' for nil:NilClass 
```

访问主题名称值的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:36:13.687

只是因为 store.theme 是零。一个有用的功能是检查。如果你这样做：

```
<%= store.inspect %> 
```

你会看到 theme_id 为 nil。

# android - 无法启动服务 Intent { flg=0x4 cmp=mypackage/.AlarmReceiver (has extras) }：未找到

> ID：13866988
> 
> 赞同：1
> 
> 时间：2012-12-13T19:28:11.747
> 
> 标签：android

这是我的清单？是明显的问题吗？花费很多时间来发现问题......是一项按意图启动课程的服务（使用警报管理器）。如果没有明显的问题，那是什么问题？

感谢帮助！

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.mypackage"
    android:versionCode="1"
    android:versionName="1" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />
    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" android:name="CrashReports">

        <service android:name="UnUsedService">
        <intent-filter>
        <action
        android:name="org.gortcloud.startatboot.UnUsedService" />
        </intent-filter>
        </service>

        <receiver android:name="AutoStart">
        <intent-filter>
        <action
        android:name="android.intent.action.BOOT_COMPLETED" />
        <category android:name="android.intent.category.HOME" />
        </intent-filter>
        </receiver>

        <receiver android:name="AlarmReceiver" android:process=":remote"/>

        <activity
            android:name="com.example.mypackage.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <service android:enabled="true" android:name=".SobService"/>

        <activity android:name="Index"></activity>
        <activity android:name="SendText"></activity>

    </application>
</manifest> 
```

日志猫

```
 E/ThrottleService(  149): problem during onPollAlarm: java.lang.IllegalStateException: problem parsing stats: java.io.FileNotFoundException: /proc/net/xt_qtaguid/iface_stat_all: open failed: ENOENT (No such file or directory)
D/dalvikvm(  149): GC_CONCURRENT freed 637K, 13% free 8307K/9479K, paused 25ms+12ms, total 142ms
D/AndroidRuntime(14611): 
D/AndroidRuntime(14611): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
D/AndroidRuntime(14611): CheckJNI is ON
D/dalvikvm(14611): Trying to load lib libjavacore.so 0x0
D/dalvikvm(14611): Added shared lib libjavacore.so 0x0
D/dalvikvm(14611): Trying to load lib libnativehelper.so 0x0
D/dalvikvm(14611): Added shared lib libnativehelper.so 0x0
D/AndroidRuntime(14611): Calling main entry com.android.commands.pm.Pm
W/ActivityManager(  149): No content provider found for permission revoke: file:///data/local/tmp/MainActivity.apk
D/dalvikvm( 2860): GC_CONCURRENT freed 457K, 14% free 5292K/6087K, paused 17ms+4ms, total 75ms
W/ActivityManager(  149): No content provider found for permission revoke: file:///data/local/tmp/MainActivity.apk
D/dalvikvm(  149): GC_CONCURRENT freed 614K, 12% free 8360K/9479K, paused 22ms+30ms, total 125ms
D/dalvikvm(  149): GC_FOR_ALLOC freed 282K, 13% free 8265K/9479K, paused 69ms, total 70ms
D/dalvikvm(  149): GC_FOR_ALLOC freed 234K, 13% free 8267K/9479K, paused 86ms, total 87ms
D/dalvikvm(  149): GC_FOR_ALLOC freed 239K, 13% free 8270K/9479K, paused 68ms, total 68ms
I/PackageManager(  149): Removing non-system package:org.gortcloud.perledisaggezza
I/ActivityManager(  149): Force stopping package org.gortcloud.perledisaggezza uid=10044
I/ActivityManager(  149): Killing proc 10610:org.gortcloud.perledisaggezza/u0a44: force stop
W/ActivityManager(  149): Force removing ActivityRecord{411fe0f0 org.gortcloud.perledisaggezza/.MainActivity}: app died, no saved state
W/InputDispatcher(  149): channel '412b50c0 org.gortcloud.perledisaggezza/org.gortcloud.perledisaggezza.MainActivity (server)' ~ Consumer closed input channel or an error occurred.  events=0x9
E/InputDispatcher(  149): channel '412b50c0 org.gortcloud.perledisaggezza/org.gortcloud.perledisaggezza.MainActivity (server)' ~ Channel is unrecoverably broken and will be disposed!
I/WindowState(  149): WIN DEATH: Window{412b50c0 org.gortcloud.perledisaggezza/org.gortcloud.perledisaggezza.MainActivity paused=false}
W/InputDispatcher(  149): Attempted to unregister already unregistered input channel '412b50c0 org.gortcloud.perledisaggezza/org.gortcloud.perledisaggezza.MainActivity (server)'
I/Choreographer(  149): Skipped 75 frames!  The application may be doing too much work on its main thread.
I/WindowManager(  149): WINDOW DIED Window{412b50c0 org.gortcloud.perledisaggezza/org.gortcloud.perledisaggezza.MainActivity paused=false}
I/Choreographer(  258): Skipped 238 frames!  The application may be doing too much work on its main thread.
I/PackageManager(  149): Package org.gortcloud.perledisaggezza codePath changed from /data/app/org.gortcloud.perledisaggezza-2.apk to /data/app/org.gortcloud.perledisaggezza-1.apk; Retaining data and using new
W/InputMethodManagerService(  149): Got RemoteException sending setActive(false) notification to pid 10610 uid 10044
I/PackageManager(  149): Running dexopt on: org.gortcloud.perledisaggezza
D/dalvikvm(14630): DexOpt: load 129ms, verify+opt 643ms, 962252 bytes
W/PackageManager(  149): Code path for pkg : org.gortcloud.perledisaggezza changing from /data/app/org.gortcloud.perledisaggezza-2.apk to /data/app/org.gortcloud.perledisaggezza-1.apk
W/PackageManager(  149): Resource path for pkg : org.gortcloud.perledisaggezza changing from /data/app/org.gortcloud.perledisaggezza-2.apk to /data/app/org.gortcloud.perledisaggezza-1.apk
D/dalvikvm(  149): GC_FOR_ALLOC freed 320K, 13% free 8281K/9479K, paused 72ms, total 73ms
I/ActivityManager(  149): Force stopping package org.gortcloud.perledisaggezza uid=10044
D/PackageManager(  149): New package installed in /data/app/org.gortcloud.perledisaggezza-1.apk
W/PackageManager(  149): Not granting permission android.permission.READ_LOGS to package org.gortcloud.perledisaggezza (protectionLevel=50 flags=0x8be46)
I/ActivityManager(  149): Force stopping package org.gortcloud.perledisaggezza uid=10044
D/dalvikvm(  204): WAIT_FOR_CONCURRENT_GC blocked 0ms
D/dalvikvm(  258): WAIT_FOR_CONCURRENT_GC blocked 1ms
D/dalvikvm(  204): GC_EXPLICIT freed 216K, 62% free 5881K/15367K, paused 8ms+19ms, total 155ms
D/dalvikvm(  258): GC_EXPLICIT freed 409K, 39% free 7423K/12103K, paused 8ms+22ms, total 156ms
D/dalvikvm(  323): WAIT_FOR_CONCURRENT_GC blocked 0ms
D/dalvikvm(  323): GC_EXPLICIT freed 177K, 10% free 5564K/6151K, paused 8ms+9ms, total 88ms
I/InputReader(  149): Reconfiguring input devices.  changes=0x00000010
D/PackageManager(  149): generateServicesMap(android.accounts.AccountAuthenticator): 2 services unchanged
D/PackageManager(  149): generateServicesMap(android.content.SyncAdapter): 4 services unchanged
D/BackupManagerService(  149): Received broadcast Intent { act=android.intent.action.PACKAGE_REMOVED dat=package:org.gortcloud.perledisaggezza flg=0x8000010 (has extras) }
D/dalvikvm(  149): WAIT_FOR_CONCURRENT_GC blocked 0ms
I/AccountTypeManager(  367): Loaded meta-data for 1 account types, 0 accounts in 53ms(wall) 5ms(cpu)
D/dalvikvm(  149): GC_EXPLICIT freed 503K, 15% free 8140K/9479K, paused 65ms+21ms, total 204ms
I/InputReader(  149): Reconfiguring input devices.  changes=0x00000010
D/PackageManager(  149): generateServicesMap(android.accounts.AccountAuthenticator): 2 services unchanged
D/PackageManager(  149): generateServicesMap(android.content.SyncAdapter): 4 services unchanged
D/BackupManagerService(  149): Received broadcast Intent { act=android.intent.action.PACKAGE_ADDED dat=package:org.gortcloud.perledisaggezza flg=0x8000010 (has extras) }
V/BackupManagerService(  149): removePackageParticipantsLocked: uid=10044 #1
V/BackupManagerService(  149): addPackageParticipantsLocked: #1
W/InputMethodManagerService(  149): Found no subtypes in a system IME: com.android.inputmethod.pinyin
I/AccountTypeManager(  367): Loaded meta-data for 1 account types, 0 accounts in 11ms(wall) 7ms(cpu)
I/Choreographer(  258): Skipped 533 frames!  The application may be doing too much work on its main thread.
D/dalvikvm(  149): WAIT_FOR_CONCURRENT_GC blocked 0ms
D/dalvikvm(  367): GC_CONCURRENT freed 403K, 12% free 5471K/6215K, paused 100ms+14ms, total 174ms
W/RecognitionManagerService(  149): no available voice recognition services found
D/dalvikvm(  149): GC_EXPLICIT freed 400K, 14% free 8170K/9479K, paused 27ms+47ms, total 266ms
D/AndroidRuntime(14611): Shutting down VM
D/dalvikvm(14611): GC_CONCURRENT freed 101K, 78% free 458K/2048K, paused 2ms+1ms, total 13ms
D/jdwp    (14611): Got wake-up signal, bailing out of select
D/dalvikvm(14611): Debugger has detached; object registry had 1 entries
I/AndroidRuntime(14611): NOTE: attach of thread 'Binder_3' failed
D/AndroidRuntime(14647): 
D/AndroidRuntime(14647): >>>>>> AndroidRuntime START com.android.internal.os.RuntimeInit <<<<<<
D/AndroidRuntime(14647): CheckJNI is ON
D/dalvikvm(14647): Trying to load lib libjavacore.so 0x0
D/dalvikvm(14647): Added shared lib libjavacore.so 0x0
D/dalvikvm(14647): Trying to load lib libnativehelper.so 0x0
D/dalvikvm(14647): Added shared lib libnativehelper.so 0x0
D/AndroidRuntime(14647): Calling main entry com.android.commands.am.Am
I/ActivityManager(  149): START {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10000000 cmp=org.gortcloud.perledisaggezza/.MainActivity u=0} from pid 14647
W/WindowManager(  149): Failure taking screenshot for (123x221) to layer 21025
D/AndroidRuntime(14647): Shutting down VM
D/dalvikvm(14647): GC_CONCURRENT freed 102K, 77% free 489K/2048K, paused 1ms+2ms, total 11ms
D/jdwp    (14647): Got wake-up signal, bailing out of select
D/dalvikvm(14647): Debugger has detached; object registry had 1 entries
I/AndroidRuntime(14647): NOTE: attach of thread 'Binder_3' failed
D/dalvikvm(  258): GC_CONCURRENT freed 539K, 38% free 7520K/12103K, paused 16ms+127ms, total 360ms
D/dalvikvm(14658): Not late-enabling CheckJNI (already on)
I/ActivityManager(  149): Start proc org.gortcloud.perledisaggezza for activity org.gortcloud.perledisaggezza/.MainActivity: pid=14658 uid=10044 gids={3003, 1028}
E/Trace   (14658): error opening trace file: No such file or directory (2)
I/Choreographer(  149): Skipped 35 frames!  The application may be doing too much work on its main thread.
D/ACRA    (14658): ACRA is enabled for org.gortcloud.perledisaggezza, intializing...
D/ACRA    (14658): Using default Report Fields
D/ACRA    (14658): Looking for error files in /data/data/org.gortcloud.perledisaggezza/files
D/dalvikvm(14658): GC_FOR_ALLOC freed 179K, 9% free 5372K/5895K, paused 31ms, total 32ms
I/dalvikvm-heap(14658): Grow heap (frag case) to 5.965MB for 457616-byte allocation
D/dalvikvm(14658): GC_CONCURRENT freed 1K, 9% free 5817K/6343K, paused 19ms+13ms, total 61ms
D/dalvikvm(14658): GC_CONCURRENT freed 48K, 6% free 6322K/6663K, paused 15ms+4ms, total 65ms
D/dalvikvm(14658): WAIT_FOR_CONCURRENT_GC blocked 18ms
D/dalvikvm(14658): GC_FOR_ALLOC freed 48K, 6% free 6464K/6855K, paused 41ms, total 41ms
I/dalvikvm-heap(14658): Grow heap (frag case) to 7.234MB for 668816-byte allocation
D/dalvikvm(14658): GC_FOR_ALLOC freed <1K, 6% free 7117K/7559K, paused 58ms, total 58ms
D/dalvikvm(14658): GC_CONCURRENT freed <1K, 6% free 7117K/7559K, paused 16ms+4ms, total 64ms
I/Choreographer(14658): Skipped 58 frames!  The application may be doing too much work on its main thread.
I/Choreographer(14658): Skipped 233 frames!  The application may be doing too much work on its main thread.
D/gralloc_goldfish(14658): Emulator without GPU emulation detected.
I/ActivityManager(  149): Displayed org.gortcloud.perledisaggezza/.MainActivity: +1s713ms
I/Choreographer(  149): Skipped 61 frames!  The application may be doing too much work on its main thread.
I/Choreographer(  149): Skipped 43 frames!  The application may be doing too much work on its main thread.
I/Choreographer(14658): Skipped 271 frames!  The application may be doing too much work on its main thread.
D/dalvikvm(  243): GC_CONCURRENT freed 384K, 13% free 5798K/6599K, paused 4ms+4ms, total 36ms
I/Choreographer(14658): Skipped 46 frames!  The application may be doing too much work on its main thread.
I/Choreographer(  149): Skipped 36 frames!  The application may be doing too much work on its main thread.
D/dalvikvm(14692): Not late-enabling CheckJNI (already on)
I/ActivityManager(  149): Start proc org.gortcloud.perledisaggezza:remote for broadcast org.gortcloud.perledisaggezza/.AlarmReceiver: pid=14692 uid=10044 gids={3003, 1028}
E/Trace   (14692): error opening trace file: No such file or directory (2)
D/ACRA    (14692): ACRA is enabled for org.gortcloud.perledisaggezza, intializing...
D/ACRA    (14692): Using default Report Fields
D/ACRA    (14692): Looking for error files in /data/data/org.gortcloud.perledisaggezza/files
D/gralloc_goldfish(14692): Emulator without GPU emulation detected. 
```

UnUsedService（从我的活动开始：

```
startService(new Intent(this, UnUsedService.class)); 
```

未使用服务

```
public class UnUsedService extends Service {

//private PendingIntent pendingIntent;

@Override
public IBinder onBind(Intent intent) {
return null;
}
@Override
public void onCreate() {
super.onCreate();
Toast.makeText(this, "Service Created", Toast.LENGTH_LONG).show();

//startService(new Intent(this, UnUsedService.class));
}
@Override
public void onDestroy() {
super.onDestroy();
Toast.makeText(this, "Service Destroyed", Toast.LENGTH_LONG).show();
}

private PendingIntent pendingIntent;

@SuppressWarnings("deprecation")
@Override
public void onStart(Intent intent, int startId) {

//  super.onStart();
super.onStart(intent, startId);

Toast.makeText(this, "Service Started", Toast.LENGTH_LONG).show();

Calendar calendar = Calendar.getInstance();
calendar.set(Calendar.HOUR_OF_DAY, 23);
calendar.set(Calendar.MINUTE, 32);
calendar.set(Calendar.SECOND, 0);    AlarmManager am = (AlarmManager)     getApplicationContext().getSystemService  (Context.ALARM_SERVICE);
PendingIntent pi = PendingIntent.getService(getApplicationContext(), 0, new Intent(getApplicationContext(),     AlarmReceiver.class),      PendingIntent.FLAG_UPDATE_CURRENT);
am.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(),     AlarmManager.INTERVAL_DAY, pi);
am.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis()+1000,     AlarmManager.INTERVAL_DAY, pi);

}}; 
```

接收者：

```
public class AlarmReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        Toast.makeText(context, "Alarm worked.", Toast.LENGTH_LONG).show();

    }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T19:46:30.197

我注意到您正在创建错误类型的 PendingIntent：

```
pendingIntent = PendingIntent.getService(UnUsedService.this, 0, myIntent, 0); 
```

你想定位你的广播接收器，所以你需要使用：

```
pendingIntent = PendingIntent.getBroadcast(AlarmReceiver.this, 0, myIntent, 0); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-13T19:43:47.777

而不是在你的主文件中。.

尝试这个

```
 <activity android:name="com.example.mypackage.Index"></activity>
    <activity android:name="com.example.mypackage.SendText"></activity> 
```

# c - (C) 传递给 func 的指针与原始指针不同

> ID：13866992
> 
> 赞同：0
> 
> 时间：2012-12-13T19:28:26.883
> 
> 标签：c, arrays, pointers, segmentation-fault

Segfault 我发现自己无法诊断。

我有一个基准函数`chrono`，它接收一个`strings`指向随机生成的字符串的指针数组，以及一个对应的`sizes`. 对于调试，我打印`strings`（指向指针的指针）、`strings[1]`（其中之一）和`sizes`（指针）。（可以肯定的是，我还在 中打印了一些字符串`chrono`，并与生成它们的 func 中的原始内容进行比较：到目前为止一切都很好。）要进行基准测试的是一个将一组字符串输入字符串的 func水池：

```
void pool_store_pack (StringPool * pool,
     char ** strings, size_t * sizes, uint n_new); 
```

对于调试，我在 pool_store_pack 中打印相同的数据。而且价值观不同。`strings`已更改，并且两者`strings[1]`都`sizes`为空。这是一个示例输出：

```
strings:0x9842fa8 (n°1:0x984200c)
sizes:0x9843f48
some strings: `@PR` `MOB` `TBQ`

strings:0x804a824 (n°1:(nil))
sizes:(nil)
segmentation fault (core dumped) 
```

我试图将错误简化为更简单的形式，但这很困难，因为它是测试代码，而不是应用程序代码，驱动了一个自主的库。当我尝试从头开始重现该错误时，我只是得到了预期的指针和指向在接收函数中与发送函数中具有相同值的指针的指针。但是，如果有帮助，我可以发布 3 个相关函数的代码（但您将无法运行它，因为它只是驱动其他函数）。

我很确定错过了一个明显的点，但看不到它，并且被阻塞和沮丧了几个小时；-) 你能帮忙吗？

编辑：所以，这是所涉及的整个代码：

```
/*  Put pack of strings in pool.
*/
void pool_store_pack (StringPool * pool,
         char ** strings, size_t * sizes, uint n_new) {
   pool_grow(pool, n_new);

   // debug /////////////////////////////////////////////////////////
   printfl("n_new:%u", n_new);
   printfl("strings:%p (n°1:%p)", strings, strings[1]);
   printfl("sizes:%p", sizes);
   printfl("some sizes: %u %u %u", sizes[1], sizes[3], sizes[9]);
   printfl("some strings: '%s' '%s' '%s'", strings[1], strings[3], strings[9]);
   end();

   uint i;
   for (i = 0; i < n_new; i++) pool_store(pool, strings[i], sizes[i]);
}

// generate random strings (constants used here are defined somewhere else)
static char ** data_strings (char ** p_bytes) {
   char * bytes = malloc(n_strings * l * sizeof(char));
   check_mem(bytes);
   char ** strings = malloc(n_strings * sizeof(char *));
   check_mem(strings);
   char * s;
   uint i,j;
   srandom(time(NULL));

   for (i=0; i<n_strings; i++) {
      s = bytes + i*l;
      s[size] = NUL;
      for (j=0; j<size; j++) s[j] = '@' + random()%n_letters;
      strings[i] = s;
   }

   //~ for (i=0; i<n_strings; i++) printf("'%s' ", strings[i]); line();
   printfl("some strings: '%s' '%s' '%s'", strings[1], strings[3], strings[9]);
   * p_bytes = bytes;
   return strings;
}

// benchmark
static void chrono () {
   printfl ("=== chrono pool ===============================================");
   uint i;
   clock_t t1, t2;
   float dt;

   // test data string
   char * bytes;
   char ** strings = data_strings(& bytes);
   // string sizes are all equal to size (3)
   size_t * sizes = malloc(n_strings * sizeof(size_t));
   check_mem(sizes);
   for (i=0; i<n_strings; i++) sizes[i] = size;

   // debug ///////////////////////////////////////////////////////////////////
   printfl("n_strings:%u", n_strings);
   printfl("strings:%p (n°1:%p)", strings, strings[1]);
   printfl("sizes:%p", sizes);
   printfl("some sizes: %u %u %u", sizes[1], sizes[3], sizes[9]);
   printfl("some strings: '%s' '%s' '%s'", strings[1], strings[3], strings[9]);

   // now, feed the pool
   StringPool * pool = stringpool();
   t1 = clock();
   pool_store_pack(pool, strings, sizes, n_strings);
   t2 = clock();
   end();
   dt = 1.0 * (t2 - t1) / CLOCKS_PER_SEC;
   print("pool data   : "); show_pool_data(pool);
   print("pool stats  : "); show_pool_stats(pool, false);
   printfl("time  : %.3f", dt);

   free(bytes);
   free(strings);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T22:22:20.743

好的运行！实际上有 2 个错误，它们相互交互。首先，错误地重新定义了一个静态常量，该常量给出了初始字符串集合的大小以提供给池（实际上只有`""`，所以这个集合的长度为 1）。其次，2条指令的反转使池在初始化之前被使用。交互是初始化还使用 pool_store_pack 为池提供所述初始字符串。

==>

我得到的调试输出（并向您展示）反映了调用此 func pool_store_pack 进行池*初始化*的数据，而不是来自 chrono func（因此，`strings[1]`为零，因为初始集中只有一个字符串！）。并且`sizes`是 nil，因为它是静态常数错误地改变了......妈妈咪呀！

谢谢大家！不幸的是，我不能投票给你，因为只有评论......