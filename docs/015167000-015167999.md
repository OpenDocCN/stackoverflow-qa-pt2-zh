# StackOverflow 问答 15167000-15167999

# database - 使用 r 修改连字符数据

> ID：15167010
> 
> 赞同：2
> 
> 时间：2013-03-01T21:15:29.907
> 
> 标签：database, r, hyphen

我正在从 csv 文件中读取数据，数据中的一列采用三种不同的格式：

```
xxxxx-xxx-xx (5-3-2)
xxxxx-xxxx-x (5-4-1)
xxxx-xxxx-xx (4-4-2) 
```

我的目标是将这三种不同的样式变成一种样式，形式为：xxxxx-xxxx-xx (5-4-2)

为了使所有不同的形式相同，我需要在 3 个不同条件中的每一个的特定位置插入一个额外的零，如下所示：

```
xxxxx-0xxx-xx
xxxxx-xxxx-0x
0xxxx-xxxx-xx 
```

有人对实现这一目标的最佳方法有想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T21:28:06.560

我会使用`sprintf`and来做到这一点`strsplit`：

```
x <- c('11111-111-11', '11111-1111-1', '1111-1111-11')
y <- strsplit(x, '-')
myfun <- function(y) {
  first <- sprintf('%05d', as.integer(y[1]))
  second <- sprintf('%04d', as.integer(y[2]))
  third <- sprintf('%02d', as.integer(y[3]))

  paste(first, second, third, sep='-')
}

sapply(y, myfun)
# [1] "11111-0111-11" "11111-1111-01" "01111-1111-11" 
```

您也可以使用花哨的正则表达式或`gsubfn`包来执行此操作，但这可能有点矫枉过正！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-01T21:56:38.070

贾斯汀解决方案的略短且功能更强大的编程版本

```
numbers <- c('11111-111-11', '11111-1111-1', '1111-1111-11')
restyle <- function(number, fmt){
  tmp <- as.list(as.integer(strsplit(number, '-')[[1]]))
  do.call(sprintf, modifyList(tmp, list(fmt = fmt)))
}

sapply(numbers, restyle, fmt = '%05d-%04d-%02d', USE.NAMES = F) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-01T21:39:01.707

您是否在类似 Unix 的环境中工作？在命令行使用 sed 可能比使用 R 的正则表达式函数更容易。

```
echo "54324-965-23" | sed 's/\(.....\)-\(...\)-\(..\)/\1-0\2-\3/' 
```

会吐回来

```
54324-0965-23 
```

如果你想将它应用到整个文件，它看起来像

```
cat file1.txt | sed 's/\(.....\)-\(...\)-\(..\)/\1-0\2-\3/' > file2.txt 
```

如果您有多个 txt 更改操作，您可以将它们全部连接在一起

```
cat file1.txt | sed 's/\(.....\)-\(...\)-\(..\)/\1-0\2-\3/' | sed '2ndthing' | sed 'thirdthing' > file2.txt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T21:26:18.527

一种解决方案是首先删除连字符，然后将它们添加回所需的字符位置，如下所示：

```
> v <- c("01234-567-89","01234-5678-9","0123-4567-89")
> v
[1] "01234-567-89" "01234-5678-9" "0123-4567-89"
> #remove hyphens
> v <- gsub("-","",v)
> v
[1] "0123456789" "0123456789" "0123456789"
> #add hyphens
> paste(substr(v,1,4),substr(v,5,8),substr(v,9,10),sep="-")
[1] "0123-4567-89" "0123-4567-89" "0123-4567-89" 
```

# css - HTML 电子邮件 - Outlook.com/Hotmail CSS 覆盖样式

> ID：15167016
> 
> 赞同：3
> 
> 时间：2013-03-01T21:15:53.883
> 
> 标签：css, email, html-email, hotmail, outlook.com

我正在处理一封`<p>`在 hotmail 中的标签之间存在间距问题的电子邮件。我用

```
.ExternalClass, .ExternalClass p, .ExternalClass span,
.ExternalClass font, .ExternalClass td, .ExternalClass div {line-height: 100%;} 
```

但看起来 Hotmail 已经改变了他们的 CSS 结构。

我检查了该文件，并且调用了[一个外部 CSS](https://a.gfx.ms/wlx_sharedCtrl_sf6yJLkRwuDRl7g9anVpXg2.css)，它控制段落格式并去除头部中的任何内联样式或样式，特别是控制`<p>`. 这个 CSS 全局赋予段落 1.35em 的边距，但我希望它是 0.5em。

任何建议将被认真考虑。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T22:00:27.117

不幸的是，[Outlook.com 和 Hotmail 将忽略 CSS 边距](http://www.campaignmonitor.com/css/)，无论您如何尝试应用它。

不要打扰`<p>`标签 - 只需`<tr>`在`<table>`. 当您需要分隔内容时，请`<td>`在其自身中使用固定高度 empty `<tr>`。

# glsl - glsl 顶点着色器在 pc、mac 上编译而不是在另一台 pc 上编译

> ID：15167023
> 
> 赞同：0
> 
> 时间：2013-03-01T21:16:22.193
> 
> 标签：glsl, shader, vertex

所以，我有一台装有 nvidia geforce gtx 580 的 PC，一台装有 ATI 卡的 mac，然后是一台装有 geforce gtx 680M 的笔记本电脑。

顶点着色器可以在 580 和 ATI 上编译，但不能在 gtx 680M 上编译。

错误很有趣（不是）： **ERROR: 0:18: '': syntax error syntax error**

那行代码是：**int vIdStep = gl_VertexID % 9;**

我试图删除所有空格，添加额外的空行，移动行，......没有任何效果。

我在其他编译没有问题的着色器中使用**gl_VertexId 。**只有这个带有 % 的那个不能在 680M 上编译。

这是什么？其他人有这种经验吗？我能做些什么呢？

编辑：顺便说一句：这解决了问题，但这是一个糟糕的解决方案 IMO，我真的想要一个更好的解决方案： **int vIdStep = int(mod(float(gl_VertexID), 9));**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-04T12:32:09.963

好的，我终于发现了问题所在。我的便携式计算机有一个混合视频适配器：Intel/Nvidia。出于某种原因，即使在全屏模式下，驱动程序也一直在我的测试中选择英特尔适配器。因此......这是英特尔驱动程序中的一个错误。

目前您不能在 Intel HD Graphics 4000 上的 glsl 上使用 %。我现在将把错误提交给他们。

# javascript - `success` 功能是如何工作的，我该如何模仿它？

> ID：15167024
> 
> 赞同：0
> 
> 时间：2013-03-01T21:16:32.993
> 
> 标签：javascript, jquery, ajax, validation

我正在开发一个验证框架，需要一个布尔结果来知道验证是否成功。

这是我正在做的事情的快速浏览：

```
Stone.Validation({
 id:  "#InputTextId",//the id of the input you want to validate
 DataType: "string",//the Data Type of want to valide(string and integer for now are avaiable)
 MsgOk: "Correct",//optional: the msg you want to display if it is a string
 MsgWrog: "* Check this field",////optional: the msg you want to display if its not a string
 Destiny: "#someDivID",//the id that will some the correct of error message
}) 
```

如果验证失败，我不知道如何禁用表单提交。它只返回消息，而不是布尔值或类似的东西。

我正在寻找的示例：

```
Stone.Validation({
 id:  "#InputTextId",
 DataType: "string",
 MsgOk: "Correct",
 MsgWrog: "* Check this field",
 Destiny: "#someDivID",
 success: function(results)
{
   if(results)
    {
      //submit will work
    }
}
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:51:32.593

要控制表单提交，您必须使用表单的提交事件。以下是使用 jQuery 的方法：

```
$('form').submit(function(){
    // validate your form first
    if(!formIsValid) {
        // if validation didn't pass, cancel submission
        return false;
    }
}); 
```

# php - PHP 转 JSON 编码

> ID：15167030
> 
> 赞同：1
> 
> 时间：2013-03-01T21:16:54.540
> 
> 标签：php, json

我正在尝试使用 php 和 json_encode 编写此代码

```
{"patient": {"demographics": {}} 
```

}

这是我与 json 编码一起使用的数组。

```
Array("patient" =>  Array("demographics" =>  Array())) 
```

当我回显输出时，这就是我得到的：

```
{"patient":{"demographics":[]}} 
```

我真的认为这是我的一个愚蠢的错误。感谢所有帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-01T21:18:28.077

尝试

```
json_encode($your_array, JSON_FORCE_OBJECT) 
```

根据文档： http: [//php.net/json_encode](http://php.net/json_encode)

默认情况下，php数组`[]`在json'd时保持数组（），除非有一个非数字键，在这种情况下它将是一个对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:21:55.903

你也可以试试这个：

```
json_encode(Array("patient" =>  Array("demographics" => new stdClass))); 
```

这样，您可以在同一个 JSON 中拥有空数组和空对象，而使用其他答案是不可能的。

# c++ - 如何在“文件夹选择”对话框中将“我的音乐”作为默认选择路径

> ID：15167035
> 
> 赞同：0
> 
> 时间：2013-03-01T21:17:10.370
> 
> 标签：c++, special-folders

在 C++ 中打开文件夹选择对话框时，我试图将默认选择的路径设置为`%USERPROFILE%/My Music`，但我无法弄清楚。

```
this->diaActionFolder->SelectedPath = System::Environment::SpecialFolder::MyMusic; 
```

上面的代码导致这个错误 -

> 错误 C2664：“System::Windows::Forms::FolderBrowserDialog::SelectedPath::set”：无法将参数 1 从“System::Environment::SpecialFolder”转换为“System::String ^”

我想这意味着这`System::Environment::SpecialFolder::MyMusic`不是一个字符串（所以大概它是一个对象？）。在这种情况下，如何从中提取路径以便将其设置为默认值`SelectedPath`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:21:56.183

```
Environment::GetFolderPath(System::Environment::SpecialFolder::MyMusic) 
```

应该给出字符串值。

# android - 如何在 Eclipse 中打开这个 Android 项目？

> ID：15167044
> 
> 赞同：0
> 
> 时间：2013-03-01T21:18:14.897
> 
> 标签：android, eclipse

[https://github.com/android/platform_packages_apps_alarmclock](https://github.com/android/platform_packages_apps_alarmclock)

我将它克隆到我的 PC 上，并尝试从现有源创建一个新项目。我把它指向我下载的代码，但我有一堆错误。我进入项目属性，并将构建目标设置为 Google API (8)，这修复了很多错误，但我无法修复剩余的错误。这是我第一次将项目从 github 导入 Eclipse，所以我可能遗漏了一些简单的基本步骤。

编辑：添加错误列表我减少到 9 个错误（有些是骗子）

`ACTION_ALARM_CHANGED cannot be resolved or is not a field in Alarms.java`

`Cannot instantiate the type Vibrator in AlarmKlaxon.java`

`com.android.internal.R cannot be resolved to a variable in AlarmKlaxon.java and SetAlarm.java`

`mContext cannot be resolved in DigitalClock.java`(x5)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:23:58.540

> 文件 -> 导入... -> 现有项目到工作区 -> 选择项目

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T21:35:35.963

为什么在 project.properties 中目标是 android-3 (target=android-3)，将其写入 target=android-8，因为很多布局 xml 都使用匹配父级。然后清理项目（Eclipse->Project->Clean...）在此之后，不再有xml错误，但仍然存在一些java代码错误，这些错误来自使用com.android.internal.R，这是一个隐藏的安卓API？这解释了它的使用：http: [//devmaze.wordpress.com/2011/01/19/using-com-android-internal-part-5-summary-and-example/](http://devmaze.wordpress.com/2011/01/19/using-com-android-internal-part-5-summary-and-example/)

# git - 使用 Git url (git://github.com/...) 将源附加到 IntelliJ 项目

> ID：15167049
> 
> 赞同：4
> 
> 时间：2013-03-01T21:18:30.623
> 
> 标签：git, intellij-idea

IntelliJ 可以选择将源附加到项目，以便您可以查看预编译方法是如何实现的。您可以指定一个只读的 git 存储库作为源位置吗？

![在此处输入图像描述](../Images/9efcdd1ef553872aaf147c8093ea2e80.png)

例如，我希望能够说某些类的源代码位于 git 存储库中 git://github.com/project/sources。

***详细信息：*** *IntelliJ 12，私有 Gitorious 服务器*

***更新：*** *git url 格式`git://server/location`为 ，http git url 不可用。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:48:38.107

你可以尝试两件事：

1/ 如“[在 IntelliJ IDEA 中为 scala 项目](https://stackoverflow.com/a/13520832/6309)附加源”中所述，检查*其他*“附加源”菜单是否工作得更好：

> 如果尝试将源附加到特定库 - 在“ **`Project Structure -> Library -> +Attach File or Directories -> Sources`**”中，那么它可以工作。

2/ 使用 https 地址而不是 git url: `https://github.com/aUser/aProject.git`
(虽然这可能不适用于[私人 gitorious repos](https://gitorious.org/gitorious/pages/PrivateRepositories)，只有`git://gitorious.org/aUser/aProject.git`)

# c# - 使用 WPF 和 MVVM 设置数据绑定的问题

> ID：15167051
> 
> 赞同：1
> 
> 时间：2013-03-01T21:18:37.143
> 
> 标签：c#, wpf, data-binding, mvvm, viewmodel

我有一个使用 MVVM 的应用程序。我正在尝试通过将 ComboBox 连接到我的 ViewModel 中的属性来为我的 ComboBox 设置数据绑定。当我运行应用程序时，我收到此错误消息：

```
Message='Provide value on 'System.Windows.Data.Binding' threw an exception.' Line number '11' and line position '176'. 
```

这行 XAML 出现问题：

```
<ComboBox x:Name="schoolComboBox" HorizontalAlignment="Left" Margin="25,80,0,0" VerticalAlignment="Top" Width="250" FontSize="16" ItemsSource="{Binding LocationList}" SelectedItem="{Binding Source=LocationPicked}" /> 
```

下面是我尝试使用的 ViewModel。

```
using QMAC.Models;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

using System.Windows;

namespace QMAC.ViewModels
{
  class MainViewModel : ViewModelBase
  {
    Address address;
    Location location;
    private string _locationPicked;

    public MainViewModel()
    {
        address = new Address();
        location = new Location();
    }

    public List<string> LocationList
    {
        get { return location.site; }
        set
        {
            OnPropertyChanged("LocationList");
        }
    }

    public string LocationPicked
    {
        get { return _locationPicked; }
        set
        {
            _locationPicked = value;
            MessageBox.Show(_locationPicked);
            OnPropertyChanged("LocationPicked");
        }
    }
  }
} 
```

我是否错误地设置了属性以使其与数据绑定一起使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T21:23:47.707

您没有`SelectedItem`正确绑定。您需要设置`Path`绑定而不是`Source`. 我假设您已将数据上下文设置为 MainViewModel。由于该`LocationPicked`属性位于 MainViewModel 中，因此您无需设置`Binding.Source`. 使用 更改绑定以在 SelectedItem 上设置路径`{Binding LocationPicked`。

# c# - AForge ExhaustiveTemplateMatching 工作极其缓慢

> ID：15167054
> 
> 赞同：0
> 
> 时间：2013-03-01T21:18:54.937
> 
> 标签：c#, .net, image-processing, aforge

我正在尝试使用 AForge 框架在另一个图像中查找一个图像的坐标：

```
ExhaustiveTemplateMatching tm = new ExhaustiveTemplateMatching();
TemplateMatch[] matchings = tm.ProcessImage(new Bitmap("image.png"), new Bitmap(@"template.png"));
int x_coordinate = matchings[0].Rectangle.X; 
```

ProcessImages 大约需要 2 分钟来执行。

图片大小约为 1600x1000 像素 模板大小约为 60x60 像素

有谁知道如何加快这个过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-16T07:47:24.407

作为其他答案的补充，对于您的情况，我想说：

> 图片大小约为 1600x1000 像素 模板大小约为 60x60 像素

这个框架不是最合适的。您要实现的目标是在其他图像中搜索更多图像，而不是比较具有不同分辨率的两个图像（例如可以使用“在 Google 上搜索此图像”）。

关于这个

> 称为金字塔搜索。

确实，对于**更大的**图像，该算法的运行速度更快。实际上[图像金字塔](http://opencv-code.com/tutorials/fast-template-matching-with-image-pyramid/)是基于[模板匹配](https://en.wikipedia.org/wiki/Template_matching)的。如果我们采用最流行的实现（我发现并使用过）：

```
private static bool IsSearchedImageFound(this Bitmap template, Bitmap image)
    {
        const Int32 divisor = 4;
        const Int32 epsilon = 10;

        ExhaustiveTemplateMatching etm = new ExhaustiveTemplateMatching(0.90f);

        TemplateMatch[] tm = etm.ProcessImage(
            new ResizeNearestNeighbor(template.Width / divisor, template.Height / divisor).Apply(template),
            new ResizeNearestNeighbor(image.Width / divisor, image.Height / divisor).Apply(image)
            );

        if (tm.Length == 1)
        {
            Rectangle tempRect = tm[0].Rectangle;

            if (Math.Abs(image.Width / divisor - tempRect.Width) < epsilon
                &&
                Math.Abs(image.Height / divisor - tempRect.Height) < epsilon)
            {
                return true;
            }
        }

        return false;
    } 
```

它应该给你一张接近这个的图片：

![页面金字塔](../Images/800733fba00b25f3461c63d806420fc2.png)

作为底线 - 尝试使用不同的方法。也许更接近[Sikuli](http://www.sikuli.org/) 与[.Net的](http://sourceforge.net/projects/sikuli4net/)[集成](https://qaagent.wordpress.com/2013/07/17/how-to-use-sikuli-in-my-c-coded-tests/)。或者你可以试试[accord .Net](http://accord-framework.net/)较新版本的AForge。

如果工作量太大，您可以尝试通过裁剪所需的页面元素来扩展您的屏幕截图功能（Selenium[示例](https://stackoverflow.com/questions/25670634/are-there-any-good-examples-of-how-to-take-a-screenshot-in-selenium-webdriver-c)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T08:13:25.063

对于具有您正在使用的模板大小的图像的最新 CPU 来说，2 分钟似乎太多了。但是有几种方法可以加快这个过程。第一个是使用较小的规模。这称为金字塔搜索。您可以尝试将图像和模板除以 4，这样您将拥有 400x250 的图像和 15x15 的模板并匹配这个较小的模板。这将运行得更快，但它也将不太准确。然后，您可以使用通过 15x15 模板找到的有趣像素，并使用 60x60 模板搜索 1600x1000 图像中的相应像素，而不是在整个图像中搜索。

根据模板详细信息，您可以尝试使用更低的比例（1/8）。

要知道的另一件事是更大的模板会运行得更快。这是违反直觉的，但使用更大的模板，您将有更少的像素来比较。因此，如果可能，请尝试使用更大的模板。如果您的模板已经尽可能大，有时这种优化是不可能的。

# spring - Httpsessionlistener：创建了两个会话，没有一个被销毁

> ID：15167055
> 
> 赞同：0
> 
> 时间：2013-03-01T21:18:55.053
> 
> 标签：spring, comet, server-push, httpsession

# 编辑：我重新提出了问题

我正在使用`Spring`and `GWTEventService`（与 基本相同`Comet`）。当我制作一个更简单的 HttpSessionListener 时，我看到**sessionCreated() 被调用了两次，而 sessionDestroyed()**没有被调用。这是为什么？一个用户有两个会话吗？？？第二个`HttpSession`是在我第一次在会话 bean ( `Spring`) 中设置一些信息时创建的。

```
import javax.servlet.http.HttpSessionEvent;
import javax.servlet.http.HttpSessionListener;

public class SomeSessionListener implements HttpSessionListener {

  @Override
  public void sessionCreated(HttpSessionEvent se) {
    log.info("New session was created, source= " + se.getSource());
  }

  @Override
  public void sessionDestroyed(HttpSessionEvent se) {
    log.info("A session was closed");
  } 
} 
```

示例输出：

```
Application has started
New session was created, source= org.mortbay.jetty.servlet.HashSessionManager$Session:21u4n0rnyp4i@24662444
New session was created, source= org.mortbay.jetty.servlet.HashSessionManager$Session:n9wm8tsj1ote@28925695
Application interrupted by client 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T16:54:22.777

我找到了另一个问题的答案： [Spring security concurrent-session and HttpSessionListener question](https://stackoverflow.com/questions/6347835/spring-security-concurrent-session-and-httpsessionlistener-problem?rq=1#comment7429710_6347835)

简而言之： **最好对会话 bean 使用销毁方法。**

# php - IMAP 解析地址中的 ADL 字段是什么？

> ID：15167056
> 
> 赞同：2
> 
> 时间：2013-03-01T21:19:11.073
> 
> 标签：php, email, imap, mime

[当使用](http://php.net/imap_headerinfo)PHP 的[IMAP](http://www.php.net/imap_rfc822_parse_adrlist)扩展解析电子邮件消息时，每个地址都有一个响应对象，格式如下。

```
Returns an array of objects. The objects properties are:

* mailbox - the mailbox name (username)
* host - the host name
* personal - the personal name
* adl - at domain source route 
```

但是，我似乎找不到任何关于**ADL**实际是什么或何时使用它的示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-06T15:59:50.960

> 这是一个过时的“域列表”。它必须被接受但不再使用。- @mkaatman

# javascript - 如何向 twitter API 发出 POST 更新请求？

> ID：15167057
> 
> 赞同：0
> 
> 时间：2013-03-01T21:19:11.490
> 
> 标签：javascript, twitter, windows-store-apps, winjs

我一直在尝试向 twitter [TwitterAPI: update_with_media](https://dev.twitter.com/docs/api/1/post/statuses/update_with_media)发出 POST 请求，但显然我没有正确验证，因为我收到“错误验证”错误......

我正在使用此 windows8 示例为我进行身份验证：[Web Authentication](http://code.msdn.microsoft.com/windowsapps/Web-Authentication-d0485122)

它正确地给了我令牌（至少没有错误退出状态......），那么我做错了什么？

我一直在查看 twitter 的文档，但没有找到如何将 oauth 令牌“绑定”到请求，就像我在 facebook 中所做的那样：graph_url/me/access_token=xxxxx 或“access_token”作为 POST 参数。那是缺少的吗？

请求代码如下所示：

```
 var formData = new FormData();
    formData.append("status", "stuff");
    formData.append("media[]", arrImgs);
    WinJS.xhr({type: "POST", url: "https://upload.twitter.com/1/statuses/update_with_media.json", data: formData}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:17:35.373

只是从您提供的链接。您应该将令牌添加为标头：

```
 function sendPostRequest(url, authzheader) { 
    try { 
        var request = new XMLHttpRequest(); 
        request.open("POST", url, false); 
        request.setRequestHeader("Authorization", authzheader); 
        request.send(null); 
        return request.responseText; 
    } catch (err) { 
        WinJS.log("Error sending request: " + err, "Web Authentication SDK Sample", "error");             
    } 
} 
```

# iphone - Core Data 从不释放从外部存储加载的 NSData

> ID：15167059
> 
> 赞同：5
> 
> 时间：2013-03-01T21:19:22.493
> 
> 标签：iphone, ios, objective-c, core-data, automatic-ref-counting

所以我`Core Data`用来存储一些图像。（子类也是用 latest 生成的`mogenerator`）

（而且我也在使用 ARC）

是的，我知道我可以保留一个参考并将其存储在磁盘上，但我想：

*“嘿，他们做了一个选择，所以我可以做到这一点，而不必自己管理！”*

所以我试了一下，它工作得很好，除了所有以这种方式加载的数据**永远不会被释放**。

* * *

![在此处输入图像描述](../Images/293f9fcd921b8ddfd26ed5d015234dbc.png)

![在此处输入图像描述](../Images/3cb2bf934a4bf0135180a5adbda9cf80.png)

* * *

在负责显示图像的 ViewController 的初始化中，我给它通常的 main `NSManagedObjectContext`。

在我调用的方法中，`viewDidAppear`我`UIScrollView`使用图像设置：

**编辑：所以这不是一个真正的获取请求，我有一个`Entity1`与图像一对多的图像，我用它来获取我从同一上下文中获取这个 entity1 的图像。我只是想简化以更好地解释。**

```
- (void)setupScrollViewWithEntity1:(Entity1 *)entity1 {
    DDLogVerbose(@"-- %@ : SETUP SCROLL VIEW --", self);
    // I remove any previous subviews
    [self.scrollView.subviews makeObjectsPerformSelector:@selector(removeFromSuperview)];
    self.scrollView.contentSize = self.scrollView.frame.size;

    /* Here I get the imagesArray with a NSFetchRequest */ 
    //So it's not really a fetch request I have an `Entity1` which have one-to-many with images and I use it to get the images
    NSSet *imagesSet = entity1.images;

    // So I have an NSArray holding all the Image object
    for (Image *image in imagesSet) {
        CGRect frame = self.scrollView.frame;
        frame.origin.x = image.numberValue*frame.size.width;
        UIScrollView *scrollView = [[UIScrollView alloc]initWithFrame:frame];
        scrollView.contentSize = self.scrollView.frame.size;
        UIImageView *imageView = [[UIImageView alloc]initWithFrame:self.scrollView.frame];
        imageView.image = [UIImage imageWithData:image.image];
        imageView.contentMode = UIViewContentModeScaleAspectFit;
        imageView.userInteractionEnabled = YES;
        [scrollView addSubview:imageView];
        scrollView.delegate = self;
        scrollView.minimumZoomScale = 1.0;
        scrollView.maximumZoomScale = 3.0;
        [self.scrollView addSubview:scrollView];
    }
} 
```

}

在`viewWillDisappear`我保存时`NSManagedObjectContext`，我希望当控制器被释放时，所有数据也会被释放，但它会永远保留在内存中。

这条线以某种方式保留它不知道为什么：`imageView.image = [UIImage imageWithData:image.image];`

我花了 3 天时间尝试使用所有东西，`Instruments`重新检查我是否没有在某处保留强参考。

事情是我确定的，我在工具中`UIViewController`看到了它，但由于某种原因，数据永远保留在内存中，直到应用程序**崩溃**。`dealloc``Instruments``Allocation`

 *** * *

这是内存中未解除分配的约 20 张图像的列表：

![在此处输入图像描述](../Images/1758d9ad38221973710aa5f21f656246.png)

* * *

这是第一个对象的详细信息：

![在此处输入图像描述](../Images/0fbfe6b22c5701bccb3b847b0b561311.png)

感谢您阅读到这里，我真的很绝望:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T00:38:31.817

完成图像后，您是否尝试`reset`过调用？`NSManagedObjectContext`这会从内存对象图中逐出任何已加载的对象。下次需要它们时，需要从磁盘/数据库中获取它们。**

# vb6 - vb6，未使用模块为标签定义变量

> ID：15167061
> 
> 赞同：1
> 
> 时间：2013-03-01T21:19:28.463
> 
> 标签：vb6, module

很抱歉问了这么一个愚蠢的问题..但是对于我的生活，我无法得到它..我已经到处搜索了......这是我的代码的重新创建，它给出了同样的错误。这是我可以重新创建的最基本的例子。

我不明白为什么我必须声明一个标签？？（或一个物体）

我想要完成的是使用我的主表单来调用所有模块。

这是表格

```
'frmMain.frm
Option Explicit

Public Sub btnOpen_Click()
    GetNum
End Sub 
```

这是模块

```
'modGet.bas
Option Explicit

Public Sub GetNum()
    Dim a As String
    Dim b As String

    a = "hello"
    b = "world"
->  Label1.Caption = a    'ERROR, Compile Error, Variable not Defined. (vb6)
    Label2.Caption = b
End Sub 
```

是的，我有一个表单，带有一个名为“btnOpen”的按钮，我有 2 个名为“Label1”和“Label2”的标签

如果我添加..

```
Dim Label1 As Object  'in MODULE 
```

我得到一个不同的错误..错误'91'对象变量或未设置块变量

如果我将所有内容放在 1 FORM 中，它可以工作..（但我想使用单独的模块）我注释掉了“OPTION EXPLICIT”......同样的错误。

在另一个测试中，我收到了 TextBox 的错误。

```
TextBox1.Text = x 
```

一旦我得到了这个答案，我就可以将它应用于所有事情......我相信它也很简单而且我觉得很愚蠢。:-(

我的主要事情之一是查询 WMI，我得到标签的错误“91”（这是在 For Each 循环中）..但它同样的错误，就像它让我声明对象..（使用模块）

```
Label1.Caption = objItem.Antecedent 
```

如果有人可以请帮助我...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T08:26:42.927

利用

```
form1.label1.caption = a 
```

但请确保 form1 已加载

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T23:26:56.100

您收到错误是因为 Label1 和 Label2，以及您的其他控件不存在于 modGet.bas 的范围内。它们只能从表单中引用（访问或设置的属性）。添加时出现的不同错误`Dim Label1 As Object`是因为您将 Label1 定义为对象，而不是标签，并且对象没有 Caption 属性。除非您有充分的理由将 GetNum 子放在 .bas 模块中，否则将其移到表单中，它应该可以工作。

我修改了第二个例子。它将修改传递给它的字符串，当执行返回到表单时，您可以将字符串分配给您的文本框。我反对从另一个模块修改表单上的控件，因为它违背了[封装](https://softwareengineering.stackexchange.com/q/149041/82908)的想法。

```
'modGet.bas
Option Explicit

Public Function GetHello() As String
    Dim strHello As String

    strHello = "Hello"
    GetHello = strHello

End Function

'frmMain.frm
'Option Explicit

Public Sub btnOpen_Click()
    Label1.Caption = GetHello()
End Sub 
```

有点不同的东西。

```
'MyModule.bas
Public Sub HelloWorld ByRef Value1 As String, ByVal Value2 As String)

    On Error GoTo errHelloWorld

    Value1 = "Hello"
    Value2 = "World"

    Exit Sub

errHelloWorld:
    ' deal with the error here

End Sub

'frmMain.frm
Option Explicit

Private Sub frmMain_Load()
    Dim strText1 As String
    Dim strText2 As String

    HelloWorld(strText1, strText2)
    Text1.Text = strText1
    Text2.Text = strText2
End Sub 
```

我还在第二个示例中添加了基本错误处理

# php - 数据库选择失败。phpmyAdmin 上的未知数据库错误

> ID：15167064
> 
> 赞同：0
> 
> 时间：2013-03-01T21:19:35.780
> 
> 标签：php, sql, database, phpmyadmin, xampp

我无法通过本地主机上的 PHP 脚本选择我的数据库。

我 100% 确定 db 名称拼写正确，事实上它很好地出现在 phpmyAdmin 上，只有当我尝试通过在 localhost 上运行 PHP 脚本连接到它时，它才会显示以下错误：

```
Database selection failed Unknown database 'fokrul_justdeals' 
```

我的 PHP 代码在这里：

```
<?php
    class database{
        public $connection;
        // the user for the database
        public $user = 'root';  
        // the pass for the user
        public $pswd = '';
        // the db from where you want to parse the info  
        public $db = 'fokrul_justdeals';
        // the host where db is located
        public $host = 'localhost';

        function __construct(){
            $this->connect();
        } 

        private function connect(){
            $this->connection = mysql_connect("$host", "$user", "$pswd") or die("Database connection failed ". mysql_error());
            if($this->connection){
                // we select the db that we want to work with
                mysql_select_db($this->db, $this->connection) or die("Database selection failed " . mysql_error());
            }
        } 
```

我已经阅读了数千个论坛，并且正在尽我所能。但不知道这里出了什么问题？

一件有趣的事情是，如果我在 PHP 脚本中将数据库名称更改为“mysql”，那么在所有数据库中，只有系统生成的数据库“mysql”会连接。

我尝试创建不同的数据库名称，还尝试创建新用户并向他们添加完全权限。没有什么对我有用:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T21:35:44.653

```
$this->connection = mysql_connect("$host", "$user", "$pswd") or die("Database connection failed ". mysql_error()); 
```

你应该使用

```
$this->host,$this->user,$this->pswd 
```

# google-drive-api - 将所有权从服务帐户更改为 Google Apps 域时出现问题

> ID：15167068
> 
> 赞同：3
> 
> 时间：2013-03-01T21:20:30.710
> 
> 标签：google-drive-api

我有一个使用 Google 服务帐户创建 Fusion Tables 或 Google 电子表格文档的应用程序。然后，此应用程序将该文档的所有权更改为另一个用户 (joe@gmail.com)。这使应用程序能够发布（插入行）到文档，但将文档的完全控制权交给指定的用户。

如果其他用户是 @gmail.com 用户，一切正常。但是，如果是apps域用户（例如，xxx@camfed.org），权限改变会导致这个错误：

{“错误”：{“错误”：[{“域”：“全局”，“原因”：“内部错误”，“消息”：“内部错误”}]，“代码”：500，“消息”：“内部错误" }}{"value":"xxx@camfed.org","role":"owner","type":"user","kind":"drive#permission"}

这是结果矩阵：

```
 Service Account created by
                                           xxx@gmail.com           xxx@camfed.org

Ownership assigned to: yyy@gmail.com           works                     works
Ownership assigned to: xxx@camfed.org         broken                     broken
Ownership assigned to: yyy@camfed.org         broken                     broken 
```

应用程序域的 Google 云端硬盘权限更改是否中断？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T19:08:10.330

这是因为在更改所有权时，两个电子邮件域必须属于同一个域。然后可以将所有权更改给其他用户。

# powershell - PowerShell: Create Local User Account

> ID：15167069
> 
> 赞同：57
> 
> 时间：2013-03-01T21:20:47.640
> 
> 标签：powershell, powershell-2.0

I need to create a new local user account, and then add them to the local **Administrators** group. Can this be done in PowerShell?

EDIT:

```
# Create new local Admin user for script purposes
$Computer = [ADSI]"WinNT://$Env:COMPUTERNAME,Computer"

$LocalAdmin = $Computer.Create("User", "LocalAdmin")
$LocalAdmin.SetPassword("Password01")
$LocalAdmin.SetInfo()
$LocalAdmin.FullName = "Local Admin by Powershell"
$LocalAdmin.SetInfo()
$LocalAdmin.UserFlags = 64 + 65536 # ADS_UF_PASSWD_CANT_CHANGE + ADS_UF_DONT_EXPIRE_PASSWD
$LocalAdmin.SetInfo() 
```

I have this, but was wondering if there is anything more PowerShell-esque.

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2013-05-20T13:02:30.447

Another alternative is the old school [NET USER](https://technet.microsoft.com/en-us/library/cc771865.aspx) commands:

`NET USER username "password" /ADD`

OK - you can't set all the options but it's a lot less convoluted for simple user creation & easy to script up in Powershell.

`NET LOCALGROUP "group" "user" /add` to set group membership.

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2016-09-12T15:44:52.420

As of PowerShell 5.1 there cmdlet `New-LocalUser` which could create local user account.

Example of usage:

Create a user account

```
New-LocalUser -Name "User02" -Description "Description of this account." -NoPassword 
```

or Create a user account that has a password

```
$Password = Read-Host -AsSecureString
New-LocalUser "User03" -Password $Password -FullName "Third User" -Description "Description of this account." 
```

or Create a user account that is connected to a Microsoft account

```
New-LocalUser -Name "MicrosoftAccount\usr name@Outlook.com" -Description "Description of this account." 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-07-10T03:58:56.577

Try using [Carbon's](http://get-carbon.org) [Install-User](http://get-carbon.org/help/Install-User.html) and [Add-GroupMember](http://get-carbon.org/help/Add-GroupMember.html) functions:

```
Install-User -Username "User" -Description "LocalAdmin" -FullName "Local Admin by Powershell" -Password "Password01"
Add-GroupMember -Name 'Administrators' -Member 'User' 
```

***Disclaimer:*** I am the creator/maintainer of the Carbon project.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-06-12T20:49:47.320

As of 2014, [here is a statement](https://blogs.technet.microsoft.com/heyscriptingguy/2014/10/02/use-powershell-to-create-local-groups/) from a Microsoft representative (the Scripting Guy):

> As much as we might hate to admit it, there are still no Windows PowerShell cmdlets from Microsoft that permit creating local user accounts or local user groups. We finally have a Desired State Configuration (DSC ) provider that can do this—but to date, no cmdlets.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-07T00:06:16.280

```
Import-Csv C:\test.csv |
Foreach-Object {
  NET USER    $ _.username   $ _.password /ADD
  NET LOCALGROUP "group" $_.username  /ADD
} 
```

edit csv as username,password and change "group" for your groupname

:) worked on 2012 R2

# perl - perl中的单引号和双引号

> ID：15167071
> 
> 赞同：2
> 
> 时间：2013-03-01T21:21:16.053
> 
> 标签：perl, postgresql, quotes, double-quotes

我是 perl 的新手，我正在尝试从 Perl 脚本执行操作系统命令。

操作系统命令用 执行[`IPC::Open3`](https://metacpan.org/module/IPC%3a%3aOpen3)，命令如下

```
$cmd = "mycommand --add \"condition LIKE '%TEXT%' \""; 
```

该命令应该将包含在“add”之后的字符串插入到数据库中。

问题是它在没有单引号的情况下将记录插入数据库`%TEXT%`，如下所示：

```
condition LIKE %TEXT% 
```

如果我在命令提示符下执行命令，它会正确插入字符串。

我应该如何格式化双引号和单引号，以便正确插入数据库？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T21:34:07.723

通过将命令放在单个字符串中，您将通过系统的外壳对其施加影响。（你没有提到它是 cmd.exe 还是 bash 或其他有趣的东西。）

建议：

1.  将系统命令创建为字符串数组将避免 shell 重新插入命令行。 `@cmd = ('mycommand', '--add', q(condition LIKE '%TEXT%'));`

2.  添加额外的反斜杠以保护 shell 中的单引号。预先添加`echo`到您的命令可以帮助调试....

3.  （我个人最喜欢的）不要为您的数据库访问而掏腰包。 [`use DBI`](http://metacpan.org/module/DBI#NAME "DBI - Perl 的数据库独立接口").

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T06:21:16.103

```
$cmd = q{mycommand --add "condition LIKE '%TEXT%'"}; 
```

`qq`用于双引号，`q`用于单引号。

这样，它就可以使用整个命令。

# java - 如何对在 JCombobox 中选择的项目进行测试

> ID：15167076
> 
> 赞同：-5
> 
> 时间：2013-03-01T21:21:27.153
> 
> 标签：java, string, swing, if-statement

我想清楚地重新定义我的主题，因为它不清楚。

所以我有两个 JCombobox。如果我在第一个中选择一个项目，第二个显示项目。

第一个和第二个 JCombobox 填充来自 mysql 的请求，

我创建了两个方法，

一个填充第一个 JCombobox ：

代码 ：

```
public void fillJCBOXPrj(  )
  {
      connexion c = new connexion();
      Statement s ;
       ResultSet rs ;
        try {
           s = c.createStatement();
     rs =c.selection("SELECT Distinct(IdProjet),idpro,NomProjet FROM projet where projet.iduser='"+this.getid()+"' ");
     while(rs.next())
     {
             String num =  rs.getString("idpro");
             String nom = rs.getString("NomProjet");
             String ref  = rs.getString("IdProjet");
             jComboBox1.addItem(new RF(nom,ref,num));
     }  } catch (Exception ex) {
             ex.printStackTrace();
        }
  } 
```

sconde 方法：根据第一个 JCombobox 中的选定项填充第二个 JCombobox

```
Code :

 public void fillJCBOXActivite()
  {
       RF n = (RF) jComboBox1.getSelectedItem();

      connexion c = new connexion();

      Statement s ;
       ResultSet rs ;
        try {
           s = c.createStatement();
            System.out.println(n.num);
     rs =c.selection("SELECT idactiv,NomActiviter,Phase FROM activiter WHERE activiter.IDProjet='"+n.num+"' ");
     while(rs.next())
     {
             String num =  rs.getString("idactiv");
             String nom = rs.getString("NomActiviter");
             String ref  = rs.getString("Phase");
             jComboBox3.addItem(new RF(nom,ref,num));

     }  } catch (Exception ex) {
             ex.printStackTrace();
        }

  } 
```

它 `RF n = (RF) jComboBox1.getSelectedItem();` 调用类 RF 以返回请求中使用的第一个 JCombobox 中所选项目的“数量”，

```
RF **n** = (RF) jComboBox1.getSelectedItem();
.....
....
  rs =c.selection("SELECT idactiv,NomActiviter,Phase FROM activiter WHERE activiter.IDProjet=**'"+n.num+"'** "); 
```

射频类：

```
class RF
{
    public final String nom;
        public final String ref;
    public final String num;

    public RF(String nom, String ref,  String num)
    {
        this.nom = nom;
        this.num = num;
                this.ref = ref;
    }

    @Override
    public String toString()
    {
        return   ref +" - " +nom  ;
    }
} 
```

最后我确实在应用程序启动时调用了方法，所以我这样做了，

私人无效formWindowOpened（java.awt.event.WindowEvent evt）{

填充JCBOXPrj(); 填充JCBOXActivite();

}

但问题是，如果我在第一个 JCombobx 中没有任何项目（数据库表中没有数据），那么它会在这一行中给出错误

我猜错误来自'n.num'

```
java.lang.NullPointerException
    at UserFrame.fillJCBOXActivite(UserFrame.java:202) 
```

所以想对 n.num 进行测试，如果第一个 JCombobox 没有 Items 则什么也不做

感谢您的帮助，我希望现在很清楚，因为英语不好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:26:55.337

关于您的代码的一些评论。您应该将您的字段标记为私有，然后通过 getter/setter 访问它们。

```
class RF
{
private final String nom;
private final String ref;
private final String num; 
```

无论如何，我不知道为什么它们是最终的（我认为它们不应该）。然后

```
 RF n = (RF) jComboBox1.getSelectedItem(); 
```

肯定会抛出 ClassCastException，所以永远不会到达这一行

```
 if(!(n.num.equals(""))) // dont work !! 
```

# php - 如果设置则添加到数组

> ID：15167077
> 
> 赞同：2
> 
> 时间：2013-03-01T21:21:27.840
> 
> 标签：php, arrays, isset

有没有更好/更短的方法来做到这一点？

每个变量都是一个被调用的 MySQL 表值。我有一个主表和一个覆盖表，因此调用第一个表，提取结果数组，然后调用覆盖表并提取这些结果以覆盖第一个提取。

```
if (isset($Price1)){
    $AllPrices[] = $Price1;}
if (isset($Price2)){
    $AllPrices[] = $Price2;}
if (isset($Price3)){
    $AllPrices[] = $Price3;}    
if (isset($Price4)){
    $AllPrices[] = $Price4;}
if (isset($SPrice1)){
    $AllPrices[] = $SPrice1;}
if (isset($SPrice2)){
    $AllPrices[] = $SPrice2;}
if (isset($SPrice3)){
    $AllPrices[] = $SPrice3;} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T21:26:05.193

我过去做过这样的事情，但我不推荐它：

```
$variables = array("Price1", "Price2", "Price3", "Price4", "SPrice1", "SPrice2", "SPrice3");

$AllPrices = array();

foreach ($variables as $variable)
{
    if (isset($$variable))
        $AllPrices[] = $$variable;
} 
```

有关语法在 PHP 中如何工作的更多信息，请参见[此处。](http://fr.php.net/manual/en/language.variables.variable.php)`$$`

但我同意你的帖子的评论......你真的应该再看看你是如何获得这些数据的。这个解决方案至少并不理想。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:37:53.357

你也可以这样做：

```
for($i = 1; $i < 4; $i++){
    $current = ${'AllPrices'.$i};
    isset($current) && array_push($AllPrices, $current);
} 
```

正如上面的答案中所发布的，使用变量名数组更有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T21:40:46.423

**不推荐这种结构。**

而不是`$price1, $price2, ...` **使用数组**- `$price[1], $price[2], ...`（对 $SPrice 执行相同操作）。

**然后你可以使用一个简单的`array_merge`：**

```
$AllPrices = array_merge($price, $SPrice); 
```

# gwt - 在不滚动到网格顶部的情况下删除 GWT Datagrid 中的一行

> ID：15167078
> 
> 赞同：3
> 
> 时间：2013-03-01T21:21:29.983
> 
> 标签：gwt

我有一个数据网格，每页可以显示很多行。假设我每页显示 25 行。然而，网格的可视区域只有 10 行。即整个网格只有400px，每行40px。所以网格上有一个滚动条。

当我删除网格中的单行时，网格会自动移动到网格中的第一行。如果我滚动了底部并删除了最后一行，我将再次移动到第一行。

我尝试了几种方法来解决这个问题，但我找不到一个可以按照我想要的方式工作的解决方案。

我尝试使用 scrollIntoView() 方法将已删除行之前或之后的行直接滚动到视图中。

我已经尝试弄清楚如何确定删除之前哪些行在可见范围内，但是 getVisibleRange() 方法与页面范围相关，而不是实际显示的范围。

我已经在网上搜索过这个问题，似乎我是唯一一个遇到这个问题的人。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-03T21:02:02.117

我有同样的问题，我发现如果 dataGrid 有 keyboardSelectionPolicy="BOUND_TO_SELECTION"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T23:02:55.437

如果您使用[ListDataProvider](http://google-web-toolkit.googlecode.com/svn/javadoc/2.1/com/google/gwt/view/client/ListDataProvider.html)来管理 DataGrid 的数据，那么在删除/添加项目时，DataGrid 将不会滚动。

这是一个在不滚动的情况下删除网格行的最小示例（全部包含在入口点类中）：

### DataGrid 行的类：

```
 private class Item{
        public String text;
        public int value;
        public Item(String text, int value){
            this.text = text;
            this.value = value;
        }
    } 
```

### 填充数据网格：

这里我使用一个私有变量 ,`data`来保存 DataGrid 的项目。请注意，我们必须通过该方法附加`dataGrid`到。`data``addDataDisplay`

```
 ListDataProvider data;
    public void onModuleLoad() {
        // build grid:
        DataGrid dataGrid = new DataGrid();
        BuildColumns(dataGrid);
        dataGrid.setWidth("300px");
        dataGrid.setHeight("300px");
        // add items:
        data = new ListDataProvider();
        for(int i = 1; i < 25; i++){
            data.getList().add(new Item("Item " + i, i));
        }
        data.addDataDisplay(dataGrid);
        // display:
        RootPanel.get().add(dataGrid);
    } 
```

### 构建数据网格：

此私有方法用于构建 DataGrid 的列。`delCol`在用于侦听按钮列的单击事件的 FieldUpdater 内部，我们从 中删除相应的项目`data`，并调用`data.refresh()`以更新 DataGrid 显示。

```
 private void BuildColumns(DataGrid dataGrid){
       Column textCol = new Column(new SafeHtmlCell()) {
            @Override
            public SafeHtml getValue(Item object) {
                    SafeHtmlBuilder sb = new SafeHtmlBuilder();
                sb.appendEscaped(object.text);
                    return sb.toSafeHtml();
            }
        };
        dataGrid.addColumn(textCol);
        dataGrid.setColumnWidth(textCol, 75, Unit.PCT);

        Column deleteCol = new Column(new ButtonCell()) {
            @Override
            public String getValue(Item object) {
                return "Delete " + object.value;
            }
        };
        deleteCol.setFieldUpdater(new FieldUpdater() {

            @Override
            public void update(int index, Item object, String value) {
                data.getList().remove(index);
                data.refresh();
            }
        });
        dataGrid.addColumn(deleteCol);
    } 
```

我将此代码放在一个新的 GWT 项目中并对其进行了测试。删除行时 DataGrid 不滚动。

# jquery - 如何在页面刷新时停止 jQuery 动画重新启动？

> ID：15167082
> 
> 赞同：0
> 
> 时间：2013-03-01T21:21:56.733
> 
> 标签：jquery, jquery-animate, reload, page-refresh

我创建了一个使用 jquery 动画的搜索表单，例如[NextLevelSearch](http://webstuffshare.com/demo/NextLevelSearch/)。我希望当我打开搜索表单并刷新页面时它不会关闭。我怎样才能做到这一点？

我尝试过但没有用`e.preventDefault();`，`return false;`我知道这与我的问题无关。

这是我的代码：

```
$globalsearch_submit.click(function(){
    $('#stat').hide();
    $('.wrapper-simple').animate({'width':'275px'})
        .end().find('.wrapper-simple input[type=text]').css({opacity: 0, visibility: "visible"}).animate({'width': '231px', opacity: 1}) 
        .end().find('.wrapper-simple .button').animate({ 'right': '40px' })
        .end().find('.wrapper-simple input[type=submit]').animate({'marginLeft':'235px', opacity: 1}, 10)               
    return false;
}); 
$('.wrapper-simple input[type=submit]').click(function() {
    $('#stat').show();
    $('#stat').delay(500).css('opacity',0).show().animate({opacity:1},100); 

    $('.wrapper-simple').animate({'width':'40px'}) 
        .end().find('.wrapper-simple input[type=text]').animate({'width': '1px', opacity: 0})
        .end().find('.wrapper-simple .button').animate({ 'right': '0' })
        .end().find('.wrapper-simple input[type=submit]').animate({'marginLeft':'0', opacity: 0}).attr('value', ''); 
    return false;
}); 
```

请帮忙！谢谢你。

（我很抱歉我的英语不好）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T17:09:05.597

我会使用文档哈希（window.location.hash）来保存页面的当前状态；

```
$('.wrapper-simple input[type=submit]').click(function() {
    $('#stat').show();
    $('#stat').delay(500).css('opacity',0).show().animate({'opacity':1},100); 

    $('.wrapper-simple').animate({'width':'40px'}) 
        .end().find('.wrapper-simple input[type=text]').animate({'width': '1px', 'opacity': 0})
        .end().find('.wrapper-simple .button').animate({'right': 0})
        .end().find('.wrapper-simple input[type=submit]').animate({'marginLeft': 0, 'opacity': 0}).attr('value', '');

    document.location.hash='form';

    return false; // not related to this, but needed for other reasons
}); 
```

（在该示例中，我将其设置为“form”，因此您的页面 URL 在单击按钮后将显示为“mysite.com/mypage.htm#form”。您可以使用任何您喜欢的内容，但对允许使用的字符有一定的限制— 请参阅此答案：[URL 中片段标识符的有效字符列表？](https://stackoverflow.com/questions/2849756/list-of-valid-characters-for-the-fragment-identifier-in-an-url)）

然后，您可以在页面加载时检测到此标记：

```
$(document).ready(function(){
    var h=window.location.hash.replace(/^#/,'');
    if(h==='form'){
        $('#stat').css({'opacity':1}).show(); 

        $('.wrapper-simple').css({'width':'40px'}) 
            .end().find('.wrapper-simple input[type=text]').css({'width': '1px', 'opacity': 0})
            .end().find('.wrapper-simple .button').css({'right': 0})
            .end().find('.wrapper-simple input[type=submit]').css({'marginLeft': 0, 'opacity': 0}).attr('value', '');
    }
} 
```

请注意，我已经复制了代码，但将任何动画调用更改为简单的 css 调用，以便立即更改它。

这意味着一旦您的用户单击按钮，页面的任何刷新，或书签，关闭和从书签重新打开等都将意味着表单立即打开（页面加载时会轻微闪烁，即避免更多的工作）。此外，这不使用越来越成问题的 cookie。要将表单再次标记为已关闭，您只需将哈希设置为其他值（例如空字符串）。

Twitter、Google、Facebook 和许多其他公司都使用这种技术。

# .net - F# / .NET：将元素添加到 List 数组

> ID：15167083
> 
> 赞同：2
> 
> 时间：2013-03-01T21:21:59.553
> 
> 标签：.net, f#

我有以下 F# 代码：

```
let list = Array.create 5 (new ResizeArray<char>())
list.[0].Add('c')
printfn "%A" list 
```

这是 FSI 控制台中的输出：

```
[|seq ['c']; seq ['c']; seq ['c']; seq ['c']; seq ['c']|] 
```

对我来说似乎很奇怪，因为我试图仅将“c”添加到第一个索引，但它似乎添加到数组中的所有索引。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T21:34:22.613

您`list`是一个由 5 个元素组成的数组，但每个元素都引用*同一个 list*。您可以使用以下代码进行检查：

```
let d = list.[0].Equals(list.[1]) 
```

`d`将是真的。

这是因为您初始化列表的方式 - 您正在创建一个包含 5 个元素的列表，其中所有 5 个元素的值都相同。

因此，当您执行 时`list.[0].Add('c')`，它会正确地将元素附加到数组中的第一个列表，但是因为所有元素都引用同一个列表，所以它似乎将其附加到每个元素。

您可以这样做来初始化您的列表，并获得预期的结果（每个元素引用不同的列表）：

```
let list = [| for i in 1 .. 5 -> new ResizeArray<char>() |] 
```

正如 ildjarn 所说，这是一种更好的方法：

```
let list = Array.init 5 (fun _ -> ResizeArray()) 
```

# javascript - 无法在 javascript 中创建变量

> ID：15167084
> 
> 赞同：2
> 
> 时间：2013-03-01T21:22:11.097
> 
> 标签：javascript, variables, if-statement, textarea, getelementbyid

我正在创建一个应用程序，它会在扫描条形码时告诉您产品的价格。基本上，当条形码被扫描时，它会进入文本字段，然后根据它是哪个条形码，textarea 将通过 javascript 将价格放入其中。我已经让它工作了，但我似乎无法创建某个变量来避免我以后查看大量代码。

这是我的javascript：

```
function showPrice() {
    var userInput = document.getElementById('barcode').value;
    var price = document.getElementById('textarea').innerHTML;
    if (userInput === "783466209834") {
        price = "16.99";
    } else {
        price = "Not a valid barcode";
    }
} 
```

这是我的 HTML：

```
<input type="text" name="text" class="textinput" id="barcode">
<input type="button" onclick="showPrice()" value="Submit">
<textarea name="" cols="" rows="" readonly="readonly" id="textarea"></textarea> 
```

现在，我的代码不起作用，但如果我删除

```
var price = document.getElementById('textarea').innerHTML; 
```

并分别替换 if 语句中的“价格”，然后它就起作用了。我不确定为什么我不能创建这个价格变量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T21:26:06.897

因为您将 的*值*存储为`innerHTML`变量，而不是存储对它的*引用*。

将其更改为`var textarea = document.getElementById('textarea');`然后`textarea.innerHTML = "16.99"`等等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T21:26:29.160

您正在获取的 innerHTML`textarea`并将其存储在变量 中`price`。相反，您只需将元素存储在变量中，然后调用`price.innerHTML`将结果放入 DOM。像这样：

```
function showPrice() {
    var userInput = document.getElementById('barcode').value;
    var price = document.getElementById('textarea');
    if (userInput === "783466209834") {
        price.innerHTML = "16.99";
    } else {
        price.innerHTML = "Not a valid barcode";
    }
} 
```

编辑：正如 talemyn 正确指出的那样，您应该使用`.value`而不是`.innerHTML`更改`textarea`s 的内容。虽然它看起来像做同样的事情，但使用`.innerHTML`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-01T21:29:16.267

如果你想使用 textarea 的值，你需要访问`document.getElementById('textarea').value`，而不是`innerHTML`.

而且，是的，正如其他人指出的那样，您希望将变量设置为引用元素，而不是值。然后您可以检索或设置元素的值。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-01T21:26:42.037

你不应该给它赋值`price`然后覆盖它......这就是你的代码正在做的事情。我相信您认为您是在 innerHTML 中创建一个存储位置？

相反，只需创建变量：

```
var price; 
```

像以前一样运行代码；然后将结果放入页面中

```
document.getElementById("text area").innerHTML = price; 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-03-01T21:26:58.740

你用两个不同的东西设置了两次“价格”变量。你实际上并没有改变 DOM。而是使用：

```
var price = document.getElementById('textarea');
if (userInput === "783466209834") {
    price.innerHTML = "16.99";
} else {
    price.innerHTML = "Not a valid barcode";
} 
```

# ruby-on-rails - 使用 Ruby on Rails 将多个数据插入数据库

> ID：15167086
> 
> 赞同：1
> 
> 时间：2013-03-01T21:22:13.523
> 
> 标签：ruby-on-rails, ruby, database, multithreading

我认为这是我在这里的第一个问题，希望尽可能清楚。我有闲置代码。

```
def index_service_name
@currentService = Feed.where("name = '#{params[:name]}'").first

serviceId = @currentService['id']
serviceName = @currentService['name']
serviceFeedUrl = @currentService['feedUrl']

feed = Feedzirra::Feed.fetch_and_parse(serviceFeedUrl)

  feed.entries.reverse.each do |entry|
    case serviceName
      when 'service1', 'service2'
        uniqueId = entry.url.match(/\d+$/)[0]
        postContent = Nokogiri::HTML( entry.content ).css('img').map{ |i| i['src'] }.first # this would be an array.
      else
        uniqueId = entry.url
        postContent = entry.content
    end

    isIndexed = Post.where("post_unique_id = '#{uniqueId}' AND post_service = '#{serviceId}'")

    if postContent =~ %r{\Ahttps?://.+\.(?:jpe?g|png|gif)\z}i
      isImage = true
    elsif postContent =~ %r{http?s://(.*)/maxW500/}i
      isImage = true
    end

    if isIndexed.empty? && isImage
      sleep 1.seconds
      Post.create(post_service: serviceId, post_service_name: serviceName, title: entry.title, content: postContent, url: entry.url, post_unique_id: uniqueId)
    end
  end 
```

我使用常规 URL（/something/service/service1、/something/service/service2）触发服务。如果我同时触发它们，似乎它们中的每一个都在等待另一个结束（因此在我的数据库中，数据首先从 service1 存储，然后从 service2 存储）。我认为这与多线程有关，据我所知，ROR 尚不支持它。

我是 ROR 的新手，所以请温柔一点。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:49:42.643

假设您使用的是 MRI ruby​​，那么您没有并行多线程。MRI 具有不并行运行的绿色线程。如果您使用 ruby​​ 的 JRuby 实现，您将能够使用并行多线程。

无论哪种方式，启动 2 个服务器实例，您就可以并行运行该代码。使用`rails s -p 3000`and`rails s -p 3001`启动 2 个服务器：端口 3001 和 3000。然后尝试访问端口 3000 上的一个 URL 和端口 3001 上的另一个 URL。这样您的代码将并行运行。

# google-chrome - 更新后 Chrome 开发者工具中的菜单图标消失了

> ID：15167087
> 
> 赞同：6
> 
> 时间：2013-03-01T21:22:15.623
> 
> 标签：google-chrome, google-chrome-devtools

Chrome 自动升级后，菜单的图标消失了。

如何重新启用它们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T21:22:15.623

打开开发人员工具（Ctrl + Shift + I），在右下角，您可以单击齿轮图标以调出设置窗口。

在那里您可以再次启用图标。

# ruby-on-rails - Rails 3.2.12 的 rspec 集成测试中出现“无路由匹配 [GET]”错误

> ID：15167089
> 
> 赞同：0
> 
> 时间：2013-03-01T21:22:22.160
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec

集成测试所做的是打开一个显示购买页面并单击`Approve`购买页面。这是 rspec 案例：

```
it "should display the approve page" do
      proj = FactoryGirl.create(:project)
      pur = FactoryGirl.create(:purchasing, :project_id => proj.id)
      visit project_purchasing_path(proj, pur)
      response.should have_selector("a", :href => approve_project_purchasing_path(proj, pur), :content => "Approve")
      click_link 'Approve'
end 
```

`click_link 'Approve'`即使`response`只是验证页面上有`'Approve'`链接，最后一行也会导致以下错误：

```
ActionController::RoutingError:←[0m
           ←[31mNo route matches [GET] "/projects/1/purchasings/1/approve" 
```

在输出中`rake routes`有一个路径approve_project_purchasing_path：

```
 approve_project_purchasing PUT    /projects/:project_id/purchasings/:id/approve(.:format) 
```

单击 时代码执行完全没有错误`'Approve'`。

我们的 rspec 代码有什么问题？谢谢您的帮助。

更新：这是`link_to`for `Approve`：

```
<%= link_to 'Approve', approve_project_purchasing_path(@project, @purchasing), :method => :put, :id => 'purchasing_need_approve', :confirm => 'Approve' + @purchasing.prod_name + '?' %> 
```

# ruby-on-rails - Faye频道订阅和发布

> ID：15167091
> 
> 赞同：0
> 
> 时间：2013-03-01T21:22:26.767
> 
> 标签：ruby-on-rails, faye, private-pub

在尝试 faye（rails 中的私人酒吧）时，我有一个非常基本的疑问。在发布到该频道之前，我们是否需要订阅该频道？

请提供一些学习faye的资源。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:34:27.637

无论您是否订阅，您都可以使用 Private Pub 将消息发布到任意频道。例如，这个例子工作得很好，没有订阅任何东西：

```
PrivatePub.publish_to "some_random_channel", :data => "whatever" 
```

当然，上面的代码根本没有用 - 如果不订阅该频道，您将无法收到该消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:28:01.100

[http://railscasts.com/episodes/260-messaging-with-faye](http://railscasts.com/episodes/260-messaging-with-faye)如果您开始或查看他的参考资料。

# c# - C# 正则表达式不包括具有随机元素名称的标签

> ID：15167092
> 
> 赞同：1
> 
> 时间：2013-03-01T21:22:28.990
> 
> 标签：c#, expression, inverse

我试图得到这个表达的反面，它给我带来了一些麻烦。

前任。

```
expression: (?<={{)(.*?)(?=}})
string: this is a question with a textbox {{textbox}} ok
results: textbox 
```

寻找类似的东西

```
expression: !(?<={{)(.*?)(?=}})
string:this is a question with a textbox {{textbox}} ok 
results: this is a question with a textbox ok 
```

另外，我应该注意 {{}} 中的内容并不总是文本框，而是随机的字母字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:26:25.300

执行替换如何？

```
string replaced = yourRegex.Replace(original, string.Empty); 
```

`replaced`将是你的“比赛”。而且您也不再需要断言。

# c# - WCF 服务操作总是返回 false

> ID：15167093
> 
> 赞同：1
> 
> 时间：2013-03-01T21:22:38.900
> 
> 标签：c#, wcf, linq, wcf-data-services

我遇到了 WCF 服务操作问题。我从数据库中获取密码值，当它应该传递它时返回错误值。我究竟做错了什么？

```
public bool LogIn(string userId, string passwd)
    {
        bool prompt;
        ProgDBEntities context = new ProgDBEntities();

        IQueryable<string> haslo = (from p in context.UserEntity where p.UserID == userId select p.Passwd);

        bool passOk = String.Equals(haslo, passwd);

        if (passOk == true )
        {
            prompt = true;                
        }
        else
        {
            prompt = false;               
        }
        return prompt;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T21:32:37.237

您似乎想将单个检索到的条目与传入的密码进行比较（而不是任何 IQueryable/IEnumerable）。为此，请尝试使用 FirstOrDefault 方法：

```
public bool LogIn(string userId, string passwd)
    {
        bool prompt;
        ProgDBEntities context = new ProgDBEntities();

        var haslo = (from p in context.UserEntity where p.UserID == userId select p.Passwd).FirstOrDefault();

        // No need to use String.Equals explicitly
        bool passOk = haslo == passwd;

        if (passOk == true )
        {
            prompt = true;                
        }
        else
        {
            prompt = false;               
        }
        return prompt;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T21:38:56.500

haslo 表示字符串的*集合*，而不是单个字符串。这意味着 String.Equals(haslo, passwd) 将始终返回 false，因为您将字符串*集合*与单个字符串进行比较 - 它们是两种不同类型的对象。

您可以尝试如下修改代码。FirstOrDefault() 将返回集合中的第一个字符串，如果为空，则返回 NULL。

```
bool passOk = String.Equals(haslo.FirstOrDefault(), passwd); 
```

# c# - 自定义排序算法到 BindingListCollectionView

> ID：15167094
> 
> 赞同：2
> 
> 时间：2013-03-01T21:22:42.907
> 
> 标签：c#, wpf, sorting, datagrid

我正在开发一个有一些`DataGrid`'s 的 WPF 项目，其中一些我需要应用自定义排序算法。所以我一直在寻找一种方法来实现这一点，在许多网页中我发现了以下代码：

```
var myListView = CollectionViewSource.GetDefaultView(myDataGrid.ItemsSource);

ListCollectionView myListCollectionView = myListView as ListCollectionView;

myListCollectionView.CustomSort = new CustomSorter();

.
.
.

public class CustomSorter : IComparer
{
    public int Compare(object x, object y)
    {
        // sorting logic ...
    }
} 
```

这似乎是执行自定义排序的一种非常好的方法，但我的问题是我无法将变量`myListView`转换为，`ListCollectionView`因为它原来是一个`BindingListCollectionView`对象，除了缺乏设置自定义排序算法的功能外。

我找到[了这个](https://stackoverflow.com/questions/2890371/wpf-bindinglistcollectionview-to-listcollectionview-for-datatable-as-itemssource)解决方案，但它对我不起作用，因为他们尝试执行以下操作：

```
ListCollectionView coll = new ListCollectionView(CollectionViewSource.GetDefaultView(myDataGrid.ItemsSource)); 
```

但是没有构造函数将 ICollectionView 对象（这是 GetDefaultView 返回的函数）作为参数。

**那么，有没有办法将自定义排序算法应用于 BindingListCollectionView 对象？**

先感谢您。

**编辑：**

不幸的是，该解决方案已被放置在一个`DataGrid`划分的类中，因为该解决方案必须是通用的。

希望可以有人帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:28:40.310

将您的属性设为`MyPropertyToSortOn`实现 IComparable 的自定义类型，然后将排序描述符添加到您的列表视图：

```
ListView.Items.SortDescriptions.Add(new SortDescription("MyPropertyToSortOn", ListSortDirection.Descending))

public class MyPropertyClass: IComparable{
  public int CompareTo(object obj) {
    //custom comparison implemented here, returns -1,0 or 1
  }
} 
```

...

```
public class MyDataClass{
   public MyPropertyClass MyPropertyToSortOn {get;set;}
} 
```

# c# - 在组合框选择上打开文件

> ID：15167098
> 
> 赞同：0
> 
> 时间：2013-03-01T21:22:53.230
> 
> 标签：c#

我有一个组合框，它从我放在一个目录中的文件的名称中获取项目列表，这样做的目的是使其动态 - 我对 c# 很陌生，我并没有以不同的方式想到. - 这是该位的代码：

```
string[] files = Directory.GetFiles(templatePath);
        foreach (string file in files)
            cbTemplates.Items.Add(System.IO.Path.GetFileNameWithoutExtension(file)); 
```

基本上，这工作得很好，它用我在该路径中的文件名填充我的组合框，问题是我需要打开在组合框中选择的文件并读取其内容并将它们放在标签中，我是想也许 StreamReader 会在这里帮助我，但我不知道如何实现它，我已经搜索了互联网，但看起来在我之前没有人有同样的想法。有人可以指出我正确的方向吗？指向类似内容的链接或我需要使用的对象的指南会很棒，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:44:13.917

您应该做的是将文件的名称存储在一个单独的文件（csv 或 xml）中。然后使用此文件来加载组合框和作为索引器。

例如，假设您有文件 a.txt、b.txt 和 c.txt。您应该（因为您已经是）以编程方式读取文件名，然后以您想要的任何格式将它们写入新文件，包括唯一的索引方案（数字工作正常）。

您的 csv 可能如下所示：

```
1, a.txt,
2, b.txt,
3, c.txt, 
```

从这里您可以根据自己的喜好解析新创建的 csv。用它来填充你的组合框，索引是它的值，文件名是它的文本。然后您可以读取您的组合框 selectedvalue，从 csv 索引中获取正确的文件名，最后打开文件。

它可能是冗长的，但它会工作。你也可以只使用一个多维数组，但从教育的角度来看这更有趣，它会帮助你进行读/写操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:55:34.477

理解你的问题并不容易。您只想在组合框中显示不带扩展名的文件名吗？我希望这段代码对你有用。

```
internal class FileDetail
{
    public string Display { get; set; }
    public string FullName { get; set; }
}
public partial class Example: Form // This is just widows form. InitializeComponent is implemented in separate file.
{
    public Example()
    {
        InitializeComponent();
        filesList.SelectionChangeCommitted += filesListSelectionChanged;
        filesList.Click += filesListClick;
        filesList.DisplayMember = "Display";
    }        
    private void filesListClick(object sender, EventArgs e)
    {
        var dir = new DirectoryInfo(_baseDirectory);
        filesList.Items.AddRange(
            (from fi in dir.GetFiles()
            select new FileDetail
            {
                Display = Path.GetFileNameWithoutExtension(fi.Name),
                FullName = fi.FullName
            }).ToArray()
        );
    }
    private void filesListSelectionChanged(object sender, EventArgs e)
    {            
        var text = File.ReadAllText(
            (filesList.SelectedItem as FileDetail).FullName
        );

        fileContent.Text = text;
    }
    private static readonly string _baseDirectory = @"C:/Windows/System32/";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T21:58:20.533

感谢您的所有帮助，但我想出了如何解决我的问题，我将发布代码以备将来使用。PD。抱歉这么久才回复，我在放假

```
string[] fname = Directory.GetFiles(templatePath); // Gets all the file names from the path assigned to templatePath and assigns it to the string array fname
        // Begin sorting through the file names assigned to the string array fname
        foreach (string file in fname)
        {
            // Remove the extension from the file names and compare the list with the dropdown selected item
            if (System.IO.Path.GetFileNameWithoutExtension(file) != cbTemplates.SelectedItem.ToString())
            {
                // StreamReader gets the contents from the found file and assigns them to the labels
                using (var obj = new StreamReader(File.OpenRead(file)))
                {
                    lbl1.Content = obj.ReadLine();
                    lbl2.Content = obj.ReadLine();
                    lbl3.Content = obj.ReadLine();
                    lbl4.Content = obj.ReadLine();
                    lbl5.Content = obj.ReadLine();
                    lbl6.Content = obj.ReadLine();
                    lbl7.Content = obj.ReadLine();
                    lbl8.Content = obj.ReadLine();
                    lbl9.Content = obj.ReadLine();
                    lbl10.Content = obj.ReadLine();
                    obj.Dispose();
                }
            }
        } 
```

# tomcat - 在 Tomcat 中托管多个 WAR

> ID：15167107
> 
> 赞同：0
> 
> 时间：2013-03-01T21:23:38.460
> 
> 标签：tomcat

`APPS.war`使用 Tomcat 库存构建后`server.xml`，我将 WAR 复制到`$TOMCAT_HOME/webapps`.

在我启动 Tomcat 后，WAR 爆炸了，但是当我导航到 时`h_ttp://localhost:8080/APPS/`，我得到一个`404`错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T07:41:37.350

编辑 web.xml 以包含

`<welcome-files>index.jsp</welcome-files>`

其中 index.jsp 是您的默认页面。否则，您必须直接导航到该页面。

`http://localhost:8080/APPS/index.jsp`

# css - 从 CSS 配置 .htaccess 并保留链接

> ID：15167115
> 
> 赞同：1
> 
> 时间：2013-03-01T21:24:14.327
> 
> 标签：css, wordpress, .htaccess

我正在这个网站上工作：

[http://www.snaprockandpop.co.uk](http://www.snaprockandpop.co.uk)

该网站刚刚上线（！），但 .htaccess 文件存在一些问题。这是一个 wordpress 网站，内容托管在子域 ( `wordpress.snaprockandpop.co.uk`) 中，其文件位于主域的文件夹中，即`public-html/wordpress`

我希望 ' `www.snaprockandpop.co.uk`' 和 ' `snaprockandpop.co.uk`' 在不重定向到`wordpress.snaprockandpop.co.uk`URL 的情况下显示托管在那里的内容，并且也希望从这些 URL 中显示所有内容

按照指南，我在 public-html 根目录中编辑了 .htaccess 文件，因此它的内容如下：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^(www.)?snaprockandpop.co.uk$
RewriteCond %{REQUEST_URI} !^/wordpress/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /wordpress/$1
RewriteCond %{HTTP_HOST} ^(www.)?snaprockandpop.co.uk$
RewriteRule ^(/)?$ wordpress/index.php [L] 
```

在打开网站之前，我注意到这适用于“www”地址，但省略“www”仍会重定向到“wordpress.snaprockandpop.co.uk”。我想我稍后会解决这个问题，因为我只需要网站启动。但是，打开“www”地址后，现在已经删除了一些自定义字体和图标的链接。另外，除主页外的任何页面都是从“ `wordpress.snaprockandpop`”地址提供的。

具体来说`@font-face`，CSS 中的一条规则已停止工作，尽管之前在 Wordpress 后端中运行良好。CSS 中字体文件的链接也是绝对链接`http://www.wordpress.snaprockandpop.co.uk/./././././myfont.TTF/OET/whatever`，因此我不确定它们为什么会停止工作。

作为参考，这是 wordpress 目录（`public-html/wordpress`）中的 .htaccess 文件：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

这里的任何帮助都会很棒 - 正如我所说，网站已经上线！:S

# iphone - 推送故事板视图控制器会阻止viewDidAppear加载视图？

> ID：15167118
> 
> 赞同：0
> 
> 时间：2013-03-01T21:24:26.663
> 
> 标签：iphone, ios, storyboard, viewdidappear

我有一个带有一个视图控制器的故事板，它使用以下代码推送另一个视图控制器：

```
 UIViewController *viewController = [self.storyboard instantiateViewControllerWithIdentifier:@"adVideo"];
    [self presentViewController:viewController animated:NO completion:nil]; 
```

在被推送的视图控制器中，有一个 UIView 我正在尝试获取框架，以便我可以使用它来放置另一个对象。我已将它连接到我的 viewcontroller 类中的 UIView IBOUTLET 属性，然后在 viewDidAppear 中为我在框架上调用的那个视图控制器，但它显示为空（0,0,0,0）。

```
-(void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];
        NSLog(@"%f %f %f %f", self.videoView.frame.origin.x, self.videoView.frame.origin.y, self.videoView.frame.size.width, self.videoView.frame.size.height);
} 
```

那时没有加载videoView以便可以传递帧的原因是什么？

# sql - 在 SQL 中禁用聚集索引的方法以及创建默认非聚集索引的列？

> ID：15167119
> 
> 赞同：0
> 
> 时间：2013-03-01T21:24:40.540
> 
> 标签：sql, sql-server, sql-server-2008

有没有办法禁用聚集索引？正如我在下面的 MSDN 中看到的那样，它说“如果未指定 CLUSTERED，则会创建非聚集索引”。

参考：http: [//msdn.microsoft.com/en-IN/library/ms188783.aspx](http://msdn.microsoft.com/en-IN/library/ms188783.aspx)

因为我读到了，默认情况下会在主键列中创建一个聚集索引。即使通过某种方式禁用它，根据上面的 MSDN，默认情况下会创建一个非聚集索引？如果有，是哪一栏？

我是 SQL 新手，请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:29:11.727

您可以禁用聚集索引。

```
ALTER INDEX IX_Index ON dbo.Table
DISABLE ; 
```

[http://technet.microsoft.com/en-us/library/ms188388.aspx](http://technet.microsoft.com/en-us/library/ms188388.aspx)

# javascript - 我用 HTML 设计一个国际象棋游戏，我想将一个字符从一个位置更改为另一个

> ID：15167125
> 
> 赞同：0
> 
> 时间：2013-03-01T21:25:07.193
> 
> 标签：javascript, html

我使用按钮设计了棋盘。最初按钮上的所有值都将为空，加载页面后，所有棋子都出现在它们上，代码如下

```
<input type="button" id="A8" value="" style="background:#FFE4C4;font-size: 70px;height:90;width:100" onclick="check(this.id)"> 
```

在 onLoad 函数中，棋子的 ASCII 字符分配如下：

```
document.getElementById('A1').value=String.fromCharCode(9814); 
```

现在我想要的是通过单击两个按钮将一个按钮从一个按钮更改为另一个。我用以下脚本尝试了很多

```
function check(clicked_id) {
    var Button_2 = "";
    if (i < 2) {
        i++;
        // alert("i:"+i);        
        if (i == 1) {
            Button_1 = clicked_id;
            B1_val = document.getElementById(Button_1).value;
            alert("B1 Button val:" + B1_val);
        }
        if (i == 2) {
            var Button_2 = clicked_id;
            B2_val = document.getElementById(Button_2).value;
            alert("b1 val:" + B1_val);
            alert("B2 val:" + B2_val);
            B2_val = B1_val;
            B1_val = "";
            alert("B1 val:" + B1_val + "B2 val:" + B2_val);
        }
    } else {
        alert("Only 2 butons should press..i:" + i);
        i = 0;
    }
    // alert("clcked a button:"+clicked_id);
} 
```

但是代码不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:38:49.153

如果您只想将值从第一次单击的位置移动到第二次单击的位置，那么您可以像这样简单地执行此操作：

```
var lastClick;

function check(id) {
    var src, dest;
    if (!lastClick) {
        // no previous click so just store the location of this first click
        lastClick = id;
    } else {
        // move value from lastClick id to new id
        src = document.getElementById(lastClick);
        dest = document.getElementById(id);
        dest.value = src.value;
        src.value = "";
        lastClick = null;
    }
} 
```

我假设一个真正的应用程序需要各种错误处理，不能让你把一块放在另一块上面，忽略对空白空间的第一次点击，只执行合法的移动，等等......

# c# - 如何安排任务，使它们不会同时运行，包括异步延续

> ID：15167128
> 
> 赞同：0
> 
> 时间：2013-03-01T21:25:28.940
> 
> 标签：c#, task-parallel-library

给定以下代码，是否可以为 的实例定义调度程序、创建和延续设置`Task doThing`？

我希望能够安排多个实例，`doThing`以便它们实际上专门从其他实例运行（即使它们正在等待其他子任务）。

```
 private static async Task doThing(object i)
    {
        Console.WriteLine("in do thing {0}", (int)i);
        await Task.Delay(TimeSpan.FromSeconds(5));
        Console.WriteLine("out of do thing {0}", (int)i);
    }
    static void Main(string[] args)
    {

        CancellationTokenSource source = new CancellationTokenSource();
        ConcurrentExclusiveSchedulerPair pair = new ConcurrentExclusiveSchedulerPair(TaskScheduler.Current);

        Task Task1 = Task.Factory.StartNew((Func<object,Task>)doThing, 1, source.Token, TaskCreationOptions.AttachedToParent, pair.ExclusiveScheduler).Unwrap();
        Task Task2 = Task.Factory.StartNew((Func<object, Task>)doThing, 2, source.Token, TaskCreationOptions.AttachedToParent, pair.ExclusiveScheduler);
        Task Task3 = doThing(3);
        Task Task4 = Task.Factory.StartNew(async (i) =>
        {
            Console.WriteLine("in do thing {0}", (int)i);
            await Task.Delay(TimeSpan.FromSeconds(5));
            Console.WriteLine("out of do thing {0}", (int)i);
        }, 4, source.Token, TaskCreationOptions.None, pair.ExclusiveScheduler);
        Task.WaitAll(Task1, Task2, Task3, Task4);
        Console.ReadKey();
        return;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-03T17:21:58.477

TPL TaskScheduler 一次只能看到一个异步方法的一个同步段，因此您不能简单地使用调度程序来做到这一点。但是您*可以*使用更高级别的原语来做到这一点。我经常使用的一种是 TPL 数据流。

首先，安装 NuGet 包：

```
Install-Package Microsoft.Tpl.Dataflow 
```

然后使用此代码：

```
private static async Task doThing(object i) {
    Console.WriteLine("in do thing {0}", (int)i);
    await Task.Delay(TimeSpan.FromSeconds(5));
    Console.WriteLine("out of do thing {0}", (int)i);
}

static void Main(string[] args) {
    CancellationTokenSource source = new CancellationTokenSource();
    var exclusivityBlock = new ActionBlock<Func<Task>>(f => f(), new ExecutionDataflowBlockOptions { CancellationToken = source.Token }};
    exclusivityBlock.Post(() => doThing(1));
    exclusivityBlock.Post(() => doThing(2));
    exclusivityBlock.Post(() => doThing(3));
    exclusivityBlock.Post(
        async () => {
            Console.WriteLine("in do thing {0}", 4);
            await Task.Delay(TimeSpan.FromSeconds(5));
            Console.WriteLine("out of do thing {0}", 4);
        });
    exclusivityBlock.Complete();
    exclusivityBlock.Completion.Wait();
    Console.WriteLine("Done");
    Console.ReadKey();
    return;
} 
```

此代码缺少每个已发布工作项的单独任务。如果这很重要，您可以使用此示例：

```
internal static class Program {
    private static async Task doThing(object i) {
        Console.WriteLine("in do thing {0}", (int)i);
        await Task.Delay(TimeSpan.FromSeconds(5));
        Console.WriteLine("out of do thing {0}", (int)i);
    }

    private static void Main(string[] args) {
        CancellationTokenSource source = new CancellationTokenSource();
        var exclusivityBlock = CreateTrackingBlock<Func<Task>>(
            f => f(), new ExecutionDataflowBlockOptions { CancellationToken = source.Token });
        var task1 = exclusivityBlock.PostWithCompletion(() => doThing(1));
        var task2 = exclusivityBlock.PostWithCompletion(() => doThing(2));
        var task3 = exclusivityBlock.PostWithCompletion(() => doThing(3));
        var task4 = exclusivityBlock.PostWithCompletion(
            async () => {
                Console.WriteLine("in do thing {0}", 4);
                await Task.Delay(TimeSpan.FromSeconds(5));
                Console.WriteLine("out of do thing {0}", 4);
            });

        Task.WaitAll(task1, task2, task3, task4);
        Console.WriteLine("Done");
        Console.ReadKey();
        return;
    }

    private static ActionBlock<Tuple<T, TaskCompletionSource<object>>> CreateTrackingBlock<T>(Func<T, Task> action, ExecutionDataflowBlockOptions options = null) {
        return new ActionBlock<Tuple<T, TaskCompletionSource<object>>>(
            async tuple => {
                try {
                    await action(tuple.Item1);
                    tuple.Item2.TrySetResult(null);
                } catch (Exception ex) {
                    tuple.Item2.TrySetException(ex);
                }
            },
            options ?? new ExecutionDataflowBlockOptions());
    }

    internal static Task PostWithCompletion<T>(this ActionBlock<Tuple<T, TaskCompletionSource<object>>> block, T value) {
        var tcs = new TaskCompletionSource<object>();
        var tuple = Tuple.Create(value, tcs);
        block.Post(tuple);
        return tcs.Task;
    }
} 
```

但是请注意，这只是有点费力，因为 Dataflow 主要不是为跟踪单个提交而设计的，而是为跟踪整个过程而设计的。因此，虽然上述工作正常，但斯蒂芬克利里的答案可能更简单，因此更可取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T22:08:25.650

> 给定以下代码，是否可以为 Task doThing 的实例定义调度程序、创建和延续设置？

坏消息是：不，没有办法做到这一点。为非 lambda 任务定义“调度程序”是没有意义的。不需要创建选项，并且继续选项设置在继续上，而不是在任务本身上。

好消息是：你不需要这种行为。

您需要异步同步。执行此操作的内置方法是使用`SemaphoreSlim`，如下所示：

```
SemaphoreSlim mutex = new SemaphoreSlim(1);
private static async Task doThingAsync(object i)
{
    await mutex.WaitAsync();
    try
    {
        Console.WriteLine("in do thing {0}", (int)i);
        await Task.Delay(TimeSpan.FromSeconds(5));
        Console.WriteLine("out of do thing {0}", (int)i);
    }
    finally
    {
        mutex.Release();
    }
} 
```

就个人而言，我认为`finally`语法很尴尬，所以我定义了一个`IDisposable`并使用`using`。

如果您需要更多功能，Stephen Toub 有一个[异步协调原语系列](http://blogs.msdn.com/b/pfxteam/archive/2012/02/11/10266920.aspx)，[我的 AsyncEx 库中有一整套原语](http://nitoasyncex.codeplex.com/documentation)。这两个资源都包含一个`AsyncLock`with`Task<IDisposable> WaitAsync()`成员，因此您可以使用`using`而不是`finally`.

# embedded - PIC24 读或写存储器访问断点

> ID：15167133
> 
> 赞同：0
> 
> 时间：2013-03-01T21:25:46.587
> 
> 标签：embedded, pic, mplab, pic24

我的环境...

*   PIC24
*   MpLab (V.8.80)
*   ICD 3

我有一个我想观察的字节，以查看哪些例程正在读取，哪些例程正在实际写入，以及何时发生

我只能设置断点

*   当字节被写入时，或
*   当它被阅读

有谁知道我可以在任一访问上设置断点的方法？即，我想看看写了什么，读了什么，以什么顺序，通过哪个指令，在哪个例程中。

我只有一个 PICkit 3 和这个 ICD-3。这是一个双处理器系统，其中两个芯片通过一些连接（最终通过外设引脚选择）到各自的 UART 的电线进行通信

我从来没有使用过、接触过，甚至没有见过真正的冰。那会让我这样做吗？即，任何总线内存访问。

这就是 MpLab 让我现在用 ICD-3 做的事情 ![在此处输入图像描述](../Images/03d5ef7b1580fb046cb9e0a9ed4d2fd1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-03T12:41:29.050

您能否将变量包含在如下函数中到新的 .c 文件中。在头文件上设置定义。

它可能有点重，但更换它可能会有所帮助。**FILE**和**LINE**是编译器标志，让您知道源代码上的哪个文件以及在哪一行调用它。Nop(); 是否存在，因为中断可能会延迟几条指令。

在文件和行上添加一个监视以查看它的调用位置。

```
#define setvar(x) zsetvar(x, __FILE__, __LINE__)
#define getvar() zgetvar( __FILE__, __LINE__)

byte my_var;

void zsetvar(byte val, volatile char * file, volatile char * line)
{
 my_var = val;// set breakpoint
 Nop(); 
}
byte zreadvar(volatile char * file, volatile char * line)
{
 Nop(); //set breakpoint
 Nop();
 return my_var;
} 
```

# mysql - 列变量更改后恢复 MYSQL 值

> ID：15167151
> 
> 赞同：2
> 
> 时间：2013-03-01T21:26:35.967
> 
> 标签：mysql, sql

犯了一个大错误，将一列从 varchar(30) 更改为 BINARY(64)，现在我的值如下所示：

`31393532353238380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000`

而不是旧的：

`19525288`

我是否有任何希望恢复我的原始价值（害怕接下来要做什么，不想再搞砸了）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T21:35:25.397

我快速复制了表格以进行一些测试。只需将列切换回 varchar(30) 即可恢复以前的值。

编辑：事后看来，我应该首先复制表格并在新表格上测试*更改。*这比弄乱真实表并在复制的表上测试*修复要好得多。*

# android - 我应该为我的应用程序使用 AsyncTask 还是 IntentService？

> ID：15167152
> 
> 赞同：54
> 
> 时间：2013-03-01T21:26:37.913
> 
> 标签：android, google-maps, android-asynctask, intentservice

我一直在阅读有关与 Android 的互联网连接的信息，并注意到有不同的方法来处理这个问题，即 ie[`AsyncTask`](https://d.android.com/reference/android/os/AsyncTask)和[`IntentService`](https://d.android.com/reference/android/app/IntentService). 但是，我仍然不确定要使用哪一个。我的应用程序基本上是一个带有谷歌地图的位置/路径查找器。我的互联网连接将用于在地图的某个半径范围内查找最近的路径。因此，每次用户将地图移动或滑动到新位置时，它都会更新最近的路线。它还将添加一条新路径，并允许用户对路径进行评分。

`AsyncTask`就足够了还是我应该使用`IntentService`？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-03-01T21:39:53.613

它们可以非常不同地用于不同的目的。

`AsyncTask`是一个方便的线程实用程序，如果您需要不断地告诉用户某些事情或定期在主线程上执行操作，可以使用它。它提供了很多细粒度的控制，并且由于它的性质很容易在其中使用，`Activity`而`IntentService`通常需要使用`BroadcastReceiver`or`IBinder`框架。

`IntentService`可以非常像 an 一样使用`AsyncTask`，但它的目的是用于后台下载、上传或其他不需要用户交互或主线程的阻塞操作。例如，如果您想下载和缓存地图，您可能需要调用 an`IntentService`以便用户不必查看应用程序即可下载。同样，如果您将数据发送到您的服务器，`IntentService`则在这方面非常有帮助，因为您可以开始并忘记。例如，用户可以在您的应用中输入评论，然后按“发送”。“发送”将启动`IntentService`获取评论并将其发送到后台线程上的服务器。用户可以按“发送”并立即离开应用程序，评论最终会，仍然可以到达您的服务器（当然假设没有错误）。如果你这样做`AsyncTask``Activity`另一方面，系统可能会在交换过程中终止您的进程，并且它可能会或可能不会通过。

一般来说，两者都不适用于长时间运行的应用程序。它们适用于简短的一次性操作。它们可用于永久或长期运行的操作，但不建议这样做。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-03-01T21:33:14.073

您应该使用与`AsyncTask`活动紧密绑定的简短重复性任务，例如您当前正在尝试做的事情。`IntentService`更适合应在后台运行的计划任务（重复或不重复），与您的活动无关。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-03-01T23:29:45.667

AsyncTask 不能很好地处理配置更改或其他重启 Activity 的事情。

IntentService 对于应该始终可用的东西很有用，不管它需要多长时间才能完成它的工作。在大多数情况下，我更喜欢 IntentService，因为 AsyncTask 更多地依赖于 Activity 状态。

一些注意事项：

*   AsyncTask*最*适合应该直接返回 UI 的快速任务，但它可以在各种情况下使用。
*   “定期在主线程上执行操作”的说法含糊不清。AsyncTask 生成一个*不同于*主线程的新后台线程，并在新线程上工作。因此名称为 AsyncTask。
*   IntentService 不需要“操作” BroadcastReceiver 框架。您需要做的就是发送一个本地广播 Intent，并在您的 Activity 中检测它。这是否比 AsyncTask 更难，我不知道。
*   IntentService*旨在*执行长时间运行的任务，它在后台执行。
*   AsyncTaskLoader 可以使用，但它是 CursorLoader 等的基类。如果您想在用户移动到新位置时刷新“附近”的轨迹，IntentService 可能更好。

在尝试更新位置之前不要忘记检查连接。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-03-22T16:44:18.533

AsyncTask 与 Activity 紧密绑定，如果您离开创建 AsyncTask 的 Activity，通常会导致泄漏窗口错误。但它们非常适合显示 ProgressBar，因为您可以快速更新进度百分比。

IntentServices 更清洁、更安全。当您是初学者 Android 开发人员时，它们更难实现，但是一旦您学会了如何启动它们并处理它们，您可能永远不会回到 AsyncTasks！

IntentServices 还允许在您的应用程序中进行更模块化的设计。我通常为我的所有 IntentServices 创建一个单独的类，但对于 AsyncTasks 我将它们创建为一个 Activity 内部类。如果要从 Activity 中分离出 AsyncTask，则必须在 AsyncTask 构造函数中传入 Activity Context 和 View 对象，这可能会很混乱。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-03-01T22:16:11.050

如上所述`AsyncTask`将解决您的问题。

但请记住，它`AsyncTask`有一个重要的弱点：它不能很好地处理`Activity` “刷新”（例如在旋转期间）。例如，如果用户在您 `AsyncTask`仍在加载内容时旋转手机，则可能会出现问题。如果这对您来说确实是个问题，我建议`AsyncTaskLoader`：

[http://developer.android.com/reference/android/content/AsyncTaskLoader.html](http://developer.android.com/reference/android/content/AsyncTaskLoader.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-03-31T08:39:21.227

`AsyncTask`并且`IntentService`有很多相同的

*   可以在工作线程中执行任务
*   可以后台运行
*   继续运行直到任务完成事件启动它的活动被破坏
*   可以在任务运行期间或任务完成后通知更新 UI
    *   对于`AsyncTask`我们经常使用`onProgressUpdate`的，`onPostExecute`或者如果你愿意，你可以使用`BroadcastReceiver`
    *   因为`IntentService`我们使用`BroadcastReceiver`

### 不同的

1) 在运行时或运行完成后发送任务

*示例我们的任务是：从基于`fileName`.*

**使用** `AsyncTask`

如果我们的一个实例`AsyncTask`，在执行下载文件 A 期间，我们**无法**执行下载文件 B `AsyncTask`（因为我们得到`java.lang.IllegalStateException: Cannot execute task: the task is already running.`）。同样在下载文件A完成后，我们不能执行下载文件B（因为我们得到了`java.lang.IllegalStateException: Cannot execute task: the task has already been executed (a task can be executed only once)`。
要在下载文件A期间或之后下载文件B，我们需要创建新的实例`AsyncTask`。
=>要下载文件A和文件B，我们需要2 个`AsyncTask`=> 2 个工作线程的实例已创建

**使用** `IntentService`

在下载文件 A 期间，我们**可以**发送下载文件 B 的意图 => 下载文件 A 完成后会自动开始下载文件 B => 不需要新实例，不需要新工作线程。

**如果我们在下载文件 A 完成后**发送了下载文件 B 的意图？下载文件 A 完成后，**IntentSevice**将被销毁（因为没有更多的任务）。因此，当开始下载文件 B 时，会创建新的实例`Service`但没有创建新线程（服务只使用 1 个工作线程，其名称在`IntentSevice`构造函数中定义

2）实施`AsyncTask`比实施更容易`IntentService`

**USING**
我们会看到`AsyncTask`并`IntentService`有很多相同的，所以在大多数情况下我们可以使用`AsyncTask`or `IntentService`。然而

*   我经常`AsyncTask`用于一些在 1 中开始、完成、与 UI 交互的任务`Activity`
*   我经常`IntentService`用于一些可以开始/完成和交互或不与任何用户界面交互的任务`Activity`

这个答案是基于我的测试。如果我错了，请纠正我。希望它有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-21T15:37:24.830

简而言之，AsyncTask 适用于必须与主线程通信的短任务。IntentService 用于不需要与主线程通信的长任务。

有关更多信息，请查看这些链接

[http://www.onsandroid.com/2011/12/difference-between-android.html](http://www.onsandroid.com/2011/12/difference-between-android.html)

[https://medium.com/@skidanolegs/asynctask-vs-intentservice-1-example-without-code-5250bea6bdae](https://medium.com/@skidanolegs/asynctask-vs-intentservice-1-example-without-code-5250bea6bdae)

[https://android.jlelse.eu/using-intentservice-vs-asynctask-in-android-2fec1b853ff4](https://android.jlelse.eu/using-intentservice-vs-asynctask-in-android-2fec1b853ff4)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-01-21T10:23:51.540

我同意@DeeV 和@ebarrenechea 关于 Intent 服务的部分观点，即您应该将其用于与 Activity 不紧密绑定的任务，例如将一些数据上传到服务器或将数据从服务器存储到数据库。

但从 Android 3.0 开始，引入了[Loaders API](http://developer.android.com/guide/components/loaders.html) ，它应该取代 AsyncTask。因此，例如，对于应该在 Activity 中显示的加载列表，最好使用旨在处理所有配置更改和 Activity 生命周期的 Loader。

[Vogella 装载机教程](http://www.vogella.com/tutorials/AndroidBackgroundProcessing/article.html#loader)

# mysql - MySQL外键多连接

> ID：15167153
> 
> 赞同：0
> 
> 时间：2013-03-01T21:26:39.017
> 
> 标签：mysql, join

我有这个表设置（简化）：

```
ads
 - id
 - brand_id

brands
 - id

tags
 - taggable_type
 - taggable_id
 - tag 
```

tags 表中的 taggable_type 将是“Ad”或“Brand”，taggable_id 将分别标识 ad_id 或 brand_id，然后 tag 是一个字符串。

广告继承了他们的品牌标签，我正在尝试编写一个搜索查询，为给定的一组标签提取一组广告，其中这些标签属于广告本身或与该广告关联的品牌。

这些表都可能相当大，所以我需要它高效。

这是我所拥有的（这不起作用）

```
SELECT
  a.*
FROM
  ads a
JOIN
  ((
    SELECT
      *
    FROM
      tags
    WHERE
      tag IN ({$tags})
      AND taggable_type = "Ad"
  ) t FULL JOIN (
    SELECT
      *
    FROM
      tags
    WHERE
      tag IN ({$tags})
      AND taggable_type = "Brand"
  )) tt
  ON (t.taggable_id = a.id) OR (tt.taggable_id = a.brand_id); 
```

对于初学者，我在完全加入时遇到错误。我也尝试过内连接和左连接，但仍然无法正常工作。我觉得我只是在做一些根本上愚蠢的事情。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:58:50.727

像这样它应该工作

```
SELECT DISTINCT
  ads.*
FROM
  ads
  LEFT JOIN brands
    ON ads.brand_id = brands.id
  INNER JOIN tags
    ON (
      tags.taggable_type = 'brand'
      AND brands.id = tags.taggable_id)
    OR (
      tags.taggable_type = 'ad'
      and ads.id = tags.taggable_id)
WHERE
  tags.tag IN ('tag 1', 'tag 2', 'tag 7') 
```

[SQL小提琴](http://sqlfiddle.com/#!2/5126a/6/0)

但是您可能还想再次考虑您的数据库结构。也许像下面这样的设置更适合您。

```
ads(id, brand_id)
brands(id)
tags(id)
tags_ads(tag_id, ad_id)
tags_brands(tag_id, brand_id) 
```

能够将标签分配给多个品牌或广告的好处。或者对于一个品牌和一个广告...

# c# - 根据另一个表中的更改更新一个表中的列

> ID：15167162
> 
> 赞同：0
> 
> 时间：2013-03-01T21:27:25.687
> 
> 标签：c#, visual-studio-2010, sql-server-ce

请原谅我，因为我是数据库新手。我有一个食谱表格，用户可以在其中输入几种成分和食谱名称。使用此表格，我有以下表格：`Recipe{recipeID, recipeName}` `RecipeIngredient{recipeID,ingredientID,measurement}` `Ingredient{ingredientID, ingredientName}`

RecipeIngredients 充当一对多关系的中间表（一个配方对许多成分）。我将 recipeID 作为该表中的外键分配给配方表中的主键 recipeID。我认为外键会根据主键更新进行更新，但如果我将 RecipeIngredients 表插入到 RecipeIngredients 表中，则不会执行任何操作。

配方和配料自动分配 ID。我正在尝试将一个配方的 ID 链接到每种配料的自动分配 ID。例如，如果用户输入 8 种成分，则会为每种成分分配一个唯一 ID。我需要RecipeIngredients 表来复制这些ID 并将它们与自动分配的Recipe ID 相关联。

我已经尝试了几种解决方案来根据其他表中的更改来更新列。我试过修改[这个](https://stackoverflow.com/questions/6973469/update-table-based-on-column-in-another-table)MySQL 更新语句并修改[这个](https://stackoverflow.com/questions/6023367/update-table-based-on-another-table)SQL 服务器，但我似乎无法让它们中的任何一个工作。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:39:39.980

通常，您需要从第一次插入中获取新的 recipeID，然后在插入成分表时使用它。

您是否有权从插入到配方表中访问新插入的 recipeID？你怎么做这个插入？

这是一个示例存储过程，它进入数据库进行插入/更新并返回 id：

```
CREATE PROCEDURE [dbo].[spAlertCategoryInsUpd]
    @AlertCategoryID int,
    @AlertID int,
    @CategoryID int,
    @ScreenSortOrder int
AS

SET NOCOUNT ON

IF EXISTS(SELECT [AlertCategoryID] FROM [dbo].[AlertCategories] WHERE [AlertCategoryID] = @AlertCategoryID)
BEGIN
    UPDATE [dbo].[AlertCategories] SET
        [AlertID] = @AlertID,
        [CategoryID] = @CategoryID,
        [ScreenSortOrder] = @ScreenSortOrder
    WHERE
        [AlertCategoryID] = @AlertCategoryID
    SELECT  @AlertCategoryID as AlertCategoryID;    
END
ELSE
BEGIN
    INSERT INTO [dbo].[AlertCategories] (
        [AlertID],
        [CategoryID],
        [ScreenSortOrder]
    ) 
    OUTPUT INSERTED.AlertCategoryID AS AlertCategoryID
    VALUES (
        @AlertID,
        @CategoryID,
        @ScreenSortOrder
    )
    ;
END 
```

# bash - 在 Bash 中作为函数标志传递给 MATLAB 的路径变量中设置空格

> ID：15167163
> 
> 赞同：0
> 
> 时间：2013-03-01T21:27:39.570
> 
> 标签：bash, matlab, unix

我知道有几篇关于如何在 bash 的路径目录中包含空格的帖子。我认为这有点不同，因为这些帖子中建议的修复对我不起作用。

我的问题如下：我想在 Unix 集群上运行一个 MATLAB 脚本并维护一个正在发生的事情的日志。MATLAB 可以使用 -logfile $file_name 标志执行，该标志告诉它将日志存储在由 file_name 变量指定的文件中。不幸的是，我遇到了问题，因为我的 file_name 变量中有空格（由于我无法更改的文件结构）。

话虽如此，这是我现在代码的精简示例。

```
LOG_DIR="/Folder With Spaces/"   
LOG_FILE="File With Spaces.mat"  
matlab -r "script" -logfile ${LOG_DIR}${RESULT_FILE}.log 
```

这适用于 LOG_DIR 和 LOG_FILE，它们周围没有引号并且不包含空格。当 LOG_DIR 或 LOG_FILE 没有引号但有空格时，MATLAB 会解释 file_name 直到第一个空格（即它在 /Folder 中创建一个日志）。我也尝试过使用“\”字符，但没有取得太多成功。

任何有关如何使这项工作的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T21:30:24.303

尝试这个：

```
matlab -r "script" -logfile "${LOG_DIR}${RESULT_FILE}.log" 
```

# c++ - shared_ptrs 的向量，从函数中返回并修改它

> ID：15167166
> 
> 赞同：2
> 
> 时间：2013-03-01T21:27:53.153
> 
> 标签：c++, shared-ptr, stdvector

本质上，我希望我的 2 个类共享一些数据，我希望将其作为 shared_ptr 对象的向量。

我已将我的代码缩减为以下简单的可编译示例。

我希望对象 A 查看在对象 B 中初始化的数据。但是，当我尝试在 A 的方法中执行 push_back() 时，它并没有改变 B 中 shared_ptr 对象向量的大小。（在符合注释“这是兴趣点”。）

我需要使用什么方法来获得这个功能，还是我走错了路。（这里是 C++ 新手）

```
#include <memory>
#include <vector>
#include <iostream>
using std::cout;
using std::endl;
class DataClass {
    public:
        int i_;
};
class B {
    public:
        // constructor:
        B() : my_data_(std::vector<std::shared_ptr<DataClass> >()) {
            my_data_.push_back(std::shared_ptr<DataClass> (new DataClass));
            my_data_.push_back(std::shared_ptr<DataClass> (new DataClass));
            my_data_[0]->i_ = 1;
            my_data_[1]->i_ = 2;
            cout<<my_data_.size()<<endl;
        };

        // return the data
        std::vector< std::shared_ptr<DataClass> > get_my_data() {
            return my_data_;
        };

        // check the data:
        void CheckData() {
            cout<<my_data_.size()<<endl; // This is the point of interest
        };
        // member variable
        std::vector< std::shared_ptr<DataClass> > my_data_;
};
class A {

    public:
        void start() {
            // begin interaction with B class:
            B b;

            // get the vector of data pointers:
            a_has_data_ = b.get_my_data();

            // modify some of the data:
            a_has_data_.push_back(std::shared_ptr<DataClass> (new DataClass));
            a_has_data_[2]->i_ = 42;

            b.CheckData(); 
        };
    private:
    std::vector< std::shared_ptr<DataClass> > a_has_data_;

};
int main() {
    A a;
    a.start();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T21:33:06.473

您正在返回向量的副本。您需要返回对数据的引用：

```
// return the data
std::vector< std::shared_ptr<DataClass> >& get_my_data()
{
        return my_data_;
}; 
```

那`A`是访问`b`的向量，而不是它的副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T21:34:03.720

```
a_has_data_.push_back(std::shared_ptr<DataClass> (new DataClass)); 
```

由于返回类型是复制，上面的语句将修改`a_has_data_`. 而在`b.CheckData();`你实际上是在检查`b's`成员的大小。

引入一个成员函数`A`来检查向量大小，您应该会看到增加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T21:52:19.803

在此处

```
 std::vector< std::shared_ptr<DataClass> > get_my_data() 
```

该值是通过按值返回获得的，因此创建了新对象。请参阅以下实现。它通过发送指针来解决您的问题。

```
#include <tr1/memory>
#include <vector>
#include <iostream>
using namespace std;
using std::cout;
using std::endl;
class DataClass {
    public:
        int i_;
};
class B {
    public:
        // constructor:
        B() : my_data_(std::vector<tr1::shared_ptr<DataClass> >()) {
            my_data_.push_back(tr1::shared_ptr<DataClass> (new DataClass));
            my_data_.push_back(tr1::shared_ptr<DataClass> (new DataClass));
            my_data_[0]->i_ = 1;
            my_data_[1]->i_ = 2;
        };

        // return the data
        std::vector< tr1::shared_ptr<DataClass> >* get_my_data() {
            return &my_data_;
        };

        // check the data:
        void CheckData() {
            cout<<my_data_.size()<<endl; // This is the point of interest
        };
        // member variable
        std::vector< tr1::shared_ptr<DataClass> > my_data_;
};
class A {

    public:
        void start() {
            // begin interaction with B class:
            B b;

            // get the vector of data pointers:
            a_has_data_ = b.get_my_data();

            // modify some of the data:
            b.CheckData(); 
            a_has_data_->push_back(tr1::shared_ptr<DataClass> (new DataClass));
            (*a_has_data_)[2]->i_ = 42;
            b.CheckData(); 
        };
    private:
    std::vector< tr1::shared_ptr<DataClass> >* a_has_data_;

};
int main() {
    A a;
    a.start();
} 
```

注意：我将代码更改为 tr1/memory，因为我有较旧的 gcc。

# html - 带有 Mustache 和 Icanhazjs 的动态 HTML 表的问题

> ID：15167170
> 
> 赞同：0
> 
> 时间：2013-03-01T21:28:06.317
> 
> 标签：html, mustache, icanhaz.js

我正在尝试使用 Icanhazjs (Mustache) 构建一个动态表。表格数据始终在表格标签之外呈现，因此不会将我的数据放入表格中。

您可以在我的 JSfiddle [Here中看到输出](http://jsfiddle.net/fatfantasma/sapy7/)

这是我的 HTML：

```
<script id="display_row" type="text/html">
    <tr>
        <td>{{data1}}</td>
        <td>{{data2}}</td>
        <td>{{data3}}</td>
    </tr>
</script>

<h1>Icanhazjs & Mustache Table Test</h1>
<table border="1">
    <thead>
        <tr>
            <th>Header 1</th>
            <th>Header 2</th>
            <th>Header 3</th>
        </tr>
    </thead>
    <tbody>
        <div id="table_list"></div>
    </tbody>
</table> 
```

这是Javascript：

```
$(document).ready(function () {
    var user_data, user;

    user_data = [
        {
            data1: "foo1",
            data2: "foo2",
            data3: "foo3"
        },
        {
            data1: "foo4",
            data2: "foo5",
            data3: "foo6"
        }
    ];

    for (i=0; i<user_data.length; i++) {
        user = ich.display_row(user_data[i]);
        $('#table_list').append(user);
    }
}); 
```

任何人都可以解释为什么数据没有在我的 html 表中呈现`<div id="table_list"></div>`。icanhazjs 正在工作，但只是将呈现的 html 放在我的桌子之前。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T21:54:16.950

代替

```
<tbody>
    <div id="table_list"></div>
</tbody> 
```

试试这个：

```
<tbody id="table_list">
</tbody> 
```

JSF中：

[http://jsfiddle.net/sapy7/1/](http://jsfiddle.net/sapy7/1/)

# sql - 如何评估 SQL 中的 where 子句？

> ID：15167174
> 
> 赞同：1
> 
> 时间：2013-03-01T21:28:25.297
> 
> 标签：sql

我想了很多，但一直没有找到答案。在我不知道如何评估 SQL 查询的 where 子句中的条件的情况下，我发现了自己。可以肯定的是，我一直使用括号来使其更具可读性和易于理解。我认为有时使用括号来增加可读性是一种很好的做法，即使它可能不是必需的。

考虑以下查询

```
SELECT * 
FROM mytable 
WHERE name='Anton' 
  AND lastname='Gildebrand' 
   OR age > 18 
  AND country='Sweden' 
```

我想这个查询实际上等于

```
SELECT * 
FROM mytable 
WHERE name='Anton' 
 AND (lastname='Gildebrand' OR (age > 18 AND country='Sweden')) 
```

它是否正确？或者如何评估条件？它与不同的数据库引擎有什么不同吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T21:30:58.740

```
SELECT * FROM mytable
WHERE name='Anton' AND lastname='Gildebrand' OR age > 18 AND country='Sweden' 
```

等于：

```
SELECT * FROM mytable
WHERE (name='Anton' AND lastname='Gildebrand') OR (age > 18 AND country='Sweden') 
```

资料来源：[TSQL](http://msdn.microsoft.com/en-us/library/ms190276.aspx)、[MySQL](http://dev.mysql.com/doc/refman/5.0/en/operator-precedence.html)、[Oracle](http://docs.oracle.com/cd/B19306_01/server.102/b14200/conditions001.htm#i1034834)、[PostgreSQL](http://www.postgresql.org/docs/8.0/static/sql-syntax.html#SQL-PRECEDENCE-TABLE)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T21:32:02.793

如果你在谈论`and`and `or`，那么在没有括号的情况下`and`首先被评估。`*`和`+`数学一样。

这些规则不依赖于 SQL 实现。

# java - selenium 格式化程序修改（导出到 webdriver 支持的 java）

> ID：15167178
> 
> 赞同：1
> 
> 时间：2013-03-01T21:28:43.907
> 
> 标签：java, selenium, webdriver, formatter

我在理解格式化程序如何为 Selenium IDE 工作时遇到了一些麻烦。我不想从头开始编写格式化程序，我想修改将 selenese 转换为 webdriver 支持的 java 的现有代码。通常我会坐下来使用 Javascript 代码并尝试弄清楚它是如何工作的，但我有点卡住了。

这是一个典型的格式化程序：

```
function parse(testcase, source){}
function format(testcase,name){
    var Javaprogram = ""
    for each command in testcase{
        switch command.command
        case something:
            Javaprogram += "driver.something(" + command.target + (command.value!=""?");":","+command.value+");")
        ... 
```

我在 Java 格式化程序的任何地方都找不到这个逻辑，甚至没有格式化函数，只有“formatComment”和“formatSuite”。这让我相信这是在幕后完成的，但是逆向工程需要我真正没有的时间。

有谁知道这是如何工作的？有没有人有关于修改现有格式化程序的教程的链接？哪一个都好。我会继续寻找这个问题的答案，如果我找到它们，请在评论中链接它们。显然，人们已经做到了并且有能力做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:33:38.043

早在 2009 年，Adam Goucher 写了一系列精彩的博客文章，讨论了这些东西，在编写 Selenium IDE 插件（格式化程序是）的背景下：

*   [Selenium-IDE 1.x 插件 API（第 1 部分）- 构建和首选项](http://adam.goucher.ca/?p=1331)
*   [Selenium-IDE 1.x 插件 API（第 2 部分）- 工具栏](http://adam.goucher.ca/?p=1341)
*   [Selenium-IDE 1.x 插件 API（第 3 部分） - 侧边栏：](http://adam.goucher.ca/?p=1348)
*   [Selenium-IDE 1.x 插件 API（第 4 部分）- 扩展 Selenium API](http://adam.goucher.ca/?p=1348)
*   [Selenium-IDE 1.x 插件 API（第 5 部分） - 发布更新](http://adam.goucher.ca/?p=1351)
*   [Selenium-IDE 1.x 插件 API（第 6 部分） - 格式化程序](http://adam.goucher.ca/?p=1352)
*   [Selenium-IDE 1.x 插件 API（第 7 部分） - 打包细微差别](http://adam.goucher.ca/?p=1362)
*   [Selenium-IDE 1.x 插件 API（第 8 部分）- 本地化](http://adam.goucher.ca/?p=1376)
*   [Selenium-IDE 1.x 插件 API（第 9 部分）- 安全密码存储](http://adam.goucher.ca/?p=1377)
*   [Selenium-IDE 1.x 插件 API（第 10 部分）- 注册您的插件](http://adam.goucher.ca/?p=1387)

[在格式化程序插件的 IDE 发行说明中](http://code.google.com/p/selenium/wiki/SeIDEReleaseNotes)也有一些有用的信息，旧的 Wiki 有一个页面[描述了如何编写格式化程序](http://wiki.openqa.org/display/SIDE/Adding+Custom+Format)（预先警告，它是旧的）。

[Selenium HQ 下载页面](http://seleniumhq.org/download/)包含几个格式化程序插件的示例，您可能会发现它们很有帮助：

*   [玩！框架](http://www.playframework.org/)：Selenium-IDE 插件，增加了对 Play! 使用的简化标记的支持！框架。
*   [Grails 格式化程序](http://adhockery.blogspot.com/2010/06/export-selenium-ide-scripts-for-grails.html)：添加 Grails 格式化程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-14T09:42:31.190

1.  打开 Selenium-IDE 源代码，您可以通过从 GitHub 下载它或在 Windows 资源管理器上转到：(C:\Users\ **YOUR_USER_NAME** \AppData\Roaming\Mozilla\Firefox\Profiles\ **FIREFOX_PROFILE** \extensions)
2.  将 Selenium-IDE 扩展**{a6fd85ed-e919-4a43-a5af-8da18bda539f}.xpi 复制**到您的桌面
3.  将文件重命名为 **{a6fd85ed-e919-4a43-a5af-8da18bda539f}.xpi.zip**
4.  提取 Zip 文件
5.  转到**ZIP\chrome\content\formats\**
6.  打开**webdriver.js**
7.  搜索**函数 formatCommand(command)**，你会在 ~425 行找到

现在这个函数负责调用Selenium-IDE的Formatter Extension，这个函数以**命令**为输入，返回**字符串**为输出，即目标编程语言中的对应行。

如果你编辑这个函数，这将自定义所有编程语言的 Formatter，如果你想自定义特定的编程语言，你必须编辑扩展源代码：

1.  转到（C:\Users\ **YOUR_USER_NAME** \AppData\Roaming\Mozilla\Firefox\Profiles\ **FIREFOX_PROFILE** \extensions）
2.  找到目标格式化程序**X-formatters@seleniumhq.org.xpi** 将其复制到您的桌面，解压缩并转到**chrome\content\formats\**，您可以在其中找到格式化程序的 js 文件。

为了应用您的编辑：

*   您必须重建扩展并将其复制回 (C:\Users\ **YOUR_USER_NAME** \AppData\Roaming\Mozilla\Firefox\Profiles\ **FIREFOX_PROFILE** \extensions) 并重新启动 Firefox，我建议您阅读 Mozilla 开发人员网络指南以获取详细信息关于构建 Firefox 扩展的说明 [https://developer.mozilla.org/en/docs/Building_an_Extension](https://developer.mozilla.org/en/docs/Building_an_Extension)

*   或者您可以构建您的覆盖扩展，以免更改原始源代码[https://developer.mozilla.org/en/docs/Chrome_Registration](https://developer.mozilla.org/en/docs/Chrome_Registration)

# xcode - 将一个视图放在另一个固定大小的视图的底部

> ID：15167179
> 
> 赞同：0
> 
> 时间：2013-03-01T21:28:46.073
> 
> 标签：xcode, ios6, interface-builder, storyboard, autolayout

抱歉，如果我的问题似乎微不足道，但是 xcode 让我发疯。

我不想要其他任何东西，只需在 IB 的 XCode 中的视图控制器底部放置一个视图，即使我旋转设备，它也具有 FIXED 高度。它简单地留在底部，其大小保持不变。

自动布局约束一直在改变它的大小，如果我旋转就会隐藏等等。我找不到这个简单问题的设置。

我需要这个（固定大小，旋转时不会改变/隐藏）： ![在此处输入图像描述](../Images/627a42f05b4a01953b3efa154487ad63.png)

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T21:47:10.480

您是否尝试过取消选中自动布局并使用自动调整大小。试试下面的设置。它应该工作。

![在此处输入图像描述](../Images/b01c15a03629be39232c99993f5e11d5.png)

# ios - 在 UIWebView 上与 HTML 表单交互

> ID：15167180
> 
> 赞同：2
> 
> 时间：2013-03-01T21:28:51.790
> 
> 标签：ios, objective-c, uiwebview

我试图弄清楚如何编写一个允许我将数据推送到网站元素中的本机 ios 应用程序。例如，如果网页有一个文本字段，我想在 UIWebView 顶部放置一个滑块，并将滑块的结果（例如 5.0）放置在文本字段中。我一直在尝试使用以下代码：

```
- (void)webViewDidFinishLoad:(UIWebView *)webView 
{
    NSString *scriptFunction = @"document.getElementById('user_field').value = 'Joe';";
    NSString *result = [webView stringByEvaluatingJavaScriptFromString:scriptFunction];
    NSLog(@"Result: %@", result);
} 
```

我得到将“Joe”打印到控制台的结果，但它不会更新网页上的文本元素。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T02:06:06.357

这对我有用。在我的 HTML 文档中有这个：

```
<form>
    First name: <input id="input1" type="text" name="fname"><br>
    Last name: <input id="input2" type="text" name="lname"><br>
            <input type="submit" value="Submit">
</form> 
```

在 UIWebViewDelegate.webViewDidFinishLoad 中使用这个 iOS 代码：

```
NSString    *scriptFunction = @"document.getElementById( 'input1' ).value = 'Joe';";
NSString    *result         = [self stringByEvaluatingJavaScriptFromString:scriptFunction];
NSLog( @"Result: %@", result ); 
```

我的 UIWebView 子类也实现了 UIWebViewDelegate。

在模拟器上的 WebView 中，我看到“Joe”出现在“First name:”字段中。我第一次尝试在 getElementById() 中使用了“fname”。当这不起作用时，我将 id="input1" 添加到 HTML 并在 getElementById() 中切换到 'input1'。我还看到登录到我的控制台的“结果：乔”。

我的 HTML（或其他代码）与您的有什么不同吗？

# python - 使用导入模块的 IPython 交互式运行

> ID：15167182
> 
> 赞同：1
> 
> 时间：2013-03-01T21:29:03.647
> 
> 标签：python, ipython

我有一个模块如下：

模块1.py

```
Class bla():
  code here

def main():

  g1=bla()

if __name__ == '__main__':
  main() 
```

当我做`ipython module1.py`或进入 IPython 并且`import module1`代码按预期运行时。但是，当我输入类似`print g1`它说`g1`未定义的内容时，即使我`g1`在主程序中定义了。似乎代码运行了主程序，然后以某种方式“退出”它，只给我留下了 ipython 提示符。我想使用我在主函数中定义的变量...

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T21:30:41.873

您必须标记`g1`为全局：

```
def main():
    global g1
    g1 = bla() 
```

通常，函数中定义的任何名称仅对函数来说是本地的。您仍然必须从模块中*导入*名称，或者将其作为模块的属性引用：

```
import module1

print module1.g1 
```

# playframework-2.0 - 播放资产管道的 Web 依赖项

> ID：15167184
> 
> 赞同：1
> 
> 时间：2013-03-01T21:29:15.780
> 
> 标签：playframework-2.0, asset-pipeline, webjars

我来自 Rails 世界，现在正在玩游戏（2.1）。我喜欢它带有一种资产管道，但我缺少的一件事是在其中包含 Web 依赖项。在 Rails 中，我可以添加`jquery-rails`依赖项并将其包含在我的 application.js 文件中以使其可用。

我偶然发现了看起来不错的[http://webjars.org](http://webjars.org)，但据我所知，我只能将文件直接包含在 html 文件中。

有什么方法可以实现这种行为，还是计划在不久的将来实施？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T10:14:19.060

它的支持方式与 Rails 不同（显然），所以我想出的最好的方法如下：

1.  包含您的 WebJars 依赖项
2.  定义[此处记录的 WebJars 路由](http://www.webjars.org/documentation)
3.  将您的 JavaScript 文件放入`/app/assets/javascripts`
4.  使用 RequireJS（如此[处](https://github.com/playframework/Play20/wiki/RequireJS-support)所述）和 WebJars RequireJS 加载器来包含 WebJars 依赖项

因此，例如，假设您想使用 AngularJS。

构建.scala：

```
val appDependencies = Seq(
  "org.webjars" % "webjars-play" % "2.1.0-2",
  "org.webjars" % "angularjs" % "1.0.7"
) 
```

配置/路由

```
GET     /webjars/*file      controllers.WebJarAssets.at(file) 
```

应用程序/资产/javascripts/main.js

```
require(["webjars!angular.js"], function() {
  console.log(angular.isString(3));
} 
```

应用程序/视图/example.scala.html

```
...
@helper.requireJs(core = routes.Assets.at("javascripts/require.js").url, module = routes.Assets.at("javascripts/main").url)
... 
```

现在 JavaScript 控制台打印“false”。

# html - 在 Canvas HTML5 中用图像填充路径并拉伸图像

> ID：15167186
> 
> 赞同：0
> 
> 时间：2013-03-01T21:29:36.533
> 
> 标签：html, canvas, html5-canvas

我想用图像填充像圆形或自定义路径这样的路径，但想要拉伸图像，以便图像的像素不会位于封闭路径之外。这可以使用 Canvas 对象在 HTML5 中实现吗？

这是我的自定义路径：

```
ctx.beginPath();
    ctx.moveTo(170, 80);
    ctx.bezierCurveTo(130, 100, 130, 150, 230, 150);
    ctx.bezierCurveTo(250, 180, 320, 180, 340, 150);
    ctx.bezierCurveTo(420, 150, 420, 120, 390, 100);
    ctx.bezierCurveTo(430, 40, 370, 30, 340, 50);
    ctx.bezierCurveTo(320, 5, 250, 20, 250, 50);
    ctx.bezierCurveTo(200, 5, 150, 20, 170, 80);

    // complete custom shape
    ctx.closePath();
    ctx.lineWidth = 5;

    ctx.fillStyle = '#8ED6FF';
    ctx.fill();

    ctx.strokeStyle = 'blue';
    ctx.stroke(); 
```

我想要实现的是用图像填充云但拉伸它。长得丑也没关系。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T22:03:11.100

**[根据来自 OP 的更多信息进行编辑]**

**ima.js**是一个小图像脚本，它将像这样组合 2 个图像：

![在此处输入图像描述](../Images/41f5358bb08a77db6b10af377894c00b.png)

使用画布进入像这样的单个经线包络图像：

![在此处输入图像描述](../Images/66aca3d0c84a32ebee42250077c40d8a.png)

您可以在以下位置查看演示：http: [//ima.hobby.infi.nl/#](http://ima.hobby.infi.nl/#)

该脚本可在以下网址获得：http: [//ima.hobby.infi.nl/ima.js](http://ima.hobby.infi.nl/ima.js)

* * *

**[OP添加更多信息之前的先前答案]**

您可以在路径内剪辑图像。

是的，您可以像这样“拉伸”尺寸过小的图像：

```
context.drawImage(image,0,0,image.width,image.height,0,0,canvas.width,canvas.height); 
```

这是代码和小提琴：http: [//jsfiddle.net/m1erickson/T4eN8/](http://jsfiddle.net/m1erickson/T4eN8/)

```
<!doctype html>
<html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="css/reset.css" /> <!-- reset css -->
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

<style>
    body{ background-color: ivory; }
    canvas{border:1px solid red;}
</style>

<script>
    $(function(){

    var canvas=document.getElementById("canvas");
    var ctx=canvas.getContext("2d");

    // draw the cloud
    ctx.beginPath();
    ctx.moveTo(170, 80);
    ctx.bezierCurveTo(130, 100, 130, 150, 230, 150);
    ctx.bezierCurveTo(250, 180, 320, 180, 340, 150);
    ctx.bezierCurveTo(420, 150, 420, 120, 390, 100);
    ctx.bezierCurveTo(430, 40, 370, 30, 340, 50);
    ctx.bezierCurveTo(320, 5, 250, 20, 250, 50);
    ctx.bezierCurveTo(200, 5, 150, 20, 170, 80);
    ctx.closePath();
    ctx.lineWidth = 5;
    ctx.fillStyle = '#8ED6FF';
    ctx.fill();
    ctx.strokeStyle = 'blue';
    ctx.stroke();

    // clip any subsequent draws to the cloud
    ctx.beginPath();
    ctx.moveTo(170, 80);
    ctx.bezierCurveTo(130, 100, 130, 150, 230, 150);
    ctx.bezierCurveTo(250, 180, 320, 180, 340, 150);
    ctx.bezierCurveTo(420, 150, 420, 120, 390, 100);
    ctx.bezierCurveTo(430, 40, 370, 30, 340, 50);
    ctx.bezierCurveTo(320, 5, 250, 20, 250, 50);
    ctx.bezierCurveTo(200, 5, 150, 20, 170, 80);
    ctx.closePath();
    ctx.clip();

    // draw an image inside the cloud
    var img=new Image();
    img.onload=function(){
        ctx.drawImage(this,0,0,img.width,img.height);
    }
    img.src="http://www.gcc.edu/_layouts/GCC/Backgrounds/1024.jpg";

    }); // end $(function(){});
</script>

</head>

<body>
    <canvas id="canvas" width=600 height=400></canvas>
</body>
</html> 
```

# javascript - 移除主干视图后，僵尸事件仍然存在

> ID：15167187
> 
> 赞同：4
> 
> 时间：2013-03-01T21:29:39.427
> 
> 标签：javascript, backbone.js

更新：根据我的评论，我的问题是我有一个额外的模型，我正在传递给我没有解除绑定事件的视图。当我看到事件处理程序被触发时，我假设源来自 this.model 而不是 this.extra_model，因为我忘记了 this.extra_model 也被用于错误验证。

解决方案是添加以下内容：

```
MyView = Backbone.extend({
  //...
  //add method to override BaseView
  cleanUp: function() {
    this.extra_model.off(null, null, this);
    BaseView.prototype.cleanUp.apply(this, arguments);
  },
  //...
}); 
```

感谢您查看问题，并对程序员错误表示歉意。

* * *

全部：在清理视图后，我遇到过时/僵尸事件仍然被绑定的问题。当我将自定义事件绑定到模型时，问题就出现了。当我从 dom 中删除视图时，我调用 'this.model.off(null, null, this);' 正如各种留言板上所建议的那样，但是尽管我可以看到在 chrome 调试器工具中删除了“custom-handler”回调，但我仍然注意到“custom-handler”的事件处理程序被调用的次数超过了它应该调用的次数（每个额外一个触发事件时，我清理它后重新创建视图的时间）。有人能告诉我我的清理代码是否遗漏了什么吗？提前致谢！

```
BaseView = Backbone.extend({
//...
      displayErrors:function(){},

      cleanUp: function(){
        if (this.model) this.model.off(null, null, this);
        if (this.collection) this.collection.off(null, null, this);
        if (!this.options.persistDataAfterViewCleanup) {
          if (this.model) delete this.model;
          if (this.collection) delete this.collection;
        }
        //_.each(this.subViews, function(view){view.cleanUp();}); not needed yet.
        this.undelegateEvents();
        $(this.el).removeData().unbind();
        //Remove view from DOM
        this.$el.html('');
        this.remove();
      }
});

MyView = BaseView.extend({
  initialize: function(){
    //called manually from model using trigger
    this.model.on('custom-handler', this.displayErrors, this);
  }
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T09:35:06.197

假设您使用的是最新版本的 Backbone ( `0.9.10`)，您应该使用新[`Backbone.Events.listenTo`](http://backbonejs.org/#Events-listenTo)方法来绑定您的事件侦听器。使用此方法 Backbone 将保留对对象的引用，并在以下情况下自动清除所有事件绑定[`view.remove()`](http://backbonejs.org/#View-remove)：

```
this.listenTo(this.model, 'custom-handler', this.displayErrors); 
```

您在`cleanUp`方法中所做的所有事情（`delete`, `undelegateEvents`, `removeData`, `unbind`, `$el.html('')`）看起来很像巫毒编程。根本不需要这些步骤。

您的僵尸视图很可能是由于直接或间接地引用了您自己的代码所持有的视图。引用可以由事件处理程序、绑定函数、导出的闭包或任何数量的事物持有。我建议您尝试分析您的代码，并使用 Chrome 开发人员工具的[堆分析器](https://developers.google.com/chrome-developer-tools/docs/heap-profiling)工具来尝试查找保留的对象及其引用。

查看[我在这个 SO question 中的回答](https://stackoverflow.com/a/14482940/4333)，我在其中描述了一种在特定代码路径中查找内存泄漏的简单方法。虽然您的问题不直接与内存泄漏有关，但它与泄漏引用有关，其保留的堆大小应该可以帮助您找到保留它们的内容。

# jquery - 确保整个动态生成的 ul 及其 lis 出现在页面底部上方

> ID：15167188
> 
> 赞同：0
> 
> 时间：2013-03-01T21:29:41.180
> 
> 标签：jquery

我有一个动态扩展的浏览树。当用户单击动态创建的 li 时，她/他会展开下一个 UL > LI。如果新创建的 UL 中只有一个选择，则自动转发到下一级。发生这种情况时，第三个列表中的项目有时会显示在页面底部下方。

```
<div id="wrapper">
<ul id="ul-level-one">
    <li id="1">Item one</li>
    <li id="2">Item two</li>
    <li id="3">Item three</li> [selected]
        <ul id="ul-level-two">
            <li id="1">Item A</li>
                <ul id="ul-level-three">
                    <li id="1">Item one</li>
                    <li id="2">Item two</li>
                    <li id="3">Item three</li> -- these items fall below page bottom
                    <li id="4">Item four</li>
                </ul>
        </ul>
    <li id="4">Item four</li>
    <li id="5">Item five</li>
</ul>
</div> 
```

我正在尝试找到一种方法来确保显示 ul 的所有项目。我尝试将最新 UL 的最终 LI 滚动到视图中，但它似乎不起作用。

```
$('#ul-level-three li:last').get(0).scrollIntoView(); 
```

请协助。

国民党

# solr - 如何在 StrField 上执行包含查询

> ID：15167191
> 
> 赞同：0
> 
> 时间：2013-03-01T21:29:49.283
> 
> 标签：solr

我有一个 Solr 3.5 索引，我需要运行一个快速**包含查询**以进行调试。

该列的类型为**StrField**，我需要执行类似的操作`q=FieldName:*.MP4`

* * *

我知道一个永久的解决方案是将字段重新索引为 ngram，但这只是一个快速的一次性查询，我想知道它是否可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T06:29:27.187

由于您使用的是 Solr 3.5，因此不支持以通配符开头的查询。但是，您可以创建所有术语的反向索引。这意味着您将向后索引所有术语，并且您的查询看起来像 q==FieldName:4pm.*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:38:49.730

如果您使用的是 Solr 4.0+，您可以进行正则表达式查询：

```
q=FieldName:/.*%5C.MP4/ 
```

`%5C`的 URL 编码在哪里`\`。

**更新：**嗯，你甚至不需要那个。您的查询

```
q=FieldName:*.MP4 
```

应该管用。我在 4.0 和 3.6.1 中尝试过，效果很好。

如果你也想要`*.mp4`，那么做一个这样的 OR 查询：

```
q=FieldName:(*.MP4 OR *.mp4) 
```

**更新 2：**由于您的 Solr 版本是 3.5，您稍后将其添加到您的问题中，我想上面的两个选项都不适合您。我想你需要重新索引，除非有人知道如何在 solr 3.5 中打开前导通配符。

# python-2.7 - 如何将 IPython 解释器嵌入到在 IPython Qt 控制台中运行的应用程序中

> ID：15167200
> 
> 赞同：17
> 
> 时间：2013-03-01T21:30:53.090
> 
> 标签：python-2.7, ipython, qtconsole

关于这个有几个主题，但没有一个令人满意的答案。

我有一个在 IPython qt 控制台中运行的 python 应用程序

[http://ipython.org/ipython-doc/dev/interactive/qtconsole.html](http://ipython.org/ipython-doc/dev/interactive/qtconsole.html)

当我遇到错误时，我希望能够在那时与代码进行交互。

```
 try: 
      raise Exception()
    except Exception as e:
        try: # use exception trick to pick up the current frame
            raise None
        except:
            frame = sys.exc_info()[2].tb_frame.f_back
        namespace = frame.f_globals.copy()
        namespace.update(frame.f_locals)
        import IPython
        IPython.embed_kernel(local_ns=namespace) 
```

我认为这会起作用，但我收到一个错误：

RuntimeError：线程只能启动一次

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2014-02-02T07:17:24.630

我只是用这个：

```
from IPython import embed; embed() 
```

对我来说比其他任何东西都好:)

* * *

**更新：**

为了庆祝这个答案获得 50 票赞成，以下是我在此片段发布后的六年中对其所做的更新。

首先，我现在喜欢在单个语句中导入和执行，因为这些天我对所有 python 代码都使用[黑色](https://github.com/psf/black)，并且它以在这种特定和不寻常的上下文中没有意义的方式重新格式化原始代码段。所以：

```
 __import__("IPython").embed() 
```

考虑到我经常在循环或线程中使用它，包含一个允许终止父进程的片段会很有帮助（部分是为了方便，部分是为了提醒自己最好的方法）。 `os._exit`是这里的最佳选择，所以我的片段包括这个（使用单个语句的相同逻辑）：

```
q = __import__("functools").partial(__import__("os")._exit, 0) 
```

然后我可以简单地使用`q()`if/when 我想退出主进程。

我的完整片段（`# FIXME`以防我可能忘记删除它！）看起来像这样：

```
q = __import__("functools").partial(__import__("os")._exit, 0)  # FIXME
__import__("IPython").embed()  # FIXME 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-27T17:20:42.313

您可以按照[以下方法](http://ipython.org/ipython-doc/dev/interactive/reference.html#embedding-ipython)将 IPython 会话嵌入到您的程序中：

```
try:
    get_ipython
except NameError:
    banner=exit_msg=''
else:
    banner = '*** Nested interpreter ***'
    exit_msg = '*** Back in main IPython ***'

# First import the embed function
from IPython.frontend.terminal.embed import InteractiveShellEmbed
# Now create the IPython shell instance. Put ipshell() anywhere in your code
# where you want it to open.
ipshell = InteractiveShellEmbed(banner1=banner, exit_msg=exit_msg) 
```

然后`ipshell()`在您想要放入 IPython shell 时使用。这将允许您在代码中嵌入（甚至嵌套）IPython 解释器并检查对象或程序的状态。

# r - 在R中添加为整数而不是列表元素

> ID：15167204
> 
> 赞同：-2
> 
> 时间：2013-03-01T21:31:04.420
> 
> 标签：r

在R中添加为整数而不是列表元素

我正进入（状态

```
> total = 0
> for (qty in a[5]){
+ total = total + as.numeric(unlist(qty))
+ print(total)
+ }
 [1] 400 400 400 400 400 400 400 400 400 400 
```

我真正想要的是：

```
> total = 0
> for (qty in a[5]){
+ total = total + as.numeric(unlist(qty))
+ print(total)
+ }
 [1] 400 800 1200 1600 2000 2400 2800 3200 3600 4000 
```

细化：对更具体的场景再多一点，

```
price buy_sell  qty
100        B  100
100        B  200
90        S  300
100        S  400 
```

我想做第四栏

```
price buy_sell  qty net
100        B  100   10000
100        B  200   30000
90        S  300    3000
100        S  400   -37000 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T21:35:41.360

请注意，如果`a`是列表，则要使用双括号。否则，您将返回一个大小为 1 的列表，其中第一个元素具有您要查找的值

尝试：

```
 total <- cumsum(a[[5]]) 
```

* * *

```
a <- list()
a[[5]] <- rep(400, 10)

cumsum(a[[5]])
#  [1]  400  800 1200 1600 2000 2400 2800 3200 3600 4000 
```

相比：

```
 a[5]
 a[[5]]
 a[5][[1]] 
```

# heroku - Heroku：子目录中的procfile

> ID：15167205
> 
> 赞同：2
> 
> 时间：2013-03-01T21:31:07.580
> 
> 标签：heroku

我有一个项目的 git 存储库，堆栈的许多部分都在它们自己的子目录中。像这样的东西：

```
.
..
./A
./B
./C
 ./Procfile
 ./packjage.json
./D 
```

文件夹 C 是我想在 Heroku 上运行的该应用程序的唯一部分，但 Heroku 不喜欢不在存储库根目录中的 procfiles。

有没有办法告诉 Heroku 你的 procfile/package.json 在哪里？还是我必须以某种方式拆分一个非常大的存储库（我真的不想这样做）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T16:02:08.290

Procfile[必须](https://devcenter.heroku.com/articles/procfile#process-types-as-templates)在根目录中。你不能把它放在其他任何地方——那是唯一被搜索的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-07-04T16:25:41.610

看看[这个](https://elements.heroku.com/buildpacks/sjtrny/subdir-depend-heroku-buildpack)。

您的 Procfile 必须位于此处另一个答案中提到的根目录中。

如果您有这样的项目树：

```
- Procfile
- requirements.txt
- data/
    - data.csv
- src/
    - app.py 
```

你可以告诉 gunicorn 先切换到这个子目录，然后指向 src/app.py

您的 Procfile 应如下所示：

```
web: gunicorn --chdir ./src app:app 
```

# php - 如何使用 PHP 从服务器打印内容？

> ID：15167207
> 
> 赞同：2
> 
> 时间：2013-03-01T21:31:14.573
> 
> 标签：php, printing

我需要让我的 PHP 应用程序使用连接到服务器的打印机打印一些东西。

在 PHP 4.0 中`php_printer.dll`存在，但已停产。

有人对如何使用 PHP 5 完成此操作有任何想法或建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:02:24.400

您可以将输出写入文件，然后使用`exec`正确的命令（取决于操作系统）打印文件。

例子：

```
exec('lpr /some/path/to/the/file', $output);    // linux
exec('print C:\again\a\path', $output);         // windows 
```

您可能必须检查 php 用户是否具有打印权限。

# internet-explorer-9 - IE9 中 ng-repeat 中 AngularJS 的问题

> ID：15167213
> 
> 赞同：2
> 
> 时间：2013-03-01T21:31:55.787
> 
> 标签：internet-explorer-9, angularjs, ng-repeat

Firefox 和 Chrome 的工作就像一个魅力，只有 IE9 又烦人了。我使用这些代码片段：

```
<div class="weekDays-sliders" fixed="0">
    <div class="weekDays-slider" style="left: {{30+($index*485)}}px;" ng-repeat="week in searchResult.weeks">
        <div class="weekDay" ng-repeat="day in week.days">
            <div class="weekDay-name">{{day.name}}</div>
            <div class="weekDay-date">{{day.date}}</div>
        </div>
    </div>
</div> 
```

使用 {{30+($index*485)}} 我计算 div 的正确位置。他们都是并排的。问题是 IE 忽略了这一点。IE 甚至没有添加样式属性。（见屏幕）

![在此处输入图像描述](../Images/790cba0499d6829a9d238fe72ab5f425.png)

这是什么问题，我该如何解决这些问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T09:15:01.560

使用 ng-style 它可以按预期工作

```
ng-style="{'left': 30+($index*485)+'px'}" 
```

# jquery-ui - jQuery ui选项卡在悬停时旋转暂停

> ID：15167216
> 
> 赞同：0
> 
> 时间：2013-03-01T21:32:01.523
> 
> 标签：jquery-ui, rotation

我正在使用 jquery ui 开发一个旋转器，并且可以让它在悬停时暂停：

```
$(document).ready(function(){  
    $("#rotator").tabs({fx:{opacity: "toggle"}}).tabs("rotate", 5000, true);  
    $("#rotator").hover(  
        function() {  
            $("#rotator").tabs("rotate",0,true);  
        },  
        function() {  
            $("#rotator").tabs("rotate",5000,true);  
        }  
    );  
}); 
```

唯一的问题是它停在列表中的最后一项上，除非我做到，否则不会轮换第一项：

```
$(document).ready(function(){  
    $("#rotator > ul").tabs({fx:{opacity: "toggle"}}).tabs("rotate", 5000, true);  
    $("#rotator").hover(  
        function() {  
            $("#rotator").tabs("rotate",0,true);  
        },  
        function() {  
            $("#rotator").tabs("rotate",5000,true);  
        }  
    );  
}); 
```

但随后悬停不起作用。

任何想法如何让它在列表中循环并在悬停时暂停？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:04:38.410

出于某种原因，我有一个非常旧版本的 jquery 和 jquery ui。我更新到我们网站上运行的版本（1.7.2 和 jquery ui 1.82）。可以运行最新版本，但遗留代码有太多问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T14:13:16.267

伙计们！我刚刚提交了一个扩展，让 jQuery UI 选项卡的悬停时暂停 [jQuery UI 选项卡旋转：悬停时暂停](https://github.com/tigusigalpa/jQuery-UI-tabs-Rotate-Pause-on-hover)

好好享受！

# c# - 列表中的多对多

> ID：15167219
> 
> 赞同：0
> 
> 时间：2013-03-01T21:32:10.070
> 
> 标签：c#, linq, linq-to-entities

执行以下代码时

```
 public static List<Filmler> GetPlayerByMovie(int id)
    {
        var data = from o in db.Oyuncular
                   where o.OyuncularID == id
                   select o;

        return data.ToList();
    } 
```

我收到此错误消息：

> 错误 1：无法将类型“System.Collections.Generic.List”隐式转换为“System.Collections.Generic.List”c:\users\furkan\documents\visual studio 2012\Projects\DvdKiralamaFurkanR\DvdKiralamaFurkanR\Service.cs

我在 SQL 上有 2 个普通表和 1 个桥接表。我想在 Linq 上连接它。但我没能成功。我怎样才能发回列表。

你能帮助我吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T21:33:54.390

```
public static List<Filmler> GetPlayerByMovie(int id)
    {
        var data = from o in db.Oyuncular
                   where o.OyuncularID == id
                   select new Filmler{populate properties here ex Id = o.Id};

        return data.ToList();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T10:49:20.463

You can just use the [Enumerable.ToList()](http://msdn.microsoft.com/en-us/library/bb342261.aspx) method in the linq for this

```
public static List<Filmler> GetPlayerByMovie(int id)
{
    var data = (from o in db.Oyuncular
                where o.OyuncularID == id
                select o).ToList();

    return data;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T21:38:34.227

在您的列表中，您应该返回 Filmler 类型的对象的 lollection

```
 List<Filmler> GetPlayerByMovie(int id) 
```

但你正试图返回一个 Oyuncular 类型的对象

```
 var data = from o in db.Oyuncular
                   where o.OyuncularID == id
                   select o;
  return data.ToList(); 
```

您可以返回类型 `List<Oyuncular> GetPlayerByMovie(int id)`

或将 Filmler 与 Oyuncular 匹配

```
 var data = (from o in db.Oyuncular
                       where o.OyuncularID == id
                       select  new Filmler {//Filmproperty=o.propperty}; 
```

# iphone - AVPlayer - 快退/快退

> ID：15167220
> 
> 赞同：2
> 
> 时间：2013-03-01T21:32:11.917
> 
> 标签：iphone, ios, xcode, avplayer, cmtime

是否可以快退/倒带 AVPlayer 流？我快进正常工作，但没有快退。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-21T23:40:37.060

初始化 AVAsset 时，您指定一个选项字典，其中一个选项（实际上是我知道的唯一选项）是 AVURLAssetPreferPreciseDurationAndTimingKey。这默认为 NO。您想以这种方式进行初始化：

```
AVURLAsset* asset = [[AVURLAsset alloc] initWithURL:url
                  options:@{AVURLAssetPreferPreciseDurationAndTimingKey: @YES}];
AVPlayerItem* playerItem = [AVPlayerItem playerItemWithAsset:asset];
self.player = [[AVPlayer alloc] initWithPlayerItem:playerItem]; 
```

您可以查询播放器项目是否可以反向播放、快速反向播放等。根据流的类型，它可能无法播放。本地磁盘上的 quicktime 文件当然没有问题。还要记住 AVFoundation 是异步的。这意味着您可以只调用 setter，但需要对动态设置进行 KV 观察，或者对静态设置使用 AVAsynchronousKeyValueLoading 协议。

最后一个问题。如果您使用默认的 init'ed AVCaptureSession，它会以超高质量记录，前进速度快，但后退速度要慢得多，而且更不稳定。即使在 iPhone 5 上。使用较低的质量设置以获得流畅的向后播放。

# jenkins - Jenkins 可以检测到 Bamboo 服务器上何时有新版本可用吗？

> ID：15167221
> 
> 赞同：0
> 
> 时间：2013-03-01T21:32:13.580
> 
> 标签：jenkins, continuous-integration, bamboo

Jenkins 可以检测到 Bamboo 服务器上何时有新版本可用吗？

我想要的是创建一个 Jenkins 作业来检查 Bamboo 服务器的新版本。我希望这项工作每小时运行一次。

然后，我在该 Jenkins 服务器上进行的其他测试将依赖于该检查通过才能启动。

如果这是可能的，那么通常的做法是什么？Bamboo 服务器是内部的，不需要身份验证来查看构建状态或获取构建资源。

如果没有插件，我会在这个 URI 上看到一个 RSS 提要： **/rss/createAllBuildsRssFeed.action?feedType=rssAll&buildKey=RELEASE** 。其他 Jenkins 管理员会使用什么方法来阅读此提要？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T00:50:03.177

我自己想出了答案。 [我编写了一个在 Jenkins 中运行的 Gradle 单元测试，它可以读取 Bamboo 中的 RSS 提要](https://gist.github.com/djangofan/5069075)。

但是，真正的方法是在 Subverison 或 Bamboo 中添加一个构建后挂钩，以向 Jenkins 发送 HTTP 获取请求，通知作业运行。

# iphone - 颜色键盘应用程序（在 App Store 上）如何改变键盘外观？

> ID：15167222
> 
> 赞同：0
> 
> 时间：2013-03-01T21:32:28.097
> 
> 标签：iphone, ios, keyboard

有一个名为“彩色键盘”的应用程序，它改变了 iOS 的键盘外观。它在 App Store 上。这怎么可能？

如何在我的应用程序中更改键盘的颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:34:34.773

假设您有一个`UITextField`named ，您可以通过设置其属性`myTextField`将 any`UIView`作为此文本字段的自定义键盘。`inputView`

因此，您可以创建一个`UIView`完整的按钮，看起来像一个键盘，并将其附加到您的视图中。

这适用于任何`UIResponder`，而不仅仅是文本字段。

# charts - 剑道图表条形系列与线型系列相结合，图表恢复为柱型系列

> ID：15167230
> 
> 赞同：0
> 
> 时间：2013-03-01T21:33:05.540
> 
> 标签：charts, kendo-ui

我正在尝试将线型系列，即“series.Line(s=>s.Name(“goal”)”添加到图表中——这用于显示各种阈值。其余系列是条形类型系列："series.Bar(s=s.Name("Rate1") 和 "series.Bar(s=s.Name("Rate2") 和 "series.Bar(s=s.Name("Rate3") 和等等。如果我删除“目标”行代码，则图表按预期呈现为水平条；但是，如果我包含“目标”行代码，则图表呈现为垂直列（我假设的默认值）。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-07T10:31:40.060

我认为您在这里缺少理解的东西。

一条线将从左到右显示（通常）值的进展（通常在一段时间内）。意味着它们的零值在水​​平轴上。

条在垂直轴上的值为零。

因此 2 系列类型不兼容。因此，Kendo 将图表从“条形图”更改为“柱形图”。

所以基本上，你正在寻找的是一个垂直线系列类型（我认为不存在）。

您可能希望将这些显示为子弹图。

[http://demos.kendoui.c​​om/dataviz/bullet-charts/index.html](http://demos.kendoui.com/dataviz/bullet-charts/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-29T13:43:13.637

根据[Telerik](http://www.telerik.com/community/forums/reporting/telerik-reporting/pareto-chart.aspx)的说法：

> 图表项不提供对帕累托图的内置支持，换句话说，图表项将无法为您进行百分比计算，您应该在绑定图表之前注意这一点。完成后，您可以通过组合 Bar 和 Line 系列类型来实现相同的功能。要创建从 0% 到 100% 标记的第二个**Yaxis** ，请尝试以下代码片段：

```
chart1.PlotArea.YAxis.AutoScale = False
chart1.PlotArea.YAxis.AddRange(0, 100, 10)
chart1.PlotArea.YAxis.Appearance.ValueFormat = ChartValueFormat.Percent 
```

这是一个如何使用 MySQL 预先计算百分比的示例：

```
SELECT a.`Year`, @count := (a.`count`) AS `Count`,
     @total := ROUND((@count)/(SELECT @total := count(`year`) AS `total` FROM `table` c) * 100, 2) as `% of Total`,
     @cumulative := (@total + @cumulative) as `Cumulative %`
FROM (SELECT @cumulative := 0, `year`,count(`year`) AS `count` FROM `table` `data` GROUP BY `year` ORDER BY `count` DESC) a
ORDER BY `Count` DESC; 
```

# php - 每次人会去一个页面，数据库中的int会增加

> ID：15167234
> 
> 赞同：-1
> 
> 时间：2013-03-01T21:33:29.823
> 
> 标签：php, mysql

基本上，我希望每次成员查看页面时都会增加 vote_count。

从 1 到 2，从 2 到 3，等等。

我已经这样做了，但它并没有真正起作用：

```
 mysql_connect('localhost', 'vote', '') or die (mysql_error());
    mysql_select_db('counter') or die (mysql_error());
    mysql_query("INSERT INTO `vote_count` (`vote_number`) VALUES (NULL)");
    mysql_close(); 
```

它保持为空。

我的行看起来像这样： ![图像](../Images/eb20027d110e2cb5c3f45457b10d0ddc.png)

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:35:35.073

1.  停止使用`mysql_`函数；它们已被弃用

2.  使用错误处理来捕获错误：

    `mysql_query("INSERT INTO vote_count (vote_number) VALUES (NULL)") or die( mysql_error() );`

3.  该列不允许`NULL`。

4.  用于`UPDATE`更新/**增加**计数：

    `UPDATE vote_count SET vote_number = vote_number + 1`

5.  使用密码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:36:13.173

您已经拥有价值，只是想更新它。因此，您只需要将其值增加 1。

因此，您可以使用

```
mysql_query("UPDATE `vote_count` SET vote_number=vote_number+1"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T21:42:17.223

您可能应该考虑通过刷新来阻止人们提高观点/投票：

```
if(!isset($_SESSION['voted']) && $_SESSION['voted']){
    mysql_query("UPDATE `vote_count` SET vote_number=vote_number+1") or trigger_error(mysql_error());
    $_SESSION['voted'] = true;
}
else{
    //Already voted.
} 
```

# c# - 如何在 asp.net 中将网页导出/保存为图像

> ID：15167236
> 
> 赞同：-1
> 
> 时间：2013-03-01T21:33:33.933
> 
> 标签：c#, asp.net

我正在尝试截取页面并将其保存为图像。该页面有几个 div 标签和每个 div 中的不同内容，比如一个 div 标签有图表，另一个可能有 gridview。所以我试图拍摄页面的快照并将其保存为图像。有人可以在这里帮助我，因为我用谷歌搜索并找不到任何好的资源。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:42:21.037

以下似乎有效。我从[将网页转换为来自 ASP.NET 的图像得到这个](https://stackoverflow.com/questions/2715385/convert-webpage-to-image-from-asp-net)

利用：

```
 using System.Drawing;
   using System.Drawing.Imaging;
   using System.IO;
   using System.Threading;
   using System.Windows.Forms;

   public class WebsiteToImage
   {
private Bitmap m_Bitmap;
private string m_Url;
private string m_FileName = string.Empty;

public WebsiteToImage(string url)
{
    // Without file 
    m_Url = url;
}

public WebsiteToImage(string url, string fileName)
{
    // With file 
    m_Url = url;
    m_FileName = fileName;
}

public Bitmap Generate()
{
    // Thread 
    var m_thread = new Thread(_Generate);
    m_thread.SetApartmentState(ApartmentState.STA);
    m_thread.Start();
    m_thread.Join();
    return m_Bitmap;
}

private void _Generate()
{
    var browser = new WebBrowser { ScrollBarsEnabled = false };
    browser.Navigate(m_Url);
    browser.DocumentCompleted += WebBrowser_DocumentCompleted;

    while (browser.ReadyState != WebBrowserReadyState.Complete)
    {
        Application.DoEvents();
    }

    browser.Dispose();
}

private void WebBrowser_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
{
    // Capture 
    var browser = (WebBrowser)sender;
    browser.ClientSize = new Size(browser.Document.Body.ScrollRectangle.Width, browser.Document.Body.ScrollRectangle.Bottom);
    browser.ScrollBarsEnabled = false;
    m_Bitmap = new Bitmap(browser.Document.Body.ScrollRectangle.Width, browser.Document.Body.ScrollRectangle.Bottom);
    browser.BringToFront();
    browser.DrawToBitmap(m_Bitmap, browser.Bounds);

    // Save as file? 
    if (m_FileName.Length > 0)
    {
        // Save 
        m_Bitmap.SaveJPG100(m_FileName);
    }
}
 }

 public static class BitmapExtensions
 {
  public static void SaveJPG100(this Bitmap bmp, string filename)
  {
      var encoderParameters = new EncoderParameters(1);
      encoderParameters.Param[0] = new EncoderParameter(System.Drawing.Imaging.Encoder.Quality, 100L);
       bmp.Save(filename, GetEncoder(ImageFormat.Jpeg), encoderParameters);
  }

public static void SaveJPG100(this Bitmap bmp, Stream stream)
{
    var encoderParameters = new EncoderParameters(1);
    encoderParameters.Param[0] = new EncoderParameter(System.Drawing.Imaging.Encoder.Quality, 100L);
    bmp.Save(stream, GetEncoder(ImageFormat.Jpeg), encoderParameters);
}

public static ImageCodecInfo GetEncoder(ImageFormat format)
{
    var codecs = ImageCodecInfo.GetImageDecoders();

    foreach (var codec in codecs)
    {
        if (codec.FormatID == format.Guid)
        {
            return codec;
        }
    }

    // Return 
    return null;
}
} 
```

实施：

```
 WebsiteToImage websiteToImage = new WebsiteToImage( "http://www.cnn.com", @"C:\Some Folder\Test.jpg");
   websiteToImage.Generate(); 
```

# iphone - 寻找使用 GLKit 的控件（按钮、滑块等）示例

> ID：15167238
> 
> 赞同：0
> 
> 时间：2013-03-01T21:33:39.837
> 
> 标签：iphone, ios, objective-c, model-view-controller, glkit

我需要将简单的控件（按钮、滑块等）添加到[GLKView](http://developer.apple.com/library/ios/#documentation/GLkit/Reference/GLKView_ClassReference/Reference/Reference.html)，它可以[识别手势](http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/GestureRecognizer_basics/GestureRecognizer_basics.html)，并将动作发送到[GLKViewController](http://developer.apple.com/library/ios/#documentation/GLkit/Reference/GLKViewController_ClassRef/Reference/Reference.html#//apple_ref/occ/cl/GLKViewController)。这些控件将用于向我正在使用[GLKit](http://developer.apple.com/library/ios/#documentation/GLkit/Reference/GLKit_Collection/_index.html)制作的游戏添加动画的、部分透明的菜单和按钮。

看起来这应该相对简单，而且非常普遍。我想每个 iOS 游戏都需要做这样的事情，但我似乎找不到一个不使用 Cocos2D（与 GLKit 不兼容）或 UIKit（不使用 OpenGL 绘制）的示例。

如果有人可以为我提供一个工作示例，或者为我指明正确的方向，我将永远感激不尽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:40:03.990

在这种情况下，正确的方向非常简单。您只需将您的 GLKView，它是 UIView 的子视图和您的按钮添加到同一个 UIView 超级视图。像这样：

```
UIViewSuperview
  |
  |
   -GLKView
  |
   -UIButton1
  |
   -UIButton2
  |
   -UIButton3 
```

这不是你想要的吗？

# jquery - asp.net forms authentication + jquery get requests

> ID：15167242
> 
> 赞同：1
> 
> 时间：2013-03-01T21:33:53.053
> 
> 标签：jquery, asp.net, asp.net-mvc, forms-authentication

假设用户已成功“通过 cookie asp.net 表单身份验证”。(S)他现在可以通过控制器 B 的操作 A 执行获取请求。假设这会将 HTML 返回到用户的浏览器。这个 HTML 包含一些 jquery 代码，这些代码执行一个 GET 请求到一个也需要身份验证的操作（例如，在用户点击一个按钮之后）。当用户登录并有 cookie 时，jquery GET 请求是否会自动进行身份验证？希望这是有道理的。

如果不是，最好的检查方法是什么，在身份验证/授权期间请求是否是 ajax 请求（例如在过滤器属性中）。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:08:41.917

APS.NET Forms 身份验证与大多数 Web 身份验证一样使用 cookie。

cookie 将与您请求的域相关联。

因此，ajax 或常规请求都只是 HTTP 请求（通常是 GET 或 POST），所有对服务器的请求（取决于 http 标头）都将包含 cookie 作为请求的一部分。

如何在服务器端实现安全性取决于您。

# c# - 具有异步 Session_Start 方法时的会话问题？

> ID：15167243
> 
> 赞同：3
> 
> 时间：2013-03-01T21:33:54.210
> 
> 标签：c#, asp.net, asynchronous

我最近开始使用 .NET 4.5 而不是 .NET 4.0，我很喜欢这个`async`功能。

但是，当在我的 Global.asax 的 Session_Start 事件中在 ASP .NET 中使用它时，无论我做什么（如果我执行等待并访问会话），都会导致错误。

这是代码。我相信你可以复制这个问题。问题是 - 我该如何解决？

```
protected async void Session_Start(object sender, EventArgs e)
{
    var stuff = await UserAccess.RetrieveSomeStuff();
    Session["Stuff"] = stuff;
} 
```

我收到的错误如下。

> 异步模块或处理程序已完成，而异步操作仍处于挂起状态。

我也尝试了以下代码，但没有运气。

```
protected void Session_Start(object sender, EventArgs e)
{
    var stuffTask = UserAccess.RetrieveSomeStuff();
    stuffTask.Wait();

    Session["Stuff"] = stuffTask.Result;
} 
```

在那种情况下，它的状态会是`WaitingForActivation`不断的，这可能表明它没有被放入系统要执行的任务队列中（可能是因为系统正在等待`Wait()`调用本身完成？）。

我也尝试手动启动任务。在这种情况下，它只会崩溃，因为您无法手动启动任务。就我而言，它必须由系统完成。

有什么线索吗？这个很难。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T22:29:44.457

`InvalidOperationException`你得到的是 ASP.NET 告诉你你不能有那个事件的处理`async`程序的方式。

但实际上，您要做的是*启动*一些异步资源初始化，然后（异步）稍后在您真正需要它时等待它。所以你的对象`Session`应该真的是 a `Task<T>`，像这样：

```
protected void Session_Start(object sender, EventArgs e)
{
    Session["Stuff"] = LoadMyDataAsync();
}

static async Task<int> LoadMyDataAsync()
{
    await Task.Delay(1000);
    return 13;
} 
```

然后你可以像这样使用它（这个例子是一个 ASP.NET MVC 4 控制器，但是 WebAPI 和 async WebPages 可以使用类似的技术）：

```
public async Task<ActionResult> Index()
{
    ViewBag.Message = await (Session["Stuff"] as Task<int>);
    return View();
} 
```

这有点尴尬，因为`Session`不是强类型。

# php - 在整个会话中使用相同随机数的 php 随机数代码

> ID：15167252
> 
> 赞同：0
> 
> 时间：2013-03-01T21:34:24.107
> 
> 标签：php, session, random, numbers

我在我的 Wordpress 网站上找到[了](https://stackoverflow.com/questions/3140235/php-random-number)一个 php 随机数生成器。当浏览器重新加载时，实际代码（见下文）会显示一个新的随机数。我的目标是在整个浏览器会话中出现相同的随机数。

```
$amountOfDigits = 3;
$numbers = range(0,9);
shuffle($numbers);

for($i = 0;$i < $amountOfDigits;$i++)
$digits .= $numbers[$i];

echo $digits; //prints 217356 
```

我在上面添加了什么代码，以便在整个浏览器会话中出现相同的随机数？我读了这个[问题](https://stackoverflow.com/questions/2642047/pseudo-random-numbers-in-php)，但我不确定该代码是否可以与上面的代码一起使用。我也读过[这个问题](https://stackoverflow.com/questions/8069326/reproducible-random-number-series)，但它在我的头上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:37:40.573

将其粘贴在 a 中`$_SESSION`，然后将其回显。

```
[code]

session_start();     

if (!isset($_SESSION['random'])) {

    $amountOfDigits = 3;
    $numbers = range(0,9);
    shuffle($numbers);

    for($i = 0;$i < $amountOfDigits;$i++)
    $digits .= $numbers[$i];

    $_SESSION['random'] = $digits;

}
elseif (isset($_SESSION['random'])) {
    echo $_SESSION['random']; //prints 217356
}

[/code] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T21:39:12.900

将其存储在会话中...

```
function getRandom()
{
   if(isset($_SESSION['myRandomNumber'])
      return $_SESSION['myRandomNumber'];

   $amountOfDigits = 3;
   $numbers = range(0,9);
   shuffle($numbers);

   for($i = 0;$i < $amountOfDigits;$i++)
      $digits .= $numbers[$i];

   // Store in session
   $_SESSION['myRandomNumber'] = $digits

   return $digits;
 } 
```

在使用这样的功能之前一定要使用`session_start()`。

# c++ - 为什么非 const、非 int/enum 静态数据成员必须在定义之外进行初始化？

> ID：15167254
> 
> 赞同：6
> 
> 时间：2013-03-01T21:34:24.647
> 
> 标签：c++, static, header

我知道只有静态、常量和 int/enum (pre c++11) 的数据成员才能在类声明中初始化。“所有其他静态数据成员必须在全局命名空间范围内定义（即在类定义的主体之外），并且只能在这些定义中初始化”。

为什么不能在类定义中初始化其他静态数据成员？是否有特定原因被禁止？

如果数据成员是特定于类的，为什么它们是在全局命名空间范围内声明的，而不是与其类相关的某个范围？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T21:42:47.300

> 为什么不能在类定义中初始化其他静态数据成员？是否有特定原因被禁止？

很可能是因为 C++ 有单独的翻译单元。编译器需要选择一个目标文件，用于放置这些符号的初始化逻辑。强制将其放在特定的源文件中可以使编译器轻松做出该决定。

> 如果数据成员是特定于类的，为什么它们是在全局命名空间范围内声明的，而不是与其类相关的某个范围？

因为这正是 C++ 处理类成员的方式。这与其他类成员（如成员函数）没有什么不同：

头文件：

```
namespace example {

// Class declared in header
struct some_class
{
    // Member variable
    static float example;
    // Member function
    void DoStuff() const;
};

} 
```

源文件：

```
namespace example {

    // Implement member variable
    float some_class::example = 3.14159;
    // Implement member function
    void some_class::DoStuff() const
    {
         //....
    }
} 
```

允许在标头中初始化静态 const 整数成员有一个特定的例外，因为它允许编译器将它们视为编译时常量。也就是说，您可以使用它们来定义数组的大小或类定义中的其他类似位。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T21:58:04.050

> 为什么不能在类定义中初始化其他静态数据成员？是否有特定原因被禁止？

通常，所有静态对象都需要在一个翻译单元中进行定义，以便它们具有明确定义的地址。作为一个特殊的例外，静态、常量、非易失类成员如果不需要*其*地址，则不需要定义，并且它们具有足够简单的类型，可以将其值替换为编译时常量。

从历史上看，“足够简单”被定义为整数或枚举类型；C++11 将其扩展为包含任何带有`constexpr`说明符的文字类型。

> 如果数据成员是特定于类的，为什么它们是在全局命名空间范围内声明的，而不是与其类相关的某个范围？

它们未在全局命名空间范围内声明。它们在类中声明和作用域。

如果你的意思是，为什么要在类定义之外定义它们*，*那是因为在整个程序中必须只有一个静态成员的定义；但是必须在使用它的每个翻译单元中定义该类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-01T22:03:34.217

> 为什么不能在类定义中初始化其他静态数据成员？是否有特定原因被禁止？

静态数据成员在许多方面（尤其是从编译器的角度来看）类似于具有外部链接的命名空间范围数据对象。

静态数据成员的声明只是一个声明，而不是定义。它类似于`extern`全局对象的声明，并且必须包含在可以使用该对象的任何翻译单元中。

定义必须恰好出现在一个翻译单元中，这是初始化表达式所属的地方。除非表达式满足常量表达式的严格标准，否则它的值很可能取决于调用它的时间和上下文。在多个翻译单元中出现这样的初始化表达式会使初始化的执行上下文和时间以及最终的初始值不明确。

类范围的编译时常量被认为足够有价值，可以为某些类型的常量静态成员（然后可用于初始化枚举或指定数组维度等）进行例外处理。使用常量表达式至少更难在不同的翻译单元中意外地产生不同的初始化器值。这个概念在 C++11 中通过`constexpr`成员进行了扩展。

> 如果数据成员是特定于类的，为什么它们是在全局命名空间范围内声明的，而不是与其类相关的某个范围？

声明在类范围内。非定义声明实际上是在类定义中，并且定义出现在命名空间范围内，就像类成员的任何其他类外定义一样。成员名由类名限定，所以明确表示为类的成员并且初始化表达式实际上被认为是在类的范围内（至少在C++11；我没有C+ +98/03 标准在这里可用）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-01T23:17:30.497

你必须反过来看。基本上，静态数据成员必须在源文件中的类定义之外定义和初始化。有一个例外，`static const int`因为它避免了定义成员数组大小的各种丑陋的变通方法。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-01T21:46:55.600

每次实例化类时，它们都会重新初始化。每次创建 Foo 类型的新对象时，所有 Foo 的静态变量都会重置为其初始值，这可能不是您想要的。因此，如果您想在对象中使用静态变量，它们要么 a) 无法更改其值，这意味着将它们重新初始化为相同的值是安全的，或者 b) 只能在初始化函数的上下文之外进行更改。

# python - Python & Maya：命名空间

> ID：15167256
> 
> 赞同：0
> 
> 时间：2013-03-01T21:34:27.817
> 
> 标签：python, maya

我一直在谷歌上搜索如何处理 Maya 中的命名空间，所有结果都是关于如何删除它们的。我不想删除它们。

我将我的角色引用到场景中，我需要在特定定位器上运行脚本，但由于被引用，它们都有命名空间。

例如：`shldr = cmds.xform('L_shldrFK_match_LOC', ws = True, t = True, q = True)`

这将获得世界空间中定位器的翻译值，这就是我想要的。但由于命名空间，它无法找到定位器。

如何让它忽略代码中的命名空间，但将它们保留在 Maya 中？

另一件很好的事情是让代码识别是否没有名称空间（例如，场景没有被引用）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-10-18T14:02:36.287

解决此问题的另一种方法是跳过字符串命名的依赖关系，`UUID`而是采用检索节点 via。请`cmds.ls`与[此处](http://help.autodesk.com/cloudhelp/2017/ENU/Maya-Tech-Docs/CommandsPython/ls.html)`-uuid`找到的标志一起查看。

命名空间实际上只是附加到对象名称上的字符串名称前缀。只要命名空间存在，您就可以重命名对象以在命名空间中添加/删除它。例如：

```
import maya.cmds as cmds

loc = cmds.spaceLocator()
cmds.ls(loc)[0]  # Result: u'locator1' # 

cmds.namespace(add='foobar')  # Result: u'foobar' # 
loc = cmds.rename(loc, ':foobar:{}'.format(loc))  # Result: u'foobar:my_locator' #

cmds.rename(loc, ':my_locator')  # Result: u'my_locator' # 
```

背后的想法`UUID`是节点被标记为一个特殊的字符串属性，该属性对节点来说是唯一的，并且在重命名节点时不会改变。例如，请注意名称发生了变化，而 UUID 保持不变：

```
import maya.cmds as cmds

loc = cmds.spaceLocator()
cmds.ls(loc, uuid=True)[0]  # u'60446AC7-4398-E3CB-4C27-6BA417626E41' # 
cmds.ls(loc)[0]  # Result: u'locator1' # 

loc = cmds.rename(loc, 'my_locator')
cmds.ls(loc, uuid=True)[0]  # Result: u'60446AC7-4398-E3CB-4C27-6BA417626E41' #
cmds.ls(loc)[0]  # Result: u'my_locator' # 
```

有了这些信息，我们现在知道一个节点在`UUID`其整个生命周期内将始终具有相同的、不变的，无论它（通过命名）移入/移出哪个命名空间。

综上所述，以下是我们如何`ls`结合使用该命令`uuid`：

```
# Query the UUID of our locator
cmds.ls(loc, uuid=True)[0]  # Result: u'60446AC7-4398-E3CB-4C27-6BA417626E41' #

# Retrieve the locator name string via UUID
cmds.ls(u'60446AC7-4398-E3CB-4C27-6BA417626E41')[0]  # Result: u'my_locator' # 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:21:38.210

您可以使用`cmds.namespaceInfo`

该命令可以列出所有可用的命名空间及其包含的对象。

在此处阅读更多信息：[namespaceInfo](http://download.autodesk.com/global/docs/maya2013/en_us/CommandsPython/namespaceInfo.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-29T02:00:12.427

当我编码类似的东西时，我通常使用一个星号来表示命名空间是这样的。

```
shldr = cmds.xform('*:L_shldrFK_match_LOC', ws = True, t = True, q = True) 
```

这取决于您是否要在场景中的其他名称空间下使用相同名称的其他东西，因为那样它就行不通了

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-06T13:28:46.823

我们需要一个包含所有名称空间的列表来找到正确的名称：

```
namespaces = cmds.namespaceInfo(lon=True)
current_namespace = cmds.namespaceInfo(currentNamespace=True)
references = cmds.ls(type="reference") 
```

您可以使用此信息，但忽略命名空间并不是很好，因为引用的主要功能是让环境/角色/道具资产与场景中的最后一次更新相乘...所以

```
shldr = cmds.xform('*:L_shldrFK_match_LOC', ws = True, t = True, q = True) 
```

仅当您的场景中只有一个角色时才有效。

# xcode - 滚动视图中的活动按钮

> ID：15167257
> 
> 赞同：0
> 
> 时间：2013-03-01T21:34:28.847
> 
> 标签：xcode, button, scrollview, tableview

我有一个源代码，其中主屏幕有 10 个按钮（图像按钮），每个按钮都通过 tableview 项目链接到 sql 数据库，在 XIB 中我选择每个按钮的标签，1、2、3、4..

我想让这些按钮滚动，怎么做？

我试图将视图转换为滚动视图，然后我删除了图像，并在滚动视图中创建了按钮，但现在我不知道如何将每个按钮链接到它在 tableview 中的标签？

以下是我使用的：

@实现主视图控制器；

@合成大师；@synthesize 模型；

*   (void)viewWillAppear:(BOOL)动画{

    UIScrollView *scrollview=[[UIScrollView alloc]initWithFrame:CGRectMake(0,0,320,480)]; scrollview.showsVerticalScrollIndicator=YES; scrollview.scrollEnabled=YES; scrollview.userInteractionEnabled=YES；[self.view addSubview:scrollview]; scrollview.contentSize = CGSizeMake(320,960);//你可以用你的要求来编辑它 scrollview.pagingEnabled=YES;

    UIButton *button = [UIButton buttonWithType:UIButtonTypeRoundedRect]; [按钮 addTarget:self action:@selector(aMethod:) forControlEvents:UIControlEventTouchDown]; [button setTitle:@"Show View" forState:UIControlStateNormal]; button.frame = CGRectMake(80.0, 210.0, 160.0, 40.0);

    UIImageView* imageview1 =[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"c1@2x.png"]]; imageview1.frame=CGRectMake(18.0, 18, 285,50); [scrollview addSubview:imageview1];

    UIImageView* imageview2 =[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"c2@2x.png"]]; imageview2.frame=CGRectMake(18.0, 78, 285,50); [scrollview addSubview:imageview2];

    UIImageView* imageview3 =[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"c3@2x.png"]]; imageview3.frame=CGRectMake(18.0, 138, 285,50); [scrollview addSubview:imageview3];

    UIImageView* imageview4 =[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"c4@2x.png"]]; imageview4.frame=CGRectMake(18.0, 198, 285,50); [scrollview addSubview:imageview4];

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-15T11:01:27.933

创建按钮时为其分配标签：

```
[buttonName setTag:1];
[buttonName addTarget:self action:@selector(aMethod:) forControlEvents:UIControlEventTouchDown]; 
```

然后使用：

```
-(void)aMethod:(UIButton *)button {
 if ([button tag] == 1) {
  ...do something...
 }
} 
```

希望这可以帮助。

# php - PHP - 如何使用一种方法从数据库中“解析数据”

> ID：15167263
> 
> 赞同：0
> 
> 时间：2013-03-01T21:34:48.650
> 
> 标签：php

我尝试了几种不同的方法来使这项工作无济于事。

基本上，我有这 4 行有很多功能：

```
function getID($URL){
  //These 3 plus this comment line
    $parentQ = "select * from cdi_content where URL=\"$URL\"";
    $parentResult = mysql_query($parentQ); // Run the Query
    $link = mysql_fetch_assoc($parentResult); // Query Result
...continues... 
```

这基本上告诉数据库检查 $URL，如果它与数据库中的 URL 字符串匹配，它会抓取与该 URL 关联的所有数据，然后我会抓取我需要的东西

```
$link['ID']; 
```

这会给我与 $URL URL 关联的 ID。

该函数检查打印“覆盖”变量 ($ID)、默认变量 ($defaultID) 或从服务器中提取 ($link['ID']) 的条件列表，如下所示。“覆盖”是当前由全局 $ID 调用的函数之外的变量。

```
$ID = ''; //Overrides if set
function parseData($URL){
  //Initialize Query for Table Data
    $parentQ = "select * from cdi_content where URL=\"$URL\"";
    $parentResult = mysql_query($parentQ); // Run the Query
      return mysql_fetch_assoc($parentResult); // Query Result  
};
function getID($URL){
  global $ID;
  $serverID = parseData($URL);
    if(empty($ID)){
      if(empty($serverID)){
        echo $defaultID; 
      } else { echo $serverID['ID']; }
    }//end of ifs
    else 
      { echo $ID; } 
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:41:24.270

如果我对您的理解正确，那么您只是在尝试重构该功能，因此您不必继续重写它。那是对的吗？

如果是这样，您可以像这样提取一个新函数：

```
function getLink($URL){
    $parentQ = "select * from cdi_content where URL=\"$URL\"";
    $parentResult = mysql_query($parentQ); // Run the Query
    return mysql_fetch_assoc($parentResult);
} 
```

然后这样称呼它：

```
function getID($URL){
    $link = getLink($URL);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:26:20.170

因此，您要解析需要搜索条件的数据行`$criterion`和您希望它返回的字段：

```
function getField($criterion, $returnField){
    $parentQ = "select * from cdi_content where URL='".$criterion."' LIMIT 1"; // also make sure you  that $criterion is safe to use in a query
    $parentResult = mysql_query($parentQ); // Run the Query
    if ($parentResult)
    {
        $row = mysql_fetch_assoc($parentResult);
        return $row[$returnField];
    }
    else
    {
        return FALSE;
    }
} 
```

现在你可以调用它：

`$linkId = getField($url, 'ID');`

# css - 您如何在 Chrome 上使用缩放级别制作“em”比例？

> ID：15167264
> 
> 赞同：1
> 
> 时间：2013-03-01T21:34:56.633
> 
> 标签：css, google-chrome, firefox

在 Firefox 中，如果我通过点击`CTRL +`所有内容进行放大，所有内容都会按预期按比例增长。但是，在 Chrome 上，只有在`px`增长中指定的测量值。中指定的测量值`em`不会增长。我如何让 Chrome 的缩放行为像 Firefox 一样？

**任一浏览器上的原始缩放级别：**

![在此处输入图像描述](../Images/4c0f697753607f40b63b7357cd498622.png)

**在 Firefox 上放大：**

![在此处输入图像描述](../Images/1df25dce618c772cedc95bb9a0bcfa3d.png)

**在 Chrome 上放大：**

![在此处输入图像描述](../Images/7a3ca0e133a94a365d2e0311f4404ebd.png)

这是上面显示的文本的 CSS 示例。`em`我混合的原因`px`是因为我想缩放结构的东西（用 em 定义）而不缩放审美的东西（用 px 定义）。例如，如果我需要在另一个页面上使用两倍大小的 Facebook 按钮，我只需将包含元素设置为`font-size:2.0em`. 这会将所有结构尺寸乘以 2，同时保持美学尺寸不变。

```
h1 {
    font-size: 2em;
    text-shadow: 0 -1px solid rgba(0,0,0,0.5);
} 
```

# java - 在java中绘制圆的切片？

> ID：15167276
> 
> 赞同：5
> 
> 时间：2013-03-01T21:36:23.277
> 
> 标签：java, graphics, graphics2d

我想通过一个实心圆来表示一个计时器，该圆在计时器的整个过程中按段完全绘制。即，如果圆圈每 1 秒填充一次，持续 4 秒的计时器，第一个将显示四分之一圈，然后是一半，然后是四分之三，最后是一个完整的圆圈。

有没有办法在java中绘制这些圆片？我已经查看了图形 API 中的任意形状，但不确定这是否是正确的方法，或者是否有一些东西写入语言可以轻松生成这些类型的形状？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-01T23:04:13.697

是的，这是可能的。是的，Graphics2D 有能力为您做到这一点

查看[Drawing Geometric Primitives](http://docs.oracle.com/javase/tutorial/2d/geometry/primitives.html)（查找 Arc2D 部分）。

要“动画化”进度，使用 a 可能是最简单的`javax.swing.Timer`，但您的要求可能需要您使用 a`SwingWorker`代替。有关更多信息，请查看[Swing 中的货币](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)和[如何使用 Swing 计时器](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)。

下面的例子比较简单。它假定进度为 0-100%，并根据需要生成弧线。`Graphics2D`如果需要，只需更改上下文的颜色并使用`draw(Shape)`它来绘制圆的轮廓线，这将是一件简单的事情。

![在此处输入图像描述](../Images/0c3c6323be2e0a1148521799c4b055f6.png)

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.FlowLayout;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Insets;
import java.awt.RenderingHints;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.geom.Arc2D;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.Timer;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class ArcProgress {

    public static void main(String[] args) {
        new ArcProgress();
    }
    private float progress;

    public ArcProgress() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                final ArcProgressPane p1 = new ArcProgressPane();
                p1.setForeground(Color.RED);
                final ArcProgressPane p2 = new ArcProgressPane();
                p2.setForeground(Color.BLUE);
                p2.setFillProgress(true);

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new FlowLayout());
                frame.add(p1);
                frame.add(p2);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);

                Timer timer = new Timer(40, new ActionListener() {
                    @Override
                    public void actionPerformed(ActionEvent e) {
                        progress += 0.01f;
                        if (progress >= 1f) {
                            progress = 1f;
                            ((Timer) e.getSource()).stop();
                        }
                        p1.setProgress(progress);
                        p2.setProgress(progress);
                    }
                });
                timer.setRepeats(true);
                timer.setCoalesce(true);
                timer.start();

            }
        });
    }

    public class ArcProgressPane extends JPanel {

        private boolean fillProgress = false;
        private float progress;

        public ArcProgressPane() {
        }

        public void setFillProgress(boolean value) {
            if (fillProgress != value) {
                this.fillProgress = value;
                firePropertyChange("fillProgress", !fillProgress, fillProgress);
            }
        }

        public boolean isFillProgress() {
            return fillProgress;
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(100, 100);
        }

        public void setProgress(float value) {
            if (progress != value) {
                float old = progress;
                this.progress = value;
                firePropertyChange("progress", old, progress);
                repaint();
            }
        }

        public float getProgress() {
            return progress;
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            Graphics2D g2d = (Graphics2D) g.create();
            g2d.setRenderingHint(RenderingHints.KEY_ALPHA_INTERPOLATION, RenderingHints.VALUE_ALPHA_INTERPOLATION_QUALITY);
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            g2d.setRenderingHint(RenderingHints.KEY_COLOR_RENDERING, RenderingHints.VALUE_COLOR_RENDER_QUALITY);
            g2d.setRenderingHint(RenderingHints.KEY_DITHERING, RenderingHints.VALUE_DITHER_ENABLE);
            g2d.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS, RenderingHints.VALUE_FRACTIONALMETRICS_ON);
            g2d.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
            g2d.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
            g2d.setRenderingHint(RenderingHints.KEY_STROKE_CONTROL, RenderingHints.VALUE_STROKE_PURE);

            Insets insets = getInsets();
            int width = getWidth() - (insets.left + insets.right);
            int height = getHeight() - (insets.bottom + insets.top);
            int raidus = Math.min(width, height);
            int x = insets.left + ((width - raidus) / 2);
            int y = insets.right + ((height - raidus) / 2);

            double extent = 360d * progress;

            g2d.setColor(getForeground());
            Arc2D arc = null;
            if (isFillProgress()) {
                arc = new Arc2D.Double(x, y, raidus, raidus, 90, -extent, Arc2D.PIE);
            } else {
                extent = 360 - extent;
                arc = new Arc2D.Double(x, y, raidus, raidus, 90, extent, Arc2D.PIE);
            }
            g2d.fill(arc);
            g2d.dispose();
        }
    }
} 
```

# xcode - 如何将 Cocos2d 和 Box2d 添加到现有的 Xcode 4.6 项目中

> ID：15167277
> 
> 赞同：0
> 
> 时间：2013-03-01T21:36:33.697
> 
> 标签：xcode, cocos2d-iphone, box2d-iphone

我在这方面能找到的所有说明/教程都不起作用，因为 Xcode 在每个版本中都会更改构建设置等。有人在 Xcode 4.6 中做过这个吗？我有一个项目需要一些 Cocos2d 视图。我还需要Box2d。

这是我所做的。

- 基于 Cocos2d with Box2d 模板创建一个新项目。关闭此项目。

- 在 Finder 中导航到新应用的 cocos2d 项目文件夹。在 cocos2d 项目文件夹中找到名为 libs 的子文件夹。将 libs 文件夹拖到我当前的项目中。

- 添加所有必要的库

起初它找不到kazmath.h。我修好了。然后它找不到 Box2d 碰撞类。解决了这个问题。现在我在 CCActionCamera 中遇到错误（ARC 禁止自动释放）：

```
@implementation CCOrbitCamera
+(id) actionWithDuration:(float)t radius:(float)r deltaRadius:(float) dr angleZ:(float)z deltaAngleZ:(float)dz angleX:(float)x deltaAngleX:(float)dx
{
    return [[[self alloc] initWithDuration:t radius:r deltaRadius:dr angleZ:z deltaAngleZ:dz angleX:x deltaAngleX:dx] autorelease];
} 
```

我觉得这将是一个无穷无尽的错误列表。我只是希望有一种方法可以在项目中简单地使用 Cocos2d。

编辑#2：将`-fno-objc-arc`标志添加到所有 Cocos2d 文件后：

```
Undefined symbols for architecture armv7s:
  "_ExtAudioFileSetProperty", referenced from:
      _CDloadCafAudioData in CDOpenALSupport.o
  "_ExtAudioFileRead", referenced from:
      _CDloadCafAudioData in CDOpenALSupport.o
  "_AudioFileReadBytes", referenced from:
      _CDloadWaveAudioData in CDOpenALSupport.o
  "_ExtAudioFileDispose", referenced from:
      _CDloadCafAudioData in CDOpenALSupport.o
  "_AudioFileOpenURL", referenced from:
      _CDloadWaveAudioData in CDOpenALSupport.o
  "_AudioFileGetProperty", referenced from:
      _CDloadWaveAudioData in CDOpenALSupport.o
  "_ExtAudioFileGetProperty", referenced from:
      _CDloadCafAudioData in CDOpenALSupport.o
  "_AudioFileClose", referenced from:
      _CDloadWaveAudioData in CDOpenALSupport.o
  "_ExtAudioFileOpenURL", referenced from:
      _CDloadCafAudioData in CDOpenALSupport.o
  "_AudioSessionGetProperty", referenced from:
      -[CDAudioManager isOtherAudioPlaying] in CDAudioManager.o
      -[CDAudioManager isDeviceMuted] in CDAudioManager.o
ld: symbol(s) not found for architecture armv7s
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:45:32.307

让我们只关注您当前的错误，**ARC 禁止 autorelease**。Cocos2d 使用手动引用计数，所以你必须在没有 ARC（自动引用计数）的情况下编译 cocos2d：

转到您的项目设置，单击您的目标，转到**Build Phases**，展开**Compile Sources**并选择所有 cocos2d 文件（以“CC”开头的文件）。按回车，出现一个文本框，输入`-fno-objc-arc`. 这告诉编译器不要对这些文件使用 ARC。现在希望这是最后一个错误并点击编译。

# nsdictionary - 在standardUserDefaults 中设置的多个字符串为第二个、第三个条目检索null？

> ID：15167280
> 
> 赞同：0
> 
> 时间：2013-03-01T21:36:44.747
> 
> 标签：nsdictionary, nsuserdefaults, preferences

我在我的应用程序中将一些首选项设置为字符串：@"YES" 和 @"OFF" 用于 @"Active" 和 @"Enabled"，尝试在启动时设置它们

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions" 
```

作为

```
NSDictionary *udd = [NSDictionary dictionaryWithObject:@"YES" forKey:@"Active"];
                    [NSDictionary dictionaryWithObject:@"OFF" forKey:@"Enabled"];
[[NSUserDefaults standardUserDefaults] registerDefaults:udd]; 
```

但我只能看到返回的第一个字符串，即“YES”

```
NSLog(@"%@",[udd objectForKey:@"Active"]); 
```

不是

```
NSLog(@"%@",[udd objectForKey:@"Enabled"]); 
```

它返回一个“null”。

我有点卡住了如何根据我的喜好向 udd 添加更多字符串？有人可以建议吗？提前谢谢了。乔恩。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:39:23.150

x = y; z; 不是您想要的（它不会设置 x 两次，并且绝对不会将 x 设置为某种组合值）。你可能会制作一个字典并设置它，而不是两个字典然后扔掉第二个。

# php - ajax（jquery post）目的的成功和失败标准

> ID：15167281
> 
> 赞同：9
> 
> 时间：2013-03-01T21:36:47.870
> 
> 标签：php, ajax

我一直在网上（显然是在错误的地方）寻找ajax（jquery post）目的的成功和失败标准。

例如，假设我正在使用 ajax 发布到 php 脚本。该脚本可以返回：

*   出口 0
*   1号出口
*   杰森数组
*   返回
*   ETC...

这些返回值何时转化为成功，何时转化为失败？

您可能已经知道 $.ajax() 支持 beforeSend、success、error 和 complete 回调。

那么我的脚本在成功和失败的情况下应该发送什么来触发适当的回调。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T22:02:41.420

本是对的，但我会扩大一点。

jQuery 根据被调用页面的 HTTP 响应代码确定成功或失败。请注意，这*与*发回的响应中的*内容不同。*

例如，假设您的 PHP 脚本位于[http://url.com/script.php](http://url.com/script.php)

当用户点击该站点时，他们将从服务器获得响应。该响应可以是 JSON 对象，也可以是 HTML 页面，也可以是空响应。*在所有这些情况下*，响应代码都可能是 200。200 响应代码意味着服务器理解请求，接受它，然后发回一些东西。

现在假设用户尝试点击[http://url.com/notascript.php](http://url.com/notascript.php)

服务器不知道如何处理它（假设它`notascript.php`实际上不存在）。它使请求失败，并发送回响应——可能带有响应代码 404（或 4xx 范围内的其他内容）。

因此，如果您知道实际的 URL，那么 jQuery 的错误处理程序是如何被调用的呢？

好吧，假设您的 AJAX 调用正在尝试加载博客文章，并尝试进行如下调用：`http://url.com/post?id=5`. 如果您的 PHP 脚本确定没有 ID 为 5 的博客条目，那么您可能不应该发回成功的响应。相反，4xx 响应会更合适。PHP为此提供了一个内置函数：

```
<?php

http_response_code(404);

?> 
```

现在，响应将被 jQuery 读取为失败，并调用错误处理程序。

进一步阅读：

[http_response_code() 函数](http://php.net/manual/en/function.http-response-code.php)

[RFC2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)，它定义了 HTTP 响应代码

[休息](http://en.wikipedia.org/wiki/Representational_state_transfer)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T21:44:15.923

我相信它基于标头代码（即 200 - 成功）。您可以发回您自己的特殊错误，例如[如何在 jQuery AJAX 响应中接收错误？](https://stackoverflow.com/questions/6566972/how-to-receive-error-in-jquery-ajax-response)

如果请求页面中的代码有问题，则不应出现 Ajax 错误。就 Ajax 而言，只要页面在物理上被成功请求，它就可以正常执行。所请求页面中的任何错误都不是 Ajax 的错误，因此应在成功加载该页面*后由您的代码处理。*使用上面链接中的自定义标题将使您更容易做到这一点。

> Ajax 请求页面 --> 页面加载且没有错误 --> 页面请求成功 --> 您执行结果错误检查

对比

> Ajax 请求页面 --> 页面加载并有错误 --> 页面请求成功 --> 您执行结果错误检查

如您所见，所请求的页面是否有错误无关紧要，这不是 Ajax 错误，因此不应视为错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T21:55:11.043

您可以选择一种始终打印成功的模式，其他情况（如 ajax 失败）可以通过 AJAX 本身（HTTP 响应代码）知道：例如：

```
You always print: yes for success and if correct result found

You always print: no for success and if incorrect result found 
```

如果以上都没有返回，那么它的 ajax 失败或者脚本打印了另一个单词，那么你需要检查你的 PHP。

# matlab - 关于FIRPMORD函数---fir滤波器设计相关

> ID：15167286
> 
> 赞同：0
> 
> 时间：2013-03-01T21:36:53.940
> 
> 标签：matlab

我遇到了一个关于 matlab 函数的小问题`FIRPMORD`。因为这个特定函数的输出并不真正符合规范，所以我可以手动将这个结果的顺序加 5 吗？我知道我们可以将奇数加 1 或 2，但我只是不太确定我们是否真的可以将其增加超过 2...

非常感谢！！！期待你的回复！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:39:58.560

我也有同样的问题，你可以看我的发帖地址。通常，添加 1 或 2 将符合规范，如 firpmord.m 所述。

# c++ - C++：如何制作一个简单的字典？

> ID：15167291
> 
> 赞同：2
> 
> 时间：2013-03-01T21:37:09.323
> 
> 标签：c++, dictionary

我正在尝试用 2 个字符的单词制作字典，但不太成功这是我的代码：

```
#include <cstdlib>
#include <iostream>
#include <map>
using namespace std;

int main(int argc, char *argv[]){
    map<char*,int> m;
    //input 5 two-lengthed words 
    for (int i=0;i<5;i++){
        char s[3];
        cin>>s;
        s[2] = '\0';
        m[s]=1; //add a key
    }
    //checking if a word exists.

    cout<<"Word you want to check whether it exists:"<<endl;
    char chck[3];
    cin>>chck;
    chck[2]='\0';
    //I heard this is how you check whether a key exists:
    bool exists = m.find(chck)==m.end(); 
    cout<<((exists)?"Yes!":"No.")<<endl;
    system("pause"); //Yea, system, I know.
    return 0;
} 
```

每当我输入单词，然后当我想检查一个单词是否在字典中时，我总是打印“No.”？
我来自**Java**，所以我习惯了引用，而不是指针，所以这就是我可能错的地方。我想学习如何正确使用地图，请问我应该在这里做什么？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T21:39:42.040

```
//I heard this is how you check whether a key exists:
bool exists = m.find(chck)==m.end(); 
```

是的，但如果元素*不*存在，则条件为真。你应该调用你的 vaviable `notExists`：

```
bool notExists = m.find(chck)==m.end(); 
```

现在，如果您只想检查作品是否存在，您可以使用`std::set<std::string>`. 如果你想让这个词成为其他事物的关键，那么你需要`std::map<std::string, SomeThingElse>`.

忘记那些`char*`。使用`std::string`s。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T21:53:12.220

```
 m[s]=1; //add a key 
```

每次您“添加一个键”时，您实际上只是获得相同的元素，具有相同的键。键是数组的地址`s`，**而不是**输入的字符串的值。

尝试打印出容器的大小，您将看到一个元素：

```
 std::cout << m.size() << '\n'; 
```

当您将 a`char*`放入容器中并使用默认比较函数时，它们仅在它们是相同指针而不是相同字符串时才比较相等：

```
 char s1[] = "foo";
 char s2[] = "foo";
 assert( s1 == s2 );   // FAILS! 
```

要将字符串值推送到容器中，请使用`std::string`键，而不是`char*`

```
std::string s1 = "foo";
std::string s2 = "foo";
assert( s1 == s2 );   // passes 
```

这避免了比较指针和数组超出范围而在映射中留下悬空指针的整个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-01T21:53:38.390

让我们看一下您的代码：

你有一个`std::map<char *, int>`. 第一个“char *”作为地图的关键是可疑的。将指针存储为键通常不是您真正想要做的。但我们继续阅读。在您的循环内，您有一个要填充的本地数组 s。然后使用该变量索引到地图中。请记住，映射的键是 char*。数组 s 的地址可能在每次循环迭代中都相同。因此，您可能只将一个项目放入您的地图中，并且它仅包含您放入 s 中的最新值。但是等等，情况会变得更糟。一旦你的循环完成， s 就会超出范围，现在取消引用当前存储在映射中的指针是未定义的行为（作为该映射中唯一元素的键。输出 m.size() 到核实）。

将您的地图重新定义`std::map<std::string, int>`为不存在所有这些问题。

# jakarta-ee - 在重新部署期间将 Web 应用程序请求自动重定向到不同的 JBoss 实例

> ID：15167293
> 
> 赞同：0
> 
> 时间：2013-03-01T21:37:26.267
> 
> 标签：jakarta-ee, web-applications, deployment, jboss, failover

我试图解决的一般问题是：“**如何在升级到新版本期间不让用户停止使用应用程序的情况下重新部署 Web 应用程序**”。我想出了以下解决方案的假设场景：

1.  Web 应用程序的生产环境具有已配置的 Web 服务器（IIS 或可能是 Apache），并将运行 2 个相同配置的 JBoss 实例。

2.  首先，Web 服务器将所有请求重定向到一个 JBoss 实例，运行当前版本的 Web 应用程序。

3.  新版本的 Web 应用程序已准备好部署到生产环境。

4.  我们将新版本部署到 JBoss 的第二个实例（而第一个实例仍在运行旧版本的 Web 应用程序）

5.  然后，我们以某种方式配置 Web 服务器以将所有新的 HTTP 会话重定向到具有新版本 Web 应用程序的第二个 JBoss 实例。

6.  当前活动会话仍被重定向到“旧”JBoss 实例，直到用户注销或会话到期。

7.  对于另一个版本的重新部署，我们遵循相同的过程（但部署到第一个实例，同时保持第二个运行旧版本）。

目前我不知道这种情况是否有意义，我对该主题的谷歌搜索总是以 JBoss 集群配置结束，在我看来，这在这种情况下是一个过冲，因为我们不需要集群 HA 解决方案（在至少现在），编写应用程序时也没有考虑任何集群支持，这可能是一个真正的问题。

请给我一些关于这个话题的提示。如果有人解决了类似的问题，我也将不胜感激。关于我是否在此描述中遗漏了什么的任何建议也是可取的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:29:25.077

首先，您要求的是 HA 场景——应用程序升级期间的高可用性。您提供的步骤实际上看起来不错。看来你已经花了很多心思了。但关键是如何进行第 5 步和第 6 步。

我不知道是否有任何 Web 服务器能够满足您的要求，但 F5 之类的负载均衡器应该可以解决问题。在负载均衡器中，您可以配置一个服务器池。假设一开始池中只有一台服务器（服务器 1）为请求提供服务。然后将服务器 2 添加到池中。服务器 2 应与升级应用程序一起部署。然后您指示负载均衡器不要向服务器 1 发送新请求，而是与所有现有用户保持连接。所有新请求都转到服务器 2。在服务器 1 上完成所有旧会话后，将其从池中取出。

# json - Laravel 4 和 Backbone：JSON 未发布到控制器

> ID：15167295
> 
> 赞同：0
> 
> 时间：2013-03-01T21:37:31.153
> 
> 标签：json, backbone.js, laravel, laravel-4

我在 Laravel 4 中没有将 JSON 发布到控制器时遇到问题。这是我的 Backbone 事件中的 AJAX 调用：

```
u = $('#username').val();
p = $('#password').val();

formData = {username: u, password: p};
console.log(formData);
$.ajax({
    type: 'POST',
    url: '/leads/public/login',
    data: formData,
    success: function(data) {
        console.log(data);
    },
    dataType: 'json'
}); 
```

如您所见，有一个`console.log`并且它正确记录了我的 JSON 对象。此外，在 Firebug 中，我可以看到正在发布数据。但是在我的 Laravel 控制器中，我没有返回 JSON。

我可以从控制器中的方法返回一个文本字符串`store`，但不能`Input::json()`。事实上，当我这样做时，服务器根本没有响应。我觉得也许我应该更多地以 Backbone 方式来做这件事，而不是 AJAX jQuery 调用。那是我的问题出现的地方吗？

我有这条 Laravel 路线：

```
Route::post('login', 'LoginController@store'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T13:25:54.360

路线应该是

```
Route::post('/leads/public/login', 'LoginController@store'); 
```

因为你发帖到`url: '/leads/public/login'`？

# php - 用 JSON 编码一个数组；得到“非法偏移类型”错误

> ID：15167299
> 
> 赞同：2
> 
> 时间：2013-03-01T21:37:58.813
> 
> 标签：php

我正在尝试在 jquery 中使用 getJSON 方法来检索动态数组。我在尝试对动态数组进行编码时遇到“非法”偏移错误。这是服务器端代码（我相信 javascript 是正确的，因为当我删除查询时它运行良好）：

```
<?php 
session_start();
require_once "database.php";
db_connect();
require_once "auth.php";
$current_user = current_user();
include_once("config.php");

$westcoast_id = $_GET['westcoast_id'];

$westcoast_array = array();

 $query = "SELECT city, state FROM users GROUP BY city";
 $result = mysql_query($query) or die(mysql_error());
 while($row = mysql_fetch_array($result)){

if($row['city'] != '' && $row['state'] != '') {
    $westcoast_array[$row] = "location:".$row['city'].", ".$row['state'].", stopover:true";

   }

}

$data = array($westcoast_id, $westcoast_array);

echo json_encode($data);

?> 
```

非法偏移量参考以下行：

```
$westcoast_array[$row] = "location:".$row['city'].", ".$row['state'].", stopover:true"; 
```

我看不出问题是什么。感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:39:14.237

```
 $westcoast_array[$row] = [...] 
```

是错的。（您不能使用数组作为键）

只需使用：

```
$westcoast_array[] = [...] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:45:10.847

尝试使用：

```
if($row['city'] != '' && $row['state'] != '') {
    $westcoast_array[] = "location:".$row['city'].", ".$row['state'].", stopover:true";
} 
```

或者

```
if($row['city'] != '' && $row['state'] != '') {
    $westcoast_array[$row['state']][$row['city']] = "location:".$row['city'].", ".$row['state'].", stopover:true";
} 
```

然后你可以用它`var_dump($westcoast_array)`来查看结构。

# c# - C# - 等到计时器的第一个滴答声 (Visual Studio)

> ID：15167300
> 
> 赞同：0
> 
> 时间：2013-03-01T21:38:08.187
> 
> 标签：c#, timer, wait

我正在创建一个应用程序，当您单击一个按钮时，它会等待 10 秒并通过 SendKeys 执行某个击键。问题是 - 它需要让用户在窗口中移动他的鼠标指针（例如在网络浏览器中选择一个文本框）。所以，当我尝试

```
System.Threading.Thread.Sleep(10000); 
```

它对我不起作用，因为它冻结了整个 GUI，用户无法轻松地做任何事情。所以，有TIMER。我需要设置它（让我们称之为 timer1）让用户等待 10 秒，每隔几秒使用按键组合启用 timer2 并禁用 timer1（本身）。所有这些都无需冻结 GUI。当我在 Visual Studio 中设置计时器间隔时，它似乎完全忽略了，它甚至没有立即激活，而是在 +- 50 毫秒后激活。

有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:43:59.817

您可以在 buttonClick 事件中使用*任务延续*

```
Task.Delay(10000)
    .ContinueWith(_ => YourMethod(), 
               TaskScheduler.FromCurrentSynchronizationContext()); 
```

或者

```
private async void button1_Click(object sender, EventArgs e)
{
     await Task.Delay(10000);
     YourMethod();
} 
```

# jquery - 哪个事件是浏览器表单元素的选择？

> ID：15167308
> 
> 赞同：1
> 
> 时间：2013-03-01T21:38:51.247
> 
> 标签：jquery

我正在使用 jQuery 1.7.2

我有一个用于收集电子邮件地址的表单元素。当浏览器看到这样一个非常常见的名称时，它会使用以前使用过的电子邮件地址预先填充该元素。像这样：

```
<input type='text' name='Email' id='Email'> 
```

我将元素放入一个变量中以备后用。像这样：

```
var $Email = $('#Email'); 
```

当通过键入或选择浏览器预填充选项更改此元素时，我想测试电子邮件地址。我目前正在监听这样的更改和键位事件：

```
$Email.change(doSomething);
$Email.keyup(doSomething); 
```

这一切都完美无缺。当用户单击表单元素并且浏览器下拉列表已使用的先前电子邮件地址并且用户选择其中一个电子邮件地址时，就会出现问题。

未触发更改事件，因为电子邮件仍具有焦点。由于用户尚未按下键，因此未触发 keyup。

当用户从浏览器预填表单中选择选项时会触发什么事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:44:28.287

`autofill='off'`另一种方法是通过添加到输入元素来禁用使用浏览器自动填充的功能。

当字段失去焦点时，您也可以更新它：`$Email.blur(doSomething);`

# javascript - 如何从类方法中获取触发器（源）元素 id？

> ID：15167317
> 
> 赞同：-1
> 
> 时间：2013-03-01T21:39:18.530
> 
> 标签：javascript, events

从触发函数的任何元素（如） onclick 事件中，我可以轻松获取 id

```
var target = event.target || event.srcElement; 
```

但我不知道如何在命名空间对象方法中获取它。我尝试如下，但抛出了一个 js 错误。

```
var evraklarPanel = {};
evraklarPanel.Formlar = {
    yeniEvrakTipiGrupAdiKayitForm: function(e){
        var target = event.target || event.srcElement;
    }   
} 
```

我得到一个`TypeError: Cannot read property 'target' of undefined`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T21:47:21.780

您收到错误的原因是：

您将`e`作为事件变量传递，但`event`在函数内部使用。

工作代码：

```
var evraklarPanel = {};
evraklarPanel.Formlar = {
    yeniEvrakTipiGrupAdiKayitForm: function(e){
        var target = e.target || e.srcElement;
    }   
} 
```

# android - OnHandleIntent 未在 Intent 服务中调用

> ID：15167320
> 
> 赞同：0
> 
> 时间：2013-03-01T21:39:29.013
> 
> 标签：android, android-service, intentservice

我有一个意图服务，我正在一个单独的进程中启动（我将它包含在清单中），并且该进程正在启动，但我在 OnHandleIntent 开头的日志从未被调用。我希望它在一个单独的进程中，因为它正在做一些繁重的工作并且需要它可以得到的所有内存。

这是服务代码：

```
public class ProcessingService extends IntentService {

private final String TAG = "Processing Service";

public ProcessingService() {
    super("ProcessingService");
}

@Override
protected void onHandleIntent(Intent intent) {

    Log.d(TAG, "On Handle started");

/../

}
} 
```

这是我开始的地方：

```
public void doneBtn(View v) {

    Log.d(TAG, "button pressed, starting service");
    Intent intent = new Intent(MyActivity.this, ProcessingService.class);
    startService(intent);
    finish();

} 
```

我还尝试使用应用程序上下文调用服务，结果相同。

当然在清单中，在应用程序范围内：

```
<service android:name=".myapp.task.ProcessingService" android:process=":myserviceprocess"/> 
```

按下按钮，创建流程并完成活动，但永远不会触发 onHandleIntent 的登录（并且没有完成任何其他工作）。将 Intent Service 放在单独的进程中是否有问题？我应该做一个常规服务然后产生一个异步任务还是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:10:50.897

相同的代码对我来说工作正常。我希望您尝试一些方法来调试此问题：-

*   尝试调试它。在你的服务类的 onHandleIntent() 中放置一个断点，看看控制是否到达那里。

*   在调用 startService() 后尝试删除 finish() 并查看它是否有效。

# amazon-s3 - 在 AWS 上托管用户上传视频的最佳方式

> ID：15167321
> 
> 赞同：5
> 
> 时间：2013-03-01T21:39:31.680
> 
> 标签：amazon-s3, amazon-cloudfront, amazon-ebs

所以我正在开发一个为用户上传视频的网站，所有的基础设施都在亚马逊上。我正在尝试找到一个好的工作解决方案，这就是我的想法

1.  有一个 EC2 Instant，它使用 PHP 处理文件上传到它的 EBS 卷
2.  将视频文件传输到 S3
3.  让 Amazon Elastic Transcoder 将视频文件从 S3 转换为适当的格式，并将它们存储回 S3
4.  使用 CloudFront 将转换后的视频文件提供给公众

首先，您对此有何看法？有没有更简单的方法可以达到相同或更好的效果？

其次我现在的主要问题是将文件传输到S3，我尝试过s3fs来做这件事，但是它在大文件传输上出现了各种奇怪的问题，这让我放弃了s3fs。

响应[最快/最好的方式在 S3 到 EC2 之间复制数据？](https://stackoverflow.com/questions/749178/fastest-best-way-copy-data-between-s3-to-ec2)有人建议使用 EBS 卷，但我不确定是否可以挂载 EBS，然后也可以访问 S3 上的相同数据。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T21:48:37.483

要将文件传输到 S3，由于您已经在使用 PHP 进行编码，因此您应该查看 Amazon 提供的 PHP 库以连接到他们的服务。使用基于文件系统的方法（将其安装到您的实例）并不是最好的方法，因为与 S3 的连接断开的频率比您希望的要高。我知道，我试过了。

但通常，您在实例上“捕获”文件然后将其推送到 S3 的方法是合理的。但是，您需要注意不要在数据库中保存对文件的引用，直到它到达 S3，否则，如果您选择在负载均衡器后面运行多个实例，您将遇到可伸缩性问题。

关于转码，Amazon Transcoding 服务很新，所以我没有经验，但我强烈推荐 Zencoder。顺便说一句，它在 AWS 上运行，速度快且便宜，并且按照您期望 AET 工作的方式进行：您给它一个 S3 文件，并告诉它在哪里编写转码变体、缩略图等。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-06T22:59:25.173

为此，您不需要 EBS。

您可以将上传的数据写入 EC2 临时驱动器，然后将其推送到 S3，也可以将数据直接流式传输到 S3。

如果您使用临时驱动器方法，如果您的 virt 死了，您可能会面临数据丢失的风险，但总体而言，更少移动部件的简单性可能是值得的。

将数据直接流式传输到 S3 是我会尝试做的。它消除了写入磁盘（无论是本地还是 EBS）的整个步骤，从而简化了您的应用程序。

如果我要设计这样的系统，它将是：

1.  项目清单
2.  Elastic Beanstalk 扩展前端
3.  由您的应用程序直接流式传输到 S3 的数据
4.  RDS 或 DynamoDB 表跟踪已完成和正在进行的内容。

# php - 从类上的函数中打印值

> ID：15167326
> 
> 赞同：-3
> 
> 时间：2013-03-01T21:39:45.830
> 
> 标签：php

我在名为 Bills 的类上有这个函数，调用它时返回三个值。

```
function GetCashierDetail ($UserID){
        $GetCashierID = "SELECT cashiers_CashierID,cashiers_Total,cashiers_Last_Total 
        FROM `cashiers` 
        WHERE `cashiers_CashierCloseDate` is null and `cashiers_Status`='0' 
        and `cashiers_Delete` = '0' and `cashiers_User` = '".$UserID."'";
        $objQueryCashierID = mysql_query($GetCashierID) or die ("Error Query [".$strSQL."]");
        $GetCashierIDResult = mysql_fetch_array($objQueryCashierID);
        $BillsCashierID = $GetCashierIDResult['cashiers_CashierID'];
        $CashierTotal=$GetCashierIDResult['cashiers_Total']; 
        $CashierLastTotal=$GetCashierIDResult['cashiers_Last_Total']; 
        $num=mysql_affected_rows();
        // Return Data
        return $cashier_data = array('cashierId'=>$BillsCashierID ,
                          'CashierTotal'=>$CashierTotal ,
                          'CashierLastTotal'=>$CashierLastTotal );                      

} 
```

现在当调用这个函数

```
$BillDraftSubmit = new Bills;
$BillDraftSubmit->GetCashierDetail(71); 
```

我需要像这样在变量上打印 $cashier_data

$ID = $BillsCashierID 以其他方式使用它。

我如何从类中读取此函数的值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:41:43.823

**如果它是一种方法**，您可以使用它：

```
$BillDraftSubmit = new Bills();
$data=$BillDraftSubmit->GetCashierDetail(71);
$id=$data["cashierId"]; 
```

小心，因为在你的问题中你有

```
$BillDraftSubmit = new Bills; 
```

代替

```
$BillDraftSubmit = new Bills(); 
```

**如果它不是一种方法**，你可以使用这个：

```
$data=GetCashierDetail(71);
$id=$data["cashierId"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:42:43.463

你的 $ID 应该有数组

利用

```
foreach($ID as $key => $val) {
 echo $val['cashierId'];
 ....
 } 
```

# asp.net - 在 asp.net 中设置 cookie.domain

> ID：15167331
> 
> 赞同：1
> 
> 时间：2013-03-01T21:40:13.307
> 
> 标签：asp.net

尝试在 asp.net 中的 cookie 中设置域，而我在 asp.net 中非常新手，所以想知道如何做到这一点。

这是我的代码

```
// Create cookie
var cookieData = new NameValueCollection();
cookieData["first_name"] = first_name;
cookieData["last_name"] = last_name;

var cookie = new CookieHeaderValue("UserInfo", cookieData);
cookie.Expires = DateTimeOffset.Now.AddDays(1);
//cookie.Domain = Request.RequestUri.Host;
cookie.Domain = "example.com";
cookie.Path = "/"; 
```

需要将 cookie 设置为适用于 srv1.example.com 和 srv2.example.com

当前通过 Visual Studio 运行并使用 Request.RequestURI.Host 将域作为 localhost 给我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:42:06.550

如果请求设置此 cookie 的 ASP.NET 页面`http://localhost`意味着您正在 Visual Studio 或本地 IIS 中运行您的应用程序，则您不能将该`domain`属性设置为不同于该属性的值。

但是，如果您将应用程序部署在不同的服务器上并从中访问它，`example.com`那么 cookie 的域属性将被正确设置。

# python - 替代 python 的 time.sleep()

> ID：15167334
> 
> 赞同：7
> 
> 时间：2013-03-01T21:40:37.013
> 
> 标签：python, matplotlib, timer, real-time

我正在执行实时数据处理+显示，我每 60 秒访问一次我们的数据库。我不想`time.sleep()`每 60 秒等待一次，因为它会取消我的控制权（即 REPL 访问变量，这不是必需的但很好）并冻结 matplotlib 图表。

有替代方案吗？理想情况下，最初将控制权交给用户，然后在 60 秒后拿走控制权，运行一些代码并更新绘图，然后将控制权交还给用户。（当我说控制时，我指的是 REPL 控制）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-01T21:43:26.320

如果您不需要取消用户控制，有一个非常简单的方法可以做到这一点：创建一个[`threading.Timer`](http://docs.python.org/2/library/threading.html#timer-objects).

你想做的是把函数的“延续”——也就是说，后面的所有东西`time.sleep`——移动到一个单独的函数`my_function`中，然后像这样安排它：

```
threading.Timer(60, my_function).start() 
```

并且在 结束时，它使用完全相同的代码行`my_function`安排一个新的。`Timer`

`Timer`是一个非常笨重的接口和实现，但它内置在标准库中。您可以在 ActiveState 和 PyPI 上的模块上找到提供更好类的配方，例如，在一个线程上运行多个计时器而不是每个计时器一个线程，让您安排重复调用，这样您就不必自己重新安排等等。但是对于每 60 秒运行一次的东西，我想你可能对`Timer`.

需要记住的一件事：如果后台作业需要处理用户在 REPL 中处理的任何相同数据，则可能会出现竞争条件。通常在交互式环境中（尤其是在 Python 中，多亏了 GIL），您可以让用户承担不引起任何竞争的责任。如果没有，您将需要某种同步。

要记住的另一件事：如果您尝试进行 GUI 工作，取决于您使用的 GUI（我相信`matplotlib`是可配置的，但默认为`tkinter`？），您可能无法从后台线程更新 GUI。

但无论如何，在这种情况下实际上有一个更好的解决方案。GUI 程序有一个在某个线程或其他线程中运行的事件循环，并且几乎每个设计的事件循环都有一种在该线程中调度计时器的方法。对于`tkinter`，如果您有`root`对象的句柄，只需调用`root.after(60000, my_function)`而不是`threading.Timer(60, my_function).start()`，它将在与 GUI 相同的线程上运行，并且不会浪费任何不必要的资源。

# box-api - 长轮询事件

> ID：15167340
> 
> 赞同：1
> 
> 时间：2013-03-01T21:40:59.353
> 
> 标签：box-api

我一直在尝试订阅事件长轮询端点。因此，首先我对 /events 进行了选项调用，并取回了实时服务器的 url。但是，我不禁注意到网址看起来像这样：http: [//2.realtime.services.box.net/subscribe ?channel=XXX&stream_type=all](http://2.realtime.services.box.net/subscribe?channel=XXX&stream_type=all)

上面的网址似乎暗示我应该直接继续尝试订阅跳过握手步骤的主题。实际上，如果我尝试在[http://2.realtime.services.box.net/](http://2.realtime.services.box.net/)上握手，我会得到一个 400 状态码。

我考虑过尝试直接订阅，但我也注意到该频道位于查询参数而不是路径参数，正如我所期望的那样。

你能澄清一下吗？如果这真的遵循彗星长轮询标准，还是其他原因，我尝试以不同的方式做到这一点？我应该尝试 WebSockets 吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T19:02:29.860

您应该能够对 OPTIONS 调用的响应中的 URL 进行 HTTP GET 调用。一旦事件可用，它将以新的更改响应。

不需要任何神奇的“订阅”或“websockets”请求。只需使用标准的 HTTP GET。

每次调用时，您都将打开一个 HTTP 连接，如果您的帐户发生任何事情，您将看到 {"message":"new_change"} JSON 有效负载流下管道。如果没有任何反应，您的连接将超时并关闭，否则您将收到 400 错误。

一旦您看到 {"message":"new_change"}，这就是您的信号，表明是时候从您收到的最新事件中使用 stream_position 访问 /events API了。

有许多类型的事件，您可以通过它们的“event_type”进行不同的解析。大多数事件类型中都有足够的信息，可以将它们作为增量或差异应用到事件适用的项目的现有副本上。每个事件都会有一个 stream_position 来指示它在时间流连续体中的位置。

查找 JSON 的“源”部分以查看对象。这些对象结构遵循我们 API 中所有其他 API 调用使用的所有相同结构。因此，当您看到 "type": "folder" 时，它将与您在 GET /folders/ID API 调用中获得的任何其他文件夹具有相同的结构

# java - 绘制多边形时出现 ArrayIndexOutOfBoundsException 错误

> ID：15167342
> 
> 赞同：1
> 
> 时间：2013-03-01T21:41:10.307
> 
> 标签：java, swing, polygon, java-2d

嗨，我在尝试绘制多边形时遇到了麻烦。首先，当我尝试使用 using`addPoint(int x, int y)`方法绘制多边形并一个一个地给出坐标时，没有问题，可以完美地绘制多边形。但是，如果我将坐标作为数组（x 坐标和 y 坐标的整数数组）给出，编译器会出错。如您所见，这是工作代码，

```
@Override
public void paint(Graphics g) {

    Graphics2D g2 = (Graphics2D) g;

    Polygon poly = new Polygon();

    poly.addPoint(150, 150);
    poly.addPoint(250, 100);
    poly.addPoint(325, 125);
    poly.addPoint(375, 225);
    poly.addPoint(450, 250);
    poly.addPoint(275, 375);
    poly.addPoint(100, 300);

    g2.drawPolygon(poly);

} 
```

但是如果我使用`xpoints`and`ypoints`数组（在多边形的 Graphics 类中定义）它不能正常工作。

```
@Override
public void paint(Graphics g) {

    Graphics2D g2 = (Graphics2D) g;

    Polygon poly = new Polygon();

    poly.xpoints[0]=150;
    poly.xpoints[1]=250;
    poly.xpoints[2]=325;
    poly.xpoints[3]=375;
    poly.xpoints[4]=450;
    poly.xpoints[5]=275;
    poly.xpoints[6]=100;      

    poly.ypoints[0]=150;
    poly.ypoints[1]=100;
    poly.ypoints[2]=125;
    poly.ypoints[3]=225;
    poly.ypoints[4]=250;
    poly.ypoints[5]=375;
    poly.ypoints[6]=300;

    g2.drawPolygon(poly.xpoints, poly.ypoints, 7);

} 
```

如果您能提供帮助，我将不胜感激，无论如何，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T21:47:10.730

从您的评论中：

> 我认为应该是 7，因为每个数组有 7 个整数元素？

你必须先`initialize your array`，然后`populate the array with elements`。

```
 poly.xpoints = new int[7]; // initializing the array
    poly.xpoints[0]=150;       //populating the array with elements.
    poly.xpoints[1]=250;
    poly.xpoints[2]=325;
    poly.xpoints[3]=375;
    poly.xpoints[4]=450;
    poly.xpoints[5]=275;
    poly.xpoints[6]=100; 
```

同样适用于 YPoints。

如果您正在寻找动态数组，请使用 Java 集合框架中的[**List**](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)实现类之一，例如 ArrayList。

```
List<Integer> xPoints = new ArrayList<Integer>();
xPoints.add(150);
xPoints.add(250);
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T21:48:00.850

尝试使用预构建的数组初始化多边形。您可以事先创建数组并将它们传递给多边形的构造函数。

```
public Polygon(int[] xpoints, int[] ypoints, int npoints) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T21:47:16.723

你知道数组的大小是多少吗？它甚至被初始化了吗？

快速谷歌发现了这个：

[http://docs.oracle.com/javase/7/docs/api/java/awt/Polygon.html#xpoints](http://docs.oracle.com/javase/7/docs/api/java/awt/Polygon.html#xpoints) [http://www.java2s.com/Code/JavaAPI/java.awt/GraphicsdrawPolygonintxPointsintyPointsintnPoints.htm](http://www.java2s.com/Code/JavaAPI/java.awt/GraphicsdrawPolygonintxPointsintyPointsintnPoints.htm)

# javascript - Jquery 表达式不会“取消隐藏” 标签

> ID：15167345
> 
> 赞同：0
> 
> 时间：2013-03-01T21:41:33.787
> 
> 标签：javascript, jquery

好的，诚然，这是我第一次使用 java 脚本和 jQuery。我正在尝试显示一个`<p> </p>`标签，将其淡出，然后淡入另一个。淡出部分工作得很好，但之后其他标签不显示。您可以看到容器的边框更改大小以适应更大的文本区域，但您看不到文本。第 22-23 行是文本应该淡入的地方。我查看了 jQuery 文档，但似乎找不到原因。我尝试将`.css`调用放在表达式的前面，但我得到的只是文本弹出而不是淡入。我从网上的一个来源得到了这个想法，并试图改变它以适应我的需要。正如你现在看到的那样，我最终重写了整个内容。这是我的代码。

```
// JavaScript Document
var i = 1;
$(document).ready(function () {
    jQuery.fn.timer = function () {
        var $quote = $('#quote')
        var number = $('#quote').children('p');
        $quote.children('p').eq(i - 1).animate({
            opacity: 0
        }, 1000, function () {
            $quote.children('p').eq(i - 1).css({
                'display': 'none',
                'visibility': 'hidden'
            });
        }).delay(1000);
        i++;
        if (i > number.length) {
            i = 1;
        }
        $quote.children('p').eq(i - 1).animate({
            opacity: 100
        }, 1000, function () {
            $quote.children('p').eq(i - 1).css({
                'display': 'block',
                'visibility': 'visible'
            });
        });
    };
    window.setInterval(function () {
        $('#quote').timer();
    }, 10000);
}); 
```

我的带有样式的 html 如下所示：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script type="text/javascript" src="jQuery_V_1.9.1.js"> </script>
<script type="text/javascript" src="quotes_3.js"> </script>
<style>
#quote{
    background: white;
    border: 2px solid #333;
    display: block;
    margin: 0 auto;
    padding: 10px;
    width: 100px;
}

#quote p{
    color: #333;
    display: none;
    font-weight: bold;
    text-align: center;
    display: none;
    visibility: hidden;

}

#quote p:first-child{
    display: block;
    visibility: visible;

}
</style>
</head>

<body>

    <div id="quote">
    <p> Funny stuff happens with Java script </p>
    <p> this is turning out to be more work than I thought it would be!!</p>
    <p> I like Java more!!</p>
    </div>

</body>
</html> 
```

任何想法，将不胜感激。我在 6 小时前开始使用无法编译的东西。好像我可以制作一个动画 gif 来获得相同的效果，哈哈。

（编辑）我终于得到了要显示的文本，但是没有淡入效果。但是容器正在增长以容纳所有三个`<p> </p>`标签。为什么是这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T21:47:07.673

jQuery 已经具有[`fadeOut`](http://api.jquery.com/fadeOut/)和[`fadeIn`](http://api.jquery.com/fadeIn/)功能。无需重新发明轮子。

```
$(document).ready(function(){

    var quote = "Another quote!";

    $("#quote").text().fadeOut(1000);
    $("#quote").text(quote).fadeIn(1000);

} 
```

更新：

如果你想同时做动画和淡化，试试这个：

```
$("#quote").animate({ opacity: 1, top: "-10px" }, 'slow'); 
```

但是，这似乎不适用于 display: none 元素（如 fadeIn 一样）。所以，你可能需要事先把这个：

```
$("#quote").css('display', 'block');
$("#quote").animate({ opacity: 0 }, 0); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T22:20:49.643

我分解了您的代码，并对其进行了优化以产生我认为您正在寻找的效果。我相信这可能是您正在寻找的功能，尽管我觉得您的问题可以更清楚地说明；*`(1:desired-functionality; 2:current-efforts; 3:quandary-details)`*

## 我已经[为您创建了这个 JSFiddle，](http://jsfiddle.net/ChaseMoskal/x8DGZ/)并认为它代表了您正在寻找的功能。

我生成的 JavaScript 通过以下方式重新创建我对您所需效果函数的解释：淡化所有引用内容，然后淡入“active_quote”，随着我们的前进，谁的索引被相应地设置。

```
$(function(){
    var $quotes=$('#quote>p');
    var quote_lifetime = 3*1000;
    var quote_fadetime = 200;
    //--------
    var active_quote=0;
    var number_of_quote_innards=$quotes.length;
    function displayActiveQuote(){
        $quotes.fadeOut(quote_fadetime); // Fade out all quote contents
        setTimeout(function(){ // After fadeOut'ing everything, we fade in the active quote.
            $( $quotes[active_quote] ).fadeIn(quote_fadetime);
            active_quote++; // incrementing the active_quote, and resetting it to zero if it's exceeded its bounds.
            if (active_quote > number_of_quote_innards-1) active_quote=0;
        },quote_fadetime);
    }
    displayActiveQuote();
    setInterval(displayActiveQuote,quote_lifetime);
}); 
```

**然后我对 CSS 进行了核对**，因为它不再与此功能相关。您可以随意设置此引号框的样式 - 但请注意，对于引号之间的确切时刻，可以使用`min-height`来显示高度的无限小故障，因为两个引号可见，或者没有引号可见，对于单帧。为了解决这个问题，我建议改用固定`height`。

***//追赶。***

* * *

# 编辑：使用 jQuery 的 animate() 进行渐变*和滑动*

此编辑解决了 Craig 对同时滑动和淡入淡出功能的渴望。

## 我已经[***为你更新了这个 JSFiddle***](http://jsfiddle.net/ChaseMoskal/x8DGZ/26/)。

在 JavaScript 中，我将这`fadeOut&&fadeIn`对更改为`animate({opacity:0,height:0},quote_fadetime)`, 和`animate({opacity:1,height:'100%'},quote_fadetime)`，以及其他一些内容以适应这种情况。

***（更新代码）：***

```
$(function(){
    var $quotes=$('#quote>p');
    var quote_lifetime = 3*1000;
    var quote_fadetime = 800;
    //--------
    var active_quote=0;
    var number_of_quote_innards=$quotes.length;
    function displayActiveQuote(){
        $quotes.animate({opacity:0,height:0},quote_fadetime); // all quotes disappear
        setTimeout(function(){
            $($quotes[active_quote]).animate({opacity:1,height:'100%'},quote_fadetime); // active quote appears
            active_quote++; // here we increment the active_quote, and reset it to zero if it's exceeded its bounds.
            if (active_quote > number_of_quote_innards-1) active_quote=0;
        },quote_fadetime);
    }
    displayActiveQuote();
    setInterval(displayActiveQuote,quote_lifetime);
}); 
```

***我想指出，使用了 setTimeout，而不是 jQuery animate 的完成回调，因为在这种情况下，动画完成回调将触发 3 次，每次动画结束时触发一次。我们只希望这种情况发生一次，以淡入活跃的报价。***

这是CSS：

```
#quote {
    width:50%;min-width:210px;
    height:6em; overflow:hidden;
    padding:0.5em 1em; margin:0 auto;
    /*----*/
    border:2px solid #CCC; font-style:italic; 
    color:#555;border-radius:8px; }
    #quote>p {
        opacity:0; height:0; margin:0; } 
```

干杯，克雷格！***//追赶。***

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T21:51:18.983

这是一种涉及更少代码的方法（[演示](http://jsfiddle.net/sperske/Cupkt/1/)）

```
$(document).ready(function () {
    $("#quote p").each(function(index) {
        $(this).delay(5000*index).fadeIn(300);
    });
}); 
```

不比@aguyfromhere 少很多：P

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T22:06:19.183

`display: block; visibility: visible;` **在将不透明度设置为 100之前**，您必须进行设置。否则，您正在为不可见元素的不透明度设置动画。

# jquery - 除非浏览器窗口调整大小，否则滑动固定位置元素不可见

> ID：15167347
> 
> 赞同：0
> 
> 时间：2013-03-01T21:41:44.767
> 
> 标签：jquery, css, web-applications, mobile

我正在模仿移动应用程序的滑动式移动，并且遇到了问题。当隐藏的屏幕外滑动到屏幕上时，除非我调整浏览器框架的大小，否则`<section>`任何设置为保持不可见的元素。`position:fixed`

我尝试应用 a `$("section.current").children().show(0);`，但这似乎没有效果 - 我仍然被迫调整浏览器的大小并且元素立即出现。

如果元素具有`position:absolute`或已`position:relative`应用，则不会出现问题。只有`position:fixed`

任何建议都会非常有帮助。谢谢！

# python - python日志记录根本不起作用

> ID：15167348
> 
> 赞同：11
> 
> 时间：2013-03-01T21:41:46.193
> 
> 标签：python, logging

我正在尝试在我的小型 python 项目中使用日志记录。按照教程，我将下面的代码添加到我的代码中，但是该消息没有按应有的方式记录到文件中。

```
import logging
logging.basicConfig(
    filename = "a.log",
    filemode="w",
    level = logging.DEBUG)
logging.error("Log initialization failed.") 
```

pwd 中没有创建日志文件。（我已经使用以下代码打印出 pwd，并且我确定我检查了正确的目录。）所以我手动创建了文件并运行了代码，但仍然没有记录该消息。

```
print "argv: %r"%(sys.argv,)
print "dirname(argv[0]): %s"%os.path.abspath(os.path.expanduser(os.path.dirname(sys.argv[0])))
print "pwd: %s"%os.path.abspath(os.path.expanduser(os.path.curdir)) 
```

有人知道我在这里做错了什么吗？提前致谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-01T22:22:22.723

你`basicConfig()`至少打了两次电话；第一次没有文件名。清除处理程序并重试：

```
logging.getLogger('').handlers = []

logging.basicConfig(
    filename = "a.log",
    filemode="w",
    level = logging.DEBUG) 
```

# ml - 比较 ML 中的不同数据类型

> ID：15167352
> 
> 赞同：0
> 
> 时间：2013-03-01T21:42:10.997
> 
> 标签：ml

```
type Name = string;
datatype Expr = Const of int
    | Var of Name
    | Neg of Expr
    | Plus of Expr * Expr
    | Mult of Expr * Expr
    | App of Fun * Expr
    and Fun = Def of Name * Expr

(* substitute every x in expression z with expression y *)

fun substitute (Name x, Expr y, Expr z) = if x = z then y else z; 
```

我只想比较 x 和 z 的字符串值，如果它们相同则返回 y，否则返回 z，但我一直收到此错误？

```
e.sml:13.33-13.39 Error: non-constructor applied to argument in pattern: Expr
e.sml:13.25-13.31 Error: non-constructor applied to argument in pattern: Expr
e.sml:13.17-13.23 Error: non-constructor applied to argument in pattern: Name
e.sml:13.50 Error: unbound variable or constructor: z
e.sml:13.46 Error: unbound variable or constructor: x
e.sml:13.57 Error: unbound variable or constructor: y
e.sml:13.64 Error: unbound variable or constructor: z

uncaught exception Error
  raised at: ../compiler/TopLevel/interact/evalloop.sml:66.19-66.27
         ../compiler/TopLevel/interact/evalloop.sml:44.55
         ../compiler/TopLevel/interact/evalloop.sml:296.17-296.20 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T09:56:53.063

你的定义`substitute`没有多大意义;)。首先，您使用错误的类型和模式匹配，其次您需要递归替换，而不仅仅是根表达式。

这是一个工作版本的草图：

```
fun substitute(x, e, Const n)      = Const n
  | substitute(x, e, Var y)        = if x = y then e else Var y
  | substiture(x, e, Neg e')       = Neg(substitute(x, e, e'))
  | substitute(x, e, Plus(e1, e2)) = Plus(substitute(x, e, e1), substitute(x, e, e2))
  | ... 
```

您应该能够填写剩余的案例。这种`App`情况需要注意避免在函数中意外捕获——也就是说，您必须避免在`x`与参数变量相同的情况下在主体内部进行替换。

如果你热衷于给出类型注释，那么这个函数可能最好用一个案例来编写：

```
fun substitute(x : Name, e : Expr, z : Expr) =
    case z of
      Const n => z
    | Var y   => if x = y then e else z
    | Neg e'  => Neg(substitute(x, e, e'))
    ... 
```

这相当于前者，后者只是一个案例的语法糖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T21:58:27.473

您似乎认为函数参数的语法是`typename variablename`. 它不是。语法是`pattern : typename`或者只`pattern`​​是模式的最简单形式只是一个变量名。

编写类似的东西`Name x`意味着这`Name`是某个数据类型的构造函数，并且您正在尝试将您的第一个参数（必须是该数据类型的值）与该构造函数进行模式匹配。那不是你想要的。

要定义一个接受参数和的函数`x`，您应该只写：`y``z`

```
fun substitute (x, y, z) = ... 
```

或者，如果您想说明参数的类型：

```
fun substitute (x: Name, y: Expr, z: Expr) = ... 
```

PS：在您编写的函数主体中`x = z`，但这不起作用，因为`x`and`z`是不同类型的值-它们不可能彼此相等。

# c - semop - 是否可以增加一个信号量（一组两个），而第二个信号量被阻塞

> ID：15167353
> 
> 赞同：1
> 
> 时间：2013-03-01T21:42:11.287
> 
> 标签：c, linux, semaphore

我有两个信号量应该原子地改变。

```
 union semun su;
  struct sembuf sb[2];
  int num = 2;

  semid = semget(num, 3, IPC_CREAT | IPC_EXCL | 0600);

  su.val = 1;
  semctl(semid, 0, SETVAL, su);
  su.val = 0;
  semctl(semid, 1, SETVAL, su);

  sb[0].sem_num = 0;
  sb[0].sem_op  = 1; // signal
  sb[0].sem_flg = 0;

  sb[1].sem_num = 1;
  sb[1].sem_op  = -1; //wait
  sb[1].sem_flg = 0;

  semop(semid, sb, 2) 
```

如您所见，一个信号量应该`signal()`，另一个应该`wait()`。

[我在这个问题](https://stackoverflow.com/questions/10206501/semop-when-decreasing-a-set-of-semaphores-are-all-decremented-at-once-or-does-i)中读到，如果两个信号量同时更改，并且如果有一个信号量被阻塞，那么它并不会真正改变另一个信号量 - 并且所有信号量都将进入睡眠状态。

在我的实施中，对我来说非常重要的是：

1.  两个信号量的操作都将原子地发生
2.  如果第二个信号量将被阻塞，则对第一个信号量无关紧要。意味着第一个信号量将按`signal()`预期进行，第二个信号量将`wait()`...

我无法从附加的问题中理解是否可以这样做，而且我不确定那里是否有答案......

所以想问问有没有可能

提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:59:16.663

> 我在这个问题中读到，如果两个信号量同时更改，并且如果有一个信号量被阻塞，那么它并不会真正改变另一个信号量 - 并且所有信号量都将进入睡眠状态。

问题涉及的是信号量操作集是否以原子方式发生。答案正确地澄清了它是原子的。

而不是这样想

> “如果两个信号量同时改变”

这样看

> “如果两个信号量都更改**为一个**”

我敢肯定，你会欣赏原子性的概念。

很明显在上面的代码中这样做

```
semop(semid, sb, 2) 
```

无论您的意图是什么，都将信号量 sb[0] 和 ab[1]**的操作作为单个操作执行。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:55:24.737

首先，您的代码示例不正确，没有多大意义。它应该是：

```
sb[0].sem_num = 0;
sb[0].sem_op = 1; // signal
sb[0].sem_flg = 0;

sb[1].sem_num = 1;
sb[1].sem_op = -1; //wait
sb[1].sem_flg = 0;

semop(semid, sb, 2) 
```

您所描述的是可能的，这只是 2 个顺序操作：

```
sb[0].sem_num = 0;
sb[0].sem_op = 1; // signal
sb[0].sem_flg = 0;
semop(semid, sb, 1)

sb[0].sem_num = 1;
sb[0].sem_op = -1; // wait
sb[0].sem_flg = 0;
semop(semid, sb, 1) 
```

在评论中讨论之后，看起来这个问题可以改写成这样：我可以让 semop() 原子操作部分原子化吗？不，你不能，它是原子的。如果您不需要多个操作是原子的，请不要将它们放在一个 semop() 中。

# php - Magento 集成测试：如何使用夹具而不是 config.xml 默认值？

> ID：15167357
> 
> 赞同：1
> 
> 时间：2013-03-01T21:42:20.147
> 
> 标签：php, magento, testing, phpunit

我们正在使用[IvanChepurnyi 的 EcomDev_PHPUnit](https://github.com/IvanChepurnyi/EcomDev_PHPUnit)，它似乎有一些很好的特性，可以用 Magento 编写单元和集成测试，包括关于从数据库加载数据的声明特性。只是，我只能让它工作半途而废：我可以使用夹具将数据获取*到*数据库，但我的测试总是从数据库之外的意外位置获取数据，例如 config.xml。

例如，假设我创建了一个带有管理配置的简单模型：

应用程序/代码/社区/我的/事物/etc/config.xml：

```
<?xml version="1.0"?>
<config>
    <modules>
        <My_Thing>
            <version>0.0.1</version>
        </My_Thing>
    </modules>
    <global>
        <helpers>
            <thing>
                <class>My_Thing_Helper</class>
            </thing>
        </helpers>
    </global>
    <default>
        <thing>
            <it>
                <arbitrary>value</arbitrary>
            </it>
        </thing>
    </default>
    <phpunit>
        <suite>
            <modules>
                <My_Thing/>
            </modules>
        </suite>
    </phpunit>
</config> 
```

应用程序/代码/社区/我的/事物/etc/settings.xml：

```
<?xml version="1.0"?>
<config>
    <tabs>
        <thing translate="label" module="my_thing">
            <label>Thing</label>
        </thing>
    </tabs>
    <sections>
        <thing translate="label">
            <label>Thing Settings</label>
            <tab>thing</tab>
            <frontend_type>text</frontend_type>
            <show_in_default>1</show_in_default>
            <show_in_website>1</show_in_website>
            <show_in_store>1</show_in_store>
            <groups>
                <it translate="label">
                    <label>It</label>
                    <frontend_type>text</frontend_type>
                    <sort_order>120</sort_order>
                    <show_in_default>1</show_in_default>
                    <show_in_website>1</show_in_website>
                    <show_in_store>1</show_in_store>
                    <fields>
                        <arbitrary translate="label">
                            <label>Arbitrary</label>
                            <frontend_type>text</frontend_type>
                            <validate>required-entry</validate>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        </arbitrary>
                  </fields>
                </it>
            </groups>
        </thing>
    </sections>
</config> 
```

应用程序/代码/社区/My/Thing/Helper/Data.php：

```
<?php
class My_Thing_Helper_Data extends Mage_Core_Helper_Abstract
{
    const CONFIG_IT_ARBITRARY = 'thing/it/arbitrary';

    /**
     * Get the arbitrary value.
     *
     * @return string
     */
    public static function getArbitrary()
    {
        return Mage::getStoreConfig(self::CONFIG_IT_ARBITRARY);
    }
} 
```

app/code/community/My/Thing/Test/Helper/DataTest.php：

```
<?php
class My_Thing_Helper_DataTest extends EcomDev_PHPUnit_Test_Case_Controller
{
    /**
     * The helper we're testing.
     */
    public $target = null;

    /**
     * Set up configuration for testing
     */
    public function setUp()
    {
        parent::setUp();
        $this->target = Mage::helper('thing');
    }

    /**
     * Test that paths are joined correctly.
     * 
     * @loadFixture
     */
    public function testGetArbitrary()
    {
        $this->assertEquals(
            'something',
            $this->target->getArbitrary()
        );
    }
} 
```

app/code/community/My/Thing/Test/Helper/DataTest/testGetArbitrary.yaml：

```
tables:
  core/config_data:
    - path: thing/it/arbitrary
      value: something 
```

我意识到上面的测试是人为的，但关键是即使我创建一个夹具来将“任意”值设置为“某物”，测试也会失败，因为它从 config.xml 默认值中获取值，*即使*'某些东西的价值在数据库中。这是为什么？为了从测试数据库中获取数据，而不是缓存或 config.xml 默认值，我需要对 phpunit 或 EcomDev 执行其他一些技巧吗？

顺便说一句，如果我`phpunit`在不断轮询测试数据库的值的同时运行，我*确实*看到`something`插入到了正确的位置。测试只是没有从那里获得价值。

# c# - 如何克服 Windows 组件对 Windows 运行时类型的限制？

> ID：15167360
> 
> 赞同：6
> 
> 时间：2013-03-01T21:42:25.957
> 
> 标签：c#, windows-8, windows-store-apps

我有一个使用后台任务的 Windows 应用商店应用程序。后台任务存储在 Windows 运行时组件项目中。（这种结构似乎是使后台任务工作的唯一方法。）

在后台任务项目中，我有一些外部可见的公共方法，它们的返回/参数类型是我自己的类而不是 Windows 运行时类。

例如：

```
public MyClass DoSomething()
{
    return null;
} 
```

构建时，我收到与这些方法相关的以下错误：

> 方法“X”返回“Y”，它不是有效的 Windows 运行时类型。向 Windows 运行时公开的方法必须仅返回 Windows 运行时类型。

和

> 方法“T”具有“W”类型的参数“U”。“W”不是有效的 Windows 运行时参数类型。

我可以理解错误在说什么，但是我还没有想到一种可以构建代码以满足这些要求的好方法。

以下是我已经考虑过的一些事情：

1.  将后台任务项目更改为 Windows 应用商店类库项目。这允许在方法签名中使用非 Windows 运行时类型，但不再启动后台任务。
2.  使用可移植类库。这不起作用，因为它无权访问 Windows 运行时。
3.  对于值类型，我可以将它们分解为`Tuple`s 或多个参数，但这看起来很杂乱，结构较少且可维护性较差。我强烈反对这种类型的编程。
4.  对于类，似乎我可能不得不在两个应用程序中复制它们的逻辑。这是一个巨大的可维护性问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T21:43:50.183

通过隔离 Windows 组件项目中的后台任务并将可重用的 Windows 运行时相关代码移动到 Windows 应用商店类库项目中，我能够完成这项工作。

# iphone - 如何确保我的应用永远不会作为“打开方式...”的默认设置出现

> ID：15167363
> 
> 赞同：3
> 
> 时间：2013-03-01T21:42:44.480
> 
> 标签：iphone, ios, cocoa, ibooks, uti

我的 iPhone 应用程序将自己注册为 CFBundleDocumentTypes 中 PDF 文件的“备用”处理程序，最近我开始收到用户的抱怨，称它已将 iBooks 取代为 PDF 的默认“打开方式...”应用程序；似乎 iBooks 也仅将自己注册为 PDF 的“备用”处理程序，并且系统默认为我的应用程序而不是 iBooks。

如果系统上有任何其他应用程序可以处理此文件类型，我有什么方法可以告诉 iOS 在任何情况下都不应该将我的应用程序设为默认的“打开方式...”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:55:33.073

据我所知，当应用程序显示`UIDocumentInteractionController`和“打开方式”菜单时，这些应用程序似乎以“最近使用的节目优先”的顺序出现。

我运行了一个生成 PDF 文件的应用程序，然后选择从应用程序中导出 PDF。出现了应用程序列表。我选择了第二个应用程序。我重复了这个过程。这一次，应用程序以不同的顺序出现。我之前选择的那个现在是第一个。

其余列出的应用程序似乎没有太多特定的顺序。它可以基于应用程序的安装顺序。

换句话说，您的应用程序无能为力。iOS 以它认为合适的任何顺序显示应用程序。如果用户希望 iBooks 成为第一，那么他们应该选择 iBooks。下次会默认。

顺便说一句 - 为什么用户抱怨？iBooks 在打开 PDF 文件方面并不比任何其他应用程序更特别。

# actionscript-3 - AS3 如何传递帧

> ID：15167365
> 
> 赞同：0
> 
> 时间：2013-03-01T21:42:47.337
> 
> 标签：actionscript-3, frames

我的游戏有一个小问题。我想当我的玩家遇到盒子碰撞时，这会调用另一个我在其中放置动画的帧。而且，当这个动画结束时，我希望这个帧调用另一个第二级所在的帧。

我有所有的代码，碰撞，删除侦听器来停止实际的框架功能，但是当我把`gotoAndStop("animationframe");`框架放在循环中并且永远不会进入第二级时。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:24:56.077

让动画在您在顶层监听的最后发送一个[冒泡事件。](http://www.rubenswieringa.com/blog/eventbubbles-eventcancelable-and-eventcurrenttarget)当您听到该事件时，转到另一帧。

如果你是时间线的人，你可以做类似的事情

```
   dispatchEvent(new Event('imDone', true);

```

如果不是，您可以在该动画的基类的构造函数中执行以下操作：

```
   addFrameScript(totalFrames-1, function ():void {
      dispatchEvent(new Event('imDone', true));
   });

```

或者您可以添加一个输入帧侦听器并检查是否在最后一帧并调度事件（如果是）。

# c# - 插件架构模式

> ID：15167372
> 
> 赞同：3
> 
> 时间：2013-03-01T21:43:45.260
> 
> 标签：c#, .net, entity-framework, architecture, design-patterns

我正在尝试构建一个使用实体框架的大项目。它是可扩展的应用程序。我需要创建一些 BLL，我可以从 Api 控制器、Web 控制器和其他模块中使用它们。我需要提供对数据库实体的访问。但我想控制并为它们的任何变化添加一些逻辑。而且我不知道哪个是实现它的最佳方式。也许我需要创建一些类，例如控制器或为实体创建代理/包装器。有一些我可以使用的模式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:04:56.050

我认为您需要使用MEF。它是可扩展应用程序的强大框架。 [http://mef.codeplex.com/](http://mef.codeplex.com/)

# wordpress - 在 wordpress 中更改“POST”类型的 slug

> ID：15167373
> 
> 赞同：5
> 
> 时间：2013-03-01T21:43:45.367
> 
> 标签：wordpress

由于默认的 wordpress 带有一个带有“post”的默认帖子类型！

我想把这个蛞蝓换成另一个没有任何头疼的东西！

我的意思是，例如，将 slug 更改`post`为`article`.

我怎样才能做到这一点？

**更新**

这就是我要的 ：

```
function _slug(){
 $args = array(
    'rewrite' => array(
        'slug' => 'article',
    ),
  ); 
  register_post_type('post',$args);
}
add_action('init', '_slug'); 
```

但是，这行不通！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-03-09T17:16:58.440

其中一种方法是在 functions.php 文件上使用帖子类型 args[过滤器](https://www.wpbeginner.com/glossary/filter/)（确保它在注册帖子类型后运行）：

```
$post_type = <POST TYPE NAME> # Define your own as a string
$new_slug = <WANTED SLUG> # Define your own as a string

add_filter( 'register_post_type_args', function($args, $post_type){
  if ( 'post_type' == $post_type )
     $args['rewrite'] = array( 'slug' => $new_slug );

  return $args;

}, 10, 2 ); 
```

# java - restlet json 错误和验证消息框架的最佳实践

> ID：15167387
> 
> 赞同：0
> 
> 时间：2013-03-01T21:44:45.600
> 
> 标签：java, json, validation, restlet

我们有一个 restlet API，它以 JSON 格式返回错误消息。我们`setStatus(Status.CLIENT_ERROR_BAD_REQUEST);`在生成 JSON 响应之前传递，如果操作成功，我们将传递 200 OK。

我的问题是：restlet 中是否有任何验证和错误消息创建框架？更重要的是，将错误消息传递给他们可以轻松解释的 UI 的最佳实践是什么？

示例错误消息：状态代码：400 错误请求

```
{
   "ErrorMessage": "Unable to **: Failed to get **:Failed to connect to *"
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-17T17:01:02.163

我想我正在寻找这个或类似的框架 [http://hibernate.org/validator/](http://hibernate.org/validator/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T09:25:13.480

我认为答案是否定的。

你可以按照推特方式 [https://dev.twitter.com/docs/error-codes-responses](https://dev.twitter.com/docs/error-codes-responses)

我个人建议省略错误代码 id。
它本身的消息是 API 合同的一部分。
它应该简短、清晰且使用有效的英语。
{"error|message":"User not found"}
客户端应该翻译“User not found”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-03T10:17:04.697

您可能想看看 Validator 类：[http ://restlet.com/technical-resources/restlet-framework/javadocs/snapshot/jse/api/org/restlet/routing/Validator.html](http://restlet.com/technical-resources/restlet-framework/javadocs/snapshot/jse/api/org/restlet/routing/Validator.html)

# backbone.js - backgrid 抛出 TypeError

> ID：15167388
> 
> 赞同：0
> 
> 时间：2013-03-01T21:44:49.393
> 
> 标签：backbone.js, backgrid

我在 backgrid 的第 1620 行收到此错误：

```
Uncaught TypeError: Cannot call method 'text' of null 
```

这是我的代码，它模仿了这个例子：

```
var ConversionTag = Backbone.Model.extend({});
var ConversionTagCollection = Backbone.Collection.extend({
    model: ConversionTag,
    url: '/api/tags/conversion',
    parse: function(response, options) {
        return response.conversionTags;
    }
});

var tags = new ConversionTagCollection();

var init = function(parentSelector) {
    var columns = [
        { name: 'chanId', label: 'Channel', cell: 'integer' },
        { name: 'name', label: 'Description', cell: 'string' },
        { name: 'pageUrl', label: 'Conversion URL', cell: 'string' },
        { name: 'secureFl', label: 'Secure Tag', cell: 'integer' },
        { name: 'id', label: 'ID', cell: 'integer', editable: false }
    ];
    var grid = new Backgrid.Grid({
        columns: columns,
        collection: tags
    });
    var foo = grid.render().$el; // ERROR!
    $(parentSelector).append(foo);
    tags.fetch();
    window.ctags = tags;
    window.cgrid = grid;
}; 
```

错误发生`foo=`在线上并且 `tags.fetch`永远不会被调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T03:19:08.110

那是因为您正试图将 HTML 注入到标头中。$.text()`document.createTextNode`在后台调用，它不接受 HTML。您必须子类 Header[在您的列定义中](http://wyuenho.github.com/backgrid/#api-header)明确声明其用法。

# c - getc(stdin) 返回两个字符。有没有更好的方法来处理这个？

> ID：15167390
> 
> 赞同：4
> 
> 时间：2013-03-01T21:45:01.703
> 
> 标签：c

我目前正在`getc()`循环中使用来接收用户的输入：

```
char x;
while (x != 'q')
{    
 printf("(c)ontinue or (q)uit?");
 x = getc(stdin);
} 
```

如果用户进入`c`循环执行，大概是第一次输入一个额外的字符（终止符或换行符，我猜？）作为输入。

我可以通过使用类似的东西来防止这种情况：

```
char toss;
char x;
while (x != 'q')
{    
 printf("(c)ontinue or (q)uit?");
 x = getc(stdin);
 toss = getc(stdin);
} 
```

但这让我觉得这只是一种懒惰的新手处理它的方式。有没有更简洁的方法来做到这一点，`getc`或者我应该将它用作字符串并使用数组的第一个字符？还有另一种我什至没有考虑过的更清洁的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T21:48:03.330

> 还是应该将它用作字符串并使用数组的第一个字符？

确切地。

```
char buf[32] = { 0 };

while (buf[0] != 'q') {
    fgets(buf, sizeof(buf), stdin);
    /* do stuff here */
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T21:51:33.763

你可以忽略空格：

```
int x = 0;
while (x != 'q' && x != EOF)
{    
 printf("(c)ontinue or (q)uit?");
 while ((x = getc(stdin)) != EOF && isspace(x)) { /* ignore whitespace */ }
} 
```

另请注意，`getc()`返回的是`int`，而不是`char`。如果您想检测`EOF`还应该检查哪些以避免无限循环（例如，如果用户在 unix 系统上按 Ctrl-D 或在 Windows 上按 Ctrl-Z），这一点很重要。要使用`isspace()`，您需要包含 ctype.h。

# java - Windows 托管 WCF 服务向 JAVA 客户端返回 400 Bad Request Invalid Hostname

> ID：15167392
> 
> 赞同：0
> 
> 时间：2013-03-01T21:45:12.040
> 
> 标签：java, wcf, wcf-client, hostname, wcf-configuration

正如标题所示，我在 Windows 服务中托管了 WCF 服务。当我使用 Visual Studio WCFTestClient 时，GetVersion() 方法（只返回一个字符串）工作正常。当我尝试从 Java 客户端调用相同的方法时，我得到一个无效的主机名错误。

使用 Wireshark 我跟踪了 XML 消息并得到以下信息：

- - - -发送 - - - - -

```
POST /CommunicatorService.svc HTTP/1.1
Accept: text/xml, multipart/related
Content-Type: text/xml; charset=utf-8
SOAPAction: "http://tempuri.org/ICommunicatorService/GetVersion"

User-Agent: JAX-WS RI 2.2.4-b01
Host: 192.168.201.210:7770
Connection: keep-alive
Content-Length: 373

<?xml version="1.0" ?><S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/"><S:Body><GetVersion xmlns="http://tempuri.org/" xmlns:ns2="http://schemas.microsoft.com/2003/10/Serialization/Arrays" xmlns:ns3="http://schemas.datacontract.org/2004/07/DieboldEras.WorkflowContracts" xmlns:ns4="http://schemas.microsoft.com/2003/10/Serialization/"/></S:Body></S:Envelope> 
```

- - - 回复 - - - - - -

```
HTTP/1.1 400 Bad Request
Content-Type: text/html
Date: Fri, 01 Mar 2013 20:51:18 GMT

Connection: close
Content-Length: 39

<h1>Bad Request (Invalid Hostname)</h1> 
```

我玩过 Host 参数，使用服务器的完整 DNS 名称，但结果是一样的。这是配置文件：

------配置------

```
<?xml version="1.0"?>
<configuration>
  <system.serviceModel>
    <services>
      <service name="DieboldEras.ImagewayCommunicator.Components.CommunicatorService" behaviorConfiguration="DieboldEras.ImagewayCommunicator.Components.CommunicatorServiceBehavior">
        <endpoint binding="basicHttpBinding"
            bindingConfiguration="basicHttpBinding" name="basicHttp" bindingName="basicHttpBinding"
            contract="DieboldEras.ImagewayCommunicator.Components.ICommunicatorService" >
        </endpoint>
        <host>
          <baseAddresses>
            <add baseAddress="http://192.168.201.210:7770/CommunicatorService" />
          </baseAddresses>
        </host>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="DieboldEras.ImagewayCommunicator.Components.CommunicatorServiceBehavior">
          <!-- To avoid disclosing metadata information, 
              set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="True" />
          <!-- To receive exception details in faults for debugging purposes, 
              set the value below to true.  Set to false before deployment 
              to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="False" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <bindings>
      <wsHttpBinding>
        <binding name="wsHTTPBinding"/>
      </wsHttpBinding>
      <mexHttpBinding>
        <binding name="mexHTTPBinding"/>
      </mexHttpBinding>
      <basicHttpBinding>
    <binding name="basicHttpBinding" />
      </basicHttpBinding>
    </bindings>
    <client />
  </system.serviceModel>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
</configuration> 
```

我将 NetBeans 用于 Java 客户端，代码很简单：

------Java代码--------

```
CommunicatorService service = new CommunicatorService();
ICommunicatorService port = service.getBasicHttp();
((BindingProvider)port).getRequestContext().put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY, "http://192.168.201.210:7770/CommunicatorService.svc");
String version = port.getVersion(); 
```

任何指针/调试技巧都会有所帮助。我对 Java 不是很熟悉，所以我不确定从哪里开始，但是发送的消息中似乎有些地方是错误的，我可以更改消息或服务的配置以知道会发生什么，我只是不知道那是什么东西。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T18:04:40.353

问题实际上出在 Java 代码中：

```
CommunicatorService service = new CommunicatorService();
ICommunicatorService port = service.getBasicHttp();
((BindingProvider)port).getRequestContext().put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY, "http://192.168.201.210:7770/CommunicatorService.svc");
String version = port.getVersion(); 
```

实际上应该是

```
CommunicatorService service = new CommunicatorService();
ICommunicatorService port = service.getBasicHttp();
((BindingProvider)port).getRequestContext().put(BindingProvider.ENDPOINT_ADDRESS_PROPERTY, "http://192.168.201.210:7770/CommunicatorService");
String version = port.getVersion(); 
```

3个字母有什么不同！

感谢 NileshKRathod 的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T07:19:07.250

试试这个为你的服务模型代码，它可以帮助你......

```
<system.serviceModel>
<serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
<services>
  <service name="VInfotech.Server.Intranet.IntranetService" behaviorConfiguration="IntranetService.Service1Behavior">
    <!-- Service Endpoints -->
    <endpoint address="" binding="basicHttpBinding" bindingConfiguration="Binding1" contract="VInfotech.Server.Intranet.IIntranet">
      <!-- 
          Upon deployment, the following identity element should be removed or replaced to reflect the 
          identity under which the deployed service runs.  If removed, WCF will infer an appropriate identity 
          automatically.
      -->
      <identity>
        <dns value="localhost"/>
      </identity>
    </endpoint>
  </service>
  <service name="VInfotech.Server.Intranet.MobileServicesController" behaviorConfiguration="ServBehave">
    <endpoint address="RestService" bindingConfiguration="StreamedRequestWebBinding" binding="webHttpBinding" behaviorConfiguration="restPoxBehavior" contract="VInfotech.Server.Intranet.IMobileServices" />
  </service>
</services>
<bindings>
  <webHttpBinding>
    <binding name="StreamedRequestWebBinding"
    bypassProxyOnLocal="true"
             useDefaultWebProxy="false"
             hostNameComparisonMode="WeakWildcard"
             sendTimeout="10:15:00"
             openTimeout="10:15:00"
             receiveTimeout="10:15:00"
             maxReceivedMessageSize="9223372036854775807"
             maxBufferPoolSize="9223372036854775807"
             maxBufferSize="2147483647"
             transferMode="StreamedRequest" >
      <readerQuotas maxArrayLength="2147483647" maxStringContentLength="2147483647" />
    </binding>
  </webHttpBinding>
  <basicHttpBinding>
    <binding name="Binding1" closeTimeout="04:01:00" openTimeout="04:01:00" receiveTimeout="04:10:00" sendTimeout="04:01:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferSize="1073741824" maxBufferPoolSize="1073741824" maxReceivedMessageSize="1073741824" messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true">
      <readerQuotas maxDepth="1073741824" maxStringContentLength="1073741824" maxArrayLength="1073741824" maxBytesPerRead="1073741824" maxNameTableCharCount="1073741824"/>
    </binding>
    <!-- For Cyber Source bindings-->
    <binding name="ITransactionProcessor" closeTimeout="04:01:00" openTimeout="04:01:00" receiveTimeout="04:10:00" sendTimeout="04:01:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferSize="1073741824" maxBufferPoolSize="1073741824" maxReceivedMessageSize="1073741824" messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true">
      <readerQuotas maxDepth="1073741824" maxStringContentLength="1073741824" maxArrayLength="1073741824" maxBytesPerRead="1073741824" maxNameTableCharCount="1073741824"/>
      <security mode="TransportWithMessageCredential">
        <transport clientCredentialType="None" proxyCredentialType="None" realm=""/>
        <message clientCredentialType="UserName" algorithmSuite="Default"/>
      </security>
    </binding>
  </basicHttpBinding>
  <!--Cyber Source bindings ends here-->
</bindings>
<behaviors>
  <serviceBehaviors>
    <behavior name="IntranetService.Service1Behavior">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
    </behavior>
    <behavior name="">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="false" />
    </behavior>
    <behavior name="ServBehave">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="false" />
    </behavior>
  </serviceBehaviors>
  <endpointBehaviors>
    <!--Behavior for the REST endpoint for Help enability-->
    <behavior name="restPoxBehavior">
      <webHttp helpEnabled="true" />
    </behavior>
    <behavior name="jsonBehavior">
      <enableWebScript />
    </behavior>
  </endpointBehaviors>
</behaviors>
<client>
  <endpoint address="https://ics2wstest.ic3.com/commerce/1.x/transactionProcessor" binding="basicHttpBinding" bindingConfiguration="ITransactionProcessor" contract="ITransactionProcessor" name="portXML"/>
</client>
<diagnostics>
  <messageLogging logEntireMessage="true" logMalformedMessages="true" logMessagesAtServiceLevel="true" logMessagesAtTransportLevel="true" maxMessagesToLog="3000" maxSizeOfMessageToLog="2000"/>
</diagnostics> 
```

我希望这能帮到您。:)

# debugging - 调试中...无法加载本机库

> ID：15167394
> 
> 赞同：2
> 
> 时间：2013-03-01T21:45:36.097
> 
> 标签：debugging, android-ndk

我对android开发相当陌生，看来我有一个相当经典的例外......

```
E/AndroidRuntime( 2119): FATAL EXCEPTION: main
E/AndroidRuntime( 2119): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.oneloop.Rb/android.app.NativeActivity}: java.lang.IllegalArgumentException: Unable to load native library: /data/app-lib/com.oneloop.Rb-1/libRb.so
E/AndroidRuntime( 2119):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180) 
```

我见过的大多数答案包括将 hasCode 设置为 true 或确保包含 app_dummy - 这两者都不能解决我的问题。此外，我已经确认（通过转换为 zip 和探索）我编译的 apk 包含 lib/armeabi-v7a/libRb.so。

我一直在将一个大小合适的框架（大量静态库、opengl 和预构建的中间件库）转换为 android - 所以我的明显倾向是我的库和我的 SO 之间存在某种不兼容。问题是 logcat 没有提供有关库失败原因的信息。

我从这里去哪里？
如何找出我的 lib.a 中的哪些问题？
可以使用哪些技术来进一步找出阻止我的 SO 加载的原因？有没有办法在调试中打开冗长？是否有任何命令行应用程序可用于验证我的 APK 和 SO 的完整性？
还有哪些其他因素可能导致此问题？

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-19T22:28:51.573

我收到了类似的错误消息，这是因为我的本机库使用了非系统库（即不在 .../usr/lib 中的库），在我的情况下是 gnustl_shared。您必须首先通过在 Java 中创建静态代码块来加载任何此类库：

```
System.loadLibrary("gnustl_shared"); 
```

您的应用程序中无法加载的库是 libRb.so。找出它需要链接的其他库并首先加载它们。

# php - 使用具有特定命令的 root 权限的 PHP (Apache) 启动 linux 应用程序

> ID：15167396
> 
> 赞同：2
> 
> 时间：2013-03-01T21:45:52.297
> 
> 标签：php, linux, apache, node.js

我正在运行几个 Node 实例，它们都在不同的端口上运行。

我需要一种能够根据它正在运行的端口杀死特定节点实例的方法（杀死绑定到端口 n 的节点实例）。

在我的终端上，我可以轻松地将“fuser -k xxxx/tcp”xxxx 作为端口。

问题是，那是因为我有权这样做。我的问题是：我希望能够有一个 PHP 文件来关闭在端口 n 上运行的节点实例，并且任何人都可以打开它。如何在不打开巨大安全漏洞的情况下做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:53:13.593

您可以考虑向您的服务器再添加一个端点，例如`/shutdown`调用`process.exit()`;

结果是立竿见影的，比使用一堆 shell 命令、跟踪 pid 等更容易实现......

也很容易通过密码、签名请求等来保护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:57:53.713

最好的方法是让 php 将端口号写入文件，然后让 cron 脚本以 root（或任何需要的用户）身份运行，并从该文件中读取端口号。cron 脚本也应该有一些安全措施，比如不停止端口 80 上运行的任何东西，或者根本不停止节点进程。

编辑：为了更加安全，您可以要求端口号以需要您输入的“密码”为前缀。然后 cron 脚本将验证它是否以该密码为前缀（或对其进行散列并比较散列会更好）

# json - Mustache 模板未在 Rails 中显示嵌套对象

> ID：15167401
> 
> 赞同：0
> 
> 时间：2013-03-01T21:46:15.820
> 
> 标签：json, ruby-on-rails-3, mustache

我在我的 Rails 项目中使用 Rabl 从我的控制器输出 JSON。然后我使用 Mustache 和 'stache' gem 来生成模板。但是，Mustache 模板没有从我的一个 JSON 提要中获取我需要的信息，我已经尝试了我能找到的每个示例/解决方案。

这是我的 JSON：

```
{
  "connectons":[
   {
     "connection":{
        "status":"accepted",
        "user":{
           "id":2,
           "first_name":"Joe",
           "last_name":"Black"
         }
      }
    },
    {
     "connection":{
        "status":"accepted",
        "user":{
           "id":2,
           "first_name":"Joe",
           "last_name":"Black"
         }
      }
    }
   ]
 } 
```

这是我的模板：

```
<ul>
{{#connections}}
  <li>
    <p>{{status}}</p>
    {{#user}}
      <p>{{first_name}}</p>
    {{/user}}
  </li>
{{/connections}}
</ul> 
```

但是该`user`节点没有显示任何内容。节点中的所有内容都`connection`显示得很好。我已经尝试了我所知道的一切。我的 JSON 不好吗？我也不知道它是否与我正在使用的任何宝石有关。我想知道是否有人可以帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:43:19.603

事实证明，这是 Devise 的问题——我认为。Rabl 构建的 JSON 很好，但由于某种原因，我不得不更改控制器中的内容。

我不得不改变这个：

```
def index
  @connections = current_user.connections
end 
```

到：

```
def index
  @user = current_user
  @connections = @user.connections
end 
```

我现在可以毫无问题地访问我的胡子模板中的信息。我不知道为什么它会这样工作，但如果我找出原因，我会发布信息。

# ios - 从相机拍照后 UIImageView 旋转

> ID：15167402
> 
> 赞同：2
> 
> 时间：2013-03-01T21:46:26.500
> 
> 标签：ios, xcode, uiimageview

我在 iPad 应用程序中看到了一些奇怪的行为。我有一个 UIImageView，我正在从相机中捕捉。在纵向模式下，当我响应 didFinishPickingMediaWithInfo 事件时，它会正确显示在 UIImageView 中。但是，当我稍后返回 UIIMageView 以重新显示保存的照片时，它会自动将图像旋转 90 度。旋转设备继续显示旋转 90 度的图像。

有没有办法确定捕获图像时使用的方向，并且应该使用该方法重新显示图像？

任何帮助，将不胜感激。我搜索但找不到任何特定于此的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T12:55:44.630

我已经准备好了。回复

[上传后iOS UIImagePickerController结果图像方向](https://stackoverflow.com/questions/5427656/ios-uiimagepickercontroller-result-image-orientation-after-upload)

为我工作。捕获图像后，我立即根据此线程上的代码示例检查旋转并根据需要进行调整。

感谢所有回复！

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-03-01T22:09:46.637

试试这个：将它添加到 viewWillAppear 或任何你想要的地方：

```
[self updateLayoutForNewOrientation: self.interfaceOrientation]; 
```

并添加此方法：

```
- (void) updateLayoutForNewOrientation: (UIInterfaceOrientation) orientation {
if (UIInterfaceOrientationIsLandscape(orientation)) {
// do something
    } else {
//do something
   }
} 
```

# java - 打开一个新的 JFrame

> ID：15167404
> 
> 赞同：9
> 
> 时间：2013-03-01T21:46:34.023
> 
> 标签：java, swing, jframe

我有一个主 JFrame，其中包含用于不同功能的各种面板，人们可以在其中计算事物。我想在用户点击第一个计算按钮时打开一个新的 JFrame 并用作输出窗口（如果您熟悉它们，则类似于 SPSS 输出窗口）。

New JFrame 将是完全独立的，并且会有自己的菜单栏... 一个简单的 JDialog 不是这里的方法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-01T22:29:10.510

*   无法抗拒，简单不同意答案`JFrame frame = new JFrame(`）；和`frame.setVisible(true);`

> 我想在用户点击第一个计算按钮时打开一个新的 JFrame 并用作输出窗口（如果您熟悉它们，则类似于 SPSS 输出窗口）。

*   [不要那样做，只创建两个 JFrames](https://stackoverflow.com/questions/6309407/remove-top-level-container-on-runtime)，重用第二个。`JFrame`通过使用`getContentPane.removeAll()`, 来执行其他操作`JButton`

*   那么所有的生命周期将只有大约`setVisible(true)`/`setVisible(false)`

*   更改`DefaultCloseOperations`为`HIDE_ON_CLOSE`

> New JFrame 将完全独立，并有自己的菜单栏。一个简单的 JDialog 不是这里的方法。

*   有什么问题，与三个按钮相比`JDialog`，只有一个按钮，简单不同意，`Toolbar``JFrame`

> 输出窗口（如果您熟悉它们，则类似于 SPSS 输出窗口）。

*   如果所有更改都已完成，则使用`SwingWorker`or `Runnable#Thread`（需要 wrap into ）`invokeLater`获取放置到 JDialog 中的 JComponents 的值`JDialog.setVisible(true)``invokeLater()`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-01T21:48:04.043

```
JFrame newFrame = new JFrame();
newFrame.setVisible(true); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-01T22:01:03.963

[`JFrame`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JFrame.html)切勿在 Swing 应用程序中使用多个。改为用于[`JDialog`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JDialog.html)额外的窗口。

请参阅[使用多个 JFrame，好/坏做法？](https://stackoverflow.com/a/9554657/597657).

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-01T21:50:26.670

我可能误解了你的问题，但是

```
JFrame frame = new JFrame();
frame.setVisible(true); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-25T10:05:57.327

我用了代码`JFrame frame = new JFrame(); frame.setVisible(true);`。这段代码只是做空窗口。

# sql - 组合 SQL Server 表数据

> ID：15167406
> 
> 赞同：0
> 
> 时间：2013-03-01T21:46:44.663
> 
> 标签：sql, sql-server

我尝试了许多选项来组合 SQL Server 数据，其中一些我可以开始工作，但数据不正确。

我有用户、统计数据和结果表。我已经从前两个表中取出数据并将它们组合起来，信息很好；

```
 create table #statsTable(
s_fullname char(45),               <--Here
s_dialdate smalldatetime,
s_campaign char(3),
s_calls int,
s_holdtime int,
s_talktime int,
s_wrapuptime int ,
s_dialtime int ,
s_pitches int ,
s_agent char(3) ,                 <-- to here, insert fine
s_samount decimal(20,2),          <--Here
s_damount decimal(10,2) ,
s_upamount numeric (10,0),
s_mdamount decimal (12,2))        <--to here, uses a separate query, not so much 
```

我尝试过使用连接等，但没有任何效果，似乎发生的事情是最后四个值似乎组合在一起，我不确定，但它们现在是正确的。下面插入上表的第一部分；

```
 INSERT  INTO #statsTable (s_fullname, s_agent, s_calls, 
            s_holdtime, s_talktime, s_wrapuptime, s_pitches, s_dialtime, s_campaign,
            s_dialdate)
      SELECT
         agent.name, agent.code, calls, holdtime, 
         talktime, wrapuptime, pitches, dialtime, campaign,
         dialdate  
      FROM stats, agent 
      WHERE 
         agent.code LIKE stats.agent 
         AND dialdate = '02-27-2013' 
```

它的下一部分是问题开始的地方，无论我尝试加入还是使用插入或更新查询，最后四个字段都会变得混乱。

我从中提取数据的 3 个表看起来像这样；

```
 agent
       name (full name)
       code (3 char ID)

    stats
       dialdate
       agent      (3 char ID)
       campaign   (3 char ID)
       calls      (number of calls)
       holdtime
       talktime 
       wrapuptime
       dialtime
       pitches

    results
       lcdate  (date last call was made)
       campaginid  (3 char ID)
       sale        (overall sale amount)
       donation    (donation amount)
       up_sale     (up-sale amount)
       md_amount   (not sure its purpose, but a decimal none the less) 
```

每个表中显然都有更多数据，但这是与最终输出相关的唯一相关数据。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:11:39.763

你可以通过这三个表加入，或者如果你做这样的事情，你会得到重复的记录吗？...

```
INSERT  INTO #statsTable 
            (
            s_fullname, 
            s_agent, 
            s_calls, 
            s_holdtime, 
            s_talktime, 
            s_wrapuptime, 
            s_pitches, 
            s_dialtime, 
            s_campaign,
            s_dialdate,
            s_upamount  --<<new
            )
SELECT      agent.name, 
            agent.code, 
            calls, 
            holdtime, 
            talktime, 
            wrapuptime, 
            pitches, 
            dialtime, 
            campaign,
            dialdate,
            r.up_sale     --<<like this?  
FROM    "stats" s
            INNER JOIN agent a 
                ON s.agent = a.code
            INNER JOIN results r 
                ON s.campagin  = r.campaginid  
WHERE   dialdate = '02-27-2013';

SELECT * 
FROM #statsTable; 
```

# jquery - AJAX 调用在 Chrome 和 Safari 中有效，但在 Firefox 和 IE 中无效？

> ID：15167417
> 
> 赞同：1
> 
> 时间：2013-03-01T21:47:17.290
> 
> 标签：jquery, ajax, internet-explorer, firefox, jquery-validate

这是我在用户忘记密码时重置用户密码的代码。数据通过 AJAX 请求发送到 PHP 代码，PHP 代码根据输入的有效性简单地回显“Y”或“N”。

问题是，AJAX 调用在 Firefox 19 和 IE 9 中不起作用。我没有在其他版本的 IE 中尝试过。AJAX 调用在 chrome 和 safari 中完美运行。有没有人遇到过同样的问题？有人可以帮忙吗？

```
 <title> Forgot Password? </title>    

    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script type="text/javascript" src="http://jzaefferer.github.com/jquery-  validation/jquery.validate.js"></script>

    <style type="text/css">

        label.error { color: red;  }

        #status { color: green; }

    </style>

    <script>

        $(document).ready(function(){

            $('#code_form').hide();

            $('#password_form').hide();

            $("#email_form").validate({

                onkeyup: false,

                rules: {

                  email: {
                    required: true,
                    email: true
                  }
                },

                messages: {
                  email: {
                  required: "Please enter your email ID.",
                  email: "Please enter a valid email ID."
                 }
               }

            });

            $('#email_send').click(function() {

                event.preventDefault();

                var email = $('#email').val();

                $.ajax({
                    type: "POST",
                    url: "reset_code.php",

                    data: {email: email},
                    cache: false,
                    success: function(response){

                    if(response == "Y")
                    {
                        $('#code_form').show();
                        $('#email_send').hide();
                        $('#status').html("Check your mail for the reset code.");

                    }
                    else
                    {

                        $('#status').html("Looks like you have entered a wrong email ID.");

                    }

                 }

            });

            });

            $("#code_form").validate({

                onkeyup: false,

                rules: {

                  code: {
                    required: true,
                    digits: true
                  }
                },

                messages: {
                  code: {
                  required: "Please enter the code received in your mail.",
                  digits: "Please enter the code received in your mail."
                 }
               }

             });

             $('#code_send').click(function() {

               event.preventDefault();

               var email = $('#email').val();
               var code = $('#code').val();

                $.ajax({
                type: "POST",
                url: "code_verify.php",

                data: {email: email, code: code},
                cache: false,
                success: function(response){

                    if(response == "Y")
                    {
                        $('#password_form').show();
                        $('#code_send').hide();
                        $('#status').html("Ok, now enter your password twice before you forget again.");

                    }
                    else
                    {
                        $('#status').html("Please enter the code received in your mail.");
                    }

                }

            });

            });

            $("#password_form").validate({

                onkeyup: false,

                rules: {

                  password: {
                    required: true,
                    minlength: 8
                  },
                  repassword: {
                    required: true,
                    equalTo: "#password"  
                  }
                }

            });

            $('#password_send').click(function() {

               event.preventDefault();

               var email = $('#email').val();
               var password = $('#password').val();
               var repassword = $('#repassword').val();

                $.ajax({
                    type: "POST",
                    url: "update_password.php",

                    data: {email: email, password: password, repassword: repassword},
                    cache: false,
                    success: function(response){

                    if(response == "Y")
                    {

                        $('#email_form').hide();
                        $('#code_form').hide();
                        $('#password_form').hide();
                        $('#status').html("Password reset successful. Proceed to <a href=index.php>login</a> page. ");

                    }
                    else
                    {
                        $('#status').html("Oops. Something went wrong. Try again.");

                    }

                }

            });

        });

    });

    </script>

</head>

<body class="oneColElsCtr">

    <div class ="about_body"> 

        <a href="index.php"><img src="images/title_block_logon.png" style="margin-    top:25px; margin-bottom:-10px;"/></a><br/>   

        <div id="status" class="alert alert-success"  style="margin-top:20px; width:400px; margin-left:235px; margin-bottom:30px;">

            <h4 class="alert-heading"> Reset your password </h4>

        </div>

        <form class="form-horizontal" name="email_form" id="email_form" method="POST" action="" >

            <fieldset>

                <div class="control-group" style="margin-left:230px">

                    <label class="control-label">Email</label>

                    <div class="controls" align="left">

                        <input name="email" id="email" class="input-large" type="text" placeholder="Enter your Email id"/>

                    </div>

                </div> 

                <div class="control-group">

                    <button type="submit" id="email_send" class="btn btn-inverse submit">GO</button>

                </div>

            </fieldset>

        </form> 

        <form class="form-horizontal" name="code_form" id="code_form" method="POST" action="" >

            <p>Enter the code received in your Email</p>

            <fieldset>

                <div class="control-group" style="margin-left:230px">

                    <label class="control-label">Code</label>

                    <div class="controls" align="left">

                        <input name="code" id="code" class="input-large" type="text" placeholder="#####"/>

                    </div>

                </div>

                <div class="control-group">

                    <button type="submit" id="code_send" class="btn btn-inverse  submit">GO</button>

                </div>

            </fieldset>

        </form>                   

        <table style="text-align:left">

            <tr>

                <td width="60%">

                    <form class="form-horizontal" name ="password_form" id="password_form" method ="POST" action ="" >

                        <fieldset>

                            <div class="control-group" style="margin-left:90px;">

                                <label class="control-label">Password</label>

                                <div class="controls">

                                    <input name="password" id="password" class="input-large" type="password" placeholder="Enter your Password" onfocus="Info_Over('#password_on_focus_info')" onblur="Info_Out('#password_on_focus_info')"/>

                                </div>

                            </div>

                            <div class="control-group" style="margin-left:90px;">

                                <label class="control-label">Confirm Password</label>

                                <div class="controls">

                                    <input name="repassword" id="repassword" class="input-large" type="password" placeholder="Re-enter your Password"/>

                                </div>

                            </div>  

                            <div class="control-group" style="margin-left:250px;">

                                <button type="submit" id="password_send" class="btn btn-inverse submit">CONFIRM</button>

                            </div>                          

                        </fieldset>            

                    </form>

                </td>

                <td width="400px" valign="top" style="padding-right:130px">

                    <span id="password_on_focus_info" style="display:none;">

                        Password should be 8 characters or more. Choose a strong password which is a combination of Capital and Small case alphabets, Symbols and Numbers.

                     </span>                                                              

                </td>

            </tr>

        </table>    

    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T21:52:54.633

您必须使用事件对象作为事件处理程序的参数，chrome 和 safari 在触发事件时有一个名为 event 的全局事件对象，但 firefox 没有。所以`event.preventDefault();`会导致错误。

例如

```
$('#email_send').click(function(event) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T03:17:43.367

如前所述，您没有正确实现处理程序的`preventDefault()`内部`click`。但是，即使您解决了`preventDefault()`问题，它也可能仍然无法正常工作。请参阅：http: [//jsfiddle.net/ZEFzx/](http://jsfiddle.net/ZEFzx/)，其中`click`处理程序内的代码根本没有被触发。

幸运的是，您无需担心`click`处理程序，因为 jQuery Validate 插件已经内置了**提交事件处理程序回调函数，而这正是您*应该*放置 ajax 的地方。**

[根据 Validate plugin 的文档](http://docs.jquery.com/Plugins/Validation/validate#toptions)，`submitHandler`回调函数是：

> “表单有效时处理实际提交的回调。获取表单作为唯一参数。替换默认提交。验证后**通过 Ajax 提交表单的正确位置**。”

试试这个代码：

```
$(document).ready(function () {

    $("#email_form").validate({
        onkeyup: false,
        rules: {
            email: {
                required: true,
                email: true
            }
        },
        messages: {
            email: {
                required: "Please enter your email ID.",
                email: "Please enter a valid email ID."
            }
        },
        submitHandler: function (form) {
            var email = $('#email').val();
            // var data = $(form).serialize();  // capture all the form data at once
            $.ajax({
                type: "POST",
                url: "reset_code.php",
                data: {
                    email: email
                },
                cache: false,
                success: function (response) {
                    if (response == "Y") {
                        $('#code_form').show();
                        $('#email_send').hide();
                        $('#status').html("Check your mail for the reset code.");
                    } else {
                        $('#status').html("Looks like you have entered a wrong email ID.");
                    }
                }
            });
            return false; // blocks redirect after submission via ajax
        }
    });

}); 
```

**演示：http: [//jsfiddle.net/xMg8e/](http://jsfiddle.net/xMg8e/)**

# django - 没有错误消息的 Django 内部服务器错误

> ID：15167423
> 
> 赞同：0
> 
> 时间：2013-03-01T21:47:55.213
> 
> 标签：django, macos, apache, mod-wsgi

另一个django服务器错误问题。

我的网站启动并运行了一段时间，直到我今天重新启动服务器。现在我得到一个内部服务器错误。apache 日志中没有任何相关内容。Debug 在 settings.py 中为 True，并使用 shell 确认为 True。我不知道发生了什么，也无法从我的系统中获取有关错误的任何信息。

如果重要的话，这在 OSX 10.7 上。

wsgi.py：

```
import os
import sys

path = '/Users/dpawlows/django/zone/'

if path not in sys.path:
    sys.path.append(path)

sys.path.append('Users/dpawlows/django')
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "settings")

from django.core.wsgi import get_wsgi_application
application = get_wsgi_application() 
```

httpd.conf：

```
LoadModule wsgi_module libexec/apache2/mod_wsgi.so
#WSGIPythonHome /opt/local/bin
WSGIScriptAlias /zone /Users/dpawlows/django/zone/apache/wsgi.py
<Directory "/Users/dpawlows/django/zone/">
Order allow,deny
Allow from all
</Directory>

Alias /static/ /Users/dpawlows/django/zone/register/static/
<Directory /Users/dpawlows/django/zone/register/static>
Order deny,allow
Allow from all
</Directory> 
```

更新：在提取我 100% 确定有效的网站的备份副本并对其进行测试后，我遇到了完全相同的问题，因此问题似乎与应用程序无关。它必须与 apache 或 db 加载不正确有关，但我不确定是什么，因为 apache 和 mysql 正在运行。欢迎任何其他想法或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T16:06:55.390

乍一看，您可以尝试更改“zone.settings”的“设置”，如果这不能解决，可能会在 Apache 的 error_log 上引发错误消息。

# selenium - WebElement.clear() 对文本框有什么作用？

> ID：15167429
> 
> 赞同：16
> 
> 时间：2013-03-01T21:48:27.080
> 
> 标签：selenium, selenium-webdriver, webdriver

我最近在使用 selenium 时遇到了一个问题，在该问题中，调用`clear()`自定义文本框会导致在稍后在测试中输入文本时出现问题。文本框会检查 ( `JavaScript`) `browserEvents`，尤其是`keyDown`事件。我试图弄清楚什么`clear()`会影响事情，但我似乎找不到任何细节。

Selenium Java 绑定的源代码[显示`clear()`不使用键盘或鼠标模拟](https://code.google.com/p/selenium/source/browse/java/client/src/org/openqa/selenium/WebElement.java)来清除文本框中的文本。那么它到底是做什么的呢？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-02T07:48:55.950

该`clear()`方法执行[“自动化原子”](https://github.com/SeleniumHQ/selenium/wiki/Automation-Atoms)，这是一个 JavaScript 函数，旨在为浏览器提供自动化功能的最小基本单元。在 的情况下`clear()`，该函数将`value`元素的属性设置为空字符串 ('')，然后`onchange`在元素上触发事件。您感兴趣的原子函数是[`bot.action.clear()`](https://github.com/SeleniumHQ/selenium/blob/master/javascript/atoms/action.js#L83)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T06:46:21.480

这就是`clear()`将要做什么。该函数将清除文本框值并启用文本框。在文本字段中输入文本之前，我们需要清除文本字段并启用它。如果我们不使用`clear ()`，我们不能使用 selenium 在文本字段中输入任何值。

```
driver.find_element_by_xpath(xpath).clear()
driver.find_element_by_xpath(xpath).send_keys("data") 
```

# php - 用背景颜色填充透明图像

> ID：15167432
> 
> 赞同：0
> 
> 时间：2013-03-01T21:48:41.223
> 
> 标签：php, image, function

我的网站上有类似[http://drksde.tk/images/F3-big.png](http://drksde.tk/images/F3-big.png)的图片，用于用户的头像。并且每个用户都可以更改背景颜色，因为图像具有透明背景。我做完了！！非常感谢你的帮助！！

这是代码：

```
<?php
function imagecopymerge_alpha($dst_im, $src_im, $dst_x, $dst_y, $src_x, $src_y, $src_w, $src_h, $pct){ 
    $cut = imagecreatetruecolor($src_w, $src_h); 
    imagecopy($cut, $dst_im, 0, 0, $dst_x, $dst_y, $src_w, $src_h); 
    imagecopy($cut, $src_im, 0, 0, $src_x, $src_y, $src_w, $src_h); 
    imagecopymerge($dst_im, $cut, $dst_x, $dst_y, 0, 0, $src_w, $src_h, $pct); 
}

$background = imagecreatetruecolor(200, 200);

$color = imagecolorallocate($background, 255, 150, 0);
imagefill($background, 0, 0, $color);

$avatar = imagecreatefrompng('F3-big.png');

imagecopymerge_alpha($background, $avatar, 0, 0, 0, 0, 200, 200, 100);

header('Content-Type: image/png');
imagepng($background);

imagedestroy($background);
imagedestroy($avatar); 
```

?>

以及最终的头像：[http ://drksde.tk/images/avatar2.png](http://drksde.tk/images/avatar2.png)

# python - 树莓派上的 GPS 守护进程

> ID：15167434
> 
> 赞同：0
> 
> 时间：2013-03-01T18:15:36.737
> 
> 标签：python, gps, raspberry-pi

我正在尝试实现 adafruit 为他们为树莓派设计的 gps 单元之一提供的示例脚本。代码如下：

===============

```
 import gps

    # Listen on port 2947 (gpsd) of localhost
    session = gps.gps("localhost", "2947")
    session.stream(gps.WATCH_ENABLE | gps.WATCH_NEWSTYLE)

    while True:
        try:
            report = session.next()
            # Wait for a 'TPV' report and display the current time
            # To see all report data, uncomment the line below
            # print report
            if report['class'] == 'TPV':
        if hasattr(report, 'time'):
            print report.time
        except KeyError:
            pass
        except KeyboardInterrupt:
            quit()
        except StopIteration:
            session = None
            print "GPSD has terminated" 
```

===============

所以我将“#!/usr/bin/python -tt”添加到“gps.py”文件的顶部，然后添加“chmod u+x /home/pi/gps.py”

但是，在运行此程序时，我收到以下错误，但我不明白为什么：

===============

```
 pi@raspberrypi ~ $ /home/pi/gps.py
    Traceback (most recent call last):
      File "/home/pi/gps.py", line 2, in <module>
        import gps
      File "/home/pi/gps.py", line 5, in <module>
        session = gps.gps("localhost", "2947")
    TypeError: 'module' object is not callable 
```

===============

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T22:03:09.590

尝试将您的脚本重命名为 gps.py 以外的名称。python 解释器正在尝试导入它，而不是位于某个系统库中的 gps.py 脚本。

# c# - 有没有办法将 ac# 类序列化为 xml 而无需在类上放置属性？

> ID：15167435
> 
> 赞同：1
> 
> 时间：2013-03-01T21:48:58.890
> 
> 标签：c#, xml, class, xmlserializer

我想序列化 ac# 类，但我不想将属性放在类上。我在 codeplex 上找到了 FluentXML，但它似乎只是一个创意项目，无论如何都无法正常工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:01:29.553

这是一个对我有用的例子。从[序列化对象到字符串](http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/5d08bc28-5b61-4c5a-8c4b-4665b1c929ea/)

我只是用谷歌搜索“将类序列化为 xml 字符串”

```
String XmlizedString = null;

XmlSerializer x = new XmlSerializer(objectNameHere.GetType());

MemoryStream memoryStream = new MemoryStream();

XmlTextWriter xmlTextWriter = new XmlTextWriter(memoryStream, Encoding.UTF8);

x.Serialize(xmlTextWriter, objectNameHere);

memoryStream = (MemoryStream)xmlTextWriter.BaseStream;

UTF8Encoding encoding = new UTF8Encoding();

XmlizedString = encoding.GetString(memoryStream.ToArray());

XmlizedString = XmlizedString.Substring(1); 
```

它产生了这样的字符串 `<?xml version="1.0" encoding="utf-8"?><Employee xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><Name>StackOverflow User</Name><Title>User of StackOverflow.</Title><Salary>70000</Salary><Skills><string>Being Awesome</string><string>Being sweet</string></Skills></Employee>`

从一个像这样简单的 Employee 类：

```
public class Employee
{
  public string Name { get; set; }
  public string Title { get; set; }
  public double Salary { get; set; }
  public Collection<string> Skills { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T21:53:30.427

没有什么会强迫您将属性放在您的类上以便使用`XmlSerializer`. 在这种情况下，生成的 XML 将简单地反映您的对象结构。另一方面，如果您想控制生成的 XML，您可以使用 a`XmlWriter`或 an`XDocument`来代替。但是这些属性正是为此目的而设计的，您应该使用它们。如果由于某种原因您无法修改您正在序列化的类（例如，因为您没有它的源代码），您总是可以设计一个不同的类，您可以用属性装饰它，然后将原始类映射到您的模型会序列化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T21:54:46.577

您可以使用`XmlSerializer`无属性并使用它为您提供的默认名称，或者您也可以`IXmlSerializable`在您的类上实现接口以获得更自定义但手动的输出，而无需使用属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T21:52:48.300

假设您有充分的理由不使用属性，则可以使用`XmlSerializer`，但请注意它仅适用于公共成员，并且还需要公共类型和无参数构造函数。

# octave - Octave: Solve Linear Systems 有很多解还是没有解？

> ID：15167436
> 
> 赞同：1
> 
> 时间：2013-03-01T21:49:08.697
> 
> 标签：octave, linear-algebra

1.  Octave 能否识别出没有解决方案的线性系统并就此发出信息？
2.  Octave 可以“求解”具有许多解的线性系统并描述解集吗？

这是对我没有帮助的 Octave 输出的两个示例。还有另一种方法可以向 Octave 询问所需的输出吗？

没有解决方案：

```
octave:13> A=[1,1,1;1,1,1] 
A =   
   1   1   1
   1   1   1   

octave:14> b=[0;1]
b =    
   0
   1

octave:15> A\b
ans =    
   0.16667
   0.16667
   0.16667 
```

无穷多解决方案：取自 ( [http://joshua.smcvt.edu/linearalgebra/book.pdf](http://joshua.smcvt.edu/linearalgebra/book.pdf) ) 2.13 (pg16)。

```
octave:19> M=[2,1,0,-1,0;0,1,0,1,1;1,0,-1,2,0]
M =   
   2   1   0  -1   0
   0   1   0   1   1
   1   0  -1   2   0

octave:20> n=[4;4;0]
n =    
   4
   4
   0

octave:21> M\n
ans =    
   0.761905
   2.380952
   0.571429
  -0.095238
   1.714286

Books Solution:
{ [x;y;z;w;u] = 
  [0; 4; 0; 0; 0] + [1; -1; 3; 1; 0]*w + [0.5; -1; 0.5; 0; 1]*u | w,u (R) 
}
OR
{ (w+(0.5)u, 4-w-u, 3w+(0.5)u, w, u) | w,u (R) } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T23:37:19.427

我不知道是否有任何内置函数可以检查您想要的内容，但对于您的第一个问题，您可以编写代码自行检查。您需要查看将增广矩阵放入行缩减梯形 (rref) 后是否发生了矛盾。您可以通过查看任何行是否所有变量都为 0 但常数不为 0 来做到这一点。这意味着 0*x1 + 0 *x2 + ... 0*xn 不等于 0（矛盾）。我相信以下代码可以检查这一点

```
%function [feasible, x] = isfeasible(A,b)
%checks if Ax = b is feasible (a solution exists)
%and returns the solution if it exits
%input
%A: M x N matrix representing the variables in each equation, with one equation per row
%b: N X 1 vector of the constants
%output
%feasible: 1 if a solution exists, 0 otherwise
%x: N x 1 vector containing the values of the variables
function [feasible, x] = isfeasible(A,b)
  feasible = 1; %assume function is feasible
  Rref = rref([A,b]); %put the augmented matrix into row reduced echelon form
  x = Rref(:,end); %these are the values that the variables should be to solve the set of equations
  variableSums = sum(abs(Rref(:,1:(end-1))),2);
  if(any((variableSums == 0) & (abs(x) ~= 0))) %a contradiction has occurred.
    feasible = 0; %this means that 0 * all the variables is not 0
  endif
endfunction 
```

至于你的第二个问题，如果将增广矩阵 [A,b] 放入行缩减梯队形式后，任何行的列（不包括最后一列）的非零值都超过 1 列，那么你的方程组不止一个解决方案。Octave 可以解决这个问题，并且可以表征这组解决方案。您所要做的就是 rref([A,b]) 并阅读您得到的解决方案。

在您的示例中使用 rref 我发现 rref([M,n]) =

```
 x         y         z         w         u      constant
   1.00000   0.00000   0.00000  -1.00000  -0.50000   0.00000
   0.00000   1.00000   0.00000   1.00000   1.00000   4.00000
   0.00000   0.00000   1.00000  -3.00000  -0.50000  -0.00000 
```

这表示

x = w + .5*u

y = 4 - w - u

z = 3*w + .5*u

# c# - 由没有泛型参数的类实现的具有泛型参数的转换接口

> ID：15167437
> 
> 赞同：0
> 
> 时间：2013-03-01T21:49:13.140
> 
> 标签：c#, generics, inheritance

我有两个接口，

```
public interface IDocument<SegType> where SegType : ISegment 
```

和

```
public interface ISegment 
```

基本上，我想强制实现`IDocument`的每个类都由一种类型组成`ISegment`，并且使用这些类的人永远不需要知道`ISegment`他们的类在内部使用哪种类型。

然后我创建了一个实现的类`IDocument<SegType> where SegType : ISegment`：

```
public class MyDocument : IDocument<MySegment> 
```

和相应的`MySegment`：

```
public class FffSegment : ISegment 
```

`MyDocument`当我指定为类型时，所有这些都会按照我期望的那样编译和工作。为什么我不能隐式地将实例强制`MyDocument`转换为类型`IDocument<Isegment>`？当我尝试这条线时：

```
IDocument<ISegment> doc = new MyDocument(); 
```

我得到错误

```
Cannot implicitly convert type 'MyDocument' to 'IDocument<ISegment>'. An explicit conversion exists (are you missing a cast?) 
```

但是当我施放它时，它只是返回为空。如果我将其更改为：

```
IDocument<MySegment> doc = new MyDocument(); 
```

它有效，就像我将类定义更改为

```
public class MyDocument : IDocument<ISegment> 
```

为什么我不能为 IDocument 的实现强制实现 ISegment 的特定类型？我想将此代码重新用于不同类型的代码，`IDocument`也许`ISegment`有一天某些实现`IDocument`将允许多种类型，`ISegment`但`MyDocument`应限制这种行为。我如何才能强制执行这些要求，但仍然编写足够通用的代码以供将来重用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T21:53:10.040

您需要了解共同反差的讨厌情况：

```
public interface IDocument<out SegType> where SegType : ISegment
{} 
```

我认为这应该使您的示例现在可以编译...

这里有一些阅读材料：

*   [http://blogs.msdn.com/b/csharpfaq/archive/2010/02/16/covariance-and-contravariance-faq.aspx](http://blogs.msdn.com/b/csharpfaq/archive/2010/02/16/covariance-and-contravariance-faq.aspx)
*   [http://msdn.microsoft.com/en-us/library/dd799517.aspx](http://msdn.microsoft.com/en-us/library/dd799517.aspx)
*   [http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)](http://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science))

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:55:17.660

因为`IDocument<MySegment>`不能直接转换为`IDocument<ISegment>`. 如果可以，您可以这样做：

```
IDocument<ISegment> doc1 = new IDocument<MySegment>;
doc1.Add(new MyOtherSegment());   // invalid 
```

（假设`IDocument<T>`有一个`Add(T newSegment)`方法）

仔细查看您的设计并确定泛型是否真的需要，或者仅使用`ISegment`within`IDocument`就足够了。

# php - 关联数组 - 改变位置

> ID：15167439
> 
> 赞同：6
> 
> 时间：2013-03-01T21:49:19.727
> 
> 标签：php

例如有这个数组：

```
[food] => Array (
    [fruits] => apple
    [vegetables] => garlic
    [nuts] => cashew
    [meat] => beaf
) 
```

我需要更改特定键值组合的位置。

假设我需要将 [fruits] => apple 移动到第三个位置

```
[food] => Array (
    [vegetables] => garlic
    [nuts] => cashew
    [fruits] => apple
    [meat] => beaf
) 
```

我不是在谈论按键或值排序。我需要将键值的位置更改为非常严格的新位置。

就像是：

```
change_pos($my_arr, $key_to_move, $new_index); 
```

=>

```
change_pos($my_arr, "fruits", 3); 
```

那可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T21:53:08.023

这很难，但最后：

```
<?php
function array_splice_assoc(&$input, $offset, $length, $replacement) {
        $replacement = (array) $replacement;
        $key_indices = array_flip(array_keys($input));
        if (isset($input[$offset]) && is_string($offset)) {
                $offset = $key_indices[$offset];
        }
        if (isset($input[$length]) && is_string($length)) {
                $length = $key_indices[$length] - $offset;
        }

        $input = array_slice($input, 0, $offset, TRUE)
                + $replacement
                + array_slice($input, $offset + $length, NULL, TRUE);
}
function array_move($which, $where, $array)
{
    $tmpWhich = $which;
    $j=0;
    $keys = array_keys($array);

    for($i=0;$i<count($array);$i++)
    {
        if($keys[$i]==$tmpWhich)
            $tmpWhich = $j;
        else
            $j++;
    }
    $tmp  = array_splice($array, $tmpWhich, 1);
    array_splice_assoc($array, $where, 0, $tmp);
    return $array;
}
$array = array('fruits' => 'apple','vegetables' => 'garlic','nuts' => 'cashew','meat' => 'beaf');
$res = array_move('vegetables',2,$array);
var_dump($res);
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T15:07:04.240

我要感谢 MIIB 的辛勤工作！我会接受他对辛勤工作的回答。

但我想出了一个更适合我的解决方案，我会使用它。

```
function ksort_arr (&$arr, $index_arr) {
    $arr_t=array();
    foreach($index_arr as $i=>$v) {
        foreach($arr as $k=>$b) {
            if ($k==$v) $arr_t[$k]=$b;
        }
    }
    $arr=$arr_t;
}

$arr=array("fruits"=>"apple","vegetables"=>"garlic","nuts"=>"cashew","meat"=>"beaf");
$index_arr=array("vegetables","meat","fruits","nuts");
ksort_arr($arr,$index_arr);
print_r($arr); 
```

结果

```
Array
(
    [vegetables] => garlic
    [meat] => beaf
    [fruits] => apple
    [nuts] => cashew
) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-04T07:18:07.150

这是使用第二个数组的更简单的解决方案。它还为新的索引参数提供了一些基本的验证。仅用于关联数组。与数值数组一起使用没有意义。

```
function array_move($key, $new_index, $array)
{
    if($new_index < 0) return;
    if($new_index >= count($array)) return;
    if(!array_key_exists($key, $array)) return;

    $ret = array();
    $ind = 0;
    foreach($array as $k => $v)
    {
      if($new_index == $ind)
      {
        $ret[$key] = $array[$key];
        $ind++;
      }
      if($k != $key)
      {
        $ret[$k] = $v;
        $ind++;
      }
    }
    // one last check for end indexes
    if($new_index == $ind)
        $ret[$key] = $array[$key];

    return $ret;
} 
```

# ruby-on-rails - Rails 范围 - 如何连接 3 个表

> ID：15167440
> 
> 赞同：3
> 
> 时间：2013-03-01T21:49:35.533
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有 3 张桌子：

```
schools{id, name, desc, adress}
reviews{id, content, rating, school_id, user_id} # user_id & schoold_id is foregin keys
users{id, name, city} 
```

我如何编写一个rails范围连接所有3个表并获取`schools.name`列`reviews.content``reviews.rating``users.name`

我正在使用导轨 3.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:23:31.200

```
scope :mashup, joins(:school, :user).select("content, rating, schools.name as sname, users.name as uname") 
```

[你可以在这里](http://apidock.com/rails/ActiveRecord/NamedScope/ClassMethods/scope)了解更多

# range - 按 id 和范围条件删除行？

> ID：15167441
> 
> 赞同：8
> 
> 时间：2013-03-01T21:49:44.700
> 
> 标签：range, amazon-dynamodb

我一直在寻找并寻找一种通过范围条件删除具有相同 ID 的项目的方法。Table.DeleteItem 的重载似乎都没有一个范围条件，只有一个范围。

是否有其他方法可以删除所有超过一小时的条目？

我宁愿不必检索所有匹配的哈希键行并通过特定范围键手动删除每一行。

我主要使用 .NET SDK，但任何提示都表示赞赏。

我看到了一些批量编写示例，但没有任何内容需要整个范围。

```
private static void SingleTableBatchWrite()
{
  Table productCatalog = Table.LoadTable(client, "ProductCatalog");
  var batchWrite = productCatalog.CreateBatchWrite();

  var book1 = new Document();
  book1["Id"] = 902;
  book1["Title"] = "My book1 in batch write using .NET Helper API";
  book1["ISBN"] = "902-11-11-1111";
  book1["Price"] = 10;
  book1["ProductCategory"] = "Book";
  book1["Authors"] = new List<string> { "Author 1", "Author 2", "Author 3" };
  book1["Dimensions"] = "8.5x11x.5";
  batchWrite.AddDocumentToPut(book1);
  // Specify delete item using overload that takes PK. 
  batchWrite.AddKeyToDelete(12345);
  Console.WriteLine("Performing batch write in SingleTableBatchWrite()");
  batchWrite.Execute();
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T03:07:03.920

DynamoDB 中不存在此功能。

您可以做的最好的事情是查询适当的项目并手动删除每个检索到的键。您可以通过在查询时仅询问您的哈希和范围键属性来节省带宽，但请注意，这不会节省读取容量；在返回项目属性的子集时，DynamoDB 仍会按项目的完整大小向您收费。

有些人通过为每个时间段（通常是一天而不是一个小时）制作一个单独的表格来解决这个时间问题。这样你就可以做一些有趣的事情：

*   通过删除表“免费”删除旧数据
*   将今天的表格缩放得比其他表格更高

由于 DynamoDB 的模型，这种“数据隔离”并不像看起来那么糟糕。需要获得物品吗？你已经有了时间范围键，所以你知道要问哪个表。需要查询吗？您的 Range 条件必须是基于时间的，因此您知道要询问哪些表格。

# c# - WinForm propertygrid Collection Editor 添加/删除按钮 非活动

> ID：15167443
> 
> 赞同：1
> 
> 时间：2013-03-01T21:50:05.040
> 
> 标签：c#, .net, winforms, propertygrid, collectioneditor

我正在使用通用属性网格来编辑几个自定义类的值。其中一些类有集合，我可以在集合编辑器中毫无问题地打开这些集合。如果集合已经包含对象，我可以选择这些对象并在右侧编辑它们，但“添加/删除”按钮处于非活动状态。

我知道其中一些集合需要自定义编辑器，因为它们非常复杂——但其中大多数都非常简单。是否有一种简单的方法可以激活这些简单类的添加/删除按钮，或者我是否需要为每个集合创建一个自定义编辑器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T07:36:21.960

要启用 Add 和 Remove 按钮，您需要集合来实现非通用[IList](http://msdn.microsoft.com/fr-fr/library/system.collections.ilist%28v=vs.80%29.aspx)接口，并且显然，属性[ReadOnly](http://msdn.microsoft.com/fr-fr/library/system.collections.ilist.isreadonly%28v=vs.80%29.aspx)必须返回`false`。

请注意，您需要对类进行显式实现，仅从本身派生自 IList（如`IList<Something>`）的类或接口派生将**不起作用**。

例如，以下是不行的：

```
public class MyStuffCollection : List<MyStuff>
{
} 
```

以下是可以的：

```
public class MyStuffCollection : List<MyStuff>, IList
{
} 
```

# php - 使用 PHP 将 _nested_ 数组插入 MySQL 数据库

> ID：15167447
> 
> 赞同：1
> 
> 时间：2013-03-01T21:50:21.163
> 
> 标签：php, mysql, arrays, insert, nested

我有一个这样的嵌套数组：

```
array(3) { 
[1]=> array(5) { 
    ["firstname"]=> string(2) "john" 
    ["name"]=> string(2) "dorian" 
    ["email"]=> string(2) "john@example.something" 
    ["sex"]=> string(1) "m" 
    ["size"]=> string(1) "L" } 
[2]=> array(5) { 
    ["firstname"]=> string(2) "Sam" 
    ["name"]=> string(2) "Stuard" 
    ["email"]=> string(2) "sammy@some.thing" 
    ["sex"]=> string(1) "m" 
    ["size"]=> string(1) "S" } 
[3]=> array(5) { 
    ["firstname"]=> string(2) "vanessa" 
    ["name"]=> string(2) "sherbatzky" 
    ["email"]=> string(2) "vanessa@bla.bla" 
    ["sex"]=> string(1) "w" 
    ["size"]=> string(3) "S" } } 
```

最外层数组（ [1], [2], [3] ）的数量可以改变。

我尝试过类似的东西

```
$columns = implode(", ",array_keys($insData));
$escaped_values = array_map('mysql_real_escape_string', array_values($insData));
$values  = implode(", ", $escaped_values);
$sql = "INSERT INTO `user`($columns) VALUES ($values)"; 
```

但我没明白。：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:10:22.090

这些[`mysql_`功能已弃用](http://php.net/mysql_query)。请不要将它们用于任何新代码。使用[`mysqli`](http://www.php.net/manual/en/book.mysqli.php)或[`PDO`](http://www.php.net/manual/en/book.pdo.php)。

您需要遍历数组，并一次插入一行。您可以为多行插入构造一个（准备好的）语句，但如果您是数据库新手，最好从基础开始，然后从那里开始构建。

```
// Create a new connection, see the manual on the details
$conn = new PDO(/* see PHP manual for the params*/);

// Start a new transaction. All MySQL storage engines don't support transactions,
// so this step might be superfluous. Check your schema definition and the 
// MySQL manual.
$conn->beginTransaction()

// Create a prepared statement
$stmt = $conn->prepare("INSERT INTO user (firstname, name, email, sex, size) VALUES (:firstname, :name, :email, :sex, :size)");

try {
    foreach ($insData as $dataset) {
        foreach ($dataset as $colname => $value) {
            // Bind values for the placeholders in the prepared statement
            $stmt->bindValue(":" . $colname, $value);
        }

        // Run your query
        $stmt->execute();
    }

    // Commit the changes pending in the transaction
    $conn->commit();
} catch (PDOException $e) {
    // Rollback all statements in the transaction on errors
    $conn->rollback();
} 
```

如果您需要动态创建整个语句，这也是可能的。它只需要一个额外的步骤来创建查询的列部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:00:54.863

```
$columns = array_keys($insData[0]);
$values = "";
foreach($insData as $data)
   $values.= "(".$data['firstname'].",".$data['name'].",etc ."),"; 
```

省略插入值部分中的括号

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T22:02:36.570

```
$columns = array();
$values = array();    

foreach($insData as $row)
{
    foreach($row as $columnName => $columnValue)
    {
        $columns[] = $columnName;
        $values[] = $columnValue;
    }

    // Build query
    $query = "INSERT INTO `user` (" . implode(",", $columns) . ") VALUES (" . implode(",", $values) . ")";

    // DO INSERT HERE (PREFERABLY WITH PDO OR MYSQLI)   

    // Reset columns/values
    $columns = array();
    $values = array(); 
} 
```

# postscript - 如何在后记中包含 img

> ID：15167454
> 
> 赞同：6
> 
> 时间：2013-03-01T21:51:09.327
> 
> 标签：postscript

我想将图像添加到我的 postscript 代码中

```
%!PS-Adobe-3.0

/Times-Roman findfont
12 scalefont setfont

50 700 moveto
(text) show
showpage 
```

但我不知道这样做。有人帮忙吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-03T08:26:43.713

## ;tldr

跳到中间，从**更简单的工作流程**开始阅读到最后。

## 转换为 xbm，用 vi 破解，用内联数据`{currentfile} image`

它记录在*Postscript Language Reference Manual*中，但信息可能有点难以消化。

正如 Ken 所说，您需要使用`image`运算符。我通常选择“老派”形式，即

> 宽度高度位每像素矩阵 proc   **图像**   -</p>

对于一些随机图像文件，您通常希望使用`convert`ImageMagick 之类的东西来获取文本格式。当然，您也可以将其转换为 eps，但要学习，您必须将手指伸入其中。

```
% convert image.png image.xbm 
```

这将为您提供如下文件：

```
 1 #define glasses_width 320
  2 #define glasses_height 240
  3 static char glasses_bits[] = {
  4   0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  5   0x00, 0x00, 0x00, 0x00, 0x45, 0x65, 0xDB, 0x65, 0xB5, 0x6F, 0xBF, 0xEF,
  6   0xFF, 0xFF, 0xFF, 0xBF, 0xB5, 0xED, 0x3C, 0xBF, 0xB3, 0xDB, 0xAD, 0xF6,
  7   0xE6, 0x4A, 0xAA, 0xBA, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00,
  8   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x99, 0xA8, 0x66, 0xD6,
  9   0xDF, 0xF9, 0xF7, 0xBF, 0xFF, 0xFD, 0xFF, 0xFE, 0xFF, 0x7F, 0xFB, 0xEA,
 10   0xDD, 0x5A, 0x9A, 0x69, 0xB9, 0xBE, 0x55, 0x65, 0x00, 0x00, 0x00, 0x00,
...
803   0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
804   }; 
```

所以，在 vi 中，做一些事情，比如

```
:%s/^#/%#/         #comment-out the #defines
:g/[{}]/d          #delete the array brackets
:%s/0x//g          #remove the 0x prefixes
:%s/, //g          #remove the spaces 
```

给出这样的东西：

```
 1 %#define glasses_width 320
  2 %#define glasses_height 240 
  3   000000000003000000000000
  4   000000004565DB65B56FBFEF
  5   FFFFFFBFB5ED3CBFB3DBADF6
  6   E64AAABA0000000000020000
  7   000000000000000099A866D6
  8   DFF9F7BFFFFDFFFEFF7FFBEA
  9   DD5A9A69B9BE556500000000
 10   000C00000000000000000000
...
802   000000000000000000000000 
```

然后你在`image`调用中使用数字，也修剪这些行，并直接在这些行之后插入数据

```
%width height depth [ x-scale x-skew y-skew y-scale x-offset y-offset ]=matrix 
320    240    1     [ 1       0      0      -1      0        240 ]
%  {proc-yielding-string-data}                  call(image)
   { currentfile 80 string readhexstring pop }  image 
```

这假设您的位图数据的 y 向下增加。这种方法可以针对其他 ascii 格式进行调整，只要您可以获得某种原始样本的转储。用解码器代码嵌入压缩图像是一大堆蠕虫，我建议你暂时避免。（主要是因为我还不知道该怎么做。我一直在避免它，就像一个大罐头蠕虫一样。：D）

* * *

我检查了上面的建议，我忘记了一个很大的障碍。Postscript 喜欢它的大端字节位图。也就是说，第 7 位是*最左边*的，而第 0 位是*最右边*的位。这与 xbm 格式相反。所以，上面介绍的完整程序是：

```
%!
%reverse the bits in a byte
/reverse {               % b
    dup 1 and            % b b0          % explode the bits
    1 index 2 and        % b b0 b1
    2 index 4 and        % b b0 b1 b2
    3 index 8 and        % b b0 b1 b2 b3
    4 index 16 and       % b b0 b1 b2 b3 b4
    5 index 32 and       % b b0 b1 b2 b3 b4 b5
    6 index 64 and       % b b0 b1 b2 b3 b4 b5 b6
    8 7 roll 128 and     % b0 b1 b2 b3 b4 b5 b6 b7
    -7 bitshift exch     % b0 b1 b2 b3 b4 b5 b7-7=0' b6  % shift and combine
    -5 bitshift or exch  % b0 b1 b2 b3 b4 b0'|b6-5=1' b5
    -3 bitshift or exch  % b0 b1 b2 b3 b0'|b1'|b5-3=2' b4
    -1 bitshift or exch  % b0 b1 b2 b0'|b1'|b2'|b4-1=3' b3
    1 bitshift or exch   % b0 b1 b0'|b1'|b2'|b3'|b3+1=4' b2
    3 bitshift or exch   % b0 b0'|b1'|b2'|b3'|b4'|b2+3=5' b1
    5 bitshift or exch   % b0'|b1'|b2'|b3'|b4'|b5'|b1+5=6' b0
    7 bitshift or        % b0'|b1'|b2'|b3'|b4'|b5'|b6'|b0+7=7'
} def

320 240 1  % width height bitdepth
[ 1 0 0 -1 0 240 ]  % 1-to-1 matrix with descending y, offset by max_y
{ %proc-yielding-string
    currentfile 80 string  % file string
    readhexstring pop  % string         read a line of hex data from THIS FILE
    0 1 2 index length 1 sub  % string 0 1 strlen-1
    {  % string index
        2 copy 2 copy  % str i str i str i
        get reverse    % str i str i rev(str_i)
        put  % str' i
        pop % str'                      % reverse each char (byte)
    } for                               % loop over chars in string
} image
  000000000003000000000000
  000000004565DB65B56FBFEF
  FFFFFFBFB5ED3CBFB3DBADF6
  E64AAABA0000000000020000
  000000000000000099A866D6
  DFF9F7BFFFFDFFFEFF7FFBEA
  ... 
```

完整程序可[在此处](http://web.archive.org/web/20160404161524/https://code.google.com/p/xpost/downloads/detail?name=glasses.ps&can=2&q=)附加完整图像数据。

* * *

## 更简单的工作流程

更简单但仍然“动手”的是转换为`pbm`使用与 postscript 相同的位排序约定。然后`xxd -ps`会产生一个“后记”hexdump。以下三个示例均使用这种方式准备的十六进制数据。但是这个方法还是需要你手动测量header的长度（`xxd`用来查找width和height后面的whitespace-char后面的字节偏移量）。

```
%!
% swar.ps
%
%image example
%image origin:  http://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Spacewar%21-PDP-1-20070512.jpg/320px-Spacewar%21-PDP-1-20070512.jpg
%
% bash commands to prepare image file:
%
% $ wget http://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Spacewar%21-PDP-1-20070512.jpg/320px-Spacewar%21-PDP-1-20070512.jpg
% $ identify 320px-Spacewar\!-PDP-1-20070512.jpg 
% $ convert 320px-Spacewar\!-PDP-1-20070512.jpg spacewar.pbm
% $ xxd -ps spacewar.pbm > spacewar.asc
% % gs swar.ps

/infile (spacewar.asc)(r)file def
/buf 256 string def

% use $ xxd spacewar.pbm | head
% to find the length of the header and read that length
% into the buffer and discard, leaving only samples.
infile buf 0 16#5d getinterval readhexstring pop pop 

320 215 1
[ 1 0 0 -1 0 215 ]
{ infile buf readhexstring pop } image

showpage 
```

这`spacewar.asc`是同样丑陋的裸十六进制样本块。

```
$ head spacewar.asc
50340a2346696c6520736f757263653a20687474703a2f2f636f6d6d6f6e
732e77696b696d656469612e6f72672f77696b692f46696c653a53706163
65776172212d5044502d312d32303037303531322e6a70670a3332302032
31350a007fffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffff007fffffffffffffffffffffffdfffffff
ffffffffffffffffffffffffffffffffffffffffffffff007fffffffffff
ffffffffffff803fffffffffffffffffffffffffffffffffffffffffffff
ffffff007ffffffffffffffffffffffff800ffffffffffffffffffffffff
ffffffffffffffffffffffffff007fffffffffffffffffffffff7fe007ff
ffffffffffffffffffffffffffffffffffffffffffffff007fffffffffff 
```

只要解释器​​（或蒸馏器）没有设置 SAFER 选项，这个样本块就可以留在外部，因为这会禁用文件访问操作符。

也可以在图像调用后内联，`currentfile`如上所示。

```
%!
/buf 256 string def

320 215 1
[ 1 0 0 -1 0 215 ]
{ currentfile buf readhexstring pop }
{ 
    infile buf 0 16#5d getinterval readhexstring pop pop  % discard header
    image 
} exec
50340a2346696c6520736f757263653a20687474703a2f2f636f6d6d6f6e
732e77696b696d656469612e6f72672f77696b692f46696c653a53706163
65776172212d5044502d312d32303037303531322e6a70670a3332302032
31350a007fffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffff007fffffffffffffffffffffffdfffffff
ffffffffffffffffffffffffffffffffffffffffffffff007fffffffffff
ffffffffffff803fffffffffffffffffffffffffffffffffffffffffffff
ffffff007ffffffffffffffffffffffff800ffffffffffffffffffffffff
ffffffffffffffffffffffffff007fffffffffffffffffffffff7fe007ff
ffffffffffffffffffffffffffffffffffffffffffffff007fffffffffff
%... 
```

或者，只要数据小于 64k，您就可以将其 slurp 成一个字符串。[注意：这是对字符串大小的历史实现限制。我被告知当前版本的 ghostscript 可以很好地处理更大的字符串。] 如果您想在文档中多次重复使用图像，这很有用。

```
%!
/imgbuf 320 215 mul 8 div ceiling cvi string def   % create a string for byte storage (<64k)

{ 
    currentfile imgbuf 0 16#5d getinterval readhexstring pop pop  % read header
    currentfile imgbuf readhexstring pop pop                 % read data (discarding header data)
} exec
50340a2346696c6520736f757263653a20687474703a2f2f636f6d6d6f6e
732e77696b696d656469612e6f72672f77696b692f46696c653a53706163
65776172212d5044502d312d32303037303531322e6a70670a3332302032
31350a007fffffffffffffffffffffffffffffffffffffffffffffffffff
ffffffffffffffffffffffffff007fffffffffffffffffffffffdfffffff
ffffffffffffffffffffffffffffffffffffffffffffff007fffffffffff
ffffffffffff803fffffffffffffffffffffffffffffffffffffffffffff
ffffff007ffffffffffffffffffffffff800ffffffffffffffffffffffff
ffffffffffffffffffffffffff007fffffffffffffffffffffff7fe007ff
ffffffffffffffffffffffffffffffffffffffffffffff007fffffffffff
%...

320 215 1
[ 1 0 0 -1 0 215 ]
{ imgbuf }
image 
```

* * *

## 我之前忽略的一点（矩阵参数）......

在上述所有代码中，我对 PLRM 的解释非常自由。基本上忽略了一些常见的建议，因为它通常（根据我的经验）只会妨碍理解这个过程，但在这里......

使用运算符的推荐方法是使用与`image`上述不同类型的矩阵。该矩阵实际上被`image`算子解释为*逆*映射。也就是说，按比例*放大*会使数字*变小*，按比例*缩小*会使数字*变大*。您打算使用它的方式是（修改上面的最后一个示例，因为它是本示例中最短且经过充分考虑的示例，即假设`imgbuf`已如上所述填充`readhexstring`）。这个调用应该*更恰当*地写成：

```
320 215 scale  % scale 1x1 image to proper dimensions
320 215 1          % "data" dimensions: w h bit-depth
[ 320 0 0 -215 0 215 ]              % inverse mapping
{ imgbuf }   % data-acquisition (yield data in a string)
image 
```

也就是说，矩阵将图像*反转*（这里是“扭曲”的诗意意义，而不是技术意义）成一个 1-unit-X-1-unit 正方形，这允许（要求）您*缩放坐标-系统*来获得图像的每像素 1pt 渲染。正确的方法为您提供了更大的灵活性：您现在可以`320 215 scale`进行合理的缩放计算——如果您只想要一个 1 像素到 1 点的映射，则以重复自己为代价。

*要使用正确的*代码将图像的尺寸加倍，只需`320 215 scale`用`640 430 scale`（或添加`2 2 scale`）替换即可。

```
320 215 scale
2 2 scale % == 640 430 scale
320 215 1                           % w h bit-depth
[ 320 0 0 -215 0 215 ]              % inverse mapping
{ imgbuf }   % data-acquisition
image 
```

但是使用*hackish*方式，您实际上必须将矩阵*减半才能获得增长的**倒数*。:D

```
320 215 1
[ .5 0 0 -.5 0 430 ] % "doubled,inverted (ie. halved) with double-offset" matrix
{ imgbuf }
image 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T22:08:20.640

请参阅 PostScript 语言参考手册，这不是一个简单的主题，您需要仔细阅读。从第 4.10 节开始，至少阅读处理类型 1 图像的部分（4.10.1 到 4.10.5）。

这是一个简单的例子：

```
/OneComponentString <007ff700> def

/OneComponentImage1
{
<<
/ImageType 1
/Width 2
/Height 2
/ImageMatrix [2 0 0 -2 0 2]
/BitsPerComponent 8
/Decode [0 1]
/DataSource OneComponentString
>>
} bind def

gsave
0 0 moveto
20 20 scale
/DeviceGray setcolorspace
OneComponentImage1 image
grestore

showpage 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-05T23:48:00.987

我会建议一种简单的方法 - 运行 EPS 文件。
首先，将图像转换为 EPS，例如。*myimage.eps*，将其保存在*myfolder*中，然后修改您的代码以定义***placeEPS***运算符并使用它显示*myimage.eps 。*

```
%!PS-Adobe-3.0

% Place EPS image definition
% Syntax: <file> <scale> <x> <y> placeEPS
% =============================================================
/placeEPS 
{
    userdict begin

    /__be_state     save            def
    /__ds_count     countdictstack  def
    /__os_count     count 5 sub     def
    /showpage       {}              def

    initgraphics
    translate 
    dup scale 
    run

    count           __os_count sub  { pop } repeat
    countdictstack  __ds_count sub  { end } repeat
                    __be_state              restore
    end
} bind def
% =============================================================

% Your old code starts here
/Times-Roman findfont
12 scalefont setfont
50 700 moveto
(text) show

% Now mark myimage.eps scaled to 100% at position 100, 100
(myfolder/myimage.eps) 1 100 100 placeEPS

showpage 
```

现在通过 Acrobat Distiller 或 GhostScript 转换为 PDF。
您还可以使用此方法将整页画布放置到文档中。

# c# - 在 form1.cs 和 program.cs 之间传递数据

> ID：15167467
> 
> 赞同：5
> 
> 时间：2013-03-01T21:52:21.277
> 
> 标签：c#, winforms

我知道这真的很基础，但我找不到任何关于如何在 MSDN、Google 搜索和 stackoverflow 之间执行此操作的指南/教程。

我创建了一个新的 Windows 窗体应用程序，在这里我有 Program 和 Form1，其中 Form1 拥有 2 个文本框和按钮。

Button1 应该从 Text1 中获取字符串并将其发送到 program.cs，在那里字符串被编辑并发送回 Form1。然后 Button2 显示 Text2 中的新字符串。

我已经从 Text1（使用 Button1）获取字符串，但无法弄清楚如何将其发送到 program.cs 以便对其进行处理。我到底应该怎么做才能在两者之间传递数据？

我不确定这是否是正确的开始，但我创建了一个 myForm 以尝试将字符串发送过来。但是我怎么寄回去呢？

在 Program.cs 中：

```
static Form1 myForm;
[STAThread]
static void Main()
{

    string s1, s2;
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    myForm = new Form1();
    Application.Run(myForm);
    s1 = myForm.sendOver();

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T21:55:15.033

你实际上不能。 `Application.Run(myForm);`将阻塞直到您的表单关闭，因此不再适合从中获取数据或向其提供数据。

在几乎所有 winform 程序中，您都不应该修改 program.cs。虽然你偶尔可以让它工作，但从设计的角度来看，它很少是可取的。

如果您想根据 from 的结果进行处理，您很可能应该创建一个全新的类，与其中任何一个分开。在适当的时候（这可能是单击提交按钮时，在表单关闭事件处理程序中等）调用该类的方法（如果合适，创建它的实例）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T22:25:42.787

不久前，我回答了一个老问题，询问如何在两种不同形式之间传递数据。答案也适用于您的情况。只需选择适合您需求的那一款即可。

1-（如果参数太多，不推荐）通过构造函数传递数据。

```
 private void ShowForm(int a, string b, double c)
{
    Form2 frm = new Form2(a, b, c);
    frm.ShowDialog();
} 
```

2-使用目标类的公共字段。（完全不推荐）

```
 private void ShowForm(int a, string b, double c)
{
    Form2 frm = new Form2();
    frm.intval = a;
    frm.strval = b;
    frm.doubleval = c;
    frm.ShowDialog();
} 
```

3-使用属性。

```
 private void ShowForm(int a, string b, double c)
{
    Form2 frm = new Form2();
    frm.IntValue = a;
    frm.StringValue = b;
    frm.DoubleValue = c;
    frm.ShowDialog();
} 
```

4-使用标签。

```
private void ShowForm(int a, string b, double c)
{
        Form2 frm = new Form2();
        frm.SomeTextBox.Tag = a;
        frm.SomeTextBox2.Tag = b;
        frm.SomeTextBox3.Tag = c;
        frm.ShowDialog();
} 
```

5-使用代表。（这个有点棘手）。

```
 //in Form2
public delegate void PassValues(int a, string b, double c);
public PassValues passVals;

private void PassDataThroughDelegate(int a, string b, double c)
{
    if(passVals != null)
        passVals(a,b,c);
}

//in Form1
private void ShowForm(int a, string b, double c)
{
    Form2 frm = new Form2();
    frm.passVals = new Form2.PassValues(UseData);
    frm.ShowDialog();
}

private void UseData(int a, string b, double c)
{
} 
```

我个人最喜欢的是属性、委托以及在极少数情况下的构造函数。

或者，您可以创建一个静态类，将一些属性放入其中，然后以其他形式使用它。如果您的所有表单都需要共享一些信息，这将非常有用。由于这不是在表单之间传递数据的方法，因此我在上面没有提到这种方法。

## 更新

上面列出了在两个类之间传递数据的方法（在本例中为表单）。但是，在阅读了您的问题和评论后，我可以推荐这个：

### 对于这种特殊情况：

1.  在 Visual Studio 中打开表单设计器。
2.  双击按钮 1。（这将为 button1 的点击事件生成一个事件处理程序）。
3.  像这样填充函数：

    ```
    private void button1_Click(object sender, EventArgs e)
    {
        textBox2.Text = ChangeString(textBox1.Text);
    }

    private string ChangeString(string str)
    {
        string result = "do some stuff to " + str;
        return result;
    } 
    ```

这里的`ChangeString`功能本质上是做你想做的`Program.cs`事。只需将您的功能添加到它。如果您希望它做的事情更复杂，您可以创建一个类并将功能添加到该类。

### 我给你的一般建议是：

我认为您应该参加一些 OO（面向对象）课程或阅读一些书籍。在实际执行之前，您应该熟悉 OO 的概念并计划您应该执行的操作。此外，您应该了解 .Net 和 C# 的内层，并了解程序每个部分的用途。我会先使用控制台应用程序，然后再使用 Winforms 和其他 UI 原则。

也就是说，我应该很快说，`Program.cs`它只是作为您的程序的入口点。您不应该尝试向该类添加逻辑并尝试将每个类的实现保留给它自己。尝试将每个类可以做的事情分开，以避免复杂的设计。

我希望这可以帮助您入门。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-01T22:09:09.287

```
static Form1 myForm;
[STAThread]

//we need a holder
//you can access static classes from your forms
public static class myCls {
    public static string myStr;
    static void myFunc(string str) {
        myStr = str; //or whatever
    }
}

static void Main()
{

    //string s1, s2;  //you don't need these
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    myForm = new Form1();
    Application.Run(myForm);
    //s1 = myForm.sendOver(); //you won't use this

} 
```

您的 form1 必须包含：

```
//change your holder's content whereever you want
void Button1_Click() {
    myCls.myFunc("string");
} 
```

您的 form2 必须包含：

```
//then call your holder's content whereever you want
void Button1_Click() {
    Text1.Text = myCls.myStr;
} 
```

# java - Groovy：如何解析 xml 并保留命名空间和 schemaLocations

> ID：15167468
> 
> 赞同：6
> 
> 时间：2013-03-01T21:52:24.853
> 
> 标签：java, groovy

我正在尝试使用 groovy 将节点简单地添加到特定位置的 a 。我的源架构看起来像这样

```
<s1:RootNode
   xmlns:s1="http://localhost/s1schema"
   xmlns:s2="http://localhost/s2schema"
   xsi:schemaLocation="http://localhost/s1schema s1schema.xsd 
   http://localhost/s2schema s2schema.xsd">
 <s1:aParentNode>
  <s2:targetNode>
   <s2:childnode1 />
   <s2:childnode2 />
   <s2:childnode3 />
   <s2:childnode4 />
 </s2:targetNode>
</s1:aParentNode>
</s1:RootNode> 
```

我想简单地添加一个与其他子节点内联的新子节点以进行输出

```
<s1:RootNode
    xmlns:s1="http://localhost/s1schema"
    xmlns:s2="http://localhost/s2schema"
    xsi:schemaLocation="http://localhost/s1schema s1schema.xsd 
    http://localhost/s2schema s2schema.xsd">
 <s1:aParentNode>    
   <s2:targetNode>
     <s2:childnode1 />
     <s2:childnode2 />
     <s2:childnode3 />
     <s2:childnode4 />
     <s2:childnode5 >value</s2:childnode5>
   </s2:targetNode>
  </s1:aParentNode>
 </s1:RootNode> 
```

为此，我有以下简单的 groovy 脚本

```
 def data = 'value'
def root = new XmlSlurper(false,true).parseText( sourceXML )
        root.'aParentNode'.'topNode'.appendNode{
            's2:childnode5' data
        }
groovy.xml.XmlUtil.serialize(root); 
```

但是，当我这样做时，将删除应用于根节点的名称空间和 schemaLocations。和命名空间，但不是模式位置被添加到每个子节点。

这导致下游的验证问题。

我如何简单地处理这个 xml。不执行验证并保留 xml 并添加我指定的命名空间的单个节点？

注意：我们处理许多消息，我不会事先知道最外层的命名空间（上例中的 s1），但即便如此，我真的只是在寻找一种对 xml 进行“愚蠢”处理的技术

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:57:52.090

首先，我必须添加 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 来定义您的 xsi 命名空间。如果没有它，我将收到未绑定 xsi 前缀的 SAXParseException。

此外，我在成功地将命名空间 xml 节点附加到现有文档时咨询了这个[问题。](https://stackoverflow.com/questions/7912987/groovy-append-an-xml-node-to-an-existing-xml-document)

最后，我们必须利用 StreamingMarkupBuilder 来解决命名空间的移动问题。基本上，默认情况下，序列化程序将引用的命名空间移动到实际使用命名空间的第一个节点。在您的情况下，它将您的 s2 命名空间属性移动到“targetNode”标签。以下代码会产生您想要的结果，但您仍然必须知道用于实例化 StreamingMarkupBuilder 的正确命名空间。

```
 def root = new XmlSlurper(false, true).parseText( sourceXML )
 def data = '<s2:childnode5 xmlns:s2="http://localhost/s2schema">value</s2:childnode5>'
 def xmlFragment = new XmlSlurper(false, true).parseText(data)
 root.'aParentNode'.'targetNode'.appendNode(xmlFragment);

 def outputBuilder = new StreamingMarkupBuilder()
 String result = XmlUtil.serialize(outputBuilder.bind {
     mkp.declareNamespace('s1':"http://localhost/s1schema")
     mkp.declareNamespace('s2':"http://localhost/s2schema")
     mkp.yield root }
 ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-25T17:19:08.487

如果您设置构造函数的第二个参数，则 XMLSlurper（或 XMLParser）不处理命名空间：

```
XmlSlurper (boolean validating, boolean namespaceAware) 
```

为假：

```
def root = new XmlSlurper(false, false).parseText( sourceXML ) 
```

如果没有将 namespaceAware 设置为 false，我还面临解析器的奇怪行为。设置为 false 后，它将保持 XML 不变，不更改名称空间。

# ruby - Ruby DNSSD Bonjour IP 地址发现

> ID：15167479
> 
> 赞同：2
> 
> 时间：2013-03-01T21:53:25.980
> 
> 标签：ruby, sockets, bonjour, dns-sd

背景

我正在尝试使用 Ruby DNSSD 来发现一些设备的 IP 地址。

我的代码将正确发现设备的名称。我尝试使用 NAME.local 访问设备。我试过这个方法：[https ://github.com/jmitchener/ruby-dnssd-test/blob/master/main.rb](https://github.com/jmitchener/ruby-dnssd-test/blob/master/main.rb)

*   我如何找到他们的 IP 地址？或者
*   使用主机名访问这些设备？

更新

我向自己证明了我的理论，即 Socket 命令没有搜索 /etc/hosts 文件

我手动将我的三个 redeye 设备添加到 /etc/hosts 文件中，并且能够解析 IP 地址。

/etc/hosts

```
192.168.69.77   RedEye_B0105-92646.local.
192.168.69.75   RedEye_E0103-85245.local.
192.168.69.76   RedEye_B0104-99552.local. 
```

代码

```
 @@reIP = Hash.new
  DNSSD.browse '_tf_redeye._tcp' do |reply|
    puts reply.name
    addr = Socket.getaddrinfo(reply.name + ".local.", nil, Socket::AF_INET)
    @@reIP[reply.name] = addr
    puts @@reIP
  end 
```

输出

```
RedEye_B0105-92646
{"RedEye_B0105-92646"=>[["AF_INET", 0, "192.168.69.77", "192.168.69.77", 2, 1, 6], ["AF_INET", 0, "192.168.69.77", "192.168.69.77", 2, 2, 17], ["AF_INET", 0, "192.168.69.77", "192.168.69.77", 2, 3, 0]]}
RedEye_E0103-85245
{"RedEye_B0105-92646"=>[["AF_INET", 0, "192.168.69.77", "192.168.69.77", 2, 1, 6], ["AF_INET", 0, "192.168.69.77", "192.168.69.77", 2, 2, 17], ["AF_INET", 0, "192.168.69.77", "192.168.69.77", 2, 3, 0]], "RedEye_E0103-85245"=>[["AF_INET", 0, "192.168.69.76", "192.168.69.76", 2, 1, 6], ["AF_INET", 0, "192.168.69.76", "192.168.69.76", 2, 2, 17], ["AF_INET", 0, "192.168.69.76", "192.168.69.76", 2, 3, 0]]}
RedEye_B0104-99552
{"RedEye_B0105-92646"=>[["AF_INET", 0, "192.168.69.77", "192.168.69.77", 2, 1, 6], ["AF_INET", 0, "192.168.69.77", "192.168.69.77", 2, 2, 17], ["AF_INET", 0, "192.168.69.77", "192.168.69.77", 2, 3, 0]], "RedEye_E0103-85245"=>[["AF_INET", 0, "192.168.69.76", "192.168.69.76", 2, 1, 6], ["AF_INET", 0, "192.168.69.76", "192.168.69.76", 2, 2, 17], ["AF_INET", 0, "192.168.69.76", "192.168.69.76", 2, 3, 0]], "RedEye_B0104-99552"=>[["AF_INET", 0, "192.168.69.76", "192.168.69.76", 2, 1, 6], ["AF_INET", 0, "192.168.69.76", "192.168.69.76", 2, 2, 17], ["AF_INET", 0, "192.168.69.76", "192.168.69.76", 2, 3, 0]]} 
```

现在的问题是，为什么 Socket 命令没有在 /etc/hosts 文件中搜索 IP 解析
1。AVAHI 和/或 DNSSD 没有缓存地址，因为它们是由 DNSSD.browse 报告的，可能是配置设置
2。我没有正确安装或配置 mDNS 服务器
3\. 其他有冲突的东西，例如 DNSMASQ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T10:22:09.390

DNS-SD 浏览操作的结果是 DNS-SD 服务名称，而不是主机名。

要从服务名称到连接，您需要使用服务名称、服务域（不要硬编码“.local”）和接口号（如果 Ruby 包装器提供它）启动 DNS-SD 解析操作，与提供给的完全相同浏览回调。

如果解析操作成功，它将返回服务的主机名、端口（可能不是众所周知的端口）和一组包含元信息（特定于服务）的键值对，然后您可以使用它们来建立连接.

编辑：

换句话说，您还没有完成链接示例的[这一部分](https://github.com/jmitchener/ruby-dnssd-test/blob/master/main.rb#L19-L27)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T13:30:04.120

在故障排除过程中，我故意硬编码附加`.local.`到名称中。我删除并重新安装了 avahi 和 dnssd gem，我的代码现在可以解析 IP 地址，而无需在`/etc/hosts`文件中定义主机。我现在得到了我想要的东西，一个只有名称和 IP 地址的哈希。

代码

```
 @@reIP = Hash.new
  DNSSD.browse '_tf_redeye._tcp.' do |reply|
    addr = Socket.getaddrinfo(reply.name + ".local.", nil, Socket::AF_INET)
    @@reIP[reply.name] = addr[0][2]
  end 
```

产生的哈希

```
{"RedEye_B0105-92646"=>"192.168.69.77", "RedEye_B0104-99552"=>"192.168.69.76", "RedEye_E0103-85245"=>"192.168.69.75"} 
```

# c# - 如何为 ASP.NET Web 应用程序实现事件记录器？

> ID：15167488
> 
> 赞同：1
> 
> 时间：2013-03-01T21:53:39.190
> 
> 标签：c#, asp.net, sql-server-2008, web-applications, event-log

我有一个用 C# 编写的 ASP.NET Web 应用程序。它使用 SQL Server 2008 数据库。似乎某些 SQL 查询使 SQL Server 死锁，而且我的 SQL Server 性能也很差。为了找出哪个，我想添加一个诊断事件日志记录，但我不确定如何。如果我正在编写一个普通的 Windows 应用程序，我会使用 Windows 事件日志，或者只使用一个简单的文本文件。所以我很好奇，如何从 Web 应用程序中做同样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T21:55:43.600

从 ASP.Net Web 应用程序进行日志记录有很多选项。

[NLog](http://nlog-project.org/)是值得考虑的一个，因为它性能良好，并根据严重性提供了广泛的日志目标，包括文本文件、数据库、电子邮件或 GUI 日志查看器，如[Sentinel](http://sentinel.codeplex.com/)。

话虽如此，应用程序级日志记录可能不是专门诊断 SQL Server 死锁的最佳方法。我建议从 SQL Server Profiler 开始执行该任务

[使用 SQL Server Profiler 分析死锁](http://msdn.microsoft.com/en-us/library/ms188246%28v=sql.100%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T21:59:20.117

.NET从2.0版本开始就内置了功能丰富、配置灵活的登录系统。您可以从[MSDN 上的这篇文章](http://msdn.microsoft.com/en-us/library/ms228993.aspx)开始。 尽管出于某种原因，大多数人不使用它，而是更喜欢使用 Log4net 或 NLog 进行日志记录。首先是java日志工具的移植，其次是重新思考。我个人更喜欢将 TraceSource 与过滤器一起使用。ADO.NET 本身也支持它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T22:21:56.057

死锁发生在 SQL 端，ASP.NET 不可能了解全貌。

我建议检查您的查询是否有 WITH LOCK 语句，然后在删除它之前弄清楚它为什么会出现。

否则，如果您通过 SQL 服务器诊断管理器发现有问题的查询......或者如果您可以纯粹在 SQL 端重现死锁，请将 WITH NOLOCK 添加到该查询。吨

他是迄今为止最简单的解决方案，更好的解决方案首先要找到导致死锁发生的根本原因。

# asterisk - 在星号上的呼叫转移中保留原始来电显示

> ID：15167492
> 
> 赞同：1
> 
> 时间：2013-03-01T21:54:04.187
> 
> 标签：asterisk, telephony, pbx, conference, sip-server

我在**VicidialNow CE 1.1**作为**Asterisk Server** / **SIP Server**上运行 B2C 出站营销活动。

呼叫是从服务器向客户发出的，并连接到等待呼叫的代理。座席将呼叫转接给第三方（不是盲转）。第三方看到代理的来电显示。

现在，我想要向第三方显示来电显示或客户的电话号码。

我用谷歌搜索并搜索了 SO，发现这个***sendrpid=pai***添加到 sip.conf 文件中。但此功能仅支持 1.4 或升级版本。

**设想：**

代理拨打客户的电话前 12123344 并接听电话。代理将客户置于保留状态并拨打 XX 先生，另一个电话号码（不是 sip 服务器的分机号）前 21214433。进行电话会议（客户、代理和 XX 先生在会议中）。我希望 XX 先生在客户连接到会议后尽快看到客户编号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:02:25.990

当呼叫第一次进来时，将传入的 CID 信息捕获到一个通道变量中：

```
exten => foo,1,Set(ORIG_CID=${CALLERID(all)}) 
```

...然后在您拨号之前将 CID 设置为通道变量的内容。

# delphi - 是否有一种简洁的方法来更新记录的 TDictionary 中的所有值？

> ID：15167493
> 
> 赞同：4
> 
> 时间：2013-03-01T21:54:06.327
> 
> 标签：delphi

我想做这样的事情，但它不会编译，因为无法分配 Pair 。

```
var
  MyDictionary: TDictionary<TGuid, TCustomRecord>;
  Pair: TPair<TGuid, TCustomRecord>;
begin
  // ... create and populate my dictionary ...

  foreach Pair in MyDictionary do
  begin
    PairRef.Value.MyField := PairRef.Value.MyField + 1;
  end;
end 
```

为了清楚起见，我知道如何使用更多代码来完成此任务，我正在寻找简洁易读的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T22:40:59.733

这是一个简单的程序，它显示了使用带有`TDictionary`.

```
program Project1;

{$APPTYPE CONSOLE}
{$R *.res}

uses
  System.SysUtils, System.Generics.Collections;

type
  TMyRecord = record
    Field : Integer;
  end;

  TMyObject = class
    Field : Integer;
  end;

procedure UseObjectDict;
var
  LDict :  TDictionary<TGUID, TMyObject>;
  LValue : TMyObject;
begin
  write( 'TMyObject: ' );

  LDict := TObjectDictionary<TGUID, TMyObject>.Create( [doOwnsValues] );
  try

    // populate
    while LDict.Count < 10 do
    begin
      LDict.Add( TGuid.NewGuid, TMyObject.Create );
    end;

    // update
    for LValue in LDict.Values do
      begin
        LValue.Field := LValue.Field + 1;
      end;

    // output
    for LValue in LDict.Values do
      begin
        write( LValue.Field, ', ' );
      end;
    Writeln;

  finally
    LDict.Free;
  end;
end;

procedure UseRecordDict;
var
  LDict :  TDictionary<TGUID, TMyRecord>;
  LKey :   TGUID;
  LValue : TMyRecord;
begin
  write( 'TMyRecord: ' );
  LDict := TDictionary<TGUID, TMyRecord>.Create;
  try

    // populate
    while LDict.Count < 10 do
      begin
        LValue.Field := 0;
        LDict.Add( TGuid.NewGuid, LValue );
      end;

    // update
    for LKey in LDict.Keys do
      begin
        LValue.Field := LDict[LKey].Field + 1;
        LDict.AddOrSetValue( LKey, LValue );
      end;

    // output
    for LValue in LDict.Values do
      begin
        write( LValue.Field, ', ' );
      end;
    Writeln;

  finally
    LDict.Free;
  end;
end;

begin
  ReportMemoryLeaksOnShutdown := True;
  try

    UseObjectDict;
    UseRecordDict;

  except
    on E : Exception do
      Writeln( E.ClassName, ': ', E.Message );
  end;

  ReadLn;

end. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:49:25.687

没有`TDictionary`返回对值的引用的迭代器。所有迭代器都提供值，这意味着您所要求的在当前设计中是不可能的。

在其他语言中，例如我所知道的 C++ 和 D，引用是该语言中的一等公民。您可以轻松编写枚举引用而不是值的迭代器。这就是你需要简洁地解决你的问题。可惜语言不通。

一个明显的选择是切换到使用引用类型（类）而不是值类型（记录）。这将一次性解决迭代问题，因为将迭代引用。但是，人们通常选择使用值类型是有充分理由的，并且您可能会遇到一些限制，阻止您进行此切换。

另一种可能性是编写一个提供迭代器的容器，该迭代器提供指向值的指针。这是尽可能接近对记录的引用。但是您必须滚动自己的容器。

# django - 如果模板标签错误，我是否使用 django？

> ID：15167497
> 
> 赞同：1
> 
> 时间：2013-03-01T21:54:21.637
> 
> 标签：django, django-templates

我的 Django 1.2 模板中有这个：

```
{% for m in model.related.iterator %}
    {% if "str" or "Str" in m %} 
         {{m}}//I don't want anything here but put this in so I could see the output 
    {%else%} 
         {% if forloop.last %} 
           {% customtag "var" %} 
         {% endif %} 
    {% endif %} 
{% endfor %} 
```

`{{m}}`无论它是否包含`"str"`，我都会得到价值，`"Str"`或者它们都不包含。另外，如果我取出`or`并比较一个字符串，它可以工作，但我想在没有另一个的情况下比较两者`else if`。有什么办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:06:58.920

我相信你想要的是

```
{% if "str" in m or "Str" in m %} 
```

但是，格林的回答也可以

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:04:16.833

尝试...

```
{% if "STR" in m|upper %}
    Do something
{% endif %} 
```

# c# - 谁拥有控制权？

> ID：15167498
> 
> 赞同：5
> 
> 时间：2013-03-01T21:54:23.370
> 
> 标签：c#, .net, winforms, idisposable

假设我有一些这样的组件：

```
class SomeForm : Form
{
    private Control example;

    public void Stuff()
    {
        this.example = new ComboBox();
        // ...
        this.Controls.Add(example);
    }

    public void OtherStuff()
    {
        this.Controls.Remove(example);
    }
} 
```

谁负责调用`Dispose`示例控件？删除它`this.Controls`会导致它被处置吗？或者这是否会泄漏支持控件的窗口句柄？

（作为参考，我问这个是因为我看不到 Windows 窗体设计器在哪里生成代码来调用窗体的子级上的 Dispose）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T21:58:12.573

`Form.Dispose()`将处理`Controls`集合中的控件。因此，从中删除控件`Controls`将需要您自己处理控件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T21:56:40.287

释放包含此控件的表单时，将释放存储在 Controls 属性中的所有控件。您不需要从集合中删除您的自定义控件。只需确保已处理包含表单。

如果您从集合中删除该控件，则该控件最终将超出范围并且无法进行垃圾回收。当 GC 运行时，它将调用终结器/析构函数，在 Form 类的情况下，它将简单地调用 Dispose 方法。话虽这么说，依赖它是不好的做法。您应该始终确保在完成使用 IDisposable 接口的类上确定性地（手动）调用 Dispose 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T22:05:42.237

总是去怀疑的源头：

`Form.Dispose`看起来有点像这样：

```
protected override void Dispose(bool disposing)
{
    if (disposing)
    {
       ... lots and lots of weird optimized checks ...
       base.Dispose(disposing); 
```

好的......`Form`是一个`ContainerControl`，所以：

`ContainerControl.Dispose`：

```
protected override void Dispose(bool disposing)
{
    if (disposing)
    {
        this.activeControl = null;
    }
    base.Dispose(disposing);
    this.focusedControl = null;
    this.unvalidatedControl = null;
} 
```

**Grrr*** ...好吧，`ContainerControl`是一个`Control`：

`Control.Dispose`：

```
protected override void Dispose(bool disposing)
{
    ... a whole lot of resource reclaiming/funky code ...
     ControlCollection controls = (ControlCollection) 
            this.Properties.GetObject(PropControlsCollection);
     if (controls != null)
     {
         for (int i = 0; i < controls.Count; i++)
         {
              Control control = controls[i];
              control.parent = null;
              control.Dispose();
         }
         this.Properties.SetObject(PropControlsCollection, null);
      }
      base.Dispose(disposing); 
```

所以是的；调用`Dispose`Form 将释放其中包含的控件。

# sql-server-2012 - 按小时分组行的更有效方法（使用时间戳）

> ID：15167499
> 
> 赞同：0
> 
> 时间：2013-03-01T21:54:23.933
> 
> 标签：sql-server-2012

我正在尝试显示发生的日常交易日志。我目前的方法效率低得令人尴尬，我相信有更好的解决方案。这是我当前的查询：

```
select ReaderMACAddress,
count(typeid) as 'Total Transactions',
SUM(CASE WHEN CAST("Timestamp" as TIME) between '05:00:00' and '11:59:59' THEN 1 ELSE 0 END) as 'Morning(5am-12pm)',
SUM(CASE WHEN CAST("Timestamp" as TIME) between '12:00:00' and '17:59:59' THEN 1 ELSE 0 END) as 'AfternoonActivity(12pm-6pm)',
SUM(CASE WHEN CAST("Timestamp" as TIME) between '18:00:00' and '23:59:59' THEN 1 ELSE 0 END) as 'EveningActivity(6pm-12am)',
SUM(CASE WHEN CAST("Timestamp" as TIME) between '00:00:00' and '04:59:59' THEN 1 ELSE 0 END) as 'OtherActivity(12am-5am)'
from Transactions
where ReaderMACAddress = '0014f54033f5'
Group by ReaderMACAddress; 
```

返回结果：

```
ReaderMACAddress    Total Transactions  Morning(5am-12pm)   AfternoonActivity(12pm-6pm) EveningActivity(6pm-12am)   OtherActivity(12am-5am)
0014f54033f5               932                269                    431                          232                         0 
```

（抱歉这里有任何对齐问题）

目前我只想查看我指定的单个 Reader（通过 where 子句）。理想情况下，如果时间部分在单列中并且结果（即计数函数）在第二列中会更容易阅读，从而产生如下结果：

```
Total Transactions          932
Morning(5am-12pm)           269
AfternoonActivity(12pm-6pm) 431
EveningActivity(6pm-12am)   232
OtherActivity(12am-5am)     0 
```

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T22:05:00.140

我会首先考虑计算列，但我相信从之前的帖子中您没有能力更改架构。那么视图呢？

```
CREATE VIEW dbo.GroupedReaderView
AS
  SELECT ReaderMACAddress,
    Slot = CASE WHEN t >= '05:00' AND t < '12:00' THEN 1
                WHEN t >= '12:00' AND t < '18:00' THEN 2
                WHEN t >= '18:00' THEN 3 ELSE 4 END
  FROM 
  (
    SELECT ReaderMACAddress, t = CONVERT(TIME, [Timestamp])
     FROM dbo.Transactions
  ) AS x; 
```

现在您的每 MAC 地址查询要简单得多：

```
SELECT Slot, COUNT(*)
  FROM dbo.GroupedReaderView
  WHERE ReaderMACAddress = '00...'
  GROUP BY Slot; 
```

这将提供如下结果：

```
1    269
2    431
3    232
4      0 
```

您还可以添加`WITH ROLLUP`将提供总计的`Slot`列`NULL`：

```
SELECT Slot, COUNT(*)
  FROM dbo.GroupedReaderView
  WHERE ReaderMACAddress = '00...'
  GROUP BY Slot
  WITH ROLLUP; 
```

应该产生：

```
1     269
2     431
3     232
4       0
NULL  932 
```

如果需要，您可以调整它，在您的表示层中为每个插槽添加标签等。

您也可以这样做，它只会使视图更加冗长，并在您直接查询时提取大量额外数据；按字符串分组的效率也稍低。

```
CREATE VIEW dbo.GroupedReaderView
AS
  SELECT ReaderMACAddress,
    Slot = CASE WHEN t >= '05:00' AND t < '12:00' THEN 
                   'Morning(5am-12pm)'
                WHEN t >= '12:00' AND t < '18:00' THEN 
                   'Afternoon(12pm-6pm)'
                WHEN t >= '18:00' THEN 
                   'Evening(6pm-12am)'
                ELSE 
                   'Other(12am-5am)' 
                END
  FROM 
  (
    SELECT ReaderMACAddress, t = CONVERT(TIME, [Timestamp])
     FROM dbo.Transactions
  ) AS x; 
```

这些不一定比你所拥有的更有效，但它们的重复性和视觉上更容易。:-)

此外，如果您不想（或不能）创建视图，则可以将其放入子查询中，例如

```
SELECT Slot, COUNT(*)
  FROM 
  (
    SELECT ReaderMACAddress,
      Slot = CASE WHEN t >= '05:00' AND t < '12:00' THEN 
                   'Morning(5am-12pm)'
                  WHEN t >= '12:00' AND t < '18:00' THEN 
                   'Afternoon(12pm-6pm)'
                  WHEN t >= '18:00' THEN 
                   'Evening(6pm-12am)'
                  ELSE 
                   'Other(12am-5am)' 
                  END
    FROM 
    (
      SELECT ReaderMACAddress, t = CONVERT(TIME, [Timestamp])
       FROM dbo.Transactions
    ) AS x
  ) AS y
  WHERE ReaderMACAddress = '00...'
  GROUP BY Slot
  WITH ROLLUP; 
```

只是一个仍然可以让您使用 BETWEEN 并且可能更简洁的替代方案：

```
SELECT Slot, COUNT(*)
  FROM 
  (
    SELECT ReaderMACAddress,
      Slot = CASE WHEN h BETWEEN 5  AND 11 THEN 'Morning(5am-12pm)'
                  WHEN h BETWEEN 12 AND 17 THEN 'Afternoon(12pm-6pm)'
                  WHEN h >= 18 THEN 'Evening(6pm-12am)'
                  ELSE 'Other(12am-5am)' 
                  END
    FROM 
    (
      SELECT ReaderMACAddress, h = DATEPART(HOUR, [Timestamp])
       FROM dbo.Transactions
    ) AS x
  ) AS y
  WHERE ReaderMACAddress = '00...'
  GROUP BY Slot
  WITH ROLLUP; 
```

* * *

**更新**

即使该插槽没有结果，也要始终包含每个插槽：

```
;WITH slots(s, label, h1, h2) AS
(
  SELECT           1, 'Morning(5am-12pm)'   , 5,  11
  UNION ALL SELECT 2, 'Afternoon(12pm-6pm)' , 12, 17
  UNION ALL SELECT 3, 'Evening(6pm-12am)'   , 18, 23
  UNION ALL SELECT 4, 'Other(12am-5am)'     , 0,  4
)
SELECT s.label, c = COALESCE(COUNT(y.ReaderMACAddress), 0)
  FROM slots AS s
  LEFT OUTER JOIN
  (
     SELECT ReaderMACAddress, h = DATEPART(HOUR, [Timestamp])
       FROM dbo.Transactions
       WHERE ReaderMACAddress = '00...'
  ) AS y
 ON y.h BETWEEN s.h1 AND s.h2
 GROUP BY s.label
 WITH ROLLUP; 
```

在所有这些情况下，关键是简化而不是重复自己。即使 SQL Server 只执行一次，为什么要转换为时间 4 次以上？

# .htaccess - .htaccess 强制“www”。在除子域之外的所有内容上并删除尾部斜杠

> ID：15167508
> 
> 赞同：4
> 
> 时间：2013-03-01T21:55:25.737
> 
> 标签：.htaccess, redirect

这是我到目前为止所拥有的：

```
#Force www.
RewriteCond %{HTTPS} !=on
RewriteCond %{HTTP_HOST} !^www\..+$ [NC]
RewriteRule ^ http://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

#Remove trailing slash
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} (.*)$
RewriteRule ^(.+)/$ http://www.domain.com/$1 [R=301,L] 
```

但是，这会弄乱所有执行以下重定向的子域：

```
sub.domain.com -> www.sub.domain.com 
```

而且，它依赖于写在删除斜杠位上的域。

所以......两个问题。

如何重写“删除尾部斜杠”位上的规则以排除在其上写入域？

如何在“强制 www”上进行重写以排除子域，而无需明确写下它们。少量？

期望结果的例子 -

```
sub.domain.com/something/ -> sub.domain.com/something
domain.com/something/ -> www.domain.com/something
www.domain.com/ -> www.domain.com
sub.domain.com -> sub.domain.com 
```

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T22:12:56.043

更改 www 以检查实际域：

```
#Force www.
RewriteCond %{HTTPS} !=on
RewriteCond %{HTTP_HOST} ^domain\.com$ [NC]
RewriteRule ^ http://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

或者，如果您托管大量域，则可以在 TLD 之前检查名称：

```
RewriteCond %{HTTPS} !=on
RewriteCond %{HTTP_HOST} ^([^.]+)\.([a-z]{2,4})$ [NC]
RewriteRule ^ http://www.%1.%2%{REQUEST_URI} [L,R=301] 
```

至于结尾的斜杠，您必须小心不要为目录发出请求。因为如果是，并且您已经`DirectorySlash`打开（默认情况下它是打开的），那么您将导致重定向循环。

为了排除子域，我们假设第一条规则重定向浏览器以确保它以“www”开头，并且由于子域没有被重定向为以“www”开头，我们可以检查一下：

```
#Remove trailing slash
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{HTTP_HOST} ^www\. [NC]
RewriteRule ^(.+)/$ /$1 [R=301,L] 
```

# powershell - 在PowerShell中调用WMI时指定端口？

> ID：15167516
> 
> 赞同：0
> 
> 时间：2013-03-01T21:55:48.873
> 
> 标签：powershell, wmi

WMI 查询从 135 端口运行（从谷歌告诉我的）。尝试执行 WMI 查询时可以指定不同的端口吗？

或者，您可以使用 system.managment.managementScope 对象并在连接时指定端口吗？或许是这样的：

```
\\computername:port\root\cimv2\ 
```

如果这两个问题的答案都是“否”，那么您能否以不同的方式连接并在连接后运行 wmi 查询？

这个问题的原因：

我有一个混合环境，我需要查询防火墙后面的一些服务器。我无法为 WMI 查询指定超时值，因此我需要一种无需新防火墙规则即可连接到这些框的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-22T21:24:39.067

WMI 使用 135 端口进行协商，然后 DCOM 在 1024 和 65535 之间选择一个随机端口。很难找到一个固定端口。对防火墙不太友好...

正如 Jeff 的评论，上面说你必须告诉你正在连接的机器，以限制它使用的端口。

在 Windows Server 2003 中，您无法限制选择的端口，因此对于那些我在该服务器上运行我的脚本，然后将结果推送回已知端口。我的脚本使用标准 SQL 端口，因为所有信息都存储在数据库中。

对于 windows server 2008 R2，您可以限制它使用的端口，这可以通过在每台服务器上运行以下命令来完成；

1.  在命令提示符下，键入**winmgmt -standalonehost**
2.  通过键入命令**net stop "Windows Management Instrumentation"停止 WMI 服务**
3.  **通过键入net start "Windows Management Instrumentation"**在新的服务主机中重新启动 WMI 服务
***   通过键入**netsh firewall add portopening TCP 24158 WMIFixedPort为 WMI 服务建立一个新的端口号****

 **可以在此处找到步骤和更多信息（正如 Jeff 给出的那样）： [为 WMI 设置固定端口](http://msdn.microsoft.com/en-us/library/windows/desktop/bb219447%28v=vs.85%29.aspx)

它不是最好的解决方案，但我知道的唯一一个，我已经为大型服务器环境构建脚本很长时间了。我一直处理它的方式是在每个位置（DMZ 等）都有一个脚本，然后将数据推回已知端口。

希望这个对你有帮助。**

# profiling - CL：帮助识别分析器输出

> ID：15167518
> 
> 赞同：2
> 
> 时间：2013-03-01T21:56:18.973
> 
> 标签：profiling, common-lisp

[他在这篇文章](https://stackoverflow.com/questions/9561109/common-lisp-compiling-and-execution-time?rq=1)中使用什么 CL 实现（或分析包）来按函数名称显示细分？我有 CCL、SBCL、ECL 和它们类似的`(time (load ...`东西：

```
? (time (load "../e/3.cl"))
(LOAD "../e/3.cl")
took 3,176 milliseconds (3.176 seconds) to run.
        18 milliseconds (0.018 seconds, 0.57%) of which was spent in GC.
During that period, and with 2 available CPU cores,
       128 milliseconds (0.128 seconds) were spent in user mode
       224 milliseconds (0.224 seconds) were spent in system mode
 11,904,264 bytes of memory allocated.
 1,582 minor page faults, 77 major page faults, 0 swaps. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:29:52.060

你想在 Common Lisp 中寻找计量或分析。

以上是计量工具，最初分发自 Mark Kantrowitz 的工具集：[http ://www.cs.cmu.edu/afs/cs/project/ai-repository/ai/lang/lisp/code/tools/计量/0.html](http://www.cs.cmu.edu/afs/cs/project/ai-repository/ai/lang/lisp/code/tools/metering/0.html)

现在应该有更新的版本了。

# ios - iOS 使用标签栏更改视图

> ID：15167521
> 
> 赞同：0
> 
> 时间：2013-03-01T21:56:28.607
> 
> 标签：ios, cocoa-touch

我是iOS编程的初学者。我有一个 iOS 应用程序，它有两个类（带有 xib），firstviewcontroller 和 secondviewcontroller。我想添加一个标签栏来在这些视图控制器之间切换。例如，如果我将标签栏添加到第一个视图，如何将视图连接到标签栏？它就在那里，什么都不做。。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:01:42.627

试试看这个网址，这会有所帮助。 [http://www.amateurinmotion.com/articles/2009/01/24/creating-uitabbarcontroller-based-app-using-interfacebuilder.html](http://www.amateurinmotion.com/articles/2009/01/24/creating-uitabbarcontroller-based-app-using-interfacebuilder.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:59:53.647

这假设您希望标签栏作为应用程序的主界面。

*   在您的应用委托中，创建一个子类`UITabBarController`：

    `UITabBarController *myTbc = [UITabBarController alloc] init];`

*   创建两个视图控制器的实例并将它们添加到`NSArray`

    `NSArray *tabsArray = @[firstVC, secondVC];`

*   将该 NSArray 设置为`viewControllers`标签栏控制器的属性

    `[myTbc setViewControllers:tabsArray];`

*   将标签栏控制器设置为应用的根视图：

    `self.window.rootViewController = theTbc;`

# jquery - 带有jquery的行和平铺视图列表

> ID：15167526
> 
> 赞同：0
> 
> 时间：2013-03-01T21:56:50.810
> 
> 标签：jquery, toggleclass

我想做的是创建两个按钮；一个按钮显示数据的平铺视图，另一个按钮显示数据的行视图。我将代码设置为：

```
 dl = $('.data-list'),
    sr = $('.sort-row'),
    st = $('.sort-tile');

    //add cursor to tile icon default
    st.addClass('active-tile').css({'cursor':'default'});
    //add tile class to data-list
    dl.addClass('tile');

    //add tile class and remove row
    st.click(function() {
        if ($(this).hasClass('active-tile')){
            $(this).removeClass('active-tile').css({'cursor':'pointer'});
            dl.hide().addClass('row').removeClass('tile').fadeIn();
            sr.addclass('active-row');
        } else {
            $(this).addClass('active-tile').css({'cursor':'default'});
            sr.removeClass('active-row');
            dl.hide().addClass('tile').removeClass('row').fadeIn().css('display','block');
        }
    });
    //add row class and remove tile
    sr.click(function() {
        if ($(this).hasClass('active-row')){
            $(this).removeClass('active-row').css({'cursor':'pointer'});
            dl.hide().addClass('tile').removeClass('row').fadeIn();
            st.addclass('active-tile');
        } else {
            $(this).addClass('active-row').css({'cursor':'default'});
            st.removeClass('active-tile');
            dl.hide().addClass('row').removeClass('tile').fadeIn().css('display','block');
        }
    }); 
```

HTML：

```
 <div class="sort-bar fr">
        <span class="sort-tile">Columns</span>
        <span class="sort-row">Rows</span>
    </div>
    <div class="data-list">
            <section></section>
            <section></section>
    </div> 
```

我已经设置它隐藏数据列表片刻以便可以添加类，然后我添加行以更改数据的样式。

我最初的观点是我不完全确定如何在行处于活动状态时禁用磁贴按钮，反之亦然。我尝试使用 unbind，但这似乎永久禁用了这两个按钮。另一部分是，那里有很多代码，我觉得我不一定能有效地做到这一点。任何有关如何减少代码的建议将不胜感激。我觉得 toggleclass 在这里会很好用，但我不完全确定该去哪里。

编辑：有人要一个 jsfiddle，我发布了一个简单的东西：http: [//jsfiddle.net/wtyxd/3/](http://jsfiddle.net/wtyxd/3/)

编辑：请注意，如果您单击每个按钮，它会从另一个按钮中删除活动，但如果您再次单击它，它也会从中删除活动并且不会显示活动？我正在努力解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:56:46.540

[http://jsfiddle.net/wtyxd/4/](http://jsfiddle.net/wtyxd/4/)

```
 if ($(this).hasClass('active-tile') && !d1.hassClass('row'))
  if ($(this).hasClass('active-row') && !d1.hassClass('tile')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:23:01.860

实际上，这似乎是我所需要的。我解决了。

```
st.click(function() {

        if (!$(this).hasClass('active')){
            $(this).addClass('active');
            sr.removeClass('active');
            dl.fadeOut(200, function() {
                $(this).addClass('tile').removeClass('row').fadeIn(600)
            });
        }
    });
    //add row class and remove tile
    sr.click(function() {
        if (!$(this).hasClass('active')){
            $(this).addClass('active');
            st.removeClass('active');
            dl.fadeOut(200, function() {
                $(this).addClass('row').removeClass('tile').fadeIn(600)
            });
        }
    }); 
```

# php - 从xml无限滚动

> ID：15167528
> 
> 赞同：2
> 
> 时间：2013-03-01T21:56:58.327
> 
> 标签：php, javascript, jquery

**亲爱的先生们，我正在加载一个包含 1000 多条记录的 xml 文件，它的方案是：**

```
<?xml version="1.0" encoding="UTF-8"?>

<deals>

<deal>
<deal_id>1</deal_id>
<deal_title> <![CDATA[THE TITLE]]> </deal_title>
<deal_description> <![CDATA[THE DESCRIPTION]]> </deal_description>
<deal_url> <![CDATA[http://www.thedomain.com]]> </deal_url>
<deal_price>12.00</deal_price>
<deal_previous_price>68.00</deal_previous_price>
<deal_discount>82</deal_discount>
<deal_image> <![CDATA[http://www.thedomain.com/images/image.jpg]]> </deal_image>
<deal_shop>DEAL SITE NAME</deal_shop>
</deal>

</deals> 
```

**不幸的是，有人向我提供了这个 xml 并且没有排序。现在我正在使用下面的代码将我的 xml 加载到我的 php 文件中 来自 xml 的 4 条记录：**

```
<ol class="timeline" id="updates">

<?php

$url = "http://www.somedomain.com/xml.xml";
$xml = simplexml_load_file($url);
$bar_count = $xml->deal->count();

$limit = 0;
$num = 4;
foreach($xml->deal as $deal)
{

if($limit == $num)
break;

echo'
<li>
<div class="dealmasterblock" id="'.$num.'">
<div class="dealsite">'.$deal->deal_shop.'</div>
<div class="dealsimageblock">
<div class="pricebg">
<div style="width:55px; height:26px; float:left; margin-left:8px; margin-top:14px; font-family:Verdana, Geneva, sans-serif; color:#333; font-size:18px;">-'.$deal->deal_discount.'%</div>
</div>
<div class="dealsimg"><img src="'.$deal->deal_image.'" width="284" height="199" border="0" /></div></div>
<div class="others">
<div class="dealtitle">'.$deal->deal_title.'</div>
</div>
<div class="moreoptions">
<div style="width:465px; height:34px; float:left; margin-top:3px;">
<div style="width:180px; height:28px; padding-top:6px; float:left; font-family:Verdana, Geneva, sans-serif; background-color:#3189EE; color:#FFF; text-align:center; border-right:1px solid #0CF; margin-right:10px;">Αρχική τιμή: '.$deal->deal_previous_price.'€&lt;/div>
<div style="width:180px; height:28px; padding-top:6px; float:left; font-family:Verdana, Geneva, sans-serif; background-color:#3189EE; color:#FFF; text-align:center; border-right:1px solid #0CF;">Μόνο: '.$deal->deal_price.'€&lt;/div>
</div>
<div style="width:147px; height:40px; float:right;"><a href="'.$deal->deal_url.'" target="_blank"><img src="images/morebtn.png" width="147" height="40" border="0" /></a></div>
</div>
</div>
</li>'; 

$limit++;
}

?>
</ol>

<div style="clear:both;"></div>
<div id="more<?php echo $num; ?>" class="morebox">
<a href="#" class="more" id="<?php echo $num; ?>">περισσότερα...</a>
</div>

<div style="clear:both;"></div>
</div> 
```

**我已将 jquery / ajax 代码附加到带有更多类的按钮，因此当我按下它时，它将加载更多记录。jQuery代码是：**

```
<script type="text/javascript">
$(document).ready(function(){

$('.more').on('click', function(evt){

var ID = $(this).attr("id");

if(ID)
{

$("#more"+ID).html('<img src="images/moreajax.gif" />');

$.ajax({
type: "POST",
url: "moredeals.php",
data: "lastmsg="+ ID, 
cache: false,
success: function(html){
$("ol#updates").append(html);
$("#more"+ID).remove();
//$('ol#updates').fadeIn("slow");
//alert('Return ok');
//$("#more"+ID).html('<img src="images/moreajax.gif" />');
}

});
}
else
{
$(".morebox").html('The End');

}
return false;
});

});
</script> 
```

Moredeals.php 是加载更多交易的 ajax 文件：

```
<?php

$url = "http://www.somedomain.com/xml.xml";
$xml = simplexml_load_file($url);

if(isSet($_POST['lastmsg']))
{

$lastmsg=$_POST['lastmsg'];

$url = "http://www.clickbanner.gr/xml/?xml_type=deals&affiliate_ID=16022";
$xml = simplexml_load_file($url);
$bar_count = $xml->deal->count();

$limit = 0;
$num = 8;
foreach($xml->deal as $deal)
{

if($limit == $num)
break;

echo'
<li>
<div class="dealmasterblock" id="'.$num.'">
<div class="dealsite">'.$deal->deal_shop.'</div>
<div class="dealsimageblock">
<div class="pricebg">
<div style="width:55px; height:26px; float:left; margin-left:8px; margin-top:14px; font-family:Verdana, Geneva, sans-serif; color:#333; font-size:18px;">-'.$deal->deal_discount.'%</div>
</div>
<div class="dealsimg"><img src="'.$deal->deal_image.'" width="284" height="199" border="0" /></div></div>
<div class="others">
<div class="dealtitle">'.$deal->deal_title.'</div>
</div>
<div class="moreoptions">
<div style="width:465px; height:34px; float:left; margin-top:3px;">
<div style="width:180px; height:28px; padding-top:6px; float:left; font-family:Verdana, Geneva, sans-serif; background-color:#3189EE; color:#FFF; text-align:center; border-right:1px solid #0CF; margin-right:10px;">Αρχική τιμή: '.$deal->deal_previous_price.'€&lt;/div>
<div style="width:180px; height:28px; padding-top:6px; float:left; font-family:Verdana, Geneva, sans-serif; background-color:#3189EE; color:#FFF; text-align:center; border-right:1px solid #0CF;">Μόνο: '.$deal->deal_price.'€&lt;/div>
</div>
<div style="width:147px; height:40px; float:right;"><a href="'.$deal->deal_url.'" target="_blank"><img src="images/morebtn.png" width="147" height="40" border="0" /></a></div>
</div>
</div>
</li>'; 

$limit++;
}
?>

<div style="clear:both;"></div>
<div id="more<?php echo $num; ?>" class="morebox">
<a href="#" class="more" id="<?php echo $num; ?>">περισσότερα...</a>
</div>

<?php
}
?>

<script type="text/javascript">
$(document).ready(function(){

$('.more').on('click', function(evt){

var ID = $(this).attr("id");

if(ID)
{

$("#more"+ID).html('<img src="images/moreajax.gif" />');

$.ajax({
type: "POST",
url: "moredeals.php",
data: "lastmsg="+ ID, 
cache: false,
success: function(html){
$("ol#updates").append(html);
$("#more"+ID).remove();
}

});
}
else
{
$(".morebox").html('The End');
}
return false;

});

});
</script> 
```

现在的问题是，当按下更多按钮时，我可以加载更多 8 笔交易，但与 4 条第一条记录相同。

有什么建议么？

# c# - 角色提供者 cookie 未正确设置

> ID：15167530
> 
> 赞同：1
> 
> 时间：2013-03-01T21:57:30.357
> 
> 标签：c#, asp.net, .net-4.5, roleprovider

我们使用自定义`RoleProvider`来获取 ASP.NET 应用程序的角色。它正在正确获取角色，但是如果我们`cacheRolesInCookie`在 web.config 文件中启用该选项。升级到 .NET 4.5 后，cookie 没有设置。它仍然可以在我们的 .NET 4.0 站点中使用，但是无论何时我们安装 4.5 框架（即使我们仍然在我们的站点中定位 4.0），cookie 都不会设置。

这是我们所期望的（我们在 4.0 中在我们的网站上得到的）：

```
Set-Cookie: .CUSTOMROLES=<LOTS OF DATA>; path=/; HttpOnly 
```

这就是我将本地开发盒升级到 4.5 后得到的（安装 VS2012 后）

```
Set-Cookie: .CUSTOMROLES=; expires=Tue, 12-Oct-1999 04:00:00 GMT; path=/; HttpOnly 
```

这是 web.config 中的设置

```
<roleManager defaultProvider="CustomRoleProvider" enabled="true"  cacheRolesInCookie="true" cookieName=".DELTAROLES" cookieTimeout="75" cookiePath="/" cookieRequireSSL="false" cookieSlidingExpiration="true" cookieProtection="All" > 
```

此外，我们有两个不同的 RoleProviders，并且无论 cookie 的名称是什么，两者都会出现问题，我为其他 cookie 选项尝试了不同的值。

最后，GetRolesForUser() 函数被调用了两次，因为它没有被正确地缓存在 cookie 中。两次都给出了正确的角色。它只是没有让它成为饼干

**编辑：**

我做了更多的挖掘，发现显然最大 cookie 长度为 4096（不可配置），输出`RolePrincipal.ToEncryptedTicket`为 5698。我不确定为什么这与 .NET 4.0 中的不同，但它是不同的。所以，我至少找到了为什么没有设置 cookie，虽然我无法想象它为什么要这么大，因为我们的 RoleProvider 最多只能提供 2 个角色，所以我不知道还有什么它正在尝试存储。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-03-25T20:20:15.333

升级到 .NET 4.5 后我遇到了同样的问题。我检查了 cookie 的长度，它没有超过 4096，所以这不是原因。可以弄清楚为什么它没有保存 cookie，但您可以自己保存。请参阅[此答案](https://stackoverflow.com/a/16750321/1133338)的示例代码。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-14T14:20:38.403

因此，我对此进行了更多研究，显然它只是 .NET 4.5 中的一个错误，使其比预期的要大。Microsoft 已经发布了一个修补程序，可以在这里找到：http: [//support.microsoft.com/kb/2750147](http://support.microsoft.com/kb/2750147)

# mongodb - MongoDB 不正确的结果

> ID：15167531
> 
> 赞同：0
> 
> 时间：2013-03-01T21:57:33.553
> 
> 标签：mongodb

我有一个 Mongo DB 集合：

每个日期（例如 2013-03-16）可以有 3 个国家/地区值：IND、US 和 SA，如下所示：

```
{
    "name": "SAM",
    "collection": [
        {
            "date": "2013-03-16",
            "country": "IND",
            "values": [
                {
                    "price": "24.0",
                    "gece": "342.1",
                    "countrycode": "IN"
                },
                {
                    "price": "24.0",
                    "gece": "322.1",
                    "countrycode": "IN"
                }
            ]
        },
        {
            "date": "2013-03-16",
            "country": "US",
            "values": [
                {
                    "price": "10.0",
                    "gece": "342.1",
                    "countrycode": "US"
                },
                {
                    "price": "120.0",
                    "gece": "342.1",
                    "countrycode": "US"
                }
            ]
        },
        {
            "date": "2013-03-16",
            "country": "SA",
            "values": [
                {
                    "price": "12.0",
                    "gece": "432.1",
                    "country": "SA"
                }
            ]
        },
        {
            "date": "2013-03-17",
            "country": "IND",
            "values": [
                {
                    "price": "10.0",
                    "gece": "532.1",
                    "country": "IN"
                }
            ]
        },
        {
            "date": "2013-03-17",
            "country": "US",
            "values": [
                {
                    "price": "38.0",
                    "gece": "332.1",
                    "country": "US"
                }
            ]
        }
    ]
} 
```

我尝试使用下面的代码来测试结构：

```
 BasicDBObject query = new BasicDBObject();
        query.put("name", "SAM");
        query.put("collection.date", "2013-03-17");
        query.put("collection.country", "IND");
        BasicDBObject fields = new BasicDBObject();
        fields.put("name", 1);
        fields.put("collection.$", 1); 
```

我正在查询日期 2013-03-17，但它正在返回 2013-03-16 的数据。

这是回应：

```
{
    "_id": {
        "$oid": "513121ac0651150e227d2224"
    },
    "name": "SAM",
    "collection": [
        {
            "date": "2013-03-16",
            "country": "IND",
            "values": [
                {
                    "price": "24.0",
                    "gece": "342.1",
                    "countrycode": "IN"
                },
                {
                    "price": "24.0",
                    "gece": "322.1",
                    "countrycode": "IN"
                }
            ]
        }
    ]
} 
```

**为什么它在我给它的日期返回错误的数据？**

**请看编辑部分**

```
Mongo mongo = new Mongo();
DB db = mongo.getDB("test");
DBCollection mycollection = db.getCollection("xxx");

  BasicDBObject query = new BasicDBObject();
    query.put("name", "SAM");
    query.put("collection.date", "2013-03-16");
    query.put("collection.country", "IND");
    BasicDBObject fields = new BasicDBObject();
    fields.put("name", 1);
    fields.put("collection.$", 1);

    BasicDBObject subquery = new BasicDBObject();
    subquery.put("date", "2013-03-16");
    subquery.put("country", "IND");
    query.put("collection", new BasicDBObject("$elemMatch", subquery));

DBCursor cursor = mycollection.find(query);
while (cursor.hasNext()) {
    System.out.println(cursor.next());
} 
```

我仍然得到所有的结果

```
{ "_id" : { "$oid" : "513121ac0651150e227d2224"} , "name" : "SAM" , "collection" : [ { "date" : "2013-03-16" , "country" : "IND" , "values" : [ { "price" : "24.0" , "gece" : "342.1" , "countrycode" : "IN"} , { "price" : "24.0" , "gece" : "322.1" , "countrycode" : "IN"}]} , { "date" : "2013-03-16" , "country" : "US" , "values" : [ { "price" : "10.0" , "gece" : "342.1" , "countrycode" : "US"} , { "price" : "120.0" , "gece" : "342.1" , "countrycode" : "US"}]} , { "date" : "2013-03-16" , "country" : "SA" , "values" : [ { "price" : "12.0" , "gece" : "432.1" , "country" : "SA"}]} , { "date" : "2013-03-17" , "country" : "IND" , "values" : [ { "price" : "10.0" , "gece" : "532.1" , "country" : "IN"}]} , { "date" : "2013-03-17" , "country" : "US" , "values" : [ { "price" : "38.0" , "gece" : "332.1" , "country" : "US"}]}]} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T23:57:27.793

如果您想使用[位置 $ 运算符](http://docs.mongodb.org/manual/reference/projection/positional/#_S_)，您的查询只允许包含**一个**数组字段。

您的查询应该类似于以下内容：

```
BasicDBObject subquery = new BasicDBObject();
subquery.put("date", "2013-03-17");
subquery.put("country", "IND");
query.put("collection", new BasicDBObject("$elemMatch", subquery)); 
```

# javascript - 打开时灯箱尺寸不合适

> ID：15167539
> 
> 赞同：0
> 
> 时间：2013-03-01T21:58:28.430
> 
> 标签：javascript, jquery, css, jquery-ui, javascript-events

我不知道如何调整灯箱的窗口大小....当我单击立方体灯箱打开时....我在灯箱中给出了链接，但问题是灯箱打开时的大小打开时灯箱宽度尺寸不合适....

[http://jsfiddle.net/rajkumart08/8YK2n/](http://jsfiddle.net/rajkumart08/8YK2n/)

```
 onClick: function() {
    if (!Gallery._config.lightbox) return !1;
    Gallery._toggleOverlay(!0);
    Gallery._current = $(this).parent();
    var a = $(this),
        a = a.children('div[class="' + a.data("position") + '"]').children("img"),
        b = a.data("width"),
        c = a.data("height"),
        f = a.data("container_width"),
        h = a.data("container_height"),
        g = a.data("caption"),
        d = Gallery.window_width - 100,
        j = g ? Gallery.window_height - 180 : Gallery.window_height - 120;
    if (b > d || c > j) {
        var k = b / c;
        k < d / j ? (c = j, b = k * c) : (b = d, c = b / k)
    }
    var m = $("<div>").addClass("caption").html(g ? g : ""),
        n = $("<img>").attr("src", a.attr("src")).width(f).height(h),
        d = $("<div>").addClass("prev").attr("title", "Previous").click(Gallery._prev),
        j = $("<div>").addClass("next").attr("title", "Next").click(Gallery._next);
    Gallery._lightbox = $("<div>").attr("id", "melonhtml5_lightbox").append(n).append(m).append(d).append(j).appendTo($(document.body)).data("container", {
        left: a.offset().left,
        top: a.offset().top,
        width: f,
        height: h,
        caption: g
    });
    var l = $(window).scrollTop(),
        e = $(window).scrollLeft(),
        d = function() {
            n.animate({
                width: b,
                height: c
            }, Gallery.lightbox_speed);
            Gallery._lightbox.animate({
                left: Gallery.window_width / 2 - b / 2 + e,
                top: Gallery.window_height / 2 - c / 2 + l
            }, Gallery.lightbox_speed, function() {
                g && m.animate({
                    height: 30
                }, Gallery.lightbox_speed)
            })
        };
    switch (Gallery._config.animation) {
        case "default":
            Gallery._lightbox.css({
                left: a.offset().left,
                top: a.offset().top
            });
            Gallery._lightbox.animate({
                left: Gallery.window_width / 2 - f / 2 + e,
                top: Gallery.window_height / 2 - h / 2 + l
            }, Gallery.lightbox_speed, d);
            break;
        case "drop":
            Gallery._lightbox.css({
                left: Gallery.window_width / 2 - f / 2 + e,
                top: -1 * h + l
            });
            Gallery._lightbox.animate({
                top: Gallery.window_height / 2 - h / 2 + l
            }, Gallery.lightbox_speed, d);
            break;
        case "slide":
            Gallery._lightbox.css({
                left: -1 * f + e,
                top: Gallery.window_height / 2 - h / 2 + l
            }), Gallery._lightbox.animate({
                left: Gallery.window_width / 2 - f / 2 + e
            }, Gallery.lightbox_speed, d)
    }
    Gallery._config.slideshow && !Gallery._in_slideshow && (Gallery._in_slideshow = !0, setTimeout(Gallery._slideshow, Gallery._config.slideshow_speed))
}, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:11:57.597

当您添加链接时，您设置了错误的样式，如果图像很小，它会转向宽窗口。

```
<div class="caption" style="height: 30px; text-align: right;">
   <a style="font-size: 18px;" href="/Sales/order/">Create</a> 
   <div> 
     <a href="/Sales/" style="font-size: 18px;">View/Edit</a> 
   </div> 
   <a style="&nbsp;font-size: 18px;">Labels</a>
</div> 
```

您需要更改所有标签，例如

```
 <div class="cubeCell" data-text="Search" data-caption="&lt;a style='margin-left: 92px; font-size: 18px; color: grey;' href='http://www.w3schools.com/' &gt;Create&lt;/a&gt; &lt;div&gt; &lt;a style='margin-left: 92px; font-size: 18px; color: grey;' &gt;View/Edit&lt;/a&gt; &lt;/div&gt; &lt;a style='margin-left: 92px; font-size: 18px; color: grey;' &gt;Labels&lt;/a&gt;" data-image="http://intra.defie.co/images/Desktop_icons_02.07.13/search.png"><div class="cubeTextStyle">Search</div></div> 
```

# c - 结构指针算子猜想（理论）

> ID：15167542
> 
> 赞同：2
> 
> 时间：2013-03-01T21:58:46.693
> 
> 标签：c, pointers, syntax, struct, operators

指向结构的指针经常使用，因此有一个特殊的运算符：->。下面的表达式是等价的：

```
(*x).y
 x->y 
```

将此运算符简单地视为定义如下的预处理器宏是否公平：

`#define (x)-> (*(x).)`

为什么或者为什么不？还是从一开始就将其编码为运算符-这将有何不同/有利？

只是好奇。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T22:30:46.360

> **下面的表达式是等价的：?**

```
(*x).y
 x->y 
```

**是**的，两者都是访问结构成员的两种不同方式`y`。

`(*x).y`运算符是`.`与值变量一起使用的 DOT `Element selection by reference`。使用的原因`*`。手段`x`是指向结构的指针。

`x->y`运算符`->`被称为`Element selection through pointer`. 这与指向结构的指针一起工作。这就是这次`*`没有使用的原因。

两者的工作原理相同。

> **将此运算符简单地视为定义如下的预处理器宏是否公平：**

```
#define (x)-> (*(x).) 
```

**否** 首先它给出一个**错误：** *宏名称必须是标识符*。此错误是因为我们不能将`->`运算符作为宏名称。

有效的[*宏名称*](https://stackoverflow.com/questions/369495/what-are-the-valid-characters-for-macro-names?answertab=votes#tab-top)可以是：

> 宏名称只能由字母数字字符和下划线组成，即'az'、'AZ'、'0-9'和'_'，并且第一个字符不能是数字。一些预处理器也允许使用美元符号'$'，但你不应该使用它；不幸的是，我不能引用 C 标准，因为我没有它的副本。

另外，请注意上面所说`->`的`.`差异运算符。它们的优先级也不同，因此将一个运算符替换为另一个运算符是个坏主意。

> **访问结构元素的有效宏：**

此外，我今天想分享的只是我知道大多数 C 头文件。定义的宏如：

```
#define S(x)  ((x).y) 
```

对于特定的 strcut 元素。

注意`(x)` 括号周围`x`是覆盖`*`over的优先级`.`。默认情况下， `.`DOT 具有更高的优先级，`*` 因此它可以用于指针和简单变量。我认为下面的示例会有所帮助。

```
#define S(x)  ((x).y)
typedef struct {
 int y;
}X;
X *x;
X b;
int main(){
 S(*x);
 S(b);     
} 
```

**编辑：**
更好的选择

我正在扩展我的想法来访问 strcut 元素，我定义了新的宏：

```
#define S(x,y)  ((x).y)
typedef struct {
 int a;
}X;
X *x;
X b;
int main(){
 S(*x,a);
 S(b,a);
} 
```

对于通过宏的特定元素而言，这不是更多。

希望至少OP喜欢它:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T23:37:17.553

> 将此运算符简单地视为定义如下的预处理器宏是否公平：

不。

> 为什么或者为什么不？

该`->`运算符具有一些无法通过宏强制执行的特定语义（这是一种简单的文本替换）。即，左侧操作数*必须*是指向结构或联合类型的指针，右侧操作数必须是结构或联合类型的成员，表达式的结果必须是左值。您无法使用宏强制执行这些规则。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T22:01:19.443

> 将此运算符简单地视为定义如下的预处理器宏是否公平：

不，它不会。

> 为什么或者为什么不？

因为它不是宏。它是语言中定义的独特运算符，似乎为其他功能提供语法糖。

# c++ - Windows 上的 C++ 探查器

> ID：15167544
> 
> 赞同：4
> 
> 时间：2013-03-01T21:58:50.780
> 
> 标签：c++, windows, profiler

我刚开始使用 C++，有时我不知道我的编译器有多喜欢算法的两种不同实现。有没有一个*简单*的工具可以用来查看我的代码执行需要多少时间？

编辑：我使用 gcc 编译器

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T22:03:37.613

**自由**

*   [非常困](http://www.codersnotes.com/sleepy/)
*   [普罗菲](http://www.pauldoo.com/proffy/)

**不免费**

*   [AMD](http://developer.amd.com/tools/heterogeneous-computing/amd-codeanalyst-performance-analyzer/codeanalyst-archive/)
*   [英特尔 VTune](http://software.intel.com/en-us/intel-vtune-amplifier-xe)
*   [语义设计](http://www.semanticdesigns.com/Products/Profilers/CppProfiler.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T22:08:34.523

我对 Smart Bear 的 AQtime 有很好的体验，它不是免费的，但你可以免费试用。它可以很好地集成到 Embarcardero 的 Visual C++ 和 RAD Studio 中。

[http://smartbear.com/products/qa-tools/application-performance-profiling](http://smartbear.com/products/qa-tools/application-performance-profiling)

这些数据在 IDE 中很容易访问，尤其是行号旁边的 gutter 部分中的命中数和花费的时间数字很有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-01T22:14:30.167

如果您想确定整个程序运行了多长时间，那么 Code-Blocks/Visual Studio 应该会在程序关闭时告诉您。它应该在底部的日志中。

如果您想测量特定行或功能需要多长时间，我建议您研究 `clock()`或`QueryPerformanceFrequency()`以及如何使用它们。

该`clock()`功能很慢，但更易于使用。一个例子：

```
float start_time = clock()/CLOCKS_PER_SEC;
func();
float end_time = clock()/CLOCKS_PER_SEC;
float dtime = start_time - end_time; 
```

# html - 如何使用 CSS 将矩形图像“裁剪”成正方形？

> ID：15167545
> 
> 赞同：211
> 
> 时间：2013-03-01T21:58:58.137
> 
> 标签：html, css, image, crop

我知道实际上用 CSS 修改图像是不可能的，这就是为什么我将裁剪放在引号中。

我想做的是拍摄矩形图像并使用 CSS 使它们看起来是方形的，而不会扭曲图像。

我基本上想把这个：

![在此处输入图像描述](../Images/580a08c6f73bfde35ab93cecdbd8ae80.png)

进入这个：

![在此处输入图像描述](../Images/a0e980e3e9ca17f5e7cc2ce3d7713747.png)

* * *

## 回答 #1

> 赞同：517
> 
> 时间：2016-08-12T21:45:28.033

`div`没有包装器或其他无用代码的纯 CSS 解决方案：

```
img {
  object-fit: cover;
  width:230px;
  height:230px;
} 
```

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2013-03-01T22:04:21.237

假设它们不必在 IMG 标签中......

**HTML：**

```
<div class="thumb1">
</div> 
```

**CSS：**

```
.thumb1 { 
  background: url(blah.jpg) 50% 50% no-repeat; /* 50% 50% centers image in div */
  width: 250px;
  height: 250px;
}

.thumb1:hover { YOUR HOVER STYLES HERE } 
```

编辑：如果 div 需要链接到某个地方，只需调整 HTML 和样式，如下所示：

**HTML：**

```
<div class="thumb1">
<a href="#">Link</a>
</div> 
```

**CSS：**

```
.thumb1 { 
  background: url(blah.jpg) 50% 50% no-repeat; /* 50% 50% centers image in div */
  width: 250px;
  height: 250px;
}

.thumb1 a {
  display: block;
  width: 250px;
  height: 250px;
}

.thumb1 a:hover { YOUR HOVER STYLES HERE } 
```

请注意，这也可以修改为响应式，例如百分比宽度和高度等。

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2013-03-01T22:02:19.097

1.  将您的图像放在一个 div 中。
2.  给你的 div 明确的正方形尺寸。
3.  将 div 上的 CSS 溢出属性设置为隐藏 ( `overflow:hidden`)。
4.  把你的想象放在 div 里面。
5.  利润。

例如：

```
<div style="width:200px;height:200px;overflow:hidden">
    <img src="foo.png" />
</div> 
```

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2019-05-03T08:49:28.833

如果图像位于具有**响应**宽度的容器中：

```
.rect-img-container {
  position: relative;
}

.rect-img-container::after {
  content: "";
  display: block;
  padding-bottom: 100%;
}

.rect-img {
  position: absolute;
  width: 100%;
  height: 100%;
  object-fit: cover;
}
```

```
<div class="rect-img-container">
  <img class="rect-img" src="https://picsum.photos/id/0/367/267" alt="">
</div>
```

（编辑：从 sass 更新为纯 css）（编辑：添加虚拟图像以供参考）

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2015-02-23T11:48:30.577

使用背景尺寸：封面 - [http://codepen.io/anon/pen/RNyKzB](http://codepen.io/anon/pen/RNyKzB)

CSS：

```
.image-container {
  background-image: url('http://i.stack.imgur.com/GA6bB.png');
  background-size:cover;
  background-repeat:no-repeat;
  width:250px;
  height:250px;
} 
```

标记：

```
<div class="image-container"></div> 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2014-02-25T19:50:40.583

实际上，我最近遇到了同样的问题，并最终采用了稍微不同的方法（我无法使用背景图像）。虽然它确实需要一点点 jQuery 来确定图像的方向（我相信你可以使用纯 JS 代替）。

如果您对更多解释感兴趣，我写了[一篇关于它的博客文章，](http://fredparke.com/blog/cropping-images-using-simple-css-and-js)但代码非常简单：

HTML：

```
<ul class="cropped-images">
  <li><img src="http://fredparke.com/sites/default/files/cat-portrait.jpg" /></li>
  <li><img src="http://fredparke.com/sites/default/files/cat-landscape.jpg" /></li>
</ul> 
```

CSS：

```
li {
  width: 150px; // Or whatever you want.
  height: 150px; // Or whatever you want.
  overflow: hidden;
  margin: 10px;
  display: inline-block;
  vertical-align: top;
}
li img {
  max-width: 100%;
  height: auto;
  width: auto;
}
li img.landscape {
  max-width: none;
  max-height: 100%;
} 
```

jQuery：

```
$( document ).ready(function() {

    $('.cropped-images img').each(function() {
      if ($(this).width() > $(this).height()) {
        $(this).addClass('landscape');        
      }
    });

}); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-03-06T05:00:10.087

`object-fit: cover`会做你需要的。

但它可能不适用于 IE/Edge。按照如下所示**仅使用 CSS**修复它以在所有**浏览器**上工作。

**我采用的方法是使用绝对值**将图像定位在容器内 ，然后使用以下组合**将其放置在中心：**

```
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%); 
```

一旦它在中心，我给图像，

```
// For vertical blocks (i.e., where height is greater than width)
height: 100%;
width: auto;

// For Horizontal blocks (i.e., where width is greater than height)
height: auto;
width: 100%; 
```

这使得图像得到了 Object-fit:cover 的效果。

* * *

# 这是上述逻辑的演示。

[https://jsfiddle.net/furqan_694/s3xLe1gp/](https://jsfiddle.net/furqan_694/s3xLe1gp/)

此逻辑适用于所有浏览器。

* * *

**原始图像**
[![原始图像](../Images/db78da242cea5d772ddd9c8c2ecbe82b.png)](https://i.stack.imgur.com/YkuCP.png)

**垂直裁剪**
[![垂直裁剪的图像](../Images/e57f0e3434041c8b5430fac5b68e811d.png)](https://i.stack.imgur.com/7wVxn.png)

**水平裁剪**
[![水平裁剪的图像](../Images/579287c95d3564998e91e066e8e4e6ea.png)](https://i.stack.imgur.com/WdJTE.png)

* * *

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-04-06T21:21:43.527

我遇到了类似的问题，无法“妥协”背景图片。我想出了这个。

```
<div class="container">
    <img src="http://lorempixel.com/800x600/nature">
</div>

.container {
    position: relative;
    width: 25%; /* whatever width you want. I was implementing this in a 4 tile grid pattern. I used javascript to set height equal to width */
    border: 2px solid #fff; /* just to separate the images */
    overflow: hidden; /* "crop" the image */
    background: #000; /* incase the image is wider than tall/taller than wide */
}

.container img {
    position: absolute;
    display: block;
    height: 100%; /* all images at least fill the height */
    top: 50%; /* top, left, transform trick to vertically and horizontally center image */
    left: 50%;
    transform: translate3d(-50%,-50%,0);
}

//assuming you're using jQuery
var h = $('.container').outerWidth();
$('.container').css({height: h + 'px'}); 
```

希望这可以帮助！

示例： [https ://jsfiddle.net/cfbuwxmr/1/](https://jsfiddle.net/cfbuwxmr/1/)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-04-13T09:25:54.270

看看 CSS`aspect-ratio`

[https://developer.mozilla.org/en-US/docs/Web/CSS/aspect-ratio](https://developer.mozilla.org/en-US/docs/Web/CSS/aspect-ratio)

```
.square-image{
  width: 50%;
  background-image: url('https://picsum.photos/id/0/367/267');
  background-size: cover;
  background-position: center;
  aspect-ratio: 1/1;
}
```

```
<div class="square-image"></div>
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-03-01T22:02:32.987

使用 CSS：溢出：

```
.thumb {
   width:230px;
   height:230px;
   overflow:hidden
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-03-01T22:13:48.980

使用带有 .testimg 类的内部图像的方形尺寸 div：

```
.test {
width: 307px;
height: 307px;
overflow:hidden
}

.testimg {
    margin-left: -76px

} 
```

或带有图像背景的方形 div。

```
.test2 {
width: 307px;
height: 307px;
    background: url(http://i.stack.imgur.com/GA6bB.png) 50% 50%
} 
```

这里有一些例子：http: [//jsfiddle.net/QqCLC/1/](http://jsfiddle.net/QqCLC/1/)

**更新了图像中心**

```
.test {
  width: 307px;
  height: 307px;
  overflow: hidden
}

.testimg {
  margin-left: -76px
}

.test2 {
  width: 307px;
  height: 307px;
  background: url(http://i.stack.imgur.com/GA6bB.png) 50% 50%
}
```

```
<div class="test"><img src="http://i.stack.imgur.com/GA6bB.png" width="460" height="307" class="testimg" /></div>

<div class="test2"></div>
```

# iphone - 保存屏幕截图时从层次结构中删除顶视图

> ID：15167546
> 
> 赞同：0
> 
> 时间：2013-03-01T21:59:12.677
> 
> 标签：iphone, ios, uiimage, core-graphics, calayer

我正在使用一种方法以**编程**方式截取 UIImage 屏幕截图，效果非常好。我现在想要做的是从屏幕截图中删除最顶部的 UIView**但**不要从屏幕上的实际视图中删除它，所以简单的设置是`topView.hidden = YES`行不通的。我正在使用这种方法来保存屏幕截图：

```
- (UIImage*)screenshot
{
CGSize imageSize = [[UIScreen mainScreen] bounds].size;
if (NULL != UIGraphicsBeginImageContextWithOptions)
    UIGraphicsBeginImageContextWithOptions(imageSize, NO, 0);
else
    UIGraphicsBeginImageContext(imageSize);

CGContextRef context = UIGraphicsGetCurrentContext();

// Iterate over every window from back to front
for (UIWindow *window in [[UIApplication sharedApplication] windows])
{
    if (![window respondsToSelector:@selector(screen)] || [window screen] == [UIScreen mainScreen])
    {
        // -renderInContext: renders in the coordinate space of the layer,
        // so we must first apply the layer's geometry to the graphics context
        CGContextSaveGState(context);
        // Center the context around the window's anchor point
        CGContextTranslateCTM(context, [window center].x, [window center].y);
        // Apply the window's transform about the anchor point
        CGContextConcatCTM(context, [window transform]);
        // Offset by the portion of the bounds left of and above the anchor point
        CGContextTranslateCTM(context,
                              -[window bounds].size.width * [[window layer] anchorPoint].x,
                              -[window bounds].size.height * [[window layer] anchorPoint].y);

        // Render the layer hierarchy to the current context
        [[window layer] renderInContext:context];

        // Restore the context
        CGContextRestoreGState(context);
    }
}

// Retrieve the screenshot image
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

UIGraphicsEndImageContext();

return image;
} 
```

我的第一个想法是从超级层中删除子层，这样做：

```
NSArray *sublayers = [[window layer] sublayers];
[[window layer] replaceSublayer:[sublayers objectAtIndex:[sublayers count] - 1] with:nil]; 
```

但我发现`sublayers`数组只有 1 个对象。如何从屏幕截图中删除顶视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T05:44:08.557

例如，您的视图层次结构中有 View1 并且您不想截取 View1 的屏幕截图，那么您可以执行 View1.hiden= TRUE; 在屏幕截图之前，您可以执行 View1.hiden= FALSE; 截图后。

可能这会对你有所帮助。

# windows-8 - Windows 应用商店应用程序可以使用第二台显示器吗？

> ID：15167552
> 
> 赞同：0
> 
> 时间：2013-03-01T21:59:35.483
> 
> 标签：windows-8, windows-runtime, windows-store-apps, winrt-xaml

希望将我的应用程序作为侧载 LOB 应用程序迁移到 Windows 8，但我本身需要 2 个监视器。一种用于全屏 1080p 视频，一种用于触摸输入。这可能吗？谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-12T11:47:14.777

只是为了更新这个问题的答案。

从 Windows 8.1 RTM 开始，您现在可以在多台显示器上同时运行 Metro 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:10:31.073

Windows 应用商店应用程序不支持在多台显示器上运行，不。

当您启动 Windows 应用商店应用程序时，当按下 Windows 键时，它将出现在显示“开始”屏幕的任何显示器上。如果需要，最终用户可以使用 Win+PgUp 或 Win+PgDn 快捷键更改此设置。

# uitableview - 无法在 didrowselect 方法中获取图像/单元格标记号...！

> ID：15167554
> 
> 赞同：0
> 
> 时间：2013-03-01T21:59:38.603
> 
> 标签：uitableview, uiimageview, ios6.1

嗨，我在带有标签的单元格中使用 2 UIImageView，通过从数组中填充图像（例如第 0 行的（第 0 图像，第 1 图像）和第 1 行的（第 2 图像，第 3 图像）等数组来按顺序显示每一行。 .

我成功地为每个图像显示了带有适当标签的图像，但在 didrowselect 方法中获取图像或单元格的标签失败...我需要标签号直接将标签号作为数组索引传递给 detailsegue...我IOS编程新手，我想知道这里是否做错了什么，请提出一种获取适当标签号的方法...非常感谢您在这方面的帮助，因为只有这个任务才能完成！ ！！

粘贴我的代码供您参考：self.tagnumber=0; 此代码用于显示偶数个图像。

```
 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
  {
    return 1;
  }

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    //Check Even Rows or odd rows
    if(_objects.count%2==0)
    {

        return (_objects.count/2);
    }
    else
    {
        return ((_objects.count/2)+1);
    }
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *MyCellIdentifier = @"MyCellIdentifier";

    UITableViewCell *cell = [self.tableView dequeueReusableCellWithIdentifier:MyCellIdentifier];

    if(cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault  reuseIdentifier:MyCellIdentifier];
    }

    NSInteger itemcount = _objects.count;
    NSLog(@"RowCount:%d",_objects.count/2);

    if(itemcount%2==0)
    {
        NSLog(@"Image Count is Even!");
        if(itemcount!=self.tagnumber)
        {

            RSSItem *object = _objects[self.tagnumber];
            UIImageView *imageView1 = [[UIImageView alloc]initWithFrame:CGRectMake(10, 4, 145, 95)];

            imageView1.tag = self.tagnumber;//1;
            NSLog(@"Tag number for Image1:%d", self.tagnumber);
            imageView1.image = [UIImage imageWithData:object.artimageData];
            [imageView1 setContentMode:UIViewContentModeScaleAspectFill];
            [imageView1 setClipsToBounds:YES];
            [cell.contentView addSubview:imageView1];

            UILabel *label1 = [[UILabel alloc] initWithFrame:CGRectMake(10, 100, 145, 30)];
            label1.tag = self.tagnumber;
            [label1 setFont:[UIFont fontWithName:@"AppleGothic" size:14.0]];
            [label1 setTextColor:[UIColor blackColor]];
            [label1 setContentMode:UIViewContentModeScaleToFill];
            [label1 setTextAlignment:NSTextAlignmentCenter];
            label1.text = @"Added 2days ago";;
            [label1 setNumberOfLines:1];
            [cell.contentView addSubview:label1];

            //Display next Image
            self.tagnumber++;
            object = _objects[self.tagnumber];
            UIImageView *imageView2= [[UIImageView alloc]initWithFrame:CGRectMake(165, 4, 145, 95)];

            imageView2.tag =self.tagnumber;
            NSLog(@"Tag number for Image2:%d", self.tagnumber);
            imageView2.image = [UIImage imageWithData:object.artimageData];
            [imageView2 setContentMode:UIViewContentModeScaleAspectFill];
            [imageView2 setClipsToBounds:YES];
            [cell.contentView addSubview:imageView2];

            UILabel *label2 = [[UILabel alloc] initWithFrame:CGRectMake(165, 100, 145, 30)];
            label2.tag = self.tagnumber;
            [label2 setFont:[UIFont fontWithName:@"AppleGothic" size:14.0]];
            [label2 setTextColor:[UIColor blackColor]];
            [label1 setContentMode:UIViewContentModeScaleToFill];
            [label2 setTextAlignment:NSTextAlignmentCenter];
            label2.text = @"Added 3days ago";;
            [label2 setNumberOfLines:1];
            [cell.contentView addSubview:label2];
            self.tagnumber++;
            [self dismissMegaAnnoyingPopup];
            return cell;

        }
    }
return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    //Hide Category view if not
    UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];

    //[self performSegueWithIdentifier:@"ShowGalleryDetail" sender:cell];

    int rownumber = cell.tag;

    //Here i get 0 for rownnumber and even if i use indexpath.row**
    NSLog (@"Current Page for article is:%i",  rownumber);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T04:32:10.240

在您的`cellForRowAtIndexPath`方法中，您设置 a 的标签`UIImageView`或 a 的标签`UILabel`。

在您的`didSelectRowAtIndexPath`方法中，您将获得单元格的标签。

获取单元格中的图像视图或标签的标签，或设置单元格的标签。

# vb.net - 寻找应用的中心 - VB.net

> ID：15167555
> 
> 赞同：-1
> 
> 时间：2013-03-01T21:59:39.463
> 
> 标签：vb.net

我想找到我的应用程序的中心。请在说 Me.Width / 2 之前阅读。

我正在加载一个网页，其中包含一个基于 Java 的应用程序，并且希望在页面加载后自动单击“登录”按钮。VB 应用程序是固定大小的，但不会最大化，允许用户在屏幕上移动应用程序。我在想的是做类似的事情..

```
SetCursorPos({CenterOfApp.Width} + 20, {CenterOfApp.Height}) 
```

..然后模拟鼠标点击。

帮助将不胜感激，谢谢！

编辑 1 - 我相信答案可能在下面，我只是不确定所需的公式。我再说一遍，这是一个固定大小的 VB.net 应用程序，加载一个固定大小的 Java 应用程序会抛出 VB.net 浏览器控件。该按钮将始终位于 VB.net 应用程序的同一位置，但 VB.net 应用程序不会始终位于计算机屏幕的同一位置。意思是，我需要根据 VB.net 应用程序在计算机屏幕上的位置找到它的中心。

```
Dim ScreenWidth As Integer = Screen.PrimaryScreen.Bounds.Width
Dim ScreenHeight As Integer = Screen.PrimaryScreen.Bounds.Height
Dim ClientLeft As Integer = Me.Location.X
Dim LeftOfScreenToApp As Integer ' This is to be the distance from the left side of the screen to the left side of the VB app.
LeftOfScreenToApp = ...
SetCursorPos(LeftOfScreenToApp + (Me.Width / 2) + 20, Me.Height / 2) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T00:17:10.010

碰巧我只是忽略了 Me.Location.X 是从屏幕左侧到 VB.net 应用程序左侧的偏移量，所以..

```
Dim LeftOfScreenToLeftOfApp As Integer = Me.Location.X
Dim MiddleOfApp As Integer = LeftOfScreenToLeftOfApp + Me.Width / 2 
```

..获取应用程序的中心，无论它位于屏幕上的哪个位置。

# bash - .netrc、.fetchmailrc 和非硬编码密码

> ID：15167567
> 
> 赞同：1
> 
> 时间：2013-03-01T22:00:29.497
> 
> 标签：bash, rc, backticks, .netrc

有没有办法`.netrc`或者`.fetchmailrc`可以

1.  从环境变量中获取密码，或
2.  从衍生/分叉的外壳中获取它们？

`mutt`可以这样做：

```
set my_pw_gmail=`some shell command that emits to stdout` 
```

这些 RC 文件中是否有类似的能力？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T03:51:51.637

这取决于如何读取和解释配置文件。这意味着 c/c++/java 或其他必须调用`system()`后面 tic-ed 字符串的等价物。

BSD 的 ftp 和 gnu ftp 使用环境变量来查找 .netrc。对于 gnu（您可能拥有的） export `NETRC=/path/to/different` where /path/to/different 是 .netrc 的一个版本所在的目录。它还将使用 HOME 作为默认的 .netrc

在这里阅读：http: [//www.manpagez.com/man/1/ftp/](http://www.manpagez.com/man/1/ftp/)

BSD ftp 使用 HOME 变量来查找 .netrc。

fetchmail 不一样

```
HOME_ETC
If the HOME_ETC variable is set, fetchmail will read $HOME_ETC/.fetchmailrc instead of ~/.fetchmailrc.
If HOME_ETC and FETCHMAILHOME are both set, HOME_ETC will be ignored. 
```

见： http: [//linux.die.net/man/1/fetchmail](http://linux.die.net/man/1/fetchmail)

因此，环境变量是您问题的答案，因为您在查询中暗示使用它们。但答案意味着您需要几个不同的文件，而不仅仅是一个。

# java - 如何从 Fragment 访问 Activity 内的按钮

> ID：15167572
> 
> 赞同：2
> 
> 时间：2013-03-01T22:00:50.397
> 
> 标签：java, android

如何从 Fragment 访问 Activity 内的 Button。实际上我设置 myButton 被禁用但是当我的一些单选按钮被点击时我想设置 myButton 启用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T22:10:07.783

您可以尝试几件事。第一个是用来`getActivity().findViewByIt(id)`获取`Button`，我认为它应该可以工作，但从工程方面来看这不是一个好的解决方案，因为您会对托管它`Fragment`的布局做出假设。`Activity`第二个是提供一个回调接口，如此处[所述](http://developer.android.com/guide/components/fragments.html#CommunicatingWithActivity)。每次复选框更改状态时只需调用回调方法。这种方法更好，因为`Fragment`任何实现回调接口的活动都可以自由地重用它。最后但并非最不重要的一点是，如果可能，您应该尝试将片段放入`Button`片段内部。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T22:12:57.500

这是一个例子：

在 MyFragment.java 中

```
public MyFragment extends Fragment {
    public interface Callback {
        public void onRadioButtonClicked(View radioButton);
    }

    private Callback callback;

    @Override
    public void onAttach(Activity ac) {
        super.onAttached(ac);
        callback = (Callback)ac;
    }

    @Override
    public void onDetach() {
        callback = null;
        super.onDetach();
    }

    ....
    ....
       radioButton.setOnClickListener(new OnClickListener() {
           public void onClick(View view) {
               if (callback != null) {
                   callback.onRadioButtonClicked(view);
               }
           }
       });
} 
```

在托管/包含 MyFragment 的 MyActivity.java 中：

```
public MyActivity extends Activity implements MyFragment.Callback {

    ...
    @Override
    public void onRadioButtonClicked(View radioButton) {
        // The radiobutton in MyFragment has been clicked
        myButton.setEnabled(true); // or something like this.
    }

} 
```

该设计使用`MyFragment.Callback`接口将托管 Activity 的细节远离 Fragment，只要 Activity 实现，就允许 Fragment 由任何 Activity 托管`MyFragment.Callback`。

# r - 在不丢失格式的情况下将新行插入数据框

> ID：15167575
> 
> 赞同：1
> 
> 时间：2013-03-01T22:00:59.173
> 
> 标签：r, dataframe, insertion

我正在尝试创建一个大的空 data.frame 并插入一组行。我在许多论坛上看到了一些类似的问题，但是我无法成功地将其中任何一个应用于我遇到的特定格式问题。

我从 rbind(df,allic) # allic 是我想插入到 df 中的数据框开始 # 但是，鉴于我的数据集的大小，该操作需要 5 1/2 分钟才能完成。我知道在开始时创建数据框并替换行可以提高效率，但是我无法让它解决我的问题。代码如下：

初始数据：

```
 Order.ID                  Product
1    193505              Onion Rings
2    193505 Pineapple Cheddar Burger
3    193623            Fountain Soda
4    193623             French Fries
5    193623                Hamburger
6    193623                  Hot Dog
7    193631             French Fries
8    193631                Hamburger
9    193631                Milkshake 
```

产品与下面的不匹配，但这是一个格式问题，我认为最好显示将我带到现在的格式。

```
nb$Order.ID <- as.factor(nb$Order.ID)
plist <- aggregate(nb$Product,list(nb$Order.ID),list)
allp <- unique(unlist(plist$x))
allic <- expand.grid(plist$x[[1]], Var2=plist$x[[1]], Var3=1)

                      Var1                     Var2 Var3
1              Onion Rings              Onion Rings    1
2 Pineapple Cheddar Burger              Onion Rings    1
3              Onion Rings Pineapple Cheddar Burger    1
4 Pineapple Cheddar Burger Pineapple Cheddar Burger    1 
```

现在我使用以下方法创建一个空数据框（df）：

```
df <- data.frame(factor=rep(NA, rcnt), factor=rep(NA,rcnt), stringsAsFactors=FALSE) 
```

rcnt 是一个很大的任意数字，我计划在操作完成后对其进行修剪。当我尝试使用以下方法插入这些行时，我的问题就出现了：

```
df[1:4,] <- allic
head(df, n=10)

  factor factor.1
1      47       47
2      51       47
3      47       51
4      51       51
5      NA       NA
6      NA       NA
7      NA       NA
8      NA       NA 
```

如何在数据框中插入行而不丢失值的格式？我将不胜感激在这一点上我能得到的任何帮助。

**编辑**下面的每条评论：

```
>df[i] <- for(i in 1:nrow(plist)) {
>       allic <- expand.grid(plist$x[[i]], Var2=plist$x[[i]], Var3=1) 
>       df[i:nrow(allic),] <- sapply(allic, as.character) 
```

我对 R 还是很陌生，但是当我使用 df <- rbind(df,allic) 时这很有效。nrow(df) 是 4096。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:33:34.760

`as.character`尝试如下包装 allic ：

```
df[1:4,] <- sapply(allic, as.character)

> df
                     factor                 factor.1
1               Onion Rings              Onion Rings
2  Pineapple Cheddar Burger              Onion Rings
3               Onion Rings Pineapple Cheddar Burger
4  Pineapple Cheddar Burger Pineapple Cheddar Burger
5                      <NA>                     <NA>
6                      <NA>                     <NA>
7                      <NA>                     <NA>
8                      <NA>                     <NA>
9                      <NA>                     <NA>
10                     <NA>                     <NA> 
```

# java - 在活动之间传递“偏好变量”，在原始活动中设置值

> ID：15167580
> 
> 赞同：1
> 
> 时间：2013-03-01T22:01:22.470
> 
> 标签：java, android

我试图允许用户以文本形式输入其模块的蓝牙地址。

按下`Menu`活动 1 ( `MainActivity.java`) 会弹出一个选项菜单。选择`Settings`切换到活动 2 ( `SetPreferences.java`)。在文本框中输入 MAC 地址并按`Apply`恢复活动 1，地址的值没有变化。

任何帮助将不胜感激！

开始代码：

MainActivity.java：

```
package com.showstopperled.defiance;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.util.Random;
import java.util.UUID;

import android.app.Activity;
import android.bluetooth.BluetoothAdapter;
import android.bluetooth.BluetoothDevice;
import android.bluetooth.BluetoothSocket;
import android.content.Intent;
import android.content.SharedPreferences;
import android.graphics.Color;
import android.os.Bundle;
import android.os.Environment;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.AdapterView;
import android.widget.SeekBar;
import android.widget.SeekBar.OnSeekBarChangeListener;
import android.widget.Spinner;
import android.widget.TextView;
import android.widget.Toast;

import com.showstopperled.defiance.ColorPickerDialog.OnColorChangedListener;

public class MainActivity extends Activity implements OnColorChangedListener {

    public static final String PREFS_NAME = "DefiancePrefsFile";
    static String Packet = null;
    private BluetoothAdapter mBluetoothAdapter = null;
    private BluetoothSocket btSocket = null;
    private static OutputStream outStream = null;

    SeekBar seekbarUnicorns, seekbarChan, seekbarRed, seekbarGreen,
            seekbarBlue, seekbarBand, seekbarSens;
    TextView valueUnicorns, valueChan, valueRed, valueGreen, valueBlue,
            valueBand, valueSens, valueSave;
    static int Channel = 0;
    static int Rset = 255;
    static int Gset = 0;
    static int Bset = 0;
    static int Mode = 0;
    static int Band = 0;
    static int Sens = 24;
    static int Save = 0;
    static int Unicorns = 0;

    String audB = "63Hz";

    private static final UUID MY_UUID = UUID
            .fromString("00001101-0000-1000-8000-00805F9B34FB");

    // hardcoded MAC address
    static String address = null;
    private BufferedReader buf;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);

        valueChan = (TextView) findViewById(R.id.textViewChan);
        seekbarChan = (SeekBar) findViewById(R.id.seekBarChan);
        valueRed = (TextView) findViewById(R.id.textViewRed);
        seekbarRed = (SeekBar) findViewById(R.id.seekBarRed);
        valueGreen = (TextView) findViewById(R.id.textViewGreen);
        seekbarGreen = (SeekBar) findViewById(R.id.seekBarGreen);
        valueBlue = (TextView) findViewById(R.id.textViewBlue);
        seekbarBlue = (SeekBar) findViewById(R.id.seekBarBlue);
        valueBand = (TextView) findViewById(R.id.textViewBand);
        seekbarBand = (SeekBar) findViewById(R.id.seekBarBand);
        valueSens = (TextView) findViewById(R.id.textViewSens);
        seekbarSens = (SeekBar) findViewById(R.id.seekBarSens);
        valueUnicorns = (TextView) findViewById(R.id.textViewUnicorns);
        seekbarUnicorns = (SeekBar) findViewById(R.id.seekBarUnicorns);

        Spinner s = (Spinner) findViewById(R.id.spinnerMode);
        s.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {

            public void onItemSelected(AdapterView<?> adapter, View v, int i,
                    long lng) {
                Mode = i;
                packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns,
                        Save);
            }

            public void onNothingSelected(AdapterView<?> arg0) {
                // do something else
            }
        });

        mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
        if (mBluetoothAdapter == null) {
            Toast.makeText(this, "Bluetooth is not available.",
                    Toast.LENGTH_LONG).show();
            finish();
            return;
        }

        if (!mBluetoothAdapter.isEnabled()) {
            Toast.makeText(this,
                    "Please enable your BT and re-run this program.",
                    Toast.LENGTH_LONG).show();
            finish();
            return;
        }

        int sbar_chan_position = settings.getInt("seekbar_chan_pref", 0);
        seekbarChan.setProgress(sbar_chan_position);
        valueChan.setText("Channel: " + sbar_chan_position);
        Channel = sbar_chan_position;

        int sbar_red_position = settings.getInt("seekbar_red_pref", 0);
        seekbarRed.setProgress(sbar_red_position);
        valueRed.setText("Red: " + sbar_red_position);
        Rset = sbar_red_position;

        int sbar_green_position = settings.getInt("seekbar_green_pref", 0);
        seekbarGreen.setProgress(sbar_green_position);
        valueGreen.setText("Green: " + sbar_green_position);
        Gset = sbar_green_position;

        int sbar_blue_position = settings.getInt("seekbar_blue_pref", 0);
        seekbarBlue.setProgress(sbar_blue_position);
        valueBlue.setText("Blue: " + sbar_blue_position);
        Bset = sbar_blue_position;

        int sbar_band_position = settings.getInt("seekbar_band_pref", 0);
        seekbarBand.setProgress(sbar_band_position);
        valueBand.setText("Band: " + sbar_band_position);
        Band = sbar_band_position;

        int sbar_sens_position = settings.getInt("seekbar_sens_pref", 0);
        seekbarSens.setProgress(sbar_sens_position);
        valueSens.setText("Sensitivity: " + sbar_sens_position);
        Sens = sbar_sens_position;

        int sbar_unicorns_position = settings
                .getInt("seekbar_unicorns_pref", 0);
        seekbarUnicorns.setProgress(sbar_unicorns_position);
        valueUnicorns.setText("Unicorns!: " + sbar_unicorns_position);
        Unicorns = sbar_unicorns_position;

        seekbarChan.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {

            public void onProgressChanged(SeekBar seekBar, int progress,
                    boolean fromUser) {
                valueChan.setText("Channel: " + (progress + 1));
                Channel = progress;
                packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns,
                        Save);
            }

            public void onStartTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }

            public void onStopTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }
        });

        seekbarRed.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {

            public void onProgressChanged(SeekBar seekBar, int progress,
                    boolean fromUser) {
                valueRed.setText("Red: " + progress);

                Rset = progress;
                packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns,
                        Save);
            }

            public void onStartTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }

            public void onStopTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }
        });

        seekbarGreen.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {

            public void onProgressChanged(SeekBar seekBar, int progress,
                    boolean fromUser) {
                valueGreen.setText("Green: " + progress);

                Gset = progress;
                packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns,
                        Save);

            }

            public void onStartTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }

            public void onStopTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }
        });

        seekbarBlue.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {

            public void onProgressChanged(SeekBar seekBar, int progress,
                    boolean fromUser) {
                valueBlue.setText("Blue: " + progress);

                Bset = progress;
                packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns,
                        Save);

            }

            public void onStartTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }

            public void onStopTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }
        });

        seekbarBand.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {

            public void onProgressChanged(SeekBar seekBar, int progress,
                    boolean fromUser) {
                switch (progress) {
                case 0:
                    audB = "63Hz";
                    break;
                case 1:
                    audB = "160Hz";
                    break;
                case 2:
                    audB = "400Hz";
                    break;
                case 3:
                    audB = "1kHz";
                    break;
                case 4:
                    audB = "2.5kHz";
                    break;
                case 5:
                    audB = "6.25kHz";
                    break;
                case 6:
                    audB = "16kHz";
                    break;
                }
                valueBand.setText("Band: " + audB);

                Band = progress;
                packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns,
                        Save);

            }

            public void onStartTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }

            public void onStopTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }
        });

        seekbarSens.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {

            public void onProgressChanged(SeekBar seekBar, int progress,
                    boolean fromUser) {
                valueSens.setText("Sensitivity: " + (progress + 1));

                Sens = progress;
                packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns,
                        Save);

            }

            public void onStartTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }

            public void onStopTrackingTouch(SeekBar seekBar) {
                // TODO Auto-generated method stub
            }
        });

        seekbarUnicorns
                .setOnSeekBarChangeListener(new OnSeekBarChangeListener() {

                    public void onProgressChanged(SeekBar seekBar,
                            int progress, boolean fromUser) {
                        valueUnicorns.setText("Unicorns!: " + progress);

                        Unicorns = progress;
                        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens,
                                Unicorns, Save);

                    }

                    public void onStartTrackingTouch(SeekBar seekBar) {
                        // TODO Auto-generated method stub
                    }

                    public void onStopTrackingTouch(SeekBar seekBar) {
                        // TODO Auto-generated method stub
                    }
                });

    }

    public boolean onCreateOptionsMenu(Menu menu) {
        super.onCreateOptionsMenu(menu);
        menu.add(0, 0, 0, "Settings");
        menu.add(0, 1, 0, "About");
        menu.add(0, 2, 0, "Help");
        return true;
    }

    public boolean onOptionsItemSelected(MenuItem item) {
        super.onOptionsItemSelected(item);
        switch (item.getItemId()) {
        case 0:
            Intent intent = new Intent();
            intent.setClass(MainActivity.this, SetPreferences.class);
            startActivityForResult(intent, 0);
            address = intent.getExtras().getString("address");
            SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
            SharedPreferences.Editor editor = settings.edit();
            editor.putString("address", address);
            editor.commit();
            return true;
        case 1:
            // launch ABOUT here
            break;
        case 2:
            // Launch here
            break;
        default:
            // Launch SETTINGS here
            break;
        }
        return false;
    }

    public boolean onPrepareOptionsMenu(Menu menu) {
        return super.onPrepareOptionsMenu(menu);
    }

    public void colorChanged(int color) {

        int sbar_red_position = Color.red(color);
        int sbar_green_position = Color.green(color);
        int sbar_blue_position = Color.blue(color);

        seekbarRed.setProgress(sbar_red_position);
        valueRed.setText("Red: " + sbar_red_position);
        Rset = sbar_red_position;

        seekbarGreen.setProgress(sbar_green_position);
        valueGreen.setText("Green: " + sbar_green_position);
        Gset = sbar_green_position;

        seekbarBlue.setProgress(sbar_blue_position);
        valueBlue.setText("Blue: " + sbar_blue_position);
        Bset = sbar_blue_position;
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
    }

    @Override
    public void onStart() {
        super.onStart();
    }

    @Override
    public void onResume() {
        super.onResume();
        try {
            File f = new File(Environment.getExternalStorageDirectory()
                    + "/Defiance.txt");
            FileInputStream fileIS = new FileInputStream(f);
            buf = new BufferedReader(new InputStreamReader(fileIS));
            String readString = new String();
            // just reading each line and pass it on the debugger
            while ((readString = buf.readLine()) != null) {
                address = readString;
            }
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

        // When this returns, it will 'know' about the server,
        // via it's MAC address.
        BluetoothDevice device = mBluetoothAdapter.getRemoteDevice(address);

        try {
            btSocket = device.createRfcommSocketToServiceRecord(MY_UUID);
        } catch (IOException e) {
        }

        mBluetoothAdapter.cancelDiscovery();

        try {
            btSocket.connect();
        } catch (IOException e) {
            try {
                btSocket.close();
            } catch (IOException e2) {
            }
        }

        // Create a data stream so we can talk to server.
        try {
            outStream = btSocket.getOutputStream();
        } catch (IOException e) {
        }
    }

    public void onClickSave1(View v) throws IOException {
        Save = 100;
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
        Save = 0;
    }

    public void onClickSave2(View v) throws IOException {
        Save = 200;
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
        Save = 0;
    }

    public void onClickSave3(View v) throws IOException {
        Save = 300;
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
        Save = 0;
    }

    public void onClickSave4(View v) throws IOException {
        Save = 400;
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
        Save = 0;
    }

    public void onClickSave5(View v) throws IOException {
        Save = 500;
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
        Save = 0;
    }

    public void onClickLoad1(View v) throws IOException {
        Save = 10;
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
        Save = 0;
    }

    public void onClickLoad2(View v) throws IOException {
        Save = 20;
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
        Save = 0;
    }

    public void onClickLoad3(View v) throws IOException {
        Save = 30;
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
        Save = 0;
    }

    public void onClickLoad4(View v) throws IOException {
        Save = 40;
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
        Save = 0;
    }

    public void onClickLoad5(View v) throws IOException {
        Save = 50;
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
        Save = 0;
    }

    public void onClickApply(View v) throws IOException {

        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
    }

    @Override
    public void onPause() {
        super.onPause();

        SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
        SharedPreferences.Editor editor = settings.edit();
        editor.putInt("seekbar_red_pref", Rset);
        editor.putInt("seekbar_green_pref", Gset);
        editor.putInt("seekbar_blue_pref", Bset);
        editor.putString("address", address);
        editor.commit();

        if (outStream != null) {
            try {
                outStream.flush();
            } catch (IOException e) {
            }
        }

        try {
            btSocket.close();
        } catch (IOException e2) {
        }
    }

    @Override
    public void onStop() {
        super.onStop();
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        // Stop the Bluetooth chat services

    }

    public void onClickColorPicker(View v) {
        new ColorPickerDialog(this, this, Color.rgb(Rset, Gset, Bset)).show();
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
    }

    public void onClickRandomColor(View v) {
        Random rnd = new Random();
        int min = 0, max = 255;
        int randomRed = rnd.nextInt(max - min + 1) + min;
        int randomGreen = rnd.nextInt(max - min + 1) + min;
        int randomBlue = rnd.nextInt(max - min + 1) + min;
        Rset = randomRed;
        Gset = randomGreen;
        Bset = randomBlue;
        new ColorPickerDialog(this, this, Color.rgb(Rset, Gset, Bset)).show();
        packet(Channel, Rset, Gset, Bset, Mode, Band, Sens, Unicorns, Save);
    }

    public static void packet(int Channel, int Rset, int Gset, int Bset,
            int Mode, int Band, int Sens, int Unicorns, int Save) {
        int Rfin;
        int Gfin;
        int Bfin;
        int Sfin;
        int Ufin;
        Rfin = Rset * 16;
        Rfin = 4095 - Rfin;
        Gfin = Gset * 16;
        Gfin = 4095 - Gfin;
        Bfin = Bset * 16;
        Bfin = 4095 - Bfin;
        Sfin = Sens * 32;
        Ufin = Unicorns * 10;
        Ufin = 1000 - Ufin;
        Packet = "<HMG:" + Channel + ":" + Rfin + ":" + Gfin + ":" + Bfin + ":"
                + Mode + ":" + Band + ":" + Sfin + ":" + Ufin + ":" + Save
                + ">";
        byte[] msgBuffer;
        msgBuffer = Packet.getBytes();
        try {
            outStream.write(msgBuffer);
        } catch (IOException e) {
        }
    }
} 
```

SetPreferences.java：

```
package com.showstopperled.defiance;

import java.io.IOException;

import android.app.Activity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.view.View;
import android.widget.EditText;
import android.widget.TextView;

public class SetPreferences extends Activity {

    EditText editMac;
    TextView valueMac;
    String address;
    public static final String PREFS_NAME = "DefiancePrefsFile";

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.set_preferences);
        EditText MacAddress = (EditText) findViewById(R.id.editMac);
        MacAddress = (EditText) findViewById(R.id.editMac);
        address = MacAddress.getText().toString();
        valueMac = (TextView) findViewById(R.id.textViewMac);
    }

    public void onClickMac(View v) throws IOException {
        SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
        SharedPreferences.Editor editor = settings.edit();
        editor.putString("address", address);
        editor.commit();
        address = settings.getString("address", address);
        valueMac.setText("Mac Address: " + address);
        Intent i = new Intent(this, MainActivity.class);
        i.putExtra("address", address);
        startActivity(i);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:16:00.317

看起来您正在执行 startActivityForResult，然后获取意图的值。

这不起作用，原因如下：

1.  startActivityForResult 直到您调用它的方法（或更具体地说，在 UI Thread Looper 中运行的事件）返回时才会真正触发。

2.  要获得活动的结果，您应该使用[onActivityResult](https://developer.android.com/reference/android/app/Activity.html#onActivityResult%28int,%20int,%20android.content.Intent%29)。此意图将具有您想要的值。

你所做的是告诉 Looper 在方法返回时启动活动，然后你会从你自己的意图中获得额外的东西，然后返回并让活动开始。当它返回时，您不会检查它的结果。

# email - 响应来自 Emacs 的 Outlook 会议请求

> ID：15167585
> 
> 赞同：2
> 
> 时间：2013-03-01T22:01:42.753
> 
> 标签：email, emacs, outlook

我正在尝试在 Linux 下阅读来自 Emacs 的电子邮件。我正在使用 Notmuch 邮件客户端。到目前为止，一切顺利，我设法发送电子邮件，甚至集成了 LDAP。

但是，我收到 Outlook 会议请求。我通常使用 Mozilla Thunderbird 的 Lighting 插件回复此类电子邮件。

如何响应来自 Emacs 的 Outlook 会议请求？

# python - 过滤后的filed.function之和

> ID：15167587
> 
> 赞同：0
> 
> 时间：2013-03-01T22:01:46.550
> 
> 标签：python, function, openerp

我正在创建一个模块 openERP，我的班级有 3 个栏目：

函数中的hour_from（类型float），hour_to（类型float）和totalhour（fileds.function）我计算hour_from和hour_to之间的差异

```
def _total(self, cr, uid, ids, name, args, context=None):
res = {}
for record in self.browse(cr, uid, ids, context=context):
    res[record.id] =  record.hour_to - record.hour_from
return res

 _columns = {
'hour_from' : fields.float('Work from', required=True, help="Start and End time of working.", select=True),
    'hour_to' : fields.float("Work to", required=True),
     'totalhour' : fields.function(_total, type='float', method=True, string='Total Hour'),

} 
```

在 xml 文件中，我在树记录中有以下代码：

```
<field name="arch" type="xml">
  <field name="hour_from" widget="float_time" string="Heure début"/>
  <field name="hour_to" widget="float_time" string="Heure fin" />
  <field name="totalhour" widget="float_time"/>
  </field>
</field> 
```

当我尝试按用户过滤树结果时，它工作得很好我的问题追加了例如

我有一些hour_to，hour_from的总和，但不是totalhour的总和。好吧，我想要的是不同的：我只想拥有总小时数的总和。

我希望我能解释我的问题。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T13:37:34.423

尝试在总小时字段中使用“总和”：

```
<field name="arch" type="xml">
  <field name="hour_from" widget="float_time" string="Heure début"/>
  <field name="hour_to" widget="float_time" string="Heure fin" />
  <field name="totalhour" widget="float_time" sum="Total"/>
 </field>
</field> 
```

# c# - Bitmap.Save 参数无效

> ID：15167588
> 
> 赞同：6
> 
> 时间：2013-03-01T22:02:05.467
> 
> 标签：c#, encoding, bitmap, gdi+, tiff

我`Bitmap.Save(location,coded,parameters)`用来保存 tiff 图像的第一帧：使用的编码方案是 Tiff 格式。然后我用`saveadd()`等等。在 win 7 64 位上像魅力一样工作，*但在 32 位或更早的 Windows 版本上不起作用。*

经过研究，我发现这可能是由于 tiff 图像编码与 GDI+ 之前的图像编码处理方式不同。

**有没有办法在没有任何剧烈变化的情况下克服这个问题？**

资料来源：

[参数无效调用 Bitmap.Save()](https://stackoverflow.com/questions/5397544/parameter-is-not-valid-calling-bitmap-save)

[http://social.msdn.microsoft.com/Forums/fi-FI/netfxbcl/thread/1585c562-f7a9-4cfd-9674-6855ffaa8653](http://social.msdn.microsoft.com/Forums/fi-FI/netfxbcl/thread/1585c562-f7a9-4cfd-9674-6855ffaa8653)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-01T22:14:39.757

您必须使用“long”作为质量参数

```
EncoderParameters parametre = new EncoderParameters(1);
parametre.Param[0] = new EncoderParameter(System.Drawing.Imaging.Encoder.Quality, (quality as long)); 
```

或者

```
EncoderParameters parametre = new EncoderParameters(1);
parametre.Param[0] = new EncoderParameter(System.Drawing.Imaging.Encoder.Quality, 90L); 
```

或者

```
long quality=90; //
EncoderParameters parametre = new EncoderParameters(1);
parametre.Param[0] = new EncoderParameter(System.Drawing.Imaging.Encoder.Quality, quality); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T12:06:25.903

好的，终于找到解决方案了。问题在于作为 Save() 的输入参数之一给出的压缩格式以及 GDI+ 的工作方式。

**解决方案1：**

需要将压缩格式更改为该窗口支持的格式。例如）`(long)EncoderValue.CompressionLZW`.net 中的压缩在这种情况下有效，而不是`(long)EncoderValue.CompressionCCITT4`.

但图像的大小将高于 CCITT4 生成的图像。此外，CCITT4 仅适用于双色调图像，而 LZW 适合大多数图像。因此，请提前考虑这些问题，就像在大多数使用 tiff 图像创建的地方一样，对使用的压缩和这个问题的重视程度并不高。

或者可以在下面找到替代解决方案[虽然我没有尝试过]

**解决方案2：**

[http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/1585c562-f7a9-4cfd-9674-6855ffaa8653/](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/1585c562-f7a9-4cfd-9674-6855ffaa8653/)

**补充阅读：**

所以关于选择什么压缩以及为什么会出现问题，您可以参考：

[https://stackoverflow.com/questions/3478292/whats-the-recommended-tiff-compression-for-color-photos/3480411#3480411](https://stackoverflow.com/questions/3478292/whats-the-recommended-tiff-compression-for-color-photos/3480411#3480411)

# php - 在 PHP 中调用多个访问器？

> ID：15167589
> 
> 赞同：-3
> 
> 时间：2013-03-01T22:02:07.667
> 
> 标签：php

我对编程很陌生，所以请忍受我的无知。

假设我有一个名为 Name 的类，它只接受一个参数

```
private $first;

public function __construct($f) {
    $this->first=$f;
} 
```

我想为此有两个访问器：一个返回名字的给出方式（比如 getNameNormal()），另一个返回全部大写的名字（比如 getNameCaps()）。

这可能吗？怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:05:46.130

就像是：

```
class Name {
    private $first;

    public function __construct($f=null){
        if(!is_null($f)){
            $this->first = $f;
        }
    }

    public function getFirst(){
        return $this->first;
    }

    public function getUpperFirst(){
        return strtoupper($this->first);
    }
}
$n = new Name("test");
echo $n->getFirst().'<br>';
echo $n->getUpperFirst(); 
```

[http://codepad.viper-7.com/tdidmO](http://codepad.viper-7.com/tdidmO)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:05:07.880

有几种不同的方法来做到这一点，但你在正确的轨道上。

```
public function getFirst(){
    return $this->first;
}

public function getFirstCaps(){
    return strtoupper($this->first);
} 
```

或者

```
public function getFirst($caps=false){
    if($caps){
      return strtoupper($this->first);
    }else{
      return $this->first;
    }
} 
```

# php - 以 HTML 格式输出的 PhpDocumentor2

> ID：15167590
> 
> 赞同：0
> 
> 时间：2013-03-01T22:02:10.203
> 
> 标签：php, phpdoc

一个大问题如何使用 PhpDocumentor2 在 HTML 中生成输出。

Bcs 它使用 .xml 文件生成 AST，但是当我尝试使用以下命令键入命令时：

```
-o HTML:frames:earthli 
```

我得到 [RunTimeException] that -o (--output) option not found ??? 为什么 ？？？

完整命令：

```
phpdoc.bat -o HTML:frames:earthli -d C:\Users\user\Documents\NetBeansProjects\AirAlliance\web -t C:\Users\user\Desktop\Dokumentacja --title Moje 
```

# cuda - CUDA 扭曲 / 块完成

> ID：15167591
> 
> 赞同：2
> 
> 时间：2013-03-01T22:02:16.743
> 
> 标签：cuda, gpu-warp

当一个 warp 完成一个内核，但同一块的另一个 warp 仍在运行时，完成的 warp 是否会被阻塞，直到同一块的其他 warp 完成，或者完成的 warp 是否可供另一个块立即重用，而另一个当前块的扭曲仍在运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T00:31:17.247

一个已完成的 warp 被淘汰，释放调度程序队列中的 warp 槽以用于另一个 warp，无论是来自同一个块还是另一个块。根据特定的硬件类型（计算能力），可以随时打开并准备好由 warp 调度程序执行的 warp 数量是有限的。在任何给定时间可以在 SM 上打开（计划）的线程块的数量也受到计算能力的限制。因此，如果除一个特定块之外的所有经线都已完成并退役，但一个经线仍处于活动状态，则该经线用完一个经线槽，并且它所属的块也用完一个块槽。只有当一个块的所有扭曲都完成并退役时，该块才会退役，释放它的块槽以供另一个块使用。

# ejb - 使用 Java EE 6 进行计划的数据库维护（连接生命周期）

> ID：15167598
> 
> 赞同：5
> 
> 时间：2013-03-01T22:02:34.140
> 
> 标签：ejb, java-ee-6, mybatis

我是 Java EE 6 的新手，所以如果这个问题的答案很明显，我深表歉意。我有一项必须每小时运行一次才能从数据库重建 Solr 索引的任务。我还希望在部署应用程序时进行重建。我的直觉是这应该有效：

```
@Singleton
@Startup
public class Rebuilder {
  @Inject private ProposalDao proposalDao;
  @Inject private SolrServer  solrServer;

  @Schedule(hour="*", minute="0", second="0")
  public void rebuildIndex() {
    // do the rebuild here
  }
} 
```

由于我使用的是 myBatis，所以我写了这个生产者：

```
public class ProposalSessionProvider {
  private static final String CONFIGURATION_FILE = "...";

  static {
    try {
      sessFactory = new SqlSessionFactoryBuilder().build(
        Resources.getResourceAsReader(CONFIGURATION_FILE));
    }
    catch (IOException ex) {
      throw new RuntimeException("Error configuring MyBatis: " + ex.getMessage(), ex);
    }
  }

  @Produces
  public ProposalsDao openSession() {
    log.info("Connecting to the database");
    session = sessFactory.openSession();
    return session.getMapper(ProposalsDao.class);
  }
} 
```

所以我有三个担心：

1.  在部署时触发重建的适当方法是什么？一种`@PostConstruct`方法？
2.  谁负责关闭数据库连接，这应该如何发生？我正在使用 myBatis，我相信它对 Java EE 生命周期一无所知。好像如果我使用`@Singleton`连接永远不会被释放，但是放`@Startup`一个`@Stateless`bean还有意义吗？
3.  Rebuilder 是否应该是单例？似乎不是我不能`@PostConstruct`用来处理初始重建，否则我每小时都会进行两次重建。

我不确定如何在这里进行。谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T09:23:31.340

我不知道 myBatis，但我可以告诉你，@Schedule 工作是事务性的。无论如何，我不确定 JTA 托管事务是否会根据您检索会话的方式应用在这里。
没有办法在 MyBatis 中检索 persistenceContext 吗？

对于触发器部分，恕我直言@Startup 将正确完成工作，因此需要一个单例 bean。无论如何，我无法告诉您您提出的两种方法中哪一种是最好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T18:39:50.470

对于调度部分，您是正确的；我会在一个单独的类中编写索引构建逻辑，并在一个单独的类中同时使用（Singleton？）@StartUp bean 和 @Schedule-annotated 方法调用它。

如果您不想在索引构建代码和所述类中的触发代码之间存在依赖关系，则所述 bean 可以使用 JMS 来触发索引重建。

我不太了解 myBatis，但是如果您的连接是由数据源 @Resource 管理的，那么我相信它确实可以从 CMT 中受益。

# php - 有没有办法从 URL 获取 facebook 洞察数据并将其放入 php 变量中？

> ID：15167599
> 
> 赞同：0
> 
> 时间：2013-03-01T22:02:34.140
> 
> 标签：php, javascript, facebook

我有这样的数据，在远程 URL 上：

```
{
   "data": [
      {
         "id": "1234567890",
         "name": "data_name",
         "period": "data_period",
         "values": [
            {
               "value": 52,
               "end_time": "2013-01-21T08:00:00+0000"
            },
            {
               "value": 54,
               "end_time": "2013-01-22T08:00:00+0000"
            },
            {
               "value": 57,
               "end_time": "2013-01-23T08:00:00+0000"
            },
            {
               "value": 58,
               "end_time": "2013-01-24T08:00:00+0000"
            }
      ],
         "title": "Some title",
         "description": "Some description"
      }
   ]
} 
```

有没有办法从链接中获取它到 php 变量中？我对 php 有很好的了解，但是我的 javascript 知识很差，所以我不知道如何做到这一点。从这一切来看，我实际上只需要“value”和“end_time”变量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:06:48.707

这里不需要 JavaScript。那是 JSON 表示法，它可以很容易地被 PHP 使用标准函数解析。

尝试这个：

```
$contents = file_get_contents($url); // You can also use cURL here if you like
$obj = json_decode($contents); 
```

然后，您可以将`$var`其视为对象。例如，`$obj->data[0]->values`将返回一个包含您的`value`和`end_time`字段的对象数组：

```
Array
(
    [0] => stdClass Object
        (
            [value] => 52
            [end_time] => 2013-01-21T08:00:00+0000
        )

    [1] => stdClass Object
        (
            [value] => 54
            [end_time] => 2013-01-22T08:00:00+0000
        )

    [2] => stdClass Object
        (
            [value] => 57
            [end_time] => 2013-01-23T08:00:00+0000
        )

    [3] => stdClass Object
        (
            [value] => 58
            [end_time] => 2013-01-24T08:00:00+0000
        )

) 
```

# python - 使用文件作为子进程的标准输入和标准输出

> ID：15167603
> 
> 赞同：26
> 
> 时间：2013-03-01T22:02:38.340
> 
> 标签：python, subprocess, stdout, stdin

如何使用 python 子进程模块复制以下批处理命令？

```
myprogram < myinput.in > myoutput.out 
```

换句话说，如何`myprogram`使用 的内容`myinput.in`作为标准输入和`myoutput.out`标准输出来运行？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-04-09T15:42:15.050

以下应该有效：

```
myinput = open('myinput.in')
myoutput = open('myoutput.out', 'w')
p = subprocess.Popen('myprogram.exe', stdin=myinput, stdout=myoutput)
p.wait()
myoutput.flush() 
```

# ios - Interface Builder 中的“宽度等于高度”约束

> ID：15167607
> 
> 赞同：94
> 
> 时间：2013-03-01T22:03:01.833
> 
> 标签：ios, interface-builder, autolayout, nslayoutconstraint

我找不到创建“方形”约束的方法，这意味着在 Interface Builder 中“宽度等于高度”。我想有可能以编程方式添加这样的约束。IB有什么我可以做的吗？也许我只是没看到？这似乎微不足道，但我找不到它。

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2013-04-18T17:53:23.923

**更新 Xcode 5.1b5**

![宽度等于高度](../Images/c7d4e153930de9d77391e9c786b65a0c.png)

Ctrl+单击并从视图中拖动并在指针位于视图上方时释放。选择“纵横比”。它将创建一个约束，其中第一项和第二项是视图。

* * *

**Xcode 5.1 之前**

你不能因为宽度/高度编辑器缺少与另一个属性相关的字段或设置比率：

![宽度约束](../Images/18ba375c9c1b1f9a6fb684b018425753.png)

因此，您不能在 Interface Builder 中表达以下代码：

```
CGFloat ratio = 1.0;
NSLayoutConstraint *constraint = [NSLayoutConstraint
    constraintWithItem:myView
    attribute:NSLayoutAttributeWidth
    relatedBy:NSLayoutRelationEqual
    toItem:myView
    attribute:NSLayoutAttributeHeight
    multiplier:ratio
    constant:0];
constraint.priority = 1000;
[myView.superview addConstraint:constraint]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-11-16T23:01:37.943

请在 UI 元素上添加一个新的约束，纵横比为 1:1，如图所示。

[![将纵横比设置为 1:1](../Images/984eb9383ed4ac63d5941a429aba1cdc.png)](https://i.stack.imgur.com/WYdJq.jpg)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-04T07:12:05.963

首先，控制从按钮对角拖动到自身。将出现一个上下文菜单，您可以在其中添加宽​​度和高度约束。Shift+单击每个；将出现一个复选标记，表示您已添加约束。（如果您在添加之前不小心关闭了对话框，没关系，只需重复拖动步骤并设置另一个）：

[![在此处输入图像描述](../Images/9977f32c80aabd9335653ff5807b164c.png)](https://i.stack.imgur.com/qgD5Q.png)

首次添加时，这些约束采用按钮的当前宽度和高度，因此您需要调整每个约束以赋予其更合适的值。尽管我们的图像是正方形的，但我们必须一次完成一个，因此请确保在两个约束中使用相同的常量值来按比例调整按钮的大小。双击约束，并在其常量字段中输入一个较小的值：

[![在此处输入图像描述](../Images/910e1870dd66d6fb06e025a50933350a.png)](https://i.stack.imgur.com/cJHV7.png)

# python - 有没有一种在python中遍历几个列表（有时它们是单值的）的好方法

> ID：15167615
> 
> 赞同：2
> 
> 时间：2013-03-01T22:03:41.240
> 
> 标签：python, numpy

所以基本上我的问题与'zip'（或izip）有关，而这个问题之前被问过......

[有没有更好的方法来迭代两个列表，每次迭代从每个列表中获取一个元素？](https://stackoverflow.com/questions/1919044/is-there-a-better-way-to-iterate-over-two-lists-getting-one-element-from-each-l)

如果我有两个变量 - 它们要么是长度为 n 的一维数组，要么是单个值，我如何循环遍历它们以便返回 n 个值。

'zip' kindof 做我想做的事——除了当我传入一个值和一个数组时它会抱怨。

我在下面有一个我的目标示例 - 基本上我有一个 ac 函数，它比 python 进行更有效的计算。我希望它像一些 numpy 函数一样工作 - 可以处理数组和标量的混合，所以我为它编写了一个 python 包装器。但是 - 就像我说的“zip”失败了。我想原则上我可以对 input 进行一些测试，并为标量和数组的每个变体编写不同的语句 - 但似乎 python 应该有更聪明的东西.... ;) 有什么建议吗？

```
"""
    Example of zip problems.
"""

import numpy as np
import time

def cfun(a, b) :
    """
        Pretending to be c function which doesn't deal with arrays
    """
    if not np.isscalar(a)   or  not np.isscalar(b)  :

        raise Exception('c is freaking out')
    else :

        return a+b

def pyfun(a, b) :
    """
        Python Wrappper - to deal with arrays input
    """

    if not np.isscalar(a)   or  not np.isscalar(b) :
        return np.array([cfun(a_i,b_i) for a_i, b_i in zip(a,b)])

    else :

        return cfun(a, b)

    return cfun(a,b)

a = np.array([1,2])
b= np.array([1,2])
print pyfun(a, b)

a = [1,2]
b = 1
print pyfun(a, b) 
```

**编辑 ：**

非常感谢大家的建议。认为我必须为 np.braodcast 寻求解决方案 - 因为从我的角度来看，它似乎是最简单的.....

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T23:49:07.347

由于您使用 numpy，因此您不需要`zip()`迭代多个数组和标量。您可以使用`numpy.broadcast()`：

```
In [5]:

list(np.broadcast([1,2,3], 10))

Out[5]:

[(1, 10), (2, 10), (3, 10)]

In [6]:

list(np.broadcast([1,2,3], [10, 20, 30]))

Out[6]:

[(1, 10), (2, 20), (3, 30)]

In [8]:

list(np.broadcast([1,2,3], 100, [10, 20, 30]))

Out[8]:

[(1, 100, 10), (2, 100, 20), (3, 100, 30)] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:03:30.153

如果要强制广播，可以使用`numpy.lib.stride_tricks.broadcast_arrays`. 重用你的`cfun`：

```
def pyfun(a, b) :
    if not (np.isscalar(a) and np.isscalar(b)) :
        a_bcast, b_bcast = np.lib.stride_tricks.broadcast_arrays(a, b)
        return np.array([cfun(j, k) for j, k in zip(a_bcast, b_bcast)])
    return cfun(a, b) 
```

现在：

```
>>> pyfun(5, 6)
11
>>> pyfun(5, [6, 7, 8])
array([11, 12, 13])
>>> pyfun([3, 4, 5], [6, 7, 8])
array([ 9, 11, 13]) 
```

对于您的特定应用程序，可能没有比 Rob 的纯 Python 事物更具优势，因为您的函数仍在 Python 循环中运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T22:51:49.300

选择性地将每个参数转换为序列的装饰器可能会有所帮助。这是普通的python（不是numpy）版本：

```
# TESTED
def listify(f):
  def dolistify(*args):
    from collections import Iterable
    return f(*(a if isinstance(a, Iterable) else (a,) for a in args))
  return dolistify

@listify
def foo(a,b):
  print a, b

foo( (1,2), (3,4) )
foo( 1, [3,4] )
foo( 1, 2 ) 
```

因此，在您的示例中，我们需要`not np.isscalar`用作谓词和`np.array`修饰符。因为装饰器，`pyfun`总是接收一个数组。

```
#UNTESTED
def listify(f):
  def dolistify(*args):
    from collections import Iterable
    return f(*(np.array([a]) if np.isscalar(a) else a for a in args))
  return dolistify

@listify
def pyfun(a, b) :
    """
        Python Wrappper - to deal with arrays input
    """

    return np.array([cfun(a_i,b_i) for a_i, b_i in zip(a,b)]) 
```

或者，也许您可​​以将相同的想法应用于`zip`：

```
#UNTESTED
def MyZip(*args):
  return zip(np.array([a]) if np.isscalar(a) else a for a in args)

def pyfun(a, b) :
    """
        Python Wrappper - to deal with arrays input
    """

    return np.array([cfun(a_i,b_i) for a_i, b_i in MyZip(a,b)]) 
```

# c# - Path.GetFileName 有多简单？

> ID：15167617
> 
> 赞同：2
> 
> 时间：2013-03-01T22:03:59.820
> 
> 标签：c#, asp.net, webmatrix, asp.net-webpages

如果我要编写这个方法，在 C#.net 中：

```
public static string returnFileNameOnly(string returnString)
{
    string val = returnString.Substring(returnString.LastIndexOf("/"));

    return val;
} 
```

我会几乎只是重写 Path.GetFileName 吗？或者还有更多的东西吗？据我所知，除非用户使用 Internet Explorer `Path.GetFileName(fileVariable.FileName)`，`fileVariable.FileName`否则返回相同的内容（尽管我只在 IE、Chrome 和 Firefox 上尝试过）。

不确定这是否就是该方法的全部内容，真的。

----------------对于那些好奇的人------------------------

我问是因为我很久以前在一个网站上使用过与我上面写的方法非常相似的东西，在我学习该`Path.GetFileName`方法之前，我不确定是否应该费心改变它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T22:19:00.990

根据 mscrolib disasm，我可以说 GetFileName 并不比你的实现复杂得多。 *GetFileName*执行以下操作。

1.  *GetFileName*检查路径是否包含无效字符 ( *System.IO.Path.CheckInvalidPathChars* )。
2.  之后，它使用*System.IO.Path.DirectorySeparatorChar*、*System.IO.Path.AltDirectorySeparatorChar*和*System.IO.Path.VolumeSeparatoChar*分割您的路径。
3.  然后才返回文件名。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T22:06:35.697

*   根本没有斜线的路径。
*   有反斜杠但没有正斜杠的路径。
*   有朝一日可能会使用非 Windows 文件名约定运行 .NET 的替代系统。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-01T22:08:30.503

你总是可以到处闲逛（共享源 | 转子 | 单声道 | 反射器 | dotPeek）：

```
public static string GetFileName(string path)
{
    if (path != null)
    {
        CheckInvalidPathChars(path);
        int length = path.Length;
        int num2 = length;
        while (--num2 >= 0)
        {
            char ch = path[num2];
            if (((ch == DirectorySeparatorChar) || 
                (ch == AltDirectorySeparatorChar)) || 
                (ch == VolumeSeparatorChar))
            {
                return path.Substring(num2 + 1, (length - num2) - 1);
            }
        }
    }
    return path;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-01T22:06:33.603

系统方法可能更复杂，因为您可以同时使用 / 和 \ 作为目录分隔符。但我肯定会说：**如果它有效，请不要尝试修复它！**

由于这个系统方法看起来简单而简短，我会去 ac# decompiler 看看它的内部。

Dis# - 著名的商业版本，提供试用版：http: [//www.netdecompiler.com/](http://www.netdecompiler.com/)

Jetbrains dotPeek - 另一个著名的，免费的：http: [//www.jetbrains.com/decompiler/](http://www.jetbrains.com/decompiler/)

# javascript - 一旦不基于时间触发调整大小事件

> ID：15167619
> 
> 赞同：3
> 
> 时间：2013-03-01T22:04:07.177
> 
> 标签：javascript, jquery, events

是否可以避免浏览器两次触发事件，但不是基于时间（如果您的调整大小事件执行持续很长时间，那么解决方案很糟糕）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T02:02:40.187

You can use `setTimeout()` and `clearTimeout()` in conjunction with [`jQuery.data`](http://api.jquery.com/jQuery.data/):

```
$(window).resize(function() {
    clearTimeout($.data(this, 'resizeTimer'));
    $.data(this, 'resizeTimer', setTimeout(function() {
        //do something
        alert("Haven't resized in 200ms!");
    }, 200));
}); 
```

**Update**

I wrote an *extension* to enhance jQuery's default `on` (& `bind`)-event-handler. It attaches an event handler function for one or more events to the selected elements if the event was not triggered for a given interval. This is useful if you want to fire a callback only after a delay, like the resize event, or else. [https://github.com/yckart/jquery.unevent.js](https://github.com/yckart/jquery.unevent.js)

```
;(function ($) {
    var methods = { on: $.fn.on, bind: $.fn.bind };
    $.each(methods, function(k){
        $.fn[k] = function () {
            var args = [].slice.call(arguments),
                delay = args.pop(),
                fn = args.pop(),
                timer;

            args.push(function () {
                var self = this,
                    arg = arguments;
                clearTimeout(timer);
                timer = setTimeout(function(){
                    fn.apply(self, [].slice.call(arg));
                }, delay);
            });

            return methods[k].apply(this, isNaN(delay) ? arguments : args);
        };
    });
}(jQuery)); 
```

Use it like any other `on` or `bind`-event handler, except that you can pass an extra parameter as a last:

```
$(window).on('resize', function(e) {
    console.log(e.type + '-event was 200ms not triggered');
}, 200); 
```

[http://jsfiddle.net/ARTsinn/EqqHx/](http://jsfiddle.net/ARTsinn/EqqHx/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:38:49.283

```
window.blockResize = false;
$(window).resize(function() {

    if (window.blockResize) return;

        //do stuff

    window.blockResize = true;
    setTimeout(function(){window.blockResize = false},200);

}); 
```

好的，它仍然基于计时器，但它现在适用于我的情况。

# nant - 在南安特 ，如何有条件 基于财产价值？

> ID：15167620
> 
> 赞同：8
> 
> 时间：2013-03-01T22:04:12.000
> 
> 标签：nant

我有一个 NAnt`<exec>`任务。我希望一个论点的存在以某些属性为条件`true`。

例如，我希望`-c`psExec 的命令行参数是有条件的。仅当 时才应输出`${pExec.copyprog == 'true'}`。

以下不起作用：

```
<property name="psExec.copyprog" value="false" />
...

<exec program="${psExec.path}" failonerror="false">
   ...
   <arg line="-c" if="${psExec.copyprog}==true" />
</exec> 
```

它产生以下错误：

```
'false==true' is not a valid value for attribute 'if' of <arg ... />.
    Cannot resolve 'false==true' to boolean value.
       String was not recognized as a valid Boolean. 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T06:50:15.560

NAnt 中的属性很棘手，因为它们没有类型，只是被视为类型`string`。所以这将是解决方案：

```
<exec program="${psExec.path}" failonerror="false">
  <!-- ... -->
  <arg line="-c" if="${bool::parse(psExec.copyprog)}" />
</exec> 
```

**更新：**过失！我错了。`if="${psExec.copyprog}"`也可以。所以有某种属性类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-03T15:12:44.317

你需要把它放在`==true`里面`{}`，但你也可以跳过它：

```
<arg line="-c" if="${psExec.copyprog}" /> 
```

比较`true`布尔表达式`true`不会改变结果。

# .htaccess - 301 将所有内容重定向到新网站根/整个网站，包括子页面？永久移动

> ID：15167630
> 
> 赞同：2
> 
> 时间：2013-03-01T22:04:46.770
> 
> 标签：.htaccess, redirect, mod-rewrite, http-status-code-301

快速更新

好的到达那里 这是 mod_alias 吗？

```
RedirectMatch 301 ^/ http://brightmist.co.uk/ 
```

我已经在所有内容下面添加了这一行代码，它似乎可以工作，但是我的其他目录，例如[http://brightmist.co.uk/blog/2013/02/23/manchester-art-gallery-feb-2013](http://brightmist.co.uk/blog/2013/02/23/manchester-art-gallery-feb-2013)告诉谷歌这些页面已经暂时移动 - 见[http://www.internetofficer.com/seo-tool/redirect-check/](http://www.internetofficer.com/seo-tool/redirect-check/)

这是否意味着我必须在我的网站上正确前进并添加重定向语气？

* * *

原始问题

我有一个新网站。我想将我所有的旧站点链接从[http://artygirl.co.uk](http://artygirl.co.uk)重定向到我的新站点[http://brightmist.co.uk/](http://brightmist.co.uk/)

我主要是一名拥有多年经验的设计师，主要使用 Photoshop、CSS、HTML、Wordpress 和 jQuery，但我对编辑 htaccess 文件之类的东西知之甚少。而且我不想弄错，因为这意味着谷歌排名下降等

有谁知道我可以粘贴到我的 htaccess 文件底部的任何脚本，我希望它将网站上的所有链接/页面重定向到与以前相同的位置。例如，如果我输入[http://artygirl.co.uk/buy-art-prints-cheshire/](http://artygirl.co.uk/buy-art-prints-cheshire/)我希望它转到[http://brightmist.co.uk/buy-art-prints-cheshire/](http://brightmist.co.uk/buy-art-prints-cheshire/)我是使用相同的主机，他们刚刚重新指向域

除其他外，我的主机最近添加了以下代码，我认为这也与域映射有关，这也是我的整个 htaccess 文件 -

```
ErrorDocument 401 /forms/401.html
ErrorDocument 403 /forms/403.html

RewriteEngine On
RewriteBase /

#uploaded files
RewriteRule ^(.*/)?files/$ index.php [L]
RewriteCond %{REQUEST_URI} !.*wp-content/plugins.*
RewriteRule ^(.*/)?files/(.*) wp-includes/ms-files.php?file=$2 [L]

# add a trailing slash to /wp-admin
RewriteCond %{REQUEST_URI} ^.*/wp-admin$
RewriteRule ^(.+)$ $1/ [R=301,L]

RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule . - [L]
RewriteRule  ^([_0-9a-zA-Z-]+/)?(wp-.*) $2 [L]
RewriteRule  ^([_0-9a-zA-Z-]+/)?(.*\.php)$ $2 [L]
RewriteRule . index.php [L]

<IfModule mod_security.c>
<Files async-upload.php>
SecFilterEngine Off
SecFilterScanPOST Off
</Files>
</IfModule>

<Files 403.shtml>
order allow,deny
allow from all
</Files>

deny from 218.143.4.127
deny from 143.90.221.204
deny from 95.135.78.190
deny from 114.108.150.74
deny from 95.135.111.205
deny from 91.124.239.150
deny from 94.178.2.93
deny from 91.124.206.118
deny from 91.124.226.116
deny from 118.98.32.34
deny from 94.180.252.133
deny from 58.27.140.58
deny from 77.93.197.83
deny from 88.191.63.27

# Hotlink Protection START #

RewriteEngine on
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?brightmist.co.uk [NC]
RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?google.com [NC]
RewriteRule \.(jpg|jpeg|png|gif)$ - [NC,F,L]

# Hotlink Protection END # 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T05:12:29.173

> 我想将我所有的旧网站链接重定向***`http://artygirl.co.uk/`***到我的新网站***`http://brightmist.co.uk/`***

有几种方法可以实现，所有方法都应该在`http://artygirl.co.uk/`根目录下的一个 .htaccess 文件中实现。

没有必要检查传入域，因为它必须是`artygirl.co.uk`.htaccess 文件所在的位置。

要使用以下任何选项，请将相应的指令或规则集复制粘贴到根目录中的一个**空**.htaccess 文件中。`http://artygirl.co.uk`

* * *

最快的是使用一个`mod_alias`指令的简单重定向：

```
Redirect 301 /  http://brightmist.co.uk/ 
```

传入 URL 中的任何路径都将自动附加到重定向的 URL。

* * *

`mod_alias`要使用另一个指令仅重定向某些路径：

```
RedirectMatch 301 ^/(.*)  http://brightmist.co.uk/$1 
```

尽管此示例重定向了所有内容，但`^/(.*)`可以修改正则表达式以仅匹配特定的 URL 路径模式。

* * *

`mod_rewrite`要使用指令仅重定向某些路径：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)   http://brightmist.co.uk/$1  [R=301,NC,QSA,L] 
```

与前一个选项一样，尽管此规则集重定向所有内容，但`^(.*)`可以修改正则表达式以仅匹配特定的 URL 路径模式。

* * *

**笔记**

*   `http://artygirl.co.uk/`必须存在相同的目录结构和文件才能`http://brightmist.co.uk/`使前面的任何选项起作用。

*   如果您问题中的实际 .htaccess 文件按预期工作，您可以在`http://brightmist.co.uk/`安装新 WP 的根目录中使用它。不过，可能需要一些修改。

*   要移动或复制 WP 安装，请查看此链接[更改站点 URL](http://codex.wordpress.org/Changing_The_Site_URL)。

* * *

### 更新：

从您评论中的这些句子到这个答案：“*我的域都指向同一个目录......* ”和“ *......现在它创建了一个循环......* ”，也许问题是关于指向相同内容的域（网站），通常称为`parked`域。

如果是这种情况，我不确定将 .htaccess 中的主域重定向到停放的域是正确的方法，只是更改浏览器地址栏中的域名。

然而，理论上这样的事情应该使用 mod_rewrite 指令来完成：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST}  artygirl\.co\.uk      [NC]
RewriteRule ^(.*)   http://brightmist.co.uk/$1  [R=301,NC,QSA,L] 
```

将任何请求永久重定向`http://artygirl.co.uk`到`http://brightmist.co.uk`，并在存在时附加完整的传入路径和查询。

由于 .htaccess 文件也是共享的，我认为这个规则集应该放在问题中 .htaccess 文件的顶部，替换以下行：

```
RewriteEngine On
RewriteBase / 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:16:21.517

我看到了问题。它重定向根很好，但如果我去：

[http://artygirl.co.uk/photography/](http://artygirl.co.uk/photography/)

我想你想让它去

[http://brightmist.co.uk/photography/](http://brightmist.co.uk/photography/)

并不是

[http://brightmist.co.uk/](http://brightmist.co.uk/)

就像现在一样。

众所周知，重写规则很难调试，但试试这个......

```
RewriteEngine On
RewriteBase  /
RewriteCond %{HTTP_HOST} !^brightmist\.co\.uk$ [NC]
RewriteRule ^(.*)$ http://brightmist.co.uk/$1 [R=301,L] 
```

我知道这与 Matthew Camp 的回答非常相似。RewriteCond 对于避免无限循环非常重要，因为您从同一个文件夹交付两个域。您只想重定向不正确的那个。

根据服务器的配置方式以及更高级别存在哪些其他重写规则（您不可见但可能仍会影响您），可能还需要 Rewrite Base。尝试使用和不使用 RewriteBase。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T22:14:40.027

他们是否重定向到同一个分机？应该是这样的：

```
RewriteEngine on 
RewriteRule ^(.*)$ http://newdomain.com/$1 [R=301,L] 
```

# asp.net-mvc - ASP .NET MVC html.textbox 不返回值

> ID：15167635
> 
> 赞同：0
> 
> 时间：2013-03-01T22:05:02.013
> 
> 标签：asp.net-mvc, html.textbox

控制器：

```
 [HttpPost]
    public ActionResult Edit(FormCollection form)
    {

        string name = form["firstname"];
    } 
```

看法：

```
@Html.TextBox("firstname", null, new { style = "width:100px" }) 
```

我在文本框中输入了一些文本并提交了表单，但是当我在字符串声明处中断程序时，名称变量为空，即使当我将鼠标悬停在表单 [“firstname”] 上时，我在文本框中输入的值也会出现在 Visual Studio 中。

如何获取文本框中输入的文本并将其放入字符串变量中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:35:58.247

这很可能发生在您身上，因为以后在代码中的任何地方都不会使用此变量。如果它看到以后没有使用该变量，它是否足够聪明，不关心为其分配值。

要查看它是否有效，只需在您的代码后面添加此代码：

```
string s = name; 
```

# ubuntu - 中止：HTTP 错误 500：在 hg push 上的 ['/tmp'、'/var/tmp'、'/usr/tmp'、'/'] 中找不到可用的临时目录

> ID：15167637
> 
> 赞同：4
> 
> 时间：2013-03-01T22:05:11.487
> 
> 标签：ubuntu, mercurial

当我尝试将本地存储库推送到服务器时，突然在我的 Ubuntu 服务器上收到此错误。谁能帮我解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T01:18:08.650

那是服务器端的 python 说“嘿！，这 4 个目录都不是我可以写临时文件的地方！”。检查以确保其中至少一个存在，可以由用户写入 mercurial*在服务器端*运行，并确保磁盘未满。

# php - 使用 ImageMagick 调整动画 .gif 的大小

> ID：15167638
> 
> 赞同：0
> 
> 时间：2013-03-01T22:05:13.017
> 
> 标签：php, imagemagick, thumbnails, animated-gif

我知道以前曾以几种不同的方式提出过这个问题，但我遇到了一个似乎很独特的问题。我正在使用以下代码来调整动画 .gif 图像的大小：

```
convert $image -coalesce $image

convert -layers OptimizeTransparency -quality 60 -size 220x220 $image -resize 220 +profile '*' $thumb` 
```

理论上，这应该生成 220px X 220px 的 .gif 缩略图/调整大小版本，并通过降低质量和优化透明度来保持其合理大小，但在生产中需要 255kb [.gif](http://i.imgur.com/PotaCqC.gif)并将其转换为 1.5mb 缩略图。这段代码有什么问题，如何创建更优化的 .gif 缩略图？

# node.js - Mongoose 和 mapReduce - 未调用映射函数

> ID：15167639
> 
> 赞同：1
> 
> 时间：2013-03-01T22:05:13.447
> 
> 标签：node.js, mongodb, mongoose

我正在尝试通过 Mongoose 使用 Mongodb 的 mapReduce 函数，但我传入的 map 函数从未被调用。以下是“Post”模型集合中当前包含的数据：

```
[ { data: 'Tag test data',
name: 'Tag Test',
_id: 5130dff2560105c235000002,
__v: 0,
comments: [],
tags: [ 'tag1', 'tag2', 'tag3' ] },

 { data: 'Testing tags.  Again.',
    name: 'Another test post',
    _id: 5131213b611fe1f443000002,
    __v: 0,
    comments: [],
    tags: [ 'tags', 'test', 'again' ] } ] 
```

这是代码：

```
var Schema = mongoose.Schema;
var PostSchema = new Schema ({
   name : String
   , data : String
   , tags : [String]
});
mongoose.model('Post', PostSchema);

var o = {};

o.map = function() {
    if (!this.tags) {
        //console.log('No tags found for Post ' + this.name);
        return;
    }
    for (index in this.tags) {
        emit(this.tags[index], 1);
    }
}

o.reduce = function(previous, current) {
    var count = 0;
    for (index in current) {
        count += current[index];
    }
    return count;
}

o.out = { replace : 'tags'}
o.verbose = true;

var Post = mongoose.model('Post');

Post.mapReduce(o, function(error, model, stats) {
    console.log('model: ' + model);
    console.log('stats: ' + stats);
}); 
```

"model" 和 "stats" 对象总是未定义的，并且 map 函数中的日志语句永远不会被调用。如果我在 mapReduce 函数之外使用 Post 模型执行类似操作，我会按预期在帖子顶部获取数据：

```
Post.find().exec(function(err, posts) {
    console.log(posts);
}); 
```

有什么建议么？我敢肯定有些事情只是稍微有点不对...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-03T14:10:50.447

您不能`console.log`从`map`and`reduce`函数中调用，因为 Mongo 的 JavaScript 引擎不支持它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-08T17:02:31.440

要调试你的 map/reduce/finalize 函数，你可以使用 MongoDB [print](http://docs.mongodb.org/manual/tutorial/getting-started-with-the-mongo-shell/#print)语句。输出将添加到您的 Mongo 日志文件中。

# javascript - 如何在不为每个按钮使用一个功能的情况下处理非常相似的按钮？

> ID：15167640
> 
> 赞同：2
> 
> 时间：2013-03-01T22:05:14.357
> 
> 标签：javascript, jquery, hyperlink, append

我有一堆锚链接，我使用 javascript 淡入不同的 div 以模仿页面。

```
<script type="text/javascript">

$(document).ready(function() {

    showHomePage();

    $('.homebutton').click(function() {
        displayNone();
        showWindow("homepage");
    } );
    $('.aboutbutton').click(function() {
        displayNone();
        showWindow("aboutpage");
    } );
    $('.gallerybutton').click(function() {
        displayNone();
        showWindow("gallerypage");
    } );
    $('.musicbutton').click(function() {
        displayNone();
        showWindow("musicpage");
    } );

    function displayNone() {
        $('.pagecontainer>div').fadeOut(0);
    }

    function showHomePage() {
        $('.pagecontainer').fadeIn();
        $('#homepage').fadeIn();
    }

    function showWindow(name) {
        $('#' + name).fadeIn();
    }

}); 
```

```
<body>
....
....
<a href="#homepage" class="homebutton">Home</a>
<a href="#aboutpage" class="aboutbutton">About</a>
<a href="#gallerypage" class="gallerybutton">Gallery</a>
<a href="#musicpage" class="musicbutton">Music</a>
....
....
<div id="homepage">Home page</div>
<div id="aboutpage">About page</div>
<div id="gallerypage">Gallery page</div>
<div id="musicpage">Music page</div>
....
</body> 
```

首先所有页面都设置为隐藏（alpha=0），当点击链接时，当前显示的任何页面都使用 displayNone() 设置为隐藏，并且相应的页面淡入。这一切都没有问题。

但我想缩短这段代码。正如你所看到的，如果我说 50 页，javascript 部分会变得非常混乱，因为我必须写几乎相同的行 50 次。我所有的链接都有**对应于“_page”的类“_button** ”，所以我认为应该有一个只需要一个功能的快捷方式？就像是：

*   点击【类名】时，删除类名的“按钮”部分
*   然后将“page”附加到名称的末尾
*   例如点击“aboutbutton”时，将名称改为“about”，然后添加“page”，变成“aboutpage”
*   然后显示那个div

但我不确定如何写这个。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T22:09:23.063

您可以在 HTML 中有多个类，因此您的按钮可能是这样的：

```
<a href="#homepage" class="button homebutton">Home</a>
<a href="#aboutpage" class="button aboutbutton">About</a>
<a href="#gallerypage" class="button gallerybutton">Gallery</a>
<a href="#musicpage" class="button musicbutton">Music</a> 
```

然后使用单个事件处理程序将它们全部定位。这应该让你开始：

```
$('.button').on('click', function(e){
    e.preventDefault();
    // Luckly, your urls match the id selectors
    // do not use this.href, as it will return the full, resolved url
    // (see Kolink's answer)
    $(this.getAttribute("href")).fadeIn();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T22:11:05.507

尝试这个：

```
$(function() {
  $("a[href^='#']").click(function() {
    $(".pagecontainer>div").fadeOut(0);
    $(this.getAttribute("href")).fadeIn();
  });
  $(".pagecontainer").fadeIn();
  $("#homepage").fadeIn();
}); 
```

# ruby-on-rails - 模型属性是活动记录关系的未定义方法

> ID：15167641
> 
> 赞同：0
> 
> 时间：2013-03-01T22:05:16.257
> 
> 标签：ruby-on-rails, rails-activerecord

我有一个 Rails 应用程序，用户在其中创建一个问题（问题模型接受答案模型的嵌套属性）和至少三个答案选择。Answer 模型的属性是 :content （用于问题）和 :correctanswer，一个布尔复选框，供用户检查答案选择是否正确。由于它是一个复选框，因此不幸的是，该表单允许用户选择多个答案为真。我这样做是因为我不知道如何让一个单选按钮与每个答案选项相关联。

为了强制用户仅将一个答案选项标记为正确，我尝试在 Question.rb 模型中创建自定义验证，但在这里你会看到我可怕的 ruby​​ 技能。在下面的代码中，self 是问题，answers 是嵌套模型，而 correctanswer 是嵌套模型的属性。我收到一条错误消息

```
undefined method `correctanswer' for []:ActiveRecord::Relation 
```

你能告诉我如何实现我想要做的事情吗？我不确定在“if”语句的末尾使用 `.size != 1`（即是否会计算正确答案的数量并拒绝它？）在“if”语句的末尾，但是，由于正确答案错误首先弹出，我还没有能够看看它是否有效。

```
validate :only_one_checked_box

  def only_one_checked_box
     if self.answers.correctanswer.reject(&:marked_for_destruction?).size != 1

      self.errors[:base] << "Must mark one and only answer as correct"
    end

  end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:33:10.463

我在这里有些猜测，因为我看不到您的 Answer 模型，但我怀疑您想要执行以下操作：

```
def only_one_checked_box
  if self.answers.select{|a| a.correctanswer == true}.size !=1
    self.errors[:base] << "Must mark one and only answer as correct"
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:29:50.040

`self.answers`是一个答案数组，因此您应该迭代并检查答案是否被标记为正确。一个简单的方法是：

```
def only_one_checked_box
  correct = 0
  self.answers.each { |a| correct += 1 if a.correctanswer }

  if correct != 1
    self.errors[:base] << "Must mark one and only answer as correct"
  end
end 
```

# c# - C# SQL 多个 IN 选择器

> ID：15167642
> 
> 赞同：0
> 
> 时间：2013-03-01T22:05:20.597
> 
> 标签：c#, sql, arrays, parameters

我的输出查询如下所示：

```
select * from Calls where CallerID = "User.Name" and Endpoint in ("C,D,V") order by JoinTime desc; 
```

我的带有参数的 C# 查询字符串如下所示：

```
string SQLQuery = "select * from Calls where CallerID = @UserName and EndpointType in ({0}) order by JoinTime desc"; 
```

添加参数的代码如下所示：

```
...

string[] Endpoints = new string[] {"C","D","V"}; //EXAMPLE string array
string UserNameStr = "User.Name"; //EXAMPLE string UserNameStr value

...

string[] paramNames = Endpoints.Select((s, i) => "@endpoint" + i.ToString()).ToArray();

string inClause = string.Join(",", paramNames);

using (cmd = new MySqlCommand((string.Format(SQL, inClause)),connection))
{
    for (int i = 0; i < paramNames.Length; i++)
    {
        cmd.Parameters.AddWithValue(paramNames[i], Endpoints[i]);
    }
}

cmd.Parameters.Add("@UserName", MySqlDbType.String).Value = UserNameStr;

MySqlDataReader dataReader = cmd.ExecuteReader(); 

... 
```

但是，如果我想添加另一个 IN 运算符，那么输出查询将如下所示；

```
select * from Calls where CallerID = "User.Name" and Endpoint in ("C","D","V") and ConferenceCall in ("D","C") order by JoinTime desc; 
```

我怎么做？Linq 中是否有一些可以使用的功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:15:20.537

与第一次相同的方式：

```
// endpoints = comma-delimited list of endpoints
// conferenceCalls = comma-delimited list of conference calls

string SQLQuery = "select * from Calls " + 
                  "where CallerID = @UserName and " + 
                  "EndpointType in ({0}) and " + 
                  "ConferenceCall in ({1}) " + 
                  "order by JoinTime desc";

cmd = new MySqlCommand((string.Format(SQL, endpoints, conferenceCalls)),connection); 
```

如评论中所述，请非常小心地验证字符串以避免 SQL 注入攻击。没有直接的方法将集合作为 SQL 参数传递。有很多方法可以做到这一点（传递分隔字符串并解析它是我见过的最常见的方法），但如果您可以控制设置值并验证数据，那么您应该没问题。

# ios - 使用 NSSet 中属于实体的对象对 NSFetchedResultsController 进行排序

> ID：15167649
> 
> 赞同：5
> 
> 时间：2013-03-01T22:05:49.797
> 
> 标签：ios, objective-c, nsfetchedresultscontroller, nssortdescriptor, nsset

我有一个名为的对象`Delivery`，它有一组`Customer`与之关联的对象。每个 Delivery 对象还存储 a `mainCustomerId`which is an `NSNumber*`。我有一个 NSFetchedResultsController 用于管理`UITableView`. `customers`问题是我想按客户的 lastName 字段对 NSFetchedResultsController 进行排序（客户再次存储在对象上调用的多对多关系中`Delivery`），其中一组客户的 customerId 等于 Delivery 的 MainCustomerId .

交付类看起来像这样（仅相关部分）

```
@interface Delivery : NSManagedObject
@property (nonatomic, retain) NSNumber * mainCustomerId;
@property (nonatomic, retain) NSSet *customers;
@end 
```

客户类看起来像这样

```
@interface Customer : NSManagedObject
@property (nonatomic, retain) NSNumber * customerId;
@property (nonatomic, retain) NSString * lastName;
// And the inverse relationship to the deliveries
@property (nonatomic, retain) NSSet *deliveries;
@end 
```

我需要制作一个 NSSortDescriptor 来做这样的事情（注意，我知道这是错误的格式并且不会起作用。我希望它可以传达这个想法）

```
NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"customers.AnyobjectInSet.lastName WHERE AnyobjectInSet.customerId == masterCustomerId ascending:YES]; 
```

我使用子查询和 NSExpressions 尝试了几件事，但总是失败，因为我不能使用任何使用 Cocoa 的功能（比如使用 @selector 排序），因为它必须能够生成一个真正的 mysql 查询，而不需要 Cocoa 处理数据。但我觉得必须有某种方法可以做到这一点，因为这将是 mysql 中的一个简单查询。

```
select * from Delivery JOIN Customer ON Customer.customerId=Delivery.mainCustomerId ORDER BY Customer.lastName; 
```

我试图避免在获取结果后进行排序并将排序顺序存储回对象上（这很容易，但我觉得这是错误的解决方案，因为我选择了相关数据。必须有一种方法排序）。任何帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:03:15.277

好的，所以也许我遗漏了一些东西，但谓词建议对我来说非常有意义。如果我错了，请纠正我，但是（假设你知道 mainCustomerID）：

```
NSNumber *mainCustomerID = ...

NSPredicate *predicate = [NSPredicate predicateWithFormat:@"customerID == %@", mainCustomerID];
NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"lastName" ascending:YES];

NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Customer"];
[request setPredicate:predicate];
[request setSortDescriptors:@[ sortDescriptor ]];

NSFetchedResultsController *controller = [[NSFetchedResultsController alloc] initWithFetchRequest:request ... 
```

所以基本上如果不清楚，这将获取 customerID 等于 mainCustomerID 的所有客户记录，然后按姓氏对这些结果进行排序。这将在内部生成 SQL 语句来为您执行此操作。

这不是你想要做的吗？

此外，如果您想查看 CoreData 在运行时生成的 SQL（有用的调试工具），请打开您的方案并转到“参数”选项卡并将以下内容添加到“启动时传递的参数”中：

```
-com.apple.CoreData.SQLDebug 1 
```

快乐编码:)

# php - 使用 facebook graph api 分组添加请求？

> ID：15167651
> 
> 赞同：0
> 
> 时间：2013-03-01T22:06:06.697
> 
> 标签：php, facebook, facebook-graph-api

facebook 图形 API 是否有任何内置的“组添加请求”操作？喜欢内置的[Like 动作](https://developers.facebook.com/docs/technical-guides/opengraph/built-in-actions/likes/)？这发生在用户请求中。我想从外部网站执行此操作，就像 Like 操作一样

例如，用户在论坛中处于活动状态，其中不同类别有自己的 facebook 群组页面，并且他们希望无需实际登录 facebook 并提出请求即可访问该群组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:13:45.100

从[文档](https://developers.facebook.com/docs/reference/api/group/)：

> 邀请用户
> 
> 应用程序可以通过使用应用程序访问令牌向 /GROUP_ID/members/USER_ID 发出 POST 请求来邀请用户加入组。
> 
> 请注意，被邀请的用户必须是应用程序的用户。用户将收到一条通知，说明他们已被邀请加入该组。通知会将他们带到群组页面。用户只能被邀请一次。后续邀请将失败。

所以你的用户必须授权你的应用程序，然后你才能做到。

# php - 将html（填充mysql）表导出到excel文件

> ID：15167657
> 
> 赞同：3
> 
> 时间：2013-03-01T22:06:27.800
> 
> 标签：php, html, mysql, export-to-excel

我正在尝试查询 mysql 数据库并在表中显示数据。那部分正在工作。目前，它被设置为在特定日期范围内显示结果。

我现在想拿表格并制作一个按钮，允许您将其导出到 Excel 文件。在我添加选择日期范围的选项之前，您可以导出到 Excel，但现在似乎第二个文件不知道我在说什么表。我尝试使用 POST 发送数据值并在另一页上重新查询。

当我单击按钮导出时，下载的 excel 文档是空的（尽管它有大小）。请问有什么帮助吗？

-----查询mysql---------

```
 <html><head><title>New Production Rejections</title></head></html>
    <?php 

    include("config.php");
    //get serial from submitted data
        //$serial = $_POST['sNumber'];
        //if the submitted data is empty
        $serial = $_POST['entryDate'];
    $dateEnd = $_POST['entryDate2'];
        //parse the serial from the link in tracker
    ?>
        <form method="post" action="<?php echo "queryNewProdRejections.php?"?>">
        Search between dates: (Format: YYYY-MM-DD)<input type='text' size='20' maxlength='20' name='entryDate'> - <input type='text' size='20' maxlength='20' name='entryDate2'>
        <input type="submit" value="Search Date Range"><br/></form>

    <?php

    //query based on approved date that is nothing, repaired date that is nothing, 
    //tech is a real tech, location that is not Revite (RVP), action was to replace, 
    //and the status is not (declined or skipped).

    $query = "SELECT *
    FROM `rma`
    WHERE `origin` NOT LIKE 'Field_failure'
    AND `origin` NOT LIKE 'DOA_at_Customer'
    AND `origin` NOT LIKE 'Sweden_Fail_VI'
    AND `entry` > '$serial' AND `entry` < '$dateEnd'";
    $data = mysql_query($query) or die(mysql_error());

    //Create a table with the array of data from repairs, based on the previous query

    echo "<table border='1'><tr><th>RMA</th><th>Product</th><th>Serial</th><th>Origin</th><th>Return To</th><th>Credit Num</th><th>Order</th><th>Entry Date</th><th>Tech</th><th>Traking Num</th></tr>";

    while($row = mysql_fetch_array($data)){ 
        print "<tr><td>".$row['intrma']."</td><td>".$row['product']."</td><td>".$row['serial']."</td><td>".$row['origin']."</td><td>".$row['retto']."</td><td>".$row['creditnum']."</td><td>".$row['ordernum']."</td><td>".$row['entry']."</td><td>".$row['tech']."</td><td>".$row['tracknum']."</td></tr>";
    }
    print "</table>";

    ?>
    <html>
    <form method="post" action="saveQueryToExcel.php">
    <input type='hidden' name='ent_1' value="<?php echo $_POST['entryDate']; ?>">
    <input type='hidden' name='ent_2' value="<?php echo $_POST['entryDate2']; ?>">
      <input type="submit" value="Save to Excel">
    </form>
    </html> 
```

---------------打印到 Excel 文件 -- (saveQueryToExcel.php)

```
<html><head><title>New Production Rejections</title></head></html>

<?php
error_reporting(0);

$dateBeg=$_POST['ent_1'];
$dateEnd=$_POST['ent_2'];

//Connect to the database, repairs in maprdweb
include("config.php");

//query based on approved date that is nothing, repaired date that is nothing, 
//tech is a real tech, location that is not Revite (RVP), action was to replace, 
//and the status is not (declined or skipped).

$query = "SELECT *
FROM `rma`
WHERE `origin` NOT LIKE 'Field_failure'
AND `origin` NOT LIKE 'DOA_at_Customer'
AND `origin` NOT LIKE 'Sweden_Fail_VI'
AND `entry` > '$dateBeg' AND `entry` < '$dateEnd'";
$data = mysql_query($query) or die(mysql_error());

//Create a table with the array of data from repairs, based on the previous query
header('Content-type: application/vnd.ms-excel');

echo "<table border='1'><tr><th>RMA</th><th>Product</th><th>Serial</th><th>Origin</th><th>Return To</th><th>Credit Num</th><th>Order</th><th>Entry Date</th><th>Tech</th><th>Traking Num</th></tr>";

while($row = mysql_fetch_array($data)){ 
    print "<tr><td>".$row['intrma']."</td><td>".$row['product']."</td><td>".$row['serial']."</td><td>".$row['origin']."</td><td>".$row['retto']."</td><td>".$row['creditnum']."</td><td>".$row['ordernum']."</td><td>".$row['entry']."</td><td>".$row['tech']."</td><td>".$row['tracknum']."</td></tr>";
}
print "</table>";
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:14:41.107

[PHPexcel](http://phpexcel.codeplex.com/)非常适合将数据导出到实际的 Excel 文档。

看来您只是在生成一个带有结果的 HTML 表格。这不完全是 Excel 格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:12:09.717

您应该使用相同的代码，而不是`<tr>`用它打印行，而是将其发送到[fputcsv](http://php.net/manual/en/function.fputcsv.php)。使用标准输出作为文件句柄。您需要设置正确的 html 标头，以便将输出作为 csv 发送，如本文所述：[强制文件下载](https://stackoverflow.com/a/6493794/1004027)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-29T19:16:31.917

看看这门课。它能够解决问题。

[https://github.com/GSTVAC/HtmlExcel](https://github.com/GSTVAC/HtmlExcel)

```
$xls = new HtmlExcel();
$xls->addSheet("Names", $names);
$xls->headers();
echo $xls->buildFile(); 
```

# sql - 如何关联 2 个历史表之间的记录？

> ID：15167658
> 
> 赞同：2
> 
> 时间：2013-03-01T22:06:31.690
> 
> 标签：sql, sql-server-2008, tsql

我有 5 个表（为问题设计和简化）：

```
Device
---------------
DeviceID - INT IDENTITY - PRIMARY KEY
DeviceGUID - UNIQUEIDENTIFIER - UNIQUE CLUSTERED (used for lookups)
OtherInfo

Device_State
---------------
DeviceStateID - INT IDENTITY - PRIMARY KEY
DeviceID - INT - FOREIGN KEY - UNIQUE CLUSTERED (used for lookups)
Pump1 - TINYINT
Pump2 - TINYINT
Pump3 - TINYINT
Pump4 - TINYINT
Pump5 - TINYINT
Heater1 - TINYINT
Heater2 - TINYINT
Lights - BIT
TimeStamp - SMALLDATETIME

Device_State_History
---------------
DeviceStateHistoryID - INT IDENTITY - PRIMARY KEY
DeviceStateID - INT - FOREIGN KEY - NONCLUSTERED INDEX (used for lookups)
Pump1 - TINYINT
Pump2 - TINYINT
Pump3 - TINYINT
Pump4 - TINYINT
Pump5 - TINYINT
Heater1 - TINYINT
Heater2 - TINYINT
Lights - BIT
TimeStamp - SMALLDATETIME

Peripheral_State
----------------
PeripheralStateID - INT IDENTITY - PRIMARY KEY
DeviceID - INT - FOREIGN KEY - UNIQUE CLUSTERED (used for lookups)
Pump1 - TINYINT
Pump2 - TINYINT
PH - SMALLINT
ORP - SMALLINT
ELECTRODEID - TINYINT
ELECTRODEPOLARITY - TINYINT
TimeStamp - SMALLDATETIME

Peripheral_State_History
----------------
PeripheralStateHistoryID - INT IDENTITY - PRIMARY KEY
PeripheralStateID - INT - FOREIGN KEY - NONCLUSTERED INDEX (used for lookups)
Pump1 - TINYINT
Pump2 - TINYINT
PH - SMALLINT
ORP - SMALLINT
ELECTRODEID - TINYINT
ELECTRODEPOLARITY - TINYINT
TimeStamp - SMALLDATETIME 
```

情况如下：

Device_State_History 表中有约 380 万条记录，Peripheral_State_History 表中有约 10 万条记录。

我想编写一个查询，在给定日期时间之间选择给定 DeviceGUID 的所有 Peripheral_State_history 和 Device_State_History。我想获得这样的记录：

```
Select 
 Peripheral_State_History.PH,
 Peripheral_State_History.ORP,
 ( 
 if(Device_State_History.Pump1 == 1 ||
    Device_State_History.Pump2 == 1 ||
    Device_State_History.Pump3 == 1 ||
    Device_State_History.Pump4 == 1 || 
    Device_State_History.Pump5 == 1
    ) 
    { 1 }
    else 
    { 0 }
  ) AS PumpsOn, 
    TimeStamp 
FROM CombinedData 
```

此外，Device_State_History 和 Peripheral_State_History 之间的时间戳并不总是相同的。我的意思是，Device_State_History 表中 1 个设备的记录时间戳可能是这样的：

```
Mar-1-2013 12:31
Mar-1-2013 12:33
Mar-1-2013 12:36
Mar-1-2013 12:38
Mar-1-2013 12:41 
```

然后Peripheral_State_History表中就会有记录：

```
Mar-1-2013 12:29
Mar-1-2013 12:33
Mar-1-2013 12:34
Mar-1-2013 12:38
Mar-1-2013 12:39
Mar-1-2013 12:41 
```

如您所见，时间戳并不总是重叠。

我一直在阅读并尝试编写存储过程来执行此操作，但是，这超出了我的 SQL 能力，非常感谢指导和示例。谢谢。

编辑：

以下是我编写的用于从 Peripheral_State_History 表中获取数据的存储过程。它不包括我想要的 Device_State_History 表中的 Pump 数据。

需要注意的几件事：每个时间戳我只获得 1 条记录，因为有一些带有多条记录的时间戳。此存储过程从 State 表中获取当前记录，以及从历史表中获取所有记录。

```
USE my_db
GO
IF EXISTS (SELECT * FROM sys.objects WHERE type = 'P' AND name = 'SP_Select_Stuff') 
DROP PROCEDURE 'SP_Select_Stuff') 
GO
CREATE PROCEDURE 'SP_Select_Stuff') 
( 
     @DeviceGUID uniqueidentifier
) 
AS
DECLARE @RetCode INT
;WITH combined AS
(
    SELECT 
    ROW_NUMBER() OVER 
   (PARTITION BY [TimeStamp] ORDER BY [TimeStamp]) as num, ORP, PH, [TimeStamp] 
    FROM Peripheral_State
    INNER JOIN Device
        ON Peripheral_State.DeviceID = Device.DeviceID
        WHERE Device.DeviceGUID = @DeviceGUID 
    UNION ALL
    SELECT
    ROW_NUMBER() OVER 
   (PARTITION BY [TimeStamp] ORDER BY [TimeStamp]) as num, ORP, PH, [TimeStamp]
    FROM Peripheral_State_History
    INNER JOIN Device
        ON Peripheral_State.DeviceID = Device.DeviceID
        WHERE Device.DeviceGUID = @DeviceGUID 

)
SELECT ORP, PH, [TimeStamp]
FROM combined
WHERE ORP > 0
AND PH > 0
AND combined.num = 1
ORDER BY [TimeStamp] ASC

IF @@ERROR <> 0
   BEGIN
        SET @RetCode = 5
        RETURN @RetCode
   END
ELSE
    BEGIN
        SET @RetCode = 0
        RETURN @RetCode
    END
GO 
```

编辑：

这是我想出的。

```
USE my_db
--"combined" gets all of the data. 
--A row from the peripheral history will look like: ORP-Value, PH-Value, Current-Value, NULL, TimeStamp.
--A row from the device history will look like: NULL, NULL, NULL, PumpsOn-Value, TimeStamp
-- I also get a num for filtering 1 TimeStamp per minute. My TimeStamps are accurate to the minute, so if one minute has 30 records, I will use the first record.
;WITH combined AS
(   
    SELECT  
    ROW_NUMBER() OVER 
   (PARTITION BY ph.[TimeStamp] ORDER BY ph.[TimeStamp]) as num, ph.ORP, ph.PH, ph.[Current], NULL as PumpsOn, ph.[TimeStamp] 
    FROM Device as d

    LEFT JOIN Peripheral_State as ps
    ON ps.DeviceID = d.DeviceID

        LEFT JOIN Peripheral_State_History as ph
        ON ph.DeviceID = d.DeviceID

        WHERE d.DeviceGUID = @DeviceGUID
        AND ph.TimeStamp BETWEEN '2013-03-02 00:00:00' AND GETDATE() 

    UNION ALL   

    SELECT
    ROW_NUMBER() OVER 
   (PARTITION BY dh.[TimeStamp] ORDER BY dh.[TimeStamp]) as num, NULL as ORP, NULL as PH, NULL as [Current], IsNull(COALESCE(dh.Pump1, dh.Pump2, dh.Pump3, dh.Pump4, dh.Pump5),0) as PumpsOn, dh.[TimeStamp]
    FROM Device as d

    LEFT JOIN Device_State as ds
    ON ds.DeviceID = d.DeviceID

       LEFT JOIN Device_State_History as dh
       ON dh.DeviceID = d.DeviceID

        WHERE d.DeviceGUID = @DeviceGUID
        AND ph.TimeStamp BETWEEN '2013-03-02 00:00:00' AND GETDATE()            
),
--"FilteredAndAddID" gets a record set that has an ID added to the row. This is required for the 3rd step.
--It also filters the data so that records with 0 orp/ph are omitted.
FilteredAndAddID AS
(
    SELECT 
        ROW_NUMBER() OVER (ORDER BY [TimeStamp]) as ID,
        ORP,
        PH,
        [Current],
        PumpsOn,
        [TimeStamp]
    FROM combined
    WHERE 
    (ORP is NULL OR ORP > 0) AND (PH is NULL OR PH > 0)
    AND combined.num = 1
),
--"filled" is used to fill the "FilteredAddID" record set NULLS with the previous row that has a value instead of NULL.
filled AS
(
    SELECT  Curr.ID,
            ISNULL(Curr.ORP, (SELECT TOP 1 ORP FROM FilteredAddID WHERE ID < Curr.ID AND ORP IS NOT NULL ORDER BY ID)) ORP,
            ISNULL(Curr.PH, (SELECT TOP 1 PH FROM FilteredAddID WHERE ID < Curr.ID AND PH IS NOT NULL ORDER BY ID)) PH,
            ISNULL(Curr.[Current], (SELECT TOP 1 [Current] FROM FilteredAddID WHERE ID < Curr.ID AND [Current] IS NOT NULL ORDER BY ID)) [Current],
            ISNULL(Curr.PumpsOn, (SELECT TOP 1 PumpsOn FROM FilteredAddID WHERE ID < Curr.ID AND PumpsOn IS NOT NULL ORDER BY ID)) PumpsOn, 
            Curr.[TimeStamp]
    FROM    FilteredAddID Curr
)
SELECT ID, ORP, PH, [Current], PumpsOn, [TimeStamp]
FROM filled
ORDER BY [TimeStamp] ASC 
```

前 2 个查询“组合”和“FilterAndAddID”在毫秒内执行，但是“填充”查询大约需要 6 分钟来填充约 1700 条记录中的空值。

有没有办法加快这个速度？

我以正确的方式接近这个吗？

理想情况下，我需要它在几秒钟内运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T20:51:19.813

此查询运行多长时间？

```
;with combined as
(
select
   psh.PH, psh.ORP, psh.TimeStamp, 
   max(dsh.TimeStamp) as Device_Stamp
from Peripheral_State_History psh
  join Peripheral_State ps on ps.PeripheralStateID = psh.PeripheralStateID 
  join Device d on d.DeviceID = ps.DeviceID
  left join Device_State ds on ds.DeviceID = d.DeviceID
  left join Device_State_History dsh on dsh.DeviceStateID = ds.DeviceStateID 
    and dsh.TimeStamp <= psh.TimeStamp
where d.DeviceGUID = @DeviceGUID
  and psh.TimeStamp between @date1 and @date2
group by psh.PH, psh.ORP, psh.TimeStamp
)
select 
  c.PH, c.ORP, c.TimeStamp, 
  case 
    when dsh.Pump1 = 1 and dsh.Pump2 = 1 and dsh.Pump3 = 1 
      and dsh.Pump4 = 1 and dsh.Pump5 = 1
    then 1 else 0 end as PumpsOn
from combined c
  left join Device_State_History dsh on dsh.TimeStamp = c.Device_Stamp
  left join Device_State ds on ds.DeviceStateID = dsh.DeviceStateID
  left join Device d on ds.DeviceID = d.DeviceID
where d.DeviceGUID = @DeviceGUID 
```

**编辑**

解决 Device_State_History 中具有相同时间戳的多条记录的问题。

如果您有更大的 DeviceStateHistoryID 总是大于或等于时间戳，那么您可以尝试此查询。它选择一条具有最大 DeviceStateHistoryID 的记录，其中记录在 Device_State_History 中具有相同的时间戳

```
;with combined as
(
select
   psh.PH, psh.ORP, psh.TimeStamp, 
   max(dsh.DeviceStateHistoryID) as DeviceStateHistoryID
from Peripheral_State_History psh
  join Peripheral_State ps on ps.PeripheralStateID = psh.PeripheralStateID 
  join Device d on d.DeviceID = ps.DeviceID
  left join Device_State ds on ds.DeviceID = d.DeviceID
  left join Device_State_History dsh on dsh.DeviceStateID = ds.DeviceStateID 
    and dsh.TimeStamp <= psh.TimeStamp
where d.DeviceGUID = @DeviceGUID
  and psh.TimeStamp between @date1 and @date2
group by psh.PH, psh.ORP, psh.TimeStamp
)
select 
  c.PH, c.ORP, c.TimeStamp, 
  case 
    when dsh.Pump1 = 1 and dsh.Pump2 = 1 and dsh.Pump3 = 1 
      and dsh.Pump4 = 1 and dsh.Pump5 = 1
    then 1 else 0 end as PumpsOn
from combined c
  left join Device_State_History dsh on dsh.DeviceStateHistoryID = c.DeviceStateHistoryID
  left join Device_State ds on ds.DeviceStateID = dsh.DeviceStateID
  left join Device d on ds.DeviceID = d.DeviceID
where d.DeviceGUID = @DeviceGUID 
```

# java - 编码器/解码器 PCM 到 AMR Android

> ID：15167663
> 
> 赞同：1
> 
> 时间：2013-03-01T22:06:50.547
> 
> 标签：java, android, ffmpeg, pcm, amr

我一直在寻找任何允许我对通过 TCP 套接字连接发送的 PCM-AMR 音频流进行**编码和解码的 java 库。**无需使用 Android 的 JNI。

有什么可以帮助我的吗？

在最坏的情况下。我如何使用任何带有 JNI 的 C++ 库来做到这一点？（任何关于如何将 ffmpeg 与 JNI 一起使用的参考将不胜感激）

希望您能够帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T15:12:01.073

请注意，pcm 通常表示生成信号的麦克风（硬件）下游的 RAW 和音符编码。amr-nb、amr-wb 被编码。所以，我建议你准确地解决你在套接字上拥有什么类型的字节流..

然后，IMO，在 android 上，ffmpeg 库提供了强大的、广泛的 TO/FROM 编解码器选择和转换方式。

查看任何主要的 github [android-ffmpeg] 项目，其中几个如下：

[监护人](https://github.com/guardianproject/android-ffmpeg)

[半忍者](https://github.com/halfninja/android-ffmpeg-x264)

整理所有 JNI/Android 的东西有点学习曲线。IMO 如果您正在做这样的低级媒体工作，那么您几乎没有其他选择来掌握 JNI。

# browser - PHPStorm 使用实时编辑在 Chrome 中打开 index.php？

> ID：15167668
> 
> 赞同：2
> 
> 时间：2013-03-01T22:06:59.473
> 
> 标签：browser, live, edit, phpstorm

刚得到 PHPStorm，我想知道是否可以使用实时编辑在 chrome 中运行 index.php？我设法让它与 index.html 一起工作，但 php 调试只是打开了控制台。有教程吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T22:09:27.160

你不能实时编辑 PHP 的原因是它是一个服务器端脚本，而不是像 JavaScript 这样的客户端脚本。因此，您不会在 Chrome 中看到实时更新；您将需要刷新以获取更新。

不过，PHPStorm 确实支持调试 PHP，只是方式不同： [JetBrains PHP 调试文档](http://www.jetbrains.com/phpstorm/webhelp/php-debugging-session.html)

# javascript - KineticJS 可拖动图像在拖动后卡住

> ID：15167673
> 
> 赞同：1
> 
> 时间：2013-03-01T22:07:18.937
> 
> 标签：javascript, html, canvas, html5-canvas, kineticjs

我正在使用 KineticJS，到目前为止，这是一次很棒的体验。我的一个问题是关于拖动。我将此示例中的图像设置为“可拖动：true”，但在我第一次拖动它后，它无法再次移动。

```
var stage = new Kinetic.Stage({
    container: 'container',
    width: 2754,
    height: 1836
});
var layer = new Kinetic.Layer();
var scale = '0.16339869281045751633986928104575';
var imageObj = new Image();
imageObj.onload = function () {
    var img = new Kinetic.Image({
        x: 0,
        y: 0,
        height:612,
        width:612,
        image: imageObj,
        draggable: true,
        dragBoundFunc: function (pos) {
            console.log(img.getAttrs());
            return { 
                x: Math.floor((pos.x/scale)/306)*306,
                y: Math.floor((pos.y/scale)/306)*306 
                };
        }
    });

    // add the shape to the layer
    layer.add(img);

    // add the layer to the stage
    stage.add(layer);

};
imageObj.src = 'http://www.html5canvastutorials.com/demos/assets/yoda.jpg'; 
```

[http://jsfiddle.net/7UEC6/](http://jsfiddle.net/7UEC6/)

任何帮助表示赞赏。对于额外的功劳，您可以建议使拖动更平滑的方法。

谢谢！

**编辑：**我注意到在初始时间拖动图像后，当用户尝试拖动图像时不再调用dragBoundFunc

如果我将图像拖回 0,0 但没有其他时间，它也可以工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T00:20:02.070

这对于当前的 KineticJS 是不可能的。

让我试着解释一下原因。

当您使用作为 CSS3 元素（还不是标准）的 transform:scale 时，实际元素的视觉位置也会被缩放。但是 MouseEvent 的相对鼠标位置仅传递视觉位置（而不是缩放位置）。

KineticJS 使用的用于拖动的鼠标单击事件仅读取 MouseEvent 位置，这是可视的（不是缩放的），它不考虑画布元素的转换。

当您将图像 x/y 设置为跟随时，您甚至无法进行第一次拖动

```
 x: 612,
    y: 612, 
```

但是，当您将其设置为 0 和 0 时，它会响应它，因为缩放和未缩放的位置是相同的。

对于上面的例子 x/y 612 和 612，你不能点击拖动，因为 KineticJS 理解它，因为你没有点击 612 和 612，但它认为它是 100 和 100

正如我解释的那样，原因很简单。

MouseEvent 不传递缩放的 X/Y，而是 X/Y 的视觉位置。

谁知道 CSS3 什么时候成为标准，它可能会得到很好的支持 :)

同时，我不建议对画布使用转换。除非您构建自己的框架，否则很难通过转换画布来正确地做出所有事情。

# python - Python：在后台运行脚本并进行输入/输出

> ID：15167676
> 
> 赞同：0
> 
> 时间：2013-03-01T22:08:09.877
> 
> 标签：python, scripting, memcached

我需要制作将在后台运行的脚本，脚本将始终打开与 memcached 服务器的连接并等待从其他程序获取参数，当接收参数脚本将做一些工作并将一些信息输出回第一个程序时。我最大的问题是如何使该脚本在后台运行并等待参数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:30:06.933

在不确切知道您如何从其他程序获取参数或您如何等待的情况下，很难给出具体答案。

但是，为了说明起见，我们假设它正在侦听到端口 6789 的 TCP 连接，而另一个程序只是连接到该套接字并发送固定数量的参数，由换行符分隔。

最简单的方法是阻止：

```
memcache_connection = # however you set this up
sock = socket.socket()
sock.bind(('', 6789))
sock.listen(5)
while True:
    conn, addr = sock.accept()
    with contextlib.closing(conn) as client:
        with client.makefile() as f:
            param1, param2, param3 = f
        result = do_memcache_stuff(memcache_connection, param1, param2, param3)
        client.sendall(result) 
```

显然这里没有错误处理，除了 ^C 之外没有其他方法可以退出，但是这些东西很容易添加。

更严重的是，它一次只能处理一个命令。如果这是一个问题，您通常有两种选择：线程或事件循环。如果您不需要在两个客户端连接之间共享信息并且一次不需要处理超过几十个，那么线程通常会更简单。您所要做的就是将处理程序包装在一个函数中，然后生成它。所以：

```
def handle_client(conn):
    with contextlib.closing(conn) as client:
        with client.makefile() as f:
            param1, param2, param3 = f
        result = do_memcache_stuff(memcache_connection, param1, param2, param3)
        client.sendall(result)

memcache_connection = # however you set this up
sock = socket.socket()
sock.bind(('', 6789))
sock.listen(5)
while True:
    conn, addr = sock.accept()
    t = threading.Thread(target=handle_client, args=(conn,))
    t.daemon = True
    t.start() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T11:48:05.650

你想做所谓的多线程，在 python 文档中阅读它或自己尝试一下：

```
import threading 
```

# ruby-on-rails - simple_form_for：从参数中删除根模型名称

> ID：15167679
> 
> 赞同：5
> 
> 时间：2013-03-01T22:08:23.007
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, simple-form

当我使用 simple_form_for @model 创建表单时，提交后参数具有分组在 params [model] 下的所有属性。如何让 simple_form 删除此分组并直接发送（在 params root 下）？

```
<%= simple_form_for @user, do |f| %>
<%= f.input :name %>
<%= f.input :password %>
<%= f.submit %> 
```

现在名称和密码属性通常会在 params[:user][:name]、params[:user][:password] 等下发送。如何让 simple_form 将这些作为 params[:name]、params[:密码]等？

谢谢！
拉姆库马尔

ps：如果你想知道为什么我需要这个，我的应用程序的大部分是作为一个 API 服务的，我已经构建了一组方法来验证一个请求，这些请求期望某些属性位于根目录中。在极少数情况下（忘记密码），我实际上需要提供一个表格，并且我正在寻找一种使用这些方法的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-12T14:04:48.180

you can explicitly define the name for an input by passing input_html to it:

```
 input_html: { name: :name } 
```

(needed this myself for sending an resource to a thirdparty endpoint with redirect to my side which relied on the plain attribute names, but i actually wanted not to built up label and input via the tags ;) )

also see [simple form builder impl](https://github.com/plataformatec/simple_form/blob/master/lib/simple_form/form_builder.rb#L84)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:19:22.020

我能想到的两种方法：

第一个是，不要使用`simple_form`来构建您的表单，而是手动或使用`form_tag`and`*_tag`方法来构建。这些将允许您更详细地指定表单中使用的参数。

但是，如果您想保留`simple_form`，请让它调用不同的控制器操作。重构控制器以将逻辑剥离到单独的方法中。就像是：

```
class UsersController
  def create_from_api
    controller_logic(params)
  end
  def create_from_form
    controller_logic(params[:user])
  end
  def controller_logic(params)
    [actual work happens here]
  end
end 
```

# python - 按班级成员的属性排序

> ID：15167684
> 
> 赞同：1
> 
> 时间：2013-03-01T22:08:35.350
> 
> 标签：python, genetic-algorithm

我正在研究遗传算法问题。假设我有一个`Population()`包含`Individual()`. 每个人都有一个与之相关的分数。根据他们在总体中的分数对这些人进行排序/排名的好方法是什么？举个例子：

```
class Individual(object):
    rr = 100
    def __init__(self):
        self.score = random.randrange(self.rr)

class Population(object):
    def __init__(self, size):
        self.size = size
        self.population = [Individual() for _ in xrange(self.size)]

pop = Population(5)
for i in xrange(pop.size):
    print pop.population[i].score 
```

有没有一种 Pythonic 方法可以按分数对这些人进行排序？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:11:53.640

当然，使用方法的`key`参数`.sort()`：

```
from operator import attrgetter
pop.population.sort(key=attrgetter('score')) 
```

使用[`operator.attrgetter()`](http://docs.python.org/2/library/operator.html#operator.attrgetter)使这更容易一些，但不是必需的。

有关更多提示和技巧，请参阅 Python wiki 上的[Sorting Howto 。](http://wiki.python.org/moin/HowTo/Sorting/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:13:29.267

```
sorted_pop = sorted(pop.population, lambda x, y: cmp(x.score, y.score)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T21:35:06.517

不导入任何库：

```
pop.population.sort(key=lambda x: x.score) 
```

# powershell - 按 X 退出或任何其他键继续？

> ID：15167686
> 
> 赞同：4
> 
> 时间：2013-03-01T22:08:46.180
> 
> 标签：powershell

Grrr ...这里是菜鸟问题。我想创建一个基本上可以做到这一点的块：

```
Write-Host "Press X to cancel or any other key to continue"
$continue = Read-Host
  If ($continue = "X") 
     {exit}
  else 
     {Write-Host "Hello world"} 
```

即使我按另一个键也会继续退出......我做错了什么？谢谢！！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T22:13:13.100

您应该使用“-eq”进行比较。简单的例子：

```
$a = "Powershell"
IF ($a -eq "PowerShell")
{
 "Statement is True"
}
ELSE
{
 "Statement is False"
} 
```

以下是一些对“if-then-else”语句充满信心的阅读材料：[Powershell 中的 IF_THEN_ELSE](http://blogs.technet.com/b/flaphead/archive/2006/09/12/455555.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T22:12:12.557

`=`运算符用于赋值。用于`-eq`测试是否相等。

# bash - Bash 脚本只读取文件的第一行

> ID：15167689
> 
> 赞同：6
> 
> 时间：2013-03-01T22:09:05.990
> 
> 标签：bash

我写了一个脚本来 ssh 到远程服务器以查找用户的磁盘使用情况。但是，此脚本只能读取第一行，它不会继续读取文件的其他行。我的脚本有什么问题吗？谢谢。

```
#!/bin/bash
FILE="myfile.txt"
while read line; do
server=`echo $line|awk '{print $1}'`
cpid=`echo $line|awk '{print $2}'`
echo $server "---" $cpid "---" `ssh $server grep $cpid /var/cpanel/repquota.cache|awk '{print int($3/1000) "MB"}'`
done < $FILE 
```

myfile.txt 内容：

服务器1用户1 服务器2 用户
2 服务器3 用户
3

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T22:38:03.177

该`ssh`调用从 while 循环继承其标准输入，该循环从您的文件重定向。这会导致`ssh`命令使用文件的其余部分。您需要使用不同的文件描述符来提供`read`命令：

```
#!/bin/bash
FILE="myfile.txt"
while read -u 3 server cpid; do
  printf "$server---$cpid---"
  ssh $server "grep $cpid /var/cpanel/repquota.cache | awk '{print int($3/1000) \"MB\"}'"
done 3< $FILE 
```

另一种方法是将输入显式重定向到`ssh`from `/dev/null`，因为无论如何您都没有使用它。

```
#!/bin/bash
FILE="myfile.txt"
while read server cpid; do
  printf "$server---$cpid---"
  < /dev/null ssh $server "grep $cpid /var/cpanel/repquota.cache | awk '{print int($3/1000) \"MB\"}'"
done < $FILE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:18:08.727

首先，您可以将读取循环简化为

```
while read server cpid; do
    echo $server "---" $cpid "---" `ssh ...`
done <$FILE 
```

并用 awk 保存解析。另一个简化是保存对 grep 的调用并让 awk 进行搜索`$cpid`

```
ssh $server "awk '/$cpid/ {print int(\$3/1000) \"MB\"}' /var/cpanel/repquota.cache" 
```

对于您的问题，我猜`ssh`调用不会返回，因为它等待密码或其他东西，因此会阻止循环继续。

# loops - 通过成对的字符串在Stata中循环

> ID：15167690
> 
> 赞同：2
> 
> 时间：2013-03-01T22:09:07.447
> 
> 标签：loops, stata

鉴于其状态缩写，我正在尝试设置一个等于状态 fips 代码的变量。除了：

如果 other_variable=="[state_abbrev]" 则替换 fips = "[fips 代码]"

我目前有 50 行。我想创建一个循环，但鉴于我有两个变化的值，我不知道如何避免循环遍历每个排列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T14:11:47.077

没有明显的捷径，但在Stata中

```
 . search merge, faq 
```

查找 Kit Baum 的相关常见问题解答。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T14:29:03.237

[这是常见问题解答](http://www.stata.com/support/faqs/data-management/group-characteristics-for-subsets/)中涵盖的策略示例。

1) 创建一个包含两个变量的数据集：状态名称和关联的 fips 代码。为了使这稍微灵活一些，我包含了州名的常用半缩写。将来，您可以添加包含两个字母的州缩写的第三个变量。

```
clear
input fips str20 state
1 "alabama"
2 "alaska"
4 "arizona"
5 "arkansas"
6 "california"
8 "colorado"
9 "connecticut"
10 "delaware"
11 "district of columbia"
12 "florida"
13 "georgia"
15 "hawaii"
16 "idaho"
17 "illinois"
18 "indiana"
19 "iowa"
20 "kansas"
21 "kentucky"
22 "louisiana"
23 "maine"
24 "maryland"
25 "massachusetts"
26 "michigan"
27 "minnesota"
28 "mississippi"
29 "missouri"
30 "montana"
31 "nebraska"
32 "nevada"
33 "new hampshire"
34 "new jersey"
35 "new mexico"
36 "new york"
37 "north carolina"
37 "n. carolina"
38 "north dakota"
38 "n. dakota"
39 "ohio"
40 "oklahoma"
41 "oregon"
42 "pennsylvania"
44 "rhode island"
45 "south carolina"
45 "s. carolina"
46 "south dakota"
46 "s. dakota"
47 "tennessee"
48 "texas"
49 "utah"
50 "vermont"
51 "virginia"
53 "washington"
54 "west virginia"
54 "w. virginia"
55 "wisconsin"
56 "wyoming"
72 "puerto rico"
end

save statefips, replace 
```

2) 加载包含状态名称变量的主数据集，**并**使用`statefips.dta`.

```
sysuse census, clear

// Convert the state names to lowercase to ensure
// consistency with the statefips dataset
replace state = lower(state)

merge m:1 state using statefips.dta

drop if _merge == 2
drop _merge 
```

如果您想保留主数据集中状态名称的大小写，您可以简单地生成一个临时变量并将其用于合并，即

```
gen statelower = lower(state)
merge m:1 statelower using statefips.dta 
```

此外，一旦您创建了`statefips.dta`数据集，就无需在每次要执行合并时重新创建它。您可以简单地将它与您的项目文件捆绑在一起，并在必要时使用它。如果您发现要添加两个字母的状态缩写或进行一些其他更改，那么几乎可以立即重新创建它。

# c++ - 需要覆盖父虚函数

> ID：15167694
> 
> 赞同：1
> 
> 时间：2013-03-01T22:09:15.227
> 
> 标签：c++

我正在开发一个序列化系统，我所有的可序列化类都实现了

```
virtual void serialize(Buffer buffer); 
```

当一个指针要被序列化时，我需要调用类本身的 serialize() 函数，而不是它的任何父类的函数，即使指针是父类型，我已经遇到了很多的错误，因为我没有注意到子类甚至根本没有 serialize() 所以父 serialize() 类只是被调用

IE

```
class A
{
    virtual void serialize();
}

class B:public A
{
    virtual void serialize();
}

class C:public B
{
    virtual void serialize();
}

void doSerialization(A *a)
{
    a->serialize();
}

C *c=new C();
doSerialization(c); 
```

现在，如果 C 没有序列化函数，则 B::serialize() 将被静默调用。我更喜欢一条错误消息，或者任何其他至少会向我指出的东西。C++（甚至是'11）中是否有任何关键字可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:17:23.377

在 C++ 中没有*简单*的方法可以做到这一点。

*虽然*有一个 hack，在[这个答案](https://stackoverflow.com/a/9661580/1225541)中解释，使用虚拟继承并强制你的类注册`serialize`他们正在使用的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:17:28.493

在父级中使用纯虚函数：

```
virtual void serialize(Buffer buffer) = 0; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T22:18:05.267

在编译时，您只能通过在非最终类中使函数成为纯虚函数来做到这一点：

```
class A
{
    virtual void serialize() = 0;
}

class B:public A
{
    virtual void serialize() = 0;
}

class C final:public B
{
    virtual void serialize();
} 
```

当然，这意味着您设计中的所有具体类都必须是`final`. 如果您必须从具体类继承，则不能在编译时强制执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T22:19:18.357

> 现在，如果 C 没有序列化函数 B::serialize() 将被静默调用。

不，你会得到链接器错误。如我所见，这就是你想要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T23:06:50.597

解决此问题的一种变体是不继承多个层，因此`class C: public B`您使用. 代替`class C: public A`. 当然，这不一定适用于所有场景。

迟早在某个时候，您确实必须将事情交给程序员。

也可能有一些方法可以检查这一点， - 也许创建一个临时指针`B`并检查是否`typeid(*this) == typeid(temp)`或类似？

# macos - cmake 找不到 glib2

> ID：15167695
> 
> 赞同：2
> 
> 时间：2013-03-01T22:09:20.213
> 
> 标签：macos, cmake, macports

在 OS X 10.8.2 上，我有 macports 并已安装：

```
glib2
pkg-config 
```

除其他事项外。我运行的 cmake 尝试使用 pkg-config 来查找 glib2。运行`pkg-config --libs glib-2.0`：

`-L/opt/local/lib -lglib-2.0 -lintl`

和`--cflags`：

`-I/opt/local/include/glib-2.0 -I/opt/local/lib/glib-2.0/include -I/opt/local/include`

然而，当我尝试将这些输入（单独或全部使用`;`or `:`）以及各种组合时，或者当我尝试下载 gtk 并使用其中的 glib2 目录时：cmake 抱怨它找不到目录：

```
checking for module 'gstreamer-0.10'
  found gstreamer-0.10, version 0.10.36
checking for module 'glib-2.0'
  found glib-2.0, version 2.34.3
CMake Error at /Applications/CMake 2.8-10.app/Contents/share/cmake-2.8/Modules/FindPackageHandleStandardArgs.cmake:97 (message):
  Could NOT find GLib2 (missing: GLIB2_LIBDIR GLIB2_INCLUDE_DIRS)
Call Stack (most recent call first):
  /Applications/CMake 2.8-10.app/Contents/share/cmake-2.8/Modules/FindPackageHandleStandardArgs.cmake:291 (_FPHSA_FAILURE_MESSAGE)
  cmake/Modules/FindGLib2.cmake:127 (find_package_handle_standard_args)
  cmake/Modules/FindGStreamer.cmake:12 (find_package)
  CMakeLists.txt:32 (find_package) 
```

我看到了[这个](http://mac-os-forge.2317878.n4.nabble.com/Package-glib-2-0-not-found-in-pkg-config-search-path-td195399.html)`pkg-config`关于与 MonoDevelop冲突的页面。我卸载了 Mono，没有找到任何其他 pkg-config 二进制文件，并且没有任何运气就清除了 cmake 缓存。我查看了 cmake 的细节，并在这些目录中寻找 glib.h 和 glibconfig.h。为什么它不能表现得很好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T05:25:39.020

尝试使用这个文件：[http ://svn.opensync.org/branches/3rd-party-cmake-modules/modules/FindGLIB2.cmake](http://svn.opensync.org/branches/3rd-party-cmake-modules/modules/FindGLIB2.cmake)

在您的主 CMakeLists.txt 文件中，输入以下行：

```
set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_SOURCE_DIR}/helper/") 
```

这是假设上面的 FindGLIB2.cmake 存储在 src 之外的目录 /helper 中。

该文件的内容将帮助 CMake 更好地找到 GLIB2。

此链接将帮助您了解这些文件的工作原理：[http ://www.cmake.org/Wiki/CMake:How_To_Find_Libraries#Writing_find_modules](http://www.cmake.org/Wiki/CMake:How_To_Find_Libraries#Writing_find_modules)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-01T06:28:33.987

我在使用on`wireshark-3.4.2`从源代码构建时遇到了这个问题。错误是`cmake``Centos8.2/RHEL8.2`

*   `Could NOT find GLIB2 (missing: GLIB2_LIBRARY GLIB2_MAIN_INCLUDE_DIR GLIB2_INTERNAL_INCLUDE_DIR) Required is at least version "2.32.0")`

而我的系统已经预装了`glib-2.56.4` 解决方案：已安装的`glib2-devel`软件包。然后 cmake 正确找到了 glib-2.0。cmake 输出如下所示：

*   `-- Checking for one of the modules 'glib-2.0'`
*   `-- Found GLIB2: /usr/lib64/libglib-2.0.so (found suitable version "2.56.4", minimum required is "2.32.0")`

# javascript - youtube search api - 数据太多，我可以限制 api 返回的节点吗？

> ID：15167699
> 
> 赞同：4
> 
> 时间：2013-03-01T22:09:37.397
> 
> 标签：javascript, jquery, youtube, youtube-api

我可以以某种方式限制 json 对象返回的节点数量吗？我只使用每个搜索结果中的标题、作者和视频 ID，所以我不需要加载和解析一百万个其他节点。无论如何，除了运行它认为服务器端代理之外，还要这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T02:13:37.237

不知道为什么每个人都说不，因为虽然您不能将其限制为 JUST title、channelId 和 videoId，但您可以选择省略一些字段。您可以在 Data Api 的 v3 中使用“字段”参数。 [在此处查看文档。](https://developers.google.com/youtube/v3/docs/search/list)

未设置字段的响应：

```
{
 "kind": "youtube#searchListResponse",
 "etag": "\"a6IVtoIjS7Yw-1cFQOGQ6_bjjs4/_DFSOhdxHuGG_p_f1fVZOosZghs\"",
 "pageInfo": {
  "totalResults": 1000000,
  "resultsPerPage": 2
 },
 "nextPageToken": "CAIQAA",
 "items": [
  {
   "id": {
    "kind": "youtube#video",
    "videoId": "dw1HavgoK9E"
   },
   "kind": "youtube#searchResult",
   "etag": "\"a6IVtoIjS7Yw-1cFQOGQ6_bjjs4/aY_GfDmiGidcZL_TBO7vI8YP9XY\"",
   "snippet": {
    "publishedAt": "2013-02-15T09:38:27.000Z",
    "channelId": "UCvZuIe7j7oBfaWAL0sO3JzQ",
    "title": "Drivers stoned on marijuana test their driving skills",
    "description": "If you watched this video and liked Addy, you can watch outtakes of her here: http://kiro.tv/WFNEMZ CNN may have just posted their best piece of investigativ...",
    "thumbnails": {
     "default": {
      "url": "https://i.ytimg.com/vi/dw1HavgoK9E/default.jpg"
     },
     "medium": {
      "url": "https://i.ytimg.com/vi/dw1HavgoK9E/mqdefault.jpg"
     },
     "high": {
      "url": "https://i.ytimg.com/vi/dw1HavgoK9E/hqdefault.jpg"
     }
    }
   }
  }
} 
```

API 调用：[https://www.googleapis.com/youtube/v3/search?part=id%2Csnippet&maxResults=1&q=test&key={YOUR_API_KEY}](https://www.googleapis.com/youtube/v3/search?part=id,snippet&maxResults=1&q=test&key=%7BYOUR_API_KEY%7D)

带有字段集的响应：

```
{
 "items": [
  {
   "id": {
    "kind": "youtube#video",
    "videoId": "dw1HavgoK9E"
   },
   "snippet": {
    "publishedAt": "2013-02-15T09:38:27.000Z",
    "channelId": "UCvZuIe7j7oBfaWAL0sO3JzQ",
    "title": "Drivers stoned on marijuana test their driving skills",
    "description": "If you watched this video and liked Addy, you can watch outtakes of her here: http://kiro.tv/WFNEMZ CNN may have just posted their best piece of investigativ...",
    "thumbnails": {
     "default": {
      "url": "https://i.ytimg.com/vi/dw1HavgoK9E/default.jpg"
     },
     "medium": {
      "url": "https://i.ytimg.com/vi/dw1HavgoK9E/mqdefault.jpg"
     },
     "high": {
      "url": "https://i.ytimg.com/vi/dw1HavgoK9E/hqdefault.jpg"
     }
    }
   }
  }
} 
```

API 调用：[https://www.googleapis.com/youtube/v3/search?part=id%2Csnippet&maxResults=1&q=test&fields=items(id%2Csnippet)&key={YOUR_API_KEY}](https://www.googleapis.com/youtube/v3/search?part=id,snippet&maxResults=1&q=test&fields=items%28id,snippet%29&key=%7BYOUR_API_KEY%7D)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:16:55.437

没有。通过代理似乎不是一个好主意。如果你只是在想，我在浪费带宽，让我们削减它，那么你不能。;)

# java - Java - 声明类一次在任何地方使用

> ID：15167701
> 
> 赞同：0
> 
> 时间：2013-03-01T22:09:44.737
> 
> 标签：java, class, static, global

非常简单的问题，但我没有正确理解静态。

我有一个包含我的 main 及其调用 testMain 的 java 文件。

使用我的 testMain 它可以创建许多使用其他类的类。

例如 testMain>>GUI 和 testMain>>model 和 testMain>>controller

现在我有一个名为 generatorTester 的类，我想声明一次：

```
public static utils.generatorTester randomGen = new utils.generatorTester (); 
```

（utils 是我的常用类的自定义包）

为什么上面的行不大声我做以下

```
classNameOfMainFunction.randomGen 
```

我在这里编程错了吗？这甚至可能吗？

我基本上想使课程全球化并在任何地方使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:15:38.203

公共类的公共静态字段可以在任何地方使用，您只需要使用正确的语法来访问它。

如果您声明：

```
package foo;

public class Global {
    public static Some thing;
} 
```

做

```
import foo.Global; 
```

您可以使用以下方式访问该字段

```
Global.thing 
```

或者，你可以做

```
import static foo.Global.thing; 
```

并使用

```
thing 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T22:12:38.227

你能得到的最好的结果是这样的：

```
public abstract class GloballyUsed {
    public static int method() { return 4; 
    /* determined by fair
     * dice roll, guaranteed to be random */
    } 
```

和：

```
GloballyUsed.method(); 
```

打电话到别处。

从 Java 5 开始，每条评论都需要注意（我刚刚了解到这一点），您可以只导入一个特定的方法名称：

```
import static {package}.GloballyUsed.method; 
```

注意我添加了关键字`abstract`，这是为了进一步让您相信您从未实际实例化`GloballyUsed`。它没有实例。`static`你可能有一些关于什么意思的阅读要做。

# ember.js - 如何从 Ember 数据存储中删除所有数据？

> ID：15167703
> 
> 赞同：3
> 
> 时间：2013-03-01T22:09:46.497
> 
> 标签：ember.js, ember-data

在我正在开发的使用 Ember-data 的 Ember.js 应用程序中，一旦用户到达屏幕上的某个点，我想删除存储在与应用程序关联的 ember-data 存储中的所有状态，并从可以开始从服务器中提取数据的白板。有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T07:28:56.117

我不认为有一个简单的方法。ATM 循环遍历所有`DS.Model`类并单独销毁记录的唯一方法。

```
App.Model.all().forEach(model) ->
  model.destroy();

App.Model2.all().forEach(model) ->
  model.destroy() 
```

# facebook - Facebook 赞按钮和访问令牌

> ID：15167704
> 
> 赞同：0
> 
> 时间：2013-03-01T22:09:59.970
> 
> 标签：facebook, facebook-like, access-token

我想在我的网页上显示一个类似 Facebook 的按钮。我正在使用 plugin/likes.php Facebook 脚本

我知道用户 access_token。我希望喜欢按钮在没有用户身份验证的情况下工作。

有没有办法让 access_token 直接给喜欢按钮？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:17:45.560

不，`like`按钮登录身份验证与您无关。当他们尝试喜欢该对象时，Facebook 将检查他们是否在当前浏览器中登录到 Facebook。除非用户已授权您的应用程序，否则您想要做的事情是不可能的。

但是，如果他们已登录到您的应用程序，并且您拥有，则一旦他们单击该按钮`access_token`，您就可以发布内置类型的 Open Graph 操作。[您可以在这些文档](https://developers.facebook.com/docs/technical-guides/opengraph/built-in-actions/likes/)`like`中阅读有关如何执行此操作的信息。

# c# - 如何绑定到 BindingList 中的所有元素？

> ID：15167705
> 
> 赞同：0
> 
> 时间：2013-03-01T22:10:03.887
> 
> 标签：c#, binding, inotifypropertychanged, bindinglist

我有一个`BindingList`由实现`INotifyPropertyChanged`.

```
public MyClass : INotifyPropertyChanged
{
    // ...
}

var element1 = new MyClass();
var element2 = new MyClass();
var myBindingList = new BindingList<MyClass> {element1, element2}; 
```

每次更改列表中的一个元素并运行某种方法时，我都希望收到通知。如何绑定到列表中的所有元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:32:16.873

我已经通过以下方式解决了这个问题：

```
foreach (MyClass myClass in myBindingList)
{
    myClass.PropertyChanged += MyClassOnPropertyChanged;
}

private void MyClassOnPropertyChanged(object sender, PropertyChangedEventArgs propertyChangedEventArgs)
{
    // ...
} 
```

# php - 下拉列表 & php

> ID：15167707
> 
> 赞同：-1
> 
> 时间：2013-03-01T22:10:06.477
> 
> 标签：php, xml, forms

我正在尝试创建一个下拉列表，限制每页显示的图像数量并允许用户决定显示多少图像，默认情况下我设置了 5 我试图搜索我没有设法找到的网络这里有一个解决方案是我尝试过的代码

```
<form action="image_search.php" name="formSize" method="post">  
   <span id="PageSize" style="color:Gray;">Page Size:</span>
   <select name="pagesize">
    <option selected="selected" value="5">5</option>
    <option value="20">20</option>
    <option value="50">50</option>
    <option value="100">100</option>
   </select>&nbsp;
  <span id="Title" style="color:Gray;"></span>
</form>
<?php
    include_once("includes/images.php");
    $xml = simplexml_load_file("xml/images.xml"); //load the images
     $page = 0;
       if (isset($_POST['formSize']))
       {
             $varSize = $_POST['pagesize'];
        }
$MAXELEMENTSPERPAGE = $varSize; //change this value to display how many elements per page you wish people to see
 $maxPage = count($xml)/$MAXELEMENTSPERPAGE;

if(isset($_GET['page']))
   {
     $page = $_GET['page'];   //if page is specif
     }
?> 
```

如果我删除 $varSize 并将其替换为它可以工作的数字，但我得到这个错误 Undefined variable: varSize

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:11:49.670

在用户 POST 到页面之前，varSize 必须有一个值。所以在你的 if 语句之外定义 varSize 。然后，如果用户更改它，它将更改。

```
$varSize = 5;
if (isset($_POST['formSize'])){
    $varSize = $_POST['pagesize'];
}
$MAXELEMENTSPERPAGE = $varSize; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:13:19.253

> 我收到此错误未定义变量：varSize

因为它是未定义的。只需定义它！

```
$varSize = isset($_POST['pagesize']) ? intval($_POST['pagesize']) : 5; 
```

# wolfram-mathematica - 在列表中保存绘图选项

> ID：15167715
> 
> 赞同：2
> 
> 时间：2013-03-01T22:10:46.363
> 
> 标签：wolfram-mathematica, mathematica-8

我想知道是否可以为 Show[] 函数创建一个包含所需样式的信息的变量。所以每次我想在 Show[] 中显示图时，我都会在 Show[] 中插入该变量来设置样式选项。

我想要这样的东西...

```
OPTIONS=
     AxesOrigin -> Automatic,
     LabelStyle -> Directive[14, Black, Bold, Italic],
     ImageSize -> {450}

    Show[
     ListLinePlot[data],
     OPTIONS
     ] 
```

解决方案很简单，但我是绿色的。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:15:15.253

```
OPTIONS = {AxesOrigin -> Automatic, 
  LabelStyle -> Directive[14, Red, Bold, Italic], ImageSize -> {450}}

Show[ListLinePlot[{1, 2, 3, 4, 5}], OPTIONS] 
```

为我工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T09:15:07.430

您可以使用`Show`自动将选项应用于图形`$Post`，例如

```
$Post := With[{opts = {
     AxesOrigin -> Automatic,
     LabelStyle -> Directive[14, Black, Bold, Italic],
     ImageSize -> {250}}},
  If[Head[#] === Graphics, Show[#, opts], #] &]

ListLinePlot[{1, 2, 3, 4, 5}] 
```

![在此处输入图像描述](../Images/def447ab721f115adaec5353298172e0.png)

恢复`$Post`默认：

```
$Post =. 
```

# ruby-on-rails - 如何在 Rails 表单中的 datetime_select 上应用时区

> ID：15167716
> 
> 赞同：3
> 
> 时间：2013-03-01T22:10:47.190
> 
> 标签：ruby-on-rails, datetime, timezone

我有一个看起来像的表格

```
= form.datetime_select :due_at
= form.time_zone_select :time_zone, ActiveSupport::TimeZone.us_zones 
```

保存此对象后，我们需要它来应用所选的时区。例如，如果用户选择“03-01-2013 11:00”和“中部时间（美国和加拿大）”，我希望日期/时间，在这种情况下 11AM 为 11AM CST 而不是我们的应用程序默认时区“太平洋时间（美国和加拿大）”。

这实际上嵌套在另一种形式中，因此我们不能简单地使用 around_filter 更改控制器中的 Time.zone。我们正在尝试找出一个在夏令时也可以工作的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T05:23:35.617

如果`due_at`和`time_zone`都是单个模型的属性，那么您可以使用 before_save 挂钩来确保在存储到数据库之前`due_at`的时区中进行编码。`time_zone`

```
class YourModel < ActiveRecord::Base
  before_save :apply_time_zone

  protected

  def apply_time_zone
    self.due_at = ActiveSupport::TimeZone[time_zone].parse "#{due_at_start.to_s(:db)} UTC"
  end
end 
```

`ActiveSupport::TimeZone[t].parse(s)`将解析`s`为 time zone `t`，`.to_s(:db)`并将时间转换为 UTC 字符串。

# xml - 我创建了如下的 XML 代码

> ID：15167717
> 
> 赞同：-1
> 
> 时间：2013-03-01T22:10:47.690
> 
> 标签：xml

我第一次编写了一个 xml 代码，它代表 cd 上的两首歌曲，其中 title 是艺术家的兄弟，song 是 cd 的子元素，cd 是根元素，song 是艺术家的父元素，并且歌曲有一个名为 rating 的属性，其中包含一个介于 1 和 10 之间的数字。请让我知道这是否正确，如果有些事情是错误的，请纠正我。谢谢....

```
<?xml version="1.0?>
<cd>
 <song1 rating ="8">
  <artist>MJ</artist>
  <title>Pop</title>
 <song1/>
 <song2 rating = "9">
  <artist>JL</artist>
  <title>Love</title>
<song2/>
</cd> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:17:03.050

这是一个有效的 xml。你有很多错误：

```
<?xml version="1.0"?>
<cd>
 <song track="1" rating="8">
  <artist>MJ</artist>
  <title>Pop</title>
 </song>
 <song track="2" rating="9">
  <artist>JL</artist>
  <title>Love</title>
</song>
</cd> 
```

这是一个在线验证器：http: [//validator.w3.org/check](http://validator.w3.org/check)

# c# - 更改应用程序的启动键盘

> ID：15167722
> 
> 赞同：0
> 
> 时间：2013-03-01T22:11:06.253
> 
> 标签：c#, wpf

我的问题是我希望我的应用程序作为希伯来语应用程序运行。我的意思是当我在整个应用程序中输入一些东西时，默认情况下它是希伯来语而不是英语。

我在这里看到的每个问题都是如何改变控制文化。
当主窗口加载时，我尝试将cultureinfo更改为he-IL......但这没有帮助，应用程序仍设置为英文。

我可能做错了什么，请直接解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:19:56.607

您必须在初始化控件之前设置区域性。之前在构造函数中设置这个`InitializeComponent();`

```
Thread.CurrentThread.CurrentUICulture = new System.Globalization.CultureInfo("he-IL"); 
```

**编辑** 要更改键盘输入语言，请参阅[本文](http://msdn.microsoft.com/en-us/library/system.windows.forms.inputlanguage.currentinputlanguage.aspx)

# php - CakePHP 1.3：为动作传递参数

> ID：15167723
> 
> 赞同：0
> 
> 时间：2013-03-01T22:11:25.300
> 
> 标签：php, cakephp-1.3

`$this->Form->create('MyModel', array('action' => 'view'))`我有一个带有选项值 1、2 和 3 的下拉表单。当提交此表单时`view`（`controller/view/option_value`使用加载一些适当的数据`option_value`。

我似乎无法将此`option_value`作为动作参数传递。这是一个 POST 数据，所以我`option_value`在控制器中确实可以使用它，但我认为在 URL 中包含该值也会很好，因为这`view.ctp`允许用户更新一些内容并且我希望用户被重定向到推荐人很容易。

有任何想法吗？我*认为*这是一个客户端问题.. 但我还不熟悉 Javascripts。

编辑：仍在研究如何做到这一点.. 但现在，我只是将不包含在 URL 中的表单提交页面重定向到带有as 参数`option_value`的同一页面。`option_value`它可以满足我的需要，但是如果有人想添加答案，我将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T00:58:46.483

使用 jQuery：

```
<?php

echo $this->Form->create('MyModel', array('id' => 'myForm', 'action' => 'view'));
echo $this->Form->input('MyField', array('id' => 'myField'));
echo $this->Html->scriptStart();
?>
    $('#myForm').on('submit', null, null, function(evt) {
        var form  = $('myForm'),
            field = $('#myField');

        form.action += "/" + field.value;
        form.submit();

        evt.stopPropagation();
    });
<?php
echo $this->Html->scriptEnd();
echo $this->Form->end(__('Submit', true));

?> 
```

试试看，你可能需要根据自己的需要调整一些东西。干杯。-安德鲁

# html - 如何在窗口调整大小时使布局不自动调整

> ID：15167731
> 
> 赞同：-1
> 
> 时间：2013-03-01T22:11:55.433
> 
> 标签：html, css, twitter-bootstrap

我目前在[一个网站](http://www.nosquebecois.com)上工作，当我调整窗口大小时，整个内容都会得到调整（见图 1）。

如何删除自动调整并使其像图像 2 ？

顺便说一句，我正在使用引导程序

1.  ![错误的导航栏](../Images/5af40afcb2e1b20d43037e15718378d5.png)

2.  ![成为导航栏](../Images/2406762ba72c2183a38cea6288eb316a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:19:09.087

您应该在您的 上添加一个`min-width: 1000px;`或任何您想要的`div.container`，以便当元素的宽度最终大于包装器本身的宽度时它不会中断。

# queue - 如何在 Lightswitch Grid 中保持脏数据排序

> ID：15167733
> 
> 赞同：0
> 
> 时间：2013-03-01T22:12:02.843
> 
> 标签：queue, visual-studio-lightswitch

我有一个具有“订单”列的实体。

我有一个屏幕上的网格绑定到所述实体的集合。

实体项应该在网格中上下移动，只需更改“Order”的值，因为填充集合的查询按“Order”排序。

这样做的逻辑完美无缺，但是我无法让网格以编程方式对其行进行排序，它也不会在数据最初加载时自动保存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T03:31:20.413

你有没有试过这样写代码`TestQuery_PreprocessQuery`：

```
partial void TestQuery_PreprocessQuery(ref IQueryable<Label> query)
{
    query = query.OrderBy(c => c.Order);
} 
```

还有一些关于计算字段、关系字段和使用的考虑。你可以看看这个[Lightswitch 网格排序问题](http://social.msdn.microsoft.com/Forums/en-US/lightswitch/thread/48af3c60-01f8-4727-8da8-6a21e6c057b8/)

# jquery - 重置路径变量 Jquery Mobile

> ID：15167734
> 
> 赞同：1
> 
> 时间：2013-03-01T22:12:03.460
> 
> 标签：jquery, ajax, jquery-mobile

我正在设置滑动导航以与 jquery mobile 一起使用。我创建了一个基于导航 ul 设置下一个和后退 url 的函数（使用变量传递到函数中）。

该函数在初始加载和使用 window.location 而不是正确的 $.mobile.changePage ajax 调用时效果很好。有没有办法在每次 ajax 页面加载后重置此函数的变量，以便它具有正确的路径。

我在每个页面的 data-role="page" 元素中调用它，但变量仍在加载时传递。

```
function swipeNav(targetList){
        /* Setup Nav array - links and IDs */
        var navIDs = new Array();
        var navLinks = new Array();
        var nextPage = 0;
        var pervPage = 0;

        /* Setup Nav array with links and ids */
        $(targetList + ' li').each(function(){
          navIDs.push($(this).find('a').attr('id'));
          navLinks.push($(this).find('a').attr('href'));
        });

        /* Get current nav item based on location path */
        var currentURL = window.location.pathname;
        var htmlPage = currentURL.split('/');

        var currentPage = $.inArray(htmlPage[htmlPage.length-1], navLinks);
        if(currentURL == "/"){
            currentPage = 0;
            }

        /* Get number of nav items, prepare for navigation loop */
        var navLoop = navLinks.length;

        /* Sets next & prev page number based on current URL path */
        nextPage = currentPage + 1;
        prevPage = currentPage - 1;

        /* Add swipe support for navigation / based on navigation items */
        $('body').live('swipeleft swiperight',function(event){
            if (event.type == "swipeleft") {
                if(nextPage == navLoop){ $.mobile.changePage(navLinks[0]); }
                else{ $.mobile.changePage(navLinks[nextPage]); }    /* If last page of nav, loop to page 1 */
             }
             if (event.type == "swiperight") {
                if(prevPage < 0){ $.mobile.changePage(navLinks[navLoop - 1]); }
                else{ $.mobile.changePage(navLinks[prevPage]); } /* If first page of nav, loop to last page */
             }
        });
    } 
```

这是每个页面中对该函数的调用

```
<div id="page-load" data-role="page" data-theme="a">
<script type='text/javascript' src='js/swipenav.js'></script>
<script>
$(document).ready(function() {
swipeNav('ul.nav-links');      
});
</script> 
```

# google-chrome-extension - XMLHttpRequest 在没有清单权限的情况下成功？也许CORS？

> ID：15167738
> 
> 赞同：2
> 
> 时间：2013-03-01T22:12:36.097
> 
> 标签：google-chrome-extension, xmlhttprequest, cross-domain, google-api, youtube-api

我开发了一个使用 YouTube Data API **v2**的 Google Chrome 扩展。我在清单中的权限字段如下所示，因为脚本是在 youtube.com 下的页面中注入的，我还需要访问选项卡：

```
"permissions": ["tabs", "*://*.youtube.com/*"] 
```

当我向 YouTube Data API **v2**发出请求时，这也有效，因为请求是对[http://gdata.youtube.com/](http://gdata.youtube.com/)完成的，所以它是同一个域。但是现在我正在迁移到 YouTube Data API **v3**，并且请求必须通过[http://www.googleapis.com/youtube/v3/](http://www.googleapis.com/youtube/v3/)完成（注意**HTTPS**而不是 HTTP 也）。然而，令人惊讶的是，*我的请求在没有添加任何新权限的情况下完美运行*。

我知道，我在问一些似乎不是问题的问题，但我个人认为我在软件中不理解的任何行为都是问题。为什么会这样？我是否不应该添加权限，例如`"*://*.googleapis.com/*"`为了使我的 XMLHttpRequest 请求对 API 起作用？

我对此也有**一些猜测**：[HTTP Access Control headers](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS)。我的请求确实发送了一个`Origin`带有 value 的标头`chrome-extension://myExtensionId`。API 的答案还包含以下标头：

`Access-Control-Allow-Origin: chrome-extension://myExtensionId`

但这可能是 Chrome 允许我在清单中未定义任何额外权限的情况下执行跨域 XMLHttpRequest 的原因吗？不确定，显然这在 Google API、YouTube 数据 API v3 或 Chrome 扩展开发者文档中的任何地方都没有记录。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T09:39:36.960

如果 Chrome 在清单中没有找到权限，它会将请求视为正常请求。这意味着当设置正确的[CORS](http://www.w3.org/TR/cors/)标头时，请求仍然会成功。否则，请求会因为[同源策略](https://developer.mozilla.org/en-US/docs/JavaScript/Same_origin_policy_for_JavaScript)而失败。

Google API JavaScript 库明确提到了对 CORS 的支持：

> [**发出请求：选项 3**](https://code.google.com/p/google-api-javascript-client/wiki/GettingStarted#Making_a_request%3a_Option_3)
> Google API 支持 CORS。请访问 CORS 页面以获取有关使用 CORS 发出请求的更多信息。

如果可能的话，我仍然建议将权限添加到清单文件中。对于[简单的请求](http://www.w3.org/TR/cors/#simple-method)，这并没有带来任何好处。对于非简单请求，这将使请求数量减半：非简单请求之前总是有一个预检（OPTIONS）请求，该请求检查客户端是否被允许访问源。

通过将权限添加到清单文件中，Chrome 将不会回退到 CORS，并且始终使用一个网络请求来完成请求。伟大的！
但是……如果您是已经部署的扩展的作者，您可能会再想一想。当新的原始权限添加到清单文件时，扩展将被禁用，直到用户批准扩展。对话框显示“删除扩展”和“启用”并排显示，因此有可能失去用户。

如果您愿意，可以使用在选项页面激活的[可选权限来解决此问题。](http://developer.chrome.com/extensions/permissions.html)用通俗的语言清楚地说明该选项将提高扩展的速度，并且不要忘记提及将请求额外的权限。

# windows - 从批处理脚本执行 WshShell 命令

> ID：15167742
> 
> 赞同：4
> 
> 时间：2013-03-01T22:12:49.933
> 
> 标签：windows, batch-file, wsh

我有一个简单的问题：

从 Windows 批处理 (.bat) 脚本执行单个 WshShell 命令的最佳方法是什么？

*（希望它不是用 VB 代码创建新文件）*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T01:38:27.973

您可以通过 VBScript 或 Jscript 访问 WshShell。两者都可以嵌入到批处理文件中，但 JScript 更简洁。

大多数人通过编写临时 VBS 文件来批量执行 VBScript。但是可以在没有临时文件的情况下执行此操作。请参阅[是否可以在不使用临时文件的情况下在批处理文件中嵌入和执行 VBScript？](https://stackoverflow.com/q/9074476/1012053)各种选项。

在批处理中嵌入 JScript 非常容易。请参阅[https://stackoverflow.com/a/5656250/1012053](https://stackoverflow.com/a/5656250/1012053)。我使用了该技术的一个非常细微的变化。

```
@if (@X)==(@Y) @end /* Harmless hybrid line that begins a JScript comment

:: ******* Begin batch code *********
@echo off
:: Your batch logic goes here

:: At any point you can execute the following to access your JScript
cscript //E:JScript //nologo "%~f0" yourJscriptParametersGoHere

:: Be sure to terminate your script so that 
:: it does not fall through into the JScript code
exit /b

********* Begin JScript code **********/
var WshShell=WScript.CreateObject("WScript.Shell")

/* do whatever with your WshShell object */ 
```

解释：

该技术的关键是第一行。它必须是对 JScript 和批处理都具有有效语法的行。

Batch 将第一行视为一个简单的 IF 命令，该命令的计算结果始终为 false，因此它永远不会执行不存在的 @end 命令，并且不会造成任何伤害。在到达 exit /b 之前，以下行都是正常的批处理代码，此时批处理终止，其余行将被忽略。

JScript 将第一行视为一个空的条件编译块，然后是多行注释的开头。JScript 忽略以下批处理代码，因为它是注释的一部分。注释以 结尾`*/`，然后是普通的 JScript 代码。

唯一可能失败的是您的批处理代码必须包含`*/`在其中，因为这会过早终止 JScript 注释。但这可以通过在批处理解析后消失的`*`和之间放置一些东西来解决。`/`如果代码没有被引用，那么您可以简单地转义斜杠，如下所示`*^/`：如果代码被引用，那么您可以扩展一个未定义的变量：`*%=%/`. `=`保证不会定义一个名为的变量。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-02T15:24:11.270

这是我用来编写 Batch-JScript 混合脚本的方法：

```
@if (@CodeSection == @Batch) @then

:: The first line above is...
:: in Batch: a valid IF command that does nothing.
:: in JScript: a conditional compilation IF statement that is false,
::             so this section is omitted until next "at-sign end".

@echo off

rem EXPR.BAT: Evaluate a JScript (arithmetic) expression
rem Antonio Perez Ayala

rem Define an auxiliary variable to call JScript
set JSCall=Cscript //nologo //E:JScript "%~F0"

rem Do Batch business here, for example:
%JSCall% %1
goto :EOF

End of Batch section

@end

// JScript section

WScript.Echo(eval(WScript.Arguments.Unnamed.Item(0))); 
```

例如：

```
EXPR 1/3 
```

* * *

**编辑**：如果你想要一个更简单/更短的方法，使用这个：

```
@set @a=0  /*
@cscript //nologo //E:JScript "%~F0" "%~1"
@goto :EOF */

WScript.Echo(eval(WScript.Arguments(0))); 
```

同样，第一个`@set @a=0 /*`是 JScript 和 Batch 中的有效语句/命令，仅用于插入 JScript 注释 (/*) 的开头，因此 JScript 将忽略 Batch 部分。评论在 final 之后关闭 (*/) `goto :EOF`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-12T17:29:47.917

感谢以上内容启发我进行轻微修改。

```
@if (false)==nul ======= CMD code =======
@echo off
::code before Cscript
cscript //nologo //e:jscript "%~f0" %*
echo it returns: %errorlevel%
::code after Cscript 
exit /b
=================================
Freedom Land ^o^
======= J/VB Script code ======
@end
// Start Cscript
WScript.Echo("wsh says: Hello, Universe!");
WScript.Quit(123.456) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-26T13:33:23.790

您还可以使用适用于 node.js 的此方法：

```
0</* ::

@echo off

    echo hello from batch

    rem -- CALLING NODE
    ::node "%~f0" %*

    rem -- CALLING CSCRIPT
    cscript //E:JScript //nologo "%~f0" %*

exit /b %errorlevel%

*/0;

// -- NODE CODE
//console.log('Hello from Node');

// -- JScript CODE 
WScript.Echo("Hello from JSCript") 
```

# apache - 使用 Puppet 配置服务器，使用 Capistrano 部署

> ID：15167751
> 
> 赞同：0
> 
> 时间：2013-03-01T22:13:34.807
> 
> 标签：apache, capistrano, puppet

我在通过与 Capistrano 部署兼容的 Puppet 配置服务器时遇到问题。我正在使用[puppetlabs/apache](https://github.com/puppetlabs/puppetlabs-apache)来设置我的虚拟主机，它（正确地）检查是否`docroot`存在（如果不存在则创建它，忽略潜在的嵌套目录问题）。然而，真正的`docroot`将是`/var/www/vhosts/${::fqdn}/current/public`，并且 Capistrano 将在部署时创建适当的符号链接（从`current`到`releases/{releasestamp}`），并且当 Puppet 预先设置该目录路径时不高兴（由于`current`是实际目录，而不是符号链接，并且不为空）。

我考虑过添加类似的东西：

```
file { "/var/www/vhosts/${::fqdn}/current":
  ensure => 'link',
  target => '/tmp/initial'
} 
```

并在 处设置一个空白文件`/tmp/initial/public/index.html`，以便 Capistrano 在部署时能够指向`current`适当的版本。但是，这意味着每当有人重新运行配置（例如，应用任何配置更改）时，符号链接将被重新定位到垃圾目录（如果它当时甚至存在的话）。

有什么建议么？我考虑过将配置分为应用程序配置和服务器配置，并让 Capistrano 在部署时执行应用程序配置，但我真的更希望保持简洁。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T00:32:25.000

您应该只使用 Puppet 创建应用程序目录，并让 Capistano负责使用任务创建`releases`和目录，并在使用.`shared``cap deploy:setup``current``cap deploy`

更具体地说，我建议在您的 Puppet 配置中使用它：

```
file { "/var/www/vhosts/${::fqdn}":
  ensure => 'directory'
} 
```

然后，作为一次性设置步骤，运行此任务以指示 Capistrano在Puppet 应该为您创建的目录中创建`releases`和`shared`目录：`/var/www/vhosts/${::fqdn}`

```
cap deploy:setup 
```

此后，只需运行`cap deploy`以部署您的应用程序，这将为您创建或更新`current`符号链接。

（请注意，您可以将`-n`选项传递`cap`给预览 Capistrano 将运行的确切命令，例如，`cap -n deploy:setup`将显示`mkdir`它运行的命令。）

### 更新

Puppet 的标准[Apache](https://forge.puppetlabs.com/puppetlabs/apache)模块似乎要求`docroot`存在，它使用以下内容：

```
# This ensures that the docroot exists
# But enables it to be specified across multiple vhost resources
if ! defined(File[$docroot]) {
  file { $docroot:
    ensure => directory,
    owner  => $docroot_owner,
    group  => $docroot_group,
  }
} 
```

但是您可以使用以下方法禁用它：

```
file { "/var/www/vhosts/${::fqdn}/current/public":
  ensure => directory,
  replace => false,  # don't replace the directory once Capistrano makes it a symlink
} 
```

只是自己定义资源可能会阻止模块的`if ! defined(File[$docroot])`一部分`apache::vhost`运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-28T22:31:18.417

斯图尔特，

感谢您的出色回答。我发现我必须稍微修改一下，将 replace => false 放在“当前”目录上，而不是“当前/公共”目录上，就像这样（使用 vagrant 所有者）：

```
file {
  '/home/vagrant/app/current':
    ensure => directory,
    replace => false,
    owner  => vagrant,
    group  => vagrant,
 } 
```

# python - cget('image') 方法返回 pyimage1 而不是图像名称

> ID：15167754
> 
> 赞同：0
> 
> 时间：2013-03-01T22:13:48.707
> 
> 标签：python, widget, tkinter

我是编程新手，我正在尝试使用 python 3.3 中的 tkinter 创建一个应用程序。在这个应用程序中，我正在使用包含图像的按钮，并且我想要执行取决于按钮所包含的图像类型的操作。这是我的程序的简化版本：

```
from tkinter import *
master=Tk()
c_black = PhotoImage(file="c_black.gif")
b=Button(master, image=c_black)
print(b.cget('image'))
master.mainloop() 
```

代替

```
c_black 
```

控制台返回

```
pyimage1 
```

我不知道为什么。我已经想弄清楚几个小时了。也许有办法以不同的方式做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:56:44.917

`cget()`您只能将属性检索为字符串，因此您需要存储对对象的引用`PhotoImage`：

```
b = Button(...)
b.image = c_black
print(b.image.cget('file')) 
```

# ios6 - 存折通知失败

> ID：15167758
> 
> 赞同：0
> 
> 时间：2013-03-01T22:14:07.320
> 
> 标签：ios6, passbook

遵循“iOS 6 by tutorials”一书中的中级存折教程 [http://www.raywenderlich.com/store/ios-6-by-tutorials](http://www.raywenderlich.com/store/ios-6-by-tutorials)

我可以通过电子邮件发送通行证，将其添加到通行证，在我的应用程序中更新它，当我打开存折时它会更新，但我没有收到任何通知。通知在设置中打开。

我的猜测是它可能是我服务器的防火墙。我是嚎叫服务器设置的新手。我在godaddy vps（centos）上运行。当我在 iptables 上运行列表时，我得到以下信息：

iptables -L -vn

![在此处输入图像描述](../Images/e407460168aa1c9a0d667448a6bdd1dc.png)

这看起来对吗？任何线索表示赞赏！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T01:59:01.940

这不太可能是由于服务器端的防火墙问题 - 但可能是您的设备连接到的路由器的防火墙问题。Apple 在端口 5223 上向设备发送推送通知，因此需要在本地路由器上打开它（假设您通过 wifi 连接）。如果您可以从其他应用程序（WhatsApp、Facebook 等）接收推送通知，那么您可以排除防火墙问题。

您声明通行证确实已更新 - 这意味着 Apple 正在接收推送并触发设备从您的 Web 服务检索新通行证，或者如果您使用`replacePassWithPass`通过应用程序更新通行证，这是按预期运行。

为了让通行证显示通知消息：

*   通行证数据字段必须已更改（更改通行证类型、颜色、图像或标签值不会触发通知），并且
*   该字段必须具有`changeMessage`键集（理想情况下，`changeMessage`包含`%@`将被新字段值替换）

如果满足上述两个条件但您仍然没有收到通知，请尝试将您的设备连接到 Xcode 并在更新 pass 时查看控制台日志。

# ios - 当用户拒绝初始提示时，Apple Push Notification 注册回调？

> ID：15167761
> 
> 赞同：4
> 
> 时间：2013-03-01T22:14:16.610
> 
> 标签：ios, apple-push-notifications

当我第一次打电话`registerForRemoteNotificationTypes`时`UIApplication`，用户会收到有关允许此应用程序向他们发送推送通知的系统提示。如果他们说是，那么`didRegisterForRemoteNotificationsWithDeviceToken`就会调用我的应用程序委托。如果他们说不，`didFailToRegisterForRemoteNotificationsWithError`则**不会**被调用。一旦他们对最初的提示说不，当我将来尝试重新注册时，我就再也不会收到任何回电了。

这是标准行为吗？知道他们何时拒绝该提示的最佳方式是什么？ [Apple 在这方面的文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html)并没有说明任何关于这种情况的有用信息。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-02T00:35:34.347

用户决定选择哪个选项不会影响使用哪个回调。如果用户说“否”，您仍然会成功获得用户的设备令牌。您仍然可以向此设备发送推送通知，Apple 的反馈服务会报告它们已送达（这意味着反馈服务不会告诉您他们已取消订阅）。推送“否”的唯一效果是“隐藏”针对特定应用发送到设备的推送通知。

由于此设计决策，用户可以通过转到设置 -> 通知来撤销此决策，并为您的应用重新启用推送通知并接收推送通知，而无需从您的应用或操作系统进行任何特殊的重新注册逻辑。

编辑（iOS7）：在 iOS 5 上注意到了这种行为。当我在 iOS 7 上再次测试时，我在按下“不允许”后没有收到设备令牌。只有在我访问设置 > 通知 > MyApp 并启用通知后，我才获得设备令牌。

编辑（iOS8）：在 iOS 8 中，通知设置与远程通知分开，但行为类似于 iOS 7。在您的应用程序授权通知之前，您似乎不会获得设备令牌。我正在测试的应用程序没有启用远程通知后台模式功能，但如果您的应用程序确实启用了该功能，即使未启用通知，您也可以获得设备令牌。（我很难对此进行测试，因为尝试让该通知提示再次出现非常痛苦。）

# makefile - 没有 GNU-make 模式的 Makefile 动态规则

> ID：15167766
> 
> 赞同：6
> 
> 时间：2013-03-01T22:14:36.267
> 
> 标签：makefile, gnu-make

我有一组要编译的 .cpp 文件。这些 .cpp 文件位于分层目录结构中。我希望相应的 .o 文件最终都放在一个构建文件夹中。

这是我让 GNU make 枚举文件的方法...

```
SRCS = \
    $(wildcard $(CODE)/**/*.cpp) \
    $(wildcard $(CODE)/AlgebraLibraries/**/*.cpp) \
    $(wildcard $(CODE)/Calculator/Environments/**/*.cpp)

BARE_SRCS = $(notdir $(SRCS))
BARE_OBJS = $(BARE_SRCS:.cpp=.o)
OBJS = $(addprefix $(BUILD)/, $(BARE_OBJS)) 
```

完成此操作后，我不知道如何创建从 .cpp 文件创建 .o 文件的规则。直观地说，我想做的是以下伪代码。

```
for i=0, N do  # <-- a for-loop!
  $(OBJS)[i]: $(SRCS)[i]   # <-- the rule!
    $(CPP) -c $(SRCS)[i] -o $(OBJS)[i] # <-- the recipe
end 
```

当然，这不是有效的 GNU make 代码，但我相信你明白我想要做什么。以下将不起作用。

```
%.o: %.cpp
    $(CPP) -c $< -o $@ 
```

这不起作用，因为 GNU make 匹配 % 符号，假设 .o 文件与 .cpp 文件一起存在。

所有这一切的替代方法，我知道它会起作用，但会非常乏味，是手动列举所有规则作为显式规则。那是迟钝！一定有更好的方法。

我一直在研究 GNU make 生成规则的能力，但是如果没有内置逻辑，似乎没有办法做到这一点。如果我可以利用一些流控制语句来生成我想要制定的规则，那就太好了。这是对 GNU-make 的要求太多了吗？

无论如何，有没有办法做我正在尝试用 GNU make 做的事情？如果是这样，怎么做？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-02T02:39:42.053

这看起来像是……几个高级制作技巧的工作：

```
all: $(OBJS)

define ruletemp
$(patsubst %.cpp, $(BUILD)/%.o, $(notdir $(1))): $(1)
    $$(CPP) -c $$< -o $$@
endef

$(foreach src,$(SRCS),$(eval $(call ruletemp, $(src)))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-23T17:37:16.297

如果`$(BUILD)`是恒定的，你总是可以这样做：

```
$(BUILD)/%.o: %.cpp
    $(CPP) -c $< -o $@ 
```

# php - Laravel Eloquent 搜索两个可选字段

> ID：15167770
> 
> 赞同：1
> 
> 时间：2013-03-01T22:14:55.970
> 
> 标签：php, laravel, eloquent

我正在尝试使用 eloquent 搜索两个可选表：

```
$users  = User::where('ProfileType', '=', 2)
                ->where(function($query) {
                    $query->where('BandName', 'LIKE', "%$artist%");
                    $query->or_where('Genre', 'LIKE', "%$genre%");
                })->get(); 
```

当用户进行空搜索时，这适用于返回所有结果，但我不确定如何调整它以在存在时搜索乐队名，反之亦然。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-06T18:14:11.813

只是为了解释下面的答案会发生什么：

Eloquent 在这里做了一件棘手的事情：当你调用`User::where(...)`它时，它会返回一个[Database\Query](http://laravel.com/api/class-Laravel.Database.Query.html)对象。`DB::table('users')->where(...)`这与构造 SQL 查询的可链接对象基本相同。

所以有：

```
// Instantiates a Query object
$query = User::where('ProfileType', '=', '2');
$query->where(function($query) {
    // Adds a clause to the query
    if ($artist = Input::get('artist')) {
        $query->where_nested('BandName', 'LIKE', "%$artist%", 'OR');
    }
    // And another
    if ($genre = Input::get('genre')) {
        $query->where_nested('Genre', 'LIKE', "%$genre%", 'OR');
    }
});

// Executes the query and fetches it's results
$users = $query->get(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T20:29:30.583

建立在维尼修斯的回答的基础上，这就是有效的：

```
// Instantiates a Query object
$query = User::where('ProfileType', '=', '2');

// Adds a clause to the query
if ($artist = Input::get('artist')) {
    $query->where('BandName', 'LIKE', "%$artist%");
    // Temp Usernamesearch
    $query->or_where('NickName', 'LIKE', "%$artist%");
}

// Genre - switch function if artist is not empty
if ($genre = Input::get('genre')) {
    $func = ($artist) ? 'or_where' : 'where';
    $query->$func('Genre', 'LIKE', "%$genre%");
}

// Executes the query and fetches it's results
$users = $query->get(); 
```

事实证明，只有在未设置 $artist 时，第二个可选字段才必须使用 or_where。

谢谢你的帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T21:50:52.097

我想这就是你所追求的。您的视图将有一个表单来搜索艺术家/流派，可以设置一个或另一个，或者两者都设置，或者不设置。

```
$users = User::where('ProfileType', '=', 2);

if (Input::has('artist')) {
    $users = $users->where('BandName', 'LIKE', '%'.Input::get('artist').'%');
}

if (Input::has('genre')) {
    $users = $users->where('Genre', 'LIKE', '%'.Input::get('genre').'%');
}

$users = $users->get(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-02T12:35:49.713

```
$query = FormEntry::with('form')->where('domain_id', $id);

$query->where(function($query) use ($search, $start, $limit, $order, $dir) {                
     $query->where('first_name', 'LIKE', "%{$search}%")
           ->orWhere('last_name', 'LIKE', "%{$search}%")
           ->orWhere('email', 'LIKE', "%{$search}%")
           ->offset($start)
           ->limit($limit)
           ->orderBy($order, $dir);
      });

$entries = $query->get();
$totalFiltered = $query->count(); 
```

# ruby-on-rails-3 - 将博客集成到现有应用程序中

> ID：15167771
> 
> 赞同：3
> 
> 时间：2013-03-01T22:15:00.790
> 
> 标签：ruby-on-rails-3, github, gem, blogs

是否有任何引擎可以让人们将博客集成到现有的应用程序/平台中？

我对 Rails 很陌生，但我很快就学会了，并且已经实现了 Devise 和 Omniauth，理想情况下，我希望在用户登录时实现一个博客。

我搜索了 Stackoverflow、GitHub 和其他资源，但无济于事。不过，我听说 Tom-Preston-Warner 的 Jekyll 可能会用作博客引擎。

所以我的问题是：是否有任何宝石或教程可以帮助 Rail 的用户在现有应用程序中实现博客引擎？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:24:54.183

Jekyll 使用 git 和 repo 中的文件来构建博客，它被称为静态站点生成器。如果你想要一个 Rails 引擎，看看`https://github.com/KatanaCode/blogit`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:23:41.553

最流行的博客引擎之一是 Refinery ( [https://github.com/refinery/refinerycms-blog](https://github.com/refinery/refinerycms-blog) )。您可以将 gem 添加到您的项目中并将其用于您的目的。

这取决于你想要你的博客有多复杂。只使用一个专用控制器和几个视图就可以很容易地组合一些东西。

# sql-server-2008 - 优化 TSQL Join

> ID：15167773
> 
> 赞同：-1
> 
> 时间：2013-03-01T22:15:05.283
> 
> 标签：sql-server-2008, tsql, join

有一个查询需要超过一分钟才能运行
表有超过 200 万行
[sID] 是 PK
[textHash] 已编入索引并允许空值
两个索引的碎片都小于 1%
我想要添加 [textHash] 匹配到基本 where
由于 [textHash] 可以为 null 需要两个连接条件

由于在主选择上建立其他条件的方式，联盟不是一个选项。
在下一个主要版本中，将更改构建查询的方式以能够使用 UNION。

一般来说，我想加入一个可以为空的属性
如果它为空，则包含基于 PK 的行

```
Select top 10001 [docFam].[sID] 
From [docSVsys] with (nolock) 
LEFT OUTER JOIN [docSVsys] as [docFam] with (nolock) 
   On [docSVsys].[sID] = [docFam].[sID] 
   Or [docSVsys].[textHash] = [docFam].[textHash]
Where [docSVsys].[sID]  <=  '1000'
 Group By  [docFam].[sID] 
 Order By  [docFam].[sID] Asc 
```

如果有人会告诉我如何复制查询计划，我将包括它

我尝试了 HASH、MERGE 和 LOOP 提示。
前两个编译器拒绝并且 LOOP 较慢然后没有提示。

我试过

```
On ([docSVsys].[textHash] is null and [docSVsys].[sID] = [docFam].[sID])
Or  [docSVsys].[textHash] = [docFam].[textHash] 
```

而且速度较慢

类似的查询在 2 秒内运行
但在这种情况下 [sParID] 不为空，所以我只需要一个连接条件

```
Select top 10001 [docFam].[sID] 
From [docSVsys] with (nolock) 
LEFT OUTER JOIN [docSVsys] as [docFam] with (nolock) 
   On [docSVsys].[sParID] = [docFam].[sParID] 
Where [docSVsys].[sID]  <=  '1000'
 Group By  [docFam].[sID] 
 Order By  [docFam].[sID] Asc 
```

对于返回少量行的查询 APPLY 有效。
下面的语法运行时间为 1 秒，而上面的语法运行时间为 1 分钟（返回 1,022 行）。

对于返回大量行的条件的两种形式的查询仍然存在问题，但我不认为这是 SQL 或语法问题 - 很多行需要更长的时间。

```
Select [docFam].[sID] 
From [docSVsys] with (nolock)
OUTER APPLY -- cross apply 
  (   
    Select [docSVsysHashNull].[sID] 
    From   [docSVsys] as [docSVsysHashNull]with (nolock) 
    where  [docSVsysHashNull].[sID] = [docSVsys].[sID]
   union
    Select [docSVsysHashNotNull].[sID] 
    From   [docSVsys] as [docSVsysHashNotNull]with (nolock) 
    where  [docSVsysHashNotNull].[sID] != [docSVsys].[sID]
      and  [docSVsysHashNotNull].[textHash] = [docSVsys].[textHash]
  ) as docFam
Where [docSVsys].[sID]  <=  '1000'
Group By [docFam].[sID]
Order By [docFam].[sID] Asc 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T01:53:13.703

你有没有考虑用`exists`条款写它。像这样的东西

```
select distinct top 10001 a.[sID]
From [docSVsys] as a
where exists 
(
select *
From [docSVsys] as b
where b.[sID]<='1000'
and ( a.[sID] = b.[sID] OR a.[textHash] = b.[textHash])
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:22:56.637

答案在@NikolaMarkovinović 的评论中提供

```
select distinct isnull(docFam.sID, docSVsys.sID) as sID 
from  docSVsys 
left  join docSVsys as docFam 
  on  docSVsys.textHash = docFam.textHash 
where ... 
```

# jquery - 在 .getJSON 函数之外调用变量？

> ID：15167775
> 
> 赞同：3
> 
> 时间：2013-03-01T22:15:12.320
> 
> 标签：jquery, getjson

我正在尝试调用 .getJSON 函数之外的变量。我在 .getJSON 函数之外声明它，然后在 .getJSON 函数中为其分配一个值。但是，当我尝试将其拉出时，它说它是空的（当我在控制台日志中看到它里面有信息时）。这是代码：

```
function calcRoute() {
    var start = document.getElementById('start').value;
    var end = document.getElementById('end').value;
    var waypts = [];
    $.getJSON("/westcoast_map.php", // The server URL
      { westcoast_id : $('.opener').data('westcoast_id') }, // Data you want to pass to the server.
      function(json) {
        waypts = json[1];
        console.log(waypts); //prints out full array
      });
    console.log(waypts); //prints out an empty array 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:19:34.157

我不记得这叫什么，但这是一个时间问题。getJson 是异步的。因此，您的 javascript 在 JSON 请求甚至可以返回之前处理 JSON 请求之后的部分。您需要在完整函数中调用一个函数并将其传入。

```
var waypts = [];
$.getJSON("/westcoast_map.php", // The server URL
    { westcoast_id : $('.opener').data('westcoast_id') }, // Data you want to pass to the server.
    function(json) {
        waypts = json[1];
        console.log(waypts); //prints out full array
        runCodeAfter();
    });
function runCodeAfter(){
    console.log(waypts); //should print out full array.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:20:14.530

在 JavaScript 中，变量的作用域仅在函数内部有效，因此您无法在函数 calcRoute 之外访问变量 waypts。

如果你想这样做，你必须在函数外部声明变量 waypts。

编辑：

如果您不想在收到来自 ajax 调用的响应后执行某些操作，您可以使用 jQuery 执行此操作：

```
 function calcRoute() {
        var start = document.getElementById('start').value;
        var end = document.getElementById('end').value;
        var waypts = [];
        var data = $.getJSON("/westcoast_map.php",
          { westcoast_id : $('.opener').data('westcoast_id') });
      $.when(data).then(function(theData){
         waypts = theData[1];
      });
   } 
```

# javascript - ng-repeat in a directive does not update if the data changes

> ID：15167779
> 
> 赞同：0
> 
> 时间：2013-03-01T22:15:20.603
> 
> 标签：javascript, angularjs, angularjs-directive, angularjs-scope

I have this problem on a larger project and I made the most simplistic example.

I have a controller that has some data in it. This data is fed into the directive and should be displayed using the native ng-repeat. However, when the directive-controller runs, it has not yet parsed the angular variable, thus not rendering the repeat.

How do I make it work so that the repeat works with that outside variable that needs pre-parsing?

Here is a fiddle. Make sure you have the console open as it shows there that it is undefined when the function runs, but defined 1 second later: [http://jsfiddle.net/paulocoelho/xqLAs/2/](http://jsfiddle.net/paulocoelho/xqLAs/2/)

Here my JS:

```
var module = angular.module('testApp', [])
    .directive('test', function () {
    return {
        restrict: 'E',
        template: '<p ng-repeat="x in sl">{{x.val}}</p>', // this wont work :(
        scope: {
            sl: '@sl'
        },
        link: function ($scope, $element, $attrs) {
            console.log($attrs.sl);        // this will return undefined
            setTimeout(function(){ 
                console.log($attrs.sl);    // this will return the correct list
            },1000);
        }
    };
});

function sweetCtrl($scope){
    $scope.someList = 
    [
        {"val":"a"},
        {"val":"b"},
        {"val":"c"},
        {"val":"d"},
        {"val":"e"},
        {"val":"f"}
    ];
} 
```

Here is my dom

```
<div ng-app="testApp" ng-controller="sweetCtrl">
    <p>raw list: {{someList}}</p>
    <p>repeat list:</p>
    <test sl="{{someList}}"></test>
</div> 
```

**EDIT:** There is was an error on my previous code where inputdata should read sl.

解决方案的小提琴在这里：http: [//jsfiddle.net/paulocoelho/xqLAs/3/](http://jsfiddle.net/paulocoelho/xqLAs/3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:26:15.113

当您使用“@”时，结果始终是一个字符串。如果您将模板更改为显示 {{x}} 而不是 {{x.val}} 您会明白我的意思。

要将对象传递给您的隔离范围，请使用“=”：

```
<test sl="someList"></test>

template: '<p ng-repeat="x in sl">{{x.val}}</p>', // this will work :)
scope: {
     sl: '='
}, 
```

另外，正如我（刚才）在你的[另一个问题](https://stackoverflow.com/a/15167819/215945)中解释的那样，当使用 '@' 时，你需要使用 $attrs.$observe 或 $scope.$watch() 来异步获取值（这将是一个字符串） . 使用'='，您不必使用$observe 或$watch。

# facebook - 未经授权的源 IP 地址 使用 facebook sdk

> ID：15167781
> 
> 赞同：2
> 
> 时间：2013-03-01T22:15:32.600
> 
> 标签：facebook, sdk

我的网站使用“facebook api sdk”来访问用户的 facebook 信息，然后登录。

产生以下错误消息：“错误：无法访问 Facebook API 客户端（在 users_getInfo(693671783) 上失败）。结果：; OAuthException: (#5) 未经授权的源 IP 地址”。我尝试使用不同的 facebook 插件（Nextend Facebook Connect），但产生了相同的错误消息。

我尝试在应用程序设置中填写IP地址白名单，但仍然无法正常工作...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-27T04:58:01.217

**你在用 Heroku 吗？**

如果是这样，您的服务器传出 IP 将在您每次部署时不断变化，一些 Herokus IP 被 Facebook 列入黑名单，因此这确实是一件随机的事情，具体取决于您当时获得的服务器。

**[当您查询 API 时，使用Proximo](https://addons.heroku.com/proximo)**等修复您的传出 IP将使您的源 IP 可预测，但它有点贵。

如果您有一个带有单个测功机的小型应用程序，您可以继续回收，`heroku ps:restart`直到您获得一台“好”服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-30T15:43:05.607

如果您有多个实例（ Dynos 和 Workers ），可能并非所有实例都被列入黑名单。运行“heroku ps:restart”可能会将一些好的实例移动到坏的 IP。相反，我建议仅通过以下方式回收不良实例

```
heroku restart bad_instance_name --app=your_app_name 
```

您可以通过 grepping 找到实例

```
heroku logs -t --app=your_app_name | grep 'Unauthorized source IP address' 
```

结果输出将显示实例名称。

这对我们来说比 'heroku ps:restart' 效果更好，因为我们有超过 5 个正在运行的实例，并且在任何时候只有 1 或 2 个实例的 IP 错误。

# c# - 创建多个服务器对象和处理时的 IIS 性能

> ID：15167786
> 
> 赞同：1
> 
> 时间：2013-03-01T22:15:40.340
> 
> 标签：c#, iis, iis-7

我目前正在编写一个应用程序，它将为我们的网络服务器自动化几个管理项目。我的问题很简单，但我找不到任何文档；当调用我们的`ServerManager`通过`using Microsoft.Web.Administration`时，如果服务器对象连接定期打开和关闭（处置），它会不会有任何性能障碍？

我知道在 SQL 数据库中，频繁的连接调用在很多情况下会降低性能；所以我不想遇到类似的问题。

我试图避免创建一个`Instance`将`Persisted`传出任务排队然后执行的方式。

如果有人可以让我知道，并指出任何关于它的文档，那就太好了。但就像我说的，我现在找不到任何东西。

一个小规模的例子：

```
public void AddSite()
{
    ServerManager defaultManager = new ServerManager();

    // Perform Task
    defaultManager.CommitChanges();
    defaultManager.Dispose();
}

public void RemoveSite()
{
    ServerManager defaultManager = new ServerManager();

    // Perform Task
    defaultManager.CommitChanges();
    defaultManager.Dispose();
} 
```

通过本质上基于每种方法构建对象；那么关闭它会影响性能吗？

* * *

**更新：**

该示例是一个非常基本甚至原始的示例。将进行一些重构以遵循良好实践，例如实施`IDisposable`. 然而，主要的困境是我无法准确地描述与 SQL 相同的变化。

在过度打开和关闭的 SQL 中，您会看到所有服务逐渐蚕食性能，尤其是随着数据库复杂性的增长。

那是我对 IIS 的目标，目前我无法获得准确的表示。性能确实在改变；我知道它加载的大多数服务也在序列化和反序列化解释配置的 XML 文件。

知道 IIS 有多复杂，我将它自动化，但尝试做最简单的路径。我想知道这种简单化的方法是否需要更复杂的方法或重构。由于它确实创建的那些服务和流程确实会消耗资源。

我试图准确地描述那些可能的障碍，但我找不到任何文档甚至是*Performance Gains for IIS 的*详细信息。

*另外，每次我进行测试时，结果都会出现零星的、不一致的，并且最终不可靠。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T00:12:39.683

你在寻找这样的东西吗？

```
 private ServerManager _defaultManager = new ServerManager();

   public void AddSite()
   {
        // perform task
        _defaultManager.CommitChanges();            
    }

    public void RemoveSite()
    {
        // perform task
        _defaultManager.CommitChanges();
    }

    public void Dispose() {
       _defaultManager.Dispose();
    } 
```

您应该能够运行几个测试来确定上述是否确实表现得更好。我已经看到它在这样的事情上是双向的。我确实建议您实现 IDisposable 接口，因为 ServerManager 实现 IDisposable 并且我的代码将使您的类拥有“托管 IDisposable 资源”

[http://blog.stephencleary.com/2009/08/how-to-implement-idisposable-and.html](http://blog.stephencleary.com/2009/08/how-to-implement-idisposable-and.html)

# ruby - Sinatra 渲染多个 .erb 文件的方式

> ID：15167788
> 
> 赞同：1
> 
> 时间：2013-03-01T22:16:01.877
> 
> 标签：ruby, session, sinatra, session-cookies, erb

我有一个 Web 项目，它将呈现基于各种 .erb 文件的 HTML 文件。我不确定执行此操作的最佳方法，因为每个 .erb 文件都需要获取特定信息，例如 cookie 内容。

目前我已经使用了这个概念：

*   我有一个包含所有 .erb 文件的目录，这些文件使用以下方式呈现：

    ERB.new(模板).result

*   渲染的 HTML 将返回到主 .erb 模板，该模板将再次由 sinatra 渲染，使用：

    erb：主要

*   结果非常好，但我没有机会从基于会话的 cookie 中包含内容，因为 .erb 无法访问它们

我很确定，sinatra 框架提供了一种更好的方法来做到这一点。一个好办法是...

```
require 'sinatra'
enable :sessions

get "/" do
content1 = erb :template1, :locals => { :cookie => session[:cookie] }
content2 = erb :template2, :locals => { :cookie => session[:cookie] }
erb :mainTemplate, :locals => { :content => [content1, content2] }
end 
```

...但是，不幸的是，它并没有那么容易:(

有人有更好的主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:41:04.403

这是我为我所做的：

```
get '/Login' do verbose = params['verbose']
    cTest = MyTests.new("envo")
    result = cTest.login()

    if verbose == 'true'
        erb :newResultPage, :locals => {:result => result}
    elsif verbose == 'false'
        erb :resultPage, :locals => {:result => result}
    end
end 
```

基本上，我使用条件语句来确定要使用哪个页面。这是基于参数的。您还可以使用返回结果或您喜欢的任何其他条件。

# jquery - 在 jQuery ajax 调用中打开窗口会触发 iPad Safari 中的弹出警告消息

> ID：15167790
> 
> 赞同：2
> 
> 时间：2013-03-01T22:16:11.650
> 
> 标签：jquery, ajax, ipad, safari, popup

我有以下 javascript 代码来进行 ajax 调用，然后打开一个弹出窗口。它可以在任何浏览器的桌面上完美运行，但我在 iPad Safari 上收到警告消息“此站点正在尝试打开一个弹出窗口”，即使 Safari 的弹出窗口阻止程序设置为允许所有弹出窗口也是如此。经过一番调查，在 ajax 调用的回调中似乎是 window.open 的问题。有没有办法解决这个问题？谢谢。

```
function openPopup(_url) {
    jQuery.ajaxSetup({ cache: false}); 
    jQuery.getJSON(  
        _url,  
        function(json) {  
            window.open(json.myUrl);
        }  
    );  
} 
```

# java - 用java构建一个测试程序

> ID：15167791
> 
> 赞同：1
> 
> 时间：2013-03-01T22:16:14.113
> 
> 标签：java

您好，我是 Java 和 NetBeans 的新手，并且正在学习高级课程，我的课程为期 5 周，因此在 5 周内学习一门新的代码语言非常重要。无论如何，我有一个任务是创建一个名为 Movie 的类，该类包含电影名称和评级。提供获取和设置电影名称和评级的方法。创建一个名为 TestMovie 的类，该类创建三个具有不同名称和评级值的 Movie 实例，并打印有关每部电影的信息。我已经完成了代码，它通过了构建，但是我的教授想要一个程序工作和运行的屏幕截图，但我无法让 NetBeans 提出这个问题。我的书中删除了关于构建测试项目的章节。我可以在这里获得一些帮助或指示，这是我所做的代码：

```
package movie;

/**
 * 
 * @author Jason
 */
public class Movie {
    String movieRating;

    public Movie(String rated, String mtitle) {
        this.mrating = rated;
        this.title = mtitle;
    }

    public void setRating(String Rating) {
        movieRating = Rating;
    }

    // Get the rating
    public String getRating() {
        return movieRating;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getTitle() {
        return title;
    }

    @Override
    public String toString() {
        return "Movie" + " title=" + getTitle() + " rating=" + getRating();
    }

    public static void main(String args[]) {
        Movie mv = new Movie("", "");
        mv.toString();
    }

    private String title;
    private String mrating;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:45:58.640

As an alternative to the other answers suggesting printing the output to the console, with the Netbeans' UI editor you can easily create a window with a label showing the result, which makes it slightly more fancy.

You can get details on how to this [here](http://docs.oracle.com/javase/tutorial/uiswing/components/label.html). Here's an image from that page:

![enter image description here](../Images/5340766b3a1d9f0d74e2a98773f86d81.png)

The full working code is [here](http://docs.oracle.com/javase/tutorial/displayCode.html?code=http://docs.oracle.com/javase/tutorial/uiswing/examples/components/LabelDemoProject/src/components/LabelDemo.java). As you can see, it's just a few extra lines.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:28:11.413

您可以在控制台上运行测试，即创建一个`MovieTest`只有一个方法的类并创建三个 Movie ( OR )`main`实例/对象。在构造函数或方法中为它们分配值，然后使用方法或在.`Movie m1, m2, m3;``Movie[] movies;``set``print``println``System.out`

类似于以下内容：

```
public class MovieTest {
    public static void main(String[] args) {
        Movie[] movies = new Movie[] {new Movie("R1", "T1"), new Movie("R2", "T2"), new Movie("R3", "T3)";

        for (Movie i : movies) {
            System.out.println(i.toString());
        }    
    }
} 
```

然后以截屏结果结束。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T22:30:50.663

您的应用程序不打印任何输出，因为您调用了 toString()，但您不打印它的结果。

一个使用数据创建 3 个 Movie 实例的示例，将它们打印出来，然后制作控制台应用程序的屏幕截图。

```
public static void main(String args[]) {
    List<Movie> movieList = new ArrayList<Movie>(3);

    Movie mv1 = new Movie("very Good", "Testfilm 1");
    movieList add(mv1);
    mv1 = new Movie("good", "Testfilm 2");
    movieList add(mv1);
    mv1 = new Movie("not good", "Testfilm 2");
    movieList add(mv1);

    for (Movie m : movieList) {
         System.out.println(m.toString());
    }

} 
```

# android - 一个应用程序可以在Android中拥有root权限吗？

> ID：15167792
> 
> 赞同：0
> 
> 时间：2013-03-01T22:16:18.010
> 
> 标签：android

我需要写入文件并将其存储在 /data 或 /system 文件夹中。以下方式有效

1.  adb 重新挂载
2.  adb shell -> chmod 777 /data , chmod 777 /system

然后我的应用程序可以在这些文件夹下创建文件。有没有其他方法可以做到这一点？在这种情况下，所有权限似乎都不起作用，并且使用平台密钥对应用程序进行签名也不会为应用程序提供 root 权限。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:27:25.890

编写所需的权限：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

问：我可以更改根目录的写访问权限吗？ 答：默认情况下不可以。官方 Android 设备上提供的根文件系统是只读的，只有某些受严格限制的区域可以被应用程序写入。

但是阅读这篇文章并尝试：

[http://www.pocketmagic.net/2009/05/write-on-the-android-read-only-file-system/#.UTERDzA9Gqs](http://www.pocketmagic.net/2009/05/write-on-the-android-read-only-file-system/#.UTErDzA9Gqs)

# linux - 进程死亡时内核是否会删除打开的文件

> ID：15167793
> 
> 赞同：0
> 
> 时间：2013-03-01T22:16:19.013
> 
> 标签：linux, file-io, process

我正在使用 tmpnam() 在进程 1 中生成一个临时文件名。打开该文件并将文件名发送到另一个进程 2。另一个进程 2 打开并写入该文件。

但是，我只是想知道我的进程 1 是否死了，文件是否会被操作系统删除。看起来好像没有发生这种情况。在那种情况下，我有什么选择，这样我的进程 1 死后就没有文件了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:35:22.097

不，当您的进程终止时，内核不会删除打开的文件。

但是，您可以在进程终止之前删除打开的文件，只要您保持打开文件，该文件仍然会存在。但是，您将无法再按*名称*打开文件- 任何进一步的访问都只能通过打开的文件句柄。

例如

```
fname="/tmp/tempfilename";
fd=open(fname,O_RDWR);
unlink(fname);
/* fd is still a valid handle that can be written to, read from,
   lseeked on, or passed to a child process.  It will go away
   when the process exits. 
 */
/* Important note:  if you create a temp file like this on a 
   NFS filesystem, there will be a phantom file named something like 
   .nfsfile12983719
   that will stick around until the file descriptor is closed. 
   If you delete this file, it will be re-created.
  */ 
```

或者，您可以使用`tmpfile(3)`which 做大致相同的事情，只是它返回 a`FILE *`而不是 fd。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:36:26.007

操作系统不会为您删除文件。确定意图会很棘手：是用一些有用的数据写出的文件，还是现在该过程已经结束，它是无用的。

有几种方法可以考虑处理这个问题。在典型情况下，您会在退出过程中进行清理。如果你有问题，你几乎总能得到一个信号，你可以用它来清理东西。这里有一个例子：[Basic Signal Handling](http://www.gnu.org/software/libc/manual/html_node/Basic-Signal-Handling.html)，我在这里举了这个例子。

```
 #include <signal.h>

 void
 termination_handler (int signum)
 {
   struct temp_file *p;

   for (p = temp_file_list; p; p = p->next)
     unlink (p->name);
 }

 int
 main (void)
 {
   ...
   if (signal (SIGINT, termination_handler) == SIG_IGN)
     signal (SIGINT, SIG_IGN);
   if (signal (SIGHUP, termination_handler) == SIG_IGN)
     signal (SIGHUP, SIG_IGN);
   if (signal (SIGTERM, termination_handler) == SIG_IGN)
     signal (SIGTERM, SIG_IGN);
   ...
 } 
```

另一种选择是在文件名（或文件内容）中嵌入一个 pid。如果您的程序启动并看到一个 pid 与您的程序正在运行的实例不对应的文件，您可以尝试清理它。这似乎有点危险。

另一个稍微有点臭的解决方案是将它放在 /tmp/ 中，在那里它可以被清理，如果它被删除，以某种方式处理它。

# android - BitmapFactory.Options#outWidth 返回与实际位图不同的大小

> ID：15167794
> 
> 赞同：1
> 
> 时间：2013-03-01T22:16:19.250
> 
> 标签：android, android-image, bitmapfactory

我正在编写一个自定义类。在实际绘制之前，需要计算一个位图以进行一些预处理和调整大小。位图本身是经过预处理的 9-patch 图像。在构造函数中，有以下代码：

```
BitmapFactory.Options bmpOptions = new BitmapFactory.Options();
bmpOptions.inJustDecodeBounds = true;
BitmapFactory.decodeResource(getResources(), BITMAP_ID, bmpOptions);
Bitmap bmp = BitmapFactory.decodeResource(getResources(), BITMAP_ID);

Log.d(getClass().getSimpleName(), "width: " + bmp.getWidth() + " " + bmpOptions.outWidth + "; height: " + bmp.getHeight() + " " + bmpOptions.outHeight); 
```

运行 Android 3.2.2 的 7" Samsung Galaxy Tab 7 上的输出：

> 宽度：556 556；身高：890 890

运行 Android 4.1 的 10" Motorola Xoom 上的输出：

> 宽度：556 556；身高：890 890

运行 Android 4.2.2 的 7" Nexus 7 上的输出：

> 宽度：740 834；高度; 1185 1335

位图的实际尺寸为：

> 分辨率：558 x 892
> 
> 高清画质：836 x 1337

位图是经过预处理的 9-patch，这就是为什么尺寸相差 2 个像素的原因。我不明白为什么 Nexus 7 上的 hdpi 资产会产生如此大的不同。

我也尝试过这些配置：

```
bmpOptions.inScaled = false; 
```

和

```
bmpOptions.inTargetDensity = getResources().getDisplayMetrics().densityDpi; 
```

和

```
bmpOptions.inTargetDensity = getResources().getDisplayMetrics().densityDpi;
bmpOptions.inDensity = getResources().getDisplayMetrics().densityDpi; 
```

和

```
bmpOptions.inTargetDensity = 0;
bmpOptions.inDensity = 0; 
```

我也尝试了相反的方法并为解码的位图创建第二个 BitmapFactory.Options 并告诉它根本不缩放。

所有这些都提供了相同的精确结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-09T13:30:54.097

**要使用inJustDecodeBounds**选项获取实际图像大小，您需要将返回的**outWidth**和**outHeight**乘以比例系数，即**inTargetDensity/inDensity**。示例代码是：

```
public static void getBitmapDims(Resources res, int resId, Holder<Integer> width, Holder<Integer> height)
{
    BitmapFactory.Options opts = new BitmapFactory.Options();
    opts.inJustDecodeBounds = true;
    BitmapFactory.decodeResource(res, resId, opts);

    float scale = (float) opts.inTargetDensity / opts.inDensity;

    width.value = (int) (opts.outWidth * scale + 0.5f);
    height.value = (int) (opts.outHeight * scale + 0.5f);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T10:39:17.367

前 3 行不影响第 4 行，因为第 4 行不使用它上面的任何变量。也根本没有使用或填充“bmpOptions”。也许您在发布此问题时重命名了变量？

另外，位图图像文件是否可能位于具有密度限定符（或默认值，如 mdpi）的文件夹中？

仅当您将文件放入 drawable-nodpi 时，您将始终获得相同数量的宽度和高度像素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T22:32:07.030

难道是 Nexus 7 屏幕是***tv*** *dpi并从**drawable- **h** dpi*加载位图的事实吗？但是，*outXXXX*值与位图的最终宽度/高度不匹配仍然很奇怪。

# linq - 从 Sharepoint Web 部件中的 LINQ 查询中获取字符串？

> ID：15167796
> 
> 赞同：0
> 
> 时间：2013-03-01T22:16:32.037
> 
> 标签：linq, sharepoint, web-parts

我正在设置一个 Sharepoint Web 部件，用于跟踪我们各种产品的语言翻译。我可以创建翻译，现在我正在尝试重新填充表单控件，如果有人选择了一个已经有翻译的项目，即他们选择“French-ProductX”并且各种 texboxes 填充了该翻译的数据/产品。

我的 LINQ 查询正在提取正确的数据（项目名称是用户在下拉菜单中选择的产品）。

```
 var query = from translation in Translations
               where (Convert.ToString(translation.Name)) == itemname
               select translation; 
```

我可以将查询绑定到网格，看看我得到了正确的数据，但在那之后我就卡住了。我想提取两个字段（开始），“描述”和“功能”作为字符串并填充它们对应的 asp:TextBoxes。

我尝试转换为数组，它仍然正确绑定，但它没有索引字段，它被视为翻译类型的单个项目。

我尝试了 IEnumerable 查询并转换为数据视图，但在无法解决的 WHERE 子句上出现了转换错误。

我试过这个，但 VS 说“myitem”是一个未分配的局部变量。

```
 var query = from translation in Translations
               where (Convert.ToString(translation.Name)) == itemname
               select new { myitem = translation.Description, features = translation.Features };

   ItemDescription.Text = myitem; 
```

这似乎应该是一件简单的事情，我只是在这里遗漏了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:27:59.913

发生的事情是你得到一个匿名类型的 IEnumerable，它具有 myitem 和 features 的属性。

您需要将最后一行更改为：

```
ItemDescription.Text = query.First().myitem;
```

# git - 从另一个分支将本地 master 更新为远程 master

> ID：15167797
> 
> 赞同：6
> 
> 时间：2013-03-01T22:16:33.877
> 
> 标签：git

我有一个**开发** 分支，并且**origin/master**已更新。我跑`git pull`了，我可以看到远程更改。但是，当我之前做的时候，我的本地**主人**仍然在我离开的地方`git checkout devel`。我想将**源/主**更改合并到我的**开发**分支；这样的分支也存在于遥控器上。

我宁愿不签出**master**分支，因为我最终会重建一个庞大的系统。我可以从不同的分支将我的本地**master**移动到**origin/master吗？**然后我可以做一个`merge`from **devel**。还是直接`merge`让**源/主****开发**更容易？好像以后会很麻烦？

编辑：避免此问题的另一种方法是使用具有相同存储库的不同工作空间。
请参阅：[git new workdir](http://nuclearsquid.com/writings/git-new-workdir/) - 您可能同时签出**master**和**devel ，但使用相同的***.git*存储库。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-01T22:21:47.247

`master`将本地更新到`origin/master`然后合并它与直接合并之间的唯一区别是合并`origin/master`时预先生成的提交消息（好吧，假设您最终更新`master`）。所以我说只是合并`origin/master`。

* * *

也就是说，要回答“如何更新本地未签出分支以匹配其跟踪分支”的问题，您可以说

```
git push . origin/master:master 
```

这使用`git push`机器，但存储库`.`意味着“当前回购”。您的源分支指定为`origin/master`，您的远程分支指定为`master`，因此更新`master`以匹配`origin/master`。您可以使用管道命令执行相同的操作`git update-ref`，但使用`git push`更简单且更安全（因为默认情况下它会阻止非快进合并，而且我相信它也会阻止推送到您的签出分支）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T22:22:22.520

默认情况下，`git pull`将从远程分支获取并合并到您的当前分支。如果您没有在`git pull`命令中指定分支，Git 将使用为您的分支指定的分支，通常是远程跟踪分支。

因此，`git pull`在您的*开发*分支中运行将从远程获取*开发*分支并从那里合并更改，而不是从主分支。

请注意，仅运行`git fetch`将更新远程的所有远程分支。So`origin/master`将在获取后更新，允许您使用`git merge origin/master`.

显然这不会更新您的本地*master*，因此您可能希望稍后再更新它，然后再将您的*devel*分支合并到其中。

# tomcat - rich:fileUpload 无法通过带有 Apache2 + AJP + Tomcat 6.0.24 的 HTTP/SSL 上传

> ID：15167798
> 
> 赞同：1
> 
> 时间：2013-03-01T22:16:34.417
> 
> 标签：tomcat, ssl, richfaces

我目前无法`rich:fileUpload`在 Chrome 25 或 IE 8 中通过 HTTPS 工作。POST 已发送，但从未收到响应。奇怪的是，它*确实*在 Firefox 19 中通过 HTTPS 工作。在使用 HTTP 时，它也适用于所有浏览器。HTTP 和 HTTPS 请求都通过 Apache httpd 2 提供给 Tomcat 6。

查看挂起的 HTTPS 请求线程时，`org.ajax4jsf.request.MultipartRequest`不断尝试读取超出第一个字节的内容，但从未成功。（请参阅下面的堆栈跟踪。）

请问有人有什么建议吗？

注意：*不*使用allowFlash（如中，设置为false）

### 正在使用的版本：

*   Richfaces 3.3.1
*   雄猫 6.0.24
*   AJP 1.3
*   爪哇 6
*   阿帕奇 2 运行`mod_jk`

### 来自调试器的堆栈跟踪：

> 守护线程 [ajp-8009-5]（暂停）
> ByteArrayOutputStream.(int) 行：60
> MultipartRequest.readHeader() 行：490 MultipartRequest.readNext() 行：427
> MultipartRequest.getParam(String) 行：807 MultipartRequest.getParameter(String ) 行：870 IdentityRequestWrapper(ServletRequestWrapper).getParameter(String) 行：158
> RequestParameterMap.getAttribute(String) 行：45
> RequestParameterMap.getAttribute(String) 行：33
> RequestParameterMap(AbstractAttributeMap).containsKey(Object) 行：59
> HtmlResponseStateManager.isPostback( FacesContext）行：212 DefaultRestoreViewSupport.isPostback（FacesContext）行：128
> RestoreViewExecutor.execute（FacesContext）行：80
> LifecycleImpl.executePhase(FacesContext, PhaseExecutor, PhaseListenerManager) line: 103 LifecycleImpl.execute(FacesContext) line: 76
> FacesServlet.service(ServletRequest, ServletResponse) line: 151 ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) line: 290
> ApplicationFilterChain.doFilter(ServletRequest, ServletResponse) 行：206
> ExtensionsFilter.doFilter(ServletRequest, ServletResponse, FilterChain) 行：190
> ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) 行：235
> ApplicationFilterChain.doFilter(ServletRequest, ServletResponse) 行：206
> CurrentSelectedTabFilter.doFilter(ServletRequest, ServletResponse, FilterChain)线路：42
> ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) line: 235
> ApplicationFilterChain.doFilter(ServletRequest, ServletResponse) line: 206
> PageLoadFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 58
> ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) line: 235
> ApplicationFilterChain.doFilter( ServletRequest, ServletResponse) 行：206
> TimeoutFilter.doFilter(ServletRequest, ServletResponse, FilterChain) 行：45
> ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) 行：235
> ApplicationFilterChain.doFilter(ServletRequest, ServletResponse) 行：206
> ResourceTrackerFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 55
> ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) line: 235
> ApplicationFilterChain.doFilter(ServletRequest, ServletResponse) line: 206
> SeamFilter$FilterChainImpl.doFilter(ServletRequest, ServletResponse) line: 83
> IdentityFilter。 doFilter(ServletRequest, ServletResponse, FilterChain) line: 40
> SeamFilter$FilterChainImpl.doFilter(ServletRequest, ServletResponse) line: 69
> MultipartFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 90 SeamFilter$FilterChainImpl.doFilter(ServletRequest, ServletResponse) line: 69
> ExceptionFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 64 SeamFilter$FilterChainImpl.doFilter(ServletRequest, ServletResponse) line: 69
> RedirectFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 45
> SeamFilter$FilterChainImpl.doFilter(ServletRequest, ServletResponse) line : 69
> ConfigurableXMLFilter(BaseXMLFilter).doXmlFilter(FilterChain, HttpServletRequest, HttpServletResponse) 行: 178
> Filter(BaseFilter).handleRequest(HttpServletRequest, HttpServletResponse, FilterChain) 行: 290
> Filter(BaseFilter).processUploadsAndHandleRequest(HttpServletRequest, HttpServletResponse, FilterChain) 行: 347
> Filter(BaseFilter).doFilter(ServletRequest, ServletResponse, FilterChain) line: 495 Ajax4jsfFilter.doFilter(ServletRequest, ServletResponse, FilterChain) line: 56
> SeamFilter$FilterChainImpl.doFilter(ServletRequest, ServletResponse) line: 69
> SeamFilter.doFilter(ServletRequest, ServletResponse, FilterChain) 行：158 ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) 行：235
> ApplicationFilterChain.doFilter(ServletRequest, ServletResponse) 行：206
> CharacterEncodingFilter.doFilterInternal(HttpServletRequest, HttpServletResponse, FilterChain) 行：96 CharacterEncodingFilter(OncePerRequestFilter).doFilter(ServletRequest, ServletResponse , FilterChain) 行: 75
> ApplicationFilterChain.internalDoFilter(ServletRequest, ServletResponse) line: 235
> ApplicationFilterChain.doFilter(ServletRequest, ServletResponse) line: 206
> StandardWrapperValve.invoke(Request, Response) line: 233
> StandardContextValve.invoke(Request, Response) line: 191
> BasicAuthenticator(AuthenticatorBase).invoke （请求，响应）行：465
> StandardHostValve.invoke（请求，响应）行：127
> ErrorReportValve.invoke（请求，响应）行：102
> AccessLogValve.invoke（请求，响应）行：555
> StandardEngineValve.invoke（请求，响应）行：109 CoyoteAdapter.service（请求，响应）行：298
> AjpAprProcessor.process(long) 行：429 AjpAprProtocol$AjpConnectionHandler.process(long) 行：384 AprEndpoint$Worker.run() 行：1555 Thread.run() 行：662

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:40:31.330

不确定您是否使用“allowFlash”选项，但您的雷达上有以下错误。我们自己遇到了。 [https://issues.jboss.org/browse/RF-5624](https://issues.jboss.org/browse/RF-5624)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-27T15:45:15.067

尝试将 Richfaces 更新到 3.3.4 [(http://downloads.jboss.org/richfaces/releases/3.3.X/3.3.4.Final/richfaces-ui-3.3.4.Final-bin.zip)](http://downloads.jboss.org/richfaces/releases/3.3.X/3.3.4.Final/richfaces-ui-3.3.4.Final-bin.zip)

我在使用 Jboss 5.1.0GA 和 Seam 2.2.0GA 的 Richfaces 3.3.1 中遇到了这个问题。更新了richfaces，现在一切都按预期工作！

希望能帮助到你

# c# - 报告有时不写入文件

> ID：15167805
> 
> 赞同：1
> 
> 时间：2013-03-01T22:16:52.563
> 
> 标签：c#, file, text

我有一个程序，我可以在其中添加汽车后备箱销售列表，并指定它们是否用于慈善等。还有一个按钮可以生成用于慈善机构和非慈善机构的汽车后备箱销售列表到不同的文本文件。当我将慈善靴销售添加到应用程序并生成列表时，它会很好地写入文件。但是，当我再次加载应用程序并尝试生成文件时，它会生成一个空白列表。（我有在退出时保存应用程序数据并在启动时重新加载数据的功能）。

我不确定为什么会发生这种情况？

这是用于生成文件列表的按钮背后的代码：

```
 List<CarBootSale> carbootsales = carBootSaleList.ReturnList();
        carbootsales.Sort(delegate(CarBootSale bs1, CarBootSale bs2)
        {
            return Comparer<string>.Default.Compare(bs1.ID, bs2.ID);
        });
        textReportGenerator.GenerateCharityReport(carbootsales, AppData.CHARITY);
        MessageBox.Show("All the Charity Car Boot Sales have been written to the report file: " + AppData.CHARITY); 
```

下面是生成报告的 TextReportGenerator 类中的代码：

```
 FileStream outFile;
        StreamWriter writer;

        //create the file and write to it
        outFile = new FileStream(filePath, FileMode.Create, FileAccess.Write);
        writer = new StreamWriter(outFile);

        //For each object in the list, add it to the file
        foreach (CarBootSale obj in CharityList)
        {
            if (obj.Charity == "true")
            {
                writer.WriteLine(obj.Display());
            }
        }
        //close the file which has been opened
        writer.Close();
        outFile.Close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:44:18.737

您的代码在很大程度上看起来不错（注意：见下文），因此如果没有整个代码在本地运行，我无法给出具体建议，除了使用`using`.

考虑使用这样的代码：

```
 using(FileStream outFile = new FileStream(filePath, FileMode.Create, FileAccess.Write))
    using(StreamWriter writer = new StreamWriter(outFile)) {

        //For each object in the list, add it to the file
        foreach (CarBootSale obj in CharityList) {
            if (obj.Charity == "true") {
                writer.WriteLine(obj.Display());
            }
        }

    } 
```

`Display`我的猜测是您的方法中有一个未处理的异常，因此您的调用`.Close`将永远不会进行，因此数据永远不会从缓冲区刷新到磁盘。使用`using`块可确保无论发生什么（异常或过早`return`），您的流缓冲区都将写入磁盘而不会丢失任何数据。

一件小事：为什么是`.Charity`字符串？为什么它不是一个`boolean`或`enum`属性？

# wpf - 如何在 wpf 中创建类似于 evernote 的标记控件？

> ID：15167809
> 
> 赞同：23
> 
> 时间：2013-03-01T22:16:58.427
> 
> 标签：wpf, controls

我喜欢 Evernote（Windows 版）中的标记控件，想知道那里是否有类似的东西？我只能找到标签云控件。

具体来说，我喜欢自由格式的输入，就像在文本框中查找并显示与我输入的内容匹配的标签的 Intellisense 样式一样。当我选择一个标签时，文本被一个代表标签的按钮替换，按钮的文本是标签文本。

**更新**：添加截图

添加新标签

![添加标签](../Images/aaf76eb0fcc36d9c17bf68a5486d3993.png)

查看现有标签并单击“x”删除标签

![显示现有标签并通过单击“x”删除](../Images/8c778d73522bd05e93924eff63db0567.png)

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-03-09T18:06:04.403

这似乎是一个非常好的练习，所以我尝试构建这个控件。我没有彻底测试它，如果你想使用它并需要进一步的帮助，请告诉我。

![在此处输入图像描述](../Images/796b20efbb8ce25d14c590ebc5487f3d.png)

![在此处输入图像描述](../Images/f3b8b55448c9bb34951bfa8db6bf814c.png)

![在此处输入图像描述](../Images/249564f9394005b1cd8d3749233eab30.png)

![在此处输入图像描述](../Images/9ebf3bcb51510a761575bd2c54a9ad31.png)

示例用法：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication1"
        xmlns:s="clr-namespace:System;assembly=mscorlib"
        Title="MainWindow" Height="350" Width="525">

    <Window.DataContext>
        <local:ViewModel />
    </Window.DataContext>

    <Grid>
        <!-- todo: implement ICommand properties on EvernoteTagControl to allow easy binding to the viewmodel. Alternatively, the user could use a behavior to handle TagClick, and if necessary TagAdded/TagRemoved -->
        <local:EvernoteTagControl ItemsSource="{Binding SelectedTags}" TagClick="TagControl_TagClick" >
            <local:EvernoteTagControl.AllTags>
                <s:String>read</s:String>
                <s:String>receipt</s:String>
                <s:String>recipe</s:String>
                <s:String>research</s:String>
                <s:String>restaurants</s:String>
            </local:EvernoteTagControl.AllTags>
        </local:EvernoteTagControl>
    </Grid>
</Window> 
```

视图模型：

```
using System.Collections.Generic;
using System.ComponentModel;

namespace WpfApplication1
{
    public class ViewModel : INotifyPropertyChanged
    {
        public event PropertyChangedEventHandler PropertyChanged;

        private List<EvernoteTagItem> _selectedTags = new List<EvernoteTagItem>();
        public List<EvernoteTagItem> SelectedTags
        {
            get { return _selectedTags; }
            set
            {
                _selectedTags = value;
                if (_selectedTags != value)
                    OnPropertyChanged("SelectedTags");
            }
        }

        public ViewModel()
        {
            this.SelectedTags = new List<EvernoteTagItem>() { new EvernoteTagItem("news"), new EvernoteTagItem("priority") };
        }

        private void OnPropertyChanged(string propertyName)
        {
            if (this.PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

印象笔记标签控件：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Windows;
using System.Windows.Controls;

namespace WpfApplication1
{
    [TemplatePart(Name = "PART_CreateTagButton", Type = typeof(Button))]
    public class EvernoteTagControl : ListBox
    {
        public event EventHandler<EvernoteTagEventArgs> TagClick;
        public event EventHandler<EvernoteTagEventArgs> TagAdded;
        public event EventHandler<EvernoteTagEventArgs> TagRemoved;

        static EvernoteTagControl()
        {
            // lookless control, get default style from generic.xaml
            DefaultStyleKeyProperty.OverrideMetadata(typeof(EvernoteTagControl), new FrameworkPropertyMetadata(typeof(EvernoteTagControl)));
        }

        public EvernoteTagControl()
        {
            //// some dummy data, this needs to be provided by user
            //this.ItemsSource = new List<EvernoteTagItem>() { new EvernoteTagItem("receipt"), new EvernoteTagItem("restaurant") };
            //this.AllTags = new List<string>() { "recipe", "red" };
        }

        // AllTags
        public List<string> AllTags { get { return (List<string>)GetValue(AllTagsProperty); } set { SetValue(AllTagsProperty, value); } }
        public static readonly DependencyProperty AllTagsProperty = DependencyProperty.Register("AllTags", typeof(List<string>), typeof(EvernoteTagControl), new PropertyMetadata(new List<string>()));

        // IsEditing, readonly
        public bool IsEditing { get { return (bool)GetValue(IsEditingProperty); } internal set { SetValue(IsEditingPropertyKey, value); } }
        private static readonly DependencyPropertyKey IsEditingPropertyKey = DependencyProperty.RegisterReadOnly("IsEditing", typeof(bool), typeof(EvernoteTagControl), new FrameworkPropertyMetadata(false));
        public static readonly DependencyProperty IsEditingProperty = IsEditingPropertyKey.DependencyProperty;

        public override void OnApplyTemplate()
        {
            Button createBtn = this.GetTemplateChild("PART_CreateTagButton") as Button;
            if (createBtn != null)
                createBtn.Click += createBtn_Click;

            base.OnApplyTemplate();
        }

        /// <summary>
        /// Executed when create new tag button is clicked.
        /// Adds an EvernoteTagItem to the collection and puts it in edit mode.
        /// </summary>
        void createBtn_Click(object sender, RoutedEventArgs e)
        {
            var newItem = new EvernoteTagItem() { IsEditing = true };
            AddTag(newItem);
            this.SelectedItem = newItem;
            this.IsEditing = true;

        }

        /// <summary>
        /// Adds a tag to the collection
        /// </summary>
        internal void AddTag(EvernoteTagItem tag)
        {
            if (this.ItemsSource == null)
                this.ItemsSource = new List<EvernoteTagItem>();

            ((IList)this.ItemsSource).Add(tag); // assume IList for convenience
            this.Items.Refresh();

            if (TagAdded != null)
                TagAdded(this, new EvernoteTagEventArgs(tag));
        }

        /// <summary>
        /// Removes a tag from the collection
        /// </summary>
        internal void RemoveTag(EvernoteTagItem tag, bool cancelEvent = false)
        {
            if (this.ItemsSource != null)
            {
                ((IList)this.ItemsSource).Remove(tag); // assume IList for convenience
                this.Items.Refresh();

                if (TagRemoved != null && !cancelEvent)
                    TagRemoved(this, new EvernoteTagEventArgs(tag));
            }
        }

        /// <summary>
        /// Raises the TagClick event
        /// </summary>
        internal void RaiseTagClick(EvernoteTagItem tag)
        {
            if (this.TagClick != null)
                TagClick(this, new EvernoteTagEventArgs(tag));
        }
    }

    public class EvernoteTagEventArgs : EventArgs
    {
        public EvernoteTagItem Item { get; set; }

        public EvernoteTagEventArgs(EvernoteTagItem item)
        {
            this.Item = item;
        }
    }
} 
```

印象笔记标签项：

```
using System.Collections;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using System.Windows.Media;

namespace WpfApplication1
{
    [TemplatePart(Name = "PART_InputBox", Type = typeof(AutoCompleteBox))]
    [TemplatePart(Name = "PART_DeleteTagButton", Type = typeof(Button))]
    [TemplatePart(Name = "PART_TagButton", Type = typeof(Button))]
    public class EvernoteTagItem : Control
    {

        static EvernoteTagItem()
        {
            // lookless control, get default style from generic.xaml
            DefaultStyleKeyProperty.OverrideMetadata(typeof(EvernoteTagItem), new FrameworkPropertyMetadata(typeof(EvernoteTagItem)));
        }

        public EvernoteTagItem() { }
        public EvernoteTagItem(string text)
            : this()
        {
            this.Text = text;
        }

        // Text
        public string Text { get { return (string)GetValue(TextProperty); } set { SetValue(TextProperty, value); } }
        public static readonly DependencyProperty TextProperty = DependencyProperty.Register("Text", typeof(string), typeof(EvernoteTagItem), new PropertyMetadata(null));

        // IsEditing, readonly
        public bool IsEditing { get { return (bool)GetValue(IsEditingProperty); } internal set { SetValue(IsEditingPropertyKey, value); } }
        private static readonly DependencyPropertyKey IsEditingPropertyKey = DependencyProperty.RegisterReadOnly("IsEditing", typeof(bool), typeof(EvernoteTagItem), new FrameworkPropertyMetadata(false));
        public static readonly DependencyProperty IsEditingProperty = IsEditingPropertyKey.DependencyProperty;

        /// <summary>
        /// Wires up delete button click and focus lost 
        /// </summary>
        public override void OnApplyTemplate()
        {
            AutoCompleteBox inputBox = this.GetTemplateChild("PART_InputBox") as AutoCompleteBox;
            if (inputBox != null)
            {
                inputBox.LostFocus += inputBox_LostFocus;
                inputBox.Loaded += inputBox_Loaded;
            }

            Button btn = this.GetTemplateChild("PART_TagButton") as Button;
            if (btn != null)
            {
                btn.Loaded += (s, e) =>
                {
                    Button b = s as Button;
                    var btnDelete = b.Template.FindName("PART_DeleteTagButton", b) as Button; // will only be found once button is loaded
                    if (btnDelete != null)
                    {
                        btnDelete.Click -= btnDelete_Click; // make sure the handler is applied just once
                        btnDelete.Click += btnDelete_Click;
                    }
                };

                btn.Click += (s, e) =>
                {
                    var parent = GetParent();
                    if (parent != null)
                        parent.RaiseTagClick(this); // raise the TagClick event of the EvernoteTagControl
                };
            }

            base.OnApplyTemplate();
        }

        /// <summary>
        /// Handles the click on the delete glyph of the tag button.
        /// Removes the tag from the collection.
        /// </summary>
        void btnDelete_Click(object sender, RoutedEventArgs e)
        {

            var item = FindUpVisualTree<EvernoteTagItem>(sender as FrameworkElement);
            var parent = GetParent();
            if (item != null && parent != null)
                parent.RemoveTag(item);

            e.Handled = true; // bubbling would raise the tag click event
        }

        /// <summary>
        /// When an AutoCompleteBox is created, set the focus to the textbox.
        /// Wire PreviewKeyDown event to handle Escape/Enter keys
        /// </summary>
        /// <remarks>AutoCompleteBox.Focus() is broken: http://stackoverflow.com/questions/3572299/autocompletebox-focus-in-wpf</remarks>
        void inputBox_Loaded(object sender, RoutedEventArgs e)
        {
            AutoCompleteBox acb = sender as AutoCompleteBox;
            if (acb != null)
            {
                var tb = acb.Template.FindName("Text", acb) as TextBox;
                if (tb != null)
                    tb.Focus();

                // PreviewKeyDown, because KeyDown does not bubble up for Enter
                acb.PreviewKeyDown += (s, e1) =>
                {
                    var parent = GetParent();
                    if (parent != null)
                    {
                        switch (e1.Key)
                        {
                            case (Key.Enter):  // accept tag
                                parent.Focus(); 
                                break;
                            case (Key.Escape): // reject tag
                                parent.Focus();
                                parent.RemoveTag(this, true); // do not raise RemoveTag event
                                break;
                        }
                    }
                };
            }
        }

        /// <summary>
        /// Set IsEditing to false when the AutoCompleteBox loses keyboard focus.
        /// This will change the template, displaying the tag as a button.
        /// </summary>
        void inputBox_LostFocus(object sender, RoutedEventArgs e)
        {
            this.IsEditing = false;
            var parent = GetParent();
            if (parent != null)
                parent.IsEditing = false;
        }

        private EvernoteTagControl GetParent()
        {
            return FindUpVisualTree<EvernoteTagControl>(this);
        }

        /// <summary>
        /// Walks up the visual tree to find object of type T, starting from initial object
        /// http://www.codeproject.com/Tips/75816/Walk-up-the-Visual-Tree
        /// </summary>
        private static T FindUpVisualTree<T>(DependencyObject initial) where T : DependencyObject
        {
            DependencyObject current = initial;
            while (current != null && current.GetType() != typeof(T))
            {
                current = VisualTreeHelper.GetParent(current);
            }
            return current as T;
        }
    }
} 
```

主题/generic.xaml：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                            xmlns:local="clr-namespace:WpfApplication1"
                            xmlns:tkInput="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Input.Toolkit">

    <SolidColorBrush x:Key="HighlightBrush" Color="DodgerBlue" />

    <!-- EvernoteTagControl default style -->
    <Style TargetType="{x:Type local:EvernoteTagControl}">
        <Style.Resources>
            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="White"/>
            <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="White" />
            <LinearGradientBrush x:Key="IconBrush" EndPoint="0,1">
                <GradientStop Color="#5890f0" Offset="0" />
                <GradientStop Color="#0351d7" Offset="1" />
            </LinearGradientBrush>
        </Style.Resources>
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="VerticalAlignment" Value="Top" />
        <Setter Property="Margin" Value="5" />
        <Setter Property="MinHeight" Value="25" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:EvernoteTagControl}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Path Grid.Column="0" Margin="2" Fill="{StaticResource IconBrush}" Height="19" Stretch="Uniform" Data="M 50.535714,0.44196425 0.00446427,34.754464 l 0,106.906246 100.71874573,0 0,-107.124996 L 50.535714,0.44196425 z m 0.1875,21.21874975 c 6.311826,0 11.40625,5.094424 11.40625,11.40625 0,6.311826 -5.094424,11.4375 -11.40625,11.4375 -6.311826,0 -11.4375,-5.125674 -11.4375,-11.4375 0,-6.311826 5.125674,-11.40625 11.4375,-11.40625 z" />
                        <ItemsPresenter Grid.Column="1"  />
                        <Button Margin="5,0,0,0" Grid.Column="2" Content="Click to add tag..." x:Name="PART_CreateTagButton">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <ContentPresenter TextElement.Foreground="#FF555555" VerticalAlignment="Center" />
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Cursor" Value="Hand" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEditing" Value="True">
                            <Setter TargetName="PART_CreateTagButton" Property="Visibility" Value="Collapsed" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemContainerStyle">
            <Setter.Value>
                <Style TargetType="{x:Type ListBoxItem}">
                    <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                </Style>
            </Setter.Value>
        </Setter>
        <Setter Property="ItemsPanel" >
            <Setter.Value>
                <ItemsPanelTemplate>
                    <StackPanel Orientation="Horizontal" />
                </ItemsPanelTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- EvernoteTagItem default style -->
    <Style TargetType="{x:Type local:EvernoteTagItem}">
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="MinWidth" Value="50" />
        <Setter Property="Margin" Value="0,0,2,0" />
        <Setter Property="Padding" Value="5,2,0,2" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:EvernoteTagItem}">
                    <Button x:Name="PART_TagButton" Content="{TemplateBinding Text}" Margin="{TemplateBinding Margin}" Padding="{TemplateBinding Padding}">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Margin="{TemplateBinding Margin}" Padding="{TemplateBinding Padding}" BorderBrush="Gray" BorderThickness="1" CornerRadius="2" Background="#01FFFFFF">
                                    <Grid >
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <ContentPresenter VerticalAlignment="Center" HorizontalAlignment="Left" Margin="0,0,0,2" />
                                        <Button x:Name="PART_DeleteTagButton" Grid.Column="1"  Margin="3,0" VerticalAlignment="Center" HorizontalAlignment="Right" Visibility="Hidden"  >
                                            <Button.Template>
                                                <ControlTemplate>
                                                    <Grid Height="10" Width="10" Background="#01FFFFFF" >
                                                        <Path Stretch="Uniform" ClipToBounds="True" Stroke="{StaticResource HighlightBrush}" StrokeThickness="2" Data="M 85.364473,6.9977109 6.0640998,86.29808 6.5333398,85.76586 M 6.9926698,7.4977169 86.293043,86.79809 85.760823,86.32885"  />
                                                    </Grid>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                    </Grid>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Foreground" Value="{StaticResource HighlightBrush}" />
                                        <Setter TargetName="PART_DeleteTagButton" Property="Visibility" Value="Visible" />
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsEditing" Value="True">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type local:EvernoteTagItem}">
                            <tkInput:AutoCompleteBox x:Name="PART_InputBox"
                                                             Text="{Binding Text, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}" 
                                                             ItemsSource="{Binding AllTags, RelativeSource={RelativeSource AncestorType={x:Type local:EvernoteTagControl}}}"
                                                             IsTextCompletionEnabled="True"
                                                             />
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-06T18:58:54.910

以下是我将如何创建此控件。

## 高级概述：

此控件将包含以下主要组件：(1)`AutoCompleteTextBox`或`AutoCompleteComboBox`(2) 您描述的“按钮”控件 (3) 用于保存应用标签的 UI 集合。保存应用标签的`AutoCompleteTextBox`集合将提前放置在您选择的布局容器中。

首先，我们可以利用`AutoCompleteTextBox`or`AutoCompleteComboBox`在用户键入时为我们提供 Intellisense 样式的选项。接下来，我们“监听”用户从下拉列表中选择呈现的标签并动态创建一个新的“按钮”控件（我们可以提前为其创建一个 UserControl/CustomControl，但我们需要“新建”至少一个）。“按钮”的文本将包含`AutoCompleteTextBox`. 最后，我们将新的“按钮”插入到包含所有当前应用标签的 ListBox（或其他相关的 UI 集合类型）中。

## 细节：

那里有一些`AutoCompleteTextBox`控件，但我将描述如何使用[**这个 CodeProject one**](http://wpfactb.codeplex.com/releases/view/42340)。此示例项目展示了如何使用常规`TextBox`、an`AutoCompleteComboBox`或`AutoCompleteTextBox`来实现智能感知样式选项。该项目的核心部分实际上是`AutoCompleteManager`和一个 DataProvider，类型为`IAutoCompleteDataProvider`，以及`IAutoAppendDataProvider`.

在描述更多细节之前，这里是这个控件的一些截图`AutoCompleteTextBox`（注意我使用的 ListBoxItems 的样式与原始作者提供的样式不同）。这个控件的`AutoAppend`属性是一个很好的接触（在这个例子中它是打开的，所以在我开始输入当前匹配后自动为我“完成”我的话）。只输入一个“I”后：

![在第一次输入一个字母之后。](../Images/53a6e8cdf6c88a9fb375d9bca4038c82.png)

将鼠标悬停在“印第安纳州”上后：

![鼠标悬停后](../Images/0a5e58c5aaaf74839aa26f4e2096641c.png)

点击“印第安纳州”后：

![点击后](../Images/1e2789142f735b756ab25886d3a5d38f.png)

由于该项目中的代码为我们处理下拉选项，因此我们现在需要“监听”用户何时从下拉列表中选择项目并相应地创建新的“按钮”控件。我正在考虑我们需要处理 的**两个主要案例。**

**第一种情况**是用户用鼠标从列表中选择一个项目。为了处理这个问题，我们可以在451 行的`MouseLeftButtonUp`处理程序中插入代码来创建新的“按钮”控件：`AutoCompleteManager.cs`

```
 private void ListBox_MouseLeftButtonUp(object sender, MouseButtonEventArgs e)
    {
        ListBoxItem item = null;
        var d = e.OriginalSource as DependencyObject;
        while (d != null)
        {
            if (d is ListBoxItem)
            {
                item = d as ListBoxItem;
                break;
            }
            d = VisualTreeHelper.GetParent(d);
        }
        if (item != null)
        {
            _popup.IsOpen = false;
            UpdateText(item.Content as string, true);

            // User has selected an item with the mouse... 
            //  ** Add your new code HERE... something like:
            // 
            // TagButton tagButton = new TagButton(_textBox.Text); // _textBox is the TextBox to which the AutoCompleteManager has been applied
            // _autoCompleteTagControl.TagContainer.Add(tagButton); // _autoCompleteTagControl would be the control that we're making... it contains out other controls - I'm assuming we've passed it in or made it available.
        }
    } 
```

**第二种情况**是用户通过按回车键从列表中选择一个项目。为了处理这个问题，我们可以在291 行附近的`TextBox_PreviewKeyDown`处理程序中插入类似的新代码：`AutoCompleteManager.cs`

```
 private void TextBox_PreviewKeyDown(object sender, KeyEventArgs e)
    {
        _supressAutoAppend = e.Key == Key.Delete || e.Key == Key.Back;
        if (!_popup.IsOpen)
        {
            return;
        }
        if (e.Key == Key.Enter)
        {
            _popup.IsOpen = false;
            _textBox.SelectAll();

            // User has selected an item by hitting the enter key...
            //  ** Add your new code HERE to create new TagButton, etc.
        }
        // ...
     } 
```

## 精美印刷细节

如果您决定使用`AutoCompleteTextBox`我提到的 CodeProject 中的，您可能需要应用几个修复程序。在将所有内容导入一个更大的项目后，我遇到了两件小事（仅在运行包含的示例项目时没有发生）。第一个是这个绑定错误：

```
System.Windows.Data Error: 4 : Cannot find source for binding with reference 'RelativeSource FindAncestor, AncestorType='System.Windows.Controls.ItemsControl', AncestorLevel='1''. BindingExpression:Path=HorizontalContentAlignment; DataItem=null; target element is 'ListBoxItem' (Name=''); target property is 'HorizontalContentAlignment' (type 'HorizontalAlignment') 
```

其他人在使用 ListBoxes 时遇到过这个问题，**[在此处](https://stackoverflow.com/questions/160391/listbox-with-grid-as-itemspaneltemplate-produces-weird-binding-errors?answertab=votes#tab-top)**进行了描述。正如该帖子的答案之一所暗示的那样，我能够在我的 Style 中包含 Horizo​​ntalContentAligment 和 VerticalContentAlignment 的显式样式设置来解决这个问题。

第二个问题发生在`AutoCompleteTextBox`包含标签的应用程序中。当您在 TabControl 中有控件时，嵌套控件将经常引发其 Loaded 事件 - 每次单击包含该控件的选项卡时至少触发一次。这导致对该方法的意外额外调用`AutoCompleteManager's AttachTextBox()`，导致`debug.Assert()`失败并发生异常（原作者假设 Loaded 事件只会引发一次）。到目前为止，我需要做的唯一修复就是在`AutoCompeteTextBox.cs`. 我刚刚添加了一个`_isInitialized`标志以确保`AttachTextBox`只被调用一次：

```
 void AutoCompleteTextBox_Loaded(object sender, RoutedEventArgs e)
    {
        if (! _isInitialized)
        {
            _acm.AttachTextBox(this);
            _isInitialized = true;
        }
    } 
```

使用这种方法应该允许您创建一个行为类似于您所描述的控件。

# sql-server - DbGeography.PointFromText 24141：位置应有一个数字

> ID：15167810
> 
> 赞同：9
> 
> 时间：2013-03-01T22:17:01.417
> 
> 标签：sql-server, entity-framework-5, .net-4.5, spatial

我有 WCF REST 服务，其中包含以下代码

```
var geo = DbGeography.PointFromText(string.Format("POINT({0} {1})", longitude, latitude), DbGeography.DefaultCoordinateSystemId); 
```

**单元测试工作正常**，但是当我从客户端或 HTTP 调试器调用此代码提供任何纬度和经度值除零时，它会失败并出现异常：

```
"24141: A number is expected at position X of the input. The input has ,XXXXXX."
   at Microsoft.SqlServer.Types.WellKnownTextReader.RecognizeDouble()
   at Microsoft.SqlServer.Types.WellKnownTextReader.ParsePointText(Boolean parseParentheses)
   at Microsoft.SqlServer.Types.WellKnownTextReader.ParseTaggedText(OpenGisType type)
   at Microsoft.SqlServer.Types.WellKnownTextReader.Read(OpenGisType type, Int32 srid)
   at Microsoft.SqlServer.Types.SqlGeography.ParseText(OpenGisType type, SqlChars taggedText, Int32 srid)
   at Microsoft.SqlServer.Types.SqlGeography.GeographyFromText(OpenGisType type, SqlChars taggedText, Int32 srid)
   at Microsoft.SqlServer.Types.SqlGeography.STPointFromText(SqlChars pointTaggedText, Int32 srid) 
```

纬度和经度例如
lat:37.58336895 long:-122.40549454
lat:37.38931302 long:-122.16207476

我使用从 SQLServer 安装目录和 SqlGeography.Point 引用的 Microsoft.SqlServer.Types 来处理代码端的部分数据。现在我想直接使用 EF 5 功能而不使用对 Microsoft.SqlServer.Types 的引用。无论有没有这个参考，它都会失败。

知道有什么问题吗？

已安装 .NET 4.5，SQL Server 版本为 Microsoft SQL Server 2008 (SP3) - 10.0.5500.0 (Intel X86) Sep 22 2011 00:28:06 版权所有 (c) 1988-2008 Microsoft Corporation Standard Edition on Windows NT 6.1（Build 7601 : 服务包 1)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-10-21T16:27:11.013

您必须在连接之前使用 invariantCulture 转换坐标。

```
 String lon = longitude.ToString(CultureInfo.InvariantCulture);
  String lat = latitude.ToString(CultureInfo.InvariantCulture);
  var geo = DbGeography.PointFromText(string.Format("POINT({0} {1})", lon, lat), DbGeography.DefaultCoordinateSystemId); 
```

# mysql - MySQL进程运行时间长，服务器爬慢，如何调试

> ID：15167812
> 
> 赞同：1
> 
> 时间：2013-03-01T22:17:06.353
> 
> 标签：mysql, linux

我工作的一个系统今天早上完全崩溃了。

我跑了 ps -eh 看看是否能找到任何东西，并且有一个 mysql 进程已经运行了超过 46 分钟。

我重新启动了 MySQL，一切都恢复正常，运行正常。

现在我正在密切关注打开的进程，我看到 MySQL 再次及时爬升......每次我刷新时都会增加几秒钟，例如一个小时前它说它已经运行了19 秒，每隔几分钟我刷新一次，然后还有一秒……现在最多大约 50 秒。每次我运行 ps -eh 时，它都会持续高出一两秒。

我运行了 mysql > SHOW PROCESSLIST 并且出现的唯一进程是 SHOW PROCESSLIST 进程......所以我认为没有任何查询挂起，但我不知道。

有人对我如何调试此问题有任何提示吗？这是在 GoDaddy VDS (CentOS) 系统上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:19:32.500

您可能需要查看慢查询日志以捕获减慢盒子的查询。 [http://dev.mysql.com/doc/refman/5.0/en/slow-query-log.html](http://dev.mysql.com/doc/refman/5.0/en/slow-query-log.html)

# oop - Lua 和对象生成

> ID：15167813
> 
> 赞同：2
> 
> 时间：2013-03-01T22:17:09.420
> 
> 标签：oop, lua

我的直觉告诉我，我犯了一个明显的错误，但它正在逃避我。我正在尝试使用以下示例代码从指定的“父”对象创建“子”对象。

```
local Ad = {
    __index = Ad,
    __tostring = function(self) return self.msg end,
    __concat = function(a, b) return tostring(a)..tostring(b) end,
    Initialize = function(self, msg, wgt)
        if msg and msg ~= "" then
            wgt = wgt or 1
            self.msg, self.wgt, self.ranLog = msg, wgt, {}
        end
    end,
    Increase = function(self)
        if self.wgt < 9 then self.wgt = self.wgt + 1 end
    end,
    Decrease = function(self)
        if self.wgt > 1 then self.wgt = self.wgt - 1 end
    end
}

local function new(src, ...)
    local o = setmetatable({}, src)
    if src.Initialize then o:Initialize(...) end
    return o
end

local ad = new(Ad, "Test Message")
print("Object - "..ad)
for k, v in pairs(ad) do print("", k, v) end
ad:Increase()
print("Modified Object - "..ad)
for k, v in pairs(ad) do print("", k, v) end 
```

所以这就是尝试调用方法 Initialize 失败的原因，该方法是一个 nil 值。鉴于在此编辑之前我的示例代码确实有效，是否与表 Ad 的定义方式有关？或者我在这里的某个地方有语法错误？

*   编辑以用失败的实际代码替换代码片段

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T01:12:51.463

问题是这样的：

```
local Ad = {
    __index = Ad,
    ...
} 
```

在`__index`被赋值的时候，`Ad`是`nil`，因为表是在被赋值之前完整构造的`Ad`。由于`__index`未设置，因此查找`Initialize`失败。

相反，请执行以下操作：

```
local Ad = {
    ...
}
Ad.__index = Ad 
```

# javascript - 使用 `find()` 并选择父元素

> ID：15167815
> 
> 赞同：1
> 
> 时间：2013-03-01T22:17:13.067
> 
> 标签：javascript, jquery

一段时间以来，我一直在尝试创建高光效果。这与我需要的非常接近，但是这种方法的问题是它遗漏了最里面的父元素。

我需要的是与下面的 JQuery 代码产生的完全相同的功能，唯一的区别是，我也想包括最里面的父对象。Using`find`查找父对象的所有子对象，这不是我所需要的。

## **编辑**

我基本上需要这两个语句的组合：

```
$last.parent().parent().find('*').effect("highlight", {color: '#FCF8DC'}, 2000); 
$last.parent().parent().effect("highlight", {color: '#FCF8DC'}, 2000); 
```

HTML

```
<div class="invoice-line">
    <div class="prod-id-cell"><input type="text" class="prod-id-input"></div>
    <div class="prod-name-cell"><input type="text"class="prod-name-input"/></div>
</div> 
```

我感谢任何帮助实现这一点。

提前谢谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:19:56.090

使用[`.addBack`](http://api.jquery.com/addBack/)：

```
$last.parent().parent().find('*').addBack().effect(...) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:20:06.857

您可以使用`.addBack()`：

```
$last.parent().parent().find('*').addBack().effect("highlight", {color: '#FCF8DC'}, 2000); 
```

# jquery - jquery不会在点击功能上将类更改为不可见

> ID：15167824
> 
> 赞同：1
> 
> 时间：2013-03-01T22:18:23.923
> 
> 标签：jquery, asp.net

我的网页中有一个部分将显示公司的股票报价、历史图表或最新的新闻稿。aspx 标记如下所示，为简洁起见，删除了一些标记。

```
<div id="StockQuote" class="invisible">
        <asp:UpdatePanel ID="updplStockQuote" runat="server">
            <ContentTemplate>                  
                <span class="stockpricefont"><i>Last Sale:</i><b id="lastsale" runat="server"></b></span>
                     &nbsp;<asp:Image ID="imgNetChangeArrow" runat="server" /><span class="otherstockinfofont"><b id="netchange" runat="server"></b></span>
                            <span class="stockpricefont"><i>Market Cap:</i></span><span class="otherstockinfofont"><b id="marketcap" runat="server"></b></span><br />
                <span class="otherstockinfofont2"><i>Net Change(%):</i>&nbsp;<asp:Image ID="imgNetChgPctArrow" runat="server" /> <b id="netchangepct" runat="server"> </b></span><br />
                <span class="otherstockinfofont2"><i>Open:</i><b id="priceopen" runat="server"></b></span><br />
                <span class="otherstockinfofont2"><i>High:</i><b id="pricehigh" runat="server"></b></span><br />
                <span class="otherstockinfofont2"><i>Low:</i><b id="pricelow" runat="server"></b></span><br />
                <span class="otherstockinfofont2"><i>Volume:</i><b id="pricevolume" runat="server"></b></span><br />
                <span class="otherstockinfofont2"><i>Prior Close:</i><b id="pricepriorclose" runat="server"></b></span><br />

            </ContentTemplate>
            <Triggers>
               <%-- <asp:AsyncPostBackTrigger/>--%>
            </Triggers>
        </asp:UpdatePanel>
    </div>

    <div id="StockChart" class="visible">
        <asp:UpdatePanel ID="updpnlStockChart" runat="server">
            <ContentTemplate>
                <%-- All the asp chart code is here--%>
            </ContentTemplate>
            <Triggers>
                <asp:AsyncPostBackTrigger ControlID="ddlChartTimeFrame" EventName="SelectedIndexChanged"/>
            </Triggers>
        </asp:UpdatePanel>
    </div> 
```

这是脚本

```
 <script>
    $(function () {
        function aTagClick(event) {
            if ($(this).text() === "Stock Quote") {
                if ($('#StockQuote').hasClass('invisible')) {
                    $('#StockChart').toggleClass('invisible');
                    $('#StockQuote').toggleClass('visible');           

                } 
            } else if ($(this).text() === "Stock Chart") {
                if ($('#StockChart').hasClass('invisible')) {
                    $('#StockChart').toggleClass('visible');
                    $('#StockQuote').toggleClass('invisible');
                }
            }}           
        $('#a_stockqoute').click(aTagClick);
        $('#a_stockchart').click(aTagClick);
        $('#a_latestnews').click(aTagClick);
    }); 
```

这是CSS

.invisible { 显示：无；} .visible { 显示：块；}

页面打开，图表可见。如果我点击股票报价标签，报价会显示，但图表 div 不会像它应该的那样变得不可见。我错过了什么？单击股票图表标签现在将使图表消失。我对 jquery 有点陌生，但无法弄清楚为什么会这样

工作脚本

```
 function aTagClick(event) {
            if ($(this).text() === "Stock Quote") {
                if ($('#StockQuote').css('display') == 'none') {
                    $('#StockChart').hide();
                    $('#StockQuote').show();
                }
            } else if ($(this).text() === "Stock Chart") {
                if ($('#StockChart').css('display') == 'none') {
                    $('#StockChart').show();
                    $('#StockQuote').hide();
                }
            }} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:38:31.797

看着这个：

```
if ($('#StockQuote').hasClass('invisible')) {
    $('#StockChart').toggleClass('invisible');
    $('#StockQuote').toggleClass('visible');
} 
```

我觉得我更喜欢它看起来像：

```
if ($('#StockQuote').css('display')=='none') {
    $('#StockChart').hide();
    $('#StockQuote').show();
} 
```

不过，我需要查看 JSFiddle 才能确定。

//追赶。

## 编辑以回应非常甜蜜的 Mangotastic

我认为这里的整个 JavaScript 代码可以缩短为：

```
$(function () {        
    $('#a_stockquote,a_stockchart').click(function(){ 
        $('#StockQuote,#StockChart').toggle(); 
    });
}); 
```

***`#a_stockqoute`注意：我修复了to的拼写`#a_stockquote`。***

同样，我需要一个 JSFiddle 来确定。

***//追赶。***

# c#-4.0 - datagridview AutoResizeRow 函数，但用于单行

> ID：15167833
> 
> 赞同：0
> 
> 时间：2013-03-01T22:19:27.253
> 
> 标签：c#-4.0, datagridview

在我当前的网格中，我有 datagridview AutoResizeRow = true ，它看起来不错。网格只有两列：第一列是 CheckBoxColumn，第二列是 TextBoxColumn。文本框中具有长字符串文本的行会自动增长以显示多行，而具有短字符串的行看起来很好（显示单个高度行的大小）。

我需要的是当用户点击单元格时只允许单元格展开（当它们有长的数据字符串时），然后当用户点击另一个单元格或移开时折叠到单个行高大小控制。因此，仅在用户单击单元格时展开以显示多行。

这可以做到吗？如果是这样，您能否提供 C# 中的示例代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:49:38.123

请查看本次活动

```
private void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
{
dataGridView1.Rows[e.RowIndex].Visible = false;
} 
```

# c++ - C++ 2005 和 2010 的 Visual Studio 安装程序依赖项

> ID：15167837
> 
> 赞同：1
> 
> 时间：2013-03-01T22:19:46.913
> 
> 标签：c++, visual-studio-2010, installation, redistributable

我是 Visual Studio 的新手，请见谅。我一直在使用 Openwebkit sharp 处理 Visual Studio 2010 项目。在我的机器上部署它时，一切都很好。但是，我发现 Openwebkit sharp 依赖于“Microsoft Visual C++ 2005 redistributable 8.0.61001”和“Microsoft Visual C++ 2010 redistributable”。我正在使用 Visual Studio 安装程序进行安装。安装程序检查对我的主项目的依赖关系，并在安装程序上添加一个检查器，以查看它是否安装在目标计算机上并且它确实这样做了。但是，它没有找到任何 C++ 依赖项。在先决条件中，我勾选了它以添加 Visual C++ 2010 运行时库 (x86)。然而，在安装过程中，我从来没有得到任何迹象表明它甚至会检查这些，我什至认为这是正确的依赖项。在启动条件中，我尝试让它检查 GUID 并弹出一个弹出窗口。这似乎一开始有效，并抛出一个弹出窗口，说您必须安装此软件包并停止安装。但是，一旦您安装了该软件包并再次点击安装程序，检查器会说仍未找到并抛出相同的弹出窗口。我已经查看了注册表启动条件，但仍然有同样的问题。我遇到的一个问题是“Microsoft Visual C++ 2005 redistributable 8.0.61001”只能在 MFC 可再发行组件中找到。我已经考虑将 Microsoft Visual C++ 2010 可再发行组件添加为合并模块，但在安装过程中我从未真正安装它。我在 MSDN 网站上花了几个小时，但似乎从那里出来的时候比我进去时更困惑。这似乎一开始有效，并抛出一个弹出窗口，说您必须安装此软件包并停止安装。但是，一旦您安装了该软件包并再次点击安装程序，检查器会说仍未找到并抛出相同的弹出窗口。我已经查看了注册表启动条件，但仍然有同样的问题。我遇到的一个问题是“Microsoft Visual C++ 2005 redistributable 8.0.61001”只能在 MFC 可再发行组件中找到。我已经考虑将 Microsoft Visual C++ 2010 可再发行组件添加为合并模块，但在安装过程中我从未真正安装它。我在 MSDN 网站上花了几个小时，但似乎从那里出来的时候比我进去时更困惑。这似乎一开始有效，并抛出一个弹出窗口，说您必须安装此软件包并停止安装。但是，一旦您安装了该软件包并再次点击安装程序，检查器会说仍未找到并抛出相同的弹出窗口。我已经查看了注册表启动条件，但仍然有同样的问题。我遇到的一个问题是“Microsoft Visual C++ 2005 redistributable 8.0.61001”只能在 MFC 可再发行组件中找到。我已经考虑将 Microsoft Visual C++ 2010 可再发行组件添加为合并模块，但在安装过程中我从未真正安装它。我在 MSDN 网站上花了几个小时，但似乎从那里出来的时候比我进去时更困惑。但是，一旦您安装了该软件包并再次点击安装程序，检查器会说仍未找到并抛出相同的弹出窗口。我已经查看了注册表启动条件，但仍然有同样的问题。我遇到的一个问题是“Microsoft Visual C++ 2005 redistributable 8.0.61001”只能在 MFC 可再发行组件中找到。我已经考虑将 Microsoft Visual C++ 2010 可再发行组件添加为合并模块，但在安装过程中我从未真正安装它。我在 MSDN 网站上花了几个小时，但似乎从那里出来的时候比我进去时更困惑。但是，一旦您安装了该软件包并再次点击安装程序，检查器会说仍未找到并抛出相同的弹出窗口。我已经查看了注册表启动条件，但仍然有同样的问题。我遇到的一个问题是“Microsoft Visual C++ 2005 redistributable 8.0.61001”只能在 MFC 可再发行组件中找到。我已经考虑将 Microsoft Visual C++ 2010 可再发行组件添加为合并模块，但在安装过程中我从未真正安装它。我在 MSDN 网站上花了几个小时，但似乎从那里出来的时候比我进去时更困惑。我已经考虑将 Microsoft Visual C++ 2010 可再发行组件添加为合并模块，但在安装过程中我从未真正安装它。我在 MSDN 网站上花了几个小时，但似乎从那里出来的时候比我进去时更困惑。我已经考虑将 Microsoft Visual C++ 2010 可再发行组件添加为合并模块，但在安装过程中我从未真正安装它。我在 MSDN 网站上花了几个小时，但似乎从那里出来的时候比我进去时更困惑。

您能给我的任何帮助将不胜感激？特别是如果您知道有关如何让安装程序搜索注册表以查看这些项目是否已安装或如何将 C++ 添加到我的资源以便 Windows 安装程序找到依赖项并自行添加它们的视频教程。谢谢史蒂夫

# jquery - jquery alert 说未定义

> ID：15167838
> 
> 赞同：0
> 
> 时间：2013-03-01T22:19:54.270
> 
> 标签：jquery, alert

嗨，我正在尝试让警报方法显示值 c8，但它只是说未定义。

我是 html 和 jquery 的新手；这很简单，但我就是看不到。

```
<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src="jquery/jquery-1.7.1.js"></script>
    <script>
      $(document).ready(function(){
        $("button").click(function(){
      //$("#div1").load("hs.php");
      //$("#div1").load("http://127.0.0.1:81/tenHsServer/tenHsServer.aspx?t=ab&f=DeviceStatus&d=A1");
        $("#div1").load("http://127.0.0.1:81/tenHsServer/tenHsServer.aspx?t=ab&f=ToggleDevice&d=c8");
        alert($(this).prev().attr(".class"));
       });
      });
    </script>
  </head>
  <body>
    <div id="div1"><h2>Let jQuery AJAX Change This Text</h2></div>
    <span class='c8'><button>Get External Content</button></span>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:25:10.313

因为 prev() 仅适用于兄弟姐妹。你的按钮是那个 div 的子元素。

你该走了：

```
alert($(this).parent().attr("class")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:25:29.843

该按钮没有兄弟姐妹`.prev()`用于选择前一个兄弟姐妹，您要定位的元素是其父元素，因此用于`.parent()`选择它。`.`此外，当它是选择器的一部分时，您只能在类前面加上一个点 ( )。

```
alert($(this).parent().attr("class")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T22:21:50.270

您不需要属性名称前的点：

```
alert($(this).prev().attr("class")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T22:21:59.460

虽然在 jQuery 中`.`引入了*类选择器*，但在这种情况下，您只需要一个名为“class”的属性。

删除`.`in `.class`：

```
alert($(this).prev().attr("class")); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T22:22:25.253

您应该`.attr("class")`改用（不带`.`）

# perl - Perl中的重命名/移动函数不给出结果

> ID：15167844
> 
> 赞同：1
> 
> 时间：2013-03-01T22:20:13.973
> 
> 标签：perl, rename, move

我有一个文件，我需要将其移动到特定文件夹并在执行此操作时重命名。

```
use File::Copy "move";
print rename('D:\\Test\\Input\\temp.cxx','D:\\Test\\Input\\new.cxx'), die $! ; 
```

但这给了我一个错误，说“D:\Test\Test.pl 第 35 行，第 5899 行的权限被拒绝”。我以管理员身份运行。甚至所有文件夹都具有完全权限。

**更新** 它现在正在工作。我在这一行之前的一行打开了一个文件。一旦我关闭它，重命名就可以了。但是，如果我将路径存储在变量中，它会再次给我同样的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T22:37:58.253

你在这里有几个问题。

首先，您正在使用 File::Copy 但不使用其中的任何内容。该`rename`函数是核心 Perl 的一部分。

其次，您正在打印`rename`可能没有意义的返回值。它返回一个真或假值。

第三，无论移动的返回状态如何，你总是在`die`ing。

第四，所有这些反斜杠都容易出错。

我认为您可能想要的更像是这样的：

```
rename('D:/Test/Input/temp.cxx','D:/Test/Input/new.cxx') or die "Unable to rename: $!"; 
```

这可能有助于暴露您的权限问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T23:23:49.607

正如安迪所说，在您的示例中不需要 File::Copy，除非您在其他地方使用“移动”？以下在我的带有 Activestate Perl 5.14.2 的 Win7 机器上完美运行：

```
use strict;
use warnings;
rename "C:\\Users\\JLBlack\\test.txt", "C:\\Users\\JLBlack\\test.new" or die "rename failed because: $!\n";
exit(); 
```

你确定目的地不存在吗？而且它没有被其他任何东西打开/使用？您可以从 Windows 命令提示符移动文件吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-13T14:16:00.400

我的问题是我在新文件名中有一个冒号。这在 Windows 上是被禁止的，但 Windows 通常会告诉你这一点。如果您的界面类似于 Perl，显然所有通过的都是“权限被拒绝”。

# ember.js - 确定 Handlebars 助手是否被称为块而不是内联

> ID：15167847
> 
> 赞同：1
> 
> 时间：2013-03-01T22:20:33.877
> 
> 标签：ember.js

我有一个助手，我想同时使用内联和块。我只需要确定一个块是否被传递，看看它应该做什么。我在注册的辅助函数范围内看不到任何似乎有帮助的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:57:38.647

检查是否`fn`存在`options`将判断是否通过了块：

```
!!(options.fn) 
```

# php - 在 Magento 订单中设置运输公司和方法

> ID：15167850
> 
> 赞同：1
> 
> 时间：2013-03-01T22:21:22.067
> 
> 标签：php, magento, zend-framework

我正在尝试批量更新订单以为每个订单创建一个发货/跟踪号。我的票据工作得很好——它将它们标记为已发货、分配跟踪号等。但是，我不知道如何分配新的货运承运人名称，或者我什至在哪里可以找到它！例如，如果他们使用 UPS 发货，我需要将 UPS 设置为承运人。我可以通过订单 ID 完全访问订单。

```
$order = Mage::getModel('sales/order')->loadByIncrementId($order_id);

$shipment->register();
$order->setIsInProcess(true);

$tracking = Mage::getModel('sales/order_shipment_track')
    ->setCarrierCode(NEED CARRIER HERE)
    ->setTitle($order->getShippingDescription())
    ->setNumber($tracking_number);

$shipment->addTrack($tracking);

$transactionSave = Mage::getModel('core/resource_transaction')
    ->addObject($shipment)
    ->addObject($shipment->getOrder())
    ->save();

$shipment->sendEmail(true); 
```

谁能发现我哪里出错了？或者指出我正确的方向？

# search - 递归使用 grep

> ID：15167854
> 
> 赞同：11
> 
> 时间：2013-03-01T22:21:40.347
> 
> 标签：search, full-text-search, grep, cygwin

grep 可以使用该`-r`选项进行递归搜索。但是，我想知道 grep 是否能够递归地搜索指定数量的子文件夹级别的查询字符串。例如，我有一个文件夹`root`，其中包含文件夹`parent1, parent2, ..., parentN`。每个父文件夹都有普通的文本文件和名为`child1, child2, ..., childM`. 我想从根级别运行 grep 并在父母内部的文件中搜索而不查看子文件夹。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-04T15:42:16.300

正如[肯特](https://stackoverflow.com/users/164835/kent) [所说](https://stackoverflow.com/a/15167957/220155)，你不能用顺子做到这一点`grep`；它根本不够强大。诀窍是用来`find`确定要搜索的文件，并将`find`生成的文件列表传递给`grep`.

如果你运行`man find`，你会得到一个包含*许多*选项的手册页`find`。我们在这里感兴趣的是`-maxdepth`.

让我们建立我们需要的命令。在每个阶段运行命令以查看它的外观：

*   `find .`将列出当前文件夹 ( `.`) 或任何后代文件夹中存在的所有文件和文件夹。

*   `find . -maxdepth 1`将列出当前文件夹中的所有文件和文件夹。`find . -maxdepth 2`同样会列出当前文件夹中的所有文件和文件夹以及任何直接子文件夹。等等……</p>

*   请注意，我们也列出了文件夹；我们不希望这样，因为`grep`无法搜索文件夹本身，只能搜索文件夹中的文件。添加`-type f`以仅获取列出的文件：`find . -maxdepth 2 -type f`.

现在我们知道了要搜索的文件，我们需要`grep`搜索这些文件。执行此操作的标准方法是使用`xargs`：

```
find . -maxdepth 2 -type f | xargs grep <text-to-search-for> 
```

从（即您通常在屏幕上看到的内容）获取“标准输出”，又名“stdout”，并将其通过管道传输到的`|`“标准输入”，即“stdin”，即，如果您在运行时键入通常会发生什么程序。`find``xarg`

`xargs`是一个狡猾的小程序`grep <text-to-search-for>`，在添加它在标准输入上收到的所有参数之后，它运行你告诉它的任何东西（这里，）。结果是`grep`它将搜索找到的每个文件`find`。

但是，如果您的某些文件名中有空格，这将不起作用，因为`xargs`认为空格分隔两个不同的文件名，而不是一个文件名的一部分。有很多方法可以处理这个问题（理想的方法是不要在文件名中使用空格），最常见的方法是使用`find`.

如果您向 中添加`-exec`参数`find`，它将执行您指定的所有内容，直到 a`;`或`+`。如果您添加一个`{}`（即文字字符`{`和`}`），它将用所有文件的列表替换它。由于`find`这样做，它知道文件名中的空格应该在文件名中。

因此，做你想做的事情的最好方法是：

```
find . -type f -maxdepth 2 -exec grep <text-to-search-for> {} + 
```

(The difference between ending with `+` and `;` makes no difference here. If you're interested it's in `man find`, but the short version is that `+` is faster but means you can only have one `{}` in the command.)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-01T22:30:55.547

你可以试试这些：

**grep**：

```
 --exclude=GLOB
              Skip files whose base name matches GLOB  (using
              wildcard  matching).   A file-name  glob  can  use *,
              ?, and [...]  as wildcards, and \ to quote a wildcard
              or backslash character literally.

       --exclude-from=FILE
              Skip files whose base name matches any of the file-name
              globs  read  from FILE (using wildcard matching as
              described under --exclude).

       --exclude-dir=DIR
              Exclude directories matching the pattern DIR from
              recursive searches. 
```

或使用这个`find | xargs grep`

使用 find，您可以定义级别

**编辑**

一个命令到另一个命令的管道输出在 linux/unix 世界中非常常见。我敢打赌你每天都这样做。

```
echo "abc"|sed 's/a/x/'
find . -name "*.pyc" |xargs rm
awk 'blahblah' file | sort |head -n2 
tree|grep 'foo'
mvn compile|ack 'error'
... 
```

请注意，并非上述所有示例都是有效的。它们只是例子。

# c++ - 关于函数指针数组声明的疑问

> ID：15167864
> 
> 赞同：2
> 
> 时间：2013-03-01T20:11:27.663
> 
> 标签：c++, visual-studio-2010, pointers

我已经设法用这段代码制作了一个“指向成员函数数组”，它工作正常......

```
typedef string (MyReportHelper::*reportFunctions)();
MyReportHelper helper;

void internalPointersTest(){
    reportFunctions reportFunArray[] = {
        &MyReportHelper::getVersion,
        &MyReportHelper::getModel,
        &MyReportHelper::getUsername,
    };
    int arrSize = sizeof(reportFunArray)/sizeof(reportFunArray[0]);

    for(int i = 0; i < arrSize; i++){
        string result = (helper.*reportFunArray[i])();
        printf("%s", result);
    }
} 
```

但是，如果我将数组声明放在我的函数之外，就像下面的代码一样，我会在 Visual Studio 中遇到**缓冲区溢出**或**访问冲突**，尽管**代码可以编译**.

```
typedef string (MyReportHelper::*reportFunctions)();
MyReportHelper helper;

reportFunctions reportFunArray[] = 
{
    &MyReportHelper::getVersion,
    &MyReportHelper::getModel,
    &MyReportHelper::getUsername,
};

void internalPointersTest(){
    int arrSize = sizeof(reportFunArray)/sizeof(reportFunArray[0]);

    for(int i = 0; i < arrSize; i++)
    {
        //next line will fail
        string result = (helper.*reportFunArray[i])();
        printf("%s", result);
    }
} 
```

有谁知道如何解释为什么我需要将其保留在函数范围内？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T20:38:56.083

您没有使用`i`.

其次，使用`std::begin`and `std::end`，他们已经为你处理了这个问题。

最后，PTMF 基本上一文不值。使用`std::function`.

编辑：

可能发生的情况是您错误地计算了大小，而 VS 仅在它是静态的时候才注意到。它可能在两个版本中都被破坏了。那是你的UB。

再次编辑：您将类型的对象传递`string`给`printf`? 如果那*不是*的 typedef `const char*`，那么你好 UB。如果*是*……那么，那真的很糟糕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:55:40.713

```
string result = (helper.*reportFunArray[i])();
printf("%s", result); 
```

我认为`string`实际上是`std::string`？你在什么`using namespace std;`地方吗？

在这种情况下，`printf("%s", result);`很可能会崩溃，因为它将上帝知道什么解释为 C 样式字符串的第一个字符。下面的工作吗？

```
string result = (helper.*reportFunArray[i])();
std::cout << result; 
```

# java - GCC 中的外部“Java”块

> ID：15167867
> 
> 赞同：22
> 
> 时间：2013-03-01T22:22:28.917
> 
> 标签：java, c++, gcc, java-native-interface, gcj

我在 C++ 的 GCC 文档中发现了一个有趣的[特性：](http://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcc/C_002b_002b-Attributes.html#C_002b_002b-Attributes)

> **java_interface**
> 
> 此类型属性通知 C++ 该类是 Java 接口。它只能应用于在**外部“Java”**块中声明的类。对该接口中声明的方法的调用将使用 GCJ 的接口表机制进行分派，而不是常规的虚拟表分派。

据我了解，它看起来像这样：

```
extern "Java" {
    class NativeClass __attribute__((java_interface)) {
        //Implementation on native methods goes here.
    }
} 
```

有人知道这方面的细节吗？如何从 Java中调用**NativeClass的方法？**也许有人在现实生活中尝试过？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T23:31:54.280

GCJ 为 Java 提供了*两个*本地接口：使用 C 的[JNI](http://docs.oracle.com/javase/7/docs/technotes/guides/jni/index.html)和使用 C++ 的[CNI 。](http://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcj/About-CNI.html#About-CNI)由于您引用的示例使用了一个类，因此它必须引用后者。关于接口的[CNI 文档](http://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcj/Interfaces.html#Interfaces)仅描述了如何从 C++ 代码访问 Java 中描述的接口。您的示例似乎以相反的方式工作：一个用 C++ 编写的类，可从 Java 访问并用作 Java 接口。

但是关于这个可用的细节很少，所以试验和错误将是试验这个的一种方法，而查看实际的 GCC 源代码将是另一种方法。如果您想查看`extern "Java"`块和`java_interface`属性的一个示例，请查看[`java/lang/Readable.h`](https://gcc.gnu.org/git/?p=gcc.git;a=blob;f=libjava/java/lang/Readable.h;h=d8e7d2185c30f37a7971af2f94627d158e3bc606;hb=c9b304ada7111264d743b1c588393b66a3e3edfb). 它包含 Java 接口的 C++ 表示[`java.lang.Readable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Readable.html)。正如该文件的第一行所述，它是机器生成的。因此，文档如此少的原因可能是因为您不应该自己编写这些东西。这只是GCJ如何实现CNI的一个细节。更仔细地查看上面的文件，似乎他们甚至违反了他们自己的文档，因为与您引用的片段相比，它`Readable.h`具有块之外的属性。`extern`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T20:53:16.763

我第一次遇到这种块类型不是“java”而是“C”，所以我认为这是同样的兴趣。块定义为：

```
extern "Java"
{
// some java definition
} 
```

用于向 GCC 指定此块是 java 接口。它用于描述用于定义类的修饰类型。gcc 使用名称 mangling 通过参数等生成函数名称...更多信息在这里：[http](http://www.agner.org/optimize/calling_conventions.pdf) ://www.agner.org/optimize/calling_conventions.pdf 所以你使用`extern "Java"`当您使用它导入 java 代码时，您可以像 C/C++ 中的任何函数一样调用它，而无需指定损坏的名称。我对它的唯一用途是用于定义了一些 C 函数的 dll，并在 C++ 代码中加载，因此我使用外部“C”向 GCC 指定此函数的定义不使用名称修饰。好吧，现在如何在 java 中调用本地方法，因为 java 中的一切都是方法，一切都是对象，没有函数。首先，你必须用java描述你的类，你想用本地语言做的所有功能都必须定义为native：`private native void print();`例如。其次，回到您的本机代码头中，您必须按照命名法定义方法：

```
extern "Java"
{
        JNIEXPORT YourReturnType JNICALL Java_ClassName_MethodName (JNIEnv* env, jobject obj);
} 
```

至少，所有方法都必须是这样的，因为 JNI 将在方法中发送一个 JNIEnv 指针和一个将是“this”的对象，如果您有其他参数，则必须在 2 个基础之后给出。最后，您只需在本机代码文件中实现所有方法，始终遵循规范，例如：

```
 JNIEXPORT void JNICALL Jave_Printer_print(JNIEnv* env, jobject obj)
 {
      printf("Hello world");
 } 
```

现在您可以在 Java 中创建一个 Printer 对象并调用定义为 native 的 print 方法。我希望我回答了你的问题。

# playframework - 扩展播放主体解析

> ID：15167868
> 
> 赞同：1
> 
> 时间：2013-03-01T22:22:36.917
> 
> 标签：playframework, playframework-2.1

我们正在用 Java 构建一个游戏应用程序。我们正在使用播放 2.1。

我被困在如何扩展播放以基于 url 查询参数而不是 content-type 标头解析正文并将结果作为 JavaObject 返回。

我认为可以通过编写自定义 BodyPraser 来完成，但这种方法存在两个问题

1.  我必须在 Scala 中做，这会占用更多时间，因为我不了解 Scala。
2.  我不想写 BodyParser 本身。解析前的一个小逻辑，检查内容类型并使用 Play api 解析内容。

解析正文后，我想将内容反序列化为 JavaObject。像这样的东西.. RequestBody.as(UserDTO.class)

这会将控制器代码与可能是 XML、JSON 等的表示形式分离。

那么，我可以在游戏中做到这一点的最佳方式是什么？

# excel - 对 .csv 文件名使用多个通配符

> ID：15167869
> 
> 赞同：2
> 
> 时间：2013-03-01T22:22:51.957
> 
> 标签：excel, vba

我目前有一个查找特定文件名的宏，并根据结果运行专门针对该文件的特定子：

```
Sub CommandButton3_Click()
Dim i As Integer
Dim fname As Variant
Dim filepath As Variant
'filepath = Application.GetOpenFilename(FileFilter:="Excel File (*.csv), *.scv")

fname = Application.GetOpenFilename(FileFilter:="Excel File (*.csv), *.scv",    
Title:="Please select a stat file", MultiSelect:=True)
filepath = ThisWorkbook.Path

For i = 1 To UBound(fname)
    If fname(i) = filepath & "\" & "Nodes.csv" Then
        Workbooks.Open (fname(i))
        Call Node
    ElseIf fname(i) = filepath & "\" & "IOGroups.csv" Then
        Workbooks.Open (fname(i))
        Call IOGrp
    ElseIf fname(i) = filepath & "\" & "ManagedDiskGroups.csv" Then
        Workbooks.Open (fname(i))
        Call MdiskGrp
    ElseIf fname(i) = filepath & "\" & "ManagedDisks.csv" Then
        Workbooks.Open (fname(i))
        Call Mdisk
    ElseIf fname(i) = filepath & "\" & "Ports.csv" Then
        Workbooks.Open (fname(i))
        Call Ports
    ElseIf fname(i) = filepath & "\" & "Subsystem.csv" Then
        Workbooks.Open (fname(i))
        Call Subsystem
    ElseIf fname(i) = filepath & "\" & "Volumes.csv" Then
        Workbooks.Open (fname(i))
        Call Volumes        
     Else            
    End If
Next i
End Sub 
```

我希望能够在名称中包含 2 个通配符，即：

```
If fname(i) = filepath & "\" & "*Node*.csv" Then 
```

这甚至有可能吗，需要这个的原因是文件的名称不同，但是每个文件名中的根词总是相同的，唯一的问题是根词之前和之后通常有一些东西。有任何想法吗？此外，目前包含此宏的工作簿必须与用于工作的文件位于同一目录中，有没有办法改变它？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T04:54:45.597

使用`Dir`which 为您提供该目录中满足通配符的文件的即时列表（而不是使用 测试每个文件`Like`）

```
Sub GetFIles()
Dim Strfile As String
Strfile = Dir(ThisWorkbook.Path & "\" & "*node*.csv")
Do While Len(Strfile) > 0
'do something with returned files
Debug.Print Strfile
Strfile = Dir
Loop
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T03:26:28.360

VBA 支持`Like`关键字，因此您可以通过使用`Like`而不是来使这些通配符起作用`=`：

```
If fname(i) Like filepath & "\" & "*Node*.csv" Then... 
```

要从您想要的任何地方获取文件，而不仅仅是当前目录，请尝试[Application.FileDialog](http://msdn.microsoft.com/en-us/library/office/ff836226%28v=office.14%29.aspx)而不是`Application.GetOpenFilename`. `Application.FileDialog.SelectedItems`返回完整路径。

# c - MPI 收集稀疏向量

> ID：15167874
> 
> 赞同：0
> 
> 时间：2013-03-01T22:23:28.527
> 
> 标签：c, arrays, mpi, sparse-matrix

嗨，我有结果 bool C 数组（sizeResults 的大小），它非常稀疏，因为大多数值都是错误的。我正在使用 MPI_GATHER 从所有工作人员那里收集这个数组，但是它非常耗时......

```
MPI_Gather(result, sizeResults, MPI_BYTE, result_final, sizeResults, MPI_BYTE, 0, MPI_COMM_WORLD); 
```

有没有更有效的方法来做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:49:19.687

我可以想到几个，具体取决于您的数组的稀疏程度。一种简单的方法是将您的布尔数组压缩成一个位数组，将其减少到其原始大小的 1/8。

你可以做的其他事情：

1.  而不是`Gather`ing bool 值本身，而是值`Gatherv`的索引`true`。例如，如果一个进程有数组`{ T, F, F, F, F, F, T, F, F, T }`，那么它将发送数组`{ 0, 6, 9 }`。

2.  如果您想获得创意，请将您的数组视为由段组成，其中段定义为一个`true`值，其后是`false`通向下一个值的所有`true`值。使用上面的示例，您的 3 个段将是`{ T, F, F, F, F, F }`、`{ T, F, F }`和`{ T }`。现在你需要`Gatherv`从每个过程中得到每个段的长度。公平地说，这通常并不比方法 1 更有效。

# c# - 如何禁用 ContextMenuStrip 中的菜单项？

> ID：15167875
> 
> 赞同：6
> 
> 时间：2013-03-01T22:23:29.160
> 
> 标签：c#, .net, winforms, contextmenustrip

我的 ContextMenuStrip 中有“添加”、“删除”和“更新”等选项，当用户右键单击 ListView 时应该会弹出这些选项。

如果列表视图中没有项目，如何禁用更新菜单？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T00:41:30.503

使用 ContextMenuStrip.Opening 事件..

```
if (ListBox1.Items.Count == 0) {
     ItemAToolStripMenuItem.Enabled = false;
} 
```

[http://i.imgur.com/8DlqvDZ.png](https://i.imgur.com/8DlqvDZ.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T22:35:28.727

您可以尝试使用 MouseDown 事件：

```
void listView1_MouseDown(object sender, MouseEventArgs e) {
  if (e.Button == MouseButtons.Right) {
    updateToolStripMenuItem.Enabled = (listView1.Items.Count > 0);
  }
} 
```

# php - jquery 将变量添加到 $.get url 参数

> ID：15167887
> 
> 赞同：1
> 
> 时间：2013-03-01T22:24:30.700
> 
> 标签：php, javascript, jquery, jquery-get

我一直在用 jquery 的 $.get-function 敲打我的头。

我正在尝试做这样的事情：

```
$("#button").click(function(){

var value=$("#textfield").val();

alert(value);

$.get('lookup.php?s=<?php echo $id?>&q=+ value',function(data) {

$(#result).html(data); 
```

这应该使用 GET 参数查询 lookup.php：

$id (PHP-variable) & value (jquery/Javascript-variable)

问题是，$id 被正确填写，但之前的 jquery/javascript 分配的“值”不是。

玩数据：-参数根本没有帮助。

有没有办法可以将文本字段输入中的 jquery 变量附加到查询字符串？

我需要使用这两个参数调用 $.get ，否则我无法在脑海中找到方法:-)。

希望我的意图变得清晰......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:29:22.007

你需要把`+ value`引号的外面。另外，我不会手动构建查询字符串。只需传递一个对象：

```
$.ajax({
    type: 'get',
    url: 'lookup.php',
    data: {
        s: '<?php echo $id; ?>',
        q: value
    },
    success: function(data) {
        ...
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:25:54.317

`value`您需要将变量移到引号之外，而不是只包含字符串“值”。它应该是这样的：

```
$.get('lookup.php?s=<?php echo $id?>&q=' + value,function(data) { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T22:26:07.203

您的值应该在引号之外：

```
$.get('lookup.php?s=<?php echo $id?>&q='+value,function(data) { 
```

当变量放在引号内时，它只是被视为字符串“值”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T22:26:07.770

```
$.get('lookup.php?s=<?php echo $id?>&q='+ value,function(data) { 
```

# c++ - 运行命令时popen的间隔是多少以及如何逐行捕获输出？

> ID：15167888
> 
> 赞同：1
> 
> 时间：2013-03-01T22:24:41.370
> 
> 标签：c++, stream, popen

假设我在下面有这段代码，我用它来运行一个简单的命令，比如`ls`假设输出是`100`行长的。

当我们`cout << buff`在下面的代码中进行操作时，输出是逐字节、逐位还是逐行传输，或者间隔是多少？

假设我们想`new_line!`在流式传输时打印每个新行的字符串结尾`cout<<buff`。我们怎么能这样做？

我在想，在那个`while`循环中，我们应该有一些东西来检查它是否刚刚流入（或即将流入）`\n`到我们的 stringstream`output`中，并且它决定在流入输出之后（或之前）做一些事情。

最初我将把它变成数据结构来存储，所以我只需要知道如何在缓冲时检查，`\n`以及在哪里放置添加的函数`new_line!`或我想做的任何事情。

这是代码：

```
#include <iostream>
#include <stdio.h>

using namespace std;
// imaginary 
// stringstream output;

int main() {
    FILE *in;
    char buff[512];

    if(!(in = popen("ls -sail", "r"))){
        return 1;
    }

    while(fgets(buff, sizeof(buff), in)!=NULL){
            // output << buff;
            // if there is a new line
            // output << "new_line!";

        cout << buff;
    }
    pclose(in);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:44:25.737

如果您使用 GNU libc，那么您可以[`getline()`](http://linux.die.net/man/3/getline)使用`fgets`. 有关更详细的说明，请参见[此处。](https://stackoverflow.com/questions/3501338/c-read-file-line-by-line)

否则，请使用系统提供的任何工具从`FILE*`. 如果你真的找不到这样的设施（这将是非常令人惊讶的），那么最坏的情况下你总是可以使用[这种方法](https://stackoverflow.com/questions/2532425/read-line-from-file-without-knowing-the-line-length)。`fgets`如果您考虑缓冲区大小限制并在需要时自行进行更多缓冲，这也是一个很好的解决方案（检查[文档](http://linux.die.net/man/3/fgets)，一切都已解释）。

您必须记住的是，`popen`只返回 a`FILE*`所以任何适用于标准文件的东西也适用于您的情况。网络上的例子很多。

* * *

现在对于您问题的“间隔”部分，恐怕没有什么意义。首先，这取决于外部命令将新数据打印到标准输出的时间间隔。无论如何，只要外部命令写入它，您就可以在程序中读取它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:44:37.690

就像`fget`使用 stdio 一样。它将等待直到 EOF（程序已关闭）或直到缓冲区被填满。

因此，while 循环的每次迭代都将获得 512 字节的数据或程序终止或 stdio 关闭后的剩余部分。

您可以使用这样的小程序进行测试：

```
#include <thread>
#include <chrono>
#include <iostream>

int main() {
    std::cout << "hello" << std::endl;
    std::this_thread::sleep_for(std::chrono::seconds(5));
    std::cout << " world" << std::endl;
} 
```

您会注意到，尽管睡眠时间很长，但它仍会尝试读取 512 个字节，并在 stdout 读取时结束。

要以符合标准的方式管理实际分块，您可以使用`std::fgetc`和构建自己的缓冲区。

[http://en.cppreference.com/w/cpp/io/c/fgetc](http://en.cppreference.com/w/cpp/io/c/fgetc)

您自己的 getline 可能如下所示：

```
std::string get_line(FILE* f) {
    char c;
    std::string out;
    while(c=std::fgetc(f)!='\n' && c!=EOF) {
         out+=c;
    }
    out+='\n';
    return out;
}

//...

//usage
while(!std::feof(in)) {
    cout << get_line(in);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T22:50:21.483

管道将在数据进入时对其进行缓冲（直到它达到一些可能不容易找到的实现限制 - 但它是“大量的” - 此时管道将在`ls`写入时“阻塞”，因此`ls`会停止)，除非你读得更快，在这种情况下你的线程会阻塞。如果您要输出到屏幕，您的输出可能会限制速率。

这样的管道不是“块”或“行缓冲”——它只是一个管道——放在一端的任何东西都会从另一端出来。当然，如果“文件管理”的内部要求 4000 字节，则可能要等到 4000 字节在另一端通过后，才能完成读取操作。但很可能内部结构`fgets`是健全的，不会一次要求大量数据。

# javascript - 使用 Javascript 打印 HTML + 多个 PDF 文件

> ID：15167892
> 
> 赞同：2
> 
> 时间：2013-03-01T22:25:17.840
> 
> 标签：javascript, jquery, pdf, printing

我有一个项目，我需要打印用户所在的 HTML 页面，以及多个 PDF 文件（多个提示都可以）

在 Google 和 Stackoverflow 上四处寻找之后，我发现[使用 JavaScript 打印多个 PDF 文件](https://stackoverflow.com/questions/7187400/printing-multiple-pdf-files-using-javascript)很接近，但不太有效。

下面的代码可以很好地打印 HTML 页面，并为 PDF 创建打印提示，但 PDF 打印提示是针对空白页的。

我已经检查了示例地址三次，罚款肯定在[http://www.mydomain.co.nz/wp-content/uploads/Golden-China1.pdf](http://www.mydomain.co.nz/wp-content/uploads/Golden-China1.pdf)。

有人发现我做错了什么吗？

```
function PrintAll(file1, file2, file3) {
    window.print();
    var pages = [file1, file2, file3];
    for (var i = 0; i < pages.length; i++) {
        if (pages[i] != undefined) {
            var oWindow = window.open(pages[i], "print");
            oWindow.print();
            oWindow.close();
        }
    }
}

$('.print-btn').click(function() {
    PrintAll('/wp-content/uploads/Golden-China1.pdf');
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T08:54:08.867

我测试了一些代码，我的代码遇到的问题是时间加载，添加了延迟，所以我让 PDF 完成加载，然后发送打印命令：

```
<!DOCTYPE html>
<html>
<body>
<script>
var pages = ["P1.pdf", "P2.pdf", "P3.pdf"];
var oWindow=new Array();
function PrintAll(){
    for (var i = 0; i < pages.length; i++) {
        oWindow[i].print();
        oWindow[i].close();

    }
}
    function OpenAll() {
    for (var i = 0; i < pages.length; i++) {
        oWindow[i] = window.open(pages[i]);
    }
    setTimeout("PrintAll()", 5000);
    }
    OpenAll();
</script>
</body>
</html> 
```

# session - 避免在站点中使用 http 进行会话劫持

> ID：15167896
> 
> 赞同：0
> 
> 时间：2013-03-01T22:25:55.300
> 
> 标签：session, cookies, web, https, session-hijacking

我知道避免会话劫持的唯一方法`https`，但有时我们不想使用它。所以我考虑了替代方法。

我解释了我的方法，这可能还是好方法？

认为我们有第三方服务器（我称之为 Padra），它为您提供 API 来检查会话和 cookie，您将在您的网站视图中调用 Padra jt 文件（会话和 cookie 由 Padra 域名保存，您没有直接访问它，但 padra 使用 SSL），然后您可以通过调用 Padra API 在服务器端检查会话和 cookie 值。

你怎么看待这件事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:38:04.000

我不认为这是一个特别好的权衡。

问题：

*   您降低了用户对您网站的信心（即使您有一个安全的实施，它也不会有挂锁/绿条/等）
*   您的用户现在有额外的资产来下载、解析、运行，因此会减慢他们的体验
*   [如果禁用](http://blog.mozilla.org/privacy/2013/02/25/firefox-getting-smarter-about-third-party-cookies/)第三方 cookie，则它根本不起作用
*   您在整个过程中增加了额外的复杂性，现在还对您必须管理的后端有额外的外部依赖

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T14:33:16.210

HTTP-ONLY 标头有助于防止常见的会话劫持和 XSS 漏洞。您可以尝试使用它，而不是经历这么多麻烦。

# java - 为什么在捕获异常时顺序很重要？

> ID：15167899
> 
> 赞同：24
> 
> 时间：2013-03-01T22:26:12.223
> 
> 标签：java, exception-handling

我不得不用一些代码回答这个问题：

> 假设我编写了以下方法规范：
> **`public void manipulateData ( ) throws java.sql.SQLException, java.sql.SQLDataException`**
> 
> 您正在为将使用此方法的数据库程序编写代码，并且您希望专门处理每一个。**try/catch 子句应该是什么样的？**
> 您可以使用 no-ops——空块 {}——作为 catch 子句的内容。
> 我们只对这里语句的语法和结构感兴趣。

我这样回答：

```
try {

} catch(java.sql.SQLException e) {

}
catch(java.sql.SQLDataException e) {

} 
```

他不接受这个答案：

“你的 catch 子句顺序不对。你能解释一下为什么这个顺序很重要吗？”

他的回答正确吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-03-01T22:28:00.527

是的，他是对的。正如您在[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/sql/SQLDataException.html)中看到的，`SQLDataException`是`SQLException`. 因此，您的答案是错误的，因为它会在第二个中创建一个无法访问的代码块`catch`。

在 Java 中，此代码甚至无法编译。在其他语言（例如python）中，这样的代码会产生一个微妙的错误，因为`SQLDataException`实际上会在第一个块中被捕获，而不是在第二个块中（如果它不是子类的话就是这种情况）。

如果你回答`catch(java.sql.SQLException | java.sql.SQLDataException e) { }`了，它仍然是不正确的，因为问题要求具体处理每个异常。

正确答案在[Grijesh 的回答中](https://stackoverflow.com/a/15174337/828193)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-03-01T22:28:32.487

在 Java 中，您必须首先放置包含最少的异常。下一个例外必须更具包容性（当它们相关时）。

例如：如果你把最包容的（异常）放在第一位，接下来的将永远不会被调用。像这样的代码：

```
try {
     System.out.println("Trying to prove a point");
     throw new java.sql.SqlDataException("Where will I show up?");
}catch(Exception e){
     System.out.println("First catch");
} catch(java.sql.SQLException e) {
     System.out.println("Second catch");
}
catch(java.sql.SQLDataException e) {
     System.out.println("Third catch");
} 
```

永远不会打印您希望它打印的消息。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-02T12:13:23.140

**由于以下原因，捕获异常时的顺序很重要：**

记住：

*   基类变量也可以引用子类对象。
*   `e`是参考变量

> ```
> catch(ExceptionType e){
> } 
> ```

小写字符 e 是对抛出（和捕获）`ExceptionType`对象的引用。

**您的代码不被接受的原因是什么？**

> 重要的是要记住*异常子类必须出现在它们的任何超类之前*。这是因为使用超类的 catch 语句将捕获该类型及其任何子类的异常。因此，如果子类出现在其超类之后，则永远无法到达子类。
> 此外，在 Java 中，**无法访问的代码是一个错误。**

`SQLException`是超类的`SQLDataException`

```
 +----+----+----+
   | SQLException |  `e` can reference SQLException as well as SQLDataException
   +----+----+----+
          ^
          |
          |
+----+----+----+---+
| SQLDataException |   More specific 
+----+----+----+---+ 
```

如果你的写作喜欢有错误 `Unreachable code`（*阅读评论*）：

```
try{

} 
catch(java.sql.SQLException e){//also catch exception of SQLDataException type 

}
catch(java.sql.SQLDataException e){//hence this remains Unreachable code

} 
```

如果您*尝试编译此程序，您将收到一条错误消息*，指出第一个 catch 语句将处理所有基于 SQLException 的错误，包括 SQLDataException。*这意味着第二个 catch 语句将永远不会执行。*

**正确的解决方案？**

要修复它，请颠倒 catch 语句的顺序。如下：

```
try{

} 
catch(java.sql.SQLDataException e){

}catch(java.sql.SQLException e){

} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-03-01T22:29:51.813

`SQLDataException`永远不会被击中，因为`SQLException`在它们到达之前会捕获任何 SQL 异常`SQLDataException`。

`SQLDataException`是一个*子*类`SQLException`

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-03-01T22:36:30.537

考虑异常的继承层次结构：`SQLDataException extends SQLException`因此，如果您首先捕获“通用”一个（即层次结构的最顶层基类），那么由于多态性，它“下面”的所有事物都是相同的类型，即*SQLDataException* `isa` *SQLException*

因此，您应该在继承层次结构中以自下而上的顺序捕获它们，即子类首先一直到（通用）基类。之所以如此，是因为这些`catch`子句是按照您声明它们的顺序进行评估的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-08T08:31:43.920

[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-11.html)§11.2.3 解释了这种情况：

> 如果一个 catch 子句可以捕获已检查的异常类 E1，并且紧邻的 try 语句的前面的 catch 子句可以捕获 E1 或 E1 的超类，则这是一个**编译时错误。**

纯英文版：

> 更一般的例外必须在特定例外之后。更一般的例外必须在特定例外之后。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-07T10:16:41.853

当方法中发生异常时，会检查一个特殊的方法异常表，它包含每个catch块的记录：异常类型、开始指令和结束指令。如果异常的顺序不正确，则某些 catch 块将无法访问。当然 javac 可以为开发人员排序此表中的记录，但它不能。

JVM 规范：[1](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html#jvms-2.10)和[2](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-3.html#jvms-3.12)

> 搜索方法的异常处理程序以查找匹配项的顺序很重要。在类文件中，每个方法的异常处理程序都存储在一个表中（第 4.7.3 节）。在运行时，当抛出异常时，Java 虚拟机按照它们出现在类文件中相应异常处理程序表中的顺序从该表的开头开始搜索当前方法的异常处理程序。

只要第一个异常是第二个异常的父异常，第二个块就变得不可访问。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-02T06:07:22.250

对于编译器，多个 catch 语句就像 if..else if..else if..

因此，从编译器可以映射生成的异常（直接或通过隐式类型转换）的角度来看，它不会执行后续的 catch 语句。

为了避免这种隐式类型转换，您应该最后保留更通用的异常。更多派生应该在他的 catch 语句的开头声明，最通用的应该在最后的 catch 语句中。

SQLDataException 是从 SQLException 派生的，SQLException 是从 Exception 中提取出来的。因此，您将无法执行`catch(java.sql.SQLDataException e){}`此块中编写的任何代码。编译器甚至会针对这种情况标记它是死代码并且不会被执行。

# events - beforeRequest 事件 jqGrid：在调用 url 之前设置 jqGrid 页面

> ID：15167903
> 
> 赞同：2
> 
> 时间：2013-03-01T22:26:16.813
> 
> 标签：events, jqgrid

我正在尝试在对 URL 的 GET 请求之前在 jqGrid 中设置页面变量...

```
 jQuery("#frTable").jqGrid({                
            cmTemplate: { sortable: false },
            caption: '@TempData["POPNAME"]' + ' Population',
            datatype: 'json',                
            mtype: 'GET',
            url: '/Encounters/GetAjaxPagedGridData/', 
```

我尝试了各种各样的事情，无论我尝试什么，我似乎都无法让它工作......我已经尝试了各种各样的事情，唯一有效的是订阅 LoadComplete 事件像这样...

```
 loadComplete: function() {
                if ((rowFromTemp != "") && (pageFromTemp != "")) {
                    setTimeout(function () {
                    $("#frTable").trigger("reloadGrid", [{page: pageFromTemp, rowNum: rowFromTemp}]); 
                    }, 50);
                }
            }, 
```

我遇到的唯一问题是它不断更新。不知道为什么会这样。我认为唯一的事情是我以某种方式循环使用我的超时功能......

我曾尝试订阅其他几个请求，但每个请求似乎都失败了。我觉得最有希望的是 beforeRequest 事件。这是我目前拥有的...

```
 beforeRequest: function() {
                if ((rowFromTemp != "") && (pageFromTemp != "")) {
                    $("#frTable").setGridParam([{ page: pageFromTemp, rowNum: rowFromTemp }]);                        
                    }
            }, 
```

它不在乎我将变量设置为什么，它只是在第 1 页打开，不管是什么。
现在，我在这里您可以将数据设置为“本地”，这意味着您必须重新加载网格才能获取任何数据。

但我希望在用户第一次打开数据时加载数据。我正在尝试设置页面，以便在用户使用我的编辑屏幕编辑一行后，当他点击保存时，他将被带回他刚刚所在的页面。不是第一页。如您所知，这对用户来说是非常令人沮丧的。

**更新**

好的...我在 beforeRequest 事件中放置了一个警报，它在我的网格加载之前触发。在 url 部分调用的操作中设置断点告诉我在我实际发出请求之前调用了警报。这是我所希望的。我只需要弄清楚如何正确设置页面变量。

**更新 2** 好的。我设置了变量，并让我的警报告诉我该变量确实已设置...

```
 beforeRequest: function() {
                if ((rowFromTemp != "") && (pageFromTemp != "")) {
                    this.p.page = pageFromTemp;
                    alert("This is what the page is: " + this.p.page + ";  And this is what I want it to be: \n" + pageFromTemp + " How do I get it there \n"); 
```

但是，它仍然加载第一页？很明显，它再次被覆盖。为什么？我怎样才能永久设置它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T18:10:53.050

我遇到了同样的问题，但我在 BeforeRequest 函数上做到了这一点：

```
$('#GRID_ID').jqGrid('setGridParam', { postData: { page: 4} }); 
```

# email - 如何远程访问我的应用程序？

> ID：15167905
> 
> 赞同：1
> 
> 时间：2013-03-01T22:26:21.240
> 
> 标签：email, command

我想开发一个软件，它可以在给定的计算机上运行，​​但可以从远处接收命令，通过互联网从另一台计算机接收命令。请注意，我想要的不是使用某种 VCN 来远程使用计算机，而是控制软件，就好像我实际上是在使用运行它的 PC 一样。我想要的是通过互联网发送一些命令和信息，软件接收它并做出相应的反应。

我想过将电子邮件发送到特定电子邮件帐户的想法，并且连接到该电子邮件地址的软件会阅读收到的电子邮件并解释他们的消息，但我对如何做有疑问这个，我想知道是否没有其他更好的方法。

所以，请你告诉我你的建议吗？

谢谢，

莫默吉尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:34:22.783

有很多方法可以实现这一点。在 linux/unix 环境中，在远程计算机或服务器上执行命令的一种简单方法是通过 ssh。

示例：（带有 SSH 书签）ssh YourRemoteMachineSSHBookmark -t date

这将使远程机器显示它的日期。您可以通过这种方式执行任何远程命令。

# batch-file - 测试文本文件（批处理）中有多少特定值？

> ID：15167906
> 
> 赞同：0
> 
> 时间：2013-03-01T22:26:26.630
> 
> 标签：batch-file

我需要（快速）查看一个文本文件以及包含特定值（表示为 %Val%）的每一行，我基本上想要这样做：“set /a Count+=1”，以便在它结束时%Count% = 文本文件中 %Val% 的数量。这就是我所拥有的，但这需要很长时间，因为它必须通过文件中的所有几百行：

```
set Count=0
FOR /F "usebackq delims=" %%a in ("%File%") do (
  if "%%a" == "%Val%" set /a Count+=1
)
echo.%Count% 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T01:10:31.060

使用 FINDSTR 查找与您的搜索完全匹配的行，并将结果通过管道传输到 FIND 以计算匹配数。使用 FOR /F 循环来捕获结果。

```
for /f %%N in ('findstr /xlc:"%val%" "%file%"^|find /c /v ""') do set count=%%N 
```

# ruby-on-rails - 将方法从控制器移动到模型

> ID：15167909
> 
> 赞同：0
> 
> 时间：2013-03-01T22:26:44.000
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

根据几个人的建议，我被告知要使我的控制器尽可能简洁。目前我的控制器中有这个：

```
class SearchesController < ApplicationController
  def index
    raw_result = params[:search] ||= "man on fire"
    result = raw_result.gsub(/\s+/, "+")
    movie_details = HTTParty.get("http://imdbapi.org/?title="+result+"&type=json")
    @searches = ActiveSupport::JSON.decode(movie_details)
  end
end 
```

如何在我的模型中将它变成一个新类并在控制器中再次调用它？

当前型号和控制器：

```
class IMDBSearcher
  def self.search(search)
    raw_result = search || "man on fire"
    result = raw_result.gsub(/\s+/, "+")
    movie_details = HTTParty.get("http://imdbapi.org/?title="+result+"&type=json")

    ActiveSupport::JSON.decode(movie_details)      
  end
end

class SearchesController < ApplicationController
  def index
    @searches = IMDBSearcher.search(params[:search]) 
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:33:41.850

如果它是一个实例方法，你可以这样称呼它：

```
instance.search(something) 
```

如果它是一个类方法，你可以这样称呼它：

```
IMDBSearcher.search(something) 
```

但是，要做到这一点，你必须像这样创建你的方法：

```
def self.search(raw_result) 
```

这里的技巧是使用`self`关键字，将方法转换为类方法（因为这里的self是类IMDBSearcher）。例如：

```
def self.search(search)
  raw_result = search || "man on fire"
  result = raw_result.gsub(/\s+/, "+")
  movie_details = HTTParty.get("http://imdbapi.org/?title="+result+"&type=json")

  ActiveSupport::JSON.decode(movie_details)      
end 
```

在控制器中，您可以执行以下操作：

```
@searches = IMDBSearcher.search(params[:search]) 
```

# c# - 通过单击按钮更改文本框中的文本？

> ID：15167910
> 
> 赞同：0
> 
> 时间：2013-03-01T22:26:47.377
> 
> 标签：c#, windows-phone-8

我正在制作一个应用程序来汇总掷硬币的结果，但我在更改文本框中的数字时遇到了麻烦，我可以使用一些帮助。

那么，我该怎么做呢？

这是我的代码：

```
private void Button_Click_1(object sender, RoutedEventArgs e) {
        Random random = new Random();
        int number = random.Next(1, 100);

        //debug_TB.Text = Convert.ToString(number);

        if (number <= 50)
        {
            yesornogrid.Background = new SolidColorBrush(Colors.Green);
            numberTot = numberTot + 1;
            numberYes = numberYes + 1;

            yes_total_TB.Text = 
        }
        else if (number >= 51)
        {
            yesornogrid.Background = new SolidColorBrush(Colors.Red);
            numberTot = numberTot + 1;
            numberNo = numberNo + 1;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:32:52.217

就像这样：

```
yes_total_TB.Text = string.Format("{0} YES of {1} tries", numberYes, numberTot); 
```

而且当然

```
no_total_TB.Text = string.Format("{0} NO of {1} tries", numberNo, numberTot); 
```

**更新**

在 C# 6.0 中，这可以使用[字符串插值完全重写](http://blogs.msdn.com/b/csharpfaq/archive/2014/11/20/new-features-in-c-6.aspx)

```
yes_total_TB.Text = $"{numberYes} YES of {numberTot} tries";
no_total_TB.Text = $"{numberNo} NO of {numberTot} tries" 
```

# java - orphanRemoval=true 双向 OneToOne

> ID：15167911
> 
> 赞同：2
> 
> 时间：2013-03-01T22:26:50.717
> 
> 标签：java, hibernate, jpa

我对双向 OneToOne 关系和删除孤儿有点困惑。这些是我的实体：

```
@Entity
@Table(name = "city")
public class City {

    @Id
    @GeneratedValue
    @Column
    public Long _UID;

    @OneToOne(mappedBy="city", orphanRemoval = true, cascade=CascadeType.ALL)
    public Mayor mayor;
}

@Entity
@Table(name = "mayor")
public class Mayor {

    @Id
    @GeneratedValue
    @Column
    public Long _UID;

    @OneToOne(optional=false)
    public City city;
} 
```

如果我尝试这个交易：

```
City c = em.find(City.class, (long) 1);
AssertNotNull(c.getMayor());//gives true
Mayor m = new Mayor("Ed", "Lee");
c.setMayor(m);
m.setCity(c);
em.flush(); //This creates new Mayor and adds it to City, but don't delete an old one. 
```

如果我在设置新的之前将市长设置为 null 并刷新，它会起作用：

```
City c = em.find(City.class, (long) 1);
AssertNotNull(c.setMayor());//gives true
c.setMayor(null);
em.flush();
Mayor m = new Mayor("Ed", "Lee");
c.setMayor(m);
m.setCity(c);
em.flush(); //This creates new Mayor and adds it to City, but don't deletes an old one. 
```

我使用 Hibernate 4 作为 JPA2 实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T16:55:02.383

这是 Hibernate 中的一个已知问题（实际上在 JPA 规范中）。

有关问题背景以及可能的解决方法的更多信息，请参阅[此错误报告。](https://hibernate.onjira.com/browse/HHH-5559)您可以在同一问题上投票给[另一张票](https://hibernate.onjira.com/browse/HHH-6484)，因为前者已经关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:42:28.287

1.  请删除`(optional=false)`
2.  你必须做`em.clear()`之后`em.flush()`

# python - 在 Python 中过滤字典......再次

> ID：15167913
> 
> 赞同：1
> 
> 时间：2013-03-01T22:27:12.993
> 
> 标签：python, dictionary, filter

是的，这个网站上有很多关于拟合 python 字典的问题。但是我所看到的没有什么能完全理解我正在尝试做的事情。所以，我有一本字典。它包含一些时间的列表和一些数据值的列表。就像是

```
data_and_time = {"time":['2:30','2:45','3:25','5:15','7:21','8:22'],
                 "data":[    5.,    7.,    2.,    3.,    8.,   10.]} 
```

我想过滤它，例如，我只有大于或等于 5 的数据值。结果是：

```
data_and_time_5 = {"time":['2:30','2:45','7:21','8:22'],
                   "data":[    5.,    7.,    8.,   10.]} 
```

我可以想出几种方法来做到这一点——都非常丑陋并且需要很多行代码。我想要一种优雅、易读的方式来做到这一点。python字典有这样的方法吗？（顺便说一句，以字符串表示的时间完全是偶然的，只是我在这里表达我的问题的一种紧凑方式。）谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T22:33:21.460

我将从以更好的类似 JSON 的格式存储数据开始：

```
data = [dict(zip(data_and_time, val)) for val in zip(*data_and_time.values())] 
```

它看起来像这样：

```
>>> data
    [{'data': 5.0, 'time': '2:30'},
 {'data': 7.0, 'time': '2:45'},
 {'data': 2.0, 'time': '3:25'},
 {'data': 3.0, 'time': '5:15'},
 {'data': 8.0, 'time': '7:21'},
 {'data': 10.0, 'time': '8:22'}] 
```

现在，您可以更轻松地过滤对象：

```
>>> [item for item in data if item['data'] >= 5.0]
    [{'data': 5.0, 'time': '2:30'},
 {'data': 7.0, 'time': '2:45'},
 {'data': 8.0, 'time': '7:21'},
 {'data': 10.0, 'time': '8:22'}] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:43:04.637

我会采用 Blender 的方法。但是，如果您想坚持当前的数据结构，可以使用 dict/list 理解：

```
data_and_time = { k: [i for i in v if i >= 5] for k, v in data_and_time.iteritems() } 
```

当然，您必须修改 i >= 5 部分来处理日期格式。我没有在此处包含它，因为您提到您只是在这里这样做是为了简化您的示例。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T23:53:14.693

如果您需要保留数据结构：

```
data_and_time = {"time": ['2:30', '2:45', '3:25', '5:15', '7:21', '8:22'],
                 "data": [5., 7., 2., 3., 8., 10.]}

#it builds list like a [True, True, False, ...]    
index = map(lambda x: x >= 5, data_and_time['data'])
#and then 'applies' it to 'columns' of data_and_time
data_and_time = {k: [e for e in itertools.compress(v, index)]
                 for k, v in data_and_time.iteritems()} 
```

结果：

```
{'data': [5.0, 7.0, 8.0, 10.0],
 'time': ['2:30', '2:45', '7:21', '8:22']} 
```

# youtube-api - 检索 YouTube 实时类别

> ID：15167914
> 
> 赞同：1
> 
> 时间：2013-03-01T22:27:17.153
> 
> 标签：youtube-api

我正在寻找一种从 YouTube Live 中检索类别的方法。

例如从“游戏” [http://www.youtube.com/live/gaming中检索所有频道](http://www.youtube.com/live/gaming)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T03:48:08.147

如果您执行 guideCategories 列表“ [https://developers.google.com/youtube/v3/docs/guideCategories/list](https://developers.google.com/youtube/v3/docs/guideCategories/list) ”，您将看到“游戏有类别 id = 'GCR2FtaW5n'

所以当你做一个频道列表时

“ [https://www.googleapis.com/youtube/v3/channels?part=id%2C+snippet%2C+contentDetails%2C+statistics%2C+topicDetails&categoryId=GCR2FtaW5n&key=](https://www.googleapis.com/youtube/v3/channels?part=id%2C+snippet%2C+contentDetails%2C+statistics%2C+topicDetails&categoryId=GCR2FtaW5n&key=) {YOUR_API_KEY}”

您将获得与“游戏”相关的所有频道。要查找现场表演，您可以查看播放列表列表，然后遍历视频并查找 contentDetails.duration=0 的视频

“ [https://developers.google.com/youtube/v3/docs/videos#contentDetails.duration](https://developers.google.com/youtube/v3/docs/videos#contentDetails.duration) ”

# c# - NHibernate Criteria Query：处理分区

> ID：15167915
> 
> 赞同：1
> 
> 时间：2013-03-01T22:27:18.047
> 
> 标签：c#, sql, nhibernate, nhibernate-criteria

我刚开始学习 NHibernate Criteria 查询。现在进入这个连接表和分区问题。

**背景：**

1.两个对象模型：

项目，用户

2.模型属性：

***项目：***

*   编号（整数）
*   更新日期（日期时间）
*   状态（字符串）
*   用户（用户）

***用户：***

*   编号（整数）
*   名称（字符串）

3.关系

用户一次更新一个项目，每次更新后，将使用当前的 UpdateDate、Status、User 创建一个新的项目实例。

**我想做的事：**

1.  按 User.ID 对项目进行分组

2.  按更新日期排序

3.  从 1&2 获取每个 Group 的第一条记录

4.  检查此项目的状态！=“已删除”

5.  如果 4 次通过，则将此项目放入结果列表

**问题：**

1.  我现在只能使用 Criteria
2.  我知道如何进行简单的查询，例如：

    ICriteria projectCriteria = Session.CreateCriteria();

    projectCriteria.Add(Restrictions.Not("状态", "已删除"));

    projectCriteria.AddOrder(Order.Desc("UpdateDate"));

但是很难使用 Criteria API 进行分区和表连接。

想知道是否有人知道如何做到这一点可以帮助我。

谢谢！

**我在数据库中尝试的 SQL 查询：**

```
WITH PartitionProject AS 
(
    SELECT   *, ROW_NUMBER() OVER(PARTITION BY UserFk ORDER BY UpdateDate DESC) AS RowNumber
    FROM     Projects
)
SELECT * 
FROM PartitionProject 
WHERE RowNumber = 1 and (ProjectStatus != 'Deleted') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T00:00:47.720

我认为 Nhibernate 不支持 Row_Number() 分区，但您可以使用`Projections.SqlProjection`

您可以通过 2 个不同的步骤处理您的查询：

使用返回对象列表的 Projections.SqlProjection 对 db 进行第一步查询

第二步迭代该列表以提取您需要的内容

# python - AttributeError：“DateTemplates”对象没有属性“_to_date”

> ID：15167921
> 
> 赞同：1
> 
> 时间：2013-03-01T22:27:55.863
> 
> 标签：python

[在这里](https://github.com/ceradon/cerabot-rewrite/blob/master/cerabot/tasks/date_templates.py)发布的代码，我试图编译程序，但每次我这样做都会给我这个回溯：

```
回溯（最近一次通话最后）：
  _run_module_as_main 中的文件“/usr/lib/python2.7/runpy.py”，第 162 行
    "__main__", fname, 加载器, pkg_name)
  _run_code 中的文件“/usr/lib/python2.7/runpy.py”，第 72 行
    run_globals 中的执行代码
  文件“/home/ceradon/cerabot-rewrite/cerabot/tasks/date_templates.py”，第 187 行，在
    机器人 = 日期模板（）
  文件“/home/ceradon/cerabot-rewrite/cerabot/tasks/date_templates.py”，第 19 行，在 __init__
    超级（日期模板，自我）.__init__（）
  __init__ 中的文件“cerabot/bot.py”，第 51 行
    self.setup()
  文件“/home/ceradon/cerabot-rewrite/cerabot/tasks/date_templates.py”，第 110 行，在设置中
    self._load_templates()
  _load_templates 中的文件“/home/ceradon/cerabot-rewrite/cerabot/tasks/date_templates.py”，第 61 行
    self._to_date.append(template.get(1).value.lower())
AttributeError：“DateTemplates”对象没有属性“_to_date”

```

我迷路了，有人可以帮忙解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:35:56.477

当您调用`super(DateTemplates, self).__init__()`this runs `Bot.__init__`which 调用`self.setup()`which runs`DateTemplates.setup()`时，这发生在您初始化之前`self._to_date`，因此还没有要附加的列表。将`super`调用`DateTemplates.__init__`移到方法的末尾，这应该可以工作。

# php - html5 Canvas 创建虚拟房间

> ID：15167924
> 
> 赞同：0
> 
> 时间：2013-03-01T22:28:14.440
> 
> 标签：php, javascript, jquery, html, canvas

我正在寻找可以将两个图像相互混合以创建动态环境的东西，请参见下面的示例： [http ://www.armstrong.com/flooring/design-a-room.asp?darScene=10&shortCode=&productCategory=](http://www.armstrong.com/flooring/design-a-room.asp?darScene=10&shortCode=&productCategory=)

我能够解码该方法。他们混合了这些图像，例如： [http ://www.armstrong.com/ei2/data/assets/Robbins/0557AW148630.jpg](http://www.armstrong.com/ei2/data/assets/Robbins/0557AW148630.jpg) [http://www.armstrong.com/ei2/data/images/room-scenes/RSX3050L_2A。 jpg](http://www.armstrong.com/ei2/data/images/room-scenes/RSX3050L_2A.jpg)

输出：[http ://www.armstrong.com/ei2/cgi-bin/Swatchbox.cgi?a=RenderImage%5Boutput=jpegstream%5D&v=1&i=data/images/room-scenes/RSEWE5205_2&o=data/out/&w= 530&h=4444&Floor=~stitch~data/assets/Robbins/0557AW148630~%5BSpecialStitch=randomOffset%5D%5BPPF=75%5D](http://www.armstrong.com/ei2/cgi-bin/Swatchbox.cgi?a=RenderImage%5Boutput=jpegstream%5D&v=1&i=data/images/room-scenes/RSEWE5205_2&o=data/out/&w=530&h=4444&Floor=~stitch~data/assets/Robbins/0557AW148630~%5BSpecialStitch=randomOffset%5D%5BPPF=75%5D)

这将是客户可以定制的整体网站体验的一部分。感觉这需要后端脚本，但如果可能的话，我想将其保留为 php/javascript/jquery。

我只找到了许多解决方案，这需要脚本在他们身边执行，这需要按月付费。这不是远程使用任何东西的选项。尽管如果产品的功能不受另一台服务器的限制，则可以选择为产品付费。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:32:34.627

好吧，如果你想做这样的事情，你可以去一些 html5 画布。

我做了一些非常相似的事情，我使用了 JCanvas。[http://calebevans.me/projects/jcanvas/index.php](http://calebevans.me/projects/jcanvas/index.php) 最好的部分是多层，以及在其中更改和控制 z-index 的能力。这样你就可以对不同的透明 png 进行分层，甚至可以移动它们。

# c# - 如何为 C# MVC4 WebAPI 应用程序全局记录所有异常？

> ID：15167927
> 
> 赞同：178
> 
> 时间：2013-03-01T22:28:27.573
> 
> 标签：c#, asp.net-web-api, error-handling

# 背景

我正在为客户端开发 API 服务层，并要求我在全局范围内捕获并记录所有错误。

因此，虽然像未知端点（或动作）这样的东西很容易通过使用 ELMAH 或添加类似这样的东西来处理`Global.asax`：

```
protected void Application_Error()
{
     Exception unhandledException = Server.GetLastError();
     //do more stuff
} 
```

. . .unhandled 与路由无关的错误不会被记录。例如：

```
public class ReportController : ApiController
{
    public int test()
    {
        var foo = Convert.ToInt32("a");//Will throw error but isn't logged!!
        return foo;
    }
} 
```

我还尝试`[HandleError]`通过注册此过滤器来全局设置属性：

```
filters.Add(new HandleErrorAttribute()); 
```

但这也不会记录所有错误。

# 问题/问题

如何拦截像`/test`上面调用产生的错误，以便我可以记录它们？似乎这个答案应该是显而易见的，但我已经尝试了到目前为止我能想到的一切。

理想情况下，我想在错误日志中添加一些内容，例如请求用户的 IP 地址、日期、时间等。我还希望能够在遇到错误时自动向支持人员发送电子邮件。只要我能在这些错误发生时拦截它们，我就能做到这一切！

# 解决！

感谢 Darin Dimitrov，我接受了他的回答，我明白了这一点。 *WebAPI处理**错误**的方式与常规 MVC 控制器不同。*

这是有效的：

1) 将自定义过滤器添加到您的命名空间：

```
public class ExceptionHandlingAttribute : ExceptionFilterAttribute
{
    public override void OnException(HttpActionExecutedContext context)
    {
        if (context.Exception is BusinessException)
        {
            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.InternalServerError)
            {
                Content = new StringContent(context.Exception.Message),
                ReasonPhrase = "Exception"
            });

        }

        //Log Critical errors
        Debug.WriteLine(context.Exception);

        throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.InternalServerError)
        {
            Content = new StringContent("An error occurred, please try again or contact the administrator."),
            ReasonPhrase = "Critical Exception"
        });
    }
} 
```

2) 现在在**WebApiConfig**类中全局注册过滤器：

```
public static class WebApiConfig
{
     public static void Register(HttpConfiguration config)
     {
         config.Routes.MapHttpRoute("DefaultApi", "api/{controller}/{action}/{id}", new { id = RouteParameter.Optional });
         config.Filters.Add(new ExceptionHandlingAttribute());
     }
} 
```

**或者**`[ExceptionHandling]`你可以跳过注册，只用属性装饰一个控制器。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2014-01-21T08:18:53.560

作为对先前答案的补充。

昨天，ASP.NET Web API 2.1 正式[发布](http://www.asp.net/web-api/overview/releases/whats-new-in-aspnet-web-api-21)。
它提供了另一个在全球范围内处理异常的机会。[样本](https://aspnet.codeplex.com/SourceControl/latest#Samples/WebApi/Elmah/ReadMe.txt)
中给出了详细信息。

简而言之，您添加全局异常记录器和/或全局异常处理程序（只有一个）。
您将它们添加到配置中：

```
public static void Register(HttpConfiguration config)
{
  config.MapHttpAttributeRoutes();

  // There can be multiple exception loggers.
  // (By default, no exception loggers are registered.)
  config.Services.Add(typeof(IExceptionLogger), new ElmahExceptionLogger());

  // There must be exactly one exception handler.
  // (There is a default one that may be replaced.)
  config.Services.Replace(typeof(IExceptionHandler), new GenericTextExceptionHandler());
} 
```

以及他们的实现：

```
public class ElmahExceptionLogger : ExceptionLogger
{
  public override void Log(ExceptionLoggerContext context)
  {
    ...
  }
}

public class GenericTextExceptionHandler : ExceptionHandler
{
  public override void Handle(ExceptionHandlerContext context)
  {
    context.Result = new InternalServerErrorTextPlainResult(
      "An unhandled exception occurred; check the log for more information.",
      Encoding.UTF8,
      context.Request);
  }
} 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2013-03-01T22:45:46.377

~~如果您的 Web API 托管在 ASP.NET 应用程序中，`Application_Error`则将为代码中所有未处理的异常调用该事件，包括您显示的测试操作中的异常。所以你所要做的就是在 Application_Error 事件中处理这个异常。在您展示的示例代码中，您只处理类型的异常，`HttpException`这显然不是`Convert.ToInt32("a")`代码的情况。因此，请确保您在其中记录并处理所有异常：~~

 ~~```
protected void Application_Error()
{
    Exception unhandledException = Server.GetLastError();
    HttpException httpException = unhandledException as HttpException;
    if (httpException == null)
    {
        Exception innerException = unhandledException.InnerException;
        httpException = innerException as HttpException;
    }

    if (httpException != null)
    {
        int httpCode = httpException.GetHttpCode();
        switch (httpCode)
        {
            case (int)HttpStatusCode.Unauthorized:
                Response.Redirect("/Http/Error401");
                break;

            // TODO: don't forget that here you have many other status codes to test 
            // and handle in addition to 401.
        }
        else
        {
            // It was not an HttpException. This will be executed for your test action.
            // Here you should log and handle this case. Use the unhandledException instance here
        }
    }
} 
```~~  ~~Web API 中的异常处理可以在各个级别完成。以下是[`detailed article`](http://weblogs.asp.net/fredriknormen/archive/2012/06/11/asp-net-web-api-exception-handling.aspx)对不同可能性的解释：

*   可以注册为全局异常过滤器的自定义异常过滤器属性

    ```
    [AttributeUsage(AttributeTargets.All)]
    public class ExceptionHandlingAttribute : ExceptionFilterAttribute
    {
        public override void OnException(HttpActionExecutedContext context)
        {
            if (context.Exception is BusinessException)
            {
                throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.InternalServerError)
                {
                    Content = new StringContent(context.Exception.Message),
                    ReasonPhrase = "Exception"
                });
            }

            //Log Critical errors
            Debug.WriteLine(context.Exception);

            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.InternalServerError)
            {
                Content = new StringContent("An error occurred, please try again or contact the administrator."),
                ReasonPhrase = "Critical Exception"
            });
        }
    } 
    ```

*   自定义动作调用者

    ```
    public class MyApiControllerActionInvoker : ApiControllerActionInvoker
    {
        public override Task<HttpResponseMessage> InvokeActionAsync(HttpActionContext actionContext, System.Threading.CancellationToken cancellationToken)
        {
            var result = base.InvokeActionAsync(actionContext, cancellationToken);

            if (result.Exception != null && result.Exception.GetBaseException() != null)
            {
                var baseException = result.Exception.GetBaseException();

                if (baseException is BusinessException)
                {
                    return Task.Run<HttpResponseMessage>(() => new HttpResponseMessage(HttpStatusCode.InternalServerError)
                    {
                        Content = new StringContent(baseException.Message),
                        ReasonPhrase = "Error"

                    });
                }
                else
                {
                    //Log critical error
                    Debug.WriteLine(baseException);

                    return Task.Run<HttpResponseMessage>(() => new HttpResponseMessage(HttpStatusCode.InternalServerError)
                    {
                        Content = new StringContent(baseException.Message),
                        ReasonPhrase = "Critical Error"
                    });
                }
            }

            return result;
        }
    } 
    ```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-10-30T11:38:01.543

为什么要重新抛出等？这有效，它将使服务返回状态 500 等

```
public class LogExceptionFilter : ExceptionFilterAttribute
{
    private static readonly ILog log = LogManager.GetLogger(typeof (LogExceptionFilter));

    public override void OnException(HttpActionExecutedContext actionExecutedContext)
    {
        log.Error("Unhandeled Exception", actionExecutedContext.Exception);
        base.OnException(actionExecutedContext);
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-01T22:41:44.230

你有没有想过做一些像处理错误动作过滤器这样的事情

```
[HandleError]
public class BaseController : Controller {...} 
```

您还可以创建一个自定义版本， `[HandleError]`您可以使用该版本编写错误信息和所有其他详细信息以记录

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-01T22:37:12.067

将整个事情包装在 try/catch 中并记录未处理的异常，然后将其传递。除非有更好的内置方法来做到这一点。

这是一个参考[Catch All (handled or unhandled) Exceptions](https://stackoverflow.com/questions/2780324/catch-all-handled-or-unhandled-exceptions)

（编辑：哦 API）~~

# python - 在 matplotlib 中实现水平线图

> ID：15167928
> 
> 赞同：10
> 
> 时间：2013-03-01T22:28:26.900
> 
> 标签：python, matplotlib

我正在尝试在 matplotlib 中实现地平线图（参见：[http](http://square.github.com/cubism/) ://square.github.com/cubism/ ）

基本思想是您以窄纵横比显示时间序列，并且随着值的增加（超出 y 轴限制），它们从底部以较深的颜色开始（想想旧的 Atari 游戏）越过屏幕顶部并在底部弹出）。

我的基本方法是将 y 数据分成卡盘，并使用`ax.twinx()`和设置适当的限制在新轴上绘制每个垂直组。

仅对于正面或负面数据，这似乎运作良好。

积极的：

![积极的地平线图](../Images/448a80d6e7c5382af444a7df56adf1bb.png)

消极的：

![负条形图](../Images/974ca0c4e8374162ac51501f9ea630c3.png)

但由于某种原因，两者都搞砸了：

```
# setup the environment
import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(0, np.pi*4, 137)
y = (2*np.random.normal(size=137) + x**2)

# reflect everything around the origin
xx = np.hstack([-1*x[::-1], x])
yy = np.hstack([-1*y[::-1], y])

# function to do the plot
def horizonPlot(ax, x, y, nfolds=3, inverty=False, color='CornflowerBlue'):
    axes = [ax]
    if inverty:
        ylims = np.linspace(y.min(), y.max(), nfolds + 1)[::-1]
    else:
        ylims = np.linspace(y.min(), y.max(), nfolds + 1)

    for n in range(1, nfolds):
        newax = axes[-1].twinx()
        axes.append(newax)

    for n, ax in enumerate(axes):        
        ax.fill_between(x, y, y2=ylims[n], facecolor=color, alpha=1.0/nfolds, zorder=n)
        ax.set_ylim([ylims[n], ylims[n+1]])
        ax.set_yticklabels([])
        ax.set_yticks([])

        if inverty:
            ax.invert_yaxis()

    ax.set_xlim([x.min(), x.max()])
    return fig

fig, baseax = plt.subplots(figsize=(6.5,1.5))
posax = baseax.twinx()
negax = posax.twinx()
fig = horizonPlot(posax, xx, np.ma.masked_less(yy, 0), inverty=False, color='DarkGreen')
fig = horizonPlot(negax, xx, np.ma.masked_greater(yy, 0), inverty=True,   color='CornflowerBlue')
for ax in fig.get_axes():
    ax.set_yticklabels([])

fig.tight_layout()
plt.show() 
```

糟糕的图表（注意正面缺少多层）：

![两个地平线图](../Images/98aa0e9647c905301703f1521ed268fc.png)

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T01:06:26.087

我实际上不知道，为什么你的不工作，因为在我的电脑上它工作正常。但由于我对这个绘图真的很感兴趣，所以我尝试在没有这些花哨的`twinx`东西的情况下自己实现它。

我只是将这些区域绘制在彼此之上，因为这实际上是情节的伟大之处。因此我不需要调整 alpha，它们只是加起来。

```
import numpy as np
from matplotlib.pyplot import *

def layer(y,height):
    neg=0.0;pos=0.0
    if y>0:
        if y-height>=0:
            pos=height
            y-= pos
        else : 
            pos = y
    elif y<0:
        if y+height<=0:
            neg=height
            y += neg
        else : 
            neg = -y
    return pos,neg

def horizonPlot(x,y,height=50.0,colors=['CornflowerBlue','DarkGreen']):
    alpha = .10
    vlayer = np.vectorize(layer)
    while (y != 0).any():
        l = vlayer(y,height)
        y -= l[0];y += l[1]
        fill_between(x,0,l[0],color=colors[0], alpha=alpha)
        fill_between(x,height-l[1],height,color=colors[1], alpha=alpha)

def main():
    x = np.linspace(0, np.pi*4, 137)
    y = (2*np.random.normal(size=137) + x**2)
    xx = np.hstack([-1*x[::-1], x])
    yy = np.hstack([-1*y[::-1], y])
    horizonPlot(xx,yy)
    show() 
```

这在我的机器上如下所示。希望它适用于你，但我只使用基本的绘图方法。

![在此处输入图像描述](../Images/ebd941f54ef0b5e1eee115ee84b5cbce.png)

# android - 如何在没有屏幕的情况下启动android

> ID：15167930
> 
> 赞同：6
> 
> 时间：2013-03-01T22:28:40.587
> 
> 标签：android

我想将 android 手机转换为具有特殊用途的设备。首先，我需要卸下 LCD 屏幕。但是当我移除 LCD 时，android 无法启动。所以，我需要启动 android 但没有屏幕。

我认为需要修复android的源代码（可能是init.rc），但是 现在查看这个页面： [http](http://www.androidenea.com/2009/06/android-boot-process-from-power-on.html)
://www.androidenea.com/2009/06/android-boot-process-from-power-on.html我有一个疑问，负责检查屏幕连接的模块不在android的源代码上，而是在引导加载程序上，我不确定:(

有人知道我需要为我的目的修复的代码在哪里？请... :D

# javascript - 快速调整大画布元素的大小

> ID：15167940
> 
> 赞同：0
> 
> 时间：2013-03-01T22:29:27.407
> 
> 标签：javascript, html5-canvas

我制作了一个窗口大小的画布元素并用随机值填充它（这样我可以很容易地看到它更新）。它会在窗口使用时调整大小，`<body onresize="updateCanvas();">`而且速度很慢。这就是它的样子还是有更好的方法来做到这一点？

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Window Sized Canvas</title>
    <!-- <link href="style.css" rel="stylesheet" type="text/css"/>
    Relevant style below: -->
    <style type="text/css">
        body {margin:0; padding:0;}
        canvas {display:block;}
    </style>
</head>
<body onresize="updateCanvas();">
    <canvas id="hCanvas">Your browser does not support the canvas tag</canvas>
    <script type="text/javascript">
        var jCanvas = document.getElementById("hCanvas");
        var jc2D = jCanvas.getContext("2d");

        updateCanvas();
        function updateCanvas() {
            jCanvas.width = window.innerWidth;
            jCanvas.height = window.innerHeight;            
            var jcW = jCanvas.width;
            var jcH = jCanvas.height;
            var jcWH4 = (jcW*jcH)<<2;
            var jcImageData = jc2D.createImageData(jcW, jcH);
            for (i = 0; i < jcWH4; i += 4) {
                jcImageData.data[i] = (Math.random()*255)|0;
                jcImageData.data[i+1] = (Math.random()*255)|0;
                jcImageData.data[i+2] = (Math.random()*255)|0;
                jcImageData.data[i+3] = 255;
            }
            jc2D.putImageData(jcImageData, 0, 0);
        }
    </script>
</body>
</html> 
```

**编辑**：我发现了一些很好的限制代码`onresize()`。我将发布与上面不同的内容：

```
...
<body onresize="resizeTimer();">
...
var resizeDelay;
function resizeTimer() {
    clearTimeout(resizeDelay);
    resizeDelay = setTimeout("updateCanvas()", 200);
}
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T23:32:15.787

**这种方法比您当前的方法快得多！**

而不是每次调整大小都重新创建随机模式：

1.  启动时，在隐藏的画布（缓冲区）上保存**一次**随机模式。

2.  然后 onresize 可以将该缓冲区绘制到调整大小的窗口上。

这是代码：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Window Sized Canvas</title>
    <!-- <link href="style.css" rel="stylesheet" type="text/css"/>
    Relevant style below: -->
    <style type="text/css">
        body {margin:0; padding:0;}
        canvas {display:block;}
    </style>
</head>
<body onresize="updateCanvas();">
    <canvas id="canvas">Your browser does not support the canvas tag</canvas>
    <script type="text/javascript">
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext("2d");

        var jCanvas;
        BufferCanvas();
        updateCanvas();

        function updateCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight; 
            ctx.drawImage(jCanvas,0,0,jCanvas.width,jCanvas.height,0,0,canvas.width,canvas.height);
        }

        function BufferCanvas() {
            jCanvas = document.createElement("canvas");
            var jc2D = jCanvas.getContext("2d");
            jCanvas.width = window.innerWidth;
            jCanvas.height = window.innerHeight;            
            var jcW = 1920; // or your max window size
            var jcH = 1080;
            var jcWH4 = (jcW*jcH)<<2;
            var jcImageData = jc2D.createImageData(jcW, jcH);
            for (i = 0; i < jcWH4; i += 4) {
                jcImageData.data[i] = (Math.random()*255)|0;
                jcImageData.data[i+1] = (Math.random()*255)|0;
                jcImageData.data[i+2] = (Math.random()*255)|0;
                jcImageData.data[i+3] = 255;
            }
            jc2D.putImageData(jcImageData, 0, 0);
        }

    </script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:53:12.363

无论如何，用精确确定的像素值重绘画布会很慢。一个大小合适的屏幕有很多像素，需要花时间盯着每个像素，然后决定如何用 JavaScript 绘制它。

可能最简单的做法就是使用 CSS 来放大和缩小画布。这是相当快的，因为它依赖于计算机上强大的内置图像缩放功能。你不会每次都得到新的重新计算，但只要这不重要，它就会很快。[这是 this 的一个实现](http://jsbin.com/ajanus/1/edit)。画布上的“高度”和“宽度”属性会影响渲染区域的大小（以像素为单位），而*样式*属性“高度”和“宽度”会影响画布占用的区域，而不会修改您必须绘制的像素数和。

详细说明：如果您在不重绘任何内容的情况下增加画布的基于属性的大小，您会注意到之前的图像将保持不变；所发生的只是你在画布上添加了一些空白区域。但是，如果您只是更改样式，画布将变为您告诉它的大小，但它可能看起来有颗粒感，即使画布上的所有内容理论上都可以在该大小下保持高分辨率。

这确实会在您正在处理的图像中产生一些奇怪的伪影，但没有简单的方法可以解决这个问题。您可以做的一件事是默认情况下在画布大小发生变化时使用 CSS，但在调整大小完成后，使用新的更高分辨率模式重绘。如果您决定走这条路并需要任何帮助，请告诉我。

# html - div表中的单元格间距

> ID：15167943
> 
> 赞同：3
> 
> 时间：2013-03-01T22:29:32.587
> 
> 标签：html, css, css-tables

我希望每个单元格之间有 4 个左右的像素空间。我希望灰色标题有空格而不是灰色块。我试着玩弄（背景剪辑：填充框；填充：14像素；边距等），但不知道如何在 div 表中的单元格之间放置几个像素。我该怎么做呢？

问题演示[http://jsfiddle.net/EJBnm/](http://jsfiddle.net/EJBnm/)

```
<div class="TableBox">
    <div>
        <div>Head</div> <div>Bigger Head</div> <div>Medium</div>
    </div>
    <div>
        <div>First</div> <div>Second</div> <div>Third</div>
    </div>
    <div>
        <div>First</div> <div>Second</div> <div>Third</div>
    </div>
    <div>
        <div>First</div> <div>Second</div> <div>Third</div>
    </div>
</div> 
```

CSS：

```
.TableBox {display: table;}
.TableBox > div {display: table-row; border-spacing: 5px}
.TableBox > div >div {display: table-cell;  margin: 4px;}
.TableBox > div:nth-child(even){ color: red; }
.TableBox > div:nth-child(1){  background-color: #666666; color:white; border-spacing: 15px; background-clip:padding-box; padding: 14px; margin:0 20px} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T22:32:28.513

添加`border-spacing: 4px;`到您的`.TableBox`班级而不是您的`<tr>`

小提琴：http: [//jsfiddle.net/EJBnm/1/](http://jsfiddle.net/EJBnm/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:34:35.007

您可以使用透明（或白色边框）而不是边距：http: [//jsfiddle.net/jfsWc/](http://jsfiddle.net/jfsWc/)

```
.TableBox > div >div {display: table-cell;  border:4px solid transparent} 
```

# javascript - Salesforce 中的 JavaScript 自定义按钮

> ID：15167951
> 
> 赞同：0
> 
> 时间：2013-03-01T22:30:19.527
> 
> 标签：javascript, salesforce

我在 Salesfoce 的标准布局上创建了一个自定义按钮，它调用顶点代码来调用 java web 服务。现在的问题是，一旦用户单击按钮，我应该禁用该按钮，或者我应该模糊屏幕，直到我处理请求。如何使用 JavaScript 实现此功能？任何示例将不胜感激。

非常感谢各位

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:49:15.763

您正在调用的函数将有权访问代表被单击按钮的“this”变量。

您可以先在下面测试代码，然后再将其添加到您的按钮。例如，在“编辑”页面的 JavaScript 控制台中尝试

```
var fakeThis = document.getElementsByName('save')[0];
var oldValue = this.value;
fakeThis.setAttribute('class', 'btnDisabled');
fakeThis.value = 'Processing...';
fakeThis.disabled = true; 
```

'btnDisabled' 类使 Salesforce 按钮显示为灰色和“扁平”（按下）。完成后 - 恢复旧值

```
fakeThis.setAttribute('class', 'btn');
fakeThis.value = oldValue;
fakeThis.disabled = false; 
```

# android - 有条不紊地关闭后为Android重新启动一个线程

> ID：15167954
> 
> 赞同：0
> 
> 时间：2013-03-01T22:30:44.347
> 
> 标签：android, multithreading

我有这样的声明：

```
// Background doer  
Thread BgThread = new Thread() {

  @Override 
  public void run() {
    aBgCounter = 0 ;
    boolean stopNow = false ;

    try {
      while( !stopNow ) {
        sleep( 1000 ) ;
        WriteOnThatLogCat( "BgThread " + String.valueOf( aBgCounter ) ) ;
        aBgCounter++ ;
          if( aBgCounter > 12 ) stopNow = true ;
      }
    } catch (InterruptedException e) {
      e.printStackTrace() ;
    }
  }
}; 
```

当它完成时，它像这样成功调用（只计数到 12 到 logcat 中）。该过程正确死亡。它是这样开始的：

```
WriteOnThatLogCat("Issue BgThread.start() from 6") ;
BgThread.start() ; 
```

这当然只是更多涉及的流量控制。无论如何，稍后程序决定再次做同样的事情，并想再次调用线程。我读到线程不能重用，但我真的希望能够重用标识符等，可以调用很多线程来做特定的事情，自己生死并被重用。我试过 = NULL 和各种各样的东西。我怎样才能修改上面的一些片段，如：

```
WriteOnThatLogCat("Issue BgThread.start() from 6") ;
BgThread.start() ; 
```

可以得到一个新线程并随时做它的事情吗？我认为让每种线程作为目标进程都必须休眠并尝试重新启动自己是无序的，似乎正确的方法是让它做自己的事情并杀死自己，然后在需要时重新制作。我很惊讶我对这件事如此迷失。

谢谢丹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:10:53.280

另一种方法是使用 Android 的结构来“循环”线程。有关介绍，请参阅 [进程和线程](http://developer.android.com/guide/components/processes-and-threads.html)。[Handler](http://developer.android.com/reference/android/os/Handler.html)类的 javadoc向您展示了如何运行一个循环的线程，从消息队列中获取信息。

另一种选择，也是您真正应该考虑的一种选择是使用[IntentService](http://developer.android.com/reference/android/app/IntentService.html)。

# highcharts - 在 HighChart (Scattar ) 中添加动态数据时，现有数据被随机删除

> ID：15167960
> 
> 赞同：0
> 
> 时间：2013-03-01T22:31:36.877
> 
> 标签：highcharts

使用 Highchart 将数据动态添加到散点图时，有没有办法防止已经渲染的数据点随机消失？我只希望超出当前 x 轴限制的数据点消失。

`look at my code here` [我的小提琴](http://jsfiddle.net/zpDPd/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T09:22:24.990

您可以在 random() 函数中检查点是否存在于序列/数据中。

[http://jsfiddle.net/zpDPd/1/](http://jsfiddle.net/zpDPd/1/)

```
var series = chart.series; 
```

然后你应该迭代每个系列和每个点并检查点是否是。

# jquery-mobile - jQuery Mobile 响应式面板关闭问题

> ID：15167964
> 
> 赞同：2
> 
> 时间：2013-03-01T22:32:08.230
> 
> 标签：jquery-mobile, panel

在 jQuery Mobile 1.3.0 中可以使用响应式面板。除了“在宽屏上禁用关闭”功能外，它几乎功能齐全。

索引.html

```
<body>

        <div id="indexPage" data-role="page" data-theme="a" class="ui-responsive-panel">

            <!-- left panel  -->
            <div data-role="panel" id="panelMenuIndex" data-theme="b" data-position="left" data-display="reveal" data-dismissible="true" data-position-fixed="true" data-swipe-close="false">
                <ul id="panelListIndex" data-theme="b" data-role="listview"></ul>
            </div><!-- /panel -->

            <!-- right panel  -->
            <div data-role="panel" id="panelRightMenuIndex" data-theme="b" data-position="right" data-display="overlay" data-dismissible="true" data-position-fixed="true" data-swipe-close="false">
                <ul id="panelRightListIndex" data-theme="b" data-role="listview"></ul>
            </div><!-- /panel -->

            <div data-role="header" data-tap-toggle="false" data-position="fixed" data-theme="a">
                <div>
                    <p class="headerBarText"><img id="headerTitleIndex" onclick="togglePanel('#panelMenu' + window.divIdGlobal);" class="headerIconTitle" src="images/icons/ic_launcher_full_arrow.png" /><img id="headerShareIndex" onclick="share(window.shareTagSubject,window.shareTagText);" class="headerIconShare" src="images/icons/ic_action_share.png" /><img id="headerOverflowIndex" onclick="togglePanel('#panelRightMenu' + window.divIdGlobal);" class="headerIconOverflow" src="images/icons/ic_action_overflow.png" />
                    &nbsp;</p>
                </div>
            </div><!-- /header -->

            <div data-role="content" data-theme="a">

                <h1>My favorite wallpapers</h1>

                <div id="wpFavoriteImage"></div>

            </div><!-- /content -->

        </div><!-- /page -->
    </body> 
```

样式表部分：

```
@media (min-width:35em){
    /* wrap on wide viewports once open */
    .ui-responsive-panel.ui-page-panel-open .ui-panel-content-fixed-toolbar-display-push.ui-panel-content-fixed-toolbar-position-left,
    .ui-responsive-panel.ui-page-panel-open .ui-panel-content-fixed-toolbar-display-reveal.ui-panel-content-fixed-toolbar-position-left,
    .ui-responsive-panel.ui-page-panel-open .ui-panel-content-wrap-display-push.ui-panel-content-wrap-position-left,
    .ui-responsive-panel.ui-page-panel-open .ui-panel-content-wrap-display-reveal.ui-panel-content-wrap-position-left {
        margin-right: 17em;
    }
    .ui-responsive-panel.ui-page-panel-open .ui-panel-content-fixed-toolbar-display-push.ui-panel-content-fixed-toolbar-position-right,
    .ui-responsive-panel.ui-page-panel-open .ui-panel-content-fixed-toolbar-display-reveal.ui-panel-content-fixed-toolbar-position-right,
    .ui-responsive-panel.ui-page-panel-open .ui-panel-content-wrap-display-push.ui-panel-content-wrap-position-right,
    .ui-responsive-panel.ui-page-panel-open .ui-panel-content-wrap-display-reveal.ui-panel-content-wrap-position-right {
        margin-left: 17em;
    }
    .ui-responsive-panel.ui-page-panel-open .ui-panel-content-fixed-toolbar-display-push,
    .ui-responsive-panel.ui-page-panel-open .ui-panel-content-fixed-toolbar-display-reveal {
        width: auto;    
    }
    /* disable "dismiss" on wide viewports */
    .ui-responsive-panel .ui-panel-dismiss-display-push {
        display: none;
    } 
} 
```

同样，当使用上面的 CSS 时，看到内容正在更宽的屏幕上进行调整（例如，我的平板电脑，这样就可以了），但没有禁用点击关闭 (data-dismissible="true")（通过显示：没有任何;）。这导致当面板打开时，如果面板没有关闭，我就无法“使用”内容。

我搜索了互联网并查看了 jQuery 的 Github，但没有找到任何已知的错误或解决方案。

jQuery（移动）框架和 css 文件加载到我的 html 文件的标题中。面板中的内容是动态添加的，后跟： $('#panelMenuInde​​x').trigger("updatelayout"); 和 $('#panelRightMenuInde​​x').trigger("updatelayout");。内容和面板显示得很好。

谁能指点我一个方向？

也试过：

```
 /* disable "dismiss" on wide viewports */
.ui-responsive-panel.ui-panel-dismiss-display-reveal {
    display: none;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T20:37:59.273

我最终设法让这个工作。

关键是 CSS 类“ui-panel-dismiss-display- **push** ”，它仅适用于面板上的 data-display 属性为“push”的情况。

在您的情况下，将 CSS 文件更新为具有“ui-responsive-panel ui-panel-dismiss-display- **reveal** ”类，以及“display:none;” 它应该可以工作。

# ios - 来自 PFObject 的 NSArray 值

> ID：15167968
> 
> 赞同：0
> 
> 时间：2013-03-01T22:32:23.853
> 
> 标签：ios, parse-platform

如何从保存的 PFOBject 中加载 NSArray 值？

节省：

```
NSMutableArray *arr = [[NSMutableArray alloc]init];

   for (MyParseInformation *obj in results) {
       [arr addObject:obj.correct]; // correct is NSNumber
    }
    [pfobject addObject:arr forKey:@"results"];
}

[pfobject saveEventually:^(BOOL succeeded, NSError *error) { 
```

询问：

```
PFQuery *query = [PFQuery queryWithClassName:className];
[query findObjectsInBackgroundWithBlock:^(NSArray *objects, NSError *error) {
    if(!error){
         for (PFObject *obj in objects) {

            id str = [obj valueForKey:@"results"] ; 
```

...... id 是`__NSArrayM`count=1 的类型类，它的内容是：

```
(
        (
        1,
        1,
        1,
        1,
        1,
        1,
        0,
        0,
        0,
        1,
        1,
        1,
        0,
        1
    )
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:40:47.430

您的`str`对象是一个`NSArray*`包含一个对象的对象，该对象本身就是`NSArray*`您想要的值。

我不熟悉，`PFObject`但我猜想`-addObject:forKey:`存储添加到与键关联的数组中的对象。由于您只添加了一个对象，因此结果数组中只有一个值。您可能想`-setObject:forKey:`改用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T00:08:33.170

凯文是正确的。-[PFObject addObject:forKey:] 用于将新元素插入到数组键中。这意味着您将数组插入到数组中。addObject:forKey: 当该对象的键可能受到竞争条件影响时很有用，即如果您在论坛对象上有一个评论数组，`[post addObject:aComment forKey:@"comments"]`确保当两个客户竞相更改 @"comments" 的值时将保存所有评论. 如果我做了类似的事情，情况就不会如此`[post setObject:@[aComment] forKey:@"comments"]`。

您可以将代码编写为：

```
for (MyParseInformation *obj in results) {
   [pfobject addObject:obj.correct]; // correct is NSNumber
} 
```

但在您的情况下，将您的 addObject:forKey: 行替换为 setObject:forKey: 可能同样容易：

# php - 如何正确编码指向 JSON 的链接？

> ID：15167971
> 
> 赞同：1
> 
> 时间：2013-03-01T22:32:45.733
> 
> 标签：php, json

**有人可以帮我将 JSON 语法的链接编码为 php 字符串变量吗？** 要编码的 url（链接包含匈牙利字符，如 é）：

```
<a href='http://www.szerelmifajdalomklinika.hu/kapcsolati-kerdoiv/?partner_id=100'>Kérdőív kitöltése</a> 
```

它与以下 php 代码一起使用：

```
$user_survey='"\u003ca href=\"http://www.szerelmifajdalomklinika.hu/kapcsolati-kerdoiv/?partner_id=100\"\u003eKérdőív kitöltése\u003c/a\u003e"';

echo json_encode(array(
        'user_id' => $user_id,
    'partner_id' => mysql_insert_id(),
    'partner_nickname' => $partner_nickname,
    'partner_description' => $partner_description,
    'real_partner_id' => $real_partner_id,
    'partner_survey' => $user_survey
));

?> 
```

它在其他地方提供表格内容。这运行不正确，因为链接，或者实际上任何文本都没有出现在合作伙伴调查部分。

请注意，上面的代码适用于简单的字符串，例如`$partner_survey="test";`或`$partner_survey="test with some hun chars: ééóóúúűű";`正常运行。

以下链接用于生成和验证编码： [http](http://edtracks.com/toolkit/decoder-encoder-json-html-url/) ://edtracks.com/toolkit/decoder-encoder-json-html-url/ ，

[http://json.parser.online.fr/](http://json.parser.online.fr/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:38:59.347

JSON 要求字符串是 UTF8 编码的。我个人使用这些功能：

```
function getjson($json) {
    $j = json_decode($json,true);
    if( !$j) $j = Array();
    array_walk_recursive($j,function(&$a) {if(is_string($a)) $a = utf8_decode($a);});
    return $j;
}
function setjson($json) {
    array_walk_recursive($json,function(&$a) {if(is_string($a)) $a = utf8_encode($a);});
    $j = json_encode($json);
    return $j;
} 
```

尽管您应该注意到这些非常专门处理 JSON 编码的数组。它们适用于这种特殊情况，但请记住这一点，以便更广泛地使用。

旁注：您可以确定 UTF8 是否是问题，如下所示：

```
// after attempting to json_encode data:
if( json_last_error() == JSON_ERROR_UTF8) echo "ERROR: Invalid encoding"; 
```

# knockout.js - 有人知道淘汰邮箱库的IE8兼容性吗

> ID：15167972
> 
> 赞同：1
> 
> 时间：2013-03-01T22:32:49.660
> 
> 标签：knockout.js, knockout-2.0

淘汰邮箱是否适用于 Internet Explorer 8 或 7？可以对库进行哪些更新以使其与 Internet Explorer 8 和 7 兼容？

[淘汰赛]（[http://www.knockmeout.net/2012/05/using-ko-native-pubsub.html](http://www.knockmeout.net/2012/05/using-ko-native-pubsub.html)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:02:01.237

`ko.postbox`uses `ko.toJSON`which uses which uses which are `JSON.stringify`not available in旧浏览器。

您还需要包含`json2.js` [脚本](https://github.com/douglascrockford/JSON-js)以添加此功能。

不过，这应该已经在 IE8 中工作了。它只是 IE7 还是您在 IE8 中看到了什么错误？

# c# - 不实现继承的抽象成员

> ID：15167974
> 
> 赞同：2
> 
> 时间：2013-03-01T22:33:06.843
> 
> 标签：c#, .net, visual-studio, windows-phone-8

我正在将一个项目从 c# for desktop、.net framework v4.5 移动到 Windows Phone 8。但是我现在遇到了这个错误和两个类似的错误。

“ `Downloader.Convertors.PaginatedListConvertor<T>`”未实现继承的抽象成员“ `Newtonsoft.Json.JsonConverter.ReadJson(Newtonsoft.Json.JsonReader, System.Type, object, Newtonsoft.Json.JsonSerializer)`”

出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:52:53.347

`Downloader.Convertors.PaginatedListConvertor<T>`如果您不想在此类中实现某些方法，我认为您需要将其标记为抽象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:38:36.127

我冒险猜测在 NewtonSoft 代码的某个地方，有这样的指令：

```
#if NET40
// an implementation of those methods
#endif 
```

不知道你会如何解决它，除了：

*   看看他们是否有 windows phone 8 版本
*   实现缺失的方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-22T00:42:53.330

该特定错误中的参数列表表示您应该在覆盖方法中具有的参数。您可能与您的覆盖方法代码存在差异。

您可能将引用的 DLL 从 .NET 3.5 升级到 .NET 4.0（或 .NET 4.5）。因为方法的签名改变了，你需要在你的覆盖方法中更新你的参数列表。执行此操作时，请始终查看升级的执行摘要，或者如果您引用的 DLL 发生更改，请查看引用的 DLL 中使用的任何特定源代码。.NET Reflections 是这个活动的一个很好的工具。它可以对您引用的 DLL 进行反向工程，因此您可以查看源代码。在您的情况下，他们提供源代码。 [http://json.codeplex.com/SourceControl/latest#readme.txt](http://json.codeplex.com/SourceControl/latest#readme.txt)

原来的：

```
 public override object ReadJson(JsonReader reader, Type objectType)
    {
        throw new NotImplementedException();
    } 
```

新的：

```
 public override object ReadJson(JsonReader reader, Type objectType, Object obj, JsonSerializer serializer)
    {
        throw new NotImplementedException();
    } 
```

# java - 无法读取对 ACM mouseMoved 方法的调用

> ID：15167978
> 
> 赞同：1
> 
> 时间：2013-03-01T22:33:28.387
> 
> 标签：java

我正在完成斯坦福 CS106A 讲座，并在突破性项目中遇到了障碍。

在 I 之后`addMouseListeners()`，我无法检测到 mouseMoved 调用。但是，如果我重命名`mouseMoved()`为`mouseDragged()`or`mouseClicked()`或`mousePressed()`等，它都会正确更新。只有移动的方法不起作用。没有错误或警报，只是没有检测到正在移动的鼠标。知道为什么会这样吗？

```
public void run() {
    /* Add a listener for the mouse */
    addMouseListeners();
    label = new GLabel("Mouse x & y");
    add(label, 50, 50);

    /* Load the method to create the brick pattern */
    createBricks();
}

/** Detect a mouse move and update something */
public void mouseMoved(MouseEvent e){
    label.setLabel("Mouse: " + e.getX() + " , " + e.getY());
    paddle.setLocation(e.getX(), getHeight()-PADDLE_Y_OFFSET);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T21:24:55.237

你需要使用`addMouseMotionListeners();`. `addMouseListeners`仅适用于您正在使用的功能。

# firebase - 如何通过电子邮件和密码使用 Firebase 简单登录

> ID：15167981
> 
> 赞同：32
> 
> 时间：2013-03-01T22:33:36.023
> 
> 标签：firebase, firebase-security

Firebase 简单登录提供了[电子邮件/密码](https://www.firebase.com/docs/security/simple-login-email-password.html)选项，我该如何使用它？从创建用户开始，为该用户存储数据，再到登录和注销。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-03-01T22:33:36.023

需要执行三个不同的步骤（假设您有 jQuery）：

**1\. 设置您的回拨**

```
var ref = new Firebase("https://demo.firebaseio-demo.com");
var authClient = new FirebaseAuthClient(ref, function(error, user) {
  if (error) {
    alert(error);
    return;
  }
  if (user) {
    // User is already logged in.
    doLogin(user);
  } else {
    // User is logged out.
    showLoginBox();
  }
}); 
```

**2\. 用户注册**

```
function showLoginBox() {
  ...
  // Do whatever DOM operations you need to show the login/registration box.
  $("#registerButton").on("click", function() {
    var email = $("#email").val();
    var password = $("#password").val();
    authClient.createUser(email, password, function(error,  user) {
      if (!error) {
        doLogin(user);
      } else {
        alert(error);
      }
    });
  });
} 
```

**3.用户登录**

```
function showLoginBox() {
  ...
  // Do whatever DOM operations you need to show the login/registration box.
  $("#loginButton").on("click", function() {
    authClient.login("password", {
      email: $("#email").val(),
      password: $("#password").val(),
      rememberMe: $("#rememberCheckbox").val()
    });
  });
} 
```

登录成功完成后，将使用正确的用户对象调用您在步骤 1 中注册的调用，此时我们调用`doLogin(user)`您必须实现的方法。

用户数据的结构非常简单。它是一个包含以下属性的对象：

`email`: 用户的电子邮件地址 : 用户的 `id`唯一数字（自动递增）ID

FirebaseAuthClient 将自动为您验证您的 firebsae，无需进一步操作。您现在可以在安全规则中使用类似以下内容：

```
{
  "rules": {
    "users": {
      "$userid": {
        ".read": "auth.uid == $userid",
        ".write": "auth.uid == $userid"
      }
    }
  }
} 
```

`example.firebaseio-demo.com/users/42`这意味着，如果我的用户 ID 是 42，那么只有我可以在- 当我登录时 -写或读- 而没有其他人。

请注意，除了用户的 ID 和电子邮件之外，简单登录不会存储有关用户的任何其他信息。如果你想存储关于用户的额外数据，你必须自己做（可能在成功回调中`createUser`）。您可以像通常在 Firebase 中存储任何数据一样存储这些数据 - 只需注意谁可以读取或写入这些数据！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-05-04T03:11:00.337

以防有人访问此线程并寻找一些使用 firebase 身份验证的示例应用程序。这里有两个例子

```
var rootRef = new Firebase('https://docs-sandbox.firebaseio.com/web/uauth');
......
.....
.... 
```

[http://jsfiddle.net/firebase/a221m6pb/embedded/result,js/](http://jsfiddle.net/firebase/a221m6pb/embedded/result,js/)

[http://www.42id.com/articles/firebase-authentication-and-angular-js/](http://www.42id.com/articles/firebase-authentication-and-angular-js/)

# facebook - FQL 的结果不正确/不完整

> ID：15167985
> 
> 赞同：0
> 
> 时间：2013-03-01T22:33:41.403
> 
> 标签：facebook, api, facebook-fql, photo

所以，我需要从朋友那里获取最新的照片。我尝试从我的代码以及来自[http://developers.facebook.com/tools/explorer的 FQL 资源管理器运行一些查询](http://developers.facebook.com/tools/explorer)

以下查询永远不会返回。

SELECT src_big, created, owner FROM photo WHERE owner in (select uid2 from friend where uid1=me()) order by created desc

对所有者使用 WHERE 子句可能不是一个好主意，即使 FQL 文档确实说所有者已被索引。因此，我将其修改为：

SELECT src_big, created, owner FROM photo WHERE aid in (select aid from album where owner in (select uid2 from friend where uid1=me())) order by created desc limit 2000

确实返回了，但只返回了我 3 位朋友的照片，而且照片总数远未接近 2000。

我尝试将结果限制为仅在过去 7 天内创建的照片。

SELECT src_big, created, owner FROM photo WHERE aid in (select aid from album where owner in (select uid2 from friend where uid1=me())) and created > 1361570941 order by created desc limit 2000

现在我只得到 1 张照片（显然来自 1 个所有者）。

然后我尝试了最后 365 天。

SELECT src_big, created, owner FROM photo WHERE aid in (select aid from album where owner in (select uid2 from friend where uid1=me())) and created > 1330639808 order by created desc limit 2000

现在我得到了更多的照片，但仍然没有 2000 张，而且只有这 3 个所有者的照片。

如果我现在遍历我的每个朋友并运行此查询：

SELECT src_big, created, owner FROM photo WHERE owner = and created > 1330639808 order by created desc limit 100

然后我得到了正确的结果，最终当我与所有朋友一起完成时，我有 202 个朋友的照片，如果我按创建的整体结果排序，上述 3 个所有者不会占据前几行。有许多所有者在前 2000 个位置发布了照片，因此之前的查询显然返回了不正确（不完整）的数据。

但是与之前的查询相比，最后一种方法（遍历所有朋友）对于性能来说是很糟糕的——我们说的是几分钟而不是几秒钟。

这是一个已知问题或限制吗？任何解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T06:39:26.860

我的一位 Facebook 员工朋友建议使用多查询，如下所示：

{ "p1" : "SELECT src_big, created, owner FROM photo WHERE owner = 4850 AND created > 1341203410", "p2" : "SELECT src_big, created, owner FROM photo WHERE owner = 5569 AND created > 1341203410" }

我还没有尝试过，但我猜它会比每个朋友调用 API 快得多。

他说他会针对我原始查询的错误结果提交一个错误。

# java - replaceAll 不替换子字符串

> ID：15167986
> 
> 赞同：1
> 
> 时间：2013-03-01T22:33:42.830
> 
> 标签：java, string, replace

当我输入这个后运行我的代码时

**1 qwertyuiopasdfghjklzxcvbnm**

**将要**

它仍然打印出**will**而不是像应该那样替换字符，这是为什么呢？

```
public static void main(String[] args) 
{

    String input="";
    int cases= sc.nextInt();
    String al= sc.next();
    String upAl= al.toUpperCase();
    char [] upAlph = upAl.toCharArray();

    char[] alph = al.toCharArray();
    for(int i=0; i<cases; i++)
    {
        input=sc.next();

        input.replaceAll("a", ""+ alph[0]);
        input.replaceAll("b", ""+ alph[1]);
        input.replaceAll("c", ""+ alph[2]);
        input.replaceAll("d", ""+ alph[3]);
        input.replaceAll("e", ""+ alph[4]);
        input.replaceAll("f", ""+ alph[5]);
        input.replaceAll("g", ""+ alph[6]);
        input.replaceAll("h", ""+ alph[7]);
        input.replaceAll("i", ""+ alph[8]);
        input.replaceAll("j", ""+ alph[9]);
        input.replaceAll("k", ""+ alph[10]);
        input.replaceAll("l", ""+ alph[11]);
        input.replaceAll("m", ""+ alph[12]);
        input.replaceAll("n", ""+ alph[13]);
        input.replaceAll("o", ""+ alph[14]);
        input.replaceAll("p", ""+ alph[15]);
        input.replaceAll("q", ""+ alph[16]);
        input.replaceAll("r", ""+ alph[17]);
        input.replaceAll("s", ""+ alph[18]);
        input.replaceAll("t", ""+ alph[19]);
        input.replaceAll("u", ""+ alph[20]);
        input.replaceAll("v", ""+ alph[21]);
        input.replaceAll("w", ""+ alph[22]);
        input.replaceAll("x", ""+ alph[23]);
        input.replaceAll("y", ""+ alph[24]);
        input.replaceAll("z", ""+ alph[25]);
        input.replaceAll("A", upAlph[0]+"");
        input.replaceAll("B", upAlph[1]+"");
        input.replaceAll("C", upAlph[2]+"");
        input.replaceAll("D", upAlph[3]+"");
        input.replaceAll("E", upAlph[4]+"");
        input.replaceAll("F", upAlph[5]+"");
        input.replaceAll("G", upAlph[6]+"");
        input.replaceAll("H", upAlph[7]+"");
        input.replaceAll("I", upAlph[8]+"");
        input.replaceAll("J", upAlph[9]+"");
        input.replaceAll("K", upAlph[10]+"");
        input.replaceAll("L", upAlph[11]+"");
        input.replaceAll("M", upAlph[12]+"");
        input.replaceAll("N", upAlph[13]+"");
        input.replaceAll("O", upAlph[14]+"");
        input.replaceAll("P", upAlph[15]+"");
        input.replaceAll("Q", upAlph[16]+"");
        input.replaceAll("R", upAlph[17]+"");
        input.replaceAll("S", upAlph[18]+"");
        input.replaceAll("T", upAlph[19]+"");
        input.replaceAll("U", upAlph[20]+"");
        input.replaceAll("V", upAlph[21]+"");
        input.replaceAll("W", upAlph[22]+"");
        input.replaceAll("X", upAlph[23]+"");
        input.replaceAll("Y", upAlph[24]+"");
        input.replaceAll("Z", upAlph[25]+"");
        input.replaceAll("_", " ");
        pw.println(input);

    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T22:34:36.053

`Strings`是不可变的。分配`input`给 的结果`replaceAll`：

```
input = input.replaceAll("a", ""+ alph[0]);
... 
```

*另外：*如果不需要正则表达式，请考虑使用[String#replace 。](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replace%28java.lang.CharSequence,%20java.lang.CharSequence%29)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T22:37:28.103

字符串`immutable`在 java 中，创建后不能修改字符串，考虑将结果赋给`replaceAll`原始字符串

```
 input = input.replaceAll("string", "string"); 
```

该方法 `replaceAll`在替换后返回一个新字符串。

甚至`+=`不将值添加到字符串中，它会在内部创建另一个字符串。因此，`StringBuilder`如果您想经常修改字符串，请考虑使用以获得更好的性能

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T14:24:58.697

我在周五之前编写了这个方法，在下班之前，但不得不离开。

无论如何，我今天确实完成了它。

```
public static String replaceStringChars(String input, String abc, String replacement, boolean ignoreCase) {
    abc = (ignoreCase ? abc.toLowerCase() : abc) + (ignoreCase ? abc.toUpperCase() : "") + "_";
    replacement = (ignoreCase ? replacement.toLowerCase() : replacement) + (ignoreCase ? replacement.toUpperCase() : "") + " ";
    input = input.replace(abc, replacement);
    StringBuilder newString = new StringBuilder(input);
    for (int a = 0; a < input.length(); a++) {
        char chr = input.charAt(a);
        int index = abc.indexOf(chr);
        if (index >= 0) {
            newString.setCharAt(a, replacement.charAt(index));
        }
    }
    return newString.toString();
} 
```

如何测试它？：

```
public static void main(String [] args)
{
    String input = "will_is_my_pastor";
    String abc = "abcdefghijklmnopqrstuvwxyz";
    String replacement = "qwertyuiopasdfghjklzxcvbnm";
    System.out.println(abc);
    System.out.println(replacement);
    System.out.println(replaceStringChars(input, abc, replacement, true));
} 
```

# build-automation - 如何制作一个自动运行多个输入文件的程序的程序？

> ID：15167990
> 
> 赞同：1
> 
> 时间：2013-03-01T22:34:25.903
> 
> 标签：build-automation

对不起，如果我的标题没有多大意义，但这是我需要的：

所以我正在运行一个开源 ocr 程序 tesseract 并在命令提示符下使用它（我使用 windows），这样 'tesseract input.jgp output.txt' 这个命令将把 input.jpg 转换成 output.txt

我有数百个必须转换的输入文件。（甚至更多）有什么办法可以制作一个程序，以便它可以为不同的输入文件自动运行 tesseract 程序？？？

如果我的描述不够，我真的很抱歉，如果是这样，请告诉我还有什么我应该描述的。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:58:25.447

使用 windows cmd shell，切换到包含 jpg 文件的文件夹并尝试

```
 for %i in (*.jpg) do tesseract %i %~ni.txt 
```

这将为每个 jpg 文件运行 tesseract，并将输出放在具有相似名称的文本文件中，但后缀为“txt”而不是 jpg。要了解有关“for”命令的更多信息，请在命令行中键入“help for”。如果您需要有关 cmd shell 编程的教程，请试试这个：[http ://www.csie.ntu.edu.tw/~r92092/ref/win32/win32scripting.html#Win32Scripting-Control-Constructs](http://www.csie.ntu.edu.tw/~r92092/ref/win32/win32scripting.html#Win32Scripting-Control-Constructs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T02:42:45.787

[VietOCR](http://vietocr.sf.net)是 Tesseract 的 GUI 前端，提供对批量 ocr 功能的支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T22:42:35.240

您的所有输入文件都在一个文件夹中吗？您可以创建一个批处理文件来遍历文件夹中的所有 jpg 文件并在这些文件上运行您的 tesseract 程序。

如果您想用某种语言编写“迭代器”程序，请查看该语言是否可以调用 Windows 程序。大多数语言至少有一种方法可以做到这一点。

仅供参考，如果您的输入文件不在单个文件夹中，则您必须有一种方法来指定“迭代器”程序中所有图像的位置。你如何做到这一点取决于你的输入文件是如何分布的。

# c# - 接收对我的服务的 HTTP 响应时出现 WCF 错误

> ID：15167995
> 
> 赞同：1
> 
> 时间：2013-03-01T22:34:39.833
> 
> 标签：c#, .net, wcf, web-services, wcf-binding

嗨，伙计们，我使用 WCF 创建了一个服务，但是当我测试我的服务时，有些服务成功完成，为什么有些人给我下面的错误。关于如何解决这些问题的任何想法？谢谢

```
An error occurred while receiving the HTTP response to http://localhost:8733/PortOperation/Operator_Service/ws. This could be due to the service endpoint binding not using the HTTP protocol. This could also be due to an HTTP request context being aborted by the server (possibly due to the service shutting down). See server logs for more details.

Server stack trace: 
at System.ServiceModel.Channels.HttpChannelUtilities.ProcessGetResponseWebException(WebException webException, HttpWebRequest request, HttpAbortReason abortReason)
at System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)
at System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout)
at System.ServiceModel.Channels.ClientReliableChannelBinder`1.RequestClientReliableChannelBinder`1.OnRequest(TRequestChannel channel, Message message, TimeSpan timeout, MaskingMode maskingMode)
at System.ServiceModel.Channels.ClientReliableChannelBinder`1.Request(Message message, TimeSpan timeout, MaskingMode maskingMode)
at System.ServiceModel.Channels.ClientReliableChannelBinder`1.Request(Message message, TimeSpan timeout)
at System.ServiceModel.Security.SecuritySessionClientSettings`1.SecurityRequestSessionChannel.Request(Message message, TimeSpan timeout)
at System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout)
at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)

Exception rethrown at [0]: 
at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
at IOperator_Service.GetAllUser(String ConnectionString)
at Operator_ServiceClient.GetAllUser(String ConnectionString)

Inner Exception:
The underlying connection was closed: An unexpected error occurred on a receive.
at System.Net.HttpWebRequest.GetResponse()
at System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)

Inner Exception:
Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host.
at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
at System.Net.PooledStream.Read(Byte[] buffer, Int32 offset, Int32 size)
at System.Net.Connection.SyncRead(HttpWebRequest request, Boolean userRetrievedStream, Boolean probeRead)

Inner Exception:
An existing connection was forcibly closed by the remote host
at System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)
at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T10:23:02.407

发生此类错误的情况有很多。

**第一的**

检查您是否提供了正确的 [DataContract] 和 [DataMember]？如果未提供，则会发生此类错误。您必须在响应中传递的类上方写入 [DataContract]，并在进入客户端响应的类成员上方写入 [DataMember]。

例如。

```
[DataContract]
class Program
{
  [DataMember] 
  public string Example{get;set}
} 
```

**第二**

如果传递了某些数据类型的最小值，请检查响应。这意味着某个时间数据成员在其取最小值时未初始化。例如 int 的 minValue 是 '-2147483648' 所以在某些时候它不能被序列化并抛出一个错误。

如果要跟踪此类错误，请在服务器端 web.config 中添加以下代码

```
<system.diagnostics>
 <sources>
  <source name="System.ServiceModel" switchValue="Information, ActivityTracing"    propagateActivity="true">
   <listeners>
     <add name="traceListener" type="System.Diagnostics.XmlWriterTraceListener"      initializeData= "D:\Traces.svclog"/>
   </listeners>
  </source>
 </sources>
</system.diagnostics> 
```

我想它会对你有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T23:07:34.530

我能够解决这个问题。

如果您使用的是 EF“代码优先”方法并且您希望使用 WCF 访问您的数据，您应该考虑**不要使用 poco 类中的“virtual”关键字启用延迟加载，**因为 WCF 序列化无法序列化动态代理数据。

# c# - 创建嵌套列表的逻辑

> ID：15167996
> 
> 赞同：0
> 
> 时间：2013-03-01T22:34:41.330
> 
> 标签：c#, html, logic, nested-lists

我正在解释具有以下格式的嵌套列表的文本文件

```
- todo
  - clean kitchen
    - do dishes
    - sweep floor
  - cook dinner
    - defrost fish
  - shopping
    - milk
    - eggs 
```

我想将这些项目放入 <ul></ul> 列表中。我正在尝试找出这样做的逻辑，目前通过空格数计算“深度”并`ul`根据最后一个深度是更高还是更低来添加开始或结束标签是一个可怕的混乱。

必须有一个聪明，整洁的逻辑来做这件事，我错过了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:42:16.347

应该很容易通过使用来确定级别`string.IndexOf`：

```
string line = file.ReadLine();
int level = line.IndexOf('-');
level = (level - 1)/2; 
```

处理关卡的逻辑更有趣一些。像下面这样的东西应该很好用。

```
int lastLevel = -1;
string line;
while ((line = file.ReadLine()) != null)
{
    int level = GetLevel(line); // from code above
    int diff = level - lastLevel;
    if (diff > 1)
    {
        // skipping multiple levels forward is probably an error.
        throw new ApplicationException();
    }
    if (diff == 1)
    {
        // next level. Add a <ul>
        WriteUl();
    }
    else if (diff == 0)
    {
        // same level. Add an <li>
        WriteLi(line);
    }
    else
    {
        // need to add </ul>, possibly multiple times
        do
        {
            WriteUlEnd();
            --lastLevel;
        } while (lastLevel > level);
    }
    lastLevel = level;
} 
```

如果你只有你展示的数据，那真的是唯一的方法。你必须计算空间。

# c# - 实体框架中的嵌套查询

> ID：15167997
> 
> 赞同：31
> 
> 时间：2013-03-01T22:34:44.747
> 
> 标签：c#, linq, entity-framework

我收到以下异常：

> 不支持嵌套查询。Operation1='案例' Operation2='收集'

用这个查询

```
var Games = context.Games.Select(a => new GameModel
{
     Members = (a.Type == 1 ? (a.UsersInGames.Where(b => b.GameID == a.ID && b.StatusID == 1).Select(c => new Member
     {
         ID = c.UserID,
         email = c.UserInfo.EmailAddress,
         screenName = c.UserInfo.ScreenName
     })) :   
    (a.Teams.Where(b => b.GameID == a.ID).SelectMany(b => b.UsersInTeams.Where(c => c.StatusID == 1)).Select(d => new Member
    {
        ID = d.UserID,
        email = d.UserInfo.EmailAddress,
        screenName = d.UserInfo.ScreenName
    )))
}) 
```

当我在选择成员时不包括条件时，查询工作正常。有没有办法可以在查询中执行条件？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-01T22:56:41.823

您高估了 LINQ 转换为 SQL 的功能。并非所有内容都是可翻译的，并且由于 LINQ 的工作方式，因此没有编译器警告。

嵌套集合通常要么 a) 不受支持，要么 b) 以可怕的 SELECT N+1 查询告终。您要求 EF 做的是返回一个对象树。**SQL 不支持树状结果**，因此您会遇到对象关系阻抗不匹配的问题，这很痛苦。

我建议您将嵌套集合数据作为第二个完全独立的查询来获取。这使您可以更好地控制并保证工作。

作为一个非必要的旁注，您可能无法说服 EF 使用 ?: 运算符而不是序列。这很难翻译。想一想您将如何将其编写为 SQL - 非常困难且令人费解。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-12-22T00:33:15.347

看起来 Linq to EF 不支持以下内容

```
context.Games.Select(g => new
{
    Field = g.IsX? queryable1 : queryable2
}); 
```

但是，您可以使用以下 hack 来使其工作：

```
context.Games.Select(g => new
{
    Field = queryable1.Where(q => g.IsX)
               .Concat(queryable2.Where(q => !g.IsX))
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-08-24T19:54:27.490

我遇到了同样的问题。解决方案是**加载两个结果**并确定**在查询后**使用什么（我知道它有性能下降），但如果截止日期攻击你，至少你可以暂时这样做：

**在 LINQ 端**

```
 var Games = context.Games.Select(a => new GameModel
        {
            // carries type1 results
            Members = a.UsersInGames.Where(b => b.GameID == a.ID && b.StatusID == 1).Select(c => new Member
            {
                ID = c.UserID,
                email = c.UserInfo.EmailAddress,
                screenName = c.UserInfo.ScreenName
            })),

             //You need to create this temporary carrier to carry type 2 results
             MembersOfType2 = a.Teams.Where(b => b.GameID == a.ID).SelectMany(b => b.UsersInTeams.Where(c => c.StatusID == 1)).Select(d => new Member
                {
                    ID = d.UserID,
                    email = d.UserInfo.EmailAddress,
                    screenName = d.UserInfo.ScreenName
                })))
            })
        } 
```

之后，您可以循环并为某个游戏`Games`进行分配。`Members = MembersOfType2``Type == 1`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-05-08T06:05:28.380

我也有这个错误。我有这样的代码：

```
var Games = context.Games.Select(a => new GameModel
{
    Members = (!filters.GetDatailedDataToo ? null : new List<MemberModel>())
}; 
```

`null`运行中使用时出现此错误`? :`。

这不是那种情况，写在这里，但我浪费了很多时间，我想任何人都使用这种情况，谁搜索这个错误文本..