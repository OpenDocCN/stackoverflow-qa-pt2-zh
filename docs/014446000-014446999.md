# StackOverflow 问答 14446000-14446999

# ios - iOS 邮件客户端类似于 img 链接

> ID：14446000
> 
> 赞同：1
> 
> 时间：2013-01-21T19:41:26.933
> 
> 标签：ios, email, hyperlink, uiactionsheet

刚刚创建了一个电子邮件模板，但是任何包含在锚标记中的 img 在单击时都会显示共享操作表（文本链接很好）我不知道发生了什么，我也看到其他一些人问过这个问题没有真正解决的问题，有人知道是什么原因造成的吗？还是修复？谢谢！

代码示例...

```
<a href="http://www.destination.com">
<img src="imageurl" />
</a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T12:30:21.873

您在哪个电子邮件客户端打开邮件？也许尽量不要直接链接到图像，而是链接到包含图像的 HTML 页面 ( `<img>`)

# java - 是否有任何基于 Java 的智能词分词器可以对句子中的相邻词进行标记？

> ID：14446001
> 
> 赞同：3
> 
> 时间：2013-01-21T19:41:28.633
> 
> 标签：java, tokenize

我想标记一个具有相邻单词的句子，如下所示：

“这是一个 Iwanttotokenize 的样本字符串。”

在上面的例子中，有两种情况“samplestring”和“Iwanttotokenize”出现相邻的单词。知道如何制作这些单词的标记吗？

对于这句话，理想的输出应该是（每行一个标记）：这是我要标记的示例字符串

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T13:21:56.733

我建议使用[http://www.sil.org/linguistics/wordlists/english](http://www.sil.org/linguistics/wordlists/english)之类的单词列表 如果内存允许，将其打包到 HashSet 并使用函数 contains() （针对哈希比较进行了优化）

首先，使用 StringTokenizer 对字符串进行标记。对于每个标记，检查它是否以列表中的单词开头和/或结尾。如果它以该列表的一个单词开头和结尾，并且没有留下任何字母，则在原始字符串中适当的地方插入空格并再次进行标记。

# javascript - Onclick 不断恢复其原始值

> ID：14446006
> 
> 赞同：7
> 
> 时间：2013-01-21T19:41:43.517
> 
> 标签：javascript, html

试图用javascript制作扫雷器并遇到了这个问题......

我创建了一个表，每个 td 都是一个“盒子”，里面要么有地雷，要么什么都没有（目前）。在我单击一个框后，javascript 应该将 onclick 从“clicked(this.id)”更改为“NOPE”的警报（发出警报只是为了测试是否发生了某些事情），但发生的事情是：

1.  我点击“框 1”，它显示那里有什么（炸弹或什么都没有）
2.  我再次单击它，这次我收到一个警报“NOPE”——这意味着 onclick 已更改。好的！
3.  我点击“框 2”，它显示那里有什么（炸弹或什么都没有）
4.  我再次点击它，这一次我得到一个警告“NOPE”——这意味着这个 onclick 也发生了变化！
5.  我再次单击“框 1”。clicked(this.id) 再次运行。（显示这是因为我在每次函数运行时都添加了一个计数器）

由于某种原因，onclick 会返回到其原始值 (clicked(this.id))..

我制作了一个测试页，一个带有 2 个 td 的表格，并且考虑到了相同的想法（单击后更改 onclick 值）并且它有效..我不知道如何解决这个问题......

确实有效的 test.html：http: [//pastebin.com/62ayRJps](http://pastebin.com/62ayRJps)

该网站的 HTML 无法按预期工作：http: [//pastebin.com/SZ6NU8j9](http://pastebin.com/SZ6NU8j9)

网站上的 Javascript 无法按预期工作：http: [//pastebin.com/bevJHNLc](http://pastebin.com/bevJHNLc)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T16:20:38.583

由于以下行，您的单击事件处理程序正在被重置`clicked(id)`：

```
document.getElementById("minesweeper").innerHTML += ammountClicked+" - " 
```

每个表格单元格`onclick='clicked(this.id);'`在其 HTML 中都有一个属性。当您将测试函数分配给`tst`表格单元格 DOM 对象时，您正在设置`onclick`DOM 对象的属性，但这不会更改`onclick`HTML 的属性。（是的，这令人困惑。）

在上面的代码行中，浏览器`innerHTML`从 minesweeper `div`（具有原始`onclick`属性）读取 ，将其与另一个字符串连接，然后将结果重新分配回 minesweeper `div`。这会清除 的原始内容`div`并将其替换为新的 HTML（每个单元格都具有原始`onclick`属性的表格）。

* * *

如果你想有一个消息区，我建议`innerHTML`在另一个元素上设置：[Demo](http://jsfiddle.net/jefferyto/DqLEU/)

在演示中，我更改了第 49 行（添加了一个`span`）：

```
print += "</table><span id='message'></span>"; 
```

和第 107 行（将文本分配给`span`）：

```
document.getElementById("message").innerHTML += ammountClicked+" - "; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T12:00:42.337

我建议您跟踪每个项目的状态。运行应用程序时最好不要修改代码。

```
var states = {1: 0, 2: 0};

function clicked(id)
{
    if (states[id] === 0)
      alert("First time clicking me, eh?");
    else
      alert("Seems we have a repeat offender!");

    states[id]++;
} 
```

这使您可以通过检查`state`给定的`id`是否已更改（例如，通过先前的单击）来拆分函数中的逻辑。

[jsbin 上的交互式演示](http://jsbin.com/ifufoz/6/edit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T09:36:58.513

通过一些修改`function clicked(id)`它可以工作：

1.  注释行`//document.getElementById(id).onclick = tst;`
2.  `field[row][column] = false;`在函数末尾添加
3.  `false`在执行任何操作之前检查字段是否包含：

    ```
    if (field[row][column] == false) {
        console.log("This cell has already been clicked");
        return;
    } 
    ```

无需更改 onclick 事件。

**正如Jeffery To**所解释的，问题如下：

1.  你点击单元格**0,0**
2.  函数`clicked`被调用
3.  `minesweeper.innerHTML = minesweeper.innerHTML + "1 - "`[重置所有 onclick 事件]
4.  单元格 0,0 的 onclick 事件已更改
5.  您单击一个新单元格，例如**0,1**
6.  `minesweeper.innerHTML = minesweeper.innerHTML + "2 - "`[重置所有 onclick 事件]
7.  **单元格0,1**的onclick 事件已更改

onclick 事件被重置，因为 innerHTML 包含所有 onclick 声明。这就像重写该 div 的所有 HTML，从而重写所有子元素及其事件。这也是您的简单示例（只有两个单元格的示例）有效的原因。

# ios - UITableView 中的单元格在弹回 ViewController 时保持突出显示

> ID：14446013
> 
> 赞同：1
> 
> 时间：2013-01-21T19:42:23.413
> 
> 标签：ios, objective-c, cocoa-touch, uitableview

我有`ViewController`一个`UITableView`。我选择了一个单元格以移动到另一个单元格，`ViewController`但是当我使用`[self.navigationController popToRootViewControllerAnimated:NO];`我选择的单元格弹出时仍然以蓝色突出显示。取消突出显示它的唯一方法是选择另一个单元格。如何清除选择时突出显示的蓝色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T19:43:25.793

`deselectRowAtIndexPath:`在你`didSelectrowAtIndexPath`左右使用方法。

```
 [tableView deselectRowAtIndexPath:indexPath animated:YES]; 
```

# jboss - 如何从我的 WAR 文件中用我自己的覆盖 JBoss 模块？

> ID：14446018
> 
> 赞同：0
> 
> 时间：2013-01-21T19:42:39.963
> 
> 标签：jboss, overriding, classloader, jboss7.x, war

我正在使用 JBoss 7.1.1 并尝试使用 Apache Commons Lang 3.3 部署 WAR 文件。JAR 位于我的 WAR 文件中的 WEB-INF/lib 文件夹中。但是，当我运行我的 Web 应用程序时，我收到以下错误/异常，我认为这是因为 JBoss 正在使用它自己的旧 commons-lang library 。如何在不修改 JBoss 安装的情况下覆盖 JBoss commons lang 模块？

```
java.lang.NoClassDefFoundError: org/apache/commons/lang/RandomStringUtils
    org.mainco.subco.dido.service.TrainingSessionServiceImpl.createTrainingLink(TrainingSessionServiceImpl.java:387)
    org.mainco.subco.dido.service.TrainingSessionServiceImpl.addUserLinks(TrainingSessionServiceImpl.java:352)
    org.mainco.subco.dido.service.TrainingSessionServiceImpl.createOrUpdateTrainingSessionFromOrder(TrainingSessionServiceImpl.java:205)
    org.mainco.subco.dido.service.TrainingSessionServiceImpl.createTrainingSessions(TrainingSessionServiceImpl.java:162)
    org.mainco.subco.dido.service.TrainingSessionServiceImpl.createOrUpdateTrainingSessions(TrainingSessionServiceImpl.java:124)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    java.lang.reflect.Method.invoke(Method.java:597)
    org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)
    org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    $Proxy132.createOrUpdateTrainingSessions(Unknown Source)
    org.mainco.subco.dido.quartz.ProcessPDWorker.work(ProcessPDWorker.java:23)
    org.mainco.subco.dido.controller.IndexController.refreshPD(IndexController.java:40)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    java.lang.reflect.Method.invoke(Method.java:597)
    org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:213)
    org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:126)
        org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96)
    org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617)
    org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578)
    org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:734)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:847)

root cause
java.lang.ClassNotFoundException: org.apache.commons.lang.RandomStringUtils from [Module "deployment.didoclient.war:main" from Service Module Loader]
    org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190)
    org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468)
    org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456)
    org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:423)
    org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398)
    org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120)
    org.mainco.subco.dido.service.TrainingSessionServiceImpl.createTrainingLink(TrainingSessionServiceImpl.java:387)
    org.mainco.subco.dido.service.TrainingSessionServiceImpl.addUserLinks(TrainingSessionServiceImpl.java:352)
    org.mainco.subco.dido.service.TrainingSessionServiceImpl.createOrUpdateTrainingSessionFromOrder(TrainingSessionServiceImpl.java:205)
    org.mainco.subco.dido.service.TrainingSessionServiceImpl.createTrainingSessions(TrainingSessionServiceImpl.java:162)
    org.mainco.subco.dido.service.TrainingSessionServiceImpl.createOrUpdateTrainingSessions(TrainingSessionServiceImpl.java:124)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    java.lang.reflect.Method.invoke(Method.java:597)
    org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)
    org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    $Proxy132.createOrUpdateTrainingSessions(Unknown Source)
    org.mainco.subco.dido.quartz.ProcessPDWorker.work(ProcessPDWorker.java:23)
    org.mainco.subco.dido.controller.IndexController.refreshPD(IndexController.java:40)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    java.lang.reflect.Method.invoke(Method.java:597)
    org.springframework.web.method.support.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:213)
    org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:126)
        org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96)
    org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617)
    org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578)
    org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:734)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:847) 
```

谢谢， - 戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:47:35.847

在我看来，您的代码（或至少 中的代码`org.mainco.subco.dido.service.TrainingSessionServiceImpl`）似乎仍在使用旧版本的 commons-lang。如果您查看[commons-lang 3 的 Javadoc，](http://commons.apache.org/lang/api-release/index.html)您会看到代码在下面`org.apache.commons.lang3`而不是`org.apache.commons.lang3`.

# c# - 将复杂数据传递给 REST WCF POST 方法

> ID：14446019
> 
> 赞同：0
> 
> 时间：2013-01-21T19:42:42.070
> 
> 标签：c#, wcf, rest

我正在做一个需要通过客户端接收复杂数据的 WCF REST 服务。我知道我不能通过 GET 方法传递复杂的数据，所以我使用 POST 来发送它。

我有这样的方法定义......

```
[WebInvoke (UriTemplate="/test/item", Method="POST", 
        RequestFormat=WebMessageFormat.Json, 
        ResponseFormat=WebMessageFormat.Json, 
        BodyStyle=WebMessageBodyStyle.Wrapped)]
    [OperationContract]
    string TestMethod(InItem item); 
```

我正在尝试使用 .Net 控制台客户端进行这样的消费......

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://myIP:port/test/item");
request.Credentials = CredentialCache.DefaultCredentials;
request.Method = "POST";

InItem item = new InItem()
{
    Quantity = 2,
    BougthQuantity = 2,
    Code = "9998",
    Date = DataTime.Now
};

string itemToSend = JsonConvert.SerializeObject(item);
byte[] byteData = Encoding.UTF8.GetBytes(itemToSend);
request.ContentLength = byteData.Length;
request.ContentType = "application/json;";

Stream stream = request.GetRequestStream();
stream.Write(byteData, 0, byteData.Length);
stream.Close();

WebResponse response = request.GetResponse();
stream = response.GetResponseStream(); 
```

但是当我调用服务方法时，TestMethod 上的 'item' 参数始终为空，我是否遗漏了什么或者我做错了什么？

提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:28:47.277

谢谢大家的回答，我才意识到错误是什么，首先......或者当然我们可以使用声明

```
"{\"item\":"+serialized object + "}" 
```

但这有点乱，我们可以将 BodyStyle 更改为 Bare。

接下来，我使用的是同一个库，因为实体通过项目共享，并且我将 ContractSerializer 应用于实体......

错误是关于“DateTime”参数的序列化，因为 jsonSerializer 使用 Newtonsoft 序列化程序和 DataContractJsonSerializer 使用这种格式

日期=2013-01-21T14:29:41.2211548-06:00（在提琴手上显示）

所以，我只是更改字符串的日期时间，它工作正常......

# html - 即使我没有解析页面，是否在页面上多次使用相同的 id 也是不好的做法？

> ID：14446022
> 
> 赞同：9
> 
> 时间：2013-01-21T19:42:46.860
> 
> 标签：html, backbone.js, html-parsing, marionette, backbone-views

我知道在一个页面中多次使用相同的 id 会创建格式错误的 html。使用 jquery 选择器时，只会返回带有 id 的第一个元素，但在我的应用程序中，我不应该遇到这个问题。

我有一个项目视图列表，它们都有一个我需要参考的元素。由于每个项目只能访问自己`$el`的 id 选择器，因此不会产生任何冲突（即使页面上有多个）。

我在[这里模拟了我在小提琴中的意思](http://jsfiddle.net/37wfs/)

在这个项目中，我没有做任何页面范围的解析，所以我相信它应该是安全的。有什么理由我不应该这样做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T19:44:51.670

您只知道当前的要求是什么。

最好遵守标准和有效的代码/标记，因为您不知道将来会发生什么。

在这个应用程序中，您很可能最终不得不使用 jQuery，然后您就会遇到麻烦。

以相同方式为多个元素设置样式的解决方案是使用 CSS 类 - 绝对没有理由不这样做，因为它就像使用 id 一样简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T19:49:03.867

[http://www.w3.org/TR/WCAG20-TECHS/H93.html](http://www.w3.org/TR/WCAG20-TECHS/H93.html)

[http://www.w3.org/TR/html401/struct/global.html#adef-id](http://www.w3.org/TR/html401/struct/global.html#adef-id)

还有其他东西可以读取您的 HTML 文档，而不仅仅是浏览器。

根据 HTML 规范，页面上的 id 属性必须是唯一的（这不是网页设计师/开发人员刚刚发明的标准）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:00:26.497

绝对地。HTML、CSS 和 JavaScript 的规范是关于浏览器在遇到特定代码时的行为方式的协议。当您做任何不合规范的事情时，浏览器不会做出太多保证，而且它们做出的保证更少，他们都会同意。

正如 Oded 在他对这个问题的评论中提到的那样，浏览器会根据您的代码构建一个 DOM 树，对其进行样式设置并渲染它。因此，取决于给定的浏览器如何决定这样做，它们可能会遇到具有相同 id 的多个元素的问题。

那么，为什么要冒险呢？我想不出任何不能使用类（或根本没有）来代替 id 的实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T19:49:08.010

是的，这是不好的做法。An`id`应该是对该元素的唯一引用。改为使用`class`。

# javascript - 节流计算属性的 Jasmine 规范

> ID：14446024
> 
> 赞同：2
> 
> 时间：2013-01-21T19:42:52.457
> 
> 标签：javascript, knockout.js, jasmine

我正在尝试为计算的可观察对象编写茉莉花规范，如下所示：

```
self.positionDate = ko.computed(function () {
  var dateString = "";
  var start = moment(self.positionStartDate()).format("LL");
  var end = moment(self.positionEndDate()).format("LL");
  if (start !== end) {
    dateString = sprintf("%s - %s", start, end);
  }
  else {
    dateString = sprintf("%s", start);
  }
  return dateString;
}).extend({ throttle: 1 }); 
```

使用油门，positionDate 计算函数不会得到更新。我试过人工等待以及调用 valueHasMutated() 都无济于事。

有没有人成功编写过节流计算的规范？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:15:53.143

由于使用了`throttle`你的 observable “async”，所以你需要使用 Jasmine 中的[异步规范特性](https://github.com/pivotal/jasmine/wiki/Asynchronous-specs)。

所以你需要使用`runs`和`waits`函数，比如：

```
describe('throttled obserable', function () {

    it('positionDate should be changed after positionStartDate changed', 
      function () {
        var vm = new ViewModel();

        runs(function () {
            vm.positionStartDate('January 21 2013');
            vm.positionEndDate('January 22 2013');
        });

        waits(1);

        runs(function () {
            expect(vm.positionDate())
                 .toEqual('January 21 2013 - January 22 2013');
            vm.positionStartDate('January 20 2013');
        });

        waits(1);

        runs(function () {
            expect(vm.positionDate())
                 .toEqual('January 20 2013 - January 22 2013');
        });
    });
}); 
```

演示[JSFiddle](http://jsfiddle.net/nemesv/ZNAFa/4/)。

# php - PHP 更新序列化数据

> ID：14446029
> 
> 赞同：5
> 
> 时间：2013-01-21T19:43:22.717
> 
> 标签：php, arrays, serialization

我需要一些帮助来反序列化和更新数组值并重新序列化它们（使用 php）。基本上我希望能够反序列化一个字符串，更新特定键的值（不丢失其他值）并重新序列化它。我已经搜索过，似乎找不到可行的解决方案（或者我只是伤寒）。

我要更新的数组非常简单。它有一个键和值。

```
array (
    'key' => 'value',
    'key2' => 'value2',
) 
```

我目前有，但它不起作用。

```
foreach(unserialize($serializedData) as $key => $val)
{
    if($key == 'key')
    {
        $serializedData[$key] = 'newValue';
    }
}

$updated_status = serialize($serializedData); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T19:55:05.830

您不能像在这里尝试那样直接写入序列化数据字符串：

```
$serializedData[$key] = 'newValue'; 
```

您需要将数据反序列化为数组，更新数组，然后再次对其进行序列化。似乎您只想在密钥存在时更新值，因此您可以这样做：

```
$data = unserialize($serializedData);
if(array_key_exists('key', $data)) {
    $data['key'] = 'New Value';
}
$serializedData = serialize($data); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-21T19:45:43.617

确切地说，您是如何描述它的：反序列化、更新、序列化。

```
$data = unserialize($serializedData);
$data['key'] = 'newValue';
$updated_status = serialize($data); 
```

# javascript - 第二个 ember 模板防止第一个被显示

> ID：14446038
> 
> 赞同：0
> 
> 时间：2013-01-21T19:44:03.593
> 
> 标签：javascript, ember.js, client-side, handlebars.js

我正在使用 ember，主要是为了方便客户端模板。

当我在一个页面中有多个标签时，我遇到了麻烦。它最终只显示最后一个模板。所以如果我从 ``<script type="text/x-handlebars"`>`

```
<script type="text/x-handlebars">
    <h1> My name is {{name}} </h1> 
    <h2> My favorite color is {{color}} </h2>
</script> 
```

它显示完整的消息。但是如果我把它变成

```
<script type="text/x-handlebars">
    <h1> My name is {{name}} </h1> 
</script>
<p> This is some static content </p>
<script type="text/x-handlebars">
    <h2> My favorite color is {{color}} </h2>
</script> 
```

它只显示最喜欢的颜色线。

我试图在示例[http://emberjs.com/examples/contacts/](http://emberjs.com/examples/contacts/)中复制类似的行为，但它们似乎没有执行多个未命名脚本的问题。

有人知道我需要做什么才能完成这项工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:11:22.217

这些例子已经过时了。如果您尝试使用最新版本的 ember 跟随他们，许多事情将无法正常工作。

具体到您的问题，ember 将使用最后一个未命名的模板作为您的应用程序模板，但您需要命名其他模板。所以对于上面的例子添加一个 data-template-name 属性：

```
<script type="text/x-handlebars" data-template-name="color">
  <h2> My favorite color is {{color}} </h2>
</script> 
```

有了这个，ember 将使用剩余的模板作为“应用程序”模板。现在您需要修改该模板以在适当的位置插入“颜色”模板。有很多方法可以做到这一点 - 这里我使用了`partial`助手：

```
<script type="text/x-handlebars">
  <h1> My name is {{name}} </h1> 
  {{partial "color"}}
</script> 
```

这是一个工作示例：http: [//jsbin.com/uzeyum/2/edit](http://jsbin.com/uzeyum/2/edit)

希望这可以帮助您入门。由于这些示例已经过时，我建议您阅读[ember 指南](http://emberjs.com/guides/)！这是最新的最新版本。

# javascript - jplayer 自定义用户代理 http 标头

> ID：14446044
> 
> 赞同：0
> 
> 时间：2013-01-21T19:44:16.523
> 
> 标签：javascript, jplayer

请求播放 mp3 文件时，是否可以让[jPlayer发送自定义 http 用户代理标头？](http://jplayer.org/)（不更改全局浏览器的默认用户代理）

就像是

```
player.play({mp3: 'http://file.to.mp3', headers: {'User-Agent': 'test'}}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T19:54:40.177

不，这不可能 Bowser API 用于所有请求。

# c - C - 汇编程序消息

> ID：14446047
> 
> 赞同：0
> 
> 时间：2013-01-21T19:44:24.780
> 
> 标签：c, assembly, compilation, x86-64, bsp

我正在尝试编译一个用 C 编写的 BSP 程序，但我收到了这个奇怪的错误消息：

```
/tmp/ccEDn8lx.s: Assembler messages:
/tmp/ccEDn8lx.s:141: Error: illegal immediate register operand (%rip) 
```

代码： http: [//pastebin.com/cuz026ji](http://pastebin.com/cuz026ji)

有谁知道这会导致什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-03T17:12:35.637

当我尝试在远程 unix 服务器上编译时，我也弹出了这个错误。我的 cpp 文件将在其他地方编译，但在远程 unix 服务器上它会吐出相同的错误消息：非法立即寄存器操作数 (%rip)。事实证明，我试图使用一个不允许的字符。也就是说，我将“$”作为变量，一旦我替换它就会编译。

# java - HQL查询中的休眠表未映射错误

> ID：14446048
> 
> 赞同：79
> 
> 时间：2013-01-21T19:44:37.050
> 
> 标签：java, eclipse, spring, hibernate, hibernate-mapping

我有一个使用 Hibernate 对数据库进行 CRUD 操作的 Web 应用程序。我收到一个错误，说该表未映射。查看 Java 文件：

错误信息：

```
org.springframework.orm.hibernate3.HibernateQueryException: Books is not mapped [SELECT COUNT(*) FROM Books]; nested exception is org.hibernate.hql.ast.QuerySyntaxException: Books is not mapped [SELECT COUNT(*) FROM Books]
at org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:660)
at org.springframework.orm.hibernate3.HibernateAccessor.convertHibernateAccessException(HibernateAccessor.java:412)
at org.springframework.orm.hibernate3.HibernateTemplate.doExecute(HibernateTemplate.java:411)
...
Caused by: org.hibernate.hql.ast.QuerySyntaxException: Books is not mapped [SELECT COUNT(*) FROM Books]
at org.hibernate.hql.ast.util.SessionFactoryHelper.requireClassPersister(SessionFactoryHelper.java:181)
at org.hibernate.hql.ast.tree.FromElementFactory.addFromElement(FromElementFactory.java:111)
at org.hibernate.hql.ast.tree.FromClause.addFromElement(FromClause.java:93)
... 
```

这是我的`DAO.java`方法：

```
public int getTotalBooks(){
    return DataAccessUtils.intResult(hibernateTemplate.find(
          "SELECT COUNT(*) FROM Books"));
} 
```

`Book.java`：

```
@Entity
@Table(name="Books")
public class Book {

    @Id
    @GeneratedValue
    @Column(name="id")
    private int id;

    @Column(name="title", nullable=false)
    private String title;
    ...
} 
```

我应该如何修改它才能工作？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2013-01-21T20:34:45.777

异常消息说：

> `Books is not mapped [SELECT COUNT(*) FROM Books]; nested exception is org.hibernate.hql.ast.QuerySyntaxException: Books is not mapped [SELECT COUNT(*) FROM Books]`

`Books`未映射。也就是说，没有称为的映射类型`Books`。

事实上，没有。您的映射类型称为`Book`. 它映射到名为 的表`Books`，但类型名为`Book`。当您编写 HQL（或 JPQL）查询时，您使用类型的名称，而不是表。

因此，将您的查询更改为：

> `select count(*) from Book`

虽然我认为它可能需要

> `select count(b) from Book b`

如果 HQL 不支持该`*`表示法。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2016-07-20T15:28:39.103

> `hibernate3.HibernateQueryException: Books is not mapped [SELECT COUNT(*) FROM Books];`

Hibernate 试图说它不知道名为“Books”的实体。让我们看看你的实体：

```
@javax.persistence.Entity
@javax.persistence.Table(name = "Books")
public class Book { 
```

正确的。表名已重命名为“Books”，但实体名称仍是类名中的“Book” *。*`Book`如果要设置实体名称，则应使用`@Entity`注解的名称：

```
// this allows you to use the entity Books in HQL queries
@javax.persistence.Entity(name = "Books")
public class Book { 
```

这将设置实体名称和表名称。

* * *

当我从`Person.hbm.xml`文件迁移到使用 Java 注释来描述休眠字段时，发生了相反的问题。我的旧 XML 文件有：

```
<hibernate-mapping package="...">
    <class name="Person" table="persons" lazy="true">
       ...
</hibernate-mapping> 
```

我的新实体有一个`@Entity(name=...)`我需要设置表的名称。

```
// this renames the entity and sets the table name
@javax.persistence.Entity(name = "persons")
public class Person {
    ... 
```

然后我看到的是 HQL 错误，例如：

```
QuerySyntaxException: Person is not mapped
     [SELECT id FROM Person WHERE id in (:ids)] 
```

这样做的问题是实体名称也被重命名`persons`为。我应该使用以下方法设置表名：

```
// no name = here so the entity can be used as Person
@javax.persistence.Entity
// table name specified here
@javax.persistence.Table(name = "persons")
public class Person extends BaseGeneratedId { 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2017-04-04T16:45:49.487

这个答案来晚了，但总结了“表未映射”异常中涉及的概念（为了帮助那些遇到这个问题的人，因为它对于休眠新手来说很常见）。由于许多原因，可能会出现此错误，但目标是解决一些 Hibernate 新手开发人员面临的最常见错误，以节省他们数小时的研究时间。我在下面使用我自己的示例进行简单演示。

例外：

```
org.hibernate.hql.internal.ast.QuerySyntaxException: subscriber is not mapped [ from subscriber] 
```

简而言之，这个非常常见的异常仅表明以下代码中的查询是错误的。

```
Session session = this.sessionFactory.getCurrentSession();
List<Subscriber> personsList = session.createQuery(" from subscriber").list(); 
```

这就是我的 POJO 类的声明方式：

```
@Entity
@Table(name = "subscriber")
public class Subscriber 
```

**但是“来自订阅者”**的查询语法是正确的，并且该表`subscriber`存在。这让我想到了一个关键点：

*   这是一个 HQL 查询而不是 SQL。

以及它是如何[在这里解释的](https://www.tutorialspoint.com/hibernate/hibernate_query_language.htm)

> HQL 适用于持久对象及其属性，而不适用于数据库表和列。

由于上述查询是 HQL 查询，因此`subscriber`应该是实体名称而不是表名称。因为我的表`subscriber` 与实体映射`Subscriber`。如果我将代码更改为此，我的问题就解决了：

```
Session session = this.sessionFactory.getCurrentSession();
List<Subscriber> personsList = session.createQuery(" from Subscriber").list(); 
```

只是为了让你不迷茫。请注意，HQL 在许多情况下都区分大小写。否则它会在我的情况下工作。

> SELECT、FROM 和 WHERE 等关键字不区分大小写，但 HQL 中的表名和列名等属性区分大小写。

[https://www.tutorialspoint.com/hibernate/hibernate_query_language.htm](https://www.tutorialspoint.com/hibernate/hibernate_query_language.htm)

要进一步了解休眠映射的工作原理，请阅读[此内容](https://www.tutorialspoint.com/hibernate/hibernate_or_mappings.htm)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-21T21:04:57.180

谢谢大家。很多好主意。这是我在 Spring 和 Hibernate 中的第一个应用程序.. 所以在与像我这样的“新手”打交道时要多一点耐心..

请阅读 Tom Anderson 和 Roman C. 的回答。他们很好地解释了这个问题。你们都帮了我。我换了

```
SELECT COUNT(*) FROM Books 
```

和

```
select count(book.id) from Book book 
```

当然，我有这个 Spring 配置：

```
<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
<property name="packagesToScan" value="extjs.model"/> 
```

再次感谢大家！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-04-13T09:12:58.887

确保您有实体注释和表格注释，并在表格注释上设置表格名称。

```
@Entity
@Table(name = "table_name")
public class TableName {

} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-05-12T00:09:59.087

除了接受的答案之外，另一项检查是确保在设置会话工厂时正确引用 sessionFactory.setPackagesToScan(...) 中的实体包。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-21T20:29:58.787

在配置放置此属性的 Spring 配置错字`applicationContext.xml`中`sessionFactory`

```
<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
  <property name="packagesToScan" value="${package.name}"/> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-16T14:20:44.307

Hibernate 对大小写也很挑剔。默认情况下，它将是第一个字母大写的类名。因此，如果您的班级被调用`FooBar`，请不要通过`"foobar"`。您必须通过`"FooBar"`该确切的大写字母才能使其正常工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-19T09:40:53.767

我有同样的问题，而不是@Entity 我使用以下代码来获取记录

```
 List<Map<String, Object>> list = null;
            list = incidentHibernateTemplate.execute(new HibernateCallback<List<Map<String, Object>>>() {

            @Override
            public List<Map<String, Object>> doInHibernate(Session session) throws HibernateException {
                Query query = session.createSQLQuery("SELECT * from table where appcode = :app");
                    query.setParameter("app", apptype);
                query.setResultTransformer(Transformers.ALIAS_TO_ENTITY_MAP);
                return query.list();

                }
            }); 
```

我使用以下代码进行更新

```
private @Autowired HibernateTemplate incidentHibernateTemplate;
Integer updateCount = 0;

    updateCount = incidentHibernateTemplate.execute((Session session) -> {
        Query<?> query = session
                    .createSQLQuery("UPDATE  tablename SET key = :apiurl, data_mode = :mode WHERE apiname= :api ");
          query.setParameter("apiurl", url);
          query.setParameter("api", api);
          query.setParameter("mode", mode);
            return query.executeUpdate();
        }
    ); 
```

# c - 在 Linux 中使用 fork() 函数创建进程

> ID：14446051
> 
> 赞同：0
> 
> 时间：2013-01-21T19:44:46.017
> 
> 标签：c, linux, process, fork, compiler-flags

我一直在尝试编译一段代码，它应该使用该函数`C`创建进程。``fork()`

```
#include <stdio.h>
#include <unistd.h>
main()
{
    int n=15, z=20, count=3, mult=1;
    while(count<3)
    {
        if(z!=0)
        {
            z=fork();
            n=n+15;
        }
        else
        {
            z=fork(); n=n+10; mult=mult*n;
        }
        printf(" z=%d   mult=%d",z,mult);
        count=count+1;
    }
} 
```

`"gcc -Wall -W -Werror main.c -o ProcessCreateC"`在终端中编译。我收到错误：

```
main.c:3:5: error: return type defaults to ‘int’ [-Werror=return-type]
main.c: In function ‘main’:
main.c:20:5: error: control reaches end of non-void function [-Werror=return-type]
cc1: all warnings being treated as errors 
```

由于我只有在 Windows 中编译的经验并且几乎没有经验`Linux`，所以我不知道是什么原因造成的。有任何想法吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T19:46:51.033

在 main() 的末尾添加`return 0;`或返回整数的类似表达式，然后更改`main()`为`int main()`，我想您会发现代码可以正常工作。

当没有为 main() 指定返回类型时，它默认为 int。此外，使用您启用的编译器标志，不为 main() 指定类型会导致错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T19:48:12.350

问题是双重的（因为*所有*警告都是错误）：

1.  `main`应该返回 int，例如实际上以`return 0;`
2.  您应该明确`main`返回 int，即 write `int main(`，而不仅仅是`main(`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T19:50:41.487

您没有提到 main 函数的返回类型为 void，因此 gcc 将其默认为整数返回值。

由于 GCC 遵循 ANSI C 标准，因此您必须将 main 的返回类型指定为 int，例如：

```
int main()
{
    //Do stuff
     return 0;
} 
```

记住编译器使用的标准很重要，否则您将继续犯这些错误并花费更多时间进行调试而不是做一些富有成效的事情。

# c# - 实体框架 ICollection 中的多个关系？

> ID：14446053
> 
> 赞同：0
> 
> 时间：2013-01-21T19:44:56.983
> 
> 标签：c#, sql-server, entity-framework, entity-framework-5

好的，所以在实体框架中，我有两个类，

```
public class User
{
    public int ID { get; set; }
    public string Username { get; set; }
}
public class Post
{
    public int ID { get; set; }
    public string Contents { get; set; }
    public virtual ICollection<User> Likes { get; set; }
} 
```

问题是，一个用户一次只能喜欢一个帖子——如果我喜欢`currPost.Likes.Add(currUser);`，它会将该用户从它之前喜欢的任何帖子中删除，并使其像这个新帖子一样。查看数据库，事实证明 EF 没有从帖子中引用用户，而是为每个引用帖子的用户提供了一个 Post_ID 列。

我将如何强制 EF 在我的 Posts 表中创建一个数组或用户的东西，而不是它现在是如何做的？我是否误解了 ICollection 的意义（例如，我应该使用列表还是数组？）谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T19:51:56.100

您正在寻找的是多对多的集合。EF 允许您执行此操作的方法之一是使用模型构建器。请查看[我关于导航属性](http://blog.staticvoid.co.nz/2012/7/17/entity_framework-navigation_property_basics_with_code_first)的帖子，了解如何执行此操作的示例（在“多关系”部分中）。

这将要做的是在数据库中创建一个链接表，以允许许多用户喜欢一个帖子和许多用户喜欢的帖子。

然后你可以这样表达你的模型：

```
public class User
{
    public int ID { get; set; }
    public string Username { get; set; }
    public virtual ICollection<Post> PostsThisUserLikes {get;set;}
}
public class Post
{
    public int ID { get; set; }
    public string Contents { get; set; }
    public virtual ICollection<User> UsersWhoLikeThis { get; set; }
} 
```

# macos - 批量删除文件扩展名 OSX

> ID：14446055
> 
> 赞同：3
> 
> 时间：2013-01-21T19:45:07.113
> 
> 标签：macos, file, shell, unix

我有一个文件夹，里面有很多（~60,000）个文件。他们中的大多数都有扩展名“.html.tmp”，我需要删除所有这些中的“.tmp”部分。我找到了一些类似的解决方案，但没有一个完全喜欢这个。我也只有 UNIX shell 的基本知识。OSX 不提供“重命名”命令。我想 shell 解决方案将是最方便的，但也欢迎任何其他解决方案。

提前致谢。梅里亚姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T00:32:02.103

使用循环遍历 Daniel 对`find`;的调用的输出。它应该更快，因为您将减少需要创建的单独进程的数量：

```
# Instead of calling sh, dirname, and basename for every file, use
# builtin bash commands to process the file name.
find /path/to/your/files -name '*.html.tmp' | while read fname; do
    mv "$fname" "${fname%.tmp}"
done 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T00:35:57.700

最简单的解决方案如下所示：

```
for f in *.html.tmp; do mv "$f" "${f%.tmp}"; done 
```

这确实可以正确处理空格，并且不需要为每个要重命名的文件调用单独的 shell（正如丹尼尔的回答所做的那样），所以它应该更快。

* * *

您的问题表明您的文件夹中有大约 60k 个文件，这表明没有需要处理的嵌套子文件夹。但是，如果您发现自己处于相同位置但需要递归处理子文件夹，请继续阅读。

如果您使用的是 Bash 4.x 并且愿意打开 shell 选项，那么您可以使用以下命令：

```
shopt -s globstar
for f in **/*.html.tmp; do mv "$f" "${f%.tmp}"; done 
```

`**/*.html.tmp`带有`globstar`选项集的构造意味着`*.html.tmp`不仅在当前目录中匹配，而且在任何子目录中递归匹配。

如果您的 Bash 版本早于 4.x，那么我建议使用 chepner 的解决方案进行递归处理。但是当你根本不需要递归时，我最初的答案是最简单的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T21:07:44.027

这应该做你想要的：

```
find /path/to/your/files -name '*.html.tmp' -exec sh -c 'mv -i "{}" "$(dirname "{}")/$(basename "{}" .tmp)"' \; 
```

它看起来有点复杂，因为如果文件名包含空格或其他 shell 元字符，简单的解决方案就会中断。我用过`mv -i`，所以它应该在覆盖任何文件之前询问你。我建议您在对数据尝试此操作之前进行备份。

# php - 在 wordpress 中保存 slug 名称

> ID：14446056
> 
> 赞同：0
> 
> 时间：2013-01-21T19:45:07.403
> 
> 标签：php, wordpress

这是我用来保存页面标题的代码。

```
add_action('cred_save_data', 'add_job_data_action',10,2);
function add_job_data_action($post_id, $form_data) {
    $title = trim(strip_tags(do_shortcode('[wpv-view name="Job Counter"]')));
    if ($form_data['id']==4851) {
        $my_post = array();
        $my_post['ID'] = $post_id;
        $my_post['post_title'] = $title;
        $my_post['slug'] = $title;
        wp_update_post( $my_post );
    }
} 
```

我希望 slug 与标题相同，但似乎没有得到它。它总是保存为 autodraft-xx

我做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T02:47:40.773

[在这里](http://codex.wordpress.org/Function_Reference/wp_insert_post)您可以获取所有参数

```
'post_name'      => [ <the name> ] // The name (slug) for your post 
```

希望有人也能学到一些东西！

# c++ - 从返回迭代器的 const 和非常量方法中删除代码重复

> ID：14446058
> 
> 赞同：9
> 
> 时间：2013-01-21T19:45:11.833
> 
> 标签：c++, constants, dry

我正在考虑关于 const 和非常量类方法的[这个问题。](https://stackoverflow.com/questions/123758/how-do-i-remove-code-duplication-between-similar-const-and-non-const-member-func)首选答案来自 Scott Meyers 的 Effective C++，其中非常量方法是根据 const 方法实现的。

进一步扩展，如果方法返回迭代器而不是引用，如何减少代码重复？修改链接问题中的示例：

```
class X
{
    std::vector<Z> vecZ;    
public:
    std::vector<Z>::iterator Z(size_t index)
    {
        // ...
    }
    std::vector<Z>::const_iterator Z(size_t index) const
    {
        // ...
    }
}; 
```

我无法根据 const 方法实现非常量方法，因为不使用 distance()/advance() 技术就无法直接从 const_iterator 转换为迭代器。

在示例中，因为我们使用 std::vector 作为容器，实际上可以从 const_iterator 转换为迭代器，因为它们很可能被实现为指针。我不想依赖这个。有没有更通用的解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T19:50:02.983

您可以使用一些技巧。[如果您对容器具有非常量访问权限，则可以将 const_iterator 转换为迭代器。](https://stackoverflow.com/a/10669041/369872)（你做的）：

```
std::vector<Z>::iterator Z(size_t index)
{
    std::vector<Z>::const_iterator i = static_cast<const X&>(*this).Z(index);
    return vecZ.erase(i, i);
} 
```

你也可以这样做：

```
std::vector<Z>::iterator Z(size_t index)
{
    return std::next(vecZ.begin(), std::distance(vecZ.cbegin(), static_cast<const X&>(*this).Z(index)));
} 
```

两者都不是特别优雅。为什么我们没有点`const_iterator_cast`赞`const_pointer_cast`？也许我们应该。

**编辑，我错过了最明显和最优雅的解决方案，因为我试图使用非常量方法中的 const 方法。在这里我做相反的事情：**

```
std::vector<Z>::const_iterator Z(size_t index) const
{
    return const_cast<X&>(*this).Z(index);
} 
```

您正在取消引用结果，`const_cast`但是只要非常量`Z`不修改`X`. 与我提供的其他两种解决方案不同，这是我可能在实践中使用的一种。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T19:59:28.287

我相信，只有借助助手才有可能

```
typedef int Z;

class X
{
    std::vector<Z> vecZ;    
public:
    std::vector<Z>::iterator foo(size_t index)
    {
        return helper(*this);
    }
    std::vector<Z>::const_iterator foo(size_t index) const
    {
        return helper(*this);
    }

    template <typename T>
    static auto helper(T& t) -> decltype(t.vecZ.begin())
    {
        return t.vecZ.begin();
    }
}; 
```

**编辑** 同样可以在没有 c++11 的情况下实现

```
template <typename T>
struct select
{
    typedef std::vector<Z>::iterator type;
};
template <typename T>
struct select<const T&>
{
    typedef std::vector<Z>::const_iterator type;
};

template <typename T>
static
typename select<T>::type
helper(T t) 
{
    return t.vecZ.begin();
} 
```

*但是，好吧，我认为您在使用此方法之前应该三思而后行*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-03T13:56:55.597

如果您使用的是 C++11，则有一种更优雅（恕我直言）的方式，它在模板迭代器类中仅使用两个 typedef 来区分 const 和常规迭代器： [http ://www.sjvs.nl/c-实现-const_iterator-and-non-const-iterator-without-code-duplication/](http://www.sjvs.nl/c-implementing-const_iterator-and-non-const-iterator-without-code-duplication/)

# c# - 用于查找基于 HSL 的颜色是否接近另一种颜色的布尔函数

> ID：14446061
> 
> 赞同：3
> 
> 时间：2013-01-21T19:45:28.720
> 
> 标签：c#, colors

我想写一个函数来检查颜色是否接近背景颜色。

为此，我使用了 HSL 配色方案，让我解释一下；HSL 颜色定义为色相饱和度和亮度。简而言之，色调告诉您使用了彩虹的哪种颜色，它的范围在 0 到 360 之间。我想检查一下它的色调。

因此，饱和度颜色的强度，例如纯色或混合灰色或不言自明的亮度，无法进行比较。我只想检查色调。起初我写了一个像这样的 Near 函数：

```
Private boolean Near(int background, int mycolor, int difference)
{
  if(math.abs( background - mycolor)<difference){return true;}else{return false}
} 
```

后来我意识到这是错误的。因为 HSL 就像你在下面看到的图像一样，颜色是一个圆圈，所以从红色 0 开始，在 360 处再次变为红色。所以 358 和 4 的色调值很接近，上面的函数不会反映那。

（饱和度到中心 0..100 变亮 0..100 就像上升或下降，色调是从 0 到 360 度左右。）

![在此处输入图像描述](../Images/5c2faf361b670a2929f3ffedeeb6665e.png)

我可以用大的 if then 构造重写一个函数，例如，如果红色 5 和允许的差异为 20 的背景，那么`mycolor`如果它 < 5+20 或 > (360-(5-20) ) .. 因此，如果色相差异超过 0 或 360 限制，请进行特殊构造。

好吧，那会起作用，但后来我想知道是否有可能用单行中的模计算替换这种“if then”构造？，这让我仍然想知道因为模计算可用于检查边界内以及它是否在 360 度的边界上，它会再次变成接近零的红色，

好吧，我认为是这样，这样的行也可能包含一些 AND 或 OR 以及减法或 ABS 函数..是否可以将它写在一个比较行中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:08:17.880

您需要做的是确保您正在比较的值尽可能接近。例如，如果`background = 358`和`mycolor = 4`，那么它们可以通过`360`从中减去来使它们更接近`background`，这不会改变有效值。只要差异 > ，就需要使它们更接近`180`。

```
if (mycolor - background > 180) mycolor -= 360;
if (background - mycolor > 180) background -= 360; 
```

通过这些转换，您的原始逻辑应该是正确的（这`if`是不必要的）：

```
return Math.Abs(background - mycolor) < difference; 
```

* * *

**编辑**：我发现了一个似乎是正确的更简单的表达式。

```
return Math.Abs(background - mycolor) % (361 - difference) < difference; 
```

# c++ - 未定义对 `vtable for station::baseStation' 的引用

> ID：14446063
> 
> 赞同：0
> 
> 时间：2013-01-21T19:45:51.247
> 
> 标签：c++

> **可能重复：**
> [什么是未定义的引用/未解决的外部符号错误，我该如何解决？](https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix)

我不知何故得到了这个错误。这是我的代码：

```
#ifndef BASESTATION_H_
#define BASESTATION_H_

#include <list>
#include "Song.h"
#include <string>

using mtm::Song;
using std::list;
namespace stations {

class baseStation {
public:
    explicit baseStation(double frequency) : frequency(frequency) {}
    double getFrequency() const;
    bool getIsFullVersion() const;
    bool isInPlaylist(const string& author, const string& name) const;
    virtual void addSong(const Song& song);
    virtual const Song& getCurrentSong() const;
    virtual const SongPart& getCurrentlyPlayedPart(unsigned int time) const;
    virtual ~baseStation();

private:
    //keep it protected or not??
    double frequency;
    list<Song> playlist;
    list<Song>::iterator currentSong;
    bool isFullVersion;
}; 
```

我得到的错误是：在“显式”行上未定义对“vtable forstations::baseStation”的引用。

非常感谢。`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T19:53:35.583

您在此处发布的代码很好。我可以通过定义自己的 Song 和 SongPart 类来毫无问题地编译它（我必须这样做，因为它们是在 Song.h 中定义的）。

我假设您的“Song.h”正在做一些不寻常的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T19:57:40.087

这是链接器错误吗？

当编译器在 *.cpp 文件中找不到任何虚拟成员定义时（例如，如果您已内联定义了所有虚拟函数），则会发生此错误。链接器无法找出在哪个目标文件中为您的类生成虚拟指针表，因为在任何源文件中都没有定义任何虚拟函数，并且会生成此错误消息。解决方案是在 cpp 文件中定义至少一个虚拟成员。

# xml - 如何指定用于 JAXB xjc 生成的类的 XmlAccessorType

> ID：14446064
> 
> 赞同：5
> 
> 时间：2013-01-21T19:45:52.137
> 
> 标签：xml, binding, jaxb, annotations, xjc

我正在使用 XML 模式并使用 xjc 生成要与 JAXB 一起使用的 java 文件。生成的 java 文件指定了默认的 @XmlAccessorType(XmlAccessType.FIELD)。我想更改它，以便生成的 java 文件具有 PROPTERY 访问注释（ @XmlAccessorType(XmlAccessType.PROPERTY ) ）并且没有在字段级别生成的 @XmlElement / @XmlAttribute 注释。有没有办法通过自定义绑定文件来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-03T21:26:36.783

看起来您无法通过绑定自定义来做到这一点。但是，如果您希望从一个 xjc 运行生成的所有类都具有 @XmlAccessorType(XmlAccessType.PROPERTY)，您可以使用 xjc 的 propertyaccessors 扩展：

```
xjc -Xpropertyaccessors ... 
```

您应该使用最新版本的 xjc，因为[该插件在 2.2.4 时未正确注册](https://stackoverflow.com/questions/11349190/jaxb-xjc-xpropertyaccessors)。

# c# - 在 linq orderby 中过滤值

> ID：14446068
> 
> 赞同：2
> 
> 时间：2013-01-21T19:46:06.987
> 
> 标签：c#, linq, sorting

有没有办法在下面的查询中过滤值 -1（来自`IndexOf`when txt not found in item）？

```
var sortedArray = array.OrderBy (item => item.IndexOf(txt)).ToArray(); 
```

任何指针都会有所帮助。

如果我使用Where，它会使用`IndexOf`两次，有没有办法`IndexOf`只使用一次？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T19:53:05.583

为了避免必须做同样的`IndexOf`两次，你可以这样做：

```
var sortedArray = (from a in array
                  let i = a.IndexOf("txt")
                  where i >= 0
                  orderby i
                  select a).ToArray(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T19:48:08.747

你可以用`Where`做你的谓词，然后再做`OrderBy`。

```
var sortedArray =
    array.Where   (item => item.IndexOf("txt") != -1)
         .OrderBy (item => item.IndexOf("txt")).ToArray(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T19:48:53.237

最简单的方法就是先放一个`.Where()`子句。

```
var sortedArray = array.Where (item => item.IndexOf(txt) != -1)
                       .OrderBy (item => item.IndexOf(txt))
                       .ToArray(); 
```

但是，这可能会对大型数组或数组中的大型数据造成显着的性能影响，因为您现在要搜索它两次。

# android - 构建 Android：没有规则来制定目标

> ID：14446071
> 
> 赞同：2
> 
> 时间：2013-01-21T19:46:20.883
> 
> 标签：android, build, makefile

我目前正在 Ubuntu 10.04 64 位上构建 SE Android 4.2.1_r1。我几乎完成了制作过程，但我目前陷入以下错误。

```
Install: out/host/linux-x86/framework/commons-cli-1.2.jar
host Prebuilt: commons-codec-1.4 (out/host/common/obj/JAVA_LIBRARIES/commons-codec-   
1.4_intermediates/javalib.jar)
Notice file: prebuilts/tools/common/http-client/NOTICE -- out/host/linux
x86/obj/NOTICE_FILES/src//framework/commons-codec-1.4.jar.txt
Install: out/host/linux-x86/framework/commons-codec-1.4.jar
host Prebuilt: commons-compress-1.0 (out/host/common/obj/JAVA_LIBRARIES/commons
compress-1.0_intermediates/javalib.jar)
Notice file: prebuilts/tools/common/commons-compress/NOTICE -- out/host/linux
x86/obj/NOTICE_FILES/src//framework/commons-compress-1.0.jar.txt
Install: out/host/linux-x86/framework/commons-compress-1.0.jar
host Prebuilt: commons-logging-1.1.1 (out/host/common/obj/JAVA_LIBRARIES/commons
logging-1.1.1_intermediates/javalib.jar)
Notice file: prebuilts/tools/common/http-client/NOTICE -- out/host/linux
x86/obj/NOTICE_FILES/src//framework/commons-logging-1.1.1.jar.txt
Install: out/host/linux-x86/framework/commons-logging-1.1.1.jar
Notice file: libcore/NOTICE -- out/host/linux-x86/obj/NOTICE_FILES/src//framework/core
hostdex.jar.txt
host Prebuilt: tzdata-host (out/host/linux-x86/obj/ETC/tzdata-host_intermediates/tzdata)
Install: out/host/linux-x86/usr/share/zoneinfo/tzdata
Install: out/host/linux-x86/framework/core-hostdex.jar
Notice file: external/junit/NOTICE -- out/host/linux
x86/obj/NOTICE_FILES/src//framework/core-junit-hostdex.jar.txt
Install: out/host/linux-x86/framework/core-junit-hostdex.jar
host Java: sqlite-jdbc-host (out/host/common/obj/JAVA_LIBRARIES/sqlite-jdbc
host_intermediates/classes)
Note: Some input files use unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details.
make: *** No rule to make target `out/host/common/obj/JAVA_LIBRARIES/mockwebserver
hostdex_intermediates/javalib.jar', needed by `out/host/common/obj/JAVA_LIBRARIES/core-   
tests-hostdex_intermediates/classes-full-debug.jar'.  Stop. 
```

我试图用谷歌搜索我的错误，但我不确定是否有人实际成功构建了 SE Android 4.2.1。目录 mockwebserver-hostdex_intermediates 不存在。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T11:41:32.127

我在从 Master repo 编译 Android-4.2.1 时遇到了同样的问题，所以我怀疑这不是 SEandroid 的问题。大约两天前，我在具有相同配置的同一 VM 中成功编译了 SEandroid（午餐全英）。

我找不到与此问题相关的任何信息，只有少数人遇到相同问题但没有任何解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T18:11:05.743

找到了摆脱错误的方法。

在 libcore/JavaLibrary.mk（第 155 行）中，将 mockwebserver-hostdex 更改为 mockwebserver-host

这是 AOSP 中的一个错误。在他们修复它之前，这将起作用。

来源（在其中一条评论中）：[https ://groups.google.com/forum/#!msg/android-building/o8Qg4CVrN70/fR0OOu9xAZcJ](https://groups.google.com/forum/#!msg/android-building/o8Qg4CVrN70/fR0OOu9xAZcJ)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-03T16:53:14.893

只要确保你安装了 OpenJDK 7 并且你完成了。

从这里安装 OpenJDK 7：[https ://stackoverflow.com/a/16263651/3621912](https://stackoverflow.com/a/16263651/3621912)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-22T07:01:58.077

看起来像是 JDK 的问题和不正确的环境设置。确保您已为 Android KK [Java JDK6] 安装了正确的 JDK。我在 Android Lollipop 中遇到的类似问题。

# php - php，导出到 .csv 字符集编码问题

> ID：14446074
> 
> 赞同：0
> 
> 时间：2013-01-21T19:46:29.700
> 
> 标签：php, mysql, csv, joomla, joomla2.5

当我想将数据库中的数据导出为 CSV 时，我遇到了问题。

```
$data =new stdClass();
$data->id = NULL;
$data->data = serialize($data_to_store);
$db = JFactory::getDBO();
$db->insertObject('#__hollow', $data, 'id'); 
```

上面的代码是从`html`表单中保存数据。

```
$query->select('p.data');
$query->from('`#__hollow` AS p'); 
```

当我回显时`p.data`一切正常，但当我将其插入到 .csv 时，一切看起来都很乱。现在代码中最重要的部分在哪里出错但不知道在哪里

```
foreach ($this->data as $key => $question) {
     $CSV[] = utf8_decode($question->question_name) . $this->delimiter . implode($this->delimiter, $question->question_answers);
}
return implode("\n", $CSV); 
```

和 ：

```
header("Pragma: public");
header("Expires: 0");
header("Content-type: text/csv; charset=utf-8");  
header("Content-Disposition: attachment;filename={$filename}"); 
```

我试着做开关`utf8_decode`，`utf8_encode`但它不工作。对不起我糟糕的英语。如果你能指出我犯错的地方，我将不胜感激。

# c# - 当 MainForm 关闭时

> ID：14446084
> 
> 赞同：1
> 
> 时间：2013-01-21T19:47:11.000
> 
> 标签：c#, forms

> **可能重复：**
> [当我关闭启动表单时，如何防止应用程序终止？](https://stackoverflow.com/questions/10769193/how-do-i-prevent-the-app-from-terminating-when-i-close-the-startup-form)

当主窗体关闭时，如何阻止应用程序结束？我想检查如果`Application.OpenForms.Count == 1`它是真的，然后才关闭应用程序。所以我想在最后一个表单关闭时关闭应用程序。

# c# - 从多个表中填充 rdlc 报告

> ID：14446085
> 
> 赞同：0
> 
> 时间：2013-01-21T19:47:16.500
> 
> 标签：c#, asp.net, rdlc

我有一个 RDLC 报告，其中显示了一个行表，每个行代表特定客户的员工的时间表条目，例如：

> ```
> Date      Client    Employee  |Work Type |Hours Rate Total Total Invoiced Profit
> 2012-01-20|Client A|Employee 1|Project A |3.00|30.00|90.00|120.00        |30.00
> 
> 2012-02-20|Client A|Employee 2|Project B |2.00|40.00|80.00|100.00        |20.00
> 
> ....................................................................
> 
> Totals Client A                           5.00|70.00|170.00|220.00       |50.00
> 
> Company annual Fee 2012                              150.00
> 
> Total PL                                             200.00 
> ```

上表的数据来自两个不同的表，Timesheet Entries 表保存为每个客户输入的小时数，InvoiceEntries 表保存客户的发票金额。数据的 DataTable 是通过运行查询 JOINing 两个表并返回一个表来填充的，例如：

> ```
> Date|Employee|Client|Hours Worked|Rate|Total|Invoiced Amount|Annual Fees 
> ```

现在，由于同一客户的所有行的年费都相同，并且因为我想按客户对数据行进行分组并在报告的底部有总计，我以编程方式在后面的代码中创建了一个新的 DataTable，我使用它来填充数据表中的数据我通过在其行中运行循环从数据库查询中获得，但我操纵AnnualFees 字段以仅在更改公司时才具有值，否则我将其设置为零。因此，我确保每个客户的年费字段只填充一次，这样当我计算报表底部的总计字段时，我会得到正确的值。

效果很好，但是现在用户要求在运行报告时，如果有 2013 年的年费（以便报告期涵盖两年或更长时间），希望在每个年费之后单独列出客户的时间表条目总计。

显然我不能再在数据表中使用额外的字段，因为年费存在的年数是未知的。

有谁知道我可以实现这个？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T07:48:44.440

我解决了这个问题；为了将来参考，这是我所做的：我在我的数据表中添加了一个名为 RowType 的新字段。在代码隐藏中，我进行了两次数据库调用，一次检索时间表条目，第二次检索每家公司的年费。使用它们，我构建了用于将报表绑定到的数据表。包含时间表条目的行的 RowType 字段等于“项目费用”，而包含年费的行将其设置为“年费”。

然后，我根据新字段在报表上创建了一个额外的 RowGroup，并相应地设置其可见性和排序参数，以便在 RowType 具有一个值或另一个值时显示/不显示。

这似乎奏效了。

# php - CakePHP 2.x 中的配置设置 'Security.level' 仍在使用吗？

> ID：14446088
> 
> 赞同：5
> 
> 时间：2013-01-21T19:47:37.610
> 
> 标签：php, cakephp, cakephp-1.3, cakephp-2.2

[我在CakePHP 2.2 手册](http://book.cakephp.org/2.0/en/development/configuration.html)中找不到对`Security.level`Cake 1.3 配置设置的任何参考。

[我在迁移指南](http://book.cakephp.org/2.0/en/appendices/migrating-from-cakephp-1-2-to-1-3.html)中也找不到对此设置的任何参考。

这个设置对 Cake 1.3 中的会话计时器有很大的影响。

> **安全级别**
> 
> > CakePHP 的安全级别。'Session.timeout' 中定义的会话超时时间根据此处的设置相乘。
> > 
> > 'high' = x 10 'medium' = x 100 'low' = x 300 'high' 和 'medium' 也启用 session.referer_check

`config.php`CakePHP 2.x 中是否删除了应用程序中的这个设置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T20:00:33.957

## 否 该设置尚未删除

它仍然存在于[core.php](https://github.com/cakephp/cakephp/blob/master/app/Config/core.php#L181)

```
/**
 * The level of CakePHP security.
 */
Configure::write('Security.level', 'medium'); 
```

## 但...

它没有在 2.x 中使用。

对此设置的唯一引用是在[Security::inactiveMins](https://github.com/cakephp/cakephp/blob/master/lib/Cake/Utility/Security.php#L36)中——它不会被其他任何东西调用。因此，虽然在 2.x 中仍然存在此设置的人工制品，但此设置的意图已被删除，因此不在 2.x 文档中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-02T08:04:19.700

随着 CakePHP 2.3`Security.level`从`core.php`.

会话超时由以下设置设置：

```
Configure::write('Session.timeout', '120'); 
```

另外：[修改 CakePHP 会话的会话 cookie 过期和会话超时](https://stackoverflow.com/questions/9292890/modify-session-cookie-expiry-and-session-timeout-for-a-cakephp-session/22125253#22125253)

# java - 我在arrayList的线程“main”java.util.NoSuchElementException中不断收到异常

> ID：14446090
> 
> 赞同：0
> 
> 时间：2013-01-21T19:47:45.253
> 
> 标签：java, arraylist

每当我运行应该分析文本输入的代码时，我都会得到以下输出。用于计算单词和字母数字数字的其他方法有效，但假设吐出具有五个或更多字符的单词的其他方法不起作用。我不断收到一个错误，说没有这样的元素，我猜这意味着迭代器找不到更多元素，但这不应该发生，因为我使用了 while 语句。

这是输出：

```
输入文字
 跑步
 字数：1
 字母数字计数：7
 按升序排列的单词
 跑步
 有五个或更多字符的单词
 线程“主”java.util.NoSuchElementException 中的异常
在 java.util.AbstractList$Itr.next（未知来源）
在 com.yahoo.chris511026.paragraphcount.ManifoldMethod.wordSort(ManifoldMethod.java:55)
在 com.yahoo.chris511026.paragraphcount.ParagraphAnalyzer.main(ParagraphAnalyzer.java:15)

```

我的代码：

```
package com.yahoo.chris511026.paragraphcount;

import java.util.ArrayList;
import java.util.Collections;
import java.util.Iterator;

public class ManifoldMethod { 

static ArrayList<String> stringList = new ArrayList<String>();

public static void wordCount(String data) {

        int counter = 0;

            for (String str : data.split("[^a-zA-Z-']+")) {

                stringList.add(str);
                counter++;

            }

        System.out.println("Word count: " + counter);

}

public static void alphanumericCount(String data) {

    data = data.replaceAll("[[^a-z]&&[^A-Z]&&[^0-9]]", "");

    System.out.println("Alphanumeric count: " + data.length());

}

public static void wordSort(String data) { 

    Collections.sort(stringList, new StringComparator());

    System.out.println("Words in ascending order ");  

        for (String s: stringList)

            System.out.println(s);

    System.out.println("Words with five or more characters ");

        int count=0;

        Iterator<String> itr=stringList.iterator();

            while(itr.hasNext())

 if (itr.next().replaceAll("[[^a-z]&&[^A-Z]&&[^0-9]]", "").length  ()>=5)         {

                    System.out.println(itr.next());
                    count++;

                }

                if (count==0) {

                    System.out.println("None.");

                }

}

  } 
```

**编辑：**

我纠正了它，`String str=itr.next();` 在这里使用的是新的部分。但是现在我知道该`String`变量无法解析为变量。为什么？

```
while(itr.hasNext())
    String str=itr.next();  
    if (str.replaceAll("[[^a-z]&&[^A-Z]&&[^0-9]]", "").length  ()>=5) {
        System.out.println(str);
        count++;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T19:49:58.833

问题是你打`next()`了两次电话：

```
 while(itr.hasNext())

           if (itr.next().replaceAll("[[^a-z]&&[^A-Z]&&[^0-9]]", "").length  ()>=5)         {
           //      ^^^^^^

                System.out.println(itr.next());
                //                     ^^^^^^ 
```

这意味着当`if`条件满足时，主体会`if`尝试对匹配的元素*之后的元素进行操作。*

您需要每次迭代调用一次并将结果存储在变量中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T19:50:46.200

在 while 方法中调用 itr.next() 两次。第二次调用它时，抛出异常（因为那里没有更多元素。您可能应该将您的 while 循环重写为如下内容：

```
while(itr.hasNext()) {
    String s = itr.next();
    if (s.replaceAll("[[^a-z]&&[^A-Z]&&[^0-9]]", "").length  ()>=5)         {
        System.out.println(s);
        count++;
    }
    if (count==0) {
        System.out.println("None.");
    }
} 
```

# perl - 在 Perl 中有条件地推送到 2 个数组中的 1 个

> ID：14446093
> 
> 赞同：6
> 
> 时间：2013-01-21T19:47:53.160
> 
> 标签：perl

有一个更好的方法吗？我正在尝试根据标量的值构建 2 个数组：

```
my (@x, @y);
my $r = [$v1, $v2, $v3];
push @x, $r if $s eq 'YES';
push @y, $r if $s ne 'YES'; 
```

我尝试使用：

```
push $s eq 'YES' ? @x : @y, $r; 
```

有和没有括号，但不行。

错误是：

```
Type of arg 1 to push must be array (not null operation) at comp_report.pl line 79, near "$r;" 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-21T19:55:38.167

push 要求它的第一个参数是一个实际的数组（至少在 perl 5.14 和更早版本之前 - 它可能已经改变），而不是一个表达式，所以你需要：

```
push @{ $s eq 'YES' ? \@x : \@y}, $r; 
```

从 5.14 开始，诸如 push [experimentally 之类的内置函数可以采用任意硬引用](http://perldoc.perl.org/perl5140delta.html#Array-and-hash-container-functions-accept-references)，所以这样可以：

```
push $s eq 'YES' ? \@x : \@y, $r; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-21T19:55:51.857

```
push @{ $s eq 'YES' ? \@x : \@y }, $r; 
```

`push`真的很想得到一个数组作为它的第一个参数，但你仍然可以通过使用引用来动态选择目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T08:37:33.107

我的首选解决方案是

```
if($s eq 'YES'){
   push @x, $r; 
else{
    push @y, $r;
} 
```

只是风格的东西。使用三元表达式作为 push 的第一个参数对我来说看起来很乱，而且我不介意额外的行。个人口味我猜！

# web-services - 已部署的 WSDL 移除了其 XSD 限制

> ID：14446100
> 
> 赞同：3
> 
> 时间：2013-01-21T19:48:21.083
> 
> 标签：web-services, tomcat, wsdl, websphere, axis

我正在尝试使用 TOP-DOWN 和 Axis 1.4 部署 Web 服务，通过 Eclipse 的向导“Web 服务 > 生成 Java 骨架”，我有一个包含其模式的 WSDL。一种特定的 complexType 对其元素有限制（用于输入）：

```
 <xsd:complexType name="InformacionClienteRequestModel">
    <xsd:sequence>
      <xsd:element name="numRut">
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:pattern value="\d{9}\-[k|K|0-9]"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>          
      <xsd:element name="codSituacion">
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:pattern value="([ABST][AP][AP])?|([ABST][AP][AP])(,([ABST][AP][AP]))*"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element name="filtroCodSituacion">
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:pattern value="[IE]?"/>
          </xsd:restriction>            
        </xsd:simpleType>
      </xsd:element>            
      <xsd:element name="pagina">
        <xsd:simpleType>
          <xsd:restriction base="xsd:int">
            <xsd:minInclusive value="1"/>               
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element name="registrosPorPagina">
        <xsd:simpleType>
          <xsd:restriction base="xsd:int">
            <xsd:minInclusive value="1"/>
            <xsd:maxInclusive value="50"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>          
    </xsd:sequence>
  </xsd:complexType> 
```

当它部署在服务器上时（我尝试了 Websphere 和 Tomcat），这个 complexType 结束如下：

```
<complexType name="InformacionClienteRequestModel">
<sequence>
<element name="numRut" type="xsd:string"/>
<element name="codSituacion" type="xsd:string"/>
<element name="filtroCodSituacion" type="xsd:string"/>
<element name="pagina" type="xsd:int"/>
<element name="registrosPorPagina" type="xsd:int"/>
</sequence>
</complexType> 
```

它显然没有通过 SOAP 验证输入数据，我到处搜索，但没有得到任何东西。

有任何想法吗？

# assembly - 无法在 8051 汇编编程语言中声明过程

> ID：14446109
> 
> 赞同：0
> 
> 时间：2013-01-21T19:49:23.387
> 
> 标签：assembly, microcontroller, 8051

我想使用 8051 程序。我想要做的是声明一个延迟程序并将其用于 LED 闪烁。我正在使用**Keil uVision3**来编写我的代码。我用谷歌搜索了很多，但没有找到任何帮助。下面是我的程序的示例代码。

```
ORG 00h

MOV P0, #00h
MOV P1, #00h
MOV P2, #00h
MOV P3, #00h

CALL DELAY PROC     ;calling delay procedure to produce some delay.

DELAY PROC           ;procedure implementation starts here for generating some delay

    MOV R0, #255

    NOW:
    DJNE R0, 0 , HERE

    MOV R1, #255

    HERE: 
    DJNE R1, 0, NOW

    RET
    ENDP

END 
```

此代码给出了一些语法错误。声明过程的正确语法是什么以及如何使用它。请指导我，我的代码有什么问题，请纠正我。我会很感激你的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:45:00.423

对于普通的 8051 芯片，您甚至不必费心声明程序 - 只需给它们一个标签并调用它们即可。如：

```
 ACALL delay
    ; ... main progam continues here
    ; make sure you don't fall through into your procedure!

delay:
    ; ... procedure code here ...
    RET 
```

如果您确实想声明您的程序，根据[keil 手册](http://www.keil.com/support/man/docs/a51/a51_st_proc.htm)，您必须执行以下操作：

```
 CALL delay
    ; ... main progam continues here
    ; make sure you don't fall through into your procedure!

delay PROC
    ; ... procedure code here ...
    RET
delay ENDP 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-03T03:05:44.367

```
ORG 0000

;MAIN PROGRAM

ACALL DELAY

;MAIN END

DELAY:
MOV R0, #255 //COUNTS VALUE
NOW: MOV R1, #255 //COUNTS VALUE (255*255 = COUNTS )
AGAIN: DJNZ R1 AGAIN // R1 WILL DECREMENTED UNTILL ZERO ENCOUNTERS
DJNZ R0 NOW // R0 WILL ALSO BE DECREMENTED UNITLL ZERO ENCOUNTERS, BUT MAKE R1 RELOADED 255 TIMES
RET // RETURN THERE FROM WHERE IT IS CALLED, I MEAN TO MAIN 
```

# wpf - 如何在 DevExpress GridControl 中访问 ScrollViewer？

> ID：14446112
> 
> 赞同：0
> 
> 时间：2013-01-21T19:49:33.507
> 
> 标签：wpf, devexpress, scrollviewer, gridcontrol

我必须访问 GridControl 中的 ScrollViewer 才能在滚动时与我的其他 GridControls 同步。

在我使用 vanilla DataGrid 之前，很容易通过 VisualTreeHelper 获取 ScrollViewer，然后订阅 ScrollChanged 事件。

我尝试了与 GridControl 相同的方法，但没有运气。`VisualTreeHelper.GetChildrenCount()`给我 0 也`LogicalTreeHelper.GetChildren()`给了我一个空的迭代器。

但..

WPF Snooper 可以完美地访问逻辑和可视化树！那么，我做错了什么以及为什么我无法获得 WPF Snooper 能够获得的信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:31:12.380

就是这样！我试图过早地初始化它。

我在构造函数中做了它，当它被初始化时。

如果有人需要解决方案如何同步数据网格（无论是普通的**DataGrid**还是*DevExpress* **GridControl**或它们的混合）以在水平滚动并且有更多列时显示相同的数据，那么你可以显示然后这里是解决方案：

在您的构造函数中：

```
 mainDataGrid.Loaded += (sender, args) =>
                           {
                               ScrollViewer sv = mainDataGrid.FindVisualTreeChild<ScrollViewer>();

                               if (sv != null)
                                   sv.ScrollChanged += DataGridScrollChanged;

                           }; 
```

为 ScrollChanged 事件添加事件处理程序：

```
private void DataGridScrollChanged(object sender, ScrollChangedEventArgs e)
{
    if (e.HorizontalChange == 0.0f)
        return;
    ScrollViewer sv = dependentDataGrid1.FindVisualTreeChild<ScrollViewer>();
    if (sv != null)
        sv.ScrollToHorizontalOffset(e.HorizontalOffset);

    sv = dependentDataGrid2.FindVisualTreeChild<ScrollViewer>();
    if (sv != null)
        sv.ScrollToHorizontalOffset(e.HorizontalOffset);
} 
```

# c++ - InternetReadFile() 似乎没有读取互联网数据

> ID：14446114
> 
> 赞同：2
> 
> 时间：2013-01-21T19:49:54.240
> 
> 标签：c++, download, wininet

我是这里网站上的新人，所以如果我在这篇文章中做错了什么，请原谅我。

我正在使用`WinINet`并尝试`binary file`从 Internet 下载 a，但是由于某种原因，当我使用 实际下载该文件`InternetReadFile()`时，它根本没有返回读取内容（读取了 0 个字节的信息）。运行`Visual Studio 2012 debugger`向我揭示了该细节，因为`HINTERNET`我提供给 API 调用的处理程序肯定有数据。我只是不明白我做错了什么。也许你们可以帮忙？

我的程序的基本要点是我从网上下载一个二进制文件，并将其保存到一个临时目录中的临时文件中。将内容复制到临时文件后，我将该临时文件的二进制数据内容传输到另一个本地文件（这次在有效目录中）。这是我到目前为止所拥有的。希望通过我提供的逻辑分解，尽管代码很长，你们仍然能够遵循它......

```
#include "httpfileretrieval.h"    // contains all handlers (hInstance, etc.)

bool downloadFile(const char* lpszServer, const char* lpszUrl, const char* destPath) 
{
    FILE *tempFile  = NULL;
    FILE *localFile = NULL;

    const int bufsize = 4096;
    DWORD tempDirBytes;
    DWORD dwSize = 4096;           // experiment - ignore the fact this is the same as bufsize
    DWORD dwRead = 0;

    char lpszDataBuffer[bufsize];
    lpszDataBuffer[bufsize] = '\0';

    char tempPath[MAX_PATH];
    char tempFileName[bufsize];  // will hold the FULL temp file path

    std::string srcPath;
    srcPath.append(lpszServer);
    srcPath.append(lpszUrl);    // http://www.domain.com/url into srcPath

    hInstance = InternetOpen("httpfret", 
                         INTERNET_OPEN_TYPE_PRECONFIG,
                         NULL,
                         NULL,
                         INTERNET_FLAG_ASYNC); // ASYNC Flag

    if (!hInstance)
    {
        DWORD errorNum = GetLastError();
        fprintf(stderr, "InternetOpen Failed! Windows Error %d\n", errorNum);
        return false;
    }

    // Setup callback function due to INTERNET_FLAG_ASYNC
    if (InternetSetStatusCallback(hInstance,(INTERNET_STATUS_CALLBACK)&Callback) 
    == INTERNET_INVALID_STATUS_CALLBACK)
    {
        DWORD errorNum = GetLastError();
        fprintf(stderr, "InternetSetStatusCallback Failed! Windows Error %d\n", errorNum);
        return false;
    }

    // First call that will actually complete asynchronously even though 
    // there is no network traffic
    hConnect = InternetConnect(hInstance, 
                           lpszServer, 
                           INTERNET_DEFAULT_HTTP_PORT,
                           NULL,
                           NULL,hg
                           INTERNET_SERVICE_HTTP,
                           0,
                           1); // Connection handle's Context
    if (!hConnect)
    {
        if (GetLastError() != ERROR_IO_PENDING)
        {
            DWORD errorNum = GetLastError();
            fprintf(stderr, "InternetConnect Failed! Windows Error %d\n", errorNum);
            InternetCloseHandle(hInstance);
            return false;
        }
        // Wait until we get the connection handle
        WaitForSingleObject(hConnectedEvent, INFINITE);
    }

    // Open the request
    hRequest = HttpOpenRequest(hConnect, "GET", lpszUrl, NULL, NULL, NULL,
                           INTERNET_FLAG_RELOAD | INTERNET_FLAG_NO_CACHE_WRITE,
                           2);  // Request handle's context 
    if (!hRequest)
    {
        if (GetLastError() != ERROR_IO_PENDING)
        {
            DWORD errorNum = GetLastError();
            fprintf(stderr, "HttpOpenRequest Failed! Windows Error %d\n", errorNum);
            InternetCloseHandle(hConnect);
            InternetCloseHandle(hInstance);h
            return false;
        }
        // Wait until we get the request handle
        WaitForSingleObject(hRequestOpenedEvent, INFINITE);
    }

    // Send the request
    if (!HttpSendRequest(hRequest, NULL, 0, NULL, 0))
    {
        if (GetLastError() != ERROR_IO_PENDING)
        {
            DWORD errorNum = GetLastError();
            fprintf(stderr, "HttpSendRequest Failed! Windows Error %d\n", errorNum);
            InternetCloseHandle(hRequest);
            InternetCloseHandle(hConnect);
            InternetCloseHandle(hInstance);
            return false;
        }
    }

    if (bVerbose)
    {
        printf("HttpSendRequest called successfully\n");
    }

    WaitForSingleObject(hRequestCompleteEvent, INFINITE);

    // Before downloading file...
    // 1\. Get the temp directory
    if (!(tempDirBytes = GetTempPathA(MAX_PATH, tempPath)))
    {
        fprintf(stderr, "Could not get temporary directory\n");
        InternetCloseHandle(hRequest);
        InternetCloseHandle(hConnect);
        InternetCloseHandle(hInstance);
        return false;
    }

    // 2\. Get temp file name (full name: tempPath\temp.tmp)
    srand(GetTickCount());
    sprintf(tempFileName, "%s\\%08X.tmp", tempPath, rand());

    // Error check the end of temp file name for ending double slash
    if (tempFileName[bufsize] == '\\')
        tempFileName[bufsize] = '\0';

    // 3\. Create temp file
    printf("Creating temp file %s\nto store %s\n", tempFileName, srcPath.c_str());
    tempFile = fopen(tempFileName, "wb");       // Open the file for writing
    if (!tempFile)
    {
        DWORD errorNum = GetLastError();
        fprintf(stderr, "Could not create temp file! Error %d\n", errorNum);
        InternetCloseHandle(hRequest);
        InternetCloseHandle(hConnect);
        InternetCloseHandle(hInstance);
        return false;
    }
    printf("Done!\n\n");

    printf("------------------- Read the response -------------------\n");

    unsigned long n = 0;
    unsigned long sum = 0;

    printf("Copying %s\n to %s\n", srcPath.c_str(), tempFileName);

    // WHERE THE MAGIC HAPPENS - AND WHERE EVERYTHING FAILS!
    while ( InternetReadFile(hRequest, lpszDataBuffer, dwSize, &dwRead) && !(bAllDone) )
    {
        if (dwRead != 0)
        {
            sum = 0;
            fwrite(lpszDataBuffer, 1, dwRead, tempFile);
            for (unsigned long i = 0; i < dwRead; ++i)
            {
                sum += lpszDataBuffer[i];
                sum %= 0xFFFF;
            }
            printf("Received 4KB block %d. Sum %04X\r", n++, sum);
        }
        else
        {
            bAllDone = TRUE;
            printf("\n");
            break;
        }
    }

    printf("\n\n------------------- Request Complete ----------------\n");

    fclose(tempFile);               // Done writing to file
    tempFile = fopen(tempFileName, "rb");   // Reopen for reading

    //Create the local file
    printf("Creating local file %s\n", destPath);
    localFile = fopen(destPath, "wb");
    if (!localFile)
    {
        DWORD errorNum = GetLastError();
        fprintf(stderr, "Could not create local file! Windows Error %d\n", errorNum);
        fclose(tempFile);
        remove(tempFileName);       // delete temporary file from machine
        InternetCloseHandle(hRequest);
        InternetCloseHandle(hConnect);
        InternetCloseHandle(hInstance);
        return false;
    }
    printf("Done!\n\n");

    // Copy the contents from the temp file to the local file
    printf("Copying temp file %s contents\nto local file %s\n", tempFileName, destPath);
    if (!copyFile(tempFile, localFile))
    {
        DWORD errorNum = GetLastError();
        fprintf(stderr, "Could not copy temp file to local directory! Windows Error\n", errorNum);
        fclose(tempFile);
        remove(tempFileName);       // delete temporary file from machine
        fclose(localFile);
        InternetCloseHandle(hRequest);
        InternetCloseHandle(hConnect);
        InternetCloseHandle(hInstance);
        return false;
    }
    printf("Done!\n\n");

    // end of logic housekeeping
    fclose(tempFile);

    printf("Deleting temp file %s\n", tempFileName);
    remove(tempFileName);   // delete temporary file from machine
    printf("Done!\n\n");

    fclose(localFile);

    printf("Ending Internet Session\n");
    InternetCloseHandle(hRequest);
    InternetCloseHandle(hConnect);
    InternetCloseHandle(hInstance);
    printf("Done!\n");

    printf("Press Enter to continue\n");
    std::cin.get();

    return true;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:33:19.900

你的代码对我有用。您确定服务器正在返回非空响应吗？您可以使用 Fiddler2 之类的工具进行检查。这段代码有很多问题，包括这里的缓冲区溢出：`lpszDataBuffer[bufsize] = '\0';`. 此外，您使用的是异步模式，但您的读取循环中没有任何异步处理。我建议您在此处发布代码以供审核：[https](https://codereview.stackexchange.com/) ://codereview.stackexchange.com/ 。

最后一点。如果您只是要等待每个操作完成，那么异步执行操作没有任何好处。你可以离开`INTERNET_FLAG_ASYNC`国旗。这将使您的功能更加简单。

# jquery - 如何在使用 Jquery 指定操作后执行默认链接操作？

> ID：14446118
> 
> 赞同：0
> 
> 时间：2013-01-21T19:50:03.170
> 
> 标签：jquery

我有一个“滑出” div，我通过 CSS 定位隐藏/显示，并使用 jquery 切换设置 div 的隐藏/显示状态的类。

这一切都很好。我现在要做的是让页面上更远的任何链接更改类以显示 div，然后从页面跳转到它。

这是我所拥有的：

```
$('a[href="#request-trial"]').click(function () {
  $("#request-trial").toggleClass("on off");
}); 
```

问题是它首先跳到锚点，然后改变类，所以当它“关闭”而不是“打开”时它跳到 div 的位置 - 这有意义吗？有没有人有什么建议？

* * *

添加一些额外的信息：

HTML：

```
<section class="form-popup on" id="request-trial">
<div class="container">
<h1>Let's Talk more!</h1>
<p>Have a project in mind or have an organizational challenge you need assistance in tackling? Get in touch... we’ll discuss ways that the Beyond Nines team could help.</p>

<a class="close">Close</a>
</div>
</section> 
```

链接类似于：

```
<a href="#request-trial">Sign up</a> 
```

CSS：

```
.form-popup,
.form-popup.on {
position: absolute;
height: 500px;
z-index: 0;
bottom: 0px;
opacity: 1;
 }

 .form-popup.off {

 bottom: -580px;
 opacity: 0;

  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T19:55:33.577

试试这个：

[http://jsfiddle.net/Ag98N/2/](http://jsfiddle.net/Ag98N/2/)

```
var documentBody = (($.browser.chrome)||($.browser.safari)) ? document.body : document.documentElement;
      $('a[href="#request-trial"]').click(function (e) {
         e.preventDefault();
         var $targetElem = $("#request-trial")
         $targetElem.toggleClass("on off");
          if($targetElem.is('.on'))
         $(documentBody).animate({scrollTop: $targetElem.offset().top}, 50);
      }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T19:58:07.957

这是我的代码

```
$('a[href="#request-trial"]').click(function(evt) {
  evt.preventDefault();
  var target = $("#request-trial");
  target.toggleClass("on off");
  if (target.length > 0 && target.hasClass("on"))
  {
     $("html, body").animate({
         scrollTop: target.offset().top - $(window).height()
     }, 500);
  } 
}); 
```

# java - 如何将 Menu Inflation 隔离为仅两个项目？

> ID：14446126
> 
> 赞同：0
> 
> 时间：2013-01-21T19:50:31.387
> 
> 标签：java, android, eclipse, menu

我试图将我的菜单膨胀隔离到两个项目。我总共有六个项目。单击一个项目时，我希望出现第一个菜单。单击另一个项目时，我希望出现第二个菜单。

我的代码现在的方式是，当您单击六个项目中的三个时，会出现第一个菜单。当您单击六个项目中的其他三个时，会出现第二个菜单。

我该如何做到这一点，只有在单击一个特定项目时才会出现第一个菜单，而单击另一个特定项目时会出现第二个菜单？这是我现在的代码。

```
package com.carouseldemo.main;

import android.app.Activity;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.ContextMenu;
import android.view.ContextMenu.ContextMenuInfo;
import android.view.MenuInflater;
import android.view.View;
import android.widget.TextView;
import android.widget.Toast;

import com.carouseldemo.controls.Carousel;
import com.carouseldemo.controls.CarouselAdapter;
import com.carouseldemo.controls.CarouselAdapter.OnItemClickListener;
import com.carouseldemo.controls.CarouselAdapter.OnItemSelectedListener;
import com.carouseldemo.controls.CarouselItem;

public class MainActivity extends Activity {

     @Override
      public void onCreateContextMenu (ContextMenu menu, View v, ContextMenuInfo menuInfo) {

    if (flag)
       {
           menu.add("Product 1");
           menu.add("Product 2");
       }
       else 
       {
           menu.add("context");
           menu.add("menu");

       }
         super.onCreateContextMenu(menu, v, menuInfo);

      }
     boolean flag=false;

        /** Called when the activity is first created.
         * @return */
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    MediaPlayer mp = MediaPlayer.create(this, R.raw.radio);
    mp.start();
    Carousel carousel = (Carousel)findViewById(R.id.carousel);
    registerForContextMenu (carousel);
    carousel.setOnItemClickListener(new OnItemClickListener(){

         @Override           
        public void onItemClick(CarouselAdapter<?> parent, View view,
                                    int position, long id) {       
                          if (flag)
                          {
                              flag=false;
                          }
                          else
                          {
                              flag=true;
                          }
                          registerForContextMenu(view); 
                          openContextMenu (view);
                            Toast.makeText(MainActivity.this,
                                            String.format("%s has been clicked",
                                            ((CarouselItem)parent.getChildAt(position)).getName()),
                                            Toast.LENGTH_SHORT).show();                            
                    }

                    @Override
                    public void onCreateContextMenu(ContextMenu menu,
                            View v, ContextMenuInfo menuInfo) {
                        // TODO Auto-generated method stub

                    }

    });

    carousel.setOnItemSelectedListener(new OnItemSelectedListener(){

                    public void onItemSelected(CarouselAdapter<?> parent, View view,
                                    int position, long id) {

                    final TextView txt = (TextView)(findViewById(R.id.selected_item));

                            switch(position){
                            case 0:
                                    txt.setText("The cat (Felis catus), also known as the domestic cat or housecat to distinguish it from other felids and felines, is a small, usually furry, domesticated, carnivorous mammal that is valued by humans for its companionship and for its ability to hunt vermin and household pests. Cats have been associated with humans for at least 9,500 years, and are currently the most popular pet in the world. Owing to their close association with humans, cats are now found almost everywhere in the world.");
                                    break;
                            case 1:
                                    txt.setText("The hippopotamus (Hippopotamus amphibius), or hippo, from the ancient Greek for \"river horse\" (á¼±Ï€Ï€Î¿Ï€ÏŒÏ„Î±Î¼Î¿Ï‚), is a large, mostly herbivorous mammal in sub-Saharan Africa, and one of only two extant species in the family Hippopotamidae (the other is the Pygmy Hippopotamus.) After the elephant, the hippopotamus is the third largest land mammal and the heaviest extant artiodactyl.");
                                    break;
                            case 2:
                                    txt.setText("A monkey is a primate, either an Old World monkey or a New World monkey. There are about 260 known living species of monkey. Many are arboreal, although there are species that live primarily on the ground, such as baboons. Monkeys are generally considered to be intelligent. Unlike apes, monkeys usually have tails. Tailless monkeys may be called \"apes\", incorrectly according to modern usage; thus the tailless Barbary macaque is called the \"Barbary ape\".");
                                    break;
                            case 3:
                                    txt.setText("A mouse (plural: mice) is a small mammal belonging to the order of rodents. The best known mouse species is the common house mouse (Mus musculus). It is also a popular pet. In some places, certain kinds of field mice are also common. This rodent is eaten by large birds such as hawks and eagles. They are known to invade homes for food and occasionally shelter.");
                                    break;
                            case 4:
                                    txt.setText("The giant panda, or panda (Ailuropoda melanoleuca, literally meaning \"black and white cat-foot\") is a bear native to central-western and south western China.[4] It is easily recognized by its large, distinctive black patches around the eyes, over the ears, and across its round body. Though it belongs to the order Carnivora, the panda's diet is 99% bamboo.");
                                    break;
                            case 5:
                                    txt.setText("Rabbits (or, colloquially, bunnies) are small mammals in the family Leporidae of the order Lagomorpha, found in several parts of the world. There are eight different genera in the family classified as rabbits, including the European rabbit (Oryctolagus cuniculus), cottontail rabbits (genus Sylvilagus; 13 species), and the Amami rabbit (Pentalagus furnessi, an endangered species on Amami ÅŒshima, Japan)");
                                    break;
                            }

                    }

                    public void onNothingSelected(CarouselAdapter<?> parent) {
                    }

    }
    );

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:50:03.550

行。如果我理解正确，您只需为`Carousel`班级中的每个项目分配一个单独的上下文菜单。（后来我假设这`Carousel`是一个子类，`AdapterView`因为它是我知道的唯一使用`OnItemSelectedListener`处理程序的类。）

为此，首先要利用这样一个事实，即`Carousel`在显示上下文菜单时，将在上下文菜单侦听器中向您传递额外的信息。您可以提取上下文菜单应应用到的项目位置，并根据该位置创建菜单。为此，您必须更改`onCreateContextMenu()`处理程序：

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    // Just prepare ourself for unexpected arguments...
    if (menuInfo == null) {
        return;
    }
    if (!(menuInfo instanceof AdapterContextMenuInfo)) {
        return;
    }
    AdapterContextMenuInfo mi = (AdapterContextMenuInfo)menuInfo;
    switch (mi.position) {
    case 0:
        menu.add("cat menu");
        break;
    case 1:
        menu.add("hippopotamus menu");
        break;
    case 2:
        menu.add("monkey menu");
        break;
    case 3:
        menu.add("mouse menu");
        break;
    case 4:
        menu.add("panda menu");
        break;
    case 5:
        menu.add("rabbit menu");
        break;
    default:
        break;
    }
    super.onCreateContextMenu(menu, v, menuInfo);
} 
```

试试看，告诉我这是否是你想要的。其余代码保持不变。

# python - Python - 追加 VS 扩展效率

> ID：14446128
> 
> 赞同：20
> 
> 时间：2013-01-21T19:50:39.353
> 
> 标签：python, list, performance

这是我使用 Python 编写的一些代码：

```
from math import sqrt
abundant_list = []

for i in range(12,28123+1):
    dividor_list = [1]
    for j in range(2, int(sqrt(i))+1):
        if i%j == 0:
            dividor_list.extend([i/j,j])
    if sum(dividor_list) > i:
        abundant_list.append(i)

print abundant_list 
```

如您所见，代码实际上是在尽可能地提高效率。

如果我使用`list.append`两次或`list.extend`只使用一次有什么区别？我知道这可能是微小的差异，但我真的很想知道:)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-21T19:56:31.787

```
import timeit

def append2x(foo):
    foo.append(1)
    foo.append(1)

def extend_lst(foo):
    foo.extend([1,1])

def extend_tup(foo):
    foo.extend((1,1))

l1 = []
l2 = []
l3 = []

print timeit.timeit('append2x(l1)',setup = 'from __main__ import append2x,l1')
print timeit.timeit('extend_lst(l2)',setup = 'from __main__ import extend_lst,l2')
print timeit.timeit('extend_tup(l3)',setup = 'from __main__ import extend_tup,l3') 
```

这是一个简单的基准。我的结果（os-X、10.5.8、core2duo、FWIW）：

```
0.520906925201  #append
0.602569103241  #extend-list
0.357008934021  #extend-tuple 
```

我的 linux 机器（Ubuntu，x86-64 core i7）的结果顺序相同：

```
0.307395935059  #append
0.319436073303  #extend-list
0.238317012787  #extend-tuple 
```

对我来说，这意味着`extend`比 更快`append`，但是与创建 a`list`相比，创建 a 相对昂贵`tuple`

* * *

# **编辑**

在下面的评论中指出，由于元组的不变性，解释器可以优化元组的创建（它创建一次元组并一遍又一遍地重用它）。如果我们将代码更改为：

```
def extend_lst(foo):  
    v = 1
    foo.extend([v,v]) 

def extend_tup(foo):
    v = 1
    foo.extend((v,v)) 
```

时间几乎相同：

```
0.297003984451  #append
0.344678163528  #extend-list
0.292304992676  #extend-tuple 
```

尽管仍然始终优于列表版本，并且在我所做的所有试验中`tuple`几乎没有超越该版本。`append`

我要从中删除的一件事是，如果您要迭代一个由所有文字组成的对象，请选择 a`tuple`而不是 a `list`。如果它不完全由文字组成，那么无论您选择`list`还是`tuple`.

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-12-03T21:51:20.770

还值得指出的是，这个问题的答案取决于每次迭代中添加的列表/元组的小尺寸。对于较大的列表，extend 显然更胜一筹（列表与元组没有区别）。从[mgilson](https://stackoverflow.com/users/748858/mgilson)的[回答](https://stackoverflow.com/a/14446207/5635856)开始，我检查了包含 600 个项目而不是 2 个项目的集合的行为：调用 append 600 次所需的时间是使用`extend()`手动定义的列表/元组（即`[v,v,v,v,v,v,v...]`）的 8 倍：

```
42.4969689846
5.45146393776
5.38034892082 
```

这五秒钟的大部分时间实际上是创建列表/元组。在通话之前准备好它`timeit`会带来时间延长到

```
1.42491698265
0.657584905624 
```

分别用于列表和元组。

对于更现实（和更公平）的情况，可以在函数调用中动态生成数据：

```
import timeit

def append_loop(foo, reps):
    for i in range(reps):
        foo.append(i)

def append_comp(foo, reps):
    [foo.append(i) for i in range(reps)]

def extend_lst(foo, reps):
    foo.extend([i for i in range(reps)])

def extend_tup(foo, reps):
    foo.extend((i for i in range(reps)))

repetitions = 600

print timeit.timeit('append_loop([], repetitions)', setup='from __main__ import append_loop, repetitions')
print timeit.timeit('append_comp([], repetitions)', setup='from __main__ import append_comp, repetitions')
print timeit.timeit('extend_lst([], repetitions)', setup='from __main__ import extend_lst, repetitions')
print timeit.timeit('extend_tup([], repetitions)', setup='from __main__ import extend_tup, repetitions') 
```

（Append 是通过 for 循环和列表理解来实现的，以消除两种循环方式之间的效率差异。）

时间是：

```
53.8211231232
57.1711571217
19.8829259872
28.5986201763 
```

正如我们所看到的，使用列表推导进行扩展仍然比追加快两倍多。此外，元组理解似乎比列表理解慢得多，并且`append_comp`只会引入不必要的列表创建开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T19:59:01.700

他们需要完全相同的时间。

这是您的代码所花费的时间：

和`dividor_list.extend([i/j,j])`

```
>>> 
0:00:00.410000
>>> 
0:00:00.383000
>>> 
0:00:00.389000 
```

和`dividor_list.append(i/j); dividor_list.append(j)`

```
>>> 
0:00:00.400000
>>> 
0:00:00.390000
>>> 
0:00:00.381000 
```

# java - 通过 Print Server 打印动态生成的服务器端 HTML

> ID：14446130
> 
> 赞同：0
> 
> 时间：2013-01-21T19:50:46.110
> 
> 标签：java, html, printing

通过 Java 打印服务器打印动态生成的 HTML 的最简单方法是什么？由于项目的限制，我必须将 HTML 字符串发送到打印机。我无法执行任何文件 I/O 来写入 HTML 文件，然后将阅读器发送到打印服务器。我也无法将数据发送到 JSP，然后打印 JSP。

在我所有的在线搜索中，我发现了几个如何从输入阅读器打印文本的示例，但从未从字符串中打印。最好的方法是什么？

我尝试查找纯文本和 html 文本文档风格的打印服务，但没有返回我的打印机：

```
DocFlavor flavor = DocFlavor.STRING.TEXT_PLAIN;
DocFlavor flavor = DocFlavor.STRING.TEXT_HTML; 
```

PS 要求的部分原因是基于 Web 的应用程序需要在不弹出打印对话框的情况下打印到各种类型的打印机。将运行此 Web 应用程序的任何机器都将由我们设置，因此任何设置/权限问题都不是问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:21:46.470

将 String 转换为 InputStream 怎么样？

InputStream 流 = new ByteArrayInputStream(exampleString.getBytes("UTF-8"));

# python - 使用 icanhazip.com 在 python 中使用 mechanize 查找 IP，输出不是我预期的

> ID：14446132
> 
> 赞同：2
> 
> 时间：2013-01-21T19:50:47.107
> 
> 标签：python, networking, mechanize

我正在使用 icanhazip.com 查找我的 IP 地址。当我使用浏览器访问该站点时，我的 ip 以我通常看到的方式输出：174.xx.xx.xx

当我使用 python 和 mechanize 从 icanhazip.com 获取我的 ip 时，我得到以下结果：2001:4800:7810:512:13b2:ccd5:ff04:c5f4

我确信它只是以我从未见过的方式表示 IP 地址。如何将其转换为我习惯的形式？

提前致谢。

```
In [9]: br.open("http://icanhazip.com/")
Out[9]: <response_seek_wrapper at 0x30bbe60 whose wrapped object = <closeable_response at 0x30bb0e0 whose fp = <socket._fileobject object at 0x2dd5ed0>>>

In [10]: br.open("http://icanhazip.com/").read()
Out[10]: '2001:4800:7810:512:13b2:ccd5:ff04:c5f4\n'

In [11]: print br.open("http://icanhazip.com/").read()
2001:4800:7810:512:13b2:ccd5:ff04:c5f4 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-22T13:18:21.440

我是 icanhazip.com 的运营商，我经常收到这个问题。我有两个额外的 DNS 记录可以帮助您获得所需的结果。如果要强制进行 IPv4 查找，请使用[ipv4.icanhazip.com](http://ipv4.icanhazip.com)。对于 IPv6，请使用[ipv6.icanhazip.com](http://ipv6.icanhazip.com)。

如果您只访问[icanhazip.com](http://icanhazip.com)，您看到的结果取决于您的计算机是如何配置为使用 IPv4 或 IPv6 网络的。大多数操作系统默认使用 IPv6（如果可用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T19:53:08.877

看起来它是IPv6。有关详细信息，请参阅[维基百科文章](http://en.wikipedia.org/wiki/IPv6)。

如果尝试 urlopen，你会得到什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T19:57:29.943

那肯定是IPv6，也没有直接转换成IPv4使用的xxx.xxx.xxx.xxx格式，它们是不同的地址。

# c# - 使用 PLinqInstantFeedbackSource 时获取 GridControl 中的所有行

> ID：14446134
> 
> 赞同：0
> 
> 时间：2013-01-21T19:51:03.303
> 
> 标签：c#, .net, wpf, devexpress

我`PLinqInstantFeedbackSource`在填充网格时使用。

```
PLinqInstantFeedbackSource pLinqInstantFeedbackDataSource = new PLinqInstantFeedbackSource();
pLinqInstantFeedbackDataSource.GetEnumerable += pLinqInstantFeedbackDataSource_GetEnumerable;

gridControl.ItemsSource = pLinqInstantFeedbackDataSource;

gridControl.DataContext = SomeViewModel;

private void pLinqInstantFeedbackDataSource_GetEnumerable(object sender, DevExpress.Data.PLinq.GetEnumerableEventArgs e)
{
    e.Source = SomeViewModel.GetList();
} 
```

因此，当我使用以下命令选择所有行时：

```
((DevExpress.Xpf.Grid.TableView)gridControl.View).SelectAll();​ 
```

它似乎选择了所有行。所以这工作正常，但用户没有向下滚动，以便所有行都可见或获取。

所以现在我想遍历所有行并使用以下方法获取行对象：

```
var selectedRowHandles = ((DevExpress.Xpf.Grid.TableView)gridControl.View).GetSelectedRowHandles().AsEnumerable();

foreach (var item in selectedRowHandles)
{
    SomeViewModel.SelectedItems.Add((SomeEntityObject)gridControl.GetRow(item)); 
} 
```

这似乎适用于所有可见行，但是当它尝试获取不可见的下一行时会引发异常：

```
​InvalidCastException
Unable to cast object of type 'DevExpress.Data.NotLoadedObject' to type 'SomeEntityObject'.​ 
```

那么，当行不可见时，如何在使用 PLinqInstantFeedbackSource 时获取 GridControl 中的所有行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:55:16.403

LinqInstantFeedBackSource 在单独的线程中将记录从服务器加载到网格中。如果您尝试访问网格中尚未加载相应记录的行，则源将返回该`NotLoadedObject`类型的对象。由于记录的加载是在后台进行的，因此您可以重复查询该行，直到获得“真实”数据。

```
foreach (var item in selectedRowHandles)
{
    while (gridControl.GetRow(item) is NotLoadedObject)
    {
             Application.DoEvents();
     }
    SomeViewModel.SelectedItems.Add((SomeEntityObject)gridControl.GetRow(item)); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T09:47:55.577

[从DevExpress](http://www.devexpress.com/Support/Center/Question/Details/Q459086)找到正确答案。

# c++ - 如何使用 MPI 和 C++ 从文本文件中读取整数

> ID：14446135
> 
> 赞同：1
> 
> 时间：2013-01-21T19:51:08.027
> 
> 标签：c++, mpi

我在并行阅读方面有点问题

我有一个如下所示的文本文件：

```
1 4 30 46 
0 2 3 29 
1 11 12 -1 
1 4 5 -1 
0 3 13 14 
3 6 7 8 
5 10 -1 -1 
13 10 -1 -1 
5 9 27 -1 
```

我试图在每个进程中一次读取这些整数 4，文件的行数等于进程数，每行包含 4 个整数

```
int bufsize, count; 
int *buf;
MPI::Status status; 

MPI::File top = MPI::File::Open(MPI::COMM_WORLD, "top.txt", MPI::MODE_RDONLY, MPI::INFO_NULL); 

MPI::Offset filesize = top.Get_size(); 
filesize = filesize / sizeof(int);
bufsize = filesize / wasteland_size + 1;

buf = new int[bufsize * sizeof(int)]; 

top.Set_view(my_rank * bufsize * sizeof(int), MPI_INT, MPI_INT, "native", MPI::INFO_NULL); 
top.Read(buf, bufsize, MPI_INT, status); 
count = status.Get_count(MPI_INT); 

top.Close(); 
```

这是我正在使用的代码。

它编译时没有错误或警告，但会输出一些内容：

```
540287025 874524723 805969974 857748000 
```

对于每个过程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:53:10.707

问题是您的文件是一个文本文件，但它没有被解释为这样。您正在从二进制文件中读取整数。

当您将这些数字中的任何一个转换为十六进制时，您会看到它们由代表 ASCII 中的数字或空格的字节组成。

我建议更改文件格式，以便我将每个数字表示为 4 个字节。这也允许您按照您所做的方式拆分文件。

# javascript - GWT Javascript 注入和 JSNI

> ID：14446136
> 
> 赞同：3
> 
> 时间：2013-01-21T19:51:17.693
> 
> 标签：javascript, gwt, jsni, stripe-payments

如何在 JSNI 代码中使用 Javascript 库（从 CDN 下载）？

例如，我想在这个 JSNI 方法中调用 javascript Stripe 方法：

```
 private native void contactStripe(String creditCard, String cvc, String expiryMonth, String expiryYear) /*-{
        $wnd.Stripe.setPublishableKey('my_stripe_publishable_key');
        $wnd.Stripe.createToken({
            number: creditCard,
            cvc: cvc,
            exp_month: expiryMonth,
            exp_year: expiryYear
        }, callBack);
    }-*/; 
```

...但是 Stripe javascript 方法是未定义的。

（更多关于 Stripe.createToken 方法[https://stripe.com/docs/tutorials/forms#create-a-single-use-token](https://stripe.com/docs/tutorials/forms#create-a-single-use-token)）

使用 CDN url 注入 Stripe javascript 文件：

```
ScriptInjector.fromUrl("https://js.stripe.com/v1/").setCallback(
    new Callback<Void, Exception>() {
    public void onFailure(Exception reason) {
    }
    public void onSuccess(Void result) {
        contactStripe("0000111122223333", "456", "04", "2014");
    }
}).inject(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-22T10:56:43.667

如果您希望 JS 脚本以可以通过它定义的全局变量访问的方式注入`$wnd`，您必须这样做。[`setWindow`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/core/client/ScriptInjector.FromUrl.html#setWindow%28com.google.gwt.core.client.JavaScriptObject%29)`(`[`ScriptInjector.TOP_WINDOW`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/core/client/ScriptInjector.html#TOP_WINDOW)`)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:05:42.420

尝试将您的代码更改为：

```
private native void contactStripe(String creditCard, String cvc, String expiryMonth, String expiryYear) /*-{

    console.log($wnd.Stripe);             // Should log 'Object'
    console.log($wnd.Stripe.createToken); // should log function
    var obj = {
        number: creditCard,
        cvc: cvc,
        exp_month: expiryMonth,
        exp_year: expiryYear
    };
    consloe.log(obj);                     // Should be 'Object'
    $wnd.Stripe.createToken(obj, callBack);
}-*/; 
```

如果您使用 chrome 调试工具，您可以检查所有这些对象。

**更新** 您不提供回调。那是你的问题吗？

# iphone - UIImagePickerController 使用自定义叠加进行缩放和裁剪

> ID：14446141
> 
> 赞同：1
> 
> 时间：2013-01-21T19:51:35.603
> 
> 标签：iphone, ios, objective-c, uiimage, uiimagepickercontroller

我的相机的自定义叠加层仅在中心留下一个 320x320 的正方形，因此用户可以只拍摄屏幕上的内容。

我检索原始图片，然后我想将其缩小并仅裁剪叠加层上可见的区域。

我无法让它与 iPhone5 一起使用。它适用于 iPhone3gs、4 和 4s。

这是我到目前为止一直在使用的方法：

```
-(UIImage *)squareImageWithImage:(UIImage *)image scaledToSize:(CGSize)newSize {
    double ratio;
    double delta;
    CGPoint offset;

    //make a new square size, that is the resized imaged width
    CGSize sz = CGSizeMake(newSize.width, newSize.width);

    //figure out if the picture is landscape or portrait, then
    //calculate scale factor and offset
    if (image.size.width > image.size.height) {
        ratio = newSize.width / image.size.width;
        delta = (ratio*image.size.width - ratio*image.size.height);
        offset = CGPointMake(delta/2, 0);
    } else {
        ratio = newSize.width / image.size.height;
        delta = (ratio*image.size.height - ratio*image.size.width);
        if (self.isPickingFromLibrary) {
            offset = CGPointMake(0, delta/2);
        } else {
            // Add 25 for image offset
            offset = CGPointMake(0, delta/2+25);
        }
    }

    //make the final clipping rect based on the calculated values
    CGRect clipRect = CGRectMake(-offset.x, -offset.y,
                                 (ratio * image.size.width) + delta,
                                 (ratio * image.size.height) + delta);

    //start a new context, with scale factor 0.0 so retina displays get
    //high quality image
    if ([[UIScreen mainScreen] respondsToSelector:@selector(scale)]) {
        UIGraphicsBeginImageContextWithOptions(sz, YES, 0.0);
    } else {
        UIGraphicsBeginImageContext(sz);
    }
    UIRectClip(clipRect);
    [image drawInRect:clipRect];
    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return newImage;
} 
```

在 iPhone5 上运行此方法后，图像被大量裁剪和缩放错误。

我正在尝试为方形图像制作一个像样的定制相机，我已经为此苦苦挣扎了几个星期。我什至研究过使用 AVFoundation，但我什至不知道从哪里开始。

如果有人可以帮助我从 uiimagepicker 缩放和裁剪正方形图像，以用于在图像上给出矩形的任何设备，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-26T08:07:41.247

如果您的设备是视网膜显示器，那么您应该应用此代码来调整图像大小

```
-(BOOL)iPhoneRetina{
return ([[UIScreen mainScreen] respondsToSelector:@selector(displayLinkWithTarget:selector:)] && ([UIScreen mainScreen].scale == 2.0))?1:0; 
```

}

```
if([self iPhoneRetina]==TRUE){

    CGRect rect =  CGRectMake(0, 0, point.origin.x, self.trackBackground.frame.size.height);
    rect.size.height = rect.size.height * [_trackImage scale];
    rect.size.width = rect.size.width * [_trackImage scale];
    rect.origin.x = rect.origin.x * [_trackImage scale];
    rect.origin.y = rect.origin.y * [_trackImage scale];
    CGImageRef sourceImageRef = [_trackImage CGImage];
    CGImageRef newImageRef = CGImageCreateWithImageInRect(sourceImageRef, rect);
    cropped = [UIImage imageWithCGImage:newImageRef scale:[_trackImage scale] orientation:[_trackImage imageOrientation]];

}
else{
    imageRef = CGImageCreateWithImageInRect([_trackImage CGImage], CGRectMake(0, 0, point.origin.x, self.trackBackground.frame.size.height));
    cropped = [UIImage imageWithCGImage:imageRef];
} 
```

其中 rect 是图像的矩形，它必须被裁剪，然后根据视网膜调整大小。

# javascript - Circle 播放器无法在 Firefox 中播放 mp3

> ID：14446148
> 
> 赞同：0
> 
> 时间：2013-01-21T19:52:12.050
> 
> 标签：javascript, jquery, html

> **可能重复：**
> [为什么 Firefox 不支持 <audio> 中的 mp3 文件格式](https://stackoverflow.com/questions/4923136/why-doesnt-firefox-support-mp3-file-format-in-audio)

我正在使用圆形播放器..在网页中播放 mp3 文件。它在 IE 和 Chrome 中播放，但在 Firefox 中运行。有什么解决办法吗？谢谢 这是我的代码

```
$(document).ready(function(){                            
var myCirclePlayer = new CirclePlayer("#jquery_jplayer_1",
{
    mp3: "11.mp3"

}, {
cssSelectorAncestor: "#cp_container_1",
canplay: function() {
$("#jquery_jplayer_1").jPlayer("play");
},
supplied: "mp3",
swfPath: "js"
})  

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:00:45.177

不确定它是否会帮助你。但这是我的建议：

```
<div id="jquery_jplayer"></div>
<div id="jp_container_1" class="jp-audio">
<div class="jp-type-single">
  <div id="jp_interface_1" class="jp-interface all_rounded_corners">
    <ul class="jp-controls">
      <li><a href="#" class="jp-play pp" tabindex="1">play</a></li>
      <li><a href="#" class="jp-pause pp" tabindex="1">pause</a></li>
      <li><a href="#" class="jp-previous traverse" tabindex="1">Previous</a></li>
    </ul>
    <div class="jp-progress" style="display:none;">
      <div class="jp-seek-bar">
        <div class="jp-play-bar"></div>
      </div>
    </div>
  </div>
</div>
</div> 
```

这是正确的 JS：

```
$("#jquery_jplayer").jPlayer({
ready: function () {
  $(this).jPlayer("setMedia", { mp3: "your-file.mp3" } );
},
swfPath: "http://www.jplayer.org/latest/js/Jplayer.swf",
supplied: "mp3",
volume: 1,
wmode:"window",
solution: "html,flash",
}); 
```

# caching - 如何强制 Squid 缓存视频/f4f mime-type

> ID：14446149
> 
> 赞同：2
> 
> 时间：2013-01-21T19:52:12.933
> 
> 标签：caching, proxy, video-streaming, squid

我有基于flussonic/erlyvideo + squid代理缓存（本地网络）的hds流服务器。我需要制作鱿鱼缓存视频流片段。Squid 可以缓存来自 inventos.ru 的视频（mime 类型的片段标题文本/纯文本），但不能从我的服务器缓存：video/f4f 片段 mime 类型。

如何制作 squid 缓存视频/f4f 片段。

鱿鱼配置：

```
acl all src all
acl mynet src 192.168.0.0/255.255.255.0

acl SSL_ports port 443          # https
acl SSL_ports port 563          # snews
acl SSL_ports port 873          # rsync
acl Safe_ports port 80          # http
acl Safe_ports port 8080        # stream hds
acl Safe_ports port 1935        # rtmp
acl Safe_ports port 21          # ftp
acl Safe_ports port 443         # https
acl Safe_ports port 70          # gopher
acl Safe_ports port 210         # wais
acl Safe_ports port 1025-65535  # unregistered ports
acl Safe_ports port 280         # http-mgmt
acl Safe_ports port 488         # gss-http
acl Safe_ports port 591         # filemaker
acl Safe_ports port 777         # multiling http
acl Safe_ports port 631         # cups
acl Safe_ports port 873         # rsync
acl Safe_ports port 901         # SWAT
acl purge method PURGE
acl CONNECT method CONNECT

http_access allow all
http_access allow mynet

http_port 3128

acl yammervideo dstdomain *.yammer.com
acl inventos dstdomain inventos.ru
acl targetvideodomain dstdomain v.tst.com
#cache allow video
#cache allow yammervideo
cache allow inventos
cache allow targetvideodomain
cache allow all
#We recommend you to use at least the following line.
hierarchy_stoplist cgi-bin ?

access_log /var/log/squid/access.log squid
cache_dir ufs /var/squidcache 500 16 256

#Suggested default:
refresh_pattern ^ftp:           1440    20%     10080
refresh_pattern ^gopher:        1440    0%      1440
refresh_pattern -i (/cgi-bin/|\?) 0     0%      0
refresh_pattern (Release|Packages(.gz)*)$       0       20%     2880
refresh_pattern .               0       20%     4320

# Don't upgrade ShoutCast responses to HTTP
acl shoutcast rep_header X-HTTP09-First-Line ^ICY.[0-9]
upgrade_http0.9 deny shoutcast

acl apache rep_header Server ^Apache
broken_vary_encoding allow apache

#  TAG: extension_methods
#       Squid only knows about standardized HTTP request methods.
#       You can add up to 20 additional "extension" methods here.
extension_methods REPORT MERGE MKACTIVITY CHECKOUT

hosts_file /etc/hosts

# Leave coredumps in the first cache dir
coredump_dir /var/spool/squid 
```

Squid 访问日志（短）：

```
1358797512.502    939 85.21.245.191 TCP_MISS/200 918268 GET http://v.tst.com/ren/mm1.mp4/hds/tracks-1,2/Seg1-Frag9 - DIRECT/91.218.230.83 video/f4f
1358797516.090    936 85.21.245.191 TCP_MISS/200 571690 GET http://v.tst.com/ren/mm1.mp4/hds/tracks-1,2/Seg1-Frag10 - DIRECT/91.218.230.83 video/f4f 
```

存储日志：

```
1358797618.493 RELEASE -1 FFFFFFFF D16DC1B649CD3523AC0BC86E7C8ECB45  200 1358797616        -1        -1 video/f4f 1737948/1737948 GET http://v.tst.com/ren/mm1.mp4/hds/tracks-1,2/Seg1-Frag28
1358797623.862 RELEASE -1 FFFFFFFF 284EB9F58EF52724EF68378D237F0594  200 1358797622        -1        -1 video/f4f 1578659/1578659 GET http://v.tst.com/ren/mm1.mp4/hds/tracks-1,2/Seg1-Frag29 
```

# ruby-on-rails - ERB：创建下拉菜单并正确链接到它们各自的 ID

> ID：14446151
> 
> 赞同：0
> 
> 时间：2013-01-21T19:52:28.640
> 
> 标签：ruby-on-rails, path, indexing, erb

在我的**controller.rb**中，我有以下代码：

```
@teams = Team.all 
```

这是一些示例**输出**：

```
<Team id: 1, name: "Eastside", nick: "Bunnies", api_team_id: 3235, created_at: "2013-01-18    
 21:19:24", updated_at: "2013-01-18 21:19:24">
<Team id: 2, name: "Westside", nick: "Turtles", api_team_id: 3235, created_at: "2013-01-18     
 21:19:24", updated_at: "2013-01-18 21:19:24">
<Team id: 3, name: "Northside", nick: "Birds", api_team_id: 3235, created_at: "2013-01-18   
 21:19:24", updated_at: "2013-01-18 21:19:24"> 
```

如何创建一个下拉列表，显示每个项目的 Team.name 和 Team.nick？另外，我如何才能链接到团队各自的 team.id？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T19:55:18.667

我认为您需要先阅读一些 Rails 教程。

对于下拉菜单：

```
#in your view
<%= select_tag 'team_id', options_for_select(@teams.map{|team| ["#{team.name} #{team.nick}", team.id] }) %> 
```

关于`link_to`团队的展示页面，我假设您在您的 routes.rb 中声明了您的资源。如果是这样，您应该有 4 CRUD 操作（创建检索更新删除）。然后，如果一切设置正确，您可以执行以下操作：

```
<% team = Team.first %>
<%= link_to team.name, team_path(team) %> 
```

# javascript - 发布前 JavaScript 库格式化的推荐做法

> ID：14446154
> 
> 赞同：4
> 
> 时间：2013-01-21T19:52:41.597
> 
> 标签：javascript, coding-style

假设您刚刚实现了一个包含一些函数的 JavaScript 库，例如：

```
double = function(a){ return a*2; };
root = function(a,b,c){ return -b+Math.sqrt(b*b-4*a*c)/(2*a); };
hypotenuse = function(a,b){ return Math.sqrt(a*a+b*b); }; 
```

像这样分发它不是一个好主意，因为该代码会污染全局命名空间。

在发布之前格式化 JavaScript 库的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T19:57:17.650

由于您的函数不使用类，不需要状态，并且与一个简单的主题相关，您可以简单地将它们发布为

```
myMath = {
   double: function(a){ return a*2; },
   root: function(a,b,c){ return -b+Math.sqrt(b*b-4*a*c)/(2*a); },
   hypotenuse: function(a,b){ return Math.sqrt(a*a+b*b); }
}; 
```

现在假设您想要使用私有函数或状态，那么您可以使用[模块模式](http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth)：

```
myMath = (function(){
   var square = function(x){return x*x}; // private function
   return {
       double: function(a){ return a*2; },
       root: function(a,b,c){ return -b+Math.sqrt(square(b)-4*a*c)/(2*a); },
       hypotenuse: function(a,b){ return Math.sqrt(square(a)+square(b)); }
   }
})(); 
```

但是这里真的没有理由使用这个结构。

现在请注意，在 github 上发布的内容远不止这些（文档、测试单元、readme.md 等），但这很难在 SO 上进行建设性讨论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:09:11.597

关于如何正确命名您的 Javascript 函数的讨论有很好的记录（参见下面的 #2）。我将专注于发布库时经常被遗忘的事情：

1.  **文档**。我怎么强调都不过分。任何想要使用您的库的人都需要知道它的作用以及如何使用它的一些示例。人们经常轻而易举地阅读文档，但他们会专注于示例，因此请确保这些示例教会他们使​​用库的首选方法。在源内部和外部提供文档对于获得采用非常有帮助。

2.  **命名您的函数，以便您与其他人一起玩**。请参阅[如何在 JavaScript 中声明命名空间？](https://stackoverflow.com/questions/881515/javascript-namespace-declaration)了解如何在 Javascript 中完成此操作。

3.  **使用描述其用途的变量、参数和函数名称**。变量名`b`通常不会告诉用户它的预期用途。如果它们很长也没关系，这就是为什么我们提供一个缩小版本供生产使用。

4.  **使您的图书馆易于使用**。提供一个简单的下载和如何开始使用它的说明。

5.  **与您的用户交流**。如果您的项目是开源的，请让人们轻松交流他们遇到的困难（Bug 跟踪、GitHub 问题、邮件列表等）。这将有助于建立一个社区，甚至可能让人们有兴趣回馈社会。

肯定有其他方法可以改进您已发布的库，但这些方法对于最流行的库来说很常见，因此您可能会在尝试在您的库中传播信息之前考虑它们。祝你好运！

# c# - 我应该如何断言两个集合的元素是相同的？

> ID：14446155
> 
> 赞同：5
> 
> 时间：2013-01-21T19:52:42.603
> 
> 标签：c#, unit-testing

我应该如何断言两个集合包含相同的元素 id 顺序无关紧要？

这意味着两个集合中每个元素的数量相同。这里有些例子：

等于：
1,2,3,4 == 1,2,3,4
1,2,3,4 == 4,2,3,1
2,1,2 == 2,2,1
1,2, 2 == 2,2,1

不等于：
1 != 1,1
1,1,2 != 1,2,2

是否有一些罐头功能可以满足我的要求？我假设这将在 Microsoft.VisualStudio.QualityTools.UnitTestFramework.Assert 或 LINQ 中。断言会更好，因为它可能会提供更多关于它们如何不同的信息。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-21T19:55:08.883

您可以使用[CollectionAssert.AreEquivalent](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.collectionassert.areequivalent%28v=vs.80%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:22:28.473

这是一种选择：

```
public static bool AreEqual<T>(this IEnumerable<T> first, IEnumerable<T> second)
{
    var dictionary = first.GroupBy(x => x)
        .ToDictionary(group => group.Key,
        group => group.Count());

    foreach (var item in second)
    {
        int count = dictionary[item];
        if (count <= 0)
            return false;
        else dictionary[item] = count - 1;
    }

    return dictionary.Values.All(count => count > 0);
} 
```

# clojure - 以 org-mode 编写文档：是否可以引用代码片段？

> ID：14446157
> 
> 赞同：4
> 
> 时间：2013-01-21T19:52:46.187
> 
> 标签：clojure, org-mode

我正在编写一个包含大量代码片段的 org-mode 文档，例如：

```
#+begin_src clojure
(+ 1 2 3)
#end_src 
```

是否可以引用这样的片段，所以我可以在文本中说：在此`[[frag1][fragment]]`计算 1、2 和 3 的总和？

顺便说一句，我将 org 文档导出为 latex/pdf 和 html。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:01:23.577

在片段顶部放置一条`#+name: this-is-my-name`线，您可以使用`[[this-is-my-name][fragment]]`.

`C-c C-o`链接上会跳转到片段，但我没有测试它是如何导出的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T13:33:45.667

也许它可以帮助你：

```
#+BEGIN_SRC emacs-lisp
;; (ref:some caption1) 
(save-excursion
   (goto-char (point-min))
#+END_SRC

     In block [[(some caption1)]] 

#+BEGIN_SRC emacs-lisp
;; (ref:some caption2)
(save-excursion
   (goto-char (point-min))
#+END_SRC

     In block [[(some caption2)]] 
```

# r - 使用 facet_wrap () 绘制多个条形图

> ID：14446160
> 
> 赞同：3
> 
> 时间：2013-01-21T19:52:55.207
> 
> 标签：r, ggplot2

数据链接： [https ://www.dropbox.com/s/rvwq3uw0p14g9c6/GTAP_Macro.csv](https://www.dropbox.com/s/rvwq3uw0p14g9c6/GTAP_Macro.csv)

代码：

```
 ccmacrosims <- read.csv(file = "F:/Purdue University/RA_Position/PhD_ResearchandDissert/PhD_Draft/GTAP-CGE/GTAP_NewAggDatabase/NewFiles/GTAP_Macro.csv", header=TRUE, sep=",", na.string="NA", dec=".", strip.white=TRUE)

     ccmacrorsts <- as.data.frame(ccmacrosims)
     ccmacrorsts[6:10] <- sapply(ccmacrorsts[6:10],as.numeric)
     ccmacrorsts <- droplevels(ccmacrorsts)
     ccmacrorsts <- transform(ccmacrorsts,region=factor(region,levels=unique(region)))

     library(ggplot2)
     #Data manipulations to select variables of interest within the dataframe
     GDPtradlib1 <- melt(ccmacrorsts[ccmacrorsts$region %in% c("EAsia","USA","OecdEU","XMidEast","FrmUSSR","EastEU","TUR","MAR"), ])
     GDPtradlib2 <- GDPtradlib1[GDPtradlib1$sres %in% c("AVERAGE"), ]
     GDPtradlib.f <- GDPtradlib2[GDPtradlib2$variable %in% c("GDP"), ] 
     GDPtradlib.f <- subset(GDPtradlib.f, tradlib != "BASEDATA")

     GDPtradlib.f[1:20,]

     #Plotting
     plot <- ggplot(data = GDPtradlib.f, aes(x=factor(tradlib), y=value) + 
     plot + geom_bar(stat="identity") + facet_wrap(~region, scales="free_y") 
```

问题：我正在尝试按场景（x_axis）为每个区域绘制变量`GDP`（y_axis）并用于生成多个条形图。`tradlib``facet_wrap()`

R 消息错误：

```
+ plot <- ggplot(data = GDPtradlib.f, aes(x=factor(tradlib), y=value) + 
Error: unexpected symbol in:
"plot + geom_bar(stat="identity") + facet_wrap(~region, scales="free_y")
plot"
> plot + geom_bar(stat="identity") + facet_wrap(~region, scales="free_y")
Error in plot + geom_bar(stat = "identity") : 
  non-numeric argument to binary operator 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T22:01:21.547

你缺少一个`)`after `y=value)`。

除了您的代码有效之外，它还生成了以下图像：![在此处输入图像描述](../Images/d73a587a2378f8e400bfb4384bae4cc3.png)

与您的代码和我运行的代码的唯一区别是，我使用`gdata`库来降低关卡。

# vb.net - 为什么 AutoResetEvent 会导致内存错误？

> ID：14446161
> 
> 赞同：1
> 
> 时间：2013-01-21T19:52:58.900
> 
> 标签：vb.net, multithreading, service, out-of-memory, autoresetevent

下面，您将找到我最新的编码心痛的来源。它是基类中的一个小方法，在辅助线程中运行派生类的方法。此代码在每 5 分钟启动一次的 Windows 服务中运行大约 5 次。

```
Private Sub performAction(ByVal startedAt As DateTime)
    Dim waiter As New System.Threading.AutoResetEvent(False)
    Try
        Dim statusTimeout As Short = DefaultTimeOutSeconds
        Dim action As Threading.Thread = New Threading.Thread(AddressOf ActionToPerform)
        Dim configHelper As New ApplicationHelper.SST_CONFIG()
        Short.TryParse(configHelper.GetConfig(String.Format("{0}.Timeout", ActorType), DefaultTimeOutSeconds), statusTimeout)
        action.SetApartmentState(System.Threading.ApartmentState.STA)
        action.Priority = Threading.ThreadPriority.Highest
        action.Start()
        While LastUpdated < startedAt AndAlso DateTime.Now <= startedAt.AddSeconds(statusTimeout)
            waiter.WaitOne(1000)
        End While
    Finally
        waiter.Close()
    End Try
End Sub 
```

它会运行一段时间。最终它会耗尽内存。从那时起，将引发内存错误，直到服务重新启动。实际抛出的错误的文本如下：

```
System.OutOfMemoryException: Exception of type 'System.OutOfMemoryException' was thrown.
at System.Threading.WaitHandle.WaitOneNative(SafeHandle waitableSafeHandle, UInt32 millisecondsTimeout, Boolean hasThreadAffinity, Boolean exitContext)
at System.Threading.WaitHandle.InternalWaitOne(SafeHandle waitableSafeHandle, Int64 millisecondsTimeout, Boolean hasThreadAffinity, Boolean exitContext)
at System.Threading.WaitHandle.WaitOne(Int32 millisecondsTimeout, Boolean exitContext)
at System.Threading.WaitHandle.WaitOne(Int32 millisecondsTimeout)
at DeviceManagement.AsynchronousDeviceAction.performAction(Thread& action, DateTime startedAt)
at DeviceManagement.AsynchronousDeviceAction.Perform()
at DeviceManagement.PAJournalPrinter.GetStatus(); 
```

直到我开始使用 AutoResetEvent 来控制我的 while 循环，这些错误才真正开始发生。我曾经使用 System.Threading.Thread.Sleep。但是，当我使用 sleep 方法时，我调用的 com 对象之一永远不会运行。更改为 AutoResetEvent 可以运行该代码，但是即使调用 com 对象的方法不是要运行的派生类之一，现在也会显示内存错误。

请帮忙。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T15:46:35.633

Going back to system.threading.thread.sleep solved my problem. Only the device that needs the AutoResetEvent to work is using AutoResetEvent . The memory erorrs have gone way.

# c# - 使用 DataReader 将许多行集中到列表中

> ID：14446170
> 
> 赞同：1
> 
> 时间：2013-01-21T19:53:52.660
> 
> 标签：c#, sql, linq, datareader

我有以下表格：

团队：

```
ID          Name
------      ---------
1           Giants
2           Yankees
3           Cool Guys 
```

球员：

```
ID          Name         Team      IQ        SomeOtherDetail
------      ---------    -------   ------    ----------------
1           Bob          1         100       Oklahoma
2           Joe          1         80        Who knows?
3           Sue          2         130       Who cares?
4           Fred         2         76        42
5           Ed           2         90        Yes, please.
6           Schultz      3         314       :-) 
```

我的代码包含流动类：

```
public class Team
{
    public int Id { get; set; }
    public string Name { get; set; }
    public List<Player> Players { get; set; }
} 
```

使用良好的旧字符串查询和 DataReader，我试图获取所有团队的列表，包括球员。

有没有办法用一个查询来做到这一点？

[这个问题](https://stackoverflow.com/questions/194852/concatenate-many-rows-into-a-single-text-string)的解决方案非常接近；
我正在考虑将玩家列表作为单个字符串，然后将它们拆分，但这并没有帮助，因为我需要所有玩家的详细信息（姓名、ID 等），此外，这感觉像是一个肮脏的把戏。

我考虑的另一件事是这样查询：

```
select *
from TEAMS join PLAYERS
on TEAMS.ID = PLAYERS.Team 
```

...（从而获得额外的行）然后使用 linq 集中结果，但我不确定这有多有效。

那么，有什么好主意吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T19:57:37.520

```
select t.ID as TeamID, t.Name as TeamName, p.ID as PlayerID, p.Name as PlayerName
     , p.Team as TeamName, p.IQ, p.SomeOtherDetail
from Team t
inner join Players p on t.ID = p.Team 
```

这将为您提供基本的 SQL。然后你只需要遍历结果，检查团队是否已经存在于你的列表中，如果不存在则添加它，然后将玩家添加到玩家列表中。

这是否回答你的问题？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T19:57:30.270

您的查询

```
SELECT *
FROM teams 
INNER JOIN players
    ON teams.ID = players.Team 
```

是你想要的。它不会给你额外的*行*，它给你更多的*列*。两个表中的列都在您的结果集中。尝试自己连接两个查询会更有效率。

您用于生成团队列表的伪代码可能是：

```
while dr.Read()
   if (Teams.Contains(dr["Team"])
       add team to Teams
   find Team by ID
   add Player to Team 
```

作为替代方案，您可以将整个结果集读入`DataTable`using 中[`DataTable.Load()`](http://msdn.microsoft.com/en-us/library/system.data.datatable.load.aspx)，然后使用带有`group by`子句的 Linq 查询一次性获取整个结果集。

# php - 数组内的foreach循环

> ID：14446174
> 
> 赞同：14
> 
> 时间：2013-01-21T19:54:07.220
> 
> 标签：php, arrays, foreach

我正在尝试使用 for 循环在数组内创建一个数组 - 这是我的代码：

```
 array(
    'label' => 'Assign to user',
    'desc' => 'Choose a user',
    'id' => $prefix.'client',
    'type' => 'radio'
    'options' => array( 
        foreach ($clients as $user) {
         $user->user_login => array (  
            'label' => $user->user_login,  
            'value' => $user->user_login,
            ), 
        }
        )
    ) 
```

不幸的是，这给了我一个

> “解析错误：语法错误，意外的 T_CONSTANT_ENCAPSED_STRING，期待 ')'”

对于线路：

```
'options' => array( 
```

对于出了什么问题，我有点不知所措-非常感谢任何帮助。$clients 在别处定义，所以这不是问题。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-21T19:58:14.710

那是无效的语法。您必须首先构建数组的“父”部分。然后使用 foreach 循环添加子数组内容：

```
$foo = array(
    'label' => 'Assign to user',
    'desc' => 'Choose a user',
    'id' => $prefix.'client',
    'type' => 'radio',
    'options' => array()
);

foreach ($clients as $user) {
    $foo['options'][] = array (  
        'label' => $user->user_login,  
        'value' => $user->user_login,
    );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T19:56:41.490

您使用 foreach 来访问数据，而不是定义它。

试试这个：

```
array(
    'label' => 'Assign to user',
    'desc' => 'Choose a user',
    'id' => $prefix.'client',
    'type' => 'radio'
    'options' => $clients
    ) 
```

如果您需要更改“选项”的数据结构，请在定义主数组之前执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T19:58:45.290

您不能在数组的定义中使用 foreach。但是，您可以将`$clients`变量放在数组本身中，也可以在数组外部使用 foreach 来构建要插入到`options`键处的数组

# entity-framework - EF Fluent 生成的实体和默认值 - 再次

> ID：14446175
> 
> 赞同：1
> 
> 时间：2013-01-21T19:54:08.063
> 
> 标签：entity-framework

我的问题是，我做错了什么还是实体框架中的这个问题

同时使用：EF DbContext Fluent Generator 和 Reverse Engineer Coder 首先不处理默认值。为什么没有配置默认值。有没有什么技巧让我错过了这项工作？

在我看来，如果我从现有数据库中流畅地生成代码，并且我有具有预设默认值的列，那么生成的代码应该处理设置这些默认值。我有一个很好的模型，我可以在设计器中查看所有表格和关系，但我所有默认值的列属性都是空白的。为什么我必须手动编写数千个默认值，是的，数千个。数百个故事乘以许多列。我们数据库中的每一列都定义了默认值。生成的代码应该做任何需要做的事情来为我设置这些默认值。这不是使用该工具的目的吗，减少工作量？

当我使用 NHibernate fluent 生成器时，它们会处理默认值。为什么两个框架在默认值方面存在差异？

是否有其他可用的工具可以破解这些以节省我数周的工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-05T18:38:33.537

简短的回答是：你不能。

稍长的答案：当前接受的解决方案是在构造函数中冗余地指定默认值。唯一的选择是将属性声明为数据库生成的，但是您无法更新它们，因此它实际上只对时间戳或 ID 生成有用。

您可以适当搜索其他类似问题并找到更多解释。

另请参阅[此 UserVoice 建议](https://data.uservoice.com/forums/72025-entity-framework-feature-suggestions/suggestions/2929682-support-database-default-values-in-code-first)。

# r - ggplot2 + 世界地图 = 旧数据？

> ID：14446176
> 
> 赞同：13
> 
> 时间：2013-01-21T19:54:18.060
> 
> 标签：r, ggplot2

我正在尝试使用 ggplot2 绘制世界地图。这是我到目前为止所拥有的：

```
library(ggplot2)
world <- map_data("world")
ggplot(aes(long, lat, group=group), data=world) + geom_polygon() 
```

这很好用并且很容易做到。不幸的是，世界地图数据似乎很旧。例如，新加坡和捷克共和国等国家不见了，取而代之的是苏联等地区。知道如何获得更多最新的世界地图数据吗？

```
排序（唯一（世界$区域））
  [1] 《阿富汗》《阿尔巴尼亚》《阿尔及利亚》                 
  [4] 《美属萨摩亚》《安达曼群岛》《安道尔》                 
  [7] 《安哥拉》《安圭拉》《南极洲》              
 [10] “安提瓜” “咸海” “阿根廷”               
 [13] “阿鲁巴” “澳大利亚” “奥地利”                 
 [16] “亚速尔群岛” “巴哈马” “巴林”                 
 [19] 《孟加拉国》《巴巴多斯》《巴布达》                 
 [22] 《比利时》《伯利兹》《贝宁》                   
 [25] 《不丹》《黑海》《玻利维亚》                 
 [28] “博内尔” “博茨瓦纳” “巴西”                  
 [31]“文莱”“保加利亚”“布基纳法索”            
 [34] “布隆迪” “加利福尼亚” “柬埔寨”                
 [37] 《喀麦隆》《加拿大》《加那利群岛》          
 [40] 《佛得角》《里海》《开曼群岛》          
 [43] 《中非共和国》《乍得》《查戈斯群岛》      
 [46] 《智利》《中国》《哥伦比亚》                
 [49] “科摩罗” “刚果” “库克群岛”            
 [52] “哥斯达黎加” “古巴” “库拉索”                 
 [55] “塞浦路斯” “捷克斯洛伐克” “丹麦”                 
 [58] 《吉布提》《多米尼克》《多米尼加共和国》      
 [61] “厄瓜多尔” “埃及” “萨尔瓦多”             
 [64] 《赤道几内亚》《埃塞俄比亚》《福克兰群岛》        
 [67] 《斐济》《芬兰》《法国》                  
 [70]“法属圭亚那”“法属波利尼西亚”“加蓬”                   
 [73] 《冈比亚》《加沙地带》《德国》                 
 [76] 《加纳》《大苦湖》《大湖》             
 [79] “希腊” “格陵兰” “格林纳达”                 
 [82] “瓜德罗普” “危地马拉” “几内亚”                  
 [85] "几内亚比绍" "圭亚那" "海地"                   
 [88] “夏威夷” “洪都拉斯” “匈牙利”                 
 [91] “冰岛” “印度” “印度尼西亚”               
 [94] “伊朗”“伊拉克”“爱尔兰”                 
 [97]“伊里安查亚”“马恩岛”“怀特岛”           
[100]“以色列”“意大利”“象牙海岸”             
[103]“牙买加”“日本”“约旦”                  
[106]“肯尼亚”“基里巴斯”“科威特”                  
[109] “Lacul Greaca” “艾伯特湖” “Fjerritslev 湖”        
[112]“卡里巴湖”“马拉维湖”“帕斯维克洛夫湖”          
[115] 《坦噶尼喀湖》《的的喀喀湖》《维多利亚湖》           
[118] 《老挝》《黎巴嫩》《莱索托》                 
[121] “利比里亚” “利比亚” “列支敦士登”           
[124]“卢森堡”“马达加斯加”“马德拉群岛”         
[127]“马拉维”“马来西亚”“马尔代夫”                
[130]“马里”“马耳他”“马绍尔群岛”        
[133]“马提尼克岛”“毛格岛”“毛里塔尼亚”              
[136]“毛里求斯”“墨西哥”“密克罗尼西亚”              
[139]“摩纳哥”“蒙古”“蒙特塞拉特”              
[142]“摩洛哥”“莫桑比克”“缅甸”                 
[145]“纳米比亚”“瑙鲁”“尼泊尔”                   
[148] “荷兰”“中立区”“尼维斯”                   
[151]“新喀里多尼亚”“新西兰”“尼加拉瓜”               
[154]“尼日尔”“尼日利亚”“朝鲜”             
[157]“北马里亚纳群岛”“挪威”“阿曼”                    
[160]“巴基斯坦”“巴拿马”“巴布亚新几内亚”        
[163]“西沙群岛”“巴拉圭”“秘鲁”                    
[166]“菲律宾”“皮特凯恩群岛”“波兰”                  
[169]“葡萄牙”“波多黎各”“卡塔尔”                   
[172]“罗马尼亚”“卢旺达”“圣尤斯特歇斯”         
[175] “圣基茨”“圣卢西亚”“圣文森特”           
[178] “圣巴泰勒米” “圣马丁” “萨摩亚”                   
[181]“圣马力诺”“圣多美和普林西比”“撒丁岛”                
[184]“沙特阿拉伯”“塞内加尔”“塞舌尔”              
[187] 《西西里岛》《塞拉利昂》《辛考岛》         
[190]“所罗门群岛”“索马里”“索索罗尔岛”         
[193] 《南非》《韩国》《南桑威奇群岛》  
[196] 《西班牙》《南沙群岛》《斯里兰卡》               
[199] 《苏丹》《苏里南》《斯威士兰》               
[202] 《瑞典》《瑞士》《叙利亚》                   
[205]“坦桑尼亚”“泰国”“多巴哥”                  
[208]“多哥”“托克劳”“汤加”                   
[211]“特立尼达”“突尼斯”“土耳其”                  
[214]“特克斯和凯科斯”“图瓦卢”“乌干达”                  
[217]“英国”“阿拉伯联合酋长国”“乌拉圭”                 
[220]“美国”“苏联”“瓦努阿图”                 
[223]“委内瑞拉”“越南”“维尔京群岛”          
[226]“维斯林斯基扎利夫”“威尔士”“西岸”               
[229]“西撒哈拉”“也门”“南斯拉夫”              
[232]“扎伊尔”“赞比亚”“津巴布韦”   

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T20:54:12.057

您是否将其与[mapdata](http://cran.r-project.org/web/packages/mapdata/)中的数据库进行了比较？

如果这还不够好，您可以使用[Global Administration Database](http://www.gadm.org/country)或 NOAA 的[GSHHG 数据库](http://www.ngdc.noaa.gov/mgg/shorelines/gshhs.html)。

如果您在处理 shapefile 时需要帮助，空间分析[（此处）](http://spatialanalysis.co.uk/2012/02/great-maps-ggplot2/)有一个使用 ggplot2 的绝妙示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-08T13:13:30.357

“地图”中的“世界”数据库最近（2015 年）使用自然地球的数据进行了更新。从[3.0 版](https://cran.r-project.org/web/packages/maps)开始，地图是最新的。

# ruby - Ruby中排序元素的原始索引

> ID：14446181
> 
> 赞同：8
> 
> 时间：2013-01-21T19:54:38.483
> 
> 标签：ruby, arrays, sorting, indexing

```
arr = [1,3,2,4]

arr.sort #=> [1,2,3,4] 
```

我想要一个数组`[0, 2, 1, 3]`（按顺序排列原始索引`arr.sort`）

Ruby 1.9.3 有没有简单的方法来做到这一点？

谢谢你

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-21T20:07:51.403

```
xs = [1, 3, 2, 4]
original_indexes = xs.map.with_index.sort.map(&:last)
#=> [0, 2, 1, 3] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:12:33.017

```
arr=[1,3,2,4]
p arr.map{|e| arr.sort.index(e)} 
```

为了避免每次排序，更好的是：

```
arr=[1,3,2,4]
arr_s = arr.sort
p arr.map{|e| arr_s.index(e)} 
```

* * *

更新

```
arr=[1,3,2,4]
start_time = Time.now
(1..100000).each do |i|
    arr.map{|e| arr.sort.index(e)}
end
elapsed = Time.now - start_time
p elapsed

xs = [1, 3, 2, 4]
start_time = Time.now
(1..100000).each do |i|
    xs.map.with_index.sort.map(&:last)
end
elapsed = Time.now - start_time
p elapsed 
```

并得到了结果：

```
0.281736
0.504314 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-04T04:44:21.190

我在 MRI Ruby 2.2.1p85（Mac 和 CentOS 上）上进行了测试，tokland 的解决方案返回了**错误**的结果：

```
xs = [8,3,2,7,5]
xs.map.with_index.sort.map(&:last)
#=> [2, 1, 4, 3, 0] # wrong 
```

Yevgeniy Anfilofyev 解决方案有效，但不**支持**非唯一数组：

```
arr = [8,3,2,7,5]
arr_s = arr.sort
arr.map{|e| arr_s.index(e)}
#=> [4, 1, 0, 3, 2] # correct

arr = [8,3,5,2,8,8,7,5]
arr_s = arr.sort
arr.map{|e| arr_s.index(e)}
#=> [5, 1, 2, 0, 5, 5, 4, 2] 
```

我想出这个：

```
arr = [8,3,5,2,8,8,7,5]
index_order = []
arr.uniq.sort.each do |a|
  index_order += arr.each_index.select{|i| arr[i] == a }
end
r = []
index_order.each_with_index do |a, i|
  r[a] = i
end
r
#=> [5, 1, 2, 0, 6, 7, 4, 3] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-12T11:10:31.900

```
array = [6, 20, 12, 2, 9, 22, 17]
sorted = array.sort
indices = []
array.each do |n|
  index = (0...sorted.length).bsearch { |x| n <=> sorted[x] }
  indices << index
end
indices 
```

此解决方案适用于 O(nlogn)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-08T14:28:51.613

`(0..arr.size - 1).sort_by { |i| arr[i] }`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-07T03:03:20.803

一种方法是创建一个与原始数组长度相同的临时数组，其中每个元素都是一对：原始数组的值及其索引。

例如，对于 [1, 3, 2, 4]，它将是 [[1, 0], [3, 1], [2, 2], [4, 3]]

然后按元素[0]对该数组进行排序，然后提取元素[1]作为结果。

像这样：

```
def sort_indices(x)
  t = []
  i = -1
  x.map { |e| t << [e, i += 1] }
  t.sort { |a, b| a[0] <=> b[0] }.map{ |a| a[1] }
end

arr = [ 1, 3, 2, 4]
sort_indices(arr)
=> [0, 2, 1, 3] 
```

通过将此作为方法添加到 Array 类，它可以直接在任何数组上调用：

```
class Array
  def sort_indices
    t = []
    i = -1
    self.map { |e| t << [e, i += 1] }
    t.sort { |a, b| a[0] <=> b[0] }.map{ |a| a[1] }
  end
end

p [40, 10, 50, 62, 27].sort_indices
=>
[1, 4, 0, 2, 3] 
```

# c++ - 在 C++ 中实现 Hashmap :: 用于模板化数据类型的散列函数

> ID：14446183
> 
> 赞同：5
> 
> 时间：2013-01-21T19:54:47.027
> 
> 标签：c++, templates, hash, hashmap, unordered-map

我最近一直在使用 STL 的 unordered_map，虽然它似乎工作得很好，但鉴于数据类型作为模板参数给出，我不太了解哈希函数是如何工作的。为了更彻底地理解这个数据结构，我在 C++ 中实现了我自己的小 Hashmap 类：

哈希图接口：

```
#ifndef _HASHMAP_H_
#define _HASHMAP_H_

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <iostream>
#include <vector.h>

//Beginning of Hashmap class definition

template <class Key, class Value>
class Hashmap{
private:

int mappedElementCount;

public:
explicit Hashmap();
virtual ~Hashmap();

virtual void test();

virtual int hash(Key*);

int* getSize();

void putKVPair(Key*,Value*);

void clearMap();

//When we use these methods, we'll want a linear vector of keys and values to 
    //iterate over, so vector is good here
std::vector<Key>* getKeys();
std::vector<Value>* getValues();

}; //end hashmap class definition
#endif /*_HASHMAP_H_*/ 
```

哈希图实现：

```
#include "Hashmap.h"

template<class Key,class Value> Hashmap<Key,Value>::Hashmap(){
mappedElementCount = 0;
}
template<class Key,class Value> Hashmap<Key,Value>::~Hashmap(){
printf("\nDestroying the base Hashmap object!\n");
}

template<class Key,class Value> void Hashmap<Key,Value>::test(){
printf("The size of our Key is %i and the size of our Value is
    %i\n",sizeof(Key),sizeof(Value));
}

template<class Key,class Value> int Hashmap<Key,Value>::hash(Key* k_ptr){

    unsigned int hashval;

    /* we start our hash out at 0 */
    hashval = 0;

        //TODO: How do we generate a hash signature when we don't know what data type 
        //we're going to be working with?

    return hashval % mappedElementCount;

}

template<class Key,class Value> std::vector<Key>* Hashmap<Key,Value>::getKeys(){
//TODO: prepare a vector initialized with all Key objects and return it here
return keys;    
}

template<class Key,class Value> std::vector<Value>* Hashmap<Key,Value>::getValues(){
//TODO: prepare a vector initialized with all Value objects and return it here
return values;  
}

template<class Key,class Value> int* Hashmap<Key,Value>::getSize(){
return &mappedElementCount;
}

template<class Key,class Value> void Hashmap<Key,Value>::putKVPair(Key* k, Value* v){
    //TODO: implement hashing of the key object k to determine
    //the address of the value object v

    //first step, generate a hash from our key
    int tempHash = hash(k);

       //TODO: store the Value at an address given by or influenced by tempHash

    //If all was successfully completed, increment the mapped records counter
    mappedElementCount++;
}

template<class Key,class Value> void Hashmap<Key,Value>::clearMap(){
//TODO: implement a cascading chain of deallocation of stored objects within the 
    //hashmap
//MAYBE-- only if we create new objects rather than just mapping reference 
    //associations,
//which is really the goal here...  In the latter case, just empty the Hashmap 
    //itself
} 
```

解决此问题的一种可能的 OOP 方法是使用 Hashmap 作为基类，并提供具有已知 Key 数据类型的派生类，例如以下 Stringmap：

字符串映射接口：

```
#ifndef _STRINGMAP_H_
#define _STRINGMAP_H_

#include "Hashmap.h"

template <class Value>
class Stringmap:public Hashmap<std::string,Value>{
private:

public:
//Con/de 'structors
explicit Stringmap();
~Stringmap();

//Here we know our Key will be of type std::string
//so we can generate our hash sig by char values
    //Override hash from the base class
int hash(std::string*);

//override test from base class
void test();

};
#endif /*_STRINGMAP_H_ def*/ 
```

字符串映射实现：

```
#include "Stringmap.h"

template<class Value> Stringmap<Value>::Stringmap():Hashmap<std::string,Value>(){

}
template<class Value> Stringmap<Value>::~Stringmap(){
printf("\nDestroying the derived stringmap object!\n");
}

template<class Value> void Stringmap<Value>::test(){
printf("The size of our Value is %i\n",sizeof values[0]);
}

template<class Value> int Stringmap<Value>::hash(std::string* str_ptr){

    unsigned int hashval;

    /* we start our hash out at 0 */
    hashval = 0;

    /* for each character, we multiply the old hash by 31 and add the current
     * character.  Remember that shifting a number left is equivalent to
     * multiplying it by 2 raised to the number of places shifted.  So we
     * are in effect multiplying hashval by 32 and then subtracting hashval.
     * Why do we do this?  Because shifting and subtraction are much more
     * efficient operations than multiplication.
     */
    for(int i=0;i<str_ptr->length();i++) {
        hashval = (*(str_ptr))[i] + ((hashval << 5) - hashval);
    }

    /* we then return the hash value mod the hashmap size so that it will
     * fit into the necessary range
     */
    return hashval % (*(Hashmap<std::string,Value>::getSize()));

} 
```

那么问题来了：当要散列的数据类型目前未知时，是否可以创建散列签名？如果是这样，怎么做？查看 std::hash 文档，似乎 C++ 标准只是为每个原始数据类型以及 T* （对于任何类型 T）定义了一个哈希函数......缺少的是如何为给定的实现这种哈希原始数据类型，更重要的是，它是如何为通用 T* 实现的。我想我可以只调用 hash(Key) 并希望最好，但很高兴了解幕后发生的事情。

谢谢，CCJ

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T19:58:19.893

`std::unorderd_map`接受 2 个显式模板参数（`Key`和`Value`），并且还有一堆隐藏的模板参数，其中 Hash 函数默认为`std::hash<Key>`.

此 STL 哈希函数`std::hash<Key>`接受 a`Key`并返回 a `std::size_t`。它已经专门用于所有整数类型和`std::string`. 从这个[参考网站](http://en.cppreference.com/w/cpp/utility/hash)

> 散列模板定义了一个实现散列函数的函数对象。此函数对象的实例定义了一个 operator()，它：
> 
> 1.  接受一个 Key 类型的参数。
> 2.  返回一个 size_t 类型的值，它表示参数的哈希值。
> 3.  调用时不抛出异常。
> 4.  对于两个相等的参数 k1 和 k2，std::hash()(k1) == std::hash()(k2)。
> 5.  对于不相等的两个不同参数k1和k2，std::hash()(k1) == std::hash()(k2)的概率应该很小，接近1.0/std::numeric_limits::max ()。
> 
> 哈希模板既是 CopyConstructible 又是 Destructible 的。无序关联容器 std::unordered_set、std::unordered_multiset、std::unordered_map、std::unordered_multimap 使用模板 std::hash 的特化作为默认散列函数。

参考以这句话结尾：

** **实际的散列函数是依赖于实现的，除了上面指定的那些之外，不需要满足任何其他质量标准。** **

因此，您可以查看系统的实现，但这并不能保证其他系统的实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T19:58:44.433

有一个`std::hash<T>`专门针对各种类型的模板，您可以专门针对自己的类型。

默认情况下，`std::unordered_map<T>`只需将散列委托给`std::hash<T>`（或者您可以指定不同的散列函数作为模板参数）。

因此`std::unordered_map`，根本不需要了解散列机制。

至于如何`std::hash`实现，没有具体说明。但是，我认为可以合理地假设任何体面的编译器都会提供高质量的实现。要记住的一个问题是，`std::hash<char*>`它不散列 C 字符串，它只散列指针的值（在那里:)）

# sql - Sql 表设计错误

> ID：14446184
> 
> 赞同：0
> 
> 时间：2013-01-21T19:54:49.917
> 
> 标签：sql

我正在尝试开始学习 Sql 并且在我的书头中 First c# 我正在制作第一个 sql server

但是当我尝试添加有关人类的信息时，它会这么说，请帮忙。

> 没有更新任何行。
> 
> 第 1 行中的数据未提交。错误来源：.Net SqlClient 数据提供程序。错误消息：无法将值 NULL 插入“ContactID”列，表“ContactDB.dbo.People”；列不允许空值。插入失败。该语句已终止
> 
> 更正错误并重试或按 ESC 取消更改。

*   在代码中它说 ContactID NO NULL 但仍然有错误..？=请帮助。

创建表 [dbo].[人物]

> 创建表 [dbo].[人物]
> 
> [ContactID] INT NOT NULL 主键，
> 
> [名称] NCHAR(100) NULL，

插入 [dbo].[People]（[ContactID]、[Name]、[Company]、[Telephone]、[Email]、[Client]、[LastCall]）值（NULL、NULL、NULL、NULL、NULL、空，空）

在sql中是这样的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:03:37.273

```
INSERT INTO People (ContactId,Name) VALUES(1,'John') 
```

将工作

```
INSERT INTO People (Name) VALUES('John') 
```

将不起作用，因为您需要在给定的表定义中提供 ContactId。

# linux - tun/tap 接口理解

> ID：14446189
> 
> 赞同：1
> 
> 时间：2013-01-21T19:55:16.667
> 
> 标签：linux, sockets, networking, linux-kernel, linux-device-driver

我目前正在探索不同的网络接口，并遇到了 tun/tap。我对创建套接字的一部分感到困惑。

我们可以在分配给 tun/tap 接口的 IP 地址上创建具有众所周知的端口的常规套接字吗？

是否可以为 tun 和 tap 接口创建套接字？

如果在这里问它太基本，我很抱歉。（我找不到足够的关于这个主题的在线文档。）

PS我认为因为它是一个网络接口，它应该是可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-26T06:37:52.283

为什么不？从套接字的角度来看，它与任何其他网络接口没有什么不同。

您只需要像对其他网络接口所做的那样发送数据包。您通过 tun/tap 接口发送的数据包将被进程（通常是管理程序或某些 VPN 守护程序）从 /dev/net/tun 设备自动读取。这些过程将进一步处理数据包，例如，将它们传递给您的客人。

因此，除非您正在编写虚拟机管理程序或某些 VPN 守护程序，否则您甚至不会注意到其中的区别......

# vb.net - linq 查询只读

> ID：14446191
> 
> 赞同：2
> 
> 时间：2013-01-21T19:55:20.153
> 
> 标签：vb.net, linq, readonly

我完全被这个问题难住了。我一直在寻找一段时间，但仍然没有解决问题的答案。

我运行了一个查询，尝试在其中设置值。`read only`问题是，如果我不指定，它们会作为变量出现`Select New With`。当我指定`Select New With`它不会更新数据库。下面列出了一些代码。

我的目标是让射手`DataGridView`更新数据库。我在 StackOverflow 上的另一个问题中被告知，`DataGridView`不会仅通过用户输入数据来更新数据库。所以我创建了一个更新按钮，它运行下面列出的代码。

代码：

查询 using`Select New With`允许我编辑变量但不会提交到数据库：

```
Dim query = From t In db.Trophies _
            Select New With {t.TrophyName, t.WinnerId, t.Name, t.Score, t.Printed} 
```

查询不会让我编辑变量。错误消息显示“属性 'TrophyName' 是 'ReadOnly'：

```
Dim query = From t In db.Trophies _
            Select t.TrophyName, t.WinnerId, t.Name, t.Score, t.Printed 
```

我要更新结果的代码：

```
Dim i as integer = 0
For Each result In query
    result.WinnerId = dgvTrophies.Rows(i).Cells(dgvTrophies.Columns("WinnerId").Index).Value
    result.Name = dgvTrophies.Rows(i).Cells(dgvTrophies.Columns("Name").Index).Value
    result.Score = dgvTrophies.Rows(i).Cells(dgvTrophies.Columns("Score").Index).Value
    db.SubmitChanges()
    i += 1
Next 
```

桌子：

```
PRIMARY KEY TrophyId int auto-increments
TrophyName varchar(50)
WinnerId char(7) Allow Nulls
Name varchar(20) Allow Nulls
Score int Allow Nulls
Printed bit 
```

任何建议或答案将不胜感激。

编辑：我试过设置`ObjectTrackingEnabled`，`True`但没有解决问题。

编辑：为了让它进行更“自动”的更新，在用户离开`edit mode`我`DataGridView`调用`db.SubmitChanges`更新数据库并且不再需要更新按钮之后。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:28:08.057

使用`Select new with { ...`创建一个匿名对象，并且对其的更改不会提交到数据库。您需要使用 linq 实体。例如：

```
Dim query = From t In db.Trophies _
            Select t 
```

或者干脆

```
Dim query = db.Trophies 
```

那可行。

# iphone - 检索 CFBundleVersion 时的奇怪行为

> ID：14446202
> 
> 赞同：3
> 
> 时间：2013-01-21T19:55:51.443
> 
> 标签：iphone, ios, xcode, build, build-automation

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:13:54.033

# mysql - 此产品数据库的最佳布局？

> ID：14446208
> 
> 赞同：0
> 
> 时间：2013-01-21T19:56:32.090
> 
> 标签：mysql, database, product

我正在为一个定价方案相当复杂的客户建立一个电子商务网站。我选择使用 foxycart，并让所有产品价格动态地从数据库中出来。这样做的原因是每个客户对单个产品的产品价格以及购买的数量都不同。我正在尝试构建最灵活的系统，但我不确定什么是最好的。

首先，我将有一个 customer_table：

```
id, name, city, state, country, zip, phone 
```

接下来是我试图决定如何构建事物的地方。目前有 18 种左右独特的产品，其中一些具有不同的尺寸/体积，并且每种产品、每种尺寸都有独特的价格折点。因此，一种产品的购买价格将低于 4，另一种价格低于 10，另一种价格低于 19，另一种价格高于 20，并且相同产品的价格不同但尺寸不同。这些价格折点也不是所有产品的标准。有些可能在 3、9、12 处有价格中断，而另一些可能有小于 5 和大于 5 的价格中断。可以想到的最好方法是构建一个包含 50 列的表，列出所有这些。没有数据重复，因为它会根据 cust_id 而改变，所以对我来说似乎是标准化的，但我想知道你们都怎么想。

```
id, cust_id, product1_lt4, product1_lt20, product1_gt20, product2_lt6, product2_lt12, product2_lt60, product2_gt60, etc... 
```

lt 和 gt 明显小于/大于。它变得如此巨大。

我试图用 Category_table、Sub Category_table、product_table、size_table 和 price 表尽可能地分解表，但我想不出任何输入数据的好方法，而无需加载空字段或 50 多个表.

让我知道这是否有意义。如果需要，我可以提供更多细节。我想我的主要问题是，选择选项 1 是不是一个坏主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:16:00.643

完整的数据库应该是：

产品信息

```
categories 
categories_description 
product_type_layout * 
product_types * 
product_types_to_category * 
products * 
products_attributes * 
products_attributes_download * 
products_description * 
products_discount_quantity * 
products_options * 
products_options_types 
products_options_values * 
products_options_values_to_products_options * 
products_to_categories * 
manufacturers 
manufacturers_info 
meta_tags_products_description 
meta_tags_categories_description 
reviews * 
reviews_description * 
```

销售/特价详情

```
featured 
salemaker_sales * 
specials * 
```

产品类型额外信息

```
media_clips 
media_manager 
media_to_products 
media_types 
music_genre 
product_music_extra * 
record_artists * 
record_artists_info * 
record_company * 
record_company_info * 
```

内容管理系统/内容管理

```
ezpages 
```

客户资料

```
address_book 
customers 
customers_info 
```

客户存储的购物车

```
customers_basket 
customers_basket_attributes 
```

客户互动

```
email_archive 
group_pricing 
products_notifications 
```

订单历史

```
files_uploaded 
orders * 
orders_products * 
orders_products_attributes * 
orders_products_download * 
orders_status_history 
orders_total * 
```

和

```
paypal * 
paypal_payment_status_history * 
paypal_session * 
```

贝宝™</p>

```
paypal * 
paypal_payment_status 
paypal_payment_status_history * 
paypal_session * 
paypal_testing * 
```

管理员审计跟踪

```
admin_activity_log 
authorizenet 
banners_history 
counter 
counter_history * 
coupon_email_track 
coupon_redeem_track 
email_archive 
```

优惠券和礼券配置/跟踪

```
coupon_email_track 
coupon_gv_customer 
coupon_gv_queue 
coupon_redeem_track 
coupon_restrict 
coupons 
coupons_description 
```

系统配置

```
admin 
address_format 
configuration * 
configuration_group 
layout_boxes 
template_select * 
currencies 
languages 
```

税/区配置

```
geo_zones 
tax_classes * 
tax_rates * 
zones_to_geo_zones * 
zones * 
countries 
```

其他

```
banners 
banners_history 
get_terms_to_filter 
newsletters 
project_version * 
project_version_history * 
query_builder * 
db_cache 
sessions * 
upgrade_exceptions * 
whos_online * 
```

更多请看[这里](http://www.zen-cart.com/wiki/index.php/Developers_-_Database_Schema)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:04:01.567

“我想我的主要问题是，选择选项 1 是不是一个坏主意？”

是的，这是个坏主意。您已将业务逻辑直接绑定到您的架构中，这意味着如果有人后来决定需要低于 6 件商品（例如）的价格中断，您必须手动修改您的架构和应用程序以支持它。

如果没有关于您的要求和数据结构的更多信息，很难为您建议架构，但作为一般准则，我建议在您的产品表和定价表之间使用多对多链接。这样的结构将允许您相对轻松地添加新的价格类别，并避免您的选项 1 实施的脆弱模式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:09:39.857

我可能会这样：

```
Customers
id,first_name,etc...

Categories
id,name,etc...

Sub_Categories
id,name

Category_Sub_Categories
category_id,sub_category_id

Product_Categories
product_id,category_id

Product_Sub_Categories
product_id,sub_category_id

Products
id,name

Customer_Product_Prices
customer_id,product_id,quantity,price 
```

然后您可以假设与产品相关的最低数量是少于任何数量，而最大数量价格是对于任何数量超过

我相信这将是构建具有您试图实现的复杂性的东西的最灵活和可扩展的方式

# awesomium - html 'select' 关键字在 Awesomium 中是否有效？

> ID：14446209
> 
> 赞同：1
> 
> 时间：2013-01-21T19:56:34.517
> 
> 标签：awesomium

我正在使用 Awesomium .NET Winforms Web 浏览器控件，但在使用“选择”关键字时遇到了一些问题。

下面是演示该行为的 html，但首先是几个快照。

加载页面后，此图片显示初始状态。

![页面打开时](../Images/27f81c6e67abd91244e0618dab5daae9.png)

单击箭头后，控件突出显示，但“下拉菜单”未“打开”。

当控件突出显示时，我可以使用向上和向下箭头来更改选择。

![用向下箭头更改](../Images/597edfcea7a08f8faeb3425802109453.png)

正在测试的页面要复杂得多，除了简单的选择功能外，其他所有功能都运行良好。我们有很多 JS 没有问题。

有什么我想念的吗？

这是上面显示的简单页面的 html：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<title>Select test</title>
</head>

<body>
    <p>
    <select id="test1">
        <option value="1">option1</option>
        <option value="2">option2</option>
        <option value="3">option3</option>
        <option value="4">option4</option>
    </select>
    </p>
</body>
</html> 
```

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T23:49:45.667

这是我的 1.7 版代码...感谢您的帮助...

```
 private ListBox lbSelect;
    private WebControl browser;

    private void CreateBrowser()
    {
        browser = new WebControl();
        this.Controls.Add(browser);
        browser.Dock = DockStyle.Fill;
        browser.ShowPopupMenu += new ShowPopupMenuEventHandler(browser_ShowPopupMenu);

        lbSelect = new ListBox();
        this.Controls.Add(lbSelect);
        lbSelect.BringToFront();
        lbSelect.Visible=false;
        lbSelect.MouseClick += new MouseEventHandler(lbSelect_MouseClick);
        lbSelect.LostFocus += new EventHandler(lbSelect_LostFocus);
    }

    private PopupMenuEventArgs _MenuArgs;
    void browser_ShowPopupMenu(object sender, PopupMenuEventArgs e)
    {
        lbSelect.Items.Clear();
        uint count = e.Info.Count;
        for (uint i = 0; i < count; i++)
            lbSelect.Items.Add(e.Info[i].Label);

        Rectangle lbb = new Rectangle
        {
            X = e.Info.Bounds.X,
            Y = e.Info.Bounds.Y + e.Info.Bounds.Height,
            Height = (count <= 10 ? (int)(e.Info.ItemHeight * count) : e.Info.ItemHeight * 10),
            Width = e.Info.Bounds.Width
        };

        lbSelect.Bounds = lbb;
        lbSelect.Visible = true;
        lbSelect.SelectedIndex = e.Info.SelectedItem;
        lbSelect.Focus();

        _MenuArgs = e;
    }

    void lbSelect_MouseClick(object sender, MouseEventArgs e)
    {
        _MenuArgs.Info.Select(lbSelect.SelectedIndex);
        lbSelect.Visible = false;
    }

    void lbSelect_LostFocus(object sender, EventArgs e)
    {
        lbSelect.Visible = false;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T18:37:33.063

这是一个已知的“功能”。弹出菜单留给开发人员实现。

[“Ken Walker”在这里](http://forums.awesomium.com/viewtopic.php?p=1024#p1024)很好地提供了执行此操作的代码

编辑：不幸的是，链接已被删除。这可能是因为新版本已经发布，现在支持这个 html 结构。我还没有时间玩 3/6/13 版本，所以我会在这里发布我的代码，直到我看到更新是否有效。

我使用名为 lbSelect 的设计器创建了一个 ListBox。我一直无法找到的一件事是如何调用 Awesomium_Windows_Forms_WebControl_ShowPopupMenu。我没有钩子，也没有在控件的属性中看到钩子，但是，它在设计器文件中并且已连接。

需要注意的一点是，您必须在菜单中选择一个项目 - 您不能选择箭头并让框消失。希望更新后的 Awesomium 可以正常工作，并且所有这些代码都会消失。

```
 private void lbSelect_MouseClick(object sender, MouseEventArgs e)
    {
        if (e.Button == System.Windows.Forms.MouseButtons.Left)
        {
            itemSelected = lbSelect.SelectedIndex;
        }
    }
    private void Awesomium_Windows_Forms_WebControl_ShowPopupMenu(object sender, PopupMenuEventArgs e)
    {
        int count;
        Rectangle lbb = new Rectangle();

        itemSelected = -1;
        lbSelect.Items.Clear();
        count = e.Info.Items.Count;
        lbb.X = e.Info.Bounds.X;
        lbb.Y = e.Info.Bounds.Y + e.Info.Bounds.Height;
        lbb.Height = e.Info.ItemHeight * count;
        lbb.Width = e.Info.Bounds.Width;

        lbSelect.Bounds = lbb;
        for (int i = 0; i < count; i++)
        {
            lbSelect.Items.Add(e.Info.Items[i].Label);
        }
        lbSelect.Visible = true;
        lbSelect.BringToFront();
        do
        {
            Application.DoEvents();
        } while (itemSelected == -1);
        e.Info.Select(itemSelected);
        lbSelect.Visible = false;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T21:50:02.140

`WebControl`在 1.7 版的最终版本中，预定义的下拉（弹出）菜单将可用于 WPF 和 WinForms 。

# c# - 设计一个窗口

> ID：14446215
> 
> 赞同：2
> 
> 时间：2013-01-21T19:56:57.980
> 
> 标签：c#, wpf, styles, windows-shell, skinning

有没有办法将样式应用于 WPF Windows？例如：更改最小化、最大化和 X 按钮？我知道图形是 Windows shell 的一部分，而不是 WPF，所以我不确定它是否可能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T09:27:59.417

```
<Window
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
x:Class="AccountOperator.CustomWindowStyle"
x:Name="Window"
Title="CustomWindowStyle"
Width="640" Height="480" WindowStyle="None" Margin="0" BorderThickness="2">

<Window.Resources>

    <Style x:Key="MaxButtonStyle" TargetType="{x:Type Button}">         
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border  BorderBrush="#535666" BorderThickness="2,5,2,2" Width="20" Height="15" Background="White"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="MinButtonStyle" TargetType="{x:Type Button}">

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Border  Width="20" Height="7"  BorderBrush="#535666" BorderThickness="2" Background="#FFFFFF" HorizontalAlignment="Left" />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="CloseButtonStyle" TargetType="{x:Type Button}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Grid>
                        <Border Width="18" Height="4" BorderThickness="2" BorderBrush="#535666" RenderTransformOrigin="0.5,0.5">
                            <Border.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform/>
                                    <SkewTransform/>
                                    <RotateTransform Angle="50"/>
                                    <TranslateTransform/>
                                </TransformGroup>
                            </Border.RenderTransform>
                        </Border>
                        <Border Width="18" Height="4" BorderThickness="2" BorderBrush="#535666" RenderTransformOrigin="0.5,0.5">
                            <Border.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform/>
                                    <SkewTransform/>
                                    <RotateTransform Angle="-50"/>
                                    <TranslateTransform/>
                                </TransformGroup>
                            </Border.RenderTransform>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</Window.Resources>

<Grid x:Name="LayoutRoot">
    <StackPanel  Orientation="Horizontal" VerticalAlignment="Top" HorizontalAlignment="Right">      
        <Button x:Name="BtnMax" Width="20" Height="15" Click="BtnMax_Click" Style="{DynamicResource MaxButtonStyle}" Margin="10"/>
        <Button x:Name="BtnClose" Height="18" Width="20" Margin="10"  Style="{DynamicResource CloseButtonStyle}" Click="BtnClose_Click"/>
        <Button x:Name="BtnMin" Width="20" Height="20" Style="{DynamicResource MinButtonStyle}" Click="BtnMin_Click" Margin="10"/>
    </StackPanel>
</Grid> 
```

```
public partial class CustomWindowStyle : Window
{
    public CustomWindowStyle()
    {
        this.InitializeComponent();
    }

    private void BtnMax_Click(object sender, System.Windows.RoutedEventArgs e)
    {
        this.WindowState = WindowState.Maximized;
    }

    private void BtnMin_Click(object sender, System.Windows.RoutedEventArgs e)
    {           
        this.WindowState = WindowState.Minimized; 
    }

    private void BtnClose_Click(object sender, System.Windows.RoutedEventArgs e)
    {
        this.Close();
    }       
} 
```

您只需复制并粘贴上面的代码即可得到您想要的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:14:55.267

您可以使用以下项目来完成您的任务：[wpfwindow.codeplex.com](http://wpfwindow.codeplex.com/)。

在此项目中是文件“ButtonIcons.xaml”，您可以更改这些按钮的属性。

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

  <!-- MINIMIZE -->
  <Border x:Key="WindowButtonMinimizeIcon" Width="12" Height="5" Margin="0,5,0,0" BorderBrush="#535666" BorderThickness="1" Background="#FFFFFF" />

  <!-- MINIMIZE (disabled) -->
  <Border x:Key="WindowButtonMinimizeIconDisabled" Width="12" Height="5" Margin="0,5,0,0" 
          BorderBrush="#9FA5B2" BorderThickness="1" Background="#FFFFFF" />

  <!-- RESTORE -->
  <Canvas x:Key="WindowButtonRestoreIcon">
    <Rectangle Stroke="#535666" Fill="White" Width="10" Height="10" Canvas.Top="1" Canvas.Left="7" />
    <Rectangle Stroke="#535666" Fill="White" Width="4" Height="4" Canvas.Top="4" Canvas.Left="10" />
    <Rectangle Stroke="#535666" Fill="White" Width="10" Height="10" Canvas.Top="3" Canvas.Left="5" />
    <Rectangle Stroke="#535666" Fill="White" Width="4" Height="4" Canvas.Top="6" Canvas.Left="8" />
  </Canvas>

  <!-- RESTORE (disabled) -->
  <Canvas x:Key="WindowButtonRestoreIconDisabled">
    <Rectangle Stroke="#9FA5B2" Fill="White" Width="10" Height="10" Canvas.Top="1" Canvas.Left="7" />
    <Rectangle Stroke="#9FA5B2" Fill="White" Width="4" Height="4" Canvas.Top="4" Canvas.Left="10" />
    <Rectangle Stroke="#9FA5B2" Fill="White" Width="10" Height="10" Canvas.Top="3" Canvas.Left="5" />
    <Rectangle Stroke="#9FA5B2" Fill="White" Width="4" Height="4" Canvas.Top="6" Canvas.Left="8" />
  </Canvas>

  <!-- MAXIMIZE -->
  <Border x:Key="WindowButtonMaximizeIcon" BorderBrush="#535666" BorderThickness="1" Width="12" Height="10">
    <Border BorderBrush="#FCFCFC" BorderThickness="2">
      <Border BorderBrush="#535666" BorderThickness="1" />
    </Border>
  </Border>

  <!-- MAXIMIZE (disabled) -->
  <Border x:Key="WindowButtonMaximizeIconDisabled" BorderBrush="#9FA5B2" BorderThickness="1" Width="12" Height="10">
    <Border BorderBrush="#FCFCFC" BorderThickness="2">
      <Border BorderBrush="#9FA5B2" BorderThickness="1" />
    </Border>
  </Border>

  <!-- CLOSE -->
  <Image Source="/CustomWindow;component/Images/buttonX.png" Width="13" Height="10" x:Key="WindowButtonCloseIcon" />

  <!-- Background colors for red button (e.g close button) -->
  <LinearGradientBrush x:Key="RedButtonBackground" StartPoint="0,0" EndPoint="0,1">
    <GradientStop Offset="0" Color="#F89C8C" />
    <GradientStop Offset="0.45" Color="#D47F75" />
    <GradientStop Offset="0.45" Color="#C04C3C" />
    <GradientStop Offset="1" Color="#C98172" />
  </LinearGradientBrush>

  <LinearGradientBrush x:Key="RedButtonMouseOverBackground" StartPoint="0,0" EndPoint="0,1">
    <GradientStop Offset="0" Color="#F89C8C" />
    <GradientStop Offset="0.45" Color="#E36A53" />
    <GradientStop Offset="0.45" Color="#C72B0E" />
    <GradientStop Offset="0.75" Color="#D44310" />
    <GradientStop Offset="1" Color="#F5E478" />
  </LinearGradientBrush>

</ResourceDictionary> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:27:52.870

您将不得不开始修改 xaml。您可能想从更改背景等内容开始。

这并不像我想象的那么简单。最初，我认为您只需将所需的按钮更改为您创建的按钮。这里有点复杂。例如，使按钮看起来不同并不像更改按钮背景那么简单。

您需要制作特定的控件模板，或将资源应用于项目、图像，并通过 XAML 分别制作`style`或`template`更改图像的设置。

我这样做的一种方法是添加图像，并根据图像制作自定义控件。不需要按钮或其他控件。`onclick`然后我为和 鼠标悬停（等等）创建了事件，所以我有效地制作了一个看起来像按钮的小图像，就像一个按钮。

要看的东西：

`Window.Style` `Window.Resources` `Templates`

老实说，找到这些答案的最简单方法是询问 Google。您可以询问任何内容，但请确保将**WPF**添加到其末尾。这样，您只能找到 WPF 特定编码的答案，很多人的操作方式不同，但您会发现大量出色的 xaml 示例等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T20:10:17.467

是的，您可以根据需要设置窗口样式。
不幸的是，如果您想设计标题栏、系统按钮、窗口的透明度或形状，通常是全有或全无的问题。

首先，设置`Window.WindowStyle = WindowStyle.None`
然后你可以创建新的 wpf 样式`ContolTemplate`。
您可能需要编写一些代码来处理窗口拖动、标题栏双击、调整大小等。

# c# - DataTable 中的 FileInfo 不起作用

> ID：14446226
> 
> 赞同：1
> 
> 时间：2013-01-21T19:57:29.603
> 
> 标签：c#, .net, datatable

我有两个`comboBoxes`。首先我选择品牌，第二个我选择型号。我还想`picture`根据模型选择显示。`FileInfo`在我添加该列之前，一切似乎都有效。现在代码不起作用（我什至无法选择品牌和型号 - `comboboxes are empty`）。怎么了：

```
 dtCategories = new DataTable();
        dtCategories.Columns.Add("CategoryID", typeof(int));
        dtCategories.Columns.Add("CategoryName", typeof(string));

        dtCategories.Rows.Add(0, "--Select--");
        dtCategories.Rows.Add(1, "Audi");
        dtCategories.Rows.Add(2, "BMW");
        dtCategories.Rows.Add(3, "Mercedes");

        dtItems = new DataTable();
        dtItems.Columns.Add("ItemID", typeof(int));
        dtItems.Columns.Add("ItemName", typeof(string));
        dtItems.Columns.Add("CategoryID", typeof(int));
        dtItems.Columns.Add("Obrazek", typeof(FileInfo));

        dtItems.Rows.Add(2, "A1", 1, "a1.jpeg");
        dtItems.Rows.Add(3, "A3", 1, "a3.jpeg");
        dtItems.Rows.Add(4, "A4", 1, "a5.jpeg");
        dtItems.Rows.Add(5, "Seria 1", 2, "bmw1.jpeg");
        dtItems.Rows.Add(6, "Seria 2", 2, "bmw3.jpeg");
        dtItems.Rows.Add(7, "Seria 3", 2, "bmw5.jpeg");
        dtItems.Rows.Add(8, "C Klasa", 3, "C Klasa.jpeg");
        dtItems.Rows.Add(9, "E Klasa", 3, "E Klasa.jpeg");
        dtItems.Rows.Add(10, "S Klasa", 3, "S Klasa.jpeg");

        cbCategory.DisplayMember = "CategoryName";
        cbCategory.ValueMember = "CategoryID";
        cbCategory.DataSource = dtCategories; 
```

和 ：

```
 private void cbCategory_SelectedIndexChanged(object sender, EventArgs e)
        {
        int categoryId = Convert.ToInt32(cbCategory.SelectedValue);
        if (categoryId > 0)
        {
            DataTable dtTemp = dtItems.Select(string.Format("CategoryID = {0}",  categoryId)).CopyToDataTable();

            DataRow drTemp = dtTemp.NewRow();
            drTemp["ItemID"] = 0;
            drTemp["ItemName"] = "--Select--";
            drTemp["CategoryID"] = 0;

            dtTemp.Rows.InsertAt(drTemp, 0);

            cbItems.DisplayMember = "ItemName";
            cbItems.ValueMember = "ItemID";
            cbItems.DataSource = dtTemp;
            pictureBox1.Image = Image.FromFile(dtTemp.Columns[3].ToString());

        }
        else if (cbItems.DataSource != null)
        {
            cbItems.SelectedIndex = 0;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:18:32.943

`FileInfo`不是 a 的列的有效数据类型`DataTable`。有关详细信息，请参阅[DataColumn.DataType 属性](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.datatype.aspx)。

您是否收到某种例外情况？

可能是您的图像路径不正确。你可以试试这段代码，它可能更容易调试：

```
var imagePath = dtTemp.Columns[3].ToString();
if (File.Exists(imagePath))
{
    var image = Image.FromFile(imagePath);
    pictureBox1.Image = image;
}
else
{
    throw new FileNotFoundException(); 
    // of course something more subtle is advisable
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T05:24:26.187

问题不在于第 4 列的数据类型是`FileInfo`. 它是您在添加行时没有提供一个，而是`string`第 4 列的类型。做

```
dtItems.Rows.Add(2, "A1", 1, new FileInfo("a1.jpeg"));
dtItems.Rows.Add(3, "A3", 1, new FileInfo("a3.jpeg"));
//etc.. 
```

也就是说，FileInfo 通常不是 DataTable 的合适类型。对于您的自定义表，它可能有效，但从 db 直接加载到该数据表时将不兼容。但是你的数据表很好`DataSource`。

```
cbItems.DataSource = dtItems; //fine in your case. 
```

# c# - 无法正确识别不同命名空间中的部分类

> ID：14446233
> 
> 赞同：8
> 
> 时间：2013-01-21T19:58:13.220
> 
> 标签：c#, asp.net, .net, c#-4.0, partial-classes

我有一个分为两个命名空间的部分类。问题是，如果我在其中一个部分上实现了接口，则在对应的部分类上无法识别它。例如，我希望以下内容返回 true 以被识别为`ILastModified`（C# fiddle at [http://ideone.com/heLDn0](http://ideone.com/heLDn0)）：

```
using System;
using MyNamespace.One;

public class Test
{
    public static void Main()
    {
        var item = new Product();
        Console.WriteLine(item is ILastModified); //RETURNS FALSE??!
    }
}

interface ILastModified
{
    DateTime LastModified { get; set; }
}

namespace MyNamespace.One
{
    public partial class Product
    {
        public int ID { get; set; }
    }
}

namespace MyNamespace.Two
{
    public partial class Product : ILastModified
    {
        public DateTime LastModified { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-21T19:59:10.123

您不能在两个不同的命名空间中拥有分部类。编译器将它们视为两个不同的类。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-21T20:00:53.120

> 我有一个分为两个名称空间的部分。

你不能。通过在不同的命名空间中，它们是不同的类。

考虑这就是命名空间存在的原因——因此您可以为不同的类使用相同的类*名*。

来自 C# 语言规范 (C# 4.0)，§10.2，部分类型：

> 部分类型声明的每个部分都必须包含一个部分修饰符。它必须与其他部分具有相同的名称**并在相同的命名空间**或类型声明中声明。

（强调我的）

因此，根据定义，您所做的不是部分类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T20:04:03.127

请参阅[部分类定义](http://msdn.microsoft.com/en-us/library/wa80x488%28VS.80%29.aspx)

> 使用 partial 关键字表示可以在命名空间内定义类、结构或接口的其他**部分**。

这是因为部分类型必须在同一个命名空间中，因为每个类都有一个包含命名空间的完全量化的名称。一个典型的例子是使用 Windows 窗体应用程序，设计器和 UI 代码使用部分类分开。在我看来，它还可以防止糟糕的设计！

您可以使用简单的反射代码（主要是为了好玩）亲自看到这一点。

```
var namespaces = Assembly.GetExecutingAssembly().GetTypes()
                         .Select(t => t.Namespace)
                         .Distinct();

//Returns:
//  WindowsFormsApplication2
//  WindowsFormsApplication2.Properties 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T20:06:49.517

命名空间提供类型的逻辑分离。 `MyNamespace.One.Product`并且`MyNamespace.Two.Product`是两种不同的类型（如果不是这种情况，那么首先拥有命名空间就没有意义了！）

因为`using MyNamespace.One;`，

在`Main()`：

`var item = new Product();`

相当于：

`var item = new MyNamespace.One.Product()`

将第二种`Product`类型的命名空间更改为`MyNamespace.One`

# php - php脚本未按预期导入新记录

> ID：14446236
> 
> 赞同：0
> 
> 时间：2013-01-21T19:58:17.177
> 
> 标签：php, mysql, while-loop, defaultifempty

我制作了以下脚本来检查文章是否存在于另一个表中，如果存在则应该回显该文章存在，如果不存在则将文章 ID 和文章名称添加到另一个表中。我遇到的问题是，如果我清除 Workshoptabs 表并运行更新脚本，它会创建所有文章 ID/名称，但是如果我将新文章添加到 dbel6_content 表然后再次运行更新脚本，它不会添加车间标签的新文章。此外，如果我从 Workshoptabs 中删除一条记录并运行脚本，它不会重新添加它，但如果我清除整个表，它会重新导入所有内容。

```
$resultB = mysql_query("SELECT * FROM dbel6_content WHERE catid='12'") or die(mysql_error());  
while($rowB = mysql_fetch_array( $resultB )) {
  $articleid = $rowB['id'];
  $articlename = $rowB['title'];

  $resultA = mysql_query("SELECT * FROM workshoptabs WHERE articleid='$articleid'") or die(mysql_error());  
  while($rowA = mysql_fetch_array( $resultA )) {
    $articleexists = $rowA['articleid'];
    echo $articleexists.' Exists';
  }

  if (empty($articleexists)){
    mysql_query("INSERT INTO workshoptabs (articleid, articlename) VALUES ('$articleid', '$articlename')") or die(mysql_error()); 
    echo 'Added Articles : '.$articleid.'-';    
  }
} 
```

如果我运行脚本，我得到： 16 Exists17 Exists20 Exists24 Exists25 Exists26 Exists27 Exists34 Exists

如果我擦拭workshoptabs表并重新导入我得到的所有内容：添加的文章：16-添加的文章：17-添加的文章：18-添加的文章：19-添加的文章：20-添加的文章：21-添加的文章：22-添加的文章： 23-添加文章：24-添加文章：25-添加文章：26-添加文章：27-添加文章：34-

但是，例如，如果我现在删除第 21 条并再次运行脚本，它不会添加它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:10:41.430

我建议使用查询的行数来确定是否存在记录：

```
<?php

  $resultB = mysql_query("SELECT * FROM dbel6_content WHERE catid='12'") or die(mysql_error());

  while($rowB = mysql_fetch_array( $resultB )) {

    $articleid = $rowB['id'];
    $articlename = $rowB['title'];

    $resultA = mysql_query("SELECT * FROM workshoptabs WHERE articleid='$articleid'") or die(mysql_error());

    if (mysql_num_rows($resultA)>0) {
      // exists
      echo $articleid.' Exists';
    } else {
      // doesnt exist
      mysql_query("INSERT INTO workshoptabs (articleid, articlename) VALUES ('$articleid', '$articlename')") or die(mysql_error()); 
      echo 'Added Articles : '.$articleid.'-';  
    }

  }

?> 
```

如 Joseph 所述，考虑研究 PDO 或 MySQLi。

# macos - 编辑“主机”文件无效

> ID：14446244
> 
> 赞同：2
> 
> 时间：2013-01-21T19:58:47.727
> 
> 标签：macos, unix

我最近一直在尝试编辑我的主机文件以重定向 URL，从而在我的计算机上有效地阻止它们。我有多年的编程经验，以及终端/纳米的经验，但我不太明白为什么它不会重定向。

我已经像这样附加了我的主机文件（/etc/hosts 和 /private/etc/hosts）

```
127.0.0.1       google.com 
```

我已经像这样刷新了dns缓存

```
sudo dscacheutil -flushcache 
```

但是，即使重新启动后它也不会重定向。关于可能是什么问题的任何想法？

编辑：

因此，当我 ping “google.com”（它尝试 ping 127.0.0.1）时，重定向有效。但是，它不会在我的网络浏览器中重定向。我想这可以缩小问题的范围。

编辑2：

所以现在我已经确定重定向可以在任何其他网络浏览器中工作，但不能在 safari 中工作。有任何想法吗？我即将清除 Safari 中的浏览数据，看看是否有帮助。

**解决方案如下**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T00:29:53.770

我找到了解决问题的方法。确实，您可以像平常一样编辑主机文件并按照说明刷新缓存。但是，在完成这些操作后，请务必从浏览器中清除所有私人数据。某些浏览器会保留您访问的热门网站的内部缓存。由于我经常访问 google.com，Safari 已经缓存了主页，而不是进行新的 DNS 查找。希望这对大家有帮助

# iphone - "isKindOfClass" 在 Cocos2d 中总是测试 True

> ID：14446246
> 
> 赞同：0
> 
> 时间：2013-01-21T19:58:54.197
> 
> 标签：iphone, ios, macos, cocos2d-iphone

我已经在我的 Cocos2d 应用程序中为 CCSprite 实现了我自己的自定义子类，但是当迭代我的孩子时，我的 isKindOfClass 为我的 CCLabelTTf 返回 true，这不是我的 GameCharacter 的子类。

```
 CCArray *listOfGameObjects = [self children];
      for (id tempObj in listOfGameObjects) {
        if ([tempObj isKindOfClass:[GameCharacter class]]) {
          GameCharacter *gameChar = (GameCharacter*)tempObj;
          [gameChar updateStateWithDeltaTime:delta andListOfGameObjects:listOfGameObjects];
        }  
      } 
```

# android - 在多选模式下启用/禁用列表视图中的项目选择

> ID：14446249
> 
> 赞同：6
> 
> 时间：2013-01-21T19:59:08.600
> 
> 标签：android, android-listview, android-contextmenu

我在多选模式下为上下文菜单注册了一个列表视图：

```
private void initListViewForContextMenu(){
    log.d("FilesFragment", "initListViewForContextMenu()");
    ListView listView = getListView();
    listView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE_MODAL);
    listView.setMultiChoiceModeListener(new MultiChoiceModeListener() { ... 
```

**问题是并非我的视图中的所有项目都应该是可选择的，只有那些显示特殊图标的项目应该可供选择。**我不知道如何实现这一点，我定义了一个`OnItemLongClickListener`：

```
getListView().setOnItemLongClickListener(new OnItemLongClickListener() {
    @Override
    public boolean onItemLongClick(AdapterView<?> adapter, View view, int position, long id) {
        Log.d("FilesFragment", "OnItemLongClickListener.onItemLongClick at pos " + position);
        PfmDocument doc = (PfmDocument)adapter.getItemAtPosition(position);
        if (doc.isOnBasket()){
            Log.d("FilesFragment", "OnItemLongClickListener.onItemLongClick detected in basket");
            ListView lv = (ListView) adapter;
            lv.setItemChecked(position, false);
        }
        return false;
        }
    }); 
```

但是这个监听器永远不会被调用。

我也尝试`OnLongClickListener`在适配器中设置行视图，但是即使上下文菜单关闭（不在选择模式下），执行此正常单击也会禁用。

```
if (doc.isOnBasket()){
    rowView.setOnLongClickListener(new OnLongClickListener() {
    @Override
    public boolean onLongClick(View v) {
        return false; // do nothing, already in basket
    }
}); 
```

// }

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-06-18T11:59:10.373

如果您深入研究 android 源代码（AbsListview），您会看到将choiceMode 设置为`MULTIPLE_MODAL`将接管长按。这就是为什么你的听众永远不会被调用的原因。

`isEnabled(position)`您可以通过在适配器中返回 true/false 来决定视图是否可点击。

下面的代码只解决了在actionmode期间，已经添加到购物篮中的项目不可点击的部分。

但是如果它不是有效的项目，取消选中被长按的项目应该是相当容易的。

希望这有帮助！

在您的 MultiChoiceModeListener 中：

```
@Override
public boolean onCreateActionMode(ActionMode mode, Menu menu)
{
    this.adapter.setActionMode(true);
    return true;
}

@Override
public void onDestroyActionMode(ActionMode mode)
{
    this.adapter.setActionMode(false);
} 
```

然后在您的自定义适配器中：

```
public abstract class AbstractCollectionAdapter extends AbstractCursorAdapter
{
    private boolean isActionMode;

    public AbstractCollectionAdapter(Context context)
    {
        super(context);

        this.isActionMode = false;
    }

    @Override
    public boolean isEnabled(int position)
    {
        if (this.isActionMode)
        {
            final Object item = this.getItem(position);
            if (!item.isInBasket())
            {
                //only enable items that are not inside the basket
                return true;
            }
            //all other items are disabled during actionmode
            return false;
        }
        //no actionmode = everything enabled
        return true;
    }

    public void setActionMode(boolean isActionMode)
    {
        this.isActionMode = isActionMode;
    }
} 
```

# plugins - 如何在我的插件中创建模板文件？

> ID：14446251
> 
> 赞同：2
> 
> 时间：2013-01-21T19:59:20.170
> 
> 标签：plugins, wordpress

我已经为 wordpress 插件目录中的自定义页面创建了一个模板文件，但我找不到正确的路径。这段代码不起作用：

```
update_post_meta( $pas_tasks_page_id, '_wp_page_template', dirname( __FILE__ ) . '/task-list-template.php' ); 
```

仅当我将模板文件手动放入 wordpress 主题并将代码更改为：

```
update_post_meta( $pas_tasks_page_id, '_wp_page_template', '/task-list-template.php' ); 
```

但作为插件开发人员，我想在我的插件目录中创建新模板，而不是手动。我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T16:16:01.567

我最近使用“template_include”过滤器做了类似的事情。我是这样做的：

```
function include_template_files() {
    $plugindir = dirname( __FILE__ );

    if (is_post_type_archive( 'post-type-name' )) {
        $templatefilename = 'archive-post_type_name.php';
        $template = $plugindir . '/theme_files/' . $templatefilename;
        return $template;
    }

    if ('post-type-name' == get_post_type() ){
        $templatefilename = 'single-post-type-name.php';
        $template = $plugindir . '/theme_files/' . $templatefilename;
        return $template;
    }
}
add_filter( 'template_include', 'include_template_files' ); 
```

我只是使用 wordpress 条件来检查正在请求什么模板，然后在我的插件目录中创建了一个“theme_files”文件夹，并将适当命名的 wordpress 模板文件放在那里。这是为自定义帖子类型创建单个存档模板。

# ruby-on-rails - 导轨幽灵迁移

> ID：14446252
> 
> 赞同：0
> 
> 时间：2013-01-21T19:59:20.293
> 
> 标签：ruby-on-rails, devise, rails-migrations

我不断在我的 Rails 应用程序中获取具有相同名称但不同时间戳的重复设计迁移文件。我认为创建迁移的唯一方法是手动进行。如果是这样，为什么要创建这些迁移？

简单地删除这些文件之一是否安全？

# java - 清除 JTextArea 不起作用

> ID：14446257
> 
> 赞同：1
> 
> 时间：2013-01-21T19:59:46.567
> 
> 标签：java, swing, jlist, jtextarea

我正在尝试清除上面写有内容的文本区域。我一直在尝试使用 repaint() 方法，因为我认为这种方法会重置文本区域，但它一直没有工作。

我正在使用文本区域和列表。单击列表中的成员时，该成员将显示在文本区域中。因此，当它们被“取消选择”时，我需要以前编写的成员从文本区域中消失。

这是 valueChanged 的​​代码，这就是事情发生的地方：

```
public void valueChanged(ListSelectionEvent e)
{
        Object source = e.getSource();
        int[] indices = songList.getSelectedIndices();
        DecimalFormat df = new DecimalFormat("#0.00");

        Song[] selection = new Song[indices.length];
        for(int i = 0; i < indices.length; i++)
        {
            selection[i] = songCollection[indices[i]];
        }
        if(e.getValueIsAdjusting() == false)
        {
            for(int i = 0; i < selection.length; i++)
            {
                textArea.repaint(); //Shouldn't this work?
                textArea.append(selection[i].getTitle() + " " + selection[i].getArtist() + "    " + df.format(selection[i].getPrice()) + "\n" );

            }

        }               

} 
```

PS，我对 Stack Overflow 还很陌生，所以如果我做错了什么，请随时告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T20:08:05.233

据[`JTextComponent#setText`](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/JTextComponent.html#setText%28java.lang.String%29)，

> 将 this 的文本设置为`TextComponent`指定的文本。如果文本为`null`或为空，则具有简单删除旧文本的效果。插入文本后，生成的插入符号位置由插入符号类的实现确定。

因此，要从`JTextArea`组件中清除文本，请执行`setText(null)`或`setText("")`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:13:32.200

如上所述。

setText(" ") 也适用于文本字段。

# joomla - 视频播放器对齐

> ID：14446258
> 
> 赞同：0
> 
> 时间：2013-01-21T19:59:57.490
> 
> 标签：joomla, media-player, mediaelement.js

我正在使用媒体播放器`mediaelements.js`，`Joomla(yootheme)`想知道如何将*居中对齐*，`player`现在它是*左对齐*的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T16:41:33.453

如果您知道播放器的宽度，则可以使用 CSS，如下所示：

```
#player{
    width:400px; /*example*/
    margin:0 auto; /*center align*/
} 
```

# android - 如何在 Android 中实现 RESTFUL 服务？

> ID：14446260
> 
> 赞同：1
> 
> 时间：2013-01-21T20:00:18.160
> 
> 标签：android, database, rest

我想问你一个关于 REST Web 服务和 Android 的问题。我想制作一个与远程数据库通信并在列表视图中显示值的应用程序。现在，目前的问题是如何与远程数据库进行通信：我已经阅读了 REST 服务，并且我知道如果您想以安全的方式与数据库通信，它们是必要的，但我不知道如何真正做到。我对这个应用程序的想法是：我连接到放置在远程服务器中的 .php 页面（使用免费域），并在那里创建对数据库的查询，所以：

安卓应用程序 -----> PHP 文件 ----> 远程数据库

问题是：

*   我在哪里实施 REST 服务？
*   我的想法对吗？或者我应该改变什么？
*   有人有关于这个问题或一般关于 REST 服务的片段或教程吗？我在网上搜索过，但没有找到任何东西。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:05:50.533

谷歌的第一个结果：

[http://www.techrepublic.com/blog/app-builder/calling-restful-services-from-your-android-app/1076](http://www.techrepublic.com/blog/app-builder/calling-restful-services-from-your-android-app/1076)

它有一个通过公开的 Web 资源从 Android 获取数据的代码示例。

还有其他关于此的 SO Q，例如：[如何从 Android 调用 RESTful Web 服务？](https://stackoverflow.com/questions/6047194/how-to-call-restful-web-service-from-android)

你真的搜索得那么辛苦吗？；）

既然你写了一个Android问题，我假设你知道PHP部分，否则它不应该超过谷歌搜索！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:33:30.747

对于 php 部分，您应该能够通过谷歌搜索找到基本的演练。例如：[http](http://www.9lessons.info/2012/05/create-restful-services-api-in-php.html) ://www.9lessons.info/2012/05/create-restful-services-api-in-php.html 。

# php - 为 bash 处理发出 2 个 ajax 请求

> ID：14446263
> 
> 赞同：0
> 
> 时间：2013-01-21T20:00:27.130
> 
> 标签：php, ajax, bash, jquery

我正在发出一个 ajax 请求，它正在进行 bash 处理。我的页面中的另一个操作使用了 ajax 请求，但这个操作正在等待我的第一个请求结束以提出我的要求。您是否知道不等待第一个 ajax 请求的结束？

谢谢你的帮助 ：）

```
 $.ajax({
            type: 'POST',
            url: 'make-traitement.html',
            data: { fichier:  fileol, id: idcr }
            }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:06:41.767

jQuery`$.ajax`有一个可选参数：`async`

> 如果您需要同步请求，请将此选项设置为 false。跨域请求和 dataType: "jsonp" 请求不支持同步操作。请注意，同步请求可能会暂时锁定浏览器，从而在请求处于活动状态时禁用任何操作。

* * *

您使用异步 AJAX 调用的最终代码将是：

```
$.ajax({
    type: 'POST',
    async: false,
    url: 'make-traitement.html',
    data: { fichier:  fileol, id: idcr }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:24:01.840

此行为是由于会话。当第一个会话尚未关闭时，Php 无法启动第二个会话（具有相同的会话名称）。据我所知，没有办法避免这种锁定。

尝试尽快使用以下函数释放会话文件，以允许执行第二个请求。

```
session_write_close(); 
```

# c# - 何时保存设置？

> ID：14446266
> 
> 赞同：1
> 
> 时间：2013-01-21T20:00:36.317
> 
> 标签：c#, java, serialization

不是真正的问题，而是相关的：我的应用程序将其设置序列化为主要表单关闭事件中的隔离存储。除了一些边缘情况（比如 1% 的关机导致空的、损坏的文件），它工作得很好。这是预期的吗？

现在真正的问题是：在 C# 或 Java 桌面应用程序中处理序列化时的一般模式是什么？我应该等待应用程序退出吗？使用计时器并以一定的时间间隔保存做序列化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:02:24.347

我建议保存设置，因为它们更改为最强大的解决方案，并且可能在退出时保存。除非您处于设置快速变化的疯狂情况（但这似乎不太可能）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:05:05.387

除非您的音量很大，否则您应该在设置更改时保存。

这里最重要的问题是文件损坏。您应该保存到一个临时文件，当序列化完成后，您应该以快速的原子操作交换文件。如果出现任何问题，您可以阅读该文件的旧副本。

# c++ - std::endl 的值是否取决于操作系统？

> ID：14446267
> 
> 赞同：3
> 
> 时间：2013-01-21T20:00:39.383
> 
> 标签：c++, std

> **可能重复：**
> [std::endl 在每个平台上究竟代表什么？](https://stackoverflow.com/questions/1911018/what-does-stdendl-represent-exactly-on-each-platform)

我试图弄清楚 std::endl 是否返回`\r\n`,`\n`或`\r`取决于平台，或者它是否一直坚持下去。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-21T20:02:36.163

`std::endl`只是 . 的“简写” `'\n' << std::flush`。它不依赖于平台。

但是，如果流以文本模式打开，则`'\n'`其本身在每个平台上的处理方式不同，并且会被替换为`'\r\n'`, `'\n'`, or `'\r'`（或类似的东西）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:09:02.713

'\n' 输出一个换行符（在适当的平台特定表示中，因此它在 Windows 上生成一个“\r\n”）。std::endl 做同样的事情并刷新它。

使用 '\n' 代替 std::endl; 尝试输出换行符时，但`std::endl`在尝试刷新时使用。不必要的刷新会降低应用程序的性能，因为我们都知道文件 i/o 是除用户 i/o 之外最慢的操作之一。

# macos - 在 MacOSX (10.8) 上的 R (v2.15) 中使用不受支持的包 (covRobust)

> ID：14446276
> 
> 赞同：0
> 
> 时间：2013-01-21T20:00:54.047
> 
> 标签：macos, r

这是我第一次发帖，但绝对不是我第一次在这个板上！

我正在尝试使用其他人编写的 R 脚本，因为我还不是很精通编程，而且它的脚本很长。它调用似乎不再受 R 支持并且在 CRAN 存储库中不可用的包“covRobust”。我可以在[http://cran.open-source-solution.org/src/contrib/Archive/covRobust/](http://cran.open-source-solution.org/src/contrib/Archive/covRobust/)下载包。虽然我相信我在本地库中正确安装了包，但当我在 R 终端中键入 library(covRobust) 时出现此错误：

错误：包 'covRobust' 是在 R 2.10.0 之前构建的：请重新安装它。

我尝试使用旧版本的 R，但它们似乎与 MacOSX 10.8 不兼容。

我是 R 新手，并尝试寻找一个做同样事情的包（最近邻方差估计），但在那里也没有成功。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:12:13.767

当我以源格式下载该包并使用“本地源包”中的 GUI 包安装程序进行安装时，我没有收到任何错误。它似乎甚至不需要 XCode 工具进行编译。它似乎也可以正常加载。我正在使用 R64.app，所以我认为这不是 32 位与 64 位的问题。将 R 2.15.2 与 OSX 10.6.8 一起使用。

# neural-network - 神经网络的多输出数据集

> ID：14446284
> 
> 赞同：2
> 
> 时间：2013-01-21T20:01:32.410
> 
> 标签：neural-network, artificial-intelligence, classification, prediction

我用 C++ 开发了一个人工神经网络来完成一项任务，我想知道是否有人知道我可以用来测试我的网络的多个输出数据集？我试图证明我所做的修改会使网络在广泛的数据集上表现得更好。

我尝试了几个站点，但没有一个站点说明输出的数量，导致我假设它们都有一个输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T00:47:56.343

[UCI](http://archive.ics.uci.edu/ml/datasets.html)机器学习存储库目前维护 235 个数据集，作为机器学习社区的服务。

其中很大一部分包含多种类型的标签，例如，

*   [使用智能手机数据集的人类活动识别](http://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones)：包含 6 个输出标签：

> ```
> WALKING, WALKING_UPSTAIRS, WALKING_DOWNSTAIRS, SITTING, STANDING, LAYING 
> ```

*   [汽车评估数据集](http://archive.ics.uci.edu/ml/datasets/Car+Evaluation)：类值包括

> ```
> unacc, acc, good, vgood 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:19:43.737

MNIST 是一个标准的 10 类数据集，包含 20x20 像素的手写数字 (0 - 9) 图像。[您可以在http://yann.lecun.com/exdb/mnist/](http://yann.lecun.com/exdb/mnist/)找到数据集（以及来自各种分类器的性能结果，包括神经网络）

# ios - 应用标识符与“精简版”和“专业版”版本

> ID：14446285
> 
> 赞同：1
> 
> 时间：2013-01-21T20:01:46.720
> 
> 标签：ios, xcode, cocoa-touch, app-store, provisioning-profile

我们在 AppStore 上的免费 iPhone 应用程序已经有一个月左右的时间了，我们现在正在更新它。在我们的更新中，我们添加了很多对新内容的支持，例如 iPad 支持，这是一个非常重要的更新。在我们现有的应用程序中，到处都有很多广告，我们现在想将这个新版本作为“专业”版本与另一个更新旧版本的版本一起上传，让用户在旧的免费“广告”之间进行选择- 填充的应用程序，以及新的 0.99 美元的“无广告”和升级应用程序。我们仍在使用相同的 Xcode 项目，我们想知道是否需要更改任何应用程序标识符或配置文件或通知键或类似的东西？我们的推送服务将用于两个应用程序，所以如果我们不需要添加额外的 .pem 等，我们不想......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:22:01.390

要拥有不同的应用程序（“精简版”和“专业版”在 AppStore 上意义不大），您需要不同的标识符和不同的配置文件。更简单的方法是在 XCode 中创建一个新目标，克隆现有目标，然后对其进行修改。我没有与推送部分相关的直接经验，但我想不同的配置以不同的 .pem 结尾。您可以考虑使用 inApp 购买只拥有一个应用程序，并让用户从应用程序本身购买无横幅升级......

# mysql - 如何使用 MYSQL 从一行中分离数据并计算每个数据

> ID：14446290
> 
> 赞同：0
> 
> 时间：2013-01-21T20:02:20.447
> 
> 标签：mysql, sql

任何人都可以在这里用一种语法来帮助我，将数据连续拆分并查看拆分的数据是否再次出现，应该获得拆分信息的计数。

如果您看到下面的输入表。C1 有一个数据，如 ABC、ACD、BCE 等。我想将其拆分并计算每个特定数据的计数以及总计数。

MYSQL 中的帮助表示赞赏

我在 SQL 服务器中尝试过的查询：作为 MYSQL 的新成员，我能够获取整个数据，但我无法拆分。例如，我知道`select C1 from inputtable`。但我无法理解拆分指定列中某行的数据。

图解说明：

```
Input Table:

C1        
----------
ABC 
ACD
BCE
NULL
A

Output Table:

Column1            Count            TotalCount
------------------------------------------------------
A                  3                  4
B                  2                  4
C                  3                  4
D                  1                  4
E                  1                  4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:46:05.060

如果您正在使用固定集 ABCDEFGHIJ，那么这样的事情可能是可行的：

```
SELECT a.l         AS `Column1`
     , SUM(1)      AS `Count`
     , c.cnt       AS `TotalCount`
  FROM (
         SELECT CONVERT('A' USING latin1) AS l UNION ALL SELECT 'B'  
          UNION ALL SELECT 'C' UNION ALL SELECT 'D'
          UNION ALL SELECT 'E' UNION ALL SELECT 'F'
          UNION ALL SELECT 'G' UNION ALL SELECT 'H'
          UNION ALL SELECT 'I' UNION ALL SELECT 'J'
       ) a
  JOIN input_table t
    ON INSTR(t.c1,a.l)
 CROSS
  JOIN (SELECT COUNT(1) AS cnt FROM input_table) c
 GROUP BY a.l
 ORDER BY a.l 
```

注意：仅当客户端字符集与列 c1 字符集不匹配时才需要 CONVERT ......它的存在是为了避免 Error 1267 Illegal mix of collat​​ions。

如果您想省略计数为 0 的行（就像所选答案一样），那么您可以添加一个

```
HAVING SUM(1) > 1 
```

谓词。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:29:49.290

将数据拆分为任意数量的列将需要存储过程或类似的丑陋。拆分为十列是可能的，但是将这些列变成行以便您可以聚合它们将再次需要丑陋的代码。所有这些都表明您的架构可能违反了[第一种范式](http://en.wikipedia.org/wiki/First_normal_form)：您将多个值存储在单个表“单元格”中。您可以修改架构，还是必须使用该架构？

如果您必须使用那个，这里有一些丑陋的代码可以帮助您入门。[正如在 SQLFiddle 上测试的那样](http://sqlfiddle.com/#!2/d6146/1)，它会在您的示例输入上生成请求的输出。

```
SELECT q1.chr, COUNT(*), q2.cnt
FROM ( SELECT SUBSTR(C1, 1, 1) AS chr FROM tab
       UNION ALL
       SELECT SUBSTR(C1, 2, 1) AS chr FROM tab
       UNION ALL
       SELECT SUBSTR(C1, 3, 1) AS chr FROM tab
     ) AS q1,
     ( SELECT COUNT(C1) AS cnt FROM tab ) AS q2
WHERE q1.chr != ''
GROUP BY q1.chr 
```

请注意，我绝对不建议您这样写。改为使用适当的数据库模式，您不必重复固定次数的行。并且还考虑使用单独的查询来获取总数，因为对结果的每一行重复该查询似乎毫无意义。

# android - 如何禁用/阻止 USB

> ID：14446300
> 
> 赞同：0
> 
> 时间：2013-01-21T20:02:54.410
> 
> 标签：android

Programmaticslly 我想禁用 USB 数据读取。没有意义或目的。我只是想了解是否可能。为了澄清，我怎样才能禁用USB连接？（有点拔掉插头）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-25T05:17:28.680

Use this command in android terminal emulator. Root priveleges required:

```
echo 0 > /sys/devices/virtual/android_usb/android0/enable 
```

or...

```
su -c 'echo 0 > /sys/devices/virtual/android_usb/android0/enable' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:36:31.160

根据下面接受的答案，目前不可能。

[如何在 android 应用程序中以编程方式启用和禁用 USB](https://stackoverflow.com/a/10140671/867591)

# mysql - 查找过去有相关记录的记录

> ID：14446303
> 
> 赞同：3
> 
> 时间：2013-01-21T20:03:17.213
> 
> 标签：mysql, sql

基本上，我正在尝试的结果是：“获取过去一定时间内有 0个*不成功记录的**成功记录数”。*“成功”和“不成功”只是指列的值。

 *虽然它有点复杂，但这里是我正在处理的表的描述：

```
`log`
  id                int PRIMARY KEY AUTO_INCREMENT
  fingerprint_id    int (foreign key)
  status            boolean
  date              timestamp 
```

我们拥有的小系统的工作流程是，当用户刷他们的指纹时，会在此表中添加一条记录，并`status`根据它是否匹配来设置记录（同样，还有更多内容，我只是想简化一下）。我们`fingerprint_id`基于用户执行此操作得到 ，因此这是将记录与人员相关联的标识符。

目前，我们要求他们最多尝试 3 次。因此，他们可以在 3 之 1、3 之 2、3 之 3 或根本不匹配。这意味着他们的“组”中可以有 1、2 或 3 条记录。虽然这不是真的，但我们可以假设用户将继续尝试，直到匹配或达到 3 次失败尝试（我们发现有时人们可能会在失败一两次后不再继续）。

以下是一些数据的示例：

```
id  fp_id status   date
----------------------------------------
20    2     0      '2013-01-21 12:30:01'
21    2     0      '2013-01-21 12:30:05'
22    2     0      '2013-01-21 12:30:10'
23    9     1      '2013-01-21 12:31:30'
24    1     0      '2013-01-21 12:35:00'
25    1     1      '2013-01-21 12:35:05' 
```

数据中，用户 ( `fingerprint_id`) 2 尝试了 3 次，从未匹配。用户 9 第一次尝试匹配。用户 1 尝试一次失败，然后再次尝试并匹配。

重点是找出35秒前有多少成功（`status`=1）的日志记录有0个不成功（ =0）的记录。`status`当然，“连接”它们的唯一方法是通过`fingerprint_id`.

同样，我们假设了很多事情，但这很好。

这是我的尝试：

```
SELECT  COUNT(*)
FROM    log AS log_main
WHERE   log_main.status=1 AND
        (SELECT COUNT(*)
         FROM   log AS log_inner
         WHERE  log_inner.fingerprint_id=log_main.fingerprint_id AND
                log_inner.status=0 AND
                log_inner.date<log_main.date AND log_inner.date>=(log_main.date - INTERVAL 35 SECOND))=0 
```

^ 我希望这个选择所有成功的记录，这些记录在 35 秒前（对于该用户）内发生的不成功记录计数为 0。但我不知道，因为查询需要 600 多秒。我刚刚发现了如何延长 MySQL Workbench 的最大超时时间，但无论哪种方式，都需要很长时间。该表总共有大约 120,000 条记录，所以我不确定这是否足以使这个查询变得如此缓慢。

无论如何，这是另一个尝试：

```
SELECT  COUNT(*)
FROM    (SELECT log.fingerprint_id, log.date
         FROM log
         WHERE log.status=1) successful,
        (SELECT log.fingerprint_id, log.date
         FROM log
         WHERE log.status=0) unsuccessful
WHERE   successful.fingerprint_id=unsuccessful.fingerprint_id AND
        unsuccessful.date<successful.date AND unsuccessful.date>=(successful.date - INTERVAL 35 SECOND) 
```

^ 我觉得这个更接近，但当然，没有关于过去匹配多少条记录的“计数”的比较。这就是我对如何解决感到困惑的部分。我有一种感觉，它与使用`GROUP BY`或代替使用有关`IN`，但我所做的似乎不起作用（从某种意义上说，它超过了 600 秒或类似的时间）。这是我尝试过的一个例子`GROUP BY`

```
SELECT  successful.id, COUNT(*) cnt
FROM    (SELECT log.fingerprint_id, log.date, log.id
         FROM log
         WHERE log.status=1) successful,
        (SELECT log.fingerprint_id, log.date, log.id
         FROM log
         WHERE log.status=0) unsuccessful
WHERE   successful.fingerprint_id=unsuccessful.fingerprint_id AND
        unsuccessful.date<successful.date AND unsuccessful.date>=(successful.date - INTERVAL 35 SECOND)
GROUP BY successful.id 
```

^ 但结果仅包含计数不为 0 的行。我猜这是因为该`WHERE`条款。但我只需要 0 计数。

我尝试了很多组合，我认为我的大脑只是油炸了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:13:22.877

尝试使用 `NOT EXISTS`而不是`COUNT = 0`. 这应该表现得更好。

```
SELECT  COUNT(*)
FROM    log AS log_main
WHERE   log_main.status=1 
AND     NOT EXISTS
        (   SELECT 1
            FROM   log AS log_inner
            WHERE   log_inner.fingerprint_id=log_main.fingerprint_id
            AND     log_inner.status = 0
            AND     log_inner.date < log_main.date 
            AND     log_inner.date >= (log_main.date - INTERVAL 35 SECOND)
        ); 
```

您还应该确保该表已正确编入索引。

**编辑**

我相信`LEFT JOIN/IS NULL`在 MySQL 中 using 比 using 更有效`NOT EXISTS`，所以这会比上面的表现更好（尽管可能并不显着）：

```
SELECT  COUNT(*)
FROM    log AS log_main
        LEFT JOIN log AS log_inner
            ON log_inner.fingerprint_id=log_main.fingerprint_id
            AND log_inner.status = 0
            AND log_inner.date < log_main.date 
            AND log_inner.date >= (log_main.date - INTERVAL 35 SECOND)
WHERE   log_main.status = 1 
AND     Log_inner.fingerprint_id IS NULL; 
```

**编辑 2**

要获得 1 或 2 次尝试的记录等，我仍然会使用 JOIN，但就像这样：

```
SELECT  COUNT(*)
FROM    (   SELECT  log_Main.id
            FROM    log AS log_main
                    INNER JOIN log AS log_inner
                        ON log_inner.fingerprint_id=log_main.fingerprint_id
                        AND log_inner.status = 0
                        AND log_inner.date < log_main.date 
                        AND log_inner.date >= (log_main.date - INTERVAL 35 SECOND)
            WHERE   log_main.status = 1 
            AND     Log_inner.fingerprint_id IS NULL
            GROUP BY log_Main.id
            HAVING COUNT(log_Inner.id) = 1
        ) d 
```*

# android - Android 偏好主题

> ID：14446310
> 
> 赞同：1
> 
> 时间：2013-01-21T20:03:43.973
> 
> 标签：android, preferenceactivity

有谁知道我如何设置边距以使 PreferencesActivity 居中显示？

[这](http://i.imgur.com/G4DvqDx.png)是我得到的结果。

我想要实现的[理想主题。](http://i.imgur.com/PytIoXY.png)

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:00:57.430

问题是，您不能为`Activity`. Activity 总是覆盖整个屏幕。你应该改为做一个/几个：

1.  坚持这种`Activity`方法并且：
    1.  通过并设置它`ListView`的使用。您可以通过为.`PreferenceActivity.getListView()``LayoutParams``ListView.setLayoutParams()``LayoutParams``ListView`
    2.  设置`ListView`上面使用的背景`View.setBackgroundDrawable()`。
    3.  设置`PreferenceActivity`类似上面的背景。
2.  例如切换到一个`Dialog`。

FireFox 使用第二种方法。它为整个*设置*对话框使用`PreferenceScreen`,`PreferenceGroup`和`*Preference`（例如）类。确实使用 a作为首选项容器。`CheckBoxPreference`*`PreferenceScreen``Dialog`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T18:31:46.970

我通过使用 PreferenceActivity 让它工作。

```
 public class SettingsActivity extends PreferenceActivity {
      protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.preferences);
      }
    } 
```

[![图像](../Images/a826df2ab7bd3c25db1fbc27ea973491.png)](https://i.stack.imgur.com/QXW1d.png)*

# python - 使curses程序输出在程序退出后保留在终端回滚历史中

> ID：14446311
> 
> 赞同：9
> 
> 时间：2013-01-21T20:03:51.353
> 
> 标签：python, ncurses, curses

我对curses很陌生，所以我在python中尝试了一些不同的东西。

我已经初始化了窗口并为窗口对象设置了滚动条。我可以添加字符串，并且滚动工作使 addstr() 在窗口末尾没有任何错误。

我想要的是在程序完成后能够在我的终端程序（在本例中为 tmux 或 KDE Konsole）的程序输出中回滚。

在我的代码中，如果我跳过 endwin() 调用，我至少可以看到输出，但是终端需要*重置*调用才能恢复运行。

此外，即使在程序运行时，curses 窗口向下滚动后，我也无法在 Konsole 中向后滚动以查看初始输出。

```
#!/usr/bin/env python2
import curses
import time
win = curses.initscr()
win.scrollok(True)
(h,w)=win.getmaxyx()
h = h + 10
while h > 0:
    win.addstr("[h=%d] This is a sample string.  After 1 second, it will be lost\n" % h)
    h = h - 1
    win.refresh()
    time.sleep(0.05)
time.sleep(1.0)
curses.endwin() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-08-18T03:30:15.707

对于这个任务，我建议你使用一个垫子（[http://docs.python.org/2/library/curses.html#curses.newpad](http://docs.python.org/2/library/curses.html#curses.newpad)）：

> pad 就像一个窗口，只是它不受屏幕大小的限制，也不一定与屏幕的特定部分相关联。[...] 一次只有窗口的一部分会出现在屏幕上。[...]

为了在您使用完curses后将pad的内容留在控制台上，我会从pad读回内容，结束curses并将内容写入标准输出。

以下代码实现了您所描述的。

```
#!/usr/bin/env python2

import curses
import time

# Create curses screen
scr = curses.initscr()
scr.keypad(True)
scr.refresh()
curses.noecho()

# Get screen width/height
height,width = scr.getmaxyx()

# Create a curses pad (pad size is height + 10)
mypad_height = height + 10
mypad = curses.newpad(mypad_height, width);
mypad.scrollok(True)
mypad_pos = 0
mypad_refresh = lambda: mypad.refresh(mypad_pos, 0, 0, 0, height-1, width)
mypad_refresh()

# Fill the window with text (note that 5 lines are lost forever)
for i in range(0, height + 15):
    mypad.addstr("{0} This is a sample string...\n".format(i))
    if i > height: mypad_pos = min(i - height, mypad_height - height)
    mypad_refresh()
    time.sleep(0.05)

# Wait for user to scroll or quit
running = True
while running:
    ch = scr.getch()
    if ch == curses.KEY_DOWN and mypad_pos < mypad_height - height:
        mypad_pos += 1
        mypad_refresh()
    elif ch == curses.KEY_UP and mypad_pos > 0:
        mypad_pos -= 1
        mypad_refresh()
    elif ch < 256 and chr(ch) == 'q':
        running = False

# Store the current contents of pad
mypad_contents = []
for i in range(0, mypad_height):
    mypad_contents.append(mypad.instr(i, 0))

# End curses
curses.endwin()

# Write the old contents of pad to console
print '\n'.join(mypad_contents) 
```

# html - 透明图像 - 背景颜色

> ID：14446312
> 
> 赞同：39
> 
> 时间：2013-01-21T20:03:58.530
> 
> 标签：html, css

我想知道是否可以为透明图像设置背景颜色？（只有图像会有背景色）

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-01-21T20:05:09.413

如果我理解正确，你可以这样做：

```
<img src="image.png" style="background-color:red;" /> 
```

事实上，您甚至可以将一个整体`background-image`应用于图像，从而产生两个“层”，而无需浏览器中的多背景支持；）

# compass-sass - 如果所有元素都跨越一列，需要欧米茄吗？

> ID：14446318
> 
> 赞同：0
> 
> 时间：2013-01-21T20:04:18.200
> 
> 标签：compass-sass, sass, susy-compass

如果所有元素恰好跨越一列，[Susy可以](http://susy.oddbird.net) *自动*（不指定`omega`）填充多列布局吗？

我*想要*什么：

```
+---------+---------+
| I       | want    |
+---------+---------+
| two     | columns |
+---------+---------+ 
```

我*得到*什么（下面的代码）：

```
+---------+
| I       |
+---------+
| want    |
+---------+
| two     |
+---------+
| columns |
+---------+ 
```

HTML：

```
<div id="container">
  <div>I</div>
  <div>want</div>
  <div>two</div>
  <div>columns!</div>
</div> 
```

SCSS：

```
@import 'susy';

$total-columns: 2;
$column-width: 200px;
$gutter-width: 5px;
$grid-padding: 10px;

#container {
    @include container;
    @include susy-grid-background;

    &>div {
        @include span-columns(1);
        height: 50px;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T03:02:17.483

不，您需要指定 omega，否则 Susy 将不得不假设太多关于您的标记和期望结果的事情。我们不惜一切代价试图避免这种情况。解决这个问题的最好方法是使用`nth-omega()`mixin：

```
div {
  @include span-columns(1);
  @include nth-omega(even);
} 
```

它是选择器的简单扩展`:nth-child()`，采用相同的关键字、数字或算法。

# python - 尝试在 win7 上使用 GIT-BASH 安装 django 和 python

> ID：14446320
> 
> 赞同：0
> 
> 时间：2013-01-21T20:04:29.360
> 
> 标签：python, django

我正在尝试第一次安装 django 并尝试通过[http://net.tutsplus.com/tutorials/python-tutorials/python-from-scratch-creating-a-dynamic-website/](http://net.tutsplus.com/tutorials/python-tutorials/python-from-scratch-creating-a-dynamic-website/)工作。

我已经下载了 Django-1.4.3。这是我的 Git-Bash 目录

```
$ ls
Django-1.4.3     ReleaseNotes.rtf  doc           git-cheetah  libexec
Git Bash.vbs     bin               etc           git-cmd.bat  share
README.portable  cmd               git-bash.bat  lib          ssl 
```

根据教程我必须执行：

```
cd Django-1.4.3
python setup.py install 
```

当我做后者时，我得到：

```
$ python setup.py install
sh.exe": python: command not found 
```

我需要把python放在哪里才能让它执行这个命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:18:16.220

Assuming that Python is already installed, this error message means that Git-Bash doesn't know where your python.exe is.

To run the python command from the Git-Bash like you proposed, you have to append the path of python.exe in the `PATH` environment variable of Windows.

Other way to run python on Windows is using the normal command prompt (instead of Git-Bash) using the full path. For example, if the installation directory of python is `C:\Python27`:

```
cd Django-1.4.3
C:\Python27\python.exe setup.py install 
```

# c# - 助手未正确渲染

> ID：14446322
> 
> 赞同：0
> 
> 时间：2013-01-21T20:04:37.217
> 
> 标签：c#, asp.net-mvc-4, razor-2

我目前正在将我的 aspx mvc 视图迁移到 razor 引擎，但是当涉及到我的助手时，我遇到了一些麻烦。

我不确定为什么，但是当我尝试在其 html 扩展表单中使用帮助程序时，我的帮助程序被呈现为文本而不是标记，我得到的是文本而不是 html。

扩展的代码是：

```
 public static string LinkButton(this HtmlHelper helper, string id, string value, string target, object htmlAttributes)
    {
        var linkButton = new TagBuilder("div");
        var attributes = new RouteValueDictionary(htmlAttributes);

        linkButton.MergeAttribute("id", id);

        //-- apply the button class to the div and any other classes to the button
        linkButton.MergeAttribute("class", attributes.ContainsKey("class") ? string.Format("linkbutton {0}", attributes["class"]) : "linkbutton");

        var content = new TagBuilder("a");
        content.MergeAttribute("href", target);
        content.InnerHtml = value;

        linkButton.InnerHtml = content.ToString();
        return linkButton.ToString();
    } 
```

这是一个非常简单的扩展，它的用法如下：

```
[ul]
    @foreach（ViewBag.Modules 中的 UpModule 模块）
    {
        [li]@Html.LinkBut​​ton(module.Name, module.Value, module.Target, new {@class = "landingButton"});[/li]
    }
[/ul]
```

除了明显错误的 html 标签之外，我搞砸了什么？

**编辑** 我应该注意到存在不正确的标记，因为我无法在我的问题中显示正确的标记，并且我完全知道它不会起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:36:43.753

通过 razor 语法在模板中返回的字符串`@`默认为 HTML 编码，以便不直接输出 HTML 标记。

```
var s = "<p>text</p>";
....
@s 
```

将输出类似于

```
&lt;p&gt;text&lt;/p&gt; 
```

为了防止这种情况，您可以使用`HtmlHelper`s`Raw`方法：

```
@Html.Raw(s) 
```

或者您可以使用`HtmlString`（或在 .NET 4 之前`MvcHtmlString`）：

```
var s = new HtmlString("<p>text</p>"); 
```

通过使用`HtmlString`( `MvcHtmlString`)，razor 知道不对输出字符串进行 HTML 编码。

* * *

因此，在您的特定情况下，您要么使用`@Html.Raw(Html.LinkButton(...))`，要么更改辅助扩展的输出类型：

```
public static HtmlString LinkButton(this HtmlHelper helper, string id, string value, string target, object htmlAttributes)
...
return new HtmlString(linkButton.ToString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:00:54.750

@voroninp 将返回类型从字符串切换到 MvcHtmlString 效果很好，但是在这种情况下，使用声明性帮助器是一个更清晰的选择，尽管为我更复杂的帮助器切换返回类型会更好。

# android - 在android中自动接听电话

> ID：14446323
> 
> 赞同：0
> 
> 时间：2013-01-21T20:04:37.493
> 
> 标签：android

我是安卓新手。我正在寻找一种自动接听来电的方法。我刚刚浏览了**SIPDemo**，但无法理解太多信息。

是否可以接听特定号码的电话？”和“有这方面的材料或教程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:46:40.953

你会想要使用答案意图 - [http://developer.android.com/reference/android/content/Intent.html#ACTION_ANSWER](http://developer.android.com/reference/android/content/Intent.html#ACTION_ANSWER)

# google-app-engine - 使用 HashMap 外部化实体时出错

> ID：14446327
> 
> 赞同：0
> 
> 时间：2013-01-21T20:04:56.360
> 
> 标签：google-app-engine, graniteds

当我的 flex 应用程序尝试获取具有至少一个 HashMap 属性的持久实体时，我收到此错误：`org.granite.messaging.persistence.ExternalizablePersistentMap cannot be cast to java.util.Map` 根据我的搜索，我相信我缺少一些外部化配置，这是……？

这就是我所拥有的：

实体：

```
@Persistent private HashMap<String, String> email; 
```

Gas3 生成的 EntityBase：（无潮）

```
private var _email:IMap; 
```

花岗岩-config.xml：

```
<externalizers>
    <externalizer type="org.granite.datanucleus.DataNucleusExternalizer">
        <include annotated-with="javax.jdo.annotations.PersistenceCapable"/>
    </externalizer>
</externalizers> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T14:29:39.007

我放弃了使用地图，我不能被困太久。

我使用 HashMap 或 BasicMap 的所有地方都更改为`HashSet<MyCustomMapLikeEntity>`

有总比没有好...

# c# - 将 TabControl 附加到 MDI 父窗体而不是工具条

> ID：14446338
> 
> 赞同：1
> 
> 时间：2013-01-21T20:05:42.603
> 
> 标签：c#, winforms, mdi

我有一组行为良好的 Windows 窗体，它们嵌入在我无法完全控制的 DLL 中。这些是我试图在一个界面下统一的单独遗留项目的一部分，这样应用程序就不会感觉像弹出地狱。

我认为这样做的方法是创建一个 MDI 父窗体，并将其他窗体作为其子窗体打开。根据需要，一次形成一个孩子。当他们导航时，一个 MDI 文档将关闭，而另一个将打开。

但是，父 MDI 表单需要导航控件。我想使用一个tabcontrol。是否可以将选项卡控件附加到父 MDI 表单？我能找到的所有文档和示例都是工具条，但这对于我想要完成的任务来说太有限了。

没有可显示的代码，抱歉。我不确定我想要的是否可能。

**更新**如下所示，我真的不需要 MDI 来完成我打算做的事情。但是，保留原样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:22:15.377

如果我没看错，那么我认为 MDI 不是您要寻找的，因为您想使用 TabControl 导航到每个表单。

如果您将`TopLevel`其设置为 false 并从表单中移除边框，则实际上您将表单变成了 UserControl，并且可以将其添加到您选择的 TabPage 面板中：

```
 Form f = new Form();
  f.TopLevel = false;
  f.FormBorderStyle = FormBorderStyle.None;
  f.Dock = DockStyle.Fill;
  tabPage1.Controls.Add(f);
  f.Visible = true; 
```

更改`Form`为您从 DLL 引用的表单。

# intellij-idea - IntelliJ 检查：将 package.html 转换为 package-info.java

> ID：14446350
> 
> 赞同：2
> 
> 时间：2013-01-21T20:06:46.320
> 
> 标签：intellij-idea

显然，在 Intellij 10 中，引入了一个新功能来自动将 package.html 转换为 package-info.java 文件。我有11和12，找不到。

这是功能：http: [//youtrack.jetbrains.com/issue/IDEA-64769](http://youtrack.jetbrains.com/issue/IDEA-64769)

我已经激活了“检查小工具”插件。

并为其启用了 Javadoc 问题检查。

当我打开 package.html 文件时，它们是绿色的，没有出现黄色警告。如何触发转换？我错过了什么？

我有 2 个不错的设置截图，但是 stackoverflow 不允许我发布它们，因为我只有 10 个声望点。

![](../Images/3a820c75e0f10837fa6b8e95d4e0ef80.png) ![](../Images/230b9d06bffc74b407f9312008a92fc1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T08:20:23.620

它看起来像一个错误，我能够重现该问题并[在 YouTrack 中报告它](http://youtrack.jetbrains.com/issue/IDEA-99479)，请星标/投票以接收有关问题进度的通知。

# ruby - 怎么没有 FalseClass.new？

> ID：14446355
> 
> 赞同：2
> 
> 时间：2013-01-21T20:07:06.177
> 
> 标签：ruby

我试图了解 FalseClass 的方法查找链。由于 FalseClass 具有 Object 作为祖先，它不应该也可以访问该`new`方法吗？

是否`new`已从查找中排除？还是我误解了继承？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T20:14:59.833

只有一个`FalseClass`; 会有什么价值`new`？

要回答您的问题，来自`object.c`：

```
rb_cFalseClass = rb_define_class("FalseClass", rb_cObject);
rb_define_method(rb_cFalseClass, "to_s", false_to_s, 0);
rb_define_method(rb_cFalseClass, "&", false_and, 1);
rb_define_method(rb_cFalseClass, "|", false_or, 1);
rb_define_method(rb_cFalseClass, "^", false_xor, 1);
rb_undef_alloc_func(rb_cFalseClass);
rb_undef_method(CLASS_OF(rb_cFalseClass), "new"); 
```

`new`具体是未定义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:35:22.883

见[`Module#remove_method`](http://Ruby-Doc.Org/core-1.9.3/Module.html#method-i-remove_method)和[`Module#undef_method`](http://Ruby-Doc.Org/core-1.9.3/Module.html#method-i-undef_method)。@Dave Newton 的答案中的 C 代码基本上只是调用后者。

# php - 循环内的错误检查和执行查询？

> ID：14446357
> 
> 赞同：-2
> 
> 时间：2013-01-21T20:07:22.117
> 
> 标签：php, mysql, error-handling, pdo

如果我这样做，我需要能够在执行查询之前检查数组的所有元素是否有效：

```
$arr = array(5, 3, 'test', 23, 9);
$query = $members->prepare("insert into mytable(a) values(:a)");

foreach ($arr as $val) {
    if (is_int($val)) {
       $query->execute(array(':a'=>$val));
    }
} 
```

如果数组中的所有值都是 ，我只想将它们插入数据库`ints`，但它会在它进入数组中的“测试”之前插入前两个值。这只是我弥补我遇到的问题的一个随机示例。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:16:28.087

有两种方法可以处理这个：

1）遍历所有值并首先验证它（你真的应该减少验证不受控制的数据）。

2）如果您使用 PDO/INNOdb 启动一个事务，则运行该循环并在验证回滚失败时退出循环。

例如。

```
$db->beginTransaction();
$arr = array(5, 3, 'test', 23, 9);
$query = $members->prepare("insert into mytable(a) values(:a)");
$success = true;
foreach ($arr as $val) {
    if (is_int($val)) {
       $query->execute(array(':a'=>$val));
    } else {
      $success = false;
      $db->rollback();
      break;

    }
}

if($success) {
 $db->commit();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:10:09.023

> 如果它们都是整数，我只想将数组中的值插入数据库

当您需要检查数组时，循环始终是您的朋友

```
$fault = 0;
foreach ($arr as $val) {
    if (!is_int($val)) {
        $fault = 1;
        break;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:11:27.280

[http://php.net/manual/en/function.array-filter.php](http://php.net/manual/en/function.array-filter.php)怎么样

例子：

```
$arr = array(5, 3, 'test', 23, 9);
$nicearr = array_filter($arr, "getNumbersOnly")

function getNumbersOnly($var)
{
    return is_int($var);
} 
```

然后只需将 $nicearr 用于您的查询/循环，因为您可以确定它们都是整数。

# c# - WPF MVVM 可视化树绑定无法绑定

> ID：14446359
> 
> 赞同：0
> 
> 时间：2013-01-21T20:07:26.250
> 
> 标签：c#, wpf, xaml, data-binding, mvvm

我正在尝试绑定到我的视图模型上的命令。我正在使用视觉树上的事件触发器。我已经尝试了许多 RelativeSource、FindAncestor 和 AncestorType 的变体，试图绑定到它。每次我得到一个绑定路径表达式错误。

这是我的 xaml 文档大纲：

```
<Window>
   <Grid>
      <GridView>
         <HierarchyChildTemplate>
             <DataTemplate>
                  <TabControl>
                      <TabItem>
                          <GridView>
                              <RowDetailsTemplate>
                                 <TabControl>
                                     <!--trying to bind a event trigger here to a command on the viewModel --> 
```

这是我尝试过的绑定示例：

```
<i:Interaction.Triggers>
      <i:EventTrigger EventName="SelectionChanged">
          <i:InvokeCommandAction Command="{Binding Path=SelectionChangedCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Grid}}}"/>
      </i:EventTrigger>
</i:Interaction.Triggers> 
```

如何从 xaml 中注明的位置绑定到此命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:26:32.090

根据您的视觉树和您在评论中写的内容（我还没有测试过）：

```
<i:Interaction.Triggers>
  <i:EventTrigger EventName="SelectionChanged">
      <i:InvokeCommandAction Command="{Binding Path=DataContext.SelectionChangedCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}"/>
  </i:EventTrigger>
</i:Interaction.Triggers> 
```

也就是说，在这种情况下，我建议使用命名绑定....为最顶层的网格（或原始窗口）命名，例如：

```
<Window Name="MainWindow">
  .... 
```

然后，您可以使用 Bind `ElementName`：

```
<i:InvokeCommandAction Command="{Binding Path=DataContext.SelectionChangedCommand, 
                                         ElementName=MainWindow}"/> 
```

关于您在评论中所说的（AncestorType 到达错误的网格），使用`AncestorLevel=2`应该可以帮助您绑定到最顶层的网格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:00:11.943

最后尝试了这个，它奏效了：

```
<i:Interaction.Triggers>
  <i:EventTrigger EventName="SelectionChanged">
     <i:InvokeCommandAction Command="{Binding Path=DataContext.SelectionChangedCommand, 
         RelativeSource={RelativeSource Mode=FindAncestor, AncestorLevel=2,AncestorType={x:Type GridView}}}"/>
   </i:EventTrigger>
</i:Interaction.Triggers> 
```

这里的关键点是使用 DataContext 和 AncestorLevel=2 对命令进行前缀。

# actionscript-3 - mxmlc 错误：无法解析语言环境“y”的资源包“X”：ANT 构建问题

> ID：14446360
> 
> 赞同：1
> 
> 时间：2013-01-21T20:07:43.453
> 
> 标签：actionscript-3, apache-flex, ant, localization, flex4.5

我知道这个主题有很多类似的问题和答案，但我仍然遇到同样的问题。到目前为止，我已经看过[这个](http://forums.adobe.com/message/2671191)，[这个](https://stackoverflow.com/questions/5666310/flex-and-ant-resource-bundle-error)，[这个](https://stackoverflow.com/questions/3108065/unable-to-resolve-resource-bundle-for-locale-en-us-flex-flash-builder)，[这个](http://cookbooks.adobe.com/post_Easily_compile_resource_bundles_using_Ant-12765.html)，[这个](https://stackoverflow.com/questions/1028644/flex-unable-to-open-locale-en-us)，等等......无济于事。

当我尝试在我的项目上运行 ANT 构建时，我总是会收到此错误。

```
 [mxmlc] Error: Unable to resolve resource bundle "resources" for locale "en_US".

BUILD FAILED
C:\***\flashWorkspace\shop\build.xml:8: The following error occurred while executing this line:
C:\***\flashWorkspace\Scripts\flex-build.xml:50: The following error occurred while executing this line:
C:\***\flashWorkspace\Scripts\flex-build.xml:123: mxmlc task failed 
```

我的 build.xml：

```
<target name="compile" depends="common-build.compile">
    <antcall target="flex-build.compile-air-application"/>   // line 8
</target> 
```

这将我们带到了我的 flex-build.xml （这是我将调用引发错误的宏的地方）：

```
<target name="compile-air-application">
    <compileSWF>      // line 50
        <compiler-options>
            <load-config filename="${FLEX_HOME}/frameworks/air-config.xml"/>
        </compiler-options>
    </compileSWF>            
</target> 
```

最后，包含错误 mxmlc 调用的宏本身：

```
<macrodef name="compileSWF">
    <element name="compiler-options" optional="yes"/>
    <attribute name="sourceDir" default="${src.dir}"/>
    <attribute name="libraryDir" default="${build.lib.dir}"/>
    <attribute name="buildDir" default="${build.dir}"/>
    <attribute name="locale" default="${locale}"/>
    <attribute name="applicationFile" default="${application.file}"/>
    <attribute name="outputFile" default="${swf.file}"/>
    <sequential>
        <delete file="@{buildDir}/@{outputFile}"/>
        <mxmlc file="@{sourceDir}/@{applicationFile}" output="@{buildDir}/@{outputFile}" locale="@{locale}">          //line 123
            <compiler-options/>
            <source-path path-element="@{sourceDir}"/>
            <compiler.library-path dir="@{libraryDir}" append="true">
                <include name="*.swc"/>
            </compiler.library-path>
        </mxmlc>
    </sequential>
</macrodef> 
```

这些是我的编译器参数：

```
-locale=en_US,fr_FR -source-path=locale/{locale} 
```

基本上我的文件夹结构是这样的

```
Proj 
  |-- src 
  |-- lib 
  |-- locale 
          |-- en_US
               |-- resources.properties     
          |-- fr_FR 
               |-- resources.properties 
```

谁能看到我的 ANT 版本有什么问题？如果您需要更多信息，我很乐意编辑并将它们添加到帖子中。我尝试了无数在网上找到的黑客方法：我整天都在尝试解决这个问题：/

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T14:07:22.597

仅供遇到此问题的其他人使用，通过添加以下两个指令来解决：

```
 **<source-path>locale/{locale}</source-path>
            <include-resource-bundles>resources</include-resource-bundles>** 
```

所以 mxmlc 看起来像这样

```
<mxmlc file="@{sourceDir}/@{applicationFile}" output="@{buildDir}/@{outputFile}" locale="@{locale}">
    <compiler-options/>
    <source-path>locale/{locale}</source-path>
    <include-resource-bundles>resources</include-resource-bundles>
    <source-path path-element="@{sourceDir}"/>
    <compiler.library-path dir="@{libraryDir}" append="true">
        <include name="*.swc"/>
    </compiler.library-path>
</mxmlc> 
```

# symfony - 在 symfony 2 中放置通用 css 的位置

> ID：14446364
> 
> 赞同：0
> 
> 时间：2013-01-21T20:07:50.670
> 
> 标签：symfony

我被卡住了，我不知道将整个项目应用程序的 css 文件放在哪里。

我的项目/app/Resources/views/base.html.twig 看起来像这样：

```
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>{% block title %}my app{% endblock %}</title>
        <link href="{{ asset('/css/main.css') }}" rel="stylesheet" type="text/css" />

    </head>
    <body> 
```

...我的文件在：

项目\应用\资源\公共\css\main.css

但它永远不会被加载。

那么，我应该将 css 文件放在哪里，以及如何将它包含在我的模板中？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:21:21.033

看[这里](http://symfony.com/doc/2.0/cookbook/assetic/asset_management.html)，关于资产管理的文档。

您可能必须执行以下命令：

```
php app/console assetic:dump 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:14:28.913

移动文件到`project/web/css/main.css`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T01:18:17.890

你需要使用

`<link href="{{ asset('css/main.css') }}" rel="stylesheet" type="text/css" />`

在 css 之前没有斜杠

# performance - 如何在haskell中使用内联的相位控制？

> ID：14446368
> 
> 赞同：21
> 
> 时间：2013-01-21T20:08:11.970
> 
> 标签：performance, haskell, ghc, inlining, repa

文档[说](http://www.haskell.org/ghc/docs/latest/html/users_guide/pragmas.html#phase-control)，

> 有时您想准确控制在 GHC 的管道中何时打开 INLINE pragma。

为什么我要这个？（除了当我也使用 RULES pragma 时，在这种情况下，我可能想推迟函数的内联，以便触发相关的规则。）什么样的函数只在简化过程的特定阶段内联更好？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-05T21:08:44.600

正如其他人所说，你基本上回答了你自己的问题。但我想你可能想要一个更精简和具​​体的例子，说明在哪里使用相位控制与`RULES`/`INLINE`是有益的。* 除了通常很复杂的高度优化的库之外，你看不到它们，所以很高兴看到更小的案例。

这是我最近使用递归方案实现的示例。我们将使用变质的概念来说明这一点。您不需要详细了解这些内容，只需知道它们是“折叠”运算符的特征。（真的，这里不要过分关注抽象概念。这只是我拥有的最简单的示例，您可以在其中获得很好的加速。）

## 快速介绍变质

我们从`Mu`定点类型开始，它的定义`Algebra`只是一个函数的奇特同义词，它“解构”了一个值`f a`以返回一个`a`。

```
newtype Mu f = Mu { muF :: f (Mu f) }

type Algebra f a = f a -> a 
```

我们现在可以定义两个运算符`ffold`and `fbuild`，它们是列表的传统`foldr`和`build`运算符的高度通用版本：

```
ffold :: Functor f => Algebra f a -> Mu f -> a
ffold h = go h 
  where go g = g . fmap (go g) . muF
{-# INLINE ffold #-}

fbuild :: Functor f => (forall b. Algebra f b -> b) -> Mu f
fbuild g = g Mu
{-# INLINE fbuild #-} 
```

粗略地说，`ffold` *破坏*由 an 定义的结构`Algebra f a`并产生 an `a`。`fbuild`而是*创建*一个由其定义的结构`Algebra f a`并产生一个`Mu`值。该`Mu`值对应于您正在谈论的任何递归数据类型。就像常规的`foldr`and `build`：我们使用它的 cons 来解构一个列表，我们也使用它的 cons 来构建一个列表。我们的想法是我们刚刚推广了这些经典运算符，因此它们可以处理*任何*递归数据类型（如列表或树！）

最后，这两个运算符伴随着一个规律，它将指导我们的整体`RULE`：

```
forall f g. ffold f (build g) = g f 
```

该规则基本上概括了森林砍伐/融合的优化 - 去除中间结构。（我想该定律的正确性证明留给读者作为练习。通过等式推理应该很容易。）

我们现在可以使用这两个组合子以及`Mu`来表示递归数据类型，如列表。我们可以在该列表上编写操作。

```
data ListF a f = Nil | Cons a f
  deriving (Eq, Show, Functor)
type List a = Mu (ListF a)

instance Eq a => Eq (List a) where
  (Mu f) == (Mu g) = f == g

lengthL :: List a -> Int
lengthL = ffold g
  where g Nil = 0
        g (Cons _ f) = 1 + f
{-# INLINE lengthL #-} 
```

我们也可以定义一个`map`函数：

```
mapL :: (a -> b) -> List a -> List b
mapL f = ffold g
  where g Nil = Mu Nil
        g (Cons a x) = Mu (Cons (f a) x)
{-# INLINE mapL #-} 
```

# 内联 FTW

我们现在有一种方法可以在我们定义的这些递归类型上编写术语。但是，如果我们要写一个像

```
lengthL . mapL (+1) $ xs 
```

然后，如果我们扩展定义，我们基本上得到了两个`ffold`运算符的组合：

```
ffold g1 . ffold g2 $ ... 
```

这意味着我们实际上是在破坏结构，然后重建它并*再次*破坏。真是太浪费了。此外，我们可以根据 重新定义`mapL`，`fbuild`因此它有望与其他功能融合。

好吧，我们已经有了我们的法律，所以 a`RULE`是有序的。让我们编码：

```
{-# RULES
-- Builder rule for catamorphisms
"ffold/fbuild" forall f (g :: forall b. Algebra f b -> b).
                  ffold f (fbuild g) = g f
-} 
```

接下来，我们将`mapL`根据`fbuild`融合目的重新定义：

```
mapL2 :: (a -> b) -> List a -> List b
mapL2 f xs = fbuild (\h -> ffold (h . g) xs)
  where g Nil = Nil
        g (Cons a x) = Cons (f a) x
{-# INLINE mapL2 #-} 
```

啊啊啊，我们完成了，对吧？错误的！

## 乐趣和利润的阶段

问题是内联发生时的约束为零，这将完全搞砸。考虑之前我们想要优化的情况：

```
lengthL . mapL2 (+1) $ xs 
```

我们希望 和 的定义`lengthL`被`mapL2`内联，以便`ffold/fbuild`规则可以在正文之后触发。所以我们想去：

```
ffold f1 . fbuild g1 ... 
```

通过内联，然后转到：

```
g1 f1 
```

通过我们的`RULE`.

嗯，这不能保证。本质上，在简化器的一个阶段，GHC*不仅*`lengthL`可以内联和的定义`mapL`，而且还可以内联`ffold`和`fbuild`在其使用站点的定义。这意味着 RULE 永远不会有机会触发，因为阶段“吞噬”了所有相关标识符，并将它们内联成空。

观察结果是我们希望*尽可能晚地*`ffold`进行内联。因此，我们将尝试尽可能多地暴露我们的 RULE 触发的机会。如果不这样做，那么身体就会内联，而 GHC 仍然会尽力而为。但最终，我们希望它延迟内联；这将比任何聪明的编译器优化为我们节省更多的效率。`fbuild` *`RULE`*

 *所以这里的修复是注释`ffold`并`fbuild`指定它们应该只在阶段 1 触发：

```
ffold g = ...
{-# INLINE[1] ffold #-}

fbuild g = ...
{-# INLINE[1] fbuild #-} 
```

现在，`mapL`和朋友们会很早就内联，但这些会很晚。GHC 从某个阶段数 N 开始，阶段数减少到零。阶段 1 是最后一个阶段。也可以`fbuild/ffold`比第 1 阶段更早进行内联，但这基本上意味着您需要开始增加阶段的数量来弥补它，或者开始确保 RULE 总是在一些早期阶段触发。

## 结论

您可以在我的要点中找到[所有这些以及更多内容](https://gist.github.com/thoughtpolice/4411740)**，以及所有提到的定义和示例。它还附带了我们示例的标准基准：使用我们的阶段注释，GHC 能够在触发时将运行时间减少`lengthL . mapL2`一半。`lengthL . mapL1``RULE`

如果您想亲自查看，可以使用 编译代码`-ddump-simpl-stats`，并查看`ffold/fbuild`在编译管道期间触发的规则。

最后，大多数相同的原则适用于向量或字节串等库。诀窍是您可能在这里有多个级别的内联，以及更多的*规则*。这是因为流/数组融合之类的技术倾向于有效地融合循环和重用数组——与这里相反，我们只是通过删除中间数据结构来进行经典的森林砍伐。根据生成的代码的传统“模式”（例如，由于矢量化的并行列表理解），以一种较早消除明显缺陷的方式进行交错或专门的相位优化可能非常值得。或者，针对 a`RULE`与 an 组合`INLINE`会产生更多的情况进行优化`RULE`s （因此有时您会看到交错的阶段 - 这基本上会交织一个内联阶段。）出于这些原因，您还可以控制`RULE`触发 a 的阶段。

因此，虽然`RULE`带有阶段的 s 可以为我们节省大量运行时间，但它们也可能需要大量时间才能正确处理。这就是为什么您经常只在最“高性能”、高度优化的库中看到它们的原因。

## 笔记

*   *您最初的问题是“哪些功能受益于相位控制”，这对我来说听起来像是在问“哪些功能受益于不断的子表达式消除”。如果可能的话，我不确定如何准确回答这个问题！这更像是编译器领域的事情，而不是任何关于函数或程序行为的理论结果——即使*有*数学定律，也不是所有的“优化”都有你期望的结果。结果，答案实际上是“您可能会在编写和基准测试时知道”。

*   ** 您可以放心地忽略文件中的许多其他内容；它主要是一个游乐场，但你也可能很有趣。那里还有其他示例，例如自然树和二叉树-您可能会发现尝试利用它们来利用各种其他融合机会是值得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T06:37:29.533

首先，我应该注意到，GHC 的默认行为被设计为在大多数情况下都是最优的。除非你有问题，否则你最好让那些每天都在思考 haskell 的聪明人基本上是正确的（PS 我*不是*那些人之一），但你问...

据我了解，使用它有两个原因。

1.  使程序更快地收敛到最佳形式：

    Haskell 将反复尝试每条规则，只要另一端的结果严格优于它开始时的结果。它总是会收敛，但没有什么说它会在宇宙热寂之前这样做。在一般情况下，只需要一手传球就可以了，但是有些极端情况可能会变得非常糟糕。如果它们发生，这将允许您手动解决这些边缘情况。

2.  避免收敛到局部最小值

    在某些情况下，应用 Rule`A`会阻止应用更好的 Rule `B`。那么重要的是`B`先来`A`。默认优化规则精心设计以避免此问题，但正如文档所述，它们也非常保守。随着您添加更多规则，您将不可避免地开始破坏其他可能的优化。然后，您需要在规则链中找到一个不会发生这种情况的地方。据我所知，唯一的判断方法是反复试验。*

# cordova - phonegap - 从自定义广告服务器投放 javascript 广告？

> ID：14446377
> 
> 赞同：1
> 
> 时间：2013-01-21T20:09:14.240
> 
> 标签：cordova, ads

是否可以将我自己的 javascript 广告标签嵌入到与 phonegap 打包的 html5 应用程序中？我做了很多谷歌搜索，大多数用户使用 admob，但我想投放自己的广告。理想情况下，我只是从我们的广告服务器嵌入广告标签，它们将 iframe 呈现到目标广告内容。

我不是 100% 确定 phonegap 是如何工作的，但据我所知，它只是一个带有 Web 浏览器组件的本机应用程序，为应用程序的 html 内容提供服务。所以理论上我可以粘贴任何 html/javascript，它的功能就像移动 safari/chrome 在 Web 服务器上浏览相同的内容一样。

有没有人尝试过或者知道它是否违反了 Apple/Google TOS？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T01:48:16.993

只要广告不需要 PHP 或任何其他服务器端软件，它就可以正常工作。我之前亲自使用 Javascript 广告代码完成了它，没有任何问题。

Apple 和 Google 都允许您在应用中展示广告

# php - 正则表达式替换PHP中的整个单词

> ID：14446378
> 
> 赞同：0
> 
> 时间：2013-01-21T20:09:18.657
> 
> 标签：php, regex, preg-replace

我有这样的表达：

```
$x="We have a cat here."; 
```

我想用例如 5 替换“a”，所以应该如下所示：

```
We have 5 cat here. //It doesn't make sense, but it's just an example. 
```

我试过简单

```
echo str_replace("a","5",$x); 
```

但那又回来了

```
We h5ve 5 c5t here. 
```

然后，我尝试了

```
echo str_replace(" a "," 5 ",$x); 
```

但这对像这样的字符串不起作用

```
We have a cat here. (A dog actually). 
```

我决定使用正则表达式，但我完全是新手，我不知道如何使用它们中的任何一个......好吧，我真的很感谢任何指向一个好的教程的链接，但我需要很快得到答案。 ..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T20:11:27.647

用于`\b`划分单词边界，例如

```
$newstring = preg_replace('/\b[Aa]\b/', '5', $string); 
```

# c++ - 交换动态分配的数组错误

> ID：14446379
> 
> 赞同：2
> 
> 时间：2013-01-21T20:09:19.280
> 
> 标签：c++, visual-c++

我尝试交换 2 个具有不同容量的动态分配数组。我尝试使用：

```
int *temp = arr1;
int arr1 = arr2;
int arr2 = temp; 
```

但是，这种方法不起作用。所以我尝试不同的方法：

```
ItemType *temparr1 = new ItemType[other.capacity];
std::copy(setMember, setMember+capacity, temparr1);
ItemType *temparr2 = new ItemType[this->capacity];
std::copy(setMember, setMember+capacity, temparr2);
delete [] this->setMember;
delete [] other.setMember;
other.setMember = temparr1;
this->setMember = temparr2; 
```

不幸的是，这种方法会抛出错误消息：“Windows 在 Hw1.exe 中触发了断点。

这可能是由于堆损坏，这表明 Hw1.exe 或其已加载的任何 DLL 中存在错误。”

知道如何交换动态分配的数组吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T20:12:15.413

您无法交换内存，因为它的大小不同（假设`other.capacity`不同于`this->capacity`- 如果是，则不会出现运行时错误）。

改为使用`std::vector`。

如果您只想交换指针指向的内容：

```
int *temp = arr1;
arr1 = arr2;
arr2 = temp; 
```

或者

```
std::swap(arr1, arr2); 
```

再次注意，这些不会交换实际内存，而是指针的值。

观察`int`您最初拥有的缺失声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:12:35.857

您的第一种方法应该可以简单地删除`int`第二行和第三行之前的内容（不要标记新的整数变量，分配给数组）。同样正如 hmjd 所指出的，您可以使用`std:swap`.

如果要使用使用 std::copy 显示的第二种方法，则必须首先调整数组的大小，因为它的容量可能不足。

# java - Java中是否有能够抛出异常类型的方法？

> ID：14446380
> 
> 赞同：-4
> 
> 时间：2013-01-21T20:09:24.973
> 
> 标签：java, exception, methods, exception-handling

谁能想到 Java 中能够抛出所有异常类型的方法？我知道这将是一种**非常**可怕的方法，但我很好奇是否有人做过。

我问是因为在今天的课堂上我们正在讨论异常，我认为看到一种能够抛出每种类型的方法会很有趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T20:11:29.327

一个例外是可以定制的东西。您要问的是是否有一个抛出通用 Throwable 对象的方法。使用此声明，任何现有异常或新创建的异常都由 throws 语句“处理”

```
public void myMethod throws Throwable{ ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:13:44.703

`Exception`程序员可以创建新的 " " 类型，所以你永远不可能有一个明确抛出 every `Exception`ever 的函数，因为有无限数量的`Exception`s 可能。

你可以`throw Throwable`，但这对你没有任何好处。

但是，通过捕获 Throwable，捕获所有可能的异常*是*可能的，也许这就是您要问的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:14:01.963

不。

最近的事情是：

```
public void horribleMethod() thorw Throwable; 
```

但这会抛出一个泛型类型。如果我曾经读过这样的方法签名，我会把程序员的头拍到键盘上。

# java - 使用 Java 管理非常长时间的操作

> ID：14446384
> 
> 赞同：7
> 
> 时间：2013-01-21T20:09:41.440
> 
> 标签：java, rest, jakarta-ee, ejb, jms

实际上，我有以下流程：

1.  用户点击“大操作”按钮；
2.  它调用一个 RESTful 服务；
3.  其余服务调用一个HugeOpServiceBean，它是一个EJB；
4.  这个 EJB 将告诉 JMS 队列执行 HugeOperation；
5.  这个 HugeOperation 可能有两个或多个实现，因此，每个正在监听它的 MDBean 都会运行（这意味着它可能在另一个 .ear 中）

我想听听你们如何做或建议我让我能够获得这些 MDBean 的“状态”。

基本上，每个 MDBean 都会在一些对象类型的列表中运行一些方法，所以，计算完成的百分比应该很容易，我只是不知道如何以及哪个是我可以做出的最佳架构决策，以使其在一些 RESTful 中可访问服务。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T20:15:55.727

处理此问题的 RESTful 方式是：

1.  在第一次调用后，向客户端返回 HTTP 202 状态代码“已接受”，以指示请求成功，但需要进一步处理。您还可以提供带有响应的 URI，客户端可以使用该 URI 来查询“作业”的状态
2.  实现一个端点，客户端可以调用该端点来查询作业的状态。
3.  当操作完成时，上面 2) 中的端点将发出永久重定向到操作创建的主实体的实际 URI。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:24:47.277

由于 MDB 消费和处理是交易的，所以要么全有，要么全无。显示进度会很复杂，需要子事务来更新进度。我建议将工作分块在 EJB 中的多个 JMS 消息中，并在以后成功使用 JMS 消息时监控进度。查看[企业集成模式](http://www.eaipatterns.com/)

# ruby-on-rails - Rails 控制器参数属性未定义

> ID：14446385
> 
> 赞同：0
> 
> 时间：2013-01-21T20:09:44.617
> 
> 标签：ruby-on-rails, ruby, session, railstutorial.org, sorcery

回答。见文末。

我主要是一名 Java 开发人员，并且对 Ruby on Rails 相当陌生。我已成功完成 railstutorial.org 上的教程。所以我让这个工作一次。当我第二次开始阅读本教程时出现了我的问题，但这次尝试用 Sorcery gem 替换身份验证。我的主要参考是[railscasts.org 上的第 283 集](http://railscasts.com/episodes/283-authentication-with-sorcery?view=asciicast)。其中一些正在工作，但是当我尝试登录时，我收到一条错误消息：

> SessionsController#create 中的 ActiveRecord::PreparedStatementInvalid
> 
> [:email] = :login 中的 :email 缺失值

这是一件很难搜索的事情，因为它非常具体，但在很多地方都出现了非常笼统的词。我认为当我让它工作时，我正在以与原始教程相同的方式做事。下面是我的views/sessions/new.html.erb，它和原来的教程差不多。

```
<% provide(:title, "Sign in") %>
<h1>Sign in</h1>

<div class="row">
  <div class="span6 offset3">
    <%= form_for(:session, url: sessions_path) do |f| %>

      <%= f.label :email %>
      <%= f.text_field :email %>

      <%= f.label :password %>
      <%= f.password_field :password %>

      <%= f.check_box :remember_me %>
      <%= f.label :remember_me %>

      <%= f.submit "Sign in", class: "btn btn-large btn-primary" %>
    <% end %>

    <p>New user? <%= link_to "Sign up now!", signup_path %></p>
  </div>
</div> 
```

这是我的 session_controller.rb 中的 create 方法，由于巫术，它与教程略有不同，但我不知道为什么 params 引用的工作方式与教程中的不同：

```
def create
  user = login(params[:session][:email], params[:session][:password])
  if user
    redirect_back_or_to root_url, :notice => "Logged in!"
  else
    flash.now[:error] = 'Invalid email/password combination' # Not quite right!
    render 'new'
  end
end 
```

rails cast 只使用 params[:email] 但那是因为他使用 form_tag 而不是 form_for 并更改了要使用的参数。

我真的迷路了。不知道为什么它与教程的工作方式不同。任何帮助将不胜感激。让我知道我是否应该提供任何其他信息。谢谢。

编辑：
添加了上面的完整错误。一定是巫术的登录方式或者我的数据库有问题。参数很好。这是完整的堆栈跟踪（回到我的代码部分。它真的太长了。）

堆栈跟踪：

> activerecord (3.2.11) lib/active_record/sanitization.rb:141:in `block in replace_named_bind_variables'
> 
> activerecord (3.2.11) lib/active_record/sanitization.rb:135:in `gsub'
> 
> activerecord (3.2.11) lib/active_record/sanitization.rb:135:in `replace_named_bind_variables'
> 
> activerecord (3.2.11) lib/active_record/sanitization.rb:115:in `sanitize_sql_array'
> 
> activerecord (3.2.11) lib/active_record/sanitization.rb:28:in `sanitize_sql_for_conditions'
> 
> activerecord (3.2.11) lib/active_record/relation/query_methods.rb:324:in `build_where'
> 
> activerecord (3.2.11) lib/active_record/relation/query_methods.rb:136:in `where'
> 
> activerecord (3.2.11) lib/active_record/querying.rb:9:in `where'
> 
> 巫术 (0.7.13) 库/巫术/模型/适配器/active_record.rb:32:in `find_by_credentials'
> 
> 巫术 (0.7.13) lib/sorcery/model.rb:108:in 'authenticate'
> 
> 巫术 (0.7.13) lib/sorcery/controller.rb:33:in `login'
> 
> app/controllers/sessions_controller.rb:8:in `create'

我想我太新了，不能马上回答我自己的问题。自己修好了：

在 sorcery.rb 中，我有：

user.username_attribute_names = '[:email]'

显然，引号不应该在那里。我对文件中的评论感到困惑。进行更改后，我需要重新启动服务器才能使更改生效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T17:25:58.103

自己修好了：

在 sorcery.rb 中，我有：

user.username_attribute_names = '[:email]'

显然，引号不应该在那里。我对文件中的评论感到困惑。进行更改后，我需要重新启动服务器才能使更改生效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T08:57:44.843

我看到巫术的源代码。而 username_attribute_names 应该是一个数组。

这是在 sorcery/spec/rails3/spec/controller_spec.rb 中：

sorcery_model_property_set(:username_attribute_names, [:username, :email])

它将被调用：def find_by_credentials(credentials) sql = @sorcery_config.username_attribute_names.map{|attribute| column_name(attribute) + " = :login"} where(sql.join(' OR '), :login => credentials[0]).first end

所以，试试

user.username_attribute_names = [:email] 或 sorcery_model_property_set(:username_attribute_names, [:email])

# ruby-on-rails - 检查是否在 Ruby/Rails 中的 .each 循环的第一次迭代中的 DRYest 方法

> ID：14446388
> 
> 赞同：22
> 
> 时间：2013-01-21T20:10:00.653
> 
> 标签：ruby-on-rails, ruby-on-rails-3, loops, each

在我的`.erb`中，我有一个简单的`each`循环：

```
<%= @user.settings.each do |s| %>
  ..
<% end %> 
```

检查它当前是否正在进行第一次迭代的最简单方法是什么？我知道我可以设置`i=0...i++`，但在`.erb`. 有什么建议么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-21T20:11:29.133

这取决于数组的大小。**如果它真的很大**（几百或更多），你应该[`.shift`](http://apidock.com/ruby/Array/shift)数组的第一个元素，处理它，然后显示集合：

```
<% user_settings = @user_settings %>
<% first_setting = user_settings.shift %>
# do you stuff with the first element 
<%= user_settings.each do |s| %>
  # ... 
```

或者您可以使用[`.each_with_index`](http://apidock.com/ruby/Enumerable/each_with_index)：

```
<%= @user.settings.each_with_index do |s, i| %>
  <% if i == 0 %>
    # first element
  <% end %>
  # ...
<% end %> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-09-11T22:45:02.780

我发现最易读的方式如下：

```
<%= @user.settings.each do |s| %>
  <% if @user.settings.first == s %>
    <% # Your desired stuff %>
  <% end %>
<% end %> 
```

# .net - MSBuild 预构建事件，它是编译时的依赖项，但不是运行时的依赖项

> ID：14446389
> 
> 赞同：0
> 
> 时间：2013-01-21T20:10:06.690
> 
> 标签：.net, build, msbuild

我在 SLN 解决方案中有两个项目：

*   项目 X：可执行。
*   项目 Y：图书馆。

项目 Y 并不真正依赖于 X（我不应该将 X 添加到 Y 的引用列表中），发生的情况是项目 X 是一个可执行文件，它将在构建后对 Y.dll 进行一些操作。

那么如何在他们的 MSBuild .csproj 文件中编写代码呢？我想我需要：

*   项目 Y 中的预构建任务，用于构建项目 X。
*   项目 Y 中的构建后任务，用于执行项目 X。

如何在 MSBuild 中执行此操作？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:15:58.410

实际上，如果您向构建 x 的解决方案添加对 y 的引用并右键单击 y 的属性并将默认操作从不复制更改为始终复制，则在构建解决方案时，您只需要一个构建后事件即可运行x, y 将在同一个 bin 目录中。

# linux - Linux Bash 脚本终止时如何防止终端窗口关闭？

> ID：14446391
> 
> 赞同：20
> 
> 时间：2013-01-21T20:10:08.677
> 
> 标签：linux, bash

我编写了一个简单的 bash 脚本来删除一些与特定模式匹配的临时文件：

```
#!/bin/bash
cd ~/some_project/some_dir
rm */*.xml 
```

我已将其保存为“脚本”，并`+x`通过终端对其进行了修改。现在，当我双击这个文件时，我可以选择在终端中运行它或显示它的输出。如果我单击在终端中运行，则脚本可以正常工作，但是终端窗口会立即关闭。我宁愿窗口保持打开状态，这样我可以查看是否有任何错误（如果可能的话，可能让 rm 显示已删除文件的名称）。

我正在寻找一种简单的方法来防止终端关闭直到按键发生..有这样的方法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-21T20:11:53.457

将`read`命令添加到脚本的末尾。它将等待完整的输入行（即`Enter`键）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-21T20:12:45.170

```
read -rn1 
```

有关[`help read`](http://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html#index-read)更多信息，请参阅。

# php - 使用 preg_replace 改变 index.php 来测试

> ID：14446393
> 
> 赞同：2
> 
> 时间：2013-01-21T20:10:09.433
> 
> 标签：php

在我的论坛网址中，到处都有“index.php”。我想用“测试”替换它。在我的 PHP 文件中，我有这一行：

```
// Makes it easier to refer to things this way.
    $scripturl = $boardurl . '/index.php'; 
```

我尝试将其更改为：

```
// Makes it easier to refer to things this way.
    $scripturl = $boardurl . '/test'; 
```

但是，这返回了 404 错误。有人告诉我，我需要使用 preg_replace 来实现这一点。我查看了 PHP 手册，它说我需要一个模式、替换和主题。我对主题部分感到困惑。

我试过这个，但没有占上风：

```
// Makes it easier to refer to things this way.
    $scripturl = $boardurl . preg_replace('/index.php','/test','?'); 
```

这是一个示例 URL：“domain.com/index.php?node=forum”

我希望它看起来像：“domain.com/test?node=forum”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:19:18.603

您可以使用[`str_replace()`](http://php.net/manual/en/function.str-replace.php). 像这样：

```
$new_url = str_replace('index.php', 'test/', $original_url); 
```

请注意，它[`preg_replace()`](http://php.net/manual/en/function.preg-replace.php)也可以完成这项工作，但它更复杂（并且功能强大）。str_replace() 适合这种情况。

仅供参考，str_replace 的主题参数是**原始**字符串，在您的示例中是带有“index.php”的 url。您的示例如下所示：

```
$pattern = '/index\.php/';
$replacement = 'test/';
$subject = 'http://yoursite.com/index.php?foo=bar';

echo preg_replace($pattern, $replacement, $subject); 
```

# wordpress - 如何将标签添加到 WordPress 中的类别？

> ID：14446399
> 
> 赞同：0
> 
> 时间：2013-01-21T20:10:33.863
> 
> 标签：wordpress, tags, categories

我希望能够按不同的字段对我的类别列表进行排序。我认为标签（或任何任意字段）是做到这一点的好方法。但我看不到如何将标签添加到类别。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T06:13:56.713

从此 WordPress StackExchange 问答中：

### [创建新分类时添加自定义分类字段](https://wordpress.stackexchange.com/q/29322/12615)

这些不是标签，而是保存在`wp_options`表格中的自定义字段。并且使用类别 ID 保存和检索它们，例如`get_option( "taxonomy_$t_id" )`.
查看完整的问答以了解其他解决方案。修改后的代码：

```
add_action( 'category_edit_form_fields', 'extra_edit_tax_fields_wpse_29322', 15, 2 );
add_action( 'category_add_form_fields', 'extra_add_tax_fields_wpse_29322', 10, 2 );
add_action( 'edited_category', 'save_extra_taxonomy_fields_wpse_29322', 10, 2 );
add_action( 'create_category', 'save_extra_taxonomy_fields_wpse_29322', 10, 2 );   

// Edit existing taxonomy
function extra_edit_tax_fields_wpse_29322( $tag ) 
{
    // Check for existing taxonomy meta for term ID.
    $t_id = $tag->term_id;
    $term_meta = get_option( "taxonomy_$t_id" ); 
    ?>
    <tr class="form-field">
    <th scope="row" valign="top">
        <label for="cat_Image_url"><?php _e( 'Category Navigation Image URL' ); ?></label>
    </th>
        <td>
            <input type="text" name="term_meta[img]" id="term_meta[img]" value="<?php echo esc_attr( $term_meta['img'] ) ? esc_attr( $term_meta['img'] ) : ''; ?>">
            <p class="description"><?php _e( 'Enter the full URL to the navigation image used for this category.' ); ?></p>
        </td>
    </tr>
    <?php
}

// Add taxonomy page
function extra_add_tax_fields_wpse_29322( $tag ) 
{
    ?>
    <div class="form-field">
        <label for="cat_Image_url"><?php _e( 'Category Navigation Image URL' ); ?></label>
        <input type="text" name="term_meta[img]" id="term_meta[img]" value="">
        <p class="description"><?php _e( 'Enter the full URL to the navigation image used for this category.' ); ?></p>
    </div>
    <?php
}

// Save extra taxonomy fields callback function.
function save_extra_taxonomy_fields_wpse_29322( $term_id ) 
{
    if ( isset( $_POST['term_meta'] ) ) 
    {
        $t_id = $term_id;
        $term_meta = get_option( "taxonomy_$t_id" );
        $cat_keys = array_keys( $_POST['term_meta'] );
        foreach ( $cat_keys as $key ) 
        {
            if ( isset ( $_POST['term_meta'][$key] ) )
                $term_meta[$key] = $_POST['term_meta'][$key];
        }
        // Save the option array.
        update_option( "taxonomy_$t_id", $term_meta );
    }
} 
```

# android - 如何在谷歌地图 API V2 中获取从当前位置到纬度目的地的英里/公里和分钟

> ID：14446400
> 
> 赞同：1
> 
> 时间：2013-01-21T20:10:34.597
> 
> 标签：android, google-maps

如何在谷歌地图 API V2 中获取从当前位置到纬度/经度目的地的英里/公里和减号。如果我得到这个值，我想存储在 textview 中。

我的代码是：

```
import android.os.Bundle;

import com.actionbarsherlock.app.SherlockActivity;

import com.google.android.gms.maps.CameraUpdateFactory;
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.MapFragment;
import com.google.android.gms.maps.model.LatLng;
import com.google.android.gms.maps.model.MarkerOptions;

public class DetailMapActivity extends SherlockActivity {
    private GoogleMap map;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main_detail_map);

        map = ((MapFragment) getFragmentManager().findFragmentById(R.id.map))
                .getMap();
        map.setMyLocationEnabled(true);

        LatLng LOC_DESTINATION = new LatLng(-6.33438, 106.74316);

        map.addMarker(new MarkerOptions().position(LOC_DESTINATION)
                .title("Destination Title").snippet("Destination Description"));

        map.moveCamera(CameraUpdateFactory.newLatLngZoom(LOC_DESTINATION, 40));

        map.animateCamera(CameraUpdateFactory.zoomTo(10), 2000, null);

        String miles = "what this code?";
        Log.d("HaichalMap", miles);
    }
} 
```

感谢您的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:33:44.997

`Location`使用类试试这个

```
Location locationA = new Location("Location A");
locationA.setLatitude(lat_a);
locationA.setLongitude(lon_a);

Location locationB = new Location("Location B");
locationB.setLatitude(lat_b);
locationB.setLongitude(lon_b);

int metres = Math.round(locationA.distanceTo(locationB)); // Returns in Metres 
```

将仪表转换为所需的输出

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:18:19.510

谷歌地图不提供路线。您需要查看[Google Directions API](https://developers.google.com/maps/documentation/directions/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:27:44.517

您需要根据旧坐标和新坐标（纬度和经度）计算距离。这将以米为单位返回结果。然后，您需要将其转换为英里/公里。就计算与初始坐标和最终坐标的距离而言，[此](https://stackoverflow.com/questions/120283/working-with-latitude-longitude-values-in-java)线程可能对您有所帮助。希望能回答你的问题。

# php - 使用 PHP 创建 PDF 并插入数据

> ID：14446401
> 
> 赞同：0
> 
> 时间：2013-01-21T20:10:41.260
> 
> 标签：php, pdf, pdf-generation

我意识到这里和其他地方也有人问过类似的问题，但我很难找到与我正在尝试做的事情相关的信息，这些信息是在过去 5-10 年内写的，因此非常感谢任何帮助。

我想做的是有一个 html 表单，当填写并提交时会生成一个 PDF，它是 3.5" x 2" @ 300dpi，四面都有 0.125" 出血。表单将是简单的文本条目：姓名、电子邮件、等，它会将它们放在这个预制的 3.5" x 2" PDF 文件（带有背景图像等的各种模板）上，然后保存一个添加了文本条目的新文件。PDF 也可以在创建后通过电子邮件发送。

什么样的库最适合在 PHP 5.2 中完成这样的事情？我是否需要先创建文档的 html/css 布局，然后将其转换为 PDF？我觉得这里有点失落。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:20:11.477

试试fpdf (free pdf) [http://www.fpdf.org/](http://www.fpdf.org/)可以使用fpdf的方法将内容插入到pdf中，可以确定文档的大小和边框（不知道能不能具体指定bleed） . 我用它在商业地产网站上制作房产手册和海报，效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T05:43:22.847

看看下面的代码示例。

[http://www.tcpdf.org/examples.php](http://www.tcpdf.org/examples.php)

[http://html2pdf.fr/en/example](http://html2pdf.fr/en/example)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T20:16:29.797

从阅读[本教程](http://www.phpjabbers.com/create-pdf-file-with-php-php36.html)开始。它解释了如何使用名为[PDFLib](http://www.pdflib.com/)的 PHP 库创建 PDF 文件。它绝对不复杂......如果事实上设置它比使用它更难：P

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T20:26:00.250

您可以使用 TableTool，如您在此处看到的：

[http://datatables.net/extras/tabletools/](http://datatables.net/extras/tabletools/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-22T00:28:38.827

[Prince](http://www.princexml.com)支持用于控制页面出血和修剪的 CSS 属性，并已被多个客户用于打印名片和类似对象。

# excel - 如何获得具有不同位置的两个不同单元格的百分比

> ID：14446407
> 
> 赞同：1
> 
> 时间：2013-01-21T20:11:16.847
> 
> 标签：excel, excel-formula

在列`E`中，我想显示`E3`百分比，`D3/B9`因为：

1.  它应该找到`C3(CA)`from 列`A(A9)`，并且
2.  然后将 C3 值（D3）除以 A9 值（B9）。

所以，

*   E3 为 0.15(D3/B9)
*   E4 为 0.09(D4/B10)
*   E5 为 0.11(D5/B11)

样本数据：

```
1   A           B           C               D           E   Total      Rejected %
2               
3   TX              1       CA              34  
4   Austin          1       Los Angeles     1
5   CPE             3       Beverly Hills   7
6   CPE-E2E         3       Calabasas       2
7   WA              1       Culver City     14
8   Seattle         1       El Segundo      1
9   CA              221     Fremont         1
10  Los Angeles     11      FL              39
11  Beverly Hills   63      Tempa           1
12  Calabasas       10      Orlando         1
13  Culver City     58      Miami           5
14  El Segundo      5       Jacksonville    7
15  Fremont         7       Grand Total     73
16  FL              171
17  Tempa           2
18  Orlando         2
19  Miami           20
20  Tallahassee     10
21  Daytona Beach   8
22  Jacksonville    26
23  Grand Total     409 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:26:03.840

你应该调查一下`VLOOKUP`。它应该可以帮助你。

[http://office.microsoft.com/en-us/excel-help/vlookup-HP005209335.aspx](http://office.microsoft.com/en-us/excel-help/vlookup-HP005209335.aspx)

## 更新

两件事情...

1.  我认为你不需要`SUMPRODUCT()`在这里......它没有为你做任何事情。

2.  放入`=(D3)/(VLOOKUP(C3,$A$1:$D$100,2,FALSE)`单元格`E3`，然后抓住单元格右下角的方块并向下`E3`拖动到要计算百分比的最后一个单元格。每个单元格中的公式将自动更新以引用正确的单元格。

    注意`$`内部`VLOOKUP`。这些告诉函数始终使用这些单元格而不是自动更新引用。

# html - 跨多个内联元素扩展底部边框

> ID：14446408
> 
> 赞同：0
> 
> 时间：2013-01-21T20:11:21.303
> 
> 标签：html, css

我有一种情况，我有一个标题和一些内联的单选按钮，它们控制下面显示的内容。出于样式原因，我希望标题的底部边框通过以下元素延伸到其容器的边缘。

我现在的情况：

```
<h2 class="header">this is the header</h2>

<label class="l" for="a">this is a label</label>
<input value="a" name="options" type="radio"/>

<label class="l" for="b">this is another label</label>
<input type="radio" name="options" value="b"/> 
```

CSS：

```
label.l{
    display: inline-block;
    margin: 4px;
    color: red;
}

h2.header {
    border-bottom: 1px solid blue;
    display: inline;
    margin: 4px;
    font-size: 200%;
} 
```

结果：http: [//jsfiddle.net/F7pzd/1/](http://jsfiddle.net/F7pzd/1/)

有没有办法让底部边框一直延伸到整个页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:16:38.047

你不能在你的 h1 和选项周围添加一个容器元素吗？

例如：

```
<div class="border-bottom">
...
</div>

div.border-bottom{
border-bottom: 1px solid blue;   
} 
```

[http://jsfiddle.net/TB8dK/1/](http://jsfiddle.net/TB8dK/1/)

**或者**

您可以`display: inline-block;`为所有元素使用并设置静态高度。 [http://jsfiddle.net/yLUC7/5/](http://jsfiddle.net/yLUC7/5/)

（注意使用 'line-height' 垂直对齐标签中的文本）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:17:01.667

首先，您必须将所有元素包装在 div 或另一个标签中，这取决于您想要放置元素的位置。在我的示例中，我使用了`<header>`标签。还建议放在`<input>`里面`<label>`，因为它是用户友好的，他们也可以点击文本来检查它。

[你可以在这里](http://jsfiddle.net/stefanz/F7pzd/6/)看到我的修改

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T20:14:53.110

只需使用一个`div`元素来包装所有内容。这是[一个例子](http://jsfiddle.net/F7pzd/5/)。

请注意，通过使用 wrapping `div`，您可以摆脱以前使用的所有类。另外，请注意元素的`for`属性`label`需要相应的 ID。

我已经在上面链接的小提琴示例中解决了所有这些问题。

# python - Z3：查找变量的所有可能值

> ID：14446413
> 
> 赞同：1
> 
> 时间：2013-01-21T20:11:34.093
> 
> 标签：python, z3

我尝试获取有限域变量的所有可能值（例如 Bool 和 Enumerated 类型），但不确定在 Z3 中这样做的正确方法是什么。我已经写了类似下面的内容，但想知道在 Z3 中是否有更好的方法。另外，有没有办法确定变量是否具有有限域或无限域？

在下文中，vsort 是变量的排序值（例如`Int('x').sort()`）

```
if vsort.kind() == Z3_BOOL_SORT:
    return [BoolVal(True), BoolVal(False)]
elif vsort.kind()  == Z3_DATATYPE_SORT:
    return [vsort.constructor(i)()
            for i in range(vsort.num_constructors())]
else:
    raise AssertionError('dont know how to deal with this sort') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T22:23:18.550

你是在正确的方向。但是，代码缺少两个重要的情况：位向量和非枚举类型的有限数据类型（例如，一对有限类型）。这是考虑这两种额外情况的代码。该函数`universe(s)`返回排序宇宙中的元素`s`。

顺便说一句，一个可能的改进是使用迭代器而不是列表。因此，我们甚至可以支持无限排序，例如整数和递归数据类型（例如，列表），并按需生成元素。

```
from z3 import *
import itertools

def universe(vsort):
    found = set()
    def rec(vsort):
        id = Z3_get_ast_id(vsort.ctx_ref(), vsort.as_ast())
        if id in found:
            raise AssertionError('recursive sorts are not supported')
        found.add(id)
        ctx = vsort.ctx
        if vsort.kind() == Z3_BOOL_SORT:
            return [ BoolVal(False, ctx), BoolVal(True, ctx) ]
        elif vsort.kind() == Z3_BV_SORT:
            sz = vsort.size()
            return [ BitVecVal(i, vsort) for i in range(2**sz) ]
        elif vsort.kind()  == Z3_DATATYPE_SORT:
            r = []
            for i in range(vsort.num_constructors()):
                c = vsort.constructor(i)
                if c.arity() == 0:
                    r.append(c())
                else:
                    domain_universe = []
                    for j in range(c.arity()):
                        domain_universe.append(rec(c.domain(j)))
                    r = r + [ c(*args) for args in itertools.product(*domain_universe) ]
            return r
        else:
            raise AssertionError('dont know how to deal with this sort')
    return rec(vsort) 
```

这里有些例子：

```
print universe(BoolSort())
>> [False, True]
print universe(BitVecSort(4))
>> [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
S, elems = EnumSort('S', ['a', 'b', 'c', 'd'])
print universe(S)
>> [a, b, c, d]

# Create a Pair (Bool, S)
d = Datatype('Pair')
d.declare('mkpair', ('bval', BoolSort()), ('sval', S))
D = d.create()
print universe(D)
>> [mkpair(False, a), mkpair(False, b), mkpair(False, c), mkpair(False, d), mkpair(True, a), mkpair(True, b), mkpair(True, c), mkpair(True, d)]

# Create a Choice sort where each element is a Pair or a BitVector of size 4.
c = Datatype('Choice')
c.declare('aspair', ('pval', D))
c.declare('asbv', ('bval', BitVecSort(4)))
C = c.create()
print universe(C)
>> [aspair(mkpair(False, a)), aspair(mkpair(False, b)), aspair(mkpair(False, c)), aspair(mkpair(False, d)), aspair(mkpair(True, a)), aspair(mkpair(True, b)), aspair(mkpair(True, c)), aspair(mkpair(True, d)), asbv(0), asbv(1), asbv(2), asbv(3), asbv(4), asbv(5), asbv(6), asbv(7), asbv(8), asbv(9), asbv(10), asbv(11), asbv(12), asbv(13), asbv(14), asbv(15)]

l = Datatype('List')
l.declare('cons', ('car', BoolSort()), ('cdr', l))
l.declare('nil')
List = l.create()
print universe(List)
>> Traceback (most recent call last):
>> ...
>> AssertionError: recursive sorts are not supported 
```

# performance - 为什么我的 WP8 (C#/XAML) 应用程序永远保持“正在加载..”？

> ID：14446415
> 
> 赞同：1
> 
> 时间：2013-01-21T20:11:42.253
> 
> 标签：performance, debugging, windows-phone-8, visual-studio-debugging, windows-phone-8-emulator

我应该查看或逐步了解为什么我的 WP8 应用程序会显示“正在加载...”，直到众所周知的奶牛回家（实际上可能更长）。我让它以这种方式运行了几个小时（当我在做其他事情时）。只是为了确保它没有因为某种原因而没有进入某个断点，我删除了所有断点，它仍然会发生。

## 更新

“从默认模板创建应用程序并将 App.xaml.cs 构造函数与您的构造函数进行比较。”

两个 App.xaml.cs 构造函数之间的唯一区别是：

```
Application.Current.Host.Settings.EnableFrameRateCounter = true; // new app
Current.Host.Settings.EnableFrameRateCounter = false; // existing (not working) app 
```

...但是将现有的应用程序改回上面的空白应用程序并没有什么区别。

我没有创建新页面，而是将 WMAppManifest.xml 设置为使用另一个页面（MainPage 除外）作为导航到的页面。不过，它仍然永远在做“加载...”业务。它通过 NavigatedTo() 事件，但随后挂起......

新的“主”页面的构造函数很简单：

```
 InitializeComponent(); 
```

在主页面中，它是：

```
 InitializeComponent();
    Window.Current.SizeChanged += ViewStateChanged; 
```

## 更新 2

今天有几次我得到“*与 bla.bla.bla.bla 的网络连接已丢失。调试将中止。* ”这不会是这些问题的原因，对吗？

它最后一次发生（就在现在）是在模拟器通过“加载中......”错误承诺旋转了几亿次之后关闭模拟器（不确定的进度环逐渐滚动......）

## 更新 3

与 Windows 应用商店应用不同，从 App.xaml.cs 导航到的页面没有明确指定。我假设这在 WMAppManifest.xml 中：

`<DefaultTask Name="_default" NavigationPage="MainPage.xaml"`>

...足以导航/从 MainPage 开始？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:52:26.327

从 Application_Launching 事件处理程序中注释掉代码，以确保没有任何东西导致应用程序挂在那里。

从默认模板创建应用程序并将 App.xaml.cs 构造函数与您的构造函数进行比较。确保不会错过初始化步骤。这就是设置根框架并导航到起始页的代码所在的位置。最后，创建一个新的空白页并将其设置为 WMAppManifest.xml 中的起始页。如果该导航有效，则问题出在主页的构造函数或 OnNavigatedTo 方法中。

# c# - 如何使用 RavenDB 中的 eval 功能将项目添加到数组中？

> ID：14446430
> 
> 赞同：2
> 
> 时间：2013-01-21T20:13:06.433
> 
> 标签：c#, push, eval, ravendb, patch

考虑以下数据库文档：

![在此处输入图像描述](../Images/a731434bb41139a13afaf9546f2e716e.png)

我需要将一个元素推送到数组突出显示的字段“角色”。

我已经尝试了下面的代码，但没有成功。我需要知道使用哪个命令代替“SelectWhere”...

```
patches.Add(new ScriptedPatchCommandData
                {
                    Key = "Users/" + (mp.EnableChangeUserName ? user.ProviderUserKey : username),
                    Patch = new ScriptedPatchRequest
                    {
                        Script = @"
                                var app = this.Applications.SelectWhere(function(application){ 
                                    return application.Key == appKey;
                                });
                                if(app != null) { app.Roles.PushAll(roles) }",
                        Values = { { "appKey", mp.ApplicationKey }, {"roles", roleNames} }
                    }
                }); 
```

建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T17:38:13.820

这应该可以解决问题：

```
for (var i = 0; i < this.Applications.length; i++)
{
  var app = this.Applications[i];
  if (app.Key == appKey)
  {
    app.Roles = app.Roles.concat(roles);
  }
} 
```

在 Raven Management Studio 中进行测试时，您似乎无法在“参数”窗口中表示数组，因此我不得不将其作为字符串输入`["foo","bar"]`并对脚本稍作更改：

```
...   .concat(eval(roles)) 
```

# ios - 减少 iPhone 应用程序的内存使用量

> ID：14446432
> 
> 赞同：3
> 
> 时间：2013-01-21T20:13:10.183
> 
> 标签：ios, objective-c, xcode, interface-builder, instruments

我们正在为 iPhone 制作游戏。我们已经完成了开发并尝试优化游戏的内存。我们注意到，当我们在游戏中加载特定的 MVC 并关闭它时，并非所有分配的内存都被释放。（增加了约 4-5MB）。如果您继续玩 15-20 分钟，这会导致游戏的内存使用率非常高，并且游戏最终会在发出低内存警告后崩溃。

**这就是我绑定**
的 1\. 在游戏上运行静态分析器并修复所有内存泄漏和警告。
2\. 手动检查所有类的dealloc是否被调用。这似乎很好。
3\. 还尝试在 Xcode 中运行 Allocations 工具，但其中的大多数条目是 CFStrings、mallocs 和 CFNumbers 等，但并没有真正说明它们来自我的哪个类。有没有更好的方法来使用分配工具？

**我还有一些与内存相关的问题**
1\. 我们在游戏中的许多地方都使用了自动释放对象，而没有使用自动释放池。我的理解是自动释放的对象应该在下一个运行循环中释放并且不应该造成这么大的问题？
2\. 另外，如果我通过 xib 文件加载图像，它们是否会被 iOS 缓存。他们也会占用内存吗？

我该如何解决我的内存使用问题。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T20:30:00.127

几个想法：

1.  你在使用核心基础课程吗？确保对于您使用`Create`或`Copy`以您调用的名称`CFRelease`（或转移所有权，然后`release`或`autorelease`Objective-C 对象）调用 Core Foundation 的每个对象。

2.  您是否也使用过 Instruments 中的 Leaks 工具？我想是的，但你没有提到它。请参阅*Instruments 用户指南*中的在您的应用程序中[查找泄漏。](http://developer.apple.com/library/ios/documentation/developertools/Conceptual/InstrumentsUserGuide/MemoryManagementforYouriOSApp/MemoryManagementforYouriOSApp.html#//apple_ref/doc/uid/TP40004652-CH11-SW4)

**   你是通过加载图像`imageNamed`吗？这会缓存图像并且不利于释放它们。手动使用`imageWithContentsOfFile`和管理缓存更安全。

    *   我假设您的视图控制器`dealloc`正在被调用，并且您正在释放与类属性/ivars 关联的所有对象？

    *   你有没有打开僵尸？这对于诊断目的非常有用，但在关闭僵尸之前您不会释放内存。* 

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:28:33.967

如果您“正在”制作某些东西，则应该使用[ARC（自动引用计数）](http://clang.llvm.org/docs/AutomaticReferenceCounting.html)。一旦您全部转换为 ARC，您将不再需要那些自动释放对象，编译器将在适当的时间释放对象。如果您发现对象池仍在失控的情况下，您可以使用[`@autoreleasepool`](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmAutoreleasePools.html)声明式创建自己的自动释放池。

我认为切换到 ARC 将帮助您，并使您的进一步开发变得更加简单。转换为 ARC 后，在 Instruments 中再次分析您的应用程序，并缩小创建大型对象池的任何违规代码。

如果您选择不转换为 ARC，根据您的解释，听起来您可以使用您所指的视图进行保留周期。通过追踪它保留的每个地方，确保该视图实际上正在被释放。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T22:25:18.883

Rob 和 Chris 所说的，然后执行此操作：

使用配置为仅跟踪活动分配和记录引用计数的分配工具。

在 Allocations 收集数据时使用您的应用程序，然后暂停您的应用程序。

暂停时，按 Live Bytes 和# Living 排序是您最有用的视图。对于利用 Foundation 集合类的以数据为中心的应用程序，*String、*Dictionary 和 *Array 的某种组合可能是最常见的。

那没问题。如果单击查看其中任何一个的详细信息，您将获得当前内存中所有实例的长列表。你可以`po <addr>`看看他们中的任何一个是什么。您还可以滚动查看列表以查看哪些函数最常负责分配。同样，您可以单击任何实例以查看它的分配位置和/或它可能仍然存在的原因。

同样，您可以从概览表开始，按#Living 排序，然后向下滚动到某个类的第一个实例。如果该类植根 - 持有 - 大量数据，那么消除或优化这是一个很好的开始。

当然，不要忘记[heapshot 分析](http://www.friday.com/bbum/2010/10/17/when-is-a-leak-not-a-leak-using-heapshot-analysis-to-find-undesirable-memory-growth/)是一种非常有效的内存增长世代分析工具。*

# javascript - xml 没有提供正确的节点

> ID：14446433
> 
> 赞同：-1
> 
> 时间：2013-01-21T20:13:18.023
> 
> 标签：javascript, xml, formatting, nodes

您好，提前致谢。

几天来，我一直在加载 XML 数据并解析为 assoc 数组的问题。我最终决定将 XML 配置数据直接嵌入到启动 HTML5 文档的标题中。

下面我已经包含了整个文件。当通过 parseFromString() 加载数据时，我得到了一些节点，但我得到了来自其他节点的解析错误，而有些甚至没有出现。我已经搞砸了好几天，我不明白为什么会出现解析错误。

```
<!-- I2TM Game Engine [Developer] -->
<!DOCTYPE HTML>
<html lang="en">
<head> 
    <title>I2TM: Example Template</title> 
    <meta name="viewport" content="width=device-width, minimum-scale=1.0,  maximum-scale=1.0"> 
    <meta name="apple-mobile-web-app-capable" content="yes"/> 
    <link href="css/default.css" rel="stylesheet" type="text/css" /> 
    <script id="resources" type="text/xmldata">
    <resources name="Template" version="0.1" publisher="I2TM Software" copyright="2012-2013">
        <credits>
            <credit id="0" name="Andrew Donelson" url="http://www.i2tmsoftware.com" desc="Author" />
            <credit id="1" name="Playcraft Labs" url="http://www.playcraftlabs.com" desc="I2TM Engine forked from PlaycraftJS v0.5.6" />
            <credit id="2" name="SoundManager2" url="http://www.schillmania.com/projects/soundmanager2/" desc="Used in I2TM Engine as primary Sound API" />
            <credit id="3" name="James Padolsey" url="https://github.com/padolsey/string/blob/master/string.js" desc="Used in I2TM Engine extended String API" />
            <credit id="4" name="Alexandru Marasteanu" url="http://www.diveintojavascript.com/projects/javascript-sprintf" desc="Used in I2TM Engine to add sprintf capability" />
        </credits>
        <languages>
            <language name="english" from="english" to="english" />
            <language name="spanish" from="english" to="spanish" />
            <language name="german" from="english" to="german" />
        </languages>
        <sounds>
            <sound name="i2tm" ogg="true" mp3="true" channels="1" file="sounds/i2tm" />
        </sounds>
        <images>
            <image name="publisher" file="images/publisher.png" />
            <image name="touchpad" file="images/touchpad_buttons.png" />                
            <image name="title" file="images/title.png" />  
            <image name="starport" file="images/starport.png" />    
        </images>
    </resources>
    </script>
    <!--[if lt IE 9]> 
        <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script> 
    <![endif]--> 
</head> 
<body>
    <script type="text/javascript" src="../playcraftengine/playcraftjs/lib/playcraft.js"></script>
    <!-- Engine creates game elements and restores upon friendly exit. -->
    <div id="pcGameDiv">
        <div>
        <!-- Development -->
        <a class="caption" href="javascript:pc.start('js/', ['game.main.js','touch.main.js','game.resources.js','factory.entity.js','factory.sound.js','scene.publisher.js','scene.mainmenu.js','scene.touchpad.js','scene.game.js','system.touchpad.js'],'../playcraftengine/playcraftjs/lib/');">Play Now</a>
        <!-- Production
        <a class="caption" href="javascript:pc.start('js/', ['game.min.js']);">Play Now</a>
         -->
        </div>
        <div><strong>Game Title</strong><p>replaces this text with the description of your game here</p></div>
        <div><strong>Help</strong><p>Replace this with how to play or other helpful information</p></div>
    </div>
</body>
</html> 
```

[用于获取和解析的代码]

```
 loadResources:function()
    {
        function xml_to_array(xml,tag)
        {
            var data = xml.getElementsByTagName(tag);
            var res = {};
            if (data) 
            {
                for (i=0;i<data.length;++i) 
                {
                    var root = data[i].nodeName;
                    res[root] = new Array();
                    for (n=0;n<data[i].childNodes.length;++n)
                    {
                        if (data[i].childNodes[n].nodeName != "#text") 
                        {
                            var node = data[i].childNodes[n].nodeName;
                            var attr = data[i].attributes;
                            for (a=0;a<attr.length;++a) 
                            {
                                var field = attr[a].nodeName;
                                var value = attr[a].nodeValue;                          
                                res[root][node][field]=value;
                            }
                        }
                    }                       
                }
            }
            return res;
        } //end xml_to_array()

        var xml = this.parseXML(document.getElementById('resources').innerHTML);

                    //look at the value of xml in your favorite debugger...that is the problem.
                    //nodes are missing, parse errors, ect.

                    //following code is work in progress and does not work completely until i get the XML data right.
        this.resources = new Array();
        this.resources['game'] = xml_to_array(xml,'game');  
        this.resources['credits'] = xml_to_array(xml,'credits');    
        this.resources['strings'] = xml_to_array(xml,'string'); 
        this.resources['sounds'] = xml_to_array(xml,'sound');   
        this.resources['images'] = xml_to_array(xml,'image');   
    },

    /**
     * Parses XML and returns an XMLDoc
     */
    parseXML:function (xml)
    {           
        if (window.DOMParser)
        {
            // standard
            if (!this.xmlParser)
                this.xmlParser = new DOMParser();
            try {
                return this.xmlParser.parseFromString(xml, "text/xml")
            } catch(e) {
                this.error('DOH! error loading '+xml+'.');
            }
        } else // ie
        {
            var xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
            xmlDoc.async=false;
            return xmlDoc.loadXML(xml)
        }
    } //end parseXML()
}); 
```

我会很感激你们能提供的任何帮助。我希望以这种方式定义的 XML...对于开发人员来说，它可以更快、更简单地基本上将每个资源定义在一行上，并使用属性而不是具有多个键的部分。如果每个都作为 NAME 属性，这样做应该没有问题。其他属性被系统忽略，具体使用！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:31:26.153

您的 XML 无效，错误消息应该指出您正确的问题：

```
desc="Author & Publisher" 
```

看到未转义的 & 符号了吗？应该是`Author &amp; Publisher`。

作为记录，这是我从`parseFromString`webkit 上获得的（序列化）输出，它直接指向问题（第 4 行第 37 列--xmlParseEntityRef）：

```
<resources name="Template" version="0.1" publisher="I2TM Software" copyright="2012-2013">
  <parsererror xmlns="http://www.w3.org/1999/xhtml" style="display: block; white-space: pre; border: 2px solid #c77; padding: 0 1em 0 1em; margin: 1em; background-color: #fdd; color: black">
      <h3>This page contains the following errors:</h3>
      <div style="font-family:monospace;font-size:12px">error on line 4 at column 37: xmlParseEntityRef: no name</div>
      <h3>Below is a rendering of the page up to the first error.</h3>
  </parsererror>
  <credits></credits>
</resources> 
```

# c# - 通过单击行上的任意位置使 GridView 行可选择

> ID：14446443
> 
> 赞同：1
> 
> 时间：2013-01-21T20:13:57.553
> 
> 标签：c#, winforms, datagrid

我需要通过单击行上的任意位置来选择 GridView 行。怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:31:00.313

如果您从工具栏手动添加了网格，您可以将其`Selection Mode`属性更改为`FullRowSelect`。如果您以编程方式添加它，您可以使用

`Grid.SelectionMode = DataGridViewSelectionMode.FullRowSelect`.

`Grid.Rows[Grid.CurrentRow.Index].Cells["nameofcolumn"].Value.ToString()`

*   前提是您的 DataGridView 称为“网格”。这将显示特定单元格的内容。

# c# - Ionic.Zip 抛出意外和奇怪的错误

> ID：14446446
> 
> 赞同：3
> 
> 时间：2013-01-21T20:14:04.573
> 
> 标签：c#, extract, dotnetzip

我想在我的项目中实现 Ionic.Zip.dll 库。我设法让它工作，但是当我给他生成档案的选项时，它突然抛出以下错误：

```
Ionic.Zip.SfxGenerationException was unhandled
Message=Errors compiling the extraction logic! 
```

有谁知道为什么会这样？这是我的代码片段，我相信这是原因，但显然我找不到任何错误。

```
TextWriter tw = new StreamWriter(Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments) + "\\temp.vbs");

// write a line of text to the file
tw.WriteLine(text);

// close the stream
tw.Close();
ZipFile zip = new ZipFile();
zip.AddFile(Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments) + "\\temp.vbs", "");
zip.Comment = "blabla";
SelfExtractorSaveOptions options = new SelfExtractorSaveOptions();
if (textBox1.Text != "") zip.Comment = zip.Comment + "\n\n" + "blabla: " + textBox1.Text;
if (textBox2.Text != "") zip.Comment = zip.Comment + "\nblabla: " + textBox2.Text;
if (textBox3.Text != "") options.IconFile = textBox3.Text;
options.Flavor = SelfExtractorFlavor.ConsoleApplication;
options.Quiet = true;
options.DefaultExtractDirectory = "%APPDATA%\\SomeFolder";
options.PostExtractCommandLine = "temp.vbs";
options.RemoveUnpackedFilesAfterExecute = true;
zip.SaveSelfExtractor(textBox4.Text, options);
System.Diagnostics.Process.Start(textBox4.Text);
this.Close(); 
```

感谢您期待您的帮助！

PS Ionic.Zip 可以在这里找到：http: [//dotnetzip.codeplex.com/](http://dotnetzip.codeplex.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-05-30T14:00:46.297

我收到了这个错误，并在我期待 .exe 文件的位置生成了一个奇怪的 .cs 文件（异常中还添加了该文件的路径）。我用文本编辑器打开了这个文件（DotNetZip-2018May30-150547-7b57e3d0-9c8e-402a-9da8-bda23ee8100c.cs），最后是一个错误。

对我来说这是一个权限问题，请确保它可以创建 exe 文件。

我的工作是创建一个 zip 但不是一个 exe

# javascript - 如何读取本地文本文件？

> ID：14446447
> 
> 赞同：472
> 
> 时间：2013-01-21T20:14:10.597
> 
> 标签：javascript, file-io, xmlhttprequest

我正在尝试通过创建一个函数来编写一个简单的文本文件阅读器，该函数接受文件的路径并将每一行文本转换为一个字符数组，但它不起作用。

```
function readTextFile() {
  var rawFile = new XMLHttpRequest();
  rawFile.open("GET", "testing.txt", true);
  rawFile.onreadystatechange = function() {
    if (rawFile.readyState === 4) {
      var allText = rawFile.responseText;
      document.getElementById("textSection").innerHTML = allText;
    }
  }
  rawFile.send();
} 
```

这里出了什么问题？

[在从以前的版本](https://stackoverflow.com/revisions/14446447/1)中稍微更改代码之后，这似乎仍然不起作用，现在它给了我一个`XMLHttpRequest`异常 101。

我已经在 Firefox 上对此进行了测试，它可以工作，但是在 Google Chrome 中它不起作用，并且它一直给我一个异常 101。我怎样才能让它不仅适用于 Firefox，而且适用于其他浏览器（尤其是 Chrome )?

* * *

## 回答 #1

> 赞同：373
> 
> 时间：2013-01-21T20:20:34.627

您需要检查状态 0（当使用 本地加载文件时`XMLHttpRequest`，您不会收到返回的状态，因为它不是来自 a `Webserver`）

```
function readTextFile(file)
{
    var rawFile = new XMLHttpRequest();
    rawFile.open("GET", file, false);
    rawFile.onreadystatechange = function ()
    {
        if(rawFile.readyState === 4)
        {
            if(rawFile.status === 200 || rawFile.status == 0)
            {
                var allText = rawFile.responseText;
                alert(allText);
            }
        }
    }
    rawFile.send(null);
} 
```

并`file://`在您的文件名中指定：

```
readTextFile("file:///C:/your/path/to/file.txt"); 
```

* * *

## 回答 #2

> 赞同：161
> 
> 时间：2017-09-09T09:42:23.633

在 javascript中引入[fetch api](https://fetch.spec.whatwg.org/)后，读取文件内容再简单不过了。

**读取文本文件**

```
fetch('file.txt')
  .then(response => response.text())
  .then(text => console.log(text))
  // outputs the content of the text file 
```

**读取一个 json 文件**

```
fetch('file.json')
  .then(response => response.json())
  .then(jsonResponse => console.log(jsonResponse))     
   // outputs a javascript object from the parsed json 
```

## 2018 年 7 月 30 日更新（免责声明）：

> 这种技术在**Firefox**中运行良好，但在编写此更新时**Chrome**的`fetch`实现似乎不支持URL 方案（在 Chrome 68 中测试）。`file:///`

## 更新 2（免责声明）：

> 出于与 Chrome 相同的（安全）原因，此技术不适用于 68 版（2019 年 7 月 9 日）以上的**Firefox**`CORS request not HTTP`：. 请参阅[https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSRequestNotHttp](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSRequestNotHttp)。

* * *

## 回答 #3

> 赞同：122
> 
> 时间：2015-03-20T21:30:38.287

访问[Javascripture](http://www.javascripture.com/FileReader)！并转到**readAsText**部分并尝试该示例。您将能够知道**FileReader的****readAsText**函数是如何工作的。

 **```
 <html>
    <head>
    <script>
      var openFile = function(event) {
        var input = event.target;

        var reader = new FileReader();
        reader.onload = function(){
          var text = reader.result;
          var node = document.getElementById('output');
          node.innerText = text;
          console.log(reader.result.substring(0, 200));
        };
        reader.readAsText(input.files[0]);
      };
    </script>
    </head>
    <body>
    <input type='file' accept='text/plain' onchange='openFile(event)'><br>
    <div id='output'>
    ...
    </div>
    </body>
    </html> 
```

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2017-08-22T10:46:37.463

```
var input = document.getElementById("myFile");
var output = document.getElementById("output");

input.addEventListener("change", function () {
  if (this.files && this.files[0]) {
    var myFile = this.files[0];
    var reader = new FileReader();

    reader.addEventListener('load', function (e) {
      output.textContent = e.target.result;
    });

    reader.readAsBinaryString(myFile);
  }   
});
```

```
<input type="file" id="myFile">
<hr>
<textarea style="width:500px;height: 400px" id="output"></textarea>
```

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2016-01-29T03:31:48.963

是的，JS 可以读取本地文件（参见 FileReader()），但不能自动读取：用户必须使用 html 将文件或文件列表传递给脚本`<input type="file">`。

然后使用 JS 可以处理（示例视图）文件或文件列表、它们的一些属性以及文件或文件内容。

出于安全原因，JS 不能做的是自动（无需用户输入）访问他计算机的文件系统。

要让 JS 自动访问本地 fs，需要创建的不是其中包含 JS 的 html 文件，而是一个 hta 文档。

hta 文件中可以包含 JS 或 VBS。

但是 hta 可执行文件只能在 Windows 系统上运行。

这是标准的浏览器行为。

Google Chrome 也在 fs API 工作，更多信息在这里：[http ://www.html5rocks.com/en/tutorials/file/filesystem/](http://www.html5rocks.com/en/tutorials/file/filesystem/)

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2020-01-18T20:06:32.153

## 现代解决方案：

使用`fileOrBlob.text()`如下：

```
<input type="file" onchange="this.files[0].text().then(t => console.log(t))"> 
```

当用户通过该输入上传文本文件时，它将被记录到控制台。[这是一个有效的 jsbin 演示](https://jsbin.com/bobeweyede/edit?html,output)。

这是一个更详细的版本：

```
<input type="file" onchange="loadFile(this.files[0])">
<script>
  async function loadFile(file) {
    let text = await file.text();
    console.log(text);
  }
</script> 
```

目前（2020 年 1 月）这仅适用于 Chrome 和 Firefox，如果您将来阅读此内容，请在此处查看兼容性：[https ://developer.mozilla.org/en-US/docs/Web/API/Blob/text](https://developer.mozilla.org/en-US/docs/Web/API/Blob/text)

在较旧的浏览器上，这应该可以工作：

```
<input type="file" onchange="loadFile(this.files[0])">
<script>
  async function loadFile(file) {
    let text = await (new Response(file)).text();
    console.log(text);
  }
</script> 
```

* * *

相关：截至 2020 年 9 月，Chrome 和 Edge 中提供了新的本[机文件系统 API](https://web.dev/native-file-system/)，以防您希望对用户选择的文件进行永久读取访问（甚至写入访问）。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2019-01-08T13:15:36.103

使用[Fetch](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)和 async 函数

```
const logFileText = async file => {
    const response = await fetch(file)
    const text = await response.text()
    console.log(text)
}

logFileText('file.txt') 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2013-10-16T23:29:49.393

尝试创建两个函数：

```
function getData(){       //this will read file and send information to other function
       var xmlhttp;

       if (window.XMLHttpRequest) {
           xmlhttp = new XMLHttpRequest();               
       }           
       else {               
           xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");               
       }

       xmlhttp.onreadystatechange = function () {               
           if (xmlhttp.readyState == 4) {                   
             var lines = xmlhttp.responseText;    //*here we get all lines from text file*

             intoArray(lines);     *//here we call function with parameter "lines*"                   
           }               
       }

       xmlhttp.open("GET", "motsim1.txt", true);
       xmlhttp.send();    
}

function intoArray (lines) {
   // splitting all text data into array "\n" is splitting data from each new line
   //and saving each new line as each element*

   var lineArr = lines.split('\n'); 

   //just to check if it works output lineArr[index] as below
   document.write(lineArr[2]);         
   document.write(lineArr[3]);
} 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2013-11-26T12:17:57.240

可以证明你已经尝试过了，输入“false”如下：

```
 rawFile.open("GET", file, false); 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2015-02-19T15:35:07.340

其他示例-我的带有 FileReader 类的阅读器

```
<html>
    <head>
        <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.3/themes/smoothness/jquery-ui.css">
        <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="http://code.jquery.com/ui/1.11.3/jquery-ui.js"></script>
    </head>
    <body>
        <script>
            function PreviewText() {
            var oFReader = new FileReader();
            oFReader.readAsDataURL(document.getElementById("uploadText").files[0]);
            oFReader.onload = function (oFREvent) {
                document.getElementById("uploadTextValue").value = oFREvent.target.result; 
                document.getElementById("obj").data = oFREvent.target.result;
            };
        };
        jQuery(document).ready(function(){
            $('#viewSource').click(function ()
            {
                var text = $('#uploadTextValue').val();
                alert(text);
                //here ajax
            });
        });
        </script>
        <object width="100%" height="400" data="" id="obj"></object>
        <div>
            <input type="hidden" id="uploadTextValue" name="uploadTextValue" value="" />
            <input id="uploadText" style="width:120px" type="file" size="10"  onchange="PreviewText();" />
        </div>
        <a href="#" id="viewSource">Source file</a>
    </body>
</html> 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-11-18T15:20:44.283

这可能会有所帮助，

```
 var xmlhttp = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");

    xmlhttp.onreadystatechange = function () {
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            alert(xmlhttp.responseText);
        }
    }

    xmlhttp.open("GET", "sample.txt", true);
    xmlhttp.send(); 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-12-26T12:12:08.727

## 由于同源策略，不支持 Chrome 中的本地 AJAX 调用。

chrome 上的错误消息是这样的：“协议方案不支持跨源请求：http、data、chrome、chrome-extension、https。”

这意味着 chrome 会为每个域创建一个虚拟磁盘，以保存该域使用 http/https 协议提供的文件。对该虚拟磁盘之外的文件的任何访问都受到同源策略的限制。AJAX 请求和响应发生在 http/https 上，因此不适用于本地文件。

Firefox 没有这样的限制，因此您的代码可以在 Firefox 上正常运行。但是也有针对 chrome 的解决方法：[请参见此处](http://www.chrome-allow-file-access-from-file.com/)。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-12-31T19:50:50.363

除了上面的一些答案，这个修改后的解决方案对我有用。

```
<input id="file-upload-input" type="file" class="form-control" accept="*" /> 
```

……

```
let fileInput  = document.getElementById('file-upload-input');
let files = fileInput.files;

//Use createObjectURL, this should address any CORS issues.
let filePath = URL.createObjectURL(files[0]); 
```

……

```
function readTextFile(filePath){
    var rawFile = new XMLHttpRequest();
    rawFile.open("GET", filePath , true);
    rawFile.send(null);

    rawFile.onreadystatechange = function (){
        if(rawFile.readyState === 4){
            if(rawFile.status === 200 || rawFile.status == 0){
                var allText = rawFile.responseText;
                console.log(allText);
            }
        }
    }     
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-01-18T09:38:37.693

```
function readTextFile(file) {
    var rawFile = new XMLHttpRequest(); // XMLHttpRequest (often abbreviated as XHR) is a browser object accessible in JavaScript that provides data in XML, JSON, but also HTML format, or even a simple text using HTTP requests.
    rawFile.open("GET", file, false); // open with method GET the file with the link file ,  false (synchronous)
    rawFile.onreadystatechange = function ()
    {
        if(rawFile.readyState === 4) // readyState = 4: request finished and response is ready
        {
            if(rawFile.status === 200) // status 200: "OK"
            {
                var allText = rawFile.responseText; //  Returns the response data as a string
                console.log(allText); // display text on the console
            }
        }
    }
    rawFile.send(null); //Sends the request to the server Used for GET requests with param null
}

readTextFile("text.txt"); //<= Call function ===== don't need "file:///..." just the path 
```

**- 从 javascript 读取文件文本**
**- 使用 javascript 从文件中读取控制台日志文本**
**- 在我的情况下，Google chrome 和 mozilla firefox**

我有以下文件结构：[![在此处输入图像描述](../Images/8c70a8f5182cca31b3856788869d70ff.png)](https://i.stack.imgur.com/YgGBd.png)

console.log 结果：
[![在此处输入图像描述](../Images/bdbb05fd91889656eb12fc0e5a35f044.png)](https://i.stack.imgur.com/Jzu5j.png)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-02-22T07:41:25.290

```
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {            
                $.ajax({`enter code here`
                    url: "TextFile.txt",
                    dataType: "text",
                    success: function (data) {                 
                            var text = $('#newCheckText').val();
                            var str = data;
                            var str_array = str.split('\n');
                            for (var i = 0; i < str_array.length; i++) {
                                // Trim the excess whitespace.
                                str_array[i] = str_array[i].replace(/^\s*/, "").replace(/\s*$/, "");
                                // Add additional code here, such as:
                                alert(str_array[i]);
                                $('#checkboxes').append('<input type="checkbox"  class="checkBoxClass" /> ' + str_array[i] + '<br />');
                            }
                    }                   
                });
                $("#ckbCheckAll").click(function () {
                    $(".checkBoxClass").prop('checked', $(this).prop('checked'));
                });
        });
    </script>
</head>
<body>
    <div id="checkboxes">
        <input type="checkbox" id="ckbCheckAll" class="checkBoxClass"/> Select All<br />        
    </div>
</body>
</html> 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-04-26T05:20:11.653

在 js(data.js) 加载中获取本地文件数据：

```
function loadMyFile(){
    console.log("ut:"+unixTimeSec());
    loadScript("data.js?"+unixTimeSec(), loadParse);
}
function loadParse(){
    var mA_=mSdata.split("\n");
    console.log(mA_.length);
}
function loadScript(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";

    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" ||
                    script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }

    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
function hereDoc(f) {
  return f.toString().
      replace(/^[^\/]+\/\*![^\r\n]*[\r\n]*/, "").
      replace(/[\r\n][^\r\n]*\*\/[^\/]+$/, "");
}
function unixTimeSec(){
    return Math.round( (new Date()).getTime()/1000);
} 
```

data.js 文件，如：

```
var mSdata = hereDoc(function() {/*!
17,399
1237,399
BLAHBLAH
BLAHBLAH
155,82
194,376
*/}); 
```

动态 unixTime queryString 防止缓存。

AJ 在 web http:// 中工作。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-12-16T15:13:31.897

如果要提示用户选择文件，则读取其内容：

```
// read the contents of a file input
const readInputFile = (inputElement, callback) => {
  const reader = new FileReader();
  reader.onload = () => {
    callback(reader.result)
  };
  reader.readAsText(inputElement.files[0]);
};
// create a file input and destroy it after reading it
export const openFile = (callback) => {
  var el = document.createElement('input');
  el.setAttribute('type', 'file');
  el.style.display = 'none';
  document.body.appendChild(el);
  el.onchange = () => {readInputFile(el, (data) => {
    callback(data)
    document.body.removeChild(el);
  })}
  el.click();
} 
```

用法：

```
// prompt the user to select a file and read it
openFile(data => {
    console.log(data)
  }) 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-01-03T23:40:13.933

您可以导入我的库：

```
<script src="https://www.editeyusercontent.com/preview/1c_hhRGD3bhwOtWwfBD8QofW9rD3T1kbe/code.js?pe=yikuansun2015@gmail.com"></script>
```

然后，该函数`fetchfile(path)`将返回上传的文件

```
<script src="https://www.editeyusercontent.com/preview/1c_hhRGD3bhwOtWwfBD8QofW9rD3T1kbe/code.js"></script>
<script>console.log(fetchfile("file.txt"))</script>
```

请注意：在谷歌浏览器上，如果 HTML 代码是本地的，则会出现错误，但在线保存 HTML 代码和文件然后运行在线 HTML 文件是可行的。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-01-07T09:56:22.857

为了通过`JavaScript`使用 chrome 读取本地文件文本，chrome 浏览器应该使用`--allow-file-access-from-files`允许 JavaScript 访问本地文件的参数运行，然后您可以使用`XmlHttpRequest`如下方式读取它：

```
var xmlhttp = new XMLHttpRequest();
xmlhttp.onreadystatechange = function () {
   if (xmlhttp.readyState == 4) {
       var allText = xmlhttp.responseText;          
            }
        };
xmlhttp.open("GET", file, false);
xmlhttp.send(null); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-10-03T13:33:50.557

***如何读取本地文件？***

通过使用它，您将通过 loadText() 加载文件，然后 JS 将异步等待文件被读取并加载，之后它将执行 readText() 函数，允许您继续正常的 JS 逻辑（您也可以编写 try catch在出现任何错误的情况下阻塞 loadText() 函数），但对于这个示例，我将其保持在最低限度。

```
async function loadText(url) {
    text = await fetch(url);
    //awaits for text.text() prop 
    //and then sends it to readText()
    readText(await text.text());
}

function readText(text){
    //here you can continue with your JS normal logic
    console.log(text);
}

loadText('test.txt'); 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2020-03-16T09:50:22.143

我知道，我在这个聚会上迟到了。让我告诉你我有什么。

这是一个**简单的文本文件读取**

```
var path = "C:\\path\\filename.txt"
var fs = require('fs')
fs.readFile(path , 'utf8', function(err, data) {
  if (err) throw err;
  console.log('OK: ' + filename);
  console.log(data)
}); 
```

我希望这有帮助。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2021-12-19T08:24:04.000

此函数适用于浏览器和打开文件选择器对话框，在用户选择读取文件作为二进制文件并使用读取数据调用回调函数后：

```
function pickAndReadFile(callback) {
    var el = document.createElement('input');
    el.setAttribute('type', 'file');
    el.style.display = 'none';
    document.body.appendChild(el);
    el.onchange = function (){
        const reader = new FileReader();
        reader.onload = function () {
            callback(reader.result);
            document.body.removeChild(el);
        };
        reader.readAsBinaryString(el.files[0]);
    }
    el.click();
} 
```

并像这样使用它：

```
pickAndReadFile(data => {
  console.log(data)
}) 
```**

# python - Python正则表达式不起作用

> ID：14446449
> 
> 赞同：1
> 
> 时间：2013-01-21T20:14:19.957
> 
> 标签：python, regex, replace

```
REGEXES = [(re.compile(r'cat'), 'cat2'),
           (re.compile(r'(if)(.*)(\r?\n)(\s*)(logger.info)(.*)'), '\1\2')]

for search, replace in REGEXES:
                    line = search.sub(replace, line) 
```

为什么它不工作...

```
if( List != null ) {
   logger.info( "List is not null" );
   fieldSetContainerList.clear();
} 
```

与 Notepad++ 正则表达式搜索替换一起工作正常。用法：想要删除所有 if 语句下方的 logger.info 语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:17:59.997

您需要使用原始字符串：

```
 (re.compile(r'(if)(.*)(\r?\n)(\s*)(logger.info)(.*)'), r'\1\2')]
                                                              ^ here 
```

有了这个修复，你的正则表达式对我有用。没有它，`\1`and`\2`在解析字符串文字时被处理，并且永远不会进入正则表达式引擎。

这是我的测试代码：

```
import re

line = """if( List != null ) {
   logger.info( "List is not null" );
   fieldSetContainerList.clear();
}
"""

REGEXES = [(re.compile(r'cat'), 'cat2'),
           (re.compile(r'(if)(.*)(\r?\n)(\s*)(logger.info)(.*)'), r'\1\2')]

for search, replace in REGEXES:
    line = search.sub(replace, line)
print line 
```

运行时，将打印

```
if( List != null ) {
   fieldSetContainerList.clear();
} 
```

# xml - 浏览 xml 树并获取特定值

> ID：14446450
> 
> 赞同：0
> 
> 时间：2013-01-21T20:14:21.320
> 
> 标签：xml, search, xpath

拥有这个 xml 文档

```
<root>
<bookstore>
    <presc:book>
        <presc:id>1</presc:id>
        <presc:title>Harry Potter</presc:title>
        <presc:price>29.99</presc:price>
    </presc:book>
    <presc:book>
        <presc:id>2</presc:id>
        <presc:title>Learning XML</presc:title>
        <presc:price>39.95</presc:price>
    </presc:book>
    <presc:book>
        <presc:id>3</presc:id>
        <presc:title>Java for Life</presc:title>
        <presc:price>54.49</presc:price>
    </presc:book>
</bookstore>
</root> 
```

我希望仅在 'pres:id'=2 的情况下获取 'presc:price' 的值。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:51:18.763

首先，您需要`<root>`在文档末尾关闭您的节点。
然后因为`presc:`没有声明命名空间，所以需要使用`local-name()`函数，如下：

```
//*[local-name() = 'price' and ../id=2] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T02:47:30.453

如果此 XML`presc`声明了其命名空间，并且您在使用的任何 XML API 中声明了相同的命名空间，那么您尝试访问的节点将是

```
/root/bookstore/presc:book[presc:id = 2]/presc:price 
```

如果 XML 声明了其命名空间，但您不确定如何在您使用的 XML API 中声明它们，您可以通过以下操作找到价格：

```
//*[*[local-name() = 'id'] = 2]/*[local-name() = 'price'] 
```

就目前而言，您的 XML 目前不可用。

# c# - 查询 XML 元素到字符串

> ID：14446452
> 
> 赞同：1
> 
> 时间：2013-01-21T20:14:52.567
> 
> 标签：c#, xml, linq

有一个简单的问题：我目前正在尝试学习如何使用 XML 文件并想由您提出一个问题：

我遇到了一些问题，我当然可以使用一些帮助。我在下面创建了一个简单的小 XML 文件 (Users.XML)：

```
 <?xml version="1.0" encoding="utf-8" standalone="yes"?>
    <users>
      <user>
        <firstname>Might</firstname>
        <lastname>Guy</lastname>
        <username>SomeUser</username>
      </user>
      <user>
        <firstname>Bob</firstname>
        <lastname>Marley</lastname>
        <username>BobMarley</username>
      </user>       
    </users> 
```

我想要做的是找到一种方法来查询该文件以获取有关用户的特定信息。名，姓，无所谓。现在，在四处寻找之后，我发现许多人认为更好的方法之一是：

```
string firstName;

var data = from item in doc.Descendants("users")
                   where item.Element("user").Element("username").Value == "SomeUser"
                   select new
                   {
                       fname = item.Element("user").Element("firstname").Value
                   };

//Checking to see if anything was found. I know this isn't necessary to pull
//the information. I'm just doing this so I can know to throw an error to the
//screen if none is found
    if (data.Count() > 0)
//Now pull the data. Should only be 1 hit
        foreach (var p in data)
        {
            firstName = p.ToString();
        }
    else
        MessageBox.Show("No such user found"); 
```

现在，这个示例代码确实给了我用户的名字。但是，firstName 的实际内容是“fname = Might”。我希望它包含的只是“可能”。当然，如果我从选择中删除“fname =”，那么它会引发关于未命名字段的错误，所以我有点碰壁了。我尝试在谷歌上搜索解决方案，但由于我不确定我在谷歌搜索什么，它并没有给我带来太多运气。

所以我有3个问题。如果将我指向包含信息的教程的方向会更容易，我也会对此感到兴奋！不只是在寻找一个简单的解决方法，而是想弄清楚为什么会这样，因为我正在尝试学习 XML 而不仅仅是完成一项任务。

-A) 是否可以使用这种方法让 firstName 包含“Might”，而不是“fname = Might”。如果是这样，怎么做？如果没有，是否有另一种方法可以做到这一点？

-B) 为什么我需要“fname =”？这是与 LINQ 有关，还是完全是其他东西的一部分？除了 LINQ/XML 的东西，我还没有在其他任何地方找到这方面的例子，所以我无法更详细地解释它为什么会这样。

-C）这是一种可接受的方法来处理我在示例中尝试执行的操作，也就是根据某个字段（在本例中为用户名）查询 XML 文件以获取特定信息吗？如果没有，你能告诉我任何可能更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:20:29.843

采用：

```
var data = from item in doc.Descendants("users")
               where item.Element("username").Value == "SomeUser"
               select new
               {
                   fname = item.Element("firstname").Value
               };

var user = data.FirstOrDefault();
var firstName = user.fname; 
```

您得到*"fname=Might"*，因为您正在调用`ToString`从查询返回的整个匿名对象。从查询返回的匿名对象实际上具有名为 的属性`fname`。

对于您的**C)**问题：使用此 LinqToXml 从 xml 文件读取数据是正确的方法；-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:21:17.943

这里的问题是您使用`p.ToString()`而不是`p.fname`. 这个怎么样：

```
string firstName, lastName;

var data = from item in doc.Descendants("user")
           where item.Element("username").Value == "SomeUser"
           select new
           {
               fname = item.Element("firstname").Value,
               lname = item.Element("lastname").Value
           };

var p = data.FirstOrDefault();
if(p != null)
{
    firstName = p.fname;
    lastName = p.lname;
}
else
{
    MessageBox.Show("No such user found");
} 
```

要回答您的问题 B，您不需要使用`fname =`语法。如果您只想要一个值，而不是：

```
 select new
   {
       fname = item.Element("firstname").Value,
   }; 
```

你可以只使用：

```
 select item.Element("firstname").Value; 
```

该`select new { key = value, key2 = value2 }`语法允许您将多个值放入匿名类的对象中，您可以通过名称轻松地从中提取所需的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T20:23:02.357

您的 select 语句是一个投影。

这告诉编译器创建一个新的匿名对象，该对象具有一个属性 - fname 和该属性的值。

```
select new
{
  fname = item.Element("user").Element("firstname").Value
}; 
```

这与做这样的事情几乎相同——除了编译器会自动为你做这件事。

```
public class SomeObject
{
  public string fname { get; set; }
  public override ToString()
  {
    return "fname = " + fname;
  }
}

var data = from item in doc.Descendants("users")
                   where item.Element("user").Element("username").Value == "SomeUser"
                   select new SomeObject { fname = item.Element("user").Element("firstname").Value } 
```

然后，您的 foreach 将遍历每个元素并在对象上调用 toString ..

```
foreach (var p in data)
{
  firstName = p.ToString();
} 
```

如果您将 foreach 更改为此，它将解决问题：

```
foreach (var p in data)
{
  firstName = p.fname;
} 
```

# android - android：根据JB上的邻近发送器关闭屏幕

> ID：14446460
> 
> 赞同：2
> 
> 时间：2013-01-21T20:15:02.697
> 
> 标签：android, screen, proximity

我需要在我的应用程序中复制股票拨号器的功能 - 当接近传感器检测到手机靠近我的脸时，关闭屏幕，然后在我将手机从我脸上拿开时重新打开。

[此线程](https://stackoverflow.com/questions/3018716/android-turn-off-screen-when-close-to-face)中有一个部分有效的解决方案。它依赖于一个次优的私有 API，但更糟糕的是，它可以在我测试过的三分之一的设备上运行。我的目标是 Android 4.03 及更高版本，我正在测试 Galaxy S3、Galaxy Nexus 和 Nexus 4。我链接到的解决方案适用于 GN。在 Nexus 4 上，它什么都没有（看到[官方的 androidnadroid 拨号器](https://android.googlesource.com/platform/packages/apps/Phone/+/5c24ba2eaee30b1eb232b3a22a925240d25857fc/src/com/android/phone/PhoneGlobals.java)使用相同的代码并且它在那里工作，我觉得特别令人费解。在 S3 上，获取 wakeLock 似乎执行与按下电源按钮相同的操作（锁定手机，从而关闭接近传感器）。

由于调用 powerManager.goToSleep 需要需要手机根目录的权限，因此无法设置屏幕亮度（并且在我的 3 部手机中的任何一部上都无法正常工作 - 我可以改变亮度但永远无法转动屏幕）关闭），唯一的另一种方法似乎是另一个私有 API（setScreenState - 在我的情况下，这意味着 Java 互操作，因为我正在使用 Mono4Android），我想知道 - 有没有办法全面完成这项工作，或者是这只是我们不应该做的事情之一？尽管如此，仍然有很多呼叫应用程序需要这种功能，所以世界上的 Skypes、Vibers & Co. 需要以某种方式解决这个问题，我会很感激一些洞察力，因为我的智慧已经走到了尽头.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:52:55.363

这是我在此期间学到的——除非呼叫状态不是空闲，否则不要尝试获取那个特殊的唤醒锁。如果有电话，锁会起作用，但有一个问题：在谷歌手机上（尝试使用 GN 和 G4），即使屏幕关闭，活动也会保持活动状态。在我的 S3 上，一旦我获得锁，活动就会停止（不是暂停......停止！）。因此，您需要以某种方式编写代码以保持接近传感器处于活动状态（我在 onPause 之后将其取消注册，这让我相信它在 S3 上不起作用） - 必须让传感器保持停止活动肯定会事情对你来说更难，但它仍然是可行的。

# jquery - 获取 rel 属性的 DOM 表

> ID：14446461
> 
> 赞同：0
> 
> 时间：2013-01-21T20:15:08.193
> 
> 标签：jquery, dom

我试图在表中选中的单选按钮的兄弟上获取 rel 属性：

```
<table id="table-handing-subjects-content" class="table-content-all">
  <tbody>
    <tr for="handling-subject0">
      <td style="width:10%;">
        <input id="handling-subject[0]" type="radio" value="2" name="handling_subject">
      </td>
      <td style="width:25%;">
        <label for="handling-subject[0]"> economics</label>
      </td>
      <td style="width:15%;">
           <label for="handling-subject[0]"> firstyear</label>
      </td>
      <td style="width:20%;">
           <label id="ref-sec-id[0]" for="handling-subject[0]" rel="36"> black</label>
      </td>
      <td style="width:30%;">
         <label for="handling-subject[0]"> asdf,asdf asdf</label>
      </td>
 </tr>
 <tr for="handling-subject1">
   <td style="width:10%;">
      <input id="handling-subject[1]" type="radio" value="3" name="handling_subject">
   </td>
   <td style="width:25%;">
      <label for="handling-subject[1]"> math</label>
   </td>
   <td style="width:15%;">
      <label for="handling-subject[1]"> firstyear</label>
   </td>
   <td style="width:20%;">
      <label id="ref-sec-id[1]" for="handling-subject[1]" rel="36"> black</label>
   </td>
   <td style="width:30%;">
       <label for="handling-subject[1]"> asdf,asdf asdf</label>
   </td>
</tr>
<tr for="handling-subject2">
   <td style="width:10%;">
        <input id="handling-subject[2]" type="radio" value="3" name="handling_subject">
   </td>
   <td style="width:25%;">
        <label for="handling-subject[2]"> math</label>
   </td>
   <td style="width:15%;">
        <label for="handling-subject[2]"> firstyear</label>
   </td>
   <td style="width:20%;">
        <label id="ref-sec-id[2]" for="handling-subject[2]" rel="32"> level-up</label>
   </td>
   <td style="width:30%;">
         <label for="handling-subject[2]"> asdf,asdf asdf</label>
    </td>
   </tr>
  </tbody>
 </table> 
```

我试图用这个来获取选中单选按钮的 id="ref-sec-id" 的标签

```
 $('input[name=handling_subject]:checked').parent().parent().parent().children().find("td:eq(3)").children().attr("rel"); 
```

但我想我只得到第一行未选中的单选按钮。请帮助..并提前感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:20:34.523

```
$("input[name=handling_subject]:checked").closest('tr').find('[rel]').attr('rel') 
```

您的 HTML 导致输入相对于表具有不一致的父级数量。

您还应该使`id`标签上的所有属性都是唯一的，但这对您使用上述选择器的能力没有任何影响。

# php - 如何将 MYSQL 结果与 PHP 合并以获得漂亮的表

> ID：14446468
> 
> 赞同：0
> 
> 时间：2013-01-21T20:15:48.810
> 
> 标签：php, mysql

我有这样的mysql数据

```
production_date| production_net| worker_name
------------------------------------------
2013-01-10     | 390           | MMahe
------------------------------------------
2013-01-10     | 400           | RMaloney
------------------------------------------
2013-01-11     | 460           | JBurris
------------------------------------------
2013-01-11     | 210           | MMahe
------------------------------------------
2013-01-14     | 285           | LTaylor
------------------------------------------ 
```

我想这样显示我的结果

```
operator| 2013-01-10| 2013-01-11| 2013-01-14
--------------------------------------------
MMahe   | 390       | 210       |            
--------------------------------------------
RMaloney| 400       |           |            
--------------------------------------------
JBurris |           | 460       |            
--------------------------------------------
LTaylor |           |           | 285       
-------------------------------------------- 
```

我将使用 php。

任何有用的帖子、想法或教程将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:23:30.623

你只能通过 MySQL 来做，看看这个链接[http://www.artfulsoftware.com/infotree/qrytip.php?id=78](http://www.artfulsoftware.com/infotree/qrytip.php?id=78)

例如，将该链接中的示例查询修改为如下所示：

```
SELECT 
  EmpId,       
  sums.2005, sums.2006, sums.2007,      
FROM (                                  
  SELECT                                
    EmpID,
    SUM(IF(Yr=2005,sales,0)) As '2005',
    SUM(IF(Yr=2006,sales,0)) As '2006',
    SUM(IF(Yr=2007,sales,0)) As '2007'
  FROM Sales
  GROUP BY EmpID WITH ROLLUP
) AS sums; 
```

你会在 MySQL 中得到这样的结果

```
+--------+----------+----------+----------+
| EmpId  | 2005     | 2006     | 2007     |
+--------+----------+----------+----------+
| 1      | 12000.00 | 18000.00 | 25000.00 |
| 2      | 15000.00 |  6000.00 |     0.00 |
| 3      |     0.00 | 20000.00 | 24000.00 |
+--------+----------+----------+----------+ 
```

# javascript - 如何在保留先前字段值的同时使用 innerHTML 创建新字段？如何在再次调用之前完全执行 .click？

> ID：14446469
> 
> 赞同：0
> 
> 时间：2013-01-21T20:15:49.743
> 
> 标签：javascript, jquery, innerhtml, slidetoggle

我发誓，这个问题可能在其他地方，但我找不到！但在这里：http: [//jsfiddle.net/YUgxE/](http://jsfiddle.net/YUgxE/)

Javascript：

```
var update = $("#CalcUpdate");
var content = document.getElementById("CalcContent");

update.click(function() { //update
    content.innerHTML += "<div style='display: none' class='CalcOn'><input type='field' value='' class='CalcName'/>";
    obj = $(".CalcOn");
    obj.slideToggle(400,function() {
        obj.removeClass();
}); 
```

});

HTML：

```
<button id="CalcUpdate">update</button> 
```

这背后真的有两个问题：

1.  每次创建新字段时，都会删除以前的字段值。（我不知道为什么，它应该添加新的 innerHTML 行，为什么以前的值会被删除？）
2.  如果我快速单击更新，功能会重叠，我不知道如何以这种格式使一个在另一个之前执行。我见过其他问题，但它们都涉及使用两个功能或其他我不想做的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:20:25.590

您正在使用 jquery，所以请使用它！:) 这是我更新脚本的方式：

[http://jsfiddle.net/YUgxE/3/](http://jsfiddle.net/YUgxE/3/)

```
var $update = $("#CalcUpdate");
    var $content = $('#CalcContent');

$update.click(function() { //update
        var $obj = $("<div style='display: none' class='CalcOn'><input type='field' value='' class='CalcName'/>");
    $obj.appendTo($content).slideToggle(400, function() { $obj.removeClass() });
}); 
```

注意事项：

*   使用 jquery 查找内容，类似于查找更新区域的方式
*   使用 jquery 构造一个新对象 ( `$obj`) 而不是使用 innerHTML 并添加字符串
*   使用 jquery `append`/`appendTo`添加`$obj`到`$content`而不是使用 innerHTML
*   直接使用 $obj 来执行`slideToggle`（因此，没有查找）。这解决了您在快速单击时看到的操作时间/顺序问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:33:00.500

试试这个如果我理解正确，这将保留您填写的任何输入并添加更多：

```
update.click(function() { //update
var showinput = $("<div style='display: none' class='CalcOn'><input type='field' value='' class='CalcName'/>").insertBefore(content);

    obj = $(".CalcOn");
    obj.slideToggle(400,function() {
        obj.removeClass();
    }); 
```

# android - 创建新的 Print android 应用程序

> ID：14446479
> 
> 赞同：-1
> 
> 时间：2013-01-21T20:16:10.447
> 
> 标签：android

我想为 android 创建自己的打印应用程序。我不知道从哪里开始？任何指导将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:18:37.757

开始从 Android 搜索打印图像，因为您可以制作屏幕截图（有点棘手，但可以）或搜索文本打印。

一些链接可能会有所帮助：

[集成步骤](https://developers.google.com/cloud-print/docs/android)

[网页视图打印](https://stackoverflow.com/questions/13248709/android-paging-issue-of-webview-capturepicture-result)

# mysql - 将表迁移到 InnoDB

> ID：14446481
> 
> 赞同：1
> 
> 时间：2013-01-21T20:16:16.650
> 
> 标签：mysql, innodb

当我的数据库最初创建时，它都是作为 MyISAM 创建的（没有特别的原因）——随着时间的推移，随着新表的添加，它们都是 InnoDB，因为这似乎是 PHPMyAdmin 的默认值。

它从来没有引起任何我知道的问题，但我真的需要开始考虑性能优化，尤其是当应用程序和数据库变得更加繁忙时，所以想将它们全部更改为一种类型并选择了 InnoDB - 我很高兴如何进行更改等，但我的问题是这可能对前端应用程序产生什么影响（如果有的话）？该应用程序是一个自定义编码的 PHP 应用程序，基本上只是执行正常的 CRUD 操作，所以没有什么特别或不寻常的。

迁移后我应该注意什么，是否有任何可能停止工作或需要在应用程序中进行更改？我很欣赏 InnoDB 需要定制，特别是为了获得最佳性能，并且很高兴研究这一点，但我只想先将它们全部更改，运行几天，然后再进行下一步。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:28:05.233

与任何此类架构更改一样，确定它如何影响*您的*应用程序的唯一方法是对其进行测试。也就是说，在测试机器上，*不适*用于您的生产网站。

从 MyISAM 切换到 InnoDB 的注意事项很少。当然，您应该针对 InnoDB 进行调整。例如，请参阅我的演示文稿[http://www.slideshare.net/billkarwin/mysql-55-guide-to-innodb-status](http://www.slideshare.net/billkarwin/mysql-55-guide-to-innodb-status)以获取一些提示。

还要记住，如果您为 MyISAM key_buffer_size 配置变量分配了大量 RAM，如果您将所有内容都切换到 InnoDB，则不再需要这些 RAM。我已经审核了相当多的站点，这些站点仍然有 4GB+ 分配给这个不再使用的缓冲区。

至于您需要在应用程序中进行的任何更改，不，不应该有任何需要。InnoDB 支持与 MyISAM 相同的 SQL 数据类型和查询语义，除了一些特殊情况。

例如，MyISAM 支持 auto-inc 列在第二位的复合主键。InnoDB 要求 auto-inc 列是 PK 中的第一列。

# ruby-on-rails - 从 rspec api 规范渲染 jbuilder json

> ID：14446486
> 
> 赞同：1
> 
> 时间：2013-01-21T20:16:30.020
> 
> 标签：ruby-on-rails, api, testing, rspec, jbuilder

我正在以与[Rails 3 in Action](http://www.manning.com/katz/)的第 13 章中描述的类似方式编写 Rails api 规范。

在书中，他们使用 .json 的结果比较 json 响应`#to_json`。

```
expect(response.body).to eql(project.to_json) 
```

但是，我正在使用 jbuilder，所以这不起作用。我需要一种方法来呈现 jbuilder 模板并获得示例中的响应，但到目前为止还没有成功。

我的测试位于 spec/api 目录中，并`type: :api`按照书中的指示进行标记。我在 rspec 配置中包含用于 :api 规范的 ApiHelper 模块，其中包括 Rack::Test::Method，（但这实际上似乎并没有太大区别）。

似乎`#render`其他 rspec 测试中使用的方法可以工作，但它在我的 api 规范中不可用，我不知道如何做到这一点。

完整的示例规范如下所示。

```
# spec/api/photos_spec.rb

require "spec_helper"

describe "Photos Api", type: :api do
  let(:user)  { create(:user) }
  let(:token) { user.authentication_token }
  let(:photo) { create(:photo) }

  let(:url) { "/api/photos" }
  it "should get a photo" do
    get "#{url}/#{photo.id}.json", token: token
    expect(response).to be_ok
    expect(response.body).to eql("???") # How can I get the jbuilder output for comparison?
  end
end 
```

任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-24T21:37:29.480

您的 Jbuilder 输出*是* `response.body`. 您需要将其与已嘲笑的内容进行比较。

```
expect(response.body).to include(photo.url) 
```

通常，检查视图的输出最好通过 Capybara 或您拥有的请求规范中进行测试，即使 Rspec 允许您`render_views`在控制器规范中指定。

# qt - OpenGL 相对于对象轴的旋转

> ID：14446487
> 
> 赞同：3
> 
> 时间：2013-01-21T20:16:36.613
> 
> 标签：qt, opengl, rotation, local, axis

我正在为一个物体的旋转而苦苦挣扎。我想用这个小程序来说明我的 AR Drone 2.0 中的陀螺仪读数。也许你想先看这个短片：http: [//youtu.be/HvrLS8Olr2c](http://youtu.be/HvrLS8Olr2c)

滑块用于 x,y,z 旋转，通过

```
glRotatef(rotationX, x_vect.x, x_vect.y, x_vect.z);
glRotatef(rotationY, y_vect.x, y_vect.y, y_vect.z);
glRotatef(rotationZ, z_vect.x, z_vect.y, z_vect.z); 
```

其中值是：

```
Vector x_vect = {1.0f, 0.0f, 0.0f};
Vector y_vect = {0.0f, 1.0f, 0.0f};
Vector z_vect = {0.0f, 0.0f, 1.0f}; 
```

您可以从这里下载这个小应用程序的完整源代码：http: [//ablage.stabentheiner.de/2013-01-21_openglimportmodel.zip](http://ablage.stabentheiner.de/2013-01-21_openglimportmodel.zip)

问题是，如果你先旋转 Y 轴，然后尝试使用 X 滑块，它不会旋转它应该做的轴（参见 C4D 动画进行比较）。我认为这是因为我先执行 X 旋转，然后执行 Y 旋转。交换代码行并不能解决问题，而是将其推到另一个轴上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T08:17:08.077

发生这种情况是因为当您调用`glRotatef()`对象的枢轴时会旋转。看看这个漂亮的模具：
![很棒的d6](../Images/65a9c87f7c8728b615164cd346514980.png)

想象一下 x 轴穿过 4 和 3（d6 的对边总是加起来为 7），z 轴穿过 6 和 1，y 轴穿过 2 和 5。
如果你要编写以下代码：

```
glRotatef(90,1,0,0);
glRotatef(90,0,1,0); 
```

模具首先会绕它的 x 轴旋转 90 度，使 6 边位于顶部。但是，轴相对于骰子保持不变，因此下一个调用将保持围绕穿过 2 和 5 的轴旋转骰子，有效地将带有 6 的一侧向右旋转。当你转动这些调用，并使骰子首先围绕它的 y 轴旋转时，带有 6 的一侧将首先向右并在顶部。

现在，不碍事了。您可以做的是围绕对象旋转相机，而不是旋转对象本身。我建议阅读有关实现轨迹球相机的信息。[这似乎是一个好的开始。](http://nehe.gamedev.net/tutorial/arcball_rotation/19003/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:45:58.020

[http://doc-snapshot.qt-project.org/4.8/opengl-grabber.html](http://doc-snapshot.qt-project.org/4.8/opengl-grabber.html)

[http://doc-snapshot.qt-project.org/4.8/opengl-grabber-glwidget-cpp.html](http://doc-snapshot.qt-project.org/4.8/opengl-grabber-glwidget-cpp.html)

当我在 Qt 中的 opengl 中进行旋转时，抓取器示例非常有帮助。这是 glwidget.cpp 中的一些内容。

```
void GLWidget::paintGL()
{
 glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

 glPushMatrix();
// Here is the rotation code:
 glRotated(xRot / 16.0, 1.0, 0.0, 0.0);
 glRotated(yRot / 16.0, 0.0, 1.0, 0.0);
 glRotated(zRot / 16.0, 0.0, 0.0, 1.0);

 drawGear(gear1, -3.0, -2.0, 0.0, gear1Rot / 16.0);
 drawGear(gear2, +3.1, -2.0, 0.0, -2.0 * (gear1Rot / 16.0) - 9.0);

 glRotated(+90.0, 1.0, 0.0, 0.0);
 drawGear(gear3, -3.1, -1.8, -2.2, +2.0 * (gear1Rot / 16.0) - 2.0);

 glPopMatrix();
} 
```

# python - Python的非阻塞图像查看器功能？

> ID：14446488
> 
> 赞同：1
> 
> 时间：2013-01-21T20:16:37.173
> 
> 标签：python, image, user-interface

我想要一个 Python 可访问的函数`show_image(...)`，它启动一个相当简单的图像查看器，其中图像被指定为（例如）一个 NumPy 数组。重要的是，我希望这个函数不要阻塞，而是让脚本继续执行，同时保持窗口的交互性。

我意识到巨大的设计缺陷和被称为全局解释器锁的所有痛苦都会阻止任何基于 Python 的 GUI 与主线程中的 Python 代码并行运行，所以我显然需要启动一个释放 GIL 并在 C/C++ 中执行所有操作的线程。

我很乐意用 Cython（或手写的 C 扩展模块）包装这样的东西，但我正在寻找合适的 GUI 解决方案。它应该是跨平台的，并且易于与 Cython 扩展一起构建（后者似乎排除了 Qt/qmake/等）。

重要的是，我希望能够以这种方式按需启动多个窗口。似乎大多数 GUI 工具包都有一些`run()`类似的函数，需要在~~主线程~~程序的末尾调用`main()`，这让我不太清楚如何多次启动一个窗口。我想我每次都可以启动一个单独的 GUI 事件循环，但这似乎是灾难的根源（我记得，至少 GTK+ 明确不支持它）。

我还要说`fork()`'ing 不是一种选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:35:38.960

我个人使用`os.system("xv foo.png &")`, 或任何小型图像查看器。根据详细信息，您还可以`g = os.popen("xv - &", "w")`将图像数据写入文件`g`。同样取决于细节，我有时将我的程序做成一个网络服务器（几十行代码，例如使用 Twisted），从那里提供图像，并在我的网络浏览器中查看它们。我的观点是你根本不需要任何 GUI 或多线程。

# javascript - 在 facebook 中获取朋友信息

> ID：14446490
> 
> 赞同：0
> 
> 时间：2013-01-21T20:16:47.360
> 
> 标签：javascript, facebook-graph-api, facebook-javascript-sdk

我正在开发一个应用程序来从 facebook 获取我朋友的工作经历和教育

对于我的一些朋友

```
 graph.facebook.com/me/friends?fields=name,work&......... 
```

提供有关其雇主的详细信息

对于朋友 xyz，我在使用上面的 url 时只得到名字。但是当我尝试

```
 graph.facebook.com/xyz?fields=name,work 
```

我也得到了他的工作细节。

这两个网址有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:35:22.093

第一个 URI`https://graph.facebook.com/me/friends?fields=name,work`返回有关当前登录用户的朋友的信息。根据该用户（使用您的应用程序的人）授予您的应用程序的权限，您可能会也可能无法获得他们朋友的工作信息（或您请求的任何其他详细信息）。

第二个 URI`https://graph.facebook.com/xyz?fields=name,work`返回有关特定用户的信息（在您的情况下为`xyz`）。您是否可以这样做还取决于该信息是公开的还是授权给您的应用程序的访问令牌，我相信。

尝试使用[Graph API Explorer](https://developers.facebook.com/tools/explorer)探索 Facebook Graph 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T06:55:43.000

可能是你的朋友 xyz1 对工作历史设置了隐私，这就是为什么你没有得到它

# git - 缺少 Git 大师

> ID：14446492
> 
> 赞同：1
> 
> 时间：2013-01-21T20:16:56.690
> 
> 标签：git

呃，我在 git 的文件夹中创建了一个新的仓库，里面有一堆预先写好的源代码，但是现在当我尝试推送它时，没有“master”。帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:19:04.970

您需要提交目录的内容以创建初始提交：

```
git add .
git commit -m 'Initial commit.' 
```

否则，Git 没有什么可以推动的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:19:48.900

你完成了你的初始提交了吗？

```
git add .
git commit -m "Initial commit"
git push -u origin master 
```

# java - Android sqlite db.query 导致 CursorIndexOutOfBoundsException

> ID：14446494
> 
> 赞同：0
> 
> 时间：2013-01-21T20:17:02.503
> 
> 标签：java, android, android-sqlite

我正在尝试从我的数据库中选择某些行，但是由于我一直使索引超出范围，因此我决定暂时删除该`WHERE`部分并获取所有数据。我使用了 android 教程[http://developer.android.com/training/basics/data-storage/databases.html#DbHelper](http://developer.android.com/training/basics/data-storage/databases.html#DbHelper)来创建这个方法。但是当我试图从查询中获取值时，我得到了 CursorIndexOutOfBoundsException。

我的代码：

```
String getSite() {
    SQLiteDatabase db = this.getReadableDatabase();
            //get all data for now
    Cursor c = db.query(
        TABLE_NAME,  // The table to query
        null,                               // The columns to return
        null,                                // The columns for the WHERE clause
        null,                            // The values for the WHERE clause
        null,                                     // don't group the rows
        null,                                     // don't filter by row groups
        null                                 // don't sort
        );
    c.moveToFirst();
        String test= c.getString(0); 
    c.close();
    return test;}
} 
```

错误： `android.database.CursorIndexOutOfBoundsException: Index -1 requested, with a size of 6`

当我检查 c.count() 时，我得到了 6，所以我不确定为什么我指的是可能超出范围的索引

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:31:12.880

如果光标没有移动，则它是空的。

尝试

```
if (c.moveToFirst()) {
    String test= c.getString(0);
    // or String test= c.getString(c.getColumnIndex("column_name")); 
} 
```

# c++ - CMake：带有单元测试的项目结构

> ID：14446495
> 
> 赞同：173
> 
> 时间：2013-01-21T20:17:04.350
> 
> 标签：c++, unit-testing, boost, cmake, boost-test

我正在尝试构建我的项目以包含生产源（在`src`子文件夹中）和测试（在`test`子文件夹中）。我正在使用 CMake 来构建它。作为一个最小的例子，我有以下文件：

CMakeLists.txt：

```
cmake_minimum_required (VERSION 2.8) 
project (TEST) 

add_subdirectory (src) 
add_subdirectory (test) 
```

src/CMakeLists.txt：

```
add_executable (demo main.cpp sqr.cpp) 
```

src/sqr.h

```
#ifndef SQR_H
#define SQR_H
double sqr(double);    
#endif // SQR_H 
```

src/sqr.cpp

```
#include "sqr.h"
double sqr(double x) { return x*x; } 
```

src/main.cpp - 使用 sqr，没关系

测试/CMakeLists.txt：

```
find_package(Boost COMPONENTS system filesystem unit_test_framework REQUIRED)

include_directories (${TEST_SOURCE_DIR}/src) 

ADD_DEFINITIONS(-DBOOST_TEST_DYN_LINK) 

add_executable (test test.cpp ${TEST_SOURCE_DIR}/src/sqr.cpp) 

target_link_libraries(test
                      ${Boost_FILESYSTEM_LIBRARY}
                      ${Boost_SYSTEM_LIBRARY}
                      ${Boost_UNIT_TEST_FRAMEWORK_LIBRARY}
                      )

enable_testing()
add_test(MyTest test) 
```

测试/test.cpp：

```
#define BOOST_TEST_MODULE SqrTests
#include <boost/test/unit_test.hpp>

#include "sqr.h"

BOOST_AUTO_TEST_CASE(FailTest)
{
    BOOST_CHECK_EQUAL(5, sqr(2));
}

BOOST_AUTO_TEST_CASE(PassTest)
{
    BOOST_CHECK_EQUAL(4, sqr(2));
} 
```

几个问题：

1.  这种结构有意义吗？构建此代码时的最佳实践是什么？（我来自 C# 和 java，从某种意义上说它更容易）
2.  我不喜欢我必须在文件中列出文件`src`夹中的所有`test/CMakeLists.txt`文件。如果这是一个图书馆项目，我只会链接图书馆。有没有办法避免列出来自其他项目的所有 cpp 文件？
3.  线路`enable_testing()`和`add_test(MyTest test)`做什么？我没有看到任何效果。如何从 CMake（或 CTest）运行测试？
4.  到目前为止，我只是`cmake .`在根文件夹中运行，但这造成了到处都是临时文件的混乱。如何以合理的结构获得编译结果？

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2013-01-21T21:42:48.433

对于问题 1 和 2，我建议从您的非测试文件中创建一个库，不包括 main.cpp（在这种情况下只是 src/sqr.cpp 和 src/sqr.h），然后您可以避免列出（更重要的是重新编译）所有源代码两次。

对于问题 3，这些命令会添加一个名为“MyTest”的测试，它会调用您的可执行文件“test”而无需任何参数。但是，由于您已将这些命令添加到 test/CMakeLists.txt 而不是您的顶级 CMakeLists.txt，因此您只能从构建树的“test”子目录中调用测试（try `cd test && ctest -N`）。如果您希望测试可以从顶级构建目录运行，则需要`add_test`从顶级 CMakeLists.txt 调用。这也意味着您必须使用更详细的形式，[`add_test`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command:add_test "CMake v2.8.10 文档")因为您的测试 exe 没有在同一个 CMakeLists.txt 中定义

在您的情况下，由于您在根文件夹中运行 cmake，因此您的构建树和源代码树是一回事。这被称为源内构建，并不理想，这导致了问题 4。

生成构建树的首选方法是进行源外构建，即在源树之外的某个位置创建一个目录并从那里执行 cmake。即使在项目的根目录中创建一个“构建”目录并执行`cmake ..`，也会提供一个不会干扰源代码树的干净结构。

最后一点是避免调用可执行文件“测试”（区分大小写）。至于原因，请参阅[这个答案](https://stackoverflow.com/a/736838/424459)。

为了实现这些更改，我将执行以下操作：

CMakeLists.txt：

```
cmake_minimum_required (VERSION 2.8)
project (TEST)
add_subdirectory (src) 
add_subdirectory (test)
enable_testing ()
add_test (NAME MyTest COMMAND Test) 
```

src/CMakeLists.txt：

```
add_library (Sqr sqr.cpp sqr.h)
add_executable (demo main.cpp)
target_link_libraries (demo Sqr) 
```

测试/CMakeLists.txt：

```
find_package (Boost COMPONENTS system filesystem unit_test_framework REQUIRED)
include_directories (${TEST_SOURCE_DIR}/src
                     ${Boost_INCLUDE_DIRS}
                     )
add_definitions (-DBOOST_TEST_DYN_LINK)
add_executable (Test test.cpp)
target_link_libraries (Test
                       Sqr
                       ${Boost_FILESYSTEM_LIBRARY}
                       ${Boost_SYSTEM_LIBRARY}
                       ${Boost_UNIT_TEST_FRAMEWORK_LIBRARY}
                       ) 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2016-05-09T02:45:16.537

我喜欢@Fraser 的示例，但会在 test/CMakeLists.txt 中使用 add_test 命令，并在 add_subdirectory(test) 之前使用 enable_testing。

这样，您可以从顶级构建目录运行测试，同时在 test/CMakeLists.txt 中指定测试。

结果将如下所示（我重用了@Fraser 的示例）：

CMakeLists.txt

```
cmake_minimum_required (VERSION 2.8)
project (TEST)
add_subdirectory (src)

enable_testing ()
add_subdirectory (test) 
```

src/CMakeLists.txt

```
add_library (Sqr sqr.cpp sqr.h)
add_executable (demo main.cpp)
target_link_libraries (demo Sqr) 
```

测试/CMakeLists.txt

```
find_package (Boost COMPONENTS system filesystem unit_test_framework REQUIRED)
include_directories (${TEST_SOURCE_DIR}/src
                     ${Boost_INCLUDE_DIRS}
                     )
add_definitions (-DBOOST_TEST_DYN_LINK)
add_executable (Test test.cpp)
target_link_libraries (Test
                       Sqr
                       ${Boost_FILESYSTEM_LIBRARY}
                       ${Boost_SYSTEM_LIBRARY}
                       ${Boost_UNIT_TEST_FRAMEWORK_LIBRARY}
                       )
add_test (NAME MyTest COMMAND Test) 
```

# ios - 如何将两个 cocos2D 项目合并到一个应用程序中？

> ID：14446498
> 
> 赞同：0
> 
> 时间：2013-01-21T20:17:25.623
> 
> 标签：ios, objective-c, xcode, cocos2d-iphone

我开发了两个不同的游戏（两个不同的项目），我被分配将它们组合/合并到一个应用程序中。所以我对我应该遵循的方式感到困惑，我应该将 Game2 作为第三方库添加到 Game1 还是有办法在运行时更改目标？

简单地

单击按钮 1 -----> 运行 Game1`MainScene`

单击按钮 2 -----> 运行 Game2`MainScene`

按照这个[Xcode 4.2 如何将一个项目包含到另一个项目中？](https://stackoverflow.com/questions/9370518/xcode-4-2-how-include-one-project-into-another-one)问题并将游戏 2 添加到游戏 1 中，就像静态库一样。

问题是两场比赛有很多相互的头球，比如`MainScene,GameHud,Objects,Points`......

游戏 1 使用 [director runWithScene:[MainMenu scene]] 运行；如何在点击按钮上调用 Game2 的 MainScene？

或者是否可以在运行时更改目标？***点击 button1 运行 game1 的目标 点击 button2 运行 game2 的目标。***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T01:43:08.980

这基本上只是繁重的工作。静态库对您没有多大帮助，因为它不能解决冲突——类名在可执行文件中必须是唯一的。

基本上您需要做的就是将所有源代码和资产添加到同一个 Xcode 项目中。然后最初只加载两个游戏中的一个，以便尝试让另一个进行编译。您必须重命名类和文件才能完成此操作。

完成后，添加一些（临时）选择菜单，以便您可以在两个游戏之间进行选择。这可能会触发其他编译错误。解决它们。

如果您有同名但内容不同的资产，则需要重命名它们并更改代码。

然后测试并找到 1000 个小细节，这些小细节会让你拔掉头发。好吧，至少其中一些肯定会是一个挑战。但是针对这些挑战，Stackoverflow 应运而生。:)

# python - python 3 中 paramiko 有什么好的替代品？或者是否有 python 3 的 paramiko 端口？

> ID：14446499
> 
> 赞同：7
> 
> 时间：2013-01-21T20:17:32.523
> 
> 标签：python, ssh, python-3.x, paramiko

我有基于 paramiko 模块的 python 2.7 代码，我想移植到 python 3.3，但我似乎找不到可以工作的 paramiko 版本或合适的替代品。

我需要该模块在 Windows、Linux 和 Mac 上工作。

有人对此有指点吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-04T01:21:43.673

我完成了一个完整的端口，通过了 Py2.6、2.7、3.2 和 3.3 上的所有测试。需要测试。你可以在主 github repo的[pull request #236中找到它。](https://github.com/paramiko/paramiko/pull/236)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T14:02:04.513

我认为没有合适的替代品，但我很高兴得知我错了。您可以使用`subprocess`，但这种方式违背了拥有一个好的模块的目的。

paramiko 的最新官方消息在[这里](https://github.com/paramiko/paramiko/issues/16)：

> 还没有 py3k 消息，它仍然是绝对计划好的（见我上面的评论），但其他优先事项必须放在首位:(

所以没有时间表，只有希望。

编辑：已经取得了一些进展，但似乎还没有准备好用于一般用途。您可以关注[此讨论](https://github.com/paramiko/paramiko/issues/16#issuecomment-20860590)以获取更新。

编辑：不是官方的，但这里是一个似乎在 Python 3 中工作的[paramiko fork 。](https://github.com/nischu7/paramiko)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-29T17:47:57.240

在 Python 3 上等待 paramiko 时，可以使用 putty。

```
os.system('C:\putty\psftp ' + USER_NAME +'@' + SERVER+ ' -pw ' +PASS+' -b '+ SFTPscript) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-14T08:12:28.390

找到了如何在 Internet 上的 Windows XP 上的 python 3.3.2 上安装和使用 paramiko 的解决方案，它是有效的 :)

```
Need to install
python-3.3.2.msi
paramiko-1.14.0.zip
pycrypto-2.6.win32-py3.3.exe
pypa-setuptools-3.6.tar.gz
ecdsa-0.11.tar.gz
pip-0.7.3.zip 
```

# android - 当两部手机连接在一台电脑上时，adb 得到相同的序列号。我可以更改序列号吗？

> ID：14446500
> 
> 赞同：3
> 
> 时间：2013-01-21T20:17:44.187
> 
> 标签：android, eclipse, adb, serial-number

我有两个设备同时连接到计算机。如果我使用命令：adb devices，adb 得到这个：

附加设备列表 0123456789ABCDEF 设备 0123456789ABCDEF 设备

因此，设备具有相同的序列号！我想通过 USB 管理这两个设备来调试我的应用程序，但是我有这个错误：

[2013-01-21 20:28:12 - DeviceMonitor] 无法开始监控 0123456789ABCDEF：多个设备

我想我有这个错误，因为设备具有相同的序列号。我阅读了其他讨论，并在终端上尝试了这些说明：

$苏

# getprop net.hostname

安卓-b112064be9bfd82

所以..0123456789ZBCDEF 不是序列号。

有人知道如何更改序列号吗？对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-27T01:35:20.560

要临时（直到重新启动）更改 ADB 序列号，请断开除一个设备之外的所有设备，然后在命令窗口中键入：

```
adb shell 'echo -n "XXXXXXXXXXXXXXXX" > /sys/class/android_usb/android0/iSerial' 
```

其中 X 代表所需的序列号。*此更改**需要 root**并且只会持续到设备重新启动。*要使其永久化，您需要更改其中一个系统启动脚本来进行更改。

*请注意，这在较新的设备上似乎并不常见。文件位置显然已更改。*

# java - 格式错误的字符（期望引用，得到我）~ 处理

> ID：14446501
> 
> 赞同：0
> 
> 时间：2013-01-21T20:17:53.657
> 
> 标签：java, processing

我希望有人可以帮助我解决我的问题。我正在尝试制作一个简单的可视化来显示足球队如何在 2012 年的 FIFA 排名中上升或下降。为此，我创建了 17 张图像并将其加载到我想要根据按钮事件移动的草图中。下面是我的代码：

```
//Setting up the images that will go into the sketch

PImage img1;
PImage img2;
PImage img3;
PImage img4;
PImage img5;
PImage img6;
PImage img7;
PImage img8;
PImage img9;
PImage img10;
PImage img11;
PImage img12;
PImage img13;
PImage img14;
PImage img15;
PImage img16;
PImage img17;

//loading the images from the file
void setup() {
  size(600, 1100)
  img1 = loadImage('Click.png');
  img2 = loadImage('Team_xxxxx.png');
  img3 = loadImage('Team_xxxxxx.png');
  img4 = loadImage('Team_xxxxxx.png');
  img5 = loadImage('Team_xxxxxxx.png');
  img6 = loadImage('Team_xxxxx.png');
  img7 = loadImage('Team_xxxxxx.png');
  img8 = loadImage('Team_xxxxxxx.png');
  img9 = loadImage('Team_xxxxxx.png');
  img10 = loadImage('Team_xxxxxx.png');
  img11 = loadImage('Team_xxxxx.png');
  img12 = loadImage('Team_xxxxx.png');
  img13 = loadImage('Team_xxxxx.png');
  img14 = loadImage('Team_xxxxxx.png');
  img15 = loadImage('Team_xxxxx.png');
  img16 = loadImage('Team_xxxxx.png');
  img17 = loadImage('Team_xxxxxx.png');
}

//Drawing the images into the sketch
void draw() {
  image(img1, 400, 100);
  image(img2, 100, 250);
  image(img3, 100, 300);
  image(img4, 100, 350);
  image(img5, 100, 400);
  image(img6, 100, 450);
  image(img7, 100, 500);
  image(img8, 100, 550);
  image(img9, 100, 600);
  image(img10, 100, 650);
  image(img11, 100, 700);
  image(img12, 100, 750);
  image(img13, 100, 800);
  image(img14, 100, 850);
  image(img15, 100, 900);
  image(img16, 100, 950);
  image(img17, 100, 1000);
} 
```

我不断收到此错误消息：格式错误的字符（期望引用，得到我）。以下是控制台中的输出：

```
 processing.app.SketchException: Badly formed character constant (expecting quote, got l)
        at processing.mode.java.preproc.PdePreprocessor.checkForUnterminatedMultilineComment(PdePreprocessor.java:478)
        at processing.mode.java.preproc.PdePreprocessor.write(PdePreprocessor.java:515)
        at processing.mode.java.JavaBuild.preprocess(JavaBuild.java:270)
        at processing.mode.java.JavaBuild.preprocess(JavaBuild.java:185)
        at processing.mode.java.JavaBuild.build(JavaBuild.java:144)
        at processing.mode.java.JavaBuild.build(JavaBuild.java:123)
        at processing.mode.java.JavaMode.handleRun(JavaMode.java:114)
        at processing.mode.java.JavaEditor$19.run(JavaEditor.java:474)
        at java.lang.Thread.run(Thread.java:680) 
```

我在 OS X 上运行的 Macbook Pro 上使用 Processing 2.0B7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:23:28.020

错误可能来自

```
img1 = loadImage('Click.png'); 
```

特别是`'Cl`位。字符常量由一个单引号 ( `'`)、一些字符和另一个单引号 ( `'`) 组成。
你所拥有的是一个单引号（`'`），一个`C`，然后一个`l`。

由于您似乎想要一个字符串常量，请尝试使用双引号：

```
img1 = loadImage("Click.png"); 
```

# c# - 如何在针对架构验证的 XDocument 中找到无效的 XML 节点（XmlSchemaValidationException.SourceObject 为空）

> ID：14446502
> 
> 赞同：7
> 
> 时间：2013-01-21T20:17:56.440
> 
> 标签：c#, validation, xsd, linq-to-xml

我有一个`XDocument`针对 XML 模式进行验证的。当`XDocument`无效时，我需要找到无效的 XML 节点，以便用户可以轻松导航到我的应用程序中的相应位置（例如，通过双击消息网格上的消息）。

`System.Xml.Schema.Validate()`为此，我使用了扩展方法。Validate() 方法的第二个参数`System.Xml.ValidationEventHandler`是在每个无效 XML 元素上调用的。它通过一个`System.Xml.ValidationEventArgs`. `ValidationEventArgs.Exception`可以转换`System.Xml.Schema.XmlSchemaValidationException`为. 现在 `XmlSchemaValidationException`有一个属性`SourceObject`，我希望它包含对无效 XML 节点的引用。不幸的是，它始终为空。

以下片段说明了我的用法：

```
XDocument doc = XDocument.Load(@"c:\temp\booksSchema.xml");

// Create the XmlSchemaSet class.
XmlSchemaSet sc = new XmlSchemaSet();

// Add the schema to the collection.
sc.Add("urn:bookstore-schema", @"c:\temp\books.xsd");

// Validate against schema
doc.Validate(sc, delegate(object sender, ValidationEventArgs e)
                {
                    XmlSchemaValidationException ve = e.Exception as XmlSchemaValidationException;
                    if (ve != null)
                    {
                        object errorNode = ve.SourceObject;    
                        // ve.SourceObject is always null
                    }
                }); 
```

验证本身可以正常工作，但我无法在无效节点上获得引用。奇怪的是，同样的方法适用于`System.Xml.XmlDocument`，但不幸的是我必须`XDocument`在这种情况下使用。

有没有人建议如何找到无效节点`XDocument`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-24T11:13:20.520

好的，我有答案了。无效节点是事件处理程序的“发送者”本身。它可以转换为 XContainer、XElement、...

# ruby-on-rails - 如何检查rails上传的文件类型？

> ID：14446503
> 
> 赞同：8
> 
> 时间：2013-01-21T20:17:58.180
> 
> 标签：ruby-on-rails, ruby, mime-types

我如何查看正在发送的文件类型？例如，csv 或 xls ......请提供代码......我得到文件：

```
aut_name = uploaded_io.original_filename
      File.open(Rails.root.join('public', 'uploads_prices', uploaded_io.original_filename), 'wb') do |file|
        file.write(uploaded_io.read)
      end
      as_load(aut_name) 
```

也许通过 MIMO，但如何？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-21T20:22:22.173

`uploaded_io.content_type`包含文件的 MIME 类型。

所以：

`uploaded_io.content_type == "text/csv"`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-12-23T22:13:40.893

不幸的是，如果用户更改文件扩展名，它（content_type 方法）将不起作用。我已经在 Rails 控制台中测试过，更改文件扩展名也会更改“content_type”输出。

发现这个 SO 问题很有帮助：

[确定 Ruby 中的文件类型](https://stackoverflow.com/questions/51572/determine-file-type-in-ruby)

# c - 初学者 C - 以相反的顺序打印用户的浮点输入

> ID：14446506
> 
> 赞同：3
> 
> 时间：2013-01-21T20:18:09.600
> 
> 标签：c, printf, scanf

我正在编写一个程序，它使用 1 条语句从用户那里读取 6 个浮点数。然后让它打印 3 行中的 6 个数字，并满足以下所有要求：

(1) 数字以与读入相反的顺序打印

(2) 它们在 3 行：第一行 1 个数字，下一行 2 个数字，最后一行 3 个数字

(3) 将数字排列成列格式，右对齐，小数点后一位

* * *

这是我对前两个要求的尝试

```
#include <stdio.h>

int main(void)

{
    //variable definitions
    float f1,f2,f3,f4,f5,f6;

    printf ("Enter 6 float numbers, separated by commas: ");

    scanf ("%f1,%f2,%f3,%f4,%f5,%f6",&f1,&f2,&f3,&f4,&f5,&f6);

    printf ("%f6\n",f6);
    printf ("%f5,%f4\n",f5,f4);
    printf ("%f3,%f2,%f1\n",f3,f2,f1);

    return 0;

} 
```

对我的初学者来说，这很有意义。

这是我运行它时的结果

> 输入 6 个浮点数，用逗号分隔：0.2,3.2,0.1,0.5,0.6,0.7
> 
> 数字是：
> 
> -107374176.0000006
> 
> -107374176.0000005,-107374176.0000004
> 
> -107374176.0000003,-107374176.0000002,0.2000001
> 
> 按任意键继续 。. .

除了最后一个之外，所有这些都是垃圾输出。感谢所有帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T20:20:26.733

你的格式

```
scanf ("%f1,%f2,%f3,%f4,%f5,%f6",&f1,&f2,&f3,&f4,&f5,&f6); 
```

期望 a`1`在第一个之后`float`和以下逗号之前，a`2`在下一个等之后。

它应该是

```
scanf ("%f,%f,%f,%f,%f,%f",&f1,&f2,&f3,&f4,&f5,&f6); 
```

由于未提供分隔数字，因此第二次转换（以及以下转换）失败，并且其他`float`s 保持未初始化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:21:06.577

问题出在格式上：

```
scanf ("%f1,%f2,%f3,%f4,%f5,%f6",&f1,&f2,&f3,&f4,&f5,&f6); 
```

应该

```
scanf ("%f,%f,%f,%f,%f,%f",&f1,&f2,&f3,&f4,&f5,&f6); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T20:21:34.447

打印浮点数的正确格式是：

```
printf("%.1f", variable); 
```

在此示例中，`variable`将打印小数点后的 1 位数字。

# sql - 将访问代码转换为 SQL

> ID：14446507
> 
> 赞同：-2
> 
> 时间：2013-01-21T20:18:12.320
> 
> 标签：sql, ms-access

我在 Access 中有以下代码，我需要它在 sql 中工作，Is numeric 部分让我失望。

```
Sum([Employee Count]*IIf(IsNumeric([Length]),[Length],0)) AS Total_hours, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:20:15.577

您将用`IIF()`表达式`CASE`替换 。在[`IsNumeric()`](http://msdn.microsoft.com/en-us/library/ms186272%28v=sql.105%29.aspx)SQL Server 中有效：

```
Sum([Employee Count]*
    case when IsNumeric([Length]) = 1
          then [Length]
          else 0 end) AS Total_hours, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:32:59.493

您也可以只过滤掉“非数字”，因为 0 不会影响 SUM 聚合。

```
select
Sum([Employee Count]*[Length]) AS Total_hours
...
where isnumeric([Length]) = 1 
```

请参阅下面的代码。

```
declare @table table (abc varchar(100))
insert into @table
select '1'
union select '200'
union select '200A'

select sum(convert(int,abc))
from @table
where isnumeric(abc) = 1 
```

[sqlfiddle](http://sqlfiddle.com/#!3/bbebc/2/0)

# java - 有没有办法在使用 JAXB 编组时控制属性的顺序？

> ID：14446508
> 
> 赞同：1
> 
> 时间：2013-01-21T20:18:13.700
> 
> 标签：java, jaxb

> **可能重复：**
> [如何使用 JAXB 以特殊顺序制作 @XmlAttribute？](https://stackoverflow.com/questions/10378936/how-can-i-make-xmlattribute-in-a-special-order-by-using-jaxb)

为了可读性，我需要我的编组 xml 看起来像这样：

```
<tag-name name="name" attr1="value1" attr2="value2"/> 
```

现在，当我整理它时，结果如下：

```
<tag-name attr2="value2" attr1="value1" name="name"/> 
```

对此我能做些什么吗？我在[这个问题](https://stackoverflow.com/questions/11217734/reordering-xml-tags)中看到您可以使用`@XmlType(propOrder={"c","b", "a"})`or `@XmlAccessorOrder(XmlAccessOrder.ALPHABETICAL)`，但我认为这些不适用于属性。

我的编组代码如下：

```
public String writeClass(final Foo objectToBeMarshalled) throws JAXBException{
        // marshal
        final JAXBContext context = JAXBContext.newInstance(Foo.class);
        final Marshaller marshaller = context.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE);
        final StringWriter writer = new StringWriter();
        marshaller.marshal(objectToBeMarshalled, writer);
        return writer.toString();
    } 
```

# javascript - 对对象数组进行分组的最有效方法

> ID：14446511
> 
> 赞同：762
> 
> 时间：2013-01-21T20:18:24.187
> 
> 标签：javascript, arrays, object, group-by, underscore.js

对数组中的对象进行分组的最有效方法是什么？

例如，给定这个对象数组：

```
[ 
    { Phase: "Phase 1", Step: "Step 1", Task: "Task 1", Value: "5" },
    { Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" },
    { Phase: "Phase 1", Step: "Step 2", Task: "Task 1", Value: "15" },
    { Phase: "Phase 1", Step: "Step 2", Task: "Task 2", Value: "20" },
    { Phase: "Phase 2", Step: "Step 1", Task: "Task 1", Value: "25" },
    { Phase: "Phase 2", Step: "Step 1", Task: "Task 2", Value: "30" },
    { Phase: "Phase 2", Step: "Step 2", Task: "Task 1", Value: "35" },
    { Phase: "Phase 2", Step: "Step 2", Task: "Task 2", Value: "40" }
] 
```

我在表格中显示此信息。我想对不同的方法进行分组，但我想对这些值求和。

我将 Underscore.js 用于它的 groupby 函数，这很有帮助，但并不能完全解决问题，因为我不希望它们“拆分”而是“合并”，更像 SQL`group by`方法。

我正在寻找的将能够总计特定值（如果需要）。

所以如果我做了 groupby `Phase`，我想收到：

```
[
    { Phase: "Phase 1", Value: 50 },
    { Phase: "Phase 2", Value: 130 }
] 
```

如果我做了 groupy `Phase`/ `Step`，我会收到：

```
[
    { Phase: "Phase 1", Step: "Step 1", Value: 15 },
    { Phase: "Phase 1", Step: "Step 2", Value: 35 },
    { Phase: "Phase 2", Step: "Step 1", Value: 55 },
    { Phase: "Phase 2", Step: "Step 2", Value: 75 }
] 
```

是否有对此有用的脚本，或者我应该坚持使用 Underscore.js，然后循环遍历生成的对象以自己进行总计？

* * *

## 回答 #1

> 赞同：1101
> 
> 时间：2016-01-20T02:02:24.373

如果你想避免使用外部库，你可以简洁地实现一个香草版本，`groupBy()`如下所示：

```
var groupBy = function(xs, key) {
  return xs.reduce(function(rv, x) {
    (rv[x[key]] = rv[x[key]] || []).push(x);
    return rv;
  }, {});
};

console.log(groupBy(['one', 'two', 'three'], 'length'));

// => {3: ["one", "two"], 5: ["three"]}
```

* * *

## 回答 #2

> 赞同：354
> 
> 时间：2016-07-12T11:25:40.023

使用 ES6 Map 对象：

```
/**
 * @description
 * Takes an Array<V>, and a grouping function,
 * and returns a Map of the array grouped by the grouping function.
 *
 * @param list An array of type V.
 * @param keyGetter A Function that takes the the Array type V as an input, and returns a value of type K.
 *                  K is generally intended to be a property key of V.
 *
 * @returns Map of the array grouped by the grouping function.
 */
//export function groupBy<K, V>(list: Array<V>, keyGetter: (input: V) => K): Map<K, Array<V>> {
//    const map = new Map<K, Array<V>>();
function groupBy(list, keyGetter) {
    const map = new Map();
    list.forEach((item) => {
         const key = keyGetter(item);
         const collection = map.get(key);
         if (!collection) {
             map.set(key, [item]);
         } else {
             collection.push(item);
         }
    });
    return map;
}

// example usage

const pets = [
    {type:"Dog", name:"Spot"},
    {type:"Cat", name:"Tiger"},
    {type:"Dog", name:"Rover"}, 
    {type:"Cat", name:"Leo"}
];

const grouped = groupBy(pets, pet => pet.type);

console.log(grouped.get("Dog")); // -> [{type:"Dog", name:"Spot"}, {type:"Dog", name:"Rover"}]
console.log(grouped.get("Cat")); // -> [{type:"Cat", name:"Tiger"}, {type:"Cat", name:"Leo"}]

const odd = Symbol();
const even = Symbol();
const numbers = [1,2,3,4,5,6,7];

const oddEven = groupBy(numbers, x => (x % 2 === 1 ? odd : even));

console.log(oddEven.get(odd)); // -> [1,3,5,7]
console.log(oddEven.get(even)); // -> [2,4,6]
```

关于地图： [https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map)

* * *

## 回答 #3

> 赞同：151
> 
> 时间：2017-09-26T16:50:14.950

使用 ES6：

```
const groupBy = (items, key) => items.reduce(
  (result, item) => ({
    ...result,
    [item[key]]: [
      ...(result[item[key]] || []),
      item,
    ],
  }), 
  {},
); 
```

* * *

## 回答 #4

> 赞同：90
> 
> 时间：2017-12-11T12:11:58.880

你可以`Map`从`array.reduce()`.

```
const groupedMap = initialArray.reduce(
    (entryMap, e) => entryMap.set(e.id, [...entryMap.get(e.id)||[], e]),
    new Map()
); 
```

与其他解决方案相比，这具有一些优势：

*   它不需要任何库（不像 eg `_.groupBy()`）
*   你得到的是一个 JavaScript`Map`而不是一个对象（例如由返回的`_.groupBy()`）。这有[很多好处](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map#Objects_and_maps_compared)，包括：
    *   它会记住第一次添加项目的顺序，
    *   键可以是任何类型，而不仅仅是字符串。
*   A`Map`是比数组数组更有用的结果。但是，如果您确实想要一个数组数组，则可以调用`Array.from(groupedMap.entries())`（对于一`[key, group array]`对数组）或`Array.from(groupedMap.values())`（对于一个简单的数组数组）。
*   它非常灵活；通常，您计划接下来使用此地图执行的任何操作都可以作为缩减的一部分直接完成。

作为最后一点的示例，假设我有一个对象数组，我想通过 id 进行（浅）合并，如下所示：

```
const objsToMerge = [{id: 1, name: "Steve"}, {id: 2, name: "Alice"}, {id: 1, age: 20}];
// The following variable should be created automatically
const mergedArray = [{id: 1, name: "Steve", age: 20}, {id: 2, name: "Alice"}] 
```

为此，我通常会先按 id 分组，然后合并每个结果数组。相反，您可以直接在以下位置进行合并`reduce()`：

```
const mergedArray = Array.from(
    objsToMerge.reduce(
        (entryMap, e) => entryMap.set(e.id, {...entryMap.get(e.id)||{}, ...e}),
        new Map()
    ).values()
); 
```

* * *

## 回答 #5

> 赞同：73
> 
> 时间：2016-01-08T00:06:58.143

我会检查[lodash groupBy](https://lodash.com/docs#groupBy)它似乎完全符合您的要求。它也非常轻巧且非常简单。

小提琴示例：[https ://jsfiddle.net/r7szvt5k/](https://jsfiddle.net/r7szvt5k/)

假设您的数组名称是`arr`带有 lodash 的 groupBy 只是：

```
import groupBy from 'lodash/groupBy';
// if you still use require:
// const groupBy = require('lodash/groupBy');

const a = groupBy(arr, function(n) {
  return n.Phase;
});
// a is your array grouped by Phase attribute 
```

* * *

## 回答 #6

> 赞同：62
> 
> 时间：2013-01-23T16:21:41.723

尽管[linq](http://linqjs.codeplex.com/)的答案很有趣，但它也很重。我的方法有些不同：

```
var DataGrouper = (function() {
    var has = function(obj, target) {
        return _.any(obj, function(value) {
            return _.isEqual(value, target);
        });
    };

    var keys = function(data, names) {
        return _.reduce(data, function(memo, item) {
            var key = _.pick(item, names);
            if (!has(memo, key)) {
                memo.push(key);
            }
            return memo;
        }, []);
    };

    var group = function(data, names) {
        var stems = keys(data, names);
        return _.map(stems, function(stem) {
            return {
                key: stem,
                vals:_.map(_.where(data, stem), function(item) {
                    return _.omit(item, names);
                })
            };
        });
    };

    group.register = function(name, converter) {
        return group[name] = function(data, names) {
            return _.map(group(data, names), converter);
        };
    };

    return group;
}());

DataGrouper.register("sum", function(item) {
    return _.extend({}, item.key, {Value: _.reduce(item.vals, function(memo, node) {
        return memo + Number(node.Value);
    }, 0)});
}); 
```

[您可以在 JSBin 上](http://jsbin.com/usepej/1/edit)看到它的实际效果。

我没有在 Underscore 中看到任何`has`功能，尽管我可能会错过它。它与 非常相似`_.contains`，但用于比较`_.isEqual`而不是`===`用于比较。除此之外，其余的都是特定于问题的，尽管试图是通用的。

现在`DataGrouper.sum(data, ["Phase"])`返回

```
[
    {Phase: "Phase 1", Value: 50},
    {Phase: "Phase 2", Value: 130}
] 
```

并`DataGrouper.sum(data, ["Phase", "Step"])`返回

```
[
    {Phase: "Phase 1", Step: "Step 1", Value: 15},
    {Phase: "Phase 1", Step: "Step 2", Value: 35},
    {Phase: "Phase 2", Step: "Step 1", Value: 55},
    {Phase: "Phase 2", Step: "Step 2", Value: 75}
] 
```

* * *

但这`sum`只是这里的一个潜在功能。您可以随意注册其他人：

```
DataGrouper.register("max", function(item) {
    return _.extend({}, item.key, {Max: _.reduce(item.vals, function(memo, node) {
        return Math.max(memo, Number(node.Value));
    }, Number.NEGATIVE_INFINITY)});
}); 
```

现在`DataGrouper.max(data, ["Phase", "Step"])`会回来

```
[
    {Phase: "Phase 1", Step: "Step 1", Max: 10},
    {Phase: "Phase 1", Step: "Step 2", Max: 20},
    {Phase: "Phase 2", Step: "Step 1", Max: 30},
    {Phase: "Phase 2", Step: "Step 2", Max: 40}
] 
```

或者如果您注册了这个：

```
DataGrouper.register("tasks", function(item) {
    return _.extend({}, item.key, {Tasks: _.map(item.vals, function(item) {
      return item.Task + " (" + item.Value + ")";
    }).join(", ")});
}); 
```

然后打电话`DataGrouper.tasks(data, ["Phase", "Step"])`会给你

```
[
    {Phase: "Phase 1", Step: "Step 1", Tasks: "Task 1 (5), Task 2 (10)"},
    {Phase: "Phase 1", Step: "Step 2", Tasks: "Task 1 (15), Task 2 (20)"},
    {Phase: "Phase 2", Step: "Step 1", Tasks: "Task 1 (25), Task 2 (30)"},
    {Phase: "Phase 2", Step: "Step 2", Tasks: "Task 1 (35), Task 2 (40)"}
] 
```

`DataGrouper`本身就是一个函数。您可以使用您的数据和要分组的属性列表来调用它。它返回一个数组，其元素是具有两个属性的对象：`key`是分组属性的集合，`vals`是包含不在键中的其余属性的对象数组。例如，`DataGrouper(data, ["Phase", "Step"])`将产生：

```
[
    {
        "key": {Phase: "Phase 1", Step: "Step 1"},
        "vals": [
            {Task: "Task 1", Value: "5"},
            {Task: "Task 2", Value: "10"}
        ]
    },
    {
        "key": {Phase: "Phase 1", Step: "Step 2"},
        "vals": [
            {Task: "Task 1", Value: "15"}, 
            {Task: "Task 2", Value: "20"}
        ]
    },
    {
        "key": {Phase: "Phase 2", Step: "Step 1"},
        "vals": [
            {Task: "Task 1", Value: "25"},
            {Task: "Task 2", Value: "30"}
        ]
    },
    {
        "key": {Phase: "Phase 2", Step: "Step 2"},
        "vals": [
            {Task: "Task 1", Value: "35"}, 
            {Task: "Task 2", Value: "40"}
        ]
    }
] 
```

`DataGrouper.register`接受一个函数并创建一个新函数，该函数接受初始数据和要分组的属性。然后，这个新函数采用上述输出格式，并依次针对每个函数运行您的函数，返回一个新数组。生成的函数`DataGrouper`根据您提供的名称存储为 的属性，如果您只需要本地引用，也会返回该函数。

好吧，这是很多解释。代码相当简单，我希望！

* * *

## 回答 #7

> 赞同：51
> 
> 时间：2013-01-21T20:48:17.660

这可能更容易完成[**`linq.js`**](https://github.com/neuecc/linq.js)，它旨在成为 JavaScript 中 LINQ 的真正实现（[**DEMO**](http://jsfiddle.net/n8vEt/)）：

```
var linq = Enumerable.From(data);
var result =
    linq.GroupBy(function(x){ return x.Phase; })
        .Select(function(x){
          return {
            Phase: x.Key(),
            Value: x.Sum(function(y){ return y.Value|0; })
          };
        }).ToArray(); 
```

结果：

```
[
    { Phase: "Phase 1", Value: 50 },
    { Phase: "Phase 2", Value: 130 }
] 
```

或者，更简单地使用基于字符串的选择器（[**DEMO**](http://jsfiddle.net/n8vEt/1/)）：

```
linq.GroupBy("$.Phase", "",
    "k,e => { Phase:k, Value:e.Sum('$.Value|0') }").ToArray(); 
```

* * *

## 回答 #8

> 赞同：37
> 
> 时间：2020-10-22T19:48:57.343

### GroupBy *one-liner*，一种**ES2021**解决方案

```
const groupBy = (x,f)=>x.reduce((a,b)=>((a[f(b)]||=[]).push(b),a),{}); 
```

#### 打字稿

```
const groupBy = <T>(array: T[], predicate: (v: T) => string) =>
  array.reduce((acc, value) => {
    (acc[predicate(value)] ||= []).push(value);
    return acc;
  }, {} as { [key: string]: T[] }); 
```

**例子**

```
const groupBy = (x, f) => x.reduce((a, b) => ((a[f(b)] ||= []).push(b), a), {});
// f -> should must return string/number because it will be use as key in object

// for demo

groupBy([1, 2, 3, 4, 5, 6, 7, 8, 9], v => (v % 2 ? "odd" : "even"));
// { odd: [1, 3, 5, 7, 9], even: [2, 4, 6, 8] };
const colors = [
  "Apricot",
  "Brown",
  "Burgundy",
  "Cerulean",
  "Peach",
  "Pear",
  "Red",
];

groupBy(colors, v => v[0]); // group by colors name first letter
// {
//   A: ["Apricot"],
//   B: ["Brown", "Burgundy"],
//   C: ["Cerulean"],
//   P: ["Peach", "Pear"],
//   R: ["Red"],
// };
groupBy(colors, v => v.length); // group by length of color names
// {
//   3: ["Red"],
//   4: ["Pear"],
//   5: ["Brown", "Peach"],
//   7: ["Apricot"],
//   8: ["Burgundy", "Cerulean"],
// }

const data = [
  { comment: "abc", forItem: 1, inModule: 1 },
  { comment: "pqr", forItem: 1, inModule: 1 },
  { comment: "klm", forItem: 1, inModule: 2 },
  { comment: "xyz", forItem: 1, inModule: 2 },
];

groupBy(data, v => v.inModule); // group by module
// {
//   1: [
//     { comment: "abc", forItem: 1, inModule: 1 },
//     { comment: "pqr", forItem: 1, inModule: 1 },
//   ],
//   2: [
//     { comment: "klm", forItem: 1, inModule: 2 },
//     { comment: "xyz", forItem: 1, inModule: 2 },
//   ],
// }

groupBy(data, x => x.forItem + "-" + x.inModule); // group by module with item
// {
//   "1-1": [
//     { comment: "abc", forItem: 1, inModule: 1 },
//     { comment: "pqr", forItem: 1, inModule: 1 },
//   ],
//   "1-2": [
//     { comment: "klm", forItem: 1, inModule: 2 },
//     { comment: "xyz", forItem: 1, inModule: 2 },
//   ],
// } 
```

* * *

## 回答 #9

> 赞同：30
> 
> 时间：2018-09-13T15:14:09.233

MDN在他们的文档中有[这个例子。](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce#Grouping_objects_by_a_property)`Array.reduce()`

```
// Grouping objects by a property
// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce#Grouping_objects_by_a_property#Grouping_objects_by_a_property

var people = [
  { name: 'Alice', age: 21 },
  { name: 'Max', age: 20 },
  { name: 'Jane', age: 20 }
];

function groupBy(objectArray, property) {
  return objectArray.reduce(function (acc, obj) {
    var key = obj[property];
    if (!acc[key]) {
      acc[key] = [];
    }
    acc[key].push(obj);
    return acc;
  }, {});
}

var groupedPeople = groupBy(people, 'age');
// groupedPeople is:
// { 
//   20: [
//     { name: 'Max', age: 20 }, 
//     { name: 'Jane', age: 20 }
//   ], 
//   21: [{ name: 'Alice', age: 21 }] 
// } 
```

* * *

## 回答 #10

> 赞同：26
> 
> 时间：2014-11-12T13:54:30.303

```
_.groupBy([{tipo: 'A' },{tipo: 'A'}, {tipo: 'B'}], 'tipo');
>> Object {A: Array[2], B: Array[1]} 
```

来自：[http ://underscorejs.org/#groupBy](http://underscorejs.org/#groupBy)

* * *

## 回答 #11

> 赞同：22
> 
> 时间：2015-06-26T20:15:10.703

```
Array.prototype.groupBy = function(keyFunction) {
    var groups = {};
    this.forEach(function(el) {
        var key = keyFunction(el);
        if (key in groups == false) {
            groups[key] = [];
        }
        groups[key].push(el);
    });
    return Object.keys(groups).map(function(key) {
        return {
            key: key,
            values: groups[key]
        };
    });
}; 
```

* * *

## 回答 #12

> 赞同：20
> 
> 时间：2014-12-23T09:09:46.480

你可以使用[Alasql](http://github.com/agershun/alasql) JavaScript 库来做到这一点：

```
var data = [ { Phase: "Phase 1", Step: "Step 1", Task: "Task 1", Value: "5" },
             { Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" }];

var res = alasql('SELECT Phase, Step, SUM(CAST([Value] AS INT)) AS [Value] \
                  FROM ? GROUP BY Phase, Step',[data]); 
```

[在 jsFiddle](http://jsfiddle.net/agershun/ztc32a8h/1/)试试这个例子。

***顺便说一句：***在大型数组（100000 条记录及更多）上，Alasql 比 Linq 更快。请参阅[jsPref 的](http://jsperf.com/alasql-vs-linq-on-groupby)测试。

评论：

*   这里我把Value放在方括号里，因为VALUE是SQL中的关键字
*   我必须使用 CAST() 函数将字符串值转换为数字类型。

* * *

## 回答 #13

> 赞同：17
> 
> 时间：2016-03-13T12:38:15.503

一种较新的方法，其中包含一个用于分组的对象和另外两个函数来创建一个键并获取一个具有所需分组项的对象和另一个用于增加值的键。

```
const
    groupBy = (array, groups, valueKey) => {
        const
            getKey = o => groups.map(k => o[k]).join('|'),
            getObject = o => Object.fromEntries([...groups.map(k => [k, o[k]]), [valueKey, 0]]);

        groups = [].concat(groups);

        return Object.values(array.reduce((r, o) => {
            (r[getKey(o)] ??= getObject(o))[valueKey] += +o[valueKey];
            return r;
        }, {}));
    },
    data = [{ Phase: "Phase 1", Step: "Step 1", Task: "Task 1", Value: "5" }, { Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" }, { Phase: "Phase 1", Step: "Step 2", Task: "Task 1", Value: "15" }, { Phase: "Phase 1", Step: "Step 2", Task: "Task 2", Value: "20" }, { Phase: "Phase 2", Step: "Step 1", Task: "Task 1", Value: "25" }, { Phase: "Phase 2", Step: "Step 1", Task: "Task 2", Value: "30" }, { Phase: "Phase 2", Step: "Step 2", Task: "Task 1", Value: "35" }, { Phase: "Phase 2", Step: "Step 2", Task: "Task 2", Value: "40" }];

console.log(groupBy(data, 'Phase', 'Value'));
console.log(groupBy(data, ['Phase', 'Step'], 'Value'));
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

旧方法：

虽然这个问题有一些答案，而且答案看起来有点复杂，但我建议使用 vanilla Javascript 进行 group-by 和嵌套（如有必要）[`Map`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map)。

```
function groupBy(array, groups, valueKey) {
    var map = new Map;
    groups = [].concat(groups);
    return array.reduce((r, o) => {
        groups.reduce((m, k, i, { length }) => {
            var child;
            if (m.has(o[k])) return m.get(o[k]);
            if (i + 1 === length) {
                child = Object
                    .assign(...groups.map(k => ({ [k]: o[k] })), { [valueKey]: 0 });
                r.push(child);
            } else {
                child = new Map;
            }
            m.set(o[k], child);
            return child;
        }, map)[valueKey] += +o[valueKey];
        return r;
    }, [])
};

var data = [{ Phase: "Phase 1", Step: "Step 1", Task: "Task 1", Value: "5" }, { Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" }, { Phase: "Phase 1", Step: "Step 2", Task: "Task 1", Value: "15" }, { Phase: "Phase 1", Step: "Step 2", Task: "Task 2", Value: "20" }, { Phase: "Phase 2", Step: "Step 1", Task: "Task 1", Value: "25" }, { Phase: "Phase 2", Step: "Step 1", Task: "Task 2", Value: "30" }, { Phase: "Phase 2", Step: "Step 2", Task: "Task 1", Value: "35" }, { Phase: "Phase 2", Step: "Step 2", Task: "Task 2", Value: "40" }];

console.log(groupBy(data, 'Phase', 'Value'));
console.log(groupBy(data, ['Phase', 'Step'], 'Value'));
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

* * *

## 回答 #14

> 赞同：16
> 
> 时间：2021-08-19T19:54:48.333

有点晚了，但也许有人喜欢这个。

ES6：

```
const users = [{
    name: "Jim",
    color: "blue"
  },
  {
    name: "Sam",
    color: "blue"
  },
  {
    name: "Eddie",
    color: "green"
  },
  {
    name: "Robert",
    color: "green"
  },
];
const groupBy = (arr, key) => {
  const initialValue = {};
  return arr.reduce((acc, cval) => {
    const myAttribute = cval[key];
    acc[myAttribute] = [...(acc[myAttribute] || []), cval]
    return acc;
  }, initialValue);
};

const res = groupBy(users, "color");
console.log("group by:", res);
```

* * *

## 回答 #15

> 赞同：14
> 
> 时间：2018-10-13T21:25:27.667

检查答案 - 只是浅分组。理解减少非常好。问题还提供了额外聚合计算的问题。

这是一个 REAL GROUP BY 对象数组，由一些字段组成，1）计算的键名和 2）通过提供所需键的列表并将其唯一值转换为根键（如 SQL GROUP）来实现分组级联的完整解决方案BY 确实如此。

```
const inputArray = [ 
    { Phase: "Phase 1", Step: "Step 1", Task: "Task 1", Value: "5" },
    { Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" },
    { Phase: "Phase 1", Step: "Step 2", Task: "Task 1", Value: "15" },
    { Phase: "Phase 1", Step: "Step 2", Task: "Task 2", Value: "20" },
    { Phase: "Phase 2", Step: "Step 1", Task: "Task 1", Value: "25" },
    { Phase: "Phase 2", Step: "Step 1", Task: "Task 2", Value: "30" },
    { Phase: "Phase 2", Step: "Step 2", Task: "Task 1", Value: "35" },
    { Phase: "Phase 2", Step: "Step 2", Task: "Task 2", Value: "40" }
];

var outObject = inputArray.reduce(function(a, e) {
  // GROUP BY estimated key (estKey), well, may be a just plain key
  // a -- Accumulator result object
  // e -- sequentally checked Element, the Element that is tested just at this itaration

  // new grouping name may be calculated, but must be based on real value of real field
  let estKey = (e['Phase']); 

  (a[estKey] ? a[estKey] : (a[estKey] = null || [])).push(e);
  return a;
}, {});

console.log(outObject);
```

玩`estKey`——您可以按多个字段进行分组，添加额外的聚合、计算或其他处理。

您也可以递归地对数据进行分组。例如最初按 分组`Phase`，然后按`Step`字段等。另外吹掉脂肪休息数据。

```
const inputArray = [
{ Phase: "Phase 1", Step: "Step 1", Task: "Task 1", Value: "5" },
{ Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" },
{ Phase: "Phase 1", Step: "Step 2", Task: "Task 1", Value: "15" },
{ Phase: "Phase 1", Step: "Step 2", Task: "Task 2", Value: "20" },
{ Phase: "Phase 2", Step: "Step 1", Task: "Task 1", Value: "25" },
{ Phase: "Phase 2", Step: "Step 1", Task: "Task 2", Value: "30" },
{ Phase: "Phase 2", Step: "Step 2", Task: "Task 1", Value: "35" },
{ Phase: "Phase 2", Step: "Step 2", Task: "Task 2", Value: "40" }
  ];

/**
 * Small helper to get SHALLOW copy of obj WITHOUT prop
 */
const rmProp = (obj, prop) => ( (({[prop]:_, ...rest})=>rest)(obj) )

/**
 * Group Array by key. Root keys of a resulting array is value
 * of specified key.
 *
 * @param      {Array}   src     The source array
 * @param      {String}  key     The by key to group by
 * @return     {Object}          Object with grouped objects as values
 */
const grpBy = (src, key) => src.reduce((a, e) => (
  (a[e[key]] = a[e[key]] || []).push(rmProp(e, key)),  a
), {});

/**
 * Collapse array of object if it consists of only object with single value.
 * Replace it by the rest value.
 */
const blowObj = obj => Array.isArray(obj) && obj.length === 1 && Object.values(obj[0]).length === 1 ? Object.values(obj[0])[0] : obj;

/**
 * Recursive grouping with list of keys. `keyList` may be an array
 * of key names or comma separated list of key names whom UNIQUE values will
 * becomes the keys of the resulting object.
 */
const grpByReal = function (src, keyList) {
  const [key, ...rest] = Array.isArray(keyList) ? keyList : String(keyList).trim().split(/\s*,\s*/);
  const res = key ? grpBy(src, key) : [...src];
  if (rest.length) {
for (const k in res) {
  res[k] = grpByReal(res[k], rest)
}
  } else {
for (const k in res) {
  res[k] = blowObj(res[k])
}
  }
  return res;
}

console.log( JSON.stringify( grpByReal(inputArray, 'Phase, Step, Task'), null, 2 ) );
```

* * *

## 回答 #16

> 赞同：14
> 
> 时间：2019-07-16T06:52:45.713

这是一个使用 ES6 的令人讨厌的、难以阅读的解决方案：

```
export default (arr, key) => 
  arr.reduce(
    (r, v, _, __, k = v[key]) => ((r[k] || (r[k] = [])).push(v), r),
    {}
  ); 
```

对于那些询问这**甚至**如何工作的人，这里有一个解释：

*   在这两者中`=>`，您都有免费的`return`

*   该`Array.prototype.reduce`函数最多需要 4 个参数。这就是为什么要添加第五个参数的原因，因此我们可以使用默认值在参数声明级别为组 (k) 进行廉价的变量声明。（是的，这是巫术）

*   如果我们当前的组在上一次迭代中不存在，我们创建一个新的空数组`((r[k] || (r[k] = []))`这将评估最左边的表达式，*换句话说，一个现有的数组或一个空数组*，这就是为什么`push`在那个表达式之后有一个立即，因为无论哪种方式，您都会得到一个数组。

*   当有 a`return`时，逗号`,`运算符将丢弃最左边的值，返回此场景中调整后的前一个组。

一个更容易理解的版本是：

```
export default (array, key) => 
  array.reduce((previous, currentItem) => {
    const group = currentItem[key];
    if (!previous[group]) previous[group] = [];
    previous[group].push(currentItem);
    return previous;
  }, {}); 
```

编辑：

TS版本：

```
const groupBy = <T, K extends keyof any>(list: T[], getKey: (item: T) => K) =>
  list.reduce((previous, currentItem) => {
    const group = getKey(currentItem);
    if (!previous[group]) previous[group] = [];
    previous[group].push(currentItem);
    return previous;
  }, {} as Record<K, T[]>); 
```

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2013-10-25T09:27:15.700

我想建议我的方法。首先，单独分组和聚合。让我们声明原型的“分组依据”功能。它需要另一个函数来为要分组的每个数组元素生成“哈希”字符串。

```
Array.prototype.groupBy = function(hash){
  var _hash = hash ? hash : function(o){return o;};

  var _map = {};
  var put = function(map, key, value){
    if (!map[_hash(key)]) {
        map[_hash(key)] = {};
        map[_hash(key)].group = [];
        map[_hash(key)].key = key;

    }
    map[_hash(key)].group.push(value); 
  }

  this.map(function(obj){
    put(_map, obj, obj);
  });

  return Object.keys(_map).map(function(key){
    return {key: _map[key].key, group: _map[key].group};
  });
} 
```

分组完成后，您可以根据需要聚合数据

```
data.groupBy(function(o){return JSON.stringify({a: o.Phase, b: o.Step});})
    /* aggreagating */
    .map(function(el){ 
         var sum = el.group.reduce(
           function(l,c){
             return l + parseInt(c.Value);
           },
           0
         );
         el.key.Value = sum; 
         return el.key;
    }); 
```

共同点是有效的。我已经在 chrome 控制台中测试了这段代码。并随时改进和发现错误；）

* * *

## 回答 #18

> 赞同：9
> 
> 时间：2017-04-04T19:00:04.093

没有突变：

```
const groupBy = (xs, key) => xs.reduce((acc, x) => Object.assign({}, acc, {
  [x[key]]: (acc[x[key]] || []).concat(x)
}), {})

console.log(groupBy(['one', 'two', 'three'], 'length'));
// => {3: ["one", "two"], 5: ["three"]} 
```

* * *

## 回答 #19

> 赞同：9
> 
> 时间：2017-04-19T20:44:33.493

此解决方案采用任意函数（不是键），因此比上述解决方案更灵活，并允许使用[*箭头函数*](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions)，类似于**LINQ**中使用的[*lambda 表达式*](https://msdn.microsoft.com/en-us/library/bb397687.aspx)：

 **```
Array.prototype.groupBy = function (funcProp) {
    return this.reduce(function (acc, val) {
        (acc[funcProp(val)] = acc[funcProp(val)] || []).push(val);
        return acc;
    }, {});
}; 
```

注意：是否要扩展`Array`的原型取决于您。

**大多数浏览器支持的示例：**

```
[{a:1,b:"b"},{a:1,c:"c"},{a:2,d:"d"}].groupBy(function(c){return c.a;}) 
```

**使用箭头函数 (ES6) 的示例：**

```
[{a:1,b:"b"},{a:1,c:"c"},{a:2,d:"d"}].groupBy(c=>c.a) 
```

上面的两个例子都返回：

```
{
  "1": [{"a": 1, "b": "b"}, {"a": 1, "c": "c"}],
  "2": [{"a": 2, "d": "d"}]
} 
```

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2016-08-03T10:55:18.793

```
groupByArray(xs, key) {
    return xs.reduce(function (rv, x) {
        let v = key instanceof Function ? key(x) : x[key];
        let el = rv.find((r) => r && r.key === v);
        if (el) {
            el.values.push(x);
        }
        else {
            rv.push({
                key: v,
                values: [x]
            });
        }
        return rv;
    }, []);
} 
```

这个输出数组。

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2019-10-08T01:31:48.203

想象一下，你有这样的东西：

`[{id:1, cat:'sedan'},{id:2, cat:'sport'},{id:3, cat:'sport'},{id:4, cat:'sedan'}]`

通过做这个： `const categories = [...new Set(cars.map((car) => car.cat))]`

你会得到这个： `['sedan','sport']`

**说明：** 1\. 首先，我们通过传递一个数组来创建一个新的 Set。因为 Set 只允许唯一值，所以所有重复项都将被删除。

2.  现在重复项消失了，我们将使用扩展运算符将其转换回数组...

设置文档：[https](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set) ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/设置 传播运算符文档： [https ://developer.mozilla.org/en-US/docs/Web/JavaScript /参考/运算符/Spread_syntax](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax)

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2017-12-29T11:20:40.513

根据以前的答案

```
const groupBy = (prop) => (xs) =>
  xs.reduce((rv, x) =>
    Object.assign(rv, {[x[prop]]: [...(rv[x[prop]] || []), x]}), {}); 
```

如果您的环境支持，使用对象扩展语法查看会更好一些。

```
const groupBy = (prop) => (xs) =>
  xs.reduce((acc, x) => ({
    ...acc,
    [ x[ prop ] ]: [...( acc[ x[ prop ] ] || []), x],
  }), {}); 
```

在这里，我们的 reducer 采用部分形成的返回值（从一个空对象开始），并返回一个由前一个返回值的展开成员组成的对象，以及一个新成员，其键是根据当前 iteree 的值计算得出的`prop`并且其值是该道具的所有值以及当前值的列表。

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2020-10-16T11:54:40.950

我不认为给出的答案是对问题的回应，我认为以下内容应该回答第一部分：

```
const arr = [ 
{ Phase: "Phase 1", Step: "Step 1", Task: "Task 1", Value: "5" },
{ Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" },
{ Phase: "Phase 1", Step: "Step 2", Task: "Task 1", Value: "15" },
{ Phase: "Phase 1", Step: "Step 2", Task: "Task 2", Value: "20" },
{ Phase: "Phase 2", Step: "Step 1", Task: "Task 1", Value: "25" },
{ Phase: "Phase 2", Step: "Step 1", Task: "Task 2", Value: "30" },
{ Phase: "Phase 2", Step: "Step 2", Task: "Task 1", Value: "35" },
{ Phase: "Phase 2", Step: "Step 2", Task: "Task 2", Value: "40" }
]

const groupBy = (key) => arr.reduce((total, currentValue) => {
  const newTotal = total;
  if (
    total.length &&
    total[total.length - 1][key] === currentValue[key]
  )
    newTotal[total.length - 1] = {
      ...total[total.length - 1],
      ...currentValue,
      Value: parseInt(total[total.length - 1].Value) + parseInt(currentValue.Value),
    };
  else newTotal[total.length] = currentValue;
  return newTotal;
}, []);

console.log(groupBy('Phase'));

// => [{ Phase: "Phase 1", Value: 50 },{ Phase: "Phase 2", Value: 130 }]
```

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2021-02-09T02:39:28.603

让我们在重用已经编写的代码（即下划线）的同时充分回答原始问题。*如果您将*其超过 100 个功能结合起来，您可以使用 Underscore 做更多的事情。以下解决方案证明了这一点。

第 1 步：通过属性的任意组合对数组中的对象进行分组。[`_.groupBy`](https://underscorejs.org/#groupBy)这使用了接受返回对象组的函数的事实。它还使用[`_.chain`](https://underscorejs.org/#chain)、[`_.pick`](https://underscorejs.org/#pick)、[`_.values`](https://underscorejs.org/#values)和[`_.join`](https://underscorejs.org/#chaining)。[`_.value`](https://underscorejs.org/#value)请注意，`_.value`此处并非严格要求，因为链式值在用作属性名称时会自动展开。我将它包括在内是为了防止混淆，以防有人试图在不发生自动展开的上下文中编写类似的代码。

```
// Given an object, return a string naming the group it belongs to.
function category(obj) {
    return _.chain(obj).pick(propertyNames).values().join(' ').value();
}

// Perform the grouping.
const intermediate = _.groupBy(arrayOfObjects, category); 
```

给定`arrayOfObjects`原始问题中的 并设置`propertyNames`为`['Phase', 'Step']`，`intermediate`将获得以下值：

```
{
    "Phase 1 Step 1": [
        { Phase: "Phase 1", Step: "Step 1", Task: "Task 1", Value: "5" },
        { Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" }
    ],
    "Phase 1 Step 2": [
        { Phase: "Phase 1", Step: "Step 2", Task: "Task 1", Value: "15" },
        { Phase: "Phase 1", Step: "Step 2", Task: "Task 2", Value: "20" }
    ],
    "Phase 2 Step 1": [
        { Phase: "Phase 2", Step: "Step 1", Task: "Task 1", Value: "25" },
        { Phase: "Phase 2", Step: "Step 1", Task: "Task 2", Value: "30" }
    ],
    "Phase 2 Step 2": [
        { Phase: "Phase 2", Step: "Step 2", Task: "Task 1", Value: "35" },
        { Phase: "Phase 2", Step: "Step 2", Task: "Task 2", Value: "40" }
    ]
} 
```

第 2 步：将每个组缩减为单个平面对象，并将结果以数组的形式返回。除了我们之前看到的函数之外，下面的代码还使用了[`_.pluck`](https://underscorejs.org/#pluck)、[`_.first`](https://underscorejs.org/#first)、[`_.pick`](https://underscorejs.org/#pick)、和。在这种情况下保证返回一个对象，因为不会产生空组。在这种情况下是必要的。[`_.extend`](https://underscorejs.org/#extend)[`_.reduce`](https://underscorejs.org/#reduce)[`_.map`](https://underscorejs.org/#map)`_.first``_.groupBy``_.value`

```
// Sum two numbers, even if they are contained in strings.
const addNumeric = (a, b) => +a + +b;

// Given a `group` of objects, return a flat object with their common
// properties and the sum of the property with name `aggregateProperty`.
function summarize(group) {
    const valuesToSum = _.pluck(group, aggregateProperty);
    return _.chain(group).first().pick(propertyNames).extend({
        [aggregateProperty]: _.reduce(valuesToSum, addNumeric)
    }).value();
}

// Get an array with all the computed aggregates.
const result = _.map(intermediate, summarize); 
```

鉴于`intermediate`我们之前获得的 并设置`aggregateProperty`为`Value`，我们得到`result`了提问者想要的：

```
[
    { Phase: "Phase 1", Step: "Step 1", Value: 15 },
    { Phase: "Phase 1", Step: "Step 2", Value: 35 },
    { Phase: "Phase 2", Step: "Step 1", Value: 55 },
    { Phase: "Phase 2", Step: "Step 2", Value: 75 }
] 
```

我们可以将所有这些放在一个以和作为参数的函数`arrayOfObjects`中。请注意，它实际上也可以是带有字符串键的普通对象，因为两者都可以接受。为此，我已重命名为.`propertyNames``aggregateProperty``arrayOfObjects``_.groupBy``arrayOfObjects``collection`

```
function aggregate(collection, propertyNames, aggregateProperty) {
    function category(obj) {
        return _.chain(obj).pick(propertyNames).values().join(' ');
    }
    const addNumeric = (a, b) => +a + +b;
    function summarize(group) {
        const valuesToSum = _.pluck(group, aggregateProperty);
        return _.chain(group).first().pick(propertyNames).extend({
            [aggregateProperty]: _.reduce(valuesToSum, addNumeric)
        }).value();
    }
    return _.chain(collection).groupBy(category).map(summarize).value();
} 
```

`aggregate(arrayOfObjects, ['Phase', 'Step'], 'Value')`现在将`result`再次给我们同样的。

我们可以更进一步，使调用者能够计算每个组中值的*任何统计数据。*我们可以这样做并且还允许调用者将任意属性添加到每个组的摘要中。我们可以在*缩短*代码的同时完成所有这些工作。我们用参数替换`aggregateProperty`参数`iteratee`并将其直接传递给`_.reduce`：

```
function aggregate(collection, propertyNames, iteratee) {
    function category(obj) {
        return _.chain(obj).pick(propertyNames).values().join(' ');
    }
    function summarize(group) {
        return _.chain(group).first().pick(propertyNames)
            .extend(_.reduce(group, iteratee)).value();
    }
    return _.chain(collection).groupBy(category).map(summarize).value();
} 
```

实际上，我们将一些责任转移给了调用者；她必须提供一个`iteratee`可以传递给 的`_.reduce`，以便调用`_.reduce`将产生一个具有她想要添加的聚合属性的对象。例如，我们通过`result`以下表达式获得与之前相同的结果：

```
aggregate(arrayOfObjects, ['Phase', 'Step'], (memo, value) => ({
    Value: +memo.Value + +value.Value
})); 
```

对于稍微复杂一点的例子`iteratee`，假设我们想要计算每个组的*最大值* `Value`而不是总和，并且我们想要添加一个`Tasks`属性来列出`Task`组中出现的所有值。这是我们可以做到这一点的一种方法，使用`aggregate`上面的最后一个版本（和[`_.union`](https://underscorejs.org/#union)）：

```
aggregate(arrayOfObjects, ['Phase', 'Step'], (memo, value) => ({
    Value: Math.max(memo.Value, value.Value),
    Tasks: _.union(memo.Tasks || [memo.Task], [value.Task])
})); 
```

我们得到以下结果：

```
[
    { Phase: "Phase 1", Step: "Step 1", Value: 10, Tasks: [ "Task 1", "Task 2" ] },
    { Phase: "Phase 1", Step: "Step 2", Value: 20, Tasks: [ "Task 1", "Task 2" ] },
    { Phase: "Phase 2", Step: "Step 1", Value: 30, Tasks: [ "Task 1", "Task 2" ] },
    { Phase: "Phase 2", Step: "Step 2", Value: 40, Tasks: [ "Task 1", "Task 2" ] }
] 
```

感谢@much2learn，他还发布了一个可以处理任意归约函数的[答案。](https://stackoverflow.com/a/62393557/1166087)我又写了几个 SO 答案，展示了如何通过组合多个下划线函数来实现复杂的事情：

*   [https://stackoverflow.com/a/64938636/1166087](https://stackoverflow.com/a/64938636/1166087)
*   [https://stackoverflow.com/a/64094738/1166087](https://stackoverflow.com/a/64094738/1166087)
*   [https://stackoverflow.com/a/63625129/1166087](https://stackoverflow.com/a/63625129/1166087)
*   [https://stackoverflow.com/a/63088916/1166087](https://stackoverflow.com/a/63088916/1166087)

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2021-04-07T13:36:32.980

`groupBy`可以通过特定键或给定分组函数对数组进行分组的函数。打字。

```
groupBy = <T, K extends keyof T>(array: T[], groupOn: K | ((i: T) => string)): Record<string, T[]> => {
  const groupFn = typeof groupOn === 'function' ? groupOn : (o: T) => o[groupOn];

  return Object.fromEntries(
    array.reduce((acc, obj) => {
      const groupKey = groupFn(obj);
      return acc.set(groupKey, [...(acc.get(groupKey) || []), obj]);
    }, new Map())
  ) as Record<string, T[]>;
}; 
```

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2018-04-14T18:39:16.017

```
Array.prototype.groupBy = function (groupingKeyFn) {
    if (typeof groupingKeyFn !== 'function') {
        throw new Error("groupBy take a function as only parameter");
    }
    return this.reduce((result, item) => {
        let key = groupingKeyFn(item);
        if (!result[key])
            result[key] = [];
        result[key].push(item);
        return result;
    }, {});
}

var a = [
	{type: "video", name: "a"},
  {type: "image", name: "b"},
  {type: "video", name: "c"},
  {type: "blog", name: "d"},
  {type: "video", name: "e"},
]
console.log(a.groupBy((item) => item.type));
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2019-08-26T10:03:23.073

我会检查[declarative-js](https://www.npmjs.com/package/declarative-js#groupby) `groupBy`它似乎完全符合您的要求。也是：

*   非常高性能（性能[基准](https://github.com/pavel-surinin/performance-bechmark/blob/master/output.md#reduergroupby)）
*   用打字稿写的，所以所有的打字都包括在内。
*   不强制使用第 3 方类似数组的对象。

```
import { Reducers } from 'declarative-js';
import groupBy = Reducers.groupBy;
import Map = Reducers.Map;

const data = [
    { Phase: "Phase 1", Step: "Step 1", Task: "Task 1", Value: "5" },
    { Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" },
    { Phase: "Phase 1", Step: "Step 2", Task: "Task 1", Value: "15" },
    { Phase: "Phase 1", Step: "Step 2", Task: "Task 2", Value: "20" },
    { Phase: "Phase 2", Step: "Step 1", Task: "Task 1", Value: "25" },
    { Phase: "Phase 2", Step: "Step 1", Task: "Task 2", Value: "30" },
    { Phase: "Phase 2", Step: "Step 2", Task: "Task 1", Value: "35" },
    { Phase: "Phase 2", Step: "Step 2", Task: "Task 2", Value: "40" }
];

data.reduce(groupBy(element=> element.Step), Map());
data.reduce(groupBy('Step'), Map()); 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2017-07-05T20:25:14.063

让我们生成一个通用`Array.prototype.groupBy()`工具。只是为了多样化，让我们使用 ES6 奇特的扩展运算符在递归方法上进行一些 Haskellesque 模式匹配。另外，让我们`Array.prototype.groupBy()`接受一个回调，该回调将项目 ( `e`)、索引 ( `i`) 和应用的数组 ( `a`) 作为参数。

```
Array.prototype.groupBy = function(cb){
                            return function iterate([x,...xs], i = 0, r = [[],[]]){
                                     cb(x,i,[x,...xs]) ? (r[0].push(x), r)
                                                       : (r[1].push(x), r);
                                     return xs.length ? iterate(xs, ++i, r) : r;
                                   }(this);
                          };

var arr = [0,1,2,3,4,5,6,7,8,9],
    res = arr.groupBy(e => e < 5);
console.log(res);
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2017-08-02T07:24:24.157

Ceasar 的回答很好，但仅适用于数组内元素的内部属性（字符串的长度）。

这个实现更像：[这个链接](https://lodash.com/docs/4.17.4#groupBy)

```
const groupBy = function (arr, f) {
    return arr.reduce((out, val) => {
        let by = typeof f === 'function' ? '' + f(val) : val[f];
        (out[by] = out[by] || []).push(val);
        return out;
    }, {});
}; 
```

希望这可以帮助...

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2017-12-17T12:31:07.023

只是为了补充 Scott Sauyet 的[回答](https://stackoverflow.com/a/14484332/5484795)，有些人在评论中询问如何使用他的函数对 value1、value2 等进行分组，而不是只对一个值进行分组。

只需编辑他的 sum 函数：

```
DataGrouper.register("sum", function(item) {
    return _.extend({}, item.key,
        {VALUE1: _.reduce(item.vals, function(memo, node) {
        return memo + Number(node.VALUE1);}, 0)},
        {VALUE2: _.reduce(item.vals, function(memo, node) {
        return memo + Number(node.VALUE2);}, 0)}
    );
}); 
```

保持主要（DataGrouper）不变：

```
var DataGrouper = (function() {
    var has = function(obj, target) {
        return _.any(obj, function(value) {
            return _.isEqual(value, target);
        });
    };

    var keys = function(data, names) {
        return _.reduce(data, function(memo, item) {
            var key = _.pick(item, names);
            if (!has(memo, key)) {
                memo.push(key);
            }
            return memo;
        }, []);
    };

    var group = function(data, names) {
        var stems = keys(data, names);
        return _.map(stems, function(stem) {
            return {
                key: stem,
                vals:_.map(_.where(data, stem), function(item) {
                    return _.omit(item, names);
                })
            };
        });
    };

    group.register = function(name, converter) {
        return group[name] = function(data, names) {
            return _.map(group(data, names), converter);
        };
    };

    return group;
}()); 
```

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2018-03-23T10:56:41.797

来自@mortb、@jmarceli 的回答和[这篇文章](https://stackoverflow.com/questions/1068834/object-comparison-in-javascript)，

我利用作为**PRIMITIVE VALUE**多列 group by`JSON.stringify()`的标识。

 **## 无第三方

```
function groupBy(list, keyGetter) {
    const map = new Map();
    list.forEach((item) => {
        const key = keyGetter(item);
        if (!map.has(key)) {
            map.set(key, [item]);
        } else {
            map.get(key).push(item);
        }
    });
    return map;
}

const pets = [
    {type:"Dog", age: 3, name:"Spot"},
    {type:"Cat", age: 3, name:"Tiger"},
    {type:"Dog", age: 4, name:"Rover"}, 
    {type:"Cat", age: 3, name:"Leo"}
];

const grouped = groupBy(pets,
pet => JSON.stringify({ type: pet.type, age: pet.age }));

console.log(grouped); 
```

## 使用*Lodash*第三方

```
const pets = [
    {type:"Dog", age: 3, name:"Spot"},
    {type:"Cat", age: 3, name:"Tiger"},
    {type:"Dog", age: 4, name:"Rover"}, 
    {type:"Cat", age: 3, name:"Leo"}
];

let rslt = _.groupBy(pets, pet => JSON.stringify(
 { type: pet.type, age: pet.age }));

console.log(rslt); 
```

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2018-11-20T07:45:16.610

**支持功能的基于ES6** `reduce`的版本`iteratee`。

`iteratee`如果未提供该功能，则按预期工作：

```
const data = [{id: 1, score: 2},{id: 1, score: 3},{id: 2, score: 2},{id: 2, score: 4}]

const group = (arr, k) => arr.reduce((r, c) => (r[c[k]] = [...r[c[k]] || [], c], r), {});

const groupBy = (arr, k, fn = () => true) => 
  arr.reduce((r, c) => (fn(c[k]) ? r[c[k]] = [...r[c[k]] || [], c] : null, r), {});

console.log(group(data, 'id'))     // grouping via `reduce`
console.log(groupBy(data, 'id'))   // same result if `fn` is omitted
console.log(groupBy(data, 'score', x => x > 2 )) // group with the iteratee
```

在OP问题的背景下：

```
const data = [ { Phase: "Phase 1", Step: "Step 1", Task: "Task 1", Value: "5" }, { Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" }, { Phase: "Phase 1", Step: "Step 2", Task: "Task 1", Value: "15" }, { Phase: "Phase 1", Step: "Step 2", Task: "Task 2", Value: "20" }, { Phase: "Phase 2", Step: "Step 1", Task: "Task 1", Value: "25" }, { Phase: "Phase 2", Step: "Step 1", Task: "Task 2", Value: "30" }, { Phase: "Phase 2", Step: "Step 2", Task: "Task 1", Value: "35" }, { Phase: "Phase 2", Step: "Step 2", Task: "Task 2", Value: "40" } ]

const groupBy = (arr, k) => arr.reduce((r, c) => (r[c[k]] = [...r[c[k]] || [], c], r), {});
const groupWith = (arr, k, fn = () => true) => 
  arr.reduce((r, c) => (fn(c[k]) ? r[c[k]] = [...r[c[k]] || [], c] : null, r), {});

console.log(groupBy(data, 'Phase'))
console.log(groupWith(data, 'Value', x => x > 30 ))  // group by `Value` > 30
```

另一个**ES6**版本，它反转分组并使用`values`as`keys`和`keys`as `grouped values`：

```
const data = [{A: "1"}, {B: "10"}, {C: "10"}]

const groupKeys = arr => 
  arr.reduce((r,c) => (Object.keys(c).map(x => r[c[x]] = [...r[c[x]] || [], x]),r),{});

console.log(groupKeys(data))
```

**注意：**为简洁起见，函数以简短形式（一行）发布并仅与想法相关。您可以扩展它们并添加额外的错误检查等。

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2020-06-15T17:21:34.007

发布是因为即使这个问题已有 7 年历史，我还没有看到满足原始标准的答案：

> 我不希望它们“分裂”而是“合并”，更像是按方法分组的 SQL。

我最初来到这篇文章是因为我想找到一种方法来减少对象数组（例如，当您从 csv 读取时创建的数据结构）并通过给定索引聚合以生成*相同的数据结构*。我正在寻找的返回值是另一个对象数组，而不是像我在这里看到的那样的嵌套对象或映射。

下面的函数接受一个数据集（对象数组）、一个索引列表（数组）和一个reducer函数，并将reducer函数应用于索引的结果作为对象数组返回。

```
function agg(data, indices, reducer) {

  // helper to create unique index as an array
  function getUniqueIndexHash(row, indices) {
    return indices.reduce((acc, curr) => acc + row[curr], "");
  }

  // reduce data to single object, whose values will be each of the new rows
  // structure is an object whose values are arrays
  // [{}] -> {{}}
  // no operation performed, simply grouping
  let groupedObj = data.reduce((acc, curr) => {
    let currIndex = getUniqueIndexHash(curr, indices);

    // if key does not exist, create array with current row
    if (!Object.keys(acc).includes(currIndex)) {
      acc = {...acc, [currIndex]: [curr]}
    // otherwise, extend the array at currIndex
    } else {
      acc = {...acc, [currIndex]: acc[currIndex].concat(curr)};
    }

    return acc;
  }, {})

  // reduce the array into a single object by applying the reducer
  let reduced = Object.values(groupedObj).map(arr => {
    // for each sub-array, reduce into single object using the reducer function
    let reduceValues = arr.reduce(reducer, {});

    // reducer returns simply the aggregates - add in the indices here
    // each of the objects in "arr" has the same indices, so we take the first
    let indexObj = indices.reduce((acc, curr) => {
      acc = {...acc, [curr]: arr[0][curr]};
      return acc;
    }, {});

    reduceValues = {...indexObj, ...reduceValues};

    return reduceValues;
  });

  return reduced;
} 
```

我将创建一个返回 count(*) 和 sum(Value) 的 reducer：

```
reducer = (acc, curr) => {
  acc.count = 1 + (acc.count || 0);
  acc.value = +curr.Value + (acc.value|| 0);
  return acc;
} 
```

最后，将 agg 函数与我们的 reducer 应用到原始数据集会产生一个对象数组，其中应用了适当的聚合：

```
agg(tasks, ["Phase"], reducer);
// yields:
Array(2) [
  0: Object {Phase: "Phase 1", count: 4, value: 50}
  1: Object {Phase: "Phase 2", count: 4, value: 130}
]

agg(tasks, ["Phase", "Step"], reducer);
// yields:
Array(4) [
  0: Object {Phase: "Phase 1", Step: "Step 1", count: 2, value: 15}
  1: Object {Phase: "Phase 1", Step: "Step 2", count: 2, value: 35}
  2: Object {Phase: "Phase 2", Step: "Step 1", count: 2, value: 55}
  3: Object {Phase: "Phase 2", Step: "Step 2", count: 2, value: 75}
] 
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2017-05-02T22:47:09.567

```
let groupbyKeys = function(arr, ...keys) {
  let keysFieldName = keys.join();
  return arr.map(ele => {
    let keysField = {};
    keysField[keysFieldName] = keys.reduce((keyValue, key) => {
      return keyValue + ele[key]
    }, "");
    return Object.assign({}, ele, keysField);
  }).reduce((groups, ele) => {
    (groups[ele[keysFieldName]] = groups[ele[keysFieldName]] || [])
      .push([ele].map(e => {
        if (keys.length > 1) {
          delete e[keysFieldName];
        }
        return e;
    })[0]);
    return groups;
  }, {});
};

console.log(groupbyKeys(array, 'Phase'));
console.log(groupbyKeys(array, 'Phase', 'Step'));
console.log(groupbyKeys(array, 'Phase', 'Step', 'Task')); 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2017-10-28T22:26:57.390

这是一个不会破坏空成员的 ES6 版本

```
function groupBy (arr, key) {
  return (arr || []).reduce((acc, x = {}) => ({
    ...acc,
    [x[key]]: [...acc[x[key]] || [], x]
  }), {})
} 
```

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2018-03-05T07:36:06.647

具有**排序功能**

```
export const groupBy = function groupByArray(xs, key, sortKey) {
      return xs.reduce(function(rv, x) {
        let v = key instanceof Function ? key(x) : x[key];
        let el = rv.find(r => r && r.key === v);

        if (el) {
          el.values.push(x);
          el.values.sort(function(a, b) {
            return a[sortKey].toLowerCase().localeCompare(b[sortKey].toLowerCase());
          });
        } else {
          rv.push({ key: v, values: [x] });
        }

        return rv;
      }, []);
    }; 
```

样本：

```
var state = [
    {
      name: "Arkansas",
      population: "2.978M",
      flag:
  "https://upload.wikimedia.org/wikipedia/commons/9/9d/Flag_of_Arkansas.svg",
      category: "city"
    },{
      name: "Crkansas",
      population: "2.978M",
      flag:
        "https://upload.wikimedia.org/wikipedia/commons/9/9d/Flag_of_Arkansas.svg",
      category: "city"
    },
    {
      name: "Balifornia",
      population: "39.14M",
      flag:
        "https://upload.wikimedia.org/wikipedia/commons/0/01/Flag_of_California.svg",
      category: "city"
    },
    {
      name: "Florida",
      population: "20.27M",
      flag:
        "https://upload.wikimedia.org/wikipedia/commons/f/f7/Flag_of_Florida.svg",
      category: "airport"
    },
    {
      name: "Texas",
      population: "27.47M",
      flag:
        "https://upload.wikimedia.org/wikipedia/commons/f/f7/Flag_of_Texas.svg",
      category: "landmark"
    }
  ];
console.log(JSON.stringify(groupBy(state,'category','name'))); 
```

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2018-07-10T04:54:47.763

我已经扩展了已接受的答案，包括按多个属性进行分组，添加 thenby 并使其纯粹具有功能而没有突变。[在https://stackblitz.com/edit/typescript-ezydzv](https://stackblitz.com/edit/typescript-ezydzv)上查看演示

```
export interface Group {
  key: any;
  items: any[];
}

export interface GroupBy {
  keys: string[];
  thenby?: GroupBy;
}

export const groupBy = (array: any[], grouping: GroupBy): Group[] => {
  const keys = grouping.keys;
  const groups = array.reduce((groups, item) => {
    const group = groups.find(g => keys.every(key => item[key] === g.key[key]));
    const data = Object.getOwnPropertyNames(item)
      .filter(prop => !keys.find(key => key === prop))
      .reduce((o, key) => ({ ...o, [key]: item[key] }), {});
    return group
      ? groups.map(g => (g === group ? { ...g, items: [...g.items, data] } : g))
      : [
          ...groups,
          {
            key: keys.reduce((o, key) => ({ ...o, [key]: item[key] }), {}),
            items: [data]
          }
        ];
  }, []);
  return grouping.thenby ? groups.map(g => ({ ...g, items: groupBy(g.items, grouping.thenby) })) : groups;
}; 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2019-07-03T20:20:47.003

通常我使用带有预构建方法的[Lodash JavaScript 实用程序库。](https://lodash.com/)`groupBy()`它非常易于使用，请[在此处](https://lodash.com/docs/#groupBy)查看更多详细信息。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2019-10-30T12:19:56.087

```
function groupBy(array, groupBy){
        return array.reduce((acc,curr,index,array) => {
           var  idx = curr[groupBy]; 
              if(!acc[idx]){
                    acc[idx] = array.filter(item => item[groupBy] === idx)
              } 
            return  acc; 

        },{})
    }

// call
groupBy(items,'Step') 
```

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2019-12-05T14:28:44.130

我已经改进了答案。该函数采用组字段数组并返回分组对象，其键也是组字段的对象。

```
function(xs, groupFields) {
        groupFields = [].concat(groupFields);
        return xs.reduce(function(rv, x) {
            let groupKey = groupFields.reduce((keyObject, field) => {
                keyObject[field] = x[field];
                return keyObject;
            }, {});
            (rv[JSON.stringify(groupKey)] = rv[JSON.stringify(groupKey)] || []).push(x);
            return rv;
        }, {});
    }

let x = [
{
    "id":1,
    "multimedia":false,
    "language":["tr"]
},
{
    "id":2,
    "multimedia":false,
    "language":["fr"]
},
{
    "id":3,
    "multimedia":true,
    "language":["tr"]
},
{
    "id":4,
    "multimedia":false,
    "language":[]
},
{
    "id":5,
    "multimedia":false,
    "language":["tr"]
},
{
    "id":6,
    "multimedia":false,
    "language":["tr"]
},
{
    "id":7,
    "multimedia":false,
    "language":["tr","fr"]
}
]

groupBy(x, ['multimedia','language'])

//{
//{"multimedia":false,"language":["tr"]}: Array(3), 
//{"multimedia":false,"language":["fr"]}: Array(1), 
//{"multimedia":true,"language":["tr"]}: Array(1), 
//{"multimedia":false,"language":[]}: Array(1), 
//{"multimedia":false,"language":["tr","fr"]}: Array(1)
//} 
```

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2021-01-12T03:28:50.893

按照 Joseph Nields 的回答，在[https://github.com/padcom/array-prototype-functions#arrayprototypegroupbyfieldormapper](https://github.com/padcom/array-prototype-functions#arrayprototypegroupbyfieldormapper)中有一个用于对对象进行分组的 polyfill 。因此，与其一遍又一遍地写，你可能想要使用已经可用的东西。

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2021-02-03T15:15:31.600

在我的特定用例中，我需要按属性分组，然后删除分组属性。

无论如何，该属性仅出于分组目的而添加到记录中，并且对于向用户呈现没有意义。

```
 group (arr, key) {

        let prop;

        return arr.reduce(function(rv, x) {
            prop = x[key];
            delete x[key];
            (rv[prop] = (rv[prop] || [])).push(x);
            return rv;
        }, {});

    }, 
```

感谢@caesar-bautista 在最佳答案中的启动功能。

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2022-01-26T14:17:06.417

`groupBy`功能即将进入 JavaScript -[目前处于第 3 阶段](https://github.com/tc39/proposal-array-grouping)。

它可以在转译器配置中启用，我认为与 reduce 或第三方库（如 lodash 等）相比，解决方案要优雅得多。

```
const products = [
  { name: 'apples', category: 'fruits' },
  { name: 'oranges', category: 'fruits' },
  { name: 'potatoes', category: 'vegetables' }
];

const groupByCategory = products.groupBy(product => {
  return product.category;
});

console.log(groupByCategory);
// {
//   'fruits': [
//     { name: 'apples', category: 'fruits' }, 
//     { name: 'oranges', category: 'fruits' },
//   ],
//   'vegetables': [
//     { name: 'potatoes', category: 'vegetables' }
//   ]
// } 
```

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2014-03-25T11:24:42.840

[我从 underscore.js fiddler](http://jsfiddle.net/Hellfrom/cgRkS/20/)那里借用了这个方法

```
window.helpers=(function (){
    var lookupIterator = function(value) {
        if (value == null){
            return function(value) {
                return value;
            };
        }
        if (typeof value === 'function'){
                return value;
        }
        return function(obj) {
            return obj[value];
        };
    },
    each = function(obj, iterator, context) {
        var breaker = {};
        if (obj == null) return obj;
        if (Array.prototype.forEach && obj.forEach === Array.prototype.forEach) {
            obj.forEach(iterator, context);
        } else if (obj.length === +obj.length) {
            for (var i = 0, length = obj.length; i < length; i++) {
                if (iterator.call(context, obj[i], i, obj) === breaker) return;
            }
        } else {
            var keys = []
            for (var key in obj) if (Object.prototype.hasOwnProperty.call(obj, key)) keys.push(key)
            for (var i = 0, length = keys.length; i < length; i++) {
                if (iterator.call(context, obj[keys[i]], keys[i], obj) === breaker) return;
            }
        }
        return obj;
    },
    // An internal function used for aggregate "group by" operations.
    group = function(behavior) {
        return function(obj, iterator, context) {
            var result = {};
            iterator = lookupIterator(iterator);
            each(obj, function(value, index) {
                var key = iterator.call(context, value, index, obj);
                behavior(result, key, value);
            });
            return result;
        };
    };

    return {
      groupBy : group(function(result, key, value) {
        Object.prototype.hasOwnProperty.call(result, key) ? result[key].push(value) :              result[key] = [value];
        })
    };
})();

var arr=[{a:1,b:2},{a:1,b:3},{a:1,b:1},{a:1,b:2},{a:1,b:3}];
 console.dir(helpers.groupBy(arr,"b"));
 console.dir(helpers.groupBy(arr,function (el){
   return el.b>2;
 })); 
```

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2018-02-01T08:27:20.590

```
var arr = [ 
    { Phase: "Phase 1", `enter code here`Step: "Step 1", Task: "Task 1", Value: "5" },
    { Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" },
    { Phase: "Phase 1", Step: "Step 2", Task: "Task 1", Value: "15" },
    { Phase: "Phase 1", Step: "Step 2", Task: "Task 2", Value: "20" },
    { Phase: "Phase 2", Step: "Step 1", Task: "Task 1", Value: "25" },
    { Phase: "Phase 2", Step: "Step 1", Task: "Task 2", Value: "30" },
    { Phase: "Phase 2", Step: "Step 2", Task: "Task 1", Value: "35" },
    { Phase: "Phase 2", Step: "Step 2", Task: "Task 2", Value: "40" }
]; 
```

创建并清空对象。循环**arr**并添加 use **Phase**作为**obj**的唯一键。在循环**arr**时不断更新**obj中的****键**总数。

 ****```
const obj = {};
arr.forEach((item) => {
  obj[item.Phase] = obj[item.Phase] ? obj[item.Phase] + 
  parseInt(item.Value) : parseInt(item.Value);
}); 
```

结果将如下所示：

```
{ "Phase 1": 50, "Phase 2": 130 } 
```

遍历**obj**以形成和**resultArr**。

```
const resultArr = [];
for (item in obj) {
  resultArr.push({ Phase: item, Value: obj[item] });
}
console.log(resultArr); 
```

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2018-07-19T19:21:12.280

```
data = [{id:1, name:'BMW'}, {id:2, name:'AN'}, {id:3, name:'BMW'}, {id:1, name:'NNN'}]
key = 'id'//try by id or name
data.reduce((previous, current)=>{
    previous[current[key]] && previous[current[key]].length != 0 ? previous[current[key]].push(current) : previous[current[key]] = new Array(current)
    return previous;
}, {}) 
```

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2018-08-01T08:24:12.657

基于[@Ceasar Bautista](https://stackoverflow.com/users/577199/ceasar-bautista)的最初想法，我修改了代码并使用 typescript 创建了一个 groupBy 函数。

```
static groupBy(data: any[], comparator: (v1: any, v2: any) => boolean, onDublicate: (uniqueRow: any, dublicateRow: any) => void) {
    return data.reduce(function (reducedRows, currentlyReducedRow) {
      let processedRow = reducedRows.find(searchedRow => comparator(searchedRow, currentlyReducedRow));

      if (processedRow) {
        // currentlyReducedRow is a dublicateRow when processedRow is not null.
        onDublicate(processedRow, currentlyReducedRow)
      } else {
        // currentlyReducedRow is unique and must be pushed in the reducedRows collection.
        reducedRows.push(currentlyReducedRow);
      }

      return reducedRows;
    }, []);
  }; 
```

此函数接受一个回调（比较器）来比较行并找到重复项和聚合重复项的第二个回调（onDublicate）。

用法示例：

```
data = [
    { name: 'a', value: 10 },
    { name: 'a', value: 11 },
    { name: 'a', value: 12 },
    { name: 'b', value: 20 },
    { name: 'b', value: 1 }
  ]

  private static demoComparator = (v1: any, v2: any) => {
    return v1['name'] === v2['name'];
  }

  private static demoOnDublicate = (uniqueRow, dublicateRow) => {
    uniqueRow['value'] += dublicateRow['value'];    
  }; 
```

打电话

```
groupBy(data, demoComparator, demoOnDublicate) 
```

将执行一组计算值的总和。

```
{name: "a", value: 33}
{name: "b", value: 21} 
```

我们可以根据项目的需要创建尽可能多的回调函数，并根据需要聚合这些值。例如，在一种情况下，我需要合并两个数组而不是对数据求和。

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2018-11-07T14:47:02.123

您可以`forEach`在数组上使用并构造一组新的项目。这是使用`FlowType`注释的方法

```
// @flow

export class Group<T> {
  tag: number
  items: Array<T>

  constructor() {
    this.items = []
  }
}

const groupBy = (items: Array<T>, map: (T) => number) => {
  const groups = []

  let currentGroup = null

  items.forEach((item) => {
    const tag = map(item)

    if (currentGroup && currentGroup.tag === tag) {
      currentGroup.items.push(item)
    } else {
      const group = new Group<T>()
      group.tag = tag
      group.items.push(item)
      groups.push(group)

      currentGroup = group
    }
  })

  return groups
}

export default groupBy 
```

开玩笑的测试可以像

```
// @flow

import groupBy from './groupBy'

test('groupBy', () => {
  const items = [
    { name: 'January', month: 0 },
    { name: 'February', month: 1 },
    { name: 'February 2', month: 1 }
  ]

  const groups = groupBy(items, (item) => {
    return item.month
  })

  expect(groups.length).toBe(2)
  expect(groups[1].items[1].name).toBe('February 2')
}) 
```

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2019-03-05T05:16:48.603

下面的函数允许对任意字段进行分组（和求和值 - OP需要什么）。在解决方案中，我们定义`cmp`了根据分组比较两个对象的函数`fields`。在`let w=...`我们创建子集对象 x 字段的副本。在`y[sumBy]=+y[sumBy]+(+x[sumBy])`我们使用 '+' 将字符串转换为数字。

```
function groupBy(data, fields, sumBy='Value') {
  let r=[], cmp= (x,y) => fields.reduce((a,b)=> a && x[b]==y[b], true);
  data.forEach(x=> {
    let y=r.find(z=>cmp(x,z));
    let w= [...fields,sumBy].reduce((a,b) => (a[b]=x[b],a), {})
    y ? y[sumBy]=+y[sumBy]+(+x[sumBy]) : r.push(w);
  });
  return r;
} 
```

```
const d = [ 
    { Phase: "Phase 1", Step: "Step 1", Task: "Task 1", Value: "5" },
    { Phase: "Phase 1", Step: "Step 1", Task: "Task 2", Value: "10" },
    { Phase: "Phase 1", Step: "Step 2", Task: "Task 1", Value: "15" },
    { Phase: "Phase 1", Step: "Step 2", Task: "Task 2", Value: "20" },
    { Phase: "Phase 2", Step: "Step 1", Task: "Task 1", Value: "25" },
    { Phase: "Phase 2", Step: "Step 1", Task: "Task 2", Value: "30" },
    { Phase: "Phase 2", Step: "Step 2", Task: "Task 1", Value: "35" },
    { Phase: "Phase 2", Step: "Step 2", Task: "Task 2", Value: "40" }
];

function groupBy(data, fields, sumBy='Value') {
  let r=[], cmp= (x,y) => fields.reduce((a,b)=> a && x[b]==y[b], true);
  data.forEach(x=> {
    let y=r.find(z=>cmp(x,z));
    let w= [...fields,sumBy].reduce((a,b) => (a[b]=x[b],a), {})
    y ? y[sumBy]=+y[sumBy]+(+x[sumBy]) : r.push(w);
  });
  return r;
}

// TEST
let p=(t,o) => console.log(t, JSON.stringify(o));
console.log('GROUP BY:');

p('Phase', groupBy(d,['Phase']) );
p('Step', groupBy(d,['Step']) );
p('Phase-Step', groupBy(d,['Phase', 'Step']) );
p('Phase-Task', groupBy(d,['Phase', 'Task']) );
p('Step-Task', groupBy(d,['Step', 'Task']) );
p('Phase-Step-Task', groupBy(d,['Phase','Step', 'Task']) );
```

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2019-08-13T15:03:09.200

```
let x  = [
  {
    "id": "6",
    "name": "SMD L13",
    "equipmentType": {
      "id": "1",
      "name": "SMD"
    }
  },
  {
    "id": "7",
    "name": "SMD L15",
    "equipmentType": {
      "id": "1",
      "name": "SMD"
    }
  },
  {
    "id": "2",
    "name": "SMD L1",
    "equipmentType": {
      "id": "1",
      "name": "SMD"
    }
  }
];

function groupBy(array, property) {
  return array.reduce((accumulator, current) => {
    const object_property = current[property];
    delete current[property]

    let classified_element = accumulator.find(x => x.id === object_property.id);
    let other_elements = accumulator.filter(x => x.id !== object_property.id);

   if (classified_element) {
     classified_element.children.push(current)
   } else {
     classified_element = {
       ...object_property, 
       'children': [current]
     }
   }
   return [classified_element, ...other_elements];
 }, [])
}

console.log( groupBy(x, 'equipmentType') )

/* output 

[
  {
    "id": "1",
    "name": "SMD",
    "children": [
      {
        "id": "6",
        "name": "SMD L13"
      },
      {
        "id": "7",
        "name": "SMD L15"
      },
      {
        "id": "2",
        "name": "SMD L1"
      }
    ]
  }
]

*/ 
```

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2019-10-01T04:13:37.463

如果你使用 lodash 库就很简单

```
let temp = []
  _.map(yourCollectionData, (row) => {
    let index = _.findIndex(temp, { 'Phase': row.Phase })
    if (index > -1) {
      temp[index].Value += row.Value 
    } else {
      temp.push(row)
    }
  }) 
```

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2020-10-21T19:36:49.540

```
var newArr = data.reduce((acc, cur) => {
    const existType = acc.find(a => a.Phase === cur.Phase);
    if (existType) {
        existType.Value += +cur.Value;
        return acc;
    }

    acc.push({
        Phase: cur.Phase,
        Value: +cur.Value
    });
    return acc;
}, []); 
```

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2020-10-28T17:59:17.247

**使用 ES6 的简单解决方案：**

该方法有一个返回模型并允许比较 n 个属性。

```
const compareKey = (item, key, compareItem) => {
    return item[key] === compareItem[key]
}

const handleCountingRelatedItems = (listItems, modelCallback, compareKeyCallback) => {
    return listItems.reduce((previousValue, currentValue) => {
        if (Array.isArray(previousValue)) {
        const foundIndex = previousValue.findIndex(item => compareKeyCallback(item, currentValue))

        if (foundIndex > -1) {
            const count = previousValue[foundIndex].count + 1

            previousValue[foundIndex] = modelCallback(currentValue, count)

            return previousValue
        }

        return [...previousValue, modelCallback(currentValue, 1)]
        }

        if (compareKeyCallback(previousValue, currentValue)) {
        return [modelCallback(currentValue, 2)]
        }

        return [modelCallback(previousValue, 1), modelCallback(currentValue, 1)]
    })
}

const itemList = [
    { type: 'production', human_readable: 'Production' },
    { type: 'test', human_readable: 'Testing' },
    { type: 'production', human_readable: 'Production' }
]

const model = (currentParam, count) => ({
    label: currentParam.human_readable,
    type: currentParam.type,
    count
})

const compareParameter = (item, compareValue) => {
    const isTypeEqual = compareKey(item, 'type', compareValue)
    return isTypeEqual
}

const result = handleCountingRelatedItems(itemList, model, compareParameter)

 console.log('Result: \n', result)
/** Result: 
    [
        { label: 'Production', type: 'production', count: 2 },
        { label: 'Testing', type: 'testing', count: 1 }
    ]
*/ 
```

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2022-02-19T04:16:52.313

如果您需要进行多分组：

```
 const populate = (entireObj, keys, item) => {
    let keysClone = [...keys],
        currentKey = keysClone.shift();

    if (keysClone.length > 0) {
        entireObj[item[currentKey]] = entireObj[item[currentKey]] || {}
        populate(entireObj[item[currentKey]], keysClone, item);
    } else {
        (entireObj[item[currentKey]] = entireObj[item[currentKey]] || []).push(item);
    }
}

export const groupBy = (list, key) => {
    return list.reduce(function (rv, x) {

        if (typeof key === 'string') (rv[x[key]] = rv[x[key]] || []).push(x);

        if (typeof key === 'object' && key.length) populate(rv, key, x);

        return rv;

    }, {});
}

const myPets = [
    {name: 'yaya', type: 'cat', color: 'gray'},
    {name: 'bingbang', type: 'cat', color: 'sliver'},
    {name: 'junior-bingbang', type: 'cat', color: 'sliver'},
    {name: 'jindou', type: 'cat', color: 'golden'},
    {name: 'dahuzi', type: 'dog', color: 'brown'},
];

// run 
groupBy(myPets, ['type', 'color']));

// you will get object like: 

const afterGroupBy = {
    "cat": {
        "gray": [
            {
                "name": "yaya",
                "type": "cat",
                "color": "gray"
            }
        ],
        "sliver": [
            {
                "name": "bingbang",
                "type": "cat",
                "color": "sliver"
            },
            {
                "name": "junior-bingbang",
                "type": "cat",
                "color": "sliver"
            }
        ],
        "golden": [
            {
                "name": "jindou",
                "type": "cat",
                "color": "golden"
            }
        ]
    },
    "dog": {
        "brown": [
            {
                "name": "dahuzi",
                "type": "dog",
                "color": "brown"
            }
        ]
    }
}; 
```

* * *

## 回答 #55

> 赞同：-1
> 
> 时间：2020-10-26T09:47:10.723

```
/**
 * array group by 
 * @category array
 * @function arrayGroupBy
 * @returns  {object} {"fieldName":[{...}],...}
 * @static
 * @author hht
 * @param {string}} key group key
 * @param {array} data array
 *
 * @example example 01 
 * --------------------------------------------------------------------------
 * import { arrayGroupBy } from "@xx/utils";
 * const array =  [
 *  {
 *    type: 'assets',
 *    name: 'zhangsan',
 *    age: '33',
 *  },
 *  {
 *    type: 'config',
 *    name: 'a',
 *    age: '13',
 *  },
 *  {
 *    type: 'run',
 *    name: 'lisi',
 *    age: '3',
 *  },
 *  {
 *    type: 'xx',
 *    name: 'timo',
 *    age: '4',
 *  },
 *];
 * arrayGroupBy(array,'type',);
 *
 * result:{
 *    assets: [{ age: '33', name: 'zhangsan', type: 'assets' }],
 *    config: [{ age: '13', name: 'a', type: 'config' }],
 *    run: [{ age: '3', name: 'lisi', type: 'run' }],
 *    xx: [{ age: '4', name: 'timo', type: 'xx' }],
 *  };
 *
 * @example example 02 null
 * --------------------------------------------------------------------------
 * const array = null;
 * arrayGroupBy(array,"type");
 *
 * result:{}
 *
 * @example example 03 key undefind
 * --------------------------------------------------------------------------
 * const array =  [
 *  {
 *    type: 'assets',
 *    name: 'zhangsan',
 *    age: '33',
 *  },
 *  {
 *    type: 'config',
 *    name: 'a',
 *    age: '13',
 *  },
 *  {
 *    type: 'run',
 *    name: 'lisi',
 *    age: '3',
 *  },
 *  {
 *    type: 'xx',
 *    name: 'timo',
 *    age: '4',
 *  },
 *];
 * arrayGroupBy(array,"xx");
 *
 * {}
 *
 */
  const arrayGroupBy = (data, key) => {
  if (!data || !Array.isArray(data)) return {};
  const groupObj = {};
  data.forEach((item) => {
    if (!item[key]) return;
    const fieldName = item[key];
    if (!groupObj[fieldName]) {
      groupObj[fieldName] = [item];
      return;
    }
    groupObj[fieldName].push(item);
  });
  return groupObj;
};

const array = [
    {
      type: 'assets',
      name: 'zhangsan',
      age: '33',
    },
    {
      type: 'config',
      name: 'a',
      age: '13',
    },
    {
      type: 'run',
      name: 'lisi',
      age: '3',
    },
    {
      type: 'run',
      name: 'wangmazi',
      age: '3',
    },
    {
      type: 'xx',
      name: 'timo',
      age: '4',
    },
  ];
console.dir(arrayGroupBy(array, 'type'))
```

```
<p>

describe('arrayGroupBy match', () => {
  const array = [
    {
      type: 'assets',
      name: 'zhangsan',
      age: '33',
    },
    {
      type: 'config',
      name: 'a',
      age: '13',
    },
    {
      type: 'run',
      name: 'lisi',
      age: '3',
    },
    {
      type: 'xx',
      name: 'timo',
      age: '4',
    },
  ];

  test('arrayGroupBy  ...', () => {
    const result = {
      assets: [{ age: '33', name: 'zhangsan', type: 'assets' }],
      config: [{ age: '13', name: 'a', type: 'config' }],
      run: [{ age: '3', name: 'lisi', type: 'run' }],
      xx: [{ age: '4', name: 'timo', type: 'xx' }],
    };

    expect(arrayGroupBy(array, 'type')).toEqual(result);
  });

  test('arrayGroupBy not match..', () => {
    // result
    expect(arrayGroupBy(array, 'xx')).toEqual({});
  });

  test('arrayGroupBy null', () => {
    let array = null;
    expect(arrayGroupBy(array, 'type')).toEqual({});
  });

  test('arrayGroupBy undefined', () => {
    let array = undefined;
    expect(arrayGroupBy(array, 'type')).toEqual({});
  });

  test('arrayGroupBy empty', () => {
    let array = [];
    expect(arrayGroupBy(array, 'type')).toEqual({});
  });
});

</p>
```********

# facebook - Pinterest 如何实现 Facebook 点赞按钮？

> ID：14446512
> 
> 赞同：0
> 
> 时间：2013-01-21T20:18:31.410
> 
> 标签：facebook, facebook-like, pinterest

当你在 pininterest 上点赞时，它会在 Facebook 的活动中显示类似“人名”在 Pintrest 上喜欢“某事”的内容。

这是如何实施的，我如何在我自己的网站上做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:38:52.870

实现 facebook 登录并向用户请求适当的 facebook 发布权限，以便您可以在用户单击您的喜欢按钮时将自定义消息发布到用户的 facebook 流。

# magento - Magento 1.7 在追加销售产品上应用 jcarousel

> ID：14446518
> 
> 赞同：0
> 
> 时间：2013-01-21T20:19:11.983
> 
> 标签：magento, jcarousel

我正在尝试将 jcarousel 应用于追加销售产品。我找不到有关如何使用 Magento 1.7 的好教程。

我将 upsell.phtml 更改如下：

```
<?php if(count($this->getItemCollection()->getItems())): ?>
<div class="box-collateral box-up-sell">
<p><?php echo $this->__('Anderen bekeken ook:') ?></p>

<div id="wrap">    

<?php  $this->setColumnCount(5); //uncomment this line if you want to have another number         of columns. also can be changed in layout// ?>
<?php $this->resetItemsIterator() ?>
<?php for($_i=0;$_i<$this->getRowCount();$_i++): ?>

<ul id="mycarousel" class="jcarousel-skin-tango" style="overflow:hidden;position:relative">
     <?php for($_j=0;$_j<$this->getColumnCount();$_j++): ?>
        <?php if($_link=$this->getIterableItem()): ?>
        <li>
            <a href="<?php echo $_link->getProductUrl() ?>" title="<?php echo $this-    >htmlEscape($_link->getName()) ?>" class="product-image"><img src="<?php echo $this->helper('catalog/image')->init($_link, 'small_image')->resize(140) ?>" width="140" height="140" alt="<?php echo $this->htmlEscape($_link->getName()) ?>" /></a>

           <?php echo $this->getPriceHtml($_link, true, '-upsell') ?>

        </li>
        <?php else: ?>
        <li class="empty">&nbsp;</li>
        <?php endif; ?>
    <?php endfor; ?>
   </ul> 
<script type="text/javascript">

 function mycarousel_initCallback(carousel)
 {
// Disable autoscrolling if the user clicks the prev or next button.
carousel.buttonNext.bind('click', function() {
    carousel.startAuto(0);
});

carousel.buttonPrev.bind('click', function() {
    carousel.startAuto(0);
});

// Pause autoscrolling if the user moves with the cursor over the clip.
carousel.clip.hover(function() {
    carousel.stopAuto();
}, function() {
    carousel.startAuto();
});
};

jQuery(document).ready(function() {
jQuery('#mycarousel').jcarousel({
    auto: 2,
    wrap: 'last',
    initCallback: mycarousel_initCallback
});
});

function itemLoadCallbackFunction(carousel, state)
{
for (var i = carousel.first; i <= carousel.last; i++) {
    // Check if the item already exists
    if (!carousel.has(i)) {
        // Add the item
        carousel.add(i, "I'm item #" + i);
    }
}
};
</script>

<?php endfor; ?>

</div>

<!--<script type="text/javascript">decorateTable('upsell-product-table')</script>-->

</div>
<?php endif ?> 
```

我还添加了 jquery.jcarousel.mini.js 和 query-1.9.0.min.js 以通过 page.xml 加载。

现在我得到一个包含所有项目的垂直列表。我想要一个水平列表，其中包含 5 个自动滚动的可见项目。通过链接：

[http://www.dotato.nl/olympus-stylus-750-7-1mp-digital-camera.html](http://www.dotato.nl/olympus-stylus-750-7-1mp-digital-camera.html)

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T15:38:33.330

这是代码的工作和平，希望它会有所帮助。

```
<?php // Carousel ?>
    <?php $carouselProductCollection = Mage::helper('my_helper')
    ->prepareCarouselProductsCollection(Mage::registry('current_category')) ?>
<?php if ($carouselProductCollection): ?>
<div class="category-products">
<div class="category casousel">
    <a href="#" class="flv-arw-lft"></a>
    <a href="#" class="flv-arw-rht"></a>
    <ul id="mycarousel">
        <?php foreach ($carouselProductCollection as $_product): ?>
            <li>
                <div class="cartomizer_item">
                    <img src="<?php echo $this->helper('catalog/image')->init($_product, 'small_image')->resize(159, 128); ?>" />
                    <div class="item-title"><?php echo $_product->getName() ?></div>
                    <div class="item-desc">
                        <span>
                            <strong><?php echo $_product->getTitle() ?>&trade;: </strong>
                            <?php echo strip_tags($_product->getShortDescription()); ?>
                        </span>
                    </div>
                </div>
            </li>
        <?php endforeach; ?>
    </ul>
</div>

<script type="text/javascript">
    function mycarousel_initCallback(carousel) {
        jQuery('.arw-right').bind('click', function() {
            carousel.next();
            return false;
        });

        jQuery('.arw-left').bind('click', function() {
            carousel.prev();
            return false;
        });

    };
    jQuery(document).ready(function() {
        jQuery("#mycarousel").jcarousel({
            scroll: 1,
            wrap: 'circular',
            initCallback: mycarousel_initCallback,
            buttonNextHTML: null,
            buttonPrevHTML: null
        });
    });
</script> 
```

# html - 使滚动条在太大的内容上保持可见

> ID：14446520
> 
> 赞同：3
> 
> 时间：2013-01-21T20:19:19.400
> 
> 标签：html, css, scroll

我正在使用 div 创建一个数据网格。我需要网格中的数据在 x 方向滚动标题，这在示例中正常工作。我的问题是我希望标题始终在网格顶部保持可见，因此我将网格的数据放在另一个 div 中并使用它在 Y 方向滚动。因为数据行比父 div 宽，所以 Y 滚动条通常不可见。您必须一直滚动到右侧才能使用 Y 滚动条。有什么办法让滚动条始终可见吗？我尝试了不同的 CSS 溢出选项，但似乎找不到正确的解决方案。

[滚动问题的工作示例](https://emedtrax.com/dg_scroll.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T19:27:20.247

试试这个，它可能会工作

```
html {
       overflow-x: scroll;
} 
```

# jquery - 为什么我变得不确定？

> ID：14446521
> 
> 赞同：1
> 
> 时间：2013-01-21T20:19:28.773
> 
> 标签：jquery

我正在使用以下代码，并且正在尝试修改某些表数据的 html。但是， 的值`$(this).html()`似乎总是未定义。我不明白为什么。有人可以解释一下吗。

```
$(document).on('click',"td",function() { 
        //console.log($(this).html());
    }).focusout(function(){
        console.log($(this).html()); //undifined 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:22:03.350

您正在将事件绑定到文档，然后获取它的 html。该文档没有 html。

你可能想要的是这样的：

```
$(document).on('click',"td",function() { 
    //console.log($(this).html());
}).on('blur','td',function(){
    console.log($(this).html()); //not undifined  :-)
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:22:11.033

尝试做

```
$('td').on('click', function () {
}).focusout(function(){
    console.log($(this).html()); //undifined 
}); 
```

您当前的选择器可能会限制您的范围。

# c# - 使用 MVVM 更改应用程序主题

> ID：14446522
> 
> 赞同：1
> 
> 时间：2013-01-21T20:19:32.063
> 
> 标签：c#, wpf, mvvm, themes

所有，我是 MVVM 的新手，所以请温柔一点。我刚刚学习了如何使用 MVVM 将基本的“模型”或数据绑定到 WPF 中的视图。我现在正在着手一个新的应用程序，我想使用 MVVM 的第一件事是促进应用程序的新颜色主题的快速更改/开发。我正在尝试根据我在网上阅读的一些基本教程来做到这一点，但我对实现我想要的最佳方式感到困惑。

我见过[WPF 和 MVVM - 动态更改主题](https://stackoverflow.com/q/11139103/626442)，但这对我没有帮助；反而引发了更多的问题。*做我想做的最好的方法是什么？以及如何使用 MVVM 实现它？*

如果有人能提供一个基本的大纲，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:30:58.703

拥有 MVVM 并不意味着您将没有代码。事实上，在您的 ViewModel 中仅包含与 UI 相关的问题可能是一种代码异味。为什么不让 UI 做它的事情呢？

```
public interface IMainView {
   void ChangeTheme(string themeName);
}

public class ViewModel {

   public IMainView View { get; } //get the view somehow
   public ICommand ChangeThemeCommand { get; }

   private void OnChangeThemeCommandExecute(string themeName) {
      View.ChangeTheme(themeName);
   }
} 
```

使用这种方法，您可以测试命令的调用并将其委托给视图（如果这值得测试）。您仍然有关注点分离和一些可测试性。

# javascript - 如何检查复选框是否没有标签？

> ID：14446524
> 
> 赞同：0
> 
> 时间：2013-01-21T20:19:47.683
> 
> 标签：javascript, jquery, html, css

我有一个复选框列表，其中一些有标签，有些没有。我希望能够为所有没有标签的复选框赋予某种样式。有什么想法可以做到吗？

```
<input type="checkbox" name="publish"/>
<input type="checkbox" id="delete" name="delete" /><label for="delete">Delete</label> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:22:02.413

```
$("input[type=checkbox]").each(function () {
   if (!$("label[for='" + $(this).attr('id') + "']").length) {
      $(this).css(styles);
   }
}); 
```

您也可以单独使用 CSS 来执行此操作，具体取决于您的 HTML 的外观，但您无法在 CSS 中`id`进行比较。`for`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:22:11.263

为了使标签起作用，它们必须具有`for`与输入元素匹配的属性`id`，或者必须是输入元素的祖先。此函数将 jQuery 元素或字符串选择器作为参数，并检查是否有任何标签的`for`属性值与元素的值匹配，`id`或者是否存在标签祖先。

```
function hasLabel(el) {
    el = $(el); // ensure jQuery-wrapped
    return (
        el.closest('label').length > 0 ||
        $('label[for="' + el.attr('id') + '"]').length > 0
    );
} 
```

# spring - spring-security.xml中的错误“配置问题：spring-security-web类不可用。你需要这些才能使用 "

> ID：14446527
> 
> 赞同：3
> 
> 时间：2013-01-21T20:19:51.640
> 
> 标签：spring, spring-mvc, spring-security

这是我的 pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.tachsec.src</groupId>
    <artifactId>tachsec</artifactId>    <packaging>war</packaging>
    <version>1.0-SNAPSHOT</version>     <name>tachsec</name>
    <url>http://maven.apache.org</url>

    <properties>        <spring.version>3.0.5.RELEASE</spring.version>
    </properties>

    <dependencies>

        <!-- Spring 3 dependencies -->      <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>3.0.5.RELEASE</version>        </dependency>

        <dependency>            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
            <version>3.0.5.RELEASE</version>        </dependency>

        <dependency>            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>3.0.5.RELEASE</version>        </dependency>

        <dependency>            <groupId>org.springframework</groupId>
            <artifactId>spring-jdbc</artifactId>
            <version>3.0.5.RELEASE</version>        </dependency>

        <!-- Spring Security -->        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-core</artifactId>
            <version>3.0.5.RELEASE</version>        </dependency>

        <dependency>            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-web</artifactId>
            <version>${spring.version}</version>        </dependency>

        <dependency>            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
            <version>${spring.version}</version>        </dependency>

        <!-- jstl -->       <dependency>            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>           <version>1.2</version>
        </dependency>

        <!-- MySQL database driver -->      <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.9</version>        </dependency>

    </dependencies>

    <build>         <finalName>tachsec</finalName>      <plugins>           <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>            </plugin>       </plugins>  </build>

</project> 
```

这是我的 web.xml

```
<?xml version="1.0" encoding="UTF-8"?> <web-app version="2.5"
xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

    <!-- The definition of the Root Spring Container shared by all
Servlets and Filters -->        <servlet>
        <servlet-name>mvc-dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>    </servlet>
    <servlet-mapping>       <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>/</url-pattern>    </servlet-mapping>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <context-param>         <param-name>contextConfigLocation</param-name>
        <param-value>
            WEB-INF/spring/appServlet/mvc-dispatcher-servlet.xml,
            WEB-INF/spring/appServlet/spring-database.xml,
            WEB-INF/spring/appServlet/spring-security.xml       </param-value>
    </context-param>

    <!-- Spring Security -->    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>   </filter>

    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>   </filter-mapping> </web-app> 
```

这是我的 spring-security.xml

```
<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/security
    http://www.springframework.org/schema/security/spring-security-3.0.3.xsd">

    <http auto-config="true">       <intercept-url pattern="/welcome*"
access="ROLE_USER" />       <form-login login-page="/login"
default-target-url="/welcome"
            authentication-failure-url="/loginfailed" />        <logout
logout-success-url="/logout" />     </http>

    <authentication-manager>        <authentication-provider>
            <jdbc-user-service data-source-ref="dataSource"

                users-by-username-query="
                    select username,password, enabled 
                    from users where USERNAME=?"

                authorities-by-username-query="
                    select u.username, ur.authority from users u, user_roles ur 
                    where u.user_id = ur.user_id and u.username =?  " />        </authentication-provider>  </authentication-manager>

</beans:beans> 
```

我`<http auto-config="true">`在 spring-security.xml 中收到此错误：

> 配置问题：spring-security-web 类不可用。您需要这些才能使用 <filter-chain-map>"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T10:10:43.080

您必须在 pom.xml 中包含 Servlet 库：

```
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>servlet-api</artifactId>
    <version>{version}</version>
    <scope>provided</scope>
</dependency> 
```

# php - PHP/jQuery 克隆 - 从表单中获取变量并使用 php 发送电子邮件

> ID：14446528
> 
> 赞同：0
> 
> 时间：2013-01-21T20:19:57.987
> 
> 标签：php, jquery, html

我是自学者，我目前正在构建（尝试构建）一个简单的表单，该表单具有一行包含 3 个字段，并且根据客户想要的项目数量动态添加具有相同字段的另一行。它将有 20 个项目的限制。我正在为要动态添加的字段使用这个 html 布局：

```
<div id="input1" style="margin-bottom:4px;" class="clonedInput">
        Part #: <input name="part'+i+'" type="text" id="part1" size="10" maxlength="15" />
        Description: <input name="description'+i+'" type="text" id="description1" size="30" maxlength="50" />
        Qty: <input name="quantity'+i+'" type="text" id="quantity1" size="5" maxlength="5" />
    </div>
    <p>&nbsp;</p>
    <div>
        <input type="button" id="btnAdd" onclick="dupForm('input', '.clonedInput', 'btnAdd', 'btnDel');" value="add item" />
        <input type="button" id="btnDel" onclick="rmForm('input', '.clonedInput', 'btnAdd', 'btnDel');" value="remove item" />
    </div> 
```

这个java脚本：

> 函数 trimNums(stringToTrim) { return stringToTrim.replace(/\d+$/,""); }

```
 function dupForm(divId, divClass, btnAdd, btnRm)
    {
    //alert(divId+'   '+divClass);
        var num     = $(divClass).length;
        var newNum  = new Number(num + 1);
        var i;

        var newElem = $('#' + divId + num).clone().attr('id', divId + newNum).fadeIn('slow');

        for (i=0; i < newElem.children().length; i++)
        {
            var attrId = trimNums(newElem.children(':eq('+i+')').attr('id'));
            var attrName = trimNums(newElem.children(':eq('+i+')').attr('name'));

            newElem.children(':eq('+i+')').attr('id', attrId + newNum).val('');
        }
        $('#' + divId + num).after(newElem);
        $('#' + btnRm).attr('disabled','');

        if (newNum == 20)
            $('#' + btnAdd).attr('disabled','disabled');
    }

    function rmForm(divId, divClass, btnAdd, btnRm)
    {
        var num = $(divClass).length;

        $('#' + divId + num).remove();
        $('#' + btnAdd).attr('disabled','');

        if (num-1 == 1)
            $('#' + btnRm).attr('disabled','disabled');
    }
    </script> 
```

我的问题是：如何将变量导入 PHP，以便将此表单发送到特定的电子邮件。

请注意：我在表单上有更多字段并在 php 中收集信息我使用以下 php 脚本：

```
$emailField = $_POST['email'];
$company_nameField = $_POST['company_name'];
$dateField = $_POST['date'];
$phoneField = $_POST['phone'];

$part1Field = $_POST['part1'];
$part2Field = $_POST['part2'];

$description1Field = $_POST['description1'];
$description2Field = $_POST['description2']; 
```

并将其发布在我正在使用它来测试的电子邮件上：

> ```
> $body = <<<EOD 
> ```
> 
> * * *
> 
> * * *
> 
> 电子邮件：$email
> 公司名称：$company_name
> 日期：$date
> 电话：$phone
> $part1 | $描述1 | $quantity1
> EOD；

我知道通过收集动态值的变量，需要有不同的代码，我被困在那里。如果有人可以指导我找到正确的解决方案，我将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:46:16.897

您可以使用数组：

```
<div id="inputContainer">
    <div class="clonedInput">
        Part #: <input name="part[]" type="text" class="part" size="10" maxlength="15" />
        <button type="button" class="remove">Remove</button>
        <button type="button" class="clone">Clone</button>
    </div>
</div>
<div id="toolbar">
        <button type="button" class="add">Add new</button>
</div> 
```

使用以下代码，您可以删除和克隆单个输入：

```
var limit = 20;
$('#inputContainer').on('click', '.clonedInput>.remove', function(e) {
    $(this).parent().fadeOut().remove();
    if ($(this).parent().parent().length < limit) {
        $('#toolbar>.add').removeAttr('disabled');
    }
});

$('#toolbar').on('click', '.add', function(e) {
    var newElem = $('<div class="clonedInput">\
        Part #: <input name="part[]" type="text" class="part" size="10" maxlength="15" />\
        <button type="button" class="remove">Remove</button>\
        <button type="button" class="clone">Clone</button>\
    </div>');

    $('#inputContainer').append(newElem);
    if($('#inputContainer').length == limit) {
        $('#toolbar>.add').attr('disabled', 'disabled');
    }
});

$('#inputContainer').on('click', '.clonedInput>.clone', function(e) {
    var newElem = $(this).parent().clone().fadeIn('slow');

    $(this).parent().after(newElem);
    if ($(this).parent().parent().length == limit) {
        $('#toolbar>.add').attr('disabled', 'disabled');
    }
}); 
```

见[小提琴](http://jsfiddle.net/FwpUj/)。

您现在可以使用数组键访问 PHP 中的各个输入字段：

```
echo $_POST['part'][0]; // first 'part' field

// print all fields
$mailData = '';
for($i = 0; $i < count($_POST['part']); $i++) {
    $mailData .= '#' . $_POST['part'][$i] . ' | ';
    $mailData .= $_POST['description'][$i] . ' | ';
    $mailData .= $_POST['quantity'][$i] . PHP_EOL;//or replace PHP_EOL for "<br>\n" it will work just fine

}

$body = <<<EOD
Email: $email
Company Name: $company_name
Date: $date
Phone: $phone
$mailData
EOD;

your_mail_function($body); 
```

# c - C 中如何返回 void* 指针？

> ID：14446529
> 
> 赞同：3
> 
> 时间：2013-01-21T20:19:57.850
> 
> 标签：c, gcc, assembly, return

基本上，我需要知道从 C 函数返回的寄存器 void* 指针放在什么位置。我有这个代码：

```
void* kmalloc(unsigned int size)
{
    asm("mov %[size], %%esi"
    : /* no outputs */
    : [size] "m" (size)
    : "esi");
    asm("movl $9, %eax");
    asm("int $0x80");

} 
```

这应该将地址放入 EAX。我认为 C 中的返回值存储在 EAX 中，但显然不是，（哦，我正在使用 GCC BTW）。我需要一些如何返回 EAX，由于编译器设置，寄存器 int 也不起作用。是否有用于返回指针的寄存器？还是像推到堆栈上一样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T21:01:25.140

这不是编写内联汇编的有效方法。即使您将返回值放在正确的寄存器中，它也可能在函数实际返回时丢失/破坏，因为编译器可以添加任意结尾代码。您必须使用输出约束和`return`语句来返回内联 asm 的结果：

```
void* kmalloc(unsigned int size)
{
    void *p;
    asm("int $0x80" : "=a"(p) : "S"(size), "a"(9));
    return p;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T20:24:12.947

测试代码：

```
void * myfunc(void) { return (void *) 0x20341022; } 
```

编译（带`gcc --save-temps -O2 -c test.c`）为：

```
myfunc:
.LFB0:
    .cfi_startproc
    movl    $540282914, %eax
    ret
    .cfi_endproc 
```

答案很明显。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T21:11:02.947

您应该声明内联汇编代码如何使用输出约束返回结果，如下所示：

```
void* kmalloc(unsigned int size)
{
   void *result;
   asm("mov %[size], %%esi\n"
       "movl $9, %%eax\n"
       "int $0x80"
   : "=a" (result)
   : [size] "m" (size)
   : "esi");

   return result;
} 
```

`"=a"`告诉编译器将内容移动到`EAX`结果变量。

请注意，我还将所有 asm 语句分组在一个块中，这样我只需要为该块指定输入/输出，而不是为每个语句本身指定输入/输出。

编译它`gcc -O3 x.cpp -S`会显示生成的编译代码：

```
_kmalloc:
Leh_func_begin1:
    pushq   %rbp
Ltmp0:
    movq    %rsp, %rbp
Ltmp1:
    movl    %edi, -4(%rbp)
    ## InlineAsm Start
    mov -4(%rbp), %esi
    movl $9, %eax
    int $0x80
    ## InlineAsm End
    popq    %rbp
    ret
Leh_func_end1: 
```

请注意，优化器计算出`result`变量 equals `EAX`，因此不需要在堆栈上分配。

# c# - 如何使用日期范围从 Redis (pub/sub) 保存和检索频道数据？

> ID：14446531
> 
> 赞同：2
> 
> 时间：2013-01-21T20:20:12.207
> 
> 标签：c#, wcf, redis, booksleeve

*最初我询问了查询 .rdb 文件的问题，这不是我想做的——我将查询一个活动服务器。*

我即将开始一个项目，我们将在发布/订阅场景中使用 Redis，使用 RDB 快照。

.Net WCF 客户端将通过[Marc Gravell 的](https://stackoverflow.com/users/23354/marc-gravell) [BookSleeve](http://code.google.com/p/booksleeve/)配置 Redis 连接并接受传入请求。

启用 RDB 快照后，将创建增量快照。

我希望客户端能够根据给定的渠道和日期范围检索数据集。我在想我会使用相同的 WCF 客户端进行读写（除非有任何明显的反对意见）。我不完全清楚使用什么方法来查询服务器来检索日期范围、通道特定数据，并通过 WCF 客户端提供这些数据。

我是否可以通过 BookSleeve 实现此数据查询功能（如果可以，如何实现）或者是否有其他更适合使用的访问包装器，例如[ServiceStack.Redis](https://github.com/ServiceStack/ServiceStack.Redis)。

使用 BookSleeve 进行写入，使用 ServiceStack.Redis 作为客户端会更好吗？

**- 更新 -**

我已将快照设置为默认值：

```
save 900 1
save 300 10
save 60 
```

[使用Redis Admin UI](https://github.com/ServiceStack/ServiceStack.RedisWebServices)浏览数据，我希望在 15 分钟（900 秒）后看到存储在键中的一些数据，但是，搜索键会显示通道名称（和其他键），但其中没有值。

由于发布/订阅事件[没有持久化](http://blog.joshsoftware.com/2011/01/03/do-you-need-a-push-notification-manager-redis-pubsub-to-the-rescue/)，那么捕获通道数据并存储它的好方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T10:40:29.400

编辑以解决 OP 的编辑：

如前所述：发布/订阅不会持久化。我建议*使用队列*；redis 中的“列表”类型非常适合这种情况，其中`lpush`, `rpush`, `lpop`, `rpop`,`rpoplpush`以及`ltrim`所有这些都是该场景的关键命令。您也可以选择使用 pub/sub*来*通知客户端新数据的可用性 - 或者您可以使用阻塞弹出命令`blpop`、`brpop`和`brpoplpush`。所有这些操作都[在这里](http://redis.io/commands#list)定义。

* * *

我可以澄清一下：听起来您有一堆 rdb 文件，并且想要从任意文件中读取（“增量快照”）。这对吗？

除非您使用专用工具来解析它们，否则 rdb 文件本身并不是很有用。Redis 客户端（如 BookSleeve 和 ServiceStack）期望与正在运行的 Redis 实例进行通信。您的问题听起来有点像“我有一系列日期的 sql-server .bak 文件；我如何从中获取数据`SomeTable`？” - 答案是“首先将 bak 加载到 SQL Server 中”。

启动 redis-server 非常简单，但它不希望从多个 rdb 文件中读取。

选项：

1.  手动解析rdb；[看到这个线程](https://groups.google.com/forum/?fromgroups=#!topic/redis-db/P5ytSaZHkBo)- 期待痛苦
2.  在需要时为每个文件动态启动一个 redis-server 实例......好吧，*它会工作*，但流程管理可能会变得“有趣”
3.  提前为每个文件启动一个 redis-server 实例......然后你需要担心端口管理/映射，以及监视新文件
4.  使用热加载`DEBUG RELOAD`；***但是***，这并不是真的很受支持，并且在测试中我无法让它正常运行（特别是，它似乎`SAVE`在重新加载之前做了一个，使其不适合这种情况）

但归根结底，拥有一系列不同的 rdb 文件供您即时选择并不是 Redis 的正常用例。

如果我了解您的要求，那么*这不是客户端问题*，更不用说特定于平台的问题（.NET、C#、WCF 等）：首先您需要弄清楚您将如何运行服务器(s) 或以其他方式阅读文件。最好在[Redis DB中问](https://groups.google.com/forum/?fromgroups=#!forum/redis-db)

# java - 一种在 Java 中初始化空字符串数组的优雅方法

> ID：14446539
> 
> 赞同：25
> 
> 时间：2013-01-21T20:20:35.833
> 
> 标签：java, arrays, string

在我正在处理的当前代码库中，我发现自己需要初始化许多不同长度的空 String[]。

到目前为止，它们始终以以下方式初始化：

```
String[] a = new String[]{"","","","","","","","",""} // etc... 
```

虽然这是一个简单的单行解决方案，但我个人的偏好是它相当难看。

我只是想知道是否有人知道任何现有的 API/实用程序，它们提供了一种可以更优雅地初始化空字符串数组的方法。我在想一些事情：

```
StringUtils.*initialiseEmptyArray*(int size); 
```

有谁知道任何这样的方法？

如果需要，我总是可以自己写，只是不想重新发明轮子，如果它已经完成了。

谢谢

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-01-21T20:22:35.380

您可以使用[`Arrays.fill`](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#fill%28java.lang.Object[],%20java.lang.Object%29)方法： -

```
Arrays.fill(a, ""); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-01-21T20:23:02.537

使用[Arrays.fill](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#fill%28java.lang.Object%5B%5D,%20java.lang.Object%29)：

```
String[] a = new String[9];
Arrays.fill(a, ""); 
```

# windows-8 - 在没有 iFrame 的情况下将 webapp 包装到 Windows 8“Metro”应用程序中

> ID：14446543
> 
> 赞同：2
> 
> 时间：2013-01-21T20:20:48.800
> 
> 标签：windows-8, visual-studio-2012

我想将我们的 Web 应用程序封装到 Windows 8“Metro 风格”应用程序中。

在 Visual Studio for Win8 中设置 Javascript 样式应用程序时，它会创建一个“default.html”文件。我能够成功地使用 iframe 来加载我们的 Web 应用程序，但是这个解决方案不优雅而且有问题。即，存在无法从 iframe 中加载的资源，从而导致问题（例如，`FORBIDIFRAME`错误）。

在 OSX 中，我通过简单地使用嵌入式 Web 浏览器和 Javascript 桥来完成同样的事情。浏览器直接加载 Web 应用程序 URL，而不是使用具有嵌入式 iFrame 作为代理的本地 HTML 文件。

有没有办法在 Windows 8 中完成同样的事情？还是我被迫使用本地 HTML 文件并将我们的 webapp 加载到 IFrame 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:51:09.120

您可以改为创建一个基于 Xaml 的项目，并添加一个全尺寸的[WebView 控件](http://msdn.microsoft.com/library/windows/apps/windows.ui.xaml.controls.webview.aspx)，并在其上加载您的网站。

# internet-explorer - 如何在 Internet Explorer 的 iframe 中为键入的文本设置颜色

> ID：14446548
> 
> 赞同：0
> 
> 时间：2013-01-21T20:21:05.083
> 
> 标签：internet-explorer, iframe, text, colors, editor

我在我的富文本编辑器中使用了一个由 execCommand 函数工作的 Iframe。现在我可以更改 iframe 中任何现有文本的颜色，但我无法让 IE 将选择的颜色设置为输入下一个文本时要使用的颜色。

起初，我以为这只是一个焦点问题，但当我重新集中注意力时，结果是一样的。对焦完全解决了FF中的问题，但是IE在重新对焦时会输入黑色。

我该怎么做才能将输入的下一个文本设置为某种颜色？

提前感谢您的帮助。

# javascript - 使用 AJAX 在 JSON 中进行字符编码

> ID：14446559
> 
> 赞同：0
> 
> 时间：2013-01-21T20:21:58.667
> 
> 标签：javascript, ajax, json, character-encoding

我想从 Open Data Wien [Json](http://data.wien.gv.at/daten/wfs?service=WFS&request=GetFeature&version=1.1.0&typeName=ogdwien%3aMUSEUMOGD&srsName=EPSG:4326&outputFormat=json)加载一个 JSON 文件

```
$.ajax({
    type: "GET",
    url: jsonData,
    contentType: "application/json; charset=ISO-8859-1",
    dataType: "json",
    data: "",
    success: function(json) {
        $.each(json, function (key, val) {
           getJson(val);
        });
        $("#divMessage").css("display", "none");
    },
    error: function (xhr, textStatus, errorThrown) {
        $("#error").html(xhr.responseText);
    }
}); 
```

但是 ä,ö 等都坏了，我尝试了 utf-8 等但没有任何效果。

有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:26:13.327

如果您使用的是脚本语言文件，您可以这样做：（可能会有些慢，但如果您没有问题...）

```
<?php
header('Content-Type: application/json; charset=utf-8', true);

print(getUTF8("http://data.wien.gv.at/daten/wfs?service=WFS&request=GetFeature&version=1.1.0&typeName=ogdwien%3aMUSEUMOGD&srsName=EPSG:4326&outputFormat=json"));

function getUTF8($url){
    //if(is_valid_url){make all checkings to avoid errors and assure that the URL is valid;
    if($read = file_get_contents($url)){
        return trim(utf8_encode($read));
    }
    else return "error";    
}
?> 
```

和/或使用[PHPJS 中的此 JavaScript 函数检索您的数据](http://phpjs.org/functions/utf8_encode/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:23:51.230

这可能是显示问题，这意味着 JSON 可能不是问题。

尝试直接在 HTML 标记中添加这些字符 (ä,ö)，如果它们出现“损坏”，那么您可能可以消除 JSON 作为问题的根源。

在HTML 文档的部分添加`Content-Type`元标记通常可以解决此类问题`<head>`

```
<meta http-equiv='Content-Type' content='text/html; charset=utf-8'> 
```

# r - 未知累积函数的反函数

> ID：14446569
> 
> 赞同：6
> 
> 时间：2013-01-21T20:22:17.427
> 
> 标签：r, statistics, kernel, quantile

我正在处理一个数据文件，里面的观察结果是随机值。在这种情况下，我不知道 x 的分布（我的观察）。我使用函数密度来估计密度，因为我必须应用核估计。

```
T=density(datafile[,1],bw=sj,kernel="epanechnikov") 
```

在此之后我必须整合它，因为我正在寻找一个分位数（类似于 VaR，95%）。为此，我有 2 个选项：

```
ecdf()
quantile() 
```

现在我有了分位数 95 的值，但这是内核估计的数据。

**是否有一个函数可以用来知道原始数据的分位数 95 的值？**

我说这是一个未知的分布，为此我想将非参数方法想象成牛顿，就像 SAS 中的方法一样`solve()`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T20:28:20.130

你可以用[`quantile()`](http://stat.ethz.ch/R-manual/R-patched/library/stats/html/quantile.html)这个。这是使用随机数据的示例：

```
> data<-runif(1000)

> q<-quantile(data, .95)
> q
      95% 
0.9450324 
```

在这里，数据均匀分布在 0 和 1 之间，因此第 95 个百分位数接近 0.95。

要执行逆变换：

```
> ecdf(data)(q)
[1] 0.95 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-24T15:15:26.897

不知道这是否与您有任何相关性...但是我认为可能对上述答案有帮助

```
data <- rnorm(1000)

my_ecdf <- ecdf(data)

my_ecdf_inv <- function(x) {quantile(data, x)}

my_ecdf_inv(my_ecdf(2))

x <- seq(-3, 3, 0.1)
plot(x, sapply(sapply(x, my_ecdf),my_ecdf_inv)) 
```

# c#-4.0 - Task.WaitAll() 不锁定主 UI

> ID：14446576
> 
> 赞同：2
> 
> 时间：2013-01-21T20:22:47.217
> 
> 标签：c#-4.0

我将以下作业发送到多个线程以从主 UI 线程进行处理。完成所有作业后，我需要发出一条消息“作业已完成”，让用户知道它已完成。

```
LimitedTaskScheduler scheduler = new LimitedTaskScheduler(4);
TaskFactory factory = new TaskFactory(scheduler);
MessageBox.Show("Job started");
for (int i = 0; i < rows.Length; i++)
{
  string tabName = rows[i]["TableName"].ToString();
  int nStatus;
  factory.StartNew<int>(() =>
  {
   nStatus = ProcessTable(tabName);
   return nStatus;
  });
}
MessageBox.Show("Job finished"); 
```

在上面的代码中，MessageBox.Show("Job finished"); 任务发送后立即执行，这是错误的。如果我使用 Task.WaitAll(); 它会锁定我不想要的主 UI 线程。

我的问题是在所有任务完成而不锁定主 UI 线程的情况下显示“作业完成”消息的最佳方式是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:24:34.560

您应该使用`Task.WhenAll()`创建一个新任务，该任务将在所有其他任务完成*后完成。*

然后，您可以调用`ContinueWith()`该任务以在 UI 线程上运行回调。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:27:07.700

如果您只需要通知用户，只需为任务创建一个[延续](http://msdn.microsoft.com/en-us/library/dd321307.aspx)，但传递您通过UI 线程中`TaskScheduler`的调用获得的延续。`TaskScheduler.FromCurrentSynchronizationContext`

此延续将在父任务完成后在 UI 线程中执行。

# html - 在 mvc 2.0 视图上从数据库渲染 HTML 标签

> ID：14446577
> 
> 赞同：1
> 
> 时间：2013-01-21T20:22:47.693
> 
> 标签：html, asp.net-mvc, asp.net-mvc-2, html-rendering

我们正在使用 mvc 2.0 我们从 db 获取正文，它以这种格式存储

```
 (strore in db as varchar) 
"<p>Thank you for submitting your feedback about recent experience</p>  
<p>Regards,</p>  
<p>The XYZ team</p>"

 (This is what I am trying on View)
 <div>
            <%= Html.TextAreaFor(dataModel => dataModel.body, new { @class ="row-class", @rows = 20 })%>
</div> 
```

目前，内容在 TextArea 中显示为 HTML 标签，这是我不想要的。我只想按照 html 显示格式化的文本。我已经尝试了一些类似@Html.Raw 的方法，但还是有道理的。如果有人遇到过此类问题，请告诉我，或者任何可以引导我走向正确方向的文章也会有所帮助。

谢谢你的时间..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:27:17.490

要将其显示为 html，请尝试`@Html.Raw(Model.body)`（或 Model.body，无论您的属性名称是什么）。

要编辑 html，您需要一个 html 编辑器。我为此使用了[TinyMce](http://www.tinymce.com/)，对此我很满意。

甚至还有一个[nuget 包](http://nuget.org/packages/TinyMCE)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T01:53:40.380

你试过简单`<%= Model.Body %>`

# windows-8 - 推荐用于 Windows8 / Windows-Phone-8 游戏开发的图像格式和大小？

> ID：14446585
> 
> 赞同：1
> 
> 时间：2013-01-21T20:23:16.420
> 
> 标签：windows-8, svg, windows-phone-8, screen-resolution, image-formats

背景信息：我刚刚开始为新的 W8 WP8 系统开发我的第一个 Silverlight/c# 游戏。我想从一开始就做正确的基础知识。

我不想遇到可用的不同设备和分辨率的问题，最终得到大量图像，我最终需要这些设备的不同屏幕尺寸和分辨率。

所以我想在incscape中做整个成像并创建svg图像。但是似乎没有简单的方法来集成我生成的 svg 图像或 xaml 代码，这些代码不是硬编码的。

具体问题：我的问题是，在处理大量不同的屏幕分辨率和设备（如低成本 WP8 手机或高端平板电脑）时，您会推荐哪种图像格式策略？

当我想开发一款可在 WP8 上运行并作为 Win 8 上的 Metro 应用程序的游戏时，矢量图形（SVG、XAML）是真正的替代品吗，还是我只需要为我的 png 图像处理几个不同的分辨率出色地？

感谢您对此提供的任何提示或您可以向我展示的任何方向。

丹尼尔

# tags - 我怎样才能让每个标签（任何语言）移动到下一行？

> ID：14446586
> 
> 赞同：0
> 
> 时间：2013-01-21T20:23:19.907
> 
> 标签：tags, notepad++

在记事本++中有没有办法让每个标签（任何语言的）移动到下一行？

而不是像这样水平堆叠标签：

```
<!DOCTYPE html><html><body><h2>Norwegian Mountain Trip</h2><img border="0" src="/images/pulpit.jpg" alt="Pulpit rock" width="304" height="228"></body></html> 
```

我想将每个标签放在单独的行上，如下所示：

```
<!DOCTYPE html>
<html>
<body>

<h2>Norwegian Mountain Trip</h2>
<img border="0" src="/images/pulpit.jpg" alt="Pulpit rock" width="304" height="228">

</body>
</html> 
```

而且我不是在询问自动换行，因为它不会使每个标签都在单独的行上。

有没有办法在记事本++上做到这一点？

非常感谢！

罗伊。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:28:21.020

选择搜索模式扩展，尝试查找和替换

寻找`>`

代替`>\n`

这将在每个以结尾的标签后添加换行符`>`

# php - 我的第一个 CRON 作业出错... [包括错误消息]

> ID：14446589
> 
> 赞同：0
> 
> 时间：2013-01-21T20:23:33.667
> 
> 标签：php, cron, mysqli, cpanel, hostmonster

我在运行 cron 作业时遇到了一点问题。如果数据库中的日期与今天的日期匹配，我创建了这个脚本来帮助我自动发送电子邮件公告，否则它将向管理员发送电子邮件以通知他们没有发送公告。我检查了所有电子邮件以及电子邮件组收件箱都存在，并且没有收到任何电子邮件。下面写的脚本，然后是我在 cron 作业运行时收到的电子邮件错误。提前致谢！

```
//Set variable which contains the query to the database
$userbcc = $connection->prepare("SELECT email FROM users ORDER BY email ASC") or die("could not connect");

//Execute the query through MySQLi
$userbcc->execute();

//Stores the number for counting
$userbcc->store_result();

//Bind results to their variables
$userbcc->bind_result($email);

//While results 
while ($userbcc->fetch()) {
    $userlist .= $email . ",";
}

//Count the rows
$user_rows = $userbcc->num_rows;

$userbcc->close();

//Set and sanitize the variable which contains perameter
$today = date("Y-m-d 00:00:00");

//Set variable which contains the query to the database
$mailpromo = $connection->prepare("SELECT id,venid,title,intro,body,sdate,edate FROM venpromo WHERE `sdate` =  ?") or die("could not connect");

//Set the query 'WHERE state = ?' to the query
$mailpromo->bind_param("s",$today);

//Execute the query through MySQLi
$mailpromo->execute();

$mailpromo->store_result();

//Bind results to their variables
$mailpromo->bind_result($id,$venid,$title,$intro,$body,$sdate,$edate);

$ad_rows = $mailpromo->num_rows;

//While results 
while ($mailpromo->fetch()) {
    $to = "[EMAIL ADDRESS]";
    $from = "[EMAIL ADDRESS]";
    $subject = "A New Promo Starts Today! \"$title\"";
    $message = "MESSAGE";
        $headers = "From: Norris Portal Intranet System <[EMAIL ADDRESS]>\r\n";
    $headers .= "Reply-To: ". strip_tags($from) . "\r\n";
    $headers .= "BCC: " . substr($userlist, 0, -1) . "\r\n";
    $headers .= "MIME-Version: 1.0\r\n";
    $headers .= "Content-Type: text/html; charset=ISO-8859-1\r\n";
    if ($from != "" && $to != "" && $subject != "" && $message != "") {
        if (mail($to, $subject, $message, $headers)) {
            $mailsuccess = 1;
        } else {
            $mailfail = "1";
        }
    } else {
        $mailfail = "1";
    }
}

$mailpromo->close();

if ($ad_rows == 0) {
    $to = "[EMAIL ADDRESS]";
    $from = "[EMAIL ADDRESS]";
    $subject = "There were no promo's pulled from today's bulletin.";
    $message = "There were no promo's emailed to the staff today. Only promo's with a start day of today will be emailed to the staff.";
    $headers = "From: Norris Portal Intranet System <[EMAIL ADDRESS]>\r\n";
    $headers .= "Reply-To: ". strip_tags($from) . "\r\n";
    $headers .= "BCC: [EMAIL ADDRESS]\r\n";
    $headers .= "MIME-Version: 1.0\r\n";
    $headers .= "Content-Type: text/html; charset=ISO-8859-1\r\n";
    if ($from != "" && $to != "" && $subject != "" && $message != "") { 
        if (mail($to, $subject, $message, $headers)) { 
            $mailsuccess = 1;
        } else {
            $mailfail = "1";
        }
    } else {
        $mailfail = "1";
    }
}

?> 
```

错误电子邮件：

```
220-host238.hostmonster.com ESMTP Exim 4.80 #2 Mon, 21 Jan 2013 13:10:02 -0700 
220-We do not authorize the use of this system to transport unsolicited, 
220 and/or bulk e-mail.
250-host238.hostmonster.com Hello localhost.localdomain [127.0.0.1]
250-SIZE 52428800
250-8BITMIME
250-PIPELINING
250-AUTH PLAIN LOGIN
250-STARTTLS
250 HELP
250-host238.hostmonster.com Hello localhost [127.0.0.1]
250-SIZE 52428800
250-8BITMIME
250-PIPELINING
250-AUTH PLAIN LOGIN
250-STARTTLS
250 HELP
250 OK
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
250 Accepted
550 No Such User Here" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T15:35:35.573

我重写了我的代码，这很有效......解决方案是首先提取内容并使用 while 循环逐个通过电子邮件发送内容，而不是将所有电子邮件添加到密件抄送：列表...

```
//Set variable which contains the query to the database
$mailpromo = $connection->prepare("SELECT id,venid,title,intro,body,sdate,edate FROM venpromo WHERE `sdate` =  ?") or die("could not connect");

//Set the query 'WHERE state = ?' to the query
$mailpromo->bind_param("s",$today);

//Execute the query through MySQLi
$mailpromo->execute();

//Stores the number for counting
$mailpromo->store_result();

//Bind results to their variables
$mailpromo->bind_result($id,$venid,$title,$intro,$body,$sdate,$edate);

//Bind results to their variables
$mailpromo->fetch();

//Count the number of bulletins today
$mail_count = $mailpromo->num_rows;

//Close the session
$mailpromo->close();

//Set variable which contains the query to the database
$userbcc = $connection->prepare("SELECT email FROM users") or die("could not connect");

//Execute the query through MySQLi
$userbcc->execute();

//Stores the number for counting
$userbcc->store_result();

//Bind results to their variables
$userbcc->bind_result($email);

//While results 
while ($userbcc->fetch()) {

    $to = $email;
    $from = "[email held]";
    $subject = "A New Promo Starts Today! \"$title\"";
    $message = "[content held]"

    $headers = "From: [email held] \r\n";
    $headers .= "Reply-To: ". strip_tags($from) . "\r\n";
    $headers .= "MIME-Version: 1.0\r\n";
    $headers .= "Content-Type: text/html; charset=ISO-8859-1\r\n";
    if ($from != "" && $to != "" && $subject != "" && $message != "") {
        if (mail($to, $subject, $message, $headers)) {
            $mailsuccess = 1;
        } else {
            $mailfail = "1";
        }
    } else {
        $mailfail = "1";
    }

}

//Close the session
$userbcc->close();

if ($mail_count == 0) {
    $to = "[email held]";
    $from = "[email held]";
    $subject = "There were no promo's pulled from today's bulletin.";
    $message = "There were no promo's emailed to the staff today. Only promo's with a start day of today will be emailed to the staff.";
    $headers = "[email held]\r\n";
    $headers .= "Reply-To: ". strip_tags($from) . "\r\n";
    $headers .= "BCC: [email held]\r\n";
    $headers .= "MIME-Version: 1.0\r\n";
    $headers .= "Content-Type: text/html; charset=ISO-8859-1\r\n";
    if ($from != "" && $to != "" && $subject != "" && $message != "") { 
        if (mail($to, $subject, $message, $headers)) { 
            $mailsuccess = 1;
        } else {
            $mailfail = "1";
        }
    } else {
        $mailfail = "1";
    }
}

?> 
```

# binary - 如何在 Erlang 中对二进制文件进行模式匹配？

> ID：14446596
> 
> 赞同：2
> 
> 时间：2013-01-21T20:23:47.723
> 
> 标签：binary, erlang, pattern-matching

我想对二进制文件进行递归，并在每次调用中从二进制文件中读取多达 32 位，并将其返回到一个新的二进制文件中。但我无法让模式匹配按我的意愿工作。

```
binaryToBinary(Source) ->
    binaryToBinaryAux(Source, <<>>).

binaryToBinaryAux(<<>>, Target) ->
    Target;
binaryToBinaryAux(<<H:32/binary, T/binary>>, Target) ->
    binaryToBinaryAux(<<T/binary>>, <<Target/binary, H>>). 
```

这是我得到的模式匹配错误：

```
10> mymodule:binaryToBinary(<<"JonasPonas">>).
** exception error: no function clause matching
                    mymodule:binaryToBinaryAux(<<"JonasPonas">>,<<>>) 
                                                          (mymodule.erl, line 51) 
```

我对二进制文件的模式匹配做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T20:56:18.293

该模式`<<H:32/binary, T/binary>>`匹配至少包含 32 个字节的二进制文件，将前 32 个字节分配给 H，将剩余字节分配给 T。该模式`<<>>`匹配空二进制文件。这些是您唯一的模式。

`<<"JonasPonas">>`既不是空的，也没有至少 32 个字节。因此，它与您的任何一种模式都不匹配，并且您会遇到错误。

要解决此问题，请添加一个模式来处理小于 32 字节的二进制文件（您也可以去掉空模式，因为它会变得多余）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T15:21:49.423

这应该可以纠正：

```
binaryToBinary(Source) ->
    binaryToBinaryAux(Source, <<>>).

binaryToBinaryAux(<<>>, Target) ->
    Target;
binaryToBinaryAux(<<H:32/binary, T/binary>>, Target) ->
    binaryToBinaryAux(<<T/binary>>, <<Target/binary, H/binary>>);
binaryToBinaryAux(Rest, Target) ->
    binaryToBinaryAux(<<>>, <<Target/binary, Rest/binary>>). 
```

# android - 从文件路径中检索 ContentProvider 条目

> ID：14446600
> 
> 赞同：0
> 
> 时间：2013-01-21T20:24:01.590
> 
> 标签：android, android-contentprovider, mediastore

我非常需要从来自几个不同用例的歌曲中检索艺术家和曲目。我通常可以`content://`很容易地从 mp3 uri（方案：）查询 MediaStore，但有时我会收到文件路径（方案：）`file://`。我偶然发现了 StackOverflow 上的这篇文章： [Get MediaStore content Uri from File path?](https://stackoverflow.com/questions/5045965/get-mediastore-content-uri-from-file-path)

不幸的是，它看起来对我不起作用。我肯定在某个地方做错了什么，但我不知道在哪里。这是我使用的代码，我给它的文件路径在执行之前已经过验证。

这是一段代码：

```
 private void getTrackFromFilePath(String filePath) {

    String[] filePathColumn = {
            MediaStore.Audio.Media.TITLE, //
            MediaStore.Audio.Media.ARTIST
    };

    Uri musicUri = MediaStore.Audio.Media.EXTERNAL_CONTENT_URI;
    Logger.e(TAG, musicUri.toString() + " filePath: " + filePath);

    Cursor cursor = getContentResolver().query(musicUri, filePathColumn, MediaStore.Audio.Media.DATA + " LIKE ?", new String[] {
        filePath
    }, null);
    cursor.moveToFirst();

    DatabaseUtils.dumpCursor(cursor);

    cursor.close();
} 
```

这是相关的logcat：

```
01-21 12:14:40.345: E/MusicScannerActivity(13513): content://media/external/audio/media filePath: file:///mnt/sdcard/Music/07%20Olly%20Murs%20Feat%20Flo%20Rida%20-%20Troublemaker.mp3
01-21 12:14:40.350: I/System.out(13513): >>>>> Dumping cursor android.content.ContentResolver$CursorWrapperInner@41e03748
01-21 12:14:40.350: I/System.out(13513): <<<<< 
```

我尝试在我请求的列上进行一些操作，但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:25:45.677

对于那些想知道的人，我自己找到了我的问题的答案，并且有几件事阻止了这个东西的工作。第一个是我得到的文件路径中表示的空格是这样编码的：`%20`，但只是空格，`MediaStore`所以无法进行匹配。第二个是我得到的文件有`file://`计划，`MediaStore`但不包括在内。

我基本上通过这样做解决了这个问题：

```
 filePath = filePath.replace("file://", "");
    filePath = filePath.replace("%20", " "); 
```

# ios - IOS。segue.destinationViewController 对象与加载的Controller不同

> ID：14446601
> 
> 赞同：1
> 
> 时间：2013-01-21T20:24:09.767
> 
> 标签：ios, uinavigationcontroller, segue

我正在尝试使用导航控制器在两个 ViewController 之间进行转换，segue.destinationViewController 引用的对象是：0x1cd93590（下一个视图），但是当对新视图进行更改时，它具有不同数量的对象： 0x1cd4556d0。我的代码是：

```
- (void)updateCodeProduct:(NSString *)code {
    [session stopRunning];

    AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);
    AudioServicesPlaySystemSound(1111);

    // db acces.
    NSString *cadena = @"http://172.20.10.2/consultaProd.php?codigo=";
    cadena = [cadena stringByAppendingString:codigo];
    NSURL *url = [NSURL URLWithString:cadena];
    NSError *error = nil;

    NSString *retorno = [[NSString alloc] initWithContentsOfURL:url encoding:NSASCIIStringEncoding error:&error];
    if (retorno == nil) {
        NSLog(@"Error %@\n%@", url, [error localizedFailureReason]);
        return;
    }

    self.detailProd = nil;
    self.detailProd = [retorno componentsSeparatedByString:@"\n"];

    [self performSegueWithIdentifier:@"DetailSegue" sender:self];    
} 
```

prepareForSegue 方法是：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
NSLog(@"%@", [segue destinationViewController]);

    if ([segue.identifier isEqualToString:@"DetailSegue"]) {
        [segue.destinationViewController updateDetail:detailProd];
    }
} 
```

执行了segue，但视图不反映当前信息，因为是不同的对象。

任何帮助将不胜感激 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:58:05.437

该`updateDetail`方法有什么作用？如果它试图更新目标控制器中的控件，那么这样做还为时过早，因为尚未创建控件。您只想`NSString`在目标控制器中设置属性（例如 a 或其他）。然后目标控制器应该获取该属性并更新其在`viewDidLoad`该目标控制器中的控件。

简而言之，目标控制器的地址将与视图控制器本身的地址相同。你没有向我们展示你`NSLog`报告的那两个地址的陈述，所以我们不可能说出那里发生了什么。

# html - iPad 和 HTML5 视频标签

> ID：14446602
> 
> 赞同：1
> 
> 时间：2013-01-21T20:24:10.553
> 
> 标签：html, ipad, nexus-7

下午好，我已经搜索了 stackoverflow 页面和网络，但似乎找不到答案。我有一个使用 HTML5 视频标签的网站。我使用 MP4 文件作为我的视频文件。我创建了一个简单的标签：

```
<video id="videoPlayer" width="958px" height="444px" src="video/test.mp4" controls>
  NOT Supported
</video> 
```

当我在 PC 浏览器中打开时，它工作得很好，可以按我的意愿播放。当我在 iPad 或 Nexus 7 上打开文件时，会发生以下情况：

iPad：我有一个播放按钮，上面有一条线。Nexus 7：我有一个播放按钮。当我按下播放按钮时，没有任何反应。

起初我认为这是我做错了什么，所以我去了我 iPad 上的 W3Schools 视频标签部分，示例视频也没有加载到那里。我检查了 iOS 版本，它是 5.1.1 的最新版本。我不知道该怎么做。请帮忙。提前致谢。

# c# - c# 发送电子邮件消息线程

> ID：14446604
> 
> 赞同：-3
> 
> 时间：2013-01-21T20:24:16.590
> 
> 标签：c#

当用户填写在线表格时，我在 c# .NET 中使用以下内容发送电子邮件。我想知道我所拥有的是否需要线程。

```
MailAddress From = new MailAddress("xyz@qinc.com");
MailAddress To = new MailAddress(toemail);
MailMessage alert = new MailMessage(From, To);
alert.Subject = "Registration for " + name;
alert.Body = bodyText;
alert.IsBodyHtml = true;
NetworkCredential creds = new NetworkCredential("bot@qinc.com", "Xfdfdfd");
SmtpClient client = new SmtpClient("smtp.gmail.com");
client.EnableSsl = true;
client.Credentials = creds;
client.Send(alert); 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:30:22.607

如果您在电子邮件中嵌入了某种附件和/或您的电子邮件是 HTML 类型并且非常大，并且您的带宽很低，我建议您将该功能放入一个线程中以保持您的应用程序具有响应性。

线程提高了应用程序的响应能力，它将缓慢、耗时、阻塞的任务放在一个单独的容器中（我喜欢这个类比），并且不允许你的应用程序下沉。用户*讨厌*“这个程序没有响应”程序。

# testing - 如何获得简单的 clojurescript 编译的直接结果？

> ID：14446605
> 
> 赞同：1
> 
> 时间：2013-01-21T20:24:17.403
> 
> 标签：testing, clojure, clojurescript, cljsbuild

我希望能够在测试时将 javascript 代码注入我的应用程序。按照这种推理，我在 repl 中执行以下操作。

```
=> (cljs.closure/build '(swap! my-project.my-namespace.my-atom inc) {})
<= "goog.addDependency(\"base.js\", ['goog'], []);\ngoog.addDependency(\"../x8LL7.js\", [], []);" 
```

我那时

```
=> more out/x8LL7.js 
<= cljs.core.swap_BANG_.call(null,my_project.my_namespace.my_atom,cljs.core.inc); 
```

是的，看来这就是我想要的。我可能弄错了，但我认为我不需要“base.js”依赖项，因为它已经包含在正在运行的正在测试的应用程序中（正在使用 :simple :optimizations）。

我的问题是，我怎样才能得到文件的内容`out/x8LL7.js`？我只想要写入的字符串，`out/x8LL7.js`因为我对从`cljs.closure/build`.

如果这不容易，那我想我可以解析返回的 deps 字符串，自己打开文件然后使用内容；没有大碍。不过，我希望有更直接的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T00:22:18.973

更直接的方法是注入 js 代码（如 'var DEBUG=true;'），然后从 clojurescript 引用它。注入 clojurescript 是有风险的，因为对于将编译的 js 代码 clojurescript 没有约定 - 您可以使用其他优化设置或 clojurescript 版本拥有完全不同的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:07:26.407

主要是给自己的一个便条，但如果有人需要知道，这就是我快速修复它的方法。

```
(def cljs-to-js-dir "_cljs_to_js_out")

(def js-options { :output-dir cljs-to-js-dir})

(defn js-compile [quoted-expr]
  (let [ result (cljs.closure/build quoted-expr js-options)
         file-name  ((re-find #"(/.+\.js)" result) 0)]
    (slurp (str  cljs-to-js-dir "/" file-name))))

(defmacro to-js [expr]
  (js-compile `((fn [] ~expr)))) 
```

使用此代码，您可以（从 repl 中）键入：

```
=> (to-js (swap! my-project.my-namespace.my-atom inc))
<= "(function (){\nreturn cljs.core.swap_BANG_.call(null,my_project.my_namespace.my_atom,cljs.core.inc);\n}).call(null);\n" 
```

我敢打赌你会好奇为什么我将 expr(ession) 包装在一个立即调用的无参数函数中。这是因为 cljs.closure/build 会在没有实际使用的情况下优化掉代码。例如：

```
=> (js-compile '(fn [a b] (+ a b))) 
<= "" 
```

然而

```
=> (js-compile '((fn [a b] (+ a b)) 2 3))
<= "(function (a,b){\nreturn (a + b);\n}).call(null,2,3);\n" 
```

抛开细节不谈，`(to-js)`似乎做我想做的事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T14:54:38.263

[您可以在 clojurescript.net 尝试cljs-in-cljs](https://github.com/kanaka/clojurescript)[的](http://clojurescript.net)在线REPL ：

首先启用调试模式：

```
cljs.user=> (set! webrepl/*debug* true) 
```

现在，当您评估表单时，您将获得读取、分析的结果（只是生成的表单）和发出的 JS：

```
cljs.user=> (def myatom (atom 1))
...
cljs.user=> (swap! myatom inc)
READ: (swap! myatom inc)
ANALYZED: (swap! myatom inc)
EMITTED: "cljs.core.swap_BANG_.call(null,cljs.user.myatom,cljs.core.inc)"
2 
```

**免责声明**：我是 cljs-in-cljs/clojurescript.net 的创建者

# android - 将横幅放在标签主机下方，仅用于一项活动

> ID：14446606
> 
> 赞同：1
> 
> 时间：2013-01-21T20:24:28.330
> 
> 标签：android, android-layout

是否可以将横幅放在标签主机下方，并且在该横幅中有两个按钮，我想从当前可见的活动中访问这两个按钮？

例如，有两个 xml 文件，一个是 tab-host，另一个是活动 xml 文件。在 tab-host xml 文件中，我编写了这样的代码

```
 <?xml version="1.0" encoding="utf-8"?> 
```

```
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <FrameLayout
        android:id="@android:id/tabcontent"
        android:layout_width="fill_parent"
        android:layout_height="0dip"
        android:layout_weight="1" />

    <TabWidget
        android:id="@android:id/tabs"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/seekBar1"
        android:background="#FFB5C5"
        android:gravity="center_horizontal"
        android:marqueeRepeatLimit="marquee_forever"
        android:singleLine="true"
        android:text="No track info available..."
        android:textColor="@android:color/black" />
</LinearLayout> 
```

现在，如果我想将横幅放在标签主机下方，我必须在此文件中为该横幅编写代码...

现在但主要问题是横幅中有两个按钮正在由具有

```
 setContentView(R.layout.activity); 
```

不是

```
 setContentView(R.layout.tabhost); 
```

所以我不会从

```
 setContentView(R.layout.activity); 
```

所以任何人都可以建议我如何做那件事

下面是图片

![在此处输入图像描述](../Images/f2785a347ac90d0840cdc64326c4258f.png)

您可以从标签主机看到横幅位于下方

现在我想从第一个活动中访问横幅.....o

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T05:34:52.437

你可以做这样的事情。

1.  放置代码以创建横幅并将其单击到 TabActivity。
2.  仅在您想要的活动中显示横幅，否则在其他活动中将其可见性设置为“GONE”。
3.  完毕。

通过上述说明，您可以只看到横幅或您想要的活动，还可以从该活动中点击按钮。

希望你明白我的意思。

随时发表任何评论。

# c# - 如何在 GroupItem 中显示自定义文本？

> ID：14446609
> 
> 赞同：4
> 
> 时间：2013-01-21T20:24:39.227
> 
> 标签：c#, wpf, xaml, grouping

带有 Expander 的典型 ListView GroupStyle 大致如下所示：

```
<ListView.GroupStyle>
    <GroupStyle>
        <GroupStyle.ContainerStyle>
            <Style TargetType="{x:Type GroupItem}">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type GroupItem}">
                            <Expander>
                                <Expander.Header>
                                    <TextBlock Text="{Binding Path=Name}" />
                                </Expander.Header>
                                <Expander.Content>
                                    <ItemsPresenter />
                                </Expander.Content>
                            </Expander>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </GroupStyle.ContainerStyle>
    </GroupStyle>
</ListView.GroupStyle> 
```

TextBlock 绑定到 Name，这似乎产生了 GroupItem 对象的值，该对象的 propertyName 被传递到 PropertyGroupDescription 中，该 PropertyGroupDescription 被添加到 ListCollectionView 的 GroupDescriptions 集合中（whew）：

```
class MyClass
{
    public int Id { get; set; }
    public int FullName { get; set; }
    public string GroupName { get; set; } // used to group MyClass objects
}

MyView.GroupDescriptions.Add(new PropertyGroupDescription("GroupName")); 
```

如何让我的 ListView 的组标题显示 GroupName 以外的属性？我要说的一点是 GroupName 对于将我的对象分成组很有用，但不一定是我希望用于所述组的标题的名称。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-22T01:18:51.713

[CollectionViewGroup.Name 属性](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewgroup.name.aspx)是对象类型。这意味着您的 GroupName 属性不必是字符串。尝试这样的事情

```
class MyClass
{
    ...
    public MyGroup GroupName { get; set; } // used to group MyClass objects
}

class MyGroup
{
    public string HeaderText { get; set; }
    // maybe you will need an additional property to make this object
    // unique for grouping (e.g. for different groups with same HeaderText)
} 
```

.

```
<Expander.Header>
    <TextBlock Text="{Binding Path=Name.HeaderText}" />
</Expander.Header> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:02:49.727

简单如：

```
<TextBlock Text="{Binding Path=Name, StringFormat='MyText: {0}'}" /> 
```

# c - MPI_Recv 和超时

> ID：14446615
> 
> 赞同：0
> 
> 时间：2013-01-21T20:24:50.360
> 
> 标签：c, mpi

我有个问题 。假设我有 np 进程。对于每个进程，我根据输入文件计算我需要向每个其他进程（从 0 到...）发送多少消息，并且我想向他们发送这个数字。问题是我只能从通过直接连接节点创建的拓扑发送。所以基本上我希望每个进程向所有其他进程发送一个 int，我有以下算法（将使用伪代码）：

```
for(i=1,np){
    if(i!=rankID){
        MPI_Send(&nr,1,MPI_INT,topology[i][nexthop],DATA,MPI_COMM_WORLD);
        MPI_SEND(&i,1,MPI_INT,topology[i][nexthop],DATA,MPI_COMM,WORLD); //i send the destination along with the int 
    }
}
while(1){
    MPI_Recv(&recvInt,1,MPI_INT,MPI_ANY_SOURCE,DATA,MPI_COMM,WORLD);
    MPI_Recv(&destination,MPI_INT,MPI_ANY_SOURCE,DATA,MPI_COMM,WORLD);
    if(destination == rankID){
        ireceive+=recvInt;
        receivedFrom++;
        //normally i would break if i received all np-1 messages but what if someone sends a message through me for another process ?
    }
    else{
        MPI_Send(&recvInt,1,MPI_INT,topology[destination][nexthop],DATA,MPI_COMM_WORLD);
        MPI_Send(&destination,1,MPI_INT,topology[destination][nexthop],DATA,MPI_COMM_WORLD);
    }

} 
```

现在再解释一下。在这个小算法结束时，我希望我的每个进程都知道他们将在下一步中收到多少消息。

要将这些消息从每个节点发送到每个节点，我使用我创建的先前路由表。基本上每个节点都有一个包含所有节点的矩阵，并且 topology[node][1] = next hop（这就是我在上面输入 nexthop 的原因代码） 。

每个节点都知道有 np 个进程，因此每个节点都必须接收 np-1 消息（他是目的地）。

我遇到的问题是，在收到 np-1 消息后，我无法中断，因为我可能是其他进程的 next_hop 并且不会发送消息。所以我想做这样的事情，使用 MPI_TEST 或其他指令来查看我的 Recv 是否真的在接收某些东西，或者它是否只是坐在那里，因为如果程序阻塞 1-2 秒，很明显它不会接收不再（因为我没有大的拓扑结构，最多 20-30 个进程）。

问题是我从来没有使用过 MPI_Test 或其他语法，我不知道该怎么做。有人可以帮我为 Recv 创建超时或者是否有其他解决方案？谢谢，很抱歉文字太长了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:41:14.120

可能不是最有效的代码，但它应该可以工作（我没有机会测试它）

```
MPI_Request request;
MPI_Status status;
for(i=1,np){
    if(i!=rankID){
        MPI_ISend(&nr,1,MPI_INT,topology[i][nexthop],DATA,MPI_COMM_WORLD);
        MPI_ISend(&i,1,MPI_INT,topology[i][nexthop],DATA,MPI_COMM,WORLD); //i send the destination along with the int 
    }
}
while(1){
    bool over = false;
    if(over == true)
        break;
    if(recievedFrom < np){
        MPI_Recv(&recvInt,1,MPI_INT,MPI_ANY_SOURCE,DATA,MPI_COMM,WORLD);
        MPI_Recv(&destination,MPI_INT,MPI_ANY_SOURCE,DATA,MPI_COMM,WORLD);
        if(destination == rankID){
            ireceive+=recvInt;
            receivedFrom++;
            //normally i would break if i received all np-1 messages but what if someone sends a message through me for another process ?
        }
        else{
            MPI_Send(&recvInt,1,MPI_INT,topology[destination][nexthop],DATA,MPI_COMM_WORLD);
            MPI_Send(&destination,1,MPI_INT,topology[destination][nexthop],DATA,MPI_COMM_WORLD);
        }
    }
    else {
        MPI_Irecv(&recvInt,1,MPI_INT,MPI_ANY_SOURCE,DATA,MPI_COMM,WORLD, request); // non blocking recieve call after you finished receiving everything addressed to you
        time_t now = time(NULL);
        while(time(NULL) < now + time_you_set_until_timeout){
            over = true;
            int flag = 0;
            MPI_Test(req, flag, status);
            if(flag){
                over = false;
                break; //exit timeout loop if something was received
            }
        }
    }
    if(!over){
            MPI_Recv(&destination,MPI_INT,MPI_ANY_SOURCE,DATA,MPI_COMM,WORLD);
            //route the message and continue
    }
} 
```

无论如何，由于您不知道在消息通过您的拓扑之前可以经过多少时间，您应该小心选择超时时间。您可以尝试实现某种其他类型的信令机制，例如广播一条消息，告诉节点接收到所有发给它的消息。当然，它会增加发送的消息数量，但它会确保每个人都得到一切。您也可以尝试打包或序列化要发送的数据，这样您就只有一个 Send/Recv 调用，这将使您的代码更易于使用（在我看来）。

# php - 如何通过 Rest API 将多选值发布到 SugarCRM？

> ID：14446616
> 
> 赞同：3
> 
> 时间：2013-01-21T20:24:55.107
> 
> 标签：php, api, rest, sugarcrm, multi-select

任何人都知道如何通过 Sugar 的 REST API v4 从表单中的多选输入中插入多个值。我还没有找到任何关于此的文档。以下正确插入 1 个值，但我坚持保存多个值：

```
function getSugar($method, $parameters){
    $url = 'https://****.sugarondemand.com/service/v4/rest.php';
    $curl = curl_init($url);
    curl_setopt($curl, CURLOPT_POST, true);
    curl_setopt($curl, CURLOPT_HEADER, false);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
    $json = json_encode($parameters);
    $postArgs = array(
         'method' => $method,
         'input_type' => 'JSON',
         'response_type' => 'JSON',
         'rest_data' => $json
          );
    curl_setopt($curl, CURLOPT_POSTFIELDS, $postArgs);
    $response = curl_exec($curl);
    if (!$response) {
         die("Connection Failure.\n");
     }
     $result = json_decode($response);
     if ( !is_object($result) ) {
         die("Error handling result.\n");
     }
     if($method == "set_entry" || $method == "login"){
         if ( !isset($result->id) ) {
              die("Error: {$result->name} - {$result->description}\n.");
         }
         $id = $result->id;
         return $id;
      }else{
         if ( !is_object($result) ) {
             var_dump($response);
             die("Error handling result.\n");
          }
          return true;
     }
}

$x = "ABC";
$parameters = array(
    'session' => $sessionId,
    'module' => 'Leads',
    'name_value_list' => array(
         array('name' => 'programs_c', 'value' => $x),
         ),
 );
 $method = "set_entry";
 $leadID = getSugar($method, $parameters); 
```

字段“programs_c”是 Sugar 中的自定义多选字段，具有多个下拉值。我试过运行一个 for-each 循环，但只插入最后一个值。我还尝试了几乎所有可能的在数组中插入数组的变体，但没有任何成功。任何帮助深表感谢！我花了几个小时试图弄清楚这一点。在此先感谢您提供有关如何处理此问题的任何见解/方向。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T20:57:35.953

以这种格式放置字段内容是否有效？

```
^value1^,^value2^,^value3^ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-27T08:47:15.217

这是我编写的一些方法来帮助构建多选查询字符串。

```
private static function convertMultiSelectValueToArray($multiString) {
    return explode(",", $multiString);
}

/**
 * @param $notifyUser
 * @param $manageContacts
 * @param string $currMultiSelectString
 * @return string
 *
 * Examples:
 * print SugarCRM::buildRelationshipMultiselect(true,true) . "\n";  -->  ^Notify of New Updates^,^AllowManageContacts^
 * print SugarCRM::buildRelationshipMultiselect(false,true) . "\n"; --> ^AllowManageContacts^
 * print SugarCRM::buildRelationshipMultiselect(false,false, PERMISSION_ALLOW_USER_TO_MANAGE_CONTACTS . "," . PERMISSION_NOTIFY_OF_NEW_UPDATES . ",^SomeOtherThingThatShouldStillBeHere^") . "\n"; --. ^AllowManageContacts^
 */
public static function buildRelationshipMultiselect($notifyUser, $manageContacts, $currMultiSelectString='') {
    $arr = array();
    if( !empty($currMultiSelectString) ) {
        $arr = SugarCRM::convertMultiSelectValueToArray($currMultiSelectString);
    }

    // Remove them so we dont get duplicates & so they are removed if booleans are false...
    if( count($arr) > 0 ) {
        $arr = SugarCRM::removeElementFromArray($arr,PERMISSION_NOTIFY_OF_NEW_UPDATES);
        $arr = SugarCRM::removeElementFromArray($arr,PERMISSION_ALLOW_USER_TO_MANAGE_CONTACTS);
    }

    if( $notifyUser ) {
        $arr[] = PERMISSION_NOTIFY_OF_NEW_UPDATES;
    }

    if( $manageContacts ) {
        $arr[] = PERMISSION_ALLOW_USER_TO_MANAGE_CONTACTS;
    }

    return implode(",", $arr);
}

public function createNewContactRelatedToAccount($firstName,$lastName,$emailAddress,$phone,
                                                 $description,$accountId,$isManageContacts=false, $isNotifyOfUpdates=false)
{
    // TODO, check if user exists first!

    $relationships = SugarCRM::buildRelationshipMultiselect($isNotifyOfUpdates, $isManageContacts /** PUT EXISTING VALUE HERE IF UPDATING! **/);
    $sugar = new Sugar_REST( SUGAR_REST_URL, SUGAR_USER_NAME, SUGAR_PASSWORD);
    $values = array(
        'first_name' => htmlentities($firstName),
        'last_name' => htmlentities($lastName),
        'email1' => htmlentities($emailAddress),
        'description' => htmlentities($description),
        'phone_work' => htmlentities($phone),
        SUGAR_FIELDNAME_FOR_PERMISSIONS => $relationships
    );

    $contact = $sugar->set("Contacts", $values );
    $contactId = $contact['id'];
    $relStatus = $sugar->set_relationship("Accounts",$accountId, "contacts", $contactId );

    return $relStatus['created'] == 1;
}

private static function removeElementFromArray(&$search_arr, $itemToRemove) {
    // Should have just used array_search...
    foreach($search_arr as $key => $value) {
        if($value == $itemToRemove) {
            unset($search_arr[$key]);
        }
    }
    return $search_arr;
} 
```

# android - 实现自定义 Android 的 libaudio.so 或“音频如何在 Android 上工作？”

> ID：14446617
> 
> 赞同：3
> 
> 时间：2013-01-21T20:24:58.253
> 
> 标签：android, audio, shared-libraries, audioflinger

我目前正在发现Android> 4.0并且有一些我自己无法解决的问题，也许你可以帮助我。

我发现，一些市场应用程序，如“AlsaMixer”或“MixGet with ALSA”，将一个名为“libaudio.so”的库放入“/system/lib/”（带有用户帮助）。

我想知道发生了什么，经过一段时间的搜索，似乎每个 Android 公司都可以创建一个 libaudio.so，它实现了某个 C++ 接口并将其放入该路径。

*Android 然后将这个库用于音频处理（存在 ALSA、TinyALSA 等的实现）？*

但是：在我的手机上没有这样的 libaudio.so - 这是如何工作的？否则采取什么措施？我发现我在那个目录中有一个“libasound.so”，这是默认的吗？

如果我尝试实现自己的 libaudio.so（目前我的知识很少），我可以引用其中的“默认”库吗？

我认为“*嘿，世界上每部手机都有一个可用的音频实现，我只想扩展它而不是重新设计（重新配置）轮子？* ”

我是说：

> AudioFlinger -> 我的自定义 libaudio.so -> default-library (libasound.so?) -> 扬声器

如果我的手机上已经有 libaudio.so 怎么办？

我会非常感谢每一个有用的答案。也许有人给我一个地址，初学者可以理解吗？

在此先感谢和亲切的问候！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T08:55:00.920

我现在找到了一个很好且易于理解的图形，其中包含很好的描述，例如音频是如何通过 Android 路由的：

[Android服务黑魔法-马拉卡纳](http://marakana.com/s/post/1057/MarakanaAndroidServicesBlackMagic.pdf)（第10+11页）

但也非常感谢 t0mm13b，他阻止了我在 libaudio.so 上走错路。

# java - 不幸的是，AndroidTest 已经停止

> ID：14446619
> 
> 赞同：1
> 
> 时间：2013-01-21T20:25:15.180
> 
> 标签：java, android, android-layout, android-listview

我正在研究这个网站的教程 [http://www.youtube.com/watch?v=jSyy5TrUD5Q](http://www.youtube.com/watch?v=jSyy5TrUD5Q)

我似乎为教练工作，但一旦我在模拟器上运行它，它就会说

不幸的是，AndroidTest 已经停止。

**主要活动 XML**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="@string/hello_world" />

<Button
    android:id="@+id/buttonTEST1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:text="Button" />

<EditText
    android:id="@+id/editTextTEST1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_above="@+id/textView1"
    android:layout_alignParentLeft="true"
    android:layout_marginBottom="72dp"
    android:ems="10" />

    </RelativeLayout> 
```

**主要活动.java**

```
 package com.example.androidtest;

    import android.os.Bundle;
    import android.app.Activity;
    import android.content.DialogInterface;
    import android.content.DialogInterface.OnClickListener;
    import android.content.Intent;
    import android.view.Menu;
    import android.view.View;
    import android.widget.Button;
    import android.widget.EditText;

    public class MainActivity extends Activity implements OnClickListener {

Button button1;
EditText editText1;

@Override
protected void onCreate(Bundle savedInstanceState) {
    setContentView(R.layout.activity_main);
    super.onCreate(savedInstanceState);
    button1= (Button) findViewById(R.id.buttonTEST1);
    editText1= (EditText) findViewById(R.id.editTextTEST1);
    button1.setOnClickListener((android.view.View.OnClickListener)this);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

public void onClick(View v) {
    if(v.getId() == R.id.buttonTEST1)
    {
        // Switching from screen to screen
        startActivity(new Intent(this, AndroidActivity2.class));

        editText1.setText("Button Tester Works");
    }

}

@Override
public void onClick(DialogInterface arg0, int arg1) {
    // TODO Auto-generated method stub

}

    } 
```

**日志猫**

```
 01-21 20:06:51.753: W/Trace(764): Unexpected value from nativeGetEnabledTags: 0
01-21 20:06:51.763: W/Trace(764): Unexpected value from nativeGetEnabledTags: 0
01-21 20:06:51.763: W/Trace(764): Unexpected value from nativeGetEnabledTags: 0
01-21 20:06:52.015: W/Trace(764): Unexpected value from nativeGetEnabledTags: 0
01-21 20:06:52.015: W/Trace(764): Unexpected value from nativeGetEnabledTags: 0
01-21 20:06:52.482: D/AndroidRuntime(764): Shutting down VM
01-21 20:06:52.482: W/dalvikvm(764): threadid=1: thread exiting with uncaught exception (group=0x40a70930)
01-21 20:06:52.503: E/AndroidRuntime(764): FATAL EXCEPTION: main
01-21 20:06:52.503: E/AndroidRuntime(764): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.androidtest/com.example.androidtest.MainActivity}: java.lang.ClassCastException: com.example.androidtest.MainActivity cannot be cast to android.view.View$OnClickListener
01-21 20:06:52.503: E/AndroidRuntime(764):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
01-21 20:06:52.503: E/AndroidRuntime(764):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
01-21 20:06:52.503: E/AndroidRuntime(764):  at android.app.ActivityThread.access$600(ActivityThread.java:141)
01-21 20:06:52.503: E/AndroidRuntime(764):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
01-21 20:06:52.503: E/AndroidRuntime(764):  at android.os.Handler.dispatchMessage(Handler.java:99)
01-21 20:06:52.503: E/AndroidRuntime(764):  at android.os.Looper.loop(Looper.java:137)
01-21 20:06:52.503: E/AndroidRuntime(764):  at android.app.ActivityThread.main(ActivityThread.java:5039)
01-21 20:06:52.503: E/AndroidRuntime(764):  at java.lang.reflect.Method.invokeNative(Native Method)
01-21 20:06:52.503: E/AndroidRuntime(764):  at java.lang.reflect.Method.invoke(Method.java:511)
01-21 20:06:52.503: E/AndroidRuntime(764):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
01-21 20:06:52.503: E/AndroidRuntime(764):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
01-21 20:06:52.503: E/AndroidRuntime(764):  at dalvik.system.NativeStart.main(Native Method)
01-21 20:06:52.503: E/AndroidRuntime(764): Caused by: java.lang.ClassCastException: com.example.androidtest.MainActivity cannot be cast to android.view.View$OnClickListener
01-21 20:06:52.503: E/AndroidRuntime(764):  at com.example.androidtest.MainActivity.onCreate(MainActivity.java:24)
01-21 20:06:52.503: E/AndroidRuntime(764):  at android.app.Activity.performCreate(Activity.java:5104)
01-21 20:06:52.503: E/AndroidRuntime(764):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
01-21 20:06:52.503: E/AndroidRuntime(764):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
01-21 20:06:52.503: E/AndroidRuntime(764):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:29:58.823

更改您的 Activity 代码，因为您需要 `View.OnClickListener`在 Activity 中实现以添加`setOnClickListener`Button

```
public class MainActivity extends Activity implements View.OnClickListener  {

Button button1;
EditText editText1;

@Override
protected void onCreate(Bundle savedInstanceState) {
    setContentView(R.layout.activity_main);
    super.onCreate(savedInstanceState);
    button1= (Button) findViewById(R.id.buttonTEST1);
    editText1= (EditText) findViewById(R.id.editTextTEST1);
    button1.setOnClickListener(this);
}
//your code here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:30:28.367

您没有实施`OnClickListener`（至少它已被注释掉），因此您的`onClick()`方法无济于事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:41:32.927

您正在尝试将您的活动解析为`OnClickListener`. 但是您还没有实现它，因为代码已被注释掉（带有`/* ... */`）。改变

```
/*implements OnClickListener*/ 
```

至

```
implements OnClickListener 
```

# r - 如何从未知用户通过电子邮件安全地从 R 脚本中获取数据？

> ID：14446621
> 
> 赞同：1
> 
> 时间：2013-01-21T20:25:18.130
> 
> 标签：r, matlab, email, dropbox, google-drive-api

这里有各种论坛，提供了如何将 R 脚本中的数据通过电子邮件发送给某人的示例。但是，在我的项目中，我让用户运行一个 R 脚本，然后让该 R 脚本以某种方式将用户生成的结果传达给我。脚本的第一部分已经用 R 编写，因此最好使用 R 中的解决方案。（除了matlab和RI对其他语言的了解非常有限，可惜我不懂PHP）

问题是用户的身份必须受到保护，这样没有人可以从他们发送给我或存放在某处的文件中识别出运行脚本的人，所以我不能只在发件人行中使用他们的电子邮件地址。我在这里有什么选择？我可以设置一个电子邮件帐户让他们通过电子邮件发送给我吗？我可以让结果自动上传到在线存储库（可能是保管箱或谷歌驱动器）吗？我怎样才能安全地做这些事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:29:10.360

您可以使用[SendMailR 包](http://cran.r-project.org/web/packages/sendmailR/sendmailR.pdf)发送邮件。不要求发件人地址是真实的电子邮件地址。使用您自己的 SMTP 服务器作为服务器设置。

# jquery - 悬停火狐上闪烁的div

> ID：14446627
> 
> 赞同：1
> 
> 时间：2013-01-21T20:25:32.263
> 
> 标签：jquery, css

悬停时如何停止此div的闪烁，仅在Firefox中存在问题，chrome很好

[http://jsfiddle.net/GpuUb/](http://jsfiddle.net/GpuUb/)

jQuery解决方案很好

CSS

```
div {
    height: 30px;
    width: 30px;
    background-color: #000;
    margin: 50px;
    border-radius: 15px;
    transition: all 1s;
    -webkit-transition: all 1s;
    -moz-transition: all 1s;
}

div:hover {
    height: 300px;
    width: 300px;
    background-color: #000;
    margin: 50px;
    border-radius: 150px;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:39:56.053

它没有太多闪烁，因为它正在失去悬停事件。Firefox 不会在鼠标悬停的空白部分检测到您`border-radius`的鼠标。如果您移动鼠标使其停留在黑色部分，则它会平滑过渡。

我不确定这是 Firefox 和其他浏览器中的错误，还是规范未定义。根据我在 CSS3 规范中阅读的内容，没有讨论如何`border-radius`影响盒子模型。也许由于这个遗漏，它不应该影响盒子模型，然后这将是 Firefox 中的一个缺陷。

您可以使用包装的容器 div 来修复它，但这并不是非常优雅。这是您的带有包装器 div 的修改版本。

**HTML**

```
<div id="container"><div id="circle"></div></div> 
```

**CSS**

```
div#container {
    display: inline-block;
    background-color: green;
    margin: 50px;
}
div#circle {
    height: 30px;
    width: 30px;
    background-color: #000;
    border-radius: 15px;
    transition: all 1s;
    -webkit-transition: all 1s;
    -moz-transition: all 1s;
}

div#container:hover div {
    width: 300px;
    height: 300px;
    background-color: #000;
    border-radius: 150px;
} 
```

这是要玩的[jsFiddle 。](http://jsfiddle.net/GpuUb/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:40:05.643

我会将圆圈定位在中间并将其均匀地扩展到所有侧面。那么闪烁效果就不会出现了：

CSS：

```
div {
    height: 30px;
    width: 30px;
    background-color: #000;
    margin: 75px;
    border-radius: 15px;
    transition: all 1s;
    -webkit-transition: all 1s;
    -moz-transition: all 1s;
}

div:hover {
    height: 300px;
    width: 300px;
    background-color: #000;
    margin: 00px;
    border-radius: 150px;
} 
```

HTML：

```
<div></div> 
```

提琴手：http: [//jsfiddle.net/eNabK/](http://jsfiddle.net/eNabK/)

我不知道这是否适用于你。

# python - PyQt，Qtable在启用排序时清除列

> ID：14446633
> 
> 赞同：5
> 
> 时间：2013-01-21T20:26:18.510
> 
> 标签：python, qt, pyqt, pyqt4

我在下一个函数中有一个错误。此功能刷新表，调整列大小和排序表。但在某些情况下，第 3 列和第 4 列中的某些行文本为空。我发现它发生在“问题代码”部分。我在本节中做错了什么？我只想更改特定列的大小。请帮助找出问题或告诉我我的错误。

```
def print_day_worklog(self):
    logging.info('RefReshing day worklog table')
    selected_day = self.ui.dateDayWorklogEdit.date().toPyDate()
    day_work = db.get_day_worklog(self.creds[3], selected_day)
    self.ui.tableDayWorklog.setRowCount(len(day_work))
    for row, entry in enumerate(day_work):
        e0 = QtGui.QTableWidgetItem(entry[0])
        e1 = QtGui.QTableWidgetItem(entry[1])
        e2 = QtGui.QTableWidgetItem(entry[2].strftime('%H:%M'))
        e3 = QtGui.QTableWidgetItem(entry[3].strftime('%H:%M'))
        e4 = QtGui.QTableWidgetItem(utils.get_time_spent_string(entry[2],
            entry[3]))
        # debug
        print e0.text(), e1.text(), e2.text(), e3.text(), e4.text()
        self.ui.tableDayWorklog.setItem(row, 0, e0)
        self.ui.tableDayWorklog.setItem(row, 1, e1)
        self.ui.tableDayWorklog.setItem(row, 2, e2)
        self.ui.tableDayWorklog.setItem(row, 3, e3)
        self.ui.tableDayWorklog.setItem(row, 4, e4)

    # problem code starts
    self.ui.tableDayWorklog.horizontalHeader().setResizeMode(1,
        QtGui.QHeaderView.Stretch)
    for column in (0,2,3,4):
        self.ui.tableDayWorklog.resizeColumnToContents(column)
        self.ui.tableDayWorklog.horizontalHeader().setResizeMode(column,
            QtGui.QHeaderView.Fixed)
        self.ui.tableDayWorklog.horizontalHeader().setResizeMode(column,
            QtGui.QHeaderView.Fixed)
    self.ui.tableDayWorklog.sortByColumn(2,0)
    # problem code ends 
```

Ps 它看起来不太清楚，但这是因为我试图抓住这个错误

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-23T05:43:21.137

问题在于表格排序。我在[这个](https://stackoverflow.com/questions/9788592/python-pyqt-qtablewidget-json-and-emitsignal-causing-blank-cells "Python PyQt - QTableWidget、JSON 和 emitSignal 导致空白单元格")问题中找到了这个想法。我刚刚添加

```
self.ui.tableDayWorklog.setSortingEnabled(False) 
```

在填满表格之前

```
self.ui.tableDayWorklog.setSortingEnabled(True) 
```

在那之后。它有帮助

# python - 简单的动态网页抓取 - 没有 BeautifulSoup

> ID：14446634
> 
> 赞同：2
> 
> 时间：2013-01-21T20:26:25.993
> 
> 标签：python, dynamic, web, screen-scraping

我正忙于抓取一个动态网站，以获得一个 URL，每次更新时我都可以使用该 URL 下载游戏的服务器软件。

该网站是“http://craftstud.io/builds”，上面写着“Server XX.XXX”是我想要抓取的。

我真的不希望它因 Javascript 和外部模块而变得复杂，所以如果有一个简单的解决方案，我会全力以赴。

我也无法终生安装第三方模块，例如 BeautifulSoup (Stupid Windows)。

谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:32:39.227

如果您想要简单的东西，请考虑使用简单的[正则表达式](http://docs.python.org/library/re.html)：

```
>>> import re
>>> import urllib2
>>> html = urllib2.urlopen("http://craftstud.io/builds").read()
>>> re.search(r"Server \d+\.\d+\.\d+\.\d+", html).group()
'Server 0.1.24.1' 
```

也就是说，如果您可以通过 pip 安装[BeautifulSoup4](http://www.crummy.com/software/BeautifulSoup/#Download)，那么您将来会发现它有很多用途。（确保你使用`pip install BeautifulSoup4`而不是`pip install BeautifulSoup`我几天前刚刚在 Windows 机器上安装了一个副本。）

# java - Java Scanner 类因多次使用而失败

> ID：14446636
> 
> 赞同：0
> 
> 时间：2013-01-21T20:26:29.533
> 
> 标签：java, java.util.scanner

我不明白为什么这段代码能按我的预期工作：

```
package myPackage;

import java.util.InputMismatchException;
import java.util.Scanner;

public class ScanTest {

    public static void main(String[] args) 
    {
        Scanner scan1, scan2;
        double weight = 0.0;

        scan1 = new Scanner(System.in);
        System.out.print("Enter a rational: ");
        try {
            weight = scan1.nextDouble();
            System.out.println("You entered " + weight);
        }
        catch(InputMismatchException ime) {
            System.out.println("Invalid data.");
        }
        scan1.close();

        /*scan2 = new Scanner(System.in);
        System.out.print("Enter a rational: ");
        try {
            weight = scan2.nextDouble();
            System.out.println("You entered " + weight);
        }
        catch(InputMismatchException ime) {
            System.out.println("Invalid data.");
        }
        scan2.close();*/
    }
} 
```

这段代码失败了：

```
package myPackage;

import java.util.InputMismatchException;
import java.util.Scanner;

public class ScanTest {

    public static void main(String[] args) 
    {
        Scanner scan1, scan2;
        double weight = 0.0;

        scan1 = new Scanner(System.in);
        System.out.print("Enter a rational: ");
        try {
            weight = scan1.nextDouble();
            System.out.println("You entered " + weight);
        }
        catch(InputMismatchException ime) {
            System.out.println("Invalid data.");
        }
        scan1.close();

        scan2 = new Scanner(System.in);
        System.out.print("Enter a rational: ");
        try {
            weight = scan2.nextDouble();
            System.out.println("You entered " + weight);
        }
        catch(InputMismatchException ime) {
            System.out.println("Invalid data.");
        }
        scan2.close();
    }
} 
```

（请注意，这两个版本几乎相同。第二个版本中只有一个未注释的块。）

我从第二个版本得到的输出是：

```
Enter a rational: .97
You entered 0.97
Enter a rational: Exception in thread "main" java.util.NoSuchElementException
    at java.util.Scanner.throwFor(Unknown Source)
    at java.util.Scanner.next(Unknown Source)
    at java.util.Scanner.nextDouble(Unknown Source)
    at myPackage.ScanTest.main(ScanTest.java:28) 
```

我不明白为什么 Scanner 对象在第一个块中等待输入，但在第二个块中抛出异常。我期望的行为是：

```
Enter a rational: .97
You entered 0.97
Enter a rational: .43
You entered 0.43 
```

有问题的第 28 行是：

重量 = scan2.nextDouble();

我将不胜感激任何人对这种行为的洞察力！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:29:13.093

我相信对的调用`scan1.close()`也会关闭`System.in`，因此无法从流中读取更多数据。[在这里](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)查看`close()`方法描述。

所以......当您开始阅读时`scan2`，`System.in`将不再返回任何数据。

# intellij-idea - IntelliJ IDEA 的 Gradle 语言级别是如何确定的？

> ID：14446638
> 
> 赞同：17
> 
> 时间：2013-01-21T20:26:33.840
> 
> 标签：intellij-idea, gradle

IntelliJ 附带的 JetGradle 插件显示我的项目存在冲突。它说我的 IDE 语言级别是 1.7，我的 Gradle 语言级别是 1.6。

以下代码为所有内容打印 1.7：

```
compileJava {
    println project.sourceCompatibility
    println project.targetCompatibility
    println sourceCompatibility
    println targetCompatibility
} 
```

从命令行运行 Gradle 可以正常工作。在 IDEA 中运行它也可以。这两个都使用 1.7 JDK。我的 IDEA 项目和模块也配置为使用 1.7。

当我通过 Gradle 构建脚本导入项目时，版本默认为 1.6。我已将其更改为 1.7。

这个“Gradle 语言级别”是什么，我该如何修改它？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-21T21:23:00.103

Gradle 不会通过工具 api 公开语言级别，所以我认为这只是 intellij 中定义的“默认项目”语言。

[您可以在这张jetbrains youtrack 票](http://youtrack.jetbrains.com/issue/IDEA-96615)中查看详细信息，并回溯到相应的 gradle 问题

至于“如何解决它”，我认为唯一真正的选择是不使用 use jetgradle & use the [gradle idea plugin](http://www.gradle.org/docs/current/userguide/idea_plugin.html)。Intellij 12.1 将有一个[大大改进的 jetgradle 插件](http://youtrack.jetbrains.com/issue/IDEA-53476)，但如果信息不在工具 api 上，那么很难看出如何解决这个问题。

编辑：Gradle 刚刚发布了 2.11 的 RC，其中（终于！）包含此功能，有关详细信息，请参阅[发行说明](https://docs.gradle.org/release-candidate/release-notes#enhanced-support-for-developing-java-projects-in-intellij-idea-and-eclipse)，其中解释了对工具 api（即 intellij jetgradle）和 gradle idea 插件的支持。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-01-06T21:56:43.147

我在这里玩游戏有点晚了，但我用它来解决问题：

```
apply plugin: 'idea'

allprojects {
  sourceCompatibility = 1.8
  targetCompatibility = 1.8
}

idea {
  project {
    jdkName = sourceCompatibility
    languageLevel = sourceCompatibility
    ipr {
      withXml {

        def xml = """<component name="GradleSettings">
    <option name="linkedExternalProjectsSettings">
      <GradleProjectSettings>
        <option name="distributionType" value="DEFAULT_WRAPPED" />
        <option name="externalProjectPath" value="\$PROJECT_DIR\$" />
        <option name="gradleJvm" value="$sourceCompatibility" />
        <option name="modules">
          <set>
            <option value="\$PROJECT_DIR\$" />
          </set>
        </option>
        <option name="myModules">
          <set>
            <option value="\$PROJECT_DIR\$" />
          </set>
        </option>
      </GradleProjectSettings>
    </option>
  </component>"""

        def node = it.asNode()
        node.append(new XmlParser().parseText(xml))
      }
    }
  }

  module {
    iml {
      withXml {
        def root = it.asNode()
        root.@'external.linked.project.id' = project.name
        root.@'external.linked.project.path' = '$MODULE_DIR$'
        root.@'external.root.project.path' = '$MODULE_DIR$'
        root.@'external.system.id' = "GRADLE"
        root.@'external.system.module.group' = project.group
        root.@'external.system.module.version' = project.version
      }
    }
  }
} 
```

然后用于`./gradlew idea`生成将项目语言设置为 1.8 的项目元数据。编辑：Gradle idea 插件仅处理基于文件的元数据，而不是基于目录的 (.idea/) 元数据。如果将其应用于使用基于目录的元数据的现有项目，则需要删除项目根目录中的 .idea/ 文件夹

注意：将 jdkName 设置为“1.8”假设在 Intellij 中注册了一个名为“1.8”的 Java SDK。

更新1：生成的ipr文件包含这个块，表明使用Java 1.8（注意'languageLevel'和'project-jdk-name'属性）

```
<component name="ProjectRootManager" version="2" languageLevel="JDK_1_8" assert-keyword="true" jdk-15="true" project-jdk-type="JavaSDK" assert-jdk-15="true" project-jdk-name="1.8">
  <output url="file://$PROJECT_DIR$/out"/>
</component> 
```

这应该与您在“项目结构”对话框中看到的内容直接对应：[![Intellij 和 Gradle JDK 语言级别](../Images/20cd2a2f2064c84c82434fb5f8414520.png)](https://i.stack.imgur.com/L9WIY.png)

更新 2：在项目加载时，Intellij 会提示您“导入 Gradle 项目”。由于某种原因，这会忽略 ipr 文件中配置的语言级别，默认为 1.6。解决这个问题的方法是预先配置 ipr 和适用的 iml 文件，以便它知道 Gradle 集成。这样，系统不会提示您导入 Gradle 项目，并且语言级别保持在 1.8。上面的代码块已更新以包含必要的配置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-06T16:30:27.260

它似乎不受支持，但它是一个简单的一次性修复。

*   导航到：文件->项目结构选择“模块”下
*   项目设置。（应该已经）将“语言级别”更改为 7.0

或者

*   深入到文件中的实际编译错误。通常这类似于在一个 catch 块中处理多个错误。
*   选择弹出的红色助手图标，“设置语言级别为1.7”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-03-24T19:43:56.760

我有一个 java/kotlin 项目。在搞砸之后，我发现如果模块本身或主源集被赋予了正确的语言级别，我在 gradle.build 中应用插件的顺序实际上会受到影响：

```
plugins {
    id 'org.jetbrains.kotlin.jvm' apply false
    id 'idea'
}
// have to apply in this order to fix idea.module.languageLevel
apply plugin: 'java'
apply plugin: 'org.jetbrains.kotlin.jvm'

sourceCompatibility = JavaVersion.VERSION_1_8
targetCompatibility = JavaVersion.VERSION_1_8

idea {
    module {
        jdkName = '1.8'
        languageLevel = new IdeaLanguageLevel("1.8")
    }
} 
```

# c#-4.0 - 通过 c# 查询 Amazon SimpleDB 不返回任何记录

> ID：14446639
> 
> 赞同：1
> 
> 时间：2013-01-21T20:26:45.167
> 
> 标签：c#-4.0, amazon-simpledb

我已经构建了一个附加程序，它将 Log4Net 日志写入一个名为 LogTable 的 SimpleDB 表/域。我现在正在尝试编写一个 Windows 服务，该服务将从该表中删除旧记录。肯定会创建 AmazonSimpleDB 客户端，手动运行时的查询确实会返回记录。但是，当通过单元测试执行代码时，不会返回任何结果。表名和列名区分大小写是正确的。

```
using (AmazonSimpleDB simpleDbClient = AWSClientFactory.CreateAmazonSimpleDBClient(accessKey, secretKey))
                {
                    String selectExpression = String.Format("select * from LogTable where Timestamp < '{0:o}'", purgeDate);
                    SelectRequest selectRequestAction = new SelectRequest().WithSelectExpression(selectExpression);
                    SelectResponse selectResponse = simpleDbClient.Select(selectRequestAction);

                    if (selectResponse.IsSetSelectResult())
                    {
                        BatchDeleteAttributesRequest deleteRequest = new BatchDeleteAttributesRequest().WithDomainName("LogTable");
                        deleteRequest.Item = new List<DeleteableItem>();

                        SelectResult selectResult = selectResponse.SelectResult;
                        foreach (Item item in selectResult.Item)
                        {
                            deleteRequest.Item.Add(new DeleteableItem { ItemName = item.Name });
                        }

                        if (deleteRequest.Item.Count > 0)
                        {
                            simpleDbClient.BatchDeleteAttributes(deleteRequest);
                        }

                        logger.InfoFormat("Success - {0} log records deleted from LogTable", deleteRequest.Item.Count);
                    }
} 
```

非常感谢对此提供一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T06:56:09.297

只有满足表达式的记录才会被返回，所以请确保您的查询是正确的。一个简单的选择查询返回什么？试试这个并检查 -

```
select * from LogTable 
```

如果您没有得到任何点击，请指定区域终点。

如果它返回，请确保您指定的条件得到匹配。

**编辑：**

请尝试运行此代码并使用您的域所属的此[链接](http://docs.aws.amazon.com/general/latest/gr/rande.html#sdb_region)指定区域端点。

```
AmazonSimpleDBConfig theConfig = new AmazonSimpleDBConfig();
theConfig.ServiceURL = myEndpoint;  //where myEndPoint is the region endpoint you are interested in
AmazonSimpleDBClient simpleDbClient= new AmazonSimpleDBClient(myKey, mySecretKey, theConfig);
String selectExpression = "select * from LogTable";
SelectRequest selectRequestAction = new SelectRequest();
selectRequestAction.SelectExpression = selectExpression;
selectRequestAction.NextToken = null;
SelectResponse selectResponse = simpleDbClient.Select(selectRequestAction);
SelectResult selectResult = selectResponse.SelectResult;
List<Item> itemList = selectResult.Item; 
```

# iphone - 在 iPhone 5 上选择后置麦克风

> ID：14446640
> 
> 赞同：11
> 
> 时间：2013-01-21T20:26:46.183
> 
> 标签：iphone, avfoundation, core-audio, audiounit, remoteio

RemoteIO 单元有没有办法在 iPhone 5 上拾取麦克风？我可以配置`AVAudioSession`为在前置麦克风或底部麦克风之间进行选择，但我找不到选择后置麦克风的方法。

使用`AVFoundation framework`后置摄像头时，肯定会使用后置麦克风进行视频录制，但我想要一种使用**CoreAudio**来选择相同的方法。那可能吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-19T06:42:24.770

使用 AVAudioSession 获取可用的输入。在我的 iPhone 5 上，它看起来像这样。

```
NSLog(@"%@", [AVAudioSession sharedInstance].availableInputs);

  "<AVAudioSessionPortDescription: 0x14554400, type = MicrophoneBuiltIn; name = iPhone Microphone; UID = Built-In Microphone; selectedDataSource = Back>" 
```

然后使用这些输入之一来获取可用的数据源，就像这样。

```
NSLog(@"%@", [AVAudioSession sharedInstance].availableInputs[0].dataSources);

  "<AVAudioSessionDataSourceDescription: 0x145afb00, ID = 1835216945; name = Bottom>",
  "<AVAudioSessionDataSourceDescription: 0x145b1870, ID = 1835216946; name = Front>",
  "<AVAudioSessionDataSourceDescription: 0x145b3650, ID = 1835216947; name = Back>" 
```

现在您可以设置您的首选数据源。

```
AVAudioSessionPortDescription *port = [AVAudioSession sharedInstance].availableInputs[0];
for (AVAudioSessionDataSourceDescription *source in port.dataSources) {
    if ([source.dataSourceName isEqualToString:@"Back"]) {
        [port setPreferredDataSource:source error:nil];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-16T08:15:24.450

设置`kAudioSessionProperty_Mode`为`kAudioSessionMode_VideoRecording`with`AudioSessionSetProperty`使用离相机最近的麦克风，应该是后置麦克风。那是如果您使用音频会话服务。`AVAudioSessionModeVideoRecording`如果您使用 AVFoundation 进行录制。文档说“使用此模式可能会导致系统提供适当的音频信号处理。” 我将其解释为“我们也可以使用其他麦克风来消除噪音”。

# ios - OpenCV 2.4.3 (iOS) 中的裁剪垫图像

> ID：14446643
> 
> 赞同：6
> 
> 时间：2013-01-21T20:27:07.200
> 
> 标签：ios, opencv

我正在尝试使用适用于 iOS 的 OpenCV 裁剪来自视频流的图像。我不想做任何花哨的事情，只是裁剪图像并显示它。我试过[这个](https://stackoverflow.com/questions/7041181/equivalent-to-cvsetimageroi-in-the-opencv-c-interface)，[这个](https://stackoverflow.com/questions/8267191/how-to-crop-a-cvmat-in-opencv)，似乎都不适合我。作为委托方法，我得到了当前的 cv::Mat 图像，所以我需要的只是创建裁剪效果的代码。

如果需要，我可以做这么复杂的事情[，](https://stackoverflow.com/questions/13098073/adjust-corners-and-crop-the-image-opencv)但我只需要一个矩形裁剪，所以我认为有一个更简单的方法。我只是不明白为什么设置投资回报率对我不起作用！

```
cv::Rect myROI(10, 10, 100, 100);
cv::Mat croppedImage = src(myROI);

src.copyTo(croppedImage);

[displayView setImage:[UIImage imageWithCVMat:src]]; 
```

^^^不工作，只显示原始图像

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-21T21:12:46.893

您的代码中的问题是，通过复制 src 图像，您可以将整个图像复制到裁剪后的图像中。有两种可能：

1 - 不复制数据。它和你做的一样。但是没有第二步。在这种情况下，croppedImage 不是真正的副本，它指向 src 中分配的数据：

```
cv::Mat croppedImage = src(myRoi); 
```

2 - 复制数据。

```
cv::Mat croppedImage;
cv::Mat(src, myRoi).copyTo(croppedImage) 
```

（单线法 - `cv::Mat croppedImage = cv::Mat(src, myRoi).clone();`）

# java - Java空指针异常图像光栅

> ID：14446646
> 
> 赞同：-4
> 
> 时间：2013-01-21T20:27:13.140
> 
> 标签：java, image, nullpointerexception, raster

我正在研究灰度图像压缩程序，到目前为止我已经能够（几乎）将图像转换为二维数组。下面的代码是我现在所拥有的。对我来说似乎很好，但是当我运行它时，它在代码的第 15 行给了我一个空指针异常错误，它是主要的，错误写在下面。

任何帮助将不胜感激！=)

代码和主要是：

```
import java.awt.image.BufferedImage;
import java.awt.image.Raster;
import java.io.File;
import java.io.*;
import javax.imageio.ImageIO;

public class gsTo2d {

private static String dir="C:/Documents and Settings/Administrator/workspace/GrayScaleBitmapCompressor/inputImage"; // add here the directory to the folder contains the image

public int [][] compress() throws IOException
{
    File file = new File(dir , "2.TIF");// file object to get the file, the second argument is the name of the image file
    BufferedImage image = ImageIO.read(file);
    Raster image_raster = image.getData();

    int[][] original; // where we'll put the image

    //get pixel by pixel
    int[] pixel = new int[1];
    int[] buffer = new int[1];

    // declaring the size of arrays
    original = new int[image_raster.getWidth()][image_raster.getHeight()];

    //get the image in the array
    for(int i = 0 ; i < image_raster.getWidth() ; i++)
        for(int j = 0 ; j < image_raster.getHeight() ; j++)
        {
            pixel = image_raster.getPixel(i, j, buffer);
            original[i][j] = pixel[0];
        }
    return original;                   

}
}

public static void main(String[] args) throws IOException{

    gsTo2d obj = new gsTo2d();
    int[][] imageArray = obj.compress();
    System.out.println(imageArray);     

} 
```

错误是：

```
Exception in thread "main" java.lang.NullPointerException
at gsTo2d.compress(gsTo2d.java:15)a
at convTest.main(convTest.java:9) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:37:01.813

如果没有注册的 ImageReader 可以读取以下行中的图像，则 Image 将为 null：

```
BufferedImage image = ImageIO.read(file); 
```

这将在下一行触发 NullPointerException。

也许您的图像在某些方面无效？尝试断线并检查图像是否为空。

# java - 如何阻止 BasicArrowButton 扩展以占用整个工具栏？

> ID：14446651
> 
> 赞同：1
> 
> 时间：2013-01-21T20:27:27.777
> 
> 标签：java, swing, layout, preferredsize, jtoolbar

我正在创建一个`JToolBar`包含两个按钮的窗口。一个是正​​则`JButton`，另一个是`BasicArrowButton`( `javax.swing.plaf.basic.BasicArrowButton`)。在不做任何额外配置的情况下，`JButton`不会在工具栏中展开，而是`BasicArrowButton`展开占据整个工具栏。

我试图通过将其最大和首选尺寸设置为 16x16 来将其配置为适合 16x16 的小正方形。但这不起作用。也尝试使用 setSize() 没有成功。谁能告诉我问题可能出在哪里？

我还尝试在`BasicArrowButton`. 那也没有用。

我正在使用JDK1.7.0_07。

```
public class ToolbarTest {

    private JFrame frame;

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    ToolbarTest window = new ToolbarTest();
                    window.frame.setVisible(true);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    public ToolbarTest() {
        initialize();
    }

    /**
     * Initialize the contents of the frame.
     */
    private void initialize() {
        frame = new JFrame();
        frame.setBounds(100, 100, 450, 300);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JToolBar toolBar = new JToolBar();
        frame.getContentPane().add(toolBar, BorderLayout.NORTH);

        JButton btnEdit = new JButton("Edit");
        toolBar.add(btnEdit);

        //------------------------------------------------------------
        JButton btnUp = new BasicArrowButton(BasicArrowButton.NORTH);
        btnUp.setSize(new Dimension(16, 16));
        btnUp.setMaximumSize(new Dimension(16, 16));
        toolBar.add(btnUp);
        //------------------------------------------------------------
    }
} 
```

![在此处输入图像描述](../Images/044cdf2cad07f29515883fd43c214687.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T11:01:33.697

另一个例子为什么你不应该调用任何[setXXSize 方法](https://stackoverflow.com/a/7229519/203657):-)

正如@trashgod 已经提到的，JToolBar 的默认 LayoutManager 是一个 BoxLayout，它尊重组件的 maxSize。因此，尝试以某种方式使按钮返回合理的值是朝着正确方向迈出的一步。令人惊讶的是，这根本没有效果。

它在这里不起作用的原因是... BasicArrowButton 返回硬编码的大小，即通过 XX 设置的值被简单地忽略。这是核心片段：

```
public Dimension getMaximumSize() {
    return new Dimension(Integer.MAX_VALUE, Integer.MAX_VALUE);
} 
```

出路是扩展和覆盖，fi：

```
JButton btnUp = new BasicArrowButton(BasicArrowButton.NORTH) {

    @Override
    public Dimension getMaximumSize() {
        return getPreferredSize();
    }

}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T10:26:49.097

在内部，`JToolBar`使用`DefaultToolBarLayout`的子类`BoxLayout`。您可以使用`setLayout()`. `FlowLayout`可能是一个合适的选择：

```
JToolBar bar = new JToolBar("Edit Menu");
bar.setLayout(new FlowLayout(FlowLayout.LEFT)); 
```

# excel - 在 Excel 中，如何仅从具有完整地址的单元格中提取状态？

> ID：14446654
> 
> 赞同：0
> 
> 时间：2013-01-21T20:27:50.007
> 
> 标签：excel, function, search, replace

我有一个完整地址的列表，每个地址都在自己的单元格中，我只想从中提取州的缩写。

*   单元格 1：345 左 Ln，无处，TX 340598
*   单元 2：839 右博士，格伦代尔 - NC 3498
*   单元 3： 0983 Alphabet St，马萨诸塞州波士顿 - 23409

我有一个包含状态缩写的单元格列表/范围，我只是不知道如何在每个单元格中搜索所有 50 个缩写然后输出。搜索替换的另一个问题是，某些缩写自然会出现在单元格中，因为街道名称（例如上面第二个示例中的“Glendale”）中包含 AL，它是州缩写，但不是州。不幸的是，地址没有以统一的方式格式化，并且可以有不同的标点符号。

对于上面示例中的第二个地址，我可以输出 AL, NC，因为将其中有多个状态的少数情况分开并不难。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:35:51.793

在您的示例中，州缩写总是在两边都有一个空格，因此您可以使用此公式，假设地址在 A2 中，州缩写列表在 Z2:Z50

`=LOOKUP(2^15,SEARCH(" "&$Z$2:$Z$50&" "," "&A2&" "),$Z$2:$Z$50)`

复制公式以获取每个地址的结果

如果地址中的州缩写总是在大写字母中并且缩写列表总是在大写字母中，那么 FIND 函数将比 SEARCH 更可取，因为 FIND 不区分大小写，因此“误报”的可能性较小

**更新：**

鉴于您的评论 - 状态缩写可能不是大写，可能两边都没有空格......但大概“真实”状态将是单元格中的**最后一个**匹配项？要获得该公式，请尝试适用于任何版本的 Excel

`=MID(A2,MAX(IF(ISNUMBER(SEARCH($Z$2:$Z$50,A2)),SEARCH($Z$2:$Z$50,A2))),2)`

....或者这个适用于 Excel 2007 或更高版本

`=MID(A2,MAX(IFERROR(SEARCH($Z$2:$Z$50,A2),"")),2)`

这些是需要使用 CTRL+SHIFT+ENTER 确认的“数组公式”。将公式粘贴到单元格中，然后按 F2 键选择公式 - 然后在按 ENTER 的同时按住 CTRL 和 SHIFT 键。如果操作正确，您将在公式周围看到像 { 和 } 这样的花括号，并希望得到正确的结果。对第一个公式执行此操作，然后向下复制列。

如果您有 Excel 2010，则可以使用如下 AGGREGATE 函数使用非数组公式更简单地执行此操作：

`=MID(A2,AGGREGATE(14,6,SEARCH($Z$2:$Z$50,A2),1),2)`

# php - Jquery Mobile Post 到 PHP（同一页面）

> ID：14446656
> 
> 赞同：0
> 
> 时间：2013-01-21T20:27:57.707
> 
> 标签：php, jquery, jquery-mobile

不知道我错过了什么，价值不会发布。我希望将代码发布到当前页面（test.php）

```
<script>
$(document).ready(function(){
    $("#submit_response").click(function() {
         $.post(test.php, {name: 'demo'}, success: function(data) {

         });
     });    
});
</script>

<a href="#" id="submit_response" data-role="button" data-theme="a">Demo Save</a>

<?php if(isset($_POST['name'])) echo 'Posted: '.$_POST['name'];?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:35:32.147

请注意，您的内容不会更新为 `<?php if(isset($_POST['name'])) echo 'Posted: '.$_POST['name'];?>`

为了使它工作，你可以这样做：

第一次在任何内容之后在所有 html 的底部创建一个名为`update()`或您想要的所有内容的函数

**更新功能：**

```
<?php
function update(){
    if(isset($_POST['name']) && $_POST['name'] == "demo" ) {
        header('Content-Type: application/json');
        echo json_encode($_POST['name'])    ;
        exit(); // To avoid full html page be delivered
    }
}
?> 
```

并在您的所有 HTML 或任何内容之前调用它 `<?php update(); ?>`

然后你的javascript更新你的页面：

```
<script>
$(document).ready(function(){
$("#submit_response").click(function() {
        $.post(<?php echo '"'.$_SERVER['SCRIPT_FILENAME'].'"' ?>, {name: 'demo'}, dataType:"json", 
            success: function(data) {
                    $("#contentToUpdate").html(data.name);
            });
    }); 
});

</script> 
```

# php - php邮件更改每封邮件中的称呼用户名，同时使用密件抄送功能

> ID：14446661
> 
> 赞同：0
> 
> 时间：2013-01-21T20:28:24.577
> 
> 标签：php, email, bcc

当发布新回复时，我正在使用 php mail 向消息线程中的所有成员发送邮件。

```
 include('Mail.php');
            include('Mail/mime.php');

            // Constructing the email
            $sender = "sender@sender.com";                              // Your name and email address
            //$to= "" ;                         // The Recipients name and email address
            $subject = $Sname." has posted a reply";                                            // Subject for the email

            $html = "<html><body><p> DearMember, <br>    $Sname has replied to one of your posts. </p></body></html>";  
            $crlf = "\n";
            $headers = array(
                            'From'          => $sender,
                            'Return-Path'   => $sender,
                            'Subject'       => $subject,
                            'Bcc'           => $recipients
                            );

            // Creating the Mime message
            $mime = new Mail_mime($crlf);

            // Setting the body of the email
            $mime->setTXTBody($text);
            $mime->setHTMLBody($html);

            $body = $mime->get();
            $headers = $mime->headers($headers);

            // Sending the email
            $mail =& Mail::factory('mail');
            $mail->send(null, $headers, $body); 
```

现在，我将收件人称为“成员”。是否可以将其更改为个人用户名并仍然使用密件抄送功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:12:01.747

你不能。您可以使用长密件抄送列表向所有收件人发送相同的消息，也可以向每个用户发送一条个性化消息（为每个用户`mail()`单独调用），但无法为每个收件人发送一封不同的电子邮件。

# java - 在 JAVA 中检查字符串文件时如何排除逗号？

> ID：14446668
> 
> 赞同：-1
> 
> 时间：2013-01-21T20:28:55.027
> 
> 标签：java, regex, string, contains

我正在尝试检查 java 中的字符串文件中的特定单词。

例子：

```
 public String test()    {
                    String text= "Your, me, everybody";

        if(!text.contains("You"))
            test1+= " and all!";
        return test1;
    } 
```

**编辑：**感谢回复。但我需要的是：我有一个充满单词和逗号的文本。并且当且仅当单词 text.contains(you) 或 text.matches 时，如果该单词不在字符串中，那么它将被添加。但是，如果我尝试重新执行该示例，它会说“您”在文本中，因此不会执行*test1+= “和所有！”；* 在这个特定的例子中，它并没有那么危险，但是当我有一串大约 100 个单词时，有些单词非常相似。或以相同的字母开头或后面有逗号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:36:09.277

只需使用`text.contains("You")`- String.contains() 将 CharSequence 作为参数。不需要正则表达式。

请注意，如果 charSequence 完全在字符串中，则例如匹配“Your”。对于这个特定的演示来说又快又脏——但我不建议这样做（除非你想要那种行为）。

您需要将 String.matches(String regex) 用于适当的正则表达式 - 如其他答案中所述。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:37:21.610

首先，`contains()`采用文字字符串而不是正则表达式。其次，`\b`在字符串文字中具有特殊含义（[它是退格字符](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10.6)）。

因此如下：

```
 if(!text.contains("\bYou\b")) 
```

需要成为

```
 if(!text.matches(".*\\bYou\\b.*")) 
```

# java - 如何成功地结合这两个 JUnit 测试的逻辑？

> ID：14446670
> 
> 赞同：0
> 
> 时间：2013-01-21T20:29:03.063
> 
> 标签：java, unit-testing, junit

我正在为一个相对简单的类编写一些单元测试：

```
public class Asylum {
    List<Guard> guards = new ArrayList<Guard>();
    List<Inmate> inmates = new ArrayList<Inmate>();

    public void addGuard(Guard g) { //... }
    public void addInmate(Inmate i) { //... }
} 
```

我对这两个函数的单元测试确定了如果我传入一个空值会发生什么：

```
@Test
public void addGuardNullValue() {
    asylum.addGuard(null);
    assertEquals(0, asylum.getNumGuards());
}

@Test
public void addInmateNullValue() {
    asylum.addInmate(null);
    assertEquals(0, asylum.getNumInmates());
} 
```

实际上，我有几个（> 3）这些警卫、囚犯、监狱长等容器，但我宁愿不为他们的所有班级编写基本相同的单元测试。

有什么办法可以把它归结为一个单元测试来覆盖*n 个*类？

（请注意，我无法为 Guard 和 Inmate 创建一个总体父类，也无法创建他们都可以实现的接口。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:02:38.663

我只看到两种解决方案，我也不推荐。

首先是使用反射。列出类中的所有方法并选择名称如`add*`或的方法`getNum*`。然后你可以调用`add*`一个空值并检查返回值`getNum*`。问题是您可能在方法名称 ( ) 中有误报，`addGroup`并且生成的测试将难以读取（和写入）。

第二种解决方案是`addPerson(PersonType type, Object person)`一种`person`根据`PersonType`. 我发现这是一个糟糕的选择，因为它消除了静态类型检查，增加了不必要的复杂性并且容易被进一步滥用。我提到是因为您可能会发现一些有用的变化。

我的最终答案是“不要这样做，这不值得”。您将需要更多的行，但它们非常易于阅读和编写，并且在第一次尝试时可能没有错误。

我想以我认为合适的报价结束：

> 首先，调试的难度是编写代码的两倍。因此，如果您尽可能巧妙地编写代码，那么根据定义，您还不够聪明，无法对其进行调试。（布赖恩·克尼根）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:17:52.083

第一的。正确的答案 IMO 来自 BoppreH。不要这样做。

但这是使用反射的方法。
您不妨开始阅读有关[反射 API的文档](http://docs.oracle.com/javase/tutorial/reflect/index.html)

```
package sandbox;
......
......
@Test
public void testAddClasses() throws Exception {
    String classesToTest[] = new String[]{"Inmate", "Guard"};
    for (String classToTest : classesToTest){
        String fullClassName = "sandbox." + classToTest;
        String addMethodName = "add" + classToTest;
        String countMethodName = "getNum" + classToTest + "s"; 

        Asylum asylum = new Asylum();

        Class asylumClass = asylum.getClass();
        Class testClass = Class.forName(fullClassName, true, asylumClass.getClassLoader());

        Method addMethod = asylumClass.getDeclaredMethod(addMethodName, testClass);
        Object voidObj = addMethod.invoke(asylum, (Object)null);

        Method countMethod = asylumClass.getDeclaredMethod(countMethodName, null);
        int count = (int) countMethod.invoke(asylum, null);

        assertEquals(0, count);
    }
} 
```

# javascript - 用 var 中的值替换图形

> ID：14446671
> 
> 赞同：0
> 
> 时间：2013-01-21T20:29:05.340
> 
> 标签：javascript, jquery, raphael, graphael, justgage

我有一个函数，我必须在其中设置一些选项：

```
var g4 = new JustGage({
  id : "g4",
  value : (0, 200),
  min : 0,
  max : 500,
  title : "Facebook likes",
  showMinMax : false
}); 
```

从另一个函数中，我得到了我喜欢的计数器：

```
function(data) {
  var likes = (data[0].fan_count );
}); 
```

不，我想更换最大值。value, 200 到 var likes 的值。

```
value : (0, 200), 
```

我的解决方案`value : (0, {likes}),`不起作用。

怎么了？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:07:28.537

我认为您的代码有问题。

你觉得 有什么`value : (0, 200),`作用？

`value`将等于`20`。

您遇到的其他问题是范围问题。看起来你对局部变量有一些影响，我猜你正在处理异步回调，就像它们是同步的一样。

我想你真正追求的只是

```
function makeAGage( value ) {
    var g4 = new JustGage({
                id : "g4",
                value : (0, 200),
                min : 0,
                max : 500,
                title : "Facebook likes",
                showMinMax : false
            });
} 
```

你回拨

```
function(data) {
    makeAGage(data[0].fan_count);
}); 
```

# javascript - 单元素中的 stellar.js

> ID：14446673
> 
> 赞同：0
> 
> 时间：2013-01-21T20:29:11.100
> 
> 标签：javascript, jquery, html, jquery-plugins

我正在使用 stellar.js，但我遇到了一个问题，我不知道我是否使用错了，或者插件是否无法正常工作......

我有一个 html 元素

```
<section id="dbr" data-stellar-background-ratio="1.5" rel="dbr"> 
```

当我这样调用恒星插件时：

```
$.stellar({responsive: true}); 
```

它工作得很好！但是当我这样尝试时它不起作用：

```
$('#dbr').stellar(); 
```

难道我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:55:34.600

初始化 Stellar.js 时，将其指向正在滚动的元素（例如`$(window).stellar()`，或`$.stellar()`简称）

第一行有效而不是第二行的原因是您将 Stellar.js 指向不同的元素，而看起来您需要始终将其指向`window`. 如果它是`$(window).stellar()`，或者只是，你的第二个例子会起作用`$.stellar()`。

为了让 Stellar.js 正常工作，它需要知道哪个元素正在滚动，以便它可以密切关注滚动事件。初始化后，它将自动搜索嵌套在其中的所有视差元素或背景。所以，即使你只有一个元素，你也需要调用`.stellar()`against `window`。

希望有帮助:)

# jquery - 是否可以在 jquery 数据表中分两步加载数据？

> ID：14446675
> 
> 赞同：1
> 
> 时间：2013-01-21T20:29:12.937
> 
> 标签：jquery, datatables

我使用带有 sAjaxSource 的 jquery 数据表，并希望以第一种方式在 col 1、col 2、col 3、col 4 中加载数据，因为在我的数据源中，我有一个来自 sql 查询的 json，执行时间约为 1 分钟。第二种方式，我想在col 5，col 6，col 7中加载数据我必须尽可能在数据表中显示数据我想为2个步骤=> 2个数据源编写2个查询，并将数据加载到数据表分两步；有可能吗？怎么做？或者我该怎么办？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:33:20.337

这个怎么样：http: [//datatables.net/usage/server-side](http://datatables.net/usage/server-side)

> 服务器端处理
> 
> 有时从 DOM 读取数据太慢或太笨重，尤其是在处理数千或数百万行数据时。为了解决这个 DataTables 的服务器端处理特性，提供了一种方法让所有“繁重的工作”都由服务器端的数据库引擎完成（它们毕竟针对这类事情进行了高度优化），然后在用户的网络浏览器中绘制该信息。因此，您可以轻松地显示由数百万行组成的表格。
> 
> 当使用服务器端处理时，DataTables 将对页面上的信息的每次绘制（即分页、排序、过滤等）向服务器发出 XHR 请求。DataTables 会向服务器发送一些变量，让其执行所需的处理，然后以DataTables 要求的格式返回数据。

# css - 如何在 CSS 中制作三角圆角三角形

> ID：14446677
> 
> 赞同：57
> 
> 时间：2013-01-21T20:29:18.550
> 
> 标签：css, css-shapes

我想在不使用 Javascript 的情况下实现这样的自定义颜色形状： ![3角圆角三角形](../Images/9cd089736f1edb5f1b011c537ff9c720.png)

目前，我正在将“框架”的图像覆盖在橙色矩形 div 上，但这很 hacky。我想我可以使用动态生成的画布元素，但这不仅需要 JS，还需要 HTML5 画布支持。有任何想法吗？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2013-01-22T05:07:01.400

我最好的尝试：[http ://dabblet.com/gist/4592062](http://dabblet.com/gist/4592062) ![最后](../Images/8a8a3def9ba97da34f3a6af94aae44ad.png)

任何尺寸的像素完美，使用比 Ana 原始解决方案更简单的数学运算，并且在我看来更直观 :)

```
.triangle {
	position: relative;
	background-color: orange;
	text-align: left;
}
.triangle:before,
.triangle:after {
	content: '';
	position: absolute;
	background-color: inherit;
}
.triangle,
.triangle:before,
.triangle:after {
	width:  10em;
	height: 10em;
	border-top-right-radius: 30%;
}

.triangle {
	transform: rotate(-60deg) skewX(-30deg) scale(1,.866);
}
.triangle:before {
	transform: rotate(-135deg) skewX(-45deg) scale(1.414,.707) translate(0,-50%);
}
.triangle:after {
	transform: rotate(135deg) skewY(-45deg) scale(.707,1.414) translate(50%);
}
```

```
<div class="triangle"></div>
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-01-21T22:00:34.827

# [**dabblet 演示**](http://dabblet.com/gist/4589858)

```
.triangle, .triangle:before, .triangle:after { width: 4em; height: 4em; }
.triangle {
	overflow: hidden;
	position: relative;
	margin: 7em auto 0;
	border-radius: 20%;
	transform: translateY(50%) rotate(30deg) skewY(30deg) scaleX(.866);
	cursor: pointer;
	pointer-events: none;
} 
.triangle:before, .triangle:after {
	position: absolute;
	background: orange;
	pointer-events: auto;
	content: '';
}
.triangle:before {
	border-radius: 20% 20% 20% 53%;
	transform: scaleX(1.155) skewY(-30deg) rotate(-30deg) translateY(-42.3%) 
			skewX(30deg) scaleY(.866) translateX(-24%);
}
.triangle:after {
	border-radius: 20% 20% 53% 20%;
	transform: scaleX(1.155) skewY(-30deg) rotate(-30deg) translateY(-42.3%) 
			skewX(-30deg) scaleY(.866) translateX(24%);
}

/** extra styles to show how it works **/

.triangle:hover { overflow: visible; }
.triangle:hover:before, .triangle:hover:after { background: none; }
.triangle:hover, .triangle:hover:before, .triangle:hover:after {
	border: dashed 1px;
}
```

```
<div class='triangle'></div>
```

`.triangle`这个想法非常简单：您首先对您的元素应用一系列变换（它具有`overflow: hidden;`- 您可以删除它以查看会发生什么；））以获得菱形。

然后你将相同的变换应用于`:before`和`:after`伪元素，再加上一些使它们也变成菱形。

最后，你有三个相交的菱形，橙色的形状是它们的交点。悬停三角形以查看相交的形状；）

它可以很好地缩放，您只需要更改元素的`width`和。`height``.triangle`

对于 Firefox、Chrome 和 Safari，只有带圆角的橙色三角形对悬停敏感（感谢`pointer-events: none;`元素`.triangle`和`pointer-events: auto;`伪元素）。否则，这可以通过包装`.triangle`在具有相同`width`和`height`（以及相同`border-radius`）和的元素中来实现`overflow: hidden;`。

* * *

### 笔记

*   您也可以使用 CSS 渐变来实现。但是，[与 2D 变换不同](http://caniuse.com/#feat=transforms2d)，CSS 渐变[在 IE9 中不起作用](http://caniuse.com/#feat=css-gradients)。
*   我希望我不必取消从父级继承倾斜的伪元素，只是在旋转后再次倾斜它们，但它似乎不起作用。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-01-21T20:32:15.647

使用某种图像。这就是图像的用途。如果您需要缩放，[SVG 是一个不错的选择](http://jsfiddle.net/ZA8ea/)，否则，只需使用 png 作为背景，或者`<img>`如果它是内容的一部分，则使用元素。

如果您绝对*必须*将它放在 CSS 文件中，您可以尝试[data: urls](http://en.wikipedia.org/wiki/Data_URI_scheme)（IE7 及以下版本不支持）。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2020-12-28T23:36:03.857

首先，我们使用创建三角形`clip-path`：

```
.triangle {
  display: inline-block;
  width: 150px;
  color:orange;
}

.triangle::before {
  content: "";
  display: block;
  padding-top: 86%;
  background: currentColor;
  clip-path: polygon(50% 0, 100% 100%, 0 100%);
}
```

```
<div class="triangle"></div>
```

然后我们应用受[本文启发的 SVG 过滤器](https://css-tricks.com/gooey-effect/)

```
.triangle {
  display: inline-block;
  width: 150px;
  color:orange;
  filter: url('#goo');
}

.triangle::before {
  content: "";
  display: block;
  padding-top: 86%;
  background: currentColor;
  clip-path: polygon(50% 0, 100% 100%, 0 100%);
}
```

```
<div class="triangle"></div>
<div class="triangle" style="color:red;width:200px;"></div>
<div class="triangle" style="color:blue;width:250px;"></div>

<svg style="visibility: hidden; position: absolute;" width="0" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1">
  <defs>
        <filter id="goo"><feGaussianBlur in="SourceGraphic" stdDeviation="8" result="blur" />    
            <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9" result="goo" />
            <feComposite in="SourceGraphic" in2="goo" operator="atop"/>
        </filter>
    </defs>
</svg>
```

[![CSS 圆角三角形](../Images/c8d85c6a6300cbb6b4df545da401a0b4.png)](https://i.stack.imgur.com/z5vP4.png)

要控制半径，我们只需调整`stdDeviation`过滤器的

* * *

考虑到这一点，您可以使其与任何类型的三角形甚至随机形状一起使用：

```
.triangle {
  display: inline-block;
  width: 150px;
  color:orange;
  filter: url('#goo');
}

.triangle::before {
  content: "";
  display: block;
  padding-top: 86%;
  background: currentColor;
  clip-path: polygon(50% 0, 100% 100%, 0 100%);
}

.triangle.type2::before {
  padding-top: 70%;
  clip-path: polygon(0 0, 100% 100%, 0 100%);
}

.triangle.type3::before {
  padding-top: 100%;
  clip-path: polygon(50% 0, 80% 100%, 0 70%);
}

.triangle.hex::before {
  padding-top: 100%;
  clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
}
```

```
<div class="triangle"></div>
<div class="triangle type2" style="color:red;"></div>
<div class="triangle type3" style="color:blue;"></div>
<div class="triangle hex" style="color:purple;"></div>

<svg style="visibility: hidden; position: absolute;" width="0" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1">
  <defs>
        <filter id="goo"><feGaussianBlur in="SourceGraphic" stdDeviation="8" result="blur" />    
            <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9" result="goo" />
            <feComposite in="SourceGraphic" in2="goo" operator="atop"/>
        </filter>
    </defs>
</svg>
```

[![CSS圆角形状](../Images/f050708beb5fe1b7c8bf170bfba6131e.png)](https://i.stack.imgur.com/bA0hz.png)

值得注意的是，我们可以轻松地为形状添加复杂的背景：

```
.triangle {
  display: inline-block;
  width: 150px;
  filter: url('#goo');
}

.triangle::before {
  content: "";
  display: block;
  padding-top: 86%;
  background: var(--b,orange);
  clip-path: polygon(50% 0, 100% 100%, 0 100%);
}

.triangle.type2::before {
  padding-top: 70%;
  clip-path: polygon(0 0, 100% 100%, 0 100%);
}

.triangle.type3::before {
  padding-top: 100%;
  clip-path: polygon(50% 0, 80% 100%, 0 70%);
}

.triangle.hex::before {
  padding-top: 100%;
  clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
}
```

```
<div class="triangle"></div>
<div class="triangle type2" style="--b:linear-gradient(red,blue);"></div>
<div class="triangle type3" style="--b:conic-gradient(green,pink,green);"></div>
<div class="triangle hex" style="--b:url(https://picsum.photos/id/1067/200/200) center/cover;"></div>

<svg style="visibility: hidden; position: absolute;" width="0" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1">
  <defs>
        <filter id="goo"><feGaussianBlur in="SourceGraphic" stdDeviation="8" result="blur" />    
            <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9" result="goo" />
            <feComposite in="SourceGraphic" in2="goo" operator="atop"/>
        </filter>
    </defs>
</svg>
```

[![带有 CSS 渐变的圆形](../Images/92fd3bc38207e10b30f1ab836a1d6ecd.png)](https://i.stack.imgur.com/IUAmF.png)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-01-22T03:48:33.137

安娜的回答启发我尝试另一种方法，这种方法远非完美，但至少是对称的。这是真实尺寸的预览并被放大。它只是一个包裹在剪裁圆/边框半径中的边框黑客三角形：

![预习](../Images/22ffa388eaf3cfbb111c6b8316141815.png)

`font-size`和代码（通过单个属性调整整体大小）：

```
.triangle {
    font-size: .8em;
    position: relative;
    width: 3.8em;
    height: 3.8em;
    text-align: center;
    margin: 10% auto 0;
    overflow: hidden;
    border-radius: 100%;
} 
.triangle:before {
    content: '';
    position: absolute;
    width:0;
    height: 0;
    border: solid 2em transparent;
    border-bottom-color: orange;
    border-bottom-width: 3.2em;
    border-top-width: 0;
    margin: -.3em -2em;
} 
```

在这里玩它：http: [//dabblet.com/gist/4590714](http://dabblet.com/gist/4590714)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-03-09T14:16:07.627

玩了 Murray Smiths 最受好评的版本。将其编写为 Stylus mixin 并修复了一些边距问题并添加了方向选项。mixin 还将三角形缩放到像素完美的大小。没有很好地测试。小心使用

[http://codepen.io/perlundgren/pen/VYGdwX](http://codepen.io/perlundgren/pen/VYGdwX)

```
 triangle(direction = up, color = #333, size = 32px)
        position: relative
        background-color: color
        width:  2*(round(size/3.25))
        height: 2*(round(size/3.25))
        border-top-right-radius: 30%
        &:before,
        &:after
          content: ''
          position: absolute
          background-color: inherit
          width:  2*(round(size/3.25))
          height: 2*(round(size/3.25))
          border-top-right-radius: 30%

        if direction is up
          transform: rotate(-60deg) skewX(-30deg) scale(1,.866)
          margin: (@width/4) (@width/2.5) (@width/1.2) (@width/2.5)

        if direction is down
          transform: rotate(-120deg) skewX(-30deg) scale(1,.866)
          margin: 0 (@width/1.5) (@width/1.5) (@width/6)

        if direction is left
          transform: rotate(-30deg) skewX(-30deg) scale(1,.866)
          margin: (@width/5) 0 (@width) (@width/1.4)

        if direction is right
          transform: rotate(-90deg) skewX(-30deg) scale(1,.866)
          margin: (@width/5) (@width/1.4) (@width) 0

        &:before
          transform: rotate(-135deg) skewX(-45deg) scale(1.414,.707) translate(0,-50%)
        &:after
          transform: rotate(135deg) skewY(-45deg) scale(.707,1.414) translate(50%) 
```

然后只需将mixin添加到您的课程中

```
 .triangle
      &.up
        triangle()
      &.down
        triangle(down)
      &.left
        triangle(left)
      &.right
        triangle(right) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-10-26T00:46:13.080

-- 简化版 --

在我的情况下，我需要文本伴随三个圆角的三角形图标，但是`overflow: hidden;`建议根本不起作用，因为文本最终被隐藏了。

最终结果：[![这个单词](../Images/0922f4871643392d990c4ad7ec95c9fb.png)](https://i.stack.imgur.com/UZDr9.png) ...演示：[https ://jsfiddle.net/allenski/7p4tbznr/](https://jsfiddle.net/allenski/7p4tbznr/)

我能够通过使用来实现类似的面具`clip-path`。注意：在 IE 中不起作用；但是大多数已经停止支持 IE，尤其是在微软这样做之后。在他们的新 Edge 浏览器中运行良好。

HTML：

```
<span class="warning">
    Mandatory
</span> 
```

CSS：

```
.warning {
    position: relative;
    display: inline-block;
    font-weight: bold;
    color: #FF5500;
}
.warning:before {
    position: absolute;
    top: 50%;
    right: 12px;
    font-size: 18px;
    font-weight: bold;
    color: #FFFFFF;
    transform: translateY(-36%);
    text-shadow: 0 0 7px #111111;
    z-index: 1;
    content: '!';
}
.warning:after {
    display: inline-block;
    margin-left: 3px;
    font-size: 5px;
    border: solid 3em transparent;
    border-top-width: 0;
    border-bottom-width: 5em;
    border-bottom-color: #FF5500;
    clip-path: circle(54% at 50% 69%);
    vertical-align: bottom;
    content: '';
} 
```

在 CSS 中，三角形是`:after`伪元素。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-07-09T20:18:46.843

我看到有人要求等腰三角形，并且通过篡改上面接受的答案，我发现了如何操纵它来获得我想要的东西，因为我需要同样的东西。这应该有助于任何寻找圆角三角形略有变化的人。

您会注意到我将宽度、高度和边框右上角半径分开，然后继续更改边框右上角半径以塑造角。我唯一更改的另一件事是直接在元素上的 transform 属性。你可以按照你认为合适的方式塑造它，但这些似乎是唯一必要的改变。

```
.diff-arrow {
  margin-left:30px;
  position: relative;
  background-color: #20C0F1;
  text-align: left;
  width: 10em;
  height: 10em;
  border-top-right-radius: 20%;
}

.diff-arrow:before,
.diff-arrow:after {
  content: '';
  position: absolute;
  background-color: inherit;
  width: 10em;
  height: 10em;
  border-top-right-radius: 15%;
}

.diff-arrow {
  transform: rotate(-45deg) skewX(0deg) scale(0.5);
}

.diff-arrow:before {
  transform: rotate(-135deg) skewX(-45deg) scale(1.414, .707) translate(0, -50%);
}

.diff-arrow:after {
  transform: rotate(135deg) skewY(-45deg) scale(.707, 1.414) translate(50%);
}
```

```
<div class="diff-arrow"></div>
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-04-02T15:49:01.410

从典型的边界三角形开始，然后向三角形添加 svg 过滤器。

```
.c-paper-plane {
    position: relative;
}
.scene {
    transform-style: preserve-3d;
    transform: rotate3d(0.2, -1, -0.8, -177deg);
}
svg.paper-plane {
    transform: rotateX(0) translateZ(-3px);
    transform-origin: center;
}
.paper-tail {
    transform: rotateX(0deg) translate(31px, 10px) translateZ(-5px);
    transform-origin: center;
    fill: grey;
}
.paper-tail-div {
    transform: rotateX(269deg) translate(237px, 55px) translateZ(139px);
    fill: grey;
    transform-origin: center;
    position: absolute;
    top: 0;
    width: 0;
    height: 0;
    border-top: 100px solid red;
    border-right: 150px solid transparent;
    filter: url('#goo');
}
```

```
<div class="c-paper-plane">
  <div class="scene">
    <svg id="paper-plane" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 139.549 79.269">
                <defs>
                    <filter id="goo"><feGaussianBlur in="SourceGraphic" stdDeviation="8" result="blur" />    
                        <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9" result="goo" />
                        <feComposite in="SourceGraphic" in2="goo" operator="atop"/>
                    </filter>
                </defs>
                <g class="plane-group">
                    <path class="paper-wing" d="M47.377,76.654V47.025c0-1.137,0.871-2.084,2.003-2.178l60.357-5.062c0.2-0.01,0.2-0.29,0-0.31l-60.356-5.052
                    c-1.133-0.095-2.004-1.042-2.004-2.179V2.615c0-1.878,1.922-3.142,3.646-2.399l87.37,37.662c1.54,0.664,1.54,2.848,0,3.512
                    l-87.37,37.662C49.299,79.796,47.377,78.531,47.377,76.654z"/>
                </g>
            </svg>
    <div class="paper-tail-div"></div>
  </div>
</div>
```

# jquery - 如何将复选框中选中的对象从jsp传递到servlet

> ID：14446680
> 
> 赞同：0
> 
> 时间：2013-01-21T20:29:24.447
> 
> 标签：jquery, jsp, servlets

我正在将对象列表从 servlet 传递到 JSP。在 JSP 页面上显示它们，例如

```
<c:forEach items="${plcContacts}" var="contact">
    <tr>
    <td><input type="checkbox" name="contacts" class="case" id ="${contact.col2}" >></input><br></td>
    <td>${contact.col5}</td>
    <td>${contact.col4}</td>
    <td class="teamFunction">${contact.col2}</td>
    </tr>
    </c:forEach> 
```

在上面，

```
contact.col5 is email id, 
contact.col4 is name,
contact.col2 is team member function. 
```

所以我有选择所有联系人的按钮，取消选择所有联系人，基于他们的功能的联系人。我已经使用 JQuery 成功完成了它，如下所示。

```
 // add multiple select functionality
    $("#CheckAll").click(function () {
          $('.case').prop('checked', true);
    });

    $("#UnCheckAll").click(function () {
          $('.case').prop('checked', false);
    });

// check by Function
    $("#CheckByFunction").click(function() {    
        $('input[type=checkbox]').each(function () {
            var plc = $('#plcFunction').val().replace(/ /g, '-');
            var teamFunction =  this.id.replace(/ /g, '-');
            if (plc == teamFunction) {
                $(this).prop('checked', true);
            } else {
                 $(this).prop('checked', false);
            }
        });
    }); 
```

我的问题是，当在此 JSP 页面上单击下一步按钮时，我需要将选中复选框的联系人对象列表发送到 servlet。我正在尝试像下面那样做。

```
**//read all the checked contacts**
$("#Next").click(function() {
  selected = new Array();
  $("input[type='checkbox']:checked").each(function() { 
    selected.push($(this).val());
  });
}); 
```

我可以通过将它们放入 session 来检索 servlet 中的所有联系人对象，但我只需要选中复选框的联系人。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T15:19:33.623

你需要给你的复选框一个唯一的值来标识选中的值：

```
<input type="checkbox" name="contacts" value="${contact.col2}" /> 
```

然后您可以使用[`HttpServletRequest#getParameterValues()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getParameterValues%28java.lang.String%29)来获取所有检查值：

```
String[] checkedContacts = request.getParameterValues("contacts"); 
```

就这样。提交时无需将其收集到某个 JS 数组中。这是一个丑陋的 JS hack，它不会优雅地降级（即，如果最终用户禁用了 JS，则整个提交都会中断）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:51:04.990

好吧，您将`undefined`值存储在数组中，因为您的复选框没有`value`属性，而且您的标记无效，`input`元素没有结束`</input>`标记，假设您的输入具有以下类，您可以使用`map`方法并将值存储在数组中。

```
var selected = $('#table tr').has('input[type=checkbox]').map(function(){
       var $this = $(this);
       return {
          val: $this.find('input[type=checkbox]').val(),
          email: $this.find('input[type=text].email').val(),              
          name: $this.find('input[type=text].name').val(),
          // ...
       }
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:41:26.893

首先，您的 html 需要一个 value 属性集，而不是 id：

```
<c:forEach items="${plcContacts}" var="contact">
    <tr>
    <td><input type="checkbox" name="contacts" class="case" value="${contact.col2}"></input></td>
    </tr>
</c:forEach> 
```

其次，您的 javascript 应该类似于以下内容：

```
$("#CheckAll").click(function () {
    //Notice use of attr here, not prop
    $('.case').attr('checked', true);
});

$("#UnCheckAll").click(function () {
      //notice we are remove attr
      $('.case').removeAttr('checked');
});

//should be able to complete the fill by function based off the above

//to get the selected, you weren't far off, biggest thing should actually be
//the setting of value instead of id.
var selected = [];
$("input[type='checkbox']:checked").each(function() { 
    selected.push($(this).val());
});
//spit the array out so you can see what you end up with.
console.log(selected) 
```

# android - 如何在应用程序启动时检查等待通知消息

> ID：14446681
> 
> 赞同：0
> 
> 时间：2013-01-21T20:29:30.720
> 
> 标签：android, google-cloud-messaging

我实现了适用于 Android 的 Google Cloud Messaging (GCM)。我正在使用 GCM 服务：

```
 <service android:name=".GCMIntentService" /> 
```

当新消息到达时 onMessage 触发：

```
 protected void onMessage(Context context, Intent intent) { 
```

`GCMIntentService`如果服务由于某种原因停止工作并且新通知到达，我只会面临一个问题。现在，即使用户启动应用程序，上述内容`onMessage`也不会被解雇。

我想知道在这种情况下是否有应用程序检查是否有任何新的等待通知，因为 GCMIntentService 没有运行而被错过。

问题`GCMIntentService`只是在用户第一次启动应用程序时才开始工作，但考虑例如用户重启手机的情况，在这种情况下`GCMIntentService`仍然没有运行。

# c - 为什么在使用 GCC 编译时不必包含我的头文件？

> ID：14446682
> 
> 赞同：1
> 
> 时间：2013-01-21T20:29:32.797
> 
> 标签：c, gcc, include

我的理解是，为了使用在头文件中声明并在匹配的源文件中定义的函数，必须在 main() 之前包含所述头文件。那么为什么下面的编译和运行使用得很好：

*gcc -o 你好 hellomain.c 你好.c*

**hellomain.c**

```
int main(int argc, char *argv[])
{
    helloPrint();

    return 0;
} 
```

**你好.h**

```
#ifndef hello_h
#define hello_h

void helloPrint();

#endif 
```

**你好ç**

```
#include <stdio.h>

void helloPrint()
{
    printf("Hello, World!");
} 
```

这显然是一个非常简化的例子，但它说明了我的问题；为什么我不必在“hellomain.c”中包含“hello.h”？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T20:30:50.337

当使用没有原型的函数时，编译器会对其返回类型和它采用的参数做出某些假设。在这种情况下，这些假设恰好是有效的，即使它假设函数返回一个`int`.

* * *

正如 Eric Postpischil 在评论中指出的那样，非常不鼓励省略原型，因为它可能会导致细微的错误。您应该始终确保您的函数调用具有可用的所需原型，最好包括它们相应的标头。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T20:32:15.627

当您在 C 源文件中使用未声明的函数时，编译器会从调用派生参数并假定返回类型为 int。

根据 ISO 标准“编程语言 - C”

> **6.5.2.2 函数调用**
> 6 如果表示被调用函数的表达式具有不包含原型的类型，
> ...
> 如果自变量的数量不等于参数的数量，则行为未定义。

这意味着，当你使用一个函数而不声明它并且你的参数数量和函数的实际参数数量不一致时，所有的赌注都没有了。

> ...
> 如果函数定义的类型不包含原型，并且提升后的参数类型与提升后的参数类型不兼容，则行为未定义，...

此外，当您使用一个函数而不声明它并且您的参数类型和函数的实际类型不匹配时，任何事情都可能发生。

因此，尽管它在某些情况下可能有效，但您应该声明您在程序中使用的函数。如果不这样做，编译器将无法帮助检测函数声明和函数调用之间的不匹配。

# postgresql - 可以将 Postgres 用作文档数据库吗？

> ID：14446684
> 
> 赞同：3
> 
> 时间：2013-01-21T20:29:46.927
> 
> 标签：postgresql, postgresql-9.1, postgresql-9.2, document-database

假设我们正在构建一个用于存储来自网站或移动应用程序的分析的数据库。**事务不重要**（可以丢弃），只会减慢速度，支持尽可能多的并发调用，最终可能会保持一致性，并且**部分数据将是非结构化**的（即用户可以传递随机 JSON blob作为分析日志调用的参数，我们将其存储在数据库中）。

像 Mongo 这样的东西将是一个合理的选择，因为它确实满足了我上面列出的大部分要求。然而，人们确实经常听说 Postgres 具有可定制以填补许多不同角色的能力。我想一个人可以禁用交易等。

我对 Postgres 设置不是很熟悉，因此我必须问：实际上是否可以调整 Postgres 以适应我上面列出的要求？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-22T04:11:41.417

您必须尝试一下/进行一些调整，看看它是否满足您的性能需求。但是，Postgres 内置了对透明存储大列值（最大 1GB）的支持，称为[TOAST](http://www.postgresql.org/docs/9.2/static/storage-toast.html)（从 7.1 开始）。Postgres 即服务提供商[Heroku](https://postgres.heroku.com/blog/past/2012/3/14/introducing_keyvalue_data_storage_in_heroku_postgres/)利用这一点，使用其 hstore 非结构化文本 Postgres 数据类型提供“文档存储”功能——该页面包含来自 hstore 采用者的示例应用程序。至于调优，我认为[Postgres 9.0 High Performance](http://www.postgresql.org/about/news/1249/)对于不熟悉 postgres 的人来说是一个很好的参考，可以按主题找出在 Postgres 在线文档中的位置。为了完整起见，Postgres 有一个[大对象 API](http://www.postgresql.org/docs/9.2/static/largeobjects.html)它可以处理高达 2GB 的对象，但这会使迁移到另一个 RDBMS 比使用像 TOAST 这样的透明解决方案更加困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-09T19:18:35.727

您可以查看使用[https://www.mangodb.io/](https://www.mangodb.io/)这是一个有线兼容的 MongoDB 到 SQL 代理。

# .net - 当索引未更改时触发列表框事件 SelectedIndexChanged

> ID：14446693
> 
> 赞同：2
> 
> 时间：2013-01-21T20:30:05.047
> 
> 标签：.net, vb.net, winforms

我在一个winforms后面有这个代码，它只是有一个`listbox`作为它的唯一控件：

```
Imports System.Windows.Forms
Public Class Form1

    Public Sub New()

        ' This call is required by the designer.
        InitializeComponent()

        ' Add any initialization after the InitializeComponent() call.
        ListBoxX.Items.Add("hello")
        ListBoxX.Items.Add("world")
        ListBoxX.Items.Add("foo")
        ListBoxX.Items.Add("bar")

    End Sub

    Private Sub ListBoxX_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles ListBoxX.SelectedIndexChanged
        MessageBox.Show("change registered")
    End Sub

    Private Sub ListBoxX_SelectedValueChanged(sender As Object, e As System.EventArgs) Handles ListBoxX.SelectedValueChanged
        MessageBox.Show("change registered X")
    End Sub
End Class 
```

如果选择了“hello”然后我点击“hello”然后出现消息框——如果我点击同一个项目，那么*SelectedIndex*没有**改变**——那么为什么会触发这个事件呢？如何确保它仅在索引更改时触发？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:43:17.120

检查事件内部是否与之前选择的项目相同，

单击时保存最后选择的项目。

```
Private Sub ListBoxX_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles ListBoxX.SelectedIndexChanged
    if Not LastItem = ListBoxX.SelectedItem Then
        MessageBox.Show("change registered")
        LastItem = ListBoxX.SelectedItem 
    end if
End Sub 
```

自从我用VB编写代码以来已经有一段时间了，所以我希望这段代码没问题。

我假设无论选择哪个项目，事件都会触发。

另一种解决方案是覆盖 ListBox 用户控件，但我认为您不需要它。

# ios - 现有的 UIDocument 不会在 iCloud 上更新

> ID：14446695
> 
> 赞同：0
> 
> 时间：2013-01-21T20:30:07.957
> 
> 标签：ios, icloud, uidocument

我有一个应用程序在创建、存储、移动和读取新文件到云端和从云端读取新文件时没有问题。我遇到的问题是修改云中已经存在的文档。我打电话

```
[NSFileManager defaultManager] setUbiquitous:YES fromURL:localURL toURL:iCloudURL]; 
```

在这两种情况下，都可以确认它会触发并且目标/本地 URL 是正确的。无论出于何种原因，虽然它不会编辑文件，但只能创建一个新文件。我的猜测是我需要为文件编辑做一些不同的事情，但也许我遗漏了一些东西。有人有想法么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:51:23.433

我找到了一个成功更新文档的答案，但是我不确定这是否是最佳方式。我打电话给：

```
[[NSFileManager defaultManager] removeItemAtURL:iCloudURL]]; 
```

在调用 [setUbiquitious] 方法之前。不过希望看到另一种解决方案。

# google-maps-api-3 - 静态谷歌地图中的半径

> ID：14446697
> 
> 赞同：0
> 
> 时间：2013-01-21T20:30:11.783
> 
> 标签：google-maps-api-3

有谁知道如何使用这样的网址在静态谷歌地图中绘制半径？

```
 http://maps.google.com/maps/api/staticmap?size=400x400.... 
```

我正在寻找互联网，但我没有找到任何例子。

此致。

# php - 在 API-Explorer/Swagger 中描述响应对象

> ID：14446700
> 
> 赞同：1
> 
> 时间：2013-01-21T20:30:21.273
> 
> 标签：php, restler, swagger

我正在使用[Restler 3 的 API-Explorer](https://github.com/Skookum/SwaggerToMarkdown)，它是[Swagger-UI](https://github.com/wordnik/swagger-ui)的一个分支，我想知道是否有人找到了一种有效的方法来记录/描述 API 返回的响应 JSON 对象。显然，当您以交互方式试用 API 时，其中的一些——以“字里行间”的方式——是可用的，但我想要一些更详细地指示响应结构的方式。有没有人为此提出任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T10:44:24.910

您可以使用`@return`PHPDoc 注释来做到这一点。

例如，查看资源管理器中[的](http://restler3.luracast.com/examples/_009_rate_limiting/explorer/index.html#!/authors-v1/v1-authors-_id-_get)速率限制 [示例](http://restler3.luracast.com/examples/_009_rate_limiting/readme.html)

```
GET authors.json/{id} 
```

你会发现**响应信息**列表

```
Author ( name: string, email: string ) 
```

它来自以下设置为返回类型的类

```
<?php
/**
 * Dummy class, used only for creating swagger spec model (json schema)
 * look at the generated resources json to understand
 */
class Author
{
    public $name='Name';
    public $email='name@domain.com';
} 
```

# c - 在 switch case 语句中显式转换

> ID：14446704
> 
> 赞同：1
> 
> 时间：2013-01-21T20:30:28.813
> 
> 标签：c, casting, switch-statement

我有一个名为 label 的字符指针，还有一个包含名为“label”的元素的枚举器。如何在案例陈述中区分它们？

```
switch((I_ARG_TYPES) progrm[i].arg[j].type){
case (I_ARG_TYPES) value:
    break;
case (I_ARG_TYPES) label:
    break;
default:
    break;
} 
```

全球范围：

```
typedef enum I_ARG_TYPES {
    value, label
} I_ARG_TYPES; 
```

在与开关相同的功能中：

```
char label[MAXLINELENGTH] 
```

标签的案例上的“案例标签不会减少为整数”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:33:09.537

你不能。（同样，如果你这样做`float printf`，你不能`printf()`在那个范围内调用函数。）

解决方案：不要给局部变量赋予与全局范围内的事物相同的名称。

# xcode - XCode 4.5.2 行为

> ID：14446706
> 
> 赞同：1
> 
> 时间：2013-01-21T20:30:31.063
> 
> 标签：xcode

我对 XCode 4.5.2 IDE 行为有疑问。假设我有一个名为“HelloWorld”的项目，XCode 在其中创建文件夹“HelloWorld”和一个名为“Resources”的子文件夹，当我将文件或 .png 文件拖到“Resources”文件夹中时，在 Finder 中这些文件位于在“HelloWorld”文件夹中。

我在使用 Xcode 4.2 时没有这种行为。这正常吗？？

谢谢！

狮子座;

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:36:04.407

这种行为是正常的，只要 Xcode 4 出现，AFAIK 就一直是这样。资源文件夹作为“组”添加到 Xcode 项目文件中。这只是在 Xcode 中组织文件的一种方式，即使这些文件都只是添加到后面的主项目文件夹中。

要获得正确的文件组织，您需要在项目文件夹级别手动创建文件夹。然后，您可以在 Xcode 中创建组并根据您想到的任何方案重新链接您的源文件。

请记住，如果您在操作系统级别而不是 Xcode 移动文件，则文件链接可能会在 Xcode 中中断。这会将文件变成红色，就像 Xcode 找不到文件一样。通常我只会从 Xcode 中删除文件，然后将其添加回来，创建对该文件的文件夹引用，而不是让 Xcode 将文件复制回来（这会创建副本并破坏目的）。

# javascript - 用户与 iframe 中的对象交互后 JavaScript 确认离开

> ID：14446709
> 
> 赞同：0
> 
> 时间：2013-01-21T20:30:37.927
> 
> 标签：javascript, html, forms, iframe

我目前有一个格式与此类似的网页，带有侧边栏和 iframe，其来源指向我网站上的其他页面。

![在此处输入图像描述](../Images/4e9ec8250a0cb644e054eb346e8d78bb.png)

我有以下代码可以为用户提供一个确认框，以确认他们是否希望离开该页面：

```
window.onbeforeunload = function(e) {
    return 'All unsaved data will be lost.';
}; 
```

在 iframe 中，我有各种 HTML 元素，例如文本字段、输入框、按钮等。我不希望用户获得该`onbeforeunload`功能**，除非**他们首先单击这些输入元素之一。

当然，我可以进入并编写每个文本字段、按钮等的代码，通过创建一个变量`shouldPopup`（`onclick`例如未来更多的变化，我可能不得不再次进入并修改每个元素。`shouldPopup``TRUE``onbeforeunload`

获得相同结果的更好方法是什么？非常感谢有关如何简化代码的任何输入！:)

**更新：**

有关我的 iframe 的更多信息。我将 jQuery 库用于一些基本功能（没什么花哨的）。其中有相当多的 PHP，以及一些数据库请求，但没有什么特别之处。希望这些信息对希望提出任何建议的人有所帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:18:33.590

If you don't want to change too much of your code, I think toggeling a flag is OK. The following is a simple, pragmatic approach.

Example form:

```
<input type="text" class="form" ...>
<input type="text" class="form" ...>
<select class="form" ...>
   <option value=""></option>
   ...
</select> 
```

Monitor changes in both iFrames:

```
(function(){
  // This can be optimized to check against saved values on blur
  $("body").on("change", ".form", function(evt){
    window.top.$(window.top).trigger("change-form"); // trigger custom event in parent page
  });
}()); 
```

Parent page:

```
(function(){
  var dirty = false
  $(window).on("change-form", function(){
    dirty = true;
  });

  window.onbeforeunload = function(e) {
    // Notify user only if forms are dirty
    return dirty ? 'All unsaved data will be lost.' : undefined;
  };
}()); 
```

This code is braindump, it's untested.

**Note:** If your pages are served from different domains than the parent page you'll run into cross site scripting issues. In that case you're not able to access the parent page's Javascript. Then you have to use [postMessage()](http://css.dzone.com/news/postmessage-html5-send) to send messages to your parent page's domain.

* * *

I'd suggest you to take a look at [Backbone.js](http://backbonejs.org/):

*   [https://github.com/documentcloud/backbone/wiki/Tutorials%2C-blog-posts-and-example-sites](https://github.com/documentcloud/backbone/wiki/Tutorials%2C-blog-posts-and-example-sites)
*   [http://backbonejs.org/#examples](http://backbonejs.org/#examples)

# Edit 1:

Backbone can help you managing the state of your form. In Backbone a [Model](http://backbonejs.org/#Model) will represent your form data. A [View](http://backbonejs.org/#View) - representing your form (form's inputs) - is bound to that Model. It will monitor your form fields and [set()](http://backbonejs.org/#Model-set) attributes on the model. A Backbone Model has its own state, you can check if the form has chnaged using e.g. the [changed()](http://backbonejs.org/#Model-changed) method. Separating Model and View in your application is always a good idea, it helps separating the responsibilities.

I just wanted to give you another idea.

# Edit 2:

Fixed the code that triggers an event in the top window. I was not sure if `$(window.top)` works. It does not work. I'm not sure why. I've tested it and this code is correct:

```
window.top.$(window.top). ... 
```

I've updated the above code.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:02:07.647

似乎您正在寻找（基本上）一个脏标志（就像这里的 SO 使用）。本质上，因为这是对设计的补充，所以将脚本与 UI 分开，只使用某种选择器来获取所有可能被更改的元素并绑定一个简单地监视和更改脏标志的事件。

为简洁起见，这里有一个 jQuery 版本：

```
var isDirty = false;
$(':input').on('change', function(e){
  isDirty = true;
});
$(window).on('beforeunload',function(e){
  if (isDirty){
    // Alert th euser there's unfinished changes
  }
}); 
```

非常简单，并且将脚本分开。此外，如果这些是您的子窗口，您可以引用`window.parent`并将标志传递给主视图（如果您选择了）。

# javascript - 无法调用自调用函数

> ID：14446716
> 
> 赞同：0
> 
> 时间：2013-01-21T20:31:16.337
> 
> 标签：javascript

我正在尝试调用自调用函数，但它似乎不起作用，因为您可以看到下面的代码我能够发出警报（测试），但当它被另一个函数调用时却不能。请指教-谢谢

```
var test = (function(a,b){
       return a*b;
           })(4,5);

function myFunc() {};

alert(test); // working
alert(test.call(myFunc, 10,5)); // not working 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:35:56.727

您正在评估第 0 行的函数，并将返回值“20”分配给`test`. 因为 20 是一个数字，而不是一个函数，所以你不能调用它。请尝试：

```
var test = function(a,b){
  return a*b;
};
alert(test(4,5));
alert(test(10,5)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:41:36.830

立即调用函数是在加载脚本时立即执行的函数。在您的示例中， test 旁边的函数立即执行，并返回值 20。

我有一种感觉，你真正想要的是这样的：

```
var test = (function()
{
    var a = 4,
        b = 5;

    return function()
    {
        return a*b;
    }
}()); 
```

So in what I wrote above, test will NOT be set to 20\. Instead, it'll be set to a function that multiplies `a` against `b` and returns 20\. Why? Cause when I immediately invoke the function, it's not returning the actual value; it's returning yet another function, and that function then returns the actual value that I'm trying to calculate.

# php - Header() 未执行（可能由于邮件功能）

> ID：14446721
> 
> 赞同：0
> 
> 时间：2013-01-21T20:31:30.997
> 
> 标签：php

在我的[网站上](http://www.LolStreamGallery.net)，我使用了联系表格，这给我带来了很多麻烦。我已经花了一些时间在`mail()`使用 exim4 使 PHP 函数在 64 位 Debian 上运行，但我终于做到了，并且发送了邮件。

现在我遇到了另一个问题，我不知道如何解决。首先是代码。

```
<?php
$your_email = 'blahblah@gmail.com';
session_start();
$errors        = '';
$name          = '';
$visitor_email = '';
$user_message  = '';

if (isset($_POST['submit'])) {
    $name          = $_POST['name'];
    $visitor_email = $_POST['email'];
    $user_message  = $_POST['message'];
    ///------------Do Validations-------------
    if (empty($name) || empty($visitor_email)) {
        $errors .= "\n Name and Email are required fields. ";
    }
    if (IsInjected($visitor_email)) {
        $errors .= "\n Bad email value!";
    }
    if (empty($_SESSION['6_letters_code']) || strcmp($_SESSION['6_letters_code'], $_POST['6_letters_code']) != 0) {
        //Note: the captcha code is compared case insensitively.
        //if you want case sensitive match, update the check above to
        // strcmp()
        $errors .= "\n The captcha code does not match!";
    }

    if (empty($errors)) {
        //send the email
        $to      = $your_email;
        $subject = "New form submission";
        $from    = $your_email;

        $body = "A user  $name submitted the contact form:\n" . "Name: $name\n" . "Email: $visitor_email \n" . "Message: \n " . "$user_message\n";

        $headers = "From: $from \r\n";
        $headers .= "Reply-To: $visitor_email \r\n";

        if (mail($to, $subject, $body, $headers)) {
            header('Location: http://www.lolstreamgallery.net/thank-you.html');
        } else {
            $errors .= "\n E-Mail coulnd be sent!";
        }
    }
} 
```

问题是标头重定向不起作用。确实有效，因此`mail()`应该执行标题。当我在本地测试文件时，确实会发生重定向。

如果您想测试联系表，可以在[这里](http://lolstreamgallery.net/RequestStream.php)进行。

[这](http://codeviewer.org/view/code:2ecd)是整个文件代码：

编辑2：

我现在正在使用 Ian Brindley 的功能，它使重定向工作，但不是标头功能。标题之前似乎有一些输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:17:55.473

乍一看，我在 header() 调用之前看不到任何输出。

如果没有更好的选择，这是我不久前发现的一个函数，我现在几乎所有的重定向都使用它。

```
function redirect($url){
    if (!headers_sent()){    
        header('Location: '.$url);
        exit;
    }
    else {  
        echo '<script type="text/javascript">';
        echo 'window.location.href="'.$url.'";';
        echo '</script>';
        echo '<noscript>';
        echo '<meta http-equiv="refresh" content="0;url='.$url.'" />';
        echo '</noscript>'; exit;
    }
} 
```

我知道非服务器端重定向并不理想。

# java - 在 Java 中使用 indexOf

> ID：14446723
> 
> 赞同：2
> 
> 时间：2013-01-21T20:31:34.033
> 
> 标签：java, string

我正在尝试使用 indexOf(" "); 在这个字符串上

`"This i$ an aardvaAr yeEeeAs onDo qwerty XYZ9";`

这是我的代码

```
 space = word.indexOf(" ");

        tempWord = word.substring(0, space); 
```

现在我得到了我想要的`This`字符串，但现在我如何得到下一个空格，它后面有这个：`i$`，下一个空格是字符串的结尾？

***编辑**

请不要为这个问题设置数组

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T20:32:32.000

使用也采用起始索引的[重载：`indexOf`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#indexOf%28int,%20int%29)

```
int nextSpace = word.indexOf(" ", space + 1); 
```

（尽管很可能有更好的方法来解决您的更大问题。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:20:11.930

如果您不想拆分字符串（并创建一个字符串数组），您可以在点击第一个空格后读取字符串的其余部分（顺便说一句。这似乎是关于递归函数的功课）：

```
int space = test.indexOf(" ");
String before = test.substring(0, space);
String after = test.substring(space + 1); 
```

# php - 删除 .php 扩展名和“?id=xyz”

> ID：14446724
> 
> 赞同：1
> 
> 时间：2013-01-21T20:31:42.873
> 
> 标签：php, .htaccess

> **可能重复：**
> [删除 URL 中的 .php 扩展名](https://stackoverflow.com/questions/14445077/removing-php-extension-in-urls)

我已将 my 的子目录更改`public_html`为主目录。目前，`mysite.com/alpha/index.php`重定向为`mysite.com`. 这是完美的工作。

同样，我还有另一个文件`events.php`，即`mysite.com/alpha/events.php?eventid=10`对应`mysite.com/events.php?eventid=10`

但是，我想访问上面的路径`mysite.com/events/10/`而不是`mysite.com/events.php?eventid=10`. 为此，我再次修改了文件，但无法加载`dynamic URLs`. 例如，当我将鼠标悬停在链接上时，它会显示

```
`mysite.com/events/14` 
`mysite.com/events/15` 
`mysite.com/events/16` 
`mysite.com/events/17` 
```

等等[这就是我想要的]但是点击它[如果我点击`mysite.com/events/14`悬停时显示的链接]，它会打开一个页面`mydomain.com//alpha/events.php/14/14?eventid=`并且页面不会从`sql`表格中获取任何内容。

我的 .htaccess 文件：

```
# .htaccess main domain to subdirectory redirect
# Copy and paste the following code into the .htaccess file
# in the public_html folder of your hosting account
# make the changes to the file according to the instructions.
# Do not change this line.
RewriteEngine on
RewriteRule ^([A-Za-z0-9\-]+)/([0-9]+)/?$ $1.php?eventid=$3
# Change example.com to be your main domain.
RewriteCond %{HTTP_HOST} ^(www.)?mysite.com$
# Change 'subdirectory' to be the directory you will use for your main domain.
RewriteCond %{REQUEST_URI} !^/alpha/
# Don't change these line.'
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# Change 'subdirectory' to be the directory you will use for your main domain.
RewriteRule ^(.*)$ /alpha/$1
# Change example.com to be your main domain again.
# Change 'subdirectory' to be the directory you will use for your main domain
# followed by / then the main file for your site, index.php, index.html, etc.
RewriteCond %{HTTP_HOST} ^(www.)?mysite.com$
RewriteRule ^(/)?$ alpha/index.php [L]

RewriteCond %{HTTP_HOST} !^www\.
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:39:27.373

你的 apache 配置的第 7 行应该更像：

```
RewriteRule ^([A-Za-z0-9\-]+)/([0-9]+)/?$ $1.php?eventid=$2 [L] 
```

# wordpress - wordpress 单{posttype}.php

> ID：14446728
> 
> 赞同：1
> 
> 时间：2013-01-21T20:32:14.267
> 
> 标签：wordpress

我已复制并修改了 single.php 文件，如下所述：

```
 http://codex.wordpress.org/Post_Types 
```

为了向其中添加自定义 html 文件。

是否可以在仪表板上使用正常程序创建帖子，但这会调用新的 single-{posttype}.php 而不是 single.php ？意思是可以从每次模板中选择使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T06:39:35.290

好吧，有一个插件：

> ### [自定义帖子模板](http://wordpress.org/extend/plugins/custom-post-template/)
> 
> 提供下拉菜单以从帖子编辑屏幕选择不同的帖子模板。模板替换`single.php`指定的帖子。

否则，您可能需要检查过滤器挂钩**[`template_include`](https://wordpress.stackexchange.com/a/57214/12615)**。

# java - 添加到通用集合

> ID：14446731
> 
> 赞同：0
> 
> 时间：2013-01-21T20:32:20.057
> 
> 标签：java, generics, collections

我有一个通用类，它应该创建一个存储在数组中的可比较集合。我非常不清楚可比性和泛型的工作方式。

```
public class OrderedCollection<T extends Comparable<? super T>> 
{
private T collection[]; // the collection
private int size, tempValue; // how many elements currently stored

/**
 * Constructor allocates array and initializes size
 * @param size the number of elements stored
 */
    public OrderedCollection (int capacity) 
    {
    collection = (T[]) new Comparable[capacity];
    size = 0;       
    }
} 
```

首先，集合是什么类型的*集合*（数组、列表等）。它从未显式实例化为 new Array[] 所以我很好奇这应该如何创建一个数组。

其次，需要一种插入指定值的方法（出于测试目的，我一直使用'5'）并将其分配给collection[0]。但是，当我返回 collection[0] 时，它返回为 null。下面是插入方法：

```
public void insert(T x) 
{
    collection[0] = x;
} 
```

没有什么花哨。对于集合返回 null 的原因以及我应该如何将指定的*x*值添加到集合中，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:51:05.887

正常的约定是：

```
private T[] collection; 
```

你的是 C 兼容语法。

```
public void add(T x) {
    if (size >= collection.length)
        throw new IllegalStateException();
    collection[size] = x;
    ++size;
} 
```

Collection 是任何类型的集合的接口。实现类是 HashTree、ArrayList 等。

这是与其他一些语言的不同之处，Java 没有像 JavaScript 这样的一些“集合”类，而是一些接口，它们具有您可以选择的实现。因此，对于 Map，您可以选择 HashMap、TreeMap、LinkedHashMap 等。所以在API中你放了接口，但是实现使用了一些实现的技术优势。

例如遍历 TreeMap 是按键排序的。LinkedHashMap 的遍历是按插入顺序排列的。

关于 null 一定是编程错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:03:11.107

除了 Collection 是什么的问题（在 API 中查找）之外，您发布的代码也可以正常工作。使用一些实现 Comparable 的内置类（如 Integer 或 String）对其进行测试...您可以发布调用 insert() 方法的代码吗？

# java - 使用 Java servlet 和 HTML 表单检索数据库数据

> ID：14446733
> 
> 赞同：2
> 
> 时间：2013-01-21T20:32:26.650
> 
> 标签：java, sql, database, servlets

我创建了一个简单的表单和一个小 servlet 来从浏览器执行 SQL 语句。当我单击表单上的“提交查询”按钮时，returinig 页面显示没有从数据库中检索到任何内容。它只在浏览器上显示“数据库结果”（标签部分）。请告诉我我的代码有什么问题。

SQLTestForm.java

```
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import java.sql.*;

public class SQLTestForm extends HttpServlet {
    public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html");
        PrintWriter out = response.getWriter();
        String title = "Results";
        String docType = 
            "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 " + "Transitional//EN\"\n";
            out.print(docType + "<HTML>\n" + "<HEAD><TITLE>" + title + "</TITLE></HEAD>\n" + "<BODY>" + "<H1>Database Results</H1>\n");

        String driver = request.getParameter("driver");
        String url = request.getParameter("url");
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        String qry = request.getParameter("query");
        showTable(driver, url, username, password, qry, out);
        out.println("</BODY></HTML>");
    }

  public void showTable(String driver, String url, String username, String password, String qry, PrintWriter out) {
    try {
    Class.forName(driver);
    Connection conn = DriverManager.getConnection(url, username, password);
    DatabaseMetaData dbMetaData = conn.getMetaData();
    out.println("<UL>");
    String productName = dbMetaData.getDatabaseProductName();
    String productVersion = dbMetaData.getDatabaseProductVersion();
    out.println(" <LI><B>Database:</B> " + productName + " <LI><B>Version:</B> " + productVersion + "</UL>");
    Statement stmt = conn.createStatement();
    ResultSet rs = stmt.executeQuery(qry);
    out.println("<TABLE BORDER=1>");
    ResultSetMetaData rm = rs.getMetaData();
    int cnum = rm.getColumnCount();
    out.println("<TR>");
        for(int i=1; i <= cnum; i++) {
            out.print("<TH>" + rm.getColumnName(i));
        }
        out.println();
        while(rs.next()) {
            out.println("<TR>");
                for(int i=1; i <= cnum; i++) {
                    out.print("<TD>" + rs.getString(i));
                }
            out.println();
        }
        out.println("</TABLE>");
        conn.close();
    } catch (ClassNotFoundException cnfe) {
        System.err.println("Error loading driver: " + cnfe);
    } catch (SQLException se) {
        System.err.println("Error connecting: " + se);
    } catch(Exception e) {
        System.err.println("Error with input: " + e);   }  } } 
```

SQLTestForm.html

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
 <HEAD>
  <TITLE>SQL Test Form</TITLE>
 </HEAD>
 <BODY>
  <H2>Query Input:</H2>
  <FORM ACTION="/SQLTestForm" METHOD="POST">
  <TABLE>
   <TR><TD>Driver:
   <TD><INPUT TYPE="TEXT" NAME="driver" VALUE="com.jdbc.mysql.Driver" SIZE="45">
   <TR><TD>URL:
   <TD><INPUT TYPE="TEXT" NAME="url"
   VALUE="jdbc:mysql://localhost:3306/test" SIZE="45">
   <TR><TD>Username:
   <TD><INPUT TYPE="TEXT" NAME="username">
   <TR><TD>Password:
   <TD><INPUT TYPE="PASSWORD" NAME="password">
   <TR><TD VALIGN="TOP">Query:
   <TD><TEXTAREA ROWS="5" COLS="35" NAME="query"></TEXTAREA>
   <TR><TD COLSPAN="2" ALIGN="CENTER"><INPUT TYPE="SUBMIT">
  </TABLE>
  </FORM>
 </BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T19:04:15.843

您的类路径缺少 jdbc 驱动程序。这可能有两个原因：

1.  您忘记在您的 war-file 或 shared/commons-lib 文件夹中提供 deiver。
2.  您拼错了驱动程序类名（在您的评论中您写的是 com.djbc 而不是 com.jdbc

你知道你打开了数据库的后门吗？数据库引擎检查数据库请求的来源。现在请求来自您的网络服务器。每台可以访问您的网页的计算机都将连接到您的数据库。

你应该改变你的代码：

*   永远不要使用 uncheck 参数并将它们传递给数据库。
*   使用`PreparedStatement`代替`Statement`
*   不要进行字符串连接来创建查询

# ios5 - 如何在 iOS 中为 UISearchBar 呈现自定义键盘？

> ID：14446736
> 
> 赞同：0
> 
> 时间：2013-01-21T20:32:40.773
> 
> 标签：ios5, uisearchbar

我似乎无法从我的 SearchBar 中显示我的自定义键盘。它适用于 UITextField 和 UITextView。我从类似问题的网络中收集了一些此代码，但仍然无法使其正常工作。这是所有代码：

```
@interface CustomSearchBar : UISearchBar
@property (readwrite, retain) UIView *inputView;
@end

//////////////
@implementation CustomSearchBar
@synthesize inputView; 
```

/////////自定义键盘//.h文件//////

```
#import <UIKit/UIKit.h>
#import "CustomSearchBar.h"

@interface PKCustomKeyBoard : UIView <UIInputViewAudioFeedback, UISearchBarDelegate>

 @property (strong, nonatomic) IBOutlet UIImageView *keyboardBackground;
 @property (strong, nonatomic) IBOutletCollection(UIButton) NSArray *characterKeys;
 @property (strong, nonatomic) IBOutlet UIButton *deleteButton;

 @property (strong) id<UITextInput> textView;
 @property (strong, nonatomic) CustomSearchBar *customSearchBar;

 - (IBAction)deletePressed:(id)sender;
 - (IBAction)characterPressed:(id)sender;

 @end 
```

/////////自定义键盘//.m文件//////

```
- (id)init 
{

UIInterfaceOrientation orientation = [[UIDevice currentDevice] orientation];
CGRect frame;

if(UIDeviceOrientationIsLandscape(orientation))
    frame = CGRectMake(0, 0, 1024, 352);
else
    frame = CGRectMake(0, 0, 768, 264);

self = [super initWithFrame:frame];

if (self) {
    NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"PKCustomKeyBoard" owner:self options:nil];
    [[nib objectAtIndex:0] setFrame:frame];
    self = [nib objectAtIndex:0];
}

NSMutableArray *buttons = [NSMutableArray arrayWithArray:self.characterKeys];

for (UIButton *b in buttons) {
    [b setBackgroundImage:[PKCustomKeyBoard imageFromColor:[UIColor colorWithWhite:0.5 alpha:0.5]]
                 forState:UIControlStateHighlighted];
    b.layer.cornerRadius = 7.0;
    b.layer.masksToBounds = YES;
    b.layer.borderWidth = 0;
}

[self loadCharactersWithArray:kChar];

_customSearchBar.delegate = self;

return self;
  }

-(void) setCustomSearchBar:(CustomSearchBar *)customSearchBar
 {
if ([customSearchBar isKindOfClass:[CustomSearchBar class]])
   [customSearchBar setInputView:self];

_customSearchBar = customSearchBar;
 }

-(void)setTextView:(id<UITextInput>)textView {

if ([textView isKindOfClass:[UITextView class]])
    [(UITextView *)textView setInputView:self];
else if ([textView isKindOfClass:[UITextField class]])
    [(UITextField *)textView setInputView:self];

_textView = textView;

 }

-(id<UITextInput>)textView {
return _textView;
 }

  -(void)loadCharactersWithArray:(NSArray *)a {
int i = 0;
for (UIButton *b in self.characterKeys) {
    [b setTitle:[a objectAtIndex:i] forState:UIControlStateNormal];
    [b.titleLabel setFont:kFont];
    [b.titleLabel setTextColor:[UIColor blackColor]];
    i++;
}
  }

 - (BOOL) enableInputClicksWhenVisible {
 return YES;
   }

- (IBAction)deletePressed:(id)sender {
[[UIDevice currentDevice] playInputClick];
[self.textView deleteBackward];
[[NSNotificationCenter defaultCenter] postNotificationName:UITextViewTextDidChangeNotification
                                                    object:self.textView];
if ([self.textView isKindOfClass:[UITextView class]])
    [[NSNotificationCenter defaultCenter] postNotificationName:UITextViewTextDidChangeNotification object:self.textView];
else if ([self.textView isKindOfClass:[UITextField class]])
    [[NSNotificationCenter defaultCenter] postNotificationName:UITextFieldTextDidChangeNotification object:self.textView];
  }

 - (IBAction)characterPressed:(id)sender {
[[UIDevice currentDevice] playInputClick];
UIButton *button = (UIButton *)sender;
NSString *character = [NSString stringWithString:button.titleLabel.text];

if ([character  isEqualToString:@"space"])
    character = @" ";

[self.textView insertText:character];

if ([self.textView isKindOfClass:[UITextView class]])
    [[NSNotificationCenter defaultCenter] postNotificationName:UITextViewTextDidChangeNotification object:self.textView];
else if ([self.textView isKindOfClass:[UITextField class]])
    [[NSNotificationCenter defaultCenter]  postNotificationName:UITextFieldTextDidChangeNotification object:self.textView];
     }

+ (UIImage *) imageFromColor:(UIColor *)color {
CGRect rect = CGRectMake(0, 0, 1, 1);
UIGraphicsBeginImageContext(rect.size);
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextSetFillColorWithColor(context, [color CGColor]);
CGContextFillRect(context, rect);
UIImage *img = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
return img;
}

@end 
```

////////////ViewController .h文件//////////////////////////

```
@interface SearchVC : UIViewController
@property (weak, nonatomic) IBOutlet CustomSearchBar *customSearchBar;
@property (weak, nonatomic) IBOutlet UITextField *myTextField;
@property (weak, nonatomic) IBOutlet UITextView *myTextView;
@end 
```

////////////ViewController .m 文件///////////////////////////

```
@interface SearchVC ()

@end

 @implementation SearchVC
@synthesize customSearchBar;
@synthesize myTextView,myTextField;

- (void)viewDidLoad
{
 [super viewDidLoad];

    PKCustomKeyBoard *customKeyboard = [[PKCustomKeyBoard alloc] init];
    [customKeyboard setTextView:myTextView];
  //  [customKeyboard setTextView:myTextField];
    [customKeyboard setCustomSearchBar:self.customSearchBar];
 }
} 
```

# php - 快速创建参考数组

> ID：14446737
> 
> 赞同：1
> 
> 时间：2013-01-21T20:32:42.097
> 
> 标签：php, arrays, foreach

我经常遇到这种情况：

```
foreach ($someObjects as &$someObject)
{
  $someObjectsIndex[$someObject->id] = $someObject;
} 
```

和这个：

```
$thingsIActuallyWant = [];
foreach ($associativeList as &$associativeItem)
{
  $thingsIActuallyWant[] = $associativeItem['id'];
} 
```

我想知道是否有现有的方法或其他东西可以更短地编写这些东西，而无需编写 foreach 循环。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:38:28.003

您可以使用[`array_map`](http://php.net/array_map)它返回一个包含您想要的元素的数组。

对于第二个例子：

```
$thingsIActuallyWant = array_map(function($a){
    return $a['id'];
}, $associativeList); 
```

至于第一个，我建议使用`foreach`你所拥有的，因为任何替代方案都将是一个丑陋的[`array_map`](http://php.net/array_map)and [`array_combine`](http://php.net/array_combine)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:35:18.480

您可以尝试自己编写一个函数，如下所示：

```
function pluck($arr, $key)
{
    $tbr = array();

    foreach ($arr as $val)
    {
        if (is_array($val) && isset($val[$key]))
        {
            $tbr []= $val[$key];
        }
        elseif (is_object($val) && isset($val->$key))
        {
            $tbr [] = $val->$key;
        }
    }

    return $tbr;    
} 
```

然后你可以称之为：

```
$thingsIActuallyWant = pluck($associativeList, 'id'); 
```

此外，除非需要，否则应避免通过引用 foreach 循环来传递变量。

# git - 将 SVN 存储库的一部分导入现有的 Git 存储库

> ID：14446738
> 
> 赞同：9
> 
> 时间：2013-01-21T20:32:46.090
> 
> 标签：git, svn, version-control, git-svn, svn2git

我有一个现有的 SVN 存储库，我想将其中的一部分与历史记录导入现有的 Git 存储库。谁能给我一个关于执行此操作所需命令的高级概述？

概括：

*   我想移动现有 SVN 存储库中的一些子目录（但不是其余的存储库）
*   我有一个现有的 Git 存储库，我想将这些目录导入
*   我想只保留我移动的子目录的历史（但不是其他任何东西）

我有一种感觉，这涉及到`git filter-branch`一些奇怪的合并。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-21T22:23:37.910

事实证明这很复杂，但这就是我所做的。

1.  首先准备 SVN 存储库。之后我打算从 SVN 中删除文件，因此将所有文件放在一个目录中很有帮助（这也使`filter-branch`以后更容易。）

2.  使用 git: 签出 SVN 存储库`git svn clone http://path/to/svnrepo`。这将创建 svn 存储库的 git 版本。

3.  使用此 SO 帖子中的想法，[将子目录分离（移动）到单独的 Git 存储库](https://stackoverflow.com/questions/359424/detach-subdirectory-into-separate-git-repository)中，我使用`filter-branch --subdirectory-filter`来过滤我想要的目录，并从 SVN 中删除我不想保留在 git 中的其他内容的历史记录。您还可以使用`git subtree`一个新功能，如[如何提取 git 子目录并从中制作子模块？](https://stackoverflow.com/questions/920165/howto-extract-a-git-subdirectory-and-make-a-submodule-out-of-it/1307969#1307969)

4.  然后，使用这篇 SO 帖子中的想法，[如何合并两个 Git 存储库？](https://stackoverflow.com/questions/1425892/how-do-you-merge-two-git-repositories)，我将新的 git repo 导入到我想要添加到的父项目中。接受的答案不正确，请查看该页面上的其他答案；你想做 a`git remote add git-proj <path>`后跟 a `git pull`。

5.  最后，将更改推送到 git 项目。

# asp.net - 特定的 ASP.NET 页面丢失了一个（并且只有一个？）会话变量

> ID：14446739
> 
> 赞同：1
> 
> 时间：2013-01-21T20:32:46.743
> 
> 标签：asp.net, session, postback, webforms

我维护一个小型金融网站。该网站的一部分允许某些用户执行银行账户对账，清算已输入并显示在银行对帐单上的行。这个特定的页面让我有些头疼，因为，似乎是随机的，当用户提交核对数据，甚至只是更改他们正在使用的帐户和日期时，该站点将丢失他们正在使用的 ClientId。这充其量只是有点烦人。最坏的情况是浪费了大量时间，因为他们刚刚检查过的所有线路都必须重新检查。

ClientId是保存在Session里面的，所以我第一个想到的就是Session丢失了或者Application被回收了。但是，只有 ClientId Session 变量（存储为“ActiveClient”）丢失；PortalId 之类的其他内容仍然存在（这实际上用于从网站上的严重错误中恢复），所以这不是问题。然后我想是因为该页面在回发时提交了太多数据（我不得不`MaxHttpCollectionKeys`为这个页面提高两次，现在是 5000，尽管我最近更改了数据传递方式以将键数量减少一半）。但是，这也不是问题，因为我收到的错误报告还包括只有几十个密钥的提交，或者当他们更改正在使用的日期/帐户时只有少数几个。

它发生在不同的时间，它不会每次都发生（作为页面提交的百分比，我会说它大约是 5-10%），并且唯一似乎在所有错误中保持不变的是它们'来自 FireFox 和 Chrome，而不是 Internet Explorer。但是，我们的办公室主要使用这两种方法。*仅当员工遇到必须*使用它的站点时才使用 IE 。我已经让我的一位同事尝试切换到 IE，但与此同时我仍在尝试找出其他线索。

该页面设置有两个 ListView，一个用于 Credits，一个用于 Debits。它们为金融系统中的每个交易明细行显示一行，其中列出了有关交易的简要信息，并为用户提供了将其标记为已清除的选项（或者，如果调用以前的对帐单，则将其标记为未清除）。

```
<ItemTemplate>
    <tr class='<%# UseFutureDateClass(Eval("TrxDate")) %> <%# Container.DisplayIndex  % 2 == 1 ? "alt" : "" %>'>
        <td>
            <asp:CheckBox ID="ClearLine" runat="server" Checked='<%# IsCleared(Eval("DateCleared")) %>' />
            <asp:HiddenField ID="IdentSet" runat="server" Value='<%# Eval("NRecord") + "," + Eval("LineNo") + "," + IsCleared(Eval("DateCleared")) %>' />
        </td>
        <td><asp:Label ID="TrxDateLabel" runat="server" Text='<%# Eval("TrxDate","{0:MM/dd/yyyy}") %>' /></td>
        <td><asp:Label ID="HeaderReference" runat="server" Text='<%# Eval("HeaderReference") %>' /></td>
        <td><asp:Label ID="VendorInfoLabel" runat="server" Text='<%# Eval("VendorInfo.VendorName") %>' /></td>
        <td><asp:Label ID="Label2" runat="server" Text='<%# Eval("Description") %>' /></td>
        <td class="money">
            <asp:Label ID="Amount" runat="server" Text='<%# FormatInvertMoney(Eval("Amount")) %>' />
        </td>
    </tr>
</ItemTemplate> 
```

首先`<td>`包含在表单提交上为每一行发布的信息。提交后，页面将解析 IdentSet 并仅在该行之前已清除而现在未清除时才采取行动，反之亦然。从那里它将更新财务文件以将该行标记为已清除或未清除；如果所有更新均成功，则将帐户标记为已在给定日期对给定日期相关期间进行对帐。

如果有人认为会有帮助，我可以发布更多代码；但是，正如我之前所说，当用户只是更改帐户和日期时也会发生此问题，因此我认为问题不在于代码本身。作为参考，下面是 ActiveClient 属性的代码，在名为“Working”的静态类中维护：

```
public static String ActiveClient {
    get {
        String s = (String)HttpContext.Current.Session["ActiveClient"];
        return s ?? String.Empty;
    }
    set { HttpContext.Current.Session["ActiveClient"] = value; }
} 
```

**tl; dr：一个，只有一个，页面有时会丢失一个，并且（显然）只有一个，提交时的会话变量，我不知道为什么或如何停止它。**

# python - 使用日期时间索引提高大熊猫 read_csv 的速度

> ID：14446744
> 
> 赞同：8
> 
> 时间：2013-01-21T20:33:03.863
> 
> 标签：python, performance, pandas, date-formatting

我有很多看起来像这样的文件：

05/31/2012,15:30:00.029,130​​6.25,1,E,0,,1306.25

05/31/2012,15:30:00.029,130​​6.25,8,E,0,,1306.25

我可以使用以下内容轻松阅读它们：

```
 pd.read_csv(gzip.open("myfile.gz"), header=None,names=
  ["date","time","price","size","type","zero","empty","last"], parse_dates=[[0,1]]) 
```

有没有办法有效地将这样的日期解析为熊猫时间戳？如果没有，是否有编写可以传递给 date_parser= 的 cython 函数的指南？

我尝试编写自己的解析器函数，但我正在从事的项目仍然需要很长时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T13:32:17.430

我使用以下 cython 代码获得了令人难以置信的加速（50X）：

从 python 调用：timestamps = convert_date_cython(df["date"].values, df["time"].values)

```
cimport numpy as np
import pandas as pd
import datetime
import numpy as np
def convert_date_cython(np.ndarray date_vec, np.ndarray time_vec):
    cdef int i
    cdef int N = len(date_vec)
    cdef out_ar = np.empty(N, dtype=np.object)
    date = None
    for i in range(N):
        if date is None or date_vec[i] != date_vec[i - 1]:
            dt_ar = map(int, date_vec[i].split("/"))
            date = datetime.date(dt_ar[2], dt_ar[0], dt_ar[1])
        time_ar = map(int, time_vec[i].split(".")[0].split(":"))
        time = datetime.time(time_ar[0], time_ar[1], time_ar[2])
        out_ar[i] = pd.Timestamp(datetime.datetime.combine(date, time))
    return out_ar 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-11T10:24:57.663

[Michael WS](https://stackoverflow.com/a/15812787/2447082)先前解决方案的改进：

*   转换`pandas.Timestamp`为更好地在 Cython 代码之外执行
*   `atoi`并且处理 native-c 字符串比 python funcs 快一点
*   `datetime`-lib 调用的数量从 2 减少到 1（+1 偶尔为日期）
*   微秒也被处理

注意！此代码中的日期顺序为日/月/年。

总而言之，代码似乎比原始代码快了大约 10 倍`convert_date_cython`。但是，如果这之后`read_csv`在 SSD 硬盘驱动器上调用，则由于读取开销，总时间只有几个百分点。我猜想在普通硬盘上差异会更小。

```
cimport numpy as np
import datetime
import numpy as np
import pandas as pd
from libc.stdlib cimport atoi, malloc, free 
from libc.string cimport strcpy

### Modified code from Michael WS:
### https://stackoverflow.com/a/15812787/2447082

def convert_date_fast(np.ndarray date_vec, np.ndarray time_vec):
    cdef int i, d_year, d_month, d_day, t_hour, t_min, t_sec, t_ms
    cdef int N = len(date_vec)
    cdef np.ndarray out_ar = np.empty(N, dtype=np.object)  
    cdef bytes prev_date = <bytes> 'xx/xx/xxxx'
    cdef char *date_str = <char *> malloc(20)
    cdef char *time_str = <char *> malloc(20)

    for i in range(N):
        if date_vec[i] != prev_date:
            prev_date = date_vec[i] 
            strcpy(date_str, prev_date) ### xx/xx/xxxx
            date_str[2] = 0 
            date_str[5] = 0 
            d_year = atoi(date_str+6)
            d_month = atoi(date_str+3)
            d_day = atoi(date_str)

        strcpy(time_str, time_vec[i])   ### xx:xx:xx:xxxxxx
        time_str[2] = 0
        time_str[5] = 0
        time_str[8] = 0
        t_hour = atoi(time_str)
        t_min = atoi(time_str+3)
        t_sec = atoi(time_str+6)
        t_ms = atoi(time_str+9)

        out_ar[i] = datetime.datetime(d_year, d_month, d_day, t_hour, t_min, t_sec, t_ms)
    free(date_str)
    free(time_str)
    return pd.to_datetime(out_ar) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-08T06:41:07.753

日期时间字符串的基数并不大。例如，格式中的时间字符串数`%H-%M-%S`为`24 * 60 * 60 = 86400`. 如果您的数据集的行数远大于此，或者您的数据包含大量重复的时间戳，则在解析过程中添加缓存可以大大加快速度。

对于那些没有 Cython 可用的人，这里有一个纯 python 的替代解决方案：

```
import numpy as np
import pandas as pd
from datetime import datetime

def parse_datetime(dt_array, cache=None):
    if cache is None:
        cache = {}
    date_time = np.empty(dt_array.shape[0], dtype=object)
    for i, (d_str, t_str) in enumerate(dt_array):
        try:
            year, month, day = cache[d_str]
        except KeyError:
            year, month, day = [int(item) for item in d_str[:10].split('-')]
            cache[d_str] = year, month, day
        try:
            hour, minute, sec = cache[t_str]
        except KeyError:
            hour, minute, sec = [int(item) for item in t_str.split(':')]
            cache[t_str] = hour, minute, sec
        date_time[i] = datetime(year, month, day, hour, minute, sec)
    return pd.to_datetime(date_time)

def read_csv(filename, cache=None):
    df = pd.read_csv(filename)
    df['date_time'] = parse_datetime(df.loc[:, ['date', 'time']].values, cache=cache)
    return df.set_index('date_time') 
```

使用以下特定数据集，加速比为 150 倍以上：

```
$ ls -lh test.csv
-rw-r--r--  1 blurrcat  blurrcat   1.2M Apr  8 12:06 test.csv
$ head -n 4 data/test.csv
user_id,provider,date,time,steps
5480312b6684e015fc2b12bc,fitbit,2014-11-02 00:00:00,17:47:00,25
5480312b6684e015fc2b12bc,fitbit,2014-11-02 00:00:00,17:09:00,4
5480312b6684e015fc2b12bc,fitbit,2014-11-02 00:00:00,19:10:00,67 
```

在 ipython 中：

```
In [1]: %timeit pd.read_csv('test.csv', parse_dates=[['date', 'time']])
1 loops, best of 3: 10.3 s per loop
In [2]: %timeit read_csv('test.csv', cache={})
1 loops, best of 3: 62.6 ms per loop 
```

要限制内存使用，只需将 dict 缓存替换为 LRU 之类的东西。

# php - phpmysql在同一个表中查找具有相同数据的多行

> ID：14446745
> 
> 赞同：0
> 
> 时间：2013-01-21T20:33:04.940
> 
> 标签：php, mysql

嗨，我一直在寻找这几天，但似乎无法正确解决，希望有人能够伸出援助之手。这是场景：

技术信息表

```
repid fname lname region
1234  bob   smith  NY
4567  bob   sacamano toronto
3478  bob   hill   texas
9876  bob   underwood vancouver
7345  tom   tucker  halifax
2357  bill  shatner  LA 
```

我正在尝试根据输入字段查找所有的鲍勃，寻找 repid、名字、姓氏等......

基本上，如果 somone 将 bob 类型输入到表单中，它应该返回所有 bob 的所有信息。

我完全坚持这一点。

我已经到了确定是否有鲍勃记录并且可以拉一个的地步，但我不能拉多个。

例如，这里有一些代码片段。非常感谢任何帮助。

```
$MetaQuery="SELECT * FROM `techinfo` WHERE repid='$_POST[repid]' OR fname='$_POST[fname]'";
$MetaResults=mysql_query($MetaQuery, $DBconnect);
if(mysql_num_rows($MetaResults)>0)
{   
/*
quick check of array storage
*/
 echo "<br>we found results:".$row['repid']. $row['fname']. $row['lname'];
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:38:18.280

1) mysql_ 函数被废弃使用 PDO

2）请了解sql注入

3 mysql_query 返回一个必须循环的资源，例如。

```
while($row = mysql_fetch_assoc($MetaResults) {
    echo "<br>we found results:".$row['repid']. $row['fname']. $row['lname'];
} 
```

# javascript - 如何从网站获取 javascript 代码，检查我在表单上的输入？

> ID：14446749
> 
> 赞同：0
> 
> 时间：2013-01-21T20:33:27.570
> 
> 标签：javascript, html, http, web, firebug

我正在编写一个简单的程序，它获取一些用户输入，然后将此输入放入数据库，然后另一个程序读取该数据并尝试将其发送到另一个站点。问题是，这个站点有一个表单验证，所以我需要我的用户输入与目标站点上的验证完全相同。

所以现在，我的问题是，当我尝试发送无效数据时，如何轻松检查在该站点上触发了哪些 javascript 代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:40:43.463

在 Chrome 上，使用 Web 开发人员工具，我会查看输入元素是否具有用于使用 javascript 获取该元素的 ID 或类。

然后在源选项卡中，我将按 ctrl+f（对于 mac 为 cmd+f），然后搜索输入的类或 ID，这将突出显示包含该特定类或 ID 的任何 JS 或 CSS 行。这样，您可以找到为输入完成的任何绑定，例如按键或提交表单后的至少某种验证。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:47:28.733

正如 Sajjan 所说，我假设您会将这些数据发布到他们的服务器，因为实际上通过他们的客户端界面向他们发送数据是没有意义的。

在这种情况下，您所能做的就是将测试数据发送到他们的服务器，以查看服务器的反应。发送空字符串、NULL 值、包含数百个字符的字符串、包含一大堆奇怪字符的字符串等。尽可能地破坏他们的系统。希望这可以帮助您对他们的验证逻辑有所了解。

# inno-setup - 在已安装应用程序的情况下运行 inno setup 时卸载

> ID：14446755
> 
> 赞同：7
> 
> 时间：2013-01-21T20:34:15.997
> 
> 标签：inno-setup

我刚刚开始使用 inno setup，它似乎运行良好。但是，当我在已安装应用程序的情况下运行安装程序时，它会重新安装。我想给用户卸载。这可能吗？如果可以，怎么做？

具体来说，我为家庭作业编写了一个游戏。我使用 inno setup 做了一个安装程序。该应用程序安装良好，可以使用控制面板卸载，但我的教授希望能够通过重新运行安装程序并选择卸载选项来卸载该应用程序。这将节省他的时间，因为他有大约 50 个这样的作业要标记。

谢谢，

格里

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-22T02:27:24.433

当应用程序已经安装在目标系统上时，下一个脚本将生成以下选项表单：

![在此处输入图像描述](../Images/a7390a595cba404ea328730de88173cc.png)

当用户单击`Repair`按钮时，通常会启动设置。当用户单击该`Uninstall`按钮时，先前安装的应用程序将被卸载。当用户关闭该表单时，什么也没有发生。

这是脚本（不要忘记在[`AppId`](http://jrsoftware.org/ishelp/topic_setup_appid.htm)脚本中为 setup 指令指定一些唯一的值）：

```
[Setup]
AppName=My Program
AppVersion=1.5
AppId=1C9FAC66-219F-445B-8863-20DEAF8BB5CC
DefaultDirName={pf}\My Program
OutputDir=userdocs:Inno Setup Examples Output

[CustomMessages]
OptionsFormCaption=Setup options...
RepairButtonCaption=Repair
UninstallButtonCaption=Uninstall

[Code]
const
  mrRepair = 100;
  mrUninstall = 101;

function ShowOptionsForm: TModalResult;
var
  OptionsForm: TSetupForm;
  RepairButton: TNewButton;
  UninstallButton: TNewButton;
begin
  Result := mrNone;
  OptionsForm := CreateCustomForm;
  try
    OptionsForm.Width := 220;
    OptionsForm.Caption := ExpandConstant('{cm:OptionsFormCaption}');
    OptionsForm.Position := poScreenCenter;

    RepairButton := TNewButton.Create(OptionsForm);
    RepairButton.Parent := OptionsForm;
    RepairButton.Left := 8;
    RepairButton.Top := 8;
    RepairButton.Width := OptionsForm.ClientWidth - 16;
    RepairButton.Caption := ExpandConstant('{cm:RepairButtonCaption}');
    RepairButton.ModalResult := mrRepair;

    UninstallButton := TNewButton.Create(OptionsForm);
    UninstallButton.Parent := OptionsForm;
    UninstallButton.Left := 8;
    UninstallButton.Top := RepairButton.Top + RepairButton.Height + 8;
    UninstallButton.Width := OptionsForm.ClientWidth - 16;
    UninstallButton.Caption := ExpandConstant('{cm:UninstallButtonCaption}');
    UninstallButton.ModalResult := mrUninstall;

    OptionsForm.ClientHeight := RepairButton.Height + UninstallButton.Height + 24;
    Result := OptionsForm.ShowModal;
  finally
    OptionsForm.Free;
  end;
end;

function GetUninstallerPath: string;
var
  RegKey: string;
begin
  Result := '';
  RegKey := Format('%s\%s_is1', ['Software\Microsoft\Windows\CurrentVersion\Uninstall', 
    '{#emit SetupSetting("AppId")}']);
  if not RegQueryStringValue(HKEY_LOCAL_MACHINE, RegKey, 'UninstallString', Result) then
    RegQueryStringValue(HKEY_CURRENT_USER, RegKey, 'UninstallString', Result);
end;

function InitializeSetup: Boolean;
var
  UninstPath: string;
  ResultCode: Integer;  
begin
  Result := True;
  UninstPath := RemoveQuotes(GetUninstallerPath);
  if UninstPath <> '' then
  begin
    case ShowOptionsForm of
      mrRepair: Result := True;
      mrUninstall: 
      begin
        Result := False;
        if not Exec(UninstPath, '', '', SW_SHOW, ewNoWait, ResultCode) then
          MsgBox(FmtMessage(SetupMessage(msgUninstallOpenError), [UninstPath]), mbError, MB_OK);
      end;
    else
      Result := False;
    end;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-28T12:29:32.060

出于某种原因，您的代码

```
RegKey := Format('%s\%s_is1', ['Software\Microsoft\Windows\CurrentVersion\Uninstall', 
    '{#emit SetupSetting("AppId")}']); 
```

返回一个额外的 { 到 _is1 值。我没有时间检查执行过程中出现错误的原因或位置，我只确认我的安装程序与

```
RegKey := ExpandConstant('Software\Microsoft\Windows\CurrentVersion\Uninstall\{#emit SetupSetting("AppId")}_is1'); 
```

备用。

希望能帮助到你。

感谢您提供代码示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T20:58:48.263

使用 Inno Setup 时，没有理由卸载以前的版本，除非该版本是由不同的安装程序安装的。否则会自动处理升级。

你的答案在这里：

[InnoSetup：如何自动卸载以前安装的版本？](https://stackoverflow.com/questions/2000296/innosetup-how-to-automatically-uninstall-) 以前安装的版本

# css - CSS 内容属性如何工作？

> ID：14446756
> 
> 赞同：6
> 
> 时间：2013-01-21T20:34:16.173
> 
> 标签：css

有人可以解释该`content`属性在浏览器内部是如何工作的吗？它是否会在 DOM 中创建一个新节点，即使它没有显示在 webInspector 中。它会像真正的 DOM 节点一样对内存消耗产生同样的影响吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:38:28.240

我在[CSS 2.1 规范中找到了这个](http://www.w3.org/TR/CSS21/generate.html#content)

> 生成的内容不会改变文档树。特别是，它不会被反馈给文档语言处理器（例如，用于重新解析）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:37:49.940

来自**[W3C](http://www.w3.org/TR/CSS21/generate.html#propdef-content)**：

> 此属性（内容）与 :before 和 :after 伪元素一起用于在文档中生成内容。**生成的内容不会改变文档树。特别是，它不会被反馈给文档语言处理器（例如，用于重新解析）。**

此外，根据**[MDN](https://developer.mozilla.org/en-US/docs/CSS/content)**：

> 使用 content 属性插入的对象是匿名替换元素。在 CSS 中，被替换元素是其表示超出 CSS 范围的元素。这些是一种外部对象，其表示独立于 CSS。典型的替换元素是`<image>`,或形成元素 `<object>`，如, 。某些元素，例如或仅在特定情况下被替换元素。使用 CSS 内容属性插入的对象是匿名替换元素。CSS 在某些情况下专门处理替换元素，例如在计算边距和一些自动值时。请注意，某些被替换的元素（但不是全部）具有固有尺寸或定义的基线，这些被一些 CSS 属性（如垂直对齐）使用。`<video>``<textarea>``<input>``<audio>``<canvas>`

# ruby-on-rails - 无法按 averageViewDuration 获得观看次数 — YouTube Analytics API

> ID：14446758
> 
> 赞同：0
> 
> 时间：2013-01-21T20:34:33.430
> 
> 标签：ruby-on-rails, ruby, youtube-api, analytics

因此，我在 Rails 中使用了“google-api-client”gem，并尝试调用下面的 URL，以便按平均视图持续时间获取视频视图。[从“可用报告”](https://developers.google.com/youtube/analytics/v1/available_reports%20Available%20Reports)文档页面看来，这是一个允许的调用。

此外，我发现我可以使用 Google 提供的 API Explorer 工具进行此调用。

网址：

[https://www.googleapis.com/youtube/analytics/v1beta1/reports?metrics=averageViewDuration&ids=channel==CHANNEL_ID&dimensions=day&filter=video==VIDEO_ID&start-date=2013-01-15&end-date=2013-01-16&start-时间=1970-01-01](https://www.googleapis.com/youtube/analytics/v1beta1/reports?metrics=averageViewDuration&ids=channel==CHANNEL_ID&dimensions=day&filter=video==VIDEO_ID&start-date=2013-01-15&end-date=2013-01-16&start-time=1970-01-01)

结果：

```
{
  :error=>
    {
      "errors"=>[
        {
          "domain"=>"global",
          "reason"=>"invalid",
          "message"=>"Unknown identifier (averageViewDuration) given in field parameters.metrics."
        }
      ],
      "code"=>400,
      "message"=>"Unknown identifier (averageViewDuration) given in field parameters.metrics."
    }
} 
```

我不确定我可以在这个错误的初始描述中提供哪些额外数据，但如前所述，我使用 Google::APIClient Ruby 库调用 API。实际代码本身如下所示：

```
client.execute(
  :api_method => api.reports.query,
  :parameters => options
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T01:08:15.490

`v1`你可以用版本而不是再试一次`v1beta1`吗？

此外，您`start-time`的请求 URL 末尾有一个参数，这不是一个有效的参数。

我只是对这些更改进行了类似的查询，尝试一下，它可以工作。

# c# - Linq 从未在 XDocument 中找到元素

> ID：14446759
> 
> 赞同：2
> 
> 时间：2013-01-21T20:34:42.780
> 
> 标签：c#, xml, linq-to-xml

我有以下`XDocument`调用`XDoc`：

```
<?xml version="1.0" encoding="utf-8"?>
   <DatabaseList>
      <Database DatabaseName="c2501_data">
      <Plugin PluginName="FooPlugin" LastRun="1/21/2013 3:22:08 PM" />
      <Plugin PluginName="SpecialPlugin" LastRun="2013-01-21T15:22:09.3791103-05:00" />
      <Plugin PluginName="BarPlugin" LastRun="2013-01-21T15:23:13.0964814-05:00" />
   </Database>
</DatabaseList> 
```

我正在编写一个程序，该程序搜索以查看上次在数据库上运行插件的时间（如果有的话）。我使用以下两段代码来确定数据库上的插件是否存在条目：

```
 var h = (from el in XDoc.Root.Elements("Database")
                 where el.Element("Plugin").Attribute("PluginName").Value=="FooPlugin" 
                 && el.Attribute("DatabaseName").Value=="c2501_data"
                 select el.Element("Plugin"));

        var e = (from el in XDoc.Root.Elements("Database")
                 where el.Element("Plugin").Attribute("PluginName").Value=="BarPlugin"
                 && el.Attribute("DatabaseName").Value == "c2501_data"
                 select el.Element("Plugin"));

        if ((from el in XDoc.Root.Elements("Database")
             where el.Element("Plugin").Attribute("PluginName").Value == "BarPlugin"
             && el.Attribute("DatabaseName").Value == "c2501_data"
             select el.Element("Plugin")).Count() == 0)
        {
            XElement SpecialPlugin = new XElement("Plugin",
                new XAttribute("PluginName", "BarPlugin"),
                new XAttribute("LastRun", DateTime.Now));

            var CurNode = from node in XDoc.Root.Elements("Database")
                          where (string)node.Attribute("DatabaseName").Value == "c2501_data"
                          select node;

            foreach (var node in CurNode)
                node.Add(SpecialPlugin);

            XDoc.Save(RuntimesPath);
            //XDoc.Root.Elements("Database").Attribute("DatabaseName").
        } 
```

我遇到的问题是，即使显然有一个条目`BarPlugin`，计数将始终返回 0，并且`e`始终无法创建可编号。谁能向我解释为什么会这样？`FooPlugin`始终正常工作并返回`h`.

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:41:57.483

您正在选择一个`Database`元素，其中包含一个`Plugin`以给定名称调用的子元素。由于您只有一个`Database`元素，因此每次都会获得相同的外部元素。然后，您获取该数据库元素并返回第一`Plugin`个子元素，在这种情况下，它将始终是 Foo。您需要找到适当的`Database`元素，然后查询每个子元素，以便您可以返回它们：

```
public static XElement GetPlugin(XDocument XDoc, string databaseName, string pluginName)
{
    var h = from database in XDoc.Root.Elements("Database")
            where database.Attribute("DatabaseName").Value == databaseName
            from plugin in database.Elements("Plugin")
            where plugin.Attribute("PluginName").Value == pluginName
            select plugin;

    return h.FirstOrDefault();
} 
```

或者，如果您愿意，在方法语法中：

```
var q = XDoc.Root.Elements("Database")
    .Where(db => db.Attribute("DatabaseName").Value == databaseName)
    .SelectMany(db => db.Elements("Plugin"))
    .Where(plugin => plugin.Attribute("PluginName").Value == pluginName);

return q.FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:47:55.150

试试这个：

```
var db = XDoc.Root.Elements("Database");
var z = (from el in db.Elements("Plugin")
        where el.Attribute("PluginName").Value == "BarPlugin"
              && el.Parent.Attribute("DatabaseName").Value == "c2501_data"
              select el).FirstOrDefault();
if(z != null)
    ..... 
```

*我正在使用`Elements()`方法来获取所有子元素和`Parent`属性以查找父元素 "DatabaseName"*。

您的代码中的问题是您`el.Element()`只搜索第一个元素，因此它只能找到“FooPlugin”，它位于 xml 的第一个位置。

来自 MSDN 文档`Element()`：

> 获取具有指定 XName 的第一个（按文档顺序）子元素。

# cuda - Nsight 调试器不去设备功能

> ID：14446761
> 
> 赞同：1
> 
> 时间：2013-01-21T20:34:49.947
> 
> 标签：cuda, nsight, optimus

我有一个带有擎天柱技术的笔记本。显卡。所以，我在我的 ubuntu 12.10（64 位）上安装了 Bumblebee。我已经安装了 CUDA 5，它使用“optirun”运行。但是我在 Nsight (eclipse) 中调试时遇到问题；我可以调试主机代码，但它会跳过设备的功能！

我看过一些相关的帖子，但我的问题还没有解决。我试图用“optirun”运行 Nsight；并且还在 gdb 之前添加了 optirun。

请帮我。

谢谢

# asp.net - 更新和编译 AjaxToolkit 源

> ID：14446762
> 
> 赞同：0
> 
> 时间：2013-01-21T20:34:50.600
> 
> 标签：asp.net, webforms

我在我的网站上遇到了以下问题：http:
[//ajaxcontroltoolkit.codeplex.com/workitem/26978](http://ajaxcontroltoolkit.codeplex.com/workitem/26978)

该解决方案说进入源代码，进行更改并重新编译。当我从这里下载[http://ajaxcontroltoolkit.codeplex.com/](http://ajaxcontroltoolkit.codeplex.com/)时，我所看到的没有源代码，只有一个 DLL。

我也尝试通过 NuGet 下载和重新编译，但问题仍然存在。

我能做些什么来解决这个问题（如第一个链接中所述）？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:45:25.243

选择 codeplex 上的“源代码”选项卡，然后单击工具栏中的“下载”按钮。

# ruby-on-rails-3 - 自定义 ransacker 返回错误 - []:ActiveRecord::Relation 的未定义方法 `gsub'

> ID：14446765
> 
> 赞同：1
> 
> 时间：2013-01-21T20:35:07.373
> 
> 标签：ruby-on-rails-3, arel, ransack

我在我的 Rails 3.2.11 应用程序中使用 Ransack 并且喜欢它。我目前正在搜索与给定高中匹配的个人资料，如下所示：

```
<%= f.check_box :profile_high_school_cont, {}, "#{current_user.profile.high_school}", '' %> 
```

但是，我想为此添加一些额外的逻辑，并进一步将搜索细化为个人资料，以允许其他用户通过他们的高中找到他们。

所以我想知道除了个人资料的 :high_school 是否包含某些文本之外，是否还有一种方法可以检查个人资料的 :show_high_school 是否为真。

在四处逛逛（特别是[这里](https://github.com/ernie/ransack/issues/36)和[这里](https://stackoverflow.com/questions/10969678/howto-set-a-default-condition-with-fieldname-on-ransack)）之后，我尝试了以下自定义 ransacker：

```
ransacker :by_high_school,
  :formatter => proc {
    |high_school| Profile.where(:high_school => high_school, :show_high_school => true)
  } do |parent|
    parent.table[:user]
  end 
```

我将它添加到了拥有一个配置文件的用户模型和属于用户的配置文件模型。在每种情况下，我都会收到一个错误：

```
undefined method `gsub' for []:ActiveRecord::Relation 
```

在 Profile.rb 中定义时，我收到以下错误：

```
User.search(:profile_by_high_school_cont => "Cent").result 
```

我的数据库是 PostgreSQL

# ruby - 使用 Net::FTPTLS 连接到服务器证书不匹配的 FTPS 服务器

> ID：14446769
> 
> 赞同：0
> 
> 时间：2013-01-21T20:35:31.870
> 
> 标签：ruby, openssl, ftps

我正在尝试通过 Net::FTPTLS 连接到基于 Microsoft 的文件服务器 (IIS)，该文件服务器配置为在端口 22 上使用 FTP 并需要 SSL。

我通过以下方式连接：

```
require 'net/ftptls'
ftp = Net::FTPTLS.new()
ftp.connect('host.com', port_number)
ftp.login('Username', 'Password')
ftp.puttextfile('somefile.txt', 'where/to/save/somefile.txt')
ftp.close 
```

问题是，我收到以下错误：

```
hostname does not match the server certificate 
```

看来我必须禁用 openssl 对等验证：OpenSSL::SSL::VERIFY_PEER 应该变为 OpenSSL::SSL::VERIFY_NONE。

关于如何对 Net::FTPTLS 类进行猴子补丁的任何想法？有没有人成功做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-01-23T14:46:04.073

而不是使用 Net::FTPTLS，而是使用带有以下代码的 Ruby 2.4+：

```
require 'net/ftp'
ftp = Net::FTP.new(nil, ssl: {:verify_mode => OpenSSL::SSL::VERIFY_NONE})
ftp.connect('host.com', port_number)
ftp.login('Username', 'Password')
ftp.puttextfile('somefile.txt', 'where/to/save/somefile.txt')
ftp.close 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T17:40:15.583

我所做的，而不是monkeypatching ruby​​ 本身，是将它的副本带入我的项目的/lib 中。

```
module Net

  class FTPTLS < FTP
    def connect(host, port=FTP_PORT)
      @hostname = host
      super
    end

    def login(user = "anonymous", params = {:password => nil, :acct => nil, :ignore_cert => false})
      store = OpenSSL::X509::Store.new
      store.set_default_paths
      ctx = OpenSSL::SSL::SSLContext.new('SSLv23')
      ctx.cert_store = store
      ctx.verify_mode = params[:ignore_cert] ? OpenSSL::SSL::VERIFY_NONE : OpenSSL::SSL::VERIFY_PEER
      ctx.key = nil
      ctx.cert = nil
      voidcmd("AUTH TLS")
      @sock = OpenSSL::SSL::SSLSocket.new(@sock, ctx)
      @sock.connect
      @sock.post_connection_check(@hostname) unless params[:ignore_cert]
      super(user, params[:password], params[:acct])
      voidcmd("PBSZ 0")
    end
  end
end 
```

我还清理了传递的参数。你会这样使用它：

```
 require 'ftptls'  # Use my local version, not net/ftptls
  @ftp_connection = Net::FTPTLS.new()
  @ftp_connection.passive = true
  @ftp_connection.connect(host, 21)
  @ftp_connection.login('user', :password => 'pass', :ignore_cert => true) 
```

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-08T12:26:57.063

这对我来说很好。#ROR

```
ftp = Net::FTP.new("ftps.host.com", ftp_options)

open("where/is/your/file/somefile.txt") do |file_data|
  ftp.putbinaryfile(file_data, 'where/to/save/somefile.txt')
end

ftp.puttextfile('somefile.txt', 'where/to/save/somefile.txt')

def ftp_options
  {
    port: FTP_PORT,
    username: 'ftp_user',
    password: 'password',
    passive:  true,
    ssl: { verify_mode: 0 }
  }
end 
```

请记住，您必须提供**ftps.hostname.com**。

# json - 在 SharePoint 2010 中反序列化大型 JSON

> ID：14446774
> 
> 赞同：1
> 
> 时间：2013-01-21T20:35:54.063
> 
> 标签：json, parsing, sharepoint, serialization, sharepoint-2010

Json 文件中有大约 5000 个条目。我使用方法`JavaScriptSerializer.Deserialize<T>`（字符串），但出现以下错误：

```
at System.Web.Script.Serialization.JavaScriptObjectDeserializer.ThrowIfMaxJsonDeserializerMembersExceeded(Int32 count)
   at System.Web.Script.Serialization.JavaScriptObjectDeserializer.DeserializeDictionary(Int32 depth)
   at System.Web.Script.Serialization.JavaScriptObjectDeserializer.DeserializeInternal(Int32 depth)
   at System.Web.Script.Serialization.JavaScriptObjectDeserializer.BasicDeserialize(String input, Int32 depthLimit, JavaScriptSerializer serializer)
   at System.Web.Script.Serialization.JavaScriptSerializer.Deserialize(JavaScriptSerializer serializer, String input, Type type, Int32 depthLimit)
   at System.Web.Script.Serialization.JavaScriptSerializer.Deserialize[T](String input)
   at xxx.Internet.Core.Services.xxxService.DeserializeAtms(String xxxJson, List`1& xxxList)
   at xxx.Internet.Jobs.xxxFetcherJob.xxxFetcherJob.Execute(Guid contentDbId) 
```

我试着在 web.config 中写：

```
<appSettings>
   <add key="aspnet:MaxJsonDeserializerMembers" value="150000" />
</appSettings> 
```

但它没有帮助......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T09:37:00.343

SharePoint 计时器作业在 OWSTIMER.exe 进程下运行。这个进程有一个与之关联的配置文件。我们可以使用此配置文件来指定要在自定义计时器作业中使用的配置设置。

打开 OWSTIMER.EXE.CONFIG 并将标签添加到其中。然后在此 appSettings 标记下添加您的键值对。

为此，您必须添加对 System.Configuration 的引用，然后您可以使用 System.Configuration.ConfigurationManager.AppSettings[key] 从配置文件中检索键的值。

示例：字符串部门 = System.Configuration.ConfigurationManager.AppSettings["Department"];

原来的：

[http://doitwithsharepoint.blogspot.ru/2011/03/config-file-for-sharepoint-custom-timer.html?showComment=1358842033678#c8928587895049662169](http://doitwithsharepoint.blogspot.ru/2011/03/config-file-for-sharepoint-custom-timer.html?showComment=1358842033678#c8928587895049662169)

# c# - 在类之间加载 X 位置会给出“字段从未分配给”警告

> ID：14446778
> 
> 赞同：0
> 
> 时间：2013-01-21T20:36:03.017
> 
> 标签：c#, xna, warnings

所以我在 XNA 中创建了一个小游戏，我正处于编写 AI 的阶段。我目前遇到的问题是我无法加载 redNinja（玩家角色）的 X 位置并让 blueNinja（AI）读取它并走向它。

每次我尝试通过 redNinja.Position.X 引用它时，它都会给我`field is never assigned to, and will always have it's default value null.`警告。

```
namespace Ninja_DM
{
class AI
{
    Texture2D blueNinja;
    Ninjas redNinja;
    float timer = 0f;
    float interval = 130f;
    int currentFrame = 0;
    int spriteSpeed = 2;
    int spriteWidth = 32;
    int spriteHeight = 28;
    public Rectangle sourceRect;
    Vector2 position_b;
    Vector2 origin;

    public Vector2 Position
    {
        get { return position_b; }
        set { position_b = value; }
    }

    public Vector2 Origin
    {
        get { return origin; }
        set { origin = value; }
    }

    public Texture2D Texture
    {
        get { return blueNinja; }
        set { blueNinja = value; }
    }

    public Rectangle SourceRect
    {
        get { return sourceRect; }
        set { sourceRect = value; }
    }

    public AI(Texture2D texture, int currentFrame, int spriteWidth, int spriteHeight)
    {
        this.blueNinja = texture;
        this.currentFrame = currentFrame;
        this.spriteWidth = spriteWidth;
        this.spriteHeight = spriteHeight;
    }

    public void AIMovement(GameTime gameTime)
    {
        sourceRect = new Rectangle(30 * currentFrame, 0, 30, 37);

        if (position_b.X > redNinja.Position.X)
        {
            AnimateLeftAI(gameTime);
            if (position_b.X < 20)
            {
                position_b.X += spriteSpeed;
            }
        }

        if (position_b.X < redNinja.Position.X)
        {
            AnimateRightAI(gameTime);
            if (position_b.X < 1100)
            {
                position_b.X += spriteSpeed;
            }
        }

    }

    public void AnimateLeftAI(GameTime gameTime)
    {

        timer += (float)gameTime.ElapsedGameTime.TotalMilliseconds;

        if (timer > interval)
        {
            currentFrame++;

            if (currentFrame > 4)
            {
                currentFrame = 3;
            }
            timer = 0f;
        }
    }

    public void AnimateRightAI(GameTime gameTime)
    {

        timer += (float)gameTime.ElapsedGameTime.TotalMilliseconds;

        if (timer > interval)
        {
            currentFrame++;

            if (currentFrame > 4)
            {
                currentFrame = 3;
            }
            timer = 0f;
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:03:21.177

在调用 AIMovement() 时，您需要将玩家的忍者作为参数，如下所示：

```
public void AIMovement(GameTime gameTime, Ninjas playerNinja)
{
    sourceRect = new Rectangle(30 * currentFrame, 0, 30, 37);

    if (position_b.X > playerNinja.Position.X)
    {
        AnimateLeftAI(gameTime);
        if (position_b.X < 20)
        {
            position_b.X += spriteSpeed;
        }
    }

    if (position_b.X < playerNinja.Position.X)
    {
        AnimateRightAI(gameTime);
        if (position_b.X < 1100)
        {
            position_b.X += spriteSpeed;
        }
    }

} 
```

请注意，您实际上不需要再声明一个已调用的字段变量`redNinja`，因为您将要测试的 Ninjas 作为方法的参数/参数引入。

# asp.net - 使用 asp.net 和 ms-sql 进行统计分析的选项有哪些？

> ID：14446780
> 
> 赞同：0
> 
> 时间：2013-01-21T20:36:06.623
> 
> 标签：asp.net, sql-server, statistics

我想对 aps.net 应用程序的 ms-sql 数据库进行一些统计分析。由于我没有看到很多用于我的目的的内置函数，有哪些选项？感谢您的任何建议。您实际使用的选项将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:21:35.050

查看[MathDotNet](http://www.mathdotnet.com)，它几乎可以做任何你需要的事情。

# c++ - WriteFile 写入不正确

> ID：14446784
> 
> 赞同：0
> 
> 时间：2013-01-21T20:36:38.553
> 
> 标签：c++, winapi

我正在尝试将文件从资源复制到 %localappdata%。我有这样的事情：

```
HINSTANCE hInstance = GetModuleHandle(NULL);
HANDLE hFile = INVALID_HANDLE_VALUE;

HRSRC hrsrc = FindResource(hInstance, MAKEINTRESOURCE(MSIE), RT_RCDATA);
HGLOBAL exeRes = LoadResource(hInstance, hrsrc);

DWORD size = SizeofResource(hInstance, hrsrc);

TCHAR szPath[MAX_PATH];
HANDLE hfile;
if(SUCCEEDED(SHGetFolderPath(NULL, CSIDL_LOCAL_APPDATA|CSIDL_FLAG_CREATE, NULL, 0, szPath))) { 
    PathAppend(szPath, TEXT("test.exe")); 
    hFile = CreateFile(szPath, GENERIC_WRITE, 0, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);
}

LPVOID exePtr = LockResource(hrsrc);
DWORD exeWritten = 0;

BOOL writeResult = WriteFile(hFile, exePtr, size, &exeWritten, NULL);

cout << GetLastError() << endl;

BOOL closed = CloseHandle(hFile);

system("PAUSE");
return 0; 
```

我可以找到 HRSRC 并使用 SizeofResource() 确认大小。CreateFile 实际上是创建文件并返回句柄。GetLastError() 报告没有错误。写入磁盘的字节数完全正确。

然而，输出 exe 已损坏（此文件的版本与 Windows 的版本不兼容......等等） - 它丢失了它的图标和所有内容。[在十六进制编辑器中并排](http://i.imgur.com/AIQ0fBL.png)查看原始文件和输出文件，文件开头似乎有随机数据。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T20:42:03.910

你`LockResource`的不正确。它应该通过`exeRes`您之前加载的 HGLOBAL。

```
LockResource(hrsrc); 
```

应该

```
LockResource(exeRes); 
```

[来自LockResource()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648047%28v=vs.85%29.aspx)的 MS 文档：

> 不要尝试使用 FindResource 或 FindResourceEx 函数返回的句柄来锁定资源。**这样的句柄指向随机数据。**

附带说明一下，您可能想在使用完该加载并锁定的资源后尝试清理它。

# objective-c - 监视沙盒应用程序中的文件夹

> ID：14446787
> 
> 赞同：1
> 
> 时间：2013-01-21T20:37:03.133
> 
> 标签：objective-c, macos, cocoa

我将如何监控用户垃圾箱，以便在添加文件时可以发送操作。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:16:42.060

沙盒应用程序无法访问垃圾箱。出于安全原因，沙盒应用程序被沙盒化，垃圾箱中可能是用户已删除的所有类型的文档，而沙盒应用程序在其以前的目的地永远无法访问这些文档。当然，用户希望这些文件在放入垃圾箱后仍然可以保存。

如果您的应用程序访问垃圾箱确实有意义，例如因为它是一个垃圾管理应用程序（我知道这是一个愚蠢的例子），如果您只要求它，Apple 仍会授予您的应用程序访问垃圾箱的权限。因此，您需要指定*Temporary Exception Entitlement*类型

```
com.apple.security.temporary-exception.files.home-relative-path.read-only 
```

如果只读访问对您来说足够了，或者

```
com.apple.security.temporary-exception.files.home-relative-path.read-write 
```

如果您还需要写权限。这些是权利字典中的键，值是字符串数组，每个字符串指定一个目录。在您的情况下，它们数组将包含`/.Trash`，它转换`/Users/<username>/.Trash`为当前用户。例如：

```
<key>com.apple.security.temporary-exception.files.home-relative-path.read-write</key>
<array>
  <string>/.Trash</string>
</array> 
```

这将允许您的应用程序从其沙箱中部分释放，只要它只访问此目录（或其子目录）。

请注意，Apple 只会批准在[App Store Connect](https://appstoreconnect.apple.com/)网页上列出的特定条件下使用*临时例外权利*之一的应用程序（您必须登录才能看到该页面，并且您需要具有使用 App Store Connect 权限的 Apple ID） .

AFAIK 这些条件包括您**必须向**[Apple 的反馈助手](https://feedbackassistant.apple.com/)提交错误报告（同样，您必须登录网页，但这次允许每个 Apple ID 登录）并且您必须向 Apple 解释为什么您需要此例外，否则您的应用程序将无法执行它应该执行的任何操作。你最好善于解释！如果 Apple 认为您的用例不合法，他们会将这个错误视为无效而关闭，然后您的应用提交将被拒绝。如果错误被认为是有效的，您必须在提交应用程序时告诉 Apple 您的应用程序使用临时授权，并且您必须将 Apple 指向您创建的错误报告。他们会再次阅读，如果商店团队同意开发团队认为这是一个正当理由，他们将允许您的提交通过。

一旦您的应用程序具有适当的权利，您应该能够像非沙盒应用程序那样监控垃圾箱。例如使用[FSEvent API](https://developer.apple.com/documentation/coreservices/file_system_events)。使用该功能`FSEventStreamCreate()`，您可以创建一个`FSEventStreamRef`监视某个路径（在您的情况下为垃圾箱），只要此路径的内容发生更改，就会调用用户定义的回调函数，并且可以在 RunLoop 上安排。一旦安排好，只要目录内容发生变化，就会调用回调函数。在回调函数中，您可以做任何您想做的事情，例如获取更高级别的事件（因为回调函数只是纯 C 语言，所以您可能想要发布可以在 Obj-C 代码中处理的 NSNotification，例如在您的 UI 代码中）或者可能直接调用某个对象的 Obj-C 方法（存储在回调上下文中、全局变量或可作为单例访问等）

# javascript - 使用switch语句在javascript中显示图片

> ID：14446788
> 
> 赞同：0
> 
> 时间：2013-01-21T20:37:07.470
> 
> 标签：javascript, switch-statement

我想让 image1 在星期日可见，image2 在星期一可见，依此类推，使用 Javascript 中的 switch 语句。我该怎么做呢？

```
<!DOCTYPE html>
<html>
<body>

<p>Click the button to display what day it is today.</p>

<button onclick="myFunction()">Try it</button>

<p id="demo"></p>

<script>
function myFunction()
{
    var x;
    var d=new Date().getDay();
    switch (d)
    {
        case 0:
            x="Today it's Sunday";
            break;
        case 1:
            x="Today it's Monday";
            break;
        case 2:
            x="Today it's Tuesday";
            break;
        case 3:
            x="Today it's Wednesday";
            break;
        case 4:
            x="Today it's Thursday";
            break;
    }
    document.getElementById("demo").innerHTML=x;
}
</script>

<img src="image1.png" id="one"style="visibility:Hidden"/>
<img src="image2.png" id="one"style="visibility:Hidden"/>
<img src="image3.png" id="one"style="visibility:Hidden"/>
<img src="image4.png" id="one"style="visibility:Hidden"/>
<img src="image5.png" id="one"style="visibility:Hidden"/>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:42:09.917

您可以拥有一个元素，而不是拥有五个`<img>`元素，然后根据日期值简单地更改其 src。

HTML 标记

```
<img id='dayImage'/> 
```

Javascript

```
var d = new Date().getDay()
var dayImg = document.getElementById('dayImage');
dayImg.src = "image"+d+".png"; 
```

**更新**

如果您仍然需要有五个单独的图像，您将需要一种方法来识别每个图像。就目前而言，您的所有图像都具有相同的`id`属性，因此您首先需要解决此问题。

假设您将标记更改为以下内容：

```
<img src="image1.png" id="dayImg0" style="visibility:hidden"/>
<img src="image2.png" id="dayImg1" style="visibility:hidden"/>
<img src="image2.png" id="dayImg2" style="visibility:hidden"/>
... 
```

然后您可以像这样显示适当的图像

```
var d = new Date().getDay()
var dayImg = document.getElementById('dayImg'+d);
dayImg.style.visibility = "visible"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:48:46.557

*   首先，为您的图像提供不同的 id，例如`zero`, `one`, ...,`four`
*   使用`display:none;`代替`visibility:hidden`，因为 display-none 不保留它所需的空间

看到这个[JSFIDDLE](http://jsfiddle.net/algorhythm/bJXmt/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:49:59.213

我会稍微修改 HTML 页面，如下：

```
<!DOCTYPE html>
<html>
<body>

<p>Click the button to display what day it is today.</p>

<button onclick="myFunction()">Try it</button>

<p id="demo"></p>

<script>
function myFunction()
{
    var x;
    var d=new Date().getDay();
    switch (d)
    {
        case 0:
            x="Today it's Sunday";
            document.getElementById("one").style.display="block";
            break;
        case 1:
            x="Today it's Monday";
            document.getElementById("two").style.display="block";
            break;
        case 2:
            x="Today it's Tuesday";
            document.getElementById("three").style.display="block";
            break;
        case 3:
            x="Today it's Wednesday";
            document.getElementById("four").style.display="block";
            break;
        case 4:
            x="Today it's Thursday";
            document.getElementById("five").style.display="block";
            break;
    }
    document.getElementById("demo").innerHTML=x;
}
</script>

<img src="image1.png" id="one" style="display:none"/>
<img src="image2.png" id="two" style="display:none"/>
<img src="image3.png" id="three" style="display:none"/>
<img src="image4.png" id="four" style="display:none"/>
<img src="image5.png" id="five" style="display:none"/>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T21:02:17.213

由于 JavaScript getDay() 函数在星期日返回 0（请参阅：[http](http://www.w3schools.com/jsref/jsref_getday.asp) ://www.w3schools.com/jsref/jsref_getday.asp ），您不需要弄乱索引，只需使用一个简单的 for 循环，如下所示：

```
<!DOCTYPE html> 
```

```
<body>
    <p>Click the button to display what day it is today.</p>
    <button onclick="myFunction()">Try it</button>
    <p id="demo"></p>
    <script>
        function myFunction() {
            var x;
            var d = new Date().getDay();
            switch (d) {
                case 0:
                    x = "Today it's Sunday";
                    break;
                case 1:
                    x = "Today it's Monday";
                    break;
                case 2:
                    x = "Today it's Tuesday";
                    break;
                case 3:
                    x = "Today it's Wednesday";
                    break;
                case 4:
                    x = "Today it's Thursday";
                    break;
            }
            document.getElementById("demo").innerHTML = x;
            images = document.getElementsByTagName('img')
            for (var i = 0; i < images.length; i++) {
                if (i != d) {
                    images[i].style.visibility = 'Hidden';
                } else {
                    images[i].style.visibility = 'visible';
                }
            }
        }
    </script>
    <img src="image1.png" id="one" style="visibility:Hidden" />
    <img src="image2.png" id="one" style="visibility:Hidden" />
    <img src="image3.png" id="one" style="visibility:Hidden" />
    <img src="image4.png" id="one" style="visibility:Hidden" />
    <img src="image5.png" id="one" style="visibility:Hidden" />
</body> 
```

# c++ - 序列化 JSON 数据 Qt

> ID：14446791
> 
> 赞同：3
> 
> 时间：2013-01-21T20:37:14.777
> 
> 标签：c++, json, qt

我正在使用 Qt 并尝试获取以下内容并将其转换为 JSON 文本，但是当我尝试编译它时，我得到一个符号未找到架构错误。

我目前正在使用内置的 Qt Json 库，因为我不知道如何让 QJson 工作并静态编译到代码中，这样就没有依赖关系。

```
// Create the message body
QVariantMap message;
message.insert("date", QDate::currentDate().toString());
message.insert("eventType", eventName);
message.insert("payload", messagePayload);

// Initialize the Serializer
QJson::Serializer serializer;
bool ok;

// Serialize the data
QByteArray json = serializer.serialize(message, &ok); 
```

编译器输出如下：

```
Undefined symbols for architecture x86_64:
  "QJson::Serializer::serialize(QVariant const&, bool*)", referenced from:
      SWebsocketClient::sendMessage(QString, QMap<QString, QVariant>) in swebsocketclient.o 
```

这种方法是正确的，还是有更好的方法？我知道这个问题已经在其他地方被问过，但是大多数与其他答案相关的文章不再存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:57:33.707

您始终可以使用此 JSON 库：

```
/*
 * qvjson.h
 *
 *  Created on: Apr 23, 2010
 *      Author: drh
 */

#ifndef QVJSON_H_
#define QVJSON_H_
#include <QMap>
#include <QList>
#include <QVariant>
#include <QRegExp>

class QvJson {

public:
    QvJson();
    virtual ~QvJson();

    QVariant parseJson(const QString& jsonString);

    // The jsonObject is a QVariant that may be a --
    // -- QMap<QString, QVariant>
    // -- QList<QVariant>
    // -- QString
    // -- integer
    // -- real number
    // -- bool
    // -- null (implemented as a QVariant() object)
    // Where QVariant appears in the above list, it may recursively 
    // be one of the above.
    QString encodeJson(const QVariant& jsonObject);

private:
    enum Error {
        ErrorUnrecognizedToken,
        ErrorMustBeString,
        ErrorMissingColon,
        ErrorMissingCommaOrClose,
        ErrorNoClosingQuote,
        ErrorEndOfInput,
        ErrorInvalidNumericValue,
        ErrorInvalidHexValue,
        ErrorUnrecognizedObject
    };

    QRegExp mNonBlank;
    QRegExp mFindQuote;

    QString nextToken(const QString& jsonString, int& position);
    QString peekToken(const QString& jsonString, int position);
    QVariant parseInternal(const QString& jsonString, int& position, int nesting);
    QVariant parseObject(const QString& jsonString, int& position, int nesting);
    QVariant parseArray(const QString& jsonString, int& position, int nesting);
    QVariant parseString(const QString& jsonString, int& position, int nesting);
    QVariant parseBool(const QString& jsonString, int& position, int nesting);
    QVariant parseNull(const QString& jsonString, int& position, int nesting);
    QVariant parseNumber(const QString& jsonString, int& position, int nesting);
    QVariant syntaxError(const QString& method, const QString& jsonString, int position, int nesting, Error error);

    QString encodeObject(const QVariant& jsonObject);
    QString encodeArray(const QVariant& jsonObject);
    QString encodeString(const QVariant& jsonObject);
    QString encodeString(const QString& value);
    QString encodeNumeric(const QVariant& jsonObject);
    QString encodeBool(const QVariant& jsonObject);
    QString encodeNull(const QVariant& jsonObject);
    QString encodingError(const QString& method, const QVariant& jsonObject, Error error);
};

#endif /* QVJSON_H_ */

/*
 * qvjson.cpp
 *
 *  Created on: Apr 23, 2010
 *      Author: drh
 */

#include "qvjson.h"
#include <QStringList>
#include <QMessageBox>

QvJson::QvJson() {
    mNonBlank = QRegExp("\\S", Qt::CaseSensitive, QRegExp::RegExp);
    mFindQuote = QRegExp("[^\\\\]\"", Qt::CaseSensitive, QRegExp::RegExp);
}

QvJson::~QvJson()
    {
    // TODO Auto-generated destructor stub
    }

QVariant QvJson::parseJson(const QString& jsonString) {

    int position = 0;
    QVariant result;

    result = parseInternal(jsonString, position, 0);

    if (result.type() == QVariant::StringList) {
        QMessageBox::critical(NULL, "", result.toString());
    }

    QString token(nextToken(jsonString, position));

    if (!token.isEmpty()) {
        QMessageBox::critical(NULL, "", QObject::tr("Invalid JSON string -- remaining token %1 at position %2.").arg(token).arg(position));
    }
    return result;
}

QString QvJson::nextToken(const QString& jsonString, int& position) {
    if (position >= jsonString.count()) {
        return QString();
    }
    while (jsonString.at(position) == ' ') {
        position++;
        if (position >= jsonString.count()) {
            return QString();
        }
    }
    if (jsonString.at(position).isLetter()) {
        if (position + 4 < jsonString.count()) {
            QString word = jsonString.mid(position, 4);
            if ((word == "true") || (word == "null")) {
                position += 4;
                while (position < jsonString.count() && jsonString.at(position) == ' ') {
                    position++;
                }
                return word;
            }
            if ((word == "fals") && (position + 5 < jsonString.count()) && jsonString.at(position + 4) == 'e') {
                position += 5;
                while (position < jsonString.count() && jsonString.at(position) == ' ') {
                    position++;
                }
                return "false";
            }
        }
    }
    QString result = QString(jsonString.at(position));
    position++;
    while (position < jsonString.count() && jsonString.at(position) == ' ') {
        position++;
    }
    return result;
}

// By virtue of its non-& position parm, this method "peeks" at the token without consuming it.
QString QvJson::peekToken(const QString& jsonString, int position) {
    return (nextToken(jsonString, position));
}

QVariant QvJson::parseInternal(const QString& jsonString, int& position, int nesting) {
    QString token(peekToken(jsonString, position));
    QVariant result;
    int startPosition = position;  // For debug
    Q_UNUSED(startPosition);
    if (token.isNull()) {
        result = syntaxError("parseInternal", jsonString, position, nesting + 1, ErrorEndOfInput);
    }
    else if (token == "{") {
        result = parseObject(jsonString, position, nesting + 1);
    }
    else if (token == "[") {
        result = parseArray(jsonString, position, nesting + 1);
    }
    else if (token == "\"") {
        result = parseString(jsonString, position, nesting + 1);
    }
    else if ((token == "true") || (token == "false")) {
        result = parseBool(jsonString, position, nesting + 1);
    }
    else if (token == "null") {
        result = parseNull(jsonString, position, nesting + 1);
    }
    else if ((token == "-") || (token.at(0).isDigit())) {
        result = parseNumber(jsonString, position, nesting + 1);
    }
    else {
        result = syntaxError("parseInternal", jsonString, position, nesting + 1, ErrorUnrecognizedToken);
    }
    return result;
}

QVariant QvJson::parseObject(const QString& jsonString, int& position, int nesting) {
    QMap<QString, QVariant> resultObject;
    QString token;
    int startPosition = position;  // For debug
    Q_UNUSED(startPosition);
    token = nextToken(jsonString, position);
    Q_ASSERT(token == "{");

    // Handle case of empty object
    token = peekToken(jsonString, position);
    if (token == '}') {
        return QVariant(resultObject);
    }

    do {

        // Next item must be a string
        token = peekToken(jsonString, position);
        if (token != "\"") {
            return syntaxError("parseObject", jsonString, position, nesting + 1, ErrorMustBeString);
        }
        QVariant propName;
        propName = parseString(jsonString, position, nesting + 1);
        // Check for error
        if (propName.type() == QVariant::StringList) {
            QStringList propNameError(propName.toStringList());
            propNameError << QObject::tr("in parseObject(%1,%2)").arg(position).arg(nesting);
            return QVariant(propNameError);
        }

        // Expect a ":"
        token = nextToken(jsonString, position);
        if (token != ":") {
            return syntaxError("parseObject", jsonString, position, nesting + 1, ErrorMissingColon);
        }

        // Now get the value
        QVariant propValue;
        propValue = parseInternal(jsonString, position, nesting + 1);
        // Check for error
        if (propValue.type() == QVariant::StringList) {
            QStringList propValueError(propValue.toStringList());
            propValueError << QObject::tr("in parseObject(%1,%2)").arg(position).arg(nesting);
            return QVariant(propValueError);
        }

        resultObject[propName.toString()] = propValue;

        // Next token must be a "," or "}"
        token = nextToken(jsonString, position);
        if (token == "}") {
            return QVariant(resultObject);
        }
        else if (token != ",") {
            return syntaxError("parseObject", jsonString, position, nesting + 1, ErrorMissingCommaOrClose);
        }
    } while (true);
}

QVariant QvJson::parseArray(const QString& jsonString, int& position, int nesting) {
    QList<QVariant> resultArray;
    QString token;

    token = nextToken(jsonString, position);
    Q_ASSERT(token == "[");

    // Handle case of empty object
    token = peekToken(jsonString, position);
    if (token == ']') {
        return QVariant(resultArray);
    }

    do {

        // Get the element of the array
        QVariant propValue;
        propValue = parseInternal(jsonString, position, nesting + 1);
        // Check for error
        if (propValue.type() == QVariant::StringList) {
            QStringList propValueError(propValue.toStringList());
            propValueError << QObject::tr("in parseObject(%1,%2)").arg(position).arg(nesting);
            return QVariant(propValueError);
        }

        resultArray << propValue;

        // Next token must be a "," or "]"
        token = nextToken(jsonString, position);
        if (token == "]") {
            return QVariant(resultArray);
        }
        else if (token != ",") {
            return syntaxError("parseArray", jsonString, position, nesting + 1, ErrorMissingCommaOrClose);
        }
    } while (true);
}

QVariant QvJson::parseString(const QString& jsonString, int& position, int nesting) {
    QString result;

    // Skip over the double quote character
    Q_ASSERT(jsonString.at(position) == '"');
    position++;

    do {
        if (position >= jsonString.count()) {
            return syntaxError("parseString", jsonString, position, nesting, ErrorNoClosingQuote);
        }
        if (jsonString.at(position) == '"') {
            break;
        }
        if (jsonString.at(position) == '\\') {
            position++;
            if (position >= jsonString.count()) {
                return syntaxError("parseString", jsonString, position, nesting, ErrorNoClosingQuote);
            }
            switch (jsonString.at(position).unicode()) {
                case 'b':
                    result.append('\b');
                    break;
                case 'f':
                    result.append('\f');
                    break;
                case 'n':
                    result.append('\n');
                    break;
                case 'r':
                    result.append('\r');
                    break;
                case 't':
                    result.append('\t');
                    break;
                case 'u':
                    {
                        if (position + 4 >= jsonString.count()) {
                            return syntaxError("parseString", jsonString, position, nesting, ErrorNoClosingQuote);
                        }
                        QString hex = jsonString.mid(position + 1, 4);
                        bool ok;
                        int value = hex.toInt(&ok, 16);
                        if (!ok) {
                            return syntaxError("parseString", jsonString, position+1, nesting, ErrorInvalidHexValue);
                        }
                        result.append(QChar(value));
                        position += 4;
                    }

                default:
                    result.append(jsonString.at(position));
            }
            position++;
        }
        else {
            result.append(jsonString.at(position));
            position++;
        }
    } while(true);
    Q_ASSERT(jsonString.at(position) == '"');
    position++;
    return QVariant(result);
}

QVariant QvJson::parseBool(const QString& jsonString, int& position, int nesting) {
    bool resultBool;
    QString token;

    token = nextToken(jsonString, position);

    if (token == "true") {
        resultBool = true;
    }
    else if (token == "false") {
        resultBool = false;
    }
    else {
        Q_ASSERT(false);
    }
    return QVariant(resultBool);
}

QVariant QvJson::parseNull(const QString& jsonString, int& position, int nesting) {
    QString token;
    token = nextToken(jsonString, position);
    Q_ASSERT(token == "null");
    Q_UNUSED(token);
    return QVariant();
}

QVariant QvJson::parseNumber(const QString& jsonString, int& position, int nesting) {
    int startPosition = position;

    // Allow a leading minus sign
    if (jsonString.at(position) == '-') position++;

    if (position >= jsonString.count()) {
        return syntaxError("parseNumber", jsonString, position, nesting + 1, ErrorEndOfInput);
    }

    // Allow one or more decimal digits
    if (!jsonString.at(position).isDigit()) {
        return syntaxError("parseNumber", jsonString, position, nesting + 1, ErrorInvalidNumericValue);
    }
    while (position < jsonString.count() && jsonString.at(position).isDigit()) {
        position++;
    }
    if (position >= jsonString.count() || 
        (jsonString.at(position) != '.' && jsonString.at(position) != 'e' && jsonString.at(position) != 'E')) {
        bool ok = false;
        int resultInt = jsonString.mid(startPosition, position - startPosition).toInt(&ok);
        if (!ok) {
            return syntaxError("parseNumber", jsonString, position, nesting + 1, ErrorInvalidNumericValue);
        }
        return QVariant(resultInt);
    }

    // Consume any fraction part
    if (jsonString.at(position) == '.') {
        position++;
        while (position < jsonString.count() && jsonString.at(position).isDigit()) {
            position++;
        }
    }

    // Consume any exponent part
    if (jsonString.at(position) == 'e' || jsonString.at(position) == 'E') {
        position++;
        // Consume +/- if present
        if (jsonString.at(position) == '+' || jsonString.at(position) == '-') {
            position++;
        }
        // Must have at least one digit
        if (!jsonString.at(position).isDigit()) {
            return syntaxError("parseNumber", jsonString, position, nesting + 1, ErrorInvalidNumericValue);
        }
        while (position < jsonString.count() && jsonString.at(position).isDigit()) {
            position++;
        }
    }

    // Should have a valid floating point value at this point
    bool ok = false;
    qreal resultReal = jsonString.mid(startPosition, position - startPosition).toDouble(&ok);
    if (!ok) {
        return syntaxError("parseNumber", jsonString, position, nesting + 1, ErrorInvalidNumericValue);
    }
    return QVariant(resultReal);
}

QVariant QvJson::syntaxError(const QString& method, const QString& jsonString, int position, int nesting, Error error) {
    QString text;
    switch (error) {
        case ErrorInvalidNumericValue:
            text = QObject::tr("Invalid numeric value");
            break;
        case ErrorInvalidHexValue:
            text = QObject::tr("Invalid hex value");
            break;
        case ErrorEndOfInput:
            text = QObject::tr("Unexpected end of input");
            break;
        case ErrorNoClosingQuote:
            text = QObject::tr("No closing quote for literal string");
            break;
        case ErrorMissingColon:
            text = QObject::tr("Missing ':' between attribute name and value");
            break;
        case ErrorMissingCommaOrClose:
            text = QObject::tr("Missing comma, '}', or ']'");
            break;
        case ErrorMustBeString:
            text = QObject::tr("The name of an attribute must be a valid character string");
            break;
        case ErrorUnrecognizedToken:
            text = QObject::tr("The token was not recognized");
            break;
    default:
            Q_ASSERT(false);
    }
    QString errorMsg = QObject::tr("*** Error %1 in QvJson::%2 at position %3 -- %4").arg(error).arg(method).arg(position).arg(text);
    QStringList errorList;
    errorList << errorMsg;
    return QVariant(errorList);
}

QString QvJson::encodeJson(const QVariant& jsonObject) {
    QVariant::Type type = jsonObject.type();
    switch (type) {
        case QVariant::Map: 
            return encodeObject(jsonObject);
        case QVariant::List:
            return encodeArray(jsonObject);
        case QVariant::String:
            return encodeString(jsonObject);
        case QVariant::Int:
        case QVariant::Double:
            return encodeNumeric(jsonObject);
        case QVariant::Bool:
            return encodeBool(jsonObject);
        case QVariant::Invalid:
            return encodeNull(jsonObject);
        default:
            return encodingError("encodeJson", jsonObject, ErrorUnrecognizedObject);
    }
}

QString QvJson::encodeObject(const QVariant& jsonObject) {
    QString result("{ ");
    QMap<QString, QVariant> map = jsonObject.toMap();
    QMapIterator<QString, QVariant> i(map);
    while (i.hasNext()) {
        i.next();
        result.append(encodeString(i.key()));

        result.append(" : ");

        result.append(encodeJson(i.value()));

        if (i.hasNext()) {
            result.append(", ");
        }
    }
    result.append(" }");
    return result;
}

QString QvJson::encodeArray(const QVariant& jsonObject) {
    QString result("[ ");
    QList<QVariant> list = jsonObject.toList();
    for (int i = 0; i < list.count(); i++) {
        result.append(encodeJson(list.at(i)));
        if (i+1 < list.count()) {
            result.append(", ");
        }
    }
    result.append(" ]");
    return result;
}

QString QvJson::encodeString(const QVariant &jsonObject) {
    return encodeString(jsonObject.toString());
}

QString QvJson::encodeString(const QString& value) {
    QString result = "\"";
    for (int i = 0; i < value.count(); i++) {
        ushort chr = value.at(i).unicode();
        if (chr < 32) {
            switch (chr) {
                case '\b':
                    result.append("\\b");
                    break;
                case '\f':
                    result.append("\\f");
                    break;
                case '\n':
                    result.append("\\n");
                    break;
                case '\r':
                    result.append("\\r");
                    break;
                case '\t':
                    result.append("\\t");
                    break;
                default:
                    result.append("\\u");
                    result.append(QString::number(chr, 16).rightJustified(4, '0'));
            }  // End switch
        }
        else if (chr > 255) {
            result.append("\\u");
            result.append(QString::number(chr, 16).rightJustified(4, '0'));
        }
        else {
            result.append(value.at(i));
        }
    }
    result.append('"');
    QString displayResult = result;  // For debug, since "result" often doesn't show
    Q_UNUSED(displayResult);
    return result;
}

QString QvJson::encodeNumeric(const QVariant& jsonObject) {
    return jsonObject.toString();
}

QString QvJson::encodeBool(const QVariant& jsonObject) {
    return jsonObject.toString();
}

QString QvJson::encodeNull(const QVariant& jsonObject) {
    return "null";
}

QString QvJson::encodingError(const QString& method, const QVariant& jsonObject, Error error) {
    QString text;
    switch (error) {
        case ErrorUnrecognizedObject: 
            text = QObject::tr("Unrecognized object type");
            break;
    default:
            Q_ASSERT(false);
    }
    return QObject::tr("*** Error %1 in QvJson::%2 -- %3").arg(error).arg(method).arg(text);
} 
```

# c# - 旋转 3D 坐标

> ID：14446794
> 
> 赞同：2
> 
> 时间：2013-01-21T20:37:16.477
> 
> 标签：c#, wpf, geometry, kinect-sdk

我需要在 WPF - C# 中旋转单个坐标。

`x, y,z`存储在`GeometryModel3D[]`点中的值。

例如，坐标（x，y，z）在特定轴上旋转。

[更新] 使用四元数的旋转变换。问题是我没有得到新的向量值，当我查看点云时，它似乎在 Meshlab 中被拖走了。

```
Matrix3D m = Matrix3D.Identity;
Quaternion q = new Quaternion(new Vector3D(320 / 2, y, maxDepth - minDepth), 90);
m.Rotate(q);
Vector3D myVectorToRotate = new Vector3D(((TranslateTransform3D)points[i].Transform).OffsetX,                        ((TranslateTransform3D)points[i].Transform).OffsetY,     ((TranslateTransform3D)points[i].Transform).OffsetZ);

m.Transform(myVectorToRotate);
pointcloud.Add(new Point3D(myVectorToRotate.X,myVectorToRotate.Y,myVectorToRotate.Z)); 
```

我仍然无法获得正确的价值转换。

我想对从 kinect 扫描的第二个点云应用旋转变换。由于第一次扫描数据不涉及旋转，因此捕获数据和使用的代码如下：

```
for (int y = 0; y < 240; y += resolution)
{
    for (int x = 0; x < 320; x += resolution)
    {
        if (((TranslateTransform3D)points[i].Transform).OffsetZ >= minDepth
              && ((TranslateTransform3D)points[i].Transform).OffsetZ <= maxDepth)
        {
            pointcloud.Add(new Point3D(((TranslateTransform3D)points[i].Transform).OffsetX,                                                        ((TranslateTransform3D)points[i].Transform).OffsetY,                                              ((TranslateTransform3D)points[i].Transform).OffsetZ));
        }
        i++;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:47:39.997

创建任何类型的矩阵。例如[旋转矩阵](http://msdn.microsoft.com/en-us/library/system.windows.media.matrix.rotate.aspx)，然后使用静态方法[Vector.Multiply(...)](http://msdn.microsoft.com/en-us/library/ms599350.aspx) 另见[这篇文章](https://stackoverflow.com/questions/2645571/wpf-rotate-a-2d-vector)和[MSDN 通用转换](http://msdn.microsoft.com/en-us/library/ms750596.aspx)概述。

Vector3D 的示例：

1.  [3D转换WPF](https://stackoverflow.com/questions/1274742/3d-transformation-wpf)
2.  [按四元数旋转向量](http://social.msdn.microsoft.com/Forums/en/wpf/thread/080b45d1-f29b-415b-b1d6-39173185c0f1)

    ```
    Vector3D v = new Vector3D(1.0, -1.0, 2.0);
    ...
    AxisAngleRotation3D axisAngle = new AxisAngleRotation3D(axis, angle);
    RotateTransform3D myRotateTransform = new RotateTransform3D(axisAngle, centerVector);
    v.Multiply(myRotateTransform); 
    ```

# java - 处理一些运行时 HTTP 异常的好习惯是什么？

> ID：14446795
> 
> 赞同：4
> 
> 时间：2013-01-21T20:37:17.113
> 
> 标签：java, android, exception-handling, checked-exceptions, unchecked-exception

我有一个看起来像这样的小方法：

```
public static void unstarTrack(Context ctxContext, String strId) {

  try {

      HttpParams htpParameters = new BasicHttpParams();

      List<NameValuePair> lstCredentials = new ArrayList<NameValuePair>();
      lstCredentials.add(new BasicNameValuePair("t", String.valueOf(System.currentTimeMillis() / 1000)));
      lstCredentials.add(new BasicNameValuePair("__call", "favourites.removeSong"));

      HttpPost htpPost = new HttpPost(API_URL);
      htpPost.setEntity(new UrlEncodedFormEntity(lstCredentials));
      htpPost.setHeader("User-Agent", "Mozilla/5.0 (Windows NT 6.1; rv:18.0) Gecko/20100101 Firefox/18.0");
      htpPost.addHeader("Accept-Encoding", "gzip");
      DefaultHttpClient dhcClient = new DefaultHttpClient(htpParameters);

      HttpResponse resResponse = dhcClient.execute(htpPost);
      Log.d(TAG, EntityUtils.toString(resResponse.getEntity()));

      return;

} catch (SocketException e) {
    throw new RuntimeException("problem with network connectivity.", e);
} catch (UnsupportedEncodingException e) {
    throw new RuntimeException("Encoding not supported.", e);
} catch (ClientProtocolException e) {
    throw new RuntimeException("A protocol exception was encountered.", e);
} catch (ParseException e) {
    throw new RuntimeException("An error occurred while trying to read the header elements.", e);
} catch (IOException e) {
    throw new RuntimeException("An error occurred while trying to read response stream.", e);
} 
```

}

该方法本身非常简单，但它有一堆异常发生，我不知道应该如何处理这些异常。通过做一个简单的“e.printStackTrace()”来抑制它们似乎不是一个好主意，所以我开始阅读异常处理最佳实践，但我还是有点迷茫。我应该如何处理异常？

我需要对我的异常做点什么，因为我不想`null`从该方法返回。从我的方法返回 a`null`意味着调用方法将无法了解我的方法内部是否发生了异常。

我应该创建一个自定义异常并引发它还是应该简单地引发未经检查的异常？

调用方法实际上不会对我的方法产生太大影响，即`SocketException`如果网络连接出现问题，`IOException`可能会发生 a，如果读取流出现问题，则可能会发生 a。调用方法最多可以做的是稍后重试。

如果我重新抛出我捕获的所有异常，调用方法只会充满异常处理块。

（如果这似乎是一个微不足道的问题，我很抱歉。我只是想学习编写更好的代码。谢谢。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:12:16.983

创建一个具有适当抽象级别的专用异常（类似于 UnstarTrackException）。抛出这样的异常，包装你捕获的原始异常。这样，调用者只需处理一个异常（我假设所有异常都应该以相同的方式处理：重试）。

是否应检查此异常取决于您的口味。如果要强制方法的所有调用者处理此异常，请将其设为已检查异常。如果您想让调用者选择他是否要处理此异常，请使用运行时异常。

如果此方法深埋在代码层内部，并且只能在顶层处理异常，则运行时异常可能是更好的选择。事实上，除非您是该方法的唯一调用者，否则运行时异常也可能是更好的选择。如今，受检查的异常往往很少使用。

# php - 如何查看 XMLHttp 请求返回到页面的内容？

> ID：14446796
> 
> 赞同：0
> 
> 时间：2013-01-21T20:37:17.770
> 
> 标签：php, google-chrome, firefox

我使用 Firefox，并且有一个名为 Developer -> Web Console 的工具。它显示了有关 GET/POST 请求的更多信息，我们与 XMLHttp 连接的页面，请求标头和此类信息。我确信 Chrome 上也有类似的功能。

页面上有一个 AJAX 调用，我必须查看它返回到网站的内容。它只是一个 GET 请求并返回 JSON。当我手动请求该页面（例如 ajax/view/my_purchases.php）时，它只显示一个空白页面，但是当网站使用 AJAX 请求它时，我可以看到它以 HTML 形式返回的内容。

基本上，我可以使用什么样的工具来查看它？它可以是独立的应用程序、Chrome 或 Firefox 扩展。我什么都好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:44:35.660

[Firebug](http://getfirebug.com/)是最常用的选项。网络面板有你可以使用的“XHR”选项卡，而 chrome 工具实际上是基于它的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:40:28.767

在 chrome 上，您有“网络”选项卡，所有请求和响应都在那里，您也可以在“成功”功能中放置断点并观察响应。ps chrome 有这个控制台，没有任何扩展

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:44:17.050

在 Firefox 上使用 Firebug -> 控制台选项卡（也许激活“显示 XMLHttpRequests”）

编辑：比 Chrome 更好，您可以直接在新选项卡中打开请求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T20:44:44.733

使用“网络”选项卡，您可以查看页面加载时调用的每个外部请求。您的 AJAX 请求将在此处。需要注意的一件事是将任何 GET 或 POST 数据发送到外部脚本。

如果需要某些参数，许多脚本只会提供对其主要算法或数据逻辑的访问。一个非常基本的可能是：

```
<?php

   if (!isset($_POST['submit'])) {
      die;
   }

   // Rest of functionality... 
```

这使得人们更难访问敏感数据。如果您的 AJAX 调用正在发送 POST 数据，您可能无法获得访问权限。如果你这样做，你将提交[CSRF](http://en.wikipedia.org/wiki/Cross-site_request_forgery)。

# ios - 如何在单元格上放置子视图，使其不会阻止其超级视图（单元格）的点击

> ID：14446798
> 
> 赞同：0
> 
> 时间：2013-01-21T20:37:28.927
> 
> 标签：ios, uigesturerecognizer

我在自定义单元格上有以下代码 -

```
 PSCollectionViewTapGestureRecognizer *gr = [[PSCollectionViewTapGestureRecognizer alloc] initWithTarget:self action:@selector(didSelectView:)];
                gr.delegate = self;
                [newView addGestureRecognizer:gr];
                newView.userInteractionEnabled = YES; 
```

我怎样才能将这个手势传递给它的子视图？而不是在子视图上添加新手势。目前，子视图阻挡了一半的视图，但点击它并没有做任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:17:04.563

需要禁用子视图交互

# git - 是否可以使 git commit 不可修改？

> ID：14446799
> 
> 赞同：2
> 
> 时间：2013-01-21T20:37:29.363
> 
> 标签：git, commit, git-amend

有没有办法保护给定的 git commit 不被修改？

我能想到的就是编写一个预提交挂钩来检查 SHA 与“不可修改”SHA 列表。有谁知道标准/更好的方法？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:41:42.870

您可以使用私钥标记提交，这样如果提交被修改，没有密钥的任何人都不能签署新的提交。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:46:46.660

您可以考虑使用 GPG 密钥签署您的提交。

为了做到这一点

*   添加您的 GPG 密钥作为签名密钥

    ```
    git config --global user.signingkey YOUR-KEY 
    ```

*   `-S`使用选项提交

    ```
    git commit -S -m "Your commit message" 
    ```

# node.js - 通过节点在heroku postgresql db上连接被拒绝

> ID：14446800
> 
> 赞同：1
> 
> 时间：2013-01-21T20:37:31.250
> 
> 标签：node.js, postgresql, heroku

我正在通过节点在 heroku 上运行 postgresql 数据库。我有我的服务器设置发布到“/提交”，它调用数据库控制器将数据插入数据库。一切都在本地成功运行，但是当我将其部署到 heroku 和 POST 时，我的 heroku 日志中出现以下错误。

```
2013-01-21T20:23:43+00:00 heroku[router]: at=info method=POST path=/submit host=[MYDOMAIN].herokuapp.com fwd=[IP] dyno=web.1 queue=0 wait=5ms connect=17ms service=35ms status=200 bytes=2
2013-01-21T20:23:46+00:00 app[web.1]:               ^
2013-01-21T20:23:46+00:00 app[web.1]: node.js:201
2013-01-21T20:23:46+00:00 app[web.1]:         throw e; // process.nextTick error, or 'error' event on first tick
2013-01-21T20:23:46+00:00 app[web.1]: 
2013-01-21T20:23:46+00:00 app[web.1]:     at Object.afterConnect [as oncomplete] (net.js:637:18)
2013-01-21T20:23:46+00:00 app[web.1]: Error: connect ECONNREFUSED
2013-01-21T20:23:46+00:00 app[web.1]:     at errnoException (net.js:646:11)
2013-01-21T20:23:48+00:00 heroku[web.1]: Process exited with status 1 
```

和应用程序中的 503。

这是相关的控制器代码（在咖啡脚本中）。

```
LOCAL_DB = "postgres://localhost:#{DBNAME}"

connect = ->
    db = process.env.DATABASE_URL or LOCAL_DB
    client = new pg.Client
    client.connect()
    client

insert = (options) ->
    client = connect()
    query = client.query "INSERT INTO #{TABLE} VALUES($1, $2, $3, $4);",
        [options.uid, options.ls_pref, options.hp_pref, options.date]
    query.on "error", onError
    query.on "end", -> client.end() 
```

我确实将我的数据库提升到了 DATABASE_URL：

```
$ heroku config | grep DATABASE_URL
> DATABASE_URL: postgres://[URL] 
```

为什么我的连接被拒绝？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T00:46:02.130

事实证明，我在创建客户端时没有传递数据库字符串。

```
# Yes
db = process.env.DATABASE_URL or LOCAL_DB
client = new pg.Client db
client.connect()

# No
db = process.env.DATABASE_URL or LOCAL_DB
client = new pg.Client
client.connect db 
```

尽管存在这种相当明显的疏忽，本地数据库仍在工作。你被警告了！

# database-design - 这个基数是多对多还是多对一？

> ID：14446807
> 
> 赞同：0
> 
> 时间：2013-01-21T20:37:53.417
> 
> 标签：database-design, many-to-many, many-to-one

我即将设置一堆数据库，但我现在被困住了。

有一张多所学校 [ **school** ] 的表，它们教授科目 [ **subject** ]。每所学校教授一门学科或多门学科。科目不知道学校。

我想我可以实现一个像“[ **school_teaches_subject** ]”这样的表，它包含一个school_ID 和一个subject_ID。这样我就可以通过阅读 school_ID 来查看学校的科目。

在这种情况下，学校和学科之间的关系是一对多还是多对多？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:44:10.117

如果一个科目可以在你的交叉表中出现多次，那就是 MM，如果只有一次（即一个科目只能在一所学校教授），那么它就是 1-M。决定你需要它是什么，并相应地设置你的约束。

# c# - 从文件中读取并比较它们的数据

> ID：14446810
> 
> 赞同：-4
> 
> 时间：2013-01-21T20:38:20.527
> 
> 标签：c#

我正在尝试创建一个将从文件（我已经创建的文件）中读取的程序。

然后程序必须将上述文件与另一个文件（我也有）进行比较。

有人可以帮助我吗？我已经创建了必须读取第一个文件的部分。另外，如果有帮助，我正在使用控制台应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:48:05.863

这是一个可能的直接解决方案：

```
String[] file1Lines = File.ReadAllLines(path1);
String[] file2Lines = File.ReadAllLines(path2);

for (int i = 0; i < Math.Max(file1Lines.Length, file2Lines.Length); i++)
{
    if (i > file1Lines.Length)
        /* missing from file 1 */ ;
    else if (i > file2Lines.Length)
        /* missing from file 2); */ ;
    else if (file1Lines[i].Equals(file2Lines[i]))
        /* lines are equal */ ;
    else
        /* lines are different */ ;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:40:09.670

一个简单的 Linq 方法使用[`Enumerable.Except`](http://msdn.microsoft.com/en-us/library/bb336390.aspx)它产生集合差异：

```
var file1 = File.ReadAllLines(path1);
var file2 = File.ReadAllLines(path2);
var onlyInFileA = file1.Except(file2);
var onlyInFileB = file2.Except(file1);

foreach(string line in onlyInFileA)
{
    // ...
}
foreach(string line in onlyInFileB)
{
    // ...
} 
```

请注意，您也可以比较不区分大小写。你只需要使用的重载`Except`：

```
var onlyInFileA = file1.Except(file2, StringComparer.OrdinalIgnoreCase); 
```

# ios - 每次退出 iOS 时退出应用程序

> ID：14446813
> 
> 赞同：-3
> 
> 时间：2013-01-21T20:38:28.397
> 
> 标签：ios, objective-c, restart, forceclose, quit

我希望每次关闭我的应用程序时都能“重新启动”它。当我打开另一个应用程序或退出该应用程序并再次启动它时，它应该重新从头开始。所以它总是最新的。

希望你明白我的意思。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T20:42:32.397

[苹果的文档](https://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW5)

> 如果您根本不希望您的应用程序在后台运行，您可以通过将`UIApplicationExitsOnSuspend`键（带有值`YES`）添加到应用程序的 Info.plist 文件来明确选择退出后台。当应用程序选择退出时，它会在未运行、非活动和活动状态之间循环，并且永远不会进入后台或挂起状态。当用户按下 Home 按钮退出应用程序时，应用程序委托的 applicationWillTerminate: 方法被调用，应用程序有大约 5 秒的时间清理并退出，然后终止并移回非运行状态。
> 
> 强烈建议不要选择退出后台执行，但在某些情况下可能是首选选项。具体来说，如果为后台编写代码会显着增加您的应用程序的复杂性，那么终止应用程序可能是一个更简单的解决方案。此外，如果您的应用程序消耗大量内存并且无法轻松释放任何内存，那么系统可能会很快终止您的应用程序，以便为其他应用程序腾出空间。因此，选择终止而不是切换到后台，可能会产生相同的结果并节省您的开发时间和精力。

但是，作为 iOS 应用程序的用户，我必须敦促您重新考虑，因为不能切换到发送推文真的很糟糕。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T20:40:56.750

您想在应用程序的 plist 文件中设置“应用程序不在后台运行”键。

# c# - 无法使用 C# 更新到 .mdb 文件

> ID：14446814
> 
> 赞同：0
> 
> 时间：2013-01-21T20:38:28.350
> 
> 标签：c#, visual-studio, ms-access, sql-update

起初我试过这个：

```
 string set = "";
    for (int i = 1; i < result.Count; i++)
    {
        if ((fieldtypes[i] == "System.Int32"))
        {
            set += fields[i] + "=" + result[i] + ", ";
        }
        else if (fieldtypes[i] == "System.String")
        {
            set += fields[i] + "='" + result[i] + "', ";
        }
        else if (fieldtypes[i] == "System.Boolean")
        {
            set += fields[i] + "=" + result[i] + ", ";
        }
        else if (fieldtypes[i] == "System.DateTime")
        {
            set += fields[i] + "='#" + System.DateTime.Now + "#', ";
        }
    }
    set = set.Substring(0, set.Length - 2);
    string sql11 = "UPDATE [Contacts] SET " + set + " WHERE pkContactID=" + cKey;
    OleDbCommand myCommand11 = new OleDbCommand(sql11, myConnection);
    myCommand11.ExecuteNonQuery(); 
```

现在，当我省略了字符串和日期时间条件以便它只更新 int 和 boolean 时，这可以工作。因此，当我尝试更新类型为字符串的字段时，它与语法错误有关。

* * *

然后我听说写入.mdb文件时必须使用参数，所以我尝试了这个：

```
 string sql11 = "UPDATE [Contacts] SET ";
        for (int i = 1; i < result.Count; i++)
        {
            sql11 += fields[i] + " = ?, ";
        }
        sql11 = sql11.Substring(0, sql11.Length - 2);
        sql11 += " WHERE pkContactID = " + cKey;
        using (myConnection)
        {
            using (OleDbCommand myCommand11 = new OleDbCommand(sql11, myConnection))
            {
                myCommand11.CommandType = CommandType.Text;
                for (int j = 1; j < result.Count; j++)
                {
                    if (fieldtypes[j] == "System.Int32")
                    {
                        myCommand11.Parameters.AddWithValue(fields[j], int.Parse(result[j]));
                    }
                    else if (fieldtypes[j] == "System.String")
                    {
                        myCommand11.Parameters.AddWithValue(fields[j], result[j]);
                    }
                    else if (fieldtypes[j] == "System.Boolean")
                    {
                        myCommand11.Parameters.AddWithValue(fields[j], Boolean.Parse(result[j]));
                    }
                    else if (fieldtypes[j] == "System.DateTime")
                    {
                        myCommand11.Parameters.AddWithValue(fields[j], DateTime.Now);
                    }
                }
                Console.WriteLine(sql11);
                myCommand11.ExecuteNonQuery();
            }
        }
    } 
```

这也不起作用。我认为 ? 没有被正确替换。

无论如何，请帮我修复它，以便我可以正确更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:31:32.327

我不必弄乱 Access 的 UPDATE 查询字符串（这很容易出现语法错误），而是创建了一个 DataTable 对象并选择了我想要更新的行。然后，我通过要更改的元素数组更新了表格，然后使用适配器将表格更新回服务器。这很好用，不用我担心语法！:)

干杯

# c# - 试图伪造一个强命名程序集，但“清单定义不匹配”

> ID：14446815
> 
> 赞同：2
> 
> 时间：2013-01-21T20:38:31.203
> 
> 标签：c#, .net, appdomain, .net-assembly, interception

我想拦截插件和主机程序集之间的通信。

我试图加载`ThirdPartyPlugin.dll`到[AppDomain](http://msdn.microsoft.com/en-us/library/system.appdomain%28v=vs.100%29.aspx)沙箱（下面的代码）中，以拦截它加载`HostLibrary.dll`程序集的尝试（我正在使用处理[AssemblyResolve](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve%28v=vs.100%29.aspx)事件的技巧）。而不是原来的`HostLibrary.dll`，然后我试图注入一个假的，具有一些不同的功能。

不幸的是，原来`HostLibrary.dll`是一个*Strong Named Assembly*，我认为正因为如此，我在我的程序中遇到了**如下异常**：

> 未处理的异常：System.IO.FileLoadException：无法加载文件或程序集“HostLibrary，版本=7.0.0.0，Culture=neutral，PublicKeyToken=1a2b3c4d5e6f7890”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）---> System.IO.FileLoadException：定位的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）

我创建的假程序集与原始程序集的名称 ( `"HostLibrary"`) 和版本 ( ) 匹配；`"7.0.0.0"`有一次我认为我什至让它明显匹配`PublicKeyToken`（当我打印[Assembly.FullName](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.fullname.aspx)时，它​​是相同的），但异常仍然发生。

**您对我如何解决此问题有任何想法吗？**有可能完全解决吗？它是因为数字签名还是其他原因而发生的？如果签名，那么是否可以禁用检查？实际上，通过阅读[Ian Picknell 的一篇文章](http://ianpicknell.blogspot.com/2010/02/tampering-with-strong-named-assembly.html)，我认为我真的不应该遇到这个问题......那么有什么问题吗？

代码是：

```
static void Main(string[] args)
{
    AppDomainSetup setup = new AppDomainSetup();
    setup.ApplicationName = "WrapperBuddy";
    setup.ApplicationBase = System.Environment.CurrentDirectory;

    AppDomain sandbox = AppDomain.CreateDomain("SandboxBuddy", null, setup);
    sandbox.AssemblyResolve += delegate(object sender, ResolveEventArgs args)
    {
        String name = new AssemblyName(args.Name).Name;
        return BuildFakeAssembly(name);
    };

    sandbox.DoCallBack(delegate()
    {
        Assembly plugin = LoadAssembly(PLUGIN_DIR, "ThirdPartyPlugin");
        System.Console.WriteLine(plugin.GetExportedTypes());   // (1)
    });
} 
```

辅助函数定义为：

```
static Assembly LoadAssembly(String dir, String name)
{
    string path = Path.Combine(dir, name) + ".dll";
    return Assembly.Load(File.ReadAllBytes(path));
}

static Assembly BuildFakeAssembly(String name)
{
    AssemblyName aName = new AssemblyName(name);
    // see: http://msdn.microsoft.com/en-us/library/w58ww7se%28v=vs.85%29.aspx
    // http://msdn.microsoft.com/en-us/library/w58ww7se%28v=vs.100%29.aspx
    aName.KeyPair = new StrongNameKeyPair(new FileStream(@"MyKey.snk", FileMode.Open));
                                  // MyKey.snk is a random key generated using sn.exe
    aName.Version = new Version("7.0.0.0");
    //aName.SetPublicKeyToken(new byte[] { 0x11, 0x22, ... }); // didn't help 

    AssemblyBuilder ab = AppDomain.CurrentDomain.DefineDynamicAssembly(
        aName, AssemblyBuilderAccess.RunAndSave);

    ModuleBuilder mb = ab.DefineDynamicModule(aName.Name, aName.Name + ".dll");
    return ab;
} 
```

我会很感激任何帮助。

# r - 跨数据集添加

> ID：14446818
> 
> 赞同：-4
> 
> 时间：2013-01-21T20:38:48.840
> 
> 标签：r

我有一个数据集，我正在尝试跨列添加。例如，假设有 50 行和 100 列。对于每一行，我想遍历特定列（不是全部）并添加结果。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:39:59.863

`apply(df[,c(1,5,10,11,15)],1,sum)`将添加第 1、5、10、11 和 15 列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:46:00.983

`rowSums`一般比 快`apply(dat, 1, sum)`。此外，它们可能都需要有一个额外的参数来防止 NA 值破坏结果。

```
rowSums( dat[ , cols_to_sum] , na.rm=TRUE ) 
```

如果您想要不规则地选择列，即来自不同行的不同列，那么这也是可能的，但您需要澄清问题。

# oop - 子类化对象时，处理对子对象没有意义的函数的适当方法是什么？

> ID：14446820
> 
> 赞同：1
> 
> 时间：2013-01-21T20:38:56.053
> 
> 标签：oop, inheritance, composition, ooad

在我进入问题的实质之前，让我注意这是一个纯粹的*理论*问题。出于实际原因，我对此不感兴趣，我对如何处理这种情况的底层 OOP 理论感兴趣。

在我正在进行的一个项目中，我有两个密切相关的类。一种是通用的“用户”类。另一个是子类，并添加了某些用户使用的附加功能——对于一个通用示例，可​​以考虑一个“主持人”类。

如何处理用户类上可用的公共方法，这些方法对孩子调用没有意义？

例如，调用 User::getUserWithId(id) 非常有意义（此方法从数据库中检索数据并使用该数据初始化并返回用户类）；在主持人类中使用该方法没有多大意义（如果有的话）。

我是否应该忽略它——如果用户调用 moderator::getUserWithId(id)，他们仍然会得到一个用户，这正是他们所要求的。尽管有方法名称，我是否应该覆盖它以返回主持人？还是在我不熟悉的 OOP 领域有什么东西可以让我“阻止”通话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T01:44:18.643

如果您的基类中有在子类中没有意义的方法，那么我认为您需要重新评估是否应该通过继承关系对这些类进行建模。需要在子类中隐藏基类的成员是一个危险信号，表明通过继承关系对此进行建模是有问题的。

继承关系应指示“是”关系。对于您的示例，主持人对象“是”用户对象，因此应该具有与用户对象相同的方法和属性。如果没有，那么它似乎与它的基用户类没有真正的继承关系。

在这种情况下，您可能需要考虑使用接口而不是继承。您可以将 User 和 Moderator 类之间的通用功能分解到一个界面中。如果它们可以共享公共代码，那么您可以使用组合来实现这一点，方法是创建接口的公共实现，然后将其传递给需要重用此代码的类。有关详细信息，请参阅[此处](http://en.wikipedia.org/wiki/Composition_over_inheritance)和[此处](https://stackoverflow.com/questions/49002/prefer-composition-over-inheritance)。

正如上面[第二个链接](https://stackoverflow.com/questions/49002/prefer-composition-over-inheritance)中的作者所说：

*   TypeB 是否想公开 TypeA 的完整接口（所有公共方法不少于），以便 TypeB 可以在预期 TypeA 的地方使用？表示继承。

*   TypeB 是否只需要 TypeA 暴露的部分/部分行为？表示需要组合。

从您需要隐藏基类的成员来看，您似乎属于第二类，可能想探索使用组合和接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T15:30:17.027

昨天我留下了一个回复，不知何故迷路了。我认为，@Joe Alfano 有一个很好的解释，可以解决您的“理论”和特定问题。除此之外，在我看来，问题的一个根源可能是您正在域对象中进行数据库访问。一般来说，除非有令人信服的理由，否则这不是一个好的做法。如果您将该数据库访问权限移除到单独的层，例如数据访问层 (DAL)，则此问题就会消失。你的类中不会有 User::getUserWithId(id) 东西，它们将在 DAL 中处理。喜欢

```
class UserDao {
     User getById(id)

}

Class ModeratorDao {

     Moderator getById(id)
} 
```

如果您采用类似 DAL 的方法，那么您还将找到重构代码的方法，这是另一回事。

# django - paypal-django WPP 授权 - 捕获

> ID：14446821
> 
> 赞同：1
> 
> 时间：2013-01-21T20:38:59.107
> 
> 标签：django, paypal

我正在尝试使用[django-paypal app](https://github.com/johnboxall/django-paypal)`paypal`在网站上通过 PSP 集成支付。

它适用于标准，它似乎也适用于大多数支付专业人士。我正在使用沙盒站点并希望使用`WPP framework`for authorize - capture 工作流进行测试。

也就是说，使用 Paypal 的 WPP 获取客户的付款信息，然后授权他们的卡进行交易，但尚未对其收费。

然后，经过一段时间后，捕获付款。[WPP 文档](https://www.x.com/sites/default/files/pp_wpp_integrationguide.pdf)在第 38 页上显示了直接付款的示例，在第 54 页上显示了快速结帐的示例。

它使用关键字，据我所知`PAYMENTREQUEST_0_PAYMENTACTION`，这两个关键字都没有真正出现在应用程序中。`django-paypal`

我错过了什么吗？有没有办法使用 Django-Paypal 进行此类交易？还是我最好为此编写自己的课程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T03:32:47.643

正如文档所述，您可以简单地发送付款操作的授权，然后稍后将其捕获 DoCapture。

如果你在 Django 库中没有看到调整它的选项，你可能需要扩展它或者只是构建你自己的。

# asp.net - asp.net 将用户名保存为 cookie，然后自动填充

> ID：14446822
> 
> 赞同：0
> 
> 时间：2013-01-21T20:39:06.897
> 
> 标签：asp.net, cookies, login

我正在尝试将用户在用户名文本框中输入的内容作为 cookie 保存，然后在后续访问时让登录表单自动使用 cookie 值填充文本框。我究竟做错了什么？

这会将用户名保存为 cookie 值，但是当返回登录页面时，cookie 值似乎返回为 null。

我目前有：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Dim UserName As TextBox = DirectCast(LoginUser.FindControl("UserName"), TextBox)
    If User.Identity.IsAuthenticated Then
        Response.Redirect("~/media")
    End If
    Dim UserNameCookie As New HttpCookie("User_Name")
    UserNameCookie.Secure = True
    UserNameCookie.HttpOnly = True
    UserNameCookie.Expires = DateTime.Today.AddDays(7)
    UserNameCookie.Value = UserName.Text
    Response.Cookies.Add(UserNameCookie)

    If Request.Cookies("UserName") IsNot Nothing Then
        UserName.Text = Request.Cookies("UserName").Value.ToString()
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:58:03.813

将用户名更改为 User_Name。Cookie 名称必须相同。

```
If Request.Cookies("User_Name") IsNot Nothing Then
   UserName.Text = Request.Cookies("User_Name").Value.ToString()
End If 
```

# php - svn更新脚本跳过svn

> ID：14446826
> 
> 赞同：0
> 
> 时间：2013-01-21T20:39:31.220
> 
> 标签：php

我正在尝试创建一个脚本，它将在根目录上执行 svn 更新，但我不明白我得到的结果。这是我的脚本执行的代码：

```
$update = "svn --username user --password pwd update svn://URL";
$res = exec($update);
echo $res; 
```

但是，回声`$res`给了我“ Skipped 'svn://URL'”。

我使用类似的方法进行 svn checkout 并且效果很好。有什么我缺少能够进行更新的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:42:18.760

确保您在工作副本中。如果脚本在非 SVN 目录中运行，您将收到此错误：

```
 Skipped '/non/workingcopy/path' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:45:37.880

可能您的脚本在工作副本之外运行。无论如何...如果您是在 *NIX 环境下开发，您也可以尝试这种方法：

```
$result = shell_exec("/usr/bin/svn update /path/to/project --username user --password pass"); 
```

# magento - 覆盖 Magento 的默认图像存储模式

> ID：14446828
> 
> 赞同：1
> 
> 时间：2013-01-21T20:39:38.223
> 
> 标签：magento

默认情况下，Magento 将图像存储为

```
~/D/E/DEFAULT.jpg 
```

使用文件名的前两个字母来创建文件夹结构。我想让它以不同的方式工作，但在管理后端或谷歌搜索中找不到任何关于它的信息。有没有人有过这方面的经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:45:43.787

您正在寻找的似乎是在 class 中处理的`Varien_File_Uploader`，所以在 lib/Varien 文件夹中的 Magento 深处。有一种方法`getDispretionPath($fileName)`如下所示：

```
static public function getDispretionPath($fileName)
{
    $char = 0; 
    $dispretionPath = '';
    while (($char < 2) && ($char < strlen($fileName))) {
        if (empty($dispretionPath)) {
            $dispretionPath = DIRECTORY_SEPARATOR
                . ('.' == $fileName[$char] ? '_' : $fileName[$char]);
        } else {
            $dispretionPath = self::_addDirSeparator($dispretionPath)
                  . ('.' == $fileName[$char] ? '_' : $fileName[$char]);
        }
        $char ++;
    }
    return $dispretionPath;
} 
```

基本上，while 循环最多有两次运行，其中它添加一个目录分隔符，后跟一个文件名的字符（或“_”，如果字符是“.”）`$dispretionPath`并返回该路径。该方法又用于`save()`创建目录的同一类的方法中：

```
$this->_dispretionPath = self::getDispretionPath($fileName);
$destinationFile.= $this->_dispretionPath;
$this->_createDestinationFolder($destinationFile); 
```

# javascript - 脚本未运行 jquery .each

> ID：14446831
> 
> 赞同：0
> 
> 时间：2013-01-21T20:39:48.363
> 
> 标签：javascript, jquery

这是我正在尝试开发的益智游戏的片段。`each()`问题是它在调用 jquery后停止工作。请帮我找出问题所在。提前致谢。

```
 function setTotalInPositionPieces()
    {
        $("#board").children('div').each(function(index, element) {
            if(testInPosition(element))
            {
                ++totalInPositionPieces;
                $(element).attr("data-inPositionStatus", '1');
            }
        });

    /* The script does not from here, onward. Please tell 
me what is the problem.*/

        if(totalInPositionPieces == totalPieces)
        {
            $("#messageBox").text("Puzzle Solved!");
        }
    } 
```

`totalInPositionPieces`并且`totalPieces`是全局变量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:42:54.420

您应该将函数的`var totalInPositionPieces`外部定义为`each`在任何其他函数的范围内或其外部都可以访问。
对于`totalPieces`. 你在哪里定义它？

也探索这些东西：[http ://api.jquery.com/jQuery.data/](http://api.jquery.com/jQuery.data/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:11:10.140

```
function setTotalInPositionPieces()
    {
        var list = $("#board").children('div');
        var totalInPositionPieces = 0;

        $.each(list, function(index, element) {
            if(testInPosition(element))
            {
                ++totalInPositionPieces;
                $(element).attr("data-inPositionStatus", '1');
            }
        });

        if(totalInPositionPieces == totalPieces)
        {
            $("#messageBox").text("Puzzle Solved!");
        }
    } 
```

# ruby-on-rails - 无法通过 insightPlaybackLocationType 获得观看次数 — YouTube Analytics API

> ID：14446832
> 
> 赞同：0
> 
> 时间：2013-01-21T20:39:52.700
> 
> 标签：ruby-on-rails, ruby, youtube-api, analytics

因此，我在 Rails 中使用了“google-api-client”gem，并尝试调用下面的 URL，以便通过 insightPlaybackLocationType 获取视频视图。[从“可用报告”](https://developers.google.com/youtube/analytics/v1/available_reports%20Available%20Reports)文档页面看来，这是一个允许的调用。

不幸的是，我发现我无法使用 Google 提供的 API Explorer 工具进行此调用。

网址：

[https://www.googleapis.com/youtube/analytics/v1beta1/reports?metrics=views&ids=channel==CHANNEL_ID&dimensions=day,insightPlaybackLocationType&filter=video==VIDEO_ID&start-date=2013-01-15&end-date=2013-01- 16&开始时间=1970-01-01](https://www.googleapis.com/youtube/analytics/v1beta1/reports?metrics=views&ids=channel==CHANNEL_ID&dimensions=day,insightPlaybackLocationType&filter=video==VIDEO_ID&start-date=2013-01-15&end-date=2013-01-16&start-time=1970-01-01)

结果：

```
{
  :error=>
    {
      "errors"=>[
        {
          "domain"=>"global",
          "reason"=>"invalid",
          "message"=>"Unknown identifier (insightPlaybackLocationType) given in field parameters.dimensions."
        }
      ],
      "code"=>400,
      "message"=>"Unknown identifier (averageViewDuration) given in field parameters.dimensions."
    }
} 
```

我不确定我可以在这个错误的初始描述中提供哪些额外数据，但如前所述，我使用 Google::APIClient Ruby 库调用 API。实际代码本身如下所示：

```
client.execute(
  :api_method => api.reports.query,
  :parameters => options
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T14:13:58.570

您需要将版本设置为 v1 而不是 v1beta1。

开始时间参数对我来说似乎是错误的。您已经指定了开始日期

检查 API 资源管理器：http: [//developers.google.com/apis-explorer/#p/youtubeAnalytics/v1/youtubeAnalytics.reports.query ?ids=channel%253D%253DCHANNEL_ID&start-date=2012-12-15&end-date= 2013-01-16&metrics=views&dimensions=day%252CinsightPlaybackLocationType&filters=video%253D%253DVIDEO_ID&_h=4&](http://developers.google.com/apis-explorer/#p/youtubeAnalytics/v1/youtubeAnalytics.reports.query?ids=channel%253D%253DCHANNEL_ID&start-date=2012-12-15&end-date=2013-01-16&metrics=views&dimensions=day%252CinsightPlaybackLocationType&filters=video%253D%253DVIDEO_ID&_h=4&)

# xml - xs:unique - 在抽象元素的架构中强制执行唯一属性值

> ID：14446839
> 
> 赞同：2
> 
> 时间：2013-01-21T20:40:19.403
> 
> 标签：xml, xpath, xsd, unique

我正在尝试使用`xs:unique`. 但是，我认为我在使用 XPath 时遇到了一些问题。

我有一个抽象元素 ObjectA，它有一个属性“标识符”，它是一个字符串。我希望这个标识符在具体元素 ObjectB 和 ObjectC 的所有实例中都是唯一的。我不认为`xpath="."`是正确的。

```
<xs:element name="ObjectA" type="ns:ObjectAType">
  <xs:unique name="Identifier">
    <xs:selector xpath="."/>
    <xs:field xpath="@identifier"/>
  </xs:unique>
</xs:element>

<xs:complexType name="ObjectAType" abstract="true">
  <xs:attribute ref="ns:identifier" use="required" />
</xs:complexType>

<xs:attribute name="identifier" type="xs:string" />

<xs:element name="ObjectB" type="ns:ObjectBType" substitutionGroup=ns:ObjectA" />
<xs:element name="ObjectC" type="ns:ObjectCType" substitutionGroup=ns:ObjectA" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T09:05:16.280

如果您希望包含 D 元素中的每个 A 元素都具有唯一的 F 值，那么您应该在 D 元素级别定义唯一约束；选择器应该从 D 开始选择 A 元素，字段应该从 A 元素开始选择 F 的值。您的错误是您试图在 A 元素上定义约束，这是错误的，因为没有单个 A 元素是无效的；无效性在 D 级。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T04:27:54.353

唯一约束比单个元素更适用于集合。您拥有的架构定义或多或少是有效的，只是在 Objectx 的“内部”元素而不是整个对象中检查了唯一性。如果您发布完整的架构，它将有助于提供更准确的定义。

# driver - 需要帮助将 Arduino R3 用作串口转 USB 转换器（进行编程）

> ID：14446840
> 
> 赞同：2
> 
> 时间：2013-01-21T20:40:20.260
> 
> 标签：driver, arduino, rxtx, uart, atmega

我已经研究过（并且学到了很多东西），但我在编程方面的经验很少，到目前为止只真正了解基本草图。我想使用 Arduino R3（更具体地说，是 USB 到串行转换器芯片）来编写一个全尺寸的业余无线电。

我已将我的收音机适当地连接到 Arduino（5V、Rx、Tx、Gnd）并将 Arduino 置于三态模式（显然你必须这样做..），但我似乎缺乏合适的驱动程序。我基本上希望我的 Arduino R3 能够完全像这样运行：[CP2102](http://www.ebay.com/itm/USB-2-0-UART-TTL-6PIN-Connector-Module-Serial-Converter-CP2102-New-/350499583299)。请注意，我并不是超级便宜。要在我住的地方得到这样的东西至少需要一个月的时间。也有人说我应该去掉Atmega芯片。最终目标是我在 com 端口上拥有一个带有驱动程序的设备，而不仅仅是一个“未知设备”。

所以，我的问题是：让 Atmega 保持开启状态，还是将其移除？我需要哪些驱动程序？

谢谢！

编辑：我在发布后几乎完全找到了我需要的东西。出于某种原因，我无法让它工作，但也许你可以帮助我理解？这是链接[LINK](http://aeroquad.com/showthread.php?2587-T6-TX-Cable-alternative)如果有人热衷于帮助我！

澄清一下：以前已经做过了，但我感觉人们忽略了他们认为显而易见的事情，但对于像我这样尚未专业的修补匠来说却不是：/

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:23:10.380

您引用的链接似乎适用于带有 FTDI 芯片的旧 Arduino。[Arduino Uno](http://learn.adafruit.com/arduino-tips-tricks-and-techniques/arduino-uno-faq)不使用它。这是使用 Uno的[链接](http://arduino.cc/forum/index.php?topic=98197.0)

> 所以！所有较旧的 Arduino（NG、Diecimila 和 Duemilanove）都使用 FTDI 芯片（FT232RL）从 Arduino 芯片（Atmel ATmega）转换 TTL 串行。这允许进行可打印调试，连接到 PureData/Max、Processing、Python 等软件。它还允许通过串行引导加载程序更新固件。
> 
> 关于 FT232RL 的好消息有免版税驱动程序，而且几乎可以正常工作。坏消息是它只能用作 USB/串行端口。它不能像键盘、鼠标、磁盘驱动器、MIDI 设备等。

和

> Arduino Uno 具有许多用于与计算机、另一个 Arduino 或其他微控制器通信的设施。ATmega328 提供 UART TTL (5V) 串行通信，可在数字引脚 0 (RX) 和 1 (TX) 上使用。板上的 ATmega16U2 通过 USB 引导这种串行通信，并显示为计算机上软件的虚拟 com 端口。'16U2 固件使用标准 USB COM 驱动程序，无需外部驱动程序。但是，在 Windows 上，需要 [.inf 文件](http://arduino.cc/en/Guide/Windows#toc4). Arduino 软件包括一个串行监视器，它允许向 Arduino 板发送和从 Arduino 板发送简单的文本数据。当数据通过 USB 转串行芯片和 USB 连接到计算机传输时，板上的 RX 和 TX LED 将闪烁（但不用于引脚 0 和 1 上的串行通信）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:39:04.563

基本上，您提供的链接显示用户正在破解 Arduino。使用 USB/串行 (TTL) 转换器（Arduino 上的任何芯片）链接到收音机的 Mini Din 连接器，而不是连接到 Arduino 的 CPU。

如其他答案所述，Arduino 使用 CHIP（某种风格）将 USB（虚拟串行端口）桥接到 ATmega328 micro 的串行端口。这些引脚在 Shields 连接器 0(RX) 和 1(TX) 上可用。因此，您会看到将这些引脚连接到无线电的 DIN 连接器的图片。我希望另外 Arduino CPU 的 RESET 会保持在 GND，这将迫使引脚进入 Hi。只需用一根额外的电线将 RESET 引脚连接到 GND。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T14:42:55.403

它正在工作！在某个地方，我的 arduino 的驱动程序似乎已被删除，所以我重新安装了它们，按照你说的做了，并学到了一些东西。

所以要向其他人澄清一下：几乎即插即用（正如我发布的链接所暗示的那样），但请确保正确安装 arduino 驱动程序。

非常感谢您的帮助！

# jquery - 使用 jquery-validate 时，如何添加适用于整个表单的自定义验证函数？

> ID：14446844
> 
> 赞同：0
> 
> 时间：2013-01-21T20:40:36.907
> 
> 标签：jquery, function, jquery-validate, customization

我知道您可以通过执行以下操作为特定元素添加自定义验证函数：

```
jQuery.validator.addMethod('>0', function(value, element){
    return this.optional(element) || parseInt(value) > 0;
}, 'Amount needs to be greater than 0'); 
```

但我想知道是否有一种方法可以在整个表单中添加自定义验证功能。首先我会告诉你为什么我需要这个。在我的表单中，我有大约 40 个带有百分比的选择字段。我要求它们加起来最多为 100。我无法添加自定义函数来解决这个问题，因为这些选择字段代表不断变化的类别（超出我的能力）。

这是我编写的一个函数，如果我能以某种方式运行这个函数作为验证的一部分，它将起作用。

```
var answer = false;

var categories = $('select').find('option:selected:not([value="0"])').parent();
var percent = 0;
$.each(categories, function(i, category){
    percent += +$(category).val();
});
if(percent == 100){
    $('#percentage-error').html("");
    answer = true;
}else{
    alert("Percentages must add up to 100%.");
    $('#percentage-error').html("PERCENTAGES MUST ADD UP TO 100%");
}

return answer; 
```

这是我的 HTML：

```
<table id="cat_table">
    <tbody>
        <tr>
            <td>Artisan Food</td>
            <td>
                <select name="31">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
            <td>Home Decor - Wood Carvings</td>
            <td>
                <select name="24">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Bath &amp; Body</td>
            <td>
                <select name="1">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
            <td>Home Decor - Woodcraft</td>
            <td>
                <select name="25">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Ceramics/Porcelain</td>
            <td>
                <select name="3">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
            <td>Jewelry</td>
            <td>
                <select name="9">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Fine Art</td>
            <td>
                <select name="5">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
            <td>Leather</td>
            <td>
                <select name="11">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Functional Pottery</td>
            <td>
                <select name="7">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
            <td>Music</td>
            <td>
                <select name="13">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Home Decor - Baby</td>
            <td>
                <select name="2">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
            <td>Textile Usables</td>
            <td>
                <select name="15">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Home Decor - Dolls</td>
            <td>
                <select name="4">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
            <td>Textile Usables - Baby</td>
            <td>
                <select name="19">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Home Decor - Embroidery</td>
            <td>
                <select name="6">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
            <td>Textile Usables - Bags</td>
            <td>
                <select name="17">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Home Decor - Floral</td>
            <td>
                <select name="8">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
            <td>Textile Usables - Leather</td>
            <td>
                <select name="16">
                    <option value="0">0%</option>
                    <option value="5">5%</option>
                    <option value="10">10%</option>
                    <option value="15">15%</option>
                    <option value="20">20%</option>
                    <option value="25">25%</option>
                    <option value="30">30%</option>
                    <option value="35">35%</option>
                    <option value="40">40%</option>
                    <option value="45">45%</option>
                    <option value="50">50%</option>
                    <option value="55">55%</option>
                    <option value="60">60%</option>
                    <option value="65">65%</option>
                    <option value="70">70%</option>
                    <option value="75">75%</option>
                    <option value="80">80%</option>
                    <option value="85">85%</option>
                    <option value="90">90%</option>
                    <option value="95">95%</option>
                    <option value="100">100%</option>
                </select>
            </td>
        </tr>
    </tbody>
</table> 
```

请注意，选择的名称是数字。这些数字对应于数据库中类别的 ID。管理员可以随时打开和关闭这些类别以及添加或删除它们。

那么关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:09:50.547

与您的代码一起使用`addMethod`并应用于最后一个选择：

```
$.validator.addMethod('select_total_precent', function(value, element){
    /* your select percentage validation code here*/

      return answer;
}, 'Amount needs to be greater than 0');

$('#formID').validate();
/* must initialize validation before adding rules*/
$('#formID').find('select:last').rules('add', {select_total_precent:true}) 
```

如果您在用户更改选择时提供可查看的总数，将对用户有很大帮助。如果您这样做了，您可以验证该字段而不是您的方法，并在提交之前简单地禁用它`submitHandler`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:05:46.430

调用您的函数来检查 submitHandler 函数中的百分比。当表单的其余部分有效时，这将被调用

# ruby-on-rails-3 - rails 3 多格式地理编码器

> ID：14446849
> 
> 赞同：0
> 
> 时间：2013-01-21T20:41:05.090
> 
> 标签：ruby-on-rails-3, forms, wizard, rails-geocoder, multi-step

使用来自地理编码器的 railscast 217（多步/向导）。我想要做的是让用户在表单的第一部分输入会议地点，然后在表单的第二部分让地理编码器返回地理编码器已过滤掉的地址列表。我该怎么做呢？

我已经创建了多步表单。但是我在控制器中使用什么来从表单的第一部分获取地址（街道、城市、国家），然后使用地理编码器的 near 属性在表单的第二部分返回附近位置的列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T19:15:52.137

想通了：

首先找到 railscast 中计费的“第二个”页面

```
elsif @order.currentplan_step == 'billing' (I placed this right after the first elsif)
   #now just build a location from the previous page(form) fields
   @orderlocation = params[:order][:orderaddress] + ", " + params[:order][:ordercity]

   #and create a list of addresses, now you can use @findlocations to create a list of addresses you can ship to that are near your location
   @findlocations = Location.near(@orderlocation, 20) 
```

# c++ - 在 C++ 中填充一个数组

> ID：14446850
> 
> 赞同：7
> 
> 时间：2013-01-21T20:41:09.683
> 
> 标签：c++, visual-c++, c++11

我是 c++ 新手。我试图编写以下代码来用新值填充数组的每个字节而不覆盖其他字节。下面的每个字节 (r) 都应在数组的新地址处相加。

```
int _tmain(int argc, _TCHAR* argv[]) {
    char y[80];
    for(int b = 0; b < 10; ++b) {
        strcpy_s(y, "r");
    }
} 
```

请让我知道 C++ 中是否有任何功能可以做到这一点。在上述情况下，值 'r' 是任意的，它可以有任何新值。所以生成的字符数组应该包含值 rrrrrr... 10 次。提前非常感谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-21T20:43:11.673

使用 C++11

```
#include <algorithm>
#include <iostream>

int main() {
    char array[80];
    std::fill(std::begin(array),std::begin(array)+10,'r');
} 
```

或者，如评论中所述，您可以使用`std::fill(array,array+10,'r')`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T20:43:12.380

您可以使用`[]`运算符并分配一个`char`值。

```
char y[80];
for(int b=0; b<10; ++b)
    y[b] = 'r'; 
```

是的，这`std::fill`是一种更惯用和更现代的 C++ 方式来执行此操作，但您也应该了解`[]`运算符！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T22:13:37.637

```
// ConsoleApp.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <iostream>
#include <string>

using namespace std;

int fun(bool x,int y[],int length);
int funx(char y[]);
int functionx(bool IsMainProd, int MainProdId, int Addons[],int len);
int _tmain(int argc, _TCHAR* argv[])
{
    int AddonCancel[10];

    for( int i = 0 ; i<4 ;++i)
    {
        std::fill(std::begin(AddonCancel)+i,std::begin(AddonCancel)+i+1,i*5);
    }
    bool IsMainProduct (false);
    int MainProduct =4 ; 
    functionx(IsMainProduct,MainProduct,AddonCancel,4);

}

int functionx(bool IsMainProd, int MainProdId, int Addons[],int len)
{
    if(IsMainProd)
        std::cout<< "Is Main Product";
    else
    {
        for(int x = 0 ; x<len;++x)
        {
          std::cout<< Addons[x];
        }
    }

    return 0 ; 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T20:58:44.643

选项 1：在定义时初始化数组。便于初始化少量值。优点是可以声明数组`const`（此处未显示）。

```
char const fc = 'r';   // fill char
char y[ 80 ] = { fc, fc, fc, fc,
                 fc, fc, fc, fc,
                 fc, fc }; 
```

选项 2：经典 C

```
memset( y, y+10, 'r' ); 
```

选项 3：经典（C++11 之前）C++

```
std::fill( y, y+10, 'r' ); 
```

# jquery - jQuery Backstretch：下一个，上一个方法

> ID：14446852
> 
> 赞同：0
> 
> 时间：2013-01-21T20:41:11.663
> 
> 标签：jquery, jquery-backstretch

我正在建立一个使用 Backstretch 的网站（顺便说一句超级方便）。我已经看到了一些将特定元素推送到幻灯片的示例，如下所示：

```
$("#cheers").click(function(e) {
    e.preventDefault();
    $.backstretch('http://dl.dropbox.com/u/515046/www/cheers.jpg');
}); 
```

但是有没有人有创建后退/前进按钮的经验（无需指定 URL）？查看[源代码](https://github.com/srobbin/jquery-backstretch/blob/master/jquery.backstretch.js) `line 252`，您会看到一个`next`功能，但我不确定如何使用它，通过标准点击绑定：

```
$("#cheers").click(function(e) {
    e.preventDefault();
    $.backstretch('http://dl.dropbox.com/u/515046/www/cheers.jpg');
}); 
```

认为这将作为一个微妙的 UI 添加有用。任何指针将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T21:26:55.340

开始了！

```
$('#next').click(function(x) {
    x.preventDefault();
    $('body').data('backstretch').next();
});
$('#prev').click(function(x) {
    x.preventDefault();
    $('body').data('backstretch').prev();
}); 
```

# node.js - 让 node.js/socket.io 响应两个不同的事件

> ID：14446855
> 
> 赞同：0
> 
> 时间：2013-01-21T20:41:35.910
> 
> 标签：node.js, socket.io

我是 node.js 和 socket.io 的新手。我有一个测试服务器，其中运行着来自 socket.io 站点 ( [http://socket.io/#how-to-use](http://socket.io/#how-to-use) ) 的示例代码。

我不知道从哪里开始执行以下操作

*   冲浪到“page1”并让节点知道我是user1
*   冲浪到“page2”并让节点知道我是用户2
*   同步例如单词 user1 和 user2 分别在“page1”和“page2”的某处键入，并在两个页面上显示来自 user1 和 user2 的所有单词。

我想我需要在 node.js 应用程序的服务器端的“处理程序”函数中创建某种路由，但我不确定这是否是正确的方法。

有人可以帮我指出正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:07:14.547

Socket.io 让这变得非常简单。它有命名空间和房间。例如，要创建两个不同的命名空间，您可以这样做：

```
var io = require('socket.io').listen(app, {origins: '*:*', log: false});

var page1 = io.of('/page1').on('connection', function (socket) {
  //you can use socket in here
});

var page2 = io.of('/page2').on('connection', function (socket) {
  //you can use socket in here
}); 
```

您现在有两个命名空间。在每个内部，您都可以侦听事件。例如，如果您发送了一个类型事件：

```
socket.on('type', function(text){
  io.sockets.emit('type', {'whatWasTyped': text]);
} 
```

这将向所有连接的客户端发送一个类型事件。

如果您想进一步分离命名空间，您可以创建房间。以下是如何在命名空间中创建房间：

```
var page1 = io.of('/page1').on('connection', function (socket) {
  socket.on('add', function(area){
    socket.join(area);
  };
}); 
```

每次与要加入的房间建立连接时，您都必须发送添加事件。然后，您可以只向该房间发送消息。

```
io.of('/users').in(area).emit('event', {'event': yourInfoHere}); 
```

您可以通过运行获取有关连接的信息：

```
socket.get('user', function(err, info){ //in here }); 
```

这是我脑海中的一些信息，来自 socket.io wiki：[https](https://github.com/LearnBoost/socket.io/wiki/Rooms) ://github.com/LearnBoost/socket.io/wiki/Rooms 。

我还没有测试过，如果您还有其他问题，请告诉我。

# api - POS 在 Trello API 中的实际含义是什么

> ID：14446859
> 
> 赞同：14
> 
> 时间：2013-01-21T20:41:46.643
> 
> 标签：api, trello, trello.net

我正在使用 dillenmeisters Trello.Net API Wrapper，每个`Card`都有一个`POS`属性。我认为这是它在列表中的位置，但数字似乎是任意的，范围从 4 到 5 位数字。是否有足够的意义来理解这些足以`Card`在列表中已经存在的两个其他人之间“放置”一个新的？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-21T21:12:25.347

**编辑：**

在 Trello.NET（在 NuGet 上）的 0.5.9-beta1 版本中可用：

```
// Ways to set the position of a card
trello.Cards.ChangePos(card, 1234)
trello.Cards.ChangePos(card, Position.Top)
trello.Cards.ChangePos(card, Position.Bottom) 
```

我还没有深入研究 pos 的工作原理，但我认为这是一个排序顺序。如果你想在另外两张牌之间移动一张牌，你可以得到这两张牌的位置并将它们的位置相加并除以二。

例如，如果要在卡 A 和卡 B 之间插入卡 C：

1.  卡 A - 位置 16
2.  卡 B - 位置 32
3.  卡 C - 位置 64

(16 + 32) / 2 = 24。将卡片 C 的位置设置为 24。

1.  卡 A - 位置 16
2.  卡 C - 位置 24
3.  卡 B - 位置 32

我认为他们这样做是为了在移动卡片时只需要更新一个 Pos（而不是在它之后的所有卡片的 Pos，如果他们使用没有间隙的连续 Pos，这将是必要的）。

# sql - 表中的 SQL 查询但 ID 相同

> ID：14446860
> 
> 赞同：1
> 
> 时间：2013-01-21T20:41:49.777
> 
> 标签：sql, sharepoint, sharepoint-2007

此[屏幕截图](http://i.stack.imgur.com/U3uka.jpg)是 Sharepoint 数据库中的列表。

我想从数据库中获取数据，但我有版本问题；

tp_ID 是我的列表项 ID tp_Version 是我的列表版本

我想从数据中获取更高版本的 tp_ID。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:02:06.370

这将给你你所需要的：

```
select  * from (select  *,RANK () OVER ( PARTITION BY  tp_id ORDER BY   tp_version DESC) AS rnk
        from    yourtable
        ) mytable where rnk <= 1 
```

# python - 匹配不连续/中断的字符串

> ID：14446861
> 
> 赞同：4
> 
> 时间：2013-01-21T20:41:54.207
> 
> 标签：python, regex

我有这个预定义的字符串列表，我想在一个大文本文件中进行匹配。问题是文本中确实存在许多这些字符串，但被我想保留的虚假字符/html-xml 标签打断。

例如，我想匹配“联合国总部”，它可以以下列形式存在于文本中：

```
United Nations & Headquarters
United <br> Nations Headquarters
United Natio<b>ns Hea</b>dquarters 
```

我基本上需要知道这些字符串的位置，后面会处理这些伪字符。我会为不间断的字符串做的是：

```
sting_locations=[v.span() for v in re.finditer(our_string,text)] 
```

是否可以设置一些正则表达式以某种方式忽略这些中断，或者解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:46:26.117

```
import re

text = """United Nations & Headquarters
United <br> Nations Headquarters
United Natio<b>ns Hea</b>dquarters"""

s = "United Nations Headquarters"

r = re.compile(".*?".join(s))
print([v.span() for v in r.finditer(text)]) 
```

关键是`".*?".join(s)`，它`.*?`在每对连续字符之间插入`s`以将其转换为正则表达式。

`.*?`如果您想限制允许的中断，您可能更愿意收紧一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:14:53.743

有几个解决方案可以避免灾难性的回溯*并*允许任何数量的中断！

**解决方案 A**

这是最干净的解决方案，但需要[正则表达式模块（](http://pypi.python.org/pypi/regex)[在此处](http://www.lfd.uci.edu/~gohlke/pythonlibs/#regex)获取二进制文件）。它使用原子分组 ,`(?>...)`来避免回溯：

```
import regex

strExampleFile = '''United Nations & Headquarters
United <br> Nations Headquarters
United Natio<b>ns Hea</b>dquarters'''

strSearch = 'United Nations Headquarters'

strRegex = regex.sub(r'((?<!^).)',r'(?>[\s\S]*?(?=\1))\1',strSearch)
rexRegex = regex.compile(strRegex)

print([objMatch.span() for objMatch in rexRegex.finditer(strExampleFile)]) 
```

**解决方案 B**

如果您既没有安装也不想安装[regex模块，](http://pypi.python.org/pypi/regex)*可以*使用re来模拟原子分组。但是，搜索字符串现在限制为最多 100 个字符：

```
import re

strExampleFile = '''United Nations & Headquarters
United <br> Nations Headquarters
United Natio<b>ns Hea</b>dquarters'''

strSearch = 'United Nations Headquarters'

strRegex = re.sub(r'((?<!^).)',r'(?=([\s\S]*?(?=\1)))\\##\1',strSearch)

for numBackReference in range(1,len(strSearch)) :
    strRegex = strRegex.replace("##", str(numBackReference),1)

rexRegex = re.compile(strRegex)

print([objMatch.span() for objMatch in rexRegex.finditer(strExampleFile)]) 
```

**注意：**正如 femtoRgon 所指出的，这两种方法都可能返回误报。

# php - 撇号和 wkhtmltoimage 的编码问题

> ID：14446870
> 
> 赞同：1
> 
> 时间：2013-01-21T20:42:27.477
> 
> 标签：php, html, encoding

我有一个转义的撇号：

```
&#39; 
```

变成了这样：

```
тАЩ 
```

当我尝试使用 wkhtmltoimage 库将其转换为图像时。

谁能告诉我如何解决它？

我知道它是编码，但不确定用什么替换它。

常规撇号和反引号也显示得很奇怪。

我需要它来表达“不要”之类的词。

使用 PHP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-28T10:04:08.560

`--encoding=utf8`在执行命令时尝试。

# javascript - 在 RaphaelJS 中通过路径将图像“绘画”动画到纸上

> ID：14446871
> 
> 赞同：1
> 
> 时间：2013-01-21T20:42:27.927
> 
> 标签：javascript, animation, raphael

我正在寻找通过圆形“画笔”[Think Photoshop 默认画笔]将图像动画到画布上，无论圆圈在图像显示的路径上移动。

图像将是位图，而不是矢量文件。除了显示图像的“绘画”之外，画笔不会有任何额外的细节

作为补充说明，圆形画笔会自动移动，用户不会移动画笔。它只是沿着路径动画。

我真的很想知道如何用 Raphael 做到这一点。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T14:45:32.227

如果你想实现这样的目标，你最好考虑使用`Canvas`. 因为`Raphael`是一个专门面向`SVG`. 您可以使用非 svg 图像，但您将面临很多限制。

另一方面，Canvas 是面向像素的，所以你想做的事情会更容易。

`Raphael`在用户交互方面非常棒`SVG`，因为您创建的元素是 DOM 中的节点，您可以轻松地将它们绑定到事件。

如果您仍然想用 实现类似的目标`Raphael`，您将需要开始深入研究 Raphael 的方法。很难有人解释整个过程。你最好开始尝试，并就更具体的问题提出一些问题。

除了 Raphael 的文档，我推荐[这个](http://www.irunmywebsite.com/raphael/additionalhelp.php?v=2#pagetop)色彩丰富但很有用的网站，其中有一些工作示例。

无论哪种方式，我认为您应该重新考虑使用`Raphale`over `Canvas`！

我希望这有帮助！

# iis - 如何将 IIS 配置为使用自定义错误，并设置为所有扩展/MIME 重新创建选项？

> ID：14446872
> 
> 赞同：1
> 
> 时间：2013-01-21T20:42:28.370
> 
> 标签：iis, mime-types, file-extension, custom-errors

我目前正在使用 customErrors，并且我想始终使用重新创建选项。

这目前适用于 URL，例如 `mysite.com/asdf`

我的自定义错误页面加载为此 URL： `mysite.com/asdf`

* * *

但是，这不适用于诸如 `mysite.com/asdf.aspx`

我的自定义错误页面加载为 `mysite.com/mycustomerrorpage.aspx?errorpath=/asdf.aspx`

这由 IIS 处理为 302 重定向到上面的错误页面，加载时状态为 200。

* * *

我要完成的工作：我希望用户收到 404 的 http 状态（或相应的状态代码），并且我希望页面始终重新创建（无论扩展名或缺少扩展名）。我不希望来自 IIS 的 302 重定向，也不希望自定义错误页面返回为 200。

我是 IIS 新手 - 这似乎是一件基本的事情，但我遇到的麻烦比我想象的要多:)

提前感谢您的任何帮助！

# php - 对象以其原始名称传入参数？

> ID：14446877
> 
> 赞同：0
> 
> 时间：2013-01-21T20:42:51.257
> 
> 标签：php, object

我想在模板中使用不同的对象。在网站的不同部分创建不同的对象。

目前我的代码是

```
public function notify ($template, $info)
{
    ob_start();
    include $template; 
    $content = ob_get_clean();
    //... more further code
} 
```

如您所见， $info 参数。我不想在模板中使用 $info，但我打算使用 $photo、$admin 或传递给它的任何内容。

我用的像

```
// for feed
$user->notify('email_template_feed.php', $feed);

// for new photo - i would also like to use $user inside templates
$user->notify('email_template_photo.php', $photo); 
```

我怎样才能做到这一点？不能使用全局，因为是内部函数，并且函数在站点的不同位置/部分动态调用，可以进一步扩展。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:47:12.013

[你不能](https://stackoverflow.com/questions/4503443/original-variable-name-passed-to-function)。

**解决方案 1**

相反，您可以使用数组并提取其值：

```
public function notify ($__template, array $info)
{
    ob_start();
    extract($info);
    include $__template; 
    $content = ob_get_clean();
    //... more further code
} 
```

**示例 1**

如果你用以下方式调用它：

```
$user->notify('email_template_feed.php', array('feed' => $feed)); 
```

并在模板内`email_template_feed.php`：

```
...
<?=$feed?>
... 
```

它将打印：

```
...
FEED
... 
```

**解决方案 2**

您还可以将变量的名称作为第三个参数传递：

```
public function notify ($template, $info, $name)
{
    ob_start();
    $$name = $info;
    unset($info);
    include $template; 
    $content = ob_get_clean();
    //... more further code
} 
```

**示例 2**

然后您可以通过以下方式调用它：

```
$user->notify('email_template_feed.php', $feed, 'feed'); 
```

# php - 带有ajax内容的jquery单击功能

> ID：14446879
> 
> 赞同：-2
> 
> 时间：2013-01-21T20:42:55.817
> 
> 标签：php, jquery, ajax

我的最终目标是让 ajax 显示的内容可以点击，以将其值推送到文本框中。

现在我加载了ajax，但是当我点击它时，它不起作用。到目前为止，我已经为 jquery 分配了“a”标签，所以当它被点击时，它会将静态文本“works”放在 id=email-body 的 textarea 中。

```
$(document).ready(function() {

    // Expand Panel
    $('a').click(function(){ 
        $('#email-body').val($('#email-body').val()+'works');
    }); 

}); 
```

这适用于不属于 ajax 内容的标签，但不适用于 ajax 内容。我应该使用一个特殊的拉系统来获得 jquery 效果 ajax 内容吗？

静态文本和单击 a 标签也不是我真正想要的。

现在我的ajax正在做以下事情：

```
foreach($search_found as $search_row){
    $hint=$hint . '<a>'.ucwords($search_row['email_module_name']).'</a>';
}
echo $hint; 
```

有没有办法让我做到：

阿贾克斯：

```
<div class="module" value="'.ucwords($search_row['email_module_name']).'">
     '.ucwords($search_row['email_module_name']).'
</div> 
```

查询：

```
$(document).ready(function() {

    // Expand Panel
    $('.module').click(function(){ 
        $('#email-body').val($('#email-body').val()+'$this->value');
    }); 

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:45:31.130

您需要使用以下[`.on`](http://api.jquery.com/on/)功能：

```
$('div').on('click', '.module', function(){ 
    $('#email-body').val($('#email-body').val()+'$this->value');
}); 
```

这允许“点击”功能附加到通过 ajax 引入的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:47:12.183

您可以使用[`.on()`](http://api.jquery.com/on/)将事件绑定到当前和未来的元素。

```
$(document).on("click", "a", function(){ 
    $('#email-body').val($('#email-body').val()+'works');
}); 
```

或者，

```
$(document).on("click", ".module", function(){
  $('#email-body').val($('#email-body').val()+'$this->value');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T20:47:47.050

您想要的是委托事件，为此您可以使用[`.on()`](http://api.jquery.com/on/)

```
$(document).ready(function() {

    // Expand Panel
    $(documnet).on('click', 'a', function(){ 
        $('#email-body').val($('#email-body').val()+'works');
    }); 

}); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-21T20:48:43.693

```
$('.module').live('click', function(){ 
    $('#email-body').val($('#email-body').val()+'$this->value');
}); 
```

我想通了，然后回来看到有人发布了.on

我试过了，但没有用。起作用的是.live

# java - 以纳秒为单位获取日历时间

> ID：14446880
> 
> 赞同：3
> 
> 时间：2013-01-21T20:43:00.350
> 
> 标签：java, time, calendar

由于 Java 文档告诉我，不要`System.currentTimeMillis`用于比较，我开始使用`System.nanoTime`which 很好。
但是我遇到了一些问题，我必须比较过去的事件。

```
Calendar cal = Calendar.getInstance();
cal.add(Calendar.DAY_OF_MONTH, xyz);
cal.getTimeMillis(); 
```

可以很好地获取时间`milliseconds`，但是将其转换为`nanoseconds`（通过将其乘以 1000000）远不准确。

**如何以毫秒为单位获取过去事件的时间？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:46:53.710

Java 中的`Calendar`类不包含纳秒信息。所以你不能得到那个。

~~如果您需要该详细信息，您需要存储纳秒以`long`用于稍后要比较的事件。~~：你也不能这样做， nanoTime() 不是当前时间的表示，但你仍然可以存储它来评估旧进程的经过时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:48:08.250

您使用什么数据类型乘以 1,000,000 ？也许您应该使用 BigDecimal，这对您来说已经足够准确了。

# c# - 如何扩展实体类？

> ID：14446882
> 
> 赞同：1
> 
> 时间：2013-01-21T20:43:07.220
> 
> 标签：c#, entity-framework

我正在使用实体框架和 Mysql。我有每个表的实体类。

但我不知道如何将字段扩展到**未在 DB 中定义的**实体类。

例如）我有测试表，该表有 id、price 和 qty 字段。

我的实体类是这样的，

```
[Table('test')]
public class Test
{
  [Key]
  public int id {get; set;}
  public decimal price {get; set;}
  public int qty {get; set;}
} 
```

现在，我需要测试类中的小计字段。（由于某种原因，**我无法修改 DB**）

所以我尝试将 Test 类设为 Partial 类，

```
[Table('test')]
public partial class Test
{
  [Key]
  public int id {get; set;}
  public decimal price {get; set;}
  public int qty {get; set;}
}

public partial class Test 
{
  public decimal? subTotal {get; set;}
} 
```

然后我得到一个错误：它说，'字段列表'中的未知列'Extent1.subTotal''

有人知道，如何在不更改数据库结构的情况下将 subTotal 字段添加到 Test 类中？

请给我建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:50:23.660

将`NotMappedAttribute`用于您希望在模型中具有的任何属性，但不希望 Entity Framework 映射到您的数据库。

```
 [Table('test')]
    public class Test
    {
      [Key]
      public int id {get; set;}
      public decimal price {get; set;}
      public int qty {get; set;}
      [NotMapped]
      public decimal? subTotal {get; set;}
    } 
```

# android - 我们如何为上传到 Box 的图像生成缩略图？

> ID：14446885
> 
> 赞同：0
> 
> 时间：2013-01-21T20:43:14.990
> 
> 标签：android, box-api

我正在使用旧的 Box API 上传文件。

当我的用户使用我的 Android 应用程序将图像上传到其 Box 帐户中的文件夹时，他们抱怨没有为网站上的这些图像生成缩略图图像。如果他们使用 Box 应用程序上传图像，则生成良好。

我应该指出，图像没有损坏并且完全传输。如果下载，它们与之前上传的文件相同。所以问题是，当使用 API 上传图像时，不会生成缩略图。

我该如何解决它，所以它可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:51:56.297

刚刚发现，我可能应该在询问之前完成，这似乎是用新的 Box V2 API 修复的，我的应用程序的下一个版本将使用它。

所以使用 V2 API 将为我解决这个问题。

# c++ - 2 x "LNK2019: unresolved external symbol" 编译时的错误

> ID：14446887
> 
> 赞同：0
> 
> 时间：2013-01-21T20:43:23.983
> 
> 标签：c++, directx-9

当我尝试在 VS 2010 中编译时，出现以下两个链接错误。我确保我的包含和库设置在项目属性 > VC ++ 目录中是正确的，并且还检查以确保项目 > 链接器 > 输入具有 d3d9 .lib & d3dx9.lib 在其中。我还尝试在 D3DGraphics.h 中为上述两个库添加#pragma 注释，但无济于事:(

## 编译错误....

1>D3DGraphics.obj：错误 LNK2019：未解析的外部符号 _Direct3DCreate9@4 在函数“public：long **thiscall D3DGraphics::SetupD3D(struct HWND** *)”中引用 (?SetupD3D@D3DGraphics@@QAEJPAUHWND__@@@Z)

1>main.obj : 错误 LNK2019: 在函数“void __cdecl SetupFirework1(void) " (?SetupFirework1@@YAXXZ)

... : 致命错误 LNK1120: 2 unresolved externals

* * *

完整的程序结构如下...

## ***D3DGraphics.h***

```
#include <d3d9.h>   // necessary Direct3D libraries

// Global pointer to the Direct 3D device
extern IDirect3DDevice9*    g_pd3dDevice; 

// Used to create the Direct3D object
extern IDirect3D9*          g_pD3D; 

class D3DGraphics
{
public:

// Global pointer to the Direct3D object
IDirect3D9*         g_pD3D; 

// Global pointer to the Direct 3D device
IDirect3DDevice9*   g_pd3dDevice; 

//The class constructor - executes whenever an instance is created.
//D3DGraphics() { /* does nothing */ }

// Method to setup D3D parameters
HRESULT SetupD3D ( HWND hWnd );  

// Destructor. 
// A method that executes when an instance is destroyed.
~D3DGraphics(); 

void Render();

void Cleanup(); // close Direct3D and release resources

}; 
```

* * *

## ***D3DGraphics.cpp***

```
#include "D3DGraphics.h"

// Global pointer to the Direct 3D device
IDirect3DDevice9*   g_pd3dDevice; 

// Used to create the Direct3D object
IDirect3D9*     g_pD3D; 

//// Constructor code
//D3DGraphics :: D3DGraphics()
//{
//
//}

// TYPE Classname :: MethodName
HRESULT D3DGraphics :: SetupD3D ( HWND hWnd)
{

// Create a D3D object called g_pD3D, return a fail message if this can't be done.
if (NULL == (g_pD3D = Direct3DCreate9(D3D_SDK_VERSION))) return E_FAIL;

/*  *** Setup a data structure of paramteres to create the Direct3D device *** */

// data structure is called d3dpp
D3DPRESENT_PARAMETERS d3dpp;

// used to clear all data from the structure to ensure no spurious values will be used
ZeroMemory( &d3dpp,sizeof( d3dpp ) );

// application will be windowed
d3dpp.Windowed = TRUE;                      

// back to front buffer behavior - DISCARD = random data used for error checking
d3dpp.SwapEffect = D3DSWAPEFFECT_DISCARD; 

// back buffer format - UNKNOWN = use current display resolution to retain consistency
d3dpp.BackBufferFormat = D3DFMT_UNKNOWN;    

// D3D device to create and manage depth and stencil buffer automatically
d3dpp.EnableAutoDepthStencil = TRUE;    

// format of the surfaces which hold the depth & stencil buffers - D16 = 16Bit colours
d3dpp.AutoDepthStencilFormat = D3DFMT_D16;  

    ////////////* ***END data structure creation*** *////////////

/*  *** Create the Direct3D Device using the defined parameters from the data strucutre d3dpp *** */

// Create the Direct3D Device and return a pointer to it, or return E_FAIL if it can't be created
if (FAILED(g_pD3D -> CreateDevice(  D3DADAPTER_DEFAULT,
                                    D3DDEVTYPE_HAL,
                                    hWnd,
                                    D3DCREATE_SOFTWARE_VERTEXPROCESSING,
                                    &d3dpp,
                                    &g_pd3dDevice)))

{
    return E_FAIL;
}

// Enable the Z buffer
g_pd3dDevice -> SetRenderState(D3DRS_ZENABLE, TRUE);

return S_OK;
}

// Destructor code
D3DGraphics :: ~D3DGraphics()   
{
//???
}

void D3DGraphics :: Cleanup()
{
//release the D3DDevice creation resources
if (g_pD3D != NULL) g_pD3D -> Release();

//release the rendering device creation resources
if (g_pd3dDevice !=NULL) g_pd3dDevice -> Release();
// Render the frame to the back buffer.
}

/*  *** The Render cycle for drawing graphics on the screen *** */

void D3DGraphics :: Render()
{
// black background colour
DWORD BackgroundColour = 0x0000000;    

// Clear the contents of the backbuffer & Zbuffer and set its colour.
g_pd3dDevice -> Clear(0,                                   // 0 rectangles to be     cleared
                      NULL,                                // no array of rectangle coordinates
                      D3DCLEAR_TARGET | D3DCLEAR_ZBUFFER,  // which buffers should be cleared
                      BackgroundColour,                    // the background colour to use, defined as black 0x0000000
                      1.0f,                                // Z buffer value
                      0);                                  // stencil buffer value

// Begin rendering the scene.
if (SUCCEEDED(g_pd3dDevice -> BeginScene()))
{

    /// ...GRAPHICS ARE DRAWN HERE...///

    // end the rendering
    g_pd3dDevice -> EndScene();
}

// Present the backbuffer to the display.
g_pd3dDevice -> Present(NULL, NULL, NULL, NULL);
}
        ////////////*  *** END The Render cycle *** *//////////// 
```

* * *

## ***烟花.h***

```
#include "D3DGraphics.h"
#include <d3dx9math.h>  // required in this file for D3DXVECTOR3

// class for a single firework spark
class SPARKCLASS
{
public:
    SPARKCLASS();

    D3DXVECTOR3 Position;
    float       XVelocity, YVelocity, ZVelocity;
    float       Time;
    int         LifeTime;
};

// max number of sparks that can exist in the system
const int MaxNumberOfSparks = 500;

// class for the firework particle system
class FIREWORKCLASS
{
    public:
    FIREWORKCLASS (LPDIRECT3DDEVICE9);

    void     Update();
    void     Render();

    float    LaunchAngle;
    float    LaunchVelocity;
    float    ParticleSize;

    int      Lifetime;
    int      StartInterval, StartCounter, NumberToStart;
    float    TimeIncrement;
    D3DCOLOR SparkColour;

    D3DXVECTOR3  Origin;

    private:
    //array of sparks
    SPARKCLASS Sparks[MaxNumberOfSparks];

    //starts a new particle
    void StartParticle(int);

    //counter for the number of sparks that are alive
    int SparksAlive;

    //vertex buffer for the points
    LPDIRECT3DVERTEXBUFFER9     pPointBuffer;

    //the Direct3D Deice onto which sparks will be rendered 
    LPDIRECT3DDEVICE9           pRenderTarget;

};

    struct POINTVERTEX
    {
        D3DXVECTOR3  Position;
        D3DCOLOR    Colour;
    };

    // the structure of a vertex in our vertex buffer
#define D3DFVF_POINTVERTEX  (D3DFVF_XYZ  |  D3DFVF_DIFFUSE) 
```

* * *

## ***烟花.cpp***

```
#include "Fireworks.h"

 void FIREWORKCLASS :: StartParticle(int P)
{
 // set this spark's lifetime to the maximum
 Sparks[P].LifeTime = Lifetime;
 Sparks[P].Time = 0.0f;

Sparks[P].Position.x = 0;
Sparks[P].Position.y = 0;
Sparks[P].Position.z = 0;

// select a random angle around a circle
float DirectionAngle = (float)rand()/(180/D3DX_PI);

//calculate the vertical component of velocity
Sparks[P].YVelocity = LaunchVelocity
                      * (float)sin(LaunchAngle);

//calculate the horizontal components of velocity - X & Z
Sparks[P].XVelocity = LaunchVelocity
                     * (float)sin(LaunchAngle)
                     * (float)cos(DirectionAngle);

Sparks[P].ZVelocity = LaunchVelocity
                     * (float)sin(LaunchAngle)
                     * (float)cos(DirectionAngle);

//since another spark now exists, increment the spark counter
SparksAlive++;
 }

void FIREWORKCLASS :: Render()
    {
        //enable point sprites and set the size of the point
        pRenderTarget -> SetRenderState(D3DRS_POINTSPRITEENABLE, true);
        pRenderTarget -> SetRenderState(D3DRS_POINTSCALEENABLE, true);

        pRenderTarget -> SetRenderTarget(D3DRS_LIGHTING, false);

        //scale the points according to distance
        pRenderTarget -> SetRenderState(D3DRS_POINTSIZE,
                                FtoDW(ParticleSize));
        pRenderTarget -> SetRenderState(D3DRS_POINTSIZE_MIN, FtoDW(0.0f));
        pRenderTarget -> SetRenderState(D3DRS_POINTSCALE_A, FtoDW(0.0f));
        pRenderTarget -> SetRenderState(D3DRS_POINTSCALE_B, FtoDW(0.0f));
        pRenderTarget -> SetRenderState(D3DRS_POINTSCALE_C, FtoDW(0.0f));

        //render the contents of the vertex buffer
        pRenderTarget -> SetStreamSource(0, pPointBuffer, 0,
                            sizeof(POINTVERTEX));

        pRenderTarget -> SetFVF(D3DFVF_POINTVERTEX);
        pRenderTarget -> DrawPrimitive(D3DPT_POINTLIST, 0, 0);  // 0, ?? 

        //reset the render states
        pRenderTarget -> SetRenderState(D3DRS_POINTSPRITEENABLE, false);
        pRenderTarget -> SetRenderState(D3DRS_POINTSCALEENABLE, false);
        pRenderTarget -> SetRenderState(D3DRS_LIGHTING, true);

    } 
```

* * *

## *** Main.cpp ***

```
#define D3D_DEBUG_INFO  // Enable debugging information
#include "Windows.h"
#include "Fireworks.h"

//global pointer to Firework1 object
FIREWORKCLASS *g_Firework1 = NULL;

void SetupFirework1()
{
g_Firework1 = new FIREWORKCLASS(g_pd3dDevice);

g_Firework1 -> Origin.x = 0.0f;
g_Firework1 -> Origin.x = 0.0f;
g_Firework1 -> Origin.x = 0.0f;

g_Firework1 -> StartInterval = 10;
g_Firework1 -> StartCounter  = 10;

g_Firework1 -> LaunchAngle    = D3DXToRadian(80);
g_Firework1 -> LaunchVelocity = 40.0f;

g_Firework1 -> TimeIncrement  = 0.04f;
g_Firework1 -> Lifetime       = 200;

g_Firework1 -> NumberToStart  = 8;
g_Firework1 -> ParticleSize   = 2.0f;
g_Firework1 -> SparkColour   = 0x00FFE000; // yellow

  }

// The window's message handling function.
LRESULT WINAPI MsgProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
switch (msg)
{
    case WM_DESTROY:
    {

        // The user has clicked on the 'close' button on the window's title bar.
        // Send a 'WM_QUIT' message to the application to close it down.
        PostQuitMessage(0);
        return 0;
    }
}

return DefWindowProc(hWnd, msg, wParam, lParam);
}

// WinMain() - The application's entry point.
// This sort of procedure is mostly standard, and could be used in most
// DirectX applications.
int WINAPI WinMain(HINSTANCE hInst, HINSTANCE, LPSTR, int)
{

/*  ***Create the application window*** */

// Register the window class
WNDCLASSEX wc = {sizeof(WNDCLASSEX), CS_CLASSDC, MsgProc, 0L, 0L,
                 GetModuleHandle(NULL), NULL, NULL, NULL, NULL,
                 "Blank", NULL};
RegisterClassEx(&wc);

// Create the application's window
HWND hWnd = CreateWindow( "Blank", "---Fireworks---",
                          WS_OVERLAPPEDWINDOW, 100, 100, 800, 800,  // ?, ?, size(x), size(y) 
                          GetDesktopWindow(), NULL, wc.hInstance, NULL);
/* ***END application window creation*** */

// Create an instance of the D3DGraphics class called D3D
D3DGraphics D3D;

// Initialize Direct3D
if (SUCCEEDED(D3D.SetupD3D(hWnd)))
{
    // Show the window
    ShowWindow(hWnd, SW_SHOWDEFAULT);
    UpdateWindow(hWnd);

    // Enter the message loop
    MSG msg;
    ZeroMemory(&msg, sizeof(msg));

    // Respond to messages until a 'WM_QUIT' message is received.
    while (msg.message != WM_QUIT)
    {
        if (PeekMessage(&msg, NULL, 0U, 0U, PM_REMOVE))
        {
            TranslateMessage(&msg);
            DispatchMessage(&msg);
        }
        else
//          g_Firework1 -> Update();    // update Firework1 particles
            D3D.Render();           // render the scene
    }
    // Execute the class destructor to clear any resources that 
    // D3DGraphics class has created/used.
    D3D.Cleanup();  
}

UnregisterClass("Blank", wc.hInstance);
return 0;
} 
```

# sql - 结合案例陈述

> ID：14446889
> 
> 赞同：-2
> 
> 时间：2013-01-21T20:43:41.307
> 
> 标签：sql, sql-server, ms-access, case

> **可能重复：**
> [将访问代码转换为 SQL](https://stackoverflow.com/questions/14446507/converting-access-code-to-sql)

我有一个使用`IIF`具有 2 合 1 的语句的访问代码，我正在尝试将它们重写为 SQL 作为`CASE`语句，但我遇到了一些减速带。

```
Sum(IIf([RRDD] Not Like "12*" 
    And [RRDD] Not Like "13*" 
    And [RRDD] Not Like "16*" 
    And [RRDD] Not Like "17*" 
    And [RRDD] Not Like "2706" 
    And [RRDD] Not Like "2707" 
    And [RRDD] Not Like "2331",
    CDbl([2011 Total])*IIf(IsNumeric([Dur_In_Hours]),
    CDbl([Dur_In_Hours]),0),0)) AS SP_DOM_COST 
```

第一个`IIF`乘以第二个 IIF 是我感到困惑的地方，我需要它是 SQL 格式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:59:29.027

您可以简化 SQL Server 和 Access 中的逻辑。这是 SQL Server 版本：

```
Sum(case when left([RRDD], 2) not in ('12', '13', '16', '17') and
              RRDD not in ('2706', '2707', '2331') and
              isnumeric(dur_in_hours) = 1
         then [2011 Total] * cast(Dur_In_Hours as float)
         else 0.0
    end) AS SP_DOM_COST 
```

在这两个系统中，`like`将产生比通过常量列表搜索更多的开销。演员表是安全的，因为它在一个`where`子句中（我还在上面的参考资料中添加了一个答案，因为答案不正确）。

替换为`iif`一般`case`，虽然此功能已添加到 SQL Server 2012 中（也就是说，我有点希望没有人使用它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T21:25:08.800

```
Sum(case when [RRDD] Not Like '12%' 
And [RRDD] Not Like '13%' 
And [RRDD] Not Like '16%' 
And [RRDD] Not Like '17%' 
And [RRDD] Not Like '2706' 
And [RRDD] Not Like '2707' 
And [RRDD] Not Like '2331'
then cast([2011 Total] as float) * 
    case when ISNUMERIC([Dur_In_Hours]) = 1
        then cast([Dur_In_Hours] as float) 
        else 0 
    end
else 0 
end) AS SP_DOM_COST 
```

虽然`IsNUmeric`是一个有效的 TSQL 函数，但它[显然](https://stackoverflow.com/questions/7567804/sql-isnumeric-not-working) [不是很](https://stackoverflow.com/questions/7400318/why-does-isnumeric-return-1/7400383#7400383) [好玩](http://www.simple-talk.com/blogs/2011/01/13/isnumeric-broken-only-up-to-a-point/)。如果您得到奇怪的结果，请查看其他一些[现有](https://stackoverflow.com/questions/10517777/t-sql-determine-if-value-is-integer)的解决方法。不过，根据您的数据，您可能会没事。

# c# - 显示 MessageBox 可防止 IsChecked 触发

> ID：14446890
> 
> 赞同：0
> 
> 时间：2013-01-21T20:43:44.927
> 
> 标签：c#, binding, checkbox

我有一些`TextBoxes`绑定到单个`CheckBox`.

这是与之相关的逻辑：

*   如果`Checkbox`选中，它将覆盖关联中的任何现有文本`TextBoxes`并将其设为“0” **++**
*   如果所有的`TextBoxes`得分都是“0”，则`CheckBox`应该禁用并检查。
*   如果其中任何一个`TextBoxes`从“0”更改，它将变为启用且未选中。

**++** **注意：* * 需要注意的是，如果 的`TextBox`值为“C”。

`TextBoxes`好的，所以我遇到的问题是当关联项之一的值为“C”时实施上述警告。我希望发生的是循环`TextBoxes`并检查是否有任何得分为“C”。如果找到，则向用户显示警告消息，确认他们是否要继续。如果选择“是”，所有相关分数将被覆盖为“0”。如果选择否，`Checked`则应取消该事件。

为此，我为`CheckBox.PreviewMouseDown`和`CheckBox.Checked`事件添加了事件侦听器。这是我的`CheckBox.PreviewMouseDown`事件监听器的代码：

```
private void NormalCheckBoxControl_PreviewMouseDown(object sender, MouseButtonEventArgs e)
{
    CheckBox normalCheckBox = (CheckBox)sender;
    bool showCorrespondingScoreWarningMsg = false;

    //Get a Row to loop through the AssociatedAdqScore controls for each
    ScoreControl tempScoreControl = new ScoreControl();

    foreach (ScoreControl score in this.ScoreControlList)
    {
        if (score.ScoreTextBox.Text == "C")
        {
            showCorrespondingScoreWarningMsg = true;
        }
    }

    if (showCorrespondingScoreWarningMsg)
    {
        MessageBoxResult msgResult = InformationBox.Show("WARNING: Proceeding will remove corresponding 'C' scores.  Continue?", "Continue?", ButtonStyle.YesNo, IconStyle.Question);

        if (msgResult == MessageBoxResult.No)
        {
            e.Handled = true;
        }
    }
} 
```

This works if the user selects 'No,' however the issue I'm having is that when choosing 'Yes,' the `CheckBox.Checked`event still does not get fired. 我试图手动设置`CheckBox.IsChecked = true;`if `if (msgResult == MessageBoxResult.Yes)`，但这会破坏绑定，因此这不是一个可行的解决方案。

如果用户选择“是” ，我有什么办法可以解决此问题并继续该`NormalCheckBoxControl_Checked(object sender, RoutedEventArgs e)`事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:08:18.097

我不知道“已检查”事件，尽管有一个`CheckedChanged`事件和一个`CheckStateChanged`事件。我习惯了 .NET 2.0，所以这可能是 3.0+ 的东西。无论哪种方式，我认为我已经在这样的实例中手动调用了事件处理程序，没有任何问题。

您可以使用 null 参数（或已知对象和新事件参数）手动调用事件处理程序：

```
NormalCheckBoxControl_Checked(null, null); 
```

或者

```
NormalCheckBoxControl_Checked(new object, new EventArgs()); 
```

这应该手动启动您的例程，除非您需要它们，否则提供虚拟参数确实没有问题。无需引发事件并等待它冒泡，只需调用例程即可。

当然，如果有其他依赖于事件冒泡的例程，或者如果您有多个处理同一事件的处理程序，那么它可能会给您带来问题。请注意这一点，以防万一。

# jsf - 依赖于用户选择的 JSP 命令按钮动作

> ID：14446898
> 
> 赞同：0
> 
> 时间：2013-01-21T20:44:21.237
> 
> 标签：jsf, selectonemenu

我有一个代表计算器的 bean 类。该类公开了 4 个方法：加法、减法、乘法和除法。

对于前端，我正在编写一个 JSP 页面。此页面包含两个文本输入框（一个用于 x，一个用于 y）。我有一个下拉菜单，用户在其中选择操作，然后有一个执行所选操作的*计算命令按钮。*

```
<h:form>
    <h:inputText value="#{calcBean.x}"></h:inputText>
    <h:inputText value="#{calcBean.y}"></h:inputText>
    <h:selectOneMenu>
        <f:selectItem itemValue="Add"></f:selectItem>
        <f:selectItem itemValue="Subtract"></f:selectItem>
        <f:selectItem itemValue="Multiply"></f:selectItem>
        <f:selectItem itemValue="Divide"></f:selectItem>
    </h:selectOneMenu>
    <h:commandButton value="Calculate" action="@SEE COMMENT">
    <%-- TODO the action of this command button needs to change depending on --%>
    <%-- the user selection. For example: If the user selects "Add" the action --%>
    <%-- needs to be #{calcBean.add} --%>
    </h:commandButton>
</h:form> 
```

我遇到的问题是我不知道如何根据用户选择更改命令按钮的操作*。*

我可以用四个不同的命令按钮来做到这一点，但这不是一个优雅的解决方案：

```
<h:form>
    <h:inputText value="#{calcBean.x}"></h:inputText>
    <h:inputText value="#{calcBean.y}"></h:inputText>
    <br/>
    <h:commandButton value="Add" action="#{calcBean.add}"></h:commandButton>
    <h:commandButton value="Subtract" action="#{calcBean.subtract}"></h:commandButton>
    <h:commandButton value="Multiply" action="#{calcBean.multiply}"></h:commandButton>
    <h:commandButton value="Divide" action="#{calcBean.divide}"></h:commandButton>
</h:form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:27:00.320

您可以通过将用户的选择绑定到支持 bean 中的属性并使用该选定值作为您的操作方法中的条件来执行正确的计算来做到这一点。

```
<h:selectOneMenu value=#{calcBean.calculationType}>
    <f:selectItem itemValue="Add"></f:selectItem>
    <f:selectItem itemValue="Subtract"></f:selectItem>
    <f:selectItem itemValue="Multiply"></f:selectItem>
    <f:selectItem itemValue="Divide"></f:selectItem>
</h:selectOneMenu>

<h:commandButton value="Add" action="#{calcBean.doSelectedCalculation}"></h:commandButton> 
```

在您的单一独特操作方法中，根据所选的计算类型，您可以对给定的 x 和 y 值进行操作。

```
public void doSelectedCalculation()
{
     if(calculationType.equals("Add"))
     {
          result = x + y;
     }
     else if(calculationType.equals("Subtract"))
     { 
          result = x - y;
     }
     ...

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:33:45.283

JSF-ish 方式是：

1.  将您与托管 bean 中的属性绑定`<h:selectOneMenu>`，比方说`int selectedOption`.

2.  `<f:selectItem>`设置向用户显示的选项 ( ) 的值。它可以是 1、2、3 和 4（仅作为基本示例）

3.  `calculate`从托管 bean 中公开一个方法。此方法将在您的`<h:commandButton>`操作属性中。这个方法会使用`selectedOption`属性来知道要使用什么操作。

有了这些信息，结果将是：

JSF 代码

```
<h:form>
    <h:inputText value="#{calcBean.x}" />
    <h:inputText value="#{calcBean.y}" />
    <h:selectOneMenu value="#{calcBean.selectedOption}">
        <f:selectItem itemLabel="Add" itemValue="1" />
        <f:selectItem itemLabel="Subtract" itemValue="2" />
        <f:selectItem itemLabel="Multiply" itemValue="3" />
        <f:selectItem itemLabel="Divide" itemValue="4" />
    </h:selectOneMenu>
    <h:commandButton value="Calculate" action="#{calcBean.calculate}" />
</h:form>
Result: <h:outputText value="#{calcBean.result}" /> 
```

CalcBean 代码

```
public class CalcBean {

    private int x;
    private int y;
    private int selectedOption;
    private double result;
    //constructor...
    //getters and setters...

    public String calculate() {
        result = 0;
        switch(selectedOption) {
            case 1:
                result = x + y;
                break;
            //write the other cases...
        }
        return null;
    }
} 
```

上面的代码对应 JSF 1.2。如果您使用的是 JSF 2.x，那么您应该停止使用 JSP 并转移到 Facelets，如[JSF wiki 中所述](https://stackoverflow.com/tags/jsf/info)。恕我直言，学习 JSF 2 而不是 JSF 1.x 会更好。

# jquery - YouTube IFrame API 播放/停止不起作用

> ID：14446907
> 
> 赞同：2
> 
> 时间：2013-01-21T20:45:06.180
> 
> 标签：jquery, html, youtube-api

我是 Jquery 的新手。我正在尝试使用两个按钮嵌入单个视频：播放和停止。我注意到，如果我将代码的 videoid 变量替换为真实的视频 id（例如 CkPv2jP9KeY）直接放在 html 内容上，播放和停止按钮就会起作用。到目前为止，我有这个：

```
<!DOCTYPE html>
<html lang="es">
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>   
<script type="text/javascript" src="http://www.youtube.com/player_api"></script>
<script>
var player;
function onYouTubeIframeAPIReady() {player = new YT.Player('player');}
if(window.opera){
    addEventListener('load', onYouTubeIframeAPIReady, false);
}
</script>
 </head>
<body>
<script>
$(document).ready(function(){
    $.getJSON("https://gdata.youtube.com/feeds/api/users/diasporaduo/uploads?v=2&alt=jsonc",function(json){
        videoid = json.data.items[0].id;
        $("#video").append('<iframe id="player" width="560" height="349" frameborder="0" src="http://www.youtube.com/embed/'+ videoid +'?rel=0&wmode=Opaque&enablejsapi=1"></iframe>');
    });
 });
</script>
<div id="video"></div>
<a href="javascript: void(0)" onclick="player.playVideo(); return false">play</a><br>
<a href="javascript: void(0)" onclick="player.stopVideo(); return false">stop</a>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:11:03.103

您可以像这样重新排列您的代码：

1.  包括`https://www.youtube.com/player_api`
2.  创建一个空的 div 元素，最好与视频大小相同
3.  实现执行`onYouTubeIframeAPIReady`以下操作：
    *   创建一个空白的 YouTube iframe 播放器
    *   `onReady`在事件中加载视频

笔记：

*   从 GData 中检索 JSON 数据不需要 jQuery。您可以简单地创建一个`<script>`with src = `https://gdata...&alt=jsonc&callback=functionThatCallsCueVideo`
*   可以重新排列代码。例如，您可以先加载 JSON，然后调用`player = new YT.Player({videoId: 'u1zgFlCw8Aw'})`

# HTML：

```
<!-- this could could inside head -->
<script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript" src="https://www.youtube.com/player_api"></script>

<!-- this goes in body -->
<div id="video"></div>
<a href="javascript: void(0)" onclick="player.playVideo(); return false">play</a><br>
<a href="javascript: void(0)" onclick="player.stopVideo(); return false">stop</a> 
```

# JavaScript：

```
var player;
function onYouTubeIframeAPIReady() {
    player = new YT.Player('video', {
        width: '560',
        height: '349',
        events: {
            'onReady': function () {
                $.getJSON("https://gdata.youtube.com/feeds/api/users/diasporaduo/uploads?v=2&alt=jsonc", function (json) {
                    videoid = json.data.items[0].id;
                    player.cueVideoById(videoid);
                });
            }
        }
    });
} 
```

# [演示](https://jsfiddle.net/salman/e5T8U/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T14:18:49.867

感谢 Salman A。这是他回复的 Jquery 工作版本：

```
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <title>Title</title>
     <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="css5/reset.css" rel="stylesheet" />
    <link href="css5/main.css" rel="stylesheet" />

     <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>   
     <script type="text/javascript" src="http://www.youtube.com/player_api"></script>

</head>
<body>
<script>
var player;

$(document).ready(function(){
    window.onYouTubeIframeAPIReady = function() {
        player = new YT.Player('video', {
          events: {
            'onReady': function () {
                $.getJSON("http://gdata.youtube.com/feeds/api/users/diasporaduo/uploads?v=2&alt=jsonc", function (json) {
                    videoid = json.data.items[0].id;
                    player.cueVideoById(videoid);
                });
            }
        }
    });
}
});

</script>

<div id="video"></div>

<a href="javascript: void(0)" onclick="player.playVideo(); return false">play</a><br>
<a href="javascript: void(0)" onclick="player.stopVideo(); return false">stop</a>

</body>
</html> 
```

# sql - 复杂外键

> ID：14446908
> 
> 赞同：1
> 
> 时间：2013-01-21T20:45:08.623
> 
> 标签：sql, sql-server, tsql, foreign-keys, check-constraints

我有一个类似的表：

```
 CREATE TABLE [dbo].[Table1](
[Option_PK] [bigint] IDENTITY(1,1) NOT NULL,
[Option_1] [varchar](10) NULL,
[Option_2] [varchar](10) NULL,
[Option_3] [varchar](10) NULL) 
```

我正在尝试做的是添加一个表驱动的约束，它可以有效地限制每列的有效条目。例如，如果我制作了第二张桌子：

```
 CREATE TABLE [dbo].[Table2](
    [FK_Name] [varchar](10) NOT NULL,
    [FK_Value] [varchar](10) NOT NULL) 
```

然后我想检查存储在 Table1 列“Option_1”中的值是否存在于 Table2 列“FK_Value”中，其中“FK_Name”的值为“Option_1”。

这可以通过支票或 FK 实现吗？

** 编辑以使列数据类型匹配；我手动输入了示例表声明和错字，这与问题无关。我知道如何进行 FK，但我不知道如何像我所描述的那样进行 FK。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:31:30.487

你能不能只有 3 张桌子和 3 个 FK？
FK 需要匹配类型。

```
CREATE TABLE [dbo].[Option1]([FK_Value] [nchar](10) NOT NULL)
CONSTRAINT [PK_Option1] PRIMARY KEY CLUSTERED ([FK_Value] ASC)

ALTER TABLE [dbo].[Table1]  WITH CHECK ADD  CONSTRAINT [FK_Table1_Option1] FOREIGN KEY([Option_1])
REFERENCES [dbo].[Table2] ([FK_Value])
GO 
```

或者你可以有一列 Option1 默认为 option1
我尝试在 Option1 的值中硬编码但不会去。

```
ALTER TABLE [dbo].[FKtest1]  WITH CHECK ADD  CONSTRAINT [FK_FKtest1_FKtest1] FOREIGN KEY([Option1],[ValueFK])
REFERENCES [dbo].[FKtest1FK] ([PKoption],[PKvalue])
GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-01T11:53:26.507

```
CREATE TABLE [dbo].[Table1](
   [Option_PK] [bigint] IDENTITY(1,1) NOT NULL,
   [Option_1] [varchar](10) NULL,
   [Option_1_FK] [varchar](8) NOT NULL DEFAULT 'OPTION_1',
   [Option_2] [varchar](10) NULL,
   [Option_2_FK] [varchar](8) NOT NULL DEFAULT 'OPTION_2',
   [Option_3] [varchar](10) NULL,
   [Option_3_FK] [varchar](8) NOT NULL DEFAULT 'OPTION_3'
)

CREATE TABLE [dbo].[Options](
   [FK_Name] [nchar](8) NOT NULL,
   [FK_Value] [nchar](10) NOT NULL,
   CONSTRAINT [PK_Option1] PRIMARY KEY CLUSTERED ([FK_Name], [FK_Value] ASC)
)

ALTER TABLE [dbo].[Table1] WITH CHECK ADD 
   CONSTRAINT [FK_Table1_Option1] FOREIGN KEY([Option_1], [Option_1_FK) REFERENCES [dbo].[Options] ([[FK_Value], [FK_Name])
   CONSTRAINT [FK_Table1_Option2] FOREIGN KEY([Option_2], [Option_2_FK) REFERENCES [dbo].[Options] ([[FK_Value], [FK_Name])
   CONSTRAINT [FK_Table1_Option3] FOREIGN KEY([Option_3], [Option_3_FK) REFERENCES [dbo].[Options] ([[FK_Value], [FK_Name])
GO 
```

这是未经测试的，未标准化的和丑陋的。您可能应该添加约束以确保 的值`Option_X_FK`不会改变。实际上，这是 T-SQL，您可能可以为此使用计算列，但我不确定是否允许将它们包含在外键中。

# sql - pgSQL上的括号错误

> ID：14446909
> 
> 赞同：0
> 
> 时间：2013-01-21T20:45:14.500
> 
> 标签：sql, postgresql

使用 phpPgAdmin，我尝试在我的数据库中创建一个表。但是在生成代码后出现错误。

SQL错误：

```
ERROR:  syntax error at or near "(" at character 91

CREATE TABLE "public"."main_products_common_dimensions" ("id" SERIAL, "product_id" integer(3) NOT NULL, "h_ft" character varying(15), "h_in" character varying(15), "w_ft" character varying(15), PRIMARY KEY ("id")) WITHOUT OIDS 
```

括号有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:53:19.487

问题 - 您无法指定`integer`类型的精度，因此`integer(3)`类型无效。使用`numeric(3)`还是简单的`integer`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:53:08.973

没有`integer(3)`：postgresql`integer`总是 4 个字节，有符号。

# xslt - 从数据中提取字符串部分

> ID：14446912
> 
> 赞同：0
> 
> 时间：2013-01-21T20:45:20.100
> 
> 标签：xslt, xpath

需要额外的部分字符串。假设我可以访问“日期”并获得输出 21.01.2013 现在我不想拥有“.2013”​​。我尝试了这些行：

```
<xsl:value-of select="date"/>  

<xsl:variable name="bdate">  
    <xsl:value-of select="date"/>  
</xsl:variable>  

<p>Birthday: <xsl:copy-of substring($bdate,1,5) /></p><br/> 
```

第一行只有效，所有行最后一行的任何变化都会引发错误。但有一个解决方案，我敢肯定。任何人都可以帮助它.. 最后一行会是什么样子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T20:49:24.540

```
<xsl:value-of select="substring($bdate,1,5)" /> 
```

应该可以工作（XSLT 必须是格式良好的 XML）

# java - 多个类扩展应用程序

> ID：14446915
> 
> 赞同：11
> 
> 时间：2013-01-21T20:45:30.870
> 
> 标签：java, android

# 两个类扩展应用程序

*   我在 Manifest 中注册并用作 an 的一类`Application`是
*   第二节课是我的公用事业课。它执行大量 I/O 并有一些辅助方法。对于 I/O，您需要上下文（getAssets 等），所以我不情愿地扩展了 Application.

***笔记：***

> 一切正常。

***我的问题：***

使用多个应用程序类有什么缺点吗？这甚至被建议吗？

**一些想法：**

*   如果我在两个类中都定义了 onCreate 和其他回调方法，会发生什么？
*   我如何在清单中注册它们？ETC

PS：我知道我可以在第二类中使用一个字段来存储上下文。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T20:50:01.690

我认为根本不建议这样做，因为 Application 上只能有一个实例（因此只有一个类）。

我对真正起作用的东西非常怀疑。您正在谈论实用程序类，所以也许您正在使用运行良好的静态方法。但是你应该使用你的调试器，而且我几乎可以肯定你会发现你的一个类永远不会被实例化。

顺便说一句，官方文档指出：

> " 通常不需要继承 Application。在大多数情况下，静态单例可以以更模块化的方式提供相同的功能。如果您的单例需要全局上下文（例如注册广播接收器），检索它的函数可以是给定一个 Context，它在第一次构造单例时在内部使用 Context.getApplicationContext()。"

# ios - 使用 CGContextRef 设置上下文

> ID：14446917
> 
> 赞同：0
> 
> 时间：2013-01-21T20:45:34.760
> 
> 标签：ios

> **可能重复：**
> [绘制形状 iOS](https://stackoverflow.com/questions/14445682/drawing-shape-ios)
> [CGContextRef、CGPoint 和 CGSize](https://stackoverflow.com/questions/14446456/cgcontextref-cgpoint-and-cgsize)

我正在尝试使用必须包含 CGContextRef、CGPoint 和 CGSize 的当前方法：

```
CGPoint p1 = {10, 10};

CGSize size;

CGContextRef context = UIGraphicsGetCurrentContext();

[self drawArrowWithContext:context atPoint:p1 withSize:size lineWidth:400 arrowHeight:400]; 
```

当我运行应用程序时，我收到此错误：

1 月 21 日 21:41:56 Alexs-ipad Splash-it[1497]：CGContextDrawPath：无效上下文 0x0

问题必须在上下文中，但我在互联网上的任何地方都找不到问题的解决方案。整个代码应该调用一个绘制箭头的方法。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:48:14.660

为了返回有效的上下文，您必须在适当的区域。

这基本上意味着需要此代码，`drawRect:`或者您需要使用创建图像上下文`UIGraphicsBeginImageContext`

**更新：DrawRect：**

这`drawRect:`是为每个 UIView 调用的特殊方法，它为您提供使用 Core Graphics 进行自定义绘图的访问点。最常见的用途是在您的情况下创建一个自定义 UIView 对象`ArrowView`。然后，您将`drawRect:`使用您的代码覆盖。

```
- (void)drawRect:(CGRect)rect
{
    CGPoint p1 = {10, 10};

    CGSize size;

    CGContextRef context = UIGraphicsGetCurrentContext();

    [self drawArrowWithContext:context atPoint:p1 withSize:size lineWidth:400 arrowHeight:400];
} 
```

**更新：图像上下文**

使用自定义 Core Graphics 绘图的第二种方法是创建一个 imageContext 然后获取其结果。

因此，您首先要创建一个图像上下文，运行您的绘图代码，然后将其转换为可以添加到现有视图中的 UIImage。

```
UIGraphicsBeginImageContext(CGSizeMake(400.0, 400.0));

CGPoint p1 = {10, 10};

CGSize size;

CGContextRef context = UIGraphicsGetCurrentContext();

[self drawArrowWithContext:context atPoint:p1 withSize:size lineWidth:400 arrowHeight:400];

// converts your context into a UIImage
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

// Adds that image into an imageView and sticks it on the screen.
UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
[self.view addSubview:imageView]; 
```

# asp.net-mvc-4 - ASP.NET Entity Framework 可以自动生成数据注解吗？

> ID：14446929
> 
> 赞同：4
> 
> 时间：2013-01-21T20:46:25.023
> 
> 标签：asp.net-mvc-4

我的团队正在使用数据库优先的方法在 ASP.NET MVC 4 中编写一个大型商业网站。有谁知道是否可以根据数据库模式自动生成数据注释？当框架应该知道数据库列的属性并使其成为它生成的 POCO 类的一部分时，必须手动编写包含数据注释的“伙伴”元数据类似乎是多余的。任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T17:06:21.540

1) 该框架在基于表结构推断数据注释方面做得很好，但它们并不完美。

2) 可悲的是，当您想要自定义的不仅仅是框架时，您就会被 Buddy 类所困。它们有点乏味，但迄今为止我发现的自定义数据注释的最佳方法。

3) 很多时候，我发现自己倾向于自定义类并远离生成的 POCO。原因通常是存储和显示之间的差异。在输入屏幕中

1.  我经常将电话号码分成 3 个文本框。
2.  外键查找需要选择列表（通常添加到模型中）。
3.  通常我会传递可能与我的视图功能相关但不特定于存储表的其他值（显示字段、导航/面包屑）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:48:13.913

看看 LINQ to SQL。您可以通过从服务器资源管理器中拖动表来使用它在图形编辑器中创建 .dbml 文件。

这是 MSDN [How to: Create LINQ to SQL Classes in a Web Project](http://msdn.microsoft.com/en-us/library/bb907587%28v=vs.100%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T05:52:15.680

@Kerezo 几乎完全涵盖了您想要在这里做的事情：[Add Data Annotation To Entity Framework(Or Linq to SQL) generated class](https://stackoverflow.com/questions/7978608/add-data-annotation-to-entity-frameworkor-linq-to-sql-generated-class)

无法自动自动生成数据注释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T18:07:58.127

将数据库优先方法与实体框架一起使用。您可以使用实体数据模型向导从现有数据库生成实体模型。请参阅[http://msdn.microsoft.com/en-us/data/jj206878](http://msdn.microsoft.com/en-us/data/jj206878)

# ruby-on-rails - 如何在 Rails 中重构简单的过滤器操作？

> ID：14446931
> 
> 赞同：0
> 
> 时间：2013-01-21T20:46:27.377
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, refactoring

我想过滤我的`@jobs`使用两个参数。

现在我有这样的事情：

```
 def filter
    if params[:filter][:trade].present? && params[:type].present?
      @jobs = Job.accepted.with_accepted_company.where(:trade_id => params[:filter][:trade],:job_type =>params[:type])
      render :index
    elsif params[:filter][:trade].present?
      @jobs = Job.accepted.with_accepted_company.where(:trade_id => params[:filter][:trade])
      render :index
    elsif params[:type].present?
      @jobs = Job.accepted.with_accepted_company.where(:job_type =>params[:type])
      render :index
    else
      redirect_to jobs_path
    end
  end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T20:52:40.387

```
def filter
  filters = {
    :trade_id => params[:filter][:trade],
    :job_type => params[:type]
  }

  filters.delete_if { |key,value| value.blank? }

  if filters.count > 0
    @jobs = Job.accepted.with_accepted_company.where(filters)
    render :index
  else
    redirect_to jobs_path
  end
end 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-21T20:58:34.967

```
 def filter
  h = {}
  params[:filter][:trade].tap{|v| h[:trade_id] = v if v.present?}
  params[:type].tap{|v| h[:job_type] = v if v.present?}
  if h.empty?
    redirect_to jobs_path
  else
    @jobs = Job.accepted.with_accepted_company.where(h)
    render :index
  end
end 
```

# c - 复制到 C 中的嵌套结构

> ID：14446938
> 
> 赞同：-3
> 
> 时间：2013-01-21T20:46:46.863
> 
> 标签：c, syntax, copy, structure

我正在尝试将结构 x 复制到另一个嵌套有 x 的结构 y 中。

例如：

```
#define DATASIZE 128

typedef struct {
        char data[DATASIZE];    
} x_TYPE;

typedef struct {
    int               number;  
    x_TYPE            nested_x;     
    enum boolean      error;     
} y_TYPE;

/* ---- Values for the type field in xy_union ---- */
#define TYPE_IS_X 0;
#define TYPE_IS_Y 1;

typedef struct {
    union {                       /* structure containing x_object */
           x_TYPE      x_object; /*        or y_object as a union */
           y_TYPE      y_object;
    } u;
int type;            /*One of: TYPE_IS_X, TYPE_IS_Y */

} XY_TYPE; 
```

这是我目前复制的方式：

```
copyXY(XY_TYPE *xx)
{
   XY_TYPE *yy; /* assume this is allocated already */

    yy->u.y_object.nested_x = *xx; /* ERROR LINE */

   return 0;
} 
```

我得到一个编译器错误：错误：从类型'XY_TYPE'分配给类型'x_TYPE'时不兼容的类型。

如果有人知道为什么会发生这种情况，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:43:22.650

这是你想要的？

```
XY_TYPE *yy; /* assume this is allocated already */

void copyXIntoYY(XY_TYPE *xx)
{
    yy->u.y_object.nested_x = xx->u.x_object;
} 
```

从问题中不清楚您要做什么。

# android - 在 AudioTrack 上播放非阻塞数据

> ID：14446942
> 
> 赞同：1
> 
> 时间：2013-01-21T20:47:05.960
> 
> 标签：android, audiotrack

我正在实现一个 RTP 接收器。它接收 UDP 数据包，解码编解码器并将 PCM 样本写入到`AudioTrack`播放。一个问题似乎`AudioTrack.write`是阻塞，因此我会同时错过 UDP 数据包。

有没有关于如何处理这个问题的已知解决方案？

我尝试使用我自己的音频数据缓冲区`setNotificationMarkerPosition`，但似乎，audioTrack 只有在缓冲区被填充到某种程度时才会播放，因此标记位置永远不会到达或`audioTrack.write`再次阻塞。

我也尝试`audioTrack.pause()`在每次写入之前`.play()`再做一次，但这似乎会显着影响音质。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-25T18:56:27.790

不知道你的问题有没有解决，我有点问题。我能做的最好的就是将一个线程中的 UDP 数据包抓取到 ArrayBlockingQueue(ABQ) 中，然后在另一个线程中从 ABQ 一个接一个地播放它们。但是这次播放会受到影响（不是所有设备，有些设备是双线程的）并且 ABQ 的大小增加，这意味着延迟增加。所以我检查大小并系统地丢弃一些数据包（只是不写入AudioTrack）以减少延迟，但如果你对延迟没问题，这是你的电话。

还有一件事，我正在增加线程的优先级：

```
private class Player extends Thread {
  public void run() {
     Process.setThreadPriority(Process.THREAD_PRIORITY_AUDIO );
       ....
  }
} 
```

这提供了更好的速度。

该解决方案仍然以某种方式阻塞，但 UDP 数据包不会被播放器阻塞，直到 ABQ 大小随容量增加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-30T05:51:57.343

我想我可能有一个比“添加缓冲区和线程”解决方案更有吸引力的解决方案。该解决方案为您的（可能）延迟敏感系统增加了一些延迟。以下是您可以执行的操作：

请注意 AudioTrack 的缓冲区大小。然后跟踪在最后 X 毫秒内有多少字节写入缓冲区（这应该以不太计算密集的方式可行），其中 X 是您可以放入的音频的毫秒数缓冲区（基于缓冲区大小和采样率和量化率（位/样本）和通道数的简单计算）。如果您在 X 毫秒内写入了“缓冲区大小”的数据量，那么您应该丢弃音频数据包。请注意，丢弃数据包也将成为“添加缓冲区和线程”解决方案的症状。

您可能想要添加一个小阈值，这样您就不会实际填充缓冲区（假设缓冲区比实际值小一点）。

祝你好运！

# internet-explorer - 如何使用 VBA 拦截和操作 Internet Explorer 弹出窗口

> ID：14446951
> 
> 赞同：10
> 
> 时间：2013-01-21T20:47:46.080
> 
> 标签：internet-explorer, vba, dom, automation, popup

**语言/软件：**

语言是VBA。该应用程序是 Access 2003（我也可以使用 Excel）和 Internet Explorer（在 Windows XP/7 上）。

**问题：**

我正在开发一个 Access 宏，它可以打开和操作我工作的企业的 Intranet 站点。

我可以创建新的 IE 窗口并在表单中填写数据，但我需要能够拦截和操作其他 IE 窗口，例如当我单击链接时打开的弹出窗口，当我选择一个选择元素的选项或页面加载时。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T23:58:09.550

这是我用来从标题中获取 IE 窗口的一些代码。它分为两个功能，因为我的一个用户遇到了一个非常奇怪的问题，即没有正确捕获错误。您可能（可能会）能够将私有函数的主体移动到公共函数中。

此外，您需要设置对 Microsoft Internet 控件的引用（这是 shdocvw.dll 或 ieframe.dll，具体取决于您的 Windows 版本），我建议您设置对 Microsoft HTML 对象库的引用以使其更容易拥有 IE 对象后遍历 DOM。

```
Function oGetIEWindowFromTitle(sTitle As String, _
                               Optional bCaseSensitive As Boolean = False, _
                               Optional bExact As Boolean = False) As SHDocVw.InternetExplorer

    Dim objShellWindows As New SHDocVw.ShellWindows
    Dim found As Boolean
    Dim startTime As Single

    found = False
    'Loop through shell windows
    For Each oGetIEWindowFromTitle In objShellWindows
        found = oGetIEWindowFromTitleHandler(oGetIEWindowFromTitle, sTitle, bCaseSensitive, bExact)
        If found Then Exit For
    Next

    'Check whether a window was found
    If Not found Then
        Set oGetIEWindowFromTitle = Nothing
    Else
        pauseUntilIEReady oGetIEWindowFromTitle
    End If

End Function

Private Function oGetIEWindowFromTitleHandler(win As SHDocVw.InternetExplorer, _
                                      sTitle As String, _
                                      bCaseSensitive As Boolean, _
                                      bExact As Boolean) As Boolean

    oGetIEWindowFromTitleHandler = False

    On Error GoTo handler
    'If the document is of type HTMLDocument, it is an IE window
    If TypeName(win.Document) = "HTMLDocument" Then
        'Check whether the title contains the passed title
        If bExact Then
            If (win.Document.title = sTitle) Or ((Not bCaseSensitive) And (LCase(sTitle) = LCase(win.Document.title))) Then oGetIEWindowFromTitleHandler = True
        Else
            If InStr(1, win.Document.title, sTitle) Or ((Not bCaseSensitive) And (InStr(1, LCase(win.Document.title), LCase(sTitle), vbTextCompare) <> 0)) Then oGetIEWindowFromTitleHandler = True
        End If
    End If
handler:
    'We assume here that if an error is raised it's because
    'the window is not of the correct type. Therefore we
    'simply ignore it and carry on.

End Function 
```

使用上面的代码如下：

```
Sub test()

    Dim ie As SHDocVw.InternetExplorer
    Dim doc As HTMLDocument 'If you have a reference to the HTML Object Library
    'Dim doc as Object 'If you do not have a reference to the HTML Object Library

    ' Change the title here as required
    Set ie = oGetIEWindowFromTitle("My popup window")
    Set doc = ie.Document

    Debug.Print doc.getElementsByTagName("body").Item(0).innerText

End Sub 
```

您几乎可以从窗口的任何属性或文档内容中找到一个窗口。如果您为此苦苦挣扎，请发表评论:)。

# windows - 长时间后枚举网络资源 WNetOpenEnum 返回 ERROR_BAD_NETPATH(error 53)

> ID：14446957
> 
> 赞同：4
> 
> 时间：2013-01-21T20:48:05.483
> 
> 标签：windows, winapi, networking

我正在尝试使用 [http://msdn.microsoft.com/en-us/library/windows/desktop/aa385341(v=vs.85).aspx上的代码获取所有共享 PC](http://msdn.microsoft.com/en-us/library/windows/desktop/aa385341(v=vs.85).aspx)

我面临的问题是该方法`WNetOpenEnum`在打开“Microsoft Windows Network”资源并返回错误时需要大量时间`ERROR_BAD_NETPATH`。

我注意到 Windows 资源管理器能够访问共享的 PC 及其文件夹。

我也注意到它`WNetConnectionDialog`也可以正常工作。如果我选择浏览按钮，它能够刷新网络连接并能够看到共享的 PC 及其文件夹。

奇怪的是，目前的代码适用于点对点连接。

1.  有人可以帮我解决这个问题吗？
2.  也有人可以建议我如何使用 Windows API 刷新共享资源？
3.  QT/boost 中是否有可以找到共享 PCS 的方法？

# matlab - 从 MATLAB 导出 eps

> ID：14446960
> 
> 赞同：3
> 
> 时间：2013-01-21T20:48:10.917
> 
> 标签：matlab, export, distortion

我正在尝试为 Elsevier 期刊制作高质量的 EPS 文件 (1000 dpi)。我一直在使用 export_fig，但是当我尝试查看文件时，它们被挤压和扭曲。有谁知道制作一个看起来与屏幕上的数字相同的 eps 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:35:09.620

当我导出 eps 数字时，我使用 [Oliver Woodford](http://www.mathworks.com/matlabcentral/fileexchange/authors/29192)在 mathworks 文件交换中找到的函数[export_fig取得了很大的成功。](http://www.mathworks.com/matlabcentral/fileexchange/23629-exportfig)

自从我使用它以来，他已经对其进行了更新，但它可能只会变得更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T01:17:00.043

对于我的出版物，我有一套迄今为止从未让我失望过的步骤。我包括所有可能比您要求的更多的步骤。这里是

1.使用正确的线宽和/或标记大小绘制

2.设置字体大小

3.设置X和Y限制

4.设置X和Y刻度

5.如果合适，设置 X 和 Y 刻度标签

6.设置X和Y轴标签

7.设置图形单位为英寸

8.设置图形大小

9\. 使用带有 -painters 选项的 export_fig 导出

```
hf = figure();
plot(x,y,'Linewidth',1);
set(gca,'FontSize',8);
xlim([a,b]);
ylim([c,d]);
set(gca,'XTick',a:ab:b);
set(gca,'YTick',c:cd:d);
xlabel('Xlabel');
ylabel('Ylabel');
set(gcf,'units','inches');
set(gcf,'Position',[0 0 fig_width fig_height]);
export_fig(filename,'-transparent','-eps','-painters'); 
```

final`-painters`很重要，因为有时虚线和点划线样式无法正确导出。同样的方法也适用于 -pdf。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-25T21:18:50.023

您可以使用 hgexport。

```
x = 0:.1:pi;
h = figure();
plot(x, sin(x));
hgexport(h, 'sin.eps'); 
```

UPDATE
print 和 saveas 也可以。

# jboss - JBoss 5.1 无法启动 - 在 mac osx 上使用 eclipse

> ID：14446966
> 
> 赞同：0
> 
> 时间：2013-01-21T20:48:33.657
> 
> 标签：jboss, jboss5.x

我正在尝试在 mac 上运行 jdk 6（java 版本“1.6.0_37”）在 eclipse 上启动 Jboss 应用程序服务器 5.1。

问题是服务器状态永远不会变成“已启动”，当超时时间过去时，我在 Eclipse 上收到错误 - “服务器无法启动”

我尝试更改“jboss-service.xml”文件上的端口，但没有帮助。

关于为什么会发生这种情况的任何想法或见解，我做错了什么以及如何解决它？

附件是控制台输出的摘录。

任何帮助，将不胜感激。

```
java.lang.NoSuchMethodError: org.apache.catalina.startup.Catalina.setCatalinaHome(Ljava/lang/String;)V
at org.jboss.web.tomcat.service.deployers.TomcatService.startService(TomcatService.java:183)
at org.jboss.system.ServiceMBeanSupport.jbossInternalStart(ServiceMBeanSupport.java:376)
at org.jboss.system.ServiceMBeanSupport.pojoStart(ServiceMBeanSupport.java:216)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.jboss.reflect.plugins.introspection.ReflectionUtils.invoke(ReflectionUtils.java:59)
at org.jboss.reflect.plugins.introspection.ReflectMethodInfoImpl.invoke(ReflectMethodInfoImpl.java:150)
at org.jboss.joinpoint.plugins.BasicMethodJoinPoint.dispatch(BasicMethodJoinPoint.java:66)
at org.jboss.kernel.plugins.dependency.KernelControllerContextAction$JoinpointDispatchWrapper.execute(KernelControllerContextAction.java:241)
at org.jboss.kernel.plugins.dependency.ExecutionWrapper.execute(ExecutionWrapper.java:47)
at org.jboss.kernel.plugins.dependency.KernelControllerContextAction.dispatchExecutionWrapper(KernelControllerContextAction.java:109)
at org.jboss.kernel.plugins.dependency.KernelControllerContextAction.dispatchJoinPoint(KernelControllerContextAction.java:70)
at org.jboss.kernel.plugins.dependency.LifecycleAction.installActionInternal(LifecycleAction.java:221)
at org.jboss.kernel.plugins.dependency.InstallsAwareAction.installAction(InstallsAwareAction.java:54)
at org.jboss.kernel.plugins.dependency.InstallsAwareAction.installAction(InstallsAwareAction.java:42)
at org.jboss.dependency.plugins.action.SimpleControllerContextAction.simpleInstallAction(SimpleControllerContextAction.java:62)
at org.jboss.dependency.plugins.action.AccessControllerContextAction.install(AccessControllerContextAction.java:71)
at org.jboss.dependency.plugins.AbstractControllerContextActions.install(AbstractControllerContextActions.java:51)
at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
at org.jboss.system.ServiceController.doChange(ServiceController.java:688)
at org.jboss.system.ServiceController.start(ServiceController.java:460)
at org.jboss.system.microcontainer.jmx.ServiceControllerStartStopLifecycleCallback.install(ServiceControllerStartStopLifecycleCallback.java:44)
at sun.reflect.GeneratedMethodAccessor237.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.jboss.reflect.plugins.introspection.ReflectionUtils.invoke(ReflectionUtils.java:59)
at org.jboss.reflect.plugins.introspection.ReflectMethodInfoImpl.invoke(ReflectMethodInfoImpl.java:150)
at org.jboss.joinpoint.plugins.BasicMethodJoinPoint.dispatch(BasicMethodJoinPoint.java:66)
at org.jboss.beans.info.plugins.AbstractBeanInfo.invoke(AbstractBeanInfo.java:300)
at org.jboss.kernel.plugins.dependency.AbstractKernelControllerContext.invoke(AbstractKernelControllerContext.java:286)
at org.jboss.dependency.plugins.AbstractLifecycleCallbackItem.install(AbstractLifecycleCallbackItem.java:87)
at org.jboss.dependency.plugins.AbstractController.handleLifecycleCallbacks(AbstractController.java:1568)
at org.jboss.dependency.plugins.AbstractController.handleInstallLifecycleCallbacks(AbstractController.java:1533)
at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:943)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
at org.jboss.system.ServiceController.doChange(ServiceController.java:688)
at org.jboss.system.ServiceController.start(ServiceController.java:460)
at org.jboss.system.microcontainer.jmx.ServiceControllerStartStopLifecycleCallback.install(ServiceControllerStartStopLifecycleCallback.java:44)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.jboss.reflect.plugins.introspection.ReflectionUtils.invoke(ReflectionUtils.java:59)
at org.jboss.reflect.plugins.introspection.ReflectMethodInfoImpl.invoke(ReflectMethodInfoImpl.java:150)
at org.jboss.joinpoint.plugins.BasicMethodJoinPoint.dispatch(BasicMethodJoinPoint.java:66)
at org.jboss.beans.info.plugins.AbstractBeanInfo.invoke(AbstractBeanInfo.java:300)
at org.jboss.kernel.plugins.dependency.AbstractKernelControllerContext.invoke(AbstractKernelControllerContext.java:286)
at org.jboss.dependency.plugins.AbstractLifecycleCallbackItem.install(AbstractLifecycleCallbackItem.java:87)
at org.jboss.dependency.plugins.AbstractController.handleLifecycleCallbacks(AbstractController.java:1568)
at org.jboss.dependency.plugins.AbstractController.handleInstallLifecycleCallbacks(AbstractController.java:1533)
at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:943)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:774)
at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:540)
at org.jboss.deployers.vfs.deployer.kernel.BeanMetaDataDeployer.deploy(BeanMetaDataDeployer.java:121)
at org.jboss.deployers.vfs.deployer.kernel.BeanMetaDataDeployer.deploy(BeanMetaDataDeployer.java:51)
at org.jboss.deployers.spi.deployer.helpers.AbstractSimpleRealDeployer.internalDeploy(AbstractSimpleRealDeployer.java:62)
at org.jboss.deployers.spi.deployer.helpers.AbstractRealDeployer.deploy(AbstractRealDeployer.java:50)
at org.jboss.deployers.plugins.deployers.DeployerWrapper.deploy(DeployerWrapper.java:171)
at org.jboss.deployers.plugins.deployers.DeployersImpl.doDeploy(DeployersImpl.java:1439)
at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1157)
at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1178)
at org.jboss.deployers.plugins.deployers.DeployersImpl.install(DeployersImpl.java:1098)
at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
at org.jboss.deployers.plugins.deployers.DeployersImpl.process(DeployersImpl.java:781)
at org.jboss.deployers.plugins.main.MainDeployerImpl.process(MainDeployerImpl.java:702)
at org.jboss.system.server.profileservice.repository.MainDeployerAdapter.process(MainDeployerAdapter.java:117)
at org.jboss.system.server.profileservice.repository.ProfileDeployAction.install(ProfileDeployAction.java:70)
at org.jboss.system.server.profileservice.repository.AbstractProfileAction.install(AbstractProfileAction.java:53)
at org.jboss.system.server.profileservice.repository.AbstractProfileService.install(AbstractProfileService.java:361)
at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
at org.jboss.system.server.profileservice.repository.AbstractProfileService.activateProfile(AbstractProfileService.java:306)
at org.jboss.system.server.profileservice.ProfileServiceBootstrap.start(ProfileServiceBootstrap.java:271)
at org.jboss.bootstrap.AbstractServerImpl.start(AbstractServerImpl.java:461)
at org.jboss.Main.boot(Main.java:221)
at org.jboss.Main$1.run(Main.java:556)
at java.lang.Thread.run(Thread.java:680)
22:10:48,271 INFO  [RARDeployment] Required license terms exist, view vf 
```

......

```
 22:10:50,423 ERROR [ProfileServiceBootstrap] Failed to load profile: Summary of incomplete deployments (SEE PREVIOUS ERRORS FOR DETAILS):

DEPLOYMENTS MISSING DEPENDENCIES:
  Deployment "jboss.web.deployment:war=/ROOT" is missing the following dependencies:
Dependency "jboss.web:service=WebServer" (should be in state "Create", but is actually in state "** NOT FOUND Depends on 'jboss.web:service=WebServer' **")
Deployment "jboss.web.deployment:war=/admin-console" is missing the following dependencies:
Dependency "jboss.web:service=WebServer" (should be in state "Create", but is actually in state "** NOT FOUND Depends on 'jboss.web:service=WebServer' **")
Deployment "jboss.web.deployment:war=/invoker" is missing the following dependencies:
Dependency "jboss.web:service=WebServer" (should be in state "Create", but is actually in state "** NOT FOUND Depends on 'jboss.web:service=WebServer' **")
Deployment "jboss.web.deployment:war=/jbossws" is missing the following dependencies:
Dependency "jboss.web:service=WebServer" (should be in state "Create", but is actually in state "** NOT FOUND Depends on 'jboss.web:service=WebServer' **")
Deployment "jboss.web.deployment:war=/jmx-console" is missing the following dependencies:
Dependency "jboss.web:service=WebServer" (should be in state "Create", but is actually in state "** NOT FOUND Depends on 'jboss.web:service=WebServer' **")
Deployment "jboss.web.deployment:war=/web-console" is missing the following dependencies:
Dependency "jboss.web:service=WebServer" (should be in state "Create", but is actually in state "** NOT FOUND Depends on 'jboss.web:service=WebServer' **")

DEPLOYMENTS IN ERROR:
  Deployment "WebServer" is in error due to the following reason(s): java.lang.NoSuchMethodError: org.apache.catalina.startup.Catalina.setCatalinaHome(Ljava/lang/String;)V
   Deployment "jboss.web:service=WebServer" is in error due to the following reason(s): **  NOT FOUND Depends on 'jboss.web:service=WebServer' **

 22:10:50,424 INFO  [ServerImpl] JBoss (Microcontainer) [5.1.0.GA (build: SVNTag=JBoss_5_1_0_GA date=200905221634)] Started in 27s:111ms 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T10:01:12.510

仅供参考 - 如果您正在启动在 Eclipse 中设置的服务器，则有一个可以更改的超时属性 - 我必须在我们的一台测试机器上延长超时时间，因为启动大约需要 5 分钟，默认值为我想大约 2 分钟。

您是否在机器上运行了任何其他 JBoss 或 Tomcat 实例？

查看部署错误，快速谷歌显示：[https](https://community.jboss.org/message/749362) : //community.jboss.org/message/749362，https [:](https://community.jboss.org/thread/163772) //community.jboss.org/thread/148647 & [https://community.jboss.org/thread](https://community.jboss.org/thread/148647) [/163772](https://community.jboss.org/thread/163772)

这些有帮助吗？

# ember.js - 在 Ember.js Routes v2 中使用额外的状态机

> ID：14446968
> 
> 赞同：2
> 
> 时间：2013-01-21T20:48:42.977
> 
> 标签：ember.js

我们在 Ember.js 中使用了 v2 的 Routing，我们遇到了在一个视图中显示多个关联模型的情况。该应用程序是一个地址簿，当我们显示联系人时，我们还会显示该联系人的第一个地址以及您与该联系人共享的第一个事件。在同样的观点上，我们希望能够添加/编辑/删除地址和事件。由于有多个关联模型，使用路由将状态保留在 URL 中是困难且不可取的。

**是否可以为每个控制控制器和视图的关联模型定义一个新的状态机？**我看过[这篇文章](https://stackoverflow.com/questions/14147518/multiple-stateful-components-with-ember-router)，它建议使用带有数据对象的单例控制器来控制状态，我还看到了一些示例博客文章，它们使用 v1 的 Routes 和额外的状态机。我找不到任何人使用具有 v2 Routes 的多个状态机。

谢谢！

# css - 两个内联块：将文本放在图像旁边

> ID：14446972
> 
> 赞同：1
> 
> 时间：2013-01-21T20:48:46.750
> 
> 标签：css

我有 2 个内联块的问题。我想创建这样的东西：

```
<img>  
<span>some long text next to the img</span> 
```

我有以下结构（我必须使用）：

```
<div class="mainContainer">
    <div class="additional">
        <div class="description">
              <img></img>
        </div>
        <div class="description">
         Lorem ipsum dolor sit amet, consectetur adipisicing elit...         
        </div>    
    </div>  
</div> 
```

款式：

```
.mainContainer {
    height: 15px; } //doesn't matter in this case

.additional {   
    line-height: 15px; } //doesn't matter in this case

.description {
     float: left;
     display: inline; 
} 
```

问题是当我想添加长文本时，图像在文本上方，但它应该在它旁边。

它应该是这样的（我添加了代码，但必须将其删除）：

[http://jsfiddle.net/476fm/](http://jsfiddle.net/476fm/)

有什么建议么？

编辑：好的，实际上上面的文本只是示例，更具体地说，我想要实现的目标：我有一个包含 2 个内联元素的主容器： - 第一个元素有图像
- 第二个元素也有图像和文本，我想做的是：当文本很长并且需要在第二行时，它不应该在第一张图片下方

[http://jsfiddle.net/z2t7b/](http://jsfiddle.net/z2t7b/) - 它应该被修复（我希望有人明白我想做什么）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T21:12:27.427

这是你想要完成的吗？

```
<div class="mainContainer">
    <div class="additional">
        <div class="description">
            <img></img> <div class="description">Lorem ipsum dolor sit amet, consectetur adipisicing elit,</br> sed do eiusmod tempor incididunt ut labore</div>
            <div class="breaker"></div>
            <img></img><div class="description">Lorem ipsum dolor sit amet, consectetur adipisicing elit,</br> sed do eiusmod tempor incididunt ut labore</div>
        </div>

    </div>  
</div>

.mainContainer {
    height: 23px;
}

.additional{
    line-height: 23px;
}

.description {
    float:left;
    display: inline;
}

.breaker {clear: both;}

img {
    background-color:#FFF;
    width:20px;
    height:20px;
    display:inline-block;
    border:solid black 1px;
    float:left;
} 
```

[这是小提琴](http://jsfiddle.net/tech0925/476fm/7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:25:39.673

好吧，对于 INLINE 元素，只需删除 'float:left' .. 自然内联流将适用，然后，您的文本将正常通过。

好的，现在我接受了你的任务（我希望）

只需让您的容器行为有一个块，将其向左浮动并添加溢出：隐藏；

[http://jsfiddle.net/NgfSF/](http://jsfiddle.net/NgfSF/)

```
.description {
padding-right:10px;
float:left;
display: inline;
}

.description1 {
display: block;
overflow: hidden;
} 
```

# c++ - 固定数量的可变参数模板中的模板参数

> ID：14446973
> 
> 赞同：4
> 
> 时间：2013-01-21T20:48:51.757
> 
> 标签：c++, templates, c++11, variadic-templates

```
template <template <typename> class F> struct call_me {};
template <typename T> struct maybe;
template <typename... T> struct more;

int main()
{
  call_me<maybe> a; // ok
  call_me<more> b;  // error
} 
```

我明白为什么`call_me<more>`会失败。但我想让它发挥作用。

是否有不涉及更改`call_me`（或为其添加专业化）的解决方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:08:37.240

```
template <template <typename> class F> struct call_me {};
template <typename T> struct maybe;
template <typename... T> struct more;
template <template <class...> class F> struct just_one {
  template <class A> using tmpl = F<A>;
};

int main()
{
  call_me<maybe> a; 
  call_me<just_one<more>::tmpl> b;  
} 
```

不完全等效，但可能足够接近。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T02:07:34.293

```
template <typename T> using onemore = more<T>;

int main()
{
    call_me<onemore> b;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T21:01:08.573

你可以换行`more`：

```
template <template <typename...> class Tmpl>
struct variwrap
{
    template <typename> struct Dummy
    {
        template <typename ...Brgs>
        struct rebind
        {
            typedef Tmpl<Brgs...> other;
        };
    };
}; 
```

现在可以说`call_me<variwrap<more>::Dummy>`，消费者可以`F::rebind<Args...>::other`用来追回了`more<Args...>`。当然`call_me`没有办法知道`F` *有*成员`rebind`，所以你需要添加一个专业化。

呸。

# java - 使用 getResource 写入文件

> ID：14446974
> 
> 赞同：1
> 
> 时间：2013-01-21T20:48:52.090
> 
> 标签：java, getresource

我使用此方法写入文本文件（使用 getResource()... 在 JAR 文件中使用）。我的文件在 Classpath 中，这是我的代码：

```
import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;

public class JarWrite {

    public JarWrite(){
        writethis();
    }

    public void writethis(){

        try{
       InputStreamReader isReader=  new InputStreamReader(this.getClass().getResourceAsStream("AllBookRecords.txt"));
      BufferedReader br = new BufferedReader(isReader);

      PrintWriter writer1=new PrintWriter(new File(this.getClass().getResource("Boutput.txt").getPath()));

      String Bs;
            while( (Bs=br.readLine()) != null ){                 
                    writer1.println(Bs);               
            }

            writer1.close();
            br.close();

        } catch(FileNotFoundException fnfe){

        } catch(IOException ioe){
            ioe.printStackTrace();
        }
    }

    public static void main(String[] args){
        new JarWrite();
    }    
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T21:03:45.557

您不能修改 CLASSPATH 中的资源。它们是只读的。时期。

另请参阅：[*Java OutputStream 等效于 getClass().getClassLoader().getResourceAsStream()*](https://stackoverflow.com/a/2031671/605744)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-21T20:51:07.773

尝试改变：

```
public void writethis 
```

到

```
public static void writethis 
```

# php - 有没有更好的方法来包含？

> ID：14446975
> 
> 赞同：2
> 
> 时间：2013-01-21T20:49:00.480
> 
> 标签：php

我决定在我的状态成功消息中使用包含文件，这样我就可以不时添加“额外”消息，并且只编辑包含文件，而不必一直编辑主要的主文件。这是我的代码：

```
$successP = include("includes/usermain/successpage.php"); 

$statusMessage = "<fieldset style=\"margin-left:20px; float:left; clear:both;\"><img src=\"images/success.gif\"> <font color=\"#CC0000\" size=\"3\"><b>Success!</b></font><br>Your file, <b>". $_FILES['bFile']['name'] ."</b>, was successfully uploaded. Please use the form below if you need to upload another file. <br /> </fieldset><br />";

echo $successP; 
```

这种方法有效。但是，我在另一个论坛上被告知有更好的方法来解决这个问题。然而，没有再说什么。

所以我的问题是......实现我在这里想要实现的目标的最佳方法是什么？或者更确切地说，我目前的方法有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:55:42.193

`include`就像一个非常基本的函数调用。

如果您想进行适当的组合，请将您的类和函数放在单独的文件中，包括您需要的文件，然后通过使用任何输入数据（$_GET 等）初始化您的应用程序开始

我无法从这点上看出您对面向对象编程的了解程度，但如果您还不熟悉类和函数，那么这是一个很好的起点:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:12:38.283

不知道你所说的更好的方法在什么方面。从功能的角度来看，您有四种可能的选项来动态评估文件的内容：

*   include( 'foo.php' ) - 如上所示
*   include_once( 'foo.php' ) - 如果 foo.php 已经在当前模板中调用，则抛出错误
*   require( 'foo.php' ) - 与 include() 相同，但如果 foo.php 为 404 则会抛出致命错误
*   require_once( 'foo.php' ) - include_once() 和 require() 的爱子

你可以在这里阅读更多关于它们的信息：http: [//us3.php.net/manual/en/language.control-structures.php](http://us3.php.net/manual/en/language.control-structures.php)

如果您希望抑制这些包含引发的任何错误，请在函数调用前加上 @（例如 @include('foo.php'); 不推荐，因为它隐藏了糟糕的编码实践。

如果您提供更多详细信息，那么我们可以为您提供更多见解。

# sql - 计数不缺少值的位置

> ID：14446976
> 
> 赞同：3
> 
> 时间：2013-01-21T20:49:03.923
> 
> 标签：sql, sas

我想计算未丢失值的列中日期的出现次数。因此，例如，我想计算汽车被维修的次数，而不是包括没有维修日期的空值。

我尝试了简单的计数功能，但它带来了所有记录。我想过使用“案例”，但我不确定语法。我正在使用 SAS 企业指南。

样品日期

```
id    car     service_Date
1     honda   01/01/2005
2     honda   01/01/2006
3     honda   
4     honda   01/01/2008
5     honda   
6     honda   01/01/2010 
```

结果：我只想有 4 作为答案，所以它不计算空值。

```
PROC SQL;
CREATE TABLE WORK.QUERY_FOR_CARS AS 
SELECT 
t1.CAR,
t1.ID  
/* SERVICE_DATE */
(count (case when t1.S_DATE is not null then 0 end)) AS SERVICE_DATE
FROM WORK.QUERY_FOR_CAR_SERVICE
GROUP BY t1.S_DATE;
QUIT; 
```

我已经添加了我正在使用的代码。它给了我日期的计数，但还包括日期值为空的位置。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T21:52:08.137

给定一个名为 CARS 的 SAS 数据集，其中包含示例中的变量，您可以在 SQL 中以两种不同的方式找到具有非缺失值 service_date 的观察数：

```
proc sql;

   select count(service_date) as num_not_missing
   from cars;

   select count(*) as num_not_missing
   from cars
   where service_date is not null;

quit; 
```

第一个示例在 count 函数中指定 service_date 变量，它将忽略缺失值。第二个在应用`where`子句后计算所有行。两者的表现相同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T20:51:36.747

MS Sql Server 的两个选项：

```
SELECT COUNT([service_Date]) FROM [table1] 
```

或者

```
SELECT COUNT(*) FROM [table1] WHERE [service_Date] IS NOT NULL 
```

有关详细信息`COUNT()`，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/ms175997%28v=sql.105%29.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-21T20:50:54.990

默认情况下，count(service_date) 排除空值，这与计算所有行的 count(*) 相反。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T23:24:47.577

如果它可以来自另一个 Proc [（Proc 表示）](http://www2.sas.com/proceedings/sugi29/240-29.pdf)

```
data have;
 input car $ service_date mmddyy10.;
 format service_date mmddyy10.;
datalines;
honda 01/01/2005
honda 01/01/2006
honda
honda 01/01/2008
honda
honda 01/01/2010
toyota 01/01/2005
toyota 01/01/2006
toyota
toyota 01/01/2008
toyota
toyota 01/01/2010
;

Proc Means N data=work.have noprint; 
 var service_date;
 by car;
 output out=work.want(drop= _type_ _freq_)  n=count;
run; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-21T20:51:54.683

你可以试试，`WHERE column != ""`或者如果你没有 NULL 也许你可以使用`WHERE CHAR_LENGTH(column) > 3`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-21T21:32:43.080

拉马克，

有几种方法可以解决这个问题。这是我将使用的方法，避免使用 PROC SQL。

```
/* Set up example data */    
data   YourTable;
input id car $ service_Date;
informat service_Date mmddyy10.;
format service_Date mmddyy10.;
cards;

1 honda 01-01-2005
2 honda 01-01-2006
3 honda ""
4 honda 01-01-2008
5 honda ""
6 honda 01-01-2010

run;

/* Count non null records */
data work.CountTable(keep=NbrNulls);
 set work.YourTable(where=(service_date ne .)) end=last;
 if last;
 NbrNulls=_N_;
run; 
```

根据您打算如何使用该计数，您可以在最后一个数据步骤的末尾添加一个“调用 symputx()”函数，以便在其他地方将其作为宏变量调用。

结果是4。

# delphi - 当控件的类名非常非常长时，为什么会出现访问冲突？

> ID：14446979
> 
> 赞同：23
> 
> 时间：2013-01-21T20:49:18.680
> 
> 标签：delphi, delphi-2010, buffer-overflow

我按顺序对控件进行了子类化，这样我就可以添加一些我需要的字段，但是现在当我在运行时创建它时，我得到一个`Access Violation`. 不幸的是，这种访问冲突并没有发生在我创建控件的地方，即使是我在启用所有调试选项（包括“使用调试 DCU 构建”）的情况下构建的那些，堆栈跟踪也对我没有帮助！

在我尝试重现该错误时，我尝试创建控制台应用程序，但显然此错误仅显示在 Forms 应用程序中，并且仅当我的控件实际显示在表单上时！

以下是重现错误的步骤。创建一个新的 VCL Forms 应用程序，放下一个按钮，双击以创建 OnClick 处理程序并编写以下代码：

```
type TWinControl<T,K,W> = class(TWinControl);

procedure TForm3.Button1Click(Sender: TObject);
begin
  with TWinControl<TWinControl, TWinControl, TWinControl>.Create(Self) do
  begin
    Parent := Self;
  end;
end; 
```

每次我尝试时，这都会连续产生访问冲突。仅在 Delphi 2010 上对此进行了测试，因为这是我在这台计算机上获得的唯一版本。

问题是：

*   这是德尔福泛型中的一个已知错误吗？
*   有解决方法吗？

# 编辑

这是 QC 报告的链接：http: //qc.embarcadero.com/wc/qcmain.aspx?d= [112101](http://qc.embarcadero.com/wc/qcmain.aspx?d=112101)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-21T21:03:57.103

首先，这与泛型无关，但在使用泛型时更有可能表现出来。原来有一个缓冲区溢出错误`TControl.CreateParams`。如果您查看代码，您会注意到它填充了一个`TCreateParams`结构，尤其重要的是，它`TCreateParams.WinClassName`使用当前类的名称（`ClassName`）填充 。不幸`WinClassName`的是，只有 char 的固定长度缓冲区`64`，但这需要包括 NULL 终止符；如此有效地`64`char long`ClassName`将溢出该缓冲区！

可以使用以下代码对其进行测试：

```
TLongWinControlClassName4567890123456789012345678901234567891234 = class(TWinControl)
end;

procedure TForm3.Button1Click(Sender: TObject);
begin
  with TLongWinControlClassName4567890123456789012345678901234567891234.Create(Self) do
  begin
    Parent := Self;
  end;
end; 
```

该类名的长度*正好是*64 个字符。缩短一个字符，错误就会消失！

由于Delphi 构造 的方式，在使用泛型时*更*可能发生这种情况`ClassName`：它包括声明参数类型的单元名称，加上一个点，然后是参数类型的名称。例如，`TWinControl<TWinControl, TWinControl, TWinControl>`该类具有以下 ClassName：

```
TWinControl<Controls.TWinControl,Controls.TWinControl,Controls.TWinControl> 
```

那是`75`字符长，超过了`63`限制。

# 解决方法

我采用了来自潜在错误生成类的简单错误消息。像这样的东西，来自构造函数：

```
constructor TWinControl<T, K, W>.Create(aOwner: TComponent);
begin
  {$IFOPT D+}
  if Length(ClassName) > 63 then raise Exception.Create('The resulting ClassName is too    long: ' + ClassName);
  {$ENDIF}
  inherited;
end; 
```

至少这显示了一个可以立即采取行动的体面的错误消息。

# 稍后编辑，真正的解决方法

先前的解决方案（引发错误）对于具有非常长的名称的非泛型类工作正常；人们很可能能够缩短它，使其 63 个字符或更少。泛型类型并非如此：我遇到了一个带有 2 个类型参数的 TWinControl 后代的问题，所以它的形式如下：

```
TMyControlName<Type1, Type2> 
```

基于此泛型类型的具体类型的 gnerate ClassName 采用以下形式：

```
TMyControlName<UnitName1.Type1,UnitName2.Type2> 
```

所以它包括 5 个标识符（2x 单元标识符 + 3x 类型标识符）+ 5 个符号（`<.,.>`）；这 5 个标识符的平均长度必须小于 12 个字符，否则总长度超过 63：5x12+5 = 65。每个标识符仅使用 11-12 个字符是非常少的，并且违反了最佳实践（即：使用长描述性名称，因为击键是免费的！）。同样，在我的情况下，我根本无法让我的标识符那么短。

考虑到如何缩短`ClassName`并非总是可能的，我想我会尝试消除问题的原因（缓冲区溢出）。不幸的是，这非常困难，因为错误源自层次结构`TWinControl.CreateParams`底部的 , 。`CreateParams`我们不能不调用`inherited`，因为`CreateParams`整个继承链都使用它来构建窗口创建参数。不调用它需要复制基础中的所有代码`TWinControl.CreateParams`加上中间类中的所有代码；它也不是很便携，因为任何代码都可能随着未来版本的`VCL`（或我们可能继承的 3rd 方控件的未来版本）而改变。

以下解决方案不会停止`TWinControl.CreateParams`溢出缓冲区，而是使其无害，然后（当`inherited`调用返回时）解决问题。我正在使用一个新记录（因此我可以控制布局），其中包括原始记录`TCreateParams`，但用大量空间填充它`TWinControl.CreateParams`以溢出。`TWinControl.CreateParams`溢出它想要的所有内容，然后我阅读完整的文本并使其符合记录的原始边界，同时确保生成的缩短名称合理地可能是唯一的。我在 WndName 中包含原始 ClassName 的 HASH 以帮助解决唯一性问题：

```
type
  TWrappedCreateParamsRecord = record
    Orignial: TCreateParams;
    SpaceForCreateParamsToSafelyOverflow: array[0..2047] of Char;
  end;

procedure TExtraExtraLongWinControlDescendantClassName_0123456789_0123456789_0123456789_0123456789.CreateParams(var Params: TCreateParams);
var Wrapp: TWrappedCreateParamsRecord;
    Hashcode: Integer;
    HashStr: string;
begin
  // Do I need to take special care?
  if Length(ClassName) >= Length(Params.WinClassName) then
    begin
      // Letting the code go through will cause an Access Violation because of the
      // Buffer Overflow in TWinControl.CreateParams; Yet we do need to let the
      // inherited call go through, or else parent classes don't get the chance
      // to manipulate the Params structure. Since we can't fix the root cause (we
      // can't stop TWinControl.CreateParams from overflowing), let's make sure the
      // overflow will be harmless.
      ZeroMemory(@Wrapp, SizeOf(Wrapp));
      Move(Params, Wrapp.Orignial, SizeOf(TCreateParams));
      // Call the original CreateParams; It'll still overflow, but it'll probably be hurmless since we just
      // padded the orginal data structure with a substantial ammount of space.
      inherited CreateParams(Wrapp.Orignial);
      // The data needs to move back into the "Params" structure, but before we can do that
      // we should FIX the overflown buffer. We can't simply trunc it to 64, and we don't want
      // the overhead of keeping track of all the variants of this class we might encounter.
      // Note: Think of GENERIC classes, where you write this code once, but there might
      // be many-many different ClassNames at runtime!
      //
      // My idea is to FIX this by keeping as much of the original name as possible, but
      // including the HASH value of the full name into the window name; If the HASH function
      // is any good then the resulting name as a very high probability of being Unique. We'll
      // use the default Hash function used for Delphi's generics.
      HashCode := TEqualityComparer<string>.Default.GetHashCode(PChar(@Wrapp.Orignial.WinClassName));
      HashStr := IntToHex(HashCode, 8);
      Move(HashStr[1], Wrapp.Orignial.WinClassName[High(Wrapp.Orignial.WinClassName)-8], 8*SizeOf(Char));
      Wrapp.Orignial.WinClassName[High(Wrapp.Orignial.WinClassName)] := #0;
      // Move the TCreateParams record back were we've got it from
      Move(Wrapp.Orignial, Params, SizeOf(TCreateParams));
    end
  else
    inherited;
end; 
```

# javascript - UI对话框在使用jQuery的setTimeout中不起作用

> ID：14446982
> 
> 赞同：0
> 
> 时间：2013-01-21T20:49:23.457
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-dialog, settimeout

我想在 10 秒后触发一个对话框，这很简单.. 或者我想:-)

```
function showPopup() {
    $( "#emailPopup" ).dialog({autoOpen:false});
    //alert('Dialog shown');
}
$( "#emailPopup" ).dialog("open");
$( "#emailPopup" ).dialog("close");

$(document).ready(function() {
    $( "#emailPopup" ).dialog({autoOpen:false});

    window.setTimeout(function(){
        showPopup();
    }, 4000);

    jwplayer('videoBox').setup({
        flashplayer: '<?php echo asset_url(); ?>swf/player.swf',
        file: 'http://www.youtube.com/watch?v=Oj8CwmP_Jm4',
        height: 329,
        width: 540,
        events:{
            onBeforePlay:function(){
                $('#videoTitle').hide();
                $('#videoReplay').hide();
            },
            onPlay:function(){
                videoStarted = true;
                clearTimeout(popTO);
            },
            onComplete:function(){
                home.flashGetStarted();
                $('#videoReplay').show();
            }
        },
        plugins: 'fbit-1'
    });
}); 
```

当我运行代码 showPopup IS 运行时，我可以在[Firebug](http://en.wikipedia.org/wiki/Firebug_%28software%29)中使用调试来验证这一点，但是在调用对话框之后，我仍然看不到任何对话框。如果我直接调用 setTimeout 之外的对话框，它可以工作......但是在里面，这是不行的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:00:24.777

为了 `open`在对话框上使用方法，您首先需要初始化对话框。

```
$( "#emailPopup" ).dialog({autoOpen:false}); 

function showPopup() {
     $( "#emailPopup" ).dialog("open"); 
     //alert('Dialog shown');
}

window.setTimeout(function(){
    showPopup();
}, 4000); 
```

演示：http: [//jsfiddle.net/QtkBL/](http://jsfiddle.net/QtkBL/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:07:19.003

> 如果我在 setTimeout 之外直接调用对话框，它可以工作......但是在里面，这是不行的

那是因为范围不同。

# ios - 首次加载应用程序时，MKMapview ios不显示当前位置

> ID：14446984
> 
> 赞同：1
> 
> 时间：2013-01-21T20:49:25.813
> 
> 标签：ios, location, mkmapview, coordinates

我的应用上有一个`MKMapView`。这是iOS6。

```
-(void)viewDidLoad
{
    .....
    locationManager = [[CLLocationManager alloc] init];
    locationManager.delegate = self;
    [locationManager setDesiredAccuracy:kCLLocationAccuracyBestForNavigation];
    [locationManager setDistanceFilter:kCLDistanceFilterNone];
    [locationManager startUpdatingLocation];
}

- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations
{
    NSLog(@"Update locations is hit");
    NSLog(@"379 the locations count is %d",locations.count);

    CLLocation *obj = [locations lastObject];
    NSLog(@"the lat is %f", obj.coordinate.latitude);
    NSLog(@"the long is %f", obj.coordinate.longitude);
    NSLog(@"the horizontal accuracy is %f",obj.horizontalAccuracy);
    NSLog(@"the vertical accuracty is %f",obj.verticalAccuracy);
    if (obj.coordinate.latitude != 0 && obj.coordinate.longitude != 0)
    {
        CLLocationCoordinate2D currrentCoordinates ;
        currrentCoordinates.latitude = obj.coordinate.latitude;
        currrentCoordinates.longitude = obj.coordinate.longitude;
    }
    ....more computation
    [locationManager stopUpdatingLocation];
} 
```

当我第一次加载应用程序时，我的位置显示的距离不远。有时数英里之外。我还有一个重置位置按钮，如果我单击该地图会显示正确的位置。这就是我在重置位置按钮单击中的内容：

```
- (IBAction)btnResetLocationClick:(UIButton *)sender
{
    locationManager = [[CLLocationManager alloc]init];
    locationManager.delegate = self;
    [locationManager setDesiredAccuracy:kCLLocationAccuracyBestForNavigation];
    [locationManager setDistanceFilter:kCLDistanceFilterNone];
    [locationManager startUpdatingLocation];
} 
```

那么如何让应用程序在加载时获得正确的当前位置。有没有办法让应用程序告诉地图等待几毫秒然后更新。还是有其他想法？请告诉我。如果您需要更多信息，请询问。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T21:17:50.297

你可以做的是：

*   不要自动关闭位置服务`didUpdateLocations`，而是；
*   `didUpdateLocations`仅当您对`horizontalAccuracy`;足够满意时才关闭位置服务 和
*   即使您没有获得所需的准确度，也请在经过一定时间后关闭定位服务。

因此，`didUpdateLocations`可能看起来像：

```
- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations
{
    CLLocation *location = [locations lastObject];

    // do whatever you want with the location

    // finally turn off location services if we're close enough
    //
    // I'm using 100m; maybe that's too far for you, but 5m is probably too small
    // as you frequently never get that accurate of a location

    if (location.horizontalAccuracy > 0 && location.horizontalAccuracy < 100)
        [locationManager stopUpdatingLocation];
} 
```

然后在 中`viewDidLoad`，如果在一段时间后关闭，则关闭（如果您已经关闭了位置服务，您可能需要检查您设置的一些状态变量）：

```
-(void)viewDidLoad
{
    .....
    locationManager = [[CLLocationManager alloc] init];
    locationManager.delegate = self;
    [locationManager setDesiredAccuracy:kCLLocationAccuracyBestForNavigation];
    [locationManager setDistanceFilter:kCLDistanceFilterNone];
    [locationManager startUpdatingLocation];

    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, 60.0 * NSEC_PER_SEC);
    dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
        [locationManager stopUpdatingLocation];
    });
} 
```

* * *

**原答案：**

我没有看到您将地图更新到您所在位置的位置。我希望看到类似的东西：

```
self.mapView.centerCoordinate = location.coordinate; 
```

或喜欢：

```
MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(location.coordinate, 300, 300);
[self.mapView setRegion:region]; 
```

我还建议，不要立即关闭定位服务（因为通常前几个位置不是那么准确），而是让它打开一段时间，让它在你的位置上磨练，直到它`horizontalAccuracy`落在`verticalAccuracy`某个预定的限制范围内。查看几次调用的准确度数据，`didUpdateLocations`您就会明白我的意思。

我最初以为你得到了否定`horizontalAccuracy`，我建议实施[`didFailToLocateUserWithError`](http://developer.apple.com/library/ios/documentation/MapKit/Reference/MKMapViewDelegate_Protocol/MKMapViewDelegate/MKMapViewDelegate.html#//apple_ref/occ/intfm/MKMapViewDelegate/mapView%3adidFailToLocateUserWithError%3a)，因为根据[`horizontalAccuracy`](https://developer.apple.com/library/ios/documentation/CoreLocation/Reference/CLLocation_Class/CLLocation/CLLocation.html#//apple_ref/occ/instp/CLLocation/horizontalAccuracy)，“负值表示该位置的纬度和经度无效。” 希望您收到描述问题所在的错误。即使您目前没有得到否定的结果`horizontalAccuracy`，您也可能希望实现此方法，以确保您正确处理任何错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:06:31.847

您无法在您的应用程序中使 iPhone 中的 GPS 更准确，但您可以在继续之前检查结果*是否*准确。现在你只检查 lat 和 long 不是 0，但如果你检查`obj`'horizo​​ntalAccuracy 那么你就会知道位置信息什么时候足够好。在发生这种情况之前不`stopUpdatingLoation`要这样做。

# java - 在不使用库的情况下迭代日期范围 - Java

> ID：14446985
> 
> 赞同：2
> 
> 时间：2013-01-21T20:49:30.680
> 
> 标签：java, date, calendar

嗨，我想在不使用任何库的情况下遍历一个日期范围。我想从 2005 年 1 月 18 日开始（想将其格式化为 yyyy/M/d）并以天为间隔进行迭代，直到当前日期。我已经格式化了开始日期，但我不知道如何将它添加到日历对象并进行迭代。我想知道是否有人可以提供帮助。谢谢

```
String newstr = "2005/01/18";
SimpleDateFormat format1 = new SimpleDateFormat("yyyy/M/d"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T20:56:01.917

```
Date date = format1.parse(newstr);
Calendar calendar = new GregorianCalendar();
calendar.setTime(date);
while (someCondition(calendar)) {
    doSomethingWithTheCalendar(calendar);
    calendar.add(Calendar.DATE, 1);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:57:07.917

用于`SimpleDateFormat`将字符串解析为`Date`对象或将对象格式化`Date`为字符串。

使用类`Calendar`进行日期算术。它有一种`add`方法来推进日历，例如用一天。

请参阅上述类的 API 文档。

或者，使用[Joda Time](http://joda-time.sourceforge.net/)库，它使这些事情变得更容易。（标准 Java API 中的`Date`和`Calendar`类有许多设计问题，不如 Joda Time 强大）。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-21T21:12:04.647

Java，实际上是许多系统，将时间存储为自 1970 年 1 月 12:00 上午 12:00 UTC 以来的毫秒数。这个数字可以定义为long。

```
//to get the current date/time as a long use
long time = System.currentTimeMillis();

//then you can create a an instance of the date class from this time.
Date dateInstance = new Date(time);

//you can then use your date format object to format the date however you want.
System.out.println(format1.format(dateInstance));

//to increase by a day, notice 1000 ms = 1 second, 60 seconds = 1 minute,
//60 minutes = 1 hour 24 hours = 1 day so add 1000*60*60*24 
//to the long value representing time.
time += 1000*60*60*24;

//now create a new Date instance for this new time value
Date futureDateInstance = new Date(time);

//and print out the newly incremented day
System.out.println(format1.format(futureDateInstance)); 
```

# vb.net - 使用 POS.NET 进行阿拉伯文印刷

> ID：14446994
> 
> 赞同：0
> 
> 时间：2013-01-21T20:50:05.740
> 
> 标签：vb.net, printing, arabic, pos-for-.net

我正在尝试在热敏打印机（Posiflex PP8X 系列）上打印阿拉伯语文本。我正在使用 Microsoft Point of Service for .NET API (POS.net V1.12)。但是，打印机上的输出显示问号。通过从 Posiflex OPOS Manager 打印测试，我确保我的打印机可以打印阿拉伯语。

在将文本发送到打印机之前，我也尝试过对文本进行 UTF-8 编码，但没有用。

以下是我的代码示例，希望有人能告诉我是否遗漏了什么：

```
 Dim posPrinter As PosPrinter = Nothing
    Dim strLogicalName As String = "PosPrinter"
    Dim deviceInfo As DeviceInfo = Nothing
    Dim posExplorer As New Microsoft.PointOfService.PosExplorer
    Dim myString As String = "Some Text in Arabic"

    deviceInfo = posExplorer.GetDevice(DeviceType.PosPrinter, strLogicalName)
    posPrinter = posExplorer.CreateInstance(deviceInfo)
    posPrinter.Open()
    If Not posPrinter.Claimed Then
       posPrinter.Claim(1000)
    End If
    posPrinter.DeviceEnabled = True
    posPrinter.CharacterSet = 864
    posPrinter.PrintNormal(PrinterStation.Receipt, myString) 
```

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T21:02:50.810

我建议您使用例如设计收据，`Crystal Reports`然后将其打印到热敏打印机上。过去，我很难使用他们的库从代码本身打印。我必须做一些字符映射，什么不行！

看看我一年多前问的[这个问题。](https://stackoverflow.com/questions/6808522/how-to-convert-utf-8-arabic-letters-to-codepage-1001)

就在几个月前，我发现我可以制作一份报告并打印到打印机！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-10-28T23:57:34.127

您可以使用任何报告器，如 Microsoft 报告查看器或水晶报告来设计您的收据，然后您可以打印它，这将处理语言问题，因为它取决于 Windows 字体。

# apache - Apache Hive 创建表

> ID：14446998
> 
> 赞同：3
> 
> 时间：2013-01-21T20:50:42.090
> 
> 标签：apache, hadoop, hive

我很难理解这段 Apache Hive 代码背后的真正含义，有人可以向我解释这段代码是否真的在做任何事情吗？

```
ALTER TABLE a RENAME TO a_tmp;
DROP TABLE a;
CREATE TABLE a AS SELECT * FROM a_tmp; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T21:49:47.020

```
ALTER TABLE a RENAME TO a_tmp; 
```

这只是允许您将表重命名`a`为`a_tmp`.

假设您的表`a`最初指向`/user/hive/warehouse/a`，那么在执行此命令后，您的数据将被移动到`/user/hive/warehouse/a_tmp`并且 的内容`/user/hive/warehouse/a`将不再存在。请注意，这种移动 HDFS 目录的行为仅存在于更新版本的 Hive 中。在此之前，该`RENAME`命令仅更新元存储而不移动 HDFS 中的目录。

同样，如果你做一个`show tables`之后，你会看到`a`它不再存在，而是`a_tmp`存在。此时您无法再查询`a`，因为它不再在 Metastore 中注册。

```
DROP TABLE a; 
```

这基本上没有任何作用，因为您已经重命名`a`为`a_tmp`. 因此`a`元存储中不再存在。这仍然会打印“OK”，因为无事可做。

```
CREATE TABLE a AS SELECT * FROM a_tmp; 
```

您要求创建一个名为的全新表`a`并将其注册到元存储中。您还要求使用其中相同的数据填充它`a_tmp`（您已经从之前复制`a`过）

因此，简而言之，您将初始表移动到新表，然后将新表复制回原始表，因此这些查询所做的唯一事情是将初始数据复制到`a`and`a_tmp`中。

# sql - 在 SQLite 中使用 CASE 条件从总数中添加或减去

> ID：14446999
> 
> 赞同：0
> 
> 时间：2013-01-21T20:50:48.570
> 
> 标签：sql, sqlite

我需要一个查询，使用 CASE 语句根据 SQLite 的条件进行减法或加法。这是我目前的查询：

```
SELECT s.companyName, CASE ia.type 
                      WHEN ia.type='add' THEN SUM(ia.quantity) 
                      WHEN ia.type='subtract' THEN SUM(-ia.type) 
                      ELSE SUM(0) END AS total
FROM stocktake s 
LEFT JOIN stocktake_adjustment sa ON s.stocktakeId = sa.stocktakeId
LEFT JOIN adjustment a ON a.adjustmentId = sa.adjustmentId
LEFT JOIN inventory_adjustment ia ON ia.adjustmentId = a.adjustmentId
LEFT JOIN inventory i ON i.inventoryId = ia.inventoryId 
LEFT JOIN supplier s ON s.supplierId = i.supplierId 
WHERE s.supplierId = '4da99b63-fcb9-9b9f-8415-4896caeb920c'; 
```

基本上，如果条件是“加”，我想从总数中添加或减去如果条件是减去。

提前谢谢你们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T20:55:32.027

将您`CASE`移入`SUM`：

```
SELECT s.companyName, SUM(CASE ia.type 
                          WHEN ia.type='add' THEN ia.quantity
                          WHEN ia.type='subtract' THEN -ia.quantity 
                          ELSE 0 
                          END)
                      AS total
FROM stocktake s 
LEFT JOIN stocktake_adjustment sa ON s.stocktakeId = sa.stocktakeId
LEFT JOIN adjustment a ON a.adjustmentId = sa.adjustmentId
LEFT JOIN inventory_adjustment ia ON ia.adjustmentId = a.adjustmentId
LEFT JOIN inventory i ON i.inventoryId = ia.inventoryId 
LEFT JOIN supplier s ON s.supplierId = i.supplierId 
WHERE s.supplierId = '4da99b63-fcb9-9b9f-8415-4896caeb920c'; 
```

（我认为`-ia.type`在原来的问题是一个错字，真正的意思`-ia.quantity`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T20:57:59.040

我认为您需要将 CASE 语句移动到 SUM 中，`ia.type`从`CASE`and之间删除`WHEN`（或更改为简单的 CASE 语句），并添加`GROUP BY`：

```
SELECT  s.companyName, 
        SUM(CASE WHEN ia.type = 'add' THEN ia.Quantity 
                WHEN ia.type = 'subtract' THEN -ia.Quantity 
                ELSE 0 
            END) AS total
FROM    stocktake s 
        LEFT JOIN stocktake_adjustment sa 
            ON s.stocktakeId = sa.stocktakeId
        LEFT JOIN adjustment a 
            ON a.adjustmentId = sa.adjustmentId
        LEFT JOIN inventory_adjustment ia 
            ON ia.adjustmentId = a.adjustmentId
        LEFT JOIN inventory i 
            ON i.inventoryId = ia.inventoryId 
        LEFT JOIN supplier s 
            ON s.supplierId = i.supplierId 
WHERE   s.supplierId = '4da99b63-fcb9-9b9f-8415-4896caeb920c'
GROUP BY s.CompanyName; 
```