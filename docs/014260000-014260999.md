# StackOverflow 问答 14260000-14260999

# ajax - 如何使用 selectOneListBox 和 AJAX 动态更改 panelGroup

> ID：14260006
> 
> 赞同：1
> 
> 时间：2013-01-10T14:21:05.337
> 
> 标签：ajax, jsf

我想根据所选项目更改菜单的外观。

如何使用托管 bean 获取 selectonelistbox 的值？

豆源：

```
 public void selectOneMenuListener(ValueChangeEvent event) {
    Object newValue = (String) event.getNewValue(); 
    selectedMenu = newValue.toString();
}

public String getSelectedMenu() {
    return selectedMenu;
}

public void setSelectedMenu(String selectedMenu) {
    this.selectedMenu = selectedMenu;
} 
```

页：

```
 <h:panelGroup id="panel">
    <h:selectOneListbox id="katProduktu" valueChangeListener="#{produkt_KatBean.selectOneMenuListener}">
        <f:selectItems value="#{produkt_KatBean.produkt_KatAllList}"
            var="pk" itemLabel="#{pk.symbol}" itemValue="#{pk.id}"/>
        <f:ajax render="produktMenu" event="change" execute="@this" />
    </h:selectOneListbox>
</h:panelGroup>

<h:panelGroup layout="block" id="produktMenu">
    <h:panelGroup rendered="#{produkt_KatBean.selectedMenu==1}">
        Menu 1
    </h:panelGroup>
    <h:panelGroup rendered="#{produkt_KatBean.selectedMenu==2}">
        Menu 2
    </h:panelGroup>
    <h:panelGroup rendered="#{produkt_KatBean.selectedMenu==3}">
        Menu 3
    </h:panelGroup>     
    <h:panelGroup rendered="#{produkt_KatBean.selectedMenu==4}">
        Manu 4
    </h:panelGroup>
</h:panelGroup> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:38:26.630

不要使用`valueChangeListener`. 这是工作的错误工具。只需将属性绑定到`value`菜单组件的属性，然后让`rendered`属性拦截它。这样你就完全不需要监听器了。此外，您的`rendered`比较不适用于字符串。您应该使用`== '1'`而不是`== 1`等等，但这很笨拙，只需制作它`Long`（或`Integer`）。

```
<h:panelGroup id="panel">
    <h:selectOneListbox id="katProduktu" value="#{produkt_KatBean.selectedMenu}">
        <f:selectItems value="#{produkt_KatBean.produkt_KatAllList}"
            var="pk" itemLabel="#{pk.symbol}" itemValue="#{pk.id}"/>
        <f:ajax render="produktMenu" />
    </h:selectOneListbox>
</h:panelGroup>

<h:panelGroup layout="block" id="produktMenu">
    <h:panelGroup rendered="#{produkt_KatBean.selectedMenu==1}">
        Menu 1
    </h:panelGroup>
    <h:panelGroup rendered="#{produkt_KatBean.selectedMenu==2}">
        Menu 2
    </h:panelGroup>
    <h:panelGroup rendered="#{produkt_KatBean.selectedMenu==3}">
        Menu 3
    </h:panelGroup>     
    <h:panelGroup rendered="#{produkt_KatBean.selectedMenu==4}">
        Manu 4
    </h:panelGroup>
</h:panelGroup> 
```

只需

```
private Long selectedMenu; // Or Integer? Should be the same type as #{pk.id}.

// +getter +setter 
```

*（请注意，我省略了`event`和`execute`属性，`<f:ajax>`因为它们已经代表了默认值）*

# backbone.js - 向backbone.io中的单个客户端发送事件

> ID：14260009
> 
> 赞同：0
> 
> 时间：2013-01-10T14:21:13.003
> 
> 标签：backbone.js, socket.io

我正在使用来自[https://github.com/scttnlsn/backbone.io](https://github.com/scttnlsn/backbone.io)的主干.io ，并希望使用该客户端的套接字 ID 向单个客户端发出事件。因此，与其`backend.emit('created', { id: 'myid', foo: 'bar' });`将事件发送给所有客户端，不如将其发送给单个客户端。

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T21:13:36.343

我会这样做：

为每个用户设置一个频道。如果您需要让其他客户端难以收听，请根据用户 ID 和登录时间或其他内容使用哈希命名频道。告诉客户收听该频道。

然后，如果您想向特定用户发送内容，您可以查看您的数据库，查看他们的 ID 和登录时间，然后将数据发送给该特定用户。

# android - 如何在 Android 中使用 WMS 和 WFS

> ID：14260015
> 
> 赞同：5
> 
> 时间：2013-01-10T14:21:25.573
> 
> 标签：android, map, wms

我在整个 Geo IT materia 中完全是新人：/，我的任务是检查一些在 Android 中查看地图的方法，并覆盖有矢量数据。

我有一个 WMS 和 WFS 服务，我可以在其中获取数据。但是我怎样才能将它集成到 Android 中呢？

Google Maps Api 不是免费用于商业用途吗？纽泰克也是吗？osmdroid 是否支持 wms/wfs 之类的东西？mapforge 呢？Mapforge 仅适用于离线地图，对吗？

有人有很好的教程如何构建这样的地图吗？

关于形状文件，我可以将 osm 地图图块与包含矢量数据的形状文件结合起来吗？

我知道这是很多问题，此刻我感觉就像一条被扔进新海的鱼。如果有人可以帮助我，我会很高兴:)

抱歉 4 我的英语不好。

问候马蒂亚斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-25T20:55:41.473

也许你可以检查这个链接： [Using getTileURL in Android Application with GeoServer](https://stackoverflow.com/questions/15553715/using-gettileurl-in-android-application-with-geoserver?rq=1)

我也在构建我在 android 中使用 WMS 的应用程序。我正在使用 Geoserver 作为服务器。到目前为止，它运行良好。我认为[此链接](http://www.azavea.com/blogs/labs/2013/01/wms-on-android/)足以为您提供如何在 android 中使用 wms 的教程。我希望它有帮助。如果我的英语不够好，我很抱歉

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-11T17:03:03.790

实现 WMS、WMS-C(ontext) 和 WFS

[http://openscales.org/](http://openscales.org/)

OpenScales 是一个用 ActionScript 3 和 Flex 编写的开源 (LGPL) 映射框架，使开发人员能够构建富 Internet 映射应用程序。

桌面和移动（Android、iOS）应用程序都可以使用 OpenScales 创建。请参阅我们的 YouTube 频道。

iPad-Viewer 将于 2012 年初推出。

干杯

# php - 如何在带有if条件的javascript中解决这个setTime out？

> ID：14260021
> 
> 赞同：0
> 
> 时间：2013-01-10T14:21:43.983
> 
> 标签：php, javascript

这是我的脚本，它是 php 和 javascript 的组合

```
<?php
$countdown = strtotime("22:00") - time();
$itemtime = "22:00";
$realtime = substr(date('H:i'),0,5);
?>

<script>
var itemtime = "$itemtime";
var countdown = '$countdown';
var url = "$redirectpage";
var realtime = "$realtime";

// HOW WILL I ADD AN IF STATEMENT WITH THE SETTIMEOUT FUNCTION
// WHEREBY, if(realtime == itemtime) ..that's the only time the 
// redirection should occur

setTimeout(function(){
 location.href='$redirectpage'; 
    },countdown * 1000);

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:24:30.880

```
<?php
$countdown = strtotime("22:00") - time();
$itemtime = "22:00";
$realtime = substr(date('H:i'),0,5);
?>

<script>
var itemtime = "<?php echo $itemtime;?>";
var countdown = '<?php echo $countdown;?>';
var url = "$redirectpage";
var realtime = "<?php echo $realtime;?>";

// HOW WILL I ADD AN IF STATEMENT WITH THE SETTIMEOUT FUNCTION
// WHEREBY, if(realtime == itemtime) ..that's the only time the 
// redirection should occur

setTimeout(function(){
 if(realtime == itemtime) location.href='$redirectpage'; 
},countdown * 1000);
</script> 
```

假设`$redirectpage`是在 JavaScript 而不是 PHP 中设置的。如果它是在 PHP 中设置的，你需要像我上面那样分配它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T03:02:42.960

我最终得到了自己的解决方案，我把它放在 setTimeout 函数中

```
if(countdown < 0) setTimeout("location.reload(true);",1000); location.href= "$redirectpage"; 
```

# jquery - jquery如何验证文件字段？

> ID：14260026
> 
> 赞同：1
> 
> 时间：2013-01-10T14:21:47.787
> 
> 标签：jquery, validation

我正在做一个验证过程，我需要2个建议一个是我做的方式是否正确？以及如何验证文件字段？

有人告诉我正确的方法吗？

```
var validateForm = function(form){
     var  submit = form.find(':submit'),
          elements = form.find(':input'),
          status = true;

     $('#contactForm').submit(function(event){

          $(elements).each(function(){

               var need = $(this).data('required');

               if(need === 'text' && !$.trim($(this).val()).length){
                    $(this).css({border:'1px solid red'});
                    status = false;
               }else{
                    status = true;
               }
               if(need === 'textarea' && !$.trim($(this).val()).length){
                    status = false;
               }else{
                    status = true;
               }
               if(need === 'checkbox' && !$(this).prop('checked')){
                    status = false;
               }else{
                    status = true;
               }
               if(need === 'file'){
                    //how to check the file elment? 
               }else{
                   status = true; 
               }
          })
          return status;
     })
} 
```

预先感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:45:14.323

要检查是否设置了文件输入，您可以使用

```
if ($('#yourFileInput').val()) {
   // file selected
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:55:37.743

您可以使用此[表单验证插件](http://docs.jquery.com/Plugins/Validation)

问候。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:50:37.700

通常，“文件”类型的输入将由用于上传文件的脚本进行验证。您通常可以限制文件大小、文件类型等。

如果您需要确保用户已在表单提交中包含文件，则当用户选择文件时，请使用 Uploadify 或 Plupload 等工具来验证文件，然后向表单返回一个标志以说明它已成功上传然后表单提交检查该标志。

[http://www.uploadify.com/](http://www.uploadify.com/)

[http://www.plupload.com/](http://www.plupload.com/)

# php - PHP 替换 MySQL Now()

> ID：14260027
> 
> 赞同：-4
> 
> 时间：2013-01-10T14:21:51.357
> 
> 标签：php, mysql, performance, optimization, query-optimization

我做了很多查询，例如：

```
SELECT THIS
FROM THAT
WHERE ROW_TIME < NOW() 
```

如何在 PHP 中创建包含当前时间的变量，以便我可以完成这项工作：

```
SELECT THIS
FROM THAT
WHERE ROW_TIME < '$variable' 
```

?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T14:23:04.663

PHP[`date($format)`](http://php.net/manual/en/function.date.php)函数以字符串形式返回当前时间。您可以使用字符串设置格式。

```
date("Y-m-d H:i:s") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:23:26.300

[PHP 日期](http://php.net/manual/en/function.date.php)函数会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:23:23.800

您应该使用 time() - 它返回一个时间戳。[http://php.net/manual/en/function.time.php](http://php.net/manual/en/function.time.php)

# php - 如何将一个连接用于 2 个或更多功能？

> ID：14260029
> 
> 赞同：0
> 
> 时间：2013-01-10T14:21:51.690
> 
> 标签：php, mysql, function, pdo, connection

我使用 PHP 的 PDO 连接到 MySQL。我有这个连接代码：

```
$dbh = new PDO ( $db_host.$db_database, $db_user, $db_pass );
$dbh->exec ( "set names utf8" ); 
```

我在另一个文件中有一个函数：

```
function Image()
{
    include 'config/connect.php';
    #connected         

    $sql = 'Select * from settings where name="X" ';
    $stmt = $dbh->prepare($sql);
    $stmt->execute();
    $row = $stmt->fetchObject();
    $Template = $row->web_site_template;
    echo "Template"; 
} 
```

我可以`include connect.php`为此使用文件，但事实并非如此。

我想使用像 connection() 这样的函数在所有其他函数上连接到 mysql，例如：

```
function Image()
{
    connection();

    $sql = 'Select * from settings where name="X" ';
    $stmt = $dbh->prepare($sql);
    $stmt->execute();
    $row = $stmt->fetchObject();
    $Template = $row->web_site_template;
    echo "Template"; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:28:23.533

这就是功能。把它放在你喜欢的任何文件中。

```
function connection() { 
$db_host = "..."; $db_database = "..."; $db_user = "..."; $db_pass = "...";
$GLOBALS["dbh"] = new PDO ( $db_host.$db_database, $db_user, $db_pass );
$GLOBALS["dbh"]->exec ( "set names utf8" );
} 
```

这是您的主要代码。如果您决定将其放在另一个文件中，请将该文件包含在上面的代码中。

```
connection();

$sql = 'Select * from settings where name="X" ';
$stmt = $dbh->prepare($sql);
$stmt->execute();
$row = $stmt->fetchObject();
$Template = $row->web_site_template;
echo "Template"; 
```

我会认为它是不好的编码风格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T09:49:04.947

我为我的问题找到了一个最佳解决方案（如何将 MYSQL 连接用于 1 个或多个函数）：

```
$db_database ="YourTableName";
$db_user     ="YourUsername";
$db_pass     ="YourPassword";
$db_host     ="YourHostName";

$dbh = new PDO ( "mysql:host=$db_host;dbname=$db_database", $db_user, $db_pass );
$dbh->exec ( "set names utf8" );

$database = $dbh; // Here you can use $dbh too, but I use $database to understand the difference here .

#start function
function Template(){
    global $database; //use $database as global

    $sql = 'Select * from YourTableName where column="Record"';
    $stmt = $database->prepare($sql); //use $database Instead $dbh 
    $stmt->execute();
    $row = $stmt->fetchObject();
    $Template = $row->web_site_template;
    echo $Template; 
   }

Template(); // Here is your result. 
```

# javascript - jquery幻灯片动画不同步

> ID：14260031
> 
> 赞同：0
> 
> 时间：2013-01-10T14:21:58.623
> 
> 标签：javascript, jquery, carousel

我目前有一个包含一些文本的轮播滑块。当用户单击“下一步”按钮时，.carousel-text div 朝上隐藏文本，轮播移动到下一张幻灯片，然后下一张幻灯片上的 .carousel-text 向下滑动以显示文本。

这在某些时候效果很好，但有时会出错，文本会在轮播之前上下滑动。我假设这是因为在整个序列完成之前单击了下一个按钮（整个过程需要 2 秒）。有没有办法在再次调用之前确保整个事情是完整的？

```
jQuery("#arrow-right").click(function () {

    jQuery('.carousel-text').animate({  
         marginTop: "-260px"
         }, 500, function() {
            jQuery('.carousel-inner').animate({ 
                marginLeft: "-700px"
                }, 1000, function() {
                    jQuery('.carousel-text').animate({  
                        marginTop: "0px"
                        }, 500, function() {
                            // Animation complete.
                        });         
                });
    });
} 
```

编辑：刚刚在这里做了一个jsfiddle：http: [//jsfiddle.net/UGE44/](http://jsfiddle.net/UGE44/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:29:17.123

在制作动画之前放置一个“.stop(true, true)”。这将停止以前的动画并允许新的动画同时开始。看起来像这样：

```
jQuery('.carousel-text').stop(true, true).animate({  
         marginTop: "-260px"
         }, 500, function() {
            jQuery('.carousel-inner').stop(true, true).animate({ 
                marginLeft: "-700px"
                }, 1000, function() {
                    jQuery('.carousel-text').stop(true, true).animate({  
                        marginTop: "0px"
                        }, 500, function() {
                            // Animation complete.
                        });         
                });
    }); 
```

您可能想玩弄您之前放置的动画，因为它可能不需要在所有三个位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:31:15.230

在动画之前设置“动画”标志并在动画完成后清除它。

```
jQuery("#arrow-right").click(function () {

    var $text = jQuery('.carousel-text');

    if ($text.data('animating') !== true) {

        $text.data('animating', true)
             .animate({  
            marginTop: "-260px"
         }, 500, function() {
            jQuery('.carousel-inner').animate({ 
                marginLeft: "-700px"
                }, 1000, function() {
                    jQuery('.carousel-text').animate({  
                        marginTop: "0px"
                        }, 500, function() {
                            $text.data('animating', false);
                            // Animation complete.
                        });         
                });
        });

    }

} 
```

# javascript - 我可以在 document.setcookie 中返回 document.getelementbyid 的值吗？

> ID：14260033
> 
> 赞同：2
> 
> 时间：2013-01-10T14:22:06.437
> 
> 标签：javascript, html, asp-classic

```
<input type=button value='Do Stuff' onClick='document.cookie = "Note_<% Response.Write(arrTest(0,i)) %> = ' + (Document.getElementById("StuffTest<% Response.Write(arrTest(0,i)) %>").value) + '"'> 
```

我在这里要做的是当用户点击按钮时，我想要一个使用以下值创建的 cookie：Note_(arrTest 的值) = (文本框的值)。

下面的代码工作得很好：

```
<input type=button value='Do Stuff' onClick='document.cookie = "Note_<% Response.Write(arrTest(0,i)) %> = Awesome!"'> 
```

它创建一个 cookie，其值为：Note_(value of arrTest) = Awesome！

将文本框的值放入 cookie 中我做错了什么？我假设它与所有那些令人困惑的单引号/双引号有关，所以我认为我只是有错字盲，但我的一部分认为我实际上不能做我在这里想做的事情。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T14:24:57.260

`document.getElementById`全部`document`小写。您的代码示例使用`Document`（带有大写字母`D`），这将失败。

另外，您在`onClick`属性中的引号不太正确。最好避免在这些属性中放置任何重要代码。相反，定义并调用一个函数，如下所示：

```
<input type=button
       value='Do Stuff'
       onClick='setCookie("<% Response.Write(arrTest(0,i)) %>);'> 
```

...函数（在`<script>`标签内或在一个引用的文件中）如下所示：

```
function setCookie(name) {
    document.cookie = "Name_" + name + "=" + document.getElementById("StuffTest" + name).value;
} 
```

根据 的内容`arrTest(0,i)`，您可能需要在输出时对其进行 HTML 编码，因为您将其输出为 HTML（是的，`onXYZ`属性内的代码是 HTML，就像任何其他属性的值一样，因此例如`<`需要是`&lt;`）。

# ios - 其他应用的 iOS 推送通知

> ID：14260037
> 
> 赞同：1
> 
> 时间：2013-01-10T14:22:30.773
> 
> 标签：ios, push-notification, notificationcenter

有没有办法接收所有应用程序的所有推送通知？那么所有通知都显示在通知中心吗？

如果是，是否也可以在收到来自任何应用程序的任何推送通知时执行操作？

谢谢

编辑：应用程序是否会被 Apple 接受并不重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:24:52.923

推送通知被发送到注册接收它们的应用程序。

您无法访问所有通知，因此简短的回答是**no**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T16:01:09.047

不，这是不可能的。Apple 认为通知是私密的。

没有（公共）方法可以让您的应用程序仍被 App Store 接受。

# java - 从套接字读取所有字节在 52964 字节处停止

> ID：14260043
> 
> 赞同：4
> 
> 时间：2013-01-10T14:22:41.973
> 
> 标签：java, c, sockets, ansi

我正在制作一个获取 64 kb 大小的包的服务器。

```
 int length = 65536;
        byte[] bytes = new byte[length];

        int pos = 0;
        while(pos < length -1)
        {
            System.out.println("Before read");
            pos += dis.read(bytes, pos, length-pos);
            System.out.println(""+pos+" >> "+ length);
        } 
```

这是我用来从套接字读取所有字节的代码。`Dis`是一个`InputStream`。当我运行 n 中的代码 1 时出错。该代码仅接收 52964 字节而不是`65536`字节。

我还检查了 C 代码，它说它发送`65536`字节。

有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:29:26.730

这是另一个案例，[Jakarta Commons IOUtils](http://commons.apache.org/proper/commons-io/javadocs/api-release/org/apache/commons/io/IOUtils.html)是比自己编写更好的选择。这是一行代码，并且已经过全面测试。我建议`IOUtils.readFully()`在这种情况下。

如果它没有读取整个缓冲区，那么您就知道您没有发送所有内容。也许您错过了服务器端的刷新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:28:58.227

`InputStream.read()`返回读取的字节数，如果已到达流的末尾，则返回 -1。您需要检查该错误情况。另外，我怀疑你的`while(..)`循环是问题所在。你为什么称它为`pos`在位？您可能会提前终止。此外，请确保您的 C 代码，无论它在做什么，都能正确发送。您可以使用[Wireshark](http://www.wireshark.org/)之类的工具检查网络流量以确保确定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:26:17.237

你是什​​么意思它“出错”？输出是什么？在读取完整的 64 KB 之前它不能退出循环，那么到底会发生什么？

此外，最好在假设 I/O 成功之前单独保存 I/O 调用的返回值并检查它。如果是`[DataInputStream.read()](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/DataInputStream.html#read%28byte%5B%5D%29)`，则在出错时返回 -1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T20:56:23.043

您的代码不正确，因为它不检查 -1。

这是使用 DataInputStream.readFully() 而不是自己编码并弄错的情况。

# sql - 加入两个临时表

> ID：14260054
> 
> 赞同：5
> 
> 时间：2013-01-10T14:23:25.333
> 
> 标签：sql, sql-server, sql-server-2008

我想加入两个临时表。

这是我的表：

```
CREATE TABLE #Result ( Process varchar(50), SuccessCount int, FailureCount int)
CREATE TABLE #SuccessResult ( Process varchar(50), SuccessCount int)
CREATE TABLE #FailureResult ( Process varchar(50), FailureCount int) 
```

我的表中有一些数据，这是我的查询：

```
INSERT INTO #Result (Process, SuccessCount, FailureCount)
SELECT s.Process,s.SuccessCount,f.FailureCount
FROM #SuccessResult s, #FailureResult as f
INNER JOIN #SuccessResult on f.Process = #SuccessResult.Process 
```

我收到此错误：

> 找不到多部分标识符 f.Process

我正在使用 Microsoft SQL Server 2008。

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T14:25:58.137

试试这个方法：

```
INSERT INTO #Result (Process, SuccessCount, FailureCount)
SELECT s.Process,s.SuccessCount,f.FailureCount
FROM #SuccessResult s 
INNER JOIN #FailureResult f on f.Process = #SuccessResult.Process 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T14:24:48.070

这是正确的语法`INSERT INTO ... SELECT ...`：

```
INSERT INTO #Result (Process, SuccessCount, FailureCount)
SELECT s.Process, s.SuccessCount, f.FailureCount
FROM #FailureResult as f
INNER JOIN #SuccessResult s on f.Process = s.Process 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T14:26:53.963

取出隐式连接。

```
INSERT INTO #Result (Process, SuccessCount, FailureCount)
SELECT s.Process,s.SuccessCount,f.FailureCount
FROM #SuccessResult s
INNER JOIN #FailureResult f on f.Process = s.Process 
```

# networking - 如何在没有电脑的情况下在本地网络上共享 sata 端口

> ID：14260058
> 
> 赞同：0
> 
> 时间：2013-01-10T14:23:33.397
> 
> 标签：networking, share, local, disk

我有 3 台电脑通过 4 端口路由器连接到本地网络

我想将外部硬盘连接到这个网络，但我不想使用任何计算机（因为它们并不总是在使用，有时我只使用一个主题）

有什么方法可以购买与此本地网络共享 sata 端口的设备

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:28:12.507

您正在寻找的称为 HD 的 NAS（网络附加存储）机箱。如果您还没有高清，您可以例如购买“Western Digital My Book Live”（“Live”部分很重要）。否则，您可以在某些情况下放置现有的 HD。

但是，这些情况不会“共享 SATA 端口”。相反，他们会将 HD 用作网络驱动器。

# google-app-engine - Guave EventBus 的这种使用会影响性能吗？

> ID：14260060
> 
> 赞同：0
> 
> 时间：2013-01-10T14:23:39.850
> 
> 标签：google-app-engine, event-handling, guava

我刚刚发现了谷歌的事件总线（经过 1 天的谷歌搜索“事件队列 java”“事件总线 java”并且只找到关于 GUI 的东西）。

这看起来很酷，但我的问题是：如果我们希望 eventbus 成为单例，我们必须将所有或观察者设为单例，这是不可能的，因为我在这个处理程序中也引用了我的 DataStore。

所以我选择为每个 http 请求创建一个事件总线，所以我必须为每个 http 请求注册我的所有处理程序（如果我的控制器选择要注册的事件处理程序将破坏整个模式）。

你认为这可能是个问题吗？或者注册处理程序真的很快，我不必担心。

# android - 使用 adb shell 为 ALT、SHIFT 等模拟两个键事件

> ID：14260062
> 
> 赞同：6
> 
> 时间：2013-01-10T14:23:52.530
> 
> 标签：android, adb

`adb shell input keyevent`可以模拟某些关键事件。还有修饰键`SHIFT_LEFT`，例如`ALT_RIGHT`等。

我想模拟两个键，例如 SHIFT + A，但是

```
 adb shell input keyevent SHIFT_LEFT; keyevent A 
```

结果只出现在`a`屏幕上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T14:43:20.023

如果需要 Shift + A 则您必须执行以下操作

```
Press shift
Press A
Release A
Release shift 
```

这可以通过使用来完成

命令格式：sendevent 设备类型码值

```
[command]     [device]             [type]    [code]   [value]
sendevent    /dev/input/event0    1          229      1 
```

/dev/input/event0 是将其发送到的设备

[type] 1 对我来说是未知的（可能是设备上物理按钮的代码）

【code】229是模拟器的MENU键

[value] 1 是 keydown 或 press down （对于 keyup 或 up 使用 0 ）

我编写了一个批处理文件，用于将事件发送到设备，如下所示：

```
adb -s emulator-5554 shell sendevent /dev/input/event0 1 229 1
adb -s emulator-5554 shell sendevent /dev/input/event0 1 229 0 
```

[参考](https://groups.google.com/forum/?fromgroups=#!msg/android-beginners/il2PqSKRFNI/jzG1Uk9gbs4J)

# ios - iOS facebook 集成 - 发送和接收请求

> ID：14260072
> 
> 赞同：0
> 
> 时间：2013-01-10T14:24:40.767
> 
> 标签：ios, facebook, facebook-requests

我使用 facebook api 连接到 facebook 并通过 api 提供的本机对话框发送请求。

我按照developers.facebook.com上的文档中发布的示例但是我在发送请求时遇到了以下问题：1.请求未显示在通知中 - 仅在应用程序中心 - 在这种情况下，我认为这是一个问题应用程序在沙盒中，未发布到 APPSTORE

1.  我成功地使用正确的 fbUser id 向 facebook 服务器发送请求。但是当我想在应用程序中接收通知时，问题就来了：

按照授权用户的文档，我应该在 open url 方法中设置这个：

```
fb[APP_ID]://authorize#expires_in=[ACCESS_TOKEN_EXPIRATION]
    &access_token=[USER_ACCESS_TOKEN]
    &target_url=https://apps.facebook.com/[APP_NAME_SPACE]/?request_ids=
    [COMMA_SEPARATED_REQUESTIDs]&ref=notif&app_request_type=user_to_user 
```

但我只能看到没有目标网址的普通登录……我可以看到会话到期日期、fb 应用程序 ID、访问令牌等。但是没有目标网址？

那么基本上target_url是什么？应该怎么设置？发送请求时我必须包括什么？

另外：应用程序句柄打开url方法被正确调用。应用程序激活后，也会正确调用 checkRequests 方法。

请不要将我链接到文档。我已经阅读了 50 遍，但没有找到任何合理的解决方案......

```
- (BOOL)application:(UIApplication *)application
                openURL:(NSURL *)url
      sourceApplication:(NSString *)sourceApplication
             annotation:(id)annotation {
        // attempt to extract a token from the url
        self.openedURL = url;
        NSLog(@"%@",url);
        return [FBSession.activeSession handleOpenURL:url];
    }

    - (void)sendRequest {
        FBSBJSON *jsonWriter = [FBSBJSON new];
        NSDictionary *gift = [NSDictionary dictionaryWithObjectsAndKeys:
                              @"5", @"points",
                              @"1", @"badge",
                              nil];

        NSString *giftStr = [jsonWriter stringWithObject:gift];
        NSMutableDictionary* params =
        [NSMutableDictionary dictionaryWithObjectsAndKeys:
         @"Hi from test app", @"message",
         giftStr, @"data",
         nil];

        [self.facebook dialog:@"apprequests"
                    andParams:params
                  andDelegate:self];
    }

    // Handle the request call back
    - (void)dialogCompleteWithUrl:(NSURL *)url {
        NSDictionary *params = [self parseURLParams:[url query]];
        NSString *requestID = [params valueForKey:@"request"];
        NSLog(@"Request ID: %@", requestID);
    }
    -(FBSession*)returnSession{
        return self.session;
    }
    /*
     * Helper function to get the request data
     */
    - (void) notificationGet:(NSString *)requestid {
        [FBRequestConnection startWithGraphPath:requestid
                              completionHandler:^(FBRequestConnection *connection,
                                                  id result,
                                                  NSError *error) {
                                  if (!error) {
                                      NSString *title;
                                      NSString *message;
                                      if ([result objectForKey:@"data"]) {
                                          title = [NSString
                                                   stringWithFormat:@"%@ sent you a gift",
                                                   [[result objectForKey:@"from"]
                                                    objectForKey:@"name"]];
                                          FBSBJSON *jsonParser = [FBSBJSON new];
                                          NSDictionary *requestData =
                                          [jsonParser
                                           objectWithString:[result objectForKey:@"data"]];
                                          message =
                                          [NSString stringWithFormat:@"Badge: %@, Karma: %@",
                                           [requestData objectForKey:@"badge"],
                                           [requestData objectForKey:@"points"]];
                                      } else {
                                          title = [NSString
                                                   stringWithFormat:@"%@ sent you a request",
                                                   [[result objectForKey:@"from"] objectForKey:@"name"]];
                                          message = [NSString stringWithString:
                                                     [result objectForKey:@"message"]];
                                      }
                                      UIAlertView *alert = [[UIAlertView alloc]
                                                            initWithTitle:title
                                                            message:message
                                                            delegate:nil
                                                            cancelButtonTitle:@"OK"
                                                            otherButtonTitles:nil,
                                                            nil];
                                      [alert show];
                                      // Delete the request notification
                                      [self notificationClear:[result objectForKey:@"id"]];
                                  }
                              }];
    }

    /*
     * Helper function to check incoming URL
     */
    - (void) checkIncomingNotification {

        if (self.openedURL) {
            NSString *query = [self.openedURL fragment];
            if (!query) {
                query = [self.openedURL query];
            }
            NSDictionary *params = [self parseURLParams:query];
            for (NSString * str in [params allKeys]) {

                NSLog(@"key %@", str);
            }
            // Check target URL exists
            NSString *targetURLString = [params valueForKey:@"target_url"];

            if (targetURLString) {
                NSURL *targetURL = [NSURL URLWithString:targetURLString];
                NSDictionary *targetParams = [self parseURLParams:[targetURL query]];
                NSString *ref = [targetParams valueForKey:@"ref"];
                // Check for the ref parameter to check if this is one of
                // our incoming news feed link, otherwise it can be an
                // an attribution link
                if ([ref isEqualToString:@"notif"]) {
                    // Get the request id
                    NSString *requestIDParam = [targetParams
                                                objectForKey:@"request_ids"];
                    NSArray *requestIDs = [requestIDParam 
                                           componentsSeparatedByString:@","];

                    // Get the request data from a Graph API call to the
                    // request id endpoint
                    [self notificationGet:[requestIDs objectAtIndex:0]];
                }
            }
            // Clean out to avoid duplicate calls
            self.openedURL = nil;
        }
    } 
```

有没有什么办法可以说明这些问题是由应用程序未在 Appstore 上发布的方式引起的（iPhone 和 iPad 都没有设置 Appstore id）？

以下是显示使用 fb api 的代码片段：

非常感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T22:33:12.793

在 Facebook 应用设置中启用深度链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-18T10:57:45.400

[Facebook sdk 3.5 请求不起作用](https://stackoverflow.com/questions/16911730/facebook-sdk-3-5-requests-not-working)

我认为这个链接会对你有所帮助，也可以在 Facebook 上配置应用程序

# uiimageview - 如何使用 uiimage 为 uitextfield 设置背景

> ID：14260085
> 
> 赞同：0
> 
> 时间：2013-01-10T14:24:58.667
> 
> 标签：uiimageview, uitextfield

`UITextField`我想为宽度：300 和`UIImageVIew`（22x43）设置背景图像，但我`UIImageVIew`的不适合我的`UITextField`

那么，我该如何实现呢？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T07:52:12.353

你可以试试 ：

```
myTextField.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"myImage.png"]]; 
```

# c# - 导入 Microsoft.Sharepoint 命名空间

> ID：14260089
> 
> 赞同：0
> 
> 时间：2013-01-10T14:25:04.213
> 
> 标签：c#, sharepoint, sharepoint-2010, namespaces, caml

谁能知道，如何将 Microsoft.Sharepoint dll 导入控制台应用程序？我想在不部署共享点站点的情况下测试 CAML 查询结果。我将 dll 添加到应用程序的引用中，当然还有 using 指令，但是当我构建程序时，它找不到...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T18:21:02.917

假设您使用 Visual Studio 2010 并假设您在具有 Sharepoint 的环境中使用 Visual Studio。您将在“添加引用”部分找到一个 Sharepoint 选项卡。

请注意，如果您在控制台应用程序上使用 Microsoft.Sharepoint 命名空间。您必须在安装 Sharepoint 的服务器上运行控制台应用程序。

您可以考虑使用 Sharepoint 客户端对象模型。这允许您从外部位置连接到 Sharepoint。但是，CAML 查询有点不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:41:25.523

抱歉回复晚了，感谢大家的帮助。我建立了问题的解决方案。问题发生在编译时似乎错过了命名空间。解决方案是我需要将目标框架和目标平台更改为与原始 Sharepoint 应用程序相同。

# php - Yii 在自定义 CListView 中插入 html

> ID：14260091
> 
> 赞同：1
> 
> 时间：2013-01-10T14:25:07.030
> 
> 标签：php, yii, widget

我的问题：两个分页选项在不同的行上。

我有：

```
<div class="search_result searchconright">
    <?php
    $this->widget('zii.widgets.CListView', array(
        'id' => 'listViewSearch',
        'dataProvider' => $model->search(),
        'itemView' => '_index_post',
        'enablePagination' => true,
        'pager' => array(
                        'cssFile' => Yii::app()->baseUrl . '/css/clistview.css',
                        'header' => false,
                        'firstPageLabel' => 'First',
                        'prevPageLabel' => 'Previous',
                        'nextPageLabel' => 'Next',
                        'lastPageLabel' => 'Last',
                    ),
        'summaryText' => '',
        'sortableAttributes' => array(
        ),
    ));
    ?>
</div>
<div class="pagetxt">
    <span>View</span>
    <a class="page_search_limit">All</a>
    &nbsp;&nbsp;
    <a class="page_search_limit page_search_limit_active">3</a>
    &nbsp;
    <a class="page_search_limit page_search_limit_active">5</a>
    &nbsp;
    <a class="page_search_limit page_search_limit_active">24</a>
    &nbsp;
    <a class="page_search_limit">48</a>
</div> 
```

我想在小部件中插入类 pagetxt 的整个 html，因为第二个分页位于小部件分页下；我希望他们在同一条线上

另外，欢迎提出其他建议

分页：![在此处输入图像描述](../Images/f5355139e640ade8bcca8d3246781ed2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:35:03.640

我认为你可以用 CSS 做到这一点：

```
.search_result, .pagetxt {
    display: inline-block;
} 
```

要更改 CListView 分页 HTML，您必须创建一个新的 CLinkPager 并将参数传递给它。所以我认为CSS更简单:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:35:32.423

这纯粹是一个布局问题：您需要让分页器与您的自定义 HTML 内联呈现。

一种方法是`display: line-block`使用 CSS 为这两个 DIV 提供，但当然您也可以使用其他技术，如浮动。

`pagerCssClass`您可以通过在列表视图中设置属性来轻松定位股票寻呼机；默认是简单的`"pager"`，所以你可以这样做

```
$this->widget('zii.widgets.CListView', array(
        'id' => 'listViewSearch',
        'pagerCssClass' => 'pager pager-inline'
        // ...
); 
```

然后例如

```
.pager.pager-inline, .pagetxt {
    display: inline-block;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T15:35:51.500

您有 2 个选项，首先是您的操作方式，您可以使用 CListView 的[模板](http://www.yiiframework.com/doc/api/1.1/CListView#template-detail)属性，将 HTML 添加到小部件内您想要的位置。

但看起来您正在尝试做的是允许用户指定他们希望每页看到的元素数量，所以我建议使用类似[PageSize 扩展](http://www.yiiframework.com/extension/pagesize/)

# php - 在 PHPMYSQL 中分配一次性用户名

> ID：14260092
> 
> 赞同：1
> 
> 时间：2013-01-10T14:25:09.817
> 
> 标签：php

我正在做一个`login` `Script`. 我有一个注册及其登录名，我需要提供一次访问/登录名，我在`database`表名中的字段`qz_userauth`为`ID` `fname` `lname` `email` `username` `password`. `login`一次尝试后限制。可能的 ？

这是`login Form`

```
<form action="functions.php" method="post" id="login">
                <fieldset>
                    <legend>Login </legend>
                    <ul>
                        <li>
                            <label for="username"><span class="required">Username</span></label>
                            <input id="username" name="username" class="text required" type="text" />
                            <label for="username" class="error">This field cannot be empty</label>
                        </li>

                        <li>
                        <label for="password"><span class="required">Password</span></label>
                        <input name="password" type="password" class="text required" id="password" maxlength="20" />
                    </li>
                    <?php if($_SESSION['LCNT']>=4){  ?>
                    <li>
                        <p id="p-captcha">
                            <div id="captchaImg"><img id="captcha" src="captcha/securimage_show.php" alt="CAPTCHA Image" /></div>
                            <div id="captchaInput"><input type="text" name="captcha_code" size="16" maxlength="6" value="Enter Captcha" /></div>
                            <div id="captchaRefresh"><a href="#" onclick="document.getElementById('captcha').src = 'captcha/securimage_show.php?' + Math.random(); return false"><img src="captcha/images/refresh.gif" /></a></div>
                        </p>
                    </li>
                    <?php } ?>
                    <li>
                        <label class="centered info"><a id="forgotpassword" href="fpass.php">Forgot Your password...</a></label>
                    </li>
                </ul>
            </fieldset>
            <input type="hidden" name="action" value="login" />
            <fieldset class="submit">
                <input type="submit" class="sbutton" value="Login" /> &nbsp; <input type="button" class="sbutton" value="Register"  onclick="window.location='register.php'" />
            </fieldset>

        </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T14:27:26.840

只需在表中再设置一个字段作为标志。并在一次登录尝试后将 flag 的值设置为 false。并在登录期间检查标志值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:27:14.290

如果您的意思是要求每个用户一次只允许 1 次登录，那么您可以在表中添加另一个字段，例如**login_status**。用户登录时设置为 1，注销时设置为 0。然后在您的登录脚本中检查这是否为 0，然后才允许登录

# jquery - 视频末尾的不同海报图片（媒体 js）

> ID：14260099
> 
> 赞同：0
> 
> 时间：2013-01-10T14:25:19.990
> 
> 标签：jquery, mediaelement.js

我正在使用以下内容：

```
 jQuery("video").mediaelementplayer({
        features: ["playpause","progress","current","duration","volume","fullscreen"],
        success:  function (mediaElement, domObject) { 
            mediaElement.addEventListener("ended", function(e){ 
                // Revert to the poster image when ended
                var $thisMediaElement = (mediaElement.id) ? jQuery("#"+mediaElement.id) : jQuery(mediaElement);
                $thisMediaElement.parents(".mejs-inner").find(".mejs-poster").show();
            });
        }
    }); 
```

在正在播放的视频结束时恢复为海报图像。我如何让它恢复为新图像，即`poster-start.png`（视频开始），然后（视频结束）`poster-end.png`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-06T16:58:06.067

我这样做的方法是在 end 函数中更改`mejs-poster`div 中的 html。`$thisMediaElement`在设置变量的下方的 end 函数中添加这一行。

```
$thisMediaElement
    .parents(".mejs-inner")
    .find(".mejs-poster")
    .html('<img src="images/poster2.png">'); 
```

# python - 单元测试cherrypy webapp

> ID：14260101
> 
> 赞同：12
> 
> 时间：2013-01-10T14:25:25.157
> 
> 标签：python, unit-testing, cherrypy

我最近不得不重写我们的 rest api，并从 Flask 切换到 Cherrypy（主要是由于 Python 3 的兼容性）。但是现在我一直在尝试编写单元测试，Flask 有一个非常漂亮的内置测试客户端，您可以使用它向您的应用程序发送虚假请求（无需启动服务器。）我找不到任何类似的功能对于 Cherrypy，是否有这样的功能，或者我是否卡在启动服务器并对它进行实际请求？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-10T15:13:57.577

据我所知，CherryPy 确实没有为这种类型的测试提供工具（没有运行的服务器）。但它仍然很容易做到（尽管它依赖于 CherryPy 的一些内部结构）。

这是一个简单的展示：

```
from StringIO import StringIO
import unittest
import urllib

import cherrypy

local = cherrypy.lib.httputil.Host('127.0.0.1', 50000, "")
remote = cherrypy.lib.httputil.Host('127.0.0.1', 50001, "")

class Root(object):
    @cherrypy.expose
    def index(self):
        return "hello world"

    @cherrypy.expose
    def echo(self, msg):
        return msg

def setUpModule():
    cherrypy.config.update({'environment': "test_suite"})

    # prevent the HTTP server from ever starting
    cherrypy.server.unsubscribe()

    cherrypy.tree.mount(Root(), '/')
    cherrypy.engine.start()
setup_module = setUpModule

def tearDownModule():
    cherrypy.engine.exit()
teardown_module = tearDownModule

class BaseCherryPyTestCase(unittest.TestCase):
    def webapp_request(self, path='/', method='GET', **kwargs):
        headers = [('Host', '127.0.0.1')]
        qs = fd = None

        if method in ['POST', 'PUT']:
            qs = urllib.urlencode(kwargs)
            headers.append(('content-type', 'application/x-www-form-urlencoded'))
            headers.append(('content-length', '%d' % len(qs)))
            fd = StringIO(qs)
            qs = None
        elif kwargs:
            qs = urllib.urlencode(kwargs)

        # Get our application and run the request against it
        app = cherrypy.tree.apps['']
        # Let's fake the local and remote addresses
        # Let's also use a non-secure scheme: 'http'
        request, response = app.get_serving(local, remote, 'http', 'HTTP/1.1')
        try:
            response = request.run(method, path, qs, 'HTTP/1.1', headers, fd)
        finally:
            if fd:
                fd.close()
                fd = None

        if response.output_status.startswith('500'):
            print response.body
            raise AssertionError("Unexpected error")

        # collapse the response into a bytestring
        response.collapse_body()
        return response

class TestCherryPyApp(BaseCherryPyTestCase):
    def test_index(self):
        response = self.webapp_request('/')
        self.assertEqual(response.output_status, '200 OK')
        # response body is wrapped into a list internally by CherryPy
        self.assertEqual(response.body, ['hello world'])

    def test_echo(self):
        response = self.webapp_request('/echo', msg="hey there")
        self.assertEqual(response.output_status, '200 OK')
        self.assertEqual(response.body, ["hey there"])

        response = self.webapp_request('/echo', method='POST', msg="hey there")
        self.assertEqual(response.output_status, '200 OK')
        self.assertEqual(response.body, ["hey there"])

if __name__ == '__main__':
    unittest.main() 
```

编辑，我已将此答案扩展为[CherryPy recipe](https://bitbucket.org/Lawouach/cherrypy-recipes/src/50aff88dc4e24206518ec32e1c32af043f2729da/testing/unit/serverless?at=default)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-22T11:23:29.540

似乎有另一种执行单元测试的方法。我刚刚找到并检查了以下适用于cherrypy 3.5的配方。

[http://docs.cherrypy.org/en/latest/advanced.html#testing-your-application](http://docs.cherrypy.org/en/latest/advanced.html#testing-your-application)

```
 import cherrypy

    from cherrypy.test import helper

    class SimpleCPTest(helper.CPWebCase):
        def setup_server():
            class Root(object):
                @cherrypy.expose
                def echo(self, message):
                    return message

            cherrypy.tree.mount(Root())
        setup_server = staticmethod(setup_server)

        def test_message_should_be_returned_as_is(self):
            self.getPage("/echo?message=Hello%20world")
            self.assertStatus('200 OK')
            self.assertHeader('Content-Type', 'text/html;charset=utf-8')
            self.assertBody('Hello world')

        def test_non_utf8_message_will_fail(self):
            """
            CherryPy defaults to decode the query-string
            using UTF-8, trying to send a query-string with
            a different encoding will raise a 404 since
            it considers it's a different URL.
            """
            self.getPage("/echo?message=A+bient%F4t",
                         headers=[
                             ('Accept-Charset', 'ISO-8859-1,utf-8'),
                             ('Content-Type', 'text/html;charset=ISO-8859-1')
                         ]
            )
            self.assertStatus('404 Not Found') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-01T01:59:10.913

我发现 Sylvain Hellegouarch 的答案对解决这个问题非常有帮助，但它使用 Python 2。我调整了他们的答案以使用 Python 3：

```
import io
import unittest
import urllib
import urllib.parse

import cherrypy
from cherrypy.lib import httputil

local = httputil.Host('127.0.0.1', 50000, '')
remote = httputil.Host('127.0.0.1', 50001, '')

class Root(object):
    @cherrypy.expose
    def index(self):
        return 'hello world'

    @cherrypy.expose
    def echo(self, msg):
        return msg

def setUpModule():
    cherrypy.config.update({'environment': 'test_suite'})

    # prevent the HTTP server from ever starting
    cherrypy.server.unsubscribe()

    cherrypy.tree.mount(Root(), '/')
    cherrypy.engine.start()

setup_module = setUpModule

def tearDownModule():
    cherrypy.engine.exit()

teardown_module = tearDownModule

class BaseCherryPyTestCase(unittest.TestCase):
    def webapp_request(self, path='/', method='GET', **kwargs):
        headers = [('Host', '127.0.0.1')]
        qs = fd = None

        if method in ['POST', 'PUT']:
            qs = urllib.parse.urlencode(kwargs)
            headers.append(('content-type', 'application/x-www-form-urlencoded'))
            headers.append(('content-length', f'{len(qs)}'))
            fd = io.BytesIO(qs.encode())
            qs = None
        elif kwargs:
            qs = urllib.parse.urlencode(kwargs)

        # Get our application and run the request against it
        app = cherrypy.tree.apps['']
        # Let's fake the local and remote addresses
        # Let's also use a non-secure scheme: 'http'
        request, response = app.get_serving(local, remote, 'http', 'HTTP/1.1')
        try:
            response = request.run(method, path, qs, 'HTTP/1.1', headers, fd)
        finally:
            if fd:
                fd.close()
                fd = None

        if response.output_status.startswith(b'500'):
            print(response.body)
            raise AssertionError('Unexpected error')

        # collapse the response into a bytestring
        response.collapse_body()
        return response

class TestCherryPyApp(BaseCherryPyTestCase):
    def test_index(self):
        response = self.webapp_request('/')
        self.assertEqual(response.output_status, b'200 OK')
        # response body is wrapped into a list internally by CherryPy
        self.assertEqual(response.body, [b'hello world'])

    def test_echo(self):
        response = self.webapp_request('/echo', msg='hey there')
        self.assertEqual(response.output_status, b'200 OK')
        self.assertEqual(response.body, [b'hey there'])

        response = self.webapp_request('/echo', method='POST', msg='hey there')
        self.assertEqual(response.output_status, b'200 OK')
        self.assertEqual(response.body, [b'hey there']) 
```

# bloomberg - 使用什么语言开发 Bloomberg App Portal 应用程序

> ID：14260102
> 
> 赞同：7
> 
> 时间：2013-01-10T14:25:40.313
> 
> 标签：bloomberg

如下所述，开发人员将使用什么语言为彭博应用门户开发应用程序：[彭博新闻发布室](http://www.bloomberg.com/pressroom/bloomberg-launches-enterprise-app-portal-to-financial-markets/)

具体来说，我不是在问如何通过 Anywhere API 在桌面上与 BBG 集成。这是在终端中部署自定义“应用程序”的问题。

也许应该单独提出的后续问题是，是否有任何小公司在那里成功部署了应用程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-24T08:02:06.283

根据此链接 singledealerplatforms.org/tag/bloomberg-app-portal/ 使用的语言是 C#，

```
For $500 per month, developers will be given access to a Software Development Kit (SDK), documentation, data feed, up to 3 Terminals and developer support
Apps are subject to code review before being accepted onto the Portal
Apps are written in C# using .NET and Windows Presentation Foundation (WPF) 
```

根据这个链接 www.moneymanagement.com.au/product-news/2012/bloomberg-app-portal-financial-services-software 应用程序门户的设计是为了让博士生可以发布他们自己的应用程序——他们可能会说这里有一个真实的案例。

如果您进行更多搜索，您会遇到一些看起来像是来自小型/新公司的应用程序，为什么不给他们发电子邮件并询问呢？ [例如http://www.percentageit.com/](http://www.percentageit.com/)是一家为第三方开发应用程序的小公司，[http](http://www.bbapplabs.com) ://www.bbapplabs.com 与亚洲类似

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-14T08:49:50.033

我实际上正在为Bloomberg App Portal 开发一个应用程序。

您必须使用 C# 和 WPF 进行编程（如 windows8 应用程序）

今天有 70 个应用程序可用，其中大多数来自中小型公司。

Bloomberg 提供 3 个开发终端，每月 2500 美元（30000/年），它还授权最多 25 个用户。然后你必须为 100 个额外的用户支付 1000 美元

这个成本可能令人望而却步。我认为这就是为什么 1.5 年后只有 70 个应用程序的原因。

# scala - 删除重复项

> ID：14260103
> 
> 赞同：1
> 
> 时间：2013-01-10T14:25:46.513
> 
> 标签：scala, csv, duplicates

我想从我的 CSV 文件中的数据中删除重复项。第一列是年份，第二列是句子。无论年份信息如何，我都想删除任何重复的句子。

有没有我可以在 val text = { } 中插入的命令来删除这些欺骗？

我的脚本是：

```
val source = CSVFile("science.csv");

val text = {
source ~>                              
Column(2) ~>                           
TokenizeWith(tokenizer) ~>             
TermCounter() ~>                       
TermMinimumDocumentCountFilter(30) ~>  
TermDynamicStopListFilter(10) ~>      
DocumentMinimumLengthFilter(5)         
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T00:31:38.473

本质上，您需要一个 distinct 版本，您可以在其中指定使对象（行）唯一（第二列）的原因。

给定代码：（修改后的 SeqLike.distinct）

```
type Row = (Int, String)
def distinct(rows:Seq[Row], f: Row => AnyRef) = {
   val b = newBuilder
   val seen = mutable.HashSet[AnyRef]()
   val key = f(x)
   for (x <- rows) {
     if (!seen(key)) {
       b += x
       seen += key
     }
   }
   b.result
 } 
```

如果您有一个行列表（其中一行是一个元组），您可以根据第二列获得过滤/唯一的行

```
distinct(rows, (_._2)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:52:50.693

由于集合自然地消除了重复，一种简单的方法是将行填充到 a[`TreeSet`](http://www.scala-lang.org/api/current/index.html#scala.collection.immutable.TreeSet)中，使用仅考虑每行的文本部分的自定义排序。

### 更新

这是一个示例脚本来演示上述内容：

```
import collection.immutable.TreeSet
import scala.io.Source

val lines = Source.fromFile("science.csv").getLines()
val uniques = lines.foldLeft(TreeSet[String]()(Ordering.by(_.split(',')(1)))) {
  (s, l) =>
    if (s contains l) s
    else s + l
}
uniques.toList.sorted foreach println 
```

该脚本根据逗号分隔行的第二部分将行序列折叠成具有自定义排序的树集。最简单的折叠函数是`(s, l) => s + l`; 但是，这将导致具有较晚年份的行覆盖具有早年相同文本的行。这就是为什么我必须首先测试收容措施。

现在我们几乎准备好了，我们只需要在打印之前按年份重新排序集合（假设输入是按年份排序的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T15:04:56.187

你需要让你的代码可重现吗？如果没有，那么在excel中，点击“数据”选项卡，点击“1”正上方和“A”左侧的小框突出显示所有内容，点击“删除重复项”，确保“我的数据有标题”如果您有标题，则选中，然后取消单击包含年份的列，只保留旁边带有复选标记的句子的列。这将删除重复的句子，但保留年份的第一个实例。

# c# - asp.net/c#中的随机函数有多安全#

> ID：14260107
> 
> 赞同：2
> 
> 时间：2013-01-10T14:25:51.673
> 
> 标签：c#, asp.net, random

我正在开发一个密码生成器，它将在网页上运行。我正在使用 .net 的内置功能`Random()`；函数生成随机数。然后它们用于从字符串中选择不同的大写/小写字符和数字。

我想知道的是，它使用起来有多安全`Random()`；生成密码的功能。请注意，这些密码会在 2 分钟后过期，并且页面将只允许每个 IP 地址生成 3 次。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T14:29:24.847

`Random`如果您需要密码安全，请勿使用。

使用[`RNGCryptoServiceProvider`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.aspx).

> 使用加密服务提供商 (CSP) 提供的实现来实现加密随机数生成器 (RNG)。这个类不能被继承。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-10T14:29:09.997

如果你想要一个安全的随机数，你可以编写一个继承自[System.Security.Cryptography.RandomNumberGenerator的类](http://msdn.microsoft.com/en-us/library/system.security.cryptography.randomnumbergenerator.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T14:32:54.160

`System.Random`不安全。最大的弱点是它只有一个 31 位的种子，它是从一个可预测的来源 ( `Environment.TickCount`) 播种的。因此，知道您的实例何时`Random`创建的攻击者可能会将可能的密码缩小到少数几个。

算法本身也不安全。可能通过观察其中一些来预测未来的输出。

使用派生自 的类[`System.Security.Cryptography.RandomNumberGenerator`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.randomnumbergenerator.aspx)，例如[`RNGCryptoServiceProvider`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.aspx)生成安全随机数。

要生成一个安全的随机字符串，我建议我对[如何在 C# 中生成随机 8 个字符的字母数字字符串？](https://stackoverflow.com/a/13416143/445517). 请注意，大多数其他答案都不安全。

# c# - 如何使用 JavaScriptSerializer 在 C# 中执行结构序列化

> ID：14260112
> 
> 赞同：2
> 
> 时间：2013-01-10T14:26:00.133
> 
> 标签：c#, serialization, xml-serialization

我有一个要求，我想`System.Windows.FontWeight,FontStretch`在`JavaScriptSerializer`.

但是在将具有结构数据类型属性的对象序列化为 json 时，它给出了上述属性的空 json 值。

上述问题的任何通用解决方案？

谢谢

迪拉吉五世

# css - 有没有办法在 webkit 浏览器中制作透明的自定义滚动条轨道？

> ID：14260114
> 
> 赞同：14
> 
> 时间：2013-01-10T14:26:02.367
> 
> 标签：css, webkit, scrollbar

我正在尝试设计将出现在 DIV 上的滚动条的样式，这些滚动条将出现在我正在处理的设计中。它只是 webkit，所以我认为我可以只使用 CSS 而不是插件。

不幸的是，我遇到了一个重大问题。该设计要求滚动条以透明效果与内容重叠，很像 OS X Mountain Lion / iOS。

当自定义样式应用于滚动条时，它会调整内容的大小以适应滚动条。我已经设法调整内容的大小，以便在检查器中它现在显示在滚动条下方，但我似乎无法制作滚动条轨道透明。

我已经尝试将这些应用到 ::-webkit-scrollbar 和 ::-webkit-scrollbar-track 区域：

*   背景：透明
*   带 rgba 的透明背景色
*   具有透明度的背景图像

似乎没有一个工作。在我放弃并尝试 JavaScript 自定义滚动条解决方案之前，我想看看其他人是否有答案。

```
* {
  list-style:none;
  margin:0;
  padding:0;
}
body {
  padding:20px;
}
#content {
  background:#333;
  height:400px;
  padding:1px;
  width:398px;
}
#content li {
  background:#666;
  height:100px;
  margin-bottom:10px;
  width:400px;
}
.scrollable-content {
  overflow-x:hidden;
  overflow-y:scroll;
}
.scrollable-content::-webkit-scrollbar {
  background:transparent;
  width:30px;
}
.scrollable-content::-webkit-scrollbar-track {
  background:transparent;
}
.scrollable-content::-webkit-scrollbar-thumb {
  background:#999;
}
```

```
<ol class="scrollable-content" id="content">
  <li></li>
  <li></li>
  <li></li>
  <li></li>
  <li></li>
  <li></li>
</ol>
```

我已经检查了这些：

[webkit css滚动条样式](https://stackoverflow.com/questions/7224634/webkit-css-scrollbar-styling)

[如何防止 webkit-scrollbar 推送 div 的内容？](https://stackoverflow.com/questions/13054797/how-to-prevent-a-webkit-scrollbar-from-pushing-over-the-contents-of-a-div)

[CSS：可以将 Webkit 滚动条“推送”到内容中吗？](https://stackoverflow.com/questions/6719895/css-possible-to-push-webkit-scrollbars-into-content)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-17T21:10:10.627

我已经更新了你的小提琴示例-> [http://jsfiddle.net/F9p7S/](http://jsfiddle.net/F9p7S/)

试试这个方法：

```
.scrollable-content::-webkit-scrollbar * {
    background:transparent;
}
.scrollable-content::-webkit-scrollbar-thumb {
    background:#999 !important;
} 
```

# mysql - 只需删除 sql 表中的重复内容

> ID：14260117
> 
> 赞同：0
> 
> 时间：2013-01-10T14:26:15.483
> 
> 标签：mysql, sql, duplicates, innodb

我想知道是否有一种简单的方法可以从表 sql 中删除重复项。

如果它们出现两次，而不是获取整个表并删除数据。

先感谢您

这是我的结构：

```
CREATE TABLE IF NOT EXISTS `mups` (
  `idgroupe` varchar(15) NOT NULL,
  `fan` bigint(20) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:30:53.270

如果您使用的是 Sql Server

检查这个：**[SQL SERVER – 2005 – 2008 – 删除重复行](http://blog.sqlauthority.com/2009/06/23/sql-server-2005-2008-delete-duplicate-rows/)**

**使用CTE**的示例代码：

```
/* Delete Duplicate records */
WITH CTE (COl1,Col2, DuplicateCount)
AS
(
SELECT COl1,Col2,
ROW_NUMBER() OVER(PARTITION BY COl1,Col2 ORDER BY Col1) AS DuplicateCount
FROM DuplicateRcordTable
)
DELETE
FROM CTE
WHERE DuplicateCount > 1
GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:38:34.053

您可以通过将表连接到自身、按要在其中*查找*重复项的字段进行分组以及 count 大于 1 的 having 子句来查找重复项。

假设您的表名称是客户，并且您正在寻找重复的名称字段。

```
select cust_out.name, count(cust_count.name)
from customers cust_out
  inner join customers cust_count on cust_out.name = cust_count.name
group by cust_out.name
having count(cust_count.name) > 1 
```

如果您在删除语句中使用它，您将删除所有重复记录，而您可能打算保留这些记录。

所以要选择要删除的记录，

```
select cust_dup.id
from customers cust
  inner join customers cust_dup on cust.name = cust_dup.name and cust_dup.id > cust.id
group by cust_dup.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:29:04.627

添加一个计算列，该列采用整行的校验和。搜索任何重复的校验和，对重复项进行排名和删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T14:31:52.113

你可以这样做：

```
DELETE from yourTable WHERE tableID in 
(SELECT clone.tableID 
 from yourTable origine,
  yourTable clone 
 where clone.tableID= origine.tableID) 
```

但在 WHERE 中，您可以比较索引或相互比较字段...

取决于你如何找到你的双打。

请注意，此解决方案的优点是让您选择什么是双倍（例如，如果 PK 发生变化）

# c# - 将 FAT 类设为部分类并将其拆分为部分类的优缺点是什么？

> ID：14260120
> 
> 赞同：1
> 
> 时间：2013-01-10T14:26:21.883
> 
> 标签：c#, .net, refactoring, partial-classes

最近我在考虑一个类，因为它的方法太多，它似乎变胖了。

遗留代码...

这有许多业务逻辑明智的方法在各种“Etntities”上执行所有类型的 CRUD。

我刚在想

1.  使这个类部分
2.  然后按他们工作的目标实体对所有方法进行分组
3.  并将它们拆分为单独的物理文件，这些文件将成为部分类的一部分

**问题：** 您能否列出这种重构的利弊，即使胖具体类成为部分类并将其拆分为更苗条的部分类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T14:32:58.503

我能想到的一个专业人士是减少源代码管理中的冲突/合并。您将减少并行签出的数量以及在开发人员签入他们的工作时总是出现的合并难题。我认为，如果您有许多开发人员经常在同一个课程上工作，那么我认为这是一个大专业人士。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T14:42:13.833

我认为您只是在谈论处理课程的简单性。性能或行为的优缺点不应该是因为在编译时它应该产生相同的结果：

> 可以将类或结构或接口的定义拆分为两个或多个源文件。每个源文件都包含类定义的一部分，并且在编译应用程序时将所有部分组合在一起。

现在回答我可以考虑的利弊（仅关于简单性）：

*   优点：如果在团队中工作，冲突/合并更少。
*   优点：更容易在课堂上搜索代码。
*   缺点：您需要知道哪些文件处理每个代码，否则会有点烦人。

我会去重构。特别考虑 IDE 提供的所有功能，您只需单击 F12（或任何其他键）即可转到方法，而不是打开文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:38:33.330

将一个大类拆分为部分类可能会在短期内让生活更轻松，但这并不是解决您的类所遇到的代码膨胀问题的合适解决方案。

根据我的经验，将现有的大型类拆分给您的唯一好处是，在与其他开发人员一起处理该类时，更容易避免不断合并代码。但是，您仍然存在将不相关的功能打包到一个类中的核心问题。

最好将分解为部分类作为完整重构的第一步。如果您能够轻松地将相关方法和成员提取到它们自己的部分类中（而不破坏任何东西），那么您可以以此为基础创建完全独立的类并重新考虑它们之间的关系。

编辑：我应该澄清一下，这个建议是在假设你的遗留代码在一个类中具有不相关的功能的情况下给出的，因为多年来“只需在此处添加一种方法”。将功能分布在部分类中是有真正的原因的，例如，我之前处理过代码，在一个文件中有一个非常大的接口，但随后根据产品功能的区域将所有方法分组到部分类中——这我觉得还可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-31T09:21:13.730

我会说 Partial 类将有助于维护代码，并且当我们有遗留代码以避免参考方面的更多更改时会更有帮助。稍后将有助于轻松重构

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-01-10T14:32:10.647

如果您担心如何重构一个类，我建议您阅读[SOLID](http://en.wikipedia.org/wiki/SOLID)设计原则。

我认为你应该关注单一责任原则（SOLID 中的 S），它指出一个对象应该只有一个责任。

我认为我的回答不是直接回答您的问题，使用分部类是否对您有益，但我相信如果您专注于 SOLID 设计原则，至少应该会给您一些关于如何组织代码的想法。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-01-10T14:32:27.977

我仅将部分类视为扩展类的一种方式，该类的代码已生成（并且可以随时重新生成），您希望在不覆盖自定义代码的情况下对其进行扩展。例如，您可以通过 Form 生成的代码和 Entity Framework DbContext 生成的代码看到这一点。

重构大型遗留类可能应该通过将单个职责分组和分离到单独的类中来完成。

# php - PHP/MySQL 中的预订日期可用性范围

> ID：14260125
> 
> 赞同：0
> 
> 时间：2013-01-10T14:26:36.327
> 
> 标签：php, mysql, date, between

我有两个字段，check_in 和 nights。

夜数包括入住日期。因此，如果客户预订了 1 晚，那么他将在第二天结帐，然后房间将可供预订（除非已经被其他人预订）。

这是我表中几条记录的示例，

```
customer          room            check_in            nights
cus1              test room       2013-01-23          2
cus2              test room       2013-01-25          1
cus3              test room       2013-01-26          4 
```

cus3订了房间，2013-01-26入住，住4晚。这意味着该房间将在此期间无法预订。

那么如何查看房间是否可用呢？

房间应该只能在 2013 年 1 月 30 日入住。

感谢所有帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:39:08.420

有一个很棒的站点，其中包含常见场景的 MySQL 语句列表。检查在给定时间内是否有可用房间就是其中之一：[http ://www.artfulsoftware.com/infotree/queries.php#576](http://www.artfulsoftware.com/infotree/queries.php#576)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:39:17.477

当您选择入住日期和入住的夜晚时，您可以执行以下操作（虚拟代码）：

```
 $startDate='2013-01-26';//for example
    $to_time=date("Y-m-d", strtotime("$startDate + 4 day"));
    echo $to_time;//prints 2013-01-30 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:35:10.833

当您获取客户行的数据时，使用它来获取结帐日期：

```
$check_out = date('Y-m-d', strtotime($row['check_in'].' + '.$row['nights'].' days')); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T14:35:21.207

像这样的东西，

```
SELECT room, 
       CASE WHEN 'dateHere' BETWEEN check_in AND check_out
           THEN 'UNAVAILABLE'
           ELSE 'AVAILABLE'
       END Status
FROM
  (
      SELECT  room, 
              check_in, 
              DATE_ADD(check_in, INTERVAL nights day) check_out
      FROM    booking
  ) s 
```

*   [SQLFiddle Demo（*显示不可用*）](http://sqlfiddle.com/#!2/7d6fb/5)
*   [SQLFiddle Demo（*全部可用*）](http://sqlfiddle.com/#!2/7d6fb/4)

# python - 如何计算 python-Levenshtein.ratio

> ID：14260126
> 
> 赞同：38
> 
> 时间：2013-01-10T14:26:40.900
> 
> 标签：python, levenshtein-distance

根据`python-Levenshtein.ratio`消息来源：

[https://github.com/miohtama/python-Levenshtein/blob/master/Levenshtein.c#L722](https://github.com/miohtama/python-Levenshtein/blob/master/Levenshtein.c#L722)

它被计算为`(lensum - ldist) / lensum`。这适用于

```
# pip install python-Levenshtein
import Levenshtein
Levenshtein.distance('ab', 'a') # returns 1
Levenshtein.ratio('ab', 'a')    # returns 0.666666 
```

但是，它似乎与

```
Levenshtein.distance('ab', 'ac')  # returns 1
Levenshtein.ratio('ab', 'ac')     # returns 0.5 
```

我觉得我一定错过了一些非常简单的东西..但为什么不`0.75`呢？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-10T15:00:04.730

**Levenshtein 距离**`'ab'`和如下`'ac'`：

![图片](../Images/70e6f8dbb505d0d96b751c977cf55559.png)

所以对齐是：

```
 a c
  a b 
```

对齐长度 = 2
错配数 = 1

`Levenshtein Distance`是`1`因为只需要一个替换即可转移`ac`到`ab`（或反向）

距离比 = (Levenshtein 距离)/(对齐长度) = 0.5

**编辑**

你在写

`(lensum - ldist) / lensum`= `(1 - ldist/lensum)`= 1 - 0.5 = 0.5。

但这是**匹配**（不是距离）
[**REFFRENCE**](http://www.switchplane.com/blog/improving-search-with-levenshtein-distance.php)，你可能会注意到它的写法

`Matching %`

```
p = (1 - l/m) × 100 
```

和`l`是单词 在哪里：`levenshtein distance``m``length of the longest of the two`

[*（**注意**：有些作者使用了两者中最长的，我使用了对齐长度）*]

```
(1 - 3/7) × 100 = 57.14...  

  (Word 1    Word 2    RATIO   Mis-Match   Match%
   AB         AB         0       0        (1 - 0/2 )*100  = 100%  
   CD         AB         1       2        (1 - 2/2 )*100  = 0%   
   AB         AC        .5       1        (1 - 1/2 )*100  = 50% 
```

[为什么有些作者除以对齐长度，而另一些则除以两者之一的最大长度？..，因为 Levenshtein 不考虑间隙。距离 = 编辑次数（插入 + 删除 + 替换），而作为标准全局对齐[的 Needleman–Wunsch 算法](http://en.wikipedia.org/wiki/Needleman%E2%80%93Wunsch_algorithm)考虑间隙。这是 Needleman–Wunsch 和 Levenshtein 之间的（差距）差异，**很多论文**使用*两个序列之间的最大距离*（**但这是我自己的理解，我不确定 100%**）]

这是 IEEE TRANSACTIONS ON PAITERN ANALYSIS : [**Computation of Normalized Edit Distance and Applications**](http://www.csie.ntu.edu.tw/~b93076/Computation%20of%20Normalized%20Edit%20Distance%20and%20Applications.pdf)在本文中**Normalized Edit Distance**如下：

> 给定有限字母表上的两个字符串 X 和 Y，X 和 Y 之间的归一化编辑距离 d( X , Y ) 定义为 W( P ) / L ( P )w 的最小值，这里 P 是之间的编辑路径X 和 Y ，W ( P ) 是 P 的基本编辑操作的权重之和，L(P) 是这些操作的数量（P 的长度）。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-01-12T18:46:02.560

通过更仔细地查看 C 代码，我发现这种明显的矛盾是由于对`ratio`“替换”编辑操作的处理与其他操作不同（即成本为 2），而`distance`对它们都一样对待成本 1。

这可以从对函数内部`levenshtein_common`函数 的调用中看出`ratio_py`：

* * *

[https://github.com/miohtama/python-Levenshtein/blob/master/Levenshtein.c#L727](https://github.com/miohtama/python-Levenshtein/blob/master/Levenshtein.c#L727)

```
static PyObject*
ratio_py(PyObject *self, PyObject *args)
{
  size_t lensum;
  long int ldist;

  if ((ldist = levenshtein_common(args, "ratio", 1, &lensum)) < 0) //Call
    return NULL;

  if (lensum == 0)
    return PyFloat_FromDouble(1.0);

  return PyFloat_FromDouble((double)(lensum - ldist)/(lensum));
} 
```

* * *

并按`distance_py`功能：

[https://github.com/miohtama/python-Levenshtein/blob/master/Levenshtein.c#L715](https://github.com/miohtama/python-Levenshtein/blob/master/Levenshtein.c#L715)

```
static PyObject*
distance_py(PyObject *self, PyObject *args)
{
  size_t lensum;
  long int ldist;

  if ((ldist = levenshtein_common(args, "distance", 0, &lensum)) < 0)
    return NULL;

  return PyInt_FromLong((long)ldist);
} 
```

* * *

这最终导致不同的成本参数被发送到另一个内部函数`lev_edit_distance`，它具有以下文档片段：

```
@xcost: If nonzero, the replace operation has weight 2, otherwise all
        edit operations have equal weights of 1. 
```

lev_edit_distance() 的代码：

```
/**
 * lev_edit_distance:
 * @len1: The length of @string1.
 * @string1: A sequence of bytes of length @len1, may contain NUL characters.
 * @len2: The length of @string2.
 * @string2: A sequence of bytes of length @len2, may contain NUL characters.
 * @xcost: If nonzero, the replace operation has weight 2, otherwise all
 *         edit operations have equal weights of 1.
 *
 * Computes Levenshtein edit distance of two strings.
 *
 * Returns: The edit distance.
 **/
_LEV_STATIC_PY size_t
lev_edit_distance(size_t len1, const lev_byte *string1,
                  size_t len2, const lev_byte *string2,
                  int xcost)
{
  size_t i; 
```

* * *

**[回答]**

所以在我的例子中，

`ratio('ab', 'ac')`意味着在字符串 (4) 的总长度上进行替换操作（成本为 2），因此`2/4 = 0.5`.

这解释了“如何”，我想唯一剩下的方面就是“为什么”，但目前我对这种理解感到满意。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-09-10T14:25:55.883

`(lensum - ldist) / lensum`

ldist 不是距离，是成本的总和

[![在此处输入图像描述](../Images/c706f2904b80f3ef9b0a3b4b1f2cf9ca.png)](https://i.stack.imgur.com/P95bC.png)

不匹配的数组的每个数字来自上方、左侧或对角线

如果数字来自左边他是一个插入，它来自上面它是一个删除，它来自对角线它是一个替换

插入和删除的成本为 1，替换的成本为 2。替换成本为 2，因为它是删除和插入

ab ac 成本为 2，因为它是替代品

```
>>> import Levenshtein as lev
>>> lev.distance("ab","ac")
1
>>> lev.ratio("ab","ac")
0.5
>>> (4.0-1.0)/4.0    #Erro, the distance is 1 but the cost is 2 to be a replacement
0.75
>>> lev.ratio("ab","a")
0.6666666666666666
>>> lev.distance("ab","a")
1
>>> (3.0-1.0)/3.0    #Coincidence, the distance equal to the cost of insertion that is 1
0.6666666666666666
>>> x="ab"
>>> y="ac"
>>> lev.editops(x,y)
[('replace', 1, 1)]
>>> ldist = sum([2 for item in lev.editops(x,y) if item[0] == 'replace'])+ sum([1 for item in lev.editops(x,y) if item[0] != 'replace'])
>>> ldist
2
>>> ln=len(x)+len(y)
>>> ln
4
>>> (4.0-2.0)/4.0
0.5 
```

[![在此处输入图像描述](../Images/9dd2fb24f9c8c08f6545e2323fb48033.png)](https://i.stack.imgur.com/qqdGR.png)

更多信息：[python-Levenshtein 比率计算](https://stackoverflow.com/questions/29402027/python-levenshtein-ratio-calculation)

另一个例子：

[![在此处输入图像描述](../Images/55818c9551cdbcfe6fd35fe1062602f4.png)](https://i.stack.imgur.com/MgvGd.png)

成本为 9（4 替换 => 4*2=8 和 1 删除 1*1=1, 8+1=9）

```
str1=len("google") #6
str2=len("look-at") #7
str1 + str2 #13 
```

distance = 5 (根据矩阵的向量 (7, 6) = 5)

比率为 (13-9)/13 = 0.3076923076923077

```
>>> c="look-at"
>>> d="google"
>>> lev.editops(c,d)
[('replace', 0, 0), ('delete', 3, 3), ('replace', 4, 3), ('replace', 5, 4), ('replace', 6, 5)]
>>> lev.ratio(c,d)
0.3076923076923077
>>> lev.distance(c,d)
5 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-10T15:30:21.183

虽然没有绝对的标准，但归一化的列文斯泰因距离是最常见的定义`ldist / max(len(a), len(b))`。对于这两个示例，这将产生 0.5。

这`max`是有道理的，因为它是 Levenshtein 距离的最低上限：`a`要从`b`where获得`len(a) > len(b)`，您始终可以将 的第一个`len(b)`元素替换为`b`from 的相应元素`a`，然后插入缺失的部分`a[len(b):]`，总共进行`len(a)`编辑操作。

这个论点以明显的方式扩展到 的情况`len(a) <= len(b)`。要将归一化距离转换为相似性度量，请将其从 1 中减去：`1 - ldist / max(len(a), len(b))`。

# html - 是否有访问 html5 数据库 SQLite 的免费库？

> ID：14260127
> 
> 赞同：0
> 
> 时间：2013-01-10T14:26:45.087
> 
> 标签：html, sqlite, cordova

这个库应该易于使用来访问 html5 本地存储（sqlite）。像定义表，添加/更新/删除实体，从数据库查询实体。

可能使用 lib 我可以编写如下代码：

//代码

```
var db=new MyDataBase();
var users = db.Users.Tolist();
var admin = db.Users.FirstOrDefault(u=>u.Name=="admin");
admin.Password="new password";
db.UpdateUser(admin); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T01:35:18.807

我正在使用包含 html5 sqlite 的 DAL 部分的 phonegap 库。它由[novasoftware](http://www.novasoftware.com/developer/PhoneGap.aspx?utm_source=codeplex&utm_medium=phonegap&utm_term=phonegap&utm_content=cordova&utm_campaign=leo)开发。看看它的示例代码[here](https://cordova.codeplex.com/wikipage?title=How%20to%20use%20nova.data)，我还在下面粘贴了一部分：

```
/// <reference path="scripts/novas/data/ArrayExtensions.js" />
/// <reference path="scripts/novas/data/nova.data.Repository.js" />
/// <reference path="scripts/novas/data/nova.data.DbContext.js" />
/// <reference path="scripts/novas/data/nova.data.Entity.js" />
/// <reference path="scripts/novas/data/nova.data.Queryable.js" />

// define dbContext & entities------------------------------------
var DemoDataContext = function () {
    nova.data.DbContext.call(this, "Demo", "1.0", "Demo DB", 1000000);

    this.users = new nova.data.Repository(this, User, "users");
    this.roles = new nova.data.Repository(this, Role, "roles");
};

DemoDataContext.prototype = new nova.data.DbContext();
DemoDataContext.constructor = DemoDataContext;

var User = function () {
  nova.data.Entity.call(this);
  this.name = "";
  this.password = "";
  this.birthYear = 1980;
  this.createdDate = new Date();
  this.deleted = false;
};
User.prototype = new nova.data.Entity();
User.constructor = User;

var Role = function () {
nova.data.Entity.call(this);
this.name = "";
this.createdDate = new Date();

};
Role.prototype = new nova.data.Entity();
Role.constructor = Role;
// end define dbContext & entities------------------------------------

// service methods----------------------------------------------------
function getAllUsers(callback) {
new DemoDataContext().users.toArray(function (users) {
    alert(users.length);
    callback(users);
});
}

function getUserByName(name, callback) {
  new DemoDataContext().users.where("name='" + name + "'").toArray(function (users) {
    callback(users.firstOrDefault());
  });
}

function addRole(roleName, callback) {
  var role = new Role();
  role.name = roleName;
  var db = new DemoDataContext();
  db.roles.add(role);
  db.saveChanges(callback);
}

function updateUserPassword(username, password, callback) {
  getUserByName(username, function (user) {
    if (user == null) {
        throw "no user found.";
    }
    user.password = password;
    var db = new DemoDataContext();
    db.users.update(user);
    db.saveChanges(callback);
  });
}

function deleteUserByName(name, callback) {
  getUserByName(name, function (user) {
    if (user == null) {
        throw "no user found.";
    }
    var db = new DemoDataContext();
    db.users.remove(user);
    db.saveChanges(callback);
  });
}

// end service methods---------------------------------------------------- 
```

# java - 在四核处理器中运行超过 8 个线程

> ID：14260131
> 
> 赞同：-1
> 
> 时间：2013-01-10T14:26:59.917
> 
> 标签：java, multithreading, jvm, threadpool, cpu-usage

我有一个带有 10 个线程和大量文本数据要处理的线程池，我正在并行运行这些线程，我无法利用核心 i7 vPro 处理器的完整 cpu 资源，有人帮我解决这个问题。我想要最大的 CPU 利用率。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:52:24.903

在许多情况下，不是在每个线程中做同样的事情做单独的工作并使用同步队列进行通信会产生更好的结果。尝试拆分应用程序，以便所有读取操作都从单个线程完成，然后将数据提供给工作线程进行处理，另一个线程进行后处理（如果有的话）。您可能会发现这样的模型使用了更多的处理能力并且工作速度明显更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:39:15.533

如果每个线程除了处理它之外还应该从文件中读取句子，那么我怀疑磁盘是这种情况下的瓶颈。从单个磁盘并行读取通常会导致相对于单个顺序读取的性能下降。

在我看来，您应该将所有内容留给单个线程，或者至少使用单个生产者-多消费者模式序列化阅读并仅并行化句子处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T14:30:43.997

很可能您的开销比 CPU 利用率更高。

*   这可能是因为读取文件并将其分解成句子需要时间。由于您没有看到 100% CPU，这是我的猜测。
*   启动任务并将任务添加到其他线程的开销大于每个任务所做的工作量。您会期望看到接近 100% 的 CPU 利用率，但速度远低于您的预期。它甚至可能比使用一个线程慢。

除非您的 JVM 已预热，否则您可能会发现这比使用多线程更重要。（100 个句子的文件是不够的）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T15:02:57.080

多线程会带来一些开销，包括将任务细分为作业，将作业提供给作业队列，然后让`ThreadPoolExecutor`执行作业，可能在完成时组合结果。即使没有由于磁盘访问或其他共享资源而导致的争用，我发现将作业细分为小于 1 毫秒也不值得开销。在具有多个套接字的大型机器上运行时，由于缓存一致性开销增加，该阈值甚至更高。

# selenium - 是否有任何其他选项可以从下拉列表中选择项目而不是“selectByVisibleText”？

> ID：14260132
> 
> 赞同：0
> 
> 时间：2013-01-10T14:27:00.640
> 
> 标签：selenium, webdriver, css-selectors, selenium-webdriver

我的 Selenium 测试中有以下代码行，它是关于从 DropDown 中选择项目的：

```
new Select(driver.findElement(By.cssSelector("select[id='application_id']")).selectByVisibleText("NewApp"); 
```

还有其他选项可以从下拉列表中选择项目吗？

比如 CSS 选择器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:01:10.573

是 - 请参阅从[WebDriver API 文档](http://selenium.googlecode.com/svn/trunk/docs/api/java/index.html)中选择：您还可以使用和按索引和值进行`selectByIndex(int index)`选择`selectByValue(java.lang.String value)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T19:01:47.170

没有规定必须使用`Select`类来处理`<select>`元素。例如，您可以执行以下操作：

```
WebElement element = driver.findElement(By.cssSelector("select[id='application_id']"));
WebElement option = element.findElement(By.cssSelector("optionAttribute"));
option.click(); 
```

请注意，您可以使用此技术通过任何标准`By`方法找到所需的选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-12T06:42:30.557

试试这个：

```
WebElement element = driver.findElement(By.cssSelector("select[id='application_id']"));
element.sendKeys("value_with_you_want_to_select"); 
```

# javascript - 不安全的 javascript 尝试访问本地文件上的框架

> ID：14260133
> 
> 赞同：2
> 
> 时间：2013-01-10T14:27:01.040
> 
> 标签：javascript, google-chrome

我有一个应用程序创建 HTML 供用户在他们的本地机器上查看（不是作为网站托管）。这目前适用于 IE 和 FireFox，但 Chrome 不喜欢我使用相互交互的框架（因此，当您单击一个项目时，我将一个新的 html 文件加载到内容框架中的导航框架）。Chrome 给了我不安全的 javascript 尝试 - 域必须匹配等。所以我创建了一个小示例，它在同一目录中包含所有必需的文件（并且应该在同一个域中？），但我仍然遇到问题。

我的示例代码在起始 html 页面中有 2 个 iFrame，第一个 iFrame 有一个按钮，可以更改第二个 iFrame 的源 - 相当简单。

我试过使用沙盒属性，但这些都没有帮助。

所以这是我的代码：

**开始.htm**

```
<body>
  <iframe id="fheader" src="NewHeader.htm" name="fheader" sandbox="allow-scripts allow-same-origin   allow-forms allow-top-navigation"></iframe>
  <iframe id="fbody" src="BodyLime.htm" name="fbody" sandbox="allow-scripts allow-same-origin allow-forms allow-top-navigation"></iframe>
</body> 
```

**头文件.htm**

```
function myClick() {

   var myFrame = parent.document.getElementById("fbody");  

   myFrame.setAttribute("src", "BodyRed.htm");

}

<body style="background-color:Aqua">    
    <input id="Button1" onclick="myClick()" type="button" value="Change your neighbours colour"/>    
</body> 
```

BodyRed.htm 和 BodyLime.htm 只是设置了背景颜色以显示代码是否有效的简单页面。

我也尝试使用下面的代码访问框架，但是一旦我尝试访问框架的任何属性，我就会得到同样的错误：

```
 var myfbody = parent.fbody; 
```

希望有人可以提供帮助。

# java - java 集合中计数出现次数的优雅方法

> ID：14260134
> 
> 赞同：32
> 
> 时间：2013-01-10T14:27:04.220
> 
> 标签：java, dictionary, collections, count

给定一组可能重复的对象，我希望最终得到每个对象的出现次数。我通过初始化一个空的`Map`，然后遍历`Collection`并将对象映射到它的计数来做到这一点（每次映射已经包含对象时增加计数）。

```
public Map<Object, Integer> countOccurrences(Collection<Object> list) {
    Map<Object, Integer> occurrenceMap = new HashMap<Object, Integer>();
    for (Object obj : list) {
        Integer numOccurrence = occurrenceMap.get(obj);
        if (numOccurrence == null) {
            //first count
            occurrenceMap.put(obj, 1);
        } else {
            occurrenceMap.put(obj, numOccurrence++);
        }
    }
    return occurrenceMap;
} 
```

对于计算出现次数的简单逻辑来说，这看起来太冗长了。有没有更优雅/更短的方法来做到这一点？我对完全不同的算法或允许更短代码的 Java 语言特定功能持开放态度。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-10T14:36:10.207

查看[Guava 的 Multiset](https://github.com/google/guava/wiki/NewCollectionTypesExplained)。几乎正是您正在寻找的东西。

不幸的是，它没有 addAll(Iterable iterable) 函数，但是在您的集合上调用 add(E e) 的简单循环就足够简单了。

**编辑**

我的错误，它确实有一个 addAll 方法——它必须，因为它实现了 Collection。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-08-26T18:00:45.187

现在让我们尝试一些 Java 8 代码：

```
static public Map<String, Integer> toMap(List<String> lst) {
    return lst.stream()
            .collect(HashMap<String, Integer>::new,
                    (map, str) -> {
                        if (!map.containsKey(str)) {
                            map.put(str, 1);
                        } else {
                            map.put(str, map.get(str) + 1);
                        }
                    },
                    HashMap<String, Integer>::putAll);
} 
```

```
static public Map<String, Integer> toMap(List<String> lst) {
    return lst.stream().collect(Collectors.groupingBy(s -> s,
                                  Collectors.counting()));
} 
```

我认为这段代码更优雅。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-01-23T12:57:46.923

我知道这是一个老问题，但我在 Java 8 中找到了一种更优雅的方式来计算这些选票，希望你喜欢。

```
Map<String, Long> map = a.getSomeStringList()
            .stream()
            .collect(Collectors.groupingBy(
                    Function.identity(),
                    Collectors.counting())
            ); 
```

任何错误，只是评论。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-01-10T14:39:12.180

查看这篇文章[如何计算 List 中元素的出现次数](https://stackoverflow.com/questions/505928/how-to-count-occurrence-of-an-element-in-a-list)。要计算出现次数，您可以使用`int occurrences = Collections.frequency(list, obj);`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-04-08T21:53:01.630

这里有一篇关于 Java 计数器的好文章：http: [//www.programcreek.com/2013/10/efficient-counter-in-java/](http://www.programcreek.com/2013/10/efficient-counter-in-java/)虽然它更注重效率而不是优雅。

获胜者是这样的：

```
HashMap<String, int[]> intCounter = new HashMap<String, int[]>();
for (int i = 0; i < NUM_ITERATIONS; i++) {
    for (String a : sArr) {
        int[] valueWrapper = intCounter.get(a);

        if (valueWrapper == null) {
            intCounter.put(a, new int[] { 1 });
        } else {
            valueWrapper[0]++;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-10T14:36:33.377

对于 Java 来说并不是那么冗长。您可以使用`TObjectIntHashMap`：

```
public <T> TObjectIntHashMap<T> countOccurrences(Iterable<T> list) {
    TObjectIntHashMap<T> counts = new TObjectIntHashMap<T>();
    for (T obj : list) counts.adjustOrPut(obj, 1, 1);
    return counts;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-05-13T12:51:21.550

请参考以下解决方案来计算集合中的每个元素。

对于整数值：

```
List<Integer> list = new ArrayList<Integer>();
list.add(3);
list.add(2);
list.add(5);
list.add(1);
list.add(8);
list.add(0);
list.add(2);
list.add(32);
list.add(72);
list.add(0);
list.add(13);
list.add(32);
list.add(73);
list.add(22);
list.add(73);
list.add(73);
list.add(21);
list.add(73);

HashSet<Integer> set = new HashSet<>();

for (int j = 0; j < list.size(); j++) {
    set.add(list.get(j));
}

Iterator<Integer> itr = set.iterator();
while (itr.hasNext()) {
    int a = itr.next();
    System.out.println(a + " : " + Collections.frequency(list, a));
} 
```

输出：

```
0 : 2
32 : 2
1 : 1
2 : 2
3 : 1
5 : 1
21 : 1
22 : 1
8 : 1
72 : 1
73 : 4
13 : 1 
```

对于字符串值：

```
List<String> stringList = new ArrayList<>();
stringList.add("ABC");
stringList.add("GHI");
stringList.add("ABC");
stringList.add("DEF");
stringList.add("ABC");
stringList.add("GHI");

HashSet<String> setString = new HashSet<>();

for (int j = 0; j < stringList.size(); j++) {
    setString.add(stringList.get(j));
}

Iterator<String> itrString = setString.iterator();
while (itrString.hasNext()) {
    String a = itrString.next();
    System.out.println(a + " :::  " + Collections.frequency(stringList, a));
} 
```

输出：

```
ABC :::  3
DEF :::  1
GHI :::  2 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-03-30T21:11:02.737

我很惊讶没有人提供这种简单易读的解决方案。您可以只使用[Map#getOrDefault()](https://docs.oracle.com/javase/8/docs/api/java/util/Map.html#getOrDefault-java.lang.Object-V-)。

```
 public Map<Object, Integer> countOccurrences(Collection<Object> list){
      Map<Object, Integer> occurrenceMap = new HashMap<Object, Integer>();
      for(Object obj: list){
          occurrenceMap.put(obj, occurrenceMap.getOrDefault(obj, 0) + 1);
      }
      return occurrenceMap;
 } 
```

它完全解决了您遇到的问题并消除了笨重的`if..else`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-10T15:27:00.390

作为对与@NimChimpsky 讨论的回应，这里是另一种更快的方法——我试图证明这一点——使用排序集合的计数方法。根据元素的数量和“sortFactor”（参见代码），速度差异会有所不同，但对于运行环境（非调试）中的大量对象，我的方法相对于默认方法的速度提高了 20-30%。这是两种方法的简单测试类。

```
public class EltCountTest {

    final static int N_ELTS = 10000;

    static final class SampleCountedObject implements Comparable<SampleCountedObject>
    {
        int value = 0;

        public SampleCountedObject(int value) {
            super();
            this.value = value;
        }

        @Override
        public int compareTo(SampleCountedObject o) {
            return (value == o.value)? 0:(value > o.value)?1:-1; // just *a* sort
        }

        @Override
        public int hashCode() {
            return value;
        }

        @Override
        public boolean equals(Object obj) {
            if (obj instanceof SampleCountedObject) {
                return value == ((SampleCountedObject)obj).value;
            }
            return false;
        }

        @Override
        public String toString() {
            return "SampleCountedObject("+value+")";
        }
    }

    /**
     * * @param args
     */
    public static void main(String[] args) {
        int tries = 10000;
        int sortFactor = 10;
        Map<SampleCountedObject, Integer> map1 = null;
        Map<SampleCountedObject, Integer> map2 = null;

        ArrayList<SampleCountedObject> objList = new ArrayList<EltCountTest.SampleCountedObject>(N_ELTS);

        for (int i =0, max=N_ELTS/sortFactor; i<max; i++){
            for (int j = 0; j<sortFactor; j++) {
                objList.add(new SampleCountedObject(i));
            }
        }

        long timestart = System.nanoTime();
        for (int a=0; a< tries; a++) {
            map1 = method1(objList);
        }
        System.out.println();
        long timeend1 = System.nanoTime();
        System.out.println();

        for (int a=0; a< tries; a++) {
            map2 = metod2(objList);
        }
        long timeend2 = System.nanoTime();
        System.out.println();

        long t1 = timeend1-timestart;
        long t2 = timeend2-timeend1;
        System.out.println("\n        org count method=["+t1+"]\nsorted collection method=["+t2+"]"+
                 "\ndiff=["+Math.abs(t1-t2)+"] percent=["+(100d*t2/t1)+"]");

        for (SampleCountedObject obj: objList) {
            int val1 = map1.get(obj);
            int val2 = map2.get(obj);
            if (val1 != val2) {
                throw new RuntimeException("val1 != val2 for obj "+obj);
            }
        }
        System.out.println("veryfy OK");

    }

    private static Map<SampleCountedObject, Integer> method1(ArrayList<SampleCountedObject> objList) {
        Map<SampleCountedObject, Integer> occurenceMap = new HashMap<SampleCountedObject, Integer>();

        for(SampleCountedObject obj: objList){
             Integer numOccurrence = occurenceMap.get(obj);
             if(numOccurrence == null){
                 occurenceMap.put(obj, 1);
             } else {
                 occurenceMap.put(obj, ++numOccurrence);
             }
        }
        return occurenceMap;
    }

    private static Map<SampleCountedObject, Integer> metod2(ArrayList<SampleCountedObject> objList) {
        Map<SampleCountedObject, Integer> occurenceMap = new HashMap<SampleCountedObject, Integer>();
        int count = 0;
        Collections.sort(objList);
        SampleCountedObject prevObj = objList.get(0);

        for(SampleCountedObject obj: objList){
            if (!obj.equals(prevObj)) {
                occurenceMap.put(prevObj, count);
                count = 1;
            } else {
                count ++;
            }
            prevObj = obj;
        }
        occurenceMap.put(prevObj, count);
        return occurenceMap;
    }
} 
```

请注意，我还验证了结果是否相同，并且我在打印测试结果后执行此操作。

我发现有趣的是，在 Debug 运行中，我的方法比原来的方法慢很多（10-20%，再次 - 取决于集合中元素的数量）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-08-10T10:59:27.107

`commons-collections`:中有一个方法`CollectionUtils.getCardinalityMap`正是这样做的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-07-31T09:29:38.557

您可以使用[Eclipse Collections](https://github.com/eclipse/eclipse-collections)中的一个[`Bag`](https://www.eclipse.org/collections/javadoc/10.4.0/org/eclipse/collections/api/bag/Bag.html)。

```
Iterable<Object> iterable = Arrays.asList("1", "2", "2", "3", "3", "3");
MutableBag<Object> counts = Bags.mutable.withAll(iterable);

Assertions.assertEquals(1, counts.occurrencesOf("1"));
Assertions.assertEquals(2, counts.occurrencesOf("2"));
Assertions.assertEquals(3, counts.occurrencesOf("3"));
Assertions.assertEquals(0, counts.occurrencesOf("4")); 
```

接口上的`withAll`方法`MutableBagFactory`接受一个`Iterable`作为参数，并返回一个`MutableBag`。`occurrencesOf`on方法`MutableBag`返回 an `int`，它是元素出现的次数。与 a 不同`Map`，如果 a 不包含元素，`Bag`则不会返回。`null`相反，该`occurrencesOf`方法将返回`0`.

`MutableBag`是 a `Collection`，所以它有一个`addAll`将 a`Collection`作为参数的方法。

```
counts.addAll(Arrays.asList("4", "4", "4", "4"));
Assertions.assertEquals(4, counts.occurrencesOf("4")); 
```

`MutableBag`也有一个`addAllIterable`采取的方法`Iterable`。

```
Stream<Object> stream = Stream.of("1", "2", "3", "4");
counts.addAllIterable(stream::iterator);

Assertions.assertEquals(2, counts.occurrencesOf("1"));
Assertions.assertEquals(3, counts.occurrencesOf("2"));
Assertions.assertEquals(4, counts.occurrencesOf("3"));
Assertions.assertEquals(5, counts.occurrencesOf("4")); 
```

`HashBag`Eclipse Collections 中的实现由 支持`ObjectIntHashMap`，因此`int`计数没有装箱。[此处](https://medium.com/oracledevs/bag-the-counter-2689e901aadb)`Bag`有一个博客，其中包含有关Eclipse Collections 中的类型的更多信息。

注意：我是 Eclipse Collections 的提交者

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2013-01-10T14:37:51.787

Java 是一种冗长的语言，我认为没有更简单的方法可以实现这一点，除非使用 3rd-party 库或等待 Java 8 的 Lambda 表达式。

# spring - Spring - 如何保护 RESTful 私有资源？

> ID：14260135
> 
> 赞同：3
> 
> 时间：2013-01-10T14:27:08.940
> 
> 标签：spring, rest, spring-mvc, spring-security

我有一些 RESTful 服务，用 Spring MVC 实现，暴露了一组资源。我已经使用了基于 HTTPBasicAuthentication 和 HTTPS 的身份验证。某些资源必须仅供某些用户访问。

例如，我希望 URI 中的所有子资源`/users/{userid}/photos`都只能由 user 访问`userid`。实际上，在我的应用程序中，所有经过身份验证的用户都可以访问它们。我怎样才能保护他们免受其他用户的伤害`userid`？如果我想只允许一部分用户（例如`userid`的朋友）访问这些资源怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T14:37:59.693

你可以在你的方法上做这样的事情：

```
 @ResponseBody
    @RequestMapping(value = "/users/{userid}/photos", method = RequestMethod.GET)
    @Secured(value = {"userid"})
    public ResponseEntity<ModelMap> getPhotos(....) throws Exception { 
```

如果您将来需要，您可以添加更多用户，只需执行

```
 @Secured(value = {"ROLE_ADMIN", "userid"}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:41:36.470

您可以使用自定义安全表达式。

```
<security:intercept-url pattern="/users/{userid}/photos" access="getUserIdUrlPathParameter() == principal.userId"/> 
```

请参阅[这篇文章](https://stackoverflow.com/questions/14185070/spring-securityintercept-url-pattern-access-id-1/14199105#14199105)了解如何操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T12:07:11.353

我通过使用`@PreAuthorize("authentication.name == #userId")`, 而不是`@Secured(value = {"userid"})`或`@Secured(value = {"#userid"})`像建议的那样解决了它，但它不起作用。

请注意，有必要添加`<security:global-method-security pre-post-annotations="enabled"/>`到 servlet 上下文配置文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T14:30:56.203

我强烈建议使用 Spring Security。使用 Spring 安全性，您可以将对特定 URL 端点的访问限制为拥有特定角色的主体。

查看[spring security 拦截 url 角色](https://stackoverflow.com/questions/12035099/spring-security-intercept-url-roles)

您还可以使用 JSR-250 注释：参见[http://forum.springsource.org/showthread.php?126395-How-to-secure-Spring-MVC-controllers-using-Spring-Security-annotations](http://forum.springsource.org/showthread.php?126395-How-to-secure-Spring-MVC-controllers-using-Spring-Security-annotations)

--

我认为您不需要将 URL /resource/{user} 限制为该特定用户。您应该从安全上下文中扣除用户名，而不是让某人通过伪造 URL 来注入特定的用户名......

# java - 我无法在通话后获得 JSONObject - 得到 415

> ID：14260137
> 
> 赞同：0
> 
> 时间：2013-01-10T14:27:10.343
> 
> 标签：java, json, rest, post

```
@POST
@Path("/sessions")
@Consumes("application/json")
@Produces("application/json")
public Response createSession(JSONObject jsonObject){

    if (jsonObject.get("subjectId").equals("amadmin")){
        jsonObject.put("username", jsonObject.get("subjectId"));
        jsonObject.put("password", jsonObject.get("authInfo"));
    }
    else{
        jsonObject.put("username", jsonObject.get("subjectId"));
        jsonObject.put("password", jsonObject.get("authInfo"));
        jsonObject.put("uri", "realm=" + jsonObject.get("realm"));
    }

    String openAmUrl = String.format("http://%s%s/identity/json/authenticate", 
            openAmIp, openAmWarName);

    URI uri = null;
    try {
        uri = new URI(openAmUrl);
    } 
    catch (URISyntaxException e) {
        LOGGER.error("Exception " + e);
    }
    return Response.seeOther(uri).build();
} 
```

我正在尝试使用 JSON 字符串调用 post 调用，例如： `{"subjectId":"me", "authInfo":"password"}` 而且我总是得到`HTTP/1.1 415 Unsupported Media Type`. 我知道，如果我的方法正在接收 JSONObject，那么帖子中的字符串会自动转换为 JSONObject，但仍然会出现 415 错误，尽管我使用标题为： Content-Type : application/json Accept : application/json

你能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T07:28:40.193

其实很简单，下面是新代码：

```
POST
@Path("/sessions")
@Consumes("application/json")
public Response createSession(String body){

    JSONObject jsonObject = null;
    try {
        jsonObject = new JSONObject(body);
    } catch (ParseException e) {
        LOGGER.error("This is not a valid JSON " + e);
        return Response.status(400).build();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T14:59:35.177

Consumes 注释用于过滤相应方法可接受的内容，因此它会过滤掉 HTTP 标头中没有 Content-Type: application/json 的请求。

您需要在请求中添加Header

```
Content-Type: application/json 
```

# php - 构建动态 Web 应用程序

> ID：14260141
> 
> 赞同：1
> 
> 时间：2013-01-10T14:27:16.240
> 
> 标签：php, jquery, mysql, ajax, web-applications

我使用 PHP、MySql 和 HTML（通常的嫌疑人）为我当地的社区大学创建了一个学生跟踪系统。我在项目的第 2 版。它还没有完成。现在我在这个项目中的下一步是让它“活跃起来”。目前我一直在阅读 AJAX 和 Jquery。据我了解，Jquery 是一个 Javascript 库，您可以下载（纯文本格式）并将其包含到您的脚本中。我感到困惑的是我应该从哪里开始下一步？我对 Jquery/Javascript 非常陌生，而且对 AJAX 了解甚少。根据我的阅读，Jquery 内置了自己的 AJAX 实现。

我们那里有什么好的阅读资源吗？我目前从 Oreilly 下载了 Jquery in Action、head first jquery 和 ajax 权威指南。关于 Jquery / AJAX 还有什么我应该知道的吗？我是一个新手，正在寻求进一步拓宽他的知识视野。非常感谢您提供正确方向的指南。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:32:04.067

有了你拥有的书籍和*Rory McCrossan建议的*[jQuery](http://api.jquery.com/) api，你应该做得很好。您在实现功能时可能遇到的任何其他问题，这些书中没有描述（Head First 的书是一个很好的起点），可以通过谷歌搜索来解决。

 *jQuery 的另一个有用之处是它的插件。它们是开箱即用的库，您可以按原样使用它们，只需调用它们的函数即可。以下是您可以找到它们的几个网站：

*   [官方 jQuery 插件存档](http://archive.plugins.jquery.com/)
*   [50 个 jQuery 插件](http://speckyboy.com/2012/12/10/jquery-plugins-2012/)
*   [40 个有用的 jQuery 插件](http://designshack.net/articles/javascript/40-awesome-jquery-plugins-you-need-to-check-out/)
*   [2012 年“最佳”jQuery 插件](http://webdesignledger.com/resources/best-jquery-plugins-of-2012)
*   [HandsOnTable](http://handsontable.com/) - 用于创建交互式表格的非常好的插件
*   [TableSorter](http://www.htmldrive.net/items/show/393/Tablesorter-jQuery) - 另一个用于排序 html 表格数据的好插件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:31:09.747

jquery 有一个基本版本的官方指南@：[JQuery 文档](http://api.jquery.com)
你会发现你从网站上下载的几乎每个插件的文档；）此外，你当然可以就 SO 和谷歌提出问题，几乎你有任何问题可能有。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T14:31:20.990

您可以阅读这篇完美的文章：
[**5 种使用 jQuery**](http://net.tutsplus.com/tutorials/javascript-ajax/5-ways-to-make-ajax-calls-with-jquery/)

*函数进行 Ajax 调用的方法，上面文章中解释了*：

*   **load()**：将一段 html 加载到容器 DOM 中。
*   **$.getJSON()**：使用 GET 方法加载 JSON。
*   **$.getScript()**：加载 JavaScript。
*   **$.get()**：如果您想进行 GET 调用并广泛使用响应，请使用它。
*   **$.post()**：如果您想进行 POST 调用并且不想将响应加载到某些容器 DOM，请使用此选项。
*   **$.ajax()**：如果您需要在 XHR 失败时执行某些操作，或者您需要动态指定 ajax 选项（例如 cache: true），请使用此选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T14:31:34.943

jQuery 和 AJAX 一起看起来像这样：

```
$('div#id').click(function(){
        $.ajax({
            type: "POST",
            url: "file.php",
            data: "id=1",
            success: function(data)
            {
                if (data == "Success") {
                    window.location.reload();
                } else {
                    alert(data);
                }
            }
        });
        return false;
    }) 
```*

# php - 使用 php 进行 IVR 集成

> ID：14260144
> 
> 赞同：3
> 
> 时间：2013-01-10T14:27:24.097
> 
> 标签：php, codeigniter, ivr

是否可以将 IVR 与 PHP 集成？有没有相关的教程或链接？

我想，当用户拨打某个电话号码并输入他们的预订注册号和预订日期时，IVR应该通过自动语音向用户响应预订订单和状态。

是否可以使用 PHP (CodeIgniter) 实现？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:52:52.853

检查此链接，将帮助您[https://www.twilio.com/docs/tutorials/walkthrough/ivr-phone-tree/php/laravel](https://www.twilio.com/docs/tutorials/walkthrough/ivr-phone-tree/php/laravel) 也有 codeigniter 库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T16:09:53.520

您可以将 PHP 与[Tropo](https://www.tropo.com/docs/scripting/quickstarts)和任何与[VoiceXML](http://www.w3.org/TR/voicexml20/)兼容的 IVR 一起使用。这是使用 PHP和[Voxeo Prophecy IVR 平台](http://evolution.voxeo.com/)[生成 VoiceXML 的教程](http://blogs.voxeo.com/voxeodeveloperscorner/tag/php/)。您可以免费试用 Tropo 和 Prophecy IVR。仅当您想将您的应用程序放入生产环境时，您才需要付费。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T15:21:30.253

是的，这绝对是可能的。VoiceXML 的开发是使用标准 HTTP 协议完成的，就像普通的 Web 开发一样，除了您的 PHP 脚本生成 VoiceXML 而不是 HTML。您需要使用所有代码编写一个初始 VoiceXML 文档以收集他们的注册号和预订日期（使用标签），然后您可以通过 HTTP POST（使用标签）将用户输入发送到 PHP 脚本。PHP 脚本访问 POST 变量，执行预订订单搜索并将结果输出到新的 VoiceXML 文档中。这是 PHP 中一个非常精简的示例：

```
start.xml:
<?xml version="1.0"?>
<vxml version="2.1">
<form>
<field name="registration_number" type="digits">
  <prompt>Please say or enter your booking registration number.</prompt>
</field>
<field name="date" type="date">
  <prompt>Please say or enter your booking date.</prompt>
</field>
<filled>
  <submit next="search.php" method="post" namelist="registration_number date"/>
</filled>
</form>
</vxml>

search.php:
<?php
header("Content-type: text/xml");
echo("<?xml version=\"1.0\"?>\n");
$booking_details = lookup_booking_order($_POST['registration_number'], $_POST['date']);
?>
<vxml version="2.1">
<form>
<block>
  <prompt><?=htmlspecialchars($booking_details)?></prompt>
</block>
</form>
</vxml> 
```

使用像 CodeIgniter 这样的 MVC 框架需要做更多的工作，它需要您将这些脚本分解为一个控制器来处理 GET/POST 请求和两个视图（一个用于起始页面，一个用于搜索结果页面）。

# c# - 如何以编程方式更新 icalendar

> ID：14260145
> 
> 赞同：1
> 
> 时间：2013-01-10T14:27:25.303
> 
> 标签：c#, icalendar, dday

我想使用 C# 应用程序发送会议请求，所以我使用了 dday.ical 库。通过使用 ical 库，我创建了 .ics 文件，但现在我想更新我在互联网上搜索的已经创建的会议，我发现我们可以使用 uid 更新日历，但是当我使用相同的 uid 创建新的 cal 并运行时，我现有的 .ics 文件会替换新文件没有与现有文件合并

下面是我的代码

```
private iCalendar CreateOneTimeCalendarEvent(string title,Dictionary<string,string> attendees, string body, DateTime startDate, double duration, string location, string organizer,
                                     string eventId, bool allDayEvent)
{
   var iCal = new iCalendar
    {
        Method = "PUBLISH", //PUBLISH
        Version = "2.0"
    };

    //Creating event evt    
    var evt = iCal.Create<Event>();
    //Title to event
    evt.Summary = title;

    //Start time to event
    evt.Start = new iCalDateTime(startDate.Year,
                                 startDate.Month, startDate.Day, startDate.Hour,
                                 startDate.Minute, startDate.Second);

    // Description to event
    evt.Description = body;

    // Location to event
    evt.Location = location;

    //Check for All day event
    evt.IsAllDay = allDayEvent;

    //End time for event
    if (!allDayEvent)
    {
        // Duration to event
        evt.Duration = TimeSpan.FromHours(duration);

    }

    //Event unique identifier id
    evt.UID = new Guid().ToString();

    //Orgnizer to event
    if (!String.IsNullOrEmpty(organizer))
    {
        evt.Organizer = new Organizer(organizer);
    }
    else
    {
        throw new Exception("Organizer provided was null");
    }
    var attendes = new List<IAttendee>();

    foreach ( var atten in attendees)
    {

        IAttendee attendee1 = new DDay.iCal.Attendee("MAILTO:"+atten.Key)
        {
            Role = atten.Value
        };
        attendes.Add(attendee1);

    }

    //Adding attendees into event

    evt.Attendees = attendes;

    if (!String.IsNullOrEmpty(eventId))
    {
        evt.UID = eventId;
    }

    //Creating Alarm for event
    var alarm = new Alarm
    {
        Duration = new TimeSpan(0, 15, 0),
        Trigger = new Trigger(new TimeSpan(0, 15, 0)),
        Action = AlarmAction.Display,
        Description = "Reminder"
    };

    evt.Alarms.Add(alarm);

    // Save into calendar file.
    var serializer = new iCalendarSerializer(iCal);

    //   serializer.SerializeToString(iCal);

    serializer.Serialize(iCal, "OneTimeCalendarEvent.ics");

    return iCal;
} 
```

我的第二个问题是当我使用带有 ics 文件附件的 smtp 时，它只是将文件附加到邮件中，不能像日历请求事件那样工作下面是我的代码：

```
static void Main(string[] args)
{
    Dictionary<string,string> attendees =new Dictionary<string,string>();
    attendees.Add("abc11@gmail.com", "REQ-PARTICIPANT");
    attendees.Add("abc21@gmail.com", "OPT-PARTICIPANT");

    attendees.Add("abc32@gmail.com", "OPT-PARTICIPANT");
    attendees.Add("abc43@gmail.com", "REQ-PARTICIPANT");
    attendees.Add("abc54@gmail.com", "OPT-PARTICIPANT");

    Program obj = new Program();
    iCalendar iCal= obj.CreateOneTimeCalendarEvent("Gnd Party", attendees,
        "Every budy shawa shawa", 
        DateTime.Now, 30.0, "Pune", 
        "rajendra.b", 
        Guid.NewGuid().ToString(),

        false);

    MailMessage message =obj.initMailMessage();

    //Add the attachment, specify it is a calendar file.
    System.Net.Mail.Attachment attachment =
    System.Net.Mail.Attachment.CreateAttachmentFromString(
    iCal.ToString(), new ContentType("text/calendar"));
    attachment.TransferEncoding = TransferEncoding.Base64;
    attachment.Name = "EventDetails.ics"; //not visible in outlook
    message.Attachments.Add(attachment);
    sendMailMessage(message);
} 
```

发送邮件的方法：

```
private static void sendMailMessage(MailMessage mailMessage)
{
    SmtpClient SmtpServer = new SmtpClient("smtp.gmail.com");

    SmtpServer.Port = 587;
    SmtpServer.Credentials = new System.Net.NetworkCredential("abc@gmail.com", "@12345");
    SmtpServer.EnableSsl = true;

    SmtpServer.Send(mailMessage);
    Console.WriteLine("mail send");
    Console.ReadLine();
} 
```

# php - 在activeCollab中获取登录用户ID

> ID：14260148
> 
> 赞同：0
> 
> 时间：2013-01-10T14:27:35.453
> 
> 标签：php, activecollab

我需要在我的自定义 php 脚本中访问用户 ID，该脚本位于 activecollab 的公共文件夹中。

我不在控制器、模型或视图中。我在框架之外，否则我可以应用这个解决方案：[通过 $this->logged_user 获取 activecollab 中的登录用户数据](https://stackoverflow.com/questions/10633593/fetching-logged-in-user-data-in-activecollab-by-this-logged-user)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T10:22:39.663

如果您不构建[模块](https://www.activecollab.com/docs/manuals/developers-version-3/writing-a-module)（这是扩展系统的推荐方法），那么您可以采取的最佳方法是：

1.  读取存储在 cookie 中的 activeCollab 的会话 ID（仅限 HTTP，不适用于 JavaScript）。变量名称因系统而异，并且都以开头，`ac_activeCollab_sid_#UNIQUE-VALUE#`因此您应该检查您已经登录的系统的存储值，以查看您应该查看的确切变量。
2.  从 cookie 中获取会话密钥后，`acx_user_sessions`使用该密钥查询表以查看会话是否存在以及谁已登录。密钥格式为：`#USER-ID#/#SESSION-ID#/#TIMESTAMP#`因此分解值以获得所需的位。

请注意，我们不建议您对数据库中的数据进行外部转换。阅读它，但不要写任何东西 - 将其留给 activeCollab 或将所需的功能实现为模块（上面提供的链接）。

# ruby - 屈服于调用者的调用者块的惯用方法是什么？

> ID：14260149
> 
> 赞同：2
> 
> 时间：2013-01-10T14:27:39.517
> 
> 标签：ruby

如果一个人想屈服于调用者的调用者的阻塞，应该如何进行？我想出了以下内容：

```
def method1(param)
  method2(param) { |x| yield x if block_given? }
end

def method2(param)
  yield(param) if block_given?   # Can I yield from here
end

method1("String") { |x| puts x } # to here in a more elegant way? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:30:21.300

只需明确传递块

```
def method1(param, &block)
  method2(param, &block)
end

def method2(param)
  yield param if block_given?
end

method1("String") { |x| puts x } # >> String 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T14:31:45.917

一种方法是在第一种方法中不使用 yield：

```
def method1(param, &block)
  method2(param, &block)
end

def method2 param
  yield param if block_given?
end 
```

一元与符号表示方法参数列表中的“块槽”。当您传递一个块时，您可以通过将`&`右边放在最终参数名称之前来访问传递的块。它可以以相同的方式传递给其他方法。

你可以在这里看到很多细节：http `&`: [//ablogaboutcode.com/2012/01/04/the-ampersand-operator-in-ruby/](http://ablogaboutcode.com/2012/01/04/the-ampersand-operator-in-ruby/)

# java - 如何跟踪发送到服务器的 xml

> ID：14260150
> 
> 赞同：1
> 
> 时间：2013-01-10T14:27:40.810
> 
> 标签：java, web-services

我是网络服务的新手，我遇到了问题。
在我的本地机器上，我运行应用程序。
我的步骤：
添加轴库，通过eclipse生成代码（带有wsdl文件）。设置一些值并运行。
结果：
反序列化错误：java.lang.NumberFormatException：对于输入字符串：“”
我认为某些值未在 xml 文件中设置。所以我想跟踪这个 xml 的外观，当我将它发送到服务器时。
我尝试通过soapUI实现它，但在这里我只能生成xml文件并发送给他（当我没有设置一些值时 - 我确实得到了相同的异常）。但我想看看这个由 java 代码生成的 xml 文件的外观。
有任何想法吗？PS对不起我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:30:44.017

[Fiddler](http://www.fiddler2.com/fiddler2/)可能对您有帮助 - 它记录 HTTP 流量。首先，[请查看视频演示](http://www.fiddler2.com/fiddler/help/video/)。

# c# - 一连串的 OnPaint 事件

> ID：14260151
> 
> 赞同：2
> 
> 时间：2013-01-10T14:27:45.600
> 
> 标签：c#, .net, windows-7

我们有一个通常在 Windows XP 下运行的 .NET 2.0 软件（配置为 Windows“经典”模式，没有花里胡哨）。现在我在 Windows 7 上运行它的全部荣耀。我在 Windows 7 上注意到的是，当面板失效时，布局中的某个面板塞满了标签和布局，会生成各种 OnPaint 事件。不仅如此，随后的 OnPaint 调用似乎会中断当前正在执行的调用。从窗口的消息队列中取出一条消息，处理它直到完成，然后取出下一条的方案发生了什么？

我有时使用 OnPaint 方法来配置布局，也许这就是生成额外 OnPaint 事件的原因，但我至少不能在下一次调用之前运行当前的 OnPaint 方法来完成吗？我不得不用各种检查乱扔我的代码，以防止正在发生的这种重入。

这对于在经典模式下运行的 Windows XP 来说不是问题，尽管在 Windows XP 完全运行时可能会出现问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T14:34:47.977

> 我有时使用 OnPaint 方法来配置布局，

当您“配置”（更改）布局时，会使控件无效。Paint 事件/方法不是更改任何内容的正确位置。它应该只油漆。

> 但是我不能在下一次调用之前至少运行当前的 OnPaint 方法来完成吗？

当 Paint 不会导致 Invalidate（它不应该）时，这是自动的。当它发生时，你就有一个应该修复的错误。

# javascript - 使用 html5 朗读文本

> ID：14260157
> 
> 赞同：1
> 
> 时间：2013-01-10T14:28:21.797
> 
> 标签：javascript, html, text, speech

我已经在网上找了一段时间，似乎无法找到 api 让您让 html5 说出预定义的文本。我有一个数组中的数字列表，我希望 html5 以 1 秒的间隔说出这些数字。有人知道如何制作 html5/javascript 通话号码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:11:27.993

您可以使用[Microsoft SAPI](http://msdn.microsoft.com/en-us/library/ms723627%28v=vs.85%29.aspx)制作将文本​​转换为语音的应用程序，但很难找到一些关于它的好的教程，几乎只有在线文档。

# database - 数据库中的位图索引不能加快查询速度

> ID：14260162
> 
> 赞同：1
> 
> 时间：2013-01-10T14:28:39.783
> 
> 标签：database, oracle, indexing

我正在尝试为我的数据库类证明一个声明。我已经说过，使用位图索引，与不使用位图索引时相比，可以在包含仅包含枚举值（如性别）的列的表上更快地执行 WHERE 查询。

除此之外，我们试图证明它对包含许多不同随机值的列的表没有帮助。

我们在 Oracle SQLDeveloper 中创建了两个如上所述的表，在 10000 行中填充了如上所述的信息。Oracle 的版本是 v11。

我们使用一个过程在表中存储信息。虽然枚举值随机设置为“S”、“M”或“L”，但另一个表的值是完全随机的（数字和字母）。

起初，我们运行了以下语句：

```
set timing on
SELECT * FROM INDEXTEST2 WHERE GENDER = 'M' AND MARRIED = 'N' AND CHILDREN = 'Y' 
```

重复运行此脚本最终需要 00.016 秒。之后，我们通过右键单击表创建索引，然后创建索引。我们选择了所有列并选中`Bitmap`。之后，我们再次运行查询几次，只是遇到相同的速度：大约 00.015 秒。我们还尝试删除索引，但没有结果。我们是否在这里遗漏了某些东西，或者我们是否正确地完成了所有操作而您只是看不到速度上的差异？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T17:21:26.623

即使没有索引，查询也可能非常快。因此，您无法通过秒表来展示性能提升。

我创建了一个包含 1.000.000 行的测试表。在我们的机器上，没有任何索引的全表扫描需要 0.2 秒。使用位图索引，需要 0.09 秒。但是，没有索引，它会扫描所有 2000 个数据库块，使用位图索引，它需要读取 60-70 个块。

```
CREATE TABLE indextest (
  id       NUMBER      NOT NULL,
  gender   VARCHAR2(1) NOT NULL CHECK (gender   IN ('M','F')),
  married  VARCHAR2(1) NOT NULL CHECK (married  IN ('Y','N')),
  children VARCHAR2(1) NOT NULL CHECK (children IN ('Y','N'))
) NOLOGGING;

INSERT /*+ APPEND */ 
  INTO indextest (id, gender, married, children)
WITH 
  q1 AS (SELECT          level AS x1 FROM dual CONNECT BY level <= 1000),
  q2 AS (SELECT 1000*(level-1) AS x2 FROM dual CONNECT BY level <= 1000),
  q3 AS (SELECT x2+x1 AS id FROM q1, q2)
SELECT id, 
       CASE WHEN dbms_random.value < 0.5   THEN 'M' ELSE 'F' END as gender,
       CASE WHEN dbms_random.value < 0.3   THEN 'Y' ELSE 'N' END as married,
       CASE WHEN dbms_random.value < 0.2   THEN 'Y' ELSE 'N' END as children
  FROM q3;
COMMIT;
EXEC DBMS_STATS.GATHER_TABLE_STATS(user, 'indextest');
ALTER TABLE indextest ADD CONSTRAINT pk_indextest PRIMARY KEY (id);
CREATE BITMAP INDEX bi_indextest_gender   ON indextest(gender);
CREATE BITMAP INDEX bi_indextest_married  ON indextest(married);
CREATE BITMAP INDEX bi_indextest_children ON indextest(children); 
```

现在，如果您显示查询统计信息，例如在 SQL*Plus 中，您可以显示使用索引需要 60-70 个块读取（“一致获取”）：

```
SET TIMING ON
SET LINE 300
SET AUTOTRACE TRACE EXPLAIN STAT
SELECT count(*) FROM indextest WHERE gender = 'M' AND married = 'N' AND children = 'Y';

Abgelaufen: 00:00:00.07

------------------------------------------------------------------------------------------------------
| Id  | Operation                    | Name                  | Rows  | Bytes | Cost (%CPU)| Time     |
------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |                       |     1 |     6 |    63   (0)| 00:00:01 |
|   1 |  SORT AGGREGATE              |                       |     1 |     6 |            |          |
|   2 |   BITMAP CONVERSION COUNT    |                       |   125K|   732K|    63   (0)| 00:00:01 |
|   3 |    BITMAP AND                |                       |       |       |            |          |
|*  4 |     BITMAP INDEX SINGLE VALUE| BI_INDEXTEST_CHILDREN |       |       |            |          |
|*  5 |     BITMAP INDEX SINGLE VALUE| BI_INDEXTEST_GENDER   |       |       |            |          |
|*  6 |     BITMAP INDEX SINGLE VALUE| BI_INDEXTEST_MARRIED  |       |       |            |          |
------------------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   4 - access("CHILDREN"='Y')
   5 - access("GENDER"='M')
   6 - access("MARRIED"='N')

Statistiken
----------------------------------------------------------
          0  recursive calls
          0  db block gets
         67  consistent gets
          0  physical reads
          0  redo size
        235  bytes sent via SQL*Net to client
        252  bytes received via SQL*Net from client
          2  SQL*Net roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
          1  rows processed 
```

如果隐藏索引，Oracle 需要扫描整个表：

```
ALTER INDEX bi_indextest_gender   INVISIBLE;
ALTER INDEX bi_indextest_married  INVISIBLE;
ALTER INDEX bi_indextest_children INVISIBLE;
SELECT count(*) FROM indextest WHERE gender = 'M' AND married = 'N' AND children = 'Y';

Abgelaufen: 00:00:00.15

--------------------------------------------------------------------------------
| Id  | Operation          | Name      | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------
|   0 | SELECT STATEMENT   |           |     1 |     6 |   512   (6)| 00:00:07 |
|   1 |  SORT AGGREGATE    |           |     1 |     6 |            |          |
|*  2 |   TABLE ACCESS FULL| INDEXTEST |   125K|   732K|   512   (6)| 00:00:07 |
--------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - filter("GENDER"='M' AND "MARRIED"='N' AND "CHILDREN"='Y')

Statistiken
----------------------------------------------------------
        292  recursive calls
          0  db block gets
       2289  consistent gets
          0  physical reads
          0  redo size
        235  bytes sent via SQL*Net to client
        252  bytes received via SQL*Net from client
          2  SQL*Net roundtrips to/from client
          6  sorts (memory)
          0  sorts (disk)
          1  rows processed 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T17:59:30.253

尝试选择更少的行（相对于表中的所有行）。如果查询选择了表中的大部分行，Oracle 的查询优化器可能（正确地）决定只进行全表扫描实际上更快 - 如果它必须加载表堆的大部分或所有块，它也可以直接执行。

除此之外，您的测试集太小了。尝试一个足够大的集合（添加几个零）以将执行时间推到超出秒表的分辨率（在 Windows 机器上通常为 16 毫秒）。更好的是，选择一个不完全适合缓存的大小。

但是即使你做了所有这些，你仍然可能会因为 Oracle 的整体“聪明”而得到一些奇怪的结果。例如，Oracle 11g 引入了[查询结果缓存](http://www.oracle-developer.net/display.php?id=503)，可以完全扭曲重复查询的执行时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T14:32:11.237

1.  每列创建一个位图索引。
2.  使用大量数据进行测试。
3.  使用 DBMS_Xplan 查看执行计划

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-06-15T15:08:07.567

除了拥有足够大的数据集之外，请在执行每个查询之前查看一下清除缓存

# objective-c - 使用单个按钮删除许多 UIImages

> ID：14260166
> 
> 赞同：0
> 
> 时间：2013-01-10T14:28:53.683
> 
> 标签：objective-c, xcode, uiimageview, uiimage

我正在使用源代码`UIImage`从这个[博客](http://www.icodeblog.com/2010/10/14/working-with-uigesturerecognizers/)加载/旋转/缩放/移动一个。

我需要用一个按钮一次删除所有图像，我试过这个：

```
[holderView removeFromSuperview]; 
```

但它只删除最后一个创建的不是全部。

**编辑**

我在应用程序中有另一个子视图，我不希望它们被删除“按钮、UIImageView、UIScrollView ..etc”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:37:26.853

试试这个代码

```
NSArray *viewsToRemove = [self.view subviews];
for (UIView *v in viewsToRemove)
{
    [v removeFromSuperview];
} 
```

希望对你有帮助

编辑 ：-

更有效的去除

```
NSArray *viewsToRemove = [self.view subviews];
    for (UIView *v in viewsToRemove)
    {
        NSArray *imagesToRemove = [v subviews];
        for (UIImageView *i in imagesToRemove)
        {
            [i removeFromSuperview];
        }
        [v removeFromSuperview];
    } 
```

第二次编辑：-

```
NSArray *viewsToRemove = [self.view subviews];
    for (UIView *v in viewsToRemove)
    {
        NSArray *imagesToRemove = [v subviews];
        for (UIImageView *i in imagesToRemove)
        {
            i.image = nil;
        }
        //[v removeFromSuperview];
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:43:13.660

我认为您可以使用 NSMutableArray 来存储 UIView 的列表

将此代码嵌入到 .h

```
@property (nonatomic, retain) NSMutableArray *imgList; 
```

我是 .m 文件

```
@synthesize imgList; 
```

视图加载后

```
NSMutableArray *imgList = [[NSMutableArray alloc] init]; 
```

在“imagePickerController:didFinishPickingMediaWithInfo:”末尾添加

```
[imgList addObject:holderView]; 
```

当您需要删除使用

```
for(UIView *tempView in imgList) {
    [tempView removeFromSuperview];
} 
```

# java - 实现一个计数器 JDBC 并发问题

> ID：14260170
> 
> 赞同：0
> 
> 时间：2013-01-10T14:29:08.247
> 
> 标签：java, mysql, jdbc, concurrency, transactions

我正在尝试在 JDBC 中实现一个计数器，该方法本质上是增加一个列值并返回新的列值，下面是我的代码片段我首先执行 select .. for update 以获取旧值（也导致一行lock) 然后对该行执行更新。我是否可以假设没有其他事务可以干扰 select .. for update 然后更新之间的列 val 的值。

```
 //get connection here
        con.setAutoCommit(false);
        PreparedStatement statement = con.prepareStatement("SELECT val FROM atable WHERE id=? FOR UPDATE");
        statement.setInt(1, id);
        ResultSet resultSet = statement.executeQuery();
        if (resultSet.next()) {
            oldVal = resultSet.getInt("val");
            statement = con.prepareStatement("UPDATE atable SET val=" + oldVal + "+1 WHERE id=?");
            statement.setInt(1, id);
            int result = statement.executeUpdate();
            if (result != 1) {
                throw new SQLException("error message");
            } else {
                newVal = oldVal + 1;//could do another select statement to get the new value

                statement.close();

            }
        } else {
                throw new SQLException("error message");
        }
        resultSet.close();
        con.commit();
        con.setAutoCommit(true);
       //close connection here 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:39:49.017

我会做类似下面的代码。（为了可读性，我取出了检查和异常；随时将它们添加回来。）

```
con.setAutoCommit(false);
PreparedStatement incrementVal = 
    con.prepareStatement("UPDATE atable SET val = val + 1 WHERE id=?");
incrementVal.setInt(1, id);
statement.executeUpdate();
PreparedStatement selectIncrementedVal = 
    con.prepareStatement("SELECT val FROM atable WHERE id=?");
selectIncrementedVal.setInt(1, id);
ResultSet resultSet = selectIncrementedVal.executeQuery();
if (resultSet.next()) {
    newVal = resultSet.getInt("val");
}
resultSet.close();
con.commit();
con.setAutoCommit(true); 
```

请参阅下面有关事务隔离的信息。

[http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html](http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html)

[http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html#isolevel_serializable](http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html#isolevel_serializable)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:44:07.200

> 我是否可以假设没有其他事务可以干扰 select .. for update 然后 update 之间的列 val 的值

是的，您可以。否则可能会导致“数据库不一致”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:46:16.203

我打算添加一些关于数据库当前隔离级别的作用，但在我不确定的情况下，我四处搜索，发现了其他一些有趣的文章： [SQLServer Question](https://stackoverflow.com/questions/1483725/select-for-update-with-sql-server) and [Oracle-centric answer](https://stackoverflow.com/questions/10935850/when-to-use-select-for-update)。

最终，我不确定（对不起）。我可能会建议一个存储过程来提供您想要的显式原子锁定，并让它在需要时将新值返回给您的代码。但是，存储过程语法可能是特定于数据库供应商的。

（顺便说一句，您没有展示如何获取 Connection 引用。如果有多个线程同时使用同一个连接，他们将能够在您背后修改“自动提交”属性。很可能您是使用连接池，因此在任何给定时间只有一个线程具有此引用。）

另请注意，数据库隔离级别（如果结果是相关的）也设置在连接级别上，因此如果您从池中获取连接，则前一个用户可能已将连接置于与之前不同的状态你需要什么。您谨慎地恢复了`setAutoCommit()`属性；您可能需要对`setTransactionIsolation()`属性执行相同的操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T14:50:07.110

使用 Oracle，您可以执行以下操作：

```
CallableStatement cs = con.prepareCall(
  "UPDATE atable SET val = val + 1 WHERE id=? RETURNING val INTO ?");
cs.setInt(1, id); 
cs.registerOutParameter(2, Types.NUMERIC); 
cs.execute();
int newId = cs.getInt(2); 
```

# php - 使用 PHP 的 schemaValidate 的架构无效

> ID：14260171
> 
> 赞同：0
> 
> 时间：2013-01-10T14:29:07.563
> 
> 标签：php

我正在尝试使用 PHP 针对特定 XSD 验证 xml 文件。已在 Windows 7 上使用 EasyPHP-12.1（PHP 5.4.6 版本）进行了测试。这是加载 xml、验证它并显示任何错误的服务器端 PHP 文件。

**PHP 代码**

```
function libxml_display_error($error)
{
    $return = "<br/>\n";
    switch ($error->level) {
        case LIBXML_ERR_WARNING:
            $return .= "<b>Warning $error->code</b>: ";
            break;
        case LIBXML_ERR_ERROR:
            $return .= "<b>Error $error->code</b>: ";
            break;
        case LIBXML_ERR_FATAL:
            $return .= "<b>Fatal Error $error->code</b>: ";
            break;
    }
    $return .= trim($error->message);
    if ($error->file) {
        $return .=    " in <b>$error->file</b>";
    }
    $return .= " on line <b>$error->line</b>\n";

    return $return;
}

function libxml_display_errors() {
    $errors = libxml_get_errors();
    foreach ($errors as $error) {
        print libxml_display_error($error);
    }
    libxml_clear_errors();
}

// Enable error handling
libxml_use_internal_errors(true);

$xml = new DOMDocument();
$xml->load('testFile');
if (!$xml->schemaValidate('sampleSchema.xsd')) {
    print '<b>Errors Found!</b>';
    libxml_display_errors();
}
else {
echo "Validated Successfully!";
} 
```

使用下面的 xml 和 xsd 模式，它可以成功运行而不会产生任何错误：

**XML:**

```
 <lures>
     <lure>
      <lureName>Silver Spoon</lureName>
      <lureCompany>Clark</lureCompany>
      <lureQuantity>7</lureQuantity>
     </lure>
    </lures>

```

**XSD：**

```
 <?xml version="1.0"?>
    <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified">
    <xs:element name="lures">
     <xs:complexType> 
      <xs:sequence>
       <xs:element name="lure">
        <xs:complexType>
         <xs:sequence>
         <xs:element name="lureName" type="xs:string"/>
         <xs:element name="lureCompany" type="xs:string"/>
         <xs:element name="lureQuantity" type="xs:integer"/>
         </xs:sequence>
        </xs:complexType>
       </xs:element>
      </xs:sequence>
     </xs:complexType>
    </xs:element>
    </xs:schema> 
```

但是，当我尝试根据标准 Mpeg7 架构文件[mpeg7-v1.xsd](http://standards.iso.org/ittf/PubliclyAvailableStandards/MPEG-7_schema_files/mpeg7-v1.xsd)验证 Mpeg7 xml 时出现问题，其中 PHP 生成以下错误：

```
Warning: DOMDocument::schemaValidate(): Invalid Schema in C:\Program Files (x86)\EasyPHP-12.1\www\ServerSideTests\validate.php on line 38
Errors Found!
Error 3008: local list type: A type, derived by list or union, must have the simple ur-type definition as base type, not '{urn:mpeg:mpeg7:schema:2001}integerVector'. in file:///C:/Program%20Files%20(x86)/EasyPHP-12.1/www/ServerSideTests/mpeg7-v1.xsd on line 1251 
```

我想知道官方XSD怎么可能无效......既然XSD完全正确，那么可能libxml库与这个W3C Schema不完全兼容？我想知道的是我必须如何修改上述代码以成功验证 mpeg7 文件，或者我是否必须将其实现为另一种服务器端语言......

**编辑：我的测试 Mpeg7 文件**

```
<Mpeg7 xmlns="urn:mpeg:mpeg7:schema:2001"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:mpeg7="urn:mpeg:mpeg7:schema:2001" 
       xmlns:xml="http://www.w3.org/XML/1998/namespace"
       xsi:schemaLocation="urn:mpeg:mpeg7:schema:2001  mpeg7-v1.xsd">
<Description xsi:type="CompleteDescriptionType" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<Relationships/>
</Description>
</Mpeg7> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:36:26.550

我认为 XML 需要

```
<?xml version="1.0" encoding="utf-8"?>
<lures xmlns="<THE NAME SPACE HERE"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://<SCHEMA NS LOCARTION - i.e. unique> lures\"> 
```

那么XSD需要

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
           xmlns="<SCHEMA NS LOCATION - as above>" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T09:11:34.893

**XML**

```
<?xml version="1.0" encoding="utf-8"?>
<lures xmlnshttp://nonwhere.com/"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://nowhere.com lures\">

 <lures>
     <lure>
      <lureName>Silver Spoon</lureName>
      <lureCompany>Clark</lureCompany>
      <lureQuantity>7</lureQuantity>
     </lure>
    </lures> 
```

**XSD**

```
<?xml version="1.0"?>
    <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" xmlns="http://nowhere.com">
    <xs:element name="lures">
     <xs:complexType> 
      <xs:sequence>
       <xs:element name="lure">
        <xs:complexType>
         <xs:sequence>
         <xs:element name="lureName" type="xs:string"/>
         <xs:element name="lureCompany" type="xs:string"/>
         <xs:element name="lureQuantity" type="xs:integer"/>
         </xs:sequence>
        </xs:complexType>
       </xs:element>
      </xs:sequence>
     </xs:complexType>
    </xs:element>
    </xs:schema> 
```

似乎对我有用。（即PHP）

# c# - Split() 字符串，除了某些字符组合

> ID：14260173
> 
> 赞同：10
> 
> 时间：2013-01-10T14:29:13.663
> 
> 标签：c#

我想要类似的东西：

```
"aaaXaaaXaaaXaaaYXaaa".Split('X'); 
```

但希望它忽略“YX”。

当然，我可以简单地循环并纠正它。但是有没有内置的方法呢？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-10T14:31:08.977

您可以使用带有否定后视的正则表达式：

```
string[] result = Regex.Split(s, "(?<!Y)X"); 
```

在线查看它：[ideone](http://ideone.com/mqhEKN)

有关环视的更多信息：[Lookahead 和 Lookbehind 零宽度断言](http://www.regular-expressions.info/lookaround.html)

# objective-c - 由于设置单元格背景图像，iPhone TableView 滚动滞后

> ID：14260177
> 
> 赞同：1
> 
> 时间：2013-01-10T14:29:23.537
> 
> 标签：objective-c, uitableview

我的应用程序中有几个表，其中正在检索数据并动态更新表。我在设备上注意到，当屏幕上的单元格数量超过屏幕容量时，需要滚动，滚动时会滞后。

我开始逐行检查我的代码以找到问题，直到我最终找到它

```
CachedImages *cache = [[CachedImages alloc] init];
                    UIColor *backgroundColour;
                    if([table getImage] != nil)
                    {
                        backgroundColour = [[UIColor alloc] initWithPatternImage:[cache getImageByPath:[[table getImage] getName]]];
                    }

cell.backgroundColor = [backgroundColour colorWithAlphaComponent:fOpacity]; 
```

（我有一个表类，它存储表信息，例如背景图像和数据）

特别是这条线

```
cell.backgroundColor = [backgroundColour colorWithAlphaComponent:fOpacity]; 
```

如果我注释掉那一行，表格会完美滚动，但是当我取消注释时，它会导致滞后问题。所以为了解决这个问题，我设置了一个实例变量，它存储了表格的背景颜色，并从委托方法中删除了缓存的图像代码，所以它在表格之前加载，所以它不必一直拉它每次需要重绘单元格时从缓存中提取。

这基本上解决了这个问题，当我第一次访问屏幕并向下滚动时，它有点滞后，但在初始滚动到底部后，性能很好。无论如何要防止这种初始延迟，我已经将所有繁重的渲染从委托方法中移出，但是这个图像代码仍然会在用户第一次进入屏幕时造成轻微的延迟。

关于如何防止这种情况的任何想法？表是自定义表，我是这样设置的

```
 NSString *CellIdentifier = @"CustomCellIdentifier";
                    CustomCell *cell = (CustomCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
                    if (cell == nil)
                    {
                        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"CustomCellView" owner:self options:nil];
                        cell = [nib objectAtIndex:0];
                    } 
```

所以我正在重用标识符。

我们欢迎所有的建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T11:40:35.800

我能想出的最佳解决方案是在屏幕出现之前预加载图像，因此它不必一直从缓存中获取它。这基本上解决了这个问题，第一次加载屏幕时会有一点延迟，但之后就很流畅了。到目前为止我找到的最佳解决方案

# javascript - 拖动div，正确放置并发送ajax请求

> ID：14260182
> 
> 赞同：0
> 
> 时间：2013-01-10T14:29:49.267
> 
> 标签：javascript, jquery, ajax

很多事情要做，但首先要做的事情。

我有一个`<div class="showcase">`包含很多的`<div class="game">`，他们每个人都有一个

```
onclick="addpop('delpopup.php?id=something&pos=somethingelse&box=image')" 
```

告诉我这条路线是否可行：

- 使用 jQuery UI 管理 div 拖动（我可以让 div 在正确的位置“捕捉”吗？如果我有 div1、div2、div3 和 div4，如果我将 div4 移动到 div2 上，它们必须正确放置在 div1、div4 , div2, div3 可能不仅在图形上（“位置：绝对”），而且在 html 代码中

```
<div1>[...]</div>
<div4>[...]</div>
<div2>[...]</div>
<div3>[...]</div> 
```

每次移动后，我只需要更改右侧 div 的 addpop 函数的“pos”部分（如果我将 4 移到 2 上，我必须更改 pos2 中的 div4、pos3 中的 div2 和 pos4 中的 div3）（我认为这个部分可以通过javascript处理。对吗？）

- 每次放置后，我通过 jQuery/Ajax 向另一个页面发送一个请求，以尝试在数据库中更改发送我移动的 DIV（位置和 ID）以及哪个 DIV（位置和 ID）第一个结束时的位置我松开鼠标按钮。我怎样才能获得这 4 个数据（jQuery UI 可以设法为我获得这些数据吗？）

**（注意：我不是在问整个问题的解决方案；我是在问这是否是解决这个问题的正确方法）**

我在考虑这种可能性。或者，还有另一个更简单的 javascript/jquery/dunnowhat 函数可以单独处理整个事情？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:49:52.607

尝试这个...

```
$(".div").droppable({ 
   drop: function( event, ui ) { 
      if (!ui.draggable.data("drop")){ 
         //here put your ajax
      } 
   }, 
   out: function( event, ui ) { 
      if (ui.draggable.data("soltado")){ 
        //logic of remove element
      } 
   } 
}); 
```

[这里的](http://www.desarrolloweb.com/articulos/ejemplos/jquery/ui/interactions/9-droppable-azules-rojos.html)例子

问候。

# iframe - 使 CKEditor4 忽略 Google AdSense 代码

> ID：14260183
> 
> 赞同：0
> 
> 时间：2013-01-10T14:29:49.567
> 
> 标签：iframe, ckeditor, adsense

我正在使用 CKEditor4 内联编辑我的页面内容。但是，当我将 Google AdSense 代码添加到内容的原始 HTML 并加载内联编辑器时，脚本会被执行，并且新的代码`iframe`会被放置在我的 editable `div`. 当我保存页面时，它会同时保存 iframe 和脚本；所以下次我启动内联编辑器时，它会创建另一个。

这真的很烦人，我想知道是否有人知道如何防止 CKEditor4`<script>`在编辑器本身中执行标签。

我整天都在谷歌搜索解决方案，但找不到任何解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:44:31.457

You can filter any kind of code both when it's parsed and returned. The easiest way, I guess, is removing the `iframe` when editor data is being saved. Frankly, I'm not really into AdSense but I observed that generated code is an `ins` tag wrapped in paragraph. You can eventually extend this filter to be more specific, if you want.

```
CKEDITOR.inline( 'editable', {
    on: {
        instanceReady: function() {
            this.dataProcessor.htmlFilter.addRules( {
                elements: {
                    p: function( element ) {
                        var children = element.children;
                        for ( var i = children.length; i--; ) {
                            if ( children[ i ].name == 'ins' )
                                return false;
                        }
                    }
                }
            } );
        }
    }
} ); 
```

Also read about [`dataProcessor`](http://docs.cksource.com/CKEditor_3.x/Developers_Guide/Data_Processor) it's a powerful tool in CKEditor. You'll do magic once you got it.

# java - 为单个 JTree 自定义 Tree.collapsedIcon

> ID：14260185
> 
> 赞同：3
> 
> 时间：2013-01-10T14:29:55.610
> 
> 标签：java, swing, icons, jtree, uimanager

我知道您可以在使用 Swing 的应用程序中`Tree.collapsedIcon`使用. 例如：`JTrees``UImanager`

```
UIManager.put("Tree.collapsedIcon",closedcabinet); 
```

我希望灵活地更改同一应用程序中`Tree.collapsedIcon`的个人`JTrees`，最终结果是同一应用`Tree.collpasedIcon`程序中的不同树可能会出现不同的结果。

我知道如何使用自定义渲染器自定义单个图标。例如，我`setIcon`用来设置叶子`SetOpenIcon`的图标，为扩展时具有子节点的节点设置图标，并对没有子节点的节点`SetCloseIcon`执行相同操作。

`Tree.collapsedIcon`但是除了使用`UIManager`具有上述限制 的之外，我不知道如何执行此操作。

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T15:02:08.527

如果您假设您正在使用的 TreeUI 是一个`instance of` `BasicTreeUI`，您可以执行以下操作：

```
TreeUI tui = treeInstance.getUI();
if (tui instanceof BasicTreeUI) {
  ((BasicTreeUI)tui).setCollapsedIcon(myIcon);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-10T16:33:17.810

另一种方法是`UIManager`在构造每棵树时设置条件。在下面的示例中，静态工厂提供了所需的`Icon`对。`MetalLookAndFeel`该示例从for contrast中借用了两个图标。[在这里](https://stackoverflow.com/a/4641530/230513)看到的自定义图标也是可能的。

```
frame.add(new JTreePanel(Icons.getDefault()));
frame.add(new JTreePanel(Icons.getMetal())); 
```

![图片](../Images/ed719f55bcd70b3329d4721174ccc75c.png)

SSCCE：

```
import java.awt.EventQueue;
import java.awt.GridLayout;
import javax.swing.Icon;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTree;
import javax.swing.LookAndFeel;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;
import javax.swing.plaf.metal.MetalLookAndFeel;

/** @see https://stackoverflow.com/a/14262706/230513 */
public class JTreePanel extends JPanel {

    public static final class Icons {

        private static final String COLLAPSED_ICON = "Tree.collapsedIcon";
        private static final String EXPANDED_ICON = "Tree.expandedIcon";
        private Icon collapsed;
        private Icon expanded;

        public static Icons getDefault() {
            Icons icons = new Icons();
            icons.collapsed = (Icon) UIManager.get(COLLAPSED_ICON);
            icons.expanded = (Icon) UIManager.get(EXPANDED_ICON);
            return new Icons();
        }

        public static Icons getMetal() {
            Icons icons = new Icons();
            try {
                LookAndFeel save = UIManager.getLookAndFeel();
                LookAndFeel laf = new MetalLookAndFeel();
                UIManager.setLookAndFeel(laf);
                icons.collapsed = (Icon) UIManager.get(COLLAPSED_ICON);
                icons.expanded = (Icon) UIManager.get(EXPANDED_ICON);
                UIManager.setLookAndFeel(save);
            } catch (UnsupportedLookAndFeelException ex) {
                ex.printStackTrace(System.err);
            }
            return icons;
        }
    }

    public JTreePanel(Icons pair) {
        UIManager.put("Tree.collapsedIcon", pair.collapsed);
        UIManager.put("Tree.expandedIcon", pair.expanded);
        JTree tree = new JTree();
        this.add(tree);
        for (int i = 0; i < tree.getRowCount(); i++) {
            tree.expandRow(i);
        }
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                createGUI();
            }
        });
    }

    private static void createGUI() {
        final JFrame frame = new JFrame();
        frame.setLayout(new GridLayout(1, 0));
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(new JTreePanel(Icons.getDefault()));
        frame.add(new JTreePanel(Icons.getMetal()));
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T15:01:48.067

我能看到的唯一方法是从允许您定义每个 JTree 的图标的[Java 源代码创建您自己的 JTree 版本。](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/javax/swing/JTree.java)

我看到 JTree 从[javax.accessibility.AccessibleContext](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/javax/accessibility/AccessibleContext.java#AccessibleContext.getAccessibleIcon%28%29)获取图标，并最终从接口的某些定义类中获取`AccessibleIcon`。

# c++ - 使用 Python.h 编译错误 gcc

> ID：14260196
> 
> 赞同：3
> 
> 时间：2013-01-10T14:30:32.710
> 
> 标签：c++

我正在尝试将 python 嵌入到 c++ 中，并且我一直在使用一些示例代码。我正在使用 boost python 解释器，它工作正常，但现在我似乎无法编译一些使用 Python.h 的 c++ 代码。我收到一个错误，似乎是未正确引用库（此代码应该可以正常工作，因为它是直接从[http://www.codeproject.com/Articles/11805/Embedding-Python-in-CC-复制的第一部分](http://www.codeproject.com/Articles/11805/Embedding-Python-in-C-C-Part-I)）。我尝试了许多编译标志。任何帮助都感激不尽！谢谢 ：）

下面是一个例子和我收到的错误：

g++ -Wall -o call_function call_function.c

```
call_function.c: In function âint main(int, char**)â:
call_function.c:61:56: warning: format â%dâ expects argument of type âintâ, but argument 2 has type âlong intâ [-Wformat]
/tmp/ccAUMMHm.o: In function `main':
call_function.c:(.text+0x2a): undefined reference to `Py_Initialize'
call_function.c:(.text+0x3d): undefined reference to `PyString_FromString'
call_function.c:(.text+0x4d): undefined reference to `PyImport_Import'
call_function.c:(.text+0x5d): undefined reference to `PyModule_GetDict'
call_function.c:(.text+0x7b): undefined reference to `PyDict_GetItemString'
call_function.c:(.text+0x8b): undefined reference to `PyCallable_Check'
call_function.c:(.text+0xb2): undefined reference to `PyTuple_New'
call_function.c:(.text+0xe5): undefined reference to `PyInt_FromLong'
call_function.c:(.text+0xf5): undefined reference to `PyErr_Print'
call_function.c:(.text+0x118): undefined reference to `PyTuple_SetItem'
call_function.c:(.text+0x13f): undefined reference to `PyObject_CallObject'
call_function.c:(.text+0x195): undefined reference to `PyObject_CallObject'
call_function.c:(.text+0x1ac): undefined reference to `PyInt_AsLong'
call_function.c:(.text+0x1fd): undefined reference to `PyErr_Print'
call_function.c:(.text+0x204): undefined reference to `PyErr_Print'
call_function.c:(.text+0x279): undefined reference to `Py_Finalize'
collect2: ld returned 1 exit status 
```

以下是c++代码

```
// call_function.c - A sample of calling python functions from C code
//
#include "/usr/include/python2.6/Python.h"

int main(int argc, char *argv[])
{
    int i;
    PyObject *pName, *pModule, *pDict, *pFunc, *pArgs, *pValue;
    if (argc < 3)
    {
        printf("Usage: exe_name python_source function_name\n");
        return 1;
    }
    // Initialize the Python Interpreter
    Py_Initialize();
    // Build the name object
    pName = PyString_FromString(argv[1]);
    // Load the module object
    pModule = PyImport_Import(pName);
    // pDict is a borrowed reference
    pDict = PyModule_GetDict(pModule);
    // pFunc is also a borrowed reference
    pFunc = PyDict_GetItemString(pDict, argv[2]);
    if (PyCallable_Check(pFunc))
    {
        // Prepare the argument list for the call
        if( argc > 3 )
        {
                pArgs = PyTuple_New(argc - 3);
                for (i = 0; i < argc - 3; i++)
                {
                    pValue = PyInt_FromLong(atoi(argv[i + 3]));
                    if (!pValue)
                    {
                        PyErr_Print();
                        return 1;
                    }
                    PyTuple_SetItem(pArgs, i, pValue);
                }
                pValue = PyObject_CallObject(pFunc, pArgs);
                if (pArgs != NULL)
                {
                    Py_DECREF(pArgs);
                }
        } else
        {
                pValue = PyObject_CallObject(pFunc, NULL);
        }
        if (pValue != NULL)
        {
            printf("Return of call : %d\n", PyInt_AsLong(pValue));
            Py_DECREF(pValue);
        }
        else
        {
            PyErr_Print();
        }
    } else
    {
        PyErr_Print();
    }

    // Clean up
    Py_DECREF(pModule);
    Py_DECREF(pName);
    // Finish the Python Interpreter
    Py_Finalize();
    return 0;
} 
```

以下是python脚本：

```
'''py_function.py - Python source designed to '''
'''demonstrate the use of python embedding'''

def multiply():
    c = 12345*6789
    print 'The result of 12345 x 6789 :', c
    return c 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T14:32:24.107

您需要使用`-lpython2.6`.

编译器无法找到定义在`libpythonX.Y.so`. 要告诉它使用该库，您需要添加`-lpythonX.Y`. 由于您的 Python 版本是 2.6，因此您需要使用`-lpython2.6`.

你得到类似的东西的事实`(.text+0xf00)`告诉你这是一个链接器问题，这意味着你的代码本身很好。问题只是一些功能没有完全定义。这意味着，编译器在编译时（从头文件）知道原型（即返回类型和参数值），但它不知道实际代码在哪里。这取决于链接器来解决这个问题，它无法通过魔法知道它会在哪里找到必要的功能。

# reporting-services - SQL Reporting Services 与 SharePoint 集成

> ID：14260200
> 
> 赞同：0
> 
> 时间：2013-01-10T14:30:52.037
> 
> 标签：reporting-services, sharepoint-2007

我在 SQL Server Reporting Services 2008r2 中准备了 3 个报告，我想将它们集成到 SharePoint2007 中。但是，我不知道该怎么做。我对 SharePoint 很陌生。我搜索了太多来源，但没有正确获取信息。SharePoint 是唯一在公司内广播报告的方法，还是有其他方法可以在公司内共享报告？你能告诉我一个跟随的方法吗？

# c++ - C++中位运算符的定义是什么？

> ID：14260204
> 
> 赞同：3
> 
> 时间：2013-01-10T14:31:07.820
> 
> 标签：c++, undefined-behavior, language-lawyer

根据标准，运算符 << 为带负号的第一个操作数产生未定义行为。

**C++11 5.8.2**

```
The value of E1 << E2 is E1 left-shifted E2 bit positions; vacated bits are zero-
filled. If E1 has an unsigned type, the value of the result is E1 × 2 pow E2,
reduced modulo one more than the maximum value representable in the result type.
Otherwise, if E1 has a signed type and non-negative value, and E1 × 2 pow E2 is
representable in the result type, then that is the resulting value; otherwise,
the behavior is undefined 
```

这是可以理解的，因为内存中整数的布局是实现定义的。

**C++11 3.9.1.7**

```
this International Standard permits 2’s complement, 1’s complement and
signed magnitude representations for integral types. 
```

另一方面，该标准似乎并没有准确定义按位 & | 和 ^ 应该做。

**C++11 5.11 位与运算符**

```
and-expression:
    equality-expression
    and-expression & equality-expression
1 The usual arithmetic conversions are performed; the result is the bitwise 
AND function of the operands. The operator applies only to integral
or unscoped enumeration operands. 
```

**C++11 5.12 按位异或运算符**

```
exclusive-or-expression:
    and-expression
    exclusive-or-expression ˆ and-expression
1 The usual arithmetic conversions are performed; the result is the bitwise
exclusive OR function of the operands. The operator applies only to integral
or unscoped enumeration operands. 
```

**C++11 5.13 按位包含 OR 运算符**

```
inclusive-or-expression:
    exclusive-or-expression
    inclusive-or-expression | exclusive-or-expression
1 The usual arithmetic conversions are performed; the result is the bitwise
inclusive OR function of its operands. The operator applies only to integral
or unscoped enumeration operands. 
```

这些运算符的定义完全让我难以理解。它在标准中的其他地方吗？是否为有符号整数定义了结果实现？

作为一个例子，让我们看一下这段代码：

```
signed char a=-1;
signed char b=3;
signed char c=a&b; 
```

使用 2 的补码，a 是 1111 1111，b 是 0000 0011。最后 c 等于 0000 0011 (+3)。

使用 1 的补码，a 是 1111 1110，b 是 0000 0011。c 等于 0000 0010 (+2) 吗？

使用符号大小，a 是 1000 0001，b 是 0000 0011。c 是否等于 0000 0001 (+1) ？

如果您可以使用 1 的补码或符号幅度访问平台，那么这些平台上的结果是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T14:37:20.527

位运算独立地对每个位进行操作，无论每个位在解释为数字类型的一部分时可能意味着什么。

所以是的，`10000001 & 00000011 == 00000001`不管每个位代表一个符号还是一个值的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:46:43.080

位运算`&` `|` `^`符只是对两个操作数中的每一个上的每个位执行其命名操作，具体实现取决于底层类型的表示。

但是，转移的情况有所不同。

例如，考虑一个单字节二进制补码`-1`= `11111111`。然后你右移一个。现在是您的数字`127`（更改符号）或`-1`（将 1 移到最高位而不是 0）。如果它是符号幅度表示，则同样适用。为了避免所有这些问题，标准只是禁止它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T16:11:00.760

负符号整数的左移和右移按标准处理，以便允许实现使用“算术移位”机器指令。算术右移*复制*`0`符号位，与在左侧插入 s的逻辑右移不同。如果从左侧边缘移出的位与符号位不同，则算术左移可能会在某些体系结构上产生溢出异常。因此，右移是*实现定义*的（因为结果始终有效，但可能因实现而异），而左移是*未定义*的（因为结果可能是中断。）

按位逻辑运算符产生的位模式是完全指定的，但在有符号整数的情况下，结果可能是一个陷阱值（例如在无效`-0`的 1 补码或符号幅度架构上）。`-0`在这种情况下，结果是未定义的行为，根据第 5 节介绍的第 4 段：

> 如果在计算表达式期间，结果未在数学上定义或不在其类型的可表示值范围内，则行为未定义。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-10T14:36:50.737

结果不取决于机器如何表示整数。

```
0 & 0 = 0
0 & 1 = 0
1 & 0 = 0
1 & 1 = 1
0 | 0 = 0
0 | 1 = 1
1 | 0 = 1
1 | 1 = 1
0 ^ 0 = 0
0 ^ 1 = 1
1 ^ 0 = 1
1 ^ 1 = 0 
```

上表显示了一位的值。给定一个 32 位整数，对所有 32 位进行位计算。因此，术语按位。

# bash - 在 bash $RANDOM 中生成随机数总是返回零

> ID：14260211
> 
> 赞同：1
> 
> 时间：2013-01-10T14:31:15.843
> 
> 标签：bash, shell

我试图在 Bash 中生成一个随机数，但看起来 $RANDOM 总是返回零。

我正在使用以下代码

```
#!/bin/sh
#!/bin/bash

testing=$((RANDOM))
echo $testing
VAR=$((RANDOM%200+100))
echo $VAR 
```

结果 ：

```
0
100 
```

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:33:55.673

`#!/bin/sh`从脚本中删除该行。`$RANDOM`在 中工作`bash`，不在`sh`。

# d - 如何使用范围作为函数参数？

> ID：14260213
> 
> 赞同：1
> 
> 时间：2013-01-10T14:31:17.517
> 
> 标签：d

我想使用一个范围作为函数参数，即调用类似：

```
foo(arr,1..23) 
```

在函数中我想做类似的事情

```
int arr[22]
arr[21] = some_other_arr[<range>] 
```

`<range>`来自上面的`1..23`调用。

那可能吗？我该如何申报`foo`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T16:20:55.840

首先，它不是一个范围——它只是只在语句`1..23`内部起作用的特殊语法。`foreach`

与from相同的`1..23`范围；它返回一系列连续值（例如整数）。`iota(1, 23)``std.range`

要将范围传递给函数，通常需要使用模板：

```
void foo(Range)(Range r)
{
    foreach (e; r)
        writeln(e);
} 
```

然后你可以按照你想要的方式调用它：

```
foo(iota(1, 23)); // print the numbers from 1 to 23 (exclusive) 
```

注意：如果`arr`是一个数组，并且您想要索引处的值范围，`1..23`那么您可以使用切片：

```
foo(arr[1..23]); 
```

数组的切片是一个范围。

要让函数接受这一点，您不需要使用模板。`foo`可以写成：

```
void foo(int[] r)
{
    foreach (e; r)
        writeln(e);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T09:00:39.803

数组切片是最强大的范围 - 随机访问范围。那么为什么不简单地使用 slice 来满足您的需要：

```
import std.stdio;
import std.conv;

int main() {
    int[] ina = [0, 1, 22, 11, 5, 9, 3];
    auto arr = ina[2..5];
    writeln(arr); // this is an example of a "function" with range as parameter
    return 0;
}

/*** output:
[22, 11, 5]
****/ 
```

你可以在这里玩弄它：http: [//dpaste.dzfl.pl/95568985](http://dpaste.dzfl.pl/95568985)（fork and run）。坦率地说，我会接受彼得的回答，因为它显示了你需要知道的一切。:)

# asp.net - 枚举，无需实例化即可使用

> ID：14260215
> 
> 赞同：0
> 
> 时间：2013-01-10T14:31:24.267
> 
> 标签：asp.net, vb.net, enums, global

我在一个类中有一个枚举：

```
Public Class objConjuntosDeAvaliacoes    
    Const conjuntoTipoComparacao As String = "cmp"
    Const conjuntoTipoEvolucao As String = "evp"

    Function removeDoConjunto(ByVal ansSerie As Integer, 
                              ByVal ansAvaliacao As Integer) As Integer 
```

我希望这个枚举在所有代码文件中都可用，而不必实例化类。

你是怎样做的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:39:08.713

[`Enum`语句](http://msdn.microsoft.com/en-us/library/8h84wky1%28v=vs.80%29.aspx)和[常量](http://msdn.microsoft.com/en-us/library/cyxe49xw.aspx)：

```
Public Class objConjuntosDeAvaliacoes
    .....  
    'enums
    Public Enum YourEnums
        conjuntoTipoComparacao = 1
        conjuntoTipoEvolucao = 2
    End Enum

    'public constants
    Public Const conjuntoTipoComparacao As String = "cmp"
    Public Const conjuntoTipoEvolucao As String = "evp"
    .....
..... 
```

# android - Android日志/logcat日志不清楚

> ID：14260224
> 
> 赞同：0
> 
> 时间：2013-01-10T14:31:54.077
> 
> 标签：android, logging

我对 IntelijIdea 11.0.2 中显示的日志有问题（可能在其他版本中也是如此，但这是我现在使用的版本；甚至我不知道是否与想法有关）。某些设备（如 Nexus 7 或摩托罗拉 Xoom）上的日志非常不清楚。前任。：

```
 GC_CONCURRENT freed 391K, 7% free 7847K/8388K, paused 3ms+4ms, total 41ms
    [ 01-10 16:29:31.475  9132: 9132 I/Process  ]
    Sending signal. PID: 9132 SIG: 9
    [ 01-10 16:29:31.485   478:  478 I/WindowState ]
    WIN DEATH: Window{41813ca8 u0 asd.ssssge.namespace.test.asa/asd.ssssge.namespace.test.asa.TestActivity}
    [ 01-10 16:29:31.485   478: 6135 I/ActivityManager ]
    Process asd.ssssge.namespace.test.asa (pid 9132) has died.
    [ 01-10 16:29:31.505   478:  802 W/InputMethodManagerService ]
    Got RemoteException sending setActive(false) notification to pid 9132 uid 10073
    [ 01-10 16:29:31.885  7863: 7867 D/dalvikvm ]
    GC_CONCURRENT freed 389K, 7% free 7844K/8384K, paused 2ms+2ms, total 18ms
    [ 01-10 16:29:32.595  7863: 7863 D/MessageManager ]
    Queueing message Intent { (has extras) } on channel 0
    [ 01-10 16:29:32.595  7863: 7885 D/MessageManager ]
    Attempting to dispatch message { what=0 when=-1ms obj=com.example.testapp$Message@414d70b8 }
    [ 01-10 16:29:32.595   478:  847 W/InputMethodManagerService ]
    Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@417f1c18 attribute=null, token = android.os.BinderProxy@4187c2a0 
```

有没有人遇到过这个问题并知道如何解决？

在 SDK 管理器中几乎所有都是最新的。

我注意到的另一件事是，如果我打开了 2 个 IntelijIdea 实例，我只能在第一个打开的实例中看到日志......

# file-upload - 使用 PrettyFaces 调用 FileUploadListener 时重建 ViewScoped bean

> ID：14260225
> 
> 赞同：4
> 
> 时间：2013-01-10T14:32:00.793
> 
> 标签：file-upload, jsf-2, primefaces, prettyfaces

我已将一个`<p:fileUpload />`组件插入到我的**JSF 2.1.5**应用程序中。我正在使用**PrimeFaces 3.4.1**。该组件由`@ViewScoped`bean 支持。我的表格是这样的：

```
<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:c="http://java.sun.com/jsp/jstl/core"
xmlns:p="http://primefaces.org/ui"
template="/templates/general_template.xhtml">

<ui:define name="metadata">
    <f:metadata>

        <f:viewParam id="NavIndex" name="NavIndex"
            value="#{navegableMassiveUserAdd._QueueIndex}" />
        <f:event type="preRenderView"
            listener="#{navegableMassiveUserAdd.initialize}" />
    </f:metadata>
</ui:define>

<ui:define name="general_content">
    <h:form>

        <p:fileUpload
            fileUploadListener="#{navegableMassiveUserAdd.listener}"
            mode="advanced" allowTypes="/(\.|\/)(xls|csv)$/"
            label="#{msg.SELECT}" multiple="false" />

        <p:commandButton id="cancelButton"
            action="#{navegableMassiveUserAdd.actionCancelAdd}"
            value="#{msg.CANCELAR}" ajax="false" style="margin: 9px 0px 5px;" />
    </h:form>
</ui:define> 
```

这是我的主要模板：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:c="http://java.sun.com/jsp/jstl/core"
xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui">

<h:head>
    <meta http-equiv="Pragma" CONTENT="no-cache"></meta>
    <meta http-equiv="cache-control" content="no-cache"></meta>
    <meta http-equiv="Expires" CONTENT="-1"></meta>
    <meta http-equiv="Content-Type"
        content="text/html; charset=ISO-8859-15" />
    <h:outputStylesheet library="css" name="prime_styles.css" />
    <h:outputScript library="js" name="prime_translations.js" />
</h:head>

<h:body>
    <ui:insert name="metadata" />
    <ui:insert name="general_logged_user">
        <div align="right">
            <span style="color: #B22222; padding: 3px;"> <h:outputText
                    value="#{loggedBean._Login}" />
            </span> <span style="color: #FFA54F; padding: 3px;"> <h:outputText
                    value="Auth Method: #{loggedBean._Usuario._CUser._AuthenticationMethod}" />
            </span>
        </div>
    </ui:insert>
    <f:view locale="#{localeBean.locale}">
        <ui:insert name="general_settings">
            <f:loadBundle basename="resources.system.bundles.Messages" var="msg" />
            <p:ajaxStatus style="width:0px;height:0px;" id="ajaxStatusPanel"
                styleClass="spinner_ajax_loading">

                <f:facet name="start">
                    <h:graphicImage value="/resources/images/loading.gif" />
                </f:facet>

                <f:facet name="complete">
                    <h:outputText value="" />
                </f:facet>
            </p:ajaxStatus>
            <p:growl id="messages" autoUpdate="true" />
        </ui:insert>

        <f:event type="preRenderView"
            listener="#{navigationManagerSystem.initialize}" />

        <h:panelGroup>
            <ui:insert name="general_header">
                <ui:include src="/components/header.xhtml" />
            </ui:insert>
            <h:panelGroup id="menuNavegacionPanel">

                <h:form>
                    <h:panelGroup id="navigationPanel"
                        rendered="#{navigationManagerSystem._ShowNavegacion}">
                        <h:panelGroup
                            rendered="#{!navigationManager._DisableNavigationButtons}">
                            <p:toolbar>
                                <p:toolbarGroup>
                                    <ui:repeat value="#{navigationManagerSystem._Navegables}"
                                        var="item">
                                        <p:button value="#{item._Title}"
                                            outcome="#{item._NavigationResult}">
                                            <f:param name="NavIndex" value="#{item._QueueIndex}" />
                                        </p:button>
                                    </ui:repeat>
                                    <p:button disabled="true"
                                        value="#{navigationManagerSystem._Navegable._Title}" />
                                </p:toolbarGroup>
                            </p:toolbar>
                        </h:panelGroup>

                    </h:panelGroup>
                </h:form>
            </h:panelGroup>
            <ui:insert name="general_content">
                <ui:include src="/system/content.xhtml" />
            </ui:insert>

        </h:panelGroup>
        <ui:insert name="general_footer">

            <ui:include src="/components/general_footer.xhtml" />

        </ui:insert>
    </f:view>

</h:body> 
```

有了这个，当我上传我的文件时，bean 正在重建并且`listener`方法没有被调用。我的过滤器放在了我的*web.xml*中。此外，如果我更改表单并将其设置为`enctype="multipart/form-data"`，正如我在文档中阅读的那样，我无法避免问题并且再次重建 bean，在这种情况下，即使我单击取消按钮也是如此。那是我的 bean 代码，`SystemNavegable`抽象类在哪里：

```
@SuppressWarnings("serial")
@ManagedBean
@ViewScoped
public class NavegableMassiveUserAdd extends SystemNavegable {

/**
 * Field logger.
 */
protected final Log logger = LogFactory.getLog(this.getClass());

/**
 * Constructor for NavegableMassiveUserAdd.
 */
public NavegableMassiveUserAdd() {
    super();
    this.set_Title(FacesUtils.getBundle(BundleNames.BUNDLE_SYSTEM_MENU,
            BundleKeys.SYSTEM_NAVEGABLE_ADD_USERS, "Añadir usuarios"));
    this.set_TitleDescription(FacesUtils.getBundle(BundleNames.BUNDLE_SYSTEM_MENU,
            BundleKeys.SYSTEM_NAVEGABLE_ADD_USERS_DESCRIPTION, "Añadir usuarios"));
    this.set_NavigationResult(NavigationResults.MASSIVE_USER_ADD);
    this._Behaviour = NavegableBehaviour.ADD;
}
/**
 * Method actionCancelAdd.
 * 
 * @return
 */
public String actionCancelAdd() {
    return this._NavigationManagerSystem.cancelNavegable();
}

/**
 * Escuchador del evento Upload.
 * 
 * 
 * 
 * @param event
 *            FileUploadEvent
 * @throws IOException
 * @throws java.io.IOException
 */
public void listener(FileUploadEvent event) throws IOException {
    UploadedFile uploadItem = event.getFile();
    //More code
    } 
```

有什么建议吗？提前致谢。

**已编辑**

完成了更多测试，我发现文件上传侦听器方法永远不会到达，我给支持 bean 的 Scope 无关紧要。我有以下依赖项：

```
<dependency>
        <groupId>commons-fileupload</groupId>
        <artifactId>commons-fileupload</artifactId>
        <version>1.2.1</version>
    </dependency>
    <dependency>
        <groupId>commons-io</groupId>
        <artifactId>commons-io</artifactId>
        <version>1.3.2</version>
    </dependency> 
```

而且我怀疑问题可能是另一个过滤器与我为上传组件使用的过滤器冲突，[如此处](https://stackoverflow.com/a/4390313/1199132)所述。`FacesContext.getCurrentInstance().isPostback()`不管问题是什么，当文件上传并带有 false时，我的 bean 的初始化方法会再次被调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T16:44:40.500

经过几次头脑风暴，我发现这是一个过滤器问题。由于上传过滤器与[PrettyFaces](http://ocpsoft.org/prettyfaces/)过滤器冲突，我不得不将其添加到我的*web.xml*中：

```
<filter-mapping>
   <filter-name>PrimeFaces FileUpload Filter</filter-name>
   <servlet-name>Faces Servlet</servlet-name>
   <dispatcher>FORWARD</dispatcher>
</filter-mapping> 
```

非常感谢@Reinaldo de Carvalho 的回复

[https://stackoverflow.com/a/9086137/1199132](https://stackoverflow.com/a/9086137/1199132)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-22T18:54:31.603

就我而言，问题在于 Tomcat 服务器 POST 大小限制。因此，在 server.xml 中的 Connector 部分的参数 maxPostSize 被设置后，文件上传开始与 @ViewScoped bean 一起工作。

另请注意，tomcat 官方文档是不正确的，对于无限大小的 POST，maxPostSize 值必须设置为小于 0，因为当它等于 0 时表示大小为零。

[http://tomcat.apache.org/tomcat-7.0-doc/config/ajp.html](http://tomcat.apache.org/tomcat-7.0-doc/config/ajp.html) [HttpRequest在tomcat中的最大允许大小？](https://stackoverflow.com/questions/2947683/httprequest-maximum-allowable-size-in-tomcat)

# image - 图片 ad.jpg 不会在浏览器中显示：防病毒问题？

> ID：14260231
> 
> 赞同：0
> 
> 时间：2013-01-10T14:32:22.970
> 
> 标签：image, browser, hidden, antivirus

我在玩在线纸牌游戏时遇到了一个奇怪的问题：

在 2012 年玩的 200 万场游戏中，有两个用户抱怨他们永远看不到名为“ad.jpg”的钻石王牌。无论使用何种浏览器（IE、Firefox、Chrome ......）都会发生这种情况，我怀疑它与图片名称有关。

如果我将其重命名为 da.jpg 它会显示。但是我不能轻易地重命名它，因为所有录制的游戏都使用 ad.jpg。

任何线索将不胜感激:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T09:38:04.667

我怀疑不是防病毒软件，而是可能是某种简单的广告拦截软件（代理/插件），它会阻止包含“广告”（广告）的图像。

我建议复制图像，并为新游戏使用新名称，并为旧游戏保留 ad.jpg。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T14:06:36.583

终于找到问题了：

卡巴斯基与报告问题的两个用户一起使用。根据其中一位用户的说法，解决方案如下：

卡巴斯基的一种选择称为“反横幅”。用卡巴斯基实验室人员的话来说，“此功能会阻止您的网络浏览器和某些应用程序中的广告和横幅。” 我发现在我的 Compaq/HP 计算机上启用了此功能（钻石 A 不可见的那台），但在其他两台上却没有。

因此，我在 Compaq/HP 上关闭了此功能，瞧：钻石王牌变得可见，就像我感兴趣的其他各种以前不可见的文件一样（但其名称包含字母“ad”或“ads "，其中 "a" 是第一个字符或紧跟斜线的字符。）

我随后在 Compaq/HP 上再次打开了反横幅功能，打算重现问题，以便我可以进一步调查并准确确定导致问题的因素组合。然而，“不可见的钻石王牌”问题并没有再次出现——现在一切正常——因此我对上面概述的这个问题的原因只有模糊的概念。

# c# - 在 C++ 中以高精度测量时间

> ID：14260238
> 
> 赞同：4
> 
> 时间：2013-01-10T14:32:34.820
> 
> 标签：c#, c++, visual-studio-2010

如何在 C++ 中像在 C# 中一样准确地测量某些东西？

这是我的 C# 代码

```
var elapsedMilliseconds = (double)(sw.ElapsedTicks * 1000L) / Stopwatch.Frequency; 
```

我正在使用视觉工作室 2010。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-10T14:35:15.590

C# 中的 Stopwatch 类基于以下两个 Win32 API 调用，您可以从 C/C++ 调用它们：

*   [查询性能计数器](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644905%28v=vs.85%29.aspx)
*   [查询性能频率](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644905%28v=vs.85%29.aspx)

调用第一个函数并将其除以第二个函数以获得以秒为单位的值。

例子：

```
LARGE_INTEGER freq, start, end;
QueryPerformanceFrequency(&freq);
QueryPerformanceCounter(&start);
// do some long operation here
Sleep(5000);
QueryPerformanceCounter(&end);
// subtract before dividing to improve precision
double durationInSeconds = static_cast<double>(end.QuadPart - start.QuadPart) / freq.QuadPart; 
```

请注意，文档中的以下注释是真实的，应予以考虑。我个人在 VirtualBox 虚拟机中观察到了这种行为。不同处理器之间可能存在几十毫秒的差异，导致出现负持续时间和超过预期持续时间等意外结果：

> 在多处理器计算机上，调用哪个处理器并不重要。但是，由于基本输入/输出系统 (BIOS) 或硬件抽象层 (HAL) 中的错误，您可能会在不同的处理器上获得不同的结果。要指定线程的处理器亲和性，请使用 SetThreadAffinityMask 函数。

您可能对此感兴趣以了解更多信息：[System.Diagnostics.Stopwatch 在 Elapsed... 属性中返回负数](https://stackoverflow.com/questions/1008345/system-diagnostics-stopwatch-returns-negative-numbers-in-elapsed-properties)

请注意，如果上述两个 API 不可用或返回失败代码，则 Stopwatch 类将使用 GetTickCount。这可能只是为了保持与 Windows 9x 的兼容性；我自己在现代 PC 上使用这些 API 并没有遇到任何问题。但是，GetTickCount 不会有您想要的精度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T13:17:58.420

我需要更具体的测量并找到了一个。谢谢其他答案。他们都很好。有了这个答案，如果需要，我可以轻松切换到微秒。

当然，我会接受詹姆斯约翰斯顿的答案作为正确的答案，因为有很好的解释和人们的反馈。

谢谢大家

```
int main(int argc, char ** argv)
{
unsigned long long nFreq = GetPerformanceTicksInSecond();
unsigned long long nBefore = GetPerformanceTicks();
timer start1 = timer::start();

CallSomeFunction();

unsigned long long nAfter = GetPerformanceTicks();
const unsigned long long nDiff = nAfter - nBefore;
const unsigned long long nMicroseconds = GetTickMicroseconds(nDiff,nFreq);

cout << "CallSomeFunction() took " << nMicroseconds << " " << time << endl;

return 0;

}

unsigned long long GetPerformanceTicks()
{
    LARGE_INTEGER nValue;

    ::QueryPerformanceCounter(&nValue);

    return nValue.QuadPart;
}

unsigned long long GetPerformanceTicksInSecond()
{
    LARGE_INTEGER nFreq;

    ::QueryPerformanceFrequency(&nFreq);

    return nFreq.QuadPart;
}

double GetTickSeconds(unsigned long long nTicks,unsigned long long nFreq)
{
    return static_cast<double>(nTicks) / static_cast<double>(nFreq);
}

unsigned long long GetTickMilliseconds(unsigned long long nTicks,unsigned long long nFreq)
{
    unsigned long long nTicksInMillisecond = nFreq / 1000;

    return nTicks / nTicksInMillisecond;
}

unsigned long long GetTickMicroseconds(unsigned long long nTicks,unsigned long long nFreq)
{
    unsigned long long nTicksInMicrosecond = nFreq / 1000000;

    return nTicks / nTicksInMicrosecond;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:38:13.230

检查这个：[如何在 C++ 中获取系统时间？](https://stackoverflow.com/questions/599321/how-to-get-system-time-in-c)

您也可以使用 GetTickCount，它： *检索自系统启动以来经过的毫秒数，最多 49.7 天。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T14:38:44.503

使用 QueryPerformanceFrequency 和 QueryPerformanceCounter API 函数。

```
LARGE_INTEGER freq;
::QueryPerformanceFrequency(&freq);

LARGE_INTEGER start, end;
::QueryPerformanceCounter(&start);
// do some work
::QueryPerformanceCounter(&end);

double const t = double(end.QuadPart - start.QuadPart) / double(freq.QuadPart); 
```

为了提高准确性，您可能需要从结果中减去调用 QueryPerformanceCounter 所需的时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T14:38:50.680

秒表类是 QueryPerformanceCounter 的包装器：

```
uint64_t startTime, endTime;
uint64_t frequency;
QueryPerformanceFrequency((LARGE_INTEGER*)&frequency);
QueryPerformanceCounter((LARGE_INTEGER*)&startTime);
//DoStuff
QueryPerformanceCounter((LARGE_INTEGER*)&endTime);
double seconds = (endTime-startTime)/(double) frequency; 
```

# emacs - 组织模式时钟表和图表

> ID：14260244
> 
> 赞同：12
> 
> 时间：2013-01-10T14:32:50.427
> 
> 标签：emacs, org-mode

有没有办法为`org-mode`（记录工作）生成一个二维表，其中行是任务，列是一周/月的连续几天或连续几周，单元格是时间；或相应的图表？

我只知道`rangereport`来自[http://sachchua.com/blog/2007/12/clocking-time-with-emacs-org/的 hacky](http://sachachua.com/blog/2007/12/clocking-time-with-emacs-org/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-18T14:18:23.823

我无法完全理解您需要什么样的表格，但您可以`org-agenda-clockreport-mode`在议程缓冲区上按 Shift+R ( ) 来查看一个表格，其中包含根据项目排序的行中的任务以及花费了多少时间。您可以通过更改议程的时间段并重建议程来更改表格的范围。

![在此处输入图像描述](../Images/5d3e12476db9197769321bfc59d0a9ad.png)

您还可以在 org 文件本身中使用`C-c C-x C-d`或`org-agenda-columns`来获得任务方面的概述。

![在此处输入图像描述](../Images/8a865f071e2b9a21b68491a0cf2b77fc.png)

希望这可以帮助！

# python - Pandas load_table 字符串到元组的转换

> ID：14260251
> 
> 赞同：2
> 
> 时间：2013-01-10T14:33:24.497
> 
> 标签：python, tuples, pandas

我在数据文件中使用了很多元组作为记录键。当我从文本加载表格时，元组是数据框中的字符串。

我现在转换为元组，使用：

```
df['KEY'] = df['KEY'].map(lambda x: eval(x)) 
```

是否可以自动获得字符串评估？

卢克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T16:39:05.707

你可以用它`converters={'KEY': eval}`来让事情变得更简单。也可以在内部添加一些更优化的版本。

# ant - Ant + 如果文件存在则运行目标

> ID：14260255
> 
> 赞同：0
> 
> 时间：2013-01-10T14:33:39.340
> 
> 标签：ant

仅当某个位置中存在 java 文件时，我才需要运行另一个任务。我已经搜索过相同的内容，并遇到了如下内容：

```
<target name="check-abc">
<available file="abc.txt" property="abc.present"/> 
```

`</target>`

`<target name="do-if-abc" depends="check-abc" if="abc.present">` ... `</target>`

但是在我的情况下，文件路径不固定。我有一个包含许多子目录和文件的目录。如果这些位置中的任何一个都存在 java 文件，则该属性应设置并运行第二个目标。请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T16:03:14.783

好的，我为此制定了一个解决方案，但是您将需要[ant-contrib](http://ant-contrib.sourceforge.net/)才能使其工作。

```
<target name="check-abc" depends="defineAntContribTasks">
    <path id="foo">
        <fileset dir="${src.dir}">
            <include name="**/*.java"/>
        </fileset>
    </path>
    <for param="some.file">
        <path refid="foo"/>
        <sequential>
            <echo message="checking @{some.file}"/>
            <property name="abc.present" value="true"/>
        </sequential>
    </for>
    <echo message="present = ${abc.present}"/>
</target>

<target name="do-if-abc" depends="check-abc" if="abc.present">
    <!-- whatever -->
</target> 
```

您可能可以放弃 echo 语句；它们主要是为了让您可以看到正在检查的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T23:59:57.570

我的示例使用[自定义脚本条件](http://ant.apache.org/manual/Tasks/conditions.html)，在 groovy 中实现。

```
<project name="build" default="build">

    <path id="build.path">
        <pathelement location="lib/groovy-all-2.1.0-rc-1.jar"/>
    </path>

    <condition property="java.found">
        <scriptcondition language="groovy" value="false" classpathref="build.path">
            def ant = new AntBuilder()

            ant.fileset(id:"javaFiles", dir:"src", includes:"**/*.java")

            ant.project.references.javaFiles.each {
                self.value = true
            }
        </scriptcondition>
    </condition>

    <target name="build" if="java.found">
        <echo message="Found java files"/>
    </target>

</project> 
```

或者，您可以编写自定义 java 条件，这样就无需在构建中嵌入脚本语言。

*   [自定义条件](http://ant.apache.org/manual/Types/custom-programming.html#customconditions)
*   可以从 Maven 中心获得[groovy-all](http://search.maven.org/#artifactdetails%7Corg.codehaus.groovy%7Cgroovy-all%7C2.1.0-rc-1%7Cjar) jar 。您可以使用[ivy](http://ant.apache.org/ivy/)在运行时下载它。

# rest - 如何将 Amazon S3 存储桶设置为仅 IAM 用户可以访问？

> ID：14260256
> 
> 赞同：-1
> 
> 时间：2013-01-10T14:33:52.437
> 
> 标签：rest, amazon-s3, amazon, policy

我有一堆文件想放在 S3 上，这样对它们的访问仅限于特定的 IAM 用户。我尝试将策略与用户和存储桶相关联，并尝试使用 s3-cmd 访问存储桶中的文件。但是，我在响应中不断收到拒绝访问 xml（403 禁止）。我的政策如下所示：

```
{
    "Version": "2008-10-17",
    "Statement": [
        {
        "Sid": "<a statementID>",
        "Effect": "Allow",
        "Principal": {
            "AWS": "arn:aws:iam::<my-account-num>:user/<username>"
        },
        "Action": "s3:*",
        "Resource": [
            "arn:aws:s3:::<bucket-name>/*",
            "arn:aws:s3:::<bucket>"
            ]
         }
    ]
} 
```

只有当我将主体设置为“AWS”：“*”时，我才能通过 REST 调用下载资源。

有问题的用户附加了“高级用户”政策：

```
{
  "Statement": [
   {
      "Effect": "Allow",
      "NotAction": "iam:*",
      "Resource": "*"
   }
 ] 
```

}

如何使用 S3 存储桶进行仅限私有访问？请帮忙。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-01-16T14:30:37.317

问题不在于策略，而在于访问它的机器。我试图从 EC2 实例中对 S3 资源进行检索操作。今天我发现可以让每个 EC2 实例“承担”一个 IAM 角色。当实例这样做时，它会继承为该角色指定的权限。因此，只需使用以下策略创建角色：

```
{
  "Statement": [
    {
     "Effect": "Allow",
     "Action": "s3:*",
     "Resource": "*"
    }
   ]
} 
```

并使 EC2 实例承担此角色允许它与 S3 存储桶进行通信。

# apache - 如何限制人们进入服务器上的目录

> ID：14260259
> 
> 赞同：0
> 
> 时间：2013-01-10T14:33:57.443
> 
> 标签：apache

一个简单的谷歌搜索可以在服务器上显示很多。ex“父目录的索引”

1.  如何避免人们进入服务器目录。前链接 59.181.118.41/files/headfirst/

2.  有时当我尝试浏览此类目录时，我会收到 403 错误，说禁止或访问被拒绝。但是如果输入了可以使用google显示的url，仍然可以访问访问文件。前任。文件类型：pdf 网站：链接

ps 我对 apache 和 web 服务器不熟悉，所以请解释一下，这些东西是如何工作的以及为什么会发生这种情况

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:35:18.123

最好的方法是首先不要将目录放在 webroot 下。

webroot 是您放置要通过 HTTP 提供服务的地方。如果您从不希望它通过 HTTP 提供服务，请不要将其放在那里。

* * *

或者，[拒绝](http://httpd.apache.org/docs/2.4/mod/mod_access_compat.html)所有人。

* * *

另一种选择是设置文件系统的权限，以便不允许 Web 服务器用户读取文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:48:37.747

正如昆汀所说，不要把目录放在那里。为了扩展他对拒绝部分的回答，请将以下内容添加到您的主机条目中。

```
<Directory /my/directory/here>
    Order deny,allow
    Deny from all
</Directory> 
```

目录名称区分大小写，应该是绝对路径。您可以根据需要添加任意数量的这些，它们也将覆盖它下面的所有子目录。

还会在[此处](http://httpd.apache.org/docs/2.2/howto/access.html)阅读 apache 允许的访问控制。

# javascript - 一次对 div 进行排序和编辑问题

> ID：14260261
> 
> 赞同：0
> 
> 时间：2013-01-10T14:34:06.523
> 
> 标签：javascript, jquery, html

我的脚本中有一个问题是，当我对 div 使用可排序时，输入文本框不可编辑。

拖放后，我的代码中有拖放功能，div 必须是可排序的，输入必须是可编辑的以供进一步使用。我希望这两个功能在我使用以下方法时同时运行，但它不起作用

这是我的代码

```
$(".workArea").sortable();
$('.workArea').sortable({handle: 'div'}).disableSelection();
$(".workArea").sortable("option", "appendTo", 'body' );
$(".workArea").sortable("option", "cancel", ':input'); 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:38:47.787

```
$('.workArea').sortable({handle: 'div'});
$('.workArea div').disableSelection(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:23:52.980

$('.workArea').sortable()

TRy above code

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T15:36:18.303

尝试这个：

```
 $(".workArea").sortable("option", "cancel", ':input','.contenteditable'); 
```

或者

```
 $(".workArea").sortable({cancel: ':input,button,.contenteditable'}); 
```

两者都像魅力一样！

# javascript - 什么时候在 HTML 表单中应用新样式

> ID：14260264
> 
> 赞同：2
> 
> 时间：2013-01-10T14:34:15.727
> 
> 标签：javascript, html, css

浏览器引擎在这种情况下如何工作非常有趣，因为我在 IE、Firefox 和 Chrome 中对其进行了测试，它们的工作方式都不同。例如：

```
<style>
.parent{
width:100px;
}
.expand{
width:200px;
}
</style>

<div class="parent">
<div class="child"></div>
</div>

<input type="button" id="btn" />

<script>
//onready
$('#btn').click(function(){
$('.parent').toggleClass('expand');
alert($('.child').width());
});
</script> 
```

问题出在铬上。我不知道为什么，但是 ('.child').width() 总是旧值，而不是他父母的新宽度。何时以及如何重新计算宽度？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T14:37:13.537

> 何时以及如何重新计算宽度？

正如您所发现的，它可能依赖于浏览器。

如果您通过释放 JavaScript 线程给浏览器一点时间来完成它的工作，您会看到新值：

```
$('#btn').click(function(){
    $('.parent').toggleClass('expand');
    setTimeout(function() {
        alert($('.child').width());
    }, 0);
}); 
```

[实例](http://jsbin.com/igofub/2)| [来源](http://jsbin.com/igofub/2/edit) *（另请参阅下面的注释）*

当然，延迟不会真正为 0 毫秒，但确实会非常短暂。

* * *

另外，这条线

```
$('parent').toggleClass('expand'); 
```

应该

```
$('.parent').toggleClass('expand'); 
```

（注意前导`.`）

...我应该注意，对我来说，在 Chrome for Linux 上，它可以在没有超时的情况下工作：[示例](http://jsbin.com/igofub/1)| [资源](http://jsbin.com/igofub/1/edit)

# c# - C# 按字母和长度对 Arraylist 字符串进行排序

> ID：14260271
> 
> 赞同：4
> 
> 时间：2013-01-10T14:34:38.707
> 
> 标签：c#, string, sorting, arraylist

我正在尝试对`ArrayList`of进行排序`String`。

鉴于：

```
{A,C,AA,B,CC,BB} 
```

`Arraylist.Sort`给出：

```
{A,AA,B,BB,C,CC} 
```

我需要的是：

```
{A,B,C,AA,BB,CC} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-10T14:37:22.553

```
ArrayList list = new ArrayList {"A","C","AA","B","CC","BB"};

var sorted = list.Cast<string>()
                 .OrderBy(str => str.Length)
                 .ThenBy(str => str);

//LinqPad specific print call
sorted.Dump(); 
```

印刷：

```
A 
B 
C 
AA 
BB 
CC 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T14:37:56.127

使用 Linq 更容易做到这一点：

```
string [] list = { "A","C","AA","B","CC","BB"};

var sorted = list.OrderBy(x=>x.Length).ThenBy(x=>x); 
```

请注意，该`OrderBy`方法返回一个新列表。如果要修改原始文件，则需要重新分配它：

```
list = list.OrderBy(x=>x.Length).ThenBy(x=>x).ToArray(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:41:23.837

我建议使用该`ToArray()`方法（或仅使用`List<string>`ArrayList 的 instad）来利用`OrderBy`and`ThenBy`函数。它看起来像这样：

```
list = list.OrderBy(/*Order it by length*/).ThenBy(/*Order alphabetically*/); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T14:42:06.397

您可以创建一个`IComparable`接收两个字符串的类，并按如下方式对它们进行排序：

```
if (a.Length == b.Length)
    return String.Compare(a, b);
return a.Length.CompareTo(b.Length); 
```

您可能还想处理`null`案件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T14:52:29.503

这是一种老派，但是，我去了 IComparer Interface 。. .

```
public class SortAlphabetLength : System.Collections.IComparer
{
    public int Compare(Object x, Object y)
    {
        if (x.ToString().Length == y.ToString().Length)
            return string.Compare(x.ToString(), y.ToString());
        else if (x.ToString().Length > y.ToString().Length)
            return 1;
        else
            return -1;
    }
} 
```

然后测试它。. .

```
class Program
{
    static void Main(string[] args)
    {
        ArrayList values = new ArrayList()
        {
            "A","AA","B","BB","C","CC"
        };

        SortAlphabetLength alphaLen = new SortAlphabetLength();
        values.Sort(alphaLen);

        foreach (string itm in values)
            Console.WriteLine(itm);
    }
} 
```

输出：

```
A
B
C
AA
BB
CC 
```

# extjs - Ext.dd.DragZone 用于网格（多个项目） GetDragData

> ID：14260272
> 
> 赞同：2
> 
> 时间：2013-01-10T14:34:41.473
> 
> 标签：extjs, extjs4, extjs4.1

我不知道是否有人可以帮助我解决这个问题。我一直在尝试整个下午，但我无法做到正确。

我`DragZone`为网格定义了一个...

```
 Ext.define('Timetabling.view.ItStudentsDragZone', {

        extend    : 'Ext.dd.DragZone',

        grid    : null,

   //Tell Ext how to recover from an invalid drop. XY from the dragged data
   getRepairXY: function() {
      return this.dragData.repairXY;
   },

   // To pair together a drag zone and drop zone
   ddGroup     : 'itstudents',        

   getDragData : function(e) {            
   var sourceEl    = e.getTarget(),
           view  = this.grid.getView(),
           rowEl = view.findItemByChild(sourceEl),
           rec  = rowEl && view.getRecord(rowEl);

           if (sourceEl) {
                d = sourceEl.cloneNode(true);
                d.id = Ext.id();

               return {
                ddel: d,
                sourceEl: sourceEl,
                repairXY: Ext.fly(sourceEl).getXY(),
                sourceStore: null,
                draggedRecord: null
             }
        }                                   
      }
   }); 
```

如果我从网格中只选择一项，它工作正常。但是，当我选择两个或更多项目，然后单击网格选择来拖动它时，在网格选择中单击的项目被选中，而另一个保持未选中状态，所以我可以再次拖动一个项目！

我想我必须将网格选择作为一个元素，但我不知道该怎么做......

如果有人对如何解决这个问题有一些想法，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T22:27:14.220

看看[这里的 extjs 4.1 示例](http://docs.sencha.com/ext-js/4-1/#!/example/dd/dnd_grid_to_grid.html)

# algorithm - 通过仅将元素移动到开头或结尾来对数组进行排序

> ID：14260273
> 
> 赞同：1
> 
> 时间：2013-01-10T14:34:44.387
> 
> 标签：algorithm, sorting

我正在尝试解决一个难题，但恐怕我遇到了障碍——我不知道如何解决它。我想也许这里有人偶然发现了类似的东西，如果没有，我相信那些喜欢制作算法的人会喜欢尝试找到解决方案：

我们得到一个未排序的数组。我们可以进行以下两种移动之一：从数组中取出任何元素并将其移动到数组的开头或结尾。我们还得到了数组最终应该是什么样子。我们应该用最少的步数对数组进行排序。

例子：

```
 5 1 4 3 2 - > starting array
 3 1 2 5 4 - > target array

 Steps: move 5 to the end 1 4 3 2 5 
 move 3 to the beginning  3 1 4 2 5
 move 4 to the end  3 1 2 5 4 
```

已达到目标数组，最小步数为 3。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T14:42:24.717

我相信诀窍是找到两个数组之间的最长公共子序列（您可以在 O(n^2) 时间内找到它。这将为您提供最大可能的*不必*移动的数字集，反之，必须移动的最小可能数字集。一旦你有了必须移动的数字集，弄清楚如何移动它们应该是相当简单的。

在您的示例中：

(5, 1, 4, 3, 2) 和 (3, 1, 2, 5, 4) 之间的最长公共子序列是 (1, 4), (1, 2), (3, 2) 或 (5 , 4). 每个子序列都告诉您最小移动数是 3（尽管您选择的移动对于每个子序列都会不同，显然）。

**编辑**

我认为这基本上是正确的答案（沃恩有一些变化）。

首先，我们像往常一样为最长公共子序列问题构建我们的子序列长度数组（M[i][j] = 以 source[i] 和 target[j] 结尾的最长公共子序列的长度）。

然后，我们不是选择解决方案，而是枚举所有可能的最长公共子序列。

然后我们为每个子序列分配一个分数，这是目标序列中最长的连续块的长度。

在示例中，我们得到：

(1, 2) - 得分 2 (1, 4) - 得分 1 (3, 2) - 得分 1 (5, 4) - 得分 2

我们选择任何得分最高的序列，并生成适当的移动指令以在该序列之前或之后移动剩余的数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T18:54:49.773

您可以使用 A* / IDA* 搜索算法来做到这一点。您已经有了“开始”和“目标”，启发式函数可以是有序子数组的数量。新节点的创建是元素到开始/结束的过渡......让算法发挥作用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T22:50:44.687

如果您遵循@High Performance Mark 的建议，您可以取消排名机制。对于您的阵列，重新标记将是 (4, 2, 5, 1, 3)。在此，LCS 是 (4, 5) 和 (2,3)。因此，您可以直接从其中任何一个开始并移动中间的那些：

对于 4,5：按降序查看小于 4 的并将它们移到前面。然后对于大于 5 的按升序排列

*   4, 2, 5, 1, 3 (开始) --> 3
*   3, 4, 2, 5, 1 --> 2
*   2, 3, 4, 5, 1 --> 1
*   1、2、3、4、5（完）

对于 2,3：按降序查看小于 2 的并将它们移到前面。然后对于大于 3 的按升序排列

*   4, 2, 5, 1, 3 (开始) --> 1
*   1, 4, 2, 5, 3 --> 4
*   1, 2, 5, 3, 4 --> 5
*   1, 2, 3\. 4, 5 (完)

每个都有三个动作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T15:03:14.857

如果 O(n^2) 解决方案足够好，则有一个非常简单的算法。

进行 n 次迭代，其中 n 是数组的长度。在迭代 i 中，在元素 i 到 n 中找到在目标排列中具有最高位置的元素，并将其移动到数组的开头。

迭代 1 将应该最后的元素移动到开始。迭代 2 将应该在倒数第二个的元素移动到紧接在它之前的元素。...迭代 n 将最后一个元素（应该是第一个元素）移动到数组的开头。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-13T22:57:28.747

我确实同意 ArunMK，但他的描述相当缺乏。因此，我建议在 C 中实现。

```
#include <stdio.h>
int start[] = { 5, 1, 4, 3, 2 };
int target[] = { 3, 1, 2, 5, 4 };
const int length = sizeof(start) / sizeof(*start);
int canon[length];

void dump_canon()
{
  int i;
  for (i = 0; i < length; i++)
    printf("%d ", target[canon[i]]);
  printf("\n");
}

int main()
{
  int i, j, k;

  /* First "relabel" the array so that the problems becomes: sort the array. */
  for (i = 0; i < length; i++) {
    for (k = 0; start[i] != target[k]; k++)
      /* NO-OP */;
    canon[i] = k;
  }
  printf("Start ");
  dump_canon();
  /* Search for the longuest ascending sequence without holes */
  int longuest_start;
  int longuest_length = 0;
  for (i = 0; i < length; i++) { /* Use i + longuest_length < length for optimisation */
    k = 1;
    for (j = i + 1; j < length; j++) { /* condition can be optimized */
      if (canon[i] + k == canon[j])
        k++;
    }
    if (k >= longuest_length) {
      longuest_start = canon[i];
      longuest_length = k;
    }
  }

  /* Now longuest_start has longuest_length ordered values */
  /* Increase this ordered values stride by picking a number to put just before or after it */
  while (longuest_length < length) {
    for (i = 0; i < length; i++) {
      if (canon[i] + 1 == longuest_start) {
        k = canon[i];
        for (j = i; j > 0; j--)
          canon[j] = canon[j - 1];
        canon[0] = k;
        longuest_start--;
        longuest_length++;
        printf("Take %d and move it to the beginning: ", target[k]);
        dump_canon();
      }     
      else if (canon[i] == longuest_start + longuest_length) {
        k = canon[i];
        for (j = i; j < length - 1; j++)
          canon[j] = canon[j + 1];
        canon[length - 1] = k;
        longuest_length++;
        /* XXX We just shifted a new value here, redo this index */
        i--;
        printf("Take %d and move it to the end: ", target[k]);
        dump_canon();
      }
    }
  }
} 
```

输出是：

```
Start 5 1 4 3 2 
Take 5 and move it to the end: 1 4 3 2 5 
Take 4 and move it to the end: 1 3 2 5 4 
Take 3 and move it to the beginning: 3 1 2 5 4 
```

# wpf - MyClass.xaml 中的部分类无法被 MyClass.xaml.cs 中的部分类识别

> ID：14260276
> 
> 赞同：0
> 
> 时间：2013-01-10T14:34:57.683
> 
> 标签：wpf, xaml, code-behind, partial-classes

我有一个类，部分在 XAML 中定义，部分在代码中：

文件*ElementResource.xaml*如下所示：

```
<ResourceDictionary  x:Class="TestElement.Views.ElementResource"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:local="clr-namespace:TestElement.Views"
                     xmlns:vm="clr-namespace:TestElement.ViewModels">

    <DataTemplate x:Key="TestTemplate"  DataType="{x:Type vm:TestElementViewModel1}">
    </DataTemplate>

</ResourceDictionary> 
```

类 *ElementResource" 的其余部分在 ElementResource.xaml.cs 文件中的代码中定义，*如下*所示：

```
using System.ComponentModel.Composition;
using System.Windows;

namespace TestElement.Views
{
    [Export(typeof(ResourceDictionary))]
    public partial class ElementResource : ResourceDictionary
    {
    }
} 
```

由于某种原因，“代码隐藏”中无法识别 XAML 中定义的类部分：

![未能识别](../Images/19903039db2671f0b68de4ebec2aac3e.png)

此外，XAML 中定义的 DataTemplate 在初始化后不包含在资源字典中。

我已经尝试构建和重建，*Ctrl+Shift+s并*[在这里](http://msdn.microsoft.com/en-us/library/cc221357%28v=vs.95%29.aspx#codebehind_and_partial_class_requirements)仔细检查了部分类的要求。

我错过了什么？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T15:32:37.773

好的，我明白了：我从另一个项目复制并粘贴了 xaml 文件，并将文件粘贴到当前项目时，它的**BuildAction**属性更改为**none**，我没有注意到...将其切换到**Page**使 xaml 部分为人所知...

谢谢大家的帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:41:10.767

x:Class="TestElement.Views.ElementResource"

这是您的完整程序集名称吗？尝试添加所有部分，然后应该可以识别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T14:47:23.937

在您的 XAML 中，您是否缺少 ResourceDictionary 前面的“本地：”？

```
<local:ResourceDictionary  x:Class="TestElement.Views.ElementResource"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TestElement.Views"
    xmlns:vm="clr-namespace:TestElement.ViewModels">

    <DataTemplate x:Key="TestTemplate"  DataType="{x:Type vm:TestElementViewModel1}">
    </DataTemplate>

</local:ResourceDictionary> 
```

# api - 亚马逊 Kindle API

> ID：14260288
> 
> 赞同：0
> 
> 时间：2013-01-10T14:35:33.687
> 
> 标签：api, amazon, kindle

我正在寻找使用 Amazon Kindle API 来查看我在亚马逊上的图书销售情况的功能。任何人都可以帮助我获取这些 API，或者如果不可用，请让我知道获取此功能的另一种方式？

期待从那里得到天才的答案..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T22:17:37.027

目前无法通过任何 API 查看您在亚马逊上的图书销售情况。我们提出的唯一解决方法是使用[mechanize](http://mechanize.rubyforge.org/)登录然后触发下载。

# sorting - yii dataprovider 排序

> ID：14260292
> 
> 赞同：1
> 
> 时间：2013-01-10T14:35:43.743
> 
> 标签：sorting, yii, limit

我有一个关于在 Yii DataProvider 中排序的问题。我想对它进行排序，就像我现在正在做的那样，但从第三条记录 DESC 开始。不是第一，第二，而是第三记录。像“限制=>'3'标准。有什么想法吗？

```
$dataProvider=new CActiveDataProvider('News', array(
        'criteria'=>array(
        'order'=>'create_time DESC',
        ),
        'pagination'=>array(
        'pageSize'=>10,
        ),
    )); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:44:38.593

根据条件配置[`offset`](http://www.yiiframework.com/doc/api/1.1/CDbCriteria#offset-detail)属性：

```
$dataProvider=new CActiveDataProvider('News', array(
    'criteria' => array(
        'order'  => 'create_time DESC',
        'offset' => 2, // zero-based index, third record = 2
    ),
    'pagination' => array(
    'pageSize'   => 10,
    ),
)); 
```

# javascript - 使用 GoogleMapsAPI 3.0 和 FusionTablesAPI 1.0 检索 InfoWindowContent

> ID：14260296
> 
> 赞同：0
> 
> 时间：2013-01-10T14:36:09.000
> 
> 标签：javascript, json, google-maps-api-3, google-fusion-tables, infowindow

我最近收到了一封来自 Google 的电子邮件，建议我更新我的地图代码。我按照他们的[Migration Guide](https://developers.google.com/fusiontables/docs/v1/migration_guide)中提供的说明进行操作。现在一切正常，除了 infoWindow。当我输入地址并点击搜索时，它会正确地将图钉放在地图上，但不会打开具有相应内容的 infoWindow。这是我认为不正确的代码片段。

```
var script = document.createElement("script");

    script.setAttribute("src","https://www.googleapis.com/fusiontables/v1/query?sql=SELECT * FROM " +
        tableid + " WHERE ST_INTERSECTS(geometry, CIRCLE(LATLNG(" + coordinate.lat() + "," + coordinate.lng() + "), 0.1))&jsonCallback=addInfoWindow");
    document.getElementsByTagName("head")[0].appendChild(script); 
```

我已经尝试了 jsonCallback 和回调参数。两者产生相同的结果。

谢谢您的帮助。

****添加信息窗口（）*******

 **```
function addInfoWindow(response) {

 infowindow.close();

if(response.table.rows.length) {
    infowindow.close();
     initialize();
    infowindow.setContent("Content removed: " + response.table.rows[0][1] + response.table.rows[0][0]);
    infowindow.setPosition(coordinate);
    map.setCenter(coordinate);
    map.setZoom(15);
    infowindow.open(map);
}
else
{
infowindow.close();
initialize();

    infowindow.setContent("Nothing here.");
    infowindow.setPosition(coordinate);
    map.setCenter(coordinate);
    map.setZoom(15);
    infowindow.open(map);
} 
```

}

**更新：生成信息窗口（）**

```
function generateInfoWindow(results, status) {

    initialize();

if (status == google.maps.GeocoderStatus.OK) {
    initialize();
    //center and zoom map
    coordinate = results[0].geometry.location;

    marker = new google.maps.Marker({
        map: map,
        layer: layer,
        animation: google.maps.Animation.DROP,
        position: coordinate
    });
    map.setCenter(results[0].geometry.location);
    map.setZoom(15);

    var script = document.createElement("script");

   script.setAttribute("src","https://www.googleapis.com/fusiontables/v1/query?sql=SELECT * FROM " +
    tableid + " WHERE ST_INTERSECTS(geometry, CIRCLE(LATLNG(" + coordinate.lat() + "," + coordinate.lng() + ")))&key=" + apiKey +  " &callback=addInfoWindow()");
document.getElementsByTagName("head")[0].appendChild(script);

} else {
    alert("Please make sure you entered your City and State");
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T18:15:52.460

尝试类似： "...)&key=" + apiKey + "&callback=addInfoWindow()"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T23:39:33.137

下面是一些示例代码，重点是从 Fusion Table 中检索数据。 [https://docs.google.com/file/d/0B5KVZ6J1ohN_dktpWXBmSzNkdjg/edit](https://docs.google.com/file/d/0B5KVZ6J1ohN_dktpWXBmSzNkdjg/edit)

我猜你不想要这部分：)、0.1))……而且你确实需要 API 密钥。

希望有帮助，

-丽贝卡**

# php - PHP：空格未正确显示

> ID：14260300
> 
> 赞同：0
> 
> 时间：2013-01-10T14:36:20.587
> 
> 标签：php, utf-8, space

我已经构建了一个 PHP 应用程序。页面中的数据以“卡纳达语”语言显示。我看到空格显示为一个矩形（或者它是一个不同的字符？）。知道如何正确设置吗？

我已将所有页面的编码设置为 UTF-8。

谢谢克里希纳

# c - 以下c程序的编译时错误的正确解释是什么

> ID：14260311
> 
> 赞同：0
> 
> 时间：2013-01-10T14:36:48.443
> 
> 标签：c, compiler-errors

```
 #include<stdio.h>
int f(int a)
{
  a > 20? return(10): return(20);
}
int main()
{
    int f(int);
    int b;
    b = f(20);
    printf("%d\n", b);
    return 0;
} 
```

我遇到了以下错误

表达式语法

函数应该返回一个值

参数 a 从未使用过

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T15:00:04.350

C 中的条件运算符 ( `?:`) 仅将表达式作为操作数。

C99 §6.5.15 中的语法：

> 条件表达式：
> `逻辑或表达式
> `逻辑或表达式？表达式：条件表达式``

 ``return 语句不是表达式，而是语句。因此，您不能`return`在操作数中添加语句。

您可以使用以下内容重写您的函数：

```
return a > 20 ? 10 : 20; 
```

* * *

边注。GCC（和 clang，可能还有其他）有一个称为[语句表达式](http://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html)的扩展，在这种情况下，您可以使用它在条件中填充 return 语句：

```
a > 20 ? ({return 10;}) : ({return 20;}); 
```

（我提倡这样做；但可能有它的用途。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T14:42:06.233

两件事情：

首先，您的错误来源，您使用的[三元运算符](http://en.wikipedia.org/wiki/%3F:)错误：

```
int f(int a)
{
  return (a > 20? (10): (20));
} 
```

`a > b ? x : y`将返回`x`或返回`y`给您，您可以存储该值：

```
result = a > b ? x : y; 
```

或者在这种情况下，您可以从函数中返回。

第二行：

```
int f(int); 
```

没用，应该删除

* * *

您尝试这样做的方式错误的原因是因为`?:`期望的语法在右侧有一个表达式`?`

编程语言中的表达式是显式值、常量、变量、运算符和函数的组合。

`return`不是表达式，而是语句（语句是命令式编程语言中最小的独立元素。）

因此，您可以`return`使用表达式（三元运算的结果）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T14:41:04.497

正确的实现如下：

```
 #include<stdio.h>
int f(int a)
{
  return a > 20? 10: 20;
}
int main()
{
    int f(int);
    int b;
    b = f(20);
    printf("%d\n", b);
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T15:02:28.533

OP要求解释，而不是更正。以下是实际答案：

**表达式语法**：您尝试使用`return`语句作为 ?: 运算符的参数。这段代码是错误的，因此编译器将其丢弃并继续编译

**函数应该返回一个值**`return`：由于第一个错误，函数中没有有效值`f`

**从未使用参数 a**：由于第一个错误，函数`a`中未使用参数`f```

# php - sql注入改变返回值

> ID：14260312
> 
> 赞同：3
> 
> 时间：2013-01-10T14:36:50.023
> 
> 标签：php, mysql, sql, sql-injection

我最近想到了这样的事情：

```
$sql = "SELECT password FROM users WHERE user = '" . $_POST["user"] . "'";
$result = mysql_query($sql);

if (myql_num_rows($result) != 1) {
//Error
}

$data = mysql_fetch_array($result);

if ($data["password"] == md5($_POST["password"])) {
//Welcome
} else {
//Error
} 
```

即使没有使用参数化查询或至少转义，我也想不出一个适当的 sql 注入，你可以用它来达到目的`Welcome`。您可能需要修改返回的密码，然后您可以将其 md5 值用作密码。

如果可能的话，有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T14:51:27.573

为用户使用以下值：

```
obviouslyinvalidusername' union select MD5('password123') as password -- 
```

然后一个密码`password123`应该验证。我不知道此时您将登录哪个用户帐户，因为未显示该部分逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:46:32.203

```
"'; UPDATE user SET password=MD5('fakepass') where username='username'" 
```

这会将任意密码作为 md5 哈希值插入到数据库中。

# php - 将查询字符串中的数组解析为数组，而不是字面上的“数组”

> ID：14260315
> 
> 赞同：0
> 
> 时间：2013-01-10T14:36:54.633
> 
> 标签：php, arrays, uri, query-string, eval

我遇到了一个不寻常的场景，我需要将查询字符串转换为数组。

查询字符串如下所示：

```
?sort%5B0%5D%5Bfield%5D=type&sort%5B0%5D%5Bdir%5D=desc 
```

解码为：

```
sort[0][field]=type&sort[0][dir]=desc 
```

如何将它作为可用数组放入我的 PHP 中？IE

```
echo $sort[0][field] ; // Outputs "type" 
```

我试过邪恶的 eval() 但没有运气。

* * *

我需要更好地解释一下，我需要的是 sort%5B0%5D%5Bfield%5D=type&sort%5B0%5D%5Bdir%5D=desc 的文字字符串进入我的脚本并存储为变量，因为它将是在函数中作为参数传递。

我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:40:21.053

PHP 会为您将该格式转换为数组。

```
header("content-type: text/plain");
print_r($_GET); 
```

给出：

```
Array
(
    [sort] => Array
        (
            [0] => Array
                (
                    [field] => type
                    [dir] => desc
                )

        )

) 
```

如果您的意思是将该字符串*作为字符串*而不是作为查询字符串输入到您的网页中，请使用该[`parse_str`](http://php.net/manual/en/function.parse-str.php)函数对其进行转换。

```
header("content-type: text/plain");
$string = "sort%5B0%5D%5Bfield%5D=type&sort%5B0%5D%5Bdir%5D=desc";
$array = Array();
parse_str($string, $array);
print_r($array); 
```

…给出相同的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:45:09.123

使用 parse_str()

[http://php.net/manual/en/function.parse-str.php](http://php.net/manual/en/function.parse-str.php)

```
<?php
$str = "first=value&arr[]=foo+bar&arr[]=baz";
parse_str($str);
vecho $first;  // value
echo $arr[0]; // foo bar
echo $arr[1]; // baz

parse_str($str, $output);
echo $output['first'];  // value
echo $output['arr'][0]; // foo bar
echo $output['arr'][1]; // baz

?> 
```

# servicestack - 推荐的 servicestack 错误传播策略

> ID：14260316
> 
> 赞同：3
> 
> 时间：2013-01-10T14:36:56.363
> 
> 标签：servicestack

我有调用另一个 ServiceStack 服务 (B) 的 ServiceStack 服务 (A)。

如果 (B) 抛出错误，我可以在 (A) 中捕获 WebServiceException，但是将 (B) 的错误传播回 (A) 的客户端的推荐方法是什么？我应该重新抛出（B）的异常还是不捕获它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T07:20:12.440

如果您使用类型化的 C# 客户端从 (A) 调用 (B)，那么是的，如果您希望将异常传播到 (A) 的客户端，那么您不能捕获它，C# 客户端将抛出它遇到的任何异常都会被序列化到 (A) 的客户端，如果该客户端正在使用 C# ServiceClient，那么它将依次抛出该异常。

流程几乎是这样的：

```
(A client)    ->    (A service) ->     (B client)     ->      (B service)
 deserializes            <-           deserializes    <-   throws Exception E
 and rethrows E                      and rethrows E 
```

希望这是有道理的。

# linux - Linux - 以特定优先级启动进程

> ID：14260317
> 
> 赞同：1
> 
> 时间：2013-01-10T14:36:56.770
> 
> 标签：linux, shell

在 Linux 上，如何从终端以特定优先级值启动进程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T14:38:28.480

使用命令`nice`：

```
nice -n 15 <command> <argument1> <argument2> … 
```

例如：

```
nice -n 15 sh -c 'while true; do true; done' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:38:21.040

您可以使用`renice`或`nice`（查找它们）来降低优先级。要增加你需要`root`。

# javascript - 如何调整 Launchrock 小部件的大小？

> ID：14260322
> 
> 赞同：1
> 
> 时间：2013-01-10T14:37:06.730
> 
> 标签：javascript, html, css

我正在运行一个 Joomla 网站，并且正在尝试嵌入一个 launcrock-widget（launchrock 是一项服务，它可以让对您的项目感兴趣的人输入他们的电子邮件，所以当您完成后，您可以通过电子邮件发送给他们），但我不能真的调整它的大小。该小部件包含 1 行 javascript 代码，我使用 Sourcerer Code Helper 插件将其放入 Joomla 文章中。

该小部件嵌入此处： [http ://cavemanskin.com/index.php/14-day-meal-plan-widget](http://cavemanskin.com/index.php/14-day-meal-plan-widget)

现在有 2 个问题：由于某种原因 1) 小部件占据了整个页面 2) 文本下方的灰色框消失了，因此您无法真正阅读它。使用“检查元素”，我注意到 Launchrock 将所有内容放在名为“lr-widget”的 DIV 中。我添加了代码：

```
<style type="text/css">  
div#lr-widget { height:300px; width:300px }  
</style> 
```

但是小部件仍然是相同的大小。谁能告诉我我做错了什么？

编辑：小部件的代码仅适用于我给launchrock的域，我想在我的PC上试验一个带有javascript代码的.html，但launchrock小部件根本不加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:49:39.537

在 Chrome 开发人员中查看这个有一个内壳，也可以自定义并添加到您的主 CSS 中，因此覆盖他们的类并添加到您的主 CSS 中。

前任：

```
.LR-content {
    color: #FFFFFF;
    font-family: "Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;
    font-size: 14px;
    font-weight: 300;
    height: 200px;
    min-height: 100%;
    position: absolute;
    width: 500px;
    z-index: 0;
}

.LR-bg-img {
    background-attachment: fixed;
    background-color: #222222;
    background-image: url("img/classicBg.png");
    background-position: center center;
    background-size: cover;
    content: "";
    height: 50%;
    left: 0;
    margin: 0;
    padding: 0;
    position: absolute;
    top: 0;
    width: 100%;
    z-index: 0;
} 
```

我只是在测试这些，你可以看到许多变化。所以你可以尝试抓取这些代码并将它们覆盖在你的主人身上。

# ruby-on-rails - 设置 Rails 应用程序上限，以便只有一个人可以查看我们的页面

> ID：14260326
> 
> 赞同：0
> 
> 时间：2013-01-10T14:37:16.653
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

在joomla中有这样的功能，比如打开网页维护，让用户只看到页面，我们正在重建。这样的功能可以在 ror web 应用程序上完成吗？我也可以设置一些日志系统，而不生成任何新的设计模型，例如：输入密码，进入重建页面？

我知道这个问题很大，但是如何在 Rails 上完成呢？

写点什么，让除了一个人以外的所有输入正确密码的人，只看到“重建”页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T15:11:06.743

为此，您可以使用“正在构建的文本”设置 public/index.html 页面。
您可以使用 http 身份验证隐藏的所有其他页面。只需添加以下代码

# application_controller.rb

```
class ApplicationController < ActionController::Base
  if Rails.env.production?
    http_basic_authenticate_with name: "admin", password: "secret"
  end
end 
```

# java - Spring从属性bean中引用一个属性

> ID：14260328
> 
> 赞同：4
> 
> 时间：2013-01-10T14:37:19.883
> 
> 标签：java, spring, dependency-properties

我创建了一个运行良好的弹簧配置文件。

我的下一步是将用户配置属性与系统属性分开。

我决定使用将由用户配置的 bean 创建额外的 xml 文件。

我在创建几个这样的逻辑 bean 封装将由真实类 bean 使用的属性时遇到了问题：

我在网上找到了一个以这种方式引用属性的选项：

用户配置文件

```
<bean id="numberGuess" class="x...">
    <property name="randomNumber" value="5"/>

    <!-- other properties -->
</bean> 
```

系统配置文件

```
<import resource="UserConf.xml" />

<bean id="shapeGuess" class="y...">
    <property name="initialShapeSeed" value="#{ numberGuess.randomNumber }"/>

    <!-- other properties -->
</bean> 
```

但我的问题是我需要`x...`类是逻辑的东西，根本不应该被初始化，而且我不希望它泄露系统类层次结构的任何信息，因为它应该只在使用配置 xml 文件中。

**解决方案**1 是创建一个表示此属性的 Java 对象：

```
public class MyProps(...) 
```

并在spring系统配置中添加一个bean parent：

```
<bean id="MyProps" class="path to MyProps"/> 
```

在用户端将以前的 bean 更改为：

```
<bean id="numberGuess" parent="MyProps">
    <property name="randomNumber" value="5"/>

    <!-- other properties -->
</bean> 
```

**解决方案2**是像Database.props一样使用平面配置文件，并使用工厂加载它。

**解决方案3**是使用Spring Property Placeholder配置从XML属性文件加载属性（例如[example](http://rvsoni.wordpress.com/2012/03/15/spring-property-placeholder-configuration-to-load-properties-from-xml-properties-file/)），但是这里我根本不知道如何获得更复杂的属性嵌套结构（属性需要用不同的逻辑名称分隔，例如minNumber 将在 xAlgo 和 y 算法下定义）。

我不喜欢创建新的 Java 类只是为了处理这个问题或将我的用户配置移动到平面道具文件（我需要 xml 结构），他们还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T15:49:26.147

我会回答我自己的问题，因为它看起来对我来说是最好的解决方案（而且比建议的要简单得多）

我将使用 PropertiesFactoryBean 为我完成工作：

例如

用户配置文件

```
<bean id="numberGuess" class="org.springframework.beans.factory.config.PropertiesFactoryBean">
  <property name="properties">
    <props>
        <prop key="randomNumber">3</prop>

    <!-- other properties -->
</bean> 
```

系统配置文件

```
<import resource="UserConf.xml" />

<bean id="shapeGuess" class="y...">
    <property name="initialShapeSeed" value="#{ numberGuess.randomNumber }"/>

    <!-- other properties -->
</bean> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:59:50.467

首先，如果您不了解[属性占位符](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html#beans-factory-extension-factory-postprocessors)，您应该看一下。也是`@Value("${some.property:defaultvalue}")`你应该看看的东西。

其次，*配置*这个词在 Spring 中是模棱两可的。Spring 使用这个词，但它们的意思是开发人员配置而不是用户配置。尽管人们说或认为 Spring 不是配置引擎。

我不确定你想做什么，但你应该知道你的配置不会在运行时调整，这对于像“*用户*”配置这样的东西来说是经常需要的。所以大多数人编写自己的配置层。

您应该注意的另一件事是不使用 XML 配置，而是使用[Java 配置](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html#beans-java)，这将为您提供更大的灵活性。

# xcode - gcovr 无法识别 Xcode 4.5 中的条件

> ID：14260330
> 
> 赞同：1
> 
> 时间：2013-01-10T14:37:24.393
> 
> 标签：xcode, unit-testing, jenkins, code-coverage, cobertura

我有一个适用于 iOS 6.0 的 Xcode 4.5 项目，我正在尝试使用 Cobertura 为 Jenkins 设置测试覆盖率。

我已经设置了一个测试目标并正确配置了主目标和测试目标（仪器程序流程和生成测试覆盖文件都为是）。

生成覆盖率报告（.gcda 文件）后，我使用 gcovr 工具（[2.4 版](https://software.sandia.gov/trac/fast/browser/gcovr/trunk/scripts)）将其转换为 XML。

当我在 Jenkins 上运行测试时，一切正常，我可以通过 Cobertura 插件查看报告。唯一的问题是，在 Cobertura 报告中，“条件”的所有值都是“N/A”，而我​​看到覆盖的文件中有条件（if-constructions）。

我的猜测是在转换为 XML 时发生了一些事情，导致分支/条件转换错误，但我找不到它是什么。

奇怪的是，对于某些 if 结构，它确实识别条件。例如，如果我使用“SenTestingKit”库中的“STAssertEquals()”宏，则可以识别那里的 if 结构。

我希望有人可以帮助我解决这个问题，或者至少知道原因。如果您需要更多信息，请随时问我。

尼古拉斯

# android - 从套接字接收十六进制值而不是 SocketServer 上的字符串

> ID：14260331
> 
> 赞同：2
> 
> 时间：2013-01-10T14:37:25.153
> 
> 标签：android, python, sockets, encoding, character-encoding

我在 Android 应用程序和 python 服务器之间打开了一个套接字。组合是Server监听，android连接Server。

这是服务器代码。有问题的部分发生在 的定义中`handle`：

```
import SocketServer
from time import sleep
import sys

HOST = '192.168.56.1'
PORT = 2000

class SingleTCPHandler(SocketServer.StreamRequestHandler):
    def handle(self):
    try:
        while(1):
            sleep(0.03)
            data = self.rfile.readline().strip()

            print data
    except KeyboardInterrupt:
        sys.exit(0)

class SimpleServer(SocketServer.ThreadingMixIn, SocketServer.TCPServer):
    allow_reuse_address = True

    def __init__(self, server_address, RequestHandlerClass):
        SocketServer.TCPServer.__init__(self, server_address, RequestHandlerClass)

server = SimpleServer((HOST, PORT), SingleTCPHandler)
try:
    server.serve_forever()
except KeyboardInterrupt:
    sys.exit(0) 
```

连接正常建立，Android应用向socket发送如下数据：

```
'0:0' 
```

但数据在服务器上接收为：

```
'\x000\x00:\x000\x00' 
```

接收数据的变量是：

```
data = self.rfile.readline().strip() 
```

并且打印给出了常规格式：

```
In [2]: print data
0:0 
```

我没有设法`print`使用 pdb 进入该函数以查看它的作用。我正在寻找一种`'\x000\x00:\x000\x00'`将`'0:0'`.

请告知转换变量的方法。欢迎您评论/批评整个实施。这是我处理套接字的第一个项目，所以我不知道其中的陷阱。

**更新**

这是原始的 Android 代码：

```
String podaci = "0:0";
public void Socketic() throws IOException {

    Socket mojSocket = new Socket(urlServer, port);

    DataOutputStream izlazdata = new DataOutputStream(
            mojSocket.getOutputStream());
    while (podaci != "end") {
        try {
            Thread.sleep(60);
        } catch (InterruptedException e) {

            e.printStackTrace();
        }

        izlazdata.writeChars(podaci);
        izlazdata.flush();
    }
    izlazdata.close();
    mojSocket.close();
}; 
```

正如您所怀疑的那样，问题是：

```
izlazdata.writeChars(podaci); 
```

`writeChars`使用方法`writeChar`。状态的 API 文档`writeChar`：

> 将 char 作为 2 字节值写入底层输出流，先是高字节...

这两个字节代表 UTF-16 用于编码的 16 位。

当我们将其更改为一切开始工作时：

```
izlazdata.writeBytes(podaci); 
```

**更新**

根据给出的答案，这里是如何用字符来解释不需要的字符串。

![在此处输入图像描述](../Images/27b5a71e7f7ba08fa9a0a36d0ebf5c0f.png)

这解决了我的具体问题，但是，如果有人会对这里发生的事情给出一个更通用的解决方案，以便可以吸取更大的教训。如果没有，我会在几天内接受 Esailijas 的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T14:46:37.573

您需要显示发生在 Android 上的代码，但它似乎在以 UTF-16BE 发送数据。您应该在 Android 端指定编码。这些字符不是字面上的十六进制，而是因为 NUL 字符不可打印，所以 python 显示`\x00`。

另一种选择是对其进行解码：

```
self.rfile.readline().decode("utf_16_be").strip() 
```

请注意，此结果是一个 unicode 字符串。

# c++ - 指向对象数组的指针作为成员覆盖内存

> ID：14260334
> 
> 赞同：0
> 
> 时间：2013-01-10T14:37:36.187
> 
> 标签：c++, arrays, class, object

这是交易。我们有 2 个不同的类 F 类和 O 类

```
class F {
    private:
        int x;
        int y; 
    public:
        int getXf(){ return x; }
        int getYf(){ return y; }
        f(int ,int);
};

class O {
    private:
        int n;
        int k;
        int x;
        int y;
        char type;
        int id;
        int t;
    public:
        O(int ,int ,int ,int ,int);
        int getX(){ return x; }
        int getY(){ return y; }
}; 
```

我们有第三个类 P，我们在其中初始化值。在类中，我们创建了两个对象数组。

```
class Prog {                                                                   
    public:
        int count;
        int fcount;
        O *o[]; //here we are declaring the arrays of objects
        F *f[];           
    public :
        //void init(); Here is the function where we initializing the values
}; 
```

现在我们在其中创建对象的 2 个 for 语句。

```
for(int i=0;i<10;i++){
        randx = rand() % 10;
        randy = rand() % 20;

        o[i] = new O(100,50,i,randx,randy);
    }

    for(int i=0;i<3;i++){
        randx = rand() % 10;
        randy = rand() % 10;

        f[i] = new F(randx, randy);
    } 
```

当我们打印时，所有的对象都在这里，但第一类的前 3 个被秒的对象替换。分别是`100`和`50`(1st for) from`randx`和`randy`(2nd for)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T14:48:35.480

```
O *o[]; 
```

这声明了一个未知大小的数组，这是一个不完整的类型。C++ 不允许将其用作类成员，尽管一些编译器将允许它作为扩展，将其解释为大小为零的数组。无论哪种情况，这都不是您想要的。

如果您知道在编译时绑定的数组，那么您应该指定它：

```
O *o[10]; 
```

否则，您需要在运行时动态分配一个数组：

```
std::vector<O*> o;

for(int i=0;i<10;i++){
    randx = rand() % 10;
    randy = rand() % 20;

    o.push_back(new O(100,50,i,randx,randy));
} 
```

我还建议在数组中存储对象，或者可能是智能指针，而不是原始指针。如果您出于某种原因确实需要原始指针，请记住在完成对象后删除它们，因为这不会自动发生，并且不要忘记[三法则](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-10T14:40:06.370

您正在声明数组，但您从不为它们分配内存。您所看到的只是您的代码在整个堆栈中的运行方式。

更合适的东西：

```
struct X {}; struct Y {};

class P {
public:
  P() : xs(new X*[10]), ys(new Y*[10]) { init(); }

  ~P() {
    // delete all objects
    for(std::size_t i = 0; i < 10; ++i)
      delete xs[i];
    for(std::size_t i = 0; i < 10; ++i)
      delete ys[i];

    delete[] xs;
    delete[] ys;
  }
private:
  void init() {
    // initialize
    for(std::size_t i = 0; i < 10; ++i)
      xs[i] = new X();
    for(std::size_t i = 0; i < 10; ++i)
      ys[i] = new Y();
  }

  // prevent assignment and copy
  P& operator=(const P& other);
  P(const P&);

  X** xs;
  Y** ys;
}; 
```

当然，如果您只是 `std::vector`用来存储数据，那么所有这些魔法都变得不必要了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T14:47:44.123

问题在于您声明数组的方式：

```
O *o[/*No size here*/];
F *f[/*No size here*/]; 
```

由于您没有说明数组的大小，因此这相当于

```
O **o;
F **f; 
```

因此，您分别声明了两个类型的成员*“指向 O 的指针”*和*“指向指​​向 F 的指针”*，但它们未初始化，并且您没有为它们分配任何内存来指向。也就是说，您实际上没有任何数组，只有可用于引用所需数组类型的指针。

如果您在编译时知道要使用的大小，则应在声明中指定该大小，这将为您提供正确分配的该大小的数组。否则，请考虑使用`std::vector`.

# ruby - 为什么在单引号字符串中需要双反斜杠转义？

> ID：14260337
> 
> 赞同：2
> 
> 时间：2013-01-10T14:37:37.310
> 
> 标签：ruby, string, escaping, quotes

只是好奇 Ruby 开发人员决定解释单引号内的双反斜杠转义序列背后的原因。我可以理解为什么必须解释转义的单引号，因为无法插入单引号字符。例如：

```
'\'' == "'" 
```

但考虑`'\\' == "\\"`。为什么这是另一个特例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T17:21:35.243

### 为了用反斜杠结束字符串

`\'`正如其他人也注意到的那样，硬引用字符串中最初需要的一种转义是。

但真正需要的根本原因`\\`是，一旦*被*`\'`支持，就不可能用反斜杠***结束***硬引用的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:39:53.070

这是插入反斜杠本身。如果没有这种特殊情况，就不可能在单引号字符串中使用反斜杠。

`\'`并且`\\` [是单引号字符串中仅有的两个转义序列](http://en.wikibooks.org/wiki/Ruby_Programming/Strings#Single_quotes)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T14:49:13.437

### 撇号需要转义

这种特殊情况对于将单引号或撇号嵌入到单引号字符串中是必要的。考虑以下：

```
'\''
# => "'"

'It\'s a baby boy!'
# => "It's a baby boy!" 
```

如果没有转义符，Ruby 将假定第二个引号终止字符串，留下不平衡的第三个引号。

### 斜线需要转义

作为前面的推论，您需要转义转义字符以避免转义后续字符。例如，`'\'`说要转义第二个引号，留下一个未终止的字符串。但是，`'\\'`会导致字符串中出现文字斜线。

# c - 未知字符串长度的 fgets

> ID：14260338
> 
> 赞同：1
> 
> 时间：2013-01-10T14:37:42.350
> 
> 标签：c, fgets

如何`fgets`从键盘缓冲区读取长度未知的字符串？`*fgets(char *s, int size, FILE *stream);`

我可以给`fgets`一个大小`NULL`的位置吗？`int`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T14:40:39.177

不，您需要知道行终止符是什么（通常是换行符和/或回车符），并继续循环阅读，直到您得到它。当然，您还需要增加缓冲区并在获得每个片段时将它们复制到其中。

如果你有它，POSIX'`[getline()](http://linux.die.net/man/3/getline)`会这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T14:45:50.567

的长度参数`fgets`是函数“优于”的原因之一`gets`。您绝对必须指定您传递的缓冲区可以容纳的数据量，否则您的应用程序可能会崩溃。

在我的大多数应用程序中，只要需要满足我期望接收的任何内容，我都会多次使用缓冲区。

使用 getline 可能会导致 malloc/realloc，如果您对使用动态内存没有任何问题，请随意使用该函数。我更喜欢简单的`buffer[MAX_SIZE+1]`变量。

# r - 在 R 和 RStudio 中清除控制台的功能

> ID：14260340
> 
> 赞同：345
> 
> 时间：2013-01-10T14:37:49.790
> 
> 标签：r

我想知道 R 中是否有清除控制台的功能，特别是 RStudio，我正在寻找可以在控制台中键入的功能，而不是键盘快捷键。

从 2010 年开始，有人已经在[StackExchange 的这篇文章](https://stackoverflow.com/questions/2824965/clear-r-console-programmatically)中提供了这样的功能。不幸的是，这取决于 RCom 包并且不能在 Mac OS X 上运行。

* * *

## 回答 #1

> 赞同：591
> 
> 时间：2013-04-18T13:49:10.243

```
cat("\014") 
```

是将`CTRL`+发送`L`到控制台的代码，因此将清除屏幕。

比仅仅发送大量退货要好得多。

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2013-12-18T05:50:09.850

如果您使用的是默认的 R 控制台，组合键++`Option`将清除控制台。`Command``L`

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2013-01-10T16:51:16.607

您可以定义以下函数

```
clc <- function() cat(rep("\n", 50)) 
```

然后您可以将其称为`clc()`.

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2016-02-05T20:40:07.540

在*Ubuntu-Gnome*中，只需按`CTRL`+即可`L`清除屏幕。

这似乎也适用于 Windows 10 和 7 以及 Mac OS X Sierra。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2018-03-30T01:16:35.620

`shell("cls")`如果在 Windows 上，

`shell("clear")`如果在 Linux 或 Mac 上。

（`shell()`将命令（或任何字符串）传递给主机终端。）

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2016-05-29T17:15:16.267

`cat("\f")`可能比 更容易记住`cat("\014")`。

它适用于我在 Windows 10 上。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2016-06-29T18:00:03.030

这是一个函数：

```
clear <- function() cat(c("\033[2J","\033[0;0H")) 
```

那么您可以像调用任何其他 R 函数一样简单地调用它，`clear()`.

如果您更喜欢简单地输入`clear`（而不是必须输入`clear()`，即使用括号），那么您可以这样做

```
clear_fun <- function() cat(c("\033[2J","\033[0;0H"));
makeActiveBinding("clear", clear_fun, baseenv()) 
```

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2016-07-05T00:47:44.003

我借鉴了上面的建议，开发了一个可以做到这一点的 R 包。该包称为 called `mise`，如“mise en place”。您可以使用安装和运行它

```
install.packages("mise")
library(mise)
mise() 
```

请注意，`mise()`默认情况下还会删除所有变量和函数并关闭所有图形。要清除控制台，请使用`mise(vars = FALSE, figs = FALSE)`.

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2018-04-23T09:55:44.060

如果您使用的是默认的 R 控制台`CTRL`+`L`

RStudio - `CTRL`+`L`

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-08-06T17:13:35.763

在linux`system("clear")`中用来清屏。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2016-11-11T18:35:21.940

可以结合以下两个命令

```
cat("\014"); 
cat(rep("\n", 50)) 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-04-14T10:12:32.050

猫（“\014”）。这将起作用。不用担心

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-11-12T03:30:35.103

RStudio 的另一个选项是`rstudioapi::sendToConsole("\014")`. 即使输出被转移，这也将起作用。

```
sink("out.txt")

cat("\014") # Console not cleared

rstudioapi::sendToConsole("\014") # Console cleared

sink() 
```

# ide - Visual Studio 2012 添加 _1 到单击事件处理程序

> ID：14260357
> 
> 赞同：7
> 
> 时间：2013-01-10T14:38:38.020
> 
> 标签：ide, visual-studio-2012

Visual Studio 2012 将 _1 添加到我在 XAML 中创建的任何单击事件处理程序中

即：我创建了一个新的 WPF 解决方案，放下一个按钮，在 XAML 中给按钮一个名称，输入“点击”，智能感知显示“新事件处理程序”，我点击它，它创建事件但它的名称为 btn_test_click_1

在 VS2010 中我们没有得到 _1，我怎样才能阻止这种情况发生，让我发疯？

**更新** 我可以确认这已通过 VS2012[更新 2修复](http://www.microsoft.com/en-us/download/details.aspx?id=38188)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T17:41:43.173

我可以确认这已通过 VS2012 [Update 2修复](http://www.microsoft.com/en-us/download/details.aspx?id=38188)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:42:26.527

只有当 IDE 看到已创建同名的现有事件处理程序时，它才会这样做。确保从代码文件中删除事件句柄信息，然后转到 aspx 文件并删除控件上的所有事件句柄连接。然后保存文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-30T11:14:13.373

您可以手动删除`_1`，正如您所说，您只有一个事件处理程序，因此不应有任何其他代码逻辑可以在您的事件上运行。

# cordova - 为什么我必须使用 Cordova 而不是 phonegap？

> ID：14260360
> 
> 赞同：0
> 
> 时间：2013-01-10T14:38:46.997
> 
> 标签：cordova, phonegap-plugins

出于某种原因，我必须删除phonegap-1.4.1并使用cordova-1.5.0，为此我做了什么：我刚刚删除了phonegap-1.4.1.jar并使用了cordova-1.5.0.jar。（并且还删除并放置了相应的 .js 文件。）

至此，我的任务已经完成.... :) 但是现在我有一个疑问，有什么好处？（可能不是现在，而是未来），

我已经阅读了一些链接： http: [//phonegap.com/2012/03/19/phonegap-cordova-and-what%E2%80%99s-in-a-name/](http://phonegap.com/2012/03/19/phonegap-cordova-and-what%E2%80%99s-in-a-name/)

我正在粘贴一个段落：

**随着时间的推移，PhoneGap 发行版可能包含与其他 Adob​​e 服务相关联的其他工具，这些工具不适用于 Apache 项目。例如，PhoneGap Build 和 Adob​​e Shadow 一起具有很大的战略意义。PhoneGap 将永远是免费的开源软件，并且永远是 Apache Cordova 的免费发行版。**

从链接得知： http: [//phonegap.com/2012/03/19/phonegap-cordova-and-what%E2%80%99s-in-a-name/](http://phonegap.com/2012/03/19/phonegap-cordova-and-what%E2%80%99s-in-a-name/)

**目前，唯一的区别在于下载包的名称，并将在一段时间内保持不变**

还是少了点什么，

简而言之，让我知道将 phonegap 移动到 cordava（1.5.0 到 2.x 任何版本）有什么好处。我需要更改以前使用的插件？？

对于某些版本需要更改： [https ://build.phonegap.com/docs/plugins](https://build.phonegap.com/docs/plugins)

让我知道是否有任何特定于 Android 的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T20:03:57.027

忘记 2.0.0 之前的任何博客或文章吧——PhoneGap 或 Cordova，无论你想调用基础库，都发生了很大变化，以至于所有新插件都与 1.x 的接口完全不兼容。如果您需要任何插件，请检查它是否适用于您的版本。许多插件已经更新，不再为旧的 1.x 版本维护。例如，我正在为[我维护的 iOS/Android 插件](https://github.com/AndiDog)做这件事。

除此之外，自 1.4.0 发布以来还有很多错误修正，并添加了对新平台的支持。据我所知，没有好的更新日志页面，但您可以查看[Simon MacDonald](http://simonmacdonald.blogspot.de/search/label/phonegap)等博客以获取有关已更改内容的一些资源。

关于PhoneGap Build，由于我不使用它，因此无法给您任何提示。

# c - C程序从矩阵中读取一列数据

> ID：14260361
> 
> 赞同：-1
> 
> 时间：2013-01-10T14:38:48.543
> 
> 标签：c, matlab

我有一个文本文件，如下所示：

```
a 1 2 3 4
b 5 6 7 8 
c 9 1 2 3
d 4 5 6 7 
```

我需要 C 代码根据提供的输入从我的文本文件中读取一列。例如，如果我将 1 传递给 C 代码，我需要输出为第一列的一维数组：

```
1
5
9
4 
```

如果我将 3 传递给代码，那么它会输出第三列：

```
3
7
2
6 
```

我正在使用 MATLAB 将输入传递给 C 代码`coder.ref`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:50:50.640

我不会为你写代码，所以这里有一些提示：

您在这里有几个选择，最简单的一个是：

从文件中读取所有数据，然后仅显示所需的列。

您可以通过使用 `temp = fgetc(FILE *stream)`浏览文件并执行以下操作来做到这一点，

`if(temp == ' ') j++;`和`if(temp == '\n') i++;`,

`i`作为矩阵的行和`j`列。

最后，您将需要一个函数将所有内容放在`temp`一起并将您的字符串（字符数组）转换为整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T18:17:27.843

如果您在 Unix/Linux 系统上，您可以使用命令行工具（例如`cut`）预处理您的文件以提取列。

假设您的矩阵位于名为 data.txt 的文件中。然后您可以执行以下操作：

```
% cat data.txt
a 1 2 3 4
b 5 6 7 8 
c 9 1 2 3
d 4 5 6 7

% cut -d " " -f 2 < data.txt
1
5
9
4 
```

-d 选项指定文本文件中列之间的分隔符。-f 指定要删除的列。您可以编写一个可以获取列号并`cut`为您运行的 shell 脚本。

# jquery - 如何使用 jQuery 更改 NEXT 项目的背景？

> ID：14260368
> 
> 赞同：0
> 
> 时间：2013-01-10T14:39:09.477
> 
> 标签：jquery, background, parent, next

我有以下方法，但我无法使其工作。我想在鼠标悬停时删除以下 li-tag 的背景。

我的代码：

```
<div id="mainmenu">
  <ul>
          <li><a href="index.php?id=2"  >Das Hotel</a></li>
          <li><a href="index.php?id=3"  >Angebote</a></li>
          <li><a href="index.php?id=4"  >Reservierung</a></li>
          <li><a href="index.php?id=5"  >Kontakt</a></li>
          <li><a href="index.php?id=6"  >Anfahrt</a></li>
          <li><a href="index.php?id=7"  >Rechtliches</a></li>
          <li><a href="index.php?id=8"  >Impressum</a></li>
  </ul>
</div> 
```

jQuery：

```
$("#mainmenu ul li a").hover(function() {
$(this).parent().next().find("li").css('background', 'none');
} 
```

这里的小提琴：

[http://jsfiddle.net/bQxJu/2/](http://jsfiddle.net/bQxJu/2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:43:51.743

```
$("#mainmenu ul li a").hover(function () {
  $(this).parent().next('li').find('a').css('background', 'none');
}, function () {
  $(this).parent().next('li').find('a').css('background', '');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:44:18.670

[http://jsfiddle.net/bQxJu/6/](http://jsfiddle.net/bQxJu/6/)

JS里面有错误，所以我不得不修复它。我还添加了一个“鼠标移出”事件处理程序来放回背景。此外，您将 LI 的 BG 设置为“无”，但您的 CSS 在锚点上有背景，而不是 li。

这是JS：

```
$("#mainmenu ul li a").hover(function () {
   $(this).closest('li').next().find("a").css('background', 'none');
}, function () {
   $(this).closest('li').next().find("a").css('background', '');
}); 
```

# php - 想把一个title标签的内容重复到html文档本身

> ID：14260373
> 
> 赞同：0
> 
> 时间：2013-01-10T14:39:23.157
> 
> 标签：php, html, extract

我的网站有数百万个页面，所有页面都是静态 html（实际上是 .shtml，但我已在服务器中将它们设置为解析为 .shtml，同时仍显示为 .html）。我可以在我的 html 文件中使用 Includes 和 php 脚本。我在当前页面中使用如下包含语句：

```
<!--#include virtual="somefilename.html"-->
<!--#include virtual="somefilename.php"--> 
```

我正在尝试在我的所有 .html 页面上添加 Facebook 社交标签：

```
<meta property="og:title" content="My Page Title" /> 
```

我需要此标签的值`<title></title>`与同一页面上的标签之间存在的值相同。

因此，我需要提取`<title>My Page Title</title>`标签之间的数据并在`<meta property="og:title" content="My Page Title" />`每个页面中打印它们。

有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:42:27.677

您应该使用 HTML 解析器，例如[`DOMDocument`](http://php.net/domdocument)查找`<title>`带有 的标签[`getElementsByTagName`](http://php.net/manual/en/domdocument.getelementsbytagname.php)，然后输出您需要的内容，如下所示：

```
$doc = new DOMDocument;
$doc->loadHTML( '<title>My Page Title</title>'); 
// However you read in your HTML file, could even do:
// $doc->loadHTMLFile( '/my/server/root/index.html');

foreach( $doc->getElementsByTagName( 'title') as $title) {
    echo '<meta property="og:title" content="' . $title->textContents . '" />';
} 
```

您可以使用它作为脚本来加载所有 HTML 页面。因此，您可以将其放在服务器上的 PHP 文件中，然后运行一次。您需要为其添加一个包装器，以便它知道所有 HTML 文件的位置。你可以使用这样的东西：

```
foreach( glob( '*.html') as $filename) {
    // The above code, which you can now use $doc->loadHTMLFile( $filename);
} 
```

# qt - QSignalSpy 捕获引用参数

> ID：14260376
> 
> 赞同：2
> 
> 时间：2013-01-10T14:39:29.863
> 
> 标签：qt, unit-testing, pass-by-reference

无法捕获已作为引用传递的参数`QSignalSpy`：

```
QSignalSpy spy( myObject, SIGNAL(foo(int&)));

...
int& i=spy.at(0).at(0).value<int&>(); 
```

由于 a`QVariant`不能包含引用成员。简单的逻辑。

但是还有其他解决方案来检查传入的参数吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-03-08T09:32:25.070

从 Qt 5 开始，我们可以简单地`connect`给一个 lambda 函数，这使得`QSignalSpy`不必要的使用：

```
std::vector<Value> values;
QObject::connect(myObject, &MyObject::foo,
    [&](const auto &value)
    { values.emplace_back(value); });

myObject.somethingCausingFoo();

ASSERT_EQ(1u, values.size());
EXPECT_EQ(expectedValue, values.at(0)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T16:00:13.370

一个“丑陋的解决方案”是破解相当简单的`QSignalSpy`代码以处理引用传递的参数。`int`我为参考参数提供了一个最小的工作示例。唯一的变化是`initArgs`和`appendArgs`功能。

**请注意**，使用这种方法，您将只能通过引用检查传递的参数的值。你**将无法**改变它的价值。

在`initArgs`函数中，我们检查是否有参数引用并填充`shouldreinterpret`列表。

```
void initArgs(const QMetaMethod &member)
{
    QList<QByteArray> params = member.parameterTypes();
    for (int i = 0; i < params.count(); ++i) {
       int tp = QMetaType::type(params.at(i).constData());
       if (tp == QMetaType::Void)
       {
           qWarning("Don't know how to handle '%s', use qRegisterMetaType to register it.",
                    params.at(i).constData());
           // Check if we have a reference by removing the & from the parameter name
           QString argString(params.at(i).constData());
           argString.remove("&");
           tp = QMetaType::type(argString.toStdString().c_str());
           if (tp != QMetaType::Void)
              shouldReinterpret << true;
        }
        else
            shouldReinterpret << false;
        args << tp;
     }
} 
```

和`appendArgs`函数，我们重新解释通过引用传递的参数：

```
void appendArgs(void **a)
{
    QList<QVariant> list;
    for (int i = 0; i < args.count(); ++i) {
        QMetaType::Type type = static_cast<QMetaType::Type>(args.at(i));
    if (shouldReinterpret.at(i))
    {
            switch (type)
        {
        case QMetaType::Int:
            list << QVariant(type, &(*reinterpret_cast<int*>(a[i + 1])));
            break;
                // Do the same for other types  
        }
    }
    else
        list << QVariant(type, a[i + 1]);
    }
    append(list);
} 
```

完整代码供参考：

```
class MySignalSpy: public QObject, public QList<QList<QVariant> >
{
public:
    MySignalSpy(QObject *obj, const char *aSignal)
    {
#ifdef Q_CC_BOR
        const int memberOffset = QObject::staticMetaObject.methodCount();
#else
        static const int memberOffset = QObject::staticMetaObject.methodCount();
#endif
        Q_ASSERT(obj);
        Q_ASSERT(aSignal);

        if (((aSignal[0] - '0') & 0x03) != QSIGNAL_CODE) {
            qWarning("QSignalSpy: Not a valid signal, use the SIGNAL macro");
            return;
        }

        QByteArray ba = QMetaObject::normalizedSignature(aSignal + 1);
        const QMetaObject *mo = obj->metaObject();
        int sigIndex = mo->indexOfMethod(ba.constData());
        if (sigIndex < 0) {
            qWarning("QSignalSpy: No such signal: '%s'", ba.constData());
            return;
        }

        if (!QMetaObject::connect(obj, sigIndex, this, memberOffset,
                    Qt::DirectConnection, 0)) {
            qWarning("QSignalSpy: QMetaObject::connect returned false. Unable to connect.");
            return;
        }
        sig = ba;
        initArgs(mo->method(sigIndex));
    }

    inline bool isValid() const { return !sig.isEmpty(); }
    inline QByteArray signal() const { return sig; }

    int qt_metacall(QMetaObject::Call call, int methodId, void **a)
    {
        methodId = QObject::qt_metacall(call, methodId, a);
        if (methodId < 0)
            return methodId;

        if (call == QMetaObject::InvokeMetaMethod) {
            if (methodId == 0) {
                appendArgs(a);
            }
            --methodId;
        }
        return methodId;
    }

private:
    void initArgs(const QMetaMethod &member)
    {
        QList<QByteArray> params = member.parameterTypes();
        for (int i = 0; i < params.count(); ++i) {
            int tp = QMetaType::type(params.at(i).constData());
            if (tp == QMetaType::Void)
            {
                qWarning("Don't know how to handle '%s', use qRegisterMetaType to register it.",
                         params.at(i).constData());

                QString argString(params.at(i).constData());
                argString.remove("&");
                tp = QMetaType::type(argString.toStdString().c_str());
                if (tp != QMetaType::Void)
                    shouldReinterpret << true;
            }
            else
                shouldReinterpret << false;
            args << tp;
        }
    }

    void appendArgs(void **a)
    {
        QList<QVariant> list;
        for (int i = 0; i < args.count(); ++i) {
            QMetaType::Type type = static_cast<QMetaType::Type>(args.at(i));
            if (shouldReinterpret.at(i))
            {
                switch (type)
                {
                case QMetaType::Int:
                    int k = (*reinterpret_cast<int*>(a[i + 1]));
                    list << QVariant(type, &k);
                    break;
                }
            }
            else
                list << QVariant(type, a[i + 1]);
        }
        append(list);
    }

    // the full, normalized signal name
    QByteArray sig;
    // holds the QMetaType types for the argument list of the signal
    QList<int> args;
    // Holds the indexes of the arguments that 
    QList<bool> shouldReinterpret;
}; 
```

# variables - 如何将列表作为单独的参数传递给 SASS 中的 mixin？

> ID：14260377
> 
> 赞同：0
> 
> 时间：2013-01-10T14:39:33.167
> 
> 标签：variables, sass, compass-sass, mixins

我有一些使用指南针阴影混合的元素。由于参数相同，我希望将它们放在变量中。我认为这是[可变参数](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#variable_arguments)的用途，但显然我做错了，因为以下内容不起作用：

```
// my shadow style
$shadow: #000000, 0px, 0px, 20px;

.list {
    @include single-box-shadow($shadow...);
} 
```

这应该与

```
.list {
    @include single-box-shadow(#000000, 0px, 0px, 20px);
} 
```

但是，虽然第二个示例有效，但第一个示例正在编译为

```
-webkit-box-shadow: none;
-moz-box-shadow: none;
box-shadow: none; 
```

我在这里做错了什么？

指南针版本是 0.12.2，SASS 是 3.2.3。

**编辑：我正在用 yeoman 编译，也许它使用不同的（旧）版本？我该如何检查？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T18:09:31.583

`single-box-shadow`mixin 不使用可变参数（参见：[http](http://compass-style.org/reference/compass/css3/box_shadow/#mixin-single-box-shadow) : //compass-style.org/reference/compass/css3/box_shadow/#mixin-single-box-shadow ）。

当您使用变量调用 mixin 时，您实际上在做的是：

```
@include single-box-shadow((#000000, 0px, 0px, 20px)); 
```

整个列表作为 mixin: 的第一个参数传递`$color`。如果您想重用特定的 box-shadow 值，请使用`box-shadow`带有空格分隔列表的 mixin，或者创建您自己的自定义 box-shadow mixin。

# objective-c - 在构建设置中更改了产品名称，现在应用程序不会在模拟器中启动

> ID：14260382
> 
> 赞同：0
> 
> 时间：2013-01-10T14:39:55.260
> 
> 标签：objective-c, xcode, ipad, ios6, ios-simulator

我希望在我的 iPad 应用程序图标下的子标题中显示一个不同的标题，并`Product Name`为我的应用程序更改了`Build Settings`.

这有效，但有一个奇怪的副作用。虽然该应用程序继续在连接的 iPad 上完美运行，但在模拟器上它现在的行为方式与 [this question] 中描述的方式相似。[1](https://stackoverflow.com/questions/5292286/xcode-4-says-finished-running-my-app-on-the-targeted-device-nothing-happe)

也就是说，它说它有`finished running <my app> on iPad 6.0 Simulator`

我尝试改回产品名称，但问题仍然存在。我还尝试了关于另一个问题的一些建议（例如删除`armv7`frfom `Required Device Capabilities`），但没有任何效果。

目前这还不是什么大事，因为我有一个真正的 iPad 可以测试，但我仍然想了解发生了什么，如果有人知道的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:45:16.063

听起来是时候重新启动 Mac 了。重新启动 Xcode 可能就足够了。要尝试的另一件事是从模拟器中删除应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:45:56.400

我在 iPhone 模拟器 6 上看到过这个。很多时候，当您再次单击“运行”时 - 它运行没有问题。

但是，如果这不起作用，您可以尝试以下方法之一：

*   Project->Command+Alt+Shift+K - 会出现一个选项，上面写着干净的文件夹。去做吧。

*   在管理器中，使用项目右侧的小箭头转到派生数据文件夹（查找器）。尝试从 finder 中删除您的项目。如果它没有立即删除，请经常尝试。

*   尝试重置 iPhone 或 iPad 模拟器。

*   退出 XCode 并重新打开项目。对 iPhone / iPad 模拟器做同样的事情。

如果您想知道为什么会发生这种情况，没有人真正知道！只是一些标志变坏了，一旦你重新做一切让它工作就恢复了，就是这样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T14:46:03.877

您是否尝试过关闭调试器？所以编辑方案->调试器->无

重新启动模拟器和 Xcode 并清理项目可能会有所帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T14:51:37.000

使用另一种方式：单击项目的 azure 图标，按住触控板，直到看到它允许编辑名称。选择您想要的名称，然后会出现这样的工作表：

![在此处输入图像描述](../Images/56621a3dd2658981d7d168e2bb790260.png)

单击“重命名”，您就完成了。

# payment-gateway - 授权查询交易

> ID：14260390
> 
> 赞同：0
> 
> 时间：2013-01-10T14:40:28.793
> 
> 标签：payment-gateway, authorize.net

我正在与 Authorize NET 集成我已经实施了费用退款和自动定期付款

但由于定期付款在授权服务器上执行，我需要将它们同步回来。有没有办法获取交易清单

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:58:41.807

如果您想获取交易列表，可以使用[Transaction Details API](http://developer.authorize.net/api/transaction_details/)。

# encryption - DESede/3DES ECB 使用 C# 在 Windows Phone 8 上加密/解密

> ID：14260393
> 
> 赞同：0
> 
> 时间：2013-01-10T14:40:37.490
> 
> 标签：encryption, windows-phone-8, bouncycastle, des

我正在寻找一种在**windows phone 8上使用密码****"DESede/ECB/PKCS5Padding"**加密字符串的方法。

 **与 Win8 RT 不同，没有*SymmetricKeyAlgorithmProvider*。

我尝试按照[此处](http://nicksnettravels.builttoroam.com/post/2012/03/27/TripleDes-Encryption-with-Key-and-IV-for-Windows-Phone.aspx)的建议添加 BounceCastle c# 库，但似乎没有密码“DESede/ECB/”，而只有带有 IV 密钥的“DESede/CBC/”，而我想要**没有 IV 密钥的 ECB**。

任何建议将不胜感激。谢谢 ：）

**编辑：** BounceCastle 库的解决方案：

```
// DESEDE, not DESEDE/CBC!!!
var cipher = CipherUtilities.GetCipher("DESEDE");
byte[] byte_key = Encoding.UTF8.GetBytes(string_key);
var param_key = new DesEdeParameters(byte_key);
byte[] data = Encoding.UTF8.GetBytes(string_data);
cipher.Init(true, param_key);
var data_encrypted = cipher.DoFinal(data); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:52:50.440

这是带有 PKCS#5 填充的 3DES Encrypt-Decrypt-Encrypt 密码，BouncyCastle 应该支持它（搜索 3DES ECB）。SecureBlackbox 库也支持它（但是，它是商业的）。**

# javascript - AngularJs ReferenceError：角度未定义

> ID：14260399
> 
> 赞同：16
> 
> 时间：2013-01-10T14:40:54.277
> 
> 标签：javascript, angularjs, singlepage

我尝试添加自定义过滤器，但如果我使用以下代码：

```
angular.module('myApp',[]).filter('startFrom', function() {
    return function(input, start) {
        start = +start; //parse to int
        return input.slice(start);
    }
}); 
```

但如果我这样做，我会在 firebug 中得到：“ReferenceError: angular is not defined”。

应用程序的其余部分工作正常，我在标签 div 中使用 ng-app，而不是在标签 html 中，以及[https://ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular.js](https://ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular.js)

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-04-12T15:20:16.230

在包含任何其他 js 文件之前，您应该首先放置包含角度线

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-11-02T17:48:33.927

由于本地与远程引用，我遇到了类似的问题

```
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.3/angular.js"></script>
<script src="lib/js/ui-grid/3.0.7/ui-grid.js"></script> 
```

由于 ui-grid.js 依赖于 angular.js，所以 ui-grid 在加载时需要 angular.js。但在上述情况下，ui-grid.js [本地保存的参考文件]在加载 angularjs [来自互联网]之前加载，

> 如果我在本地引用了 angular.js 和 ui-grid 并且在 ui-grid 之前声明了 angular.js，问题就解决了

```
<script src="lib/js/angularjs/1.4.3/angular.js"></script>
<script src="lib/js/ui-grid/3.0.7/ui-grid.js"></script> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-23T13:08:33.567

好吧，这是一个单页应用程序，使用的解决方案是：

像任何其他控制器一样，使用 AJAX 加载内容，然后调用：

```
angular.bootstrap($('#your_div_loaded_in_ajax'),["myApp","other_module"]); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-11-02T11:48:47.397

始终确保在 HTML 文件中首先引用 js 文件 (angular.min.js)。例如：

----------------- 这个引用会**抛出**错误 -------------------------

```
< script src="otherXYZ.js"></script>
< script src="angular.min.js"></script> 
```

----------------- 此参考将按预期**工作-----------------**

```
< script src="angular.min.js"></script>
< script src="otherXYZ.js"></script> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-10T16:25:40.417

正如评论中已经提到的@bmleite，您可能忘记加载 angular.js。

如果我在其中创建一个带有角度指令的小提琴，但不包含 angular.js，我会在 Chrome 控制台中得到完全相同的错误：`Uncaught ReferenceError: angular is not defined`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-25T02:22:53.767

如果您碰巧正在使用 rails 和 angular-rails gem，那么通过将缺少的行添加到 application.js （或适用于您的情况的任何内容）可以轻松纠正问题：

```
//= require angular-resource 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-09-05T19:20:11.903

我遇到了这个问题，因为我在 Mac 上将 ngBoilerplate 复制并粘贴到我的项目中，而 Finder 没有显示隐藏文件。所以 .bower 没有与 ngBoilerplate 的其余部分一起复制。因此 bower 将资源移动到 bower_components （默认）而不是 vendor （如配置），并且我的应用程序没有角度。可能是一个极端案例，但它可能会帮助这里的人。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-23T20:53:10.373

我认为如果您在使用 angularjs 时对（包含过滤器的文件）使用“async defer”，就会发生这种情况：

```
<script src="js/filter.js" type="text/javascript" async defer></script> 
```

如果你这样做，只需删除“异步延迟”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-02-20T12:31:32.430

如果您从 Google 下载了 angular.js 文件，则需要确保每个人都具有**读取权限**，否则您的 HTML 文件将不会加载该文件。默认情况下，它似乎是在*没有访问*权限的情况下下载的，因此您还会收到如下消息：

> 获取[http://localhost/myApp/js/angular.js](http://localhost/myApp/js/angular.js)

这让我抓狂了半个小时！

# python - 如何计算文件中有多少行是相同的？

> ID：14260406
> 
> 赞同：6
> 
> 时间：2013-01-10T14:41:19.823
> 
> 标签：python, file, count, comparison

我有一个格式如下的文本文档：

```
-1+1
-1-1
+1+1
-1-1
+1-1
... 
```

我想要一个程序来计算有多少行有-1+1行和+1-1行。然后程序只需要返回有多少行是这样的值。

我已经写了代码：

```
f1 = open("results.txt", "r")
fileOne = f1.readlines()
f1.close()

x = 0
for i in fileOne:
    if i == '-1+1':
        x += 1
    elif i == '+1-1':
        x += 1
    else:
        continue

print x 
```

但由于某种原因，它总是返回 0，我不知道为什么。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-10T14:42:50.827

改用[`collections.Counter`](http://docs.python.org/2/library/collections.html#collections.Counter)：

```
import collections

with open('results.txt') as infile:
    counts = collections.Counter(l.strip() for l in infile)
for line, count in counts.most_common():
    print line, count 
```

最重要的是，在计算行数时删除空格（特别是换行符，但任何其他空格或制表符也可能会干扰）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-10T14:43:07.513

`.readlines()`留在行中，这`\n`就是他们不匹配的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T16:36:35.653

如果您不想导入模块，请享受简短的代码，并喜欢一些“列表”理解：

```
with open('results.txt') as infile:
    counts = { key: infile.count(key) for key in ['-1+1', '+1-1'] } 
```

然后当然可以`counts`作为 dict访问

# java - 创建图像的可点击按钮

> ID：14260408
> 
> 赞同：0
> 
> 时间：2013-01-10T14:41:21.730
> 
> 标签：java, image, swing, jbutton

> **可能重复：**
> [在面板中添加一个复杂的图像，并在一个自定义用户界面中围绕它的按钮](https://stackoverflow.com/questions/10861852/add-a-complex-image-in-the-panel-with-buttons-around-it-in-one-customized-user)

我正在创建一个应用程序，它获取图像并在图像上施加类似网格的外观（请参阅将[图像拆分为可点击区域](https://stackoverflow.com/questions/12418618/split-image-into-clickable-regions)）

现在我的问题是如何使此图像（在施加网格后）可点击。

[换句话说，应用网格后图像的各个子部分必须成为可点击按钮]。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T14:54:07.083

目前尚不清楚您所说的“可点击按钮”是什么意思

如果您想拥有带有内部图像的真实按钮，那么不要`JLabel`create `JButton`：

```
buttons[i] = new JButton(new ImageIcon(Toolkit.getDefaultToolkit().createImage(imgs[i].getSource())));
frame.getContentPane().add(labels[i]); 
```

然后添加`ActionListener`覆盖`actionPerformed()`

如果您希望它是标签，但可单击，则添加`MouseListener`到每个`JLabel`覆盖`mousePressed`或`mouseClicked`取决于所需的行为。

# android - getRootView() 不工作

> ID：14260411
> 
> 赞同：2
> 
> 时间：2013-01-10T14:41:30.997
> 
> 标签：android, android-layout

这是我的 xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@color/background"
android:orientation="vertical"
android:padding="15dip" >

<ListView
    android:id="@android:id/list"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
</ListView> 
```

现在在我的代码中，我想更改窗口的背景颜色，我这样做是这样的：

```
ListView listview = (ListView) findViewById(android.R.id.list);
View root = listview.getRootView();
root.setBackgroundColor(Color.parseColor("#bdbdbd")); 
```

如果我理解正确，这应该会更改列表视图父级（在本例中为 LinearLayout）的背景颜色。但是这不起作用，我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T14:47:19.510

我认为您很困惑， getRootView() 不会为您提供 LinearLayout，而是该视图的父级。请参阅[另一个问题](https://stackoverflow.com/questions/4486034/get-root-view-from-current-activity)。你应该`listview.getParent()`改用；请注意，它需要被铸造。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:47:28.117

尝试使用[`getParent()`](http://developer.android.com/reference/android/view/View.html#getParent%28%29)代替`getRootView()`来获取周围的实例`LinearLayout`..

# ksh - grep 输出放入 while 循环

> ID：14260416
> 
> 赞同：0
> 
> 时间：2013-01-10T14:41:43.730
> 
> 标签：ksh, do-while, grep

我目前将我的 grep 输出配置为将所有内容都放在一个文件中，我正在尝试在不需要创建文件的地方进行设置。

```
 func_database () {
egrep "^[0-9]" file.txt | egrep "/ON /" | sed s/-[^@]*$// > /users/home/myhome/log/test.txt
}

                                    func_database
            while read -r line ; do
                                    echo "Database $line Area a:" 
            python amgr.py status $line a
            echo ""
                        echo "Database $line Area b:" 
            python amgr.py status $line b
            echo ""
                        echo "Database $line Area c:" 
            python amgr.py status $line c
            echo ""
            done </users/home/myhome/log/test.txt 
```

以上是我当前的设置，无论如何我可以设置一些东西，在 while;do 函数中运行它之前我不需要将此信息发送到 test.txt 文件。python 脚本只会在屏幕上输出状态。test.txt 文件包含以行分隔的数字列表，例如

```
0
15
32
78
95 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:45:37.980

将您的输出直接通过管道传输到`while`：

```
func_database () {
    egrep "^[0-9]" file.txt | egrep "/ON /" | sed s/-[^@]*$//
}
func_database |
while read -r line
do
    echo "Database $line Area a:" 
    python amgr.py status $line a
    echo ""
    echo "Database $line Area b:" 
    python amgr.py status $line b
    echo ""
    echo "Database $line Area c:" 
    python amgr.py status $line c
    echo ""
done 
```

# azure-sql-database - 使用来自 Starbucks 的 SQL Azure

> ID：14260425
> 
> 赞同：2
> 
> 时间：2013-01-10T14:42:10.513
> 
> 标签：azure-sql-database

我有一个 SQL Azure 数据库。出于某种原因，我在家时可以使用它，但在星巴克时却不行。我可以通过 Windows Azure 门户提供的基于 Web 的工具成功登录并“管理”它。然而：

1.  当我的 Web 应用程序尝试访问数据库时，我收到一条错误消息：

    *提供程序未返回 ProviderManifestToken 字符串。*

2.  当我尝试从 SQL Management Studio 访问数据库时，我收到以下错误：

> *无法连接到 tcp:[serverName],[number]。
> 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：TCP Provider，错误：0 - 连接尝试失败，因为连接方在一段时间后没有正确响应，或建立连接失败，因为连接的主机没有响应。）（Microsoft SQL Server，错误：10060）*

我知道我的 IP 地址没有被封锁，因为如前所述，我可以使用基于 Web 的工具。我知道数据库设置正确，因为我可以在家中使用它。然而，当我似乎试图在当地的任何一家咖啡店工作时，我就陷入了困境。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T01:44:42.797

基于 Web 的 Azure 门户不使用您的本地 IP 地址连接到您的数据库，它使用托管门户的服务器的 IP 地址。

由于您从咖啡店获得了一个新 IP，因此您可以将其添加到 Azure SQL 防火墙中，或者将您的 Azure SQL 开放给所有 IP。

如果这不起作用，那么您当地的咖啡店可能有防火墙设置阻止端口 1433...

# jquery - 如何选择和取消选择选择框中的所有选项

> ID：14260428
> 
> 赞同：11
> 
> 时间：2013-01-10T14:42:14.900
> 
> 标签：jquery, html

```
<select name="remaintextarea" id="studentremain" size="10">
    <option value="one">One</option>
    <option value="two">Two</option>
    <option value="three">Three</option>
</select>

<button type='button' id='selectall'>Select All</button>
<button type='button' id='deselectall'>De-Select All</button> 
```

上面有一个选择框，选择全部并取消选择上面的所有按钮。我的问题是通过使用jquery，当点击相关按钮时，如何让按钮选择所有选项并取消选择上面选择框中的所有选项？

下面我只有两个按钮的点击处理程序：

```
$('#selectall').click(function() {

});   

$('#deselectall').click(function() {

}); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-10T14:46:33.050

您需要将`multiple`属性添加到 select 元素，然后您可以：

```
$('#selectall').click(function() {
    $('select#studentremain option').attr("selected","selected");
});   

$('#deselectall').click(function() {
    $('select#studentremain option').removeAttr("selected");
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-10T14:47:06.900

试试这个[演示](http://jsfiddle.net/WFgdk/)

必须在选择元素中添加 multiple="multiple"

HTML：

```
<select multiple="multiple" name="remaintextarea" id="studentremain" size="10">
    <option value="one">One</option>
    <option value="two">Two</option>
    <option value="three">Three</option>
</select>
<button type='button' id='selectall'>Select All</button>
<button type='button' id='deselectall'>De-Select All</button> 
```

JS：

```
$('#selectall').click(function() {
    $('#studentremain > option').attr("selected", "selected");
});   

$('#deselectall').click(function() {
    $('#studentremain > option').removeAttr("selected");
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-12-19T11:10:42.947

不知何故，上面的答案对我不起作用。似乎您必须使用属性而不是属性。这是代码：

```
$('#selectall').click(function() {
    $('select#studentremain option').prop("selected",true);
});   

$('#deselectall').click(function() {
    $('select#studentremain option').prop("selected",false);
}); 
```

文档说该`selected`属性仅指定`option`在页面加载时应预先选择一个。但在用户选择实际时不设置`option`。 [来源](https://www.w3schools.com/tags/tag_option.asp)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-10T14:51:18.227

*首先将multiple*属性添加到您的选择框，以便您可以选择多个值，然后这样的东西就足够了，因为您使用的是 jQuery。

```
//for selection of all.
$('#studentremain option').attr('selected','selected');

//for removal of selection.
$('#studentremain option').removeAttr('selected'); 
```

您可以尝试使用*prop*和*removeProp*代替 attr。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-12T21:48:50.157

> 大多数答案都已过时，这里以两种不同的方式选择和取消选择

```
$('#selectall').click(function() {
    $("#studentremain option").prop("selected", true);
});   

$('#deselectall').click(function() {
    $("#studentremain option").val([]);
}); 
```

# java - 如何向后移植 6.1.1 jsf portlet 以使其在 6.1.0 liferay 门户上运行？

> ID：14260442
> 
> 赞同：0
> 
> 时间：2013-01-10T14:42:54.010
> 
> 标签：java, exception, liferay, portlet, classnotfoundexception

我正在尝试在 6.1.0 Liferay CE 门户上运行 6.1.1 Portlet。JSF Portlet 使用 ServiceBuilder 和 Liferay 的许多其他 Util API 类。

我认为最好的办法是使用正确的 liferay-plugins-sdk 重新编译 portlet。下载 6.1.0 SDK 后，在 eclipse 项目中替换它并重建它，我得到了几个异常。它们在启动服务器后立即发生。

```
org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Bean class [com.liferay.portal.kernel.spring.util.SpringFactoryUtil] not found
Offending resource: ServletContext resource [/WEB-INF/classes/META-INF/cluster-spring.xml]
Bean ''; nested exception is java.lang.ClassNotFoundException: com.liferay.portal.kernel.spring.util.SpringFactoryUtil
    at org.springframework.beans.factory.parsing.FailFastProblemReporter.error(FailFastProblemReporter.java:68)
    at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:85)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.error(BeanDefinitionParserDelegate.java:291)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseBeanDefinitionElement(BeanDefinitionParserDelegate.java:491)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseBeanDefinitionElement(BeanDefinitionParserDelegate.java:396)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseBeanDefinitionElement(BeanDefinitionParserDelegate.java:365)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.processBeanDefinition(DefaultBeanDefinitionDocumentReader.java:258)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseDefaultElement(DefaultBeanDefinitionDocumentReader.java:153)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:132)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:93)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:143)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:178)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:149)
    at com.liferay.portal.spring.context.PortletApplicationContext.loadBeanDefinitions(PortletApplicationContext.java:76)
    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:93)
    at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:130)
    at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:467)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:397)
    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:282)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:204)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:47)
    at com.liferay.portal.spring.context.PortletContextLoaderListener.contextInitialized(PortletContextLoaderListener.java:99)
    at com.liferay.portal.kernel.servlet.PortalClassLoaderServletContextListener.doPortalInit(PortalClassLoaderServletContextListener.java:91)
    at com.liferay.portal.kernel.util.BasePortalLifecycle.portalInit(BasePortalLifecycle.java:42)
    at com.liferay.portal.kernel.util.PortalLifecycleUtil.register(PortalLifecycleUtil.java:61)
    at com.liferay.portal.kernel.util.PortalLifecycleUtil.register(PortalLifecycleUtil.java:53)
    at com.liferay.portal.kernel.util.BasePortalLifecycle.registerPortalLifecycle(BasePortalLifecycle.java:52)
    at com.liferay.portal.kernel.servlet.PortalClassLoaderServletContextListener.contextInitialized(PortalClassLoaderServletContextListener.java:50)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4765)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5260)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.startup.HostConfig.checkResources(HostConfig.java:1362)
    at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1450)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:295)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1338)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1496)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1506)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1485)
    at java.lang.Thread.run(Thread.java:680)
Caused by: java.lang.ClassNotFoundException: com.liferay.portal.kernel.spring.util.SpringFactoryUtil
    at java.lang.ClassLoader.findClass(ClassLoader.java:358)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    at com.liferay.portal.spring.util.FilterClassLoader.loadClass(FilterClassLoader.java:41)
    at org.springframework.util.ClassUtils.forName(ClassUtils.java:257)
    at org.springframework.beans.factory.support.BeanDefinitionReaderUtils.createBeanDefinition(BeanDefinitionReaderUtils.java:63)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.createBeanDefinition(BeanDefinitionParserDelegate.java:616)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseBeanDefinitionElement(BeanDefinitionParserDelegate.java:472)
    ... 41 more 
```

有人有好主意吗？我也在官方论坛上发布了这个问题，但也许在这里我接触到了更多的人......

这是论坛的链接：[http ://www.liferay.com/community/forums/-/message_boards/message/19124222](http://www.liferay.com/community/forums/-/message_boards/message/19124222)

**==== 更新 1====**

为了解决上述异常，我再次在 6.1.0 portlet 中运行了服务构建器。

现在可以使用 portlet 启动服务器，但 portlet 在门户中不可见/不可用以添加到页面中，并且我得到以下**ClassNotFoundException: PortletBeanLocatorUtil**：

```
12:24:06,627 ERROR [PortletContextLoaderListener:132] java.lang.ClassNotFoundException: com.liferay.util.bean.PortletBeanLocatorUtil
java.lang.ClassNotFoundException: com.liferay.util.bean.PortletBeanLocatorUtil
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1688)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1533)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:247)
    at com.liferay.portal.spring.context.PortletContextLoaderListener.contextInitialized(PortletContextLoaderListener.java:118)
    at com.liferay.portal.kernel.servlet.PortalClassLoaderServletContextListener.doPortalInit(PortalClassLoaderServletContextListener.java:91)
    at com.liferay.portal.kernel.util.BasePortalLifecycle.portalInit(BasePortalLifecycle.java:42)
    at com.liferay.portal.kernel.util.PortalLifecycleUtil.flushInits(PortalLifecycleUtil.java:45)
    at com.liferay.portal.servlet.MainServlet.initPlugins(MainServlet.java:813)
    at com.liferay.portal.servlet.MainServlet.init(MainServlet.java:347)
    at javax.servlet.GenericServlet.init(GenericServlet.java:160)
    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1185)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1080)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5001)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5289)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:866)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:842)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:615)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:649)
    at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1581)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:439)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680) 
```

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T16:36:07.690

在 6.1.0 sdk 中重新编译 portlet 可能更容易。特别是当您使用 ServiceBuilder 时：您正在使用可能依赖运行时文件的代码生成器运行，这些运行时文件将运行时与生成的代码相匹配。

对于纯 JSR-286 portlet，它们即使跨主要版本也很容易兼容。如果您使用更复杂的代码，例如 ServiceBuilder 或 API，需要付出很多努力来保持它的兼容性，但不能保证它实际上是二进制兼容的 - 抱歉，这就是生活。

对于 Liferay 自己的插件，您被要求使用匹配的版本——它们在更新之间没有经过测试。他们很可能也使用 ServiceBuilder 和 API。

# python - 如何使用 Flask 上传带有文本参数的图像

> ID：14260447
> 
> 赞同：0
> 
> 时间：2013-01-10T14:43:17.237
> 
> 标签：python, flask, http-post

我想将图像和一些文本参数一起发送到 Flask 服务器（HTTP POST）。

如何使用 Flask 接收两者（例如保存图像并打印文本）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:19:59.647

`request.data`像任何其他表单数据一样访问它们。

# c++ - 在 Xcode 4 中使用 ccache

> ID：14260448
> 
> 赞同：5
> 
> 时间：2013-01-10T14:43:18.407
> 
> 标签：c++, gcc, xcode4, g++, ccache

有没有办法将 ccache 与 Xcode 4 一起使用，以改善 C++ 构建时间？

使用环境变量我已将 CC 和 CXX 设置为 ccache，但构建失败，因为 ccache 无法识别 Xcode 4 输出的某些参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T16:49:55.080

Ccache 从[3.2](https://ccache.dev/releasenotes.html#_ccache_3_2)及更新版本开始支持 Clang。

有关如何在 Xcode 中使用 ccache 的可能解决方案，请参见此处： [https ://pspdfkit.com/blog/2015/ccache-for-fun-and-profit/](https://pspdfkit.com/blog/2015/ccache-for-fun-and-profit/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-10T22:16:06.300

[这个答案](https://stackoverflow.com/a/36515503/1938798)`CC`显示了一种技术，通过在 Xcode 项目中设置和`CXX`用户定义的变量，可以将 ccache 与 Xcode 一起使用。该特定答案是使用 CMake 创建 Xcode 项目文件，但同样的原则适用于手动创建的 Xcode 项目。`CC`和变量的作用类似于对所使用的编译器的`CXX`覆盖，因此将它们转移到一个包装脚本，该脚本使用您想要的编译器调用 ccache 来实现所需的功能。请注意，我只使用 Xcode 7 对其进行了测试，但我希望早期版本也可以工作。[Peter Steinberger 的这篇文章](https://pspdfkit.com/blog/2015/ccache-for-fun-and-profit/)也基本上涵盖了您在不使用 CMake 的情况下想要的功能，但它使用了相同的设置技术`CC`和`CXX`Xcode 项目变量。

# vb.net - 为什么我用 regedit.exe 更改了 rgistry 后，registryKey.GetValue 仍然读取旧值？

> ID：14260453
> 
> 赞同：0
> 
> 时间：2013-01-10T14:43:32.990
> 
> 标签：vb.net, registry

所以我使用以下代码访问注册表值：

```
Dim dm2 As RegistryKey
Dim dm2Value As String = 0

dm2 = Registry.LocalMachine.OpenSubKey("Software\Libralex\DM")
If dm2 IsNot Nothing Then
    dm2Value = DirectCast(dm2.GetValue("DM2"), String)
End If 
```

最初我将“1”存储为 DM2 下的值，它运行良好:) 所以我关闭程序并使用 regedit.exe 将 DM2 的值更改为“2”，但我一直从 dm2 获得“1”。 getValue :( 我想也许重新启动会解决问题，但是我仍然从 dm2.GetValue 得到一个“1”，而 regedit.exe 告诉我我有一个 2 存储在那里。

我究竟做错了什么？

环境信息：64 位 Windows 7 上的 Visual Studio 2010

# linux - KSH 中包装脚本的退出状态不正确

> ID：14260454
> 
> 赞同：2
> 
> 时间：2013-01-10T14:43:41.647
> 
> 标签：linux, shell, wrapper, ksh, teradata

我们有一个 Teradata TPT 实用程序的包装脚本。包装器脚本非常简单，但问题是包装器的退出状态与实用程序的退出状态不同。在许多情况下，即使实用程序失败，脚本也会返回 0。我已将退出状态保存在一个单独的变量中，因为在退出之前需要完成一些步骤，但使用此变量的值退出似乎不起作用。或者即使日志清楚地指定了其他状态，即使在某些失败的情况下，实用程序也会返回状态 0？

更糟糕的是，这种行为是非常随机的，有时脚本会因实用程序的退出状态而失败。我想确定实用程序的退出状态是否存在问题。

该脚本通过 KSH 运行。包装脚本的最后一部分是：

```
tbuild -f $sql.tmp -j ${id}_$JOB >$out 2>&1
ret_code=$?

cd ${TWB_ROOT}/logs
logpath=`ls -t ${TWB_ROOT}/logs/${id}_${JOB}*.out |head -1`
logpath1=${logpath##*/}
logname=${logpath1%-*}

tlogview -l ${logpath} > /edw/$GROUP/tnl/jobs/$JOB/logs/tpt_logs/${logname}.log

###Mainting 3 tpt binary log files
if [ $ret_code -eq 0 ] 
then 
    binout=$TPTLOGDIR/${logname}.dat
    binout1=$TPTLOGDIR/${logname}.dat1
    binout2=$TPTLOGDIR/${logname}.dat2

    [ -f $binout1 ] && mv $binout1 $binout2
    [ -f $binout ]  && mv $binout  $binout1

    mv "$logpath" "/edw/${GROUP}/tnl/jobs/$JOB/logs/tpt_logs/${logname}.dat"
fi

rm -f $sql.tmp
echo ".exit"
exit $ret_code 
```

提前感谢您的帮助和建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-15T23:57:51.827

`tbuild`该脚本看起来不错，并且确实应该返回与该实用程序相同的退出代码。

它归结为对特定产品的了解。

我从未使用过这些产品中的任何一个，但 Teradata 有一个充足的 Parallel Transporter 用户指南，其中包含明确[的工作后注意事项](http://www.info.teradata.com/HTMLPubs/DB_TTU_14_00/index.html#page/Load_and_Unload_Utilities/B035_2445_071A/2445ch10.117.01.html)部分，警告：

> 即使作业成功完成，仍可能需要根据作业日志和错误表中的错误和警告信息采取措施。

所以从技术上讲，一项工作可能会完成，但结果可能会不时发生变化。

我想您必须定义自己的策略并扫描日志文件以查找警告和错误消息的模式，然后为语义失败生成您自己的退出代码。类似`logstash`或`splunk`可能会派上用场的工具。

* * *

顺便说一句，您可能会考虑`logrotate`用于旋转`$TPTLOGDIR/${logname}.dat`文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-04T10:21:33.360

事实证明，问题出在实用程序本身，正如所怀疑的那样。Shell 脚本运行良好。

# jquery - AJAX 请求变量问题

> ID：14260457
> 
> 赞同：0
> 
> 时间：2013-01-10T14:43:44.740
> 
> 标签：jquery, ajax, variables, callback, global-variables

> **可能重复：**
> [jQuery 全局变量问题](https://stackoverflow.com/questions/2366113/jquery-global-variable-problem)

我正在做一个 jQuery AJAX 调用，我想将响应保存到一个变量中。但是，此变量不具有 AJAX 调用函数之外的响应值。如何在 AJAX 调用函数之外获得响应？

例子：

```
var responseText = '';
$.ajax({
    url: 'clients_handler.php',
    type: 'post',
    data: { action: 'check_email', email: email },
    success: function(data) {
        responseText = jQuery.parseJSON(data);
    }
});
console.log(responseText); 
```

因此，在我的示例`responseText`中，AJAX 函数之前设置为空。如何使用 AJAX 响应值设置此变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:51:11.513

您无法以您想要的方式保存变量，因为它位于闭包内。您可以做的最好的事情是将响应数据传递给将在请求完成后执行的函数。这是一个例子：

```
//code
$.ajax({
    url: 'clients_handler.php',
    type: 'post',
    data: { action: 'check_email', email: email },
    success: function(data) {
        responseHandler(data);
    }
});

function responseHandler(data){
    console.log(data);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:51:51.787

简单的答案是 ajax 异步触发。本质上，这意味着您不知道 ajax 代码何时完成，因此调用*之后*`$.ajax`的任何代码行都可能在完成之前执行`$.ajax`（但不一定）。这就是*为什么*需要 ajax 回调的原因。

一种解决方案是使用`jQuery.ajax`option使 ajax 请求同步`async: false`，但这可能不是我们所希望的。

`responseText`真正的解决方案是适当地使用回调——在函数中做所有你需要做的工作`success:`。

不喜欢将所有代码集中在一个地方？jQuery 很好地创建了 Deferred 并`jqxhr`实现了它：

```
var jqxhr = $.ajax({url: url, data: data});
//thousands of lines of code here
$.when(jqxhr).done(function (responseText) { console.log(responseText); }); 
```

# java - Spring Security 不拦截

> ID：14260462
> 
> 赞同：0
> 
> 时间：2013-01-10T14:44:00.527
> 
> 标签：java, spring-mvc, spring-security

运行应用程序时，它的行为就像没有过滤器一样，我可以像往常一样访问所有页面。

Web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>SpringMVCTest</display-name>

    <servlet>
        <servlet-name>springMVCTest</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>springMVCTest</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>

    <listener>
        <listener-class>
            org.springframework.web.context.ContextLoaderListener
        </listener-class>
    </listener>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/springMVCTest-security.xml</param-value>
    </context-param>

</web-app> 
```

springMVCTest-Security.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns="http://www.springframework.org/schema/security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/security 
    http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <http auto-config="true">
        <intercept-url pattern="/**" access="ROLE_ADMIN" />
    </http>

    <authentication-manager>
        <authentication-provider>
            <user-service id="userService">
                <user name="admin" password="admin" authorities="ROLE_ADMIN" />
            </user-service>
        </authentication-provider>
    </authentication-manager>
</beans:beans> 
```

由于所有配置都在这些文件中，因此我发布它们只是为了让事情变得简单。我假设问题一定出在这两者之一。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T14:54:54.827

您的 spring 安全过滤器未映射到任何 URL。只需将映射添加到您的 web.xml：

```
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

# css - 第一个图像的 CSS 选择器，仅当第一个孩子

> ID：14260470
> 
> 赞同：10
> 
> 时间：2013-01-10T14:44:25.970
> 
> 标签：css, css-selectors

有谁知道是否可以定义一个 CSS 选择器来选择 div 中的第一个图像，但前提是它是 div 中的第一个子图像。

在 jQuery 中，我会使用类似这样的比较...

```
if ($('#div img:first-child') == $('#div>*:first-child')) {
  ...
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-10T14:54:55.357

[根据 "first-child"](http://www.w3.org/TR/CSS2/selector.html#first-child)的定义，选择器（假设你`div`有一个`id`of `div`）

```
#div img:first-child 
```

已经这样做了。任何的第一张图片`div`是

```
div img:first-child 
```

但是，正如 BoltClock 的回答所指出的，如果您可能将`img`元素嵌套在`div`.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-10T14:54:38.510

如果您只想选择`img`. 只需像这样组合您的两个选择器：

```
#div > img:first-child 
```

这适用于 jQuery 和 CSS。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T14:46:07.980

这是一个简单的 CSS 选择器：

```
#div:first-child img:first-child 
```

# java - 应用程序中的选项卡栏图标与选项卡文本重叠

> ID：14260473
> 
> 赞同：0
> 
> 时间：2013-01-10T14:44:32.490
> 
> 标签：java, android, actionbarsherlock

我在应用程序中实现了一些选项卡栏图标，但它们似乎与选项卡文本重叠。

![选项卡中的图标和说明](../Images/d6b36e411e6ff20859485375a5483e0a.png)

我究竟做错了什么？这是一些代码：

```
public class MyActivity extends SherlockFragmentActivity {
    FragmentTabHost mTabHost = (FragmentTabHost) findViewById(android.R.id.tabhost);
    mTabHost.setup(this, getSupportFragmentManager(), R.id.realtabcontent);
    mTabHost.addTab(mTabHost.newTabSpec("TeamsFragment").setIndicator("Teams",
    getResources().getDrawable(R.drawable.tab_bar_icon_teams_2x)), BaseFragment.class, null);
}

public class BaseFragment extends SherlockFragment {
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:50:54.253

尝试使用类似的布局管理器`MigLayout`- 这样您就可以准确说明您希望图标/按钮的外观以及它们应该放在哪里。如果你不使用某种布局管理器，你会遇到很多问题......

从这里开始：http: [//www.miglayout.com/QuickStart.pdf](http://www.miglayout.com/QuickStart.pdf)

# eclipse - java VisualVM下如何执行eclipse

> ID：14260474
> 
> 赞同：1
> 
> 时间：2013-01-10T14:44:32.643
> 
> 标签：eclipse, visualvm, jvisualvm

我为我的项目开发了几个插件，我认为我有一些漏洞，因为我的 Eclipse 在长时间使用后会变慢，所以我想对其进行分析。我可以从 Eclipse 运行 Eclipse（在插件开发模式下）并将其连接到 JVM，但是在长时间的“正常”开发之后会出现问题（缓慢的 Eclipse），所以我想启动我的“正常”Eclipse 并连接到 VisualVM。问题是eclipse出现在VisualVM中，我无法以任何方式分析它（我只看到加载的类、堆和线程的数量）。

我的 JAVA_HOME 设置为 JDK，我将相同的 JDK 放在 -vm 参数下的 eclipse.ini 中，并从同一个 JDK 启动 VisualVM。

有人知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T09:21:30.677

你在使用 Windows 吗？看起来 VisualVM 在 32 位 JDK 下运行，而 Eclipse 在 64 位 JDK 上运行（反之亦然）。在 VisualVM 中打开 Eclipse 和 VisualVM 时检查“概述”选项卡。这将告诉您使用的是哪个 JDK。

# windows - QDialog 不是这样的文件或目录 - Qt Windows

> ID：14260475
> 
> 赞同：12
> 
> 时间：2013-01-10T14:44:34.220
> 
> 标签：windows, qt, qt-creator

我刚刚安装了基于 Qt 5.0 的 Qt Creator 2.6.1。

我正在尝试打开一个在 4.8 上制作的项目，但我无法编译它。它不断向我显示“不是这样的文件或目录”的错误。

```
error: C1083: Cannot open include file: 'QtGui/QApplication': No such file or directory 

error: C1083: Cannot open include file: 'QDialog': No such file or directory 

error: C1083: Cannot open include file: 'QMainWindow': No such file or directory 

error: C1083: Cannot open include file: 'QWidget': No such file or directory 
```

还有很多。

我将 qmake.exe 路径添加到 PATH...我需要做其他事情吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-10T15:10:07.140

`Qt4`阅读从到的过渡指南`Qt5`。[链接1 链接2](http://qt-project.org/wiki/Transition_from_Qt_4.x_to_Qt5) [链接](http://www.kdab.com/porting-from-qt-4-to-qt-5/) [3](http://qt-project.org/doc/qt-5.0/qtdoc/portingcppapp.html)

> 与 Qt 4 相比，Qt 5 的主要内部基础结构变化之一是将小部件从 QtGui 模块拆分为新的 QtWidgets 模块。这显然至少需要更改构建系统，但也导致下游需要为以前不需要的标头添加包含，因为这些包含已从现在保留在 QtGui 模块中的标头中删除。
> 
> 从 Qt 4 移植到 Qt 5 的另一个与包含相关的问题是处理已移动到 QtWidgets 模块的类的包含。而基于 Qt 4 的代码可能会使用

```
#include <QtGui/QWidget>
This must be updated to either

#include <QtWidgets/QWidget>
Or more portably (Which works in Qt 4 and Qt 5):

#include <QWidget> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-06T10:03:29.217

我有这个问题，做了两个改变

1.  echo "QT += 小部件" >> /fileProject.pro

2.  在包含 QDialog 声明的文件中添加#include QDialog

以前包含 QtGui 就足够了，但 QT5 将小部件拆分为更多的 .h 文件，因此有必要包含它们。例如 QtMenuBar 被包含在 QtMenu.h 但现在它需要 QtMenuBar.h 是#included

# javascript - jQuery 回调累积

> ID：14260486
> 
> 赞同：0
> 
> 时间：2013-01-10T14:45:20.490
> 
> 标签：javascript, jquery

我正在构建一个名为 magicForm 的简单 jQuery 插件（这有多荒谬？）。现在面对一个我认为我没有正确解决的问题。

我的插件应该应用在一个容器元素上，当用户填写它们时，它将一一显示它的每个输入。这不是我的问题的确切目的。每次初始化容器时，我都会声明一个事件点击回调。让我举个例子。

```
(function($){
  var methods = {
    init: function(options){
      return this.each(function(){
        var form, inputs;

        var settings = {
          debug: false
        };
        settings = $.extend(settings, options);
        form = $(this);

        $('a.submit', form).on('click', function(event){
          if (settings.submitCallback) {
            settings.submitCallback.call(form, inputs);
          }
          return false;
        });
      });
    },
    reset: function() {

    }
  }

  $.fn.magicForm = function(method) {
    if ( methods[method] ) {
      return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
    } else if ( typeof method === 'object' || ! method ) {
      return methods.init.apply( this, arguments );
    } else {
      $.error( 'Method ' +  method + ' does not exist.' );
    }
  };
})($); 
```

我专注于这段代码的特定部分：

```
$('a.submit', form).on('click', function(event){
    if (settings.submitCallback) {
        settings.submitCallback.call(form, inputs);
    }
    return false;
}); 
```

因为每次`init`调用该方法时，都会注册那个糟糕的回调。

当我在一个嵌套在 twitter 引导“选项卡”中的元素上调用我的插件时，我正在经历这种痛苦，它本身嵌套在一个引导模式中：`init`每次触发我的引导模式的“显示”事件时，我都在调用。

所以，这就是我在我的`init`方法中修复它的方式：

```
// Prevent callback cumulation
if (!$(this).data('form_initialized')) {
    $('a.submit', form).on('click', function(event){
        if (settings.submitCallback) {
            settings.submitCallback.call(form, inputs);
        }
        return false;
    });
    $(this).data('form_initialized', true);
} 
```

我对此还没有把握。

感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:51:48.613

您可以首先明确删除点击处理程序：

```
$('a.submit', form).off('click').on('click', function(event){ ... }) 
```

但是，我建议您使用事件命名空间来防止**所有**点击处理程序（甚至可能由您自己的代码设置的那些）被删除：

```
$('a.submit', form).off('click.magicForm').on('click.magicForm', function(event){ ... }) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:52:21.377

许多 jquery 插件`data`用来知道他们的插件是否被初始化。大多数情况下，他们使用自己插件的名称作为数据的一部分（或全部）。例如：

`$(this).data('magicForm')`

因此，您使用它来发出信号的方法还不错。

但是，您还有另外两个选择：

1) 拉出事件处理程序，使处理程序成为单个实例。在你的方法之上， do`var fnOnSubmit = function() { ... }` 然后你可以简单地通过在重新绑定之前调用来确保正确绑定，`$('a.submit', form).unbind('click', fnOnSubmit)`就像你已经在做的那样。

2) 另一种选择是使用事件命名空间。

`$('a.submit', form).unbind('click.magicForm');`然后用`.on('click.magicForm')` 这种命名空间方法重新绑定它，确保当你解除绑定时，它只会在你的命名空间magicForm的上下文中解除绑定，从而使所有其他点击事件（例如来自其他插件）保持不变。

我希望这有帮助。

# sharepoint - 动态 SPQuery

> ID：14260488
> 
> 赞同：0
> 
> 时间：2013-01-10T14:45:45.500
> 
> 标签：sharepoint, spquery

我想在这里讨论一个场景：我想通过使用动态 SPQuery 来构建搜索条件。在我的应用程序页面上，我有 2 个文本框、2 个组合框和一个人员选择器控件。根据用户，他们使用哪个控件的值来查看网格中的结果。可能是他们从部分或全部控件中放置/选择值进行搜索。我找不到构建此动态查询的有效方法。我需要好的例子或建议来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T09:33:15.907

您是否尝试[过 http://sharepointcamlhelper.codeplex.com/](http://sharepointcamlhelper.codeplex.com/)它是动态 sp 查询生成器

# c# - 使用从文件路径到图像的转换器时没有图像出现

> ID：14260506
> 
> 赞同：0
> 
> 时间：2013-01-10T14:46:28.070
> 
> 标签：c#, windows, image, xaml, datatemplate

我目前正在尝试在我的 Windows 8 应用程序中显示图像。`List<string>`我有一个方法，它用许多图像路径填充类型的属性。我希望在屏幕上显示这些图像。

因此，我实现了一个从字符串到图像的转换器。它正确进入转换器，在`Convert`方法中命中断点，但屏幕上仍然没有出现任何内容。

这是我的转换器的代码：

```
namespace TestApp.Converters
{
    public sealed class StringToImageConverter : IValueConverter
    {
        public object Convert(object value, Type targetType,
                              object parameter, string path)
        {
            try
            {
                return new BitmapImage(new Uri((string)value));
            }
            catch
            {
                return new BitmapImage();
            }
        }

        public object ConvertBack(object value, Type targetType,
                                  object parameter, string path)
        {
            throw new NotImplementedException();
        }
    }
} 
```

从我的 XAML 文件：

```
 <common:LayoutAwarePage
        ...
        xmlns:converters="using:TestApp.Converters"
         DataContext="{Binding RelativeSource={RelativeSource Self}}">
        <Page.Resources>
            <converters:StringToImageConverter x:Key="StringToImageConverter"> </converters:StringToImageConverter>
        </Page.Resources>
...
  <ItemsControl ItemsSource="{Binding Path=test}" Grid.Column="1" Grid.Row="3" Grid.ColumnSpan="4"
              HorizontalContentAlignment="Stretch">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Image Source="{Binding Converter={StaticResource StringToImageConverter}}" />
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
... 
```

`List<string>`图像路径的 被调用并且`test`位于 xaml 文件后面的代码中。

这是我在 xaml.cs 文件后面的代码中相关代码的简单版本：

```
 public List<string> test { get; set; }

    public MainPage()
    {
        test = new List<string>();
        test.Add("C:\\Users\user\\Pictures\\test.jpg");
        this.InitializeComponent();
    } 
```

非常感谢您对此提供的所有帮助:)

# c++ - 预期的常量表达式，无法分配常量大小为 0 的数组

> ID：14260507
> 
> 赞同：0
> 
> 时间：2013-01-10T14:46:30.300
> 
> 标签：c++, arrays, function

我正在尝试创建一个对象数组，如果我手动输入数组大小，它就可以正常工作，但是每当它尝试从函数 args 获取信息时，它都会给出错误“预期的常量表达式”和“无法分配数组恒定大小 0"。

我四处搜索并找到了多种解决方案，但没有一个对我有用。代码当前如下所示：

```
Array::Array(int in, int min, int max) 
{
    size = in;
    Heltal *htal[size];
} 
```

大小整数和 htal 对象在头文件中定义。

似乎导致问题的行是最后一行。这是什么原因造成的，我该如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T14:47:29.963

C++ 不支持 VLA（可变长度数组）。即使他们是，`a`是一个`vector`所以`Heltal *htal[a];`没有意义。

您可以使用 an`std::vector`而不是数组（有效大小）来解决此问题：

```
std::vector<Heltal*> htal(a.size() /*or whatever size you want*/); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:53:42.647

数组的大小必须是编译时常量，而`size`不是常量。您需要动态分配数组：

```
std::vector<Heltal *> htal(size); 
```

# c - 奇怪的变量行为 - Arduino Uno rev 3

> ID：14260511
> 
> 赞同：0
> 
> 时间：2013-01-10T14:46:37.443
> 
> 标签：c, arduino, buffer-overflow

我对 int 变量有非常奇怪的问题。有一个代码：

```
#include <EEPROM.h>
#define dht_dpin 14

byte bGlobalErr;
byte dht_dat[4];

int a;

void setup(){
    pinMode(13, OUTPUT);
    a = 0;
    InitDHT();
    Serial.begin(9600);
    delay(300);
    Serial.println("Humidity and temperature\n\n");
    delay(700);
} //end "setup()"

void loop()
{
    digitalWrite(13, HIGH);
    delay(300);
    digitalWrite(13, LOW);
    Serial.println(a);

    ReadDHT();

    switch (bGlobalErr) 
        {
            case 0:
                Serial.print("humdity = ");
                Serial.print(dht_dat[0], DEC);
                Serial.print(".");
                Serial.print(dht_dat[1], DEC);
                Serial.print("%  ");
                Serial.print("temperature = ");
                Serial.print(dht_dat[2], DEC);
                Serial.print(".");
                Serial.print(dht_dat[3], DEC);
                Serial.println("C  ");
                EEPROM.write(a, dht_dat[0]);
                EEPROM.write(a + 1, dht_dat[2]);

                break;
            case 1:
                Serial.println("Error 1: DHT start condition 1 not met.");
                break;
            case 2:
                Serial.println("Error 2: DHT start condition 2 not met.");
                break;
            case 3:
                Serial.println("Error 3: DHT checksum error.");
                break;
            default:
                Serial.println("Error: Unrecognized code encountered.");
                break;

    } //end "switch"

        a = a + 2;
        delay(10000);

} // end loop()

void InitDHT(){
    pinMode(dht_dpin,OUTPUT);
    digitalWrite(dht_dpin,HIGH);
} //end InitDHT

void ReadDHT(){
    bGlobalErr=0;
    byte dht_in;
    byte i;
    digitalWrite(dht_dpin,LOW);
    delay(18);
    delayMicroseconds(600);
    digitalWrite(dht_dpin,HIGH); 
    delayMicroseconds(40);
    pinMode(dht_dpin,INPUT);
    delayMicroseconds(40);

    dht_in=digitalRead(dht_dpin);

    if(dht_in) {
        bGlobalErr=1;
        return;
    } //end "if..."
    delayMicroseconds(80);

    dht_in=digitalRead(dht_dpin); //Was: dht_in = PINC & _BV(dht_PIN);

    if(!dht_in) {
        bGlobalErr=2;
        return;
    } //end "if..."

    delayMicroseconds(70);
    for (i=0; i<5; i++)
        dht_dat[i] = read_dht_dat();

    pinMode(dht_dpin,OUTPUT); //Was: DDRC |= _BV(dht_PIN);
    digitalWrite(dht_dpin,HIGH); //Was: PORTC |= _BV(dht_PIN);
    byte dht_check_sum =
            dht_dat[0]+dht_dat[1]+dht_dat[2]+dht_dat[3];
    if(dht_dat[4]!= dht_check_sum)
    {bGlobalErr=3; }
}; //end ReadDHT()

byte read_dht_dat(){
    byte i = 0;
    byte result=0;
    for(i=0; i< 8; i++) {
        while(digitalRead(dht_dpin)==LOW) ;
        delayMicroseconds(30);
        if (digitalRead(dht_dpin)==HIGH)
            result |=(1<<(7-i));
        while (digitalRead(dht_dpin)==HIGH) ;
    } //end of "for.."
    return result;
} //end of "read_dht_dat()" 
```

输出是：

```
Humidity and temperature

0
humdity = 49.0%  temperature = 22.0C  
73
humdity = 49.0%  temperature = 22.0C  
73
humdity = 49.0%  temperature = 22.0C  
73
humdity = 49.0%  temperature = 22.0C 
```

变量“a”在开始时被设置为“0”，然后不知何故它在 switch 部分的值是 71，有时但非常罕见的是 70 或 72，这更奇怪。我对 a 设置为 0 并递增的地方做了不同的组合。我在“a”旁边添加了变量“b”，并且“b”的行为正常。然后我在变量“b”的两个“EEPROM.write ...”命令中更改了变量“a”，程序运行良好。当我删除变量“a”时，变量“b”开始表现与变量“a”完全相同。

有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T14:55:58.190

这在之前声明的变量上具有缓冲区溢出的所有迹象`a`，特别是`byte dht_dat[4]`。尝试开始将其扩展到`byte dht_dat[8]`并查看您的问题是否不会消失。然后开始寻找您写入超过 4 个字节的位置`dht_dat`。

此外，线条

```
byte dht_check_sum =
        dht_dat[0]+dht_dat[1]+dht_dat[2]+dht_dat[3];
if(dht_dat[4]!= dht_check_sum) 
```

应该审查...您明确引用超出了`dht_dat`此处的范围。

干杯，

# javascript - 从 HTML 页面中的 Javascript 访问 Firefox 扩展 XPCOM 对象

> ID：14260516
> 
> 赞同：1
> 
> 时间：2013-01-10T14:46:42.467
> 
> 标签：javascript, firefox-addon, xpcom

我试图让我加载到我的网页中的 javascript 可以访问最基本的 XPCOM javascript 对象。我正在使用本教程中的示例代码： [https ://developer.mozilla.org/en-US/docs/How_to_Build_an_XPCOM_Component_in_Javascript](https://developer.mozilla.org/en-US/docs/How_to_Build_an_XPCOM_Component_in_Javascript)

这是我的设置：

**安装.rdf：**

```
<?xml version="1.0"?>
<RDF xmlns="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
     xmlns:em="http://www.mozilla.org/2004/em-rdf#">

    <Description about="urn:mozilla:install-manifest">
        <em:id>helloworld@thellamatesting.com</em:id>
        <em:name>Hello World</em:name>
        <em:version>1.0</em:version>
        <em:type>2</em:type>
        <em:creator>The Llama</em:creator>
        <em:description>Testing</em:description>

        <em:targetApplication>
            <Description>
                <em:id>{ec8030f7-c20a-464f-9b0e-13a3a9e97384}</em:id>
                <em:minVersion>2.0</em:minVersion>
                <em:maxVersion>20.0</em:maxVersion>
            </Description>
        </em:targetApplication>
    </Description>      
</RDF> 
```

**chrome.manifest**

```
content     helloworld    chrome/content/
content     helloworld    chrome/content/ contentaccessible=yes
overlay chrome://browser/content/browser.xul chrome://helloworld/content/browser.xul

component {4762b5c0-5b32-11e2-bcfd-0800200c9a66} components/HelloWorld.js
contract @thellamatesting.com/helloworld;1 {4762b5c0-5b32-11e2-bcfd-0800200c9a66}

locale  helloworld  en-US   locale/en-US/ 
```

**组件/HelloWorld.js**

```
Components.utils.import("resource://gre/modules/XPCOMUtils.jsm");

function HelloWorld() {
    // If you only need to access your component from Javascript, uncomment the following line:
    this.wrappedJSObject = this;
}

HelloWorld.prototype = {
    classDescription: "My Hello World Javascript XPCOM Component",
    classID:          Components.ID("{4762b5c0-5b32-11e2-bcfd-0800200c9a66}"),
    //Also tried
    //classID:          Components.ID("4762b5c0-5b32-11e2-bcfd-0800200c9a66"),
    contractID:       "@thellamatesting.com/helloworld;1",
    QueryInterface: XPCOMUtils.generateQI(),
    // Also tried
    //QueryInterface: XPCOMUtils.generateQI([Components.interfaces.nsIHelloWorld]),
    hello: function() { 
        return "Hello World!"; 
    }
};

var components = [HelloWorld];
if ("generateNSGetFactory" in XPCOMUtils)
  var NSGetFactory = XPCOMUtils.generateNSGetFactory(components);  // Firefox 4.0 and higher
else
  var NSGetModule = XPCOMUtils.generateNSGetModule(components);    // Firefox 3.x 
```

**测试 HTML：**

```
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title></title>
        <script type="application/javascript">

            function go() {
                try {
                    var coms = Components;
                    alert(Components.classes);
                    var myComponent = Components.classes['@thellamatesting.com/helloworld;1'].getService().wrappedJSObject;
                    alert(myComponent.hello());
                } catch (anError) {
                        dump("ERROR: " + anError);
                }
            };

        </script>
    </head>
    <body>

        <button onclick="javascript:go()">Click to go</button>

    </body>
</html> 
```

毕竟，我最终得到“Components.classes 未定义”。有谁知道我在这里做错了什么？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:07:30.413

为了从 javascript 上下文中访问`Components`对象，您需要具有扩展功能，即从`chrome://`URL 运行。*过去*有一种方法可以让常规网页（从 http:// 提供服务）请求扩展功能（称为`UniversalXPConnect`），但出于安全考虑已将其删除。

我认为你应该告诉我们更多关于你想要达到的目标。如果您尝试将数据从插件导出到网页中，AddonSDK（请参阅[https://addons.mozilla.org/en-US/developers/docs/sdk/latest/dev-guide/](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/dev-guide/)）有一个非常好的执行此操作的协议称为 page-mod；它允许您将数据注入网页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T21:42:06.540

感谢乔纳森的建议，我能够想出一个很好的解决方案来解决这个问题。这是我正在使用的代码：

主.js：

```
var data = require("self").data;
var pageMod = require("page-mod");
const {Cc,Ci} = require("chrome");

pageMod.PageMod({
    include: "*",
    contentScriptFile: data.url("copy-helper.js"),
    onAttach: function(worker) {
        worker.port.on("handleCopy", function(copyInfo) {

            var gClipboardHelper = Cc["@mozilla.org/widget/clipboardhelper;1"].getService(Ci.nsIClipboardHelper);
            gClipboardHelper.copyString(copyInfo.dataToCopy);
        });
    }
}); 
```

复制助手.js：

```
window.addEventListener("copyEvent", function (event) {

    self.port.emit('handleCopy', event.detail.copyInfo);

}, false); 
```

*在我的应用程序中*

```
var event = new CustomEvent("copyEvent", {
    detail:{
        copyInfo: {dataToCopy:"my string"}
    }
});
window.dispatchEvent(event); 
```

希望这对遇到此问题的其他人有所帮助！

# php - 空 PHP 脚本上的 PHP memory_get_usage()

> ID：14260517
> 
> 赞同：2
> 
> 时间：2013-01-10T14:46:46.857
> 
> 标签：php, memory-management

我决定查看为我的几个 PHP 脚本分配了多少内存，发现它达到了大约 130KiB 的峰值。不错，我想，考虑到剧本中发生的事情。

然后，我决定看看剧本是从什么开始的。我预计大约 32KiB。

我得到了 121952 个字节。之后，我尝试测试一个完全没有的脚本：

```
<?php 
echo memory_get_usage(); 
```

它也以分配的相同数量的内存开始。

现在，很明显，PHP 会在脚本运行之前为其分配一些内存，但这似乎有点过分。

但是，根据当时系统可用的内存量，它似乎根本不是动态的。我尝试通过打开其他进程来消耗更多的系统内存，但预分配的内存量保持相同的确切字节数。

这是否可以在每个脚本的基础上进行配置，PHP 如何确定它将为每个脚本分配多少？

> 使用 PHP 版本 5.4.7

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T14:54:50.740

该`memory_get_usage`函数直接查询 PHP 的内存分配器以获取此信息。它报告 PHP 本身使用了多少内存，而不是整个进程甚至整个系统正在使用多少内存。

如果你不传入一个额外的`true`参数，你得到的是你的代码使用的确切内存量；这永远不会超过`memory_get_usage(true)`报道的内容。

如果您确实调用`memory_get_usage(true)`，您将取回分配器从系统中保留的堆大小，其中包括您的代码实际未使用但可直接供您的代码使用的内存。

当您的脚本需要比分配器可用的内存更多的内存时，后者将从操作系统中保留另一个大块，您会看到`memory_get_usage(true)`急剧上升，而`memory_get_usage()`可能只会增加几个字节。

分配器用于决定何时分配多少内存以及分配多少内存的确切策略在编译时被纳入 PHP；您必须编辑源代码并编译 PHP 才能更改此行为。

# c# - 为什么使用 LoadLibrary 而不是仅仅获取程序的 BaseAddress

> ID：14260522
> 
> 赞同：1
> 
> 时间：2013-01-10T14:46:56.993
> 
> 标签：c#, winapi, native-methods

主观的...哈哈

好的，所以我一直在 internetz 上寻找一个合理的解决方案来捕获多个击键，并且遇到了一些使用相同东西（键盘挂钩）的解决方案。一种解决方案使用本机调用按名称获取进程的 IntPtr，另一种使用 LoadLibrary("User32.dll")

所以我想我会“聪明”并做到了（成功）

```
IntPtr hInstance = Process.GetCurrentProcess().MainModule.BaseAddress;
callbackDelegate = new HOOKPROC(HookCallback);
hhook = SetWindowsHookEx(WH_KEYBOARD_LL, callbackDelegate, hInstance, 0); 
```

与使用此相反

```
IntPtr hInstance = LoadLibrary("User32.dll");
callbackDelegate = new HOOKPROC(HookCallback);
hhook = SetWindowsHookEx(WH_KEYBOARD_LL, callbackDelegate, hInstance, 0); 
```

一个比另一个更安全吗？我是否犯了一个没有显示其头部的致命错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T15:12:54.377

SetWindowsHookEx() 需要一个有效的模块句柄。它使用它来确定需要将哪些 DLL 注入其他进程才能使钩子工作。

但这只是全局挂钩的要求。两个低级挂钩（WH_MOUSE_LL 和 WM_KEYBOARD_LL）是特殊的，它们不需要 DLL 注入。Windows 仅在您自己的进程中调用挂钩回调。唯一的要求是您的线程泵送一个消息循环，以便 Windows 可以进行回调。Application.Run() 是必需的。

另外，您可以使低级挂钩在 C# 中工作的原因是，全局挂钩使用的 DLL 不能用托管语言编写，因为注入的进程不会加载 CLR。

怪癖是 SetWindowsHookEx() 检查您是否传递了有效的模块句柄，但实际上并没有将它用于低级挂钩。因此，您传递*的任何*有效句柄都可以使用。顺便说一句，这个怪癖在 Windows 7 SP1 中得到了修复，它不再执行该检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:15:18.167

**编辑**：我原来的答案`IntPtr.Zero`打开了选项，并提供了必要的信息来帮助您做出决定。我正在添加来自[docs 的](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644990%28v=vs.85%29.aspx)另一个引用，其中讨论了何时不使用 null：

> 如果 hMod 参数为 NULL 并且 dwThreadId 参数为零或指定由另一个进程创建的线程的标识符，则可能会发生错误。

由于您使用 0 作为线程 ID（根据文档，这意味着“所有现有线程与调用线程在同一桌面上运行”），因此您不应使用 null 而应使用[Marshal.GetHINSTANCE](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.gethinstance.aspx)。

* * *

我认为您应该通过 IntPtr.Zero 或`Marshal.GetHINSTANCE(your current module)`

根据[这些文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644990%28v=vs.85%29.aspx)，第三个参数 ( `hMod`) 是 -

> A handle to the DLL containing the hook procedure pointed to by the lpfn parameter. The hMod parameter must be set to NULL if the dwThreadId parameter specifies a thread created by the current process and **if the hook procedure is within the code associated with the current process.**

Also [as mentioned in this article ("Windows Hooks in the .NET Framework")](http://msdn.microsoft.com/en-us/magazine/cc188966.aspx),

> The third argument should be the HINSTANCE handle of the DLL that contains the code for the filter function. Typically, this value is set to NULL for local hooks. Do not use the .NET null object, though; use the IntPtr.Zero expression, which is the correct counterpart for Win32 null handles. **The HINSTANCE argument cannot be null for systemwide hooks, but must relate to the module that contains the hook code—typically an assembly.** The Marshal.GetHINSTANCE static method will return the HINSTANCE for the specified .NET module.

Also, see [this question](https://stackoverflow.com/questions/3567758/setwindowshookex-returns-0-when-compiling-for-the-net-4-0-framework-in-32bit-ma).

# javascript - Javascript，自动刷新

> ID：14260523
> 
> 赞同：0
> 
> 时间：2013-01-10T14:46:58.083
> 
> 标签：javascript

我目前正在使用下面的 javascript 代码，

```
 <script type="text/javascript">
        function PrintWindow()
        {                     
            window.print();            
            CheckWindowState(); 
        }

        function CheckWindowState()
        {            
            if(document.readyState=="complete")
            {
                window.close();  
            }
            else
            {            
                setTimeout("CheckWindowState()", 2000)
            }
        }    

        PrintWindow();
        //window.onfocus = function() { window.close(); }

        // Trying to auto refresh the page after 3 seconds of no use.
        function setIdle(cb, seconds) {
            var timer; 
            var interval = seconds * 1000;
            function refresh() {
                clearInterval(timer);
                timer = setTimeout(cb, interval);
            };
            $(document).on('keypress, click', refresh);
            refresh();
        }

        setIdle(function() {
            location.href = location.href;
        }, 3);

    </script> 
```

我最初的问题是打印框完成后如何回家，但被告知这是不可能的，所以我现在想知道如何在过了这么多秒后自动刷新页面，我已经添加了代码来做到这一点，但它是不工作

如果有人想知道，我现在已经设法修复它：

var计时器=空；

```
function goAway() {
    clearTimeout(timer);
    timer = setTimeout(function() {
        window.location = 'http://localhost:8080/fileuploadWithPreview';
    }, 5);
}

window.addEventListener('mousemove', goAway, true);

goAway();  // start the first timer off 
```

当窗口关闭时，这会将我带到主页，所以可以这样做

# mysql - MySQL 创建视图，它是两个表的并集，其中一个表值前缀

> ID：14260524
> 
> 赞同：0
> 
> 时间：2013-01-10T14:46:58.387
> 
> 标签：mysql, sql, database, union, temp-tables

我有从 MySQL 数据库获取权限的身份验证系统。

```
CREATE TEMPORARY TABLE db.temp (authority VARCHAR(100));
INSERT INTO db.temp (authority) SELECT blog.authors.id FROM db.authors;
UPDATE db.temp SET authority=CONCAT("AUTH_",authority);

SELECT authority FROM db.temp
UNION
SELECT authority FROM db.authorities_real 
```

从命令行执行时，此脚本工作正常，但在视图中，不允许使用临时表。没有他们有什么办法可以做我想做的事吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:51:26.210

为什么不只`UNION`使用`authors`表格：

```
SELECT CONCAT('AUTH_',blog.authors.id)
FROM db.authors
UNION 
SELECT authority 
FROM db.authorities_real 
```

您无需创建临时表，只需`db.authors`使用`UNION`. 这样做你不必使用临时表。

这`UNION`将从查询中删除所有重复项。如果您不介意重复或不期望任何重复，那么我会使用`UNION ALL`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:51:20.433

您可以将这些语句组合成一个：

```
SELECT concat('AUTH_', blog.authors.id) as authority FROM db.authors
UNION -- all ?
SELECT authority FROM db.authorities_real` 
```

# .htaccess - 本地服务器上的 .htaccess 重定向

> ID：14260528
> 
> 赞同：0
> 
> 时间：2013-01-10T14:47:18.387
> 
> 标签：.htaccess

我的一个域名已被 Google 以各种方式编入索引，mail.mydomain.com、ftp.mydomain.com、pop.mydomain.com... 而不仅仅是 www.mydomain.com。

我在我的 .htaccess 文件中插入了以下两行，这似乎在告诉 Google 更新它的索引方面效果很好：

```
RewriteCond %{HTTP_HOST} !^(www)\.mydomain\.com [NC]  
RewriteRule (.*) http://www.mydomain.com/$1 [R=301,L] 
```

但是，当我的本地服务器 (127.0.0.1) 的 .htaccess 文件中包含这两行时，我无法再访问 127.0.0.1，因为我总是被重定向到 www.mydomain.com。

有人知道如何写这两行，这样我就不必在本地服务器上注释掉它们了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:55:03.707

我已经通过将相关行放入 Apache 配置中来解决这个问题，然后有单独的实时和开发配置。无论如何，出于文件路径和服务器名称的原因，它们可能都是必需的，如果没有别的。

# php - WordPress层次结构中菜单PHP文件的路径

> ID：14260537
> 
> 赞同：0
> 
> 时间：2013-01-10T14:47:59.020
> 
> 标签：php, wordpress

基本上我正在使用 wordpress 为客户创建网站。回想起来，它可能不是正确的平台。但是最近每次我尝试通过 CMS 菜单保存菜单时，都会出现“死机白屏”

在谷歌搜索之后，我很确定这是因为我已经达到了我的 PHP 内存限制，因为我已经排除了所有其他选项。我无法更改我所在服务器上的 PHP.ini 文件。

所以我的问题是，当您使用 WordPress CMS 菜单构建器时，实际写入的 PHP 文件在哪里？简单的问题，如果有人知道。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T10:22:04.093

你应该至少有 64MB 的 PHP 内存，网络服务器有没有像 mod_security 这样的安全模块？检查服务器日志

# gwt - GWT RequestFactory 打开会话 InView 解决方法

> ID：14260538
> 
> 赞同：0
> 
> 时间：2013-01-10T14:48:00.287
> 
> 标签：gwt, requestfactory, open-session-in-view

我们有带有子实体的实体（顶级实体）并且不能使用 Open Session In View Filter 因为我们修改了服务层中的实体，但我们不希望这些更改是持久的。我们通过调用 dao.update 只保留我们想要的东西！

另一方面，如果我们不在视图过滤器中使用开放会话，我们的子实体不是正确的。

如果我们在顶级实体中即时这些子实体，是否有一些解决方法可以强制 GWT 不在子实体上调用 findEntity() ！

例子：

```
 public class User {
    private Long id;
    private Long version;
    private String name;
    Address address;
    /* Getters and Setters */
    public static User findUser(Long id){
        //load from db User with Address    
    }
}
public class Address {
    private Long id;
    private Long version;
    private String name;
    /* Getters and Setters */
    public static Address findAddress(Long id){
        // GWT calls this method although i have allready populated address 
    }
} 
```

# jquery - 如何使用 jquery animate 配置滚动速度？

> ID：14260539
> 
> 赞同：5
> 
> 时间：2013-01-10T14:48:03.403
> 
> 标签：jquery, jquery-animate

我尝试使用以下代码：

```
$('#divid').html(html).animate ({scrollTop:0}, "fast"); // Are slow, medium, fast parameters. 
```

我也厌倦了使用这段代码：

```
$('#divid').html(html).animate ({scrollTop:0}, "500"); 
```

我的最终目标是让用户能够配置滚动速度并将该参数传递给动画函数。但是，这两种方法似乎都不会影响滚动速度。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-10T15:00:58.533

该`animate`函数期望持续时间是字符串或数字。只需将其作为数字传递即可。

```
$('#divid').html(html).animate ({scrollTop:0}, 500); 
```

# build - Team Build 忽略 MSBuild 参数

> ID：14260540
> 
> 赞同：8
> 
> 时间：2013-01-10T14:48:09.050
> 
> 标签：build, tfs

我创建了一个新的团队构建定义。每次签入时，构建都发生在 TFS 服务器（另一个构建控制器）上。构建完成后，我想发布文件。使用的 MSBuild 输入参数是`/p:DeployOnBuild=true;PublishProfile=QADeploy`. `QADeploy`是创建的发布配置文件。

我希望团队建设能够成功，这会发生。但是成功的构建不会发布或尝试将文件发布到目标文件夹。为什么不触发通过发布配置文件发布的任何想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-20T16:56:47.040

奇怪，但添加 Visual Studio 版本解决了这个问题：

```
/p:DeployOnBuild=true /p:PublishProfile=QADeploy /p:VisualStudioVersion=11.0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T23:32:03.857

我有同样的问题，正在拉我的头发。看看这个[类似的问题](https://stackoverflow.com/questions/12478747/auto-deploy-using-continuous-integration-in-tfs-2012)，它帮助了我。

我通过将 WEB 和 WEB APPLICATION Web 构建目标从 PC 上的此路径复制来修复它，并将 VS 安装到构建服务器上的匹配路径中：

C:\Program Files\MSBuild\Microsoft\VisualStudio\v11.0（VS 2012 的路径）

我不确定他们关于使用完整安装程序进行 Web 部署的建议是否有帮助。我同时尝试了这两个建议，之后它在那里工作。

此外，它仅适用于 Web 项目

# javascript - 跟踪和存储多个复选框的选中状态

> ID：14260541
> 
> 赞同：0
> 
> 时间：2013-01-10T14:48:13.763
> 
> 标签：javascript, cookies, checkbox

希望你一切都好！我仍在处理这个待办事项列表网站，我有点难以找到最好的方法来跟踪其中一项是否已标记为已完成，然后如何更新存储待办事项的 cookie只加载一个选中的复选框。

我已经看到诸如 unload 和 onbeforeunload 之类的东西，这似乎是一种可行的方法，检查页面卸载上的每个复选框，然后将状态存储在 cookie 中以供用户下次访问该页面时使用。

但我想知道是否还有其他建议？W3schools 认为 onunload 在 Opera 或 Chome 中不起作用（令人震惊！），如果是这种情况，这将是绝对不行的。

多谢你们！

哦，如果你想在附近有一个mooche ，请[链接到该网站。](http://todo.lukeseager.com)这是一个普通的 JavaScript 项目，仅供参考 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:52:19.247

为什么不在复选框上或什至在复选框上触发`click`一些`change`东西`blur`？

如果我这样做，我可能会使用 localStorage 而不是 cookie——除非我必须以某种方式将数据中继到服务器。（即便如此，我还是会使用 localStorage，然后 AJAX 将内容发布到服务器）。

为了澄清一点，而不是为每个条目创建一个 cookie（这会导致您的操作方式出现大小问题），我会使用类似的东西：

```
var checklist = []; // Make an array 
```

单击复选框时，获取单词等然后

```
checklist.push({'title': 'Eat some carrots', 'description': 'Orange ones', 'Urgent': 0}); 
```

或者

```
checklist.push({'title': 'Eat some cheese', 'description': 'Cheddar - I hate brie', 'Urgent': 1}); 
```

然后显示，遍历你的清单数组以绘制到屏幕上（但是我猜你已经这样做了）

当您要保存此对象数组时，请使用：

```
localStorage.checklist = JSON.stringify(checklist); // Now our checklist from above is stored in a variable in localStorage called checklist. 
```

并读回来：

```
checklist = localStorage.checklist; 
```

如果你真的需要在服务器上使用它，你可以在那里发布清单，但你可能不需要。现在可以添加一个应用缓存 (http://www.html5rocks.com/en/tutorials/appcache/beginner/)，它也可以离线工作。:)

# compiler-construction - qmake：额外的编译器（处理步骤）？

> ID：14260542
> 
> 赞同：4
> 
> 时间：2013-01-10T14:48:14.373
> 
> 标签：compiler-construction, qmake, extra, xxd

在我基于 qmake 的项目中，我想在编译之前对某些文件运行“xxd”。按照文档，我的 pro 文件中的相关部分如下所示：

```
SHADERS = shader/tone.frag \
          shader/trans.frag \
          shader/hue.frag

# xxd
xxd.output = ${QMAKE_FILE_NAME}.xxd
xxd.commands = xxd -i ${QMAKE_FILE_NAME} > ${QMAKE_FILE_OUT}
xxd.depends = SHADERS
xxd.input = $$SHADERS
xxd.variable_out = HEADERS

QMAKE_EXTRA_COMPILERS += xxd 
```

Qmake 没有抱怨，但它也根本不运行 xxd。我是否必须为要预处理的每个文件创建特殊目标？（生成的 *.xxd 文件我以后**不会**编译，只包含在其他 cpp 文件中）

**编辑：**在 smokris 的帮助下，这就是我在 pro 文件中修复该部分的方式：

```
# xxd
xxd.output = ${QMAKE_FILE_NAME}.xxd
xxd.commands = xxd -i ${QMAKE_FILE_NAME} > ${QMAKE_FILE_OUT}
xxd.depends = $$SHADERS
xxd.input = SHADERS
xxd.variable_out = HEADERS 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T16:42:43.717

该`.input`属性需要变量的名称，而不是文件列表。尝试拿走`$$`并使用`xxd.input = SHADERS`.

`.depends`，另一方面，需要一个文件列表，所以使用`xxd.depends = $$SHADERS`.

如果设置`.variable_out`为`HEADERS`、`SOURCES`或`OBJECTS`，编译器将运行。但是，如果您设置`.variable_out`为另一个变量名，则还必须设置`.CONFIG = target_predeps`才能使编译器运行。

# python - python - gearman - 不断收到类型错误

> ID：14260545
> 
> 赞同：3
> 
> 时间：2013-01-10T14:48:31.940
> 
> 标签：python, gearman

我有一个简单的 python 脚本来发送 gearman 任务：

客户：

```
 # "source" is a simple tuple
        client = GearmanClient(['localhost'])
        client.submit_job('queue_feed', simplejson.dumps(source)) 
```

服务器：

```
def queue_feed(work, job):
    source = simplejson.loads(job.data)
    print source

if __name__ == '__main__':
    if len(sys.argv) > 1:
        if sys.argv[1] == "spawn":
            worker = GearmanWorker(['localhost'])
            #nohup python /home/padsquad/apps/gearman_articles.py spawn &
            worker.register_task('queue_feed', queue_feed)
            print 'working...'
            worker.work() 
```

我不确定我在这里做错了什么，gearman 服务器不断给我以下错误：

```
TypeError: Expecting byte string, got <type 'NoneType'> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T14:52:30.713

我最好的猜测是该功能`queue_feed`应该`return`是：例如：

```
def queue_feed(work, job):
    source = simplejson.loads(job.data)
    print source
    return source 
```

如果您没有从 python 函数显式返回某些内容，它会隐式返回`None`，这就是 python 抱怨获取的原因`NoneType`

# .net - WCF 休息身份验证

> ID：14260546
> 
> 赞同：1
> 
> 时间：2013-01-10T14:48:34.160
> 
> 标签：.net, wcf, rest, wcf-security

我需要第一次在我的 WCF RESTful Web 服务上设置身份验证和授权。Web 服务将使用 HTTPS 协议。由于通信现在已加密，我使用什么方法来确定身份验证真的很重要吗？可以像在标题中传递用户名/密码一样简单吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:54:05.730

从某种意义上说，它仍然“很重要”，您的 API 的使用者将需要实现您选择的任何身份验证。

也就是说，在`Authorization`标头中传递用户名/密码是一种标准的做事方式。使用`Basic`身份验证（您应该在服务的 IIS 身份验证选项中找到该选项），传递的标头看起来像这样：

授权：基本用户名：密码

其中 username:password 是 base64 编码的。

除非您实施其他方案（可能使用 cookie），否则您必须在每次调用中传递它

由于您使用的是 HTTPS，所有这些都将被加密。

# xml - 自定义模块布局应覆盖结帐布局 - 不起作用

> ID：14260552
> 
> 赞同：0
> 
> 时间：2013-01-10T14:48:56.100
> 
> 标签：xml, magento, layout

我的模块需要一些额外的输入，所以我更改了计费 phtml 来执行此操作。在 mymodule.xml 中：

```
<checkout_onepage_index>
    <remove name="right"/>
    <reference name="checkout.onepage.billing">
        <action method="setTemplate"><template>workspace/mymodule/persistent/checkout/onepage/billing.phtml</template></action>
    </reference>
</checkout_onepage_index> 
```

删除标签工作正常，但操作不会为我的模块设置新模板。我尝试使用相同的指令更改 persistent.xml 并且工作正常。我的代码有什么问题？

编辑：config.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<config>
    <modules>
        <Xpd_Evolucardgateway>
            <version>1.1.6</version>
        </Xpd_Evolucardgateway>
    </modules>
    <global>
        <models>
            <evolucardgateway>
                <class>Xpd_Evolucardgateway_Model</class>
            </evolucardgateway>
        </models>
        <resources>
            <evolucardgateway_setup>
                <setup>
                    <module>Xpd_Evolucardgateway</module>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </evolucardgateway_setup>
            <evolucardgateway_write>
                <use>core_write</use>
            </evolucardgateway_write>
            <evolucardgateway_read>
                <use>core_read</use>
            </evolucardgateway_read>
        </resources>
        <blocks>
            <evolucardgateway>
                <class>Xpd_Evolucardgateway_Block</class>
            </evolucardgateway>
        </blocks>
        <helpers>
            <evolucardgateway>
                <class>Xpd_Evolucardgateway_Helper</class>
            </evolucardgateway>
        </helpers>

        <sales>
            <quote>
                <totals>
                    <encargo>
                        <class>evolucardgateway/total_encargo</class>
                        <after>subtotal, tax</after>
                        <before>grand_total</before>
                    </encargo>
                </totals>
            </quote>
        </sales>
        <fieldsets>
            <sales_convert_quote_address>
                <base_encargo>
                    <to_order>*</to_order>
                </base_encargo>
                <encargo>
                    <to_order>*</to_order>
                </encargo>
            </sales_convert_quote_address>
            <sales_convert_order>
                <base_encargo>
                    <to_invoice>*</to_invoice>
                    <to_shipment>*</to_shipment>
                    <to_cm>*</to_cm>
                </base_encargo>
                <encargo>
                    <to_invoice>*</to_invoice>
                    <to_shipment>*</to_shipment>
                    <to_cm>*</to_cm>
                </encargo>
            </sales_convert_order>
        </fieldsets>
        <evolucardgateway>
            <cc>
                <types>
                    <visa>
                        <code>visa</code>
                        <name>Visa</name>
                        <order>0</order>
                    </visa>
                    <mastercard>
                        <code>mastercard</code>
                        <name>MasterCard</name>
                        <order>20</order>
                    </mastercard>
                    <amex>
                        <code>amex</code>
                        <name>American Express</name>
                        <order>30</order>
                    </amex>
                    <diners>
                        <code>diners</code>
                        <name>Diners Club</name>
                        <order>40</order>
                    </diners>
                    <elo>
                        <code>elo</code>
                        <name>ELO</name>
                        <order>50</order>
                    </elo>
                </types>
            </cc>
        </evolucardgateway>
    </global>
    <frontend>
        <translate>
            <modules>
                <Xpd_Evolucardgateway>
                    <files>
                        <default>Xpd_Evolucardgateway.csv</default>
                    </files>
                </Xpd_Evolucardgateway>
            </modules>
        </translate>
        <routers>
            <evolucardgateway>
                <use>standard</use>
                <args>
                    <module>Xpd_Evolucardgateway</module>
                    <frontName>evolucardgateway</frontName>
                </args>
            </evolucardgateway>
        </routers>
        <layout>
            <updates>
                <evolucardgateway>
                    <file>evolucardgateway.xml</file>
                </evolucardgateway>
            </updates>
        </layout>
    </frontend>
    <default>
        <payment>
            <evolucardgateway>
                <active>1</active>
                <model>evolucardgateway/standard</model>
                <title>Evolucard</title>
                <mostrar_parcelamento>1</mostrar_parcelamento>
                <cctypes>visa,mastercard,elo,amex,diners</cctypes>
                <environment>0</environment>
                <allowspecific>0</allowspecific>
                <useccv>1</useccv>
            </evolucardgateway>
        </payment>
    </default>
</config> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:35:26.010

*我删除了我之前的答案，因为我误读了问题并误解了代码。*

可能的问题是正在评估模块的操作指令*，*但**在**评估模块的`Mage_Persistent`布局更新 XML 文件之前。因此，您对`_template`属性的更改将被覆盖。

要解决此问题，请强制模块的配置文件在`Mage_Persistent`模块的配置文件之后加载。结果将是您的模块的布局更新文件将添加到*persistent.xml***之后** 的布局更新文件列表中。这*正是*节点打算做的事情：**`<depends />`**

 **```
<?xml version="1.0"?>
<config>
    <modules>
        <Your_Module>
            <active>true</active>
            <codePool>local</codePool>
            <depends>
                <Mage_Persistent />
            </depends>
        </Your_Module>
    </modules>
</config> 
```**

# java - 为什么 char[] 存活了这么多代，我应该担心吗？

> ID：14260553
> 
> 赞同：17
> 
> 时间：2013-01-10T14:48:57.723
> 
> 标签：java, netbeans, garbage-collection, profiling

我是第一次在 NetBeans 中检查分析器，今天早上我注意到通过 Monitor 分析器显示了 1700 多个幸存的代，但堆大小保持不变。在阅读时，我发现[这篇文章](http://netbeans.org/kb/articles/nb-profiler-uncoveringleaks_pt1.html)讨论了使用 NetBeans 分析器发现泄漏。

因此，按照文章的建议，我启动了一个内存分析器。在查看结果时，我发现 char[] 占幸存世代的大多数。目前截至这篇文章，char[] 已经有 22 代了，而且还在增加。

现在一些[帖子（OldCurmudgeon 在底部附近的评论）](https://stackoverflow.com/questions/9983880/nightmare-java-leak-with-loop-and-jdbc)表明，如果我的堆稳定，则没有泄漏，[但其他人](http://www.munzandmore.com/2011/ora/memleak)说，如果世代继续增长，就会有泄漏。所以我有点困惑哪个是正确的。

所以，我的问题是：

**根据以下屏幕截图，我是否应该进一步调查潜在的内存泄漏？**

![内存（堆）](../Images/75235c7bb5ae758e4754df910261d895.png) 内存（堆）

![内存（GC）](../Images/9222d86d2859945999b2d7d41284b8e8.png) 内存（GC）

![实时分配的对象](../Images/13512aa4ac0c73588650640d8664ac8d.png) 实时分配的对象

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T14:54:54.677

将`char[]`可能由`String`对象持有。它们可以出于任何目的在任何地方创建，例如分析器和 JMX 使用它们，因此什么都不做的进程将显示这些（以及不断增长的堆）

注意：所有字符串字面量和类名称等都将继续存在，直到 ClassLoader 被卸载（这可能是程序的生命周期）

要确定您的堆*使用量*是否在增长，您应该查看完整 GC 后保留了多少。看看每个下降的底部，对我来说它看起来是一样的。其他信息对性能调整很有用，但本身不是问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T14:57:22.687

在我的分析过程中，我也遇到了这些挥之不去的 char[]。经过长时间的分析，我得出一个结论，其中许多是字符串常量池的 char 数组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T15:00:55.207

不看代码，你无法分辨。有些程序使用 TB 内存，它们运行良好，因为这不是内存泄漏，而是程序的工作方式。

[Netbeans 文档](http://netbeans.org/kb/articles/nb-profiler-uncoveringleaks_pt1.html)只定义了*幸存的世代*，而不是如何使用该数字来发现内存泄漏。而且， a`char[]`只是 a 的内容`String`，它可以保留很长时间（甚至与主线程一样长）。

没有找到泄漏的灵丹妙药。您应该在可行的负载下运行您的程序，并查看内存使用情况是否与预期模式一致。如果不是，那么您就有问题了，但是如果没有任何上下文，该图就没有任何意义。

# android - Facebook Android SDK 3.0 登录时总是返回 OPENING

> ID：14260555
> 
> 赞同：12
> 
> 时间：2013-01-10T14:49:07.770
> 
> 标签：android, facebook, session, facebook-android-sdk

我按照[https://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/](https://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/)的说明进行操作。当我触摸“登录”按钮时，会话状态始终为 OPENING。当我尝试将故事发布到用户的墙上时，我收到一条错误消息

> “会话：尝试为具有待处理请求的会话请求新权限。”

这是我的代码：

```
public class MainFragment extends Fragment {
    private static final String TAG = "MainFragment";
    private UiLifecycleHelper uiHelper;

    private Session.StatusCallback callback = new Session.StatusCallback() {
        @Override
        public void call(Session session, SessionState state,
                Exception exception) {
            onSessionStateChange(session, state, exception);
        }
    };

    private void onSessionStateChange(Session session, SessionState state,
            Exception exception) {
        if (state.isOpened()) {
            Log.d(TAG, "Logged in...");
        } else if (state.isClosed()) {
            Log.d(TAG, "Logged out...");
        } else {
            Log.d(TAG, "Unknown state: " + state);
        }
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        uiHelper = new UiLifecycleHelper(getActivity(), callback);
        uiHelper.onCreate(savedInstanceState);
    }

    @Override
    public void onResume() {
        super.onResume();

        // For scenarios where the main activity is launched and user
        // session is not null, the session state change notification
        // may not be triggered. Trigger it if it's open/closed.
        Session session = Session.getActiveSession();
        if (session != null && (session.isOpened() || session.isClosed())) {
            onSessionStateChange(session, session.getState(), null);
        }

        uiHelper.onResume();
    }

    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        uiHelper.onActivityResult(requestCode, resultCode, data);
    }

    @Override
    public void onPause() {
        super.onPause();
        uiHelper.onPause();
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        uiHelper.onDestroy();
    }

    @Override
    public void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        uiHelper.onSaveInstanceState(outState);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.facebook_login, container, false);
        LoginButton authButton = (LoginButton) view
                .findViewById(R.id.authButton);
        authButton.setFragment(this);

        return view;
    }

    private boolean isSubsetOf(Collection<String> subset,
            Collection<String> superset) {
        for (String string : subset) {
            if (!superset.contains(string)) {
                return false;
            }
        }
        return true;
    }

    private static final List<String> PERMISSIONS = Arrays
            .asList("publish_actions");
    private static final String PENDING_PUBLISH_KEY = "pendingPublishReauthorization";
    private boolean pendingPublishReauthorization = false;

    public void publishStory() {
        Session session = Session.getActiveSession();

        if (session != null) {

            // Check for publish permissions
            List<String> permissions = session.getPermissions();
            if (!isSubsetOf(PERMISSIONS, permissions)) {
                pendingPublishReauthorization = true;
                Session.NewPermissionsRequest newPermissionsRequest = new Session.NewPermissionsRequest(
                        this, PERMISSIONS);
                session.requestNewPublishPermissions(newPermissionsRequest);
                return;
            }

            Bundle postParams = new Bundle();
            postParams.putString("name", "Facebook SDK for Android");
            postParams.putString("caption",
                    "Build great social apps and get more installs.");
            postParams
                    .putString(
                            "description",
                            "The Facebook SDK for Android makes it easier and faster to develop Facebook integrated Android apps.");
            postParams.putString("link",
                    "https://developers.facebook.com/android");
            postParams
                    .putString("picture",
                            "https://raw.github.com/fbsamples/ios-3.x-howtos/master/Images/iossdk_logo.png");

            Request.Callback callback = new Request.Callback() {
                public void onCompleted(Response response) {
                    JSONObject graphResponse = response.getGraphObject()
                            .getInnerJSONObject();
                    String postId = null;
                    try {
                        postId = graphResponse.getString("id");
                    } catch (JSONException e) {
                        Log.i(TAG, "JSON error " + e.getMessage());
                    }
                    FacebookRequestError error = response.getError();
                    if (error != null) {
                        Toast.makeText(getActivity().getApplicationContext(),
                                error.getErrorMessage(), Toast.LENGTH_SHORT)
                                .show();
                    } else {
                        Toast.makeText(getActivity().getApplicationContext(),
                                postId, Toast.LENGTH_LONG).show();
                    }
                }
            };

            Request request = new Request(session, "me/feed", postParams,
                    HttpMethod.POST, callback);

            RequestAsyncTask task = new RequestAsyncTask(request);
            task.execute();
        }

    }
} 
```

怎么了？

编辑：我还想提一下“登录”按钮上的文字不会改变。身份验证时我没有收到错误，但据我所知，它应该更改为“注销”。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-01-24T22:44:05.457

要弄清楚这一点并不容易。:-)

如果您真的签`exception`入`onSessionStateChange()`，您会发现它并不是真的简单地卡在里面`OPENING`。该异常包含：**java.lang.UnsupportedOperationException: Session: 试图打开一个有待处理请求的会话。**

我终于找到的原因`onActivityResult()`是没有被调用。回调是它的责任，`uiHelper`并且该调用将调用登录的完成部分，因此如果不调用它，则状态将`OPENING`永远保持。除了上面明显的建议之外，这是我发现的，它们都是登录工作所必需的**：**

确保您**同时**使用片段和活动，如 FB 文档中所述。即使文档暗示一项活动就足够了，但事实并非如此。即使活动除了调用单个片段之外什么都没有，您也需要两者。

确保您没有为活动设置历史记录（无论是在清单中还是在代码中）。

`onActivityResult()`确保按照文档覆盖片段。并确保在活动中也覆盖相同的内容：

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
  super.onActivityResult(requestCode, resultCode, data);
} 
```

是的，这看起来很奇怪，但没有它就行不通。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-01T04:09:02.420

最后这对我有用。关键点是添加

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    uiHelper.onActivityResult(requestCode, resultCode, data);
} 
```

和

```
 loginBtn.setFragment(this);
    loginBtn.setUserInfoChangedCallback(new LoginButton.UserInfoChangedCallback() {
        @Override
        public void onUserInfoFetched(GraphUser user) {
            graphUser = user;
        }
    }); 
```

片段内的代码：

```
private GraphUser graphUser;
private UiLifecycleHelper uiHelper;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    uiHelper = new UiLifecycleHelper(getActivity(), callback);
    uiHelper.onCreate(savedInstanceState);
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    return inflater.inflate(R.layout.test_frame, container, false);
}

@Override
public void onViewCreated(View view, Bundle savedInstanceState) {
    super.onViewCreated(view, savedInstanceState);

    view.findViewById(R.id.getMeBtn).setOnClickListener(this);

    LoginButton loginBtn = (LoginButton) view.findViewById(R.id.loginBtn);
    loginBtn.setFragment(this);
    loginBtn.setUserInfoChangedCallback(new LoginButton.UserInfoChangedCallback() {
        @Override
        public void onUserInfoFetched(GraphUser user) {
            graphUser = user;
        }
    });
}

@Override
public void onResume() {
    super.onResume();
    uiHelper.onResume();

    updateUI();
}

@Override
public void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    uiHelper.onSaveInstanceState(outState);
}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    uiHelper.onActivityResult(requestCode, resultCode, data);
}

@Override
public void onPause() {
    super.onPause();
    uiHelper.onPause();
}

@Override
public void onDestroy() {
    super.onDestroy();
    uiHelper.onDestroy();
}

private Session.StatusCallback callback = new Session.StatusCallback() {
    @Override
    public void call(Session session, SessionState state, Exception exception) {
        onSessionStateChange(session, state, exception);
    }
};

private void onSessionStateChange(Session session, SessionState state, Exception exception) {
    updateUI();
}

private void updateUI() {
    if (graphUser != null) {
        Log.d("TEST", graphUser.getFirstName());
    }
}

@Override
public void onClick(View view) {
    Session session = Session.getActiveSession();
    Log.d("TEST", "session.getState() = " + session.getState());

    if (session.getState().isOpened()) {
        Request.executeMeRequestAsync(session, new Request.GraphUserCallback() {

            @Override
            public void onCompleted(GraphUser user, Response response) {
                if (user != null) {
                    updateUI();
                }
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-25T22:32:59.563

我遇到过同样的问题。状态总是`OPENING`. 事实证明@Gabor 是正确的。

当会话状态是`OPENING`一个方法`onActivityResult`被调用时，**这是肯定的。**

如果您使用的是片段，`onActivityResult`则在保存片段的 ACTIVITY 中调用，而不是在片段中。这是由于传递的上下文等。

所以我这样做了：

1.  检查`onActivityResults`调用的内容（通过 logcat） - 只是为了确保

2.  在该方法中添加一行`Session.getActiveSession().onActivityResult(this, requestCode, resultCode, data);`注意该参数`this`是一个活动上下文。

    或

    使用`UiLifecycleHelper`'`onActivityResult`方法，如下所示： `UiHelper.onActivityResult(requestCode, resultCode, data);`更多信息请[点击此处](http://developers.facebook.com/docs/reference/android/3.0/class/UiLifecycleHelper/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-29T10:42:02.743

如果其他人仍然遇到此问题，则可能是由于在 Activity 中覆盖 onActivityResult 而没有调用 super 方法。

活动

```
protected void onActivityResult(final int requestCode, final int resultCode, final Intent data) {
    /* other code here */
    super.onActivityResult(requestCode, resultCode, data);
} 
```

分段

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    uiHelper.onActivityResult(requestCode, resultCode, data);
    super.onActivityResult(requestCode, resultCode, data);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-26T09:09:25.073

您应该`onActivityResult`在活动中而不是在片段中实现。为我工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-17T09:26:50.793

这可能发生的另一个原因（对我来说）是当你使用时`getChildFragmentManager()`- onActivityResult 没有传递给嵌套[的片段，因为 bug](https://code.google.com/p/android/issues/detail?id=40537)。 [这](https://gist.github.com/artem-zinnatullin/6916740)（让托管片段将其收到的 onActivityResult 传递给所有孩子）对我有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-31T00:19:58.707

我的活动`onActivityResult`正在被调用......所以我在那里做了一个非常非常糟糕的黑客攻击：

```
public void onActivityResult(int requestCode, int resultCode, Intent data) {
if(requestCode == 64206) //Bad hacking
            if(df!=null)
                df.onActivityResult(requestCode, resultCode, data); 
```

df 是我的片段。这使得会议开始......这太疯狂了。非常有兴趣为此找到更好的解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-05-04T18:44:50.497

就我而言，我试图将片段类从更改 `android.support.v4.app.Fragment`为`android.app.Fragment`（我不支持 API-11 之前的 Android 版本）并省略了该`FBAuthButton.setFragment(this);`语句。这实际上是造成问题的原因。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-04-25T15:54:06.370

我遇到了同样的问题，我卸载了我的应用程序并重新安装，它工作！

# hadoop - 执行联接时 Hive 与 Pig

> ID：14260556
> 
> 赞同：1
> 
> 时间：2013-01-10T14:49:09.520
> 
> 标签：hadoop, hive, apache-pig, piglet

我有一些脚本可以处理我的网站日志。我已将此数据加载到 Hive 中的多个表中。我每天运行这些脚本来分析流量。

最近我发现我在这些脚本中编写的配置单元查询花费了太多时间。以前，生成报告需要大约 10-15 分钟，但现在需要数小时才能完成。

我对数据进行了分析，数据集增加了大约 5-10%。

我的一位朋友建议我，在加入多个 hive 表时，Hive 并不好，我应该将脚本切换到 Pig。与 Pig 相比，Hive 不擅长加入表格吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:05:40.090

```
Is Hive bad at joining tables 
```

不。Hive 实际上相当不错，但有时需要花点时间使用查询优化器。

根据您使用的 Hive 版本，您可能需要在查询中提供**提示**，以告诉优化器使用特定算法连接数据。[您可以在此处](http://hive.apache.org/docs/r0.9.0/language_manual/joins.html)找到有关不同提示的一些详细信息。

如果您正在考虑使用 Pig，我认为您的选择不应仅出于性能考虑。根据我的经验，使用 Pig 没有可量化的收益，我在过去几年都使用过，而且在性能方面没有明显的赢家。

然而，Pig 给您的是在定义您想要使用的连接类型时更加透明，而不是依赖于一些（有时是晦涩的）优化器提示。

最后，Pig 或 Hive 并不重要，它只取决于**您**决定如何优化查询。如果您正在考虑切换到 Pig，我将首先真正分析您在处理方面的需求是什么，因为您甚至可能会在性能方面下降。如果您想比较两者，[这是一个很好的帖子。](http://hive.apache.org/docs/r0.9.0/language_manual/joins.html)

# asp.net - 网页部件 asp.net

> ID：14260557
> 
> 赞同：1
> 
> 时间：2013-01-10T14:49:11.297
> 
> 标签：asp.net

在 asp.net 中使用 webpart 有什么缺点？他们正在失去人气吗？我正计划创建一个用户定义的仪表板并且正在考虑使用 Webparts，这是要走的路还是现在有另一种方法来做可定制的仪表板？我宁愿不必使用第 3 方产品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:07:01.900

对我来说，如今 Webpart 更像是一种共享点。除此之外，通过一些设计，您可以使用用户控件和您自己的一些类来获得所需的一切，以整理出常见的功能和布局。

假设您有一个名为 DashboardWidget 的基类，它继承自 WebControl 在这里您可以定义一个可覆盖的方法

ProcessDataSource -> 对数据库或服务执行查询并格式化结果以供展示

在 prerender 方法（或 asp.net 生命周期中的类似方法）中，您调用 ProcessDataSource（您可以使用大多数控件已有的 DataSource 属性）。

然后，您从 DashboardWidget 继承来制作控件，并在 render 方法中覆盖 ProcessDataSource 以按照您需要的方式获取信息，并使用 Render 方法来设置要显示的内容。

理想情况下，您应该定义自己的数据源类，以便在一个地方定义连接位置、连接方式、凭据等。

至于布局，较新版本的 asp.net 包含几个您可以使用的布局选项（如果您愿意，总有纯 html）

我在这里有点从臀部拍摄，但这是一种不涉及 webparts 的方法，对我来说，在 sharepoint 之外并不那么受欢迎。

希望这有帮助

# asp.net - 使用 ASP.NET(C#) 在 ACCESS DB 中输入日期/时间

> ID：14260560
> 
> 赞同：0
> 
> 时间：2013-01-10T14:49:19.440
> 
> 标签：asp.net, ms-access-2007

我想在我的 ACCESS DB 中输入一个日期，该字段是日期/时间。用户在此方法中以表格形式输入（文本）DD/MM/YYYY

代码：日期/时间对象

```
DateTime Bday = new DateTime(long.Parse(Request.Form["Bday"])); 
```

SQL查询：

```
cmd.CommandText = "INSERT INTO (Fname,Lname,User,Pass,Email,BiDate,IsAdmin,IsMale) VALUES ('" + fname + "','" + lname + "','" + user + "','" + pass + "','" + email + "',#" + Bday + "#," + admin + "," + male + ")"; 
```

**它不工作**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:32:53.047

卸下`long.Parse`零件

```
 DateTime Bday = DateTime.ParseExact(Request.Form["Bday"], "dd/MM/yyyy", 
        CultureInfo.InvariantCulture);

        cmd.CommandText = "INSERT INTO (Fname,Lname,[User],Pass,Email,BiDate,"
        +"IsAdmin,IsMale) " + 
        "VALUES ('" + fname + "','" + lname + "','" + user + "','" + pass + "','"
        + email + "',#" + Bday.ToString("dd/MM/yyyy") + "#," + admin + "," + male + ")"; 
```

希望这可以帮助！

# jquery - jquery 滑动切换查询

> ID：14260561
> 
> 赞同：0
> 
> 时间：2013-01-10T14:49:24.353
> 
> 标签：jquery, html

我正在尝试使用 jquery 幻灯片方法创建列表结果的下拉功能。

我遇到的问题是，当用户单击“类别”类时，它会展开并显示所有类别的“表单”。不仅仅是被点击的那个。有人可以建议为什么吗？

我的 HTML：

```
<div id="categoryloop">
    {% for c in Category_Name %}
    <li class="categories">{{ c.Name }}
        <ol>
            {% for form in c.form_set.all %}
            <li class="forms"><a href="/forms/{{ form.id }}">{{ form.Title }}</a></li>
            {% endfor %}</ol>
    </li>
    {% endfor %}
    </div>
</div> 
```

我的jQuery

```
$(document).ready(function(){
$(".categories").click(function(){
    $(".forms").slideToggle("fast");
}); 
```

});

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:52:04.437

[传入上下文](http://api.jquery.com/jQuery/)..或使用.find [()](http://api.jquery.com/find/)所以它知道只打开一个特定的

```
$(".categories").click(function(){
    $(".forms",this).slideToggle("fast");
}); 
```

或者

```
$(".categories").click(function(){
    $(this).find(".forms").slideToggle("fast");
}); 
```

# java - Bloomberg Open API - 如何获取特定数量的柱而不是超过一个日期范围？

> ID：14260568
> 
> 赞同：1
> 
> 时间：2013-01-10T14:49:38.497
> 
> 标签：java, bloomberg

我正在使用 Bloomberg API 并获得两个小时的每小时柱形图，我可以简单地调用这样的方法，开始设置为当前时间减去两个小时，结束时间设置为现在：

```
public static Request getBarData(String security, Service refDataService, Datetime start, Datetime end) {

    Request request = refDataService.createRequest("IntradayBarRequest");
    request.set("security", security);
    request.set("eventType", "TRADE");
    request.set("interval", 60);
    request.set("gapFillInitialBar", true);
    request.set("startDateTime", start);
    request.set("endDateTime", end);
    return request;
} 
```

有没有办法可以改写这个请求，要求最后 2 个 60 分钟的条形图，而不是给定日期范围的条形图？本质上，我想用多个条形替换日期范围。我需要订阅不同间隔的条形图，但每种情况下的条形图数量相同，因此避免所有日期加减以及任何时区考虑都会非常好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:56:49.433

我刚刚向彭博社证实这是不可能的。您需要一个开始时间和结束时间（默认结束时间是现在）

# javascript - 链接 JS 方法

> ID：14260571
> 
> 赞同：3
> 
> 时间：2013-01-10T14:49:51.023
> 
> 标签：javascript, jquery

如果字符串符合某种格式，我正在尝试在字符串中插入一些空格。具体来说，如果字符串仅包含数字，并且长度正好是五个字符，则应在第三个和第四个数字之间添加空格。

[这是我的测试用例：](http://jsfiddle.net/LwAg9/)

```
function codeAddress() {
    var num_regex = /^\d+$/,
            input = $("#distributor-search").val(),
          address = (input.match(num_regex) && input.length == 5) ? input.split('').splice(3, 0 , ' ').join() : input ;

    console.log('The address is: ' + address);

    return false;
} 
```

出于某种原因，链接`.split()`, `.splice()`and`.join()`似乎没有返回任何东西。我哪里错了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T14:57:17.123

[`split()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)返回一个数组，[`splice()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/splice)返回包含已**删除**元素的数组，并按[`join()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/join)应有的方式返回连接的数组。

看起来一切都出错了`splice()`。你得到的不是剩余的，而是被移除的项目。

我的测试：

```
var input = '123,789';
var output = input.split(',').splice(1, 0, '456').join(',');

console.log(output); // outputs nothing, because `splice(1, 0, '456')` doesn't remove any values 
```

您可以通过制作一个使用 splice 功能的原型来解决这个问题，如下所示：

```
Array.prototype.isplice = function() {
    var tmp = this;

    Array.prototype.splice.apply(tmp, Array.prototype.isplice.arguments);

    return tmp;
};

var output = input.split(',').isplice(1, 0, '456').join(',');
console.log(output); // outputs ["123", "456", "789"] as expected 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T14:56:41.163

正如其他人所解释的那样，您的函数不起作用，因为`.splice()`返回已删除的元素，而不是结果数组。

尝试使用此正则表达式，而不是：

```
/^(\d\d\d)(\d\d)$/ 
```

它只会匹配一个长度为 5 位的字符串，它不会修改其他字符串。

例子：

```
var s = '123456'.replace(/^(\d\d\d)(\d\d)$/, '$1 $2');
// "123456"
var s = '1234'.replace(/^(\d\d\d)(\d\d)$/, '$1 $2');
// "1234"
var s = '12345'.replace(/^(\d\d\d)(\d\d)$/, '$1 $2');
// "123 45" 
```

所以，在你的情况下：

```
address = $("#distributor-search").val().replace(/^(\d\d\d)(\d\d)$/, '$1 $2'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T14:53:03.883

为什么不只使用正则表达式本身？

```
var num_regex = /^(\d\d\d)(\d\d)$/,
        input = $("#distributor-search").val(),
      address = input.match(num_regex);
if (address) address = address[1] + ' ' + address[2]; 
```

该正则表达式匹配一个五位数的字符串，并将前三位和后两位组合在一起。如果测试字符串匹配，则该`.match()`函数返回一个数组，其中两个组位于位置 1 和 2（位置 0 是整个匹配项）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T15:01:31.510

在您的情况下，您不能将 splice 与 join 连接：

```
splice(3, 0 , ' ').join() 
```

请记住 splice 返回一个包含已删除项目的新数组，而不是结果数组。

# java - 使用 stORM 或替代方法使用外键进行 Android SQLite 查询

> ID：14260574
> 
> 赞同：4
> 
> 时间：2013-01-10T14:49:58.817
> 
> 标签：java, android, android-sqlite, greendao, android-storm

我有以下型号

```
categories(id, name)
places(id, name, category_id) 
```

我有一个列表视图，它根据用户想要查看的类别显示内容。

类别数据

```
1, River
2, Hill Station
3, Wild Life
4, Temples 
```

如果用户只想查看 category_id = 2 和 4 的地点。

我如何对数据库进行查询以返回具有 category_id = 2 和 4 的地点列表。

我正在为数据库使用[stORM](https://code.google.com/p/storm-gen/)库。

他们具有以下功能来进行查询。

```
dao.listAll();
dao.listByExample(exampleObj); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T17:37:47.807

如果切换到greenDAO，可以使用QueryBuilder，支持IN等：http: [//greendao-orm.com/documentation/queries/](http://greendao-orm.com/documentation/queries/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:22:51.540

为此，我使用 ormlite。查看[文档中有关 query-builder 的](http://ormlite.com/docs/query-builder)部分。

# mysql - 如何让数据从数据库中“消失”？MySQL

> ID：14260575
> 
> 赞同：0
> 
> 时间：2013-01-10T14:50:00.127
> 
> 标签：mysql, database

我有一个愚蠢的问题。问题是我的程序必须具有从数据库中删除数据的功能。是的，不是真正的问题。但是，我怎样才能删除数据而不会有其他人可以看到的危险，即删除了某些内容。

```
User Table:
U_ID  U_NAME
1     Chris
2     Peter

OTHER TABLE
ID TIMESTAMP  FK_U_D
1  2012-12-01   1
2  2012-12-02   1 
```

Sooooo ID 是 AUTO_INCREMENT，所以如果我删除其中一个，就会有间隙。此外，时间戳也比前一行大，所以是递增的。

我想让 ID 为 1 的数据从用户的个人资料（U_ID 1）中消失。

如果我删除它，就会有间隙。如果我只是将 FK_U_ID 更改为 2 (Peter) 这很明显，因为当我插入数据时，有 20 或 30 个具有相同 U_ID 的数据行......所以很明显已经进行了修改。

如果我将 FK_U_ID 设置为 NULL --> 就像我将其更改为另一个 U_ID 时一样。

有什么解决方案可以完成这项工作吗？我知道，如果除了我之外没有人可以访问数据库，那就没问题了。但以防万一，如果有人控制了我的程序，那么修改应该不会很明显。

所以我们开始吧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:01:09.773

对于 ID 差距问题，您可以按照@SLaks 的建议使用[GUID](http://en.wikipedia.org/wiki/Globally_unique_identifier)，但是您不能使用本机 RDBMS auto_increment，这意味着您必须创建 GUID 并在创建时将其与其余记录数据一起插入。当然，您实际上并不需要 ID 是全局唯一的，您可以只存储 20 个字符或其他内容的随机字符串，但是您必须执行数据库读取以查看该 ID 是否被获取并重复（递归）这个过程直到你找到一个未使用的 ID……可能会很费力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:42:34.367

完全不清楚为什么要“隐藏”执行删除的证据。这听起来真是个坏主意。我不喜欢传播错误信息。

理想主键的两个特征是： - 匿名（没有任何有用的信息，不管它的设置是什么） - 不可变的（一旦分配，就永远不会改变。）

但是，如果我们把整个讨论放在一边……

* * *

我可以回答一个稍微不同的问题（您可能会发现对您的特定情况有帮助的答案）

消除具有 AUTO_INCREMENT 的列中的值中的“间隙”的唯一方法是将列值从其当前值更改为连续的新值序列。如果有任何外键引用该列，则这些列中的值也需要更新，以保留关系。这可能会使表的当前 auto_increment 值高于 id 列的最大值，所以我也想重置它，以避免在下一次插入时出现“间隙”。

（我已经在开发和测试环境中对 auto_increment 值进行了重新排序，以“清理”查找表，并将某些表的 id 值移动到与其他表中的范围不同的范围......让我测试 SQL以确保 SQL 连接谓词不会无意中引用错误的表，并意外返回看起来正确的行......这些是我在 auto_increment 值时重新分配的一些原因）

请注意，当您更改主键值时，数据库可以“自动”更新外键值（对于 InnnoDB 表），只要外键约束是用 定义的`ON UPDATE CASCADE`，并且`FOREIGN_KEY_CHECKS`未被禁用。

如果没有要处理的外键，并假设 id 的所有当前值都是正整数，那么我已经能够做这样的事情：（有适当的备份，所以如果事情没有，我可以恢复工作不正常）

```
UPDATE mytable t
  JOIN (
         SELECT s.id           AS old_id
              , @i := @i + 1   AS new_id
           FROM mytable s
          CROSS
           JOIN (SELECT @i := 0) i
          ORDER BY s.id
       ) c
    ON t.id = c.old_id
   SET t.id = c.new_id
 WHERE t.id <> c.new_id 
```

要将表 AUTO_INCREMENT 重置为表中最大的 id 值：

```
ALTER TABLE mytable AUTO_INCREMENT = 1; 
```

`c`通常，我将创建一个表并从上面的内联视图（别名为）中的该查询填充它。然后我可以使用该表来更新外键列和主键列，首先禁用 FOREIGN_KEY_CHECKS 然后重新启用它。（在并发环境中，其他进程可能正在从其中一个表中插入/更新/删除行，我当然会首先获得所有要更新的表的排他锁。）

* * *

再次提起我之前搁置的讨论……这种类型的“管理”功能在测试环境中非常有用，在设置测试用例时。但这不是在生产环境中使用实时数据执行的功能。

# schema - 将 ObjectId 保留在 mongoose/mongodb 的子文档中是一种好习惯吗？

> ID：14260581
> 
> 赞同：0
> 
> 时间：2013-01-10T14:50:26.470
> 
> 标签：schema, mongoose, document

我在我的模型“File.js”中定义了这个：

```
var FileSchema = new Schema({
     _id       : ObjectId
    name       : String
}); 
```

在“Folder.js”中：

```
var FileSchema_Folder = new Schema({
     _id       : ObjectId // <--- is good practice to keep this id here?
    name       : String
});

var FolderSchema = new Schema({
     _id       : ObjectId
    files      : [FileSchema_Folder] // <--- UPDATE: replaced FileSchema for FileSchema_Folder
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T17:25:16.480

默认情况下，每个文档都已经有一个`_id`of 类型`ObjectId`，因此在每个模式中重复它并不是一个好习惯。

# java - 将 Flash 文件上传与 JSF 集成

> ID：14260583
> 
> 赞同：4
> 
> 时间：2013-01-10T14:50:32.893
> 
> 标签：java, jsf, file-upload, jsf-1.2, swfupload

我已经看到我们可以通过闪存文件上传来上传多个文件。像[SWFUpload](http://code.google.com/p/swfupload/)或[YUI Uploader](http://yuilibrary.com/yui/docs/uploader/)。是否可以将这些上传组件与 JSF 集成？

我想要的是一次选择多个文件。Primefaces 文件上传器具有此功能，但在 IE7 中不起作用，因为 IE7 不支持 HTML5。

我需要创建一个包含各种字段的表单，如下拉菜单、文本输入等，还需要添加一个文件上传器来选择多个文件。当单击 JSF 提交按钮时，表单将被验证并在之后继续。

我创建了一个用于上传多个文件的页面，但该页面对多个文件使用多个输入文件组件。

任何参考都会对我很有帮助。我找到了另一个[SO 线程](https://stackoverflow.com/questions/2922344/need-an-example-of-using-swfupload-with-java)，并且在那里发布的解决方案使用 JSP。我无法理解如何使用它来满足我的要求。

## 更新

我创建了以下托管 bean：

```
import com.mhis.massupload.ucm.Service;

import java.util.List;
import java.util.UUID;
import java.util.logging.Logger;

import javax.faces.context.FacesContext;

import org.apache.commons.fileupload.FileItem;

public class UploadBean { 
    private Logger log = Logger.getLogger(getClass().getName());
    private Service service;
    private String key;

    public UploadBean() {
        super();
        log.info("JYM");
        init();
    }

    private void init() {
        key = UUID.randomUUID().toString();
    }

    public String upload() {        
        System.out.println("Action Invoked.");
        List<FileItem> fileFields = (List<FileItem>)FacesContext.getCurrentInstance().getExternalContext().getSessionMap().get(key);
        System.out.println(fileFields);

        return "";
    }

    public void setKey(String key) {
        this.key = key;
    }

    public String getKey() {
        return key;
    }
} 
```

Servlet 是：

```
import java.io.IOException;

import java.util.ArrayList;
import java.util.List;

import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.fileupload.FileItem;
import org.apache.commons.fileupload.disk.DiskFileItemFactory;
import org.apache.commons.fileupload.servlet.ServletFileUpload;

public class UploadServlet extends HttpServlet {

    @SuppressWarnings("compatibility:-3560436533054762606")
    private static final long serialVersionUID = 4122845079663279030L;

    public void init(ServletConfig config) throws ServletException {
        super.init(config);
    }

    public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        System.out.println("UploadServlet invoked.");        
        List<FileItem> fileFields = new ArrayList<FileItem>();

        try {
            List<FileItem> items = new ServletFileUpload(new DiskFileItemFactory()).parseRequest(request);
            for (FileItem item : items) {
                if (!item.isFormField()) {
                    fileFields.add(item);
                    System.out.println(item.getName());
                }
            }
        } catch (Exception e) {
            throw new ServletException(e);
        }

        String key = request.getParameter("key");
        request.getSession().setAttribute(key, fileFields);
    }
} 
```

jspx 页面：

```
<?xml version='1.0' encoding='utf-8'?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.1"
          xmlns:f="http://java.sun.com/jsf/core"
          xmlns:h="http://java.sun.com/jsf/html">
  <jsp:output omit-xml-declaration="true" doctype-root-element="HTML"
              doctype-system="http://www.w3.org/TR/html4/loose.dtd"
              doctype-public="-//W3C//DTD HTML 4.01 Transitional//EN"/>
  <jsp:directive.page contentType="text/html;utf-8"/>
  <f:view>
    <html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <script src="js/jquery-1.8.3.min.js" type="text/javascript"></script>        
        <script src="uploadify/jquery.uploadify.js" type="text/javascript"></script>
        <link rel="stylesheet" media="screen" href="uploadify/uploadify.css"
              type="text/css"/>
        <script type="text/javascript">
            $(document).ready(function() {
                $('#uploadify').uploadify({
                    'swf': 'uploadify/uploadify.swf',
                    'uploader': '${pageContext.request.contextPath}/uploadServlet;jsessionid=${pageContext.session.id}?key=<h:outputText value="#{uploadBean.key}" />'                   
                });                                         
            });    

            var upload = function() {
                $('#uploadify').uploadify('upload','*');
            }
        </script>
        <title>test</title>
      </head>
      <body>
        <h:form enctype="multipart/form-data">
            <input id="uploadify" type="file"/>            
            <h:commandLink action="#{uploadBean.upload}" value="Upload" />
        </h:form>
      </body>
    </html>
  </f:view>
</jsp:root> 
```

我在这里使用 Uploadify。

我有两个问题：

*   该`List<FileItem> fileFields`方法`upload`有时会返回`null`，有时会显示列表。我找不到原因。我试图`HttpSession`从`action`方法中获取`FacesContext.getCurrentInstance().getExternalContext().getSession(false)`，然后调用`getAttribute()`它，它也总是返回`null`。

*   如果我设置'auto'：false，即文件上传将在调用`upload();`方法后启动并修改`<h:commandLink/>`为：`<h:commandLink action="#{uploadBean.upload}" value="Upload" onclick="upload();"/>`然后我得到异常，即：

    ```
    org.apache.commons.fileupload.FileUploadBase$IOFileUploadException: Processing of multipart/form-data request failed. EOF after reading only: '2392369' of: '11626364' promised bytes, out of which at least: '0' were already buffered
    at org.apache.commons.fileupload.FileUploadBase.parseRequest(FileUploadBase.java:367)
    at org.apache.commons.fileupload.servlet.ServletFileUpload.parseRequest(ServletFileUpload.java:126)
    at com.edfx.massupload.servlet.UploadServlet.doPost(UploadServlet.java:33)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
    at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:227)
    at weblogic.servlet.internal.StubSecurityHelper.invokeServlet(StubSecurityHelper.java:125)
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:300)
    at weblogic.servlet.internal.TailFilter.doFilter(TailFilter.java:26)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at oracle.security.jps.ee.http.JpsAbsFilter$1.run(JpsAbsFilter.java:119)
    at java.security.AccessController.doPrivileged(Native Method)
    at oracle.security.jps.util.JpsSubject.doAsPrivileged(JpsSubject.java:315)
    at oracle.security.jps.ee.util.JpsPlatformUtil.runJaasMode(JpsPlatformUtil.java:442)
    at oracle.security.jps.ee.http.JpsAbsFilter.runJaasMode(JpsAbsFilter.java:103)
    at oracle.security.jps.ee.http.JpsAbsFilter.doFilter(JpsAbsFilter.java:171)
    at oracle.security.jps.ee.http.JpsFilter.doFilter(JpsFilter.java:71)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at oracle.dms.servlet.DMSServletFilter.doFilter(DMSServletFilter.java:139)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at weblogic.servlet.internal.RequestEventsFilter.doFilter(RequestEventsFilter.java:27)
    at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:56)
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.wrapRun(WebAppServletContext.java:3715)
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3681)
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)
    at weblogic.security.service.SecurityManager.runAs(SecurityManager.java:120)
    at weblogic.servlet.internal.WebAppServletContext.securedExecute(WebAppServletContext.java:2277)
    at weblogic.servlet.internal.WebAppServletContext.execute(WebAppServletContext.java:2183)
    at weblogic.servlet.internal.ServletRequestImpl.run(ServletRequestImpl.java:1454)
    at weblogic.work.ExecuteThread.execute(ExecuteThread.java:209)
    at weblogic.work.ExecuteThread.run(ExecuteThread.java:178) 
    ```

在这种情况下，该`action`方法也在 servlet 执行之前执行。

我该如何解决这两个问题？

## 附言

我需要修改 uploadify.js 以设置 swf 文件的正确路径并更改取消按钮的 css。我已将uploadify 的整个目录放在Web-Content 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T20:24:37.027

这是我所做的解决方案，BalusC 帮我开发了很多。

## 平台和框架

*   上传 v3.2
*   JSF 1.2
*   jQuery 1.8.3
*   WebLogic 10.3.5.0
*   Apache Commons 文件上传 1.2.2

## 多部分请求的问题

JSF 1.2 无法处理多部分请求。因此，如果`<h:form/>`contains `enctype="multipart/form-data"`as 属性，则不会触发`action`命令组件 like 的方法。解决方案是创建一个过滤器，它将与多部分请求`<h:commandButton/>`一起工作并显式处理。`Faces Servlet`这是过滤器：

```
package com.mhis.massupload.filter;

import java.io.IOException;

import java.util.Collections;
import java.util.Enumeration;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletRequestWrapper;

import org.apache.commons.fileupload.FileItem;
import org.apache.commons.fileupload.disk.DiskFileItemFactory;
import org.apache.commons.fileupload.servlet.ServletFileUpload;

public class MultipartFilter implements Filter {
    private FilterConfig filterConfig = null;

    public void init(FilterConfig filterConfig) throws ServletException {
        this.filterConfig = filterConfig;
    }

    public void destroy() {
        filterConfig = null;
    }

    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        if (!(request instanceof HttpServletRequest)) {
            chain.doFilter(request, response);
            return;
        }

        HttpServletRequest httpRequest = (HttpServletRequest)request;        
        boolean isMultipartContent = ServletFileUpload.isMultipartContent(httpRequest);

        if (!isMultipartContent) {
            chain.doFilter(request, response);
            return;
        }

        try {
            DiskFileItemFactory factory = new DiskFileItemFactory();
            ServletFileUpload upload = new ServletFileUpload(factory);
            upload.setHeaderEncoding("UTF-8");
            upload.setSizeMax(-1);

            List<FileItem> items = upload.parseRequest(httpRequest);
            final Map<String, String[]> parameterMap = new HashMap<String, String[]>();

            for (FileItem item : items) {
                if (item.isFormField()) {
                    processFormField(item, parameterMap);
                } 
            }

            chain.doFilter(new HttpServletRequestWrapper(httpRequest) {

                    public Map<String, String[]> getParameterMap() {
                        return parameterMap;
                    }

                    public String[] getParameterValues(String name) {
                        return (String[])parameterMap.get(name);
                    }

                    public String getParameter(String name) {
                        String[] params = getParameterValues(name);
                        if (params == null) {
                            return null;
                        }
                        return params[0];
                    }

                    public Enumeration<String> getParameterNames() {
                        return Collections.enumeration(parameterMap.keySet());
                    }
                }, response);
        } catch (Exception ex) {
            ServletException servletException = new ServletException();
            servletException.initCause(ex);
            throw servletException;
        }
    }

    private void processFormField(FileItem formField, Map<String, String[]> parameterMap) {
        String name = formField.getFieldName();
        String value = formField.getString();
        String[] values = parameterMap.get(name);

        if (values == null) {
            parameterMap.put(name, new String[] { value });
        } else {
            int length = values.length;
            String[] newValues = new String[length + 1];
            System.arraycopy(values, 0, newValues, 0, length);
            newValues[length] = value;
            parameterMap.put(name, newValues);
        }
    }
} 
```

web.xml中这个过滤器的配置是：

```
<filter>
    <filter-name>MultipartFilter</filter-name>
    <filter-class>com.mhis.massupload.filter.MultipartFilter</filter-class>
</filter>
<filter-mapping>
    <filter-name>MultipartFilter</filter-name>
    <servlet-name>Faces Servlet</servlet-name>
</filter-mapping> 
```

## 用于 Uploadify 的 Javasctipt

```
$('#uploadify').uploadify({
    'auto': false,
    'buttonText' : 'Browse',
    'fileSizeLimit': 0,
    'swf': 'uploadify/uploadify.swf',
    'uploader': '${pageContext.request.contextPath}/uploadservlet?key=<h:outputText value="#{uploadBean.key}" />',
    'onQueueComplete' : function(queueData) {
        $('.checkIn').click();
    } 
}); 
```

在我的要求中，我需要在单击表单的提交按钮时上传所有文件，而不是在将文件添加到队列中时。这就是我设置`'auto': false`. uploadify 文件夹已放在我项目的 Web 内容中，因此该插件无法找到该`uploadify.swf`文件和取消按钮的图像。我必须修改`jquery.uploadify.js`第 99 行，并将其更改为`swf: 'uploadify/uploadify.swf'`第`uploadify.css`74 行，并将其更改为：

```
.uploadify-queue-item .cancel a {
    background: url('../uploadify/uploadify-cancel.png') 0 0 no-repeat;
    float: right;
    height: 16px;
    text-indent: -9999px;
    width: 16px;
} 
```

`background`设置为，`url('../img/uploadify-cancel.png') 0 0 no-repeat;`但我没有 img 文件夹。

## 小服务程序

对于上传文件，我使用了`Servlet`, 即`UplaodServlet`; 这个servlet的配置是：

```
<servlet>
    <servlet-name>UploadServlet</servlet-name>
    <servlet-class>com.mhis.massupload.servlet.UploadServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>UploadServlet</servlet-name>
    <url-pattern>/uploadservlet</url-pattern>
</servlet-mapping> 
```

`uploadservlet`已被用作的配置的`uploader`属性`uploadify`。我还需要传递一个唯一键作为`Servlet`. 的代码`Servlet`是：

```
package com.mhis.massupload.servlet;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.logging.Logger;

import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.fileupload.FileItem;
import org.apache.commons.fileupload.disk.DiskFileItemFactory;
import org.apache.commons.fileupload.servlet.ServletFileUpload;

public class UploadServlet extends HttpServlet {

    @SuppressWarnings("compatibility:-6472602315203858426")
    private static final long serialVersionUID = -3714619333861571457L;
    private transient Logger log = Logger.getLogger(getClass().getName());

    @Override
    public void init(ServletConfig config) throws ServletException {
        super.init(config);
    }

    @Override
    public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException {
        boolean isMultipartContent = ServletFileUpload.isMultipartContent(request);

        if (!isMultipartContent) {
            return;
        }

        FileItem fileField = null;
        try {
            DiskFileItemFactory factory = new DiskFileItemFactory();
            ServletFileUpload upload = new ServletFileUpload(factory);
            upload.setHeaderEncoding("UTF-8");
            upload.setSizeMax(-1);

            List<FileItem> items = upload.parseRequest(request);
            final Map<String, String[]> parameterMap = new HashMap<String, String[]>();

            for (FileItem item : items) {
                if (!item.isFormField()) {
                    fileField = item;
                }
            }
        } catch (Exception ex) {
            log.severe(ex.getMessage());
        }

        if (fileField == null) {
            return;
        }

        String key = request.getParameter("key");

        List<FileItem> fileFields = (List<FileItem>)getServletContext().getAttribute(key);

        if (fileFields == null) {
            fileFields = new ArrayList<FileItem>();
            getServletContext().setAttribute(key, fileFields);
        }

        fileFields.add(fileField);
    }
} 
```

我无法用来`Session`放置有关上传文件的信息，所以我`ServletContext`改用了。有关更多信息，请参阅[此处](https://stackoverflow.com/questions/14275732/passing-value-from-servlet-to-jsf-action-method-in-weblogic)。

## JSF 页面和上传按钮

由于我的需求是只有在验证后提交表单时才上传文件，所以我`'auto': false`在uploadify的配置中进行了设置。但这给了我一个麻烦，我已经在我原来的问题中发布了这个问题。为了解决这个问题，我宣布了三个`input[type=button]`. 其中两个是普通的 HTML 按钮，最后一个是`<h:commandButton/>`. 我已将此可见性设置`<h:commandButton/>`为 false，并使用了一个虚拟按钮来启动文件上传。上传完成后，我以编程方式生成了`click`.jspx`. Also I have shown a dummy button which don't have any click event associated with it; this the fail safe if, someone clicks on the Upload button twice during the upload is taking place then the the aforementioned click event fire will work unexpectedly. That why I am showing and hiding the buttons. Here is the completed`页面：

```
<?xml version='1.0' encoding='utf-8'?>
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page" version="2.1"
          xmlns:f="http://java.sun.com/jsf/core"
          xmlns:h="http://java.sun.com/jsf/html">
    <jsp:output omit-xml-declaration="true" doctype-root-element="HTML"
    doctype-system="http://www.w3.org/TR/html4/loose.dtd"
    doctype-public="-//W3C//DTD HTML 4.01 Transitional//EN"/>
    <jsp:directive.page contentType="text/html;charset=utf-8"/>
    <f:view>
    <html>
        <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <script src="js/jquery-1.8.3.min.js" type="text/javascript"></script>        
        <script src="uploadify/jquery.uploadify.js" type="text/javascript"></script>
        <link rel="stylesheet" media="screen" href="uploadify/uploadify.css" type="text/css"/>

        <script type="text/javascript">
            $(function() {
            $('#uploadify').uploadify({
                'auto': false,
                'buttonText' : 'Browse',
                'fileSizeLimit': 0,
                'swf': 'uploadify/uploadify.swf',
                'uploader': '${pageContext.request.contextPath}/uploadservlet?key=<h:outputText value="#{uploadBean.key}" />',
                'onQueueComplete' : function(queueData) {
                $('.checkIn').click();
                } 
            });                                         

            $('input[name=actualCheckIn]').on('click', function(event){
                event.stopPropagation();
                $(this).hide();
                $('input[name=fakeCheckIn]').show();
                $('#uploadify').uploadify('upload','*');                
                return false;
            });
            });    

            var upload = function() {           
            }
        </script>

        <title>Upload</title>
        </head>
        <body>
        <h:form enctype="multipart/form-data">
            <input id="uploadify" type="file"/>
            <h:commandButton value="Check In" action="#{uploadBean.upload}" styleClass="checkIn" style="display: none"/>
            <input type="button" value="Check In" name="actualCheckIn"/>
            <input type="button" value="Check In" onclick="return false;" name="fakeCheckIn" style="display: none"/>
        </h:form>
        </body>
    </html>
    </f:view>
</jsp:root> 
```

通过这种方式，当uplaodify 完成时，它会上传到servlet，触发JSF。

## 托管豆

托管 bean 具有作用域`Session`，这里是它的代码：

```
package com.mhis.massupload.bean;

import com.mhis.massupload.dto.DocInfo;

import java.io.Serializable;

import java.util.ArrayList;
import java.util.List;
import java.util.UUID;
import java.util.logging.Level;
import java.util.logging.Logger;

import javax.faces.context.FacesContext;

import javax.servlet.ServletContext;

import oracle.stellent.ridc.IdcClientException;

import org.apache.commons.fileupload.FileItem;
import org.apache.commons.lang3.StringUtils;

public class UploadBean implements Serializable {
    @SuppressWarnings("compatibility:-930710930183135088")
    private static final long serialVersionUID = -491462816764274947L;
    private transient Logger log = Logger.getLogger(getClass().getName());

    private String key;
    private transient Service service;

    public UploadBean() throws IdcClientException {
        init();
    }

    private void init() throws IdcClientException {
        key = UUID.randomUUID().toString();        
    }

    public String upload() {
        List<FileItem> fileFields = (List<FileItem>) FacesContext.getCurrentInstance().getExternalContext().getApplicationMap().remove(key);
        List<DocInfo> docInfos = new ArrayList<DocInfo>();

        if (fileFields != null) {
            for (FileItem fileField : fileFields) {
                if(StringUtils.isNotBlank(fileField.getName())) {
                    try {
                        System.out.println("Check in: " + fileField.getName());
                    } catch (Exception e) {
                        log.log(Level.SEVERE, e.getMessage());
                    }
                }                
            }
        }

        FacesContext.getCurrentInstance().getExternalContext().getSessionMap().put("docInfos", docInfos);

        return "report";
    }

    public void setKey(String key) {
        this.key = key;
    }

    public String getKey() {
        return key;
    }
} 
```

这就像魅力一样。

希望它会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:04:15.840

为此，您将需要一个 servlet。我已经回答了 Uploadify + Servlet 问题，之前应该提供足够的线索：[Uploadify plugin doesn't call Java Servlet](https://stackoverflow.com/questions/2272160/uploadify-plugin-doesnt-call-java-servlet/2273711#2273711)。SWFUpload 和 YUI Uploader 的概念没有什么不同。请注意，您可以毫无问题地将纯 HTML 放入 JSF 页面。

您的主要问题是使 JSF 支持 bean 和 HTTP servlet 能够相互交换数据。为此，应使用 HTTP 会话。首先让 JSF bean 在初始请求时生成一个唯一键，该键将用作会话属性名称：

```
key = UUID.randomUUID().toString(); 
```

然后，在您告诉 Uploadify/SWFUpload/etc 使用的上传 URL 中，您需要包含`jsessionid`URL 片段（以便 servlet 将使用相同的 HTTP 会话）和`key`as URL 查询字符串参数（以便 servlet 将使用此键存储有关文件上传的相关状态）。假设您需要将其指定为 JS 对象键：

```
url: '${pageContext.request.contextPath}/uploadServlet;jsessionid=${pageContext.session.id}?key=<h:outputText value="#{uploadBean.key}" />' 
```

现在，servlet 将在同一个 HTTP 会话中被调用（即`request.getSession()`与 JSF 中可用的会话完全相同`ExternalContext#getSession()`，其属性为`getSessionMap()`）。因此，`doPost()`只需执行以下操作：

```
String key = request.getParameter("key");
request.getSession().setAttribute(key, someStateAboutTheUpload); 
```

最后，当 JSF 即将处理表单提交时，只需通过 key 获取所需的数据（通过请求范围 bean`<input type="hidden">`或`<t:saveState>`在请求范围 bean 的情况下为后续请求存储这些数据）：

```
SomeState someState = (SomeState) externalContext.getSessionMap().get(key); 
```

唯一键对于功能来说不是必需的，它甚至可以是静态键，但是基于每个视图生成的键可确保当最终用户在多个浏览器选项卡/窗口中打开相同视图时数据不会发生冲突同一个会话。

# ivy - 将特定 jar 检索到文件夹

> ID：14260585
> 
> 赞同：0
> 
> 时间：2013-01-10T14:50:37.433
> 
> 标签：ivy

我要从 ivy 缓存中检索一个 jar 到 lib 文件夹，下面是 ivy.xml 代码：

```
 <configurations>
        <conf name="specificFolder"  description="add jar to web-inf/lib folder"/>
    </configurations>
    <dependencies>
        <dependency org="javax.servlet" name="servlet-api" rev="2.4" transitive="false" conf="specificFolder"/>
        <dependency org="org.springframework" name="spring-beans" rev="2.5.5" transitive="false" />
        <dependency org="org.springframework" name="spring-webmvc" rev="2.5.5" transitive="false" />
        <dependency org="org.springframework" name="spring-web" rev="2.5.5" transitive="false" />
        <dependency org="org.springframework" name="spring-context" rev="2.5.5" transitive="false" />
        <dependency org="org.springframework" name="spring" rev="1.2.6" transitive="false" /> 
```

那么这是蚂蚁目标：

```
<target name="test">
    <ivy:retrieve pattern="lib/[artifact](.[ext])" sync="true" type="jar" conf="specificFolder"/>
</target> 
```

但是我得到了“未解决的依赖”，这是我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T21:41:11.253

我重现了您的问题，这是相关的错误消息：

```
[ivy:resolve]       ::::::::::::::::::::::::::::::::::::::::::::::
[ivy:resolve]       ::          UNRESOLVED DEPENDENCIES         ::
[ivy:resolve]       ::::::::::::::::::::::::::::::::::::::::::::::
[ivy:resolve]       :: javax.servlet#servlet-api;2.4: configuration not found in javax.servlet#servlet-api;2.4: 'specificFolder'. It was required from com.myspotontheweb#demo;????? specificFolder
[ivy:resolve]       :::::::::::::::::::::::::::::::::::::::::::::: 
```

根本原因是以下依赖声明：

```
<dependency org="javax.servlet" name="servlet-api" ... conf="specificFolder"/> 
```

虽然配置存在于您的模块中，但它不存在于远程 Maven 模块中。有关如何查看以下答案的更多详细信息：

*   [Maven 范围如何通过 ivy 映射到 ivy 配置](https://stackoverflow.com/questions/7104364/how-are-maven-scopes-mapped-to-ivy-configurations-by-ivy/7116577#7116577)

# 工作示例

## 常春藤.xml

```
<ivy-module version="2.0">
    <info organisation="com.myspotontheweb" module="demo"/>

    <configurations>
        <conf name="specificFolder"  description="add jar to web-inf/lib folder"/>
    </configurations>
    <dependencies>
        <dependency org="javax.servlet" name="servlet-api" rev="2.4"            conf="specificFolder->master"/>
        <dependency org="org.springframework" name="spring-beans" rev="2.5.5"   conf="specificFolder->master"/>
        <dependency org="org.springframework" name="spring-webmvc" rev="2.5.5"  conf="specificFolder->master"/>
        <dependency org="org.springframework" name="spring-web" rev="2.5.5"     conf="specificFolder->master"/>
        <dependency org="org.springframework" name="spring-context" rev="2.5.5" conf="specificFolder->master"/>
        <dependency org="org.springframework" name="spring" rev="1.2.6"         conf="specificFolder->master"/>
    </dependencies>

</ivy-module> 
```

笔记：

*   此示例使用配置映射而不是“transitive=false”。本地配置是“specificFolder”，远程配置是特殊的“master”。“master”由 Maven 模块提供，表示没有依赖关系的远程工件。我认为一旦了解了配置的工作原理，这种方法就更简单了。（Maven中非常强大的概念）
*   [ivy 依赖部分中的小箭头 -> 做什么？](https://stackoverflow.com/questions/13582419/what-does-the-little-arrow-do-in-the-ivy-dependency-section/13597757#13597757)

# parallel-processing - opencl - 多个命令队列的资源

> ID：14260587
> 
> 赞同：1
> 
> 时间：2013-01-10T14:50:40.267
> 
> 标签：parallel-processing, task, opencl

我正在开发一个应用程序，我在我的 GPU 上实时处理视频源，除此之外，我偶尔还需要在我的 GPU 上进行一些资源广泛的计算。我现在的问题是，我想保持我的视频处理实时速度，同时在它出现后并行执行额外的工作。

我认为应该这样做的方式是使用两个命令队列，一个用于实时视频处理，一个用于大量计算。但是，我不知道 GPU 的计算资源会如何结果：在并行执行期间是否会有同样多的工作人员分配给命令队列？（所以我可以预期我的实时计算会减慢约 50%？）还是取决于设备？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T18:55:42.223

OpenCL 规范让供应商决定如何平衡多个命令队列之间的执行资源。因此，供应商可以以一种使 GPU 一次只能在一个内核上工作的方式来实现 OpenCL。在我看来，这将是一个合法的实施。

如果您真的想以独立于设备的方式解决您的问题，我认为您需要弄清楚如何将大型非实时计算分解为较小的计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T19:46:11.030

AMD 为设备裂变提供了一些扩展（我认为其中一些已在 OpenCL 1.2 中采用），这意味着您可以为一个上下文保留设备的某些部分，并将其余部分用于其他上下文。

# asp.net - 如何将 ELMAH 配置为仅为 Sitecore 用户显示日志

> ID：14260588
> 
> 赞同：1
> 
> 时间：2013-01-10T14:50:40.967
> 
> 标签：asp.net, sitecore, sitecore6, elmah

我在我的 Sitecore 解决方案中添加了 Elmah 工具，实际上我在这里做了 [http://newguid.net/sitecore/2011/using-elmah-for-error-logging-within-sitecore/](http://newguid.net/sitecore/2011/using-elmah-for-error-logging-within-sitecore/) 我启用的只有一个卷是*allowRemoteAccess*属性,

```
<elmah>
<security allowRemoteAccess="1" />  
</elmah> 
```

现在日志可用于任何地方的每个人，但我只想为登录（授权）到 sitecore 的用户（sitecore 用户）显示它

我该如何管理它？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:52:24.210

不知道现在`Elmah`内置了什么，但我曾经这样做：

```
<location path="elmah.axd">
    <system.web>
        <authorization>
            <allow roles="SITECORE_USERS"/> <!---put your role here-->
            <deny users="*"/> 
        </authorization>
    </system.web>
</location> 
```

[保护 ASP.NET 网站中的 Elmah RSS 源](https://stackoverflow.com/questions/2543296/securing-elmah-rss-feeds-in-asp-net-website/5131437#5131437)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T13:42:49.953

在研究了 elmah 源代码和这篇文章[http://dotnetslackers.com/articles/aspnet/Securing-ELMAH-with-Independent-HTTP-Authentication.aspx](http://dotnetslackers.com/articles/aspnet/Securing-ELMAH-with-Independent-HTTP-Authentication.aspx)后，我找到了解决方案。用户可以为我接下来做的自定义 IHttpModule 实现 IRequestAuthorizationHandler：

```
 public class SitecoreAuthModule :IHttpModule, IRequestAuthorizationHandler
{
    public bool Authorize(HttpContext context)
    {
        return SC.Context.User.IsAdministrator;
    }

    public void Init(HttpApplication context)
    {
        context.AuthenticateRequest += new EventHandler(ContextAuthenticateRequest); ;
    }

    void ContextAuthenticateRequest(object sender, EventArgs e)
    {
        var context = sender as HttpApplication;
        if (context.Request.Path.IndexOf("elmah.axd",
            StringComparison.InvariantCultureIgnoreCase) < 0)
            return;
    }

    public void Dispose()
    {

    }
} 
```

# jquery - 无法按 ID 从输入字段中获取值

> ID：14260600
> 
> 赞同：0
> 
> 时间：2013-01-10T14:51:16.097
> 
> 标签：jquery

我有这样的表单字段：

```
<input name='task_complete_percentage[]' value='' onchange='' class='percent' id='task_complete_percentage[]' style='width:40px;' type='text' />
<input name='task_complete_percentage[]' value='' onchange='' class='percent' id='task_complete_percentage1" + counter + "' style='width:40px;' type='text' />
<input name='task_complete_percentage[]' value='' onchange='' class='percent' id='task_complete_percentage2" + counter + "' style='width:40px;' type='text' />
<input name='task_complete_percentage[]' value='' onchange='' class='percent' id='task_complete_percentage3" + counter + "' style='width:40px;' type='text' /> 
```

字段是动态添加的，我想对所有值求和。

```
 $('[id *= "task_complete_percentage"]').change(function(){             
 $('[id *= "task_complete_percentage"]').each( function () {
 console.log('test');
  }); 
}); 
```

但只有第一个字段有效，但如果这样做，我可以看到所有值。我做错了什么？

```
 $("#addElement").click(function(){             
 $('[id *= "task_complete_percentage"]').each( function () {
   console.log('test');
 }); 
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:15:05.893

似乎不需要 ID 参数 - 我们可以通过 jQuery 使用其他参数/​​技术来处理这些字段

```
<div id="task_complete_percentage_fields">
  <input name='task_complete_percentage[]' value='' class='percent' type='text' />
  <input name='task_complete_percentage[]' value='' class='percent' type='text' />
  <input name='task_complete_percentage[]' value='' class='percent' type='text' />
  <input name='task_complete_percentage[]' value='' class='percent' type='text' />
</div>
<div id="output"></div>
<div id="addElement">Add another row</div> 
```

也许使用一些 CSS 来处理宽度，而不是为每个设置样式属性

```
#task_complete_percentage_fields input.percent { width:40px } 
```

字段是动态添加的，我想对所有值求和。

```
// Init the Sum Variable
var percentageSum = 0;

// Create a Function to Tally the Percentages
function sumPercentages(){
  // Reset the Sum
  percentageSum = 0;
  // Loop through the Fields
  $('#task_complete_percentage_fields input.percent').each(function(k,v){
    var $v = $(v);
    // Strip non-numerals
    $v.val( $v.val().replace( /\D/g , '' ) );
    // Sum the Percentages
    percentageSum += 1*$(v).val();
  });
  // Output the Sum
  $('#output').text( percentageSum );
}

$(document).ready(function(){

    // Attach a delegated live event to the fields within the div
    $('#task_complete_percentage_fields').on( 'change' , 'input.percent' , function(){
      sumPercentages();
    });

    // You can also call the same function from any other function
    $('#addElement').click(function(){
      $('#task_complete_percentage_fields')
        .append("<input name='task_complete_percentage[]' value='' class='percent' type='text' />");
      sumPercentages();
    });

    sumPercentages();

}); 
```

在 JSFiddle 上查看 - [http://jsfiddle.net/lucanos/P5f4J/1/](http://jsfiddle.net/lucanos/P5f4J/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:56:10.057

尝试这样使用——

```
$(".percent").each( function () {
 console.log('test');
  }); 
```

# python - 如何选择单选按钮并提交表单

> ID：14260601
> 
> 赞同：1
> 
> 时间：2013-01-10T14:51:18.373
> 
> 标签：python, mechanize

这是 HTML：

```
<form method="post" action="./xxxxx" name="form1">
    <input type="hidden" name="requestKey" value="52032a76cf53340b07052fd143feddc4a9d8f18130c80ec86003ab56e0d91b36"/>
    <input type="hidden" name="option" value="txnlist">
    <input type="hidden" name="account" value='1336169999'>
    <input type="hidden" name="app" value="D">
    <input type="hidden" name="lockType" value="">

    <p><span class="header2">&nbsp;Statement options </span>
        <table summary="" width="100%" border="0" cellpadding="1" cellspacing="1">
            <tr>
                <td width="20"></td>
                <td width="20"><input type="radio"  name="optDateFilter" value="1"></td>
                <td>Transactions for the last 30 days</td>
                <td></td>
            </tr>
            <tr>
                <td width="20"></td>
                <td width="20"><input type="radio" name="optDateFilter"  value="2"></td>
                <td>Transactions for the last 90 days</td>
                <td></td>
            </tr>
            <tr>
                <td width="20">&nbsp;</td>
                <td width="20"><input type="radio" name="optDateFilter" checked='checked' value="3" style="vertical-align: middle"></td>
                <td>
                    <div>
                        <font style="vertical-align: middle;">Transactions from&nbsp;</font>
                        <script src='jquery/js/ui/min/jquery.ui.datepicker.min-1.8.10.js'></script>
                        <script type='text/javascript'>$(function() {$('#datepicker1').datepicker( { changeMonth : true, changeYear : true, dateFormat : 'dd/mm/yy', showOn: 'both', buttonImage: 'images/calendar.png', buttonImageOnly: true }); }); </script>
                        <input type='text' id='datepicker1' name='txtFromDate' size='11' maxlength='10' value='14/12/2012' onchange="checkFromDate(document.form1.txtFromDate.value);document.form1.optDateFilter[2].checked = true;">
                        <font style="vertical-align: middle;">to</font>
                        <script type='text/javascript'>$(function() {$('#datepicker2').datepicker( { changeMonth : true, changeYear : true, dateFormat : 'dd/mm/yy', showOn: 'both', buttonImage: 'images/calendar.png', buttonImageOnly: true }); }); </script>
                        <input type='text' id='datepicker2' name='txtToDate' size='11' maxlength='10' value='01/01/2013' onchange="checkToDate(document.form1.txtFromDate.value,document.form1.txtToDate.value);document.form1.optDateFilter[2].checked = true;">
                    </div>
                </td>
                <td><font style="font-size: 8pt; vertical-align: middle;"><i>(maximum date range 3 months)</i></font></td>
            </tr>
        </table>
        <table summary="" cellpadding="1" cellspacing="1" border="0">
            <tr>
                <td width="20">&nbsp;</td>
                <td width="20">
                    <a  href="javascript:if(document.form1.optDateFilter[2].checked==true){CheckAndSubmit(document.form1.txtFromDate.value,document.form1.txtToDate.value);}else{showOverlay();document.form1.submit();};">
                         <img src="images/proceed.gif" alt="Show the selected range of transactions" border="0" width="22" height="22" />
                    </a>
                </td>
                <td>
                    <a  href="javascript:if(document.form1.optDateFilter[2].checked==true){CheckAndSubmit(document.form1.txtFromDate.value,document.form1.txtToDate.value);}else{showOverlay();document.form1.submit();};" title="Show the selected range of transactions">Show the selected range of transactions</a>
                </td>
            </tr>
    </table>
</form> 
```

这是我拥有的代码，但它不起作用：

```
self.browser.select_form('form1')
self.browser.form.set_all_readonly(False)
self.browser['txtFromDate'] = '28/12/12'
self.browser['txtToDate'] = '01/01/13'
resp = self.browser.submit()
html = resp.read() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T07:41:09.000

我想我必须这样做

```
 self.browser.select_form('form1')
    self.browser['optDateFilter'] = ['2'] 
    self.browser.form.find_control(name="txtFromDate", id="datepicker1").value = "13/10/12"
    self.browser.form.find_control(name="txtToDate", id="datepicker2").value = "01/01/13"
    resp = self.browser.submit() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T09:03:51.760

mechanize 有一个奇怪的怪癖：由于 HTML 文档中可以有多个同名的单选按钮元素，因此它坚持使用列表作为值，即使任何时候都只能选择一个单选按钮。这意味着你需要使用这个：

```
 self.browser.form.find_control(name='optDateFilter').value = ['2'] 
```

这同样适用于更有意义的复选框，因为允许用户选择多个值。

# jquery - 使用两列对 HTML 表格数据进行排序

> ID：14260607
> 
> 赞同：0
> 
> 时间：2013-01-10T14:51:30.200
> 
> 标签：jquery

```
Vector  VectorMode          VectorBaseDate
5       4                       2012-06-16
5       3                       2013-06-16
5       2                       2012-06-16
5       1                       2012-06-16
5       1                       2013-06-16
5       2                       2013-06-16
5       3                       2012-06-16
5       4                       2013-06-16 
```

这是我通过使用 jquery ajax 调用读取一些 xml 文件来创建的 html 表。首先我想按日期排序，然后按模式排序。所以结果应该是这样的。

```
Vector  VectorMode          VectorBaseDate
5       1                       2012-06-16
5       2                       2012-06-16
5       3                       2012-06-16
5       4                       2012-06-16
5       1                       2013-06-16
5       2                       2013-06-16
5       3                       2013-06-16
5       4                       2013-06-16 
```

我尝试了表格分类器插件，但没有运气。

```
$("table").tablesorter();
        $.ajax({
        type: "GET",
        url: "vector.xml",
        dataType: "xml",
        success: function(xml) {
                            $('#showVelocity').append('<table cellspacing="1" id="myTable" class="tablesorter">');
                            $('#showVelocity').append('<thead><tr><th>VectorType</th><th>VectorMode</th><th>InitialValue</th><th>VectorBaseDate</th></tr></thead>');
                            $('#showVelocity').append('<tbody>');
                            $(xml).find('Vector').each(function() {
                            var intialVal = $(this).find('InitialValue').text();
                            var vectorBaseDate = $(this).find('VectorBaseDate').text();
                            var attrValType = $(this).find('VectorType').attr('tc');
                            var attrValMode = $(this).find('VectorMode').attr('tc');
                            if (attrValType=='5') {
                                //$('#someElement').append(intialVal+'<br/>');  
                                var tr = '<tr><td>'+attrValType+'</td><td>'+attrValMode+'</td><td>'+intialVal+'</td><td>'+vectorBaseDate+'</td></tr>';
                                $('#showVelocity').append(tr);
                            };

                            $('#showVelocity').append('</tbody></table>');
                            $("table").trigger("update");
                            var sorting = [[1,0],[3,0]]; 
                            $("table").trigger("sorton",[sorting]);
                        }); 
                }
            }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:03:45.977

首先从您的 ajax 结果（数据）创建一个排序规则，并使用该`Array.Sort`函数根据特定值进行排序并创建一个表标签。看看这篇文章 [在 Javascript 中排序选择选项 - 基于同一行中的多个值](https://stackoverflow.com/questions/14212395/sorting-select-option-in-javascript-based-on-multiple-values-in-same-row/14214515#14214515)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:08:09.803

没有看到你的代码，很难说出你做错了什么，但我写了一个你想要的小提琴。

如果您发布更多代码，我可以修改它以满足您的需求。

这是代码：

```
<table class="tablesorter">
    <thead>
        <tr>
            <th>Vector</th>
            <th>VectorMode</th>
            <th>VectorBaseDate</th>
        </tr>
    </thead>
    <tbody>
        <tr>
          <td>5</td>
          <td>1</td>
          <td>2012-06-16</td>
        </tr>
        <tr>
          <td>5</td>
          <td>2</td>
          <td>2012-06-16</td>
        </tr>
        <tr>
          <td>5</td>
          <td>3</td>
          <td>2012-06-16</td>
        </tr>

    </tbody>
</table> 
```

和 JS

```
$('table').tablesorter({
        // *** Appearance ***
        // fix the column widths
        widthFixed : true,
        // include zebra and any other widgets, options:
        // 'uitheme', 'filter', 'stickyHeaders' & 'resizable'
        // the 'columns' widget will require custom css for the
        // primary, secondary and tertiary columns
        widgets    : [ 'uitheme', 'zebra' ],

        // *** Functionality ***
        // starting sort direction "asc" or "desc"
        sortInitialOrder : "asc",

        // jQuery selectors used to find the header cells.
        selectorHeaders : 'thead th',

        // *** css classes to use ***
        cssAsc        : "headerSortUp",
        cssChildRow   : "expand-child",
        cssDesc       : "headerSortDown",
        cssHeader     : "header",
        tableClass    : 'tablesorter',

        // pick rows colors to match ui theme
        widgetZebra: { css: ["ui-widget-content", "ui-state-default"] },

        // *** prevent text selection in header ***
        cancelSelection : true,

        // *** send messages to console ***
        debug : false
    }); 
```

[小提琴](http://jsfiddle.net/UH43C/)

# jquery - jQuery的追加不追加但删除

> ID：14260608
> 
> 赞同：1
> 
> 时间：2013-01-10T14:51:34.693
> 
> 标签：jquery

我有一张这样的桌子：

```
<table id="invrows">
    <tbody>
        <tr id="rowrow">
            <td><input type="text" id="idef" name="idef[]" class="required"></td>
            <td><input type="text" id="iprice" name="iprice[]" class="required"></td>
            <td><input type="text" id="ivat" name="ivat[]" class="required"></td>
            <td><div id="addrow">Add One More</div></td>
        </tr>
    </tbody>
</table> 
```

并且每次单击“addrow” div 时都希望在表中添加一个新行。所以这是我的 jQuery 代码：

```
$('#addrow').click(function(){
        $('#invrows tr:last').append($('#rowrow'));
}); 
```

但是，它没有添加一个新的“#rowrow”行（我知道这听起来很荒谬），它只是删除了这一行，从而给我留下了一张空桌子。我尝试将行的 HTML 代码添加到 .append()，这工作得很好，但我希望它与 DOM 元素一起工作，这样当原始行更改时，什么都不会被破坏，并且 jQuery 代码本身不会不需要编辑。所有帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:53:34.097

附加行的克隆，而不是原始行本身。此外，您应该删除您的 id 值，以免在克隆元素上重复它：

```
// Use event-delegation since we'll have many rows
$("#invrows").on("click", ".addrow", function (e) {

  // Clone row
  var clone = $(this).closest("tr").clone();

  // Append to table, clear inputs
  clone.appendTo(e.delegateTarget).find(":input").val('');

  // Remove add button from original row
  $(this).closest("td").remove();

}); 
```

小提琴：http: [//jsfiddle.net/jonathansampson/4MRx5/](http://jsfiddle.net/jonathansampson/4MRx5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:55:08.403

您要附加到行，而不是正文。你想要这样的东西：

```
$('#addrow').click(function(){
        $('#invrows tbody').append($('#rowrow').clone());
}); 
```

哦，正如其他人所说，要么克隆元素，要么直接获取 html。（编辑代码以反映这一点）。

此外，您最终会得到具有相同 id 的两行，这也不是很好。:)

还有一件事，查看[.clone()](http://api.jquery.com/clone/)的文档，看起来它实际上是必需的，否则 jquery 只会移动实际的元素。请参阅那里的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T15:18:14.630

创建一个函数，该函数返回一个新行供您追加。

```
function newRow (table) {
    var html = '<tr id="rowrow' + (table.tBodies[0].rows.length + 1) + '">' +
        '<td><input type="text" id="idef" name="idef[]" class="required"></td>' +
        '<td><input type="text" id="iprice" name="iprice[]" class="required"></td>' +
        '<td><input type="text" id="ivat" name="ivat[]" class="required"></td>' +
        '<td><div id="addrow">Add One More</div></td>' +
    '</tr>';
    $(table.tBodies[0]).append(html);
} 
```

这里正在使用：

```
var $table = $('#invrows');
$('#addrow').click(function(){
    $table.append(newRow($table[0]));
}); 
```

现在，如果您需要修改结构，只需在 newRow 函数中进行即可。您也可以使用模板引擎。

**请注意，您的所有输入和 addRow div 仍然存在重复 ID 问题。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T14:54:53.267

你想要做的是追加 rowrow 的 html 内容，所以改为尝试：

```
$('#addrow').click(function(){
    $('#invrows tr:last').append($('#rowrow').html()); 
```

});

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T14:57:43.230

你不应该使用 append()。有了这个，您将在父行中插入新表行。我认为您需要使用 after() 来达到您的目的。

```
$('#addrow').click(function(){
        $('#invrows tr:last').after($('#rowrow').clone());
}); 
```

# android - 当用户单击按钮时显示全屏

> ID：14260618
> 
> 赞同：-1
> 
> 时间：2013-01-10T14:52:05.847
> 
> 标签：android, onclick, android-fullscreen

我知道标题含糊，希望图片能帮助你理解我想要什么。看看当按钮被按下时它不会占据整个屏幕，所以用户在他的屏幕上有更多的空间。它比标签更有用，也就是说我为什么要问。谢谢你的时间。

![在此处输入图像描述](../Images/5aa0031715d650d277a5fc80af59f49e.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T14:55:13.727

[github 上](https://github.com/jfeinstein10/SlidingMenu)有一个开源库，称为 SlidingMenu ，它可以实现您想要实现的目标。

[您可以在此处](https://github.com/jfeinstein10/SlidingMenu/tree/master/example)查看示例，也可以在[此处](https://play.google.com/store/apps/details?id=com.slidingmenu.example)下载 Google Play 演示应用程序。

# xaml - 在 XAML GridView (Win8 / Metro) 中水平排序项目

> ID：14260632
> 
> 赞同：4
> 
> 时间：2013-01-10T14:52:39.607
> 
> 标签：xaml, gridview, windows-8, microsoft-metro

如何在 XAML 中对 GridView 的项目进行水平排序？可悲的是，我没有找到实现这一目标的方法。关键字“方向”不可用。这是我当前的 GridView：

```
 <GridView x:Name="TestDataBinding"
                HorizontalContentAlignment="Left"
                VerticalContentAlignment="Top"
                SelectionMode="None"
                ItemsSource="{Binding}"
                ItemTemplateSelector="{StaticResource itemTemplateSelector}"
                Margin="0,60,0,0"
                Width="1100" Height="540"
            /> 
```

另一种方式可能是“VariableSizedWrapGrid”。但这不能用于通过“ItemsSource”（和 ItemTemplateSelector）创建项目。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-11T05:15:32.217

抱歉，我不得不对您的评论提出异议，即这不能用 VariableSizedWrapGrid 完成。它肯定可以：

```
<GridView>
    <GridView.ItemsPanel>
        <ItemsPanelTemplate>
            <VariableSizedWrapGrid Orientation="Horizontal" />
        </ItemsPanelTemplate>
    </GridView.ItemsPanel>
    <x:String>One</x:String>
    <x:String>Two</x:String>
    <x:String>Three</x:String>
    <x:String>Four</x:String>
</GridView> 
```

而且我不得不考虑 VariableSizedWrapGrid 不能用于通过 ItemsSource 创建项目。它**肯定**可以。WrapGrid 和 VariableSizedWrapGrid 基本相同。WrapGrid 的重量稍轻，因为它不支持列和行跨越。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-10T23:30:06.067

添加一个 ItemsPanelTemplate 来控制项目的排列方式，例如，

```
<GridView.ItemsPanel>
    <ItemsPanelTemplate>
        <WrapGrid Orientation="Horizontal"/>
    </ItemsPanelTemplate>
</GridView.ItemsPanel> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-01T16:30:36.433

只需设置 ItemsWrapGrid 的方向：

```
<GridView.ItemsPanel>
    <ItemsPanelTemplate>
        <ItemsWrapGrid Orientation="Horizontal"/>
    </ItemsPanelTemplate>
</GridView.ItemsPanel> 
```

# java - JRebel maven 多模块

> ID：14260633
> 
> 赞同：4
> 
> 时间：2013-01-10T14:52:42.857
> 
> 标签：java, jrebel, javarebel

如何为多模块 Maven 项目配置 JRebel？现在，我将 JRebel 插件添加到我的父级，并使用命令`pom.xml`生成了几个`rebel.xml` *文件*（*每个`rebel.xml`子模块一个）。*为每个模块`jrebel:generate`生成多个文件是否正确？`rebel.xml`

编辑：最后，我所有的模块都将收集在单个 EAR 中。所以这意味着我需要`JRebel-maven-plugin`从父级中删除`pom.xml`并仅为我项目的 EAR 模块的 pom.xml 声明它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T15:03:54.753

生成的每个“工件”都需要有自己的 rebel.xml 文件与之关联。如果您查看 rebel.xml 的内容，它只是指向 JRebel 可以找到源目录的位置，并且这些是由 maven 插件生成的绝对路径以方便使用。

我肯定会将 JRebel 插件放在一个单独的配置文件中，该配置文件仅在开发机器上有效，这样您就不会为生产生成这些文件。

对于耳朵，您不需要删除插件。我不认为它会伤害任何东西，你只是不会从中获得太多好处。JRebel 将为所有单独的 jars/wars 找到 rebel.xml 文件，并根据需要使用它们。

简而言之，您将它们添加到正确的位置。

# json - SlickGrid Ajax 调用空行

> ID：14260634
> 
> 赞同：1
> 
> 时间：2013-01-10T14:52:46.080
> 
> 标签：json, jquery, slickgrid

我有一个带有 AJAX 调用的 SlickGrid。我在 Chrome 下跟踪它，发现数据是正确的，但网格显示所有空行。知道为什么吗？

## 网络服务

```
 [System.Web.Services.WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public static string LoadUsers()
    {
        List<Person> users = new List<Person>();
        using (SqlConnection conn = UtWeb.ConnectionGet())
        {
            conn.Open();
            SqlCommand command = new SqlCommand("UserGet", conn);

            using (SqlDataReader r = command.ExecuteReader())
            {
                while (r.Read())
                {
                    Person person = new Person();
                    person.LoginName = r["LoginName"].ToString();
                    person.FirstName = r["FirstName"].ToString();
                    person.LastName = r["LastName"].ToString();
                    users.Add(person);
                }
            }
        }

        MemoryStream stream = new MemoryStream();
        DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(Person[]));
        serializer.WriteObject(stream, users.ToArray());
        stream.Position = 0;
        StreamReader streamReader = new StreamReader(stream);
        return streamReader.ReadToEnd();            
    } 
```

## 代码

```
<script src="../Scripts/jquery-1.7.2.min.js"></script>
<script src="../Scripts/jquery.event.drag.min.js"></script>

<script src="../Scripts/SlickGrid/slick.core.js"></script>
<script src="../Scripts/SlickGrid/slick.grid.js"></script>
<script>

    var grid;
    var loader;
    var columns = [
    { id: "login-name", name: "Login Name", field: "LoginName" },
    { id: "firstname", name: "First Name", field: "FirstName" },
    { id: "lastname", name: "Last Name", field: "LastName" }
  ];

    var options = {
        editable: false,
        enableAddRow: false,
        enableCellNavigation: true,
        enableColumnReorder: false
    };

    $(document).ready(function () {
        $.ajax({
            url: 'TestSlickGrid.aspx/LoadUsers',
            async: false,
            data: "{}",
            dataType: "json",
            type: "POST",
            contentType: "application/json; charset=utf-8",
            success: OnSuccess,
            failure: function (response) {
                alert("ajax fail!");
            }
        });
        function OnSuccess(response) {
            if (parseInt(response) == 0)
                alert(response.d);
            else {
                loader = response; 
                grid = new Slick.Grid("#myGrid", loader.d, columns, options);
            }

        }
    });    
</script> 
```

在 Chrome 中，它显示 loader.d = "[{"FirstName":"b","LastName":"bb","LoginName":"b"},{"FirstName":"","LastName": "","LoginName":"test1"},{"FirstName":"","LastName":"","LoginName":"test2"}]"

```
 loader = '{"employees":' + response.d + '}'; 
        var obj = eval("(" + loader + ")");
        grid = new Slick.Grid("#myGrid", obj.employees, columns, options); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-23T12:39:05.883

尝试为将嵌入网格的 div 赋予一些高度。在您的情况下，我相信您的 div 名称是`myGrid`.

尝试为这个 div 定义一些高度，它会起作用。我遇到了这个问题，并且能够通过仅定义我的 div 的高度来解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T18:22:34.423

解析为`loader.d`JSON，`alert(loader.d[0].LoginName)`显示什么？

# python - 开发过程中的功能测试

> ID：14260641
> 
> 赞同：1
> 
> 时间：2013-01-10T14:53:04.427
> 
> 标签：python, testing

我没有接触过许多测试框架，并且想知道在开发阶段实现以下（功能测试）的任何建议。目的是通过暴露的 http (REST/JSON RPC) 接口测试 Web 应用程序功能（与语言无关？）。

我的后端不是用 Python 编写的，但由于易于使用`requests`库和创建 Ad hoc http 请求，我只需使用适当的 cookie、有效负载等构造 http POST/GET 请求并检查响应以验证服务器的正确性。

启用特定的测试用例（注释掉/布尔标志）并验证结果并不乏味。在经常更改是常态的开发阶段，任何使这种情况变得更加愉快的框架。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T11:50:31.480

用于`nose`运行您的测试。在这种情况下，您可以将测试的基类声明为：

```
class SlowTestBase(BaseTestCase):
    slow = True 
```

和运行它一样`nosetests --attr="slow"`，或者排除它们`--attr="!slow"`。[您可以在https://nose.readthedocs.org/en/latest/](https://nose.readthedocs.org/en/latest/)找到有关鼻子文档的更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T14:55:18.797

那么你在正确的轨道上，`requests`你可以直接将它与[鼻子](https://nose.readthedocs.org/en/latest/)或[单元](http://docs.python.org/2/library/unittest.html)测试或任何现有的常见python测试框架联系起来，`requests`实际上是为测试而编写的一些背景`flask`

# r - 如何控制 write.table() 输出中的小数位数？

> ID：14260646
> 
> 赞同：56
> 
> 时间：2013-01-10T14:53:30.300
> 
> 标签：r, excel, number-formatting, decimal-point, output-formatting

处理数据时（例如，在 data.frame 中），用户可以通过使用来控制显示数字

```
options(digits=3) 
```

并像这样列出data.frame。

```
ttf.all 
```

当用户需要像这样在 Excel 中粘贴数据时

```
write.table(ttf.all, 'clipboard', sep='\t',row.names=F) 
```

数字参数被忽略，数字不四舍五入。

看到漂亮的输出

```
> ttf.all
  year V1.x.x V1.y.x ratio1 V1.x.y V1.y.y ratioR V1.x.x V1.y.x ratioAL V1.x.y V1.y.y ratioRL
1 2006    227    645   35.2     67    645   10.4    150    645    23.3     53    645    8.22
2 2007    639   1645   38.8    292   1645   17.8    384   1645    23.3    137   1645    8.33
3 2008   1531   3150   48.6    982   3150   31.2    755   3150    24.0    235   3150    7.46
4 2009   1625   3467   46.9   1026   3467   29.6    779   3467    22.5    222   3467    6.40 
```

但是excel（剪贴板）中的内容不是四舍五入的。怎么控制进去`write.table()`？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-01-12T19:47:24.050

You can use the function `format()` as in:

```
write.table(format(ttf.all, digits=2), 'clipboard', sep='\t',row.names=F) 
```

`format()` is a generic function that has methods for many classes, including data.frames. Unlike `round()`, it won't throw an error if your dataframe is not all numeric. For more details on the formatting options, see the help file via `?format`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-03-18T03:03:55.060

为具有混合列`character`的数据框添加解决方案。`numeric`我们首先用于[`mutate_if`](https://suzan.rbind.io/2018/02/dplyr-tutorial-2/#mutate-if)选择`numeric`列，然后将`round()`函数应用于它们。

```
# install.packages('dplyr', dependencies = TRUE)
library(dplyr)

df <- read.table(text = "id  year V1.x.x V1.y.x ratio1
a 2006    227.11111    645.11111   35.22222  
b 2007    639.11111   1645.11111   38.22222  
c 2008   1531.11111   3150.11111   48.22222  
d 2009   1625.11111   3467.11111   46.22222",
                 header = TRUE, stringsAsFactors = FALSE)

df %>% 
  mutate_if(is.numeric, round, digits = 2)
#>   id year  V1.x.x  V1.y.x ratio1
#> 1  a 2006  227.11  645.11  35.22
#> 2  b 2007  639.11 1645.11  38.22
#> 3  c 2008 1531.11 3150.11  48.22
#> 4  d 2009 1625.11 3467.11  46.22

### dplyr v1.0.0+
df %>% 
  mutate(across(where(is.numeric), ~ round(., digits = 2)))
#>   id year  V1.x.x  V1.y.x ratio1
#> 1  a 2006  227.11  645.11  35.22
#> 2  b 2007  639.11 1645.11  38.22
#> 3  c 2008 1531.11 3150.11  48.22
#> 4  d 2009 1625.11 3467.11  46.22 
```

^(由[reprex 包](https://reprex.tidyverse.org)（v0.2.1.9000）于 2019-03-17 创建)

# markdown - Sublime Text 2——双重自动配对字符

> ID：14260649
> 
> 赞同：0
> 
> 时间：2013-01-10T14:53:39.463
> 
> 标签：markdown, sublimetext2, multimarkdown

我是一个新的 Sublime Text 2 用户，此时主要将它用于 Markdown/MultiMarkdown。在我的写作工作流程中，我`_underscore_`对所有斜体使用配对，`**double asterisk**`对所有粗体文本使用配对。我已经采用了一些基本的自动配对代码，并在我输入一个星号后让它配对双星号。这是我想要的确切行为，但我无法让正常的配对退格功能工作。

对于其他自动配对字符，例如 []，在输入开始字符后按退格键将删除两个配对字符。但是当我退格其中一个双星号对时，它只会删除四个星号中的一个（让我留下`***`）。

有人知道这是否可能吗？对于加分，我希望有第二个键绑定片段（它允许您点击制表符并跳到自动配对的末尾）让我可以制表符到`**TEXT**`.

```
// Auto-pair double asterisks (type a single asterisk to invoke)
{ "keys": ["*"], "command": "insert_snippet", "args": {"contents": "**$0**"}, "context":
    [
        { "key": "setting.auto_match_enabled", "operator": "equal", "operand": true },
        { "key": "selection_empty", "operator": "equal", "operand": true, "match_all": true },
        { "key": "following_text", "operator": "regex_contains", "operand": "^(?:\t| |\\)|]|\\}|>|$)", "match_all": true },
        { "key": "preceding_text", "operator": "not_regex_contains", "operand": "[*a-zA-Z0-9_]$", "match_all": true },
        { "key": "eol_selector", "operator": "not_equal", "operand": "string.quoted.double", "match_all": true }
    ]
},
{ "keys": ["*"], "command": "insert_snippet", "args": {"contents": "**${0:$SELECTION}**"}, "context":
    [
        { "key": "setting.auto_match_enabled", "operator": "equal", "operand": true },
        { "key": "selection_empty", "operator": "equal", "operand": false, "match_all": true }
    ]
},
{ "keys": ["*"], "command": "move", "args": {"by": "characters", "forward": true}, "context":
    [
        { "key": "setting.auto_match_enabled", "operator": "equal", "operand": true },
        { "key": "selection_empty", "operator": "equal", "operand": true, "match_all": true },
        { "key": "following_text", "operator": "regex_contains", "operand": "^**", "match_all": true }
    ]
},
{ "keys": ["backspace"], "command": "run_macro_file", "args": {"file": "Packages/Default/Delete Left Right.sublime-macro"}, "context":
    [
        { "key": "setting.auto_match_enabled", "operator": "equal", "operand": true },
        { "key": "selection_empty", "operator": "equal", "operand": true, "match_all": true },
        { "key": "preceding_text", "operator": "regex_contains", "operand": "**$", "match_all": true },
        { "key": "following_text", "operator": "regex_contains", "operand": "^**", "match_all": true }
    ]
},
//Tab skips to end of autopaired characters
{ "keys": ["tab"], "command": "move", "args": {"by": "characters", "forward": true},
  "context": [ { "key": "selection_empty", "operator": "equal", "operand": true },
            { "key": "preceding_text", "operator": "not_regex_match", "operand": "[[:space:]]*", "match_all": true },
            { "key": "following_text", "operator": "regex_contains", "operand": "^[\"'\\)\\}\\]\\_]", "match_all": true },
            { "key": "auto_complete_visible", "operator": "equal", "operand": false },
            { "key": "has_next_field", "operator": "equal", "operand": false } ] }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T16:10:46.417

`*`是正则表达式的特殊字符，所以需要转义。`backspace`关键应该是这样的：

```
"keys": ["backspace"], "command": "run_macro_file", "args": {"file": "Packages/Default/Delete Left Right.sublime-macro"}, "context":
[
    { "key": "setting.auto_match_enabled", "operator": "equal", "operand": true },
    { "key": "selection_empty", "operator": "equal", "operand": true, "match_all": true },
    { "key": "preceding_text", "operator": "regex_contains", "operand": "\\*$", "match_all": true },
    { "key": "following_text", "operator": "regex_contains", "operand": "^\\*", "match_all": true }
] 
```

注意`\\*$`in`preceding_text`键正则表达式操作数和`^\\*`in`following_text`键正则表达式操作数。无论如何，您必须点击`backspace`两次才能删除两者`*`：我认为不可能同时删除两者。

您需要的代码段应该是这样的：

```
<snippet>
    <content><![CDATA[
**${1:TEXT}** ${2:}
]]></content>
    <tabTrigger>your_snippet</tabTrigger>
</snippet> 
```

您应该`your_snippet`使用您想要作为触发器的任何文本进行更改。

# c# - 字符串拆分成文本框

> ID：14260651
> 
> 赞同：1
> 
> 时间：2013-01-10T14:53:44.177
> 
> 标签：c#, asp.net, textbox

我正在使用以下技术来动态更新文本框 -

**背后的代码**

```
Lat.DataSource = ws.returnLAT(place);
Lat.DataBind(); 
```

**aspx 代码**

```
<asp:DataList runat="server" ID="Lat">
<ItemTemplate>

<td>
<asp:Label for="latBox" ID="Label5" runat="server" Text="Latitude"></asp:Label>
<br />
<asp:TextBox ID="latBox" runat="server" Text='<%# Container.DataItem.ToString() %>'></asp:TextBox>
</td>

</ItemTemplate>
</asp:DataList> 
```

一个调试`DataSource`等于`99`，但是当出现在网页中时，该值被分成两个单独的文本框，每个文本框都有一个`9`，而不是所需的单个文本框`99`。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:03:45.657

我认为这里发生的事情是（无论出于何种原因）将`99`其视为 2 个单独的记录。您不应该真正传递单个值，因为`DataSource`它应该是某种形式的*collection*。

例如，如果您将绑定代码更改为：

```
Lat.DataSource = new List<int>(1) { ws.returnLat(place) }; 
```

问题会消失吗？

# php - PHP preg_match 返回 false

> ID：14260652
> 
> 赞同：1
> 
> 时间：2013-01-10T14:53:47.387
> 
> 标签：php, regex

[我在http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)中尝试了这种正则表达式语法，看起来效果很好。

```
^[a-z0-9-]+.([a-z]{2,4})$ 
```

目的是匹配域名（不包含http或https）

所以我使用`preg_match( '/^[a-z0-9-]+.([a-z]{2,4})$/g', 'fathi-hadi.net' )` 但总是返回 false

我不知道为什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:56:37.023

当您打开错误报告时，您会注意到`preg_match`不支持`g`修饰符：

> 警告：preg_match() [function.preg-match]：未知修饰符“g”

所以放弃它并使用：

```
preg_match('/^[a-z0-9-]+\.([a-z]{2,4})$/', 'fathi-hadi.net'); 
```

那将匹配。我还结合了 Gerald Schneider 关于转义点的评论，这是一个很好的观点。

# azure - 超出免费限制后无法重新创建已删除的 Azure VM

> ID：14260654
> 
> 赞同：1
> 
> 时间：2013-01-10T14:53:55.747
> 
> 标签：azure, azure-virtual-machine

我有两个在 azure 中运行的 VM，并且超过了本月的免费限制。我启用了向我的帐户收费的功能，发现它们已经消失了。

虚拟机磁盘仍然存在，但虚拟机本身已被制成托管服务。为了重新创建虚拟机，我删除了托管服务，然后像我之前看到其他人发布的那样进入创建新虚拟机对话框。在“从磁盘创建”选项下，我看不到任何一个操作系统磁盘作为创建 VM 的选项。这是重新创建虚拟机的正确方法还是我错过了什么？

另外值得注意的是，磁盘仍显示为附加到门户中已删除的 VM。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:26:44.083

正如您提到的，您的操作系统 VHD 仍显示与已删除的 VM 连接，您需要首先注意这一点。[您可以在本论坛讨论](http://social.msdn.microsoft.com/Forums/en-US/WAVirtualMachinesforWindows/thread/7381ea0e-0443-4b33-aa12-ba39df003409)中运行 BreakLease.ps1 Powershell 脚本，以先删除租约，然后使用操作系统磁盘 VHD 创建新的操作系统映像。最后，您可以使用新的操作系统映像来创建新的虚拟机。

或者，如果您只想重用同一个 OS 磁盘 vhd 来创建新的虚拟机，您可以按照下面的博客并在底部查找“**重用 OS VHD blob 以创建 OS 映像**”部分来复制被阻止的 OS blob进入一个新的blob，然后使用它：

[如果 OS VHD 在 Windows Azure 虚拟机中仍处于租用状态，则使用 OS 磁盘 VHD 创建新的虚拟机](http://blogs.msdn.com/b/avkashchauhan/archive/2013/01/10/using-os-disk-vhd-to-create-a-new-virtual-machine-if-os-vhd-is-still-on-lease-in-windows-azure-virtual-machines.aspx)

# c# - linq 索引超出范围

> ID：14260658
> 
> 赞同：2
> 
> 时间：2013-01-10T14:54:08.623
> 
> 标签：c#, linq, list, indexoutofboundsexception

在我朋友的代码中，他有一个`List`：

```
 List<int> listOfIds = new List<int>(); 
```

然后我用来`AddRange()`向它添加一个 int 集合：

```
 listOfIds.AddRange(this._employeeList
                       .Where(r => r.EmployeeID != null)
                       .Select(r => r.EmployeeID != null ? r.EmployeeID.Value : 0)); 
```

但是，在日志中，它说：

```
 System.IndexOutOfRangeException: Index was outside the bounds of the array.
   at System.Collections.Generic.List`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereSelectListIterator`2.MoveNext()
   at System.Collections.Generic.List`1.InsertRange(Int32 index, IEnumerable`1 collection)
   at the method which called the codes above..... 
```

我不太确定为什么会这样。我很确定这个错误发生在上面的代码上，但我似乎无法理解为什么`IndexOutofRangeException`会出现。

你能帮我指出是什么原因造成的吗？

**更新：**

我错了。我很抱歉。该方法不使用多线程。但是，另一种调用此方法的方法是使用 Parallel.Foreach，这意味着多线程。可能当 _employeeList 被用作 AddRange() 的源时，另一个线程也在修改它。因此，addrange() 不是线程安全的答案是合理的。十分感谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:13:10.237

很难说出更具体的想法，但这可能会奏效。

`AddRange`不是线程安全的。尝试使用`lock primitives`添加许多项目。宣布：

```
private static object mutex = new object(); 
```

用法

```
lock(mutex)
{
    listOfIds.AddRange( /* code goes here */ )
} 
```

反编译后`AddRange`发现

```
public void AddRange(IEnumerable<T> collection)
{
  this.InsertRange(this._size, collection);
} 
```

的内容`InsertRange`，您可以在堆栈跟踪中看到：

```
 ...
  ICollection<T> collection1 = collection as ICollection<T>;
  if (collection1 != null)
  {
     ...
  }
  else
  {
    foreach (T obj in collection)
      this.Insert(index++, obj);
  } 
```

换句话说 - 它遍历序列并尝试使用**递增的索引**逐项添加。这不应该出错，不是吗？反编译的`845`行。所以我不相信堆栈跟踪，除非我会看到整个堆栈跟踪。`List.cs``dotPeek`

# python - 无法编辑从 __init__ (wxPython) 以外的其他函数构建的 TextCtrl

> ID：14260659
> 
> 赞同：0
> 
> 时间：2013-01-10T14:54:19.217
> 
> 标签：python, function, wxpython, textctrl

我在编辑、输入甚至单击 TextCtrl 或实际上任何其他未在**init**函数中构建的小部件时遇到问题。

假设我有这一点：

```
class firstpanel(wx.Panel):

def __init__(self, parent):
    wx.Panel.__init__(self, parent=parent) 
```

……

```
def receivetext(self, event):
    panel = wx.Panel(self,size=wx.Size(850,650))
    wx.TextCtrl(self, -1, self.textfromsomewhereelse, (365, 145)) 
```

我确实在我的 GUI 框架中看到了具有适当值的 TextCtrl，但我无法修改它。这就像我在它上面有一个不可见的层，不让我通过。

我说我错过了一些非常基本的东西，这很尴尬。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T21:04:14.310

在`receivetext`您创建 的实例`wx.TextCtrl`，但不将其添加到`panel`. 您也不要保留对实例的引用，因此垃圾收集器会立即将其销毁。

```
class MyFrame1 (wx.Frame):
    def __init__(self):
        super(MyFrame1, self).__init__()
        fluid_sizer = wx.BoxSizer(wx.HORIZONTAL)
        self.m_textCtrl1 = wx.TextCtrl(self, wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.DefaultSize, 0)
        fluid_sizer.Add(self.m_textCtrl1, 0, wx.ALL, 5)
        self.SetSizer(fluid_sizer)
        self.Layout() 
```

该示例显示`wx.BoxSizer`创建了 a 并且`wx.TextCtrl`. 对文本控件的引用存储为`self.m_textCtrl`. 然后将文本控件添加到 sizer 中，使其可见。

# google-maps-api-3 - 带有 Google Places API 视口位置的 Elasticsearch geo_bbox

> ID：14260661
> 
> 赞同：2
> 
> 时间：2013-01-10T14:54:20.803
> 
> 标签：google-maps-api-3, elasticsearch, google-places-api

希望我能解释我的问题。

我正在使用 Google 的自动完成功能来获取人员目的地。一旦我有了目的地，我就可以使用谷歌的 place api 来查找几何视口。但视口是从北/东到南/西。我的问题是 Elasticsearch 的 geo_bbox 从上/左到下/右。请参阅下面的示例。

Google Place API 响应：

```
{
   "html_attributions" : [],
   "result" : {
      "address_components" : [
         {
            "long_name" : "Devon",
            "short_name" : "Devon",
            "types" : [ "administrative_area_level_2", "political" ]
         },
         {
            "long_name" : "England",
            "short_name" : "England",
            "types" : [ "administrative_area_level_1", "political" ]
         },
         {
            "long_name" : "United Kingdom",
            "short_name" : "GB",
            "types" : [ "country", "political" ]
         }
      ],
      "adr_address" : "\u003cspan class=\"region\"\u003eDevon\u003c/span\u003e, \u003cspan class=\"country-name\"\u003eUK\u003c/span\u003e",
      "formatted_address" : "Devon, UK",
      "geometry" : {
         "location" : {
            "lat" : 50.77721349999999,
            "lng" : -3.9994610
         },
         "viewport" : {
            "northeast" : {
               "lat" : 51.24619840,
               "lng" : -2.88664060
            },
            "southwest" : {
               "lat" : 50.20189620,
               "lng" : -4.68065630
            }
         }
      },
      "icon" : "http://maps.gstatic.com/mapfiles/place_api/icons/geocode-71.png",
      "id" : "065fb13848aeae653fe25ee19d8a0a0289bd64dc",
      "name" : "Devon",
      "reference" : "CnRoAAAAN84gxrolBJLF_flpuwIyGum7pjln_KP9NJIHydIHMfbAo93nUdHSyYbv90GPUlW8Jx5D2ba-2fJHyzcHAdkZLkaJzSBEfj7dkR4NnBWzK9mFikZdyz3cee9IvOruHCZaicKfiXJP18jSfxXkvVv8gBIQrAopOdNbGQ6ovqEaEUqrxxoUaUYJEahZx7mTfJwEWOnxjTP3e9A",
      "types" : [ "administrative_area_level_2", "political" ],
      "url" : "https://maps.google.com/maps/place?q=Devon&ftid=0x486bf8abdac00247:0x12c6ba0cca9c58fd"
   },
   "status" : "OK"
} 
```

弹性搜索示例

```
{
    "filtered" : {
        "query" : {
            "match_all" : {}
        },
        "filter" : {
            "geo_bounding_box" : {
                "pin.location" : {
                    "top_left" : {
                        "lat" : 40.73,
                        "lon" : -74.1
                    },
                    "bottom_right" : {
                        "lat" : 40.717,
                        "lon" : -73.99
                    }
                }
            }
        }
    }
} 
```

有没有更好的方法从谷歌获取更多信息，或者弹性搜索可以从其他角落工作。虽然文档没有这么说？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T22:13:13.050

哦，天哪，我有多厚。

我需要做的就是将结果换成我的弹性搜索。IE，

```
{
    "filtered" : {
        "query" : {
            "match_all" : {}
        },
        "filter" : {
            "geo_bounding_box" : {
                "pin.location" : {
                    "top_left" : {
                        "lat" : result.northeast.lat,
                        "lon" : result.southwest.lon
                    },
                    "bottom_right" : {
                        "lat" : result.southwest.lat,
                        "lon" : result.northwest.lon
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:47:44.003

如果您知道东北角和西南角，则可以计算西北角（左上角）和东南角（右下角）：

```
var NE = bounds.getNorthEast();
var SW = bounds.getSouthWest();

// calculated points
var NW = new google.maps.LatLng(NE.lat(), SW.lng());
var SE = new google.maps.LatLng(SW.lat(),NE.lng()); 
```

# r - 如何通过索引的不完整向量获取多维数组的值

> ID：14260662
> 
> 赞同：1
> 
> 时间：2013-01-10T14:54:21.347
> 
> 标签：r

这个问题与 R 非常相似 [- 如何通过索引向量获取多维数组的值](https://stackoverflow.com/questions/10865337/r-how-to-get-a-value-of-a-multi-dimensional-array-by-a-vector-of-indices)

我有：

```
dim_count <- 5
dims <- rep(3, dim_count)
pi <- array(1:3^5, dims) 
```

我想得到一整条线，但要自动构建这条线的地址。例如，我想得到：

```
pi[1,,2,2,3]
##  [1] 199 202 205 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T14:59:37.580

您可以在适当的插槽中插入一个覆盖整个维度的序列：

```
do.call("[",list(pi,1,1:dim(pi)[2],2,2,3)) 
```

顺便说一句，定义一个名为的变量`pi`有点危险（我知道这是从上一个问题继承的）——假设您稍后尝试了几行来计算圆的周长`pi*diameter`...

# php - PHP htmlentities 不足以阻止黑客从表单中注入 html

> ID：14260665
> 
> 赞同：13
> 
> 时间：2013-01-10T14:54:24.953
> 
> 标签：php, security, forms, http-post

我有一个带有文本框的表单，它将数据发布到一个使用“htmlentities”函数的php文件中，以确保向网站所有者发送电子邮件是安全的。

问题是有人设法在文本中获得了超链接，而 htmlentities() 没有删除它。

这是我的文本框 html：

```
<input name="usertext" type="text" /> 
```

这是我接收帖子数据的 PHP 代码（我将电子邮件代码省略了，因为这不是问题。我将其更改为仅回显接收到的数据，以便我可以尝试复制黑客所做的事情。如果我知道他是如何做到的，我可以找到一种方法来阻止它发生）：

```
echo trim(htmlentities($_POST["usertext"], ENT_QUOTES)); 
```

现在黑客发送了一些数据，这是结果 html（源代码 - 这意味着它在浏览器中显示了一个正常的链接）：

```
<a target="_blank" href="mailto:nyjfvw@fbjgzy.com">nyjfvw@fbjgzy.com</a> 
```

我认为 htmlentities() 总是会阻止任何人输入任何类型的 html。如果我输入一个超链接，例如：

```
<a href="aaa" /> 
```

我得到：

```
&lt;a href="aaa" /&gt; 
```

但黑客的文本不是这样编码的。

所以我的问题是：

1.  黑客是如何输入 html 标签以使 htmlentities() 函数对其没有任何作用的？
2.  我将如何复制它进行测试？（可以通过上面的问题来回答）

我做了一些研究，黑客可能将他的文本编码为 utf-7 或其他什么？

我已经收到了几封带有这些相同链接的电子邮件。这个黑客显然是在测试我的网站，看看他能不能做 XSS 什么的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T15:48:26.340

好问题！我认为您可以阅读此[链接](http://nedbatchelder.com/blog/200704/xss_with_utf7.html)来解释问题并提供解决方案。

建议的解决方案是向浏览器指定（通过元标记）在页面中使用哪个字符集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T16:13:46.750

我认为`strip_tags`完全符合您的需求： http: [//php.net/manual/en/function.strip-tags.php](http://php.net/manual/en/function.strip-tags.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T15:01:02.863

这不是最优雅的解决方案，但是在没有看到其余代码的情况下，您可以检查 usertext 字段是否包含字符串“href”并拒绝它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-08T12:11:51.790

htmlspecialchars() 会成功吗？W3Schools 上的这篇[文章](https://www.w3schools.com/php/php_form_validation.asp)似乎暗示了这一点。

# android - ListView 与相邻项重叠

> ID：14260667
> 
> 赞同：0
> 
> 时间：2013-01-10T14:54:36.513
> 
> 标签：android, android-layout, android-listview

我正在使用一个列表视图，与 MergeAdapter 合并在一起，我正在尝试将其设置为使用我想要的 StickyListHeaders。以下是合并 ListView 的设置方式：

ImageView 作为第一个元素。

RelativeLayout 包含一个 ImageView 和 TextView 作为第二个元素。

从适配器填充的 ListView 项。

在第二个列表项中，ImageView 的高度必须高于 TextView 的高度。但我希望列表项高度匹配 TextView 高度而不是 ImageView（固定高度而不是 wrap_content）。这样，第二个列表项的 ImageView 将理想地重叠到第一个列表项的 ImageView 上。

我试过弄乱透明度、设置布局高度和其他一些东西，但我无法让它工作。这是否太复杂而无法发生，还是我错过了什么？想法？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T16:40:42.077

我想出了一种可能不是最简单但有效的方法。我只是将一半的 ImageView 放在每个列表项中，并裁剪源图像以适应。

# multithreading - 如何正确使用线程特定的数据

> ID：14260668
> 
> 赞同：3
> 
> 时间：2013-01-10T14:54:36.733
> 
> 标签：multithreading, pthreads, global-variables, pthread-key-create, thread-specific-storage

我正在使用 pthread 编程。我需要一个全局变量，它对不同的线程具有不同的值。并且线程将使用相同的函数来处理这个变量，例如改变它的值。如果一个线程改变了它的值，其他线程中的值不会改变。所以我尝试使用线程特定的数据，并写了一个例子。我需要将 pthread 操作包装在函数中。例如：setspecific()、changedata、printdata()、create_key()、delete_key() 等。

```
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>

pthread_key_t key;
pthread_key_t key2;

struct test_struct {
    int i;
    float k;
}struct_data;

int temp;

int setspecificvar () { /* Set specific data for threads */

    pthread_setspecific (key, &struct_data);
    pthread_setspecific (key2, &temp);

    return 0;
}
int changedata (int i, float k, int tempvar) { /* Change specific data for threads */

    temp = tempvar;
    struct_data.i = i;
    struct_data.k = k;

    return 0;
}

int printdata (int t) {  /* print specific data for threads */

    printf ("The addres in child%d returned from pthread_getspecific(key):0x%p\n",                           \
            t, (struct test_struct *)pthread_getspecific(key));

    printf ("The value of members in structure bound to \"key\" in  child%d:\nstruct_data.i:%d\nstruct_data.k: %f\n", \
            t, ((struct test_struct *)pthread_getspecific (key))->i,                            \
            ((struct test_struct *)pthread_getspecific(key))->k);

    printf ("------------------------------------------------------\n");

    printf ("The addres in child%d returned from pthread_getspecific(key2):0x%p\n",                          \
            t, (int *)pthread_getspecific(key2));
    printf ("The value of \"temp\" bound to \"key2\" in child%d:%d\n", \
            t, *((int *)pthread_getspecific(key2)));

    return 0;
}

void *child1 (void *arg)
{
    setspecificvar ();
    changedata(10, 3.141500, 110); /* Should not change the data in child2 */
    printdata(1);
}

void *child2 (void *arg)
{
    /* sleep (2); */
    setspecificvar ();

    changedata(12, 2.141500, 120); /* Should not change the data in child1 */
    printdata(2);

    changedata (122, 22.141500, 1220); /* Should not change the data in child1 */
    printdata (2);
}

int create_key () {
    pthread_key_create (&key, NULL);
    pthread_key_create (&key2, NULL);
    return 0;
}

int delete_key () {

    pthread_key_delete (key);
    pthread_key_delete (key2);
    return 0;
}

int main (void)
{
    pthread_t tid1, tid2;

    create_key ();
    pthread_create (&tid1, NULL, (void *)child1, NULL);
    pthread_create (&tid2, NULL, (void *)child2, NULL);
    pthread_join (tid1, NULL);
    pthread_join (tid2, NULL);

    delete_key ();

    return 0;
} 
```

我创建了两个线程。当我让一个线程休眠 2 秒时。我得到正确答案。

```
The addres in child1 returned from pthread_getspecific(key):0x0x8049c98
The value of members in structure bound to *"key" in  child1*:
*struct_data.i:10
struct_data.k: 3.141500*
------------------------------------------------------
The addres in child1 returned from pthread_getspecific(key2):0x0x8049ca0
The value of "temp" bound to *"key2" in child1*:110
The addres in child2 returned from pthread_getspecific(key):0x0x8049c98
The value of members in structure bound to "key" in  child2:
struct_data.i:12
struct_data.k: 2.141500
------------------------------------------------------
The addres in child2 returned from pthread_getspecific(key2):0x0x8049ca0
The value of "temp" bound to "key2" in child2:120
The addres in child2 returned from pthread_getspecific(key):0x0x8049c98
The value of members in structure bound to "key" in  child2:
struct_data.i:122
struct_data.k: 22.141500
------------------------------------------------------
The addres in child2 returned from pthread_getspecific(key2):0x0x8049ca0
The value of "temp" bound to "key2" in child2:1220 
```

当我评论 /* sleep(2); */ ，我得到不正确的答案。

```
The addres in child1 returned from pthread_getspecific(key):0x0x8049c54
The addres in child2 returned from pthread_getspecific(key):0x0x8049c54
The value of members in structure bound to "key" in  child2:
*struct_data.i:12
struct_data.k: 2.141500*
The value of members in structure bound to *"key" in  child1*:
struct_data.i:12
struct_data.k: 2.141500
------------------------------------------------------
The addres in child1 returned from pthread_getspecific(key2):0x0x8049c5c
The value of "temp" bound to *"key2" in child1*:120
------------------------------------------------------
The addres in child2 returned from pthread_getspecific(key2):0x0x8049c5c
The value of "temp" bound to "key2" in child2:120
The addres in child2 returned from pthread_getspecific(key):0x0x8049c54
The value of members in structure bound to "key" in  child2:
struct_data.i:122
struct_data.k: 22.141500
------------------------------------------------------
The addres in child2 returned from pthread_getspecific(key2):0x0x8049c5c
The value of "temp" bound to "key2" in child2:1220 
```

我想在没有线程的情况下获得正确的结果。一个线程不应该等待另一个线程完成调用 pthread_setspecific() ，对吗？我该怎么办？感谢您的考虑。我将 struct_data 定义为全局变量是否正确？任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T15:19:14.903

```
int setspecificvar () { /* Set specific data for threads */

    pthread_setspecific (key, &struct_data);
    pthread_setspecific (key2, &temp);

    return 0;
} 
```

在这里，您在每个线程中明确地将`key`和设置`key2`为*相同的值*，因此它在每个线程中具有相同的值也就不足为奇了。尝试在每个线程中将其设置为*不同*的值，然后它将在每个线程中具有不同的值。

一个常见的模式是这样的：

1.  打电话`pthread_getspecific`。如果它返回非 NULL，则使用该指针。

2.  如果它返回 NULL，则使用动态分配线程特定对象的新实例。调用`pthread_setspecific`以确保`pthread_getspecific`从此线程的下一次调用返回相同的对象。

3.  在`pthread_key_create`调用中，一定要注册一个析构函数，当线程离开时释放线程特定对象的实例。

这将为每个线程提供其自己的结构实例。

例如：

```
int setspecificvar () { /* Set specific data for threads */

    struct test_struct *s = malloc(sizeof(struct test_struct));
    int *i = malloc(sizeof(int *));
    memset(s, 0, sizeof(s));
    memset(i, 0, sizeof(i));

    pthread_setspecific (key, s);
    pthread_setspecific (key2, i);

    return 0;
} 
```

这实际上在每个线程中设置了不同的值。还有这个：

```
int changedata (int i, float k, int tempvar) { /* Change specific data for threads */

    struct test_struct *struct_data = pthread_getspecific(key);
    int *temp = pthread_getspecific(key2);

    *temp = tempvar;
    struct_data->i = i;
    struct_data->k = k;

    return 0;
} 
```

这实际上*使用*了线程特定的数据。

# php - PHP RegEx 删除空段落标签

> ID：14260670
> 
> 赞同：7
> 
> 时间：2013-01-10T14:54:38.913
> 
> 标签：php, regex, ckeditor

我正在尝试删除`<p>`CKEditor 插入到描述框中的所有空标签，但它们似乎都各不相同。可能性似乎是：

```
<p></p>

<p>(WHITESPACE)</p>

<p>&nbsp;</p>

<p><br /></p>

<p>(NEWLINE)&nbsp;</p>

<p>(NEWLINE)<br /><br />(NEWLINE)&nbsp;</p> 
```

有了这些可能性，段落之间可以有任意数量的空白`&nbsp;`和`<br />`标签，并且在一个段落中可以有每种类型的一些。

我也不确定这个`<br />`标签，从我所见它可能是`<br />`,`<br/>`或`<br>`.

我搜索了一个类似的答案，但在我看到的所有答案中，它们似乎都只满足其中一种情况，而不是一次。我想简单来说我要问的是，是否有一个正则表达式可以用来`<p>`从一些没有任何字母数字文本或符号/标点符号的 HTML 中删除所有标签？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-10T15:12:03.780

好吧，与我不使用正则表达式解析 HTML 的建议相冲突，我编写了一个正则表达式来做到这一点：

```
"#<p>(\s|&nbsp;|</?\s?br\s?/?>)*</?p>#" 
```

这将正确匹配：

```
<p></p>

<p> </p> <!-- ([space]) -->

<p> </p> <!-- (That's a [tab] character in there -->

<p>&nbsp;</p>

<p><br /></p>

<p>
&nbsp;</p>

<p>
<br /><br />
&nbsp;</p> 
```

它能做什么：

```
# /                --> Regex start
# <p>              --> match the opening <p> tag
# (                --> group open.
#   \s             --> match any whitespace character (newline, space, tab)
# |                --> or
#   &nbsp;         --> match &nbsp;
# |                --> or
#   </?\s?br\s?/?> --> match the <br> tag
# )*               --> group close, match any number of any of the elements in the group
# </?p>            --> match the closing </p> tag ("/" optional)
# /                --> regex end. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-05-06T12:34:26.577

`<p>`选择的答案很好，但如果标签定义了内联样式属性，则它不起作用，例如`<p style="font-weight:bold">`.

与此匹配的正则表达式将是：

```
#<p[^>]*>(\s|&nbsp;|</?\s?br\s?/?>)*</?p># 
```

# php - 尝试访问对象属性时出现奇怪的字符并且页面未加载

> ID：14260672
> 
> 赞同：0
> 
> 时间：2013-01-10T14:54:51.817
> 
> 标签：php, object

我通过以下方式在 php 文件中创建了一个类：

```
class thingy {
    ...
    var $property;
    ...
} 
```

一旦创建了类（在我包含的单独文件中），我将执行以下操作：

```
$mything = new thingy();

$mything->$property = 5; 
```

（这是一个修改了 var 和属性名称的示例，但除了这些名称之外，它是相同的代码，而且我在这里只显示一个属性。）

显示页面时我得到以下输出，并且不再加载（页眉和页脚没有显示，只是一个奇怪的输出）。

每当我加载页面时，我都会得到类似的东西：

```
‹$A Ã0ï}…^ÐÐKÁøè+t‘ †D²ŠéïÓÓ³›ŠÃ’©ä7Àîêi)yØID¨Vîø²ø‚¹û Mà–ö ]†c$³Þ‚g"Õh*•&gt;q<í°9 *p6á)¾ÖuVéÿÿÿ»-¶† 
```

当我删除我试图设置属性的行时，我的页面加载正常。我被困住了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T14:57:24.143

```
$mything->property = 5; 
```

你不需要第二个'$'。那是试图设置一个名称为$property**值的变量。**

# arrays - 如何在文件中存储超大数组

> ID：14260684
> 
> 赞同：-1
> 
> 时间：2013-01-10T14:55:18.913
> 
> 标签：arrays, python-2.7, vectorization

我需要在文件中存储一个非常大的向量数组。大小可以大到 1e48。如何将其存储在文件中，然后从其中顺序读取一组数据（例如一次 8 个元素），操作并将操作后的数据存储回文件中。数组元素是双精度数/甚至更大的小数。代码可以在 Python 中。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T16:45:23.200

我自愿抛开你拥有一个非常大的数据集的事实。一个好的（实际上还不错）策略是不使用例如加载整个文件：

```
array = f.readlines() 
```

而是玩游标并一次加载 8 个元素：

```
line = f.readline()
while line:
    #Do stuff here 
```

在这里，我假设您将每个元素放在不同的行上。

# php - php 在循环中进行 SOAP 调用

> ID：14260685
> 
> 赞同：0
> 
> 时间：2013-01-10T14:55:20.613
> 
> 标签：php, loops, soap

我有一个 php 应用程序，它需要通过重复 SOAP 调用（最多 700 个）来获取用户数据。不幸的是，所服务的报告目的似乎使得有必要进行重复调用。无论如何，我有一个 For 循环（最多可以重复 700 次），它调用一个函数，而该函数又进行 SOAP 调用。但是我收到一个关于 SOAP 调用在 30 秒后超时的错误。显然，在第一个 SOAP 调用返回到调用函数之后，我需要等待下一个 SOAP 调用。那么如何做到这一点。这是一个代码片段：

```
//calling function
foreach($xml_apicheck->children() as $child)
{
  getprincipalinfoandemail($endusersconame);
 }
 //called function
 function getprincipalinfoandemail($loginid) {
  //making the SOAP calls and emailing//works for the first time called
   return true;
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T16:22:50.800

要在不花费很长时间的情况下处理大量 SOAP 请求，最好的办法是分叉您的 PHP 脚本并限制您生成的进程数量。每个 fork 将执行一个 SOAP 语句，等待它，然后在最后死掉。几年前我写了一个脚本来做这件事，并写了一篇关于它如何工作以及如何实现它的教程/帖子。这个特定的示例是如何使用 NuSOAP 库与索尼爱立信 SMS 网关（使用 SOAP）一起工作。希望这能让你快速理顺：

[http://jservedio.com/article/3](http://jservedio.com/article/3)

PS：这是几年前写的，所以我可能使用常规的 MySQL 库来连接数据库。如果您必须连接到数据库，请确保您使用的是 PDO 或 mysqli - 特别是如果您从 GET 或 POST 获取查询的任何输入。

已编辑：针对您不需要所有这些功能的评论 - 您可以考虑创建 SOAP 请求标头和正文，然后使用 cURL 将其发送到您需要的位置。这将等待响应（如果需要，甚至将其定向到变量）。

# javascript - 如何让延迟处理程序将值返回给调用函数？

> ID：14260686
> 
> 赞同：0
> 
> 时间：2013-01-10T14:55:20.863
> 
> 标签：javascript, dojo, deferred

查看下面的示例以了解我要执行的操作：

```
//Caller.js
callingFunction : function (...)
{
    var a = new Assistant();
    console.log("This object has been returned ", a.showDialog(...));
},

//Assistant.js
showDialog : function (...)
{
    deferred.then(lang.hitch(this, this._showDialog));
    //I want to return someObject to callingFunction
},

_showDialog : function (dialogData)
{
    ...
    ...
    return someObject;
},} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T14:56:48.427

由于它已被延迟，因此在该函数结束之前它没有任何返回值。相反，将回调传递给`showDialog`并让它在延迟触发时调用该回调。

* * *

在下面回复您的评论：

> 你知道我会如何添加回调吗？

自从我使用 Dojo 以来已经有好*几年*了，所以它可能具有缩短它的功能，但通常的方式看起来像这样：

```
showDialog : function (callback)
{
    deferred.then(lang.hitch(this, function() {
        this._showDialog();
        callback(/*...whatever it is you want to pass back...*/);
    }));
}, 
```

# wordpress - Wordpress 与我的设计

> ID：14260688
> 
> 赞同：0
> 
> 时间：2013-01-10T14:55:29.633
> 
> 标签：wordpress, wordpress-theming

我有自己的网站设计，要使用 wordpress 开发，但我需要知道这个程序是否允许我使用我自己的而不是他们的预制模板。感谢你给与我的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:57:44.097

您可以使用任何编写的模板来使用 wordpress。您只需要一个将项目转换为工作模板的网络开发人员 :)

# c# - 如何使用 C# 在 WPF 中检测 UI 线程何时开始和停止处理？

> ID：14260693
> 
> 赞同：2
> 
> 时间：2013-01-10T14:55:39.333
> 
> 标签：c#, .net, wpf, multithreading, user-interface

在我的 WPF C# 应用程序中，我在处理事情时显示了一个小圆圈动画，让用户知道应用程序正在“思考”，他们应该冷静下来。这是一个单独的exe。因此，例如，当用户单击一个按钮以运行分析（可能需要 5-10 秒）时，我会启动显示动画的过程，当一切完成时，我会停止该过程。在此期间，新产生了子线程来处理后台任务。完成后，UI 会更新，由于复杂的数据网格，这可能需要几秒钟。

虽然这在技术上有效，但我宁愿以不同的方式处理它。我宁愿让应用程序自动检测线程何时工作并自动显示动画，当线程全部完成时，它会停止显示它。我可以轻松检测到后台线程，但如何检测 UI 线程？我宁愿这样做，因为有几次我不小心错过了杀死应用程序，并且在处理完成后它仍在运行。这将阻止这种情况。

UI 线程启动和停止时是否会触发事件？如果没有，假设我在其中放置了一个每 1/2 秒触发一次的计时器，是否可以拨打电话告诉我 UI 线程的状态？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:01:47.173

更好的方法是*将*处理移出 UI（例如，[`BackgroundWorker`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)让后台工作人员将通知发布到 UI 线程（开始、进度更新、完成）。

不要重新发明轮子并将处理逻辑移出 UI 线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:01:12.817

这是第 22 条规则。如果您有一些代码可以运行以确定 UI 线程被阻塞，那么您将无法启动动画，因为 UI 线程被阻塞；直到 UI 线程完成它一直在处理的任务之后，动画才会显示，此时动画不再相关。

在几乎所有情况下，您都应该将长时间运行的任务转移到另一个后台线程，而不是在 UI 线程中执行它们。您可以在此类任务开始时明确禁用表单上的部分/所有控件，并在结束时启用它们。我 *强烈*建议您不要阻止 UI 线程作为禁用表单的一种方式，因为从用户的角度来看，它看起来好像程序由于编程错误而无法运行，而不是认为它是所需的行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T23:39:22.937

您可以尝试通过应用程序将任务添加到具有非常低优先级的主 UI 线程`Dispatcher`：

```
Application.Current.Dispatcher.BeginInvoke((ThreadStart)StopAnimation, DispatcherPriority.ApplicationIdle);

...

private void StopAnimation()
{
    ...
} 
```

这基本上是说“当主 UI 线程完全没有更好的事情可做时，调用 StopAnimation()”。诀窍是找到正确的调用时间`.BeginInvoke`——就在网格加载之前或期间。

# linux - 使用 -n 替换后的空白 sed 输出

> ID：14260694
> 
> 赞同：2
> 
> 时间：2013-01-10T14:55:40.307
> 
> 标签：linux, bash, shell, sed, grep

对于知道的人来说可能是一个简单的问题，但我很难从文件中检索一些变量值。我的文件是这样的：

```
variable1 12
variable2 43
variable3 897 
```

我想得到变量2、43的值。

我用 sed 尝试了一些命令，但没有运气：

```
sed -n 's/variable2 //;s/variable3//' myFile 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T15:02:29.610

**只有** `sed`：_

```
$ sed -n 's/^variable2 //p' file
43 
```

您的问题是您正在使用`-n`来抑制输出，`sed`因此您需要该`p`标志，以便`sed`打印发生替换的行。

由于这只是模式匹配，因此我**只使用**grep：

```
$ cat file
variable1 12
variable2 43
variable3 897

$ grep -Po '(?<=^variable2 )\d+' file
43 
```

甚至只是`awk`：

```
$ awk '$1=="variable2"/{print $2}' file
43 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T15:11:59.737

你必须使用`sed`吗？

我更喜欢使用`awk`这种东西：

```
awk -v varname="variable2" '$1==varname {print $2}' myFile 
```

只要没有包含空格的变量（在左列中），这将起作用。

***编辑：***

由于标题是“Get variable value from file with bash”，这里是一个不涉及外部程序的版本

```
wantvar="variable2"
datafile="myFile"
while read varname varval; do
  # Case-insensitive matching. If you need case-sensitivity, remove the pair of commas
  # on both sides.
  if [[ ${varname,,} = ${wantvar,,} ]]; then
    echo $varval
    break
  fi
done < $datafile 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T14:59:43.523

使用[grep](http://linux.die.net/man/1/grep)查找该行，然后使用[cut](http://linux.die.net/man/1/cut)提取值：

```
$ grep ^variable2 myFile | cut -d ' ' -f 2 
```

测试：

```
$ cat myFile 
variable1 12
variable2 43
variable3 897
$ grep ^variable2 myFile | cut -d ' ' -f 2
43
$ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T15:00:37.333

对于这样格式的文件， grep|awk 将起作用：

```
grep 变量 2 文件 | awk '{打印 $2}'
```

对于格式稍有不同的文件，不要指望它。

# php - 如果是字母“s”，则删除每个单词的最后一个字母

> ID：14260695
> 
> 赞同：0
> 
> 时间：2013-01-10T14:55:50.037
> 
> 标签：php, regex, replace, preg-replace

`s`如标题所示，我有一个带有一些单词的句子，如果它是句子每个单词的字母，我想删除最后一个字母。

我试试这个

```
preg_replace("%s(?!.*s.*)%", "", $mystring); 
```

但它只删除最后一个词

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-10T14:58:00.267

尝试`"s\\b"`作为正则表达式

**示例**：

```
preg_replace("/s\b/", "", $mystring); 
```

`s`是你的字母，`\b`意思是词的边界。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:00:26.980

我想我什至不会使用正则表达式来这样做。

```
$output = array();

foreach( explode( ' ', $myString ) as $word )
{
    $output[] = rtrim( $word, 's' );
}

$myString = implode( ' ', $output ); 
```

[http://php.net/rtrim](http://php.net/rtrim)

# wpf - wpf 文本框数据绑定

> ID：14260696
> 
> 赞同：0
> 
> 时间：2013-01-10T14:55:53.187
> 
> 标签：wpf, xaml, textbox, datacontext

谁能告诉我为什么这不起作用？

```
<Grid x:Name="myGrid">
    <Grid.ColumnDefinitions>
      <ColumnDefinition />
      <ColumnDefinition />
    </Grid.ColumnDefinitions>
      <TextBox VerticalAlignment="Center" Grid.Column="0">Gangnam</TextBox>
      <TextBox VerticalAlignment="Center" Text="{Binding}" Grid.Column="1" />
</Grid> 
```

在代码隐藏中，我设置了一个`datacontext`for `myGrid`。我还计划制作一个`datatemplate`来处理`visualisation`.

现在，我希望`textbox`包含`typename`my 的`class`，但是有一个*`xml`解析异常（“双向绑定需要 Path 或`XPath`.”）*

这就是我`datacontext`在控件上设置的方式：

```
public LeftColumn()
    {
      InitializeComponent();

      LeftColumnData dataObjectLeft = new LeftColumnData();
      myGrid.DataContext = dataObjectLeft;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:17:48.853

因为 DataContext 是 type`LeftColumnData`并且 TextBox 默认使用 Two-Way 绑定，所以运行时不可能弄清楚`String`与您的数据类型之间的转换。

您可以尝试将绑定设置为`OneWay`：

```
<TextBox VerticalAlignment="Center" Text="{Binding, Mode=OneWay}" Grid.Column="1" /> 
```

或实现一个`IValueConverter`来处理转换：

```
<TextBox VerticalAlignment="Center" Text="{Binding, Converter={My:Converter}}" Grid.Column="1" /> 
```

# asp.net-mvc - 使用 jQuery 将 ViewModel 传递给 Action

> ID：14260700
> 
> 赞同：0
> 
> 时间：2013-01-10T14:56:15.940
> 
> 标签：asp.net-mvc, asp.net-mvc-3, jquery

是否可以将 viewmodel 传递给使用 jQuery 调用它的控制器操作方法？目前在行动模型是空的。

控制器：

```
 [HttpPost]
    public ActionResult Action(MyModel model)
    {
        ProcessModel(model);

        return Json(new
        {
            Result = "result"
        });
    } 
```

jQuery：

```
function Serve() {
    $.ajax({
        type: "POST",
        url: "/Controller/Action",
        dataType: "json",
        error: function (xhr, status, error) {
            //Handle errors here...
        },
        statusCode: {
            404: function (content) { alert('Cannot find resource'); },
            505: function (content) { alert('Status code: 505'); },
            500: function (content) { alert('Internal server error'); }
        },
        success: function (json) {
            alert(json);

        }
    }); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:51:34.600

[使用api.jquery.com/serialize](http://api.jquery.com/serialize/)序列化表单数据，默认的 MVC 模型绑定器将处理将表单值映射到强类型模型。

只要您确保您的表单字段是使用强类型 HTML 帮助程序生成或匹配命名模型属性，这就会很好地工作：

```
@Html.TextBoxFor(model => model.PropertyName) 
```

或者

```
<input type="text" name="Model.PropertyName" /> 
```

# silverlight - Windows Phone 8 全景选择更改和数据绑定

> ID：14260701
> 
> 赞同：9
> 
> 时间：2013-01-10T14:56:17.183
> 
> 标签：silverlight, windows-phone-7, windows-phone-8, panorama-control

我为 Windows Phone 7 编写了一个应用程序，最近我已将其升级到 Windows Phone 8，并且我计划添加一些功能。不幸的是，我在升级后立即遇到了问题。该应用程序的主要部分是数据绑定的全景控件。在 SelectionChanged 上，我正在获取新的 PanoramaItem + 1 的数据（预选数据，因此当人们最终进入该项目时它就在那里）。这在 WP7 中运行良好，但 SelectionChanged 事件不会在 WP8 中触发。

我使用未升级的新 WP8 应用程序重现了该问题，并且它也与数据绑定控件隔离。如果我静态添加 PanoramaItems，则 SelectionChanged 事件会很好地触发。

我错过了什么还是这只是 WP8 中的一个直接错误？有什么推荐的解决方法吗？

我有一个带有静态示例和数据绑定示例的 GitHub 存储库，以显示哪些有效，哪些无效。 [https://github.com/bthubbard/DatabindingIssues](https://github.com/bthubbard/DatabindingIssues)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-11T00:18:46.993

WP8 中的全景控件有一个已知的数据绑定错误。该错误的症状是 SelectionChanged 不会触发，SelectedIndex 和 SelectedItem 不可靠，并且返回导航到带有全景的页面会重置全景所选项目。

例如，以下代码示例永远不会触发 MessageBox，并且 SelectedIndex 和 SelectedItem 不会指示正确的预期值。

```
<phone:Panorama x:Name="panorama"
                ItemsSource="{Binding}" 
                SelectionChanged="Panorama_SelectionChanged_1">
    <phone:Panorama.HeaderTemplate>
        <DataTemplate>
            <ContentControl Content="{Binding Name}" />
        </DataTemplate>
    </phone:Panorama.HeaderTemplate>
    <phone:Panorama.ItemTemplate>
        <DataTemplate>
            <ContentControl Content="{Binding Name}" />
        </DataTemplate>
    </phone:Panorama.ItemTemplate>
</phone:Panorama> 
```

```
private void MainPage_Loaded(object sender, RoutedEventArgs e)
{
    this.DataContext = new ObservableCollection<Cow>()
                           {
                               new Cow("Foo"),
                               new Cow("Bar"),
                               new Cow("Baz")
                           };
}

private void Panorama_SelectionChanged_1(object sender, SelectionChangedEventArgs e)
{
    MessageBox.Show("Panorama_SelectionChanged_1: " + panorama.SelectedIndex);
}

public class Cow
{
    public Cow(string name)
    {
        Name = name;
    }

    public string Name { get; set; }
} 
```

一个明显的解决方法是在代码隐藏中手动初始化 PanoramaItems。

另一种解决方案是将我们的集合从有类型更改为无类型，并将以下代码片段添加到有界数据类中。因此，让我们将代码从`ObservableCollection<Cow>`to更改为`ObservableCollection<object>`并在类中添加一些代码`Cow`：

```
private void MainPage_Loaded(object sender, RoutedEventArgs e)
{
    this.DataContext = new ObservableCollection<object>()
                           {
                               new Cow("Foo"),
                               new Cow("Bar"),
                               new Cow("Baz")
                           };
}

public class Cow
{
    public Cow(string name)
    {
        Name = name;
    }

    public string Name { get; set; }

    public override bool Equals(object obj)
    {
        if ((obj != null) && (obj.GetType() == typeof(PanoramaItem)))
        {
            var thePanoItem = (PanoramaItem)obj;

            return base.Equals(thePanoItem.Header);
        }
        else
        {
            return base.Equals(obj);
        }
    }

    public override int GetHashCode()
    {
        return base.GetHashCode();
    }
} 
```

现在，当我们运行这个代码片段时，我们可以看到 SelectionChanged 以正确的 SelectedIndex 值触发：

![全景图使用正确的 SelectedIndex 触发 SelecitonChanged 事件](../Images/985c22916b8097e3bde87c8e0beed18d.png) ![全景图使用正确的 SelectedIndex 触发 SelecitonChanged 事件](../Images/6c46e00377faacdc23c4048d7d2315ae.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-29T13:55:48.073

对于在可移植类库中拥有 ViewModel 的任何人来说，这只是一个小提示——我将此代码放在我的视图模型的基类中：

```
if (Equals(obj.GetType().Name, "PanoramaItem"))
{
    var datacontextProperty = obj.GetType().GetRuntimeProperty("DataContext");
    var datacontext = datacontextProperty.GetValue(obj);
    return Equals(datacontext, this);
} 
```

这为我解决了这个问题。至于@Sopuli 的评论——我在我测试过的 WP8 设备上肯定仍然存在这个问题。（诺基亚 Lumia 920，WP8.0.10517.150）

* * *

VB.NET 版本：

```
Public Overrides Function Equals(obj As Object) As Boolean
    If Equals(obj.GetType.Name, "PanoramaItem") Then
        Dim datacontextProperty = System.Reflection.RuntimeReflectionExtensions.GetRuntimeProperty(obj.GetType, "DataContext")
        Dim datacontext = datacontextProperty.GetValue(obj)
        Return Equals(datacontext, Me)
    Else
        Return MyBase.Equals(obj)
    End If
End Function 
```

# c# - 如何重构 Switch 语句

> ID：14260710
> 
> 赞同：0
> 
> 时间：2013-01-10T14:56:47.577
> 
> 标签：c#

我正在尝试重构所有开关之母，但我不确定该怎么做。这是现有的代码：

```
 private void SetPrepareFiles(
                  ObservableCollection<PrepareElement> prepareElements)
    {
        DateTime fileLoadDate = DateTime.Now;

        string availabilityRequestFile = string.Empty;
        string infrastructureFile = string.Empty;
        string gsQualityFile = string.Empty;
        string pvdnpProducedFile = string.Empty;
        string docFile = string.Empty;
        string actualCurrentStateFile = string.Empty;
        string actualIpPlanFile = string.Empty;

        foreach (var prepareElement in prepareElements)
        {
            switch (prepareElement.MappingName)
            {
                case "AvailabilityRequest":
                    availabilityRequestFile = prepareElement.FileName;
                    break;
                case "SystemInformation":
                    docFile = prepareElement.FileName;
                    break;
                case "ITStatus":
                    infrastructureFile = prepareElement.FileName;
                    break;
                case "ActualIPPlan":
                    actualIpPlanFile = prepareElement.FileName;
                    break;
                case "ActualCurrentState":
                    actualCurrentStateFile = prepareElement.FileName;
                    break;
                case "Produced":
                    pvdnpProducedFile = prepareElement.FileName;
                    break;
                case "Quality":
                    QualityFile = prepareElement.FileName;
                    break;
            }

        }   

        var fc = new FilesConverter.FilesConverter();           
        fc.SetCommonFiles(availabilityRequestFile, actualCurrentStateFile,
                               actualIpPlanFile, fileLoadDate);         

    } 
```

我将如何重构这个 Switch to a Dictionary

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:07:39.693

实际上，编译器将代码中的开关重构为字典，因为默认情况下字符串不能成为开关的一部分。编译器将所有字符串放入字典中，并为每个字符串分配一个唯一编号。

```
Dictionary<String, Int32> _CompilerGeneratedList = .... {
    { "AvailabilityRequest" , 1 }
}; 
```

你现在切换看起来像这样：

```
Int32 value;
if (_CompilerGeneratedList.TryGetValue(myString, out value))
{
    switch (value) { ... }
} 
```

### 重构

就我个人而言，我会保留您所做的声明，因为重构并没有让它变得更好，但您可以这样做：

```
// Nested Private class
class DataHolder
{
    public String AvailabilityRequestFile { get; set; }
    public String PvdnpProducedFile { get; set; }
}

static Dictionary<String, Action<String, DataHolder>> DataUpdateActions = new Dictionary<String, Action<String, DataHolder>>
{
    { "AvailabilityRequest", (s,d) => d.AvailabilityRequestFile = s; }
    { "Produced", (s,d) => d.PvdnpProducedFile = s; }
}; 
```

现在你可以这样称呼它：

```
DataHolder holder = new DataHolder();
foreach (var prepareElement in prepareElements)
{
    // Do this with try get value to prevent errors
    DataUpdateActions[prepareElement.MappingName](s, holder);

    var fc = new FilesConverter.FilesConverter();           
    fc.SetCommonFiles(holder.AvailabilityRequestFile, holder.ActualCurrentStateFile,
                           holder.ActualIpPlanFile, holder.FileLoadDate); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:11:33.250

大多数语句由编译器`switch`转换为对象。`Dictionary`如果您想自己这样做，这很简单：

```
var dictionary = new Dictionary<string, Action>()
{
    {"AvailabilityRequest", prepareElement => availabilityRequestFile = prepareElement.FileName},
    {"SystemInformation", prepareElement => docFile = prepareElement.FileName}
    //TODO add the others
}; 
```

鉴于您正在访问 中的局部变量`Action`，您需要声明`Dictionary`方法体的内部。如果不是，您可以创建一个静态字典以避免重新创建它。

然后你的`for`循环体变成：

```
dictionary[prepareElement.MappingName](prepareElement); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-10T15:00:49.167

关于什么

```
Dictionary<string, string> fileMappings =
   prepareElements.ToDictionary(e => e.MappingName, e => e.FileName); 
```

# javascript - 三.js 斜率检测

> ID：14260712
> 
> 赞同：2
> 
> 时间：2013-01-10T14:56:50.347
> 
> 标签：javascript, three.js, webgl

我想问一下我们如何在汽车游戏中检测坡度。以便汽车将其检测为斜坡而不是可碰撞的物体。我搜索了很多，但找不到任何有用或有用的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T03:12:20.330

你对这种情况的描述有点模糊，就物理包等而言（或者你正在写一个？），但总的来说，我会说定义倾斜地形的最简单方法是作为高度场 - 一个矩形网格的三角形。因此，制作一个不同高度的 N x M 数组，然后让 Three.js 绘制高度（Y）与数组值匹配的三角形，并间隔......地形细节。

现在对于任何给定的汽车位置，您可以在 JS 中仅根据汽车位置的 X 和 Z 分量快速确定网格中最近的三个点。这只是针对您的网格间距的几个分区。一旦你有了这些，你的 JS 代码就可以将汽车的高度调整到三角形上那个位置的适当 Y，如果你有需要知道那个位置的 3D 斜率的物理解决方案，它也很容易计算。Three.js 本身甚至不需要调用——所有关键信息都在原始地形数组和汽车的 2D 映射到 3D 位置中。

这是一个*专门*针对地形的解决方案——如果您希望能够与任意几何体发生碰撞或不发生碰撞，那么这要复杂得多。

# asp.net-mvc - jquery如何刷新一个div的内容？

> ID：14260713
> 
> 赞同：1
> 
> 时间：2013-01-10T14:56:54.107
> 
> 标签：asp.net-mvc, jquery, asp.net-mvc-4

我有一个`view`正在显示的名为 Forms，它有一个`dropdownlist`. 当`dropdownlist`有不同的选择时，我有一个这样调用的 jquery：

```
 $(document).ready(function () {
        $("#myDropDownList").change(function () {
            $.ajax({
                url: '/Home/Forms/' + $("#myDropDownList option:selected").val(),
                type: 'GET',
                success: function (data) {
                // refresh div
                }
            });
        });
    }); 
```

这是我的表单视图：

```
 @model myProject.ViewModels.PageView

    @section JavaScript
    {
       <script type="text/javascript" src="@Url.Content("/Scripts/jquery.myJQuery.js")"></script>
    }

    @Html.DropDownList("myDropDownList", Model.selectList)

    <div id="somediv">
       @Html.Label(Model.ValueThatShouldChange)
    </div> 
```

因此，当`Forms`再次调用该操作时，`ValueThatShouldChange`我的 ViewModel 中会发生更改，它们将显示在`div`. 这就是为什么我想刷新那个 div 但我不知道该怎么做。

我试过`$('#yourdivID').html(data)`了，但它在 div 中加载了我的整个视图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T15:00:34.660

最简单的方法是使用该功能通过使用其**id**`load()`选择它来仅加载您需要的页面的特定部分。例如：

 **```
$("#yourDivId").load("/Home/Forms/ #" + $('#myDropDownList option:selected').val()) 
```

根据您的网页构建方式（您不提供该信息），您还可以通过包含一个参数来更改您的 Ajax 调用以加载您需要的内容。例如：

```
$(document).ready(function () {
    $("#myDropDownList").change(function () {
        $.ajax({
            url: '/Home/Forms/' + $("#myDropDownList option:selected").val(),
            data: { id : $('#myDropDownList option:selected').val() }
            type: 'GET',
            success: function (data) {
               $('div#yourDivId').html(data);
            }
        });
    });
}); 
```

在您的页面中，您只需根据**id**输出所需的内容（如果是 PHP）：

```
<? if (isset($_POST['id'])) {
      if ($_POST['id'] == "somediv") { ?>
         <div id="somediv">Just this content should be loaded</div>
   <? }
   }
   else { ?>
     <!-- your regular html... -->
?  }   ?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T14:59:31.213

您可以使用

```
$('#yourdivID').html(data) 
```

或者

```
$('#yourdivID').text(data) 
```

取决于你从你的电话中得到什么

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T15:00:25.860

```
$(document).ready(function () {
        $("#myDropDownList").change(function () {
            $.ajax({
                url: '/Home/Forms/' + $("#myDropDownList option:selected").val(),
                type: 'GET',
                success: function (data) {
                  $("div").html(data);
                }
            });
        });
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T14:59:43.257

**嘿。这是最小、最快的答案！:-)**

你想要做的是使用jQuery快捷方式 $.load() [http://api.jquery.com/load/](http://api.jquery.com/load/)

```
$(function() {  // <-- shortcut for $(document).ready
    $("#myDropDownList").on('change', function () { 
        $('#target-div').load('/Home/Forms/' + $("#myDropDownList option:selected").val());
    });
}); 
```

#target-div 只是目标 div 的 CSS 选择器。改变以适应。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T15:00:48.217

如果您只想重绘 div 的内容，您可以使用

```
$('#yourdivID').change(); 
```**

# python - PyDev中的假未解决导入错误

> ID：14260714
> 
> 赞同：5
> 
> 时间：2013-01-10T14:56:54.923
> 
> 标签：python, eclipse, pydev

PyDev 正在报告不存在的导入错误。最初的症状是假的“未解决的导入”错误，通过以下组合修复：

*   清理项目
*   重新索引项目（删除解释器，再次添加）
*   重启 Eclipse
*   烧香给蟒蛇神

现在错误是“来自导入的未验证变量”——它似乎找不到 pymssql.connect。

这不是 PYHTONPATH 问题。我可以很好地访问该模块，文件中带有（所谓的）错误的代码运行良好——它有单元测试和生产代码调用它。

错误在 PyDev 中的某个地方：我在我的 PyDev 项目中添加了一个新模块，并且该错误仅发生在新模块中。我已经尝试了以上所有方法。

* * *

因此，我计划在其他地方发布此代码以征求有关设计的一些评论，并在评论中要求我发布代码。（灵感来自：[数据库连接包装器](https://stackoverflow.com/questions/9367857/database-connection-wrapper)和克林特米勒对这个问题的回答：[如何正确清理 Python 对象？](https://stackoverflow.com/questions/865115/how-do-i-correctly-clean-up-a-python-object)）。导入错误发生在第 69 行（self.connection = pymssql.connect...）。不知道这对回答这个问题有什么好处，但是......

```
import pymssql
from util.require_type import require_type

class Connections(object):
    @require_type('host', str)
    @require_type('user', str)
    @require_type('password', str)
    @require_type('database', str)
    @require_type('as_dict', bool)
    def __init__(self, host, user, password, database, as_dict=True):
        self.host = host
        self.user = user
        self.password = password
        self.db = database
        self.as_dict = as_dict

    @staticmethod
    def server1(db):
        return Connections('','','','')

    @staticmethod
    def server2(db):
        pass

    @staticmethod
    def server3(db):
        pass

class DBConnectionSource(object):
    # Usage:
    #        with DBConnectionSource(ConnectionParameters.server1(db = 'MyDB)) as dbConn:
    #            results = dbConn.execute(sqlStatement)

    @require_type('connection_parameters', Connections)
    def __init__(self, connection_parameters=Connections.server1('MyDB')):
        self.host = connection_parameters.host
        self.user = connection_parameters.user
        self.password = connection_parameters.password
        self.db = connection_parameters.db
        self.as_dict = connection_parameters.as_dict
        self.connection = None

    def __enter__(self):

        parent = self

        class DBConnection(object):
            def connect(self):
                self.connection = pymssql.connect(host=parent.host,
                                                  user=parent.user,
                                                  password=parent.password,
                                                  database=parent.db,
                                                  as_dict=parent.as_dict)

            def execute(self, sqlString, arguments={}):
                if self.connection is None:
                    raise Exception('DB Connection not defined')
                crsr = self.connection.cursor()
                crsr.execute(sqlString, arguments)
                return list(crsr)

            def cleanup(self):
                if self.connection:
                    self.connection.close()

        self.connection = DBConnection()
        self.connection.connect()
        return self.connection

    def __exit__(self, typ, value, traceback):
        self.connection.cleanup() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:34:17.507

在错误所在的行尝试`ctrl+1`并添加一条评论，说明您期望导入。这应该可以解决 PyDev 错误，因为它会进行静态代码分析而不是运行时分析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-11T18:31:12.550

***TL;DR version: read the fifth grey box.***

Your problem (and mine) appears to be due to multiple levels of imports that should be, but is not, handled correctly. Somewhere along the line, linkage is lost.

Assume for a moment that you have a file

```
foo/bar.py 
```

and that within that file, you have a symbol named

```
wazoo=15 
```

If you then try:

```
from foo import bar
from bar import wazoo <-- false error here 
```

Or if you try to use:

```
from foo import bar
...
i = bar.wazoo <-- false error here 
```

You ***may*** get the false unresolved error on ***wazoo***. Being a bug, this is obviously inconsistent.

If however, you do the following:

```
from foo.bar import wazoo 
```

The problems do seem to go away.

As an aside, I've noted that this sometime seems to happen for newly-defined symbols within an imported file. Furthermore, the earlier false errors for some symbols within that file will magically disappear, with the only the new error remaining. This implies that there might be some sort of state file that isn't being cleaned, EVEN WHEN you "buildall", etc.

Note also that this problem seems to occur the most for me when I use the Python enum hack...perhaps this will provide a clue to the PyDev-elopers (is PyDev even being maintained anymore?):

bar.py:

```
def enum(**enums):
  return type('Enum', (), enums)

SOMETHING = enum(A=1, B=2) 
```

someotherfile.py:

```
from foo import bar
from bar import SOMETHING
...
x = SOMETHING.A 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-18T17:12:41.513

我在抛出错误的行尾添加了 # @UndefinedVariable。

这不是一个永久性的修复，但至少它暂时摆脱了我屏幕上的红色。如果有更好的长期解决方案，我会很高兴听到它。

# python - 如何获取小部件的所有连接？

> ID：14260715
> 
> 赞同：0
> 
> 时间：2013-01-10T14:56:56.250
> 
> 标签：python, event-handling, widget, instance, pyside

我有一个 PySide 小部件，有一些连接。有时它们会被基于输入的新小部件实例简单地替换。我怎样才能保留（获取连接对我来说是困难的部分）先前实例的所有连接，这些连接是之前定义的（在第一次创建时）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T16:06:43.823

阅读[文档](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qobject.html)很`QObject`明显，它的 API 没有提供您想要的。

您可以做的最好的事情是检索连接到您的单个信号的对象数量`QObject`。而已。

如果要检索连接的对象，则只能在第一次实例化小部件时将它们添加到序列（列表/字典/集）中，并且在更改小部件时迭代它们并将小部件重新连接到新对象。（您必须保存连接的小部件和用作连接的信号）

另一个选项可以是创建自定义事件/信号，当您替换小部件时，您会发出此信号以提供新实例，以便所有小部件可以重新连接自己。

# three.js - 你如何在 THREE.js r54 中遍历层次结构（对于 LOD）？

> ID：14260717
> 
> 赞同：1
> 
> 时间：2013-01-10T14:57:14.573
> 
> 标签：three.js

我已经从使用 THREE.js 中休息了一段时间，但有一些时间再次进行实验，因此我将我的 THREE.js 构建从 r49 更新到 r54，并设法更新了我实验中的所有内容，但我遇到了 LOD 问题。

在 r49 中，我使用以下内容遍历场景层次结构：

```
THREE.SceneUtils.traverseHierarchy( scene, function ( node ) { if ( node instanceof THREE.LOD ) node.update( cameras[selectedCamera] ) } ); 
```

现在生成一个类型错误并通知我 THREE.SceneUtils.traverseHierarchy 不是一个函数。

检查了 r54 的文档，但它有点落后，所以有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:58:45.930

您可以参考[Migration Wiki](https://github.com/mrdoob/three.js/wiki/Migration)获取升级到当前版本的帮助。

> 将 SceneUtils.traverseHierarchy 替换为 object.traverse。

# dynamics-crm - 无法在 CRM Web 服务 AssignRequest 上分配脱机过滤器错误

> ID：14260719
> 
> 赞同：1
> 
> 时间：2013-01-10T14:57:18.037
> 
> 标签：dynamics-crm, dynamics-crm-4

我正在使用以下博客条目中的代码将用户查询重新分配给不同的用户。我已经在数据库中运行了 DB Update 语句（如下面的博客所示）。

[http://mscrmblogger.com/2009/02/04/crm-4-userquery-privileges-for-system-administrators/](http://mscrmblogger.com/2009/02/04/crm-4-userquery-privileges-for-system-administrators/)

这是我的代码：

```
 CrmAuthenticationToken token = new CrmAuthenticationToken();  
  token.AuthenticationType = AuthenticationType.AD; 
  token.OrganizationName = Request.Params["orgname"];  

  CrmService crmService = new CrmService(); 
  crmService.Url = ConfigurationManager.AppSettings["WebServiceUrl"]; 
  crmService.CrmAuthenticationTokenValue = token;  
  crmService.PreAuthenticate = true;
  crmService.UseDefaultCredentials = false;
  crmService.Credentials = new NetworkCredentials(username, password, domain);  

  SecurityPrincipal newowner = new SecurityPrincipal();  
  newowner.Type = SecurityPrincipalType.User;  
  newowner.PrincipalId = new Guid(userid);  

  TargetOwnedUserQuery query = new TargetOwnedUserQuery();  
  query.EntityId = new Guid(queryid);  

  AssignRequest assign = new AssignRequest();  
  assign.Assignee = newowner;  
  assign.Target = query;  

  AssignResponse assignResponse = (AssignResponse)crmService.Execute(assign); 
```

运行此代码时，我在 crmService.Execute() 处得到以下异常。

```
SOAP Exception
Message: Server was unable to process request
Inner Detail: 0x8000404ff Cannot assign Offline Filters Platform 
```

当为几个用户查询运行这个时，我得到了一些稍微不同的异常。大多数用户查询返回上面显示的上述/第一个异常。一些返回这些不同的 SOAP 异常。

```
2) Inner Detail: 0x80048448 Cannot assign address book filters Platform
3) Inner Detail: 0x80040264 Cannot assign Outlook Filters Platform 
```

据我所知，我们的 CRM 产品没有使用离线过滤器。我们也没有使用与 Outlook 集成相关的任何内容。

自定义 ASPX 页面与我们的 CRM 托管在同一台服务器上，并且位于 ISV 文件夹中。身份验证、站点地图自定义和（似乎）所有其他部分都可以正常工作，以将其集成为自定义页面。

有关如何解决此问题的任何提示？

谢谢

查询获取 UserQueryID，@SystemUserId 通过填充的用户下拉框传入

```
SELECT [Name], [UserQueryId] 
FROM [UserQueryBase] 
WHERE [OwningUser] = @SystemUserId 
ORDER BY [Name] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T21:55:19.527

所以我们真的需要知道你是如何获得 UserQuery 的 Guid 的。如果你能详细说明它可能会有所帮助。话虽如此，我会尽力回答。

仅仅因为您没有使用 Outlook 并不意味着数据库中不会自动生成视图和过滤器。

您需要在进行分配之前检查 UserQuery 实体，以确保它不是生成错误消息的类型之一。您可能还希望记录这些，以便进一步调查它们。

要检查的值`userquery.querytype`是 CrmNumber 类型。它将是使用标志的 Enum 类型（使用 SDK：SDK\Helpers\CS\CrmHelpers\enums.cs）。使用来检查属性是否包含特定类型查询的标志。`.[HasFlag](http://msdn.microsoft.com/en-us/library/system.enum.hasflag%28v=vs.100%29.aspx)(*integer*)`

[有关潜在查询类型的列表，](http://msdn.microsoft.com/en-us/library/cc151264.aspx)请参阅SDK 。

您需要避免分配专为离线使用而设计的查询。

# html - 在标题内，将滑块放在对象后面

> ID：14260722
> 
> 赞同：0
> 
> 时间：2013-01-10T14:57:25.837
> 
> 标签：html, css, wordpress, slider, nivo-slider

我有个问题。我目前正在尝试将 Nivo Slider 实现为标题。在这个标题上是一个带有徽标的框（左）、一个带有导航的框（左下）和一个带有子导航的框（右上）。

我尝试使用[本](http://www.intogeek.com/integrating-nivo-slider-into-your-wordpress-header/)教程来实现它。滑块可以工作，但现在我必须知道如何将它用作“标题背景”，换句话说，我如何将它放在对象后面，而不是挤压它并将对象从预定位置移动。

这是我的代码：

```
<div id="header">
<?php include("header_insert.php"); ?>
<div id="logo">
    <a href="<?php echo home_url( '/' ); ?>"><img src="<?php bloginfo('template_directory'); ?>/images/logo.png" alt="Website Title"/></a>
</div>
<div id="sub_nav">
    <ul>
        <?php wp_list_pages('title_li=&exclude=56,54'); ?>  
    </ul>
</div>
<?php wp_nav_menu( array(‘menu’ => ‘Navigation’ )); ?> 
```

我没有改变太多的 CSS，除了这个：

```
 #logo, #sub_nav, .menu-navigation-container {
z-index: 9999;
}

#wrapper, #slider {
height: 504px;
width: 960px;
margin: 0 auto;
}

.nivoSlider {
border: 0;
} 
```

滑块中有一些 CSS 文件，但我的主要问题是徽标和子导航现在位于标题区域之外，而导航工作正常（在滑块前面和正确位置）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T14:58:48.803

css: z-index 来救援 :)

在滑块上使用较低的 z-index，在元素上使用较高的值，您想放在“顶部”。如果不起作用，请尝试将位置：相对或位置：绝对添加到具有 z-index 的元素。

# javascript - 如何在看似“固定”的图像上使用视差滚动？

> ID：14260725
> 
> 赞同：2
> 
> 时间：2013-01-10T14:57:39.850
> 
> 标签：javascript, css, scroll, parallax, parallax.js

我正在使用视差滚动，目前有一个设置，使我的背景图像以正常内容滚动速度的 50% 滚动。见这里：[www.jurbs.com](http://www.jurbs.com)。（内容在 Chrome 和 Opera 中进行了优化）

理想情况下，我希望图像中根本没有滚动，但随着内容的滚动，图像的可见性会相应地滑动和进步。这方面的例子可以在这里看到：[www.tooyoungtowed.org](http://www.tooyoungtowed.org)。

这是相关的CSS：

```
#content {
z-index: 4;
position: relative;
max-width: 940px;
padding: 0 10px;
margin: 0 auto;
line-height: 1.7;
}
#content article {
    width: 300px;
    }
    #firstbox ,
    #secondbox,
    #thirdbox,
    #fourthbox {
        padding-top: 105px;
        }
    #firstbox {
        position: absolute;
        top: 0px;
        left: 730px;
        }
    #secondbox {
        position: absolute;
        top: 2120px;
        left: 730px;
        }
    #thirdbox {
        position: absolute;
        top: 4240px;
        left: 730px;
        }
        #content h1 {
            margin: 0 0 25px 0;
            font-size: 60px;
            font-family: Helvetica, sans-serif;
            font-weight: bold;
            line-height: 65px;
            }
    #fourthbox {
        position: absolute;
        top: 6360px;
        left: 730px;
        }
        p.whitetext{
            color:#fff;
            }
#parallax-bg3 {
z-index: 3;
position: fixed;
top: 0;
left: 50%;
height: 1080px;
width: 100%;
max-width: 1920px;
margin-left: -960px;
}
#bg3-1 {
    position: absolute;
    top: 0px;
    }
#bg3-2 {
    position: absolute;
    top: 1060px;
    }
#bg3-3 {
    position: absolute;
    top: 2120px;
    }
#bg3-4 {
    position: absolute;
    top: 3180px;
    } 
```

和 parallax.js：

```
$(document).ready(function() {

redrawDotNav();

/* Scroll event handler */
$(window).bind('scroll',function(e){
    parallaxScroll();
    redrawDotNav();
});

/* Next/prev and primary nav btn click handlers */
$('a.firstbox').click(function(){
    $('html, body').animate({
        scrollTop:0
    }, 1000, function() {
        parallaxScroll(); // Callback is required for iOS
    });
    return false;
});
$('a.secondbox').click(function(){
    $('html, body').animate({
        scrollTop:$('#secondbox').offset().top
    }, 1000, function() {
        parallaxScroll(); // Callback is required for iOS
    });
    return false;
});
$('a.thirdbox').click(function(){
    $('html, body').animate({
        scrollTop:$('#thirdbox').offset().top
    }, 1000, function() {
        parallaxScroll(); // Callback is required for iOS
    });
    return false;
});
$('a.fourthbox').click(function(){
    $('html, body').animate({
        scrollTop:$('#fourthbox').offset().top
    }, 1000, function() {
        parallaxScroll(); // Callback is required for iOS
    });
    return false;
});

/* Show/hide dot lav labels on hover */
$('nav#primary a').hover(
    function () {
        $(this).prev('h1').show();
    },
    function () {
        $(this).prev('h1').hide();
    }
);

});

/* Scroll the background layers */
function parallaxScroll(){
var scrolled = $(window).scrollTop();
$('#parallax-bg1').css('top',(0-(scrolled*.25))+'px');
$('#parallax-bg2').css('top',(0-(scrolled*.5))+'px');
$('#parallax-bg3').css('top',(0-(scrolled*.5))+'px');
}

/* Set navigation dots to an active state as the user scrolls */
function redrawDotNav(){
var section1Top =  0;
// The top of each section is offset by half the distance to the previous section.
var section2Top =  $('#secondbox').offset().top - (($('#thirdbox').offset().top - $('#secondbox').offset().top) / 2);
var section3Top =  $('#thirdbox').offset().top - (($('#fourthbox').offset().top - $('#thirdbox').offset().top) / 2);
var section4Top =  $('#fourthbox').offset().top - (($(document).height() - $('#fourthbox').offset().top) / 2);;
$('nav#primary a').removeClass('active');
if($(document).scrollTop() >= section1Top && $(document).scrollTop() < section2Top){
    $('nav#primary a.firstbox').addClass('active');
} else if ($(document).scrollTop() >= section2Top && $(document).scrollTop() < section3Top){
    $('nav#primary a.secondbox').addClass('active');
} else if ($(document).scrollTop() >= section3Top && $(document).scrollTop() < section4Top){
    $('nav#primary a.thirdbox').addClass('active');
} else if ($(document).scrollTop() >= section4Top){
    $('nav#primary a.fourthbox').addClass('active');
}

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T15:11:12.860

我认为您需要为每个图像使用包装 div，并在 div 上使用视差，而不是图像本身。在这里查看[http://teamideas.pt](http://teamideas.pt)，这是我使用[stellar.js 构建](http://markdalgleish.com/projects/stellar.js/)的用于视差效果的网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-12T20:28:30.373

如今，您可以使用 CSS：

```
.parallax {
  background-image: url(path/to/image.jpg);
  background-repeat: no-repeat;
  background-size: cover;
  background-position: 50%;
  width: 100vw;
  height: 100vh;

  /* This does the trick */
  background-attachment: fixed;
} 
```

# spring - Quartz 作业调度完成

> ID：14260729
> 
> 赞同：1
> 
> 时间：2013-01-10T14:57:45.290
> 
> 标签：spring, quartz-scheduler

我在 Spring Framework 应用程序中有多个 QuartzJobBean。这些工作是根据他们的需要安排的。我有如下问题。

每 5 秒触发一次作业。

比方说；

```
1st execution at 00.00.05
2nd execution at 00.00.10
3rd execution at 00.00.15
.
.
.
etc. 
```

但是，如果第一次执行持续 6 秒，则第二次执行将在第一次执行完成后立即执行。如果可能，我想按以下方式安排我的工作？

```
1st execution at 00.00.05 (execution time 6 seconds)
2nd execution at 00.00.16 (execution time 3 seconds)
3rd execution at 00.00.24 (execution time x seconds)
4th execution at 00.00.24+5+x 
.
.
.
etc. 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T12:38:01.690

我最终扩展了 QuartzJobBean 并实现了 StatefulJob。作为触发器，我使用了具有 repeatInterval 属性 xxxx 毫秒的 SimpleTriggerBean。

我的工作类

```
public class MyJob extends QuartzJobBean implements StatefulJob 
```

弹簧上下文

```
<bean id="myJobTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerBean">
    <property name="jobDetail" ref="myJob"/>
    <property name="startDelay" value="0" />
    <property name="repeatInterval" value="2000" />
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T16:05:11.950

您可以通过让工作在完成工作时自行重新安排来做到这一点。

您应该小心，如果工作意外结束，可能不会进行重新安排。

例如，您可以通过侦听器来做到这一点：[quartz job listener](http://quartz-scheduler.org/documentation/quartz-2.x/cookbook/JobListeners)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T18:38:07.503

实际上，如果您已经使用 Spring，则根本不需要 Quartz。引用[*25.5.1 @Scheduled 注释*](http://static.springsource.org/spring/docs/3.0.x/reference/scheduling.html#scheduling-annotation-support-scheduled)：

> ### 25.5.1 @Scheduled 注解
> 
> `@Scheduled`注释可以与触发器元数据一起添加到方法中。例如，以下方法将以固定延迟每 5 秒调用一次，这意味着该周期将从每个先前调用的完成时间开始计算。
> 
> ```
> @Scheduled(fixedDelay=5000)
> public void doSomething() {
>   // something that should execute periodically
> } 
> ```

文档中的示例似乎*完全*涵盖了您想要的内容。

# xpages - 防止为计算的 HTML 字段生成跨度标签？

> ID：14260733
> 
> 赞同：0
> 
> 时间：2013-01-10T14:58:02.787
> 
> 标签：xpages

我的页面上有一个为 HTML 设置的计算字段。HTML 生成，但每个计算字段都被一个 span 标签包裹。有没有办法避免这种情况？

我的问题与这个问题有关吗？

[“计算字段”控制和 disableOutputTag="true" 不起作用？](https://stackoverflow.com/questions/10623143/computed-field-controll-and-disableoutputtag-true-doesnt-work?rq=1)

我需要使用禁用标签属性，但似乎有一个错误？

有解决方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T15:02:49.443

是的，删除计算域的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T15:12:18.583

您可以删除该`id`属性（如果您没有将 ID 用于任何操作，例如部分刷新）并将该`disableTheme`属性设置为`true`. 例如

```
<xp:text escape="true" disableTheme="true">
    <xp:this.value><![CDATA[#{javascript:"Value"}]]></xp:this.value>
</xp:text> 
```

`span`这将只生成没有标签的文本值。

# java - Java如何在给定方法的情况下解密字节数组

> ID：14260734
> 
> 赞同：1
> 
> 时间：2013-01-10T14:58:10.540
> 
> 标签：java, encryption

```
import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;

import org.apache.commons.codec.binary.Base64;

public class EncryptDecryptExample
{
    // "thisIsASecretKey";
    private static byte[] key = { 0x74, 0x68, 0x69, 0x73, 0x49, 0x73, 0x41, 0x53, 0x65, 0x63, 0x72, 0x65, 0x74, 0x4b, 0x65,
            0x79 };

    public static void main(String[] args) throws Exception
    {
        //********************WORKS**********************
        String x = "Hello";
        System.out.println("Plain Text: " + x);
        String e = EncryptString(x);
        System.out.println("Encrypted: " + e);
        String d = decryptString(e);
        System.out.println("Deccypted: " + d);

        //********************WORKS**********************
        Byte b = 124;
        System.out.println("Plain Byte: "+b.toString());
        String eb = EncryptString(b.toString());
        System.out.println("Encrypted Byte: "+eb);
        String bd = decryptString(eb);
        System.out.println("Decrypted Byte: "+bd);

        //********************DOESNT*WORK*********************
        Byte[] bArray = {23, 42, 55};
        System.out.println("Plain Byte Array: "+bArray[0].toString()+","+bArray[1].toString()+","+bArray[2].toString());
        String eba = EncryptString(bArray.toString());
        System.out.println("Encrypted Byte Array: "+eba.toString());
        String deba = decryptString(eba.toString());
        System.out.println("Decrypted Byte Array: "+deba.getBytes()[0]);  //<--- Doesn't work
        //*********************************************
    }

    public static String EncryptString(String strToEncrypt) throws Exception
    {
        Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
        SecretKeySpec secretKey = new SecretKeySpec(key, "AES");
        cipher.init(Cipher.ENCRYPT_MODE, secretKey);
        String encryptedString = Base64.encodeBase64String(cipher.doFinal(strToEncrypt.getBytes()));
        return encryptedString;
    }

    public static String decryptString(String strToDecrypt) throws Exception
    {
        Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5PADDING");
        SecretKeySpec secretKey = new SecretKeySpec(key, "AES");
        cipher.init(Cipher.DECRYPT_MODE, secretKey);
        String decryptedString = new String(cipher.doFinal(Base64.decodeBase64(strToDecrypt)));
        return decryptedString;
    }

} 
```

**结果：**

> ```
> Plain Text: Hello
> Encrypted: VKzhMlqHstjsGJHhbFS5wA==
> Deccypted: Hello
> Plain Byte: 124
> Encrypted Byte: fuRAfj1yLXnEp+g25a1iYg==
> Decrypted Byte: 124
> Plain Byte Array: 23,42,55
> Encrypted Byte Array: lURk/e+MIt6xa9s3wBnmKxyiuOmM/6JfwX6ujttNqWw=
> Decrypted Byte Array: 91 <--- ?? why is this wrong 
> ```

**为什么我不能正确地从字节数组中检索我的字节？**

---->注意

**我想要一种，所有强大的解密和一种加密方法。我知道我可以使用不同的方法签名来做到这一点。但我不想要一个重载的函数。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:10:44.827

数组的To`toString`方法不会将数组的内容作为字符串提供给您。它只是为您提供了一个相当模糊的参考标识符。

您的问题在以下行中：

```
Byte[] bArray = {23, 42,   
String eba = EncryptString(bArray.toString()); 
```

考虑使用[Arrays.toString()](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#toString%28byte%5B%5D%29)方法将字节数组转换为可加密字符串。

```
String eba = EncryptString(Arrays.toString(bArray)); 
```

**更新：** 正如@jlordo 在下面指出的那样，下面的行中存在相同错误的变体，即

```
System.out.println("Encrypted Byte Array: "+eba.toString());
String deba = decryptString(eba.toString()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:27:22.910

我建议使用 byte[] 作为 crypt 函数的输入和输出。你不需要超载。使用 byte[] 的 Crypt 函数将能够存储和检索任何数据类型。

据我所知，Arrays.toString(byte[]) 没有简单的逆。如果有相反的情况，您可以继续执行您的程序而无需进行很多修改。但是，没有。

你会想要这样的东西：

```
byte[] bytes = ...;
String stringRepresentationOfBytes = Arrays.toString(bytes);
byte[] stringRepresentationOfBytesConvertedBackToByteArray = 
    ByteArray.fromString(stringRepresentationOfBytes); 
```

但是没有这样的东西`ByteArray.fromString(String)`。

我建议使用 byte[] 作为进出 crypt 函数的基本数据类型：

```
public class SOEncryptDecryptExampleBytes
{
    // "thisIsASecretKey";
    private static byte[] key = { 0x74, 0x68, 0x69, 0x73, 0x49, 0x73, 0x41, 0x53, 0x65, 0x63, 0x72, 0x65, 0x74, 0x4b, 0x65, 0x79 };

    private static final String STRING_ENCODING = "UTF-8";

    public static void main(String[] args) throws Exception
    {
        //*********************************************
        String x = "Hello";
        System.out.println("Plain Text: " + x);
        String e = encryptBytesAndBase64Encode(x.getBytes(STRING_ENCODING));
        System.out.println("Encrypted: " + e);
        byte[] d = base64decodeAndDecryptBytes(e);
        System.out.println("Decrypted: " + new String(d, STRING_ENCODING));

        //*********************************************
        byte b = 124;
        System.out.println("Plain Byte: " + b);
        String eb = encryptBytesAndBase64Encode(new byte[] { b });
        System.out.println("Encrypted Byte: " + eb);
        byte[] bd = base64decodeAndDecryptBytes(eb);
        System.out.println("Decrypted Byte: " + bd[0]);

        //*********************************************
        byte[] bArray = { 23, 42, 55 };
        System.out.println("Plain Byte Array: " + Arrays.toString(bArray));
        String eba = encryptBytesAndBase64Encode(bArray);
        System.out.println("Encrypted Byte Array: " + eba);
        byte[] deba = base64decodeAndDecryptBytes(eba);
        System.out.println("Decrypted Byte Array: " + Arrays.toString(deba));
        //*********************************************
    }

    /**
     * Transforms a byte[] into an encrypted byte[] and then uses base64 encodes the encrypted byte[]
     */
    public static String encryptBytesAndBase64Encode(byte[] bytes) throws Exception
    {
        Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
        SecretKeySpec secretKey = new SecretKeySpec(key, "AES");
        cipher.init(Cipher.ENCRYPT_MODE, secretKey);
        String encryptedString = Base64.encodeBase64String(cipher.doFinal(bytes));
        return encryptedString;
    }

    /**
     * Base64 decodes a string into a byte[] and then decrypts those bytes into a decrypted byte[]
     */
    public static byte[] base64decodeAndDecryptBytes(String base64EncodedEncryptedBytes) throws Exception
    {
        Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5PADDING");
        SecretKeySpec secretKey = new SecretKeySpec(key, "AES");
        cipher.init(Cipher.DECRYPT_MODE, secretKey);
        byte[] decryptedBytes = cipher.doFinal(Base64.decodeBase64(base64EncodedEncryptedBytes));
        return decryptedBytes;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T15:14:37.640

您将能够通过更改最后一个块来获得所需的结果：

```
...
    //*********************************************
    byte[] bArray = {23, 42, 55};
    String stringRepresentation = bArray[0] + "," + bArray[1] + "," + bArray[2];
    System.out.println("Plain Byte Array: " + Arrays.toString(bArray));
    String eba = EncryptByteArray(bArray);
    System.out.println("Encrypted Byte Array: "+eba);
    byte[] deba = decryptByteArray(eba);
    System.out.println("Decrypted Byte Array: "+Arrays.toString(deba));
    //*********************************************
}

public static String EncryptByteArray(byte[] array) throws Exception
{
    Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
    SecretKeySpec secretKey = new SecretKeySpec(key, "AES");
    cipher.init(Cipher.ENCRYPT_MODE, secretKey);
    String encryptedString = Base64.encodeBase64String(cipher.doFinal(array));
    return encryptedString;
}

public static byte[] decryptByteArray(String strToDecrypt) throws Exception
{
    Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5PADDING");
    SecretKeySpec secretKey = new SecretKeySpec(key, "AES");
    cipher.init(Cipher.DECRYPT_MODE, secretKey);
    return cipher.doFinal(Base64.decodeBase64(strToDecrypt));
} 
```

# c# - 用于在将字符串输入查询之前检查字符串是否存在的 LINQ 函数

> ID：14260740
> 
> 赞同：1
> 
> 时间：2013-01-10T14:58:24.627
> 
> 标签：c#, .net, linq

我目前有一个查询（这里是伪代码！），例如：

```
var query = p.Companies.Any((a => a.Name != "" || a.Name.Contains(variable1) &&
                            (a => a.Description != "" || a.Description.Contains(variable2)); 
```

现在，显然这是我正在尝试做的事情的简化版本，因为还有更多字段供我检查，但我的答案的基础是 - 我可以创建一个以这样的方式构建的函数/表达式它只生成它需要的SQL？

如：

```
Expression<Func<Company, bool>> companyQuery;
if(!String.IsNullOrEmpty(variable1)) {
   // build up my expression
}

// Pass expression through to query when finalized 
```

有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T15:25:07.637

你可能不需要。您可以相信数据库会在执行查询之前为您优化查询，因此这不太可能成为问题。

也就是说，是的，你可以做到，而且也不是那么难。（如果表达式与 OR 语义相结合，那么工作量会更大。

```
IQueryable<Company> query = p.Companies.AsQueryable();

if(!string.IsNullOrEmpty(variable1))
    query = query.Where(company => company.Name != "" || company.Name.Contains(variable1));

if(!string.IsNullOrEmpty(variable2))
    query = query.Where(company => company.Description != "" || company.Description .Contains(variable1));

bool result = query.Any(); 
```

这是我发现在高级搜索屏幕上经常使用的一种模式。如果他们正在搜索此字段，请过滤此字段，如果他们未过滤此字段，请不要包含它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:25:58.453

您可以使用该类按需构建查询`IQueryable`，例如：

```
IQueryable<Company> query = p.Companies;

if (condition1)
{
    query = query.Where(expression1);
}

if (condition2)
{
    query = query.Where(expression2);
} 
```

# ruby-on-rails - Rails 以简单的形式添加新的相关记录

> ID：14260741
> 
> 赞同：0
> 
> 时间：2013-01-10T14:58:32.470
> 
> 标签：ruby-on-rails, simple-form

我有一个 Rails (paltformatec) simple_form 输入表单，我想在其中包含来自相关模型的记录 - 我已经看到关联，但我想创建新记录而不是选择一个

我有输入新人的表格 - 我有渲染我希望能够将一个或多个家庭成员输入到相关表中：我相信我需要 javascript 或咖啡脚本来允许创建可变数量的家庭成员但我什至买不到。以下是表格的一部分

```
= f.input  :zip, :label => 'Zip', :input_html => { :class => "span1" }
= f.input  :phone, :label => 'Phone', :input_html => { :class => "span2" }
= f.input  :spouse, :label => 'Spouse'
= render  'family_members/form' 
```

这是我的家庭成员表格，我想在其中添加一个或多个人：

```
= simple_form_for :family_members do |f|
= f.input :name
= f.input :relation
= f.input :age
= f.input :encrypted_ssn 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:15:27.420

看看[cocoon](https://github.com/nathanvda/cocoon)（它有 simple_form 的示例）或[awesome_nested_fields](https://github.com/lailsonbm/awesome_nested_fields)（更复杂但更灵活）。

# c++ - C++ 预期的类型说明符

> ID：14260751
> 
> 赞同：3
> 
> 时间：2013-01-10T14:59:17.780
> 
> 标签：c++, compiler-errors, g++

### 背景

我正在进行一个为 Arduino 编写类似 stl 的容器的[项目。](https://bitbucket.org/nwehr/kick)到目前为止，我已经成功编写了双端队列、向量和字符串。

### 问题

我遇到了`map`容器问题。出于某种原因，在该`map::insert()`方法中，编译器告诉我它需要一个类型说明符。我已经包含了与问题相关的所有代码。任何帮助，将不胜感激。

```
///////////////////////////////////////////////////////////////////////////////
// pair
///////////////////////////////////////////////////////////////////////////////
template<typename K, typename V>
class pair {
public:
    pair( const K& key, const V& val )
    : _key_( key )
    , _val_( val )
    {}

    pair( const pair& p )
    : _key_( p.key() )
    , _val_( p.val() )
    {}

    virtual ~pair(){}

    K& key(){
        return _key_;
    }

    V& val(){
        return _val_;
    }

private:
    K _key_;
    V _val_;
};

///////////////////////////////////////////////////////////////////////////////
// map
///////////////////////////////////////////////////////////////////////////////
template<typename K, typename V>
class map {
public:
    map()
    : _size_( 0 )
    , _items_( 0 )
    {}

    virtual ~map(){
        for( int i = 0; i < _size_; ++i )
            delete _items_[i];

        free( _items_ );

    }

    void insert( const pair<K,V>& p ){
        _items_ = reinterpret_cast<kick::pair<K,V>**>( realloc( _items_, (sizeof( void* ) * (++_size_)) ) );
        _items_[_size_ - 1] = new pair( p ); //error: expected type-specifier
    }

    V& operator[]( const K& key ){
        for( int i = 0; i < _size_; ++i ){
            if( _items_[i].key() == key )
                return _items_[i].val();

        }

    }

private:
    int _size_;
    pair<K,V>** _items_;

}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T15:03:15.567

`pair`只是一个模板，而不是一个类型。编译器需要模板参数，在这种情况下是类型。也就是说，它期望您的线路是：

```
_items_[_size_ - 1] = new pair<K,V>( p ); 
```

不，它不能推导出模板参数；这仅适用于模板函数，不适用于类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:01:18.487

`new pair<K,V>( p )`是它想要的。

对于我自己，我会在上面实现一个平面地图，`vector`所以我不必在其中进行内存管理。这样做的一个优点是您可以删除一个间接级别。（间接是性能杀手）。

另一个想法是要有一个高水位分类标记，分类标记之前的东西被分类，而它之后的东西是杂乱无章的。当容器变大时，这可以减少比较。但首先让你的平面地图工作。

# c# - 获取 GridView 列标题文本 - 始终返回空白

> ID：14260753
> 
> 赞同：7
> 
> 时间：2013-01-10T14:59:25.020
> 
> 标签：c#, asp.net, gridview

我有一个 GridView，我想从中获取列标题的文本。

```
for (int j = 0; j < grdToDisplay.HeaderRow.Cells.Count; j++)
{
    string s = grdToDisplay.HeaderRow.Cells[j].Text.ToString(); //Returns ""
    s = grdToDisplay.HeaderRow.Cells[j].Text; //Returns ""
    s = grdToDisplay.Rows[0].Cells[j].Text; //Returns text from first row of results not the header
   // s = grdToDisplay.Columns[j].HeaderText.ToString(); // does not work as column count is 0
} 
```

GridView 内容是在运行时根据用户查询生成的。标题可以点击排序。

如何循环 GridView 并列出列标题文本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T15:05:12.463

您可以使用[`GridViewColumn.HeaderText`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datacontrolfield.headertext.aspx)

```
for (int i = 0; i < grdToDisplay.Columns.Count; i++)
{
    string header = grdToDisplay.Columns[i].HeaderText;
} 
```

**编辑**：

> 但这不会给我任何结果，因为列数为 0

然后你有`AutoGenerateColumns=true`并且只有声明性添加的列被计算在内。因此，在数据绑定**后**使用此代码`GridView`：

```
for (int i = 0; i < grdToDisplay.HeaderRow.Cells.Count; i++)
{
    string header = grdToDisplay.HeaderRow.Cells[i].Text;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-12T08:15:31.017

由于 GridView 的标题是可排序的，因此您可以从 Linkbutton 获取标题的文本。试试这个：将以下代码放入gridView的DataBind中：

```
for (int i = 0; i < gridView.HeaderRow.Cells.Count; i++)
            {

                if (gridView.HeaderRow.Cells[i].HasControls())
                {
                    //when gridview is sortable, type of header is LinkButton
                    // Linkbutton is in index 0 of the control
                    if (gridView.HeaderRow.Cells[i].Controls[0] is LinkButton)
                    {
                        LinkButton headerControl = gridView.HeaderRow.Cells[i].Controls[0] as LinkButton;
                       string headerName = headerControl.Text;

                    }

                }

            } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-23T01:29:57.540

我根据我在这里和其他线程中阅读的内容创建了自己的解决方案..这里是：

```
public void HideColumnByName(GridView grid, string header)
        {
            if (grid.HeaderRow.HasControls()==true)
            {
                for (int i = 0; i < grid.HeaderRow.Cells.Count; i++)
                {
                    if (grid.HeaderRow.Cells[i].Text == header)
                    {
                        foreach (GridViewRow row in grid.Rows)
                        {
                            row.Cells[i].Visible = false;
                            grid.HeaderRow.Cells[i].Visible = false;
                        }
                    }

                }
            }
        } 
```

该方法直接隐藏列的标题和单元格，其中标题名称（或列名称）是传递给我的方法的字符串参数（“标题”参数）。然后从我的 gridview 的“DataBound”事件中调用“HideColumnByName”方法。简单的。希望这可以帮助 ！它确实对我有用！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-21T16:46:51.607

我最近在做一些最近的编码时遇到了这个问题，每当我尝试获取标题文本时，即使在数据绑定事件上它也总是返回空白。当我想尝试根据列自己的控制方案转换标题时，我才想到了解决方案。

事实证明，使 gridview 可排序会将标题文本转换为其他内容，从而无法简单地从标题中获取信息而不进行转换。我自己对这个问题的解决方案是在我要求文本时简单地让它不可排序，但假设这是不可能的，我确实遇到了获取文本的解决方案，即使它在另一个线程中是可排序的：

[启用 AllowSorting 时 ASP.NET GridView 标题行文本为空](https://stackoverflow.com/questions/16268996/asp-net-gridview-header-row-text-empty-when-allowsorting-enabled)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-09T05:45:48.013

```
grdExcel.HeaderRow.Cells[0].Text.ToString(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-09T10:45:46.890

[![在此处输入图像描述](../Images/cc276a09e380d0e71e0c987187921d47.png)](https://i.stack.imgur.com/MtcGg.png)
如果模板列基于数据源，则标题文本返回文件名

*   **GridView.Columns(i).HeaderText**

但是如果您需要首先获取列的标题文本，请使用该行

*   **GridView.HeaderRow.Cells(i).Text**

此链接可以帮助您 [获取 Gridview 单元格的标题文本](https://stackoverflow.com/questions/2091202/get-header-text-of-gridview-cell)

# jquery - 在 Wordpress 单个帖子中包含同位素项目，不依赖

> ID：14260755
> 
> 赞同：0
> 
> 时间：2013-01-10T14:59:30.633
> 
> 标签：jquery, css, wordpress

前几天我遇到了一个问题，试图将 Isotope 实现到带有可点击可调整大小图像的 Wordpress 帖子中。

我使用了这个演示“http://jsfiddle.net/desandro/zhbLL/3/embedded/result,js,css,html,resources/”并重建它，它可以在包含所有文件的常规 HTML 文件中正常工作和css，但是一旦我尝试将其应用于 wordpress 帖子，它将无法工作。

就像在演示中一样调整图像大小工作正常，唯一的区别是图像在单击时出现两次。另一个问题是，当我更改设备/窗口大小时，同位素项目不会重新布局。

此外，Div ID 容器的 CSS 中的“width:100%”值使所有同位素项目都消失了。

我认为这可能与同位素项目及其容器现在嵌套在 Single.php 文件的其他容器中的事实有关。

我不确定是什么原因造成的，但因为我没有更改我链接的小提琴中的 CSS，为了测试可能导致这些问题的原因，我将粘贴 wordpress single.php 的 CSS。

我还确保来自小提琴链接的两个 .js 文件都可以正常工作。加载同位素以及自定义 .js 脚本。

单篇文章的 CSS

```
.post-content-content {
float: left;
width: 100%;
margin-bottom: 40px;
padding-bottom: 30px;
}

#content-container {
height: auto;
min-height: 300px;
padding-bottom: 0px;
}

#content {
float: left;
height: auto;
min-height: 200px;
padding-left: 17px;
padding-right: 17px;
top:45px;
left:0;
right:0;
margin-right: 0px;
margin-left: 0px;
position:relative;
} 
```

# c++ - 将 fork() 与 boost::asio::ip::tcp::iostream 一起使用是否安全？

> ID：14260760
> 
> 赞同：6
> 
> 时间：2013-01-10T14:59:37.063
> 
> 标签：c++, c++11, posix, fork, boost-asio

我正在尝试守护一个简单的 TCP 客户端，虽然客户端在前台工作得很好，但守护它会导致奇怪的行为。

作为一个测试用例，我有一个服务器，一旦您连接并发送一条消息（“已连接”），它将向您发送每秒连接一次的秒数。

如果我守护进程（通过调用`Test::Connect(true)`），连接会在任意时间后断开，即使在成功接收到几个数字之后也是如此。

如果我不进行守护进程（通过调用`Test::Connect(false)`），连接将保持活动状态，并且我将继续按预期接收号码。

```
#include <string>
#include <iostream>
#include <boost/asio.hpp>
#include <unistd.h>
class Test
{
  public:
    Test()
    {
      io = nullptr;
    }
    void Connect(bool daemonize)
    {
      io = new boost::asio::ip::tcp::iostream("localhost", "6500");
      if ( io && *io )
      {
        *io << "connected" << std::endl;

        if ( daemonize )
        {
          pid_t child = fork();
          if ( child < 0 ) exit(EXIT_FAILURE);
          else if ( child > 0 ) exit(EXIT_SUCCESS);

          umask(0);
          if ( setsid() < 0 ) exit(EXIT_FAILURE);
          if ( chdir("/tmp") < 0 ) exit(EXIT_FAILURE);

          child = fork();
          if ( child < 0 ) exit(EXIT_FAILURE);
          else if ( child > 0 ) exit(EXIT_SUCCESS);
        }

        std::string line;
        while ( *io )
        {
          std::getline(*io, line);
          std::cout << "Line (" << line.length() << "): " << line << std::endl;
        }
      }
      delete io;
      io = nullptr;
    }
  private:
    boost::asio::ip::tcp::iostream *io;
} 
```

我完全不知道什么可能会提前切断输入流（看起来循环退出了，因为`io->eof() == true`和因此`(bool)*io == false`）。由于这只发生在尝试守护进程时，我应该完全避免分叉吗？有没有更好的方法以编程方式将进程发送到后台（仅使用 C/C++ 代码）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:15:57.093

我不确定这是否相关，但你需要在这里打电话吗[`notify_fork`](http://www.boost.org/doc/libs/1_47_0/doc/html/boost_asio/overview/posix/fork.html)，例如：

```
boost::asio::io_service io_service;
// ...
if ( daemonize )
{
  io_service.notify_fork(boost::asio::io_service::fork_prepare);
  pid_t child = fork();
  if (child == 0) io_service.notify_fork(boost::asio::io_service::fork_child);
  else io_service.notify_fork(boost::asio::io_service::fork_parent);
  // ...
} 
```

# php - 如何在php中获取上周的facebook帖子

> ID：14260764
> 
> 赞同：1
> 
> 时间：2013-01-10T14:59:41.807
> 
> 标签：php, facebook, facebook-graph-api

我需要从上周的示例中的特定时间段获取我所有的 Facebook 帖子（字段“消息”和“日期”）。

我需要它们在 php 变量中。

你能帮助我吗？

这给了我最后 25 个：

```
$pageFeed = $facebook->api('1750433298/feed');
       print_r($pageFeed); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:04:58.047

API 返回 JSON 对象，该对象由“数据”数组（您的消息）和“分页”组成。“分页有 2 个字段，“上一个”和“下一个”。为了获得更多消息，您需要点击“下一个”字段中给出的链接。

```
$pageFeed = $facebook->api('1750433298/feed');
$next = $pageFeed["paging"]["next"]; //contains link to set of next 25 messages
$exp = explode("until=",$next);
$until = $exp[1]; // timestamp of last message in next set
$nextPage = $facebook->api('1750433298/feed', "GET", array(
'limit' => 25,
'until' => $until
)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:08:48.837

试试这个：

```
1750433298/feed?since=2012-12-31&until=2013-01-06&limit=200 
```

您可能仍然没有收到所有帖子。Feed 有一些严格的限制，因此您可能需要通过分页链接执行多个查询以获取所有查询。

如果您需要对返回的内容进行更多控制，请查看`stream`使用 FQL 查询表。

# spotify - libspotify 期望与打包相关的编译器标志是什么？

> ID：14260771
> 
> 赞同：2
> 
> 时间：2013-01-10T15:00:01.977
> 
> 标签：spotify, libspotify

我在 Windows 上使用 libspotify 12.1.51。虽然它主要按预期工作，但我遇到了一些困难`sp_offline_sync_status`：

```
typedef struct sp_offline_sync_status {
  int queued_tracks;
  sp_uint64 queued_bytes;

  int done_tracks;
  sp_uint64 done_bytes;

  int copied_tracks;
  sp_uint64 copied_bytes;

  int willnotcopy_tracks;

  int error_tracks;
  bool syncing;

} sp_offline_sync_status; 
```

（`sp_uint64`在 Windows 上是 unsigned __int64 的 typedef，否则是 uint64_t。在 C（不是 C++）中构建时，如果 bool 没有另外定义，它是 unsigned char 的 typedef。）

当我打电话时`sp_offline_sync_get_status`，`queued_tracks`似乎只有正确的数据，其余的都是垃圾。但是，如果我将头文件编辑为包含`#pragma pack(1)`，它似乎会给出更合理的结果。即使我尝试构建`spshell`libspotify 附带的示例，我也会观察到这种行为。*

这使我相信 libspotify 二进制文件是使用一些与默认值不同的编译器标志编译的，至少在使用 Visual C++ 的 Windows 上是这样。我应该如何编译 C 或 C++ 代码以使用 libspotify？或者我应该在#include api.h 之前使用#pragma pack 然后恢复它？我可以期望这在未来版本的 libspotify 中保持稳定还是可能会改变？它在不同平台上有何不同？

我的真正目标是编写 C# P/Invoke 代码，该代码可在各种使用 Mono 的平台上运行。在非 Windows 平台上，libspotify 是否坚持本机编译器的默认对齐方式，还是我需要在每个平台上指定自定义对齐方式？

[*] - 不过，我确实必须先修复一些其他错误。正如 libspotify 12.1.51 中所提供的，在 Windows 上，spshell 将控制按键（例如 shift、ctrl）注册为输入 NUL 字符。这可以防止在控制台中键入或粘贴 spotify URI。这可以通过编辑 spshell_win32.c 添加`case 0: break;`到`console_input`. 此外，它在函数的 spshell.c 中使用字符串格式说明符“%zd” `offline_status_updated`。Microsoft C 运行时似乎无法处理此问题，因此需要对其进行更改（例如，如果您只希望它在 Windows 上工作，则更改为“%Iu”，或者更改为平台敏感的宏）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T10:58:15.880

libspotify 使用“-Zp4”编译，而标准似乎是“-Zp8”。我想可以使用该标志进行编译，或者使用 #pragma pack(4) 指令（我实际上认为 4 比 1 更正确，正如您在问题中使用的那样）

将在 Jira 中添加注释以修复您指出的 spshell.c 中的错误。谢谢！

# java - 什么 表示在 无效的说（）

> ID：14260775
> 
> 赞同：10
> 
> 时间：2013-01-10T15:00:09.670
> 
> 标签：java, generics

`<T>`以下代码段中的含义是什么？

```
class Test {    
     <T> void say() {

     }    
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-10T15:14:57.110

在您的示例中，这确实没有意义。但在其他情况下，如果方法的返回类型为 void，`<T>`仍然可以用作预期的泛型参数类型。考虑这个

```
public static <T> void test(List<T> list1, List<T> list2) {
    list1.addAll(list2);
}

public static void main(String[] args) throws Exception {
    test(Arrays.asList(1, 1), Arrays.asList("1", "1"));
} 
```

类型安全控制，javac 给出错误，test() 需要相同类型的列表。

另一个例子 java.util.Collections.fill

```
public static <T> void fill(List<? super T> list, T obj) {
    ....
} 
```

再次键入安全控制。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-10T15:01:13.737

它引入了一个类型占位符，`T`几乎可以是任何类型。`T`如果是签名的一部分（作为参数或返回类型），这通常很有用：

```
<T> void say(T myT) {}
say<Object>(myObject);
say<String>(myString);

<U> U foo(U u) { return u; }
String s = foo<String>(""); 
```

仅仅为了内部使用而引入类型参数很少有用，因为`T`对于消费者来说，实际通常比方法更有趣。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T15:02:39.370

请参阅[this doc about generics in java](http://docs.oracle.com/javase/tutorial/extra/generics/index.html)

但只有在参数列表中有参数化类型时它才有用。

# jquery - 使用 jquery 将选择器元素的 html 写入 textarea

> ID：14260778
> 
> 赞同：2
> 
> 时间：2013-01-10T15:00:15.403
> 
> 标签：jquery, dom, textarea, innerhtml

我正在尝试将页面上各种元素的 html 写入 textarea 元素。如果我的 textarea 的 id 是 'textarea_id' 并且我在 var 中有一个 html 字符串`html_str`，我可以将字符串写入我的文本区域

```
$('#textarea_id').html(html_str); 
```

这似乎在所有情况下都有效，除非`html_str`包含选择器元素的标记。在这种情况下，只有看起来是空格和换行符的内容才会写入 textarea，之后，只能写入这些字符，直到 textarea 被清除

```
$('#textarea_id').html(''); 
```

不管内容如何`html_str`。`html_str` 数字空格和换行符与Using中的字符数不对应

```
document.getElementById('textarea_id').innerHTML = html_str; 
```

不存在这个问题。如果有人对此有任何见解，我想了解这里的机制差异。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T15:04:21.237

您可以使用

```
$('#textarea_id').val(your_string_here); 
```

设置文本区域的文本

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T15:04:56.633

`textarea`，就像其他`input`元素有一个`value`属性，所以你需要`val()`像这样使用：

```
$('#textarea_id').val(html_str); 
```

[**示例小提琴**](http://jsfiddle.net/RoryMcCrossan/vfjD6/)

# ruby-on-rails - 方法 <=> 和其他问题

> ID：14260780
> 
> 赞同：0
> 
> 时间：2013-01-10T15:00:20.213
> 
> 标签：ruby-on-rails, ruby

我刚开始在 Rails 上学习 Ruby。我目前正在做一个教程，但我也在尝试理解我的一位同事所做的代码。我在互联网上寻找答案，但没有找到任何回答我问题的答案。所以这是我的问题：

在此代码上：

```
class Post
  require 'date'
  include Comparable
  attr_accessor :post_number, :author, :date

  def initialize

  end

  def <=> (another_post)
    self.date <=> another_post.date
  end
end 
```

方法“<=>”是什么意思？它是 :post_number、:author 的副本和 :date 的更改吗？看来这个方法无论如何都行不通，但我只是想知道这个方法的含义。

第二个问题：我发现这段代码：a、b 和 c 具有适当的价值。

```
a = 0.1 * b if c? 
```

这有什么不同：

```
if c?
  a = 0.1 * b
end 
```

好吧，谢谢你的回答，我希望我的问题不要太愚蠢。问候， Bdloul

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:05:50.970

`<=>`是比较法。如果您执行了类似的操作`Post.all.sort`，该`sort`方法将查看是否`Post`定义了一种比较帖子对象的方法。否则，它将向上移动继承层次结构，直到找到对它们进行排序的方法。

`<=>`看起来很奇怪，但它只是`<`（一个对象小于另一个对象）、`=`（两个对象是否相等）和`>`（一个对象大于另一个对象）的组合。

因此，在您发布的代码中，作者正在创建一个方法来定义如何比较两个对象。特别是，他写道，它们的比较方式基于`.date`属性的比较方式。换句话说，2013 年 1 月 1 日开始的帖子将出现在 2013 年 1 月 2 日开始的帖子之前，依此类推。

至于下一部分，两段代码是相同的。在 Ruby 中，您可以在一行中编写多个条件。这些也都是等价的，只是举个例子：

```
# 1.
a = 1 unless a == 0
# or
unless a == 0
  a = 1
end

# 2.
a += 1 while a < 10
# or
while a < 10
  a += 1
end 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-10T15:06:03.230

`<=>`是比较运算符。请参阅[什么是 Ruby <=>（宇宙飞船）运算符？](https://stackoverflow.com/questions/827649/what-is-the-ruby-spaceship-operator)

`if`语句是等价的。

# c# - FIFO 队列导致 IIS 处理器达到 100% 的最大值

> ID：14260789
> 
> 赞同：3
> 
> 时间：2013-01-10T15:00:44.943
> 
> 标签：c#, multithreading, iis, queue, fifo

作为 Web 应用程序的一部分，我在 IIS 上有一个单例服务类（出于数据缓存原因，该服务是单例）。向服务发出请求的浏览器客户端可能会产生以下三种结果之一：

1）缓存中有数据并且数据没有过期（过时）——我们返回这个数据。非常快。2）缓存的数据过期了，但是另一个请求已经在查询数据库了。我们返回了缓存的数据。3）缓存数据过期，没有请求对数据库进行查询。该请求向前移动以进行查询。

但是，针对同名存储过程的数据库查询必须排队（要求）。

因此，我编写了这个队列类，旨在将这些查询排队并连续运行它们，而不是同时运行。这些队列类根据需要创建并存储在单例类的列表中。当请求移动到第 (3) 部分时，它会找到与其存储过程名称匹配的队列类，并将请求提交给队列类。然后它一直等到数据从数据库返回，以便它可以为 HTML 请求提供服务。

不幸的是，在使用此代码几个小时后，服务器进程的最大值为 100%。

我不确定改进它的最佳方法是什么，因为多线程编码不是我的专长。

队列类代码如下所示：

```
public ReportTable GetReportTable(ReportQuery query)
{
  lock (_queue)
  {
    _queue.Enqueue(query);
    Monitor.Pulse(_queue);
  }

  lock (_queue)
  {
    var firstQueryInQueue = _queue.Peek();
    while (_inUse || firstQueryInQueue == null || firstQueryInQueue.GetHashCode() != query.GetHashCode())
    {
      Monitor.Pulse(_queue);
      Monitor.Wait(_queue);
    }

    _inUse = true;
    firstQueryInQueue = _queue.Dequeue();
    var table = firstQueryInQueue.GetNewReportTable();
    _inUse = false;

    Monitor.Pulse(_queue);
    return table;
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T21:05:20.327

我不知道我是否理解问题，但你可以很简单地重写它

```
private object _lockObj=new object();
public ReportTable GetReportTable(ReportQuery query)
{
  lock(_lockObj){
    var table = query.GetNewReportTable();
    return table;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T00:39:56.233

所以这就是我所做的修复它。

```
public ReportTable GetReportTable(ReportQuery query)
{
  lock (_queue)
  {
    _queue.Enqueue(query);
    Monitor.Pulse(_queue);
  }

  lock (_queue)
  {
    var firstQueryInQueue = _queue.Peek();
    while (_inUse || firstQueryInQueue == null || firstQueryInQueue.GetHashCode() != query.GetHashCode())
    {
      Monitor.Wait(_queue);
    }

    _inUse = true;
    firstQueryInQueue = _queue.Dequeue();
    var table = firstQueryInQueue.GetNewReportTable();
    _inUse = false;

    Monitor.Pulse(_queue);
    return table;
  }
} 
```

它之前不起作用的原因是我对 Monitor.Wait() 和 Monitor.Pulse() 缺乏全面的了解。我在代码中的错误位置使用了 Pulse()。[幸运的是，这里](https://stackoverflow.com/questions/6327278/monitor-wait-condition-variable)有一个很好的答案，可以很好地描述 Wait() 和 Pulse()。

关键是在collection改变之后Pulse()，给后续排队的线程一个机会来测试条件，也就是：我的查询是不是队列中的第一个？其他人是否已经在进行查询？如果测试失败，线程会调用 Wait()，将其放入等待队列，并且不会占用处理器周期。当前面的执行查询的线程完成*时*，它将 _inUse 标志翻转为 false 并调用 Pulse()，唤醒下一个线程，以便它可以检查条件。

在实施了这个解决方案并观察了一天的任务管理器之后，我很高兴看到服务器上的负载在几个小时内保持在 1% 到 5% 之间，而 CPU 从未像以前那样爬升到 100%。

我已经对此进行了大量阅读，似乎 PulseAll() 在这种情况下可能是更好的调用，但到目前为止 Pulse() 正在工作，我们还没有遇到任何问题。

# flash-media-server - FMS视频文字聊天方法

> ID：14260794
> 
> 赞同：0
> 
> 时间：2013-01-10T15:00:47.547
> 
> 标签：flash-media-server, shared-objects

我是这里的新用户。我是 FMS 的新手。关于在实时视频聊天应用程序中从一个用户向另一个用户发送文本数据消息，我想问一个问题。我想使用带有 rtmfp 的 Flash Media Server 创建一个视频聊天应用程序。例如，我希望我的用户在一对一的私人聊天室中来回发送消息，而不是向群组中订阅的每个人发送数据。我正在考虑为此使用远程 ShardeObject，但是 SharedObjects 向所有成员广播消息，这不是我想要的。问题，您可以使用共享对象向特定客户端发送数据消息吗？或者，我是否真的应该考虑使用 NetStream.send 方法或 NetGroup 的 sendToNearest 方法？谢谢阿什利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T09:32:13.147

您可以使用不同的共享对象，每次两个用户之间有新聊天时创建一个新对象。

但另一种选择是使用`call()`您的`NetConnection`.

假设您在服务器上实现了一个方法“sendMessage()”，如下所示：

```
Client.prototype.sendMessage = function(clientID, message)
{
    for (var i = 0; i < application.clients.length; i++)
    {
        var client = application.clients[i];
        if (client.id === clientID)
        {
            client.call("handleMessage", null, message);
        }
    }
} 
```

然后，您可以在客户端执行此操作：

```
 connection.client = this;

[...]

public function sendMessage(message:String):void
{
    connection.call("sendMessage", null, clientID, message);
}

public function handleMessage(message:String):void
{
    // message sent from server
} 
```

# c# - 连接查询中的 LINQ 列表

> ID：14260800
> 
> 赞同：0
> 
> 时间：2013-01-10T15:00:59.683
> 
> 标签：c#, linq, join

我在使用 LINQ 时遇到问题，我想知道存储库中是否有针对此代码的快速解决方案

```
GetCompletePackQuestion(int id)
    {
        var query = from q in DbSet where q.id == id
                    join a in DbContext.Set<answers>() on id equals a.question_id
                    join cc in DbContext.Set<correct_answers>() on id equals cc.question_id
                    select new CompletePackModel
                    {
                        Id = q.id,
                        Question = q.question,
                        CorrectAnswer = cc.answers.id,
                        Answers = q.answers.Select(ans => ans.answer)
                    };

        return query.SingleOrDefault();
    } 
```

CompletePackModel 具有作为字符串列表的 Answers 属性。所以问题是：一个问题有很多答案，所以当 q.id 是一个 int 时，询问一个字符串，而 answer_id 是一个单一的 id（其实我应该使用字符串在连接到该 id 的表中）...最后一个 a.answer 应该是一个列表...

有没有办法解决这个问题？

谢谢

* * *

为什么它在查询中给我 3 个结果而不是一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:05:40.243

我假设您使用的是实体框架（基于我看到的 DbContext 对象）。在这种情况下，您的 Question 类应该已经有一个答案集合。然后，您需要执行以下操作：

```
select new CompletePackModel
{
  Id = q.id,
  Question = q.question,                            
  CorrectAnswer = from answ in DbContext.Set<answers>() where answ.id == a.id select answ.answer,
  Answers = q.answers.Select(a => a.answer).ToList()
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:09:06.390

这会奏效吗？

```
var query = from q in DbContext.Set<questions>()
                join a in DbContext.Set<answers>() on q.id equals a.question_id
                join cc in DbContext.Set<correct_answers>() on q.id equals cc.question_id
                select new CompletePackModel
                {
                    Id = q.id,
                    Question = q.question,                            
                    CorrectAnswer = cc.answer,
                    Answers = DbContext.Set<answers>().Where(answ => answ.question_id == q.id).ToList()
                }; 
```

# objective-c - 根据地理位置获取推送通知

> ID：14260802
> 
> 赞同：0
> 
> 时间：2013-01-10T15:01:03.113
> 
> 标签：objective-c

我想开始编写一个应用程序，用户在进入某个位置时会收到信息。应用程序运行时这没有问题。我想要的是，当应用程序未运行时，用户会收到推送通知。此通知仅应在他/她进入该特定位置时出现。

所以我的问题是：
如果手机进入特定地理区域，是否可以收到推送通知？
（应用程序没有运行/手机在口袋里）

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:06:34.223

有可能，看看这部分文档：http: [//developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html#//apple_ref/doc/uid /TP40009497-CH2-SW10](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/LocationAwarenessPG/CoreLocation/CoreLocation.html#//apple_ref/doc/uid/TP40009497-CH2-SW10)

编辑：实际上它不是推送通知，它更像是本地通知，当您输入某个地理位置时，系统会将您的应用从睡眠中唤醒。您还可以在后台运行您的应用程序，随时通过 gps 跟踪设备。但不建议使用这种方法，除非您出于某种原因确实需要它，例如说出方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:12:51.867

Urban Airship 允许根据地理区域发送推送通知。但是，如果您需要通知用户进入该区域，我认为您最好使用 Petar 的解决方案。

# objective-c - 使用 Objective-C 在 Xcode 中使用 RestKit 映射嵌套 ID

> ID：14260806
> 
> 赞同：0
> 
> 时间：2013-01-10T15:01:10.903
> 
> 标签：objective-c, core-data, restkit

我有一个 web 服务返回一个 JSON 格式的字符串，如下所示：

```
{"id":4,
 "name":"name",
 "image":1,
 "contacts":[2,3]
} 
```

联系人数组包含其他对象的主键的位置。我尝试以这种方式进行映射：

```
RKManagedObjectMapping* mapping = [RKManagedObjectMapping mappingForClass:[OETGroup class] inManagedObjectStore:[RKObjectManager sharedManager].objectStore];
[mapping mapKeyPath:@"id" toAttribute:@"identifiant"];
[mapping mapKeyPath:@"name" toAttribute:@"name"];
[mapping mapKeyPath:@"image" toAttribute:@"image"];
RKManagedObjectMapping* contactSimpleMapping = [RKManagedObjectMapping mappingForClass:[OETContact class] inManagedObjectStore:[RKObjectManager sharedManager].objectStore];
[contactSimpleMapping mapKeyPath:@"" toAttribute:@"identifiant"];

[mapping mapKeyPath:@"contacts" toRelationship:@"contacts" withMapping:contactSimpleMapping];
[mapping connectRelationship:@"contacts" withObjectForPrimaryKeyAttribute:@"contacts"];

[mapping setPrimaryKeyAttribute:@"identifiant"]; 
```

但是每次我运行这段代码时，我都会遇到这个异常：

```
this class is not key value coding-compliant for the key .' 
```

知道为什么吗？

# symfony - 如何通过路由名称获取路由的默认值

> ID：14260810
> 
> 赞同：0
> 
> 时间：2013-01-10T15:01:13.317
> 
> 标签：symfony

我有如下定义的路线。

```
home:
    pattern: /index/index/{show}
    defaults: { _controller: MyBundle:MyIndex:mypage, show: all }
    requirements:
        show:  activeonly|all
        name: ".+" 
```

我想在控制器中做的是， `$this->forward ('home', array('show', 'activeonly');`

我找不到任何可能的地方。环顾四周，我得到了以下问题和答案。

[Symfony 2：如何通过路由名称获取路由默认值？](https://stackoverflow.com/questions/9316222/symfony-2-how-to-get-route-defaults-by-route-name). 但是给出（接受）的解决方案不起作用。这是因为，默认值作为对象的私有值返回，无法读取。

很高兴知道，如果无论如何我可以通过名称读取路由的 _defaults 值并使用该值进行转发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:27:23.993

在您的控制器内部使用：

```
$defaults = $this->get('router')->getRouteCollection()->get('home')->getDefaults(); 
```

获取“home”路由的默认值。

不要通过它们的属性访问默认值，`_defaults` 而是使用 getter `Route::getDefaults()`。

请参阅[Symfony2 API：Symfony\Component\Routing\Route::getDefaults()](http://api.symfony.com/2.8/Symfony/Component/Routing/Route.html#method_getDefaults)

但正如名称“默认值”所述，您不必在使用该路由时指定它们，因为默认情况下会选择它们。因此，如果您想转发到您的`home`路线，只需使用：

```
$this->forward('MyBundle:MyIndex:mypage'); 
```

**编辑**

这真的很慢，因为`::getRouteCollection()`不使用任何缓存并且调用它会导致大量耗时的磁盘读取和路由编译。

我在[这里回答了另一种方法（Symfony 2: How to get route defaults by route name?）](https://stackoverflow.com/questions/9316222/symfony-2-how-to-get-route-defaults-by-route-name/44945939#44945939)。但请注意：据我所知，使用官方 Symfony API 仍然无法有效地做到这一点。如果你真的必须快速完成，你需要破解它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:27:36.053

您必须使用`forward`控制器名称，而不是路由。

例如：

如果你想要一个特定的值：

```
$this->forward ('MyBundle:MyIndex:mypage', array('show' =>'activeonly')); 
```

如果你想要默认值：

```
$this->forward('MyBundle:MyIndex:mypage'); 
```

如果要使用路由，请`redirect`改用。

```
$this->redirect($this->generateUrl('home')); 
```

[这里](http://symfony.com/doc/master/book/controller.html#redirecting)有一些信息

# mfc - 捕获和重定向 ON_UPDATE_COMMAND_UI 消息

> ID：14260814
> 
> 赞同：1
> 
> 时间：2013-01-10T15:01:22.333
> 
> 标签：mfc, message-map

我在（父）中有`CMDIChildWnd`一个（子）。也有发送到它的子视图的工具栏。到目前为止有效。现在，只要激活（例如单击它），消息就会到达，而不是父。`CReportView``CFormView``CMDIChildWnd``ON_UPDATE_COMMAND_UI``CReportView``ON_UPDATE_COMMAND_UI``CReportView``CFormView`

我现在要做的是`ON_UPDATE_COMMAND_UI`在子视图中捕获消息并以某种方式将它们中继到父视图。我尝试覆盖该`CWnd::PreTranslateMessage()`方法并调用父视图的`SendMessage()`方法，但`ON_UPDATE_COMMAND_UI`没有到达那里。

我还尝试了以下

```
BEGIN_MESSAGE_MAP(CUntisSimpleGrid, CReportView)
    ON_MESSAGE(WM_IDLEUPDATECMDUI, OnIdleUpdate)
END_MESSAGE_MAP()

LRESULT CUntisSimpleGrid::OnIdleUpdate(WPARAM wParam, LPARAM lParam)
{
    CWnd *pParentView = GetParent();
    UpdateDialogControls(pParentView, FALSE);
    return 0L;
} 
```

但这也没有用。有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T07:48:23.387

我已经通过覆盖`OnCmdMsg`. `CMDIChildWnd`现在，在尝试以通常的方式发送消息之后，`CMDIChildWnd`还尝试将消息发送到其非活动视图并在其中一个处理消息后停止。

```
BOOL CShowLessonsChildFrame::OnCmdMsg(UINT nID, int nCode, void* pExtra, AFX_CMDHANDLERINFO* pHandlerInfo)
{
    CPushRoutingFrame push(this);

    // pump through current view FIRST
    CView* pView = GetActiveView();
    if (pView != NULL && pView->OnCmdMsg(nID, nCode, pExtra, pHandlerInfo))
        return TRUE;

    // then pump through frame
    if (CWnd::OnCmdMsg(nID, nCode, pExtra, pHandlerInfo))
        return TRUE;

    // last but not least, pump through app
    CWinApp* pApp = AfxGetApp();
    if (pApp != NULL && pApp->OnCmdMsg(nID, nCode, pExtra, pHandlerInfo))
        return TRUE;

    // Now try to dispatch the message to inactive windows and see if
    // one of them handles the message
    for(UINT id = AFX_IDW_PANE_FIRST; id <= AFX_IDW_PANE_LAST; id++)
    {
        CWnd *pWnd = GetDescendantWindow(id, TRUE);
        if(pWnd && pWnd != GetActiveView()
            && pWnd->OnCmdMsg(nID, nCode, pExtra, pHandlerInfo))
        return TRUE;
    }

    return FALSE;
} 
```

# android - android javascript在第一次加载时不起作用

> ID：14260817
> 
> 赞同：-1
> 
> 时间：2013-01-10T15:01:36.530
> 
> 标签：android, android-asynctask

我正在向 webview 添加内容，然后在页面上运行一些 javascript。该脚本确实有效，但在我第一次加载 webview 时它不起作用。如果我第一次在应用程序中加载 webview，它不会改变内容。我第二次加载 web 视图（即返回然后单击相同的列表项），javascript 将工作并为我更改内容。

这是我的设置，在第一次加载时不起作用但在第二次加载时起作用的 javascript 在 AsyncTask 的 onPostExecute 中

**在 onCreateView**

```
WebSettings webSettings = mWebView.getSettings();

webSettings.setJavaScriptEnabled(true);
mWebView.setWebViewClient(new WebViewFragmentClient());
mMainLayout.setBackgroundColor(MainActivity.mSettings.isNightMode() ? Color.DKGRAY : Color.WHITE); 
```

**WebViewClient 捕获页面加载完成，然后运行 ​​JS 并显示视图**

```
private class WebViewFragmentClient extends WebViewClient {

    @Override
    public void onPageFinished(WebView view, String url) {
        // Page is loaded update the contents textsize and mode and set it visible
        view.loadUrl(String.format("javascript:(document.body.className = '%s');", MainActivity.mSettings.isNightMode() ? "night" : "day"));
        view.loadUrl(String.format("javascript:(document.body.style.fontSize ='%spt');", MainActivity.mSettings.getTextSize()));
        view.setVisibility(View.VISIBLE);

        super.onPageFinished(view, url);
    }

    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {         
        return mCallBack.pageLinkSelected(url);
    }
} 
```

**数据的异步加载**

```
private class AsyncLoadContent extends AsyncTask<Void, Void, Void> {
    String mContent;

    @Override
    protected void onPreExecute() {
        mWebView.setVisibility(View.INVISIBLE);
        super.onPreExecute();
    }

    @Override
    protected Void doInBackground(Void... params) {
        // Set the content of the page
        mContent = mCallBack.getContent();
        return null;
    }

    @Override
    protected void onPostExecute(Void result)
    {
        mWebView.loadDataWithBaseURL("file:///android_asset/", mContent, "text/html", "utf-8", null);
    }
} 
```

谢谢， 曼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:12:16.327

不要使用 AsyncTask，WebView 自己处理页面加载。loadDataWithBaseURL 是异步方法并立即返回。使用[WebViewClient](https://stackoverflow.com/questions/3149216/how-to-listen-for-a-webview-finishing-loading-a-url-in-android)监听页面加载完成。

# css - 另一个 div 对齐问题

> ID：14260819
> 
> 赞同：0
> 
> 时间：2013-01-10T15:01:42.910
> 
> 标签：css, html, css-float, alignment, floating

我刚刚在这里发布了一个关于 div 对齐的问题。我最初的问题得到了回答，但现在我又遇到了另一个问题。链接到我正在尝试做的事情：[单击此处查看图像](http://testnow.us/divimages)（单击链接无害）顺便说一句，这不是家庭作业。链接上的顶部图像（我在 Fireworks 中创建的东西）是我第一次尝试做的布局（我解决了这个问题），但现在我正在尝试添加一个站点名称 div，正如你在第二张图片中看到的那样，它正在使用正确的 div 创建问题。

昨天和今天，我真的不在比赛中，犯了这些简单的愚蠢错误。我只需要另一双眼睛来看看我的问题是什么。谢谢。

CSS：

```
#header {
width:750px;
height:341px;
margin-left:25px;
display:block;
}
#tableleft {
float: left;
width: 128px;
margin-left:10px;
margin-right: 5px;
margin-top:10px;
}
#Sitename {
text-align: center;
white-space: normal;
display: table;
float: left;
width: 400px;
height:40px;
margin-top:10px;
margin-left:25px;
font-family: Verdana, Arial, Helvetica, sans-serif;
font-size: 20px;

}
#tablecenter {
margin-left:20px;
float: left;
width: 410px;
margin-bottom:5px;
margin-top:30px;
}
#tableright {
float: right;
width: 128px;
margin-left: 20x;
margin-right:10px;
margin-top:10px;
margin-bottom:5px;
} 
```

HTML：

```
<div id="header">
  <div id="tableleft">
    <div align="center">
      <p><img src="images/SmWhitepic.jpg" width="118" height="87" /></p>
      <p>&nbsp;</p>
      <p><img src="images/SmWhitepic.jpg" width="118" height="87" /></p>
      <p>&nbsp;</p>
      <p><img src="images/SmWhitepic.jpg" width="118" height="87" /></p>
    </div>
  </div>
  <div id="Sitename">Content for  id "Sitename" Goes Here</div>

  <div id="tablecenter">
    <h1><img src="images/LgWhitepic.jpg" width="410" height="242" /></h1>
  </div>
  <div id="tableright">
    <p align="center"><img src="images/SmWhitepic.jpg" alt="" width="118" height="87"  /></p>
    <p>&nbsp;</p>
    <p align="center"><img src="images/SmWhitepic.jpg" alt="" width="118" height="87" /></p>
    <p>&nbsp;</p>
    <p align="center"><img src="images/SmWhitepic.jpg" alt="" width="118" height="87" /></p>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:11:52.903

您可以嵌套`<div id="Sitename">Content for id "Sitename" Goes Here</div>`在`<div id="tablecenter">`其中但删除`float: left;`并让它`display: block;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:14:21.460

因为`<div id="tableright">`是之后`<div id="tablecenter">`它从顶部的相同位置开始。像瀑布一样。切换它们。

# r - “解释器可读”打印（在 R 中）

> ID：14260826
> 
> 赞同：4
> 
> 时间：2013-01-10T15:01:55.877
> 
> 标签：r, printing

我想知道是否有一种方法可以以“解释器可读”的方式打印对象，它会执行如下所示的操作：

```
> x <- c(1:5,8)
> print.ir(x)
 c(1,2,3,4,5,8)
> x <- matrix(1:4, ncol=2)
> print.ir(x)
 matrix(c(1,2,3,4), ncol=2, nrow=2) 
```

这样可以将结果复制粘贴到 R 脚本或另一个 R 会话中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T15:04:18.600

用于`dput()`此：

```
x <- c(1:5,8)
dput(x)
c(1, 2, 3, 4, 5, 8)

x <- matrix(1:4, ncol=2)
dput(x)
structure(1:4, .Dim = c(2L, 2L)) 
```

试试看：

```
z <- structure(1:4, .Dim = c(2L, 2L))
z
     [,1] [,2]
[1,]    1    3
[2,]    2    4 
```

# objective-c - 如何将 UIView 动画移动到背景？

> ID：14260832
> 
> 赞同：1
> 
> 时间：2013-01-10T15:02:15.047
> 
> 标签：objective-c, uiimageview

这个想法是在带有 4 或 5 条链接的仪表板上旋转图像。链接的 uiview 正在工作，uiview 的动画正在工作，在我将动画添加到应用程序之前，一切都很好，动画的图层在后面。现在，当我添加图像旋转的代码时，它会将动画图像放在其他图层的顶部，而不是留在后面。

我的 viewcontroller.m 文件中有这个代码设置，它按预期工作。虽然我遇到的问题是 UIView 被绘制在其他人之上，即使它在底部

// 在破折号上旋转图像

```
 UIImageView *rotateImage = (UIImageView *)[self.view viewWithTag:88];
    rotateImage.animationImages = [NSArray arrayWithObjects:
                                   [UIImage imageNamed:@"c3_1.jpg"],
                                   [UIImage imageNamed:@"c3_5.jpg"],
                                   [UIImage imageNamed:@"c3_7.jpg"],
                                   [UIImage imageNamed:@"c3_8.jpg"],
                                   [UIImage imageNamed:@"c3_10.jpg"], nil];

    // all frames will execute in 1.75 seconds
    rotateImage.animationDuration = 10.75;
    // repeat the annimation forever
    rotateImage.animationRepeatCount = 0;
    // start animating
    [rotateImage startAnimating];
    // add the animation view to the main window
    [self.view addSubview:rotateImage]; 
```

**对于那些有这个问题的人来说很容易解决.. :)

大声笑..它正盯着我的脸..

在最后添加子视图是将其放在堆栈的顶部。删除了那条线，它现在可以正常工作了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T14:10:10.410

它正盯着我的脸。在最后添加子视图是将其放在堆栈的顶部。

所以我将其添加为下一行。

[self.view sendSubviewToBack:rotateImage];

# inno-setup - 我想自动将输入查询设置为 mac 地址，并且对于 inno 设置密钥生成器脚本不可编辑

> ID：14260833
> 
> 赞同：0
> 
> 时间：2013-01-10T15:02:17.237
> 
> 标签：inno-setup

这是我的 inno 设置脚本（inno 设置密钥生成器脚本）

我想自动设置输入查询到*mac地址和私钥*并且不可编辑。

inno 安装密钥生成器下载 (sample2.iky, ISID.dll)

www.mjfreelancing.com/index.php?option=com_content&view=article&id=11&Itemid=13

inno 安装程序下载

www.jrsoftware.org/isdl.php

![图片1](../Images/6cd22d52dba9c06009f887c801a81730.png) [http://i49.tinypic.com/nbodif.jpg](http://i49.tinypic.com/nbodif.jpg)

[![图2](../Images/d06401470b82efa09f7ddd6173be1f15.png)](https://i.stack.imgur.com/Btb9p.jpg) [http://i49.tinypic.com/22iaub.jpg](http://i49.tinypic.com/22iaub.jpg)

对不起我的英语不好

请帮帮我

谢谢

* * *

```
 [_ISTool]
EnableISX=true
Use7zip=false

[Files]
Source: sample2.iky; DestDir: {tmp}; Flags: ignoreversion

Source: ISID.dll; DestDir: {sys}\ISID; Flags: ignoreversion

[Setup]
AppName=Inno Key Generator2
AppVerName=Inno Key Generator 1.0.2.1 2
DefaultDirName={pf}\MJ Freelancing\IKG
InfoBeforeFile=readme.txt
DefaultGroupName=Inno Key Generator
OutputDir=output
AppCopyright=Copyright © Oct 2002 - 2006 MJ Freelancing
OutputBaseFilename=IKGSetup

[ThirdParty]
CompileLogMethod=append

[Code]

function ValidateSerialNumber(InnoKeyFile, User, Orgn, ProdCode, HDD, MAC, PrivateKey, Serial: AnsiString): Boolean;
external 'ValidateSerialNumber@files:ISID.dll stdcall';
function GetMACAddress(output: AnsiString): Boolean;
external 'GetMACAddress@files:ISID.dll stdcall'; 

var
    UserPage: TInputQueryWizardPage;
    UserValues: TArrayOfString;

procedure InitializeWizard();
begin

    { create the custom page }
    UserPage := CreateInputQueryPage(wpInfoBefore,      //wpWelcome,
        'Enter Registration Details', 'You need to be a registered user to be able to proceed',
        'Enter your registration details exactly (case sensitive), then click Next.');

    UserPage.Add('MAC Address:', true);
    UserPage.Add('Unlock Code:', False);
    UserPage.Add('Private Key:', False);

    { Set default values }
    SetArrayLength(UserValues, 3);
    RegQueryStringValue(HKLM, 'Software\Microsoft\Windows\Hitman', 'Hitman', UserValues[0]);
    RegQueryStringValue(HKLM, 'Software\Microsoft\Windows\Hitman', 'Hitman', UserValues[1]);
    if (UserValues[0] = '') and (UserValues[1] = '') then begin
        RegQueryStringValue(HKCU, 'Software\Microsoft\ND\User2', 'md', UserValues[0]);
        RegQueryStringValue(HKCU, 'Software\Microsoft\ND\User2', 'MD2', UserValues[1]);
    end;

    { Try to find the settings that were stored last time (also see below). }
    UserPage.Values[0] := GetPreviousData('MAC', UserValues[0]);
    UserPage.Values[1] := GetPreviousData('Unlock', UserValues[1]);
    UserPage.Values[2] := GetPreviousData('Private', UserValues[2]);

end;

procedure RegisterPreviousData(PreviousDataKey: Integer);
begin
  { Store the settings so we can restore them next time }

  SetPreviousData(PreviousDataKey, 'MAC', UserPage.Values[0]);
  SetPreviousData(PreviousDataKey, 'Unlock', UserPage.Values[1]);
  SetPreviousData(PreviousDataKey, 'Private', UserPage.Values[2]);

end;

function ScriptDlgPages(CurPage: Integer; BackClicked: Boolean): Boolean;
var
    ExpPath: String;

begin

    Result := True;

    if (CurPage = UserPage.ID) then
    begin
        ExtractTemporaryFile('sample2.iky');        { the public key file }

        ExpPath := ExpandConstant('{tmp}\sample2.iky');

        Result := False;

        UserValues[0] := UserPage.Values[0];
        UserValues[1] := UserPage.Values[1];
        UserValues[2] := UserPage.Values[2];

        if (UserValues[0] = '') or (UserValues[1] = '') or (UserValues[2] = '') then
            MsgBox('No fields can be blank !', mbError, MB_OK)
        else
        begin

        //UserPage.Values[0] := GetPreviousData('MAC', UserValues[0]);
        //UserPage.Values[1] := GetPreviousData('Unlock', UserValues[1]);
        //UserPage.Values[2] := GetPreviousData('Private', UserValues[2]);

    //function ValidateSerialNumber(InnoKeyFile, User,           Orgn,    PCe,HDD,MAC,PrivateKey, Serial: AnsiString): Boolean;
            Result := ValidateSerialNumber( ExpPath,'','','','',UserValues[0],UserValues[2],UserValues[1] );

if (not Result) then
                MsgBox('Invalid Entry !', mbError, MB_OK);

        end
    end

end;

function NextButtonClick(CurPage: Integer): Boolean;
begin
  Result := ScriptDlgPages(CurPage, False);
end;

function BackButtonClick(CurPage: Integer): Boolean;
begin
  Result := True;//ScriptDlgPages(CurPage, True);
end;

function HasHtmlHelp(): Boolean;
begin
    { HHCTRL.OCX GUID }
    Result := RegValueExists(HKCR, 'CLSID\{4662DAB0-D393-11D0-9A56-00C04FB68B66}\InprocServer32', '');
end;

function HasNoHtmlHelp(): Boolean;
begin
    Result := not HasHtmlHelp;
end; 
```

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T05:52:03.020

要使编辑框不可编辑，只需使用它们的属性 ReadOnly。

您已经创建了 3 个编辑框（TPPasswordEdit 类），所以现在只需将它们的 ReadOnly 设置为 true：

```
UserPage.Values[0].ReadOnly := True;
UserPage.Values[1].ReadOnly := True;
UserPage.Values[2].ReadOnly := True; 
```

将此代码放在过程 InitializeWizard() 的末尾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-06T12:55:00.253

```
function GetMacAddress(output:string): Integer;
external 'GetMACAddress@files:ISID.dll stdcall'; 
```

//在它创建这个函数之后

```
function GetMacAdd(Output: string): string;
var
ClassName: String;
Ret: Integer;
begin
SetLength(ClassName, 256); 
Ret := GetMacAddress(PChar(ClassName)); 
Result := Copy(ClassName, 1 , Ret);
end; 
```

//并调用它

```
UserPage.Values[0]:=(GetMACAdd('')); 
```

希望能帮助到你。

# xpages - Jquery 中的 sessionScope

> ID：14260842
> 
> 赞同：1
> 
> 时间：2013-01-10T15:02:39.137
> 
> 标签：xpages

我有一个具有以下内容的面板：

```
<xp:panel  disableTheme="true">
        <div id="mypdfdoc">
        </div>

        <script>
            $(document).ready(function(){
            $('#mypdfdoc').PDFDoc( { source : 'pdftest.pdf' } );
            });
        </script>
</xp:panel> 
```

在这种情况下，源文件名是 pdftest.pdf。在此示例中，如何将存储在 sessionScope 中的值用作源文件名？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T15:12:20.440

如果将脚本块更改为输出脚本块，则可以使用内联 SSJS 代码，如下所示：

```
<xp:scriptBlock id="scriptBlock1">
   <xp:this.value>
      <![CDATA[
         $(document).ready(function(){
            $('#mypdfdoc').PDFDoc(
               { source : '#{javascript:return sessionScope.PDFName}' } 
            );
         });
      ]]>
   </xp:this.value>
</xp:scriptBlock> 
```

**编辑：**

这可以用于任何 CSJS，而不仅仅是 jQuery。

# javascript - 优化脚本模板

> ID：14260843
> 
> 赞同：0
> 
> 时间：2013-01-10T15:02:41.513
> 
> 标签：javascript, jquery, templates, jquery-mobile, mustache

我正在使用脚本模板在 javascript 中创建可重复使用的 html 标记。模板使用 mustache 将标签替换为正确的值。然后由 JQUery Mobile 呈现并再次呈现 html。一个片段如下所示：

```
<!doctype html>
            <html>
                <head>
                    <meta charset="UTF-8" />
                    <title>jQuery Mobile</title>
                    <meta name="viewport" content="width=device-width, initial-scale=1"> 
                    <meta charset="utf-8" http-equiv="X-UA-Compatible" content="IE=9" />

                </head>
                <body>
                    <!-- Page Templates -->

<script id="page_header_tpl" type="text/template">
<div data-role="header" class="toolbar {{#class}}{{{class}}}{{/class}}" {{#id}}id="{{{id}}}" {{/id}}>
<h1>{{{title}}}</h1>
<div data-role="ui-bar" class="ui-bar" id="ui-top">
{{#buttons}}
        {{{.}}}
{{/buttons}}
</div><!-- /navbar -->

{{#navbar}}
    {{{navbar}}}
{{/navbar}}
</div>
</script>
<script type="text/javascript">
//Function for creating the header
function createPageHeader(data) {
      html = $('#page_header_tpl').html();
    return Mustache.render(html, data);
}
 //Calling the function
 var header = createPageHeader({ class : 'aheader', id : 'my id',  title : 'Page 1'});
<script>
</body>
</html> 
```

我的问题是我可以使用什么样的技术来优化模板元素的调用和放置到 html 文件中？快速检索元素？用 Mustache 更快地解析？记忆技巧？ETC

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T15:33:13.353

您最好的选择可能是在客户端上使用[Handlebars](http://handlebarsjs.com/)。它与 Mustache 完全兼容，并提供了一种[提前编译模板以](http://handlebarsjs.com/precompilation.html)获得更好性能的方法。

它还添加了一堆额外的帮助器，但如果您想保持模板与 Mustache 严格兼容（例如在服务器端使用），则不必使用这些帮助器。

不仅如此，它还提供了用于已编译模板[的库的剥离版本（Handlebars 运行时） 。](https://github.com/wycats/handlebars.js/downloads)

可以在此处找到包含更多有用链接的比较文章 - [http://nimbupani.com/mustache.html](http://nimbupani.com/mustache.html)

# java - 在字符串问题中存储 XPath 查询 xml

> ID：14260846
> 
> 赞同：0
> 
> 时间：2013-01-10T15:02:53.957
> 
> 标签：java, xml, dom, xpath

我在存储使用 DOM 构建并使用 xpath 查询的字符串时遇到问题。这是我在代码[Google](https://developers.google.com/maps/documentation/webservices/index#ParsingXML)和[Sample中使用的一些参考](http://gmaps-samples.googlecode.com/svn/trunk/geocoder/java/SimpleParser.java)

```
public static String getRoute() throws Exception {
    String xPathString = "//text() ";
    String nodeString = "";
    String notags = null;

    XPathFactory factory = XPathFactory.newInstance();

    XPath xpath = factory.newXPath();

//URL and HTTP connection here

InputStream inputXml = connection.getInputStream();
            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
            DocumentBuilder db = dbf.newDocumentBuilder();
            Document doc = db.parse(inputXml);

            NodeList nodes = (NodeList) xpath.evaluate(xPathString, doc, XPathConstants.NODESET);

            for (int i = 0, n = nodes.getLength(); i < n; i++) {

                nodeString = nodes.item(i).getTextContent();
                notags = nodeString.replaceAll("<[^>]*>", "");
                System.out.print(notags + "\n");

            } 
        } catch (XPathExpressionException ex) {
            System.out.print("XPath Error");
        }

        return notags; 
```

该代码似乎`System.out.print(notags + "\n");`在 try 和 catch 块中打印出来，但是当我尝试获取该方法并使用以下方法进行系统打印输出时：

```
public static void main (String[] args) {
     try {
      System.out.println(getRoute());  
    } catch (Exception e) {
        System.out.println(e);
    }
 } 
```

我只能得到输出的**最后一行**而不是整个字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:14:32.863

正如我所怀疑的，在这一行中：

```
notags = nodeString.replaceAll("<[^>]*>", ""); 
```

`notags`您在循环的每次迭代中都完全覆盖。你需要这样做：

```
notags += nodeString.replaceAll("<[^>]*>", ""); 
```

要在每行之间添加换行符，您可以这样做：

```
notags += nodeString.replaceAll("<[^>]*>", "") + "\n"; 
```

为了使其中任何一个起作用，您还需要更改此设置：

```
String notags = null; 
```

对此：

```
String notags = ""; 
```

您确定 replaceAll() 是必要的吗？我希望 nodeString 已经没有任何`<`s 或`>`s，因为您正在选择文本节点。

# mysql - MySQL 中的幸运数字 - 每隔 n 行删除一次

> ID：14260849
> 
> 赞同：3
> 
> 时间：2013-01-10T15:03:03.427
> 
> 标签：mysql, counting

我正在尝试在 MySQL 中为一个娱乐性数学问题重新创建一个非常大的幸运数字。

该规则本质上是“查看数字列表中的第 n 个数字，然后删除它之后的每个第 n 个实例。

最简单的例子是自然数列表中的第二个数字“2”。所以我们将删除 2 然后 4 然后 6 然后 8 等等。然后您将查看下一个数字“3”并删除第 3、第 6、第 9 个术语。有趣的部分来自于您将这些数字从数字列表中完全删除，因此它与普通数学非常不同。“3”之后的下一个数字是“7”，因为您已经删除了 4、5 和 6，因此您可以考虑删除每七个条目。

这本质上只是计数，而不是真正的数学——我可以在 PHP 和 MySQL 中一起做得很好。我面临的问题是，您必须一次性从数据库中获取整个数组，而当您达到数亿时，一台普通计算机就无法处理内存方面的问题。这个问题只需要在 SQL 中完成，程序之间没有数据传输。

有关 Lucky Numbers 的更多信息：[http](http://en.wikipedia.org/wiki/Lucky_number) ://en.wikipedia.org/wiki/Lucky_number比我上面解释的要好得多。

我有一个高达 1,000,000,000 (8 GB) 的奇数数据库（即每第二个学期就删除一次）。我可以很高兴地在 PHP 中获得下一个要使用的数字（称为 x）：

```
SELECT * FROM table ORDER BY ID LIMIT n,1 
```

使用 do-while 循环从 n = 3-1,000,000,000 计数（实际上，由于删除了很多数字，n 的上限可能会变为 150,000,000 左右）但每次（在循环期间）它都需要询问数据库删除每个第 x 个数字。

这是我必须从另一个 stackoverflow 问题中选择每个第 x 个数字的代码：

```
SELECT * 
FROM ( 
    SELECT 
        @row := @row +1 AS rownum, [column name] 
    FROM ( 
        SELECT @row :=0) r, [table name] 
    ) ranked 
WHERE rownum % [x] = 1 
```

我想我只需要它成为一个删除语句，但我真的很挣扎。我是一个 PHP 程序员，只有适度的 SQL 知识。通过这样做，我只会在 MySQL 和 PHP 之间传输**指令**，而不是大量数据。

但是，如果有人想全力以赴并在 MySQL 中编写循环（不仅仅是 delete 语句，我什至不知道它是否可能！）那么我会充分利用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T15:46:39.683

您可以使用`id`此查询中的 's 删除，使用[`IN()`](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_in)条件

```
SELECT * FROM [table name]
-- change this to DELETE FROM [table name] when you're confident
WHERE `id` IN (
    SELECT `id`
    -- * became `id` so that we can use it in IN() above
    FROM (
        SELECT @row := @row + 1 AS 'rownum', t.`id`
        FROM (SELECT @row :=0) r, (SELECT `id` FROM [table name] ORDER BY `id`) t
        -- I made it order first because it showed an
        -- unexpected ordering for a table I tried this on
    ) ranked
    WHERE `rownum` % [n] = 0
    -- and I changed 1 into 0 because that's what we actually need
) 
```

确保 select 语句在删除之前准确选择了您需要的内容。要检查您是否选择了正确的记录，您可以尝试以下操作。将 3 更改为您要使用的其他数字。另外，不要忘记更改`[table name]`为您的表的名称。

```
SELECT * FROM (
    SELECT @row := @row + 1 AS 'rownum', t.`id`
    FROM (SELECT @row :=0) r, (SELECT `id` FROM [table name] ORDER BY `id`) t
) ranked
WHERE `rownum` % 3 = 0 
```

# java - 为什么eclipse资源是“（未打开）”？

> ID：14260850
> 
> 赞同：3
> 
> 时间：2013-01-10T15:03:04.903
> 
> 标签：java, eclipse, eclipse-plugin

我在 Eclipse 工作区中有一个项目。

![在此处输入图像描述](../Images/4307ae84a683daeb583d40faa5a87281.png)

当我使用以下代码将此项目作为 IJavaProject 打开时，我的项目“未打开”。

```
IWorkspaceRoot root = ResourcesPlugin.getWorkspace().getRoot();
IProject orig = root.getProject(this.projectName);
orig.open(null /* IProgressMonitor */);
orig.refreshLocal(IResource.DEPTH_ZERO, null);
this.javaProject = JavaCore.create(orig); 
```

我用方法打开了 IProject ，并使用以下`open()`方法手动刷新，[避免“资源与文件系统不同步”](https://stackoverflow.com/questions/4343735/avoiding-resource-is-out-of-sync-with-the-filesystem)`refreshLocal`

![在此处输入图像描述](../Images/b14a5bf6a0e0aff838c503273c798015.png)

我还有其他资源没有打开。

![在此处输入图像描述](../Images/b3451d7c5669099f4bedd1bc05f162bf.png)

我尝试“F5”刷新项目，但它不起作用。

可能有什么问题？如何打开资源？

## 添加

我尝试使用 new NullProgressMonitor() 打开资源，但没有成功。

```
orig.open(new NullProgressMonitor());
orig.refreshLocal(IResource.DEPTH_INFINITE, new NullProgressMonitor()); 
```

## 添加2

通过这段使用 javaModel 的代码，我得到了工作区中所有项目都已关闭的信息。这是否意味着我的工作空间坏了？当我使用 Eclipse IDE 打开工作区时，我可以打开并编译 Java 代码。

```
IJavaModel javaModel = JavaCore.create(root);
this.javaProject = javaModel.getJavaProject(this.projectName); 
```

![在此处输入图像描述](../Images/b706b505d03d3a98f3284887fd11b76e.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T10:59:44.160

代码风格：

您应该尽可能避免使用“null”作为参数。这对于可读性（和可维护性）总是更好。在这里，API 设计者提供了实际的对象来表示“没有价值”：

```
orig.open(new NullProgressMonitor());
orig.refreshLocal(IResource.DEPTH_ZERO, new NullProgressMonitor()); 
```

问题 ：

我相信您的问题在于这些行中的第二行：您刷新了项目，但没有刷新它的任何成员。如果您尝试使用 INFINITE 深度以实际刷新所有包含的文件会怎样？

```
orig.open(new NullProgressMonitor());
orig.refreshLocal(IResource.DEPTH_INFINITE, new NullProgressMonitor()); 
```

更新 ：

实际上，资源的 toString 中的这个“（未打开）”不在工作区级别。您的 IProject 和 IFiles 已很好地打开和刷新（如果您的项目已经打开，您可能甚至不需要它）。

Java 模型与工作空间不同，没有被“打开”的 java 元素在工作空间级别没有任何意义，它只意味着没有在 java 元素的内容上打开缓冲区。您不必担心打开 java 元素，jdt 将在您操作其元素期间需要时完成工作。

您可能想要创建整个 java 模型，而不是只创建与项目相对应的模型：

```
IJavaModel javaModel = JavaCore.create(root);
this.javaProject = javaModel.getJavaProject(this.projectName); 
```

这可能会避免以后出现奇怪的错误:)。

# python - 如果我有第 2 行的内容，我想获得第 9 行的内容。怎么办？

> ID：14260855
> 
> 赞同：0
> 
> 时间：2013-01-10T15:03:20.880
> 
> 标签：python

我有文本文件：

```
[1]AAAAAA
[2]BBBBBB
[3]CCCCCC
[4]DDDDDD
[5]
[6]
[7]
[8]111111
[9]2222222
[10]333333
[11]4444444
[12]555555
[13]6666666 
```

如果我有第 2 行的内容，我想获得第 9 行的内容。怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T15:06:32.313

将整个文件作为列表读入内存并直接对其进行索引。

```
with open("myfile") as data:
    lines = data.readlines()
lines[8] #9th line 
```

或者通过像对象一样迭代文件的每一行来计数到你想要的行。

```
with open("myfile") as data:
    for count, line in enumerate(data)
        if count == 8:
            print line
            break 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:16:39.340

```
with open('test.txt') as f:
    print [line.strip().split(']')[-1] for i,line in enumerate(f) if i in [1,8]] 
```

*出去：*

```
['BBBBBB', '2222222'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T15:10:03.550

你可以这样做 ：

```
print open("file.txt", "r").readlines()[8] 
```

# blackberry - 黑莓自动部署/测试

> ID：14260856
> 
> 赞同：3
> 
> 时间：2013-01-10T15:03:22.783
> 
> 标签：blackberry, automated-tests

我正在尝试自动部署到 BlackBerry 设备。我的总体目标是使用脚本将应用程序安装到 BlackBerry 设备、运行测试套件并最终下载日志文件。

我知道可以使用 ANT 脚本构建和安装，并且可以使用 javaloader 下载日志文件，但是我发现运行测试套件有问题。

有没有办法在设备上启动应用程序？或者至少发送输入事件？我认为 fledge 和 fledgecontroller 具有其中的一些功能，但我希望在物理设备上执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T06:18:57.980

我们有自己的自动化测试：

1.  自己的**j2meunit以****junit**格式产生输出
2.  运行它的附加应用程序
3.  **构建、启动**fledge**并等待测试完成的**ant任务****
***   CI ( **TeamCity** ) 将分析测试结果**

 **一些重要的细节：

1.  **fledge** SD 卡已安装到 pc 文件夹
2.  测试应用程序具有自动启动标志。所以我们不需要做任何事情来启动它
3.  测试应用程序通过 pc 上的文件标记与**ant任务通信：**

    *   started.test 文件在应用程序启动时创建
    *   当应用程序运行所有测试时，finished.test 文件被创建

这不是完美的解决方案，但它有效。您还了解这些测试的反馈时间以及所有开发人员如何反对支持这些测试。

幸运的是，我们正在使用更好的方法——我们尽可能在桌面上使用**junit测试。**如果代码有我们在编写自己的假类之前使用的 BlackBerry API 调用，最近我们尽可能多地使用**PowerMock 。**这有时也很困难，但它几乎一直在工作。

当然，这些测试不包括功能测试，例如`SocketConnection`不同参数的可靠性、数据库迁移、与服务器的集成测试。但我们发现 sim 在这些领域通常不能作为真实设备使用。在比较真实设备上的一组不同行为方面非常理想。所以我们只在 sim 中运行用于与服务器通信的集成测试。不太多。

顺便说一句，我们在 BB 上放弃了**SQLite** DB 并转向持久存储，因为它非常慢并且将所有设备挂在 5 个 OS 旧设备上（有时对于新设备也是大麻烦）。

我向您致以热烈的问候 - 以自动化方式测试应用程序的 BlackBerry 开发人员。这样的人才不多**

# wpf - 查询 Dispatcher 队列长度

> ID：14260857
> 
> 赞同：7
> 
> 时间：2013-01-10T15:03:26.173
> 
> 标签：wpf

我正在尝试分析 UI 线程的使用情况。是否可以查询调度程序排队的项目数？

**更新**：克莱门斯的回答完美无缺，但是因为我想在 UI 启动后开始它，而且我只关心每秒对数据进行一次采样，所以我使用以下代码......

```
 int queueLength = 0;
        var currentDispatcher = Dispatcher.CurrentDispatcher;
        currentDispatcher.Hooks.OperationPosted += (s, e) => Interlocked.Increment(ref queueLength);
        currentDispatcher.Hooks.OperationCompleted += (s, e) => Interlocked.Decrement(ref queueLength);
        currentDispatcher.Hooks.OperationAborted += (s, e) => Interlocked.Decrement(ref queueLength);
        Observable
            .Interval(TimeSpan.FromSeconds(1))
            .Subscribe(x =>
                           {
                               int currentQueueLength = queueLength;
                               if (currentQueueLength < 0)
                               {
                                   Interlocked.Add(ref queueLength, currentQueueLength * -1);
                               }
                               UiQueueLength = queueLength;
                           }); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-10T15:25:40.287

Afaik 没有可以直接询问调度程序队列长度的属性或方法。[但是，您可以将处理程序附加到Hooks](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.hooks.aspx)属性提供的某些[DispatcherHooks](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherhooks.aspx)事件。

```
var queueLength = 0;
Dispatcher.Hooks.OperationPosted += (o, e) => Interlocked.Increment(ref queueLength);
Dispatcher.Hooks.OperationStarted += (o, e) => Interlocked.Decrement(ref queueLength);
Dispatcher.Hooks.OperationAborted += (o, e) => Interlocked.Decrement(ref queueLength); 
```

* * *

如果您只对 Dispatcher 是否处于活动状态感兴趣，您可能只需将[OperationPosted](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherhooks.operationposted.aspx)事件与[DispatcherInactive](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherhooks.dispatcherinactive.aspx)一起处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-06T22:58:24.447

l感谢以上，这里有一个类来完成这项工作：

```
/*
 This is for when you want to know the depth of the Dispatcher Queue an perhaps modifiy the behaviour of
 code to minimize impact like when data is comming into a TextBox faster that it can cope with.

 Usage:
 in MainWindow
 public DispatcherQueueLength dispatcherQueueLengthHelper;
 dispatcherQueueLengthHelper = new DispatcherQueueLength(App.Current.Dispatcher);
 dispatcherQueueLengthHelper.StartDispatcherHooks();
 in Loaded
 dispatcherQueueLengthHelper.StartUpdateTimer(new TimeSpan(0,0,0,1,0), DispatcherPriority.Send, () =>
    {
          App.mainVM.LblQueueCountContent = "UI Queue Count ~ " + dispatcherQueueLengthHelper.GetQueueLength.ToString("N0");
    });
 in Closing
 dispatcherQueueLengthHelper.EndDispatcherHooks();
 dispatcherQueueLengthHelper.EndUpdateTimer();
*/

public class DispatcherQueueLength
{
    private static int _queueLenth = 0;
    private Dispatcher _dispatcher = null;
    private DispatcherTimer _dispatcherTimer = null;

    /// <summary>
    /// Usually pass in App.Current.Dispatcher
    /// </summary>
    /// <param name="passedDispatcher"></param>
    public DispatcherQueueLength(Dispatcher passedDispatcher)
    {
        _dispatcher = passedDispatcher;

    }

    /// <summary>
    /// Call as needed. It is possible to have a negative number like when pending Dispatches exist
    /// when starting the class, they are zeroed out.
    /// </summary>
    public int GetQueueLength
    {
        get 
        {
            int currentQueueLength = _queueLenth;
            if (currentQueueLength < 0)
            {
                Interlocked.Add(ref _queueLenth, currentQueueLength * -1); //this zeros it
            }

            return currentQueueLength;
        }
    }

    /// <summary>
    /// Call directly after instantiating the class
    /// </summary>
    public void StartDispatcherHooks()
    {
        if (_dispatcher != null)
        {
            _dispatcher.Hooks.OperationPosted += (s, e) =>
            {
                Interlocked.Increment(ref _queueLenth);
                Debug.WriteLine("Queue Length: " + _queueLenth.ToString());
            };
            _dispatcher.Hooks.OperationCompleted += (s, e) =>
            {
                Interlocked.Decrement(ref _queueLenth);
            };
            _dispatcher.Hooks.OperationAborted += (s, e) =>
            {
                Interlocked.Decrement(ref _queueLenth);
            };
        }
    }

    /// <summary>
    /// You pass in the code you want run on each interval
    /// </summary>
    /// <param name="ts"></param>
    /// <param name="priority"></param>
    /// <param name="action"></param>
    public void StartUpdateTimer(TimeSpan ts, DispatcherPriority priority, Action action)
    {
        if(_dispatcherTimer == null)
        {
            _dispatcherTimer = new DispatcherTimer(priority);
            _dispatcherTimer.Tick += (s,e) => { action(); };
            _dispatcherTimer.Interval = ts;
            _dispatcherTimer.IsEnabled = true;
        }

    }

    /// <summary>
    /// Call in MainWindow Closing
    /// </summary>
    public void EndDispatcherHooks()
    {
        if(_dispatcher != null)
        {
            _dispatcher.Hooks.OperationPosted -= (s, e) => Interlocked.Increment(ref _queueLenth);
            _dispatcher.Hooks.OperationCompleted -= (s, e) => Interlocked.Decrement(ref _queueLenth);
            _dispatcher.Hooks.OperationAborted -= (s, e) => Interlocked.Decrement(ref _queueLenth);
        }

    }

    //Call in MainWindow Closing or if no longer needed
    public void EndUpdateTimer()
    {
        _dispatcherTimer.Stop();
        _dispatcher = null;

    }

} 
```

# sql - 在一个查询中对多个表进行多个左连接

> ID：14260860
> 
> 赞同：34
> 
> 时间：2013-01-10T15:03:31.707
> 
> 标签：sql, postgresql, join, left-join, multiple-tables

我有一张`master`表，其中存储了多个级别的项目，父母和孩子，还有第二张表可能有也可能没有额外的数据。我需要从我的主表中查询两个级别并在我的第二个表上进行左连接，但是由于我的查询中的排序，这将不起作用。

```
SELECT something FROM master as parent, master as child
  LEFT JOIN second as parentdata ON parent.secondary_id = parentdata.id
  LEFT JOIN second as childdata ON child.secondary_id = childdata.id
WHERE parent.id = child.parent_id AND parent.parent_id = 'rootID' 
```

左连接仅适用于 from 子句中的最后一个表，因此我只能使其适用于其中一个左连接。在上面的例子中，没有一个左连接会起作用，因为第一个左连接指向 from 子句中的第一个表，第二个永远不会像这样工作。

我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-01-10T15:15:10.013

这种查询应该可以工作 - 在用显式`JOIN`语法重写之后：

```
SELECT something
FROM   master      parent
JOIN   master      child ON child.parent_id = parent.id
LEFT   JOIN second parentdata ON parentdata.id = parent.secondary_id
LEFT   JOIN second childdata ON childdata.id = child.secondary_id
WHERE  parent.parent_id = 'rootID' 
```

这里的绊脚石是`JOIN`在“旧式”之前`CROSS JOIN`用逗号（**`,`**）显式绑定。[我在这里引用手册：](https://www.postgresql.org/docs/current/sql-select.html#SQL-FROM)

> 在任何情况下`JOIN`，它的绑定都比分隔 `FROM`-list 项的逗号更紧密。

在重写第一个之后，所有连接都是从左到右应用的（逻辑上 - Postgres 可以自由地重新排列查询计划中的表）并且它可以工作。

只是为了说明我的观点，这也可以：

```
SELECT something
FROM   master parent
LEFT   JOIN second parentdata ON parentdata.id = parent.secondary_id
,      master child
LEFT   JOIN second childdata ON childdata.id = child.secondary_id
WHERE  child.parent_id = parent.id
AND    parent.parent_id = 'rootID' 
```

但是`JOIN`，正如您的案例再次说明的那样，显式语法通常更可取。

并注意 multiple ( `LEFT`)`JOIN`可以乘以行：

*   [两个 SQL LEFT JOINS 产生不正确的结果](https://stackoverflow.com/questions/12464037/two-sql-left-joins-produce-incorrect-result/12464135#12464135)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-04-29T14:07:36.737

You can do like this

```
SELECT something
FROM
    (a LEFT JOIN b ON a.a_id = b.b_id) LEFT JOIN c on a.a_aid = c.c_id
WHERE a.parent_id = 'rootID' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T15:35:18.600

这些`JOIN`语句也是`FROM`子句的一部分，更正式地说， *join_type*用于将两个*from_item*组合成一个*from_item*，其中多个可以在`FROM`. 请参阅[http://www.postgresql.org/docs/9.1/static/sql-select.html](http://www.postgresql.org/docs/9.1/static/sql-select.html)。

因此，您的问题的直接解决方案是：

```
SELECT something
FROM
    master as parent LEFT JOIN second as parentdata
        ON parent.secondary_id = parentdata.id,
    master as child LEFT JOIN second as childdata
        ON child.secondary_id = childdata.id
WHERE parent.id = child.parent_id AND parent.parent_id = 'rootID' 
```

`JOIN`正如已经建议的那样，更好的选择是只使用's。

# javascript - 做jquery ajax时没有异常但状态错误

> ID：14260865
> 
> 赞同：1
> 
> 时间：2013-01-10T15:03:46.673
> 
> 标签：javascript, ajax, jquery

这是我的 jQuery ajax 代码

```
 $.ajax({
    type: "GET",
    url: "http://example.com/request=r",
    dataType: "json",
    processData: true,
    data: {},
    success: function (responseString) {
        alert(responseString);
    },
    error: function (xhr, errorType, exception) {
        var errorMessage = exception || xhr.statusText;
        alert("Excep:: "+exception +"Status:: "+xhr.statusText);
    }
}); 
```

我没有得到异常，但我得到 xhr.statusText 作为`Error`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:08:46.657

您违反了[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)。如果提供者支持，唯一的客户端替代方案是使用 JSONP 请求类型。

如果不是，您需要编写一个服务器端代理来获取数据（在 PHP/C# 等中），然后改为通过 AJAX 查询。

# plsql - PL/SQL 过程没有按预期工作。真的需要新鲜的想法

> ID：14260866
> 
> 赞同：0
> 
> 时间：2013-01-10T15:03:49.303
> 
> 标签：plsql, oracle11g

好的，让我介绍一下主题：我有两个不同的员工表，它们具有不同的字段，我想将它们合并到一个表中。但我想保留旧表并不时执行我的程序来更新我的新表。

这是我到目前为止得到的代码，它在几个小时的错误后终于编译了，但是当我执行我的程序时，我收到消息“未找到条目”。

```
create type Employee_t as object (
    name varchar2(60),
    birthdate date,
    functions varchar2(40),
    monthly_income number,
    gender number,
    Employeennr number
);

create table Employee of Employee_t (Employeennr primary key);

create type Worker_T as object (
    name varchar2(30),
    firstname varchar2(30),
    birth_month varchar2(5),
    incomePerHour number
);

create table Worker of Worker_T;

create type Personal_T as object (
    personalnr number,
    name varchar2(30),
    firstname varchar2(30),
    age number,
    gender number,
    function_code number,
    incomePerYear number
);

create table Personal of Personal_T (personalnr primary key);

create type PersonalnrTagging_T as object (
    personalnr number,
    Employeennr number
);

create table PersonalnrTagging of PersonalnrTagging_T

create type Function_codes_T as object (
    code number,
    functions varchar2(40)
);

create table Function_codes of Function_codes_T;

create type Gender_T as object (
    gender number,
    firstname varchar(30)
);

create table Gender of Gender_T;

create sequence Personalnr_Seq start with 1;

create function DateToAge (birthdate date)
    return number
    is
        begin
            return floor(months_between(sysdate, birthdate) / 12);
        end;

create function StringToAge (birth_month varchar2)
    return number
    is
        begin
            return floor(months_between(sysdate, to_date(birth_month, 'MM.YY')) / 12);
        end;

create function GetSurname (name varchar2)
    return varchar2
    is
        pos number;
        begin
            pos := instr(name, ',', 1, 1);
            if (pos > 0) then
                return substr(name, 0, pos);
            end if;
            pos := instr(name, ' ', 1, 1);
            return substr(name, pos + 1);
        end;

create function GetFirstname (name varchar2)
    return varchar2
    is
        pos number;
        begin
            pos := instr(name, ',', 1, 1);
            if (pos > 0) then
                return substr(name, pos + 1);
            end if;
            pos := instr(name, ' ', 1, 1);
            return substr(name, 0, pos);
        end;

create procedure InsertTables
    is
        cursor employeer
            is select * from Employee;
        cursor worker
            is select * from Worker;
        anr number;
        ann varchar2(30);
        id number;
        bcode number;
        persnr number;
        gendr number;
        begin
            for a in employeer
            loop
                select Employeennr into anr from PersonalnrTagging where Employeennr = a.Employeennr;
                if (anr is null) then
                    select Personalnr_Seq.nextval into id from dual;
                    select code into bcode from Function_codes where functions = a.functions;
                    insert into Personal
                    values  (id, GetSurname(a.name), GetFirstname(a.name), DateToAge(a.birthdate), a.gender,
                            bcode, a.monthly_income * 12);
                    insert into PersonalnrTagging values (id, a.Employeennr);
                else
                    select code into bcode from Function_codes where functions = a.functions;
                    select personalnr into persnr from PersonalnrTagging where Employeennr = a.Employeennr;
                    update Personal
                    set     name = GetSurname(a.name), firstname = GetFirstname(a.name), age = DateToAge(a.birthdate),gender = a.gender,
                            function_code = bcode, incomePerYear = a.monthly_income * 12
                    where
                            personalnr = persnr;
                end if;
            end loop;
            for b in worker
            loop
                select name into ann from Personal where name = b.name and firstname = b.firstname;
                if (ann is null) then
                    select Personalnr_Seq.nextval into persnr from dual;
                    select gender into gendr from Gender where firstname = b.firstname;
                    select code into bcode from Function_codes where functions = 'Worker';
                    insert into Personal values (persnr, b.name, b.firstname, StringToAge(b.birth_month), gendr, bcode, b.incomePerHour * 40 * 49);
                else
                    select gender into gendr from Gender where firstname = b.firstname;
                    select code into bcode from Function_codes where functions = 'Worker';
                    select personalnr into persnr from Personal where name = b.name and firstname = b.firstname;
                    update Personal
                    set name = b.name, firstname = b.firstname, age = StringToAge(b.birth_month), gender = gendr,
                            function_code = bcode, incomePerYear = b.incomePerHour * 40 * 49
                    where 
                            personalnr = persnr;
                end if;
            end loop;
        end;

insert into Gender values (1, 'Hans');
insert into Gender values (2, 'Petra');
insert into Gender values (0, 'Vali');

insert into Function_codes values (01, 'Professor');

insert into Worker values ('Schulz', 'Hans', '07.87', 1);
insert into Worker values ('Schulz', 'Vali', '11.23', 2);

insert into Employee values ('Herbst, Petra', to_date('76/01/23', 'YY/MM/DD'), 'Professor', 324, 2, 20); 
```

有人看到我犯的错误吗？或者知道问题可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:34:54.467

错误来自您的`SELECT INTO`陈述

如果 Select into 没有找到结果，您必须用异常捕获它（您不能只测试您的变量是否为空）。

所以我在你的`SELECT INTO`陈述周围添加了类似的块

```
BEGIN
 SELECT INTO xxx
EXCEPTION WHEN NO_DATA_FOUND THEN
 bla bla
END; 
```

所以我用很少的 dbms_output 来纠正你的程序（为了缩短日志）

现在我们开始 ：

```
create or replace
procedure InsertTables
    is
        cursor employeer
            is select name, birthdate, gender, monthly_income, Employeennr, functions from Employee;
        cursor worker
            is select * from Worker;
        anr number;
        ann varchar2(30);
        ide number;
        bcode number;
        persnr number;
        gendr number;
        begin
            for a in employeer
            loop
                begin
                  select Employeennr 
                  into anr 
                  from PersonalnrTagging 
                  where Employeennr = a.Employeennr;
                exception when no_data_found then 
                    select Personalnr_Seq.nextval into ide from dual;
                    select code into bcode from Function_codes where functions = a.functions;
                    insert into Personal
                    values  (ide, GetSurname(a.name), GetFirstname(a.name), DateToAge(a.birthdate), a.gender,
                            bcode, a.monthly_income * 12);
                    insert into PersonalnrTagging values (ide, a.Employeennr);
                end;

                select code into bcode from Function_codes where functions = a.functions;
                select personalnr into persnr from PersonalnrTagging where Employeennr = a.Employeennr;
                update Personal
                set     name = GetSurname(a.name), firstname = GetFirstname(a.name), age = DateToAge(a.birthdate),gender = a.gender,
                            function_code = bcode, incomePerYear = a.monthly_income * 12
                where personalnr = persnr;
            end loop;
            for b in worker
            loop
                gendr:=null;
                bcode:=null;
                persnr:=null;
                begin
                select gender into gendr from Gender where firstname = b.firstname;
                    exception when no_data_found then
                      dbms_output.put_line('no Gender for firstName '||b.firstname);
                    end;
                    begin
                    select code into bcode from Function_codes where functions = 'Worker';
                    exception when no_data_found then
                      dbms_output.put_line('no code for function Worker');
                    end;
                begin
                    select name into ann from Personal where name = b.name and firstname = b.firstname;
                exception when no_data_found then

                    select Personalnr_Seq.nextval into persnr from dual;

                    if gendr is null or bcode is null then
                     dbms_output.put_line('error in inserting');
                    else
                    insert into Personal values (persnr, b.name, b.firstname, StringToAge(b.birth_month), gendr, bcode, b.incomePerHour * 40 * 49);
                    end if;
                end;
                    begin
                    select personalnr into persnr from Personal where name = b.name and firstname = b.firstname;
                    exception when no_data_found then
                     dbms_output.put_line('no persnr with name '||b.name||' and firstname '|| b.firstname);
                    end;
                    if (gendr is null or bcode is null or persnr is null) then
                       dbms_output.put_line('error in updating');
                    else
                    update Personal
                    set name = b.name, firstname = b.firstname, age = StringToAge(b.birth_month), gender = gendr,
                            function_code = bcode, incomePerYear = b.incomePerHour * 40 * 49
                    where 
                            personalnr = persnr;
                    end if;
            end loop;
        end; 
```

现在我们可以安全地运行它，并收到一些错误消息（我们的消息，不是 Oracle 的）：

```
no code for function Worker
error in inserting
no persnr with name Schulz and firstname Hans
error in updating
no code for function Worker
error in inserting
no persnr with name Schulz and firstname Vali
error in updating 
```

我们看到您忘记在 Function_codes 表中插入一个 Worker 函数。

如果你只是这样做

```
insert into Function_codes values (02, 'Worker'); 
```

你没有任何错误。

您会在个人表格中看到所有结果：

...但你的人有年龄

-64 -75 -11

认为在 varchar (87 = 2087, 76 = 2076) 中插入日期缩短时仍然存在问题！

# ubuntu-12.04 - 无法在mysql中创建表，使用mysql workbench

> ID：14260868
> 
> 赞同：0
> 
> 时间：2013-01-10T15:03:51.807
> 
> 标签：ubuntu-12.04, mysql-workbench

我正在尝试使用 mysql 工作台创建一个表并收到消息。我正在使用 ubuntu 12.04

> 17:00:02 将更改应用于“where 子句”中的 pygm_allvideoshare_weights 未知列“Tables_in_pygmaxia2.gr”

我可以在其他数据库中创建表，但不能在特定数据库中创建表。mysql工作台有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:06:16.330

我将数据库的名称从 pygmaxia2.gr 更改为 pygmaxia2，现在我可以在数据库中创建表。我猜数据库不能有 .something 在那里的名字.. 所以，thanx 反正

# php - 本地化最佳实践

> ID：14260878
> 
> 赞同：0
> 
> 时间：2013-01-10T15:04:21.033
> 
> 标签：php, html

我需要翻译我们的网站。首先是一种语言，但我认为以后会是更多其他语言。所以我正在考虑最好的方法来做到这一点。

所以我将使用子目录来保存 html 文件。常见的文件，如图像、JS 等，将很常见......我将制作语言文件并将其包含在文件的前面。我有 25 个 html 文件。对于 html 文件中的所有内容，我将在语言文件中使用变量（或常量），例如：

*   文本
*   图像 alt 标签
*   元键，元描述，所以所有元标记..
*   菜单..一切

25 个 html 文件的总大小小于 300k。所以语言文件最大为100k。

我不知道我是使用一个大语言文件并简单地包含每个文件（我不在乎是否不使用每个页面中的每个变量），还是使用 25 个分隔的语言文件。是这个问题吗？

这种语言文件方法会影响性能、SEO 还是其他什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:20:39.043

最好的选择是使用一些 CMS（最好是开源）解决方案。

如果这是不可能的（出于任何原因我们没有得到），那么这是正确的解决方案（尽管不是最简单的）：

*   每种语言的 HTML 文件应单独存储
*   这一切都意味着在您的根目录中，您将拥有文件夹、、、`/en/`等`/es/`，`/de/`并且每种语言的语言文件都将存储在其中
*   语言（代码）应出现在 URL 中，例如`http://mydomain.com/en/index.html`英文站点版本和`http://mydomain.com/es/index.html`西班牙语等...
*   为此目的使用 ISO 两个字母的语言代码
*   您是否将拥有包含一种语言文件或仅翻译 HTML 文件的语言文件和 HTML 文件，由您决定

这是最好的解决方案，恕我直言，当谈到方法、搜索引擎优化、......

# perforce - Perforce 中意外“标记为删除”的文件。我怎样才能扭转它？

> ID：14260891
> 
> 赞同：14
> 
> 时间：2013-01-10T15:04:59.470
> 
> 标签：perforce

使用**p4v**，我无意中在本地存储库中“标记为删除”几个文件。如何取消标记这些项目。这些项目可能有新的变化，我不想覆盖它们。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-10T15:54:39.183

在 pv4 gui 的挂起更改列表中，您应该会看到列出的文件标记为删除。

选择您不想删除的文件，然后**还原**它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-02T13:49:53.303

只需右键单击 P4V 中的特定文件夹或文件，然后单击还原。它解决了我的问题。

# php - 即使需要创建键，如何正确增加一些数组键？

> ID：14260894
> 
> 赞同：5
> 
> 时间：2013-01-10T15:05:05.073
> 
> 标签：php, optimization, micro-optimization

假设您需要创建某种“顶部”并具有如下代码：

```
$matches=array();
foreach ($array as $v){
   $matches[processing($v)]++;  
} 
```

这将为索引需要创建的情况输出 a **`Notice: Undefined index`**。

既然您知道必须创建索引，那么解决这些情况的最佳方法是什么？

我根据情况使用了这些解决方案：

1.  抑制错误`@$matches[$v]++;`
    **Pro** : 很容易输入
    **Con** : 慢
2.  检查它是否设置`$matches[$v]=isset($matches[$v])?$matches[$v]++:1;`
    **Pro** : 更快
    **Con** : 即使是速记形式也需要更长的时间来编写并且需要再使用 $matches[$v] 2 次

还有其他方法吗？
寻找**最快的执行时间**，因为我正在使用这个函数数千次或者一些更**懒惰的输入方式，**它仍然比 @ 更快

**编辑：**

在一个简单的情况下，你也`$matches[$v]++;`可以使用`array_count_values()` *（正如 Yoshi 建议的那样）*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-12T10:54:25.520

经过一些阅读、写作和测试，我得到了一些东西：

```
function inc(&$var){
    if (isset($var)) $var++;else $var=1;
} 
```

并以为我找到了金子，但让我们先看看测试......

## 测试代码：

```
$a=array();

// Pre-Fill array code goes here
for($i=1;$i<100000;$i++) {
    $r=rand(1,30000);
    //increment code goes here
}

// Remove extra keys from array with:
//foreach ($a as $k=>$v) if ($v==0) unset($a[$k]); 
```

执行时间：（*仅供参考）*

```
inc($a[$r])                             1.15-1.24
@$a[$r]++                                   1.03-1.09
$a[$r]=array_key_exists($r,$a)?$a[$r]++:1;  0.99-1.04

$a[$r]=!empty($a[$r])?$a[$r]++:1;               0.61-0.74
if (!empty($a[$r])) $a[$r]++;else $a[$r]=1; 0.59-0.67
$a[$r]=isset($a[$r])?$a[$r]++:1;                0.57-0.65
if (isset($a[$r])) $a[$r]++;else $a[$r]=1;  0.56-0.64

//with pre-fill
$a=array_fill(0,30000,0);                   +0.07(avg)
for($i=1;$i<=30000;$a[$i++]=0);             -0.04(avg)

//with pre-fill and unset
$a=array_fill(0,45000,0);                   +0.16(avg)
for($i=1;$i<=45000;$a[$i++]=0);             +0.02(avg) 
```

## 结论：

*   `@`**当然是最快的类型，我认为在这种情况下**使用它没有任何问题，但也可以随意检查这个问题：[Suppress error with @ operator in PHP](https://stackoverflow.com/q/136899/731947)
*   完全抑制错误（在循环之前并在循环之后启用错误）通过`ini_set()`比所有性能都差
*   `inc()`看起来漂亮干净，易于键入并且会检查而不是抑制，但调用它看起来甚至比`@`
*   `isset()`比 略快`empty()`，但两者的表现相当
*   有趣的是，使用**速记** `if`语句**稍慢**！
*   预填充阵列时获得的最佳结果。即使长度未知，一个好的预测在巨大的数据集上仍然会稍微快一些
*   奇怪的是，`array_fill()`需要的时间比`for`?!?!

## RFC

我不认为这个答案是 100% 完整的，虽然，现在它看起来`isset()`是最快和`@`最懒惰的。
任何意见和想法表示赞赏！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:29:40.113

您也许可以初始化匹配数组开始，使用`array_combine`将值组合`$array`为键并`array_fill`用初始 0 填充值

```
$matches = array_combine(array_values($array), array_fill(0, count($array), 0)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T15:27:12.813

我经常做：

```
$matches=array();

foreach ($matches as $v){

    /* if $v is not empty, add 1, otherwise $v= 1 */
    $matches[$v]=(!(empty($matches[$v]))) ? $matches[$v]++ : 1;
} 
```

你是对的。这有点罗嗦，但公平地说，它同时非常简洁。我使用`empty()`而不是`isset()`。不知道这在我脑海中是更快还是更慢。我认为它可能会更慢。

**编辑**

要回答您的编辑，我会这样做：

```
$matches=array();

foreach ($matches as $v){

    $x=function($v);

    /* if $v is not empty, add 1, otherwise $v= 1 */
    $matches[$x]=(!(empty($matches[$x]))) ? $matches[$x]++ : 1;
} 
```

这样，您只需调用该函数一次。

# javascript - 如何为注入 div 的 javascript 编写插件（如弹出菜单）

> ID：14260895
> 
> 赞同：-1
> 
> 时间：2013-01-10T15:05:06.877
> 
> 标签：javascript, oop, generics, plugins, popup

我制作了一个建议框，我想对其进行推断并将其转换为可重用的代码（插件），这样我就可以在页面和任何地方多次使用它。问题是，我不知道如何去做。

我不想显示我的代码，因为它很大，**我*想*看到**的是一个插件的示例代码，当鼠标悬停在对象上时，它可以在对象上创建一个弹出 div 并且**它**是以这种方式制作的这样它就可以在一个页面上多次使用（所以它不使用 id）。

我将非常感谢这一点，因为它会启发我如何开始将我的代码变成可重用的插件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:29:53.750

这是一种可以帮助您入门的可能性：

```
(function(w, d) {
    function createPopup(el, options) {
        // Create popup from DOM elements, a string, or read from a template
        var popup = d.createElement('div');
        popup.className = options.className;
        popup.innerText = 'Foobar!';
        // Possibly insert popup into DOM, depending on how you've implemented it
        el.parentNode.insertAfter(popup, el);
    }

    var defaultOptions = {
        className: 'popup'
    };

    var MyPlugin = function(el, options) {
        this.element = el;
        this.options = options || defaultOptions;
        this.popup = createPopup(el, this.options);

        var self = this;

        // Ignoring IE for now
        el.addEventListener('click', function() {
            self.popup.style.display = 'block';
            // Possibly want to set position of popup, depending on how you've implemented it
        });

        self.popup.addEventListener('mouseout', function() {
            self.popup.style.display = 'none';
        });
    };

    MyPlugin.prototype = {
        // Other methods you want an instance of MyPlugin to have, for example:
        setText: function(text) {
            this.popup.innerText = text;
        }
    };

    // Static methods
    MyPlugin.setDefaults = function(options) {
        defaultOptions = options;
    };

    w.MyPlugin = MyPlugin;
})(window, document); 
```

用法：

```
<script>
var popup1 = new window.MyPlugin(document.getElementById('#foo'));
var popup2 = new window.MyPlugin(document.getElementById('#bar'));
popup2.setText = "I'm another popup!";

MyPlugin.setDefaults({
    className: 'foobar'
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T00:51:54.140

我采用了 Roryf 的代码并解决了一些错误。（@Roryf 如果您的代码在您开始时运行良好，那么我一定做错了什么：S）

我更改了一些代码，以便它对我有用。非常感谢 Roryf 写得很好的回答。我希望这对其他像我一样寻找起点的人有所帮助。

我放了一个小提琴，所以不需要在你的电脑上复制和粘贴。

[http://jsfiddle.net/crislivinitup/rdqcf/1/](http://jsfiddle.net/crislivinitup/rdqcf/1/)

```
(function(w, d) {
function createPopup(el, options) {
    // Create popup from DOM elements, a string, or read from a template
    var popup = d.createElement('div');

    //*** I haven't been able to get className to work, so I commented it out
    // popup.className = options.className;

    //***popup.innerText = 'Foobar!';
    popup.insertAdjacentHTML("afterBegin",'Foobar!');
    // Possibly insert popup into DOM, depending on how you've implemented it
    //***el.parentNode.insertAfter(popup, el);
    el.appendChild(popup);

    //**** added to hide div by default
    popup.style.display = 'none';

    //*** added to connect this.popup (from MyPlugin function) to the reference of the created div
    return popup;
}

var defaultOptions = {
    //*** I haven't got className to work, so I just took out the related functions
    className: 'popup'
};

var MyPlugin = function(el, options) {
    this.element = el;
    this.options = options || defaultOptions;
    this.popup = createPopup(el, this.options);

    var self = this;

    // Ignoring IE for now
    el.addEventListener('mouseover', function() {
        //alert("clicked");
        self.popup.style.display = 'block';
        // Possibly want to set position of popup, depending on how you've implemented it
    });

    el.addEventListener('mouseout', function() {
        self.popup.style.display = 'none';
    });

};

MyPlugin.prototype = {
    // Other methods you want an instance of MyPlugin to have, for example:
    setText: function(text) {

        //***I didn't get the innerText to work, so I changed it with synonymous code
        //***this.popup.innerText = text;
        this.popup.insertAdjacentHTML("beforeEnd",text);
    }
};

// Static methods
MyPlugin.setDefaults = function(options) {
    defaultOptions = options;
};

w.MyPlugin = MyPlugin;
})(window, document); 
```

实现：*必须在可以有childrenNode的元素上使用，例如div

```
var popup1 = new window.MyPlugin(document.getElementById("foo"));
var popup2 = new window.MyPlugin(document.getElementById("bar"));
popup1.setText("I'm another popup!");
popup1.setText("keep going"); 
```

# backbone.js - 如何在我的backbone.js 练习中插入分页

> ID：14260896
> 
> 赞同：2
> 
> 时间：2013-01-10T15:05:10.513
> 
> 标签：backbone.js, backbone-views, backbone.js-collections

我正在尝试学习backbone.js，在这个练习中，我有一个显示集合中元素的视图。此集合从导出 json 文件的后端获取数据，如下所示：

```
{
    "users": [
        {
            "name": "Jeffrey Way",
            "age": 27
        },
        {
            "name": "John Doe",
            "age": 50,
            "occupation": "web designer"
        },
        {
            "name": "Sally Doe",
            "age": 29,
            "occupation": "graphic designer"
        }
    ],
    "count": 9,  // total users
    "page": 0,   // current page
    "pages": 2   // total page
} 
```

我喜欢在这个例子中插入分页，但我不知道怎么做。我知道有一个看起来很酷的组件[Backbone.paginator 。](https://github.com/addyosmani/backbone.paginator)你能帮我在我的例子中插入 Backbone.paginator 吗？如果您知道为我的目的实现分页的另一种方法，您能向我解释一下吗？

这是我的**index.html**

```
<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <meta charset="UTF-8" />

  <title>User List</title>

  <meta name="description" content="" />
  <meta name="keywords" value="" />

  <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css" type="text/css" />

  <style>
    body {
      margin: 0;
      font-family: Helvetica, Arial, sans-serif;
      font-size: 14px;
      line-height: 20px;
      color: #333333;
      background-color: #ffffff;
    }

    .pagination {
      text-align: center;
    }
  </style>

<!-- Templates -->
<script type="text/template" id="tpl-user">
  user: <%= name %>, <%= age %>, <%= occupation %> 
</script>
</head>
<body>

  <div id="main" class="container">
    <div class="page-header">
      <div class="row">
        <div id="header" class="span6">
          <!--
          <h1>Advertisers</h1>
          <p>La ricerca ha prodotto {{ count }} risultati.</p>
          -->
        </div>
        <div class="span6">
          <div class="input-append" style="text-align:right; margin-top:18px;">
            <input id="contact-to-search" class="span5" id="appendedInputButton" type="text">
            <button id="src-btn" class="btn" type="button">Search</button>
          </div>
        </div>
      </div>
    </div>
    <div id="content"></div>
    <div id="pagination" class="pagination">
      <!--
      <ul>
        <li><a href="#">Prev</a></li>
        <li><a href="#">1</a></li>
        <li><a href="#">2</a></li>
        <li><a href="#">3</a></li>
        <li><a href="#">4</a></li>
        <li><a href="#">Next</a></li>
      </ul>
      -->
    </div>
  </div>

  <script src="js/lib/underscore-min.js"></script>
  <script src="js/lib/jquery-1.8.3.min.js"></script>
  <script src="js/lib/backbone-min.js"></script>
  <script src="js/lib/jquery.json-2.3.min.js"></script>
  <script src="bootstrap/js/bootstrap.min.js"></script>

  <script src="js/main.js"></script>
</body>
</html> 
```

这是我的**main.js**

```
// Models
var User = Backbone.Model.extend({
    defaults:{
        "name" : "No Name",
        "age" : "No Age",
        "occupation" : "No occupation"
    }
});

//Collections
var UserCollection = Backbone.Collection.extend({
    model:User,
    url:"json2.json",
    parse: function(response){
       return response.users;
    }
});

// Views
var UserCollectionView = Backbone.View.extend({

    tagName:'ul',

    initialize:function () {
        this.model.bind("reset", this.render, this);
    },

    render:function () {
        _.each(this.model.models, function (user) {
            $(this.el).append(new UserView({model:user}).render().el);
        }, this);
        return this;
    }

});

var UserView = Backbone.View.extend({

    tagName:"li",

    template:_.template($('#tpl-user').html()),

    render:function () {
        $(this.el).html(this.template(this.model.toJSON()));
        return this;
    }

});

// Router
var AppRouter = Backbone.Router.extend({

    routes:{
        "":"list"
    },

    list:function () {
        this.user_collection = new UserCollection();
        this.user_collection_view = new UserCollectionView({model:this.user_collection});
        this.user_collection.fetch();
        $('#content').html(this.user_collection_view.el);
    }
});

// Main
var app = new AppRouter();
Backbone.history.start(); 
```

非常感谢你来自意大利！！

# sql - 使用动态变量的 SQL Server Select 语句

> ID：14260899
> 
> 赞同：0
> 
> 时间：2013-01-10T15:05:19.933
> 
> 标签：sql, sql-server, database, select, declare

好的，所以在下面的语句中，我试图将第一个`pi.planinfoid`选择作为第一个字段，并使其成为一个动态变量，以代替`1736`您在用作附加字段的两个选择语句中看到的。

即使值为 0 或 null，我还需要它仍然返回由两个 select 语句生成的两个字段。

如果有人能解决这个问题，我会提前感谢。

```
SELECT  pi.planinfoid,
        pi.description,
        count(DISTINCT p.planid) AS total,
        sum(dm.debitamount) AS Num,
        pi.minperiod,
        (
            SELECT count(p.planid)
            FROM plans p,
                    planinfo pi
            WHERE pi.planinfoid = p.planinfoid
                    AND pi.planinfoid = '1736'
                    AND p.closed = 0
        ) AS opened,
        (
            SELECT count(p.planid)
            FROM plans p,
                    planinfo pi
            WHERE pi.planinfoid = p.planinfoid
                    AND pi.planinfoid = '1736'
                    AND p.closed = 1
        ) AS closedd
FROM    planinfo pi, plans p, debitmovements dm
WHERE   pi.price > 0
        AND p.planinfoid = pi.planinfoid
        AND dm.planid = p.planid
        AND p.servicestart BETWEEN '2012-01-01' AND '2013-01-01'
GROUP BY    pi.description,
            pi.minperiod,
            pi.planinfoid
ORDER BY total DESC 
```

那跑了，但无论如何似乎打开和关闭都与总数无关，

```
planid  plan descrip   min      TOTAL   PRICE   OPEN    CLOSE
1736    Additional IP   1   146 1926    101 545 
```

从技术上讲，如果在该时间段内售出的总数为 146，则您不能有 101 个仍然打开和 545 个关闭，也许它的非拉数仍然打开和关闭仅在那个时间段打开的那些。146 open 的 uniqe 字段将是 p.planid，或者每个人基本上都有一个唯一的 p.planid，但到目前为止做得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:09:14.317

尝试这个：

```
SELECT
  pi.planinfoid, 
  pi.description, 
  pi.minperiod,
  count(DISTINCT p.planid) AS total,
  sum(dm.debitamount) AS Num, 
  SUM(CASE WHEN p.closed = 0 THEN 1 ELSE 0 END) AS opened,
  SUM(CASE WHEN p.closed = 1 THEN 1 ELSE 0 END) AS closedd
FROM planinfo pi  
INNER JOIN plans           p ON p.planinfoid = pi.planinfoid
INNER JOIN debitmovements dm ON dm.planid    = p.planid 
WHERE pi.price > 0
  AND p.servicestart BETWEEN '2012-01-01' 
                         AND '2013-01-01'
GROUP BY pi.description,
         pi.minperiod,
         pi.planinfoid 
ORDER BY total DESC; 
```

我在这里所做的是：

*   我使用了隐式`JOIN`语法，即 ANSI-92 SQL 标准之一，而不是旧的。
*   `COUNT()`用两个`CASE`表达式替换了两个相关的子查询。
*   我移到`pi.planinfoid = 1736`子句`WHERE`，你可以把它放在`CASE`表达式条件中。
*   您将需要传递`planinfoid`您正在寻找的而不是`@value`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:15:12.087

我很难判断分组条件是否应该适用于计数。要明确计数，您可以使用子查询：

```
SELECT  pi.planinfoid,
        pi.description,
        count(DISTINCT p.planid) AS total,
        sum(dm.debitamount) AS Num,
        pi.minperiod,
        max(opened) as opened,
        max(closed) as closed
FROM    planinfo pi join
        plans p
        on p.planinfoid = pi.planinfoid join
        debitmovements dm
        on dm.planid = p.planid left outer join
        (select planinfoid, SUM(1-p.closed) as opened, SUM(p.closed) as closed
         from planinfo pi join
              plans p
              on pi.planinfoid = p.planinfoid
         group by planinfoid
        ) psum
        on psum.planinfoid = psum.planinfoid
WHERE   pi.price > 0 AND
        p.servicestart BETWEEN '2012-01-01' AND '2013-01-01'
GROUP BY    pi.description,
            pi.minperiod,
            pi.planinfoid
ORDER BY total DESC 
```

但是，在您的问题的上下文中，您可以通过为内部子查询提供不同的别名来做您想做的事情：

```
 (
        SELECT count(p2.planid)
        FROM plans p2 join
             planinfo pi2
             on pi2.planinfoid = p2.planinfoid
        WHERE
                pi2.planinfoid = pi.planinfoid
                AND p2.closed = 0
    ) AS opened, 
```

# c - C中的优先顺序

> ID：14260900
> 
> 赞同：2
> 
> 时间：2013-01-10T15:05:21.430
> 
> 标签：c

```
#include<stdio.h>
int main()
{
   int i=-3, j=2, k=0, m;
   m = ++i || ++j && ++k;
   printf("%d, %d, %d, %d\n", i, j, k, m);
   return 0;
} 
```

为什么输出结果是-2 2 0 1？

一个逻辑是 (++j&& ++k) 不计算为 ++i 非零

但是因为 && 比 || 具有更高的偏好 为什么不计算它们

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T15:22:30.730

优先级不指定计算表达式的顺序。它指定如何解释表达式。在这种情况下，C 的优先规则（嵌入在其形式文法中）导致`a || b && c`被解释为`a || (b && c)`.

当计算这个表达式时，C 的规则指定`a`必须首先计算。规则还规定，如果`a`为真，则整个表达式的值为真，并且不计算右侧的`||`值。

为了更清楚地看到这一点，请考虑表达式`a + b < c * d`。优先规则导致 this 被解释为`(a + b) < (c * d)`. 然而，与 不同的是，C 的规则并没有指定必须首先计算`||`的左侧。`<`编译器可能`a + b`首先评估或`c * d`首先评估，即使`*`优先级高于`+`. 允许编译器使用任何得到正确答案的评估顺序。

这里强加的唯一顺序是，`a + b`并且`c * d`必须在评估之前`<`都进行评估。但是，这来自表达式的结构，而不是优先级规则。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T15:08:17.060

运算符`&&`和`||`计算顺序是从左到右的。编译器保证`||`如果左操作数的计算结果为真，则不会计算运算符的右操作数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T15:07:59.700

`m = ++i || ++j && ++k;`

`++i`将首先执行。因为，`i`将变成`-2`，这意味着/等价于`true`。它不会执行`++j && ++k`part 并且`m`value 将是`1`.

因此，最终输出将变为`-2 2 0 1`

执行时`||`，会先执行左手部分，如果是`true`则不会执行右手部分。因为，无论是右部分`true`还是`false`. 因此，在您的情况下，执行的剩余部分`||`并且由于它返回非零值，这意味着`true`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T15:29:19.267

由于短路评估

```
m = ++i || ++j && ++k; 
```

相当于

```
++i;
m = i != 0;
if(!m) {
  ++j;
  m = j != 0;
  if(m) {
    ++k;
    m = k != 0;
  }
} 
```

# c# - 让 UIScrollView 的 dragIcons 更加用户友好

> ID：14260901
> 
> 赞同：1
> 
> 时间：2013-01-10T15:05:28.490
> 
> 标签：c#, user-interface, uiscrollview, drag-and-drop, xamarin.ios

关于 Monotouch C# iOS 开发：

在我的一个应用程序中，我有一个 UIScrollview，它充当包含可拖动图标的“工具箱”。用户可以滚动工具箱来决定他想要哪个项目，然后将其拖到屏幕上。它工作得很好而且很漂亮，但是用户界面部分可以改进。我想提出一种改进方法，但我不确定如何实施它。想法？

![在此处输入图像描述](../Images/e10178ec348d819b799a2c4b91ba8ac4.png)

此图像的顶部是 UIScrollview 工具箱。在其中，有几个可拖动的图标。

**当前方法：** UIScrollview 包含可拖动的 UIImages。我正在使用 scrollView.DelaysContentTouches = true 方法将触摸转移到 UIImage。所以基本上，如果用户在 UIScrollview 中的任何地方滑动（即使他在可拖动的图标上滑动），只要他快速滑动它就可以算作滚动。DelaysContentTouches 的内置延迟约为 0.16 秒。下面为不知道的小伙伴一一介绍：

**DelaysContentTouches：**如果此属性的值为 YES，则滚动视图会延迟处理触摸向下手势，直到它可以确定滚动是否是意图。如果值为 NO ，则滚动视图立即调用 touchesShouldBegin:withEvent:inContentView:。默认值为是。

**当前方法的问题：** 当前方法有效，但它不是白痴证明或超级直观。在某种程度上，它是直观的，但这不是我喜欢的。我用我的软件做了一些项目演示，人们被绊倒的事情是试图将图标从工具箱拖到工具箱中。他们总是尝试拖动“类似滑动的动作”并最终滚动工具箱而不是拖动图标。听起来很愚蠢，刚接触该应用程序的人总是会花大约 1 分钟的时间来弄清楚拖动是如何工作的，我最终向他们展示了在拖动之前你必须触摸并按住几分之一秒。这不好。

**新提议的方法：**我提议的方法根据“滑动”或“拖动”发生的角度确定用户拖动与滚动的意图。我将从工具箱中定义一个角度范围，即 Drag me Range 和 Scroll Me Range。当用户触摸图标并开始向下拖动时，TouchesMoved 函数将测量拖动的移动距离。一旦 Touch 移动了大约 5 或 10 个像素的距离，它就会测量从初始触摸位置到当前移动位置的角度。如果角度在 Drag Me Angle Range 内，它会拖动图标。如果角度在 Scroll Me 范围内，它会滚动图标。

![在此处输入图像描述](../Images/7d1a25edc4b9ec74b920689a6bdb3ec7.png)

在这张图片中，顶部的红色区域是“Scroll Me Range”，下方的黄色区域是“Drag Me Range”。角度由黄色角度线定义。

**实施这个新方法：** 我将如何实施这个？我是否应该允许 Touch 进​​入 DragIcon 和 UIScrollView 的 TouchesBegan，然后取消它不使用的触摸？示例：用户尝试通过快速滑动向下拖动图标。UIScrollView 和 DragIcon 都在 TouchesBegan 中接收到触摸。在它拖动 10 个像素的距离后，TouchesMoved 函数测量角度并确定它在 DragMe 范围内。因为它在 DragMe 范围内，所以它取消了 UIScrollView 内的触摸，所以它不再移动......我可以这样做吗？这里的副作用是，在等待测量角度的前 10 个像素移动期间，DragIcon 和 UIScrollview 都将移动/滚动......

你将如何实现这一点？还是你有更好的主意？

# c# - 带有用户名和密码的 HTTP GET 请求

> ID：14260905
> 
> 赞同：2
> 
> 时间：2013-01-10T15:05:42.857
> 
> 标签：c#, http, cloud, console-application

这是我第一次尝试创建一个`console app`可以发出`HTTP GET`请求并将响应打印到`console`.

到目前为止，该代码有效，但仅适用于`URIs`不需要`username/password`.

我的最终目的是使用一个`cloud/hosting API`接受`HTTP GET`请求的*触发器*作为采取某些行动的触发器。因此，我必须为此使用 a `username/password`。

```
using System;
using System.Net;
using System.IO;

namespace HttpTestProject {

    class Program {

        static void Main(string[] args) {

            Uri uri = new Uri("http://www.google.com");
            string username = "asdf";
            string password = "asdf";

            NetworkCredential cred = new NetworkCredential(username, password);
            CredentialCache cache = new CredentialCache();
            cache.Add(uri, "Basic", cred);

            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);
            HttpWebResponse response = (HttpWebResponse)request.GetResponse();
            Stream resStream = response.GetResponseStream();

            StreamReader reader = new StreamReader(resStream);
            string text = reader.ReadToEnd();

            Console.WriteLine(text);
            Console.ReadLine();

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-10T15:22:54.803

如果您必须在不等待质询的情况下向您的请求添加基本身份验证，您可以手动附加标头：

```
var request = WebRequest.Create("http://myserver.com/service");
string authInfo = userName + ":" + userPassword;
authInfo = Convert.ToBase64String(Encoding.Default.GetBytes(authInfo));

//like this:
request.Headers["Authorization"] = "Basic " + authInfo;

var response = request.GetResponse(); 
```

# algorithm - 访问点、算法

> ID：14260906
> 
> 赞同：6
> 
> 时间：2013-01-10T15:05:43.807
> 
> 标签：algorithm, data-structures

我正在从算法和数据结构（我在一个月内完成）中学习考试，但我无法为这个问题找到有效的算法：

> 我们在这条线上得到 1 <= n <= 5000 个点。每个点具有不同的自然坐标 0 <= d <= 10^6 和（不一定不同）自然**点时间**0 <= t <= 10^9 以秒为单位。我们可以从任意点开始，每秒将当前坐标更改 +/-1。问题是以这样的顺序访问所有点，即在经过他的点时间之前访问每个点。找出这次旅行的最短总时间（以秒为单位），或者说这是不可能的。

例如，给出 5 个点（坐标，点时间）：

(1,3), (3,1), (5,6), (8,19), (10,15)，有可能，当我们旅行时访问坐标：3 -> 1 -> 5 -> 8 -> 10，我们得到最小总时间，等于：11。

我的第一个想法是按字典顺序对所有点进行排序：（点时间，坐标），然后按此顺序访问它们。当然，当第i个点和第(i+1)个点之间有点时，我们可以在访问第(i+1)个点之前访问它们。但不幸的是，没有论据为什么这种贪婪的方法应该奏效，尽管它很难实施。也许我试图解决它太快？n 很小，所以我想 O(n^2) 应该没问题。

我找到了其他输入示例，认为它可能会帮助我找到解决方案。但现在我只看到我必须找到所有可能的 $n!$ 排列中的一个排列。

**输入示例：**

点（也分别由坐标，点时间给出）：（0,4），（1,2），（4,5）：令人惊讶的是（我认为）我们必须访问它们：0 -> 1 -> 4，因为任何不同的顺序都不满足问题文本中最后一句之前的条件。

点数：(0,7), (1,2), (2,1), (3, 4), (4,11)，唯一有趣的是：2 -> 1 -> 3 -> 0 -> 4，这需要我们 10 秒。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T18:01:19.850

首先根据坐标对点进行排序。

我会推荐一种基于为 0 和 n-1 之间的近和远的每个值解决以下子问题的动态编程方法：

假设我们在最近的点并且已经访问了近和远（包括）之间的所有点，那么如果我们有足够的时间访问所有剩余的点，那么它必须是什么时间？

您的问题的答案由 near=far=x 的子问题的最大值 v(x) 给出，因为 x 在 0 和 n-1 之间变化。如果所有 x 的 v(x)<0，则您无法达到所有点。但是，如果某些 x 的 v(x)>=0，那么您可以从位置 x 开始在“所有点的最大点时间”-v 给出的时间内到达所有点。

案例之间的重复基于考虑从最近的点向左或向右移动，直到到达您尚未覆盖的第一个点。（这将涉及到近点或远点的直接邻居，因此递归只需要 O(1) 时间来计算）

有 n^2 个子问题，因此这种方法总体上应该花费 O(n^2) 时间。

编辑

实现这种方法的 Python 代码：

```
A=[(0,7), (1,2), (2,1), (3, 4), (4,11)]
A.sort()
M=max(a[1] for a in A)
cache={}
def go(near,far):
    """Given that we are at near and have visited all points in [near..far], 
    (near can be > or < or = far)
    return the latest time that allows us to visit all points, 
    and visit the point near itself."""
    if abs(far-near)==len(A)-1:
        return A[near][1]-1

    key=near,far
    if key in cache:
        return cache[key]

    v=-1
    d = 1 if near<=far else -1
    n = near-d
    if 0<=n<len(A):
        v=go(n,far)-abs(A[n][0]-A[near][0])
    n = far+d
    if 0<=n<len(A):
        v=max(v,go(n,near)-abs(A[n][0]-A[near][0]))

    v=min(v,A[near][1]-1)
    cache[key]=v
    return v

v=max((go(x,x),x) for x in xrange(len(A)))
if v[0]<0:
    print 'Impossible'
else:
    print 'Takes',M-v[0]-1,'seconds starting from point',v[1] 
```

对于时间为 1 的点，您是否必须在时间 t<1 或时间 t<=1 到达它，这有点模糊。此解决方案使用时间 t<1，因为它与您的示例匹配。

（如果要求是 t<=1，那么 (0,7), (1,2), (2,1), (3, 4), (4,11) 的解决方案将是路径 1 -> 2 -> 3 -> 0 -> 4 在 9 秒内）

# r - 使用预测模型和 TunePareto 包测试和训练数据集

> ID：14260910
> 
> 赞同：1
> 
> 时间：2013-01-10T15:05:50.593
> 
> 标签：r, machine-learning

我正在尝试为具体问题选择最佳预测/分类模型。我被要求遵循的方法是这样的：

*   将数据分为测试和训练。
*   使用训练数据运行具体模型，并使用 10 倍交叉验证对其进行评估，以获得该模型的最佳参数（评估给定的误差）。
*   对其他模型重复，直到我为每个选择的分类模型获得最佳配置。
*   最后，我必须使用最好的参数集重新运行每个模型，其中要训练的数据是“trainingdata”，而作为结果给出的错误可能来自“testdata”（请注意，测试数据直到现在，以避免最终比较失真）。

我一直在使用包 TunePareto 执行此操作，它具有一个很好且易于运行的功能，可以在数据帧上运行一些分类模型（如 Naive Byes 或 kNN）以及 10 倍 CV。我提到的最后一个任务出现了问题：我不知道如何使用特定的数据帧作为 TunePareto 的测试。有人可以帮我吗？

我搜索了一些示例，但一无所获。如果 TunePareto 不允许这样做，我会很高兴听到替代方案。

谢谢 ！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:03:37.210

[从文档](http://cran.r-project.org/web/packages/TunePareto/TunePareto.pdf)中，该函数`tuneParetoClassifier`似乎有一个参数`testDataName`，您可以在其中提供独立的测试数据集。这是函数的定义：

```
tuneParetoClassifier(name, classifier, classifierParamNames = NULL, predefinedClassifierParams = NULL, predictor = NULL, predictorParamNames = NULL, predefinedPredictorParams = NULL, useFormula = FALSE, formulaName = "formula", trainDataName = "x", trainLabelName = "y", testDataName = "newdata", modelName = "object", requiredPackages = NULL) 
```

# php - MySQLi 新手，更新查询出错？

> ID：14260911
> 
> 赞同：0
> 
> 时间：2013-01-10T15:05:51.983
> 
> 标签：php, mysqli, prepared-statement

我在尝试解决此查询时遇到了一点问题，如果在表单输入后单击提交按钮，这是页面上“必需”的脚本。该页面已经设置了 $connection 变量，并且值正在正确回显，尽管在第二个嵌套的“IF”语句中我仍然收到“错误”消息回显给我。任何人都可以帮忙吗？谢谢！

```
<?php
if ($_POST['firstname'] != "" && $_POST['lastname'] != "" && $_POST['email'] != "" && $_POST['position'] != "" && $_POST['building'] != "") {
    $iserid = htmlspecialchars($_COOKIE['userid']);
    $fname_input = htmlspecialchars($_POST['firstname']);
    $lname_input = htmlspecialchars($_POST['lastname']);
    $fullname_input = htmlspecialchars($_POST['firstname']) . " " . htmlspecialchars($_POST['lastname']);
    $email_input = htmlspecialchars($_POST['email']);
    $position_input = htmlspecialchars($_POST['position']);
    $building_input = 1;

    $update = $connection->prepare("UPDATE user SET first = ?, last = ?, full = ?, email = ?, position = ?, building = ? WHERE id =  ?") or trigger_error($connection->error);
    $update->bind_param("ssssssi",$fname_input, $lname_input, $fullname_input, $email_input, $position_input, $building_input, $userid);

    if ($update->execute) {
        echo "success";
        $update->close();
    } else {
        echo "fail";
        $update->close();
    }

} else {
    $error = "One or more of your fields was left blank. Please press back on you browser toolbar and try again or click here to close this message.";
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:12:17.013

改变

```
if($update->execute) 
```

和

```
if($update->execute()) 
```

# django - 使用 POST 而不是 GET 强制调用 Django 视图方法

> ID：14260913
> 
> 赞同：0
> 
> 时间：2013-01-10T15:05:57.003
> 
> 标签：django

我有一个 Django 视图方法（我们称它为方法 A），`GET`对`POST`. 如果通过调用方法 A `POST`，它会显示一个包含表单的 HTML 页面。

一旦用户提交了这个表单，表单就会调用另一个方法（方法 B）`views.py`来检查表单是否有效。如果表单包含错误，我想返回上一页并显示错误。

如何“返回上一页”？或者我基本上要问的是 - 从方法 B，我如何调用方法 A，`POST`以便再次显示我以前的带有表单的 HTML 页面？

请假设我没有使用 Django 表单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:11:11.187

您可能会考虑将 POST 错误重定向回页面本身以及有关显示的错误消息的一些信息。否则，我不确定您为什么要这样做，但我相信您有充分的理由 :)

# sql - 在 SQL Server 2000 中查找存储过程名称及其内容

> ID：14260914
> 
> 赞同：13
> 
> 时间：2013-01-10T15:05:57.347
> 
> 标签：sql, stored-procedures, sql-server-2000

对于存储过程，我有它的完整源代码。但是该存储过程的**名称**已经丢失。在这个数据库中，有数百个存储过程。

那么有没有一种方法可以通过使用存储过程的内容或使用内容中的任何变量来找出存储过程的**名称？**

这让我很困惑。真诚的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-10T15:09:22.753

尝试这个：

```
select * from sysobjects where id in 
(select id from syscomments where text like '%exec%')
order by [name] 
```

其中 'exec' 是您要搜索的文本。此查询也将搜索视图，仅供参考

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-10T15:16:16.813

如果存储过程的文本未加密，Sql Server 会将过程的全文保存在`syscomments`表中，并带有一个`id`引用`sysobjects`表的字段，其中存储了实际名称。

因此，从存储过程中找到一些不太可能在其他地方的代表行，然后执行以下操作：

```
select o.name, c.text 
from syscomments c
   inner join sysobjects o on o.id = c.id
where c.text like '%<representative_line>%'
  and o.type='P' -- this means filter procedures only 
```

希望这应该只返回一些您可以手动检查的程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-12T19:03:32.953

还有另一种方法，更具可读性和令人难忘：

```
SELECT ROUTINE_NAME, ROUTINE_DEFINITION 
    FROM INFORMATION_SCHEMA.ROUTINES 
    WHERE ROUTINE_DEFINITION LIKE '%AlgunaPalabraQueTeAcuerdes%' 
    AND ROUTINE_TYPE='PROCEDURE' 
```

这至少在 sql 2008 和更新版本中有效。[富恩特](http://www.marioperez.com.mx/blog/find-stored-procedure-full-text/ "富恩特")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-11T03:17:07.250

```
select object_name(id) from syscomments where text like '%exec%' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T15:11:42.007

试试这个查询，它会得到包含给定单词或字段的过程名称

```
 SELECT Name 
        FROM sys.procedures 
        WHERE OBJECT_DEFINITION(object_id) LIKE '%Any-Field (OR) WORD%' 
```

# python - 如何在 Python 中随机生成递减数字？

> ID：14260923
> 
> 赞同：4
> 
> 时间：2013-01-10T15:06:50.570
> 
> 标签：python, random, python-2.7, numbers

我想知道是否有办法在一定范围内生成递减数字？我想编程保持输出直到它达到0，并且范围内的最大数字必须是正数。

例如，如果范围是 (0, 100)，这可能是一个可能的输出：96 57 43 23 9 0

很抱歉我原来的帖子造成了混乱

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-10T15:08:36.080

我会生成一个包含 n 个随机数的列表，然后将它们从高到低排序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-10T23:42:35.917

几乎没有什么需要注意的。从每一步开始的算法`X > 0`都取一个随机数`(0,X)`并`X`用它替换是不好的。为什么？因为（假设`random`行为正常）每一步的期望值都在区间的中间`(0,X)`。这意味着这些数字的序列有望收敛`0`到`(1/2)^N`。确实可以很容易地看出，大多数数字都接近`0`，即使对于巨大的初始值也是如此。这意味着这些数字的分布并不均匀，这是大多数时候所期望的属性。

这是一个主要缺点，即使生成`N`th 数字的复杂性是`O(N)`并且（更重要的是）内存使用量是`O(1)`。

另一种解决方案是只取`N`随机数并对它们进行排序。这还不错，虽然这个算法的复杂度是（或者说与底层排序算法的复杂度相同），如果我们将元素按顺序而不是排序，`O(N log(N))`可以降低到，但是内存使用是- 我们必须记住所有元素。然而，这些数字将均匀分布，这是一个很大的优势！`O(N)``O(N)`

[按照 Jon Louis Bentley 的论文“生成随机数的排序列表](http://repository.cmu.edu/cgi/viewcontent.cgi?article=3483&context=compsci)”中的想法，这里的算法可能是最优化的算法（至少我知道）并产生均匀分布的数字：

```
import math
import random

def generate( min = 0, max = 10, number = 100 ):
    start = 0
    for i in xrange( number, 0, -1 ):
        start = start + math.log( random.random( ) ) / i
        next = math.exp( start ) * ( max - min ) + min
        yield next

for number in generate( ):
    print number 
```

请注意，该算法的复杂性仍然存在`O(N)`（我怀疑它可以降低），但内存使用量是`O(1)`并且这些数字均匀分布在区间内`(min,max)`，这不是那么明显，但确实如此。唯一的缺点是我们必须在开始之前知道要生成多少个数字。

也看看这个线程：

[在没有排序的情况下生成排序的随机整数？上）](https://stackoverflow.com/questions/1866031/generating-sorted-random-ints-without-the-sort-on)

可能有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T15:12:05.393

喜欢：

```
from random import random
min=0
max=10
oldval=1.

while True:
  oldval=oldval*random()
  randval=min+(max-min)*oldval 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-10T15:12:43.840

这里有一些选择。这应该产生接近卡方分布的值，后面的值从比早期值更小的范围中选择：

```
import random
random_range = range(10) 
numbers = [random.choice(random_range[:i]) for i in range(10, 0, -1)] 
```

这也可以用浮点数来完成：

```
import random
max = 10.0
min = 0.0
desired = 100
step = (max - min) / desired
numbers = [random.random() * (max - (i * step)) for i in range(desired)] 
```

或者，从递减的滑动窗口中选择随机值可以提供均匀分布。

```
import random, numpy
max = 10.0
min = 0.0
desired = 100
step = float(min - max) / desired
window = 1.0
numbers = [x + (random.random() * window) - (window / 2.0) for x in numpy.arange(max, min, step)] 
```

如果需要一个单调递减的数字列表，那么设置`window <= step`将提供一个。祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-10T15:40:58.857

基于@brentlance 的想法，这将适用于任何整数范围、正数、负数或两者：

```
import random

random_decreasing_integers_from_range = (i for i in xrange(max, min - 1, -1) if random.random() > .5) 
```

如果您希望能够指定输出的数量，这里有一个尝试，至少尝试保持整个范围内的分布有点均匀：

```
import random

def random_decreasing_integers_from_range(min, max, num_outputs):
    range_size = abs(max - min)
    if range_size < num_outputs:
        raise ValueError('Distance from min to max must be equal to or greater than num_outputs.')
    output_count = 0
    for iteration, value in enumerate(xrange(max, min - 1, -1)):
        # if we only have enough values left to satisfy the number requested,
        # yield value
        if num_outputs - output_count == range_size - iteration + 1:
            output_count += 1
            yield value
        # else yield value randomly, weighted by how far in to the range we are
        # and how many values we have left to yield of the total requested
        else:
            ratio_consumed = float(iteration + 1) / range_size
            ratio_yielded = float(output_count) / num_outputs
            if random.random() < (1 - ratio_yielded) * ratio_consumed:
                output_count += 1
                yield value
        # if we've yielded the requested number of values, stop
        if output_count == num_outputs:
            break 
```

这工作得相当好，但是当 num_outputs 不在 range_size 的大约 10% 到 25% 之间时，它似乎会崩溃。在下限处，确实显示出偏向范围的中间，而在上限处，短路条件开始导致结果真正偏向范围的下限。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-13T20:42:04.857

谢谢大家的回答。但是我找到了解决我自己问题的方法，我认为这很简单，我想与大家分享。

```
import random
i = 1000000  

while i > 0:
    i = random.randint(0, i)
    print i 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-10T15:46:44.587

不是python专家......但这是我的基本想法：

```
a=10000
for i in range(1,50):
   b=random.randint(1,a)
   print(b)
   a=b 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-10T15:21:04.760

这将使您在 0..1 范围内减少随机数。

```
import random
def generate():
    n = 1.0
    while n:
        n = random.random() * n
        yield n
iterator = generate()
iterator.next() 
```

请注意，由于浮点数的精度有限，数字不可避免地会达到 0，因此该函数会在一段时间后停止生成数字。

# razor - 在 Post 之后将下拉列表的描述字段返回给模型

> ID：14260925
> 
> 赞同：0
> 
> 时间：2013-01-10T15:07:00.403
> 
> 标签：razor, asp.net-mvc-4

在我的模型中，我有一个类别类型的字段。

```
...
public Category Category { get; set; }
... 
```

Category 类与此类似：

```
public class Category 
{
    public int Id { get; set; }
    public string Description { get; set; }
} 
```

在我看来，我正在为 DropDownLists 使用 HtmlHelper：

```
@Html.DropDownListFor(m => m.Category.Id, new SelectList(Model.Categories, "Id", "Description")) 
```

当我**发布**我的表单时，模型上的 Category 字段设置为 Category 对象的实例，该对象的 Id 值设置正确。

描述字段为空。我知道整个类没有序列化并传递给客户端，对于复杂的类，我不一定想要这样。同样对于很多情况，我可以简单地使用 Id 来找到正确的元素。

是否很难将描述字段也返回到模型中，以便我可以使用该字段？

如果有怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:13:00.657

> 是否很难将描述字段也返回到模型中，以便我可以使用该字段？

唯一的方法是使用 javascript。HTML 中没有任何内容允许您发送`<option>`标签的文本。只有值被发送到服务器。

所以基本上你必须订阅`onchange`这个下拉列表的事件，检索所选元素的文本并将其填充到具有正确名称的隐藏字段中。

因此，表单中具有正确名称的隐藏字段：

```
@Html.HiddenFor(m => m.Category.Description, new { id = "description" }) 
```

然后给你的下拉列表一个 id：

```
@Html.DropDownListFor(
    m => m.Category.Id, 
    new SelectList(Model.Categories, "Id", "Description"),
    new { id = "category" }
) 
```

最后订阅：

```
$('#category').change(function() {
    var description = $(this).find('option:selected').text();
    $('#description').val(description);
}); 
```

但是，如果您希望我对您完全诚实：请不要这样做，而只需使用发送到您服务器的选定 id 从您的底层后端检索描述。

# ios - 是否可以在 iPod.app 中获取当前正在播放的歌曲？

> ID：14260927
> 
> 赞同：0
> 
> 时间：2013-01-10T15:07:01.450
> 
> 标签：ios, objective-c, mpmediaplayercontroller

在 iPhone/iPod touch 中，当前媒体播放器控件位于屏幕底部，其中还显示了当前播放歌曲的标题。它可以是任何应用程序，而不仅仅是 iPod.app。据我所知，`MPMediaPlayerController`只有`iPodMusicPlayer`获取当前媒体播放器的方法。但是有可能以某种方式从任何应用程序中获取当前正在播放的歌曲吗？

# c# - Ajax 分页与 MVC 4 中的部分消失

> ID：14260929
> 
> 赞同：0
> 
> 时间：2013-01-10T15:07:05.770
> 
> 标签：c#, asp.net, ajax, jquery, pagination

我正在使用 Ajax 填充部分。

当我单击主页上的链接时，部分正确填充。如果我单击另一个链接（它们的列表），它会重新填充。

在我的部分里面，我有一个属性表。一旦我单击页面按钮或标题（按顺序），表格就会消失。并且该列表不再能够重新填充。

有谁知道为什么？

`Properties.cshtml`部分的。

```
@model IEnumerable<ns.Models.Property>

@{
    WebGrid table = new WebGrid(ajaxUpdateContainerId: "properties-partial");
    table.Bind(Model);
}

@table.GetHtml() 
```

我的`main.cshtml`页面。

```
<div id="properties-partial">
</div>

    @Ajax.ActionLink(
        item.Title,
            "Properties",
            "Home",
            new { propertyId = item.propertyId},
            new AjaxOptions { UpdateTargetId = "properties-partial" }) 
```

我检查了在 Firefox 中进行的调用，并直接输入了 url，看起来很好（显示正确的数据页面）。就像它在分页后无法附加到部分，然后从那时起打破它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T16:13:16.103

解决方案是将表格包装在部分内部的自己的 div 中。并将其指定为`ajaxUpdateContainerID`.

```
@model IEnumerable<ns.Models.Property>

@{
    WebGrid table = new WebGrid(Model, ajaxUpdateContainerId: "tablediv");

}
<div id="tablediv">
    @table.GetHtml()
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:47:41.003

甚至我也遇到了与局部相同的问题，并且能够通过执行以下操作来克服：

```
@model IEnumerable<ns.Models.Property>

@{
    if (Model != null && Model.Count > 0)
    {
        var testWebGrid = new WebGrid(Model, canPage: true, rowsPerPage: 10, ajaxUpdateContainerId: "testTableDiv");
        <div id="testTableDiv">
           <div id="testGridDiv">
               @testWebGrid.GetHtml(mode: WebGridPagerModes.All, footerStyle: "pager")
            </div>
            @testWebGrid.Pager()

         </div>
    }
 } 
```

jQuery（使用其类删除实际的分页栏）：

```
$(document).ready(function () {
    $(".pager").remove();
}); 
```

希望这可以帮助！！

# coredump - 在 lxc 来宾上未生成核心转储

> ID：14260930
> 
> 赞同：0
> 
> 时间：2013-01-10T15:07:08.980
> 
> 标签：coredump, lxc

对于主机和 lxc 来宾上的核心文件，我将 ulimit 设置为无限制，即使对于主机上的 root，我也可以在主机上生成核心文件，但不能在 lxc 来宾上生成核心文件。lxc 中是否有任何用于生成核心文件的配置？

我的主机是 ubuntu 12.04，lxc 的客人是 centos 5。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-09T10:34:53.140

检查您是否安装了任何 apport 软件包（apport apport-gtk apport-kde）。问题是 apport 包，它通过设置 /proc/sys/kernel/core_pattern 来重定向核心转储（有关更多信息，请参见 man core）。快速解决方案可能是： sudo aptitude remove apport apport-gtk apport-kde

# ruby - Ruby 从内部类访问常量

> ID：14260931
> 
> 赞同：0
> 
> 时间：2013-01-10T15:07:13.940
> 
> 标签：ruby, constants, inner-classes

我有一个像这样的嵌套类：

```
class Mammal
    H = "Mammal"

    class Human
        H = "Human"
    end

end 
```

我想制作一个 Human 对象并在访问 Human 的常量之后，如下所示：

```
human = Mammal::Human.new # makes an object successfully

puts human::H             # does not work **
puts Mammal::Human::H     # works ["Human"]
puts Mammal::H            # works ["Mammal"] 
```

**.. 但它不起作用（“..不是类/模块 [TypeError]”）。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T15:11:12.563

> 我究竟做错了什么？

您试图从错误的上下文中引用一个常量。常量是在类对象中定义的，而不是在实例中。这有效：

```
human = Mammal::Human.new
human.class.const_get(:H) # => "Human" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:13:56.553

常量属于类，因此通过`::`运算符的常量解析仅适用于类对象，不适用于类的实例。

话虽如此，您可以这样做：

```
human.class::H 
```

`Object#class`返回对象的类，相对于您可以解析常量。

# java - 在 ServiceMix 4 中更改 ActiveMQ 端口

> ID：14260932
> 
> 赞同：3
> 
> 时间：2013-01-10T15:07:24.117
> 
> 标签：java, apache-camel, activemq, esb, apache-servicemix

我在更改 ServiceMix 中的 ActiveMQ 端口时遇到问题。

我在 /etc/system.properties 中设置了适当的属性：activemq.port = 61617

然后，在 etc/activemq-broker.xml 中，我确保它正在使用新端口。我没有做任何进一步的改变。然后我重新启动/更新并刷新了 SMX4 中的所有捆绑包。之后我用 netstat 检查了我的网络接口，它显示 SMX 4 正在使用新端口 - 61617。

之后，我部署了我的包（它在 ActiveMQ 的默认配置上完美运行），它正在向 activemq 添加一条消息，然后读取它并返回丰富的响应。

它不起作用，在日志中我可以看到这个错误：2013-01-10 16:02:07,519 | 调试 | ActiveMQ 任务 1 | 故障转移传输 | ? ? | 49 - org.apache.activemq.activemq-core - 5.5.1 | 尝试连接到：tcp://localhost:61616

删除 /data 目录会产生随机错误——比如找不到“ServiceMix Util Bunlde”——而且真的找不到，因为在那种操作之后我必须手动安装它。

对此有什么想法吗？我的目标是通过 ActiveMQ 将 ServiceMix 配置为集群。也许有一些建议？

# ios - 减少我的应用程序的内存

> ID：14260934
> 
> 赞同：0
> 
> 时间：2013-01-10T15:07:31.893
> 
> 标签：ios, xcode, memory-management, uitabbarcontroller

我几乎完成了我的第一个应用程序（漫长但有趣的时光）

我正在尝试一周来减少应用程序的内存使用量，但如果这不起作用，我想确保它在使用后释放视图，但我发现这不会发生......

我对 searchviewController 没有内存问题，它更多的是使用 100 mb ram 的 DetailsViewController。

我将尝试在摘要中展示我的应用程序是如何构建的：

```
Searchview controller 

The main screen --> UIViewController with tableview 

in the didSelectRowAtIndex i have:

    DetailsViewController *controller = [[DetailViewsController alloc]initWithNibName:@"DetailsViewController" bundle:nil];

    SearchResult *searchResult = [searchResults objectAtIndex:indexPath.row];
    controller.searchResult = searchResult;

DetailsViewController 
```

详细屏幕是在选择一行时调用的，它的Uiview具有一个子视图（自定义scrollView），自定义scrollview具有icarousel（custom uiview）

```
.h

@property (nonatomic,weak) SearchResult *searchResult;

.m

@property (nonatomic, retain) iCarousel *carousel;
@property (nonatomic, retain) UINavigationItem *navItem; 
```

执行：

```
 MGBox *tablesGrid, *table1; 
```

ViewDidLoad：

```
//Add barButton
UIBarButtonItem *reactButton = [[UIBarButtonItem alloc]..];
carousel = [[iCarousel alloc] init..];

//Add Tablesgrid
tablesGrid = [MGBox boxWithSize:tablesGridSize];
tablesGrid.contentLayoutMode = MGLayoutGridStyle;
[self.scrollview.boxes addObject:tablesGrid];

//Add Table
table1 = MGBox.box;
[tablesGrid.boxes addObject:table1]; 
```

在此之后，我具有将 searchResult 添加到标签并填充 icarousel（最多 6 个项目）的功能，icarousel 是一个 uiview，我将其作为子视图添加到 scrollview 等。

当我推回导航栏并返回主视图控制器时，它不会释放视图，为什么？（nslogged dealloc 但从未被调用）。内存警告后，它调用 ViewDidUnload 并释放一些内存，但仍然没有释放 ....

我没有参考其他对象，对吗？除了 searchResult 但我将它设置为弱所以它不应该是参考权？

一些信息：

***在主视图上搜索后，我有：***

实时字节：5,75 mb 实时：27.342 瞬态：68.200 总字节：25.30 mb

***选择一行并进入 detailsViewController 后，我有：***

实时字节：5.4 mb 实时：32.498 瞬态：76.488 总字节：29.55 MB

***拖动icarousel的子视图行后（看图）：***

实时字节：5.5 mb 实时：32.798 瞬态：122.850 总字节：36.41 MB

***在自定义表格视图中选择一些表格后***

实时字节：5.7 mb 实时：33.508 瞬态：161.80 总字节：40.12 MB

***在应用程序中打开链接并返回后（在模式视图中打开并再次关闭它）***

实时字节：6.7 mb 实时：43.821 瞬态：371.761 总字节：144.95 MB

***单击图片并全屏显示照片并再次返回 detailscreenview 后（打开模式并关闭）***

实时字节：6.76 mb 实时：43.798 瞬态：400.850 总字节：155.69 MB

如果我回到另一排，它永远不会减少它只会增加

不要对我太苛刻或无缘无故地关闭话题..

给我一些提示或建议，或者如果您不知道“问题”是什么，请向我解释这些是什么：实时字节 - #living - #Transitory - 总体字节 - # 总体

我要感谢这个网站提供的所有信息，因为没有它我永远不会走到现在

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:33:22.567

回答你的问题：

1.  你在导航栏上说“当我向后推时”。我希望你的意思是你“突然”回来了。您推动进入辅助控制器/场景。你弹出回去。请参阅[popViewControllerAnimated](http://developer.apple.com/library/ios/documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006934-CH3-SW3)。同样，每次你`presentViewController`，你都应该有一个关联的`dismissViewControllerAnimated`.

2.  如果使用情节提要，请确保情节提要中没有循环转场（例如，从 A 转至 B，从 B 转至 A）。有关此主题的简要讨论，请参阅[iOS 5.1 中的 ARC 和情节提要未释放内存。](https://stackoverflow.com/questions/10544444/memory-not-releasing-with-arc-and-storyboard-in-ios-5-1/10564901#10564901)

3.  另一种可能性是“强参考周期”（又名“保留周期”）。请参阅[高级内存管理编程指南](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html#//apple_ref/doc/uid/TP40004447-1000810)。任何可能保持对控制器的强引用的东西都可能导致这个问题。不太明显的例子包括重复`NSTimer`对象之类的东西。

* * *

**更新：**

一些关于内存管理的总顾问

*   如果您遇到内存问题，您应该始终通过[静态分析器](http://developer.apple.com/library/ios/#recipes/xcode_help-source_editor/Analyze/Analyze.html)运行您的代码。如果您不使用 ARC，或者如果您使用任何 Core Foundation 调用，这一点尤其重要，但在遇到任何内存问题时，这通常是一个很好的第一步。

*   有关如何使用 Instruments 在您的应用程序中查找泄漏的指导，[请](https://developer.apple.com/library/ios/documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/MemoryManagementforYouriOSApp/MemoryManagementforYouriOSApp.html#//apple_ref/doc/uid/TP40004652-CH11-SW4)参阅使用 Instruments 查找泄漏。

*   有时，当您的内存分配出现峰值时，确定导致峰值的原因很有用。有关如何从您的分配到对这些分配的来源进行更有意义的分析的具体建议，请参阅此[Stack Overflow 答案](https://stackoverflow.com/questions/14104556/ios-app-with-arc-find-who-is-owner-of-an-object/14105056#14105056)的第 4 点。简而言之，突出显示您在分配中无法解释的跳跃，设置底部窗口以显示调用树，隐藏系统库，并查看您的哪些例程正在消耗内存。

# xcode - 使用 StoryBoard 在 Xcode 中命名多个视图

> ID：14260935
> 
> 赞同：2
> 
> 时间：2013-01-10T15:07:32.957
> 
> 标签：xcode, xcode-storyboard

我有一个带有 UIViewController 的故事板。viewController 在 Xcode/StoryBoard 中有很多视图 - 所有视图都显示为“视图”。这很烦人，因为我无法区分它们。- 我想将它们重命名为 View1、View2 等，以便在 Xcode 中区分它们。

我怎样才能做到这一点![Xcode 截图](../Images/fd1333496ed2472818f2958c5fcfcc84.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T23:25:51.657

找到它 - 这是通过 Identity Inspector 选项卡中的标签完成的

# php - 在 SQL 通配符中将 PDO emulate 设置为 false 会导致查询失败

> ID：14260937
> 
> 赞同：0
> 
> 时间：2013-01-10T15:07:33.583
> 
> 标签：php, mysql, pdo, sql-injection

如果我将 PDO emulate 设置为 false，正如我多次阅读的那样，应该为 SQL 注入安全性进行，在`LIKE`查询中使用通配符不会导致输出。

这是设置：

```
$db->setAttribute(PDO::ATTR_EMULATE_PREPARES, false); 
```

这是一个失败的查询：

```
$query = $db->prepare("SELECT * FROM video WHERE name like :search and removed='0' and verified='1' or subgenre like :search and removed='0' and verified='1' LIMIT :lb, :lt");
$query->bindValue(':search', '%'.$search.'%', PDO::PARAM_STR);
$query->bindValue(':lb', $limitbottom, PDO::PARAM_INT);
$query->bindValue(':lt', $limittop, PDO::PARAM_INT);
$query->execute();
$array = $query->fetchAll(PDO::FETCH_ASSOC); 
```

如果我删除 emulate 设置，查询将按预期运行并返回一个数组。如果我正确理解了所有内容，则应在脚本中将 emulate 设置为 false 以防止 SQL 注入。我该如何纠正？是否可以`like`使用通配符和仿真进行查询？

PHP 是 5.4.10 & MySQL 是 5.1.66

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T14:22:21.683

问题是该参数`:search`已经使用了两次，并且在关闭仿真的情况下不支持。

这解决了这个问题：

```
$query = $db->prepare("SELECT * FROM video WHERE name like :search1 and removed='0' and     verified='1' or subgenre like :search2 and removed='0' and verified='1' LIMIT :lb, :lt");
$query->bindValue(':search1', '%'.$search.'%', PDO::PARAM_STR);
$query->bindValue(':search2', '%'.$search.'%', PDO::PARAM_STR);
$query->bindValue(':lb', $limitbottom, PDO::PARAM_INT);
$query->bindValue(':lt', $limittop, PDO::PARAM_INT);
$query->execute();
$array = $query->fetchAll(PDO::FETCH_ASSOC); 
```

现在查询将按预期返回数组。

# cuda - 减少CUDA中的矩阵行或列

> ID：14260938
> 
> 赞同：5
> 
> 时间：2013-01-10T15:07:33.427
> 
> 标签：cuda, cublas

我正在使用 CUDA`cuBLAS`来执行矩阵运算。

我需要对矩阵的行（或列）求和。目前我通过将矩阵与一个向量相乘来做到这一点，但这似乎并不那么有效。

有没有更好的办法？中找不到任何东西`cuBLAS`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T18:07:27.593

实际上，将矩阵与一个向量相乘`cublas_gemv()`是一种非常有效的方法，除非您正在考虑手动编写自己的内核。

您可以轻松分析`cublas_gemv()`. 非常接近于一次简单地读取整个矩阵数据，可以看作是矩阵行/列求和的理论峰值性能。

额外的操作“x1.0”不会导致性能大幅下降，因为：

1.  `cublas_gemv()`基本上是内存带宽限制操作，额外的算术指令不会成为瓶颈；
2.  [FMA](http://en.wikipedia.org/wiki/Fused_multiply%E2%80%93add)指令进一步降低指令吞吐量；
3.  个向量的 mem 通常比矩阵的要小得多，并且可以很容易地被 GPU 缓存以减少到 mem 带宽。

`cublas_gemv()`还可以帮助您处理矩阵布局问题。它适用于行/列主要和任意填充。

我也问[过类似的问题](https://stackoverflow.com/questions/14211093/how-to-normalize-matrix-columns-in-cuda-with-max-performance)。我的实验表明`cublas_gemv()`比分段 reduce using 更好`Thrust::reduce_by_key`，这是矩阵行求和的另一种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-16T12:44:14.997

与此相关的帖子包含有关同一主题的有用答案，可在

[使用 CUDA 减少矩阵行](https://stackoverflow.com/questions/17862078/reduce-matrix-rows-with-cuda)

和

[使用 CUDA 减少矩阵列](https://stackoverflow.com/questions/21428378/reduce-matrix-columns-with-cuda)。

在这里，我只想指出如何通过将行乘以同一矩阵来减少矩阵列的方法可以推广到执行向量集合的**线性组合**。换句话说，如果要计算以下**向量基展开**

[![在此处输入图像描述](../Images/03ed8eccfc8e39a833db59dd1e276def.png)](https://i.stack.imgur.com/2qcGw.gif)

其中`f(x_m)`是函数的样本`f(x)`，而`\psi_n`是基函数，`c_n`是扩展系数，那么`\psi_n`可以在`N x M`矩阵中组织，系数`c_n`在行向量中，然后使用计算向量 x 矩阵乘法`cublas<t>gemv`.

下面，我报告了一个完整的示例：

```
#include <cublas_v2.h>

#include <thrust/device_vector.h>
#include <thrust/random.h>

#include <stdio.h>
#include <iostream>

#include "Utilities.cuh"

/********************************************/
/* LINEAR COMBINATION FUNCTION - FLOAT CASE */
/********************************************/
void linearCombination(const float * __restrict__ d_coeff, const float * __restrict__ d_basis_functions_real, float * __restrict__ d_linear_combination,
                       const int N_basis_functions, const int N_sampling_points, const cublasHandle_t handle) {

    float alpha = 1.f;
    float beta  = 0.f;
    cublasSafeCall(cublasSgemv(handle, CUBLAS_OP_N, N_sampling_points, N_basis_functions, &alpha, d_basis_functions_real, N_sampling_points, 
                               d_coeff, 1, &beta, d_linear_combination, 1));

}

void linearCombination(const double * __restrict__ d_coeff, const double * __restrict__ d_basis_functions_real, double * __restrict__ d_linear_combination,
                       const int N_basis_functions, const int N_sampling_points, const cublasHandle_t handle) {

    double alpha = 1.;
    double beta  = 0.;
    cublasSafeCall(cublasDgemv(handle, CUBLAS_OP_N, N_sampling_points, N_basis_functions, &alpha, d_basis_functions_real, N_sampling_points, 
                               d_coeff, 1, &beta, d_linear_combination, 1));

}

/********/
/* MAIN */
/********/
int main()
{
    const int N_basis_functions = 5;     // --- Number of rows                  -> Number of basis functions
    const int N_sampling_points = 8;     // --- Number of columns               -> Number of sampling points of the basis functions

    // --- Random uniform integer distribution between 10 and 99
    thrust::default_random_engine rng;
    thrust::uniform_int_distribution<int> dist(10, 99);

    // --- Matrix allocation and initialization
    thrust::device_vector<float> d_basis_functions_real(N_basis_functions * N_sampling_points);
    for (size_t i = 0; i < d_basis_functions_real.size(); i++) d_basis_functions_real[i] = (float)dist(rng);

    thrust::device_vector<double> d_basis_functions_double_real(N_basis_functions * N_sampling_points);
    for (size_t i = 0; i < d_basis_functions_double_real.size(); i++) d_basis_functions_double_real[i] = (double)dist(rng);

    /************************************/
    /* COMPUTING THE LINEAR COMBINATION */
    /************************************/
    cublasHandle_t handle;
    cublasSafeCall(cublasCreate(&handle));

    thrust::device_vector<float>  d_linear_combination_real(N_sampling_points);
    thrust::device_vector<double> d_linear_combination_double_real(N_sampling_points);
    thrust::device_vector<float>  d_coeff_real(N_basis_functions, 1.f);
    thrust::device_vector<double> d_coeff_double_real(N_basis_functions, 1.);

    linearCombination(thrust::raw_pointer_cast(d_coeff_real.data()), thrust::raw_pointer_cast(d_basis_functions_real.data()), thrust::raw_pointer_cast(d_linear_combination_real.data()),
                      N_basis_functions, N_sampling_points, handle);
    linearCombination(thrust::raw_pointer_cast(d_coeff_double_real.data()), thrust::raw_pointer_cast(d_basis_functions_double_real.data()), thrust::raw_pointer_cast(d_linear_combination_double_real.data()),
                      N_basis_functions, N_sampling_points, handle);

    /*************************/
    /* DISPLAYING THE RESULT */
    /*************************/
    std::cout << "Real case \n\n";
    for(int j = 0; j < N_sampling_points; j++) {
        std::cout << "Column " << j << " - [ ";
        for(int i = 0; i < N_basis_functions; i++)
            std::cout << d_basis_functions_real[i * N_sampling_points + j] << " ";
        std::cout << "] = " << d_linear_combination_real[j] << "\n";
    }

    std::cout << "\n\nDouble real case \n\n";
    for(int j = 0; j < N_sampling_points; j++) {
        std::cout << "Column " << j << " - [ ";
        for(int i = 0; i < N_basis_functions; i++)
            std::cout << d_basis_functions_double_real[i * N_sampling_points + j] << " ";
        std::cout << "] = " << d_linear_combination_double_real[j] << "\n";
    }

    return 0;
} 
```

# javascript - jQuery中的自定义属性事件

> ID：14260942
> 
> 赞同：0
> 
> 时间：2013-01-10T15:07:49.087
> 
> 标签：javascript, jquery, jquery-events, dispatchevent

我使用以下代码拦截 iframe 中的所有点击事件：

```
$(doc.body).on("click", function(e) {
    if (e.from === undefined) {
        e.preventDefault();
        e.stopPropagation();
        interceptEvent(e);
    }
} 
```

发送一条 XML 消息（带有原始 e.target的`interceptEvent(e)`路径）该消息被以下函数捕获（在另一个浏览器上）：

```
if (document.createEvent) { //Netscape
    var evt = document.createEvent("HTMLEvents");
    evt.initEvent(value, false, true);
    evt.from = 'trigger'; //trigger for recognize a XML programmatically event
    return !$('.browser').contents().find(path)[0].dispatchEvent(evt);
} 
```

此函数的目标是复制事件。为了避免循环（拦截在其他浏览器上也处于活动状态），我添加到`dispatchedEvent`属性“from”。

尽管如此，`e.form`总是`undefined`，我错在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:18:21.410

似乎你使用 jQuery，对吧？

jQuery 事件没有**来自**的属性，仅规范化以下事件属性：

*   目标
*   相关目标
*   第X页
*   第Y页
*   哪一个
*   元密钥

如果您想通过事件传递自定义属性，您需要使用 jQuery 本身触发您的自定义事件。[http://api.jquery.com/category/events/event-object/](http://api.jquery.com/category/events/event-object/)或访问原始事件`event.originalEvent`

# c# - Wpf DataGrid SelectedItem 在单元格编辑后失去绑定

> ID：14260943
> 
> 赞同：5
> 
> 时间：2013-01-10T15:07:50.637
> 
> 标签：c#, wpf, wpfdatagrid

我有一个`DataGrid`项目集合（规则）。如果我在 DataGrid 中手动编辑这些项目之一，似乎`SelectedItem`网格上的绑定停止工作（`RuleListViewModelPropertyChanged`在控制器中不再被调用）。但只有当我实际更改单元格中项目的值时，否则`SelectedItem`会继续正常工作。

我已经剥离了一些不相关的代码，所以这基本上就是我所拥有的。首先，我有以下内容`DataGrid`：

```
<DataGrid x:Name="RuleTable" Grid.Row="1" Grid.ColumnSpan="2" ItemsSource="{Binding Rules}" SelectedItem="{Binding SelectedRule, Mode=TwoWay}" 
               BorderThickness="0" >
        <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding TargetValue, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, 
                                  ValidatesOnExceptions=True, NotifyOnValidationError=True}" 
                                Header="{x:Static p:Resources.TargetValue}" Width="*" ElementStyle="{StaticResource TextCellElementStyle}"
                                EditingElementStyle="{StaticResource TextCellEditingStyle}"/>
        </DataGrid.Columns>
    </DataGrid> 
```

`ViewModel`看起来像这样：

```
public class RuleListViewModel : ViewModel<IRuleListView>
{
    private IEnumerable<Rule> rules;
    private Rule selectedRule;

    public RuleListViewModel(IRuleListView view)
        : base(view)
    {
    }

    public RuleListViewModel() : base(null) {}

    public IEnumerable<Rule> Rules
    {
        get
        {
            return rules;
        }
        set
        {
            if (rules != value)
            {
                rules = value;
                RaisePropertyChanged("Rules");
            }
        }
    }

    public Rule SelectedRule
    {
        get
        {
            return selectedRule;
        }
        set
        {
            if (selectedRule != value)
            {
                selectedRule = value;
                RaisePropertyChanged("SelectedRule");
            }
        }
    }
} 
```

最后一个`Controller`看起来像这样：

```
public class RuleController : Controller
{
    private readonly IShellService shellService;
    private readonly RuleListViewModel ruleListViewModel;

    private readonly DelegateCommand addRuleCommand;
    private readonly DelegateCommand deleteRuleCommand;

    [ImportingConstructor]
    public RuleController(IShellService shellService, IEntityService entityService, RuleListViewModel ruleListViewModel)
    {
        this.shellService = shellService;
        this.ruleListViewModel = ruleListViewModel;
    }

    public void Initialize()
    {
        AddWeakEventListener(ruleListViewModel, RuleListViewModelPropertyChanged);
        shellService.RuleListView = ruleListViewModel.View;

        List<Rule> rules = GetRules();
        ruleListViewModel.Rules = new ObservableCollection<Rule>(rules);
    }

    private void RuleListViewModelPropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        if (e.PropertyName == "SelectedRule")
        {
            // This never gets called after edit
        }
    }
} 
```

我真的不知道问题出在哪里，但是由于我实际上必须更改值才能体验这种行为（仅单击单元格而不编辑任何内容都可以正常工作）我猜这与`SelectedItem`绑定中断有关我更改绑定到它的项目的值？！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-03-18T22:41:45.030

对于遇到此线程并且您正在使用 ObservableCollection 的任何人 - 检查您是否覆盖 GetHashCode() （我正在通过 IEquatable 进行相等性测试）。一旦您对单元格进行更改，与 SelectedItem 和 SelectedIndex 的绑定就会中断。

来自 MSDN（[https://msdn.microsoft.com/en-us/library/system.object.gethashcode](https://msdn.microsoft.com/en-us/library/system.object.gethashcode(v=vs.110).aspx) (v=vs.110).aspx ）：

> “当对象包含在依赖于其哈希码的集合中时，您可以确保可变对象的哈希码不会改变。”

当然，我得到了可编辑（即可变）字段的哈希值......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T16:44:57.580

我认为这是因为 datagrid 使用 Bindingroups，所以当您输入单元格时，每个 UI 事件都会被绕过，直到您验证并离开该行。

阅读这篇文章可能会有所帮助：[WPF DataGrid source updates on cell changed](https://stackoverflow.com/questions/5028556/wpf-datagrid-source-updating-on-cell-changed)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T12:14:18.383

所以事实证明这是因为我忘记让我的数据模型继承自`System.Waf.Applications.DataModel`（也许我应该提到我正在使用 WPF 应用程序框架）。

我想这与`PropertyChanged`未处理的事件有关。

# apache - 使用不同的配置文件启动 Apache 失败且没有任何错误消息

> ID：14260944
> 
> 赞同：0
> 
> 时间：2013-01-10T15:07:56.467
> 
> 标签：apache

出于测试目的，我想在本地运行 Apache（最终以非 root 用户身份）并将 Apache 配置文件保存在我的中央存储库中。根据 Apache 文档（[http://httpd.apache.org/docs/2.2/configuring.html](http://httpd.apache.org/docs/2.2/configuring.html)），我可以使用开关设置配置文件，使用`-f`开关设置 ServerRoot `-d`（[http://httpd.apache.org/ docs/2.2/programs/httpd.html](http://httpd.apache.org/docs/2.2/programs/httpd.html)）。

现在我的问题是，当我尝试启动 Apache 时

```
sudo apache2 -d $(pwd)/testApacheRootDir/ -f $(pwd)/testApacheRootDir/testingApacheConf -k start 
```

该进程在没有实际启动 Apache（并且没有任何）错误消息的情况下退出。

我知道配置文件已被读取，因为如果文件中有错误，上述命令将打印错误消息。Apache 实际上也使用 ServerRoot 目录，因为（空）`error_log`文件是在`$(pwd)/testApacheRootDir/logs/`.

我的 Apache 配置文件如下所示：

```
Listen 80

NameVirtualHost localhost:80

<VirtualHost localhost:80>
DocumentRoot /var/www/cms
ServerName cms.testing
</VirtualHost>

<VirtualHost localhost:80>
DocumentRoot /var/www/vendor
ServerName vendor.testing
</VirtualHost> 
```

并`apache2 -V`打印：

```
Server version: Apache/2.2.22 (Ubuntu)
Server built:   Nov  6 2012 20:27:25
Server's Module Magic Number: 20051115:30
Server loaded:  APR 1.4.6, APR-Util 1.4.1
Compiled using: APR 1.4.6, APR-Util 1.4.1
Architecture:   64-bit
Server MPM:     Worker
  threaded:     yes (fixed thread count)
    forked:     yes (variable process count)
Server compiled with....
 -D APACHE_MPM_DIR="server/mpm/worker"
 -D APR_HAS_SENDFILE
 -D APR_HAS_MMAP
 -D APR_HAVE_IPV6 (IPv4-mapped addresses enabled)
 -D APR_USE_SYSVSEM_SERIALIZE
 -D APR_USE_PTHREAD_SERIALIZE
 -D APR_HAS_OTHER_CHILD
 -D AP_HAVE_RELIABLE_PIPED_LOGS
 -D DYNAMIC_MODULE_LIMIT=128
 -D HTTPD_ROOT="/etc/apache2"
 -D SUEXEC_BIN="/usr/lib/apache2/suexec"
 -D DEFAULT_PIDLOG="/var/run/apache2.pid"
 -D DEFAULT_SCOREBOARD="logs/apache_runtime_status"
 -D DEFAULT_ERRORLOG="logs/error_log"
 -D AP_TYPES_CONFIG_FILE="mime.types"
 -D SERVER_CONFIG_FILE="apache2.conf" 
```

你有什么建议可能是错的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T08:31:49.440

我不知道为什么错误消息永远不会写入日志文件或控制台输出，但缺少的是用户指令。添加后

```
User    www-data
Group   www-data 
```

一切正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T15:45:14.897

Apache 有时会在解析配置文件之后但在初始化日志记录之前遇到错误。在这种情况下，错误消息会打印到`stderr`，但在您启动 Apache 时会隐藏该进程的任何输出。尝试像这样运行它：

```
apache2 -X -d $(pwd)/testApacheRootDir/ -f $(pwd)/testApacheRootDir/testingApacheConf 
```

该`-X`标志使 Apache 在前台运行：

> -X 在调试模式下运行 httpd。只会启动一名工作人员，并且服务器不会从控制台分离。

这应该允许您查看打印到的任何错误消息`stderr`。

如果这不起作用，这是一个大锤子：

在 的控制下运行 Apache `strace`，然后检查跟踪文件以查看是否可以发现问题。像这样启动 Apache：

```
strace -o trace -f -s 1024 apache2 -X -d $(pwd)/testApacheRootDir/ -f $(pwd)/testApacheRootDir/testingApacheConf 
```

这会将系统调用跟踪写入名为`trace`. 检查这个文件（可能从底部开始）是否有任何`write`包含错误消息的系统调用，或系统调用中的错误（例如，`ENOENT`因为您的配置中指定的目录丢失或输入错误等）。

该`-f`标志要求`strace`跟随分叉，`-s 1024`这意味着它将在对`write`等的调用中记录多达 1024 个字符。

# python - 龙卷风调度器

> ID：14260953
> 
> 赞同：2
> 
> 时间：2013-01-10T15:08:33.673
> 
> 标签：python, asynchronous, tornado

在龙卷风中使用定期回调创建调度程序的最佳方式（模式）是什么：在特定日期时间执行计划作业

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-05-05T12:32:51.937

您应该使用**PeriodicCallback**

**类 tornado.ioloop.PeriodicCallback（回调，callback_time，io_loop=None）**

*安排定期调用给定的回调。每 callback_time 毫秒调用一次回调。*

来自：[龙卷风回调](http://tornado.readthedocs.org/en/latest/ioloop.html#callbacks-and-timeouts)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T09:30:01.080

此链接可能有用：

*   [Tornado IO 循环 - add_timeout](http://www.tornadoweb.org/documentation/ioloop.html#tornado.ioloop.IOLoop.add_timeout)
*   [了解 Tornado 中的代码](http://golubenco.org/2009/09/19/understanding-the-code-inside-tornado-the-asynchronous-web-server-powering-friendfeed/)（查看 Timers 段落）

基本上你可以像这样使用*`add_timeout`*当前*`ioloop`*实例的方法：

```
# Schedule callback to be executed 5 seconds from now
ioloop.IOLoop.instance().add_timeout(time.time() + 5, callback) 
```

希望能帮助到你。

# r - 将未确定数量的栅格与 do.call 和 raster 包相加

> ID：14260957
> 
> 赞同：7
> 
> 时间：2013-01-10T15:08:41.693
> 
> 标签：r, raster

在土壤测绘框架中，我需要对*未确定*数量的栅格求和。我尝试使用 'raster' 包和 'do.call' 函数来做到这一点。但是，如果 'sum' 函数可以对多个栅格进行求和，则使用 do.call 执行相同的操作会导致错误。我究竟做错了什么 ？

```
library(raster)

r1 <- raster(ncol=10, nrow=10)   # dataset for test
values(r1) <- runif(ncell(r1))
r2 <- raster(ncol=10, nrow=10)
values(r2) <- runif(ncell(r2))
r3 <- raster(ncol=10, nrow=10)
values(r3) <- runif(ncell(r3))

sum(r1,r2,r3)    # works nice

do.call(sum,list(r1,r2,r3))

##Erreur dans as.character(sys.call()[[1L]]) : 
##cannot coerce type 'builtin' to vector of type 'character' 
```

谢谢你的帮助，

弗朗索瓦

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T15:25:41.027

您可以使用`Reduce`and`+`从列表中计算总和：

```
Reduce("+",list(r1,r2,r3))
class       : RasterLayer 
dimensions  : 10, 10, 100  (nrow, ncol, ncell)
resolution  : 36, 18  (x, y)
extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 
data source : in memory
names       : layer 
values      : 0.4278222, 2.476625  (min, max) 
```

至于为什么您的原始命令不起作用，这有点令人困惑。将函数名称作为字符提供似乎可行：

```
do.call("sum",list(r1,r2,r3))
class       : RasterLayer 
dimensions  : 10, 10, 100  (nrow, ncol, ncell)
resolution  : 36, 18  (x, y)
extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 
data source : in memory
names       : layer 
values      : 0.4278222, 2.476625  (min, max) 
```

但这在其他情况下不是必需的：

```
do.call(sum,list(1,2,3))
[1] 6 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T05:52:59.927

我不知道为什么这不起作用（正如詹姆斯指出的那样，在 sum 周围没有引号），也许这是与“sum”作为 S4 Summary group generic 的成员相关的错误（或功能）；其他成员，例如“max”和“prod”具有相同的行为。

无论哪种方式，但不是

```
 do.call("sum", list(r1,r2,r3)) 
```

你也可以

```
 sum(stack(r1,r2,r3)) 
```

或者如果你已经有一个列表

```
 sum(stack(list(r1,r2,r3))) 
```

# android - 向当前视图添加线性布局不起作用

> ID：14260960
> 
> 赞同：0
> 
> 时间：2013-01-10T15:08:49.120
> 
> 标签：android, android-layout, android-linearlayout, android-scrollview

我正在尝试将线性布局添加到滚动视图这是我的代码编译的代码，但它没有向我显示新布局

这是原始布局（我想添加到它）

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/ScrollView01"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:scrollbars="vertical" 

android:layout_margin="15dp"
android:layout_marginTop="15dp">

<LinearLayout 
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:paddingBottom="10dp"
    android:paddingLeft="10dp"
    android:paddingRight="10dp" 
     android:id="@+id/ViewHistoryImageLayout">

    <ImageView
        android:id="@+id/HistoryImage"
        android:layout_width="match_parent"
        android:layout_height="0dip"
        android:layout_weight="0.76"
        android:gravity="center"
        android:padding="10dp"
        android:src="@drawable/upload" 
        android:contentDescription="@string/HistoryImage"/>

    <TextView
        android:id="@+id/TranslatedText"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.12"
        android:paddingBottom="10dp"
        android:paddingLeft="10dp"
        android:paddingRight="10dp"
        android:text="@string/translateImageButton" />

</LinearLayout> 
```

这是我想多次添加的布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
android:id="@+id/TranslationMenuLayout" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Medium Text"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<RatingBar
    android:id="@+id/ratingBar1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:numStars="5" />

<TextView
    android:id="@+id/textView2"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="TextView" />

</LinearLayout> 
```

添加新布局的java代码是：

```
setContentView(R.layout.activity_view_history_image);
ScrollView sv = new ScrollView(this);
LayoutInflater inflater = (LayoutInflater) getSystemService( Context.LAYOUT_INFLATER_SERVICE );
View ll = inflater.inflate(R.layout.translation_menu, null);
sv.addView(ll); 
```

代码编译良好，应用程序正在运行，但没有任何反应 .xml 文件之一有问题吗？

tnx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:14:33.307

您应该检索现有的 ScrollView 布局而不是创建它。

```
setContentView(R.layout.activity_view_history_image);
LayoutInflater inflater = (LayoutInflater) getSystemService( Context.LAYOUT_INFLATER_SERVICE );
View ll = inflater.inflate(R.layout.translation_menu, null);
ScrollView sv = (ScrollView) findViewById(R.id.ScrollView01);
sv.addView(ll); 
```

可能有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:11:57.197

我认为您需要将`layout_width`原始文件更改`LinearLayout`为`wrap_content`而不是`match_parent`. 它占据了整个布局

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-18T08:10:36.777

我有同样的问题。我试图在 onSizeChange 上执行此操作，但没有成功。所以这段代码帮助了我：

```
 layout.postDelayed(new Runnable() {
            @Override
            public void run() {

                LinearLayout ll = new LinearLayout(getContext());

                ll.setOrientation(LinearLayout.HORIZONTAL);

                ViewGroup.LayoutParams params = new ViewGroup.LayoutParams(200, ViewGroup.LayoutParams.MATCH_PARENT);

                layout.addView(ll, params);
            }
        }, 100); 
```

layout是ScrollView里面的LinearLayout。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-10T14:42:23.280

我构建了不同的 ImageView 以使其正常工作，如下所示：

```
LinearLayout linearLayout = (LinearLayout) findViewById(R.id.selected_spotphotos_container);
        imageView = new ImageView(getApplicationContext());
        imageView1 = new ImageView(getApplicationContext());
        imageView2 = new ImageView(getApplicationContext());

        imageView.setImageBitmap(bmImg1);
        imageView1.setImageBitmap(bmImg2);
        imageView2.setImageBitmap(bmImg3);

        linearLayout.addView(imageView,0);
        linearLayout.addView(imageView1,1);
        linearLayout.addView(imageView2,2); 
```

XML 代码是这样的：

```
<ScrollView
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" >
<LinearLayout
    xmlns:tools="http://schemas.android.com/tools"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:weightSum="1"
    >
....

<HorizontalScrollView
        android:id="@+id/hori_scroll_view"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:fillViewport="false"
        android:foregroundGravity="left"
        android:paddingBottom="1dp"
        android:paddingTop="1dp"
        android:visibility="visible"
        >

        <LinearLayout
            android:id="@+id/selected_spotphotos_container"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_gravity="left"
            android:animateLayoutChanges="true"
            android:gravity="left"
            android:orientation="horizontal"
            android:visibility="visible"
            >

            <!-- images will be added dynamicall to this layout -->
        </LinearLayout>
    </HorizontalScrollView>
//here u can add different EditText or Button or whatever you want
</LinearLayout> 
```

我希望这可以帮助某人。

# jquery - jquery slideDown 只工作一次

> ID：14260961
> 
> 赞同：2
> 
> 时间：2013-01-10T15:08:49.697
> 
> 标签：jquery, slidedown

我正在使用 jquery 来制作一个向下滑动的菜单。该代码在页面第一次加载时完美运行。但是，slideDown（单击功能的基本部分）对每个菜单项的作用不会超过一次。这是一个 js fiddle 示例[http://jsfiddle.net/74ser/](http://jsfiddle.net/74ser/)。任何帮助将不胜感激。

```
$(document).ready(function() {
        $('.options').live('click',function() {
            console.log(this);
            var current = this.innerHTML;
            var list = listOfeverythingBut ("options", this);
            console.log(list);
            var stringA = new Array() ;
            var stringUl = new Array();
            for (var i =0; i < list.length; i++){
                var item ="."+list[i].innerHTML+"Menu";
                if ( $(item).length === 1){
                     stringA.push("ul"+ item ); 
                     stringUl.push(item + " a"); 
                }
            }
            stringA = stringA.toString();
            stringUl = stringUl.toString();
            console.log(stringA); 
            console.log(stringUl); 
            var currentItem = "." + current + "Menu";
            console.log(currentItem);
            if ( $(currentItem).length === 1){
                console.log("inOf"); 
                var toSlideDown = 'UL' + currentItem;
                console.log(toSlideDown); 
                console.log($(toSlideDown));
                $(toSlideDown).slideDown('medium');

            }
            else {
                $(".bottom").slideUp(20);
                $('.homeContent').delay(30).fadeIn(30);
            }           
            $(stringUl).slideUp('medium');
             moveDiv(this);
            $(stringA).removeClass('press');

            $('.options').removeClass('largeMenuStyle');
            $(this).addClass('largeMenuStyle');

            //setTimeout( function(){moveDiv(this)}, 2000); 
        });
}); 
```

注意：基本代码在`if ( $(currentItem).length === 1)`. 我知道它进入 if 是因为每次运行代码时它都会 console.logs 'inOf'。即使它具有正确的“toSlideDown”变量，它仍然不能多次工作。

我已经参考了这些论坛主题，但我还没有找到我的答案。

[Jquery 每次页面加载只工作一次 - 希望它多次工作而无需重新加载页面](https://stackoverflow.com/questions/9434600/jquery-only-works-once-per-page-load-want-it-work-more-than-once-without-havin)

[JQuery点击事件只工作一次](https://stackoverflow.com/questions/10194728/jquery-click-event-works-only-once)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:12:49.887

很抱歉，您的代码非常棘手，而且 HTML 结构非常错误。

试试我的热修复：http: [//jsfiddle.net/jvLJs/1/](http://jsfiddle.net/jvLJs/1/)

```
 $(toSlideDown + ' a').show();
 $(toSlideDown).hide().slideDown('medium'); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-08-09T00:11:49.097

我认为这应该会有所帮助，尽管这是一个老问题。我一直有同样的问题，我到处搜索以找到一个解决方案，认为我的问题出在我的 jQuery 文件中。然后我查看了我的 css 并发现了问题......如果您在 css 对象中声明了过渡，则基本上 jQuery 动画不起作用。就是这样，或者至少这就是解决我的问题的原因。

# php - 将部分页面加载与 php&ID 链接集成

> ID：14260963
> 
> 赞同：0
> 
> 时间：2013-01-10T15:09:02.163
> 
> 标签：php, jquery, ajax, hyperlink, partial

我试图让部分页面加载工作并且我让它工作但是当我尝试包含一个 php 变量时它不起作用。

页面加载时没有变量；

```
<li><a href="javascript:getContent('showproduct.php')">Die Cast</a></li> 
```

但是当我添加一个变量时；

```
<li><a href="javascript:getContent('showproduct.php&amp;=1')">Die Cast</a></li> 
```

它不起作用。我添加错了吗？

我的代码是：

```
function getContent(url){

 var newUrl=window.location.pathname+"?page="+url;
 $.get(url, function(data) {
  var fileDom = $(data);
  $(".maincontainer").html(fileDom);
  history.replaceState(null, null, newUrl);
 });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:11:34.387

而是尝试传递第二个参数，如下所示 -

```
<li><a href="javascript:getContent('showproduct.php',1)">Die Cast</a></li> 
```

像这样的更新功能-

```
function getContent(url,id){

 var newUrl=window.location.pathname+"?page="+url+"&id="+id;
 $.get(url, function(data) {
  var fileDom = $(data);
  $(".maincontainer").html(fileDom);
  history.replaceState(null, null, newUrl);
 });
} 
```

# jquery - 在 jquery 中触发事件 dragstart 时重新定位元素

> ID：14260967
> 
> 赞同：0
> 
> 时间：2013-01-10T15:09:09.993
> 
> 标签：jquery, jquery-ui, drag-and-drop, draggable

我正在尝试在触发 dragstart 事件时重新定位项目。

在拖动之前，该项目应从鼠标在屏幕上的当前位置重新定位。

重新定位在 dragstart 之前触发的 on mousedown 事件的选项对于我正在寻找的内容没有用。

我正在尝试这种方式：

```
var xMouse = 0;
var yMouse = 0;

$(document).mousemove(function(e){
    xMouse = e.pageX; 
    yMouse = e.pageY;
});

$( "#obj" ).draggable({ 
    revert: false,
    start: function() { 
        $( "#obj" ).css("left", xMouse+"px");
        $( "#obj" ).css("top", yMouse+"px");    
    }
});

$( "#obj" )
.bind('dragstart',function( event ){
    $( "#obj" ).css("left", xMouse+"px");
    $( "#obj" ).css("top", yMouse+"px");                    
})
.bind('drag',function( event){

}) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T15:23:39.307

问题是 jQuery UI 的“拖动”使用绝对定位来移动节点，因此您在拖动开始时的手动定位被完全覆盖。也就是说，您可以使用该`cursorAt` [选项](http://api.jqueryui.com/draggable/#option-cursorAt)将鼠标光标定位在拖动的节点中：

```
$( "#obj" ).draggable({ 
  revert: false,
  cursorAt: { left: 0, top: 0 }
}); 
```

这是一个[jsFiddle](http://jsfiddle.net/BdQbZ/)。

# c# - DynamicDataDisplay D3 固定轴

> ID：14260975
> 
> 赞同：1
> 
> 时间：2013-01-10T15:09:27.000
> 
> 标签：c#, wpf, dynamic-data-display

我正在使用 D3 并排创建多个图形，并且我希望轴的比例相同以及何时更改。我的意思是，在下面的图形中，当我用鼠标移动一个图形的 Y 轴时，我希望上方的图形也移动。

谢谢你的帮助。

图片：http: [//i.stack.imgur.com/l1j5D.png](http://i.stack.imgur.com/l1j5D.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:17:24.347

如果您的意思是您有多个图形并且希望它们都移动相同，那么您将寻找 WidthSpring。Fellice Pollano 在网上有一篇很棒的文章，你可以在[这里查看](http://www.felicepollano.com/2011/05/25/DynamicDataDisplaySynchronizeAxis.aspx)。

# c - 在 C 中使用 Likedlist 和结构的队列实现

> ID：14260976
> 
> 赞同：-1
> 
> 时间：2013-01-10T15:09:30.030
> 
> 标签：c, linked-list, queue, structure

我不明白这段代码有什么问题。在编译期间没有错误，但在执行 Enqueu 的给定选项时，它会突然停止。问题发生在 Queue->rear->next=NULL 附近，在我看来这是正确的。我不知道我哪里错了。

```
struct ListNode
{
       int data;
       struct ListNode *next;
};

struct Queue
{
      struct ListNode *front;
      struct ListNode *rear;
};

struct Queue *createQueue()
{
      struct Queue *Q;
      Q=malloc(sizeof(struct Queue));
      if(!Q)
           return NULL;
      Q->front=Q->rear=NULL;
      return Q;
}

int IsEmptyQueue(struct Queue *Q)
{
      return (Q->front==NULL);
}

int EnQueue(struct Queue *Q,int data)
{
    struct ListNode *newNode;
    newNode=malloc(sizeof(struct ListNode));
    if(!newNode)
               return NULL;
    newNode->data=data;
    newNode->next=NULL;
    Q->rear->next=newNode;
    Q->rear=newNode;
    if(Q->front==NULL)
                Q->front=newNode;
}

int main()
{
    int choice=0,size,n;
    struct Queue *q;
    while(1)
    {
         printf("\nEnter the following");
         printf("\n1\. Create a queue "); 
         printf("\n2.Enqueue");
         printf("\n7.Exit ");
         scanf("%d",&choice);

         switch(choice)
         {
                    case 1:printf("\nCreate Queue");
                           q=createQueue();
                           break;
                    case 2:printf("\nInsert");
                           printf("\nEnter element to be inserted");
                           scanf("%d",&n);
                           EnQueue(q,n);
                           break;

                    case 7:exit(0);
                    break;

      }
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:12:43.230

当队列为空时，其`front`成员`rear`为`NULL`. `EnQueue`然后取消引用`NULL`行中的指针

```
Q->rear->next = newNode; 
```

当它第一次被调用时。该行不是必需的，因此可以简单地删除。

您还可以查看其他一些小错误

*   `createQueue`泄漏`temp`。你显然不需要声明/分配这个
*   `EnQueue`缺少对 malloc 失败的错误处理`newNode`。打印出“newNode Created”在这里有点误导！
*   在`%p`打印出指向队列尾部的指针时用作格式说明符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T15:12:55.347

在`createQueue()`你设置`Q->front`和`Q->rear`到`NULL`但`EnQueue()`你正在使用`Q->rear->next`.

# asp.net-mvc-4 - 无法在创建时设置 Kendo UI 组合框 selectedindex

> ID：14260978
> 
> 赞同：2
> 
> 时间：2013-01-10T15:09:38.373
> 
> 标签：asp.net-mvc-4, kendo-ui, telerik-mvc

我创建了这个组合框：

```
 @(Html.Kendo().ComboBox()
            .Name("cropYear")
            .HtmlAttributes(new { style="width: 75px;"})
            .Placeholder("something")
            .DataTextField("Text")
            .DataValueField("Value")
            .BindTo(new List<SelectListItem>() {
                  new SelectListItem() {
                    Text = DateTime.Now.AddYears(1).Year.ToString(), Value = DateTime.Now.AddYears(1).Year.ToString()   
                  },
                  new SelectListItem() {
                    Text = DateTime.Now.Year.ToString(), Value = DateTime.Now.Year.ToString()   
                  },
                  new SelectListItem() {
                    Text = DateTime.Now.AddYears(-1).Year.ToString(), Value = DateTime.Now.AddYears(-1).Year.ToString()   
                  },
                  new SelectListItem() {
                    Text = DateTime.Now.AddYears(-2).Year.ToString(), Value = DateTime.Now.AddYears(-2).Year.ToString()   
                  },
                  new SelectListItem() {
                    Text = DateTime.Now.AddYears(-3).Year.ToString(), Value = DateTime.Now.AddYears(-3).Year.ToString()   
                  }
              })
              .SelectedIndex(2)
              .Suggest(true)
              .Events(
                events => events.Change("cropYearChanged")
              )
            .Height(200)) 
```

即使我已将 SelectedIndex 设置为 2，它始终为 0。当我尝试在脚本中更改它时：

```
$("#cropYear").data("kendoComboBox").select(1) 
```

我收到一条错误消息，提示无法调用未定义的方法“选择”

如果我触发更改事件，那么我可以访问组合框。我究竟做错了什么？？

# http - 当响应准备好时，我应该关心带有 $http 调用的 AngularJS 工厂吗？

> ID：14260979
> 
> 赞同：4
> 
> 时间：2013-01-10T15:09:51.600
> 
> 标签：http, callback, angularjs

我有类似的工厂，里面有 $http 调用，如下所示：

```
appModule = angular.module('appModule', []);

appModule.factory('Search', function($rootScope, $http) {
  var Search;
  Search = {};
  Search.types: ["bacon"];
  Search.pastEvents = null;
  $http.get('api/highlights').success(function(response) {
    return Search.pastEvents = response.data;
  });
  return Search;
});

var notes_module = angular.module('notes', []);

notes_module.config(['$routeProvider', function ($routeProvider) {

  var notes_promise = ['Notes', '$route', 'Search', function (Notes, $route, Search) {
    //suspect that Search not having pastEvents ready in time of calling index method
    //Notes resource  
    return Notes.index({subject_id: 1 }, Search);    
  }];

  $routeProvider.when('/notes', {
    templateUrl:'index.tpl.html',
    controller:'NotesCtrl',
    resolve:{
      notes: notes_promise,
    }
  });

}]); 
```

我是否应该关心来自 $http 调用的数据何时准备好以及何时初始化/注入该工厂？过去的活动准备好了吗？如果我应该关心我该怎么办？

我怀疑 Search 对象在调用 Notes 资源的 index 方法时没有准备好过去的事件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T18:17:37.747

这取决于：

如果您立即放入 in`$scope`以使用，例如在 a 中`ng-repeat`，则不会。

如果您需要控制器中的另一个功能，那么可以。例如，如果您`pastEvents`在控制器上使用您的过滤器功能。在这种情况下，最好将所有操作保留在您的服务内部，并用于`$q`解决异步谜题。

（这只是一个例子）

```
appModule.factory('sharedApplication', function($rootScope, $http, $q) {
  var deferred = $q.defer();

  $rootScope.$on('data:loaded', function(e, data) {
    deferred.resolve(data);
  });

  return {
     getApp: function(filter) {
        if (!filter) { filter = function() { return true; } }

        var filtered = {};
        deferred.promise.then(function(data) {
           filtered.pastEvents = _.filter(data, filter); 
        };
        return filtered;
     }
  };
}); 
```

一点解释。数据随服务中的事件到达。那时`getApp()`可能已经被调用了。但这没关系，因为`$q`将确保数据仅在稍后到达时才会被过滤。控制器不需要知道这一点，只要它不尝试执行以下操作：

```
$scope.app = service.getApp();
for(var i = 0; i < $scope.app.pastEvents.length; i++) {
   ...
} 
```

如果您确实需要评估控制器中的内容，请使用`$scope.$watch()`，例如：

```
$scope.$watch('app', function(value) {
   ...
}, true); 
```

**编辑：**

在我看来，当您在您的以下`Search`位置使用它时，您的情况尚未解决`$routeProvider`：

```
Notes.index({subject_id: 1 }, Search) 
```

因此，请尝试解决并在控制器中`Search`使用您的`Notes`资源。

您需要在`Search`服务中兑现承诺。两种选择：

*   返回 $http 承诺，但这可能不是你想要的，如果你需要先对数据做一些事情
*   使用 $q 并返回它的承诺

**$q 示例：**

```
appModule.factory('Search', function($rootScope, $http, $q) {
  var deferred = $q.defer();
  $http.get('api/highlights').success(function(response) {
    deferred.resolve({
       type: ["bacon"],
       pastEvents: response.data)};
  });
  return deferred.promise;
}); 
```

# c# - 通过 IPC 进行 .NET Remoting 调用时出现 MissingMethodException

> ID：14260981
> 
> 赞同：0
> 
> 时间：2013-01-10T15:09:59.403
> 
> 标签：c#, .net, .net-4.0, ipc, .net-remoting

我有一项服务需要将字符串泵送到一个帮助应用程序，该应用程序向用户显示来自服务的关键消息（Vista+ 不让服务访问 GUI）。由于我使用了基于 TCP 的 .NET Remoting，我想我会对 IPC 协议做同样的事情。但是，在获取对远程对象的引用后，在调用远程方法时出现以下异常：

```
MissingMethodException: No parameterless constructor defined for this object. 
```

只需在类中添加一个无参数构造函数，就会在调用时给我一个 NullReferenceException。我做错了什么？我在下面包含了我的相关代码：

申请代码

```
public class MyMsgBus : MarshalByRefObject, IDisposable, IMxServeBus
{
    private Thread myThread = null;
    private volatile List<string> myMsgBus = null;
    private volatile bool myThreadAlive = false;
    private volatile bool myIsDisposed = false;
    private volatile bool myIsDisposing = false;
    private IpcChannel myIpc = null;

    public MyMsgBus(string busname)
    {
       myMsgBus = new List<string>();

       myIpc = CreateIpcChannel(busname);
       ChannelServices.RegisterChannel(myIpc);

       var entry = new WellKnownServiceTypeEntry(
          typeof(MxServeBus),
          "MyRemoteObj.rem",
          WellKnownObjectMode.Singleton);

       RemotingConfiguration.RegisterWellKnownServiceType(entry);
    }

    // defined in IMyMsgBus
    public void SendMessage(string message)
    {
       // do stuff
    }

    public static IpcChannel CreateIpcChannel(string portName)
    {
       var serverSinkProvider = new BinaryServerFormatterSinkProvider();
       serverSinkProvider.TypeFilterLevel = TypeFilterLevel.Low;

       IDictionary props = new Hashtable();
       props["portName"] = portName;
       props["authorizedGroup"] = "Authenticated Users";

       return new IpcChannel(props, null, serverSinkProvider);
    }

    public static IpcChannel CreateIpcChannelWithUniquePortName()
    {
       return CreateIpcChannel(Guid.NewGuid().ToString());
    }
} 
```

测试客户端

```
static void Main(string[] args)
{
   var channel = MyMsgBus.CreateIpcChannelWithUniquePortName();
   ChannelServices.RegisterChannel(channel, true);

   var objUri = "ipc://MyMsgBus/MyRemoteObj.rem";
   IMyMsgBus lBus = (IMyMsgBus)Activator.GetObject(typeof(IMyMsgBus), objUri);
   lBus.SendMessage("test");
   Console.WriteLine();
} 
```

在此先感谢您提供任何帮助。作为一个仅供参考，这是一个通过使用共享接口配置的远程处理实例，其中 IMyMsgBus 定义了应该可用于通过 IPC 调用的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:23:47.163

您正在`NullReferenceException`添加无参数构造函数，因为正确初始化需要参数。如果不提供它，就会错过初始化的某些部分。

您应该重构代码以允许无参数构造函数为

```
 private bool _initialized = false;

    public MyMsgBus() {}

    public Initialize(string busname) // Make this part of interface    
    {
       myMsgBus = new List<string>();

       myIpc = CreateIpcChannel(busname);
       ChannelServices.RegisterChannel(myIpc);

       var entry = new WellKnownServiceTypeEntry(
          typeof(MxServeBus),
          "MyRemoteObj.rem",
          WellKnownObjectMode.Singleton);

       RemotingConfiguration.RegisterWellKnownServiceType(entry);
       _initialized = true;
    } 
```

在所有其他公共方法中，检查`_initialized`标志以及`throw NotInitializedException`标志是否为假。

您应该将其用作

```
 IMyMsgBus lBus = (IMyMsgBus)Activator.GetObject(typeof(IMyMsgBus));
 lBus.Initialize(objUri);
 ... do Further operation 
```

# android - Android 画布绘制弧形边框

> ID：14260990
> 
> 赞同：0
> 
> 时间：2013-01-10T15:10:31.347
> 
> 标签：android, canvas, paint

我通过绘制两条弧线来绘制一条带边框的弧线，一条在另一条之上，第一条稍大一些。

问题在于“稍微大一点”，这最终可能导致边界并不总是一直都是圆形的。

![例子](../Images/3164d0030d687af9371125f1ce86f717.png)

我绘制的两条弧线具有相同的半径，我只是通过在起点增加一个度数和在结束点增加两个度数（确保弧线两端的边界相等）并增加笔划宽度来使其更大。

在提供的图片中，较厚的边框边缘是我可以做到的最小的边缘，而它仍然可见。（偏离内弧-1度）

我考虑过用四个单独的调用来绘制弧线轮廓，两端分别为两条直线和两条弧线。对于我想要实现的目标，这似乎效率很低。

我想知道是否有人对我如何绘制边框有任何建议，如果可能的话，尽量减少绘制/画布旋转调用的数量。

当前解决方案的相关代码示例：

```
Paint mOutlinePaint = new Paint(Paint.ANTI_ALIAS_FLAG);
Paint mFillPaint = new Paint(Paint.ANTI_ALIAS_FLAG);

mFillPaint.setStyle(Style.STROKE);
mFillPaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.SRC));
mFillPaint.setColor(Color.TRANSPARENT);
mFillPaint.setStrokeWidth(mValueWidth);

mOutlinePaint.setStyle(Style.STROKE);
mOutlinePaint.setStrokeWidth(mBorderWidth);
mOutlinePaint.setColor(Color.WHITE);

mRect.set(mHalfXSubRadius, mHalfYSubRadius, mHalfXAddRadius, mHalfYAddRadius);
canvas.drawArc(mRect, ARC_START-1, MAX_ARC+2, false, mOutlinePaint);
canvas.drawArc(mRect, ARC_START, MAX_ARC, false, mFillPaint); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T16:09:52.757

你不应该让你的弧线更大，而是尝试绘制相同大小的弧线（白色），X 像素右、下、上、左、角以及（共 8 幅图）。

其中 X 是您想要的边框大小。

之后在中间绘制主弧（灰色）。

伪代码：

```
paint=white;
drawArc(x,y+2);
drawArc(x,y-2);
drawArc(x+2,y+2);
drawArc(x+2,y-2);
drawArc(x-2,y+2);
drawArc(x-2,y+2);
drawArc(x+2,y);
drawArc(x-2,y);

paint=gray;
drawArc(x,y); 
```

# android - 如何使用 Intent Android 拨打带有特殊字符的号码？

> ID：14260993
> 
> 赞同：4
> 
> 时间：2013-01-10T15:10:43.580
> 
> 标签：android, android-intent

我正在尝试使用下面的代码拨打号码，但它总是拨打 *111

```
 Intent callIntent = new Intent(Intent.ACTION_CALL);
  callIntent.setData(Uri.parse("tel:*111#"));
  startActivity(callIntent); 
```

请帮助我正在尝试学习android..

谢谢朋友..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T15:14:42.357

```
Intent callIntent = new Intent(Intent.ACTION_CALL, Uri.parse("tel:"+ Uri.encode("*111#")));
startActivity(callIntent ); 
```

快乐编码:)

# ruby-on-rails - 每次性能测试的会话重置

> ID：14260995
> 
> 赞同：0
> 
> 时间：2013-01-10T15:10:54.467
> 
> 标签：ruby-on-rails, testing, integration-testing, performance-testing

使用[http://guides.rubyonrails.org/performance_testing.html#examples](http://guides.rubyonrails.org/performance_testing.html#examples) (1.2.1) 中的示例：

```
require 'test_helper'
require 'rails/performance_test_help'

class PostPerformanceTest < ActionDispatch::PerformanceTest
  def setup
    # Application requires logged-in user
    login_as(:lifo)
  end

  def test_homepage
    get '/dashboard'
  end

  def test_creating_new_post
    post '/posts', :post => { :body => 'lifo is fooling you' }
  end
end 
```

根据文档，它说`setup`每个测试调用一次，但是当我像示例一样运行测试时，会话保持不变，下一次`setup`调用使用旧会话。我使用`reset!`, 来清除设置中的会话。

那是对的吗？我是否也需要在集成测试中做同样的事情？为什么在世界上保持会话？也许我错过了一些东西，比如是否有一种技术可以查看是否存在记录/会话？

# mysql - 如何从 MYSQL 数据库中选择 10 个随机行，在 x 列中具有唯一值？

> ID：14260998
> 
> 赞同：0
> 
> 时间：2013-01-10T15:11:00.743
> 
> 标签：mysql

此查询的目标是从 mysql 数据库中挑选 10 名获胜者参加比赛。列是“product_id”、“uid”和“winner”。

获胜者始终为 0（目前，尚未选择获胜者），uid 是唯一索引（每人一个条目），product_id 是 10 个不同的产品 ID 之一。为了参加比赛，用户登录并选择他们想要赢得的 10 种产品中的哪一种。

数据库中有 1000 行，10 个产品 ID 中的每一个都有大约 100 行。

我想要一个查询，为 10 个不同的产品 ID 中的每一个选择一个随机条目。下面的查询选择了 10 个随机条目，但一些产品 ID 是相同的。

```
SELECT DISTINCT product_id, uid FROM database.table WHERE winner = 0 ORDER BY RAND( ) LIMIT 0 , 10 
```

如何改进此查询以按我需要的方式工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:21:29.017

```
SELECT product_id, uid
FROM (  SELECT product_id, uid
        FROM database.table
        WHERE winner = 0
        ORDER BY RAND()) AS h
GROUP BY product_id 
```

`GROUP BY``x`我认为您正在谈论的这个专栏应该可以解决这个问题。`DISTINCT`实际上，由于更精确，您很少需要使用`GROUP BY`.