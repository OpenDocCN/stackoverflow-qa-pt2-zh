# StackOverflow 问答 14838000-14838999

# python - python/django - 为什么views.py中的函数在括号中有请求等？

> ID：14838002
> 
> 赞同：-4
> 
> 时间：2013-02-12T17:12:50.280
> 
> 标签：python, django

```
def detail(request, poll_id):
    p = get_object_or_404(Poll, pk=poll_id)
    return render_to_response('polls/detail.html', {'poll': p}, context_instance=RequestContext(request)) 
```

为什么views.py中的函数在括号中有request、poll_id？

我知道在类中这意味着它们是基类并且被继承。这些在函数中意味着什么？

在这里得到了我的答案：

> 一旦其中一个正则表达式匹配，Django 就会导入并调用给定的视图，这是一个简单的 Python 函数（或基于类的视图）。视图被传递一个 HttpRequest 作为它的第一个参数，并且在正则表达式中捕获的任何值作为剩余参数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T17:13:48.423

它们是传递给函数的参数。

这真的是非常基础的编程。几乎所有语言都以这种方式工作。我建议你做一个介绍性的编程教程。

# mysql - 1:1 关系中的双向外键约束

> ID：14838010
> 
> 赞同：8
> 
> 时间：2013-02-12T17:13:06.590
> 
> 标签：mysql, foreign-keys

我正在使用 MySQL 数据库。在我的关系数据模型中，我有两个彼此 1:1 相关的实体。在我的模式中，通过将 FK 字段放在两个表之一中来设置 1:1 关系，该字段与另一个表的 PK 相关。两个表都有 PK，它们都是自动增量 BIGINT。

我想知道是否有可能`ON DELETE CASCADE`对它们进行双向的行为。

即A 1:1 B，意味着[删除A也删除B]以及[删除B也删除A]。

我意识到，就正确的应用程序设计而言，这可能不是绝对必要的，但我只是想知道这是否真的可能。据我所知，您不能对 PK 施加 FK 约束。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-12T17:15:52.760

如果您强制执行 2-way 关系，则无法插入此类记录。鸡和蛋。表#1 中的记录不能插入，因为表#2 中没有匹配的记录，表#2 不能插入，因为表#1 中没有任何东西可以挂钩。

您可以暂时禁用 FK 约束 ( `set foreign_key_checks = 0`)，但这绝不应该在“真实”系统中完成。它更多地用于加载无法保证表加载顺序的转储。

# python - Python blocktrans 不工作

> ID：14838021
> 
> 赞同：0
> 
> 时间：2013-02-12T17:13:59.360
> 
> 标签：python, html, django

我有一个 Django 网站，我在 views.py 文件中使用了这样的列表：

```
EventsList = []

EventsList.append({'ipaddress':'192.168.200.1', 'starttime':'02/12/2013 13:59:42', 'endtime':'02/12/2013 14:59:42'});

EventsList.append({'ipaddress':'192.168.200.2', 'starttime':'02/12/2013 13:59:42', 'endtime':'02/12/2013 14:59:42'});

EventsList.append({'ipaddress':'192.168.200.3', 'starttime':'02/12/2013 13:59:42', 'endtime':'02/12/2013 14:59:42'}); 
```

在我的 HTML 页面上，我希望执行以下操作：

```
<p><b>{% blocktrans with len(EventsList) as Count %}{{ Count }}</b> events detected from <b>{{ first_session_start_time }}</b> to <b>{{ last_session_end_time }}</b>.{% endblocktrans %}</p> 
```

但我在页面加载时收到错误：

```
Exception Type: TemplateSyntaxError
Exception Value:    
Could not parse the remainder: '(Events)' from 'len(Events)' 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:42:50.667

你这样做是不对的。在模板中，您需要[长度](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#length)模板标签：

```
<p><b>{% blocktrans with EventsList|length as Count %}{{ Count }}</b> events detected from <b>{{ first_session_start_time }}</b> to <b>{{ last_session_end_time }}</b>.{% endblocktrans %}</p> 
```

在模板中，您不能执行 Python 代码。模板语言有自己的处理方式。

# ios - 从 NIB 加载十几个相同类型的 UIView

> ID：14838025
> 
> 赞同：-1
> 
> 时间：2013-02-12T17:14:18.580
> 
> 标签：ios, performance, uiview, xib, nib

这可能是一个愚蠢的问题，但我什么也没找到……我偶然发现了一段我认为可以优化的代码。

我有一个由 24 个注释/帖子组成的视图控制器。在 view-did-load-process 过程中调用以下内容：

```
 for (int i = 1; i <= 24; i++)
{
    NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"PostitView" owner:self options:nil];
    for (UIView *subview in nib)
    {
        if ([subview isKindOfClass:NSClassFromString(@"PostitView")]) 
        { 
```

从笔尖一次又一次地加载 postit 需要很长时间。

我会说，我只是从子视图中复制一份，但它不起作用。那么正确的方法是什么？

谢谢！！！汤姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:02:31.750

在循环之前，创建一个`UINib`代表您的笔尖的对象。在循环内部，要求`UINib`实例化自身。

```
UINib *nib = [UINib nibWithNibName:@"PostitView" bundle:nil];
Class viewClass = [PostitView class];
for (int i = 0; i < 24; i++) {
    NSArray *topLevelObjects = [nib instantiateWithOwner:self options:nil];
    for (UIView *subview in topLevelObjects) {
        if ([subview isKindOfClass:viewClass)  {
            ... 
```

# accessibility - 屏幕阅读器和错误消息

> ID：14838029
> 
> 赞同：1
> 
> 时间：2013-02-12T17:14:25.127
> 
> 标签：accessibility, validation

一般来说，您如何在网页上显示客户端验证消息以使其易于阅读？警报很好读，但在当前设计中是禁止的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T17:53:49.993

我建议使用具有警报作用的段落或类似内容（可选不可见）。

```
<p id="error-msg" role="alert"></p> 
```

当出现问题时，将文本放在 error-msg 元素中，并带有一些描述的 Javascript。

```
document.getElementById("error-msg").innerHTML="What are you doing you fool!"; 
```

或者类似的东西。

我相信这是 YouTube 用来让用户知道播放列表中的新视频何时加载的方法。

希望这可以帮助。

# asp.net - ASP.NET 挂起 - 通用字典并发问题导致 GC 死锁

> ID：14838032
> 
> 赞同：20
> 
> 时间：2013-02-12T17:14:31.100
> 
> 标签：asp.net, .net, debugging, windbg, freeze

在上个月，我们的 ASP.NET Web 应用程序停止响应请求，我们不得不重置应用程序池以使其恢复正常。

我们无法确定问题的确切原因，因为服务器的事件日志中没有错误。该网站只是停止响应。

因此，我们一直在使用 WinDbg 来尝试分析在 Tess Ferrandez 的博客条目的帮助下站点没有响应时进行的内存转储：[GC 挂起](http://blogs.msdn.com/b/tess/archive/2007/03/12/net-hang-case-study-the-gc-loader-lock-deadlock-a-story-of-mixed-mode-dlls.aspx)和[高 CPU 挂起](https://www.tessferrandez.com/blog/2009/12/21/high-cpu-in-net-app-using-a-static-generic-dictionary.html)

通过运行，`!threadpool`我可以看到以下内容：

```
CPU utilization: 81%
Worker Thread: Total: 10 Running: 8 Idle: 2 MaxLimit: 400 MinLimit: 160
Work Request in Queue: 1930
--------------------------------------
Number of Timers: 72
--------------------------------------
Completion Port Thread:Total: 1 Free: 1 MaxFree: 8 CurrentLimit: 0 MaxLimit: 400 MinLimit: 120 
```

根据挂起博客文章中的 Tess 的说法，这表明我们陷入了垃圾收集的中间（通常需要几纳秒的时间），因为处理器显示**81%**，这是 .NET 框架设置的虽然它是垃圾收集。它被设置为这个，因为当这个值大于 80% 时不能产生新的线程。此外 - 您可以看到队列中有 1930 个请求，即使可能的 400 个工作线程中只有 10 个工作线程。

通过运行`!threads`命令，我可以看到两个`PreEmptive GC`设置为禁用的线程：

```
 PreEmptive   GC Alloc                Lock
       ID  OSID ThreadOBJ    State GC           Context       Domain   Count APT Exception
  10    1  18bc 00000000001b9710   1008220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
  16    2   e68 00000000001c0900      b220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Finalizer)
  18    4  1118 00000000001df300   1009220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
  19    5  1560 00000000001e9068   100a220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
  20    6  11d0 00000000001f14d8      1220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn
  22    9  19d0 000000001bc666d0   1019220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
   9    c  13f4 000000001d173600   8008220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Completion Port)
  24   23  17c4 00000000001a0c40   1009220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
  25   24  1088 000000001d205900   1009220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
   6   21  1248 000000001d1f6e80       220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn
   4   27   eb0 000000000019df08       220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn
  27   29   39c 000000001bc720f0   1009220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
  28   26  17ec 00000000001a7be0   1019220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
  29   2c  1040 000000001d1c8160   1009220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
   3   2a  1788 000000001d22ed48       220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn
  30   1f   830 000000001bc5b180       220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn
  32   1e   b38 000000001d1995a0   1009220 Enabled  0000000000000000:0000000000000000 001f0d80     2 Ukn (Threadpool Worker)
  33   1d  19fc 000000001d199a98   1019220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
  34   1c   c84 000000000019f8a8   1009220 Enabled  0000000008d8d880:0000000008d8d88c 001f0d80     1 Ukn (Threadpool Worker)
  35   1a  12e8 000000001d1a1468   10092a2 Disabled 000000000c88e294:000000000c88e6d0 001f0d80     1 Ukn (Threadpool Worker)
   5   22  1a70 000000001d1a6008       220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn
  36   28  1050 000000001d209f18   1019220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
  37   25  19f0 000000001d22f738   1019220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
  38   2b  15cc 000000001d29b2d0      b220 Enabled  0000000000000000:0000000000000000 001f0d80     1 Ukn
  39   20  1228 000000001d290a88   1019220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
  40   1b   c98 000000001d290420   10092a2 Disabled 0000000010adc094:0000000010addcf8 001f0d80     1 Ukn (Threadpool Worker)
  41   19  15dc 000000001d2a3168   1019220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn (Threadpool Worker)
  43   18  1a64 000000001d2c8cc0       220 Enabled  0000000000000000:0000000000000000 001b3b98     0 Ukn 
```

据我了解，这很糟糕，基本上意味着在所有线程都启用此功能之前，垃圾收集无法完成，这意味着该进程处于挂起状态。

与帖子相比存在细微的差异，这让我感到困惑，因为没有标有“（GC）”的线程 - 触发垃圾收集的线程？

但无论如何，由于两个线程设置为禁用，我认为这是问题所在，Tess 的挂起博客文章将继续告诉我确切的原因和解决方案。但不幸的是，它暗示了“[混合 DLL 加载问题](http://msdn.microsoft.com/en-us/library/aa290048%28vs.71%29.aspx)”的问题，在查看了禁用线程的堆栈之后，两者都没有尝试加载 DLL。例如，这里是`kb`线程 40：

```
1c93dc74 79142280 0ac30260 0bc85820 00000003 mscorlib_ni+0x29f318
1c93dc88 1e6a8c6c 1c93dc94 00000000 00000001 clr!OnHijackScalarTripThread
WARNING: Frame IP not in any known module. Following frames may be wrong.
1c93dca0 1e6791f7 00000003 00000000 00000000 0x1e6a8c6c
1c93e270 791421bb 0c886820 1bac554d 00000000 0x1e6791f7
1c93e284 7916a553 1c93e354 00000001 1c93e320 clr!CallDescrWorker+0x33
1c93e300 7916a6f4 1c93e354 00000001 1c93e320 clr!CallDescrWorkerWithHandler+0x8e
1c93e450 7916a729 1bd17090 1c93e574 1c93e720 clr!MethodDesc::CallDescr+0x194
1c93e46c 7916a749 1bd17090 1c93e574 1c93e720 clr!MethodDesc::CallTargetWorker+0x21
1c93e484 79190c04 1c93e720 ed47daf9 1c93ea18 clr!MethodDescCallSite::Call_RetArgSlot+0x1c
1c93e648 79190f53 1c85ce30 1bd17090 1b8b6834 clr!CallWithValueTypes_RetArgSlotWrapper+0x5c
1c93e930 79191115 1c85ce30 00000000 0c886b80 clr!InvokeImpl+0x621
1c93e9fc 79b3d839 1d1a1468 00000096 1c93ea18 clr!RuntimeMethodHandle::InvokeMethodFast+0x180
1c93ea50 79b3d52c 0ecc3e60 00000096 1038d084 mscorlib_ni+0x2bd839
1c93ea88 79b3c19d 00000000 00000000 0c885530 mscorlib_ni+0x2bd52c
1c93eab0 79ad6d16 00000000 0c885530 0ec452c4 mscorlib_ni+0x2bc19d
1c93ec04 7a045331 00000000 00000000 00000000 mscorlib_ni+0x256d16
1c93ecbc 672d72b5 0c862b08 00000000 00000000 mscorlib_ni+0x7c5331
1c93ece8 672eb90c 00000000 1c93ed18 0c862b08 System_Web_ni+0x1772b5
1c93ed28 67301e9e 1c93ed54 07f81050 0c863014 System_Web_ni+0x18b90c
1c93ed80 672b5998 1b8b2010 1b8e12c4 1c93f208 System_Web_ni+0x1a1e9e
1c93ed9c 67300602 0c862b08 0ec4af84 0c862b08 System_Web_ni+0x155998
1c93edd8 6730034d 0ac37a80 0c861c1c 1c93ee5c System_Web_ni+0x1a0602
1c93ede8 672ff8fd a65adfcd 79145c50 1c93effc System_Web_ni+0x1a034d
1c93ee5c 67935cdc 00000002 6726b530 00000000 System_Web_ni+0x19f8fd
1c93ee98 791425a1 1c93f228 00000002 028f2b9c System_Web_ni+0x7d5cdc
1c93eeac 79208c9b 67935cc0 6726b530 0ac4ea6c clr!COMToCLRDispatchHelper+0x28
1c93ef40 79208d74 6726b530 0ac4ea6c 00000001 clr!BaseWrapper<Stub *,FunctionBase<Stub *,&DoNothing<Stub *>,&StubRelease<Stub>,2>,0,&CompareDefault<Stub *>,2>::~BaseWrapper<Stub *,FunctionBase<Stub *,&DoNothing<Stub *>,&StubRelease<Stub>,2>,0,&CompareDefault<Stub *>,2>+0xfa
1c93ef64 79208dda 1d1a1468 1c93f1f8 1b7affe0 clr!COMToCLRWorkerBody+0xb4
1c93efbc 792098c9 1d1a1468 1c93f1f8 1b7affe0 clr!COMToCLRWorkerDebuggerWrapper+0x34
1c93f1cc 02b3a1aa 1d1a1468 1c93f1f8 a65adfcd clr!COMToCLRWorker+0x614
1c93f1e0 69f5aa4f 00000001 028038c8 00000000 0x2b3a1aa
1c93f544 69f5ab4a 028038c8 69f5aae2 1c93f56c webengine4!HttpCompletion::ProcessRequestInManagedCode+0x1cd
1c93f554 69f5aafe 028038c8 00000000 00000000 webengine4!HttpCompletion::ProcessCompletion+0x4a
1c93f56c 792078af 028038c8 ed47c90d 0000ffff webengine4!CorThreadPoolWorkitemCallback+0x1c
1c93f5bc 79206c5f 1c93f61f 1c93f61e ed47ca9d clr!UnManagedPerAppDomainTPCount::DispatchWorkItem+0x195
1c93f62c 792084c5 00000000 ed47ca25 00000000 clr!ThreadpoolMgr::NewWorkerThreadStart+0x20b
1c93f694 792f76e0 00000000 fff91c00 00000002 clr!ThreadpoolMgr::WorkerThreadStart+0x3d1
1c93ffb8 7d4dfb97 00247430 00000000 00000000 clr!Thread::intermediateThreadProc+0x4b
1c93ffec 00000000 792f7698 00247430 00000000 kernel32!BaseThreadStart+0x34 
```

但后来我注意到了一些有趣的事情。通过使用该`!eestack -ee -short`命令，我看到线程 35 和 40（禁用 PreEmptive GC 的线程）都在同一个当前帧上：

```
Current frame: (MethodDesc 798ee360 +0xab System.Collections.Generic.Dictionary`2[[System.Int32, mscorlib],[System.__Canon, mscorlib]].FindEntry(Int32)) 
```

这就是导致我写[这篇](http://blogs.msdn.com/b/tess/archive/2009/12/21/high-cpu-in-net-app-using-a-static-generic-dictionary.aspx)文章的原因，让我觉得我肯定找到了问题所在。但不幸的是，在使用堆栈追溯代码之后，有问题的字典**不是**静态的——所以我猜这不会是问题所在。

我现在几乎没有想法 - 我不是分析转储文件的专家（事实上我昨天才开始：D）所以如果有人对我接下来应该做什么以找出问题的原因有任何指示会很好。

**更新**

运行`~*ekb`Brian 建议的命令后，我找到了启动垃圾收集的线程，因为它在堆栈中有**GarbageCollectGeneration**。

```
1e61e54c 7d4d8c9e 000003c4 00000000 00000000 ntdll_7d600000!NtWaitForSingleObject+0x15
1e61e5bc 791897da 000003c4 ffffffff 00000000 kernel32!WaitForSingleObjectEx+0xac
1e61e5f0 7918981b 000003c4 ffffffff 00000000 clr!CLREvent::CreateManualEvent+0xf6
1e61e640 791896f1 00000000 efb5da31 0019f8a8 clr!CLREvent::CreateManualEvent+0x137
1e61e680 79189712 ffffffff 00000000 00000000 clr!CLREvent::WaitEx+0x126
1e61e694 792a05cc ffffffff 00000000 00000000 clr!CLREvent::Wait+0x19
1e61e6b8 792a04e5 ffffffff 00000000 0019f8f0 clr!SVR::gc_heap::wait_for_gc_done+0x6f
**1e61e6e0 792a424b 00000000 00000001 001bc600 clr!SVR::GCHeap::GarbageCollectGeneration+0x14f**
1e61e714 79229fd2 0019f8f0 00000040 00000000 clr!SVR::gc_heap::try_allocate_more_space+0x184
1e61e730 7922a080 0019f8f0 00000040 00000000 clr!SVR::gc_heap::allocate_more_space+0x30
1e61e750 79188f33 0019f8f0 00000040 00000000 clr!SVR::GCHeap::Alloc+0x55
1e61e76c 7915dd44 00000040 00000000 00000000 clr!Alloc+0x8d
1e61e7ac 7915dd84 0000001a 79169a39 79166166 clr!SlowAllocateString+0x42
1e61e7b4 79169a39 79166166 00000019 efb5d4c9 clr!UnframedAllocateString+0x12
1e61e7b8 79166166 00000019 efb5d4c9 00001f3e clr!StringObject::NewString+0x13
1e61e878 79ac139e 00000000 0019f8a8 0515fcd0 clr!COMNlsInfo::InternalChangeCaseString+0x128
1e61e88c 79ac51b4 0515fcd0 1e61e900 20e59f26 mscorlib_ni+0x24139e
1e61e898 20e59f26 1e61e900 08ce6208 050fd8e8 mscorlib_ni+0x2451b4 
```

我还应该提到我们的应用程序在 64 位服务器上以 32 位模式运行。不幸的是，当它上次没有响应时，我们忘记了 32 位的转储，这意味着当我们在 WinDbg 中加载转储文件时，我们需要运行`!wow64exts.sw`命令进行分析。不知道这有多大区别（也许这就是为什么我看不到 '(GC)' 线程），但我们似乎无法让 `!clrstack' 命令工作。我们目前正在等待它再次无响应，以便我们可以在 32 位中进行转储。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-14T15:29:44.610

所以我们最终找到了问题的根源。原来是我原来的问题中提到的两篇文章的组合：

*   有两个线程试图访问同一个通用字典
*   GC 无法完成，因为两个线程已将 PreEmptive GC 设置为禁用。

更详细一点：

虽然这两个线程处于某种死锁状态，但第三个线程加入了想要在堆上分配一些内存的一方。这会触发新的 GC，但 GC 无法完成，因为这两个线程的 PreEmptive GC 设置为禁用。由于 GC 无法完成，IIS 进程仍处于无法为请求生成新工作线程的状态，这意味着任何后续请求都将排队。队列继续增长，在应用程序池被回收之前不会返回任何响应。

正如我在最初的问题中提到的 - 我们将字典追溯到代码，它不是静态字典，所以我们认为这一定是红鲱鱼；两个线程怎么能访问同一个对象？事实证明这是可能的，因为字典存储在 InProc 会话中。

默认情况下，ASP.NET 会阻止对同一会话 ID 的并发请求。这是通过在每个请求的会话上放置一个排他锁来实现的，旨在防止这种确切的情况。然而，这是一个使用旧 AjaxPro 框架的“遗留”应用程序，并且已配置为绕过此锁定。这允许同一会话的并发 AjaxRequest 访问同一会话对象。

事实证明，我们最近在 JavaScript 中引入了一个错误，它多次触发同一个 AjaxPro 请求，从而导致了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:18:36.167

这可能完全超出了左侧字段，但是在转储信息中，我注意到了这一点：

```
1c93eeac 79208c9b 67935cc0 6726b530 0ac4ea6c clr!COMToCLRDispatchHelper+0x28 
```

那个 COMToCLRDispatchHelper 调用让我想知道应用程序是否正在调用一个 32 位 COM 组件，这可能会让你有点混乱？

# php - 在 DOMPDF 中生成带有阿拉伯文本的 PDF 并给出问号

> ID：14838043
> 
> 赞同：3
> 
> 时间：2013-02-12T17:15:21.053
> 
> 标签：php, pdf, dompdf, utf8-decode

我有一个包含表单的页面，当我使用 DOMPDF 生成它时，它会自动完成阿拉伯文和英文文本，英文文本看起来不错，但阿拉伯文显示为问号......我将 UTF-8 设置为字符集但不起作用，甚至尝试

```
iconv('UTF-8','WINDOWS-1250',$pdf_html); 
```

但没有用。

这是html的代码

```
<?php require("login3.php"); ?>
<?php 
 if (!empty($_POST)) {

// Used for later to determine result
$success = $error = false;

// Object syntax looks better and is easier to use than arrays to me
$post = new stdClass;

    // Usually there would be much more validation and filtering, but this
// will work for now.
foreach ($_POST as $key => $val)
    $post->$key = trim(strip_tags($_POST[$key]));

// Check for blank fields
if (empty($post->itemCode) OR empty($post->itemDesc) OR empty($post->itemQty) OR    empty($post->itemPrice) OR empty($post->itemAgent))
    $error = true;

else {

    // Get this directory, to include other files from
    $dir = dirname(__FILE__);

    // Get the contents of the pdf into a variable for later
    ob_start();
    require_once($dir.'/pdf.php');
    $pdf_html = ob_get_contents();
    ob_end_clean();

    // Load the dompdf files
    require_once($dir.'/dompdf/dompdf_config.inc.php');

    $dompdf = new DOMPDF(); $pdf_html = iconv('UTF-8','WINDOWS-1250',$pdf_html);// Create   new instance of dompdf
    $dompdf->load_html($pdf_html); // Load the html
    $dompdf->render(); // Parse the html, convert to PDF
    $pdf_content = $dompdf->output(); // Put contents of pdf into variable for  later

    // Get the contents of the HTML email into a variable for later
    ob_start();
    require_once($dir.'/html.php');
    $html_message = ob_get_contents();
    ob_end_clean();

            date_default_timezone_set('Asia/Manila');
            $tym = date('m-d-Y : hi a');
            $filename = ' Order '.$tym;
            $dompdf->load_html($_SESSION['prints']['table']);

            $dompdf->stream( $_SESSION["username"] . $filename. ".pdf");      // Streams   the PDF to the client. Will open a download dialog by default

    // Load the SwiftMailer files
    require_once($dir.'/swift/swift_required.php');

    $mailer = new Swift_Mailer(new Swift_MailTransport()); // Create new i nstance of SwiftMailer

    $message = Swift_Message::newInstance()
                       ->setSubject('New Order') // Message subject
                   ->setTo(array('example@aol.com',  'example@aol.com' => 'Orange Pharmacy Store')) // Array of people to send to
                   ->setFrom(array('example@net.tutsplus.com' => 'order')) // From:
                   ->setBody($html_message, 'text/html') // Attach  that HTML message from earlier
                   -  >attach(Swift_Attachment::newInstance($pdf_content, 'Order.pdf', '')); // Attach the generated PDF from earlier

            // Send the email, and show user message
    if ($mailer->send($message))
        $success = true;
    else 
            $error = true;

   }

     }
   ?>
    <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">

     <html xmlns="http://www.w3.org/1999/xhtml" lang="ar" xml:lang="ar">
      <head>
      <title> Order System</title>
  <style type="text/css" title="currentStyle">
            @import "css/layout-styles.css";
            @import "css/themes/smoothness/jquery-ui-1.8.4.custom.css";
   </style>

   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<!-- jQuery libs -->
<script  type="text/javascript" src="js/jquery-1.6.1.min.js"></script>
<script  type="text/javascript" src="js/jquery-ui-1.8.14.custom.min.js"></script>
<script type="text/javascript" src="js/atooltip.jquery.js"></script>
<script type="text/javascript" src="js/kwicks-1.5.1.pack.js"></script>
<script type="text/javascript" src="js/script.js"></script>

<!-- My jQuery Script to make everything work -->
<script  type="text/javascript" src="js/jq-ac-script.js"></script>

       </head>
     <body background="images/bg.jpg";>
     <div id="cont">
     <div style="position:absolute; top: 10px; left: 25px;">
     <a href="index.php" class="normaltip" style="text-decoration:none" title="Home"> <img src="images/home.png"height="48" width="48"></a></div>
      <div style="position:absolute; top: 60px; left: 25px;">
       <a href="order.php" class="normaltip" style="text-decoration:none" title="New Order"><img src="images/system-software-update.png"height="48" width="48"></a></div>

        <div id="container">
      <h1 align="center"><img src="images/418694_259331167468533_385322251_n.jpg"></h1>
       <div class="panel">
          <div class="title-large">
            <div class="theme"></div>

    <p>
        <h4 align="left"><b>        Branch : <FONT COLOR="white"><?php   echo($_SESSION["username"]); ?></b></h4>
       <script type="text/javascript">
      function GetClock(){
      d = new Date();
      nday   = d.getDay();
      nmonth = d.getMonth();
      ndate  = d.getDate();
      nyear = d.getYear();
      nhour  = d.getHours();
      nmin   = d.getMinutes();
      nsec   = d.getSeconds();

      if(nyear<1000) nyear=nyear+1900;

      if(nhour ==  0) {ap = " AM";nhour = 12;} 
       else if(nhour <= 11) {ap = " AM";} 
       else if(nhour == 12) {ap = " PM";} 
       else if(nhour >= 13) {ap = " PM";nhour -= 12;}

        if(nmin <= 9) {nmin = "0" +nmin;}
        if(nsec <= 9) {nsec = "0" +nsec;}

           document.getElementById('clockbox').innerHTML=""+ (nmonth+1)+"/"+ndate+"/"+nyear+"  "+nhour+":"+nmin+":"+nsec+ap+"";
           setTimeout("GetClock()", 1000);
        }
          window.onload=GetClock;
        </script>
      <div id="clockbox"></div></font></div>
       <?php if ($success) { ?>
        <div class="message success">
            <h4>Order Successfully Sent to Store </h4>
        </div>
    <?php } elseif ($error) { ?>
        <div class="message error">
            <h4>Sorry, an error occurred. Try again!</h4>
        </div>
    <?php } ?>
            <div class="content inpad">

                 <div id="messageBox" style="margin-left:15px; padding-left:20px;  padding-bottom:5px; border:1px #ccc solid; display:none;"></div>

                        <form method="post" action="#" id="itemsForm">

                        <h1 align="center"><font color="black"><b>Branch Order Form</b>  </font></h1><br><br>
           <select name="Priority" size="1">
          <option value="Daily">Daily</option>
           <option value="Monthly">Monthly</option>
           <option value="Urgent">Urgent</option>
              </select>
                            <table id="itemsTable" class="general-table">
                                <thead>
                                <tr>
                                    <th></th>
                                    <th>Item Code</th>
                                    <th>Item Description</th>
                                    <th>Item Qty</th>
                                    <th>Item Price</th>
                                    <th>Item Agent</th>
                                </tr>
                                </thead>
                                <tbody>
                                    <tr class="item-row">
                                        <td></td>
                                        <td><input name="itemCode[]" value="" class="tInput" id="itemCode" readonly="readonly" /> </td>
                                        <td><input name="itemDesc[]" value="" class="tInput" id="itemDesc"  tabindex="1"/></td>
                                        <td><input name="itemQty[]" value="" class="tInput" id="itemQty" tabindex="2"/></td>
                                        <td><input name="itemPrice[]" value="" class="tInput" id="itemPrice" readonly="readonly" /> </td>
                                        <td><input name="itemAgent[]" value="" class="tInput" id="itemAgent" readonly="readonly" /></td>
                                    </tr>
                                </tbody>
                            </table>
                        <a href="#" id="addRow" class="button-clean large"><span> <img  src="images/icon-plus.png" alt="Add" title="Add Row" /> Add Item</span></a>&nbsp;&nbsp;&nbsp;

                    </div>
                  <input type="submit" value="SEND TO THE STORE">
                </form>

            </div>
    </div>

   </body>
   </html> 
```

和 pdf.php 代码：

```
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <html>
       <style type="text/css" title="currentStyle">
            @import "css/layout-styles.css";
            @import "css/themes/smoothness/jquery-ui-1.8.4.custom.css";
       </style>
      <head> 
       <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <br>
        <br>
         <br>
           <h1 align="center"><img  src=/418694_259331167468533_385322251_n.jpg></h1>
           <br>
         </head> 
         <body>
          <br>
   <h3 align="center"><b>Items&nbsp;<?php echo($_POST["Priority"]); ?>&nbsp;Order <br>  Branch : <FONT COLOR="ORANGE"><?php echo($_SESSION["username"]); ?></h3>
    <br>
     <hr>
     <h6>
 <table id="itemsTable" border="1" width="100%">
                                <thead>
                                <tr>
                                    <th></th>
                                    <th>Item Code</th>
                                    <th>Item Description</th>
                                    <th> Qty</th>
                                    <th> Price</th>
                                    <th> Agent</th>
                                </tr>
                                </thead>
                                <tbody>
            <?php foreach  ($_POST['itemCode'] as $Key=> $itemCode) {  
        $itemDesc=$_POST["itemDesc"][$Key];
        $itemPrice=$_POST["itemPrice"][$Key];
        $itemQty=$_POST["itemQty"][$Key];
        $itemAgent=$_POST["itemAgent"][$Key];   
           echo "<tr><td></td><td>" . $itemCode . "</td><td>" . $itemDesc . "</td><td>" . $itemQty . "</td><td>" . $itemPrice . "</td><td>" . $itemAgent ."</td></tr>";
          }
        ?>

                                </tbody>
                            </table>
         </h6>
         <script type="text/php">

   if ( isset($pdf) )

      {

    $font = Font_Metrics::get_font("verdana");

    // If verdana isn't available, we'll use sans-serif.

    if (!isset($font)) { Font_Metrics::get_font("sans-serif"); }

    $size = 6;

    $color = array(0,0,0);

    $text_height = Font_Metrics::get_font_height($font, $size);

    $w = $pdf->get_width();

    $h = $pdf->get_height();

    // ------------------ FOOTER ------------------------------------------

    if ($PAGE_NUM > 0)

    {

        $footer = $pdf->open_object();

        $y = $h - 3 * $text_height - 24;

        $text = "Orange Pharmacy    Tel:5536170 - Fax :5536171"; //"Page {PAGE_NUM} of  {PAGE_COUNT}";

        $width = Font_Metrics::get_text_width("Orange Pharmacy    Tel:5536170 - Fax :5536171", $font, $size);

        $pdf->page_text($w / 2 - $width / 2, $y, $text, $font, $size, $color);

        // Copyright line

        $y += $text_height * 2;

        $text = "my company footer";

        // Center the text

        $width = Font_Metrics::get_text_width($text, $font, $size);

        $pdf->page_text($w / 2 - $width / 2, $y, $text, $font, $size, $color);

        // Add a logo

        $img_w = 0.5 * 72; // 0,5 inches, in points

        $img_h = 0.5 * 72; // 0,5 inch, in points -- change these as required

        //$pdf->image("/images/300px- Orange_plus.svg.png", "png", 0, $y, $img_w, $img_h);

        $pdf->close_object();

        $pdf->add_object($footer, "all");

    }

    // ------------------ FOOTER END ------------------------------------------

          }

       </script>
         <script type="text/php">
        if ( isset($pdf) ) {
        $font = Font_Metrics::get_font("helvetica", "bold");
         $pdf->page_text(36, 9, "Page: {PAGE_NUM} of {PAGE_COUNT}",
                    $font, 6, array(0,0,0));
         }
      </script> 
          </body>   
              </html> 
```

你能帮助我吗？谢谢。

# matlab - Matlab - 向量除以向量，使用循环

> ID：14838045
> 
> 赞同：0
> 
> 时间：2013-02-12T17:15:25.350
> 
> 标签：matlab, loops, memory, vector, matrix

我必须有两个大小均匀的非常大的向量（列）A 和 B。我想将向量 A 除以向量 B。这将给我一个用零填充的大矩阵 AxB，除了最后一列。此列包含我感兴趣的值。当我在 Matlab 脚本中简单地划分向量时，内存不足。可能是因为矩阵 AxB 变得非常大。可能我可以通过重复以下操作来防止这种情况发生：

1.  计算矩阵 AxB 的第一行

2.  过滤最后一个值并将其放入另一个向量 C.

3.  删除矩阵 AxB 的已使用行

4.  对向量 A 中的所有行重做步骤 1-4

我怎样才能做一个循环呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:57:55.417

您的问题并没有明确说明您要做什么，尽管听起来您想做一个元素明智的划分。

尝试：

```
C = A./B 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-16T18:21:52.763

“矩阵乘积 AxB”和“除向量”是不同的操作。如果我们正确理解这一点，您想要计算的是“C = AxB 的最后一列”，这样：

```
lastcolsel=zeros(size(B,2),1)
C=(A*B)*lastcolsel 
```

如果该代码超出了您的内存限制，请回忆一下矩阵乘积是关联的 (MxN)xP = Mx(NxP)。简化您的示例，我们得到：

```
lastcolsel=zeros(size(B,2),1)
simplifier=B*lastcolsel
C=A*simplifier 
```

# ios - 您如何在项目级别而不是目标级别设置代码签名身份

> ID：14838046
> 
> 赞同：0
> 
> 时间：2013-02-12T17:15:24.973
> 
> 标签：ios, xcode

我对项目设置和目标设置之间关系的理解是项目设置是高级别的，并且可能在较低级别的目标设置中被覆盖。

我有一个包含多个目标的项目，并且希望对所有目标使用相同的代码签名配置文件，因此我在项目级别设置了代码签名身份，并将身份保留为“不进行代码签名”在目标中。

这会导致必须对事物进行签名的 XCode 错误。如果“不进行代码签名”覆盖项目代码签名设置，这将是有意义的。但是，没有选项可以在目标中将代码签名标识留为空白 - 您必须将其设置为某个值，因此这意味着在项目中设置的代码签名标识是无用的，因为它永远无法应用，因为它总是必须被目标中的设置覆盖。

仅在项目中设置身份是否有一些技巧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-05T23:24:48.677

在目标级别，只需选择“代码签名身份”选项并按键盘上的删除。它将自动使用项目范围的设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:25:52.430

使用“级别”选项来查看。![在此处输入图像描述](../Images/dde2615a4df40e8fca6d269b6bb78d12.png)

# jquery - 创建后不调用 JQuery UI 选项卡 1.10.0 激活

> ID：14838049
> 
> 赞同：0
> 
> 时间：2013-02-12T17:15:47.557
> 
> 标签：jquery, jquery-ui-tabs

我在网上搜索了一段时间，找不到答案。从 JQuery UI 1.9.2 升级到 1.10.0 时，除了选项卡外，一切都很顺利。我在 1.9.2 中设置了“显示”选项，并将其替换为“活动”和“激活”。关键是在创建选项卡之后，不会调用“激活”函数。我该如何解决？（我尝试使用“创建”事件，但如何从“创建”调用“激活”事件？

谢谢你。

```
<html>
<head>
    <link href="/css/styles.css" rel='stylesheet' type='text/css'></link>
    <link href="/css/themes-1.10.0/base/jquery.ui.all.css" rel='stylesheet' type='text/css'></link>
    <link href="/css/themes-1.10.0/Cupertino/jquery-ui.css" rel='stylesheet' type='text/css'></link>
    <script src='/js/jquery-1.9.1.min.js' rel='text/javascript'></script>
    <script src='/js/jquery-ui-1.10.0.custom.js' rel='text/javascript'></script>
    <script src='/js/jquery.cookie.js' rel='text/javascript'></script>
    <script src='/js/jquery.browser.js' rel='text/javascript'></script>
    <script src='/js/jquery.iframe-auto-height.1.9.1.js' rel='text/javascript'></script>
</head>
<body class='ui-widget-content'>
    <div id='tabber'>
        <ul>
            <li>
                <a href="#tabber-00">General information</a>
            </li>
            <li>
                <a href="#tabber-01" url='.page.php'>Remote page</a>
            </li>
        </ul>
        <div id='tabber-00'>
            <p>Some content here</p>
        </div>
        <div id='tabber-01'></div>
    </div>
</body>
<script type='text/javascript'>
    $(function() {
        $('#tabber').tabs({
        ajaxOptions:{cache:false},
        active: ($.cookie('tabber') || 0 ),
        activate:function(event,ui) {
                      var tab = ui.newTab.find('a').attr('href');
                      var url=ui.newTab.find('a').attr('url');
                      if( url != null ) {
                        var html=[];
                        html.push('<iframe width="100%" height="auto" frameborder="0" margin="0" src="' + url + '">Load Failed?</iframe>');
                        $(tab).empty();
                        $(tab).append( html.join('') ); 
                        $(tab).find('iframe').iframeAutoHeight({minHeight:400});
                      }
                      alert('activate');
                      var index = ui.newTab.parent().children().index(ui.newTab);
                      $.cookie('tabber_user_info', index, { expires:999 } )
                     },
        });
    });
</script>
</html> 
```

我的主要问题是我使用 iframe 并希望能够在页面被激活时动态加载 iframe。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:16:40.687

我终于得到了解决方案。我有一个“loadTab()”函数并使用“创建”和“激活”事件。loadTab() 函数创建一个 iframe 并根据其内容调整其大小。

我正在使用以下插件：

*   jquery.cookie.js
*   jquery.browser.js
*   jquery.iframe-auto-height.js

谢谢。

```
<html>

<title></title>
<head>

    <link href="/css/styles.css" rel='stylesheet' type='text/css'></link>
    <link href="/css/themes-1.10.0/base/jquery.ui.all.css" rel='stylesheet' type='text/css'></link>
    <link href="/css/themes-1.10.0/Cupertino/jquery-ui.css" rel='stylesheet' type='text/css'></link>
    <script src='/js/jquery-1.9.1.min.js' rel='text/javascript'></script>
    <script src='/js/jquery-ui-1.10.0.custom.js' rel='text/javascript'></script>
    <script src='/js/jquery.cookie.js' rel='text/javascript'></script>
    <script src='/js/jquery.browser.js' rel='text/javascript'></script>
    <script src='/js/jquery.iframe-auto-height.1.9.1.js' rel='text/javascript'></script>
</head>
<body class='ui-widget-content'>

    <div id='tabber'>
        <ul>
            <li>
                <a href="#tabber-00">Tab 1</a>
            </li>
            <li>
                <a href="#tabber-01" url="page.php">Tab 2</a>
            </li>
        </ul>
        <div id='tabber-00'>
            <p>Some Text</p>
        </div>
        <div id='tabber-01'></div>
    </div>
</body>
<script type='text/javascript'>
    $(function() {
        function loadTab(tab) { var href = tab.find('a').attr('href'); var url = tab.find('a').attr('url'); if( url != null ) { $(href).empty(); $(href).append( '<iframe width="100%" height="auto" frameborder="0" margin="0" src="' + url + '">Load Failed?</iframe>' ); $(href).find('iframe').iframeAutoHeight({minHeight:400}); } }
        $('#tabber').tabs({
        ajaxOptions:{cache:false},
        active:($.cookie('tabber') || 0 ),
        activate:function(event,ui) { loadTab(ui.newTab); var index = ui.newTab.parent().children().index(ui.newTab); $.cookie('tabber', index, { expires:999 } ) },
        create:function(event,ui) { loadTab(ui.tab); },
        });

    });
</script>
</html> 
```

# ios - iOS SDK：禁用 UITextField 的文本听写

> ID：14838054
> 
> 赞同：1
> 
> 时间：2013-02-12T17:16:31.910
> 
> 标签：ios, sdk, siri

是否可以禁用 UITextField 或整个应用程序的文本听写？

# ajax - 我希望将返回的数据写入 html 的 div 标签

> ID：14838055
> 
> 赞同：0
> 
> 时间：2013-02-12T17:16:31.947
> 
> 标签：ajax, jquery

```
function showPrice(data) //pass the data as an object literal instead of a string
{
    var $remaining = $('#remaining');

    $remaining.empty();

    $.ajax({
        url: 'getevent.php',
        data: data,
        success: function(reponse){
            $remaining.html(reponse);
        }
    });
}

$('#events').change(function(){

    var pluspoint=$('#events').val();

    var data = { q : 1};

    showPrice(data);
}); 
```

我正在尝试将变量 q 传递给 php 文件并取回结果。我得到了结果，但我得到一个错误参数 q is undefined 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:21:54.967

您可以使用 JSON.stringify：

```
function showPrice(data) //pass the data as an object literal instead of a string
{
    var $remaining = $('#remaining');

    $remaining.empty();

    $.ajax({
        url: 'getevent.php',
        data: data,
        success: function(reponse){
            $remaining.html( JSON.stringify(reponse) );
        }
    });
}

$('#events').change(function(){

    var pluspoint=$('#events').val();

    var data = { q : 1};

    showPrice(data);
}); 
```

# jquery - 带有下一个/上一个按钮的简单内容交换器

> ID：14838056
> 
> 赞同：0
> 
> 时间：2013-02-12T17:16:36.830
> 
> 标签：jquery, carousel

我的页面上有一个列表，其中每个*li*代表一个不同的内容块。

我只想要一个可见的块。具有“可见”类的*li*是要显示的。

当我单击下一个按钮时，我希望可见类移动到下一个*li*。与上一个按钮相同。

当我们到达终点时，我希望它从头开始。同样，如果您在第一个上点击“上一个”，它应该转到最后一个。

我从 jquery 开始，所以我需要帮助！

HTML结构

```
<ul class="container">
    <li>item1</li>
    <li>item 2</li>
    <li>item 3</li>
</ul>
<button type="button" class="prev">prev</button>
<button type="button" class="next">next</button> 
```

CSS

```
.container li { display:none; }
.container li.visible { display:block; } 
```

JS

```
$(document).ready(function() {
    $('.container li:first-child').addClass('visible');
});

var numberOfItems =  $('.container li').size();

$('.next').click(function(){
    $('.container').find('.visible').removeClass('visible').next().addClass('visible');
});

$('.prev').click(function(){
    $('.container').find('.visible').removeClass('visible').prev().addClass('visible');
}); 
```

我被困在那里！我觉得这段代码不是很好，我需要'循环'功能。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T11:53:21.800

看看这个[如何使用下一个和上一个按钮交换可见列表项？](http://jqfaq.com/how-to-swap-visible-list-item-using-next-and-previous-buttons/)链接，这将帮助您获得所需的答案。单击下一个按钮时，可见类将移动到下一个 li，这与上一个按钮相同。如果它到达末尾，它将从头开始，类似于 Prev 按钮。
//为下一个

```
 if (index == (length - 1)) {
            $('li').first().removeClass('invisible').addClass('visible');
        } 
```

//上一页

```
if (index == 0) {
        $('li').last().removeClass('invisible').addClass('visible');
    } 
```

我希望这会给你更多。祝一切顺利。

# python - 在 python 中导入模块的困惑

> ID：14838057
> 
> 赞同：1
> 
> 时间：2013-02-12T17:16:38.217
> 
> 标签：python, import

我刚刚阅读了至少两种在 python 中导入 .py 模块的方法。假设，我有这个目录结构：

```
/foo/bar/mymodule/a.py
/foo/bar/b.py

```

我`/foo/bar`在 PYTHONPATH 中有，并说我分别`def a123():`在 a.py 和`def b123()`：b.py 中有。

如果我明白我可以做..

```
from mymodule import a (suppose I have __init__.py in the directory)

from b import * 
```

为了调用`a123()`和`b123()`。

这两种在 Python 中声明模块的方式各有什么优缺点，我什么时候应该使用其中一种而不是另一种？

谢谢并恭祝安康。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:18:08.693

如果您将所有模块代码放在一个文件中，请放入顶级目录。如果您有多个文件，请制作一个包。

# python - 如何在不终止父进程的情况下中断失控的 ipython 评估？

> ID：14838061
> 
> 赞同：3
> 
> 时间：2013-02-12T17:16:52.270
> 
> 标签：python, ipython

***有时***，正在进行的`ipython`评估不会响应来自键盘¹的一个，[***甚至几个***](https://stackoverflow.com/questions/6637219#answer-6646806)。`Ctrl-C`

是否有其他方法可以使该`ipython`过程中止当前评估并返回其“读取”状态？

也许与`kill -SOMESECRETSIGNAL <pid>`？我尝试了一些 ( `SIGINT`, `SIGTERM`, `SIGUSR1`, ...) 无济于事：要么它们没有效果（例如`SIGINT`），要么它们终止了`ipython`进程。或者可能是一些神秘的`ipython`配置？一些哨兵文件？... ?

¹ [“足够及时”，即。当然，不可能准确地说明“足够及时”有多及时；这取决于情况、延迟持续时间的可靠性、用户的气质、Hacker News 当天的精选等。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:28:17.883

这取决于您决定中断时执行的位置（在 python 函数中，在较低级别的库中，......）。如果这通常发生在您创建的函数中，您可以尝试在函数中放置一个 try/except 块并捕获`KeyboardInterrupt`异常。它可能不会脱离低级库（如果确实是您正在运行的地方），但它应该会阻止 ipython 解释器退出。

# java - 正则表达式或字符串解析

> ID：14838062
> 
> 赞同：0
> 
> 时间：2013-02-12T17:16:53.833
> 
> 标签：java, regex

我正在尝试解析具有特定模式的字符串。一个有效的字符串示例如下：

```
<STX><DATA><ETX>
<STX>A?123<ETX>
<STX><DATA><ETX>
<STX>name!xyz<ETX>
<STX>age!27y<ETX>
<STX></DATA><ETX>
<STX>A?234<ETX>
<STX><DATA><ETX>
<STX>name!abc<ETX>
<STX>age!24y<ETX>
<STX></DATA><ETX>
<STX>A?345<ETX>
<STX><DATA><ETX>
<STX>name!bac<ETX>
<STX>age!22y<ETX>
<STX></DATA><ETX>
<STX>OK<ETX>
<STX></DATA><ETX> 
```

此数据由设备发送。我只需要用 id:123 name:xyz, age 27y 解析这个字符串。

我正在尝试使用这个正则表达式：

最终模式正则表达式 = Pattern.compile("(.*?)", Pattern.DOTALL);

这确实输出了所需的数据：

```
<ETX>
<STX>A?123<ETX>
<STX><DATA><ETX>
<STX>name!xyz<ETX>
<STX>age!27y<ETX>
<STX> 
```

如何递归循环字符串以将所有内容复制到字符串列表中。我正在尝试循环并删除提取的模式，但它不会删除。

```
 final Pattern regex = Pattern.compile("<DATA>(.*?)</DATA>", Pattern.DOTALL);// Q?(.*?)
    final StringBuffer buff = new StringBuffer(frame);
    final Matcher matcher = regex.matcher(buff);
    while (matcher.find())
        {
            final String dataElements = matcher.group();
            System.out.println("Data:" + dataElements);
        }
    } 
```

有没有更好的方法来做到这一点。

这是我目前得到的输出：

```
Data:<DATA><ETX><STX>A?123<ETX><STX><DATA><ETX><STX>name!xyz<ETX><STX>age!27y<ETX><STX>   </DATA>
Data:<DATA><ETX><STX>name!abc<ETX><STX>age!24y<ETX><STX></DATA>
Data:<DATA><ETX><STX>name!bac<ETX><STX>age!22y<ETX><STX></DATA> 
```

在接下来的两场比赛中，我错过了 A?234 和 A?345。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:29:28.140

我真的不知道你到底想通过这个实现什么，但如果你想删除该模式的出现，这一行：

```
buff.toString().replace(dataElements, "") 
```

看起来不太好。您只是在编辑该 buff 的字符串表示形式。您必须再次将编辑后的版本替换回 buff（施法后）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:05:55.663

使用这个正则表达式解决了我的问题：

```
<STX>(A*)(.*?)<DATA>(.*?)</DATA> 
```

# c++ - C++ 中的着色器语法向量 = vec3(a,b,c)？

> ID：14838067
> 
> 赞同：0
> 
> 时间：2013-02-12T17:17:03.763
> 
> 标签：c++, opengl, struct

一个简单的问题：我喜欢用 OpenGL Shader 语言简单地创建向量：

```
vector = vec3(a,b,c); 
```

您将如何编写允许在 C++ 中使用此精确代码的 C++ 结构或类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T17:43:19.600

所有这些工作已经完成，无需自己重写。你可以使用[GLMmath](http://glm.g-truc.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:21:48.100

这可以通过编写一个`vec3`接受三个浮点数的构造函数来实现。

```
class vec3
{
public:
    vec3( float x_, float y_, float z_ )
    : x(x_)
    , y(y_)
    , z(z_)
    {}

    vec3( const vec3 &src )
    {
        *this = src;
    }

    vec3& operator =( const vec3 &src )
    {
        x = src.x;
        y = src.y;
        z = src.z;
        return *this;
    }

    float x;
    float y;
    float z;
}; 
```

更有趣的是如何实现排列行为，比如

```
vec3 a( 1, 2, 3 );
vec3 b = a.yzx; // 2, 3, 1
vec3 c = a.yyx; // 2, 2, 1 
```

# xml - 从 xml 读取数据 - 只读最后一个值

> ID：14838068
> 
> 赞同：0
> 
> 时间：2013-02-12T17:17:13.720
> 
> 标签：xml, actionscript-3, flash, actionscript, flash-cs5

我有 xml 文件，其中包含名称、描述和 Xcor、Ycor 等数据。我在这个地方的舞台上制作了每个对象显示在 xml X 和 Ycor 中我还为每个不同的名称制作了其他 MC - 它运行良好但是当我尝试选项跟踪以显示 MC 的名称在它上滚动后 - 它总是显示名称“Karkow” - 但这是错误的，因为每个 MC 在 xml 文件中都有不同的名称

你知道为什么它总是看到克拉科夫反对其他名字吗？

这是我的 xml 代码：

```
 <?xml version="1.0" encoding="utf-8" ?> 
- <XML>
- <myXMLList>
- <object>
  <name>Warszawa</name> 
  <opis>jakis opis</opis> 
  <Xcor>100</Xcor> 
  <Ycor>50</Ycor> 
  </object>
- <object>
  <name>Wroclaw</name> 
  <opis>jakis opis2</opis> 
  <Xcor>20</Xcor> 
  <Ycor>200</Ycor> 
  </object>
- <object>
  <name>Krakow</name> 
  <opis>jakis opis3</opis> 
  <Xcor>50</Xcor> 
  <Ycor>250</Ycor> 
  </object>
  </myXMLList>
  </XML> 
```

这是我的 as3 代码：

```
import flash.display.MovieClip;
import flash.display.Shape;
import flash.accessibility.Accessibility;
import flash.display.DisplayObject;
import flash.geom.Point;
import flash.events.Event;
import flash.events.MouseEvent;

// Initialize the XML, place the xml file name, initialize the URLRequest
// put URLRequest into a new URLLoader, and add event listener on 
// myLoader listening for when the XML loading is complete
var myXML:XML = new XML();
var XML_URL:String = "miasta.xml";
var myXMLURL:URLRequest = new URLRequest(XML_URL);
var myLoader:URLLoader = new URLLoader(myXMLURL);
myLoader.addEventListener("complete", xmlLoaded);

// Create the xmlLoaded function
function xmlLoaded(event:Event):void {

    // Place the xml data into the myXML object
    myXML = XML(myLoader.data);
    // Initialize and give var name to the new external XMLDocument
    var xmlDoc:XMLDocument = new XMLDocument();
    // Ignore spacing around nodes
    xmlDoc.ignoreWhite = true;
    // Define a new name for the loaded XML that is the data in myLoader
    var menuXML:XML = XML(myLoader.data);
    // Parse the XML data into a readable format
    xmlDoc.parseXML(menuXML.toXMLString());

         // Run the "for each" loop to iterate through all of the menu items listed in the external XML file
         for each (var object:XML in myXML..object) {

                 // Access the value of the "name" node in our external XML file
                 var name:String = object.name.toString();
                 // Access the value of the "opis" node in our external XML file
                 var opis:String = object.opis.toString();
                 // zmiana koordynat na string
                 var Xcor:String = object.Xcor.toString();
                 var Ycor:String = object.Ycor.toString();
                 //change coordinate to number
                 var XcorNum = Number(Xcor);
                 var YcorNum = Number(Ycor);

                 if (name == "Warszawa") {
                     var myMovieClip:MovieClip = new Policja();

                 }

                 else if (name == "Wroclaw") {

                 var myMovieClip:MovieClip = new owal();

                 }

                  else if (name == "Krakow") {

                 var myMovieClip:MovieClip = new city();

                 }
addChild(myMovieClip);
// Set the location of the new MovieClip
myMovieClip.x = XcorNum;
myMovieClip.y = YcorNum;

myMovieClip.addEventListener(MouseEvent.ROLL_OVER, onRollOverHandler);

myMovieClip.buttonMode = true;
myMovieClip.useHandCursor = true;

function onRollOverHandler(myEvent:MouseEvent){
    trace (name);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T09:37:34.320

好的，现在正在工作，我只是添加

**myMovieClip.cityName = 名称；**

对于每个 myMovieClip，最后

```
function onRollOverHandler(e:MouseEvent){
    trace (MovieClip(e.currentTarget),name);
} 
```

感谢帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T19:46:30.483

因为很可能您的 MouseEvent 处理程序被定义为一个闭包。现在，对 name 的每次访问始终是 name 分配给的最后一个值。

我建议将名称指定为您的 MovieClip 的属性，并通过此使用 RollOverHandler 访问它

```
...
for each (var object:XML in myXML..object) {
    var name:String = object.name.toString();

    if (name == "Warszawa") {
        var myMovieClip:MovieClip = new Policja();
    }
    else if (name == "Wroclaw") {
        var myMovieClip:MovieClip = new owal();
    }
    else if (name == "Krakow") {
        var myMovieClip:MovieClip = new city();
    }

    addChild(myMovieClip);
    myMovieClip.cityName = name;
    myMovieClip.addEventListener(MouseEvent.ROLL_OVER, 
        function (myEvent:MouseEvent){
            trace (this.name);
        });
} 
```

ps：我认为您的示例至少缺少一个结束“}”

# c++ - 将qt c ++主窗口始终设置在底部mac osx上

> ID：14838071
> 
> 赞同：2
> 
> 时间：2013-02-12T17:17:25.863
> 
> 标签：c++, macos, qt, window

所以我试图在qt中设置这个窗口/主窗口/应用程序总是在底部（就像总是底部窗口一样）（所以rainmeter以某种方式用他们的小部件做到这一点），但我什至不能让mac osx做这样的事情. 我已经尝试了整个

this->setWindowFlags(Qt::WindowStaysOnBottomHint);

但没有任何运气。有什么提示吗？示例代码很棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T20:24:54.180

有坏消息和好消息。坏消息是它根本没有实施。

好消息是：由于 Qt 是开源的，你可以打开它看看就知道了。如果有错误，您可以提交修复。`QWidget::setWindowFlags`这是交易，在 [qwidget.cpp:9144](http://qt.gitorious.org/qt/qt/blobs/529b30b96435491fc6994515862f44d24efc754f/src/gui/kernel/qwidget.cpp#line9144)的通用代码中你有这个：

```
void QWidget::setWindowFlags(Qt::WindowFlags flags)
{
    if (data->window_flags == flags)
        return;

    Q_D(QWidget);

    if ((data->window_flags | flags) & Qt::Window) {
        // the old type was a window and/or the new type is a window
        QPoint oldPos = pos();
        bool visible = isVisible();
        setParent(parentWidget(), flags);

        // if both types are windows or neither of them are, we restore
        // the old position
        if (!((data->window_flags ^ flags) & Qt::Window)
            && (visible || testAttribute(Qt::WA_Moved))) {
            move(oldPos);
        }
        // for backward-compatibility we change Qt::WA_QuitOnClose attribute value only when the window was recreated.
        d->adjustQuitOnCloseAttribute();
    } else {
        data->window_flags = flags;
    }
} 
```

所以本质上它只是设置`window_flags`。QWidget 的 mac 行为在[qwidget_mac.mm](http://qt.gitorious.org/qt/qt/blobs/4.8/src/gui/kernel/qwidget_mac.mm)中。

您将`Qt::WindowStaysOnBottomHint`在该文件中找不到任何引用。*（虽然**你会发现......）`Qt::WindowStaysOnTopHint`*

我将停止说*“除非你修补 Qt，否则不可能低于 Qt”*。

修补`qwidget_mac.mm`留给读者作为练习。:-)

# ruby-on-rails - Ruby on Rails。搜索条件是存在关联之一的 ActiveRecord 对象

> ID：14838073
> 
> 赞同：0
> 
> 时间：2013-02-12T17:17:30.487
> 
> 标签：ruby-on-rails, ruby, rails-activerecord

我有一个 Rails 代码查询数据库中的员工对象，这些对象有很多`social_url_for_service`（用于各种服务）。它的实现方式是，首先从数据库中获取所有员工，然后使用 Twitter 搜索员工。有什么方法可以直接查找此关联（例如使用 Employee.find() 方法）？

```
@e = Employee.all
@employees = []
@tweets = []
@e.each do |employee|
  if employee.social_url_for_service(:twitter)
    @employees << employee
    @tweets.concat(Twitter.user_timeline(employee.social_url_for_service(:twitter).split('/').last, count: 3))
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:28:39.320

假设`social_url_for_service`是一种获取`social_service_link`与字段关联的方法`service_name`：

```
Employee.joins(:social_service_links).where('social_service_links.service_name = ?', "Twitter") 
```

您需要为您的确切表和字段名称更新它。您还可以挂断`.where`电话，以任何形式的服务返回所有员工。

# javascript - 单击滑动切换 div 但先隐藏其他人 - jQuery

> ID：14838074
> 
> 赞同：5
> 
> 时间：2013-02-12T17:17:31.713
> 
> 标签：javascript, jquery

我有一个页面，当用户单击标题时，以下 div 会切换显示。

我想以某种方式说是否有任何其他 div 是 display:block 然后将它们设置为先不显示。

我有以下...

```
$('.office-title').click(function(){
     $(this).next('div').slideToggle();
     return false;
}); 
```

我的html标记就是这样......

```
<div class="office-row">
    <h3 class="office-title">Title</h3>
    <div class="office">sadasd</div>
</div>
<div class="office-row">
    <h3 class="office-title">Title</h3>
    <div class="office">sadasd</div>
</div>
<div class="office-row">
    <h3 class="office-title">Title</h3>
    <div class="office">sadasd</div>
</div> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-12T17:50:13.830

`</office>`不是有效的结束。收盘应该是`</div>`

```
<div class="office-row">
        <h3 class="office-title">Title</h3>
        <div class="office">sadasd</div>
      </div>
    <div class="office-row">
        <h3 class="office-title">Title</h3>
        <div class="office">sadasd</div>
    </div>
    <div class="office-row">
        <h3 class="office-title">Title</h3>
        <div class="office">sadasd</div>
    </div> 
```

CSS：

```
.office
{
    display: none;
} 
```

和jQuery：

```
$(function () {
    $('.office-title').click(function () {
        $(this).next('div').slideToggle();

        $(this).parent().siblings().children().next().slideUp();
        return false;
    });
}); 
```

[**在这里你可以检查**](http://jsfiddle.net/jubair/nR29B/5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T17:25:36.723

这应该这样做：http: [//jsfiddle.net/gKgJ7/](http://jsfiddle.net/gKgJ7/)

```
$('.office-title').click(function(){
   $('.office').slideUp();
   $(this).next('div').slideToggle();
   return false;
}); 
```

## 笔记：

这不是一个有效的结束：

```
<div class="office">sadasd</office>
   //---------------------^^^^^^^^----should be </div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T17:21:36.667

```
$('.office-title').click(function(){
     $(this).next('div').slideToggle();
     $(this).parent(".office-row").siblings().hide(); // this should help
     return false;
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T17:29:51.277

尝试如下...它会工作...

小提琴：http: [//jsfiddle.net/RYh7U/83/](http://jsfiddle.net/RYh7U/83/)

```
 $(document).ready(function () {
        $('.office-title').next('div').slideToggle();
        $('.office-title').click(function(){   
        $('.office-title').next('div').slideUp();
        $(this).next('div').slideToggle(); 
        return false;
        });
     }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T17:31:35.437

这将用动画关闭所有打开的 div 并打开所需的 div

```
$('.office-title').click(function(){
     var that = $(this);
     if('.office').each(function() {
       if($(this) == $(that).next('div')) {
          $(this).slideToggle();
       }
       else {
          if($(this).css('display')!=='none') {
             $(this).slideToggle();
          }
       }
     });
     return false;
}); 
```

# xcode - iOS：模拟器中的最大内存？

> ID：14838076
> 
> 赞同：1
> 
> 时间：2013-02-12T17:17:32.400
> 
> 标签：xcode, ios-simulator

当我在模拟器中启动我的应用程序时，它会立即崩溃并显示“错误：内存读取失败”

在 iPad/iPhone 上一切正常，但是当我添加一个简单的“return;”时 在核心数据线之前，模拟器启动正常：

```
return;
CCAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
NSManagedObjectContext *context = [appDelegate managedObjectContext]; 
```

重要！！：它不会在任何时候运行该代码，只是编译它。如果我添加“return;” 在另一个文件中的相同核心数据连接之前，它运行良好。看起来有某种与核心数据或其他东西的最大“连接”？

我试过清理 Xcode（正常和清理构建文件夹），清理模拟器（重置内容和设置），但没有成功。

附加问题：有什么办法可以重新安装IOS模拟器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T08:01:29.187

“错误：内存读取失败”。今天早上我收到了同样的消息。我发现它与 Block 相关。

我们知道，如果一个类有一个 Block 作为它的成员，它应该是这样的：

```
@property(nonatomic, copy)BlockType block; 
```

我的错误是在向 NSArray 实例添加块时忘记使用复制：

```
[array addObject:aBlock]; 
```

最后我解决了这个问题：

```
MyBlockType copy = [aBlock copy];
[array addObject:copy];
[copy release]; 
```

祝你好运！

更新 Mar/20/1013 另一种情况导致“错误：内存读取失败”。

```
- (void)blockCalledMethod{
    for (BlockType b in _dictionary) {
        b(self);
    }
} 
```

解决我的问题的关键是使用 .allKeys 迭代 NSDictionary。但是字典中的对象是Block，所以它必须与Block相关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-31T12:20:32.893

我的 iPhone 模拟器也有同样的问题。我在 XCode 中有干净的代码

[![在此处输入图像描述](../Images/4784fe8004a435f3a98d6cc311fb1f66.png)](https://i.stack.imgur.com/R2Ib8.png)

我已经重置了模拟器

[![在此处输入图像描述](../Images/c20052dbc1d26e1b128e8514dec8ccb4.png)](https://i.stack.imgur.com/8cwvN.png)

希望它会有所帮助

# c++ - 具有 GCC 优化的 C++ 代码导致核心在字符串上具有无效的 free()

> ID：14838077
> 
> 赞同：-1
> 
> 时间：2013-02-12T17:17:43.530
> 
> 标签：c++, optimization, gcc

我有使用 gcc (4.1.2) 和 -O2 构建的 C++ 代码。

当此代码在没有优化的情况下编译和运行时，程序执行没有任何问题。

当使用 O1/O2/O3 编译时，代码将崩溃，并显示一个 valgrind 指示无效的空闲。这已缩小到函数内的字符串变量。

代码将读入一个文件，并迭代内容。我已经删除了所有处理代码，下面的代码片段导致核心...

```
int MyParser::iParseConfig(Config &inConfig)
{
    bool keepGoing = true;

    while(keepGoing)
    {
        string valueKey = "";
        keepGoing = false;
    }
    return 0;
} 
```

当它在未优化的情况下运行时，它工作正常。当我构建并运行此优化后，它将无法正常工作。

这似乎是 GCC 优化字符串类的方式的问题。

任何想法我们可以如何规避这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:24:36.490

我无法解释为什么这段代码在使用优化编译时`i`会为您崩溃，可能超过 2 位并且您有缓冲区溢出，也许它有所不同，但无论如何我会更改代码：

```
 sprintf(charIndex, "%d", i++);
    string valueKey = "";
    valueKey.append("Value").append(charIndex);
    string value = inConfig.sFindField(valueKey); 
```

像这样：

```
 stringstream ss;
    ss << "Value" << i++;
    string value(ss.str()); 
```

它更像 C++，应该可以工作。试试看。

如果您想知道这是否真的是缓冲区溢出情况，请插入以下行：

```
 assert(i < 99); 
```

在调用之前`printf`。或使用`snprintf`：

```
 snprintf(charIndex, sizeof(charIndex), "%d", i++); 
```

或者让你的缓冲区更大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T17:24:50.657

如果您溢出 charIndex，（当 i 高于 99 时）谁知道您的程序状态是什么……您声明的存储空间不是很大（2 个字符和一个空值）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T12:26:21.507

这是错误包含头文件的问题 - 在包含列表中存在重复包含的 MyParser.h 文件。这导致了 GCC 优化级别中的字符串优化出现了一些奇怪的情况。

# android - 带有广播接收器的android alertdialog

> ID：14838079
> 
> 赞同：0
> 
> 时间：2013-02-12T17:17:48.990
> 
> 标签：android, broadcastreceiver, android-alertdialog, progressdialog

我的应用程序中有一个网络监视器（使用广播接收器），如果手机未连接到互联网，它会弹出一个警报对话框，如果手机重新连接，它会弹出另一个警报，通知用户他已重新上线。问题是每次监视器看到状态更改时，它都会创建另一个堆叠在另一个窗口之上的窗口。例如，如果手机的 DATA ON/OFF 3 次，它将弹出 6 条消息。如果另一个警报对话框打开，是否有办法关闭警报对话框，或者克服这种情况的最佳方法是什么？

提前感谢您，非常感谢您的帮助。安卓新手

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:48:29.423

添加一个包含当前可见对话框的变量：

```
 Alertdialog a; 
```

然后当你想展示一个时：

```
if (a!=null) {
    a.cancel();
}
a = yourDialogBuilder.show(); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:28:44.567

Dialog 有一个[isShowing()](http://developer.android.com/reference/android/app/Dialog.html#isShowing%28%29) 方法，如果对话框当前可见，该方法应该返回。因此，您可以使用它来查看对话框是否正在显示并使用dismissDialog() 将其隐藏。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-12T17:40:17.003

我认为你应该考虑重新设计你的通知机制。使用`Dialog`可能会非常干扰用户体验，因为它需要一个动作来关闭和中断应用程序的自然流程。

考虑使用`Toast`简单的通知，或者`Notification`如果您希望它显示在状态栏中。此外，您可以在应用程序中使用一些图标来反映当前的*连接状态*，例如绿色已连接，否则为红色。

为确保只有一个对话框可用，您可以`static`在您的对话框中创建一个对话框实例，`activity`如果不是，则`null`在显示新对话框之前将其关闭

# javascript - 在 Raphael javascript 库中不使用 boundingBox 函数获取文本大小

> ID：14838081
> 
> 赞同：1
> 
> 时间：2013-02-12T17:17:51.757
> 
> 标签：javascript, text, size, raphael, metrics

我正在尝试使用 Rahpael 库在 javascript 中创建一些带有文本的按钮。我想在绘制之前知道样式文本的大小以避免这种情况，以便我可以创建适当的背景（按钮）。另外我想避免在画布/纸张之外绘制文本（文本的位置是它的中心位置）。

我可以使用 Raphaels getBBox() 方法，但我必须首先创建（绘制）文本才能做到这一点。所以我绘制文本以获得能够在正确位置绘制它的大小。这很丑陋。所以我正在寻找一些通用方法来估计给定字体、字体大小、系列的样式文本的度量......

[使用 HTML5 画布http://www.html5canvastutorials.com/tutorials/html5-canvas-text-metrics/](http://www.html5canvastutorials.com/tutorials/html5-canvas-text-metrics/)可以做到这一点，但拉斐尔不使用画布。是否有可能使用 Raphael 或纯 Javascript 获取文本指标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T21:03:44.263

有几种方法可以切开这只猫。两个明显的问题很容易浮现在脑海中。

**视野外标尺技术**

这个是最简单的。只需在画布的 viewBox 之外创建一个文本元素，用您的字体信息和文本填充它，然后测量它。

```
// set it up -- put the variable somewhere globally or contextually accessible, as necessary
var textRuler = paper.text( -10000, -10000, '' ).attr( { fill: 'none', stroke: 'none' } );

function getTextWidth( text, fontFamily, fontSize )
{
    textResult.attr( { text: text, 'font-family': fontFamily, 'font-size': fontSize } );
    var bbox = textResult.getBBox();
    return bbox.width;
} 
```

无论如何，它都不优雅。但它会以相对较少的开销和不复杂的方式满足您的需求。

**Cufonized 字体**

如果您愿意考虑使用[cufonized](http://cufon.shoqolate.com/generate/)字体，您可以计算给定文本字符串的大小，而完全不需要弄乱 DOM。事实上，这大概就是 canvas 的 elements`measureText`方法在幕后所做的事情。给定一个导入的字体，你可以简单地做这样的事情（考虑这个 protocode！）

```
//  font should be the result of a call to paper.[getFont][2] for a cufonized font
function getCufonWidth( text, font, fontSize )
{
    var textLength = text.length, cufonWidth = 0;
    for ( var i = 0; i < textLength; i++ )
    {
        var thisChar = text[i];
        if ( ! font.glyphs[thisChar] || ! font.glyphs[thisChar].w )
            continue;  //  skip missing glyphs and/or 0-width entities
        cufonWidth += font.glyphs[thisChar].w / font.face['units-per-em'] * fontSize;
    }
    return cufonWidth;
} 
```

我真的很喜欢使用 cufonized 字体——就它们以有趣的方式制作动画的能力而言，它们比文本更有用。但是第二种方法可能比您需要或想要的更复杂。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-12T20:38:32.560

我知道这看起来很草率，但是绘制文本、测量文本、然后绘制按钮和移动标签应该没有问题。为了安全起见，只需将其从屏幕上绘制出来：

```
var paper = Raphael(0, 0, 500, 500);

var text = paper.text(-100, -100, "My name is Chris");

//outputs 80 12
console.log(text.getBBox().width, text.getBBox().height); 
```

但是，如果这真的冒犯了你的感情——我会理解的！-- 您可以轻松地生成一个对象来记住给定字体的每个字符的宽度：

```
var paper = Raphael(0, 0, 500, 500),
    alphabet = "abcdefghijklmnopqrstuvwxyz";
    font = "Arial",
    charLengths = {},
    ascii_lower_bound = 32,
    ascii_upper_bound = 126;

document.getElementById("widths").style.fontFamily = font;

for (var c = ascii_lower_bound; c <= ascii_upper_bound; c += 1) {
    var letter = String.fromCharCode(c);    
    var L = paper.text(-50, -50, letter).attr("font-family", font);
    charLengths[letter] = L.getBBox().width;
}

//output

for (var key in charLengths) if (charLengths.hasOwnProperty(key)) {
    var row = document.createElement("tr");
    row.innerHTML = "<td>" + key + "</td><td>" + charLengths[key] + "</td>";    
    document.getElementById("widths").appendChild(row);    
} 
```

# excel - 在excel中满足条件时返回文本值

> ID：14838082
> 
> 赞同：0
> 
> 时间：2013-02-12T17:17:54.903
> 
> 标签：excel

在单元格 B3 中输入了一个值。我在单元格 C3 中输入了 200。我在 D3 单元格中输入了 400。

现在在单元格 E3 中，我想显示 B3 中的值小于 C3，单词 Low，或者 B3 是否介于 C3 和 D3 中的值之间，单词 OK，或者 B3 中的值大于 D3，单词 High .

例如，我在 B3 中输入 100。我希望 E3 显示“低”这个词。如果我在 B3 中输入 250，我希望 E3 显示单词 OK，如果我在 B3 中输入 450，我希望显示单词 High。

我将如何在 Excel 中执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T17:30:00.343

该`IF(condition, valueIfTrue, valueIfFalse)`命令是您想要的，但您需要在几个阶段中使用它。

*（在单元格 E3 中）*

```
=IF(B3<C3, "Low", IF(B3>D3, "High", "OK")) 
```

# xml-parsing - 成功转换为 NSURL 并存储为属性的字符串，稍后返回 nil

> ID：14838085
> 
> 赞同：0
> 
> 时间：2013-02-12T17:17:58.210
> 
> 标签：xml-parsing

我正在解析提要中的字符串，将它们转换为 URL，并将它们存储为 FeedItem 的属性。最初，它们已成功转换为 URL 并存储，但后来，当我访问该属性时，它是 nil。

饲料项目.h

```
@interface FeedItem : NSObject

@property (nonatomic, strong) NSString* author;
@property (nonatomic, strong) NSURL* imageURL;
@property (nonatomic, strong) NSString* datePublished;

@end 
```

解析器

```
- (void)parser:(NSXMLParser *)parser
didStartElement:(NSString *)elementName
 namespaceURI:(NSString *)namespaceURI
qualifiedName:(NSString *)qualifiedName
attributes:(NSDictionary *)attributeDict
{
// Custom blog object initialized here
if ([elementName isEqualToString:@"entry"]) {
    self.blogEntry = [[FeedItem alloc] init];
}

// Parse image URL that accompanies some blog entries
self.blogEntry.imageURL = [NSURL URLWithString:[attributeDict objectForKey:@"url"]];
if ([[NSURL URLWithString:[attributeDict objectForKey:@"url"]] isKindOfClass:[NSURL class]]) {
    NSLog( @"converted to a url" );

    if ([self.blogEntry.imageURL isKindOfClass:[NSURL class]]) {
        NSLog(@"property of object is url");
    }else if (!self.blogEntry.imageURL) {
        NSLog(@"url becomes nil");
    }else{
        NSLog(@"property of object is NOT url");
    }
}
} 
```

每次它应该打印“转换为 url”和“对象的属性是 url”。但是，稍后在同一文件中：

```
- (void)parser:(NSXMLParser *)parser
didEndElement:(NSString *)elementName
namespaceURI:(NSString *)namespaceURI
qualifiedName:(NSString *)qName {

if([elementName isEqualToString:@"entry"]) {
    // An individual blog has been parsed and a pointer to it is added to the parsedResults array

    if ([self.blogEntry.imageURL isKindOfClass:[NSURL class]]) {
        NSLog( @"URL passed" );
    }else if (!self.blogEntry.imageURL) {
        NSLog( @"is nil" );
    }else{
        NSLog(@"no luck");
    }

    [self.parsedResults  addObject:self.blogEntry];

}
} 
```

每次都会打印“is nil”。

这是正在解析的 URL 之一的示例： url=' [http://2.bp.blogspot.com/-HlNeYKf6Jyk/URKJ0NzA_kI/AAAAAAAAADY/AAkM6mNITlo/s72-c/Ananya's+Illustration.jpg](http://2.bp.blogspot.com/-HlNeYKf6Jyk/URKJ0NzA_kI/AAAAAAAAADY/AAkM6mNITlo/s72-c/Ananya's+Illustration.jpg) '

我知道如果 URL 具有特殊字符可能会出现问题，但是因为它一开始是成功的，所以我认为这不应该是问题。

我是objective-c的新手……我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T09:39:49.323

在您的`parser:didStartElement:namespaceURI:qualifiedName:attributes:`方法中，您为每个元素设置 self.blogEntry.imageURL。有些元素不包含 url 属性，当字典不包含特定键时，它会返回`nil`- 清除您之前存储在那里的任何值。

为了克服这个问题，你需要这样的代码：

```
- (void)parser:(NSXMLParser *)parser
didStartElement:(NSString *)elementName
namespaceURI:(NSString *)namespaceURI
qualifiedName:(NSString *)qualifiedName 
attributes:(NSDictionary *)attributeDict
{
    // Custom blog object initialized here
    if ([elementName isEqualToString:@"entry"]) {
        self.blogEntry = [[FeedItem alloc] init];
    }

    // Only allow the element containing the url we want to effect the value
    // of imageURL through
    if ([elementName isEqualToString:@"media"]) {

        self.blogEntry.imageURL = [NSURL URLWithString:[attributeDict objectForKey:@"url"]];
        if ([[NSURL URLWithString:[attributeDict objectForKey:@"url"]] isKindOfClass:[NSURL class]]) {
            NSLog( @"converted to a url" );

            if ([self.blogEntry.imageURL isKindOfClass:[NSURL class]]) {
                NSLog(@"property of object is url");
            }else if (!self.blogEntry.imageURL) {
                NSLog(@"url becomes nil");
            }else{
                NSLog(@"property of object is NOT url");
            }
        }

    }
} 
```

考虑查看 Xcode 中的断点以帮助调试此类问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:08:31.280

您的以下代码不能保证实际创建了 blogEntry 对象。

```
// Parse image URL that accompanies some blog entries
self.blogEntry.imageURL = [NSURL URLWithString:[attributeDict objectForKey:@"url"]];
if ([[NSURL URLWithString:[attributeDict objectForKey:@"url"]] isKindOfClass:[NSURL class]]) {
    NSLog( @"converted to a url" );

    if ([self.blogEntry.imageURL isKindOfClass:[NSURL class]]) {
        NSLog(@"property of object is url");
    }else if (!self.blogEntry.imageURL) {
        NSLog(@"url becomes nil");
    }else{
        NSLog(@"property of object is NOT url");
    }
} 
```

仅当开始元素是“条目”时才创建 blogEntry 对象，但您在该块之外访问它而没有任何检查。不保证当您尝试设置图像 URL 时会创建 blogEntry 对象。

尽管这并不能解释为什么您的 imageURL 对象在 didStartElement 回调中有效，但在 didEndElement 回调中无效。我只是说它容易出错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T17:27:53.593

我的猜测是它`self.blogEntry`正在被释放。

这一行：

`self.blogEntry = [[FeedItem alloc] init];`

正在替换以前的`self.blogEntry`. 在调用“didEndElement”方法之前，您的解析器是否可能多次调用它？

或者，被指定`blogEntry`为? 如果没有，它可能会在创建后在方法结束时被释放。`strong``self`

# javascript - Worklight 适配器基本身份验证缓存？

> ID：14838087
> 
> 赞同：1
> 
> 时间：2013-02-12T17:18:01.807
> 
> 标签：javascript, json, adapter, ibm-mobilefirst

我在使用 Worklight 适配器进行基本身份验证时遇到问题。每当我对 REST URL 进行身份验证时，它都会很好地进行身份验证。但是，身份验证似乎在 Worklight 服务器内创建了一个会话。

**示例调用**

```
function getTaskList(username,password) {

    var input = {
        method : 'post',
        returnedContentType : 'json',
        path : 'rest/url',
        headers: {
            'Authorization': 'Basic '+base64Encode(username+':'+password),
        }   
    };

    return WL.Server.invokeHttp(input);
} 
```

每当我尝试从另一台设备登录时，Worklight 服务器都会认为我已经登录。您能否关闭 Worklight 服务器中的会话支持或阻止缓存？我想每次都对 REST URL 进行身份验证。这怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:31:26.390

~~在`<procedure>`适配器 XML 文件的元素中，您应该添加`connectAs="endUser"`. 将使用用户的身份创建与后端的连接。~~

对不起，我没看懂你的问题。

为了每次您需要`connectionPolicy`在适配器 XML 文件中进行身份验证，您需要将`cookiePolicy`Attribute 更改为`IGNORE_COOKIES`

```
<connectionPolicy xsi:type="http:HTTPConnectionPolicyType" cookiePolicy="IGNORE_COOKIES" maxRedirects="int"></connectionPolicy> 
```

# javascript - 从内容页面调用 javascript 不起作用

> ID：14838096
> 
> 赞同：0
> 
> 时间：2013-02-12T17:18:24.860
> 
> 标签：javascript, asp.net, master-pages, code-behind, content-pages

我的应用程序包含一个带有内容页面的 Masterpage。Masterpage 包含通过动态选择和扩展节点来操作树视图的 javascript 函数。在一种情况下，我试图通过内容页面上的代码隐藏来调用 Masterpage 上的 javascript 函数，但 javascript 从未被调用。我在 javascript 中放置了断点，但它们永远不会被击中。

需要发生的是，在项目被删除后，内容页面重新加载，同时我需要调用 javascript 函数。

注意：javascript 确实可以作为整个系统中动态构建的链接运行，并且会遇到断点并且函数会运行。

这是我从以下位置调用 javascript 的代码隐藏方法：

```
 Protected Overrides Sub OnDelete(ByVal SelectedItems As System.Collections.Specialized.NameValueCollection)
        For i As Integer = 0 To SelectedItems.AllKeys.GetLength(0) - 1
            Dim strProjectId As String = SelectedItems.AllKeys(i)
            Dim objProject As New BSProject(strProjectId)
            BSProject.Delete(Val(strProjectId), Page)
            ' log action
            BSActivity.Log(Page.User.SiteUser.intID, "Project Delete", _
                       "Project """ & objProject.strProjectName & """ of Organization """ & _
                       Projects.objOrganization.strName & """ was deleted")
    Next
    Dim script As ClientScriptManager = Page.ClientScript
    script.RegisterStartupScript(GetType(Page), "RefreshProject", "parent.refreshNodeForProjects('" & Projects.objOrganization.intID.ToString() & ":company','" & Projects.objLocation.intID.ToString() & ":location" & "');") ' "parent.refreshNodeForProjects('" & Projects.objOrganization.intID.ToString() & ":company','" & Projects.objLocation.intID.ToString() & ":location" & "');", False)
    If BSConfig.GetValue("ProjectsRefresh") = "1" Then
        Response.Redirect(Request.RawUrl)
    End If
End Sub 
```

这是 MasterPage 上的 javascript 函数：

```
 function refreshNodeForProjects(company, location) {
                    try {
                        var tree = $find("<%= radprojecttree.ClientID %>");
                        if (company != '') {
                            rootnode = tree.findNodeByValue(company);
                            rootnode.set_expanded(false);
                            rootnode.get_treeView().trackChanges();
                            rootnode.get_nodes().clear();
                            rootnode.set_expandMode(2);
                            rootnode.get_treeView().commitChanges();
                            rootnode.set_selected(true);
                            rootnode.set_expanded(true);
                            if (location != '') {
                                rootnode = GetNodebyValue(rootnode, location);
                                rootnode.set_expanded(false);
                                rootnode.get_treeView().trackChanges();
                                rootnode.get_nodes().clear();
                                rootnode.set_expandMode(2);
                                rootnode.get_treeView().commitChanges();
                                rootnode.set_selected(true);
                                rootnode.set_expanded(true);
                            }
                             scrollToNode(tree, rootnode);
                        }

                    }
                    catch (ex) {
                        throw ex;
                    }
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T03:50:32.033

创建动态注册脚本块来处理此问题。

# backbone.js - 使骨干网的 pushState 在 nginx 的子路径中工作

> ID：14838103
> 
> 赞同：2
> 
> 时间：2013-02-12T17:18:44.873
> 
> 标签：backbone.js, nginx, pushstate

我在同一个子域上有两个主干应用程序和一个 API，但是我无法让 pushStates 为具有正确位置正则表达式的应用程序工作。

这是我试图完成的路径

subdomain.domain.org/admin subdomain.domain.org/client subdomain.domain.org/api

我尝试为客户端和管理员配置重写规则，但它总是失败并出现 404 或 500 错误。这样做的正确方法是什么？

这只是我尝试过的所有组合的一个例子：

```
location ~ ^/admin.*$ {
    alias /var/www/project/admin/public
    rewrite ^(.+)$ /index.html last;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T09:38:40.090

[在阅读此https://serverfault.com/questions/361159/nginx-multiple-location-issues#361426](https://serverfault.com/questions/361159/nginx-multiple-location-issues#361426)后，我想通了 ，结果如下：

```
 location ^~ /admin {
            access_log /var/log/nginx/admin.access.log;
            error_log /var/log/nginx/admin.error.log notice;
            alias /var/www/project/admin/public/;
            try_files $uri $uri/ /index.html;
            rewrite ^/admin/(.+/)$ /admin/index.html last;
    }

    location ^~ /client {
            access_log /var/log/nginx/client.access.log;
            error_log /var/log/nginx/client.error.log notice;
            alias /var/www/project/client/public/;
            try_files $uri $uri/ /index.html;
            rewrite ^/client/(.+/)$ /client/index.html last;
    } 
```

# javascript - 在 Javascript 中扩展关联数组的成本？

> ID：14838110
> 
> 赞同：0
> 
> 时间：2013-02-12T17:19:01.593
> 
> 标签：javascript, jquery

因为用 JQuery 找节点的成本很大，所以我构建了一个非常简单的函数

```
window.selectorToObject = {}

function get(selector){
    if(typeof selector === "undefined") 
      return null;
    if(selector in window.selectorToObject) 
      return window.selectorToObject[selector];
    window.selectorToObject[selector] = $(selector);
    return $(selector);
} 
```

因此，`$(selector)`我们将不再这样做，而是简单地`get(selector)`.

经过简单的测试，差异是显着的：

```
<div id="test">
  <div id="child1">
    <div id="child2">
       <div id="child3"></div>
    </div>
  </div>
</div> 
```

![在此处输入图像描述](../Images/c56243275eb24307bf1835bd52c2d6fb.png)

现在我只是担心关联数组的大小会在每个新的`get()`.

在 Javascript 中扩展关联数组的大小是否有任何成本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:25:18.110

这仅在您对同一个选择器进行大量调用时才有帮助。如果您正在这样做，那么是的，它可能会有所帮助，但是如果它们完全相同，您应该将访问缓存在本地范围的变量中。

但是，在动态内容的情况下，您也会**破坏选择器。**如果您稍后调用`get('.mydiv')`然后添加另一个`<div class="mydiv"></div>`，`get()`将返回一个带有最新`div`缺失的对象。

正如您所提到的，这里还有一个内存成本。您正在用速度换取内存占用。一般来说，这不是问题，但 jQuery 选择器的性能也不是问题，除非您正在执行大量选择器调用。

实际上，我怀疑任何人都需要这个。除非确实是个问题，否则不要进行优化。您应该始终有编写好的代码的想法，但要抵制过度优化的冲动。

# javascript - 让分页与自定义轮播一起使用

> ID：14838112
> 
> 赞同：1
> 
> 时间：2013-02-12T17:19:14.533
> 
> 标签：javascript, jquery, slider, carousel

我正在尝试创建一个带有分页的轮播（**[演示）。](http://jsfiddle.net/hyTeq/)**当用户单击底部的块时，它应该循环到相应的图像。下面的**代码**是我目前拥有的。介意控制台mumdo jumbo。现在我正在确定用户是在可见块之后还是之前单击。

```
//grab the width and calculate left value
var item_width = $('#slides li').outerWidth(); 
var left_value = item_width * (-1); 

//if user clicks on pagination block
$('#pagination ul li').click(function() {
    var $this = $(this);
    var temp = $(this).index() + 1;
    var current = $('#pagination li a.active').parent().index() + 1; // console.log(current + " : " + temp );

    if (current <= temp) {
        // get difference of temp and current (temp - current)
        var jump = Math.abs(temp - current);

        //get the right position
        var left_indent = parseInt($('#slides ul').css('left')) - item_width;

        //slide the item
        $('#slides ul').animate({'left' : left_indent}, 300, function () { 

            //active pagination
            $('#pagination li a.active').removeClass('active');
            $this.children().addClass('active');

            //move the first item and put it as last item
            $('#slides li:last').after($('#slides li:first'));                  

            //set the default item to correct position
            $('#slides ul').css({'left' : left_value}); 
            //debugging nonsense
            console.log( "left_indent: " + left_indent + "px" + "\n" + "left_value: " + left_value + "px" + "\n" + "current slide: " + current + "\n" + "future slide: " + temp + "\n" + "difference: " + jump);

        });

    } else if (current >= temp) {
        // get difference of temp and current (temp - current)
        var jump = Math.abs(temp - current);

        //get the right position            
        var left_indent = parseInt($('#slides ul').css('left')) + item_width;

        //slide the item            
        $('#slides ul').animate({'left' : left_indent}, 300,function(){    

            //active pagination
            $('#pagination li a.active').removeClass('active');
            $this.children().addClass('active');

            //move the last item and put it as first item               
            $('#slides li:first').before($('#slides li:last'));           

            //set the default item to correct position
            $('#slides ul').css({'left' : left_value});

            //debugging nonsense
            console.log( "left_indent: " + left_indent + "px" + "\n" + "left_value: " + left_value + "px" + "\n" + "current slide: " + current + "\n" + "future slide: " + temp + "\n" + "difference: " + jump);

        });

    }

}); 
```

我尝试过获取温度和电流的差异：

```
var jump = Math.abs(temp - current); 
```

然后将两者相乘

```
$('#slides ul').animate({'left' : left_indent * jump}, 300, function () { 
$('#slides ul').css({'left' : left_value * jump}); 
```

通过跳跃，但它不起作用。几次跳跃后我得到一个空白区域。

我似乎无法针对 left_indent、left_value 和分页之间的关系。任何帮助表示赞赏。

**jsFiddle：http: [//jsfiddle.net/hyTeq/](http://jsfiddle.net/hyTeq/)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:28:14.567

你的小提琴中有很多代码，所以我创建了一个例子，你可以做些什么来展示你的图片（希望这会让你开始......）：

[**小提琴示例**](http://jsfiddle.net/uvqQe/)

```
$(document).ready(function(){
$('.container div:first').addClass('active');
$('.container div:not(.active)').hide();
$('.pagination div').click(function(){
//Get the index of pagination and store it in VAR
var getPaginationIndex = $(this).index();
//alert(getPaginationIndex);
$('.active').hide().removeClass('active');
//get div and apply stored index of clicked pagination
//and show it...
$('.container div').eq(getPaginationIndex).show().addClass('active');
});
}); 
```

# optimization - 提高 Oracle 视图的性能

> ID：14838114
> 
> 赞同：2
> 
> 时间：2013-02-12T17:19:24.773
> 
> 标签：optimization, view, oracle10g, query-optimization

我有一个要保存为视图的查询：

```
WITH subquery AS ( SELECT aaa_id, ... FROM table_aaa ... )
SELECT subquery.aaa_id, ... FROM table_bbb JOIN subquery USING ( ... )
; 
```

[注意：在现实生活中，我的查询比这复杂得多，有几个`WITH`子查询，许多正在执行`JOINS`，都被`JOIN`一起编辑。但我正在寻找可以用来解决我的问题的一般指导。]

此查询的执行包括全表扫描。这是有道理的，因为`WHERE`子句中不包含任何标准。但是，我可以通过包含这样一个子句来消除大多数全表扫描：

```
WITH subquery AS ( SELECT aaa_id, ... FROM table_aaa ... WHERE aaa_id = :id)
SELECT subquery.aaa_id, ... FROM table_bbb JOIN subquery USING ( ... )
; 
```

`WHERE`但是，当我创建视图时，我似乎无法选择将条件放在正确的位置：

```
CREATE OR REPLACE VIEW vw_my_view AS
WITH subquery AS ( SELECT aaa_id, ... FROM table_aaa ... )
SELECT subquery.aaa_id, ... FROM table_bbb JOIN subquery USING ( ... )
;

SELECT ... FROM vw_my_view WHERE aaa_id = :id
; 
```

在这种情况下，执行计划仍然包含全表扫描。有没有办法让我暗示该`WHERE`子句实际上可以插入到`WITH`子查询中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:32:57.397

我有过类似的经历，虽然我没有通用的解决方案，但我建议如下：

*   运行“SELECT * FROM v$parameter2;” 并确保 _complex_view_merging 已打开。在与它相关的早期 10g 版本之一中存在一个令人讨厌的错误，因此一些 dbas 将其关闭，并且可能在修复后忘记将其重新打开。

*   将所有关于提示的考虑作为最后的措施。根据我的经验，它们对于防止全表扫描很少有用，因为优化器已经尽其所能避免它们。

*   如果您有一个基表，其主键是您最终要过滤视图的内容，请尝试进行设置，以便您的视图的主查询以该表开头，然后加入您复杂的 with 子句查询，*即使那join 是完全多余*的（即让 oracle 有机会在加入复杂位之前对该基表进行简单过滤）。确保将要过滤视图的列是直接从该基表中选择的，而不是从 complex_query 中选择的。所以像

.

```
 with (complicated_query)
     select base_table.key1, complicated_query.*
     from base_table
     join complicated_query on base_table.key1 = complicated_query.key1; 
```

*   如果您有使用不相关子查询的过滤器，请尝试将它们切换为相关等价物（反之亦然）。

*   在 FROM 子句中使用连接语句的顺序和/或从哪个表开始，即使从逻辑上讲它不会对结果产生影响。这是一个有点绝望的策略，但通过这样做，我确实让执行计划变得更好。优化 Oracle 查询并不总是一个合理的过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-19T18:48:08.627

您可以使用此处描述的上下文参数：[在 oracle11g](https://stackoverflow.com/questions/9024696/creating-parameterized-views-in-oracle11g) 或[http://asktom.oracle.com/pls/apex/f?p=100:11:0::::P11_QUESTION_ID:906341500346611919](http://asktom.oracle.com/pls/apex/f?p=100:11:0::::P11_QUESTION_ID:906341500346611919)中创建参数化视图 （“参数化视图 - vs- 带有 where 条件的视图”，以防他们再次更改 URL）

这样，您可以将 WHERE aaa_id = SYS_CONTEXT ('my_namespace', 'aaa_id') 放在视图定义的深处，并像这样使用它：

```
CREATE OR REPLACE VIEW vw_my_view AS
WITH subquery AS ( SELECT aaa_id, ... FROM table_aaa ...
   WHERE aaa_id = SYS_CONTEXT ('my_namespace', 'aaa_id'))
SELECT subquery.aaa_id, ... FROM table_bbb JOIN subquery USING ( ... )
;

DBMS_SESSION.SET_CONTEXT('my_namespace', 'aaa_id', TO_CHAR(:id));
SELECT ... FROM vw_my_view  /* this is not needed any more: WHERE aaa_id = :id */ 
```

谷歌获取更多示例和解释（搜索术语“oracle 中的参数（电子）化视图”）...

# c# - 使用 Twitter API 用户/搜索时出现 401 错误

> ID：14838116
> 
> 赞同：1
> 
> 时间：2013-02-12T17:19:26.130
> 
> 标签：c#, twitter, windows-runtime, twitter-oauth

我有一个应用程序，它允许用户授权我的应用程序，以便它使用 Twitters REST Api。这个过程很好，但是当我尝试执行 GET 请求来搜索哈希标签时，它就崩溃了。我使用的文档如下[https://dev.twitter.com/docs/api/1.1/get/search/tweets](https://dev.twitter.com/docs/api/1.1/get/search/tweets)

所以首先我检查了我的*签名库*与 Twitter 的生成一个。

**矿**

```
GET&https%3A%2F%2Fapi.twitter.com%2F1.1%2Fsearch%2Ftweets.json&oauth_consumer_key%3Dik7trnFwjZ1aoQBajjLv9A%26oauth_nonce%3D500199554%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1360688610%26oauth_token%3D932308590-5KAmpqMDIOC9tcrhVSfwCxMz0ye8BXmhKSQyPb97%26oauth_version%3D1.0%26q%3D%2523ireland 
```

**推特**

```
GET&https%3A%2F%2Fapi.twitter.com%2F1.1%2Fsearch%2Ftweets.json&oauth_consumer_key%3Dik7trnFwjZ1aoQBajjLv9A%26oauth_nonce%3D8522ba23a34a6748d7bd6e2e5b68c56f%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1360681312%26oauth_token%3D932308590-5KAmpqMDIOC9tcrhVSfwCxMz0ye8BXmhKSQyPb97%26oauth_version%3D1.0%26q%3D%2523ireland 
```

这些看起来相当相似，唯一的区别是生成的随机数（不确定这是否是问题）。现在我觉得奇怪的一件事是请求是

```
https://api.twitter.com/1.1/search/tweets.json?q=%23ireland 
```

但是通过查看 Twitters OAuth 工具的签名库，我必须删除 ? 从生成Signuatre Base时的那个请求开始，这看起来很奇怪。

接下来是我的*授权标头*

**矿**

```
Authorization: OAuth oauth_consumer_key="ik7trnFwjZ1aoQBajjLv9A", oauth_nonce="500199554", oauth_signature_method="HMAC-SHA1", oauth_timestamp="1360688610", oauth_token="932308590-5KAmpqMDIOC9tcrhVSfwCxMz0ye8BXmhKSQyPb97", oauth_version="1.0", oauth_signature="aSytUd6HrwAzzAzDyP%2FMqL2qNCE%3D" 
```

**推特**

```
Authorization: OAuth oauth_consumer_key="ik7trnFwjZ1aoQBajjLv9A", oauth_nonce="8522ba23a34a6748d7bd6e2e5b68c56f", oauth_signature="bw0My7Z3ESXDOjsTLYgbTIjGi6s%3D", oauth_signature_method="HMAC-SHA1", oauth_timestamp="1360681312", oauth_token="932308590-5KAmpqMDIOC9tcrhVSfwCxMz0ye8BXmhKSQyPb97", oauth_version="1.0" 
```

唯一的区别是我的签名顺序不同，但是我没有看到任何说明它必须完美匹配的文档。

所以最后我设置了我的实际请求，这很简单

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
            request.Method = "GET";
            request.Headers["Authorization"] = headers;
            HttpWebResponse response = (HttpWebResponse)await request.GetResponseAsync(); 
```

其中 URL 就是上面提到的 URL。当我的方法运行时，我得到 401 响应

```
[System.Net.WebException] = {"The remote server returned an error: (401) Unauthorized."} 
```

有人发现我的实施中有什么问题或者我可能错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-14T19:52:00.173

For your Authorization Headers, I read you should have them in alphabetical order. Your oauth_version and oauth_signature are in a different order than twitters.

# jquery - 检测 flexslider 何时加载第一张幻灯片

> ID：14838118
> 
> 赞同：0
> 
> 时间：2013-02-12T17:19:31.507
> 
> 标签：jquery, flexslider

我正在使用[flexslider](http://www.woothemes.com/flexslider/)，我正在通过 jquery 计算另一个元素的高度/位置，如下所示。虽然`.flexslider ul li img`不起作用。我需要确保 flexslider 幻灯片已完全加载，以便我可以测量它的高度，但我无法定位它。我已经证明了这个概念，`setTimeout()`但我不知道图像在任何给定的服务器上加载需要多长时间，所以我希望它取决于 flexslider 是否处于其最终尺寸。我怎样才能使这项工作。

**回调**（来自文档）：我从文档页面看到这`start: function(){}`是一个“*在滑块加载第一张幻灯片时触发*”的属性，但我现在不知道如何使用它。我想这可能是一个更好的解决方法。

```
var resizeBackground = $('.flexslider ul li img').load(function(){

 $('.home .skin-background').css({
     'display': 'block',
     'height': $fpTop.outerHeight(true) + $quickBar.height() - 1 + 'px',
 });

});

$(window).load(resizeBackground).resize(resizeBackground); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:14:18.407

由于我也想要调整大小的代码，我最终做的有点复杂，但基本上我最终将上面的代码放入一个函数中，而不是调用负载，而是从我像这样实例化 flexslider 的地方调用它

```
$('.flexslider').flexslider({

    ... etc ...

    start: function(slider){

    ... etc ...

        sizeSkin(); // This is the function that I put the code in

    }
}); 
```

# python - 重复中的Python正则表达式组重复

> ID：14838119
> 
> 赞同：-2
> 
> 时间：2013-02-12T17:19:32.143
> 
> 标签：python, regex, regex-group, repeat

我有一个字符串，必须提取。问题是我无法在重复中描述重复。所以这里是代码：

```
f = "Makimak-cg_mk_Mokarmi"
pattern = "([A-Za-z][A-Za-z0-9]+)((?:[-_]([a-z]{2}))+)"
mO = re.match(pattern, f)
print mO.groups() 
```

结果将是：

```
('Makimak', '-cg_mk', 'mk') 
```

但我想得到这样的元组：

```
('Makimak', '-cg_mk', 'cg', 'mk') 
```

所以有一个组“-cg_mk”，其中包括两个字符模式的重复。但没有这样的事情：

```
[a-z]{2}+ 
```

结果的组只返回此处表达的重复的最后一部分：

```
([a-z]{2}) 
```

我的想法是应该有一个像这样的“+”：

```
([a-z]{2})+ 
```

它给出了相同的结果。生成了匹配对象，只是我无法获得我想要的组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:26:36.327

您可能需要分两步执行此操作：

```
>>> f = "Makimak-cg_mk_Mokarmi"
>>> pattern = "([A-Za-z][A-Za-z0-9]+)((?:[-_][a-z]{2})+)"
>>> mO = re.match(pattern, f)
>>> print mO.groups() + tuple(re.split('[-_]', mO.group(2))[1:])
('Makimak', '-cg_mk', 'cg', 'mk') 
```

这只是捕获组`('Makimak', '-cg_mk')`，然后将其与在出现`-`or时拆分第二组的结果相结合`_`。

如果您始终知道两个字符模式的确切数量，则可以通过前瞻来完成此操作，但似乎事先并不知道，否则您不需要重复。

# ios - iOS 中的 Amazon S3 POST 上传

> ID：14838120
> 
> 赞同：5
> 
> 时间：2013-02-12T17:19:36.367
> 
> 标签：ios, post, amazon-s3

我有生成参数的服务器，如 AWSAccessKeyID、acl、策略、签名，用于使用 POST 将文件上传到 S3，如下所示：http: [//doc.s3.amazonaws.com/proposals/post.html](http://doc.s3.amazonaws.com/proposals/post.html)。现在有了这些参数，我需要以某种方式在亚马逊服务器上运行这个请求。似乎我不能使用本机 AWS iOS SDK，因为它的 S3 客户端只能使用 AWS 密钥和密钥进行初始化，它们存储在服务器上而不是设备上。

使用 S3 上的所有参数调用此 POST 请求以上传文件的最佳方法是什么？或者也许有办法为此使用 AWS 开发工具包。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-14T08:51:40.770

好的，如果它对某人有帮助，我设法做到了：

```
NSDictionary* parametersDictionary = @{@"AWSAccessKeyId" : @"YOUR_KEY",
                                                  @"acl" : @"public-read", // or whatever you need
                                                  @"key" : @"filename.ext", // file name on server, without leading /
                                               @"policy" : @"YOUR_POLICY_DOCUMENT_BASE64_ENCODED",
                                            @"signature" : @"YOUR_CALCULATED_SIGNATURE"
                                    };

AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:[NSURL URLWithString: @"http://s3-bucket.s3.amazonaws.com"]];
NSMutableURLRequest *request = [httpClient multipartFormRequestWithMethod:@"POST"
                                                                     path:nil
                                                               parameters:parametersDictionary
                                                constructingBodyWithBlock: ^(id <AFMultipartFormData>formData) {
                                                    [formData appendPartWithFileData:fileData
                                                                                name:@"file" //N.B.! To post to S3 name should be "file", not real file name
                                                                            fileName:@"your_filename"
                                                                            mimeType:@"mime/type"];
                                                }];
AFHTTPRequestOperation* operation = [[AFHTTPRequestOperation alloc] initWithRequest:request]; 
```

如果需要，您可以使用任何其他类型的操作，例如 AFXMLRequestOperation，因为 S3 以 XML 格式返回响应。

如果任何参数丢失或包含无效数据 - 请求将不被接受。

以下是相关背景信息的链接：[Browser Uploads to S3 using HTML POST Forms](http://aws.amazon.com/articles/1434)

# algorithm - 如何仅使用加法和减法从整数序列中获取整数

> ID：14838121
> 
> 赞同：0
> 
> 时间：2013-02-12T17:19:39.103
> 
> 标签：algorithm, numbers, dynamic-programming

例如，给定一个像 4、10、4、7 这样的序列，我们需要得到 10。答案是 4+10-4=10。建议使用什么样的方法。我可以用DP解决它吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T21:31:11.150

我想到的最接近动态编程算法的是以下（Python）：

```
def find_number(numbers, goal):
    # sum 0 can be reached with empty sequence
    found = {0: []}
    # iterate over all numbers in the list
    for n in numbers:
        # update dict of found numbers with m+n and m-n for each m in found
        found = dict([(m + n, path + [+n]) for (m, path) in found.items()] +
                     [(m - n, path + [-n]) for (m, path) in found.items()])
        # check whether the goal number is among them
        if goal in found:
            return found[goal] 
```

除了递归树遍历算法之外，这可能具有防止一些双重工作的优点，因为中间结果（可以达到序列中某个数字的数字）存储在哈希映射中。（也就是说，如果使用第一个数字的多个组合可以达到某个`k`数字，则只有其中一个存储在地图中。）可以通过消除即使添加或减去也可能无法达到目标的中间结果来进行进一步优化所有剩余数字的总和。

尽管如此，就像递归方法一样，最坏情况的复杂性（时间和空间）甚至可能是平均情况的复杂性仍然是列表长度的指数，因为`found`映射的大小在每次迭代中都可以翻倍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:41:24.327

这是 JavaScript 中的一个示例。如果需要，您可以更改序列中的数字。只有在匹配时才会记录结果。

```
var sequence = [4, 10, 4, 7],
    tree = []

for (var i=0; i<sequence.length; i++){
  tree.push([sequence[i], -sequence[i]])
}

function findMatch(arr, match, numSoFar, path, iterations){
  var numSofar1 = numSoFar + arr[iterations][0],
      numSofar2 = numSoFar + arr[iterations][1],
      path1 = path + (arr[iterations][0] > 0 && iterations > 0 ? "+" : "") 
              + String(arr[iterations][0]),
      path2 = path + (arr[iterations][1] > 0 && iterations > 0 ? "+" : "") 
              + String(arr[iterations][1])

  if (numSofar1 == match) console.log(path1)
  else if (numSofar2 == match) console.log(path2)
  else if (iterations < arr.length-1){
    findMatch(arr, match, numSofar1, path1, iterations + 1)
    findMatch(arr, match, numSofar2, path2, iterations + 1)
  }
}

findMatch(tree, 10, 0, "", 0) 
```

# c - 使用 cryptoapi CryptImportKey 导入公钥时出错

> ID：14838123
> 
> 赞同：3
> 
> 时间：2013-02-12T17:19:51.517
> 
> 标签：c, winapi, rsa, public-key-encryption, cryptoapi

我想将公钥 blob 导入 CSP。但发生错误。

```
BYTE pbData[] ={0xEB,0x2A,0x38,0x56,0x86,0x61,0x88,0x7F,0xA1,0x80,0xBD,0xDB,0x5C,0xAB,0xD5,0xF2,0x1C,0x7B,0xFD,0x59,0xC0,0x90,0xCB,0x2D,0x24,0x5A,0x87,0xAC,0x25,0x30,0x62,0x88,0x27,0x29,0x29,0x3E,0x55,0x06,0x35,0x05,0x08,0xE7,0xF9,0xAA,0x3B,0xB7,0x7F,0x43,0x33,0x23,0x14,0x90,0xF9,0x15,0xF6,0xD6,0x3C,0x55,0xFE,0x2F,0x08,0xA4,0x9B,0x35,0x3F,0x44,0x4A,0xD3,0x99,0x3C,0xAC,0xC0,0x2D,0xB7,0x84,0xAB,0xBB,0x8E,0x42,0xA9,0xB1,0xBB,0xFF,0xFB,0x38,0xBE,0x18,0xD7,0x8E,0x87,0xA0,0xE4,0x1B,0x9B,0x8F,0x73,0xA9,0x28,0xEE,0x0C,0xCE,0xE1,0xF6,0x73,0x98,0x84,0xB9,0x77,0x7E,0x4F,0xE9,0xE8,0x8A,0x1B,0xBE,0x49,0x59,0x27,0xAC,0x4A,0x79,0x9B,0x31,0x81,0xD6,0x44,0x24,0x43};
USHORT modulusLengthInBytes = sizeof(pbData);
HCRYPTKEY hPublicKey;
DWORD keyBlobLength = sizeof(BLOBHEADER)+sizeof(RSAPUBKEY)+modulusLengthInBytes;
BYTE* keyBlob = (BYTE*)malloc(keyBlobLength);
BLOBHEADER* blobheader = (BLOBHEADER*) keyBlob;
blobheader->bType    = PUBLICKEYBLOB;
blobheader->bVersion = CUR_BLOB_VERSION;
blobheader->reserved = 0;
blobheader->aiKeyAlg = CALG_RSA_KEYX;
RSAPUBKEY* rsapubkey = (RSAPUBKEY*)keyBlob + sizeof(BLOBHEADER);
rsapubkey->magic     = 0x31415352;
rsapubkey->bitlen    = modulusLengthInBytes*8;
rsapubkey->pubexp    = 65537;         // Or whatever your public exponent is.
BYTE* modulus = keyBlob + sizeof(BLOBHEADER) + sizeof(RSAPUBKEY);
memcpy(modulus, pbData, modulusLengthInBytes);
bRet = CryptImportKey(hProv, keyBlob, keyBlobLength, 0, 0, &hPublicKey);
if (!bRet)
{
    dwRet = GetLastError();
} 
```

`CryptImportKey`返回 0 并且`dwRet`是 0x80090004(NTE_BAD_LEN)。我很确定长度是正确的。但仍然发生同样的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-23T10:23:27.610

```
RSAPUBKEY* rsapubkey = (RSAPUBKEY*)keyBlob + sizeof(BLOBHEADER); 
```

应该改为阅读

```
RSAPUBKEY* rsapubkey = (RSAPUBKEY*) (keyBlob + sizeof(BLOBHEADER)); 
```

# javascript - Drupal 更改 Javascript 字符集和删除元素

> ID：14838125
> 
> 赞同：0
> 
> 时间：2013-02-12T17:20:00.257
> 
> 标签：javascript, drupal, twitter-bootstrap, character-encoding

看来，当我通过 Drupal 运行脚本时，Javascript 被修改了。我正在页面上运行带有 jQ​​uery 1.9.1 的 Bootstrap 以及严格的文档类型。此特定脚本为 Bootstrap 轮播创建导航。有谁知道为什么会发生这种情况：

原始代码：

```
 <script type="text/javascript" charset="utf-8">
            $(document).ready(function() {  
               $('.carousel[id]').each(function() {
                   //For each carousel on the page, create this HTML
                   var html = '<div class="nav-collapse collapse" data-target="' + $(this).attr('id') + '"><ul class="nav">';
                       for(var i = 0; i < $(this).find('.item').size(); i ++) {
                           html += '<li';
                               if(i == 0) {
                                   html += ' class="active"';
                               }
                               var item = $(this).find('.item').get(i);
                                   html += '><a href="#">'  + $(item).attr('data-title') + '</a></li>';
                               }                                    
                               html += '</ul></li>';
                               $('.btn-navbar').after(html);
                               $('.carousel-control.left[href="#' + $(this).attr('id') + '"]').hide();

                   }).bind('slid', function(e) {
                       var nav = $('.nav-collapse[data-target="' + $(this).attr('id') + '"] ul');
                       var index = $(this).find('.item.active').index();
                       var item = nav.find('li').get(index);

                       nav.find('li.active').removeClass('active');
                       $(item).addClass('active');

                       if(index == 0) {
                           $('.carousel-control.left[href="#' + $(this).attr('id') + '"]').fadeOut();
                       } else {
                           $('.carousel-control.left[href="#' + $(this).attr('id') + '"]').fadeIn();
                       }

                       if(index == nav.find('li').size() - 1) {
                           $('.carousel-control.right[href="#' + $(this).attr('id') + '"]').fadeOut();
                       } else {
                           $('.carousel-control.right[href="#' + $(this).attr('id') + '"]').fadeIn();
                       }

                   });

                   $('.nav a').bind('click', function(e) {
                       var index = $(this).parent().index();
                       var carousel = $('#' + $(this).closest('.nav-collapse').attr('data-target'));

                       carousel.carousel(index);
                       e.preventDefault();
                   });
            });
            </script> 
```

Drupal 后生成的源代码（错误在代码中标出）：

```
 <script type="text/javascript" charset="utf-8">
            $(document).ready(function() {  
               $('.carousel[id]').each(function() {
                   //For each carousel on the page, create this HTML
                   var html = '<div class="nav-collapse collapse" data-target="' + $(this).attr('id') + '"><ul class="nav">';
                       for(var i = 0; i &lt; $(this).find('.item').size(); i ++) {                                                  ///&lt replaces < Original Code: for(var i = 0; i &lt; $(this).find('.item').size(); i ++) {    
                           html += '<li';
                               if(i == 0) {
                                   html += ' class="active"';
                               }
                               var item = $(this).find('.item').get(i);
                                   html += '><a href="#">'  + $(item).attr('data-title') + '</a>';                                  ///removed </li> Original Code: html += '><a href="#">'  + $(item).attr('data-title') + '</a>';
                               }                                    
                               html += '</li';></ul>';                                                                              ///adds semicolon and reverses </ul></li> order Original Code: html += '</ul></li>';    
                               $('.btn-navbar').after(html);
                               $('.carousel-control.left[href="#' + $(this).attr('id') + '"]').hide();

                   }).bind('slid', function(e) {
                       var nav = $('.nav-collapse[data-target="' + $(this).attr('id') + '"] ul');
                       var index = $(this).find('.item.active').index();
                       var item = nav.find('li').get(index);

                       nav.find('li.active').removeClass('active');
                       $(item).addClass('active');

                       if(index == 0) {
                           $('.carousel-control.left[href="#' + $(this).attr('id') + '"]').fadeOut();
                       } else {
                           $('.carousel-control.left[href="#' + $(this).attr('id') + '"]').fadeIn();
                       }

                       if(index == nav.find('li').size() - 1) {
                           $('.carousel-control.right[href="#' + $(this).attr('id') + '"]').fadeOut();
                       } else {
                           $('.carousel-control.right[href="#' + $(this).attr('id') + '"]').fadeIn();
                       }

                   });

                   $('.nav a').bind('click', function(e) {
                       var index = $(this).parent().index();
                       var carousel = $('#' + $(this).closest('.nav-collapse').attr('data-target'));

                       carousel.carousel(index);
                       e.preventDefault();
                   });
            });
            </div></script>                                                                                                     ///adds closing div tag 
```

使固定 - -

我的错误出现在 for 循环中：

`for(var i = 0; i > $(this).find('.item').size(); i ++) {`

`i > $(this)`应该 是 `i!=$(this)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T20:04:52.783

我的错误出现在 for 循环中：

`for(var i = 0; i > $(this).find('.item').size(); i ++) {`

`i > $(this)`应该 是 `i!=$(this)`

# java - 如何将 ActiveMQ 生产者连接到 OpenMQ JMS 代理

> ID：14838127
> 
> 赞同：2
> 
> 时间：2013-02-12T17:20:07.447
> 
> 标签：java, jakarta-ee, jms, activemq, openmq

我正在尝试将文本消息从一个摆动的重型客户端（使用 Apache ActiveMQ 库）发送到一个 glassfish 服务器实例，该实例似乎使用 OpenMQ 作为默认的 JMS 提供程序。

在我用于客户的非常源代码基本代码下方：

```
try {
    ActiveMQConnectionFactory connectionFactory = new ActiveMQConnectionFactory("jms/SaisieQueueFactory");
    connectionFactory.setBrokerURL("tcp://localhost:27676");
    Connection connection = connectionFactory.createConnection();
    connection.start();
    Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
    Destination destination = session.createQueue("jms/SaisieQueue");
    MessageProducer producer = session.createProducer(destination);
    producer.setDeliveryMode(DeliveryMode.PERSISTENT);
    TextMessage message = session.createTextMessage("Score + 1");
    producer.send(message);
    session.close();
    connection.close();
} catch(Exception ex) {
    ex.printStackTrace();
} 
```

*   我在 Glassfish 服务器的管理控制台 (JMS_PROVIDER_PORT) 的系统属性中找到了代理端口
*   部署 MessageDrivenBean 时已创建队列连接工厂和队列
*   现在客户端和 glassfish 实例在同一台计算机上运行，​​但我想让它们在两台不同的机器上工作（这就是我不使用 vm:// 作为传输协议的原因）

我得到了这些例外：

```
javax.jms.JMSException: Cannot send, channel has already failed: tcp://127.0.0.1:7676
    at org.apache.activemq.util.JMSExceptionSupport.create(JMSExceptionSupport.java:62)
    at org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1395)
    at org.apache.activemq.ActiveMQConnection.ensureConnectionInfoSent(ActiveMQConnection.java:1481)
    at org.apache.activemq.ActiveMQConnection.start(ActiveMQConnection.java:516)
    at testdate.TestDate.main(TestDate.java:44)
Caused by: org.apache.activemq.transport.InactivityIOException: Cannot send, channel has already failed: tcp://127.0.0.1:7676
    at org.apache.activemq.transport.AbstractInactivityMonitor.doOnewaySend(AbstractInactivityMonitor.java:282)
    at org.apache.activemq.transport.AbstractInactivityMonitor.oneway(AbstractInactivityMonitor.java:271)
    at org.apache.activemq.transport.TransportFilter.oneway(TransportFilter.java:85)
    at org.apache.activemq.transport.WireFormatNegotiator.oneway(WireFormatNegotiator.java:104)
    at org.apache.activemq.transport.MutexTransport.oneway(MutexTransport.java:68)
    at org.apache.activemq.transport.ResponseCorrelator.asyncRequest(ResponseCorrelator.java:81)
    at org.apache.activemq.transport.ResponseCorrelator.request(ResponseCorrelator.java:86)
    at org.apache.activemq.ActiveMQConnection.syncSendPacket(ActiveMQConnection.java:1366)
    ... 3 more 
```

*   我考虑了将 Glassfish 实例的 JMS 提供程序更改为 ActiveMQ 的解决方案，但如果可能的话，我想保留 OpenMQ

PS：我是 JMS 和 Java EE 框架的初学者

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T05:45:29.943

JMS API 定义了一个 java 接口和一个消息传递架构，它没有定义任何特定的有线协议，它可以是一个信鸽，在内存中或任何常见格式（STOMP、OpenWire、AMQP、MQTT）。

为什么不能在客户端中使用 Open MQ 库？这就是 JMS 的设计方式。您应该只需要从 .jar 文件切换并更改`ConnectionFactory`.

我认为没有任何理由仅仅为了使用 ActiveMQ JMS 客户端而切换到 ActiveMQ，因为它应该与 Open MQ 客户端几乎相同。虽然还有其他原因需要切换，例如不同的服务器端功能等等，但您没有提到这一点。

也就是说，有一个桥组件能够通过 STOMP 协议（​​ActiveMQ 支持）公开任何 JMS 服务器。

它被称为[Stomp Connect](http://docs.codehaus.org/display/STOMP/StompConnect)，OpenMQ 页面上有一些[相当古老](http://mq.java.net/stomp-readme.html)的说明如何使用它。

从那里，您应该能够连接指定 STOMP 的 ActiveMQConnection 工厂。但我自己并没有真正尝试过这种组合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T19:29:22.077

AcitveMQ JMS 客户端只能与 ActiveMQ 服务器通信。使用 OpenMQ JMS 客户端与 OpenMQ 服务器通信。

# python - Django Rest 框架令牌认证

> ID：14838128
> 
> 赞同：88
> 
> 时间：2013-02-12T17:20:14.153
> 
> 标签：python, django, django-rest-framework

我已经阅读了 Django Rest Framework Guides 并完成了所有教程。一切似乎都有意义，并且按应有的方式工作。我得到了基本和会话身份验证的工作描述。

[django rest 框架 - api 指南](http://django-rest-framework.org/api-guide)

但是，我在文档的令牌身份验证部分苦苦挣扎，它有点缺乏或没有像教程那样深入。

[django-rest-framework - 令牌认证](http://%20http://django-rest-framework.org/api-guide/authentication/#tokenauthentication)

它说我需要为用户创建令牌，但确实说明了 models.py 的位置？

有人可以为初学者更好地解释文档的令牌身份验证部分吗？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2015-10-27T03:13:54.090

@ian-clelland has already provided the correct answer. There are just a few tiny pieces that wasn't mentioned in his post, so I am going to document the full procedures (I am using Django 1.8.5 and DRF 3.2.4):

1.  Do the following things **BEFORE** you create the superuser. Otherwise, the superuser does not get his/her token created.

2.  Go to **settings.py** and add the following:

    ```
    INSTALLED_APPS = (
        'rest_framework',
        'rest_framework.authtoken',
        'myapp',
    )

    REST_FRAMEWORK = {
        'DEFAULT_PERMISSION_CLASSES': (
            'rest_framework.permissions.IsAuthenticated',
        ),
        'DEFAULT_AUTHENTICATION_CLASSES': (
            'rest_framework.authentication.TokenAuthentication',
        )
    } 
    ```

3.  Add the following code in *myapp*'s **models.py**:

    ```
    from django.db.models.signals import post_save
    from django.dispatch import receiver
    from rest_framework.authtoken.models import Token
    from django.conf import settings

    # This code is triggered whenever a new user has been created and saved to the database
    @receiver(post_save, sender=settings.AUTH_USER_MODEL)
    def create_auth_token(sender, instance=None, created=False, **kwargs):
        if created:
            Token.objects.create(user=instance) 
    ```

    Alternatively, if you want to be more explicit, create a file named **signals.py** under *myapp* project. Put the code above in it, then in **__init__.py**, write `import signals`

4.  Open up a console window, navigate to your project dir, and enter the following command:

    ```
    python manage.py migrate
    python manage.py makemigrations 
    ```

    Take a look in your database, a table named **authtoken_token** should be created with the following fields: key (this is the token value), created (the datetime it was created), user_id (a foreign key that references the auth_user table's id column)

5.  create a superuser with `python manage.py createsuperuser`. Now, take a look at the **authtoken_token** table in your DB with `select * from authtoken_token;`, you should see a new entry has been added.

6.  Using `curl` or a much simpler alternative [httpie](https://github.com/jkbrzt/httpie#installation) to test access to your api, I am using httpie:

    ```
    http GET 127.0.0.1:8000/whatever 'Authorization: Token your_token_value' 
    ```

    That's it. From now on, for any API access, you need to include the following value in the HTTP header (**pay attention to the whitespaces**):

    ```
    Authorization: Token your_token_value 
    ```

7.  (Optional) DRF also provides the ability to return a user's token if you supply the username and password. All you have to do is to include the following in **urls.py**:

    ```
    from rest_framework.authtoken import views

    urlpatterns = [
        ...
        url(r'^api-token-auth/', views.obtain_auth_token),
    ] 
    ```

    Using httpie to verify:

    ```
    http POST 127.0.0.1:8000/api-token-auth/ username='admin' password='whatever' 
    ```

    In the return body, you should see this:

    ```
    {
        "token": "blah_blah_blah"
    } 
    ```

That's it!

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2013-02-12T17:30:55.267

不，不在你的 models.py 中——在模型方面，你需要做的就是`rest_framework.authtoken`在你的`INSTALLED_APPS`. 这将提供一个外键给用户的 Token 模型。

您需要做的是决定何时以及如何创建这些令牌对象。在您的应用程序中，是否每个用户都会自动获得令牌？还是只有某些授权用户？还是只有当他们特别要求时？

如果每个用户都应该有一个令牌，那么在您链接到的页面上会有一段代码向您展示如何设置一个信号来自动创建它们：

```
@receiver(post_save, sender=User)
def create_auth_token(sender, instance=None, created=False, **kwargs):
    if created:
        Token.objects.create(user=instance) 
```

（把*它*放在models.py文件的任何地方，它会在Django线程启动时注册）

如果只应在特定时间创建令牌，那么在您的视图代码中，您需要在适当的时间创建并保存令牌：

```
# View Pseudocode
from rest_framework.authtoken.models import Token

def token_request(request):
    if user_requested_token() and token_request_is_warranted():
        new_token = Token.objects.create(user=request.user) 
```

创建（并保存）令牌后，它将可用于身份验证。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-01-24T00:12:29.090

在 Django 1.8.2 和 rest framework 3.3.2 上，以上所有内容不足以启用基于令牌的身份验证。

虽然 REST_FRAMEWORK 设置在 django 设置文件中指定，但基于函数的视图需要 @api_view 装饰器：

```
from rest_framework.decorators import api_view

@api_view(['POST','GET'])
def my_view(request):
    if request.user.is_authenticated():
       ... 
```

否则根本不执行令牌认证

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2014-01-21T01:32:35.307

只是为了增加我的两分钱，如果您有一个处理用户创建（和激活）的自定义用户管理器，您也可以像这样执行此任务：

```
from rest_framework.authtoken.models import Token
# Other imports

class UserManager(BaseUserManager):

    def create_user(self, **kwargs):
        """
        This is your custom method for creating user instances. 
        IMHO, if you're going to do this, you might as well use a signal.

        """
        # user = self.model(**kwargs) ...
        Token.objects.create(user=user)

    #You may also choose to handle this upon user activation. 
    #Again, a signal works as well here.

    def activate_user(**kwargs):
        # user = ...
        Token.objects.create(user=user) 
```

如果您已经创建了用户，那么您可以下拉到终端中的 python shell 并为您的数据库中的所有用户创建令牌。

```
>>> from django.contrib.auth.models import User
>>> from rest_framework.authtoken.models import Token 
>>> for user in User.objects.all():
>>> ...    Token.objects.create(user=user) 
```

希望有帮助。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-03-02T05:53:51.877

有一种更简洁的方式来获取用户令牌。

只需运行 manage.py shell

接着

```
from rest_framework.authtoken.models import Token
from django.contrib.auth.models import User
u = User.objects.get(username='admin')
token = Token.objects.create(user=u)
print token.key 
```

那么应该在表 DB_Schema.authtoken_token 中找到一条记录

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-09-10T04:38:29.170

除了这里的优秀答案，我想提一个更好的令牌认证方法：JSON Web Token Authentication。[http://getblimp.github.io/django-rest-framework-jwt/](http://getblimp.github.io/django-rest-framework-jwt/)提供的实现非常容易使用。

[此答案](https://stackoverflow.com/a/29440242/1571826)中更详细地解释了这些好处。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-09-19T10:22:32.383

JSON Web Token Authentication 是比 Token Authentication 更好的选择。该项目已使用 Django ( [http://getblimp.github.io/django-rest-framework-jwt/](http://getblimp.github.io/django-rest-framework-jwt/) ) 实现了 JWT Auth，但目前该项目未维护。

对于替代方案，您可以遵循： [https ://github.com/davesque/django-rest-framework-simplejwt](https://github.com/davesque/django-rest-framework-simplejwt)

# android - 如何在图形布局模式下设置 View 的默认 onDraw 以进行预览

> ID：14838131
> 
> 赞同：2
> 
> 时间：2013-02-12T17:20:25.090
> 
> 标签：android, custom-view

我创建了扩展视图的 MyView 类，目标是以某种方式（对问题不重要）绘制点。为了包含点，MyView 具有坐标数组。我还为自定义 MyView 创建了一些属性（例如点的大小、形状、颜色等）。

由于我想在图形布局中预览 MyView 的属性。预览基于 onDraw() 方法，因此如果点数组为空，我不想绘制任何内容（当应用程序在模拟器或移动设备上运行时）但是要进行预览，我想在默认位置绘制几个点。在这两种情况下，数组都是空的，那么我如何检查何时调用 onDraw（在图形布局中预览或运行）或为预览设置不同的 onDraw 方法而不是运行应用程序？

# javascript - 如何使用淘汰赛来迭代一个对象（不是数组）

> ID：14838135
> 
> 赞同：44
> 
> 时间：2013-02-12T17:20:40.393
> 
> 标签：javascript, knockout.js

我想使用类似于 Knockout foreach 构造的东西来迭代对象的属性。这是我正在尝试创建的...

**期望的结果**

```
<table>
    <tr>
        <td>Name 1</td>
        <td>8/5/2012</td>
    </tr>
    <tr>
        <td>Name 2</td>
        <td>2/8/2013</td>
    </tr>
</table> 
```

但是，我的模型看起来像这样......

**JS**

```
function DataModel(){
    this.data = ko.observableArray([{
                        entityId: 1,
                        props: {
                            name: 'Name 1',
                            lastLogin: '8/5/2012'
                        }
                    },
                    {
                        entityId: 2,
                        props: {
                            name: 'Name 2',
                            lastLogin: '2/8/2013'
                        }
                    }]);
}

var dataModel = new DataModel();
ko.applyBindings(dataModel); 
```

每行都有一个 entityId 和 props，它们本身就是一个对象。此模板不起作用，但我将如何更改它以生成上面所需的表格？

编辑：`props`在这个例子中是`name`and `lastLogin`，但我需要一个与里面包含的内容无关的解决方案`props`。

我也有这个[FIDDLE](http://jsfiddle.net/jeljeljel/cwnEE/)。

**HTML**

```
<div data-bind="template: { name: 'template', data: $data }"></div>

<script type="text/html" id="template">
    <table>
        <tr data-bind="foreach: data()">
            <td data-bind="text: entityId"></td>  
        </tr>
    </table> 
</script> 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-11-18T03:34:47.093

在现代浏览器（或使用适当的 polyfill）中，您可以迭代[`Object.keys(obj)`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)（该方法只返回*自己的可枚举属性*，这意味着不需要额外的`hasOwnProperty`检查）：

```
<table>
  <tbody data-bind="foreach: {data: data, as: '_data'}">
    <tr data-bind="foreach: {data: Object.keys(props), as: '_propkey'}">
      <th data-bind="text: _propkey"></th>
      <td data-bind="text: _data.props[_propkey]"></td>
    </tr>
  </tbody>
</table> 
```

[摆弄](http://jsfiddle.net/ovfiddle/d488g/1/)。

**注意：**我只是想看看这是否可行，上面的模板主体比我想在生产中使用的更污染（或者几个月后回来，就像“wtf”）。

自定义绑定将是一个更好的选择，但我个人的偏好是使用计算的 observable 或[可写的计算 observable](http://knockoutjs.com/documentation/computedObservables.html#writeable_computed_observables)（后者在使用`json`响应 a-la restful api 时会很方便）。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2013-02-12T22:22:17.430

您始终可以创建一个绑定处理程序来处理转换。

```
ko.bindingHandlers.foreachprop = {
  transformObject: function (obj) {
    var properties = [];
    ko.utils.objectForEach(obj, function (key, value) {
      properties.push({ key: key, value: value });
    });
    return properties;
  },
  init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
    var properties = ko.pureComputed(function () {
      var obj = ko.utils.unwrapObservable(valueAccessor());
      return ko.bindingHandlers.foreachprop.transformObject(obj);
    });
    ko.applyBindingsToNode(element, { foreach: properties }, bindingContext);
    return { controlsDescendantBindings: true };
  }
}; 
```

然后应用它：

```
<div data-bind="template: { name: 'template', data: $data }"></div>

<script type="text/html" id="template">
    <table>
        <tbody data-bind="foreach: data">
            <tr data-bind="foreachprop: props">
                <td data-bind="text: value"></td>
            </tr>
        </tbody>
    </table> 
</script> 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2014-06-18T21:58:42.570

这是对 Jeff 答案的修改，保留了绑定上下文

```
ko.bindingHandlers.eachProp = {
    transformObject: function (obj) {
        var properties = [];
        for (var key in obj) {
            if (obj.hasOwnProperty(key)) {
                properties.push({ key: key, value: obj[key] });
            }
        }
        return ko.observableArray(properties);
    },
    init: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var value = ko.utils.unwrapObservable(valueAccessor()),
            properties = ko.bindingHandlers.eachProp.transformObject(value);

        ko.bindingHandlers['foreach'].init(element, properties, allBindingsAccessor, viewModel, bindingContext)
        return { controlsDescendantBindings: true };
    },
    update: function(element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var value = ko.utils.unwrapObservable(valueAccessor()),
            properties = ko.bindingHandlers.eachProp.transformObject(value);

        ko.bindingHandlers['foreach'].update(element, properties, allBindingsAccessor, viewModel, bindingContext)
        return { controlsDescendantBindings: true };
    }
}; 
```

现在申请父母和根：

```
<table>
    <tbody data-bind="foreach: data">
        <tr data-bind="eachProp: props">
            <td data-bind="text: value, click: $root.doSomething"></td>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-06-21T15:31:20.667

使用任何基本对象的简化答案，对我有用：

```
<!-- ko foreach: {data: Object.keys(myObj)} -->
    <span data-bind="text: $data"></span> 
    <span data-bind="text: $parent.myObj[$data]"></span>
<!-- /ko --> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-06-01T09:29:04.917

我有点晚了，但我认为这应该可行，一个不使用任何模板的简单解决方案。

```
var json = [
	{
		"PortfolioCompanyId":240,
		"dt":"2018-12-31 00:00:00.0",
		"ValuationDate":"2017-09-30 00:00:00.0",
		"capitalexpenditure":-5555660.0,
		"workingcapitalchange":-812350.0
	},
	{
		"PortfolioCompanyId":240,
		"dt":"2019-12-31 00:00:00.0",
		"ValuationDate":"2017-09-30 00:00:00.0",
		"capitalexpenditure":-5613520.0,
		"workingcapitalchange":-893530.0
	},
	{
		"PortfolioCompanyId":240,
		"dt":"2020-12-31 00:00:00.0",
		"ValuationDate":"2017-09-30 00:00:00.0",
		"capitalexpenditure":-5674130.0,
		"workingcapitalchange":-982850.0
	},
	{
		"PortfolioCompanyId":240,
		"dt":"2021-12-31 00:00:00.0",
		"ValuationDate":"2017-09-30 00:00:00.0",
		"capitalexpenditure":-6241543.0,
		"workingcapitalchange":-1081135.0
	},
	{
		"PortfolioCompanyId":240,
		"dt":"2022-12-31 00:00:00.0",
		"ValuationDate":"2017-09-30 00:00:00.0",
		"capitalexpenditure":-6865697.3,
		"workingcapitalchange":-1189248.5
	}
];

var DataModel = function () {
            this.jsonArray = ko.observable(json);
        };
ko.applyBindings(new DataModel());
```

```
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.2/knockout-min.js"></script>
<table class="table" data-bind="foreach:jsonArray">
       <tr data-bind="foreach:Object.keys($data)"> <!-- JSON Object -->
         <td data-bind="text : $parent[$data]"></td>
       </tr>
    </table> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-05-30T18:10:28.060

```
<table>
    <tr data-bind="foreach: {data: data, as: 'item'}">
        <td data-bind="foreach: { data: Object.keys(item), as: 'key' }">
            <b data-bind="text: item[key]"></b>
        </td>  
    </tr>
</table>

function DataModel(){
this.data = ko.observableArray([{
                    entityId: 1,
                    props: {
                        name: 'Name 1',
                        lastLogin: '8/5/2012'
                    }
                },
                {
                    entityId: 2,
                    props: {
                        name: 'Name 2',
                        lastLogin: '2/8/2013'
                    }
                }]);
}

var dataModel = new DataModel();
ko.applyBindings(dataModel); 
```

希望对您有所帮助（请原谅简洁）

**附录：**

这是一个正在测试的工作示例...

```
<table class="table table-hover">
    <thead>
        <tr>
            <!-- ko foreach: gridOptions.columnDefs -->
            <th data-bind="text: displayName"></th>
            <!-- /ko -->
        </tr>
    </thead>
    <tbody>
        <!-- ko foreach: {data: gridOptions.data, as: 'item'} -->
        <tr>
            <!-- ko foreach: {data: Object.keys(item), as: 'key'} -->
            <td>
                <span data-bind="text: item[key]"></span>
            </td>
            <!-- /ko -->
        </tr>
        <!-- /ko -->
    </tbody>
</table> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-05-28T20:57:05.087

据说，有一个更深层次的问题（[参见 Google groups 上的这个线程](https://groups.google.com/forum/#!topic/knockoutjs/Aia_0JXZxTY)），即 foreach 将对象视为参数字典，而不是要迭代的集合。

到目前为止，我最好的解决方案是结合`foreach`并`Object.keys(myobject)`“与”绑定上下文。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-12T17:28:03.467

（不严格迭代属性，但**确实**创建了上面的表格）

```
<div data-bind="template: { name: 'template', data: $data }"></div>

<script type="text/html" id="template">
    <table data-bind="foreach: data()">
        <tr>
            <td data-bind="text: props.name"></td>  
            <td data-bind="text: props.lastLogin"></td>  
        </tr>
    </table>
</script> 
```

更新：http: [//jsfiddle.net/cwnEE/7/](http://jsfiddle.net/cwnEE/7/)

# python - 尝试在模板中调用我的 Javascript 数组时，为什么会出现 NameError？

> ID：14838137
> 
> 赞同：0
> 
> 时间：2013-02-12T17:20:42.000
> 
> 标签：python, json, pyramid, chameleon

这是定义 jsdata 的主页的可调用视图：

```
@view_config(route_name='home_page', renderer='templates/edit.pt')
def home_page(request):
    if 'form.submitted' in request.params:
        name= request.params['name']
        input_file=request.POST['stl'].filename
        vertices, normals = [],[]
        for line in input_file:
            ....

        ordering=[]

        ...parsing data...

        data=[vertices,ordering]
        jsdata=json.dumps(data)
        renderer_dict = dict(name=name,data=jsdata)
        ...
        html_string = render('tutorial:templates/view.pt', renderer_dict, request=request)
        with open(filename,'w') as file:
                file.write(html_string)
        return HTTPFound(location=request.static_url('tutorial:pages/%(pagename)s.html')% {'pagename':name}) 

    return {} 
```

我也在该文件（views.py）中导入了 json。在这里，它正在 view.pt 模板上呈现。

```
<script>
var data = ${structure:jsdata};
</script> 
```

NameError 指向第二行的 jsdata 部分。为什么会这样？名称错误不是意味着它是未定义的吗？为什么说jsdata未定义？它应该作为关键字传递给渲染函数吗？

另外：我知道该 jsdata 定义下方可能存在错误。我已经包含了该部分，以防它帮助您了解我想用 jsdata 做什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:33:27.223

```
renderer_dict = dict(name=name,data=jsdata) 
```

您将其放入 as`data`而不是`jsdata`. 因此，您希望`${structure:data}`, 或更改`renderer_dict`分配。

# erb - 红宝石和嵌套循环

> ID：14838138
> 
> 赞同：2
> 
> 时间：2013-02-12T17:20:52.670
> 
> 标签：erb, puppet

嗨，我想要一些关于如何在木偶中用 erb 编码的帮助，基本上我有

```
server::actionhost { 'details':
    servername[ 'felix', 'washington', ],
    ipa [ '192.168.43.5', '192.168.43.11', ],
    enviro [ 'prod', 'uat', ],
} 
```

我现在想将它打印到一个文件中，其中每个数组中的每个元素都在一行中，即我的类中模板文件的输出应该是这样的：

```
felix 192.168.43.5 prod
washington 192.168.43.11 uat 
```

当我尝试这样做时，我在模板文件中编写了以下代码：

```
<% servername.each do |name| -%>
<% ipa.each do |ip| -%>
<% enviro.each do |env| -%>
<%= name %> <%= ip %> <%= env %>
<% end -%>
<% end -%>
<% end -%> 
```

但我得到的是网络掩码和 ipa 的递归打印，而不是每个数组的打印，然后移动到下一个数组元素。

希望获得一些有关如何完成正确输出的指导？

谢谢丹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-07T19:13:55.083

试试字典之类的东西怎么样。类似的方法对我有用，希望对您有所帮助。我的问题是，我有不同的变量，每个变量都应该有不同的值或参数。

定义变量如

```
 $file_threshold = {
          'received' => '10',
          'doneJobs' => '20',
          'recvq'    => '30',
          'sendq'    => '40',
          'doneq'    => '50',
          'docq'     => '60',} 
```

在模板文件中

```
<%  @file_threshold.each do |key,value| -%>

cmd = check_file.sh <%=  key %>  <%= value%>

<% end -%> 
```

出去：

```
....
cmd = check_file.sh doneq 50
.... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T01:01:21.433

如果需要，可以在 .erb 中执行 Ruby 代码（以下是 Ruby 代码）。本例中的主要内容是：定义一个多维数组并使用 Ruby 的数组转置方法。

```
<% details = [servername, ipa, env]; transposed = details.transpose; transposed.each {|x| print x.at(0), " ", x.at(1), " ", x.at(2), "\n"}  %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T22:36:56.323

这有点冒险，因为它假设您绝对确定您的阵列排成一行，但是：

...<% servername.each_with_index do |name, i| -%>
.....<%= name %> <%= ipa[i] %> <%= enviro[i] %>
...<% end %>

（请忽略...否则我无法正确显示模板代码！）

# jquery - 如何连接两个ajax请求？

> ID：14838139
> 
> 赞同：0
> 
> 时间：2013-02-12T17:20:54.010
> 
> 标签：jquery, ajax

我有以下代码：

```
<script>
$(function () {
    $('#AdminCreateNewUserSubmit').on('click',function(){
        $("#admincreatenewuserform").ajaxForm(
        {
            target:     '#admincreatenewuserformcenter', 
            url:        'update.php', 
            success:    function(data) 
            {
                $("#admincreatenewuserformcenter").html(data);
            } 
        });
    });
});
</script> 
```

此代码有效，但我需要在给定数据时添加另一个请求。

所以我尝试了以下方法：

```
<script>
$(function () {
    $('#AdminCreateNewUserSubmit').on('click',function(){
        $("#admincreatenewuserform").ajaxForm(
        {
            target:     '#admincreatenewuserformcenter', 
            url:        'update.php', 
            success:    function(data) {
            $("#admincreatenewuserformcenter").html(data);

                $.post("update.php", { cmd:'adminrefreshtabusers' },
                    function(data){ 
                        $('#AdminMenuTabStatisticGenerate').html('');
                        $('#AdminMenuTabStatisticGenerate').html(data);
                    }
                );

            } 
        });
    });
});
</script> 
```

但是这段代码不起作用......

连接两个ajax请求的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:23:52.700

表单请求发送正常，您只是更新了错误的输出字段。`#AdminMenuTabStatisticGenerate`在统计页面上。相反，更新`#users`或其子项之一。

# php - 如果第一次使用 mysqli_fetch_assoc 而第二次使用 mysqli_fetch_array，为什么我没有得到第一行？

> ID：14838143
> 
> 赞同：0
> 
> 时间：2013-02-12T17:21:05.313
> 
> 标签：php

我正在填充数据库列名，以便在侧边栏列表中对我的查询进行排序，`mysqli_fetch_assoc()`并且该页面包含在我`mysqli_fetch_array()`用来填充表行的结果页面上，现在结果页面上有趣的事情是我只得到 3 行在哪里我的数据库有 4 行，少了 1 行，我正在调试整个代码，我发现我正在使用相同`mysqli_fetch_assoc()`的`mysqli_fetch_array()`查询，所以如果我删除`mysqli_fetch_assoc()`它曾经返回我 4 行，但为什么会这样？我没有一点

我以为我会在我的数据库中填充一个逗号分隔的表名称，稍后会爆炸，但经过一些互联网研究后，我遇到了这个`mysqli_data_seek($fetch_results, 0);`问题，它解决了我的问题，但是为什么我少了 1 行，使用`mysqli_data_seek($fetch_results, 0);`它后我返回了所有行那是 4 而不是 3？谁能解释我？

> PS 我在开发定制系统时使用了过多的评估，但这不是这里的问题，它是安全的 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:26:51.370

mysqli_data_seek() 函数查找由 result 表示的结果集中的偏移量指定的任意结果指针。偏移量参数必须在零和总行数减一之间（0..mysqli_num_rows() - 1）。

如需帮助，您需要了解有关您的代码的更多信息...

* * *

[http://www.nusphere.com/kb/phpmanual/function.mysqli-data-seek.htm](http://www.nusphere.com/kb/phpmanual/function.mysqli-data-seek.htm)

# javascript - 使用 jQuery Infinite 滚动脚本加载两页内容（仅需要加载一页时）

> ID：14838154
> 
> 赞同：0
> 
> 时间：2013-02-12T17:21:49.990
> 
> 标签：javascript, jquery, html, tumblr, picturefill

我正在为我的 tumblr 页面编写一个小*jQuery*`jQuery.get()`脚本，该脚本通过我想要从站点的下一页（它是一个**tumblr**站点，所以分页可以）的内容来模拟无限滚动加载。
我知道有一些无限滚动插件，但我尝试过的所有插件都不适合我，而且非常胖。我不需要所有的功能。该脚本会加载我想要的新元素，是的，但问题是每次都从两个页面加载内容。而且，显然，它应该只加载单个页面内容。

*jQuery*是 ：

```
 $(document).ready(function() {
      "use strict";
      var nextPage = 2;
      var totalPages = {TotalPages};
      var url = '/page/'; // base url
      $(document).on('scroll', function() {
        if (nextPage <= totalPages) { // if exist new pages
          if ($(window).scrollTop()== $(document).height() - $(window).height()) { // when reach the page bottom
            $.get(url + nextPage, function(data){ // get the next page
              $(data).find(".post").appendTo(".posts"); // filter content we want and append it to the actual page element
              picturefill(); // reload picturefill,making the new images responsive
            });
            nextPage++; // increment nextpage counter
          };
        } else { // exit if no more pages
          return;
        }
      });
    }); 
```

它加载的内容是：

```
<div class="posts">
<article class="photo-container post" id="{PostID}" data-reblog="{ReblogURL}">
    <div class=" picturefill" data-picture data-alt="" data-class="photo">
        <div class="picturefill" data-src="{PhotoURL-HighRes}" ></div>
        <div class="picturefill" data-src="{PhotoURL-500}" data-media="(max-width: 568px)"></div>
        <div class="picturefill" data-src="{PhotoURL-250}" data-media="(max-width: 250px)"></div>
        <img alt="" class="photo" src="http://img.jpg"> <!-- generated by picturefill -->
        <noscript><img class="photo" src="{PhotoURL-HighRes}" alt=""></noscript>
    </div>
    <!-- MORE CODE -->
</article> 
```

我将[Picturefill](https://github.com/scottjehl/picturefill)用于响应式图像，效果很好。有人有想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-08T20:18:28.357

（在问题编辑中回答。转换为社区 wiki 答案。请参阅[将问题的答案添加到问题本身时的适当操作是什么？](https://meta.stackoverflow.com/questions/267434/what-is-the-appropriate-action-when-the-answer-to-a-question-is-added-to-the-que)）

OP写道：

> 我使用控制变量解决了我的问题，`lastLoadingPos`该变量存储脚本插入页面内容的最后位置（相对于文档）。如果该位置没有改变，则不会进行插入。那是因为多次内容插入发生是因为脚本检测到页面底部已在同一位置多次到达。是的，这解决了问题，但我认为这不是正确的解决方案。只是一种解决方法。如果有人有任何想法，它会很受欢迎：D
> 
> 我的**解决方法**（当然，我仍然需要添加一两件事）：
> 
> ```
> $(document).ready(function() {
>   "use strict";
>   var nextPage = 2;
>   var lastLoadingPos = 0; // stores last insertion position (document related)
>   var totalPages = {TotalPages};
>   var url = '/page/'; // base url
>   $(document).on('scroll', function() {
>     if (nextPage <= totalPages) { // if exist new pages
>       var top = $(window).scrollTop();
>       if ((lastLoadingPos != top) && (top== $(document).height() - $(window).height())) { // when current bottom position reached first time
>         lastLoadingPos = top; // new last insertion position
>         $.get(url + nextPage, function(data){ // get the next page
>           $(data).find(".post").appendTo(".posts");  // filter wanted content
>           picturefill(); // reload picturefill, making new images responsive
>           nextPage++; // increment nextpage counter
>         });
>       }
>     } else { // exit if no more pages
>       return;
>     }
>   });
> }); 
> ```

# asp.net - 加密 WebConfig

> ID：14838156
> 
> 赞同：8
> 
> 时间：2013-02-12T17:21:59.460
> 
> 标签：asp.net

我有一个 Web 应用程序，我使用“发布”选项将其发布到三个 Web 服务器。

我想加密 web 配置文件的连接字符串部分。下面的命令将执行此操作：

```
c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -pef "connectionStrings" c:\inetpub\application 
```

但是，我必须对每台服务器进行 RDP（远程桌面）并在每台服务器上运行命令，因为您不能像这样（从客户端 PC）运行它：

\servername\c$\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -pef "connectionStrings" \servername\c$\inetpub\application

有没有更好的方法来做到这一点：也许：

> 1) 发布后在服务器上执行命令行 2) 在 Visual Studio 中使用构建选项，允许您在发布完成后执行批处理文件

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-24T05:08:27.660

加密服务器上 web.config 的 connectionStrings 部分，然后将此加密部分添加到 web.[CONFIGURATION_FOR_SERVER].config 转换文件。密钥是第一行，它表示用这个新的加密值替换原始 web.config 的 connectionStrings 部分。对于要发布到的每个服务器，您都需要一个新的转换文件。Visual Studio 将引发警告（不是错误），即

```
Warning 15  The element 'connectionStrings' has invalid child element 'EncryptedData' in namespace 'http://www.w3.org/2001/04/xmlenc#'. List of possible elements expected: 'add, remove, clear'.   C:\DevTFS\YourProject\Web.Stage.config  14  6   YourProject 
```

关于这个转换文件的格式——我还没有找到正确的语法来解决这个问题，所以我愿意接受建议，但它仍然有效，所以我很高兴。关于此的完整博客条目：[http ://randomdotnetnuggets.blogspot.com.au/2013/05/publishing-encrypted-connection-strings.html](http://randomdotnetnuggets.blogspot.com.au/2013/05/publishing-encrypted-connection-strings.html)

```
<connectionStrings configProtectionProvider="RsaProtectedConfigurationProvider" xdt:Transform="Replace">
<EncryptedData Type="http://www.w3.org/2001/04/xmlenc#Element"
  xmlns="http://www.w3.org/2001/04/xmlenc#">
  <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc" />
  <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
    <EncryptedKey xmlns="http://www.w3.org/2001/04/xmlenc#">
      <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5" />
      <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
        <KeyName>Rsa Key</KeyName>
      </KeyInfo>
      <CipherData>          
         <CipherValue>t8p7aOZTjMo...zE6FAAI=</CipherValue>
      </CipherData>
    </EncryptedKey>
  </KeyInfo>
  <CipherData>
    <CipherValue>Vy1TZWY8....ic+Qg6T7U</CipherValue>
  </CipherData>
</EncryptedData> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T06:42:20.057

如果无法选择集成安全性，我建议您使用[MS Web Deploy](http://www.iis.net/downloads/microsoft/web-deploy)。

使用 Visual Studio 2012构建[部署包](http://msdn.microsoft.com/en-us/library/dd465323.aspx)时，您将获得一个 zip 文件和命令行脚本文件。您可以修改该脚本文件以加密您的 web.config 或滚动您自己的批处理脚本或 powershell 脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-10T14:19:59.223

这是一个老问题，但这个答案可能会对某人有所帮助。

在负载平衡或 Web 场方案中，您可以加密文件一次并将 web.config 复制到其他计算机。但是，要使其正常工作，您必须为每个网站使用相同的机器密钥。

[https://msdn.microsoft.com/en-us/library/dtkwfdky.aspx](https://msdn.microsoft.com/en-us/library/dtkwfdky.aspx)

希望这可以帮助任何搜索这个的人。

# python - 导入类和 NameError

> ID：14838158
> 
> 赞同：0
> 
> 时间：2013-02-12T17:22:09.693
> 
> 标签：python, oop, nameerror

在这里发布整个实际代码没有多大意义，所以我会尽力概括我的问题。函数（让它命名为 x）在代码的开头定义。然后从单独的 .py 文件中导入类（它有一个方法 z，z 最终调用 x）。该类的对象被创建。调用 z 后，出现“未定义全局名称 'x'”错误。然后我想我将 .py 文件中的所有代码粘贴到一个文件中，将 def(x) 放在它上面，看看会发生什么。当然，它按预期工作。不明白以前的方式有什么问题（我更愿意坚持），它几乎不一样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:22:59.817

全局变量是*每个模块*的，函数在定义它们的模块中查找全局变量。

因此`Foo`，在名为 的模块中定义的类`bar`需要访问名为的函数`spam`，将在它自己的命名空间中查找该函数，因此在模块中`bar`。

如果函数要在导入它们的模块中查找全局变量，则必须重复导入任何想要使用的函数的所有依赖项。这不切实际。

# php - 试图删除除数字以外的所有内容，但正则表达式似乎不起作用

> ID：14838164
> 
> 赞同：-3
> 
> 时间：2013-02-12T17:22:39.910
> 
> 标签：php, regex

我正在尝试从 PHP 中的变量中删除除数字之外的所有内容。我尝试使用正则表达式，很快谷歌就会出现各种各样的人告诉我也使用正则表达式，但似乎没有正则表达式起作用。我正在使用`preg_replace('/\D/', '', $amount);`. 我尝试了各种不同的正则表达式，最值得注意的是`/\D/`, `/[\D]/`, `/^\d/`, `/[^\d]/`, and `/[^0-9]/`，但它们都不起作用。

**编辑：**我找到了为什么它不起作用！我的印象是`preg_replace('/\D/', '', $amount);`会*替换*$amount，但我现在看到我必须`$new_amount = preg_replace('/\D/', '', $amount);`使用 $new_amount。愚蠢，我知道。不管怎么说，还是要谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T17:38:57.957

```
<?php
$amount = '$42,3034534';
// remove extra chars
$str = preg_replace('/[^0-9.,]/', '', $amount);
// replace commas with periods, because PHP doesn't like commas as decimals
$str = preg_replace('/,/', '.', $str);
// convert to float and multiply by 100, use floor() to get rid of fractions of a cent
$cents = floor(floatval($str) * 100);
echo $cents;
// OR
echo floor(floatval(preg_replace('/,/', '.', preg_replace('/[^0-9.,]/', '', $amount))) * 100);
//output: 4230 
```

另外，不要再说“它不起作用”。*它怎么*不工作？你得到什么结果是不正确的？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:30:50.467

尝试，

```
$amount = "abc12de3";
$number = preg_replace("/\D/", "", $amount);
echo $number; 
```

给

```
123 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T17:27:15.413

```
preg_replace('/[^0-9]/', '', $amount); 
```

这对你不起作用？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T17:27:48.830

试试下面的例子。这将从您的字符串中删除任何不是数字的内容。

```
<?php
$string = '!$@^$!!@$^0ls1jlsasl2alfls3ldf4!#$^5jf6k%7==+!*&$#8@(#$(9fdf';
echo preg_replace('/[^\d]+/', '', $string);
//Output: 0123456789 
```

您将需要阅读函数[preg_replace()](http://php.net/manual/en/function.preg-replace.php)。

# python - 类的对象和实例之间的区别

> ID：14838167
> 
> 赞同：3
> 
> 时间：2013-02-12T17:22:44.557
> 
> 标签：python, class, object

这有什么区别：

```
class ThisIsAClass(object)
    pass

print ThisIsAClass()
>> <__main__.ThisIsAClass object at 0x7f0128a8fd10> 
```

和这个？

```
class ThisIsAClass()
    pass

print ThisIsAClass()
>> <__main__.ThisIsAClass instance at 0x7f0128a8fd10> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T17:30:33.360

它的声明类型不同。新式类继承自对象，或从另一个新式类。

```
class NewStyleClass(object):
    pass

class AnotherNewStyleClass(NewStyleClass):
    pass 
```

旧式课程没有。

```
class OldStyleClass():
    pass 
```

好吧，新样式类继承自`object`或其他新样式类。

直到 Python 2.1，旧式类是用户唯一可用的风格。（旧式）类的概念与类型的概念无关：如果 x 是旧式类的实例，则`x.__class__`指定 的类`x`，但`type(x)`始终是`< type 'instance'>`。这反映了一个事实，即所有老式实例，独立于它们的类，都是用一个称为实例的内置类型实现的。

Python 2.2 中引入了新型类来统一类和类型。一种新式类，既不超过也不少于用户定义的类型。If`x`是新式类的实例，则`type(x)`与`x.__class__`.

引入新型类的主要动机是提供具有完整元模型的统一对象模型。

出于兼容性原因，默认情况下类仍然是旧式的。

Python 3 只有新式类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:24:15.510

继承自的一个`object`使用[新式](http://www.python.org/doc/newstyle/)类，而另一个使用旧式类。许多日常用户不会注意到差异，但是在多重继承以及可以使用什么样的漂亮装饰器方​​面存在很大差异。eg`property`只能用于新式类。

这些天建议您使用新样式的类，因此我发现始终从对象继承是一个好习惯，除非您真的有充分的理由避免它。还要注意，如果你曾经切换到 python3.x，你所有的类都会自动变成新样式，所以最好现在就习惯它们:)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T17:24:18.443

第一个是新式类，第二个是旧式类。有关它们的差异，请参阅[文档](http://docs.python.org/2/reference/datamodel.html#new-style-and-classic-classes)。

# sql - 查询时间过长，除了

> ID：14838176
> 
> 赞同：-2
> 
> 时间：2013-02-12T17:23:05.733
> 
> 标签：sql

有没有更短的方法...？？

```
SELECT clid, cldoel, clanker, clprefix, clleerlijn, f1, f2, f3, f4 FROM Clusters  
WHERE clleerlijn like 'WJNLLUI%'   AND (f3 IS NOT NULL  OR f4 IS NOT NULL )
AND clid in(
Select agClid FROM agenda2 as a JOIN evaluaties2 as e ON a.agclid = e.evalclid and agLkrid = evallkrid 
WHERE (agSchoolid='18' and agDatum >=   '2013/01/01' and agDatum <=   '2013/02/12')
GROUP BY agClid
except
(SELECT agClid
FROM agenda2 as a 
    JOIN evaluaties2 as e 
        ON a.agclid = e.evalclid and agLkrid = evallkrid 
WHERE agSchoolid='18' 
    and agLkrid in (1,2932,2935) 
    and agDatum >= '2013/01/01' 
    and agDatum <= '2013/02/12' 
    AND evalWaarde = 3
GROUP BY agclid
HAVING COUNT(DISTINCT agLkrid) = 3)
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:39:32.207

由于相同的 CTE 被使用了两次，所以只有一点点短，但可读性更好：

```
WITH cte(clid) As (
  Select agClid FROM agenda2 as a JOIN evaluaties2 as e ON a.agclid = e.evalclid and agLkrid = evallkrid 
  WHERE (agSchoolid='18' and agDatum >= '2013/01/01' and agDatum <= '2013/02/12')
)
SELECT clid, cldoel, clanker, clprefix, clleerlijn, f1, f2, f3, f4 FROM Clusters  
WHERE clleerlijn like 'WJNLLUI%' AND (f3 IS NOT NULL  OR f4 IS NOT NULL )
AND clid in(
  SELECT DISTINCT agClid FROM cte
  except
  (SELECT agClid FROM cte WHERE agLkrid in (1,2932,2935) AND evalWaarde = 3
   GROUP BY agclid
   HAVING COUNT(DISTINCT agLkrid) = 3
  )
) 
```

我还将第一个 GROUP BY 更改为 SELECT DISTINCT。

如果您正在寻找性能更高的解决方案，这将无济于事。重写的 SQL 语句不会被更快地评估。

# c# - 序列化为 XML 时添加属性

> ID：14838177
> 
> 赞同：3
> 
> 时间：2013-02-12T17:23:14.820
> 
> 标签：c#, xml, xml-serialization

我有这门课

```
public class Audit
{
   public string name { get; set;}
   public DateTime AuditDate { get; set;}

   public long? DepartmentId  {get; set;}
   public string Department { get; set;}

   public long? StateId { get; set;}
   public string? State { get; set; }

   public long? CountryId { get; set; }
   public string Country { get; set; }
} 
```

当我序列化它看起来像这样

```
<Audit>
    <name>George</name>
    <AuditDate>01/23/2013</AuditDate>
    <DepartmentId>10</DepartmentId>
    <Department>Lost and Found</Department>
    <StateId>15</StateId>
    <State>New Mexico</StateId>
    <CountryId>34</CountryId>
    <Country>USA</Country>
</Audit> 
```

我添加了这个类来尝试获取 id 字段作为属性

```
public class ValueWithId
{
   [XmlAttribute ("id")]
   public long? Id { get; set; }

   [XmlText]  // Also tried with [XmlElement]
   public string Description { get; set; }
} 
```

把我的课改写成这个

```
[Serializable]
public class Audit
{
    public string name { get; set;}
    public DateTime AuditDate { get; set;}

    public ValueWithId Department { get; set;}
    public ValueWithId State { get; set; }
    public ValueWithId Country { get; set; }
} 
```

但我收到错误“反映类型审核时出现错误”

我正在尝试将以下内容作为 XML

```
<Audit>
   <name>George</name>
   <AuditDate>01/23/2013</AuditDate>
   <Department id=10>Lost and Found</Department>
   <State id=15>New Mexico</State>
   <Country id=34>USA</Country>
</Audit> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:29:31.627

为类添加`Serializable`属性`ValueWithId`

```
[Serializable]
public class ValueWithId
{
   [XmlAttribute ("id")]
   public long Id { get; set; }

   [XmlText] 
   public string Description { get; set; }
} 
```

如果您查看您的异常，您会发现它很有说服力：

> “无法序列化 System.Nullable`1[System.Int64] 类型的成员 'Id'。XmlAttribute/XmlText 不能用于编码复杂类型。”}

如果您需要在此处序列化可为空的外观： [Serialize a nullable int](https://stackoverflow.com/questions/244953/serialize-a-nullable-int)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:05:46.157

我同意 giammin 的回答，并且有效。如果您想让 id 可以为空，那么我建议您只删除 Id 上方的属性。您将获得与此类似的输出”：

```
<Audit xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <name>George</name>
    <AuditDate>2013-01-23T00:00:00</AuditDate>
    <Department>
    <Id>10</Id>Lost and Found</Department>
    <State>
    <Id>15</Id>New Mexico</State>
    <Country>
    <Id>34</Id>USA</Country>
</Audit> 
```

否则，我不相信它可以序列化可空类型

# zend-framework2 - Zend 框架 2 在模型类中访问全局配置

> ID：14838181
> 
> 赞同：3
> 
> 时间：2013-02-12T17:23:51.223
> 
> 标签：zend-framework2, zend-config

我有一个模型类，它不扩展任何核心 Zend 模块。这个模型是从我以前的 Zend 框架 1 应用程序导入的。我可以通过将其转换为 namespace 来调用它的方法。我遇到的问题是在定义的方法中读取全局配置。

如果是控制器，我可以使用以下代码访问全局配置

```
 $config = $this->getServiceLocator()->get('config'); 

// This gives a union of global configuration along with module configuration . 
```

但是我们应该怎么做才能访问模型类中的配置。下面是我的模型类的样子

```
<?php
namespace test\Http; 

class Request
{

    protected $client;

    public function abc( $c)
    {
        return $something;
    } 

    ......

} 
```

我是 Zend 框架 2 的新手，请建议任何方法来实现这一点。

在上面的描述中，模型意味着（MVC 模型类），其中包含一些业务逻辑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T17:37:08.057

假设你构建了你的服务（你的代码看起来像一个服务），你可能会在服务工厂中实例化它（在这种情况下，我将它放在模块配置中）：

```
class MyModule
{
    public function getServiceConfig()
    {
        return array(
            'factories' => array(
                'my_request_object' => function (
                    \Zend\ServiceManager\ServiceLocatorInterface $sl
                ) {
                    $config = $sl->get('config'); 

                    return new \GaGooGl\Http\Request($config);
                },
            ),
        );
    }
} 
```

这样，您就可以将配置对象直接注入其使用者（无需在使用者中引用服务定位器）

另一种方法是`Zend\ServiceManager\ServiceLocatorAwareInterface`在您的`GaGooGl\Http\Request`. 我[个人不鼓励这样做](http://ocramius.github.com/blog/zf2-and-symfony-service-proxies-with-doctrine-proxies/)，但这基本上允许您让您的`Request`对象在内部保留对服务定位器的引用，因此可以`config`在运行时检索服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-09T06:40:18.240

最简单的方法

```
$config = new \Zend\Config\Config( include APPLICATION_PATH.'/config/autoload/global.php' ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T22:57:59.693

检查[这个](https://stackoverflow.com/questions/12770966/service-locator-in-zend-framework-2)。它有两种解决方案。一种是实现服务定位器感知接口。另一种是将服务管理器注入到您的模型中。对于这两者，您需要通过服务管理器实例化您的模型对象。

# javascript - 错误：$digest 已经在进行中

> ID：14838184
> 
> 赞同：31
> 
> 时间：2013-02-12T17:23:57.477
> 
> 标签：javascript, angularjs, angularjs-directive

我在尝试调用时收到此错误

```
 function MyCtrl1($scope, $location, $rootScope) {
      $scope.$on('$locationChangeStart', function (event, next, current) {
        event.preventDefault();
        var answer = confirm("Are you sure you want to leave this page?");
        if (answer) {
          $location.url($location.url(next).hash());
          $rootScope.$apply();
        }
      });
    }

MyCtrl1.$inject = ['$scope', '$location', '$rootScope']; 
```

错误是

```
Error: $digest already in progress 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-02-12T17:26:56.027

**重复：[在调用 $scope.$apply() 时防止错误 $digest has been in progress](https://stackoverflow.com/questions/12729122/prevent-error-digest-already-in-progress-when-calling-scope-apply)**

你得到的那个错误意味着 Angular 的脏检查已经在进行中。

最近的最佳实践表明，`$timeout`如果我们想在下一次*摘要*迭代中执行任何代码，我们应该使用：

```
$timeout(function() {
  // the code you want to run in the next digest
}); 
```

* * *

**以前的回应：（**不要[使用这种方法](https://github.com/angular/angular.js/wiki/Anti-Patterns)）

使用安全应用，如下所示：

```
$rootScope.$$phase || $rootScope.$apply(); 
```

为什么不反转条件？

```
$scope.$on('$locationChangeStart', function (event, next, current) {                
    if (confirm("Are you sure you want to leave this page?")) {
        event.preventDefault();
    }
}); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-08-06T18:19:10.460

对于希望解决此错误的其他人，值得注意的是，[文档](https://docs.angularjs.org/error/$rootScope/inprog)似乎建议使用该`$timeout`服务来确保代码将在单个`$apply`块中调用。

```
$timeout(function() {
  $scope.someData = someData;
}); 
```

如果您看过去接受的答案，也会在[这个问题中讨论。](https://stackoverflow.com/questions/12729122/prevent-error-digest-already-in-progress-when-calling-scope-apply?lq=1)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-14T04:12:57.320

利用

```
$scope.evalAsync(function(){ 
}); 
```

代替

```
$scope.$apply(function(){
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-11-18T20:35:44.770

josliber 的回答解决了我遇到的类似的 $digest 问题。我刚用

```
$scope.$evalAsync(function(){ 
   // code here
}); 
```

好文章在这里 [https://www.bennadel.com/blog/2605-scope-evalasync-vs-timeout-in-angularjs.htm](https://www.bennadel.com/blog/2605-scope-evalasync-vs-timeout-in-angularjs.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-22T16:27:19.273

因为你的 $scope.$apply() 是在**AngularJs 环境中**的。一般我不会建议你使用 $apply()，而且 $rootScope.$apply() 函数会使你的应用程序运行缓慢。它运行一个新的循环你的整个范围。

# ios - 下载应用程序更新文件时出现“更新失败”

> ID：14838189
> 
> 赞同：0
> 
> 时间：2013-02-12T17:24:13.977
> 
> 标签：ios, ibm-mobilefirst

iOS 上的 Worklight 应用程序拒绝更新，报告“更新失败。下载应用程序更新文件失败”。奇怪的是，它在过去几周内一直在更新。没有提供有关应用程序或 Eclipse 中的 Worklight Console 窗口的更多信息。

我正在使用 Worklight Studio 插件 5.0.0.27。我的 iOS 设备已连接到 Worklight 服务器，并且当前安装的应用程序按预期工作。

如何从 Worklight 中提取描述此故障症状的额外细节？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T16:40:31.957

我发现如果应用程序正在/正在后台运行，就会发生这种情况。

如果您双击并找到并看到对该应用程序的引用，请按住该图标并将其关闭。安卓按住home键，刷掉应用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T11:18:33.910

经过上面的讨论，这个问题的答案是：不幸的是，这在这个时候是不可用的。

# javascript - 使用 chrome 控制台跟踪 javascript 的事件

> ID：14838191
> 
> 赞同：1
> 
> 时间：2013-02-12T17:24:15.480
> 
> 标签：javascript, events, google-chrome, console

是否可以在我的 Chrome 控制台中跟踪不同 javascript 事件的每个步骤：因为我想用它来跟踪带有“事件侦听器断点”的点击事件，但它不起作用（它只跟踪我的 jquery 文件）

最好的

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-12T17:38:07.620

您可以使用简单的 Javascript 片段跟踪任何事件：

```
$(document).live('blur change click dblclick error focus focusin focusout hover keydown keypress keyup load mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup resize scroll select submit', function(event){
  console.log(event);
}); 
```

当然，您可以更改选择器或事件列表。

# javascript - 从映射的网络驱动器获取 UNC 路径

> ID：14838192
> 
> 赞同：3
> 
> 时间：2013-02-12T17:24:18.070
> 
> 标签：javascript, network-programming, unc

我正在寻找一种从映射网络驱动器获取“真实”UNC 路径的方法——这是一个常见问题，但没有使用我想要的语言或方法。

我希望用户能够使用 HTML 表单选择文件但*不能*上传（文件很大）。我想要获得的是文件的完整 UNC 路径。问题是用户通常会从他们映射的网络驱动器（例如 g:\file.txt）中选择文件，这对我没有用 - 我必须有完整的`\\server\user\file.txt`路径。

我知道在 Windows 中，您可以`net use`在命令行中使用有关映射驱动器的信息，也可以`HKEY_CURRENT_USER\Network\driveletter`从 .

我最初的想法是某种形式的 Javascript，但我怀疑注册表项是否可以通过这种方式访问​​。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T17:47:17.800

你可以用一段**非常**简洁的 JavaScript 和一个已经安装的 ActiveX 控件来做到这一点。下面是一个完整的网页，可让您浏览文件，然后在 中显示所选文件的完整 UNC 路径`alert`：

```
<html> 
    <head> 
    <script type="text/javascript" language="JavaScript"> 
    if (typeof String.prototype.startsWith != 'function') {
      // see below for better implementation!
      String.prototype.startsWith = function (str){
        return this.indexOf(str) == 0;
      };
    }

    function getUNCPath() {
        var fileName = document.getElementById("uploadedFile").value;

        var WshNetwork = new ActiveXObject("WScript.Network"); 
        var Drives = WshNetwork.EnumNetworkDrives(); 
        for (i = 0; i < Drives.length; i += 2) {
            if (fileName.startsWith(Drives.Item(i))) {
                var fullPath = fileName.replace(Drives.Item(i), Drives.Item(i + 1));
                alert(fullPath);
                break;
            }
        }
    }
    </script> 
    </head> 
    <body> 
        <form onsubmit="getUNCPath()"> 
            <input type="file" id="uploadedFile"/>
            <input type="submit" value="Get the UNC Path!" /> 
        </form>
        <span id="uncPath"></span>
    </body> 
</html> 
```

# regex - 如何创建交换姓氏，名字中间首字母的正则表达式

> ID：14838194
> 
> 赞同：1
> 
> 时间：2013-02-12T17:24:18.613
> 
> 标签：regex, replace, expression

我正在尝试编写一个将姓氏、名字中间首字母交换为名字姓氏的正则表达式。

所以，例如

```
 doe, john j
    another example: 
 doe, jane 
```

变成

```
john doe
   2nd example results
jane doe 
```

我试过这个：`(\w+?), (.+?)(&|-) ((\w+?),(.+?)(&|-))*(.+)`和这个：`^(\w+), *([\w \.]+)[ ]+-[ ]*(.*)`

都不工作。

任何帮助，将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:27:59.863

替换`^([a-zA-Z]+?),\s*([a-zA-Z]+?)(\s+[a-zA-Z])?$`为`$2 $1`应该适合您的需要。

请注意，我没有使用`\w`该类，因为它也匹配下划线 ( ) 和数字，而且`_`我从未见过姓名为`John_ D0e``;)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:35:07.713

可能这可能会有所帮助：

```
perl -e '$name = "doe, john j"; $name =~ /(.*?), (.*)/is; $fname = $2; $lname = $1; $fname =~ s/\s.*//is; $name = $fname. " " . $lname; print "$name\n";' 
```

# gtk - 如何获取 GtkTreeView 行的坐标

> ID：14838195
> 
> 赞同：1
> 
> 时间：2013-02-12T17:24:19.567
> 
> 标签：gtk, gtktreeview

我正在使用 GtkTreeView 小部件。如果我有一行的 GtkTreeIter，那么如何在整个 GtkTreeView 窗口中获取该行的当前位置（垂直像素坐标）？

我的根本问题是我需要为当前放置在相对于整个 GtkTreeView 窗口的给定垂直坐标处的任何行获取 GtkTreeIter，但我不知道如何。

任何帮助将不胜感激！！提前致谢 ：-）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T09:00:29.213

这个功能：

```
gtk_tree_view_get_path_at_pos (GtkTreeView        *tree_view,
                               gint                x,
                               gint                y,
                               GtkTreePath       **path,
                               GtkTreeViewColumn **column,
                               gint               *cell_x,
                               gint               *cell_y) 
```

会给你一条你可以通过的路径

```
gtk_tree_model_get_iter() 
```

得到一个迭代器。

# ruby - 保存后未真正调用 ActiveRecord 回调 after_save

> ID：14838196
> 
> 赞同：1
> 
> 时间：2013-02-12T17:24:33.903
> 
> 标签：ruby, ruby-on-rails-3, activerecord, callback

有这个：

```
class User < ActiveRecord::Base
  after_save :execute_after_save

  def execute_after_save
    Kernel.puts "Actual object still not saved" if changed?
  end
end 
```

这`Kernel.puts`句话应该被称为**never**因为对象被*保存*后它没有*改变*。

```
1.9.3p286 :003 > u = User.create!(:name => "Wadus Name")
Actual object still not saved
 => #<User id: 1, name: "Wadus Name"> 
1.9.3p286 :004 > u.changed?
 => false 
1.9.3p286 :004 > u.name = "Other Name"
 => "Other Name" 
1.9.3p286 :005 > u.changed?
 => true 
1.9.3p286 :006 > u.save!
Actual object still not saved
 => true 
1.9.3p286 :007 > u.changed?
 => false 
```

查看所有`Actual object still not saved`不应该出现的句子。

我期待在*保存对象后*`after_save`实际调用回调。

 *这种情况让我疯狂，我必须做一些`dirty objects`组合`callbacks`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T17:35:08.773

它在保存之后但在提交之前。

`after_commit`可能是您正在寻找的东西。*

# javascript - 非法的继续声明？

> ID：14838199
> 
> 赞同：32
> 
> 时间：2013-02-12T17:24:42.513
> 
> 标签：javascript, coffeescript

我有类似于以下代码的内容：

```
_.each data, (value, type) ->
    switch type
        when "answered"
            icon = "results_answered"
            label = definitions.results.metrics.ta
        when "leftblank"
            icon = "results_lb"
            label = definitions.results.metrics.tlb
        when "standing"
            icon = "results_standing"
            label = definitions.results.metrics.cs
        when "minimum"
            icon = "results_min"
            label = definitions.results.metrics.lowest
        else
            continue

    metricLine = utilities.div("metricline")
    metricLine.grab utilities.sprite(icon, "metric_icon")
    metricLine.grab utilities.div("metriclabel", label + ":")
    metricLine.grab utilities.div("metricvalue", value)
    metricContainer.grab(metricLine)

metricContainer 
```

但它会向我的浏览器抛出以下错误：

> 未捕获的 SyntaxError：非法的 continue 语句

是否可以在`continue`不抛出错误的情况下包含我正在尝试的内容？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-02-12T17:26:09.880

如果你想继续下一个循环迭代，你想要`return`，而不是`continue`，因为你传递给`each`的是一个函数。

在您提到熟悉 C#`foreach`循环的评论中，因此想要使用`continue`. 不同之处在于，使用 C#`foreach`时，您正在处理一个实际的循环构造，而`each`实际上是为每个循环迭代调用一个函数，所以它不是（在语言级别）循环，所以你不能`continue`这样做。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-12T17:30:11.843

您没有在代码中使用循环构造，而是使用闭包。您只能通过 continue 退出循环。使用下划线每个函数时，您必须通过 return 退出闭包/函数

```
#language construct
for item in items
    if some_condition
        continue

#closure construct
_.each data, (item) ->
    if some_condition
        return 
```

# php - PHP 每 x 天执行一次操作

> ID：14838200
> 
> 赞同：-5
> 
> 时间：2013-02-12T17:24:41.963
> 
> 标签：php, cron

有谁知道如何安排一个php文件每x周采取一次行动？

我更喜欢使用 PHP。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:28:13.583

您应该使用 cron 作业。您可以安排 PHP 脚本通过 cron 运行，因此您真正需要做的就是编写该脚本并阅读 cron 文档 10 分钟或任何可以配置脚本运行的内容。Cron 的配置非常简单，不要害怕。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-12T17:29:10.687

php 脚本“仅”由浏览器执行，（当然）您将需要一个 cron 来执行 bash 脚本，如下所示：

```
php myscript.php 
```

# jquery - Jasmine 中的鼠标事件

> ID：14838202
> 
> 赞同：2
> 
> 时间：2013-02-12T17:24:47.833
> 
> 标签：jquery, jasmine

我是 Jasmine 和 jQuery 的新手，在监视 mousedown 事件时遇到了麻烦。这是我的规范中失败的部分（Jasmine 说尚未调用间谍 mousedown。）我怀疑这可能是因为我触发事件的方式。

```
it("draws a path on mousedown", function() {
  spyOn(drawing,'mousedown');
  $('#canvas').trigger('mousedown');
  expect(drawing.mousedown).toHaveBeenCalled();
  expect(drawing.isDrawing).toEqual(true);
}); 
```

对应的Javascript代码在这里：

```
function Drawing(canvas, eraseAllButton, eraseButton) {
  this.isDrawing = false;
  this.erasing = false;
  this.canvas = canvas;
  this.context = canvas.getContext("2d");
  this.eraseAllButton = eraseAllButton;
  this.eraseButton = eraseButton;

// Sets up event listeners for drawing.
  var self = this;
  this.canvas.addEventListener("mousedown", function () { self.mousedown() }, false);
};

// Begins to draw a path on mousedown.
Drawing.prototype.mousedown = function(e) { 
  if (!e) var e = window.event;
  e.preventDefault();       

  this.isDrawing = true;
  this.x = e.pageX - this.canvas.offsetLeft;
  this.y = e.pageY - this.canvas.offsetTop;
  this.context.beginPath();
  this.context.moveTo(this.x, this.y);
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T22:38:02.017

尝试这个：

```
var mouse = document.createEvent('MouseEvents');
mouse.initMouseEvent('mousedown', true, true, window);
$('#canvas').get(0).dispatchEvent(mouse); 
```

# phpstorm - 在 PHPStorm 中摆脱类周围的边界

> ID：14838204
> 
> 赞同：3
> 
> 时间：2013-02-12T17:24:53.420
> 
> 标签：phpstorm

有没有办法摆脱 PHPStorm 中围绕类的边界线？

![在此处输入图像描述](../Images/2d38567a2a3fabc9fd095f20aa0470cf.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T18:32:39.870

不幸的是，没有选项可以隐藏它们（就像方法分隔符一样）。

但是您可以更改/删除这些线条的颜色，使它们看起来不可见：**设置 | 编辑 | 颜色和字体 | 一般 | 方法分隔符颜色**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-19T14:47:40.617

*PHPStorm 9.0.2 更新：*

现在可以隐藏这些分隔线，而不仅仅是修改它们的颜色以将它们伪装成隐形。您可以像@LazyOne 描述的那样隐藏 Method Separator 行，并且类似地隐藏右边距分隔符：

**设置 > 编辑器 > 颜色和字体 > 常规 > 右边距**

[![隐藏那些丑陋的右边距分隔线](../Images/93febbf946a092e25a5a7539dbe39999.png)](https://i.stack.imgur.com/v5zkM.png)

# apache - Apache / Passenger / Rails 应用程序在启动期间退出

> ID：14838206
> 
> 赞同：0
> 
> 时间：2013-02-12T17:24:54.397
> 
> 标签：apache, passenger, ruby-on-rails-2, ruby-1.8.7

我是 Ruby on Rails 的新手，并且继承了一个相当大的遗留应用程序，我需要在开发环境中运行它。我从头开始创建了一个 OSX Mountain Lion 虚拟机用作我的开发盒。我正在使用 ruby​​ 1.8.7 和 rails 2.2.2 运行。我为 apache2 安装了最新的 phusion 乘客模块。

尝试在 Safari 中加载应用程序时，我收到了这个非常通用的错误消息。apache 日志没有显示任何内容，rails 应用程序的日志没有显示任何内容。似乎很明显，在启动时没有找到一些 gem，并且 init 阶段正在中止。还是 RubyGems 本身不是正确的版本？

同样的应用程序可以使用**ruby​​ 脚本/服务器**运行，我可以在 Web 浏览器中运行其他 Rails 应用程序，所以这个特定的应用程序似乎有些东西。

**有什么方法可以让我看到更多隐藏在引擎盖下的细节吗？**似乎我应该能够访问关键错误消息，该消息会告诉我究竟是什么阻止了应用程序启动。我希望看到某些特定的宝石不存在或其他东西。或者这个回溯是否说了一些我不明白的非常明显的事情？

非常感谢您的帮助。

保罗。

附加说明：

刚刚尝试过单独的乘客（乘客在我的应用程序目录中启动）并且应用程序出现在浏览器中（减去一些静态图像）。这是否说明了我的 apache 配置？

错误信息：

```
Ruby on Rails application could not be started
Phusion Passenger has listed more information about the error below

The aplication has exited during startup (i.e. during the evaluation
of config/environment.rb). The error message may have been written to
the web server's log file. Please check the web server's log file
(i.e. not the (Rails) application's log file) to find out why the
application exited. If that doesn't help, then please use the
backtrace below to debug the problem.

Application root:
/Users/paul/Code/Site4/www_app
Backtrace:
#   File    Line    Location
0   /Users/paul/Code/Site4/www_app/config/environment.rb    29  in `exit'
1   /Users/paul/Code/Site4/www_app/config/environment.rb    29  
2   /Users/paul/.rvm/rubies/ruby-1.8.7-p371/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb   36  in `gem_original_require'
3   /Users/paul/.rvm/rubies/ruby-1.8.7-p371/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb   36  in `require'
4   /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/classic_rails/application_spawner.rb  222 in `preload_application'
5   /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/classic_rails/application_spawner.rb  181 in `initialize_server'
6   /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/utils.rb  563 in `report_app_init_status'
7   /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/classic_rails/application_spawner.rb  174 in `initialize_server'
8   /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/abstract_server.rb    204 in `start_synchronously'
9   /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/abstract_server.rb    180 in `start'
10  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/classic_rails/application_spawner.rb  149 in `start'
11  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/spawn_manager.rb  219 in `spawn_rails_application'
12  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/abstract_server_collection.rb 132 in `lookup_or_add'
13  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/spawn_manager.rb  214 in `spawn_rails_application'
14  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/abstract_server_collection.rb 82  in `synchronize'
15  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/abstract_server_collection.rb 79  in `synchronize'
16  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/spawn_manager.rb  213 in `spawn_rails_application'
17  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/spawn_manager.rb  132 in `spawn_application'
18  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/spawn_manager.rb  275 in `handle_spawn_application'
19  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/abstract_server.rb    357 in `__send__'
20  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/abstract_server.rb    357 in `server_main_loop'
21  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/lib/phusion_passenger/abstract_server.rb    206 in `start_synchronously'
22  /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/helper-scripts/passenger-spawn-server   99 
```

阿帕奇配置：

```
LoadModule passenger_module /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19/ext/apache2/mod_passenger.so
PassengerRoot /Users/paul/.rvm/gems/ruby-1.8.7-p371/gems/passenger-3.0.19
PassengerRuby /Users/paul/.rvm/wrappers/ruby-1.8.7-p371/ruby

<Directory "/Users/paul/Code">
    Order allow,deny
    Allow from all
</Directory>

NameVirtualHost *:80

<VirtualHost *:80>
    RailsEnv development
    ServerName www.local.com
    DocumentRoot /Users/paul/Code/Site4/www_app/public
    <Directory /Users/paul/Code/Site4/www_app/public>
       AllowOverride all
       Options -MultiViews
    </Directory>
 </VirtualHost> 
```

其他版本的东西：

```
rvm list

rvm rubies

=* ruby-1.8.7-p371 [ i686 ]

# => - current
# =* - current && default
#  * - default

DBDev:~ paul$ gem --version
1.8.25
DBDev:~ paul$ rails --version
Rails 2.2.2 
```

宝石清单：

```
*** LOCAL GEMS ***

actionmailer (2.2.2)
actionpack (2.2.2)
activemerchant (1.4.1)
activemodel (3.2.11)
activerecord (2.2.2)
activeresource (2.2.2)
activesupport (3.2.11, 2.2.2)
archive-tar-minitar (0.5.2)
archive-zip (0.3.0)
arel (3.0.2)
builder (3.1.4, 3.0.4)
bundler (1.2.3)
daemon_controller (1.1.1)
deep_merge (0.1.0)
differ (0.1.1)
fastercsv (1.5.0)
fastthread (1.0.7)
haml (2.2.5)
i18n (0.6.1)
io-like (0.3.0)
multi_json (1.5.0)
mysql (2.9.0)
paperclip (2.3.5)
passenger (3.0.19)
rack (1.5.2, 1.5.1)
rails (2.2.2)
rake (10.0.3, 0.8.7)
rmagick (2.13.2)
rubygems-bundler (1.1.0)
rvm (1.11.3.6)
sqlite3 (1.3.7)
tzinfo (0.3.35)
will_paginate (2.3.16) 
```

宝石环境：

```
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.25
  - RUBY VERSION: 1.8.7 (2012-10-12 patchlevel 371) [i686-darwin12.2.1]
  - INSTALLATION DIRECTORY: /Users/paul/.rvm/gems/ruby-1.8.7-p371
  - RUBY EXECUTABLE: /Users/paul/.rvm/rubies/ruby-1.8.7-p371/bin/ruby
  - EXECUTABLE DIRECTORY: /Users/paul/.rvm/gems/ruby-1.8.7-p371/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86-darwin-12
  - GEM PATHS:
     - /Users/paul/.rvm/gems/ruby-1.8.7-p371
     - /Users/paul/.rvm/gems/ruby-1.8.7-p371@global
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

environment.rb 文件：

```
# Be sure to restart your server when you modify this file

# Uncomment below to force Rails into production mode when
# you don't control web/app server and can't set it the proper way
# ENV['RAILS_ENV'] ||= 'production'
ENV['RAILS_ENV'] = 'development'

# Specifies gem version of Rails to use when vendor/rails is not present
RAILS_GEM_VERSION = '2.2.2' unless defined? RAILS_GEM_VERSION

# Bootstrap the Rails environment, frameworks, and default configuration
require File.join(File.dirname(__FILE__), 'boot')

# Global libraries
#require 'rubygems'
gem 'activemerchant', '=1.4.1'
require 'active_merchant'
require 'deep_merge'
require 'fastercsv'
require 'paperclip'

require 'digest/sha1'
require 'net/http'
require 'uri'

# Default host/app types.
if ENV['DEB_HOST_TYPE'].to_s.strip.empty? then
  puts 'ERROR: Environment variable DEB_HOST_TYPE is not set!  (Did you remember to export it?)  Exiting ...'
  exit 1
end
$DEB_HOST_TYPE = ENV['DEB_HOST_TYPE']
$DEB_APP_TYPE = 'admin'

Rails::Initializer.run do |config|
  config.time_zone = 'UTC'
  config.active_record.colorize_logging = false
  config.action_controller.session_store = :active_record_store
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T04:52:43.423

在 environment.rb 文件的行中发现了问题：

```
# Default host/app types.
if ENV['DEB_HOST_TYPE'].to_s.strip.empty? then
  puts 'ERROR: Environment variable DEB_HOST_TYPE is not set!  (Did you remember to export it?)  Exiting ...'
  exit 1
end 
```

环境变量确实为空，因此正在调用出口。puts 字符串从未出现在我看到的任何东西中。终于进去编辑了exit，得到了nil不能转成字符串的错误。我将 ENV['DEB_HOST_TYPE'] 的值硬编码为应有的值，现在应用程序运行了。

还想提一下，当我将 puts 更改为 $stderr.puts 时，该消息显示在乘客生成的错误页面上。

# c - linux随机函数

> ID：14838207
> 
> 赞同：2
> 
> 时间：2013-02-12T17:25:06.480
> 
> 标签：c, linux, function, random, centos5

我正在使用 Linux random() 函数在 CentOS 5.2 中生成随机消息。我想在 3 次随机调用后重置种子。换句话说，我希望在第 1 次通话和第 4 次通话中有相同的输出。有没有办法将 rand() 函数设置为初始状态？或者你知道我能做的任何其他功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:09:44.883

如果你只想重复三个随机数，那么将三个连续的随机数存储在一个数组中，然后重复你的心。

```
int rand_arr[3];
int i;

srandom(time(NULL));   // Not the best way, but I'm lazy. 

for(i = 0; i < 3; i++)
{
   rand_arr[i] = rand();
}

for(i = 0; i < 10000; i++)
{
   printf("%d\n", rand_arr[i % 3];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:33:42.597

您可以简单地记住种子，然后使用它来重置。在 C 中是这样的：

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int main() {
    int seed = time(NULL);
    int i;

    for (i = 0; i < 10; i++) {
        if (!(i % 3)) {
            srandom(seed);
        }

        printf("%d\n", random());
    }
} 
```

# c# - Code First 数据注解和继承

> ID：14838208
> 
> 赞同：1
> 
> 时间：2013-02-12T17:25:11.223
> 
> 标签：c#, entity-framework, ef-code-first

我有这样的课：

```
public class Customer : Entity
{
    [Required]
    public string Forename { get; set; }
    [Required]
    public string Surname { get; set; }

    public virtual ICollection<GazetteerLinks> GazetteerLinks { get; set; }
    public virtual ICollection<Address> Addresses { get; set; }
} 
```

它被 1 到 n 个子类继承。有没有办法可以在某些子类上禁用必需的注释？我不能 100% 确定来自第三方的所有数据集都能满足要求，但我想在我自己创建的数据集上强制执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:36:37.027

我对此有评论和答案。

评论：`Required`在您描述的情况下，该注释不存在任何业务。如果您向第三方授予访问权限并且不确定他们是否需要这些属性，那么您需要将它们设置为可为空。对于您自己的数据集，我强烈建议您使用 ViewModel 对象，然后对该对象进行一些验证，并且只有在它通过验证后才创建数据库对象并将其保存到数据库中。这样您就可以两全其美：您不必担心第 3 方不需要它，而您自己的工作将需要验证。

答案是：我最近在做的一个项目也有类似的情况。我最终做的是使该类成为抽象类，然后覆盖子类中的值。如果您覆盖该属性并具有不同的注释，则 EF 足够聪明，知道只查看用于制作表格的覆盖。

# php - CakePHP 查找没有 HABTM 关系记录的项目

> ID：14838210
> 
> 赞同：3
> 
> 时间：2013-02-12T17:25:18.707
> 
> 标签：php, cakephp, find, cakephp-2.0, has-and-belongs-to-many

简单的说：`Tags HABTM Documents`

有没有办法找到所有`Tags`没有`Document`关联的东西？

我从这个开始：

```
$freeTags = $this->Tag->find('all', array(
            'conditions' => array(
            ),
            'contain' => array(
                'Document'
            ),
            'recursive' => -1
        )) 
```

但我不知道如何获得如下查询：

```
SELECT * FROM tags WHERE id NOT IN (SELECT tag_id FROM documents_tags) 
```

我的 CakePHP 版本是 2.3

编辑：最终的解决方案，`Tag`模型中的一种方法

```
 $db = $this->getDataSource();
    $subQuery = $db->buildStatement(
            array(
                'fields' => array('DocumentsTag.tag_id'),
                'table' => $db->fullTableName($this->DocumentsTag),
                'alias' => 'DocumentsTag',
                'limit' => null,
                'offset' => null,
                'joins' => array(),
                'conditions' => null,
                'order' => null,
                'group' => null
            ), $this->DocumentsTag
    );
    $subQuery = ' Tag.id NOT IN (' . $subQuery . ') ';
    $subQueryExpression = $db->expression($subQuery);

    $conditions[] = $subQueryExpression;

    $freeTags = $this->find('all', compact('conditions')); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T23:58:15.550

作为[CookBook :: 子查询](http://book.cakephp.org/2.0/en/models/retrieving-your-data.html#sub-queries)，你可以做

```
$db = $this->User->getDataSource();
$subQuery = $db->buildStatement(
    array(
        'fields'     => array('"DocumentsTag"."tag_id"'),
        'table'      => $db->fullTableName($this->DocumentsTag),
        'alias'      => 'DocumentsTag',
        'limit'      => null,
        'offset'     => null,
        'joins'      => array(),
        'conditions' => null,
        'order'      => null,
        'group'      => null
    ),
    $this->DocumentsTag
);
$subQuery = ' "Tag"."id" NOT IN (' . $subQuery . ') ';
$subQueryExpression = $db->expression($subQuery);

$conditions[] = $subQueryExpression;

$this->User->find('all', compact('conditions')); 
```

我希望它对你有帮助

# javascript - 将函数作为参数传递时的 Javascript 函数范围问题

> ID：14838211
> 
> 赞同：0
> 
> 时间：2013-02-12T17:25:25.370
> 
> 标签：javascript, class, scope

如果我有以下情况：

```
var ScatterQuadrant = function ScatterQuadrant( id, _width, _height, methods )
{
    this.id = id;
    this.canvas = document.getElementById( id );
    this.canvas.width = _width;
    this.canvas.height = _height;   
    this.ctx = this.canvas.getContext( "2d" );
    methods();

}

function Init()
{
    var scatterQuad = new ScatterQuadrant( 
        "Frame", 800, 600, function()
        {      
            this.ctx.fillStyle = "#FF0000"; // this.ctx isn't going to work, but what will?
            this.ctx.fillRect( 0, 0, 150, 75 ); 
        }
    );

} 
```

你会注意到我已经将一个函数推送到我的 ScatterQuadrant 函数中，我现在想要访问调用函数中的参数 ctx。我将如何去做（见我在代码中的评论）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:28:22.300

看看[MDN 对`this`关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)的介绍（应该叫“context”，“scope”是另外一回事）。在您的情况下，使用[`call()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)就足够了：

```
methods.call(this); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T17:27:23.963

*像这样*调用方法，将始终引用`this`全局*对象*或`undefined`（ES5 严格模式）。

您需要显式设置上下文，`Function.prototype.call`例如使用：

```
methods.call( this ); 
```

# command-line-interface - 关闭 GNU Octave 终端输出

> ID：14838212
> 
> 赞同：6
> 
> 时间：2013-02-12T17:25:26.540
> 
> 标签：command-line-interface, octave

我习惯了 cli，发现 Octave 对于求解线性代数方程和图像处理的东西非常有用。

然而，有一件事让我很恼火——当你有一个大矩阵时，它会输出**每个**变量的值。

有什么办法可以关闭它并手动输出变量的值？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-12T18:05:53.487

我可能误解了您的问题，但看来您需要做的就是在您想要静默运行[的行尾](http://www.gnu.org/software/octave/doc/interpreter/Simple-Examples.html)[添加一个分号 ( )。`;`](http://www.gnu.org/software/octave/doc/interpreter/Simple-Examples.html)

所以而不是：

```
c = a + b 
```

尝试：

```
c = a + b; 
```

您也可以使用[、](http://www.gnu.org/software/octave/doc/interpreter/Command-Line-Options.html)[或](http://www.gnu.org/software/octave/doc/interpreter/Command-Line-Options.html)[命令行 参数](http://www.gnu.org/software/octave/doc/interpreter/Command-Line-Options.html)[调用 Octave`-q``--quiet``--silent`](http://www.gnu.org/software/octave/doc/interpreter/Command-Line-Options.html)以避免打印问候语和版本消息。

# highcharts - 获取下一个 xAxis 标签

> ID：14838213
> 
> 赞同：0
> 
> 时间：2013-02-12T17:25:29.437
> 
> 标签：highcharts

我使用事件函数来显示缩放事件的开始和结束位置。

```
xAxis: {
categories: ['2012-01','2012-02','2012-03'],
                        events: {
                            afterSetExtremes: function(event){
                                if (this.getExtremes().dataMin < event.min)
                                    hcmin = this.getExtremes().min;
                                    hcmax = this.getExtremes().max;
                                    alert(hcmin);
                                    alert(hcmax);

                                }
                            }
                    }, 
```

函数 this.getExtremes().min 将向我显示标签之间的 x 轴点。我喜欢获取最近的标签，例如“2012-02”。但是如何获得？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T12:30:32.373

您可以通过这种方式简单地获取标签：

```
var min = Math.round(event.min);
var label = this.categories[min]; 
```

示例：http: [//jsfiddle.net/j5z5E/6/](http://jsfiddle.net/j5z5E/6/)

# forms - 这是在 Google Analytics 中跟踪 AJAX 表单提交的正确代码吗？

> ID：14838215
> 
> 赞同：0
> 
> 时间：2013-02-12T17:25:33.320
> 
> 标签：forms, events, google-analytics

我想跟踪每次访问者单击 AJAX 联系表单的提交按钮。我在 Google Analytics 中创建了一个事件，并计划在提交按钮代码中添加一些 javascript。

这是当前的提交按钮代码：

```
<button class="button" title="Send" type="submit"><span><span>Send</span></span></button> 
```

这是我添加类别、操作等后代码的外观：

```
<button class="button" title="Send" type="submit" onClick="_gaq.push(['_trackEvent', 'Contact', 'Inquiry', 'Inquiry Form', 0, false]);"><span><span>Send</span></span></button> 
```

这个对吗？有什么建议么？谢谢！

更新 - 这是我看到某种表单验证的 javascript。正如 Crayon Violent 所建议的那样，我想避免跟踪失败的表单提交。现在的问题是我应该在哪里添加 Google Analytics 代码，这样我才能只跟踪成功的表单提交？注意：为了保护网站所有者的隐私，我将域名/品牌替换为“XXXXXX”，您还会注意到这里提到了两种表格，一种是联系表格，另一种是求职者发送简历的表格。好吧，是的，我知道在同一页面上同时显示两个表单有点混乱，可能会使用户感到困惑，但这并不取决于我:(

```
<script type="text/javascript">
//<![CDATA[
var contactForm = new VarienForm('contactForm', true);
var contactFormCv = new VarienForm('contactFormCv', true);

jQuery(function(){

jQuery('#contactForm input, #contactForm textarea').each(function(){
jQuery(this).focus(function(){
jQuery(this).css({'background-position': '1000px 1000px'});
}).blur(function(){
if(jQuery(this).val() == ''){
jQuery(this).css({'background-position': '5px 9px'});
            }
});
});

jQuery('#contactForm').submit(function(){

jQuery('.form-column .message', form).remove();

var form = jQuery(this);
var message = jQuery('<div class="message"></div>');

jQuery('.form-column', form).append(message);

if(contactForm.validator.validate()){

jQuery(message).html('<img                  src="http://www.XXXXXX.com/skin/frontend/np/XXXXXX/images/XXXXXX/sending-contact.gif" />');

            var data = '';
            jQuery('input, select, textarea', this).each(function(){
                var name = jQuery(this).attr('name');
                var val = jQuery(this).val();

                data = data+name+'='+val+'&';

            });

            jQuery.ajax({
                type: "POST",
                url: jQuery(this).attr('action'),
                data: data,
                success: function(data){
                    if(data == 'true'){
                        jQuery('input, select, textarea', form).val('').css({'background-position': '5px 9px'});
                        jQuery(message).html('Mensaje enviado.');
                    }
                }
            });
        }
        return false;
    });

    var iframe = jQuery('<iframe></iframe>').attr({id: 'uploadcv', name: 'uploadcv', scrolling: 'none', frameborder: 0}).addClass('uploadcv').css({height: 0, width: 0, border: 0, display: 'none'});
    jQuery('#contactFormCv').attr({target: 'uploadcv'}).submit(function(){

        var form = jQuery(this);
        var message = jQuery('<div class="message"></div>');

        form.after().append(message);

        if(contactFormCv.validator.validate()){
            jQuery(message).html('<img src="http://www.XXXXXX.com/skin/frontend/np/XXXXXX/images/XXXXXX/sending-contact.gif" />');
            iframe.load(function(){
                jQuery('input, select', form).val('');
                jQuery(message).html('Mensaje enviado.');
            });
        }

    }).after().append(iframe);

}); 
```

//]]>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T19:35:40.517

假设您有基本的页面 GA 代码，它应该“工作”，但这里有一些关于您当前拥有它的行为的考虑......每次按下该按钮时，该代码都会触发。因此，如果您有表单验证（无论是服务器端还是客户端），并且访问者未能正确填写表单并收到错误消息......那么您只是跟踪了一个失败的表单提交。现在假设访问者再次尝试并再次失败。现在你有 2 次点击。第三次是一个魅力，他做对了，表格成功提交，你现在有 3 个点击出现在 GA 中，你不知道有多少点击成功与否。如果你不关心这个，那么你很高兴。

但作为最佳实践，大多数人实施跟踪以触发不同的值来细分成功或失败，或者仅跟踪成功的表单提交。因此，如果您在页面上进行了 javascript 表单验证以确保正确填写字段，那么在通过验证后，您确实应该将该 GA 代码放入您的验证代码中。或者，如果表单验证代码是服务器端的，则您应该输出代码并返回任何“谢谢”对话框。

编辑以响应您发布的代码：

如果没有完整的页面上下文或测试，就不可能 100%，但看起来你想把它放在这里：

```
success: function(data){
  if(data == 'true'){
    jQuery('input, select, textarea', form).val('').css({'background-position': '5px 9px'});
    jQuery(message).html('Mensaje enviado.');
    _gaq.push(['_trackEvent', 'Contact', 'Inquiry', 'Inquiry Form', 0, false]);
  }
} 
```

# sql-server - 是用 #TEMP 表替换吗？

> ID：14838223
> 
> 赞同：4
> 
> 时间：2013-02-12T17:26:10.363
> 
> 标签：sql-server, sql-server-2008, tsql, common-table-expression

因此，根据我所看到的`WITH`使用方式以及[MSDN 上的文档](http://msdn.microsoft.com/en-us/library/ms175972.aspx)：

> 指定一个临时命名结果集，称为公用表表达式 (CTE)。

似乎`WITH`是表的替代品`#TEMP`。那是对的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-12T17:28:10.193

不。CTE——由——引入的——`WITH`不要替换临时表，尽管在某些情况下，它们可以用于过去可能使用临时表的地方。

`WITH`实际上只不过是一个派生表，不同之处在于它是在查询之前引入而不是内联，并被赋予一个别名，然后可以在整个查询中多次将其用作表。

派生表是一个完整的查询，在括号内，就像它是一个真实的表一样使用。视图和表值函数也被视为派生表，但我们关注的是内联定义的类型。这是一个例子：

```
SELECT
   C.Name,
   S.SalesTotal
FROM
   dbo.Customer C
   INNER JOIN (
      SELECT
         O.CustomerID,
         SalesTotal = Sum(OrderTotal)
      FROM
         dbo.CustomerOrder O
      GROUP BY
         O.CustomerID
   ) S
      ON C.CustomerID = S.CustomerID; 
```

我们有一个完整的查询，它返回自己的行集（`GROUP BY`查询）。通过将它放在括号内并为其分配一个别名`S`，我们现在可以像使用表格一样使用它。我们可以将更多的表加入到这个表中。但是，我们只加入了这个表一次。

要将其转换为 CTE，我们进行了非常简单的更改：

```
WITH SalesTotals AS (
   SELECT
      O.CustomerID,
      SalesTotal = Sum(OrderTotal)
   FROM
      dbo.CustomerOrder O
   GROUP BY
      O.CustomerID
)
SELECT
   C.Name,
   S.SalesTotal
FROM
   dbo.Customer C
   INNER JOIN SalesTotals S
      ON C.CustomerID = S.CustomerID
   -- and for an example of using the CTE twice:
   INNER JOIN (
      SELECT Avg(SalesTotal)
      FROM SalesTotals
   ) A (AverageSalesTotal)
      ON S.SalesTotal >= A.AverageSalesTotal; 
```

现在，临时表是完全不同的动物。它与 CTE 或派生表有非常重要的区别：

*   临时表在许多查询中持续存在（在客户端连接的生命周期内，或直到显式删除），但 CTE 仅针对一个查询“存在”。
*   CTE 虽然在逻辑上是一个“单个”表，但如果在查询中多次使用，它的数据可能会生成多次。临时表的数据将被简单地读取为任何其他“真实”表。在上面的示例中，`Avg(SalesTotal)`在至少 2012 年之前的 SQL Server 版本中，计算将涉及`SalesTotals`第二次执行聚合的完全独立的操作。虽然引擎可以实现 CTE 的结果，但到目前为止 SQL Server 还没有做到这一点。值得注意的是，Oracle 等其他 DBMS 可能会实现 CTE 的结果。无论如何，您应该知道这种双重查询可能（当然！）严重的性能影响。
*   临时表会自动为其生成列统计信息，这可以帮助查询优化器选择更好的执行计划。CTE 的“最终”行集没有统计信息——使用基础表的统计信息。
*   临时表可以增量添加，也可以通过多个或重复语句从中删除行。它可以更新。
*   可以修改临时表以添加或删除列或更改数据类型。
*   临时表可以具有聚集和非聚集索引和约束。
*   您不能以任何方式在用户定义的函数中使用临时表。
*   CTE 虽然看起来在逻辑上隔离了查询的各个部分，但并没有做这样的事情。CTE 是谓词下推、消除的完美候选者，如果确定它们不影响最终行集（或它们的某些表或连接已消除），或者它们可能会受到意外的表达式评估顺序的影响。例如，在 CTE 中，您可能只返回文本列中的数字字符串，并且在外部查询中尝试将这些字符串转换为数字数据类型，但令您惊讶的是，您在尝试转换非数字字符串时遇到错误为数值数据类型。这是因为优化器可以自由地以任何它喜欢的方式重新组织您的查询，并且可以在过滤包含数字的字符串之前将其转换为数字。一个临时表，同时需要两条语句（一条用于插入数据，

最后，CTE 可以做一些临时表不能做的事情：它可以是递归的。在 Oracle 中，这是通过 表示的`CONNECT BY`，而在 SQL Server 中，它是通过`UNION ALL SELECT`CTE 内部的 a 来完成的，该 CTE 允许引用 CTE 自己的别名。

小心 CTE——它们是一个很好的抽象，但仅此而已，你可能会遇到严重的麻烦。生成一百万行可以使用递归 CTE 一次一行来完成，但这是最糟糕的方法，可能是一百倍或更多。

SQL Server 2005 和更高版本中还有另一种特殊的临时表，称为“表变量”，它非常类似于临时表（并且在 tempdb 中保持完全相同），但有一些值得注意的例外：

*   它只持续*批处理*的持续时间，而不是*连接*。
*   您可以在用户定义的函数中使用表变量。某些类型的 UDF 需要一个。
*   它只能声明内联约束（例如主键或唯一性），虽然它可以更新/插入/删除行，但在声明后不能以任何方式修改其架构，因此不能添加/删除列，更改数据类型，或添加索引。
*   它不收集统计信息。
*   它可以在 SQL Server 2008 及更高版本中作为参数（表值参数）传递。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T21:16:14.317

今天，SQL 优化器在选择出色的执行计划方面做得更好，但是当连接超过 10 个表时，尤其是对于一些大型表和视图并且需要使用多个过滤器时，它通常不会以最佳方式执行。我仍然发现没有什么比使用#TEMP 表和在将它们连接在一起之前将查询分解成更小的子集更快的了。注意：我很少发现向#TEMP 表添加索引可以提高性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T17:31:43.307

不，这是不正确的。它们都是独立的功能，每个都有各自的用途。

例如，CTE 适用于少量数据，而临时表通常更适合较大的数据集。临时表可以被索引并提高它们的性能，而 CTE 不能。

我会花一点时间阅读 MSDN 文档并查看您将使用其中一个或另一个的特定实例

# c# - 将 BooleanToVisibilityConverter 绑定到视图模型中的枚举

> ID：14838224
> 
> 赞同：0
> 
> 时间：2013-02-12T17:26:16.223
> 
> 标签：c#, xaml, windows-8

我是一个视图模型，我有：

```
 public enum EventViewMode
   {
       View,
       Update,
       Insert
   } 
```

然后，在视图中，某些控件必须可见或不符合 的值`EventViewMode`。

对于布尔值，我使用`BooleanToVisibilityConverter`了转换器。

有没有办法在绑定系统中使用表达式将枚举值转换为布尔表达式。

我的意思是，类似：

```
<Button x:Name="btnSave"  
   Visibility="{Binding MyVariable == EventViewMode.View ,  Converter={StaticResource booleanToVisibilityConverter}}" /> 
```

请注意，`MyVariable == EventViewMode.View`这不起作用，它是为了显示我想要达到的目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:29:25.473

不，我害怕。你的选择是

*   使用价值[转换器](http://msdn.microsoft.com/en-gb/library/system.windows.data.ivalueconverter.aspx)
*   将属性公开为[可见性](http://msdn.microsoft.com/en-gb/library/system.windows.uielement.visibility%28v=vs.95%29.aspx)而不是`EventViewMode`
*   使用数据触发器根据枚举值设置所需的属性（在本例中为可见性），例如

    ```
    <Button x:Name="btnSave" Visibility="{Binding MyVariable == EventViewMode.View ,  Converter={StaticResource booleanToVisibilityConverter}}">
        <Button.Style>
            <Style TargetType={x:Type Button}>
                <Setter Property="Visibility" Value="Collapsed" />
                <Style.Triggers>
                    <DataTrigger Binding="{Binding MyVariable}" Value="View">
                        <Setter Property="Visibility" Value="Visible" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </Button.Style>
    </Button> 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:52:31.067

您可以简单地在视图模型中公开一个属性：

```
public bool IsVisible { get { return MyVariable == EventViewMode.View; } } 
```

当您更改 MyVariable 时，不要忘记为 IsVisible 引发属性更改通知。

如果您不想污染视图模型，下一个最简单的选择是实现另一个值转换器。

# .net - 使 XMS .Net 代码使用自动客户端重新连接功能

> ID：14838231
> 
> 赞同：1
> 
> 时间：2013-02-12T17:26:27.417
> 
> 标签：.net, client, ibm-mq

我有一个现有的 XMS .Net 客户端应用程序，我正在尝试向它添加自动客户端重新连接功能。这是为了经常解决应用程序与队列管理器断开连接的问题，并要求应用程序服务回收以恢复与队列管理器的连接。客户端版本是版本：7.0.1.1 XMS 客户端产品版本是 1.2.7.0

但我发现 XMS .Net 客户端版本 1.2.7 不支持属性 XMSC_WMQ_CLIENT_RECONNECT_OPTIONS。错误获取'

> IBM.XMS.XMSC' 不包含 'WMQ_CLIENT_RECONNECT_OPTIONS' 的定义

为了克服这个问题，我相信 XMS 客户端必须至少是 v2.1.0。为了使用 XMS 客户端版本 2.1.0，我必须将 MQ 客户端本身更新到 v7.1，但我仍将与 MQ v7.0.1 队列管理器连接。从较高版本的客户端连接到较低版本的队列管理器是否会有任何问题，或者我需要将队列管理器升级到版本 7.1 以使用 XMS 客户端中的自动客户端重新连接功能？

对于这个问题还有其他更好的解决方案吗？

请查找代码更改

```
public class MQConnectionFactory
{
    private static IConnectionFactory cf = XMSFactoryFactory.GetInstance(XMSC.CT_WMQ).CreateConnectionFactory();

    public string WMQ_HOST_NAME { set { cf.SetStringProperty(XMSC.WMQ_HOST_NAME, value); } }
    public int WMQ_PORT { set { cf.SetIntProperty(XMSC.WMQ_PORT, value); } }
    public string WMQ_QUEUE_MANAGER { set { cf.SetStringProperty(XMSC.WMQ_QUEUE_MANAGER, value); } }
    public string WMQ_CHANNEL { set { cf.SetStringProperty(XMSC.WMQ_CHANNEL, value); } }

//Adding Client Reconnecting Parameters
    public int WMQ_CLIENT_RECONNECT { set { cf.SetIntProperty(XMSC.WMQ_CLIENT_RECONNECT_OPTIONS, XMSC.WMQ_CLIENT_RECONNECT);} }
    public int WMQ_CLIENT_RECONNECT_TIMEOUT { set { cf.SetIntProperty(XMSC.WMQ_CLIENT_RECONNECT_TIMEOUT, 150);} }

    public int WMQ_CONNECTION_MODE
    {
        set
        {
            if (value < 0)
                value = XMSC.WMQ_CM_CLIENT_UNMANAGED;
            cf.SetIntProperty(XMSC.WMQ_CONNECTION_MODE, value);
            //set to non RFH header
            //cf.SetIntProperty(XMSC.WMQ_TARGET_CLIENT, XMSC.WMQ_TARGET_DEST_MQ);
        }
    }

    public IConnection CreateConnection()
    {
        //try
        //{
        return cf.CreateConnection();
        //}
        //catch (Exception e)
        //{
        //    Console.WriteLine(e);
        //    return null;
        //}

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:24:25.430

是的，您需要将 MQ 客户端升级到 v7.1。此级别的 MQ 客户端将与 MQ v701 队列管理器一起使用。

# cloud-foundry - MongoDB 连接被 vmc-tunnel-plugin 拒绝

> ID：14838241
> 
> 赞同：0
> 
> 时间：2013-02-12T17:27:04.900
> 
> 标签：cloud-foundry

也许我没有正确理解这一点，但这是我尝试使用 vmc 隧道的方式。

注意：MongoDB 服务正在运行并且工作正常，并通过我的 vmc push nodejs 应用程序进行了验证

我正在尝试使用来自远程服务器的 mongodb url 访问 mongodb

我在本地 macbook 上创建了隧道并收到了连接信息

sudo vmc 隧道 mongodb-1234 无

服务连接信息：用户名：1​​2345 密码：12345 名称：db url：mongodb://12345:12345@172.30.48.71:25283/db

在我的远程服务器上，我正在使用 C# mongdb 驱动程序并使用给定的 url 进行连接，但我的连接超时。

我错过了什么？

错误信息：无法连接到服务器172.30.48.71:25283：连接尝试失败，因为连接的一方在一段时间后没有正确响应，或者连接的主机没有响应172.30.48.71:25283，建立连接失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T19:06:15.197

“vmc 隧道”返回的连接信息只能由绑定到服务的 Cloud Foundry 上的应用程序或运行 VMC 的机器上的本地隧道使用。

当您创建隧道时，vmc 在您的机器上打开一个端口（通常为 10000），该端口通过隧道连接到在 Cloud Foundry 上运行的实例。您可以使用本地计算机上的此端口连接到 MongoDB，但无法从 CloudFoundry.com 外部节点或运行 VMC 的计算机连接到服务实例。

# c# - 连接字符串运行时初始化

> ID：14838242
> 
> 赞同：1
> 
> 时间：2013-02-12T17:27:05.957
> 
> 标签：c#, configuration, runtime

如何在 C# 中的控制台应用程序中从远程文件初始化连接字符串：

我目前正在为 AppSettings 从远程位置加载：

字符串 runtimeAppSettingsconfigfile = "c:\Somepath\StaticAppSettings.config"

```
System.Configuration.Configuration config
    = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
config.AppSettings.File = runtimeAppSettingsconfigfile;
config.Save(ConfigurationSaveMode.Modified);
ConfigurationManager.RefreshSection("appSettings"); 
```

如何为连接字符串配置文件实现相同的功能，即远程加载连接字符串文件？

编辑 ：

到目前为止我尝试过的是：

```
string runtimeConnectionStringConfigfile = "c:\somepath\StaticConnectionStrings.config"
Configuration config =                          ConfigurationManager.OpenExeConfiguration(runtimeConnectionStringConfigfile);

config.Save(ConfigurationSaveMode.Modified);
ConfigurationManager.RefreshSection("connectionStrings"); 
```

连接字符串文件示例：

```
<connectionStrings>
    <add name="mydb" connectionString="Data Source=PrimaryDB;Initial Catalog=test;Persist Security Info=True;User ID=testuser;Password=test; Asynchronous Processing=true" providerName="System.Data.SqlClient" />
</connectionStrings> 
```

# java - 如何不使用 getter 和 setter

> ID：14838244
> 
> 赞同：0
> 
> 时间：2013-02-12T17:27:13.790
> 
> 标签：java, getter-setter

我一直在阅读为什么我应该以及为什么我不应该使用 getter 和 setter 的原因。我阅读了这篇关于如何/为什么不使用 getter 和 setter 的[文章](http://www.javaworld.com/javaworld/jw-09-2003/jw-0905-toolbox.html?page=5) ***（一种设计策略）***，但我只是没有“看到”在什么情况下我不会使用它们，或者更好的是替代方法。**是的，我需要看到一个替代 getter 和 setter 的方法。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T17:31:06.343

你为什么不想在声明它的类中使用它（除非它涉及一些其他业务逻辑）。我真的想不出真正的替代方案。随心所欲地称呼它，但您所做的只是声明一种获取值的方法。这只是样板代码。

此外，使用您的 API 的人会期望 getters\setters，并且在没有 getters\setters 时可能会感到困惑。

阅读全文：[getter 和 setter 是否设计不佳？看到矛盾的建议](https://stackoverflow.com/questions/565095/are-getters-and-setters-evil)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T17:42:19.183

这是我在不到三天的时间里从 JW 那里读到的第二篇文章，他们都分享了*为什么 XXXXX 是邪恶的*座右铭……把它抛在脑后，我想我会引用文章的最后一句话并发表我的看法。

> 除非绝对必要，否则不应使用访问器方法（getter 和 setter），因为这些方法会公开有关如何实现类的信息，因此会使您的代码更难维护。有时 get/set 方法是不可避免的，但有经验的 OO 设计人员可能会毫不费力地消除代码中当前 99% 的访问器。

我相信作者指的是具体的对象，例如不与任何人交互的 POJO（为什么不是实体）。你的网站有登录功能，所以你有一个用户......你为什么要打扰，`getName`如果`setName`它只是一个`String`？

虽然这可能是真的，但如果名称是 会发生什么`null`？您是否将自己暴露`NullPointerException`在代码周围？除非您每次使用该变量时都进行检查，或者确保没有用户拥有`null`您永远无法确定的名称。吸气剂可以使它变得容易，但恕我直言，这一切都与品味有关。您只是将支票从一个地方转移到另一个地方。

> Getter/setter 方法经常出现在代码中，因为编码器是按程序思考的。打破这种程序性思维方式的最佳方法是根据具有明确职责的对象之间的对话进行思考。Cunningham 的 CRC 卡方法是一个很好的入门方法。

在这里，作者似乎进一步挖掘了 CRC 的原理（在文章本身中进行了解释），这是反对大多数访问者的有效论据。

同样，这一切都是关于了解您的应用程序以及您将如何让其他人知道它。我现在想不出替代方案，但我更喜欢深入研究*Cost VS Benefit*的概念，而不是替代方案，避免 getter 有什么好处以及避免它对您造成的成本是多少（了解变量的时间，进行检查的时间，查找字段的时间，确定和处理没有访问者限制的更改的影响的时间）。

另一个有趣的点（现在我想起来了，这是最重要的一点）是何时避免 getter 和 setter。如果你暴露了一些你不应该暴露的东西，它们显然是*邪恶*的，比如一些重要的变量，它持有一个计数器并且可能使你的应用程序处于不一致的状态（换句话说......“发疯”）。在这些情况下，吸气剂就足够了。

最后，许多框架和工具依赖于这些访问器来设置和获取值。避免它们意味着失去与这些工具的“兼容性”......除非您创建间接访问器或包装器，例如。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T17:32:15.720

这是一个：

```
public class Point {
    public int x;
    public int y;
} 
```

不需要 getter 和 setter，因为点的定义是 x,y 值。

像这样的构造函数将使类更易于使用。

```
public Point (int x, int y) 
```

以及空的构造函数

```
public Point() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-12T17:32:24.507

你是否使用“getters”或“setters”真的归结为一个需要的问题。例如，有一些持久性框架要求托管对象声明 getter 和 setter。一些模板框架需要它。

如果您想限制某个对象成员的可见性（从代码的角度来看），您可以为此在 getter 上使用修饰符。如果你想限制可变性，你可以在 setter 上使用修饰符。

就使用 getter/setter 而言，这并不是真正的“偏好”问题。这取决于您要实现的目标以及您正在使用的技术的要求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T17:35:33.147

根据我的经验：

在大多数情况下，getter setter 是最好的。

但是当在类中使用字段时，最好直接访问变量。

getter / setter 的一个缺点是在复杂的数学公式中使用时，它们的可读性较差，并且更容易出错，因为代码看起来不像文献中的公式。

例子：

```
 return (p2.x- p1.x) / len; 
```

比

```
 return (p2.getX()- p1.getY()) / len; 
```

这只是一个简单的例子。

在极少数情况下，您需要非常高性能的计算。一个例子是 java.awt.Rectangle 出于性能原因需要公开 x 和 y。但这是一个例外。

其他编程语言通过引入属性（C# 和 Objective C）解决了这个问题。它们与点语法一起使用，但在内部调用 getter 或 setter。

# grails - 无法从列表中删除

> ID：14838247
> 
> 赞同：0
> 
> 时间：2013-02-12T17:27:18.303
> 
> 标签：grails

我试图从一个有很多关系中删除一个对象。用户有一个对象叫来宾，来宾有一个有很多叫孩子的对象，见下图：

```
class User {

    transient springSecurityService

    String username
    String password
    String email
    boolean enabled
    boolean accountExpired
    boolean accountLocked
    boolean passwordExpired
    Guest guest
} 
```

客人：

```
class Guest {

    static hasMany = [children:Child]

    static constraints = {
    }
} 
```

我使用以下内容添加孩子：

```
User.guest.addToChildren(Child.get(params.id)) 
```

这工作得很好。但是，我不能执行以下操作：

```
User.guest.removeFromChildren(Child.get(params.id)) 
```

我也试过

```
Guest guest = User.guest
guest.removeFromChildren(Child.get(params.id))
guest.save(flush: true, failOnError: true) 
```

没有成功。我还进行了适当的检查以确保子实例包含在来宾中并且匹配

```
Child.get(params.id) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:55:26.970

您问题的神秘部分是您从哪里获得用户？它可能是一个独立的实例，可能会导致您的问题。我会尝试以下方法：

```
Guest guest = User.guest.merge()  // make sure Guest has a hibernate context
Child child = Child.get(params)
guest.removeFromChildren(child)
// don't believe what the docs tell you
// I always have to delete the instance I am removing
// from the collection
child.delete() 
```

并在服务方法中执行此操作，或者用事务关闭将其包围。

# floating-point - 爱国者导弹浮动指向错误

> ID：14838250
> 
> 赞同：2
> 
> 时间：2013-02-12T17:27:33.670
> 
> 标签：floating-point, binary

从计算机系统：程序员的视角[http://csapp.cs.cmu.edu](http://csapp.cs.cmu.edu)

练习题 2.51

我们在习题 2.46 中看到爱国者导弹软件近似于 0.1，因为 x =

```
0.00011001100110011001100(binary). 
```

相反，假设他们使用 IEEE 舍入到偶数模式来确定 x' 到 0.1 的近似值，二进制点右侧有 23 位。

A. x' 的二进制表示是什么？

```
from the solution at the back of book, 
Looking at the nonterminating sequence for 1/10, we can see that the 2 bits to the right of the rounding position are 1, and so a better approximation to 1/10 would be obtained by incrementing x to get x′ = 0.00011001100110011001101, which is larger than 0.1. 
```

B. x′ - 0.1 的近似十进制值是多少？

```
The solution says it's

We can see that x′ − 0.1 has binary representation: 0.0000000000000000000000000[1100]
Comparing this to the binary representation of 1 , we can see that it is 2^−22 × 0.1 , which is around 2.38 x 10^-8 
```

我对（B）的问题是我们如何得到

```
x' - 0.1 == 0.0 0000 0000 0000 0000 0000 0000[1100] ? 
```

我的计算给了我 0.000 0000 0000 0000 0000 0000 0100 （大约是解决方案所说的两倍）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-11-30T12:35:01.460

*小数二进制表示*中的0.1是：0.000[1100]

对于问题 2.46 中的近似值，在位置 23 之后有一个*截止*点，而在问题 2.51 中，*一轮甚至*发生在位置 23。后者意味着： - 要么 1） 去最接近的值 - 或 2） 如果正好在中间，去甚至。由于位置 24 ff 是`11001100...`情况 1)，最接近的值是位置 23 变为 1 时。原始值和近似值的位：

```
x     = 0.0001100110011001100110011001100110011001100...
x_246 = 0.00011001100110011001100  # cutoff
x_251 = 0.00011001100110011001101  # round to even - as asked in A) 
```

区别`x' - 0.1`，即`x_251 - x`，如B）中所要求的那样

*   分数二进制

    ```
    x_251:   0.00011001100110011001101
    x:     - 0.0001100110011001100110011001100110011001100...
    fdiff:   0.0000000000000000000000000110011001100110011... or
    fdiff:   0.0 0000 0000 0000 0000 0000 0000[1100]

    --> this answers "question for (B) is that how do we get x' - 0.1 
          == 0.0 0000 0000 0000 0000 0000 0000[1100]" 
    ```

*   十进制值

    ```
    ddiff = (1*2^-26 + 1*2^-27) + (1*2^-30 + A1*2^-31) + (...) + ...
          =     3*2^-27         +     3*2^-31         +    3*2^-35 + ...
          = 0.1*2^-22 = 2.384e-8  (sum of geometric serie)
    julia> @printf "%.40f" 0.1*2.0^-22
    0.0000000238418579101562513234889800848443 
    ```

* * *

题外话：为什么`julia> @printf "%.40f" 0.1f0`和上面的小数差ddiff有区别？

```
0.1000000014901161193847656250000000000000
0.0000000238418579101562513234889800848443 
```

`0.1f0`表示为*IEEE 浮点值*。位 ( `julia> bits(f0.1f0)`) ("00111101110011001100110011001101") 具有以下含义：

```
0 01111011 10011001100110011001101
| |        | M = 1 + f
| | E = e - Bias = 123 - 127 = -4 --> V = M*2^-4 (right shift M by 4)
| sign

M:         1.10011001100110011001101
M/sh: 0.0001.10011001100110011001101
x_shifted: 0.000110011001100110011001101
x_251:     0.00011001100110011001101 
```

--> 0.1 的移位近似值比 x_251 多 4 位。差的十进制值`x_shifted - x`（如上计算）给出：0.1*2^-26。现在这两种表示适合：

```
 julia> @printf "%.40f" 0.1*2.0^-26
    0.0000000014901161193847657077180612553028
    0.1000000014901161193847656250000000000000  # julia> @printf "%.40f" 0.1f0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-09T11:56:11.023

使用 Julia

一个。

```
julia> bits(0.1f0)
"00111101110011001100110011001101" 
```

B. 我们无法精确计算差值（因为没有原生的小数类型），但您可以精确打印小数，然后手动减去

```
julia> @printf "%.40f" 0.1f0
0.1000000014901161193847656250000000000000 
```

所以区别是`0.0000000014901161193847656250000000000000 = 1.490116119384765625e-9`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-30T00:57:04.023

我也有同样的困惑。您可以尝试通过从解决方案向后思考来理解给定的解决方案。

0.1 +`the given solution`

= `0.000 1100 1100 1100...`+`0.00000000000000000000000001100 1100 1100...`

=`0.000 1100 1100 1100 1100 1100 1111 1111 1111...`

观察到上面的结果是我们可以做的最好的**近似**x' = `0.000 1100 1100 1100 1100 1101`。

# css - 如何使用 CSS 在表格行旁边显示一个颜色框？

> ID：14838251
> 
> 赞同：0
> 
> 时间：2013-02-12T17:27:35.447
> 
> 标签：css, positioning

**是否可以在不使用空元素的情况下将**一个颜色框浮动到表格行的左侧？

 **我想`<span></span>`首先摆脱，`<td>`如果可能的话只使用纯CSS。

它应该看起来像这样

![小样](../Images/cc28af05516d8d414f9e481eff8acb89.png)

* * *

这是我目前拥有的：

```
<table border="1">
    <tr>
        <td><span></span>float a box of any color to the left of this row</td>
    </tr>
    <tr>
        <td>it should be the same heieght as the row</td>
    </tr>
    <tr>
        <td>and 15 pixels wide</td>
    </tr>
</table> 
```

```
table {
    margin: 10px 10px 10px 25px;
}

table td {
    position: relative;
    padding: 5px;

}

/* can i achieve the same effect without having
   to rely on a <span> element? */
table td span {
    position: absolute;
    top: 0;
    left: -20px;
    width: 15px;
    height: 100%;
    background-color: green;
} 
```

在[cssdeck上玩它](http://cssdeck.com/labs/9osbozli)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:40:03.987

用伟大的哲学家 Beastie Boys 的话来说，CH-CH-CHE-CH-CHECK IT OUT：[http ://cssdeck.com/labs/hxfa4xzz](http://cssdeck.com/labs/hxfa4xzz)

仅使用 CSS 的`:before`伪选择器和`content:`属性是可行的。

```
table {
  margin: 10px 10px 10px 25px;
}

table td {
  position: relative;
  padding: 5px;
}

table tr:first-child td:before {
  content: " ";
  position: absolute;
  top: 0;
  left: -20px;
  width: 15px;
  height: 100%;
  background-color: green;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:36:10.200

我已经修改了您的示例以显示如何使用 CSS 来完成它：之前，但这在旧浏览器中不起作用，但这意味着没有额外的标记（除了一个用于识别哪一行/列的类）。

[http://cssdeck.com/labs/08h7pcbn](http://cssdeck.com/labs/08h7pcbn)

您可以对其进行修改以将其应用到行而不是单元格上，但我将其尽可能接近您的示例。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T17:31:42.463

老实说，如果您想坚持使用表格格式，我只需`<td>`在每一行中添加另一个并将一个类应用于`<td>`您想要具有该样式的 's 。

```
<table border="1">
    <tr>
        <td class="green_box"></td>
        <td>float a box of any color to the left of this row</td>
    </tr>
    <tr>
        <td class="clear_box"></td>
        <td>it should be the same heieght as the row</td>
    </tr>
    <tr>
        <td class="clear_box"></td>
        <td>and 15 pixels wide</td>
    </tr>
</table> 
```**

# ios - 目标 C：带有图像 image0001.png 的 For 循环

> ID：14838252
> 
> 赞同：1
> 
> 时间：2013-02-12T17:27:42.203
> 
> 标签：ios, objective-c

我有图像称为：

图片0001.png 图片0002.png ... 图片0234.png...

如何使 for 循环理解应该有多少个“0”？

```
 //this code crash
for (int i = 0; i < 234; i++)
{
    [myImages addObject:[UIImage imageNamed:[NSString stringWithFormat:@"image000%i", i]]]; 
} 
```

谢谢

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-02-12T17:30:05.970

```
for (int i = 0; i < 10; i++)
{

    [myImages addObject:[UIImage imageNamed:[NSString stringWithFormat:@"image000%i", i]]]; 
}
for (int i = 10; i < 100; i++)
{

    [myImages addObject:[UIImage imageNamed:[NSString stringWithFormat:@"image00%i", i]]]; 
}
for (int i = 100; i <= 234; i++)
{

    [myImages addObject:[UIImage imageNamed:[NSString stringWithFormat:@"image0%i", i]]]; 
} 
```

# json - 过滤jqgrid数据

> ID：14838263
> 
> 赞同：0
> 
> 时间：2013-02-12T17:28:16.067
> 
> 标签：json, jqgrid

我已经用 Json 数据加载了一个 jqGrid。

我现在需要做的是允许最终用户仅显示在四列中的任何一列中具有空值的行。

假设以下网格

```
col1|col2|col3|
  a   b        
  a   b     c 
```

我希望用户能够单击一个按钮并仅显示第一行。

我对 jqGrid 很陌生，所以在回复时请记住这一点。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T07:12:53.737

您可以根据 afterInsertRow 事件中的空值来实现显示或隐藏列。

尝试这个

```
 afterInsertRow: function(rowid,rowdata,rowelem){
         if(rowdata['col1']!=null && rowdata['col2']!=null && rowdata['col1']==null  ){   
        $("#"+rowid).hide();
                               }
                           }, 
```

# javascript - 回调中的stackmob错误

> ID：14838265
> 
> 赞同：0
> 
> 时间：2013-02-12T17:28:20.920
> 
> 标签：javascript, api, backbone.js, stackmob

我正在使用 stackmob 几天，它仍然是新的，并且网络上没有太多信息。我遇到了这个问题：我不会在我的stackmobe“db”中获取所有商店名称的列表，该方案称为store，这是我正在使用的代码：

```
var Store = StackMob.Model.extend({
    schemaName: 'store'
});

 var stores = new Store();
stores.fetch({
    success: function(collection) {
        //after we've gotten all the Todo items from StackMob, let's see what we have!
        console.debug(collection.toJSON());
        alert(collection.toJSON());
    },
    error: function(collection, response){
        alert(collection.toJSON());
    }
}); 
```

我在我的 chrome 日志中收到此错误：

```
OPTIONS http://api.stackmob.com/store 400 (Bad Request) 
XMLHttpRequest cannot load http://api.stackmob.com/store. Origin http://127.0.0.1:4567 is not allowed by Access-Control-Allow-Origin. 
```

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T19:56:37.710

请问你在什么环境下运行（chrome、firefix、safari、opera、phonegap）？默认情况下，JS SDK 配置为对相对路径进行 AJAX 调用。例如“/store”它似乎以某种方式配置为直接点击“api.stackmob.com”，这仅在以下情况下发生：

*   JS SDK 检测到您正在使用 PhoneGap
*   您已指定 URL 以直接通过 init 访问 api.stackmob.com：

    StackMob.init({ ... apiURL: ' [http://api.stackmob.com/](http://api.stackmob.com/) ' })

我问自己的第一个问题是它是如何调用 api.stackmob.com 的，而它看起来像你在 Python 服务器上运行：（我假设是这样，因为我在你的原帖）

Dennis Rongo 在上面指出的另一件事是您的 Python 版本。我们使用 2.7 进行了测试，但听起来他注意到 3.3 存在问题。但是您从 127.0.0.1:4567 访问 api.stackmob.com 仍然出乎意料。你有 apiURL: '...' 在你的初始化中设置吗？如果是这样，我会尝试删除它。

设置 apiURL 将使 SDK 直接调用 api.stackmob.com (api.stackmob.com/store)，并且浏览器的行为就像任何常规 AJAX 调用一样，如果它跨域，则阻止它，给出您看到的错误.

好吧，让我知道！我们绝对想让你去！

埃里克

PS我认为您还试图获得不止一家商店。StackMob.Model 只代表一个商店。你想要 StackMob.Collection。

例如

```
var Store = StackMob.Model.extend({ schemaName: 'store' });
var Stores = StackMob.Collection.extend({ model: Store });

var stores = new Stores();
stores.fetch({
  success: function(results) {
    console.log(results.toJSON()); //should print out array of JSON objects representing your store items.
  }
}); 
```

更多信息：http: [//developer.stackmob.com/tutorials/js/Query-an-Object](http://developer.stackmob.com/tutorials/js/Query-an-Object)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T00:23:39.637

我以前从未使用过 StackMob，但决定检查一下，并能够使其在本地（`localhost`或`http://127.0.0.1/`）工作。

有几件事你可以看看。

*   转到您的`StackMob Dashboard`并检查您`Schema`的权限级别是否设置正确。如果您的任何操作未设置为`Open`，请在拨打电话之前先检查您是否正确进行了身份验证`Fetch()`。

*   您还需要安装 Python 2.7+（我建议坚持使用 2.7，因为 3.3 会破坏他们的`Python`脚本）。[安装说明](https://dashboard.stackmob.com/sdks/js/config)。Python 可以在[这里](http://www.python.org/getit/)下载。

    安装说明包括`stackmobserver.py`您需要放在项目根目录中的内容。导航到项目的根目录并使用初始化执行`Python`脚本（仅用于开发目的）。`Command`

    > python stackmobserver.py

*   检查你的`init`和`authentication`脚本。

    ```
    /** Initialize StackMob */
    StackMob.init({...});

    /** Perform authentication using User schema */
    var user = new StackMob.User({ username: 'yourUser', password: 'yourPassword' });
    user.login(false, {
        success: function (model) {
        /** Perform the Model fetch for the authenticated user. */
        },
        error: function (model, response) {
            console.debug(response);
        }
    }); 
    ```

希望这可以帮助。

# javascript - 获取具有特定属性的对象列表

> ID：14838269
> 
> 赞同：0
> 
> 时间：2013-02-12T17:28:34.333
> 
> 标签：javascript, jquery, arrays, search, object

我有一个名为 的数组`playerResults`，每个索引都是一个玩家姓名，每个索引都是一个`playerObj`对象。每个玩家都有一个属性`name`和`bracket`。

有没有办法搜索`playerResults`并返回所有具有特定括号编号的对象？

我为此使用javascript，使用jquery。

编辑：这是代码：

```
 function showBracket(groupID) {
        //console.log(playerResults);
        var matching = playerResults.filter(function(player) {
            console.log(player.bracket);
            return player.bracket == 1; // or so
        }); 
```

我的 playerResults 看起来像这样：

```
console.log(playerResults)
[Tiger Woods: playerObj, Phil Mickelson: playerObj, Dustin Johnson: playerObj, Zach Johnson: playerObj, Brandt Snedeker: playerObj…]
Brandt Snedeker: playerObj
    addWin: function addWin() {
    bracket: 3
    getBracket: function getBracket() {
    getWins: function getWins() {
    name: "Brandt Snedeker"
    setBracket: function setBracket(bracketNumber) {
    wins: 0
    __proto__: playerObj
Charles Howell III: playerObj
Dustin Johnson: playerObj
Hunter Mahan: playerObj 
```

对不起，一团糟，希望这是有道理的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:35:08.140

您可以编写自己的函数来执行此操作，但我会推荐[underscore.js](http://underscorejs.org/)，这是一个引入类似 LINQ 的投影和映射函数的库。

安装后，您可以使用过滤器功能来“查询”数组：

```
var playerResults = [
    { name: "blah", bracket:"one"},
    { name: "blah2", bracket:"three"},
    { name: "blah3", bracket:"two"},
    { name: "blah4", bracket:"one"}
];
var bracketOne = _.filter(playerResults, function(o) {
    return o.bracket == "one";
}); 
```

我为你准备了一个 jsFiddle：

[http://jsfiddle.net/ye9kd/](http://jsfiddle.net/ye9kd/)

在处理数组和对象时，下划线中有很多有用的函数 - _.filter() 只是其中之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:31:46.433

您正在寻找的是[`filter`数组方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)：

```
var matching = playerResults.filter(function(player) {
    return isSpecificGroupNumber(player.name, player.bracket); // or so
}); 
```

但是，旧浏览器不支持此方法，如果您想支持它们，可能需要填充。或使用[`jQuery.grep`](http://api.jquery.com/jQuery.grep/).

# javascript - 从主视图实例绑定路由器事件

> ID：14838272
> 
> 赞同：1
> 
> 时间：2013-02-12T17:28:56.260
> 
> 标签：javascript, backbone.js

我很难从我的主视图实例中*“绑定”*我的路由器事件。我的第一个想法是因为路由器只会触发我的`Depths`收藏。我将如何正确通知我`viewpoint.js`有关页面更改的信息？

**路由器.js**

```
var depth = depth || {};

(function() {
    'use strict';

    var DepthRouter = Backbone.Router.extend({

    routes: {
        '*page' : 'setPage'
    },

    setPage: function( page ) {
        // Set the current page
        page = page.trim() || 'home';

        // Trigger a collection {page} event
        depth.Depths.trigger(page);

    }

});

... // instance creation and Backbone.history.start() stuff

}()); 
```

**观点.js**

```
var depth = depth || {};

$(function($) {
    'use strict';

    depth.Viewpoint = Backbone.View.extend({ 

        el: 'section#right > div.content',

        // Bind relevant triggers
        initialize: function() {

        },

    });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T08:22:30.503

您需要将集合中的更改绑定到您的视图。这意味着每当您想要更新您的收藏的视图时，也会发生这种情况。

例如：

```
var list = new ModelList();

var listView = new ModelView1({model: list});    
var counterView = new ModelView2({model: list}); 
```

我们有两个视图链接到同一个收集模型： 现在我们绑定到收集事件：

```
ModelView1 = Backbone.View.extend({

    initialize : function() {

        this.model.bind('add', this.render);
        this.model.bind('remove', this.render);
        this.model.bind('reset', this.render);
    }

ModelView2 = Backbone.View.extend({

    initialize : function() {

        this.model.bind('add', this.render);
        this.model.bind('remove', this.render);
        this.model.bind('reset', this.render);
    } 
```

每当获取（**重置**）集合时，添加（**添加**）或删除（**删除**）项目时，将在您的视图上调用渲染方法

# angularjs - 为什么 Angular JS form.$pristine 不会随着直接 JS 操作而改变

> ID：14838273
> 
> 赞同：23
> 
> 时间：2013-02-12T17:28:58.943
> 
> 标签：angularjs

我想通过测试 Angular JS 原始设置来调整表单项的显示，例如按钮的启用/禁用属性。

当单击事件触发时，表单的原始值会按我的预期更改，但是当我直接操作范围变量时，即使表单上的控件绑定到该变量，表单的原始设置也不会更改。

请参阅以下 JSfiddle：

[http://jsfiddle.net/nicholasporter/2h7wT/3/](http://jsfiddle.net/nicholasporter/2h7wT/3/)

我希望布尔值的更改会导致表单原始设置在控件绑定到范围变量时发生更改。有没有更好的方法来测试这个？当表单上没有任何变化时，是否有更好的方法来调整按钮或其他 DOM 元素？在此先感谢您的任何指点。这是 JSfiddle 不工作的代码。

```
 <div ng-app ng-controller="MyCtrl">
    <form novalidate name="myForm">
    {{myBool}}

      <input type="checkbox" ng-model="myBool" />
      <button ng-click="myBool=!myBool">JS set</button>
        <div>Form Pristine:{{myForm.$pristine}}</div>
    </form>
  </div>

<script>
    function MyCtrl($scope){
        $scope.myBool = false;
    }
</script> 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-15T14:15:06.997

`$pristine`带有指令的输入的属性仅在使用其`ng-model`ngModelControllers`$setViewValue()`方法时发生变化，即通过用户*对*输入元素的交互或通过自己调用该方法。

这是因为原始状态用于跟踪您是否更改（修改了任何`ng-model`启用的输入元素）表单。这并不意味着输入中的值等于模型中的值，它们总是在每次击键后更新！没有自动方法可以将表单重置为原始状态，您必须自己决定何时通过调用`form.$setPristine()`.

如果要重置示例中的原始信息，则必须通过将按钮绑定到范围上的函数来告诉表单重置自身：

```
$scope.toggleBool = function() {
  $scope.myBool = !$scope.myBool;
  $scope.myForm.$setPristine();
} 
```

如果您想为表单和对象的原始状态分别设置一组值，则必须克隆该对象，然后在表单中使用该克隆。否则，所有更改总是会立即更改原始对象。

然后，您可以通过在原始对象和它的克隆之间进行深度比较来确定表单的状态。

**2015 年5 月更新**：这个答案来自 2013 年。ngModelController 在 Angular 的最新版本（当前为 1.4）中获得了[更丰富的 API](https://docs.angularjs.org/api/ng/type/ngModel.NgModelController)，它提供了一些管理表单状态的机制。

# oracle - 为什么在我的 PL/SQL 中我的 VARCHAR2 被转换为 LONG？

> ID：14838274
> 
> 赞同：2
> 
> 时间：2013-02-12T17:29:07.213
> 
> 标签：oracle, oracle11g, plsqldeveloper

我正在使用 PL/SQL Developer 9.0.6，在 Oracle 11g 数据库上工作。

我在一个包中有一个过程，它创建一些动态 SQL 来运行`execute immediate`。变量`vSQL`声明为`varchar2(4000)`. 我的程序正确构建并运行，并通过参数`vSQL`返回 a 。`ref cursor``out`

但是，在调试我的程序时，发生了一些意想不到的事情：我在 上设置了一个手表`vSQL`，当长度`vSQL`达到 1000 或更大时，手表窗口中的值从'(Long Value)'的*内容*`vSQL`变为*文字*，我可以不再查看 的内容`vSQL`。

为什么会这样？有什么方法可以转换，`vSQL`以便在调试程序时仍然可以查看它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T19:03:22.463

正如其他人指出的那样，PL/SQL Developer 无法在调试器中显示 4000 个字符。这可能是 Oracle 包 DBMS_DEBUG 的限制。

作为一种解决方法，您可以使用 Oracle SQL Developer，它使用不同的调试器 DBMS_DEBUG_JDWP。一般来说，PL/SQL Developer 比 Oracle SQL Developer 好一千倍。但是如果您需要调试大字符串或集合，那么 Oracle SQL Developer 会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T06:09:50.303

出于调试目的，您可以拥有每个元素长度为 1000 且最多为 4 个元素的 varchar2 数组，这样它将克服调试时超过 1000 个字符限制的问题，并且您仍然可以监控 varchar2(4000) 的值

# ajax - 支持无法使用 AJAX 的浏览器

> ID：14838279
> 
> 赞同：1
> 
> 时间：2013-02-12T17:29:21.483
> 
> 标签：ajax, scala, lift

我想建立一个大量使用 AJAX 的网站，但是我还需要支持不支持 Javascript/AJAX 的浏览器。有没有一种方法可以在 Lift 框架中轻松完成此任务？

假设以下场景 - 单个页面上有一个过滤器片段和结果视图片段。支持 AJAX 的用户只需发送将触发服务器端处理程序的 JSON 序列化表单，设置适当的 ValueCell（我希望即使对于这种更高级的情况也可以使用 Wiring），这将使列表视图无效并使其重新-使成为。但是，如果用户不支持 AJAX，则表单将以“常规”方式发送，从而使页面完全重新加载。

这通常应该很容易实现（绑定 on-submit，如果 Javascript 被禁用，表单将按原样发送）。

该`Form.ajax`代码段将表单的操作设置为，`javascript://`以便在不存在 Javascript 支持的情况下不会发生发布。

谢谢！

# dart - 有没有办法检查一个类是否是抽象的？

> ID：14838282
> 
> 赞同：5
> 
> 时间：2013-02-12T17:29:26.897
> 
> 标签：dart, dart-mirrors

我需要一种方法来检查一个类是否是抽象的。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T05:25:00.410

不幸的是，现在的答案是：你不能。

正如 Justin 所提到的，有一个用于反射功能的[Mirrors API 。](http://api.dartlang.org/docs/releases/latest/dart_mirrors.html)但是，似乎没有“抽象”的标志。

如果这是您希望看到的功能，您可以在此处提交功能请求：http: [//dartbug.com/new](http://dartbug.com/new)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-10T08:13:03.313

你可以做类似的事情

```
library x;

import 'dart:mirrors';

abstract class MyAbstract {
  void doSomething();
}

class MyConcrete{
}

void main(List<String> args) {
  print('MyAbstract: ${isAbstract(MyAbstract)}');
  print('MyConcrete: ${isAbstract(MyConcrete)}');
}

bool isAbstract(Type t) {
  ClassMirror cm = reflectClass(t);
  if(cm.declarations.values.firstWhere(
      (MethodMirror mm) => mm.isAbstract == true, orElse: () => null) != null) {
    return true;
  }
  try {
    InstanceMirror i = cm.newInstance(new Symbol(''), []);
  } catch(e) {
    return (e is AbstractClassInstantiationError);
  }
  return false;
} 
```

`newInstance`应该扩展该部分以检查是否没有默认构造函数并尝试命名构造函数。

AFAIR 最近有[一个讨论](https://groups.google.com/a/dartlang.org/d/topic/misc/sBOGTD5btaM/discussion)是否应该允许实例化一个抽象类（与依赖注入有关），如果上述方法的更改可能不再起作用，但我无法在问题跟踪器中找到有关它的内容。

还要为这个功能请求加注星标：[添加一个方法来检查一个类是否是抽象的](https://code.google.com/p/dart/issues/detail?id=12826)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-28T03:14:15.253

通过[反射](https://en.wikipedia.org/wiki/Reflective_programming)是可能的。

为了促进此处发生的关于缺失功能的讨论，所需的“isAbstract”功能在大约一年后于 2014 年 1 月 9 日提交（从[GitHub 的历史记录中](https://github.com/dart-lang/sdk/commit/7dfcd0f4a1c5604189f04b5e3df53b35a50266ed)可见）。

该[`dart:mirrors`](https://api.dart.dev/dev/2.0.0-dev.40.0/dart-mirrors/dart-mirrors-library.html)库使其很容易实现：

#### 飞镖 SDK

*   `dart:mirrors`
    *   `ClassMirror`
        *   `isAbstract`

# 演示

```
import 'dart:mirrors';

class ConcreteClass {}

abstract class AbstractClass {}

void main() {
  ClassMirror mirroredClass;

  mirroredClass = reflectClass(ConcreteClass);
  print(mirroredClass.isAbstract); // false

  mirroredClass = reflectClass(AbstractClass);
  print(mirroredClass.isAbstract); // true
} 
```

**文档：** [https ://api.dart.dev/dev/2.0.0-dev.40.0/dart-mirrors/ClassMirror/isAbstract.html](https://api.dart.dev/dev/2.0.0-dev.40.0/dart-mirrors/ClassMirror/isAbstract.html)

# c++ - 有没有一种在 C++ 中创建“拆分对象”的好方法？

> ID：14838284
> 
> 赞同：9
> 
> 时间：2013-02-12T17:29:30.053
> 
> 标签：c++, embedded

首先让我说我正在为微控制器创建软件，因此 RAM 的使用很重要，将大块 const 数据放入非易失性（闪存）存储器是有意义的。

我想要实现的是找到一种在 C++ 中创建“拆分”对象的好方法。作为一个例子，我们假设有一个字节的数据（读/写）和一个多字节的“收据”来访问它。假设“receipt”是一个长字符串，它是一个文件名，它指向的媒体很慢，所以在内存中缓冲单个字节是有意义的，而不是在每个请求时实际读取它。

```
class Data
{
    uint8_t byte;
    bool valid;
    const char filename[128];
    uint8_t read()
    {
        if (!valid)
            performReallySlowRead(filename, &byte);
        valid = true;
        return byte;
    };
    void write(uint8_t new_value)
    {
        byte = new_value;
        performRealWriteToMedia(filename, byte);
        valid = true;
    };
} 
```

这种方法的明显问题是整个 130 字节最终都在 RAM 中，而其中只有两个需要更改。所以我想出了一个拆分对象的想法：

```
class DataNonConst
{
    uint8_t byte;
    bool valid;
}

class DataConst
{
    const char filename[128];
    DataNonConst * const data;
}

static DataNonConst storage;
const DataConst holder("some_long_name_here", &storage); 
```

现在唯一的问题是，如果我想要数百个这样的拆分对象，那么创建它们的过程（因此创建两个对象并链接第二个到第一个）会变得非常无聊和有问题......

所以问题是 - 有没有一些好方法让它更容易使用，最好是聪明的 C++ 技巧或者一些模板魔法？也就是说 - 如何创建两个链接在一起的对象，用一个语句，最好是隐藏一个对象？我不认为宏解决方案在这里是可能的，因为没有简单的方法来自动创建存储对象的名称......对象需要是相同的类型，因为我需要在其他地方嵌入指向这些对象的指针（一个函数处理编写它们，另一个只关心读取）......我想到的所有解决方案都需要使用模板的虚拟接口（所以你通过 vtable 指针使对象变大并且可能得到一个奖励模板-bloat) 或导致巨大的模板膨胀...

**编辑：**

实际上，整个问题的一部分可以简化为一个更简单的问题——有没有办法将匿名变量“绑定”到 C++ 中的成员字段？某事喜欢：

```
const ConstData holder("...", NonConstData()); // this object HAS TO be ROMable 
```

在上面的“一厢情愿”中，持有者是 ROM 中的 const 对象，它具有指向在 RAM 中“某处”创建的匿名对象 NonConstData 的指针/引用/任何内容。或者：

```
std:pair<const ConstData &, NonConstData &> holder(ConstData(), NonConstData()); 
```

任何允许我不手动创建两个对象并将一个对象绑定到另一个对象的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:20:24.707

有一些限制，您可以利用模板来创建由每个 ROMable DataConst 对象引用的 DataNonConst 的静态实例。

限制：

*   代码使用`__LINE__`宏，因此每行只能有一个 DataConst 声明。或者，如果`__COUNT__` 宏可用，则可以使用它来代替`__LINE__`每行允许多个声明。

*   `DataNonConst`对象总是零初始化。

代码：

```
struct DataNonConst
{
    uint8_t byte;
    bool valid;
};

struct DataConst
{
    const char filename[128];
    DataNonConst * const data;
};

namespace {

template <long n>
struct DataNonConstHolder
{
    static DataNonConst data;
};

template <long n> DataNonConst DataNonConstHolder<n>::data;

}

// If __COUNT__ macro is supported, use it instead of __LINE__
#define Initializer(s) { s, &DataNonConstHolder<__LINE__>::data }

const DataConst dc1 = Initializer("filename1");
const DataConst dc2 = Initializer("filename2"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T18:04:16.910

您可以用整数替换指针，并为所有对象创建一个静态数组`DataNonConst`，如下所示：

```
class DataNonConst {
    uint8_t byte;
    bool valid;
};

static DataNonConst storages[MAX_DATA];

class DataConst {
    const char filename[128];
    const int dataIndex;
    DataNonConst *data() {
        return &storages[dataIndex];
    }
};

const DataConst holderOne("first_long_name_here", 0);
const DataConst holderTwo("second_long_name_here", 1);
const DataConst holderThree("third_long_name_here", 2); 
```

这种方法受到[*享元模式*](http://en.wikipedia.org/wiki/Flyweight_pattern)的启发，尽管很明显它在这里用于不同的目的。

一个明显的缺点是您需要手动计算条目以避免重复。但是，只有一个`storages`对象，因此没有其他要创建的对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-12T18:43:14.563

据我所知，这里唯一的问题是您的“句柄”对象有一个`char[]`成员。我敢打赌，如果您将其替换为`const char*`，那将解决您的问题，因为字符串文字可能无论如何都在非易失性内存中。

```
class Data
{
    const char* filename;
    uint8_t byte;
    bool valid;
    Data(const char* filename_) : filename(filename_), valid(false) {}
    uint8_t read()
    {
        if (!valid)
            performReallySlowRead(filename, &byte);
        valid = true;
        return byte;
    };
    void write(uint8_t new_value)
    {
        byte = new_value;
        performRealWriteToMedia(filename, byte);
        valid = true;
    };
};

Data holder("some_long_name_here"); //name is in the non-volatile memory anyway

char buffer[128] = "\var\bin\omg";
Data holder2(buffer); //runtime names work fine, but have to manage the storage yourself. 
```

或者，如果你想变得狡猾，你可以把它做成一个模板，甚至节省这么多的内存（代价是*稍微有点*混乱。这有一个额外的好处，就是能够轻松添加`static`成员，这也将在非易失性内存，但不按文件名共享。这并不明显，但这*可以*用于运行时名称未知的文件，但我不建议这样做。

```
template<const char* filename>
class Data
{
    uint8_t byte;
    bool valid;
    uint8_t read()
    {
        if (!valid)
            performReallySlowRead(filename, &byte);
        valid = true;
        return byte;
    };
    void write(uint8_t new_value)
    {
        byte = new_value;
        performRealWriteToMedia(filename, byte);
        valid = true;
    };
};
Data<"some_long_name_here"> holder;

extern char buffer[128] = "\var\bin\omg";
A<buffer> holder2; //this always refers to the filename currently in buffer 
```

但是，如果您*真的*想要一个拆分对象，那么您所拥有的拆分建议确实是我能想到的最佳答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T19:54:30.287

如果您愿意拥有最大数量的对象，则可以使用索引作为隐式指针：

```
class Data;
Data *dataArray;
char **filenameArray;

class Data {
  uint8_t byte;
  bool valid;
  char*& filename() {
    int index = this - dataArray;
    return filenameArray[index];
  }
 public:
  byte read() {
    if (!valid)
      performReallySlowRead(filename(), &byte);
    valid = true;
    return byte;
  }
  init(char* fn) {
    filename() = allocateInFlash(strlen(fn));
    strdup(filename(), fn);
    valid = FALSE;
  }
};

// Somewhere before things get run
dataArray = allocateInRam(sizeof(Data)*nDatas);
filenameArray = allocateInFlash(sizeof(char*)*nDatas); 
```

这意味着您不需要任何开销，也不需要触摸闪存来从 ram 读取。您也不再使用标准内存管理，这可能是一个加号或减号。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T18:30:24.027

只需声明`const`成员`static const`。

`static`在任何情况下，成员都与对象实例数据分开存储。您的编译器可能会自动将`static const`这些成员放在 ROM 中，但如果没有，可能会有编译器指令会强制这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-12T20:00:45.133

如果你愿意有一些纯粹的闪存开销，你可以这样做：

```
class Data;
std::map<Data*,string, less<Data*>, FlashAllocator<pair<Data*,string>> fns;
class Data {
  uint8_t byte;
  bool valid;
 public:
  byte read(){
    if (!valid)
      performReallySlowRead(fns[this],&byte);
    valid = true;
    return byte;
  }
  Data(string fn) {
    fns[this] = fn;
  }
  ~Data() {
    fns.erase(this);
  }
}; 
```

地图有不小的开销，但它都在闪存中。

# vba - 以编程方式对行或列进行分组和取消分组

> ID：14838295
> 
> 赞同：6
> 
> 时间：2013-02-12T17:30:10.250
> 
> 标签：vba, excel, excel-2010

有没有办法以编程方式对 Excel 2010 中的列或行进行分组/取消分组？

笔记：

*   “手动”命令位于数据 > 大纲 > 分组/取消分组
*   在 excel 2003 中，这曾经有效：`someSheet.columns(i).ShowDetail = True / False`但它在 2010 年不再适用于组（仅适用于数据透视表和小计分组）
*   录制宏不会产生任何我可以使用的代码

更准确地说，在 Excel 2010 中调用`myRange.ShowDetail = True`确实会展开折叠的组，但如果该组已经展开，则会引发错误。并且该`ShowDetail`属性返回 True，无论该组是否扩展。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T17:44:26.903

在 Excel 2010 中`ShowDetail`，无论组是折叠还是展开，该属性始终返回 true。`Hidden`可以改为使用该属性：

```
'to expand
If myRange.EntireColumn.Hidden Then
    myRange.EntireColumn.ShowDetail = True
End If

'to collapse
If Not myRange.EntireColumn.Hidden Then
    myRange.EntireColumn.ShowDetail = False
End If 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-28T06:01:57.073

关于不在数据透视表中的行......我在 Excel 2010 中的经验并不是 ShowDetail 总是评估为 True。我认为确实如此，但我没有意识到我需要在摘要行中才能使该属性按预期工作。其次，我没有意识到默认情况下摘要行位于分组行之下。一旦我更改该设置以使汇总行位于分组行上方（在功能区中：数据>大纲，显示大纲 Dlg 框），对折叠/展开的测试变得更加清晰。

如果我选择的单元格在摘要行上，则 ShowDetail 如果分组记录正在显示，则计算为 True，如果没有显示，则计算为 False。对我来说，关键是在摘要行上看到这种行为以这种方式起作用。默认情况下，上面的子行/分组行真的让我很震惊。

这是我的宏，当我在摘要行上选择一个单元格时，它会动态展开和折叠与摘要行关联的分组记录。并且，如果该部分展开，它会使我在 A 列中的单元格变为粗体。如果我选择了多个单元格，则此宏不会运行。

请注意，工作表保护可防止展开和折叠单元格组。我的工作表受到保护，因此我取消保护工作表以展开/折叠，然后重新保护它们。（对我来说，一个可能的改进是只取消保护/保护当前工作表而不是所有工作表。）

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
'TOGGLE SHOW/HIDE ROW
If Target.Cells.Count = 1 Then
    If (Target.EntireRow.OutlineLevel = 1) And (Target.Offset(1, 0).EntireRow.OutlineLevel = 2) And _
       (Target.Column < 15) Then
            Call Macros.ProtShts(False)
                Target.EntireRow.ShowDetail = Not Target.EntireRow.ShowDetail
                If Target.EntireRow.ShowDetail = True Then
                    Range(Cells(Target.Row, 1), Cells(Target.Row, 14)).Font.Bold = True
                Else
                    Range(Cells(Target.Row, 1), Cells(Target.Row, 14)).Font.Bold = False
                End If
            Call Macros.ProtShts(True)
    End If
End If
End Sub 
```

请记住，我将摘要行设置在分组记录的上方。如果您的摘要行低于分组记录（默认），则偏移行引用必须更改为 -1，如下所示：

```
(Target.Offset(1, 0).EntireRow.OutlineLevel = 2) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-23T14:18:44.840

最好的方法是仅更改隐藏范围内单元格的列宽。这将自动取消组合选择。

```
dim wsA as worksheet
set wsA = Worksheets("Name of your Worksheet")
wsA.Columns("A:AJ").Columns.Group 
wsA.Range("A:A").ColumnWidth = 22.22 
' make the change to one of the cells in the group that you want to unhide. 
```

# selenium-webdriver - 如何使用 Selenium Webdriver 区分同一页面上具有相同 id 的两个元素？

> ID：14838302
> 
> 赞同：4
> 
> 时间：2013-02-12T17:30:32.947
> 
> 标签：selenium-webdriver

我的网页上有两个列表，它们都有按钮（图像）来从列表中选择所有项目。两个图像具有相同的 id，并且没有任何其他信息，例如类名、CSS、XPath。我想单击第二个图像以从第二个列表中选择所有项目。但是当 Web 驱动程序执行以下行时：

```
driver.findElement(By.id("MoveAllRight")).click(); 
```

它总是点击第一张图片，但我希望它点击第二张。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-25T12:35:54.133

不。相反，提出一个错误。这是无效的 HTML。

如果您真的想继续测试无效的东西，并且还想破坏您的自动化测试（您真的不想这样做），您可以执行以下操作：

```
driver.findElement(By.xpath("(//img[@id='MoveAllRight'])[2]")).click(); 
```

它会起作用，但这是错误的做法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T20:14:41.120

它总是单击第一个，因为 findElement 将返回找到的第一个与您的条件匹配的。您可以使用 findElements 返回所有匹配元素的列表，然后访问找到的第二个元素。您还可以使用 xpath，例如 //img[@id='MoveAllRight'][2]。

您可能想要做的一件事是调查您是否可以创建一个 xpath 来考虑它应该与之关联的下拉列表，这样您可以确保您单击的图像始终是该特定下拉列表的图像。难度取决于您的应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-06T07:03:56.957

```
list<webelement>  listele = driver.findelements(by.tageName("Img");
syso(listele.size)

listele.get(0).click;
listele.get(1).click; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-09-14T04:19:51.090

我从过去 3 天开始尝试各种选项，最后用这段代码解决了：

```
list<webelement>  listele = driver.findelements(by.tageName("Img");
syso(listele.size)

listele.get(0).click;
listele.get(1).click; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-11-15T04:12:50.040

当我初始化代码时，大小无法解析或不是字段错误消息显示。

# css - 使用 div 的功能区问题 - 导航菜单

> ID：14838309
> 
> 赞同：0
> 
> 时间：2013-02-12T17:30:58.510
> 
> 标签：css, html, ribbon, nav

我正在使用这个 HTML：

```
<div id="navleft"></div>
<nav id="nav">
</nav>
<div id="navright"></div> 
```

这个CSS：

```
#navleft {
background:url('./images/navleft.png');
height:48px;
width:11px;
float:left;
position:absolute;
margin-left:-13px;
}

#navright {
background:url('./images/navright.png');
height:48px;
width:11px;
float:right;
margin-right:-13px;
}

#nav {
background:url('./images/navbg.png') repeat-x;
height:48px;
width:100%;
float:left;
position:relative;
} 
```

问题是左/右图像不会附加到主功能区。

我试过弄乱位置、显示和边距，但最接近我的目标的是它们之间的 1 个白色像素（上面的代码）。

[视觉示例](http://i48.tinypic.com/fjhvmt.png)

谁能解释为什么会发生这种情况和/或提供解决方案？

非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:42:19.140

尝试这个

[jsFiddle](http://jsfiddle.net/hQrSM/8/)

```
 #navleft {
background:url('http://placehold.it/48x48') ;
float:left;
height:48px;
width:48px;
}

#navright {
background:url('http://placehold.it/48x48') ;
height:48px;
float:left;
width:48px;
}

#nav {
background:url('http://placehold.it/75x48') repeat-x;
height:48px;
width:70%;
float:left;
} 
```

相应地调整高度和宽度，

# entity-framework - 实体框架在 1 对 1 关联中抛出错误 3021

> ID：14838311
> 
> 赞同：1
> 
> 时间：2013-02-12T17:31:13.113
> 
> 标签：entity-framework

我在 EF 5 中创建了两个实体之间的关联。当我尝试构建 dll 时，我在 EDMX 文件的这些行中收到错误 3021。

```
<AssociationSetMapping Name="NameAddress1" TypeName="MyModel.NameAddress1" StoreEntitySet="Name">
        <EndProperty Name="Address">
          <ScalarProperty Name="ID" ColumnName="ID" />
        </EndProperty>
        <EndProperty Name="Name">
          <ScalarProperty Name="ID" ColumnName="ID" />
        </EndProperty>
      </AssociationSetMapping> 
```

确切的错误是

```
Error 3021: Problem in mapping fragments starting at line xxxx:Each of the following
 columns in table Name is mapped to multiple conceptual side properties:
Name.ID is mapped to <NameAddress1.Address.ID, NameAddress1.Name.ID> 
```

这是一对一的关联。底层数据是一个表和一个视图。SQL 端没有 FK。这严格来说是一个只读应用程序。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:14:54.617

添加了一个参考约束，现在一切正常。

# ios - 从 AppDelegate 访问 ViewController

> ID：14838313
> 
> 赞同：3
> 
> 时间：2013-02-12T17:31:14.483
> 
> 标签：ios, objective-c, xcode

我的问题如下，

在我的其中一个中`ViewControllers`，当用户点击按钮时，我使用此代码注册设备以获取通知。

```
[[UIApplication sharedApplication] registerForRemoteNotificationTypes:
(UIRemoteNotificationTypeBadge | UIRemoteNotificationTypeSound | UIRemoteNotificationTypeAlert)]; 
```

那么，在 中`AppDelegte`，有两种方法。一个接收令牌，一个收到错误。

```
- (void)application:(UIApplication*)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData*)deviceToken
- (void)application:(UIApplication*)application didFailToRegisterForRemoteNotificationsWithError:(NSError*)error 
```

现在问题来了，`didRegisterForRemoteNotificationsWithDeviceToken`我需要将令牌发送到我的服务器，以及用户在其中输入的一些数据`View`，比如它的用户名。

我怎样才能得到这些数据？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-12T17:51:34.977

将`NSNotificationCenter`在这里为您服务。在您的 AppDelegate 中`didRegisterForRemoteNotificationsWithDeviceToken`，执行以下操作：

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"RegistrationReceived"
                                                    object:token]; 
```

而且，在您的控制器中`viewDidLoad`，

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(updateRegistrationInfo:)
                                             name:@"RegistrationReceived" 
                                           object:nil]; 
```

确保实现`-updateRegistrationInfo:`（或任何您想命名的名称）以接收`NSNotification`作为参数传入的 和 令牌。此外，当您不再需要通知时，请取消注册通知。

```
- (void)updateRegistrationInfo:(NSNotification *)notification
{
    NSString *myObject = [notification object];
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:35:40.817

您可以将您的`ViewController`作为实例变量添加到您的`AppDelegate`类中：

```
@interface AppDelegate : NSObject <UIApplicationDelegate>
{
@private // Instance variables

    UIWindow *mainWindow; // Main App Window

    UINavigationController *navigationController;

    UIViewController *someViewController;
} 
```

然后添加一些方法来`someViewController`返回您请求的数据。

`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`您可以通过这种方式在类中分配 someViewController `AppDelegate`：

```
someViewController = [[UIViewController alloc] initWithNibName:nil bundle:nil]; 

navigationController = [[UINavigationController alloc] initWithRootViewController:someViewController]; 
```

# google-analytics - Pentaho Google 分析插件 - 当有超过 10,000 行时它会做什么？

> ID：14838325
> 
> 赞同：1
> 
> 时间：2013-02-12T17:32:02.240
> 
> 标签：google-analytics, google-analytics-api, pentaho, kettle

每个 GA 请求的响应都会返回一定数量的行（最多 10,000 行）。如果您的第一个请求定义的查询将产生超过 10,000 行（例如，它产生 26,000 行），那么只会返回前 10,000 行。然后您必须发出另一个请求（使用相同的查询），指定您想要从 10,001 开始的接下来的 10,000 行，然后另一个请求指定您想要 20,001 之后的行。

我的问题是 Pentaho Google 分析插件是否在后台执行此操作？我似乎在该主题的任何地方都找不到任何有意义的文档。提前感谢您提供的任何信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T20:04:00.217

因此，根据 Google 的说法，[默认的 maxResults](https://developers.google.com/analytics/devguides/reporting/core/v3/reference#maxResults)设置为 1,000。GA PDI 组件是开源的，因此代码很[容易访问](http://type-exit.org/adventures-with-open-source-bi/kettle-plugins/google-analytics-plugin-for-kettle/)，在快速扫描他们的 Java 代码后，组件内部看起来使用`MaxResults`每个请求的默认值 (1,000)，然后继续以 1,000 块的形式对剩余的结果集进行分页. 这是我的假设，但最好确保该组件将获取每个结果集超过 10,000 行的所有数据。现在我唯一不确定的是这是否能很好地满足谷歌`10 queries per second (QPS) per IP`配额限制。

GAInputstep.java：

```
private DataEntry getNextDataEntry() throws KettleException {
    // no query prepared yet?
    if (data.query == null){
        data.query = getQuery();
        // use default max results for now
        //data.query.setMaxResults(10000);

        ...
    }
    // query is there, check whether we hit the last entry and requery as necessary
    else if (data.entryIndex >= data.feed.getEntries().size()){
        if (data.feed.getStartIndex()+data.entryIndex <= data.feed.getTotalResults()){
            // need to query for next page
            data.query.setStartIndex(data.feed.getStartIndex()+data.entryIndex); 
```

# internet-explorer-7 - IE7里显示的内联占用更多空间？

> ID：14838329
> 
> 赞同：1
> 
> 时间：2013-02-12T17:32:13.453
> 
> 标签：internet-explorer-7

我有一些内联显示的 li。它们具有 em 形式的水平边距和填充。

这在所有浏览器中都很好，除了 IE7，它们太宽而无法放入容器并进入 2 行。

IE7 是否以与其他版本的 IE 不同的大小呈现文本？使用 IE 开发人员工具，我看不到应用了任何不同的 CSS。我截取了页面，我可以看到容器是相同的，但文本在 IE7 中占用的空间比 8 或 9 更多。

屏幕截图中的更新我可以看到 IE7 中的单个单词比其他浏览器长。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T02:50:06.137

是的，即以不同的方式呈现它们，特别是Firefox中的子弹在填充之外呈现（反之亦然）

尝试：

```
li {
  white-space: nowrap; // stop the wrapping in the first place
} 
```

# ruby - 解析 Javascript 修改的 HTML

> ID：14838331
> 
> 赞同：0
> 
> 时间：2013-02-12T17:32:17.080
> 
> 标签：ruby, parsing, html-parsing, capybara, mechanize

我想在网页中提交一个表单，当我提交我的表单时，网络会使用 Javascript 添加一个新字段。我想解析这个新字段。我正在使用 Mechanize，但它不是解释 javascript，我已经测试了 capybara，但我想在后台执行此操作

有没有其他选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T05:39:51.803

也许你可以试试[Poltergeist](http://rubygems.org/gems/poltergeist)。这是Capybara的某种无头驱动程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:06:01.210

你可以更容易地做到这一点，而无需使用在所有 Capybara 的方法中启用的 Capybara 的自动等待来评估 Javascript。方法如：

```
find(locator) 
```

将自动等待最多 2 秒。您可以通过将另一个值指定为 default_wait_time 来更改限制，例如：

```
Capybara.default_wait_time = 5 
```

# powershell - [Microsoft.TeamFoundation.Client.TeamFoundationServerFactory]::GetServer 指定凭据

> ID：14838336
> 
> 赞同：0
> 
> 时间：2013-02-12T17:32:32.767
> 
> 标签：powershell, command-line, tfs, powershell-2.0

我有以下用于连接 TFS 的代码：

```
$tfs = [Microsoft.TeamFoundation.Client.TeamFoundationServerFactory]::GetServer($serverName) 
```

如何在此处指定我的登录名并作为参数传递？默认情况下，它使用运行脚本的帐户，但我想设置不同的帐户

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:51:48.497

查看[此博客文章](http://blogs.msdn.com/b/buckh/archive/2006/09/14/factory-vs-constructor.aspx)- TeamFoundationServerFactory API 并非旨在支持自定义凭据。您应该改用 TeamFoundationServer 类构造函数。

```
$creds = Get-Credential
$server = New-Object Microsoft.TeamFoundation.Client.TeamFoundationServer $url,$creds.GetNetworkCredential() 
```

# php - 从谷歌获取随机网址并将它们存储到数组中

> ID：14838340
> 
> 赞同：-1
> 
> 时间：2013-02-12T17:32:57.693
> 
> 标签：php, javascript

我需要检查到某个 url 的连接时间，我使用*curl*进行操作（当时我只知道如何为 1 个 url 执行此操作，我的问题是我需要检查许多 url，而不仅仅是 1 个）

这是我如何计算连接时间的示例：

```
$url1 = 'stackoverflow.com';
$curl1 = curl_init();
curl_setopt($curl1, CURLOPT_URL, $url1);
curl_setopt($curl1, CURLOPT_RETURNTRANSFER, TRUE);
curl_exec($curl1);
$contime1 = curl_getinfo($curl1, CURLINFO_CONNECT_TIME);
echo $contime1; 
```

现在让我们说我想使用多个 url 而不是 'stackoverflow.com' url，例如这个数组列表：

```
$imones = array ("php.net","w3schools.com", "stackoverflow.com");
while (list(, $value) = each($imones)) {
$imoneslist = "$value<br />\n"; 
```

如何将 $imoneslist 数组放入 $url1？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:37:35.827

```
$imones = array ("php.net","w3schools.com", "stackoverflow.com");
foreach($imones as $url1) {
    $curl1 = curl_init();
    curl_setopt($curl1, CURLOPT_URL, $url1);
    curl_setopt($curl1, CURLOPT_RETURNTRANSFER, TRUE);
    curl_exec($curl1);
    $contime1 = curl_getinfo($curl1, CURLINFO_CONNECT_TIME);
    echo $url1 . ' took ' . $contime1 . ' seconds to connect<br />';
} 
```

经测试。样本结果：

```
php.net took 0.032 seconds to connect 
w3schools.com took 0.124 seconds to connect 
stackoverflow.com took 0.016 seconds to connect 
```

# java - 从数据库中断中恢复的 Java DAL？

> ID：14838342
> 
> 赞同：2
> 
> 时间：2013-02-12T17:33:11.170
> 
> 标签：java, oracle, spring, jdbctemplate, ucp

我的 DAL 包括通过 Oracle 的 UCP 连接到 Oracle 的 Spring Data Access。这意味着我主要使用 JdbcTemplate。我的服务器的一个要求是从数据库中断中恢复，更具体地说，如果我们发生中断，我们的服务器显然可以抛出许多异常，但是，一旦数据库重新联机，服务器应该再次完美运行。

JdbcTemplate 会与 UCP 一起为我处理吗？换句话说，JdbcTemplate 会在数据库关闭时抛出异常，但是一旦数据库恢复（它由 UCP 支持，所以我希望是这种情况）就可以运行，还是我需要做其他事情，比如创建一个新的 UCP例如工厂？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T19:57:16.230

为了模拟数据库中断，我们的 DBA 关闭了相关服务帐户并在我们的服务器运行时终止了所有现有连接。然后我们发现，为了其他人的利益，我自己的问题的答案是，如果没有正确的配置，JdbcTemplate 将不会自动恢复。

我的初始配置如下：

```
<bean id="DataSource" class="oracle.ucp.jdbc.PoolDataSourceFactory" factory-method="getPoolDataSource">
    <property name="URL" value="${jdbc.url}"/>
    <property name="User" value="${jdbc.user}"/>
    <property name="Password" value="${jdbc.password}"/>
    <property name="ConnectionFactoryClassName" value="oracle.jdbc.pool.OracleDataSource"/>
    <property name="ConnectionPoolName" value="FOX"/>
    <property name="MinPoolSize" value="1"/>
    <property name="MaxPoolSize" value="3"/>
    <property name="InitialPoolSize" value="1"/>
</bean>

<bean id="DataTemplate" class="org.springframework.jdbc.core.JdbcTemplate">
    <constructor-arg ref="DataSource" />
</bean> 
```

不幸的是，在中断的情况下，这会在您的池中留下死连接，因此，我们的服务器没有恢复。我想有很多不同的方法可以解决这个问题，例如，当你看到异常时可能通过清除池，但是，设置`ValidateConnectionOnBorrow`为`true`是​​一个简单的更改并且具有预期的效果：

```
<bean id="DataSource" class="oracle.ucp.jdbc.PoolDataSourceFactory" factory-method="getPoolDataSource">
    <property name="URL" value="${jdbc.url}"/>
    <property name="User" value="${jdbc.user}"/>
    <property name="Password" value="${jdbc.password}"/>
    <property name="ConnectionFactoryClassName" value="oracle.jdbc.pool.OracleDataSource"/>
    <property name="ConnectionPoolName" value="FOX"/>
    <property name="MinPoolSize" value="1"/>
    <property name="MaxPoolSize" value="3"/>
    <property name="InitialPoolSize" value="1"/>
    <property name="ValidateConnectionOnBorrow" value="true"/>
</bean>

<bean id="DataTemplate" class="org.springframework.jdbc.core.JdbcTemplate">
    <constructor-arg ref="DataSource" />
</bean> 
```

现在我们的池连接已经过验证，当发生中断时，断开的连接会被处理掉。结果，一旦数据库恢复，我们的服务器就重新上线了。

# php - 当Apache在xampp控制面板上启动时运行一个php文件，可以吗？

> ID：14838344
> 
> 赞同：1
> 
> 时间：2013-02-12T17:33:23.117
> 
> 标签：php, apache, xampp

实际上，我创建了一个 .php 文件，其中实现了所有查询以更新某些状态并希望在 apache 启动时运行（Apache 在 xampp 控制面板上启动）。如果可能的话，请告诉我有关如何配置以及我必须在哪里更改设置以启动 php 文件的详细信息。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:52:24.107

`apache_start.bat`XAMPP在 xampp 的根目录中附带一个文件。您可以编辑此文件以包含以下行（*在编辑之前保存 .bat 文件的备份副本！*）：

```
php -f  <path to your php script> 
```

将该行放在带有 的行*之前*`apache\bin\httpd.exe`，您的脚本将在 apache 重新启动时执行。

如果您尚未将 PHP.exe 添加到环境变量中，则必须在命令中使用 PHP 的完整路径。您还应该提供 php 脚本的完整路径。例如：

```
c:\xampp\php\php.exe -f c:\xampp\htdocs\your-script.php
apache\bin\httpd.exe 
```

如果您遇到问题，请先尝试从命令行运行您的 php 脚本，以确保它可以正常工作。可能需要进行一些实验才能正确设置路径，并根据您使用的 Windows 版本配置权限。

请注意，您必须运行 .bat 文件才能重新启动 apache 并执行您的脚本。如果您通过单击 XAMPP 控制面板中的开始按钮重新启动 apache，它将忽略 .bat 文件并且您的脚本将不会执行。*（如果我知道如何使用 XAMPP 控制面板的开始按钮执行脚本，我会更新这个答案）*

# java - 使用支持库导出 android 项目时出现 ProGuard 错误

> ID：14838347
> 
> 赞同：1
> 
> 时间：2013-02-12T17:33:30.583
> 
> 标签：java, android, apk, proguard, android-support-library

我在 Eclipse 中导出项目时遇到问题。我在 zxing 的 Barcode Scanner 之上构建了我的应用程序，当我尝试导出时，我得到了这个非常大的错误日志：

```
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.os.ParcelableCompatCreatorHoneycombMR2: can't find superclass or interface android.os.Parcelable$ClassLoaderCreator
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.AccessibilityDelegateCompatIcs$1: can't find superclass or interface android.view.View$AccessibilityDelegate
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.AccessibilityDelegateCompatJellyBean$1: can't find superclass or interface android.view.View$AccessibilityDelegate
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityManagerCompatIcs$1: can't find superclass or interface android.view.accessibility.AccessibilityManager$AccessibilityStateChangeListener
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityNodeProviderCompatJellyBean$1: can't find superclass or interface android.view.accessibility.AccessibilityNodeProvider
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.SearchViewCompatHoneycomb$1: can't find superclass or interface android.widget.SearchView$OnQueryTextListener
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.accessibilityservice.AccessibilityServiceInfoCompatIcs: can't find referenced method 'boolean getCanRetrieveWindowContent()' in class android.accessibilityservice.AccessibilityServiceInfo
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.accessibilityservice.AccessibilityServiceInfoCompatIcs: can't find referenced method 'java.lang.String getDescription()' in class android.accessibilityservice.AccessibilityServiceInfo
---- even more lines here, but i touched SO lines limit :) ----
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcs: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcsMr1: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcsMr1: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcsMr1: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcsMr1: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatIcsMr1: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatJellyBean: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.view.accessibility.AccessibilityRecordCompatJellyBean: can't find referenced class android.view.accessibility.AccessibilityRecord
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.EdgeEffectCompatIcs: can't find referenced class android.widget.EdgeEffect
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.EdgeEffectCompatIcs: can't find referenced class android.widget.EdgeEffect
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.EdgeEffectCompatIcs: can't find referenced class android.widget.EdgeEffect
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.EdgeEffectCompatIcs: can't find referenced class android.widget.EdgeEffect
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.EdgeEffectCompatIcs: can't find referenced class android.widget.EdgeEffect
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.EdgeEffectCompatIcs: can't find referenced class android.widget.EdgeEffect
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.EdgeEffectCompatIcs: can't find referenced class android.widget.EdgeEffect
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.EdgeEffectCompatIcs: can't find referenced class android.widget.EdgeEffect
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.EdgeEffectCompatIcs: can't find referenced class android.widget.EdgeEffect
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.EdgeEffectCompatIcs: can't find referenced class android.widget.EdgeEffect
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.ScrollerCompatIcs: can't find referenced method 'float getCurrVelocity()' in class android.widget.Scroller
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.SearchViewCompatHoneycomb: can't find referenced class android.widget.SearchView
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.SearchViewCompatHoneycomb: can't find referenced class android.widget.SearchView
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.SearchViewCompatHoneycomb: can't find referenced class android.widget.SearchView$OnQueryTextListener
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.SearchViewCompatHoneycomb: can't find referenced class android.widget.SearchView
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.SearchViewCompatHoneycomb$1: can't find referenced class android.widget.SearchView$OnQueryTextListener
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: android.support.v4.widget.SearchViewCompatHoneycomb$1: can't find referenced class android.widget.SearchView
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity]       You should check if you need to specify additional program jars.
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: there were 269 unresolved references to classes or interfaces.
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity]          You may need to specify additional library jars (using '-libraryjars').
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] Warning: there were 55 unresolved references to program class members.
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity]          Your input classes appear to be inconsistent.
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity]          You may need to recompile them and try again.
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity]          Alternatively, you may have to specify the option 
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity]          '-dontskipnonpubliclibraryclassmembers'.
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity] java.io.IOException: Please correct the above warnings first.
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity]     at proguard.Initializer.execute(Initializer.java:321)
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity]     at proguard.ProGuard.initialize(ProGuard.java:211)
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity]     at proguard.ProGuard.execute(ProGuard.java:86)
[2013-02-12 18:25:23 - com.google.zxing.client.android.CaptureActivity]     at proguard.ProGuard.main(ProGuard.java:492) 
```

当我将此行添加到我的 proguard.cfg 时：

```
-dontwarn android.support.** 
```

我明白了：

```
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity] Proguard returned with error code 1\. See console
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]       You should check if you need to specify additional program jars.
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity] Unexpected error while evaluating instruction:
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]   Class       = [android/support/v4/view/AccessibilityDelegateCompat$AccessibilityDelegateJellyBeanImpl]
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]   Method      = [newAccessiblityDelegateBridge(Landroid/support/v4/view/AccessibilityDelegateCompat;)Ljava/lang/Object;]
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]   Instruction = [18] areturn
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]   Exception   = [java.lang.IllegalArgumentException] (Can't find any super classes of [android/support/v4/view/AccessibilityDelegateCompatIcs$1] (not even immediate super class [android/view/View$AccessibilityDelegate]))
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity] Unexpected error while performing partial evaluation:
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]   Class       = [android/support/v4/view/AccessibilityDelegateCompat$AccessibilityDelegateJellyBeanImpl]
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]   Method      = [newAccessiblityDelegateBridge(Landroid/support/v4/view/AccessibilityDelegateCompat;)Ljava/lang/Object;]
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]   Exception   = [java.lang.IllegalArgumentException] (Can't find any super classes of [android/support/v4/view/AccessibilityDelegateCompatIcs$1] (not even immediate super class [android/view/View$AccessibilityDelegate]))
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity] java.lang.IllegalArgumentException: Can't find any super classes of [android/support/v4/view/AccessibilityDelegateCompatIcs$1] (not even immediate super class [android/view/View$AccessibilityDelegate])
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.evaluation.value.ReferenceValue.generalize(ReferenceValue.java:287)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.evaluation.value.IdentifiedReferenceValue.generalize(IdentifiedReferenceValue.java:65)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.evaluation.value.ReferenceValue.generalize(ReferenceValue.java:481)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.optimize.info.MethodOptimizationInfo.generalizeReturnValue(MethodOptimizationInfo.java:247)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.optimize.evaluation.StoringInvocationUnit.generalizeMethodReturnValue(StoringInvocationUnit.java:195)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.optimize.evaluation.StoringInvocationUnit.setMethodReturnValue(StoringInvocationUnit.java:126)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.evaluation.BasicInvocationUnit.exitMethod(BasicInvocationUnit.java:134)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.evaluation.Processor.visitSimpleInstruction(Processor.java:514)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.classfile.instruction.SimpleInstruction.accept(SimpleInstruction.java:218)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.optimize.evaluation.PartialEvaluator.evaluateSingleInstructionBlock(PartialEvaluator.java:753)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.optimize.evaluation.PartialEvaluator.evaluateInstructionBlock(PartialEvaluator.java:587)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.optimize.evaluation.PartialEvaluator.evaluateInstructionBlockAndExceptionHandlers(PartialEvaluator.java:560)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.optimize.evaluation.PartialEvaluator.visitCodeAttribute0(PartialEvaluator.java:264)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.optimize.evaluation.PartialEvaluator.visitCodeAttribute(PartialEvaluator.java:181)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.classfile.attribute.CodeAttribute.accept(CodeAttribute.java:101)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.classfile.ProgramMethod.attributesAccept(ProgramMethod.java:79)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.classfile.attribute.visitor.AllAttributeVisitor.visitProgramMember(AllAttributeVisitor.java:95)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.classfile.util.SimplifiedVisitor.visitProgramMethod(SimplifiedVisitor.java:91)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.classfile.ProgramMethod.accept(ProgramMethod.java:71)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.classfile.ProgramClass.methodsAccept(ProgramClass.java:504)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.classfile.visitor.AllMethodVisitor.visitProgramClass(AllMethodVisitor.java:47)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.classfile.ProgramClass.accept(ProgramClass.java:346)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.classfile.ClassPool.classesAccept(ClassPool.java:116)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.optimize.Optimizer.execute(Optimizer.java:372)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.ProGuard.optimize(ProGuard.java:306)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.ProGuard.execute(ProGuard.java:115)
[2013-02-12 18:19:30 - com.google.zxing.client.android.CaptureActivity]     at proguard.ProGuard.main(ProGuard.java:492) 
```

我的 proguard.cfg 文件：

```
-optimizationpasses 5
-dontusemixedcaseclassnames
-dontskipnonpubliclibraryclasses
-dontpreverify
-verbose
-optimizations !code/simplification/arithmetic,!field/*,!class/merging/*

-keep public class * extends android.app.Activity
-keep public class * extends android.app.Application
-keep public class * extends android.app.Service
-keep public class * extends android.content.BroadcastReceiver
-keep public class * extends android.content.ContentProvider
-keep public class * extends android.app.backup.BackupAgentHelper
-keep public class * extends android.preference.Preference
-keep public class com.android.vending.licensing.ILicensingService

-keepclasseswithmembernames class * {
    native <methods>;
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet);
}

-keepclasseswithmembers class * {
    public <init>(android.content.Context, android.util.AttributeSet, int);
}

-keepclassmembers class * extends android.app.Activity {
   public void *(android.view.View);
}

-keepclassmembers enum * {
    public static **[] values();
    public static ** valueOf(java.lang.String);
}

-keep class * implements android.os.Parcelable {
  public static final android.os.Parcelable$Creator *;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T18:05:11.367

好的，伙计们，我找到了。基本上，您必须在项目设置中删除所有 jar 依赖项，然后清理项目，就是这样！我今天头发变白了，我得了神经症。哦，这是需要的：

```
-dontwarn android.support.** 
```

感谢您的关注！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T09:27:55.287

您应该针对包含上述类的 Android 平台版本进行构建。例如，android.view.accessibility.AccessibilityRecord 仅在 android-14 中存在。

您仍然可以在 AndroidManifest.xml 中指定不同的最低版本和目标版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-07T21:11:52.237

如果您只想导出一个版本，请考虑暂时禁用 Proguard：

*   1）编辑 project.properties ，注释掉 proguard.config=
*   2）重命名proguard目录下
*   3) 重命名 proguard*.cfg 文件

# wpf - 在 WPF 中绑定 Grid 的内容

> ID：14838349
> 
> 赞同：2
> 
> 时间：2013-02-12T17:33:39.670
> 
> 标签：wpf, xaml, data-binding, datagrid, grid

有没有办法将网格的内容（子项）绑定到数据源（我的意思是对象）？例如将网格的内容绑定到按钮列表

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T19:04:37.647

对于绑定到集合，您几乎总是希望使用它的一个`ItemsControl`或一个派生词。将为绑定到其属性的集合中的`ItemsControl`每个项目创建一个子项，并使用和`ItemsSource`渲染它们，然后将它们各自放入定义的布局面板中。要使用 Grid 来执行此布局，您需要将其放入分配给属性中，如果您想要特定行和列中的项目，还可以在您的中设置和属性- 绑定到数据或以某种方式计算。`ItemContainerStyle``ItemTemplate``ItemsPanel``ItemsPanelTemplate``ItemsPanel``Grid.Row``Grid.Column``ItemContainerStyle`

# c# - 更新应用程序后 ASP.NET MVC 停止工作 - MembershipUser 出现问题

> ID：14838351
> 
> 赞同：3
> 
> 时间：2013-02-12T17:33:43.087
> 
> 标签：c#, asp.net-mvc, entity-framework, asp.net-membership, membership-provider

今天我将我的应用程序更新到了最新版本。现在在这段代码：

```
Membership.GetUser(); 
```

我收到以下错误：

> 找不到方法：“System.Data.Objects.ObjectContext System.Data.Entity.Infrastructure.IObjectContextAdapter.get_ObjectContext()”。

我知道更新改变了我的 web.config - 也许是因为这个文件现在有问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T22:35:11.000

看起来这是由包[`Microsoft.AspNet.Providers.Core`](https://nuget.org/packages/Microsoft.AspNet.Providers.Core)v. 1.2 引起的。我卸载了它，然后安装了 1.1 版。如果你也在使用`LocaDb`，你必须卸载`LocaDb`包，因为它依赖于`Microsoft.AspNet.Providers.Core`. 之后您必须重新安装`LocaDb`。

使用 Visual Studio 中的 NuGet 包管理器控制台获取 v. 1.1：

```
Install-Package Microsoft.AspNet.Providers.Core -Version 1.1 
```

# mysql - 来自表 mysql 的随机文本

> ID：14838353
> 
> 赞同：0
> 
> 时间：2013-02-12T17:34:02.533
> 
> 标签：mysql, database, random, opencart

我做了一个滑块，你可以[在这里](http://upgradeloja.genesiseries.com/depoimentos/index.php)看到。

这就像意见一样，我的客户可以在这里发表意见。

现在显示文本的代码是：

```
 <div>
            <p class="depoimento"><font color="#bdbdbd">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</font></p><p class="cliente"><font color="#99CB1E">Paulo Henrique, São Paulo - SP</font></p>
        </div>
        <div>
            <p><font color="#bdbdbd">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</font></p>
        </div> 
```

现在一切正常，但在这里添加每一个意见真的很难，所以我在想什么？我可以创建一个 mysql 并随机化并调用每个滑块。

我只是不知道该怎么做。

我需要这样的东西：

```
[COMMAND TO MYSQL RANDOM MY OPINION]

<p class="depoimento"> PRINT OPINION HERE </p><p class="cliente"> PRINT CLIENT NAME INFORMATION HERE </p> 
```

如您所见，我在这里有 2 个 P，一个用于意见，另一个用于客户。我在这里测试，我创建了一个 mysql 数据库和一个名为：“tdepo”的表和两列：Depo 和 Client

有人知道我该怎么做吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:45:23.260

如果意见数量很少，您可以使用缓慢但可靠的版本：

```
SELECT opinion_text
FROM opinions
ORDER BY random()
LIMIT 1 
```

如果您想要更快的版本，另一种解决方案假定 table`opinions`具有`INTEGER PRIMARY KEY`column `opinion_id`，并且该列使用从 1 到行数的*所有值：*

```
SELECT opinion_text
FROM opinions
WHERE opinion_id = ceil(random()*
    (SELECT max(opinion_id) FROM opinions)) 
```

如果你有漏洞，这个查询可能会给出空结果，你需要重复它。但是，它的优点是速度非常快。

# javascript - Yii CGridView javascript分页事件

> ID：14838357
> 
> 赞同：5
> 
> 时间：2013-02-12T17:34:33.357
> 
> 标签：javascript, yii

我正在使用 jQuery 在 Yii 中扩展 CGridView 以在切换页面时记住选中的行。页面是使用 AJAX 加载的，所以我认为当请求完成并呈现新页面时，我希望我的代码能够介入，这很神奇。但是，我似乎找不到任何文档表明任何事件被触发，或者当新页面完成呈现时。

但是，我可以使用 DOM 侦听器，但我认为对整个页面使用一个事件会更好。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-12T17:52:14.193

您可以使用[`afterAjaxUpdate`](http://www.yiiframework.com/doc/api/1.1/CGridView#afterAjaxUpdate-detail)（因为您的页面是用 ajax 加载的）：

```
$this->widget('zii.widgets.grid.CGridView', array(
    // ... options ...
    'ajaxUpdate'=>true,
    'afterAjaxUpdate'=>'aFunctionThatWillBeCalled', //
    // ... more options ...
)); 
```

您可以像这样添加 js 函数：

```
Yii::app()->clientScript->registerScript('some-script-id','function aFunctionThatWillBeCalled(id, data){
    console.log("id is "+id);
    // your jquery code to remember checked rows
}'); 
```

# php - 搜索数组功能 - 需要更严格

> ID：14838359
> 
> 赞同：0
> 
> 时间：2013-02-12T17:34:39.543
> 
> 标签：php, arrays, search

我使用这个函数来搜索数组：

```
function search_array ( $array, $term )
    {
       foreach ( $array as $key => $value )
            if ( stipos( $value, $term ) !== false )
            $val = str_replace('"',"",preg_replace("/[a-zA-Z0-9]=/","",$array[$key]));
               if (isset($val)) return $val;
          return false;
    } 
```

这很好用，但我需要做的限制性更强。

```
 $a = (search_array($l, "7=")); echo "Device ID: $a"; 
```

这行得通，但我只想要一个匹配而`7=`不是它当前正在做的匹配。知道我如何只匹配我输入的内容而不尝试扩展它吗？`17=``27=`

抱歉，我应该包含我在 PHP4 中使用的这个函数。

```
function stipos($haystack, $needle){

    return strpos($haystack, stristr( $haystack, $needle ));

} 
```

条目类似于 ;

1="设备"、3="用户"、7="ID123456"、27="节点"等

如果我正在搜索 7=，我希望返回的结果是 ID123456

目前我得到 2Node 被返回，它取自 27="Node"

这是我如何使用它的一个例子：

```
 $line = "1=\"Device\",3=\"User\",7=\"ID123456\",27=\"Node\"";
 $q = explode(",",str_replace('"','',$line));
 $p = (search_array($q, "7=")); echo "ID : ".$p; 
```

我希望返回 7=，但我得到 27= 的值和最初的 2，导致

```
ID : 2Node 
```

不是

```
ID : ID123456 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:56:59.650

```
<?php
$strings = array();
$strings[] = '0=';
$strings[] = '1=';
$strings[] = '2=';
$strings[] = '3=';
$strings[] = '10=';
$strings[] = '12=';
$strings[] = 'a2=';
$strings[] = 'a1232=';
$strings[] = ' 4= ';
$strings[] = ' 5= ';
$strings[] = ' 6=a';

foreach($strings as $string)
{
    if(preg_match('/^\d{1}=$/', $string))
    {
        echo $string."<br>\n";
    }
} 
```

输出：

```
0=
1=
2=
3= 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T09:32:13.520

使用解决：

```
$line = "1=\"Device\",3=\"User\",7=\"ID123456\",27=\"Node\"";

$value_7 = null;
if(preg_match('#\b7="([^"]*)"#', $line, $matches)) {
    $value_7 = $matches[1];
}
var_dump($value_7); 
```

# command-line - 从另一个批次调用一个批次，然后启动服务

> ID：14838360
> 
> 赞同：0
> 
> 时间：2013-02-12T17:34:41.927
> 
> 标签：command-line, batch-file

我正在尝试从另一批次调用本地计算机上的批次。然后我试图在远程计算机上启动服务。这是我的代码：

```
call C:\Oracle\Middleware\user_projects\epm_system\bin\start.bat > SS.log
sc \\OtherMachine start "Service1" >> SS.log
sc \\OtherMachine start "Service2" >> SS.log 
```

我已经确认无需`start.bat`提前启动就可以启动服务。但是，当我尝试`start.bat`使用第一行代码调用时，它只会在完成后关闭，而不运行最后两行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:39:01.807

您可以在第一批中调用 cmd.exe，如果第二批包含退出，则不会关闭它。示例：
call.cmd

```
cmd /c "c:\temp\test.cmd"
echo end of first batch 
```

测试.cmd

```
@echo off
echo test 
exit 
```

结果 ：

```
C:\temp>call.cmd
test
end of first batch 
```

# com - 如何通过 ColdFusion 9 从 COM 对象中检索安全数组（结构）

> ID：14838361
> 
> 赞同：1
> 
> 时间：2013-02-12T17:34:42.867
> 
> 标签：com, coldfusion, coldfusion-9, safearray, createobject

我试图引用定义为的 COM 对象方法：

```
IEdmFile7::GetDerivedBOMs  
Returns the derived (a.k.a. "named" or "saved") bills of materials associated with this file.  
Prototype:

HRESULT GetDerivedBOMs( [out,ref] SAFEARRAY ( struct EdmBomInfo ) *ppoBoms ); 
```

我在 edmFile 变量中有对 IEdmFile7 对象的引用。

当我`<cfdump var="#edmFile#">`的方法是可见的：

```
Method: GetDerivedBOMs([out]USERDEFINED, [out, retval]VOID) 
```

当我尝试调用该方法时（尝试传递许多不同的参数类型）：

```
<cfset edmFile.GetDerivedBOMs(???)> 
```

它与`AutomationException: Member not found`. 我只能假设它没有正确识别或投射参数。如何正确地将安全数组（结构）的引用传递给方法？

**（根据评论编辑）**

我尝试过的一些示例：

```
 <cfset myObject = createObject("java","java.lang.Object").init()> 
 <cfset myArray = arrayNew(1)> 
 <cfset myRefArrayOfObjects = javaCast("java.lang.Object[]", myArray)> 
 <cfset myResultArray = edmFile.GetDerivedBOMs(myRefArrayOfObjects)> 
```

结果：

```
 Member Not Found Description: Automation Exception: Member Not Found 
```

评论中的另一个尝试：

```
<cfset myArray = ArrayNew(1)> 
<cfset myArray = edmFile.GetDerivedBOMs()> 
```

结果：

```
There are no methods with the specified method name and argument types. 
Check your function and retry 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-27T16:53:40.697

不幸的是，这是一个 .net 互操作限制。来自 CF 文档

[http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec13e1a-7fd4.html](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec13e1a-7fd4.html)

*   您不能使用指针作为参数或返回类型来调用方法。
*   您不能调用带有 Out 参数的方法。

在这种情况下，您将使用 safearray 类型的变量的 byref 地址[指针] 来命中这两个变量，它将创建并作为 OUT 参数返回给您。

在这种情况下，我发现创建一个 .net 类来“包装”它来充当中介来解决 CF 在这样做时遇到的问题更容易。

# logging - 如何在 dartlang 中查看 Logger 的输出（Dartium 或命令行）

> ID：14838362
> 
> 赞同：5
> 
> 时间：2013-02-12T17:34:43.633
> 
> 标签：logging, dart

我希望能够从可能是 Web 应用程序或命令行应用程序的一部分的包中记录以进行调试

我用的电流

```
print('some text'); 
```

但是我无法在运行时控制打印的内容（DEBUG，INFO，...）虽然我习惯于在 java 中使用 java.util.logging.Logger，但我找不到在日志包中使用 Logger 类的方法dart，在 Web 或命令行应用程序中。

```
Logger logger = new Logger('test');
logger.info('some text'); 
```

上面的简单代码编译得很好，但我在 Dartium 的控制台或 DartEditor 的输出窗格中都看不到任何输出。

有没有人成功使用它（并看到一些文字）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T19:10:31.357

在我的 Dart Bat-belt 中，我保留了这样的功能：

```
void printLogRecord(LogRecord r) {
  print("${r.loggerName} ${r.level} ${r.message}");
} 
```

然后我将它添加到一个记录器，通常是根记录器：

```
Logger.root.level = Level.FINE;
Logger.root.onRecord.listen(printLogRecord); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-01T14:50:58.383

在 lastes m4 版本中，这是对我有用的 API：

```
Logger.root.level = Level.FINEST;
Logger.root.onRecord.listen((LogRecord r) {
  window.console.log('${r.loggerName}(${r.level}): ${r.message}');
}); 
```

# c# - 向具有标识主键的 sql 数据库添加一行

> ID：14838368
> 
> 赞同：1
> 
> 时间：2013-02-12T17:35:20.810
> 
> 标签：c#, sql, sql-server

我有一个简单的测试数据库，它有一个名为 ID 的列，它是一个带有自动标识集的主键。

我正在尝试向使用 sqladapter 创建的数据表添加新行

当我将新行的 ID 列留空时，认为 sql 会添加它，它会显示以下错误：

```
"Column "ID" doesn't not allow nulls 
```

我解决了它，但给 ID 任何值，比如`dr["ID"] = 99999`

它起作用了，但是现在 SQL 数据库忽略了该值并只给它正确的数字，但数据表的 ID 为 99999，这使它有点混乱，如果我尝试插入另一条记录，可能会抛出错误

我怎么解决这个问题？

对于那个很抱歉：

```
 DataRow dr = dt.NewRow();
            dr["Name"] = "fds";//E.Name;
            dr["Age"] = 12;// E.Age;
            dr["DateOfBirth"] = "1-1-1999";// E.DoB;
            //dr["ID"] = 99999;
            dt.Rows.InsertAt(dr, dt.Rows.Count - 1);
            DBOperations.UpdateTable(dt);
            MessageBox.Show("Record added successfully");

    static internal void UpdateTable(DataTable dt)
    {
        SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString);
        SqlDataAdapter Adapter = new SqlDataAdapter();
        Adapter.SelectCommand = new SqlCommand("select * from Emp",con); 
        Adapter.UpdateCommand = new SqlCommandBuilder(Adapter).GetUpdateCommand();
        Adapter.InsertCommand = new SqlCommandBuilder(Adapter).GetInsertCommand();
        Adapter.DeleteCommand = new SqlCommandBuilder(Adapter).GetDeleteCommand();
        Adapter.Update(dt);
    } 
```

数据库脚本：

```
USE [HR]
GO
/****** Object:  Table [dbo].[Emp]    Script Date: 2/12/2013 8:10:49 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Emp](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nvarchar](max) NOT NULL,
    [Age] [int] NOT NULL,
    [DateOfBirth] [date] NOT NULL,
 CONSTRAINT [PK_Emp] PRIMARY KEY CLUSTERED 
(
    [ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO 
```

截屏： ![在此处输入图像描述](../Images/aaa5cf1b480e10b6233ef6b324af8865.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T18:22:39.093

您可能需要检查三件事：

1）你可以试试

```
dt.Rows.Add(dr); 
```

代替

```
dt.Rows.InsertAt(dr, dt.Rows.Count - 1); 
```

2) 如果您对表运行 INSERT 语句，SQL Server 是否会创建一个新 ID/完成没有错误的语句？喜欢

```
INSERT INTO tb_mytable (Name, Age) VALUES ('fds', 12) 
```

如果不是，则 ID 字段可能有问题。

3）您是否检查了适配器（创建的）插入命令的正确性？

编辑：您也可以-而不是使用CommandBuilder，尝试手动创建插入命令，就像这样，看看会发生什么-如果这工作正常，那么您的CommandBuilder有问题：

```
string sql  = "INSERT INTO [dbo].[emp] ";
sql += "(Name, Age, DateOfBirth) ";
sql += "Values (@Name, @Age, @DateOfBirth)";

SqlCommand insertCommand = new SqlCommand();
insertCommand.CommandText = sql;

SqlParameter paramName = new SqlParameter();
paramName.ParameterName = "@Name";
paramName.DbType = DbType.AnsiString;
paramName.SqlDbType = SqlDbType.NVarChar;
paramName.SourceVersion = DataRowVersion.Current;
paramName.SourceColumn = "Name";

SqlParameter paramAge = new SqlParameter();
paramAge.ParameterName = "@Age";
paramAge.DbType = DbType.Int32;
paramAge.SqlDbType = SqlDbType.Int;
paramAge.SourceVersion = DataRowVersion.Current;
paramAge.SourceColumn = "Age";

SqlParameter paramDoB = new SqlParameter();
paramDoB.ParameterName = "@DateOfBirth";
paramDoB.DbType = DbType.Date;
paramDoB.SqlDbType = SqlDbType.Date;
paramDoB.SourceVersion = DataRowVersion.Current;
paramDoB.SourceColumn = "DateOfBirth";

insertCommand.Parameters.Add(paramName);
insertCommand.Parameters.Add(paramAge);
insertCommand.Parameters.Add(paramDoB);

Adapter.InsertCommand = insertCommand; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:59:25.270

错误来自DataAdapter，我很确定，而不是来自数据库。请参阅 [http://msdn.microsoft.com/en-us/library/ms971502.aspx](http://msdn.microsoft.com/en-us/library/ms971502.aspx)

# node.js - node.js mongodb 检索 ISODate 格式

> ID：14838369
> 
> 赞同：1
> 
> 时间：2013-02-12T17:35:21.293
> 
> 标签：node.js, mongodb, date

在 mongodb 中，日期的值是：

```
"date" : ISODate("2012-10-11T07:00:00Z") 
```

在带有猫鼬的节点中，我检索日期并具有以下值：

```
entry.date = 2012-10-11T07:00:00.000Z 
```

因此，在我的代码中，我执行以下操作：

```
var date = new Date(entry.date);
var format = date.getMonth() + '/' + date.getDate() + '/' + date.getFullYear(); 
```

我得到输出：

```
9/11/2012 
```

这有什么问题？
我原以为输出会是：`10/11/2012`

我知道月份从日期的 0-11 开始。但既然我从日期格式中获取它，为什么我必须减去 1 个月。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:41:30.127

### JavaScript[`Date.getMonth()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getMonth)是从零开始的，而不是从一开始的。

“日期”变量是一个[`Date`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)，而不是您怀疑的“日期格式”（JavaScript 没有这样的概念）。

```
var dateStr = '2012-10-11T07:00:00.000Z';
var date = new Date(dateStr); // Thu Oct 11 2012 01:00:00 GMT-0600 (MDT)
date.getMonth(); // => 9 (October) 
```

试试这个：

```
var format = (date.getMonth()+1) + //... 
```

# iphone - 如何旋转 24 小时制时钟的指针？

> ID：14838371
> 
> 赞同：0
> 
> 时间：2013-02-12T17:35:33.607
> 
> 标签：iphone, ios, objective-c, xcode

我正在做一个时钟项目，我知道如何实现 12 小时时钟的指针（小时、分钟、秒）旋转。我使用的代码如下

```
CGFloat secAngle,minAngle,hourAngle;

NSDateComponents *dateComponents = [[NSCalendar currentCalendar] components:(NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit) fromDate:[NSDate date]];
NSInteger seconds = [dateComponents second];
NSInteger minutes = [dateComponents minute];
NSInteger hours = [dateComponents hour];

if (timeFormat == 12)//12 hour clock
{

    if (hours > 12) hours -=12; //PM

     secAngle = Degrees2Radians(seconds/60.0*360);
     minAngle = Degrees2Radians(minutes/60.0*360);

     hourAngle = Degrees2Radians(hours/12.0*360) + minAngle/12.0;

    //secHand.transform = CATransform3DMakeRotation (secAngle+M_PI, 0, 0, 1);
    minHand.transform = CATransform3DMakeRotation (minAngle+M_PI, 0, 0, 1);
    hourHand.transform = CATransform3DMakeRotation (hourAngle+M_PI, 0, 0, 1);
}
else //24 hour clock
{

    secAngle = Degrees2Radians(seconds/60.0*360);
    minAngle = Degrees2Radians(minutes/60.0*360);
    hourAngle = (30 * hours + minutes / 2) /2;

    //secHand.transform = CATransform3DMakeRotation(secAngle * M_PI / 180,0,0,1);
    minHand.transform = CATransform3DMakeRotation(minAngle * M_PI ,0,0,1);
    hourHand.transform = CATransform3DMakeRotation(hourAngle * M_PI,0,0,1);

} 
```

但是当我尝试实现 24 小时制时。它不工作。每次我运行这个项目时，时钟都会显示错误的时间。

谁能告诉我我做错了什么。提前谢谢了

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T18:39:37.550

我是这样做的——我使用面部中心和角度来计算手端点的 x、y 位置，从那里开始绘图很简单。这是一个完整的钟面类。它是 UIView 的子类。每秒设置它的时间属性，它就像一个魅力......

```
//
//  ClockFace.h
//

#import <UIKit/UIKit.h>

@interface ClockFace : UIView

@property (strong,nonatomic) NSDate *time;

@end

//  ClockFace.m

#import "ClockFace.h"

@interface ClockFace ()

@property(assign,nonatomic) CGPoint boundsCenter;
@property(assign,nonatomic) NSInteger seconds;
@property(assign,nonatomic) NSInteger minutes;
@property(assign,nonatomic) NSInteger hours;

@end

@implementation ClockFace

@synthesize time=_time;
@synthesize boundsCenter=_boundsCenter;

- (id)initWithCoder:(NSCoder *)aDecoder {

    self = [super initWithCoder:aDecoder];
    if (self) {
        _boundsCenter = CGPointMake(self.bounds.size.width/2.0, self.bounds.size.height/2.0);
    }
    return self;
}

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        _boundsCenter = CGPointMake(self.bounds.size.width/2.0, self.bounds.size.height/2.0);
    }
    return self;
}

- (CGPoint)secondsHandPosition {

    float secondsAsRadians = (float)self.seconds / 60.0 * 2.0 * M_PI - M_PI_2;
    float handRadius = self.frame.size.width / 2.4;
    return CGPointMake(handRadius*cosf(secondsAsRadians)+self.boundsCenter.x, handRadius*sinf(secondsAsRadians)+self.boundsCenter.y);
}

- (CGPoint)minutesHandPosition {

    float minutesAsRadians = (float)self.minutes / 60.0 * 2.0 * M_PI - M_PI_2;
    float handRadius = self.frame.size.width / 2.2;
    return CGPointMake(handRadius*cosf(minutesAsRadians)+self.boundsCenter.x, handRadius*sinf(minutesAsRadians)+self.boundsCenter.y);
}

- (CGPoint)hoursHandPosition {

    float hoursAsRadians = (float)self.hours / 12.0 * 2.0 * M_PI - M_PI_2;
    float handRadius = self.frame.size.width / 3.8;
    return CGPointMake(handRadius*cosf(hoursAsRadians)+self.boundsCenter.x, handRadius*sinf(hoursAsRadians)+self.boundsCenter.y);
}

// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGFloat zClear[4] = {1.0,1.0,1.0,0.0};
    CGContextSetFillColor(context, zClear); 
    CGContextFillRect(context, rect);

    CGRect face = CGRectInset(rect, 1.0, 1.0);
    CGContextSetLineWidth(context, 1.0);
    CGContextAddEllipseInRect(context, face);
    CGContextStrokePath(context);

    CGRect center = CGRectMake(self.boundsCenter.x-2.0, self.boundsCenter.y-2.0, 4.0, 4.0);
    CGContextAddEllipseInRect(context, center);
    CGContextStrokePath(context);

    CGFloat red[4] = {1.0f, 0.0f, 0.0f, 1.0f};
    CGPoint secondsHandPosition = [self secondsHandPosition];

    CGContextSetStrokeColor(context, red);
    CGContextBeginPath(context);
    CGContextMoveToPoint(context, self.boundsCenter.x, self.boundsCenter.y);
    CGContextAddLineToPoint(context, secondsHandPosition.x, secondsHandPosition.y);
    CGContextStrokePath(context);

    CGFloat black[4] = {0.0f, 0.0f, 0.0f, 1.0f};
    CGPoint minutesHandPosition = [self minutesHandPosition];

    CGContextSetStrokeColor(context, black);
    CGContextBeginPath(context);
    CGContextMoveToPoint(context, self.boundsCenter.x, self.boundsCenter.y);
    CGContextAddLineToPoint(context, minutesHandPosition.x, minutesHandPosition.y);
    CGContextStrokePath(context);

    CGPoint hoursHandPosition = [self hoursHandPosition];

    CGContextSetStrokeColor(context, black);
    CGContextBeginPath(context);
    CGContextMoveToPoint(context, self.boundsCenter.x, self.boundsCenter.y);
    CGContextAddLineToPoint(context, hoursHandPosition.x, hoursHandPosition.y);
    CGContextStrokePath(context);
}

- (void)setTime:(NSDate *)time {

    _time = time;

    static NSCalendar *gregorian;

    if (!gregorian) gregorian = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
    NSDateComponents *weekdayComponents =
    [gregorian components:(NSDayCalendarUnit | NSWeekdayCalendarUnit | NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit) fromDate:time];

    self.hours = [weekdayComponents hour];
    if (self.hours > 12) self.hours -= 12;
    self.minutes = [weekdayComponents minute];
    self.seconds = [weekdayComponents second];

    [self setNeedsDisplay];
}

@end 
```

要在视图控制器中使用它，请创建一个属性：

```
#import "ClockFace.h"

// ...

@property(strong, non atomic) ClockFace *clockFace; 
```

在视图中加载（如果您知道如何添加自定义视图，则在情节提要中）：

```
self.clockFace = [[ClockFace alloc] initWithFrame:CGRectMake(10, 10, 300, 300)]; 
```

每当您希望时钟运行时，请设置一个计时器：

```
[NSTimer scheduledTimerWithTimeInterval:1.0
    target:self
    selector:@selector(timerFired:)
    userInfo:nil
    repeats:NO]; 
```

当计时器触发时，告诉时钟现在几点：

```
- (void)timerFired:(NSTimer *)timer {

    self.clockFace.time = [NSDate date];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-09T18:19:38.200

@danh 为 Swift 更新了答案。

**钟面：**

```
class ClockFace: UIView {

    var calendar: NSCalendar!
    var time: Date!
    private var figureCenter: CGPoint = .zero
    private var faceRadius: CGFloat = 0
    private var seconds: Int = 0
    private var minutes: Int = 0
    private var hours: Int = 0
    private let angleOffset: CGFloat = -.pi / 2 // an offset to make 0 at "12:00" instead of "3:00"

    required init?(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        figureCenter = CGPoint(x: bounds.midX, y: bounds.midY)
        faceRadius = frame.size.width / 2.0
    }

    override init(frame: CGRect) {
        super.init(frame: frame)
        // Initialization code
        figureCenter = CGPoint(x: bounds.midX, y: bounds.midY)
        faceRadius = frame.size.width / 2.0
    }

    func secondsHandPosition() -> CGPoint {
        let radiansPerSecond = (CGFloat.pi * 2) / 60
        let secondsAsRadians: CGFloat = angleOffset + (CGFloat(seconds) * radiansPerSecond )
        let handRadius: CGFloat = faceRadius / 1.1
        return CGPoint(x: CGFloat(handRadius * cos(secondsAsRadians) + figureCenter.x), y: CGFloat(handRadius * sin(secondsAsRadians) + figureCenter.y))
    }

    func minutesHandPosition() -> CGPoint {
        let radiansPerMinute = (CGFloat.pi * 2) / 60
        let minutesAsRadians: CGFloat = angleOffset + (CGFloat(minutes) * radiansPerMinute)
        let handRadius: CGFloat = faceRadius / 1.25
        return CGPoint(x: CGFloat(handRadius * cos(minutesAsRadians) + figureCenter.x), y: CGFloat(handRadius * sin(minutesAsRadians) + figureCenter.y))
    }

    func hoursHandPosition() -> CGPoint {
        let radiansPerHour = (CGFloat.pi * 2) / 12
        let hoursAsRadians: CGFloat = angleOffset + (CGFloat(hours) * radiansPerHour)
        let handRadius: CGFloat = faceRadius / 1.8
        return CGPoint(x: CGFloat(handRadius * cos(hoursAsRadians) + figureCenter.x), y: CGFloat(handRadius * sin(hoursAsRadians) + figureCenter.y))
    }

    override func draw(_ rect: CGRect) {
        let context = UIGraphicsGetCurrentContext()!
        context.setFillColor(UIColor.white.cgColor)
        context.fill(rect)

        for count in 0...60 {
            let tickRadius = faceRadius / ((count % 5 == 0) ? 1.20 : 1.15)
            let lineWidth = (count % 5) == 0 ? 3 : 2
            let tickAngle = CGFloat(count) * ((CGFloat.pi * 2) / 60)
            context.beginPath()
            context.move(to: CGPoint(x: CGFloat(faceRadius * cos(tickAngle) + figureCenter.x), y: CGFloat(faceRadius * sin(tickAngle) + figureCenter.y)))
            context.addLine(to: CGPoint(x: CGFloat(tickRadius * cos(tickAngle) + figureCenter.x), y: CGFloat(tickRadius * sin(tickAngle) + figureCenter.y)))

            context.setStrokeColor(UIColor.black.cgColor)
            context.setLineWidth(CGFloat(lineWidth))
            context.strokePath()
        }

        let lineWidth: CGFloat = 5.0
        let face = rect.insetBy(dx: lineWidth / 2, dy: lineWidth / 2)
        context.setLineWidth(lineWidth)
        context.addEllipse(in: face)
        context.strokePath()

        let secondsHandPosition = self.secondsHandPosition()

        context.beginPath()
        context.move(to: figureCenter)
        context.addLine(to: secondsHandPosition)
        context.setLineWidth(1)
        context.setStrokeColor(UIColor.red.cgColor)
        context.strokePath()

        let minutesHandPosition = self.minutesHandPosition()

        context.beginPath()
        context.move(to: figureCenter)
        context.addLine(to: minutesHandPosition)
        context.setLineWidth(3)
        context.setStrokeColor(UIColor.black.cgColor)
        context.strokePath()

        let hoursHandPosition = self.hoursHandPosition()

        context.beginPath()
        context.move(to: figureCenter)
        context.addLine(to: hoursHandPosition)
        context.setLineWidth(5)
        context.setStrokeColor(UIColor.black.cgColor)
        context.strokePath()

        let center = CGRect(x: figureCenter.x - 5.0, y: figureCenter.y - 5.0, width: 10.0, height: 10.0)
        context.addEllipse(in: center)
        context.setFillColor(UIColor.black.cgColor)
        context.fillPath()
        context.strokePath()
    }

    func setTime(_ time: Date?) {

        self.time = time
        var weekdayComponents: DateComponents!

        if calendar == nil {
            calendar = NSCalendar(identifier: NSCalendar.Identifier.gregorian)
        }

        if let time = time {
            weekdayComponents = calendar.components([.day, .weekday, .hour, .minute, .second], from: time)
        }

        if weekdayComponents != nil {
            hours = weekdayComponents.hour!
            minutes = weekdayComponents.minute!
            seconds = weekdayComponents.second!

            hours = (hours + (12 - 1)) % 12 + 1;
        }

        self.setNeedsDisplay()
    }
} 
```

**视图控制器：**

```
class ViewController: UIViewController {

    @IBOutlet weak var clockView: ClockFace!

    override func viewDidLoad() {
        super.viewDidLoad()

        Timer.scheduledTimer(timeInterval: 1.0, target: self, selector: #selector(timerFired(_:)), userInfo: nil, repeats: true)
    }

    @objc func timerFired(_ timer: Timer?) {
        clockView.setTime(Date())
    }
} 
```

# sql - 一列上的 TSQL 动态过滤器

> ID：14838374
> 
> 赞同：0
> 
> 时间：2013-02-12T17:35:38.933
> 
> 标签：sql, sql-server, variables, dynamic, parameters

要查询的表具有以下列：

```
(name varchar(50),values varchar(50),description varchar(50)). 
```

用户希望为每个名称选择多个名称和一系列值，例如：

```
select * 
from table 
where (name = X and value >=1 and value <= 5 ) 
    AND (name = Y and value >=10 and value <= 25 )
    AND etc for up to 20 factors. 
```

我不能使用 sp_execute sql 来编写动态 sql，因为名称参数的数量会有所不同。我想避免使用 exec 来防止 sql 注入攻击。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:08:46.877

我在这里做了4个假设：

1.  您有 SQL-Server 2008 或更高版本（标记仅为 sql-server）
2.  您的标准将始终采用格式`name = Y and value >=10 and value <= 25`
3.  您的 values 列实际上是一个 int 列（基于您的 where 子句）
4.  您的单独标准应该由 OR 分隔并且（因为在您的示例中，您拥有`WHERE (Name = 'x' ..) AND (Name = 'y'...)` 的永远不会评估为真）

假设上述情况属实，那么您可以使用表值参数。第一步是创建您的参数：

```
CREATE TYPE dbo.TableFilter AS TABLE 
(   Name        VARCHAR(50), 
    LowerValue  INT, 
    UpperValue  INT
); 
```

然后您可以创建一个程序来获取您的过滤结果

```
CREATE PROCEDURE dbo.CustomTableFilter @Filter dbo.TableFilter READONLY
AS
    SELECT  T.*
    FROM    T
    WHERE   EXISTS
            (   SELECT  1
                FROM    @Filter f
                WHERE   T.Name = f.Name
                AND     T.Value >= f.LowerValue 
                AND     T.Value <= f.UpperValue
            ) 
```

然后，您可以使用以下方式调用您的程序：

```
DECLARE @Filter dbo.TableFilter;
INSERT @Filter VALUES ('X', 1, 5), ('Y', 10, 25);

EXECUTE dbo.CustomTableFilter @Filter; 
```

**[SQL Fiddle 示例](http://sqlfiddle.com/#!3/6a4d0/3)**

# ember.js - 如何从 Ember.js 中的另一个控制器获取控制器的模型

> ID：14838377
> 
> 赞同：2
> 
> 时间：2013-02-12T17:35:44.517
> 
> 标签：ember.js

在控制器中，我目前正在这样做：

```
controller.transitionTo( 'listing', App.Listings.find(1) ); 
```

这工作得很好。我想知道的是，是否有一种方法可以从控制器内访问另一个控制器的模型，这样我就不需要引用“App.”，因为这似乎不是 Ember 推荐的最佳实践。我知道有一个 modelFor() 但它似乎只在路线中工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:47:30.603

模型设置为控制器的内容，因此在您的控制器中模型就是内容。（除非您在路线中覆盖您的 controllerFor() 方法）。

然后在您的控制器中，您应该定义一个需求数组，其中列出了您希望此控制器有权访问的控制器实例（而不是类）的名称。

因此，要让 CommentsController 能够访问 PostController，您可以在 CommentsController 定义中以这种方式定义它：

```
needs: ['post'] 
```

然后这可以通过 controllers.post 在这个控制器中使用（你不需要使用 model ）如果你的控制器是 ObjectController 或 ArrayController 的一个实例那么你甚至不需要担心去内容，控制器将代理到适合您的内容/模型。

请注意，评论与发布关系是由路由器确定的（特别是您的资源和路由是如何定义的）。

此外，阅读需求的一个很好的起点（在源代码之外）：[http ://darthdeus.github.com/blog/2013/01/27/controllers-needs-explained/](http://darthdeus.github.com/blog/2013/01/27/controllers-needs-explained/)

# c# - Protobuf .NET 后反序列化处理程序

> ID：14838379
> 
> 赞同：7
> 
> 时间：2013-02-12T17:35:50.340
> 
> 标签：c#, protobuf-net

有没有办法处理事件或回调到刚刚被 Protobuf 反序列化的对象，而不必显式地从反序列化的对象调用方法？

例如，假设我有以下课程：

```
[ProtoContract]
public class Customer
{
    [ProtoMember(1)]
    public string FirstName { get; set; }

    [ProtoMember(2)]
    public string MiddleName { get; set; }

    [ProtoMember(3)]
    public string LastName { get; set; }

    [ProtoMember(4)]
    public Dictionary<int, string> Addresses { get; set; }

    public Customer()
    {
        //Subscibe to a Protobuf deserialization complete event?
    }

    public void ValidateAddresses()
    {
        //Some routine to validate addresses
    }
} 
```

是否有一种方法可以调用“ValidateAddresses”，而不必从反序列化的代码块中的反序列化对象中显式调用它？在构造函数中调用它是没有价值的，因为 Protobuf 还没有应用序列化的值，所以如果有办法知道它何时完成应用这些值会很好。我希望有一种方法可以实现这一点，以消除在使用对象的任何地方重构后反序列化调用的需要。

我有一些想法，但我想我会在开始验证它们之前发布问题，以防有人有更好的我还没有看到的问题（这很可能）。提前致谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-12T18:37:23.960

是的。Protobuf-net 支持标准的序列化回调。通过 WCF / DataContractSerializer 属性或 protobuf-net 特定的属性。具体来说，您可以使用`[OnDeserializedAttribute]`or标记一个方法`[ProtoAfterDeserialization]`，它将在反序列化结束时调用。方法可以在序列化之前、序列化之后、反序列化之前和反序列化之后调用。

WCF 需要这些方法的特定签名，但 protobuf-net 不那么挑剔：它可以使用 WCF 签名，但也允许无参数方法，或任何常用参数的组合，或 protobuf-net 自己的序列化上下文。

# javascript - 由于大型扩展的 javascript 对象，Firefox Web 控制台挂起

> ID：14838386
> 
> 赞同：1
> 
> 时间：2013-02-12T17:36:33.867
> 
> 标签：javascript, firefox, web, console

我在 OS X 上运行最新的 Firefox (18.0.2)，现在有一段时间，每当我将 Web 控制台与各种 Web 应用程序交互使用时，只要我键入返回大对象的命令，它就会挂起。原因是控制台打印出该对象的每一行。我想知道是否有人知道如何禁用此行为并让它只打印“对象”或其他内容。

小例子（为了更好地说明事情）：

1.  我在命令行输入：

    > var test = someBigBadassFunctionThatReturnsAHugeObject()

2.  控制台（顶部）打印：

    `timestamp1 | < var test = someBigBadassFunctionThatReturnsAHugeObject()`

3.  控制台挂起 30 秒

4.  控制台最终打印：

    `timestamp2 | < { ... } // Big object which takes 1000 lines to print`

我希望控制台改为打印类似的内容（如在 Chrome 中以及以前的方式）：

```
timestamp2 | > Object 
```

即“>”，而不是“<”。折叠（或其他名称）而不是展开。

谢谢！

# ios - iOS 中的 Django 管理过滤器小部件

> ID：14838387
> 
> 赞同：0
> 
> 时间：2013-02-12T17:36:37.700
> 
> 标签：ios, django, django-forms, django-admin

我在自己的表单页面上使用 django 管理员的过滤器小部件。但是，我注意到 iOS 劫持了这个小部件，将其替换为自己的原生小部件。

有没有办法阻止这种覆盖？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T05:33:08.597

这是一个已开放两年多的已知错误：

[https://code.djangoproject.com/ticket/14716](https://code.djangoproject.com/ticket/14716)

我认为在修复错误之前，您应该删除所有设备的小部件或仅删除 iOS 设备。我假设你更喜欢后者。我想到了一种方法来做到这一点，但它非常hacky。我的想法是猴子补丁`django.contrib.admin.widgets.FilteredSelectMultiple`。您将更改其`render`方法生成的 JavaScript，以便 JavaScript 不会立即调用该`addEvent`函数，而是*仅*当用户代理不包含“iPad”、“iPhone”或“iPod”时才调用它。您可能还需要覆盖`updateSelectFilter`这些文件中定义的函数：

1.  django/contrib/admin/templates/admin/edit_inline/stacked.html
2.  django/contrib/admin/templates/admin/edit_inline/tabular.html

正如我所说，这个解决方案非常hacky，但我不确定这个问题的任何解决方法*都不*是hacky。

# r - 将截距列添加到数据集

> ID：14838390
> 
> 赞同：1
> 
> 时间：2013-02-12T15:01:16.673
> 
> 标签：r

我是 R 的新手。我想添加一列，将其解释为当前数据帧的截距列。任何有用的评论将不胜感激。

谢谢！伊萨克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T19:21:07.703

由于回收，您只需要在数据框中`d$one <- 1`创建一列具有名称的列。但是@AntoineVernet 是完全正确的，即使您有一个复杂的混合模型，这几乎肯定是不必要的。`one``d`

试试这些模型（当然比你的更简单）并检查输出以了解我的意思。

```
set.seed(5)
d <- data.frame(x = rep(1:3, 5), 
                y = round(rnorm(15, mean=10), 1), 
                g = factor(rep(1:5, each=3)) )
d$one <- 1

library(lme4)
lmer(y ~ x + (1|g), data=d)
lmer(y ~ (1|g), data=d)
lmer(y ~ 1 + (1|g), data=d)
lmer(y ~ 0 + one + (1|g), data=d) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:24:17.250

这应该有效：

incpt <- 代表（1，nrows（df））

df <- as.data.frame(cbind(incpt,df))

# html - 全选复选框/Twitter Bootstrap Rails

> ID：14838393
> 
> 赞同：2
> 
> 时间：2013-02-12T17:36:56.643
> 
> 标签：html, checkbox, html-table, twitter-bootstrap-rails, selectall

我想知道如何在我的表格中创建一个“全选”复选框。唯一的问题是我没有使用复选框的输入标签，我使用的是 f.check_box。这是我的身体：

```
<td>
  <label class="checkbox">
    <%= f.check_box :members, :name => 'point[members]['+member.id+']' %>
  </label>
</td> 
```

# jquery - 为什么这个 JQuery 弹出窗口再次出现？

> ID：14838395
> 
> 赞同：0
> 
> 时间：2013-02-12T17:37:09.813
> 
> 标签：jquery, each

我有一个 JQuery 弹出功能，当用户单击链接时会显示一些文本。他们单击“关闭”以关闭弹出窗口。很直接。

问题是弹出窗口在关闭后立即重新出现。

这是问题所在：

```
JAVACRIPT
$.fn.myPopup = function(popupText)
{
    var popupHtml = '<div class="messagepop pop">' + popupText + '<p align="right"><a class="close" href="#">Close</a></div>';
    this.each(function()
    {
        $(this).click(function(){
            $(this).addClass("selected").parent().append(popupHtml);
            $(".pop").slideFadeToggle()
       });
        return false;
    });

    $(".close").on('click', function() 
    {
        alert('in close function - about to do slideFadeToggle on: ' + popupText);
        $(".pop").slideFadeToggle();
        alert('just did slideFadeToggle, about to removeClass on: ' + popupText);        
        $(this).removeClass("selected");
        alert('just did removeClass on: ' + popupText);
    });

    return this;
};
$("#word1234").myPopup("Lorem Ipsum");
$("#wordABCD").myPopup("Hello World");

HTML
<a href="#" id="word1234">Supercalifragilisticexpialidocious</a> <br>
<a href="#" id="wordABCD">Foo</a> <br> 
```

这是一个小提琴，所以你可以看到它的实际效果：http: [//jsfiddle.net/N4QCZ/3/](http://jsfiddle.net/N4QCZ/3/)

为什么弹出窗口成功关闭后又出现了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:02:55.707

正如`@runspired`他的回答中提到的：http: [//jsfiddle.net/N4QCZ/5/](http://jsfiddle.net/N4QCZ/5/)

```
$(document).on('click', ".close", function(e) { //<-----event delegation needed here
    e.stopImmediatePropagation(); //<-----you need this
    $(".pop").slideFadeToggle();
    $(this).removeClass("selected");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:54:31.593

问题是您没有在关闭单击时停止事件传播，并且由于关闭位于触发弹出窗口的元素内，因此它会向下工作，从而触发弹出单击处理程序。在单击处理程序中调用[http://api.jquery.com/event.stopImmediatePropagation/以关闭。](http://api.jquery.com/event.stopImmediatePropagation/)

**编辑**

实际上你将它附加到父级，所以它不应该触发第二次点击，但我还是会调用停止传播。另一个问题可能是关闭处理程序和弹出处理程序中的这一行：`$(".pop").slideFadeToggle();`

这将导致您生成的所有弹出窗口都滑动切换，这意味着一旦您创建了多个（您所做的），那么在每次调用时，隐藏的将显示，而显示的将隐藏。另外，slideFadeToggle 是自定义插件吗？确定你不是说 slideToggle() 吗？

**第二次编辑**

close 内的这条线也有问题：`$(this).removeClass("selected");`

阅读 this 和 jQuery this，因为在回调中 this 指的是被点击的元素（.close），而不是你之前添加类“selected”的元素。

# c# - TransactionScope 和手动回滚事务之间的区别？

> ID：14838400
> 
> 赞同：2
> 
> 时间：2013-02-12T17:37:17.257
> 
> 标签：c#, sql-server, sql-server-2008

我正在研究一个以前由其他人开发的项目。在程序中，它执行如下操作：

```
 reportConnection = new SqlConnection(sConnStr);
 reportConnection.Open();
 try
 {
     using (SqlTransaction trans = reportConnection.BeginTransaction(IsolationLevel.ReadUncommitted))                    

     {
        ......
        using (SqlCommand cmd = new SqlCommand(sSQL, reportConnection, trans))
        {
            ....
        }
        trans.Commit();
     }
}
catch (Exception ex)
{
    Logger ....
}
fianlly
{
    if (reportConnection != null)
    {
        ((IDisposable)reportConnection).Dispose();
    }

} 
```

我可以看到的问题是，如果 using 块中有错误，它不会回滚事务。所以，这是**第一个问题**：如果有错误，trans 不会被提交（也不会回滚），但连接会被释放（trans 不会被释放）。在这种情况下，它会产生什么副作用？它会创建一个开放的孤立连接/事务吗？这样，会不会造成死锁？

我做了一些搜索，似乎首选的方法是使用事务范围（**下面的代码来自微软**）：

```
try
{
    // Create the TransactionScope to execute the commands, guaranteeing 
    // that both commands can commit or roll back as a single unit of work. 
    using (TransactionScope scope = new TransactionScope())
    {
        using (SqlConnection connection1 = new SqlConnection(connectString1))
        {
            // Opening the connection automatically enlists it in the  
            // TransactionScope as a lightweight transaction.
            connection1.Open();

            // Create the SqlCommand object and execute the first command.
            SqlCommand command1 = new SqlCommand(commandText1, connection1);
            returnValue = command1.ExecuteNonQuery();
            writer.WriteLine("Rows to be affected by command1: {0}", returnValue);

            // If you get here, this means that command1 succeeded. By nesting 
            // the using block for connection2 inside that of connection1, you 
            // conserve server and network resources as connection2 is opened 
            // only when there is a chance that the transaction can commit.    
            using (SqlConnection connection2 = new SqlConnection(connectString2))
            {
                // The transaction is escalated to a full distributed 
                // transaction when connection2 is opened.
                connection2.Open();

                // Execute the second command in the second database.
                returnValue = 0;
                SqlCommand command2 = new SqlCommand(commandText2, connection2);
                returnValue = command2.ExecuteNonQuery();
                writer.WriteLine("Rows to be affected by command2: {0}", returnValue);
            }
        }

        // The Complete method commits the transaction. If an exception has been thrown, 
        // Complete is not  called and the transaction is rolled back.
        scope.Complete();

    }

}
catch (TransactionAbortedException ex)
{
    writer.WriteLine("TransactionAbortedException Message: {0}", ex.Message);
}
catch (ApplicationException ex)
{
    writer.WriteLine("ApplicationException Message: {0}", ex.Message);
} 
```

**我的第二个问题**是：如果我像下面这样手动操作会怎样。使用事务范围有什么好处？它们在字面上是一样的吗？

```
reportConnection = new SqlConnection(sConnStr);
reportConnection.Open();
try
 {
     using (SqlTransaction trans = reportConnection.BeginTransaction(IsolationLevel.ReadUncommitted))                    

     {
        try
        {
            ......
            using (SqlCommand cmd = new SqlCommand(sSQL, reportConnection, trans))
            {
                ....
            }
            trans.Commit();
        }
        catch
        {
            try
            {
                // incase rollback has error
                trans.Rollback();
            }
            catch
            {
            }
        }
     }
}
catch (Exception ex)
{
    Logger ....
}
fianlly
{
    if (reportConnection != null)
    {
        ((IDisposable)reportConnection).Dispose();
    }

} 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:03:30.393

这在`SqlTransaction`文档中有所介绍：

> Dispose 应该回滚事务。但是，Dispose 的行为是特定于提供程序的，不应替代调用 Rollback。

取自：http: [//msdn.microsoft.com/en-us/library/bf2cw321.aspx](http://msdn.microsoft.com/en-us/library/bf2cw321.aspx)

我想这一切都取决于你对试图强制破坏的实现在你认为它们可能无法正常工作时的偏执程度。第一个代码示例绝对是最简单的，只有在您的提供程序无法正常工作时才会失败。

编辑复杂性示例 - 您的最后一个片段是否应该是：

```
try { /*...*/ 
    using (SqlCommand cmd = new SqlCommand(sSQL, reportConnection, trans)) {
        /*...*/ }
    trans.Commit();
} catch { try { trans.Rollback(); } catch {} throw; } 
```

或者

```
try { /*...*/ 
    using (SqlCommand cmd = new SqlCommand(sSQL, reportConnection, trans)) {
        /*...*/ }
} catch { try { trans.Rollback(); } catch {} throw; }
trans.Commit(); 
```

?

# ruby-on-rails-3 - Rails 3.2.12/HTML 5 离线清单

> ID：14838401
> 
> 赞同：2
> 
> 时间：2013-02-12T17:37:18.193
> 
> 标签：ruby-on-rails-3

我哪里错了？我应该错过一些重要的技巧......在编译资产并在开发模式下运行我的应用程序后，转到根 url

..**.我只是得到一个白页....是因为我在本地主机上以开发模式运行吗？

控制台：

```
>> Listening on 0.0.0.0:3000, CTRL+C to stop
  Started GET "/" for 127.0.0.1 at 2013-02-12 19:09:46 +0100
  Processing by WelcomeController#index as HTML
  .....  more ...
  Rendered welcome/index.html.haml within layouts/application (438.3ms)
  Completed 200 OK in 3700ms (Views: 539.7ms | ActiveRecord: 101.8ms)
  Started GET "/fr/application.manifest" for 127.0.0.1 at 2013-02-12 19:09:51 +0100
  CACHE MANIFEST
  # b674b99ed2e29478bf9b8887fd1448dcd5755e2b2f8882a9abf2030d70ae5ae5
  404.html
  422.html
  500.html
  offline.html
  assets/application-cb5548d93b80852ceb169309f728eb75.js 
  .... more assets .... 
```

在我的 application.html.haml

```
 %html{:lang => "en", :manifest => manifest_path } 
```

在我的 routes.rb

```
 Rack::Offline.configure do
    cache "assets/application.js"
    cache "assets/application.css"   
    network "/"
  end
  match "/application.manifest" => Rails::Offline, :as => :manifest 
```

在我的 mimes_types.rb

```
Mime::Type.register "text/cache-manifest", :manifest 
```

# javascript - currentTime 未按预期工作。我在这里没有得到任何东西

> ID：14838405
> 
> 赞同：-1
> 
> 时间：2013-02-12T17:37:46.357
> 
> 标签：javascript, video

我不明白为什么会这样：

```
myVid1=document.getElementById("video1");
var trigger = 5;
var timecheck = myVid1.currentTime;

if(timecheck==trigger){
alert("AWESOME");
}; 
```

不工作。肯定会在 5 秒时触发 if 语句？我的意思是，我不明白为什么它也不能这样工作：

```
if(myVid1.currentTime=="5"){
    alert("AWESOME");
    }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:46:29.137

我看到该代码至少有两个问题：

1.  您似乎只执行了`if`一次语句，因此如果在该一次检查期间媒体恰好不在您想要的时间，那么条件自然会是错误的。[`MediaController`](http://www.w3.org/TR/html5/embedded-content-0.html#mediacontroller)几乎可以肯定，您可能想要响应视频相关联的事件之一[`timeupdate`](http://www.w3.org/TR/html5/embedded-content-0.html#handler-mediacontroller-ontimeupdate)。

2.  您正在寻找的值**正好是** `5`. 但是你碰巧**准确**地捕捉到 value的几率并不高`5`。请记住，这[`currentTime`](http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-currenttime)是一个浮点数。建议寻找`myVid1.currentTime > 5`五秒后的任何时间，或者`myVid1.currentTime >= 5 && myVid1.currentTime < 6`如果您只想要五秒内的时间。

所以像：

```
myVid1=document.getElementById("video1");
var trigger = 5;
myVid1.controller.addEventListener('timeupdate', function() {
    if (myVid1.currentTime >= trigger) {
        // Do something, note that this will happen again and again unless
        // you set a flag or remove the handler
    }
}); 
```

# javascript - 图像滑块代码，任何人都可以详细说明

> ID：14838407
> 
> 赞同：0
> 
> 时间：2013-02-12T17:37:55.830
> 
> 标签：javascript

嗨，我是 javascript 新手，我想要一个图像滑块，所以遇到了下面提到的代码。谁能给我解释一下，尤其是**中的代码。我真的很感激，谢谢。

```
var blocks = $(".blocks li");
var image = $(".imageholder li");
var imgholder = $(".imageholder");
var imagew = $(".imageholder li").width();
var speed = 300;

blocks.removeClass('selected').first().addClass('selected');

**blocks.click(function() {
var target = $(this).index();**

**imgholder.animate({"left": "-"+imagew*target+"px"}, speed);**

blocks.removeClass('selected');
$(this).addClass('selected'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:45:12.880

`blocks.click`表示当您单击类为 的元素中的元素 li 时`blocks`，执行参数中的函数。

```
var target = $(this).index(); 
```

表示获取元素的编号，单击第二个元素将分配 2 给目标。

```
imgholder.animate({"left": "-"+imagew*target+"px"}, speed) 
```

将以极快的速度将 img 向左移动到位置 -Ypx，其中 Y`imagewidth`等于`target`

# php - 使用 Ajax 单击导航时更改内容

> ID：14838412
> 
> 赞同：-1
> 
> 时间：2013-02-12T17:38:08.857
> 
> 标签：php, ajax, get

我想更改列表的内容取决于用户在我的导航中“点击”的内容。我是 Ajax 的新手，不太了解它。

我不希望网站“重新加载”，所以只有 PHP 不是这里的灵魂。

因此，如果有人可以对我好，并说出这是如何工作并尝试解决这个问题的，我会像一条鱼一样快乐！

这就是它现在的样子，我已经编辑了图片让你掌握它。

![在此处输入图像描述](../Images/b30b9bb376e2d9d2f061ea36dbd1ff76.png)

亲切的问候/一个有问题的人..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:47:10.070

假设我们想为此使用 JQuery ( [http://api.jquery.com/](http://api.jquery.com/) ) ajax 处理程序。

您需要做的是创建一个 php 页面，该页面将返回新列表，您可以通过使用过滤器来处理此问题以显示正确的信息。然后你想将该列表推送到容器中。

所以使用jquery，首先将点击事件绑定到链接然后运行类似这样的东西

```
$.get("[url]?filter=some filter", function(data){
     $([the div box id]).html(data ) 
}); 
```

其他选项包括将过滤后的列表返回为 json，但为简单起见，我们只保留返回 html。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:49:43.937

默认情况下，您似乎已经将所有类别加载到列表中，对吗？如果是这样，就没有必要（而且这是不好的做法）使用 AJAX 来检索您已经交付的内容。这是您想要做的。

在您的 PHP 中，您将希望为这些项目附加一个唯一的类（最好使用类别名称的一些变体）。如果每个项目有多个类别，请为其所属的每个类别附加一个唯一的类。

在客户端，使用 jQuery 仅显示所需的项目。

`jQuery( itemSelector ).not( desiredClass ).hide(); jQuery( desiredClass ).show();`

以上将隐藏所有不在所需类中的提要项目，以防万一您想要显示的一些项目被隐藏，我们也将在所需类上调用 show。

您可以在左侧按钮上的 onClick 中实现这一点。

# game-engine - 将 Ren'Py 集成到 GameMaker(by YoYogames)

> ID：14838415
> 
> 赞同：1
> 
> 时间：2013-02-12T17:38:19.543
> 
> 标签：game-engine, game-maker

正如标题已经提到的，我想知道如何将 Ren'Py 引擎集成到 YoYogames 的 GameMaker 中。我参加了一场比赛，你必须在 GameMaker 程序中制作自己的游戏，但我想使用 Ren'Py 的数字故事讲述。有人知道怎么做吗？

提前致谢！

沃特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T10:34:36.447

将 Ren'Py 包装在一个 dll 中（使用 C 函数供游戏制作者调用）。尽管还记得 GM 的扩展功能有限（基本上要么接管游戏的完整绘图，要么将绘图留给 GM 并使用您的 dll 仅传递字符串/数字）。

虽然一旦你开始这样做，问题就变成了“为什么要使用 gm”——以及“你真的可以称之为由 gamemaker 制作的游戏吗”。

# salesforce - 在“开发人员控制台”中的“VF 页面控制器”VS 中，相同的 SOQL 查询需要很长时间

> ID：14838416
> 
> 赞同：2
> 
> 时间：2013-02-12T17:38:24.520
> 
> 标签：salesforce, visualforce, soql

查询简单，在 VF 页面控制器中耗时 1 分钟，在 Developer Console 中执行时不到 1 秒。查询正在搜索超过 50,000 条记录。为什么查询运行时间有如此巨大的差异？

```
String s = '123456';
List<Registration__c> regs = 
    [select id, name 
     from Registration__c 
     where name =: s or speical_number__c =: s limit 1]; 
```

以下是调试日志的摘录：

*开发者控制台：*

**12:22:39.063** (63557000)|SOQL_EXECUTE_BEGIN|[2]|Aggregations:0|select id, name from Registration__c where (name = :tmpVar1 or speical_number__c = :tmpVar2) limit 1

**12:22:39.263** (263582000)|SOQL_EXECUTE_END|[2]|行数：0

*VF 页面控制器：*

**12:17:08.148** (3148592000)|SOQL_EXECUTE_BEGIN|[633]|Aggregations:0|select id, name from Registration__c where (name = :tmpVar1 or speical_number__c = :tmpVar2) limit 1

**12:18:07.350** (62350264000)|SOQL_EXECUTE_END|[633]|行数：0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T00:54:51.250

我怀疑这与 VF/Apex 批量回复的方式有关。虽然，限制 1 似乎表明情况并非如此。但是，只是为了好玩......试试这个......

```
String s = '123456';
List<Registration__c> regs = new List<Registration__c>();
for ( Registration__c reg : 
    [select id, name 
     from Registration__c 
     where name =: s or speical_number__c =: s 
     limit 1
    ] ) {
   regs.add(reg);
} 
```

speical_number__c 是 external id 的好候选人吗？我问是因为将该字段设置为外部 id 将保证 Salesforce.com 将为您的字段创建索引。如果没有索引，查询将执行全表扫描。

# mysql - 如何使用 VB 2005 在 64 位上运行 32 位应用程序？

> ID：14838417
> 
> 赞同：0
> 
> 时间：2013-02-12T17:38:24.977
> 
> 标签：mysql, windows, vb.net, 32bit-64bit

我有一个基于 VB 2005 Express 版本的旧应用程序。现在我在 2-3 年后在我的 Windows 7 机器上再次安装了 VB 2005。但是当我运行该应用程序时，它会在我的 64 位机器上冻结，并且在 32 位机器上仍然可以正常工作。有没有办法解决这个问题，以便我可以运行/调试使用 32 位 VB 2005 Express 创建的旧应用程序？

编辑：我正在使用 MySQL 5.1( MySql.Data.MySqlClient ) 组件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:05:11.170

如果您还没有尝试过，将项目的目标 CPU 设置为“x86”而不是“AnyCPU”可能会有所帮助。

这会强制应用程序在所有平台上作为 32 位应用程序运行，而不是在 64 位操作系统上作为 64 位应用程序运行。

# graph - 计算标记图中的轨道

> ID：14838418
> 
> 赞同：2
> 
> 时间：2013-02-12T17:38:25.940
> 
> 标签：graph, graph-theory

给定一个标记图**G = (V, E, L)**，**L**是将顶点映射到标签的函数。我想找到子集**S ⊆ V**使得**S**中所有自同构中的顶点映射（应该满足边缘和标签约束）位于同一个集合**S**中。我不确定这些约束是否足以将**S称为图****G**的轨道。

是否有任何常用的算法来计算这些子集？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T05:57:49.233

看起来图同构问题的 nauty 算法也可用于计算顶点彩色图（或标记图）中的轨道。

[Nauty](http://www.cs.sunysb.edu/~algorith/implement/nauty/implement.shtml)
[官方网站](http://cs.anu.edu.au/people/bdm/nauty/)

# sql - SQL - 比较查询中的多行

> ID：14838420
> 
> 赞同：2
> 
> 时间：2013-02-12T17:38:29.833
> 
> 标签：sql, sql-server, sql-server-2008-r2

我有一个零售软件的定价表，其中包含一个项目的 UPC、一个属性代码（即“REGULAR_PRICE、PROMO_PRICE”）和一个价格。

示例表：

```
400000320243 REGULAR_PRICE 80
400000320243 PROMO_PRICE 80
400000320250 REGULAR_PRICE 50
400000320250 PROMO_PRICE 40 
```

我正在尝试编写一个查询来查找任何 UPC 的 PROMO_PRICE = REGULAR_PRICE 的位置，并输出符合此条件的 UPC 列表。

我不知道如何在 SQL 中编写它。我正在使用 SQL Server 2008 R2。

尝试的伪代码：

```
for each upc:
  if upc.regular_price = upc.promo_price:
      print upc 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T17:43:25.190

你可以用很多方法做到这一点。一种方法是创建两组，一组带有 upcs 和正常价格，另一组带有 upcs 和促销价格，然后加入这两组，如下所示：

```
select r.upc, r.price from
   (select upc, price from t where propertyCode = 'regular_price') r inner join
   (select upc, price from t where propertyCode = 'promo_price') p on
   r.upc = p.upc and
   r.price = p.price 
```

你可以在[sqlfiddle](http://www.sqlfiddle.com/#!3/cc32f/2)上试试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T09:37:47.940

[INTERSECT](http://msdn.microsoft.com/en-us/library/ms188055.aspx "EXCEPT 和 INTERSECT (Transact-SQL)")查询也可以在这里工作：

```
SELECT upc, price
FROM atable
WHERE property_code = 'REGULAR_PRICE'
INTERSECT
SELECT upc, price
FROM atable
WHERE property_code = 'PROMO_PRICE'
; 
```

[SQL Fiddle 演示](http://www.sqlfiddle.com/#!3/cc32f/5)（使用@Beth 的模式）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T17:43:52.320

假设您的表已命名`Pricing`并且您有名为`upc`、`propertycode`和的列`price`，您可以对此数据执行自联接。它看起来像：

```
SELECT Reg.upc
FROM Pricing Reg JOIN Pricing Promo ON Reg.upc = Promo.upc
WHERE Reg.propertycode = 'REGULAR_PRICE' 
    AND Promo.propertycode = 'PROMO_PRICE'
    AND Reg.price = Promo.price 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T17:48:24.707

另外...根据您的示例判断-对我来说看起来像一张表-如果您的SQL版本中可用，您可以使用 LAG() / LEAD() 分析函数来比较数据-上一行或下一行与当前行值.. .

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T19:32:08.383

带有[EXISTS 子查询的选项](http://msdn.microsoft.com/en-us/library/ms188336%28v=sql.105%29.aspx)

```
SELECT *
FROM dbo.test3 t1
WHERE EXISTS (
              SELECT 1
              FROM dbo.test3 t2
              WHERE t2.PriceName = CASE WHEN t1.PriceName = 'PROMO_PRICE' THEN 'REGULAR_PRICE'
                                        WHEN t1.PriceName = 'REGULAR_PRICE' THEN 'PROMO_PRICE' END
                AND t1.Price = t2.Price                                                    
              ) 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/616cc/1/0)上的演示[](http://sqlfiddle.com/#!3/616cc/1/0)

# c# - 设置 TCP/IP 客户端和服务器以通过网络进行通信

> ID：14838421
> 
> 赞同：7
> 
> 时间：2013-02-12T17:38:30.867
> 
> 标签：c#, .net, winforms, tcp, client-server

我正在尝试学习一些有关套接字编程的知识，并且偶然发现了 TcpListener 和 TcpClient 来使用，因为我读到它们对初学者来说稍微容易一些。我想要完成的基本要点是有一个可以在我的笔记本电脑和同一网络上的另一台笔记本电脑上运行的小型表单，并且它们能够进行通信，即相互发送一串文本。一旦我有了这个，我希望能进一步发展它:)

到目前为止，我已经使用 msdn 和互联网上的各种指南创建了一个客户端和一个服务器程序。当两者都在一台笔记本电脑上运行时，我可以让它们进行通信，但是当我将客户端移动到另一台笔记本电脑时，我无处可去。我认为我的主要问题是我不太了解客户端如何找到服务器 IP，因为我认为我可以对其进行硬编码，但是当我在另一个时间回来时，我确信 IP 会改变。有没有办法让两者以更动态的方式连接以包含不断变化的 IP？我当前的客户代码：

```
 public void msg(string mesg)
    {
        lstProgress.Items.Add(">> " + mesg);
    }

    private void btnConnect_Click(object sender, EventArgs e)
    {
        string message = "Test";
        try
        {
            // Create a TcpClient.
            // Note, for this client to work you need to have a TcpServer 
            // connected to the same address as specified by the server, port
            // combination.
            Int32 port = 1333;
            TcpClient client = new TcpClient(<not sure>, port); //Unsure of IP to use.

            // Translate the passed message into ASCII and store it as a Byte array.
            Byte[] data = System.Text.Encoding.ASCII.GetBytes(message);

            // Get a client stream for reading and writing.
            //  Stream stream = client.GetStream();

            NetworkStream stream = client.GetStream();

            // Send the message to the connected TcpServer. 
            stream.Write(data, 0, data.Length);

            lstProgress.Items.Add(String.Format("Sent: {0}", message));

            // Receive the TcpServer.response.

            // Buffer to store the response bytes.
            data = new Byte[256];

            // String to store the response ASCII representation.
            String responseData = String.Empty;

            // Read the first batch of the TcpServer response bytes.
            Int32 bytes = stream.Read(data, 0, data.Length);
            responseData = System.Text.Encoding.ASCII.GetString(data, 0, bytes);
            lstProgress.Items.Add(String.Format("Received: {0}", responseData));

            // Close everything.
            stream.Close();
            client.Close();
        }
        catch (ArgumentNullException an)
        {
            lstProgress.Items.Add(String.Format("ArgumentNullException: {0}", an));
        }
        catch (SocketException se)
        {
            lstProgress.Items.Add(String.Format("SocketException: {0}", se));
        }
    } 
```

我当前的服务器代码：

```
 private void Prog_Load(object sender, EventArgs e)
    {
        bw.WorkerSupportsCancellation = true;
        bw.WorkerReportsProgress = true;
        bw.DoWork += new DoWorkEventHandler(bw_DoWork);
        bw.ProgressChanged += new ProgressChangedEventHandler(bw_ProgressChanged);

        if (bw.IsBusy != true)
        {
            bw.RunWorkerAsync();
        }
    }

    private void bw_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        lstProgress.Items.Add(e.UserState);
    }

    private void bw_DoWork(object sender, DoWorkEventArgs e)
    {
        BackgroundWorker worker = sender as BackgroundWorker;

        if ((worker.CancellationPending == true))
        {
            e.Cancel = true;
        }
        else
        {
            try
            {
                // Set the TcpListener on port 1333.
                Int32 port = 1333;
                //IPAddress localAddr = IPAddress.Parse("127.0.0.1");
                TcpListener server = new TcpListener(IPAddress.Any, port);

                // Start listening for client requests.
                server.Start();

                // Buffer for reading data
                Byte[] bytes = new Byte[256];
                String data = null;

                // Enter the listening loop.
                while (true)
                {
                    bw.ReportProgress(0, "Waiting for a connection... ");
                    // Perform a blocking call to accept requests.
                    // You could also user server.AcceptSocket() here.
                    TcpClient client = server.AcceptTcpClient();
                    bw.ReportProgress(0, "Connected!");

                    data = null;

                    // Get a stream object for reading and writing
                    NetworkStream stream = client.GetStream();

                    int i;

                    // Loop to receive all the data sent by the client.
                    while ((i = stream.Read(bytes, 0, bytes.Length)) != 0)
                    {
                        // Translate data bytes to a ASCII string.
                        data = System.Text.Encoding.ASCII.GetString(bytes, 0, i);
                        bw.ReportProgress(0, String.Format("Received: {0}", data));

                        // Process the data sent by the client.
                        data = String.Format("I Have Received Your Message: {0}", data);

                        byte[] mssg = System.Text.Encoding.ASCII.GetBytes(data);

                        // Send back a response.
                        stream.Write(mssg, 0, mssg.Length);
                        bw.ReportProgress(0, String.Format("Sent: {0}", data));
                    }

                    // Shutdown and end connection
                    client.Close();
                }
            }
            catch (SocketException se)
            {
                bw.ReportProgress(0, String.Format("SocketException: {0}", se));
            }
        }
    } 
```

正如您可能会说的那样，我对此很陌生，所以如果有更好的方法来实现这一点，我将非常乐意学习！提前感谢您的帮助:)

我的解决方案感谢以下答案：

```
private String IPAddressCheck()
    {
        var IPAddr = Dns.GetHostEntry("HostName");
        IPAddress ipString = null;

        foreach (var IP in IPAddr.AddressList)
        {
            if(IPAddress.TryParse(IP.ToString(), out ipString) && IP.AddressFamily == AddressFamily.InterNetwork)
            {
                break;
            }
        }
        return ipString.ToString();
    }

    private void btnConnect_Click(object sender, EventArgs e)
    {
        string message = "Test";
        try
        {
            Int32 port = 1337;  
            string IPAddr = IPAddressCheck();
            TcpClient client = new TcpClient(IPAddr, port); 
```

我不确定它是否是最简洁的解决方案，但它运作良好，所以谢谢你的回答:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:57:09.880

不太确定您所说的“以更动态的方式包含不断变化的 IP”是什么意思。对您目前拥有的初学者进行猜测：

```
TcpClient client = new TcpClient(<not sure>, port); //Unsure of IP to use. 
```

您可以在同一台机器上同时运行客户端和服务器，并使用本地环回 IP 地址：

```
IPAddress.Parse("127.0.0.1") 
```

如果它们在不同的机器上运行，只需将 127.0.0.1 替换为服务器使用的任何 IP 地址（这假设没有 NAT 或防火墙阻碍）。

如果您不想使用 IP 地址，则可以始终使用主机名（这些可能被认为更“动态”），但这需要适当配置的 DNS 设置（对于本地系统）：

```
TcpClient client = new TcpClient("testMachine1", 1333); 
```

学习套接字编程很棒。我是网络库 networkcomms.net 的开发人员，所以如果您还想在学习自己的同时从工作示例向后工作，请查看这个[wpf 聊天示例](http://www.networkcomms.net/creating-a-wpf-chat-client-server-application/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:01:17.457

如果您知道要连接的计算机的名称，那么您可以使用 System.Net.DNS 轻松找到其 IP。

```
var ip = System.Net.Dns.GetHostEntry("JacksLaptop"); 
string ipString = ip.AddressList[0].ToString(); 
```

您认为您正在使用的 IP 可能不是该阵列位置 0 中的 IP，因此请注意这一点。

# xml - 使动态创建的文本字段可在 xml 中搜索

> ID：14838428
> 
> 赞同：0
> 
> 时间：2013-02-12T17:39:09.120
> 
> 标签：xml, actionscript-3, flash, dynamic, textfield

我最近在同一个项目上发布了一个问题，walkietokyo 很有帮助地回答了这个问题。[上一个问题](https://stackoverflow.com/questions/14761667/dynamically-creating-multiple-textboxes-that-are-populated-with-xml-data)

所以我的新问题是使用该解决方案使文本精灵可搜索。因此，在这种情况下，您可以单击创建的任何动态文本字段，as3 会将特定文本字段的内容与 xml 中的数据相匹配，这样做后，它将从节点容器中获取另一个节点对于 xml 的每个部分（例如

```
<Searchtext Wordlookup="chris cheeser">
<location>1</location>
<Name>chris cheeser</Name>
</Searchtext> 
```

所以它会注意到我单击的文本字段充满了 chris cheeseer，然后它将与我的 Wordlookup 匹配，并识别位置，并将其与我的同名电影剪辑匹配）

我当前的 as3 如下所示：

```
private function XMLLoader(e:Event):void
    {
        xmlData = new XML(e.target.data);
        ParseList(xmlData);

    }

    private function ParseList(nameData:XML):void
    {
     var nameList:XMLList = nameData.Searchtext.Name;
//       var textContainer:Sprite = new Sprite();
     this.addChild(textContainer);

     for each (var nameElement:XML in nameList){
//       var format:TextFormat = new TextFormat();
     format.font = "Arial MT";
     format.size = 22;
     format.color = 0x006699;
     var currTextField:TextField = new TextField();
     currTextField.defaultTextFormat = format;
     currTextField.appendText(nameElement.text() + "\n");
     currTextField.y= 1297 + textContainer.height;
     currTextField.height = 40;
     currTextField.width = 280;
     currTextField.x= 88;
     currTextField.selectable = false;
     textContainer.addChild(currTextField);
     trace(nameElement.text());

       }

    }

    private function onTextClick(e:Event):void 
    {
    var currTextField:TextField = e.target as TextField;

    if (SearchHolder != null){
         TweenMax.to((this["$" + SearchHolder]), 1, {removeTint:true});
        }   
          var resultZ:String = xmlData.Searchtext.(@Wordlookup == currTextField.text.toLowerCase).location.toString()
     SearchHolder = resultZ ? resultZ : "Try again";
        trace(resultZ);
     TweenMax.to(["$" + SearchHolder], 1, {tint:0x00ffcc});
    trace("This name was clicked:", currTextField.text);

    } 
```

所有被注释掉的东西都放在函数之外，resultZ 和 SearchHolder 都被公开标识为字符串，但是我一直对定义 var resultZ 的行有问题（我通过几个小时的摆弄试图弄清楚这一点) 现在我对 resultZ 的跟踪没有产生任何结果，这告诉我它与 currTextfield 有关，因为我有一个相同的函数设置了一个仍然有效的输入字段。任何帮助将不胜感激，但尽量描述，我还在学习！谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T22:48:38.960

您似乎错过了该`toLowerCase()`方法的括号。

尝试这个：

```
var resultZ:String = xml.Searchtext.(@Wordlookup == currTextField.text.toLowerCase())[0].location[0].toString(); 
```

或者，您可以使用 E4X 以类似的方式根据*子节点的内容*过滤掉节点，而不是将名称复制为节点和属性，如下所示：

```
var resultZ:String = xml.Searchtext.(Name == currTextField.text)[0].location[0].toString(); 
```

在后一种情况下，您可以`Wordlookup`从 xml 文档中省略该属性。（当然，除非它被用于其他目的。）

* * *

另请注意，我`[0]`在搜索和位置参数之后添加。这是因为在 E4X 中，每个“向下钻取”都会产生一个`XMLList`，它是一个节点数组。通过指定像`[0]`您这样的访问器，可以确保仅选择第一个结果，以防有多个节点匹配相同的条件。这可能不是预期的结果，但请务必牢记，因为忽略它会产生令人惊讶的结果。

例如，假设您的 xml 文档中有两个人都称为“chris cheeseer”，它们与位置 1 和 5 相关联。没有指定您只想选择其中一个，上面的代码相同（但省略了`[0]`访问器）将产生结果“15”。

但是，使用`[0]`访问器将始终选择与描述匹配的第一个节点，因此如果您可能有非唯一名称，您可能必须考虑以某种方式使用真正唯一的标识符。

# java - 使用 javascript 重定向到新的 URL

> ID：14838434
> 
> 赞同：2
> 
> 时间：2013-02-12T17:39:34.070
> 
> 标签：java, javascript, jsp, redirect, struts

我正在尝试根据用户从下拉列表中选择的内容将我的页面重定向到不同的 url。如果用户选择“A”，则 url 是表单 action 属性中的默认 URL，但如果用户选择“B”，我想将其重定向到不同的 url。

我的问题是无论我做什么，它总是重定向到默认 URL（即 oldUrl.do），即使我从下拉列表中选择“B”。

我该怎么做才能将它指向 newUrl.do？

注意：我正在使用 Struts 1.2 并在 IE8 上对其进行测试。

**我的jsp页面：**

```
<form name="myForm" method="post" action="oldUrl.do" id="myForm">

    <select name="modeOfT" id="choice"><option value="A">A</option>
        <option value="A">A</option>
        <option value="B">B</option>
    </select> 

    <input type="submit" name="submitBtn" onclick="submitForm()">
</form> 
```

**Javascript函数：**

```
function submitForm(){
    var form = document.getElementById("myForm");
    var mode = document.getElementById("choice");
    if(mode.value == "B"){
        $(form).attr("action", "newUrl.do");
    }
} 
```

以下是我尝试过的其他事情，他们仍然将我带到“oldUrl.do”：

1.  document.location.href("newUrl.do");

2.  window.location.href="newUrl.do";

3.  top.location.href="newUrl.do";

4.  parent.location.href="newUrl.do";

5.  window.location.replace("newUrl.do");

6.  window.location="newUrl.do";

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T17:45:01.007

您不应该处理单击事件。要处理提交的表单，您应该使用提交事件，出于这个和许多其他原因（人们可以使用回车，他们可以在关注提交按钮时点击空格）

**工作示例** [http://jsfiddle.net/xv3Uf/2/](http://jsfiddle.net/xv3Uf/2/)

**HTML**

```
<form name="myForm" method="post" action="oldUrl.do" id="myForm" onsubmit="return submitForm()" > 
```

**JS**

```
function submitForm(){
    var form = document.getElementById("myForm");
    var mode = document.getElementById("choice");
    if(mode.value == "B"){
        form.action = "newUrl.do";
    }
} 
```

既然你已经在使用 了`jQuery`，为什么不喝一杯酷爱饮料并停止在 HTML 中设置 JS 处理程序的启蒙前实践呢？[http://jsfiddle.net/xv3Uf/3/](http://jsfiddle.net/xv3Uf/3/)

```
<form name="myForm" method="post" action="oldUrl.do" id="myForm"> 
```

**JS**

```
$('#myForm').submit(function(e){
    if ( $('#choice').val() === 'B') {
        this.action = 'newUrl.do'
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T17:42:51.830

把它`<submit>`变成一个普通的`<button>`.

在 submitForm() 函数中，最后调用：

```
document.forms["myForm"].submit(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-12T17:43:43.333

你可以：

1.  让服务器根据用户在表单中选择的内容发回 HTTP/重定向标头。

2.  如果您希望在浏览器上处理重定向，请使用“onsubmit”属性并返回一个`false`值。您可以使用此函数处理重定向`window.location = <URL>;`

    ```
    <form onsubmit="return myJSFunc()" .. >
       ...
       <input type="submit">
    </form> 
    ```

# vb.net - 如何从 VB.NET 中的 3 个字母缩写中获取月份索引？

> ID：14838438
> 
> 赞同：3
> 
> 时间：2013-02-12T17:39:48.410
> 
> 标签：vb.net, date, datatable

我正在尝试从月份缩写中检索月份编号（例如，Jan、Feb、Mar）。这是我尝试过的：

```
xdata(i) = DateTime.Parse(
               filteredData.Columns(i + 23).ColumnName.ToString
           ).ToString("m") 
```

filtersData是一个**DataTable**，其列名标记为月份缩写。在这种情况下，检索月份编号的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T17:53:37.227

有点像，

```
Dim monthNumber = DateTime.ParseExact(
                      "Jan",
                      "MMM",
                      CultureInfo.CurrentCulture).Month 
```

其中，`"Jan"`是您运行代码的月份的有效缩写。

# c# - 将 CDN url 添加到 mvc 4 bundler 输出

> ID：14838442
> 
> 赞同：9
> 
> 时间：2013-02-12T17:39:58.627
> 
> 标签：c#, asp.net-mvc-4, cdn, bundling-and-minification

使用内置的 MVC4 捆绑器，我如何将我的 CDN url 添加到它生成的链接标签中？我已经设置了 Amazon Cloudfront，以便它在第一次请求时从我的网络服务器中提取资产。所以当我像这样定义一个包时：

```
 bundles.Add(new StyleBundle("~/Content/css").Include(
    "~/Content/reset.css",
    "~/Content/960_24_col.css",
    "~/Content/Site.css"
 )); 
```

部署后，我可以这样引用它：

```
http://[cloundfrontid].cloudfront.net/Content/css?v=muhFMZ4thy_XV3dMI2kPt-8Rljm5PNW0tHeDkvenT0g1 
```

现在我只需要将捆绑器生成的链接从相对于指向我的 CDN 的绝对链接更改。

```
 <link href="[INSERT_CDN_URL_HERE]/Content/css?v=muhFMZ4thy_XV3dMI2kPt-8Rljm5PNW0tHeDkvenT0g1" rel="stylesheet"/> 
```

我认为可以使用 IBundleTransform 重写路径，但我找不到任何示例。

注意：为了清楚起见，我知道您可以为捆绑包指定 CDN 链接，但这只有在捆绑包可以被静态链接替换时才有效。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-11T22:23:09.130

我刚刚设置了 MaxCDN 并遇到了同样的问题。

如您所知，该`bundles.UseCdn`属性并不理想，因为我们不想为捆绑包指定确切的 url。像 Max CDN 这样的 CDN 是完全相同的 url、查询字符串和所有内容，除了不同的子域。

这就是我最终解决它的方法。

我创建了一个`BundleHelper`将包装渲染方法的类，然后在路径前面加上 CDN 子域。

下面是这个类的样子：

```
namespace MyDomain.Web.Helpers
{
    public class BundleHelper
    {
        public static string CdnPath = "http://cdn.mydomain.com";

        public static IHtmlString RenderScript(string path)
        {
            var opt = System.Web.Optimization.Scripts.Render(path);
            string htmlString = HttpUtility.HtmlDecode(opt.ToHtmlString());

            if (BundleTable.EnableOptimizations)
            {
                htmlString = htmlString.Replace("<script src=\"/", String.Format("<script src=\"{0}/", CdnPath));
            }

            return new HtmlString(htmlString);
        }

        public static IHtmlString RenderStyle(string path)
        {
            var opt = System.Web.Optimization.Styles.Render(path);
            string htmlString = HttpUtility.HtmlDecode(opt.ToHtmlString());

            if (BundleTable.EnableOptimizations)
            {
                htmlString = htmlString.Replace("<link href=\"/", String.Format("<link href=\"{0}/", CdnPath));
            }

            return new HtmlString(htmlString);
        }
    }
} 
```

然后要在视图中使用它，我只需执行以下操作：

```
@BundleHelper.RenderStyle("~/Content/css")
@BundleHelper.RenderStyle("~/Content/themes/base/css")

@BundleHelper.RenderScript("~/bundles/jquery")
@BundleHelper.RenderScript("~/bundles/jqueryui") 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T20:08:42.130

请看@Using [a CDN](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)搜索“Using a CDN”

> 正如 Rick Anderson 在 asp.net/mvc 中所说，
> 
> 以下代码将本地 jQuery 包替换为 CDN jQuery 包。

```
 public static void RegisterBundles(BundleCollection bundles)
    {
    //bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
    //            "~/Scripts/jquery-{version}.js"));

    bundles.UseCdn = true;   //enable CDN support

    //add link to jquery on the CDN
    var jqueryCdnPath = "http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.1.min.js";

    bundles.Add(new ScriptBundle("~/bundles/jquery",
                jqueryCdnPath).Include(
                "~/Scripts/jquery-{version}.js"));

    // Code removed for clarity.
    } 
```

> 在上面的代码中，在发布模式下会从 CDN 请求 jQuery，并且在调试模式下会在本地获取 jQuery 的调试版本。使用 CDN 时，您应该有一个回退机制，以防 CDN 请求失败。布局文件末尾的以下标记片段显示了在 CDN 失败时添加到请求 jQuery 的脚本。

```
 </footer>

        @Scripts.Render("~/bundles/jquery")

        <script type="text/javascript">
            if (typeof jQuery == 'undefined') {
                var e = document.createElement('script');
                e.src = '@Url.Content("~/Scripts/jquery-1.7.1.js")';
                e.type = 'text/javascript';
                document.getElementsByTagName("head")[0].appendChild(e);

            }
        </script> 

        @RenderSection("scripts", required: false)
    </body>
</html> 
```

粘贴了来自 Asp.net/MVC 的部分，如果您觉得它有用，那么为 Rick Anderson 的帖子干杯...

# magento - 如何将 Magento 的分层导航块从左列移动到右列？

> ID：14838445
> 
> 赞同：2
> 
> 时间：2013-02-12T17:40:08.703
> 
> 标签：magento, magento-layout-xml

我知道有人问过这个问题，但我一直找不到适合我的答案。我有一个我构建的自定义模块，它在提供搜索结果时也会搜索 CMS 静态页面。在这个模块中，我有一个更新布局 xml 的文件。我确定我的 xml 正在加载。出于某种原因，我尝试删除或取消设置分层导航并将其移动到右列都没有结果。以下是我的代码，我希望有人能帮助指出我的错误。谢谢！

```
<layout version = "0.1.0">

<catalog_category_default>
    <reference name="left">
        <action method="unsetChild"><name>catalog.leftnav</name></action>
    </reference>
    <reference name="right">
        <action method="insert"><child>catalog.leftnav</child></action>
    </reference>
</catalog_category_default>

<catalogsearch_result_index>
    <reference name="content">
        <block type="cmssearch/results" name="cms-search-results-view" after="search.result" template="cmssearch/cmssearchview.phtml">
        </block>
    </reference>
    <reference name="left">
        <!-- <remove name = "catalogsearch.leftnav" /> -->
        <action method="unsetChild"><name>catalogsearch.leftnav</name></action>
    </reference>
    <reference name="right">
        <!--  <block type="catalogsearch/layer" name="catalogsearch.leftnav" before="+" template="catalog/layer/view.phtml"/> -->
        <action method="insert"><child>catalogsearch.leftnav</child></action>
    </reference>
</catalogsearch_result_index>

<catalog_category_layered>
    <reference name="left">
        <action method="unsetChild"><name>catalog.leftnav</name></action>
    </reference>
    <reference name="right">
        <action method="insert"><child>catalog.leftnav</child></action>
    </reference>
</catalog_category_layered> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T21:24:26.077

我对社区版有类似的问题。尝试成功将分层导航“catalog.leftnav”移动到 mycustomblock，但随后出现错误

> 您不能多次定义相关名称“customattribute”

这样做`<remove name="catalog.leftnav" />`也从 mycustomblock 中删除了它。unsetChild 根本不起作用。Emil Stewart 解决方案，重命名块，效果很好。谢谢你！因此，如果有人在 CE 中遇到同样的问题，请执行以下操作。

1.  在你的 local.xml 添加`<remove name="catalog.leftnav" />`
2.  然后在您想要的位置添加目录/图层视图块，但更改名称

> `<block type="catalog/layer_view" name="yourname.catalog.leftnav" template="catalog/layer/view.phtml"/>`

但我在[这里找到了](http://www.magentocommerce.com/boards/v/viewthread/196919/#t387528)**更好、更清洁的解决方案**

```
 <reference name="left">
        <action method="unsetChild"><name>catalog.leftnav</name></action>
    </reference>
    <reference name="right">
        <action method="insert"><child>catalog.leftnav</child></action>
    </reference> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-12T17:54:08.843

所以我真的想通了这个问题。我正在使用 Magento 企业版，企业版明确删除了分层导航以添加自己的分层导航。我应该注意到这一点，因为我有模板路径提示，并且它显示分层导航作为企业块。无论如何，这是导致问题的代码：

```
<catalogsearch_result_index>
    <reference name="left">
        <remove name="catalogsearch.leftnav"/>
        <block type="enterprise_search/catalogsearch_layer" name="enterprisesearch.leftnav" before="-" template="catalog/layer/view.phtml"/>
    </reference>
</catalogsearch_result_index>

<catalog_category_layered>
    <reference name="left">
        <remove name="catalog.leftnav"/>
        <block type="enterprise_search/catalog_layer_view" name="enterprisecatalog.leftnav" before="-" template="catalog/layer/view.phtml"/>
    </reference>
</catalog_category_layered> 
```

我只需将我的名称引用更改为 enterprisecatalog.leftnav 即可解决此问题。

# php - Zend db PDO 不返回结果

> ID：14838447
> 
> 赞同：0
> 
> 时间：2013-02-12T17:40:13.923
> 
> 标签：php, mysql, zend-framework, pdo

我对以下问题有疑问：

```
$sql = "SELECT e.*, c.name city_name, u.*, IF(l.item IS NULL, 0, 1) as iLike, DATE_FORMAT(e.date, '%h:%i') hour, DATE_FORMAT(e.date, '%d/%c/%Y') day,  DATE_FORMAT(e.date, '%c') month
FROM `events` e
LEFT OUTER JOIN `like` l ON l.item = e.uuid AND l.user = :user
            LEFT OUTER JOIN city c ON c.city = e.city
            LEFT OUTER JOIN user u ON u.user = e.user
            WHERE
             e.deleted = 0
            AND DATE(e.date) >= CURDATE()
            AND e.user = :user
            ORDER by e.date ASC
            ";
    $select = $eventsModel->getAdapter();
    $select->setFetchMode(Zend_Db::FETCH_ASSOC);
    $prepare = $select->query($sql, array('user'=>$this->user_id)); 
```

如果我将 :user 硬编码到查询中，此代码将返回结果。例子：

```
$sql = "SELECT e.*, c.name city_name, u.*, IF(l.item IS NULL, 0, 1) as iLike, DATE_FORMAT(e.date, '%h:%i') hour, DATE_FORMAT(e.date, '%d/%c/%Y') day,  DATE_FORMAT(e.date, '%c') month
            FROM `events` e
            LEFT OUTER JOIN `like` l ON l.item = e.uuid AND l.user = 23
            LEFT OUTER JOIN city c ON c.city = e.city
            LEFT OUTER JOIN user u ON u.user = e.user
            WHERE
             e.deleted = 0
            AND DATE(e.date) >= CURDATE()
            AND e.user = 23
            ORDER by e.date ASC
            ";
    $select = $eventsModel->getAdapter();
    $select->setFetchMode(Zend_Db::FETCH_ASSOC);
    $prepare = $select->query($sql); 
```

这只是在我们将代码移动到新服务器时才开始发生的，新的操作系统是 Debian 6、squeze、mysql 5.5、PHP 5.3.21。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:47:05.077

使用`?`代替`:user`，而`$this->user_id`不是`array('user'=>$this->user_id)`

此外，您不能在`JOIN`语句中绑定数据，所以`l.user = e.user`

```
$sql = "SELECT e.*, c.name city_name, u.*, IF(l.item IS NULL, 0, 1) as iLike, DATE_FORMAT(e.date, '%h:%i') hour, DATE_FORMAT(e.date, '%d/%c/%Y') day,  DATE_FORMAT(e.date, '%c') month
            FROM `events` e
            LEFT OUTER JOIN `like` l ON l.item = e.uuid AND l.user = e.user
            LEFT OUTER JOIN city c ON c.city = e.city
            LEFT OUTER JOIN user u ON u.user = e.user
            WHERE
             e.deleted = 0
            AND DATE(e.date) >= CURDATE()
            AND e.user = ?
            ORDER by e.date ASC
            ";
    $select = $eventsModel->getAdapter();
    $select->setFetchMode(Zend_Db::FETCH_ASSOC);
    $prepare = $select->query($sql, array($this->user_id)); 
```

# c# - DisplayFor 不能使用具有不同命名空间的相同模型名称

> ID：14838450
> 
> 赞同：2
> 
> 时间：2013-02-12T17:40:19.573
> 
> 标签：c#, asp.net-mvc-3, templates, razor

我遇到了无法调用正确的 DisplayTemplate 的问题。

我有两个模型：

```
CompanyName.Application.Web.Controllers.SharedViewModels.PaymentItemViewModel
CompanyName.Application.ViewModels.SharedViewModels.PaymentItemViewModel 
```

这些对象在 IEnumerable 中使用，然后传递给 DisplayTemplate。

DisplayTemplates/PaymentItemViewModel.cshtml：

```
@model CompanyName.Application.ViewModels.Web.SharedViewModels.PaymentItemViewModel 
```

显示模板/PaymentItems.cshtml：

```
@model CompanyName.Application.Web.Controllers.SharedViewModels.PaymentItemViewModel 
```

如果我尝试像这样调用 PaymentItems.cshtml 的显示模板：

```
@Html.DisplayFor(model => model.PaymentItems, "DisplayTemplates/PaymentItem") 
```

它会抛出一个错误，它抱怨传递给字典的模型与字典所期望的模型类型不同。model.PaymentItems 中的类型绝对是一个 IEnumerable

```
CompanyName.Application.Web.Controllers.SharedViewModels.PaymentItemViewModel 
```

如果我这样调用，另一个模板确实有效：

```
@Html.DisplayFor(model => model.PaymentItems) 
```

但是，如果我指定模板名称：

```
@Html.DisplayFor(model => model.PaymentItems, "DisplayTemplates/PaymentItemViewModel.cshtml") 
```

然后它失败了。就好像指定模板名称要么完全被忽略，要么破坏模板功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T10:04:33.880

Shelakel 对这个问题的评论一半为我回答了这个问题。

我将“DisplayTemplates/PaymentItem”更改为“PaymentItem”，它开始调用正确的模板。但是，它确实引发了另一个问题，它抱怨它试图将 IList 传递给单个对象。

这是 PaymentItems 在主模型上的外观：

```
private IList<PaymentItemViewModel> paymentItems = new List<PaymentItemViewModel>();

public IEnumerable<PaymentItemViewModel> PaymentItems
{
    get { return paymentItems; }
    set { paymentItems = value.ToList(); }
} 
```

为了解决这个问题，我必须将显示模板上的模型设为 IList 并在其中放置一个 foreach。有点毫无意义，因为我认为模板的主要原因之一是您不需要遍历视图上的集合！

无论如何，我相信 IList 问题源于初始集合作为 IList 开始生活的事实，但我现在已经让它工作了，所以我想这个问题已经得到解答。

将 paymentItems 声明从 更改`IList<PaymentItemViewModel`为`IEnumerable<PaymentItemViewModel>`不会改变任何东西。

# ruby-on-rails - 作为动态字段的布尔值

> ID：14838453
> 
> 赞同：1
> 
> 时间：2013-02-12T17:40:32.620
> 
> 标签：ruby-on-rails, formtastic

我有一个序列化字段，用于存储对象的一些动态值。我正在使用 method_missing 访问这些值，因为它们对于每个对象都可能不同。除了布尔值外，一切正常。当我做：

```
f.input :hb_failed, as: :boolean, label: false 
```

它不会只呈现隐藏字段的复选框。但是，如果我这样做：

```
f.input :hb_failed, as: :boolean, label: "" 
```

我得到了想要的结果，它是一个没有标签的复选框。这是预期的行为还是错误？

# facebook - 如何发布和更新到用户的 Facebook 时间线？

> ID：14838457
> 
> 赞同：0
> 
> 时间：2013-02-12T17:40:39.020
> 
> 标签：facebook, facebook-graph-api

我正在尝试将状态更新发布到用户 facebook 时间线，但是然后我运行它，没有任何反应。

```
 require_once('sdk/src/facebook.php');

   $facebook = new Facebook(array(
   'appId'  => AppInfo::appID(),
   'secret' => AppInfo::appSecret(),
   'sharedSession' => true,
    'trustForwarded' => true,
   ));
 $response = $facebook->api(
 'me/news.publishes'
 'POST',
 array(
  'article' => "http://samples.ogp.me/434264856596891"
 )
); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T15:38:33.093

尝试用 "feed" 替换 "news.publishes" ，所以代码将是

```
$response = $facebook->api(
 'me/feed'
 'POST',
 array(
  'article' => "http://samples.ogp.me/434264856596891"
 )
); 
```

# sql-server-2008 - SQL Server 表 1 更新表 2

> ID：14838459
> 
> 赞同：0
> 
> 时间：2013-02-12T17:40:47.047
> 
> 标签：sql-server-2008

在 SQL Server 数据库中有两个表。表 #1`ClassicsRatings`有`RatingID`, 作为键, `TitleID`,`Rating`和`Comment`. 表 #2, `AVGRating`, 有`TitleID`, 作为键, `AvgRating`, 和`Count`.

当查询最初在表 #1 上运行时，以下查询会更新表 #2：

```
INSERT INTO AVGRating
   SELECT TitleID, Count(*) AS Count, AVG(Rating) AS AvgRating
   FROM ClassicsRatings
   GROUP BY TitleID
   ORDER BY TitleID 
```

我的问题是：如何在随后的 INSERTS 进入表 #1 时更新表 #2。我已经尝试过`MERGE`，`UPDATE`如下所示：

```
MERGE AVGRating AS AR
USING ( SELECT TitleID, COUNT(*) AS Count, AVG(Rating) AS AvgRating
FROM ClassicsRatings
GROUP BY RecipeID) AS ClassicsRatings(RecipeID, Count, AvgRating)
ON
(
AR.RecipeID = ClassicsRatings.RecipeID
)
WHEN NOT MATCHED THEN
   INSERT (RecipeID, Count, AvgRating)
   VALUES (ClassicsRatings.RecipeID, ClassicsRatings.Count, ClassicsRatings.AvgRating)
WHEN MATCHED THEN
   UPDATE
    SET AR.Count = ClassicsRatings.Count, 
        AR.AvgARating = ClassicsRatings.AvgRating;

UPDATE AVGRating
SET
AVGRating.TitleID = ClassicsRatings.TitleID,
AVGRating.AvgRating = ClassicsRatings.AvgRating,
AVGRating.Count = ClassicsRatings.Count
FROM AVGRating
INNER JOIN ClassicsRatings ON
AVGRating.TitleID = ClassicsRatings.TitleID
WHERE TitleID = TitleID 
```

我无法做到的是插入表 1 并让表 2 反映该插入。任何帮助，将不胜感激。

我还使用了以下 TRIGGER 但没有结果：

```
CREATE TRIGGER AVGRatingTrigger
ON ClassicsRatings
AFTER INSERT AS
DECLARE @TitleID INT
DECLARE @Count INT
DECLARE @RatingAVG INT
BEGIN
UPDATE AVGRatings
WHERE AVGRatings.TitleID = ClassicsRatings.TitleID 
END 
```

触发器更改为：

```
CREATE TRIGGER AVGRatingTrigger
ON ClassicsRatings
AFTER INSERT AS

BEGIN
UPDATE A
SET A.TitleID = I.TitleID,
A.Count = I.Count,
A.AvgRating = I.AvgRating
FROM AVGRating as A
INNER JOIN INSERTED as I ON A.TitelID = I.TitleID 
END 
```

我没有收到有关触发器的错误消息，但是，当我在 ClassicRatings 中插入新评级时，我收到错误消息“无效对象 AvgRating”似乎 AVGRating 表中的 AVG(Rating) AS AvgRating 的 AvgRating 部分不是由触发器识别（初始查询确实识别 AvgRating）。我认为这意味着由于 ClassicsRatings 实际上没有 AvgRating 而是进行计算/聚合并用计算填充 AVGRating 表，因此正在发生冲突。我已经尝试了两天来让它工作。我的问题似乎出在 A.Count = I.Count A.AvgRating = I.AvgRating 因为 ClassicsRatings 表中的 Count 实际上是 COUNT(*) - 不是 ClassicsRatings 中的字段，而 AvgRating 真的是 AVG(Rating) - 不是ClassicsRatings 中的一个字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:49:35.250

您需要使用触发器来实现这一点。只需创建一个“插入时”触发器，它会在第一个表中有插入时运行查询。

在触发器中，您应该使用包含插入行的逻辑 INSERTED。就像是：

```
CREATE TRIGGER AVGRatingTrigger
ON ClassicsRatings
AFTER INSERT AS

BEGIN
UPDATE A
SET A.xxx = I.xxx,
    A.yyy = I.yyy,
    ...
FROM AVGRatings as A
INNER JOIN INSERTED as I ON A.TitleID = I.TitleID 
END 
```

# objective-c - 方法在 applicationDidFinishLaunching 中有效，但在其他方法中无效（在同一个文件中）！

> ID：14838464
> 
> 赞同：-1
> 
> 时间：2013-02-12T17:41:05.493
> 
> 标签：objective-c, macos, cocoa

我正在制作一个需要创建目录来下载一些文件的应用程序。当我打电话

```
[[NSFileManager defaultManager] createDirectoryAtPath:
[[self.searchURL theDownloadLocation] stringByStandardizingPath]
withIntermediateDirectories:YES attributes:nil error:nil]; 
```

之内

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification 
```

它工作正常。我有一个应该开始下载的按钮。我已经将它放在 xib 文件中，它可以做任何其他事情，所以我知道按钮可以工作。`NSFileManager`同样，如果我在 中调用该方法，则目录创建没有问题`applicationDidFinishLaunching`，但在我按下按钮时调用的其他方法中则没有。它崩溃并显示一条`(lldb)`消息。

传递的参数完全一样，我什`NSLog`至`[[self.searchURL theDownloadLocation] stringByStandardizingPath]`在按钮方法中加入了，它肯定是一个`NSString`，所以当我按下按钮时它会记录。我错过了什么？

我有时会收到一条错误消息：

```
2013-02-12 19:33:04.404 dArt[2351:303] -[NSISRestrictedToNonNegativeVariableToBeMinimized
stringByStandardizingPath]: unrecognized selector sent to instance 0x100528ba0
2013-02-12 19:33:04.405 dArt[2351:303] -[NSISRestrictedToNonNegativeVariableToBeMinimized
stringByStandardizingPath]: unrecognized selector sent to instance 0x100528ba0 
```

```
2013-02-12 19:33:04.408 dArt[2351:303] (
    0 核心基础 0x00007fff862c40a6 __exceptionPreprocess + 198
    1 libobjc.A.dylib 0x00007fff8d4e53f0 objc_exception_throw + 43
    2核心基础0x00007fff8635a6ea-[NSObject（NSObject）不识别选择器：]+186
    3 核心基础 0x00007fff862b25ce ___forwarding___ + 414
    4 核心基础 0x00007fff862b23b8 _CF_forwarding_prep_0 + 232
    5 dArt 0x000000010000248d -[AppDelegate searchTheArt:] + 141
    6 AppKit 0x00007fff8a91ea59-[NSApplication sendAction:to:from:] + 342
    7 AppKit 0x00007fff8a91e8b7-[NSControl sendAction:to:] + 85
    8 AppKit 0x00007fff8a91e7eb-[NSCell_sendActionFrom:] + 138
    9 AppKit 0x00007fff8a91ccd3-[NSCell tr​​ackMouse:inRect:ofView:untilMouseUp:] + 1855
    10 AppKit 0x00007fff8a91c521-[NSButtonCell tr​​ackMouse:inRect:ofView:untilMouseUp:] + 504
    11 AppKit 0x00007fff8a91bc9c -[NSControl mouseDown:] + 820
    12 AppKit 0x00007fff8a91360e-[NSWindow 发送事件：] + 6853
    13 AppKit 0x00007fff8a90f744-[NSApplication sendEvent:] + 5761
    14 AppKit 0x00007fff8a8252fa -[NSApplication 运行] + 636
    15 AppKit 0x00007fff8a7c9cb6 NSApplicationMain + 869
    16 dArt 0x00000001000016b2 主要 + 34
    17 libdyld.dylib 0x00007fff8b36b7e1 开始 + 0
)

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T01:27:18.777

我的问题已在别处得到解答。我只需要将`(copy)`限定符添加到`theDownloadLocation`属性。

像`@property (copy) NSString *theDownloadLocation;`

# javascript - 如何使用 socket.io 和 engine.io 作为传输？

> ID：14838467
> 
> 赞同：4
> 
> 时间：2013-02-12T17:41:09.250
> 
> 标签：javascript, websocket, socket.io

我希望使用 socket.io 的功能，例如自定义事件、房间和广播，但我想使用 engine.io 作为其更可靠的基于升级而不是基于回退的设计的传输层。

[读完这篇文章](http://www.devthought.com/2012/07/07/the-realtime-engine/#more-1658)，我觉得这是可能的：

> **Engine.IO 充当**Socket.IO 在服务器和浏览器之间交换的数据的传输层。**它不会取代 Socket.IO**。它只是抽象出在多个浏览器、设备和网络中支持实时数据交换的内在复杂性。

有谁知道这是否可以做到？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-15T11:29:36.033

engine.io 是 socket.io 的传输层。你不必做任何事情。
查看这个 package.json 文件以查看依赖关系：[https ://github.com/LearnBoost/socket.io/blob/master/package.json](https://github.com/LearnBoost/socket.io/blob/master/package.json)

# coldfusion - 冷融合错误处理

> ID：14838468
> 
> 赞同：1
> 
> 时间：2013-02-12T17:41:13.300
> 
> 标签：coldfusion, coldfusion-9

我正在尝试创建一些自定义错误页面，通过电子邮件向我们的开发人员发送冷融合中出现 404 或 500 错误的信息。如果在电子邮件中提供错误变量也会很有帮助。

我在coldfusion 中设置了一个错误页面，并将IIS(7) 指向它。

同样在我的 application.cfm 文件中，我声明了以下内容：

```
<cferror type="exception" template="#name#">
<cferror type="request" template="#name#"> 
<cferror type="validation" template="#name#"> 
<cferror type="monitor" template="#name#"> 
```

我的问题是在错误文件中我不能包含任何 CF 调用，CF 似乎将它们剥离。

难道我做错了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T18:25:26.700

*根据下面 Travis 的评论 - 虽然`cferror`仍然支持使用该标签，但建议将 Application.cfm 转换为 Application.cfc（如果还没有）并改用该`onError`方法。我在下面列出的所有限制在使用该方法时都不适用，`onError`并且所有 CFML 功能都可用。[这是 onError 方法的 ColdFusion 9 文档。](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d4a.html)*

[ColdFusion 文档中](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec0bb9b-7ffe.html)有一个完整的部分详细介绍了错误处理。但是对于您关于标签的具体问题，`cferror`您需要意识到发生错误时 ColdFusion 可以执行的操作是有限制的，甚至取决于错误的类型。[这是从这个页面](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec0bb9b-7ffc.html)摘录的：

下表列出了适用于错误应用程序页面的规则和注意事项：

**验证**

*   不能使用 CFML 标签
*   可以使用 HTML 标签
*   可以通过用数字符号 (#) 括起来来使用`Error.InvalidFields`、`Error.validationHeader`和变量`Error.validationFooter`
*   不能使用任何其他 CFML 变量

**要求**

*   不能使用 CFML 标签
*   可以使用 HTML 标签
*   可以使用九个 CFML 错误变量，例如`Error.Diagnostics`，通过用数字符号将它们括起来
*   不能使用其他 CFML 变量

**例外**

*   可以使用完整的 CFML 语法，包括标签、函数和变量
*   可以使用九个标准 CFML 错误变量和 cfcatch 变量。使用`Error`或`cferror`作为两种类型变量的前缀
*   可以使用其他应用程序定义的 CFML 变量
*   要显示任何 CFML 变量，请使用 cfoutput 标签

摘自[this page](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d29.html)关于每种异常类型的可用错误变量：

**仅验证**

```
 error.validationHeader  Validation message header text.
    error.invalidFields     Unordered list of validation errors.
    error.validationFooter  Validation message footer text. 
```

**请求和例外**

```
 error.diagnostics       Detailed error diagnostics from ColdFusion.
    error.mailTo            E-mail address (same as value in cferror.MailTo).
    error.dateTime          Date and time when error occurred.
    error.browser           Browser that was running when error occurred.
    error.remoteAddress     IP address of remote client.
    error.HTTPReferer       Page from which client accessed link to page where error occurred.
    error.template          Page executing when error occurred.
    error.generatedContent  The content generated by the page up to the point where the error occurred.
    error.queryString       URL query string of client's request. 
```

**仅例外**

```
 error.message           Error message associated with the exception.
    error.rootCause         The root cause of the exception. This structure contains the information that is returned by a cfcatch tag.
                            For example, for a database exception, the SQL statement that caused the error is in the error.RootCause.Sql variable.
                            For Java exceptions, this variable contains the Java servlet exception reported by the JVM as the cause of the "root cause" of the exception.
    error.tagContext        Array of structures containing information for each tag in the tag stack. The tag stack consists of each tag that is currently open.
    error.type              Exception type. 
```

*注意：如果 type = "exception"，你可以用前缀 cferror 代替 Error；例如，cferror.diagnostics、cferror.mailTo 或 cferror.dateTime。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T14:09:32.137

出于这个原因，使用模板最准确，例如... dbc.cfm。在 dbc.cfm 中编写邮件发送代码。

```
<cftry>
        <cfquery name="GetData" datasource="#Application.ds#" dbtype="ODBC" username="#Application.UserName#" password="#Application.Password#">
            SELECT m.price
            FROM productvendorsmap m
            WHERE m.productid = <cfqueryparam cfsqltype="cf_sql_integer" value="#ProductId#">
            AND m.vendorid = <cfqueryparam cfsqltype="cf_sql_integer" value="#VendorIdd#">
        </CFQUERY>
        <cfcatch type="Database">
            **<cfinclude template="dbc.cfm">**
        </cfcatch>
    </cftry> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T17:53:10.570

您的错误文件是否具有 .cfm 扩展名？

此外，如果您每发送一次 404 电子邮件，您可能会面临邮件炸弹攻击。您可能会更好地添加诸如 Google Analytics 之类的内容来检查 404。500 错误可能意味着许多事情出错了，因此 CF 可能无论如何都不会发送电子邮件。

# c#-3.0 - 带有 MemoryStream() 的 OutOfMemoryException

> ID：14838469
> 
> 赞同：0
> 
> 时间：2013-02-12T17:41:20.333
> 
> 标签：c#-3.0, out-of-memory, memorystream

在这段 C# 代码中，我遇到了 OutOfMemoryException 的问题。

```
private void SaveZip(IDataReader reader, string header, string fileName, Ionic.Zip.ZipFile zip)
    {
        using (var stream = new MemoryStream())
        {
            using (var writer = new StreamWriter(stream, Encoding.ASCII))
            {
                writer.WriteLine(header);
                while (reader.Read())
                {
                    writer.WriteLine(reader.GetString(0)); //exception occurs here
                }

                writer.Close();
            }

            zip.AddEntry(fileName, stream.ToArray());
        }
    } 
```

该代码尝试将 DataReader 对象写入一个文件，该文件在过程结束时被压缩。问题是 Reader 包含大量数据，大约 150MB，当我尝试将流写入内存时，它引发了异常。我该如何解决这个问题？

感谢帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:09:53.023

如果您没有足够的内存来将数据处理到内存缓冲区，那么您将不得不将其存储在内存之外，例如磁盘。例如替换`MemoryStream`为`FileStream`

# c - printf 在其中传递较少参数时的行为

> ID：14838474
> 
> 赞同：-1
> 
> 时间：2013-02-12T17:41:35.300
> 
> 标签：c, printf

我刚刚通过更改编号注意到 printf 函数的不同行为。参数和格式说明符。请查看以下代码：

```
#include<stdio.h>
void main()
{ int ji=65;
  printf("ji>=65 ? %d : %c",ji);
 } 
```

输出结果是**ji>=65 ？65 : A**
**打印的字符是 A**
但是如果代码是：

```
#include<stdio.h>
void main()
{ int ji=65,y;
  printf("ji>=65 ? %d : %c",ji);
  printf("%d",y)
} 
```

在这种情况下打印的字符是**heart(ascii value 3)**并且**y**的值是**12803**。

编译器如何拾取字符值？？？请帮忙

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-12T17:44:52.303

在发布的代码中调用会`printf()`导致未定义的行为：

```
printf("ji>=65 ? %d : %c",ji); /* One less argument than required for
                                  the supplied format. */ 
```

从第*7.19.6.1*节C99 标准的 fprintf 函数：

> fprintf 函数将输出写入 stream 指向的流，在 format 指向的字符串的控制下，该字符串指定后续参数如何转换为输出。**如果格式的参数不足，则行为未定义。**如果格式已用尽而参数仍然存在，则评估多余的参数（一如既往），否则将被忽略。当遇到格式字符串的结尾时，fprintf 函数返回。

此行为也适用于`printf()`函数（以及`sprintf()`and`snprintf()`函数）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:53:24.553

如果传递给的参数的数量`printf`少于格式字符串中的转换说明符的数量，或者如果相应的转换说明符的参数类型不正确，则行为是*undefined*，这意味着几乎任何结果都是可能的（并被认为是“正确的”）。 *如何*获得该结果将因情况而异。

如果传递给的参数数量`printf`大于转换说明符的数量，则评估附加参数，否则将被忽略。

请注意，块作用域变量 like`y`不会隐式初始化为任何特定值；它们的值是*不确定*的，甚至可能是一个陷阱值，所以你不应该期望第二`printf`条语句有任何特定的输出。

此外，除非您的编译器文档*明确*将其列为有效签名，`void main()`否则也会导致未定义的行为。改为使用`int main(void)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T17:45:56.593

它是从堆栈中取出的。您告诉 printf 它可以从堆栈中获取 2 个参数，但您只提供 1 个参数。Printf 不知道这一点，并获取堆栈上的下一个值，该值很可能是调用 printf 期间保存的寄存器的值。

但请注意：您获得的值始终是未定义的。

# intersystems-cache - 使用反射获取属性的值

> ID：14838475
> 
> 赞同：1
> 
> 时间：2013-02-12T17:41:41.037
> 
> 标签：intersystems-cache

假设我有几个从 MyAbstractClass 扩展的类，每个类都包含它们自己的属性，这些属性在 MyAbstractClass 中不存在。我如何从其中一个类中获取属性值？

像这样的东西：（伪代码）

```
Method GetPropertyValue(myAbstractClass As MyAbstractClass) As %String 
{
  Set myPropertyValue = myAbstractClass.GetType().GetProperty("MyProperty").GetValue();
  Quit myPropertyValue
} 
```

到目前为止，我有这个：

```
Method GetPropertyValue(argBusinessObject As BusinessObject)
{
    // get class name. 
    set className = argBusinessObject.%PackageName()_"."_argBusinessObject.%ClassName()

    set dictionary = ##class(%Dictionary.ClassDefinition).%OpenId(className)
    if (dictionary '= "")
    {
        for index=1:1:dictionary.Properties.Count()
        {
            #dim clsPropDef As %Dictionary.PropertyDefinition
            // Get the property name from the class
            set clsPropDef = dictionary.Properties.GetAt(index)

            if (..PropertyName = clsPropDef.Name) {             
                // we have the property
                // Set the propName so that it gets included
                // now what?
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:57:25.637

```
Method GetPropertyValue(PropertyName)
{
  Q $PROPERTY(##this,Name)
} 
```

在[旧版本](http://training.intersystems.com/tutorials/DocBook.UI.Page.cls?KEY=GCNV_R2010_1)的 Cache 中，您将使用 $ZOBJPROPERTY 而不是 $PROPERTY。显然在版本 2010.1 之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T22:05:19.027

您不需要在缓存中转换类型。

如果你需要得到一个已知的属性，你可以使用通常的语法：

```
Set myPropertyValue = myAbstractClass.MyProperty 
```

如果需要获取未知的属性，可以使用 $property 函数

```
Set myPropertyName = "PropertyNumber"_i
Set myPropertyValue = $property(myAbstractClass,myPropertyName) 
```

# haskell - 使用尾递归查找列表的最大值

> ID：14838480
> 
> 赞同：1
> 
> 时间：2013-02-12T17:41:55.783
> 
> 标签：haskell

我试图了解如何在 Haskell 中使用尾递归编写函数。在下面的示例中，该函数接受一个列表并输出列表中的最大值。我的意图是使用`c`变量来存储当前的最大值。我想知道是否有人可以解释在这种情况下使用尾递归如何工作？

```
 myMax [] c = error "max of empty list"
    myMax [x] c = x
    myMax (x:xs) c = 
                if x > myMax xs then c = x
                else myMax xs c

--currently getting a parse error 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T18:01:00.840

这里有几件事要考虑。首先，您不希望用户必须输入一些起始值，因此我们需要一个仅将列表作为参数的函数。由于您想要一个尾递归实现，我们确实需要一个带有第二个参数的函数，因此我们将创建一个名为的内部函数`go`，它采用当前最大值和剩余列表。

```
myMax [] = error "Empty List"
myMax (x:xs) = go x xs  -- Initialize current max to head of list.
  where
    -- go takes the current max as the first argument and the remaining list
    -- as the second.
    -- m is the current max, if there are no more elements it is the max.
    go m [] = m 
    -- Otherwise we compare m to the current head.
    -- If the head (y) is greater than m it becomes the current max.
    go m (y:ys) = if m > y then go m ys else go y ys 
```

请注意，我们在这里从未更改任何变量的值。我们通过将当前最大值作为参数传递给函数的下一步来更新当前最大值。这对于在 Haskell 中理解至关重要，因为不允许变异变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-23T18:16:36.163

最小值或最大值的正常尾递归版本存在问题，即累加器作为参数。更具体地说，累加器参数的初始值必须从列表中提供，列表的第一项，即函数的第二个参数，您可以在其中找到最小值或最大值。重申一下，最小或最大尾递归函数通常必须采用两个参数。第一个参数是累加器，第二个是要分析的列表。问题是第一个参数的初始值。它只能从要分析的列表中提供。接下来，尾递归函数的基础是累加器。累加器是存储最后一个最小值或最大值并传递给函数以与列表的下一个值进行比较的地方。一个基本功能可以是

```
fix (\f v (x:xs) -> if xs == [] then v else if x < v then f x xs else f v xs) 9999999 [6,5,4,3,2,1,10,7,8] 
```

第一个参数是对高于列表中任何值的猜测，注定会失败，无法自动化。第一个参数应该来自列表，也许是第一项。前面函数中的第一个参数是'v'。它带有最后的最小值或最大值。很容易使用对前面函数的另一个调用。

```
t= \(y:ys) -> (fix (\f v (x:xs) -> if xs == [] then v else if x < v then f x xs else f v xs) y ys) 
```

第一部分使用模式匹配 (y:ys) 将提供的列表拆分为头部和尾部。head 成为被调用函数中的初始 v 参数。尾巴变成了第二个。这对我来说似乎很复杂。累加器初始值是问题所在。必须计算。如何才能做到这一点？通过消除第一个参数。摆脱它。但是我们仍然必须保留一个累加器值以传递以与列表的下一个值进行比较。我们可以把它保存在哪里？唯一可能的地方，在列表本身。

```
minf :: (Num b, Ord b) => [b] -> b
minf [x]      = x
minf (x:xs) = if x > head xs then minf $ x : tail xs else minf xs 
```

minf 采用一个参数，即要分析最小值或最大值的列表。只需将比较符号更改为“<”或“>”即可获得最小值或最大值。另外，我使用这个版本。

```
min = fix (\f (x:xs) -> if xs == [] then x else if x < head xs then f $ x : tail xs else f xs) 
```

我只是在 Haskell 中沾沾自喜，但我对它的期望非常高。这是有史以来最好的语言。它是上述版本的一个版本，仅采用一个参数。

# ruby-on-rails - 为什么我需要重新加载这个子关联？

> ID：14838481
> 
> 赞同：2
> 
> 时间：2013-02-12T17:41:59.760
> 
> 标签：ruby-on-rails, caching, associations, rails-activerecord

在连接活动记录关联时，我经常遇到问题，我希望最终了解导致它的原因（而不是仅仅解决它）。

当通过 parent.children<< 将孩子与父母相关联时，对孩子的引用会正确更新自己。如果反向建立关系（如果通过 child.parent= 完成），这将不一样。

为什么会这样？有没有办法使关系双向？

我过去尝试过`inverse_of`，但没有成功。我希望是因为我对这里发生的事情还不够了解。

**例子：**

鉴于这些模型：

```
class Task < ActiveRecord::Base
  belongs_to :batch

  attr_accessor :state
end

class Batch < ActiveRecord::Base
  has_many :tasks

  def change_tasks
     tasks.each { |x| x.state = "started" }
  end
end 
```

为什么第一个规范失败但第二个通过？我可以通过第一关吗？出于某种原因，我需要在第一个规范中重新加载，而不是在第二个规范中。

```
describe "avoiding reload" do

  context "when association established via child.parent=" do
    it "updates child references" do
      b = Batch.create
      t = Task.create(batch: b)

      b.change_tasks

      b.tasks[0].state.should == "started" # passes
      t.state.should == "started" # fails!?
      t.reload.state.should == "started" # passes, note the reload
    end
  end

  context "when association established via parent.children<<" do
    it "updates child references" do
      b = Batch.create
      t = Task.create
      b.tasks << t

      b.change_tasks

      b.tasks[0].state.should == "started" # passes
      t.state.should == "started" # passes
    end
  end

end 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:25:40.163

它与您的操作顺序有关。

在您调用的第一个测试`Task.create`中。`create`获取参数并保存到数据库并在保存后返回结果。它对其批次的引用不一定与您在测试范围内处理的批次相同。

在第二个测试中，您在调用 create 后分配任务。然后立即访问它。因此，相同的任务 t 是在 内`change_tasks`和期间的引用`t.state.should == "started"`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:41:19.100

简短的回答是第一个规范和第二个规范中的对象不同。

在第一个规范中，您有 2 个不同的对象（尝试检查 rails 控制台）：

```
t.object_id != b.tasks[0].object_id 
```

虽然两个对象都引用相同的记录，但它们是不同的。您已更改`b.tasks[0]`，但`t`在重新加载之前保持不变。

在第二个规范中只有对象：

```
t.object_id == b.tasks[0].object_id 
```

因此，任何更新都`t`将反映在 中`b.tasks[0]`，反之亦然。

# sql - 在 postgresql 上将默认值设置为 null

> ID：14838482
> 
> 赞同：13
> 
> 时间：2013-02-12T17:42:03.980
> 
> 标签：sql, postgresql

[我在这里](http://www.postgresql.org/docs/current/static/sql-altertable.html)读到我应该能够设置这样的列的默认值：

```
ALTER [ COLUMN ] column SET DEFAULT expression 
```

但是这个：

```
ALTER address.IsActive SET DEFAULT NULL 
```

给我这个错误：

> 错误：“地址”处或附近的语法错误 LINE 1：ALTER address.IsActive SET DEFAULT NULL

我做错了什么？另外，如何指定多个列以使其默认值为`NULL`？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-12T17:45:48.043

正确的语法是：

```
ALTER TABLE table_name ALTER COLUMN column_name SET DEFAULT NULL; 
```

对于几列，您重复`ALTER COLUMN`手册中记录的部分：

```
ALTER TABLE table_name 
    ALTER COLUMN foo SET DEFAULT NULL,
    ALTER COLUMN bar SET DEFAULT 0; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-12T17:45:33.363

您没有运行完整的语句。你错过了这个`ALTER TABLE`部分：

> ```
> ALTER TABLE [ ONLY ] name [ * ]
>     action [, ... ]
> ALTER TABLE [ ONLY ] name [ * ]
>     RENAME [ COLUMN ] column TO new_column
> ALTER TABLE name
>     RENAME TO new_name 
> ```
> 
> 其中行动是以下之一：
> [...]

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-12T17:49:05.307

尝试如下...它会工作....

```
ALTER TABLE address ALTER COLUMN IsActive SET DEFAULT NULL 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-12T17:47:40.847

```
alter table dogs
alter column breed set default 'boxer'

alter table dogs
alter column breed set default null 
```

# php - 在 Wordpress 循环期间使用条件语句

> ID：14838483
> 
> 赞同：0
> 
> 时间：2013-02-12T17:42:06.770
> 
> 标签：php, if-statement, wordpress

我在 Wordpress 中使用[Vitrux 主题](http://themeforest.net/item/vitrux-responsive-fullscreen-portfolio-wp-theme/2992618)。主页以平铺布局显示来自“投资组合”帖子类型的帖子。我想从不同的帖子类型（'Shoots'）中获得三个帖子。在调用循环之后在此处添加代码：

```
 if (have_posts()) : while (have_posts()) : the_post();
        if ($post->post_title == "Latest Shoots")
            {
            $portfolio_replacement = 'shoots'; // the post type to query
            query_posts(array('orderby' => 'date', 'post_type'=>$portfolio_replacement, 'posts_per_page' => 3));
            } 
```

但前提是“最新拍摄”帖子是主要投资组合中的第一个。你可以在这里看到这个：

[http://www.snaprockandpop.samcampsall.co.uk](http://www.snaprockandpop.samcampsall.co.uk)

（if 语句添加的帖子是最靠近布局底部的三个帖子，取代了“最新拍摄”帖子）。

我将如何创建这样的条件语句，它将在 Wordpress 循环中的任何时候执行？我不能保证这个总是在开始时发生，另外我想写一些其他的查询来改变这个网站的布局。

最好的方法是什么，我将如何学习它？我对 PHP 有一个非常基本的了解，但我很想了解更多，所以请温柔一点！

# css - 使 Google（Blogger）小工具 iframe 透明

> ID：14838484
> 
> 赞同：1
> 
> 时间：2013-02-12T17:42:07.307
> 
> 标签：css, google-gadget

我为我的博主博客创建了我的第一个 Hello World 风格的 Google Gadget，并且为周围 iframe 的背景是白色而苦苦挣扎。我无法从皮肤设置中将其设置为透明，也无法将 CSS 添加到我的代码中，如下所示：

```
<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
  <ModulePrefs title="hello world example" /> 
  <Content type="html">
     <![CDATA[ 
       <div id="countdown"></div>
       <script type="text/javascript">
         // Get userprefs

         var element = document.getElementById('countdown');
         var text = '';
          var today = new Date();
          var BigDay = new Date("March 8, 2013");
          var msPerDay = 24 * 60 * 60 * 1000;
          var timeLeft = (BigDay.getTime() - today.getTime());
          var e_daysLeft = timeLeft / msPerDay;
          var daysLeft = Math.floor(e_daysLeft);
          var e_hrsLeft = (e_daysLeft - daysLeft)*24;
          var hrsLeft = Math.floor(e_hrsLeft);
          var minsLeft = Math.floor((e_hrsLeft - hrsLeft)*60);

          element.innerHTML = text + '<span class="number">' + daysLeft + '</span>';

       </script>
       <style rel="text/css">

         body {
       background-color: transparent !important;
     }

    #countdown {
      text-align: center;
      font-size: 60px;
    }

       </style>
     ]]>
  </Content> 
</Module> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:44:45.027

哦，对不起，这只是一个缓存问题，我在这里发布的解决方案确实有效。您只需要等待更多时间才能真正更新...

# .htaccess - 使用 .htaccess 重定向到 404 错误的 php/html 文件

> ID：14838488
> 
> 赞同：6
> 
> 时间：2013-02-12T17:42:22.963
> 
> 标签：.htaccess

例如，我想将所有 404 错误重定向到“404.php”。

我试过`ErrorDocument 404 /404.php`在.htaccess中使用，但没有运气，也许我的其他规则不允许这样做，我不太确定，因为我在www上找不到这个信息。

如果有人知道如何解决这个问题，请大喊：P

我当前的 .htaccess

```
#### pie thingy ####
AddType text/x-component .htc

#### Rule for Error Page - 404 ####
ErrorDocument 404 /404.html

#### url rewriting ####
Options +FollowSymlinks
RewriteEngine on

#### REDIRECT IF NO SUB-DOMAIN ####
RewriteCond %{HTTP_HOST} ^([^.]+)\.([^.]+)$ [NC]
RewriteRule ^(.*)$ http://www.%1.%2/$1 [R=301,L]

#### Remove "www." from any subdomain requests ####
RewriteCond %{HTTP_HOST} ^www\.([^.]+)\.precisehire\.com [NC]
RewriteRule (.*) http://%1.precisehire.com/$1 [R=301,L]

#### Rules for rewriting from PHP to HTML with fallback ####
RewriteCond %{REQUEST_URI} ^/(.*)\.html$
RewriteCond %{DOCUMENT_ROOT}/%1.php -f
RewriteRule ^(.*)\.html$ $1.php [nc] 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-12T18:03:42.943

通过放置错误文档的完整 URL 来解决。

例子：

```
#### Rule for Error Page - 404 ####
ErrorDocument 404 http://www.domain.com/404.html 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-26T16:53:45.167

没有必要提供完整的 URL。您还可以提及绝对路径，例如

```
ErrorCodument 404 /pages/error.php 
```

这比接受的答案更好。

# jquery - 用hammer.js/通过触摸检测div的id

> ID：14838489
> 
> 赞同：0
> 
> 时间：2013-02-12T17:42:30.167
> 
> 标签：jquery, touch, hammer.js

我有一个带有 ID 的图像网格。当用户在移动触摸设备上捏捏时，我想检测用户捏捏的是哪个实例。因此，我不想为每个尝试检测夹点的 ID 创建 30 个锤子实例，而是想以相反的方式检测它。我希望我的问题很清楚。

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:48:47.210

您可以使用`event`-object 来确定当前`target`：

```
$(document).on('touchstart', function(e){
    $(e.target) // this is your element
}); 
```

或者，如果您需要在 上测试它`touchmove`，请使用`elementFromPoint`和手指坐标：

```
$(document).on('touchmove', function(e){
    $( document.elementFromPoint(e.touches[0].pageX, e.touches[0].pageY) ) // this is your element
}); 
```

**更新**

您可以使用`$.event.props.push("touches");`规范化`touches`.

# google-visualization - 为 Google Visualization Geochart 指定纬度和经度，而不是城市名称

> ID：14838494
> 
> 赞同：2
> 
> 时间：2013-02-12T17:42:45.580
> 
> 标签：google-visualization

是否可以为城市指定坐标而不是地理图表的城市名称？[他们文档页面 ( https://developers.google.com/chart/interactive/docs/gallery/geochart](https://developers.google.com/chart/interactive/docs/gallery/geochart) )上的第二张地图使用了城市。

我想指定坐标以便更快地在地图上放置标记。对于大型数据集，指定城市需要更长的时间，因为它必须按名称查找每个城市。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T00:39:18.897

对的，这是可能的。

您必须输入纬度/经度值作为数据表的前 2 个值。

```
data.addColumn('number', 'Lat'); // Latitude Value
data.addColumn('number', 'Lon'); // Longitude Value
data.addColumn('string', 'Name'); // 
data.addColumn('number', 'Value'); // 
data.addColumn({type:'string', role:'tooltip'});

data.addRows([[33.6598257,-85.8316318," City Name",1,"Tooltip info"]]);         
data.addRows([[33.5206608,-86.80249," City Name",2,"Tooltip Info"]]); 
```

我已经成功地创建了带有几十个标记的地图，这些标记可以立即使用这个模型加载。[这是我网站上带有 130 多个标记的美国地图的示例： http](http://cmoreira.net/interactive-world-maps-demo/interactive-map-load-large-number-of-markers/) ://cmoreira.net/interactive-world-maps-demo/interactive-map-load-large-number-of-markers/

希望能帮助到你！

# javascript - 如何在 arbor js 中为每个节点文本添加换行符

> ID：14838497
> 
> 赞同：0
> 
> 时间：2013-02-12T17:42:55.250
> 
> 标签：javascript, canvas, arbor.js

我有一个网络，有 14 个节点，每个节点都有一个标签，还有用于将这些节点相互连接的边。我试图为其中一个节点输入一个长标签，不幸的是，arborjs 似乎只是水平地在节点上显示标签，所以我尝试在标签文本“\n”中添加一个换行符，它会将其呈现为空间，所以我想知道是否有人知道如何在 arbor js 中为节点设置多行标签？这是代码：

```
<script language="javascript" type="text/javascript">
    var sys = arbor.ParticleSystem(1000, 700,0.01);
    sys.parameters({gravity:false});
    sys.renderer = Renderer("#viewport") ;
    var data = {
    nodes:{
    STRUCTURE:{'color':'black','shape':'rect','label':'STRUCTURE', },
    Engineering:{'color':'salmon','shape':'rect','label':'Engineering'},
    Architecture:{'color':'salmon','shape':'rect','label':'Architecture'},
    ArtsSciences:{'color':'salmon','shape':'rect','label':'Arts & Sciences'},
    EarthEnergy:{'color':'salmon','shape':'rect','label':'Earth & Energy'},
    SustainableDesign:s{'color':'lightskyblue','shape':'rect','label':'Sustainable Design'},
    sutabledesignleaf1:{'color':'lawngreen','shape':'rect','label':'Earthen Structures'},
    MaterialsStructures:{'color':'lightskyblue','shape':'rect','label':'Materials & Structures'},
    MaterialsStructuresleaf1:{'color':'lawngreen','shape':'rect','label':'AEROSPACE/MECH. ENGINEERING'},
    LithosphereDynamics:{'color':'lightskyblue','shape':'rect','label':'Lithosphere Dynamics'},
    Energy:{'color':'lightskyblue','shape':'rect','label':'Energy'},
    LithosphereDynamicsleaf1:{'color':'lawngreen','shape':'rect','label':'Structure/Tectonophy'},
    Energyleaf1:{'color':'lawngreen','shape':'rect','label':'Structural Control on Reservoirs'},
    ArtsSciencesleaf1:{'color':'lawngreen','shape':'rect','label':'VARIOUS THEMES Market Structure'},
    },
    edges:{
    STRUCTURE:{ Engineering:{}, Architecture:{} , ArtsSciences:{}, EarthEnergy:{}},
    ArtsSciences:{ArtsSciencesleaf1:{}},
    EarthEnergy:{Energy:{},LithosphereDynamics:{}},
    Energy:{Energyleaf1:{}},
    LithosphereDynamics:{LithosphereDynamicsleaf1:{}},
    Engineering:{MaterialsStructures:{}},
    MaterialsStructures:{MaterialsStructuresleaf1:{}},
    Architecture:{SustainableDesign:{}},
    SustainableDesign:{sutabledesignleaf1:{}}
    }
    };
    sys.graft(data);
        var canvas =  document.selectElementById('viewport') ;  
    var context  =  canvas.getContext('2d');
      context.font = '40pt Calibri';
    context.fillStyle = 'blue';
</script> 
```

假设在这段代码中，对于 STRUCTURE 节点的标签，我们有“STRUCTURE”，但是当我想要一个长文本谎言“kaskdjhkjahdkjhaskjdhjkahskjdhakjshdkjahdkjhaskjdhkjahsdkjhakjsdhkjashdkjhasdkjhkajshdkjhakjdhkajshdk”时，它不会将它分成两行，它会显示为一行，即使我放一个换行符，它会认为它是一个空格，它会在一行中再次显示，感谢任何帮助。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-18T05:53:26.743

我知道这篇文章已经晚了 2 年，尽管我仍然遇到同样的问题并且无法在任何地方找到解决方案。主要问题是画布 fillText 不支持多行。所以你必须在标签上添加多行。诀窍是将返回拆分为一个数组，并为每个新行在数组上循环。

为了保持代码干净，我宁愿不直接编辑文件中的函数。要使多行工作，请将以下函数添加到您的自定义 JS 中，该函数将覆盖 Cytoscape 内部标签呈现。适用于 cytoscape.js 和 cytoscape.min.js

```
//function to override the default label rending to support multiple lines
;(function($$){ 'use strict';
  var CanvasRenderer = $$('renderer', 'canvas');
    CanvasRenderer.prototype.drawText = function(context, element, textX, textY) {
    var style = element._private.style;
    var parentOpacity = element.effectiveOpacity();
    if( parentOpacity === 0 ){ return; }

    var text = this.setupTextStyle( context, element );

    if ( text != null && !isNaN(textX) && !isNaN(textY) ) {

      var lineWidth = 2  * style['text-outline-width'].value; // *2 b/c the stroke is drawn centred on the middle
      if (lineWidth > 0) {
        context.lineWidth = lineWidth;
        context.strokeText(text, textX, textY);
      }

      //START NEW CODE
      //remove old label rendinging
      //context.fillText(text, textX, textY);

      //explode the text into an array split up by line returns
      var lines = text.split("\n");

      //loop through each of the lines
      for (var index = 0; index < lines.length; ++index) {
        //render the multiple lines
        context.fillText(lines[index], textX, (textY + (style['font-size'].pxValue * 1.2 * index)));
      }
      //END NEW CODE
    }
  };

})( cytoscape ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T16:25:37.293

谢谢你的回答，昨晚，我发现不幸的是，canvas fillText() 上没有办法在多行中绘制文本，所以我不得不为此编写包装器，这是我编写的函数，它是现在工作，

```
function wrap_text(var rawstring,var line_width)
                {
                    var strarray  = new Array() ;  
                    var temp_str = new Array() ; 
                    var j = 0 ;var i = 0 ;  
                    strarray = text.split(' ');                 
                    var temp = strarray[j] ;
                    j++;
                    while(j < strarray.length)
                    {
                        while(temp.length <30)
                        {
                            temp = temp+" "+strarray[j];
                            j++;
                        }   
                        temp_str[i]=temp ; i++;
                        var temp = "" ;
                    }
                    return temp_str; 
                }
                var wrap_result = wrap_text('kjakjhkjashd kajasd asdmbdmnad nmauhiqwe kbawem mnbasdm',20);

                for (var i = 0; i <wrap_result.length ; i--) 
                {
                    console.log(wrap_result[i]);
                } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T13:28:47.457

这个问题真的很关心`canvas.fillText()`，而不是 arbor.js，看[这个问题](https://stackoverflow.com/questions/5026961/html5-canvas-ctx-filltext-wont-do-line-breaks)。简而言之，这是`fillText`功能的限制。

也就是说，您可以相对简单地解决这个问题。以下所有内容都假设您基于[“atlas”示例](https://github.com/samizdatco/arbor/blob/master/demos/atlas/atlas.js)进行渲染，但我认为无论如何您都可以从这个想法中弄清楚。

```
 // draw the text
      if (label){
        ctx.font = "bold 11px Arial"
        ctx.textAlign = "center"

        // if (node.data.region) ctx.fillStyle = palette[node.data.region]
        // else ctx.fillStyle = "#888888"
        ctx.fillStyle = "#888888"

        // ctx.fillText(label||"", pt.x, pt.y+4)
        ctx.fillText(label||"", pt.x, pt.y+4)
      } 
```

查看上面的代码，看看文本是如何呈现的。我们可以`ctx.fillText(label||"", pt.x, pt.y+4)`根据您要渲染的多行用循环替换该行。使您的标签值类似于`line 1\nline 2\nline 3`，然后使用[String.split()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)将其制成一个数组，如下所示：

```
var lines = label.split("\n"); 
```

现在，循环`lines`并为每个渲染`ctx.fillText()`一个。如果您的项目密切基于示例，您可能需要调整布局以使其看起来正确，但希望这能让您走上正确的轨道。

# c# - Sharepoint 2013 文件添加和属性创建

> ID：14838501
> 
> 赞同：1
> 
> 时间：2013-02-12T17:43:01.553
> 
> 标签：c#, sharepoint-2013, sharepointdocumentlibrary

作为我们应用程序的要求，我们使用以下方法在文档库中添加具有其他文件属性的文件：

```
private static SPFile AddFile(SPListItem item, Stream stream, string filename, SPFolder destinationFolder, string comment)
        {
            string destinationFilePath = destinationFolder.Url + "/" + filename;
            using (var web = item.Web)
            {
                object file;
                switch (SPFarm.Local.BuildVersion.Major)
                {
                    case 12:
                        var parameters2007 = new object[] { destinationFilePath, stream, false, item.File.Author, web.CurrentUser, item.File.TimeCreated, item.File.TimeLastModified, null, comment, true };
                        file = destinationFolder.Files.GetType().GetMethod("AddInternal", BindingFlags.NonPublic | BindingFlags.Instance, null, new Type[] { typeof(string), typeof(Stream), typeof(Boolean), typeof(SPUser), typeof(SPUser), typeof(DateTime), typeof(DateTime), typeof(Hashtable), typeof(string), typeof(Boolean) }, null).Invoke(destinationFolder.Files, parameters2007);
                        break;
                    default:
                    case 14:
                        var parameters2010 = new object[] { destinationFilePath, stream, null, item.File.Author, web.CurrentUser, item.File.TimeCreated, item.File.TimeLastModified, comment, true };
                        file = destinationFolder.Files.GetType().GetMethod("Add", BindingFlags.Public | BindingFlags.Instance, null, new Type[] { typeof(string), typeof(Stream), typeof(Hashtable), typeof(SPUser), typeof(SPUser), typeof(DateTime), typeof(DateTime), typeof(string), typeof(Boolean) }, null).Invoke(destinationFolder.Files, parameters2010);
                        break;
                }
                return file as SPFile;
            }
        } 
```

我们使用反射的原因是，我们需要在创建文件时覆盖文件的**created_by**和**modified_by属性；**事实证明，用其他方法来做这件事是非常痛苦的。Sharepoint 2007 的 API 仅限于实现这一点，因此需要反思。

有一种情况**web.CurrentUser**是共享点**/系统**（通常是因为上下文处于提升状态），只要它用于**modified_by**就可以了。但是，在 Sharepoint 2013 中，**SPFileCollection.Add**方法不会覆盖**created_by**属性，它只是将其保留为**CurrentUser**（独立于 modified_by 参数），无论我们如何处理它。结果弄乱了我们应用程序的整个工作流程。

我使用反射器检查了 Sharepoint 2013 的 dll 文件，似乎方法及其参数与 2010 相同。

创建文件后更新属性是我想避免的，因为我对它有不好的记忆。通常解决一个问题会产生多个问题，我不记得详细的问题。更不用说这种变化需要在 3 个不同的版本中进行广泛的测试。

是否有一种功能性方法可以使用 SPFileCollection.Add 在 Sharepoint 2013 上覆盖文件的**created_by属性？**

# c# - 为什么我的方法不起作用？

> ID：14838503
> 
> 赞同：0
> 
> 时间：2013-02-12T17:43:12.533
> 
> 标签：c#

我有一个带有 a 的表单`listView`，它是通过调用该`showCheckedInFiles()`方法来填充的。当我向表单添加一个简单的按钮并按下它时，该方法工作得非常好，这会调用该方法，但是当我从其他地方调用该方法时，它不会填充我的`listview`.

请帮助它让我发疯。下面的第一个方法是从另一个类调用的，它显示在下面，我也包含了按钮方法以供参考，正如我所说，按钮工作得很好，但我需要能够在不单击的情况下调用该方法一个按钮！！：

```
public void openProject(string projectname)
{
    projectName = projectname;
    string userDir = CSDBpath + projectname + "\\checkedOUT\\" + userName;
    if (!Directory.Exists(userDir)) //Does the user's directory exist, if not, create it
    {
        Directory.CreateDirectory(userDir);
    }
    showCheckedInFiles();
 }

 private void button3_Click(object sender, EventArgs e)
 {
    showCheckedInFiles();
 } 
```

调用上述方法的方法：

```
private void buttonOpenProject_Click(object sender, EventArgs e)
{
     ListView.SelectedListViewItemCollection mySelectedItems;
     mySelectedItems = listView1.SelectedItems;
     Form1 mainform = new Form1();
     string myProject = "";

     foreach (ListViewItem item in mySelectedItems)
     {
         myProject = item.Text;
     }

     mainform.openProject(myProject);
     //mainform.showCheckedInFiles();
     this.Close();
 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T17:45:20.943

在`buttonOpenProject_Click`您创建一个新的隐藏实例，`Form1`该实例与已经显示的显然已经存在的实例无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:30:56.907

将 ShowCheckInFiles 方法移动到一个单独的类并作为参数传递到列表视图中。这应该允许您使用该方法，无论您在哪里调用它。

例如...

SomeClass.ShowCheckInFIles(listview1);

# php - Facebook API - 认识家乡的朋友

> ID：14838504
> 
> 赞同：0
> 
> 时间：2013-02-12T17:43:15.737
> 
> 标签：php, facebook, facebook-graph-api

我想检索我所有朋友的家乡，我正在使用与检索他们姓名类似的 PHP。我认为我使用的代码*应该可以*工作，但我认为因为有些用户没有设置家乡，所以它不会工作，并说 for each 参数是无效的（尽管这可能是完全错误的）。

只需在 Web 浏览器中输入 URL 时，我会得到以下结构：

```
{
   "id": "z",
   "friends": {
      "data": [
        {
            "name": "x",
            "hometown": {
               "id": "x",
               "name": "x"
            },
            "id": "x"
         }, 
```

然后对朋友列表中的每个用户重复此操作，尽管对于没有家乡的朋友，以下内容被省略：

```
"hometown": {
             "id": "x",
             "name": "x"
                }, 
```

为了检索姓名和生日，我使用了以下 PHP：

* * *

```
$response2 = curl_exec($ch2);
$user2 = json_decode($response2, true);
$user3=$user2{'friends'};
$user4=$user3['data'];
echo ("<h2>Friend List</h2><br>");
foreach($user4 as $friend) {
    echo $friend["name"] . "<br />" . $friend["birthday"] . "<br /><br />";
    }
} 
```

PS我知道变量名不是特别好，但是一旦我弄清楚我为家乡做了什么，我就会改变它们！

非常感谢您提前提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:10:25.483

不是每个人都将他们的家乡或位置提供给他们的朋友。在这种情况下，您将无法通过 API 获取数据，因此需要进行检查。

为了获得比仅仅查询家乡更多的数据，我们还读出了 current_location。

通过 Graph API，您将使用此资源：`https://graph.facebook.com/me/friends?fields=hometown,location`

如果您使用 FQL，则可以使用如下查询：

```
SELECT uid, first_name, last_name, current_location, hometown_location, friend_count, mutual_friend_count FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) 
```

请记住，您需要`friends_location`和`friends_hometown`权限才能读取这些字段。

# selenium - SVG Selenium 点击不起作用

> ID：14838515
> 
> 赞同：1
> 
> 时间：2013-02-12T17:44:19.870
> 
> 标签：selenium, svg, click, action, crossfilter

我想模拟一个简单的鼠标单击并在 svg 元素中拖动。我设法获得了起点和终点的坐标，包括绝对（窗口坐标）和相对于封装 svg 元素的坐标。这是我用来模拟鼠标的代码：

```
 Actions builder = new Actions(driver);
    builder.moveToElement(area, xStart, yStart);
    builder.clickAndHold();
    builder.moveToElement(area, xStop, yStop);
    builder.release();

    Action setFilter = builder.build();
    setFilter.perform(); 
```

其中 area 是代表我的 svg 的 WebElement，坐标相对于该元素。注意：

```
 area.getLocation(); // returns null 
```

这让我想知道 webdriver 是否能够找到该元素。所以我尝试了绝对坐标：

```
 Actions builder = new Actions(driver);
    builder.moveByOffset(chart.getLocation().x + xStart, chart.getLocation().y + yStart);
    builder.clickAndHold();
    builder.moveByOffset(xStop - xStart, yStop - yStart);
    builder.release();

    Action setFilter = builder.build();
    setFilter.perform(); 
```

其中 chart 是围绕 svg 元素的 div（请注意，div 位置和 svg 位置之间的偏移量仅为 10 像素，并不重要）。那也不起作用，我也尝试了与 div 的相对位置，但仍然没有运气。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T09:18:10.180

我得到了一个破解它的工作，但它需要在前台打开网页。如果您同时做其他事情，它可能会破坏测试，我不能说如果远程运行它是否会起作用。

这是它的样子：

```
 Robot robert = new Robot();
  robert.mouseMove(xStart, yStart);
  // full click once to get focus on the window
  robert.mousePress(MouseEvent.BUTTON1_MASK);
  robert.mouseRelease(MouseEvent.BUTTON1_MASK);
  // then set the filter
  robert.mousePress(MouseEvent.BUTTON1_MASK);
  robert.mouseMove(xStop, yStop);
  robert.mouseRelease(MouseEvent.BUTTON1_MASK); 
```

# php - PHPUnit 存根仅适用于第一种方法

> ID：14838517
> 
> 赞同：1
> 
> 时间：2013-02-12T17:44:30.253
> 
> 标签：php, phpunit

我正在尝试存根 Amazon 的实例元数据类，因为它调用的内部 URL 仅在 EC2 实例中有效，不能从外部调用。我的问题是无法识别“发送”方法。不过，“get”方法工作得很好。这是错误`Fatal error: Call to undefined method Stub\Amazon\StubInstanceMetadata::send() in ...etc, etc`

```
 $stub = $this->getMockBuilder('Aws\Common\InstanceMetadata\InstanceMetadataClient')
                 ->disableOriginalConstructor()
                 ->getMock();

    $stub->expects($this->any())
         ->method('get')
         ->will($this->returnValue($this));

    $stub->expects($this->any())
         ->method('send')
         ->will($this->returnValue(json_encode(array('test' => 'value')))); 
```

编辑：这最终是两个不同问题的组合。第一个是@fab 指出的。第二个是返回对 $this 的引用，PHPUnit 有它自己的方法，所以我应该这样做：

```
 $stub->expects($this->any())
         ->method('get')
         ->will($this->returnSelf()); // don't use returnValue() here 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:48:24.313

我不知道原始类，但它看起来`send`实际上不是它的方法，而是通过 magic 调用`__call`。所以如果你想模拟它，你必须明确地做：

```
...->getMock(array('get', 'send')); 
```

# java - 使用 java swing table 更新 MySQL 数据库值

> ID：14838518
> 
> 赞同：0
> 
> 时间：2013-02-12T17:44:35.573
> 
> 标签：java, mysql, swing, jtable, tablemodel

该程序用于从数据库中读取数据。数据库中有pki17、pki18、pkn18三个表。为了查看不同的表格，使用了 JComboBox，它通过更改表格的 TableModel 来工作。同样通过使用 tableChanged 方法，我使表格可编辑。当表中的单元格值发生更改时，数据库中的相应值必须更改为。

当我同时使用 tableChanged 和 actionPerformed 方法时，当我在摆动表中编辑单元格时，数据库中的值不会改变。当我删除 actionPerformed 方法时，我可以通过编辑表格单元格来更新数据库。

我需要同时具备这两种能力，使用 JComboBox 从数据库中选择一个表，并通过编辑摆动表中的值来更新数据库值。

我认为问题的存在是因为表的 TableModel 在这两种方法中都发生了变化。但我不知道如何解决它。

```
public class TableCombobox extends JPanel implements ActionListener, TableModelListener  {
static JTable table;
static JComboBox box;
static MyTableModel model;
static Connection con = null;
static Statement stmt = null;

public TableCombobox() throws SQLException {
    super(new BorderLayout());
    table = new JTable(new MyTableModel("pki18"));
    table.setPreferredScrollableViewportSize(new Dimension(500, 400));
    table.setFillsViewportHeight(true);
    table.getModel().addTableModelListener(this);

    JScrollPane scrollPane = new JScrollPane(table);

    JPanel menuPanel = new JPanel();
    menuPanel.setLayout(new BoxLayout(menuPanel, BoxLayout.Y_AXIS));
    menuPanel.setBorder(BorderFactory.createMatteBorder(0, 0, 0, 1,
            Color.black));

    String[] dalykas = { "Chose groop", "pki17", "pki18", "pkn18" };
    box = new JComboBox(dalykas);
    box.setMaximumSize(new Dimension(150, 25));
    box.setAlignmentX(Component.LEFT_ALIGNMENT);
    box.addActionListener(this);
    box.setSelectedIndex(2);

    menuPanel.add(box);

    JPanel cards = new JPanel(new CardLayout());
    cards.add(scrollPane, "view");
    add(menuPanel, BorderLayout.LINE_START);
    add(cards, BorderLayout.CENTER);
}
public void tableChanged(TableModelEvent e) {
    int row = e.getFirstRow();
    int col = e.getColumn();
    model = (MyTableModel) e.getSource();
    String stulpPav = model.getColumnName(col);
    Object data = model.getValueAt(row, col);
    Object studId = model.getValueAt(row, 0);
    System.out.println("tableChanded works");
    try {
        new ImportData(stulpPav, data, studId);
    } catch (ClassNotFoundException e1) {
        e1.printStackTrace();
    } catch (SQLException e1) {
        e1.printStackTrace();
    }
}

public void actionPerformed(ActionEvent event) {        
        JComboBox cb = (JComboBox) event.getSource();
        String pav = (String) cb.getSelectedItem();
        if (pav != "Chose groop") {
            try {
                model = new MyTableModel(pav);
                table.setModel(model);
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }

private static void GUI() throws SQLException {
    JFrame frame = new JFrame("E-gradebook");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setContentPane(new TableCombobox());
    frame.pack();
    frame.setSize(800, 400);
    frame.setVisible(true);
}

public static void main(String[] args) throws SQLException {
    try {

        Class.forName("com.mysql.jdbc.Driver");
        con = DriverManager.getConnection("jdbc:mysql://localhost/pki18",
                "root", "");
        GUI();
    } catch (SQLException e) {
        e.printStackTrace();
    } catch (ClassNotFoundException e1) {
        e1.printStackTrace();
    } finally {
        if (stmt != null)
            stmt.close();
    }
}

static Connection getConnection() {
    return con;
}
}

public class ImportData {
static Connection con = TableCombobox.getConnection();

public ImportData(String a, Object b, Object c)
        throws ClassNotFoundException, SQLException {
    Statement stmt = null;
    try {

        String stulpPav = a;
        String duom = b.toString();
        String studId = c.toString();
        System.out.println(duom);
        con.setAutoCommit(false);
        stmt = con.createStatement();
        stmt.addBatch("update pki18 set " + stulpPav + " = " + duom
                + " where studento_id = " + studId + ";");
        stmt.executeBatch();
        con.commit();
    } catch (BatchUpdateException e) {
        e.printStackTrace();
    } catch (SQLException e) {
        e.printStackTrace();
    } finally {
        if (stmt != null)
            stmt.close();
        con.setAutoCommit(true);
        System.out.println("Data was imported to database");
    }
}   
}

public class MyTableModel extends AbstractTableModel{
static int rowCount;
static Object data [][];
static String columnNames [];

public  MyTableModel(String grupName) throws SQLException{
    String query ="select Studento_id, vardas_pavarde, 1_semestras,"+
            " 2_semestras, egzaminas, bendras_balas "+
            "from pki18." + grupName;

    ResultSet rs ;
    Connection con = TableCombobox.getConnection();

    Statement stmt = null;
    stmt = con.createStatement();
    rs = stmt.executeQuery(query);

    rs.last();
    rowCount = rs.getRow();
    data = new Object[rowCount][6];
    rs = stmt.executeQuery(query);
    for (int iEil = 0; iEil < rowCount; iEil++){
        rs.next();                  
        data[iEil][0] = rs.getLong("Studento_id");
        data[iEil][1] = rs.getString("Vardas_Pavarde");
        data[iEil][2]  = rs.getByte("1_semestras");
        data[iEil][3] = rs.getByte("2_semestras");
        data[iEil][4]  = rs.getByte("Egzaminas");
        data[iEil][5] = rs.getByte("bendras_balas");                    
    }

     String[] columnName  = {"Asmens_kodas","Vardas_Pavarde","1_Semestras"
            ,"2_Semestras","Egzaminas","Bendras_Balas"};
     columnNames = columnName;
}   
public int getColumnCount(){
    return columnNames.length;
}
public int getRowCount(){
    return data.length;
}
public String getColumnName(int col){
    return columnNames[col];
}
public Object getValueAt(int row, int col){
    return data[row][col];
}
public Class getColumnClass(int col){
    return getValueAt(0, col).getClass();
}
public boolean isCellEditable(int row, int col){
    return true;
}
public void setValueAt(Object value, int row, int col){
    data[row][col] = value;
    fireTableCellUpdated(row, col);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T19:56:10.577

在构造函数中，您仅将表模型侦听器添加到当前模型：

> ```
> table.getModel().addTableModelListener(this); 
> ```

但是，在 action 事件中，您替换了表模型：

> ```
> model = new MyTableModel(pav);
> table.setModel(model); 
> ```

因此，新表模型将没有侦听器，您将不再收到通知。让该`actionPerformed`方法也添加侦听器，您的问题应该得到解决。

# wpf - 如何设置 WPF ListView 选定项颜色？

> ID：14838524
> 
> 赞同：14
> 
> 时间：2013-02-12T17:44:57.183
> 
> 标签：wpf, listview, styles, background-color, listviewitem

我正在尝试在 Windows 7 上运行的 WPF 应用程序中从 Windows 8 重新创建邮件 UI。这是我想要实现的目标：

![目标用户界面](../Images/f2334f178f16890401d91fdee440e6b6.png)

特别是，我不知道如何更改所选项目的背景颜色，例如第一列中的收件箱项目和第二列中来自 Twitter 的邮件。我已经尝试了其他类似 Stackoverflow Questions 的几种解决方案，但似乎没有一个对我有用。例如

[焦点在 WPF 列表框中移出时，所选项目失去样式](https://stackoverflow.com/questions/1462232/selected-item-loses-style-when-focus-moved-out-in-wpf-listbox)

[WPF ListView 非活动选择颜色](https://stackoverflow.com/questions/382006/wpf-listview-inactive-selection-color/382162#382162)

这是我的列表视图的代码：

```
<ListView Grid.Row="0" SelectedItem="{Binding Path=SelectedArea}" ItemsSource="{Binding Path=Areas}" Background="#DCE3E5" >

                    <ListView.Resources>

                        <!-- Template that is used upon selection of an Area -->
                        <ControlTemplate x:Key="SelectedTemplate" TargetType="ListViewItem">
                            <Border Background="#388095" Cursor="Hand" >
                                <TextBlock Text="{Binding Name}" Margin="5" />
                            </Border>                                
                        </ControlTemplate>

                        <Style TargetType="ListViewItem">
                            <Setter Property="Template">
                                <Setter.Value>                                        
                                    <!-- Base Template that is replaced upon selection -->
                                    <ControlTemplate TargetType="ListViewItem">
                                        <Border Background="#DCE3E5" Cursor="Hand"  >
                                            <TextBlock Text="{Binding Name}" Margin="5" />
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Style.Triggers>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsSelected" Value="true" />
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Template" Value="{StaticResource SelectedTemplate}" />
                                </MultiTrigger>
                            </Style.Triggers>
                        </Style>

                    </ListView.Resources>                        

                </ListView> 
```

如何更改所选项目的背景颜色？以及如何在焦点变化时保留颜色变化。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-12T18:59:44.683

我最近做了类似的事情：

```
<ListView.Resources>                
    <ControlTemplate x:Key="SelectedTemplate" TargetType="ListViewItem">
        <Border CornerRadius="5" BorderThickness="1" BorderBrush="DarkGray" Background="#FF92C6F9" Padding="2" HorizontalAlignment="Left" Margin="5" Tag="{Binding Value}" Cursor="Hand" MouseUp="Border_MouseUp_1">                        
            <TextBlock Text="{Binding Name}" Margin="5" />
        </Border>
    </ControlTemplate>
    <Style TargetType="ListViewItem">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListViewItem">
                    <Border CornerRadius="5" BorderThickness="1" BorderBrush="DarkGray" Background="WhiteSmoke" Padding="2" HorizontalAlignment="Left" Margin="5" Tag="{Binding Value}" Cursor="Hand" MouseUp="Border_MouseUp_1" >                                    
                        <TextBlock Text="{Binding Name}" Margin="5" />
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected" Value="true" />
                    <Condition Property="Selector.IsSelectionActive" Value="true" />
                </MultiTrigger.Conditions>                            
                <Setter Property="Template" Value="{StaticResource SelectedTemplate}" />                            
            </MultiTrigger>
        </Style.Triggers>
    </Style>
</ListView.Resources> 
```

我相信删除：

```
<Condition Property="Selector.IsSelectionActive" Value="true" /> 
```

将允许您在失去焦点后保持背景颜色。

**编辑：**

在下面回答您的问题：

可以将 TextBlock 的 tag 属性绑定到 command 参数，然后在 TextBlock 的 MouseUp 事件上执行命令：

```
<TextBlock x:Name="MyTextBlock" Text="Click Me!" Tag="{Binding MyCommandParameter}" MouseUp="MyTextBlock_MouseUp" /> 
```

在后面的代码中：

```
 private void MyTextBlock_MouseUp(object sender, MouseButtonEventArgs e)
    {
        TextBlock tb = sender as TextBlock;

        if (tb != null && tb.Tag != null)
        {
            ViewModel.MyCommand.Execute(tb.Tag);
        }            
    } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-11-11T04:26:09.950

只是添加到“TrueEddie”点。

另一个选项是 ListView 中的“ItemContainerStyle”。

```
 <ListView Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" 

                  BorderThickness="0" 
                     ItemContainerStyle="{StaticResource ListViewSmartNotes}"
                  SelectedItem="{Binding SelectedSmartNotes, Mode=TwoWay}"
                  ItemsSource="{Binding LstSmartNotes, Mode=TwoWay}" 
                  ItemTemplate="{DynamicResource ListViewItemOptionStyle}">

        </ListView> 
```

Style.xml 中定义的 ListViewItemOptionStyle

```
<Style x:Key="ListViewItemOptionStyle" TargetType="ListViewItem">
        <Setter Property="Template">
            <Setter.Value>
                <!-- Trun off default selection-->
                <ControlTemplate TargetType="{x:Type ListViewItem}">
                    <Border x:Name="Bd" BorderBrush="Gray" BorderThickness="0,1,0,1" 
                            Background="{TemplateBinding Background}" 
                            Padding="{TemplateBinding Padding}" 
                            SnapsToDevicePixels="true">
                        <ContentPresenter 
                            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                            VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground"
                                    Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
        </Setter.Value>
        </Setter>
    <Style.Triggers>
        <MultiTrigger>
            <MultiTrigger.Conditions>
                <Condition Property="IsSelected" Value="True" />
            </MultiTrigger.Conditions>
            <MultiTrigger.Setters>
                <Setter Property="Background" Value="Green" />
                <Setter Property="BorderBrush" Value="Green" />
                <Setter Property="Foreground" Value="White"/>
            </MultiTrigger.Setters>
        </MultiTrigger>
    </Style.Triggers>
</Style> 
```

更多详情

[https://sites.google.com/site/greateindiaclub/mobil-apps/windows8/wpfimportantbindings](https://sites.google.com/site/greateindiaclub/mobil-apps/windows8/wpfimportantbindings)

# c - 尝试从文本文件中读取数据，从中创建结构，并将字段打印到标准输出

> ID：14838526
> 
> 赞同：1
> 
> 时间：2013-02-12T17:45:00.820
> 
> 标签：c, struct, segmentation-fault, fgets

我似乎没有问题从文件中读取然后创建结构，但是打印结构会给我一个分段错误。

员工定义

```
struct _Employee {
  int salary; // Monthly salary in UK pounds sterling
  char *name; // Pointer to character string holding name of employee.
  char* department;           // MUST be dynamically allocated from the heap.
};

typedef struct _Employee Employee; 
```

从文件中读取的函数

```
Employee* readfile(FILE* file) {
  Employee* newemployee;
  newemployee = malloc(sizeof(Employee));
  char tempsalary[10];
  int salary;
  char name[20];
  char dept[20];
  char* names = malloc(sizeof(name));
  char* depts = malloc(sizeof(dept));
  char* status; // Returned by fgets(). Will be NULL at EOF

    status = fgets(names, sizeof(name), file);
    if (status == NULL)
      return NULL;
    else {
      newemployee->name = strdup(status);

    fgets(tempsalary, sizeof(name), file);
    sscanf(tempsalary, "%d", &salary);
    newemployee->salary = salary;

    fgets(depts, sizeof(dept), file);
    newemployee->department = strdup(depts);

    return newemployee;
    }
} 
```

打印由 readfile 生成的结构的函数。

```
void printEmployee(Employee *employee) {
      fprintf(stdout, "Name = %sSalary = %d\nDepartment = %s\n\n", // SEGFAULT HERE
          employee->name, employee->salary, employee->department);
} 
```

主程序

```
int main() {
  FILE* file;
  file = fopen ("stest2.txt", "r");
  Employee* employees[max_employees];
  int i;
  int c;
  Employee* temp;

    for (i = 0; i < max_employees; i++) {
    employees[i] = readfile(file)   
    printEmployee(employees[i]);
    }
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:58:16.857

我将不得不在堆栈上涂鸦 fgets()。改变这个：

```
 fgets(tempsalary, sizeof(name), file); 
```

对此：

```
 fgets(tempsalary, sizeof(tempsalary), file); 
```

可能不是问题，但肯定是“一个”问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:06:03.447

如果 fgets 错误，readfile() 可以返回 NULL。这种情况主要不处理。作为一个原始建议：

```
 for (i = 0; i < max_employees; i++) {
        employees[i] = readfile(file);
        if(NULL != employees[i])
        {   
            printEmployee(employees[i]);
        }
        else
        {
            printf("Error reading file");
        } 
```

# java - 在 Eclipse 中的 JBoss 中启动项目

> ID：14838529
> 
> 赞同：0
> 
> 时间：2013-02-12T17:45:09.653
> 
> 标签：java, eclipse, jboss

我继承了一个我想在 JBoss 中测试的项目——问题是我无法在 Eclipse 中启动它。它在 Eclipse 之外工作，但我必须进行 maven 构建，将 WAR 文件部署到 JBoss 并在每次进行更改时重新启动 JBoss，这是一场噩梦。

在 Eclipse 中，我添加了一个 JBoss 6 服务器，启动它似乎很好（即控制台中没有错误），然后我尝试运行 2 个应用程序（一个服务器然后一个客户端） - 但是没有任何内容打印到控制台日志- 没有错误或任何东西。它说几乎立即开始。只是在访问时收到 404 错误`localhost:8080/name address`。

我知道这可能很难有人在这里帮助我，因为没有错误消息，但如果有人有任何建议或建议，将不胜感激。我原以为这应该很简单，但不知道我做错了什么......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:48:26.857

Eclipse 可能正在运行 JBoss 服务器，因此它侦听不同的端口。该端口或 8080 端口已经绑定，因此 Eclipse 无法打开它。

尝试在 Eclipse 中配置 JBoss 项目，使其侦听不同的端口。

[编辑]
这是 jboss.org 上的一个线程，讨论[了在 Eclipse 中运行时更改 JBoss 使用的端口](https://community.jboss.org/thread/81002?_sscc=t)。

# java - Android ListView - 数组中的项目[JSON]

> ID：14838534
> 
> 赞同：1
> 
> 时间：2013-02-12T17:45:15.223
> 
> 标签：java, android, android-listview

如何从数组中添加 listView（在我的布局上）的项目？我尝试了多次，但每次~~我得到错误：`System services not avaliable before onCreate.();`。是的，我知道当我尝试访问时会显示这个 er.ror `ArrayAdapter`。几乎什么都试过了。.完整代码在这里：[pastebin.com/Nv5BkcS7](http://pastebin.com/Nv5BkcS7)~~

**更新**

我遵循了其他一些教程。我的代码现在可以工作，但没有数据。[http://pastebin.com/D8UFKC7i](http://pastebin.com/D8UFKC7i)和 xml [http://pastebin.com/mJfwjGcB](http://pastebin.com/mJfwjGcB) 有人能告诉我为什么它不起作用吗？调试器说数组有全部

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:54:27.970

您的 onCreate() 方法在 addcontacts 活动中为空白，这就是问题所在：

```
public class addcontacts extends ListActivity {

                 protected void onCreate() {
                      //set content here                       
                      setContentView(R.layout.activity_add_contact);
                 }
                 ...
   ... 
```

并且不要忘记在 Layout 文件夹中创建 activity_add_contact.xml

内容：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ListView
      android:id="@android:id/list"
      android:layout_width="match_parent"
      android:layout_height="wrap_content" >
    </ListView>  

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T15:41:13.980

1.创建自定义适配器扩展BaseAdpter或ArrayAdpter并在构造函数中传递数组或ArrayList。

2.在布局中创建视图（行）

3.在自定义Adapter的getview函数中膨胀这个xml并设置数据。

活动 XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
>
<ListView
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:id="@+id/lstText"
/>
</LinearLayout> 
```

列表行 XML（在布局 row.xml 中）

```
 <?xml version="1.0" encoding="utf-8"?>
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          android:layout_width="fill_parent" android:layout_height="fill_parent">
  <LinearLayout
   android:orientation="vertical"
   android:layout_width="fill_parent" 
   android:layout_height="fill_parent">

    <TextView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:id="@+id/txtAlertText" />

  </LinearLayout>
 </LinearLayout> 
```

在您的活动中创建适配器类

```
 class JSONAdapter extends BaseAdapter implements ListAdapter {

private final Activity activity;
private final JSONArray jsonArray;
private JSONAdapter (Activity activity, JSONArray jsonArray) {
    assert activity != null;
    assert jsonArray != null;

    this.jsonArray = jsonArray;
    this.activity = activity;
}

@Override public int getCount() {
    if(null==jsonArray) 
     return 0;
    else
    return jsonArray.length();
}

@Override public JSONObject getItem(int position) {
     if(null==jsonArray) return null;
     else
       return jsonArray.optJSONObject(position);
}

@Override public long getItemId(int position) {
    JSONObject jsonObject = getItem(position);

    return jsonObject.optLong("id");
}

@Override public View getView(int position, View convertView, ViewGroup parent) {
    if (convertView == null)
        convertView = activity.getLayoutInflater().inflate(R.layout.row, null);

    TextView text =(TextView)convertView.findViewById(R.id.txtAlertText);

                JSONObject json_data = getItem(position);  
                if(null!=json_data ){
                String jj=json_data.getString("f_name");
                text.setText(jj); 
               }

     return convertView;
}
 } 
```

然后将其添加到您的活动中。

```
 public class main extends Activity {
/** Called when the activity is first created. */

ListView lstTest;
//Array Adapter that will hold our ArrayList and display the items on the ListView
JSONAdapter jSONAdapter ;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    //Initialize ListView
    lstTest= (ListView)findViewById(R.id.lstText);

    jSONAdapter = new JSONAdapter (main.this,jArray);//jArray is your json array 

    //Set the above adapter as the adapter of choice for our list
    lstTest.setAdapter(jSONAdapter );

} 
```

你完成了。

# java - 通过线程具有多客户端的服务器

> ID：14838535
> 
> 赞同：4
> 
> 时间：2013-02-12T17:45:16.463
> 
> 标签：java, networking, tcp, game-development

我遇到了一些麻烦，现在我查看了本教程 [http://docs.oracle.com/javase/tutorial/networking/sockets/clientServer.html](http://docs.oracle.com/javase/tutorial/networking/sockets/clientServer.html) 本教程为您提供了一个可以连接多个客户端的服务器，当他们连接到服务器时，他们被告知要进行敲门作业，现在我了解了如何传输数据以及什么不是，但是线程如何工作？

我正在开发一个网络乒乓球游戏，其中服务器将持有位置并将它们传递给客户端，现在我有一个连接到服务器的客户端并将球的位置传递给客户端，工作正常，有点跳跃，但我'确定带有 .sleep 的线程会有所帮助。但无论如何我的问题是，我怎样才能让我的客户成为一个线程？我该如何存储它们？

例如这里是敲敲服务器的多线程类

```
package knockKnockServer;

import java.net.*;
import java.io.*;

public class KKMultiServerThread extends Thread {
private Socket socket = null;

public KKMultiServerThread(Socket socket) {
super("KKMultiServerThread");
this.socket = socket;
}

public void run() {

try {
    PrintWriter out = new PrintWriter(socket.getOutputStream(), true);
    BufferedReader in = new BufferedReader(
                new InputStreamReader(
                socket.getInputStream()));

    String inputLine, outputLine;
    KnockKnockProtocol kkp = new KnockKnockProtocol();
    outputLine = kkp.processInput(null);
    out.println(outputLine);

    while ((inputLine = in.readLine()) != null) {
    outputLine = kkp.processInput(inputLine);
    out.println(outputLine);
    if (outputLine.equals("Bye"))
        break;
    }
    out.close();
    in.close();
    socket.close();

} catch (IOException e) {
    e.printStackTrace();
}
}
} 
```

在我们拥有的服务器中

```
package knockKnockServer;

import java.net.*;
import java.io.*;

public class MultiKKServer {
public static void main(String[] args) throws IOException {
    ServerSocket serverSocket = null;
    boolean listening = true;

    try {
        serverSocket = new ServerSocket(4444);
    } catch (IOException e) {
        System.err.println("Could not listen on port: 4444.");
        System.exit(-1);
    }

    while (listening)
    new KKMultiServerThread(serverSocket.accept()).start();

    serverSocket.close();
}
} 
```

现在查看服务器，它将在每个连接上创建一个新的 KKMultiServerThread，但我该如何存储它们？我可以制作一个 KKMultiServerThread 数组吗？我试图制作一个 KKMultiServerThread 数组，当我尝试这条线时

```
multi[0] = new KKMultiServerThread(serverSocket.accept()).start(); 
```

我收到此错误“无法将 void 转换为线程”如果有人能对我的问题有所了解，那就太好了。

帆布

更新

我现在有自己的线程类

```
package Pong;

import java.net.*;
import java.io.*;

public class PongPlayerThread extends Thread 
{
private Socket socket = null;
private String pongData = "";

public PongPlayerThread(Socket socket, int id) 
{
    super("PongPlayerThread");
    this.socket = socket;
}

public void passData(String data)
{
    pongData = data;
}

public void run()
{
    try
    {
        PrintWriter out = new PrintWriter(socket.getOutputStream(), true);
        while(true)
        {
            out.println(pongData);
        }
    }
    catch (IOException e) 
    {
        e.printStackTrace();
    }
}

} 
```

pongData 是一个将所有信息保存在一个字符串中的字符串，现在如果我像这样在我的 pong 服务器顶部声明一个 player1

```
private static PongPlayerThread player1; 
```

听的时候做这条线

```
 while(listen)
    {
        PongPlayerThread player1 = new PongPlayerThread(serverSocket.accept(), 0).start();
    } 
```

它给了我这个错误“无法从 void 转换为 PongPlayerThread”我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:51:47.627

当客户端连接到服务器时。服务器通常会专门为该客户端创建一个新线程。这是一些伪代码：

```
WHILE SERVER IS RUNNING

SERVER WAITS FOR A CLIENT TO CONNECT
SERVER ACCEPTS THE CLIENT IF THERE IS ENOUGH MEMORY TO CREATE A NEW THREAD
SERVER CREATES A NEW THREAD ROUTINE FOR THE CLIENT PASSING THE CLIENT INFORMATION TO THE THREAD
SERVER CONTINUES TO LISTEN WHILE EACH THREAD IS SPECIFICALLY TAILORED FOR THE CLIENTS

REPEAT 
```

您问需要哪些步骤来减少延迟？对于初学者来说，设置最大允许连接数。您不希望 5000 个客户端拥有自己的线程。除非您的机器可以处理所有这些并且仍然可以运行。使用 UDP 而不是 TCP，数据压缩尽量减少带宽，不要一次发送 50 GB 的信息；如果您只需要发送几个字节的信息。尝试以字节而不是字符串的形式发送位置信息。例如，您可以将位置 X=5Y=0 发送为 50，并将第一个十进制数字解析为 X，将第二个十进制数字解析为 Y。

而不是在线程例程中传递客户端套接字，而是传递客户端的唯一标识符。由于 Pong 是两个玩家，因此限制了对两个客户端的连接。玩家 1 为 0，玩家 2 为 1。所以

```
new KKMultiServerThread(clientID).start(); // clientID is of type int 
```

**编辑：**

```
int id = 0;
while(serverIsRunning)
{
    Client client = server.accept();
    if (id > 2) client.Close(); // Do not accept.
    Thread.New(id).Start();
    id++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:55:32.080

您的数组声明缺少对象类型

```
KKMultiServerThread multi[0] = new KKMultiServerThread(serverSocket.accept()).start(); 
```

为什么要打扰呢？除非线程需要相互通信，否则让线程自由运行是可以的。就服务器而言，Run() 方法定义了套接字的整个生命周期。每个线程都有一个单独的游戏状态副本（只要您不使用静态），并且无需任何额外干预即可愉快地与客户端通信。

在这种情况下，Java 中的 Socket/Thread 库正在帮您一个大忙，除非您有特殊需要，否则不要让它变得更复杂。

# android - 逐个像素的图像处理需要很长时间

> ID：14838538
> 
> 赞同：0
> 
> 时间：2013-02-12T17:45:20.480
> 
> 标签：android, image, algorithm

我正在编写一个逐像素处理图像的Android应用程序。为了读取和设置像素，我使用了两个嵌套循环。

这个过程非常耗时。即使我删除循环中的指令，在 8 兆像素图像上运行也需要大约一分钟。

为什么需要这么长时间？还有其他获取和设置像素的方法吗？

```
 long mn = img_w*img_h;
    long o = 0;
    for(int i =0;i<img_w;i++) {
        for(int j=0;j<img_h;j++) {

                System.out.println(mn-o);

        o++;

        }
    } 
```

此代码模拟处理图像，并且此代码需要很长时间

logcat（部分）：

```
 02-12 19:01:40.815: I/System.out(332): 4999.0
02-12 19:01:40.815: I/System.out(332): 4998.0
02-12 19:01:40.815: I/System.out(332): 4997.0
02-12 19:01:40.825: I/System.out(332): 4996.0
02-12 19:01:40.825: I/System.out(332): 4995.0
02-12 19:01:40.825: I/System.out(332): 4994.0
02-12 19:01:40.825: I/System.out(332): 4993.0
02-12 19:01:40.825: I/System.out(332): 4992.0
02-12 19:01:40.825: I/System.out(332): 4991.0
02-12 19:01:40.825: I/System.out(332): 4990.0
02-12 19:01:40.835: I/System.out(332): 4989.0
02-12 19:01:40.835: I/System.out(332): 4988.0
02-12 19:01:40.835: I/System.out(332): 4987.0
02-12 19:01:40.835: I/System.out(332): 4986.0
02-12 19:01:40.845: I/System.out(332): 4985.0
02-12 19:01:40.845: I/System.out(332): 4984.0
02-12 19:01:40.845: I/System.out(332): 4983.0
02-12 19:01:40.845: I/System.out(332): 4982.0
02-12 19:01:40.845: I/System.out(332): 4981.0
02-12 19:01:40.845: I/System.out(332): 4980.0
02-12 19:01:40.845: I/System.out(332): 4979.0
02-12 19:01:40.845: I/System.out(332): 4978.0
02-12 19:01:40.855: I/System.out(332): 4977.0
02-12 19:01:40.855: I/System.out(332): 4976.0
02-12 19:01:40.855: I/System.out(332): 4975.0
02-12 19:01:40.855: I/System.out(332): 4974.0
02-12 19:01:40.855: I/System.out(332): 4973.0
02-12 19:01:40.865: I/System.out(332): 4972.0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:43:37.840

您安排循环的方式对缓存非常不友好。使内环越过宽度，外环越过高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T05:43:09.120

我认为您不能以这种方式在 Java 中解决您的问题。执行 Java 语句（尤其是方法调用）会产生开销，并且执行 800 万次——即使指令几乎什么都不做，比如设置一个值——总是很慢。

标准答案是在 C++ 中实现此函数，该函数由 Java 虚拟机编译而不是解释，因此应该更快。对于实时应用程序来说，它可能仍然不够快；你仍然在做 800 万次，只是每次都少了。

在整个 8 Mb 像素缓冲区中用 Java 进行 peek 和 poke 操作永远不会很快。然而，Java 的设计者意识到了这个问题，这就是为什么他们提供扩展的 2D 图形 API 来经常消除执行一百万次的 for 循环的需要。我建议仔细查看 2D API 库，该库旨在设置和读取位图中的位。根据您真正想要做的事情，可能会有更快的方法。您可以设置一个具有透明背景的位图，并将您的更改写入该位图，并将该位图写入前一个图像的顶部。当您在位图之上编写位图时，您可以设置一个 Paint 类来处理印象深刻的图像（例如，通过对其应用可变透明度）。Android 2d Graphics API 还支持“Porter-Duff” compositing 提供允许以新颖方式组合图像的调用。所有这些基本上都是在硬件中执行的，因此速度非常快。

在不知道您（确切地）要做什么的情况下，我无法告诉您如何更有效地执行此操作，但是在很多情况下，实现方式比您使用的蛮力方法要有效得多。如果没有，而你想要这个实时，我怀疑你被塞满了。

# php - PHP表单到数组

> ID：14838548
> 
> 赞同：-11
> 
> 时间：2013-02-12T17:45:49.773
> 
> 标签：php, arrays, forms

我试图弄清楚如何设置一个将信息传递给数组的表单。它不适合我的用户，它适合我。我想要一个可以输入信息的表单，它将发布到不同页面上的数组中。这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:47:54.563

当然，这是表单的 PHP 功能..

查看[W3C](http://www.w3.org/wiki/HTML_forms_-_the_basics)或[W3School](http://www.w3schools.com/php/php_forms.asp)。

您可以使用or发送表单并使用`method="GET"`or`method="POST"`接收它（在 PHP 中）。`$_POST``$_GET`

# c++ - 要求类模板中的类型响应某个函数是一种好习惯吗？

> ID：14838551
> 
> 赞同：1
> 
> 时间：2013-02-12T17:46:03.550
> 
> 标签：c++

std lib 在类模板中有类型，这些类型需要覆盖某些 OPERATORS 的类型，例如，我们在 std::map 中使用的类型需要该类型支持 < 运算符。

但是要求某些功能是好事吗？考虑这个愚蠢的例子

```
template <typename T> struct Foo {
  T t;
  Foo() {
    t.push_back(0);
  }
};

int main() {
  Foo<std::vector<int>> foo;
  return 0;
} 
```

在那里我创建了一个类模板 Foo，它的类型需要有一个 push_back 成员函数。这种设计对于 c++ 编码人员来说是否可以接受/通用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:51:01.457

您所描述的称为模板策略（请参阅[this](http://en.wikipedia.org/wiki/Policy-based_design)），它是类或函数的完全合法且通用的设计模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T17:53:51.400

当然。在描述类模板时只需记录对模板参数的要求。

请注意，在您的示例中，如果使用默认构造函数，`T`实际上只需要一个函数。（就语言而言。为了安全起见，您的要求可能会更严格。）`push_back``Foo<T>()`

如果您使用的是最新的编译器，您还可以使用`static_assert`它来确保遵守大多数模板参数要求，和/或在不遵守要求时使错误消息更加清晰。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T17:50:20.213

是的，没关系。标准一直在这样做。作为一个例子，考虑[`std::back_inserter`](http://en.cppreference.com/w/cpp/iterator/back_inserter)哪个，就像你的例子一样，假定它的模板类型实现了一个`push_back`成员函数。虽然我们仍然没有[概念](http://en.wikipedia.org/wiki/Concepts_%28C%2B%2B%29)，但您最好记录您的要求。它还有助于以有意义的方式命名您的模板类型；所以，而不是`template <typename T>`，你可能有`template <typename Container>`。

# ip - 同时有两个 tcpdump 实例？

> ID：14838555
> 
> 赞同：1
> 
> 时间：2013-02-12T17:46:31.880
> 
> 标签：ip, packet-capture, tcpdump, network-interface

`tcpdump`在同一网络接口（使用不冲突的过滤器）上同时运行两个实例是否存在任何已知问题？

我正在经历一些奇怪的时间戳，我认为这可能是原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T19:08:10.650

包过滤通常在内核中完成，因此它不应该在每个 tcpdump 进程中导致任何丢失的数据包或乱序的数据包。如果您正在比较两个不同的 tcpdump 并看到时间戳略有偏差，我可以看到几个原因，但如果不知道您遇到的具体问题是什么，就很难说。

# mercurial - 在 mercurial 中拉/推时忽略目录

> ID：14838563
> 
> 赞同：0
> 
> 时间：2013-02-12T17:46:53.337
> 
> 标签：mercurial

我有一种情况，我有一个开发和 QA 版本的回购。

我有一个目录 foo，其中包含我一直想要被推/拉的代码。我有一个目录栏，它通常包含特定于该区域的项目（它们是什么无关紧要），但有时会包含我确实想要推/拉的项目。

*   推送到 qa - 这样它只需要 foo，但忽略 bar 中的更改。
*   推送到 qa - 以这样的方式，它将同时占用 foo 和 bar。
*   推到 qa - 以这样的方式，它将需要 foo 和一些 bar。

据我所知，我需要合并，然后恢复某些文件，然后提交这些文件。这没关系，但似乎有点倒退。有没有更好的方法让 Mercurial 支持这个工作流程（或类似的工作流程）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:19:45.157

正如 Chris Morgan 所说，这并不是 Mercurial 的真正运作方式。当您推送到另一个存储库时，您会推送许多变更集——这些变更集中的任何内容都会被推送。

一种可能的解决方案，虽然它是一个*非常可怕*的解决方法（在我看来）是使用[Convert](http://mercurial.selenic.com/wiki/ConvertExtension)`--filemap`扩展来创建一个新的存储库，通过使用该选项过滤掉你不想要的东西。

但是，如果这要交给 QA，他们是否还需要 Mercurial 存储库？您可以简单地归档（标记的）版本。默认情况下，存档将包含有关您在`.hgarchival`文件中存档的变更集的信息。例如

```
hg archive -X "bar/**" archive.tgz 
```

`archive.tgz`... 将在当前点创建一个包含您的 repo 存档的文件，没有“bar”目录。`-X`如果您希望排除特定文件，可以多次使用该选项。

# json - ElasticSearch 中的范围查询（GET 没有正文）

> ID：14838567
> 
> 赞同：12
> 
> 时间：2013-02-12T17:47:13.363
> 
> 标签：json, elasticsearch

关于弹性搜索的非常基本的问题，文档没有很清楚地回答（因为它们似乎涉及许多高级细节但错过了基本细节！）。

示例：范围查询

[http://www.elasticsearch.org/guide/reference/query-dsl/range-query.html](http://www.elasticsearch.org/guide/reference/query-dsl/range-query.html)

不告诉如何执行范围，是通过搜索端点吗？

如果是，那么如何通过查询字符串来做到这一点？我的意思是，我想做一个 GET，而不是一个 POST（因为它是一个查询，而不是一个插入/修改）。但是，GET 请求的文档并没有说明如何像 Range 示例中那样使用 JSON：

[http://www.elasticsearch.org/guide/reference/api/search/uri-request.html](http://www.elasticsearch.org/guide/reference/api/search/uri-request.html)

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-13T08:25:17.207

使用[Lucene 查询语法](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/queryparsersyntax.html)：

```
curl -X GET 'http://localhost:9200/my_index/_search?q=my_field:[0+TO+25]&pretty' 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-12T18:20:58.453

假设我们有一个索引

`curl -XPUT localhost:9200/test`

还有一些文件

```
curl -XPUT localhost:9200/test/range/1 -d '{"age": 9}'
curl -XPUT localhost:9200/test/range/2 -d '{"age": 12}'
curl -XPUT localhost:9200/test/range/3 -d '{"age": 16}' 
```

现在我们可以通过以下方式查询一定范围内的这些文档

```
curl -XGET 'http://localhost:9200/test/range/_search?pretty=true' -d '
{
    "query" : {
        "range" : {
            "age" : { 
                "from" : "10", 
                "to" : "20", 
                "include_lower" : true,
                "include_upper": true
            }
        }
    }
}
' 
```

这将返回文档 2 和 3。

~~不过，我不确定是否有办法通过[URI request](http://www.elasticsearch.org/guide/reference/api/search/uri-request.html)执行这些复杂的查询。~~

**编辑**：感谢 karmi，这里是没有 JSON 请求的解决方案：

`curl -XGET --globoff 'localhost:9200/test/range/_search?q=age:["10"+TO+"20"]&pretty=true'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T03:20:26.827

感谢@javanna 回复我自己：

在搜索文档的 RequestBody 部分：

[http://www.elasticsearch.org/guide/reference/api/search/request-body.html](http://www.elasticsearch.org/guide/reference/api/search/request-body.html)

最后，它说：

> 搜索请求的其余部分应在正文本身内传递。正文内容也可以作为名为**source**的 REST 参数传递。

所以我想我需要使用带有`source`属性的搜索端点来传递json。

# android - Android：TextView 背景/文本颜色循环

> ID：14838568
> 
> 赞同：-1
> 
> 时间：2013-02-12T17:47:21.613
> 
> 标签：android, ios, xcode, loops

注意：这个问题需要iOS开发知识才能回答。

我为在 Xcode 环境中构建的应用程序创建了屏幕闪烁功能。屏幕闪烁如下：

背景白色，带有红色文本....背景红色，带有白色文本，间隔为 0.25 秒。

闪烁持续发生，直到用户点击屏幕以在应用程序中前进。这是我用来完成此操作的代码：

```
 @interface OrderCashButtonSignal : UIViewController

 @property (weak, nonatomic) IBOutlet UILabel *orderCashLabel;
 @property (strong, nonatomic) NSTimer *colorTimer;

 @end

    - (void)viewDidLoad
 {
[super viewDidLoad];

self.orderCashLabel.backgroundColor = [UIColor whiteColor];
self.orderCashLabel.textColor = [UIColor redColor];
self.colorTimer = [NSTimer scheduledTimerWithTimeInterval:0.25 target:self   selector:@selector(changeColor) userInfo:nil repeats:YES];

}

(void)changeColor{

[UIView animateWithDuration:0.25 animations:^{

    if ([self.orderCashLabel.backgroundColor isEqual:[UIColor whiteColor]]&&[self.orderCashLabel.textColor isEqual:[UIColor redColor]]) {
        self.orderCashLabel.backgroundColor = [UIColor redColor];
        self.orderCashLabel.textColor = [UIColor whiteColor];
    }
    else{

        self.orderCashLabel.backgroundColor = [UIColor whiteColor];
        self.orderCashLabel.textColor = [UIColor redColor];

    }

 }];

  } 
```

我试图在 Eclipse 中为我的 Android 版本的这个应用程序模仿这种行为，但不知道如何实现计时器，并按照我在 Xcode 中完成的方式一起更改颜色方法。我知道它们是不同的语言，方法也会不同。我以为我可以找到绕过 Android 框架的方法，并解决我的问题，但我失败了。有什么建议么？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:18:53.423

变量：

```
Timer timer = new timer();
    boolean b = true; 
```

在 xml`android:background`属性中设置为`#FFFFFF`和。进入 onCreate() 插入：`android:textColor``#FF0000`

```
timerStep = new TimerTask() {

        @Override
        public void run() {
            runOnUiThread(new Runnable() {
                  @Override
                  public void run() {
                    TextView t = (TextView) findViewById(R.id.YourDefinedTextViewID);
                if (b) {
                    t.setBackgroundColor(Color.RED);
                    t.setTextColor(Color.WHITE);
                    b=false;
                } else {
                    t.setBackgroundColor(Color.WHITE);
                    t.setTextColor(Color.RED);
                    b=true;
                }
                }
            }
        }
};
timer.schedule(timerStep,250,250); 
```

# c++ - CUDA 5.0 上下文管理与多 GPU 环境中的单个应用程序线程

> ID：14838571
> 
> 赞同：0
> 
> 时间：2013-02-12T17:47:36.517
> 
> 标签：c++, memory-management, cuda, multiple-gpu, cuda-context

网络上的大多数教程、指南、书籍和问答似乎都指的是 CUDA 3 和 4.x，所以这就是我专门询问 CUDA 5.0 的原因。对于这个问题...

我想为一个有两个 CUDA 设备的环境编程，但只使用一个线程，以使设计简单（特别是因为它是一个原型）。我想知道以下代码是否有效：

```
float *x[2];
float *dev_x[2];

for(int d = 0; d < 2; d++) {
    cudaSetDevice(d);
    cudaMalloc(&dev_x[d], 1024);
}

for(int repeats = 0; repeats < 100; repeats++) {
    for(int d = 0; d < 2; d++) {
        cudaSetDevice(d);
        cudaMemcpy(dev_x[d],x[d],1024,cudaMemcpyHostToDevice);

        some_kernel<<<...>>>(dev_x[d]);

        cudaMemcpy(x[d],dev_x[d],1024,cudaMemcpyDeviceToHost);
    }
    cudaStreamSynchronize(0);
} 
```

我想特别知道`cudaMalloc(...)`在测试之前的 s 是否持久，即使交换`cudaSetDevice()`发生在同一个线程中。另外，我想知道与上下文相关的对象是否也会发生同样的情况，例如`cudaEvent_t`和`cudaStream_t`。

我问它是因为我有一个这种风格的应用程序，它不断出现一些映射错误，如果缺少内存泄漏或错误的 API 使用，我找不到它是什么。

注意：在我的原始代码中，我会检查每个 CUDA 调用。我没有把它放在这里是为了代码的可读性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:53:41.987

这只是一个错字吗？

```
for(int d = 0; d < 2; d++) {
    cudaSetDevice(0);  // shouldn't that be 'd'
    cudaMalloc(&dev_x, 1024);
} 
```

请检查所有 API 调用的返回值！

# c# - 从不同的表单关闭 WinForm 应用程序

> ID：14838572
> 
> 赞同：1
> 
> 时间：2013-02-12T17:47:36.737
> 
> 标签：c#, winforms

这似乎是一个愚蠢的问题，但我只是想确保我做对了。我的主要形式大部分时间都不可见。要打开它，我有一个 NotifyIcon。菜单选项之一是退出应用程序。我还有一些静态全局变量需要在应用程序关闭之前处理掉。所以在program.cs我有这个。

```
 [STAThread]
    static void Main()
    {
        InitializeApplication();
        InitializeMainForm();
        Application.Run(main);
    }
    private static void InitializeApplication()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.ApplicationExit += Application_ApplicationExit;
    }
    private static void InitializeMainForm()
    {
        main = new AssignButtonForm();
        main.FormClosing += main_FormClosing;
        Globals.StartNotify();
    }

    static void main_FormClosing(object sender, FormClosingEventArgs e)
    {
        var dlg = MessageBox.Show("Turn off Application?", "Exit?", MessageBoxButtons.OKCancel, MessageBoxIcon.Question, MessageBoxDefaultButton.Button1);
        if (dlg == DialogResult.OK)
        {
            Globals.notifyIcon1.Dispose();
            Application.Exit();
        }
        else
        {
            e.Cancel = true;
        }
    } 
```

所以我希望这是正确的称呼方式。

```
 private void exitToolStripMenuItem_Click(object sender, EventArgs e)
    {
        this.Hide();
        Application.OpenForms[0].Close();
    } 
```

那是对的吗？或者，还有更好的方法？

**编辑**

好的，所以我的一个类有自己的 Dispose 方法

```
public class KeymonNotifyIcon : IDisposable
{
    public KeymonNotifyIcon()
    {
        InitializeComponent();
        keymonMenuStrip.SetupKeysSelected += OnSetupKeysSelected;
    }
    ~KeymonNotifyIcon()
    {
        Dispose();
    }
    public void Dispose()
    {
        if (notifyIcon1 != null)
            notifyIcon1.Dispose();

        if (keymonMenuStrip != null)
            keymonMenuStrip.Dispose();
    }
} 
```

全球班

```
public static class Globals
{
    public static TraceSource trace = new TraceSource("Keymon");
    public static KeymonNotifyIcon notifyIcon1;
    public static void StartNotify()
    {
        notifyIcon1 = new KeymonNotifyIcon();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:48:51.673

实际上，我相当肯定它`Application.Exit`会`Dispose`为你调用你所有的方法（只要你已经实现了`IDisposable`

看到[这个问题](https://stackoverflow.com/questions/5091700/winforms-application-exit-does-not-exit-the-app-neccesarily)，它引用[了这个问题](https://stackoverflow.com/questions/1057151/application-exit)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:03:01.917

如果您的程序刚刚关闭，则尚未被垃圾回收的对象将运行其*终结*器。[推荐的模式](http://msdn.microsoft.com/en-us/library/b1yfkh5e%28v=vs.100%29.aspx)是对象实现`IDisposable`具有终结器以确保其`IDisposable`运行。据我所知，.NET BCL 类始终遵循这种模式。但是，您自己的或第三方/开源组件可能不遵循该模式。

注意：MSDN 上的链接模式不调用 GC.SuppressFinalize。查看[如何使用它](http://msdn.microsoft.com/en-us/library/system.gc.suppressfinalize.aspx)来减少 GC 开销。

单独实施`IDisposable`并不足以确保正确处置对象。

如果您有实现 的静态引用对象，则从应用程序关闭事件`IDisposable`显式调用它们是更可靠的解决方案。`IDisposable.Dispose()`

**编辑**

您的 Dispose 实现将导致在拥有的对象上调用 Dispose() 两次，因为：

```
if (notifyIcon1 != null)
        notifyIcon1.Dispose(); 
```

不设置`notifyIcon1`为`null`，并且终结器无条件地`Dispose()`再次调用。

此外，您将*始终导致终结器运行（这会使该类的 GC 更昂贵*[）](http://msdn.microsoft.com/en-us/library/system.gc.suppressfinalize.aspx)，因为您没有在`Dispose()`.

# python - 为什么 Python 脚本在第二次运行时读取文件的速度要快得多？

> ID：14838576
> 
> 赞同：2
> 
> 时间：2013-02-12T17:48:00.430
> 
> 标签：python, python-2.7, runtime

我用 Python 阅读了几百个文本文件的第一行。
第一次运行不到几秒钟，但第二次运行只需要几毫秒！
这是为什么 ？是蟒蛇吗？是操作系统（在我的情况下是 Windows 7）吗？

这是脚本：

```
import glob
from datetime import datetime

start = datetime.now()

for summary in glob.glob(r"C:\folder\*.txt"):
    with open(summary) as f:
        line = f.readline()
        print line.rstrip().decode('utf-16')

print 'Time: ', datetime.now()-start 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T17:49:18.800

那是操作系统的[磁盘缓存。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364218%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-12T17:49:21.103

是操作系统。现代操作系统使用磁盘缓存来加速重复读取。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-12T17:49:40.087

您的操作系统可能在第一次运行后缓存了磁盘中的数据。重新启动计算机并查看运行时间的比较情况。

# java - 为什么有些命令在 Unix 上需要锁而其他命令不需要？

> ID：14838577
> 
> 赞同：0
> 
> 时间：2013-02-12T17:48:07.323
> 
> 标签：java, unix, aix, io-redirection, su

最近，我在我们的环境 AIX 7.1 中观察到一些有趣的东西。为了追查这个问题，我用 Java 创建了一个小型锁定应用程序：

```
import java.io.File;
import java.io.RandomAccessFile;
import java.nio.channels.FileChannel;
import java.nio.channels.FileLock;
import java.nio.channels.OverlappingFileLockException;

public class Locker {

    public static void main(String[] args) throws Exception {
        File file = new File("/etc/passwd");
        FileChannel channel = new RandomAccessFile(file, "rw").getChannel();
        FileLock lock;

        try {
            lock = channel.tryLock();

            if (lock != null) {
                System.out.println("I have the lock");
                while(true) {}
            }

        } catch (OverlappingFileLockException e) {
            e.printStackTrace();
        }

    }
} 
```

据我所知，这在 /etc/passwd 上获得了读写锁。如果我尝试运行此应用程序的两个实例，我只能按预期在一个实例中获得锁。同样，如果我运行此命令：

```
su user2 -c echo test 
```

该命令挂起，直到我从 Java 应用程序释放锁定。另一方面，读取文件：

```
cat /etc/passwd 
```

成功运行。甚至写入文件：

```
cat /etc/passwd > /etc/passwd 
```

也很好。现在，显然 Java FileLock 实现依赖于系统，并且由于这种性质，没有指定的行为。然而，我很好奇的是为什么 'su' 需要等待。'cat' 重定向是否可能只是删除文件并使用新输出重新创建它，或者这仅仅是锁定机制在命令之间不一致的情况？

**编辑：**由于提出这个问题，我在 Java 应用程序中添加了一些写语句，所以程序的结构如下：

```
Acquire Java Lock on /etc/passwd
IO-Redirect with a small change to /etc/passwd
Append some text to /etc/passwd in the Java application 
```

所有这些信息都反映在更新的 /etc/passwd 中，因此 IO-Redirection 似乎不仅仅是删除文件。因此，为什么 'su' 和 '>' （可能还有许多其他东西）之间的区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:10:22.310

UNIX 上的文件锁定是建议性的，不是强制性的。也就是说，锁完全独立于任何试图读取或写入文件的人，并且对任何人都没有影响。它只与试图获取锁的其他程序交互。

由于`cat`和重定向不会尝试锁定文件，因此锁定对它们没有影响。 `su`另一方面，在读取 /etc/passwd 之前锁定它，因此持有锁的程序会导致它等待（获取锁）直到你释放它。

# iphone - 修改存档后的 xcode 字符串文件：将二进制转换为 UTF-8

> ID：14838578
> 
> 赞同：2
> 
> 时间：2013-02-12T17:48:11.140
> 
> 标签：iphone, ios, xcode, ipad, bash

在我的应用程序的构建和归档期间，`.strings`文件被复制到应用程序包中，例如

```
CopyStringsFile
/Users/Systems/Library/Developer/Xcode/DerivedData/MyProject-dqtbpsfqkwnliuflrsytopqbuvpr/Build/Intermediates/ArchiveIntermediates/Evolve/InstallationBuildProductsLocation/Applications/Evolve.app/en.lproj/InfoPlist.strings
MyProject/en.lproj/InfoPlist.strings
    cd /Users/Systems/luke/repos/MyProject/MyProject
    setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    builtin-copyStrings --validate --inputencoding utf-8 --outputencoding binary --outdir /Users/Systems/Library/Developer/Xcode/DerivedData/MyProject-dqtbpsfqkwnliuflrsytopqbuvpr/Build/Intermediates/ArchiveIntermediates/Evolve/InstallationBuildProductsLocation/Applications/Evolve.app/en.lproj
-- MyProject/en.lproj/InfoPlist.strings 
```

解压缩 ipa 并将字符串文件加载到文本编辑器中会显示二进制内容。

我想使用 bash 读取 ASCII UTF-8 中的字符串文件的内容，找到并替换一些字符串并再次将其编码为二进制。

具体来说，我应该如何将文件的内容解码为 ASCI？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T16:57:56.197

原来这是一个超级简单的 bash 命令：

```
plutil -convert xml1 <PATH_TO_STRINGS_FILE> 
```

并再次将其转换回来：

```
plutil -convert binary1 <PATH_TO_STRINGS_FILE> 
```

# c++ - 调用 system(3) 生成的 ECHILD 是否失败？

> ID：14838580
> 
> 赞同：0
> 
> 时间：2013-02-12T17:48:19.507
> 
> 标签：c++, embedded, cross-platform

我目前正在开发一个 C++ 服务器，它接受请求并产生新的进程来处理它们。然后（有时）这些子进程必须执行对 system(3) 的调用以调用其他程序（我无法控制的第三方程序）。这个服务器正在移植到一个新的硬件平台，所以我必须保持多个系统之间的兼容性，回到内核 2.4.20。我目前忽略了孩子（信号（SIGCHLD，SIG_IGN）），这在旧内核上运行良好，但是当我在更新的内核上运行服务器时，我将服务器（2.6、3.2）移植到不同的硬件上，此系统调用失败，system(3) 将 errno 设置为 ECHILD。内核发生了什么变化，如果我不能忽略它们，处理孩子的正确方法是什么？（笔记，

# java - 在java中动态生成变量的解决方法

> ID：14838581
> 
> 赞同：-3
> 
> 时间：2013-02-12T17:48:21.187
> 
> 标签：java

我有一个无法用列表或数组解决的问题**，**这很容易。这是提示：

*一家大公司向其销售人员支付佣金。销售人员每周收到 200 美元外加该周总销售额的 9% 的佣金。例如，一名销售人员在一周内销售了价值 5000 美元的商品，将获得 200 美元加上 5000 美元的 9%，即总共 650 美元。您是销售人员的名字、姓氏和 N 件已售商品的提示用户。编写一个名为 Commission 的程序，输入一个销售人员的名字、姓氏以及上周销售的每个 iterm 的商品数量和数量，然后计算并显示该销售人员的名字、姓氏和收入。销售人员出售的商品数量没有限制。注意：我们不使用列表或数组；将项目类型和值存储在变量中以供以后计算。*

有处理类重载的复杂方法，但我不熟悉它们。我不知道如何解释可变数量的项目。这是我想太多了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T17:53:04.870

使用循环：读入项目和数量，添加到收入中。不需要列表或数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:59:36.410

无需记住单个销售额来计算所需的结果。

只需在输入时总结每个人的销售额。您需要的所有信息都是总和，对于计算，您并不关心总和是如何组成的。

您可以使用许多嵌套循环来执行此操作，其中一个是最外层的循环人员，一个是内部的循环项。在项目循环开始时，您将总和初始化为零，通过 eacj 循环迭代，您添加项目销售值。内循环完成后，计算收益并显示出来。转移到下一个人。简单的？

# ios - iOS NSDateFormatter 从字符串返回错误的日期

> ID：14838591
> 
> 赞同：2
> 
> 时间：2013-02-12T17:48:38.820
> 
> 标签：ios, nsdate, nsdateformatter

我使用相同的、未经修改`NSDateFormatter`的方法对字符串中的日期进行编码和解码。将日期编码为字符串可以正常工作，但奇怪的是，将其取回效果不佳。这甚至都不是时区问题，因为大多数日期都是*几个月*的时间。我有：

```
NSDateFormatter *_calibrationDateFormat = [[NSDateFormatter alloc] init];
[_calibrationDateFormat setDateFormat:@"EEEE MMM d, YYYY"];
NSString *text = @"Thursday Dec 6, 2018";
NSLog(@"%@\n%@", text, [_calibrationDateFormat dateFromString:text]); 
```

输出：

```
Monday Aug 12, 2013
2012-12-31 05:00:00 +0000 
```

其他日期的更多尝试：

```
Friday Apr 12, 2013
2013-01-04 05:00:00 +0000

Saturday Oct 26, 2013
2013-01-05 05:00:00 +0000

Thursday Sep 10, 2015
2015-01-01 05:00:00 +0000

Thursday Jan 5, 2017
2017-01-05 05:00:00 +0000 
```

我真的不知道它解码这些日期的逻辑。我也尝试了不同的格式，例如删除星期几，或者使用完整的月份名称而不是 3 个字母的缩写，但结果同样令人困惑。请注意，对于我的测试，我使用了 UIDatePicker 并使用相同的日期格式化程序对生成的日期进行编码，以避免在格式化日期时出现任何人为错误。有没有可靠的方法从人类可读的日期字符串中获取日期对象？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-12T17:58:13.080

我认为问题在于您使用的是`YYYY`而不是`yyyy`. 大写变体用于基于“一年中的一周”的日历（有关更多信息，请参阅[UTS 规范](http://www.unicode.org/reports/tr35/tr35-25.html#Date_Format_Patterns)），这实际上与在许多（大多数？）情况下获取文字日历年不同。用作`@"EEEE MMM d, yyyy"`日期格式化程序可能会为您解决此问题。

# java - Java SecureRandom 围绕创建和重新播种的正确用法

> ID：14838598
> 
> 赞同：1
> 
> 时间：2013-02-12T17:49:03.863
> 
> 标签：java, random, thread-safety, singleton

我们有生成随机临时密码的业务需求。根据用例，此类呼叫的数量预计会非常低（约 400 个呼叫/天）。`java.security.SecureRandom`根据 Internet 上的各种建议，并在阅读了许多关于 SO 的类似帖子后，我们决定使用来实现加密强随机化。

现在，我们已经编写了一个简单的随机化器（内部使用`SecureRandom`），它应该被用作`singleton`Web 应用程序中的一个。但是，我们也希望定期重新播种它，再次按照关于 SO 的建议。为此，下面是一些实现相同目的的示例代码。有人可以查看它并让我们知道这是否是正确且合理有效的方法吗？另外，有没有办法避免`synchronization`在代码中出现，同时仍然保持线程安全？：

```
import java.security.*;
public final class Randomizer {
    private static final Randomizer INSTANCE = new Randomizer();

    private static final String DEFAULT_CSPRNG_ALGO = "SHA1PRNG";

    private volatile SecureRandom sr;
    private volatile long lastSeedTime;

    public static final Randomizer getInstance() throws Exception {
        return INSTANCE;
    }

    public int nextInt(int len) throws RuntimeException {
        reseedRandomAsNeeded();
        return sr.nextInt(len);
    }

    private Randomizer() throws RuntimeException {
        try {
                System.out.printf("%s Constructing Randomizer...%n", Thread.currentThread());
                recreateSecureRandomInstance();
                lastSeedTime = System.nanoTime();
        } catch (NoSuchAlgorithmException e) {
                throw new RuntimeException(e);
        }
    }

    /**
     * TODO Is there a way to avoid the synchronization overhead here? We really
     * only need to synchronize when the reseed happens.
     * 
     * @throws RuntimeException
     */
    private synchronized void reseedRandomAsNeeded() throws RuntimeException {
        if (isItTimeToReseed()) {
                // TODO Need to do a reseed. Just get a new SecureRandom for now.
                try {
                        recreateSecureRandomInstance();
                } catch (NoSuchAlgorithmException e) {
                        throw new RuntimeException(e);
                }
        }
    }

    private boolean isItTimeToReseed() {
        boolean reseed = false;
        long currentTime = System.nanoTime();
        long difference = ((currentTime - this.lastSeedTime) / (1000 * 1000 * 1000)/* *60 * 60 * 24*/);
        // System.out.printf("%s Current time: %d, Last Reseed Time: %d, difference: %d%n",
        // Thread.currentThread(), currentTime, lastSeedTime, difference);

        // TODO For testing, test for just a 3 seconds difference.
        if (difference > 3) {
                reseed = true;
                this.lastSeedTime = currentTime;
        }

        return reseed;
    }

    private void recreateSecureRandomInstance() throws NoSuchAlgorithmException {
        sr = SecureRandom.getInstance(DEFAULT_CSPRNG_ALGO);
        System.out.printf("%s Created a new SecureRandom instance: %s%n", Thread.currentThread(), sr);
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-19T10:50:15.627

您可以根据调用次数重新播种，而不是基于时间。

在类中维护一个计数器，并在每次调用随机生成器时增加它。当计数器达到某个阈值时，重新播种并将计数初始化为 0。您可以为每 100 万次调用重新播种。

这是我唯一能建议的。

# backbone.js - Backbone Marionette 布局的 UI 哈希问题

> ID：14838601
> 
> 赞同：6
> 
> 时间：2013-02-12T17:49:11.897
> 
> 标签：backbone.js, marionette

在下文`Layout`中，我将添加一个`CollectionView`以在其中显示一个 SELECT 列表`onRender`。紧接着，我使用 ui 哈希来启用或禁用视图中的所有控件。这不适用于 SELECT 生成的`new App.View.Categories`.

应该是？或者 UI 散列`Regions`在`Layout`?

```
App.View.UploadFile = Backbone.Marionette.Layout.extend({
    template: '#upload-file-template',
    regions:{
        category: 'td:nth-child(4)'
    },
    ui:{
        inputs: 'textarea, select, .save'
    },
    onRender: function(){
        this.category.show(
            new App.View.Categories({
                collection: App.collection.categories
            }) // generates the SELECT list
        );

        console.log(this.ui.inputs); // Length 2\. Missing select.
        console.log(this.$('textarea, select, .save')); // Length 3

        this.ui.inputs.prop(
            'disabled', (this.model.get('upload_status')!='staged')
        );
    }
}); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-12T20:05:31.830

这应该按照您期望的方式工作。木偶源中有问题的代码在这里：[https ://github.com/marionettejs/backbone.marionette/blob/master/src/marionette.itemview.js#L49-L51](https://github.com/marionettejs/backbone.marionette/blob/master/src/marionette.itemview.js#L49-L51)

调用`bindUIElements()`将`ui`散列转换为 jQuery 选择器对象，并且在调用`onRender`方法之前调用它。

你看到错误了吗？或者选择器只是什么都不返回，并且对元素没有影响？

* * *

更新：

啊! 当然......我没有足够关注你的代码。您是正确的，因为 UI 元素选择器发生在您将子视图添加到区域之前。我以前从未遇到过这种情况……但这似乎是我们想要修复/支持的事情。

目前，我可以建议的最佳解决方法是调用 'this.bindUIElements();' 在 onRender 方法的最后。这将强制 ui 元素重新绑定到选择器。

我还将在 github 问题列表中添加一个问题，以寻找更好的解决方案。我不知道我什么时候才能做到这一点，但这至少会在要修复的事情清单上得到它。

# bash - Bash 脚本不适合换行，将文本附加到当前行

> ID：14838605
> 
> 赞同：1
> 
> 时间：2013-02-12T17:49:20.867
> 
> 标签：bash

我有一个脚本，在运行命令后将标准输出重定向到日志文件`xyz`。我尝试在控制台中这样做：

```
xyz > temp.log & 
```

当我看到`temp.log`它像我期望的那样完美时。但是当我在脚本中运行上述命令时，temp.log 只是所有标准输出的一大行。如何使其打印与从控制台运行它相同？我在下面显示了日志。

**`xyz > temp.log`从控制台运行和**

```
/source_id:int64/(Green-aeon-GlobalMillennium-Spout): 18
/source_id:int64/(Green-aeon-GlobalMillennium-Spout): 6
/source_id:int64/(Green-aeon-GlobalMillennium-Spout): 3
/source_id:int64/(Green-aeon-GlobalMillennium-Spout): 2
/source_id:int64/(Green-aeon-GlobalMillennium-Spout): 19
/source_id:int64/(Green-aeon-GlobalMillennium-Spout): 11
/source_id:int64/(Green-aeon-GlobalMillennium-Spout): 1
/source_id:int64/(Green-aeon-GlobalMillennium-Spout): 12
/source_id:int64/(Green-aeon-GlobalMillennium-Spout): 3 
```

**从脚本中运行**

```
ESC[?1049hESC[1;48rESC(BESC[mESC[4lESC[?7hESC[HESC[2JEvery 5.0s: Green-aeon-GlobalMillennium-SpoutESC[1;178HTue Feb 12 11:36:08 2013ESC[3;1H/source_id:36/sch_event:1797777 for Green-aeon-GlobalMillennium-Spout at Tue Feb 12 11:16:41 CST 2013^MESC[4d/source_id:36/sch_event:1797779 for Green-aeon-GlobalMillennium-Spout at Tue Feb 12 11:16:41 CST 2013^MESC[5d/source_id:36/sch_event:1797781 for Green-aeon-GlobalMillennium-Spout at Tue Feb 12 11:16:41 CST 2013^MESC[6d/source_id:36/sch_event:1797783 for Green-aeon-GlobalMillennium-Spout at Tue Feb 12 11:16:41 CST 2013^MESC[7d/source_id:36/sch_event:1797785 for Green-aeon-GlobalMillennium-Spout at Tue Feb 12 11:16:41 CST 2013^MESC[8d/source_id:36/sch_event:1797787 for Green-aeon-GlobalMillennium-Spout at Tue Feb 12 11:16:41 CST` 2013^MESC[9d/source_id:36/sch_event:1797789 for Green-aeon-GlobalMillennium-Spout at Tue Feb 12 11:16:41 CST 2013^MESC[10d/source_id:36/sch_event:1797791 for Green-aeon-GlobalMillennium-Spout at Tue Feb 12 11:16:41 CST 2013^MESC 
```

**这是脚本**

```
#!/bin/sh

die () {
    echo >&2 "$@"
    exit 1
}

[ "$#" -ge 4 ] || die "usage notification_stats <table_name> <listener_name> <time_interval> <time_to_run>"

echo $3 | grep -E -q '^[0-9]+$' || die "Numeric argument required, $3 provided for time_interval"
echo $4 | grep -E -q '^[0-9]+$' || die "Numeric argument required, $4 provided for time_to_run"

watch -n $3 xyz -v $1 $2 > notify.log &
$my_pid = $!

sleep $4 
kill -9 $my_pid 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T18:13:57.397

不要使用`watch`. 它用于交互式显示，而不是重复运行程序。

您可以使用

```
#!/bin/bash
while (( SECONDS <= $4 ))
do 
    xyz -v $1 $2
    sleep $3
done > notify.log 
```

反而

# android - 如何在android中的imageviews之间切换图像？

> ID：14838607
> 
> 赞同：1
> 
> 时间：2013-02-12T17:49:22.040
> 
> 标签：android, xml, imageview

我是 android 新手，正在制作幻灯片拼图。我想通过在图像视图之间交换图像而不是滑动图像来保持简单。我的代码没有给出任何错误，但也没有做任何事情。你能帮我么。

这是我的 xml 代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginLeft="44dp"
        android:layout_marginTop="44dp"
        android:src="@drawable/ic_launcher"
        android:tag="1" />

    <ImageView
        android:id="@+id/imageView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView1"
        android:layout_marginLeft="3dp"
        android:layout_toRightOf="@+id/imageView1"
        android:src="@drawable/ic_launcher" 
        android:tag="2" />

    <ImageView
        android:id="@+id/imageView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView2"
        android:layout_marginLeft="3dp"
        android:layout_toRightOf="@+id/imageView2"
        android:src="@drawable/ic_launcher"
        android:tag="3"  />

    <ImageView
        android:id="@+id/imageView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/imageView1"
        android:layout_below="@+id/imageView1"
        android:layout_marginTop="3dp"
        android:src="@drawable/ic_launcher" />

    <ImageView
        android:id="@+id/imageView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView4"
        android:layout_alignLeft="@+id/imageView2"
        android:src="@drawable/ic_launcher" />

    <ImageView
        android:id="@+id/imageView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView5"
        android:layout_alignLeft="@+id/imageView3"
        android:src="@drawable/ic_launcher" />

    <ImageView
        android:id="@+id/imageView7"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/imageView4"
        android:layout_below="@+id/imageView4"
        android:layout_marginTop="3dp"
        android:src="@drawable/ic_launcher" />

    <ImageView
        android:id="@+id/imageView8"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView7"
        android:layout_alignLeft="@+id/imageView5"
        android:src="@drawable/ic_launcher" />

    <ImageView
        android:id="@+id/imageView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView8"
        android:layout_alignRight="@+id/imageView6"
        android:src="@drawable/ic_launcher" />

</RelativeLayout> 
```

这是我的 MainActivity 代码：

```
package com.example.puzzelencauseican;

import android.os.Bundle;
import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.drawable.Drawable;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ImageView;

public class MainActivity extends Activity implements OnClickListener {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    ImageView image1=(ImageView) findViewById(R.id.imageView1);
    Bitmap bmp=BitmapFactory.decodeResource(getResources(), R.drawable.img1);
    int width=(int)(bmp.getWidth() /2);
    int height=(int)(bmp.getHeight() /2);
    Bitmap resizedbitmap=Bitmap.createScaledBitmap(bmp,width, height,true);
    image1.setImageBitmap(resizedbitmap);
    image1.setOnClickListener(this);

    ImageView image2=(ImageView) findViewById(R.id.imageView2);
    Bitmap bmp2=BitmapFactory.decodeResource(getResources(), R.drawable.img2);
    int width2=(int)(bmp2.getWidth() /2);
    int height2=(int)(bmp2.getHeight() /2);
    Bitmap resizedbitmap2=Bitmap.createScaledBitmap(bmp2, width2, height2,true);
    image2.setImageBitmap(resizedbitmap2);
    image2.setOnClickListener(this);

    ImageView image3=(ImageView) findViewById(R.id.imageView3);
    Bitmap bmp3=BitmapFactory.decodeResource(getResources(), R.drawable.img3);
    int width3=(int)(bmp3.getWidth() /2);
    int height3=(int)(bmp3.getHeight() /2);
    Bitmap resizedbitmap3=Bitmap.createScaledBitmap(bmp3, width3, height3,true);
    image3.setImageBitmap(resizedbitmap3);
    image3.setOnClickListener(this);

    ImageView image4=(ImageView) findViewById(R.id.imageView4);
    Bitmap bmp4=BitmapFactory.decodeResource(getResources(), R.drawable.img4);
    int width4=(int)(bmp4.getWidth() /2);
    int height4=(int)(bmp4.getHeight() /2);
    Bitmap resizedbitmap4=Bitmap.createScaledBitmap(bmp4, width4, height4,true);
    image4.setImageBitmap(resizedbitmap4);
    image4.setOnClickListener(this);

    ImageView image5=(ImageView) findViewById(R.id.imageView5);
    Bitmap bmp5=BitmapFactory.decodeResource(getResources(), R.drawable.img5);
    int width5=(int)(bmp5.getWidth() /2);
    int height5=(int)(bmp5.getHeight() /2);
    Bitmap resizedbitmap5=Bitmap.createScaledBitmap(bmp5,width5, height5,true);
    image5.setImageBitmap(resizedbitmap5);
    image5.setOnClickListener(this);

    ImageView image6=(ImageView) findViewById(R.id.imageView6);
    Bitmap bmp6=BitmapFactory.decodeResource(getResources(), R.drawable.img6);
    int width6=(int)(bmp6.getWidth() /2);
    int height6=(int)(bmp6.getHeight() /2);
    Bitmap resizedbitmap6=Bitmap.createScaledBitmap(bmp6,width6, height6,true);
    image6.setImageBitmap(resizedbitmap6);
    image6.setOnClickListener(this);

    ImageView image7=(ImageView) findViewById(R.id.imageView7);
    Bitmap bmp7=BitmapFactory.decodeResource(getResources(), R.drawable.img7);
    int width7=(int)(bmp7.getWidth() /2);
    int height7=(int)(bmp7.getHeight() /2);
    Bitmap resizedbitmap7=Bitmap.createScaledBitmap(bmp7,width7, height7,true);
    image7.setImageBitmap(resizedbitmap7);
    image7.setOnClickListener(this);

    ImageView image8=(ImageView) findViewById(R.id.imageView8);
    Bitmap bmp8=BitmapFactory.decodeResource(getResources(), R.drawable.img8);
    int width8=(int)(bmp8.getWidth() /2);
    int height8=(int)(bmp8.getHeight() /2);
    Bitmap resizedbitmap8=Bitmap.createScaledBitmap(bmp8,width8, height8,true);
    image8.setImageBitmap(resizedbitmap8);
    image8.setOnClickListener(this);

    ImageView image9=(ImageView) findViewById(R.id.imageView9);
    Bitmap bmp9=BitmapFactory.decodeResource(getResources(), R.drawable.leeg);
    int width9=(int)(bmp8.getWidth() /2);
    int height9=(int)(bmp8.getHeight() /2);
    Bitmap resizedbitmap9=Bitmap.createScaledBitmap(bmp9,width9, height9,true);
    image9.setImageBitmap(resizedbitmap9);
    image9.setOnClickListener(this);

}

private void imageView1Click() {
    ImageView image1=(ImageView) findViewById(R.id.imageView1);
    ImageView image2 = (ImageView) findViewById(R.id.imageView2);
    ImageView image4 = (ImageView) findViewById(R.id.imageView4);
    Context mContext = null;
    Drawable leeg;

    leeg = mContext.getResources().getDrawable(R.drawable.leeg);

    if( image4.getDrawable() == leeg ){
        Drawable verander1 = image1.getBackground();
        Drawable verander2 = image4.getBackground();
        image4.setBackground(verander1);
        image1.setBackground(verander2);
    }

    if (image2.getDrawable() == leeg){
        Drawable verander1 = image1.getBackground();
        Drawable verander2 = image2.getBackground();
        image2.setBackground(verander1);
        image1.setBackground(verander2);
    }
}

private void imageView8Click() {
    ImageView image5=(ImageView) findViewById(R.id.imageView5);
    ImageView image7 = (ImageView) findViewById(R.id.imageView7);
    ImageView image8=(ImageView) findViewById(R.id.imageView8);
    ImageView image9 = (ImageView) findViewById(R.id.imageView9);
    Drawable leeg;

    leeg = getResources().getDrawable(R.drawable.leeg);

    if( image5.getDrawable() == leeg ){
        Drawable verander1 = image8.getBackground();
        Drawable verander2 = image5.getBackground();
        image5.setImageDrawable(verander1);
        image8.setImageDrawable(verander2);
    }

    if( image7.getDrawable() == leeg ){
        Drawable verander1 = image8.getBackground();
        Drawable verander2 = image7.getBackground();
        image7.setImageDrawable(verander1);
        image8.setImageDrawable(verander2);
    }

    if( image9.getDrawable() == leeg ){
        Drawable verander1 = image8.getBackground();
        Drawable verander2 = image9.getBackground();
        image9.setImageDrawable(verander1);
        image8.setImageDrawable(verander2);
    }

}

public void onClick(View v) {
    // TODO Auto-generated method stub
    switch (v.getId()) {
    case R.id.imageView1:
        imageView1Click();
        break;
    case R.id.imageView8:
        imageView8Click();
        break;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:04:53.107

1) 不要经常使用 findViewById。使用一次并保留链接。这对于性能操作来说相当复杂。

2）不要两次加载位图。您可以使用以下方法通过一次操作创建两倍缩放的位图。

```
BitmapFactory.Options options = new BitmapFactory.Options();
options.inSampleSize = 2;
BitmapFactory.decodeResource(getResources(), R.id.myimage, options); 
```

3)

```
image4.getDrawable() == leeg 
```

这里总是会返回 false 因为 leeg 是新创建的对象

不要比较像 == 这样的对象内容。该运算符适用于比较原始类型。== 运算符比较对象的链接，而不是对象的内容。您只会使用 (object1 == object2) 检查它是否指向同一个对象实例，而不是具有相同数据的对象。要比较两个可绘制对象（和字符串等），请使用 Object 类中的 equals() 方法

```
if (image2.getDrawable().equals(leeg)) { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:32:25.337

在单击方法中，您调用 imgView.getBackground 并将背景设置为其他 imageVIews 的源，这是您的意图吗？你不应该调用 getDrawable 吗？

我建议您使用 ViewPager 来执行此功能，而不是使用所有固定代码。您还应该在 onClick 中注释代码。

**更新：** 试试这个布局文件。我只是将你的包裹在一个 Horizo​​ntalScrollView 中，并修改了 RelativeLayout 的宽度。

```
<HorizontalScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
<RelativeLayout
    android:layout_width="wrap_content"
    android:layout_height="match_parent" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginLeft="44dp"
        android:layout_marginTop="44dp"
        android:src="@drawable/ic_launcher"
        android:tag="1" />

    <ImageView
        android:id="@+id/imageView2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView1"
        android:layout_marginLeft="3dp"
        android:layout_toRightOf="@+id/imageView1"
        android:src="@drawable/ic_launcher" 
        android:tag="2" />

    <ImageView
        android:id="@+id/imageView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView2"
        android:layout_marginLeft="3dp"
        android:layout_toRightOf="@+id/imageView2"
        android:src="@drawable/ic_launcher"
        android:tag="3"  />

    <ImageView
        android:id="@+id/imageView4"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/imageView1"
        android:layout_below="@+id/imageView1"
        android:layout_marginTop="3dp"
        android:src="@drawable/ic_launcher" />

    <ImageView
        android:id="@+id/imageView5"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView4"
        android:layout_alignLeft="@+id/imageView2"
        android:src="@drawable/ic_launcher" />

    <ImageView
        android:id="@+id/imageView6"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView5"
        android:layout_alignLeft="@+id/imageView3"
        android:src="@drawable/ic_launcher" />

    <ImageView
        android:id="@+id/imageView7"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/imageView4"
        android:layout_below="@+id/imageView4"
        android:layout_marginTop="3dp"
        android:src="@drawable/ic_launcher" />

    <ImageView
        android:id="@+id/imageView8"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView7"
        android:layout_alignLeft="@+id/imageView5"
        android:src="@drawable/ic_launcher" />

    <ImageView
        android:id="@+id/imageView9"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/imageView8"
        android:layout_alignRight="@+id/imageView6"
        android:src="@drawable/ic_launcher" />

</RelativeLayout>

</HorizontalScrollView> 
```

# mono - Monodevelop中的可移植类库：不兼容的目标框架

> ID：14838608
> 
> 赞同：0
> 
> 时间：2013-02-12T17:49:25.033
> 
> 标签：mono, monodevelop

尝试为我的单声道项目编译可移植类库时出现此错误。

```
C:\Program Files (x86)\Mono-2.10.9\lib\mono\xbuild\Microsoft\Portable\v4.0\Microsoft.Portable.CSharp.targets: Project file could not be imported, it was being imported by PortableTest.csproj: Imported project: "C:\Program Files (x86)\Mono-2.10.9\lib\mono\xbuild\Microsoft\Portable\v4.0\Microsoft.Portable.CSharp.targets" does not exist. (PortableTest) 
```

我使用支持可移植类库的修改后的 3.1.1 版本的 Monodevelop，我认为在我重新安装 Mono 之前它可以工作。我想该文件夹已被删除。

有没有一种简单的方法可以再次在 monodevelop 中编译可移植库？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T19:41:22.687

尝试针对系统 (Microsoft) .NET 框架而不是 Mono .NET 框架。

# php - 我自己的类在 CodeIgniter 2.1.2 中去哪里了？

> ID：14838614
> 
> 赞同：0
> 
> 时间：2013-02-12T17:49:43.160
> 
> 标签：php, codeigniter, class, entity, entities

我在使用 codeigniter 使用我自己的类时遇到了一些问题。如果不是错误，它总是说无法加载该类。例如，我创建了一个带有属性的类“Student”，只有 getter 和 setter 方法，所以我需要在模型中使用该类来返回一个“Students”数组（我不能用“load->library” ) 或接收一个“学生”来存储它，我还需要那个类让我的控制器对“学生”做一些事情

我在 Windows 中工作，我不想使用 ORM，因为 de app 不大。

我也想在我的模型中做这样的事情：

```
while(something){
    $arr[] = new Student();
}
return $arr; 
```

我能做些什么？我将不胜感激您的回答。

（PD：对不起，我不会说英语）

**我解决了** 我唯一要做的就是创建文件 Student.php（Student 类所在的位置）并将其放在库中，之后：

```
$this->upload->library("Student.php"); 
```

之后我们可以“实例化”这个类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:53:27.103

您正在开发什么操作系统？

在基于 Unix 的操作系统上，文件系统区分大小写，因此请确保在调用库时，例如：

`$this->load->library('student');`磁盘上的文件被调用`Student.php`。然而，在 Windows 上，文件系统不区分大小写，因此这不是真正的问题。

有关更多信息，您应该阅读：

[Linux 中区分大小写的文件名，Windows 中不区分大小写](http://www.codeproject.com/Questions/339068/Case-sensitive-file-names-in-Linux-and-not-in-Wind)

**更新**

根据您的评论，您应该希望像库一样使用您的类，在这种情况下，您应该将文件包含在“库”目录中并加载[文档](http://ellislab.com/codeigniter/user-guide/general/libraries.html)中概述的库。

```
$this->load->library('students'); 
```

那么您将能够使用您的方法

```
$this->students->method_name(); 
```

确保按照上述[autoload](http://ellislab.com/codeigniter/user-guide/general/autoloader.html)手动加载库。

# python - Python sudo 权限

> ID：14838616
> 
> 赞同：0
> 
> 时间：2013-02-12T17:49:47.213
> 
> 标签：python, sudo

我有一个脚本 ( `A.py`) 将`B.py`动态生成新进程 () 但这些脚本需要创建为`root`. 如果我跑

```
$ python A.py 
```

作为普通用户，然后当我运行

```
>>> subprocess.Popen('sudo nohup python B.py &') 
```

我需要输入`root`密码才能开始。我真的不想那样做。

* * *

现在如果我运行第一个脚本`root`

```
$ sudo python A.py 
```

然后我就可以跑了

```
>>> subprocess.Popen('nohup python B.py &') 
```

像平常一样。我担心的是 sudo 的超时时间，它会降到正常权限，然后当`A.py`想要生成/杀死一个进程时，它会要求输入密码并停止按预期工作。

1.  运行会在脚本的生命周期内保持 root 权限，还是会像普通终端一样`sudo python A.py`失去它（我相信默认为 15 分钟）？`sudo timeout`
2.  有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T17:53:43.737

> 运行 sudo python A.py 会在脚本的生命周期内保持 root 权限，还是会`sudo timeout`像普通终端一样失去它（我相信默认为 15 分钟）？

它将在脚本的整个生命周期内保持 root 权限。

运行命令的 root 权限不会被撤销；那不是超时的作用。超时只是控制用户在执行`sudo`命令时必须输入密码的频率。由于您现在具有 root 权限的脚本将直接执行`nohup python B.py`，而不是`sudo nohup python B.py`sudo 超时不会发挥作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:55:34.580

您可以有一个额外的脚本来运行`python B.py`，该脚本由 root 拥有，并[`setuid`](http://en.wikipedia.org/wiki/Setuid)设置了标志。（或者，提供`B.py`适当的 shebang 并使其直接可执行。）然后在任何时候运行它都会以 root 身份运行它。（然后您自然需要确保它受到保护，以便它只能正确运行并且不能执行任意代码，从而提供权限提升。）

# powerbuilder - PowerBuilder如何创建目录表

> ID：14838618
> 
> 赞同：0
> 
> 时间：2013-02-12T17:49:48.457
> 
> 标签：powerbuilder

我开始在新的 Microsoft SQL Server 2000 r2 上使用 PowerBuilder。我知道我应该在数据库中创建目录表，例如 pbcatcol 等，但我一直无法找到执行此操作的脚本。它没有安装在 PowerBuilder 目录树中，它应该是一个 .sql 文件，并且可能对于每个支持的数据库都有不同的版本。我在哪里可以找到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:31:19.817

实际上，这将在 IDE 中自动为您发生；它将为您创建目录表。我不确定这是您第一次连接到数据库，还是第一次打开 DataWindow 画家或从 DataWindow 画家保存，但它们最终会自行结束（在您提供了连接参数之后，当然）。

祝你好运，

特里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T18:35:28.427

特里是对的。发生在我身上，我们使用了与 dbo 不同的架构，我们需要在此处设置架构：数据库配置文件设置/系统标签页/Powerbuilder 目录表所有者

如果未设置，PB 将无法创建这些表。

兄弟。加博尔

# sencha-touch - 从左到右滑动导航视图 - Sencha touch 2.1

> ID：14838621
> 
> 赞同：1
> 
> 时间：2013-02-12T17:50:13.223
> 
> 标签：sencha-touch, sencha-touch-2.1

推送新视图时，该视图从左向右滑动。但是导航视图元素（标题、按钮）从右向左滑动。

我想达到与按下后退按钮相同的效果。

这是我用于滑动视图的代码：

```
 navigationView.animateActiveItem(view, {
                    type: 'slide', 
                    direction: 'right'
                });

            navigationView.push(view); 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T23:05:36.977

您需要在以下位置设置要使用的动画方向`Ext.navigation.View`：

```
Ext.create('Ext.navigation.View', {
    fullscreen : true,
    layout: {
        type: 'card',
        animation: {
            type: 'slide',
            direction: 'right'
        }
    }
}); 
```

[演示](http://www.senchafiddle.com/#8b5Au)

希望这可以帮助

# java - 如何确定当前请求是否为任务 - GAE

> ID：14838625
> 
> 赞同：3
> 
> 时间：2013-02-12T17:50:25.390
> 
> 标签：java, google-app-engine

我正在使用带有 Java 和内置任务队列的 Google AppEngine。

有没有办法确定当前调用是否是源自任务队列的任务？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-12T17:54:26.937

假设您正在使用推送队列，您可以检查是否设置了任何[任务队列标头](https://cloud.google.com/appengine/docs/java/taskqueue/push/creating-handlers#writing_a_push_task_request_handler)。

标题是：

```
X-AppEngine-QueueName
X-AppEngine-TaskName
X-AppEngine-TaskRetryCount
X-AppEngine-TaskExecutionCount
X-AppEngine-TaskETA 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T17:56:51.330

[来自https://cloud.google.com/appengine/docs/java/taskqueue/push/creating-handlers#writing_a_push_task_request_handler](https://cloud.google.com/appengine/docs/java/taskqueue/push/creating-handlers#writing_a_push_task_request_handler)的 GAE 文档：

*   X-AppEngine-QueueName，队列的名称（可能是默认的）
*   X-AppEngine-TaskName，任务的名称，或系统生成的唯一 ID（如果未指定名称）
*   X-AppEngine-TaskRetryCount，该任务重试的次数；对于第一次尝试，此值为 0。此数字包括由于缺少可用实例而导致任务失败并且从未到达执行阶段的尝试。
*   X-AppEngine-TaskExecutionCount，此任务之前在执行阶段失败的次数。此数字不包括由于缺少可用实例而导致的故障。
*   X-AppEngine-TaskETA，任务的目标执行时间，自 1970 年 1 月 1 日起以微秒为单位指定。

请注意，如果您真的关心请求的来源，您可以保护任务 URL 以防止外界调用它。

# javascript - 通过 JavaScript 加载时 Chrome 中的 HTML5 视频问题（仅限大文件）

> ID：14838628
> 
> 赞同：2
> 
> 时间：2013-02-12T17:50:33.517
> 
> 标签：javascript, html, video, large-files

我在 Chrome / Desktop Safari 中遇到了一个非常具体的问题。

当我使用 JavaScript 将视频注入页面时，视频根本不会加载。这不是标记问题，也不是 MIME 类型问题，因为我可以确认视频是页面上的静态元素时正在加载（我正在使用 Ajax 加载此视频）。

它似乎与文件大小有关，因为它适用于所有浏览器中的较小视频。它仅在我尝试流式传输更大的视频时发生。

该方法在 Firefox / IE9 中运行良好，只是在 Chrome / Desktop Safari 中不行。

这是我正在使用的标记，我可以确认正确的 MIME 类型声明在我的 .htaccess 中。

```
 <video autoplay controls class="main-video">
    <source src="/videos/Miranda.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"' />
    <source src="/videos/Miranda.webm" type='video/webm; codecs="vp8, vorbis"' />
    <source src="/videos/Miranda.ogv" type='video/ogg; codecs="theora, vorbis"' />

    <p>
    Sorry, there was a problem playing this video
    </p>
  </video> 
```

# visual-studio - 为什么我不能从另一个项目中引用一个项目（但可以使用静态）？

> ID：14838630
> 
> 赞同：1
> 
> 时间：2013-02-12T17:50:34.700
> 
> 标签：visual-studio, visual-studio-2012, xamarin.ios, monodevelop

这个很奇怪。我有一个 MonoDevelop/MonoTouch 项目（称为**MyApp**），它引用了另一个项目（称为**MyUtils**），它是一个可移植类库（如果相关，则面向 .NET 4.0.3）。

在 MyApp 项目中，我添加了对 MyUtils 的引用。在 Visual Studio 中，这可以正常工作：我可以毫无问题地引用 MyUtils 中的类。

但是在 Mac 上的 MonoDevelop 中，如果我尝试从 MyApp 引用 MyUtils，我不能。它根本看不到项目，并且不能，例如，编写如下内容：

```
using MyUtils.MyNamespace 
```

如果这样做，我会收到“找不到类型或名称空间”错误。

但奇怪的是：MyApp**可以**使用 MyUtils 中的静态类。如果我`public static`从 MyApp 引用 MyUtils 中的一个类，**它就可以工作！** 这有什么可以解释的？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T18:42:59.573

对此的解释是，目前 PCL 的 MonoTouch 实现有点杂乱无章。

适当的工作正在进行中，但与此同时，您需要使用 MonoDevelop 的临时版本，并且您需要注意诸如 Intellisense 和语法突出显示之类的东西在 MonoDevelop 中并不真正起作用。

看：

*   [MonoTouch：使用可移植类库创建多平台应用程序](https://stackoverflow.com/questions/14764011/monotouch-creating-multiplatform-apps-using-portable-class-libraries)
*   [http://slodge.blogspot.co.uk/2013/02/the-future-is-portable.html](http://slodge.blogspot.co.uk/2013/02/the-future-is-portable.html)

* * *

更新 - 临时版本隐藏在对该问题的评论中：

> 对于那些从事 PCL 工作的人，我在这里发布了一个带有改进的 PCL 支持的修补 MonoDevelop 3.1.1 构建：http: [//files.xamarin.com/~jeff/MonoDevelop-3.1.1.dmg](http://files.xamarin.com/~jeff/MonoDevelop-3.1.1.dmg) - 它仍然不完美，但是到目前为止它比官方版本更好（我的补丁将在未来的官方版本中） – jstedfast 2 月 8 日 14:57

# xmonad - Thunderbird 和 dmenu 的 Xmonad 键绑定

> ID：14838631
> 
> 赞同：0
> 
> 时间：2013-02-12T17:50:51.593
> 
> 标签：xmonad

我一直试图让这两个键绑定在我的 Xmonad 设置上工作一段时间，但可惜我失败了。我希望雷鸟在某个工作空间上生成，并在当前正在查看的工作空间上运行 demenu。这是我当前键绑定设置的相关部分：

```
keys' conf@(XConfig {XMonad.modmask = modmask}) = M.fromList $
  [  ((modMask, xK_d), spawnOn "2:Web" "dwb")
  ,  ((modMask, xK-r), spawn "dmenu_run")
  ,  ((modMask, xK_e), spawnOn "3:Email" "Mail"
...other keybindings that work.....
  ] 
```

dwb 键绑定确实有效。在雷鸟一中，代替“邮件”，我还尝试了“雷鸟”和“雷鸟”，但均无济于事。

如果有人能为我完成这项工作，我将不胜感激。从终端打开雷鸟会很烦人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-12T11:15:49.803

[默认配置](http://xmonad.org/xmonad-docs/xmonad/src/XMonad-Config.html)映射（modMask，xK_e）到“切换到物理/Xinerama 屏幕 2”。确保您禁用/更改了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-14T20:41:46.703

1.  尝试将“邮件”替换为“雷鸟”

    ```
    ,  ((modMask, xK_e), spawnOn "3:Email" "Mail" 
    ```

    至

    ```
    ,  ((modMask, xK_e), spawnOn "3:Email" "thunderbird" 
    ```

2.  如果它仍然不起作用，请检查其他一些键配置是否覆盖了键“e”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T12:52:15.207

无论您从终端输入什么来打开 Thunderbird，都应该作为`spawnOn`. 如果一切都失败了，请尝试 Thunderbird 可执行文件的完整路径。

对于可能在谷歌上搜索的其他人，如果不知道在终端中输入什么来启动程序，请以您通常启动的方式启动它（例如从菜单或使用键绑定），然后键入`ps -ef`以查找名称命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-02T12:11:11.573

使用 cli 工具`xprop`并单击 Thunderbird，它会显示 Thunderbird 的类名称，您需要将其放置在此处：

```
,  ((modMask, xK_e), spawnOn "3:Email" "ClassName" 
```

# node.js - 在 Heroku 上找不到 Jade 模板

> ID：14838632
> 
> 赞同：2
> 
> 时间：2013-02-12T17:50:53.650
> 
> 标签：node.js, heroku, express, pug

在本地运行[此Express 应用程序](https://github.com/franklovecchio/stackoverflow-14838632)*有效*。[在Heroku](http://heroku-node-express-test.herokuapp.com/nested)上运行它会在请求`/`或请求时给出粘贴错误`/nested`

```
Error: Failed to lookup view "index"
    at Function.app.render (/app/node_modules/express/lib/application.js:493:17)
    at ServerResponse.res.render (/app/node_modules/express/lib/response.js:753:7)
    at /app/server.js:21:16
    at callbacks (/app/node_modules/express/lib/router/index.js:161:37)
    at param (/app/node_modules/express/lib/router/index.js:135:11)
    at pass (/app/node_modules/express/lib/router/index.js:142:5)
    at Router._dispatch (/app/node_modules/express/lib/router/index.js:170:5)
    at Object.router (/app/node_modules/express/lib/router/index.js:33:10)
    at next (/app/node_modules/express/node_modules/connect/lib/proto.js:199:15)
    at store.get.next (/app/node_modules/express/node_modules/connect/lib/middleware/session.js:309:9)

Error: Failed to lookup view "nested/index"
    at Function.app.render (/app/node_modules/express/lib/application.js:493:17)
    at ServerResponse.res.render (/app/node_modules/express/lib/response.js:753:7)
    at /app/server.js:24:16
    at callbacks (/app/node_modules/express/lib/router/index.js:161:37)
    at param (/app/node_modules/express/lib/router/index.js:135:11)
    at pass (/app/node_modules/express/lib/router/index.js:142:5)
    at Router._dispatch (/app/node_modules/express/lib/router/index.js:170:5)
    at Object.router (/app/node_modules/express/lib/router/index.js:33:10)
    at next (/app/node_modules/express/node_modules/connect/lib/proto.js:199:15)
    at store.get.next (/app/node_modules/express/node_modules/connect/lib/middleware/session.js:309:9) 
```

在我的服务器文件中：

```
express = require 'express'
app = express()

app.configure () ->

  app.set 'views', __dirname + '/views'
  app.set 'view engine', 'jade'

  app.use express.logger('dev')
  app.use express.bodyParser()
  app.use express.methodOverride()
  app.use express.cookieParser()
  app.use express.session(
    secret: 'WTF'
  )
  app.use app.router
  app.use express['static'](process.cwd() + '/public')

  app.get '/', (req, res) ->

    res.render 'index'

  app.get '/nested', (req, res) ->

    res.render 'nested/index'

port = process.env.PORT || 3000

app.listen port, () -> 
  console.log 'Server started on ' + port + '\nPress CTRL-C to stop server.' 
```

在本地，我*不需要*指定`app.set 'views', __dirname + '/views'`服务器来运行和查找文件——不管有没有这个，它都不能在 Heroku 上工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T18:03:22.313

关于您的编辑：

问题可能是个案。虽然字符串指定小写路径：

*   [`res.render 'index'`](https://github.com/franklovecchio/stackoverflow-14838632/blob/3c9f3610d28454cb60f9bdfe76e4b1c1a73ea98a/src/server/server.coffee#L21)
*   [`res.render 'nested/index'`](https://github.com/franklovecchio/stackoverflow-14838632/blob/3c9f3610d28454cb60f9bdfe76e4b1c1a73ea98a/src/server/server.coffee#L25)

这些文件实际上是大写的：

*   [`views/Index.jade`](https://github.com/franklovecchio/stackoverflow-14838632/blob/3c9f3610d28454cb60f9bdfe76e4b1c1a73ea98a/views/Index.jade)
*   [`views/nested/Index.jade`](https://github.com/franklovecchio/stackoverflow-14838632/blob/3c9f3610d28454cb60f9bdfe76e4b1c1a73ea98a/views/nested/Index.jade)

您的本地系统似乎使用了不区分大小写的文件系统，而 Heroku 没有。

* * *

* * *

为了帮助 Express 找到您的视图，您可以设置`'views'`根路径：

```
app.set('views', __dirname + '/views'); 
```

您也可以将绝对路径传递给`res.render()`：

```
res.render(__dirname + '/views/admin/login'); 
```

* * *

另请注意，您可能不需要（也可能不想）通过`req`和：`res`[`res.render()`](http://expressjs.com/api.html#res.render)

```
app.get('/admin/login', function (req, res) {
    res.render('admin/login');
}); 
```

有了它们， 的属性`req`将被包含`locals`在视图中，并且`res`将`callback`被忽略或导致错误，因为它不是`function`.

# python - 在python中退出主循环

> ID：14838635
> 
> 赞同：5
> 
> 时间：2013-02-12T17:51:22.337
> 
> 标签：python, tkinter

虽然我是一种在其他语言方面经验丰富的程序员，但我对 Python 还是很陌生。我一直在尝试做一个非常简单的事情，那就是在启动后退出主循环。这似乎是一件大事。下面的程序只产生一系列事件。一切似乎都在工作，但我无法关闭最后一个窗口......我该怎么办？

```
from Tkinter import *

root=Tk()
theMainFrame=Frame(root)
theMainFrame.pack()

class CloseAfterFinishFrame1(Frame): # Diz que herda os parametros de Frame
    def __init__(self):
        Frame.__init__(self,theMainFrame) # Inicializa com os parametros acima!!
        Label(self,text="Hi",font=("Arial", 16)).pack()
        button = Button (self, text = "I am ready", command=self.CloseWindow,font=("Arial", 12))
        button.pack()            
        self.pack()

    def CloseWindow(self):
        self.forget()
        CloseAfterFinishFrame2()

class CloseAfterFinishFrame2(Frame): # Diz que herda os parametros de Frame
    def __init__(self):
        Frame.__init__(self,theMainFrame) # Inicializa com os parametros acima!!
        Label(self,text="Hey",font=("Arial", 16)).pack()
        button = Button (self, text = "the End", command=self.CloseWindow,font=("Arial", 12))
        button.pack()
        self.pack()        
    def CloseWindow(self):
        self.forget()
        CloseEnd()

class CloseEnd():
    theMainFrame.quit()

CloseAfterFinishFrame1()

theMainFrame.mainloop() 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T18:00:15.373

呼叫`root.quit()`，而不是`theMainFrame.quit`：

```
import Tkinter as tk

class CloseAfterFinishFrame1(tk.Frame):  # Diz que herda os parametros de Frame
    def __init__(self, master):
        self.master = master
        tk.Frame.__init__(self, master)  # Inicializa com os parametros acima!!
        tk.Label(self, text="Hi", font=("Arial", 16)).pack()
        self.button = tk.Button(self, text="I am ready",
                           command=self.CloseWindow, font=("Arial", 12))
        self.button.pack()
        self.pack()

    def CloseWindow(self):
        # disable the button so pressing <SPACE> does not call CloseWindow again
        self.button.config(state=tk.DISABLED)
        self.forget()
        CloseAfterFinishFrame2(self.master)

class CloseAfterFinishFrame2(tk.Frame):  # Diz que herda os parametros de Frame
    def __init__(self, master):
        tk.Frame.__init__(self, master)  # Inicializa com os parametros acima!!
        tk.Label(self, text="Hey", font=("Arial", 16)).pack()
        button = tk.Button(self, text="the End",
                           command=self.CloseWindow, font=("Arial", 12))
        button.pack()
        self.pack()

    def CloseWindow(self):
        root.quit()

root = tk.Tk()
CloseAfterFinishFrame1(root)
root.mainloop() 
```

`CloseEnd`此外，如果您只想调用函数，则无需创建类`root.quit`。

# javascript - 覆盖单个元素的焦点方法

> ID：14838638
> 
> 赞同：0
> 
> 时间：2013-02-12T17:51:32.700
> 
> 标签：javascript, jquery

我正在创建一个自定义组件，该组件需要与本机模糊和焦点功能很好地配合使用。我正在尝试覆盖这些功能以提供我需要的功能。

我能够像这样覆盖原型函数：

```
$('div#foo').__proto__.focus = function(msg) {
    console.log(msg);   
} 
```

问题在于它覆盖了所有 div 的焦点功能。我只想在属于我的组件的特定元素上覆盖此函数。

这是一种显示我想要做的要点的小提琴：http: [//jsfiddle.net/dkrotts/5mXVL/3/](http://jsfiddle.net/dkrotts/5mXVL/3/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T17:53:41.293

如何附加一个新的焦点事件并使用`preventDefault`来阻止正在发生的事情。

```
$('#foo').focus(function(event) {
    event.preventDefault()
    // your code...
} 
```

# c# - 单击按钮后如何使用 javascript 发出请求并使用 ajax MVC Kendo UI 网格调用读取方法

> ID：14838647
> 
> 赞同：0
> 
> 时间：2013-02-12T17:52:08.963
> 
> 标签：c#, javascript, asp.net-mvc-3, kendo-ui

长期以来，我一直在为 MVC 进行 Telerik 扩展，现在我们公司拥有 Kendo UI lic。他们想转换我的页面，现在我面临很多问题。我找到了示例，但仍然缺少一些代码。

我找到了代码

```
 public ActionResult BulkEdit([DataSourceRequest]DataSourceRequest request)
{        
    var NewAssets = db.TurnaroundDumps;
    DataSourceResult result = NewAssets.ToDataSourceResult(request)
    return Json(result, JsonRequestBehavior.AllowGet);
} 
```

和

```
@(Html.Kendo().Grid<PcInventory_v1_1.Models.TurnaroundDump>()
.Name("Grid")
.Columns(columns =>
{
    columns.Bound(p => p.AssetTag);
    columns.Bound(p => p.SerialNumber);
    columns.Bound(p => p.DeptId);
    columns.Bound(p => p.Location);
})
    .DataSource(dataSource => dataSource
        .Ajax() // Specify that the data source is of ajax type
        .Read(read => read.Action("BulkEdit", "Assets")) 
        // Specify the action method and controller name
    ).Pageable()
) 
```

但我没有找到他们正在创建请求的 javascript。

实际上，我想在按钮单击时恢复结果，当用户单击搜索按钮时，我想将请求对象传递给方法，但我不知道如何使用 Kendo UI 来做到这一点。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T18:35:50.090

基本上要向服务器执行请求，您应该使用 Grid 的 dataSource 对象，更具体地说是[读取](http://docs.kendoui.com/api/framework/datasource#read)的对象。

```
$('#gridName').data().kendoGrid.dataSource.read({someExtraParamIfYouWant:"SomeValue"}); 
```

上面的代码将到达您的 dataSource 声明指定的操作方法并传递任何值（如果您传递任何值）。

页面、过滤器、排序、分组等也将传递给操作方法，DataSourceRequest 对象将包含它们。

# javascript - 获取某些文本替换它并将其包装在跨度中？

> ID：14838652
> 
> 赞同：2
> 
> 时间：2013-02-12T17:52:26.907
> 
> 标签：javascript, jquery

我有以下 html`<p class="get">This is some content.</p>`我想做的就是让它像这样：`<p class="get">This is <span>some</span> content.</p>`。

要做到这一点，我知道我应该： 1\. 获取我的特定文本（完成...）
                                                       2\. 将我的文本包装在 span 中（也完成...）
                                                       3\. 用包含我的 span 的文本替换我的文本**（haven'没做过）**

我的问题是**第 3 步**，我只是想不通。那么如何用新文本替换我的“旧”文本？
谢谢你们！！！

[**Fiddle here**](http://jsfiddle.net/V7Wnk/)

我的代码如下所示：

```
$(document).ready(function(){
//get the whole text
var ptext = $(".get").text().split(" "); 
var myText = ptext[2]; 
//alert(ptext[2])
//alert(myText);
if($('.get').text().contains(myText)){
//$('<span>'+myText+'</span>').appendTo($('.get'));
}
else{
alert('no text');
}
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T17:55:41.337

```
var word = "some",
    regex = new RegExp("\\b" + word + "\\b", "g");

$(".get").html(function(i, html) {
    return html.replace(regex, "<span>$&</span>");
}); 
```

**演示：http:** [//jsfiddle.net/V7Wnk/1/](http://jsfiddle.net/V7Wnk/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:55:54.300

```
$('.get').html(function (i, v) {
    return v.replace('some', '<span>some</span>');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T17:58:43.433

```
$('.get').html($(".get").html().replace("some","<span> some </span>")); 
```

# python - 类型检查python？

> ID：14838654
> 
> 赞同：4
> 
> 时间：2013-02-12T17:52:32.947
> 
> 标签：python

有没有办法从用户输入中检查它是什么类型？并做这样的事情：

```
if input == str:
   do this
elif input == int:
   do this
else:
   do this 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T17:54:05.973

你可以用它`isinstance`来检查某物的类型——但你真的可能不想这样做......

这也很大程度上取决于您如何从用户那里获得输入。如果您正在使用`raw_input`，那么它始终是一个字符串，您需要将`try`其转换为您想要的任何类型：

```
try:
   x = int(input):
except ValueError:
   try:
       x = float(input):
   except ValueError:
       print "No recognizable type!" 
```

python 的一个基本原理是鸭式打字。如果一个物体看起来像鸭子，听起来像鸭子，闻起来像鸭子，那么它就是鸭子（前提是您只关心物体的外观、气味和声音）。最终，在 python 中，最好`try`看看它是否是“鸭子”。如果它不是鸭子，那么您捕获异常并处理它（如果您知道如何）。这是你没有看到人们`isinstance`在他们的代码中使用太多的主要原因，也是我警告不要使用它的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:55:30.700

如果您的意思是键盘输入，那么所有输入都是一个字符串。即使用户输入像“88”这样的数字，结果也将是字符串`"88"`而不是整数`88`。但是，您可以使用此模式来判断字符串是否包含数字而不包含其他内容：

```
if input.isdigit():
    print "input is a number"
else:
    print "input is not a number" 
```

更好的方法是将输入转换为一个数字，它将处理注释中提到的“50.0”或“-10”之类的输入（如果小数有效，则使用 float() 或 Decimal() 而不是 int() 这里):

```
try:
    number = int(input)
except ValueError:
    print "input is not a number" 
```

如果您不是指键盘输入，那么有多种方法可以检查类型，但通常最好的办法是简单地使用输入，就好像它是有效的一样，并捕获如果它无效就会出现的异常。这样，您可以根据对象的实际方法和属性定义输入要求，而不仅仅是其名义类（这是“鸭子类型”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T17:55:35.637

您可以使用`isinstance` [http://docs.python.org/2/library/functions.html#isinstance](http://docs.python.org/2/library/functions.html#isinstance)

*例子*

```
isinstance('hello', str) 
```

**返回**真

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T17:54:13.600

我想你正在寻找`isinstance`.

* * *

你打败了我，但我的有一个链接：

[http://docs.python.org/2/library/functions.html#isinstance](http://docs.python.org/2/library/functions.html#isinstance)

* * *

顺便说一句，我一直在测试 PyCharm IDE，如果你`assert isinstance()`在你的代码中，他们会自动为你做类型检查，然后它会自动完成。它还允许您在文档字符串中指定类型参数。然后，它使用此类型的信息来帮助您在路上自动完成。很方便...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T17:57:37.287

`isinstance(input, type)`

`type`内置函数也可以做同样的事情，但`isinstance()`建议使用内置函数来测试对象的类型。

# sql - 如何使用 SQL 使用 DB2 中的存储过程插入表？

> ID：14838659
> 
> 赞同：1
> 
> 时间：2013-02-12T17:52:45.240
> 
> 标签：sql, stored-procedures, cursor, db2

我想知道如何使用 SQL 使用 DB2 中的存储过程插入表中。我创建了一个表，如下所示：

```
create table ADCLIBT.Itest
(ITNBR CHAR(15) CCSID 65535 NOT NULL DEFAULT ''); 
```

此表包含项目列表。使用此列表，我想将各种其他字段插入另一个表。但是，为了举例，假设我只想使用游标一一插入这些值。我编写的存储过程如下：

```
create procedure ADCLIBT.itest1()
    LANGUAGE SQL
BEGIN
    DECLARE itemno char(15);
    DECLARE END_TABLE INT DEFAULT 0;
    DECLARE not_found CONDITION FOR SQLSTATE '20000';
    DECLARE c CURSOR FOR 
        select ITNBR from ADCLIBT.ITEMAT;
    DECLARE CONTINUE HANDLER FOR not_found
    SET END_TABLE = 1;

    open c;
    fetch from c into itemno;
    WHILE END_TABLE = 0 DO
        insert into ADCLIBT.ITEST
                (ITNBR)
                values
        (select a.ITNBR from ADCLIBT.ITEMAT a where ITNBR=itemno GROUP BY a.ITNBR);
    END WHILE;
    Close c;
END; 
```

这给了我一个无限循环。谁能告诉我如何停止无限循环并插入这些记录。我想使用光标，因为我想进一步使用`itemno`来比较并获得单个结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:01:20.670

您正在打开游标但在此期间不获取，您必须在游标的同时进行获取。这是 IBM 文档中的一个示例。

```
CREATE PROCEDURE sum_salaries(OUT sum INTEGER) LANGUAGE SQL
BEGIN
DECLARE SQLSTATE CHAR(5) DEFAULT '00000';
DECLARE p_sum INTEGER;
DECLARE p_sal INTEGER;
DECLARE c CURSOR FOR SELECT SALARY FROM EMPLOYEE;

 SET p_sum = 0;

 OPEN c;

 FETCH FROM c INTO p_sal;

 WHILE(SQLSTATE = '00000') DO
    SET p_sum = p_sum + p_sal;
    FETCH FROM c INTO p_sal; 
 END WHILE;

 CLOSE c;

 SET sum = p_sum;

END% 
```

# twitter-bootstrap - 引导响应菜单

> ID：14838662
> 
> 赞同：1
> 
> 时间：2013-02-12T17:52:58.320
> 
> 标签：twitter-bootstrap

我正在使用这个用 bootstrap 构建的 wordpress 主题，
[http://bootstrapwp.rachelbaker.me/](http://bootstrapwp.rachelbaker.me/) 它会在 ipad 和 iphone 上折叠菜单，但我希望菜单仅在 iphone 上折叠，而不是在 ipad 上折叠。知道怎么做吗？

我在哪里可以编辑？它与css或js或两者有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-29T18:05:57.613

Bootstrap 预加载了@media 查询，因此您需要在核心 Bootstrap.css 文件中修改它们。

在 css 文件中按 ctrl-f 并查找以下内容。

```
 // Landscape phones and down
  @media (max-width: 480px) { ... }

  // Landscape phone to portrait tablet
  @media (max-width: 768px) { ... }

  // Portrait tablet to landscape and desktop
  @media (min-width: 768px) and (max-width: 980px) { ... }

  // Large desktop
  @media (min-width: 1200px) { .. }
```

您可以在此处更改切换菜单启动的时间。

或者，您可以过滤搜索“切换”，这应该会向您显示切换的媒体部分。

# browser - WAMP 目录禁止错误

> ID：14838665
> 
> 赞同：0
> 
> 时间：2013-02-12T17:53:13.773
> 
> 标签：browser, permissions, wamp, http-status-code-403

我在 Windows 7 上运行 WAMP，并且设置了两台虚拟主机——一台 @localhost 和一台 @acutek.local。我可以毫无问题地在浏览器中拉出两个页面，所以我知道基本设置是正确的。localhost 是一个 index.html 文件，但我已经更改了akutreak.local——acutek.local 只是一堆文件，不再是 index HTML 或 PHP 页面。

当我打开akutreak.local 时，我得到一个文件的树结构列表：

![锐度.local 索引的屏幕截图](../Images/eee7cfd6d05d5dc16b269a400ba27198.png)

起初看起来不错；我可以浏览目录并查看其内容。但是，当我尝试加载任何特定文件时，它会失败。我收到“403 Forbidden - 您没有访问权限/权限...”错误。即使我尝试从该屏幕截图加载 robots.txt 文件。但是，如果我将 HTML 文件添加到与 robots.txt 相同的目录并尝试从浏览器中打开它，它会加载得很好。

我没有在其他 StackOverflow 帖子中看到任何可以解释这一点的答案。出于好奇，有人知道为什么我会收到非 html 文件的禁止错误吗？我会假设如果浏览器显示文件有问题，那么错误将不是权限错误。

编辑

这是我的 httpd.conf 文件：（localhost 是 C:/wamp/www，acutek.local 是 C:/wamp/acutek）

```
#
# This is the main Apache HTTP server configuration file.  It contains the
# configuration directives that give the server its instructions.
# See <URL:http://httpd.apache.org/docs/2.2> for detailed information.
# In particular, see 
# <URL:http://httpd.apache.org/docs/2.2/mod/directives.html>
# for a discussion of each configuration directive.
#
# Do NOT simply read the instructions in here without understanding
# what they do.  They're here only as hints or reminders.  If you are unsure
# consult the online docs. You have been warned.  
#
# Configuration and logfile names: If the filenames you specify for many
# of the server's control files begin with "/" (or "drive:/" for Win32), the
# server will use that explicit path.  If the filenames do *not* begin
# with "/", the value of ServerRoot is prepended -- so "logs/foo.log"
# with ServerRoot set to "C:/Program Files/Apache Software Foundation/Apache2.2" 

will be interpreted by the
# server as "C:/Program Files/Apache Software Foundation/Apache2.2/logs/foo.log".
#
# NOTE: Where filenames are specified, you must use forward slashes
# instead of backslashes (e.g., "c:/apache" instead of "c:\apache").
# If a drive letter is omitted, the drive on which Apache.exe is located
# will be used by default.  It is recommended that you always supply
# an explicit drive letter in absolute paths to avoid confusion.

#
# ServerRoot: The top of the directory tree under which the server's
# configuration, error, and log files are kept.
#
# Do not add a slash at the end of the directory path.  If you point
# ServerRoot at a non-local disk, be sure to point the LockFile directive
# at a local disk.  If you wish to share the same ServerRoot for multiple
# httpd daemons, you will need to change at least LockFile and PidFile.
#
ServerRoot "c:/wamp/bin/apache/apache2.2.22"

#
# Listen: Allows you to bind Apache to specific IP addresses and/or
# ports, instead of the default. See also the <VirtualHost>
# directive.
#
# Change this to Listen on specific IP addresses as shown below to 
# prevent Apache from glomming onto all bound IP addresses.
#
#Listen 12.34.56.78:80
Listen *:80

#
# Dynamic Shared Object (DSO) Support
#
# To be able to use the functionality of a module which was built as a DSO you
# have to place corresponding `LoadModule' lines at this location so the
# directives contained in it are actually available _before_ they are used.
# Statically compiled modules (those listed by `httpd -l') do not need
# to be loaded here.
#
# Example:
# LoadModule foo_module modules/mod_foo.so
#
LoadModule actions_module modules/mod_actions.so
LoadModule alias_module modules/mod_alias.so
LoadModule asis_module modules/mod_asis.so
LoadModule auth_basic_module modules/mod_auth_basic.so
#LoadModule auth_digest_module modules/mod_auth_digest.so
#LoadModule authn_alias_module modules/mod_authn_alias.so
#LoadModule authn_anon_module modules/mod_authn_anon.so
#LoadModule authn_dbd_module modules/mod_authn_dbd.so
#LoadModule authn_dbm_module modules/mod_authn_dbm.so
LoadModule authn_default_module modules/mod_authn_default.so
LoadModule authn_file_module modules/mod_authn_file.so
#LoadModule authnz_ldap_module modules/mod_authnz_ldap.so
#LoadModule authz_dbm_module modules/mod_authz_dbm.so
LoadModule authz_default_module modules/mod_authz_default.so
LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
LoadModule authz_host_module modules/mod_authz_host.so
#LoadModule authz_owner_module modules/mod_authz_owner.so
LoadModule authz_user_module modules/mod_authz_user.so
LoadModule autoindex_module modules/mod_autoindex.so
#LoadModule cache_module modules/mod_cache.so
#LoadModule cern_meta_module modules/mod_cern_meta.so
LoadModule cgi_module modules/mod_cgi.so
#LoadModule charset_lite_module modules/mod_charset_lite.so
#LoadModule dav_module modules/mod_dav.so
#LoadModule dav_fs_module modules/mod_dav_fs.so
#LoadModule dav_lock_module modules/mod_dav_lock.so
#LoadModule dbd_module modules/mod_dbd.so
#LoadModule deflate_module modules/mod_deflate.so
LoadModule dir_module modules/mod_dir.so
#LoadModule disk_cache_module modules/mod_disk_cache.so
#LoadModule dumpio_module modules/mod_dumpio.so
LoadModule env_module modules/mod_env.so
#LoadModule expires_module modules/mod_expires.so
#LoadModule ext_filter_module modules/mod_ext_filter.so
#LoadModule file_cache_module modules/mod_file_cache.so
#LoadModule filter_module modules/mod_filter.so
#LoadModule headers_module modules/mod_headers.so
#LoadModule ident_module modules/mod_ident.so
#LoadModule imagemap_module modules/mod_imagemap.so
LoadModule include_module modules/mod_include.so
#LoadModule info_module modules/mod_info.so
LoadModule isapi_module modules/mod_isapi.so
#LoadModule ldap_module modules/mod_ldap.so
#LoadModule logio_module modules/mod_logio.so
LoadModule log_config_module modules/mod_log_config.so
#LoadModule log_forensic_module modules/mod_log_forensic.so
#LoadModule mem_cache_module modules/mod_mem_cache.so
LoadModule mime_module modules/mod_mime.so
#LoadModule mime_magic_module modules/mod_mime_magic.so
LoadModule negotiation_module modules/mod_negotiation.so
#LoadModule proxy_module modules/mod_proxy.so
#LoadModule proxy_ajp_module modules/mod_proxy_ajp.so
#LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
#LoadModule proxy_connect_module modules/mod_proxy_connect.so
#LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
#LoadModule proxy_http_module modules/mod_proxy_http.so
#LoadModule rewrite_module modules/mod_rewrite.so
LoadModule setenvif_module modules/mod_setenvif.so
#LoadModule speling_module modules/mod_speling.so
#LoadModule ssl_module modules/mod_ssl.so
#LoadModule status_module modules/mod_status.so
#LoadModule substitute_module modules/mod_substitute.so
#LoadModule unique_id_module modules/mod_unique_id.so
#LoadModule userdir_module modules/mod_userdir.so
#LoadModule usertrack_module modules/mod_usertrack.so
#LoadModule version_module modules/mod_version.so
#LoadModule vhost_alias_module modules/mod_vhost_alias.so
LoadModule php5_module "c:/wamp/bin/php/php5.3.13/php5apache2_2.dll"

<IfModule !mpm_netware_module>
<IfModule !mpm_winnt_module>
#
# If you wish httpd to run as a different user or group, you must run
# httpd as root initially and it will switch.  
#
# User/Group: The name (or #number) of the user/group to run httpd as.
# It is usually good practice to create a dedicated user and group for
# running httpd, as with most system services.
#
User daemon
Group daemon

</IfModule>
</IfModule>

# 'Main' server configuration
#
# The directives in this section set up the values used by the 'main'
# server, which responds to any requests that aren't handled by a
# <VirtualHost> definition.  These values also provide defaults for
# any <VirtualHost> containers you may define later in the file.
#
# All of these directives may appear inside <VirtualHost> containers,
# in which case these default settings will be overridden for the
# virtual host being defined.
#

#
# ServerAdmin: Your address, where problems with the server should be
# e-mailed.  This address appears on some server-generated pages, such
# as error documents.  e.g. admin@your-domain.com
#
ServerAdmin admin@localhost

#
# ServerName gives the name and port that the server uses to identify itself.
# This can often be determined automatically, but we recommend you specify
# it explicitly to prevent problems during startup.
#
# If your host doesn't have a registered DNS name, enter its IP address here.
#
ServerName localhost:80

#
# DocumentRoot: The directory out of which you will serve your
# documents. By default, all requests are taken from this directory, but
# symbolic links and aliases may be used to point to other locations.
#
DocumentRoot "c:/wamp/"

#
# Each directory to which Apache has access can be configured with respect
# to which services and features are allowed and/or disabled in that
# directory (and its subdirectories). 
#
# First, we configure the "default" to be a very restrictive set of 
# features.  
#
<Directory />
    Options FollowSymLinks
    AllowOverride None
    Order deny,allow
    allow from all
    allow from ::1
    allow from 127.0.0.1
</Directory>

#
# Note that from this point forward you must specifically allow
# particular features to be enabled - so if something's not working as
# you might expect, make sure that you have specifically enabled it
# below.
#

#
# This should be changed to whatever you set DocumentRoot to.
#
<Directory "c:/wamp/">
    #
    # Possible values for the Options directive are "None", "All",
    # or any combination of:
    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
    #
    # Note that "MultiViews" must be named *explicitly* --- "Options All"
    # doesn't give it to you.
    #
    # The Options directive is both complicated and important.  Please see
    # http://httpd.apache.org/docs/2.2/mod/core.html#options
    # for more information.
    #
    Options Indexes FollowSymLinks

    #
    # AllowOverride controls what directives may be placed in .htaccess files.
    # It can be "All", "None", or any combination of the keywords:
    #   Options FileInfo AuthConfig Limit
    #
    AllowOverride all

    #
    # Controls who can get stuff from this server.
    #

#   onlineoffline tag - don't remove
    Order Deny,Allow
    Deny from all
    Allow from all

</Directory>

#
# DirectoryIndex: sets the file that Apache will serve if a directory
# is requested.
#
<IfModule dir_module>
    DirectoryIndex index.php index.php3 index.html index.htm
</IfModule>

#
# The following lines prevent .htaccess and .htpasswd files from being 
# viewed by Web clients. 
#
<FilesMatch "^\.ht">
    Order allow,deny
    Deny from all
    Satisfy All
</FilesMatch>

#
# ErrorLog: The location of the error log file.
# If you do not specify an ErrorLog directive within a <VirtualHost>
# container, error messages relating to that virtual host will be
# logged here.  If you *do* define an error logfile for a <VirtualHost>
# container, that host's errors will be logged there and not here.
#
ErrorLog "c:/wamp/logs/apache_error.log"

#
# LogLevel: Control the number of messages logged to the error_log.
# Possible values include: debug, info, notice, warn, error, crit,
# alert, emerg.
#
LogLevel warn

<IfModule log_config_module>
    #
    # The following directives define some format nicknames for use with
    # a CustomLog directive (see below).
    #
    LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" 

combined
    LogFormat "%h %l %u %t \"%r\" %>s %b" common

    <IfModule logio_module>
      # You need to enable mod_logio.c to use %I and %O
      LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %I 

%O" combinedio
    </IfModule>

    #
    # The location and format of the access logfile (Common Logfile Format).
    # If you do not define any access logfiles within a <VirtualHost>
    # container, they will be logged here.  Contrariwise, if you *do*
    # define per-<VirtualHost> access logfiles, transactions will be
    # logged therein and *not* in this file.
    #
    CustomLog "c:/wamp/logs/access.log" common

    #
    # If you prefer a logfile with access, agent, and referer information
    # (Combined Logfile Format) you can use the following directive.
    #
    #CustomLog "logs/access.log" combined
</IfModule>

<IfModule alias_module>
    #
    # Redirect: Allows you to tell clients about documents that used to 
    # exist in your server's namespace, but do not anymore. The client 
    # will make a new request for the document at its new location.
    # Example:
    # Redirect permanent /foo http://localhost/bar

    #
    # Alias: Maps web paths into filesystem paths and is used to
    # access content that does not live under the DocumentRoot.
    # Example:
    # Alias /webpath /full/filesystem/path
    #
    # If you include a trailing / on /webpath then the server will
    # require it to be present in the URL.  You will also likely
    # need to provide a <Directory> section to allow access to
    # the filesystem path.

    #
    # ScriptAlias: This controls which directories contain server scripts. 
    # ScriptAliases are essentially the same as Aliases, except that
    # documents in the target directory are treated as applications and
    # run by the server when requested rather than as documents sent to the
    # client.  The same rules about trailing "/" apply to ScriptAlias
    # directives as to Alias.
    #
    ScriptAlias /cgi-bin/ "cgi-bin/"

</IfModule>

<IfModule cgid_module>
    #
    # ScriptSock: On threaded servers, designate the path to the UNIX
    # socket used to communicate with the CGI daemon of mod_cgid.
    #
    #Scriptsock logs/cgisock
</IfModule>

#
# "C:/Program Files/Apache Software Foundation/Apache2.2/cgi-bin" should be 

changed to whatever your ScriptAliased
# CGI directory exists, if you have that configured.
#
<Directory "cgi-bin">
    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
</Directory>

#
# DefaultType: the default MIME type the server will use for a document
# if it cannot otherwise determine one, such as from filename extensions.
# If your server contains mostly text or HTML documents, "text/plain" is
# a good value.  If most of your content is binary, such as applications
# or images, you may want to use "application/octet-stream" instead to
# keep browsers from trying to display binary files as though they are
# text.
#
DefaultType text/plain

<IfModule mime_module>
    #
    # TypesConfig points to the file containing the list of mappings from
    # filename extension to MIME-type.
    #
    TypesConfig conf/mime.types

    #
    # AddType allows you to add to or override the MIME configuration
    # file specified in TypesConfig for specific file types.
    #
    #AddType application/x-gzip .tgz
    #
    # AddEncoding allows you to have certain browsers uncompress
    # information on the fly. Note: Not all browsers support this.
    #
    #AddEncoding x-compress .Z
    #AddEncoding x-gzip .gz .tgz
    #
    # If the AddEncoding directives above are commented-out, then you
    # probably should define those extensions to indicate media types:
    #
    AddType application/x-compress .Z
    AddType application/x-gzip .gz .tgz
    AddType application/x-httpd-php .php
    AddType application/x-httpd-php .php3

    #
    # AddHandler allows you to map certain file extensions to "handlers":
    # actions unrelated to filetype. These can be either built into the server
    # or added with the Action directive (see below)
    #
    # To use CGI scripts outside of ScriptAliased directories:
    # (You will also need to add "ExecCGI" to the "Options" directive.)
    #
    #AddHandler cgi-script .cgi

    # For type maps (negotiated resources):
    #AddHandler type-map var

    #
    # Filters allow you to process content before it is sent to the client.
    #
    # To parse .shtml files for server-side includes (SSI):
    # (You will also need to add "Includes" to the "Options" directive.)
    #
    #AddType text/html .shtml
    #AddOutputFilter INCLUDES .shtml
</IfModule>

#
# The mod_mime_magic module allows the server to use various hints from the
# contents of the file itself to determine its type.  The MIMEMagicFile
# directive tells the module where the hint definitions are located.
#
#MIMEMagicFile conf/magic

#
# Customizable error responses come in three flavors:
# 1) plain text 2) local redirects 3) external redirects
#
# Some examples:
#ErrorDocument 500 "The server made a boo boo."
#ErrorDocument 404 /missing.html
#ErrorDocument 404 "/cgi-bin/missing_handler.pl"
#ErrorDocument 402 http://localhost/subscription_info.html
#

#
# EnableMMAP and EnableSendfile: On systems that support it, 
# memory-mapping or the sendfile syscall is used to deliver
# files.  This usually improves server performance, but must
# be turned off when serving from networked-mounted 
# filesystems or if support for these functions is otherwise
# broken on your system.
#
#EnableMMAP off
#EnableSendfile off

# Supplemental configuration
#
# The configuration files in the conf/extra/ directory can be 
# included to add extra features or to modify the default configuration of 
# the server, or you may simply copy their contents here and change as 
# necessary.

# Server-pool management (MPM specific)
#Include conf/extra/httpd-mpm.conf

# Multi-language error messages
#Include conf/extra/httpd-multilang-errordoc.conf

# Fancy directory listings
Include conf/extra/httpd-autoindex.conf

# Language settings
#Include conf/extra/httpd-languages.conf

# User home directories
#Include conf/extra/httpd-userdir.conf

# Real-time info on requests and configuration
#Include conf/extra/httpd-info.conf

# Virtual hosts
#Include conf/extra/httpd-vhosts.conf

# Local access to the Apache HTTP Server Manual
#Include conf/extra/httpd-manual.conf

# Distributed authoring and versioning (WebDAV)
#Include conf/extra/httpd-dav.conf

# Various default settings
#Include conf/extra/httpd-default.conf

# Secure (SSL/TLS) connections
#Include conf/extra/httpd-ssl.conf
#
# Note: The following must must be present to support
#       starting without SSL on platforms with no /dev/random equivalent
#       but a statically compiled-in mod_ssl.
#
<IfModule ssl_module>
SSLRandomSeed startup builtin
SSLRandomSeed connect builtin
</IfModule>

Include "c:/wamp/alias/*"

# ### Virtual Host Setups (WAMP doesn't like httpd-vhosts...) ###
NameVirtualHost *:80

<VirtualHost *:80>
    DocumentRoot "C:/wamp/www"
    ServerName localhost
</VirtualHost>

<VirtualHost *:80>
    DocumentRoot "C:/wamp/acutek"
    ServerName acutek.local
    <Directory "C:/wamp/acutek">
        Options Indexes FollowSymLinks MultiViews
        Allow from All
        Order Allow,Deny
        AllowOverride All
    </Directory>
</VirtualHost> 
```

# java - 来自 Domino OSGi 插件的 java.lang.NoClassDefFoundError: org.apache.commons.logging.Logfactory 抛出异常

> ID：14838666
> 
> 赞同：1
> 
> 时间：2013-02-12T17:53:17.627
> 
> 标签：java, servlets, osgi, lotus-domino

我正在构建一个 IBM Domino OSGi 插件，它打包了一个包含`HttpServlet`.

我想从using和（从 OSGi 包中提取）进行 Http 调用（ `get`,`post`等）。`Servlet``org.apache.httpcomponents.httpclient_4.2.3``org.apache.httpcomponents.httpcore_4.2.3`

我已将这两个`jar`文件添加到`domino\jvm\lib\ext`，对 file* 进行了通常的更改`java.policy`，并将 jar 添加到构建路径中。

当我添加代码来创建和使用`DefaultHttpClient`服务器时会抛出错误：

`java.lang.NoClassDefFoundError: org.apache.commons.logging.Logfactory`

我知道在 Domino 的 java 实现中记录是一个有点棘手的主题。奇怪的是，我使用 NSF 包含的 Servlet 运行相同的代码，它运行得很好。但是在我的 OSGi 上下文中，它会中断。如果我使用包含说它`/log.nsf/`仍然中断的 url 调用 servlet。

任何帮助都感激不尽！

```
grant {
permission java.security.AllPermission;
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T17:46:36.633

我之前在 XPages 中遇到过 org.apache 包的问题，​​主要是因为它们尝试登录到文件系统并且安全策略不喜欢那样。将其添加为引用库等，它使用与 XPages 运行时相同的 ClassLoader，因此尝试使用来自服务器的 ClassLoader，这时您会收到 NoClassDefFoundError。

尝试将其添加到您的 OSGi 插件的 WebContent\WEB-INF\lib 文件夹中。将它添加到该路径在 NSF 中有效，因为它使用不同的 ClassLoader。它也可以很好地规避您在 OSGi 插件中遇到的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:01:40.987

我不确定为什么它在您的 NSF 实现中有效，但看起来您需要**commons-logging-1.1.1.jar**。这应该包含在*httpcomponents*下载中。或者你可以从这里下载：

[http://commons.apache.org/logging/download_logging.cgi](http://commons.apache.org/logging/download_logging.cgi)

# css - 如何使用 CSS 调整 HTML5 验证指示器

> ID：14838667
> 
> 赞同：1
> 
> 时间：2013-02-12T17:53:21.443
> 
> 标签：css, html

在我使用的 HTML5 输入字段`required`和 CSS 中显示 asterix 和其他指示符，以告诉用户他们的输入是有效的。对于我的一个输入字段，`type="number"`其中放置了箭头以将值向上和向下调整`1`。不幸的是，这些箭头覆盖了指标。我一直在尝试使用 CSS 来调整这些指标的位置，而我认为这将是一项简单的任务。我可以很容易地为一般情况调整所有位置，但不能为一个目标情况调整。

![问题示例](../Images/a875f651aec63766e4d48dca1a1754ea.png)

HTML

```
<li>
   <label for="quantity">Quantity:</label>
   <input class="quantity" type="number" min="0" name="quantity" placeholder="quantity" required />
<li> 
```

CSS

```
.contact_form input:required, .contact_form textarea:required {
    background: #fff url(../image/product/none/red_asterisk.png) no-repeat 98% center;
}

.contact_form .quantity input:required {
    background: #fff url(../image/product/none/red_asterisk.png) no-repeat 92% center;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:24:51.147

您可以通过以下方式定位输入类型编号：

```
.contact_form input[type="number"]:required 
```

然后调整星号位置。

```
.contact_form input[type="number"]:required {
    background: #fff url(../image/product/none/red_asterisk.png) no-repeat 96% center;
} 
```

# php - 根据服务器日期和时间显示和隐藏

> ID：14838669
> 
> 赞同：-5
> 
> 时间：2013-02-12T17:53:25.183
> 
> 标签：php, javascript, css

所以这就是我想要做的 - 我有以下代码：

```
<div id="on">
<p>We are: <span class="onair"><a href="#">ON AIR</a></span></p>
</div> 
<div id="off">
<p>We are: <span class="offair"><a href="#">OFF AIR</a></span></p> 
</div> 
```

我想做的是在周二下午 3 点到下午 4 点（服务器时间）“显示”“开启”div，同时隐藏“关闭”div - 然后每隔一个日期/时间切换一次。

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:10:15.567

如果您使用 PHP，您可以在服务器端执行逻辑语句来呈现您需要的确切信息，而不是稍后在客户端计算它。

*（如果您不关心时间来自哪里，客户端解决方案也可以使用）*

(1) 您可以让服务器为您**呈现可在脚本中使用的 javascript**

```
//if you want the server's time you can do this:
<?php $timestamp = time(); ?>

//render variables in javascript instead of html
<?php 
  echo <<<EOD
    <script>
     var timestamp = ${timestamp}
     //then later in your javascript process the timestamp logic to update the dom
    </script>
  EOD;
?> 
```

(2) 你也可以让服务器根据条件是真还是假**来在body标签中渲染一个className 。**（这通常是我的首选方法）

```
//onAirClass( min, max, timestamp ) returns className 
//this function returns onair or offair class if the timestamp is in range
function onAirClass( timeMin, timeMax, timestamp ){
  if( timestamp >= timeMin && timestamp <= timeMax ){
    return 'onair';
  }
  return 'offair'
}

//using onAirClass( min, max, timestamp ) 
<?php $bodyClass = $bodyClass . ' ' . onAirClass( $timestamp ); ?>
<?php echo "<body class='${bodyClass}'>"; ?> 
```

然后在您的样式中，您可以根据 body 标记的类继承来隐藏或显示要隐藏或显示的元素。

查看[PHP 时间函数](http://php.net/manual/en/function.time.php)以创建新的时间字符串，并为您的 onAirClass() 函数进行时间计算

**[如何检查给定时间范围之间的时间](https://stackoverflow.com/questions/4191867/php-function-to-check-time-between-the-given-range)**

* * *

**更新**

*更正了 PHP 语法错误*

@maerics 解决方案还可以，具体取决于您想做什么，**只是永远不要做这样的事情：**

```
var timestamp = $('#server-timestamp').text(); 
```

最终，有很多方法可以做同样的事情，但有些事情比其他事情更“正确”。

有理由在客户端与服务器端进行一些计算，反之亦然。作为新手开发人员，只要确保您使用的任何方法：

*   很简单
*   高效（不做任何不必要或多余的事情）
*   符合最佳实践

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T19:21:02.757

实际上，这**可以**通过使用您的时区偏移量仅使用 JavaScript 来完成，**而无需任何服务器端代码。**

这是您可以使用的功能：

```
var onAir = function (day, start, end, timezone) {
    var local, utc, show, days, onAir, startValues, endValues, startTime, endTime, startMinutes, endMinutes, showMinutes;

    // by default, we are not on air    
    onAir = false;

    // map day numbers to indexes
    days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Firday', 'Saturday'];

    // convert start/end times to date objects
    startValues = start.split(':');
    endValues = end.split(':');
    startTime = new Date();
    endTime = new Date();
    startTime.setHours(startValues[0], startValues[1]);
    endTime.setHours(endValues[0], endValues[1]);

    // add the hours minutes together to get total minutes
    startMinutes = (startTime.getHours() * 60) + startTime.getMinutes();
    endMinutes = (endTime.getHours() * 60) + endTime.getMinutes();

    // get the current local time
    local = new Date();

    // get the current time in the show's timezone
    utc = local.getTime() + (local.getTimezoneOffset() * 60000);
    show = new Date(utc + (3600000*timezone));

    // convert the show hours + minutes to just minutes
    showMinutes = (show.getHours() * 60) + show.getMinutes();

    // test to see if the show is going on right now
    if (days[show.getDay()] === day && (showMinutes >= startMinutes && showMinutes <= endMinutes)) {
        onAir = true;
    }

    return onAir;
}

// example: Air time is Tuesday between 1-2pm Central Time (-6)
var texasShowOnAir = onAir('Tuesday', '13:00', '14:00', '-6'));

// now check if we are on air
if (texasShowOnAir) {
    // do stuff here...
} 
```

你现在可以像这样使用这个函数：

```
var check = onAir('DAY', 'STARTTIME', 'ENDTIME', 'YOURTIMEZONE'); 
```

这将返回一个`true/false`. 请务必使用 24 小时格式。

* * *

我什至认为这比使用服务器的时间戳**更好**，因为通常（特别是如果您有共享主机），您的服务器可以设置在与您不同的时区。

**这是一个演示小提琴：http:** [//jsfiddle.net/stevenschobert/mv54B/](http://jsfiddle.net/stevenschobert/mv54B/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T18:06:00.740

让服务器在生成页面时提供时间戳，让客户端在加载页面时也生成时间戳，以便您可以计算两个系统之间的时间偏移。

然后，您可以在某个时间间隔调用一个函数，检查当前服务器时间以查看它是否在下午 3 点至下午 4 点期间，并根据需要显示/隐藏目标元素。

从服务器：

```
<div id="server-timestamp" style="display:none">2013-02-12T18:01:19Z</div> 
```

在客户端：

```
$(document).on('load', function() {
  var serverTime = new Date($('#server-timestamp').text())
    , clientTime = new Date()
    , offsetMilliseconds = (clientTime - serverTime);
  setInterval(function() {
    // If server time is 3pm-4pm then hide/show divs...
  }, 1000 /* every second */);
}); 
```

# c++ - 对 std::for_each 实现的限制

> ID：14838672
> 
> 赞同：10
> 
> 时间：2013-02-12T17:53:27.887
> 
> 标签：c++, c++11, foreach

在 C++ 标准 ( `std::for_each`) 的 §25.2.4.2 中：

```
template<class InputIterator, class Function>   Function
for_each(InputIterator first, InputIterator last, Function f); 
```

> *效果*：将 f 应用于取消引用范围 [first,last) 中的每个迭代器的结果， **从 first 开始，一直到 last - 1**。

*   这是否意味着 f*按顺序*应用于容器的元素？
*   如果是这样，[libstdc++的并行模式是否](http://gcc.gnu.org/onlinedocs/libstdc++/manual/parallel_mode.html)违反了它？
*   如果不是，为什么第 6.5.4 节中基于范围的 for 循环没有实现为对 std::for_each 的调用？（这将允许基于范围的 for 循环也被实现自动并行化）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T17:58:43.510

*   这是否意味着*按顺序*`f`应用于容器的元素？

 *我最初说不，但我认为这确实意味着，是的。其他算法不包括该特定措辞。

*   如果是这样，libstdc++的并行模式是否违反了它？

也许，并行模式是一种扩展，并且有点实验性，并不是真正声称是标准库的 100% 符合的实现。（如果它确实声称在文档中的某个地方我会修复文档！;-)

*   如果不是，为什么第 6.5.4 节中基于范围的 for 循环没有实现为对 std::for_each 的调用？（这将允许基于范围的 for 循环也可以自动并行化）

基于范围的`for`工作不依赖于标准库。如果`std::begin`和`std::end`可见，它们可能会被使用，但不是必需的。`std::for_each`此外，它将涉及将循环体打包为 lambda，因此您有一个函数对象要传递`for`给写`for`循环。但真正的原因可能是没有人想过那样做！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-12T18:39:31.620

> 如果不是，为什么第 6.5.4 节中基于范围的 for 循环没有实现为对 std::for_each 的调用？（这将允许基于范围的 for 循环也可以自动并行化）

好吧，标准`std::for_each`不允许“自动并行化”（它必须按顺序*进行*，如标准中所述），所以就是这样。但更重要的是，基于范围`for`允许除`std::for_each`. 例如，作为一种语言功能，您可以*`break`*脱离循环。您可以使用`goto`或其他语言结构。等等。

`std::for_each`是基于为每次迭代调用一个函数。而且你不能真正“打破”一个功能。*

# java - Documentum DFS：服务调用超时

> ID：14838680
> 
> 赞同：1
> 
> 时间：2013-02-12T17:54:00.467
> 
> 标签：java, documentum, documentum-dfs

我正在使用 DFS Java API，想知道是否有人知道一种简单的方法来为可以在服务上下文中配置的服务调用配置客户端超时，例如？

我遇到过一些罕见的情况，即 Documentum 存储库没有响应，这就是我考虑对所有 DFS 调用进行一般超时的原因。

为了测试挂起的服务调用，我创建了一个虚拟 TBO 实现，它在更新文档时简单地阻塞线程 10 分钟：

```
@Override
 public void saveEx(boolean keepLock, String versionLabels) throws DfException {
  if (isNew() == false) {
    try {
      Thread.sleep(1000*60*10);
    } catch (InterruptedException e) {
      e.printStackTrace();
    }
  }
  super.saveEx(keepLock, versionLabels);
} 
```

我不确定这是否与挂起的服务调用完全一样，但至少在我的测试中它按预期工作——我调用**对象服务的****更新**方法大约需要 10 分钟。

 **有没有我还没有找到的配置，或者可能是一个运行时属性来传递给服务上下文来配置超时？

我更愿意为此使用 DFS 的现有功能，而不是实现我自己的机制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:13:03.687

您是否尝试过编辑中的值`dfs-runtime.properties`？我不认为超时可以是特定于上下文的，但是您应该能够为整个客户端更改它。

转自[https://community.emc.com/message/3249#3249](https://community.emc.com/message/3249#3249)

“请参阅部署指南的*服务器运行时启动设置*部分。

以下列表描述了`dfs-runtime.properties`文件根据其位置而采取的优先级：

1.  `local-dfs‑runtime.properties`本地类路径中的文件
2.  使用指定的运行时属性文件`‑Ddfs.runtime.properties.file`
3.  `dfs‑runtime.properties`包装`emc‑dfs‑rt.jar`

例如，`local-dfs‑runtime.propertie`本地类路径上的 s 文件中的设置将优先于位于其中的文件或使用参数指定的`dfs‑runtime.properties`文件中的相同设置。对配置进行任何更改后，必须重新启动 DFS 应用程序。作为最佳实践，使用在文件中部署的提供的配置文件作为您的基本设置，并使用外部文件覆盖您特别希望更改的设置。”`emc‑dfs‑rt.jar``‑D``emc‑dfs‑rt.jar`**

# php - 使用 curl 获取 javascript 设置的 cookie

> ID：14838681
> 
> 赞同：0
> 
> 时间：2013-02-12T17:54:03.383
> 
> 标签：php, cookies, curl, session-cookies

我正在编写一个使用 curl 来获取网页内容的脚本。我搜索标题`Set-Cookie`以收集页面设置的所有 cookie 的名称。问题是一些 cookie 是从加载到页面中的 javascript 文件中设置的，当然这些 cookie 不包含在响应标头中。

那么，有没有办法使用 curl 从网页中获取所有 cookie，包括通过 javascript 生成的那些？

目前我正在做这样的事情：

```
$curl = curl_init();
curl_setopt($curl, CURLOPT_VERBOSE, 1);
curl_setopt($curl, CURLOPT_HEADER, 1);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($curl, CURLOPT_URL, <www.example.com>);
$response = curl_exec($curl);
$http_code = curl_getinfo($curl, CURLINFO_HTTP_CODE);
if ($http_code == 200) {
  $headers = substr($response, 0, curl_getinfo($curl, CURLINFO_HEADER_SIZE));
  // check headers for all cookies sent in response
}
curl_close($curl); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T17:58:53.307

cURL 不会运行 javascript，所以不，不会有获取这些 cookie 的方法。您必须模拟或自动化浏览器才能实现这一目标。幸运的是，有一些工具可以帮助您。也许看看[PHP-webdriver](https://github.com/facebook/php-webdriver)

# c - 我应该避免同名的局部变量吗？

> ID：14838694
> 
> 赞同：1
> 
> 时间：2013-02-12T17:54:25.427
> 
> 标签：c

相关 -[临时局部变量的命名约定](https://stackoverflow.com/questions/1362063/naming-convention-of-temp-local-variables)

该问题的答案是局部变量应该具有简洁的名称。如果我的局部变量（在不同的函数中）具有相同的名称，会不会有问题？例如

```
int foo(void){
 int counter;
 do stuff with counter;
}

int bar(void){
 int counter;
 do stuff with counter;
}

int main(void){

 foo();
 bar();
 foo();

 return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T17:55:14.077

在不同的函数中声明的同名变量没有错。它们的范围是函数本身。如果这是一个问题，它会使编程更像是一个 PITA。我们很快就会用完循环变量名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T17:55:11.937

不，您的`counter`变量的范围仅限于声明它们的块。`i`请注意，在不同的函数中为循环变量使用相同的名称是很常见的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T17:56:04.513

不。从概念上讲，功能包含不同的任务/范围。可能需要两个名称相似的局部变量，因为其功能可能相同。这不是技术问题，也不是概念问题。没关系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T17:56:21.070

您可以为局部变量使用相同的名称，因为它们的范围仅限于块..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-12T18:02:47.880

正如其他人所说，这不是问题。

使用对代码的作用有意义的名称是确保其他人理解您的代码的最佳方式。如果您有一堆函数执行类似的操作（例如，对通过某个通用函数获取的相同数据进行操作），那么在所有函数中以相同的方式命名该变量绝对是个好主意。这样，知道其中一个功能如何工作的人将能够理解下一个功能中相同的事情发生了什么，等等。

# javascript - 选择所有没有 jQuery 的链接和表单

> ID：14838702
> 
> 赞同：1
> 
> 时间：2013-02-12T17:54:53.240
> 
> 标签：javascript, jquery, selector, sizzle

如何在不需要包含 jQuery 的情况下选择所有标签`a`？`form`

我最终试图做到以下几点：

```
$("a").click(function {
    window.onbeforeunload = null;
});

$("form").submit(function {
    window.onbeforeunload = null;
}); 
```

但如果有更紧凑的方法可以做到这一点，我真的宁愿不包括 jQuery（甚至 Sizzle.js）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T17:56:45.120

你可以[`document.querySelectorAll()`](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)这样使用：

```
var els = document.querySelectorAll( 'a' );
for( var i=els.length; i--; ) {
  els[i].addEventListener( 'click', function(){ window.onbeforeunload = null; } );
} 
```

`<form>`标签类似。

它在大多数现代浏览器 ( [caniuse.com](http://caniuse.com/#feat=queryselector) ) 中都可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:57:10.830

这应该这样做：

```
var links = document.getElementsByTagName("a"); 
for (var i = 0; i < links.length; i++) { 
    links[i].addEventListener("click", function() { console.log("Clicked"); window.onbeforeunload = null; });
} 
```

要获取表单提交，您可以执行以下操作：

```
<script>
    do_function() { window.onbeforeunload = null; }
</script>
<form action="" onsubmit="do_function()" method=""> 
```

编辑：将两者结合起来：

```
var links = document.getElementsByTagName("a"); 
for (var i = 0; i < links.length; i++) { 
    links[i].addEventListener("click", function() { console.log("Clicked"); window.onbeforeunload = null; });
}
var forms = document.getElementsByTagName("form");
for (var i = 0; i < forms.length; i++) { 
    forms[i].addEventListener("submit", function() { console.log("Submitted"); window.onbeforeunload = null; });
} 
```

[小提琴](http://jsfiddle.net/VMHHx/)

# ios - AIR 的 NetworkInfo 本机扩展

> ID：14838704
> 
> 赞同：0
> 
> 时间：2013-02-12T17:55:06.490
> 
> 标签：ios, air, adobe, air-native-extension

当我的 Adob​​e AIR iOS 应用程序丢失 wifi 或 3G 连接时，我需要知道/处理，所以我想我会使用 NetworkInfo 类来执行此操作（根据此页面上的信息 [http://www.adobe.com/devnet/ air/native-extensions-for-air/extensions/networkinfo.html](http://www.adobe.com/devnet/air/native-extensions-for-air/extensions/networkinfo.html) )

任何人都可以帮我弄清楚为什么我会出现以下错误？

```
ArgumentError: Error #3500: The extension context does not have a method with the name getInterfaces.
          at flash.external::ExtensionContext/call()
          at com.adobe.nativeExtensions.Networkinfo::NetworkInfo/findInterfaces()[ /Users/gangwar/Documents/Adobe Flash Builder 4.5/NetworkInfoActionScriptLibrary/src/com/adobe/nativeExtensions/Net workinfo/NetworkInfo.as:70]
          at com.adobe.nativeExtensions.Networkinfo::NetworkInfo/findInterfaces() 
```

或者，是否有更好的解决方案来确定设备是否失去了与 wifi 或 3G 的连接？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T16:48:56.223

对我来说，解决此错误的方法是隐藏 ANE 符号：

![在此处输入图像描述](../Images/6689d5c363481f79a170363a790f93ab.png)

# ruby-on-rails - Ruby Contact Mailer 无法正常工作

> ID：14838714
> 
> 赞同：1
> 
> 时间：2013-02-12T17:55:31.493
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我的contact_mailer.rb 有一个简单的脚本，它有一个简单的表单作为前端，有一个下拉菜单来选择用途，并有一个switch-case 块来相应地选择电子邮件ID。现在，不知何故，邮件总是被发送到第一个，即“本地化”时。

无论选择什么，只有这个会被解雇。请解释为什么会发生这种情况。我在下面粘贴代码片段以供参考：

```
class ContactUsMailer < ActionMailer::Base
  default :from => "bot@mydomain.com"

  def contact_us_email(name, message, purpose, email)
    @name = name
    @message = message
    @purpose = purpose
    @email = email
    content_type "text/html"

    case @purpose
    when 'localization'
        mail(:to => 'me@mydomain.com', :subject => purpose)
    when 'marketing'
        mail(:to => 'me@mydomain.com', :cc => 'me@mydomain.com, me@mydomain.com', :subject => purpose)
    when 'network'
        mail(:to => 'me.agm@gmail.com', :subject => purpose)
    when 'recruitment'
        mail(:to => 'me@mydomain.com', :cc => 'me@mydomain.com', :subject => purpose)
    when 'general'
        mail(:to => 'me@mydomain.com', :subject => purpose)
    else
        mail(:to => 'me@mydomain.com', :subject => purpose)
    end

  end
end 
```

谢谢并恭祝安康

# php - PHP 类私有变量被误导的值

> ID：14838718
> 
> 赞同：0
> 
> 时间：2013-02-12T17:55:35.530
> 
> 标签：php, javascript, jquery, class, private-methods

首先，我的问题来自我的 php 类，该类由 AJAX 调用访问的 php 文件调用。

问题是返回值完全错误，与 sybase_result 值不一样。那我错过了什么？

这是我的程序的步骤。

首先我们进行 AJAX 调用：

```
$.ajax(
{
    type: "POST",
    url: "ajax/load_fiche_resume.php",
    timeout:5000,
    dataType: 'json',
    data: ({matricule:matricule, id_mun:id_mun}),
    beforeSend: function()
    {
        // Handle the beforeSend event
        $('#loading-bar').show("slow");
    },
    complete: function()
    {
        // Handle the complete event
        $('#loading-bar').hide("slow");

    },
    success: function(data)
    {

        console.dir(data);

        $('#tab-role').html(formatData(data));
    },
    error: function () 
    {
        alert("Oops! Une erreur c'est produite.\nVeuiller rafraichir la page. \nSi cela se reproduit, veuiller contacter le propriétaire du site.");
    }
}); 
```

然后，我们进入 php 文件 load_fiche_resume.php

```
include('../class/class_role.php');

$oRole = new Role("42025", "2036-94-5034");

$ar_step2 = array(
                array("Propri&eacute;taire(s)"),
                array("Nom(s) : ", $oRole->getProprioNoms() ),
                array("Adresse postale : ", $oRole->getProprioAdresse() ),
                array("Condition particuli&egrave;re d'inscription : ", $oRole->getProprioCondition() ),
                array("Date d'inscription au r&ocirc;le : ", $oRole->getProprioDateInscription() )
            ); 
```

如果我们仔细看上面的代码，函数 $oRole->getProprioDateInscription() 的返回值应该是一个日期。但是这个函数不是日期，而是从另一个 get 函数返回一个字符串（即：它将显示 $oRole->getProprioNoms 的值），这是完全错误的。

如果我们进入 $oRole 类，我们有这个：

```
class Role
{
    private $prop_inscription;
    public function getInfoProprio()
    {
        $qry = "SELECT 
                    p.nom_form AS nom_form,
                    p.t_typos AS t_typos,
                    substr(p.d_date_inscr,1,10) AS d_date_inscr,
                    pga.adr_form AS adr_form,
                    p.id_adr AS id_adr,
                    p.id AS id
                FROM 
                    ev_dossiers d,
                    ro_b75 p,
                    pg_adresses pga
                WHERE 
                    d.id_dossiers = ".$this->getIdDossier()." AND
                    d.typ_donnees = 11 AND
                    d.id_donnees = p.id AND
                    p.id_adr = pga.id_adr order by p.id, p.id_adr, p.ordre;";
        $this->prop_qry = $qry;
        $result = sybase_query($qry, $this->getLinkDB());
        $nbr = sybase_num_rows($result);
        $typos = sybase_result($result, 0, "t_typos");

        if($nbr>0)
        {
            for($cpt=0; $cpt<$nbr; $cpt++)
            {
                if($cpt===0)
                {
                    $this->setProprioNoms(utf8_encode(strtr(trim(sybase_result($result, $cpt, "nom_form")),"’","'")));
                    $this->setProprioAdresse(utf8_encode(strtr(trim(sybase_result($result, $cpt, "adr_form")),"’","'")));
                    $this->setProprioCondition($this->getConditionInscription(sybase_result($result, $cpt, "t_typos")));

// THIS IS PROBLEMATIC                       
$this->setProprioDateInscription(sybase_result($result, 0, "d_date_inscr"));
                }
                else 
                {
                    $this->setProprioNoms(", ".utf8_encode(strtr(trim(sybase_result($result, $cpt, "nom_form")),"’","'")));
                }
            }
        }
    }   

    ...

        public function getProprioDateInscription()
    {
        return $this->prop_inscription;
    }
    private function setProprioDateInscription($date)
    {
        $this->prop_inscription = $date;
    }
} 
```

如果我们看看我们有这个的行： $this->setProprioDateInscription(sybase_result($result, 0, "d_date_inscr"));

sybase_result 返回一个日期（从数据库中一切正常，值很好）。但问题出在私有 var prop_inscription 的 Setter 和 Getter 之间。

你能帮助我吗？你知道问题出在哪里吗？

非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:20:43.033

为了解决这个问题，

只需更改此行

```
// THIS IS PROBLEMATIC                       
$this->setProprioDateInscription(sybase_result($result, 0, "d_date_inscr")); 
```

到

```
$this->setProprioDateInscription(utf8_encode(strtr(trim(sybase_result($result, $cpt,"d_date_inscr")),"’","'"))); 
```

# android - Android SDK API/功能分解？

> ID：14838726
> 
> 赞同：0
> 
> 时间：2013-02-12T17:56:08.777
> 
> 标签：android

无论如何，我可以查看 Android SDK 任何版本中的“新增功能”/发行说明吗？

特别是每个版本添加的新 API。例如 DreamService 仅在 API 17 及更高版本中可用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T17:59:36.570

每个 API 级别都有一个更改页面，就像一个摘要，以及一个完整的更改报告。

例如，可以在此处找到 Android 4.2“更改页面”：[**Android 4.2 APIs**](http://developer.android.com/about/versions/android-4.2.html) *（注意：您可以使用左侧的菜单浏览所有版本。）*

完整的更改报告可在此处找到：[**Android API 差异报告**](http://developer.android.com/sdk/api_diff/17/changes.html) *（注意：导航不那么容易；更改 URL 中的“17”是探索以前 API 版本的最简单方法。）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T17:58:56.993

可以看官网。转到[http://developer.android.com/about/versions/android-4.2.html](http://developer.android.com/about/versions/android-4.2.html)。您可以在左侧面板中选择特定的 API

# php - 从 URL 中删除

> ID：14838728
> 
> 赞同：0
> 
> 时间：2013-02-12T17:56:24.497
> 
> 标签：php

所以我有以下网址：

```
http://www.domain.com/Folder1/Folder2/file.php 
```

有没有办法让我抓住`http://www.domain.com/Folder1/`零件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:11:27.417

我建议这样做：

```
<?php
$url = 'http://www.example.com/path1/path2?googleguy=googley';
$array = parse_url($url)
var_dump($array);
var_dump( explode('/',$array["path"]));
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T12:11:36.460

您还可以使用：

```
$url = 'http://www.example.com/path1/path2?googleguy=googley';

$array = preg_match('((http|https|ftp)://[a-zA-Z0-9\-\.]+/[a-zA-Z0-9\-]+/)', $url);

var_dump($array); 
```

# ruby-on-rails - 如何创建 Rails 控制器操作？

> ID：14838732
> 
> 赞同：0
> 
> 时间：2013-02-12T17:56:48.540
> 
> 标签：ruby-on-rails, action

我的 rails 应用程序有一个 CustomerSelectionController，有两个操作：

index: 它显示了一个表单，用户可以在其中输入客户信息并选择：它只显示一个静态页面。

```
class CustomerSelectionController < ApplicationController
  def index
  end

  def select
  end
end 
```

我在 routes.rb 文件中创建了一个条目：

```
 resources :customer_selection 
```

索引视图中的表单如下所示：

```
<h1>Customer Selection</h1>

<%= form_tag("customer_selection/select", :method => "get") do %>
  <%= submit_tag("Select") %>
<% end %> 
```

但是，当我单击浏览器中的“选择”按钮时，我得到的只是：

未知动作

找不到 CustomerSelectionController 的操作“显示”

我不确定它为什么要尝试执行一个名为 show 的动作？我没有在任何地方定义或引用过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:00:04.327

> 我不确定它为什么要尝试执行一个名为 show 的动作？我没有在任何地方定义或引用过。

是的，你有。就是`resources`这样。它定义了七个默认的 RESTful 路由：索引、显示、新建、创建、编辑、更新和销毁。当您路由到`/customer_selection/select`时，匹配的路由是“/customer_action/:id”或“show”路由。Rails 实例化您的控制器并尝试在其上调用“显示”操作，并传入一个“选择”ID。

如果您想添加除这些路由之外的路由，则需要显式定义它，并且如果您不想要所有七个路由，您还应该明确说明您想要哪些路由：

```
resources :customer_selection, only: %w(index) do
  collection { get :select }
  # or
  # get :select, on: :collection
end 
```

由于您的路线很少，您也可以只定义它们而不使用`resources`：

```
get "/customer_selection" => "customer_selection#index"
get "/customer_select/select" 
```

Note that, in the second route, the `"customer_select#select"` is implied. In a route with only two segments, Rails will default to "/:controller/:action" if you don't specify a controller/action.

# c# - 使用 async/await 抛出和捕获异常的正确方法

> ID：14838733
> 
> 赞同：3
> 
> 时间：2013-02-12T17:56:49.550
> 
> 标签：c#, multithreading, exception-handling, .net-4.5, async-await

全部，请取以下代码：

```
Task<bool> generateStageAsyncTask = null;
generateStageAsyncTask = Task.Factory.StartNew<bool>(() =>
{
    return GenerateStage(ref workbook);
}, this.token,
   TaskCreationOptions.LongRunning,
   TaskScheduler.Default);

// Run core asynchroniously.
bool bGenerationSuccess = false;
try
{
    bGenerationSuccess = await generateStageAsyncTask;
}
catch (OperationCancelledException e)
{
    // Script cancellation.
    result.RunSucceeded = true;
    result.ResultInfo = "Script processing cancelled at the users request.";
    return result;
} 
```

从方法中`GenerateStage`我测试并重新抛出 a`OperationCancelledException`如下

```
try
{
    ...
}
catch (Exception e)
{
    if (e.GetType() == typeof(OperationCanceledException))
        throw e;
    else // <- Here it is saying that the thrown exception is unhandled.
    {
        // Do other stuff...
    }
} 
```

但是在上面的指定行中，它声明重新抛出的异常未处理。**我`await`在上面的第一个代码片段中用适当的包装了我的`try/catch`，为什么这`try/catch`没有捕获重新抛出的异常？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T19:37:30.907

这是[来自 Microsoft Connect 的同一问题的支持请求](http://connect.microsoft.com/VisualStudio/feedback/details/522955/exceptions-thrown-in-tasks-are-incorrectly-considered-unhandled)。禁用“只是我的代码”

`Tools`-> `Options`-> `Debugging`->`General`

解决问题。

# javascript - 使用 JavaScript 检测 NPAPI 支持

> ID：14838739
> 
> 赞同：4
> 
> 时间：2013-02-12T17:57:11.710
> 
> 标签：javascript, npapi, browser-plugin

如何检测浏览器是否支持 JavaScript 中的 NPAPI？并非所有人都这样做，虽然我可以依赖用户代理，但如果存在的话，我宁愿以一种更可靠的方式来做。

不幸的是，我不能简单地检测我的插件是否已加载，因为可能是该插件尚未安装在受支持的浏览器上。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T09:24:48.540

对此没有 JS API，但基本上所有桌面浏览器除了基于 IE-/Trident 的浏览器和 ChromeOS 都支持 NPAPI。

您可以通过检查来了解您的插件是否已安装[`navigator.plugins`](https://developer.mozilla.org/en-US/docs/DOM/window.navigator.plugins)。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2015-07-02T07:29:27.610

如果要检查浏览器中是否启用了 java 插件，则应使用`navigator.javaEnabled()`. 它将在铬中工作。

# php - 使用 PHP exec 的 MySQL 转储工作。但是，无法导入或复制

> ID：14838741
> 
> 赞同：0
> 
> 时间：2013-02-12T17:57:11.957
> 
> 标签：php, mysql, exec

这是有效的：

```
exec('mysqldump --single-transaction --user=myusername --password=mypassword --host=localhost mydb > /home/path/public_html/a.sql');

exec('mysql --user=myusername --password=mypassword --execute="drop database mydevdb;"');

exec('mysql --user=myusername --password=mypassword --execute="create database mydevdb;"'); 
```

SQL 文件是使用实时数据库中的查询创建的，在正确的位置，开发数据库被删除并重新创建。请注意，第一个 exec 仅适用于`--single-transaction`. 但是下面的最后一步不起作用。它创建了第一个表，没有数据，也没有其他表。我已经尝试过使用和不使用`--single-transaction`.

```
exec('mysql --user=myusername --password=mypassword --host=localhost mydevdb < /home/path/public_html/a.sql'); 
```

我真正想要的是通过 PHP 在同一个 MYSQL 实例中将一个数据库克隆到另一个数据库。这也不起作用：

```
exec('mysqldump --user=myusername --password=mypassword --host=localhost mydb | mysql --user=myusername --password=mypassword --host=localhost mydevdb'); 
```

所以我试图转储然后导入。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-09-13T12:59:00.277

在这里回答已经太晚了，但是有一种方法可以使用以下命令克隆数据库。

> exec('mysql --user=myusername --password=mypassword --execute="drop database new_dbname"');
> 
> exec('mysql --user=myusername --password=mypassword --execute="create database new_dbname"');
> 
> exec("mysqldump --events --ignore-table=mysql.events -u $myusername -p'$mypassword' $existing_db_name | mysql -u $myusername -p'$mypassword' -C $new_dbname");

# macos - 无法使用 MDM 从 OS X 10.8.2 设备获取 PushMagic

> ID：14838743
> 
> 赞同：0
> 
> 时间：2013-02-12T17:57:22.547
> 
> 标签：macos, configuration, profile, apple-push-notifications, mdm

我正在尝试创建自己的 MDM 服务器。我可以顺利注册 iOS 设备，但是当我在 OS X 10.8.2 设备上安装相同的配置文件（包含 mdm 和凭据有效负载的配置文件）时，它不会向我发送 PushMagic。

有没有人遇到过类似的问题？什么可能导致 PushMagic 无法发送？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T16:41:00.740

与苹果交谈，您不需要 PushMagic 将 APNS 消息发送到 OS X 设备！只是说：

{"mdm":""}

在你的有效载荷中

# javascript - 为什么 require.js 进入 head 标签

> ID：14838745
> 
> 赞同：9
> 
> 时间：2013-02-12T17:57:26.397
> 
> 标签：javascript, html, requirejs

根据 Yahoo Developer Network 等许多来源，javascript 位于页面底部，因此网页内容将在加载 javascript 之前显示。在 head 标签中调用 require.js 是否会使浏览器在显示页面之前等待脚本完成加载？

```
<head>
<title>My Sample Project</title>
<script data-main="scripts/main" src="scripts/require.js"></script>
</head> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T01:18:47.473

答案有点复杂；它可以进入您的页面`<head>`或`<body>`页面，具体取决于*您*对`require.js`. 某些操作在逻辑上需要在内容加载之前发生，但大多数事情都乐于等待。

在页面加载之前需要发生的事情的一个例子是css预处理器`LESS`，这显然需要在`<head>`（实际上这可能应该被预编译并用作静态css，但它是一个很好的例子) - 另一个例子是 JavaScript 模板系统或某种客户端 MVC 系统，如`ember.js`

对于基本的展示性 JavaScript，通常将其包含在页面底部是安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T22:16:25.090

答案是肯定的。对于 head 标签中的所有脚本，这都是一样的。脚本块并行下载，一旦完成执行，浏览器将继续呈现页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T22:26:31.570

这取决于 javascript 文件的内容，何时执行。

例如

```
<script>
  function load() {
    alert("load event!");
  }
  window.onload = load;
</script> 
```

页面加载后将显示消息框。

# join - 带有连接、组和计数的 Linq 查询（扩展格式）

> ID：14838746
> 
> 赞同：1
> 
> 时间：2013-02-12T17:57:31.257
> 
> 标签：join, linq-extensions

我有一个表，它存储一些信息和引用（列 parent_ID）到同一个表中的父行。

我需要获取包含子记录计数的所有记录列表（使用 Linq 扩展格式）。这是为我提供所需信息的 SQL 查询

```
 Select a.ID, a.Name, Count(b.ID) from Table a
    left join Table b on b.parent_ID=a.ID
    group by a.ID, a.Name 
```

## 例子

```
|    ID   | Name     | parent_ID |
----------------------------------
|    1    | First    |   null    |
|    2    | Child1   |    1      |
|    3    | Child2   |    1      |
|    4    | Child1.1 |    2      | 
```

### 结果应该是：

```
|    1    | First    |    2      |
|    2    | Child1   |    1      |
|    3    | Child2   |    0      |
|    4    | Child1.1 |    0      | 
```

### 我试图至少让孩子数，但它不起作用......

```
 var model = _db.Table 
            .GroupBy(r => new { r.parent_ID })
            .Select(r => new {
                r.Key.parent_ID,
                ChildCount = r.GroupBy(g => g.parent_ID).Count() 
            }); 
```

这个查询不应该等同于这样的东西：

```
 select parent_ID, count(parent_ID) from Table group by Table 
```

但它为每一行返回count = 1 ...

如何使用 linq 扩展格式进行这样的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:50:49.480

我相信您正在寻找的是使用 linq 查询语法而不是 linq 扩展更容易理解的组连接，因此为了便于理解，我将发布这两种方法。

我将 ID 上的表与 parent_ID 自联接到一个对象中，该对象为您保持引用完整性，并选择一个匿名对象来选择父项，然后选择所有子项。

这是使用直接的 LINQ 查询语法。

```
 var model = from t1 in _db.Test1
                join t2 in _db.Test1 on t1.ID equals t2.parent_ID into c1
                select new {Parent = t1, Children = c1}; 
```

这是使用 LINQ 扩展的代码

```
 var model2 = _db.Test1.GroupJoin(_db.Test1, 
                     t1 => t1.ID, 
                     t2 => t2.parent_ID,
                     (t1, c1) => new {Parent = t1, Children = c1}); 
```

我使用了一个快速测试程序，将两种方法的结果发布到文本框中，但代码相同，所以我只发布一次。

```
 foreach (var test in model)
    {
        textBox1.AppendTextAddNewLine(String.Format("{0}: {1}", 
                                      test.Parent.Name, 
                                      test.Children.Count()));
    } 
```

并且这两个测试的结果在下面是相同的：

```
 First: 2
    Child1: 1
    Child2: 0
    Child1.1: 0

    First: 2
    Child1: 1
    Child2: 0
    Child1.1: 0 
```

# double - 双精度值不显示计算值

> ID：14838750
> 
> 赞同：0
> 
> 时间：2013-02-12T17:57:42.470
> 
> 标签：double

我正在尝试计算用户的付款期限。我试着计算数字并将它们吐出来，但由于某种原因这没有发生。但是，当我在声明变量时明确地为变量赋值时，它显示得非常好。

```
public static void creditCardPaymentCalculator()
   {
                    //User Input Variables
         Scanner userInput = new Scanner(System.in);

                    //User's Input
         double purchaseAmount, interestAmount = 0, minimumMonthlyPayment;

                    //Table Counters
         int[] month = new int[12];
         double payment = 0;
         double monthlyInterest = 0;
         double principal = 0;
         double remainingBalance = 0;

         double yearsOfPayment = 0;

         int yearCounter = 1;
         int monthCounter = 0;

                                //Initialize Variables
         //-------------------------------------------------------------------------

                   //Initialize Month Array
         for (int i = 0; i < 12; i++)
         {
             month[i] = (i + 1);
         }

         //-------------------------------------------------------------------------

                   //Welcome Message
         System.out.println("\n\n\n\nCredit Card Payment Calculator\n\n");

                    //Get User Input
         System.out.println("Enter Your Purchase Amount");
         purchaseAmount = userInput.nextDouble();
         System.out.println("Enter Interest Amount");
         interestAmount = userInput.nextDouble();
         System.out.println("Enter Minimum Monthly Payment");
         minimumMonthlyPayment = userInput.nextDouble();

                    //Calculate Input For Chart (Not Working)
         payment = minimumMonthlyPayment;
         monthlyInterest = (((interestAmount / 100) * remainingBalance / yearsOfPayment) / 12);
         principal = payment - monthlyInterest;
         remainingBalance = remainingBalance - principal;

                  //Calculate Number Of Years For Payment
         yearsOfPayment = (((interestAmount / 100) * remainingBalance) + remainingBalance) / minimumMonthlyPayment;

                    //Output
         System.out.printf("\n     Year: %d/%.0f", yearCounter, yearsOfPayment);

         System.out.printf("\nMonth     Payment     Interest      Principal      Remaining Balance");
         System.out.printf("\n%d         %.2f        %.2f          %.2f           %.2f", month[monthCounter], payment, monthlyInterest, principal, remainingBalance);

                    //Increment Counters
         monthCounter++;
         if (month[monthCounter] == 12)
         {
             yearCounter++;
                 //Reset monthCounter
             monthCounter = 0;
         }

                    //Line Spacing
         System.out.printf("\n\n\n\n\n");

   } 
```

# android - 如何使用 viewpager 创建具有不同列表视图项目的选项卡

> ID：14838751
> 
> 赞同：1
> 
> 时间：2013-02-12T17:57:44.290
> 
> 标签：android

我创建了一个类似于 android market 的测试示例 viewpager 选项卡。但是所有选项卡都显示相同的 listView 项目。我需要以这样一种方式实现，即每个选项卡在 listView 中都有自己的一组项目。

这是我的主要活动。

```
package com.example.viewpagesample;

import java.util.ArrayList;
import java.util.List;

import com.actionbarsherlock.app.SherlockFragmentActivity;
import com.actionbarsherlock.view.Menu;
import com.viewpagerindicator.TitlePageIndicator;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.view.ViewPager;

public class MainActivity extends SherlockFragmentActivity {
    private ViewPager mPager;
    private TitlePageIndicator mIndicator;
    private MainPagerAdapter mAdapter;
    private List<Fragment> mFragments;

    private static final String FRAGMENT1 = Fragment1.class.getName();
    private static final String FRAGMENT2 = Fragment1.class.getName();
    private static final String FRAGMENT3 = Fragment1.class.getName();

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // add fragments
        mFragments = new ArrayList<Fragment>();
        mFragments.add(Fragment.instantiate(this, FRAGMENT1));
        mFragments.add(Fragment.instantiate(this, FRAGMENT2));
        mFragments.add(Fragment.instantiate(this, FRAGMENT3));

        // adapter
        mAdapter = new MainPagerAdapter(getSupportFragmentManager(), mFragments);

        // pager
        mPager = (ViewPager) findViewById(R.id.view_pager);
        mPager.setAdapter(mAdapter);

        // indicator
        mIndicator = (TitlePageIndicator) findViewById(R.id.title_indicator);
        mIndicator.setViewPager(mPager);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        return true;
    }

} 
```

片段1类：

```
package com.example.viewpagesample;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ListView;

import com.actionbarsherlock.app.SherlockFragment;

public class Fragment1 extends SherlockFragment {
    private ListView mList;

    @Override
    public View onCreateView(LayoutInflater inf, ViewGroup grp, Bundle icicle) {
        View v = inf.inflate(R.layout.f_fragment1, grp, false);
        mList = (ListView) v.findViewById(R.id.listView1);
        return v;
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(
                getActivity(), android.R.layout.simple_list_item_1, Cheese.STRINGS);
        mList.setAdapter(adapter);
    }

} 
```

Cheese.STRINGS 只是一个字符串数组。

片段2类：

```
package com.example.viewpagesample;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ListView;

import com.actionbarsherlock.app.SherlockFragment;

public class Fragment2 extends SherlockFragment {
    private ListView mList;

    @Override
    public View onCreateView(LayoutInflater inf, ViewGroup grp, Bundle icicle) {
        View v = inf.inflate(R.layout.f_fragment2, grp, false);
        mList = (ListView) v.findViewById(R.id.listView2);
        return v;
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(
                getActivity(), android.R.layout.simple_list_item_1, Cheese.fragment2);
        mList.setAdapter(adapter);
    }
} 
```

在 fragment2 中，我使用 Cheese.fragment2 作为 listView 中的项目

但是 tab2 正在显示与 tab11 相同的 listView 项目？

如何在 tab2 中加载不同的项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:03:45.053

```
private static final String FRAGMENT2 = Fragment1.class.getName(); 
```

应该

```
private static final String FRAGMENT2 = Fragment2.class.getName(); 
```

我猜...

# php - 如何使用 get_template_part 将短代码属性传递到单独的循环中

> ID：14838752
> 
> 赞同：1
> 
> 时间：2013-02-12T17:57:45.577
> 
> 标签：php, wordpress, loops

我正在尝试使用 get_template_part 获取要执行的简码并将属性值传递到单独的循环中，简码代码如下：

```
function test( $atts, $content = null ) {
     extract( shortcode_atts( array('category' => '', 'type' => '' ), $atts ) );
    ob_start();  
    get_template_part('loop', $type);  
    $ret = ob_get_contents();  
    ob_end_clean();  
    return $ret; 
}
add_shortcode('test', 'test'); 
```

然后在我有的 loop-$type.php 文件中

```
$cat_id = get_cat_ID($category);
$args=array(
  'cat' => $cat_id,
  'post_type' => 'post',
  'post_status' => 'publish',
  'posts_per_page' => 4,
  'caller_get_posts'=> 1
);
$my_query = null;
$my_query = new WP_Query($args);
if( $my_query->have_posts() ) {
  while ($my_query->have_posts()) : $my_query->the_post(); ?>
                     <li> /* post stuff */         </li>

    <?php
  endwhile;
}
wp_reset_query(); 
```

但我无法让 cat_id 使用短代码属性中的 $category 。有谁知道为什么循环不使用短代码属性？

它显然没有传递价值，这意味着我可以让它成为全球性的，但这是一个讨厌的解决方案，必须有一个干净的方法来做到这一点？

（我有一篇文章试图将短代码执行为`[test category=random-category-name]`）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-18T16:39:06.650

我有同样的问题，我很难找到一个好的答案。

显然，像这样设置一个全局变量并不是唯一的解决方案。相反，您可以在设置变量后将模板“包含”到 php 中，并且它可以按预期工作。

在这里查看更好的描述和示例：

[http://keithdevon.com/passing-variables-to-get_template_part-in-wordpress/](http://keithdevon.com/passing-variables-to-get_template_part-in-wordpress/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:14:53.020

该变量`$category`仅在函数范围内，不会传递给`get_template_part()`. 尝试`$category`全球化。

```
function test( $atts, $content = null ) {
  global $category;
  extract( shortcode_atts( array('category' => '' ), $atts ) );
  ob_start();
  get_template_part('loop', $type);  
  $ret = ob_get_contents();  
  ob_end_clean();  
  return $ret; 
}
add_shortcode('test', 'test'); 
```

此外，添加`global $category;`到模板文件的顶部。

# c# - 如何在 PC 应用程序上使用 vuforia

> ID：14838755
> 
> 赞同：4
> 
> 时间：2013-02-12T17:58:00.840
> 
> 标签：c#, unity3d, vuforia

我是 vuforia 的新手，我需要一些关于这个主题的帮助。有人可以告诉我是否可以在 PC 应用程序上使用带有网络摄像头的 vuforia？我在平面纹理上获得了网络摄像头框架，我试图将这些纹理传递给 vuforia，但我没有得到它的工作。

我曾经`WebCamTexture`得到网络摄像头的帧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T08:49:54.873

我对 Vuforia 不熟悉（虽然它看起来很有趣，但我将在这个周末亲自尝试一下！），我可能有一个建议。

Vuforia 是否可能因为图像而`WebCamTexture`不是类似的东西而不知道该怎么做`Texture2d`？

`WebCamTexture`是一个`Texture`( `Texture2D`, `WebCamTexture`,`RenderTexture`都扩展自`Texture`但它们不可交换)。

那么，尝试转换您的纹理并将其传递给 Vuforia？

```
var tx2d = new Texture2D();
tx2d.SetPixels((go.renderer.material.mainTexture as WebCamTexture).GetPixels()); 
```

**编辑：**我在[这里](https://developer.vuforia.com/resources/dev-guide/step-2-compiling-simple-project)找到的，在以下部分`Running in the editor`：

有一个特定的`Web Cam Behaviour`脚本。

> 要在 Unity Pro 中使用 Vuforia 的播放模式，只需从相机设备菜单中选择要使用的附加或内置网络摄像头，然后使用编辑器 UI 顶部的播放按钮激活播放模式。
> 
> 您还可以在非 Pro Unity 版本中使用标准 Unity 播放模式，并在网络摄像头行为组件中设置“不用于播放模式”。
> 
> 要使用标准播放模式，请调整 ARCamera 对象的变换以显示整个场景，然后在 Unity 编辑器中运行应用程序。在标准播放模式下没有实时摄像机图像或跟踪，而是假定所有目标都是可见的。这允许您测试应用程序的非 AR 组件，例如脚本和动画，而无需每次都部署到设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-26T19:20:51.287

您是否尝试过[http://holographi.space/](http://holographi.space/)上的 250 美元插件？我还没有为此支付 250 美元。

# php - PHP DateTime::diff DateTime::format 问题

> ID：14838762
> 
> 赞同：3
> 
> 时间：2013-02-12T17:58:17.303
> 
> 标签：php, datetime-format

当我尝试使用普通 PHP 代码（d、Y、m 等）为日期和时间格式化我的日期差异时，它只是输出字母，而不是值。仅当我格式化 DateTime::diff 时。它适用于简单的 DateTime 对象。

这：

```
$date1 = new DateTime('2000-01-01');
$date2= new DateTime('now');
$date=$date2->diff($date1);
echo $date->format('d days ago'); 
```

输出“d天前”。

我知道如果我用 %a 替换 d，它会输出这是几天前。我想知道会输出秒、分钟甚至年的其他字符是什么。

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-12T18:23:02.950

DateTime::diff() 返回一个[DateInterval](http://www.php.net/manual/en/class.dateinterval.php)对象。

例如：

```
<?php

$date1 = new DateTime('2000-01-01');
$date2= new DateTime('now');
$interval=$date2->diff($date1);
echo "Years: {$interval->y }\n";
echo "Months: {$interval->m }\n";
echo "Days: {$interval->d }\n";
echo "Hours: {$interval->h }\n";
echo "Mins: {$interval->i }\n";
echo "Secs: {$interval->s }\n";
echo $interval->format("%Y years, %m months, %d days,  %H hours, %i minutes, %s seconds") . "\n"; 
```

将输出：

```
Years: 13
Months: 1
Days: 11
Hours: 13
Mins: 14
Secs: 44
13 years, 1 months, 11 days,  13 hours, 21 minutes, 43 seconds 
```

# fatwire - Fatwire 7.6.1 RevisionTrackingManager 获取方法失败

> ID：14838766
> 
> 赞同：0
> 
> 时间：2013-02-12T17:58:37.200
> 
> 标签：fatwire

//CSElement 代码 //我正在尝试使用 RevisionTrackingManager 接口获取资产和资产数据的修订号，但它会引发异常

```
String assetId = "1293727029653";
String assetType = "NSP_Content_C";
String selectedRevision = "2";

AssetId aId = new AssetIdImpl(assetType, Long.valueOf(assetId));
RevisionTrackingManager rtm = new RevisionTrackingManagerImpl(ics);
AssetData revisedAsset = null;
try
{   
    out.println("<br/>-------------Calling RevisionTrackingManager-------------");
    out.println("<br/>Total versions = "+ rtm.getVersions(aId).size());
    revisedAsset = rtm.get(aId,Integer.valueOf(selectedRevision));
    out.println("After");
}
catch(Exception ex)
{
    out.println("<br/>Could not retrieve asset. Possibly cause: item might be checked out............" + ex.getMessage());
}

Above code throws exception and gives the message in catch block. Could anyone help me to fix this code? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T21:54:53.433

我不确定在您捕获所有异常时会引发什么类型的异常。或者，您也可以在 AssetType_T 表中找到资产的版本。希望有帮助。

# struts2 - struts2 验证器表达式

> ID：14838767
> 
> 赞同：3
> 
> 时间：2013-02-12T17:58:42.110
> 
> 标签：struts2

是否可以进行此条件表达式验证？：

```
(invitation.id==null and (newText==null or newText.isEmpty())) 
```

我已经尝试了几种方法，几次，但没有实现。此版本正在运行，但在服务器端，如果invitation.id 为空或为空，请忽略...任何想法？？？：

```
<field name="newText">
   <field-validator type="fieldexpression">
      <param name="expression">!(invitation.id eq null and (newText eq null or newText.empty))</param>
      <message>${getText("validation.required")}</message>
   </field-validator>
</field> 
```

[http://struts.apache.org/release/2.2.x/docs/fieldexpression-validator.html](http://struts.apache.org/release/2.2.x/docs/fieldexpression-validator.html)

**表达有什么问题？？谢谢！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T10:45:34.850

您的问题是您正在尝试将另一个字段 ( `invitation.id`) 验证到`newText`字段验证器中（我认为这不可能，但我不确定）。

但是，您可以将其拆分为两个验证器，从而引发与失败案例相对应的消息，恕我直言，这更正确；

```
<field name="invitation.id">
    <field-validator type="required">
        <message>${getText("validation.invitation.id.required")}</message>
    </field-validator>
</field>

<field name="newText">
    <field-validator type="fieldexpression">
        <param name="expression">
           <![CDATA[                 
           newText != null && !newText.trim().empty())
           ]]>
        </param>
        <message>${getText("validation.newText.required")}</message>
    </field-validator>
</field> 
```

, 如果你需要修剪它，否则它可能会变得简单

```
<field name="invitation.id">
    <field-validator type="required">
        <message>${getText("validation.invitation.id.required")}</message>
    </field-validator>
</field>

<field name="newText">
    <field-validator type="requiredString">
        <message>${getText("validation.newText.required")}</message>
    </field-validator>
</field> 
```

请注意，这`required`适用于每个非文本字段，而`requiredString`仅适用于文本字段。

表达式验证器非常强大，但它应该用于更复杂的目的：

例如，如果您想针对从您的 Action 动态读取（通过 Getter）的另一个日期来验证日期；假设您之前选择了一个用户，并且您需要根据用户开始和结束有效期间隔验证页面中的日期；但是如果没有插入日期，您也想通过验证，因为它已经由所需的验证器处理（因此您不会引发两条消息）：

```
<field name="inputDate">
    <field-validator type="required">
       <message><![CDATA[ Input Date is mandatory ]]></message>
    </field-validator>
    <field-validator type="fieldexpression">
        <param name="expression"> 
            <![CDATA[ 
              inputDate==null || 
                (inputDate >= chosenUser.startValidity 
                 && 
                 inputDate <= chosenUser.EndValidity
                ) 
            ]]>            
        </param> 
        <message>
            <![CDATA[Input Date must be included in the User Validity interval 
               (from ${chosenUser.startValidity} to ${chosenUser.endValidity} ) 
            ]]>
        </message>
     </field-validator>
</field> 
```

其中`chosenUser`是来自 Action ( `public User getChosenUser()`) 的 User 对象，startValidity 和 endValidity 是 User 对象 ( `public Date getEndValidity()`) 的属性。

如您所见，动态读取也可以在消息中执行……这就是表达式验证器的强大之处；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T06:08:59.783

首先**表达式** 不是一个有效的参数。如果您真的想在客户端进行验证，请尝试使用 java-script 或 jquery 进行验证。但是您还必须在服务器端验证输入，因为有时用户可能会禁用**javascript** 。所以在这种情况下，您可以使用 struts2 - 验证。

有关详细说明，请参阅[http://viralpatel.net/blogs/struts2-validation-framework-tutorial-example/](http://viralpatel.net/blogs/struts2-validation-framework-tutorial-example/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T07:42:09.417

好的，最后我使用了模拟struts2的客户端验证宽度jquery。

出于兼容性原因，我不喜欢这个，如果有办法以标准方式做到这一点，我会感谢任何帮助。

**删除 struts 验证：**

```
<!--<field name="newText">
      <field-validator type="fieldexpression">
          <param name="expression">!((invitation.id==null or invitation.id.empty) and (newText==null or newText.empty))</param>
          <message>${getText("validation.required")}</message>
      </field-validator>
    </field>--> 
```

**添加 js/jquery 代码：**

```
function mySubmit() {
    if ((invitationId==null || invitationId<0) && $("#text").val().trim()=='') {
        var trStrutsFieldError='<tr errorfor="text">'+
                                    '<td colspan="2" align="center" valign="top"><span class="errorMessage">'+strValidationRequired+'</span></td>'+
                                '</tr>';
        $(trStrutsFieldError).insertBefore($("#text").parent().parent());
        return false;
    }
    return true;
}
$(document).ready(function(){
    $("form").submit(function(event) {
        $.each($("form").find("span.errorMessage"), function() {  /* <tr errorfor="title"><td colspan="2" align="center"><span classname="errorMessage" class="errorMessage">Campo requerido */
            return false;
        });
        if ($(mySubmit).exists()) {
            if (!mySubmit()) 
                return false;
        }
        return true;
    });
}); 
```

# matlab - Matlab向量到xls

> ID：14838773
> 
> 赞同：1
> 
> 时间：2013-02-12T17:58:54.387
> 
> 标签：matlab

我有`V`一个单行和 16761 列的向量。

我想把它写到一个`XLS`文件中，用它来训练神经网络。

我尝试了以下代码，但出现错误：

```
V = reshape(I,1,16761);
filename = 'testdata.xls';
xlswrite(filename,V);` 
```

请帮我摆脱它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T09:06:04.227

正如提问者所发布的：

> 这是由于向量的大小，Excel 仅支持 256 列

请注意，Excel 2003 之后的版本最多支持 16384 列。

# mysql - Mysql导入一个大的sql文件需要很长时间是正常的吗？

> ID：14838777
> 
> 赞同：1
> 
> 时间：2013-02-12T17:59:06.327
> 
> 标签：mysql, phpmyadmin

几天前，我下载了维基百科“外部链接”的 sql 文件。外部链接表有三个列：第一个是 int(8)，另外两个是一个包含 url 的 blob。我开始用phpmyadmin导入9.3GB大小的sql文件，现在已经50多个小时了，导入过程还没有完成！到目前为止，已插入超过 3300 万行。

需要这么长时间是正常的，还是我的设置有问题？

注意：我的服务器是具有 16 GB RAM 的 e3-1230。

蒂亚！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-13T14:05:09.657

似乎太长了。这是供您参考的。

我的电脑规格： - Windows 10 家庭版 - Intel Core i5-3317U CPU@1.7GHz - 6GB RAM 内存 - 750 GB 5400 RPM 硬盘 - MySQL 5.7 和 MySQL Workbench 6.3CE

我导入了从 NYC 开放数据门户下载的两个文件。NYC 出租车 fare.csv ：大小为 1.67 GB，11 列，15749228 行。nyc311calls.csv：5.83 GB 大小，53 列，11145686 行

sql 脚本如下 LOAD DATA LOCAL INFILE 'C:/test_data/FILE_NAME' INTO TABLE DB_NAME FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\r\n' IGNORE 1 ROWS;

导入 fare.csv 的运行时间：320.706 秒（少于 6 分钟） 导入 nyc311calls.csv 的运行时间：968 秒（约 16 分钟）

# ios - xCode iOS 开发 - 解析问题：预期标识符？

> ID：14838778
> 
> 赞同：-8
> 
> 时间：2013-02-12T17:59:08.063
> 
> 标签：ios, parsing, identifier

看看这个，让我知道你们认为什么是错的。非常感谢你。:)

[![图片](../Images/ec5cfc36b7cb8597cf7711a6a67633d8.png)](https://i.stack.imgur.com/nBqHL.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:05:48.723

试试这个：

```
if([[Reachability reachabilityForInternetConnection] currentReachabilityStatus] == NotReachable) 
```

或者，以明确的方式

```
- (BOOL)connected
{
    Reachability *reachability = [Reachability reachabilityForInternetConnection];
    NetworkStatus networkStatus = [reachability currentReachabilityStatus];
    return !(networkStatus == NotReachable);
} 
```

代替

```
if([[Rechability (id)]  currentRechabilityStatus] == NotRechable) 
```

放

```
if(![self connected]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:06:03.230

在这里，您已经编写了类型（id）并且没有为此（id）编写任何标识符，这就是为什么它总是给出error.compiler，除了数据类型之后的标识符。

它应该只是

```
[reachability currentReachabilityStatus]; 
```

# php - 如何正确计算 pdo 中的查询

> ID：14838779
> 
> 赞同：2
> 
> 时间：2013-02-12T17:59:14.510
> 
> 标签：php, pdo

我正在尝试将更多帖子动态加载到我的系统中

这是我的代码...

```
$stmt = "
  SELECT * FROM `acmPosting` 
  WHERE (`sender`='$thisID' AND `postType`='a')
  OR (`recip`='$thisID' AND `sender`='$userID' AND `postType`='a')
  OR (`sender` IN ($friendsArray) AND `recip`='$thisID'  AND `postType`='a')
  ORDER BY `timeSent` DESC LIMIT $startlimit,10";

    if($stmtCount = $conn->query($stmt)){
        if($stmtCount->fetchColumn() > 0){
            $result = acmPosts($conn, $site, $userID, $stmt);
            $jsonArray['a'] = $result;
            $jsonArray['b'] = 'go';             
        }else{
            $jsonArray['a'] = '<div class="thisOutput" style="padding:12px;">There are no more posts</div>';
            $jsonArray['b'] = 'stop';
        }
    } 
```

如果 LIMIT 为 100,10，那么一切正常，直到到达最后一组帖子*AKA*，但调用中有 105 个帖子，它不会向 fetchColumn() 调用任何帖子。

我希望这个问题是有道理的。提前感谢您提供的任何帮助。

**编辑**

如何确定何时达到 LIMIT 并采取相应措施

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:41:36.117

您的描述不是很准确，但也许这就是您要查找的内容：

[http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows)

# string - 如何总结具有字符串类型的数组列表的元素？

> ID：14838783
> 
> 赞同：0
> 
> 时间：2013-02-12T17:59:28.600
> 
> 标签：string, types, arraylist, sum

我有一个由十进制数组成的数组列表，我应该取这个数组列表的最后 4 个元素的平均值。这些有理数是字符串类型。

私人无效平均值（字符串置信度）{

```
 if(myList.size() >= 4) {

    String  t = myList.get(myList.size()-1); 
    String  d = myList.get(myList.size()-2); 
    String  f = myList.get(myList.size()-3);
    String  h = myList.get(myList.size()-4);    

    String s = (t + d + f+h) ;
    long fin = Long.parseLong(s);
    long result = fin/4 ;
    System.out.println("Average is: "+result);
    } 
```

但这种方法不起作用。你能告诉我我应该做什么样的改变或这样做的任何建议吗？非常感谢提前！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:12:22.363

您需要在添加*之前*进行转换。`+`on Strings 表示连接。

```
 if(myList.size() >= 4) {

    //I'm guessing all of these conf.size() calls are meant to be myList.size()
    double  t = Double.parseDouble(myList.get(conf.size()-1)); 
    double  d = Double.pareseDouble(myList.get(conf.size()-2)); 
    double  f = Double.parseDouble(myList.get(conf.size()-3));
    double  h = Double.parseDoublemyList.get(conf.size()-4));   

    double s = (t + d + f+h) ;
    double result = s/3 ; //should be 4
    System.out.println("meanAsrConfidence is: "+result);
    } 
```

您现在正在做的是，例如：

```
t=1, d=2, f=3, h=4
s = 1234 
```

还：

1.  你需要除以 4，而不是 3
2.  什么是`conf`？你为什么不打电话`myList.size()`？
3.  当您可能想要传递时，您正在传递一个字符串作为参数`myList`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:12:57.900

你的问题是`String s = (t + d + f+h)`部分。您现在只是附加 4 个字符串。您需要先转换它们。

你的结果是错误的，你需要除以 4，而不是 3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T18:17:49.647

Colleen 的回答很好，只要您记得更改类型以反映 Long.parseLong() 返回的内容。我会回复，但我太新了。

```
if(myList.size() >= 4) {

    Double t = Double.parseLong(myList.get(conf.size()-1)); 
    Double  d = Double.pareseLong(myList.get(conf.size()-2)); 
    Double  f = Double.parseLong(myList.get(conf.size()-3));
    Double  h = Double.parseLong(myList.get(conf.size()-4));  

    Double result = (t + d + f + h) / 3 ;

    System.out.println("meanAsrConfidence is: "+result);
} 
```

# yii - 在 Yii 应用程序中运行单元测试时出现致命错误

> ID：14838784
> 
> 赞同：4
> 
> 时间：2013-02-12T17:59:29.740
> 
> 标签：yii, phpunit, wamp

**这个问题**是我的本地情况，尚未解决（尚未）。但是，如果您遇到此问题，故障排除步骤可能会为您提供一个很好的起点。

* * *

我想在 localhost 上的 Yii Web 应用程序中运行单元测试，该应用程序通过 Windows 7 上的 WampServer 2.1 运行。

```
<?php
class LittleTest extends CTestCase
{
    public function testApprove()
    {
        $value1 = "1";
        $this->assertEquals($value1,$value1);
    }
}
?> 
```

当我尝试运行测试时收到一个致命错误。这是我在 Windows 命令行上运行它的方式：

```
C:\wamp\www\app\protected\tests>
C:\wamp\www\app\protected\tests>cd unit
C:\wamp\www\app\protected\tests\unit>phpunit LittleTest.php 
```

我收到（连同一些堆栈跟踪行）：

```
PHP Fatal error:  
class 'CTestCase' not found in [path to file]\LittleTest.php on line 4 
```

**到此为止的故障排除步骤：**

应用程序运行。该应用程序的默认索引页面看起来不错，我已经使用 gii 工具创建了一个模型类。

从命令行，我可以看到`php`并且`phpunit`可用（我已经完成了我的 pear 安装以确保一切正常）：

```
C:\wamp\www\app\protected\tests>
C:\wamp\www\app\protected\tests>phpunit --version
PHPUnit 3.7.13 by Sebastian Bergmann.

C:\wamp\www\app\protected\tests>
C:\wamp\www\app\protected\tests>php --version
PHP 5.3.5 (cli) 
... etc 
```

`display_errors`已打开。 `display_startup_errors`已打开。

我尝试重命名该类，以便名称与文档名称不匹配：

```
class LittleTestTweak extends CTestCase 
```

我不确定运行测试的精确命令，所以我尝试了如下变体：

`php LittleTest.php`

我还尝试在文件夹结构中的各个位置运行它。这是直接结构：

```
/tests
    |   bootstrap.php
    |   my_tree.txt
    |   phpunit.xml
    |   WebTestCase.php
    |   
    |---- /fixtures
    |---- /functional
    |         SiteTest.php
    |       
    |---- /report
    `---- /unit
              LittleTest.php 
```

我还检查了我`php.ini`的 PEAR 路径；据我所知，这是正确的（但我该如何测试它？）：

```
include_path=".;C:\wamp\bin\php\php5.3.5\PEAR;C:\wamp\www\app 
```

## 更多信息

对此作出回应：

```
cd wamp\www\app\protected\tests
phpunit unit\LittleTest.php 
```

我收到这个：

```
Warning: require_once(PHPUnit/Extensions/SeleniumTestCase.php): 
            failed to open stream: No such file or directory in 
            C:\wamp\www\yii\framework\test\CWebTestCase.php on line 12

Call Stack:
        0.0007     339624   1\. {main}() C:\wamp\bin\php\php5.3.5\phpunit:0
        0.0164     698440   2\. PHPUnit_TextUI_Command::main() 
               C:\wamp\bin\php\php5.3.5\phpunit:46
        0.0164     698856   3\. PHPUnit_TextUI_Command->run() 
               C:\wamp\bin\php\php5.3.5\PEAR\PHPUnit\TextUI\Command.php:129
        0.0164     698856   4\. PHPUnit_TextUI_Command->handleArguments() 
               C:\wamp\bin\php\php5.3.5\PEAR\PHPUnit\TextUI\Command.php:138
        0.0289    1220944   5\. PHPUnit_TextUI_Command->handleBootstrap() 
               C:\wamp\bin\php\php5.3.5\PEAR\PHPUnit\TextUI\Command.php:606
        0.0300    1233328   6\. PHPUnit_Util_Fileloader::checkAndLoad() 
               C:\wamp\bin\php\php5.3.5\PEAR\PHPUnit\TextUI\Command.php:778
        0.0330    1233424   7\. PHPUnit_Util_Fileloader::load() 
               C:\wamp\bin\php\php5.3.5\PEAR\PHPUnit\Util\Fileloader.php:76
        0.0334    1238096   8\. include_once
               ('C:\wamp\www\app\protected\tests\bootstrap.php') 
               C:\wamp\bin\php\php5.3.5\PEAR\PHPUnit\Util\Fileloader.php:92
        0.0412    1520256   9\. require_once
               ('C:\wamp\www\app\protected\tests\WebTestCase.php') 
               C:\wamp\www\app\protected\tests\bootstrap.php:8
        0.0413    1520520  10\. YiiBase::autoload() 
               C:\wamp\www\yii\framework\YiiBase.php:0
        0.0423    1543904  11\. 
               include('C:\wamp\www\yii\framework\test\CWebTestCase.php') 
               C:\wamp\www\yii\framework\YiiBase.php:395

Fatal error: require_once(): Failed opening required     
        'PHPUnit/Extensions/SeleniumTestCase.php' 
        (include_path='.;C:\wamp\bin\php\php5.3.5\PEAR\pear;C:\wamp\bin\php\php5.3.5\pear') 
        in C:\wamp\www\yii\framework\test\CWebTestCase.php on line 12

Call Stack:
    0.0007     339624   1\. {main}() C:\wamp\bin\php\php5.3.5\phpunit:0
    0.0164     698440   2\. PHPUnit_TextUI_Command::main()  
            ...et cetera... 
```

失败的要求是`PHPUnit/Extensions/SeleniumTestCase.php`. 我想知道问题是否是 PHPUnit 是在本地安装在`C:\wamp`.

我打开我的`php.ini`并添加到`include_path`： `C:\wamp\bin\php\php5.3.5\PEAR\PHPUnit\Extensions`。重新启动wamp。错误报告没有变化。

## 解析度

~~我的安全设置使用了 DansGuardian，而我忽略了放宽禁止扩展类型的设置，这会阻止文件下载。事实上，我不在乎禁止任何类型，修改该文件可以让一切正常工作。~~糟糕，那是我的 Linux 套件。PHPUnit 在那里工作，它也在 WAMP 上工作。在 WAMP 上重新创建步骤是不可能的；但我确实知道我必须以[管理员身份打开 cmd.exe](http://www.mydigitallife.info/how-to-open-elevated-command-prompt-with-administrator-privileges-in-windows-vista/)和`pear update-channels`,`pear upgrade-all`等等。我还必须在某一时刻[清除 pear 的缓存](http://www.mark-leong.com/installing-php-and-phpunit-on-windows-7/)，并且我必须[克服 curl](https://stackoverflow.com/a/8496478/122139)识别问题才能安装 Selenium：

```
pear install --force phpunit/PHPUnit_Selenium 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T19:04:21.200

要使用 phpunit 在 Yii 中运行单元测试，您需要让 phpunit 加载*protected/tests/bootstrap.php*文件，该文件基本上设置了配置，并自动加载所需的类（主要与测试有关）。*bootstrap.php*文件加载*[yiit.php](https://github.com/yiisoft/yii/blob/master/framework/yiit.php "https://github.com/yiisoft/yii/blob/master/framework/yiit.php")*，它实际上会自动加载所需的类。

现在我们可以在运行 phpunit 时通过命令行选项加载所有这些配置，或者让配置通过*protected/tests/phpunit.xml*文件自动读取。

对于后一种方法，调用 phpunit 的目录应该有*phpunit.xml*文件，在 Yii 默认的 webapp 中，这个目录是*protected/tests*。因此，您需要执行以下操作来运行测试：

```
cd wamp\www\app\protected\tests
phpunit unit\LittleTest.php 
```

# c# - 检查一行 XML 是否有效（不是完整的文档）

> ID：14838785
> 
> 赞同：-1
> 
> 时间：2013-02-12T17:59:33.510
> 
> 标签：c#, xml, validation, parsing

在 C# 中：

我有一组文本行（应该是 XML），它们被发送到要添加到 XML 文档中的函数。每行都是一个简单的块，如以下 3 个示例：

```
<AAA f="1" g="3"> </AAA>
<AAA f="2" g="2"> </AAA>
<AAA f="3" g="3"> </AA     <-- Oops a bad one! 
```

我需要检查每一行以查看它是否是有效的 XML，然后才能将其接受为完整的 XML 文档，因为有些行是坏的，但我们想要所有好的。

```
ROW1: good
ROW2: good
ROW3: bad
ROW4: good 
```

在这种情况下，我们只需要 ROW1,2 和 4。

那么，当行字符串不是完整文档时，如何检查行字符串是否是有效的 XML？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T18:05:13.613

我会尝试这样的事情：

```
public static bool IsValid(this string XML)
{
    try
    {
        XElement temp = XElement.Parse(XML);
    }
    catch (FormatException)
    {
        return false;
    }
    catch (XmlException)
    {
        return false;
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:29:21.377

您可以使用 XmlTextReader 验证 XML 文档片段（这就是您的行），但您必须使用特殊的阅读器设置创建阅读器

```
 XmlParserContext context = new XmlParserContext(null, nsmgr, null, XmlSpace.None);
XmlReaderSettings settings = new XmlReaderSettings() {
    ConformanceLevel = ConformanceLevel.Fragment
};
XmlReader reader = XmlReader.Create(new StringReader(xmlFrag), settings, context); 
```

[XmlReaderSettings 一致性级别](http://msdn.microsoft.com/en-us/library/system.xml.xmlreadersettings.conformancelevel.aspx)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-02-12T18:11:11.810

我会这样做。

```
private static bool IsValidXml(string xmlToCheck)
        {
            var doc = new XmlDocument();
            try
            {
                doc.LoadXml(xmlToCheck);
                return true;
            }
            catch (Exception ex)
            {
                //catch ex.
                return false;
            }
        } 
```

# css - 是否可以在里面显示元素文本 没有显示？

> ID：14838786
> 
> 赞同：0
> 
> 时间：2013-02-12T17:59:33.667
> 
> 标签：css, sass

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:03:11.903

简短回答：否。 display:none 表示“不应显示此元素及其所有子元素”。

# javascript - 应该如何处理 ajax 加载的局部视图中的 javascript？

> ID：14838789
> 
> 赞同：4
> 
> 时间：2013-02-12T17:59:45.713
> 
> 标签：javascript, asp.net-mvc, partial-views, asp.net-mvc-partialview

在 ASP.NET MVC 中，在通过 Ajax 加载的局部视图上运行 Javascript 的首选模式是什么？

例如，假设您需要在局部视图中连接一些点击事件。

当然，在局部视图中放置这样的东西是行不通的，因为在局部视图加载 Ajax 后不会触发文档就绪事件。

```
<script type="text/javascript">
    $(function() {
        $("a.foo").click(function() {
            foo();
            return false;
        });
    });
</script> 
```

我想这样的事情可能会奏效，但它安全吗？

```
<script type="text/javascript">
    $("a.foo").click(function() {
        foo();
        return false;
    });
</script> 
```

我一直使用的模式是在加载部分后从我的父视图运行任何 Javascript，如下所示：

```
$.get(url, function(html) {
    $("#partialDiv").html(html);

    // Now that the partial has loaded...
    RegisterClicks();
}); 
```

但我一直在研究[这个](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)例子，并注意到他们只是将点击注册代码内联在局部视图中。

这是一种普遍安全的模式吗？如何确保在我的脚本运行之前部分视图的 DOM 已完成加载？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T19:20:47.550

jQuery .on() 函数应该可以解决问题，不是吗？它应该适用于动态添加的内容。

将此作为完整内容的一部分提供

```
<script type="text/javascript">
    $(function() {
        $("#partialContent").on("click", "a.foo", function() {
            foo();
            return false;
        });
    });
</script>

<div id="partialContent">
   <a href="#" class="foo">Link 1</a>
   <a href="#" class="foo">Link 2</a>
   <!-- More dynamic content -->
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-28T09:47:57.510

```
Scripts are not loaded on Partial view via partial view loaded by ajax in Asp.net MVc 

 <div class="modal fade" id="myEditCourseModal" role="dialog">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title text-center">Update Data</h4>
                    </div>
                    <div class="modal-body" id="CourseEditPreview">
                        @Html.Action("CourseUpdatePartial", "AdminCourse")
                    </div>
                </div>
            </div>
        </div>

<script type="text/javascript">

    function OpenCourseEdit(currentId) {
        $.ajax({
            type: "Get",
            url: '@Url.Action("CourseUpdatePartial", "AdminCourse")',
            cache: false,
            Async: true,
            contentType: 'application/html;charset=utf-8',
            dataType: "html",
            data: { CourseID: currentId },
            success: function (data) {
                var content = $('#CourseEditPreview').html(data);
                eval(content);
                $('#myEditCourseModal').modal('show');
            },
            error: function (error) {
                $("#LoadingPanel").css("display", "block");
                $('#CourseEditPreview').html("");
            }
        })
    }
</script> 
```

# jsf - bean 验证后 JSF 2 枚举属性丢失

> ID：14838791
> 
> 赞同：0
> 
> 时间：2013-02-12T17:59:56.287
> 
> 标签：jsf, enums, bean-validation

使用 JSF2 (MyFaces 2.1) 和 CDI (Weld) 我使用一个填充了枚举的 selectOneMenu 来有条件地呈现第二个 selectOneMenu（代码中的*doublemenu*）。表单中还有其他几个字段使用 bean 验证进行验证。

问题：

如果单击命令按钮后出现验证错误并显示错误消息，则不会再次出现双菜单。似乎*bean.type =='double'*不正确。但为什么？selectOneMenu 本身将选项*双重*显示为所选项目。

```
@javax.inject.Named
@javax.enterprise.context.RequestScoped
public class Bean {

private enum MyEnum {
    Single, Double
}

private MyEnum type;

public MyEnum getType() {
    return type;
}

public void setType(MyEnum type) {
    this.type = type;
}

public MyEnum [] getTypes() {
    return MyEnum.values();
}

<h:form>
<h:selectOneMenu value="#{bean.type}">
  <f:selectItems value="#{bean.types}" />
  <f:ajax render="doublemenu" />
</h:selectOneMenu>

<h:panelGroup id="doublemenu">
  <h:panelGroup rendered="#{bean.type == 'double'}">
    <h:selectOneMenu ...>
    </h:selectOneMenu>
  </h:panelGroup>
</h:panelGroup>
<h:inputText id="VALIDATED"/>
<h:commandButtonaction="#{bean.save}"
</h:form> 
```

顺便说一句：*bean.save*未执行

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T18:07:55.817

这是因为您的 bean 是请求范围的。请求范围的 bean 在每个请求结束时被丢弃，并在每个请求开始时新创建。这也适用于同一视图上的单个 ajax 请求。

*在收集提交的值（应用请求值*阶段）期间也会评估该`rendered`属性。但是，在要收集提交的值时，显然还没有设置（它仍然需要在*更新模型值*阶段根据收集的提交值进行设置）。由于您的 bean 是请求范围的，因此它将返回默认值，而不是先前请求中提交的值。*`#{bean.type}`*

 **基本上有两种方法可以解决这个问题。

1.  将 bean 放在更广泛的范围内。JSF`@ViewScoped`正是为此目的而提供的。这在当前的 JSF 2.1 版本中仅与 CDI 不兼容。如果切换到 JSF`@ManagedBean`不是一个选项，那么您需要[MyFaces CODI](http://myfaces.apache.org/extensions/cdi/)将 JSF 透明地桥`@ViewScoped`接到 CDI，或者等待 JSF 2.2 获得`@ViewScoped`开箱即用的 CDI 兼容。

2.  检查请求参数而不是 bean 属性。

    ```
    <h:selectOneMenu binding="#{type}" ...>
        ...
    </h:selectOneMenu>

    <h:panelGroup rendered="#{param[type.clientId] == 'Double'}"> 
    ```

请注意，这一切都与枚举完全无关。使用例如 a 时，您会遇到完全相同的问题`String`。另请注意，我在您的代码示例中修正了一个错字，枚举值`Double`肯定与`double`.

### 也可以看看：

*   [如何选择合适的bean范围？](https://stackoverflow.com/questions/7031885/how-to-choose-the-right-bean-scope/7031941#7031941)
*   [未调用 commandButton/commandLink/ajax 操作/侦听器方法或未更新输入值](https://stackoverflow.com/questions/2118656/hcommandlink-hcommandbutton-is-not-being-invoked/2120183#2120183)**

# php - 模棱两可的三元语句

> ID：14838794
> 
> 赞同：1
> 
> 时间：2013-02-12T18:00:02.763
> 
> 标签：php

在一个简单的项目上工作，目标是确定它是否是闰年。在 PHP 中，我尝试使用三元而不是标准的 elseif 语句。

```
$year = 2000;
$is_leapYear = ($year%400 == 0)? true: ($year%100 == 0)? false: ($year % 4 == 0);
echo ($year % 400 == 0) .'.'. ($year % 100 == 0) .'.'. ($year % 4 ==0);
echo $year . ' is ' . ($is_leapYear ? '' : 'not') . ' a leap year'; 
```

我发现这不起作用，因为缺少括号。这是正确的解决方案：

```
$is_leapYear = ($year % 400 == 0)? true: (($year % 100 == 0)? false: ($year%4 == 0)); 
```

我的问题是为什么三元运算符需要在顶部`true`或`false`分支上加括号？我不认为上面的代码是模棱两可的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T18:04:20.873

不需要这么复杂的代码。PHP 的 date() 可以返回是否是闰年：

```
$is_leap_year = (bool) date('L', mktime(0, 0, 0, 1, 1, $year)); 
```

请参阅[此处的手册](http://www.php.net/manual/en/function.date.php)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T18:10:14.960

PHP三元运算符没有歧义和悲伤：

```
<?php
// on first glance, the following appears to output 'true'
echo (true?'true':false?'t':'f');

// however, the actual output of the above is 't'
// this is because ternary expressions are evaluated from left to right

// the following is a more obvious version of the same code as above
echo ((true ? 'true' : false) ? 't' : 'f');

// here, you can see that the first expression is evaluated to 'true', which
// in turn evaluates to (bool)true, thus returning the true branch of the
// second ternary expression.
?> 
```

[来源](http://php.net/manual/en/language.operators.comparison.php)

您的代码执行如下：

```
$year = 2000;
$is_leapYear = (($year%400 == 0)? true: ($year%100 == 0)) ? false: ($year%4==0);
echo $is_leapYear; 
```

左到右

# regex - 在 C# 中连接正则表达式模式

> ID：14838801
> 
> 赞同：0
> 
> 时间：2013-02-12T18:00:36.417
> 
> 标签：regex, c#-3.0

我有一个 C# 项目，需要我从 html 流中捕获字符串值。

我需要匹配的模式是：

```
XXXX-abc 
```

在哪里：

```
XXXX = a 4 character integer 
```

其次是 -

```
abc =  a 3 character alphanumeric. 
```

我看着`txt2re.com`并得到

```
 string re1="(\\d)";   // Any Single Digit 1  
  string re2="(\\d)";   // Any Single Digit 2
  string re3="(\\d)";   // Any Single Digit 3
  string re4="(\\d)";   // Any Single Digit 4
  string re5="(-)"; // Any Single Character 1
  string re6="((?:[a-z][a-z]*[0-9]+[a-z0-9]*))";    // Alphanum 1 
```

我遇到的困难是将它组合成一个表达式而不是 6 个。我知道我可以做到：

```
Regex r = new Regex(re1+re2+re3+re4+re5+re6,RegexOptions.IgnoreCase|RegexOptions.Singleline); 
```

但是，我的强迫症对这种方法感到畏缩 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:08:37.070

您可以使用表达式`\d{4}-\w{3}`4 位数字后跟 - 后跟 3 个字母数字字符。[这](http://regexhero.net/)是一个测试和了解正则表达式的好网站。

# html - 将 svg 形状和线条添加到 SVG 剪辑的 div

> ID：14838802
> 
> 赞同：3
> 
> 时间：2013-02-12T18:00:37.897
> 
> 标签：html, css, svg

首先：我正在尝试做的事情暂时与chrome不兼容。请使用 Firefox 检查示例。

这是我所做的：

[http://jsfiddle.net/Robodude/ev6VF/1/](http://jsfiddle.net/Robodude/ev6VF/1/)

```
<style type="text/css">
    .clip3 { 
        clip-path: url(#c3); 
    }
</style>

    <svg height="0">
        <defs>

        </defs>

        <clipPath id="c3">
            <polygon points="75,0 225,0 275,100 225,200 75,200 25,100" />
        </clipPath>
    </svg>
    <div class="container left">
        <div id="Image1" class="Image1 image clip3"></div>
        <div id="Image2" class="Image2 image clip3"></div>
        <div id="Image3" class="Image3 image clip3"></div>  
    </div> 
```

我想做的是在被剪裁的 html 元素上绘制，以便通过 ms paint 为剪切图像绘制一些重音和边框，如下所示。SVG可以做到这一点吗？也许我可以将另一个属性添加到 .clip3 并以某种方式将其链接到一些 svg 形状？

![需要部分边框的十六进制图像帧](../Images/736af2f8ea422836d5c69309f1caea91.png)

我正在尝试很多不同的东西——但它们只是猜测，我找不到任何关于如何做到这一点的资源或信息。

我希望它会如何工作是这样的：

```
<style type="text/css">
    .clip3 { 
        clip-path: url(#c3); 
        border: url(#b1);
    }
</style>

        <defs>
            <polyline id = "b1" points="75,0 225,0 275,100 225,200 75,200 25,100" stroke = "blue" stroke-width = "5"/>
        </defs> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:06:29.763

想出了一个我认为不理想但可行的想法... =\

[http://jsfiddle.net/Robodude/ev6VF/4/](http://jsfiddle.net/Robodude/ev6VF/4/)

```
<svg height="0">
    <clipPath id="c3">
        <polygon points="75,0 225,0 275,100 225,200 75,200 25,100"/>
    </clipPath>

    <defs>
        <polyline id="top" points="225,200 75,200 25,100" style="fill:none;stroke:blue;stroke-width:10" />
        <polyline id="middle" points="225,0 275,100 225,200" style="fill:none;stroke:blue;stroke-width:10" />
        <polyline id="bottom" points="25,100 75,0 225,0" style="fill:none;stroke:blue;stroke-width:10" />
    </defs>

</svg>

<div class="container left">
    <div id="Image1" class="Image1 image clip3">
        <svg width="100%" height="100%">
            <use xlink:href = "#top"/>
        </svg>
    </div>
    <div id="Image2" class="Image2 image clip3">
        <svg width="100%" height="100%">
            <use xlink:href = "#middle"/>
        </svg>
    </div>
    <div id="Image3" class="Image3 image clip3">
        <svg width="100%" height="100%">
            <use xlink:href = "#bottom"/>
        </svg>
    </div>  
</div> 
```

# c# - 动态渐变

> ID：14838805
> 
> 赞同：2
> 
> 时间：2013-02-12T18:00:59.750
> 
> 标签：c#, javascript, asp.net, css, less

我正在研究一个模型，该模型将根据国家和百分比显示一个人的遗传人口构成。我已经对这些数据进行了计算。我需要一个能够解释这些数据并将其显示在页面上的解决方案。我试图达到的解决方案将执行以下操作：

根据从数据库中提取的数据创建一个国家数组，然后从现有的颜色数组中分配一种颜色，color1 = country1...等等。一旦将颜色分配给国家，将颜色插入具有动态百分比（与国家相关的百分比）的动态渐变中。

我已经探索了几种没有可靠解决方案的方法。我的颜色数组包括 10 种颜色，所以我尝试了较少的路线，但是我如何将颜色分配传达给 JS 中的国家？（注意：我对我的 less 代码做了一些更新！！）

```
@yellow: #feea00;
@green1: #85c441;
@green2: #15ae4b;
.gradient (@color; @color2) {
background: -moz-linear-gradient(top,  @color 0%, @color2 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,@color), color-stop(100%, @color2)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  @color 0%,@color2 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  @color 0%,@color2 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  @color 0%,@color2 100%); /* IE10+ */
background: linear-gradient(to bottom,  @color 0%,@color2 100%); /* W3C */
-ms-filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='@color', endColorstr='@color2',GradientType=0 ); /* IE6-9 */
}

.cMatch img.green1 {
  .gradient (@green1; (@green1 + #222));
}
.cMatch img.green2 {
  .gradient (@green2; (@green2 + #222));
 }
.cMatch img.blue1 {
 .gradient (@blue1; (@blue1 + #222));
 } 
```

等等

我还认为只是在 js 中做一个动态样式，但我不确定我是否以正确的方式来完成我需要它做的所有事情......我真的很想要一个基于 jquery 并使用上面更少代码的解决方案，但是我还处于实验阶段！以下是我的动态 js 尝试。

```
var CountryColor = ['feea00', '85c441', '15ae4b', '0078ff', '36c4bf', '392a7d', 'a02896', 'c52127', 'f09c20', 'e75725'];

$(document).ready(function () {
    $('.Jewish').style.background = "webkit-gradient(linear, left top, left bottom, color-stop(0%," + CountryColor + "), color-stop(10%,#ffffff), color-stop(11%," + CountryColor + "), color-stop(22%,#ffffff), color-stop(23%," + CountryColor3 + "), color-stop(34%,#ffffff), color-stop(35%," + CountryColor4 + "), color-stop(45%,#ffffff), color-stop(46%," + CountryColor5 + "), color-stop(55%,#ffffff), color-stop(56%," + CountryColor6 + "), color-stop(66%,#ffffff), color-stop(67%," + CountryColor7 + "), color-stop(76%,#ffffff), color-stop(77%," + CountryColor8 + "), color-stop(83%,#ffffff), color-stop(84%," + CountryColor9 + "), color-stop(91%,#ffffff), color-stop(92%," + CountryColor10 + "), color-stop(100%,#ffffff));
}); 
```

根据国家/地区的百分比细分，渐变将具有 1 种颜色到 10 种颜色。

任何人对最佳路线的任何建议将不胜感激。我的整个网站都是在 asp.net 和 C# 中完成的，所以如果有人对这条路线有建议，那也可以。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:18:55.533

您已经非常接近 JS 示例 - 有一些问题：

*   您没有使用正确的数组语法来获取各个颜色。数组是 0 索引的，并且像 ArrayName[i] 一样最容易访问（因此，CountryColor[0] 到 CountryColor[9]

*   jQuery 集合使用 .css() 方法[http://api.jquery.com/css/](http://api.jquery.com/css/)来设置背景（不是你所拥有的“风格”，这是一个直接的 JS 事物）。

*   您应该避免在 jQuery 中使用裸类选择器，因为它们非常缓慢且效率低下，要么使用 ID（如果每个渐变都是唯一的），要么使用标签名称限定您的选择器，或者首先通过 ID 查找元素，然后查找在里面你想要的课程。你可以两者都做 - 例如：`$('#yourContainer div.Jewish')`.

这个例子应该可以工作：

```
var CountryColor = ['#feea00', '#85c441', '#15ae4b', '#0078ff', '#36c4bf', '#392a7d', '#a02896', '#c52127', '#f09c20', '#e75725'];

$(document).ready(function () {
  $('.Jewish').style.background = "webkit-gradient(linear, left top, left bottom, color-stop(0%," + CountryColor[0] + "), color-stop(10%,#ffffff), color-stop(11%," + CountryColor[1] + "), color-stop(22%,#ffffff), color-stop(23%," + CountryColor[2] + "), color-stop(34%,#ffffff), color-stop(35%," + CountryColor[3] + "), color-stop(45%,#ffffff), color-stop(46%," + CountryColor[4] + "), color-stop(55%,#ffffff), color-stop(56%," + CountryColor[5] + "), color-stop(66%,#ffffff), color-stop(67%," + CountryColor[6] + "), color-stop(76%,#ffffff), color-stop(77%," + CountryColor[7] + "), color-stop(83%,#ffffff), color-stop(84%," + CountryColor[8] + "), color-stop(91%,#ffffff), color-stop(92%," + CountryColor[9] + "), color-stop(100%,#ffffff));
}); 
```

如果您使用 JS 对象来存储颜色，可能会更容易阅读您的代码：

```
CountryColors = {
  Afghanistan: '#00FFCC',
  Albania: '#00FFCC',
  Algeria: '#00FFCC',
  American Samoa: '#00FFCC',
  Andorra: '#00FFCC', 
  Angola: '#00FFCC',  
  Anguilla: '#00FFCC',  
  Antigua and Barbuda: '#00FFCC',
  Argentina: '#00FFCC', 
  Armenia: '#00FFCC',
  Aruba: '#00FFCC'         
} 
```

然后您可以在 JS 中按名称引用它们：

```
CountryColors.Afghanistan 
```

最后，打包所有这些的好方法是创建一个简单的 jQuery 插件，它会为您处理所有这些，并创建所有特定于浏览器的样式，插入空格等。您可以这样称呼它：

```
$('div#Bob').countryColorFill({Albania: 15%, Angola: 45%, Aruba: 40%}); 
```

它的实现相当简单，但对于这个答案可能有点偏离轨道。

# plone - 如何在 Plone Software Center 中显示“项目资源”和“实验版本”项目 portlet？

> ID：14838809
> 
> 赞同：1
> 
> 时间：2013-02-12T18:01:10.670
> 
> 标签：plone

我在 Plone 4.2.4 实例中安装了 Plone Software Center 1.6.4。在我实例化的软件项目中，项目徽标出现在右侧栏中，但“项目资源”和“实验版本”portlet 均未出现。它们在 plone.org 的 PSC 中明显可见。任何关于如何显示这些 portlet 的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T12:03:42.247

Plone Software Center 中包含的 portlet 是“经典 portlet”；它们早于当前的 portlet 系统并且是纯粹的皮肤模板，真的。

要包括这些，请将“经典 portlet”添加到软件项目类型（在站点设置 -> 类型 -> 在下拉框中选择“软件项目” -> 管理分配给此内容类型的 portlet）。

Classic Portlet 类型有两个参数，一个模板和一个宏。您正在寻找的 PSC portlet 使用`portlet_project_resources`和`portlet_project_roadmap`模板，在这两个宏中都称为`portlet`.

# java - 无法从 Clojure 调用实例方法。

> ID：14838811
> 
> 赞同：2
> 
> 时间：2013-02-12T18:01:14.397
> 
> 标签：java, clojure, leiningen, clojure-java-interop

我对Java和clojure完全陌生。但是凭借以前在 common lisp 方面的经验，我想我会尝试一下 clojure。我无法弄清楚一些非常基本的事情。

这是实际的 Java 代码。

```
import syntaxtree.*;
import visitor.*;

public class Main {
    public static void main(String [] args) {
    try {
        Node root = new MicroJavaParser(System.in).Goal();
        System.out.println("Program parsed successfully");
    }
    catch (ParseException e) {
        System.out.println(e.toString());
    }
    }
} 
```

当我运行此代码时，结果符合预期。

```
└──╼ java Main < ../input/Factorial.java 
Program parsed successfully 
```

在 Clojure 我试过这个：

```
(ns clj-assign2.core)

(defn -main
  []
  (def root
    (.Goal
     (MicroJavaParser. (. System in))))
  (println "Successfully parsed")) 
```

但是当这段代码运行时，会引发以下异常：

```
└──╼ lein run < ../assign2/input/Factorial.java 
Exception in thread "main" java.lang.IllegalArgumentException: No matching field found: Goal for class MicroJavaParser
    at clojure.lang.Reflector.getInstanceField(Reflector.java:271)
    at clojure.lang.Reflector.invokeNoArgInstanceMember(Reflector.java:300)
    at clj_assign2.core$_main.invoke(core.clj:7)
< --- snipped --- > 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:21:42.027

也许您在 clojure 程序中缺少导入语句？

# iphone - 发布 C 库（使用 ARC）

> ID：14838814
> 
> 赞同：0
> 
> 时间：2013-02-12T18:01:23.777
> 
> 标签：iphone, ios, objective-c, c, automatic-ref-counting

我目前`rtmpdump`在我的 iOS 应用程序中用作 C 程序。但是，我似乎不能多次使用它而不必重新启动应用程序。这可能是什么原因，我该如何解决？

相关代码：

```
NSDictionary *details = [args objectAtIndex:0]; //rtmpe deatils
NSString *flvStore = [args objectAtIndex:1];
NSString *mp4Store = [args objectAtIndex:2];
[self performSelectorOnMainThread:@selector(updateProgressBar:) withObject:flvPath waitUntilDone:NO];
[self getFlashFile:details withFlvPathName:flvStore];

NSFileManager *fileManager = [NSFileManager defaultManager];
if([fileManager fileExistsAtPath:flvPath]){
    NSNumber *filesize = 0;
    NSDictionary *fileAttributes = [[NSFileManager defaultManager] fileAttributesAtPath:flvPath traverseLink:NO];
    if(fileAttributes != nil){
        filesize = [fileAttributes objectForKey:NSFileSize];
    }

    if([filesize longLongValue] > 1024){
        [self removeFlvWrapper:flvPath withMp4PathName:mp4Path andTitle:[thePid objectForKey:@"title"]];
    }
    [fileManager removeItemAtPath:flvPath error:NULL];
} 
```

* * *

```
- (void)getFlashFile:(NSDictionary *)details withFlvPathName:(NSString *)flvPath {
static char **rt_argv;
static int    rt_argc;

rt_argc = 16;
rt_argv = (char **)malloc(sizeof(char *) * (rt_argc));
rt_argv[0] = "rtmpdump";
rt_argv[1] = (char *)[@"-r" UTF8String];
rt_argv[2] = (char *)[[details objectForKey:@"r"] UTF8String];
rt_argv[3] = (char *)[@"-a" UTF8String];
rt_argv[4] = (char *)[[details objectForKey:@"a"] UTF8String];
rt_argv[5] = (char *)[@"-f" UTF8String];
rt_argv[6] = (char *)[@"WIN 10,0,32,18" UTF8String];
rt_argv[7] = (char *)[@"-W" UTF8String];
rt_argv[8] = (char *)[[details objectForKey:@"W"] UTF8String];
rt_argv[9] = (char *)[@"-p" UTF8String];
rt_argv[10] = (char *)[[details objectForKey:@"p"] UTF8String];
rt_argv[11] = (char *)[@"-y" UTF8String];
rt_argv[12] = (char *)[[details objectForKey:@"y"] UTF8String];
rt_argv[13] = (char *)[@"-o" UTF8String];
rt_argv[14] = (char *)[flvPath UTF8String];
rt_argv[15] = (char *)[@"-q" UTF8String];

getStream(rt_argc, rt_argv);
finished = true;
} 
```

您还可以查看[iPlayerFetch.m 下的 BigBadOwl 存储库](https://github.com/BigBadOwl/iStreamer-Download-Manager/blob/master/iplayerFetch.m)以查看类似代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T22:56:19.260

我最终在 Objective-C 中创建了 rtmpdump 的替代方案。该代码使用 librtmp 而不是 rtmpdump，但灵感来自 rtmpdump。

谢谢！

# python - Markdown 解析代码应该在 Django 应用程序中的什么位置？

> ID：14838815
> 
> 赞同：0
> 
> 时间：2013-02-12T18:01:31.077
> 
> 标签：python, django, markdown, wmd-editor

我在 django 管理员中使用 WMD 编辑器。我编写了一个简单的解析器（主要是正则表达式），因此我可以在 markdown 中捕获特定标签并相应地插入 HTML。我的问题是我需要访问 Django 对象本身。

目前我正在压倒一切`Model.save()`并打电话`Model.process_markdown()`

```
def process_markdown(self):
    p = re.compile("\[\[\s*(?P<tag>image):(?P<id>[\d,]+)\s*\]\]")
    processed = p.sub(partial(render_markdown, self), self.body_markdown)
    return markdown.markdown(processed) 
```

然后将结果保存到`Model.rendered`我的模型上的一个字段中。如果你注意到我有一个`render_markdown`函数被调用。那存储在我的应用程序中调用的文件`util.py`中，并完成所有实际工作。

一切正常，但这似乎应该有更好的方法。我知道我可以绑定到自定义标签的降价并做到这一点更清洁，但我必须能够访问 django 对象，并且当我引用相关的内联对象时。据我所知，我没有办法做到这一点。

有没有更好的方法来组织这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T23:36:15.797

请注意，markdown 允许通过隧道传输 HTML。如果您这样做，您可能需要 markdown(html, safe_mode='escape') 如果您允许不受信任的来源插入 .body_markdown，您将需要通过类似漂白剂的方式清理该输入：[http://pypi.python。 org/pypi/漂白剂](http://pypi.python.org/pypi/bleach)

# r - R中网格上大型模拟的并行化

> ID：14838816
> 
> 赞同：2
> 
> 时间：2013-02-12T18:01:37.463
> 
> 标签：r, foreach, domc, snow

我正在网格上运行一系列大型模拟。我正在按行执行模拟，我发现我的采样函数是一个瓶颈。我尝试使用 foreach 和 doMC 库来加速该过程，但我发现并行方法较慢，或者我无法编写将由 foreach 正确解释的函数。

查看其他一些帖子，看来我使用 foreach 的方法可能会被误导，因为我尝试的作业数量大大超过了可用处理器的数量。我想知道人们是否会对如何在我的情况下最好地实现并行化提出一些建议。我的模拟通常有两种类型。在第一个中，我计算一个矩阵，其中包含我正在处理的网格行中每个元素的采样间隔（行）。然后我使用 runif 进行采样（在实际模拟中，我的行包含 ~ 9000 个单元格，并且我正在执行 10000 个模拟）。

```
#number of simulations per element 
n = 5

#Generate an example sampling interval.
m.int1 <- matrix ( seq ( 1, 20, 1 ), ncol=10, nrow=2 )

#Define a function to sample over the interval defined in m.int1
f.rand1 <- function(a) {
return ( runif ( n, a[1], a[2] ) )
}

#run the simulation with each columns corresponding to the row element and rows 
#the simultions.
sim1 <- round( apply ( m.int1, 2, f.rand1 ) ) 
```

在第二种情况下，我试图从一组按矩阵中的列索引的经验分布中进行抽样。grid-row 元素的值对应于要采样的列。

```
#number of simulations per element 
n = 5

#generate a vector represeting a row of grid values 
v.int2 <- round(runif(10,1,3))

#define matrix of data that contains the distributions to be sampled.
m.samples<-cbind(rep(5,10),rep(4,10),rep(3,10))  

f.sample <- function(a) {
return ( sample ( m.samples [ ,a], n, ) )
}

#Sample m.samples indexed by column number.
sim2<- sapply(v.int2,f.sample) 
```

在第二个示例中，我能够利用*foreach()*和*%dopar%*并行运行，但模拟花费的时间比串行代码长得多。在上面的第一个示例中，我无法编写适当的函数来利用 foreach 并行化。我将把我在第二种情况下使用的代码只是为了展示我的想法——但我现在意识到我的方法在开销上太昂贵了。

```
library(foreach)
library(doMC)
registerDoMC(2)

n = 5

#Sample m.samples indexed by column number using parallel method.
sim2.par <- foreach ( i = 1 : length ( v.int2 ), 
    .combine="cbind") %dopar% sample ( 
     m.samples [ , v.int2 [i] ] , n ) 
```

我很感激一些关于一种方法（和一些代码！）的建议，这将有助于我有效地利用并行化。同样，我正在处理的行通常包含大约 9000 个元素，我们对每个元素进行 10000 次模拟。所以我的输出模拟矩阵一般在 10000 X 9000 的量级。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:13:08.063

尝试使用它而不是两步过程。它跳过了这`apply`一步：

```
f.rand2 <- function(a) {
  matrix( runif ( n*ncol(a), rep(a[1,], n) , rep(a[2,], n) ), nrow=ncol(a) )
                    }

f.rand2(m.int1)
           [,1]      [,2]      [,3]      [,4]      [,5]
 [1,]  1.693183  1.404336  1.067888  1.904476  1.161198
 [2,]  3.411118  3.852238  3.621822  3.969399  3.318809
 [3,]  5.966934  5.466153  5.624387  5.646181  5.347473
 [4,]  7.317181  7.106791  7.403022  7.442060  7.161711
 [5,]  9.491231  9.656023  9.518498  9.569379  9.812931
 [6,] 11.843074 11.594308 11.706276 11.744094 11.994256
 [7,] 13.375382 13.599407 13.416135 13.634053 13.539246
 [8,] 15.948597 15.532356 15.692132 15.442519 15.627716
 [9,] 17.856878 17.208313 17.804288 17.875288 17.232867
[10,] 19.214776 19.689534 19.732680 19.813718 19.866297 
```

对我来说，它把时间缩短了一半：

```
> system.time(x1 <- replicate(n, round(apply(m.int1, 2, f.rand1))))
   user  system elapsed 
  1.088   0.470   1.550 

> system.time(x1 <- replicate(n, f.rand2(m.int1)))
   user  system elapsed 
  0.559   0.256   0.811 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T19:58:21.903

这是您的第一次模拟的轻微改进。更大`n`可能会在运行时产生更大的收益。

```
> n <- 1000
> m.int1 <- matrix ( seq ( 1, 20, 1 ), ncol=10, nrow=2 )
> f.rand1 <- function(a) {
+    return(runif(n, a[1], a[2]))
+ }
> system.time(x1 <- replicate(n, round(apply(m.int1, 2, f.rand1))))
   user  system elapsed 
   2.84    0.06    2.95 
> system.time(x2 <- replicate(n, matrix(round(runif(n*10, min = m.int1[1, ], max = m.int1[2, ])), ncol = 10, byrow = TRUE)))
   user  system elapsed 
   2.48    0.06    2.61 
> head(x1[,,1])
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
[1,]    1    4    5    7   10   12   13   16   17    20
[2,]    1    3    6    7   10   11   13   16   17    19
[3,]    1    3    6    7   10   12   14   16   18    20
[4,]    2    4    5    7    9   12   14   16   17    19
[5,]    1    4    5    7   10   12   14   16   17    20
[6,]    1    4    6    8    9   11   13   15   18    20
> head(x2[,,1])
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
[1,]    2    4    6    7    9   12   14   16   17    20
[2,]    1    3    6    8   10   12   14   15   18    20
[3,]    2    4    5    7    9   11   13   15   17    20
[4,]    2    3    5    7    9   11   14   15   17    19
[5,]    2    3    6    7    9   12   13   16   17    20
[6,]    2    4    6    7   10   12   14   16   17    20 
```

# c++ - 从字符串获取行（不是从字符串流）

> ID：14838819
> 
> 赞同：0
> 
> 时间：2013-02-12T18:01:48.440
> 
> 标签：c++, string, std, getline, c++-standard-library

假设我有一个 std::string "55|6999|dkfdfd|"。它包含 3 个部分（每个部分后跟 |）。目前我将字符串放入 stringstream 并使用 getline 来恢复它们。但是我想知道是否有一个不需要流的更简单的解决方案。我只需要一种简单的方法来使用'|'从该字符串中获取行 作为delim，因为我认为流对它来说太过分了，我做错了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:07:07.603

如果允许提升，那么[`boost::split`](http://www.boost.org/doc/libs/1_53_0/doc/html/string_algo/usage.html#idp163440592)将是一种选择。它可用于填充 a `std::vector<std::string>`，其中将包含根据指定分隔符从输入中提取的*字段：*

```
#include <vector>
#include <string>
using std::vector;
using std::string;

#include <boost/algorithm/string.hpp>
#include <boost/algorithm/string/split.hpp>
using boost::split;
using boost::is_any_of;

vector<string> fields;
split(fields, "55|6999|dkfdfd|", is_any_of("|")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:03:25.917

您可以`std::strtok`改用：

```
char *token = std::strtok(<yourstring>, "|"); 
```

< yourstring > 必须是类型`char*`；然后`NULL`用于之后的那些，`std::strtok`跟踪以前使用的字符串。

```
token = std::strtok(NULL, "|"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T18:04:46.500

您所说的称为“标记化”字符串。这通常是你最好的选择。至于如何做，请参阅“[如何在 C++ 中标记字符串？](https://stackoverflow.com/questions/53849/how-do-i-tokenize-a-string-in-c) ”

# visualization - 具有基本节点/边缘过滤的交互式 Graphviz 查看器

> ID：14838820
> 
> 赞同：23
> 
> 时间：2013-02-12T18:01:51.623
> 
> 标签：visualization, graphviz, interactive, viewer

我查看了[Graphviz 资源页面](http://www.graphviz.org/Resources.php)，以及问题[1](https://stackoverflow.com/questions/7034/graph-visualization-code-in-javascript)和[2](https://stackoverflow.com/questions/6344318/pure-javascript-graphviz-equivalent)，但仍然找不到具体答案。我的用例是浏览软件组件（例如可安装包）之间的依赖关系，它的一个特殊特征是一些公共节点是许多边缘的目标。例如，几乎每个可执行包都依赖于 libc。

基于该特征，我希望查看器/库具有以下功能：

1.  使用 Graphviz“点”布局算法（不同库中大量的强制布局算法不能为所讨论的用例提供良好的布局质量）。
2.  以交互方式禁用/重新启用图中的某个节点（上面的 libc 示例）。
3.  以交互方式禁用/重新启用来自特定节点的所有边缘（例如，libpng 依赖于 libz，但这很明显，并且可以禁用以不使视图混乱）。
4.  在某个节点处重新根图（显示仅可从该节点到达的节点的子图），然后“缩小”以完成图。

理想情况下，这将是一个 Javascript 库，可以轻松实现更复杂的操作功能。重要的是，如上所述的基本查看行为开箱即用 - 同样，我找不到类似的东西，许多解决方案要么是静态查看器，要么是允许拖动节点的“自由形式编辑器”，但不是足够高级和有用的行为。

最后，如果不存在这样的解决方案，欢迎提出实现这些功能的最佳框架的建议。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-10-05T11:34:22.193

Gephi, [https://gephi.org/](https://gephi.org/)，它支持很多图形格式，当然也包括Graphviz dot。它可以过滤节点或边，并具有某种分析功能。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-14T19:41:03.853

我发现 José Fonseca 的[xdot.py](https://github.com/jrfonseca/xdot.py)是非常酷的基于 Python 和 Cairo 的应用程序，用于查看 Graphviz 文件。它写得很好，UI 也很好，有人可能想知道为什么它的交互支持有点特别，不允许开箱即用的更多可扩展性。我目前正在[https://github.com/pfalcon/xdot.py](https://github.com/pfalcon/xdot.py)

更新：我将上述功能的概念验证提交为 filters-viewer.py 。以后可能会改名。

# php - PHP 和 Xpath（如果节点为空，则 Xpath 将值设置为 '0'）

> ID：14838821
> 
> 赞同：0
> 
> 时间：2013-02-12T18:01:53.777
> 
> 标签：php, xpath, domxpath

大家好，我正在为 XPath 查询苦苦挣扎，我希望查询在没有发现任何内容时返回“0”值。到目前为止，这是我的代码：

`$query = $xpathvar->query('//DataStatistics/report'); foreach($query as $result){ echo "$result->length";`

它现在只是返回空白，任何建议将不胜感激？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:04:29.970

您必须获取`$query`自身的长度（如果没有`length`，则循环永远不会运行）：

```
$query = $xpathvar->query('//DataStatistics/report');
echo $query->length; 
```

# .net - IIS 7 和块/流文件上传问题

> ID：14838825
> 
> 赞同：1
> 
> 时间：2013-02-12T18:02:07.767
> 
> 标签：.net, iis-7, chunked

我正在尝试通过 WCF Rest 服务上传音频文件。我们有一个网络播放器，可以在录制时将数据逐块发送到服务器。我们必须上传大文件，所以在这里选择了 CHUNKED 选项。该服务的方法工作正常，当停止录制或定义的录制持续时间结束时，录制的文件保存在文件系统中。

但是，我注意到当启用 CHUNKED 时，在文件完全上传之前不会调用方法，这意味着 WCF 似乎在调用该方法之前正在某处缓存文件。而不是这种行为，服务方法应该在收到第一个块后立即调用，并且应该在文件系统中创建文件。我们还使用wireshark检查了结果，发现有许多块数据包，但文件仅在STOP之后才保存。

下面是服务配置：

```
<system.serviceModel>
<serviceHostingEnvironment aspNetCompatibilityEnabled="true"/>
<standardEndpoints >
<webHttpEndpoint >
<standardEndpoint
maxBufferSize="2147483647" maxReceivedMessageSize="2147483647"
name="" helpEnabled="true" automaticFormatSelectionEnabled="true" transferMode="Streamed"/>
</webHttpEndpoint>
</standardEndpoints>
</system.serviceModel> 
```

我们也曾经 `appcmd set config /section:asp /enableChunkedEncoding:True|False`启用或禁用 HTTP 1.1`chunked`传输编码，但它不起作用。

# c++ - 检查 char * 文件名的条件

> ID：14838827
> 
> 赞同：0
> 
> 时间：2013-02-12T18:02:21.250
> 
> 标签：c++

我想给用户指定一个文件的选项（这里是`ground_truth_filename`）。如果他没有指定选项，我想对默认文件名做出假设。

但是，即使我像在主程序中那样初始化它，我也无法检查`ground_truth_filename`是还是零。如果参数由用户传递，我将分配给该参数。但是检查给了我一个断言错误。`NULL``0``ground_truth_filename``ground_truth_filename == 0`

任何帮助将不胜感激。

```
int processFile(const char *filename, 
                YAML::Emitter &out_yaml, 
                char *ground_truth_filename)
{   
    std::cout << "Here" << std::endl;

    if (ground_truth_filename == 0)
        sprintf(ground_truth_filename,"%s.yaml",filename);        

    std::ifstream imgstrm(filename, std::ios::binary | std::ios::in);

    if (imgstrm.bad() || !imgstrm.is_open())
    {
        fprintf(stderr, "Failed to open file: %s\n", filename);
        return FILE_ERROR;
    }

    // get ground truth
    std::ifstream ground_truth_stream(ground_truth_filename);

    if (!ground_truth_stream.is_open()) 
    {
        fprintf(stderr, "Failed to open file: %s\n", ground_truth_filename);
        return FILE_ERROR;
    }
} 
```

这是函数的调用方式。也许我应该初始化 ground_truth_filename = '\0'？

```
char *ground_truth_filename = 0;
for (int i = 1; i + 1 < argc; i += 2) {
            if (!strcmp(argv[i], "--snapshot-markup")) {
                ground_truth_filename = argv[i + 1];
                markupFlag = true;
            }
        }
processFile(filename, out_yaml, ground_truth_filename) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:38:14.593

的第一个参数`sprintf`必须是指向足够大以保存输出的缓冲区的指针。指向较小字符缓冲区的`NULL`指针或指针（例如字符串文字“”）将导致崩溃。

可行的代码是：

```
char buf[256];

if (ground_truth_filename == NULL) {
   int charsneeded = snprintf(buf,sizeof(buf),"%s.yaml",filename);
   if (charsneeded >= sizeof(buf)) {
     return FILE_ERROR; // filename too long
   }
   ground_truth_filename = buf;
} 
```

关键是这`buf`让新事物`filename`在记忆中占有一席之地。字符串需要那个。

编辑：添加了 charsneeded 以保护您免受文件名过长作为安全措施。如果您确实需要它，请改为动态分配 buf。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:37:25.463

您需要先分配 ground_truth_filename，然后才能将字符复制到其中。

```
 if (ground_truth_filename == 0)
  {
    int length = strlen(filename) + strlen(".yaml") + 1;
    ground_truth_filename = new char[length];
    sprintf(ground_truth_filename,"%s.yaml",filename);   
  } 
```

# tastypie - 在 Tastypie 中通过 ForeignKey 反向查找

> ID：14838828
> 
> 赞同：0
> 
> 时间：2013-02-12T18:02:21.810
> 
> 标签：tastypie

我有一个帖子模型和一个评论模型，其中包含为特定帖子所做的评论。

```
class Post(models.Model):
    body = models.TextField()
    user = models.ForeignKey(User)

class Comment(models.Model):
    post = models.ForeignKey(Post)
    date = models.DateTimeField(auto_now_add=True)
    comment = models.TextField()
    comment_user = models.ForeignKey(User) 
```

现在我希望我的 Post 资源包含附加到特定帖子的所有评论的 URI。

我知道我可以用`fields.ForeignKey`它来表示我的评论属于哪个帖子，但我希望 API 在帖子对象中拥有属于该帖子的所有评论的 URI。我希望这是有道理的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T22:40:15.933

```
class PostResource(ModelResource):
     comments = fields.ToManyField(CommentResource, 'comments') 
```

我之前已经回答过类似的问题。检查此[链接](https://stackoverflow.com/questions/14822280/unable-to-get-tomany-to-work-in-tastypie/14830622#14830622)

# html - 如何正确地让 div 并排放置而不进行包装？

> ID：14838829
> 
> 赞同：0
> 
> 时间：2013-02-12T18:02:21.893
> 
> 标签：html, css

我理解您可以使用 inline-blocks 让 div 彼此相邻的想法，并且您可以在父级上使用 nowrap 以确保它们不会换行。我的问题是，将任何 div 放入其中会使以下 div 向下推。我创建了一个 jsfiddle 来显示问题：

[http://jsfiddle.net/MMtNQ/2/](http://jsfiddle.net/MMtNQ/2/)

html的要点是这样的：

```
<div class="wrapper">
    <div class="side-by-side">
        <div>Text here</div>
        <div>Text here</div>
    </div>
    <div class="side-by-side">
        <div>Text here</div>
    </div>
</div> 
```

您可以看到由于我在第一个中的 div 而向下调整了 div。我怎样才能让它们全部对齐顶部？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T18:05:27.560

添加 `vertical-align: top;`到`.side-by-side` 定义

```
.side-by-side {
    display: inline-block;
    width: 300px;
    height: 300px;
    background-color: #e6e6e6;
    margin-right: 10px;
    vertical-align: top;
} 
```

[这是一个小提琴](http://jsfiddle.net/jcurran/EHD3X/)。

# jquery - 获取Jquery进度条的值

> ID：14838830
> 
> 赞同：3
> 
> 时间：2013-02-12T18:02:23.417
> 
> 标签：jquery, html

我希望找到进度条的值，这样我就可以在每一步中将它增加一个百分比，但无论我尝试什么，要么说它是未定义的，要么在实例化对象之前无法调用该方法。

我尝试过的事情：

```
 alert($('progressbar:first').prop('progress-label')); 

 progressbarValue = progressbar.find( ".progress-label" ).val(); 
```

## HTML

```
<div id="progressbar"><div class="progress-label">Form Process</div></div> 
```

* * *

```
if(condition == true) {

    progressbar = $( "#progressbar" );
    progressbarValue = progressbar.find( ".ui-progressbar-value" );
    progressLabel = $( ".progress-label" );

    var size = parseInt($("#fieldWrapper .step").size(),10);
    var progress = 100/size ; 

 alert($('progressbar:first').prop('progress-label')); 
  progressbar.progressbar({
      value: progress,
      change: function() {
        progressLabel.text( progressbar.progressbar( "value" ) + "%" );

      },
      complete: function() {
        progressLabel.text( "Complete!" );
      }
    });

        progressbarValue.css({
          "background": '#' + Math.floor( Math.random() * 16777215 ).toString( 16 )
        });

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-12T18:07:35.660

尝试使用进度条小部件的 value 方法。

```
$("#progressbar").progressbar("value"); 
```

[http://api.jqueryui.com/progressbar/#method-value](http://api.jqueryui.com/progressbar/#method-value)

请注意，您之前必须已经启动了进度条才能获得它的价值。否则，该元素还不是进度条。

演示：http: [//jsfiddle.net/3sbTw/](http://jsfiddle.net/3sbTw/)

# javascript - 滚动而不是锚定

> ID：14838831
> 
> 赞同：1
> 
> 时间：2013-02-12T18:02:23.010
> 
> 标签：javascript, jquery, scroll

我的网站只有一页，我希望它向下滚动到我拥有的两/三个部分，而不是跳到锚点。任何帮助都会很棒。

HTML：

```
<nav id="header-navigation" class="sixteen columns" role="navigation">

<ul id="navigation">
<li><a href="#header-global" title="Home">Home</a></li>
<li><a href="#latest-work" title="Our Work">Startups</a></li>
<li><a href="#contact" title="Contact Us">Contact Us</a></li>
</ul>

</nav><!-- end #header-navigation --> 
```

那么我只是在某处添加一个 .js 文件吗？我是否在我的 HTML 中添加以下代码？

```
<script type="text/javascript">
function scrollTo(target) {
    var targetPosition = $(target).offset().top;
    $('html,body').animate({
        scrollTop: targetPosition
    }, 'slow');
}
</script> 
```

我的网站是 pinstart.us

# android - 将 StackMob sdk 导入库时出错（与 annotations.jar 或 dalvik 相关？）

> ID：14838836
> 
> 赞同：0
> 
> 时间：2013-02-12T18:02:32.960
> 
> 标签：android, intellij-idea, dalvik, stackmob

当我想使用 StackMob sdk 时，我给出了我在下面分享的错误。它仅在编译过程中出现。在询问之前，我检查了与这种情况相关的所有类似问题，但是它们并没有解决我的问题。

根据一般意见，这可能是由于两次隐式导入外部 jar 造成的。但是我可能检查了 100 次，但是没有两次使用相同名称的任何 jar 文件。

Ps：我使用 Intellij Idea 作为 IDE。

```
Android Dex: [POF] UNEXPECTED TOP-LEVEL EXCEPTION:
Android Dex: [POF] java.lang.IllegalArgumentException: already added: Landroid/annotation/SuppressLint;
Android Dex: [POF] at com.android.dx.dex.file.ClassDefsSection.add(ClassDefsSection.java:123)
Android Dex: [POF] at com.android.dx.dex.file.DexFile.add(DexFile.java:163)
Android Dex: [POF] at com.android.dx.command.dexer.Main.processClass(Main.java:490)
Android Dex: [POF] at com.android.dx.command.dexer.Main.processFileBytes(Main.java:459) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T18:58:59.833

这似乎与我们捆绑的最新 facebook jar 相关。我正在调查它，但与此同时，这是一个没有集成 facebook 的罐子。您仍然可以使用 facebook 功能，但您需要自己包含 FB 代码

[https://s3.amazonaws.com/static.stackmob.com/sdks/android/stackmob-android-sdk-1.1.1-nofb.jar](https://s3.amazonaws.com/static.stackmob.com/sdks/android/stackmob-android-sdk-1.1.1-nofb.jar)

# java - 在 Java 中实现自动完成

> ID：14838846
> 
> 赞同：1
> 
> 时间：2013-02-12T18:03:01.977
> 
> 标签：java, search, autocomplete

![在此处输入图像描述](../Images/1bea14eeaf5da6dd4cd894c16eeb9671.png)

我正在使用 Wea​​ther Underground 在 Java 中创建一个天气应用程序，我发现它确实有一些城市的数据。

最初，我打算使用`GeopIP`自动获取用户的位置，但由于对城市的支持有限，我决定让用户在每次程序启动时选择城市。

我希望用户能够从 Weather Underground 支持的城市中选择一个城市。用户将输入姓名，当他/她输入姓名时，可能的位置将以类似于图片中所示的方式显示。

我的问题是：

*   如何实现此**搜索**功能？

我最初的猜测是创建一个`Vector`包含所有城市名称的名称，然后使用蛮力找到匹配项并显示在 a`JPopup`或 a中`JWindow containing a JList`，但我想必须有更好的方法

## 改写：

我不明白的是我在必须使用的数据结构中保留**什么信息**？我应该手动创建一个支持的城市列表`Weather Underground`还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T18:08:57.523

看一下[Trie](http://en.wikipedia.org/wiki/Trie)数据结构（也称为数字树或前缀树）。自动补全是其有用性的最常见示例之一。

以下文章有一个很好的非常平易近人的解释：

[使用 Tries 推出您自己的自动完成解决方案。](http://v1v3kn.tumblr.com/post/18238156967/roll-your-own-autocomplete-solution-using-tries)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:21:07.300

如果你 google [autosuggestcombobox](https://www.google.de/search?q=autosuggestcombobox)你会得到一些有趣的结果：

[这个](http://code.google.com/p/javafx-demos/source/browse/trunk/javafx-demos/src/main/java/com/ezest/javafx/components/javafxcombobox/AutoSuggestComboBox.java?r=44)是用 JavaFX 编写的——我自己已经使用并扩展了它。它非常有用。使用 JavaFX “免费”获得什么：带有鼠标右键单击的上下文菜单，它是自动生成的，其中包含一些常见的“东西”，例如剪切、复制和粘贴，甚至撤消！因此，我可以推荐该解决方案。进入 JavaFX 并不难——而且我认为它比 Swing 更容易学习——而且看起来更酷！然而，这种实现有一些缺点——尤其是当布局不是左对齐时，因为它只是组合框顶部的文本字段。

好的——但如果你想坚持使用 Swing——你可能会使用[这个](http://smi-protege.stanford.edu/repos/protege/bioportal-reference-plugin/trunk/src/edu/stanford/bmir/protegex/bp/importing/AutoSuggestComboBox.java)。我自己没有使用过，但代码看起来非常简单且非常干净——我必须承认，它比 JavaFX 的实现更干净（但它有一些不错的特性）。所以 - 也许你尝试 - 并扩展它？它只是建立在`JComboBox`.

# java - Java 小程序停止工作

> ID：14838847
> 
> 赞同：1
> 
> 时间：2013-02-12T18:03:02.250
> 
> 标签：java, networking, post, applet

我的 Java Applet 有一个奇怪的问题。当我在我的计算机上本地运行它时，一切正常，但是当我将它嵌入到我的网站并转到 URL 时，它无法发送发布请求。到服务器。几周前一切正常，但从一天到另一天它都不起作用。

你知道是什么导致了这个问题吗？

# jquery - WordPress 页面上的 Modernizr 测试/YepNope

> ID：14838848
> 
> 赞同：0
> 
> 时间：2013-02-12T18:03:02.573
> 
> 标签：jquery, wordpress, modernizr, yepnope, browser-feature-detection

在过去的几个小时里，我尝试让 YepNope 和一些 Modernizr 测试正常工作，但没有任何运气。

Modernizr 加载在头部、jQuery`plugins.js`和`script.js`页面底部（按此顺序）。没什么花哨的，但很方便，因为调用的每个资源在`scripts.js`执行时都已经可用。所有脚本都正确加载，测试是唯一正在进行的脚本。

我想测试是否需要加载 polyfill 进行表单验证，所以这是测试：`Modernizr.formvalidationapi`. 当然，我确保我的构建中包含`Modernizr.addTest`了`forms-validation`非核心检测，以及 HTML5 输入类型和属性以及`Modernizr.load`，这基本上是`yepnope.js`

所以在我的`script.js`，有以下内容：

```
yepnope({
  test : Modernizr.formvalidationapi,  
  yep  : alert("yep"),
  nope : alert("nope")
}); 
```

我添加警报只是为了调试。
我在 Safari 6.0.2 和 Firefox 18.0.2 中对此进行了测试，两次都提示“是”，然后是“否”，所以我认为某处有错误。
我还尝试将代码包装在一个文档就绪包装器中，这没有任何改变。

由于 jQuery 在 Wordpress 中以无冲突模式运行，我相信（不能使用“$”，而必须使用“jQuery”），我将其包括在内以将美元符号重新映射到 jQuery：

```
(function($){})(window.jQuery); 
```

它也什么也没做。

目前我认为这与 Wordpress 自己的`wp_register_script`和有关`wp_enqueue_script`，但我不确定，因为我认为*可以*在 Wordpress 站点中使用 Modernizr 测试。

我哪里错了？

PS：我知道还有[http://wordpress.stackexchange.com](http://wordpress.stackexchange.com)，但我在这里发布了我的问题，因为我相信问题出在我的脚本中，而不是 Wordpress。如果您愿意，我当然可以在那里发布问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T22:26:10.857

好吧，我只是不停地愚蠢。而不是`Modernizr.formvalidationapi`我必须测试`Modernizr.formvalidation`以使一切正常。真是浪费时间，哈。

# makefile - 在makefile中构建多个目标

> ID：14838851
> 
> 赞同：1
> 
> 时间：2013-02-12T18:03:20.983
> 
> 标签：makefile

知道为什么这样的东西在 makefile 中不起作用吗？

```
all : $(GOAL_DB) $(GOAL)

%.d: %.cpp      
    $(CC) $(CPPFLAGS_DB) $<  > $@
%.o : %.cpp
    $(CC) $(FLAGS_DB) $< -o $@

$(GOAL_DB) : $(OFILES)
        $(CC) $(LFLAGS_DB) -o $@ $^ $(LIBS_DB)
    strip $(GOAL_DB)
    rm -f *.o *.d

%.d: %.cpp     
    $(CC) $(CPPFLAGS) $<  > $@
%.o : %.cpp
    $(CC) $(FLAGS) $< -o $@
$(GOAL) : $(OFILES)
        $(CC) $(LFLAGS) -o $@ $^ $(LIBS)
    strip $(GOAL)
    rm -f *.o *.d 
```

我只是尝试使用 make all 和 GNU make 构建两个不同的目标。

第一个目标构建良好，但它没有为另一个目标创建新的对象文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T18:33:08.100

makefile 不像按顺序执行的标准程序。您似乎已经假设出现在新目标之前的新规则将适用于该目标。不是这种情况。在开始应用规则之前，makefile 会针对变量、目标、依赖项等进行全面评估。

Make 将仅将这些 $(OFILES) 与其中一个 %.d: 目标进行匹配，这可能是它找到的第一个目标模式。

您没有为另一个目标获取新对象的原因是为了使它看起来像您正在构建同一组文件两次，从而跳过第二次构建，因为它已经完成。

一种解决方案是使用“目标特定变量”：

```
all : $(GOAL_DB) $(GOAL)

$(GOAL): BUILD_FLAGS=$(FLAGS)
$(GOAL): BUILD_CPPFLAGS=$(CPPFLAGS)
$(GOAL): BUILD_OUTDIR=./outdir
$(GOAL): $(OFILES)

$(GOAL_DB): BUILD_FLAGS=$(FLAGS_DB)
$(GOAL_DB): BUILD_CPPFLAGS=$(CPPFLAGS_DB)
$(GOAL_DB): BUILD_OUTDIR=./outdir_db
$(GOAL_DB): $(OFILES)

%.d: %.cpp      
    mkdir -p $(BUILD_OUTDIR)
    $(CC) $(BUILD_CPPFLAGS) $<  > $(BUILD_OUTDIR)/$@

%.o : %.cpp
    mkdir -p $(BUILD_OUTDIR)
    $(CC) $(BUILD_FLAGS) $< -o $(BUILD_OUTDIR)/$@ 
```

# php - php pdo 从具有多个 where 子句的多个表中进行选择

> ID：14838856
> 
> 赞同：1
> 
> 时间：2013-02-12T18:03:34.277
> 
> 标签：php, mysql, pdo

我是 PHP PDO 的新手，并将一些常规的 MySQL 查询转换为使用 PDO。

当分配的值替换 SQL 语句中的当前占位符时，下面的查询在 phpMyAdmin 中测试时效果很好。但是当我将它配置为现在与 PDO 一起工作时，它不会产生任何结果或错误。有人可以告诉我或告诉我我做错了什么吗？

有人告诉我，我不能将参数作为数组中的引用传递。

如果正确，创建解决方案并仅使用传递给变量的用户 ID 的最佳方法是什么`$uid`。谢谢。

```
<p>// For testing</p>
<pre>$uid = 1;</pre>
<p>&nbsp;</p>   
<pre>$array = array(
    ':uId' => ''.$uid.'',
    ':aId' => 'u.user_id',
    ':gID' => 'a.group_id',
    ':eID' => 'a.entry_id',
    ':pID' => 'a.permit_id'
    );</pre> 
```

// 为 qd_user_usam 表创建 sql

```
$sql = "选择 u.user_id, a.acl_id, g.group_name, e.entry_level, p.permit_level
```

```
FROM qd_users as u, qd_users_acl as a, qd_users_group as g, qd_users_entry as e, qd_users_permission as p
```

```
哪里 u.user_id = :uID
            和 a.acl_id = :aID
            和 g.group_id = :gID
            AND e.entry_id = :eID
            和 p.permit_id = :pID";
```

```
<p>try
{</p>
   <p>// Build the database PDOStatement</p>
   <pre>$_stmt = $this->_dbConn->prepare($sql);</pre>
   <pre>$_stmt->execute($array);</pre>
<pre>}
catch(PDOException $e)
{</pre>
    <pre>$this->_errorMessage .= 'Error processing user login access. <br /> Line #'.__LINE__ .' '.$e ;</pre>  
    <pre>die($this->_errorMessage);
}</pre>

<pre>$results = $_stmt->fetchAll(PDO::FETCH_ASSOC);</pre>
<pre>return $results;</pre>

<pre>$results = null;</pre>
<pre>$this->_dbConn = null;</pre> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:28:21.203

你把准备好的陈述弄错了。
Thy 不能用于表示查询中的任何值，而**只能用于动态添加数据**。

While`a.group_id`是一个列名，必须按原样编写，**没有准备好的语句**。

```
// For testing
$uid = 1;

// create the sql for qd_user_usam table
$sql = "SELECT u.user_id, a.acl_id, g.group_name, e.entry_level, p.permit_level 
        FROM qd_users as u, qd_users_acl as a, qd_users_group as 
             g, qd_users_entry as e, qd_users_permission as p 
        WHERE u.user_id = ?
        AND a.acl_id    = u.user_id
        AND g.group_id  = a.group_id
        AND e.entry_id  = a.entry_id
        AND p.permit_id = a.permit_id";
$_stmt = $this->_dbConn->prepare($sql);
$_stmt->execute(array($uid)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:30:37.427

问题是你试图`JOIN`通过将连接的列绑定为参数来隐式地编写你的 s ，这是行不通的。参数不能引用另一列；在这种情况下，它们被视为字符串。如果您像这样重写查询，它应该可以解决`JOIN`问题：

```
SELECT u.user_id, a.acl_id, g.group_name, e.entry_level, p.permit_level 
    FROM qd_users AS u
        JOIN qd_users_acl AS a ON (u.user_id = a.acl_id)
        JOIN qd_users_group AS g ON (g.group_id = a.group_id)
        JOIN qd_users_entry AS e ON (e.entry_id = a.entry_id)
        JOIN qd_users_permission AS p ON (p.permit_id = a.permit_id)
    WHERE u.user_id = :uID 
```

# css - div 的浮动内容，破坏 div（CSS 问题）

> ID：14838857
> 
> 赞同：0
> 
> 时间：2013-02-12T18:03:33.873
> 
> 标签：css

我一直在寻找答案，但似乎找不到答案。我有一个奇怪的问题，我以前从未遇到过。这是一个[链接](http://d311360.u38.hosting.digiweb.ie/)

在我的`header`，我有`div id="topHeader"`，在这个我有`div class="contentArea"`。

`topHeader`有`float`和`width`,`100%`有`background-color`, 并且有和`contentArea`的宽度`990px``margin: 0 auto;`

任何`contentArea`有浮动的东西都会破坏`contentArea`（例如，我想在顶部和底部应用填充，`contentArea`但它似乎只适用于顶部并将内容向下推。

页脚也出现同样的问题，`contentArea`使用 Firebug 可以清楚地看到，

感谢您的任何回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:08:31.120

`float: left;`从所有元素中删除`width: 100%;`.

然后在所有浮动元素`<div class="clear"> </div>` *的末尾添加 / 。*

```
.clear {
 clear: both;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:28:51.323

当您浮动元素时，父容器不会环绕在这种情况下浮动的子元素，您需要添加这样的 clearfix

```
.group:before,
.group:after {
    content: "";
    display: table;
} 
.group:after {
    clear: both;
}
.group {

} 
```

将此添加到您的 css 然后将类组添加到具有浮动子项的任何元素，此 clearfix 在所有浏览器中具有完全兼容性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T18:32:26.953

不确定这是否是您想要的，请尝试添加：`#topHeader .contentArea {overflow:hidden;}`

# php - PHP 说我未连接，JavaScript 说我已连接

> ID：14838860
> 
> 赞同：1
> 
> 时间：2013-02-12T18:03:49.533
> 
> 标签：php, facebook, facebook-javascript-sdk, facebook-php-sdk

正如标题所说，我的网站使用 Facebook PHP SDK 时遇到问题。有时我的页面会说我没有登录，但实际上我已经登录了。

我最近写了一个简短的测试用例，它打印出 JavaScript FB.getLoginStatus 响应和一个简短的 PHP 部分，它会写出我是否登录。

这是我的整个tests.php

```
<?php
// The Facebook PHP SDK v3.2.2
require_once("../facebook/facebook.php");

$config = array();
$config["appId"] = "284773564887682";
$config["secret"] = "it's a secret";

$facebook = new Facebook($config);

// Get User ID
$user = $facebook->getUser();
?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta property="fb:app_id" content="<?php echo $facebook->getAppID(); ?>" />
    <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
    <link href="/bootstrap/css/bootstrap.css" rel="stylesheet">
<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js" type="text/javascript"></script>
    <title>Rank: The Game - Test Cases</title>
</head>
<body>
    <div id="fb-root"></div>
    <script>
        window.fbAsyncInit = function() {
            FB.init({
              appId      : '<?php echo $facebook->getAppID(); ?>', // App ID
              channelUrl : '//rankthegame.net/channel.php', // Channel File
              status     : true, // check login status
              cookie     : true, // enable cookies to allow the server to access the session
              xfbml      : true  // parse XFBML
            });
            FB.getLoginStatus(function(response) {
                document.getElementById('js').innerHTML = 'JavaScript response.status is: ' + response.status;
            });
            FB.Event.subscribe('auth.login', function(response) {
                window.location.reload();
            });
            FB.Event.subscribe('auth.logout', function(response) {
                window.location.reload();
            });

            // Additional initialization code here
        };

        // Load the SDK Asynchronously
        (function(d){
            var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement('script'); js.id = id; js.async = true;
            js.src = "//connect.facebook.net/en_US/all.js";
            ref.parentNode.insertBefore(js, ref);
        }(document));
    </script>

    <div id="js">
    </div>

    <div id="php">
    <?php
    if ($user) {
        echo "PHP says we are logged in.";
    } else {
        echo "PHP says we are NOT logged in.";
    }
    ?>
    </div>
</body>
</html> 
```

有时，我也会得到这个：

![JS 已连接 - PHP 未连接](../Images/59b8ef57c7235dfa213b076214db2760.png)

所以我的问题很简单。这是怎么回事？我该如何解决？

我正在使用最新的 PHP SDK (v3.2.2)。

我目前的解决方法是，当我检测到这一点时，我会强制重新加载页面。这通常可以解决问题。

# java - Qt Jambi 构建失败（VS2010）

> ID：14838864
> 
> 赞同：0
> 
> 时间：2013-02-12T18:04:01.843
> 
> 标签：java, qt, qt-jambi, jambi

我已经在 Windows 7 上成功构建了 Qt 4.8.4，现在我正在尝试针对该版本构建 Qt Jambi。当我在 Qt Jambi 源目录中运行 ant 以启动构建时，我只得到了一部分，然后我得到以下结果

```
cl -c -nologo -Zm200 -Zc:wchar_t- -O2 -MD -GR -EHsc -W3 -w34100 -w34189 -DUNICODE -DWIN32 -DQT_LARGEFILE_SUPPORT -DQT_QTJAMBI_IMPORT -DQT_DLL -DQT_NO_DEBUG -DQT_CORE_LIB -DQT_HAVE_MMX -DQT_HAVE_3DNOW -DQT_HAVE_SSE -DQT_HAVE_MMXEXT -DQT_HAVE_SSE2 -DQT_THREAD_SUPPORT -I"..\..\qt-everywhere-opensource-src-4.8.4\include\QtCore" -I"..\..\qt-everywhere-opensource-src-4.8.4\include" -I"..\qtjambi" -I"..\common" -I"C:\Program Files\Java\jdk1.7.0_09\include" -I"C:\Program Files\Java\jdk1.7.0_09\include\win32" -I"." -I"..\..\qt-everywhere-opensource-src-4.8.4\include\ActiveQt" -I"release" -I"..\..\qt-everywhere-opensource-src-4.8.4\mkspecs\default" -Forelease\ @C:\Users\TYLERS~1\AppData\Local\Temp\nmFBCC.tmp qtjambishell_QLocale.cpp

..\cpp\com_trolltech_qt_core\qtjambishell_QLocale.cpp(885) : error C2084: function 'jobject Java_com_trolltech_qt_core_QLocale__1_1qt_1toCurrencyString_1int_1String__JILjava_lang_String_2(JNIEnv *,jobject,jlong,jint,jobject)' already has a body

..\cpp\com_trolltech_qt_core\qtjambishell_QLocale.cpp(808) : see previous definition of 'Java_com_trolltech_qt_core_QLocale__1_1qt_1toCurrencyString_1int_1String__JILjava_lang_String_2'

..\cpp\com_trolltech_qt_core\qtjambishell_QLocale.cpp(909) : error C2084: function 'jobject Java_com_trolltech_qt_core_QLocale__1_1qt_1toCurrencyString_1long_1String__JJLjava_lang_String_2(JNIEnv *,jobject,jlong,jlong,jobject)' already hasa body

..\cpp\com_trolltech_qt_core\qtjambishell_QLocale.cpp(832) : see previous definition of 'Java_com_trolltech_qt_core_QLocale__1_1qt_1toCurrencyString_1long_1String__JJLjava_lang_String_2'

..\cpp\com_trolltech_qt_core\qtjambishell_QLocale.cpp(933) : error C2084: function 'jobject Java_com_trolltech_qt_core_QLocale__1_1qt_1toCurrencyString_1char_1String__JCLjava_lang_String_2(JNIEnv *,jobject,jlong,jchar,jobject)' already has a body

..\cpp\com_trolltech_qt_core\qtjambishell_QLocale.cpp(856) : see previous definition of 'Java_com_trolltech_qt_core_QLocale__1_1qt_1toCurrencyString_1char_1String__JCLjava_lang_String_2'

NMAKE : fatal error U1077: '"C:\Program Files\Microsoft Visual Studio 10.0\VC\BIN\cl.EXE"' : return code '0x2'
Stop.
NMAKE : fatal error U1077: '"C:\Program Files\Microsoft Visual Studio 10.0\VC\BIN\nmake.exe"' : return code '0x2'
Stop.
NMAKE : fatal error U1077: 'cd' : return code '0x2'
Stop. 
```

有一些关于这个错误号的 MSDN 条目- [http://msdn.microsoft.com/en-us/library/dt309377.aspx](http://msdn.microsoft.com/en-us/library/dt309377.aspx)和[http://msdn.microsoft.com/en-us/library/s99zy1dh( v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/s99zy1dh(v=vs.100).aspx)。这些都没有太大帮助。

有没有人成功地完成了我正在尝试的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T11:51:18.147

已在 gitorious 成功从 QtJambi 主干编译 QtJambi。然后我使用了来自 Qt-project.org 的 Qt 4.8.4 SDK。[http://download.qt-project.org/official_releases/qt/4.8/4.8.5/qt-win-opensource-4.8.5-vs2010.exe](http://download.qt-project.org/official_releases/qt/4.8/4.8.5/qt-win-opensource-4.8.5-vs2010.exe) 我用了几个月了，效果很好:)。

享受 QtJambi！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:58:47.203

在 VS2010 上构建 QtJambi 确实有效。

请确认您从哪里获得 Qt SDK 以及您从哪里获得 QtJambi 源代码。

您应该使用诺基亚或 Digia SDK 或 Qt 项目。例如来自[https://qt-project.org/downloads](https://qt-project.org/downloads)的 4.x （注意 5.x 目前可能在 2014 年初不起作用）。

您应该在[https://qt.gitorious.org/qt-jambi/qtjambi-community](https://qt.gitorious.org/qt-jambi/qtjambi-community)的 git 树上工作（这是唯一维护的树）。请确认您正在使用的提交 ID。

如果您没有用于 Win7 的 git，请在安装后查看[http://git-scm.com/download/win](http://git-scm.com/download/win)，您可以打开“git bash”外壳并从干净的目录中检查源代码`git clone git://gitorious.org/qt-jambi/qtjambi-community.git`

您能否使用 VS2010 提供的开始菜单选项确认您已在 Win7 上正确启动了 cmd.exe shell。例如`Visual Studio 2010 Command Prompt`，从这里确认您已设置环境变量 JAVA_HOME（指向您的 JDK）和 QTSDK（指向包含 MS2010 桌面构建的 Qt SDK 顶级目录）。

我的猜测是您没有使用正确的 Qt Jambi 源代码树。自 2011 年 12 月以来，树中已存在一个补丁以支持 4.8.x。这似乎解决了您遇到的问题。

# animation - 非常简单的 flex 动画不沿 x 轴移动

> ID：14838865
> 
> 赞同：0
> 
> 时间：2013-02-12T18:04:03.490
> 
> 标签：animation, flex4, mxml

我正在尝试在 MXML 中使用 Animate 沿 X 或 Y 轴移动按钮。单击时我的按钮会增加宽度，但根本不会移动。这段代码有什么问题？它应该很简单，但我找不到。

```
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:mx="library://ns.adobe.com/flex/mx" 
    xmlns:s="library://ns.adobe.com/flex/spark"
    initialize='init()'>

    <fx:Script>
        <![CDATA[
            public function init():void {}
        ]]>
    </fx:Script>

    <s:layout>
        <s:VerticalLayout id='l' horizontalAlign="left" />
    </s:layout>

    <fx:Declarations>
        <s:Animate id="mover" target="{button}" duration="1000">
            <s:SimpleMotionPath property="x" valueFrom="0" valueTo="100"/>
            <s:SimpleMotionPath property="y" valueTo="100"/>
            <s:SimpleMotionPath property="width" valueBy="20"/>
        </s:Animate>
    </fx:Declarations>  

    <s:Button id="button" click="mover.play()" label="Button"/>

</s:Application> 
```

我从 Adob​​e docs 获得了这个示例。我认为它应该与布局或类似的东西有关，但我所有改变布局的尝试，包括变成 Canvas 或其他技巧都没有改变任何东西：按钮仍然停留在同一个地方。

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T10:34:49.743

该问题是由使用`VerticalLayout`. 此布局以及`HorizontalLayout`忽略正在布局的对象的 x/y 属性。

If you remove your layout declaration altogether, it will then use the default `BasicLayout` which will honor the x/y properties and allow your animation to work.

# android - 将数据从 Android 发送到 php webservice 以验证登录

> ID：14838871
> 
> 赞同：0
> 
> 时间：2013-02-12T18:04:23.337
> 
> 标签：android, json, web-services, android-asynctask

我有一个 login.php 脚本，它将验证在 android 中输入的用户名和密码。代码如下

```
<?php

    include('dbconnect.php'); 

    $data=file_get_contents('php://input');
    $json = json_decode($data);
    $tablename = "users";

    //username and password sent from android
    $username=$json->{'username'};
    $password=$json->{'password'};

    //protecting mysql injection
    $username = stripslashes($username);
    $password = stripslashes($password);
    $username = mysql_real_escape_string($username);
    $password = mysql_real_escape_string($password);
    $password = md5($password);

    $sql = "SELECT id FROM $tablename WHERE u_username='$username' and password='$password'"; 

    //Querying the database
    $result=mysql_query($sql);

    //If found, number of rows must be 1
    if((mysql_num_rows($result))==1){

    //creating session
    session_register("$username");
    session_register("$password");

    print "success";
    }else{
    print "Incorrect details";
    }
?> 
```

我还有一个 android 类，用户将从中输入用户名和密码。代码如下。

```
 public class LoginActivity extends Activity {

   public static final String loginURI="http://.../login.php";

   @Override
   public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.login);

    buttonSubmit.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View view) {

            String userID = "";
            userID=login(editTextUsername.getText().toString(), editTextPassword.getText().toString());

            if (editTextPassword.getText().toString() != null & editTextUsername.getText().toString() != null){
                //Used to move to the Cases Activity
                Intent casesActivity = new Intent(getApplicationContext(), CasesActivity.class);
                startActivity(casesActivity);
                casesActivity.putExtra("username", userID);

            }
            else{
                //Display Toaster for error
                Toast.makeText(getApplicationContext(),"this is an error message", Toast.LENGTH_LONG).show();
            }
        }
    });

private String login(String username, String password){

    JSONObject jsonObject = new JSONObject();

    String success = "";

    HttpClient httpClient = new DefaultHttpClient();
    HttpPost httpPost = new HttpPost(loginURI);
    HttpParams httpParams = new BasicHttpParams();
    HttpConnectionParams.setConnectionTimeout(httpParams,10000);
    HttpConnectionParams.setSoTimeout(httpParams,10000);

   try {

        jsonObject.put("username", username);
        Log.i("username", jsonObject.toString());
        jsonObject.put("password", password);
        Log.i("password", jsonObject.toString());

        StringEntity stringEntity = new StringEntity(jsonObject.toString());
        stringEntity.setContentEncoding(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
        httpPost.setEntity(stringEntity);
        HttpResponse httpResponse = httpClient.execute(httpPost);

        HttpEntity entity = httpResponse.getEntity();

        if (entity != null) {
            success = EntityUtils.toString(httpResponse.getEntity());
            Log.i("success", success);
        }

    }catch (IOException e){
        Log.e("Login_Issue", e.toString());
    }catch (JSONException e) {
        e.printStackTrace();  
    }

    return success;
  }

} 
```

我收到以下错误：ERROR/AndroidRuntime(29611): FATAL EXCEPTION: main android.os.NetworkOnMainThreadException。我知道我需要另一个线程并且我正在考虑使用 AsyncTask，但我不知道将它放在此类中的哪个位置。

您能否在使用 JSON 发送和接收来自 android 的数据方面给我一些建议。

感谢您的帮助，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:20:34.790

您可以通过调用内部登录方法来使用 AsyncTask 更改代码， 并在登录成功时`doInBackground`启动下一个活动：`onPostExecute`

```
private class LoginOperation extends AsyncTask<String, Void, String> {

String str_username=;
String str_password=;

     public LoginOperation(String str_username,String str_password){
      this.str_password=  str_password;
      this.str_username=  str_username;
     }
     @Override
      protected void onPreExecute() {

       // show progress bar here
      }
      @Override
      protected String doInBackground(String... params) {
           // call login method here
         String userID=login(str_username,str_password);
         return userID;
      }      

      @Override
      protected void onPostExecute(String result) {    
         // start next Activity here
           if(result !=null){
                Intent casesActivity = new Intent(getApplicationContext(),
                                                CasesActivity.class);
                casesActivity.putExtra("username", result);
                Your_Activiy.this.startActivity(casesActivity);

               }
      } 
```

并在按钮单击时启动 LoginOperation AsyncTask：

```
buttonSubmit.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View view) {

            if (editTextPassword.getText().toString() != null 
                         & editTextUsername.getText().toString() != null){
                // start AsyncTask here
                 new LoginOperation(editTextUsername.getText().toString(),
                        editTextPassword.getText().toString()).execute("");
            }
            else{
              // your code here
            }
        }
    });

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:20:41.927

简单的答案是创建一个线程并仅在该线程中调用登录，或异步任务（您可以将其定义为一个新类，然后调用执行）。像这样：

旧代码：

```
userID=login(editTextUsername.getText().toString(), editTextPassword.getText().toString()); 
```

新代码：

```
 Runnable runnable = new Runnable() {
      void run() {
         login(editTextUsername.getText().toString(), editTextPassword.getText().toString());
      }
 (new Thread(runnable)).start(); 
```

# ruby-on-rails - 成功完成 Omniauth 身份验证 Rails 后请求 Google 联系人

> ID：14838875
> 
> 赞同：1
> 
> 时间：2013-02-12T18:04:37.893
> 
> 标签：ruby-on-rails, ruby, google-api, omniauth, google-contacts-api

我无法弄清楚如何在成功验证后向 Google Contacts API 发出请求。

```
provider :google_oauth2, "key", "secret", :scope => "userinfo.profile,https://www.google.com/m8/feeds", :approval_prompt => 'auto' 
```

这成功地验证了有权访问联系人 api 的用户。

我的问题是 - 如何使用刷新令牌和其他信息提供下一个请求以实际获取联系人：

```
request.env['omniauth.auth'] 
```

我读过您需要指定特定的标头，例如 GData-Version => 3.0 但似乎无法弄清楚整个请求的外观。

谢谢！

# .net - FileSystemWatcher OnError 在 Windows 服务中不起作用

> ID：14838885
> 
> 赞同：1
> 
> 时间：2013-02-12T18:05:34.177
> 
> 标签：.net, windows-services, filesystemwatcher

我在 Windows 服务中有一个 FileSystemWatcher 对象。我将它写在一个控制台应用程序中，使用该应用程序作为我的组件的存根。

我的组件实例化 FileSystemWatcher 并设置为监视映射的驱动器。从测试存根控制台应用程序和可部署的 Windows 服务中，这对我来说非常有用。

我还将 onError 事件与 log4net 连接起来，记录一个致命级别的错误：

```
public FileSystemWatcher CreateFileWatcher()
    {
        FileSystemWatcher watcher = new FileSystemWatcher();

        try
        {
            log.Info("Configuring DPIFileWatcher");
            watcher.Filter = "*.xml";
            log.Info("DPIFileWatcher Filter set to: *.xml");
            string watcherPath = ConfigurationManager.AppSettings["InoundPath"].ToString();
            watcher.Path = watcherPath;
            log.Info(String.Format("DPIFileWatcher Path set to: {0}", watcherPath)); 

            watcher.Created += new FileSystemEventHandler(DPIWatcher_FileCreated);
            watcher.Changed += new FileSystemEventHandler(DPIWatcher_FileChanged);
            watcher.Error += new ErrorEventHandler(DPIWatcher_Error);
            watcher.EnableRaisingEvents = true;

            log.Info("DPIFileWatcher Configuration Successful.");
        }
        catch(Exception e)
        {
            log.Fatal(String.Format("Failed to configure DPIFileWatcher: {0}", e.Message));
        }

        return watcher;
    } 
```

这是我的错误事件：

```
 private void DPIWatcher_Error(object source, ErrorEventArgs e)
    {
        log.Fatal(String.Format("FileWatacher error: {0}", e.GetException().Message));
    } 
```

如果我通过拔下网卡来测试网络错误丢失，我会从控制台应用程序中收到以下日志错误：

```
FATAL   [  12] 2013-02-12 12:14:02,142 SMILLER-E6430 METHOD: DPIWatcher_Error     GenFileWatch.DPIFileWatcher- FileWatacher error: The specified network name is no longer available (C:\Development\GenFileWatch\GenFileWatch\DPIFileWatcher.cs: 447) 
```

但是从 Windows 服务中运行时，此日志错误将不起作用。

有谁知道为什么或如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T22:13:20.690

首先，您的服务是否使用有权访问您尝试监控的目录的帐户运行。99% 的时间，运行“控制台”应用程序和运行“服务”在两个不同的用户上下文下运行。如果该用户上下文无权访问该目录（或 URL 仅表示另一个用户上下文中的某些内容），我认为不会调用 OnError。

二`FileSystemWatcher`是相当不靠谱。它在大多数情况下都有效，但有时无效。它使用底层的原生函数 `` 记录在

> 当您第一次调用 ReadDirectoryChangesW 时，系统会分配一个缓冲区来存储更改信息。此缓冲区与目录句柄相关联，直到它被关闭并且其大小在其生命周期内不会改变。调用此函数之间发生的目录更改将添加到缓冲区中，然后在下一次调用中返回。如果缓冲区溢出，则丢弃缓冲区的全部内容，lpBytesReturned 参数包含零，ReadDirectoryChangesW 函数失败，错误代码为 ERROR_NOTIFY_ENUM_DIR

# php - 发送发票时获取订单地址

> ID：14838891
> 
> 赞同：0
> 
> 时间：2013-02-12T18:05:55.223
> 
> 标签：php, magento

我重写了`Mage_Core_Model_Email_Template`-class`send()`方法，以便在发送电子邮件的同时向客户发送 SMS。我不知道该怎么做是将客户信息与订单相关联。通常所有信息都作为变量插入到电子邮件模板中，但我需要在 PHP 中从提到的类中访问它。它需要是订单对象中的客户信息，例如姓名、电话等，因为可能无需在网上商店注册即可下订单（也可以获取特定订单的正确电话号码）。

任何帮助将不胜感激，我什至不知道如何从此类中获取 orderId。还希望能够在管理员视图中列出这些客户特定字段名称，以选择电话字段作为 SMS 收件人的来源，因此如果有一种方法可以输出与订单相关的所有客户特定字段名称，也很棒。

提前致谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:47:06.817

Magento 有一个事件驱动的架构，所以在这样的问题中，最好创建一个观察者来捕获事件。[如何创建观察者](http://www.magentocommerce.com/wiki/5_-_modules_and_development/0_-_module_development_in_magento/customizing_magento_using_event-observer_method)在您的情况下，此事件是“sales_order_invoice_register”。为此，您需要在模块的配置中，例如。`app/code/local/Stack/Test/etc/config.xml`：

```
 <events>
        <sales_order_invoice_register>
            <observers>
                <stacktest>
                    <type>singleton</type>
                    <class>stacktest/observer</class>
                    <method>sendSMS</method>
                </stacktest>
            </observers>
        </sales_order_invoice_register>
    </events> 
```

在你的观察者中，它是`app/code/local/Stack/Test/Model/Observer.php`：

```
class Stack_Test_Model_Observer extends Mage_Core_Model_Observer
{
public function sendSMS($observer)
{
    #get the customer
    $order = $observer->getEvent()->getOrder();

    Mage::log($order->getBillingAddress());
    Mage::log($order->getShippingAddress())
    Mage::log($order->getCustomerEmail());
    Mage::log($order->getCustomerFirstname());
    Mage::log($order->getCustomerLastname());
    ... 
```

你可以像这样获取所有数据，直接从 Observer 类发送短信，无需重写`send`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:50:50.860

如果您要覆盖该`send`函数，您可以使用它的参数`$variables`，一个数组，其中包含一个`order`对象（`$variables['order']`）等数据。这适用于订单电子邮件、发票、装运和 creditmemo 电子邮件。

这使我的“注册订单”的建议变得多余。

* * *

首先想到的是捕获下订单时调度的事件，并将订单对象从事件保存到 Magento 注册表中。然后，您可以从覆盖的`send`函数中获取该注册表项。假设 SMS 是在提交订单的请求期间发送的，而不是稍后发送，例如从队列处理器分派 SMS 时，这应该可以工作。

所以这个想法可以这样实现：

注册观察者

```
<config>
    <!-- -->
    <global>
        <!-- -->
        <events>
            <sales_order_place_after>
                <observers>
                    <yournodename>
                        <class>YourPackage_YourModule_Model_Observer</class>
                        <method>registerOrder</method>
                    </yournodename>
                </observers>
            </sales_order_place_after>
        </events>
        <!-- -->
    </global>
    <!-- -->
</config> 
```

实现观察者

```
class YourPackage_YourModule_Model_Observer 
{
    public function registerOrder(Varien_Event_Observer $observer)
    {
        $order = $observer->getEvent()->getOrder();
        Mage::register('currentOrder', $order);
    }
} 
```

访问注册表项：

```
public function send()
    {
        $order = Mage::registry('currentOrder');
        if ($order instanceof Mage_Sales_Model_Order) {
            $address = $order->getBillingAddress();
            if (!$order->getCustomerId()) {
                //guest order
            } else  {
                $customer = Mage::getModel('customer/customer')
                    ->load($order->getCustomerId());
            }

        }

    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T09:19:38.867

我仍然说事件捕获是实用的方法，但我尊重你的观点。所以在另一种方式中，`sendMail`方法`Mage_Sales_Model_Order_Invice`包含“订单”对象作为模板参数：

```
 $mailer->setTemplateParams(array(
            'order'        => $order,
            'invoice'      => $this,
            'comment'      => $comment,
            'billing'      => $order->getBillingAddress(),
            'payment_html' => $paymentBlockHtml
        )
    ); 
```

该`mailer`对象是`Mage_Core_Model_Email_Template_Mailer`类的实例，我建议覆盖`send`该类的方法，然后您可以通过方法访问您需要的数据`$this->getTemplateParams()`，以及订单对象中的地址和客户信息，您可以在我之前的答案中找到。

# mysql - Mysql结果每小时数据

> ID：14838893
> 
> 赞同：2
> 
> 时间：2013-02-12T18:05:59.080
> 
> 标签：mysql, date, time

我正在尝试计算每小时分组的条目。我在不同的网站和这里找到了一些有用的信息：[MySQL Group By Hours](https://stackoverflow.com/questions/10429611/mysql-group-by-hours)

但结果不是我所期望的。使用以下代码，我得到：

```
SELECT   CONCAT(Hour, ':00-', Hour+1, ':00') AS Hours,
     COUNT(`usage_time`) AS `usage` FROM `usage`
  RIGHT JOIN (
                   SELECT  0 AS Hour
         UNION ALL SELECT  1 UNION ALL SELECT  2 UNION ALL SELECT  3
         UNION ALL SELECT  4 UNION ALL SELECT  5 UNION ALL SELECT  6
         UNION ALL SELECT  7 UNION ALL SELECT  8 UNION ALL SELECT  9
         UNION ALL SELECT 10 UNION ALL SELECT 11 UNION ALL SELECT 12
         UNION ALL SELECT 13 UNION ALL SELECT 14 UNION ALL SELECT 15
         UNION ALL SELECT 16 UNION ALL SELECT 17 UNION ALL SELECT 18
         UNION ALL SELECT 19 UNION ALL SELECT 20 UNION ALL SELECT 21
         UNION ALL SELECT 22 UNION ALL SELECT 23
  )      AS AllHours ON HOUR(`usage_time`) = Hour

WHERE `usage_function` LIKE 'PlayedWholeSong' AND `usage_date` = DATE_SUB(CURDATE(), INTERVAL 0 DAY) OR `usage_time` IS NULL
GROUP BY Hour
ORDER BY Hour 
```

结果：

```
Hours       usage
2:00-3:00   0
4:00-5:00   6
6:00-7:00   2
8:00-9:00   3
9:00-10:00  20
10:00-11:00 1
14:00-15:00 14
15:00-16:00 1
16:00-17:00 32
17:00-18:00 10 
```

由于这些是从今天开始的条目，所以我在 19:00 之后没有任何条目。此外，我没有看到 00:00 - 01:00、03:00 - 04:00 的条目，还有其他几个条目丢失。但我确实想每 24 小时显示一个列表和结果，即使什么都没有。字符串是结果在 02:00 - 03:00 之间显示 0。我今天学到了很多关于 mysql 的知识，但没有什么能解决我的问题。

我希望你能学到一些东西，不一定是代码，一个方向会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:17:59.770

我个人更`LEFT JOIN`喜欢`RIGHT JOIN`。这样您就可以在您的`WHERE`标准中添加您的标准，`JOIN`并且不会限制您的结果。试试这个：

```
SELECT   CONCAT(Hour, ':00-', Hour+1, ':00') AS Hours,
     COUNT(`usage_time`) AS `usage` 
FROM 
   (
         SELECT  0 AS Hour
         UNION ALL SELECT  1 UNION ALL SELECT  2 UNION ALL SELECT  3
         UNION ALL SELECT  4 UNION ALL SELECT  5 UNION ALL SELECT  6
         UNION ALL SELECT  7 UNION ALL SELECT  8 UNION ALL SELECT  9
         UNION ALL SELECT 10 UNION ALL SELECT 11 UNION ALL SELECT 12
         UNION ALL SELECT 13 UNION ALL SELECT 14 UNION ALL SELECT 15
         UNION ALL SELECT 16 UNION ALL SELECT 17 UNION ALL SELECT 18
         UNION ALL SELECT 19 UNION ALL SELECT 20 UNION ALL SELECT 21
         UNION ALL SELECT 22 UNION ALL SELECT 23
  )      AS AllHours 
      LEFT JOIN `usage` ON HOUR(`usage_time`) = Hour 
           AND `usage_function` LIKE 'PlayedWholeSong' 
           AND `usage_date` = DATE_SUB(CURDATE(), INTERVAL 0 DAY) 
GROUP BY Hour
ORDER BY Hour 
```

这是一个简化的[SQL Fiddle](http://sqlfiddle.com/#!2/76c2a/1)。

祝你好运。

# google-apps-script - Google Apps 脚本在单击按钮时将电子表格中单元格的值加 1

> ID：14838900
> 
> 赞同：2
> 
> 时间：2013-02-12T18:06:14.707
> 
> 标签：google-apps-script

我正在尝试设置一个注册应用程序，它计算是，也许和没有响应的数量。有人可以告诉我如何在应用程序的电子表格中将单元格的值加 1 吗？下面是我在应用程序上用于“是”按钮的功能，我已将点击处理程序添加到应用程序。

```
function yesButton(e){
  var app = UiApp.getActiveApplication();
  var ss = SpreadsheetApp.openById('spreadsheet ID').getSheets()[0];
  var yesCount = ss.getRange("A2");
  var yesAdd = yesCount.getValues();
  var yesTotal = (yesAdd.value) + 1;
  yesTotal.setValue(yesAdd);

  return app;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:11:52.803

当您调用 时`getValues()`，您将获得一个二维数组。这是这样引用的。`yesAdd[row#][col#]`. 相反，您应该使用`getValue()`仅返回单个值（不在数组中）的函数。

只需将一行更改为

```
var yesAdd = yesCount.getValue(); 
```

然后写回您从中读取它的单元格。

```
yesCount.setValue(yesAdd+1); 
```

`yesCount`仍然是指您要编辑的单元格，因此我们在该单元格上设置值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-10T14:03:37.427

刚刚使用它，它工作得很好，想要一个简单的加减脚本与一些不可见的按钮一起使用，它可以工作。

我只是将我的当前工作表分为加号和减号..

> ```
> function plus() {
> 
> var ss = SpreadsheetApp.getActiveSpreadsheet();
> 
> var yesCount = ss.getRange("B7");
> 
> var yesAdd = yesCount.getValue();
> 
> yesCount.setValue(yesAdd+1);
> 
> } 
> ```
> 
> .
> 
> ```
> function minus() {
> 
> var ss = SpreadsheetApp.getActiveSpreadsheet();
> 
> var yesCount = ss.getRange("B7");
> 
> var yesAdd = yesCount.getValue();
> 
> yesCount.setValue(yesAdd-1);
> 
> } 
> ```

# java - 编码拼音

> ID：14838902
> 
> 赞同：1
> 
> 时间：2013-02-12T18:06:39.220
> 
> 标签：java, encode, ansi, iso

我目前正在用java开发一个程序，我想显示中文拼音，这是我从一个遥远的网站得到的。

但是我有以下问题：中文拼音是这样显示的：`ji&#462;`
而应该这样显示：jiǎ
（我只是输入了相同的序列，除了我去掉了斜杠）。

我认为这个问题的答案非常简单，但我很难找到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:30:27.017

问题是您有一个 HTML 编码的 Unicode 字符，而您想要的是它的解码版本。像[commons-lang3](http://commons.apache.org/lang/)（Apache Commons 的一部分）这样的库将获取您的 HTML 编码字符串并将其解码以供 Java 显示，如下所示：

```
String decoded = StringEscapeUtils.unescapeHtml("ji&#462;"); 
```

您还可以像这样在 Java 中转义 Unicode 字符：

```
String jia = "ji\u01ce"; 
```

这个巧妙[的单行](https://stackoverflow.com/a/2220476/16959)将采用 Unicode 字符并向您显示其转义形式：

```
System.out.println( "\\u" + Integer.toHexString('ǎ' | 0x10000).substring(1) ); 
```

# jsf-2 - 使用 JSF2 库版本控制。为什么我保留旧版本？

> ID：14838905
> 
> 赞同：0
> 
> 时间：2013-02-12T18:06:51.353
> 
> 标签：jsf-2

我从 docroot/resources/myname/1_0_1/css、js 和图像开始。当我需要更新文件时，我将 1_0_1 复制到 1_0_2 并在那里进行更改。等等。

我对正确程序的理解是否过于直白？

将 1_​​0_1 重命名为 1_0_2 等等难道不够吗？这样我就不会得到一长串旧版本？当然，如果我需要返回，我有源代码控制。

# ios - 使用私有方法使代码尽可能模块化

> ID：14838907
> 
> 赞同：0
> 
> 时间：2013-02-12T18:06:53.940
> 
> 标签：ios, objective-c, uitableview, ios6

在我的`-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`方法中，我有此代码来返回单元格标签的 youtube 视频日期：

```
 //Video upload date
   NSString *formattedString = [[[self.videos objectAtIndex:indexPath.row] objectForKey:@"uploaded"] stringByReplacingOccurrencesOfString:@"T" withString:@""];

   formattedString = [formattedString stringByReplacingCharactersInRange:NSMakeRange(18, 5) withString:@""];

   NSDateFormatter *df = [[NSDateFormatter alloc] init];

   [df setDateFormat:@"yyyy-MM-ddHH:mm:ss"];

   NSDate *date = [df dateFromString:formattedString];

   [df setDateFormat:@"dd/MM/yyyy"];

   NSString *dateStr = [df stringFromDate:date];

   cell.date.text = dateStr; 
```

我的方法实现看起来有点乱，我想知道什么是正确的方法。我应该将此代码保留在原处还是应该为日期格式设置另一种私有方法？

假设我想做私有方法。就像是：

```
 -(NSString *)formatDateWithString:(NSString *) mystring {

      NSString *formattedString = [mystring stringByReplacingOccurrencesOfString:@"T" withString:@""];

      formattedString = [formattedString stringByReplacingCharactersInRange:NSMakeRange(18, 5) withString:@""];

      NSDateFormatter *df = [[NSDateFormatter alloc] init];

      [df setDateFormat:@"yyyy-MM-ddHH:mm:ss"];

      NSDate *date = [df dateFromString:formattedString];

      [df setDateFormat:@"dd/MM/yyyy"];

      NSString *dateStr = [df stringFromDate:date];

      return dateStr; 
      } 
```

我应该在`-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`方法中写什么？

我的私有方法的论点是，`[self.videos objectAtIndex:indexPath.row]`但我已经失去了如何调用这个方法以及在哪个实例变量上？

我需要`NSString`在我的视图类中创建一个实例变量，或者我可以在`-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`方法中启动 NSString 实例并在其上执行我的私有方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:13:02.190

一般的经验法则是，如果您打算重用逻辑，则将其放入可重用对象中。这个想法是为了防止重复。在您的情况下，您如何创建一个`DateUtils`类并将您的逻辑放在那里。创建一个类别将是另一种选择。

示例用法：

```
NSString *youtubeVideoDateStr = [DateUtils formatDateWithString:@"..."]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:12:51.260

这个问题没有真正的“正确”答案。“看起来凌乱”不是一个可量化的问题，因此无法衡量任何更改的正确性。

如果您可以证明代码将更易于维护，那么也许您可以证明重新分解它的时间是合理的。花在学习上的时间会比花在简化上的时间更多吗？

# python - 在 virtualenv 中执行 os.system('python')

> ID：14838914
> 
> 赞同：3
> 
> 时间：2013-02-12T18:07:48.627
> 
> 标签：python, virtualenv, os.system

我正在使用 a`virtualenv`来执行一个脚本，在这个脚本中我调用：

```
os.system('python anotherScript.py') 
```

我的问题是脚本是否与`virtualenv`调用者脚本相同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T18:13:55.020

很难说，但是如果你在一个激活的 virtualenv 下运行这个脚本，你应该在那个 virutla 环境下。您可以通过以下方式验证您的想法

```
#script.py
import os
os.system('which python') 
```

并从命令行

```
virtualenv newvirtualenv
source newvirtualenv/bin/activate
(newvirtualenv) user@ubuntu: python script.py 
```

你应该看到它在下面`newvirtualenv/bin/python`

通常，您希望放置一个可执行标头以使用当前环境：

```
#!/usr/bin/env python
import os
os.system('which python') 
```

这不是说使用`newvirtualenv`，而是让你更有信心，如果在脚本下执行`newvirtualenv`，它肯定会`newvirtualenv`。

如果`/usr/bin/python`在virtualenv下使用这个还是可以的。但是对于高级程序员来说，他们往往会有多个虚拟环境和多个 python 版本。所以根据他们所在的位置，他们可以根据环境变量执行脚本。只是一个小小的收获。

如果您运行`newvirtualenv/bin/python script.py`它，它将在 virtualenv 下。

只要`python`二进制文件指向 virtualenv 的版本，你就很好。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-09-30T07:03:02.623

例如使用 anaconda 管理虚拟环境，在 Pycharm IDE 中：

```
os.system('which python') # /usr/bin/python
command = 'python3 xxxx.py' 
os.system(command) # make /usr/bin/python as interpreter 
```

如果我想使用安装在某些虚拟环境中的一些模块（例如 cv2），

```
command = '/path/to/anaconda3/envs/your_env_name/bin/python3 xxxx.py' 
os.system(command) 
```

# python - 如何解析模块中的全局变量？

> ID：14838917
> 
> 赞同：3
> 
> 时间：2013-02-12T18:07:55.053
> 
> 标签：python, module, python-2.7, global-variables

我有一个脚本如下

```
from mapper import Mapper

class A(object):
    def foo(self):
        print "world"

a = A()
a.foo()
Mapper['test']() 
```

`Mapper`在文件中定义`mapper.py`：

```
Mapper = {'test': a.foo} 
```

我想在其中定义一个函数调用，该函数调用引用未在 中定义`mapper.py`但在原始代码中定义的对象。但是上面的代码给出了错误

```
NameError: name 'a' is not defined 
```

这是有道理的，因为它本身`a`没有定义`mapper.py`。但是，是否可以更改代码以让代码在主代码本身中进行名称解析，或者通过使用`globals`或其他方式？

为了解决这个问题，我可以将实现指定`mapper.py`为文本并`eval`在主代码中使用，但我想避免使用`eval`.

附加信息：

*   函数的完整定义必须在`mapper.py`
*   事先不知道实例`a`是什么，或者它是从什么类实例化的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T19:36:41.633

除非有安全漏洞`eval`，否则不能在其中使用名称`a`，`mapper.py`除非该名称在某处定义`mapper.py`或从另一个模块导入。没有办法让`mapper.py`自动和静默地访问`a`来自不同模块的值。

此外，如果您只是在示例中的字典中使用它，则将在创建字典后`a.foo`立即进行评估。它不会等到您真正调用该函数；一旦它评估`a.foo`创建字典，它就会失败，因为它不知道是什么`a`。

您可以通过将元素包装在函数中来解决第二个问题（为简洁起见，使用 lambda）：

```
Mapper = {'test': lambda: a.foo} 
```

. . . 但这仍然无济于事，除非你能以某种方式`a`在里面有空`mapper.py`。

一种可能性是`Mapper`通过“神秘”对象参数化您的对象，然后将该对象从外部传入：

```
# mapper.py
Mapper = {'test': lambda a: a.foo}

# other module
from mapper import Mapper
Mapper['test'](a)() 
```

或者，类似于建议的内容，您可以以某种方式`mgilson`“注册”该对象。这使您只需传递对象一次即可注册它，然后您不必每次调用都传递它：`a``Mapper``a`

```
# mapper.py
Mapper = {'test': lambda a: Mapper['a'].foo}

# other module
from mapper import Mapper
Mapper['a'] = a
Mapper['test']()() 
```

请注意末尾的两组括号：一组用于评估 lambda 并提取您要调用的函数，第二组用于实际调用该函数。`Mapper['a']`您可以通过使用模块级变量而不是用作参考来进行类似的处理：

```
# mapper.py
Mapper = {'test': lambda: a.foo}

# other module
import mapper
Mapper = mapper.Mapper

mapper.a = a
Mapper['test']()() 
```

请注意，这需要您`import mapper`在其他模块中设置模块变量。

您可以通过使用自定义类`Mapper`而不是常规 dict 来简化这一点，并让该类在其中做一些工作`__getitem__`以查看“已知位置”（例如，读取一些模块变量）以用作评估的基础`a`。不过，这将是一个更重的解决方案。

最重要的是，您根本不能（再次，不使用`eval`或其他此类漏洞）编写`mapper.py`使用未定义变量的代码`a`，然后`a`在另一个模块中定义一个变量并`mapper.py`自动知道这一点。某处必须有一些代码行“告诉”您希望它使用`mapper.py`什么值。`a`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:10:07.537

我不确定我是否完全遵循，但可以从任何引用 Mapper 的地方`a`“注册”它的方法：`Mapper`

```
#mapping.py
Mapper = {} 
```

进而：

```
#main.py
from mapping import Mapper

#snip
a = A()
Mapper['test'] = a.foo #put your instance method into the Mapper dict.
#snip

Mapper['test']() 
```

# java - 使用 Java 通过 FTP 上传资源文件

> ID：14838920
> 
> 赞同：0
> 
> 时间：2013-02-12T18:08:11.620
> 
> 标签：java, eclipse, resources, ftp

我正在开发一个项目（仅使用静态方法）。现在我想上传一个文件到我的 FTP 服务器。上传过程不是问题（Apache Commons）。但是我要上传的这个文件是我项目中的资源文件。

我将此项目导出到一个可运行的 JAR 文件。

现在问题一：在我的项目中，我必须在哪里存储这个资源文件才能上传它（并确保它也被导出到可运行的 JAR 中）？

问题二：如何将这个文件访问到我的 Java 程序中？

感谢您的帮助 ;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T21:34:52.197

我刚刚得到了解决方案：

```
try {
    InputStream is = new Object(){}.getClass().getResourceAsStream("/myfile.txt");
} catch (Exception e) {
    System.err.println("Something went wrong");
    e.printStackTrace();
} 
```

如果文件“myfile.txt”位于`src`我的 Eclipse 项目的源文件夹 () 中，则此方法有效。我之前忘记了前导斜线...

谢谢大家的帮助！

# wcf - 事务未传递给 WCF 服务

> ID：14838928
> 
> 赞同：2
> 
> 时间：2013-02-12T18:08:45.353
> 
> 标签：wcf, transactions

我有一个 WCF 服务，我正在尝试使其具有事务性。当我使用事务调用服务时，事务没有被使用，如果我回滚事务，我的数据库更新无论如何都会发生。

这是服务接口（我只包括我一直在测试的单一方法：

```
[ServiceContract(SessionMode=SessionMode.Required)]
public interface IUserMenuPermissionService 
{
    [OperationContract]
    [WebInvoke(Method = "POST", RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json)]
    [TransactionFlow(TransactionFlowOption.Allowed)]
    void InsertUserMenuPermission(string userId, string menuId, int permission);
} 
```

服务实现是：

```
[ServiceBehavior(InstanceContextMode = InstanceContextMode.PerSession)]
public class UserMenuPermissionService : IUserMenuPermissionService
{
    private static IUserMenuPermissionProvider _provider = new CoreDataFactory().GetUserMenuPermissionProvider();
    [OperationBehavior(TransactionScopeRequired = true, TransactionAutoComplete = false)]
    public void InsertUserMenuPermission(string userId, string menuId, int permission)
    {
        _provider.InsertUserMenuPermission(userId, menuId, permission);
    }
} 
```

实际的底层提供者并没有直接对交易做任何事情，但在这一点上，这不是我的问题，稍后会变得很清楚。

WCF 的 app.config 具有：

```
 <bindings>
      <wsHttpBinding>
          <binding name="TransactionBinding" transactionFlow="True" >
          </binding>
      </wsHttpBinding>
  </bindings>

  ...
  ...

  <service name="GEMS.Core.WCFService.UserMenuPermissionService">
    <endpoint address=""  bindingConfiguration="TransactionBinding" binding="wsHttpBinding" contract="SvcProvider.Core.WCFService.IUserMenuPermissionService">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="http://localhost/SvcProvider.WebService/SvcProvider.Core.WCFService/UserMenuPermissionService/" />
      </baseAddresses>
    </host>
  </service> 
```

客户端是一个 ASP.NET MVC Web 应用程序。它的网络配置有：

```
 <wsHttpBinding>
            <binding name="TransactionBinding" transactionFlow="true" />
        </wsHttpBinding>

        ....
        ....

        <endpoint address="http://localhost/GEMS.WebService/SvcProvider.Core.WCFService.UserMenuPermissionService.svc"
            binding="wsHttpBinding" bindingConfiguration="TransactionBinding"
            contract="UserMenuPermissionService.IUserMenuPermissionService"
            name="WsHttpBinding_IUserMenuPermissionService" /> 
```

当我从客户端调用 Web 服务时，我是在事务范围内进行的。如果我看一下`System.Transactions.Transaction.Current`，它被设置为一个有效的 System.Transactions.Transaction 并且它有一个 DistributedIdentifier 集。

但是，当我在 WCF 服务中时，System.Transactions.Transaction.Current 设置为 null。

所以看来我的交易没有传递给服务。我希望交易是可选的，但是当有交易时，显然，我希望它被使用。

我错过了一步吗？

**更新**

根据 BNL 的评论，我现在设置了 TransactionScopeRequired = true （更新了上面的代码以反映这一点）。

如果我在客户端调用没有事务范围的方法，它们似乎运行得很好（我假设服务创建了一个事务）。

如果我在客户端上创建一个事务范围并尝试调用该方法，当我第一次尝试调用它时，它会挂起大约 55 秒，然后我得到一个事务中止异常。我将事务的超时时间设置为 3 分钟（因为默认值为 1 分钟），但这在大约 55 秒时继续发生。延迟似乎在客户端，因为在实际调用 WCF 服务之前调用自动生成的客户端代理方法需要 55 秒。随后的呼叫没有 55 秒的延迟。代码如下：

```
using (TransactionScope ts = new TransactionScope(TransactionScopeOption.RequiresNew, new TimeSpan(0, 3, 0)))
{
    _userMenuPermissionManager.SetPermissions(clientCode, menuPermissions);
    ts.Complete();
} 
```

异常发生在处置中，而不是 ts.Complete() 调用中。

```
at System.Transactions.TransactionStatePromotedAborted.PromotedTransactionOutcome(InternalTransaction tx)
at System.Transactions.TransactionStatePromotedEnded.EndCommit(InternalTransaction tx)
at System.Transactions.CommittableTransaction.Commit()
at System.Transactions.TransactionScope.InternalDispose()
at System.Transactions.TransactionScope.Dispose()
at WebApp.Controllers.AdminController.SetUserMenuPermissions(String clientCode, MenuPermission[] permissions) in Controllers\\AdminController.cs:line 160 
```

正在调用该服务并将事务传递给它。根据服务跟踪日志，没有错误。一切似乎都很顺利，但最后，它收到来自客户端的中止，我猜想回滚事务。

客户端服务日志显示也没有任何异常可以解释 55 秒的延迟。

因此，虽然我走得更远（感谢 BNL），但我仍然不完全在那里。

**更新 2**

我补充说：

```
[ServiceBehavior(TransactionTimeout = "00:03:00", InstanceContextMode = InstanceContextMode.PerSession)] 
```

到服务实现，55 秒的延迟变成了 2 分 55 秒的延迟，所以看起来事务正在超时，然后服务方法被调用（使用事务），服务完成所有工作，然后客户端在最后发送一个中止。`TransactionScopes`单独中止下的后续调用立即...

**更新 3**

看来超时是由我错过的早期调用引起的，该调用没有在显式事务中发生，并且因为我没有自动提交事务，所以它挂起是因为有一个未提交的事务。我现在将所有电话都包含在交易中。第一个呼叫现在立即中止。但在服务或客户端跟踪日志中仍然没有任何问题的迹象。没有内在的例外，什么都没有。只是流产...

**更新 4**

除了 BNL 的答案，显然 using `TransactionAutoComplete = false`is BAD。除此之外，我不能真正说出为什么会出现问题，但是将其设置为 true 解决了我的问题，并且仍然允许客户端正确提交或回滚事务（我的印象并非如此`TransactionAutoComplete = true`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:30:53.727

在您的第二个代码块中，您有`TransactionScopeRequired = false`.

如果您查看本文档的备注部分，您可以确定您不会进行交易。

[http://msdn.microsoft.com/en-us/library/system.servicemodel.operationbehaviorattribute.transactionscoperequired.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.operationbehaviorattribute.transactionscoperequired.aspx)

> TransactionScopeRequired = false
> 
> 绑定许可交易流 = true
> 
> 调用者流事务 = true
> 
> 结果 = 方法在没有事务的情况下执行。

奇怪的是，如果前两列都为真但客户端没有处理事务，会发生什么情况。看起来该服务将创建一个新事务，但我不能 100% 确定这一点。

# vb.net - vb.net 加载项 Outlook 将新字段添加到 tableview

> ID：14838931
> 
> 赞同：0
> 
> 时间：2013-02-12T18:08:51.283
> 
> 标签：vb.net, add-in

我在 Outlook 的表格视图中添加一些字段时遇到问题。

我想自定义收件箱文件夹视图。

我以编程方式添加了一些字段，例如接收、抄送。

这是我的代码：

```
tblView.ViewFields.Add("To")
tblView.ViewFields.Add("Cc")
tblView.ViewFields.Add("Received")
tblView.Save()
tblView.Apply() 
```

但它不起作用。我不知道如何解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T09:46:46.510

当表视图已经包含要添加的字段时，outlook 会出错。因此，为了使其工作，必须检查该字段是否已经存在：

```
<System.Runtime.CompilerServices.Extension()>
Public Shared Function AddField(theView As Outlook.TableView, fieldName As String) As Outlook.ViewField
    Dim theField As Outlook.ViewField = Nothing
    Try
        theField = theView.ViewFields(fieldName)
    Catch ex As Exception
    End Try
    If theField Is Nothing Then
        theField = theView.ViewFields.Add(fieldName)
    End If
    Return theField
End Function 
```

然后可以添加字段：

```
tblView.AddViewField("To")
tblView.AddViewField("Cc")
tblView.AddViewField("Received")
tblView.Save()
tblView.Apply() 
```

# mysql - 恢复默认 MySQL 状态，如事务但全局。

> ID：14838935
> 
> 赞同：1
> 
> 时间：2013-02-12T18:09:05.740
> 
> 标签：mysql, testing, transactions, rollback

我正在尝试为基于 API 的服务构建一个测试环境。理想情况下，我希望每个测试都从一个默认数据库开始。

让这件事变得有趣的是，我想通过 API 触发写入、读取和更新，这将像任何其他正常的日子一样访问数据库。我只是想确定回滚这些更改的最佳方法。我知道事务，但那些似乎依赖于连接，由于 Web 应用程序的性质，我不能保证每个操作都会使用相同的连接。

我在这方面的第一次尝试可能涉及每次都导入整个数据库。我知道这会奏效，但它可能会很慢。

交易似乎可以工作，但我对以这种方式使用它们相对较新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:18:07.743

如果您确实需要验证测试数据是否已写入数据库，则不是您要查找的事务。您将永远无法看到尚未提交的事务。

如果您这样做是为了对代码进行单元测试，并且您实际上不需要验证写入数据库中的数据，那么您应该创建一个数据库模拟来使用而不是真正的数据库。如果您需要实际验证数据库写入，并且如果您知道每个测试只会更改数据库中的几个表，那么您可能想要做的一件事是让 SQL 可用于删除/创建/填充关注的表，以便您可以在每次测试执行之前执行此操作，而不必处理 mysqldump 的完整导入。

我之前合作过的一位测试人员采用了类似的方法，在他的测试数据库中包含模板表，并在每次测试运行之前复制每个适用的表（使用`CREATE TABLE test_table LIKE template_table`and `INSERT INTO test_table SELECT * FROM template_table`），然后在每次测试的拆卸阶段删除测试表。

# ios - 如何强制具有自定义扩展名的文本文件在 myApp 中打开，而不是在 Safari 中显示为文本

> ID：14838938
> 
> 赞同：3
> 
> 时间：2013-02-12T18:09:28.737
> 
> 标签：ios, objective-c, safari, webkit, mime

我想听听您对以下情况的可行解决方案的想法/建议：

*   有一个外部网络服务可以为 iPad 用户提供我选择/设计的自定义格式文件，这些文件可以通过用户 iPad 上的 Safari 浏览器下载。

*   浏览器不会打开这个文件，而是调用 myApp 来读取它并使用它的内容（uuid 代码用它的值启动它的内部进程）

我已经研究过了，现在我知道如何注册“myApp”来处理 iOS 级别的自定义文件扩展名。只要文件不是文本文件，它就可以正常工作（即，如果它是真正的二进制文件，我会得到“在 myapp 中打开”提示）

一旦文件被 Safari 识别为文本文件，其内容就会显示在页面上，并且用户没有机会像使用具有相同扩展名的二进制文件那样“在 myApp 中打开”。

感谢任何想法/建议让我走上正轨。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T06:26:02.853

这在 /etc/apache2/httpd.conf 中对我有用

```
<IfModule headers_module>
  <FilesMatch ".custom$">
    Header Set Content-type application/myApp
    Header Set Pragma public
    Header Set Expires 0
    Header Set Cache-Control private
  </FilesMatch>
</IfModule> 
```

关键是设置 Content-type，因为 Content-Disposition 在 iOS 上的 Safari 中被忽略。归功于亚伦。（对不起，我忘记了你的全名，因为另一个答案和你的评论一起被删除了）。如果您添加答案，我将切换到它。谢谢你。

# android - android的风格问题

> ID：14838939
> 
> 赞同：0
> 
> 时间：2013-02-12T18:09:27.850
> 
> 标签：android, android-layout

我正在学习 Android 编程，但是做一个练习我遇到了问题。

Excersice 是我需要做的是使用样式，所以我更新`res/values/style.xml`文件：

```
<resources>  
    <style name="ButtonStyle" >
    <item name="android:layout_width" >fill_parent</item>
    <item name="android:layout_height" >wrap_content</item>
    <item name="android:textColor" >#ffffff</item>
    <item name="android:gravity" >center</item>
    <item name="android:textStyle" >bold</item>
    <item name="android:shadowColor" >#000000</item>
    </style>
</resources> 
```

我用以下内容更新主文件：

```
 <Button
        android:id="@+id/button2"
        android:text="@string/Arrancar" 
        android:style="@style/ButtonStyle" /> 
```

但我得到错误：

`No resource identifier found attribute 'style' in package 'Android'.`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:10:51.923

从您的属性中删除`android:`前缀：`style`

```
<Button
    android:id="@+id/button2"
    android:text="@string/Arrancar" 
    style="@style/ButtonStyle" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:14:17.740

样式没有android前缀......你需要这样使用

```
style="@style/ButtonStyle" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-12T18:18:54.303

删除 Android 前缀.....style 属性没有 android 前缀使用这个

```
 style="@style/ButtonStyle" 
```

# ios - 等待多个异步任务完成

> ID：14838940
> 
> 赞同：0
> 
> 时间：2013-02-12T18:09:31.413
> 
> 标签：ios

我喜欢在应用获取新闻和视频时显示加载消息。目前，我有以下代码：

```
 [MBProgressHUD showHUDAddedTo:self.view animated:YES];
    dispatch_async(dispatch_get_global_queue( DISPATCH_QUEUE_PRIORITY_LOW, 0), ^{

        [self loadVersion];
        [self loadFeaturedNews];
        [self loadFeaturedVideo];

        dispatch_async(dispatch_get_main_queue(), ^{

            [MBProgressHUD hideHUDForView:self.view animated:YES];

            [self dismissViewControllerAnimated:NO completion:nil];

        });
    }); 
```

我想关闭控制器并仅在加载所有任务（新闻、视频）时隐藏进度视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:48:36.863

如果您使用的是 AFNetworking，您可能需要查看[`enqueueBatchOfHTTPRequestOperations`](http://afnetworking.github.com/AFNetworking/Classes/AFHTTPClient.html#//api/name/enqueueBatchOfHTTPRequestOperations:progressBlock:completionBlock:). 我建议您参考[AFNetworking 常见问题解答](https://github.com/AFNetworking/AFNetworking/wiki/AFNetworking-FAQ)：

> **如何在处理一组请求之前等待它们完成？**
> 
> 使用 [ `enqueueBatchOfHTTPRequestOperationsWithRequests`] 或 [ `enqueueBatchOfHTTPRequestOperations`] 将一系列请求一起批处理，指定所有请求完成时的回调。如关于等待完成块完成的问题中所述，您可能不想在每个单独的操作上设置完成块，而是直接在批处理完成块中访问响应对象属性。

* * *

我收集到`loadVersion`,`loadFeaturedNews`和`loadFeaturedVideo`方法都是异步下载内容。如果您使用的是`NSURLConnection`，我建议您将它们更改为同步操作。解决方案的具体细节将根据您当前在这些例程中下载内容的方式而有所不同，例如，如果您正在使用`NSURLConnection`方法`initWithRequest`，您可以使用[`sendSynchronousRequest`](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html#//apple_ref/doc/uid/20001697-BAJHAHGI).

就个人而言，我倾向于将其与同时执行请求与调度组或`NSOperationQueue`依赖项结合起来，但首先要关注让它们同步运行。我实际上会使用`NSOperationQueue`，所以我可以轻松地将并发操作的数量限制为四个，或者类似的东西。

顺便说一句，我根本不建议您更改问题中的代码。保持那个`dispatch_async`。我建议您自己修复`loadVersion`、`loadFeaturedNews`和`loadFeaturedVideo`方法，使其同步运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:12:01.947

然后为此使用完成处理程序。因为您可以编写要在完成后执行的代码

```
completion:^ (BOOL finished) {

    } 
```

# javascript - 如何使用 onclick 事件处理程序识别元素

> ID：14838943
> 
> 赞同：0
> 
> 时间：2013-02-12T18:09:51.367
> 
> 标签：javascript

我想将元素的 ID 发送给函数以了解按下它的按钮。

```
<input type="submit" id="foo" onclick="function(abcxyz)" value="abc" />
<input type="submit" id="foo" onclick="function(xyz)" value="x" />

function(str){
    if(str == abcxyz){
        //do this.
    }
    else if(str == xyz){
        //do that.
    }
} 
```

或者如果可能的话，可以将值 abc 或 x 发送到函数。所以**str = abc**或**str = x。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:21:21.323

如果我正确理解了您的问题...

1.  您缺少函数名称
2.  两个输入具有相同的 id
3.  在您的情况下，使用 submit 类型没有意义
4.  此任务不需要输入的值

    ```
    <input type="button" id="foo1" onclick="button_click('1')" />
    <input type="button" id="foo2" onclick="button_click('2')" />`

    function button_click(str){
        if(str == '1'){
            alert('Button with id foo1 was pressed');
        }
        else if(str == '2'){
            alert('Button with id foo2 was pressed');
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:17:12.677

您可以使用在[这里找到的答案](https://stackoverflow.com/questions/4825295/javascript-onclick-to-get-the-id-of-the-clicked-button)。

基本上写

```
<input type="submit" onclick="yourFunction(this.id)" id="abc" value="Button abc" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T18:17:27.857

您的函数需要一个名称：

尝试：

```
<script type="text/javascript">
    function whichButton(str){
        if(str == 'abc'){
            alert('abc was clicked');
        }
        else if(str == 'x'){
            alert('str was clicked');
        }
    }
</script>
<input type="submit" id="foo" onclick="whichButton(this.value);" value="abc" />
<input type="submit" id="foo1" onclick="whichButton(this.value);" value="x" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T18:18:21.113

作为您的问题的解决方案，请参考下面提到的代码片段

例如

```
 <input type="submit" id="foo" onclick="function(this.value)" value="abc" />
  <input type="submit" id="foo" onclick="function(this.value)" value="x" /> 
```

在上面的代码片段中，这个对象将引用事件源，即提交按钮

# python - 如何按条件删除列？

> ID：14838945
> 
> 赞同：3
> 
> 时间：2013-02-12T18:09:58.207
> 
> 标签：python, pandas

假设这`df`是一个熊猫`DataFrame`对象。

> 如何删除`df`仅包含`None`空字符串或仅空白字符串的所有列？

丢弃的标准可以表示为`True`当输入以下测试函数时所有值都产生的那些列：

```
lambda x: (x is None) or not re.match('\S', str(x)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T22:02:23.740

您可以使用[`applymap`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.applymap.html#pandas.DataFrame.applymap)将您的功能应用于以下元素`DataFrame`：

```
In [19]: df = pd.DataFrame({'a': [None] * 4, 'b': list('abc') + [' '],
                            'c': [None] + list('bcd'), 'd': range(7, 11),
                            'e': [' '] * 4})

In [20]: df
Out[20]: 
      a  b     c   d  e
0  None  a  None   7   
1  None  b     b   8   
2  None  c     c   9   
3  None        d  10   

In [21]: to_drop = df.applymap(
                     lambda x: (x is None) or not re.match('\S', str(x))).all()

In [22]: df.drop(df.columns[to_drop], axis=1)
Out[22]: 
   b     c   d
0  a  None   7
1  b     b   8
2  c     c   9
3        d  10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T20:52:23.640

我基本上已经在下面弄清楚了，但我对 Python 中的 RegEx 还不太熟悉。这是我将采取的基本方法：

虚拟数据：

```
In [1]: df
Out[1]:
      a  b  c
0  None     1
1     b     2
2     c  x  3
3     d     4
4     e  z  5

In [2]: df.to_dict()
Out[2]:
{'a': {0: None, 1: 'b', 2: 'c', 3: 'd', 4: 'e'},
 'b': {0: ' ', 1: ' ', 2: 'x', 3: ' ', 4: 'z'},
 'c': {0: 1, 1: 2, 2: 3, 3: 4, 4: 5}} 
```

对要删除的条件应用 lambda 测试：

```
In [3]: df.apply(lambda x: x.isin([None,""," "]))
Out[3]:
       a      b      c
0   True   True  False
1  False   True  False
2  False  False  False
3  False   True  False
4  False  False  False 
```

调用`any()`在任何 df 列中测试 True 的方法

```
In [4]: df.apply(lambda x: x.isin([None,""," "])).any()
Out[4]:
a     True
b     True
c    False 
```

使用上面的布尔系列索引 df.columns 以获取要删除的列：

```
In [5]: drop_cols = df.columns[df.apply(lambda x: x.isin([None,""," "])).any()]

In [6]: drop_cols
Out[6]: Index([a, b], dtype=object) 
```

使用 df.drop() 方法并通过 axis=1 选项对列进行操作：

```
In [7]: df.drop(drop_cols, axis=1)
Out[7]:
   c
0  1
1  2
2  3
3  4
4  5 
```

现在，如果有更多 Pandas/RegEx 经验的人可以弄清楚那部分，我会说你有一个不错的解决方案。

# php - 来自 php://input 的未格式化文本

> ID：14838948
> 
> 赞同：0
> 
> 时间：2013-02-12T18:09:57.923
> 
> 标签：php, xml, post

我正在尝试从 php://input 中提取数据，以便可以将原始数据存储到 XMLElement 中，然后我可以对其进行排序，并将数据与我的一个数据库中的表进行比较。我也尝试过使用 $_POST 并存储它，但使用 $_POST 时遇到的问题是我没有获取字段标题，因此我无法存储数据。

我目前正在使用此代码从 http POST 中检索原始数据。

```
$PostContents = file_get_contents(php://input);
echo $PostContents; 
```

这是从该代码返回的数据。

```
xml=%3COPS%3E+%0D%0A%3CAuthentication%3E%3CSecretKey%3Ex44%3C%2FSecretKey%3E+%0D%0A%3C%2FAuthentication%3E+%0D%0A%3CAction%3EUpdate+Person+Status%3C%2FAction%3E+%0D%0A%3CUpdatePersonStatus%3E+%0D%0A%3CPerson%3E+%0D%0A%3CName%3EDavid%3C%2FOrderNumber%3E+%0D%0A%3CAge%3EShipped%3C%2FOrderStatus%3E+%0D%0A%3CAddress%3EThird+Party%3C%2FAddress%3E+%0D%0A%3CPhone%3EUPS+Grd%3C%2FPhone%3E+%0D%0A%3C%2FPerson%3E%0D%0A%3C%2FUpdatePersonStatus%3E+%0D%0A%3C%2FOPS%3E+%0D%0A 
```

这是生成该输出的内容。

```
<html> 
<body> 
<form action="http://172.16.100.116/php.php" method="post"> 
<textarea name="xml" rows="20" cols="40"><OPS> 
<Authentication><SecretKey>x44</SecretKey> </Authentication> 
<OPS> 
<Authentication><SecretKey>x44</SecretKey> 
</Authentication> 
<Action>Update Person Status</Action> 
<UpdatePersonStatus> 
<Person> 
<Name>David</Name> 
<Age>21</Age> 
<Address>123EasyStreet</Address> 
<Phone>6666666666</Phone> 
</Person>
</UpdatePersonStatus> 
</OPS> 
</textarea> 
<input type=submit> 
</form> 
</body> 
</html> 
```

（此处使用的 html 文件严格用于测试目的，通过的数据在加上标头 xml 信息中。）

所以我的问题是我需要做什么才能将数据从 ('php://input') 获取到 XML 中，以便我可以对它的信息进行排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:12:00.247

您应该使用 urldecode 并删除`xml=`

`urldecode($PostContents);`

这将是结果

```
<OPS> 
<Authentication><SecretKey>x44</SecretKey> 
</Authentication> 
<Action>Update Person Status</Action> 
<UpdatePersonStatus> 
<Person> 
<Name>David</OrderNumber> 
<Age>Shipped</OrderStatus> 
<Address>Third Party</Address> 
<Phone>UPS Grd</Phone> 
</Person>
</UpdatePersonStatus> 
</OPS> 
```

# c# - 为什么我的数据绑定 ComboBox 中出现过时数据？

> ID：14838949
> 
> 赞同：1
> 
> 时间：2013-02-12T18:10:03.857
> 
> 标签：c#, winforms, data-binding, combobox, listbox

我有一个带有 2 个数据绑定列表框和两个数据绑定组合框的表单。我正在使用类型化的数据集。控件绑定到具有以下架构和来自该[架构](http://sqlfiddle.com/#!3)的数据的一对表。一`listbox`和一`comboBox`绑定在`bar`桌子上；另一个`listbox`并`comboBox`绑定到`foo`表上。

当为 foo 触发 SelectedIndexChanged 事件时，`listBox`我得到 Bar 中 Selected Text 的当前值`listBox`和`comboBox`.

但是，当我使用 foo`comboBox`并尝试访问事件`barComboBox.SelectedText`内部时， `FooComboBox_SelectedIndexChanged`我会从中获取先前选择的值`SelectedText`而不是新值。给`BarListBox.Selected`了我当前的价值。

请注意，我使用`FooListBox`来进行选择，两个事件处理程序都按预期运行。

谁能解释这里发生了什么以及如何解决这个问题？

带有示例数据的表单屏幕截图：

![在此处输入图像描述](../Images/95ffed3fc22b5216a36a9b7217102c54.png)

数据集设计器：

![在此处输入图像描述](../Images/cbc84d2c53c238261997027919b519fc.png)

form1.cs 代码：

```
//Standard using statements and namespace info

    public partial class Form1 : Form
    {
        //Loading DataSets and initializing here

        private void FooListBox_SelectedIndexChanged(object sender, EventArgs e)
        {
            Console.WriteLine("The value in the bar ListBox is {0}", barListBox.Text);
        }

        private void FooComboBox_SelectedIndexChanged(object sender, EventArgs e)
        {
            Console.WriteLine("The value in the bar comboBox is {0}", barComboBox.Text);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T05:49:20.713

正如您解释的那样，我没有发现任何行为。

请检查此代码，请纠正我复制的代码是错误的。

我使用了 Combo Box 项目，并且 ListBox 项目从 Some webServiceMethod 作为 DataSource 添加到 FormLoad

**在 Form1.Designer.cs**

```
this.comboBox1 = new System.Windows.Forms.ComboBox();
            this.listBox1 = new System.Windows.Forms.ListBox();
            this.SuspendLayout();
            // 
            // comboBox1
            // 
            this.comboBox1.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
            this.comboBox1.FormattingEnabled = true;
            this.comboBox1.Location = new System.Drawing.Point(32, 55);
            this.comboBox1.Name = "comboBox1";
            this.comboBox1.Size = new System.Drawing.Size(188, 21);
            this.comboBox1.TabIndex = 0;
            this.comboBox1.SelectedIndexChanged += new System.EventHandler(this.comboBox1_SelectedIndexChanged);
            // 
            // listBox1
            // 
            this.listBox1.FormattingEnabled = true;
            this.listBox1.Location = new System.Drawing.Point(261, 55);
            this.listBox1.Name = "listBox1";
            this.listBox1.Size = new System.Drawing.Size(255, 95);
            this.listBox1.TabIndex = 1;
            this.listBox1.SelectedIndexChanged += new System.EventHandler(this.listBox1_SelectedIndexChanged); 
```

****在 Form1.cs 中****

```
 private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
    {
       MessageBox.Show("The value in the bar comboBox is "+ comboBox1.Text);
    }

    private void listBox1_SelectedIndexChanged(object sender, EventArgs e)
    {
        MessageBox.Show("The value in the bar comboBox is "+ listBox1.Text);
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        WebServiceRef.CM_ServiceSoapClient soapClient = new WebServiceRef.CM_ServiceSoapClient();

        comboBox1.DataSource = soapClient.GetAllCategories();

        listBox1.DataSource = soapClient.GetAllCategories();
    } 
```

我已经根据 DataSource 表单 WebService 方法更改了数据，但当您解释您的行为时，我仍然没有发现任何问题。

# php - 在链接点击时将枚举值设置为 1？

> ID：14838950
> 
> 赞同：2
> 
> 时间：2013-02-12T18:10:02.700
> 
> 标签：php, mysql

有人可以帮忙吗，我正在尝试在单击链接时在我的表 'ptb_permissions' 中更新“privellages”列（我知道它的拼写错误）。

基本上我以前做过很多其他的事情，它工作得很好，只是由于某种原因这不起作用。

当用户发送查看其图片的请求时，用户会在收件箱中收到通知。并且用户将有两个链接，一个用于批准或一个用于删除请求。

如果他们单击批准，那么这应该将枚举列“特权”从 0 更新为 1。

这是行不通的。我没有得到任何错误我只是没有发生任何事情。请有人告诉我我哪里出错了谢谢。

```
<a href="includes/approve_priv_pix.php?pix=<?php echo $pix['user_id']; ?>">Yes this is ok</a> 
```

approve_priv_pix.php 的内容；

```
<?php
require_once("session.php"); 
require_once("functions.php");
require('_config/connection.php');
approve_pix ($_GET['picture'], $_SESSION['user_id']);
header("Location: {$_SERVER['HTTP_REFERER']}");
?> 
```

mysql功能：

```
function approve_pix($picture, $user) {
                        global $connection;
            global $_SESSION;
                        $query = "UPDATE ptb_permissions
                                    SET privellages='1'
                                    WHERE id=$picture 
                                    AND to_user_id=$user";
            mysql_query($query, $connection);
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:16:37.027

`$_GET['picture']`应该`$_GET['pix']`

还要仔细检查您的`privellages`列枚举值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:16:58.103

```
<a href="includes/approve_priv_pix.php?pix=<?php echo $pix['user_id']; ?>">Yes this is ok</a> 
```

在这里你有`pix`一个键，但在approve_priv_pix.php 中你正在从`$_GET['picture']`. 假设它应该被替换为`$_GET['pix']` Also，不知道为什么你有`<?php echo $pix['user_id']; ?>`链接代码。可能它应该是这样的`<?php echo $pix['picture_id']; ?>`

此外，您的代码对 sql 注入开放。这里：

```
$query = "UPDATE ptb_permissions
          SET privellages='1'
          WHERE id=$picture 
          AND to_user_id=$user"; 
```

而不是你应该更好地做：

```
$query = "UPDATE ptb_permissions
          SET privellages='1'
          WHERE id=" .mysql_real_escape_string($picture) . "
          AND to_user_id=" .mysql_real_escape_string($user); 
```

有关 的更多详细信息[`mysql_real_escape_string`](http://www.php.net/manual/en/function.mysql-real-escape-string.php)。查看该页面顶部的警告消息。mysql 扩展已被弃用，将很快被删除。对于新项目，您最好使用 PDO 或 MySQLi 扩展。

另一个注意事项： `global $_SESSION;`根本不需要。默认情况下，它可以从 PHP 中的任何地方访问。

> 我没有收到任何错误我只是没有发生任何事情

要查看所有错误，您应该设置[`error_reporting`](http://www.php.net/manual/en/function.error-reporting.php)为 E_ALL（在您的 ini 文件中或直接在代码中）。启用此选项后，您将看到所有通知/警告/错误。

# c# - 使用命名管道向子进程发送参数

> ID：14838951
> 
> 赞同：1
> 
> 时间：2013-02-12T18:10:05.153
> 
> 标签：c#, wcf, named-pipes

我有一个父程序（服务器）和一个子程序（客户端），两者可以使用命名管道进行全双工通信：[这里](https://stackoverflow.com/questions/14833202/duplex-operation-between-two-processes-using-named-pipes-in-c-sharp)

我的实际客户端和服务器有点复杂。我的客户需要一些输入参数（对象）才能完成工作，所以我想使用我创建的管道发送这些参数。有些人提到了WCF。这是第一次听说WCF。如何通过命名管道发送我的对象？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T18:55:43.447

实际上使用 WCF 是在两个进程之间发送对象的最佳方式。即使您仍然可以使用管道和命名管道。我向您推荐[这](https://rads.stackoverflow.com/amzn/click/com/0596805489)本书以获取更多知识。

无论如何，如果您想在两个进程之间使用管道来发送和接收对象，则必须对它们进行序列化。也就是说，将要发送的对象转换为字节数组、xml 或soap 格式。网络上有大量示例展示了如何通过套接字和管道发送数据。两者都非常相似。

我建议您创建一个独立的程序集，其中包含将发送和接收的类。两个进程都必须引用该程序集。

我希望这可以帮助你。

# javascript - 克隆时 jQuery UI 复选框行为异常

> ID：14838953
> 
> 赞同：2
> 
> 时间：2013-02-12T18:10:06.280
> 
> 标签：javascript, jquery, jquery-ui

我正在尝试创建一个输入表，当您在底线的一个输入中输入文本时，该表会自动添加一个新行。在大多数情况下，它工作正常。但是，我在使用 jQuery UI 复选框按钮时遇到了一些问题。

复选框按钮应该在单击时更改其图标。这适用于原始按钮，但添加新行时出现的克隆按钮无法正常工作。

您可以[在此处的 jsfiddle](http://jsfiddle.net/Cugb6/1/)中看到它。要复制该问题，请在第三个输入中放置一些文本。您会看到出现了第四行。如果您按下第四个复选框，您会看到第三个复选框是图标发生变化的那个。错误的按钮也获得了 ui-state-focus 但实际上并没有获得焦点，这真的让我感到困惑，尽管正确的按钮确实获得了 ui-state-active 并且据我所知，似乎评估为已检查适当地。

需要明确的是，这两个复选框*没有*相同的 ID，它们的标签用于正确的复选框 - createNewRow() 函数负责处理。如果您注释掉将复选框转换为 jQuery UI 复选框的行，您将看到一切正常。如果你在 buttonSwitchCheck 函数中控制台记录 $(this).attr('id') 的值，你会看到它在那里也有正确的 ID - 如果你点击第四个按钮，它会告诉你$(this) 的 id 是“test4”，但它是“test3”（第三个按钮）使图标发生变化。

盯着这个我会发疯的，我会很感激人们能提供的任何帮助。这是代码：

```
// Turns on and off an icon as the checkbox changes from checked to unchecked.
function buttonSwitchCheck() {
    if ($(this).prop('checked') === true) {
        $(this).button("option", "icons", {
            primary: "ui-icon-circle-check"
        });
    } else {
        $(this).button("option", "icons", {
            primary: "ui-icon-circle-close"
        });
    }
}

// Add a new row at the bottom once the user starts filling out the bottom blank row.
function createNewRow() {
    // Identify the row and clone it, including the bound events.
    var row = $(this).closest("tr");
    var table = row.closest("table");
    var newRow = row.clone(true);
    // Set all values (except for buttons) to blank for the new row.
    newRow.find('.ssheet').not('.button').val('');
    // Find elements that require an ID (mostly elements with labels like checkboxes) and increment the ID.
    newRow.find('.ssheetRowId').each(function () {
        var idArr = $(this).attr('id').match(/^(.*?)([0-9]*)$/);
        var idNum = idArr[2] - 0 + 1;
        var newId = idArr[1] + idNum;
        $(this).attr('id', newId);
        $(this).siblings('label.ssheetGetRowId').attr('for', newId);
    });
    // Add the row to the table.
    newRow.appendTo(table);
    // Remove the old row's ability to create a new row.
    row.removeClass('ssheetNewRow');
    row.find(".ssheet").unbind('change', createNewRow);
}

$(document).ready(function () {
    // Activate jQuery UI checkboxes.
    $(".checkButton").button().bind('change', buttonSwitchCheck).each(buttonSwitchCheck);

    // When text is entered on the bottom row, add a new row.
    $(".ssheetNewRow").find(".ssheet").not('.checkButton').bind('change', createNewRow);
}); 
```

**编辑：**我能够找到一个解决方案，我将与年龄分享。感谢下面的“Funky Dude”，他启发了我开始沿着正确的轨道思考。

诀窍是在克隆之前销毁原始行中的 jQuery UI 按钮，然后立即为原始行和副本重新初始化它。您不需要取消绑定和重新绑定更改事件 - 只是 jQuery UI 按钮有问题。在 createNewRow 函数中：

```
row.find('.checkButton').button('destroy');
var newRow = row.clone(true);
row.find('.checkButton').add(newRow.find('.checkButton')).button().each(buttonSwitchCheck); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:19:02.253

尝试使用`.on`允许委托的较新方法，这应该有助于动态更改 DOM：

```
$(".checkButton").button().each(buttonSwitchCheck);
$("table").on("change", ".checkButton", buttonSwitchCheck); 
```

我不确定，但这可能有助于不必担心将事件绑定到特定元素。

此外，您可以将其用于文本框`change`事件：

```
$("table").on("change", ".ssheetNewRow .ssheet:not(.checkButton)", createNewRow); 
```

这是您对我的更改的小提琴：http: [//jsfiddle.net/Cugb6/3/](http://jsfiddle.net/Cugb6/3/)

它的功能没有任何不同，但对我来说，它更干净一些。我认为它会解决您的问题，但显然没有，因为`button`小部件存在问题。

有趣的是，他们似乎不“支持”克隆：[http ://bugs.jqueryui.com/ticket/7959](http://bugs.jqueryui.com/ticket/7959)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T18:26:07.433

我认为您正在使用深度克隆，它也克隆事件处理程序。在您的创建新行函数中，尝试取消绑定更改事件，然后重新绑定克隆。

# c - malloc 分配的大小取决于 RAM？

> ID：14838955
> 
> 赞同：-3
> 
> 时间：2013-02-12T18:10:07.333
> 
> 标签：c, memory-management, malloc

```
while(1){    
static int i=1;   
int *p;    
if(p=malloc(1024*1024))  //assigning 1 mb space    
printf("%d.",i++);    
else    
exit(0);    
} 
```

如果上面的程序在一个有 1GB 内存的系统和另一个有 4GB 内存的系统中运行，那么 i 的时间和值会有什么不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:11:42.760

我们不知道，因为它是一个实现细节。C 标准对此只字未提。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:28:14.593

我们无法回答这个问题，因为它不仅仅取决于系统有多少 RAM，还取决于“系统上还运行了什么”和“系统的配置是什么”。例如，如果我们`rlimit`在 Linux/Unix 系统中设置了不允许进程使用超过 256MB，那么无论系统有多少 GB 或 TB 的 RAM，都将不允许分配超过 256MB。

另外，考虑一个有 6GB 交换空间的 1GB 系统可能`i`比一个有 4GB 内存但没有交换空间的系统给你更高的价值？

除了“系统中有多少 RAM”之外，还有其他变量决定了您的应用程序可以分配多少 RAM。

# c# - 在被序列化的对象中找不到 TypeLoadExceptionHolder

> ID：14838963
> 
> 赞同：3
> 
> 时间：2013-02-12T18:10:26.130
> 
> 标签：c#

我正在尝试序列化一个大对象，这已经工作了几个月甚至几年，最近的修订导致这个错误出现在旧文件中。

重新序列化它们时，我收到一条消息，说`TypeLoadExceptionHolder`未标记为“ `Serializable`”。我在序列化调用之前立即设置了一个断点，似乎找不到任何该类型的引用。无论如何要“扫描”我要序列化的对象并查看对的引用在哪里`TypeLoadExceptionHolder`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T19:35:00.583

有许多场景可以触发这种类型的异常。一些更常见的是[这里](http://productiveonceaday.blogspot.com/2010/02/what-is-typeloadexceptionholder-and.html)和[这里](http://geekswithblogs.net/mnf/archive/2008/05/01/typeloadexceptionholder-object-can-be-inserted-during-unsuccessful-bynary-deserialization.aspx)。

（从上面的链接中总结）简而言之，当一个类型不能被序列化时，二进制序列化不会抛出异常。相反，它将不可序列化类型替换为 TypeLoadExceptionHolder 类型。除了没有很好的记录之外，使用它的原因甚至更少。

您可能会被困在手动找出您尝试序列化的对象中发生了哪些变化。具体来说，寻找：

*   命名空间更改。
*   成员名称更改。
*   成员数据类型更改。

# c# - 如果我指定基类，为什么我不能用泛型调用参数化构造函数

> ID：14838964
> 
> 赞同：2
> 
> 时间：2013-02-12T18:10:29.397
> 
> 标签：c#, .net, generics, constructor, compiler-errors

如果有以下类：

```
class A
{
    public A(int number)
    {
    }
} 
```

那为什么我不能有一个像这样的通用类：

```
class B<ParameterClass> where ParameterClass : A
{
    public B()
    {
        ParameterClass a = new ParameterClass(1);
    }
} 
```

我得到一个 CS0304 并且编译器说我没有 new() 限制，但我只想调用在 A 上定义的构造函数，因为 ParameterClass 将始终是 A 编译器可以确定 A(int number)构造函数将始终存在。我只是不明白为什么会有这个限制。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T18:12:03.590

仅仅因为构造函数声明为 on`A`并不意味着它将声明为 on `ParameterClass`。例如：

```
public class Bad : A
{
    public Bad(string x) : base(x.Length)
    {
    }
} 
```

现在我使用：

```
var b = new B<Bad>(); 
```

你希望它做什么？您编写它的方式，如果它*是*有效的，我希望它尝试调用`new Bad(1)`，这当然是无效的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T18:11:53.443

你误解了泛型。

`ParameterClass`不会一直如此`A`。
相反，它将始终是`A` **或继承的类型`A`**。

继承的类型`A`不一定具有与`A`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T18:19:27.203

您需要一个`where`子句来限制参数类型，以便您知道它将具有某些方法。您仍然无法以这种方式构造它，因为继承 A 的类可能没有这样的构造函数。

`where ParameterClass: A`在声明中将A 的实例传递给 B 的构造函数怎么样？

# windows - Windows 2008 R2 powershell 术语“Get-Disk”未被识别为 cmdlet 的名称

> ID：14838967
> 
> 赞同：5
> 
> 时间：2013-02-12T18:10:31.817
> 
> 标签：windows, powershell

使用 Get-Disk cmdlet 时出现错误

Windows 版本：Microsoft Windows Server 2008 R2 SP1 64b

Windows 2008 R2 powershell 术语“Get-Disk”未被识别为 cmdlet 的名称。我有第 3 版的 Powershell

> PS C:\Windows\system32> 获取磁盘

```
Get-Disk : The term 'Get-Disk' is not recognized as the name of a cmdlet, function, script file, or operable program. Check the spelling of the name, or if a path was 
included, verify that the path is correct and try again.
At line:1 char:1
+ Get-Disk
+ ~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (Get-Disk:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException 
```

> PS C:\Windows\system32> $PSVersionTable`

```
Name                           Value
----                           -----
WSManStackVersion              3.0
PSCompatibleVersions           {1.0, 2.0, 3.0}
SerializationVersion           1.1.0.1
BuildVersion                   6.2.9200.16398
PSVersion                      3.0
CLRVersion                     4.0.30319.1
PSRemotingProtocolVersion      2.2 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T03:59:11.570

[只是将评论合并为答案并添加了一点]

我还想`Get-Disk`在 Azure VM Server 2008 R2 上使用该命令，我安装了 PowerShell 3.0`Get-Disk`但仍然不可用，然后用谷歌搜索到这个页面。

从这个[脚本专家博客链接](http://blogs.technet.com/b/heyscriptingguy/archive/2012/10/26/use-powershell-to-create-a-bootable-usb-drive.aspx)中提到

> 注意 Windows 7 的 Windows PowerShell 3.0 版本目前不包含存储模块，因此需要 Windows 8 或 Windows Server 2012。

因此，如果您希望`Get-Disk`在 Windows Server 2008 R2 上使用，则不能。

相同的 Scripting Guy 链接还提供了可以替代使用的相关 DiskPart 命令。

```
From an elevated shell:

    DiskPart.exe
    List disk
    Select disk 1—disk 1 being the USB drive
    Clean
    Create partition primary
    Select partition 1—partition 1 being the new partition
    Active
    Format FS=NTFS 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-27T15:31:56.220

根据您的用例，请注意，您也可以在不使用 cmdlet 的情况下使用[Win32_Volume 类](http://msdn.microsoft.com/en-us/library/aa394515%28v=vs.85%29.aspx)在 powershell 中获取有关磁盘的信息。例如，您可以执行以下操作来更改驱动器号：

```
$drive = gwmi win32_volume -Filter "DriveLetter = 'F:'"
$drive.DriveLetter = "D:"
$drive.Put() 
```

# html - 希腊字体问题

> ID：14838968
> 
> 赞同：1
> 
> 时间：2013-02-12T18:10:47.383
> 
> 标签：html, fonts, iso

所以这是我的页面：[http](http://www.mysecretathens.gr/kulte_test/coming_soon.html) ://www.mysecretathens.gr/kulte_test/coming_soon.html并且希腊字体不会显示，这是为什么呢？

我使用 Open Sans，希腊语脚本，并在开头放置了一个 html iso 标记，但仍然没有希腊字符。

```
<html lang="el"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T18:16:21.063

您没有告诉您的页面使用 UTF-8。最好的方法是[发送一个 HTTP 标头](http://www.w3.org/International/O-HTTP-charset.en.php)。

```
Content-Type: text/html; charset=utf-8 
```

另一种方法是让网页说出它的编码是什么

```
<meta charset='utf-8'> 
```

请注意，Chrome 正确地猜到了它。第一种方法是首选，因为它使您的应用程序更加[干燥](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)，因为您已经必须在服务器上选择编码。

# linux - 将逐行 CSV 转换为逗号 CSV 的最简单方法

> ID：14838971
> 
> 赞同：0
> 
> 时间：2013-02-12T18:10:51.917
> 
> 标签：linux, csv

我有一个包含几十万行、单列、没有空格、没有引号、没有逗号的 CSV 文件。

```
line1
line2
line3
line4 
```

我需要将其拆分为 1 列，但每行最多包含 50 行，用逗号分隔。

所以：

```
line1,line2,line3,line4 all the way to line50
line51,line52,line53, all the way to line100
line101,line102,line103 all the way to line150 
```

直到用 CSV 完成。

我有 FFE、CSVTOOLS，我正在运行 linux，所以真的更喜欢 linux 方法。这绝对是我的头，所以请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:35:53.377

我假设您可以运行`Perl`脚本。我不能保证速度，但考虑到您提供的详细信息，它会完成工作。

```
#!/usr/bin/perl

use strict;
use warnings;

my $file = $ARGV[0];

open( my $fh, "<", $file ) or die $!;

my $cnt = 0;
while (<$fh>) {
    ++$cnt;
    if ( $cnt < 50 ) {
        $_ =~ tr/\n/,/;
        print $_;
    }
    else {
        print "$_";
        $cnt = 0;
    }
}

close($fh); 
```

您可以像`perl convert.pl file`希望它打印到标准输出一样运行它，或者也可以在 shell 中将它重定向到一个文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:36:35.557

所以你想从一个文件中读取 50 行，然后用逗号连接它们，对吗？这是我想出的（使用Python）：

```
import sys;

fd = open("foo.txt");
for i in range(3):
    for j in range(50):
        line = fd.readline().rstrip()
        if (j != 0):
            sys.stdout.write(",")
        sys.stdout.write(line)
    sys.stdout.write("\n")
fd.close() 
```

更改`3`为 50 行块的数量和`"foo.txt"`实际文件名。这写入标准输出；如果这是一个问题，您可以打开另一个文件进行写入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T19:32:32.720

在 bash 中：

```
#!/bin/bash

out_file=output.csv
line_width=50

count=0

while read line
do
  echo -n $line >> $out_file
  count=$(($count+1))

  if [ $count -lt $line_width ]
  then
    echo -n "," >> $out_file
  else
    echo "" >> $out_file
    count=0
  fi
done

# strip trailing commas
sed 's/,$//g' < $out_file > "$out_file.tmp" && mv "$out_file.tmp" $out_file
```

假设你有这个脚本`wrap.sh`，通过命令行执行：

```
$ ./wrap.sh < file.txt
```

输出将在`output.csv`.

# c# - 以 HTTPS 提供网页

> ID：14838975
> 
> 赞同：1
> 
> 时间：2013-02-12T18:11:17.020
> 
> 标签：c#, asp.net, web, https, cassini

我有一个在 Cassini Web 服务器上运行的 ASP.NET 网站。本网站不会在互联网上发布，仅用于演示目的。

现在，我想使用 HTTPS 而不是 HTTP 来提供登录页面。请问这怎么做？

我尝试将以下内容添加到 web.config 文件中，但它给了我一个错误：

```
<secureWebPages enabled="true">
    <file path="LogIn.aspx" />
  </secureWebPages> 
```

`connectionString`此代码是在标签之后插入的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T18:13:00.213

Cassini 不支持 HTTPS。

相反，您可以使用 IIS 或 IIS Express，它们都可以。

请注意，您还需要浏览器信任的证书。

# php - 使用 mkdir() 在创建的目录上允许 php rwx

> ID：14838978
> 
> 赞同：0
> 
> 时间：2013-02-12T18:11:20.937
> 
> 标签：php, linux

当我的用户“apache”创建一个目录时，我无法通过 php 上传向它添加新文件，我必须更改文件夹的权限才能使其工作。

我如何确保当用户上传文件并且文件夹由 php 自动创建时，该文件将在创建后添加到该文件夹​​中，而不会给我一个不可写的文件夹错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T18:19:37.067

尝试以下操作：

```
mkdir($newdirectory);
chmod($newdirectory, 0777); 
```

# objective-c - 与 NSTableView 自动保存功能一起使用的列标识符必须符合 NSCoding 协议：

> ID：14838985
> 
> 赞同：0
> 
> 时间：2013-02-12T18:11:45.893
> 
> 标签：objective-c, cocoa

我有一个 NSTableView，我正在尝试设置自动保存以保留列大小和排序。

在属性检查器中，我在“表格视图”下的“自动保存”字段中输入了一个值，并检查了“列信息”。

当我构建并运行应用程序时，我收到一个错误：

```
Column identifiers used with NSTableView autosave feature must conform to NSCoding protocol: (null) 
```

我是 Cocoa/Objective-C 的新手，所以我不清楚如何定义列标识符？

**更新**：我没有为标识符输入任何值，它被列为“自动”。但是，如果我在表列的标识符中输入一个字符串值，我仍然会得到相同的结果

**更新二**：手动输入值后，清理和重建似乎可以修复它。但是为什么自动标识符不起作用呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T20:35:54.250

> 手动输入值后，清理和重建似乎可以修复它。但是为什么自动标识符不起作用呢？

Interface Builder 有时在接受输入方面很不稳定。他们做了很多重新工作，将 IB 直接集成到 Xcode 4 中，这增加了许多奇怪的错误。

随着单点版本的发布，Apple 在 Xcode 4 中稳定 IB 方面做得不错。所需的清洁/重建量比以前少得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-03T00:59:37.627

在我确定每列都有一个标识符之前，我遇到了这个问题。然后它起作用了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-09T16:01:00.997

关于这个问题的答案都没有真正令人满意地回答这个问题。是的，您需要为每个`NSTableColumn`;设置一个标识符值。“自动”标识符显然不起作用（从 Xcode 7.2 开始）。但是你在哪里设置这些？该标识符不在 IB 窗格中的 Value Inspector 中，您可能希望它在其中（我在那里寻找它，然后做了一些令人头疼的事情）。相反，它位于 IB 窗格中的 Identity Inspector 上，它看起来像一份小报纸。我想`identifier`这可能是所有 nib 对象的一般属性（？），但我不记得以前需要将它用于其他任何事情，所以我从未注意到它在那里。无论如何，我正在添加这个答案，以防其他人像我一样对`identifier`可以设置的位置感到困惑......

# android - 如何在 Social Auth 共享 Android 中更新状态

> ID：14838987
> 
> 赞同：2
> 
> 时间：2013-02-12T18:11:52.253
> 
> 标签：android, facebook, twitter, share, linkedin

我正在使用 Social Auth 社交网络集成来集成 facebook、twitter 和linkedin。然而，在社交网站上发布的更新状态是编程硬编码的。

由于我是android编程的新手，有人会帮助我吗......

我需要更新状态功能的代码......例如。当我点击 facebook 时，它应该询问我要更新什么状态，然后将该消息发布到相应的社交网络中

我的代码如下

```
 package org.brickred.socialbar;

      import org.brickred.socialauth.android.DialogListener;
      import org.brickred.socialauth.android.SocialAuthError;
      import org.brickred.socialauth.android.SocialAuthAdapter;
      import org.brickred.socialauth.android.SocialAuthAdapter.Provider;

      import android.app.Activity;
      import android.os.Bundle;
      import android.util.Log;
      import android.widget.LinearLayout;
      import android.widget.TextView;
      import android.widget.Toast;

public class ShareBarActivity extends Activity {

// SocialAuth Component
SocialAuthAdapter adapter;
boolean status;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    LinearLayout bar = (LinearLayout)findViewById(R.id.linearbar);

    // Add Bar to library
    adapter = new SocialAuthAdapter(new ResponseListener());

    // Add providers
    adapter.addProvider(Provider.FACEBOOK, R.drawable.facebook);
    adapter.addProvider(Provider.TWITTER, R.drawable.twitter);
    adapter.addProvider(Provider.LINKEDIN, R.drawable.linkedin);

    adapter.enable(bar);

    // Set Size of Dialog
    adapter.setDialogSize(30,60);
}

/**
 * Listens Response from Library
 * 
 */

private final class ResponseListener implements DialogListener 
{
    public void onComplete(Bundle values) {

        // Variable to receive message status

        Log.d("ShareBar" , "Authentication Successful");

        // Get name of provider after authentication
        String providerName = values.getString(SocialAuthAdapter.PROVIDER);
        Log.d("ShareBar", "Provider Name = " + providerName);

        // Please avoid sending duplicate message. Social Media Providers block duplicate messages.
        adapter.updateStatus("test API");   

        Toast.makeText(ShareBarActivity.this, "Message posted on " + providerName, Toast.LENGTH_SHORT).show();  
     }

     public void onError(SocialAuthError error) {
        error.printStackTrace();
        Log.d("ShareBar" , error.getMessage());
     }

     public void onCancel() {
        Log.d("ShareBar" , "Authentication Cancelled");
     }

 } 
```

}

# sql - T-sql 查询检索数据的性能

> ID：14838992
> 
> 赞同：-3
> 
> 时间：2013-02-12T18:12:01.837
> 
> 标签：sql, sql-server, tsql

```
 DECLARE  @table TABLE( mnbr int,
  Pid int,
  Pname varchar(10),
  Jid int,
  Jname varchar(10))

INSERT INTO @table
VALUES(150 ,    1   ,    'Mark'   ,   8    ,'Jerry')
,(250  ,   1  ,     'Mark'   ,   8    ,  'Jerry')
,(350  ,   2   ,    'Jim'     ,    9  ,   'Luke')
,(450  ,   2   ,    'Jim'     ,    9   ,  'Luke')
,(550  ,   2   ,    'Jim'     ,    10  ,  'Jude')
,(650  ,   3   ,    'Andy'   ,   11   , 'Matt')
,(750   ,  4   ,    'Brian'   ,    21  ,  'Chris')
,(850   ,  4   ,    'Brian'   ,     7  ,    'Mac')
,(950   ,  5   ,    'Jean '   ,    21   , 'Chris') 
```

对于以上数据.....我的输出应该如下图：

```
350    2      Jim     9    Luke
450    2      Jim     9    Luke
550    2      Jim     10   Jude
750    4      Brian   21   Chris
850    4      Brian   7      Mac 
```

在 mnbr 150 和 250.... 的情况下，主要所有者标记有两个联名账户，并且在这两个联名账户上，联合所有者是 jerry。因此不应显示 Mark 的帐户。

在 mnbr 的情况下：350、450、550

Jim 有 3 个联名账户，并且这三个联名账户并非都属于同一个联名所有者。所以必须显示所有 3 个帐户。

Mnbr 650 只有一个联名账户和一个联名所有者。所以不应该显示。

我编写了以下查询，该查询返回我需要的数据。

```
SELECT  * FROM @table WHERE pname IN (
SELECT   pname FROM @table
    WHERE pname  IN (SELECT pname FROM @table GROUP BY pname,jname HAVING COUNT(*)!>1)
 GROUP BY pname HAVING COUNT(*)>1
) 
```

我想知道，我的查询会提供良好的性能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T19:04:49.330

您可以将查询稍微简化为

```
SELECT *
FROM   @table
WHERE  pname IN (SELECT   pname
                 FROM     @table
                 GROUP BY pname
                 HAVING   MAX(jid) <> MIN(jid)); 
```

这是否会表现得更好，您需要针对比您在问题中提供的数据集更大的数据集进行测试。

在这种情况下，针对更大数据集运行任一查询的更重要因素更有可能是在 pname、jname 字段或 pname、jid 字段的组合上具有索引。

假设表名称为“accounts”，一个有用的索引可能类似于：

```
CREATE NONCLUSTERED INDEX [IX_accounts_pname_jid] ON [dbo].[accounts] 
(
    [pname] ASC,
    [jid] ASC
)
WITH (PAD_INDEX  = OFF, 
      STATISTICS_NORECOMPUTE  = OFF, 
      SORT_IN_TEMPDB = OFF,
      IGNORE_DUP_KEY = OFF,
      DROP_EXISTING = OFF,
      ONLINE = OFF, 
      ALLOW_ROW_LOCKS  = ON,
      ALLOW_PAGE_LOCKS  = ON)
ON [PRIMARY] 
```

# java - Java printable 只打印一页

> ID：14838994
> 
> 赞同：0
> 
> 时间：2013-02-12T18:12:03.147
> 
> 标签：java, printing

在我正在处理的 Java 项目中，我需要使用 Java`Printable`接口向硬件打印机打印一些东西。该对象可以跨越多个页面。我已经根据[http://docs.oracle.com/javase/tutorial/2d/printing/index.html](http://docs.oracle.com/javase/tutorial/2d/printing/index.html)课程中指定的指南转换了对象。在我的代码中，我的可打印文件跨越 2 页。在该`print`方法中，我有以下代码：

```
// ...
if (pageIndex > amountOfPages) {
    return NO_SUCH_PAGE;
}
// ... 
```

其中`amountOfPages`是我的文档跨越的页数，`pageIndex`是系统在调用该`print`方法时填写的参数，表示打印机正在请求该页进行打印。在打印页面内容后，
在相同的功能中，我总是以 a 结尾，`return PAGE_EXISTS;`以防失败。`if(...)`

但是，在运行时，打印机会在第一页之后停止打印。我在每次返回之前添加了日志消息，我注意到`if`子句中的返回永远不会到达，所以打印机在收到`NO_SUCH_PAGE`信号之前就停止了。

如果我检查打印机的属性，它声称没有发生错误。我很困惑，我不明白为什么打印机在工作实际完成之前就停止了，或者为什么它认为工作在它完成之前就已经完成了。

有没有人看到可以指出这种行为原因的东西？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T02:28:04.567

当您实现 Printable 接口时，您应该实现一些逻辑来确定将打印多少页，例如： `public int numPages(Graphics g,PageFormat pf)` 如果此逻辑可能需要一些处理时间，您应该存储答案，因为 print 可能会被多次调用 - 甚至每次调用多次页。Print 可能会调用`numPages(...)` ，所以这就是为什么存储计算是个好主意。

Printable 接口要求您实现一个知道要写入每个页面的内容的打印方法：`public int print(Graphics g, PageFormat pf, int page) throws PrinterException`

如果您要打印多行文本，您可能会发现类包`org.jfree.text`很有帮助。由于 Graphics drawString 方法不会为您自动换行，因此可以节省大量时间。例如：

```
 TextBlock notesBlock = TextUtilities.createTextBlock(
              someLongString, plainFont, g2.getPaint());
        notesBlock.setLineAlignment(HorizontalAlignment.LEFT);
        notesBlock.draw(g2, indent, y, TextBlockAnchor.TOP_LEFT); 
```

我需要实现 Printable 来为对象列表生成打印机输出，其中每个对象的打印输出可能需要半页或几行。我确实从 Oracle Java 打印教程/文档中学到了我需要的大部分内容，但这很困难。计算分页符的放置位置是最具挑战性的部分，实际上需要我编写几乎与打印时完全相同的代码。如果你想从我的项目中获取一些示例代码，我可以在这里发布更多。

# java - 通用方法调用

> ID：14838998
> 
> 赞同：7
> 
> 时间：2013-02-12T18:12:32.963
> 
> 标签：java, generics, jls

我对理解这种通用方法调用有疑问：

```
object = ObjectGenerator.<T> getObject(objectName); 
```

以下是上述情况的背景：

```
class GenClass<T> {

   private T object;

   // ... some code

   public void initObject(String objectName) {
      object = ObjectGenerator.<T> getObject(objectName);
   }
}

class ObjectGenerator {

   public static <T extends Object> T getObject(String name) {
      // some code
      return someObject;
   }
} 
```

问题是在调用`<T>`之前扮演什么角色？`getObject(objectName)`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T18:24:12.860

注意：在您给出的具体示例中，`ObjectGenerator.getObject(objectName);`应该可以正常编译。

在某些情况下，类型推断机制无法解决以下事实：

```
T object;
object = ObjectGenerator.getObject(objectName); 
```

返回的类型应该是`T`. 在这种情况下，您需要通过显式指示您期望的返回类型来给编译器一点帮助。

这是一个人为的示例，您需要显式指定泛型类型：

```
class Example {
    public static <T> List<T> m1() {
        return m2(Arrays.<T> asList()); //Arrays.asList() would not compile
    }
    public static <T> List<T> m2(List<T> l) {
        return l;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T18:22:11.100

`object`可以是 T 的孩子。

当然`getObject`应该更好地定义：

```
public static <T> T getObject(Class<T> objectClass, String name) {
   return objectClass.getConstructor(String.class).newInstance(name);
   //return objectClass.getConstructor().newInstance();
} 
```

否则就不可能有类型安全的构造，因为所谓的类型擦除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-12T18:33:11.080

我在这里找到了一些东西：[https](https://stackoverflow.com/a/338906/443427) ://stackoverflow.com/a/338906/443427它可能会对你有所帮助。

从我读到的可能代表编译器必须用来计算重新调整的值类型的泛型，以传递泛型转发

请注意，这也可以正常工作（检查 ObjectGenerator 与 T 不同）：

```
public class ObjectGenerator<X> {
    public static <T extends Object> Set<T> getObject(String name) {
    // some code
    return null;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T19:47:20.853

我不完全同意接受的答案，其中说：

> 在这种情况下，您需要通过显式指示您期望的返回类型来给编译器一点帮助。

这对我来说听起来不对。据我了解泛型方法和类型推断，方括号中提供的类型并不直接指示泛型方法的返回类型。相反，类型`T`可以是与泛型方法相关联的返回类型、参数类型、局部变量类型。

`T`实际上，由于类型推断机制，我们在大多数情况下（不仅在某些情况下）不需要指定类型参数。在您的示例中，`<T>`可以`ObjectGenerator.<T> getObject(objectName)`像在大多数其他情况下一样从方法调用中安全地省略 。这是因为`T`泛型方法的类型可以很容易地从**结果被分配或返回的类型中**推断出来。换句话说，由于您`private T object`在方法调用之前声明类型`T`将被成功推断为`T`.

我的主张可以得到权威[教程](http://docs.oracle.com/javase/tutorial/java/generics/genTypeInference.html)中的以下声明的支持：

> 类型推断是 Java 编译器查看每个方法调用和相应声明以确定使调用适用的类型参数（或参数）的能力。推理算法确定参数的类型，以及分配或返回结果的类型（如果可用）。最后，推理算法试图找到适用于所有参数的最具体的类型。

关于推理如何工作的两个示例：

```
static <T> T pick(T a1, T a2) { return a2; }
Serializable s = pick("d", new ArrayList<String>()); 
```

该类型`T`是`Serializable`根据声明的受让人类型推断的。

```
public static <U> void addBox(U u, java.util.List<Box<U>> boxes) {}
BoxDemo.<Integer>addBox(Integer.valueOf(10), listOfIntegerBoxes); 
```

类型`U`是`Integer`根据传递参数的类型推断的（即`Integer.valueOf(10)`类型为`Integer`）。因此，`<Integer>`可以从上面的方法调用中安全地省略 。

总而言之，除非我们无法从泛型方法的实参类型或分配或返回结果的类型（调用方法时）推断出泛型方法的类型参数，否则我们可以安全地在方法之前省略类型说明调用。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-12T18:24:46.180

```
 object = ObjectGenerator.getObject(objectName); 
```

由于您调用的是静态方法，因此始终返回 Object 的对象。为了在代码中显式获取您用于 T 的通用对象，

```
 object = ObjectGenerator.<T> getObject(objectName); 
```

`<T>`在静态上下文中使用。对于非静态调用，不需要它。