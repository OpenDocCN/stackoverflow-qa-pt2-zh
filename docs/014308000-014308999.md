# StackOverflow 问答 14308000-14308999

# javascript - JQuery获取关于类名的多个列的索引

> ID：14308002
> 
> 赞同：3
> 
> 时间：2013-01-13T20:48:55.683
> 
> 标签：javascript, jquery

我有这样的桌子

```
<table id="myTable">
<tbody>
<tr>
    <td class="class1">aaa</td>
    <td class="class1">bbb</td>
    <td class="class1">ccc</td>

    <td class="class2">ddd</td>
    <td class="class2">eee</td>
</tr>

<tr>
    <td class="class1">fff</td>
    <td class="class1">ggg</td>
    <td class="class1">hhh</td>

    <td class="class2">iii</td>
    <td class="class2">jjj</td>
</tr>
</tbody>
</table> 
```

我想给出**类名**，并获取具有该类名的**列的索引**。
例如，我给出“2 级”并获得 3 和 4。
我试过这个。但是[index](http://api.jquery.com/index/)给了我最后一列的索引号。

```
 var indices = $("#myTable tbody tr").first().children("td.class2").index(); 
```

我需要一个包含所有索引值的数组。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T20:51:31.590

使用`.each()`.

```
var indices = [];
$("#myTable tbody tr").first().children("td.class2").each(function(){
    indices.push($(this).index());
});
// indices = [3, 4] 
```

在现代网络浏览器中，您可以使用`Array#map`.

```
var indices = $("#myTable tbody tr").first().children("td.class2").get().map(function(self){
    return $(self).index();
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-13T20:53:26.690

您可以使用`map()`和`index()`方法：

```
var indices = $("#myTable tr:first td.class2").map(function(i) {
    return $(this).index();
}).get();

console.log(indices); // [3, 4] 
```

# javascript - javascript弹出路由到错误的URI [rails]

> ID：14308005
> 
> 赞同：0
> 
> 时间：2013-01-13T20:49:07.690
> 
> 标签：javascript, ruby-on-rails, routes, link-to

我有一个 link_to 可以创建一个弹出窗口。它适用于某些页面，但是当我在其他页面上单击它时，它会转到错误的 URI。我的应用架构有问题吗？我希望所有链接都路由到

```
http://localhost:3000/microposts/361/into_it. 
```

SHARED/_feed_item.html.erb---这行代码正确路由：

```
<%= link_to "#{feed_item.votes_for} Into it!", into_it_micropost_path(feed_item.id), :onclick => "javascript:window.open('microposts/#{feed_item.id}/into_it','popup','width=350,height=300,top=315,left=200');", id: "feeditemlikes_#{feed_item.id}", remote: true %> 
```

USERS/_vote_feed_item.html.erb--- 在类似页面上它路由到

```
http://localhost:3000/users/1/microposts/361/into_it

<%= link_to "#{vote_feed_item.votes_for} Into it!", into_it_micropost_path(vote_feed_item.id), :onclick => "javascript:window.open('microposts/#{vote_feed_item.id}/into_it','popup','width=350,height=300,top=315,left=200');", id: "feeditemlikes_#{vote_feed_item.id}", remote: true %> 
```

MICROPOSTS/_micropost.html.erb---在配置文件页面上它路由到

```
http://localhost:3000/users/microposts/361/into_it

<%= link_to "#{micropost.votes_for} Into it!", into_it_micropost_path(micropost.id), :onclick => "javascript:window.open('microposts/#{micropost.id}/into_it','popup','width=350,height=300,top=315,left=200');", id: "feeditemlikes_#{micropost.id}", remote: true %> 
```

实际上，问题似乎出在 javascript 弹出代码上，有什么提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T18:00:08.647

如果我理解正确，你总是想链接到`http://localhost:3000/microposts/361/into_it`

然后你应该在你的路径前加上一个斜杠：

```
"javascript:window.open('/microposts/#{micropost.id}/into_it', ..." 
```

或者更好的是，使用 rails path helper，如下所示：

```
"javascript:window.open(#{into_it_path(micropost)}, ..." 
```

# http - CherryPy 将请求转发到另一台服务器

> ID：14308011
> 
> 赞同：1
> 
> 时间：2013-01-13T20:50:05.513
> 
> 标签：http, routing, port, cherrypy, forward

我遇到了与[这个 SO question](https://stackoverflow.com/questions/10100830/apache-forwarding-request-to-another-server)相同的问题，但使用的是 nginx 和 CherryPy。我试图允许客户端`192.168.0.4:80/otherpath`通过 GET 请求访问，运行 nginx 和 CherryPy 的主机`192.168.0.3:80/forward`在哪里。`192.168.0.3`nginx 应该执行重定向。`192.168.0.3`本地 CherryPy 应满足对所服务的所有其他 URL 的请求。

我改编了 Andrew Kloos 建议的 nginx 配置：

```
server {
  listen          80;
  server_name     192.168.0.3;
  root            /;

  location /forward {
    proxy_pass http://192.168.0.4:80/;
    proxy_set_header  X-Real-IP  $remote_addr;
  }
} 
```

它根据需要执行转发。将其他请求定向到本地 CherryPy 服务器需要什么配置，CherryPy 需要如何运行才能适应这种情况？我认为这可能与 ServerFault 问题有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:21:56.860

所以你在 Apache 后面为 CherryPy 服务？

如果是这样，试试这个...

在 httpd.conf 文件中添加了以下内容：

```
<Location /appserver/>
ProxyPass 192.168.0.3:80/forward 192.168.0.4:80/otherpath
ProxyPassReverse 192.168.0.3:80/forward 192.168.0.4:80/otherpath
</Location> 
```

您还需要 mod_proxy 模块才能使 ProxyPass 与 Apache 一起工作。

或者对于 nginx 编辑您的 nginx.conf 文件，将其添加到您的服务器部分：

```
location http://192.168.0.3:80/forward {
    proxy_pass http://192.168.0.4:80/otherpath;
} 
```

希望这可以帮助！

安德鲁

# android - ListView 崩溃应用程序

> ID：14308018
> 
> 赞同：0
> 
> 时间：2013-01-13T20:51:06.830
> 
> 标签：android, google-maps, android-listview

请，我一直在尝试将 ListView 添加到正在开发的 android 应用程序中，但是当我添加 ListView 时它总是启动然后崩溃。我需要帮助。我试过谷歌搜索寻求帮助，但没有找到。我不知道为什么它不起作用。下面是我的 MainActivity.java

```
public class MainActivity extends FragmentActivity {
  private GoogleMap maap;
  static final String[] OptionS = new String[]{"for 1","for 2","for 3","for 4"};
  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ListView listView= (ListView) findViewById(R.id.listView1);

    listView.setOnItemClickListener(new OnItemClickListener() {
      public void onItemClick(AdapterView<?> parent, View view,
                              int position, long id) {
        // When clicked, show a toast with the TextView text
        Toast.makeText(getApplicationContext(),
                       ((TextView) view).getText(), Toast.LENGTH_SHORT).show();
      }
    });

    setContentView(R.layout.activity_main);
    getActionBar().setDisplayHomeAsUpEnabled(true);
    GooglePlayServicesUtil.isGooglePlayServicesAvailable(getApplicationContext());
    maap = ((SupportMapFragment)      getSupportFragmentManager().findFragmentById(R.id.map))
      .getMap();
    maap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
    maap.getUiSettings().setMyLocationButtonEnabled(true);
    maap.getUiSettings().setAllGesturesEnabled(true);
    CameraPosition Position =new CameraPosition.Builder()
      .target(new LatLng(33.53,10.08))
      .zoom(7.2f)
      .tilt(40)   
      .build();

    CameraUpdate Update = CameraUpdateFactory.newCameraPosition(Position);
    maap.moveCamera(Update);
    maap.addMarker(new MarkerOptions()
                     .position(new LatLng(33.53,10.08))
                     .title("TEST")
                     .draggable(true)
                     .snippet("is good"));
  }
  @Override
  public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.menu, menu);
    return true;
  }

  @Override
  public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
      case R.id.item1: 
        startActivity(new Intent(this, ActivityMenus.class));
      case R.id.item2: 
        startActivity(new Intent(this, ActivityMenus.class));
      case R.id.item3: 
        startActivity(new Intent(this, ActivityMenus.class));
      case R.id.item4: 
        startActivity(new Intent(this, ActivityMenus.class));
    }
    return true;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T20:56:22.960

您必须`setContentView()`在尝试使用之前致电`findViewById()`。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);  // Move me here

    ListView listView= (ListView) findViewById(R.id.listView1);
    // etc 
```

# linux - 我想了解更多关于 dma_map 和 dma_unmap

> ID：14308022
> 
> 赞同：0
> 
> 时间：2013-01-13T20:51:24.737
> 
> 标签：linux, memory-management, linux-device-driver, dma

有人可以指出我为什么需要 dma_unmap 的简单文档。请自由解释 dma_map。我是设备驱动程序的新手。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T14:42:11.357

我认为以下链接可能有用：

[http://www.kernel.org/doc/Documentation/DMA-API.txt](http://www.kernel.org/doc/Documentation/DMA-API.txt)

[http://en.wikipedia.org/wiki/Direct_memory_access](http://en.wikipedia.org/wiki/Direct_memory_access)

# android - 如何使用按钮单击从android中的xml提要打开url

> ID：14308026
> 
> 赞同：1
> 
> 时间：2013-01-13T20:51:39.700
> 
> 标签：android, parsing, listview, button, xml-parsing

我有一个 Rss 提要，已在一项活动中解析。每个项目都有一个单独的 url 附加到它。当在列表视图中单击一个项目时，它会打开另一个活动，显示我从正在解析的 xml 定义的特定文本。我在该视图中有一个按钮，我想为该项目分配 xml 文件中的 url。我唯一想不通的是如何将 url 信息字符串到该按钮。这是我正在使用的代码。

xml解析活动

```
public class AndroidXMLParsingActivity extends ListActivity {

// All static variables
static final String URL = "http://www.cpcofc.org/devoapp.xml";
// XML node keys
static final String KEY_ITEM = "item"; // parent node
static final String KEY_ID = "item";
static final String KEY_NAME = "title";
static final String KEY_COST = "description";
static final String KEY_DESC = "description";
static final String KEY_GUID = "guid";
static final String KEY_LINK = "link";

ArrayList<HashMap<String, String>> menuItems = new ArrayList<HashMap<String, String>>();

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    final ArrayList<HashMap<String, String>> menuItems = new ArrayList<HashMap<String, String>>();

    XMLParser parser = new XMLParser();
    String xml = parser.getXmlFromUrl(URL); // getting XML
    Document doc = parser.getDomElement(xml); // getting DOM element

    NodeList nl = doc.getElementsByTagName(KEY_ITEM);
    // looping through all item nodes <item>
    for (int i = 0; i < nl.getLength(); i++) {
        // creating new HashMap
        HashMap<String, String> map = new HashMap<String, String>();
        Element e = (Element) nl.item(i);
        // adding each child node to HashMap key => value
        map.put(KEY_ID, parser.getValue(e, KEY_ID));
        map.put(KEY_NAME, parser.getValue(e, KEY_NAME));
        map.put(KEY_COST, parser.getValue(e, KEY_COST));
        map.put(KEY_DESC, parser.getValue(e, KEY_DESC));
        map.put(KEY_GUID, parser.getValue(e, KEY_GUID));
        map.put(KEY_LINK, parser.getValue(e,KEY_LINK));

        // adding HashList to ArrayList
        menuItems.add(map);
    }

    // Adding menuItems to ListView
    ListAdapter adapter = new SimpleAdapter(this, menuItems,
            R.layout.list_item,
            new String[] { KEY_DESC, KEY_NAME, KEY_COST, KEY_GUID}, new int[] {
                    R.id.desciption, R.id.name, R.id.cost});

    setListAdapter(adapter);

    Collections.reverse(menuItems);

    // selecting single ListView item
    ListView lv = getListView();

    lv.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            // getting values from selected ListItem
            String name = ((TextView) view.findViewById(R.id.name)).getText().toString();
            String cost = ((TextView) view.findViewById(R.id.cost)).getText().toString();
            Uri uriUrl = Uri.parse(menuItems.get(position).get(KEY_GUID));

            // Starting new intent
            Intent in = new Intent(getApplicationContext(), SingleMenuItemActivity.class);
            in.putExtra(KEY_NAME, name);
            in.putExtra(KEY_COST, cost);
            in.putExtra(KEY_GUID, uriUrl);
            startActivity(in);

        }
    });
}
 } 
```

第二个活动，其中包含查看 url 的按钮

```
public class SingleMenuItemActivity  extends Activity {

// XML node keys
static final String KEY_NAME = "title";
static final String KEY_COST = "description";
static final String KEY_DESC = "description";
static final String KEY_GUID = "guid";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.single_list_item);

    // getting intent data
    final Intent in = getIntent();

    // Get XML values from previous intent
    String name = in.getStringExtra(KEY_NAME);
    String cost = in.getStringExtra(KEY_DESC);
    String description = in.getStringExtra(KEY_DESC);
    String uriUrl = in.getStringExtra(KEY_GUID);

    // Displaying all values on the screen
    TextView lblName = (TextView) findViewById(R.id.name_label);
    TextView lblCost = (TextView) findViewById(R.id.cost_label);
    TextView lblDesc = (TextView) findViewById(R.id.description_label);

    lblName.setText(name);
    lblCost.setText(cost);
    lblDesc.setText(description);

Button devo = (Button) findViewById(R.id.button1);
devo.setOnClickListener(new View.OnClickListener() {

    @Override
    public void onClick(View v){
        String url = "http://www.google.com";
        Intent i = new Intent(Intent.ACTION_VIEW);
        i.setData(Uri.parse(url));
        startActivity(i);

    }
});
}

} 
```

我认为我的问题在于这部分代码

```
Button devo = (Button) findViewById(R.id.button1);
devo.setOnClickListener(new View.OnClickListener() {

    @Override
    public void onClick(View v){
        String url = "http://www.google.com";
        Intent i = new Intent(Intent.ACTION_VIEW);
        i.setData(Uri.parse(url));
        startActivity(i); 
```

但我不知道该放什么

```
String url = "what do i put here???"; 
```

将前一屏幕中单击的项目的 url 字符串化

这是第一个屏幕的样子，它将 xml 解析为列表视图

![在此处输入图像描述](../Images/48c482e98599e11396ee1b0ef051f87a.png)

这是单击列表视图中的项目时发生的情况

![在此处输入图像描述](../Images/f0794361ff5b7813518e1998f3e82261.png)

原木猫

```
01-13 15:14:31.818: E/AndroidRuntime(8665): FATAL EXCEPTION: main
01-13 15:14:31.818: E/AndroidRuntime(8665): java.lang.NullPointerException: uriString
01-13 15:14:31.818: E/AndroidRuntime(8665):     at android.net.Uri$StringUri.<init>(Uri.java:420)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at android.net.Uri$StringUri.<init>(Uri.java:410)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at  android.net.Uri.parse(Uri.java:382)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at com.androidhive.xmlparsing.SingleMenuItemActivity$1.onClick(SingleMenuItemActivity.java:51)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at android.view.View.performClick(View.java:2532)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at android.view.View$PerformClick.run(View.java:9293)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at android.os.Handler.handleCallback(Handler.java:587)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at android.os.Handler.dispatchMessage(Handler.java:92)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at android.os.Looper.loop(Looper.java:150)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at android.app.ActivityThread.main(ActivityThread.java:4263)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at java.lang.reflect.Method.invokeNative(Native Method)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at java.lang.reflect.Method.invoke(Method.java:507)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
01-13 15:14:31.818: E/AndroidRuntime(8665):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T20:57:55.630

您正在尝试将 Uri 对象传递给 Bundle，字符串表示就足够了

编辑2：

```
 lv.setOnItemClickListener(new OnItemClickListener() {

    @Override
    public void onItemClick(AdapterView<?> parent, View view,
            int position, long id) {
        // getting values from selected ListItem
        String name = ((TextView) view.findViewById(R.id.name)).getText().toString();
        String cost = ((TextView) view.findViewById(R.id.cost)).getText().toString();
        Uri uriUrl = Uri.parse(menuItems.get(position).get(KEY_GUID));

        // Starting new intent
        Intent in = new Intent(getApplicationContext(), SingleMenuItemActivity.class);
        in.putExtra(KEY_NAME, name);
        in.putExtra(KEY_COST, cost);

        // **NEED TO PASS STRING OBJECT NOT URI OBJECT**
        in.putExtra(KEY_GUID, uriUrl.toString());
        startActivity(in);

    }
}); 
```

编辑：

```
public class SingleMenuItemActivity  extends Activity {

// XML node keys
static final String KEY_NAME = "title";
static final String KEY_COST = "description";
static final String KEY_DESC = "description";
static final String KEY_GUID = "guid";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.single_list_item);

    // getting intent data
    final Intent in = getIntent();

    // Get XML values from previous intent
    String name = in.getStringExtra(KEY_NAME);
    String cost = in.getStringExtra(KEY_DESC);
    String description = in.getStringExtra(KEY_DESC);
    final String uriUrl = in.getStringExtra(KEY_GUID);

    // Displaying all values on the screen
    TextView lblName = (TextView) findViewById(R.id.name_label);
    TextView lblCost = (TextView) findViewById(R.id.cost_label);
    TextView lblDesc = (TextView) findViewById(R.id.description_label);

    lblName.setText(name);
    lblCost.setText(cost);
    lblDesc.setText(description);

Button devo = (Button) findViewById(R.id.button1);
devo.setOnClickListener(new View.OnClickListener() {

    @Override
    public void onClick(View v){
        Intent i = new Intent(Intent.ACTION_VIEW);
        i.setData(Uri.parse(uriUrl));
        startActivity(i);

    }
});
}

} 
```

**或者**

```
public class SingleMenuItemActivity  extends Activity {

// XML node keys
static final String KEY_NAME = "title";
static final String KEY_COST = "description";
static final String KEY_DESC = "description";
static final String KEY_GUID = "guid";

private String url;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.single_list_item);

    // getting intent data
    final Intent in = getIntent();

    // Get XML values from previous intent
    String name = in.getStringExtra(KEY_NAME);
    String cost = in.getStringExtra(KEY_DESC);
    String description = in.getStringExtra(KEY_DESC);
    url= in.getStringExtra(KEY_GUID);

    // Displaying all values on the screen
    TextView lblName = (TextView) findViewById(R.id.name_label);
    TextView lblCost = (TextView) findViewById(R.id.cost_label);
    TextView lblDesc = (TextView) findViewById(R.id.description_label);

    lblName.setText(name);
    lblCost.setText(cost);
    lblDesc.setText(description);

Button devo = (Button) findViewById(R.id.button1);
devo.setOnClickListener(new View.OnClickListener() {

    @Override
    public void onClick(View v){
        Intent i = new Intent(Intent.ACTION_VIEW);
        i.setData(Uri.parse(url));
        startActivity(i);

    }
});
}

} 
```

# javascript - 使用 Web Audio API 使用 OscillatorNodes 演奏和弦

> ID：14308029
> 
> 赞同：7
> 
> 时间：2013-01-13T20:51:52.323
> 
> 标签：javascript, api, web-audio-api

我想使用 OscillatorNodes 演奏和弦：

```
var ac = new (window.AudioContext || window.webkitAudioContext);
// C4, E4, G4
var freqs = [261.63, 329.63, 392.00];
for(var i=0;i<freqs.length;i++) {
  var o = ac.createOscillator();
  o.frequency.value = freqs[i];
  o.connect(ac.destination);
  o.noteOn(0);
  setTimeout(function() {o.noteOff(0)}, 1000);
} 
```

但是这种方法听起来像一团糟（[听起来是这样的](https://dl.dropbox.com/u/56227900/one_audiocontext.wav)）。如果我尝试为和弦中的每个音符创建新的 AudioContexts，那么听起来不错（[像这样](https://dl.dropbox.com/u/56227900/multiple_audiocontexts.wav)）：

```
// C4, E4, G4
var freqs = [261.63, 329.63, 392.00];
for(var i=0;i<freqs.length;i++) {
  var ac = new (window.AudioContext || window.webkitAudioContext);
  var o = ac.createOscillator();
  o.frequency.value = freqs[i];
  o.connect(ac.destination);
  o.noteOn(0);
  setTimeout(function() {o.noteOff(0)}, 1000);
} 
```

但我读到你应该只有一个 AudioContext。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-17T10:53:41.763

不确定这是否是一个解决方案，但我发现插入一个 GainNode 并设置它的值，以便增益总和为 1 消除了这个问题：

```
var ac = new (window.AudioContext || window.webkitAudioContext);
// C4, E4, G4
var freqs = [261.63, 329.63, 392.00];
for(var i=0;i<freqs.length;i++) {
  var o = ac.createOscillator();
  var g = ac.createGainNode();
  o.frequency.value = freqs[i];
  o.connect(g);
  g.gain.value = 1/freqs.length;
  g.connect(ac.destination);
  o.start(0);
  setTimeout(function(s) {s.stop(0)}, 1000, o);
} 
```

我在 Chrome 23.0.1271.101 上试过这个

更新为使用新的`start`和`stop`方法：[createOscillator noteOn not working](https://stackoverflow.com/questions/29356041/createoscillator-noteon-not-working)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-14T14:04:54.443

`noteOn(0)`立即启动振荡器/音符。

由于您的 for 循环需要时间来创建振荡器，因此在第一个音符之后的每个音符的开始时间都会稍微延迟。我会初始化每个振荡器，将它们放入一个数组中，然后`noteOn()`在另一个 for 循环中调用它们中的每一个。

而且你不需要调用setTimeout，这是不可靠的：`noteOff`将在调用后在一秒钟内执行`noteOff(1)`。

```
var ac = new (window.AudioContext || window.webkitAudioContext);
// C4, E4, G4
var freqs = [261.63, 329.63, 392.00];
var oscs = [];
// initialize the oscillators
for(var i=0;i<freqs.length;i++) {
    var o = ac.createOscillator();
    o.frequency.value = freqs[i];
    o.connect(ac.destination);
    oscs.push(o);
}
// schedule noteOn and noteOff (deprecated: the methods will be renamed to start() and   stop() soon)
for (i = 0; i < oscs.length; i +=1) {
    oscs[i].noteOn(0);
    oscs[i].noteOff(1);
} 
```

# iphone - 游戏中心邀请好友怎么解决？

> ID：14308036
> 
> 赞同：3
> 
> 时间：2013-01-13T20:52:23.757
> 
> 标签：iphone, ios, game-center, multiplayer

我正在通过游戏中心开发一款多人游戏，但遇到了一个问题。当我尝试邀请我的一位朋友时，我得到了失败的状态。我尝试过使用模拟器和 iphone 以及两部 iphone，但总是出现同样的问题。

我已经为我的问题搜索了一个解决方案，发现有很多开发人员遇到了这个问题。我正在使用 iOS 6，应用程序仍在生产中，所以它在沙盒中。

我正在使用与 Ray Wenderlich 教程 - CatRace 相同的代码（有太多人写过这个问题，但没有人发布解决方案。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T12:51:01.153

请检查：

1> 您在本地播放器通过身份验证后设置邀请处理程序。
2> 您尝试邀请的玩家确实在其帐户设置中允许游戏邀请。如果您有两个测试帐户，您可能会忘记您不允许他们两个测试帐户。在这种情况下，邀请的推送通知甚至不会发送给其他玩家。
3> 请勿使用同一个游戏中心账号进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-25T01:29:50.267

您必须发送 GK 事件来表示玩家（您）结束了他们的回合，然后 GameCenter 才会向您邀请的玩家发送推送通知邀请。

所以每个玩家的第一轮事件应该发送一个 matchData 数组，比如 [“Player1” : “Joined”]

这将迫使 GameCenter 向每个玩家发送邀请。

然后，一旦您确认每个玩家都发送了“加入”GK 事件，您就开始游戏。

[https://developer.apple.com/documentation/gamekit/gkturnbasedmatch/1520765-endturn](https://developer.apple.com/documentation/gamekit/gkturnbasedmatch/1520765-endturn)

```
func endTurn(withNextParticipants nextParticipants: [GKTurnBasedParticipant], 
 turnTimeout timeout: TimeInterval, 
       match matchData: Data, 
completionHandler: ((Error?) -> Void)? = nil) 
```

nextParticipants 是被邀请的玩家，matchData 是一个类似 [“Joined”] 的 NSArray，使用 NSKeyArchiver。调用此函数后，GameCenter 将发送推送通知来邀请玩家。

# jquery - 如何使用 removeClass() 从所有类似项目中删除类

> ID：14308038
> 
> 赞同：0
> 
> 时间：2013-01-13T20:52:48.920
> 
> 标签：jquery, html, plugins

这是我的html：

```
<dl>
<dt>Options 1</dt>
<dd>Link 1</dd>
<dd>Link 2</dd>
<dd>Link 3</dd>
<dt>Option 2</dt>
<dd>Link 4</dd>
<dd>Link 5</dd>
<dd>Link 6</dd>
</dl> 
```

我已经创建了一个插件来实现我想要的这个菜单的效果。这是我的插件：

```
(function($) {
    $.fn.Pointer = function() {
        var txt, y;
        txt = $(this);
        txt.on("click", function(event){
            y=event.pageY;
            y = y - 15;

            //animate pointer
            $('#pointer').animate({ 'top' : y + 'px'});
            //adding hover class to selected links
            txt.addClass("select_menu");
        });
    };
})( jQuery );

$("dd").each(function(){
    $(this).Pointer();
}); 
```

插件效果的快速解释。我有一个带有箭头的 div，它指向您单击的链接。每次单击时，箭头都会滑动到单击的新链接（此滑块工作正常）。我也有点击链接更改类。这是我的第一个问题。当您单击链接 1 时，将应用该类。我想要做的是单击链接 2 和应用于链接 1 的上一个类，我想清除该类并将该类应用于新单击的链接。我无法从之前点击的链接中删除课程。有人可以帮我弄这个吗？

我希望解释足够清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T20:55:45.497

根据我从您的问题中了解到的情况，您可以尝试这样的方法来删除和添加类：

```
$(".arrow").click(function(){
    $(".myClass").removeClass("myClass");
    $(this).addClass("myClass");
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-13T21:02:21.167

让插件作用于一整组项目，然后在重新应用之前从所有项目中清除类。即结构它是这样的：

```
$.fn.Pointer = function() {
  var $group = this;
  $group.on('click.Pointer', function() {
    var $link = $(this);

    $group.removeClass('select_menu')
    $link.addClass('select_menu')
  });
};

$('dd').Pointer(); 
```

无论您调用哪组元素`.Pointer()`，都只会将`.select_menu`类应用于其中的一个元素。

Codepen 示例：[http ://codepen.io/anon/pen/hidFq](http://codepen.io/anon/pen/hidFq)

# javascript - 带有部分日期变量的正则表达式

> ID：14308039
> 
> 赞同：0
> 
> 时间：2013-01-13T20:53:06.067
> 
> 标签：javascript, regex, string, search

希望构建一个执行以下操作的 reg 表达式：

如果给定格式的日期字符串：a/b/c

我需要构建一个正则表达式，如果：

1.  月 = 一个
2.  日期在 x 和 y 之间（包括两个限制）
3.  年 = c

一个例子：

日期是 3/6/12，RegExp 在以下情况下返回 true：

*   月 = 3
*   天在 2 到 6 之间（包括限制）
*   年 = 12

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:00:33.210

试试这个： `\b3/[23456]/12\b`

除非上面只是一个例子，否则你需要澄清你所追求的

# php - 将 PHP 变量传递到嵌入 Vimeo 链接的 Javascript 字符串中

> ID：14308040
> 
> 赞同：0
> 
> 时间：2013-01-13T20:53:06.537
> 
> 标签：php, javascript, video, vimeo

我正在尝试将 Wordpress 自定义字段中的 PHP 变量传递到 javascript 字符串中。自定义字段包含 Vimeo 视频的 ID 号，它需要放置在点击时替换图像的字符串的中间。这是代码：

```
jQuery("#index-image").click(function(){

    jQuery(this).replaceWith('<div id="video-container"><iframe id="videoframe" src="http://player.vimeo.com/video/"<?php echo $page_videos[$i]; ?>"color=ffffff&portrait=0&byline=0&title=0&autoplay=1&api=1&player_id=videoframe" frameborder="0" style="width: 100%;" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe></div>'); 
```

将字符串作为变量创建警报会返回带有视频 ID 号的正确字符串，但是浏览器只会生成没有 PHP 变量的字符串。

不知道该怎么办。我尝试使用变量组装字符串并将其放入 replaceWith 函数中，但在任何地方都没有运气。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T20:58:05.413

在我看来，该变量正在 src 属性之外回显。

```
 jQuery(this).replaceWith('<div id="video-container"><iframe id="videoframe" src="http://player.vimeo.com/video/<?php echo $page_videos[$i]; ?>&color=ffffff&portrait=0&byline=0&title=0&autoplay=1&api=1&player_id=videoframe" frameborder="0" style="width: 100%;" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe></div>'); 
```

# octave - GNU Octave：如何找到向量的 n 个最大元素

> ID：14308042
> 
> 赞同：4
> 
> 时间：2013-01-13T20:53:11.403
> 
> 标签：octave, vectorization, max

我在 Octave 中有这样的向量：

```
[ 4 5 1 2 3 6 ] 
```

是否有任何函数可以返回该向量的 n 个最大元素，在这种情况下，最大的三个是 6、5 和 4？

```
[6 5 4] 
```

Octave max 函数只返回一个最大元素。我想要 n 个最大元素。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T19:49:25.137

**在 GNU Octave 中，获取向量的最大 n 个元素：**

```
octave:2> X = [3 8 2 9 4]
octave:2> sort(X)

ans =
   2   3   4   8   9

octave:8> sort(X)(end-2:end)

ans =

   4   8   9 
```

**描述**

意思`sort(X)(end-2:end)`是“对向量 X 进行排序，并给我从 2 减去末尾到末尾的元素，也称为最后 3 个元素”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-13T20:55:18.957

您可以为此使用该[`sort`](http://www.mathworks.co.uk/help/matlab/ref/sort.html)功能。

# python - 是否可以暂停 python 脚本直到文件不被使用？

> ID：14308043
> 
> 赞同：2
> 
> 时间：2013-01-13T20:53:15.977
> 
> 标签：python, file, wait, pausing-execution

我有一个 python 脚本，它更新文件中的一些值。此脚本可能被超过 1 个用户使用，这意味着该文件将由多个用户更新。但是 2 个用户不应该同时更新文件。如果用户正在更新文件，则其他用户应等待第一个用户的脚本完成。是否可以检查文件是否在python中使用？如果正在使用，脚本应该等待，一旦不使用，它应该继续并更新文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T20:59:10.463

您需要某种文件锁定。

我认为[这](http://www.evanfosmark.com/2009/01/cross-platform-file-locking-support-in-python/)可以解决您的问题。

传统上，这被称为使用信号量、锁定等解决的资源共享问题。

# magento - Magento 1.7：使整个产品网格可点击

> ID：14308046
> 
> 赞同：1
> 
> 时间：2013-01-13T20:53:46.123
> 
> 标签：magento, product

我不想让我的整个productgrid 在magento 1.7 中可点击。所以不仅是图像和产品名称，还有它周围的空白区域。

有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:41:06.703

在`app/design/frontend/default/your_company/template/catalog/product`编辑`list.phtml`网格模式部分（或列表模式）下调用的文件时，您将看到一个打开的列表项，看起来像

```
<li class="item<?php if(($i - 1) % $_columnCount == 0) : ?> first<?php elseif($i % $_columnCount == 0) : ?> last<?php endif; ?>"> 
```

您可以在事件中添加`window.open`javascript 函数`onclick`，您的代码将如下所示：

```
<li class="item<?php if(($i - 1) % $_columnCount == 0) : ?> first<?php elseif($i % $_columnCount == 0) : ?> last<?php endif; ?>" onclick="window.open('<?php echo $_product->getProductUrl() ?>', '_self'); return false;"> 
```

注意：如果您希望链接在新选项卡/窗口中打开，您可以将第二个参数更改为`window.open`其他参数。[有关详细信息，请参见此处](https://developer.mozilla.org/en-US/docs/DOM/window.open)。您可能需要添加一些 CSS 以将列表项悬停更改为指针光标，例如`_blank`

```
.category-products li:hover { cursor: pointer; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:18:29.960

您可以使用 JS 和 css 完成此操作

使用 jQuery 示例（假设您使用默认的 css 类名，将此代码添加到将包含在您的产品列表页面中的 js 文件中）

```
 $(document).ready(function() {
     $('ul.products-grid').click(function(e) {
         if($j(e.target).is("img"){
             window.location.href = $(e.target).closest("li").find('a:first').attr("href");
         }
     });
 }); 
```

CSS

```
.products-grid li:hover { cursor: pointer; } 
```

示例[http://jsfiddle.net/7XR5t/2/](http://jsfiddle.net/7XR5t/2/)

# c++ - Windbg 获取 C++ 对象的大小

> ID：14308049
> 
> 赞同：0
> 
> 时间：2013-01-13T20:54:02.160
> 
> 标签：c++, windbg

对 Internet Explorer 崩溃进行一些分析。（极光利用）。假设我在 01e2fe80 有一个对象的 vftable。我知道这个对象是一个 mshtml!CImgElement。我如何找到这个对象的大小？我怎么会发现对象 mshtml!CImgElement 是 x 字节大？

```
 bp mshtml!CEventObj::GenericGetElement+0x93 ".printf \"esi = [%08x] \",esi;dds poi(esi) l1;gc"

     esi = [01e2fe80] 01e2fcd0  7dc59478 mshtml!CImgElement::`vftable' 
```

参考：

[http://dreamofareverseengineer.blogspot.de/2011/10/reversing-aurora-vulnerability-cve-2010.html](http://dreamofareverseengineer.blogspot.de/2011/10/reversing-aurora-vulnerability-cve-2010.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T10:49:26.220

[C++ 表达式中的运算符](http://msdn.microsoft.com/en-us/library/windows/hardware/ff540372%28v=vs.85%29.aspx) `sizeof(type)`返回数据类型的大小，但可能`CImgElement`包含私有数据并显示所需大小的私有信息（私有符号），这是 mshtml 模块所没有的。

```
0:021> ?? sizeof(MSHTML!CImgElement)
*************************************************************************
***                                                                   ***
***                                                                   ***
***    Your debugger is not using the correct symbols                 ***
***                                                                   ***
***    In order for this command to work properly, your symbol path   ***
***    must point to .pdb files that have full type information.      ***
***                                                                   ***
***    Certain .pdb files (such as the public OS symbols) do not      ***
***    contain the required information.  Contact the group that      ***
***    provided you with these symbols if you need this command to    ***
***    work.                                                          ***
***                                                                   ***
***    Type referenced: MSHTML!CImgElement                            ***
***                                                                   ***
*************************************************************************
Couldn't resolve error at 'MSHTML!CImgElement)' 
```

# django - Django Admin 嵌套内联

> ID：14308050
> 
> 赞同：60
> 
> 时间：2013-01-13T20:54:08.297
> 
> 标签：django, django-models, django-admin

我需要一个嵌套的 django admin 内联，我可以将日期字段内联包含在另一个内联中，如下所示。

我有以下模型：

```
class Person(models.Model):
     name = models.CharField(max_length=200)
     id_no = models.IntegerField()

class Certificate(models.Model):
     cerfificate_no = models.CharField(max_length=200)
     certificate_date = models.DateField(max_length=100)
     person = models.ForeignKey(Person)
     training = models.CharField(max_length=200)

class Training_Date(models.Model):
      date = models.DateField()
      certificate = models.ForeignKey(Certificate) 
```

和下面的管理员：

```
class CertificateInline(admin.StackedInline):
    model = Certificate

class PersonAdmin(admin.ModelAdmin):
     inlines = [CertificateInline,]
admin.site.register(Person,PersonAdmin) 
```

但我需要将 Training_Date 模型作为内联包含在内，这是证书管理内联的一部分。

任何想法 ？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-01-14T23:29:19.627

[最近https://code.djangoproject.com/ticket/9025](https://code.djangoproject.com/ticket/9025)有一些动静，但我不会屏住呼吸。

`ModelAdmin`解决此问题的一种常见方法是通过为同一模型同时具有 a 和 Inline 来链接到第一和第二（或第二和第三）级别之间的管理员：

给`Certificate`一个`ModelAdmin`with`TrainingDate`作为内联。提供`CertificateInline`一个附加字段“详细信息”，该字段是其`ModelAdmin`更改表单的链接。

模型.py：

```
from django.core import urlresolvers

class Certificate(models.Model):

    # ...

    def changeform_link(self):
        if self.id:
            # Replace "myapp" with the name of the app containing
            # your Certificate model:
            changeform_url = urlresolvers.reverse(
                'admin:myapp_certificate_change', args=(self.id,)
            )
            return u'<a href="%s" target="_blank">Details</a>' % changeform_url
        return u''
    changeform_link.allow_tags = True
    changeform_link.short_description = ''   # omit column header 
```

管理员.py：

```
# Certificate change form has training dates as inline

class TrainingDateInline(admin.StackedInline):
    model = TrainingDate

class CertificateAdmin(admin.ModelAdmin):
    inlines = [TrainingDateInline,]
admin.site.register(Certificate ,CertificateAdmin)

# Person has Certificates inline but rather
# than nesting inlines (not possible), shows a link to
# its own ModelAdmin's change form, for accessing TrainingDates:

class CertificateLinkInline(admin.TabularInline):
    model = Certificate
    # Whichever fields you want: (I usually use only a couple
    # needed to identify the entry)
    fields = ('cerfificate_no', 'certificate_date', 'changeform_link')
    readonly_fields = ('changeform_link', )

class PersonAdmin(admin.ModelAdmin):
    inlines = [CertificateLinkInline,]
admin.site.register(Person, PersonAdmin) 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-03-01T11:47:45.547

更通用的解决方案

```
from django.utils.safestring import mark_safe
from django.urls import reverse

class EditLinkToInlineObject(object):
    def edit_link(self, instance):
        url = reverse('admin:%s_%s_change' % (
            instance._meta.app_label,  instance._meta.model_name),  args=[instance.pk] )
        if instance.pk:
            return mark_safe(u'<a href="{u}">edit</a>'.format(u=url))
        else:
            return ''

class MyModelInline(EditLinkToInlineObject, admin.TabularInline):
    model = MyModel
    readonly_fields = ('edit_link', )

class MySecondModelAdmin(admin.ModelAdmin):
    inlines = (MyModelInline, )

admin.site.register(MyModel)
admin.site.register(MySecondModel, MySecondModelAdmin) 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2014-10-26T16:46:19.580

```
pip install django-nested-inline 
```

这个包应该做你需要的。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-01-13T22:18:35.300

AFAIK，您不能在默认的 Django 管理员中拥有第二级内联。

Django admin 只是一个普通的 Django 应用程序，所以没有什么能阻止您实现第二级嵌套表单，但恕我直言，这将是一种复杂的设计来实现。也许这就是为什么没有规定的原因。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-05-15T00:44:50.667

嵌套内联在： [https ://github.com/BertrandBordage/django-super-inlines/](https://github.com/BertrandBordage/django-super-inlines/)

```
pip install django-super-inlines 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-02-07T23:16:26.747

更新的解决方案（2021 年 2 月）是使用**show_change_link**配置变量：[https ://docs.djangoproject.com/en/3.1/ref/contrib/admin/#django.contrib.admin.InlineModelAdmin.show_change_link](https://docs.djangoproject.com/en/3.1/ref/contrib/admin/#django.contrib.admin.InlineModelAdmin.show_change_link)

这与上述解决方案中提出的 EditLinkToInlineObject 完全相同，但代码更少，并且可能已经过 Django 开发人员的良好测试

您只需要`show_change_link=True`在每个内联中定义

更新（2022 年 1 月 25 日）：这是文档中的更新链接（Django 4.0）：[https ://docs.djangoproject.com/en/4.0/ref/contrib/admin/#django.contrib.admin.InlineModelAdmin.show_change_link](https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#django.contrib.admin.InlineModelAdmin.show_change_link)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-01-27T14:47:49.520

我使用了@bigzbig 提供的解决方案（谢谢）。

保存更改后，我还想返回第一个列表页面，因此添加了：

```
class MyModelInline(EditLinkToInlineObject, admin.TabularInline):
    model = MyModel
    readonly_fields = ('edit_link', )

    def response_post_save_change(self, request, obj):
        my_second_model_id = MyModel.objects.get(pk=obj.pk).my_second_model_id
        return redirect("/admin/mysite/mysecondmodel/%s/change/" % (my_second_model_id)) 
```

# javascript - Chrome 控制台的 Javascript 帮助？单击所有链接网站

> ID：14308052
> 
> 赞同：1
> 
> 时间：2013-01-13T20:54:34.310
> 
> 标签：javascript, css, google-chrome, web, console

这个网站要我点击页面上的所有链接（大约有 2000 个）。

这是每个链接的代码：

```
<a href="#" id="27426879" class="unfollow">UNFOLLOW</a> 
```

ID根据链接一直在变化。

是否可以向我提供 javascript 代码以写入谷歌浏览器的控制台以一次单击所有具有“取消关注”类的“a”标签？谢谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T20:59:32.977

怎么样？

```
var links = document.querySelectorAll("a.unfollow[href=#]");
for (var i = 0; i < links.length; ++i) {
    links[i].click();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-13T21:00:31.760

当然是：

```
[].forEach.call(document.querySelectorAll('a.unfollow'), function (link){
    link.click();
}); 
```

[演示](http://jsfiddle.net/EAFMf/)

您*也*可以使用普通`for`循环来完成，但我发现这样做更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T21:04:08.710

谢谢我用聊天室这个代码很容易工作：$('a.unfollow').click()

# asp.net - 从另一台服务器调用 Webservice

> ID：14308055
> 
> 赞同：2
> 
> 时间：2013-01-13T20:55:07.853
> 
> 标签：asp.net, web-services, jquery

我创建了一个 Web 服务，称为在本地 PC 上正常工作`MailSerderWS.asmx`的代码`AppCode/MailSerderWS.cs`，但我对它在生产中的使用有一些疑问：

1.  基本上我正在创建这个服务来从我的服务器发送电子邮件，因为我的服务器不支持 asp，所以不能使用编码，所以我打算将 web 服务放在我的朋友服务器上并调用 web 服务从我的站点发送邮件。
2.  在我的朋友服务器上部署这个网络服务之前，我想在我的本地机器上检查这个网络服务，用我的 html 网页。下面是我正在运行的 jquery。但它从不回发，因此不会将邮件发送到我的收件箱。
3.  我应该如何将这个网络服务上传到我朋友的实时服务器上，这样我就可以在我的 html 页面中使用这个网络服务以及我将如何使用它，因为我认为如果我使用上面的 ajax 方法它永远不会执行

第 2 项的代码：

```
$("#btnSendMail").click(function(){
                     $.ajax({
                    type: "POST",
                    url: "http://audiomedia.dev.asentechdev1.com/MailSenderWS.asmx/SendMail",
                    data: "{'sendermail':'aelectricwala52@gmail.com', 'type':'standalone app', 'body':'success'}",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function(msg) {
                      alert(msg)
                    },
                    error: function(msg){
                        alert(msg.responseText);
                    }
                  });
                  }) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:40:34.567

我看到两个语法错误。尝试这个：

```
$("#btnSendMail").click(function(){
                    $.ajax({
                        type: "POST",
                        url: "http://localhost:16189/MailSenderWS.asmx/SendMail",
                        data: "{'sendermail':'aelectricwala52@gmail.com', 'type':'standalone app', 'body':'success'}",
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function(msg) {
                          alert(msg)
                        },
                        error: function(msg){
                            alert(msg);
                        }
                      });
                  }); 
```

不久前，我写了一篇关于 asmx webservice 方法并从 Jquery 调用它的文章。这可能会对您有所帮助：[http ://www.tomot.de/en-us/article/8/asp.net/how-to-use-jquery-to-call-a-webservice-asmx-method](http://www.tomot.de/en-us/article/8/asp.net/how-to-use-jquery-to-call-a-webservice-asmx-method)

**编辑**：根据您的更新，我尝试按 Ajax 调用它，但这对我也不起作用。该服务似乎部署正确，因为您可以在浏览器中调用 URL。我将您的服务添加为服务参考，调用您的方法并使用[Fiddler](http://www.fiddler2.com/fiddler2/)捕获通信。

连接到服务器没有问题，但是服务的响应表明与您的电子邮件帐户相关的身份验证问题：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<soap:Body>
<SendMailResponse xmlns="http://tempuri.org/">
<SendMailResult>
Fail Reason: The SMTP server requires a secure connection or the client was not authenticated. The server response was: 5.7.0 Must issue a STARTTLS command first. sk1sm6949585pbc.0
</SendMailResult>
</SendMailResponse>
</soap:Body>
</soap:Envelope> 
```

尝试在没有 Web 服务的情况下从本地计算机发送电子邮件，看看是否可以正常工作。之后重新部署，你应该准备好了。
我还建议您更改 Web 服务的 Url，因为既然您已将其发布到网上并且不涉及身份验证，那么有人可能会滥用它。

**Edit2**：我会告诉你我是如何使用 Fiddler 的。首先，您需要下载并安装它。

创建一个新的 .net 应用程序（例如 ConsoleApplication）。在 中`Solution Explorer`，右键单击项目并单击`Add Service Reference`。使用网址 `http://audiomedia.dev.asentechdev1.com/MailSender.asmx`

这会在您的项目中生成一些代码。

启动 Fiddler 并在您的 ConsoleApplication 中执行此代码（根据生成的名称，您需要调整此示例）：

```
 ServiceReference1.MailSenderSoapClient client = new ServiceReference1.MailSenderSoapClient();
    client.SendMail(); 
```

在 Fiddler 中，您将在左侧站点上看到 Web 会话。添加了带有您的网址的新条目。点击它。在底部区域的右侧，您会看到消息

> 响应已编码，可能需要在检查之前进行解码。单击此处进行转换。

如果您单击该消息并选择 TextView TabPage，您将从您的服务中获得以下结果：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<soap:Body>
<SendMailResponse xmlns="http://tempuri.org/">
<SendMailResult>Success</SendMailResult>
</SendMailResponse>
</soap:Body>
</soap:Envelope> 
```

# php - 在 PHP 中从 Raspberry PI 运行 SSH 命令

> ID：14308063
> 
> 赞同：0
> 
> 时间：2013-01-13T20:55:56.330
> 
> 标签：php, linux, ssh

通过 SSH 在 linux wheezy 中执行此命令时，它工作正常；

```
pi@raspberry /usr/bin $ ./send -u 2 -i 0546845 -f 
```

但是我怎样才能把它放在例如 test.php 页面（来自 var/www/test.php），这样我就可以在网页中运行它？

尝试了几件事，但需要一些帮助才能进入正确的方向。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T20:57:56.147

使用[`system`功能](http://php.net/system)。

```
string system ( string $command [, int &$return_var ] ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T04:16:45.110

我不知道如何回复“答案”..呵呵..

我认为你可以简单地这样做：

```
system('/usr/bin $ ./send -u 2 -i 0546845 -f'); 
```

将其添加到您的 php 脚本中。

# java - Mac OS X 和 Windows 8 中 JOptionPane 中的 JTextArea 大小不同

> ID：14308065
> 
> 赞同：3
> 
> 时间：2013-01-13T20:56:16.440
> 
> 标签：java, swing, windows-8, jtextarea, joptionpane

我喜欢 JOptionPane 的便利性，但不喜欢它不换行的事实。所以我决定按如下方式实现[这个问题的答案：](https://stackoverflow.com/questions/4330076/joptionpane-showmessagedialog-truncates-jtextarea-message)

```
public static void main(String[] args)
 {
  String text = "one two three four five six seven eight nine ten ";
  text = text + text + text + text + text
  JTextArea textArea = new JTextArea(text);
  textArea.setColumns(30);
  textArea.setLineWrap( true );
  textArea.setWrapStyleWord( true );
  textArea.append(text);
  textArea.setSize(textArea.getPreferredSize().width, 1); //Explanation for this line in the comments of the linked thread
  JOptionPane.showMessageDialog(
   null, textArea, "Not Truncated!", JOptionPane.WARNING_MESSAGE);
 } 
```

这在 Mac OS X 上运行良好：

![在此处输入图像描述](../Images/9348fc2905462b12699dcda9f210aad8.png)

但在 Windows 8 上不起作用，因为随着 JTextArea 的高度随着多行的增加而增加，窗口不会调整大小，因此将按钮推开：

![在此处输入图像描述](../Images/0cfe1b5f583dcdd72154ea87d396a056.png)

有什么我做错了吗？两个平台上的 Java Swing 行为是否不同？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T02:02:53.727

我发现问题实际上不是 JTextArea，而是我在程序的其他地方使用以下命令为 Windows 8 设置了默认外观的事实

```
UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName()); 
```

删除该行并默认为 Metal Look and Feel（就像我在顶部发布的片段中的情况）使一切看起来正确。我什至没有想到这可能是问题，直到我意识到上面主要方法中的对话框看起来与我的屏幕截图中的不同。

我的一个使用 Windows 7 的朋友尝试了包含该行代码的程序，并且发生了同样的事情。因此，这似乎是 Java 中的一个错误，至少有 Windows 7 和 Windows 8（对我来说运行 Java 7u10，对她来说是 6 或 7）。

根据提供的替代方案，我现在已经切换到使用带有 CSS 的 JLabel，因为它对于我的纯文本目的来说又快又脏（我知道它可以跨平台工作），但我可能会迁移到 JEditorPanes未来。

# ruby-on-rails - 从 rails 中的第三个模型获取数据

> ID：14308067
> 
> 赞同：0
> 
> 时间：2013-01-13T20:56:24.493
> 
> 标签：ruby-on-rails, model, rails-activerecord

我有这样的模型结构：

```
class User < ActiveRecord::Base
  has_many :groups, :through => :user_groups
  has_many :orders
  has_many :user_groups
end 
```

-

```
class UserGroup < ActiveRecord::Base
  belongs_to :group
  belongs_to :user
end 
```

-

```
class Group < ActiveRecord::Base
  has_many :user_groups
  has_many :users, :through => :user_groups
end 
```

在模型组中，我有字段*标记*。我如何通过它的 user_groups 为每个用户获取组的标记字段？

我这样尝试：

```
user.user_groups.each do |u|
  summ += u.groups.markup
end 
```

当然它不起作用......但是如何从第三个模型中获取数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:00:39.683

`user.groups.map(&:markup).sum`应该做得很好

编辑：

I used #flat_map because I was thinking that it was a nested array. But has_many :through would combine it into a single result list, so #map will be fine

EDIT2:

In discussion with @VladisAzamaris, it was pointed out that the `markup` column is a float, so `sum` is more appropriate than `join`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:00:32.430

首先，不妨在这里利用这`has_many :through`一点：

```
user.groups # => all the groups to which this user belongs 
```

像这样的东西如何获得标记？这会将它们全部放在一个列表中，除非您确实确实希望它们全部放在一个大字符串中，在这种情况下您将加入它们。

```
user.groups.map(&:markup) 
```

此外，如果模型上没有任何其他字段`UserGroup`，请考虑一种`has_and_belongs_to_many`关系，在这种关系中，Rails 会为您处理该粘合`UserGroup`模型，而不是让您声明它。

# sql - 从存储过程中使用 SQL 查询将不起作用

> ID：14308069
> 
> 赞同：1
> 
> 时间：2013-01-13T20:56:32.547
> 
> 标签：sql, sql-server, stored-procedures

我有一个关于这两个查询的问题。

第一个有效，第二个无效。我知道我错过了一些东西，但我看不到它！

```
SELECT Kod10 
FROM Adminview 
WHERE Kvartal = 1 
 AND Användarnamn = 'LOLGATAN13' 
 AND År = '2013' 
```

这是存储过程

```
ALTER PROCEDURE [dbo].[Checkinpvalue]
   @Inmånad varchar(50),
   @Användarnamn varchar(50),
   @Kvartal int
AS
    SELECT Kod10 
    FROM Adminview 
    WHERE Kvartal = @Kvartal 
      AND Användarnamn = @Användarnamn 
      AND År = @Inmånad 
```

像这样使用：

```
EXEC Checkinpvalue 1, 'LOLGATAN13', '2013' 
```

编辑：我问这个的原因是因为我不喜欢直接使用选择。我宁愿通过程序使用它们。

编辑：回答！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T20:58:18.453

你的参数顺序不对？！

```
EXEC Checkinpvalue '2013', 'LOLGATAN13', 1 
```

# android - 使用 NativeActivity 硬件缩放 OpenGL 表面

> ID：14308070
> 
> 赞同：0
> 
> 时间：2013-01-13T20:57:07.110
> 
> 标签：android, opengl-es, native-activity

我们正在尝试在原生屏幕尺寸为 1080p 的设备上运行复杂的 OpenGL 应用程序。不幸的是，该设备的 3D 芯片组对于这种尺寸的体面帧速率来说还不够好。

我们更喜欢做的是 720p（或更低）的渲染，然后进行硬件加速放大以填满屏幕。

我知道 Android 可以使用 2D 内容自动执行此操作（使用 ANativeWindow_lock() 和朋友）。有没有办法自动为 3D 内容执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-04T10:25:23.287

对于 GLSurfaceView，使用：

```
surfaceView = new GLSurfaceView(this);
surfaceView.getHolder().setFixedSize(1280, 720); 
```

对于 NativeActivity，使用：

```
int32_t ret = ANativeWindow_setBuffersGeometry(window, 1280, 720, 0); 
```

在以下博客文章中发现了这一点：

[Android 开发者博客 - 使用硬件缩放器提高性能和效率](http://android-developers.blogspot.co.at/2013/09/using-hardware-scaler-for-performance.html)

# cocoa - 如何使用 QTKit 为 QTMedia / QTTrack 设置 alpha 模式

> ID：14308075
> 
> 赞同：0
> 
> 时间：2013-01-13T20:57:34.710
> 
> 标签：cocoa, video, quicktime, qtkit

我正在尝试为现有电影添加字幕，除了字幕轨道的背景应该是透明的之外，一切似乎都按预期工作。

```
MediaHandler media = GetMediaHandler([[subtitlesTrack media] quickTimeMedia]);
MediaSetGraphicsMode(media, graphicsModeStraightAlpha, NULL); 
```

我已经尝试过[这里](https://stackoverflow.com/questions/1594381/cocoa-add-video-watermark-general-info)找到的上述代码，但我无法使用 GetMediaHandler 和 MediaSetGraphicsMode 函数。也许我错过了一些包括。

如果可能的话，我宁愿只使用 QTKit 框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-13T07:15:18.227

如果您在 32 位 Mac 应用程序中使用此代码作为示例，要使 alpha 透明度正常工作，MediaSetGraphicsMode() 的第二个参数必须是 graphicsModePreBlackAlpha。

如果您使用 graphicsModeStraightAlpha，压缩到 QuickTime 媒体后的视频帧将没有 Alpha 通道，至少在 Mac OS 10.10.5 下是这样。

您还需要确保使用支持 Alpha 通道的视频编解码器 - 并非所有通道都支持。

# android - 在一天中的特定时间运行服务的最省电方式？

> ID：14308083
> 
> 赞同：-1
> 
> 时间：2013-01-13T20:58:15.643
> 
> 标签：android, service, background, gps

我想创建一个仅在上午 7:30 到上午 8:55 之间运行的 android 服务。该服务将查询 GPS 以确定它是否在正确的位置，如果是，它将向服务器发送一个请求，然后关闭。创建这种后台服务的最省电的方法是什么？代码示例总是非常受欢迎。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:36:37.650

用于`AlarmManager`在需要时启动您的服务。您需要`BroadcastReceiver`在您的清单中实现 a`Service`并通过清单注册它（因此即使您的服务未运行，它也会接收调用）。

在您的服务完成它的工作后（或一旦给定时间结束），您可以通过调用[`stopSelf()`](http://developer.android.com/reference/android/app/Service.html#stopSelf%28%29)释放所有资源来完成服务。

这样，您的服务仅在需要时运行。也可以`AlarmManager`这样做，如果设备关闭，它将在达到闹钟时间时打开。

# android - CharSequnce variable.toString() 返回空

> ID：14308088
> 
> 赞同：2
> 
> 时间：2013-01-13T20:58:30.140
> 
> 标签：android, charsequence

我有一个列表项。每个项目都扩展了 Textview 以创建我的自定义项目。在这个类中，我`setText(CharSequence text, BufferType type)`在调用之前覆盖了对文本进行处理的方法`super.setText(Charsequence text, BufferType type)`。
但是当我调用`text.toString()`方法时，它返回一个空字符串。

你有同样的问题或有任何提示吗？当然，我使用 Unicode 文本 - 例如：`\u0661\u6662\u663`. 列表视图显示 Unicode 日期没有问题。

这是我的覆盖和处理方法：

```
@Override
public void setText(CharSequence text, BufferType type) {
    // TODO Auto-generated method stub
    process(text.toString());
    super.setText(text, type);
}

private void process(String guess) {
    StringBuffer correct = new StringBuffer(GameForm.getCorrectNumber());
    int s = guess.length(); 
    if (s!=correct.length())
        throw new InputMismatchException("Lenght of correct and guess number is different");
    acceptCount = 0;
    warningCount = 0;
    for (int i = 0; i < s; i++) {
        if (guess.charAt(i) == correct.charAt(i)) {
            acceptCount++;
        } else if (correct.indexOf(guess.charAt(i) + "") != -1) {
            warningCount++;
        }
    }
} 
```

`s`里面是`process(String text)`空的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:57:51.823

正如我已经说过的，使用**调试器**并设置断点`process(text.toString());`并查看值`text`是什么。toString() 方法返回的字符串表示形式，`CharSequence`因此如果它返回空字符串，则意味着您正在将一个空字符串传递给您的`setText()`方法。

由于 String 对象是不可变的，因此您将视图设置为与`text`传递给`setText()`. **再一次 - 是时候使用调试器了**。

# c++ - 有没有办法从一组图像中识别出不太相似的区域？

> ID：14308089
> 
> 赞同：1
> 
> 时间：2013-01-13T20:58:34.180
> 
> 标签：c++, image-processing, opencv

给定一个图像，我想从中提取更多的子图像，但生成的子图像不能彼此过于相似。如果每个 ROI 的中心是随机选择的，那么我们必须确保每个子图像最多只有一小部分与其他子图像有共同的区域。或者我们可以将图像分解成规则网格上的小区域，然后我在每个区域内随机选择一个子图像。但是，此选项不能确保所有子图像彼此之间有足够的差异。显然我必须选择一个好的方法来比较生成的子图像，而且还要一个相似度阈值。

必须对许多图像执行上述过程：所有提取的子图像不应太相似。有没有办法从一组图像中识别出不太相似的区域（例如通过检查所有直方图）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:57:31.527

由于您想将其应用于大量图像，并且您已经提出了建议，因此让我们讨论如何通过选择不同的图块来解决此问题。

第一步可能是定义什么是“相似”，因此需要一个相似性度量。您已经提到了瓦片的直方图作为指标的一种来源，但可能还有更多，例如：

*   平均强度，
*   强度的第 90 个百分位，
*   强度的第 10 个百分位，
*   强度模式，如直方图的峰值，
*   整个图块中像素强度的变化，
*   粒度，您可以通过原始图像和高斯滤波图像之间的差异或通过计算小子图块的平均方差来快速近似。

如果您的图像有两个通道，那么上面的列表已经为您留下了 12 个度量组件。此外，您可以从通道组合中获得一些特征，例如通道之间像素强度的相关性。两个通道只是一个特征，但三个通道已经是三个。

要从这个高维云中选择不同的图块，您可以考虑这些指标中的一些（如果不是很多）将是相关的，因此主成分分析 (PCA) 将是一个很好的第一步。[http://en.wikipedia.org/wiki/Principal_component_analysis](http://en.wikipedia.org/wiki/Principal_component_analysis)

然后，根据您想选择多少样本图块，您可以查看投影。例如，对于七个图块，我会查看前三个主成分，并从每个图块的两个极端中进行选择，然后还选择离中心最近的一个图块 (3 * 2 + 1 = 7)。

如果您担心从每个主成分的极端情况中进行选择可能不可靠，那么第 10 和第 90 个百分位数可能是稳健的。或者，您可以使用聚类算法来查找单独的示例，但这取决于您的云的外观。祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T22:02:22.230

`n x n`正如您所指出的，一种可能的方法是将图像拆分为正方形（保存边缘情况），将它们中的每一个减少为单个值并根据 k-最近值（与其他部分有关）对它们进行分组。将它们分组后，例如，您可以从每个组中选择一个图像。可能更好的方法是在每个组中使用更相关的指标，请参阅[将 url 中的图像与 python 中的文件系统中的图像进行比较以](https://stackoverflow.com/questions/13875989/comparing-image-in-url-to-image-in-filesystem-in-python/13884956#13884956)获得两个这样的指标。通过使用此指标，您可以从每个组中选择多个。

这是一个使用我发现的一些鸭子的示例。它认为`n = 128`。为了将每一块减少到一个数字，它计算到纯黑色块的欧几里得距离`n x n`。

```
f = Import["http://fohn.net/duck-pictures-facts/mallard-duck.jpg"];
pieces = Flatten[ImagePartition[ColorConvert[f, "Grayscale"], 128]] 
```

![在此处输入图像描述](../Images/b3aa18c9a93d79c008aac4eebebafd04.png)

```
black = Image[ConstantArray[0, {128, 128}]];
dist = Map[ImageDistance[#, black, DistanceFunction -> EuclideanDistance] &,
            pieces];
nf = Nearest[dist -> pieces]; 
```

然后我们可以通过考虑来查看分组`k = 2`：

```
GraphPlot[
 Flatten[Table[
   Thread[pieces[[i]] -> nf[dist[[i]], 2]], {i, Length[pieces]}]],
 VertexRenderingFunction -> (Inset[#2, #, Center, .4] &), 
 SelfLoopStyle -> None] 
```

![在此处输入图像描述](../Images/bce0447c3614b3e7fcb75caa2cd29c66.png)

现在，您可以在每个组中使用一个度量（比到黑色的距离更好）来从那里选择您想要的部分。

# android - 当我单击左上角时，如何让 Android ActionBar 转到主页？

> ID：14308098
> 
> 赞同：2
> 
> 时间：2013-01-13T20:59:28.357
> 
> 标签：android, android-layout

我看到了插入符号，但是当我单击它时没有任何反应。我在哪里告诉它到家并设置哪个活动是家？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-13T21:00:52.927

你需要这条线：

```
getActionBar().setDisplayHomeAsUpEnabled(true); 
```

把它放进去`onCreate()`；

这将使它可点击。您将需要处理单击事件。这是通过覆盖完成的`onOptionsItemSelected()`

```
 @Override
        public boolean onOptionsItemSelected(MenuItem item) {
                switch (item.getItemId()) {
                case android.R.id.home:
                 finish();
                default: 
                 return super.onOptionsItemSelected(item);      
                }
        } 
```

* * *

如果你想使用 NavUtils，（我已经看到 ADT 插件在制作活动时使用了它）你可以像这样替换更改实现：

```
 @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case android.R.id.home:
              NavUtils.navigateUpFromSameTask(this);
                    return true;
        default: 
                      return super.onOptionsItemSelected(item); 
        }
    } 
```

不要忘记

```
import android.support.v4.app.NavUtils; 
```

此外，您可以将其添加到您的活动节点：

```
 <activity
        android:name=".SomeActivity"
        android:label="@string/activity_label" >
         <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="com.mypackage.MainActivity" />
    </activity> 
```

NavUtils 通常是更好的方法。有关详细信息，请参阅官方 Android[指南](http://developer.android.com/training/implementing-navigation/ancestral.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-13T21:01:36.493

在你的`onCreate`你有：

```
getActionBar().setDisplayHomeAsUpEnabled(true); 
```

然后使用：

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    if (item.getItemId() == android.R.id.home) {
        finish();
        return true;
    }
    return super.onOptionsItemSelected(item);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-13T21:01:19.857

更新以解决下面的评论，正确地指出我的原始答案并不适用于所有情况。“home/up”按钮应该分别带您进入 Home Activity 或 Parent Activity。从`ActionBar` [文件](http://developer.android.com/guide/topics/ui/actionbar.html)来看——

> 默认情况下，您的应用程序图标出现在左侧的操作栏中。如果您愿意，您可以启用该图标以充当操作项。为了响应用户对图标的操作，您的应用程序应该执行以下两项操作之一：
> 
> ```
> Go to the application "home" activity, or
> Navigate "up" the application's structural hierarchy 
> ```

实现“家”很简单。启动应用程序的主活动（通常是您的主启动活动）的意图，如果存在则清除现有实例的后台堆栈-

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            Intent intent = new Intent(this, HomeActivity.class);
            intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
            startActivity(intent);
            return true;
        default:
            return super.onOptionsItemSelected(item);
    }
} 
```

"up" 是类似的，除了你应该使用

```
getActionBar().setDisplayHomeAsUpEnabled(true); 
```

在您`onCreate`让图标显示为“up”而不是“home”，并启动父活动的实例。

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            Intent parentActivityIntent = new Intent(this, MyParentActivity.class);
            parentActivityIntent.addFlags(
                    Intent.FLAG_ACTIVITY_CLEAR_TOP);
            startActivity(parentActivityIntent);
            finish();
            return true;
    }
    return super.onOptionsItemSelected(item);
} 
```

在这两种情况下，对于可以从应用程序外部启动的活动，您应该添加`FLAG_ACTIVITY_NEW_TASK`以启动新任务而不是调用者任务。

`Activity`如果您可以从另一个应用程序启动，并且想要为您的应用程序构建一个返回堆栈以返回根目录，那么“向上”可能会变得更加复杂。有关更多信息，请参阅[本指南](http://developer.android.com/training/implementing-navigation/ancestral.html)。

如下所示，我的原始答案在指南中被认为是错误的形式，因为它将主页/向上按钮视为“返回”。它将带您到调用此活动的活动，不一定是家庭或父母。对于具有严格的活动树层次结构的应用程序，它可以很好地“向上”运行，因为给定的活动总是由其父项启动。

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            finish();
            return true;
        default:
            return super.onOptionsItemSelected(item);
    }
} 
```

# javascript - 无法向所有套接字发送消息（socket.io）

> ID：14308099
> 
> 赞同：0
> 
> 时间：2013-01-13T20:59:30.750
> 
> 标签：javascript, node.js, express, socket.io

嘿，我正在尝试构建一个小型聊天客户端来学习 websockets 是如何工作的，以便在画布上制作游戏。它非常适合发送套接字，但它们只会将其发送给编写它的人。

我想我错过了一些小东西，但我不明白为什么它不起作用。

**服务器端代码**

```
var app = require('express')()
  , server = require('http').createServer(app)
  , io = require('socket.io').listen(server);

server.listen(3000);

app.get('/', function (req, res) {
  res.sendfile(__dirname + '/index.html');
});

io.sockets.on('connection', function (socket) {
  socket.on('user-message', function (data) {
    console.log(data);
    sendMessage(data.message);
  });
});

var sendMessage = function(message) {
      io.sockets.emit('server-message', {message: message});
} 
```

**客户端代码**

```
 <script src="/socket.io/socket.io.js"></script>
        <script>
            var socket = io.connect('http://localhost');

            socket.on('server-message', function (data) {
                var history = $('#chatbox').val();

                $('#chatbox').val(history + "\n" + data.message)
            });

            $("#write").keyup(function(event){
                if(event.keyCode == 13){
                    socket.emit('user-message', {message: $(this).val()});
                    $(this).val('');
                }
            });
        </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:10:15.800

您可以使用`socket.broadcast.emit`将消息发送到所有其他套接字。

```
io.sockets.on('connection', function (socket) {
    socket.on('user-message', function (data) {
        console.log(data);
        sendMessage.call(socket, data.message);
    });
});
var sendMessage = function(message) {
      this.emit('server-message', {message: message});
      this.broadcast.emit('server-message', {message: message});
} 
```

# c++ - 设置对第二个变量的引用

> ID：14308106
> 
> 赞同：1
> 
> 时间：2013-01-13T21:00:15.643
> 
> 标签：c++, reference

我期望 b 的值低于 100，但我得到 12。为什么会这样？显然，我的`c = b`行没有将 c 指定为 b 的别名？

```
#include "stdafx.h"
#include <iostream>

using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
    int a = 4;
    int b = 12;
    int& c = a;

    c = 8;

    cout << a << endl;
    c = b;
    c = 100;

    cout << b << endl;

    int bb;
    cin >> bb;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-13T21:02:20.723

> 显然，我的`c = b`线路没有指定`c`为`b`?

确切地说，引用不能在 C++ 中*重新定位。*`c`将始终是对`a`.

`c = b`只是一个简单的任务。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-13T21:02:33.543

您不能重新设置引用-您的`c = b;`行只是分配给`c`（因此也分配给`a`） 的当前值`b`。

当您然后分配`100`给 时`c`，`b`因此不会改变，因此它仍然具有`12`您打印出来时的原始值。

请参阅此常见问题解答：

[http://www.parashift.com/c++-faq/reseating-refs.html](http://www.parashift.com/c++-faq/reseating-refs.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-13T21:09:57.087

`c = b`实际上执行以下操作：

1.  `c`是对 的引用`a`，因此我们请求的任何操作都`c`将实际执行`a`。
2.  我们分配给`c`- 这意味着，通过 1.，我们实际上必须分配给`a`。
3.  `a`是 type 的左值`int`，因此分配`b`给它会将 的值更改为当时具有的`a`任何值`b`。（对于类类型对象，这将调用复制赋值运算符。）
4.  `b`有值`12`，所以我们把这个值赋给`a`。

就是这样。关于所指的东西没有任何改变`c`：它`a`以前是，`a`后来是，只是`a`现在有不同的价值。

* * *

显然您*想*重新安装`c`，以便它引用`b`. 好吧，你不能用 C++ 引用来做到这一点，而 IMO 这是一件好事。但是你可以用指针来做到这一点：

```
#include <iostream>

int main() {
    int a = 4;
    int b = 12;
    int* c = &a;

    *c = 8;

    std::cout << a << std::endl;
    c = &b;
    *c = 100;

    std::cout << b << std::endl;

    return 0;
} 
```

将输出您对程序的期望。

# c# - 我应该选择什么类型的 Visual Studio c# 项目来制作即时通讯应用程序

> ID：14308118
> 
> 赞同：-1
> 
> 时间：2013-01-13T21:01:08.923
> 
> 标签：c#, visual-studio-2010, instant-messaging

我必须选择什么 c# 项目才能在 Visual Studio 中创建即时消息应用程序。请帮忙。

谢谢。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:05:18.273

在应用程序设计过程中，您必须计划很多不同的事情。无论如何，主要项目当然应该是 Windows 窗体应用程序或 WPF ......然后，最终是一些库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:07:14.293

这个问题太常见了，很快就会关闭。

但是为了给你一些方向的建议，你可以下一步：

*   首先设计你的整体架构
*   用户界面有技术限制吗？
*   您基本上有以下选项：控制台应用程序、WPF、WinForms、Silverlight、ASP
*   既然您在评论中说该应用程序应该是一个 Web 应用程序，那么您可能想要创建一个 ASP.Net 应用程序。

# jquery - 基于浏览器版本的jQuery addClass

> ID：14308120
> 
> 赞同：0
> 
> 时间：2013-01-13T21:01:23.560
> 
> 标签：jquery, browser

想知道这是否适用于任何人，我无法让 addClass 工作，但如果我将其更改为警报，它就可以工作。

```
var bro = $.browser;
      if (bro.msie && bro.version.slice(0, 7) == "7.0") {
        $('#wrap').addClass('ie7');
      } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:38:53.873

根据您的评论，您确定该类不是使用 View/Source 添加的。但是，View/Source 仅显示在任何动态修改之前由服务器提供的原始 HTML。

要查看动态 DOM 修改，您需要使用 DOM 检查器来查看修改后的 DOM。使用 Chrome、IE、Safari 或 Opera 中内置的调试器或 Firefox 的 Firebug 插件。

您还可以使用断点或`console.log()`语句来验证您的代码在做什么或实际上没有做什么。

# java - case 表达式必须是 static final int 的常量表达式？

> ID：14308129
> 
> 赞同：15
> 
> 时间：2013-01-13T21:02:27.313
> 
> 标签：java, switch-statement, final

我有一个`final class Ring`定义为：

```
final class Ring {
    public static final int OUT = 3;
    public static final int MID = 2;
    public static final int IN  = 1;
} 
```

我也有`public class MorrisBoard`以下代码：

```
public class MorrisBoard {
    public static final Ring RING = new Ring();

    private boolean checkMillBy(int ring, int x, int y) {
    switch(ring) {
    case MorrisBoard.RING.OUT:
        //...
    case MorrisBoard.RING.MID: //etc.
        //...   
    }
    return false;
} 
```

`MorrisBoard.RING.OUT`引用一个在程序生命周期内不可变的变量。所有值都是最终值。

但是，我仍然收到以下错误：`case expressions must be constant expressions`. 我对此感到困惑 -`MorrisBoard.RING.OUT`是一个常量表达式。

这里发生了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-13T21:04:05.177

代替

```
 case MorrisBoard.RING.OUT: 
```

和

```
 case Ring.OUT: 
```

所以这真的是一个常数，就像“在编译时确定”一样。

规范明确规定“ [SwitchLabel](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.11) ”必须是

*   `case`后跟一个常量表达式
*   `case`后跟枚举值的名称
*   或者`default`

[规范中描述了](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.28)什么被认为是有效的常量表达式。它相当有限。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-23T08:18:36.240

这个问题的简单解决方法是：点击**开关**，然后按**CTL+1，**它将把你的开关变成if-else块语句，解决你的问题

# spring - 骨干.js RESTful API保存不向模型添加新ID

> ID：14308130
> 
> 赞同：0
> 
> 时间：2013-01-13T21:02:28.963
> 
> 标签：spring, rest, spring-mvc, backbone.js

我是backbone.js 的新手，我正在尝试使用restful API 制作一个简单的模型，但我似乎无法使简单的POST 操作正常工作。

据我了解，如果模型元素没有设置属性“id”并且调用了 save() 函数，模型将向服务器发出 post 命令（模型的 url），并且需要接收回HttpStatus.OK (200) 和项目的新 id。

这是JS代码：

> ```
>  this.model = new MYAPP.menuItem();
>   this.model.save();
>   console.debug("the new id is:", this.model.get("id")) <-- this is undefined 
> ```

我使用弹簧控制器作为服务器端。这是控制器代码

> ```
> @RequestMapping(value = "/menuItem",method = RequestMethod.POST)
> @ResponseStatus(value = HttpStatus.OK )
> @ResponseBody
> public Long addmenuItem(Model model) {
>     return new Long(1);
> } 
> ```

Post 调用正常到达服务器并且调用了控制器，但是您可以看到模型的 id 没有更新。

我究竟做错了什么？

谢谢。

根据要求的附加代码：

> ```
>  initialize: function() {
>   console.debug("initializing new view");
>   this.model = new MYAPP.Event();
>   this.model.save({
>       success: function( model ) {
>         console.log( model.get('id') );
>       }
>     });
>   var source   = $("#index-template").html();
>   this.template = Handlebars.compile(source);
>   console.debug("view collection", this.model);
>   this.model.on('all', this.render, this);
>   //this.recipes.fetch();
> }, 
> ```

对不起，一团糟！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:05:49.440

`.save()`方法是异步的。因此，`id`服务器不会立即返回 。试试这样：

```
var self = this;
this.model.save().done(function() { console.log( self.model.get('id') ); }); 
```

**编辑**由于您在引用对象时遇到问题，您可以通过这种方式获得相同的结果：

```
this.model.save({
  success: function( model ) {
    console.log( model.get('id') );
  }
}); 
```

**[一些聊天](https://chat.stackoverflow.com/rooms/22680/discussion-between-simon-boudrias-and-gleeb)****后编辑**似乎返回的数据无效。保存后，服务器应返回带有 json 的完整对象编码（带有 id）。

# uiview - 在 UIView 上方创建弹出“窗口”

> ID：14308132
> 
> 赞同：0
> 
> 时间：2013-01-13T21:02:41.470
> 
> 标签：uiview, ios6

我想创建一个出现在现有`UIView`. 这个弹出窗口需要接受文本输入并有一个按钮。`UIButton`按下a 时应出现此弹出窗口。

我正在使用故事板，并且想知道完成此操作的最佳方法是什么？我应该只使用另一个`UIView`吗？如果是这样，我该如何在现有视图之上创建新视图`UIView`？

任何指导将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:10:50.893

它可以像添加一个新的 UIView 一样简单，其中包含您想要的所有各种控件/标签，并将该新视图放在视图控制器的主视图之上（这可能被视为子视图）。

然后将新视图设置为视图控制器中的插座并将其隐藏（通过属性检查器）。

![设置隐藏属性](../Images/b8e0688f8d71830406aac7532f336178.png)

当按钮被触摸时，您可以通过编程将“弹出窗口”视图的“ `.hidden`”属性设置为“ `NO`”。

# php - 如何自动将先前的表单选择加载到自身中并对所有选定类型进行一次查询？

> ID：14308136
> 
> 赞同：2
> 
> 时间：2013-01-13T21:03:39.043
> 
> 标签：php, html, forms

在我的网站上，我有一个搜索栏。它作为一个表单，提交并在我的数据库中搜索在文本栏中输入的值，在选择类型的列中。我的表格看起来像这样

```
<form action=" " method="POST" >
 <select name="search_type">
<option value="fullname">People</option>
<option value="username" >Username</option>
<option value="firstname”&gt;First Name</option>
<option value="lastname" >Last Name</option>
<option value="email" >Email</option>
</select><input type="text" name="value" >
<input type="submit" value="Search">
</form> 
```

每次搜索后它都会刷新，用户必须重新选择数据并将其放回……有没有办法重新选择最后一次搜索的项目？然后从那个表格中我使用 PHP 检查选择了什么类型并查看我的数据库......目前我有一堆我觉得效率太低的条件，有没有办法摆脱所有这些条件并直接搜索特定列我的数据库来自一个电话？（作为记录，我的数据库列名是 user_fullname、user_username、user_firstname、user_lastname 和 user_email）。我的 PHP 脚本看起来像这样（我对每个类型变量都有一个条件块）

```
If($_POST[‘search_type’] == ‘fullname’){
$results ="SELECT `user_id`, `user_username`, `user_firstname`, `user_lastname` FROM `mytable` WHERE user_fullname = {$_POST[‘value’]}";
while($results_row = mysql_fetch_assoc($results)){
$returned_results[] = array( ///returning stuff///);
}}
///etc 
```

我一直在寻找几个小时试图找到一种方法，只为任何类型运行一个查询，但我可能没有任何工作。请任何建议或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:42:20.393

为了添加到 Devon 的答案，我想出了如何在该主要调用中组合其他条件函数以进行电子邮件验证等内容。

```
if($_POST['value'] != ''){
if($_POST['search_type'] == 'user_email'){
if(!filter_var($_POST['value'], FILTER_VALIDATE_EMAIL)) 
    { 
        die("Invalid E-Mail Address"); 
    } 
}
$where = " {$_POST['search_type']} LIKE '%{$_POST[‘value’]}%'";
$results ="SELECT `user_id`, `user_username`, `user_firstname`, `user_lastname` FROM `mytable` WHERE $where";

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:12:40.977

要删除 mysql 查询中的条件，我认为最简单的方法是将搜索类型的值设置为您的实际列名，这样您就可以针对该值运行查询。例如，您的选项值将是表单中的“user_fullname”、“user_username”等，对于您的 PHP 脚本，您可以尝试以下操作：

```
$where = " {$_POST['search_type']} LIKE '%{$_POST[‘value’]}%'";
$results ="SELECT `user_id`, `user_username`, `user_firstname`, `user_lastname` FROM `mytable` WHERE $where"; 
```

我认为刷新表单数据和预选字段的最简单方法是一些 PHP 条件：

```
<form action="search.php" method="POST" >
 <select name="search_type">
<option value="user_fullname"<?php if($_POST['search_type'] == 'user_fullname'){echo 'selected';} ?>>People</option>
<option value="user_username" <?php if($_POST ['search_type'] == 'user_username'){echo 'selected';} ?>>Username</option>
<option value="user_firstname" <?php if($_POST ['search_type'] == 'user_firstname'){echo 'selected';} ?>>First Name</option>
<option value="user_lastname" <?php if($_POST ['search_type'] == 'user_lastname'){echo 'selected';} ?>>Last Name</option>
<option value="user_email" <?php if($_POST ['search_type'] == 'user_email'){echo 'selected';} ?>>Email</option>
</select><input type="text" name="value" value="<?php echo $_POST['email']; ?>">
<input type="submit" value="Search">
</form> 
```

# excel - 如何在趋势线表达式中切换 x/y？

> ID：14308139
> 
> 赞同：1
> 
> 时间：2013-01-13T21:04:03.417
> 
> 标签：excel, excel-formula, trendline

如果不切换图表本身的轴，那么为给定的表达式切换 x 和 y 的简单方法是什么，例如`y = 3E-12x5 - 4E-09x4 + 1E-06x3 + 0.0005x2 - 0.0302x + 23.826`. 所以我想得到`x`给定的`y`系列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T23:06:37.503

您无需创建图表即可得出多项式回归，您可以使用`LINEST`然后针对您的问题，只需交换 x 和 y 范围

看[这里](http://people.stfx.ca/bliengme/ExcelTips/Polynomial.htm)

![在此处输入图像描述](../Images/189b38206cc53b49dec7ba658b756c06.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:19:47.227

您有一个函数 y(x)，它是一个高阶多项式。你想找到函数 x(y) 吗？[在wolfram alpha](http://www.wolframalpha.com/widgets/gallery/view.jsp?id=d08726019e4a2a15cb1d49092e4d0522)尝试反函数计算器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-11-12T10:23:56.693

为此，在您想要的图表中，绘制相应的趋势线并选择要显示的趋势线方程；然后使用设计选项卡中的“切换行/列”选项，切换图形。您将看到图形和方程式都发生了变化。只需单击方程式，使文本光标出现在写入方程式的文本字段中，方程式就会变得固定。然后再次单击设计选项卡中的“切换行/列”。您将看到图形变为初始条件，但方程没有。现在你有你想要的图形和图形上显示的函数逆方程。

祝你好运，

# triggers - Salesforce.com 触发器 - 需要主要联系人来保存机会

> ID：14308142
> 
> 赞同：0
> 
> 时间：2013-01-13T21:04:22.653
> 
> 标签：triggers, salesforce, apex-code

目前有两个 AppExchange 应用程序可以执行此操作，但我想知道是否有人知道如何在不安装应用程序的情况下执行此操作，因为我可以在组织中安装的应用程序数量有限。

触发器需要检查是否列出了联系人，如果没有，则应显示错误消息。我用验证规则尝试了这个，但没有运气，因为 OpportunityContactRole 是一个单独的对象。

有人可以提供他们的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T07:29:46.787

```
trigger OpportunityBeforUpdate on Opportunity (before update) {
   set<Id> oppIdSet = new set<Id>();
   set<Id> OpportunityContactRoleIdSet = new set<Id>();
   for(Opportunity opp:trigger.new){
  if("Some condition")oppIdSet.add(opp.Id);
   }
 for(OpportunityContactRole ocr:[select Id,OpportunityId from OpportunityContactRole                                        where OpportunityId in:oppIdSet]){
OpportunityContactRoleIdSet.add(ocr.OpportunityId);
   }
  for(Opportunity opp:trigger.new){
if(oppIdSet.contains(opp.Id) && !OpportunityContactRoleIdSet.contains(opp.Id))
    opp.addError('Some error'); 
  } 
```

}

# clojure - 是否可以使用 clojure.core.reducers 实现“分区”功能？

> ID：14308145
> 
> 赞同：3
> 
> 时间：2013-01-13T21:05:05.760
> 
> 标签：clojure, reducers

我有以下功能：

```
(defn map-pairs [f coll]
  (map f (partition 2 1 coll))) 
```

是否可以避免使用 clojure.core.reducers 创建中间 2 元素集合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:56:41.163

不是开箱即用。但是你可以：

```
=> (into [] (map2 + (range 10)))
[1 3 5 7 9 11 13 15 17] 
```

看：

```
(deftype Fn2 [f1 f ^:volatile-mutable a ^:volatile-mutable b]
  clojure.lang.IFn
  (invoke [this] (f1))
  (invoke [this _] (set! b this)) ; hack to init the sentinel
  (invoke [this ret v] 
    (set! a b)
    (set! b v)
    (if (identical? a this)
      ret
      (f1 ret (f a b))))
  #_(invoke [this ret k v] to do))

(defn fn2 [f1 f] 1
  (let [f2 (Fn2\. f1 f nil nil)]
    (f2 nil)
    f2))

(defn map2 [f coll]
  (r/reducer coll
    (fn [f1]
      (fn2 f1 f)))) 
```

# bash - 覆盆子的 GPIO 命令无法通过 crontab 工作

> ID：14308147
> 
> 赞同：2
> 
> 时间：2013-01-13T21:05:18.740
> 
> 标签：bash, raspberry-pi, gpio

我有一个树莓派。我已经通过命令行在板上安装了 WiringPi 用于引导 GPIO。

我已经完成了一个名为 aggiornaora.sh 的脚本

```
gpio -g write 18 1 #it set the GPIO port to 1
#log with reverse append
(echo 'accensione';date;echo ' ') | cat - logstufa.txt > temp && mv temp logstufa.txt 
```

如果我尝试直接通过`sh aggiornaora.sh`. 但是当 cron 运行脚本时，它只执行第二个操作。都具有root权限。我已经通过“gpio readall”检查了这个问题。

在您看来，可能是什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-13T21:22:58.613

请注意，当您从 执行某些内容时`crontab`，它不一定具有相同的环境变量集。

最重要的环境。你的变量是`PATH`. 我认为`cron`您的 PATH 下不包含您的`gpio`命令所在的目录。

您可以将这样的行添加为 crontab 的第一行：

```
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin 
```

`gpio`如果位于上面列出的目录之一中，这应该可以解决您的问题。

调试 crontab 问题的典型方法是确保 env. 变量是您所期望的。将这样的行添加到脚本的第一行以进行调试：

```
set > /path/to/log/file    # be sure that this file is writable 
```

手动运行一次，将日志文件复制到一边。然后，从 cron 再次运行它，比较输出 - 你会看到是什么让它们不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-20T18:54:39.130

是的，我遇到了同样的问题（在 crontab 中使用 gpio 命令）。一个对我有用的快速解决方法是在 gpio 命令前添加一个“sudo”，例如：sudo gpio write 0 1

当我浏览我的 bash 脚本并将 'sudo's 添加到我所有的 gpio 命令时，一切正常。

mvp 建议的先前答案是使用 crontab 解决这些类型问题的“更好”方法。希望这可以帮助

# java - 将字符串日期更改为另一个字符串日期

> ID：14308148
> 
> 赞同：1
> 
> 时间：2013-01-13T21:05:21.313
> 
> 标签：java, string, date

我有一个`String`这样的: `2013-04-19`，我想把它改成 : `April 19th 2013`。我知道Java中有一些类`SimpleDateFormat`，但我不知道我应该使用什么样的函数。也许我需要选择班级`Pattern`？我需要帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:42:00.173

试试下面的，这应该给你正确的“th”、“st”、“rd”和“nd”几天。

```
public static String getDayOfMonthSuffix(final int n) {
        if (n >= 11 && n <= 13) {
            return "th";
        }
        switch (n % 10) {
            case 1:  return "st";
            case 2:  return "nd";
            case 3:  return "rd";
            default: return "th";
        }
    }

public static void main(String[] args) throws ParseException {
        Date d = new SimpleDateFormat("yyyy-MM-dd").parse("2013-04-19");

        int day = Integer.parseInt(new java.text.SimpleDateFormat("dd").format(d));
        SimpleDateFormat sdf = new SimpleDateFormat("MMMMM dd'" + getDayOfMonthSuffix(day) + "' yyyy");
        String s = sdf.format(d);

        System.out.println(s);
    } 
```

哪个会打印`April 19th 2013`

（日终止改编自[这篇文章](https://stackoverflow.com/a/4011232/1332690)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:30:27.093

试试这个：

```
String originalDate = "2013-04-19";
Date date = null;
try {
    date = new SimpleDateFormat("yyyy-MM-dd").parse(originalDate);
} catch (Exception e) {
}
String formattedDate = new SimpleDateFormat("MMMM dd yyyy").format(date); 
```

不会打印st、nd、rd等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T22:20:43.837

只需使用 SimpleDateFormat 类中的 parse 方法试试这个：

```
new SimpleDateFormat("MMM dd YYYY").parse("2013-04-19"); 
```

# javascript - 如何在 javascript/jquery 中合并两个 json 对象？

> ID：14308149
> 
> 赞同：0
> 
> 时间：2013-01-13T21:05:23.047
> 
> 标签：javascript, jquery, json

我有一个如下所示的数据集：

```
{
"Stops": [
    {
        "Name": "COLUMBIA RD NW + MINTWOOD PL NW",
        "Routes": [
            "42",
            "43",
            "H1",
            "L2"
        ]
    }
] 
```

}

另一个看起来像这样：

```
{
"Predictions": [
    {
        "DirectionText": "North to Mt Pleasant Via Adams Morgan",
        "Minutes": 7,
        "RouteID": "42"
    },
    {
        "DirectionText": "North to Mt Pleasant Via Adams Morgan",
        "Minutes": 25,
        "RouteID": "42"
    },
    {
        "DirectionText": "North to Chevy Chase Circle",
        "Minutes": 32,
        "RouteID": "L2"
    },
    {
        "DirectionText": "North to Mt Pleasant Via Adams Morgan",
        "Minutes": 36,
        "RouteID": "42"
    },
    {
        "DirectionText": "North to Mt Pleasant Via Adams Morgan",
        "Minutes": 58,
        "RouteID": "42"
    },
    {
        "DirectionText": "North to Mt Pleasant Via Adams Morgan",
        "Minutes": 69,
        "RouteID": "42",
    }
],
"StopName": "Columbia Rd Nw + Mintwood Pl Nw" 
```

}

我想在第一组中结合 Route ID 上的数据，专门添加要设置的分钟数。所以输出会是这样的：

```
{
"Stops": [
    {
        "Name": "COLUMBIA RD NW + MINTWOOD PL NW",
        "Routes": [
            {
                "42": [
                    {
                        "Minutes": [7, 25,36,58,69]
                    }
                ],
                "43": [
                    {
                        "Minutes": []
                    }
                ],
                "H1":[ 
                    {
                        "Minutes": []
                    }
                ],
                "L2": [
                    {
                        "Minutes": [32]
                    }
                ]
            }
        ],
        "StopID": "1001779"
    }
]
} 
```

我不知道如何编写一些 javascript/jquery 来进行这种合并。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:28:30.667

请，这是更新的代码，包含空数组和所有内容。它是纯 javascript，因此不需要库。我知道它只是一个粗略的例子，但它有效，我希望它能帮助你找到你的方式。以后你可以完善它。

```
var 

    stops = {
        "Stops": [
            {
                "Lat": 38.92092,
                "Lon": -77.043684,
                "Name": "COLUMBIA RD NW + MINTWOOD PL NW",
                "Routes": [
                    "42",
                    "43",
                    "H1",
                    "L2"
                ],
                "StopID": "1001779"
            }
        ]
    },

    predictions = {
        "Predictions": [
            {
                "DirectionNum": "1",
                "DirectionText": "North to Mt Pleasant Via Adams Morgan",
                "Minutes": 7,
                "RouteID": "42",
                "VehicleID": "7136"
            },
            {
                "DirectionNum": "1",
                "DirectionText": "North to Mt Pleasant Via Adams Morgan",
                "Minutes": 25,
                "RouteID": "42",
                "VehicleID": "7103"
            },
            {
                "DirectionNum": "0",
                "DirectionText": "North to Chevy Chase Circle",
                "Minutes": 32,
                "RouteID": "L2",
                "VehicleID": "2207"
            },
            {
                "DirectionNum": "1",
                "DirectionText": "North to Mt Pleasant Via Adams Morgan",
                "Minutes": 36,
                "RouteID": "42",
                "VehicleID": "7132"
            },
            {
                "DirectionNum": "1",
                "DirectionText": "North to Mt Pleasant Via Adams Morgan",
                "Minutes": 58,
                "RouteID": "42",
                "VehicleID": "7111"
            },
            {
                "DirectionNum": "1",
                "DirectionText": "North to Mt Pleasant Via Adams Morgan",
                "Minutes": 69,
                "RouteID": "42",
                "VehicleID": "7135"
            }
        ],
        "StopName": "Columbia Rd Nw + Mintwood Pl Nw"
    };

    var routeTimes = {};
    for (var index in predictions.Predictions) {
        if(!routeTimes.hasOwnProperty(predictions.Predictions[index].RouteID)) {
            routeTimes[predictions.Predictions[index].RouteID] = [];
            routeTimes[predictions.Predictions[index].RouteID].push(predictions.Predictions[index].Minutes);
        } else {
            routeTimes[predictions.Predictions[index].RouteID].push(predictions.Predictions[index].Minutes);
        }
    }

    var 
        routes = stops.Stops[0].Routes,
        routesVsMinutes = {};

    for(var i in routes) {
        if (!routesVsMinutes.hasOwnProperty(routes[i])) {
            routesVsMinutes[routes[i]] = {Minutes: []};
        } 
        if (routeTimes[routes[i]]) {
            routesVsMinutes[routes[i]].Minutes = routeTimes[routes[i]];
        }
    }      
    stops.Stops[0].Routes = routesVsMinutes;

    console.log(stops); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:29:45.093

您可以使用[jQuery 地图](http://api.jquery.com/jQuery.map/)：

```
json1.Stops.routes = $.map(json1.Stops[0].Routes, function(route){
  //Take all predictions which concern the route
  var availables = $.filter(json2.Predictions, function(prediction){
    return prediction.RouteID === route
  })
  //Extract all minutes
  var minutesArray = $.map(availables, function(available){
    return available.Minutes
  })
  // Return the object to put in "routes"
  return {"Minutes": minutesArray}
}) 
```

和：

```
json1 = {"Stops":[...]}
json2 = {"Predictions:[...]} 
```

# javascript - 不使用 jQuery 和 Mustache.JS 写入 HTML

> ID：14308151
> 
> 赞同：0
> 
> 时间：2013-01-13T21:05:31.217
> 
> 标签：javascript, jquery, mustache

我敢肯定这是感冒加上睡眠不足的结合，但我被困住了。

代码再简单不过了：

```
$.get('template.tpl', function(tpl) {
    $.getJSON('json/data2.json', function(data) {
        var html = Mustache.render(tpl, data);
        $('#output').html(html);
    });
}); 
```

多达。如果我`Console.Log(html)`在声明后将 a 扔到线上，它会正确输出......但对于我的生活，我无法解决为什么它没有像应该的那样将文本放入 #output 中。fething `$('#output').html("foo");`template.tpl 之外的独立式工作没有问题。

帮助？

**解决了**

解决了，感谢 asgoth 的一个问题。代码是否正确 - 在我的 .tpl 文件中的模板周围有脚本标签。不再需要它们，因为模板被直接推送到 Mustache……但被写入 HTML，这意味着我看不到结果。

我要去打个盹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:13:07.207

我以前没用过 Mustache，但你不应该用[`compile`](https://github.com/janl/mustache.js)吗？

```
var html = Mustache.compile(tpl)(data); 
```

# php - 使用php从以开头和结尾的字符串中获取所有匹配项

> ID：14308154
> 
> 赞同：14
> 
> 时间：2013-01-13T21:06:12.763
> 
> 标签：php, regex, preg-match, preg-match-all

我将如何使用 PHP从该字符串`[startstring]`中提取所有内容：`[endstring]`

```
[startstring]hello = guys[endstring] hello guys [startstring]jerk = you[endstring] welcome to the universe 
```

我想找到 and 的所有匹配项`[startstring]`，`[endstring]`并在里面回显文本。有点像分隔符。我希望所有回显的匹配都用空格隔开。

我将如何实现这一目标？这需要`regex`吗？你能提供一个样品吗？

非常感谢！:)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-13T21:08:07.247

```
preg_match_all('/\[startstring\](.*?)\[endstring\]/s', $input, $matches);
echo implode(' ', $matches); 
```

* * *

```
preg_match_all('/\[startstring\](.*?)\=(.*?)\[endstring\]/s', $input, $matches);
for ($i = 0; $i < count($matches[1]); $i++) {
    $key = $matches[1][$i];
    $value = $matches[2][$i];
    $$key = $value;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-13T21:08:29.187

尝试[`preg_match_all`](http://php.net/preg_match_all)：

```
preg_match_all('/\[startstring\](.*?)\[endstring\]/', $input, $matches);
var_dump($matches); 
```

# objective-c - cocos2d如何同时接收两个按钮的触摸？

> ID：14308155
> 
> 赞同：1
> 
> 时间：2013-01-13T21:06:15.877
> 
> 标签：objective-c, button, cocos2d-iphone, ccmenuitem, ccmenu

我现在正在使用 cocos2d 并且我有一些菜单。

```
menu = [CCMenu menuWithItems:btn1, btn2, btn3, btn4, btnMenu, nil]; 
```

我有处理水龙头的方法。`btn1, btn2, btn3, btn4`在同一个菜单中，每个按钮都有相同的方法来处理水龙头。在 Cocoa Touch 上它工作正常：一次点击 4 个按钮 - 收到了 4 个点击。使用 cocos2d：点击了四个按钮 - 一个收到了。

问题出在哪里，我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T05:19:16.740

创建不同的菜单。

```
menu1 = [CCMenu menuWithItems:btn1, btn2, nil];
menu2 = [CCMenu menuWithItems: btn3, btn4, nil]; 
```

# php - $_POST 和 INSERT INTO 在 PDO 中转换

> ID：14308156
> 
> 赞同：-1
> 
> 时间：2013-01-13T21:06:35.883
> 
> 标签：php, sql, insert, pdo

你好朋友我有一个问题，我创建了一个没有 pdo 的脚本并且是 sqli 易受攻击的，sql 连接是 pdo 因为这样做很简单，但在这种情况下情况发生了变化。请帮助我，这是代码：

```
<?php require ("../SQL.php");

#######De aici am setat creearea directoarelor pentru poze#####
$model          = "$_POST[model]";
$marca          = "$_POST[marca]";

 mkdir ("\\server\\htdocs\\panou\\poze\\{$marca}/{$model}", 0777, true);
$director_poza = ("poze/{$marca}/{$model}/");    
$numetmp_poza  = $_FILES['numepoza1']['name'];
$numepoza1     = $director_poza.$numetmp_poza;
$numetmp_poza  = $_FILES['numepoza2']['name'];
$numepoza2     = $director_poza.$numetmp_poza;
$numetmp_poza  = $_FILES['numepoza3']['name'];
$numepoza3     = $director_poza.$numetmp_poza;
if(move_uploaded_file($_FILES['numepoza1']['tmp_name'], $numepoza1))
if(move_uploaded_file($_FILES['numepoza2']['tmp_name'], $numepoza2))
if(move_uploaded_file($_FILES['numepoza3']['tmp_name'], $numepoza3))
{
list($width,$height,$type,$attr)= getimagesize($numepoza1);
switch($type)
{
case 1:
$ext = ".gif"; break;
case 2:
$ext = ".jpg"; break;
case 3:
$ext = ".png"; break;
default:
echo "Format foto neacceptat";
}

$insertie = "INSERT INTO modele 
(id, marca, model, utilizator, despre, data, data_luna, data_zi, img1, img2, img3,    doi_g, trei_g, patru_g, info_ecran, rezolutie_ecran, multitouch_ecran, protectie_ecran,  sunet_sonerii, sunet_mainilibere, sunet_mufa_jack, memorie_card, mcard_tip,  mcard_capacitate, intern_memorie, date_gprs, date_edge, date_viteze, date_wifi, date_bt,  date_nfc, date_usb, camera_spate, camera_fata, camera_tehnologii, camera_video, performanta_os, performanta_chipset, performanta_cpu, performanta_cpu_core, performanta_cpu_tip, performanta_rami, performanta_gpu, performanta_senzori, performanta_gps, performanta_java, altele_radio, altele_mesajerie, altele_filme, baterie_autonomie, baterie_mAh, baterie_convorbire, SEO_cuvinte_cheie)
VALUES
('',
'$_POST[marca]',
'$_POST[model]',
'$utilizator',
'$_POST[despre]',
'$_POST[data]',
'$_POST[data_luna]',
'$_POST[data_zi]',
'$numepoza1',
'$numepoza2',
'$numepoza3',
'$_POST[doi_g]',
'$_POST[trei_g]',
'$_POST[patru_g]',
'$_POST[info_ecran]',
'$_POST[rezolutie_ecran]',
'$_POST[multitouch_ecran]',
'$_POST[protectie_ecran]',
'$_POST[sunet_sonerii]',
'$_POST[sunet_mainilibere]',
'$_POST[sunet_mufa_jack]',
'$_POST[memorie_card]',
'$_POST[mcard_tip]',
'$_POST[mcard_capacitate]',
'$_POST[intern_memorie]',
'$_POST[date_gprs]',
'$_POST[date_edge]',
'$_POST[date_viteze]',
'$_POST[date_wifi]',
'$_POST[date_bt]',
'$_POST[date_nfc]',
'$_POST[date_usb]',
'$_POST[camera_spate]',
'$_POST[camera_fata]',
'$_POST[camera_tehnologii]',
'$_POST[camera_video]',
'$_POST[performanta_os]',
'$_POST[performanta_chipset]',
'$_POST[performanta_cpu]',
'$_POST[performanta_cpu_core]',
'$_POST[performanta_cpu_tip]',
'$_POST[performanta_rami]',
'$_POST[performanta_gpu]',
'$_POST[performanta_senzori]',
'$_POST[performanta_gps]',
'$_POST[performanta_java]',
'$_POST[altele_radio]',
'$_POST[altele_mesajerie]',
'$_POST[altele_filme]',
'$_POST[baterie_autonomie]',
'$_POST[baterie_mAh]',
'$_POST[baterie_convorbire]',
'$_POST[SEO_cuvinte_cheie]')"; 
$insertieresults = mysql_query($insertie) or die(mysql_error());
}
echo '<center>Succesuful!</center>
<meta http-equiv="refresh" content="5; URL=adauga-tableta-tel.php"/>'; 
?> 
```

我知道这很容易受到黑客注入，提前谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:18:55.957

SO不会为您重新编写代码。研究使用[PDO](http://php.net/manual/en/book.pdo.php)并首先自己尝试。[这篇](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)文章似乎也很相关。如果您在编写时遇到问题，请返回并发布您的代码。然后我们可以提供帮助。

# wordpress - wordpress//pods cms - 如何为我的 pod 指定自定义模板文件？

> ID：14308159
> 
> 赞同：2
> 
> 时间：2013-01-13T21:07:05.897
> 
> 标签：wordpress, podscms

首先，我想说我对这个可耻的问题感到非常抱歉！在我的 wordpress (v3.5) 上，我刚刚下载并安装了 pods cms 插件 (2.2)。

我制作了新的很棒的 pod 对象（例如 News），我添加了一些自定义属性并保存了它。我使用的固定链接是 /news/{name}

我启用了 Pods Template 和 Pods 页面，并在 wp 仪表板中创建了一些新闻。回到我的前端，当我尝试访问 mywordpress.com/news/MySuperNew 时，我什么也没有，更可怕的是，我挖了又挖了网络，以便知道如何告诉 podsCms 对于每个 Pods News 对象，我想使用我自己名字的自定义模板文件“mySuperTemplateForNews.php”

edit1：我注意到在 Pods Pages 设置中，您可以创建页面并指定要使用的模板文件（在当前主题文件夹中创建）。但是我仍然不知道如何将特定的 pod 绑定到特定的模板......

我希望有人能帮助我。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:40:42.060

您是否启用了永久链接（除了默认设置之外的任何东西都可以）？

您应该确保将您的 pod 页面添加为“news/*”

代码进入包含 Pod[循环](http://pods.io/docs/find/)和其他代码的 pod 页面内容区域（或直接进入 WP 页面模板文件）。如果您使用 Pod 页面内容来存储 PHP，则需要将其放入`pods_content()`WP 页面模板文件中需要输出的任何位置。

# bash - tput cols 在脚本中无法正常工作

> ID：14308166
> 
> 赞同：3
> 
> 时间：2013-01-13T21:07:19.950
> 
> 标签：bash

我在脚本中使用“tput cols”一切正常，除非窗口最大化。我的脚本能够正确获取任何窗口大小，但是当窗口最大化时，它会得到一个错误的值（80）。然后我直接在终端中输入“tput cols”，得到正确的尺寸（158）。所以我的问题是，即使窗口最大化，我怎样才能获得正确的值？？？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T21:54:45.717

`tput cols`可能是从 shell 环境变量`$COLUMNS`而不是`TIOCGWINSZ`ioctl 读取的。shell 可能会更新此变量以响应`SIGWINCH`，但这当然不会影响`$COLUMNS`脚本中的变量。

尝试`unset COLUMNS`查看是否`tput cols`从终端 ioctl 获取值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T13:03:26.057

首先运行：

```
$ shopt -s checkwinsize 
```

来源：[https ://www.gnu.org/software/bash/manual/html_node/The-Shopt-Builtin.html](https://www.gnu.org/software/bash/manual/html_node/The-Shopt-Builtin.html)

尝试使用`resize`as 命令以获取有关信息。您将获得所需的值。为了在您的程序中使用它们，您可以编写如下内容：

```
echo "Old value of COLUMNS: $COLUMNS"
# This should execute the output of resize and export the var you need
eval $(resize)
echo "New value of COLUMNS: $COLUMNS" 
```

有关调整大小的更多信息，请查看`man resize`或检查此链接：http: [//invisible-island.net/xterm/manpage/resize.html](http://invisible-island.net/xterm/manpage/resize.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-10T13:42:33.890

对于 bash 中的类似问题，当我在做一个

```
# X is a script that uses 'tput cols'
$(eval X) 
```

...它正在恢复到 80 列。

所以，我将我的评估更改为：

```
T=`tput cols` 
$(COLUMNS=$T X) 
```

# php - 使用 PHP 将制表符转换为空格以进行 HTML 显示？

> ID：14308168
> 
> 赞同：3
> 
> 时间：2013-01-13T21:07:31.047
> 
> 标签：php, html, whitespace

我需要在网页中显示一个纯文本文件，其中包含两个空格制表符的数据列。

我所做的是使用 PHP 读取文本文件并在`<pre>`标签之间打印出来以使用等宽字体，如下所示：

```
<pre>
<?php
  $fn="data.txt";
  $fi=fopen($fn, "r");
  $fc=fread($fi, filesize($fn));         //open and read text file
  fclose($fi);
  $fc=str_replace("\t", "  ", $fc);      //replace tabs with two spaces
  print($fc);                            //print data between PRE tags
?>
</pre> 
```

它几乎可以工作，但是标签很麻烦。用两个空格替换制表符是微不足道的，但随后非空白字符被推过而不是吸收到制表符中。真正的制表符吸收`n-1`非空白字符（其中`n`是每个制表符的空格数）。

例如，下表应显示为：

```
|   | 43| 43|  7|   |   |
| 12|128|128|128|   | 53|
|  3|  3|  3|  3|   |   |
|   |   | 21| 21| 39|   | 
```

然而，通过盲目地用两个空格替换所有制表*符*，我们得到了：

```
|    |  43|  43|    7|   |   |
|  12|128|128|128|   | 53|
|   3|   3|   3|   3|   |   |
|   |   |  21|  21|  39|   | 
```

我试图找出一种（相当简单的）方法将制表符转换为空格，同时考虑不占用完整`n`空间的制表符。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-13T22:03:08.630

我前段时间写过这个函数，可能会有所帮助：

```
function tab2space($line, $tab = 4, $nbsp = FALSE) {
    while (($t = mb_strpos($line,"\t")) !== FALSE) {
        $preTab = $t?mb_substr($line, 0, $t):'';
        $line = $preTab . str_repeat($nbsp?chr(7):' ', $tab-(mb_strlen($preTab)%$tab)) . mb_substr($line, $t+1);
    }
    return  $nbsp?str_replace($nbsp?chr(7):' ', '&nbsp;', $line):$line;
} 
```

它是用来处理多字节字符串的，如果你只有数字，你可以去掉`mb_`，它会加速这个功能。

[+] Note that this is meant to work with one line, so you will need to process line by line with `fgets` instead of whole file at once.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:29:15.073

您可以尝试使用[printf](http://php.net/manual/en/function.printf.php)功能。

这里有一个例子：

```
printf("%4d",'37'); // will print ' 37' (with 2 spaces before 37) 
printf("%6d",'37'); // will print '   37' (with 4 spaces before 37) 
printf("%6d",'337'); // will print '  37' (with 3 spaces before 37) 
```

[这里](http://php.net/manual/en/function.sprintf.php)有一些关于格式的信息。

（供您参考，C 也可以使用相同的技巧）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T21:46:51.950

首先，去掉所有的制表符和空格：

```
$fc=str_replace("\t", "", $fc);
$fc = str_replace(" ", "", $fc); 
```

然后应用这些替换。循环是因为替换可能不会在第一次运行时遇到所有可能的情况：

```
//deal with the case of two pipes next to each other
while(strpos($fc, "||") !== false)
   $fc = str_replace("||", "|   |", $fc);

//deal with the case of |XX|
while(preg_match('/\|[0-9][0-9]\|/', $fc) !== 0)
    $fc = preg_replace('/\|([0-9])([0-9])\|/', '| ${1}${2}|', $fc);

//deal with the case of |X|
while(preg_match('/\|([0-9])\|/', $fc) !== 0)
   $fc = preg_replace('/\|([0-9])\|/', '|  ${1}|', $fc); 
```

由于您有三个空格列，因此无需对 3 位数字 (|XXX|) 执行任何操作。

这应该工作！

# javascript - 在eclipse的同一个文件中突出显示HTML和JavaScript？

> ID：14308169
> 
> 赞同：3
> 
> 时间：2013-01-13T21:07:36.943
> 
> 标签：javascript, html, eclipse

我是 eclipse 的新手，我正在尝试编辑一个包含 html 和 JavaScript 的 .html 文件。我已经安装了网页编辑器和 JavaScript 开发工具插件，但似乎没有任何效果。它将（显然）突出显示 html，但让它突出显示内部的 JavaScript

`<script> .... </script>`标签被证明是一个挑战。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-15T14:31:35.100

这里的解决方案[http://www.elvenware.com/charlie/development/web/HtmlGuide/EclipseWebDevelopment.html](http://www.elvenware.com/charlie/development/web/HtmlGuide/EclipseWebDevelopment.html)对我有用。我没有**使用**该插件 - 我按照“替代”说明进行操作：

从 Eclipse 菜单中选择“Help | Install New Software”。在“使用”下拉列表中选择以下内容：

朱诺 - [http://download.eclipse.org/releases/juno](http://download.eclipse.org/releases/juno)

滚动到底部的“Web、XML、Java EE 和 OSGi 企业开发”部分。

选择：

*   Eclipse Web 开发者工具
*   JavaScript 开发者工具
*   网页

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T09:44:28.093

您是否尝试转到 Window>Preferences，从左侧列表中选择“Javascript>Editor>Syntax Coloring”。并查看颜色是否设置为您喜欢的颜色。还要检查您的项目设置为什么。也许它被解释为另一种语言。

希望这可以帮助。

# node.js - node.js + socket.IO - 套接字没有重新连接？

> ID：14308170
> 
> 赞同：6
> 
> 时间：2013-01-13T21:07:47.567
> 
> 标签：node.js, sockets, websocket, socket.io

我知道 socket.io 具有用于重新连接和所有内容的内置功能，但是我认为它不起作用 - 正如我从其他人那里看到的那样，它也不适用于他们。

如果用户让他们的计算机进入睡眠状态，它会断开他们的连接，然后当他们重新打开它时，他们不再连接，因此他们在刷新页面之前不会收到任何通知或任何东西。也许这只是我做的不对？

```
var io = require('socket.io').listen(8080);
var users = {};

////////////////USER CONNECTED/////

console.log("Sever is now running");

io.sockets.on('connection', function (socket) { 

    //Tell the client that they are connected
    socket.emit('connected');

    //Once the users session is recieved
    socket.on('session', function (session) {

        //Add users to users variable
        users[socket.id] = {userID:session, socketID:socket};

        //When user disconnects
        socket.on('disconnect', function () { 

        //socket.socket.connect();

             var count= 0;
            for(var key in users){
                if(users[key].userID==session)++count;
                if(count== 2) break;
            }
            if(count== 1){
               socket.broadcast.emit('disconnect', { data : session});
            }

            //Remove users session id from users variable
            delete users[socket.id];
        }); 

        socket.on('error', function (err) {
            //socket.socket.connect();
        }); 
```

`socket.emit("connection")`需要在用户重新连接时调用，或者至少需要调用该事件中发生的事件。

也`socket.socket.connect();`不起作用，它返回错误并关闭套接字服务器并显示“连接不存在”错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-19T21:44:03.543

该问题与 io.connect 参数有关。

查看此客户端代码（它将尝试永远重新连接，尝试之间的最大延迟为 3 秒）：

```
 ioParams = {'reconnection limit': 3000, 'max reconnection attempts': Number.MAX_VALUE, 'connect timeout':7000}
 socketAddress = null
 socket = io.connect(socketAddress, ioParams) 
```

有两个与您的问题相关的重要参数：

*   重新连接限制 - 限制重新连接尝试之间的延迟时间上限。通常在服务器中断时它会变得越来越大
*   最大重新连接尝试次数 - 您想尝试多少次。默认值为 10。在大多数情况下，这就是客户端停止尝试的问题。

# c# - 在 GridControl.View 中绑定 IsEnabled 属性

> ID：14308171
> 
> 赞同：2
> 
> 时间：2013-01-13T21:07:51.647
> 
> 标签：c#, wpf, isenabled, caliburn, devexpress-wpf

我尝试`IsEnabled`在上下文菜单项中绑定属性。上下文菜单位于 Devexpress 中`GridControl.View`。

我认为问题出在 DataContext 中。barbutton 项正在网格的 DataContext 中搜索属性`HasPermissionDelete`。但这不是视图模型的数据上下文。我的财产`HasPermissionDelete`在 ViewModel 上。

我正在使用 caliburn.micro。

你能帮我修复这个绑定吗？

我的xml代码：

```
<dxg:GridControl.View>
    <dxg:TableView x:Name="gridTable" AllowSorting="True" NavigationStyle="Row" MultiSelectMode="Row" AutoWidth="True" AllowEditing="False" AllowFilterEditor="True" AllowDrop="True" AllowGrouping="True" ShowGroupPanel="False" AllowMoveColumnToDropArea="True" SelectedRowsSource="{Binding SelectedUsers}">
        <i:Interaction.Triggers>
            <i:EventTrigger EventName="RowDoubleClick">
                <cal:ActionMessage MethodName="Edit" />
            </i:EventTrigger>

            <i:EventTrigger EventName="Loaded">
                <cal:ActionMessage MethodName="InitializePrintableSource" >
                    <cal:Parameter Value="{Binding ElementName=gridTable}"></cal:Parameter>
                </cal:ActionMessage>
            </i:EventTrigger>
        </i:Interaction.Triggers>

        <dxg:TableView.RowCellMenuCustomizations>
            <dxb:BarButtonItem x:Name="btnDelete" Content="{lex:LocText Translations:Delete, Assembly=Prosa.Common.Modules.UserManagement}" IsEnabled="{Binding Path=HasPermissionDelete}"/>
        </dxg:TableView.RowCellMenuCustomizations>
    </dxg:TableView>
</dxg:GridControl.View> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T23:57:45.877

即使您使用 Caliburn Micro，您仍然可以回退到标准 XAML 绑定。我将假设您的 DevExpress DataGrid 位于一个简单的 Grid 中，它是您的 Page 或 UserControl 的根元素。所以，你会有这样的结构：

```
<Grid x:Name="root">

      <dxg:GridControl>
       ...
       (your GridControl.View and everything else here)
       ...
      </dxg:GridControl>
</Grid> 
```

因此，为了避免在按钮中使用 GridControl 的 DataContext，您可以绑定到根网格的 DataContext，在这种情况下，它就是对应的 ViewModel。像这样绑定你的按钮：

```
<dxb:BarButtonItem x:Name="btnDelete" Content="{lex:LocText Translations:Delete, Assembly=Prosa.Common.Modules.UserManagement}" 
IsEnabled="{Binding ElementName=root, Path=DataContext.HasPermissionDelete}"/> 
```

通过设置元素的名称（本例中为“root”），然后在绑定中引用它，您始终可以通过这种方式获得所需的数据上下文。您也可以绑定到没有名称的元素，但绑定表达式要复杂得多（您必须使用 RelativeSource 并选择元素类型）。

希望这能解决您的问题！

# javascript - 如何设置 grunt-mocha 以在全局泄漏时出错？

> ID：14308178
> 
> 赞同：1
> 
> 时间：2013-01-13T21:08:33.683
> 
> 标签：javascript, mocha.js, gruntjs

当被测代码全局泄漏对象时，我似乎无法弄清楚如何设置 grunt-mocha 以产生警告或错误。在浏览器中进行测试时，我注意到我有一些全局泄漏。但是，当我随后通过 grunt 运行我的测试套件时，没有报告任何泄漏。

我已经尝试了几件事来解决这个问题。[首先，我尝试根据grunt-mocha GitHub 页面](https://github.com/kmiyashiro/grunt-mocha)上的语法在我的 grunt.js 文件中设置我的“mocha”任务，如下所示

```
mocha: {
  all: {
    src: ['test/**/*.html'],
    options: {
      ignoreLeaks: false
    }
  } 
```

当这不起作用时，我尝试将我的 node_modules 目录中的 grunt-mocha 代码中的值手动更改为`false`. 这没有任何效果，但在此过程中，我发现 grunt-mocha 的工作原理是将测试结果写入临时文件，然后将它们读入并报告结果。我禁用了删除临时文件的代码部分并检查了它。它似乎不包含与全局泄漏相对应的任何错误。

最后，我尝试将 grunt-mocha 的测试报告器与 Mocha 的内置“规范”报告器进行比较，以查看报告接口的某些部分是否未实现或类似的东西。我没有看到任何明显的迹象表明不会报告全局泄漏，因为据我所知，它们被报告为正常错误。

我最初选择了 grunt-mocha，因为它是[Yeoman 项目](http://yeoman.io/)为其测试任务选择的。此外，我看到的从 grunt 运行 Mocha 的其他项目似乎更关注本地 Mocha 测试（例如，用于 Node.js 开发）而不是浏览器开发。

现在在浏览器中报告泄漏很好，因为我通常会在开发过程中更改我的代码并刷新浏览器。但是，我想最终使用持续集成服务器来运行测试套件。非常感谢任何帮助解决这个问题。

# java - 除了数据库默认位置之外，我如何在 android 中存储或获取 sqlite 数据库

> ID：14308179
> 
> 赞同：0
> 
> 时间：2013-01-13T21:08:36.500
> 
> 标签：java, android, database

我正在尝试从其他位置访问 sqlite 数据库，然后是 android 的默认位置，即**/data/data/packname/databases/**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:19:59.553

如果要使用不在默认路径中的数据库，只需使用[`ContextWrapper#openOrCreateDatabase()`](http://developer.android.com/reference/android/content/Context.html#openOrCreateDatabase%28java.lang.String,%20int,%20android.database.sqlite.SQLiteDatabase.CursorFactory%29). （请理解，执行此操作时不能使用 SQLiteOpenHelper 类。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:06:50.983

如果你想使用`SQLiteOpenHelper`，你可以实现你自己的`context`类，覆盖`getDatabasePath()`指向你自己的目录。

普通的 android 应用程序具有相对于应用程序文件夹的本地数据库文件。通过使用覆盖“getDatabasePath()”的客户上下文，数据库现在相对于 sd 卡上的不同目录。

有关详细信息和代码示例，请参阅[sqliteopenhelper-with-fully-qualified-db-path-name](https://stackoverflow.com/questions/5332328/sqliteopenhelper-problem-with-fully-qualified-db-path-name/9168969#9168969)

# javascript - 在 DOM 中存储数据

> ID：14308188
> 
> 赞同：5
> 
> 时间：2013-01-13T21:09:50.240
> 
> 标签：javascript, performance, dom, custom-data-attribute

我有一个书籍清单，我想针对每本书存储数据，例如价格、数量、id、分类 ID、尺寸、重量等。

我正在考虑通过使用 data- 属性扩展代表列表中每本书的 li 元素来将所有这些存储在 dom 中。然后可以使用 javascript 直接使用这些数据。

但是我读到访问数据属性在性能方面很慢。此外，我可以有同一本书的多个实例，所以我有点担心 html 中的膨胀。

另一种方法是使用 JS 对象来存储每本书的数据。

所以我的问题是在前端、DOM 或 JavaScript 中存储数据的最佳实践是什么？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-13T21:17:36.550

`data-`属性通常更多地用作将数据获取到您的 JavaScript（即从您的服务器端模板）中的一种方式，而不是存储数据的运行时位置。保存活动数据的更好地方是 JavaScript 对象，尤其是在脚本生命周期内频繁访问或操作它的情况下。

这更符合 MVC 方法，其中数据存在于您的模型中，但可能在您的视图中表示。出于这个原因，一些较新的 MVC 框架（如 AngularJS）在两者之间提供了自动双向绑定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T21:38:44.867

选择实际上取决于您的应用程序架构和应用程序中的功能类型。如果您正在构建单页应用程序，我发现使用构造良好的 json 对象和良好的模板插件可以在功能方面提供更大的灵活性。

我发现在 json 中的 id 上索引您的数据，然后将该 id 存储在“data-”元素中，为您提供了一种很好的方式来响应浏览器事件（点击等），而无需搜索 JSON 结构。拥有 JSON 结构还可以更轻松地执行排序列表和其他全局操作等操作，而无需从 DOM 重建数据。当您使用类似 MVC 的框架或实现自己的“可观察”数据结构时，此方法也更好。

另一方面，如果您主要使用服务器端代码，并且页面中只有基本功能利用您的“数据”数据（例如在点击时显示书籍详细信息或类似的简单内容），那么只需使用“data-”属性来存储额外的细节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T21:15:08.397

`DOM`将其存储在元素中和将数据保存为`JavaScript`对象之间的区别在于，在第一种情况下，您拥有数据和`DOM`元素直接相关，而在第二种情况下，您需要以某种方式保留相似的数据和`DOM`结构以保持数据相关到`DOM`. 第二种情况听起来更容易出错，因为您必须确保数据中的每个更改`DOM`都反映在数据中（添加/删除/修改元素），并且数据中的每个更改都反映在`DOM`（添加/删除/修改数据成员）。

在`data-*`属性数据的情况下，直接从 DOM 访问，因此两者已经绑定在一起，至少在我看来，这是一个更好的做法。但是，正如评论中所提到的，`data-*`属性会带来 DOM 检索开销。

在性能方面，两者都需要将数据存储在内存中，无论是作为`DOM`元素属性还是作为`JavaScript`对象。检索`DOM`元素属性实际上更昂贵，但更方便。渲染不受`data-*`属性影响，因为它们没有任何功能意义。

# android - Android 编程 - 多个列表视图的 onitemclicklistener 不起作用

> ID：14308192
> 
> 赞同：0
> 
> 时间：2013-01-13T21:10:07.070
> 
> 标签：android, android-listview, onitemclicklistener, onitemclick

在我的活动中，我创建了七个列表视图，并在同一个活动中使用 viewpager 在它们之间滑动。然后我有一个 sqlite 数据库填充每个列表视图。我的问题是 onitemclicklistener 不起作用，没有错误，代码执行良好，但列表项点击没有任何反应。我通过添加 toast 显示消息等对其进行了测试，但列表项点击没有任何反应。

我怀疑问题是我没有像传统方法那样从 xml 布局中获取列表视图，因此 itemclicklistener 方法略有不同，但是我不知道以这种方式使用列表视图时使用什么方法，并且没有其他操作系统线程我已经seen 以这种方式创建列表视图。如果有人可以请阐明一些我会非常感激。提前致谢。

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        mContext = this;
        setContentView(R.layout.activity_schedule);

        ListView listview1 = new ListView(mContext);
        ListView listview2 = new ListView(mContext);
        ListView listview3 = new ListView(mContext);
        ListView listview4 = new ListView(mContext);
        ListView listview5 = new ListView(mContext);
        ListView listview6 = new ListView(mContext);
        ListView listview7 = new ListView(mContext);

        Vector<View> pages = new Vector<View>();

        pages.add(listview1);
        pages.add(listview2);
        pages.add(listview3);
        pages.add(listview4);
        pages.add(listview5);
        pages.add(listview6);
        pages.add(listview7);

        ViewPager vp = (ViewPager) findViewById(R.id.viewpager);
        PageAdapter adapter = new PageAdapter(mContext,pages);
        vp.setAdapter(adapter);

        db.open();
        scheduleAdapter = new ScheduleAdapter(ScheduleActivity.this, db.getMonday(),CursorAdapter.NO_SELECTION );
        listview1.setAdapter(scheduleAdapter);      
        db.close();

        db.open();
        scheduleAdapter = new ScheduleAdapter(ScheduleActivity.this, db.getTuesday(),CursorAdapter.NO_SELECTION );
        listview2.setAdapter(scheduleAdapter);      
        db.close();

        db.open();
        scheduleAdapter = new ScheduleAdapter(ScheduleActivity.this, db.getWednesday(),CursorAdapter.NO_SELECTION );
        listview3.setAdapter(scheduleAdapter);      
        db.close();

        db.open();
        scheduleAdapter = new ScheduleAdapter(ScheduleActivity.this, db.getThursday(),CursorAdapter.NO_SELECTION );
        listview4.setAdapter(scheduleAdapter);      
        db.close();

        db.open();
        scheduleAdapter = new ScheduleAdapter(ScheduleActivity.this, db.getFriday(),CursorAdapter.NO_SELECTION );
        listview5.setAdapter(scheduleAdapter);      
        db.close();

        db.open();
        scheduleAdapter = new ScheduleAdapter(ScheduleActivity.this, db.getSaturday(),CursorAdapter.NO_SELECTION );
        listview6.setAdapter(scheduleAdapter);      
        db.close();

        db.open();
        scheduleAdapter = new ScheduleAdapter(ScheduleActivity.this, db.getSunday(),CursorAdapter.NO_SELECTION );
        listview7.setAdapter(scheduleAdapter);      
        db.close();

         listview1.setOnItemClickListener(new ListView.OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) { 

                }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:32:12.233

根据您的描述，我了解到这些列表是在您启动应用程序时显示的。

position 参数保存用户在（屏幕）列表上单击的位置。

您是否尝试将它与开关盒一起使用？

我的意思是这样的：

```
list.setOnItemClickListener(new OnItemClickListener(){
                  public void onItemClick( AdapterView <?> parent, View view, int   
                                           position,long id){

                       switch(position){
                            case 0:
                           // write what you need here when the user clicks on the first list item
                              break;
                            case 1:
                           // write what you need here when the user clicks on the 2nd list item 
                               break;
                       }
                  }
               }; 
```

希望对你有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:32:24.670

我不太确定为什么当您在 listview1 中按下某些东西时没有调用 itemClicklistener，但我认为这不是最大的问题。

在 1 个活动中添加 7 个列表视图，并且连续打开和关闭数据库 7 次，你的开局很糟糕。

我建议您从应用程序 Android UI 模式开始：[https ://play.google.com/store/apps/details?id=com.groidify.uipatterns](https://play.google.com/store/apps/details?id=com.groidify.uipatterns)

在那里，您会发现一个充满查看器和选项卡示例的页面。我建议你拿杰克沃顿那一个。

你想用 Fragments 来做这件事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T21:33:48.910

在您的 ListFragment 中，您应该扩展 ListFragment，然后使用 onListItemClick，如下所示：

```
public class ArrayListFragment extends ListFragment {

@Override                               
        public void onActivityCreated(Bundle savedInstanceState) {
            super.onActivityCreated(savedInstanceState);
            setListAdapter(new ArrayAdapter<String>(getActivity(),
                    android.R.layout.simple_list_item_1, Listnames.TITLES));
        }

        @Override
        public void onListItemClick(ListView l, View v, int position, long id) {
            Log.i("FragmentList2", "Item clicked: " + id);

            String item = (String) getListAdapter().getItem(position);

            Intent intent = new Intent(getActivity(), SearchableActivity.class);
            intent.putExtra("item", item);
            Toast.makeText(getActivity(), item, Toast.LENGTH_LONG).show();
//          startActivity(intent);
        }

    } 
```

# c - 如何正确链接程序与 libperl.so

> ID：14308195
> 
> 赞同：2
> 
> 时间：2013-01-13T21:10:32.553
> 
> 标签：c, perl

如何正确链接 libperl.so

我使用 Fedora Core 16 并尝试使用嵌入 perl 的方式编译程序：

```
gcc -W -Wall -g -D_FILE_OFFSET_BITS=64 -D_LARGEFILE64_SOURCE -I. -I/usr/include -I/usr/lib/include -I/usr/lib/perl5/CORE -c program.c
gcc -L/lib -L/usr/lib/perl5/CORE -lperl -o program.run program.o 
```

尝试运行程序后，我收到以下消息：

```
error while loading shared libraries: libperl.so: cannot open shared object file: No such file or directory 
```

如果执行以下命令'ldd program.run'然后它输出到控制台

```
ldd ./program.run 
    linux-gate.so.1 =>  (0xb7751000)
    libperl.so => not found
    libc.so.6 => /lib/libc.so.6 (0x4eea5000)
    /lib/ld-linux.so.2 (0x4ee80000) 
```

是的，我可以设置 LD_LIBRARY_PATH 环境变量并且程序将可以工作，但是如果我对“/usr/bin/perl”执行相同的命令，则会在不设置特定环境变量的情况下找到库，例如

```
ldd `which perl`
    linux-gate.so.1 =>  (0xb77f4000)
    libperl.so => /usr/lib/perl5/CORE/libperl.so (0xb767b000)
    libresolv.so.2 => /lib/libresolv.so.2 (0x4f22f000)
    libnsl.so.1 => /lib/libnsl.so.1 (0x42eaf000)
    libdl.so.2 => /lib/libdl.so.2 (0x4f055000)
    libm.so.6 => /lib/libm.so.6 (0x4f085000)
    libcrypt.so.1 => /lib/libcrypt.so.1 (0x41ee6000)
    libutil.so.1 => /lib/libutil.so.1 (0x42ecc000)
    libpthread.so.0 => /lib/libpthread.so.0 (0x4f05c000)
    libc.so.6 => /lib/libc.so.6 (0x4eea5000)
    /lib/ld-linux.so.2 (0x4ee80000)
    libfreebl3.so => /lib/libfreebl3.so (0x42492000) 
```

如何正确链接程序与 libperl.so

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T21:13:58.570

添加`-Wl,-rpath -Wl,/usr/lib/perl5/CORE`（链接时）应该会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T21:13:21.520

您需要`LD_LIBRARY_PATH`在运行时设置动态链接器才能找到`libperl`：

```
LD_LIBRARY_PATH=/usr/lib/perl5/CORE ./program 
```

# c# - 从网络配置中读取连接字符串

> ID：14308198
> 
> 赞同：0
> 
> 时间：2013-01-13T21:10:53.663
> 
> 标签：c#, .net

我正在使用 Visual Studio 2012，并且正在使用 Framework 4.5 构建 Web 应用程序。
我想将我的连接字符串保存在网络配置中并从那里读取。
由于某种原因，我无法阅读它。
网络配置

```
<connectionStrings>
    <add name="AdminConnection"     connectionString="DataSource=10.0.0.20;InitialCatalog=MailDB;PersistSecurityInfo=True;UserID=s      a;Password=********;"/> 
```

编码

```
using System.Configuration;
string connectionString = System.Configuration.ConfigurationManager.AppSettings["AdminConnection"]; 
```

我在配置管理器上遇到错误，我尝试了各种变体。谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:13:39.580

你应该使用：

```
string connectionString = 
      ConfigurationManager.ConnectionStrings["AdminConnection"].ConnectionString; 
```

您的代码正在尝试从不存在的`appSettings`部分读取，这就是您收到错误的原因。

`connectionStrings`配置文件中的部分被反序列化到`ConnectionStrings`集合中，而不是`AppSettings`集合中（该`appSettings`部分被反序列化到集合中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:12:59.017

那是不对的。它存储在您的`ConnectionStrings`而不是您的`AppSettings`. [有关如何：阅读连接字符串的详细信息，请参阅 MSDN](http://msdn.microsoft.com/en-us/library/ms178411%28v=vs.100%29.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T21:14:42.167

`ConfigurationManager.AppSettings`在你的`<appSettings>`; 连接字符串在您的`ConfigurationManager.ConnectionStrings`.

# jquery - li jQuery 动画

> ID：14308200
> 
> 赞同：0
> 
> 时间：2013-01-13T21:11:41.337
> 
> 标签：jquery

拜托，有人可以帮助我吗？我无法从 li 菜单项调整 #top 的大小。这是html代码：

```
<div id="top"></div>
<div id="wrapper">
<div id="header">
<div id="topheader"></div>
<div id="baseheader">
<div id="logo"><img src="images/logo.png" width="260" height="131" /></div>
<div id="contentmenu"><div id="menu">
<ul id="nav">
<li id="nav1"><a href="#">ESTUDIO</a></li>
<li id="nav2"><a href="#">PORTFOLIO</a></li>
<li id="nav3"><a href="#">SERVICIOS</a></li>
<li id="nav4"><a href="#">PRESUPUESTO</a></li>
<li id="nav5"><a href="#">CONTACTO</a></li>
</ul>
</div></div>
</div>
</div> 
```

和这个jQUERY

```
$("#nav li[id='nav4']").live('click', function(e) {
$("#top").animate({height:114});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:28:00.260

我建议[使用 .on()](http://api.jquery.com/on/)而不是[.live()](http://api.jquery.com/live/)，“从 jQuery 1.7 开始，不推荐使用 .live() 方法”

```
<script type="text/javascript"> 
 $(document).ready(function(){ 
  $("#nav").on('click', '#nav4', function () {
    $("#top").animate({height:114});
     return false;
   });
 });
</script> 
```

[http://jsfiddle.net/z4KrL/9/](http://jsfiddle.net/z4KrL/9/)

并且不要使用所以菜单 ID 的使用类，[例如](http://css-tricks.com/the-difference-between-id-and-class/)

更新：

*   将代码从上方复制到页面底部
*   添加指向 Jquery 库的链接`<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>`
*   删除外部链接`topheight.js`

# c++ - 如何将现有的 CMake git repo 作为子模块包含在我自己的 CMake 项目中？

> ID：14308206
> 
> 赞同：5
> 
> 时间：2013-01-13T21:12:44.913
> 
> 标签：c++, linux, build, cmake, openkinect

我正在尝试使用[OpenKinect](https://github.com/OpenKinect/libfreenect)项目编写一些程序。我想将 OpenKinect 的主分支作为子目录添加到我的项目源中。但是，如果你查看 OpenKinect 自己的 CMake，那里的东西太多了，我不需要所有东西。那里有某些选项，它们被设置为 ON 或 OFF，如下所示：

```
OPTION(BUILD_AUDIO "Build audio support" OFF)
OPTION(BUILD_REDIST_PACKAGE "Build libfreenect in a legally-redistributable manner (only affects audio)" OFF)
OPTION(BUILD_EXAMPLES "Build example programs" ON)
OPTION(BUILD_FAKENECT "Build fakenect mock library" ON)
OPTION(BUILD_C_SYNC "Build c synchronous library" ON)
OPTION(BUILD_CPP "Build C++ Library (currently header only)" ON)
OPTION(BUILD_CV "Build OpenCV wrapper" ON)
OPTION(BUILD_AS3_SERVER "Build the Actionscript 3 Server Example" OFF)
OPTION(BUILD_PYTHON "Build Python extension" ON)
IF(PROJECT_OS_LINUX)
    OPTION(BUILD_CPACK "Build an RPM or DEB using CPack" ON)
ENDIF(PROJECT_OS_LINUX) 
```

在不对 OpenKinect 文件进行任何重大更改的情况下（以便我可以在`git pull`需要时随时更改），我如何仅将某些部分（例如`C++ wrapper`和`OpenCV bindings`）导入到我自己的 CMake 项目中？如果我完全重写 CMake 文件，我想复制某些不依赖于其他目录的目录。我将无法再使用 git，但这将是一个快速修复。但是我遇到了奇怪的错误，比如“stdexcept 没有在这个范围内声明”，这是没有意义的，因为它是一个标准的 gc++ 库。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-14T08:59:14.070

If you simply want to enable/disable some parts of that library, you can simply set the appropriate options before calling `ADD_SUBDIRECTORY`.

Simply use the same OPTION commands as in the library's `CMakeLists.txt` but set them `ON`/`OFF` as you need. Of course, oyu are free to change/choose the describing string as you like.

Alternatively (and if options have a different value than true/false), you can use the `SET(.... CACHE ... )`

e.g.

```
SET(BUILD_CPP TRUE CACHE BOOL "Build C++ Library (currently header only)") 
```

Similar question: [Override option in CMake subproject](https://stackoverflow.com/questions/14061605/override-option-in-cmake-subproject)

# java - 线相交多边形不起作用

> ID：14308209
> 
> 赞同：0
> 
> 时间：2013-01-13T21:12:52.030
> 
> 标签：java, math, vector, libgdx

我正在使用 libgdx 编写一个小型太空游戏，飞船发射激光，我需要计算它何时（如果有的话）与多边形（小行星）相交。这样我就可以阻止激光穿过物体，并实际与它们发生碰撞。我的代码有时似乎可以工作，而在其他时候则完全失败。我不知道是什么导致它失败，我很确定这不是我的 poly 定义错误，因为有时它会在边缘工作，有时不会，没有一致性。

我检查了我的射线的痕迹（严格来说是一条线），它是正确的，所以不是那样的。这是代码，我将尝试解释我之后所做的事情。

```
//Beam Collisions

//If the beam isn't being fired, return
if(!active) return;

//Storing all the points to be checked on the beam, I've checked the all seem accurate, and have draw a line between them and they match the laser.   
List<Vector2> beamPoints = new ArrayList<Vector2>();

//Step allows me to reduce the number points I test when it finally works
int step = 1;
for(int n=0;n<maxHeight;n+=step){

        //Rotation is the rotation of the ship. I add 90 to it so the angle of my vector is from the x-axis. 
        //shipX is the world coords of the ship. x is the relative start point of the laser to the ship.
        //shipX refers to the centre of the ship, not the corner of the graphic.
        beamPoints.add(
            new Vector2(shipX+x+(float)(n*Math.cos(Math.toRadians(rotation+90))),
                  shipY+y+(float)(n*Math.sin(Math.toRadians(rotation+90)))));
}

//Here I cycle through the entities to test if they collide. Currently the only entities are asteroids.   
for(Entity e : entities){
   //Skip over the entity if it's outside the render range or it has no geometry.
   if(!e.inRenderRange || e.getGeometry()==null) continue;

        //A list to store all the vertices of that asteroids geometry.
        List<Vector2> verts = new ArrayList<Vector2>();
        for(Vector2 v : e.getGeometry()){

                //Determining the x and y of the vertice to store. e.x is the asteroids world coords, I subtract the half the imageWidth because it's position is stored as the centre of the graphic.
                //I then add the relative x and y of the vertex.
                //I've turned off rotation for the asteroids, so that's not a problem.
                float nx = (e.x-e.imageWidth/2)+v.x;
                float ny = (e.y-e.imageHeight/2)+v.y;

                verts.add(new Vector2(nx,ny));

   }

    //Testing each of the points on the beam to see if there are in the poly.
    for(int j=0;j<beamPoints.size();j++){

        //Using Intersector, a class in Libgdx, I can safely assume this is working fine. 
        if(Intersector.isPointInPolygon(verts, beamPoints.get(j))){

            /Changing the height (should be labelled length) of the beam to be that at which it collides. Step is one, so doesn't matter for now.
            height = j*step;
            break;
      }
   }

} 
```

我还应该从下面的图片中指出，我所说的激光是指明亮的核心，我没有打扰它的发光，这没有错，我只是还没做。

![它工作的例子](../Images/7c7a34b66fd30649387652bc5bf6d36a.png) ![失败的例子](../Images/1c5d4a6298fdedee7bc2a74ddf05d6df.png)

我希望这是足够的代码，如果还有什么我可以提供的，请询问；我很感激你能提供的任何帮助。

祝大家欢呼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:20:20.450

您是否*真的*在生产线上生成大量离散点，然后通过检查来测试这些点中的每一个`inPolygon`？这不是解决这个问题的好方法。

您的多边形由线段组成。您真正需要做的就是测试一条线段是否与您的光束相交，然后找到具有最近交点的实体。

关于线段交叉点的计算有很多信息。

这是来自 SO： [你如何检测两条线段相交的位置？](https://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect/565282#565282)

# vb.net - 将列表中对象的单个成员移动到数组中以用于计算

> ID：14308215
> 
> 赞同：0
> 
> 时间：2013-01-13T21:13:17.567
> 
> 标签：vb.net, multidimensional-array, foreach, generic-list, toarray

我`List`在 Visual Basic 2010 中有一个对象（Appliance 作为 String，KwHHr 作为 Double）， applianceListReturn 。每个对象都有两个成员。我想从每个对象中取出一个相同类型的成员（KwHHr），并从`array`这些单个成员中提取一个。我是 VB 新手，这并不像第一次出现那么容易。我试图使用 `for 每个循环来实现这一点，但它只返回一个值。这是我的代码：

```
 Imports System.Collections.Generic
    Public Class Form1
    Private ApplName As String '= Nothing
    Private ApplKwCost As Double
    Dim ConvAppliance As String
    Dim ConvKwHHr As String
    Public KwhCost As Double = 0

    Dim ApplianceCost As New ArrayList()

    'create structure for object in list
    Private Structure Appliance
        'public Variables

        Public Appliance As String
        Public KwHHr As Double

        ' provide get methods to allow return of objects in a formatted way
        Public ReadOnly Property ApplianceInfo() As String
            Get
                Return Appliance & " " & KwHHr
            End Get

        End Property
        Public ReadOnly Property ApplianceInfo2() As String
            Get
                Return Appliance & " " & KwHHr
                Return KwHHr
            End Get

        End Property

        Public Overrides Function ToString() As String
            Return ApplianceInfo2
        End Function
    End Structure

    Private ApplianceObj As Appliance
    Dim arraylistReturn As New List(Of Appliance)

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        ' choose KwHr price
        KwCost.Text = KwhCost

        ' add appliance data to list
        ApplianceObj.Appliance = "Washer"
        ApplianceObj.KwHHr = 1.25

        arraylistReturn.Add(New Appliance With {.Appliance = ApplianceObj.Appliance, .KwHHr = ApplianceObj.KwHHr})

        ApplianceObj.Appliance = "Dryer"
        ApplianceObj.KwHHr = 1.3

        arraylistReturn.Add(New Appliance With {.Appliance = ApplianceObj.Appliance, .KwHHr = ApplianceObj.KwHHr})

        ApplianceObj.Appliance = "Toaster"
        ApplianceObj.KwHHr = 1.54

        arraylistReturn.Add(New Appliance With {.Appliance = ApplianceObj.Appliance, .KwHHr = ApplianceObj.KwHHr})

    End Sub

    Private Sub ApplAdd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ApplAdd.Click
        KwhCost = KwCost.Text

        Dim newArray() As Double = {1.25, 1.3, 1.54}

        'enter appliance data
        ApplianceObj.Appliance = TxtBxApplAd.Text
        ApplianceObj.KwHHr = TextBoxKwhUse.Text
        ApplianceCost.Add(ApplianceObj.KwHHr)

        'displays added appliances in applist listbox
        displayAppliance(ApplianceObj)

        'add applianceobj entries to arraylistreturn

        arraylistReturn.Add(New Appliance With {.Appliance = ApplianceObj.Appliance, .KwHHr = ApplianceObj.KwHHr})

        For Each App As Appliance In arraylistReturn
            ArrayDispBox.Items.Add(App.ApplianceInfo.ToString())
        Next

        ReDim Preserve newArray(arraylistReturn.Count())
        'count items in list
        'AppList.Items.Add(arraylistReturn.Count().ToString)

        newArray(arraylistReturn.Count()) = TextBoxKwhUse.Text

        Dim sum As Double = 0
        For int As Integer = 0 To newArray.GetUpperBound(0)
            sum += newArray(int)
            TextBoxTotal.Text = sum.ToString()
        Next int
    End Sub

    Private Sub displayAppliance(ByVal App As Appliance)
        AppList.Items.Add(App.ApplianceInfo2)
    End Sub

    ' get selected appliances for calculation
    Private Sub ArrayDispBox_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ArrayDispBox.SelectedIndexChanged
        AppList.Items.Add(arraylistReturn.Item(ArrayDispBox.SelectedIndex))
    End Sub
End Class 
```

我希望这是有道理的。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T08:49:27.280

您可以使用 LINQ to Object 来实现：

```
Dim results As Array(Of String) = applianceListReturn.Select(Function(a) a.KwHHr).ToArray() 
```

# ruby-on-rails - 如何将变量传递到此部分以用作计数器？

> ID：14308216
> 
> 赞同：1
> 
> 时间：2013-01-13T21:13:17.957
> 
> 标签：ruby-on-rails, ruby

```
<div class="postSlideshowDots">
                <%for i in @post.images%>
                 <%=render :partial => "dots", :locals => {:image => i }%>     
                <%end%>
</div> 
```

我还想传入一个变量（当它进入时=0）用作计数器。我读到已经内置了一个“partialname_counter”，但这给了我一个错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T21:16:24.027

使用`<%= render :partial => "dots", :collection => @post.images %>`，你会得到一个`dots_counter`在部分中调用的变量。您还需要更改您的部分以使用`dots`而不是`image`作为变量。

最后，不要`for..in`在 Ruby 中使用，它是非惯用的，并且在闭包和作用域方面有一些不好的行为。采用`.each`

# java - SWT TableViewer 具有一个列或表项，其中多个按钮充当操作

> ID：14308221
> 
> 赞同：0
> 
> 时间：2013-01-13T21:13:44.200
> 
> 标签：java, swt, jface, tableviewer

我正在尝试在 SWT 中呈现具有以下行的下表：

名称1 | anotherProperty |BUTTON1(EDIT) BUTTON2(REMOVE) BUTTON3(DEACTIVATE)

使用[SWT - Tableviewer 将删除按钮添加到表中的列中，](https://stackoverflow.com/questions/12480402/swt-tableviewer-adding-a-remove-button-to-a-column-in-the-table)我只能逐列呈现一个按钮。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T10:56:03.547

与添加单个按钮的方式相同，您也可以添加多个按钮，但对于这些按钮，您将需要一个额外的容器。您可以尝试以下方法：

```
col.setLabelProvider(new ColumnLabelProvider() {
  @Override
  public void update(ViewerCell cell) {
     TableItem item = (TableItem) cell.getItem();

     Composite buttonPane = new Composite(getTable(), SWT.NONE);
     buttonPane.setLayout(new FillLayout());

     Button button = new Button(buttonPane,SWT.NONE);
     button.setText("Edit");

     button = new Button(buttonPane,SWT.NONE);
     button.setText("Remove");

     button = new Button(buttonPane,SWT.NONE);
     button.setText("Deactivate");

     TableEditor editor = new TableEditor(getTable());
     editor.grabHorizontal  = true;
     editor.grabVertical = true;
     editor.setEditor(buttonPane, item, columnIndex);
     editor.layout();
     }
  }); 
```

# javascript - 如果显示另一类，则更改一个类的边距：无

> ID：14308222
> 
> 赞同：-4
> 
> 时间：2013-01-13T21:13:45.107
> 
> 标签：javascript, jquery

我需要设置一个类似于以下的 if 语句：

如果`divID1`元素`style="display:block"`则`divCLASS1`添加 CSS `style="margin-right:0px"`。

```
<script type="text/javascript">
<!--
           if ($('#w2btoTop').element.style('display') == 'block')
    $(".livehelp").css('margin-right','0px');
}
//-->
</script> 
```

我不知道我在做什么，但很想看看我是否接近解决这个问题！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T21:15:09.700

以下应该有效：

```
if ($("#w2btoTop").css("display") === "block") {
    $(".livehelp").css("margin-right", "0px");
} 
```

我建议您事先阅读[官方 jQuery 文档。](http://api.jquery.com/css/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:21:43.123

这是检查元素可见性的一种方法：

```
$('#w2btoTop').is(":visible") // true if visible
$('#w2btoTop:visible').length // > 0 if visible 
```

# html - 如何在 HTML knitr 文档的头部添加 javascript？

> ID：14308240
> 
> 赞同：7
> 
> 时间：2013-01-13T21:15:51.133
> 
> 标签：html, r, markdown, knitr

我使用 knitr 的 Rmd 版本，因为它比 Rhtml 更简洁。我目前正在做

```
<script src="http://d3js.org/d3.v2.min.js"></script> 
```

在 Rmd 文档的正文中，但这应该在由`markdownToHTML`. 可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T17:08:45.380

您可以将脚本标签放在标签内。然后使用这样的标签：

```
<SCRIPT language="JavaScript" SRC="jxt1.js"></SCRIPT> 
```

您在那里缺少语言类型，因此代码可以理解他将要“阅读”哪种语言

查看此处 ( [http://www.pageresource.com/jscript/jxtern.htm](http://www.pageresource.com/jscript/jxtern.htm) ) 了解更多详细信息

# algorithm - 编程：给出十进制表示为 3 的所有此类数字的计数

> ID：14308243
> 
> 赞同：2
> 
> 时间：2013-01-13T21:16:09.623
> 
> 标签：algorithm, math, data-structures

给定一个数字 n，编写一个函数，返回从 1 到 n 的数字的计数，这些数字在十进制表示中不包含数字 3

解决这个问题的最佳方法是什么。

我在幼稚中使用的方法，即 nlogn（通过查看复杂性很容易猜到方法:)）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T09:01:21.070

以下算法非常有效地计算从 0 到 (n-1) 的整数个数，而十进制表示中没有“3”。（我将区间从 1 .. n 修改为 0 .. n-1 只是为了稍微简化以下计算。）

*（我不是复杂度计算方面的专家，但我认为这个算法的复杂度是`O(log n)`，因为它对 的每个数字执行固定数量的步骤`n`。）*

第一个观察结果是，最多 d 位的整数（即区间 0 .. 10 ^d -1 中的数字）在十进制表示中没有数字 3 正好是 9 ^d，因为对于每个数字你有 9可能的选择 0,1,2,4,5,6,7,8,9。

现在让我用 5 位数字 n = a [4] a [3] a [2] a [1] a [0]演示该算法。

我们分别计算间隔的十进制表示中没有“3”的整数的数量

*   我[0] : 一[4]一[3]一[2]一[1] 0 <= 我 < 一[4]一[3]一[2]一[1]一[0]
*   我[1] : 一[4]一[3]一[2] 0 0 <= 我 < 一[4]一[3]一[2]一[1] 0
*   我[2] : 一[4]一[3] 0 0 0 <= 我 < 一[4]一[3]一[2] 0 0
*   我[3] : 一[4] 0 0 0 0 <= 我 < 一[4]一[3] 0 0 0
*   我[4] : 0 0 0 0 0 <= 我 < 一个[4] 0 0 0 0

在十进制表示中没有“3”的区间 I [j]中的整数个数是

*   0，如果较高值的数字 a [j+1]， a [j+2]，... 之一等于 3，否则：
*   a [j] * 9 ^j，如果 0 <= a [j] <= 3，（第 j^(个数字有)[j]个选择，所有低值数字有 9 个选择），
*   (a [j] - 1) * 9 ^j，如果 aj > 3 （因为 3 不是第 j 位的有效选择^）。

所以我们有以下功能：

```
/*
 * Compute number of integers x with 0 <= x < n that do not
 * have a 3 in their decimal representation.
 */
int f(int n)
{
    int count = 0;
    int a;      // The current digit a_j
    int p = 1;  // The current value of 9^j

    while (n > 0) {
        a = n % 10;
        if (a == 3) {
            count = 0;
        }
        if (a <= 3) {
            count += a * p;
        } else {
            count += (a-1) * p;
        }
        n /= 10;
        p *= 9;
    }

    return count;
} 
```

# python-2.7 - Jinja2 无法再找到模板 TemplateNotFound

> ID：14308244
> 
> 赞同：2
> 
> 时间：2013-01-13T21:16:20.173
> 
> 标签：python-2.7, flask, jinja2

我正在玩我的配置文件，然后我保存了一些东西，然后突然在我的本地主机中找不到我的模板。

它拒绝在我的 app/templates 文件夹中找到 index.html 或任何模板。

我的应用程序名称已更改，但我将其更改回来，它仍然无法修复错误。我改变了我的 basedir 变量和 secret_key 这与它有什么关系吗？因为我还原了这些更改，但它仍然找不到任何东西。就像魔术一样，突然停止工作。在 jinja 中调度 jinjaloader 和 get_source() 函数似乎失败了。堆栈跟踪：

```
jinja2.exceptions.TemplateNotFound
return _render(ctx.app.jinja_env.get_or_select_template(template_name_or_list),
return self.get_template(template_name_or_list, parent, globals)
return self._load_template(name, self.make_globals(globals))
template = self.loader.load(self, name, globals)
source, filename, uptodate = self.get_source(environment, name)
raise TemplateNotFound(template) 
```

Jinja2 在哪里找出我的模板文件夹在哪里？怎么再也找不到了？

你在哪里设置 jinja 模板的默认文件夹？？？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-13T21:29:04.260

好吧，显然，当我更改应用程序的名称时... app_name = 'app'，因为我的模板文件夹位于 app/application/templates 中，我应该像以前一样命名我的 app_name = 'application'（我没有'没有意识到这个**名字**是返回应用程序而不是应用程序）。

显然，jinja2 在初始化 Flask() 时会查看您的 app_name ... 太奇怪了，我没有看到它的文档。

# c# - 占位符内的 ascx 控件如何读取其父控件/页面的属性

> ID：14308253
> 
> 赞同：0
> 
> 时间：2013-01-13T21:16:48.220
> 
> 标签：c#, asp.net, dotnetnuke

我有一个父 ascx 控件，它有一个隐藏字段和一些定义的公共属性。它还有一个占位符，用于在运行时插入一些动态子控件。所有子控件都继承自父控件，因此这些公共属性可供它们使用。这是父级的 ascx 代码；

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="MyAccount.ascx.cs" Inherits="MyAccount.UI.MyAccount" %>

<asp:hiddenField id="hidAcctID" value="-1" runat="server" />
<div id="myaccountcontainer">
  <asp:PlaceHolder ID="phdContent"  runat="server"></asp:PlaceHolder>
</div> 
```

这是父母的代码

```
 partial class MyAccount : PortalModuleBase
    {
        #region Public Properties
        public string SharedResourcesFile 
        { 
            get 
            { 
                return ControlPath + "App_LocalResources/SharedResources.resx"; 
            } 
        }

        public int AccountId
        {
            get
            {
                int id;
                Int32.TryParse(this.hidAcctID.Value, out id);
                return id > 0 ? id : -1;
            }
            set
            {
                hidAcctID.Value = value.ToString();
            }
        }
 ... 
```

我遇到的第一个问题是当我尝试从子控件访问 AccountId 属性时，代码正在子控件而不是父控件中查找隐藏字段。我对此的解决方案之一是对每个孩子都这样做；

```
 var hidfld = (HiddenField)this.Parent.FindControl("hidAcctID");
 int id = Convert.ToInt32(hidfld.Value); 
```

这工作正常，但它有很多重复的代码

第二个问题：父控件和资源文件位于

> www.example.com/DesktopModules/ModuleName/Parent.ascx
> 
> www.example.com/DesktopModules/ModuleName/App_LocalResources/SharedResources.resx

而子控件位于

> www.example.com/DesktopModules/ModuleName/ChildControls/Child1.ascx

当我从子控件访问 SharedResourcesFile 属性（返回资源文件的位置）时，返回的路径还包括 ChildControls 文件夹，该文件夹不是资源文件所在的位置。同样，我可以通过将子控件与父控件放在同一文件夹中来解决此问题。

有没有办法解决上述问题？谢谢

# c++ - 在 .mm 文件中但不在 .h 中找到 C++ 标准库（Xcode 4.5 LLVM GCC 4.2）

> ID：14308256
> 
> 赞同：1
> 
> 时间：2013-01-13T21:17:17.700
> 
> 标签：c++, iphone, ios6, xcode4.5, llvm-gcc

我正在尝试在使用 LLVM GCC 4.2 编译的 Xcode 4.5 中开发的 iOS6.0 应用程序中使用 std::vector 并使用 .mm 扩展名重命名我正在使用 C++ 的文件。但由于某种原因，相关的标头那些 .mm 不要编译我有以下错误：

矢量：没有这样的文件或目录

我试过导入，包括。如果我只将它包含在 .mm 中，它就可以工作。

知道我做错了什么吗？

谢谢

韦巴巴

已解决：仔细检查可能包含此标头的其他 .m 文件。（不仅是实施课程的人）我错过了一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:55:59.577

确保包含头文件的文件被编译为 Objective-C++ 或 C++ 文件。你可以通过选择一个源文件来做到这一点，在实用程序面板的文件检查器中，你可以设置 Xcode 应该如何编译你的文件。

例如，如果您尝试编译包含 Objective-C 头文件的 C 源文件，也会发生同样的情况。

编辑：如果用于编译的命令包含**-nostdinc**或**-nostdinc++**之类的内容，那么您可能必须更改项目设置。LLVM GCC 4.2 - Language 部分应该有一个设置，标记为**Use Standard System Header Directory**（对我来说，这是该部分的最后一个设置）。确保它设置为是。

# c - 从提交中获取 blob？

> ID：14308260
> 
> 赞同：4
> 
> 时间：2013-01-13T21:17:53.490
> 
> 标签：c, git, libgit2

我试图弄清楚如何为单个提交获取文件列表及其各自的新旧[blob 。](https://en.wikipedia.org/wiki/Binary_large_object)

假设您有提交 1 更改了 3 个文件。我会运行所述函数并返回 3 个文件以及它们的旧 blob 和新 blob（假设它们不是二进制文件）。

做到这一点的唯一方法是获取提交和先前的提交，解析它们的树，然后对树进行比较以找出不同之处，然后获取每个不同文件的 blob？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T21:43:40.797

> 做到这一点的唯一方法是获取提交和先前的提交，解析它们的树，然后对树进行比较以找出不同之处，然后获取每个不同文件的 blob？

是的，这是推荐的方式。*“旧”*和*“新”*`Tree`条目只是比较两个s时有意义的概念。

请注意，*“旧”*和*“新”*不是具有表现力的限定词。正如人们可以在**[diff 标头](https://github.com/libgit2/libgit2/blob/development/include/git2/diff.h#L195-205)**中看到的那样，一个条目的结果差异状态可能是

*   **GIT_DELTA_UNMODIFIED** = 0, /** 没有变化 */
*   **GIT_DELTA_ADDED** = 1, /** 旧版本中不存在条目 */
*   **GIT_DELTA_DELETED** = 2, /** 新版本中不存在条目 */
*   **GIT_DELTA_MODIFIED** = 3, /** 新旧条目内容改变 */
*   **GIT_DELTA_RENAMED** = 4, /** 条目在新旧之间重命名 */
*   **GIT_DELTA_COPIED** = 5, /** 条目是从另一个旧条目复制的 */
*   **GIT_DELTA_IGNORED** = 6, /** 条目是工作目录中的忽略项 */
*   **GIT_DELTA_UNTRACKED** = 7, /** 条目是工作目录中未跟踪的项目 */
*   **GIT_DELTA_TYPECHANGE** = 8, /** 条目类型在新旧之间改变 */

libgit2 **[tests-clar/diff/tree](https://github.com/libgit2/libgit2/blob/development/tests-clar/diff/tree.c)**测试文件应该为您提供此功能的一些示例用法。

## 更新：

在 libgit2 问题跟踪器中提出了一个**[类似的问题（来自你？;-)）。](https://github.com/libgit2/libgit2/issues/1241)**@arrbee 的答案也依赖于利用`git_diff_tree_to_tree() API`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T02:42:07.270

## 提取以前和当前版本的 SHA1

考虑`git show --raw v1.8.1^0`git 自己的存储库中的输出。

```
提交 5d417842efeafb6e109db7574196901c4e95d273
作者：Junio C Hamano
日期：2012 年 12 月 31 日星期一 14:24:22 -0800

    Git 1.8.1

    签字人：Junio C Hamano <gitster@pobox.com>

:100644 100644 fec1a06...d6f9555...M 文档/RelNotes/1.8.1.txt
:100644 100644 b0e8f02... 7a3f03b... M 文档/git.txt
:100755 100755 b2dffc8...72e37c9...M GIT-VERSION-GEN
```

最后三行表示随着该提交而更改的文件。更改行上的第一个 SHA1 是给定文件的先前修订版的对象名称，第二个是命名提交中的 blob。例如，`GIT-VERSION-GEN`在`v1.8.1`哈希中

```
$ git show v1.8.1^0:GIT-VERSION-GEN | git hash-object --stdin
72e37c9bfe3e897635f8c211569d9e6f5658a980
```

并且与其父提交关联的 blob 是

```
$ git show v1.8.1^0~:GIT-VERSION-GEN | git hash-object --stdin
b2dfc839f306123d544e8f536ee31a7574f1139
```

注意：`git rev-parse`解释的文档

> 作为特殊规则，`<rev>^0`表示提交本身，并且在`<rev>`引用提交对象的标记对象的对象名称时使用。

在这种情况下，`v1.8.1^0`表示标记所指的提交`v1.8.1`。

## 获取提交中所有 blob 的 SHA1

要获取与给定提交关联的所有 blob 的对象名称，请读取 的输出`git ls-tree`，类似于

```
$ git ls-tree -r v1.8.1^0
100644 斑点 5e98806c6cc246acef5f539ae191710a0c06ad3f .gitattributes
100644 blob f702415c12c5a4a66180f7ffd697347e5343ac4a .gitignore
100644 blob c7e86183001a00ad2105765708b5b59852ef6640 .mailmap
100644 blob 536e55524db72bd2acf175208aef4f3dfc148d42 正在复制
100644 blob ddb030137d54ef3fb0ee01d973ec5cee4bb2b2b3 文档/.gitattributes
100644 blob d62aebd848b2a44f977ad4d7c4b75b6ff72b2163 文档/.gitignore
100644 blob 69f7e9b76c3f9b87b7951fb0df6a9720edadeb3e 文档/编码指南
100644 blob e53d333e5c08515af1e21d81c7daa365b12609a1 文档/生成文件
100644 blob fea3f9935b7794ce86f04d22c9d68fb9d537167d 文档/RelNotes/1.5.0.1.txt
100644 blob b061e50ff05b5e13211bb315e240974e898de32c 文档/RelNotes/1.5.0.2.txt
...
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-13T21:54:00.920

仅使用 Git 命令，不知道访问此信息的特定 libgit2 函数，但您可能可以弄清楚。

您可以使用 获取在特定提交中更改了哪些文件的文件列表`git show --stat COMMIT`。底部是已更改的文件路径列表（以及更改了多少行的详细信息）。您可能可以从那里过滤掉这些东西。您可以进一步使用漂亮格式从输出中删除更多内容。

获得文件路径后，您可以使用`git show COMMIT:PATH`. 您可以使用`git show COMMIT^:PATH`.

# c++ - 为什么 GCD 会增加执行时间？

> ID：14308261
> 
> 赞同：1
> 
> 时间：2013-01-13T21:18:33.990
> 
> 标签：c++, grand-central-dispatch, clang++

我尝试学习 Grand Central Dispatch (GCD) 并使用以下代码进行测试：

使用 GCD：

```
#include <dispatch/dispatch.h>
#include <vector>
#include <cstdlib>
#include <iostream>

int main(int argc, char *argv[])  
{
   const int N = atoi(argv[1]);
   __block std::vector<int> a(N, 0);
   dispatch_apply(N, 
     dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), 
     ^(size_t i) 
     { 
       a[i] = i;
#ifdef DEBUG           
       if ( i % atoi(argv[2]) == 0)
         std::cout << a[i] <<  std::endl;
#endif
     });
  return 0;
} 
```

没有 GCD：

```
#include <vector>
#include <cstdlib>
#include <iostream> 

int main(int argc, char *argv[]) 
{
  const int N = atoi(argv[1]);
  std::vector<int> a(N, 0);
  for (int i = 0; i < N; i++)   
    {
      a[i] = i;
#ifdef DEBUG
      if ( i % atoi(argv[2]) == 0)
    std::cout << a[i] <<  std::endl;
#endif
    }
 return 0;
} 
```

GCD的测试结果：

```
$ time ./testgcd 100000000 10000000
4.254 secs 
```

没有 GCD 的测试：

```
$ time ./nogcd 100000000 10000000
1.462 secs 
```

我认为 GCD 应该减少执行时间，但结果却相反。我不确定我是否滥用了 GCD。操作系统环境是 Mac OS X 10.8 和 Xcode 4.5。编译器是 Clang++ 3.1。硬件是带有 i5 CPU 的 Macbook Pro，它有两个内核。

为了比较，我使用 OpenMP（在同一台笔记本电脑上也使用 Xcode 4.5 附带的 GCC）：

```
#include <vector> 
#include <cstdlib>

int main(int argc, char *argv[])  
{
  const int N = atoi(argv[1]);
  std::vector <int> a(N, 0);
  #pragma omp parallel for
  for (int i = 0; i < N; i++)
    a[i] = i;
  return 0;
} 
```

和 w/wo (-fopenmp)，我有两个可执行文件要测试，

编译时带有`-fopenmp`标志：

```
$ time ./testopenmp 100000000
1.280 secs 
```

编译时没有`-fopenmp`标志：

```
$ time ./testnoopenmp 100000000
1.626 secs 
```

使用 OpenMP，可以减少执行时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-13T22:03:34.533

GCD 不一定要增加执行时间。在您的情况下这样做的原因是您做错了。重要的是你首先要知道为什么你的应用程序很慢。所以我去多核分析器（Instruments.app）下运行你的代码，它显示的是：

![多核分析截图](../Images/874c03d194b61ff1bfd83ab91e0f4d4a.png)

如您所见，该图大多是黄色的。黄色表示线程什么都不做，等待某个任务执行。绿色表示它执行任务。换句话说，按照您编写代码的方式，应用程序将 99% 的时间用于传递任务，并且每个任务执行几乎不需要时间——开销太大。那么为什么会这样呢？

因为您已经安排了大约 100000000 个任务来运行。运行每个任务都有一些开销，这远远大于将整数分配给数组。经验法则是如果任务的复杂性低于线程间通信的复杂性，则不安排任务。

那么你如何解决这个问题？安排更少的任务，在每个任务中做更多的事情。例如：

```
int main(int argc, char *argv[])
{
   const int N = atoi(argv[1]);
   __block std::vector<int> a(N, 0);
   dispatch_apply(4,
     dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0),
     ^(size_t iN)
     {
         size_t s = a.size()/4;
         size_t i = (s*iN);
         size_t n = i + s;
         //printf("Iteration #%lu [%lu, %lu]\n", iN, i, n);
         while (i < n) {
             a[i] = i++;
         }
     });
  return 0;
} 
```

现在，分析器显示以下内容：

![没那么糟](../Images/c01b44942460bfab58fac17c3ae56d41.png)

再次运行测试，GCD 会快一点：

```
$ time ./test_nogcd 100000000 10000000

real    0m0.516s
user    0m0.378s
sys 0m0.138s
$ time ./test_gcd 100000000 10000000

real    0m0.507s
user    0m0.556s
sys 0m0.138s 
```

也许运行更少的任务会使它变得更好？试试看。通过这样一个简单的工作流程，您可能会更好地使用单线程 SIMD 实现。或者可能不是 ：）

请注意，在某些情况下您必须格外小心，例如，当总大小不能分成 N 等份时等。为简单起见，我省略了所有错误检查。

此外，在当今的商品硬件上并行任务时存在大量细微差别。我建议您熟悉 MESI、错误共享、内存屏障、CPU 缓存、缓存遗忘算法等。记住 - 始终使用分析器！

希望能帮助到你。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T21:23:42.933

GCD 不会神奇地减少整体执行时间，而且它的使用肯定是有代价的：例如，考虑一下这样一个事实，例如`dispatch_apply_*`，以及它们所暗示的所有幕后管理*必须*花费一些时间。（现在，在我看来，2.5 秒对于这种管理来说太长了，但我现在无法评估你的结果的有效性）。**最终结果是 GCD 可能会提高你的性能，如果你正确使用它（在正确的场景中）并且你的硬件允许它。**

可能是 GCD 的特性让您相信 GCD 能够在单独的线程中以异步方式执行任务。这本身以及在这两种情况下都不一定会缩短整体执行时间，但它可以帮助提高应用程序的响应能力，例如，不允许 UI 冻结。

除此之外，如果一个 CPU 有更多的内核，或者你有一个多 CPU 系统，*并且*线程被调度在不同的内核/CPU 上，那么 GCD 可能会提高整体执行时间，因为两个（实际上，最多内核数）不同任务将并行执行。在这种情况下，两个任务的总持续时间将等于较长的任务持续时间（+ 管理成本）。

一旦澄清这一点，更详细地了解您的示例，您还可以注意到以下内容：

1.  您在同一个辅助线程上调度 N 个任务：即使在多核系统上，这些任务也将按顺序执行；

2.  唯一在做事情的线程，即运行 main 的线程，没有做任何冗长的事情，因此程序的整体持续时间由第 1 点的任务持续时间唯一确定；

3.  最后，如果你考虑到任务的性质，你会发现它只是一个你执行 N 次的任务。现在，在 GCD 的情况下，对于每个这样的分配，你排队一个任务，然后在辅助线程上执行它；在非 GCD 的情况下，您只需迭代一个 for 循环来执行 N 个分配，这为您提供了最快的时间。在前一种情况下，对于每个任务，您还需要为任务的排队+调度付费。

可能这不是您可能想要衡量 GCD 收益的最重要的场景，而从性能方面衡量 GCD 的成本可能是一个很好的场景（在我看来，这似乎是最坏的情况）。

# macos - OSX ForceFeedback 驱动程序

> ID：14308264
> 
> 赞同：3
> 
> 时间：2013-01-13T21:18:58.843
> 
> 标签：macos, usb, device-driver, hid

我已经有一段时间拥有这个旧游戏手柄了，GameStop 高级控制器（它实际上是一家名为 DragonRise inc. 的公司大规模生产的通用设备之一），它带有隆隆声/触觉功能。不幸的是，它不适用于 OSX。我认为这将是一个很好的项目，可以更多地了解 OSX 和 USB HID 设备上的驱动程序开发。现在，游戏手柄本身可以作为标准 HID 设备正常工作，除了触觉/力反馈的东西。我的目标是为游戏手柄编写一个简单的 ForceFeedback 插件。

到目前为止，我所做的是创建一个非常简单的 IOKit 驱动程序，它继承自 IOUSBHIDDevice 并基本上让超类完成大部分繁重的工作；我的理由是，它现在工作正常，我只想*添加*功能。所以那种工作; 我现在的问题是驱动程序被添加为注册表中设备的新接口。它匹配，但未使用。理想情况下，我希望将通用 IOUSBHIDDevice 类完全替换为该特定游戏手柄的 IOClass，但我不确定如何。

另一方面，也许我做错了，我不需要创建新的驱动程序来为该游戏手柄添加 ForceFeedback 插件；这只是我在阅读文档后提出的解决方案。

这是我的驱动程序项目的 Info.plist（无论如何都是重要的部分）：

```
<key>IOKitPersonalities</key>
<dict>
    <key>IODragonRiseGenericUSB</key>
    <dict>
        <key>IOMatchCategory</key>
        <string>name_npp_driver_IODragonRiseGenericUSB</string>
        <key>IOProviderClass</key>
        <string>IOUSBDevice</string>
        <key>IOKitDebug</key>
        <integer>65535</integer>
        <key>IOClass</key>
        <string>name_npp_driver_IODragonRiseGenericUSB</string>
        <key>CFBundleIdentifier</key>
        <string>name.npp.driver.${PRODUCT_NAME:rfc1034identifier}</string>
        <key>IOCFPlugInTypes</key>
        <dict>
            <key>F4545CE5-BF5B-11D6-A4BB-0003933E3E3E</key>
            <string>IODragonRiseGenericUSB.kext/Contents/PlugIns/ForceFeedback.plugin</string>
        </dict>
        <key>idProduct</key>
        <integer>6</integer>
        <key>idVendor</key>
        <integer>121</integer>
        <key>HIDDefaultBehavior</key>
        <string></string>
        <key>bInterfaceClass</key>
        <integer>3</integer>
        <key>bInterfaceProtocol</key>
        <integer>1</integer>
        <key>bInterfaceSubClass</key>
        <integer>1</integer>
    </dict>
</dict>
<key>NSHumanReadableCopyright</key>
<string>Copyright © 2013 npepinpe. All rights reserved.</string>
<key>OSBundleLibraries</key>
<dict>
    <key>com.apple.iokit.IOHIDFamily</key>
    <string>1.7.1</string>
    <key>com.apple.iokit.IOUSBFamily</key>
    <string>5.1</string>
    <key>com.apple.iokit.IOUSBHIDDriver</key>
    <string>5.0</string>
    <key>com.apple.kpi.iokit</key>
    <string>11.4.2</string>
    <key>com.apple.kpi.libkern</key>
    <string>11.4.2</string>
</dict> 
```

需要注意的是，我尝试将 IOProviderClass 更改为 USBInterface（就像 IOUSBHIDDevice 所做的那样），但是我的设备根本不匹配，所以我不确定我在那里做错了什么。

所以我的问题是，如何将与我的特定游戏手柄匹配的默认 IOUSBHIDDriver 替换为我的自定义驱动程序？或者，如果我只想添加一个 ForceFeedback 插件（但不需要更改任何其他行为），这不是正确的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-23T18:21:51.420

这是旧的 Logitech Force Feedback 作为其 IOKit 特性之一的示例：

```
<key>Logitech Cordless RumblePad</key>
<dict>
 <key>CFBundleIdentifier</key>
 <string>com.apple.iokit.IOUSBHIDDriver</string>
 <key>IOCFPlugInTypes</key>
 <dict>
  <key>F4545CE5-BF5B-11D6-A4BB-0003933E3E3E</key>
  <string>LogitechForceFeedback.kext/Contents/PlugIns/WMJoyFrc.plugin</string>
 </dict>
 <key>IOClass</key>
 <string>IOUSBHIDDriver</string>
 <key>IOProviderClass</key>
 <string>IOUSBInterface</string>
 <key>bConfigurationValue</key>
 <integer>1</integer>
 <key>bInterfaceNumber</key>
 <integer>0</integer>
 <key>idProduct</key>
 <integer>49681</integer>
 <key>idVendor</key>
 <integer>1133</integer>
</dict> 
```

我认为您只需要关注 Force Feedback 捆绑包（这就是 Logitech Kext：只有 info.plist 和 Force Feedback 捆绑包）。

Mac XBox 360 驱动程序有一个力反馈驱动程序。您可以以此为起点。

# python - 正则表达式中的 1 个或零个实例

> ID：14308265
> 
> 赞同：1
> 
> 时间：2013-01-13T21:19:11.230
> 
> 标签：python, regex

我有一个正则表达式（如下），但我如何将其限制为一个 1 实例或没有`[. -:]`.

```
if re.match("[0-9a-fA-F]{2}([. -:]?[0-9a-fA-F]{2}){%d}$" % x, self.input_value): 
```

谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-13T21:21:35.377

`?`在一个组上使它成为可选的，这将是 1 或 0。

编辑删除显式版本

# java - 从 Google Datastore 加载 DDD 实体的设计模式是什么？

> ID：14308266
> 
> 赞同：2
> 
> 时间：2013-01-13T21:19:12.270
> 
> 标签：java, design-patterns, domain-driven-design, google-cloud-datastore

我正在学习 DDD 并尝试使用 Google Datastore 实现存储库。

我发现从数据存储区重新创建 DDD 实体非常棘手。我已经阅读了将我的 DDD 实体映射到数据存储实体的框架，但我想先学习低级 API。

我虽然，存储库可以使用设置器设置实体的状态，但这通常被认为是 DDD 中的反模式。

另一种方法是使用构建器模式，其中构建器实例被传递给实体的构造函数。然而，这向实体引入了一个超出其职责的功能（恢复实体状态）。

解决问题的好模式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T01:56:19.900

（答案主要来自我在 OP 中的评论，但我认为最好在答案中详细说明）

二传手很好。问题是域实体的“用户”不应该通过那些 getter/setter 访问。领域实体应该有一个业务有意义的接口，以便应用程序逻辑建立在此基础上。设置器应该是实现级别的东西，用于创建实现对象（在存储库等中）

我认为最好用一个例子来说明。

* * *

对于认为是反模式的设置器来说，这是不正确的方式

```
class OrderApplicationService {
  public void cancelOrder(String orderId) {
    Order order = orderRepository.getOrder(orderId);
    order.setOrderStatus(CANCELLED);
    order.setOpenQuantity(0);
    orderRepository.update(order);
  }
} 
```

* * *

但是更正确的方法是：

```
// Interface for Order

interface Order {
  void cancel();

  // no setters!!!
}

class OrderImpl extends Order {
  @Override
  void cancel() {
    this.status = CANCELLED;
    this.openQuantity = 0;
  }

  void setId(String orderId) { ... }
  // some other setters
}

class OrderApplicationService {
  public void cancelOrder(String orderId) {
    Order order = orderRepository.getOrder(orderId);
    order.cancel();
    orderRepository.update(order);
  }
} 
```

Repository 通过 impl 创建和访问，因此它可以访问 getter/setter。但是，您的应用程序逻辑仅面向接口，并且您没有使用 setter/getter 实现逻辑（这是反模式）

* * *

上述方式是通过正确的接口声明来执行的。然而，如果你认为你可以依靠自我声誉，你可以通过在 Impl 中直接拥有与业务逻辑相关的方法和 setter/getter 来简化故事，省略接口。在你的实现过程中，你应该知道在你的业务逻辑实现过程中你应该只使用实体的业务方法（而不是 getter/setter）。

* * *

而且，将 setter 视为反 DDD 并不是一个简单的经验法则。在某些情况下，例如，将自由文本评论存储在实体中，提供 setter 作为业务逻辑方法不一定是错误的决定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-17T22:52:32.717

[Eric Evans书](https://rads.stackoverflow.com/amzn/click/com/0321125215)的整个第 6 章都专门针对您所描述的问题。

首先，DDD 中的 Factory 不必是独立的服务 -

> 埃文斯 DDD，p。139:
> 
> 有很多方法可以设计 FACTORIES。Gamma et 中彻底处理了几种特殊用途的创建模式——FACTORY METHOD、ABSTRACT FACTORY 和 BUILDER。al 1995\. <...> 这里的重点不是深入研究工厂设计，而是展示工厂作为领域设计的重要组成部分的位置。

Evans FACTORY 中的每个创建方法都强制执行创建对象的所有不变量，但是，对象重构是一种特殊情况

> 埃文斯 DDD，p。145：
> 
> *重构对象的 FACTORY 将以不同的方式处理对不变量的违反。*在创建新对象期间，当不满足不变量时，FACTORY 应该简单地阻止，但在重构时可能需要更灵活的响应。

这很重要，因为它引导我们为创建和重构创建单独的 FACTORIES。（在第 155 页的图表中*TradeRepository*使用专门的*SQL TradeOrderFactory*，而不是通用的*TradeOrderFactory*）

所以你需要为重构实现一个单独的逻辑，并且有几种方法可以做到这一点（你可以在 Martin J Fowler [Patterns Of Enterprise Application Architecture](https://rads.stackoverflow.com/amzn/click/com/0321127420)中找到完整的理论，第 169 页有一个子标题**Mapping Data to Domain Fields**，但不是所描述的所有方法看起来都很合适（例如，在 java 中使对象字段包私有似乎太侵入性）所以我只喜欢以下两个选项之一

*   您可以创建一个单独的 FACTORY 并将其记录下来，以便开发人员仅将其用于持久性或测试。
*   您可以使用反射设置私有字段值，例如[Hibernate 所做](https://stackoverflow.com/questions/4127365/how-can-spring-hibernate-access-private-members)的。

[关于带有 setter/getter 的贫乏领域模型，[即将出版的 Vaughn Vernon 书](https://rads.stackoverflow.com/amzn/click/com/0321834577)对这种方法提出了很多批评，所以我敢说它*是*DDD 中的一种反模式。]

# windows - MinGW动态联动未定义参考

> ID：14308268
> 
> 赞同：0
> 
> 时间：2013-01-13T21:19:24.317
> 
> 标签：windows, dll, mingw

我正在尝试创建一个使用动态库的程序。我的程序：

```
#include "launcher.h"

using namespace std;

int main(void)
{
    helloWorld();

    return 0;
} 
```

launcher.h 代码：

```
#ifndef LAUNCHER_H_
#define LAUNCHER_H_

//Define the private and public preprocessor commands
#if defined _WIN32 || defined __CYGWIN__
  #ifdef BUILDING_DLL
    #ifdef __GNUC__
      #define DLL_PUBLIC __attribute__ ((dllexport))
    #else
      #define DLL_PUBLIC __declspec(dllexport) // Note: actually gcc seems to also supports this syntax.
    #endif
  #else
    #ifdef __GNUC__
      #define DLL_PUBLIC __attribute__ ((dllimport))
    #else
      #define DLL_PUBLIC __declspec(dllimport) // Note: actually gcc seems to also supports this syntax.
    #endif
  #endif
  #define DLL_LOCAL
#else
  #if __GNUC__ >= 4
    #define DLL_PUBLIC __attribute__ ((visibility ("default")))
    #define DLL_LOCAL  __attribute__ ((visibility ("hidden")))
  #else
    #define DLL_PUBLIC
    #define DLL_LOCAL
  #endif
#endif

void DLL_PUBLIC helloWorld(void);

void DLL_LOCAL hiddenHelloWorld(void);

void internalHelloWorld(void);

#endif /* LAUNCHER_H_ */ 
```

我用这两个命令编译它（通常包含在 makefile 中）：

```
g++ -c -std=c++11 -o Main.o Main.cpp
g++ -o Test.exe -llauncher Main.o 
```

第一次调用效果很好，但在第二个命令中，正在打印此错误：

```
Main.o:Main.cpp:(.text+0x3c): undefined reference to `__imp___Z10helloWorldv'
collect2.exe: error: ld returned 1 exit status 
```

但是在liblauncher.a文件中，方法是被nm找到的：

```
d000006.o:
00000000 i .idata$4
00000000 i .idata$5
00000000 i .idata$7
00000000 I _launcher_dll_iname

d000004.o:
00000000 i .idata$2
00000000 i .idata$4
00000000 i .idata$5
00000000 I __head_launcher_dll
         U _launcher_dll_iname

d000005.o:
00000000 i .idata$4
00000000 i .idata$5
00000000 i .idata$6
00000000 i .idata$7
00000000 t .text
00000001 a @feat.00
00000000 T __Z10helloWorldv
         U __head_launcher_dll
00000000 I __imp___Z10helloWorldv 
```

但是如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:26:49.683

尝试`g++ -o Test.exe Main.o -llauncher`（注意参数的顺序）。

# c# - C# 双精度转整数

> ID：14308269
> 
> 赞同：-4
> 
> 时间：2013-01-13T21:19:24.553
> 
> 标签：c#

假设我有`double`42.433243，我想将其转换为整数 42433243。

当十进制长度是随机的时，这样做的代码是什么？

更多示例：

```
45.25 => 4525

125.152254 => 125152254

etc... 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-13T21:23:40.740

只要有任何小数部分，您就可以将该值乘以 10：

```
Decimal m = 42.433243m;

while (m % 1 != 0) m *= 10;
int i = (int)m; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T21:22:16.407

又快又脏：

```
double x = 42.25;
int big = int.Parse(x.ToString().Replace(".","")); 
```

`int`如果数字太大（例如溢出，对于 int 大于 2^32，或者您可以在第 2 行替换`double`并使其更大），这将不起作用。

如果您有其他考虑，请告诉我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T21:25:52.850

也许这样的事情会奏效。

```
while ((double_num - Math.floor(double_num)) != 0.0) double_num *= 10;
int num = (int) double_num; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-13T22:33:32.923

更直接的方法是将数字转换为 a`decimal`并检查位。

前 96 个最低有效位表示尾数，而 32 个最高有效位表示指数。因此，您感兴趣的实际值是 32 个最低有效位。该[`Decimal.GetBits()`](http://msdn.microsoft.com/en-us/library/system.decimal.getbits.aspx)方法将位作为数组 int 返回，因此您需要做的就是获取数组中的第一个 int。只要数字不超过`int.MaxValue`，你就是金子。

```
var number = 42.433243;
var asDecimal = (Decimal)number;
var bits = Decimal.GetBits(asDecimal);
var digits = bits[0]; // 42433243 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-13T21:24:14.670

```
int result = Convert.ToInt32(Regex.Match(digits.Replace(".","").Replace(",",""), @"^\d+$").Value); 
```

# javascript - ASP.NET MVC 数据注释正则表达式在 .NET 中有效，但在 JS 中无效

> ID：14308270
> 
> 赞同：1
> 
> 时间：2013-01-13T21:19:39.613
> 
> 标签：javascript, regex, asp.net-mvc-4, data-annotations

[我正在尝试在此答案https://stackoverflow.com/a/164994/4950](https://stackoverflow.com/a/164994/4950)中给出的英国邮政编码正则表达式用于 ASP.NET MVC 中的模型验证的正则表达式数据注释。

这是正则表达式：

```
(GIR 0AA)|((([A-Z-[QVX]][0-9][0-9]?)|(([A-Z-[QVX]][A-Z-[IJZ]][0-9][0-9]?)|(([A-Z-[QVX]][0-9][A-HJKSTUW])|([A-Z-[QVX]][A-Z-[IJZ]][0-9][ABEHMNPRVWXY])))) [0-9][A-Z-[CIKMOV]]{2}) 
```

这在服务器端运行良好，并且在正则表达式英雄（[http://regexhero.net/tester/](http://regexhero.net/tester/)）中进行测试时，但在客户端，正则表达式似乎不起作用。

我查看了 Jquery.validate.unobtrusive 插件正在使用的代码：

```
$jQval.addMethod("regex", function (value, element, params) {
    var match;
    if (this.optional(element)) {
        return true;
    }

    match = new RegExp(params).exec(value);
    return (match && (match.index === 0) && (match[0].length === value.length));
}); 
```

并在这里复制了相同的情况：http: [//jsfiddle.net/cEGsj/](http://jsfiddle.net/cEGsj/)（我稍后添加了 gi 参数）。

谁能告诉我为什么这个正则表达式在 JS 中失败了？我最初认为这与大小写有关，但添加忽略大小写选项似乎并没有改变任何东西。

在这里似乎也不起作用：[http](http://regexpal.com/) ://regexpal.com/所以一定有一些语法问题..

更新：通过删除嵌套字符集，我设法得到了令人满意的工作。请参阅此处的工作示例：http: [//jsfiddle.net/Asyqh/1/](http://jsfiddle.net/Asyqh/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T12:21:04.787

通过删除 Javascript 似乎不喜欢的嵌套字符集，我设法得到了令人满意的工作。请参阅此处的工作示例：http: [//jsfiddle.net/Asyqh/1/](http://jsfiddle.net/Asyqh/1/)

```
var regex = "(GIR 0AA)|((([A-Z][0-9][0-9]?)|(([A-Z][A-Z][0-9][0-9]?)|(([A-Z][0-9][A-HJKSTUW])|([A-Z][A-Z][0-9][ABEHMNPRVWXY])))) [0-9][A-Z]{2})"; 
```

# xml - 当标签为空时，使用 XSL 转换写入“NULL”

> ID：14308272
> 
> 赞同：2
> 
> 时间：2013-01-13T21:19:53.290
> 
> 标签：xml, xslt

当我进行转换时，我正在尝试写“NULL”。转换用于在 mysql 数据库中进行插入。我试过这个：

```
>     <xsl:if test="incidencia =''"> <xsl:text>'NULL</xsl:text> </xsl:if> 
```

但它不起作用。

这是我的 XML：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>

    <entregats>
        <envio id="GI-000008">
            <estats totalestats="3">
                <estat datahora="2012-12-02T12:01:55">
                   <IDEstat>CAM</IDEstat>
                   <incidencia> No s ha pogut trobar el cami </incidencia>
                </estat>
                <estat datahora="2012-12-03T12:01:55">
                    <IDEstat>CAM</IDEstat>
                    <incidencia> Destinetari Absent</incidencia>
                </estat>
                <estat datahora="2012-12-04T12:02:55">
                    <IDEstat>CAM</IDEstat>
                    <incidencia> Destinetari Absent </incidencia>
                </estat>

            </estats>

            <receptor>
                <nom>J</nom>
                <cognom>R</cognom>
                <telefon>972510125</telefon>
                <adreca>C/ZopeZope, nº15</adreca>
                <codipostal>19000</codipostal>
            </receptor>

        </envio>
        <envio id="GI-000009">

            <estats totalestats="2">
                <estat datahora="2012-12-01T09:01:55">
                    <IDEstat>CAM</IDEstat>
                </estat>
                <estat datahora="2012-12-01T12:01:55">
                    <IDEstat>ENT</IDEstat>
                </estat>
            </estats>

            <receptor>
                <nom>X</nom>
                <cognom>S</cognom>
                <cognom>P</cognom>
                <telefon>972500025</telefon>
                <adreca>C/Patatones, nº27</adreca>
                <codipostal>17000</codipostal>
            </receptor>

        </envio>
        <envio id="GI-000010">

            <estats totalestats="3">
                <estat datahora="2012-12-05T08:21:57">
                    <IDEstat>CAM</IDEstat>
                </estat>
                <estat datahora="2012-12-06T15:21:57">
                    <IDEstat>CAM</IDEstat>
                </estat>
                <estat datahora="2012-12-07T15:21:57">
                    <IDEstat>ENT</IDEstat>
                </estat>
            </estats>

            <receptor>
                <nom>D</nom>
                <cognom>H</cognom>
                <cognom>P</cognom>
                <telefon>972500125</telefon>
                <adreca>C/Oracle, nº12</adreca>
                <codipostal>17000</codipostal>
            </receptor>

        </envio>

    </entregats> 
```

这是我的 XSL：

```
<?xml version="1.0" encoding="UTF-8"?> <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xd="http://www.oxygenxml.com/ns/doc/xsl" exclude-result-prefixes="xd" version="1.0">
    <xsl:output method="text"/>

    <xsl:template match="/">
        <xsl:apply-templates select="//envio" />
    </xsl:template>

    <xsl:template match="envio">
        <xsl:for-each select="estats/estat">      
    <xsl:text>INSERT INTO HISTORIC_ESTATS (IDEnvio,DATAHORA,IDESTAT,INCIDENCIA) values (</xsl:text>
        <xsl:text>'</xsl:text>
            <xsl:value-of select="../../@id"/><xsl:text>','</xsl:text>           
            <xsl:value-of select="@datahora"/><xsl:text>','</xsl:text> 
            <xsl:value-of select="IDEstat"/><xsl:text>'</xsl:text>
            <xsl:if test="incidencia =''">
                <xsl:text>'NULL</xsl:text>
            </xsl:if>
            <xsl:if test="incidencia !=''">    
              <xsl:text>,'</xsl:text>  <xsl:value-of select="incidencia"/> 
              <xsl:text>'</xsl:text>                
            </xsl:if>                
        <xsl:text>); </xsl:text>    
        </xsl:for-each>             
    </xsl:template> </xsl:stylesheet> 
```

如果有人可以提供帮助。

我得到的输出是这样的：

```
INSERT INTO HISTORIC_ESTATS (IDEnvio,DATAHORA,IDESTAT,INCIDENCIA) values ('GI-000008','2012-12-02T12:01:55','CAM',' No s ha pogut trobar el cami ');
INSERT INTO HISTORIC_ESTATS (IDEnvio,DATAHORA,IDESTAT,INCIDENCIA) values ('GI-000008','2012-12-03T12:01:55','CAM',' Destinetari Absent');
INSERT INTO HISTORIC_ESTATS (IDEnvio,DATAHORA,IDESTAT,INCIDENCIA) values ('GI-000008','2012-12-04T12:02:55','CAM',' Destinetari Absent ');
INSERT INTO HISTORIC_ESTATS (IDEnvio,DATAHORA,IDESTAT,INCIDENCIA) values ('GI-000009','2012-12-01T09:01:55','CAM');
INSERT INTO HISTORIC_ESTATS (IDEnvio,DATAHORA,IDESTAT,INCIDENCIA) values ('GI-000009','2012-12-01T12:01:55','ENT');
INSERT INTO HISTORIC_ESTATS (IDEnvio,DATAHORA,IDESTAT,INCIDENCIA) values ('GI-000010','2012-12-05T08:21:57','CAM');
INSERT INTO HISTORIC_ESTATS (IDEnvio,DATAHORA,IDESTAT,INCIDENCIA) values ('GI-000010','2012-12-06T15:21:57','CAM');
INSERT INTO HISTORIC_ESTATS (IDEnvio,DATAHORA,IDESTAT,INCIDENCIA) values ('GI-000010','2012-12-07T15:21:57','ENT'); 
```

当不是偶然事件时，我需要写“NULL”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:01:25.530

在这些情况下，您的某些`estat`元素没有 a`incidencia`并且您对其值的测试不会评估为 true。

您可以将您的两个`xsl:if`条件替换为`xsl:choose`以评估是否评估为真（仅当元素存在且具有内容`normalize-space(incidencia)`时才会出现这种情况），否则生成.`incidencia``text()``'NULL'`

```
<?xml version="1.0" encoding="UTF-8"?> <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xd="http://www.oxygenxml.com/ns/doc/xsl" exclude-result-prefixes="xd" version="1.0">
    <xsl:output method="text"/>

    <xsl:template match="/">
        <xsl:apply-templates select="//envio" />
    </xsl:template>

    <xsl:template match="envio">
        <xsl:for-each select="estats/estat">      
            <xsl:text>INSERT INTO HISTORIC_ESTATS (IDEnvio,DATAHORA,IDESTAT,INCIDENCIA) values (</xsl:text>
            <xsl:text>'</xsl:text>
            <xsl:value-of select="../../@id"/><xsl:text>','</xsl:text>           
            <xsl:value-of select="@datahora"/><xsl:text>','</xsl:text>
            <xsl:value-of select="IDEstat"/><xsl:text>'</xsl:text>
            <xsl:text>,</xsl:text>
            <xsl:choose>
                <xsl:when test="normalize-space(incidencia)">
                    <xsl:text>'</xsl:text>  
                    <xsl:value-of select="incidencia"/> 
                    <xsl:text>'</xsl:text>    
                </xsl:when>
                <xsl:otherwise>
                    <!--there is either no incidencia, or it has no value-->
                    <xsl:text>'NULL'</xsl:text>
                </xsl:otherwise>
            </xsl:choose>

            <xsl:text>); </xsl:text>    
        </xsl:for-each>             
    </xsl:template> 
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:00:16.627

尝试`<xsl:if test="incidencia">`代替`<xsl:if test="incidencia =''">`，因为您想测试节点是否存在。

# blackberry-10 - BB10 android 运行时推送通知

> ID：14308274
> 
> 赞同：4
> 
> 时间：2013-01-13T21:20:05.747
> 
> 标签：blackberry-10, blackberry-android

我已按照[本教程](http://developer.blackberry.com/android/apisupport/creating_push-enabled_android_apps.html)在 android 运行时启用推送通知，但是`failure 830 android/android.cfg: unknown asset`当我尝试将 bar 包部署到 alpa 设备时出现错误。

这可能是什么原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T10:28:04.107

解决方法是改变将android.cfg文件导入android项目的方式。首先，

*   将 android.cfg 文件添加到 android 项目文件夹的根目录中，并将其重命名为 projectname.cfg。例如，如果应用程序名称是 SamplePushApp，那么您的 cfg 文件的名称必须是 SamplePushApp.cfg。
*   其次，使用 eclipse bar signer 对您的应用程序进行签名。
*   之后，检查是否在 bar 文件下创建了 android.cfg 文件。

# java - 为什么这个通用代码会产生 NoSuchMethodError？

> ID：14308275
> 
> 赞同：17
> 
> 时间：2013-01-13T21:20:15.223
> 
> 标签：java, generics, polymorphism

假设你有一个方法

*   接受一个阈值和一个输入
*   如果输入小于阈值，则引发异常
*   否则返回输入

它看起来像这样：

```
<N extends Number & Comparable<N>, S extends N> S ensureLessThan(N threshold, S input) {
    if (input.compareTo(threshold) >= 0) {
        throw new IllegalArgumentException("Input " + input + " is not less than " + threshold);
    }
    return input;
} 
```

运行时，此方法会抛出`NoSuchMethodError`：

```
Exception in thread "main" java.lang.NoSuchMethodError: java.lang.Number.compareTo(Ljava/lang/Object;)I 
```

添加看起来像多余的演员表使其工作：

```
...
    if (((N) input).compareTo(threshold) >= 0) {
... 
```

那么这里发生了什么？

更新：我的 Java 版本是

```
java version "1.6.0_37"
Java(TM) SE Runtime Environment (build 1.6.0_37-b06-434-11M3909)
Java HotSpot(TM) 64-Bit Server VM (build 20.12-b01-434, mixed mode) 
```

这是一个可运行的示例：[https ://gist.github.com/4526536](https://gist.github.com/4526536)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-13T21:23:23.447

我怀疑这是编译器中的错误。它已经静态绑定到`Number.compareTo(Object)`不存在的，当它应该是`Comparable.compareTo(Object)`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-13T22:00:34.357

```
if (threshold.compareTo(input) < 0) { 
```

将工作。

这显然是编译器错误。这样做的原因是编译器生成了一个可比较的检查强制转换。而反之则不然。

```
ensureLessThan(Ljava/lang/Number;Ljava/lang/Number;)Ljava/lang/Number;
  L0
        LINENUMBER 11 L0
        ALOAD 1
        CHECKCAST java/lang/Comparable
        ALOAD 2
        INVOKEINTERFACE java/lang/Comparable.compareTo (Ljava/lang/Object;)I
        IFGE L1 
```

相对

```
ensureLessThan(Ljava/lang/Number;Ljava/lang/Number;)Ljava/lang/Number;
        LINENUMBER 11 L0
        ALOAD 1
        ALOAD 2
        INVOKEVIRTUAL java/lang/Number.compareTo (Ljava/lang/Object;)I
        IFGE L1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-13T21:30:56.943

这很奇怪，以下代码从我这边编译并运行：

```
/**
 * @author Buhake Sindi
 * @since 14 January 2013
 *
 */
public class Test {

    public static <N extends Number & Comparable<N>, S extends N> S ensureLessThan(N threshold, S input) {
        if (input.compareTo(threshold) >= 0) {
            throw new IllegalArgumentException("Input " + input + " is not less than " + threshold);
        }
        return input;
    }

    public static void main(String[] args) {
        ensureLessThan(10, 5);
    }
} 
```

在 Eclipse Juno (Java EE) 中测试，使用以下 JDK：

1.  JDK 1.6.0_21。
2.  JDK 1.7.0_09-b05

# drupal - Drupal 安装问题。GD 和 PDO 无法识别

> ID：14308278
> 
> 赞同：0
> 
> 时间：2013-01-13T21:20:37.170
> 
> 标签：drupal, ubuntu, pdo, amazon-ec2, gd

对不起，如果这已经得到了回答，但我的搜索让我无处可去。

我刚刚在 Amazon EC2 实例上安装了 LAMP 环境。它运行在：

```
Ubuntu precise 12.04 amd64 server
PHP Version 5.3.10-1ubuntu3.4
MySQL 5.5.28
Apache/2.2.22 (Ubuntu)
Drupal 7-18 
```

Drupal 安装告诉我我没有启用 GD 并且禁用了 PDO 扩展。但是，看着 phpinfo() 我有：

```
GD Support  enabled
GD Version  2.0
FreeType Support    enabled
FreeType Linkage    with freetype
FreeType Version    2.4.8
T1Lib Support   enabled
GIF Read Support    enabled
GIF Create Support  enabled
JPEG Support    enabled
libJPEG Version unknown
PNG Support enabled
libPNG Version  1.2.46
WBMP Support    enabled

Directive   Local Value Master Value
gd.jpeg_ignore_warning  0   0 
```

和

```
PDO

PDO support enabled
PDO drivers mysql

pdo_mysql

PDO Driver for MySQL    enabled
Client API version  5.5.28

Directive   Local Value Master Value
pdo_mysql.default_socket    /var/run/mysqld/mysqld.sock /var/run/mysqld/mysqld.sock 
```

所以，理论上一切都必须正常工作，为什么 Drupal 不能识别它们？从全新安装的 LAMP 中，我根本没有改变任何东西。那我可能会错过什么吗？

在此先感谢，格言

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T00:59:49.417

由于某种原因，重新安装解决了问题：

```
sudo apt-get install --reinstall php5-gd php5-mysql 
```

# android - 我可以使用 XML/JSON 制作一个 Android 应用程序吗？

> ID：14308281
> 
> 赞同：-7
> 
> 时间：2013-01-13T21:20:48.340
> 
> 标签：android, xml, json

我只是想问是否可以用 XML/JSON 编写一个 android 应用程序？如果是这样，是否可以将 XML/JSON 文件夹导入 Eclipse（另一个 IDE）并拥有一个工作应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T21:22:11.343

不。

XML 和 JSON 是数据格式。

您需要一种编程语言来编写应用程序。

（从技术上讲，XSLT 是一种图灵完备的语言，它是 XML 的一种应用……但我怀疑它是否适合您的需求）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:57:47.637

您可以使用[http://mobileroadie.com/](http://mobileroadie.com/)创建一个没有编程语言知识的应用程序，我以前从未使用过它，所以我无法真正告诉您任何有关它的信息，但我知道您不能仅使用 XML 或JSON！

# actionscript-3 - 我在 Flash Pro CS5.5 中将 admobs .Jar 文件放在哪里？

> ID：14308282
> 
> 赞同：0
> 
> 时间：2013-01-13T21:21:03.683
> 
> 标签：actionscript-3, admob, flash-cs5, flash-cs5.5

我在 Flash CS5.5 中创建了一个应用程序，并想在其中放置 admobs 广告。

我在弄清楚将 admobs 附带的 .jar 文件放在哪里时遇到问题。

所有教程都说把它放在“构建路径”中，但是Flash Pro CS5.5中没有构建路径选项

Flash Develop 和我现在关系不好，我目前正在使用 Sublime Text 2 对所有 as3 和 xml 进行编码。

有人可以就如何使用我正在使用的程序提供一些建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:41:02.777

JAR 文件用于 Java 应用程序，不适用于 Actionscript。

根据您的目标平台，您必须选择另一种部署 AdMobs 的方式。例如，如果您尝试在面向 Android 或 iOS 的 AIR 应用程序上使用 AdMobs，您可以使用 ANE（AIR Native Extension），例如[这个](http://lancelotmobile.com/blog/admob-ane/)。

# d3.js - 尝试将 d3.js 过渡应用于行长，而不是权重

> ID：14308283
> 
> 赞同：0
> 
> 时间：2013-01-13T21:21:10.883
> 
> 标签：d3.js

我正在使用 d3.js 制作滴漆效果，[请参阅小提琴](http://jsfiddle.net/makingthings/FgSwa/)和相关代码：

```
.append("line")

.attr("x1", function(d){
    return xScale(d)})

.attr("y1", 0)
.attr("x2", function(d){
    return xScale(d)})
.transition().delay(function (d,i){ return i * 500;})
 .duration(10000) 
     .attr("y2", function(d,i){
return yScale(i) ;
})

line.style("stroke", function() {
    var colors = ["rgba(242,100,5,0.7)","rgba(32,144,209,0.7)","rgba(203,214,86,0.7)"];
    var colorscale = Math.floor(Math.random() * colors.length);
    var randomcolors = colors[colorscale];
    return randomcolors;
});
line.style("stroke-width", function(d){
return strokeWidth[d] + "px" });
line.style("stroke-opacity", 1);
line.style("stroke-linecap", "round"); 
```

它的工作方式，但我无法弄清楚如何仅将过渡应用于行长。目前过渡适用于线宽和线长。提前感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:35:14.067

通过在保存变量时应用过渡，所有随后对设置属性的调用都适用于过渡结束。为防止这种情况，请在附加行后添加分号并将所有内容应用于保存的变量。

请参阅[更新的 jsfiddle](http://jsfiddle.net/FgSwa/1/)。唯一的变化基本上是

```
...
    .append("line");

line.attr("x1", ...) 
```

# c# - “拍摄日期”未显示在图像 PropertyItems 中，而它显示在 Windows 资源管理器的文件详细信息（文件属性）中

> ID：14308284
> 
> 赞同：3
> 
> 时间：2013-01-13T21:21:17.273
> 
> 标签：c#, image, windows-7, exif

我有点惊讶和不解。我尝试从图像中读取属性项。特别是，我对“拍摄日期”感兴趣。我已经写了一个程序来做到这一点。或多或少。对于某些文件，它可以完美运行，但是...

我有一些文件在属性中有“拍摄日期”（当通过 Windows 资源管理器查看时，Windows 7 x64）。它们不同于创建、修改和访问的日期。所以我确实有第四次约会。但是，如果我遍历属性项，它不会显示（在任何 ID 上）。当我在 PropertyItem.Id（0x9003 或 36867）上查找它时，我发现该属性项不存在。

我的代码循环遍历属性项：

```
 for (int i = 0; i < fileNames.Length; i++)
        {
            FileStream fs = new FileStream(fileNames[i], FileMode.Open, FileAccess.Read);
            Image pic = Image.FromStream(fs, false, false);

            int t = 0;
            foreach (PropertyItem pii in pic.PropertyItems)
            {
                MessageBox.Show(encoding.GetString(pii.Value, 0, pii.Len - 1) + " - ID: " + t.ToString());
                t++;
            }
        } 
```

仅读取“拍摄日期”属性的代码（我从这里偷了： http: [//snipplr.com/view/25074/](http://snipplr.com/view/25074/)）

```
 public static DateTime DateTaken(Image getImage)
    {
        int DateTakenValue = 0x9003; //36867;

        if (!getImage.PropertyIdList.Contains(DateTakenValue))
            return DateTime.Parse("01-01-2000");

        string dateTakenTag = System.Text.Encoding.ASCII.GetString(getImage.GetPropertyItem(DateTakenValue).Value);
        string[] parts = dateTakenTag.Split(':', ' ');
        int year = int.Parse(parts[0]);
        int month = int.Parse(parts[1]);
        int day = int.Parse(parts[2]);
        int hour = int.Parse(parts[3]);
        int minute = int.Parse(parts[4]);
        int second = int.Parse(parts[5]);

        return new DateTime(year, month, day, hour, minute, second);
    } 
```

但是，当我在 Windows 资源管理器的“文件属性窗口”中更改日期时，它开始出现在我的程序中。

所以我的问题是：这个“拍摄日期”从何而来？我怎样才能访问它？难道除了 EFIX 数据之外还有其他信息来源吗？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-13T21:29:52.490

如果您想从一些基本编码开始，您可以尝试这样的事情

// 加载你喜欢的图像。System.Drawing.Image image = new Bitmap("my-picture.jpg");

```
Referenced from AbbydonKrafts

// Get the Date Created property 
//System.Drawing.Imaging.PropertyItem propertyItem = image.GetPropertyItem( 0x132 );
System.Drawing.Imaging.PropertyItem propertyItem 
         = image.PropertyItems.FirstOrDefault(i => i.Id == 0x132 ); 
if( propItem != null ) 
{ 
  // Extract the property value as a String. 
  System.Text.ASCIIEncoding encoding = new System.Text.ASCIIEncoding(); 
  string text = encoding.GetString(propertyItem.Value, 0, propertyItem.Len - 1 ); 

  // Parse the date and time. 
  System.Globalization.CultureInfo provider = CultureInfo.InvariantCulture; 
  DateTime dateCreated = DateTime.ParseExact( text, "yyyy:MM:d H:m:s", provider ); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-06T22:16:33.433

将行更改`.ParseExact`为以下内容

```
DateTime dateCreated = DateTime.ParseExact( ConvertToString(dateTakenProperty)**.Substring(0, 19)**, "yyyy:MM:dd HH:mm:ss", provider ) 
```

在字符串的末尾可能有一个`null`无法处理的字符。为预期的长度做 a`.SubString`将解决它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-16T04:44:41.970

好吧，我正在获取图像文件的“修改”日期，而不是拍摄日期。我已经使用以下代码实现了：

```
public static System.DateTime GetImageDate(string filePath)
  {
     System.Drawing.Image myImage = Image.FromFile(filePath);
     System.Drawing.Imaging.PropertyItem propItem = myImage.GetPropertyItem(36867);
     string dateTaken = new System.Text.RegularExpressions.Regex(":").Replace(System.Text.Encoding.UTF8.GetString(propItem.Value), "-", 2);
     return System.DateTime.Parse(dateTaken);
  } 
```

# jquery - jQuery 可在两个容器之间拖放和拖放，并且可排序

> ID：14308290
> 
> 赞同：29
> 
> 时间：2013-01-13T21:21:39.470
> 
> 标签：jquery, jquery-ui-sortable, jquery-ui-draggable, jquery-ui-droppable

我正在尝试开发一个具有以下功能的小页面：

1.  页面将有两个 div：一个是#origin，包含很多缩略图，第二个是#drop，可以放置图像（最多 3 个）。
2.  需要能够将图像从#drop 拖放回原点。
3.  #drop 需要可排序，因为 3 个选定图像的顺序很重要。
4.  当放置在#drop 上时，图像应该对齐，就好像它们从一开始就是这样显示的。

我以前从未使用过 jQuery，我什至有一个工作页面原型，我已经通过原生 HTML5 拖放事件在两个容器之间进行拖放，但是当我将 sortable() jquery 功能添加到 #drop 时，图像无法再拖回#origin，这破坏了我的功能。

所以，我重新开始，想用 jQuery 实现拖放功能和可排序功能。我已经阅读了几乎所有可拖动、可放置和可排序功能的整个 API，但我无法让它工作。不确定这是否是我为每个功能使用的设置。

在小提琴上，您可以看到图像变得可拖动，并且我可以看到我指定的有效设置（不透明度、光标），但图像无法在#drop 上拖放。

据我了解，使图像可拖动、图像具有“可拖动”类以及使#drop droppable 接受“.draggable”的组合，它应该允许最基本的功能，但即使这样似乎也没有采取。另外我读到，如果可拖动和可放置都具有相同的“范围”设置，它也应该可以工作，但事实并非如此。

这是页面代码的简单版本，加上一个 jsFiddle：http: [//jsfiddle.net/39khs/](http://jsfiddle.net/39khs/)

代码：

CSS：

```
#origin {
  background-color: green;
}
#drop {
  background-color: red;
  min-height: 120px;
} 
```

js：

```
$("img").draggable({ helper: "clone", opacity: 0.5, cursor: "crosshair", scope: "drop" });
$("#drop").droppable({ accept: ".draggable", scope: "drop"});
$("#drop").sortable(); 
```

html:

```
<div id="wrapper">
    <div id="origin" class="fbox">
        <img src="http://placehold.it/140x100" id="one" title="one" class="draggable" />
        <img src="http://placehold.it/140x100" id="two" title="two" class="draggable" />
        <img src="http://placehold.it/140x100" id="three" title="three" class="draggable" />
    </div>
  <p>test</p>
    <div id="drop" class="fbox">

    </div>
</div> 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-01-13T23:03:33.797

这是最终结果的小提琴：

[http://jsfiddle.net/39khs/82/](http://jsfiddle.net/39khs/82/)

关键是处理“drop”事件并手动从#origin 中删除丢弃的图像并将其添加到#drop。这实际上是我在第一个实现中所做的，但不知道如何使用 jQuery 完全做到这一点：

```
 $(dropped).detach().css({top: 0,left: 0}).appendTo(droppedOn); 
```

我不确定为什么 jQuery 并没有真正从旧容器中删除拖动的元素并将其添加到新容器中，但这是为了使新放置的项目正确显示而不仅仅是它被放置的位置必须做的，无视 CSS 放置/样式。

关键是@Barry Pitman 在以下 SO 问题上：

[jQuery draggable + droppable：如何将放置的元素捕捉到放置的元素](https://stackoverflow.com/questions/1254665/jquery-draggable-droppable-how-to-snap-dropped-element-to-dropped-on-element)

更新：我今天有一些空闲时间，想检查一下是否可以只使用可排序的，你瞧，确实如此。

[http://jsfiddle.net/wj4ak/5/](http://jsfiddle.net/wj4ak/5/)

只需两行代码就可以从一个容器拖放到另一个容器，并对项目进行排序。它们根本不需要在 ul/ol 列表中。一件烦人的事情是我不打算让原始 div 上的项目可排序，但这是我现在可以忍受的东西。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-01-13T22:51:04.910

如果你想使用`.droppable()`, `.draggable()`, & `.sortable()`，那么你只需要使用`.sortable()`.

使用您的 jsfiddle，我进行了以下更改：

HTML：

```
<div id="wrapper">
    <div id="origin" class="fbox">
    <ul id="sort1" class="list">
      <li><img src="http://placehold.it/140x100" id="one" title="one" class="draggable" /></li>
      <li><img src="http://placehold.it/140x100" id="two" title="two" class="draggable" /></li>
      <li><img src="http://placehold.it/140x100" id="three" title="three" class="draggable" /></li>
    </ul>
    </div>
  <p>test</p>
    <div id="drop" class="fbox">
      <ul id="sort2" class="list"></ul>
    </div>
</div> 
```

JAVASCRIPT：

```
$( "#sort1, #sort2" ).sortable({
      helper:"clone", 
      opacity:0.5,
      cursor:"crosshair",
      connectWith: ".list",
      receive: function( event, ui ){ //this will prevent move than 3 items in droppable list
         if($(ui.sender).attr('id')==='sort1' && $('#sort2').children('li').length>3){
           $(ui.sender).sortable('cancel');
         }
      }
});

$( "#sort1,#sort2" ).disableSelection(); 
```

CSS：

```
#origin
{
  background-color: green;
}
#drop
{
  background-color: red;
  min-height: 120px;
}
.list
{ 
  min-height: 120px;
} 
.list li
{
 display: inline-block;
 list-style-type: none;
 padding-right: 20px;
} 
```

演示：http: [//jsfiddle.net/39khs/80/](http://jsfiddle.net/39khs/80/)

希望这会有所帮助，如果您有任何问题，请告诉我！

* * *

链接：

*   [http://api.jqueryui.com/sortable/](http://api.jqueryui.com/sortable/)

# android - 在android中的xml中绘制圆圈

> ID：14308296
> 
> 赞同：4
> 
> 时间：2013-01-13T21:22:16.377
> 
> 标签：android, layout

我正在尝试通过 android xml 显示我的布局。

这是我想要做的：

![](../Images/39623cc27543f91018643517709884d7.png)

我有**12 个按钮**，上面有一个像这样的动物图像：![](../Images/18c3b101131be1f7d0569ff6ccb031b6.png)，圆圈是背景。

我对此没有任何想法，我应该如何开始？请给我一些建议，以便我继续。我应该用什么东西来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-13T21:26:06.030

您正在寻找制作自定义视图。与往常一样，一个好的起点是 android 自己的开发站点：http: [//developer.android.com/training/custom-views/create-view.html](http://developer.android.com/training/custom-views/create-view.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:28:35.587

我认为你可以用 xml 做到这一点。这需要您在 xml 中无法进行的简单数学计算。您最扩展 View 类并创建自己的 View。然后你可以在xml中使用它。

# windows-phone-8 - 使用文件调试 WP8 本机代码

> ID：14308300
> 
> 赞同：1
> 
> 时间：2013-01-13T21:22:24.203
> 
> 标签：windows-phone-8

我正在开发一个具有一些本机代码（运行时组件）的 WP8 应用程序。在运行时组件中，我需要检查 ac 样式数组的内容。因为这个数组并不小，我认为我能做的最好的就是使用 fopen/fwrite/fclose 将数组写入一个文件；检查 fopen 和 fwrite 的返回值，我可以看到它成功了。但我找不到该文件（使用 Windows Phone Power Tools）。

那么文件写在哪里了？是否有另一种方法可以将数组的内容从 Visual Studio 转储到文件（在计算机上）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T23:07:41.473

我不熟悉 WP8 中的 fopen/fwrite/fclose API。这可能意味着它不是您可以用来提交应用程序的白名单 API。在 C++ 中使用 IsoStore 时，最好只使用“Windows::Storage::ApplicationData::Current->LocalFolder”。请参阅 Win8 代码示例 @ [http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh700361.aspx?cs-save-lang=1&cs-lang=cpp#code-snippet-1](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh700361.aspx?cs-save-lang=1&cs-lang=cpp#code-snippet-1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T20:46:04.997

谢谢贾斯汀，

这就是我最终这样做的方式：

```
auto folder = Windows::Storage::ApplicationData::Current->LocalFolder;
Concurrency::task<Windows::Storage::StorageFile^> createFileOp(
    folder->CreateFileAsync(L"Data.bin", Windows::Storage::CreationCollisionOption::ReplaceExisting));

createFileOp.then(
    [nData, pData](Windows::Storage::StorageFile^ file)
    {
        return file->OpenAsync(Windows::Storage::FileAccessMode::ReadWrite);
    })
    .then([nData, pData](Windows::Storage::Streams::IRandomAccessStream^ stream)
        {
            auto buffer = ref new Platform::Array<BYTE>(pData, nData);

            auto outputStream = stream->GetOutputStreamAt(0);
            auto dataWriter = ref new Windows::Storage::Streams::DataWriter(outputStream);                        
            dataWriter->WriteBytes(buffer);

            return dataWriter->StoreAsync();
        })
   .wait(); 
```

现在将其与我的“意思”进行比较：

```
FILE *fp = fopen("Data.bin", "wb");
if (fp)
{
    int ret = fwrite(pData, 1, nData, fp);
    fclose(fp);
} 
```

# netty - 使用多少个执行器？

> ID：14308303
> 
> 赞同：2
> 
> 时间：2013-01-13T21:22:30.813
> 
> 标签：netty

netty 代理示例对服务器和客户端 nio 套接字工厂都使用`Executors.newCachedThreadPool`了`bossExecutor`一个`workerExecutor`。
是否有一个原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:29:13.740

回顾：*老板线程*用于接受连接，而*工作线程*则执行处理来自通道的传入/传出缓冲区的实际工作。

Boss 线程通常不是很忙。此外，netty 每个端口只需要一个线程，而不是整个池。但是您可能会决定例如拥有一个线程池和一个线程到服务器 10 个端口。所有端口将共享并竞争同一个 Boss 线程。

回到你的问题：老板和工作线程使用相同的池是个好主意吗？这并不可怕，你让你的设计和维护变得更简单了。但是，由于池中的所有线程都可能被工作人员占用并且没有线程留给老板，因此存在延迟接受新连接的风险。不要认为这是一个大问题。

# ruby-on-rails-3 - 一种型号的多种不同附件 | 回形针

> ID：14308304
> 
> 赞同：1
> 
> 时间：2013-01-13T21:22:31.953
> 
> 标签：ruby-on-rails-3, upload, devise, paperclip

我想为我的用户模型添加多个不同的附件，例如头像和封面照片。我正在使用回形针。

目前可以上传新头像，但每次我想更新封面照片时，我都会收到一个错误**You are already signed in.**。我正在使用设计进行身份验证。

我的模型：

```
# Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me, :firstname, :lastname, :username, :login, :avatar

  has_many :wishes

  # Virtual attribute for authenticating by either username or email
  # This is in addition to a real persisted field like 'username'
  attr_accessor :login

  validates_uniqueness_of :username

  # hide instead of deleting
  acts_as_paranoid

  # tracking
  # include PublicActivity::Model
  # tracked owner: Proc.new{ |controller, model| controller.current_user }

  # Avatar - Paperclip
  has_attached_file :avatar,
                    :styles => { 
                      :extra_large => "600x600#",
                      :large => "400x400#",
                      :medium => "250x250#",
                      :small => "145x145#",
                      :tiny => "45x45#",
                      :icon => "16x16#"
                    },
                    :default_url => '/assets/default-user-avatar/:style.jpg'

  # Avatar - Paperclip
  has_attached_file :cover_photo,
                    :styles => { 
                      :large => "940x360#",
                      :extra_large => "1880x720#"
                    }

  # Versions
  has_paper_trail

  searchable do
    text :username, :boost => 5
    text :firstname
    text :lastname
    text :email
  end 
```

和形式：

```
<%= simple_form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => ({ :method => :put, :multipart => true })) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <%= f.input :firstname %>
    <%= f.input :lastname %>
    <%= f.input :username, :wrapper => :prepend do %>
      <span class="add-on">@</span>
      <%= f.input_field :username %>
    <% end %>
    <%= f.input :email, :required => true, :autofocus => true %>
    <%= f.input :password, :autocomplete => "off", :hint => "leave it blank if you don't want to change it", :required => false %>
    <%= f.input :password_confirmation, :required => false %>
    <%= f.input :current_password, :hint => "we need your current password to confirm your changes", :required => true %>

    Avatar:<br/>
    <%= f.file_field :avatar %><br/>
    Cover Photo:<br/>
    <%= f.file_field :cover_photo %><br/>
  </div>

  <div class="form-actions">
    <%= f.button :submit, "Update" %>
  </div>
<% end %> 
```

希望你们能帮助我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-22T08:18:18.883

您可能希望将 :cover_photo 添加到此行：

```
 attr_accessible :email, :password, :password_confirmation, :remember_me, :firstname, :lastname, :username, :login, :avatar, :cover_photo 
```

...并确保您已在数据库中设置了 cover_photo 列

# html - div 填充背景颜色作为顶栏

> ID：14308307
> 
> 赞同：1
> 
> 时间：2013-01-13T21:22:48.027
> 
> 标签：html, css

我试图在中间显示一个带有徽标图像的水平顶栏。图像位于页面左侧，垂直居中。如何在顶部栏的中心获取图像？这是我的代码：

```
<div class='topbar'>
        <img src="../../img/headerlogo.png" class="topbarlogo"/>
    </div> 
```

CSS：

```
div.topbar {
    height: 80px;
    width: 100%;
    background-color: #000000;
    margin-top: 0px;

}
.topbarlogo {
    display: block;
    position: absolute; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:27:20.107

你在 css 中拼错了你的班级，'topbor' 应该是 topbar。

另外添加：-

```
margin-left: auto;
margin-right: auto; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:37:29.850

摆脱规则`.topbarlogo`并简单地`text-align:center`为您的 div 设置规则。

**[jsFiddle 示例](http://jsfiddle.net/j08691/eabmE/1/)**

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-13T21:26:06.297

你需要清除浮动。在下面创建以下 div：

```
<div style="clear:both;"></div> 
```

应该做的伎俩。

# apache - .htaccess 301 重定向失败

> ID：14308312
> 
> 赞同：0
> 
> 时间：2013-01-13T21:23:11.623
> 
> 标签：apache, .htaccess, redirect, mod-alias

我有以下代码：

```
# 301 Redirect Old File
Redirect 301 www.website.com www.website.com/shop 
```

我希望网站自动将访问 www.website.com 或 website.com 的任何人重定向到 www.website.com/shop，但我无法让它工作，有人可以帮忙吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:27:44.377

使用[`RedirectMatch`](http://httpd.apache.org/docs/2.2/mod/mod_alias.html#redirectmatch)：

```
RedirectMatch 301 ^/$ http://www.website.com/shop 
```

请注意，正则表达式部分不包括（也不能包括）协议和主机名。`/`新 URL 可以包含协议和主机名（或者它可以仅以Apache >= 2.2.6开头）。

请注意`Redirect`（在上面的示例中未使用）使用前缀匹配——任何以指定路径*开头的请求都将匹配。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:25:57.990

您可以对根文件夹进行永久（301）重定向`'/'`：

```
Redirect 301 / www.website.com/shop 
```

临时重定向（302）：

```
Redirect 302 / www.website.com/shop 
```

301 和 302 是不同的域重定向，在同一个域中你可以这样做：

```
Redirect / www.website.com/shop 
```

# r - 计算自一周开始以来的时间？

> ID：14308318
> 
> 赞同：5
> 
> 时间：2013-01-13T21:23:48.057
> 
> 标签：r

我有一堆日期时间数据，我想看看其中是否有任何每周模式。所以我想用 R 计算自一周开始以来经过的时间（**以秒为单位）。**

我怎样才能做到这一点？我对每天使用的模式做了同样的事情，`difftime(time,as.Date(time))`但我不能在一周内使用相同的技巧，因为没有`as.Week()`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-13T21:40:22.777

您可以在基础 R 中执行此操作，并且您已经给自己答案：`difftime()`使用适当的偏移量。

即使是午夜也足够好，因为您只需将 dayOfTheWeek * 24 * 60 * 60 添加到 is，而 dayOfTheWeek 是`POSIXlt`.

如果你想要更高端的帮助程序包，我的 RcppBDT 也有一些来自 Boost Date_Time 的功能。

插图：

```
R> now <- Sys.time()
R> midnight <- trunc(now, "days")   # elegant way to get midnight; thanks @flodel
R> today <- as.POSIXlt(Sys.Date())
R> today$wday   # it is Sunday
[1] 0
R> 
R> difftime(now, midnight, unit="secs")
Time difference of 56630.6 secs
R> 
```

所以你可以添加`today$wday * 24 * 60 * 60`

```
R> as.numeric(difftime(now, midnight, unit="secs")) + today$wday*24*60*60
[1] 56630.6
R> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-13T21:52:15.827

这也是我的解决方案：

```
secs.in.week <- function(t) {
  d <- as.integer(format(t, "%w"))
  d <- ifelse(d, d-1, 6)
  weekstart <- as.POSIXct(as.Date(t)-d) - 2 * 3600  # Convert UTC -> Local time. I'm on UTC+2h
  as.numeric(difftime(t,weekstart), units="secs")
} 
```

# node.js - 如何在节点中获取当前页面的 URL？

> ID：14308322
> 
> 赞同：0
> 
> 时间：2013-01-13T21:24:25.883
> 
> 标签：node.js, express

我正在尝试为网站构建评论部分，我希望每个评论都有一个静态 URL，基本上是 domain.com/titles/postID/commentID，其中 postID 是评论回复的帖子的 ID。

这是我的代码：

```
exports.commentHandler = function(req, res){
    comment = req.body.comment;
    username = req.session.username;

    buildpost.comment(comment, username)

}; 
```

这是 buildpost.comment：

```
exports.comment = function(comment, username){
    var id = makeid(7);

    var comment = {comment: comment, user: username, postID: id, type: "comment"}

    console.log(comment);
    postdb.write(comment);

}; 
```

这是我的 app.js 文件中的相关代码：

```
app.get('/titles/:id', home.content); //this serves the post's page, where the comments are
app.post('/comment', home.commentHandler); 
```

这是玉的形式：

```
form.sbBox#commentReply(method='post', action='/comment') 
```

如果我只是在exports.commentHandler 中使用req.url 或类似的内容，它会返回'/comment'，它是发布请求的URL，而不是页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:27:25.470

然后你应该尝试 POST 到 post ID ，在 Express 中支持这一点相当容易：

```
app.post('/:postId/comments', function(req, res) {
  var postId = req.params[postId]
  ...
}) 
```

# r - 如何使用 R 绘制具有组间相似性的标签？

> ID：14308323
> 
> 赞同：-2
> 
> 时间：2013-01-13T21:24:34.007
> 
> 标签：r, cluster-analysis, hclust

当我在 R 中使用命令 hclust 绘制树状图时，我将 y 轴标记为高度。但是，我想用我的数据集中各组之间的相似度来标记这个轴，如下图所示。我怎样才能做到这一点？

![](../Images/e4c5e0ebc3fa2673cc786cc0b4666603.png)

这是一个最小的例子：

```
set.seed(1)
x = matrix(rnorm(1000), ncol=100)
d = dist(x, method="euclidean")
plot(hclust(d, method="complete")) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T04:40:06.607

从您的示例开始，但将集群结果保存为 hc：

```
set.seed(1)
x <- matrix(rnorm(1000), ncol=100)
d <- dist(x, method="euclidean")
hc <- hclust(d, method="complete")

hc$height
[1] 12.79157 13.05586 13.51490 13.54069 14.32658 14.45824 15.70899 16.44131
[9] 17.12514 
```

距离范围从 12.8 到 17.1。为简单起见，我们使用 18-d 作为相似度度量。

```
plot(hc, hang=-1, ylab="Similarity", axes=FALSE)
axis(2, seq(0, 18, by=2), seq(18, 0, by=-2)) 
```

![在此处输入图像描述](../Images/94f5b782efc398584611dcad20f7f0fa.png)

# ruby-on-rails - rails 路线的路径助手，带有安装引擎的参数

> ID：14308325
> 
> 赞同：1
> 
> 时间：2013-01-13T21:25:15.607
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, spree

嗨，我有以下路线：

```
mount Spree::Core::Engine, :at => ':city_name/', :as => :spree 
```

产生类似`/munich/path/in/engine`或的网址`/new_york/path/in/engine`

如何使用 url helper 生成这样的 url，修改城市并使用引擎的 url helper？如果引擎会为产品（例如）提供 url 帮助程序`product_path(@product)`，是否有类似的东西

```
spree_path(:city_name => "munich").product_path(@product) 
```

生成一个类似的网址`/munich/products/1`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T10:20:07.270

这应该只是工作，使用：

```
spree.product_path(@product, :city_name => "munich") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-21T02:06:50.110

正确的方法是使用 Engine 自己的 url helpers：

```
Spree::Core::Engine.routes.url_helpers.product_path 
```

# c# - 我们如何解决这种类型？

> ID：14308331
> 
> 赞同：-4
> 
> 时间：2013-01-13T21:25:45.113
> 
> 标签：c#, c#-4.0, c#-3.0, c#-2.0

```
for (int i = 2; i < k; i++)
{
    if ((tabl1[i].y != null) && (tabl[i].x != null))
    {
        double[] y2 = { 0, tabl1[i].y };
        double[] x2 = { tabl[i].x, 0 };
        PointPairList spl3 = new PointPairList(x2, y2);
    }
} 
```

我想要什么时候`i=3`创建

```
double[] y3 = { 0, tabl1[i].y }; 
double[] x3 = { tabl[i].x, 0 }; 
PointPairList spl3 = new PointPairList(x3, y3); 
```

`i=4`然后创建

```
double[] y4 = { 0, tabl1[i].y };
double[] x4 = { tabl[i].x, 0 }; 
PointPairList spl4 = new PointPairList(x4, y4); 
```

`i=5`然后创建

```
double[] y5 = { 0, tabl1[i].y };
double[] x5 = { tabl[i].x, 0 };
PointPairList spl5 = new PointPairList(x5, y5); 
```

ETC..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:49:02.290

问题绝对不是克莱尔……像这样？

```
private static Dictionary<String, PointPairList> s_PointPairLists = new Dictionary<String, PointPairList>();

private static void BuildPointPairLists(Int32 limit)
{
    for (Int32 i = 2; i < limit; ++i)
    {
        if ((tabl[i].x != null) && (tabl[i].y != null))
        {
            Double[] x = { 0, tabl[i].y };
            Double[] y = { tabl[i].x, 0 };

            s_PointPairLists[("ppl" + i.ToString())] = new PointPairList(x, y);
        }
    }
}

public static PointPairList(Int32 index)
{
    String reference = "ppl" + index.ToString();

    if (s_PointPairs.Contains(reference))
        return s_PointPairs[reference];

    return null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:36:01.660

把它变成一个函数并调用它：

```
public PointPairList GetPointPairList(int index) {
    if (tabl[index].y != null && tabl[index].x != null) {
        double[] x = { 0, tabl[index].y };
        double[] y = { tabl[index].x, 0 };
        return new PointPairList(x, y);
    }
    return null;
}

// ...
for (int i = 2; i < k; i++) {
    PointPairList ppl = GetPointPairList(i);
    // ...
} 
```

这不符合您的要求吗？没有更多的上下文很难说..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T21:36:32.077

您应该考虑使用[`Dictionary`](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)：

```
var dict = new Dictionary<int, PointPairList>();
for (int i = 2; i < k; i++)
{
    if ((tabl1[i].y != null) && (tabl[i].x != null))
    {
        double[] y2 = { 0, tabl1[i].y };
        double[] x2 = { tabl[i].x, 0 };
        dict.Add(i, new PointPairList(x2, y2));
    }
} 
```

有了它，您可以通过这种方式轻松获取例如第四项：`dict[4]`.

# python - Whoosh - 通配符搜索的性能问题（*某事）

> ID：14308334
> 
> 赞同：0
> 
> 时间：2013-01-13T21:26:00.157
> 
> 标签：python, full-text-search, whoosh

我注意到像这样的搜索`*something`会消耗大量的 CPU。我正在使用嗖嗖声 2.4.1。我想这是因为我没有涵盖此搜索案例的索引。`something*`工作正常。`*something`没有。

您如何处理这些查询？有没有一种特殊的方式来声明你的模式，这使得这种查询成为可能？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:01:44.650

这是一个非常基本的问题：前缀通常很容易找到（比如在搜索 foo* 时），而后缀则不是（比如 *foo）。

前缀 + 通配符搜索得到优化，首先进行快速前缀搜索，然后对第一步给出的结果进行慢速通配符搜索。

您无法使用 Wildcard + Postfix 进行优化。但是有个窍门：

如果你真的经常需要，你可以尝试索引一个反向字符串（也搜索反向搜索字符串），这样后缀搜索就变成了前缀搜索：

不知何故像：

```
add_document(title=title, title_rev=title[::-1])
...
# then query = u"*foo"[::-1], search in title_rev field. 
```

# r - R控制台：单行指令与多行指令

> ID：14308339
> 
> 赞同：2
> 
> 时间：2013-01-13T21:26:12.227
> 
> 标签：r, rgui

我注意到，在某些情况下（我仍然是 R 的初学者！），多行指令不能“按原样”合并为简单的行指令。举个例子，这是我最近在网上上的一节课：

```
> make.power <- function(n) {
+     pow <- function(x) {
+         x^n
+         }
+         pow
+     } 
```

是'make.power'函数的定义。然后我可以定义“立方体”或平方函数

```
> cube <- make.power(3)
> square <- make.power(2) 
```

然后，如果我尝试使用完全相同的语法在一行上定义 make.power ：

```
> make.power <- function(n) { pow <- function(x) { x^n } pow } 
```

这将在“make.power ...”中引发“意外符号”。也就是说，以下单行代码将起作用：

```
> make.power <- function(n) { pow <- function(x) { x^n }} 
```

而且，当切换到多线时，仍然可以工作！

```
> make.power <- function(n) {
+     pow <- function(x) {
+         x^n
+         }
+     } 
```

我必须承认我很困惑。我的问题如下：

1.  为什么我不能将多行代码合并到单行指令中？
2.  在函数的第一个多行定义中，为什么要在函数定义后立即调用'pow'函数，这显然是没有意义的，因为没有调用的相同代码是可以的！

编辑：在#Dwin 回答之后，下面的表达式是真的：

```
> make.power <- function(n) { pow <- function(x) { x^n }; pow } 
```

完美运行。这个也是：

```
> make.power <- function(n){; pow <- function(x) {; x^n }; pow } 
```

所以看起来“;” 在某些情况下可能是强制性的（这里，在“}”和第二个“pow”之间，而不是在其他情况下（在“{”和第一个“pow”之间）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-13T21:30:32.220

回车（或换行）分隔命令。（我之前说过它分隔“表达式”，但在 R 中，这并不是真正正确的术语。R 意义上的“表达式”实际上是用逗号分隔的。）如果你在一行中插入一个分号，你会得到相同的结果影响。尽管存在不必要的事实，但代码仍然可以作为该事实的示例：

```
make.power <- function(n) { pow <- function(x) { x^n }; pow } 
```

`help()`我很失望，在我查看的任何文件中都找不到这样的说明。我认为通过打字`?Syntax`我应该找到相关的东西。我能想到的最好的就是`help(parse)`页面，即使在那里，只有通过查看示例才能推断出这一点。我猜您应该已经阅读了“R 简介”，我有理由确定必须对其进行描述。是的，它在第 1.8 节中。

回应您的Q2：在将内部函数（...）的“<-”分配给“pow”的过程中，返回给外部函数调用的值只是未命名的函数，而不是任何具有名称的函数“战俘”。这是我对您的第一条评论的评论的重点。这可能比你从“Intro to R”中得到的更微妙的一点。当仅分配对象的一部分是最后一个命令时，有时需要该`return`函数，但在这种情况下，最紧凑的代码应该是：

```
make.power <- function(n) { function(x) { x^n } } 
```

# javascript - 使用 d3.js 在表格中显示关联数组的数据

> ID：14308340
> 
> 赞同：0
> 
> 时间：2013-01-13T21:26:17.473
> 
> 标签：javascript, arrays, d3.js, html-table, associative-array

我正在尝试使用 d3.js 在表中显示关联数组的数据，但我无法获取表中的各个值。

这是我的数组的一部分：

```
 var twitterDays = 
  [ 
    { 
      0: 
      {
        0: 0,
        1: 0,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        6: 0,
        7: 0,
        8: 0,
        9: 0,
        10: 0,
        11: 0,
        12: 0,
        13: 0,
        14: 0,
        15: 0,
        16: 0,
        17: 0,
        18: 0,
        19: 0,
        20: 0,
        21: 0,
        22: 0,
        23: 0,
        "total": 0
      },
      "day": "monday"
    },
    { 
      1: 
      {
        0: 0,
        1: 0,
        2: 0,
        3: 0,
        4: 0,
        5: 0,
        6: 0,
        7: 0,
        8: 0,
        9: 0,
        10: 0,
        11: 0,
        12: 0,
        13: 0,
        14: 0,
        15: 0,
        16: 0,
        17: 0,
        18: 0,
        19: 0,
        20: 0,
        21: 0,
        22: 0,
        23: 0,
        "total": 0
      },
      "day": "tueday"
    }, etc etc 
```

使用 d3.js，我正在向不同的键添加值。

这就是我制作桌子的方式：

```
var table = d3.select("#datavis").append("table").attr("class", "twitterTable");
var tbody = table.append("tbody");

var rows = tbody.selectAll("tr")
      .data(twitterDays)
        .enter()
        .append("tr").attr("class", function(d) { return d["day"] });

var monday = tbody.select(".monday")
        .data(d3.values(twitterDays[0][0]))
          .enter()
          .append("td")
          .text(d3.values(twitterDays[0][0])); 
```

这是我认为需要改变的部分：`.text(d3.values(twitterDays[0][0]));`

问题是我想要制作的“td”中的单个值（每个1），但是我得到每个“td”中所有值的所有值..

这就是我得到的：

```
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td>
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td> 
<td>39,25,20,11,9,8,2,3,9,36,36,48,57,58,51,50,75,63,67,58,62,74,67,64,992</td>
etc etc 
```

我想要这样：

```
<td>39</td>
<td>25</td>
<td>20</td>
<td>11</td>
<td>9</td>
<td>8</td>
<td>2</td>
etc etc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:47:08.277

问题确实出在`.text(d3.values(twitterDays[0][0]));`. 它应该是 just `.text(String);`，如下所示：http: [//jsfiddle.net/rKa2E/](http://jsfiddle.net/rKa2E/)

注意：我在这里修正了一个小错字：`var monday = tbody.select(".monday")`，你可能是说`var monday = rows.select(".monday")`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:39:32.173

我认为这条线`.text(d3.values(twitterDays[0][0]));`应该是：

```
.text(function(d){return d}); 
```

因为你已经有了数据，所以你应该包括的数据，而不是整个向量。

# java - 如何使用 spring 3.2 新 mvc 测试登录用户

> ID：14308341
> 
> 赞同：21
> 
> 时间：2013-01-13T21:26:31.570
> 
> 标签：java, spring, spring-mvc, junit

这工作正常，直到我必须测试需要登录用户的服务，如何将用户添加到上下文：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration("classpath:applicationContext-test.xml")
@WebAppConfiguration
public class FooTest {
@Autowired
private WebApplicationContext webApplicationContext;

private MockMvc mockMvc;

@Resource(name = "aService")
private AService aService; //uses logged in user

@Before
public void setup() {
    this.mockMvc = webAppContextSetup(this.webApplicationContext).build();
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-14T19:34:30.753

如果你想使用 MockMVC 和最新的 spring 安全测试包，试试这个代码：

```
Principal principal = new Principal() {
        @Override
        public String getName() {
            return "TEST_PRINCIPAL";
        }
    };
getMockMvc().perform(get("http://your-url.com").principal(principal))
        .andExpect(status().isOk())); 
```

请记住，您必须使用基于主体的身份验证才能使其正常工作。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-24T21:55:51.417

如果成功的身份验证产生了一些 cookie，那么您可以捕获它（或仅捕获所有 cookie），并在接下来的测试中传递它：

```
@Autowired
private WebApplicationContext wac;

@Autowired
private FilterChainProxy filterChain;

private MockMvc mockMvc;

@Before
public void setup() {
    this.mockMvc = MockMvcBuilders.webAppContextSetup(this.wac)
      .addFilter(filterChain).build();
}

@Test
public void testSession() throws Exception {
    // Login and save the cookie
    MvcResult result = mockMvc.perform(post("/session")
      .param("username", "john").param("password", "s3cr3t")).andReturn();
    Cookie c = result.getResponse().getCookie("my-cookie");
    assertThat(c.getValue().length(), greaterThan(10));

    // No cookie; 401 Unauthorized
    mockMvc.perform(get("/personal").andExpect(status().isUnauthorized());

    // With cookie; 200 OK
    mockMvc.perform(get("/personal").cookie(c)).andExpect(status().isOk());

    // Logout, and ensure we're told to wipe the cookie
    result = mockMvc.perform(delete("/session").andReturn();
    c = result.getResponse().getCookie("my-cookie");
    assertThat(c.getValue().length(), is(0));
} 
```

虽然我知道我没有在这里发出任何 HTTP 请求，但我有点喜欢上述集成测试与我的控制器和 Spring Security 实现更严格的分离。

为了使代码不那么冗长，我在发出每个请求后使用以下内容合并 cookie，然后在每个后续请求中传递这些 cookie：

```
/**
 * Merges the (optional) existing array of Cookies with the response in the
 * given MockMvc ResultActions.
 * <p>
 * This only adds or deletes cookies. Officially, we should expire old
 * cookies. But we don't keep track of when they were created, and this is
 * not currently required in our tests.
 */
protected static Cookie[] updateCookies(final Cookie[] current,
  final ResultActions result) {

    final Map<String, Cookie> currentCookies = new HashMap<>();
    if (current != null) {
        for (Cookie c : current) {
            currentCookies.put(c.getName(), c);
        }
    }

    final Cookie[] newCookies = result.andReturn().getResponse().getCookies();
    for (Cookie newCookie : newCookies) {
        if (StringUtils.isBlank(newCookie.getValue())) {
            // An empty value implies we're told to delete the cookie
            currentCookies.remove(newCookie.getName());
        } else {
            // Add, or replace:
            currentCookies.put(newCookie.getName(), newCookie);
        }
    }

    return currentCookies.values().toArray(new Cookie[currentCookies.size()]);
} 
```

`cookie(...)`...和一个至少需要一个 cookie的小帮手：

```
/**
 * Creates an array with a dummy cookie, useful as Spring MockMvc
 * {@code cookie(...)} does not like {@code null} values or empty arrays.
 */
protected static Cookie[] initCookies() {
    return new Cookie[] { new Cookie("unittest-dummy", "dummy") };
} 
```

...最终得到：

```
Cookie[] cookies = initCookies();

ResultActions actions = mockMvc.perform(get("/personal").cookie(cookies)
  .andExpect(status().isUnauthorized());
cookies = updateCookies(cookies, actions);

actions = mockMvc.perform(post("/session").cookie(cookies)
  .param("username", "john").param("password", "s3cr3t"));
cookies = updateCookies(cookies, actions);

actions = mockMvc.perform(get("/personal").cookie(cookies))
  .andExpect(status().isOk());
cookies = updateCookies(cookies, actions); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-13T21:28:47.217

您应该能够将用户添加到安全上下文中：

```
List<GrantedAuthority> list = new ArrayList<GrantedAuthority>();
list.add(new GrantedAuthorityImpl("ROLE_USER"));        
UsernamePasswordAuthenticationToken auth = new UsernamePasswordAuthenticationToken(user, password,list);
SecurityContextHolder.getContext().setAuthentication(auth); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-02T07:15:59.017

在 spring 4 中，这个解决方案使用会话而不是 cookie 来模拟 formLogin 和注销，因为 spring 安全测试不返回 cookie。

因为继承测试不是最佳实践，您可以在测试中@Autowire 这个组件并调用它的方法。

使用此解决方案，如果您在测试结束时调用 ，则对 的每个执行操作`mockMvc`都将被称为已验证。`performLogin``performLogout`

```
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.mock.web.MockHttpSession;
import org.springframework.stereotype.Component;
import org.springframework.test.web.servlet.MockMvc;
import org.springframework.test.web.servlet.ResultActions;
import org.springframework.test.web.servlet.request.MockHttpServletRequestBuilder;
import org.springframework.test.web.servlet.setup.MockMvcBuilders;
import org.springframework.web.context.WebApplicationContext;

import javax.servlet.Filter;

import static com.condix.SessionLogoutRequestBuilder.sessionLogout;
import static org.springframework.security.test.web.servlet.request.SecurityMockMvcRequestBuilders.formLogin;
import static org.springframework.security.test.web.servlet.response.SecurityMockMvcResultMatchers.authenticated;
import static org.springframework.security.test.web.servlet.response.SecurityMockMvcResultMatchers.unauthenticated;
import static org.springframework.security.test.web.servlet.setup.SecurityMockMvcConfigurers.springSecurity;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.redirectedUrl;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

@Component
public class SessionBasedMockMvc {

    private static final String HOME_PATH = "/";
    private static final String LOGOUT_PATH = "/login?logout";

    @Autowired
    private WebApplicationContext webApplicationContext;

    @Autowired
    private Filter springSecurityFilterChain;

    private MockMvc mockMvc;

    public MockMvc createSessionBasedMockMvc() {
        final MockHttpServletRequestBuilder defaultRequestBuilder = get("/dummy-path");
        this.mockMvc = MockMvcBuilders.webAppContextSetup(this.webApplicationContext)
                .defaultRequest(defaultRequestBuilder)
                .alwaysDo(result -> setSessionBackOnRequestBuilder(defaultRequestBuilder, result.getRequest()))
                .apply(springSecurity(springSecurityFilterChain))
                .build();
        return this.mockMvc;
    }

    public void performLogin(final String username, final String password) throws Exception {
        final ResultActions resultActions = this.mockMvc.perform(formLogin().user(username).password(password));
        this.assertSuccessLogin(resultActions);
    }

    public void performLogout() throws Exception {
        final ResultActions resultActions = this.mockMvc.perform(sessionLogout());
        this.assertSuccessLogout(resultActions);
    }

    private MockHttpServletRequest setSessionBackOnRequestBuilder(final MockHttpServletRequestBuilder requestBuilder,
                                                                  final MockHttpServletRequest request) {
        requestBuilder.session((MockHttpSession) request.getSession());
        return request;
    }

    private void assertSuccessLogin(final ResultActions resultActions) throws Exception {
        resultActions.andExpect(status().isFound())
                .andExpect(authenticated())
                .andExpect(redirectedUrl(HOME_PATH));
    }

    private void assertSuccessLogout(final ResultActions resultActions) throws Exception {
        resultActions.andExpect(status().isFound())
                .andExpect(unauthenticated())
                .andExpect(redirectedUrl(LOGOUT_PATH));
    }

} 
```

因为默认`LogoutRequestBuilder`不支持会话，我们需要创建另一个注销请求构建器。

```
import org.springframework.beans.Mergeable;
import org.springframework.mock.web.MockHttpServletRequest;
import org.springframework.mock.web.MockHttpSession;
import org.springframework.test.util.ReflectionTestUtils;
import org.springframework.test.web.servlet.request.ConfigurableSmartRequestBuilder;
import org.springframework.test.web.servlet.request.MockHttpServletRequestBuilder;
import org.springframework.test.web.servlet.request.RequestPostProcessor;
import org.springframework.util.Assert;
import org.springframework.util.StringUtils;

import javax.servlet.ServletContext;
import java.util.ArrayList;
import java.util.List;

import static org.springframework.security.test.web.servlet.request.SecurityMockMvcRequestPostProcessors.csrf;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;

/**
 * This is a logout request builder which allows to send the session on the request.<br/>
 * It also has more than one post processors.<br/>
 * <br/>
 * Unfortunately it won't trigger {@link org.springframework.security.core.session.SessionDestroyedEvent} because
 * that is triggered by {@link org.apache.catalina.session.StandardSessionFacade#invalidate()} in Tomcat and
 * for mocks it's handled by @{{@link MockHttpSession#invalidate()}} so the log out message won't be visible for tests.
 */
public final class SessionLogoutRequestBuilder implements
        ConfigurableSmartRequestBuilder<SessionLogoutRequestBuilder>, Mergeable {

    private final List<RequestPostProcessor> postProcessors = new ArrayList<>();
    private String logoutUrl = "/logout";
    private MockHttpSession session;

    private SessionLogoutRequestBuilder() {
        this.postProcessors.add(csrf());
    }

    static SessionLogoutRequestBuilder sessionLogout() {
        return new SessionLogoutRequestBuilder();
    }

    @Override
    public MockHttpServletRequest buildRequest(final ServletContext servletContext) {
        return post(this.logoutUrl).session(session).buildRequest(servletContext);
    }

    public SessionLogoutRequestBuilder logoutUrl(final String logoutUrl) {
        this.logoutUrl = logoutUrl;
        return this;
    }

    public SessionLogoutRequestBuilder session(final MockHttpSession session) {
        Assert.notNull(session, "'session' must not be null");
        this.session = session;
        return this;
    }

    @Override
    public boolean isMergeEnabled() {
        return true;
    }

    @SuppressWarnings("unchecked")
    @Override
    public Object merge(final Object parent) {
        if (parent == null) {
            return this;
        }

        if (parent instanceof MockHttpServletRequestBuilder) {
            final MockHttpServletRequestBuilder parentBuilder = (MockHttpServletRequestBuilder) parent;
            if (this.session == null) {
                this.session = (MockHttpSession) ReflectionTestUtils.getField(parentBuilder, "session");
            }
            final List postProcessors = (List) ReflectionTestUtils.getField(parentBuilder, "postProcessors");
            this.postProcessors.addAll(0, (List<RequestPostProcessor>) postProcessors);
        } else if (parent instanceof SessionLogoutRequestBuilder) {
            final SessionLogoutRequestBuilder parentBuilder = (SessionLogoutRequestBuilder) parent;
            if (!StringUtils.hasText(this.logoutUrl)) {
                this.logoutUrl = parentBuilder.logoutUrl;
            }
            if (this.session == null) {
                this.session = parentBuilder.session;
            }
            this.postProcessors.addAll(0, parentBuilder.postProcessors);
        } else {
            throw new IllegalArgumentException("Cannot merge with [" + parent.getClass().getName() + "]");
        }
        return this;
    }

    @Override
    public SessionLogoutRequestBuilder with(final RequestPostProcessor postProcessor) {
        Assert.notNull(postProcessor, "postProcessor is required");
        this.postProcessors.add(postProcessor);
        return this;
    }

    @Override
    public MockHttpServletRequest postProcessRequest(MockHttpServletRequest request) {
        for (final RequestPostProcessor postProcessor : this.postProcessors) {
            request = postProcessor.postProcessRequest(request);
            if (request == null) {
                throw new IllegalStateException(
                        "Post-processor [" + postProcessor.getClass().getName() + "] returned null");
            }
        }
        return request;
    }

} 
```

调用该`performLogin`操作后，您在测试中的所有请求都将自动以登录用户身份执行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-02-03T10:17:56.027

为什么校长的解决方案对我不起作用，因此，我想提一下另一种出路：

```
mockMvc.perform(get("your/url/{id}", 5).with(user("anyUserName"))) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-05T19:34:34.660

还有另一种方式......我使用以下注释：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration
@TestExecutionListeners(listeners={ServletTestExecutionListener.class,
    DependencyInjectionTestExecutionListener.class,
    DirtiesContextTestExecutionListener.class,
    TransactionalTestExecutionListener.class,
    WithSecurityContextTestExcecutionListener.class})
@WithMockUser
public class WithMockUserTests {
    ...
} 
```

[（资源）](https://spring.io/blog/2014/05/07/preview-spring-security-test-method-security#security-test-setup)

# jakarta-ee - Glassfish/Jersey 在扫描 REST 资源时发现已删除的文件？

> ID：14308350
> 
> 赞同：0
> 
> 时间：2013-01-13T21:27:22.507
> 
> 标签：jakarta-ee, netbeans, glassfish, jersey

当我尝试部署 REST 服务时，我在 NetBeans 中遇到错误。日志显示它正在查找三个`com.mypackage.io`不正确的根资源类，因为只有`Resource`该类实际存在。

它最初是`ResourceABC`，但我将其重命名为`Resource`. 该课程`ResourceXYZ`是我删除的课程。所有这些类都映射到相同的路径`"/"`，这就是我的 REST 服务无法加载的原因。那么为什么 Glassfish/Jersey 在这些课程甚至不存在的情况下还要选择这些课程呢？

```
INFO: Scanning for root resource and provider classes in the packages:
  com.mypackage.io
INFO: Root resource classes found:
  class com.mypackage.io.Resource
  class com.mypackage.io.ResourceABC
  class com.mypackage.io.ResourceXYZ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-08T13:08:18.470

将此添加到您的 web.xml。

```
<web-app>
    <servlet>
        <servlet-name>Jersey Web Application</servlet-name>
        <servlet-class>org.glassfish.jersey.servlet.ServletContainer</servlet-class>
        <init-param>
            <param-name>jersey.config.server.provider.packages</param-name>
            <param-value>org.foo.rest;org.bar.rest</param-value>
        </init-param>
        ...
    </servlet>
    ...
</web-app> 
```

# ios - 无法在模拟器中停止 Xcode 应用程序的执行？

> ID：14308352
> 
> 赞同：2
> 
> 时间：2013-01-13T21:27:32.163
> 
> 标签：ios, xcode

有没有人见过这个？自从我升级到 Xcode 4.5.2 后，有时当我按下 Command-R 在模拟器中运行应用程序时，Xcode 中的状态显示为“正在运行”，但应用程序从未在模拟器中启动。当我按 Command-. 时，它说它正在尝试停止，但从未停止。Xcode基本上挂了，我不得不强制退出。希望有一个简单的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:39:20.633

尝试打开模拟器并删除应用程序。还可以尝试关闭并重新打开 xcode。如果这不尝试重新启动您的计算机。如果您仍然遇到问题，那么您将不得不卸载 xcode 并重新安装它。（我多次遇到这个问题）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T23:24:07.603

奇怪，但有效。单击 Dock 中的“iOS 模拟器”图标 ( [https://stackoverflow.com/a/10277189/1514970](https://stackoverflow.com/a/10277189/1514970) )。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-03T20:51:57.420

这往往会奏效。我使用 Serge 的 find 来单击 Dock 中的图标 - 这会“唤醒”XCode，因为它需要附加到模拟器中的应用程序。即使附加永远不会发生，此时命令周期会停止 XCode 而不会挂起它并且必须执行强制退出。然后，我可以关闭模​​拟器，并执行 Command-R 从 XCode 运行。这将重新启动模拟器并附加到应用程序进程。

# jquery - 可以轮询 jQuery Ajax 查询吗？

> ID：14308353
> 
> 赞同：0
> 
> 时间：2013-01-13T21:27:37.657
> 
> 标签：jquery

我有一个 jQuery Ajax 调用，它传递输入的 sql 字符串并相应地返回数据行。因为这些可能是相当大量的数据，所以我将调用更改为跳过而不是。记录参数。这没关系，但我真正想要的是列出所有数据，因为一次调用可以返回大量数据，我希望可以将其拆分。

我想做的过程是：

*   Ajax 调用以处理数据并将行存储在某处
*   返回前 25 行
*   将 25 行添加到 div
*   获取下一个 25
*   将接下来的 25 行添加到 div
*   等，直到没有更多的行添加

以前有没有人需要做这样的事情，或者对如何通过 Ajax 获取大量数据有任何建议？作为参考，我使用的是 ASP.Net WebMethod。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:11:32.393

您可以在 AJAX 回调函数中获取更多行。您只需要跟踪已经存在多少“页面”。

```
var options = { rows : 25, offset : 0, url : 'irrelevant' },
fetchRows = function(){
    $.get( options.url, { rows : options.rows, offset : options.offset  }, render );
    options.offset++;
},
render = function( data ){
  /* perform the rendering  here */

    if( data.length == options.rows ){ /* assuming `data` is an array of rows */
        fetchRows();
    }
}; 
```

`fetchRows`发送 AJAX 请求并设置`render`为回调函数。`render`如果先前的请求返回了一个“页面”上可以容纳的行数，则再次调用`fetchRows`（在此示例中，最后一页将有 < 25 行，因此无需继续获取）。

# ruby-on-rails - 在路由级别设置权限？

> ID：14308356
> 
> 赞同：0
> 
> 时间：2013-01-13T21:27:51.557
> 
> 标签：ruby-on-rails, devise, ruby-on-rails-3.2

我是 Rails 新手，我正在使用设计进行身份验证。

我有一个名为`/users/5/events/1/add_images`current_user 只有在`@user == current_user`. 设置此权限的最佳方法是什么？这应该在控制器级别完成吗？

任何帮助，将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T21:38:39.440

是的，它应该在控制器级别完成。

您可以使用`cancan`gem 来处理授权。

[https://github.com/ryanb/cancan](https://github.com/ryanb/cancan)

[http://railscasts.com/episodes/192-authorization-with-cancan](http://railscasts.com/episodes/192-authorization-with-cancan)

粗略地说，你必须定义能力：

```
can :add_images, Event do |event|
    event.user.id == user.id
end 
```

在 events_controller 中，添加一个 before_filter

```
before_filter :find_event # set @event
before_filter :authorize_add_images, only: :add_images

def authorize_add_images
    authorize! :add_images, @event
end 
```

这是一般的想法，其余的阅读文档。

# javascript - AngularJS - 初始化和加载

> ID：14308358
> 
> 赞同：0
> 
> 时间：2013-01-13T21:28:23.880
> 
> 标签：javascript, load, angularjs, init

是否可以在负载中初始化范围和 ng-view？

**问题：**
我有一个带有经销商列表的 AngularJS 应用程序。您可以在地图上选择经销商并在路线上的覆盖 div 中打开详细信息（使用 ng-show="show" 调用它）

```
when(
    '/dealer/:id', {
    templateUrl: 'files/tpl/dealer-details.html?19',
    controller: 'DealerDetailsCtrl',
    activetab: 'details'}
). 
```

客户现在希望当客户打开页面时，会打开带有详细信息的初始详细信息叠加层。

**解决方案（可能）：**
是否可以，也许是 ng-init，将所选经销商的硬编码 :id 发送到控制器并触发详细信息覆盖，以便它在加载时打开？或者也许用 ID 触发路由。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:52:02.407

如果我对您的理解正确，您是否需要 :id 的默认值（如果未提供）？

最好的选择是`when`在你的 中有两个子句`$routeProvider`：

```
$routeProvider.when(
    '/dealer', {
    templateUrl: 'files/tpl/dealer-details.html?19',
    controller: 'DealerDetailsCtrl',
    activetab: 'details'}
);
$routeProvider.when(
'/dealer/:id', {
templateUrl: 'files/tpl/dealer-details.html?19',
controller: 'DealerDetailsCtrl',
activetab: 'details'}
); 
```

如果未定义，您可以在控制器中分配默认值：

```
$scope.dealer = $routeParams.id || 'defaultDealerId'; 
```

# ios - 并发 NSOperation，为什么要在主线程上启动？

> ID：14308359
> 
> 赞同：0
> 
> 时间：2013-01-13T21:28:26.713
> 
> 标签：ios, objective-c, cocoa-touch

我正在研究这个源代码，它演示了如何将 NSURLConnection 与 NSOperation 一起使用： [link](https://github.com/alphonsolabs/Operations-Demo/blob/master/OperationsDemo/DownloadUrlOperation.m)

我对在线代码感到困惑`76`

```
if (![NSThread isMainThread])
    {
        [self performSelectorOnMainThread:@selector(start)
                               withObject:nil waitUntilDone:NO];
        return;
    } 
```

为什么作者要确保代码在主线程上运行？

NSOperation 的全部意义不是不在主线程和后台线程中运行以使其不会阻塞吗？

代码来自这篇解释它的文章，虽然它没有回答我的问题：[http ://eng.pulse.me/concurrent-downloads-using-nsoperationqueues/](http://eng.pulse.me/concurrent-downloads-using-nsoperationqueues/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:42:03.603

从[NSURLConnection 文档](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html)中，您可以看到；

> NSURLConnection 的委托方法——由 NSURLConnectionDelegate 协议协议定义——允许对象接收有关 URL 请求异步加载的信息回调。[...]**这些委托方法在为关联的 NSURLConnection 对象启动异步加载操作的线程上调用。**

在 NSURLConnection 上启动操作适用于任何线程，但是如果您想（例如）显示进度，则在 GUI/主线程上获取委托回调非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T13:43:24.473

如果您使用 NSURLConnection 异步，则需要在主线程上启动此操作以获取回调。如果您从后台线程启动异步 NSURLConnection，如果您启动 NSURLConnection 的后台线程正忙于其他活动，您可能会丢失它的回调。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-01T08:24:36.980

如果你在主线程中调用start方法，当前操作的main方法会在主线程中运行，但是你将当前操作推送到NSOperationQueue（不是主队列），在子线程中调用start方法，在子线程中调用当前操作的main方法。

[子线程照片](http://i.stack.imgur.com/itGHV.png)

[子线程中的主要方法](http://i.stack.imgur.com/66Koc.png)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-14T02:54:52.987

原因是，在 iOS 4.0+ 上，无论操作是否并发，操作都是在后台线程中运行的。由于在这种情况下操作是并发的，因此该方法立即存在并且线程被终止，因此没有调用委托方法（NSURLConnection 调用它开始的线程上的委托方法）。

唯一的选择是，要么启动一个 NSRunLoop（非常忙碌），要么使用一个已经有一个（主线程）的线程——这就是为什么 start 方法是从主线程运行的。

与许多建议的更新 UI 无关（尽管我理解这一点，但在队列中运行 NSURLConnection 的全部原因是在单独的线程中处理委托回调以避免阻塞 UI）。这不是作者的意图，它是 UIKit 安全的事实只是一个结果。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-13T21:37:52.370

如果这是一个示例，我相信将其放入其中是为了让您了解将代码放入与不放入之间的区别。如果此代码要同时执行并且应该让您的主线程保持活动状态，那么确实该代码部分不应该存在，但是它可能已经放在那里以便您删除并查看差异。不过你确实是对的。浏览文件的其余部分，如果你想让你的主线程保持打开状态，它看起来不应该在那里。

# django - 使用 Django Haystack 自动完成

> ID：14308361
> 
> 赞同：3
> 
> 时间：2013-01-13T21:28:30.807
> 
> 标签：django, autocomplete, routing, django-haystack

我很难让自动完成功能在搜索表单中使用 haystack 和 Solr。按照此处[自动完成](http://django-haystack.readthedocs.org/en/latest/autocomplete.html)的说明，我能够通过以下方式创建我的索引。

```
class PersonIndex(indexes.RealTimeSearchIndex, indexes.Indexable):
    text = CharField(document=True, use_template=True)
    first_name = CharField(model_attr='first_name')
    last_name = CharField(model_attr='last_name')
    first_name_auto = indexes.EdgeNgramField(model_attr='first_name')

    def index_queryset(self):
        """Used when the entire index for model is updated."""
        return self.get_model().objects.all().order_by('first_name')

    def get_model(self):
        return Person 
```

通过设置我的 URL 路由的方式，我没有定向到的查看请求，搜索方法有效。

```
url(r'^search/person/', search_view_factory(
    view_class=SearchView,
    template='index.html',
    form_class=ModelSearchForm
), name='haystack_search'), 
```

说明说我们可以以这种方式执行查询

```
from haystack.query import SearchQuerySet

sqs = SearchQuerySet().filter(content_auto=request.GET.get('q', '')) 
```

但是我们将这个 SearchQuerySet 放在哪里，我不确定要覆盖什么，如何修改我的 url 以正确路由。我的搜索目前以这种方式开箱即用，但我想尝试使用 EdgeNgramField 自动完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T21:51:12.827

您需要定义自己的自定义搜索表单并告诉它如何生成`SearchQuerySet`它返回给视图，然后告诉您`search_view_factory`使用该表单而不是`ModelSearchForm`.

`SearchQuerySet`通过覆盖`ModelSearchForm`搜索方法指定您希望生成视图使用的方式：

```
from haystack.forms import ModelSearchForm

class AutocompleteModelSearchForm(ModelSearchForm):

    def search(self):
        if not self.is_valid():
            return self.no_query_found()
        if not self.cleaned_data.get('q')
            return self.no_query_found()
        sqs = self.searchqueryset.filter(first_name_auto=self.cleaned_data['q'])

        if self.load_all
            sqs = sqs.load_all()

        return sqs 
```

这现在将对表单的字段执行过滤器，`SearchQuerySet`而`first_name_auto`不是`auto_query`通常在字段上执行的过滤器`text`（查看`haystack/forms.py`原始搜索功能的样子）。

您指定要在参数列表中使用此形式`search_view_factory`

```
from path.to.your.forms import AutocompleteModelSearchForm

url(r'^search/person/', search_view_factory(
    view_class=SearchView,
    template='index.html',
    form_class=AutocompleteModelSearchForm
 ), name='haystack_search'), 
```

# java - Jbehave - @beforeStories 不起作用

> ID：14308363
> 
> 赞同：2
> 
> 时间：2013-01-13T21:28:39.327
> 
> 标签：java, configuration, annotations, jbehave

我的故事档案：

```
Narrative:
In order to document all the business logic requests
As a user
I want to work with documents

Scenario: Basic new document creation
Given a user  name Micky Mouse
When new document created
Then the document should named new document
And the document status should be NEW 
```

我的代码：

```
public class DocStories extends JUnitStory {

    @Override
    public Configuration configuration() {
        return new MostUsefulConfiguration().useStoryLoader(
                new LoadFromClasspath(getClass().getClassLoader()))
                .useStoryReporterBuilder(
                        new StoryReporterBuilder().withFormats(Format.STATS,
                                Format.HTML, Format.CONSOLE, Format.TXT));

    }

    @Override
    public List<CandidateSteps> candidateSteps() {
        return new InstanceStepsFactory(configuration(), new DocSteps())
                .createCandidateSteps();
    }

    @Override
    @Test
    public void run() throws Throwable {
        try {
            super.run();
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

} 
```

在课堂上我的步骤：

```
public class DocSteps {
    private final Map<String, User> users = new HashMap<String, User>();
    private final DocManager manager = new DocManager();

    private User activeUser;
    private Document activeDocument;
    private boolean approvedResult;

     *****************BEFORE***************//
     @BeforeStories
     private void initUsers() {
     users.put("Micky Mouse", new User("Micky Mouse", UserRole.ANALYST));
     users.put("Donald Duck", new User("Donald Duck", UserRole.BCR_LEADER));
     System.out.println("Check this out" + users.toString());
     }

    // **********steps*************//
@Given("a user name $userName")
public void connectUser(String userName) {
    // in the real world - it will get the user from the db
    System.out.println(userName);
    activeUser = new User(userName, UserRole.ANALYST);
    // System.out.println(activeDocument.getName());
}

@Given("a new document")
@When("new document created")
public void createDocument() {
    activeDocument = new Document();
}

@Given("a document with content")
public void createDocWithContect() {
    createDocument();
    activeDocument.setContent("this is a document");
}

@Then("the document should named $docName")
@Alias("the document name should be $docName")
public void documentNameShouldBe(String docName) {
    Assert.assertEquals(docName, activeDocument.getName());
}

@Then("the document status should be $status")
public void documentStatusShouldBe(String status) {
    DocStatus docStatus = DocStatus.valueOf(status);
    Assert.assertThat(activeDocument.getStatus(),
            Matchers.equalTo(docStatus));
}

    // *****************AFTER***************//
    @AfterScenario
    public void clean() {
        activeUser = null;
        activeDocument = null;
        approvedResult = false;
    }

} 
```

不执行带有“之前和之后”故事注释的方法。`enum`转换器也不能正常工作。

我的配置有什么问题（我认为这是我的配置）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:46:23.913

问题是您的方法 initUsers 是私有的。只需将其公开，JBehave 引擎就可以看到它：

```
@BeforeStories
public void initUsers() {
//...
} 
```

# ruby-on-rails - 在开发模式下使用 Rails 资产管道的不同 JS 文件？

> ID：14308367
> 
> 赞同：1
> 
> 时间：2013-01-13T21:28:54.690
> 
> 标签：ruby-on-rails, asset-pipeline

我希望在开发中使用非缩小版的 JavaScript 库，以及在其他地方使用的缩小版。

如果我使用 Rails 资产，我将如何做呢？

我包括这样的：

**应用程序.haml**

```
= javascript_include_tag :application 
```

**应用程序.js**

```
//= require jquery/jquery-1.7.2.min.js
//= require jquery/jquery-ui-1.8.20.custom.min.js
... and many more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:33:09.570

最好的办法是使用该`:debug`选项

```
= javascript_include_tag "application", debug: Rails.env.development? 
```

在调试模式下，资产**不会**被缩小。

如果您实际上维护每个库的 2 个版本*（例如，jQuery 的缩小和原始版本）*，则这是不必要的。如果您想在浏览器的控制台中查看原始 jQuery 源代码，您应该始终结合使用未缩小版本的库和`:debug`上面的选项。

*   在开发中，一个未缩小版本的 jQuery 将包含在它自己的`<script>`标签中
*   在生产中，jQuery 将被缩小并与**单个**标签`application.js`中的所有其他资产连接。 **`<script>`**

# imagemagick - 使用 ImageMagick 裁剪 40/60

> ID：14308373
> 
> 赞同：2
> 
> 时间：2013-01-13T21:29:15.663
> 
> 标签：imagemagick, imagemagick-convert

我知道如何使用`-crop 50%x100%`将图像分成两半（50/50），但有没有办法裁剪成 40/60？

如果我使用

```
convert -crop 40%x100% in.jpg out.jpg 
```

我最终得到：

```
out-0.jpg // 40%
out-1.jpg // 40%
out-2.jpg // remaining % 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T04:05:19.393

```
convert in.jpg -gravity west -crop 40%x100% +repage out1.jpg
convert in.jpg -gravity east -crop 60%x100% +repage out2.jpg 
```

我确信有一种更复杂的方法，但我会用两个命令来完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-15T17:47:01.270

您可以在一个命令中执行此操作，如下所示：

```
convert in.jpg                                                               \
  \( +clone -gravity east -crop 60x100% +repage +write east.jpg +delete \)   \
  -gravity west -crop 40x100% +repage west.jpg 
```

# asp.net - HttpModule 中的 Sitecore 上下文

> ID：14308378
> 
> 赞同：0
> 
> 时间：2013-01-13T21:29:39.573
> 
> 标签：asp.net, sitecore, sitecore6, ihttpmodule

我创建了 simple `HttpModule`，我需要的只是 get 在`Sitecore.Context`内部是有效的，但是在处理过程中我看到 my`Sitecore.Context`是某种默认值。

我可以获得登录 Sitecore 的 Sitecore 用户等。如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T09:11:21.980

我假设您有一个 Sitecore 上下文，但它为空或设置为错误的站点或语言。您可以像这样更改上下文：

```
// switch to the preferred site    
Sitecore.Context.SetActiveSite("yourSiteName");

// set the preferred database
Sitecore.Context.Database = Sitecore.Configuration.Factory.GetDatabase("master");

// set the preferred language
Language language =  Sitecore.Globalization.Language.Parse("en");
Sitecore.Context.SetLanguage = (language, false); 
```

处理完成后，您可能还想切换回原始设置。因此，明智的做法是将原始设置“保存”在变量中，以便以后可以将其更改回来

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T03:06:55.667

查看 John West 在 Sitecore 管道上的帖子，了解有关如何建立上下文的背景信息。

[http://www.sitecore.net/Community/Technical-Blogs/John-West-Sitecore-Blog/Posts/2011/05/All-About-Pipelines-in-the-Sitecore-ASPNET-CMS.aspx](http://www.sitecore.net/Community/Technical-Blogs/John-West-Sitecore-Blog/Posts/2011/05/All-About-Pipelines-in-the-Sitecore-ASPNET-CMS.aspx)

和

[http://www.sitecore.net/Community/Technical-Blogs/John-West-Sitecore-Blog/Posts/2011/05/Important-Pipelines-in-the-Sitecore-ASPNET-CMS.aspx](http://www.sitecore.net/Community/Technical-Blogs/John-West-Sitecore-Blog/Posts/2011/05/Important-Pipelines-in-the-Sitecore-ASPNET-CMS.aspx)

以下关于创建和运行自定义管道的博客文章应该让您了解如何实现自己的管道。

[http://adeneys.wordpress.com/2008/08/27/creating-and-running-custom-pipelines-in-sitecore/](http://adeneys.wordpress.com/2008/08/27/creating-and-running-custom-pipelines-in-sitecore/)

# php - 创建目录并让所有文件每次都自动加载

> ID：14308388
> 
> 赞同：0
> 
> 时间：2013-01-13T21:30:43.903
> 
> 标签：php, apache, configuration, autoloader

我想设置一个配置目录，该目录中的所有文件都会自动加载到每个页面中。

我的目标是在其中放置一堆函数和定义，例如

```
config/index.php
config/defines.php 
```

等等，让这些文件每次都自动加载。任何人都知道我该怎么做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:34:51.433

```
$files = glob('config/*.php');
foreach ($files as $file) {
    include $file;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:35:10.363

查看该[`glob()`](http://php.net/glob)函数，了解一种遍历目录中文件的简单方法。

显然，您需要确保没有任何不受信任的东西可以将文件添加到该目录。

# c++ - 可可与 c++ 库的绑定

> ID：14308391
> 
> 赞同：0
> 
> 时间：2013-01-13T21:30:52.203
> 
> 标签：c++, cocoa-bindings, nsarraycontroller

如果您必须在模型中使用 c++，是否可以使用绑定（NSArrayController 等），即模型中的所有文件都具有 .mm 扩展名。

已经用纯 Objective-C 构建了一个小型测试程序，它工作正常，但是当我尝试使用 c++ 库构建一个程序时，似乎什么也没发生，它编译并启动，但 tableviews 等什么也没发生。

人们或许不应该问是否可以使用与 c++ 的绑定，而应该问对于一个 Objective-c/cocoa 新手来说它们是否值得。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T21:49:48.170

你是对的，我替换了这个c++代码

```
/ / Get the attribute 
for (oscar :: ODStruct :: iterator iter = data.begin (); ites! = data.end (); iter + +) 
{ 
   mem = iter-> second; 
   if (mem.get (s_vals)) 
      for (auto i = s_vals.begin (); in! = s_vals.end (); i + +) 
         [_owner SetValue: [NSString string with format: @ "% s", i-> c_str ()] 
                  forKey: [NSString string with format: @ "% s", iter-> first.c_str ()]]; 
   else if (mem.get (i_vals)) 
       for (auto i = i_vals.begin (); in! = i_vals.end (); i + +) 
          [_owner SetValue: [NSString string with format: @ "% d", * i] 
                  forKey: [NSString string with format: @ "_% s", iter-> first.c_str ()]]; 
   else if (mem.get (f_vals)) 
       for (auto i = f_vals.begin (); in! = f_vals.end (); i + +) 
          [_owner SetValue: [NSString string with format: @ "% f", * i] 
                  forKey: [NSString string with format: @ "_% s", iter-> first.c_str ()]]; 
   else if (mem.get (d_vals)) 
       for (auto i = d_vals.begin (); in! = d_vals.end (); i + +) 
            [_owner SetValue: [NSString string with format: @ "% lf", * i] 
                  forKey: [NSString string with format: @ "_% s", iter-> first.c_str ()]]; 
   else 
       std :: cout << "Do not find for" << iter-> first.c_str () << std :: endl; 
```

}

使用以下 obj-c 代码

```
_owner.name = @ "test" 
_owner.type = @ "test1" 
_owner.unit = @ "test2" 
```

然后它起作用了！在课堂上留下了另一个C++ kode，所以我可能错过了“setValue：forKey：'

# windows-phone-7 - WP7 ApplicationIdleDetectionMode 和 EmailComposeTask/CameraCaptureTask/PhotoChooserTask

> ID：14308393
> 
> 赞同：1
> 
> 时间：2013-01-13T21:31:07.777
> 
> 标签：windows-phone-7, crash

我试图在这个 WP7 应用程序中找到解决方案崩溃：

1.  创建新的 WP7 应用程序。
2.  允许应用在锁定屏幕中运行：

    ```
     // in App()
    PhoneApplicationService.Current.ApplicationIdleDetectionMode = IdleDetectionMode.Disabled; 
    ```

3.  在 MainPage 中放置按钮
4.  添加运行 CameraCaptureTask 的按钮代码：

    ```
    var cameraCapture = new CameraCaptureTask();
    cameraCapture.Completed += cameraCapture_Completed;
    cameraCaptureTask.Show(); 
    ```

5.  带硬件按钮的锁屏。
6.  解锁屏幕 - 崩溃 :-(

例外：

```
 System.Runtime.InteropServices.COMException - "0x8000ffff" 
```

堆栈跟踪：

```
 at Microsoft.Phone.Execution.NativeEmInterop.NotifyFullObscurityChanged(Boolean isObscured)
    at Microsoft.Phone.Shell.PhoneApplicationService.OnFullObscurityChanged(Object sender, LockStateChangeEventArgs e)
    at Microsoft.Phone.Shell.Interop.ShellPageManager.ShellPageCallback_OnLockStateChange(Object source, LockStateChangeEventArgs e)
    at Microsoft.Phone.Shell.Interop.ShellPageCallback.FireOnLockStateChange(Boolean fLocked) 
```

它在真实硬件（Samsung Omnia W）中崩溃 - 没有模拟器。我确实使用 EmailComposeTask/CameraCaptureTask/PhotoChooserTask 对此进行了测试 - 总是崩溃。

**编辑：**

破解应用程序的步骤：

1.  项目模板：Windows Phone 应用程序
2.  目标 Windows Phone 操作系统版本：Windows Phone OS 7.1

App.xaml.cs - 只添加了一行，然后在 App 构造函数的末尾：

```
 [...]
    public App()
    {
        UnhandledException += Application_UnhandledException;
        InitializeComponent();
        InitializePhoneApplication();

        if (System.Diagnostics.Debugger.IsAttached)
        {
            Application.Current.Host.Settings.EnableFrameRateCounter = true;
            PhoneApplicationService.Current.UserIdleDetectionMode = IdleDetectionMode.Disabled;
        }

        PhoneApplicationService.Current.ApplicationIdleDetectionMode = IdleDetectionMode.Disabled;
    }
    [...] 
```

MainPage.xaml，添加按钮：

```
 <Button Content="Button" HorizontalAlignment="Left" Margin="361,262,0,0" VerticalAlignment="Top" Click="Button_Click_1"/> 
```

MainPage.xaml.cs - 添加的方法：

```
 private void Button_Click_1(object sender, RoutedEventArgs e)
    {
        PhotoChooserTask objPhotoChooser = new PhotoChooserTask();
        objPhotoChooser.Completed += objPhotoChooser_Completed;
        objPhotoChooser.Show();
    }

    private void objPhotoChooser_Completed(object sender, PhotoResult e)
    {
    } 
```

连接手机，编译并部署程序到手机，断开手机（PhotoChooserTask不适用于Zune）。在您的设备中运行程序，单击“按钮”，使用硬件按钮锁定屏幕，然后将其解锁 - 崩溃并关闭程序。您可以使用 WPConnect 而不是 Zune 来调试它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T21:14:42.123

我已经在 WP8 设备（Lumia 820 开发者版）上对此进行了测试并且工作正常。我能看到的唯一问题是，当您解锁设备时，您不会回到启动器屏幕，而是回到应用程序屏幕。我认为，该问题与 WP7 和 WP8 上启动器的低级实现中的不同方法有关。

# java - 使用 DelayQueue 执行异步任务：推迟已提交的任务

> ID：14308401
> 
> 赞同：2
> 
> 时间：2013-01-13T21:31:54.570
> 
> 标签：java, multithreading

我有一个专用于执行异步任务的线程池，使用共享的延迟队列。

基本上，一切都很好，除了一件事：我希望能够推迟一些已经安排好的任务的执行。例如，假设我现在在时间 t=0 提交了一个要在 30 秒内执行的任务。10 秒后（t=10），我决定，哦，不，该任务不会在 t=30 时执行，而是在 t=50 时执行；因此，我将其推迟到 20 秒后。

为此，我有一个推迟方法，它修改为任务设置的时间，从而改变 getDelay 的返回值。代码在这篇文章的最后。

不幸的是，它不起作用。实际上很容易破坏系统并这样做使过期的元素保留在队列中，比它们通常应该的时间长得多。更具体地说，我观察到以下不良行为：

1.  在时间 t=0，提交第一个任务在 t=30 执行
2.  在 t=10，提交第二个任务在 t=20 执行
3.  在 t=15 时，将第二个任务从 t=20 推迟到 t=100
4.  t=30 到达，但第一个任务没有执行，它留在队列中。它的 getDelay 方法现在开始返回负值。
5.  t=40：第一个任务已经晚了 10 秒，仍然没有任何反应。随着时间的推移，第一个任务的 getDelay 返回越来越小的值；DelayQueue 似乎肯定是混淆了。
6.  t=90：也许是一个希望，因为在 q.poll 调用中设置了 30 秒的最大轮询时间。事实上，不，我得到一个空值并继续等待下一个任务；我的第一个任务仍然以负延迟留在队列中。
7.  t = 100：小时！两个任务一个接一个地执行……第二个任务准时到达，但第一个任务最终迟到了 70 秒。这是无法接受的 ！

我还注意到，如果任务在进入队列时从未成为头部，我可以安全地推迟它，即不会干扰其他任务。

所以，我的问题是：

1.  为什么会这样？我在我的代码中做错了吗？
2.  我是否必须删除任务，然后再次提交，以模拟推迟？还是有另一种安全的方法？我真的可以删除一个对象，然后重新添加完全相同的对象，还是最好提交另一个对象以确保避免所有可能的混淆？
3.  额外的问题：删除操作的复杂性是多少？假设 O(n)，如果我假设队列被实现为一种优先级堆（不可能在优先级堆中进行二进制搜索）。

谢谢您的回答。

这是代码。我已经尽可能多地删除了不相关的部分。我特别删除了所有异常处理。

```
public abstract class AbstractTaskExecutor<R extends Runnable> implements Runnable {
private final BlockingQueue<R> q;
...
public boolean submit (R dr) { return q.add(dr); }
public void run () {
while (!Thread.currentThread().isInterrupted()) {
Runnable r = q.poll(30, TimeUnit.SECONDS);
if (r!=null) r.run();
}}
}

public abstract class DelayedRunnable implements Runnable, Delayed {
private long time;
public DelayedRunnable (long l) { 
time = System.currentTimeMillis() +l; 
}
public final int compareTo (Delayed d) {
return (int)( Math.min(Math.max(Integer.MIN_VALUE, time - ((DelayedRunnable)d).time), Integer.MAX_VALUE)   );
}
public final long getDelay (TimeUnit t) {
return t.convert(time - System.currentTimeMillis(), TimeUnit.MILLISECONDS);
}
public final  long getTime () { return time; }
public void postpone (long l) { time+=l; }
}

public class DelayedTaskExecutor extends AbstractTaskExecutor<DelayedRunnable> {
...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:47:22.393

> 但是仍然存在一个问题：是否可以重新安排刚刚取消的对象

如果您所做的只是更改“激活”的时间，则不是您必须将其删除，更改并重新添加，因为它可能以不同的方式放置在数据结构中。这是必需的，因为结构决定了事件的顺序，如果您只是更改值，这可能会或可能不会导致顺序更改。如果在添加后更改 Map 的键，则会遇到类似的问题。即结构的行为不正确。

* * *

我会使用 ScheduledExecutorService 来包装延迟队列和线程池。

当您放置延迟任务时，您会返回一个 Future 对象，您可以根据需要取消和重新安排。

> 在时间 t=0，提交第一个任务在 t=30 执行

将任务安排在 30 之后。

> 在 t=10，提交第二个任务在 t=20 执行

安排一个 10 以后的任务并保存未来。

> 在 t=15 时，将第二个任务从 t=20 推迟到 t=100

Future.cancel 并重新安排

> t=30 到达，但第一个任务没有执行，它留在队列中。它的 getDelay 方法现在开始返回负值。

在此示例中，除非您取消它，否则它将执行。

# list - 数据包？（城市、运动队等）

> ID：14308404
> 
> 赞同：0
> 
> 时间：2013-01-13T21:32:03.593
> 
> 标签：list, web, collections

我正在开展一个项目，该项目可以使用世界上每个城市、地区、国家的列表。无数网站使用相同的数据，所以我认为互联网上的某个地方一定有一些包含此类列表（运动队、政治家等）的数据包。

你能告诉我他们叫什么吗？有什么网站/资源可以推荐吗？图片呢，我能找到类似的图片或图标资源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-03T09:18:56.607

您可能需要的一些内容可以在[http://data.okfn.org/data/](http://data.okfn.org/data/)上找到- 例如国家、城市、地区等的列表。

# django - Django Cache Machine：在第三方或核心模型上启用 QuerySet 缓存

> ID：14308405
> 
> 赞同：1
> 
> 时间：2013-01-13T21:32:11.363
> 
> 标签：django, caching

我正在使用 Cache Machine 来缓存 QuerySet，这涉及将其添加到您的模型中：

```
class MyModel(CachingMixin, models.Model):
    objects = CachingManager() 
```

如何将此缓存应用于我无权访问的模型？例如用户或第三方模块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T08:51:18.210

为作业使用[代理模型](https://docs.djangoproject.com/en/dev/topics/db/models/#proxy-models)。由 3rd 方模型继承，覆盖`objects`并使用此类而不是原始类。

# machine-learning - 学习算法分类百分比

> ID：14308407
> 
> 赞同：0
> 
> 时间：2013-01-13T21:32:23.063
> 
> 标签：machine-learning, weka

我正在使用weka，我有一个训练集，训练集中示例的分类是布尔值。在我拥有训练集之后，我想预测新输入的百分比是真还是假。我想得到一个介于 0-1 之间的数字，而不仅仅是 o 或 1。

我怎么能这样做，我已经看到预测中只有可能的分类。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:57:48.247

你只能用学习到的分类器做出相同类型的预测——它学会做出你训练它做出的预测。你想要的那种预测听起来更像是回归。也就是说，您不想要一个严格的分类，而是一个指定成员概率的连续值。

实现您想要的最简单的方法是将训练集中的布尔值替换为 0/1 值并学习回归模型。这会给你数字，虽然不一定只在 0 和 1 之间。

要获得真实概率，您需要使用计算概率的分类器（例如朴素贝叶斯）并编写一些自定义代码（使用 Weka 库）来检索它们。请参阅使您可以访问类概率的方法[的 javadoc 。](http://weka.sourceforge.net/doc/weka/classifiers/Classifier.html#distributionForInstance%28weka.core.Instance%29)

# ios - UIView animationWithDuration 递归导致抖动

> ID：14308409
> 
> 赞同：0
> 
> 时间：2013-01-13T21:32:32.630
> 
> 标签：ios, objective-c

我试图将属性设置为原子，但它似乎无论如何都不起作用。这是代码。它移动显示正在播放的歌曲名称的标签。有时它开始抖动，就好像标签应该同时在两个地方一样。有什么线索吗？一些锁定属性可能...

```
- (void)animateSongLabel
    {
        if (!self.player.rate) {

            [UIView animateWithDuration:.5 animations:^{

                self.songLabel.left = 25.f;
            }];
            return;
        }

        [UIView animateWithDuration:.25 delay:0\. options:UIViewAnimationOptionCurveLinear animations:^{

             self.songLabel.left -= 15.f;

        } completion:^(BOOL finished) {

            if (self.songLabel.right < -10.f) {

                self.songLabel.left = 320.f;
            }
            [self animateSongLabel];
        }];
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T20:27:02.547

最简单的制作文本的最简单方法是显示动画 UIImage 或动画 UIImageView - 尤其是前者，因为它永远动画，这可能是你想要的。通过每次稍微偏移绘制文本，在代码中生成连续的 UIImage 对象，并将它们交给`animatedImageWithImages:duration:`. 现在，无论您在哪里显示该图像，它都会有动画效果。

这里有一些示例代码可以帮助您入门（调整以获得您想要的效果）：

```
NSString* s = @"Mister Dobbalena, Mister Bob Dobbalena";
NSMutableArray* marr = [NSMutableArray array];
UIFont* f = [UIFont fontWithName:@"Helvetica" size:12];
float w = [s sizeWithFont:f].width;
for (int offset = 0; offset < w; offset++) {
    UIGraphicsBeginImageContextWithOptions(self.iv.frame.size, NO, 0);
    [s drawAtPoint:CGPointMake(10-offset,20) withFont:f];
    [marr addObject: UIGraphicsGetImageFromCurrentImageContext()];
    UIGraphicsEndImageContext();
}
UIImage* im = [UIImage animatedImageWithImages:marr duration:20];
self.iv.image = im; 
```

# jquery - 使用 jQuery each() 循环遍历输入元素

> ID：14308412
> 
> 赞同：-1
> 
> 时间：2013-01-13T21:33:08.580
> 
> 标签：jquery

我写了一些代码，基本上将处理程序附加到 onsubmit 事件，但是有一个我不知道如何修复的错误。问题是当表单中的输入字段为空，并且代码进入`if`块时，它没有t在return语句后停止，下面的ajax代码也被执行了，但我不明白为什么？

```
$('document').ready(function() {
  $('form').bind('submit', function(event) {

        event.preventDefault();
        $('form input').each(function() {
            if( !$(this).val()) {
                $(this).addClass('warning');
                return;
            }
        });

        $.ajax({
            url: 'http://example.com/',
            dataType: 'json',
            type: 'GET',

         });
  });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T21:36:15.153

当您告诉 JavaScript 退出 each() 块而不是 bind 块时。处理此问题的一种方法是，如果 val() 为空，则在每个块期间将布尔值设置为 false。在每个块完成后，您可以检查布尔值并提交表单，如果它仍然为真。请参见下面的代码示例：

```
$('document').ready(function() {
  $('form').bind('submit', function(event) {
        var submit = true;
        event.preventDefault();
        $('form input').each(function() {
            if( !$(this).val()) {
                $(this).addClass('warning');
                // this is returning out of this block
                submit = false;
                return false;
            }
        });

        if (submit) {
            $.ajax({
                url: 'http://example.com/',
                dataType: 'json',
               type: 'GET',

            });
         }
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:36:55.283

您正在从调用中创建的匿名函数返回`each`。相反，您应该执行以下操作：

```
$('document').ready(function() {
  $('form').bind('submit', function(event) {

        event.preventDefault();

        var has_empty = false;
        $('form input').each(function() {
            if( !$(this).val()) {
                $(this).addClass('warning');
                has_empty = true;
            }
        });

        if(has_empty){
            return;
        }

        $.ajax({
            url: 'http://example.com/',
            dataType: 'json',
            type: 'GET',

         });
  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T21:36:58.377

您正在从您在调用中使用的回调函数返回，该回调函数`each`不会从事件处理程序中退出。

设置一个变量来标记状态：

```
$('document').ready(function() {
  $('form').bind('submit', function(event) {

    event.preventDefault();
    var ok = true;
    $('form input').each(function() {
        if( !$(this).val()) {
            $(this).addClass('warning');
            ok = false;
        }
    });

    if (ok) {
      $.ajax({
        url: 'http://example.com/',
        dataType: 'json',
        type: 'GET',

      });
    }
  });
}); 
```

# php - PHP 通过搜索找到正确的 JSON 元素

> ID：14308418
> 
> 赞同：0
> 
> 时间：2013-01-13T21:34:20.857
> 
> 标签：php, json

好的，假设我有这个 JSON 示例

```
{
    "result": [
        {
            "id": 1,
            "title": "Random Title 1",
            "description": "Random Description 1"
        },
        {
            "id": 4,
            "title": "Random Title 2",
            "description": "Random Description 2"
        },
        {
            "id": 10,
            "title": "Random Title 3",
            "description": "Random Description 3"
        }
    ]
} 
```

你注意到ID是如何间隔的吗？`[4]`因此，如果我想获得第二个“随机标题 2” ，那就不会了`[2]`。我的一些 JSON“id”正在跳过，因为我编辑 JSON 文件......无论如何，我现在想获得基于 .json 元素的 JSON 元素的标题`id`。每个 JSON 元素都有不同的 ID。

这是我现在所做的：

```
$string = file_get_contents("achievements.json");
$json_a=json_decode($string,true);

$getID = $ID_number;

$getit = $json_a['testJSON'][$getID]['title']; 
```

现在，我有，`$ID_number`但它不会与数组编号相同。以上是错误的......我该如何解决它所以我搜索`id`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:38:15.077

```
foreach ($json_a['tstJSON'] as $element) {
    if ($element['id'] == $getID) {
        $getit = $element['title'];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:41:00.023

这是我的答案：

```
<?php

$json = <<<EOF
{
    "result": [
        {
            "id": 1,
            "title": "Random Title 1",
            "description": "Random Description 1"
        },
        {
            "id": 4,
            "title": "Random Title 2",
            "description": "Random Description 2"
        },
        {
            "id": 10,
            "title": "Random Title 3",
            "description": "Random Description 3"
        }
    ]
}
EOF;

$arr = json_decode($json,true);
$res = $arr['result'];

function search_by_key_and_value($array, $key, $value)
{
    $results = array();

    if (is_array($array))
    {
        if (isset($array[$key]) && $array[$key] == $value)
            $results[] = $array;

        foreach ($array as $subarray)
            $results = array_merge($results, search_by_key_and_value($subarray, $key, $value));
    }

    return $results;
}

print("<pre>");
print_r($res);
print("</pre>");

print("<hr />");
$result = search_by_key_and_value($res,"id",4);

print("<pre>");
print_r($result);
print("</pre>");

?> 
```

希望这是你需要的

# python - 使用哪个 Python 模块来记录值随时间的变化？

> ID：14308421
> 
> 赞同：0
> 
> 时间：2013-01-13T21:34:48.167
> 
> 标签：python, automation, slider, record, timeline

这是我的任务。我有一个连接到 2 个伺服电机的 Rasberry PI。我想开发一个 GUI 应用程序，它只包含一个记录按钮和 2 个 Tkinter 的 slders。现在我想要做的是我想要一个记录按钮，按下该按钮后将记录应用程序随时间推移的所有滑块值变化。所以它几乎就像动画/自动化。

这会给我一个随着时间变化的价值的“动画”。现在我将这些值应用于伺服电机，因此它们将根据时间轴上记录的值再现运动。我的问题是我使用哪个模块来记录值随时间的变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:53:47.600

您不一定需要为此使用特殊模块。我会为`Scale`将在某处记录时间和值的元素设置一个回调。这可以通过以下方式完成：

```
import time

positions = []

def changedPosition(value):
    positions.append((time.time(), value)) 
```

确保将 changedPosition 函数作为`command`参数传递给`Scale`.

# python - Python - 在 HTTP POST 请求中发送 unicode 字符（以 \u 为前缀）

> ID：14308424
> 
> 赞同：1
> 
> 时间：2013-01-13T21:34:55.117
> 
> 标签：python, unicode

我正在编写一个程序来获取和编辑维基百科上的文章，但在处理前缀为 \u 的 Unicode 字符时遇到了一些麻烦。我已经尝试过 .encode("utf8") ，但它似乎并没有在这里奏效。如何正确编码以 \u 为前缀的这些值以发布到维基百科？请参阅[此编辑](http://en.wikipedia.org/w/index.php?title=100_Bullets&diff=prev&oldid=532920346)以了解我的问题。这是一些代码： 获取页面：

```
url = "http://en.wikipedia.org/w/api.php?action=query&format=json&titles="+urllib.quote(name)+"&prop=revisions&rvprop=content"
articleContent = ClientCookie.urlopen(url).read().split('"*":"')[1].split('"}')[0].replace("\\n", "\n").decode("utf-8") 
```

在我发布页面之前：

```
data = dict([(key, value.encode('utf8')) for key, value in data.iteritems()])
data["text"] = data["text"].replace("\\", "")
editInfo = urllib2.Request("http://en.wikipedia.org/w/api.php", urllib.urlencode(data)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:57:26.333

您正在下载 JSON 数据而不对其进行解码。为此使用[`json`库](http://docs.python.org/2/library/json.html)：

```
import json

articleContent = ClientCookie.urlopen(url)
data = json.load(articleContent) 
```

JSON 编码的数据看起来很像 Python，它也使用`\u`转义，但它实际上是 JavaScript 的一个子集。

该`data`变量现在拥有一个深度数据结构。从字符串拆分来看，你想要这件作品：

```
articleContent = data['query']['pages'].values()[0]['revisions'][0]['*'] 
```

*现在*articleContent 是一个实际的`unicode()`实例；这是您要查找的页面的修订文本：

```
>>> print u'\n'.join(data['query']['pages'].values()[0]['revisions'][0]['*'].splitlines()[:20])
{{For|the game|100 Bullets (video game)}}
{{GOCEeffort}}
{{italic title}}
{{Supercbbox  <!--Wikipedia:WikiProject Comics-->
| title =100 Bullets
| image =100Bullets vol1.jpg
| caption = Cover to ''100 Bullets'' vol. 1 "First Shot, Last Call". Cover art by Dave Johnson.
| schedule = Monthly
| format =
|complete=y
|Crime       = y
| publisher = [[Vertigo (DC Comics)|Vertigo]]
| date = August [[1999 in comics|1999]] – April [[2009 in comics|2009]]
| issues = 100
| main_char_team = [[Agent Graves]] <br/> [[Mr. Shepherd]] <br/> The Minutemen <br/> [[List of characters in 100 Bullets#Dizzy Cordova (also known as "The Girl")|Dizzy Cordova]] <br/> [[List of characters in 100 Bullets#Loop Hughes (also known as "The Boy")|Loop Hughes]]
| writers = [[Brian Azzarello]]
| artists = [[Eduardo Risso]]<br>Dave Johnson
| pencillers =
| inkers =
| colorists = Grant Goleash<br>[[Patricia Mulvihill]] 
```

# php - jqPlot 标签渲染未正确显示

> ID：14308431
> 
> 赞同：0
> 
> 时间：2013-01-13T21:35:24.140
> 
> 标签：php, javascript, jqplot

我正在使用 jqPlot 绘制一些数据，包括日期和另一个用户数据标识符。我用这段代码正确地绘制了它（我会发布一张图片，但我还没有声誉！）：

```
 <link rel="stylesheet" type="text/css" href="css/jquery.jqplot.min.css" />
    <script type="text/javascript" src="js/jquery-1.8.3.js"></script> 
    <script type="text/javascript" src="js/jquery.jqplot.min.js"></script>
    <script type="text/javascript" src="js/plugins/jqplot.dateAxisRenderer.min.js"></script>
    <script type="text/javascript" src="js/excanvas.min.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){  
         var line1=<?php echo $jqPlotArray;?>;              
         var plot2 = $.jqplot('line_chart', [line1], {                  
             axes:{        
               xaxis:{          
                  renderer:$.jqplot.dateAxisRenderer,          
                  tickOptions:{formatString:'%b %y'}        
               }      
             },      
             series:[{color:'#01812a', lineWidth:1, markerOptions:{style:'filledCircle', color:'#01812a', size:'6'}}] 
         });
      });
      </script> 
```

但是，当我尝试将两个轴标签格式化为 WHITE 和 9pt 字体时，它会使用此代码错误地绘制（同样，我会发布图像但还不能）：

```
 <link rel="stylesheet" type="text/css" href="css/jquery.jqplot.min.css" />
    <script type="text/javascript" src="js/jquery-1.8.3.js"></script> 
    <script type="text/javascript" src="js/jquery.jqplot.min.js"></script>
    <script type="text/javascript" src="js/plugins/jqplot.dateAxisRenderer.min.js"></script>
    <script type="text/javascript" src="js/plugins/jqplot.categoryAxisRenderer.min.js"></script>
    <script type="text/javascript" src="js/excanvas.min.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){  
         var line1=<?php echo $jqPlotArray;?>;              
         var plot2 = $.jqplot('line_chart', [line1], {                  
             axes:{        
               xaxis:{          
                  renderer:$.jqplot.dateAxisRenderer,
                  renderer:$.jqplot.categoryAxisRenderer,           
                  tickOptions:{formatString:'%b %y', textColor:'#FFFFFF', fontSize:'9pt'}        
               }      
             },      
             series:[{color:'#01812a', lineWidth:1, markerOptions:{style:'filledCircle', color:'#01812a', size:'6'}}] 
         });
      });
      </script> 
```

总之，我的问题是我需要什么渲染器以及如何使用它们将 x 和 y 轴标签简单地格式化为白色字体颜色（因此标签更好地弹出我的绿色背景）并将 fontSize 更改为 9pt。

任何帮助都感激不尽。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T00:37:34.830

如果您的 xaxis 有日期，您为什么还要尝试使用 categoryAxisRenderer？

我认为主要问题是缺少大写字母：

```
renderer:$.jqplot.DateAxisRenderer //The D is Date is a capital 
```

[在这里](http://jsfiddle.net/vWP5J/2/)看小提琴。

# jquery - 在 escape_javascript 中使用 javascript 变量

> ID：14308443
> 
> 赞同：0
> 
> 时间：2013-01-13T21:36:39.023
> 
> 标签：jquery, ruby-on-rails, escaping, string-interpolation

我一直在尝试使以下工作：我希望 jQuery 函数在单击具有 ID 的某个 div 时加载特定的部分。我希望这个 ID 成为我与部分一起使用的 :locals 的一部分。

```
$("#main>.dots").live("mousedown", function(e) {
        $num = 8;
        $("#main").append("<%= escape_javascript(render :partial => 'projects/show',     :locals => {:i => "#{$num}"}).html_safe %>")
    }) 
```

到目前为止，我还没有把它弄好。上面的代码返回“为 nil 调用的 id”，因此 $num 没有正确地提供给 escape_javascript 函数。当我用整数 8 替换 $num 时，它可以工作（在 <% %> 标签之间）。

有什么解决办法吗？

语法：

```
$("#main").append("<%= escape_javascript(render :partial => 'projects/show', :locals => {:i => 8}).html_safe %>") 
```

工作，所以这就是我想去的方式，除了 8 是 jQuery 的当然

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T16:30:44.593

我已经解决了这个问题

```
var dataString = "projectid=" + $(this).attr("id") + "&left=" + $(this).css("left") + '&top=' + $(this).css("top");
    $.ajax({
        url: "/projects/show",
        type: "get",
        data: dataString,
        success: function(data) {
            $("#main").append(data)
        }
    }); 
```

所以基本上我使用了 AJAX，所以我可以将 POST 数据发送到正确的控制器操作:)

# php - 管理员登录和上传安全

> ID：14308444
> 
> 赞同：0
> 
> 时间：2013-01-13T21:36:48.450
> 
> 标签：php, html

我有一个漫画网站，我想轻松地将图像路径上传到数据库。

我有一个登录屏幕，用于检查正确的凭据：

```
 <?php 

        $username = isset($_POST['username']) ? $_POST['username'] : "";
        $password = isset($_POST['pw']) ? $_POST['pw'] : "";

        if($_SERVER['REQUEST_METHOD'] == 'POST') {
            if(verify($username, $password) == 1) {
                header("Location: ?action=admin");
            }
            else {
                echo "<center>Incorrect credentials</center>";
            }
        }

        function verify($user, $pw) {
            include './scripts/dbconnect.php';

            $result = $mysqli->query("SELECT username, password FROM users WHERE username='" . $user . "' AND password='" . $pw . "'"); 

            return $result->num_rows;
        }

        include 'include/footer.php';
        ?> 
```

然后将它们登录到上传屏幕。

不幸的是，用户所要做的就是猜测我上传页面的 url 可能是什么，他们可以跳过我的登录屏幕......

/HTwS/?action=login （只需将 'login' 替换为 'admin' 就可以了……）所以，我的第一道防线是不要让我的上传页面名称如此明显……但是会发生什么如果用户仍然猜到...我可以用另一种方式验证，不会让他们只更改网址吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:40:48.603

好吧，这很不安全。您要做的是在登录时设置一些会话变量（`$_SESSION[user_id]`,`$_SESSION[permission_type]`等...）。然后，您可以`verifyAdmin()`在每个管理页面的顶部使用一个功能，通过检查`$_SESSION`您刚刚设置的变量来检查登录用户是否实际上是管理员。如果不是，他们将被重定向到登录页面。

当管理员登录时，设置一些会话变量，如下所示：

```
$_SESSION[user_id] = id_of_admin;
$_SESSION[permission_type] = 'admin'; 
```

verifyAdmin 看起来像这样：

```
function verifyAdmin() {
   if(!isset($_SESSION[username]) || !isset($_SESSION[permission_type]) || $_SESSION[permission_type] != 'admin'){
        header("Location: login.php");
    }
} 
```

然后在每个管理页面的顶部，您可以简单地执行以下操作：

`verifyAdmin();`

您的验证功能应如下所示：

```
function verify($user, $pw) {
    include './scripts/dbconnect.php';
    $result = $mysqli -> query("SELECT username, password FROM users WHERE username='" . $user . "' AND password='" . $pw . "'");
    if ($result -> num_rows == 1) {
        $_SESSION[username] = $user;
        $_SESSION[permission_type] = 'admin';
    }
    return $result -> num_rows;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:14:11.757

这段代码也容易受到 SQL 注入的影响。您需要清理这些 $_POST 变量。

# java - SWT 透明按钮/标签

> ID：14308445
> 
> 赞同：4
> 
> 时间：2013-01-13T21:36:53.547
> 
> 标签：java, swt

我已经研究了几天。似乎大多数人都希望将按钮放置在透明的画布或外壳上。我需要在画布/组件上放置透明的可点击对象。在我的测试中，我发现如果我不尝试将对象放在画布上，它就永远不会显示。

在最终项目中，该应用程序将显示带有一些我计划使用图像的控件的动画对象。

在我试图解决的示例中，我采用了 Snipped195，它显示了一个转动的圆环。我试图在圆环上放置一个图像标签，这样当圆环转动时，它将通过透明的标签区域显示。我已经设置了一个红色加号并具有透明背景的 gif 文件。我还拿起了一些代码（现在不记得它来自哪里），它是paintControl 方法的一部分，用于查找透明像素并构建一个 Region 对象。区域对象显然正在做它需要做的事情来定义图像的去向。我是否需要以某种方式将该区域应用于图像而不是画布？

起初，当我尝试这样做时，确实显示了图像。但是在透明区域显示白色的地方。在实现paintControl 代码后，它至少正确处理了透明区域。现在我需要获取要显示的实际图像内容。

我构建了一个对象来处理图像标签。我称它为透明图像标签。看起来像：

```
public class TransparentImageLabel extends Canvas {

    private Image labelImage;

    public TransparentImageLabel(Composite parent, Image image, int style) {
        super(parent, style);
        this.labelImage = image;
        addDisposeListener(new DisposeListener() {
            public void widgetDisposed(DisposeEvent e) {
                TransparentImageLabel.this.widgetDisposed(e);
            }
        });
        addPaintListener(new PaintListener() {
            public void paintControl(PaintEvent e) {
                TransparentImageLabel.this.paintControl(e);
            }
        });
    }

    private void widgetDisposed(DisposeEvent e) {

    }

    private void paintControl(PaintEvent event) {
        System.out.println("at paint control");
        ImageData imgData = this.labelImage.getImageData();
        Region region = new Region();
        if (imgData.alphaData != null) {
            Rectangle pixel = new Rectangle(0, 0, 1, 1);
            for (int y = 0; y < imgData.height; y++) {
                for (int x = 0; x < imgData.width; x++) {
                    if (imgData.getAlpha(x, y) == 255) {
                        pixel.x = imgData.x + x;
                        pixel.y = imgData.y + y;
                        region.add(pixel);
                    }
                }
            }
        } else {
            ImageData mask = imgData.getTransparencyMask();
            Rectangle pixel = new Rectangle(0, 0, 1, 1);
            for (int y = 0; y < mask.height; y++) {
                for (int x = 0; x < mask.width; x++) {
                    if (mask.getPixel(x, y) != 0) {
                        pixel.x = imgData.x + x;
                        pixel.y = imgData.y + y;
                        region.add(pixel);
                    }
                }
            }
        }
        this.setRegion(region);
        event.gc.drawImage(labelImage, this.getBounds().x, this.getBounds().y);
        region.dispose();
    }
} 
```

将此添加到 Snipped195 后，代码如下所示：

```
public class Snippet195 {

    private Image redPlus;

    static void drawTorus(float r, float R, int nsides, int rings) {
        float ringDelta = 2.0f * (float) Math.PI / rings;
        float sideDelta = 2.0f * (float) Math.PI / nsides;
        float theta = 0.0f, cosTheta = 1.0f, sinTheta = 0.0f;
        for (int i = rings - 1; i >= 0; i--) {
            float theta1 = theta + ringDelta;
            float cosTheta1 = (float) Math.cos(theta1);
            float sinTheta1 = (float) Math.sin(theta1);
            GL11.glBegin(GL11.GL_QUAD_STRIP);
            float phi = 0.0f;
            for (int j = nsides; j >= 0; j--) {
                phi += sideDelta;
                float cosPhi = (float) Math.cos(phi);
                float sinPhi = (float) Math.sin(phi);
                float dist = R + r * cosPhi;
                GL11.glNormal3f(cosTheta1 * cosPhi, -sinTheta1 * cosPhi, sinPhi);
                GL11.glVertex3f(cosTheta1 * dist, -sinTheta1 * dist, r * sinPhi);
                GL11.glNormal3f(cosTheta * cosPhi, -sinTheta * cosPhi, sinPhi);
                GL11.glVertex3f(cosTheta * dist, -sinTheta * dist, r * sinPhi);
            }
            GL11.glEnd();
            theta = theta1;
            cosTheta = cosTheta1;
            sinTheta = sinTheta1;
        }
    }

    private Snippet195() {
        final Display display = new Display();
        Shell shell = new Shell(display, SWT.NO_REDRAW_RESIZE);
        shell.setLayout(new FillLayout());
        Composite comp = new Composite(shell, SWT.NONE);
        comp.setLayout(new FillLayout());
        GLData data = new GLData();
        data.doubleBuffer = true;
        redPlus = new Image(shell.getDisplay(), new ImageData(
                Snippet237.class.getResourceAsStream("/red-plus.png")));
        final GLCanvas canvas = new GLCanvas(comp, SWT.NONE, data);

        canvas.addPaintListener(new PaintListener() {
            public void paintControl(PaintEvent e) {
                e.gc.setAlpha(15);
                e.gc.drawImage(Snippet195.this.redPlus, 0, 0);
            }
        });

        canvas.setCurrent();
        try {
            GLContext.useContext(canvas);
        } catch (LWJGLException e) {
            e.printStackTrace();
        }

        canvas.addListener(SWT.Resize, new Listener() {
            public void handleEvent(Event event) {
                Rectangle bounds = canvas.getBounds();
                float fAspect = (float) bounds.width / (float) bounds.height;
                canvas.setCurrent();
                try {
                    GLContext.useContext(canvas);
                } catch (LWJGLException e) {
                    e.printStackTrace();
                }
                GL11.glViewport(0, 0, bounds.width, bounds.height);
                GL11.glMatrixMode(GL11.GL_PROJECTION);
                GL11.glLoadIdentity();
                GLU.gluPerspective(45.0f, fAspect, 0.5f, 400.0f);
                GL11.glMatrixMode(GL11.GL_MODELVIEW);
                GL11.glLoadIdentity();
            }
        });

        GL11.glClearColor(1.0f, 1.0f, 1.0f, 1.0f);
        GL11.glColor3f(1.0f, 0.0f, 0.0f);
        GL11.glHint(GL11.GL_PERSPECTIVE_CORRECTION_HINT, GL11.GL_NICEST);
        GL11.glClearDepth(1.0);
        GL11.glLineWidth(2);
        GL11.glEnable(GL11.GL_DEPTH_TEST);
        TransparentImageLabel redPlusLabel = new TransparentImageLabel(canvas,
                redPlus, SWT.NONE);
        redPlusLabel.setSize(48, 48);
        redPlusLabel.setLocation(500, 200);
        shell.setText("SWT/LWJGL Example");
        shell.setSize(880, 720);
        shell.open();
        final Runnable run = new Runnable() {
            int rot = 0;

            public void run() {
                if (!canvas.isDisposed()) {
                    canvas.setCurrent();
                    try {
                        GLContext.useContext(canvas);
                    } catch (LWJGLException e) {
                        e.printStackTrace();
                    }
                    GL11.glClear(GL11.GL_COLOR_BUFFER_BIT
                            | GL11.GL_DEPTH_BUFFER_BIT);
                    GL11.glClearColor(.3f, .5f, .8f, 1.0f);
                    GL11.glLoadIdentity();
                    GL11.glTranslatef(0.0f, 0.0f, -10.0f);
                    float frot = rot;
                    GL11.glRotatef(0.15f * rot, 2.0f * frot, 10.0f * frot, 1.0f);
                    GL11.glRotatef(0.3f * rot, 3.0f * frot, 1.0f * frot, 1.0f);
                    rot++;
                    GL11.glPolygonMode(GL11.GL_FRONT_AND_BACK, GL11.GL_LINE);
                    GL11.glColor3f(0.9f, 0.9f, 0.9f);
                    drawTorus(1, 1.9f + ((float) Math.sin((0.004f * frot))), 25, 75);
                    canvas.swapBuffers();
                    display.asyncExec(this);
                }
            }
        };
        canvas.addListener(SWT.Paint, new Listener() {
            public void handleEvent(Event event) {
                run.run();
            }
        });
        display.asyncExec(run);

        while (!shell.isDisposed()) {
            if (!display.readAndDispatch())
                display.sleep();
        }
        display.dispose();
    }

    public static void main(String[] args) {
        new Snippet195();
    }
} 
```

我必须靠近。定义为透明的图像区域被绘制为透明。但是除了图像中的红色而不是白色加号之外，我什么也没得到。

![在此处输入图像描述](../Images/d44c37d571d57fd681c40b67529286b8.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T15:40:18.813

The problem is in your `TransparentImageLabel#paintControl(..)` method. Correct the second last line to the following:

```
event.gc.drawImage(labelImage, 0, 0); 
```

Since you are drawing within the context of the canvas so the coordinates you specify for location should be relative to that `Canvas`. You are currently using the location of `canvas` which is returned relative to it's parent.

# css - 无法在 Windows 8 HTML5 应用程序中使用某些颜色

> ID：14308449
> 
> 赞同：13
> 
> 时间：2013-01-13T21:37:14.923
> 
> 标签：css, windows, windows-8, microsoft-metro

出于某种原因，当我将 Windows 8 应用程序中的背景颜色设置为`#0D0D0D`or`#EEEEEE`时，它分别显示为`#111111`or `#F2F2F2`。

这是一个错误，还是有原因？对于随机的其他颜色似乎很好，但由于某种原因，当我将它设置为黑色和白色之间的颜色时，它要求它改变。我也尝试过切换到 RGB 颜色，但它仍然无法正常工作。

这真的没什么大不了的，但我是一个完美主义者，令人沮丧的是颜色与我的设计略有不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T02:47:05.303

我有同样的问题，我所做的是将十六进制值更改为 rgb，或者如果它是确切的颜色名称，我将该名称应用于十六进制值。您可以在线找到许多在线颜色转换器。希望这可以帮助。

# python - Python。使用 random 命令生成随机 + 或 - 符号

> ID：14308450
> 
> 赞同：3
> 
> 时间：2013-01-13T21:37:16.120
> 
> 标签：python, python-2.7

在将其分配给字母时，使用导入随机函数生成随机、、或符号的最简单方法是`+`什么。`-``*``/`

例如

```
g = answeryougive('+','-') 
```

提前致谢 ：）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-13T21:37:55.753

你要[`random.choice`](http://docs.python.org/2/library/random.html#random.choice)

```
random.choice(['+', '-']) 
```

或更简洁地说：

```
random.choice('+-') 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2015-06-19T09:10:52.203

谢谢我正在做我的GCSE很大的帮助

有几种方法可以做到这一点，但最好的方法是使用 random.choice 随机符号或 random.radiant 数字例如。

```
import random
Num1=random.radiant(1,12) #random number one
Num2=random.radiant(1.12) #random number two
sym=random.choice(['+','/','*'.'-']) #random symbol 
```

# google-app-engine - 使用按键排序进行非祖先查询时，我的结果会按实体组排序吗？

> ID：14308455
> 
> 赞同：2
> 
> 时间：2013-01-13T21:37:45.413
> 
> 标签：google-app-engine, google-cloud-datastore

我需要更改相当数量的属于不同实体组的实体。如果我进行非祖先查询，按键排序，例如：

```
Query query = new Query( "Kind" )
                      .setFilter( ... )
                      .addSort( Entity.KEY_RESERVED_PROPERTY, ASC or DESC ); 
```

我总是有一个按实体组排序的结果吗？我计划遍历结果，直到父（或祖父）键更改，并为同一组中的所有实体创建单个事务 - 以避免争用。

这会按预期工作吗？还有什么建议吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T16:33:11.147

是的。按键排序按祖先列表中的每个实体对它们进行排序——例如，首先按根实体，然后按它们的子实体，等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T13:10:02.313

Kindles 查询或祖先查询只能按 KEY 排序。

您正在按键排序，这没关系。

键是 PARENT+KIND+ID 的结果

每个种类的密钥都是密钥的一部分。因此，您的所有结果都将按种类排序，然后按关键字排序。

来自[GAE KEYS](https://developers.google.com/appengine/docs/python/datastore/keyclass)

> 每个模型实例都有一个标识键，其中包括实例的实体类型以及唯一标识符。标识符可以是密钥名称字符串，由应用程序在创建实例时显式分配，也可以是整数 ID，由 App Engine 在实例写入（放置）到数据存储区时自动分配。

# image - 轮播图像高度缩小

> ID：14308463
> 
> 赞同：2
> 
> 时间：2013-01-13T21:38:15.907
> 
> 标签：image, twitter-bootstrap, height, carousel, shrink

我的索引页面上有一个轮播，但我注意到如果我缩小浏览器，图像不会留在整个轮播中。

如果你不明白我的意思，下面是缩小浏览器后的轮播图：![在此处输入图像描述](../Images/626966fb6ebcb8faf607a81be97d89d7.png)

如您所见，图像的宽度会响应浏览器窗口的大小，但高度不会，因此会在图像下方留下很大的空白。

这是我当前的代码：

```
<div class='carousel slide' id='hero' style='position: absolute;'>
<div class='carousel-inner' style='z-index: -1'>
<div class='active item'>
    <img src='images/index/img1.jpg'>
</div>
<div class='item'>
    <img src='images/index/img2.jpg'>
</div>
<div class='item'>
    <img src='images/index/img3.jpg'>
</div>
<div class='item'>
    <img src='images/index/img4.jpg'>
</div>
<div class='item'>
    <img src='images/index/img5.jpg'>
</div>
<div class='item'>
    <img src='images/index/img6.jpg'>
</div>
</div>
</div> 
```

如何使轮播中的图像响应较小的浏览器窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T17:46:15.153

因此，经过更多研究，我自己修复了它。

在 CSS 中，我有这个：

```
.carousel-inner {
    overflow:hidden;
    width:100%;
    position:relative;
} 
```

我通过放置图像的尺寸而不是 100% 宽度来修复它，所以：

```
.carousel-inner {
    overflow:hidden;
    width:1920px;
    height:1200px;
    position:relative;
} 
```

# android - DialogFragment getArguments 给 NPE

> ID：14308465
> 
> 赞同：0
> 
> 时间：2013-01-13T21:38:23.580
> 
> 标签：android

嗨，我正在编写一个对话框片段并尝试使用 getArguments 和 setArguments 传递一些数据，但是在使用 getArguments 检索数据时，我得到了一个 NPE。

```
public class EditNameDialog extends DialogFragment{

public static EditNameDialog newInstance(int type){

    EditNameDialog thedialog=new EditNameDialog();
    Bundle bundle=new Bundle();
    Log.v("typ",type+"");//-->logs fine here
    bundle.putInt("mytype", type);
    thedialog.setArguments(bundle);
    return thedialog;

}

public Dialog onCreateDialog(Bundle icic){

    String ok="Play";
 //I get a NPE here in the below line
    switch(getArguments().getInt("mytype")){ 

    case 1:
    case 2:
        ok="Play";
        break;
    case 3:
        ok="Show";
        break;
    case 4:
        ok="Show";
        break;

    }
    //show alert dialog etc etc here

}

 } 
```

有人可以看看这个并告诉我我会在这里错过什么。

编辑：-这就是我调用对话框片段的方式：-

```
 DialogFragment newFragment = EditNameDialog.newInstance(1);
 newFragment.show(getSupportFragmentManager(), "mydialog"); 
```

LogCat 如下所示：-

```
01-14 12:52:58.557: E/AndroidRuntime(17271): FATAL EXCEPTION: main
01-14 12:52:58.557: E/AndroidRuntime(17271): java.lang.NullPointerException
01-14 12:52:58.557: E/AndroidRuntime(17271):    at com.civil.dialogs.EditNameDialog.onCreateDialog(EditNameDialog.java:79)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at android.support.v4.app.DialogFragment.getLayoutInflater(DialogFragment.java:295)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:911)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1088)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:682)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1444)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at android.support.v4.app.FragmentManagerImpl$1.run(FragmentManager.java:429)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at android.os.Handler.handleCallback(Handler.java:725)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at android.os.Looper.loop(Looper.java:137)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at android.app.ActivityThread.main(ActivityThread.java:5039)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at java.lang.reflect.Method.invokeNative(Native Method)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at java.lang.reflect.Method.invoke(Method.java:511)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
01-14 12:52:58.557: E/AndroidRuntime(17271):    at dalvik.system.NativeStart.main(Native Method) 
```

# sqlite - 在 SQLite 中将文本转换为数字

> ID：14308467
> 
> 赞同：53
> 
> 时间：2013-01-13T21:38:31.367
> 
> 标签：sqlite

我有一个带有以下结构 LocationName Latitude Longitude 的表的sqlite DB，所有定义为varchar。我如何构造一个 sql 语句来获取具有特定纬度范围的所有位置，以十进制给出纬度。有没有办法即时从 varchar 转换为十进制值？或者我必须逐步执行 return 语句并手动进行转换

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2013-01-13T21:42:05.163

[请参阅http://www.sqlite.org/lang_expr.html](http://www.sqlite.org/lang_expr.html)上的“CAST 表达式” 。

```
SELECT CAST('3.02' as decimal)
-- they aren't real decimals in sqlite, though. beware floats. 
```

# windows-phone - 将私有应用程序部署到 Windows 8 手机

> ID：14308468
> 
> 赞同：2
> 
> 时间：2013-01-13T21:38:36.737
> 
> 标签：windows-phone, windows-phone-8

> **可能重复：**
> [您能否在 Windows 7 手机上安装您自己的应用](https://stackoverflow.com/questions/4229029/can-you-install-you-own-apps-on-your-windows-7-phone)
> [程序 在 Windows 8 Pro 上侧载应用程序](https://stackoverflow.com/questions/12008252/sideloading-apps-on-windows-8-pro)

我打算购买 Windows 8 手机并将一些应用程序移植到系统中供私人使用。然而，我读[了这篇](http://blogs.tieto.com/mobileworld/2012/08/28/windows-phone-8-app-deployment/)关于部署过程的文章，这让我很害怕。如果我对这篇文章的理解正确，你只能让微软在市场上的每个人都可以访问它们之前检查你的应用程序，或者你使用一些矫枉过正的企业部署生态系统，这也需要各种审查过程。有没有办法只创建一个安装包，把它放在 sd 卡上然后安装它，而不需要任何额外的开销？也许将应用程序交给几个朋友，他们也可以使用它。

我来自 android 背景，这种简单的安装过程很常见。这与 Windows 8 手机相比如何？可能有一些开发模式吗？开发人员至少必须能够在手机上调试他们的应用程序......我在互联网上真的找不到太多信息，这很奇怪。

**编辑：我刚刚**[在这里](https://stackoverflow.com/questions/13669696/test-windows-phone-8-app-on-actual-device?rq=1)读到，您需要一个昂贵的开发帐户来测试手机上的应用程序。在安装所需的 Windows 8 操作系统以便能够为 Windows 8 手机开发安装 Visual Studio 后，我的模拟器无法启动，因为我的 PC 不支持一些奇怪的虚拟化功能。这使得开发应用程序变得非常容易......

# javascript - phoneGap inApp 浏览器问题

> ID：14308475
> 
> 赞同：0
> 
> 时间：2013-01-13T21:39:11.013
> 
> 标签：javascript, cordova

即使我将 phoneGap inApp Browser 升级到 2.3.0 版本，我也遇到了一些问题。

现在，我们的移动应用程序基本上只是将用户引导到我们的移动站点（换句话说，页面不在应用程序本身）。

在移动网站中，我使用了类似 window.open(url, '_blank', 'location=yes');

每当用户点击它时，它都能正常工作并在用户使用浏览器访问我们的移动网站时打开另一个窗口。

但是当用户使用该应用程序时，它不再工作，它只是在同一个窗口中加载页面。

我只是将 window.open(....) 子句放在我的应用程序的 index.html 中，它工作正常并且确实打开了另一个窗口。但是在访问我们的页面时它会中断，即使对于相同的 window.open(...) 子句。

有人帮帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T09:20:21.413

所以这`window.open(url, '_blank', 'location=yes');`行得通但`window.open(url, '_self', 'location=yes');`行不通？

你添加 `<access origin=".*"/>`到你的 config.xml 了吗？

# android - SQLite 插入数据条目两次

> ID：14308482
> 
> 赞同：1
> 
> 时间：2013-01-13T21:39:39.610
> 
> 标签：android, sqlite, android-sqlite

我遇到了一个问题，即该项目被两次插入到我的数据库中。我没有 2 个插入语句。

我正在尝试检查数组的元素是否为空。

这是我的代码片段

在我的主要活动中

```
private String[] dateTimeDispStr= new String[2]; 
```

在 onCreate 中：

```
dateTimeDispStr[0]=null;
dateTimeDispStr[1]=null; 
```

同一活动的其他部分：

```
//-------------------------------------------update time----------------------------------------//    
public void updatetime()
{
    dateTimeDispStr[0]=new StringBuilder()
    .append(pad(mhour)).append(":")
    .append(pad(mminute)).toString();

    tdv.editRow(this, dateTimeDispStr);
    if(dateTimeDispStr[1]!=null){
        update();
    }

}

//-------------------------------------------update date----------------------------------------//    
private void updateDate() {
    dateTimeDispStr[1]=new StringBuilder()
    // Month is 0 based so add 1
    .append(mMonth + 1).append("/")
    .append(mDay).append("/")
    .append(mYear).append(" ").toString();

    tdv.editRow(this, dateTimeDispStr);
    if(dateTimeDispStr[0]!=null){
        update();
    }

}

SimpleDateFormat formatter = new SimpleDateFormat("MM/dd/yyyy HH:MM");

public void update(){
    Calendar cal = Calendar.getInstance();
    cal.set(mYear, mMonth + 1, mDay, mhour, mminute, 0);
    String date = formatter.format(cal.getTime());

    tdi.setDate(date.split(" ")); // split makes an array of ["date", "time"]
    db.addItem(tdi);
    Log.d("Item set in the db", "The item: " + date);
} 
```

这是我的数据库处理程序

```
// Adding new ToDoItem
public void addItem(ToDoItem item) {
        SQLiteDatabase db = this.getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(KEY_TASK, item.getTDItem()); // item task
        values.put(KEY_DATE, item.getDate()); // item date
        values.put(KEY_PRIORITY, item.getPriority()); // item priority

        // Inserting Row
        db.insert(TABLE_TDL, null, values);
        db.close(); // Closing database connection
    } 
```

tdv.editRow 编辑我的 UI 上扩展表格布局的行。我将在几秒钟内添加检查 null 的功能。它本质上附加了已经具有待办事项任务的行，但是我想将日期和时间添加到该行

我知道我在这两种方法中都调用了更新，但那是因为如果用户首先单击任一按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:50:55.937

而不是所有这些，我会简单地获取一个日历实例，用您的日期/时间变量填充它，并使用 DateFormat 来构建一个本地化的字符串。

自己试试这个`update()`：

```
// Create a field variable
SimpleDateFormat formatter = new SimpleDateFormat("MM/dd/yyyy hh:mm"); // HH for 24hr

public void update(){
    Calendar cal = Calendar.getInstance();
    cal.set(mYear, mMonth + 1, mDay, mhour, mminute, 0);
    String date = formatter.format(cal.getTime());

    tdi.setDate(date.split(" ")); // split makes an array of ["date", "time"]
    db.addItem(tdi);
    Log.d("Item set in the db", "The item: " + date);
} 
```

（我目前没有可用的编译器，所以请原谅任何小缺陷......）
阅读有关自定义 SimpleDateFormat 字符串的[信息](http://developer.android.com/reference/java/text/SimpleDateFormat.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:50:11.607

是的，您没有 2 个插入语句，但您调用了**addItem()**方法两次。

假设您需要在更新时间时从代码中更新日期和时间。您调用**update()**方法，该方法调用将项目插入数据库的**addItem()**方法。接下来，当您更新同一项目的日期时，您再次调用**update() ，该方法调用****addItem()**方法将项目再次插入数据库。

希望这有帮助

# c# - 弹出输入框

> ID：14308492
> 
> 赞同：-1
> 
> 时间：2013-01-13T21:40:41.393
> 
> 标签：c#, winforms, visual-studio-2010

我正在尝试弹出一个输入框，要求用户输入类似于`messagebox.show`. 但我希望用户能够在框中输入内容，以便我可以使用返回数据进行验证。

系统将检查用户是否已通过身份验证，否则将通过弹出窗口请求身份验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:45:57.597

假设您在 WinForms 中，您需要做的是创建一个新表单，为其添加一个文本框和按钮，然后在未通过身份验证时调用它。

```
public partial class Form1
{
    public void Main()
    {
    bool authenticated = ...

    if(!authenticated)
    {
       Your_Form newForm = new Your_Form();
       newForm.Show(this);
       string password = newForm.Password;
       if(password != "")
           ...
    }
    }
    }

public class Your_Form
{
public TextBox textBox1 = new TextBox();
// ...
public string Password = "";

private void button1_Click(object sender, EventArgs e)
{
   this.Password = textBox1.Text;
}
// ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:49:14.560

我将不得不假设您使用的是 Winforms，但此代码也可以转换为 WPF 或 web。您需要`DisplayDialog()`从您的父表单中使用，以显示您的辅助表单，即弹出窗口。这会将您的新表单显示为对话框。最重要的是，当它关闭时，它总是向父表单发送回一个`DialogResult`（[在此处](http://support.microsoft.com/kb/816145)和[此处](http://www.dotnetperls.com/dialogresult)解释），您可以使用它来确定用户是否已通过身份验证。 [这篇](http://www.xtremedotnettalk.com/showthread.php?t=70285)文章解释了如何做一些与我认为你想要的非常相似的事情

# javascript - 需要将所有 javascript 包装在 try-catch 块中吗？

> ID：14308496
> 
> 赞同：0
> 
> 时间：2013-01-13T21:41:02.447
> 
> 标签：javascript, jquery, ruby-on-rails, asset-pipeline

我注意到清单文件中包含的一些 javascript 文件没有运行。我相信这是因为在清单列表中较高的文件之一中引发了异常，因此它下面的文件中的代码没有在 application.js 中运行。

这个解释有意义吗？自从升级到 Rails 3.2.11 后，我才注意到这一点。

我应该将代码包装在 try catch 块中的每个单独文件中吗？处理这个问题的最佳方法是什么？

大多数代码使用 jquery 并向 document.ready 添加处理程序。

# php - 从php数组中删除数字键

> ID：14308507
> 
> 赞同：0
> 
> 时间：2013-01-13T21:42:42.200
> 
> 标签：php, arrays, numbers, key-value

我想处理可能如下所示的 JSON 数据结构：

```
$json = {"1":"some content here","hello":"world"}; 
```

我使用 PHP 中的 json_decode 方法将其转换为数组：

```
$myArray = (array)json_decode($json); 
```

我现在的问题是

```
unset($myArray["1"]); 
```

什么都不做。

你能给我什么建议吗？我也试过：

```
unset($myArray[(String)"1"]); 
```

谢谢！

编辑：我的问题有错误，感谢评论中的更正！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:49:25.767

我认为您只是访问了错误的数组

```
unset($myArray["1"]);
unset($myArray[1]); // works also 
```

# java - 尝试提交查询时出现 NullPointerException

> ID：14308508
> 
> 赞同：-3
> 
> 时间：2013-01-13T21:42:47.263
> 
> 标签：java

我正在尝试执行 java 程序，但似乎当前代码在这段代码上返回空指针异常：

```
IntegerDesc yearOfBuildDesc = 
     (IntegerDesc) myConcept.getAllAttributeDescs().get("yearOfBuild");
try {
    query.addAttribute(yearOfBuildDesc,
        yearOfBuildDesc.getAttribute("yearOfBuild"));
}
catch (ParseException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

你知道问题可能来自哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:46:10.063

可能是以下之一：

*   `myConcept`是`null`，所以`.getAllAttributeDescs()`摔倒了。
*   `myConcept.getAllAttributeDescs()`返回`null`，所以`.get("yearOfBuild")`摔倒了。
*   `myConcept.getAllAttributeDescs().get("yearOfBuild")`return `null`，导致`yearOfBuildDesc`当`null`你调用`getAttribute`它时，这会导致异常。
*   `query`是`null`，导致`.addAttribute(...)`跌倒。
*   方法内部的某些内容在`getAllAttributeDescs`调用时会导致空指针异常。
*   方法内部的某些内容在`get`调用时会导致空指针异常。
*   方法内部的某些内容在`addAttribute`调用时会导致空指针异常。
*   方法内部的某些内容在`getAttribute`调用时会导致空指针异常。
*   您的初始代码抛出 a `ParseException`，对其`printStackTrace`方法的调用随后抛出空指针异常（不太可能）。

一般来说，在寻找空指针异常时，您应该寻找以下问题：

*   选择表达式（即`x.y`） - 可以`x`吗`null`？
*   方法调用 - 方法可以抛出空指针异常吗？

我已经排除了这里的可能性，因为这`e`是`null`你刚刚发现的例外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T21:44:10.103

`yearOfBuildDesc`可能为空。在 try catch 中使用之前进行测试

`myConcept`也可能为空，请检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T21:46:13.933

```
yearOfBuildDesc.getAttribute("yearOfBuild"); 
```

`NullPointerException`如果为空，上面的行将抛出`yearOfBuildDesc`，添加一个空检查。

# ios - iOS 声音在静音时播放

> ID：14308510
> 
> 赞同：1
> 
> 时间：2013-01-13T21:42:58.683
> 
> 标签：ios, objective-c, audio

我正在为幼儿制作一个字母学习应用程序，但我遇到了声音输出问题。在我的 ipad 上测试时，应用程序播放的每个声音都具有相同的音量，无论设备的声音设置为最大还是静音。换句话说，无论设备的音量设置如何，都会发出相同的声级。

我用来播放声音的代码是（以 A-sound 为例）：

```
- (IBAction)aSpill:(id)sender {
    CFBundleRef mainBundle = CFBundleGetMainBundle();
    CFURLRef soundFileURLRef;
    soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (CFStringRef) @"aLyd", CFSTR("wav"), NULL);
    UInt32 soundID;
    AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
    AudioServicesPlaySystemSound(soundID); 
```

任何帮助深表感谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T23:37:33.130

请在此处查看答案[AudioServicesPlaySystemSound Volume？](https://stackoverflow.com/questions/10855874/audioservicesplaysystemsound-volume) 它解释了系统声音并不总是使用系统音量。

我建议使用 AVAudioPlayer 来播放你的声音。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-13T21:52:12.173

所以从这里开始：http: [//developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/MultimediaPG/UsingAudio/UsingAudio.html](http://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/MultimediaPG/UsingAudio/UsingAudio.html)

尝试使用以下代码遵循代码。

```
NSString *soundFilePath =
            [[NSBundle mainBundle] pathForResource: @"sound"
                                            ofType: @"wav"];

NSURL *fileURL = [[NSURL alloc] initFileURLWithPath: soundFilePath];

AVAudioPlayer *newPlayer =
            [[AVAudioPlayer alloc] initWithContentsOfURL: fileURL
                                                   error: nil];
[fileURL release];

self.player = newPlayer;
[newPlayer release];

[player prepareToPlay]; 
```

它大约在页面的一半处。

# python - 如何在 matplotlib 图中将 xtick 标签年份缩写为 2 位数字

> ID：14308512
> 
> 赞同：2
> 
> 时间：2013-01-13T21:43:15.967
> 
> 标签：python, matplotlib, pandas

我有一个超过 10 年的时间序列，并且想将 xtick 标签缩写为 2 位数的年份。我怎样才能做到这一点 ？

```
import matplotlib.pyplot as plt
import datetime as dt
import pandas as pd
import pandas.io.data as web

stocklist = ['MSFT']

# read historical prices for last 11 years
def get_px(stock, start):
    return web.get_data_yahoo(stock, start)['Adj Close']

today = dt.date.today()
start = str(dt.date(today.year-11, today.month, today.day))
px = pd.DataFrame({n: get_px(n, start) for n in stocklist})
plt.plot(px.index, px[stocklist[0]])
plt.show() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:01:22.100

这以可疑的方式深入研究了`pandas`内部结构，但是

```
ax = plt.gca()
ax.get_xaxis().get_major_formatter().scaled[365] = '%y'
plt.draw() 
```

[格式规范](http://docs.python.org/2/library/datetime.html#strftime-strptime-behavior)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-10T17:15:19.023

我找到了这段代码，你可以修改格式：

```
ax = plt.gca()
xax = ax.get_xaxis()  # get the x-axis
adf = xax.get_major_formatter()  # get the auto-formatter

adf.scaled[1\. / 24] = '%H:%M'  # set the < 1d scale to H:M
adf.scaled[1.0] = '%Y-%m-%d'  # set the > 1d < 1m scale to Y-m-d
adf.scaled[30.] = '%y-%b'  # set the > 1m < 1Y scale to Y-m
adf.scaled[365.] = '%Y'  # set the > 1y scale to Y 
```

注意上面写着的那一行`adf.scaled[30.] = '%y-%b' # set the > 1m < 1Y scale to Y-m`。little`y`表示 2 位数的年份（大 Y 为 4 位数），little`b`表示 3 字符的月份（小 m 表示数字月份）。我相信这些是 Python 中非常标准的格式类型。

# spring-mvc - Maven-Jetty-Spring-Hibernate

> ID：14308513
> 
> 赞同：2
> 
> 时间：2013-01-13T21:43:23.290
> 
> 标签：spring-mvc, jetty, maven-3

我有春季项目。我之前在 tomcat 和 weblogic 下运行过它，我必须在 Jetty 下运行它，但我不知道如何正确配置事务管理器。因为当我按照这些步骤[链接](http://rafaelfiume.wordpress.com/2012/04/28/setup-java-development-environment/#comment-101)并运行项目“mvn jetty:run”时，我得到了类似的东西

**“INFO:oejpw.PlusConfiguration:No Transaction manager found - 如果您的 webapp 需要一个，请配置一个。”**

但是我的 application-context.xml 中有事务管理器我使用 JDNI，我在项目的 META-INF 文件夹中配置了它，并且 jndi 与 tomcat 和 weblogic 配合得很好，我在我的 web.xml 中为码头创建了特别注释

```
<resource-ref>
     <description>My DataSource Reference</description>
     <res-ref-name>jdbc/JNDI_and_DS</res-ref-name>
     <res-type>javax.sql.DataSource</res-type>
     <res-auth>Container</res-auth>
  </resource-ref> 
```

所以我已将它添加到 web.xml 但我仍然没有声称码头的事务管理器。

我在 application-context.xml 中的事务管理器

```
 <bean id="multipartResolver"
    class="org.springframework.web.multipart.commons.CommonsMultipartResolver">

    <!-- one of the properties available; the maximum file size in bytes -->
    <property name="maxUploadSize" value="4500000000000" />
</bean>

<bean id="sessionFactory"
    class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource">
        <ref bean="dataSourceJndi" />
    </property>
    <property name="packagesToScan">
        <list>
            <value>my.package</value>
        </list>
    </property>
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.PostgreSQLDialect</prop>
            <prop key="hibernate.show_sql">true</prop>
            <prop key="hibernate.hbm2ddl.auto">update</prop>

        </props>
    </property>
</bean>

<bean id="dataSourceJndi" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName" value="java:comp/env/jdbc/JNDI_and_DS" />
    <property name="resourceRef" value="true" />
</bean>

<bean id="transactionManager"
    class="org.springframework.orm.hibernate4.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean> 
```

但我也忘了补充说我无法通过正确的 url 获取我的应用程序并且也会出现异常

```
java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.eclipse.jetty.webapp.IterativeDescriptorProcessor.visit(IterativeDescriptorProcessor.java:80)
        at org.eclipse.jetty.webapp.IterativeDescriptorProcessor.process(IterativeDescriptorProcessor.java:67)
        at org.eclipse.jetty.webapp.MetaData.resolve(MetaData.java:332)
        at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1219)
        at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:699)
        at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:454)
        at org.mortbay.jetty.plugin.JettyWebAppContext.doStart(JettyWebAppContext.java:256)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
        at org.eclipse.jetty.server.handler.HandlerCollection.doStart(HandlerCollection.java:224)
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:167)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
        at org.eclipse.jetty.server.handler.HandlerCollection.doStart(HandlerCollection.java:224)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
        at org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:90)
        at org.eclipse.jetty.server.Server.doStart(Server.java:263)
        at org.mortbay.jetty.plugin.JettyServer.doStart(JettyServer.java:65)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
        at org.mortbay.jetty.plugin.AbstractJettyMojo.startJetty(AbstractJettyMojo.java:511)
        at org.mortbay.jetty.plugin.AbstractJettyMojo.execute(AbstractJettyMojo.java:364)
        at org.mortbay.jetty.plugin.JettyRunMojo.execute(JettyRunMojo.java:516)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
Caused by:
java.lang.IllegalStateException: Nothing to bind for name javax.sql.DataSource/default
        at org.eclipse.jetty.plus.webapp.PlusDescriptorProcessor.bindEntry(PlusDescriptorProcessor.java:890)
        at org.eclipse.jetty.plus.webapp.PlusDescriptorProcessor.bindResourceRef(PlusDescriptorProcessor.java:807)
        at org.eclipse.jetty.plus.webapp.PlusDescriptorProcessor.visitResourceRef(PlusDescriptorProcessor.java:247)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.eclipse.jetty.webapp.IterativeDescriptorProcessor.visit(IterativeDescriptorProcessor.java:80)
        at org.eclipse.jetty.webapp.IterativeDescriptorProcessor.process(IterativeDescriptorProcessor.java:67)
        at org.eclipse.jetty.webapp.MetaData.resolve(MetaData.java:332)
        at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1219)
        at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:699)
        at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:454)
        at org.mortbay.jetty.plugin.JettyWebAppContext.doStart(JettyWebAppContext.java:256)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
        at org.eclipse.jetty.server.handler.HandlerCollection.doStart(HandlerCollection.java:224)
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:167)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
        at org.eclipse.jetty.server.handler.HandlerCollection.doStart(HandlerCollection.java:224)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
        at org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:90)
        at org.eclipse.jetty.server.Server.doStart(Server.java:263)
        at org.mortbay.jetty.plugin.JettyServer.doStart(JettyServer.java:65)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
        at org.mortbay.jetty.plugin.AbstractJettyMojo.startJetty(AbstractJettyMojo.java:511)
        at org.mortbay.jetty.plugin.AbstractJettyMojo.execute(AbstractJettyMojo.java:364)
        at org.mortbay.jetty.plugin.JettyRunMojo.execute(JettyRunMojo.java:516)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352) 
```

当我必须为码头定义事务管理器时，请帮助我不知道有多复杂。因为我知道我可以在码头文件夹中做到这一点，但我不会。我宁愿很高兴使用我目前的约定来做这件事。更透明;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T22:49:45.807

我解决了这个问题，在部署应用程序之前，应该在码头内部配置 jndi 数据源。

# iphone - XCode：Apple Mach-O Linker Error with New iOS 6 ABAddressBook 函数

> ID：14308517
> 
> 赞同：0
> 
> 时间：2013-01-13T21:43:42.510
> 
> 标签：iphone, ios, xcode, ios6, abaddressbook

我正在使用导入的 IOS 6 SDK 运行 Xcode 4.2（旧 Mac 无法运行 XCode 4.5）。我的应用程序配置了 4.3 的 iOS 部署目标、6.0 的基本 SDK 和 armv7 的体系结构。

我正在尝试更新我以前工作的应用程序以请求访问用户地址簿的权限，这现在是 iOS 6 的要求（使用新的 iOS 6 功能）。不幸的是，我收到以下 Apple Mach-O 链接器错误：

> ld /Users/Blake/Library/Developer/Xcode/DerivedData/MyApp-ercibgqhpidlmwflixmwbvruyctz/Build/Products/Debug-iphoneos/MyApp.app/MyApp normal armv7 cd /Users/Blake/Desktop/MyApp/MyApp setenv IPHONEOS_DEPLOYMENT_TARGET 4.3 setenv PATH " /Developer/Platforms/iPhoneOS.platform/Developer/usr/bin:/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin" /Developer/Platforms/iPhoneOS.platform/Developer/usr /bin/clang -arch armv7 -isysroot /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.0.sdk -L/Users/Blake/Library/Developer/Xcode/DerivedData/MyApp-ercibgqhpidlmwflixmwbvruyctz/Build/Products/调试-iphoneos -L/Users/Blake/Desktop/MyApp/MyApp/../../../Downloads/ScannerKit-Latest/Demo/Libraries/ScannerKit -F/Users/Blake/Library/Developer/Xcode/DerivedData/MyApp-ercibgqhpidlmwflixmwbvruyctz/Build/Products/Debug-iphoneos -filelist /Users/Blake/Library/Developer/Xcode /DerivedData/MyApp-ercibgqhpidlmwflixmwbvruyctz/Build/Intermediates/MyApp.build/Debug-iphoneos/MyApp.build/Objects-normal/armv7/MyApp.LinkFileList -dead_strip -all_load -lstdc++ -fobjc-arc -miphoneos-version-min=4.3 -framework AddressBook -framework AddressBookUI -framework UIKit -framework Foundation -framework CoreGraphics -lScannerKit -framework AVFoundation -framework CoreMedia -framework SystemConfiguration -framework CoreVideo -liconv -framework AudioToolbox -framework QuartzCore -o /Users/Blake/Library/Developer/Xcode/ DerivedData/MyApp-ercibgqhpidlmwflixmwbvruyctz/Build/Products/Debug-iphoneos/MyApp.app/MyApp应用程序/我的应用程序应用程序/我的应用程序build/Objects-normal/armv7/MyApp.LinkFileList -dead_strip -all_load -lstdc++ -fobjc-arc -miphoneos-version-min=4.3 -framework AddressBook -framework AddressBookUI -framework UIKit -framework Foundation -framework CoreGraphics -lScannerKit -framework AVFoundation -框架 CoreMedia -framework SystemConfiguration -framework CoreVideo -liconv -framework AudioToolbox -framework QuartzCore -o /Users/Blake/Library/Developer/Xcode/DerivedData/MyApp-ercibgqhpidlmwflixmwbvruyctz/Build/Products/Debug-iphoneos/MyApp.app/MyAppbuild/Objects-normal/armv7/MyApp.LinkFileList -dead_strip -all_load -lstdc++ -fobjc-arc -miphoneos-version-min=4.3 -framework AddressBook -framework AddressBookUI -framework UIKit -framework Foundation -framework CoreGraphics -lScannerKit -framework AVFoundation -框架 CoreMedia -framework SystemConfiguration -framework CoreVideo -liconv -framework AudioToolbox -framework QuartzCore -o /Users/Blake/Library/Developer/Xcode/DerivedData/MyApp-ercibgqhpidlmwflixmwbvruyctz/Build/Products/Debug-iphoneos/MyApp.app/MyApp3 -framework AddressBook -framework AddressBookUI -framework UIKit -framework Foundation -framework CoreGraphics -lScannerKit -framework AVFoundation -framework CoreMedia -framework SystemConfiguration -framework CoreVideo -liconv -framework AudioToolbox -framework QuartzCore -o /Users/Blake/Library/Developer/Xcode /DerivedData/MyApp-ercibgqhpidlmwflixmwbvruyctz/Build/Products/Debug-iphoneos/MyApp.app/MyApp3 -framework AddressBook -framework AddressBookUI -framework UIKit -framework Foundation -framework CoreGraphics -lScannerKit -framework AVFoundation -framework CoreMedia -framework SystemConfiguration -framework CoreVideo -liconv -framework AudioToolbox -framework QuartzCore -o /Users/Blake/Library/Developer/Xcode /DerivedData/MyApp-ercibgqhpidlmwflixmwbvruyctz/Build/Products/Debug-iphoneos/MyApp.app/MyApp
> 
> 架构 armv7 的未定义符号：
> “ **_ABAddressBookRequestAccessWithCompletion** ”，引用自：ServerConnect.o 中的-[ServerConnect parserDidEndDocument:]“ **_ABAddressBookGetAuthorizationStatus** ”，引用自：ServerConnect.o 中的-[ServerConnect parserDidEndDocument:]“ **_ABAddressBookCreateWithOptions** ”，引用自：-[ServerConnect ServerConnect.o ld 中的 parserDidEndDocument:]：未找到架构 armv7 clang 的符号：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）

我最好的猜测是 XCode 4.2 正在寻找 iPhoneOS5.0.sdk 而不是我的 iPhoneOS6.0.sdk 架构 armv7。但是，我看不到在哪里可以解决此问题。以前有没有其他人遇到过这个问题？提前感谢您的帮助！

我的代码（供参考）：

```
// Fetch the address book 
//Check if we are using iOS6
if ([self isABAddressBookCreateWithOptionsAvailable]) {
        ABAddressBookRef addressBook = ABAddressBookCreateWithOptions(NULL, NULL);

        if (ABAddressBookGetAuthorizationStatus() == 0) {
            ABAddressBookRequestAccessWithCompletion(addressBook, ^(bool granted, CFErrorRef error) {
                // First time access has been granted
                [self searchForPersonInAddressBook:addressBook withName:fullName];
            });
        }
        else if (ABAddressBookGetAuthorizationStatus() == 3) {
            // The user has previously given access
            [self searchForPersonInAddressBook:addressBook withName:fullName];
        }
        else {
            // The user has previously denied access
            UIAlertView *deniedAccess=[[UIAlertView alloc] initWithTitle:@"Unable to Access Address Book" message:@"Change App Privacy Settings" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
            [deniedAccess show];
        }
    }
    //If using iOS 4/5
    else {
        ABAddressBookRef addressBook = ABAddressBookCreate();
        [self searchForPersonInAddressBook:addressBook withName:fullName];
    }
}

- (void)searchForPersonInAddressBook:(ABAddressBookRef )ab
                withName:(NSString *)fn
{
// Search for the person in the address book
CFArrayRef person = ABAddressBookCopyPeopleWithName(ab, (__bridge CFStringRef)fn);
// Display message if person not found in the address book 
if ((person != nil) && (CFArrayGetCount(person) == 0)) {
    // Show an alert if name is not in Contacts
    UIAlertView *saveContact=[[UIAlertView alloc] initWithTitle:@"Save New Contact to iPhone?" message:fn delegate:self cancelButtonTitle:@"No" otherButtonTitles:@"Save!", nil];
    saveContact.tag = 2;
    [saveContact show];
}
}

- (BOOL)isABAddressBookCreateWithOptionsAvailable
{
     return &ABAddressBookCreateWithOptions != NULL;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:42:45.237

如果您没有将框架链接到您的项目，这就是您通常会遇到的错误类型。所以你可能导入了你的头文件（因此没有编译时错误）但是，你没有添加`AddressBook.framework`from`TargetName->Build Phases->Link Binary With Libraries`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T07:46:34.817

I solved my problem through weak linking the AddressBook Frameworks in the "Link Binary with Libraries" Section of my Target's Build Phases Settings ("Optional" instead of "Required").

Also, I believe there is an XCode4.2 bug in which it duplicates the device destination. For some reason, after choosing the duplicate, my app was able to compile (See the following link: [How to access weak linked framework in iOS?](https://stackoverflow.com/questions/8580775/how-to-access-weak-linked-framework-in-ios)).

# perl - Perl TCP、打印、选择和 sysread - 缓冲行为

> ID：14308518
> 
> 赞同：2
> 
> 时间：2013-01-13T21:43:44.397
> 
> 标签：perl, tcp, buffer

客户端：

```
$socket->autoflush(1);
print $socket "abel\n";
print $socket "baker\n";
print $socket "charlie\n"; 
```

我的问题：

当服务器的`select()`（或）完成时，我对系统缓冲区`can_read`的内容有什么保证？`receive`它是否可以包含一个“a”？还是“abel\nbak”？或者系统缓冲区是否*保证*包含从客户端中相应的“打印”语句发送的字符串中的一个、两个或全部三个？

这显然对我如何管理应用程序级缓冲区有影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:46:09.883

TCP（和一般的 SOCK_STREAM）没有这样的保证。您列出的任何内容都是可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T00:52:55.030

没有任何保证。"a" 和 "abel\nbak" 都是可能的。

`sysread`如果有可用数据，则不会阻塞；它将返回可用的内容。因此，您可以使用

```
for my $fh (@ready) {
   my $close = 0;
   my $client = $clients{$fh};

   our $buf; local *buf = $client->{buf};
   my $rv = sysread($buf, 0, 64*1024, length($buf)); 
   if ($rv) {
      while ($buf =~ s/^(.*)\n//) {
         my $msg = $1;
         $close = 1 if process_msg($msg);
      }
   } else {
      $close = 1;
      # Handle error and eof here.
   }

   if ($close) {
      $readers->delete($fh);
      delete $clients->{$fh};
   }
} 
```

# matlab - 在Matlab中迭代地取列的平均值

> ID：14308521
> 
> 赞同：1
> 
> 时间：2013-01-13T21:44:05.120
> 
> 标签：matlab, loops, while-loop, filtering, vectorization

嗨，我在 Matlab (PDS(:,39)) 中有一列值。此列针对各种内容进行了过滤，并且有两个单独的标记列 (PDS(:,[41 81]))，对于有效行为 0，对于无效行为 -1。我正在取有效数据的平均值，如果平均值高于 0，我想让这个值无效并再次取平均值，直到平均值低于某个值（在本例中为 0.2）。这是我的代码：

```
% identify the VALID values
U1 = (PDS(:,81)==0);
F1 = (PDS(:,41)==0);

% only calculate using the valid elements
shearave = mean(PDS(U1&F1,39));

while shearave > 0.2
    clear im
    % determine the largest shear value overall for filtered and
    % non-flagged
    [c im] = max(PDS(U1&F1,39));
    % make this value a NaN
    PDS(im,39)=NaN;
    % filter using a specific column and the overall column
    PDS(im,41)=-1;
    F1 = (PDS(:,41)==0);
    % calculate shear ave again using new flagging column - remove the ";" so I can see        the average change
    shearave = mean(PDS(U1&F1,39))
end 
```

Matlab 给我的输出是：

剪切 =

0.3032

剪切 =

0.3032

剪切 =

0.3032

ETC

循环不会使用新的有效数据重新评估。我该如何解决这个问题？我必须休息还是继续？或者也许是不同类型的循环？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:16:20.340

您不需要使用循环，我会执行以下操作：

对数据进行排序：

```
m=PDS(U1&F1,39);
[x isort]=sort(m); 
```

然后计算排序向量的累积平均值：

```
y = cumsum(x)./[1:numel(x)]'; 
```

然后在 0.2 处截断，并使用找到的索引检索所需的值...

```
ind=find(y<=0.2);
values_needed=m(isort(ind)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:16:09.300

您将第 39 列中的值迭代地替换为`NaN`. 但是，`mean`不会忽略`NaN`，而是`NaN`作为新平均值返回。你可以通过一个小实验看到这一点：

```
>> mean([3, 4, 2, NaN, 4, 1])
ans = NaN 
```

因此，`shearave < 0.2`永远不会`true`。

# ios - 从 ViewController 继承 UIView

> ID：14308526
> 
> 赞同：0
> 
> 时间：2013-01-13T21:44:49.673
> 
> 标签：ios, xcode, uiview, viewcontroller

我试图在我的 viewController 中显示一个屏幕教程（如带有提示的图片）。我只知道如何从 AppDelegate 使用`UIView`它的`drawRect`方法“打开”a，其中我的绘制代码在其中：

```
BannerView *view = [[BannerView alloc] initWithFrame:self.window.frame];
[self.window addSubview:view];
[self.window makeKeyAndVisible]; 
```

是否可以通过 ViewController 内部的按钮激活`UIView`（BannerView）？

非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:47:29.793

我相信您正在寻找的是将事件处理程序添加到视图控制器上的按钮，该按钮将创建视图并使用类似的东西添加视图

```
BannerView *view = [[BannerView alloc] initWithFrame:CGRectMake(x,y,width,height)];
[self.view addSubview:view]; 
```

其中 self 是视图控制器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:48:21.933

只需使用以下代码：

```
BannerView *view = [[BannerView alloc] initWithFrame:self.view.bounds];
[self.view addSubview:view]; 
```

在您的按钮操作方法中（如果它在您的控制器类中定义）。请参阅此 SO 问题以了解[如何以编程方式创建按钮](https://stackoverflow.com/questions/1378765/how-do-i-create-a-basic-uibutton-programmatically)。否则，您可以为此使用界面构建器。

使用`self.view.bounds`in`initWithFrame`将使您的横幅视图与控制器的视图一样大（可能小于显示）。

# java - Java中的接口敏感操作

> ID：14308527
> 
> 赞同：2
> 
> 时间：2013-01-13T21:44:55.833
> 
> 标签：java, interface

这是我的整体工作流程。首先创建一个接口：

```
public interface foo {
   void bar(Baz b);
} 
```

然后，例如，制作一个具有*不同*对象的向量，这些对象都实现了所述接口：

```
myVector.add(new Ex);  //both Ex and Why implement foo.
myVector.add(new Why); 
```

最后，使用界面：

```
for(int i=0; i<myVector.size(); i++) {
    myVector.get(i).bar(b);
} 
```

但是，由于显而易见的原因，这会产生编译时错误：

> 方法 bar() 未为 Object 类型定义

投射不起作用，因为 Ex 和 Why 不相关。Try-catch 转换为 Ex 然后Why 是一个可怕的变通方法。让 Ex 和Why都扩展 Bar_doers 听起来也不简洁，因为那将取消接口。

如何执行关心对象是否实现给定接口而不是对象是否属于给定类的操作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-13T21:46:41.130

您需要阅读有关[*泛型*](http://docs.oracle.com/javase/tutorial/java/generics/)的信息。

假设您使用的是标准 Java 容器，那么您的解决方案是这样定义`myVector`：

```
List<foo> myVector = new ArrayList<foo>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T21:46:34.850

将它们投射到您的界面，它将起作用：

```
for(int i=0; i<myVector.size(); i++) {
    ((foo)myVector.get(i)).foo(b);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T21:55:19.033

```
public interface A {
    public void myMethod();
}

public class B implements A {

    @Override
    public void myMethod() {
        System.out.println("B");
    }

}

import java.util.ArrayList;
import java.util.List;

public class C implements A {

    @Override
    public void myMethod() {
        System.out.println("C");
    }

    public static void main(String[] args){
        List<A> list = new ArrayList<>();
        list.add(new B());
        list.add(new C());

        for(A obj : list){
            obj.myMethod();
        }
    }

} 
```

上面将打印：

```
B
C 
```

# enums - 在模型上使用枚举属性时客户端微风.js 中的异常

> ID：14308529
> 
> 赞同：1
> 
> 时间：2013-01-13T21:45:00.283
> 
> 标签：enums, breeze

我唯一能找到的关于微风.js 中枚举支持的内容是关于 uservoice 的[这个功能建议](https://breezejs.uservoice.com/forums/173093-breeze-feature-suggestions/suggestions/3324099-support-for-enum-properties-on-entities)，最近在 0.82 中被标记为关闭。我正在使用当前最新的 0.84.3。

**更新：** 我首先在 EF 5.0.0 和 .net 4.5 中使用代码。启动应用程序和微风请求元数据时，EF 创建空数据库，我的枚举属性在数据库中为 int，所以这部分没问题。

但是，当我向模型中添加枚举属性时，当微风尝试解析元数据时出现异常：

```
Uncaught Error: Unable to locate an 'Type' by the name: ItemType:#TestApp.Models breeze.debug.js:5051
getTypeFromMap breeze.debug.js:5051
ctor.getEntityType breeze.debug.js:5028
ctor._updateProperty breeze.debug.js:6056
ctor._fixup breeze.debug.js:6133
ctor._fixup breeze.debug.js:6132
ctor.addEntityType breeze.debug.js:4702
convertFromODataEntityType 
```

这是我的模型（简化）：

```
public enum ItemType
  {
    Ordered,
    Approved,
    Misc
  }

public class Item 
  {

    public long Id { get; set; }

    public ItemType Type { get; set; }

  } 
```

我在哪里犯错？是否有带枚举的工作样本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T19:18:00.653

我刚刚尝试将您的 ItemType 枚举添加到我们的模型之一（微风 DocCode 示例中的 ToDo 模型）没有问题。

我不确定你遇到了什么。所以有两个建议，

1) 尝试更新（破解）微风示例 zip 中附带的 DocCode 示例以使用您的 ItemType 枚举（详情如下），然后运行任何基本的 ToDo 测试。

```
// In DocCode/Models/ToDoItem.cs
namespace Todo.Models 
{
    public class TodoItem 
    {
        public int Id { get; set; }                     // 42

        [Required, StringLength(maximumLength: 30)]     // Validation rules
        public string Description { get; set; }         // "Get milk"

        public System.DateTime CreatedAt { get; set; }  // 25 August 2012, 9am PST
        public bool IsDone { get; set; }                // false
        public bool IsArchived { get; set; }            // false
        // YOUR ENUM PROPERTY
        public ItemType Type { get; set; }
    }

    // YOUR ENUM TYPE
    public enum ItemType {
      Ordered,
      Approved,
      Misc
    }

}

// In DocCode/Models/ToDoDatabaseInitializer
private static TodoItem CreateTodo(string description, bool isDone, bool isArchived)
{
    _baseCreatedAtDate = _baseCreatedAtDate.AddMinutes(1);
    return new TodoItem
    {
        CreatedAt = _baseCreatedAtDate,
        Description = description,
        IsDone = isDone,
        IsArchived = isArchived,
        // YOUR ENUM PROPERTY
        Type = ItemType.Ordered
    };
} 
```

或者

2) 向我 (Jay Traband) 发送您项目的精简版，地址为：brief@ideablade.com。

# google-app-engine - 使用 Go 在 GAE 数据存储上嵌套结构

> ID：14308530
> 
> 赞同：6
> 
> 时间：2013-01-13T21:45:11.637
> 
> 标签：google-app-engine, google-cloud-datastore, go

我试图弄清楚如何使用 Go 让嵌套结构与 GAE 数据存储一起使用。我知道数据存储并不专门支持嵌套结构。当帖子以 JSON 形式发送给用户时，我需要找到一种简单的方法来获取用户信息。

我想到的一件事是为用户放置两个字段。一个用于引用用户的 ID/键，另一个用于用户类型结构，当从数据存储区加载帖子时将添加到那里。额外的字段看起来很傻，所以我希望有一个更好的解决方案。

有两种实体类型或结构：POST 和 USER

帖子需要包含有关发布帖子的用户的信息。

我将为用户输出的 JSON 的结构如下：

*   邮政
    *   字段1
    *   字段2
    *   用户
        *   用户字段1
        *   用户字段2

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-14T04:06:08.193

Go 的 appengine 数据存储 api 为这类事情提供了 PropertyLoadSaver 接口：[https ://developers.google.com/appengine/docs/go/datastore/reference#PropertyLoadSaver](https://developers.google.com/appengine/docs/go/datastore/reference#PropertyLoadSaver)

您可以根据需要构建结构，然后实现该接口的 Load 和 Save 方法以正确填充它。这意味着您自己编写序列化代码，但它使您可以完全自由地构建数据。

这将允许您仍然过滤字段并具有嵌套结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:46:12.467

python 运行时有 ndb 库，它支持这样的嵌套结构。Go 没有，所以我可以想到两种解决方案：

1.  在 POST 类型中，有一个作为键的用户字段，引用具有必要字段的 USER 类型。需要两次提取和往返。
2.  在 POST 类型中创建一个作为 blob 的用户字段。blob 是一个在 go 中 [de] 序列化的字符串。这意味着您无法搜索或过滤任何用户数据，但它还允许您将所有内容存储在一个实体中。

您应该根据应用程序的需要使用这些。如果您需要用户是真实的东西，请使用 1。如果用户不是您需要使用的对象（即，只是要显示的数据），您可以使用 2。

# javascript - Javascript正则表达式从字符串中删除字符和数字

> ID：14308532
> 
> 赞同：0
> 
> 时间：2013-01-13T21:45:14.563
> 
> 标签：javascript, regex, string, replace

我有这个字符串，我需要从包含它们的所有单词中删除下划线数字。

```
"View":{"Name":"Untitled-4","Image_1":{"BackgroundImage":"Image.png","Position":[0,0],"Width":320,"Height":480},"Button_1":{"BackgroundImage":"ButtonTop.png","Position":[61,83],"Width":217,"Height":58},"Button_2":{"BackgroundImage":"ButtonBottom.png","Position":[81,114],"Width":205,"Height":73},"TextField_1":{"BackgroundImage":"TextFieldLogin.png","Position":[102,336],"Width":189,"Height":31},"Label_1":{"Position":[137,100],"Width":54,"Height":20,"Text":"HiRob","FontSize":18,"Color":[0,0,0,1]},"Label_2":{"Position":[43,342],"Width":72,"Height":20,"Text":"LogOut:","FontSize":18,"Color":[0,0,0,1]},"Label_3":{"Position":[115,234],"Width":126,"Height":20,"Text":"AnotherButton","FontSize":18,"Color":[0,0,0,1]}} 
```

我正在寻找的输出是：

```
"View":{"Name":"Untitled-4","Image":{"BackgroundImage":"Image.png","Position":[0,0],"Width":320,"Height":480},"Button":{"BackgroundImage":"ButtonTop.png","Position":[61,83],"Width":217,"Height":58},"Button":{"BackgroundImage":"ButtonBottom.png","Position":[81,114],"Width":205,"Height":73},"TextField":{"BackgroundImage":"TextFieldLogin.png","Position":[102,336],"Width":189,"Height":31},"Label":{"Position":[137,100],"Width":54,"Height":20,"Text":"HiRob","FontSize":18,"Color":[0,0,0,1]},"Label":{"Position":[43,342],"Width":72,"Height":20,"Text":"LogOut:","FontSize":18,"Color":[0,0,0,1]},"Label":{"Position":[115,234],"Width":126,"Height":20,"Text":"AnotherButton","FontSize":18,"Color":[0,0,0,1]}} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:46:32.443

你可以做

```
var replaced = str.replace(/_\d+/g, '') 
```

# html - 在站点地图中处理子域的最佳方法是什么？

> ID：14308533
> 
> 赞同：0
> 
> 时间：2013-01-13T21:45:32.973
> 
> 标签：html, xml, web, seo, sitemap

如果您有一个网站 www.yourdomain.com 和一个子域 blog.yourdomain.com（两个站点都包含类似信息），那么最好的站点地图设置是什么？

最好为两个站点提供一个站点地图吗？（如果是这样，这会是什么样子？）

还是两个单独的站点地图？

哪个在搜索流量优化方面最有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:49:20.917

如果内容相同，请使用 rel 标签告诉 Google（和其他搜索引擎）应该使用哪个 URL 来累积页面排名。

如果您不这样做，Google 会将您的页面排名“果汁”分成两个页面。理想情况下，您希望将您的汁液集中在一个 URL 上，因为它会获得更好的页面排名。

选择要为其生成站点地图的主站点或子域。如果你两者都做，它并没有真正伤害任何东西。

[rel="canonical"](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=139394)标签进入您的 html 页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T06:20:31.897

您可以简单地将单个站点地图创建为：

[http://yourdomain.com/sitemap.xml](http://yourdomain.com/sitemap.xml)并在此站点地图下为您的所有博客文章 URL 定义站点地图。

此站点地图将帮助您索引 blog.yourdomain.com 的内容页面的大型存档。通过这种方式，谷歌爬虫可以在更短的时间内从一个地方索引。

# php - FPDF 错误：不支持的图像类型

> ID：14308536
> 
> 赞同：0
> 
> 时间：2013-01-13T21:45:45.867
> 
> 标签：php, fpdf

我正在使用 FPDF 打印我网页的 pdf 版本。

我目前正在使用`image`FPDF 的功能来打印图像。我有以下代码来打印图像-

```
function PutImg($URL, $txt)
{
    // Put a image
    $this->Ln(10);
    $start_x = $this->GetX();
    $start_y = $this->GetY();
    $this->Image($URL,$this->GetX(), $this->GetY(),90, 0);
    $this->SetStyle('U',false);
    $this->SetLink($txt);
    $this->SetTextColor(0);
    $this->Ln(10);
} 
```

如果我使用图像 URL- [http://i706.photobucket.com/albums/ww62/fadey86/ifadey%20official%20website/install.jpg](http://i706.photobucket.com/albums/ww62/fadey86/ifadey%20official%20website/install.jpg)这将成功打印出图像。但是当我使用网址时：http://t1.gstatic.com/images?q=tbn: [ANd9GcT9kiQoy9NiniQqbTSNXRQxeNtnOoXwuZuuYZiJzOV1gbfIZHippBfaZj2FxA](http://t1.gstatic.com/images?q=tbn:ANd9GcT9kiQoy9NiniQqbTSNXRQxeNtnOoXwuZuuYZiJzOV1gbfIZHippBfaZj2FxA)

它给出了以下错误-

```
FPDF error: Unsupported image type: com/images?q=tbn:and9gct9kiqoy9niniqqbtsnxrqxentnooxwuzuuyzijzov1gbfizhippbfazj2fxa 
```

任何人都可以解释或纠正它吗？

**编辑** -我尝试使用仅以 .jpg/.png 结尾的图像链接，然后根据我的意愿正确打印 PDF。所以问题在于 URL 不是以 JPG 结尾的图像。给他们什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T21:55:39.733

看起来 FPDF 尝试根据 URI 而不是 HTTP 标头确定文件类型。如果你作弊一点会发生什么？

```
http://t1.gstatic.com/images?q=tbn:ANd9GcT9kiQoy9NiniQqbTSNXRQxeNtnOoXwuZuuYZiJzOV1gbfIZHippBfaZj2FxA#.jpg 
```

（注意最后的#.jpg）

# visual-studio - 为什么默认 VSIX 安装目录不在默认允许的 VS 位置？

> ID：14308537
> 
> 赞同：0
> 
> 时间：2013-01-13T21:45:48.487
> 
> 标签：visual-studio, vsix, vs-extensibility

正如其他帖子中提到的，默认情况下 VSIX 扩展将安装到以下目录匹配，并且无法更改：

```
%VSAPPDATA%\Extensions\ 
```

我的问题是：如果这是默认位置并且已知，为什么这些位置不在工具--> 选项--> 环境--> 加载项安全性下的默认允许位置列表中？

最近的位置是 %VSAPPDATA%\Addins 所以这意味着如果你正在开发 VS 扩展，你只有 2 个选项：

1.  创建将所需文件部署到已知位置的 MSI，并在以下注册表项中手动添加该位置：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\\AutomationOptions\LookInFolders
2.  以某种方式通知您的扩展的用户通过 VS 手动添加它。

这是疏忽还是我错过了什么？我最终选择了上面的选项 1，不禁认为这是矫枉过正。

# php - 使用 PDO 在数据库中存储可选图像和所需文本

> ID：14308542
> 
> 赞同：-1
> 
> 时间：2013-01-13T21:46:04.643
> 
> 标签：php, pdo

我想使用 PDO 存储数据（主要是文本）和可选图像。因此，文本完全没有问题，但我的问题来自“可选”图像。

如何构建提供可选图像字段的查询。

对于文本：类似于：

```
$conn = new PDO(DNS, username, password);
$sql = "INSERT INTO DATABASE (fields) VALUES ( using place holders (? or :holder))";
$stmt = $conn->prepare($sql);
$stmt->bindparam(':holder', '$_GET['value']');
$stmt->execute(); 
```

但是对于可选图像，我该怎么做？

我有使用文件类型输入构建的表单：

```
<input type="file" name="image" /> 
```

更新：

让我们想象以下形式：

```
<form action="index.php" method="post" enctype="multipart/form-data" >
<input type="text" name="sometext" />
<input type="file" name="someimage"/>
<input type="submit" name="sendform" value="send"/>
</form> 
```

文件类型输入是可选的，我想知道的是如何使用 PDO 构建用于该目的的查询，以便用户可以或不发送图像但需要文本。

谢谢你。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-14T00:09:51.043

来自[PHP：大对象 (LOB)](http://php.net/manual/en/pdo.lobs.php)

```
<?php
$db = new PDO('odbc:SAMPLE', 'db2inst1', 'ibmdb2');
$stmt = $db->prepare("insert into images (id, contenttype, imagedata) values (?, ?, ?)");
$id = get_new_id(); // some function to allocate a new ID

// assume that we are running as part of a file upload form
// You can find more information in the PHP documentation

$fp = fopen($_FILES['file']['tmp_name'], 'rb');

$stmt->bindParam(1, $id);
$stmt->bindParam(2, $_FILES['file']['type']);
$stmt->bindParam(3, $fp, PDO::PARAM_LOB);

$db->beginTransaction();
$stmt->execute();
$db->commit(); 
```

它的要点是您可以传递`PDOStatement::bindParam`一个文件句柄，告诉 PDO 应该保存为一个大对象（确切的数据类型将取决于您的数据库），然后 PDO 将处理其余的。

至于让文件上传是可选的 - 只需检查他们是否上传了任何内容。如果他们没有，请绑定`null`而不是文件句柄。

# node.js - 如何使用 Knox 模块的响应？

> ID：14308546
> 
> 赞同：0
> 
> 时间：2013-01-13T21:46:25.443
> 
> 标签：node.js, amazon-web-services, knox-amazon-s3-client

我正在使用 Knox S3 模块，但是当我最终获得文件时，生成的文件已损坏。我是否错误地使用了 Knox？

```
 var data;
        client.getFile(path, function(err, file) {
            file.on('data', function(chunk) { data += chunk; });
            file.on('end', function() {
                //Here I end up sending the response with new Buffer(data), but that produces a bad file.
            });
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T21:51:48.807

尝试使用 writeStream：

```
var fs = require('fs');
var file = fs.createWriteStream(path);
client.getFile(path, function(err, stream) {
    stream.on('data', function(chunk) { file.write(chunk); });
    stream.on('end', function(chunk) { file.end(); });
}); 
```

并确保查看[https://github.com/aws/aws-sdk-js](https://github.com/aws/aws-sdk-js)

# ruby-on-rails - 工头开发与生产（导轨）

> ID：14308547
> 
> 赞同：19
> 
> 时间：2013-01-13T21:46:31.163
> 
> 标签：ruby-on-rails, heroku, foreman

在生产与开发中表现不同的“工头方式”是什么？那就是我们希望工头开始在 dev 中启动一堆东西，但是在 heroku 生产中我们不需要它来启动（例如）solr。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-13T23:32:33.673

我遵守约定；

*   `Procfile`定义*所有*进程
*   `.foreman`设置特定工头变量

发展：

*   `.env`为每个开发者设置环境变量
*   `.env.example`为开发设置默认值
*   `foreman start`启动所有进程

生产：

*   `heroku config`设置环境变量
*   `heroku ps:scale`打开或关闭生产所需的任何流程

这是一个项目的例子。

档案：

```
web:    bundle exec unicorn_rails -p $PORT -c ./config/unicorn.rb
worker: bundle exec rake jobs:work
search: bundle exec rake sunspot:solr:run 
```

.env.example：

```
# default S3 bucket
S3_KEY=keykeykeykeykeykey
S3_SECRET=secretsecretsecret
S3_BUCKET=myapp-development 
```

.env

```
# developer's private S3 bucket
S3_KEY=mememememememememe
S3_SECRET=mysecretmysecret
S3_BUCKET=myapp-development 
```

。领班：

```
# development port is 3000
port: 3000 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-13T21:50:55.733

Foreman 接受参数来使用不同的文件 (-d) 和参数来指定要运行的内容。它还支持`.foreman`允许这些 args 成为默认值的文件。有关更多信息，请参阅[http://ddollar.github.com/foreman/](http://ddollar.github.com/foreman/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-12T17:55:59.863

我之前使用过 environment-specific `Procfile`，它非常简单并且工作正常。

基本上你有`Procfile.development`,`Procfile.production`等等。在每一个中你可以自定义你想要启动的过程，然后`foreman`像这样运行它们：

```
foreman start -f Procfile.development 
```

另一种方法是引用您的脚本`Procfile`，并在每个脚本中根据环境启动相应的进程。[Foreman 的创建者做到了这一点](https://github.com/ddollar/foreman/issues/358#issuecomment-17556894)，并[从他的 Anvil 项目中提供了一个示例供您参考](https://github.com/ddollar/anvil/blob/master/bin/web)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-09T19:58:47.457

我们的解决方案是在我们的 Procfile 中为开发与生产使用单独的作业类型。这不是最干燥的方法，但它有效......

```
sidekiq: bundle exec sidekiq
sidekiq-prod: bundle exec sidekiq -e production 
```

然后我们在生产系统上运行 foreman 指定 prod 作业：

```
foreman start -c sidekiq-prod=4 
```

# c# - 传递成员函数，如 C++ 中的 std::function（如 C# 中）

> ID：14308552
> 
> 赞同：2
> 
> 时间：2013-01-13T21:46:42.557
> 
> 标签：c#, c++, function, delegates, std-function

我有一个模板类 Delegate，带有一个重载的 += 运算符，这使得使用类似于 C# 的委托。

```
// ... generalized version of the template omitted from code
template<typename... TArgs>
    class Delegate<void, TArgs...>
    {
        private:
            using Func = std::function<void(TArgs...)>;
            std::vector<Func> funcs;

        public:
            template<typename T> Delegate& operator+=(T mFunc) { funcs.push_back(Func(mFunc)); return *this; }
            void operator()(TArgs... mParams) { for (auto& f : funcs) f(mParams...); }
    }; 
```

这就是我想要做的：

```
struct s
{
    void test() { }
    void run()
    {
        Delegate<void> d;
        d += [] { /* do something */ ; };
        d += test; // does not compile
    }
}; 
```

有没有办法让`d += test;`工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T21:58:20.383

```
void test(int x, int y) { return x - y; } 
```

它如何编译？这个函数应该什么都不返回。它的返回类型是`void`.

另外，我假设您已经定义（或声明）主模板：

```
template<typename R, typename... TArgs>
class Delegate; 
```

还假设这`delegate`是一个错字，因为类模板是`Delegate`.

无论如何，`test`什么都不返回，它编译得很好：

[http://stacked-crooked.com/view?id=c56b7a2e758f8fbc361228834c90822b](http://stacked-crooked.com/view?id=c56b7a2e758f8fbc361228834c90822b)

* * *

至于成员函数指针，您当前的实现不支持它。请注意，*非静态*成员函数指针采用`R (C::*MemPtr)(Args...) cv`. 努力吧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:21:07.130

成员函数也需要一个对象的实例来处理。如果您使用提取函数`std::mem_fn`，您可以将其作为第一个参数，您还可以将当前对象绑定到函数`std::bind`

代码清楚地表明：

```
struct s
{
    void test() { }
    void run()
    {
        Delegate<void> d;
        d += [] { /* do something */ ; };
        d += std::bind(std::mem_fn(&s::test), this); // does compile
    }
}; 
```

我真的没有办法`d += test`。你真的需要传递实际的对象。这个 lambda 版本更清楚地表明您需要当前对象：

```
struct s
{
    void test() { }
    void run()
    {
        Delegate<void> d;
        d += [this] { test(); };
    }
}; 
```

当然，您不需要在 operator+= 行中指定它。你可以修改下面`Delegate`的`this`构造函数（`runv1`），或者添加一个成员函数，它提供一个代理对象，可以添加测试函数（`runv2`）：（虽然我没有测试这些）

```
struct s
{
    void test() { }
    void runv1()
    {
        Delegatev2<s, void> d(this);
        d += test;
    }
    void runv2()
    {
        Delegate<void> d;
        auto memd = d.getMemberDelegate(this);
        memd += test;
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T22:25:55.787

正如 Nawaz 在编辑中所说，您使用成员（非 satic）函数，它与您的 std::function 的 void () 签名不兼容。

两种解决方案：

*   使用类似的东西`std::function<void(s&)>`
*   将你的成员函数绑定到一个对象，`std::bind(&s::test,&s);`（就像 K-ballo 说的和 Csq 一样）

此外，您应该使用 rref 和 std::forward 来实现完美转发。

# jquery - 如果选择单选按钮，则在文本字段中显示文本

> ID：14308565
> 
> 赞同：0
> 
> 时间：2013-01-13T21:47:32.703
> 
> 标签：jquery

我必须使用 jquery 1.3.2 我在这里有一个非常简单的任务来检查是否选择了按钮并相应地在某些文本字段中显示自定义文本。我知道问题出在条件的某个地方。条件内部是简单的代码，用于在具有焦点和模糊功能的文本字段内显示自定义文本

```
$(document).ready(function () {
  if ($('input#edit-quote-option-flatrate-3---0').is(":checked")) {
    $('input.default').val('xxx');
    $('.default').each(function () {
      var defaultVal = ('xxx');
      $(this).focus(function () {
        if ($(this).val() == defaultVal) {
          $(this).removeClass('active').val('');
        }
      })
        .blur(function () {
        if ($(this).val() == '') {
          $(this).addClass('active').val(defaultVal);
        }
      })
        .blur().addClass('active');
    });
  }
}); 
```

你能帮我调试一下为什么这段代码不适用于这种情况吗？谢谢你。带有 html 的完整代码在这里[http://jsfiddle.net/NKcFs/](http://jsfiddle.net/NKcFs/)

编辑：在我的页面上，有更多的重做按钮。只有选择某个按钮，我需要显示文本。如果访问者选择另一个按钮，文本应该消失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:59:32.713

问题是代码仅在页面加载时运行。如果在那一点上选择了单选按钮，那么代码实际上会在文本框中显示文本。要使代码对复选框中的更改做出反应，您应该使用`change`事件：

```
$(document).ready(function () {
  $('input#edit-quote-option-flatrate-3---0').change(function(){
    if ($('input#edit-quote-option-flatrate-3---0').is(":checked")) {
      $('input.default').val('xxx');
      $('.default').each(function () {
        var defaultVal = ('xxx');
        $(this).focus(function () {
          if ($(this).val() == defaultVal) {
            $(this).removeClass('active').val('');
          }
        })
          .blur(function () {
          if ($(this).val() == '') {
            $(this).addClass('active').val(defaultVal);
          }
        })
        .blur().addClass('active');
      });
    }
  });
}); 
```

# c# - 在 C# 中使用托管 API 的有效替代方法？

> ID：14308573
> 
> 赞同：2
> 
> 时间：2013-01-13T21:48:22.427
> 
> 标签：c#, dll, import

那么如果我直接使用 kernel32 来删除我的文件作为例子，它会比这个 C# API 更有效吗？

```
System.IO.File.Delete(string Path); 
```

如果我像这样导入 dll 并使用 DeleteFile("C:..")：

```
[DllImport("kernel32.dll", SetLastError = true)]
[return: MarshalAs(UnmanagedType.Bool)]
static extern bool DeleteFile([MarshalAs(UnmanagedType.LPWStr)]string lpFileName); 
```

效率会更好，例如执行代码所需的时间吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-13T22:45:25.147

托管代码很慢是一个相当普遍的误解。通常不是，您执行的代码与 C 编译器生成的代码相同，即机器代码。它与作为操作系统功能包装器的大量 .Net 框架类尤其不相关。

就像 File 类一样。File.Delete() 方法实际上调用了 DeleteFile() winapi 函数。必然如此，这是在 Windows 上删除文件的唯一方法。.NET 框架无能为力，至少在托管操作系统可用之前是这样。这可能有一天会发生，微软的超级秘密 Midori 项目旨在开发这样一个操作系统。

但那是未来的音乐，现在它是一大块 C 代码，埋在像 Fat32 或 NTFS 这样的文件系统驱动程序中，实际上可以完成工作。它以磁盘速度运行，DeleteFile() 在文件系统驱动程序确认删除完成之前不会返回。这是非常非常缓慢的。就像老式硬盘驱动器的大约 50 毫秒，SSD 的亚毫秒范围内一样。

File.Delete()**确实**添加了代码，它执行了大量的错误检查。如果验证您传递的参数不为空，则检查您的代码是否未在拒绝删除文件的沙箱中运行，检查您是否未在路径中指定任何文件路径中不合法的字符，将增量路径转换为完整路径并检查它是否仍然是合法路径，检查路径字符串是否不太长，如有必要，将短 MS-Dos 8.3 名称转换为长名称。

这是一堆工作，但以*微秒*为单位。如果您 p​​invoke DeleteFile，那么您将跳过该代码，但充其量只会使其速度提高约 1%。您将失去的是**可靠性**，即如果您的代码或数据中有 oops，您将被告知的保证。带有非常清晰的异常消息，可以准确地告诉您出了什么问题。非常有价值，因为这几微秒乘以十亿仍然无法与调试不起作用的 DeleteFile() 所花费的时间和痛苦相提并论。

不要这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T21:51:28.383

唯一确定的方法是测试它。编写创建一大堆临时文件的代码，然后计算将它们全部删除所需的时间。

这里的性能考虑：

*   使用本机 api 进行文件删除（`kernel32`）与
*   不得不使用编组的性能损失。

我的直觉是，任何性能提升都会很小，如果你想得到一个的话。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-13T21:53:39.143

删除操作的限制因素是执行文件系统操作，而不是将 C# 代码连接到 OS 代码的代码。您将看到这两个调用之间没有明显的区别。切换到直接在这个 API 中调用 kernel32 肯定是过早的优化。

# git - 撤消快进合并

> ID：14308580
> 
> 赞同：80
> 
> 时间：2013-01-13T21:48:58.640
> 
> 标签：git

我对我希望撤消的 git 存储库进行了一些更改。

我的 git 仓库看起来像这样：

```
A-B----     master
   \   /
    C-D     * develop 
```

我在`develop`分支上，忘记了它与`master`分支不同，在 上进行了更改`develop`，将其合并到`master`中，然后推送到我的遥控器（称为`publish`）。

因为自 B（共同祖先）以来 master 没有任何变化，git 进行了快进合并。

现在，我的仓库看起来像这样：

```
A-B-C-D   master, develop, remotes/publish/master, remotes/publish/develop. 
```

我想恢复上一次合并，恢复`master`到 B。

从我在[如何撤消 Git 中的最后一次提交中读到的内容？](https://stackoverflow.com/questions/927358/undo-last-git-commit)，我曾经`git reset sha-of-B`将我的`master`分支恢复到修订版 B。

问题：

*   如何恢复`develop`到修订版 D？
*   然后如何将这些更改推送回远程/发布？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2013-01-13T21:53:09.740

如果您重置分支 master，它将不会触及开发分支。为了按顺序排列所有内容，您应该执行以下操作：

```
git checkout master
git reset --hard sha-of-B
git checkout develop
git reset --hard sha-of-D
git checkout master
git merge develop --no-ff 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2016-05-09T15:42:01.583

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T21:53:49.157

如果您似乎`develop`在跑步时被检查出来`git reset`，这就是让您感到困惑的原因。

您可以按以下方式修复`develop`：

```
git checkout develop
git merge --ff-only D 
```

现在，您可以恢复`master`到 B：

```
git checkout master
git reset --hard B 
```

返回`develop`并推动它：

```
git checkout develop
git push develop 
```

# c# - 两个对象上的 DataContext

> ID：14308583
> 
> 赞同：1
> 
> 时间：2013-01-13T21:49:13.223
> 
> 标签：c#, windows-phone-7, data-binding, binding

我想在 XAML 页面上绑定两个列表。

有没有可能做这样的事情：

```
this.DataContext = {listOne,ListTwo} ; 
```

非常感谢，

此致 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:50:19.860

您可以为此使用匿名对象：

```
this.DataContext = new { One = listOne, Two = listTwo}; 
```

# binding - 生成的绑定事件使 MonoTouch 崩溃

> ID：14308585
> 
> 赞同：2
> 
> 时间：2013-01-13T21:49:17.203
> 
> 标签：binding, xamarin.ios

我有一个具有以下绑定的蓝牙 BLE 设备绑定：

```
[BaseType (typeof (CBPeripheralDelegate), Delegates=new string [] {"WeakDelegate"}, 
 Events=new Type [] { typeof (BrspDelegate) })]
interface Brsp
{
    //@property (nonatomic, weak) id <BrspDelegate> delegate;
    [Export ("delegate")]
    [NullAllowed]
    BrspDelegate Delegate { get; set; }

    [Wrap ("WeakDelegate")]
    [NullAllowed]
    NSObject WeakDelegate { get; set; }

    ...other stuff

} 
```

以下代表：

```
 [BaseType(typeof(NSObject))]
    [Model]
    interface BrspDelegate 
    {
         [Abstract]
         [Export("brsp:OpenStatusChanged:"), EventArgs("OpenStatus")]

         ...other stuff
    } 
```

当我为 openstatuschanged 连接生成的事件处理程序时，它会立即使应用程序崩溃，并且我没有收到任何可能出错的反馈。我仍然是绑定的新手，所以...

我有一种感觉，我在“事件 = ...”部分犯了错误，有什么想法吗？

谢谢，

罗吉尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T23:17:50.733

很难说没有更多细节（例如，符号化的崩溃日志），但您的部分绑定是倒置的（这可能导致无限递归，从而使您的应用程序崩溃）。

*   你的`Delegate`方法应该有`[Wrap]`属性 (on `WeakDelegate`); 和
*   您的`WeakDelegate`方法应该是选择器上具有`[Export]`属性的方法`delegate`。

例如

```
 [Wrap ("WeakDelegate")]
    StronglyTypedDelegate Delegate { get; set; }

    [Export ("delegate")][NullAllowed]
    NSObject WeakDelegate { get; set; } 
```

# jquery - 简单的 jQuery 选择器只选择 Chrome 中的第一个元素..？

> ID：14308588
> 
> 赞同：64
> 
> 时间：2013-01-13T21:49:29.840
> 
> 标签：jquery, google-chrome, web-scraping

我对 jQuery 有点陌生，所以请原谅我太密集了。我想`<td>`通过 Chrome 的 JS 控制台选择特定页面上的所有元素：

```
$('td') 
```

然而，当我这样做时，我得到以下输出：

```
<td>Apples</td> 
```

jQuery 不应该返回带有`<td>`标签的元素数组吗？为什么我只看到符合此条件的第一个元素？

这是有问题的网站：http: [//www.w3schools.com/html/html_tables.asp](http://www.w3schools.com/html/html_tables.asp)

编辑：我想补充一点，当我在 Chrome 控制台中输入一个 jQuery 函数时，我没有得到一个 jQuery 对象。我得到一个普通的 HTML 元素。我的 Chrome 的设置/配置方式一定有问题。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2013-01-13T22:40:44.097

如果网页上没有 jQuery，当然也没有其他`$`代码`$`为`document.querySelector()`.

`$$()`您可以使用控制台分配的快捷方式来实现您想要的`document.querySelectorAll()`。

要知道页面是否包含 jQuery，可以`jQuery`在控制台中执行。要知道 jQuery 是否已分配给`$`，您可以执行`$().jquery`which 将返回 jQuery 版本，如果是这样的话。

此外，还有浏览器插件可以在每个网页中注入 jQuery。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-02-20T16:02:54.657

似乎 jQuery 没有正确包含在您的目标页面上运行。我遇到了类似的问题，并为 Google Chrome 解决了如下问题。

在您的 Chrome 浏览器中添加一个书签，其中包含以下单行代码作为 URL 字段（为了便于阅读，已对其进行了美化）：

```
javascript: (function () {
    var s = document.createElement('script');
    s.setAttribute('src', 'https://code.jquery.com/jquery-latest.min.js');
    if (typeof jQuery == 'undefined') {
        document.getElementsByTagName('head')[0].appendChild(s);
    }
    jQuery("td.edit select option[value=BN]").attr("selected", "");
})(); 
```

然后只需单击该书签即可运行它。预计它会正常包含 jQuery，并使控制台在`function (e,t){return new b.fn.init(e,t,r)}`您输入时返回类似`$`.

创建书签（也称为书签）的过程是在您希望使用控制台处理的每个页面中注入 jQuery 的简写。但是，如果您将代码片段直接复制粘贴到 JS 控制台中，它也可以工作。

PS：片段的学分不是我的，因为我使用了一段时间，不记得我从哪里得到的。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-13T21:52:06.717

如果安装了 jQuery 并且`$`符号是 jQuery 的简写，则`$('td')`返回一个 jQuery 对象。但是，在您链接的 w3schools 页面中，我看不到 jQuery 甚至存在。

如果 jQuery 存在并且调试器没有覆盖`$`符号，那么`$('td')`将返回一个 jQuery 对象。jQuery 对象是一个类似数组的对象（具有数组的一些属性），但它不是一个实际的数组。如果您在控制台中查看内容，则必须确保查看的是 DOM 元素本身，而不是包含的 jQuery 对象。

如果你想得到一个实际的 DOM 元素数组，你可以这样做：

```
$('td').get(); 
```

这将返回一个 DOM 元素数组。

如果这不起作用，那么您应该检查调用的时间，`$('td').get()`以确保`td`您想要的所有项目都在页面中，然后再搜索它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-13T21:56:40.013

此外，如果您尝试对每个 td 执行某些操作，则需要使用 a`.each()`来遍历它们。例如：

```
$('td').each(function() {
   //do something relevant here
}); 
```

# php - 从foreach中删除索引数组？

> ID：14308590
> 
> 赞同：0
> 
> 时间：2013-01-13T21:49:32.660
> 
> 标签：php

简单的问题；如何从我的 foreach() 中删除正确的数组？

```
foreach ( $items as $e):
    if ( $e['seat'] == $users[$clientID]['seat']):
        //It's done, delete it.
        unset ( $e );
    endif;
endforeach; 
```

unset($e) 似乎无法正常工作。从正确的索引中删除正确的数组的正确解决方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T21:52:35.783

这是 xbonez 给出的 for 循环的替代方法，也可以传递`key`值：

```
foreach ( $items as $key => $e):
    if ( $e['seat'] == $users[$clientID]['seat']):
        //It's done, delete it.
        unset ( $items[$key] );
    endif;
endforeach; 
```

我更喜欢这个版本，但这并不重要！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:51:28.637

`unset($e)`在 a 中执行`foreach`取消设置 variable `$e`，而不是它所代表的数组中的项目。您需要为此使用常规的 for 循环

```
for($i = 0; $i < count($items); $i++) {
   if ($items[$i]['seat'] == $users[$clientID]['seat']) {
      unset($items[$i])
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T21:52:28.347

尝试类似：

```
foreach ($items as &$e):
    if ($e['seat'] == $users[$clientID]['seat']):
        //It's done, delete it.
        unset ($e);
    endif;
endforeach; 
```

# cuda - 推力：b40c_thrust::vote_reduction 的多重定义

> ID：14308591
> 
> 赞同：0
> 
> 时间：2013-01-13T21:49:39.993
> 
> 标签：cuda, gpgpu, thrust

我在单独的编译模式下使用 Cuda 5.0。在

```
thrust/system/cuda/detail/detail/b40c/kernel_utils.h 
```

有这个定义

```
__shared__ int vote_reduction[B40C_WARP_THREADS]; 
```

链接器抱怨`vote_reduction`.

解决方法是什么？

**补充：重现问题的代码**

推力版本：100600

迭代器.h

```
#pragma once
#include <thrust/transform_reduce.h>
#include <thrust/functional.h>

struct Unary_Op
{
    __host__ __device__ int operator()(const int index) const;
};

int iterates(int start, int end); 
```

迭代器.cu

```
#include "iterator.h"

__host__ __device__ int Unary_Op::operator()(const int index) const
{
    return index;
}

int iterates(int start, int end)
{
    thrust::counting_iterator<int> first(start);
    thrust::counting_iterator<int> last = first + end;

    Unary_Op unary_op = Unary_Op();
    thrust::plus<int> binary_op;
    int init = 0;

    int sum = thrust::transform_reduce(first, last, unary_op, init, binary_op);

    return sum;
} 
```

计算.h

```
#include "iterator.h"

int compute(); 
```

计算.cu

```
#include "calculation.h"

int compute()
{
    return iterates(0,10);
} 
```

主文件

```
#include "calculation.h"

int main()
{
    compute();
    return 0;
} 
```

编译命令（NSight）

```
Building file: ../calculation.cu
Invoking: NVCC Compiler
nvcc -G -g -O0 -gencode arch=compute_20,code=sm_20 -odir "" -M -o "calculation.d" "../calculation.cu"
nvcc --device-c -G -O0 -g -gencode arch=compute_20,code=sm_20  -x cu -o  "calculation.o" "../calculation.cu"

Building file: ../iterator.cu
Invoking: NVCC Compiler
nvcc -G -g -O0 -gencode arch=compute_20,code=sm_20 -odir "" -M -o "iterator.d" "../iterator.cu"
nvcc --device-c -G -O0 -g -gencode arch=compute_20,code=sm_20  -x cu -o  "iterator.o" "../iterator.cu"

Building file: ../main.cu
Invoking: NVCC Compiler
nvcc -G -g -O0 -gencode arch=compute_20,code=sm_20 -odir "" -M -o "main.d" "../main.cu"
nvcc --device-c -G -O0 -g -gencode arch=compute_20,code=sm_20  -x cu -o  "main.o" "../main.cu"

Invoking: NVCC Linker
nvcc --relocatable-device-code=true -gencode arch=compute_20,code=sm_20 -link -o  "testt"  ./calculation.o ./iterator.o ./main.o   
nvlink error   : Multiple definitions of '_ZN6thrust6system4cuda6detail6detail11b40c_thrust14vote_reductionE'
nvlink error   : Multiple definitions of '_ZN6thrust6system4cuda6detail6detail11b40c_thrust14vote_reductionE'
make: *** [tt] Error 255 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-23T12:16:04.300

这似乎是针对 CUDA 5.x 工具包中提供的推力版本的单独编译的错误或问题。升级或降级到推力 1.5.3 或推力 1.7 似乎已经解决了问题

[此答案已从评论中收集并添加为社区 wiki 条目，以将问题从未回答的问题列表中删除]

# django - 为什么我的 URL 模板标记出错？

> ID：14308592
> 
> 赞同：0
> 
> 时间：2013-01-13T21:49:44.673
> 
> 标签：django

我正在尝试通过以下方式检索模板中视图的 URL

```
{% url 'session_views.login_user' %} 
```

我的 urls.py 看起来像

从 django.conf.urls.defaults 导入 *

```
urlpatterns = patterns('myappname',

  # Greets user on the home page.
  (r'^$', 'session_views.index'),

  # Session
  (r'^login/?$', 'session_views.login_user'),
) 
```

但是，我收到以下错误。

```
TemplateSyntaxError at /
Caught NoReverseMatch while rendering:
Reverse for ''session_views.login_user'' with arguments '()'
and keyword arguments '{}' not found. 
```

为什么我会犯错？`login_user`我在 session_views.py 中明确定义了一个视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:19:09.207

查看错误`Reverse for ''session_views.login_user''`，它有两组单引号。您不要在模板中使用引号 - 它应该是：

`{% url session_views.login_user %}`

或者您可以命名您的视图 - 之后您可以通过名称调用它们，并且需要引号：

网址.py：

> urlpatterns = patterns('myappname',
> 
> # 在主页上问候用户。(r'^$', 'session_views.index', name="index_view"),
> 
> # 会话 (r'^login/?$', 'session_views.login_user', name="login_user"), )

模板网址反向：

`{% url "login_user" %}`

编辑：

看到`Tomita's`答案后，我可能误解了这个问题。我以为您正在尝试按照以下方式检索 URL，并且您可能正在尝试将 url 作为变量检索。我的回答适用于跟随 URL，如`<a href="{% url session_views.login_user %}"....`. 以防万一，我会离开它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T22:25:04.243

您可能正在查看 dev 分支文档，它更改了 URL 标记功能。

对于 django <1.5，您应该遵循相应的文档，或者通过加载未来的 url 标签来验证您的代码。

```
{% load url from future %} 
```

> 在 Django 1.5 中，url 模板标签的行为将发生变化，第一个参数被制成上下文变量，而不是特殊情况下的不带引号的常量。这将允许 url 标记使用上下文变量作为要反转的 URL 名称的值。
> 
> 为了提供向前兼容的路径，Django 1.3 提供了一个实现新行为的未来兼容性库——future。要使用此库，请使用 url 标记在任何模板的顶部添加加载调用，并将 url 标记的第一个参数用引号括起来。例如：
> 
> {% load url from future %} {% url 'myapp:view-name' %} 新库也不再支持逗号语法来分隔 url 模板标签的参数。
> 
> 在 Django 1.5 中，旧的行为将被未来标签库提供的行为所取代。迁移现有模板以使用新语法。

# css - 内联图像不会在溢出换行符上向下移动

> ID：14308594
> 
> 赞同：0
> 
> 时间：2013-01-13T21:49:59.973
> 
> 标签：css, overflow, image, css-position, line-breaks

我的 div 中有一个内联图像，它是通过使用内联的`position:absolute`（我不能使用其他内联方法，因为它们会导致行高发生变化。）这些图像流出 div 并发送到下一行.. .但是图像没有下降..它被发送到下一行，这意味着它被发送到 div 的最左边，但它的高度没有下降，所以它几乎就像它保持在同一行但移动向左转？我怎样才能解决这个问题？

示例：（*将最后**两张**图片的宽度从 30px 更改为 150px 以查看我所描述的效果。）[http://jsfiddle.net/ztKP5/2/](http://jsfiddle.net/ztKP5/2/)

* * *

代码：（*将最后**两张**图片的宽度从 30px 更改为 150px 以查看我描述的效果。）

```
<div style="font: 30px; border:1px solid black; width: 350px; height:350px; word-wrap: break-word;">

<font face='helvetica'>

Test test test test test test test test test test test test test test test test!!

<img src='http://home.comcast.net/~urbanjost/images/globe_west_2048.jpg' style='width: 100px; height: 75px; position:absolute;'>
<img src='' style='width:100px; height:2px;'> <!-- this is a spacer-->

<img src='http://home.comcast.net/~urbanjost/images/globe_west_2048.jpg' style='width: 30px; height: 75px; position:absolute;'>
<img src='' style='width:30px; height:2px;'> <!-- this is a spacer-->

</font>

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:08:39.520

我没有看过这个跨浏览器，但它可以在 Firefox 中使用。 [http://jsfiddle.net/digitalagua/NeX4A/](http://jsfiddle.net/digitalagua/NeX4A/)

```
<style>
.holder {
    font-size: 16px;
    font-family:Helvetica,Arial,sans-serif;
    border:1px solid black;
    width: 350px;
    height:350px;
    word-wrap: break-word;
    display:inline-block;
}

.floater {
    width: 150px; height: 75px;margin-bottom:-63px;
}
<style>

<div class="holder">

Test test test test test test test test test test test test test test test test!!

<img src="http://home.comcast.net/~urbanjost/images/globe_west_2048.jpg" class="floater">
Test test test test test test test test test test test test test test test test!!

<img src="http://home.comcast.net/~urbanjost/images/globe_west_2048.jpg" class="floater">
Test test test test test test test test test test test test test test test test!!

</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T23:01:39.763

**将绝对定位**的图像包装在`display:inline-block`(... **NOT** )的 div 中`display:inline`解决了问题。

添加一个额外的“！” “测试”文本后看这里：http: [//jsfiddle.net/Z9rzx/2/](http://jsfiddle.net/Z9rzx/2/)

或者添加一个额外的“！” 在下面的源代码中的“测试”文本之后查看图像转到下一行：

```
<!--The second and fourth images are just spacers so that the next text, or image, or whatever will appear after the absolutely positions image instead of behind it... I could have used an in-line div or a span or anything...-->

<div style="font: 30px; border:1px solid black; width: 350px; height:350px; word-wrap: break-word;">

<font face='helvetica'>

Test test test test test test test test test test test test test test test test!!!!!!!!

<div style="width:100px; display:inline-block;">
  <img src='http://home.comcast.net/~urbanjost/images/globe_west_2048.jpg' style='width: 100px; position:absolute;'>
  <img src='' style='width: 100px; height:2px;'>
</div>

<div style="width:100px; display:inline-block;">
  <img src='http://home.comcast.net/~urbanjost/images/globe_west_2048.jpg' style='width: 100px; position:absolute;'>
  <img src='' style='width: 100px; height:2px;'>
</div>

test tast test test test test test test test test test test

</font>

</div> 
```

# opengl - 在opengl中围绕兴趣点旋转相机

> ID：14308595
> 
> 赞同：2
> 
> 时间：2013-01-13T21:50:02.710
> 
> 标签：opengl, 3d, rotation

我想围绕一个兴趣点旋转我的“相机”。目前，相机仅围绕原点旋转。

很多教程建议使用以下方案：

```
translate(-P)
rotate
translate(P) 
```

不幸的是，这不起作用。我的应用程序使用平移向量 (QVector3D) 和四元数 (QQuaternion) 来保存相机的平移和旋转。

目前，它是这样完成的，它总是围绕原点旋转：

```
glMatrixMode(GL_MODELVIEW);
glLoadIdentity();
glTranslatef(translation.x(),translation.y(), translation.z());
multMatrix(accumulatedQuaternionRotation); 
```

其中 mulMatrix 使用四元数构建一个 4x4 矩阵，该矩阵被传递给 glMultMatrixf()；

使用这样的东西：

```
glTranslatef(-translation.x(),-translation.y(), -translation.z());
multMatrix(accumulatedQuaternionRotation);
glTranslatef(translation.x(),translation.y(), translation.z()); 
```

导致非常奇怪的控件，我无法进一步描述。在我的应用程序中，translation.z() 的意思是：向前移动相机。更改 x() 和 y() 会发出类似平移的操作。

我怀疑我使用的翻译向量错误，导致上述操作序列失败。

还有什么我可以检查的吗？

编辑：这是四元数旋转的工作原理：

```
 // calculate rotation axis
        QVector3D rotationAxis = QVector3D(diff.y(), diff.x(), 0.0).normalized();

        // update rotation see http://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation
        accumulatedQuaternionRotation = QQuaternion::fromAxisAndAngle(rotationAxis, diff.length()/4.0f) * accumulatedQuaternionRotation; 
```

diff 只是两个鼠标移动事件点的差异。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-14T21:46:51.197

您要做的基本上是实现 gluLookAt，对吗？

这是 gluLookAt 所做的，您应该能够从中复制您需要的内容：

[http://www.opengl.org/wiki/GluLookAt_code](http://www.opengl.org/wiki/GluLookAt_code)

我不确定你真的想用向量和四元数做什么，但我假设你知道你在那里做什么，因为对于不熟悉 gluLookat 的人来说，这似乎相当先进。

# windows-runtime - 在 Slider 控件中访问 Thumb.DragCompleted

> ID：14308597
> 
> 赞同：0
> 
> 时间：2013-01-13T21:50:03.823
> 
> 标签：windows-runtime, winrt-xaml

我有以下代码用于控制 MediaElement 控件的媒体位置。

```
<Slider Grid.Row="1" Maximum="{Binding TotalTimeStamp}" Value="{Binding CurrentTimeStamp, Mode=TwoWay}" Thumb.DragStarted="Thumb.OnDragStarted" Thumb.DragCompleted=""Thumb_OnDragCompleted/> 
```

为了在 MediaElement 中寻找视频位置，我需要能够在拇指拖动开始时暂停视频，然后在拇指拖动完成后恢复视频。但是，由于某种原因，我既无法访问滑块控件中 Thumb 控件的 DragStarted 和 DragCompleted，也无法访问拇指控件，即使深入了解 Slider 模板显示它确实使用了滑块控件。

话虽如此，WPF 完全可以做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T07:13:48.140

我玩了一些模板，但看起来你是对的——如果你拖动拇指——你会得到拖动事件，但如果你开始在其他地方拖动——你能得到的最好的就是一些指针事件。也许你可以得到这些，但你可能只需要限制事件。

这是我尝试过的：

```
using System.Linq;
using WinRTXamlToolkit.Controls.Extensions;
using WinRTXamlToolkit.Debugging;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;
using Windows.UI.Xaml.Controls.Primitives;
using Windows.UI.Xaml.Input;
using Windows.UI.Xaml.Shapes;

namespace App91
{
    public sealed partial class MainPage : Page
    {
        public MainPage()
        {
            this.InitializeComponent();
            this.Loaded += OnLoaded;
        }

        private void OnLoaded(object sender, RoutedEventArgs routedEventArgs)
        {
            //WinRTXamlToolkit.Controls.Extensions.VisualTreeHelperExtensions.GetFirstDescendantOfType<>()
            var horizontalTemplateGrid =
                s1.GetDescendantsOfType<Grid>()
                .First(g => g.Name == "HorizontalTemplate");

            horizontalTemplateGrid.PointerPressed += OnPointerPressed;
            horizontalTemplateGrid.PointerReleased += OnPointerReleased;
            horizontalTemplateGrid.PointerMoved += OnPointerMoved;

            var rect =
                s1.GetDescendantsOfType<Rectangle>()
                .First(g => g.Name == "HorizontalTrackRect");

            rect.PointerPressed += OnPointerPressed;
            rect.PointerReleased += OnPointerReleased;
            rect.PointerMoved += OnPointerMoved;

            rect =
                s1.GetDescendantsOfType<Rectangle>()
                .First(g => g.Name == "HorizontalDecreaseRect");

            rect.PointerPressed += OnPointerPressed;
            rect.PointerReleased += OnPointerReleased;
            rect.PointerMoved += OnPointerMoved;

            var thumb = s1.GetFirstDescendantOfType<Thumb>();
            thumb.DragStarted += ThumbOnDragStarted;
            thumb.DragCompleted += ThumbOnDragCompleted;
            thumb.PointerPressed += OnPointerPressed;
            thumb.PointerReleased += OnPointerReleased;
            this.PointerPressed += OnPointerPressed;
            this.PointerReleased += OnPointerReleased;
        }

        private void OnPointerMoved(object sender, PointerRoutedEventArgs pointerRoutedEventArgs)
        {
            if (pointerRoutedEventArgs.Pointer.IsInContact)
            {
                DC.Trace("Pointer Moved");
            }
        }

        private void OnPointerReleased(object sender, PointerRoutedEventArgs pointerRoutedEventArgs)
        {
            DC.Trace(
                "Pointer Released on " +
                pointerRoutedEventArgs.OriginalSource.GetType() +
                " named " +
                ((FrameworkElement)pointerRoutedEventArgs.OriginalSource).Name);
        }

        private void OnPointerPressed(object sender, PointerRoutedEventArgs pointerRoutedEventArgs)
        {
            DC.Trace(
                "Pointer Pressed on " +
                pointerRoutedEventArgs.OriginalSource.GetType() +
                " named " +
                ((FrameworkElement)pointerRoutedEventArgs.OriginalSource).Name);
        }

        private void ThumbOnDragCompleted(object sender, DragCompletedEventArgs dragCompletedEventArgs)
        {
            DC.Trace("Drag Completed");
        }

        private void ThumbOnDragStarted(object sender, DragStartedEventArgs dragStartedEventArgs)
        {
            DC.Trace("Drag Started");
        }

        private void S1_OnValueChanged(object sender, RangeBaseValueChangedEventArgs e)
        {
            DC.Trace("Value Changed");
        }
    }
} 
```

# maven - 如何将没有版本的第三方 jar 添加到 maven repo

> ID：14308600
> 
> 赞同：1
> 
> 时间：2013-01-13T21:50:15.500
> 
> 标签：maven

如何在没有版本号的情况下添加第三方 jar。到本地 Maven 仓库？我正在尝试使用 maven 3.0.4 构建我的应用程序。它依赖于我本地磁盘中的 3 个第三方 jar。这些罐子没有版本号。这是一个罐子的 MANIFEST.MF 文件

```
Manifest-Version: 1.0
Archiver-Version: Plexus Archiver
Created-By: Apache Maven
Built-By: builder
Build-Jdk: 1.5.0_15
Revision: 105598 
```

请帮我解决这个 Maven 依赖问题。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:53:39.230

你不能。maven 中的每个工件，包括插件和原型，都必须有一个版本。只需选择任何版本并坚持下去。`1.0`听起来不错。甚至更好 - 更深入地看，也许这些 JAR*确实*有一些版本？

# php - 尝试将查询结果显示在同一页面上

> ID：14308603
> 
> 赞同：0
> 
> 时间：2013-01-13T21:50:24.563
> 
> 标签：php, javascript, jquery

我再次需要帮助...我正在尝试列出主要类别列表，除了每个类别之外，还有一个查看按钮可以查看其子类别并显示在同一页面中。这是我的代码：

```
<table width="100%" align="center" style="margin-top:20px;">
<tr><td align="center"><font size="6">Categories</font></td></tr></table>
<?php
$sql = mysql_query("Select * FROM categories WHERE top_cat_id = 0")
?>
<div id="mainCat">
<form method="POST" id="viewSub" action="">
<table width="100%" align="center" class="categories">
<tr><td colspan="3" style="background-color:#000; color:#FFF; font-size:16px;">Main Categories</td></tr>
<tr><td align="center" width="10%" style="font-size:14px; font-weight:bold;">ID</td>
<td align="center" style="font-size:14px; font-weight:bold;">Categorie Name</td>
<td align="center" width="30%" style="font-size:14px; font-weight:bold;">Subcategories</td></tr>
<?php
while($data = mysql_fetch_array($sql))
{
    echo '<tr><input type="hidden" name="cat_id" id="cat_id" value="'.$data['cat_id'].'"><td align="center">'.$data['cat_id'].'</td>';
    echo '<td align="center">'.ucwords(strtolower($data['cat_name'])).'</td>';
    echo '<td align="center"><input type="submit" name="submit" value="View" /></td></tr>';
}
?>
</table></form>
</div>
<script type="text/javascript">
$(function() {
    $("#viewSub").bind('submit',function() {
        var cat_id = $('#cat_id').val();
        $.post('subcategories.php',{cat_id:cat_id}, function(data){
        $("#subCat").html(data);
        });
        return false;
    });
);
</script>
<div id="subCat">

</div> 
```

如您所见，我猜想jQuery函数只听第一个View按钮，因为无论我点击按钮，它只返回第一个主类别的子类。有什么办法让它工作吗？喜欢使用 onclick 动作？我不擅长javascript，所以我需要帮助才能让它工作......

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:16:00.127

这是一个工作代码：

```
<table width="100%" align="center" style="margin-top:20px;">
<tr><td align="center"><font size="6">Categories</font></td></tr></table>
<?php
$sql = mysql_query("Select * FROM categories WHERE top_cat_id = 0");
?>
<div id="mainCat">
<!--<form method="POST" id="viewSub" action="">-->
<table width="100%" align="center" class="categories">
<tr><td colspan="3" style="background-color:#000; color:#FFF; font-size:16px;">Main Categories</td></tr>
<tr><td align="center" width="10%" style="font-size:14px; font-weight:bold;">ID</td>
<td align="center" style="font-size:14px; font-weight:bold;">Categorie Name</td>
<td align="center" width="30%" style="font-size:14px; font-weight:bold;">Subcategories</td></tr>
<?php
while($data = mysql_fetch_array($sql))
{
    echo '<tr><input type="hidden" class="cat_id_'.$data['cat_id'].'" value="'.$data['cat_id'].'"><td align="center">'.$data['cat_id'].'</td>';
    echo '<td align="center">'.ucwords(strtolower($data['cat_name'])).'</td>';
    echo '<td align="center"><input type="button" class="viewData" name="'.$data['cat_id'].'" value="View" /></td></tr>';
}
?>
</table><!--</form>-->
</div>
<script type="text/javascript">
$(document).ready(function(){
    $(".viewData").click(function(){
        var cat_id = $(".cat_id_"+$(this).attr("name")).val();
       $.post('subcategories.php',{cat_id:cat_id}, function(data){
        $("#subCat").html(data);
        });
        return false;
    });
});
</script>
<div id="subCat">

</div> 
```

我假设您的`AJAX`请求工作正常。

PS 为您的 SQL 查询进一步使用准备好的语句。因为这段代码不安全。

# c - 反编译汇编代码（真的）有多难？

> ID：14308610
> 
> 赞同：14
> 
> 时间：2013-01-13T21:50:59.070
> 
> 标签：c, assembly, x86, reverse-engineering, decompiling

我试图找到确凿的事实，以帮助我的管理层了解对编译的 C 代码进行逆向工程的难易程度。

之前在这个站点上已经提出过类似的问题（例如[，是否可以“反编译”Windows .exe？或者至少查看程序集？](https://stackoverflow.com/questions/273145/is-it-possible-to-decompile-a-windows-exe-or-at-least-view-the-assembly)或者[可以反编译用 C 编写的 DLL？](https://stackoverflow.com/questions/8601355/possible-to-decompile-dll-written-in-c)），但这些问题的要点是反编译已编译的 C 代码“很难，但并非完全不可能”。

为了促进基于事实的答案，我包含了一个神秘函数的编译代码，我建议这个问题的答案通过它们是否可以确定这个函数的作用来衡量所提出的技术的成功或失败。这对于 SO 来说可能是不寻常的，但我认为这是对这个工程问题获得“良好的主观”或事实答案的最佳方式。因此，**您对这个函数在做什么以及如何做的最好猜测是什么？**

这是编译后的代码，在 Mac OSX 上使用 gcc 编译：

```
_mystery:
Leh_func_begin1:
    pushq   %rbp
Ltmp0:
    movq    %rsp, %rbp
Ltmp1:
    movsd   LCPI1_0(%rip), %xmm1
    subsd   %xmm0, %xmm1
    pxor    %xmm2, %xmm2
    ucomisd %xmm1, %xmm2
    jbe     LBB1_2
    xorpd   LCPI1_1(%rip), %xmm1
LBB1_2:
    ucomisd LCPI1_2(%rip), %xmm1
    jb      LBB1_8
    movsd   LCPI1_0(%rip), %xmm1
    movsd   LCPI1_3(%rip), %xmm2
    pxor    %xmm3, %xmm3
    movsd   LCPI1_1(%rip), %xmm4
    jmp     LBB1_4
    .align  4, 0x90
LBB1_5:
    ucomisd LCPI1_2(%rip), %xmm1
    jb      LBB1_9
    movapd  %xmm5, %xmm1
LBB1_4:
    movapd  %xmm0, %xmm5
    divsd   %xmm1, %xmm5
    addsd   %xmm1, %xmm5
    mulsd   %xmm2, %xmm5
    movapd  %xmm5, %xmm1
    mulsd   %xmm1, %xmm1
    subsd   %xmm0, %xmm1
    ucomisd %xmm1, %xmm3
    jbe     LBB1_5
    xorpd   %xmm4, %xmm1
    jmp     LBB1_5
LBB1_8:
    movsd   LCPI1_0(%rip), %xmm5
LBB1_9:
    movapd  %xmm5, %xmm0
    popq    %rbp
    ret 
Leh_func_end1: 
```

**更新**

@Igor Skochinsky 是第一个找到正确答案的人：它确实是 Heron 计算平方根算法的幼稚实现。原始源代码在这里：

```
#include <stdio.h>

#define EPS 1e-7

double mystery(double x){
  double y=1.;
  double diff;
  diff=y*y-x;
  diff=diff<0?-diff:diff;
  while(diff>=EPS){
    y=(y+x/y)/2.;
    diff=y*y-x;
    diff=diff<0?-diff:diff;
  }
  return y;
}

int main() {
  printf("The square root of 2 is %g\n", mystery(2.));
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-14T17:16:44.273

这是我将代码转换为 x86（目前不支持 x64）后，使用[Hex-Rays Decompiler 反编译的结果，添加了原始帖子中缺少的一些数据定义，并进行了组装：](http://www.hex-rays.com/products/decompiler/)

```
//-------------------------------------------------------------------------
// Data declarations

double LCPI1_0 =  1.0; // weak
double LCPI1_1[2] = {  0.0,  0.0 }; // weak
double LCPI1_2 =  1.2; // weak
double LCPI1_3 =  1.3; // weak

//----- (00000000) --------------------------------------------------------
void __usercall mystery(__m128d a1<xmm0>)
{
  __m128d v1; // xmm1@1
  __m128d v2; // xmm1@4
  __int128 v3; // xmm2@4
  __m128d v4; // xmm5@7
  __m128d v5; // xmm1@7

  v1 = (__m128d)*(unsigned __int64 *)&LCPI1_0;
  v1.m128d_f64[0] = LCPI1_0 - a1.m128d_f64[0];
  if ( LCPI1_0 - a1.m128d_f64[0] < 0.0 )
    v1 = _mm_xor_pd(v1, *(__m128d *)LCPI1_1);
  if ( v1.m128d_f64[0] >= LCPI1_2 )
  {
    v2 = (__m128d)*(unsigned __int64 *)&LCPI1_0;
    v3 = *(unsigned __int64 *)&LCPI1_3;
    while ( 1 )
    {
      v4 = a1;
      v4.m128d_f64[0] = (v4.m128d_f64[0] / v2.m128d_f64[0] + v2.m128d_f64[0]) * *(double *)&v3;
      v5 = v4;
      v5.m128d_f64[0] = v5.m128d_f64[0] * v5.m128d_f64[0] - a1.m128d_f64[0];
      if ( v5.m128d_f64[0] < 0.0 )
        v5 = _mm_xor_pd(a1, (__m128d)*(unsigned __int64 *)LCPI1_1);
      if ( v5.m128d_f64[0] < LCPI1_2 )
        break;
      v2 = a1;
    }
  }
}
// 90: using guessed type double LCPI1_0;
// 98: using guessed type double LCPI1_1[2];
// A8: using guessed type double LCPI1_2;
// B0: using guessed type double LCPI1_3;

// ALL OK, 1 function(s) have been successfully decompiled 
```

显然，它可以使用一些改进（XMM 支持现在有点基本），但我认为基本算法已经可以理解了。

**编辑**：由于很明显只使用了所有 XMM 寄存器的低位双精度，因此该函数似乎实际上适用于标量双精度而不是向量。至于 _mm_xor_pd (xorpd) 内在函数，我认为这只是编译器实现符号反转的方式 - 通过与预定义的常量进行异或运算，该常量在符号位位置为 1，在其他位置为 0。考虑到上述情况，经过一些清理，我得到以下代码：

```
double mystery(double a1)
{
  double v1; // xmm1@1
  double v2; // xmm1@4
  double v3; // xmm2@4
  double v4; // xmm5@7
  double v5; // xmm1@7

  v1 = LCPI1_0 - a1;
  if ( v1 < 0.0 )
    v1 = -v1;
  if ( v1 < LCPI1_2 )
  {
    v4 = LCPI1_0;
  }
  else
  {
    v2 = LCPI1_0;
    v3 = LCPI1_3;
    while ( 1 )
    {
      v4 = a1;
      v4 = (v4 / v2 + v2) * v3;
      v5 = v4;
      v5 = v5 * v5 - a1;
      if ( v5 < 0.0 )
        v5 = -v5;
      if ( v5 < LCPI1_2 )
        break;
      v2 = a1;
    }
  }
  return v4;
} 
```

它产生的程序集与原始帖子非常相似。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-14T17:59:47.947

逆向工程/反编译任何代码都是花费时间与这样做的好处的问题；不是做起来有多难。

如果你有一些你绝对不能让出去的秘方，那么你唯一能做的就是把秘方作为一个网络服务，在必要时被调用。这样，二进制文件就永远不会离开您的公司墙。

一旦黑客在他们控制的系统上拥有已编译的二进制文件，即使是混淆也只能追踪到任何东西。哎呀，最初的 PC 克隆是通过对 IBM BIOS 进行逆向工程创建的。

所以，回到正题：再一次，这不是一个东西有多难的问题，它更多的是一个人是否愿意尝试的问题......这是基于他们会从中获得什么感知价值。无论是直接美元（接收或储蓄）、竞争优势还是只是吹嘘自己的权利。更复杂的是应用程序的可用性：更广泛的分布等于更高的潜力找到进入黑客工作桶的方式。

如果存在这些价值观，那么您可以放心，有人会尝试并且他们会成功。这应该会引导您进入下一个问题：如果他们这样做了怎么办？最坏的结果是什么？

在某些情况下，这只是一次失败的销售，您可能无论如何都没有得到。在其他情况下，这可能是业务的损失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T18:44:05.697

从根本上说，进行单独的机器指令“逆向工程”非常容易，因为机器指令具有非常明确的语义。这会给你糟糕的 C 代码，但肯定不是目标。（知道文件中的某些二进制模式*是*机器指令在技术上是图灵难的，例如，在某些情况下是不可能的；在编译器生成的代码的情况下不太可能）。

除此之外，您正在尝试推断算法和意图。这非常困难；包含这一切的知识从何而来？

你可能会发现我[关于逆向工程的论文](http://www.semdesigns.com/Company/Publications/WCRE97.pdf)很有趣。它提出了一种编码必要知识的方法。

在某种程度上也有[商业工具可以做到这一点。](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.10.8683)据我了解，这并没有达到我的论文概述的方案，但仍然产生了相当合理的 C 代码。（我对这个工具没有具体的经验，但非常尊重作者和他的工具）。

# css - 在远程服务器上使用 SASS

> ID：14308616
> 
> 赞同：3
> 
> 时间：2013-01-13T21:51:57.280
> 
> 标签：css, sass

我刚刚开始使用 SASS，这很棒。我不在我的本地主机上开发。我使用 Komodo 并直接从外部服务器处理远程文件。我该如何以这种方式使用 SASS？无需使用我的本地主机。我似乎找不到解决方法

希望这是有道理的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-10T14:36:12.780

查看代码包。它允许您添加要“监视”和编译的文件夹。我使用 ExpanDrive 安装我的远程服务器并使用 SublimeText 进行编辑，但我相信你可以使用 Komodo 做类似的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:17:48.187

我发现这是这个问题的答案。在本地服务器上编译并且只将css文件上传到远程服务器是它的唯一方法

[当我们使用 Sass 时，我们应该将哪个文件上传到服务器 .scss 或 .css？](https://stackoverflow.com/questions/8845526/which-file-we-should-upload-to-server-scss-or-css-when-we-use-sass?rq=1)

# python - 用正则表达式匹配两个 Python 列表，并创建字典输出

> ID：14308618
> 
> 赞同：1
> 
> 时间：2013-01-13T21:52:03.847
> 
> 标签：python, regex, dictionary

我有以下两个列表：

`input = ['MAPLEWOOD AVE', 'LYNNDALE ', 'SUGAR DR']`

`ref = ['LYNNDALE (?:RD)?', 'HOMAN (?:AVE)?', 'MAPLEWOOD (?:AVE)?', 'LYNNDALE (?:LN)?']`

我想查找`input`with中每个元素的所有匹配项`ref`。输出将是一个字典，每个键是一个`input`元素，每个值是一个`ref`与相应元素匹配的`input`元素，如下所示：

`{'MAPLEWOOD AVE' : 'MAPLEWOOD AVE', 'LYNNDALE ' : 'LYNNDALE RD', 'LYNNDALE LN', 'SUGAR DR':}`

以下允许我迭代`input`以搜索其中的`findall`匹配项`ref`（其中包含嵌入的正则表达式分组）。但是，我无法从`ref`每个输入元素旁边的值中检索相应的匹配元素：

```
combined = "(" + ")|(".join(ref) + ")"

l = []

for i in input:
    if re.findall(combined,i):
         l.append(i)
...
MAPLEWOOD AVE
LYNNDALE 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-13T22:21:32.823

尝试：

```
import re

input = ['MAPLEWOOD AVE', 'LYNNDALE ', 'SUGAR DR']
ref = ['LYNNDALE (?:RD)?', 'HOMAN (?:AVE)?', 'MAPLEWOOD (?:AVE)?', 'LYNNDALE (?:LN)?']
output = dict([ (i, [ r for r in ref if re.match(r, i) ]) for i in input ]) 
```

或者，如果您使用的是 Python 3：

```
output = { i : [ r for r in ref if re.match(r, i) ] for i in input } 
```

你也可以编译你的正则表达式来加速它们：

```
ref_re = [ re.compile(r) for r in ref ]
output = { i : [ r.pattern for r in ref_re if r.match(i) ] for i in input } 
```

**UPD：** 也许您想使用匹配的部分作为值，而不是模式：

```
output = { i : [ r.match(i).group(0) for r in ref_re if r.match(i) ] for i in input } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:13:16.487

我认为您错过了正则表达式中的空格。试试这个方法：

```
ref = ['LYNNDALE\s*(?:RD)?', 'HOMAN\s*(?:AVE)?', 'MAPLEWOOD\s*(?:AVE)?', 'LYNNDALE\s*(?:LN)?'] 
```

# asp.net-mvc-3 - 如何隐藏视图上的菜单选项卡？

> ID：14308623
> 
> 赞同：0
> 
> 时间：2013-01-13T21:52:27.480
> 
> 标签：asp.net-mvc-3

我的申请电子邮件是一个视图。但是我想让这个特定的视图忽略 _Layout.cshtml 呈现的菜单选项卡。有没有一种相当简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:18:46.083

我通过放置 @Layout=null; 解决了我的问题 在视图的顶部。

# jsp - 如果 JSP 中带有检查变量的情况

> ID：14308630
> 
> 赞同：0
> 
> 时间：2013-01-13T21:53:07.880
> 
> 标签：jsp, if-statement, counter

我试图检查计数器是否运行两次。因此，我需要它，电影评论不会显示两次。

但是，对于评论/人员，我得到了一个空的结果。

```
<c:set var="counter" value="${0}"/>

<c:forEach items="${ reviews }" var="review">
    <c:forEach items="${ persons }" var="person">
        <c:if test="{ counter % 2 == 0}">
            <div class="review">
                <p>
                    <div class="user">
                        Benutzer: <c:out value="${ person.email }"></c:out>
                    </div>

                    <div class="stars">
                        Einzelbewertung: <c:out value="${ review.stars }"></c:out>
                    </div>

                    <div style="color: grey; font-size: 14px;">Meinung:</div>
                    <div class="reviewText">
                        <c:out value="${ review.text }"></c:out>
                    </div>
                </p>
            </div>
            <c:set var="counter" value="${counter + 1}" />

        </c:if>

    </c:forEach> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T21:54:53.243

无需使用单独的计数器。使用`forEach`标签的`varStatus.index`or`varStatus.count`代替。有关更多信息，请参阅[http://www.ibm.com/developerworks/java/library/j-jstl0318/](http://www.ibm.com/developerworks/java/library/j-jstl0318/)。

像这样的东西（请注意，`status.index`每次评论都从零开始）：

```
<c:forEach items="${ reviews }" var="review">
    <c:forEach items="${ persons }" var="person" varStatus="status">
        <c:if test="${ status.index % 2 == 0}">
            <div class="review">
                <p>
                    <div class="user">
                        Benutzer: <c:out value="${ person.email }"></c:out>
                    </div>

                    <div class="stars">
                        Einzelbewertung: <c:out value="${ review.stars }"></c:out>
                    </div>

                    <div style="color: grey; font-size: 14px;">Meinung:</div>
                    <div class="reviewText">
                        <c:out value="${ review.text }"></c:out>
                    </div>
                </p>
            </div>

        </c:if>

    </c:forEach>
</c:forEach> 
```

# python - TypeError: 不支持的操作数类型 -: 'unicode' 和 'unicode', coords

> ID：14308639
> 
> 赞同：6
> 
> 时间：2013-01-13T21:53:54.430
> 
> 标签：python, html, database, unicode

完整代码在[这里](https://github.com/stuycs-ml7-projects/YAN-SHAN-PHAN-WU/)

HTML 代码

```
<input type="hidden" id="Latitude" name="Latitude" value={{Longitude}} />
<input type="hidden" id="Longitude" name="Longitude" value={{Longitude}} />

document.getElementById("Latitude").value  =  position.coords.latitude;
document.getElementById("Longitude").value =  position.coords.longitude; 
```

应用程序.py

```
Latitude = request.form['Latitude']
Longitude = request.form['Longitude']

messages = database.returnMessagesinRange(float(Latitude),float(Longitude)) 
```

数据库.py

```
def returnMessagesinRange(longitude,latitude):
    allMessages = Messages.find()
    messagesinRange = []
    for current in allMessages:
        if ((current['longitude']-longitude) * (current['longitude']-longitude) + (current['latitude']-latitude)*(current['latitude']-latitude)) <= 1:
            if messagesinRange == None:
                messagesinRange = [current['text']]
            else:
                messagesinRange.append(current['text'])
    return messagesinRange 
```

当它运行时，我得到

```
if ((current['longitude']-longitude) * (current['longitude']-longitude) + (current['latitude']-latitude)*(current['latitude']-latitude)) <= 1: 
```

```
TypeError: unsupported operand type(s) for -: 'unicode' and 'unicode' 
```

有谁知道为什么会这样？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-13T22:02:49.237

从请求和数据库中检索到的经度和纬度都是字符串（unicode 字符串），您正试图对它们进行操作，就好像它们是数字一样。

您应该首先获取此类字符串的`int`or`float`表示，以便能够将它们作为数字进行操作（使用`-`,`*`等）

您可以通过创建一个`int`或`float`对象将字符串作为参数传递来做到这一点

```
latitude = int(request.form['Latitude']) 
```

或者

```
latitude = float(request.form['Latitude']) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T22:02:44.710

与 PHP 不同，Python 不会自动从字符串转换为浮点数。采用：

```
errors = []
try:
    latitude = float(request.form['Latitude'])
except ValueError:
    # do something about invalid input
    latitude = 0.0
    errors.append(u"Invalid input for Latitude.") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T22:02:21.617

`current['longitude']`并且`longitude`都是`unicode`字符串。`float`如果您打算减去它们，则需要将它们转换为s。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-13T23:03:40.800

好的，我们这样做了。

```
def returnMessagesinRange(longitude,latitude):
allMessages = Messages.find()
longitude = (eval(str(longitude)))
latitude = (eval(str(latitude)))
messagesinRange = []
for current in allMessages:
    y=eval(str(current['longitude']))
    x=eval(str(current['latitude']))
    if ((longitude-x)*(longitude-x))+((latitude-y)*(latitude-y)) <= 1:
        if messagesinRange == None:
            messagesinRange = [str(current['text'].encode('ascii','ignore'))]
        else:
            messagesinRange.append(str(current['text'].encode('ascii','ignore')))
return messagesinRange 
```

终于可以看到结局了！

# eclipse - m2e 忽略测试资源的 testOutputDirectory

> ID：14308642
> 
> 赞同：1
> 
> 时间：2013-01-13T21:54:16.100
> 
> 标签：eclipse, maven, m2e

我需要将我的构建输出到另一个**目标**目录。

使用**project.build.directory**，**output**和**testOutputDirectory**属性可以从命令行正常工作，但是当我从 eclipse 构建时，如果我有一个目录`mvn clean install`，它会创建一个空目录。`target/test-classes``src/test/resources`

一个具有相同行为的简单 pom 文件如下所示：

```
<project>
    <groupId>com.example</groupId>
    <version>1.0.0</version>    
    <modelVersion>4.0.0</modelVersion>
    <artifactId>reproduce</artifactId>
    <packaging>war</packaging>
    <properties>
        <project.build.directory>differentTarget</project.build.directory>
        <project.build.outputDirectory>${project.build.directory}/classes</project.build.outputDirectory>
        <project.build.testOutputDirectory>${project.build.directory}/different-test-classes</project.build.testOutputDirectory>
    </properties>

    <build>
        <directory>${project.build.directory}</directory>
        <outputDirectory>${project.build.outputDirectory}</outputDirectory>
        <testOutputDirectory>${project.build.testOutputDirectory}</testOutputDirectory>
    </build>
</project> 
```

我的目录结构如下：

```
 |-src
   |---main
   |-----webapp
   |-------WEB-INF
   |---test
   |-----resources 
```

我可以重现该行为的最简单方法是将所有目录都为空，除了`<web-app />`里面的 web.xml 。

当我有实际的测试类时，它会在`target/test-classes`目录中创建文件夹，然后将实际的类文件放在`differentTarget/test-classes`.

我在*Debian上使用**Eclipse Indigo*、*m2e 1.2.0*和*Maven Integration for WTP 0.15.3*

 ***编辑**

如果我删除`properties`和硬编码输出：

```
<build>
    <directory>differentTarget</directory>
    <outputDirectory>differentTarget/classes</outputDirectory>
    <testOutputDirectory>differentTarget/different-test-classes</testOutputDirectory>
</build> 
```

然后当我去**Maven > Update Project...时我得到正确的行为但是当我去****Project > Clean**或者更重要的是让它在**Build Automatically**时我仍然得到不正确的目标文件夹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:15:17.597

尝试检查您的 Java 构建路径的输出文件夹。m2e 插件可能无法更新所有输出路径：

右键单击您的项目-> 构建路径-> 配置构建路径。

在 Source 选项卡上展开每个条目，编辑 Output Folder 并将每个条目切换回项目默认值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:00:58.950

默认情况下，所有 maven POM 都继承 Super POM。如果您查看[Maven Super POM](http://maven.apache.org/guides/introduction/introduction-to-the-pom.html)，您可以看到**testOutputDirectory**被定义为项目/构建下的一个元素。我不确定您是否打算将其设置为属性。尝试直接在 <build> 部分下覆盖元素 <testOutputDirectory>

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T22:07:48.753

有时 m2e 不接受更改。

所以选择你的项目，**点击鼠标右键 -> Maven -> 更新项目**。

![在此处输入图像描述](../Images/9baffb6118db603137692415ec572c26.png)

如果这没有帮助，请删除 .settings 文件夹并重试。

**编辑：**

也许它无法翻译构建部分中使用的属性。尝试硬编码：

```
 <build>
    <directory>differentTarget</directory>
    <outputDirectory>differentTarget/classes</outputDirectory>
    <testOutputDirectory>differentTarget/different-test-classes</testOutputDirectory>
 </build> 
```*

# javascript - 为什么 clearInterval 在窗口模糊和焦点事件函数中不起作用？

> ID：14308644
> 
> 赞同：-2
> 
> 时间：2013-01-13T21:54:20.647
> 
> 标签：javascript, jquery, clearinterval

我有一个小型通知和警报系统。

我只是想检测窗口的状态是模糊还是焦点，然后列出这些警报和通知。但是我的 clearInterval 方法不起作用。这是代码；

```
$(document).ready(function(){
     setTimeout(function(){loadMessageNotifications()},600);
     setTimeout(function(){loadStoryNotifications()},400);

       var intervalStoryAlerts = setInterval(function(){loadStoryAlerts()},6000);
       var intervalMessageAlerts = setInterval(function(){loadMessageAlerts()},16000); 

    $(window).bind("focus", function(event){

         setTimeout(function(){loadMessageNotifications()},600);
         setTimeout(function(){loadStoryNotifications()},400);

       var intervalStoryAlerts = setInterval(function(){loadStoryAlerts()},6000);
       var intervalMessageAlerts = setInterval(function(){loadMessageAlerts()},16000); 

    }).bind("blur", function(event){

        clearInterval(intervalStoryAlerts);
        clearInterval(intervalMessageAlerts);
    });
}); 
```

这些 clearInterval 的 console.log() 输出是未定义的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T21:56:56.127

可能是因为您使用了错误的（超出范围）`intervalStoryAlerts`and `intervalMessageAlerts`，所以它们指向新的间隔。而是将重新声明放在焦点的绑定中。尝试：

```
// variables defined in enclosing scope
var intervalStoryAlerts = ..;
var intervalMessageAlerts = ..;

$(window).bind("focus", function(event){

     setTimeout(function(){loadMessageNotifications()},600);
     setTimeout(function(){loadStoryNotifications()},400);

     // remove var here so that new variables are not created
     intervalStoryAlerts = setInterval(function(){loadStoryAlerts()},6000);
     intervalMessageAlerts = setInterval(function(){loadMessageAlerts()},16000); 
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:32:24.650

```
….bind("focus", function(event){
   // […]
   var intervalStoryAlerts = setInterval(loadStoryAlerts, 6000);
   var intervalMessageAlerts = setInterval(loadMessageAlerts, 16000); 

}) 
```

这些[`var`声明](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var)使这两个变量成为函数的局部变量，并且您的代码不会覆盖就绪处理程序范围内的变量。因此，值将丢失并且间隔不会被清除。只需省略“ `var`”。

# c# - 我可以在 OR 语句中包含对对象进行空值检查作为另一个条件吗？

> ID：14308650
> 
> 赞同：0
> 
> 时间：2013-01-13T21:54:55.923
> 
> 标签：c#, null-check

> **可能重复：**
> [在 .NET 中依赖 && 短路安全吗？](https://stackoverflow.com/questions/4820610/is-relying-on-short-circuiting-safe-in-net)

我不知道如何正确地表达问题的标题，但是用一行代码来解释很简单：

```
if (someObject == null || someObject.someProperty)
    ... 
```

我可以这样做吗？或者这个：

```
if (someObject != null && someObject.someProperty)
    ... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-13T21:56:04.147

是的。

只有当第一个操作数是 时，才会计算第二个操作数`false`。

但显然，第二个操作数也必须是布尔值。

同样，`&&`仅当第一个操作数为 时才计算第二个操作数`true`。

这称为短路。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-13T21:56:32.270

是的，这是安全的。`||`并且`&&`是[短路运算符](https://stackoverflow.com/questions/4820610/is-relying-on-short-circuiting-safe-in-net)。从[MSDN 库](http://msdn.microsoft.com/en-us/library/6373h346(v=vs.71).aspx)：

> 条件或运算符 (||) 对其布尔操作数执行逻辑或，但仅在必要时评估其第二个操作数。
> 
> 操作
> 
> ```
> x || y 
> ```
> 
> 对应操作
> 
> ```
> x | y 
> ```
> 
> 除了如果 x 为真，则不计算 y（因为无论 y 的值是什么，OR 运算的结果都是真）。这称为“短路”评估。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T21:56:57.643

是的，通常的做法是在 if 语句中使用空值检查，通常使用 AND。

这是有效的，因为如果第一个为真，该语句将短路并结束。

这两个都是有效的：

```
if(something != null && something.Bool)
  ...

if(something != null || something.Bool)
  ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-13T21:58:43.450

是的，`||`两者`&&`都短路。事实上，你偶尔会看到人们编写这样的代码：

```
x != null && x.f(); 
```

这相当于：

```
if(x != null) x.f(); 
```

（大多数时候可能不是一个好主意 - 这不利于可读性。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-13T21:59:23.317

是的，你可以，但你想要哪一个取决于你所追求的语义。

在第一种情况下，如果根本没有对象或属性返回 true，则您的条件将运行。基本上没有实例意味着条件逻辑应该执行。

在第二种情况下，没有实例不会导致您的条件运行；在这种情况下，您必须同时拥有一个实例并且该属性的计算结果必须为真。

我今天在加载用户偏好时处理了同样的事情。我必须决定是否“检查”了首选项，并且由于我们可能会添加新的首选项（无需为每个用户为该首选项添加行到数据库中），因此我选择了符合我的用例的后一种条件。

# dojo - 避免xpages inputText中的默认0

> ID：14308663
> 
> 赞同：0
> 
> 时间：2013-01-13T21:56:24.023
> 
> 标签：dojo, xpages

我有一个 xpages 编辑框控件，显示类型为数字，显示格式为货币。默认情况下，此控件显示 0。但我希望它为空。我如何做到这一点。还有另一个问题-控制在读取模式下不显示货币格式。它在编辑模式下工作正常。如何让它在读取模式下工作？

这是代码：

```
<xp:inputText id="ApInt" value="#{dsRacDoc.ApInt}" 
dojoType="dijit.form.CurrencyTextBox" 
valueChangeListener="#{javascript:changeRequestBean.valueChangeListener}">
    <xp:this.converter>
        <xp:convertNumber type="currency" integerOnly="true" currencySymbol="$">
        </xp:convertNumber>
    </xp:this.converter>
    <xp:this.dojoAttributes>
        <xp:dojoAttribute name="constraints" value="{fractional:false, max:999999999999999}">
        </xp:dojoAttribute>
        <xp:dojoAttribute name="currency" value="USD">
        </xp:dojoAttribute>
        <xp:dojoAttribute name="invalidMessage" value="Invalid amount. Enter whole dollar amount upto 15 digits">
        </xp:dojoAttribute>
        <xp:dojoAttribute value="15" name="maxLength">
        </xp:dojoAttribute>
    </xp:this.dojoAttributes>
</xp:inputText> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T17:35:29.150

我没有尝试使用您的代码，但如果您删除*integerOnly*它不应再默认为 0。项目值将是空字符串。如果您将*maxFractionDigits*设置为 0，它应该与整数相同，但我没有尝试过。

对于读取模式，您可能需要自己在*Computed Field*中对其进行格式化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T19:42:19.113

我认为这种情况下的最佳选择是有一个单独的编辑和阅读视图控件，正如 Panu 已经注意到的那样。

创建 2 个控件。

1.  一个简单的，它将在 value 属性中包含一个表达式，它将生成您想要的文本格式。例如：

1.  第二个控件将在编辑模式下使用。这可以是任意的

# javascript - 我如何：在表单中保存表单信息

> ID：14308669
> 
> 赞同：-3
> 
> 时间：2013-01-13T21:56:58.247
> 
> 标签：javascript, html, forms, web

这是我的示例表单脚本：

```
<body bgcolor="silver">
<center>
<form method="POST">
<h1><u>Updates/Ideas for Server</u></h1><br>
<br>
<textarea name="fileData" rows=25 cols=60>
</textarea><br>
<br>
<input type="submit" value="Update" name="submit">
</form>
</br>
<h1><u>Finished List</u></h1><br>
<br />-example 1
<br />-example 2
<br />-example 3
</center>
</body> 
```

我需要知道如何将表单信息保存到表单本身，以便我可以随时返回并进行更改。

注意：第二部分“完成列表”将用 HTML 进行编辑，不是我的问题的一部分。

谢谢你，~亚伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:02:53.290

假设您向我们展示了完整的表格（而不仅仅是一个精简的示例），那么使用数据库将是多余的。使用本地存储：

[https://developers.google.com/web-toolkit/doc/latest/DevGuideHtml5Storage](https://developers.google.com/web-toolkit/doc/latest/DevGuideHtml5Storage)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T21:59:02.633

您需要使用某种服务器技术来启用此功能，或使用本地存储。

# matlab - 我有矩阵 A 和矩阵 B。我想根据 B 中的值获取 A 的值

> ID：14308672
> 
> 赞同：-1
> 
> 时间：2013-01-13T21:57:09.097
> 
> 标签：matlab

我有矩阵

```
A=magic(4)*10 
```

和矩阵

```
B=[6 6 2 6;  1 1 2 1; 7 7 2 1; 3 3 -1 3 ] 
```

我想获得`A`取决于`B`. 例如：

```
A=
160 20  30  130
50  110 100 80
90  70  60  120
40  140 150 10

B=
6   6   2   6
6   6   2   2
2   6   2   6
6   2   -1  2 
```

我想从`A(1,1)`（值=160）开始。然后，如果 , 上的对应值`B`，`B(1,1) = 6`我想得到右边的元素，`A(1,2)`，如果`B(1,1) = 2`，我想得到下面的值，`A(2,1)`。最后，如果值为-1，我不想继续。最后我想得到这样的结果：

```
result=
160
20
30
100
60 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-13T22:19:33.117

试试下面的代码：

```
% Inizialize matices
A=magic(4)*10;
B=[6 6 2 6;  1 1 2 1; 7 7 2 1; 3 3 -1 3 ];

% Inizialize internal variables
contin=1;
row=1;
column=1;
result=[];

while contin==1
    %append value
    result=[result A(row, column)];
    if B(row, column)==6
        column=column+1; %go to the right
    elseif B(row, column)==2
        row=row+1; %go down
    elseif B(row, column)==-1
        contin=0; %break
        result(end)=[]; %delete last value 
    end
end

result 
```

# php - 图像平铺代码应用颜色过滤器

> ID：14308673
> 
> 赞同：0
> 
> 时间：2013-01-13T21:57:15.150
> 
> 标签：php

我正在尝试使用不同的图像制作平铺图像。在第一个图块之后，第一个图块的平均颜色作为过滤器应用于另一个图块。如何在没有过滤器的情况下使用每张平铺图片？我的代码如下；

```
<?php 

$dest = imagecreatefrompng('myimage.png');

$src[] = imagecreatefrompng('otter.png');
$src[] = imagecreatefrompng('fox.png');
$src[] = imagecreatefrompng('opals.png');

// Copy and merge
for($i=0;$i<count($src);$i++){
imagecopymerge($dest, $src[$i], 32*$i, 0, 0, 0, 32, 32, 100);

}
// Output and free from memory
header('Content-Type: image/png');
imagepng($dest);
imagedestroy($dest);

for($ii=0;$ii<count($src);$ii++){
imagedestroy($src[$ii]);
}

?> 
```

示例图块链接 > [http://7kitap.com/fox.png](http://7kitap.com/fox.png)

代码链接 > [http://7kitap.com/fillimage.php](http://7kitap.com/fillimage.php)

正如您将在上面的链接中看到的那样，第一个图块后，图块图片的颜色会发生变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:12:29.507

尝试使用 imagecreatetruecolor。也许第一张图像中的颜色被用作其余图像的基础。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:21:24.273

您的脚本可能会有一些改进，现在如果您的`$src`图片多于填充`width`.

我调整了您的代码以处理尽可能多的图块：

```
<?php 

$width = 320; // pick size
$height = 320; // pick size

$dest = imagecreatetruecolor($width, $height);

// I just added the same 3 pictures just to test the overflow
$src[] = imagecreatefrompng('otter.png');
$src[] = imagecreatefrompng('fox.png');
$src[] = imagecreatefrompng('opals.png');
$src[] = imagecreatefrompng('otter.png');
$src[] = imagecreatefrompng('fox.png');
$src[] = imagecreatefrompng('opals.png');
$src[] = imagecreatefrompng('otter.png');
$src[] = imagecreatefrompng('fox.png');
$src[] = imagecreatefrompng('opals.png');
$src[] = imagecreatefrompng('otter.png');
$src[] = imagecreatefrompng('fox.png');
$src[] = imagecreatefrompng('opals.png');
$src[] = imagecreatefrompng('otter.png');
$src[] = imagecreatefrompng('fox.png');
$src[] = imagecreatefrompng('opals.png');

$thumbnailWidth = 32; // Should be deduced from the thumbnails

$imagesPerRow = $width / $thumbnailWidth;
// Copy and merge
for($i=0;$i<count($src);$i++)
{
    // Using this code, your thumbnails will overflow to the next row
    $row = floor($i / $imagesPerRow);
    $column = $i % $imagesPerRow;
    imagecopymerge($dest, $src[$i], 32*$column, 32*$row, 0, 0, 32, 32, 100);
}
// Output and free from memory
header('Content-Type: image/png');
imagepng($dest);
imagedestroy($dest);

for($ii=0;$ii<count($src);$ii++){
    imagedestroy($src[$ii]);
}

?> 
```

这将为您提供以下结果：

![瓷砖](../Images/05f8e5facfb55e86671ad0540830dd2d.png)

# windows - 如果 HTML5 Windows 8 应用程序中的文本溢出，则自动添加省略号

> ID：14308676
> 
> 赞同：0
> 
> 时间：2013-01-13T21:57:38.440
> 
> 标签：windows, windows-8, microsoft-metro

我总是很难搜索有关 Windows 8 开发的任何内容，如果这很简单并且在某个地方，我很抱歉......

如果内容在 Windows 8 HTML5 应用程序中溢出，是否有任何方法可以在标题/段落/等的末尾自动添加省略号 (...)？我知道 Mozilla 支持`text-overflow: ellipses;`，但这不适用于此功能，`-ms-text-overflow: ellipses;`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:00:33.803

根据那篇文章：http: [//msdn.microsoft.com/en-us/library/windows/apps/hh996980.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh996980.aspx)这应该有效：

```
-ms-text-overflow: ellipsis; 
```

确保拼写：省略号，而不是省略号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T01:41:27.857

查找给定功能状态的一个好方法是在 caniuse.com 上进行检查。如果 IE10 支持给定功能，您应该能够在 Windows 应用商店的 HTML/JS 应用程序中使用它。caniuse.com 搜索非常强大，如下所示：

[http://caniuse.com/#search=text-overflow](http://caniuse.com/#search=text-overflow)

并且有指向资源的链接，例如[http://www.css3files.com/text/](http://www.css3files.com/text/)以获取更多信息和正确的语法。

至于 wrap 和 text-overflow: ellipsis 一起，显然这对于​​纯 CSS 是不可能的，但是这里有一些人们推荐的解决方法，可能值得尝试：

[有人知道在包装的文本上使用 CSS 文本溢出的方法吗？](https://stackoverflow.com/questions/2390086/anybody-know-a-way-to-use-css-text-overflow-on-text-thats-wrapping)

有关开发 Windows 应用商店应用程序的更多信息，请查看[生成应用程序](http://bit.ly/gd30tolaunch)。

# actionscript-3 - 如何确定（在 AS3 中）系统光标是隐藏还是显示？

> ID：14308683
> 
> 赞同：3
> 
> 时间：2013-01-13T21:58:08.307
> 
> 标签：actionscript-3, mouse-cursor

我们有两种方法来处理动作脚本 3 中的光标可见性：Mouse.hide() 和 .show()。

我的电影加载了一个外部的，可能会故意隐藏光标。我必须根据它的决定来改变界面。

我可以检测它是隐藏还是显示？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:55:38.417

查看[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/ui/Mouse.html) ，似乎没有代表`Mouse`. 这意味着您可能需要做的是在您`.show()`和`.hide()`鼠标时从外部加载的 SWF 中分派事件，然后在顶层侦听这些事件以触发适当的反应。

# javascript - 在 window.location.hash 上运行 JSON.parse() 是否安全？

> ID：14308689
> 
> 赞同：2
> 
> 时间：2013-01-13T21:58:45.560
> 
> 标签：javascript, ajax, json

我正在寻找一种在我的 URL 哈希中存储一些 javascript 变量的方法。我的目标是允许用户使用书签来恢复 Web 应用程序的特定状态。

我突然想到一种方法可能使用 JSON 序列化。即，我会像这样存储我的变量

```
var params = { var1: window.val1, var2: window.val2 }
window.location.hash = JSON.stringify(params) 
```

并像这样恢复它们

```
var paramStr = window.location.hash.substring(1) // substring removes the initial "#"
var params = JSON.parse(paramStr)
window.var1 = params.var1
window.var2 = params.var2 
```

这似乎是做我想做的最简单和最简洁的技术。这对我来说很容易理解，并且它使用的代码行数比[这个流行的 SO 建议](https://stackoverflow.com/a/901144/765287)少。然而，它也感到不安全。恶意用户可以将任意代码写入 url，我的应用程序会执行它。这似乎很危险，但我对网络编程很陌生，所以我不知道这有多大意义。

我上面概述的用于存储变量的技术是否可以`window.location.hash`安全使用？如果不是，为什么不呢？可能发生的最坏情况是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-13T22:01:17.477

是的，解析任意数据是安全的。JSON 解析器不会执行任何不同于定义对象/数组/字符串/数字的代码。原生的甚至根本不使用`eval`（非原生的在使用之前验证 JSON 数据`eval`）。

假设您的代码不会对这些变量做“坏”的事情，将它分配给*预定义*的（全局）变量也是安全的。

但是，将其分配给任意全局变量*并不一定安全。*虽然 JSON 不能包含函数，但您不希望任何人能够覆盖任何全局变量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-13T22:01:44.450

> 恶意用户将能够将任意代码写入 url [...] 该技术 [...] 可以安全使用吗？

它是安全的。`JSON.parse()`旧方法的优点之一`eval()`是它是安全的并且不会运行任意代码。

另一个问题是：将 JSON 放入散列中是个好主意吗？我会寻求更简洁的表示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T22:01:27.457

第一课是永远不应该信任所有用户输入。

始终验证一切。对于您的应用程序，如果它仅处于脱机状态，那么恶意用户输入的内容实际上并不重要，因为它只会影响他们自己的计算机。

如果它涉及服务器端活动，那么您应该检查以确保您收到的输入是有意义的。例如，如果用户试图访问保存的文件，用户是否有权查看它？

默默无闻没有安全性，因此散列中的 JSON 与某些复杂的加密方法一样安全。

# html - 我在 CSS 中的这个选项卡式导航中做错了什么？

> ID：14308693
> 
> 赞同：-1
> 
> 时间：2013-01-13T21:59:18.357
> 
> 标签：html, css, tabs, navigation, tabbed

该网站在[这里](http://irishbaubles.com/home/home.html#page=page-1)：

在此页面上，您可以看到选项卡当前为蓝色，但我目前正在处理脱机文件，我正在将其转换为在整个网站设计中都可以看到的自然绿色。不幸的是，我不知道我做了什么，感觉我疲倦的眼睛无法注意到错误......无论是在代码中还是在图像中......

离线标签导航问题：http: [//i255.photobucket.com/albums/hh157/redbairn/Oops_zps240d13a5.jpg](http://i255.photobucket.com/albums/hh157/redbairn/Oops_zps240d13a5.jpg)

[下面的代码是Tab导航的当前代码：]

```
 div.content {
    border: 3px solid #095;
    clear: left;
    padding: 1em;
    overflow:hidden;
}

div.content.inactive {
    display: none;
}

ol#toc {
    height: 2em;
    list-style: none;
    margin: 0;
    padding: 0;
}

ol#toc a {
    background: #bdf url(tabs.gif);
    display: block;
    float: left;
    height: 2em;
    padding-left: 10px;
    text-decoration: none;
}

ol#toc a:hover {
    background-color: #3af;
    background-position: 0 -120px;
}

ol#toc a:hover span {
    background-position: 100% -120px;
}

ol#toc li {
    float: left;
    margin: 0 1px 0 0;
}

ol#toc li a.active {
    background-color: #095;
    background-position: 0 -60px;
    color: #fff;
    font-weight: bold;
}

ol#toc li a.active span {
    background-position: 100% -60px;
}

ol#toc span {
    background: url(tabs.gif) 100% 0;
    display: block;
    line-height: 2em;
    padding-right: 10px;
} 
```

[离线/新代码：]

```
div.content {
        border: 3px solid #095;
        clear: left;
        padding: 1em;
        overflow:hidden;
}

div.content.inactive {
        display: none;
}

ol#toc {
    height: 2em;
    list-style: none;
    margin: 0;
    padding: 0;
}

ol#toc a {
        color: #008;
        display: block;
        float: left;
        height: 2em;
        padding-left: 10px;
        text-decoration: none;
        background-color: #6c9;
        background-image: url(tabs.gif);
}

ol#toc a:hover {
        background-color: #0c6;
        background-position: 0 -120px;
}

ol#toc a:hover span {
    background-position: 100% -120px;
}

ol#toc li {
    float: left;
    margin: 0 1px 0 0;
}

ol#toc li a.active {
        background-color: #096;
    background-position: 0 -60px;
    color: #fff;
    font-weight: bold;
}

ol#toc li a.active span {
    background-position: 100% -60px;
}

ol#toc span {
    background: url(tabs.gif) 100% 0;
    display: block;
    line-height: 2em;
    padding-right: 10px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:04:01.513

我认为它的形象。虽然您将背景颜色设置为透明是正确的，但在我看来，图像本身看起来像是白​​色背景。在编辑器中打开图像，您会注意到图像中的白色背景。我认为，如果您将其从图像中删除，一切都会看起来很棒！

希望这对你有帮助！

仅供参考，在较旧的浏览器（如 IE5）中，透明不能很好地工作。

# gcc - DMD 在带有强化 GCC 的 Ubuntu 12.10 64 位上生成可执行段错误

> ID：14308697
> 
> 赞同：1
> 
> 时间：2013-01-13T21:59:30.607
> 
> 标签：gcc, segmentation-fault, d, dmd, gnu-toolchain

我在让 DMD 2.061 处理我的 Ubuntu 12.10 配置时遇到问题。

当我第一次使用以下脚本安装它时

```
if grep -qE "^deb http://d-apt.googlecode.com/files /" /etc/apt/sources.list; then
    echo "Already there";
else
    echo 'deb http://d-apt.googlecode.com/files /' | sudo tee -a /etc/apt/sources.list;
fi

sudo apt-get update -q=2;
sudo apt-get --yes --allow-unauthenticated install d-apt-keyring;
sudo apt-get update -q=2;

sudo apt-get install -y dmd;
sudo apt-get install -y libgtkd-dev libgtkd-doc;
sudo apt-get install -y libtango-dev libtango-doc;
sudo apt-get install -y libdcollections-dev libdcollections-doc;
sudo apt-get install -y liborange-dmd-dev liborange-dmd-doc;
sudo apt-get install -y libderelict-dev;
sudo apt-get install -y libgl3n-dev libgl3n-doc;
sudo apt-get install -y libdsqlite-dev libdsqlite-doc;
sudo apt-get install -y libspiritd-dev libspiritd-doc;
sudo apt-get install -y libdstats-dev libdstats-doc;
sudo apt-get install -y libmsgpack-dmd-dev libmsgpack-dmd-doc;
sudo apt-get install -y vibe vibe-doc; 
```

一切正常。

但...

然后突然在我从一些 Ubuntu PPA 安装了我最喜欢的软件后，*代码*dmd 会生成段错误。由于我使用了很多额外的 PPA，因此要找出导致崩溃的 PPA 并不容易。我已经在默认（未修改）用户上尝试过这个。

具体命令

```
strace -f dmd -run f.d 
```

其中`f.d`包含

```
import std.stdio;
void main(string args[])
{
  auto x = 0b10;
  writeln(x);
} 
```

崩溃为

```
getrlimit(RLIMIT_STACK, {rlim_cur=8192*1024, rlim_max=RLIM_INFINITY}) = 0
brk(0)                                  = 0x1908000
brk(0x1929000)                          = 0x1929000
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
+++ killed by SIGSEGV (core dumped) +++ 
```

接下来我尝试比较 dmd 使用的所有动态库的 sha1sum，然后是我的程序：

```
linux-vdso.so.1 =>  (0x00007ffff53ff000)
libstdc++.so.6 => /usr/lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007f87f0ba0000)
libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f87f0983000)
libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f87f0686000)
libgcc_s.so.1 => /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007f87f0470000)
libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f87f00b1000)
/lib64/ld-linux-x86-64.so.2 (0x00007f87f0ecf000) 
```

到我的电视系统上默认安装的没有额外 PPA 的那些。

事实证明，情况`/usr/lib/x86_64-linux-gnu/libstdc++.so.6`有所`/lib/x86_64-linux-gnu/libgcc_s.so.1`不同。

然后我将这些文件复制到我的原始系统并使用

`LD_PRELOAD=libstdc++.so.6:libgcc_s.so.1`

但是......我仍然得到同样的段错误......我迷路了。否则到底是什么导致了这个问题？我应该开始比较 dmd 和我的程序读取的文件（由 strace 收集）吗？

我的系统与 gcc、g++ 一起在其他地方工作。所以我发布这个是希望我的配置可能发现了从 DMD 生成的代码中的一个漏洞。

最后，我在失败的系统上打印一些关于编译器版本的默认值

```
dummy@lappis:~$ gcc --version
gcc-4.7.real (Ubuntu/Linaro 4.7.2-5ubuntu1) 4.7.2

dummy@lappis:~$ dpkg -S /usr/bin/gcc-4.7
diversion by hardening-wrapper from: /usr/bin/gcc-4.7
diversion by hardening-wrapper to: /usr/bin/gcc-4.7.real
gcc-4.7, hardening-wrapper: /usr/bin/gcc-4.7 
```

在我的工作中（没有额外 PPA 的 Ubuntu 12.10）

```
per@buddha:~$ gcc --version
gcc (Ubuntu/Linaro 4.7.2-2ubuntu1) 4.7.2
    Copyright © 2012 Free Software Foundation, Inc. 
```

根据`gdb rdmd`运行`f.d`它崩溃`gc_init()`：

```
Program received signal SIGSEGV, Segmentation fault.
0x0000000000417fec in gc_init ()
(gdb) where
#0  0x0000000000417fec in gc_init ()
#1  0x0000000000416a22 in rt.dmain2._d_run_main() ()
#2  0x0000000000416546 in rt.dmain2._d_run_main() ()
#3  0x00000000004164fd in _d_run_main ()
#4  0x000000000041633b in main ()` 
```

我终于尝试从源代码构建 dmd 但具有相同的段错误结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T01:58:19.903

这听起来像是我之前在 Gentoo 上使用 Hardened GCC 时遇到的问题。

这是错误跟踪器： [http ://d.puremagic.com/issues/show_bug.cgi?id=5278](http://d.puremagic.com/issues/show_bug.cgi?id=5278)

您可以通过使用[此补丁](https://github.com/D-Programming-Language/dmd/pull/794)重新编译 DMD，然后将“-cflag=-fno-pie”添加到 /linux/bin64/dmd.conf 文件（或与新编译的 dmd 二进制文件相关的任何位置）中的 DFLAGS 来解决此问题.

或者，找到一种使用非硬化 GCC 进行 D 编译的方法。您也许可以将自己的 GCC 副本与 Ubuntu 的包装分开，然后说服 DMD 使用您的副本而不是 Ubuntu 的副本。很抱歉忘记了细节，我已经有一段时间没有和这个人打架了。

# c# - 编辑mp3 id3歌词数据c#

> ID：14308699
> 
> 赞同：3
> 
> 时间：2013-01-13T21:59:44.617
> 
> 标签：c#, mp3, id3

我见过很多编辑艺术家和专辑信息等的解决方案，但是有没有办法编辑 mp3 id3 数据中的歌词？有这方面的软件，但我问是否有办法在 c# 中对此进行编程。假设我的所有音乐文件都有文本文件中的歌词，我如何将它们放入 mp3 文件中？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T22:02:36.647

对此没有内部内置解决方案，您必须使用外部库，例如：

[http://sourceforge.net/projects/csid3lib/](http://sourceforge.net/projects/csid3lib/)

[http://id3.codeplex.com/](http://id3.codeplex.com/)

后者看起来更完整，功能更丰富。

例如，要获取文件的歌词：

```
string[] mp3Files = Directory.GetFiles(_mp3Directory, "*.mp3");

            InfoProvider chartLyricsProvider = new ChartLyricsInfoProvider();
            InfoProvider lyrDbLyricsProvider = new LyrDbInfoProvider();
            foreach (string mp3File in mp3Files)
            {
                Console.Write(Path.GetFileNameWithoutExtension(mp3File));

                Id3Tag tag;
                using (var mp3 = new Mp3File(mp3File))
                    tag = mp3.GetTag(Id3TagFamily.FileStartTag);
                if (tag == null)
                    continue;

                if (!tag.Artists.IsAssigned || !tag.Title.IsAssigned)
                {
                    Console.WriteLine();
                    continue;
                }

                Console.WriteLine(" ({0} - {1})", tag.Artists.Values[0], tag.Title.Value);

                Id3Tag[] lyricsTags = GetLyrics(tag, chartLyricsProvider, lyrDbLyricsProvider);
                if (lyricsTags == null || lyricsTags.Length == 0)
                    continue;

                string outputFilename = string.Format("{0} - {1}.txt", tag.Artists.Values[0], tag.Title.Value);
                string outputFile = Path.Combine(_outputDirectory, outputFilename);
                using (var lyricsWriter = new StreamWriter(outputFile, false))
                    lyricsWriter.Write(lyricsTags[0].Lyrics[0].Lyrics);

                Console.WriteLine("    {0}", outputFilename);
            } 
```

我确信在查看了这两个库的文档之后，您可以找到如何分配歌词。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:01:31.563

一些快速的谷歌搜索揭示了这一点。也许它可能对你有用？

[http://sourceforge.net/projects/id3dotnet/](http://sourceforge.net/projects/id3dotnet/)

# java - 带有 JSP/Servlet 的 NullPointerException

> ID：14308700
> 
> 赞同：0
> 
> 时间：2013-01-13T21:59:50.313
> 
> 标签：java, jsp, tomcat, servlets

我有我的 doGet 为：

```
protected void doGet(HttpServletRequest request, 
        HttpServletResponse response)
        throws IOException, ServletException{

    String resourceIDstr = request.getParameter("ResourceID");
    int resourceID = Integer.valueOf(resourceIDstr);

    Resource resourceToLend  =  ResourceModule.getInstance()
                                .getResourceByID(Integer.valueOf(resourceID));

    request.setAttribute("resourceToLent", resourceToLend);

    request.setAttribute("innerTab", "LendResource.jsp");
    getServletConfig().getServletContext()
                    .getRequestDispatcher("/WEB-INF/jsp/admin/resourcelend.jsp")
                    .forward(request, response);
} 
```

每当我将任何 GET 请求转发到此 servlet 时，它都不会将请求转发到 JSP，而是将异常抛出为：

```
HTTP Status 500 - org.apache.jasper.JasperException: 
java.lang.NullPointerException 
```

奇怪的是这个特定的 JSP 正被其他 servlet 使用而没有任何问题，并且这个特定的 servlet 抛出异常。我正在尝试查找异常的可能原因。

提前致谢。

更新：

```
org.apache.jasper.JasperException: org.apache.jasper.JasperException: java.lang.NullPointerException
org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:549)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:455)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
servlet.TempResourceLendServlet.doGet(TempResourceLendServlet.java:37)
javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

root cause

org.apache.jasper.JasperException: java.lang.NullPointerException
org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:549)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:470)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:954)
org.apache.jsp.WEB_002dINF.jsp.admin.resourcelend_jsp._jspService(resourcelend_jsp.java:114)
org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
servlet.TempResourceLendServlet.doGet(TempResourceLendServlet.java:37)
javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

root cause

java.lang.NullPointerException
org.apache.jsp.WEB_002dINF.jsp.admin.LendResource_jsp._jspService(LendResource_jsp.java:84)
org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:954)
org.apache.jsp.WEB_002dINF.jsp.admin.resourcelend_jsp._jspService(resourcelend_jsp.java:114)
org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
servlet.TempResourceLendServlet.doGet(TempResourceLendServlet.java:37)
javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T22:44:13.740

正如 asgoth 所说，您应该在问题中提供您的 jsp，而不是 servlet。

此外，您的根本原因堆栈跟踪包含一行说

```
org.apache.jsp.WEB_002dINF.jsp.admin.resourcelend_jsp._jspService(resourcelend_jsp.java:114) 
```

这是指你的jsp变成的自动创建的servlet。你会在 tomcat 的工作文件夹中找到它——因为它是自动生成的 java 代码，你必须做一些映射工作，但它应该或多或少地自我解释你的 jsp 中第 114 行所指的内容。有了这个，你可以找出自己的根本原因。（上次我看到这些文件时，他们有一些引用等效 jsp 代码的注释）

# java - 将应用程序事件从 C++ 公开到 Java

> ID：14308701
> 
> 赞同：1
> 
> 时间：2013-01-13T22:00:02.240
> 
> 标签：java, c++, ipc

我有一个用 c++ 编写的二进制应用程序，可以实现一些数据的复制和分析。我可以输出剩下多少分析，即某种进展。

现在我希望有一个 Web 界面来允许我通过网络运行此服务并监控其进度。我想用 Java 编写 Web 应用程序界面。有没有办法在两种类型的应用程序之间进行通信，即能够从 Java 应用程序监控 c++ 应用程序的进度。

[命名管道](http://www.cs.fredonia.edu/zubairi/s2k2/csit431/more_pipes.html)可以实现这样的事情吗？此外，该解决方案将是跨平台的吗？或者这显然是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T23:04:56.663

当您使用[Process](http://docs.oracle.com/javase/7/docs/api/java/lang/Process.html)对象（通过使用[ProcessBuilder](http://docs.oracle.com/javase/7/docs/api/java/lang/ProcessBuilder.html)或快速而肮脏的方法[Runtime.exec()](http://docs.oracle.com/javase/7/docs/api/java/lang/Runtime.html#exec%28java.lang.String%5B%5D,%20java.lang.String%5B%5D,%20java.io.File%29)）从 Java 启动 C++ 二进制文件时，您可以使用[process.getInputStream()](http://docs.oracle.com/javase/7/docs/api/java/lang/Process.html#getInputStream%28%29)来读取 C++ 二进制文件的文本输出。

# asp.net-mvc - MVC4 多对多动态模型绑定

> ID：14308705
> 
> 赞同：1
> 
> 时间：2013-01-13T22:00:24.647
> 
> 标签：asp.net-mvc, asp.net-mvc-4, many-to-many, model-binding

好的。我不确定如何正确解释这一点，并且这个问题的标题可能是错误的。`Reference`我在和之间有多对多的关系`Category`：

```
public class Reference
{
    public int Id { get; set; }
    public string Headline { get; set; }
    public virtual ICollection<Category> Categories { get; set; }
}
public class Category
{
    public int CategoryId { get; set; }
    public string Name { get; set; }
    public virtual ICollection<Reference> References { get; set; }
} 
```

在创建`Reference`条目时，用户应该能够根据需要添加尽可能多的类别（以包含所有可用类别的下拉列表的形式）。到目前为止，这是我为模型绑定器的视图提出的所有内容，无需控制器中的任何逻辑来创建相关数据：

```
<div class='meta-container meta-cat'>
    <div class="meta-sub">
          <div class="editor-label">Name</div>
          <select name="Categories[0].Name" value="">
             @{
               var db = new DbContext();
               var categories = db.Categories.ToList();
               foreach (var c in categories)
               {
                    <option value="@c.CategoryId">@c.Name</option>
               }
              }

          </select>
     </div>
</div>
     <div class="additonalContainersCats"></div>
     <input type="submit" value="Add another category" id="AddCat" />

    <script>
            $('#AddCat').click(function () {
                var propNumber = 0;
                var dropdown = $(this).parent().find('select').first();
                var options = "";
                $(dropdown, "option").each(function() {
                    options += $(this).html();
                });
                $('.meta-cat').each(function () {
                    propNumber++;
                });
                var html = "<div class='meta-container meta-cat'>" +
                                "<div class='meta-sub'>" +
                                    "<div class='editor-label'>Name</div>" +
                                    "<select name='Categories[" + propNumber + "].Name' value=''>" +
                                     options +
                                    "</select>" +
                                "</div>" +
                                "</div>" +
                            "</div>";
                $('.additonalContainersCats').append(html);
                return false;
            });
    </script> 
```

因此，每次用户单击添加新类别按钮时，都会创建一个新的下拉列表`name="Category[int].Name"`。这适用于一对多（一个类别供参考）关系和文本框，而不是下拉列表。这不是很漂亮的 MVC（它的 webform'ish）:)

你会怎么做？

更新 - 提交数据时忘记提及结果。新类别已创建。如果我选择 2 个类别作为参考，则会使用原始类别的`Name`属性创建两个新类别。`CategoryId`在参考和新类别之间创建关系。时髦的哈:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T07:52:57.210

看起来默认 ModelBinder 并不真正知道如何将您的类别映射到数据库中的现有类别。这是您可能要考虑实现 AutoMapper (https://github.com/AutoMapper/AutoMapper/wiki/Getting-started) 或您自己的结构以将您的新参考映射到现有类别列表的地方 - 您只需要遍历您已经发送的 CategoryID 集合，从数据库中检索它们并覆盖您的 Reference.Categories。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:50:01.997

其实很简单。只需要给下拉列表 name="Category[int].CategoryId" insted of .Name。然后我手动循环遍历属性并绑定它。手动绑定时未创建新类别。

# android - 在谷歌地图中提取地点

> ID：14308709
> 
> 赞同：0
> 
> 时间：2013-01-13T22:00:54.447
> 
> 标签：android, google-maps

我有一个有趣的问题：我想使用谷歌地图制作一个 android 应用程序，但我不知道是否可以提取从 A 点到 B 点的所有地点（城市、城镇、村庄），以及如何提取？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T00:40:54.323

首先，在查找路线的过程中，您需要自己实现“路线查找”，因为 Android 的默认 Google Maps API 不提供此功能。

可以通过查询谷歌地图在线服务并解析返回的 KML/JSON 文件来完成。看到这两个问题：

*   [J2ME/Android/BlackBerry - 行车路线，两个地点之间的路线](https://stackoverflow.com/questions/2023669/j2me-android-blackberry-driving-directions-route-between-two-locations/2023685#2023685)（KML 的旧方式，现已**损坏**）
*   [为什么使用 KML 数据检索适用于 Android 的 Google 路线不再有效？](https://stackoverflow.com/questions/11745314/why-retrieving-google-directions-for-android-using-kml-data-is-not-working-anymo/11745316#11745316)（从 2012 年 7 月开始迁移到 JSON）

完成这项工作后，您的路线将成为地图上的一堆“航路点”。然后，每隔 X 米/英里取一个航路点并检查附近的地点。使用[Google Places API](https://developers.google.com/places/)来做到这一点。

# ruby - `require': 不能加载这样的文件

> ID：14308719
> 
> 赞同：-1
> 
> 时间：2013-01-13T22:01:45.460
> 
> 标签：ruby, rvm, require

所以我意识到这是一个过度提问的问题，但我似乎无法找出答案。我已经参考了这些问题和答案：

[ruby - 需要 & 无法加载此类文件](https://stackoverflow.com/questions/9454742/ruby-require-cannot-load-such-file) [为什么 Ruby 1.9.2 删除“。” 来自 LOAD_PATH，还有什么替代方法？](https://stackoverflow.com/questions/2900370/why-does-ruby-1-9-2-remove-from-load-path-and-whats-the-alternative)

基本上我正在编写一个gem，当我尝试在主模块中使用一个类来要求另一个文件时，它会抛出这个错误“require”：无法加载这样的文件当我给出完整的路径和文件扩展名时它可以工作。我读过你应该使用 require './dir/filename' 。这也不起作用。

应该注意的是，我安装了单用户 rvm 并`which ruby`产生了`/Users/davidhahn/.rvm/rubies/ruby-1.9.3-p286/bin/ruby`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:04:30.387

在 1.9 中，我建议对库中的文件使用 require_relative，因为它始终使用当前文件的相对路径，而不是加载路径。在 < 1.9 中，您必须确保您的根目录（通常`lib`在 gems 中）在加载路径中，并且不同的库不会更改您的顺序。

# javascript - JavaScript 文本验证不适用于正则表达式

> ID：14308732
> 
> 赞同：0
> 
> 时间：2013-01-13T22:03:06.807
> 
> 标签：javascript, html, regex, validation, alphabet

我正在尝试通过 JavaScript 验证 HTML 文档中的名字和姓氏字段。验证必须提示用户是否插入了有效的姓名/姓氏，这意味着输入框中不应出现数字或奇怪的字符。

我一直在寻找 stackoverflow 和其他类似网站的解决方案，但不幸的是我没有找到我正在寻找的确切解决方案，所以我希望这个网站周围的人可以提供帮助。

这是我的 HTML 代码：

```
<form name="contact" method="post" action="contact.php">
                <table width="200" border="0" align="center">
                  <tr>
                    <td><p class="pagetext">Name:</p></td>
                    <td><input type="text" name="fname" id="fname" size="30"/></td>
                  </tr>
                  <tr>
                    <td><p class="pagetext">Surname:</p></td>
                    <td><input type="text" name="sname" id="sname" size="30"/></td>
                  </tr>
                  <tr>
                    <td><p class="pagetext">Email:</p></td>
                    <td><input type="text" name="email" id="email" size="30"/></td>
                  </tr>
                  <tr>
                    <td><input class="btns" type="submit" onclick="validationMain();validationContact();validationErrors();" value="Submit"/></td>
                    <td><input class="btns" type="submit" onclick="validationReset()" value="Reset"/></td>
                  </tr>
                </table>
</form> 
```

这是 JavaScript 代码（省略了不相关的部分，以免混淆问题）：

```
var errors = "";
var textOnly = /^[A-Za-z]+$/;

function validationMain(){

var firstname = document.getElementById('fname');
var surname = document.getElementById('sname');
var email = document.getElementById('email');
//emailRegEx expression from www.regular-expressions.info/email.html
var emailRegEx = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i; 

if (firstname.value == "") {

    errors += "First Name Cannot Be Left Empty\r\n";
} else {

    if (firstname.value != textOnly.value){

        errors += "First Name is Invalid\r\n";
    }
}

if (surname.value == "") {

    errors += "Surname Cannot Be Left Empty\r\n";
} else {

    if (surname.value != textOnly.value){

        errors += "Surname is Invalid\r\n";

    }
}   

if (email.value != ""){
    if (email.value.search(emailRegEx) == -1){

        errors += "Invalid Email Entered\r\n";
    }
} else {

        errors += "Email Cannot Be Left Empty\r\n";

       }            
} 
```

主要问题是我在文本字段中输入的任何名称或姓氏（即使它们是没有数字和特殊字符的正确名称）它会提示它们无效（不应该是这种情况）所以我猜那里我的 if 条件有问题。

提前感谢您的时间、帮助和提供的任何相关信息:)

我希望我提供了足够的信息，如果没有，请告诉我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:08:32.530

你没有正确使用你的表达方式。

```
textOnly.test(firstname.value); 
```

`test`检查表达式是否匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:10:56.807

以下行将文本字段中的值与正则表达式的属性值进行比较。

```
if (firstname.value != textOnly.value){ 
```

您需要使用正则表达式测试该值以查看它是否有效。

# android - ICS 的 Android 视图/画布 drawCircle 问题

> ID：14308734
> 
> 赞同：0
> 
> 时间：2013-01-13T22:03:31.783
> 
> 标签：android, view, draw, android-4.0-ice-cream-sandwich, hardware-acceleration

我有一个在 HoneyComb 上运行良好但在 ICS 上运行不正常的 Android 应用程序。我有谷歌地图，最重要的是，我正在使用圆圈创建雷达效果（圆圈的半径不断增加，给出一种水波效果。）代码如下：

```
class ShowRadar extends AsyncTask<Void, Void, RadarView>
        {

            private Context ctx;
            private int radius;
            private GeoPoint gp;
            private MapView mv;
            ShowRadar(Context ctxt, MapView mv, int radius, GeoPoint gp)
            {
                this.ctx = ctxt;
                this.radius = radius;
                this.gp = gp;
                this.mv = mv;
            }

            @Override
            protected RadarView doInBackground(Void... params) 
            {
                RadarView rdView = new RadarView(ctx, mv, gp, radius);
                LayoutParams lp = new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
                rdView.setLayoutParams(lp);

                return rdView;
            }

            @Override
            protected void onPostExecute(RadarView result) {
                if(this.radius <= 10000)
                {
                    if(this.radius < 50)
                    {
                        this.radius += 50;
                    }
                    else if(this.radius < 100)
                    {
                        this.radius += 100;
                    }
                    else if(this.radius < 500)
                    {
                        this.radius += 500;
                    }
                    else
                    {
                        this.radius += 1000;
                    }
                }
                else
                    this.radius = 10;

                if(radarUpdated || radarCount > 1000)
                {
                    if(radarCount > 1000 && !radarUpdated)
                    {
                        Toast.makeText(mContext, "Delay in response, wait a while", Toast.LENGTH_SHORT).show();
                    }
                    radarCount = 0;
                    if (oldrd != null) {
                        rel.removeView(oldrd);
                        oldrd = null;
                    }

                }
                else
                {
                    radarCount++;

                    if(oldrd != null)
                    {
                        rel.removeView(oldrd);
                    }
                    oldrd = result;
                    rel.addView(result);

                    new ShowRadar(ctx, mv, this.radius, gp).execute();

                }
            }
        }
        new ShowRadar(mContext, mapView, 10, center).execute(); 
```

下面是雷达视图的代码

```
 public class RadarView extends View {

private int circleRadius = 500;
private GeoPoint p;
public RadarView(Context context) {
 super(context);
 init();
}

public RadarView(Context context, MapView mv, GeoPoint pt, Integer radius)
{
    super(context);
    this.mapView = mv;
    this.p = pt;
    this.circleRadius = radius;
    init();
}

private void init(){
 paint = new Paint();
 paint.setColor(Color.GREEN);
 paint.setStrokeWidth(10);
 paint.setStyle(Paint.Style.STROKE);

}

@Override
protected void onDraw(Canvas canvas) {
 Projection projection = mapView.getProjection();
 Point pt = new Point();
 projection.toPixels(p, pt);

 float circleRadius = metersToRadius(this.circleRadius, mapView, (double)p.getLatitudeE6()/1E6);
 Paint circlePaint = new Paint(Paint.ANTI_ALIAS_FLAG);
 circlePaint.setARGB(150, 12, 232, 91);
 circlePaint.setStyle(Style.STROKE);
 circlePaint.setStrokeWidth(10);
 if(canvas.isHardwareAccelerated())
 {
     mapView.setLayerType(View.LAYER_TYPE_SOFTWARE, null);
 }
 canvas.drawCircle((float)pt.x, (float)pt.y, circleRadius, circlePaint);

 super.onDraw(canvas);
}

 public static int metersToRadius(float meters, MapView map, double latitude) {
        return (int) (map.getProjection().metersToEquatorPixels(meters) * (1/ FloatMath.cos((float) Math.toRadians(latitude))));         
    } 
```

}

我浏览了各种论坛，发现默认情况下 ICS 会激活 HardwareAcceleration，所以我在清单中添加了以下标签但没有帮助。任何人都可以建议我这里出了什么问题。

```
 <application
    android:hardwareAccelerated="false"
    ....
</application> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T12:00:25.963

我可以通过在 android 清单文件中将 android:targetVersion 更改为 10 来解决这个问题。它不能使用 API>=11 的原因是 AsyncTask 方法的行为发生了变化。看看在[ICS 上几分钟内没有调用 Android AsyncTask](https://stackoverflow.com/questions/11000680/android-asynctask-not-being-called-for-minutes-on-ics)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T13:31:55.883

Api Level 10 以上的 AsycTask 改变了执行机制，当你提到 targetSdk :10 时，apk 会为 API 级别 10 编译，因此 dalvik 机器将其视为。如果你想要更快的响应，你可以使用 API 中的以下过程等级 >10

[http://developer.android.com/reference/android/os/AsyncTask.html#executeOnExecutor(java.util.concurrent.Executor,Params...)](http://developer.android.com/reference/android/os/AsyncTask.html#executeOnExecutor(java.util.concurrent.Executor,Params...))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-08T12:39:28.583

我对 targetSDKVersion 13 或更低版本有同样的问题。圆圈没有出现。

为视图禁用硬件加速的解决方案。显然，drawCircle 函数不适用于 pre ICS 上的 accel。我将以下行添加到我的视图的 init 函数中：

```
setLayerType(View.LAYER_TYPE_SOFTWARE,null); 
```

# php - 将自定义 woocommerce 字段复制到默认字段中

> ID：14308739
> 
> 赞同：1
> 
> 时间：2013-01-13T22:04:13.177
> 
> 标签：php, wordpress, woocommerce

我编写了一个 woocommerce 插件，它创建了以下自定义结帐字段：

```
billing_street_name
billing_house_number
billing_house_number_suffix

shipping_street_name
shipping_house_number
shipping_house_number_suffix 
```

我还将它添加到管理页面，但由于我无法连接到 get_formatted_billing_address 和 get_formatted_shipping_address（它们都用于显示 writepanel-order_data.php 和 shop_order.php 中的地址）我想将它们复制到默认的 billing_address_1 和 shipping_address_1像这样：

billing_address_1 = billing_street_name + billing_house_number + billing_house_number_suffix

我尝试使用以下（基本）代码来做到这一点：

```
add_action( 'woocommerce_process_checkout_field_billing_address_1', array( &$this, 'combine_street_number_suffix' ) );

public function combine_street_number_suffix () {
$key = $_POST['billing_street_name'] . ' ' . $_POST['billing_house_number'];

return $key;
} 
```

但这不起作用 - 我认为 $_POST 变量根本没有通过？

这是在 class-wc-checkout.php 中创建钩子的方式：

```
// Hook to allow modification of value
$this->posted[ $key ] = apply_filters( 'woocommerce_process_checkout_field_' . $key, $this->posted[$key] ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T12:56:23.053

使用 'woocommerce_checkout_update_order_meta' 钩子修复了这个问题：

```
add_action('woocommerce_checkout_update_order_meta', array( &$this, 'combine_street_number_suffix' ) );

public function combine_street_number_suffix ( $order_id ) {
    // check for suffix
    if ( $_POST['billing_house_number_suffix'] ){
        $billing_house_number = $_POST['billing_house_number'] . '-' . $_POST['billing_house_number_suffix'];
    } else {
        $billing_house_number = $_POST['billing_house_number'];
    }

    // concatenate street & house number & copy to 'billing_address_1'
    $billing_address_1 = $_POST['billing_street_name'] . ' ' . $billing_house_number;
    update_post_meta( $order_id,  '_billing_address_1', $billing_address_1 );

    // check if 'ship to billing address' is checked
    if ( $_POST['shiptobilling'] ) {
        // use billing address
        update_post_meta( $order_id,  '_shipping_address_1', $billing_address_1 );
    } else {
        if ( $_POST['shipping_house_number_suffix'] ){
            $shipping_house_number = $_POST['shipping_house_number'] . '-' . $_POST['shipping_house_number_suffix'];
        } else {
            $shipping_house_number = $_POST['shipping_house_number'];
        }

        // concatenate street & house number & copy to 'shipping_address_1'
        $shipping_address_1 = $_POST['shipping_street_name'] . ' ' . $shipping_house_number;
        update_post_meta( $order_id,  '_shipping_address_1', $shipping_address_1 );         
    }

    return;
} 
```

我不认为这段代码非常优雅（特别是后缀检查部分），所以如果有人有改进它的提示 - 非常欢迎！

# java - 如何在 Java 中将浮点数转换为 4 个字节？

> ID：14308746
> 
> 赞同：12
> 
> 时间：2013-01-13T22:04:58.613
> 
> 标签：java, byte, converter

我无法转换这样的东西：

```
byte[] b = new byte[] { 12, 24, 19, 17}; 
```

变成这样的东西：

```
float myfloatvalue = ?; 
```

有人可以给我一个例子吗？

另外如何将浮点数转回字节？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-01-13T22:08:32.780

# `byte[]`->`float`

与[`ByteBuffer`](http://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html#getFloat())：

```
byte[] b = new byte[]{12, 24, 19, 17};
float f =  ByteBuffer.wrap(b).getFloat(); 
```

# `float`->`byte[]`

逆运算（知道上面的结果）：

```
float f =  1.1715392E-31f;
byte[] b = ByteBuffer.allocate(4).putFloat(f).array();  //[12, 24, 19, 17] 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-01-13T22:08:39.157

从`byte[]`-> `float`，你可以这样做：

```
byte[] b = new byte[] { 12, 24, 19, 17};
float myfloatvalue = ByteBuffer.wrap(b).getFloat(); 
```

这是使用`ByteBuffer.allocate`for conversion `float`->的替代方法`byte[]`：

```
int bits = Float.floatToIntBits(myFloat);
byte[] bytes = new byte[4];
bytes[0] = (byte)(bits & 0xff);
bytes[1] = (byte)((bits >> 8) & 0xff);
bytes[2] = (byte)((bits >> 16) & 0xff);
bytes[3] = (byte)((bits >> 24) & 0xff); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-13T22:07:37.113

将字节转换为 int 并使用 Float.intBitsToFloat()

[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Float.html#intBitsToFloat(int](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Float.html#intBitsToFloat(int) )

# javascript - 如何使用 javascript 或 html 为我的站点跨浏览器友好地制作文本轮播？

> ID：14308748
> 
> 赞同：0
> 
> 时间：2013-01-13T22:05:22.627
> 
> 标签：javascript, internet-explorer, firefox, browser, carousel

如何使用 Javascript 或 html 为我的站点创建跨浏览器友好的文本轮播？我一直在努力使用下面的代码，因为它只适用于 Firefox，但它在 IE 上失败。有没有办法让它在两者上都起作用？

```
<h4>Carousel-Text-Below </h4>

<html>
<head>
<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js'    
type='text/javascript'></script>
<script type='text/javascript'>
$(document).ready(function(){
function setRandomWord(){
    var phrases =new Array("1-Blah Text","2-Blah Text","3-Blah Text");  
    $("#test").text(phrases[Math.floor(Math.random()*phrases.length)]);
}
setInterval(setRandomWord,3000);
});
</script>
</head>
<body> 
<p style="border:1px dashed gray; background-color:white; padding: 10px">
<span id='test'>Blah Text-Text-Text</p>
</span> Guaranteed Service or...Text---Text</strong></p> 
</body> 
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:11:36.577

我认为这是因为您没有设置文档类型。在这里尝试过，它可以`<!DOCTYPE html>`在`<html>`标签前面使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:20:58.573

也许 IE 对您的无效 HTML 感到困惑？请注意，您在关闭它`<p>`之前关闭`<span>`它。然后你也有无与伦比的`</strong>`和`</p>`在最后。我相信你的意思是：

```
<p style="border:1px dashed gray; background-color:white; padding: 10px">
    <span id='test'>Blah Text-Text-Text</span>
    <strong>Guaranteed Service or...Text---Text</strong>
</p> 
```

[http://jsfiddle.net/xrS3t/](http://jsfiddle.net/xrS3t/)

或者可能

```
<p style="border:1px dashed gray; background-color:white; padding: 10px">
    <span id='test'>Blah Text-Text-Text</span>
</p>
<p>
    <strong>Guaranteed Service or...Text---Text</strong>
</p> 
```

[http://jsfiddle.net/6nFVK/](http://jsfiddle.net/6nFVK/)

我现在没有IE来测试，你可以试试上面的jsfiddle链接吗？

# mysql - 如何使用条件将数据从一个表插入到另一个表

> ID：14308750
> 
> 赞同：2
> 
> 时间：2013-01-13T22:05:44.040
> 
> 标签：mysql, sql, insert

我正在尝试将新行插入`table a`并*部分*加载带有来自`table b`. 我只想在列`b.id`中不存在该字段的地方插入新行`a.id`。

**这是我的表：**

```
table_a       table_b
---------     -----------
id             id
first_name     first_name
country        middle_name
last_name      last_name 
```

**这是我的代码：**

```
INSERT INTO table_a a
SELECT b.id, b.first_name,b. last_name
FROM table_b b WHERE b.id <> a.id 
```

**问题：**如何使用插入选择语句来做到这一点？请注意，我在一张表中包含中间名，在另一张表中包含国家/地区，以使其与我目前的情况更具可比性。有没有办法“映射”这些字段？或者我必须确保我的插入选择语句具有与目标表完全相同数量的要插入的值？还是它只会查找匹配的列名并只更新那些匹配的列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T04:40:00.570

> 我只想在 a.id 列**中不存在字段 b.id 的情况下插入新行。**

另一种解决方案是使用`LEFT JOIN`和`IS NULL`

```
INSERT INTO table_a
SELECT  b.*
FROM    table_b b
        LEFT JOIN table_a a
            ON a.ID = b.ID
WHERE   a.ID IS NULL 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/792d4/2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T22:09:25.993

您可以执行以下操作，检查 id 是否存在于 table_a

```
INSERT INTO table_a (id, first_name, last_name)
SELECT b.id, b.first_name,b.last_name
FROM table_b b
WHERE not exists (SELECT 1 FROM table_a a WHERE b.id = a.id) 
```

对于所有行，您的国家/地区列将为空。如果要存储静态值，则查询应该是

```
INSERT INTO table_a (id, first_name, country, last_name)
SELECT b.id, b.first_name, 'USA', b.last_name
FROM table_b b
WHERE not exists (SELECT 1 FROM table_a a WHERE b.id = a.id) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-13T22:15:54.913

试试这个

```
 INSERT INTO table_a a (id , first_name , last_name) Values (
                SELECT b.id, b.first_name,b.last_name
                FROM table_b b WHERE  a.id not in (select id from table_b) ) 
```

# android - 谷歌播放信息

> ID：14308753
> 
> 赞同：0
> 
> 时间：2013-01-13T22:06:10.820
> 
> 标签：android, google-play

我想知道是否可以从 Google Play 获取有关安装我的应用程序的用户的任何信息。我知道我可以获得有关下载和所有内容的统计信息，但我需要更具体的信息。我正在为我的应用程序开发安全层，它将检查正在运行的应用程序的手机并将其与从 Google Play 安装的手机进行比较。如果不是同一部手机，则将其复制或破解并安装到另一部手机上。

我知道我可以从手机中获取很多信息（[是否有唯一的 Android 设备 ID？](https://stackoverflow.com/questions/2785485/is-there-a-unique-android-device-id)），但是从 Google play 中如何比较这些信息。

这可能吗？要获得足够的信息以 100% 确定，这部手机是安装了应用程序的手机吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:08:42.260

Android Licensing 库可能适合您的需求。它有一个灵活的许可政策，让您可以决定应该发生什么，例如，如果它发现用户实际上并没有购买您的应用程序。

你可以在这里阅读更多关于它的信息：http: [//developer.android.com/google/play/licensing/index.html](http://developer.android.com/google/play/licensing/index.html)

# c++ - 规则属性的兼容性

> ID：14308760
> 
> 赞同：1
> 
> 时间：2013-01-13T22:07:01.917
> 
> 标签：c++, boost-spirit, boost-spirit-qi

我正在尝试编写一个解析器，它读取带有变量声明和实例化的文本文件，并构造一个变量表，其中包含所有声明的变量及其相关值。

该文件如下所示：

```
 int a = 18, b = 1+a*5;
 float test = rand(a); 
```

为此，我想使用 boost::spirit::qi 解析器库，它提供了一个动态符号表解析器，可以将符号与可变数据类型 T 相关联。提供的符号表解析器的缺点是，它可以仅将其符号与一种数据类型的值相关联。

我有以下代码：

```
 #include <boost/spirit/include/qi.hpp>
 #include <stdint.h>
 #include <string>
 template<typename VTYPE>
 struct VTable : boost::spirit::qi::symbols<char, VTYPE> {
      VTable() {} // empty
 };

 int main()
 {
      using boost::spirit::qi::rule;
      using boost::spirit::qi::space_type;

      VTable<int64_t> intDecs; VTable<double> floatDecs;
      rule<std::string::iterator, boost::variant<int64_t, double>() ,space_type> decs %= (!floatDecs >> intDecs) | floatDecs;
      return 0;
 } 
```

问题在于 return 语句之前的一行。'%=' 左侧的属性显然与右侧的属性不兼容（因为 Visual Studio 正在抱怨该代码）。

我的问题是，为什么会这样？

当我阅读 Spirit::Qi 的文档时，它对解析器属性说了以下内容：

*   symbol<Char, T> 的
    属性类型为 T。 =>intDecs 的属性类型应为 int64_t()，floatDecs 的属性类型应为 double()
*   解析器的属性类型 !a 未使用。
*   如果解析器 X 的属性类型未使用且解析器 Y 的属性类型为 T，则解析器 (X >> Y) 的
    属性类型为 T。 => (!floatDecs >> intDecs) 的属性类型应为 int64_t()
*   如果解析器 a 的属性类型为 A，解析器 b 的属性类型为 B，则解析器 (a | b) 的属性类型为 boost::variant()
    属性类型 (!floatDecs >> intDecs) | floatDecs) 应该是 boost::variant()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:54:46.657

我找到了一个来源，它提供了一种算法来显示精神解析器来源的属性：“http://boost-spirit.com/home/2010/01/31/what-is-the-attribute-type-exposed- by-a-parser/"

经过一些修改，我发现属性

*   (!floatDecs >> intDecs) 是 __int64 （我认为这并不奇怪！）
*   floatDecs 是双倍的（不足为奇）并且
*   (!floatDecs >> intDecs) | floatDecs 是类 boost::variant<_ *int64,double,struct boost::detail::variant::void* ,structboost::detail::variant::void_,struct boost::detail::variant::void_,struct boost ::detail::variant::void_,struct boost::detail::variant::void_,struct boost::detail::variant::void_,struct boost::detail::variant::void_,struct boost:: detail::variant::void_,struct boost::detail::variant::void_,struct boost::detail::variant::void_,struct boost::detail::variant::void_,struct boost::detail: :variant::void_,struct boost::detail::variant::void_,struct boost::detail::variant::void_,struct boost::detail::variant::void_,struct boost::detail::variant ::void_,struct boost::detail::variant::void_,struct boost::detail::variant::void_>

对于那些对算法感兴趣的人：

```
#include <boost/spirit/include/qi.hpp>
#include <stdint.h>
#include <iostream>
#include <string>

template<typename VTYPE>
struct VTable : boost::spirit::qi::symbols<char, VTYPE> {
    VTable() {} // empty
};

template <typename Expr, typename Iterator = std::string::iterator>
struct attribute_of_parser {
    typedef typename boost::spirit::result_of::compile<boost::spirit::qi::domain, Expr>::type parser_expression_type;
    typedef typename boost::spirit::traits::attribute_of<parser_expression_type, boost::spirit::unused_type, Iterator>::type type;
};

template <typename T>
void display_attribute_of_parser(T const&)
{
    typedef typename attribute_of_parser<T>::type attribute_type;
    std::cout << typeid(attribute_type).name() << std::endl;
}

int main()
{
    using boost::spirit::qi::eps;
    using boost::spirit::qi::rule;
    using boost::spirit::qi::space_type;

    VTable<int64_t> intDecs; VTable<double> floatDecs;
    display_attribute_of_parser((!floatDecs >> intDecs));
    display_attribute_of_parser(floatDecs);
    display_attribute_of_parser((!floatDecs >> intDecs) | floatDecs);

    return 0;
} 
```

# javascript - Javascript硬编码变量

> ID：14308762
> 
> 赞同：3
> 
> 时间：2013-01-13T22:07:20.683
> 
> 标签：javascript, variables, hardcoded

我有一个简单的 js 文件：

```
//base.js

...
var url = '/post/' + id + '/comment';
... 
```

我使用的是 Symfony2，所以在服务器端所有的 url 都是由路由器生成的，我在 js 中使用硬编码的 url 让我很烦恼。

有没有办法让它们更有活力？
这些是我想过但我不满意的解决**方案**：

*   在 HTML 标签中定义它们，例如`<div data-url="<?php path('post_comment'); ?>">`
*   在内联脚本标签中定义它们`<script language="text/javascript">...</script>`

我认为一些大网站（SO，GitHub等）的js文件中的url是硬编码的，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T00:13:43.167

[Symfony JS Routing Bundle 之友](https://github.com/FriendsOfSymfony/FOSJsRoutingBundle)完全符合您的需求

```
var url = Routing.generate('some_route_to_expose', { foo: 'bar' });
// url is http://somehost.com/app_dev.php/my_route 
```

该捆绑包还允许您转储、编译和缩小生成的 javascript。这很棒！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T00:10:18.750

您至少应该通过在配置对象中定义所有常量变量并使用属性名称或 getter 函数访问它来最小化命名空间污染。

# javascript - 使用 html5 任意多张照片的照片幻灯片

> ID：14308763
> 
> 赞同：0
> 
> 时间：2013-01-13T22:07:22.440
> 
> 标签：javascript, html

我开始从头开始构建我的新（照片）主页，以便更好地控制并希望让我更容易更新它。可以帮助我轻松更新主页的一件事是，如果主页可以索引应该显示的照片，而不是我索引图片并在代码中添加新图片，代码可以有一个自己的更新向量文件夹更新为新图片后。如果我有一个幻灯片，点击时会发生变化，我现在有这个代码：

```
<section id="main_section">
    <canvas id="myCanvas" width="1280" height="960"></canvas>
<script>
  var canvas = document.getElementById('myCanvas');
  var context = canvas.getContext('2d');
  var imageObj = new Image();

  imageObj.onload = function() {
    context.drawImage(imageObj, 0, 0);
  };
  imageObj.src = 'landscape1.jpg';
  canvas.addEventListener('click', function() {imageObj.src = 'landscape2.jpg'; }, false);
</script> 
```

我希望更改最后一个功能，以便在每次单击时它都会更改为矢量中的下一张图片。IE

```
canvas.addEventListener('click', function() {x=x+1; imageObj.src = vector(x); }, false); 
```

其中向量保存图片文件的名称。假设我在与 html 文件相同的文件夹中有 y 个以“风景”开头的图片，我该如何创建这个矢量？我希望问题很清楚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T07:49:53.760

我认为这段代码可以提供帮助：

1.  使用数组

> ```
> <canvas id="myCanvas" width="1280" height="960"></canvas>
>     <script>
>       var canvas = document.getElementById('myCanvas');
>       var context = canvas.getContext('2d');
>       var imageObj = new Image();
>       var vector = new Array('landscape1.jpg','landspcape2.jpg','landscape3.jpg');//to y
>       var x=1;
>       imageObj.onload = function() {
>            context.fillStyle = "#ffffff";
>             context.fillRect(0,0,1280,960);
>            context.drawImage(imageObj, 0, 0);
>       };
>       imageObj.src = vector[0];
>       canvas.addEventListener('click', function() {
>      if(++x>vector.length)x=1;
>      imageObj.src = vector[x]; }, false);
>     </script> 
> ```

2 或者只使用名称而不是数组

```
 <canvas id="myCanvas" width="1280" height="960"></canvas>
      <script>
                      var canvas = document.getElementById('myCanvas');
                      var context = canvas.getContext('2d');
                      var imageObj = new Image();
                      var x=1;

                      imageObj.onload = function() {
                           context.fillStyle = "#ffffff";
                            context.fillRect(0,0,1280,960);
                           context.drawImage(imageObj, 0, 0);
                      };
                      imageObj.src = 'landscape1.jpg'
                      canvas.addEventListener('click', function() {
                     imageObj.src = 'landscape' + (++x) + '.jpg' }, false);
</script> 
```

# hibernate - 为什么需要传统的 Hibernate？

> ID：14308764
> 
> 赞同：2
> 
> 时间：2013-01-13T22:07:32.843
> 
> 标签：hibernate, jpa, orm

据我所知，Hibernate 有两种类型的实现

1.  JPA的实现（二）（@Entity,@Table注解）
2.  对旧（常规）休眠（没有 JPA）的扩展，使用 HSQL 查询，没有注释

如果是真的，为什么我们需要第二种类型的实现，而 JPA 是 ORM 规范？如果您可以在比较它们的同时提供 API 版本，那么我了解 ORM 的整个评估历史会更好吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:21:22.743

在 JPA 规范之前，Hibernate 是最早的 ORM 工具之一。它也是 Java 5 之前的开发者（当注释在 Java 中可用时），所以一切都曾经是基于 XML 配置或 XDoclet。

对 Java EE 进行了重大改进，它大量借鉴了 Spring 和 Hibernate，引入了 JPA，但也足够“通用”，您可以插入自己的实现。

hibernate 的工作方式没有真正的区别，只是你使用什么机制来配置它。JPA 注释现在是标准，但您仍然可以仅在需要时使用 XML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:19:21.230

没有**两种不同**的 Hibernate 实现——只有一种官方实现。您可以通过注解/JPA 功能使用 Hibernate，也可以通过显式 Hibernate 类使用 Hibernate；但是底层的 Hibernate 库将是相同的。

JPA 只是 Hibernate（和其他类似库）实现的接口。

历史告诉我们，早在九十年代后期，就有人发明了 EJB。Java 社区的共识是没有人喜欢它，许多人只是使用 Hibernate 或类似的框架。直到 EJB 3.0，EJB 的持久性几乎根据 Hibernate 的工作方式进行建模（注意 EJB 中还有其他类型的 bean，不仅是数据映射）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-14T09:51:18.747

据我所知，Hibernate 中的注释是从 3.2 版左右开始引入的；而且我不是在谈论 JPA 注释（javax.persistence 包），而是可以在 hibernate-annotations 包中找到的特定于休眠的注释。

几乎所有你可以用特定于休眠的注解做的事情，现在你也可以用 JPA2 做。

如前所述，JPA 只是一个接口，当您对该接口进行编码时，您（至少在理论上）将底层 ORM 提供程序替换为另一个提供程序会更容易，例如 TopLink、OpenJPA 或 Eclipselink（如果您需要）

# python - 替换字符串的单个字符元素

> ID：14308766
> 
> 赞同：2
> 
> 时间：2013-01-13T22:07:41.360
> 
> 标签：python, string

我需要有关如何从用户输入中识别字符的帮助？以及如何用我自己的特定字符替换。

**任务：**

1.  该程序提示用户输入 DNA 序列（A、T、C、G）并显示该 DNA 序列的反向互补序列

2.  程序应该只接受 DNA 碱基 (A,T,C,G) 大写字母，**如果不接受**，则将字符转换为 'x'

我的问题是在程序的第二步，如何用“x”字符替换非大写字母（A、C、G、T）

```
seq= input('Enter a DNA sequence ')

seqcom = {'A':'T','C':'G','T':'A','G':'C'} # dictionary 

letters = list(seq)
letters.reverse ()
dna =''

for base in letters:
    dna += seqcom[base]

print('The reverse complement of \n', seq, '\n', 'is\n', dna) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T22:12:12.893

你要：[`dict.get(key[, default])`](http://docs.python.org/library/stdtypes.html#dict.get)

```
for base in letters:
    dna += seqcom.get(base, 'x') 
```

# iphone - 将视频上传到 YouTube

> ID：14308769
> 
> 赞同：0
> 
> 时间：2013-01-13T22:08:09.750
> 
> 标签：iphone, ios, objective-c, youtube

我想将视频从我的应用上传到 YouTube。

我知道我需要为此使用 GData，并为此找到了一些教程，但问题是我没有找到任何新的文档。

知道这个类是否也适用于 iOS 6？如果有任何新的 API 可以从我的 iPhone 应用程序将视频上​​传到 YouTube。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T03:17:51.263

首先从以下链接下载 GData 示例项目：

`https://github.com/nparry/gdata-objectivec-client/tree/master/Source` 然后尝试搜索有关如何通过GData身份验证发送视频。然后添加此示例

在应用程序中使用以下准则：

```
http://hoishing.wordpress.com/2011/08/23/gdata-objective-c-client-setup-in-xcode-4/ 
```

试试看希望对你有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T04:44:40.193

你为什么不使用这个库[https://github.com/eternalstorms/ESSVideoShare-for-OS-X-Lion/wiki/How-To-for-iOS](https://github.com/eternalstorms/ESSVideoShare-for-OS-X-Lion/wiki/How-To-for-iOS)。它允许您上传到 Youtube、Facebook 和 Vimeo。

# php - 简单的 DOM 和

> ID：14308778
> 
> 赞同：0
> 
> 时间：2013-01-13T22:08:49.657
> 
> 标签：php, dom

我已经尝试了几种不同的方法，但似乎没有任何效果。（我尝试了[如何使用简单 HTML DOM 模仿子选择器的所有示例？](https://stackoverflow.com/questions/6831597/how-to-imitate-child-selector-with-simple-html-dom)）按原样使用代码，更改我需要的内容，即 class=xxx 和 url。

所以我正在尝试从网页中提取一些信息。就 DOM 而言，没有孩子可以使用，并且使用 xpath 方法没有得到任何回报。我猜我做错了什么。

```
<div id="wpp-6" class="widget popular-posts">
    <div class="widget_title">POPULAR</div><!-- Wordpress Popular Posts Plugin v2.3.2         [Widget] [daily] [regular] -->
    <ul>
        <li>
            <a href="http://link.html" title="Title of post" class="wpp-post-title">THE DATA I    WANT</a> <span class="post-stats"></span>
        </li>
        <!-- More lists -->
    </ul>
</div> 
```

之后还有大约 9 个列表语句。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:42:27.363

[使用PHP Simple HTML DOM Parser](http://simplehtmldom.sourceforge.net/manual.htm)你可以很容易地做到这一点，只需[从这里](http://sourceforge.net/projects/simplehtmldom/)`simple_html_dom.php`下载文件并按如下方式使用它。

```
include('simple_html_dom.php');
$html=file_get_html('http://psfk.com');
foreach($html->find('div#wpp-6 ul li a') as $a){
    echo $a->innertext.'<br />';
} 
```

## 输出将是（2013 年 1 月 14 日星期一测试）

> 谷歌流感地图描绘了美国最严重的疫情
> 
> 透明胶带肖像扭曲人脸 [图片]
> 
> 奥威尔十九八十四集中审查主题新设计
> 
> 用裸酒过滤酒制成的伏特加 [视频]
> 
> 三星首次推出柔性屏幕
> 
> 麦当劳在澳大利亚更名
> 
> 三星的透明屏幕是未来的零售窗口 [CES]
> 
> Dita Von Teese 将二维码直接缝到她的衣服上
> 
> Abercrombie & Fitch Boss 让空乘人员在私人飞机上只穿平角裤和凉鞋
> 
> 镜子应用程序向女性展示如果继续饮酒，她们将如何变老

如果你想用`link`like打印标题，`<a>...</a>`那么只需使用`echo $a`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:42:57.723

自从我使用 xpath 已经有一段时间了，所以这是我的解决方案您可以通过这种方式遍历 DOM 树，检查所需元素的 id 和类

```
<?php
    error_reporting(0); //needed because of invalid xml

    $url = "http://www.psfk.com";

    $xml = new DOMDocument("1.0", 'UTF-8'); 
    $str = file_get_contents($url);

    // Load the url's contents into the DOM 
    $xml->loadHTML($str); 

    //Loop through all divs in the dom until we find what we need 
    foreach($xml->getElementsByTagName('div') as $div) {
        if($div->getAttribute('id') == 'wpp-6' && $div->getAttribute('class') == 'widget popular-posts') {
            if($div->parentNode->getAttribute('id') == 'right') {
                foreach($div->getElementsByTagName('li') as $li) {
                    foreach($li->getElementsByTagName('a') as $link) {
                        echo $link->textContent . "<br>";;
                    }
                }
            }
        }

    }

?> 
```

# javascript - d3 JSON 多折线图

> ID：14308779
> 
> 赞同：3
> 
> 时间：2013-01-13T22:08:51.210
> 
> 标签：javascript, json, d3.js

我正在尝试从一个 JSON blob 中绘制一个包含多行的图，如下所示：

```
{"2007": [{"val":10, "mon":10}, {"val":20, "mon":11}, {"val":40, "mon":12}, ...],
 "2008": [{"val":20, "mon":8}, {"val":20, "mon":9}, {"val":40, "mon":10}, ...],
  ...
 "2012": [{"val":40, "mon":8}, {"val":50, "mon":9}, {"val":60, "mon":10}, ...]
} 
```

数据基本上是每年的月度总数，有些年份有几个月没有数据。不过，我不知道如何解析 d3 中的数据。我尝试了各种方法，例如

```
var line = d3.svg.line()
 .interpolate("basis")
.x(function(d) { return x(d.mon); })
.y(function(d) { return y(d.val); });

svg.selectAll(".line")
 .data(series)
 .enter().append("path")
 .attr("class", "line")
 .attr("d", line); 
```

但我似乎无法将数据输入 SVG 行。有什么建议么？有没有更好的方法来构建 JSON？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-14T21:01:14.957

万一其他人遇到此问题，以下是解决方法。诀窍是传递一个函数，该函数在路径元素的“d”属性中返回关联数组中的值。

```
 entries = d3.entries(data);

  var colors = d3.scale.category20()
    .domain(d3.keys(data));

  var line = d3.svg.line()
    .interpolate("basis")
    .x(function(d) { return x(d.month) })
    .y(function(d) { return y(d.value) });

  svg1.selectAll(".line")
    .data(entries)
  .enter().append("path")
    .attr("class", "line")
    // function(d), not just line function 
    .attr("d", function(d){ return  line(d.value); })
    .attr("stroke", function(d) { return colors(d.key) }); 
```

这个答案也有一些帮助： [Using nested data with javascript D3 question](https://stackoverflow.com/questions/7111584/using-nested-data-with-javascript-d3-problem)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:23:56.823

我的猜测是这里最大的问题是你从一个对象开始，而不是一个数组。`d3.data`需要一个数组，而不是一个对象，因此您可能需要像这样设置数据：

```
[
  [{"val":10, "mon":10}, {"val":20, "mon":11}, {"val":40, "mon":12}, ...],
  [{"val":20, "mon":8}, {"val":20, "mon":9}, {"val":40, "mon":10}, ...],
  ...
] 
```

如果您需要将当前数据转换为这种格式，请查看[`d3.entries`](https://github.com/mbostock/d3/wiki/Arrays#wiki-d3_entries)，它将为您提供一个包含您的键以及点数组的数组：

```
[
  {
    key: "2008",
    value: [{"val":10, "mon":10}, {"val":20, "mon":11}, {"val":40, "mon":12}, ...]
  },
  { 
    key: "2008",
    value: [{"val":20, "mon":8}, {"val":20, "mon":9}, {"val":40, "mon":10}, ...]
  },
  ...
] 
```

使用上面的第一种数据格式，请参阅此小提琴以获取图表的简单案例版本：http: [//jsfiddle.net/nrabinowitz/kmmyc/](http://jsfiddle.net/nrabinowitz/kmmyc/)

# javascript - 保留原始大小写的自定义不区分大小写排序功能？

> ID：14308786
> 
> 赞同：5
> 
> 时间：2013-01-13T22:09:42.140
> 
> 标签：javascript, sorting, user-defined-functions, case-insensitive

我已经完成了一个现代 JavaScript 练习，以创建一个页面，该页面采用一串单词并以不区分大小写的方式对它们进行排序。[这是代码笔： http](http://codepen.io/Mcabrams/full/FvuJg) : //codepen.io/Mcabrams/full/FvuJg ：

```
// relevant code:
var sorted = words.map(function(value){
    return value.toLowerCase();
}).sort(); 
```

我想知道如何制作与 类似的函数`sortWords()`，但是在以不区分大小写的方式进行排序时，当我返回排序后的单词时，我想保持原来的大小写。

所需功能的示例：

`sortWords(["D","b","A","c"]) ======> ["A", "b", "c", "D"]`

目前，原来的外壳在我的功能中丢失了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-13T22:11:51.787

在内置[`Array.sort()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort)方法中使用自定义比较器：

```
function insensitive(s1, s2) {
  var s1lower = s1.toLowerCase();
  var s2lower = s2.toLowerCase();
  return s1lower > s2lower? 1 : (s1lower < s2lower? -1 : 0);
}

["D","b","A","c"].sort(insensitive);  //"A", "b", "c", "D" 
```

# android - 尝试从 Google Cloud Messaging 消息更改 Google Maps v2 Api 上的标记时出现非法状态异常

> ID：14308789
> 
> 赞同：6
> 
> 时间：2013-01-13T22:10:05.507
> 
> 标签：android, maps, google-cloud-messaging, illegalstateexception

我正在编写一个 android 应用程序，我在 Google Map 上有标记，应该将其更改为 GCM 收到的位置。我有一个全局静态列表，我将标记与 id 和位置一起保存在其中。我可以在收到消息时更改 GCMBaseIntentService 列表中对象的位置，但是当我想执行以下代码时：

```
 mMarker.setPosition(new LatLng(member.getLatitude(),member.getLongitude())); 
```

我得到以下异常：

```
 01-13 18:52:38.118: E/AndroidRuntime(7605): FATAL EXCEPTION: IntentService[GCMIntentService-1041237551356-1]
    01-13 18:52:38.118: E/AndroidRuntime(7605): java.lang.IllegalStateException: Not on the main thread
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at maps.am.r.b(Unknown Source)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at maps.ar.d.b(Unknown Source)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at maps.y.ae.addMarker(Unknown Source)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at com.google.android.gms.maps.internal.IGoogleMapDelegate$Stub.onTransact(IGoogleMapDelegate.java:167)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at android.os.Binder.transact(Binder.java:279)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at com.google.android.gms.maps.internal.IGoogleMapDelegate$a$a.addMarker(Unknown Source)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at com.google.android.gms.maps.GoogleMap.addMarker(Unknown Source)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at com.example.MapViewActivity.showMember(MapViewActivity.java:529)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at com.example.MapViewActivity.updateMember(MapViewActivity.java:417)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at com.example.MapViewActivity.updateMembers(MapViewActivity.java:410)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at com.example.pushnotifications.GCMIntentService.onMessage(GCMIntentService.java:75)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at com.google.android.gcm.GCMBaseIntentService.onHandleIntent(GCMBaseIntentService.java:223)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:59)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at android.os.Handler.dispatchMessage(Handler.java:99)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at android.os.Looper.loop(Looper.java:130)
    01-13 18:52:38.118: E/AndroidRuntime(7605):     at android.os.HandlerThread.run(HandlerThread.java:60) 
```

我尝试在地图上添加一个按钮来刷新所有标记（使用完全相同的代码）并且效果很好。所以不知何故，问题是 GCM 在不同的线程或类似的东西中执行，似乎我无法从不同的线程更改标记......

我尝试了一个丑陋的解决方案：每秒刷新所有标记。但是从 MapViewActivity 创建一个线程给出了相同的异常：

```
private Thread MarkerUpdater = new Thread(
    new Runnable() {
        public void run() {
            while(true) {
                updateMembers();
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        }
    }); 
```

也许有人知道一个好的解决方案会是什么样子？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-13T22:27:17.440

您需要获取主 UI 线程的处理程序并在那里发布一个可运行文件。

```
Handler handler = new Handler(Looper.getMainLooper());
handler.post(new Runnable(){ 
   // your UI code here 
} 
```

您从您的服务中引用的任何变量`Runnable`都需要是最终的。既然您说您将数据共享为全局/静态，那么您应该没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-28T12:44:28.090

**试试这个，**

```
Handler handler = new Handler(Looper.getMainLooper());
    handler.post(new Runnable() {
         @Override
         public void run() {
              //your code
         }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-26T14:50:37.230

这可能对其他人有用：我刚刚遇到了一个非常相似的问题，即在收到 GCM 消息时标记不更新。解决方案确实是将标记更新代码放在主循环处理程序中，但由于某种原因，您在该 run() 方法中放入的内容确实很重要。

## TLDR

仅仅将 marker.setPosition(lat, lon)-call 放在 runnable 中是不够的。我必须将所有标记处理代码放在可运行文件中（查找标记，检查它们是否有位置，设置新位置，更新地图相机）。

## 详细地

### 问题

*   我的应用通过 GCM 接收其他人的位置更新。
*   每次更新位置时，都必须更新相应的标记。
*   我的申请收到了第一个 GCM，但下一个没有。
*   没有崩溃，应用程序完全响应，只是在第一个之后没有收到更多的 GCM 消息。

### 我发现了什么

*   我的第一个想法是 GCM 服务器只是很慢。
*   但是：在监视**所有**控制台输出时，我看到来自 GCM 的调试消息显示消息已到达设备，但未到达应用程序！

### 什么对我有用

*   确保在接收 GCM 时需要运行的**所有**Google Maps 代码都在 MainLooper 的 Runnable 中。

### 结论

*   将所有 GM 代码放入可运行文件中确实有意义，但是看到没有错误输出并且应用程序完全响应，很难找到该解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-24T15:51:00.397

使用我的代码：

```
 private class UpdateThread extends AsyncTask<Void, Void, Void>
    {
        @Override
        protected void onProgressUpdate(Void... values) {
            super.onProgressUpdate(values);
            //...
            mMarker.setPosition(new LatLng(member.getLatitude(),member.getLongitude()));
        }
        @Override
        protected Void doInBackground(Void... params) {

            while(true)
            {
                try {
                    //...
                    publishProgress();

                    Thread.sleep(3000);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }
    } 
```

```
 UpdateThread updateThread = new UpdateThread();
    updateThread.execute(); 
```

# jquery - 如何在不触及文件名的情况下截断字符串（包含路径）？

> ID：14308792
> 
> 赞同：6
> 
> 时间：2013-01-13T22:11:00.420
> 
> 标签：jquery, string, filepath, truncate

**如何在不触及文件名的情况下截断字符串（包含路径）（保留最后一个文件夹、文件名和驱动器号）？**

嗨，我正在寻找一种截断路径以适应指定宽度的方法。

我已经在 SO 上搜索了，我发现了这个： [Truncate a string nicely to fit within a given pixel width](https://stackoverflow.com/questions/282758/truncate-a-string-nicely-to-fit-within-a-given-pixel-width)

但它在字符串的末尾添加了 ... 。我想有一个类似的功能，但它需要保持开始和结束..

**例如，我有这个路径（字符串）：**

```
H:\Informatique\Personnalisation\Icones\__\Crystal GT PNG Pack\Applications\licq.png 
```

它需要像这样适应 div 的宽度：

```
H:\Informatique\...PNG Pack\Applications\licq.png 
```

**另一个例子：**

```
D:\A___VERY___________LONG________PATH____________\myfile.png 
```

将缩短为：

```
D:\A___VERY___________LONG________PA...\myfile.png 
```

**最后一个例子：**

```
D:\A___VERY___________LONG________PATH____________\and-a-sub-solder\myfile.png 
```

将缩短为：

```
D:\A___VERY________...\and-a-sub-solder\myfile.png 
```

限制：

*   驱动部分是必需的(H:)
*   文件名和扩展名是必需的 (licq.png)
*   如果有多个文件夹，则不能截断最后一个文件夹，除非所有内容都已被截断，这是使字符串更短的唯一方法。
*   如果文件名太长，请在中间截断。

**长文件名示例：**

```
D:\my____file___________________________name____is___too____________long.png 
```

将缩短为：

```
D:\my____file_________..._is___too____________long.png 
```

我看到 Windows 和苹果做得很好......但我找不到任何靠近它的脚本。

任何具有类似脚本的链接，以便我可以尝试调整它？或者任何想帮助我的人？:)

非常感谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T22:53:04.517

这是一个有趣的问题，这是我的解决方案：http: [//jsfiddle.net/AlienHoboken/y7SgA/](http://jsfiddle.net/AlienHoboken/y7SgA/)

它假定您有一个变量 str ，其中包含路径， maxLength 具有您的最大字符长度。

您需要稍微更改代码，因为 str 是硬编码的，您需要更改 maxLength，并且您还需要更改写入信息的位置（它现在只是写入正文）。

注意：如果您的驱动器名称 + 文件名超过 maxLength 变量，即使它们太大，它也会一起打印出这两个。

代码，以防你不喜欢 jsfiddle：

```
$(document).ready(function () {
  var str = "H:\\Informatique\\Personnalisation\\Icones\\__\\Crystal GT PNG Pack\\Applications\\licq.png";
  var maxLength = 25;

  var tokens = str.split("\\");
  var drive = tokens[0];
  var fileName = tokens[tokens.length - 1];
  var len = drive.length + fileName.length;
  //remove the current lenth and also space for 3 dots and 2 slashes
  var remLen = maxLength - len - 5;

  //if remLen < 0, then it will over flow our maxLength to still maintain drive and     filename
  if (remLen > 0) {
    //remove first and last elements from the array
    tokens.splice(0, 1);
    tokens.splice(tokens.length - 1, 1);
    //recreate our path
    var path = tokens.join("\\");
    //handle the case of an odd length
    var lenA = Math.ceil(remLen / 2);
    var lenB = Math.floor(remLen / 2);
    //rebuild the path from beginning and end
    var pathA = path.substring(0, lenA);
    var pathB = path.substring(path.length - lenB);
    path = drive + "\\" + pathA + "..." + pathB + "\\" + fileName;

    //write it out
    $("body").html("Orig. Path: " + str + "<br /><br />" +
      "New Path: " + path + "<br /><br />" +
      "MaxLength: " + maxLength + "<br /><br />" +
      "New Length: " + path.length);
  } else {

    //try and fit our maxlength by taking only drive and filename
    $("body").html("Orig. Path: " + str + "<br /><br />" +
      "New Path: " + drive + "\\" + fileName + "<br /><br />" +
      "MaxLength: " + maxLength + "<br /><br />" +
      "New Length: " + (len + 1) + "<br /><br />");
  }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-09-22T09:55:45.213

让我添加一点优化版本的@AlienHoboken 的代码。这个版本

*   适用于字符串开头有或没有驱动器的路径
*   适用于带有 / 或 \ 分隔符的路径
*   当我们只需要显示文件夹路径时可以省略文件名

希望能帮助到你！

```
function pathShorten(str, maxLength, removeFilename) {
    var splitter = str.indexOf('/')>-1 ? '/' : "\\",
        tokens = str.split(splitter), 
        removeFilename = !!removeFilename,
        maxLength = maxLength || 25,
        drive = str.indexOf(':')>-1 ? tokens[0] : "",  
        fileName = tokens[tokens.length - 1],
        len = removeFilename ? drive.length  : drive.length + fileName.length,    
        remLen = maxLength - len - 5, // remove the current lenth and also space for 3 dots and 2 slashes
        path, lenA, lenB, pathA, pathB;    
    //remove first and last elements from the array
    tokens.splice(0, 1);
    tokens.splice(tokens.length - 1, 1);
    //recreate our path
    path = tokens.join(splitter);
    //handle the case of an odd length
    lenA = Math.ceil(remLen / 2);
    lenB = Math.floor(remLen / 2);
    //rebuild the path from beginning and end
    pathA = path.substring(0, lenA);
    pathB = path.substring(path.length - lenB);
    path = drive + splitter + pathA + "..." + pathB + splitter ;
    path = path + (removeFilename ? "" : fileName); 
    //console.log(tokens, maxLength, drive, fileName, len, remLen, pathA, pathB);
    return path;
} 
```

# security - 自动更改 192.168.0.x 上的配置

> ID：14308797
> 
> 赞同：0
> 
> 时间：2013-01-13T22:12:04.763
> 
> 标签：security, automation, localhost

我在办公室里安装了一些运动检测摄像机。我可以手动登录 192.168.0.X、192.168.0.Y、192.168.0.Z 等，并在每个仪表板中打开和关闭运动检测。但是，我正在寻找一种方法来自动执行此操作，并能够访问我的网络上的一个内部地址，该地址将为我执行这些操作。另外，当我在我的网络上时，我希望能够从我的手机上访问这个相同的内部地址来武装和解除摄像头。

处理创建只能在网络上看到的内部地址并自动从脚本提交表单的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:20:09.643

“内部地址”意味着您需要运行 Web 服务器。一个带有 LAMP 的简单 Linux 机器就可以解决问题。然后，编写一个 PHP 脚本，该脚本使用 CURL 自动向摄像机发出 Web 请求。

# android - 使用 KSOAP2 接收整数数组

> ID：14308798
> 
> 赞同：0
> 
> 时间：2013-01-13T22:12:05.440
> 
> 标签：android, jax-ws, ksoap2

我在使用 KSOAP2 接收整数数组时遇到问题。我遵循了[http://code.google.com/p/ksoap2-android/wiki/CodingTipsAndTricks](http://code.google.com/p/ksoap2-android/wiki/CodingTipsAndTricks)上的教程并创建了以下类：

```
package pl.webcentral.reversi;

import java.util.Hashtable;
import java.util.Vector;

import org.ksoap2.serialization.KvmSerializable;
import org.ksoap2.serialization.PropertyInfo;

public class Fields extends Vector<String> implements KvmSerializable {

        /**
         * 
         */
        private static final long serialVersionUID = -1166006770093411055L;

        @Override
        public Object getProperty(int arg0) {
                return this.get(arg0);
        }

        @Override
        public int getPropertyCount() {
                return this.size();
        }

        @Override
        public void getPropertyInfo(int arg0, Hashtable arg1, PropertyInfo arg2) {
                arg2.name = "string";
                arg2.type = PropertyInfo.STRING_CLASS;
        }

        @Override
        public void setProperty(int arg0, Object arg1) {
                this.add(arg1.toString());
        }

} 
```

发送数组：

```
SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME); 
        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11); 

        PropertyInfo propInfo=new PropertyInfo();
        propInfo.setName("arg0");
        propInfo.setType(PropertyInfo.STRING_CLASS);
        propInfo.setValue(sessionId);

        request.addProperty(propInfo);

        // Sending the array representing our board:

        Fields fieldsVector = new Fields();

        for (int i=0; i<65; i++) {

            fieldsVector.add(move[i].toString());

        }

        PropertyInfo fieldsPropertyInfo = new PropertyInfo();
        fieldsPropertyInfo.setName("fields");
        fieldsPropertyInfo.setValue(fieldsVector);
        fieldsPropertyInfo.setType(fieldsVector.getClass());

        request.addProperty(fieldsPropertyInfo);

        PropertyInfo sessionPropertyInfo = new PropertyInfo();
        sessionPropertyInfo.setName("arg0");
        sessionPropertyInfo.setType(PropertyInfo.STRING_CLASS);
        sessionPropertyInfo.setValue(sessionId);
        request.addProperty(sessionPropertyInfo);

        envelope.setOutputSoapObject(request);

        envelope.addMapping(NAMESPACE, "fields", new Fields().getClass());

        HttpTransportSE androidHttpTransport = new HttpTransportSE(WSDL_URL);
        // androidHttpTransport.debug = true;

        try {
            androidHttpTransport.call(SOAP_ACTION, envelope);
        } catch (Exception e) {
            throw new RuntimeException("Unexpected exception", e);
        }

        try {
            SoapPrimitive resultsRequestSOAP = (SoapPrimitive) envelope.getResponse();
        } catch (SoapFault e) {
            System.out.println("Error adding move: " + e.faultstring);//można to ładnie jakoś pokazać na ekranie
            throw e;
        }
    } 
```

现在我不知道 XML 的真正样子。我试图设置此调试但不知道如何设置。因此，我不知道如何检索所有这些...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T07:37:51.020

对于转储请求和响应 xml，试试这个：

```
androidHttpTransport.debug = true;
androidHttpTransport.call(SOAP_ACTION, envelope);
Log.d("dump Request: " ,androidHttpTransport.requestDump);
Log.d("dump response: " ,androidHttpTransport.responseDump); 
```

如果您不知道您的 Web 服务是什么样的，那么[SOAP UI](http://www.soapui.org/)对您来说是一个很好的工具。

# mysql - MYSQL 选择排列；要求跨行的唯一值

> ID：14308803
> 
> 赞同：1
> 
> 时间：2013-01-13T22:12:24.503
> 
> 标签：mysql, optimization, select, unique, permutation

我想执行一个选择导致一组**排列，而不是组合**。换句话说，我想执行一个查询，该查询返回表中项目的**各种数量和排列**的行。**同一行内不得有任何 ID 水平重复**。

例如我们可以有：

```
9 pick 3 
9 pick 5 
9 pick 7 
```

我有一个有效的查询，但我正在寻找优化它。该`WHERE...AND...`子句过滤掉具有重复 ID 的行。虽然这可行，但它需要`AND`为每个添加的选择（列）添加几个附加子句。**需要`9 pick 6`十五个`!=`断言！**随着拾取物品数量的增加，这可能会变得笨拙。它看起来也很臃肿。我正在寻找简单而优雅的东西。

这是我的桌子：

```
CREATE TABLE IF NOT EXISTS `table1` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `col1` varchar(24) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=30 ;

INSERT INTO `table1` (`id`, `col1`) VALUES
(1, 'Wool Hat'),
(2, 'Wool Gloves'),
(3, 'Fleece Sweater'),
(4, 'Jean Pants'),
(5, 'Cotton T-Shirt'),
(6, 'Wool Socks'),
(7, 'Wool Blanket'),
(8, 'Cotton Boxers'),
(9, 'Fleece Pants'); 
```

这是我的查询：

```
SELECT * FROM 
`table1` t1, 
`table1` t2, 
`table1` t3,
`table1` t4,
`table1` t5,
`table1` t6

WHERE
t1.id != t2.id
AND
t1.id != t3.id
AND
t1.id != t4.id
AND
t1.id != t5.id
AND
t1.id != t6.id
AND
t2.id != t3.id
AND
t2.id != t4.id
AND
t2.id != t5.id
AND
t2.id != t6.id
AND
t3.id != t4.id 
AND
t3.id != t5.id 
AND
t3.id != t6.id 
AND
t4.id != t5.id
AND
t4.id != t6.id
AND
t5.id != t6.id

ORDER BY t1.col1, t2.col1, t3.col1, t4.col1, t5.col1, t6.col1 
```

感谢您的任何见解！

编辑：

这个例子真的很无礼。我只是想以一种简单有效的方式完成排列的数学概念。

根据要求，这是预期结果的一半`9 pick 2`。另一半是交换对。

```
Wool Hat + Wool Gloves
Wool Hat + Fleece Sweater
Wool Hat + Jean Pants
Wool Hat + Cotton T-Shirt
Wool Hat + Wool Socks
Wool Hat + Wool Blanket
Wool Hat + Cotton Boxers
Wool Hat + Fleece Pants
Wool Gloves + Fleece Sweater
Wool Gloves + Jean Pants
Wool Gloves + Cotton T-Shirt
Wool Gloves + Wool Socks
Wool Gloves + Wool Blanket
Wool Gloves + Cotton Boxers
Wool Gloves + Fleece Pants
Fleece Sweater + Jean Pants
Fleece Sweater + Cotton T-Shirt
Fleece Sweater + Wool Socks
Fleece Sweater + Wool Blanket
Fleece Sweater + Cotton Boxers
Fleece Sweater + Fleece Pants
Jean Pants + Cotton T-Shirt
Jean Pants + Wool Socks
Jean Pants + Wool Blanket
Jean Pants + Cotton Boxers
Jean Pants + Fleece Pants
Cotton T-Shirt + Wool Socks
Cotton T-Shirt + Wool Blanket
Cotton T-Shirt + Cotton Boxers
Cotton T-Shirt + Fleece Pants
Wool Socks + Wool Blanket
Wool Socks + Cotton Boxers
Wool Socks + Fleece Pants
Wool Blanket + Cotton Boxers
Wool Blanket + Fleece Pants 
```

这不包括以下内容：

```
Wool Hat + Wool Hat
Wool Gloves + Wool Gloves
Fleece Sweater + Fleece Sweater
Jean Pants + Jean Pants
Cotton T-Shirt + Cotton T-Shirt
Wool Socks + Wool Socks
Wool Blanket + Wool Blanket
Cotton Boxers + Cotton Boxers
Fleece Pants + Fleece Pants 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T01:17:23.130

这是你要找的吗？

```
SELECT
    t1.`id` AS 'id1',
    t2.`id` AS 'id2',
    t1.`col1` AS 't1_col',
    t2.`col1` AS 't2_col',
    CONCAT(t1.`col1`,' + ',t2.`col1`) AS 'combined'
FROM `table1` t1
CROSS JOIN `table1` t2
WHERE t1.`id` != t2.`id`
-- or
-- WHERE t1.`id` < t2.`id`
ORDER BY t1.`id`,t2.`id` 
```

**[编辑]**另一种选择是使用 JOINS。这是您的`9 pick 3`.

```
SELECT
    t1.`id` AS 'id1',
    t2.`id` AS 'id2',
    t3.`id` AS 'id3',
    t1.`col1` AS 't1_col',
    t2.`col1` AS 't2_col',
    t3.`col1` AS 't3_col',
    CONCAT_WS(' + ',t1.`col1`,t2.`col1`,t3.`col1`) AS 'combined'
FROM `table1` t1
INNER JOIN `table1` t2
INNER JOIN `table1` t3
ON
    t2.`id` > t1.`id` AND
    t3.`id` > t2.`id`
ORDER BY t1.`id`,t2.`id`,t3.`id` 
```

# java - 一个合适的基准？

> ID：14308805
> 
> 赞同：3
> 
> 时间：2013-01-13T22:12:35.303
> 
> 标签：java, multithreading, benchmarking

我想测量 2 个不同的程序需要多长时间来执行 1 个任务。一个程序使用线程，另一个没有。任务是数到 2000000。

*带*线程的类：

```
public class Main {
    private int res1 = 0;
    private int res2 = 0;

    public static void main(String[] args) {
        Main m = new Main();

        long startTime = System.nanoTime();
        m.func();
        long endTime = System.nanoTime();

        long duration = endTime - startTime;
        System.out.println("duration: " + duration);
    }

    public void func() {
        Thread t1 = new Thread(new Runnable() {

            @Override
            public void run() {
                for (int i = 0; i < 1000000; i++) {
                    res1++;
                }
            }
        });

        Thread t2 = new Thread(new Runnable() {

            @Override
            public void run() {
                for (int i = 1000000; i < 2000000; i++) {
                    res2++;
                }
            }
        });

        t1.start();
        t2.start();

        System.out.println(res1 + res2);
    }
} 
```

*没有*线程的类：

```
public class Main {

    private int res = 0;

    public static void main(String[] args) {
        Main m = new Main();

        long startTime = System.nanoTime();
        m.func();
        long endTime = System.nanoTime();

        long duration = endTime - startTime;
        System.out.println("duration: " + duration);

    }

    public void func() {

        for (int i = 0; i < 2000000; i++) {
            res++;
        }
        System.out.println(res);
    }
} 
```

10 次测量后的平均结果（以纳秒为单位）为：

```
With threads:    1952358
Without threads: 7941479 
```

我做对了吗？
为什么有 2 个线程，它的速度是 4 倍，而不仅仅是 2 倍？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-13T22:21:40.493

在行中

```
 t1.start();
    t2.start(); 
```

您正在开始执行线程，但实际上并没有在您进行时间测量之前等待它们完成。要等到线程完成，请调用

```
 t1.join();
   t2.join(); 
```

join 方法将阻塞，直到线程完成。然后测量执行时间。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-13T22:19:45.817

在并行版本中，您正在测量有多少主线程创建了其他两个线程。您没有测量它们的执行时间。这就是您获得超线性加速的原因。为了包括它们的执行时间，您必须将它们与主线程连接起来。

在之后添加这些行`t2.start();`

```
 t1.join();  // wait until thread t1 terminates
     t2.join(); // wait until thread t2 terminates 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-13T22:43:29.160

多线程版本更快的主要原因是您无需等待循环完成。您只需等待线程启动。

您需要在 start(); 之后添加

```
 t1.join();
    t2.join(); 
```

完成此操作后，您会注意到启动线程需要很长时间，而且速度要慢一些。如果您将测试时间延长 100 倍，那么启动线程的成本就不那么重要了。

单线程示例需要更长的时间才能正确进行 JItted。您需要确保重复运行测试至少 2 秒

我的多线程版本是

```
public class Main {
    private long res1 = 0;
    public long p0, p1, p2, p3, p4, p5, p6, p7;
    private long res2 = 0;

    public static void main(String[] args) throws InterruptedException {
        Main m = new Main();

        for (int i = 0; i < 10; i++) {
            long startTime = System.nanoTime();
            m.func();
            long endTime = System.nanoTime();

            long duration = endTime - startTime;
            System.out.println("duration: " + duration);
        }
        assert m.p0 + m.p1 + m.p2 + m.p3 + m.p4 + m.p5 + m.p6 + m.p7 == 0;
    }

    public void func() throws InterruptedException {
        Thread t1 = new Thread(new Runnable() {
            @Override
            public void run() {
                for (int i = 0; i < 1000000000; i++) {
                    res1++;
                }
            }
        });

        Thread t2 = new Thread(new Runnable() {
            @Override
            public void run() {
                for (int i = 1000000000; i < 2000000000; i++) {
                    res2++;
                }
            }
        });

        t1.start();
        t2.start();
        t1.join();
        t2.join();
        System.out.println(res1 + res2);
    }
} 
```

为多线程测试打印以下内容。

```
2000000000
duration: 179014396
4000000000
duration: 148814805
.. deleted ..
18000000000
duration: 61767861
20000000000
duration: 72396259 
```

对于单线程版本，我注释掉一个线程并得到

```
2000000000
duration: 266228421
4000000000
duration: 255203050
... deleted ...
18000000000
duration: 125434383
20000000000
duration: 125230354 
```

正如预期的那样，当运行足够长的时间时，两个线程的速度几乎是一个线程的两倍。

简而言之，

*   如果您不等待这些操作完成，例如异步日志记录和消息传递，多线程代码对当前线程的延迟可能会更小。

*   单线程编码可以比多线程代码更快（也更简单），除非您有大量的 CPU 绑定任务要执行（或者您可以执行并发 IO）

*   在同一个 JVM 中重复运行测试会得到不同的结果

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-13T22:25:07.800

在 Java 中进行基准测试时，您需要记住一些技巧。

第一个在对任何东西进行基准测试时都是一样的：一次运行可能恰好*比*另一次慢，没有任何意义。为避免这种情况，请运行多次并取平均值（我的意思是很多次）。

第二个可能不是 java 独有的，但可能令人惊讶：java VM 可能需要一些时间来“预热”——如果你运行你的代码一百次，编译的代码可以`change`根据哪些代码路径非常常见。*要解决这个问题，请在开始获取 stats 之前*多次运行代码。

预热需要多长时间取决于您的 JVM 设置 - 我不太记得了。

当然，这与其他答案指出的问题完全不同，即您实际上并未测量线程程序。

编辑：要注意的另一件事是编译器意识到任何特定的变量/循环/整个程序都是完全没有意义的。在这些情况下，它可能会完全删除它——你可能会发现你需要使用`res1`，`res2`否则你的循环可能会从编译的代码中完全删除。

编辑：刚刚意识到你确实使用了所有的计数变量——不过，知道它仍然是一件有用的事情，所以我会把它留在里面。

# google-maps - google.maps.event.trigger

> ID：14308808
> 
> 赞同：1
> 
> 时间：2013-01-13T22:12:43.883
> 
> 标签：google-maps, google-maps-api-3

努力使谷歌地图工作的时间。单击第二个选项卡时，地图仅显示 30%。它坏了。我正在使用事件触发器重新加载地图。

有什么解决方案可以让我的地图完全显示？？？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:24:51.630

首先我注意到你有一些地方说 Demo.map 和其他地方说 demo.map 确保在整个代码中保持一致的大小写以避免任何错误。您也可以在 jQuery 语句之前放置变量声明以确保更少的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:27:20.873

看起来您的想法是正确的，但是您已将地图命名为 Demo.Map 并且您正在触发 demo.map 上的调整大小。

demo.map !== Demo.map

编辑：对评论的回应

查看 jQuery UI 选项卡 API (http://api.jqueryui.com/tabs/#option-show) - 您应该调用的事件的名称是活动的，而不是显示，所以下面的代码：

```
$(function() {
    $("#tabs").tabs({
        show: function(e, ui) {
            if (ui.index == -1) {
                google.maps.event.trigger(Demo.map, "resize");
            }
        }
    });
}); 
```

应该看起来像这样（去掉 if 语句 - resize 事件是轻量级的，如果在不必要时调用它也没关系）：

```
$(function() {
    $("#tabs").tabs({
        activate: function(e, ui) {                                
         google.maps.event.trigger(Demo.map, "resize");
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T13:48:36.030

试试这个朋友

```
$(function() {
    $("#tabs").tabs({
        show: function(e, ui) {                                
         google.maps.event.trigger(Demo.map, "resize");   
        }
    });
}); 
```

# objective-c - Objective-C 对象或类

> ID：14308809
> 
> 赞同：0
> 
> 时间：2013-01-13T22:12:56.937
> 
> 标签：objective-c, object

我是 Objective-c 的新手，我以前用 java 编码。

我在 Xcode 4.5 中编写了以下代码

代码必须让我得到这个输出：

```
 the value of  m is:
  1/3 
```

但我得到这个输出：

```
the value of  m is: 
```

谁能告诉我代码有什么问题

编码 ：

```
#import <Foundation/Foundation.h>

@interface Fraction : NSObject
{
    int num ;
    int dem;
}

-(void) print;
-(void) setNum:(int) n ;
-(void) setDem: (int) d;
@end

@implementation Fraction
-(void) print {
    NSLog(@"%i/%i",num,dem);
}
-(void) setNum:(int)n{

    num=n;
    NSLog(@"set num work fine %i:",n);
}

-(void)setDem:(int)d{
    dem=d;
    NSLog(@"set dem work fine %i:",d);
}

@end

int main (int argc ,char *argv[]){

    @autoreleasepool {
        Fraction *m;

        // m=[m alloc] ;
        m=[m init];

        [m setNum:1];
        [m setDem:3];

        NSLog(@"the value of  m is:");
        [m print];
    }return 0;

} 
```

谁能解释 m=[m alloc] ；在新的 xcode 中

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T22:18:06.860

`alloc`是一个类方法，所以你必须在你的类上调用它：

```
m = [[Fraction alloc] init]; 
```

或者，按照您的风格：

```
m = [Fraction alloc];
m = [m init]; 
```

这就是您不打印任何东西的原因，`m`仍然是`nil`因为您没有打印`alloc`。将`init`消息发送给`nil`接收者返回，所以当你尝试打印时`nil`你基本上有一个对象。`nil`

# php - Mac OSX 10.8 上的 PHPUnit 错误

> ID：14308812
> 
> 赞同：0
> 
> 时间：2013-01-13T22:13:23.377
> 
> 标签：php, phpunit

我正在尝试学习一些关于 PHPUnit 测试的知识，并且我通过 PEAR 安装了 PHPUnit，但是我没有运气尝试让它运行。

这是我的脚本：

```
<?php
    require_once "PHPUnit.php";
    class myclass_test extends PHPUnit_TestCase {
        protected $my;

        function setUp() {
            $this->$my = new Myclass('xxx', 'xxx', 'xxx');
        }

        function teardown() {
            unset($this->my);
        }

        function testResponseCodeSuccess() {
            self::assertTrue($this->my->_validResponseCode(200));
        }
    } 
```

我在控制台上运行它：`php myclass_test.php`

我收到这些错误：

```
PHP Warning:  require_once(PHPUnit.php): failed to open stream: No such file or directory in /Users/dennismonsewicz/Projects/PHP/test-php/tests/myclass_test.php on line 2
PHP Fatal error:  require_once(): Failed opening required 'PHPUnit.php' (include_path='.:/Users/dennismonsewicz/pear/share/pear:/usr/local/share/pear:/usr/bin/pear') in /Users/dennismonsewicz/Projects/PHP/test-php/tests/myclass_test.php on line 2 
```

我遵循了本教程： http: [//pear.php.net/manual/en/package.php.phpunit.intro.php](http://pear.php.net/manual/en/package.php.phpunit.intro.php)

还有其他人遇到这些问题吗？

# javascript - 使用 JavaScript 膨胀 blob？

> ID：14308815
> 
> 赞同：5
> 
> 时间：2013-01-13T22:14:17.493
> 
> 标签：javascript, compression, blob, inflate

我正在使用 websocket 以 blob 形式发送 Jpeg 图像。我已经压缩（gzipped）了 blob，但我找不到使用 JavaScript 解压缩它的方法。有谁知道怎么做？

这是我用来读取 blob 并将其转换为 base64 字符串的代码：

```
var r = new FileReader();

r.onload = function(){
    draw(btoa(r.result));
};
r.readAsBinaryString(e.data); 
```

该`draw()`函数基本上使用 base64 字符串将图像绘制到 HTML5 画布上。

我发现[这个库](https://github.com/dankogai/js-deflate)可以扩充字符串，但它不支持 blob。（据我所知/已经测试过）如果有人知道一种方法，我会很高兴。：） 谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T22:45:41.557

我为我的[粒子系统编辑器](https://github.com/city41/particle.js)做了一个非常相似的事情，它支持读取 Cocos2D plist 文件。plist文件中是纹理数据，这是一个用gzip压缩然后转换为base64的png。这是我的做法：

```
var input = 'byu9g1RZpINUpVtoKoiKIqJYoris...'; // really long string

// from base64 to ascii binary string
var decodedAsString = atob(input);

// ascii string to bytes in gzipped format
var data = this._binaryStringToArray(decodedAsString);

// raw, uncompressed, binary image data into an array using gzip.js
var uncompressed = require('gzip-js').unzip(data);

// now take the raw uncompressed png and convert it
// back to base64 to use it as a data url
var asString = this._arrayToBinaryString(uncompressed);
var encodedForDataUrl = btoa(asString);

var img = new Image();
img.src = encodedForDataUrl; 
```

我正在使用[gzip.js](https://github.com/beatgammit/gzip-js)来完成繁重的工作。[你可以在这里](http://city41.github.com/particle.js/exp/)看到这一切，你可以在[这里](https://github.com/cocos2d/cocos2d-iphone/tree/master-v2/Resources/Particles)下载一些 plist 。BoilingFoam.plist 将起作用，只需将其加载到“导入/导出”部分即可。

在上面的代码中，我调用了两个方法，它们是：

```
 _binaryStringToArray: function(binaryString) {
        var data = [];

        for (var i = 0; i < binaryString.length; ++i) {
            data[i] = binaryString.charCodeAt(i);
        }

        return data;
    },

    _arrayToBinaryString: function(array) {
        var str = '';
        for (var i = 0; i < array.length; ++i) {
            str += String.fromCharCode(array[i]);
        }
        return str;
    }, 
```

整个shebang都[在这里](https://github.com/city41/particle.js/blob/plist/public/javascripts/io/PlistImporter.js#L178)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-26T23:55:40.250

获取一个 byteArray，您可以使用以下方法对其进行解码：http `pako`: [//jsfiddle.net/9yH7M/](http://jsfiddle.net/9yH7M/)

# css - ie8 在显示 div 时不会改变边距

> ID：14308818
> 
> 赞同：0
> 
> 时间：2013-01-13T22:14:37.030
> 
> 标签：css, internet-explorer-8

所以，我很想忽略 ie8，但在这种情况下，完整的应用程序将分布在仅运行 ie8 的笔记本电脑上。我希望有人可以提供帮助，因为我自己的知识已经用完了。

对于此站点，当您单击页面侧面的“选项卡”时，屏幕左侧会出现一个“托盘”。并且“标签”应该向右移动“托盘”的深度。我在所有 webkit 浏览器中都运行良好，但不是 ie8。这是代码。感谢您的任何意见，我仍处于自学初期。

button2 是持有 image2 的 div。thumbnails2 是“托盘”

```
 <script>
    function showThumbnails2() {
        document.getElementById('thumbnails2').style.display = "block";
        document.getElementById('button2').onclick = hideThumbnails2;
        document.getElementById('image2').style["margin-left"] = "149px";
    }
    function hideThumbnails2() {
        document.getElementById('thumbnails2').style.display = "none";
        document.getElementById('button2').onclick = showThumbnails2;
        document.getElementById('image2').style["margin-left"] = "0px";
    }
    </script> 
```

以及来自文档正文的更多内容...

```
 <a onclick="showThumbnails2()" href="#" id="button2"><img src="images/PullButtonleft.png" alt="Click for Topics" width="20" height="100" style="clear:both;display:block; position:absolute; margin-top:334px; left:0px;" id="image2"></a>

    <a onclick="showThumbnails2()" href="#" id="button2"><img src="images/PullButtonleft.png" alt="Click for Topics" width="20" height="100" style="clear:both;display:block; position:absolute; margin-top:334px; left:0px;" id="image2"></a> 
```

stackoverflow 在帮助我实现这一目标方面非常宝贵，我希望我已经正确地询问并格式化了它，再次感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:53:42.080

既然您使用的是绝对定位`margin-left`，为什么不尝试使用而不是更改属性？`left: 150px`我无法访问 Windows 机器，所以我无法测试您的`margin-left`问题，但更改`left`属性应该可以。

```
document.getElementById('image2').style.left = "149px"; 
```

# javascript - Node + MongoDB：参数在 find 调用中不起作用

> ID：14308819
> 
> 赞同：0
> 
> 时间：2013-01-13T22:14:59.997
> 
> 标签：javascript, node.js, mongodb

我在 MongoDB find 调用中遇到参数问题。如果我通过 request.params.note_id 我得到未定义。如果我用数字调用 find 我会得到一组正确的数据。

使用 request.params.note_id 调用。这只会返回一个空白视图。Console.log 正确打印 id。

```
app.get("/show/:note_id", function(request, response) {
  console.log(request.params.note_id);
  return db.notes.find({
    note_id: request.params.note_id
  }, function(err, notes) {
    return response.render(__dirname + "/views/index.ejs", {
      notes: notes
    });
  });
}); 
```

使用固定 id 2 调用。这将返回正确呈现的视图，其内容为 note_id 2。Console.log 正确记录 url 中的任何内容（例如“/show/22”打印 22）。

```
app.get("/show/:note_id", function(request, response) {
  console.log(request.params.note_id);
  return db.notes.find({
    note_id: 2
  }, function(err, notes) {
    return response.render(__dirname + "/views/index.ejs", {
      notes: notes
    });
  });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:23:16.797

解决了。我只需要使用 parseInt 将参数转换为整数。

```
note_id: parseInt(request.params.note_id) 
```

# android - 我可以通过库存 Galaxy s3 上的 adb 从 eclipse 运行应用程序吗？

> ID：14308820
> 
> 赞同：0
> 
> 时间：2013-01-13T22:15:16.970
> 
> 标签：android, eclipse, adb

我一直能够使用 adbWireless 并在我的 Galaxy s3 上启动我的应用程序，但总是在基于 aosp 的 ROM 上。在基于 samsungs touchwiz 的基于股票的 rom 上是否可以这样做？每当我尝试运行我的应用程序时，我都会得到

由于无效的apk文件，安装失败！请查看日志猫以获取更多详细信息。

在日志猫中我看到：无法解析包无法打开 zip app.apk：权限被拒绝

然后在错误级别我看到“无法初始化 atd”

从我在谷歌上了解到的情况来看，这听起来是某些 ROM 的问题。这是有道理的，因为我在基于 aosp 的 ROM 上从来没有遇到过问题。是否可以通过 Eclipse 在 touchwiz rom 上运行应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:18:39.437

ADB Wireless 仅在您的手机已植根时才有效——您已植根 GS3 了吗？如果没有，这就是它不起作用的原因。

您仍然可以通过 USB 使用标准 ADB 进行调试。

# php - 通过 PHP 中的会话进行用户身份验证，是否需要 .htaccess？

> ID：14308830
> 
> 赞同：0
> 
> 时间：2013-01-13T22:16:30.790
> 
> 标签：php, mysql, database, authentication

我想知道在 PHP 中使用会话的网站的密码保护区域是否也需要 .htaccess。我是网站密码保护区域的新手，所以尽管我已经对此进行了研究，但我仍然感到困惑。

我的客户使用的计费公司提供了我放置在特定文件夹中的脚本，允许他们将新的和更新的用户信息写入站点的用户 mysql 数据库。我想使用我自己的登录和注销页面，并且我知道 HTTP 身份验证使用它自己的弹出登录框并且没有提供真正的注销方式......因此我们使用数据库来存储用户信息。

所以底线是，如果我通过数据库进行身份验证并在 PHP 中使用会话，我是否需要在受保护的文件夹中有一个 .htaccess 文件？

提前谢谢了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T22:18:33.367

你不可以。.htaccess 文件提供对基本身份验证的访问。您所说的将由网站脚本处理。您需要记住的一件大事是始终检查页面加载是否存在有效会话，并且无法重定向到登录页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:27:12.307

如果目录中的每个文件都是通过 PHP 实现的，那么您就不需要 htaccess。但是，如果它们是需要保护的目录中的非 php 文件，则这些文件将不受保护。如果您有一个销售图表或类似的东西作为图像存储在文件服务器上，那么任何能够找到它们的人都可以看到它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T23:02:02.227

请参阅这篇关于基于 REST 的身份验证的文章（通过 Apache）：[http ://www.berenddeboer.net/rest/authentication.html](http://www.berenddeboer.net/rest/authentication.html)

正如您所说，您计划使用 php session 实现自己的身份验证系统，并且我认为是 mysql，那么您将不需要 .htaccess 文件来完成此操作。

就这通过 PHP 而言，我仍然使用经过大量修改的系统，该系统包含在 sitepoint 书籍中，[以正确的方式构建您自己的网站](http://www.sitepoint.com/books/html3/ "以正确的方式建立自己的网站")。

它基本上需要加载一组控制器功能，这些功能要么与在会话中存储信息有关，要么与数据库检查存储的信息有关。

然后我可以使用这样的东西来限制对某些页面的访问，方法是将其放在其他所有页面之前：

```
if (!userIsLoggedIn())
{
    include "$docRoot/html/main/login.html.php";
    exit();
}

if (!userHasRole('Site Admin'))
{
    $error = 'Only a website administrator may access this page, your ip address has been logged and a notification sent to our support team as this is considered as an unauthorized access attempt.';
    unset($_SESSION['loggedIn']);
    include "$docRoot/html/main/accessdenied.html.php";
    exit();
}

if (!userHasActiveAccount())
{
    $error = 'Sorry but your account has been disabled. For futher information please contact support.';
    unset($_SESSION['loggedIn']);
    include "$docRoot/html/main/accessdenied.html.php";
    exit();
} 
```

# android - Android 模拟器不运行应用程序，但没有任何错误

> ID：14308833
> 
> 赞同：0
> 
> 时间：2013-01-13T22:17:16.913
> 
> 标签：android, android-layout

我只在图形布局上的 main.xml 中添加了按钮 textviews 和 edittexts。但它不适用于模拟器并且它没有给出任何错误？我会为此发疯的。这是代码，因此我也无法更改按钮位置...

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="15dp"
    android:layout_marginTop="18dp"
    android:text="Dersin Adı" />

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/textView1"
    android:layout_alignBottom="@+id/textView1"
    android:layout_marginLeft="52dp"
    android:layout_toRightOf="@+id/textView1"
    android:text="Kredi" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/textView2"
    android:layout_alignBottom="@+id/textView2"
    android:layout_marginLeft="16dp"
    android:layout_toRightOf="@+id/textView2"
    android:text="Eski Not" />

<TextView
    android:id="@+id/textView4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/textView3"
    android:layout_alignBottom="@+id/textView3"
    android:layout_alignParentRight="true"
    android:layout_marginRight="18dp"
    android:text="Yeni Not" />

<EditText
    android:id="@+id/ders"
    android:layout_width="120dp"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/textView1"
    android:ems="10" />

<EditText
    android:id="@+id/kredi"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/ders"
    android:layout_alignBottom="@+id/ders"
    android:layout_alignLeft="@+id/textView2"
    android:layout_toLeftOf="@+id/textView3"
    android:ems="10"
    android:inputType="number" />

<EditText
    android:id="@+id/eskiNot"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/kredi"
    android:layout_alignBottom="@+id/kredi"
    android:layout_alignLeft="@+id/textView3"
    android:layout_alignRight="@+id/textView3"
    android:ems="10" >

    <requestFocus />
</EditText>

<EditText
    android:id="@+id/yeniNot"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/eskiNot"
    android:layout_alignBottom="@+id/eskiNot"
    android:layout_alignLeft="@+id/textView4"
    android:layout_alignRight="@+id/textView4"
    android:ems="10" />

<TextView
    android:id="@+id/gno"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/textView1"
    android:layout_alignRight="@+id/ders"
    android:layout_below="@+id/ders"
    android:layout_marginTop="32dp"
    android:text="GNO" />

<TextView
    android:id="@+id/dno"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/gno"
    android:layout_alignRight="@+id/gno"
    android:layout_below="@+id/gno"
    android:layout_marginTop="14dp"
    android:text="DNO" />

<Button
    android:id="@+id/ekle"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/gno"
    android:layout_alignBottom="@+id/gno"
    android:layout_alignRight="@+id/yeniNot"
    android:text="Ekle" />

<Button
    android:id="@+id/gnoHesap"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/ekle"
    android:layout_alignBottom="@+id/ekle"
    android:layout_toLeftOf="@+id/yeniNot"
    android:text="Gno Hesap"
    android:textSize="15sp" />

<Button
    android:id="@+id/dnoHesap"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/gnoHesap"
    android:layout_toLeftOf="@+id/yeniNot"
    android:text="Dno Hesap"
    android:textSize="15sp" /> 
```

# php - 使用 php 分页的 Facebook API 列表收件箱

> ID：14308834
> 
> 赞同：0
> 
> 时间：2013-01-13T22:17:18.970
> 
> 标签：php, facebook, api, list, inbox

我想要通过 Facebook API-PHP 列出的 facebook 消息列表。我用php写了一个代码，我写了代码；

```
 // Facebook App Connection   
     $facebook = new Facebook(array(
          'appId'  => 'xxxxxxxxxxxx',
          'secret' => 'xxxxxxxxxxxxxxxxxxxxxxxxx',
        ));
     $user = $facebook->getUser();
     if($user) {
      try 
      {
            $params = array(
                  'fields' => 'inbox',
                  );
        $user_profile = $facebook->api('/me',$params);
      } 
      catch (FacebookApiException $e) 
      {
        error_log($e);
        $user = null;
      }
     } 

    print_r($user_profile);
    /* Output:
Array
(
    [id] => xxxxxxxxxx
    [inbox] => Array
        (
            [data] => Array
                (
                    [0] => Array
                        (
                            [id] => xxxxxxxxxxxxxx
                            [to] => Array
                                (
                                    [data] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [name] => John Doe
                                                    [id] => xxxxxxxxxx
                                                )

                                            [1] => Array
                                                (
                                                    [name] => Jane Doe
                                                    [id] => xxxxxxxxxx
                                                )

                                        )

                                )

                            [updated_time] => 2013-01-13T21:33:34+0000
                            [unread] => 2
                            [unseen] => 1
                            [comments] => Array
                                (
                                    [data] => Array
                                        (
                                            [0] => Array
                                                (
                                                    [id] => xxxxxxxxxxxxxx_xxxx 
                                                    [from] => Array
                                                        (
                                                            [name] => Jane Doe
                                                            [id] => xxxxxxxxxx
                                                        )

                                                    [message] => Hi!
                                                    [created_time] => 2013-01-13T19:15:49+0000
                                                )

                                            [1] => Array
                                                (
                                                    [id] => xxxxxxxxxxxxxx_xxxx 
                                                    [from] => Array
                                                        (
                                                            [name] => John Doe
                                                            [id] => xxxxxxxxxx
                                                        )

                                                    [message] => Hi,How are you?
                                                    [created_time] => 2013-01-13T19:15:54+0000
                                                )

                                            [2] => Array
                                                (
                                                    [id] => xxxxxxxxxxxxxx_xxxx 
                                                    [from] => Array
                                                        (
                                                            [name] => Jane Doe
                                                            [id] => xxxxxxxxxx
                                                        )

                                                    [message] => Fine but have a problem facebook api
                                                    [created_time] => 2013-01-13T19:16:03+0000
                                                )

                                            [3] => Array
                                                (
                                                    [id] => xxxxxxxxxxxxxx_xxxx 
                                                    [from] => Array
                                                        (
                                                            [name] => John Doe
                                                            [id] => xxxxxxxxxx
                                                        )

                                                    [message] => what problem?
                                                    [created_time] => 2013-01-13T19:16:25+0000
                                                )

                                            [4] => Array
                                                (
                                                    [id] => xxxxxxxxxxxxxx_xxxx
                                                    [from] => Array
                                                        (
                                                            [name] => Jane Doe
                                                            [id] => xxxxxxxxxx
                                                        )

                                                    [message] => not list all messages in inbox
                                                    [created_time] => 2013-01-13T21:04:37+0000
                                                )

                                            [5] => Array
                                                (
                                                    [id] => xxxxxxxxxxxxxx_xxxx
                                                    [from] => Array
                                                        (
                                                            [name] => John Doe
                                                            [id] => xxxxxxxxxx
                                                        )

                                                    [message] => I can't help
                                                    [created_time] => 2013-01-13T21:04:40+0000
                                                )
.bla
.bla
.bla
.bla
.bla
.bla
                                            [24] => Array
                                                (
                                                    [id] => xxxxxxxxxxxxxx_xxxx 
                                                    [from] => Array
                                                        (
                                                            [name] => John Doe
                                                            [id] => xxxxxxxxxx
                                                        )

                                                    [message] => Okey,bye
                                                    [created_time] => 2013-01-13T21:33:34+0000
                                                )

                                        )

                                    [paging] => Array
                                        (
                                            [previous] => https://graph.facebook.com/377285305670598/comments?limit=25&since=1358112814&__paging_token=377285305670598_2394&__previous=1
                                            [next] => https://graph.facebook.com/377285305670598/comments?limit=25&until=1358104549&__paging_token=377285305670598_2370
                                        )

                                )

                        )

    */ 
```

**我要输出；**
简·多伊：嗨！
约翰·多伊：嗨，你好吗？
Jane Doe：很好，但是有问题 facebook api
John Doe：什么问题？
Jane Doe：未列出收件箱中的所有消息
John Doe：我无法帮助
John Doe：Okey，再见

**我写了代码；**

```
 for($i=0; $i <= 5; $i++){
        foreach($data  as $a):
      foreach($a[$i] as $id  => $to):
         foreach($to as $data):
        foreach($data as $key => $value):
            echo $value["name"]."=>".$value["message"];
        endforeach;
          endforeach;
       endforeach;
     endforeach;
    endforeach; 
  echo "<br/>"; 
```

**我的结果；**
Jane Doe=>
John Doe=>
=>嗨！
=>嗨，你好吗？
=>很好，但是facebook api有问题
=>什么问题？
=>不列出收件箱中的所有消息
=>我忍不住
...bla
...bla
...bla
=>我忍不住
h=>h
h=>h

我想查看所有消息和发件人姓名。我尝试过了;
1- 获取下一个 url 和 file_get_content($url); - 不工作。
2- 设置限制和偏移量 - 不起作用
如何编写代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:02:13.127

我想这就是你想要的。

```
foreach($user_profile as $main){
foreach($main as $a){
foreach($a as $b){
foreach($b as $c){
foreach($c as $d){
foreach($d as $e){
if(strlen($e["name"]) > 1){
echo "<b>".$e["name"].":</b>";
}
}
echo $d["message"]."</br>\n";
}
}
}
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T07:06:22.050

这将对您有所帮助。

```
<h1>Inbox Start</h1>

  <?php

    $inbox = $user_profile["inbox"]["data"];

    foreach ($inbox as $data){ ?>

        <h3>To: </h3>

        <?php
        foreach ($data["to"]["data"] as $to){
        ?>
            <a href="http://www.facebook.com/<?php echo $to["id"]?>" target="_blank"><?php echo $to["name"]?></a> &nbsp; 
        <?php
        }
        ?>
        <h3>Last Reply: </h3>
        <?php echo date("d M, Y H:i:s",strtotime($data["updated_time"]))?>

        <h3>Message Read: </h3>
        <?php if($data["unread"]==1){ echo "Unread";}else { echo "Read";}?>

        <h3>Message Seen: </h3>
        <?php if($data["unseen"]==1){ echo "Unseen";}else { echo "Seen";}?>

        <h3>Comment: </h3>
        <?php
        $comments = $data["comments"]["data"];
        foreach ($comments as $comment){
        ?>

            <div>
                <div style="float:left; width:50px;">
                    <img src="https://graph.facebook.com/<?php echo $comment['from']['id']?>/picture?width=50&height=50" />
                </div>
                <div style="float:left; margin-left:10px;">
                    <strong style="color: #AF2D2D;"> <?php echo $comment['from']['name']?></strong> <br />
                    <p style="color: gray !important;"><?php echo date("d M, Y H:i:s",strtotime($comment["created_time"]));?></p>
                </div>

                <div style="clear:both; margin-bottom:10px;"></div>
                <div style="width:500px; color: #AF2D2D;">
                    <?php echo $comment['message'] ?>

                </div>    

             </div>

        <?php
        }
        ?>

        <hr><bR>

<?php   
    }
  ?> 
```

# c# - createprocess中的Process.arguments？

> ID：14308836
> 
> 赞同：1
> 
> 时间：2013-01-13T22:17:27.333
> 
> 标签：c#, createprocess

以下在 process.start 情况下工作得很好。

```
private string Path()
        {
            RegistryKey Key = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Wizet\\");
            RegistryKey Location = Key.OpenSubKey("MapleStory");
            return Location.GetValue("ExecPath").ToString();
        }

public bool Launch()
        {
            maplestory = new ProcessStartInfo();
            maplestory.FileName = Path() + @"\MapleStory.exe";
            maplestory.Arguments = "WebStart";

            MapleStory = Process.Start(maplestory);
} 
```

如果我要使用 CreateProcess，我现在应该在哪里放置“.Arguments”，以及在哪里放置 CREATE_SUSPENDED？

```
CreateProcess(AppName, IntPtr.Zero, IntPtr.Zero, IntPtr.Zero, false, 0, IntPtr.Zero, null, ref si, out pi); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:22:45.407

```
public struct PROCESS_INFORMATION
{
    public IntPtr hProcess;
    public IntPtr hThread;
    public uint dwProcessId;
    public uint dwThreadId;
}

public struct STARTUPINFO
{
    public uint cb;
    public string lpReserved;
    public string lpDesktop;
    public string lpTitle;
    public uint dwX;
    public uint dwY;
    public uint dwXSize;
    public uint dwYSize;
    public uint dwXCountChars;
    public uint dwYCountChars;
    public uint dwFillAttribute;
    public uint dwFlags;
    public short wShowWindow;
    public short cbReserved2;
    public IntPtr lpReserved2;
    public IntPtr hStdInput;
    public IntPtr hStdOutput;
    public IntPtr hStdError;
}

public struct SECURITY_ATTRIBUTES
{
    public int length;
    public IntPtr lpSecurityDescriptor;
    public bool bInheritHandle;
}

using System;
using System.Diagnostics;
using System.Runtime.InteropServices;

namespace CreateProcess
{
    public static void Main()
    {
        PROCESS_INFORMATION pi = new PROCESS_INFORMATION();
        STARTUPINFO si = new STARTUPINFO();

        CreateProcess("MapleStory.exe", "WebStart", IntPtr.Zero, IntPtr.Zero, false, 0, IntPtr.Zero, null, ref si, out pi);
    }

    [DllImport("Kernel32.dll")]
    private static extern bool CreateProcess(string lpApplicationName, string lpCommandLine, IntPtr lpProcessAttributes, IntPtr lpThreadAttributes, bool bInheritHandles, uint dwCreationFlags, IntPtr lpEnvironment, string lpCurrentDirectory, ref STARTUPINFO lpStartupInfo,out PROCESS_INFORMATION lpProcessInformation);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:25:02.613

在第二个参数中，您可以放置​​命令行选项。在第六个中，您可以放置​​创建选项，如 CREATE_SUSPENDED。

`CreateProcess(AppName, "WebStart", IntPtr.Zero, IntPtr.Zero, false, CREATE_SUSPENDED, IntPtr.Zero, null, ref si, out pi);`

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/windows/desktop/ms682425(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682425(v=vs.85).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T22:20:27.587

```
CreateProcess(AppName, "WebStart", IntPtr.Zero, IntPtr.Zero, false, 0, IntPtr.Zero, null, ref si, out pi); 
```

# php - 从具有关系的多个表中选择数据

> ID：14308839
> 
> 赞同：3
> 
> 时间：2013-01-13T22:17:49.297
> 
> 标签：php, sql, relational-database, multiple-tables

你们过去都提供了很大的帮助，而我正在努力解决一些问题，所以我有一个问题。

我的 SQL 数据库中有 3 个表，分别称为“孩子”、“父母”和“家庭”。表的结构如下所示。

![在此处输入图像描述](../Images/b5091b188af058a82616a8fb06de2ad5.png)

这里分别是父母、孩子和家庭表中的一些示例数据。 ![父母表](../Images/141f00cf8167aa72cd47dbdc097fa4fe.png) ![子表](../Images/782146ca6466124010477071efcf338f.png) ![家庭表](../Images/f818c807d2451b2aa96314c224b7cae5.png)

Family.ChildID 与 Child 表中的 ID 对应，因此 Child.ID 是主键，Family.ChildID 是外键。这同样适用于 Family.ParentID 和 parents.ID

我要做的是选择子表和父表中的所有字段，然后选择家庭表中的“关系”字段。但是条件是我提供了 ChildID，并且我想通过匹配家庭表中的子 ID 和父 ID 来选择相应的父代。

例子：

```
SELECT * 
FROM Parents, Child, Family 
WHERE (Child.ID = 1 AND (Family.ChildID = 1 AND Parents.ID = Family.ParentID) 
```

我希望这是有道理的。如果您有任何问题，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:22:13.680

您想使用 JOIN 将表链接在一起。您需要将子表连接到家庭表，并将家庭表连接到父表。就像是：

```
Select c.*, p.*, f.relation from child c
    Left Join family f on f.child_id = c.id
    Left Join parent p on f.parent_id = p.id
    Where c.id = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:30:02.353

尝试这个：

```
SELECT Parents.*, Child.*, Relation
FROM FAMILY
INNER JOIN Parents ON Family.ParentID = Parents.ID
INNER JOIN Child ON Family.ChildID = Child.ID 
```

您可能需要使用`LEFT OUTER JOIN`而不是`INNER`.

# c# - 如何从wpf中的文件夹路径获取图像

> ID：14308846
> 
> 赞同：3
> 
> 时间：2013-01-13T22:18:50.223
> 
> 标签：c#, wpf, path

我正在尝试了解如何从我正在使用 Visual Studio 2010 的项目中获取文件，并且我的 wpf 项目中有一个名为：Images 的文件夹

如何从该文件夹中获取图像，我正在尝试：

```
return @"/Images/"+ name+".jpg"; 
```

它自己所在的文件夹： `C:\Users\Boaz-Pc\Documents\Visual Studio 2010\Projects\FinalSadna\FinalSadna\Images`

但这对我不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-13T22:23:04.610

你可以看看这样的东西

```
string imageName = name + ".jpg";
var path = Path.Combine(GetApplicationFolder(), "/Images/" + imageName); 
```

如果您想通过大会找到它，您也可以使用以下内容

```
var path = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T23:28:14.223

关于什么

```
var uriSource = new Uri(@"/FinalSadna;component/imagename.png", UriKind.Relative); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-13T22:23:54.807

我认为您的问题是相对路径，至少从我们可以看到的代码来看，是相对于输出 exe 文件的。我怀疑这个文件夹是 bin>debug 还是 bin>release。因此，您需要返回一定数量的目录（希望）。[这篇](http://www.boogiejack.com/server_paths.html)文章很好地解释了相对路径。

**编辑：**

除非您启用了自定义编译选项，否则您将错误地引用相对路径。请看一下上面的链接。

希望这对你有帮助！

# c# - c# WCF UPNP映射路由器配置

> ID：14308847
> 
> 赞同：0
> 
> 时间：2013-01-13T22:19:08.250
> 
> 标签：c#, wcf, ip, router, upnp

我已经编写了 ac# 代码，通过 Upnp 将端口映射到我的路由器，以使 WCF 服务可以访问互联网

upnp 脚本在这里

```
 object[] loObj = new object[] { "", port, "TCP", port, adresse_ip, true, "Custom Mapping", 0 };
                    lsService.InvokeAction("AddPortMapping", loObj); 
```

入港是 87，出港也是 87

映射在我的 Netgear DGN1000 上成功注册（我可以在 upnp 表中看到它）

```
Actif   Protocole   Port Interne    Port Externe    Adresse IP
YES     TCP       87                  87              192.168.0.12 
```

我可以通过 localhst:87/servicemodelsamples/service 和 192.168.0.12:87/servicemodelsamples/service 访问我的网络服务

但是您无法通过 MY_PUBLIC_IP:87/servicemodelsamples/service 访问。

我已停用 Windows 8 防火墙

当我使用我在路由器中创建的手动规则时，我可以工作，但是通过 upnp 神经网络

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:29:36.280

请注意，端口映射并不意味着该端口上的入站流量也被允许。

端口 87 低于 1000。默认情况下，某些（较旧的）路由器会阻止到端口 < 1000 的入站流量，无论开发计划署如何

检查路由器上的规则以允许端口 87 上的入站流量 (udp/tcp)

# python - 无法从 virtualenv 导入包

> ID：14308862
> 
> 赞同：0
> 
> 时间：2013-01-13T22:21:08.140
> 
> 标签：python, virtualenv

我的项目中有一个导入包（flask_mail）的单行脚本。我在 virtualenv 中运行它。如果我执行`python script.py`我得到`ImportError: No module named flask_mail`. 如果在同一个文件夹中，激活了相同的 virtualenv，我打开 python 控制台并从我的`script.py`文件 ( `import flask_mail`) 中运行相同的命令，我不会收到任何错误。

Virtualenv 是使用以下命令创建的：`virtualenv venv`然后激活`source venv/bin/activate`

我在这里做错了什么？

# r - 向数据框添加新列的函数

> ID：14308871
> 
> 赞同：4
> 
> 时间：2013-01-13T22:21:44.640
> 
> 标签：r

我需要一个向数据框添加新列（具有常量值）的函数`df`。到目前为止，我的尝试是这样的：

```
f = function(df, col.name, col.value){
  df$col.name = col.value
  print(df)
 } 
```

典型的输入是：

```
f(df, "New column", NA) 
```

这会给我一个值为 NA 的新列，但是，它将被命名为`col.name`.

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-13T22:59:19.233

R 为这类事情提供了内置函数，即`$<-`用于分配单列数据。

```
> test <- data.frame(a=1:3,b=4:6)

> test
  a b
1 1 4
2 2 5
3 3 6

> `$<-`(test,"new_column",NA)
  a b new_column
1 1 4         NA
2 2 5         NA
3 3 6         NA 
```

正如@MatthewLundberg 在下面的评论中所说，如果您想避免使用时髦的函数名称，可以将其分配给您的新函数：

```
> f <- `$<-`
> f(test,"new_column",NA)
  a b new_column
1 1 4         NA
2 2 5         NA
3 3 6         NA 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-13T22:27:06.177

```
f = function(df, col.name, col.value){
  df[[col.name]] <- col.value
  print(df)
 } 
```

如果您想容纳@flodel 和@theodore 的评论，您可以使用以下内容：

```
f <- function(df, col.name, col.value, overwrite = FALSE){

    if ( col.name %in colnames(df) ) {
        if ( overwrite ) {
            warning(paste("column", col.name, "overwritten!"))
        } else {
            stop(paste("column", col.name, "already exists!"))
        }
    }

    df[[col.name]] <- col.value 
    return(df)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-08T17:06:09.383

如果您知道新列的名称，您可以这样做：

```
test <- data.frame(a=1:3,b=4:6)
test$c = c(1:3) 
```

# c++ - 从（x，y）位置C ++计算网格线

> ID：14308875
> 
> 赞同：0
> 
> 时间：2013-01-13T22:22:32.507
> 
> 标签：c++, coordinate-systems

我有一个数组 [15] [15] 和我的对象的路径。0 是墙，其他任何东西都是路径（1->2->3->...->end）。它是 450px x 450px（30px x 30px 是一个场）的游戏场的反映。

对于 array[15][15] 看起来像这样：

> 0800000亿
> 010111011101110
> 010101010101010
> 010101010101010
> 010101010101010
> 010101010101010
> 010101010101010
> 010101010101010
> 010101010101010
> 010101010101010
> 010101010101010
> 010101010101010
> 010101010101010
> 011101110111010
> 000000000000090

我得到： ![地图2](../Images/20ca545609d54a8b842144f24e16851e.png)

我的物体以某种速度*速度移动：

```
void Enemy::move()
{
    this->get_dir();
    this->x += this->velX * this->speed; // velX = -1 is left, 1 is right
    this->y += this->velY * this->speed; // velY = -1 is up, 1 is down
} 
```

get_dir() 检查它应该设置的方向（速度），如下所示：

```
void Enemy::get_dir()
{  
    Point p; // {x, y} struct

    p = this->get_grid(); // it tries to calculate X, Y axis into an array number
    if (p.y < 14 && path_grid[p.y + 1][p.x] - 1 == path_grid[p.y][p.x])
    {
        this->velY = 1;
        this->velX = 0;
        return;
    }
    /* same goes for rest of directions */

    this->velX = this->velY = 0; // if none matched it stops (reached end)
    return;
}

Point Enemy::get_grid()
{
    int x, y;

    for(y = 0;y < 15;y++)
    {
        if (this -> y >= y * 30 && this->y < (y + 1) * 30) break;
    }

    for(x = 0;x < 15;x++)
    {
        if (this -> x >= x * 30 && this->x < (x + 1) * 30) break;
    }

    return make_point(x, y);
} 
```

但是您可能会注意到，这将导致我的对象遵循如下路径： ![小路](../Images/22451258d8c9c1178fb49d006c568ce4.png)

因为它检查左上角，如果我向右移动它应该改变原点，但我不知道该怎么做。当我尝试添加 30（对象位图大小）时，如果它正确，它会停在上 -> 右角。这里有什么解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:54:47.797

删除了我的大部分答案，因为它似乎误解了这个问题。但我会留下这部分关于你的`get_grid`功能很疯狂。只需使用数学（我假设`x`和`y`是整数）：

```
Point Enemy::get_grid()
{
    return make_point(x / 30, y / 30);
} 
```

此外，如果您想获取网格位置并将其显示在每个 30 像素正方形的图块的中心，请执行以下操作：

```
int pixelX = gridX * 30 + 15;
int pixelY = gridY * 30 + 15; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T23:27:42.133

您应该能够从网格中找到下一个未平仓头寸，但应该跟踪最后一步，这样您就不会回溯，例如：

```
void movePlayer(){
  const GridMap& gridMap = getGridMap(); //returns the 14x14 grid
  const Position& currentPosition = getCurrentPosition(); //returns the current player position
  const Position& previousPosition = _getPreviousPosition(); //private helper func
  //returns a list of position where the current player at the given position can move to

  //at point (x,y) you can move to NORTH,SOUTH,EAST, or WEST one unit, from the gridMap
  //using the currentPosition, return the list of cells that the player at the given position can move to.
  const PositionList& currentMovablePositions = _getMovablePosition(currentPosition,gridMap);
  //return the first matching position that isn't currentPosition or previousPosition
  const Position& nextMovePosition = _getNextMovablePosition(currentMovablePosition,currentPosition,previousPosition);

  this->animateTo( nextMovePosition ); 
```

}

# android - Eclipse Indigo 更新错误

> ID：14308880
> 
> 赞同：1
> 
> 时间：2013-01-13T22:22:45.747
> 
> 标签：android, eclipse, installation, text-editor

亲爱的朋友们，我想请你们帮忙解决坏掉的 Eclipse Indigo 3.8。我已将 Eclipse Indigo 从 3.7 升级到 3.8 并通过“ `Help - Install new software item`”安装 ADT 21。

现在 Eclipse 中的编辑器在升级后不起作用。我无法查看任何文件的内容。当我尝试打开某些东西时，只显示错误消息：

```
Problem Occurred:

An error has occurred. See error log for more details.
org.eclipse.swt.custom.StyledText.getScrollbarsMode()I 
```

我还注意到，更新后菜单“窗口”中的“Android SDK 管理器”和“Android 虚拟设备管理器”项丢失了。

因为我很长时间没有找到解决方案，所以我在此期间进行了第二次安装 Eclipse。我已经从[eclipse.org/downloads](http://www.eclipse.org/downloads/packages/release/indigo/sr2)链接下载了新的 Eclipse Indigo。然后我进行了新的 SDK 安装并将项目从旧的 Eclipse 工作区导入到新的 Eclipse 工作区（使用 File - Import - Existing Projects Into Workspace）。然后我不得不去“项目属性”-“Java 编译器”-“启用项目特定设置”+“编译器合规级别 1.6”，它适用于新安装。这是我目前的解决方案。

请问您知道这个错误是什么意思以及解决这个问题的方法吗？这是否意味着我应该升级任何组件或重新下载 Eclipse 的任何部分？

# java - 随机数生成器验证

> ID：14308881
> 
> 赞同：-2
> 
> 时间：2013-01-13T22:22:55.723
> 
> 标签：java

我创建了一个随机数生成器，它根据数组的大小选择一个随机数。

我只是希望有人来验证我所做的是否正确。

```
ArrayList<String> textArray = new ArrayList<String>();

textArray.add("hi");
textArray.add("yo");
textArray.add("no");
textArray.add("kool");

int randomNo = 0;
int Min = 0;

for (int i = 0; i < textArray.size(); i++) {
    randomNo = Min + (int)(Math.random() * ((textArray.size() - Min) ));
}

System.out.println(randomNo); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:26:40.503

我没有验证您的代码，也不知道您*实际上*要做什么，但这似乎更简单。

```
Random random = new Random();
randomNo = min + random.nextInt(textArray.size()); 
```

`randomNo`将具有 和 之间的值`min`，`min + textArray.size()-1`包括在内。

阅读更多关于[`java.util.Random`](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html).

# javascript - Google Maps API v3：从数组中添加标记不起作用

> ID：14308884
> 
> 赞同：2
> 
> 时间：2013-01-13T22:23:24.863
> 
> 标签：javascript, api, google-maps

首先感谢您考虑回答这个问题:) 非常感谢！

我使用以下代码创建了一个地图，并且效果很好。

```
 function initialize() {

          var mapOptions = {
          zoom: 5,
          center: new google.maps.LatLng(48.160, -6.832),
          disableDefaultUI: true,
          mapTypeId: google.maps.MapTypeId.ROADMAP
          };

           map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);
  setMarkers(map, cities);
 } 
```

但是我想在这个数组中的每个城市都有标记（请不要建议更改它，因为这段确切的代码解决了我遇到的另一个问题，除非当然绝对必要）：

```
 var cities = {
   'Groningen':  [ 53.216723950863425, 6.560211181640625, 7],
    'San Francisco': [ 34.01131647557699, -118.25599389648437, 5],
    'New York City': [ 40.7143528, -74.0059731, 3]

 }; 
```

我正在使用这段代码来放置实际的标记（这是不起作用的部分）：

```
 function setMarkers(map, locations) {
   // Add markers to the map

  for (var i = 0; i < cities.length; i++) {
          var data = cities [i]
          var marker = new google.maps.Marker({
              position: new google.maps.LatLng (data[0], data[1]),
              map: map,
              icon: image,
              title: 'test',
          });
      }
 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-13T22:30:12.273

`cities`不是数组而是对象，所以你不能使用

```
for (var i = 0; i < cities.length; i++) {
    //...
} 
```

改用这个

```
for (var key in cities) {
    var data = cities[key];
    var marker = new google.maps.Marker({
        position: new google.maps.LatLng (data[0], data[1]),
        map: map,
        icon: image,
        title: 'test',
    });
} 
```

# python - 如何为大型 python 数组节省内存？

> ID：14308889
> 
> 赞同：0
> 
> 时间：2013-01-13T22:23:56.560
> 
> 标签：python, arrays

我使用具有 12 G ram 的 window7 64 位操作系统机器从 csv 文件（20332 * 17009）中读取了一个大型 python 数组。该数组在一半的位置具有值，如下例所示。我只需要具有分析值的数组，而不是整个数组。

[0 0 0 0 0 0

0 0 0 3 8 0

0 4 2 7 0 0

0 0 5 2 0 0

0 0 1 0 0 0]

我想知道：是否可以忽略 0 值进行分析并节省更多内存？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T00:42:07.607

鉴于您的描述，稀疏表示可能对您不是很有用。但是，还有许多其他选择：

1.  确保使用尽可能小的数据类型来表示您的值。您上面显示的示例最好表示为单字节整数。读入 numpy 数组或 python 数组将使您能够很好地控制数据类型。

2.  您可以通过一次仅读取部分数据来交换内存以换取性能。如果您将整个数据集重写为二进制而不是 CSV，那么您可以使用 mmap 来访问该文件，就好像它已经在内存中一样（这也可以加快读写速度）。

3.  如果您真的需要内存中的整个数据集（而且它确实不适合），那么可能需要进行某种压缩。稀疏矩阵是一种选择（正如 larsmans 在评论中提到的，scipy 和 pandas 都有稀疏矩阵实现），但这些只有在零值条目的比例很大时才有帮助。更好的压缩选项将取决于数据的性质。考虑将数组分解成块并使用 RLE、SZIP 等快速压缩算法压缩这些块。

# javascript - 将 div 从 x,y 滑动到 x,y？

> ID：14308892
> 
> 赞同：0
> 
> 时间：2013-01-13T22:24:25.053
> 
> 标签：javascript, jquery

当有人在我的虚拟游戏中点击我的字段时，我会得到我当前的左侧和顶部坐标：

```
 function moveDiv(fromSeat, toSeat){
    var fromTop  = $('#seat-' + fromSeat).css("top");
    var fromLeft = $('#seat-' + fromSeat).css("left");

    var toTop  = $('#seat-' + toSeat).css("top");
    var toLeft = $('#seat-' + toSeat).css("left");

    /** Move a div from point {"fromTop", "fromLeft"} => {"toTop", "topLeft"} **/
  } 
```

我被困在这里，我试图制作一个 $('...').animate({}); 但无法让它工作。我希望 div "#test" 从点 {"fromTop", "fromLeft"} => {"toTop", "topLeft"} 移动

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:42:51.910

您可能需要添加顶部值并添加左侧值并使用总计进行动画处理

```
function moveDiv(fromSeat, toSeat){
    var fromTop  = $('#seat-' + fromSeat).css("top");
    var fromLeft = $('#seat-' + fromSeat).css("left");

    var toTop  = $('#seat-' + toSeat).css("top");
    var toLeft = $('#seat-' + toSeat).css("left");

     var position={ top: fromTop+ toTop, left: fromLeft+toLeft}

     $('#seat-' + fromSeat).animate( position);

  } 
```

**编辑：**需要将值从包含的字符串转换`px`为数字以添加它们。可以`parseInt()`用来做

# python - Django：通过外键查询获取 User.usernames

> ID：14308893
> 
> 赞同：5
> 
> 时间：2013-01-13T22:24:33.157
> 
> 标签：python, django, django-models, foreign-keys

考虑下面的友谊模型，对于每一个建立的友谊，都有一个*发送*朋友请求的用户和一个*接收*朋友请求的用户：

```
from django.contrib.auth.models import User

class Friendship(models.Model):
    sender = models.ForeignKey(User)
    receiver = models.ForeignKey(User) 
```

我将如何构建一个查询，该查询将为我提供与 user123 建立友谊的用户的所有***用户名？***

请记住，user123 可能是他所在的任何友谊的发送者或接收者。

另外，我只希望返回 User.username 值，而不是整个 User 对象。

* * *

到目前为止，我有这个笨重的半/解决方案（我正在使用`list()`这样我可以添加 user123 的*接收朋友*和 user123 的*发送朋友*，最终生成所有朋友的列表）。问题是，我得到了所有的用户对象，我只想要用户名......而且必须有更好的方法来做到这一点。

```
friends_a = list(Friendship.objects.filter(sender=user123).values('receiver'))
friends_b = list(Friendship.objects.filter(receiver=user123).values('sender'))
friends_a = [] if not friends_a else friends_a[0].values()
friends_b = [] if not friends_b else friends_b[0].values()
all_friends = friends_a + friends_b 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-13T22:29:06.990

[用于复杂查找的 Q 对象。](https://docs.djangoproject.com/en/dev/topics/db/queries/#complex-lookups-with-q-objects)

哇，由于实际上有 2 个不同的逻辑查询，因此获得您想要的结果集令人惊讶。最简单的方法是……用python拼出来。

```
user = User.objects.get(username='user123')
friendships = Friendship.objects.filter(Q(receiver=user) | Q(sender=user))

usernames = []

for friendship in friendships:
    if friendship.receiver == user:
        usernames.append(friendship.receiver.username)
    else:
        usernames.append(friendship.sender.username) 
```

# python - 我应该使用哪种方法？

> ID：14308896
> 
> 赞同：-1
> 
> 时间：2013-01-13T22:24:41.447
> 
> 标签：python, class, methods

```
>>> class StrictList(list):
...     def __init__(self,content=None):
...         if not content:
...             self.content = []
...             self.type = None
...         else:
...             content = list(content)
...             cc = content[0].__class__
...             if l_any(lambda x: x.__class__ != cc, content):
...                 raise Exception("List items must be of the same type")
...             else:
...                 self.content = content
...                 self.type = cc
... 
>>> x = StrictList([1,2,3,4,5])
>>> x
[]
>>> x.content
[1, 2, 3, 4, 5] 
```

我希望能够在调用`x`not时返回内容`x.content`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:33:50.907

您正在尝试子类`list`化，但从不调用 list`__init__`方法。添加这个：

```
super(StrictList, self).__init__(content) 
```

将项目添加到自己。无需分配给`self.content`：

```
>>> class StrictList(list):
...     def __init__(self,content=None):
...         super(StrictList, self).__init__(content)
... 
>>> s = StrictList([1, 2, 3])
>>> len(s)
3
>>> s[0]
1 
```

# ios - 当设备旋转时，如何为视图设置正确的边界？

> ID：14308903
> 
> 赞同：1
> 
> 时间：2013-01-13T22:25:24.553
> 
> 标签：ios, objective-c, cocoa-touch, uiview, uikit

我有一个以编程方式创建的 UIScrollView，我将它创建为它后面的 UIView 的大小。在`viewDidAppear`我基本上有：

```
UIScrollView *scrollView= [[UIScrollView alloc] initWithFrame:mainView.bounds];
//mainView being the UIView behind 
```

当设备旋转时，背景中的 UIView 自然会改变边界，变宽变短（尽管 x,y ≠ y,x）。

在我的`-(void)didRotateFromInterfaceOrientation:`我放了`NSLog(@"%@", NSStringFromCGRect(mainView.bounds));，并且mainView的边界已经切换，但是如果我这样做：

```
-(void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation
{
    scrollView.bounds = mainView.bounds;
    NSLog(@"%@", NSStringFromCGRect(scrollView.bounds));
    NSLog(@"%@", NSStringFromCGRect(mainView.bounds));
} 
```

它仍然显示错误.. NSLog 为两个视图记录了相同的边界，但在屏幕上 mainView 是正确的，并且 scrollView 似乎翻转了，好像 (0,0) 在主视图之外，并且尺寸错了..我是否必须重绘一些东西，还是我把所有这些都放在错误的地方？或者不是`.bounds`使用正确的变量？

**编辑**

我意识到更新框架与重新启动框架不同`initWithFrame:`，但我希望当前内容保持不变，以相同的方式..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:36:02.617

您需要设置滚动视图的框架而不是边界

```
scrollView.frame = mainView.bounds; 
```

或者更好的是，如果您设置了正确的自动调整大小蒙版/约束，它将自动调整大小。

# php - PHP复选框值 - 上传时插入文件名字段

> ID：14308906
> 
> 赞同：0
> 
> 时间：2013-01-13T22:25:36.113
> 
> 标签：php

对此的任何见解将不胜感激。基本上我有一个文件上传表单，用户可以一次上传 5 个文件。上传时，我添加了 3 个字母和一个时间戳。如果选中，我想将复选框值插入文件名：

```
 <form id="form" action="<?php echo $_SERVER['SCRIPT_NAME']; ?>" method="post" enctype="multipart/form-data">
<input name="file_up[]" type="file" class="file_up" size="16" maxlength=" " />
   CA<input name="state[]" type="checkbox" id="CA" value="CA" checked="checked" />
   NV<input name="state[]" type="checkbox" id="NV" value="NV" />
   UT<input name="state[]" type="checkbox" id="UT" value="UT" />
   AZ<input name="state[]" type="checkbox" id="AZ" value="AZ" />
<input name="file_up[]" type="file" class="file_up" size="16" maxlength=" " />
   CA<input name="state[]" type="checkbox" id="CA" value="CA" checked="checked" />
   NV<input name="state[]" type="checkbox" id="NV" value="NV" />
  UT<input name="state[]" type="checkbox" id="UT" value="UT" />
   AZ<input name="state[]" type="checkbox" id="AZ" value="AZ" /> 
```

对于每个文件字段上传，有 5 个这样的块。其他 3 个有 state2[] 等。

在文件名部分：

```
$updir . '/'.'337-'.implode("", $_POST['state']).$timestamp. $nume_f 
```

我怎样才能得到每一行的“状态”值？因此，如果在第一行选择 CA，只需将该 CA 添加到第一个文件，而不是其他文件。它没有分隔复选框行。我想也许可以将第二组复选框设置为 state1，然后设置为第三组 state2，等等。

文件循环是：

```
if (isset($_FILES['file_up'])) {
for($f=0; $f<count($_FILES['file_up']['name']); $f++)   {
$nume_f = $_FILES['file_up']['name'][$f]; 
```

感谢您在第 1 篇文章中的回复，这是第 3 次编辑。

想法？谢谢！——兰迪

```
EDIT:  The solution was to tie $f=0, $f=1, etc to a new variable:
 if($f == 0)$nume_g = ($_POST['state1']);
 if($f == 1)$nume_g = ($_POST['state2']); etc.. 
```

所以每个复选框组都与文件名相关联。感谢所有的投入，兰迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:29:29.407

代替

```
$_POST['state'] 
```

， 写

```
implode("", $_POST['state']). 
```

Implode 将数组字段合并为字符串，第一个参数作为分隔符。检查[http://php.net/manual/en/function.implode.php](http://php.net/manual/en/function.implode.php)

# html - HTML 图像不调整大小

> ID：14308907
> 
> 赞同：2
> 
> 时间：2013-01-13T22:25:39.647
> 
> 标签：html, css

我有大量可变大小的图像，可以上传或在数据库中找到。在不运行脚本来调整大小的情况下，有什么方法可以纯粹修改 HTML 或使用 CSS，这样我就不会扭曲和拉伸图像以匹配我分配的 300x200 尺寸，而是切掉我的 300x200 图像最初是大图片（例如 400x400）？

我当前的标记看起来像

```
<image data-src="holder.js/300x200" alt="300x200" style="width:300px; height:200px;" src={{ photo.source_descr }}> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T22:32:38.097

如果我正确理解了您的问题，您想使用 CSS/HTML 调整图像大小`height`，`width`有无拉伸图像。你想裁剪它。

我很确定您正在寻找[`clip`](https://developer.mozilla.org/en-US/docs/CSS/clip)CSS 中的属性。混合`clip`和`width`来`height`裁剪图像，使其不会被拉伸，但会被裁剪以适合所需的`width`和`height`。[阅读更多关于`clip`这里。](https://developer.mozilla.org/en-US/docs/CSS/clip)

* * *

这是您根据需要请求的额外代码（请注意，它使用 jQuery，因此您需要嵌入的代码才能工作）：

```
<style>
.container     { position: relative; overflow: hidden; }
.container img { position: absolute; }
</style>

<div class="container">
    <img src="..."/>
</div>

<script type="text/javascript">
$image = $('.container img');
width = $image.width();
height = $image.height();

$image.css({
    left: 0 - (width / 2),
    top: 0 - (height / 2)
});
</script> 
```

请注意，我从这个问题中得到了第二个脚本：[Cropping images from center on the fly](https://stackoverflow.com/questions/4712950/cropping-images-from-center-on-the-fly-javascript)。

# c++ - Eclipse Ubuntu 上的标准库

> ID：14308908
> 
> 赞同：0
> 
> 时间：2013-01-13T22:25:44.510
> 
> 标签：c++, eclipse, std

我在 Ubuntu 上有 stack eclipse 来开发一个 c++ 项目。我的问题是，当我想用​​ Eclipse 开发 C++ 代码时，Eclipse 无法识别我的 C++ 代码；

```
using namespace std;
cin
cout 
```

我说“std”无法解决。

我在互联网上进行了研究，但我无法解决问题。我应该怎么做才能解决我的问题？

注意：我的eclipse版本是版本：3.8.0
操作系统Ubuntu 12.10

# scala - Scala中抽象类型参数的隐式转换

> ID：14308911
> 
> 赞同：4
> 
> 时间：2013-01-13T22:26:01.187
> 
> 标签：scala, playframework, playframework-2.0

我是 Scala 的新手，正在探索隐式转换和著名的蛋糕模式的可能性。我尝试创建将 id 值列为抽象类型的模型类，以避免泄漏实现细节。我还将它混合到蛋糕图案特征包装中。一切正常，除了从 id 到 JSON 的隐式转换（在 Play 框架内）。无论我做什么，Scala 编译器都找不到隐式转换。

这是重现该问题的代码：

```
import anorm._
import play.api.libs.json._

trait Card {
  type Key
  val NoId: Key
  val id: Key
  val name: String
}

trait CardModelComponent {
  val cardModel: CardModel
  trait CardModel {
    def findById(id: Long): Option[Card]
    def findAll: Seq[Card]
    def delete(id: Long)
    def create(name: String): Option[Card]
  }
}

trait CardModelComponentImpl extends CardModelComponent {
  case class CardImpl(id: Pk[Long], name: String) extends Card {
    type Key = Pk[Long]

    object Key extends Writes[Key] {
      implicit def writes(key: Key): JsValue = {
        key match {
          case Id(idVal: Long) => JsNumber(idVal)
          case _ => JsNull
        }
      }
    }
    val NoId = NotAssigned
  }

  class CardModelImpl extends CardModel {
    def findById(id: Long): Option[Card] = { None }
    def findAll: Seq[Card] = { Seq(CardImpl(Id(1), "Some card"))}
    def delete(id: Long) {}
    def create(name: String): Option[Card] = { Some(CardImpl(Id(1), name)) }
  }
}

object ComponentsRegistry extends
CardModelComponentImpl {

  val cardModel = new CardModelImpl
}

val card = ComponentsRegistry.cardModel.create("Test card").get
Json.toJson(card.id) 
```

我得到的错误输出如下：

```
> card: Card = CardImpl(1,Test card)
> <console>:19: error: No Json deserializer found for type card.Key. Try to implem
  ent an implicit Writes or Format for this type.
                Json.toJson(card.id)
                           ^ 
```

有什么办法让它工作吗？看起来像蛋糕模式包装从编译器中隐藏了太多的类型信息，正如我从`card.Key`类型名称中猜测的那样。

我还尝试直接为 Pk 创建 Writer 实现，结果与错误相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T10:22:11.440

它`Writes[Key]`应该是隐式的实例，而不是`writes()`成员方法。隐式实例也必须在`toJson()`调用方法的范围内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T10:43:43.370

就像 Jesper Nordenberg 所写的那样，您必须将 Writes[Key] 的实例纳入范围。一种方法是要求 Card 的实现发布 Writer 实例，然后将其导入到您调用 toJson 的任何位置，如下所示：

...

```
trait Card {
  type Key

  val NoId: Key
  val id: Key
  val name: String
  implicit val Key: Writes[Key]
} 
```

...

```
trait CardModelComponentImpl extends CardModelComponent {
  case class CardImpl(id: Pk[Long], name: String) extends Card {
    type Key = Pk[Long]

    implicit object Key extends Writes[Key] {
      def writes(key: Key): JsValue = {
        key match {
          case Id(idVal: Long) => JsNumber(idVal)
          case _ => JsNull
        }
      }
    }

    val NoId = NotAssigned
  }

  class CardModelImpl extends CardModel {
    def findById(id: Long): Option[Card] = { None }
    def findAll: Seq[Card] = { Seq(CardImpl(Id(1), "Some card"))}
    def delete(id: Long) {}
    def create(name: String): Option[Card] = { Some(CardImpl(Id(1), name)) }
  }
} 
```

...

```
val card = ComponentsRegistry.cardModel.create("Test card").get
import card.Key
Json.toJson(card.id) 
```

或明确传递：

```
val card = ComponentsRegistry.cardModel.create("Test card").get
Json.toJson(card.id)(card.Key) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-14T10:58:00.037

我稍微修改了你的代码。我希望这对你有帮助。

```
package models
import anorm._
import play.api.libs.json._

trait Card[T] {
  val NoId: T
  val id: T
  val name: String
}

trait CardModelComponent[T] {
  val cardModel: CardModel
  trait CardModel {
    def findById(id: Long): Option[Card[T]]
    def findAll: Seq[Card[T]]
    def delete(id: Long)
    def create(name: String): Option[Card[T]]
  }
}

trait CardModelComponentImpl extends CardModelComponent[Pk[Long]] {
  type Key = Pk[Long]
  case class CardImpl(id: Key, name: String) extends Card[Key] {
    val NoId = NotAssigned
  }

  class CardModelImpl extends CardModel {
    def findById(id: Long): Option[Card[Key]] = { None }
    def findAll: Seq[Card[Key]] = { Seq(CardImpl(Id(1), "Some card"))}
    def delete(id: Long) {}
    def create(name: String): Option[Card[Key]] = { Some(CardImpl(Id(1), name)) }
  }
}

object ComponentsRegistry extends CardModelComponentImpl {
  val cardModel = new CardModelImpl
  implicit object KeyWrites extends Writes[Key] {
    def writes(key: Key): JsValue = {
      key match {
        case Id(idVal: Long) => JsNumber(idVal)
        case _ => JsNull
      }
    }
  }
} 
```

然后你可以像这样使用：

```
import models.ComponentsRegistry
import models.ComponentsRegistry.KeyWrites
val card = ComponentsRegistry.cardModel.create("Test card").get
Json.toJson(card.id) 
```

# css - 继承 CSS 属性会导致平板电脑布局出现问题？

> ID：14308913
> 
> 赞同：1
> 
> 时间：2013-01-13T22:26:11.947
> 
> 标签：css, layout, tablet, fluid-layout, inheritance

我已经为这个[网站](http://irishbaubles.com/)使用了 Dreamweaver Fluidlayout，但是我在尝试让索引页面上的平板电脑布局变成这样时遇到了[麻烦](http://i.imgur.com/D75rL.jpg)。

我目前在做什么。但我认为这是关于样式属性的继承。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:35:58.820

你应该删除 clear:both; 这使图标在单个垂直列中相互堆叠。并且也许减少宽度和左边距以允许它们排成两列。您可能需要考虑为这些元素使用一个类，因为它们都是 id，但使用相同的 css 属性。继承仅发生在印刷 css 样式中。

# java - 尝试使用 java 创建文本文件日志

> ID：14308918
> 
> 赞同：0
> 
> 时间：2013-01-13T22:27:13.893
> 
> 标签：java

我是编程新手并尝试创建日志文件。我编写的代码用于将消息和时间发送到文本文件。但每次我发送另一条消息时，它只会记录上一条消息。我想要一份消息和时间列表，而不是最新的。

```
public void run () {
        String message;
        try {
            while ((message = reader.readLine()) != null){
                System.out.println( "You voted " + message + " You the best") ;
                BufferedWriter out = new BufferedWriter(new FileWriter("test.txt"));
                out.append(message + "\n");
                TimeZone tz = TimeZone.getTimeZone("UTC"); // or PST, MID, etc ...
                Date now = new Date();
                DateFormat df = new SimpleDateFormat ("           yyyy.MM.dd hh:mm:ss ");
                df.setTimeZone(tz);
                String currentTime = df.format(now);
                String timeStamp = new SimpleDateFormat().format( new Date() ); 

                FileWriter aWriter = new FileWriter("test.txt", true);
                aWriter.write(currentTime + "   "  + "\n");
                aWriter.flush();
                aWriter.close();

                out.write(message);
                out.close();
                everyoneMessage(message);

            } // close while
            }catch(Exception ex) {ex .printStackTrace();}
        } // close run
    }// close inner class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:29:31.403

改变`BufferedWriter out = new BufferedWriter(new FileWriter("test.txt"));`

至

```
BufferedWriter out = new BufferedWriter(new FileWriter("test.txt", true)); 
               // true means append to the end of the file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:31:58.667

通过 log4j 最好地实践 java 的日志记录。作为后端 Java 程序员，我从来没有遇到过需要实现记录器而不使用 log4j 的情况。

你应该检查一下： http: [//logging.apache.org/log4j/1.2/](http://logging.apache.org/log4j/1.2/)

并在网上找到一些简单的教程。用简单的谷歌搜索有无数的。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T22:30:30.693

您正在`BufferedWriter`通过循环重新初始化。将该代码块移到循环之外。或者，您可以使用此构造`FileWriter`，[允许将文件附加到](http://docs.oracle.com/javase/7/docs/api/java/io/FileWriter.html#FileWriter%28java.io.File,%20boolean%29)：

```
BufferedWriter out = new BufferedWriter(new FileWriter("test.txt", true)); 
```

# c# - 了解 DBContext 更改是如何工作的，本地对象在其范围之外工作

> ID：14308922
> 
> 赞同：0
> 
> 时间：2013-01-13T22:27:55.623
> 
> 标签：c#, asp.net, asp.net-mvc-3

```
{
   public class EFProductRepository : IProductsRepository
    {
        private EFDbContext context = new EFDbContext();

        public IQueryable<Product> Products {
            get { return context.Products; }

        }

        public void SaveProduct(Product product)
        {
            if (product.ProductID == 0)
            {
                context.Products.Add(product);
            }
            else 
            {
               Product prod = context.Products.First(x => x.ProductID ==             product.ProductID);
                prod.Description = product.Description;
                prod.Category = product.Category;
                prod.Name = product.Name;
                prod.Price = product.Price;
            }

            context.SaveChanges();

        }

        public void DeleteProduct(Product product) {

            context.Products.Remove(product);
            context.SaveChanges();

        }

    }
} 
```

我对 ASP.NET 相当陌生，在做教程时，我无法理解保存到上下文的工作原理，特别是我的意思是这部分：

```
 else 
                {
                   Product prod = context.Products.First(x => x.ProductID ==             product.ProductID);
                    prod.Description = product.Description;
                    prod.Category = product.Category;
                    prod.Name = product.Name;
                    prod.Price = product.Price;
                }

                context.SaveChanges(); 
```

根据我对 OOP 的了解，在本地创建的对象仅存在于创建它的范围内。包含“产品产品”的更改值的“产品产品”如何与“上下文”相关联并成功保存变化？

此外，“context.SaveChanges()”调用如何工作，因为它不发送任何“产品”类型的参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T00:17:48.890

```
 {
               Product prod = context.Products.First(x => x.ProductID == ...
                prod.Description = product.Description;
                prod.Category = product.Category;
                prod.Name = product.Name;
                prod.Price = product.Price;
            } 
```

这是有效的，因为`prod`它是一个特定的项目`context`，它具有分配给它的唯一 ID，您可以更改除 ID 之外的其他属性 - 在此示例中的描述、类别、名称和价格，它从语境。上下文知道已对从中提取的对象进行了更改，因此`context.saveChanges()`可以正常工作。如果你要这样做：

```
 {
                Product prod = new Product()
                prod.Description = product.Description;
                prod.Category = product.Category;
                prod.Name = product.Name;
                prod.Price = product.Price;
            } 
```

那是行不通的，因为它不是从上下文中提取的对象。在这种情况下，必须完成插入，然后 saveChanges 如果这对您没有意义，我可能会解释更多

# javascript - 如何在openlayers中保存功能

> ID：14308934
> 
> 赞同：1
> 
> 时间：2013-01-13T22:29:40.320
> 
> 标签：javascript, openlayers, postgis

使用 openlayers，我想向矢量图层添加新功能，然后将该功能保存在 POSTGIS DB 中。我想使用 openlayers 下载附带的保存按钮来实现此功能。请提供一些示例代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T08:42:03.107

你读过[这个](http://www.gistutor.com/openlayers/22-advanced-openlayers-tutorials/47-openlayers-wfs-t-using-a-geoserver-hosted-postgis-layer.html)教程吗？它可以工作，但是这样你就需要在 openlayers 和 postgis 之间有一个地理服务器，我不知道没有地理服务器是否可能。

# c++ - 在 C++ 中查找字符串数组的大小

> ID：14308935
> 
> 赞同：25
> 
> 时间：2013-01-13T22:29:59.750
> 
> 标签：c++, arrays, c, sizeof

所以我有一个字符串数组。这是一个例子：

```
std::string array[] = {"Example", "Example2", "Example3"}; 
```

有什么办法可以找到像上面那样的数组中的元素数。我不能使用这种方法：

```
int numberofelements = sizeof(array)/sizeof(array[0]); 
```

这是因为元素的大小不同。还有其他方法吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-01-13T23:20:58.573

给定您的字符串数组，您当然可以使用`sizeof(array)/sizeof(array[0])`它来获取它的大小，并且以下程序可以正常工作：

```
int main()
{
    std::string array[] = { "S1", "S2", "S3" };
    std::cout << "A number of elements in array is: "
              << sizeof(array)/sizeof(array[0]) << '\n';
    foo(array);
} 
```

目前尚不清楚您所说的元素大小不同是什么意思。任何数组元素的大小在编译器时总是已知的，没有例外。

但是，在某些情况下上述方法不起作用。考虑以下示例：

```
void foo(std::string array[])
{
    std::cout << "A number of elements in array is: "
              << sizeof(array)/sizeof(array[0]) << '\n';
} 
```

上面的代码注定要失败。乍一看可能有点奇怪，但原因其实很简单——这就是所谓的数组衰减。这意味着每次将数组传递给函数时，它的类型都会自动衰减为指针的类型。所以上面的函数实际上是等价的：

```
void foo(std::string *array)
{
} 
```

如果在第一个示例中，`sizeof`运算符返回数组的总大小，在第二个示例中，它返回指向该数组的指针的大小，这是完全不同的事情。

人们通常有两种方式去做。第一个是添加一个特殊的数组“最后一个”元素，以便应用程序可以遍历数组，直到它看到最后一个元素并计算数组的长度。字符串文字就是一个完美的例子——每个字符串文字都以 '\0' 结尾，你总是可以计算它的长度。这是一个例子：

```
static void foo(const std::string *array)
{
    size_t i = 0;
    while (!array[i].empty())
        ++i;
    std::cout << "Array length is: " << i << std::endl;
} 
```

缺点显然是需要遍历数组来确定它的长度。第二种方式总是携带数组长度，例如：

```
static void foo(const std::string *array, size_t length)
{
    // ...
}

void bar()
{
    std::string array[] = { "S1", "S2", "S3" };
    foo(array, sizeof(array)/sizeof(array[0]));
} 
```

在 C++ 中，您可以使用模板来扣除数组的长度，例如：

```
template <size_t array_length>
static void foo(const std::string (&array)[array_length])
{
    std::cout << "A number of elements in template array is: "
              << array_length << '\n';
} 
```

以上所有内容都适用于语言内置的简单数组。另一方面，C++ 提供了一组丰富的高级容器，为您提供了很大的灵活性。因此，您可能需要考虑使用您可以使用的容器之一作为 C++ 标准库的一部分。有关标准容器的列表，请参阅 — [http://en.cppreference.com/w/cpp/container](http://en.cppreference.com/w/cpp/container)

希望能帮助到你。祝你好运！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-13T22:36:10.507

您可以使用模板函数来实现：

```
#include<cstdlib>

template<class T, std::size_t n>
constexpr std::size_t size(T (&)[n])
{ return n; } 
```

就像 Luchian Grigore 所说，你应该使用 STL 容器。std::array 如果您想等效于静态 C 数组。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-26T14:58:33.143

**stdlib**库中有标准函数：

```
#include <stdlib.h>
static const char * const strings[] = {"str1", "str2", "str3"};
const int stringCount = _countof(strings); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-12-08T10:28:11.627

你仍然可以使用

```
int numberofelements = sizeof(array)/sizeof(array[0]); 
```

这是因为 `sizeof(array)` 将返回每个字符串对应的指针大小的总和。`sizeof(array[0])`将返回对应于第一个字符串的指针的大小。因此，`sizeof(array)/sizeof(array[0])`返回字符串的数量。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-06-06T18:52:55.473

`size()`我们可以通过简单地使用函数来找到数组的元素数。

**示例代码：**

```
string exampleArray[] = { "Example", "Example2", "Example3" };
    int size_of_array = size(exampleArray);

cout << "Number of elements in array = " << size_of_array << endl; 
```

**输出：**

```
>>> Number of elements in array = 3 
```

希望它可以帮助你。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-13T22:32:43.487

这是你要找的吗？

```
string array[] = {"Example", "Example2", "Example3"};
int num_chars = 0;
int num_strings = sizeof(array)/sizeof(array[0]);
for (int i = 0; i < num_strings; i++) {
    num_chars += array[i].size();
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-13T22:33:32.347

强制性建议：**使用`std::vector<std::string>`**.

像这样的功能可以帮助：

```
template<typename T, int sz>
int getSize(T (&) [sz])
{
    return sz;
} 
```

您的方法也有效，因为元素的大小不变 - a`std::string`具有恒定大小，无论它包含的实际字符串如何。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-02-22T14:06:23.880

这是一个不同的例子：

```
string array[] = {"Example", "Example2", "Example3"};
int numberofelements = 0; for(auto c: array) { numberofelements++; };
// now numberofelements will contain 3 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-20T08:25:57.623

```
string s[] = {"apple","banana","cherry","berry","kiwi"};
int size = *(&s+1)-s;  
// OR
int size = sizeof(s)/sizeof(s[0]); 
```

有关第一个的更多信息： [https ://aticleworld.com/how-to-find-sizeof-array-in-cc-without-using-sizeof/](https://aticleworld.com/how-to-find-sizeof-array-in-cc-without-using-sizeof/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-09T13:06:18.313

没有人真正计算重复，所以：

```
int count_duplicated(string cities[], size_t length) {
    string **cities_copy = new string *[length];
    for (size_t j = 0; j < length; j++)
        cities_copy[j] = &cities[j];

    string bom = "#";
    int counter = 0;
    for (size_t j = 0; j < length; j++) {
        string city = cities[j];
        bool is_duplicated = false;

        for (size_t k = j+1; k < length; k++) {
            if (city == *cities_copy[k]) {
                is_duplicated = true;
                cities_copy[k] = &bom;
            }
        }
        if (is_duplicated)
            counter++;
    }
    delete[] cities_copy;
    return counter;
} 
```

# app-store-connect - iTunes Connect 客户评论未显示

> ID：14308936
> 
> 赞同：1
> 
> 时间：2013-01-13T22:30:01.537
> 
> 标签：app-store-connect

对于我在 App Store 上的新游戏，我看不到几条 1 星和 2 星评论。它只显示了我的 5 星评论中的 3 条。我在 iTunes 或 iTunes Connect 中看不到它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T08:15:31.923

用户可以在不留下评论的情况下留下星级。1 星和 2 星“评级”可能不是“评论”。

# iphone - iCarousel - 事件发生时停止

> ID：14308940
> 
> 赞同：0
> 
> 时间：2013-01-13T22:30:06.607
> 
> 标签：iphone, ios, xcode, icarousel

您好，我正在使用控件 iCarousel。

并且知道我不是在做一个来的项目。

我想在它停止向用户显示哪个项目时调用警报。

只有感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T01:53:59.450

我不确定完全理解你的问题，但我试图回答:) 实施 iCarouselDelegate 并试试这个：

```
-(void)carouselDidEndDecelerating:(iCarousel *)carousel {
    NSLog(@"HERE : %d", carousel.currentItemIndex);
    //Popup with UIAlertView or do what you want to do :)
} 
```

我希望我能成功回答你的问题

# php - 如何正确设置循环以显示所有信息

> ID：14308941
> 
> 赞同：3
> 
> 时间：2013-01-13T22:30:09.030
> 
> 标签：php, html

尝试将每个问题的所有不正确答案显示到表格中，但出于某种奇怪的原因，我在其中一行中收到了一个空答案。现在这只发生在问题 2 中，问题 2 是唯一有多个正确答案的问题，所以我相信我遇到的问题是我没有`$row_count`正确设置，但**我的问题是**如何正确设置才能显示缺少答案是`D`什么？看问题的 php fiddle 在这里[http://phpfiddle.org/main/code/get-rps](http://phpfiddle.org/main/code/get-rps)

下面的代码为包含多个正确答案的问题设置错误答案的行数如下：

```
 <?php
        //remaining incorrect answers in separate row (if any) follows here
    if($row_count < $q_row_span - 1) 
    {
        for($i=($row_count + 1); $i<$q_row_span; $i++) { ?>     
            <tr>
               <td class="answertd"><?php echo$inc_ans[$i];?>
                  <input type="hidden" id="hiddenincorrect" name="incorrect[]" value="<?php echo$inc_ans[$i];?>">
               </td>

               <td class="answermarkstd">
                  <input class="individualMarks q<?php echo$questionNo?>_mark"  q_group="1" name="answerMarks[]" type="text" data-type="qmark" data-qnum="<?php echo$questionNo?>" onkeypress="return isNumberKey(event)" maxlength="3" />
               </td>
            </tr>
    <?php
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T08:50:37.487

该错误是由于您`$ques_ans`使用 for() 迭代的数组在键中存在间隙。

`var_dump($ques_ans)`给我们：

```
array(3) {
  ... skipped for brevity
  [2]=>
  array(2) {
    [0]=>
    string(1) "B"
    [2]=>
    string(1) "D"
  }
  ... skipped for brevity
} 
```

没有带有 key 的元素`[1]`。这是因为[`array_intersect`](http://php.net/manual/en/function.array-intersect.php)您在第 49 行使用的函数保留了键。

`array_values()`我在第 51 行添加了快速修复您的代码以使其正常工作的方法：

```
$ques_ans[$questionNo] = array_values($q_incorrect_ans);    //store the array of incorrect ans against the ques no as key 
```

尽管这对您的应用程序逻辑可能没有意义。我只是没有潜入其中。所以检查一下。

# sql - 创建从 VIEW 中选择的 VIEW

> ID：14308944
> 
> 赞同：2
> 
> 时间：2013-01-13T22:30:23.143
> 
> 标签：sql, postgresql

从另一个视图创建视图有什么缺点？

代码示例：

```
CREATE OR REPLACE VIEW view1 AS 
 SELECT * from table1; 
```

接着 ：

```
CREATE OR REPLACE VIEW view2 AS 
 SELECT * from view1; 
```

当然不是像这个例子这样的观点，但这是一个好策略吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:40:12.973

如果您的基本视图正在对两个或多个表进行复杂的连接，并且您的新视图需要相同的数据，那么它绝对是一个非常好的策略。您可以省去再次进行相同加入的工作。

对于单个表或简单的连接，这不是一个坏主意或好主意。这是有效的，如果这是你想做的事情....

# redis - 在 Redis 中查找最大值 - 当前使用太多内存

> ID：14308948
> 
> 赞同：5
> 
> 时间：2013-01-13T22:30:50.750
> 
> 标签：redis

我有一个 redis 实例，它在内存中不断增长，以至于我的应用程序逻辑明显出现问题，我有数万个键，想找出哪些是最大的内存用户。有解决这个问题的已知技术吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:36:25.080

我认为要走的路不是找到你的哪些钥匙是最大的，而是你的钥匙有什么特征 - 即它们持有什么样的数据。

Redis*不是*关系数据库的替代品，它是一个互补层（非常重要和有用，但仍然是互补的）。您可以使用它以各种方式加速对应用程序中数据的访问。这意味着在一天结束时，Redis 可能不应该包含*所有内容*，而应该只包含最常用的数据和/或一般统计数据和聚合。

我不知道您的应用程序的域，但一开始请尝试查找密钥的**到期**时间。不经常访问的密钥最终应该被删除。

作为进一步的步骤，我将检查冗余键，即 - 以多种形式保存相同的数据。

*注意：* Redis 中的冗余绝对没有错，事实上，这是一个推荐的模式（使用没有规范化的 Redis，有利于每个给定查询的访问速度）。我的建议是，您可能会发现某些类别的密钥在给定其他密钥时完全没用，即它们不会增加任何速度优势，只会膨胀您的 Redis 数据库。

尝试查看一些 Redis GUI 应用程序，它们可能会帮助您探索运行时 Redis 实例：

*   [http://blog.freeflow.io/reddish-a-better-visual-admin-for-redis](http://blog.freeflow.io/reddish-a-better-visual-admin-for-redis)
*   [http://code.google.com/p/redis-admin/](http://code.google.com/p/redis-admin/)
*   [Redis 管理界面](https://github.com/ServiceStack/ServiceStack.RedisWebServices/downloads)

# trigger.io - Trigger.io 打不开

> ID：14308950
> 
> 赞同：1
> 
> 时间：2013-01-13T22:30:59.133
> 
> 标签：trigger.io

我正在评估 trigger.io。我有一台 Ubuntu 机器，并在其上的虚拟机上安装了 Windows XP。我在 Windows XP VM 实例中安装了 trigger.io 工具包并开始开发天气演示应用程序。完成了第一章并且运行良好，甚至将它安装在我的 iPhone 上。但是，几天后，当我启动 trigger.io 工具包时，页面突然在浏览器中打开，但没有可见的配置或伪造选项。我如何弄清楚为什么这没有开始（我什至重新安装了工具包，但结果相同）。是否有我可以阅读的日志以查找更多信息？我已附上屏幕以显示它的外观。我将感谢帮助解决此问题。

![在此处输入图像描述](../Images/b3b94c1247e6a97e301c542bd8c480f8.png)

卸载旧版本并安装新版本后，现在“正在加载”图像显示并继续显示。 ![在此处输入图像描述](../Images/b8dbe66122a9482cb3cb0a1baeba7dfd.png)

这是我在 toolkit.log 文件中找到的内容 -

`2013-01-13 19:09:55,515 [trigger.web: INFO] Attempting to open browser... 2013-01-13 19:09:56,312 [trigger.session: INFO] 0 sessions: []`

这是 JS 控制台 -

`Document was loaded from Application Cache with manifest [https://toolkit-local.com:38394/static/manifest.appcache](https://toolkit-local.com:38394/static/manifest.appcache) Application Cache Checking event Application Cache NoUpdate event Created session with id: 40cb230c-f9e3-45e2-8841-4430cbcf5a2b remote.js:161`

当我尝试在 IE 8 中访问 JS 控制台时，这里有一堆错误（通常我从不使用 IE）-

`Object doesn't support this property or method toolkit-local.com:38394, line 6 character 4 Expected identifier config.js, line 171 character 28 LOG: Created session with id: d55f077f-2c40-4fcc-b7c7-0f7e2e9c7355 Unexpected call to method or property access. jquery-1.7.js, line 5828 character 5 Object doesn't support this property or method toolkit.js, line 68 character 4 Object doesn't support this property or method toolkit-local.com:38394, line 6 character 4 Expected identifier, string or number views.js, line 569 character 3 'Toolkit.Views.ViewWithTemplate' is null or not an object form.js, line 6 character 2 Expected identifier config.js, line 171 character 28 'undefined' is null or not an object console.js, line 198 character 2 'Toolkit.Views.ViewWithTemplate' is null or not an object plugins.js, line 198 character 2 'Toolkit.Views.ViewWithTemplate' is null or not an object projects.js, line 38 character 2 LOG: Created session with id: 979c4bde-1426-44ef-8992-e47eab0e7c60 'JSON' is undefined remote.js, line 226 character 2 Object doesn't support this property or method toolkit-local.com:38394, line 6 character 4 Expected identifier config.js, line 171 character 28 LOG: Created session with id: b279d926-0282-4091-a31a-879fbb766efd Unexpected call to method or property access. jquery-1.7.js, line 5828 character 5 Object doesn't support this property or method toolkit.js, line 68 character 4`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:43:45.283

这看起来像是工具包的一个稍微过时的版本（我们上周发布了一个新版本）。它应该会自行更新，但看起来这里出了点问题。

您能否尝试先卸载现有的工具包，然后从[https://trigger.io/forge/toolkit/](https://trigger.io/forge/toolkit/)下载该工具包的新副本并重新安装。

如果这不起作用，则应该有一个`C:\Users\<Your User>\AppData\Local\Trigger Toolkit\toolkit.log`包含更多信息的日志文件。

# python - 用python更改csv中的单元格

> ID：14308955
> 
> 赞同：1
> 
> 时间：2013-01-13T22:32:09.960
> 
> 标签：python, csv, cell

如何使用 Python 2.7 更改某个单元格中的值？创建数据库是最好的方法吗？（将 '1打' 更改为 12 两次 - 每次找到 '1打' 时将其替换为 12）

输入：

```
['item', 'amount', 'size', 'price']
['apple', '1 dozen', '3', '8']
['cherry', '84', '100 g', '3.5']
['orange', '1 dozen', '3', '9'] 
```

期望的输出：

```
['item', 'amount', 'size', 'price']
['apple', '12', '3', '8']
['cherry', '84', '100 g', '3.5']
['orange', '12', '3', '9'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:40:03.647

假设您的输入在文件`amounts.csv`中，您可以尝试以下操作：

```
import csv

# Keep a dictionary of the changes you want to make
changes = {
    '1 dozen': 12
    }

with open('amounts.csv', 'rb') as f:
    reader = csv.reader(f)

    # Iterating through the list of lists
    for row in reader:
        # Look up each value in your dictionary and return the
        # corresponding 'changes' value if it finds a match.
        # If a match isn't found, just return the item itself.
        print [changes.get(item, item) for item in row] 
```

这将输出：

```
['item', 'amount', 'size', 'price']
['apple', 12, '3', '8']
['cherry', '84', '100 g', '3.5']
['orange', 12, '3', '9'] 
```

`print`这只是为了显示输出 - 您可以调整以适应您的用例。

# java - 如何从 Java 中的另一个类中获取变量？

> ID：14308956
> 
> 赞同：2
> 
> 时间：2013-01-13T22:32:15.677
> 
> 标签：java, android, class, variables

如何将 selectedPlayer 设置为其他班级的位置值？

我在这里阅读了一堆类似的问题，但我一直遇到与我的变量和函数的冲突。

ScoreList.java

```
public class ScoreList extends Activity {

    Integer selectedPlayer = 0;
} 
```

ScoreListAdapter.java

```
public class ScoreListAdapter extends ArrayAdapter<Score> {

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        final OnClickListener lsScoreView = new OnClickListener() {
              @Override
                public void onClick(View v) {
                  //send position to main class here
              }
        };

    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-13T22:49:44.100

将 selectedPlayer 设置为静态：

```
public class ScoreList extends Activity {

  static Integer selectedPlayer = 0;
} 
```

这样，您可以使用类名引用 selecterPlayer，因为它不属于该类的任何对象。

ScoreListAdapter.java

```
 public class ScoreListAdapter extends ArrayAdapter<Score> {

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {

            final OnClickListener lsScoreView = new OnClickListener() {
                  @Override
                    public void onClick(View v) {
                       ScoreList.selectedPlayer;//You can use selectedPlayer here
                  }
            };

        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:56:08.093

选项...

1.  `ScoreList`作为参数传入`ScoreListAdapter`构造函数，并将其设置为实例变量，您可以在`ScoreListAdapter.getView`.

2.  `ScoreList`作为参数传入`getView`方法。

# javascript - 将样式应用于文本框子字符串

> ID：14308958
> 
> 赞同：0
> 
> 时间：2013-01-13T22:32:19.573
> 
> 标签：javascript, jquery

我有一个简单的搜索表单，只包含一个文本字段，但它有过滤器（例如，以“type:”开头的查询只搜索“type”的数据库列）。我想要的是在实际搜索词（即“类型：”）之前的文本被设置为对用户来说很明显它是一个过滤器而不是一个搜索词。事实上，在用户输入标签后，它可能看起来类似于 StackOverflow 的标签文本字段（请参阅[this](http://i.imgur.com/tvP6R.png)）。到目前为止，我已经在文本字段上调用了一个 .keypress() 方法来确定第一个术语是否确实是一个过滤器，但我不确定如何设置过滤器文本的样式。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:39:39.433

您会发现 SO 标签框（和其他解决方案）实际上并没有设置输入框本身的内容样式，而是将标签/过滤器格式预先设置为跨度并相应地调整输入框的宽度。输入框本身已删除所有样式（因此没有边框或任何东西），边框由样式化的 div 提供。所以你需要一个这样的结构（顺便说一句，这是一个简化的视图）：

```
<div class="i am a div styled like an input box with a border">
<span class="i am a filter/tag">Type:</span>
<input type="text" class="i am actual input box with all styling removed">
</div> 
```

您还需要处理添加/删除过滤器和调整输入框的大小（基于过滤器标签的长度）（如果您只有一个过滤器，您可能会使用固定宽度的输入字段）...

# wpf - WPF 中的 IValidatableObject

> ID：14308961
> 
> 赞同：0
> 
> 时间：2013-01-13T22:32:31.417
> 
> 标签：wpf, entity-framework, mvvm

有人可以上传一个示例或为我提供一些帮助来实现 IValidatableObject 并使用 IDataErrorInfo 在 WPF (MVVM) 应用程序上显示验证错误。我在这篇文章中红色 3d 答案： [IDataErrorInfo vs IValidatableObject？](https://stackoverflow.com/questions/4233920/idataerrorinfo-vs-ivalidatableobject/4559267#4559267)

我正在使用net 4.5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T01:12:54.980

看看[这里](http://jeffhandley.com/archive/2009/10/16/validator.aspx)的实现。引用博客文章：

> 验证对象时，在 Validator.ValidateObject 中应用以下过程：
> 
> 验证属性级属性如果任何验证器无效，则中止验证返回失败验证对象级属性如果任何验证器无效，则中止验证返回失败如果在桌面框架上并且对象实现 IValidatableObject，然后调用其 Validate 方法并返回任何失败

如果你有更复杂的验证需求，真的推荐查看[FuentValidation](http://fluentvalidation.codeplex.com/)库。

# c# - c#将数据导出到Excel的格式不正确

> ID：14308966
> 
> 赞同：0
> 
> 时间：2013-01-13T22:33:00.960
> 
> 标签：c#, datagridview, export-to-excel

> **可能重复：**
> [导出 Excel：避免去除前导零](https://stackoverflow.com/questions/11574840/export-excel-avoid-stripping-the-leading-zeros)

我正在使用 Interop 将 datagridview 导出到 excel。dgv 中的数据按预期格式化，并且相关列在源数据表中属于字符串类型。但是，在导出时，示例单元格在 Excel 中显示为“39374”，而不是“0039374”，后者是 datagridview 上的值。有没有办法克服这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T22:39:18.630

只需为单元格本身设置适当的类型。检查这些链接，

[如何使Excel在C#中的数字前为零](https://stackoverflow.com/questions/4373982/how-to-make-excel-with-zero-before-the-number-in-c-sharp)

[如何以编程方式格式化Excel工作表中的单元格？](https://stackoverflow.com/questions/7503298/how-to-format-cells-in-excel-sheet-programmatically)

# authentication - symfony2.1注册后触发认证成功事件

> ID：14308967
> 
> 赞同：2
> 
> 时间：2013-01-13T22:33:03.167
> 
> 标签：authentication, event-handling, registration, symfony-2.1

注册后，我确保用户按如下方式登录：

```
$token = new UsernamePasswordToken($user, null, 'secured_area', $user->getRoles());
$this->get('security.context')->setToken($token); 
```

并希望这也会触发我的成功处理程序：

```
$this->get('event_dispatcher')->dispatch(
    AuthenticationEvents::AUTHENTICATION_SUCCESS,
    new AuthenticationEvent($token)
); 
```

处理程序在安全配置中的标准表单登录上设置，例如

```
firewalls:
    secured_area:
        form_login:
            success_handler: authentication_handler 
```

成功处理程序在登录时触发，但在注册后不会触发。

这只是一个配置问题吗？和/或所有这些都可以通过一个事件来实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T02:24:35.550

我认为您必须对用户进行身份验证才能触发事件：

```
$token = $this->get('my.bundle.authentication.manager')->authenticate(new UsernamePasswordToken($user, null, 'secured_area', $user->getRoles()));
$this->get('security.context')->setToken($token); 
```

`my.bundle.authentication.manager`将是 的别名`security.authentication.manager`，它可以像这样注册（XML）：

```
<service id="my.bundle.authentication.manager" alias="security.authentication.manager" /> 
```

# c++ - if/else 和参数放置 C++

> ID：14308974
> 
> 赞同：-1
> 
> 时间：2013-01-13T22:34:06.840
> 
> 标签：c++, if-statement

我最近开始使用 C++ 并试图理解语法，但我遇到了放置问题。我必须做一个信用卡验证功能，要求提供一张有效的信用卡，然后我必须打印出信用卡的类型。

我唯一的问题是用于确定信用卡类型的 if 语句。我不知道它们的确切放置位置以及我是否缺少任何括号等。

对我来说有问题的确切块是：

```
 if(c.substr(0, 2) == "65" || c.substr(0, 5) == "6011" || c.substr(0, 7) >= "622126" && c.substr(0, 7) <= "622925" || c.substr(0, 4) >= "644" && c.substr(0, 4) <= "649")
            s = "You have a Discover card";
        if(c.substr(0, 2) >= "51" && c.substr(0, 2) <= "55")
            s = "You have a MasterCard card";
        if(c.substr(0, 1) == "4")
            s = "You have a Visa card";
        if(c.substr(0, 2) == "34" || c.substr(0, 2) == "37")
            s = "You have an American Express card"; 
```

这是我的代码。

```
#include <iostream>
#include <string>
using namespace std;

void validateCC();
string checkCC(string, int, bool&);
bool validateCCNum(string);

void main() {
    char again;
    cout << "Validate a credit card number (Y/N)? ";
    cin >> again;
    while (toupper(again) == 'Y') {
        validateCC();
        cout << "Validate a credit card number (Y/N)? ";
        cin >> again;
    }
}

void validateCC() {
    string ccn, msg;
    bool OK;
    int ccLen;
    cout << "Please enter a 15 or 16 digit credit card number."
        << "\n(No spaces or hyphens): ";
    cin >> ccn;
    ccLen = ccn.length();
    msg = checkCC(ccn, ccLen, OK);
    if(!OK)
        cout << msg;
    else
        if(validateCCNum(ccn))
            cout << "Valid credit card number\n";
        else
            cout << "Invalid credit card number\n";
    cout << "\n" << endl;
}

string checkCC(string c, int cLen, bool& ccOK) {
    string s = "";
    ccOK = true;
    for(int i=0;i<cLen && ccOK;++i)
        ccOK = isdigit(c[i]);

        if(c.substr(0, 2) == "65" || c.substr(0, 5) == "6011" || c.substr(0, 7) >= "622126" && c.substr(0, 7) <= "622925" || c.substr(0, 4) >= "644" && c.substr(0, 4) <= "649")
            s = "You have a Discover card";
        if(c.substr(0, 2) >= "51" && c.substr(0, 2) <= "55")
            s = "You have a MasterCard card";
        if(c.substr(0, 1) == "4")
            s = "You have a Visa card";
        if(c.substr(0, 2) == "34" || c.substr(0, 2) == "37")
            s = "You have an American Express card"; 

    if(ccOK == false) {
        s = "Invalid credit card number digits";
    } else if(cLen == 15) {
        if(c.substr(0, 2) != "34" && c.substr(0, 2) != "37") {
            ccOK = false;
            s = "Invalid American Express credit card number";
        }
    } else if(cLen != 16) {
        ccOK = false;
        s = "Invalid credit card number length";
    }
    return s;
}

bool validateCCNum(string cc) {
    bool flip = true;
    int tmp, num = 0;
    int ccLen = cc.length()-1;
    for(int ndx=ccLen;ndx>=0;ndx--) {
            if(flip)
                num += cc[ndx] - '0';
            else {
                tmp = (cc[ndx] - '0') * 2;
                if(tmp <= 9)
                    num += tmp;
                else
                    num += (1 + (tmp - 10)); // max of 18
            }
            flip = !flip;
    }
    return num % 10 == 0;
} 
```

我不知道有问题的块是否属于它当前所在的位置，或者我是否将它放在 validateCC() 部分中，然后为它添加一个参数。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:42:40.197

尝试将子字符串更改为 int (stringVar >> IntVar;) 以便您可以评估 <= >= 等...

```
 #include <iostream>
#include <string>
using namespace std;

void validateCC();
string checkCC(string, int, bool&);
bool validateCCNum(string);

void main() {
    char again;
    cout << "Validate a credit card number (Y/N)? ";
    cin >> again;
    while (toupper(again) == 'Y') {
        validateCC();
        cout << "Validate a credit card number (Y/N)? ";
        cin >> again;
    }
}
string checkCardType(string c){
if(atoi(c.substr(0, 2).c_str()) == 65 || atoi(c.substr(0, 5).c_str()) == 6011 || atoi(c.substr(0, 7).c_str()) >= 622126 && atoi(c.substr(0, 7).c_str()) <= 622925 || atoi(c.substr(0, 4).c_str()) >= 644 && atoi(c.substr(0, 4).c_str()) <= 649)
            return "You have a Discover card";
        if(atoi(c.substr(0, 2).c_str()) >= 51 && atoi(c.substr(0, 2).c_str()) <= 55)
            return "You have a MasterCard card";
        if(atoi(c.substr(0, 1).c_str()) == 4)
            return "You have a Visa card";
        if(atoi(c.substr(0, 2).c_str()) == 34 || atoi(c.substr(0, 2).c_str()) == 37)
            return "You have an American Express card"; 
        return "Card not recognized";
}
void validateCC() {
    string ccn, msg;
    bool OK;
    int ccLen;
    cout << "Please enter a 15 or 16 digit credit card number."
        << "\n(No spaces or hyphens): ";
    cin >> ccn;
    ccLen = ccn.length();
    msg = checkCC(ccn, ccLen, OK);
    if(!OK)
        cout << msg;
    else
        if(validateCCNum(ccn)){
            cout << "Valid credit card number\n";
            cout << checkCardType(ccn);}
        else
            cout << "Invalid credit card number\n";
    cout << "\n" << endl;
}

string checkCC(string c, int cLen, bool& ccOK) {
    string s = "";
    ccOK = true;
    for(int i=0;i<cLen && ccOK;++i)
        ccOK = isdigit(c[i]);

    if(ccOK == false) {
        s = "Invalid credit card number digits";
    } else if(cLen == 15) {
        if(c.substr(0, 2) != "34" && c.substr(0, 2) != "37") {
            ccOK = false;
            s = "Invalid American Express credit card number";
        }
    } else if(cLen != 16) {
        ccOK = false;
        s = "Invalid credit card number length";
    }
    return s;
}

bool validateCCNum(string cc) {
    bool flip = true;
    int tmp, num = 0;
    int ccLen = cc.length()-1;
    for(int ndx=ccLen;ndx>=0;ndx--) {
            if(flip)
                num += cc[ndx] - '0';
            else {
                tmp = (cc[ndx] - '0') * 2;
                if(tmp <= 9)
                    num += tmp;
                else
                    num += (1 + (tmp - 10)); // max of 18
            }
            flip = !flip;
    }
    return num % 10 == 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T23:04:06.833

虽然不是最有效的方法，但我在您的代码中看到的唯一问题是您在某些情况下使用了太多字符：`c.substr(0, 5) == "6011"`只有在`c.size() == 4`.

对于它的价值，我会将前缀声明为`static std::string const`并使用`std::equal`它们（在首先检查数字是否足够长之后）。或者，我会在第一个字符上使用开关：

```
switch (c[0])
{
case '6':
    //  Additional tests for Discover...
    break;
case '5':
    //  Additional tests for MasterCard...
    break;

case '4':
    //  Additional tests for Visa...
    break;

case '3':
    //  Additional tests for American express..
    break;
} 
```

或者更有可能的是，我会使用从配置文件中读取的模式的正则表达式；这*不是*您要硬编码到程序中的信息类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T23:05:05.070

该[`std::string::substr`](http://www.cplusplus.com/reference/string/string/substr/)方法返回一个字符串，可以将其[与](http://www.cplusplus.com/reference/string/operators/)另一个字符串进行比较。到目前为止，您的代码看起来不错。

要使用括号，请查看[C++ Operator Precedence](http://en.cppreference.com/w/cpp/language/operator_precedence)。据我了解代码，您的 if 条件中不需要括号。但是，如果您有疑问，请使用括号来明确您的意图。

您不需要传递信用卡号的长度，因为`checkCC`可以自行确定。还将信用卡号传递为

```
string checkCC(const string &c, ...) 
```

因为这避免了字符串的副本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-13T22:55:17.683

我不确定这是否有效：

c.substr(0, 2) == "34"

为什么不将字符串解析为整数 (atoi)，然后将其与 '==' 进行比较。还将字符串与 "string".compare("string2") 进行比较（如果字符串相同，则返回 0）。

# python - python非类型错误

> ID：14308976
> 
> 赞同：-3
> 
> 时间：2013-01-13T22:34:39.423
> 
> 标签：python

这是我的代码：

```
import random

min_num = 1
max_num = input("Pick your maximum number: ")
used_num = []

def rndnum(used_num):
    a = random.randint(min_num,max_num)
    b = random.randint(min_num,max_num)
    num_string = str(a) + "," + str(b)
    if num_string not in used_num:
        return a,b,num_string
    else:
        rndnum(used_num)

def to_continue(used_num):
    d = raw_input("Press [Enter] to Continue")
    ask(used_num)

def finished():
    print "Congratulations, you are finished!"

def ask(used_num): 
    a,b,num_string = rndnum(used_num)
    c = input(str(len(used_num)+1) + ". What is " + str(a) + " times " + str(b) + "? ")
    if c == a*b:
        used_num.append(num_string)
        print "That is correct! Only " + str(max_num**2 - len(used_num)) + " remaining!"
        if len(used_num) == max_num**2:
            finished()
        else:
        to_continue(used_num)
    else:
        print "That is incorrect."
        to_continue(used_num)

ask(used_num) 
```

这是显示的错误：

```
Traceback (most recent call last):
   File "/home/philip/Documents/Aptana Studio 3 Workspace/Eli Tests/helloworld.py", line 37, in <module>
    ask(used_num)
   File "/home/philip/Documents/Aptana Studio 3 Workspace/Eli Tests/helloworld.py", line 32, in ask
   to_continue(used_num)
  File "/home/philip/Documents/Aptana Studio 3 Workspace/Eli Tests/helloworld.py", line 18, in to_continue
    ask(used_num)
  File "/home/philip/Documents/Aptana Studio 3 Workspace/Eli Tests/helloworld.py", line 32, in ask
    to_continue(used_num)
   File "/home/philip/Documents/Aptana Studio 3 Workspace/Eli Tests/helloworld.py", line 18, in to_continue
    ask(used_num)
  File "/home/philip/Documents/Aptana Studio 3 Workspace/Eli Tests/helloworld.py", line 32, in ask
     to_continue(used_num)
  File "/home/philip/Documents/Aptana Studio 3 Workspace/Eli Tests/helloworld.py", line 18, in to_continue
    ask(used_num)
   File "/home/philip/Documents/Aptana Studio 3 Workspace/Eli Tests/helloworld.py", line 32, in ask
    to_continue(used_num)
  File "/home/philip/Documents/Aptana Studio 3 Workspace/Eli Tests/helloworld.py", line 18, in to_continue
     ask(used_num)
   File "/home/philip/Documents/Aptana Studio 3 Workspace/Eli Tests/helloworld.py", line 24, in ask
    a,b,num_string = rndnum(used_num)
 TypeError: 'NoneType' object is not iterable 
```

出了什么问题？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T22:42:29.580

您在函数`return`的最后一行忘记了 a 。`rndnum`它不返回值，而是隐式返回`None`。下面的固定代码。

```
def rndnum(used_num):
    a = random.randint(min_num,max_num)
    b = random.randint(min_num,max_num)
    num_string = str(a) + "," + str(b)
    if num_string not in used_num:
        return a,b,num_string
    else:
        return rndnum(used_num) 
```

# ruby-on-rails - ERB 标签列表

> ID：14308977
> 
> 赞同：1
> 
> 时间：2013-01-13T22:35:02.597
> 
> 标签：ruby-on-rails, tags, erb

我今天在我的`.erb`文件中找到了这个定义：

```
<%=t '.title', :default => model_class.model_name.human.pluralize %> 
```

或者

```
<%=l post.created_at, :format => "%d %b. %Y" %> 
```

我能够弄清楚，这`<%=t`与翻译有关。但是我找不到任何解释`<%=l`。

你可以回答`<%=l`是为了什么。但我正在寻找的是 RoR 3.1 中可用的所有 ERB 标签的完整列表。我努力搜索，但找不到这样的列表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T22:38:23.863

`l`是简写`localize`

*   阅读有关此的[Rails 指南](http://guides.rubyonrails.org/i18n.html#the-public-i18n-api)
*   阅读[API](http://api.rubyonrails.org/classes/AbstractController/Translation.html#method-i-localize)
*   查看[源代码](https://github.com/rails/rails/blob/6e26be69606c52dbccfad366661b455157c35be4/actionpack/lib/abstract_controller/translation.rb#L8)

`<%=l`不是ERB“标签”，它只是*（*`<%=`打印）**+** `l(post.created_at, :format => "%d %b. %Y)`（`:created_at`属性的本地化格式`post`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T22:39:01.797

这些是方法。't' 是 'translate' 的缩写，'l' 是 'localize' 的缩写，如下所示[http://guides.rubyonrails.org/i18n.html#the-public-i18n-api](http://guides.rubyonrails.org/i18n.html#the-public-i18n-api)

# ember.js - 讨论：如何继续实现基于 Ember 和 Titanium 的移动应用程序？

> ID：14308978
> 
> 赞同：3
> 
> 时间：2013-01-13T22:35:20.143
> 
> 标签：ember.js, titanium

我想在 Titanium 的帮助下开发一个多平台移动应用程序。我已经有一个基于 EmberJs 的工作网站。我的目标是尽可能多地重用代码。我已经看过[Ember Titanium](https://github.com/ebryn/ember-titanium)，它提供了 Titanium API 和 Ember 视图之间的桥梁。

我主要有两个问题：

**1\. 我应该使用哪个集成项目？** Ember Titanium 是否适合这种方法？还有其他值得推荐的集成项目吗？

**2 我现有的 webapp 的哪些部分需要重写（webapp 和移动应用程序的功能相同）？**Ember 应用由模型、控制器、视图和路由器组成。用 Ember Titanium 重写我现有 webapp 的视图层就足够了吗？可能我也需要重写路由器，但也许我可以编写一个通用的 StateManager 可以被我的 web 应用程序和移动应用程序重用？还是我在这个话题上过于雄心勃勃？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-13T23:35:23.030

我也无法挖掘太多关于原生风格的 ember 应用程序的信息，我希望其他人可以加入并添加一些额外的资源。我发现了什么：

1) Brian Pattison [(github)](https://github.com/brianpattison?tab=repositories)在这些项目中基于 ember-titanium 构建了一点：[Ember-Titanium-Submodule](https://github.com/brianpattison/ember-titanium-submodule)和[Ember-Titanium Utilities](https://github.com/brianpattison/ember-titanium-utilities)。然而，他并没有积极维护它们，现在使用 RubyMotion 编写仅限 iOS 的应用程序。

[2) Yapp](http://phonegap.com/)的 Luke Melia说他们使用[Phonegap](https://www.yapp.us/)将他们的 ember 应用程序包装成原生风格的 iOS 应用程序。

3) 我刚刚在 github 上看到了 Titan [-backbone](https://github.com/trabian/titanium-backbone)，它看起来像是在积极维护，并且可能不会很难分叉和适应特定于 ember 的需求。

除此之外，我还没有听到太多关于 ember 开发人员对原生风格的移动应用程序采取的方法。我觉得在构建了一个非常大的 ember web 应用程序之后，用一种本地语言（或多种本地语言）完全重写一个应用程序以获取最小的性能提升似乎是一种疯狂的滥用时间和金钱。但是，我没有发现很多关于 ember 和 Titanium 或 Phonegap 的积极体验。

我将在大约一个月内深入研究这个问题，所以希望其他人可以在此之前分享他们的经验。

# c# - 代码完成后 C# 线程未完成

> ID：14308980
> 
> 赞同：0
> 
> 时间：2013-01-13T22:35:22.737
> 
> 标签：c#, winforms, multithreading

我有这门课来证明我的问题：

```
class Program
{
    static List<FileInfo> _foundFiles;
    static int _numberPadding = 0;
    static Thread newThread;

    static void Main(string[] args)
    {
        _foundFiles = new List<FileInfo>();

        _shouldStop = false;
        newThread = new Thread(new ThreadStart(StartSearch));
        newThread.Start();

        newThread.Join();

        Console.WriteLine("Finished");
        Console.ReadKey();
    }

    static volatile bool _shouldStop;

    static void StartSearch()
    {
        IterateFileSystemNon(new DirectoryInfo(@"D:\OLD Melman\Music Backup\iTunes 28-06-11\Music"));
    }

    static void IterateFileSystemNon(DirectoryInfo folder)
    {
        string pad = CreatePadding();

        Console.WriteLine("{0} Directory: {1}", pad, folder.Name);

        foreach (var dir in folder.GetDirectories())
            IterateFileSystemNon(dir);

        pad = CreatePadding();

        foreach (var file in folder.GetFiles())
        {
            if (file.Extension.Contains("mp3"))
            {
                _foundFiles.Add(file);

                Console.WriteLine("{0} File: {1}", pad, file.Name);
            }
        }

        _numberPadding = _numberPadding - 6;
    }

    static string CreatePadding()
    {
        _numberPadding = _numberPadding + 3;

        var stringRepOfPadding = new StringBuilder(_numberPadding);
        for (int i = 0; i < _numberPadding; i++)
        {
            stringRepOfPadding.Append(" ");
        }
        return stringRepOfPadding.ToString();
    }
} 
```

我有这些问题：

1.  这在控制台应用程序中有效，但在 WindowsFormsApplication 中无效，它直接进入`Join`语句，这是为什么呢？
2.  如果 Microsoft 所说的 Join 语句“假设阻塞当前线程，直到生成的线程完成”。这肯定会破坏多线程的对象吗？在我的 WindowsFormsApplication 中，我不想在该线程运行它的任务时阻塞任何线程。
3.  为什么我需要加入。当然，当我的 Iteration void 完成迭代时，线程应该终止？！
4.  我如何在新线程内部指示它已完成以便关闭线程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T22:47:46.553

1.  使用加入，您将挂起 UI 线程。使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)组件在后台线程中搜索文件。
2.  不要启动线程并加入它。这与在一个线程中按顺序执行所有工作相同，因为在这种情况下不会异步执行任何操作。
3.  您不需要加入（请参阅 p2）。在 UI 线程中使用 Join 总是坏主意。
4.  您无需指示线程已完成即可关闭线程。当您的线程委托完成执行时，线程将退出。请参阅[多线程：终止线程](http://msdn.microsoft.com/en-us/library/2s21xzfe%28v=vs.71%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:42:22.950

1.  “直接加入”是什么意思？启动线程完全有可能在另一个线程甚至被调度并命中断点之前命中 Join。您能否详细说明 Windows 窗体应用程序正在执行的操作不是您所期望的？在这种情况下可能有一个异常导致工作线程过早退出？
2.  您不必*立即*致电加入。这个想法是你启动线程，在当前线程上做任何你想做的事情，当你*需要*第二个线程的结果时，你调用 Join 来等待它完成。
3.  是的，枚举完成后线程将结束。
4.  您只需要从传递给`Thread`构造函数的方法返回。（`StartSearch`在你的情况下）。

# javascript - 香草 javascript vs jquery

> ID：14308982
> 
> 赞同：6
> 
> 时间：2013-01-13T22:35:29.623
> 
> 标签：javascript, jquery

我很难掌握两者之间的区别。我尝试下载库，但没有代码。我正在尝试构建一个基本滑块以及我在 jQuery 中构建的其他基本功能。任何帮助、教程、插件和信息都会非常有帮助！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-13T22:44:42.217

“Vanilla JS”是指普通的、未经修改的 JavaScript。

```
document.getElementById('myelement').innerHTML = "I was written with JavaScript!"; 
```

jQuery 是一组旨在让 JavaScript 更容易编写的函数和东西（虽然我个人觉得它更像意大利面条）

```
$("#myelement").html("I was written with jQuery!"); 
```

由于 jQuery 只是一堆 JavaScript，因此纯 JavaScript 总是运行得更快。它可能更难编写，因为你必须真正考虑你在做什么，但它会比 jQuery 中的相同东西运行得更快。

有关上面两个代码示例的比较，请参阅[此 JSPerf](http://jsperf.com/vanilla-js-vs-jquery)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-13T22:40:08.680

javascript内置在浏览器中

你可以链接到 jquery 和 jqueryui 的在线版本开始

```
 <script src="http://code.jquery.com/jquery-1.8.3.js"></script> 
```

并且滑块在 jquery ui 库中 - （它是一个建立在 jquery 之上并依赖于 jquery 的库）所以接下来将其引入

```
 <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script> 
```

那么来自 jqueryui 的样本应该更有意义

```
<script>
  $(function() {
    $( "#slider" ).slider();
  });
  </script>

<div id="slider"></div> 
```

从

[http://jqueryui.com/slider/](http://jqueryui.com/slider/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-13T22:53:06.307

jQuery 是一个基于 JavaScript 的库。它提供了可以用 JavaScript 编码的东西的简写方法。jQuery 是用 JavaScript 编码的，不是内置在浏览器中的，所以你必须嵌入它。

另一方面，jQuery UI 是一个 UI 库，它允许您以简写方式编写基本的 UI 元素。

您没有指定您使用的是哪一个。

要嵌入 jQuery，请将其用于最新的 jQuery 版本：

```
<script src="http://code.jquery.com/jquery-1.8.3.js"></script> 
```

这是最新的 UI 版本：

```
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script> 
```

请注意，上面的示例托管在 jQuery.com 上。

Google 还通过developers.google.com 提供托管的jQuery 解决方案。

你也可以在你自己的服务器上自托管 jQuery（如果你有的话）。有些人认为使用 Google 的服务器（或 jQuery 的）比将其托管在您自己的服务器上要快得多，但是您需要运行测试并发现哪一个最适合您/更快。

因为 jQuery 是一个外部库（JavaScript 的扩展），所以你必须加载它，它不是内置在浏览器中的，因此它总是比较慢。

尽管有些人认为由于 jQuery（对某些人来说）更容易编码（并且像 FadeIn 这样的转换是内置的），但加载时间较慢是值得的。

希望这可以帮助。

**编辑：** 你还提到你下载了 JavaScript 并且里面没有代码，但是 JavaScript 是内置在浏览器中的，所以没有下载它。你可能指的是[这个笑话](http://vanilla-js.com/)。

# javascript - 如何设置 azure 移动服务以向 Windows 8（商店）应用程序提供定期更新？

> ID：14308983
> 
> 赞同：0
> 
> 时间：2013-01-13T22:35:32.467
> 
> 标签：javascript, windows-8, windows-runtime, azure-mobile-services

我想向我的 Windows 商店应用程序添加定期磁贴更新，如果我向 tileUpdateManager 提供一个 xml，例如这个地址[http://wowzappelsalvador.azurewebsites.net/tiletest.xml](http://wowzappelsalvador.azurewebsites.net/tiletest.xml) ，一切正常。该应用程序适用于 azure 移动服务，其想法是使用相同的服务更新 App 磁贴，因此我在 azure 上创建了一个读取脚本，如下所示：

```
function read(query, user, request) {

mssql.query("select imagenTile, nombreTip from verdetips.tipDiaLiveTileView", {
    success: function(results) {

        var xmlEscape = function (text) {
        return text.replace(/&/g, '&amp;')
           .replace(/</g, '&lt;')
           .replace(/>/g, '&gt;')
           .replace(/"/g, '&quot;');
        }

         var payload = "<?xml version='1.0' encoding='UTF-8'?>" +
         "<tile><visual><binding template='TileWideImageAndText01'>" +
          "<image id='1' src='" + xmlEscape(results[0].imagenTile) + "' alt='Verde Tips'/>" +
          "<text id='1'>" + xmlEscape(results[0].nombreTip) + "</text>" +
          "</binding>" +
          "<binding template='TileSquareText04'>" +
          "<text id='1'>" + xmlEscape(results[0].nombreTip) + "</text>" +
          "</binding></visual></tile>";

         console.log(payload);
         request.respond(statusCodes.OK, payload);
    }
 });
} 
```

当我调用与此脚本关联的表时，我得到的文本与 .xml 文件上的文本相同，但在 .json 文件上，并且磁贴更新不起作用，我错过了什么？

注意：我看过一些网站解释如何在 azure 移动服务上使用 push.wns.send 来发送推送或 toast 通知，但我的案例是轮询通知，客户端代码如下：

```
var notifications = Windows.UI.Notifications;
    var polledUri = new Windows.Foundation.Uri("http://verdetips.azure-mobile.net/tables/tipDiaLiveTile");
    //var polledUri = new Windows.Foundation.Uri("http://wowzappelsalvador.azurewebsites.net/tiletest.xml");
    var recurrence = notifications.PeriodicUpdateRecurrence.daily;
    var tileUpdater = notifications.TileUpdateManager.createTileUpdaterForApplication();
    tileUpdater.startPeriodicUpdate(polledUri, recurrence); 
```

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T00:46:55.713

目前，Azure 移动服务无法返回 JSON 以外的任何内容。这是一个经常性的请求，因此此功能已在路线图中，应在不久的将来实施。

# javascript - 仅在直接之前匹配 但不是直接在之后

> ID：14308984
> 
> 赞同：1
> 
> 时间：2013-01-13T22:35:33.077
> 
> 标签：javascript, regex

我正在尝试使用正则表达式来清理我自己的 html5 RTE 中生成的一些代码。环顾四周，我看到很多人说不应该使用正则表达式来解析 html ......但我正在用 JavaScript 做这个客户端。除了正则表达式，我还有其他选择吗？

我一直在尝试使用lookbehinds（刚刚发现它们），但它们似乎不适用于JavaScript。我想要做的是删除 <p> 末尾的所有 <br>，但不是那些是段落中唯一元素的那些，例如 <p><br></p>。所以：

```
<p>Blah<br><br><br></p> becomes <p>Blah</p>
<p><br></p> stays the same. 
```

到目前为止我只有

```
html = html.replace(/(?:<br\s?\/?>)+(<\/p>)/g, '$1'); 
```

这将删除段落末尾的所有 <br>，无论有多少。

我想要类似的东西

```
html = html.replace(/(?<!<p>)(?:<br\s?\/?>)+(<\/p>)/g, '$1'); 
```

编辑：我正在使用 contenteditable div 创建一个非常简单的 RTE，每次用户想要更改某些文本时都会动态创建该 RTE。基本上只是清除多余的 span、br 和 p 标签等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-13T23:26:52.990

使用 DOM 解析器。

这个想法是保留所有连续的`<br>`元素。每次出现非空文本元素或任何其他元素时擦除数组。

如果`<br>`在循环结束时有一个列表，则将其删除。这些是尾随`<br>`元素。

```
var $pp = document.getElementsByTagName("p");
for(var i = 0, $p = $pp[0], $br = [], alone = true; i < $pp.length; i = i + 1, $p = $pp[i], $br = [], alone = true){
  for(var j = 0, $child = $p.childNodes[0]; j < $p.childNodes.length; j = j + 1, $child = $p.childNodes[j]){
    if(($child.tagName !== "BR") && ($child.textContent.trim() !== "")){
      alone = false;
      $br = [];
    } else {
      $br.push($child);
    }
  }
  for(var j = 0; j < $br.length - alone; j = j + 1){
    $p.removeChild($br[j]);
  }  
} 
```

例如，

```
<p>Foo<br><br><br></p>
<p>Foo<br>Bar<br><br></p>
<p><br></p> 
```

变成

```
<p>Foo</p>
<p>Foo<br>Bar</p>
<p><br></p> 
```

[看这里。](http://jsfiddle.net/hGcRw/)

**免责声明**：我没有清理它。我稍后会回来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T22:40:05.250

你是对的，你[不能](https://stackoverflow.com/a/1732454/201952)使用正则表达式来解析 HTML，因为它们*不能*这样做。

是的，您还有其他选择。有几个最初针对 Node 的宽容的 HTML 解析 JS 库，但应该在浏览器中工作。

*   [html解析器](https://github.com/tautologistics/node-htmlparser)
*   [htmlparser2](https://github.com/fb55/node-htmlparser)
*   [HTML5 解析器](https://github.com/aredridel/html5)

您还可以利用浏览器具有内置 HTML 解析器这一事实，并使用它来解析您的 HTML。A[`DocumentFragment`](https://developer.mozilla.org/en-US/docs/DOM/DocumentFragment)在这种情况下可能有用。或者，在您的情况下，您可以简单地修改`contenteditable`元素中的 DOM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T22:47:50.763

这似乎过于复杂。您是否尝试过更简单的方法，例如：

```
<p>.+(<br>)+<\/p> 
```

这应该匹配`<br>`包含在段落中的任何内容，在它的最后（在结束标签之前）并且在它自己和开始标签之间有一些东西。您可能应该更改它，使其不接受空格作为有效的东西，但您明白了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-14T20:17:14.133

这是几行 jQuery：

```
// Note: in order to load the html into the dom it needs a root. I'm using `div`:
var input = '<div>' +
  '<p>Blah<br><br><br></p> becomes <p>Blah</p>' +
  '<p><br></p> stays the same.' +
  '</div>';

// Load the html into a jQuery object:
var $html = $(input);
// Get all the `<br>`s at the end of `p`s that are not the only-child:
var $lastBreaks = $html.find('p>:last-child:not(:only-child)').filter('br');
// Remove any immediately preceding `br`s:
$lastBreaks.prevUntil(':not(br)').remove();
// Remove the last `br`s themselves
$lastBreaks.remove();

// Output:
console.log($html.html()); 
```

输出：

```
<p>Blah</p> becomes <p>Blah</p><p><br></p> stays the same. 
```

[http://jsfiddle.net/nnH4G/](http://jsfiddle.net/nnH4G/)

这种方法比使用正则表达式更好的原因：

1.  你在做什么更明显。当您或其他开发人员稍后回到此问题时，您不必考虑“正则表达式到底是`%&^@!£%*cthulu&GJHS^&@`做什么的？”

2.  扩展/修改更容易。如果您的要求稍微复杂一点，那么使用（JavaScript 的）正则表达式实现这一点实际上是不可能的，[因为 Regex 和 HTML 在 Chomsky 层次结构中的相对位置](https://stackoverflow.com/a/1758162/1344760)。

3.  看到你的代码的人会认为你通常是一个很酷的人。

正如其他答案所指出的那样，jQuery 绝不是这样做的*唯一方法。*但考虑到它在客户端的普及程度，它是一个非常有用的工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-14T22:49:38.303

正则表达式解决方案（不是我建议您应该在 DOM 解析上使用它）：

从你的问题中我不清楚你想发生什么，例如，
`'<p><br><br></p>'`所以下面有两种解决方案。

如果你想让它保持原样，你可以使用 1）如果你想让它变成`'<p></p>'`你可以使用 2）：

**1)**

```
html = html.replace( 
    /<p>([\s\S]+?)(?:<br>)+<\/p>/g,
    function ( $0, $1 ) { return $1 == '<br>' ? $0 : '<p>' + $1 + '</p>' }
) 
```

测试

```
function test(html) {
    return html.replace( 
        /<p>([\s\S]+?)(?:<br>)+<\/p>/g,
        function ( $0, $1 ) { return $1 == '<br>' ? $0 : '<p>' + $1 + '</p>' }
    )
}

test( '<p>Blah</p>' );                // <p>Blah</p>
test( '<p>Blah<br><br><br></p>' );    // <p>Blah</p>   
test( '<p><br>Blah<br></p>' );        // <p><br>Blah</p>
test( '<p><br></p>' );                // <p><br></p>
test( '<p><br><br></p>' );            // <p><br><br></p> 
```

**2)**

```
html = html.replace( /(?:([^>]|[^pb]>)(?:<br>)+|(?:<br>){2,})<\/p>/g, '$1</p>' ); 
```

测试

```
function test(html) {
    return html.replace( /(?:([^>]|[^pb]>)(?:<br>)+|(?:<br>){2,})<\/p>/g, '$1</p>' );
}

test( '<p>Blah</p>' );                // <p>Blah</p>
test( '<p>Blah<br><br><br></p>' );    // <p>Blah</p>   
test( '<p><br>Blah<br></p>' );        // <p><br>Blah</p>
test( '<p><br></p>' );                // <p><br></p>
test( '<p><br><br></p>' );            // <p></p> 
```

# javascript - 碰撞后如何在 Box2dWeb 中移除身体

> ID：14308991
> 
> 赞同：5
> 
> 时间：2013-01-13T22:36:07.507
> 
> 标签：javascript, box2dweb

在 Update 函数内部，如果 2 个物体发生碰撞，我想移除它们（或将它们标记为需要移除，并在时间步结束时移除它们）。我将如何做到这一点？

在更新功能中我尝试

```
var bodyA = this.m_fixtureA.m_body;
...
bodyA.m_world.DestroyBody(bodyA); 
```

但是，它们不会被删除。似乎当我试图删除它们时，this.IsLocked() 设置为 true。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-21T22:41:16.473

如果 world.IsLocked() 函数返回 true，世界将不会移除物体。而 world.IsLocked() 将在世界处于一个步骤时返回 true。在步骤中移除物体可能会导致问题，因此在碰撞后销毁物体的正确方法是将它们注册到变量中，然后在步骤完成后销毁它们。

```
//Pseudo code:
var destroy_list = [];

// Your contact listener
var listener = function () {
  // Push the body you wish to destroy into an array
 destroy_list.push(body);
}

// The game interval function
var update = function () {
  // Destroy all bodies in destroy_list
  for (var i in destroy_list) {
    world.DestroyBody(destroy_list[i]);
  }
  // Reset the array
  destroy_list.length = 0;
} 
```

# javascript - 可以将 Google Map 的 Javascripts 放入资产管道（Rails）吗？

> ID：14308995
> 
> 赞同：9
> 
> 时间：2013-01-13T22:36:58.347
> 
> 标签：javascript, ruby-on-rails, asset-pipeline

我添加了将谷歌地图加载到我的页面所需的 javascript：

```
<% content_for :head do %>

<script type="text/javascript"
src="https://maps.googleapis.com/maps/api/js?key=API_KEY&sensor=false">
</script>
<script type="text/javascript">
function initialize() {
    var mapOptions = {
        center: new google.maps.LatLng(<%=@lat%>, <%=@lon%>),
        zoom: 5,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById("map_canvas"),
        mapOptions);
}
</script>

<% end %> 
```

如您所见，当我加载地图时，我需要传递参数纬度和经度。正如我在标题中所说，我想将这些 javascript 放入资产管道中，如果可以的话，有可能吗？谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-13T22:47:11.053

您不应在资产管道生成的`application.js`文件中包含 Google Maps API。相反，它应该作为单独的标签包含`<script>`在您的标签**之前**。`application.js``<script>`

然后，您可以将您的`initialize()`方法添加到资产管道中包含的任何文件中，包括`application.js`它自己。

您可能希望为您的方法制作`@lat`和`@lon`参数，`initialize`以便可以在您的页面中定义它们`<head>`。例如，您可能有

```
<head>
  <script src="https://maps.googleapis.com/maps/api/js?key=API_KEY&sensor=false"></script>
  <%= javascript_include_tag "application" %>

  <script>
    var latitude  = <%= @lat %>;
    var longitude = <%= @lon %>;
  </script>
</head> 
```

在你的`application.js`文件中你可能有

```
function initialize(latitude, longitude) {
  var mapOptions = {
      center: new google.maps.LatLng(latitude, longitude),
      zoom: 5,
      mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  var map = new google.maps.Map(document.getElementById("map_canvas"),
      mapOptions);
}

$(function() {
  initialize(latitude, longitude);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T23:12:00.137

这不能回答你的问题，但有一个谷歌地图宝石对我来说非常有用：[https ://github.com/apneadiving/Google-Maps-for-Rails](https://github.com/apneadiving/Google-Maps-for-Rails)

# unix - 符号链接目录或文件混淆

> ID：14308997
> 
> 赞同：-1
> 
> 时间：2013-01-13T22:37:13.300
> 
> 标签：unix, terminal, symlink

符号链接很棒，但我似乎很难记住如何知道是目录还是目录中的实际文件将被符号链接到新位置。

在这种情况下，我有一些文件位于 ~/Documents/WD/CS/CSlides，我希望将它们符号链接到此目录 ~/Documents/PDF/DB/CS/CSlides

我试过这个：

```
ln -s "~/Documents/WD/CS/CSlides/" "~/Documents/PDF/DB/CS/CSlides/" 
```

但这只是在目标文件夹中放置了一个新的 CSlides 文件夹。我只想链接源 CSlides 文件。不是目录本身。

有什么想法吗？

*   这是关于编程的。我试图移动与我的 Web 开发相关的文档。天哪，有些窥视有点过于挑剔，但如果它关闭了，那么它就关闭了。我终于把它整理好了。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-13T22:40:13.537

您不能“合并”目录，您必须像这样链接每个文件：

```
ln -s ~/Documents/WD/CS/CSlides/* ~/Documents/PDF/DB/CS/CSlides 
```