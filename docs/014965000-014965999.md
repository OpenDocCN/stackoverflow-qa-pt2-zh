# StackOverflow 问答 14965000-14965999

# ios - 在静音模式下录制和播放音频只需执行一次

> ID：14965000
> 
> 赞同：1
> 
> 时间：2013-02-19T18:42:52.323
> 
> 标签：ios, objective-c, avaudioplayer

我在视图控制器中录制音频并显示一个按钮供用户在第二个视图控制器上播放。

问题是我在第二个视图上使用此代码，因此即使在静音模式下也可以播放音频：

```
UInt32 sessionCategory = kAudioSessionCategory_MediaPlayback;
AudioSessionSetProperty (kAudioSessionProperty_AudioCategory,
                         sizeof(sessionCategory), &sessionCategory); 
```

但是当我回去录制第二个音频时，它不会在第二个屏幕上播放。

有这方面的线索吗？似乎我必须再次将这些设置更改为其原始设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T23:56:23.920

试试这个：

```
UInt32 sessionCategory = kAudioSessionCategory_PlayAndRecord;
    AudioSessionSetProperty (kAudioSessionProperty_AudioCategory,
                             sizeof(sessionCategory), &sessionCategory); 
```

前段时间我遇到了类似的问题，但我使用的是 AVAudioSession。问题是一样的，然后我发现了一件事，它可能对你有用：

记录工作正常，然后在我播放某些内容后它完全停止工作。问题是我通过调用将 AVAudioSession 重置为播放类别

```
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:nil]; 
```

在那之后录音停止工作。有两种方法可以修复它，将音频会话取消录制设置到`AVAudioSessionCategoryRecord`播放之前和之前，`AVAudioSessionCategoryPlayback`或者使用`AVAudioSessionCategoryPlayAndRecord`.

在我做了之后

```
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayAndRecord error:nil]; 
```

一切开始正常。

# c++ - 什么可能导致线程 id 为 -1？

> ID：14965001
> 
> 赞同：0
> 
> 时间：2013-02-19T18:42:57.817
> 
> 标签：c++, c++11, mutex, stdthread

[根据Herb Sutter 的介绍](http://channel9.msdn.com/Shows/Going+Deep/C-and-Beyond-2012-Herb-Sutter-Concurrency-and-Parallelism)，我目前一直在玩并发对象。我目前正在使用带有 11 月 CTP 的 Visual Studio 2012（无法以另一种方式检查下面的内容，Clang 不喜欢 decltypes 中的类成员，g++ 不喜欢 Windows 上的任何东西）。

这样做，我遇到了一个奇怪的错误，线程 ID 为 -1。考虑以下代码：

```
__workerThread([=]() -> void {    
    std::cerr << std::endl; 
    while (!__done) 
    { 
        this->__innerqueue.pop()(); 
    }    
}) 
```

这只是`std::thread`带有 lambda 函数的 a 的初始化——我想，没什么了不起的。但是如果没有第一行强制调用 std::cerr （没有优化），这个线程的 id 似乎是 -1 （由于调试器），否则，它应该是。

执行时出现此线程ID的问题

```
std::unique_lock<std::mutex> lock(this->__accessMutex); 
```

在[message-queue](https://github.com/DorianGrey/Concurrent/blob/master/concurrent/queue.hpp)内部，因为它在较低的 API (mutex.c) 中的某个地方崩溃。

有没有人知道可能导致这种奇怪行为的原因？目前添加调用`std::cerr`只是一个讨厌的解决方法，我想摆脱它......

如果您想使用它，可以在[Github](https://github.com/DorianGrey/Concurrent)上找到完整的源代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T13:33:36.587

它看起来像一个初始化程序问题。线程在并发队列完全创建之前运行（竞争）。可能会延迟线程足够长的`std::cerr`时间以使其工作。

尝试交换两行：

```
std::thread __workerThread;
mutable concurrent::queue<std::function<void()>, std::queue> __innerqueue; 
```

交换应该`__innerqueue`在线程之前创建，它应该像宣传的那样工作。

# java - 推广移动搜索算法以使用递归

> ID：14965002
> 
> 赞同：0
> 
> 时间：2013-02-19T18:43:02.453
> 
> 标签：java, algorithm, recursion, artificial-intelligence

我正在创建一个简单的 AI，它需要根据定义的策略规则评估董事会状态。游戏很像俄罗斯方块：你需要根据棋盘状态和下 N 个棋子的顺序（N 是一个变量）来决定当前的最佳移动。

换句话说，您必须使用片段队列中的第一块（例如具有多个“下一个”级别的俄罗斯方块）。

对于**单步前进**，这非常简单：

```
bestMove = function(Board board, piece piece)
{
     possibleMoves = getPossibleMoves(board, piece)
     bestMove = null
     bestScore = -INFINITY
     boardCp = clone(board)     

     for (move in possibleMoves)
     {
         tempBoard = applyMove(boardCp, move)
         if (tempBoard.score > bestScore)
         {
             bestMove = move
             bestScore = tempBoard.score
         }
         boardCp = undoMove(tempBoard, move)
     }

    return move
} 
```

现在，我如何将这个算法推广到 N 个前进？我不是递归专家，所以感谢您的帮助！

PS：我使用的是 Java，但欢迎使用任何语言或伪代码！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T18:57:41.307

这可以很容易地修改以将 N 步提前考虑在内。以递归或迭代方式。

```
bestMove = function(Board board, piece piece, int lookAhead)
{
 possibleMoves = getPossibleMoves(board, piece)
 bestMove = null
 bestScore = -INFINITY
 boardCp = clone(board)     

 for (move in possibleMoves)
 {
    /* just the original code */
     if(lookAhead <= 1) {
         tempBoard = applyMove(boardCp, move)
         if (tempBoard.score > bestScore)
         {
             bestMove = move
             bestScore = tempBoard.score
          }
         boardCp = undoMove(tempBoard, move)
     }

     /* recursion, can be changed to a loop */
     else {
        tempBoard = applyMove(boardCp, move)                // apply
        move2 = bestMove(tempBoard, piece, lookAhead-1)     // dive and get best 
        boardCp = undoMove(tempBoard, move)                 // (1) check how good it actually is
        tempBoard = applyMove(boardCp, move2)
        if (tempBoard.score > bestScore)
         {
             bestMove = move2
             bestScore = tempBoard.score
          }
        boardCp = undoMove(tempBoard, move2)                // generaly I'd refactor both if-else paths and reuse some code
     }
  }

return bestMove
} 
```

如果你可以从一个函数返回 2 个值，那么`(1)`就没有必要了——你需要移动和它的分数。

顺便提一句。您是否阅读过有关 min-max、alfa-beta（带有修剪）算法的信息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:17:23.897

纯递归算法。不知道你的下一个作品是如何组织的，所以在这里我使用了一个队列来假设。克隆不是最有效的，所以有点取决于你的数据结构。

```
 function getBestPossibleScore(Board board, Queue<piece>nextPieces){
         if (nextPieces.isEmpty())
             return board.score;
         piece = piece.pop();
         possibleMoves = getPossibleMoves(board, piece)   

         bestScore = -INFINITY
         boardCp = clone(board)     

         for (move in possibleMoves)
         {
             tempBoard = applyMove(boardCp, move)
             curentScore = getBestPossibleScore(tempBoard,nextPieces.clone());
             if (currentScore > bestScore)
             {            
                 bestScore = currentScore
              }
             boardCp = undoMove(tempBoard, move)
          }

        return board.score+bestScore;
    }
     function getBestMove(Board board, Queue<piece> nextPieces)
        {

         piece = piece.pop();
         possibleMoves = getPossibleMoves(board, piece)   
         bestMove=null;
         bestScore = -INFINITY
         boardCp = clone(board)     

         for (move in possibleMoves)
         {
             tempBoard = applyMove(boardCp, move)
             currentScore = getBestPossibleScore(tempBoard,nextPieces.clone());
             if (currentScore > bestScore)
             {            
                 bestScore = currentScore
                 bestMove=move;
              }
             boardCp = undoMove(tempBoard, move)
          }

        return bestMove
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:09:50.470

我帮不了你，但我可以向你推荐这个[MinMax 算法](http://en.wikipedia.org/wiki/Minimax)，这是我在我的 AI 大学课程中使用的。

伪代码，如果有用的话：

```
function integer minimax(node, depth)
  if node is a terminal node or depth <= 0:
    return the heuristic value of node
  α = -∞
  for child in node:       # evaluation is identical for both players 
    α = max(α, -minimax(child, depth-1))
  return α 
```

该算法资产对手尽其所能（基于评估函数）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T19:38:00.703

对此采取伪代码方法。我的第一选择始终是带有 alpha beta pruning 的 minimax，因为它是解决与您类似的问题的常用且经过验证的方法。

但如果你想做一些不同的事情。

```
List moves = new list()
Best board = current board    

While (queue is not empty){
    grab the next item in the queue.
    Implement your algorithm.
    add the move to the move list.
    update the best board
} 
```

不是最好的但非常简单的方法，然后为您提供基于队列的移动列表。您只需将棋盘状态从前一个最佳棋盘转移到算法棋盘元素中，然后将队列中的下一个棋盘状态转移到算法的片段参数中。

# mysql - 防止数据库表行被删除和更新

> ID：14965004
> 
> 赞同：0
> 
> 时间：2013-02-19T18:43:09.263
> 
> 标签：mysql, phpmyadmin

我有一个想要保护某些行不被删除和更新的数据库表。我正在使用 MySQL 数据库。如何在 phpmyadmin 或 sql 语法中修复它？

**EX：**防止行`id:18`删除和更新：

![在此处输入图像描述](../Images/41dd10192a65e9d5165dee6b0f8cb529.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T18:47:25.583

您有多种选择。

**SESSION WISE：如果您使用的是 INNODB**

```
SET AUTOCOMMIT=0;
UPDATE table SET mainpage =1 WHERE id = 18;
-- do NOT commit until you want to release the lock.
-- if you do that under myisam, 
-- I think it is going to lock the whole table (to be verified) 
```

**结构保护**

在更新/删除表之前创建触发器，并在发生错误时引发错误`:new.id = 18`

# debugging - VS2012 调试不启动浏览器

> ID：14965008
> 
> 赞同：2
> 
> 时间：2013-02-19T18:43:26.867
> 
> 标签：debugging, iis, browser, visual-studio-2012, iis-express

我有一个 MVC4 应用程序，我已经开发了一段时间，直到现在我一直连接到 IIS 以进行调试，坦率地说，这只是变得很痛苦，更不用说它并不总是可靠的。

我刚刚将项目切换为使用带有 localhost url 的 IIS Express，例如：

```
http://localhost:54275/ 
```

现在，当我按 F5 或在调试工具栏中选择其他浏览器时，VS 启动，IISExpress 启动并显示应用程序正在侦听，但没有启动或最大化浏览器并加载页面。

我试过以管理员和普通帐户运行 VS2012，但这似乎对它没有任何影响。

谷歌似乎也没有在这方面提出任何有用的信息。有想法该怎么解决这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:09:10.393

右键单击项目，单击属性：

![](../Images/56202af948eb311905047d5aaa5eaae8.png)

如果下面的图标不在您的任务栏中，请单击此按钮：

![](../Images/00e4f05d1f960904d93df9ec3e4e58f8.png)

在任务栏中，右键单击此图标：

![](../Images/d20122e51ab00f9167d6ff8ade3cccf9.png)

在列表中找到应用程序：

![](../Images/6fd1808c9db1dcc409d6e63711b0b323.png)

点击打开浏览器：

![](../Images/c81227166e7ba8543608919716215365.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-22T13:54:34.917

换句话说，要在 F5 上自动打开 IE（开始调试），请遵循此过程。

1）右键单击项目，单击属性：

[![VS2015 项目属性](../Images/014e313c24e9da02571787aafe63d741.png)](https://i.stack.imgur.com/yZOY9.png)

2）将“当前页面”或“特定页面”设置为开始操作。

# jquery - 如何编写此代码以消除重复？

> ID：14965012
> 
> 赞同：0
> 
> 时间：2013-02-19T18:43:37.827
> 
> 标签：jquery, iframe, upload, code-duplication

我有一个文件上传，它做了一些事情，但主要是

1.  使用 iframes 模拟 ajax（ajax 不能处理文件数据，至少不能跨浏览器）
2.  如果需要，创建（克隆）新的上传输入，如果不需要，则删除
3.  允许同时上传多个文件（使用多个 iframe）

我遇到的问题是，目前我正在使用 4 个 iframe，但我必须创建 4 个 iframe，并且每个 iframe 都有一些冗长的代码，即使代码做同样的事情，只是使用不同的变量名/id等等

我希望有人可以帮助简化我的代码，如果可能的话，可以在需要时创建额外的 iframe（即，如果同时上传超过 4 个文件）。

代码相当冗长，我把它剥离回（希望）你们需要的东西，所以 HTML：

```
<iframe id="upload_target1" name="upload_target1" class="upload-target" current="current"></iframe>
<iframe id="upload_target2" name="upload_target2" class="upload-target" current="no"></iframe>
<iframe id="upload_target3" name="upload_target3" class="upload-target" current="no"></iframe>
<iframe id="upload_target4" name="upload_target4" class="upload-target" current="no"></iframe> 
```

jQuery 处理我通过 iframe 发送的表单，设置其目标 iframe 并设置返回数据时使用的变量：

```
var $fi = $visible.find(".file-info");
        if($('#upload_target1').attr('current') == 'current'){
            $('.file-upload-form').attr('target','upload_target2');
            $('#upload_target1').attr('current','no');
            $('#upload_target2').attr('current','current');
            thisPreview2 = $fi.prev(".image-preview");
        }else if($('#upload_target2').attr('current') == 'current'){
            $('.file-upload-form').attr('target','upload_target3');
            $('#upload_target2').attr('current','no');
            $('#upload_target3').attr('current','current');
            thisPreview3 = $fi.prev(".image-preview");
        }else if($('#upload_target3').attr('current') == 'current'){
            $('.file-upload-form').attr('target','upload_target4');
            $('#upload_target3').attr('current','no');
            $('#upload_target4').attr('current','current');
            thisPreview4 = $fi.prev(".image-preview");
        }else{
            $('.file-upload-form').attr('target','upload_target1');
            $('#upload_target4').attr('current','no');
            $('#upload_target1').attr('current','current');
            thisPreview1 = $fi.prev(".image-preview");
        } 
```

用于 ioframe 加载的 jquery：

```
$('#upload_target1').load(uploadDone1);
$('#upload_target2').load(uploadDone2);
$('#upload_target3').load(uploadDone3);
$('#upload_target4').load(uploadDone4);

function uploadDone1() {
    var returnedValues = $('#upload_target1').contents().find('body').text().split(' ');
    var insertID = returnedValues[0];
    var imgName = returnedValues[1];
    var image =$('<img>').attr('src','images/listing-images/'+imgName);
    $('.insertID-hidden').attr('value',insertID);
    image.appendTo(thisPreview1);
    thisPreview1.css('border','1px solid #ffffff');
    thisPreview1.closest(".file-container").children(".loading").fadeOut(100);
    setTimeout(showUploadedDelete, 200);
    function showUploadedDelete(){
        var uploaded = $('<div>').addClass('file-uploaded');
        uploaded.appendTo(thisPreview1.next());
        thisPreview1.closest(".file-container").children(".file-clear").fadeIn(100);
        thisPreview1.next().children().fadeIn(100);
    }
}

function uploadDone2() {
    (the same as uploadDone1, but uses variable thisPreview2 and upload_target2, and so on upto 4)
} 
```

我希望这表明我查询一个 iframe 是否设置了“当前”属性，如果有，则使用下一个 iframe 发送表单，并设置一个全局变量以在 iframe 加载时使用（thisPreview )，但对于每个 iframe/表单提交都是唯一的。

正如您所看到的，有很多重复的代码，并且它仅限于我重复它的次数，而我希望有一个“无限”的解决方案？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:28:34.217

您可以使用的一个简单技巧如下：

```
$('#upload_target1').load(uploadDone(1));
$('#upload_target2').load(uploadDone(2));
$('#upload_target3').load(uploadDone(3));
$('#upload_target4').load(uploadDone(4)); 
```

然后只定义一个函数并连接你刚刚发送的参数（例如在uploadDone函数的第一行我做了一个连接）。仔细查看并检查您需要更多连接的位置：

```
function uploadDone(counter) {
    var returnedValues = $('#upload_target'+counter).contents().find('body').text().split(' ');
    var insertID = returnedValues[0];
    var imgName = returnedValues[1];
    var image =$('<img>').attr('src','images/listing-images/'+imgName);
    $('.insertID-hidden').attr('value',insertID);
    image.appendTo(thisPreview1);
    thisPreview1.css('border','1px solid #ffffff');
    thisPreview1.closest(".file-container").children(".loading").fadeOut(100);
    setTimeout(showUploadedDelete, 200);
    function showUploadedDelete(){
        var uploaded = $('<div>').addClass('file-uploaded');
        uploaded.appendTo(thisPreview1.next());
        thisPreview1.closest(".file-container").children(".file-clear").fadeIn(100);
        thisPreview1.next().children().fadeIn(100);
    }
} 
```

# php - Yii findAllByAttributes 与 BETWEEN DATES 和 ORDER BY

> ID：14965013
> 
> 赞同：10
> 
> 时间：2013-02-19T18:43:41.793
> 
> 标签：php, yii

我想在给定的日期范围内按属性进行搜索，并按创建日期排序，但没有运气。

```
$user = array('user_country'=>1 ,'user_gender'='M');
    $rows = User::model()->findAllByAttributes($user,array("user_date_created BETWEEN '2012' AND '2013' " ,'order'=> 'user_date_created') ); 
```

先感谢您。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-19T19:49:34.017

必须使用[CDbCriteria](http://www.yiiframework.com/doc/api/1.1/CDbCriteria)，如下所示：

```
$attribs = array('user_country'=>1 ,'user_gender'=>'M');
$criteria = new CDbCriteria(array('order'=>'user_date_created DESC','limit'=>10));
$criteria->addBetweenCondition('user_date_created', $date['date_start'], $date['date_end']);
$rows = user::model()->findAllByAttributes($attribs, $criteria); 
```

希望它对将来的人有所帮助

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-04T02:20:14.653

您可以用来：

```
$criteria = new CDbCriteria;
$criteria->condition = "date_start >= '$date_start' AND date_end <= '$date_end'";
$model = TemporadaAlta::model()->find($criteria); 
```

# ckeditor - CKEditor 自定义样式集覆盖默认值

> ID：14965014
> 
> 赞同：2
> 
> 时间：2013-02-19T18:43:44.183
> 
> 标签：ckeditor

我正在测试添加自定义样式集。因此，在我的代码中，我添加了以下内容（根据[说明](http://docs.cksource.com/CKEditor_3.x/Developers_Guide/Styles)）

```
CKEDITOR.stylesSet.add('custom_style', [
  { name: 'No UL Bullets', element: 'ul', styles: { 'list-style-type': 'none' } },
  { name: 'My Custom Inline', element: 'span', attributes: { 'class': 'mine' } }
]);

oEditor.config.stylesSet = 'custom_style'; 
```

问题是它覆盖了 CK​​Editor 附带的其余默认样式。我似乎无法弄清楚如何将我的新样式附加到现有的样式中。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T08:49:57.017

您无需更改`config.stylesSet`选项即可将样式附加到默认样式。您可以编辑`styles.js`文件，从中添加和删除样式。它是一个配置文件，就像`config.js`.

**更新**：您可以`config.stylesSet`直接设置以避免加载`styles.js`：

```
CKEDITOR.replace( 'editor1', {
    stylesSet: [
        { name: 'Big',              element: 'big' },
        { name: 'Small',            element: 'small' },
        { name: 'Typewriter',       element: 'tt' }
    ]
} ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-08T14:09:56.413

这是一个如何在 CKEditor 4 中替换和创建新样式和类的示例。这是文件***styles.js***的全部内容：

```
CKEDITOR.stylesSet.add ('default', [
/* My Block Styles */
{ name: 'My Div Class', element: 'div', attributes: {'class': 'my-div-class-name'} },
{ name: 'My Div Style', element: 'div', styles: {'padding': '10px 20px', 'background': '#f2f2f2', 'border': '1px solid #ccc'} },

/* My Inline Styles */
{ name: 'My Span Class', element: 'span', attributes: {'class': 'my-span-class-name'} },
{ name: 'My Span Style', element: 'span', styles: {'font-weight': 'bold', 'font-style': 'italic'} }

]); 
```

编辑栏：

![在此处输入图像描述](../Images/462c2d94a751580a0e075131fda5eab7.png)

# intellij-idea - 将存储库中的所有 jar 添加为 IntelliJ 中的依赖项

> ID：14965016
> 
> 赞同：4
> 
> 时间：2013-02-19T18:43:47.017
> 
> 标签：intellij-idea, repository, dependency-management

我的项目中有一个专家存储库，我想将存储库中包含的所有 jar 添加到 IntelliJ 的依赖项列表中。我可以一次添加一个罐子，但我希望能够一次添加所有罐子。

有没有办法添加在所有目录/子目录中找到的所有 jar？

***详细信息：** IntelliJ 12*

***更新：**我无法更改存储库结构，它会在 ant 构建时自动填充。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-20T02:27:24.053

支持从目录添加 jars，但不支持递归，请[投票支持此功能请求](http://youtrack.jetbrains.com/issue/IDEA-40818)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T18:46:17.620

是的，您可以将所有 jar 添加到一个文件夹中。您必须创建一个库并选择选项：“附加文件或目录”并选择一个目录。这样，即使将来对目录的更改也将可见。

# api - 编写 API，好处：自动包含嵌套对象，根本不包含，或者提供参数来指定要包含的对象？

> ID：14965017
> 
> 赞同：0
> 
> 时间：2013-02-19T18:43:52.883
> 
> 标签：api, relation, nested-includes

例如，我们有一个名为的实体`ServiceConfig`，其中包含 a`pointer`到 a`Service`和 a `Professional`。如果返回时不包含字段，则如下所示：

```
{
    'type': '__Pointer', 
    'className': 'Service', 
    'objectId': 'q92he840'
} 
```

此时他们可以再次查询以检索该服务。但是，通常情况下他们需要`Service`名称。在这种情况下，每次都必须再次查询以获取服务是低效的。

选项：

1.  自动返回`Service`. 在这种情况下，我们也应该自动返回`Industry`for that`Service`以防他们需要...同样适用于所有人。似乎我们在这里过于频繁地返回数据。

2.  允许他们传递`includes`指定要包含的实体的参数。格式是一个字符串数组，其中使用 a`.`可以允许它们包含子类。在这种情况下`['Professional', 'Service.Industry']`会起作用。

谁能确定为什么任何一种解决方案都会比其他解决方案更好？我觉得最后一个解决方案是最好的，但是在我见过的 API 中似乎并不常见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T04:10:18.047

在发布初始版本之前，这是一个很好的 API 设计决策。您的两种方法都是有效的，这完全取决于您认为客户使用您的 API 的最常见方式。

您可以考虑以下几点：

1.  您可能更喜欢不预先提供所有数据的第一种方法。有时它与效率有关，有时也与安全性有关，并确保仅根据需要和授权获取任何其他重要数据。
2.  实施第二种方法将需要您的部分团队投入更多精力来设计/编码和测试 API。因此，您可能需要考虑要在 1.0 版中投入多少精力
3.  例如，由于您有嵌套数据，因此第二种方法将为您提供很好的服务。事实上，有几个公共 API 可以做到这一点。例如，查看 LinkedIn 公共 API，尤其是[facets](https://developer.linkedin.com/documents/people-search-api)部分，您可以在其中指定要返回的字段或附加信息。
4.  查看您编写的一些客户端应用程序，如果您可以确定是否需要一些数据，那么它可以帮助设计返回数据。
5.  最终监控 API 使用情况并对调用次数进行一些分析，调用的方法将为您提供下一步该做什么的良好输入。

如果我必须做出选择并且在努力方面有更多的余地，我会选择第二个选项，即使它一开始是一个简单的版本。

# java - 消息树列表

> ID：14965018
> 
> 赞同：0
> 
> 时间：2013-02-19T18:43:53.300
> 
> 标签：java, data-structures

我有一个不错的任务，但不确定这里的优化版本是什么。这是单线程环境。

在 Thunderbird 中，您可以将消息视为树。这将是一个树列表。单击可以从根导航到叶并返回的树元素，可能有其他邮件客户端，但我没有使用其他邮件客户端。这里的任务类似：在树视图中显示消息列表。

```
Message1
  Message1.1
  Message1.2
     Message1.2.1
Message2
Message3
   Message 3.1 
```

等等……我有一个`Vector<Message> myMessages`

消息简化的 POJO 将是这样的：

```
class Message{
      int id;
      int parentID;
      String topic;
      String content;
} 
```

我的问题很简单：应该使用什么数据结构来存储那棵树？一个 LinkedHashMap 与那些mesageid 的键，它是 parentID = null （主题中的第一条消息），值应该是一个包含所有消息的 ArrayList？- 还是嵌套的 LinkedHashMap？

如何存储 Message 1.2.1 以轻松知道他的父母是谁？

更新：它将在 GWT/html 中列出，而不是 Swing

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T18:48:11.240

您是否考虑[过 JTrees](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html#data)和底层的[TreeModel](http://docs.oracle.com/javase/7/docs/api/javax/swing/tree/TreeModel.html)？我不清楚您是否要*显示*您的数据，但无论如何我都会尝试利用这项工作，因为它功能丰富并且看起来很适合您的问题。

更新：当您使用 GWT 时，请查看[GWT 树](http://examples.roughian.com/index.htm#Widgets~Tree)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T18:51:28.537

¿ 您是否考虑过使用 JAXB？您可以拥有一个 XSD，其中包含您想要的消息结构，它将生成一个 java 类，例如： MessageType 然后您可以为您的消息创建一个数组，您可以从 getter 方法获取子属性。

# javascript - JavaScript 中子字符串行为的明显问题

> ID：14965020
> 
> 赞同：1
> 
> 时间：2013-02-19T18:43:57.067
> 
> 标签：javascript, string, substring, state-machine

我正在编写一个递归算法，通过解析正则表达式来构建一个有限状态自动机。自动机遍历表达式，将字符推入堆栈，将操作符推入“操作符堆栈”。当我遇到“（”（表示分组操作）时，我将一个“子自动机”压入堆栈，并将模式的其余部分传递给子自动机进行解析。当该自动机遇到“）”时，它会传递其余的到父自动机完成解析的字符串。这是代码：

```
var NFA = function(par) {
  this.stack = [];
  this.op_stack = [];
  this.parent = par;

};

NFA.prototype.parse = function(pattern) {
  var done = false;
  for(var i in pattern) {
    if (done === true) {
      break;
    }
    switch(pattern.charAt(i)) {
      case "(":
        var sub_nfa = new NFA(this);
        this.stack.push(sub_nfa);
        sub_nfa.parse(pattern.substring(i+1, pattern.length));
        done = true;
        break;
      case ")":
        if (this.parent !== null) {
          var len = pattern.length;
          /*TROUBLE SPOT*/
          this.parent.parse(pattern.substring(i, pattern.length));
          done = true;
          break;
        }
      case "*":
        this.op_stack.push(operator.KLEENE);
        break;
      case "|":
        this.op_stack.push(operator.UNION);
        break;
      default:
        if(this.stack.length > 0) {
          //only push concat after we see at least one symbol
          this.op_stack.push(operator.CONCAT);        
        }
        this.stack.push(pattern.charAt(i));
    }
  }
}; 
```

注意标有“故障点”的区域。给定正则表达式“(a|b)a”，调用 this.parent.parse 只被调用一次：当子自动机遇到“)”时。此时，pattern.substring(i, pattern.length) = ")a"。这“有效”，但它不正确，因为我需要在将字符串传递给父自动机之前使用“）”输入。但是，如果我将调用更改为 this.parent.parse(pattern.substring(i+1, pattern.length)，则解析会得到空字符串！我已尝试单步执行代码，但无法解释此行为。什么是我失踪了？

在 Juan 的建议下，我做了一个快速的 jsfiddle 来显示在尝试使用该算法解析“(a|b)a”时出现的问题。在 ")" 的情况下，它使用 i 索引处的子字符串和 i+1 索引处的子字符串填充一个空 div。它表明，虽然 i 处的子字符串中有 2 个字符，但 i+1 处的子字符串是空字符串！这是链接：http: [//jsfiddle.net/XC6QM/1/](http://jsfiddle.net/XC6QM/1/)

编辑：我编辑了这个问题以反映使用 charAt(i) 不会改变算法行为的事实。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:15:54.040

I think the previous answer was on the right track. But there also looks to me to be an off-by-one error. Shouldn't you be increasing the index for your substring? You don't want to include the ")" in the parent parse, right?

```
this.parent.parse(pattern.substring(i + 1, pattern.length)); 
```

But this will still fail because of the error Juan mentioned. A quick temporary fix to test this would be to convert the `i` to a number:

```
this.parent.parse(pattern.substring(+i + 1, pattern.length)); 
```

This might do it for you. But you should probably go back and switch away from the `for-in` loop on the string. I think that's causing your issue. Turn it into an array with `str.split('')` and then use an integer to loop. That will prevent further such issues.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T18:46:59.917

真正的问题是您使用 a`for in`来遍历字符串的字符。使用`for in` 循环，您`i`将成为一个字符串，因此，当您尝试执行时`i+1`，它会进行字符串连接。

如果您将迭代更改为

```
for(var i=0; i < pattern.length; i++) { 
```

然后一切正常[http://jsfiddle.net/XC6QM/2/](http://jsfiddle.net/XC6QM/2/)

斯科特的回答正确地确定了问题，但我认为他的解决方案（将索引转换为数字）并不理想。你最好从一个数字索引开始循环

此外，您不应使用括号来访问字符串中的字符，[这在 IE 7 中不起作用](https://stackoverflow.com/questions/5943726/string-charatx-or-stringx)

```
 switch(pattern[i]) { 
```

应该

```
 switch(pattern.charAt(i)) { 
```

# javascript - jQuery Mobile 双页脚

> ID：14965021
> 
> 赞同：2
> 
> 时间：2013-02-19T18:44:19.020
> 
> 标签：javascript, css, jquery-mobile, footer

我有一个非常简单的 jQuery 移动页面，并且想在页面底部的页脚正上方显示版权消息。

在页脚中，我有几个按钮，版权信息应该以**小的纯文本**形式出现在页脚上方的右角……我认为它是一种双页脚。

当我将版权信息添加到页脚时，它将继承不需要的页脚数据主题。当我将它添加到我的网站内容时，它不会在页面底部显示版权。任何关于在哪里注入我的版权信息的提示都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:53:59.433

理想情况下，我需要查看一些 html 来尝试解决您的确切问题，但是您想要的要点是：

```
<div style="position: absolute; bottom: 0; width: 100%">
     <div style="width: auto; text-align: right">Copyright...</div>
     <div style="border: 2px solid red; width: auto">footer</div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T00:20:18.597

使用一些 CSS 魔法很容易

1.  创建一个“版权”CSS 类：

> ```
> .copyright {    
>   font-size: 0.75em;    
>   margin-top: -20px;   
>   float:right;    
>   padding-right: 5px; 
> } 
> ```

备注：
一。'margin-top' 使它呈现在您的页脚上方 b。'float:right' 放在屏幕的右侧。如果需要，使用 'float:left' 或 'float:center'。

1.  在您的页脚中，使用版权类。

> ```
> < div data-role="footer">
>   < span class='copyright'>&copy; My Company Ltd</span>
>   < h4>Footer </h4>
>   < a href="#" data-rel="back" data-icon="home">Home</a>
> < /div> 
> ```

# c# - 为什么条码文本值不打印在条码下方？

> ID：14965025
> 
> 赞同：0
> 
> 时间：2013-02-19T18:44:29.347
> 
> 标签：c#, compact-framework, windows-ce, zebra-printers, opennetcf

我正在使用 Windows Compact Framework 打印到使用 OpenNetCF 串行端口类和 CPCL 的 Zebra 皮带打印机。打印的标签与应有的差不多，但条码值并未按应有的方式打印在条码下方。

我创建了一个要发送到打印机的命令的 ArrayList，然后一次将它们传递给串行端口。如果提供值的控件为空，我会使用一些虚拟数据，如下所示：

```
 private void btnPrint_Click(object sender, System.EventArgs e)
    {
        string listPrice = txtList.Text;
        if (listPrice.Trim() == string.Empty)
        {
            listPrice = "3.14";
        }
        string description = txtDesc.Text;
        if (description.Trim() == string.Empty)
        {
            description = "The Life of Pi";
        }
        string barcode = txtUPC.Text;
        if (barcode.Trim() == string.Empty)
        {
            barcode = "01701013992";
        }

        ArrayList arrList = new ArrayList();

        arrList.Add("! 0 200 200 120 1\r\n"); // replace 120 with label height if different than 1.25"/120 pixels (at 96 pixels per inch)
        arrList.Add("RIGHT\r\n");
        arrList.Add(string.Format("TEXT 0 5 0 0 {0}\r\n", listPrice)); 
        arrList.Add("LEFT\r\n");
        arrList.Add(string.Format("TEXT 0 0 0 52 {0}\r\n", description)); 
        arrList.Add("CENTER\r\n");
        arrList.Add("BARCODE-TEXT 0 0 5\r\n");
        arrList.Add(string.Format("BARCODE 128 1 1 50 0 77 {0}\r\n", barcode)); 
        arrList.Add("FORM\r\n");
        arrList.Add("PRINT\r\n");

        PrintUtils pu = new PrintUtils();
        pu.PrintLabel(arrList);
    }

    public void PrintLabel(ArrayList linesToSend)
    {
        using (SerialPort serialPort = new SerialPort())
        {
            serialPort.BaudRate = 19200;
            serialPort.Handshake = Handshake.XOnXOff;
            serialPort.DataBits = 8;
            serialPort.Parity = Parity.None;
            serialPort.StopBits = StopBits.One;
            serialPort.PortName = "COM1:";
            serialPort.Open();

            Thread.Sleep(500); //this may not even be necessary and, if so, a different value may be better

                        foreach (string line in linesToSend)
            {
                serialPort.Write(line);
            }

            serialPort.Close();
        }
    } 
```

...问题是标签（当我允许打印虚拟数据时）应该是：

```
 3.14
The Life of Pi
    <barcode here>
    01701013992 
```

...这是真正打印的内容：

```
 3.14
The Life of Pi
    <barcode here>
    [blank] 
```

所以问题是条形码作为文本（“01701013992”）没有打印在条形码下方。

有谁知道为什么会发生这种情况，即使我在那里有一个 BARCODE-TEXT 命令，以及如何纠正它？

## 更新

我收到了一条关键信息，即标签高度（在我的情况下）应该是 254，而不是 120（对于我的 1.25 英寸高度标签，我是根据 96 像素 == 1 英寸计算的，但实际上这个特定的打印机是 203 dpi，所以 1.25 X == 254（更准确地说是 253.75，但 254 已经足够接近了）。

所以代码变成了这样：

```
// Command args (first line, prepended with a "!": horizontal (X) pos, resolution, resolution, label height, copies
// TEXT args are: fontNumber, fontSizeIdentifier, horizontal (X) pos, vertical (Y) pos
// BARCODE args are: barcodeType, unitWidthOfTheNarrowBar, ratioOfTheWideBarToTheNarrowBar, unitHeightOfTheBarCode, 
//      horizontal (X) pos, vertical (Y) pos, barcodeValue
// BARCODE-TEXT args are: fontNumber, fontSizeIdentifier, space between barcode and -text
// 1 inch = 203 dots (Zebra QL220 is a 203 dpi printer); font 4,3 == 90 pixels; font 2,0 == 12 pixels
arrList.Add("! 0 200 200 254 1\r\n"); // 203 dpi X 1.25 = 254
arrList.Add("RIGHT\r\n");
arrList.Add(string.Format("TEXT 4 3 0 0 {0}\r\n", listPrice)); 
arrList.Add("LEFT\r\n");
arrList.Add(string.Format("TEXT 2 0 0 100 {0}\r\n", description)); 
arrList.Add("BARCODE-TEXT 2 0 5\r\n"); 
arrList.Add("CENTER\r\n");
arrList.Add(string.Format("BARCODE 128 1 1 50 0 120 {0}\r\n", barcode)); 
arrList.Add("FORM\r\n");
arrList.Add("PRINT\r\n"); 
```

...但我仍然没有看到描述标签 - 除了“3”和“。”下方的孤独的“P”。在价格上。

是我的计算错误，还是什么？

这就是我认为我所拥有的：

标签高 254 点/1.25 英寸。

第一行从 YPos 0 开始，以 90 像素字体打印“3.14”，右对齐。那打印得很好。

第二行从 YPos 100 开始（在 90 点的第一行下方 10 个点），左对齐。我所看到的只是前面提到的“P”，尺寸似乎合适。

第三行是条形码，位于 YPos (120) 处，居中；打印良好

第四行/最后一行是条形码作为条形码下方的文本，居中；打印良好。

注意：我还不能为此悬赏，但任何解决它的人我都会尽快奖励 100 分（我估计在两天内）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T16:53:45.373

事实证明，问题在于我使用字体 #2 来获得 12 的字体大小（它是唯一提供该大小的字体）。字体#2 的问题在于它是“OCR-A”，因此只打印某些字符。在我作为测试通过的字符串中（“Pi 的生命”，以及 3.14 的标价），它在该字符串中识别的唯一字符是 P。这就是为什么它是我看到的唯一一个。

我不得不将我的字体大小增加到下一个可用的大小，即 24，使用字体 #5（曼哈顿）或 7（华威）。

来自 zebra 的“mk”为我提供了此信息（“ *OCR 字体是一种特殊字体，不包括您尝试打印的所有字符。* ”）。

如果您查看 CPCL 编程手册中的附录 D，它确实将字体 #2 显示为“OCR-A”，但我并没有意识到这意味着它的字符集排除了大多数字母字符。即使这对某些人来说很明显，但在我看来应该在手册中强调：打印文本时，不要使用 #2 字体！

注意：文本也应避免使用字体#6 (MICR)。

# r - 子集时带有因子的R大数据框不会缩小

> ID：14965029
> 
> 赞同：2
> 
> 时间：2013-02-19T18:44:50.337
> 
> 标签：r, character, subset, r-factor

我有一个包含多个因子变量的大型数据框（100k Row x 50 Col）。我想要一个小子集（比如 100 行）来做一些原型设计。问题是当我输入：

```
train <- train[1:100,] 
```

大小缩小（使用`dim()`），但它似乎仍然存储了原始数据帧中的所有因素（我正在使用`lsos()`找到[的here](https://stackoverflow.com/questions/1358003/tricks-to-manage-the-available-memory-in-an-r-session)测量内存大小）。

有没有办法解决这个问题？到目前为止，我发现的唯一方法是将因子变量转换为字符串，然后是子集，然后再次转换为因子。我觉得必须有更好的方法来做到这一点。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T18:46:31.923

使用`droplevels`函数删除不在新 data.frame 中的级别，`?droplevels`更多信息请参见。

例子：

```
> DF <- data.frame(num=1:15, letter=rep(letters[1:5], each=3),random=rnorm(15))
> levels(DF[, 2]) # all levels
[1] "a" "b" "c" "d" "e"
> 
> DF2 <- DF[1:10, ] # subseting
> levels(DF2[, 2]) # all levels again
[1] "a" "b" "c" "d" "e"
> DF2[, 2] <- droplevels(DF2[, 2])
> levels(DF2[, 2]) # only the levels contained in DF2
[1] "a" "b" "c" "d" 
```

# eclipse - 为 eclipse ganymede 安装附加软件

> ID：14965035
> 
> 赞同：0
> 
> 时间：2013-02-19T18:45:08.223
> 
> 标签：eclipse, ganymede

出于某种原因，我必须使用旧版本的 eclipse Ganymede 进行开发。安装时，它只有 JDT 用于编程 java。我想为 C 编程添加 CDT。但我不知道这个版本的更新站点。我试过这个链接：

```
http://download.eclipse.org/releases/ganymede 
```

但是这个链接无济于事。请告诉我。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:00:10.300

我自己解决了这个问题。而是从 Eclipse 安装，您可以从终端安装。

```
su
// typing your root password here
yum install eclipse-cdt 
```

这种方法不仅适用于这个版本，而且适用于所有其他版本。希望这会帮助许多其他人。

# jquery - 如何将内容从服务器加载到 jQuerymobile 页面中？

> ID：14965043
> 
> 赞同：1
> 
> 时间：2013-02-19T18:45:30.053
> 
> 标签：jquery, html, ios, mobile

我正在开发一个使用 jQuerymobile 元素制作 UI 的应用程序。

它运行平稳，一切正常，但我想从服务器加载内容，而不是在本地加载它们。

目前，我的应用程序具有通常的 iOS 文件 + HTML，它们构成了应用程序 UI，并具有执行命令的按钮。（此应用程序仅适用于越狱的 iDevices）。

问题是我不想链接到可以调整的本地存储文件...我正在尝试使应用程序尽可能安全，因为它将包含指向数据的直接链接，即使即使有些人不知道该应用程序是如何工作的。

如何使按钮从网站前加载页面。domain.com/html

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:27:44.343

使用服务器 URL 创建请求并在 UIWebView 中加载请求。

# c# - C# Outlook 插件 - 事件未触发

> ID：14965045
> 
> 赞同：0
> 
> 时间：2013-02-19T18:45:44.827
> 
> 标签：c#, outlook

我正在为 Outlook 开发一个 C# 插件，该插件将在将项目添加到“已删除邮件”文件夹时起作用。粗略地说，代码如下所示。添加该方法时，我看到了日志通风口，但是当我删除一个项目时，其他日志事件不会被触发。我错过了什么？

```
public void OnConnection(object application, Extensibility.ext_ConnectMode connectMode, object addInInst, ref System.Array custom)
{
    try
    {
    Outlook._Application olApp = new Outlook.ApplicationClass();
    Outlook._NameSpace olNS = olApp.GetNamespace("MAPI");
    Outlook.MAPIFolder deletedFolder = olNS.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderDeletedItems);
    deletedFolder.Items.ItemAdd += new Outlook.ItemsEvents_ItemAddEventHandler(DeletedItems_ItemAdd);
    log("addDeletedItemEventHandler method added", LogLevel.Debug);
    }
    catch (Exception e)
    {
    log("Exception in addDeletedItemEventHandler: " + e.Message, LogLevel.Error);
    }
}

private void DeletedItems_ItemAdd(object Item)
{
    log("DeletedItems_ItemAdd - Fired", LogLevel.Debug);
} 
```

德米特里的解决方案是正确的。对于希望解决此问题的其他任何人：
我在类级别定义了以下内容： Outlook.Items oiDeletedFolderItems;

在 OnConnection 方法中，我添加/更改了：oiDeletedFolderItems = deletedFolder.Items; oiDeletedFolderItems.ItemAdd += new Outlook.ItemsEvents_ItemAddEventHandler(DeletedItems_ItemAdd);

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T19:37:47.977

触发事件（项）的 COM 对象必须处于活动状态才能触发事件。在您的情况下，编译器会创建一个临时变量来保存对 deletedFolder.Items 的调用结果；一旦该变量被垃圾收集，事件就会停止触发。

将 Items 对象存储在类变量中并在该对象上挂钩事件。

# .net - 为对话框窗口设置所有者是否有意义

> ID：14965049
> 
> 赞同：1
> 
> 时间：2013-02-19T18:46:00.800
> 
> 标签：.net, wpf

如果我将 Owner 设置为 Window 并以非对话框模式显示它，我会得到两件事：1\. 子窗口始终位于父窗口的顶部（虽然仍然可以访问父窗口） 2\. 如果我关闭父窗口，子窗口也将关闭

在对话框窗口的情况下，这两点都没有意义： 1\. 子窗口独立于 Owner 属性位于父窗口的顶部 2\. 您没有机会关闭父窗口

所以我是对的，将 Owner 属性设置为 Dialog 窗口是没有意义的，或者可能有一些论据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T23:03:19.710

除了HB所说的，

> 在显示窗口之前设置它的所有者很重要，因为否则可能会在焦点窗口或模式窗口隐藏在其他窗口后面时出现奇怪的错误。为防止此类错误，请将 Owner 属性设置为当前 Window。

Mark Seemann，.NET 中的依赖注入

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T18:53:03.877

正如[文档](http://msdn.microsoft.com/en-us/library/system.windows.window.owner.aspx)指出的那样，有以下原因：

> 通过调用 ShowDialog 打开子窗口时，还应设置子窗口的 Owner 属性。如果您不这样做，那么您的用户将无法通过按任务栏按钮来恢复子窗口和父窗口。相反，按下任务栏按钮将产生一个窗口列表，包括子窗口和父窗口，供他们选择；仅恢复选定的窗口。
> 
> 您还应该在通过调用 ShowDialog 打开的窗口上设置 Owner 属性，以确保 UI 自动化的正确行为。

# jquery - 使用 jQuery load() 通过 POST 方法传递表单

> ID：14965056
> 
> 赞同：0
> 
> 时间：2013-02-19T18:46:23.390
> 
> 标签：jquery, forms, post

我想将数据作为 POST 而不是 GET 如何更改这行代码以通过 POST 方法传递表单？

> var data = form.serialize();

```
<html>
<head>
   <title> Form</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
<script>

jQuery(document).ready(function(){
   jQuery("#itm_form").submit(function(evento){
      evento.preventDefault();
      var form = jQuery(this);
      // When using an object/map (key/value pairs), the request is made as a POST.
      var data = form.serialize();
      jQuery('#destino').load("recibe-parametros3.php", data, function(){   // load(url, data, complete);
         alert("recibidos los datos por ajax");
      }); 
   });

}) 
</script>
</head>
<body>

<form id="itm_form" >
Nombre: <input type="text" name="itm_name">
Email: <input type="text" name="itm_email">
<input type="submit" value="Enviar">
<input type="hidden" name="itm_oculto" value="0">

</form>
<div id="destino"></div>
</body>
</html> 
```

# actionscript-3 - 带有亚马逊 s3 存储桶的 swfaddress setValue()

> ID：14965061
> 
> 赞同：0
> 
> 时间：2013-02-19T18:46:46.300
> 
> 标签：actionscript-3, amazon-s3, flex4.6, swfaddress

对于我的 flex 应用程序深度链接，我使用 swfaddress 2.4。它以前有效，但现在当我将我的 flex 应用程序迁移到托管在 Amazon S3 存储桶上时出现问题。

我已经这样做了：

*   在应用程序将访问以加载资产/数据的每个域上设置的策略文件
*   `allowScriptAccess`被设定为`always`
*   `loadPolicyFile`启动应用程序时（通过）加载策略文件
*   `allowDomain`(and `allowInsecureDomain`) 也被设置

问题：

*   调用 SWFAddress.setValue() 时，浏览器地址栏上的地址永远不会改变。调试时，`_value`swfaddress.js 中的正确保存了传递的值
*   这会破坏浏览器历史记录（浏览器中的后退按钮并且无法使用应用程序）
*   手动在地址栏中输入查询会引发此错误：

    ```
    Uncaught Error: Error in Actionscript. Use a try/catch block to find error. 
    ```

    和

    ```
    Uncaught Error: Error calling method on NPObject 
    ```

    来自行中的函数`_swfChange`：`obj[setter](value);`SWFAddress.as`setter` 中的`setSWFAddressValue`回调在哪里。所以，我什至制作了 SWFAddress.as 来执行`_initialize`添加回调的函数

    *   当我将 try..catch 放在有问题的行时，它进入了臭名昭著的无限循环 swfaddress 问题。像推荐的那样添加修复，现在应用程序没有改变视图状态

提前致谢。

//顺便说一句，它类似于这个未解决的问题：[Amazon S3 和 swfaddress](https://stackoverflow.com/questions/2428256/amazon-s3-and-swfaddress)

# android - 如何在 GoogleMaps 中使用 ActionBar（通过 ActionBarSherlock）

> ID：14965070
> 
> 赞同：0
> 
> 时间：2013-02-19T18:47:22.737
> 
> 标签：android, actionbarsherlock, google-maps-android-api-2

我正在为 android 开发一个 GoogleMaps v2 API 应用程序并且遇到了一个问题。我想使用一个 ActionBar（通过 actionbarsherlock，用于向后兼容），如下图所示。

[![地图示例](../Images/faa4850ffb6f50989a2f18a7914aa4e5.png)](https://i.stack.imgur.com/IedmP.png)
[（来源：[google.com](https://www.google.com/mobile/maps/images/c5.png)）]

如果不调整我的代码以拥有 ActionBar，我的地图应用程序就可以很好地工作。我尝试使代码一致以使用它，但会导致空白屏幕和操作栏。因此，地图本身或其他任何东西都会被加载。

之前的代码：（仅相关部分）

```
public class MapActivity extends FragmentActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Initiate loader, so that files can be acquired in background thread.
        new Loader().execute();   
    }
    .
    .
    .
} 
```

我没有包括导入或变量。不用担心，因为代码确实可以编译。

之后的代码：

```
public class MapActivity extends SherlockFragmentActivity {

    public boolean onCreate(Menu menu) {
        super.onCreateOptionsMenu(menu);

        menu.add(0,SEARCH,0,"Search")
        .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);
        // Initiate loader, so that files can be acquired in background thread.
        new Loader().execute();
        return true;
    }

    public boolean onOptionsItemSelected (MenuItem item) {
        // Handle item selection
        switch (item.getItemId()) {
            case SEARCH:
                openSearchView();
                return true;
            default:
                return super.onOptionsItemSelected(item);
        }
    }
    .
    .
    .
} 
```

编辑 -

地图设置代码：（注意`map`已声明为类变量）

```
 @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_main);

 // Recovers map choice from previous activity.
    Intent intent = getIntent();
    map_descriptor = intent.getStringExtra(MAP);
    MAP_CENTER = map2LatLng(map_descriptor);

    map = setupMap(map);

    // Initiate loader, so that files can be acquired in background thread.
    new Loader().execute();   
}

public GoogleMap setupMap(GoogleMap map) {
    if (map == null) {
        map = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map)).getMap();
        // Just in case null map was accidently passed to setupMap.
    }
    map.setMapType(3); // TERRAIN
    CameraPosition cameraPosition = new CameraPosition.Builder()
    .target(MAP_CENTER)                 
    .zoom(ZOOM_LEVEL)
    .build();

    map.animateCamera(CameraUpdateFactory.newCameraPosition(cameraPosition));
    map.setOnCameraChangeListener(new OnCameraChangeListener() {
        public void onCameraChange(CameraPosition cameraPosition) {
                ZOOM_LEVEL = cameraPosition.zoom;
                recenterMap(ZOOM_LEVEL);
        }
    });

    return map;
} 
```

和 XML 布局代码：

```
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/map"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    class="com.google.android.gms.maps.SupportMapFragment"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T18:59:46.857

If you are going to use Maps V1 with ActionBarSherlock, you need [the add-on JAR for maps support](https://github.com/JakeWharton/ActionBarSherlock-Plugin-Maps/downloads) -- basically a `MapActivity` that knows about ActionBarSherlock.

If you are going to use Maps V2 with ActionBarSherlock, you would typically load the map via a fragment, such as in [this sample app](https://github.com/commonsguy/cw-omnibus/tree/master/MapsV2/Basic). Nowhere does your sample code show how you are getting the map in there, and as such it is difficult to guess why the map is not displaying for you.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T22:11:46.727

You're not properly setting the content view for the SherlockFragmentActivity, nor are you setting up the map when it expects to be setup.

In your onCreate method, make sure you do something like this after you call super.onCreate().

```
setContentView(R.layout.activity_main);
map = setupMap(); 
```

即使您正在从某个地方下载信息（或您在该异步任务中所做的任何事情），您仍然需要设置内容视图以在 onCreate 中正确填充地图。

您还需要确保从 onCreate 调用 setupMap。您可以稍后添加标记。

自 API v2 发布之日起，我一直在将 SherlockFragmentActivity 与 Google Maps Android API v2 一起使用，并且我没有遇到任何问题，因此它必须是您创建视图的顺序。

# c# - SslStream 缓慢取决于 BufferedStream 的包装

> ID：14965073
> 
> 赞同：1
> 
> 时间：2013-02-19T18:47:26.450
> 
> 标签：c#, .net, performance, ssl, buffer

我最近调试了我如何使用 SslStream 的性能问题。

客户端是 C#/.NET 并且具有以下 Stream 配置

*   原始套接字/NetStream
*   由 BufferedStream 包装
*   由 SslStream 包装
*   由“协议”流包装（发送字节/整数/字符串等）

当我通过互联网将数据从客户端发送到服务器时，我发现性能非常慢，在客户端序列化信息需要很长时间。

删除 SSL 流和连接加速到预期的水平。

然后我将上面的流配置更改为..

*   原始套接字/NetStream
*   由 SslStream 包装
*   由 BufferedStream 包装 <-- 移动了这个
*   由“协议”流包装（发送字节/整数/字符串等）

并且连接加速到了预期的水平。

有人可以解释为什么更改流配置对性能有如此大的帮助吗？特别是当我在与服务器相同的机器上测试客户端的原始配置时，它运行得非常快？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T19:18:36.337

原因很简单。您保存一个 int（仅 4 个字节），它被包装到 SSL 数据包中，然后被缓冲。更改顺序后，您开始在缓冲区中收集大量数据，然后用 SSL 将其包装为一个大块。更少的 SSL 包装器，更高的速度。

# javascript - 如何使用jquery将id添加到html标签

> ID：14965077
> 
> 赞同：0
> 
> 时间：2013-02-19T18:47:37.273
> 
> 标签：javascript, jquery

我有多个类的链接，`video`并且我想添加一个 id 属性，当用户单击链接时。

我的代码是：

```
 $(function () {$(".video").click(function(e){
   e.preventDefault();
   $(this).attr('id', 'selected');
   });}); 
```

单击链接后，如果我看到代码。Firebug 显示相同的代码，没有任何更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T18:50:06.123

尝试纯 JavaScript：

```
this.id = "selected"; 
```

如果这行得通，那么它就是一个 jQuery 放屁。如果它仍然不起作用，请确保您正确使用 Firebug（我不使用它，但我知道在 IE 中我必须单击一个按钮来刷新 DOM 视图），如果这似乎仍然没有修复它使用一个类（或一个`data-*`属性）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T18:58:24.827

您发布的代码没有任何问题，因此您在其他地方做错了。以下是一些一般性的建议：

*   更好地格式化代码以了解发生了什么
*   始终包装在一个封闭的函数中，该函数将 $ 定义为 jQuery，以防它未定义或定义为全局范围内的其他内容
*   将“选定”之类的内容应用为类，而不是 id
*   不要使用文件准备好的简写它不能描述它正在做什么并且不可读

例如

```
(function($) {

  $(document).ready(function() {

    $('.video').click(function(ev) {

      ev.preventDefault();

      //$(this).attr('id', 'selected');
      $(this).toggleClass('selected'); // This will turn the "selected" class on and off for each click

    });

  );

})(jQuery); 
```

# c++ - 连接 MySQL 时出现分段错误

> ID：14965082
> 
> 赞同：0
> 
> 时间：2013-02-19T18:47:55.257
> 
> 标签：c++, mysql, linux, segmentation-fault, mysql-connector

我在一个与 MySQL 数据库建立连接的大项目中有这段代码，但它不起作用：

```
boost::shared_ptr<sql::Connection> connection;

sql::Driver *driver = get_driver_instance();
assert(driver != 0);

std::string server = "servname", user = "pietro", password = "abc";

try
{
    connection.reset(driver->connect(server, user, password));
    assert(connection != 0);

    if(connection->isClosed() == false)     // <-- segmentation fault
    {
    }

} 
```

我在指示的地方出现分段错误（所有参数都有效）。
但是，同样的代码可以在测试项目中使用。

使用调试器进入`sql::Connection::isClosed()`成员函数，我没有获得有关可能原因的信息；这是我得到的地方：

> mysql-connector-c++-1.0.5/driver/mysql_connection.cpp - 第 430 行

```
/* {{{ MySQL_Connection::checkClosed() -I- */
void
MySQL_Connection::checkClosed()
{
    CPP_ENTER_WL(intern->logger, "MySQL_Connection::checkClosed");
    if (!intern->is_valid) {
        throw sql::SQLException("Connection has been closed");
    }
} 
```

该函数从刚才开始`checkClosed()`成功执行了七次。`connection.reset()`“ `intern`”指针的值在这个阶段不会改变并且不为空。

当我检查连接是否关闭时，该`checkClosed()`功能会再次运行。现在“ `intern`”指针值是 0x8，我无法访问的位置。

在这里，我得到一个`SIGSEGV`, 分段错误。

如果您想要反汇编代码，请告诉我...

*平台：*
MySQL 5.x
MySQL 连接器/C++ 1.0.5
Linux - OpenSuse 11.4

* * *

PS：我注意到所有`shared_ptr`的成员函数都按预期工作：

```
connection.get();          // = 0x8fb4a0
connection.use_count();    // = 1
connection.unique();       // = 1 
```

而对指向对象进行的所有调用都会导致分段错误（SIGABRT）：

```
connection->getClientInfo();
connection->isClosed(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:34:50.127

要么你的连接被删除，要么你有内存损坏。使用 valgrind 寻找答案

# bash - 使用 bash 变量进行输出重定向

> ID：14965083
> 
> 赞同：2
> 
> 时间：2013-02-19T18:48:02.627
> 
> 标签：bash

我想按照这些思路做一些事情，但是我尝试过的大多数组合都失败了：

```
export no_error="2 > /dev/null"
./some_command $no_error 
```

运行该命令并使用变量而不是键入命令来重定向输出。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T18:51:17.323

当您像这样使用它时，shell 不会重新评估您的`no_error`变量。`./some_command`它只是作为命令行参数传递给。您可以使用`eval`. 从[`bash`手册](http://www.gnu.org/software/bash/manual/bashref.html)：

> `eval [arguments]`
> 
> 参数被连接在一起形成一个命令，然后读取并执行该命令，其退出状态返回为 的退出状态`eval`。如果没有参数或只有空参数，则返回状态为零。

这是您的案例的示例：

```
export no_error="2>/dev/null"
eval ./some_command $no_error 
```

`2`请注意，在和之间不能有空格`>`。不过，我猜这只是您问题中的一个错字。

# ruby - Rails how to access attr_name inside other loop? Column method

> ID：14965087
> 
> 赞同：0
> 
> 时间：2013-02-19T18:48:11.573
> 
> 标签：ruby, ruby-on-rails-3, ruby-on-rails-3.2

My loop:

```
<% @products.first.attributes.except('name', 'created_at','updated_at','id').each do |attr_name, attr_value| %>
<tr>
    <td><span><%= t(attr_name) %></span></td>
    <td class="middle">Pr. x</td>
    <%= @products.each do |f| %>
    <td class="last"><%= f.attr_name %> ,-</td>
    <% end %>
<tr>
<% end %> 
```

Then I get this error: `undefined method attr_name for #<Product:0x3adc850`

How do I use the column method with attr_name? I have tried things like `f."#{attr_name}"` without luck.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:00:10.913

Use [`send`](http://ruby-doc.org/core-1.9.3/Object.html#method-i-send)

```
<%= @products.each do |f| %>
   <td class="last"><%= f.send attr_name %> ,-</td>
<% end %> 
```

And you should rename `f` into `product` (`f` is generally used for form builders)

# .net - 存储过程、ExecuteScalar 和参数

> ID：14965090
> 
> 赞同：1
> 
> 时间：2013-02-19T18:48:26.807
> 
> 标签：.net, sql, stored-procedures, sqlparameter

我有一个像这样调用的存储过程：

```
string proc = "SpCreate '00111', 3";

 using (SqlCommand command = new SqlCommand(proc, conn))
 {
       command.CommandType = CommandType.Text;
       command.CommandTimeout = 1000;

       string returnCode = command.ExecuteScalar().ToString();
 } 
```

上面的神工作正常。但是一旦我添加了一个参数，我就会在“SpCreate”附近得到不正确的语法。是什么赋予了？（下面的代码会导致错误。）

```
string proc = "SpCreate '00111', @myId";

 using (SqlCommand command = new SqlCommand(proc, conn))
 {
       SqlParameter paramName = new SqlParameter("@myId", SqlDbType.Int) { Value = 3 };
       command.Parameters.Add(paramName);

       command.CommandType = CommandType.Text;
       command.CommandTimeout = 1000;

       string returnCode = command.ExecuteScalar().ToString();
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T18:55:44.250

在查看了我自己的一些代码并意识到我有一些错误后编辑了我的答案。

您需要将 CommandType 设置为 StoredProcedure。

编辑：添加示例源代码

```
 string proc = "SpCreate";

 using (SqlCommand command = new SqlCommand(proc, conn))
 {
       SqlParameter paramName = new SqlParameter("@myId", SqlDbType.Int);
       paramName.Value = 3;
       command.Parameters.Add(paramName);

       command.CommandType = CommandType.StoredProcedure;
       command.CommandTimeout = 1000;

       string returnCode = command.ExecuteScalar().ToString();
 } 
```

# java - 注释反射（使用 getAnnotation）不起作用

> ID：14965092
> 
> 赞同：3
> 
> 时间：2013-02-19T18:48:39.930
> 
> 标签：java, jpa, reflection, annotations, persistence

我必须按照代码检查我的实体在字段上是否`model`有`nullable=false`或类似的注释。

```
import javax.persistence.Column;
import .....

private boolean isRequired(Item item, Object propertyId) {
        Class<?> property = getPropertyClass(item, propertyId);

        final JoinColumn joinAnnotation = property.getAnnotation(JoinColumn.class);
        if (null != joinAnnotation) {
            return !joinAnnotation.nullable();
        }

        final Column columnAnnotation = property.getAnnotation(Column.class);
        if (null != columnAnnotation) {
            return !columnAnnotation.nullable();
        }

        ....
        return false;
    } 
```

这是我的模型的一个片段。

```
import javax.persistence.*;
import .....

@Entity
@Table(name="m_contact_details")
public class MContactDetail extends AbstractMasterEntity implements Serializable {

    @Column(length=60, nullable=false)
    private String address1; 
```

对于那些不熟悉`@Column`注释的人，这里是标题：

```
@Target({METHOD, FIELD})
@Retention(RUNTIME)
public @interface Column { 
```

我希望它会时不时`isRequired`地返回`true`，但它永远不会。我已经在我的项目上做了一个`mvn clean`和`mvn install`，但这没有帮助。

Q1：我做错了什么？

Q2：有没有更简洁的编码方式`isRequired`（也许更好地利用泛型）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T18:57:37.987

1.  `property`代表一个类（它是 a `Class<?>`）
2.  `@Column`并且`@JoinColumn`只能注释字段/方法。

因此，您永远不会在`property`.

稍微修改过的代码版本，打印出是否需​​要 Employee 实体的 email 属性：

```
public static void main(String[] args) throws NoSuchFieldException {
      System.out.println(isRequired(Employee.class, "email"));
}

private static boolean isRequired(Class<?> entity, String propertyName) throws NoSuchFieldException {
    Field property = entity.getDeclaredField(propertyName);

    final JoinColumn joinAnnotation = property.getAnnotation(JoinColumn.class);
    if (null != joinAnnotation) {
        return !joinAnnotation.nullable();
    }

    final Column columnAnnotation = property.getAnnotation(Column.class);
    if (null != columnAnnotation) {
        return !columnAnnotation.nullable();
    }

    return false;
} 
```

请注意，这是一个半生不熟的解决方案，因为 JPA 注释可以位于字段或方法上。还要注意反射方法（如`getFiled()`/ ）之间的区别`getDeclaredField()`。前者也返回继承的字段，而后者只返回特定类的字段，而忽略从其父类继承的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:56:18.790

以下代码有效：

```
 @SuppressWarnings("rawtypes")
    private boolean isRequired(BeanItem item, Object propertyId) throws SecurityException {

        String fieldname = propertyId.toString();

        try {
            java.lang.reflect.Field field = item.getBean().getClass().getDeclaredField(fieldname);
            final JoinColumn joinAnnotation = field.getAnnotation(JoinColumn.class);
            if (null != joinAnnotation) {
                return !joinAnnotation.nullable();
            }

            final Column columnAnnotation = field.getAnnotation(Column.class);
            if (null != columnAnnotation) {
                return !columnAnnotation.nullable();
            }

        } catch (NoSuchFieldException e) {
            //not a problem no need to log this event.
            return false;
        } 
    } 
```

# php - 在 PHP 中扩展字符串中的变量

> ID：14965093
> 
> 赞同：1
> 
> 时间：2013-02-19T18:48:40.047
> 
> 标签：php, string

我正在尝试使用它来回显图像..

```
$actual_image_name = "image.png";  
var msg = '<img src=http://website.com/uploads/$actual_image_name />'; 
```

但是我尝试过的一切都不起作用。它要么以“ [http://website.com/uploads/$actual_image_name](http://website.com/uploads/) ”之类的形式返回，要么以其他路径返回。

我知道这很简单，但我需要一些帮助！谢谢！

* * *

我的完整代码；

```
function sendImg()
 {

$actual_image_name = "image.png";
var msg = "<img src=http://website.com/uploads/$actual_image_name />";

                    document.getElementById("chatmsg").value = "";
                    var url = "sendMsg.php?userId=" + userId + "&strangerId=" + strangerId + "&msg=" + msg;
                    xmlHttp6.open("POST", url, true);
                    xmlHttp6.onreadystatechange = stateChanged6;
                    xmlHttp6.send(null);

} 
```

* * *

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-19T19:17:22.697

您必须使用双引号

```
$actual_image_name = "image.png";  
$msg = "<img src=http://website.com/uploads/$actual_image_name />"; 
```

请参阅[PHP 字符串文档](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.single)：

> 注意：与双引号和heredoc 语法不同，特殊字符的变量和转义序列在出现在单引号字符串中时不会被扩展。

* * *

测试用例：

```
$actual_image_name = "image.png";
$msg = "<img src=http://website.com/uploads/$actual_image_name />";
echo $msg; 
```

输出：

```
<img src=http://website.com/uploads/image.png /> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-19T19:21:00.093

请检查您如何使用引号：

```
$actual_image_name = "image.png";  
$msg = '<img src="http://website.com/uploads/' . $actual_image_name . '" />';
echo $msg; 
```

# linux - “断开” /dev/input/event14 从 tty

> ID：14965095
> 
> 赞同：0
> 
> 时间：2013-02-19T18:48:46.387
> 
> 标签：linux, events, usb, tty

我买了一个USB脚踏开关。它的 USB ID 为 0c45:7403。Linux 可以很好地使用它，也就是说：如果你按下它，它会模拟键盘按下。现在我可以简单地打开 /dev/input/event14 并从中读取事件，但似乎仍有“按键”被发送到 tty！我怎样才能防止这种情况？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:11:03.727

如果您只多花 4 分钟在 Google 上搜索，您就会自己找到答案！首先，打开 /dev/input/eventX - 在你的情况下 X 是 14。然后运行：

```
int grab = 1;
int rc = ioctl(fd, EVIOCGRAB, &grab);
if (rc == -1)
        // failure 
```

从那时起，直到您的程序停止，您拥有该设备，并且没有事件最终出现在 tty。

# ios - iOS 上嵌入的图形数据库

> ID：14965096
> 
> 赞同：5
> 
> 时间：2013-02-19T18:48:47.180
> 
> 标签：ios, sqlite, graph-databases, triplestore

运行嵌入在 iOS 上的图形数据库有哪些选项？

鉴于明显缺乏选项，最好尝试在 sqlite 中管理数据库并保持数据库大小较小？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T11:51:01.183

Sparsity Technologies 的 DEX Graph DB 几天前在 iOS 平台（以及 BB10）上公开可用。它是免费的评估和开发。

因为它是一个测试版，所以在下载之前需要注册。您可以在以下位置尝试：

[http://www.sparsity-technologies.com/dex_downloads](http://www.sparsity-technologies.com/dex_downloads)

DEX 移动测试版为 iOS 和 BB10 平台提供 C++ API。

# mysql - Rails 应用程序通过 MySql GEM 错误

> ID：14965097
> 
> 赞同：0
> 
> 时间：2013-02-19T18:48:49.820
> 
> 标签：mysql, ruby-on-rails, ruby, gem

我正在尝试运行用 Rails 编写的“Redmine”项目管理应用程序。 [https://github.com/redmine/redmine](https://github.com/redmine/redmine)

我从 Github 下载了它，现在在尝试运行它时（通过双击 rails 文件，我在终端中收到此错误：

在这台机器上可用的 gem 中找不到 gem 'mysql (~> 2.8.1) ruby​​'

我已经安装了 mysql 2.9.1。我是整个 Rails 的新手。我刚刚安装它以便能够运行这个应用程序。因此，任何有关帮助我运行此应用程序的建议将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:21:32.160

可能最简单的方法是告诉 Redmine 使用您的 mysql 版本：转到

\YourRedMineInstallFolder\apps\redmine\htdocs 打开 Gemfile 和 Gemfile.lock 并在末尾或 mysql 区域中更改/添加此行。

```
gem "mysql", "~> 2.9.1" 
```

然后转到服务并重新启动所有 redmine 服务，特别是名称中带有“..thin”的服务（这非常重要）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:04:29.870

会不会是它不适用于最新的 mysql 版本？确保将其粘贴在 Rails 应用程序中的 Gemfile 中。

gem 'mysql', '~> 2.8.1'

如果您想在本地运行它，还请确保它正在测试或开发中。

```
group :test, :development do
  gem 'mysql', '~> 2.8.1'
end 
```

# sql - 参数化选择语句 PSQL 的输出

> ID：14965099
> 
> 赞同：0
> 
> 时间：2013-02-19T18:48:55.013
> 
> 标签：sql, postgresql, postgresql-8.3

我使用的是基于 8.3 构建的 postgresql 版本。我基于特定的 IP 地址运行了大量查询，并希望创建一个函数，我可以将 IP 地址作为参数传递，类似于：

```
CREATE OR REPLACE FUNCTION features.src_forensics(text)     
RETURNS SETOF rows as
$$

select src, action,
count(distinct date_trunc('day', receive_time) ) n_activeDay,
count(distinct source_IP) n_src,
count(distinct source_IP) / count(distinct date_trunc('day', receive_time)) n_src_per_day,
sum(bytes) as total_bytes,
min(receive_time) minTime,
max(receive_time) maxTime
from  table
where src = $1 
group by src, action ; 
```

$$ 语言 sql;

问题是上面的查询没有以我习惯的表格格式返回 select 语句的输出。如果我将 10.10.0.1 作为 IP 地址输入传递给函数，如何让上面编写的脚本表现得像下面的 select 语句？

```
select src, action,
count(distinct date_trunc('day', receive_time) ) n_activeDay,
count(distinct source_IP) n_src,
count(distinct source_IP) / count(distinct date_trunc('day', receive_time)) n_src_per_day,
sum(bytes) as total_bytes,
min(receive_time) minTime,
max(receive_time) maxTime
from  table
where src = '10.10.0.1'
group by src, action; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:28:55.960

我通常在返回任意一组列时这样做：

```
RETURNS TABLE(
    src             text,
    action          text,
    n_activeDay     bigint,
    n_src           bigint,
    n_src_per_day   bigint,
    total_bytes     bigint,
    minTime         timestamptz,
    maxTime         timestamptz
) AS 
```

如果您希望保持定义不变，则可以更改查询函数的方式：

```
select * from features.src_forensics("a") AS f(
        src             text,
        action          text,
        n_activeDay     bigint,
        n_src           bigint,
        n_src_per_day   bigint,
        total_bytes     bigint,
        minTime         timestamptz,
        maxTime         timestamptz
    ); 
```

# javascript - 另一种创建html表格的方法

> ID：14965100
> 
> 赞同：0
> 
> 时间：2013-02-19T18:48:56.050
> 
> 标签：javascript, html, dictionary, html-table

我得到了这个 Javascript 地图结构：

键（字符串）- 值（数组（））

```
 String "customerId"    =   Array{"123123", "298191", "93202"}
   String "customerName"  =   Array{"fran", "nick", "jan"}
   String "pobox"         =   Array{"18239", "129319", "123123"} 
```

所以基本上，该值是一个包含所有 customerIds、所有 customerNames 等的数组。我要创建的表将在 Javascript 中生成，例如：

```
customerId   customerName    pobox
123123         fran           18239
298191         nick           129319
93202          jan            123123 
```

是否可以用 Javascript 制作它？试过了，但太复杂了：/

我一直在这样做：

```
function createBodyRowsByMapObject(map, tbody) {

    for(a in map) {
        var arr = map[a];
        var row = document.createElement("tr");
        for(k in arr) {
                    //here i would be getting the array value.
            createTableData(row, arr[k]);
        }
    }
    tbody.appendChild(row);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T18:58:29.013

我将假设您的数据结构如下：

```
var obj = {
    "customerId":["123123","298191","93202"],
    "customerName":["fran","nick","jan"],
    "pobox":["18239","129319","123123"]
}; 
```

将其转换为表格比您想象的要容易：

```
var table = document.createElement('table'), rows = [], k, l, i;
for( k in obj) {
    l = obj[k].length;
    for( i=0; i<l; i++) {
        if( !rows[i]) rows[i] = table.appendChild(document.createElement('tr'));
        rows[i].appendChild(document.createElement('td'))
               .appendChild(document.createTextNode(obj[k][i];
    }
}
document.body.appendChild(table); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T18:51:52.723

您总是可以尝试使用诸如[handlebars.js](http://handlebarsjs.com/)之类的模板解决方案——这使得吐出标记变得尽可能简单。

# ios - 如何将 UITableViewCell 标签复制到 nextView 中的 UILabel？

> ID：14965101
> 
> 赞同：0
> 
> 时间：2013-02-19T18:49:09.207
> 
> 标签：ios, objective-c, uitableview, uilabel, nslog

我只想将 UITableViewCell 的标签（这是一个简单的字符串）复制到 nextView 的 UIlabel 中。我尝试在 nextView 中创建一个字符串属性并将单元格标签传递给它，但它不起作用。我在 nextView 中得到零，这是为什么呢？这是我在 rootViewController.m 中的 didSelectRowAtIndexPath 方法

```
 -(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
    {
        NSString *selLabel =[tempArray objectAtIndex:indexPath.row];
        DetailViewController *detailViewCont=[[DetailViewController alloc]initWithNibName:@"DetailViewController" bundle:nil];
detailViewCont.selectedLabel=selLabel;        
[self.navigationController pushViewController:detailViewCont animated:YES];

      NSLog(@"selected Label %@",detailViewCont.selectedLabel);
    } 
```

最后一个 NSlog 语句在这里返回正确的字符串。

在 nextViewController.m

```
-(void)viewDidLoad
{
[super viewDidLoad];
selectedLabel=[[NSString alloc]init];

UILabel *label1=[[UILabel alloc]init];
    label1.frame=CGRectMake(5,5,310, 60);
    label1.font=[UIFont fontWithName:@"Arial Black" size:20];
    label1.text=selectedLabel;
    NSLog(@"sellabel %@",selectedLabel);
 [self.View addSubview:label1];
} 
```

这里的 NSLog 语句返回 null

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:39:39.973

`viewDidLoad`从您的方法中删除以下行：

```
selectedLabel=[[NSString alloc]init]; 
```

这是清除您从另一个视图控制器设置的值。

而这一行：

```
label1.text=selectedLabel; 
```

真的应该是：

```
label1.text = self.selectedLabel; 
```

你设置一个属性，使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:09:11.573

尝试在 pushViewController 语句之前设置 selLabel，如下所示，

```
detailViewCont.selectedLabel=selLabel;
[self.navigationController pushViewController:detailViewCont animated:YES]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:09:19.450

在通话`detailViewCont.selectedLabel=selLabel;`前移动您的线路。`pushViewController`在分配值之前呈现视图控制器。

```
@interface DetailViewController

...
@property (strong, nonatomic) NSString *selectedLabel;

@end

@implementation DetailViewController
@synthesize selectedLabel = _selectedLabel; // define the instance variable associated with the property

-(void)viewDidLoad {
  label1.text = _selectedLabel;
}

@end 
```

# jquery - 使用选择列表切换 div 的可见性

> ID：14965105
> 
> 赞同：0
> 
> 时间：2013-02-19T18:49:17.783
> 
> 标签：jquery, select, toggle, show, show-hide

我有一个选择列表：

```
<select id="cd-dropdown" class="cd-select">
<option value="-1" selected>Menu</option>
<option value="http://google.com" class="home">1</option>
    <option value="http://google.com" class="home">2</option>
</select> 
```

我还有一个 div，当点击或单击选择列表时（在选项下方），它将覆盖整个屏幕：

```
<div class="overlay"></div> 
```

Using jQuery I'd like to show/hide this overlay depending on the state the select is in. So if I open the select list, I want the overlay div to fade in and when the select list is closed or an option is selected I '希望叠加层淡出。

我无法让我的 jQuery 工作：

```
$('#cd-dropdown').onchange( function() {
    $( '#overlay' ).toggle.fadeIn();
    $( '#overlay' ).toggle.fadeOut();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:07:02.470

您应该使用`.change()`绑定，而不是`.onchange()`. 也删除`.toggle`，只需使用`.fadeIn()`or `.fadeOut()`。

编辑：我添加了一个[jsFiddle](http://jsfiddle.net/goffreder/mmbYg/1/)来更好地解释。您可能应该检测`onfocus`到在叠加层中淡入淡出的`onblur`事件，以及将其淡出的事件。像这样的东西：

```
$("#cd-dropdown").change(function(event) {
    $("#cd-dropdown").blur();
}).focus(function() {
    $(".overlay").fadeIn();
}).blur(function() {
    $(".overlay").fadeOut();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T18:59:33.810

尝试

```
$('#overlay').fadeToggle(); 
```

或者，更准确地说，

```
$('#cd-dropdown').onchange( function() {
     if($('#cd-dropdown').value == 1)
         $('#overlay').fadeIn();
     else if($('#cd-dropdown').value == 2)
         $('#overlay').fadeOut();
} 
```

# javascript - JQuery .replaceWith() 突然将新元素放在错误的位置？

> ID：14965106
> 
> 赞同：0
> 
> 时间：2013-02-19T18:49:19.867
> 
> 标签：javascript, jquery, file, input, replacewith

这个真的让我莫名其妙。我`replaceWith()`用来“清除”文件输入字段。但是，当它替换它时，它又放回了错误的位置，我不知道为什么。我在标题中使用了“突然”一词，因为更神秘的是，当我周末停止工作时，替代品的工作方式完全符合预期。现在我回去工作了，突然就不行了。

这是调用之前的源 HTML `replaceWith()`：

```
<label>Audio</label>
<i style="color:#888888;">MP3 or OGG format recommended</i>
<br>
<button id="clear_audio_input" style="display:none;">Clear</button>
<input type="file" value="" name="source_audio" style="width:300px;">
<br>
<div style="margin-top:15px;">
    <b>Current: </b>
    <i id="current_audio_source">1360954394_121RuleOfRosePianoEtudeI.mp3</i>
    <br>
    <input id="source_audio_value" class="required_media" type="hidden" value="1360954394_121RuleOfRosePianoEtudeI.mp3" name="source_audio">
    <span id="current_audio_info_a"><input type="checkbox" style="position:relative;top:3px;margin-left:0px;" value="yes" name="source_audio_delete"> 
```

删除当前音频？当前音频将被替换

请注意名为“source_audio”的 FILE 输入字段的位置。它紧跟在“清除”按钮之后。

现在，在我调用 之后`replaceWith()`，HTML 看起来像这样：

```
<label>Audio</label>
<i style="color:#888888;">MP3 or OGG format recommended</i>
<br>
<button id="clear_audio_input" style="display: none;">Clear</button>
<br>
<div style="margin-top:15px;">
    <b>Current: </b>
    <i id="current_audio_source">1360954394_121RuleOfRosePianoEtudeI.mp3</i>
    <br>
    <input type="file" value="" name="source_audio" style="width:300px;">
    <input id="source_audio_value" class="required_media" type="hidden" value="1360954394_121RuleOfRosePianoEtudeI.mp3" name="source_audio">
    <span id="current_audio_info_a" style="display: inline;"><input type="checkbox" style="position:relative;top:3px;margin-left:0px;" value="yes" name="source_audio_delete"> 
```

删除当前音频？当前音频将被替换

请注意，它现在向下几行并位于另一个 DIV 内。

这是控制“清除”按钮操作的脚本：

```
$("#clear_audio_input").live("click", function() {
    $("input[name='source_audio']").replaceWith($("input[name='source_audio']").val('').clone(true));
    $("#source_audio_value").val($("#current_audio_source").text());
    $(this).hide();
    $("#current_audio_info_a").show();
    $("#current_audio_info_b").hide();
    checkRequiredMedia();
    return false;
}); 
```

这是基本的预期工作流程。加载时，清除按钮是隐藏的，因为没有任何东西需要清除。用户选择文件后，将出现清除按钮。单击按钮将清除文件输入（通过替换它），然后按钮将再次隐藏，基本上将表单返回到加载时的相同状态。

为什么会发生这种奇怪的事情（特别是因为几天前没有发生，从那以后我没有改变任何东西）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T18:54:37.637

问题是因为您有两个带有 name 的输入`source_audio`。为了解决这个问题，您需要给两个输入字段一个 id，或者更改名称。

例如：

```
$('#my_file_input').replaceWith('<input id="my_file_input" type="file" name="source_audio" />');
$('#my_hidden_file_input').val(''); 
```

# flash - As2：onPress 函数循环遍历所有实例

> ID：14965108
> 
> 赞同：1
> 
> 时间：2013-02-19T18:49:23.313
> 
> 标签：flash, function, actionscript-2

我在 Actionsctipt2 中编写游戏，我在点击敌人时遇到了问题。它应该减少被点击的movieClip的HP。相反，它总是减少第一个 (z1) 的 HP。我的代码有什么问题？

```
for(i=1;i<3;i++){
        targetx = _root.otoczenie._x + _root.otoczenie["z"+i]._x;
        targety = _root.otoczenie._y + _root.otoczenie["z"+i]._y;
        _root.otoczenie["z"+i].onPress = function()
        {
                bullet--;
                _root.clip.bullets.text = String(bullet);
                SHOT_SOUND();
                _root.postac.gotoAndStop(33);
                trace(_root.otoczenie["z1"].HP)
                trace(_root.otoczenie["z2"].HP);
                     if (CHECK_RANGE(targetx, targety, 400))
                {
                    HP("z"+i,-1);
                }
             }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T22:04:26.093

什么是 HP("z"+i,-1); ? 它不是 HP -= _root.otoczenie["z"+i].hp;？

我认为您需要从总马力中减去阵列马力？这是给主要玩家还是敌方单位？如果 HP 是一个函数，那么该函数的内部是什么？

# .net - 多个属性的线程安全模式

> ID：14965109
> 
> 赞同：3
> 
> 时间：2013-02-19T18:49:24.267
> 
> 标签：.net, multithreading, properties, thread-safety

我有一个对象，它有大约 15 个字符串、十进制？日期时间？或int？我有一个从多个线程操作的此类的集合。我想确保以线程安全的方式访问（读/写）对象属性的值，同时编写最少的代码。有没有这样一种方法，而不是使用私人支持者并在每个属性的 getter 和 setter 中进行显式锁定？这是我现在必须为每个属性做的事情：

```
public class ManyProperties
{
    private Object mLock = new Object;
    private string _personName;
    public string PersonName {
        get {            
             lock (mLock){
                 return _personName;
             }           
        }
        set { 
             lock (mLock){
                  _personName = value; 
             }
        }
    }

    private string _beginAmount;
    public decimal? BeginAmount {
        get {            
             lock (mLock){
                 return _beginAmount;
             }           
        }
        set { 
             lock (mLock){
                  _beginAmount = value; 
             }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T18:56:20.067

属性通常不会孤立地工作。如果您无法获得正确且有效的值*对*等，则让每个属性线程安全都无济于事。一个更合适的方法是让整个事情不可变，并让调用者得到一个**快照**：

```
public class ManyProperties
{
    private readonly string _personName;
    public string PersonName { get { return _personName; } }

    private readonly decimal? _beginAmount;
    public decimal? BeginAmount { get { return _beginAmount; } }

    public ManyProperties(string personName, string decimal? beginAmount) {
       _personName = personName;
       _beginAmount = beginAmount;
    }
} 
```

然后：

```
var snapshot = whatever.Properties;
var name = snapshot.PersonName;
...
var amount = snapshot.BeginAmount; 
```

这些现在将**始终保持一致**。另外还有零锁。读取/更新引用也总是原子的 - 所以没有撕裂的值。

重要的是不要做：

```
var name = whatever.Properties.PersonName;
...
var amount = whatever.Properties.BeginAmount; 
```

因为这里不再有任何保证`name`并且`amount`来自同一个`ManyProperties`实例：有人可能已经交换了两个提取之间的引用。

# c# - 在 WPF 中的 UserControl 内的控件上显示验证错误模板

> ID：14965110
> 
> 赞同：12
> 
> 时间：2013-02-19T18:49:31.457
> 
> 标签：c#, wpf, validation, mvvm, idataerrorinfo

如何让 WPF 错误模板出现在 WPF 中的 UserControl 内的控件上？

我有一个包含两个标签、两个文本框和一个复选框的用户控件。其中一个文本框代表实体的名称，它绑定到我的 ViewModel 公开的 Model 属性的 Name 属性，这是我的 Window 的 DataContext。Model 类实现了 IDataErrorInfo 接口，我已经通过单元测试确认，当 Name 为空时，会通过属性索引器实现返回错误。我已绑定到在我的用户控件中支持名称文本框的依赖属性，当遇到验证错误时，WPF 错误模板会在整个用户控件周围放置一个红色边框，而不仅仅是名称文本框。

UserControl 的 name 字段的绑定如下。

```
<vc:MyUserControl ItemName="{Binding Model.Name, ValidatesOnDataErrors=True}" /> 
```

我的 UserControl 和支持 DependencyProperty 的简化版本如下。

```
<UserControl>
    <Grid>
       <TextBox Text="{Binding ItemName}" />
    </Grid>
</UserControl>

public partial class MyUserControl: UserControl
{
    public static readonly DependencyProperty ItemNameProperty = 
        DependencyProperty.Register(
            "ItemName", 
            typeof(string), 
            typeof(MyUserControl), 
            new FrameworkPropertyMetadata(string.Empty, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault)
    );

    public string ItemName
    {
        get { return (string)GetValue(ItemNameProperty); }
        set { SetValue(ItemNameProperty, value); }
    }
} 
```

到目前为止，我发现的与此问题相关的信息都是关于 Silverlight 或使用转换器不显示红色边框（这对我来说没有意义）。这些信息都可以在 stackoverflow 上找到。

有没有人能够用 WPF 解决这个问题？我是否忽略了一些明显的东西？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-20T13:08:57.257

如果绑定到您的use ，将使用`ErrorTemplate`for 。[但是您可以使用Validation.ErrorTemplate Attached Property](http://msdn.microsoft.com/en-us/library/system.windows.controls.validation.errortemplate.aspx)删除红色边框。`UserControl``UserControl`[`ValidatesOnDataErrors=True`](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.validatesondataerrors.aspx)

如果您也通过实现支持的 DependencyProperties 来验证它们的绑定，则您的所有控件`UserControl`只会显示红色边框。[`IDataErrorInfo`](http://msdn.microsoft.com/en-us/library/system.componentmodel.idataerrorinfo%28v=vs.110%29.aspx)

```
public class MyUserControl : UserControl, IDataErrorInfo
{
   public static readonly DependencyProperty ItemNameProperty =
       DependencyProperty.Register(
           "ItemName",
           typeof(string),
           typeof(MyUserControl),
           new FrameworkPropertyMetadata(string.Empty, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault)
   );

   public string ItemName
   {
      get { return (string)GetValue(ItemNameProperty); }
      set { SetValue(ItemNameProperty, value); }
   }

   public string Error
   {
      get { throw new NotImplementedException(); }
   }

   public string this[string columnName]
   {
      get
      {
         // use a specific validation or ask for UserControl Validation Error 
         return Validation.GetHasError(this) ? "UserControl has Error" : null;
      }
   }
} 
```

这里是简化的 XAML

```
<UserControl Validation.ErrorTemplate="{x:Null}">
   <Grid DataContext="{Binding RelativeSource={RelativeSource AncestorType=UserControl}}">
      <TextBox Text="{Binding ItemName, ValidatesOnDataErrors=True}" />
   </Grid>
</UserControl> 
```

**添加**

如果您想区分错误，您可以获取 DependencyProperty 的[BindingExpression](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingexpression.aspx)并检查[HasError 属性](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingexpressionbase.haserror.aspx)。

```
BindingExpression be = BindingOperations.GetBindingExpression(this, ItemNameProperty);
return be != null && be.HasError ? "ItemName has Error" : null; 
```

# r - 来自摘要的值可以增加小数点吗？

> ID：14965112
> 
> 赞同：1
> 
> 时间：2013-02-19T18:49:37.167
> 
> 标签：r

我拥有的所有数据的平均值是 0.2。我想要更多的小数，否则如果我想在两个文件之间进行比较是没有意义的。例子

```
 summary(f)
 Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
 0.0     0.1     0.2     0.2     0.2     0.7  824982 
```

所以这里的平均值可以是 0.29 或 0.21。关于如何知道这一点的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T18:53:21.047

您可以使用`digits`参数：

```
R> summary(rnorm(10))
#    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# -1.5520 -0.1925  0.2027  0.1862  0.8423  1.5470 
R> summary(rnorm(10),digits=10)
#       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
# -2.2444487 -1.2681605  0.1552090 -0.2980934  0.4828649  1.3489778 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T18:51:26.597

尝试

```
options(digits=10)
summary(f) 
```

从`?options`

> 'digits'：控制打印数值时要打印的位数。这只是一个建议。有效值为 1...22，默认值为 7。请参阅“print.default”中有关大于 15 的值的说明。

请注意，打印的位数与内部存储的位数不同。

# android - 分隔线不适用于带有 viewpagerindicator 和 actionbarsherlock 的 TitlePageIndicator

> ID：14965113
> 
> 赞同：8
> 
> 时间：2013-02-19T18:49:45.097
> 
> 标签：android, actionbarsherlock, android-viewpager, viewpagerindicator

我注意到最新版本的 ViewPagerIndicator 支持 ICS 样式分隔符，我尝试关注问题和解决方案，但无论我做什么，我都无法让分隔符显示在 TitlePageIndicator 的操作栏上的选项中。我添加了 IcsLayout 作为容器，放置了分隔符、showDividers 和其他属性，但仍然一无所获。这是我的布局（奇怪的是，如果我将 IcsLayout 切换到 viewpager 指示器之一，应用程序会崩溃）：

```
<com.actionbarsherlock.internal.widget.IcsLinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res/com.sosick.android.brink"
    android:layout_width="match_parent"
    android:divider="#ffffff"
    android:showDividers="middle"
    android:dividerPadding="8dp"
    android:dividerHeight="10dp"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <com.viewpagerindicator.TitlePageIndicator
        android:id="@+id/tpi_header"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        textColor="@color/text_light"
        android:background="@drawable/ab_stacked_solid_brink"
        app:topPadding="10dp"
        app:footerPadding="15dp"
        app:footerColor="#a4ded7"
        app:footerIndicatorHeight="2dp"
        app:footerIndicatorStyle="underline"
        app:footerLineHeight="2dp"
        app:selectedBold="false" />

    <android.support.v4.view.ViewPager
        android:id="@+id/vp_pages"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1" />

</com.actionbarsherlock.internal.widget.IcsLinearLayout> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-31T13:52:42.650

您需要在样式中声明分隔符参数，而不是在布局 xml 中。

../res/values/styles.xml：

```
<style name="StyledIndicators" parent="@android:style/Theme.Light">
    <item name="vpiIconPageIndicatorStyle">@style/CustomIconIndicator</item>
</style>

<style name="CustomIconIndicator" parent="Widget.TabPageIndicator">
    <item name="android:divider">@drawable/custom_tab_indicator_divider</item>
    <item name="android:showDividers">middle</item>
    <item name="android:dividerPadding">10dp</item>
</style> 
```

在您的活动清单中：

```
<activity
        android:name=".SampleIconsDefault"
        android:label="Icons/Default"
        android:theme="@style/StyledIndicators"> 
</activity> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T18:07:33.363

*以下代码片段主要来自[Android 开发者](http://developer.android.com/training/implementing-navigation/lateral.html "实现横向导航")网站。还有一个非常好的示例应用程序/项目。*

用作`ViewPage`布局的容器，例如 res/layout/activity_main.xml：

```
<android.support.v4.view.ViewPager
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/pager"
    android:layout_width="match_parent"
    android:layout_height="match_parent" /> 
```

在您的课程中实现 ABS' `ActionBar.TabListener`，添加和扩展`FragmentPagerAdapter`或`FragmentStatePagerAdapter`从支持库中添加和扩展，例如：

```
public class TheDesertFoxActivity extends SherlockFragmentActivity
        implements ActionBar.TabListener {

    private AppSectionsPagerAdapter mAppSectionsPagerAdapter;
    private ViewPager mViewPager;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mAppSectionsPagerAdapter = new AppSectionsPagerAdapter(getSupportFragmentManager());

        // Set up action bar
        final ActionBar actionBar = getSupportActionBar();
        actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

        // Set up the ViewPager, attaching the adapter
        mViewPager = (ViewPager) findViewById(R.id.pager);
        mViewPager.setAdapter(mAppSectionsPagerAdapter);
        mViewPager.setOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener() {
            @Override
            public void onPageSelected(int position) {
                // When swiping between different app sections, select the corresponding tab
                actionBar.setSelectedNavigationItem(position);
            }
        });

        // For each of the sections in the app, add a tab to the action bar
        for (int i = 0; i < mAppSectionsPagerAdapter.getCount(); i++) {
            // Create a tab with text corresponding to the page title defined by the adapter.
            // Also specify this Activity object, which implements the TabListener interface, as the
            // listener for when this tab is selected.
            actionBar.addTab(actionBar.newTab()
                    .setText(mAppSectionsPagerAdapter.getPageTitle(i))
                    .setTabListener(this));
        }
    }

    public static class AppSectionsPagerAdapter extends FragmentPagerAdapter {

        public AppSectionsPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int i) {
            switch (i) {

                Fragment fragment = new MyTabsFragment();
                Bundle args = new Bundle();
                args.putInt(MyTabsFragment.TAB_ID, i);
                fragment.setArguments(args);
                return fragment;
            }
        }

        @Override
        public int getCount() {
            return <YOUR_TAB_COUNT>;
        }
    }

    public static class MyTabsFragment extends Fragment {

        public static final String TAB_ID = "tab_id";

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container,
                Bundle savedInstanceState) {
            int layoutId = -1;
            switch (getArguments(getInt(TAB_ID))) {
                case 0: 
                    layoutId = R.layout.fragment_first_tab;
                    break;
                case 1:
                    layoutId = R.layout.fragment_second_tab;
                    break;
                ...
                ...
                ...
                default:
                    layoutId = R.layout.fragment_default_tab;

            }
            View rootView = inflater.inflate(layoutId, container, false);
            return rootView;
        }
    }
} 
```

就是这样。将为您放置分隔线`ViewPager`。您不必自己添加它们。

# javascript - 需要回调，不知道怎么做

> ID：14965114
> 
> 赞同：0
> 
> 时间：2013-02-19T18:49:47.380
> 
> 标签：javascript, callback, quicksand

我的问题是这个。我创建了一个`<li>`侧面`<ul>`元素列表。当您单击其中一个`<li>`元素时，其他元素就会消失。现在，当您单击 时`[See all items]`，会出现上一个列表 agen。但是现在当您单击另一个元素时，什么也没有发生。那应该是因为新元素不知道当你点击它时要做什么。我们需要一个回调！但是我不知道我应该在这个回调函数中写什么？！

我的代码：http: [//jsfiddle.net/cRcNB/](http://jsfiddle.net/cRcNB/)。在 JS 部分有 easying.js 和 quicksand.js。所以向下滚动（一直），你会看到我的（短）代码。:)

我将按要求在此处发布我的代码：

```
$(document).ready(function(){   
    var $holder = $('ul.holder');
    var $data = $holder.clone();

    $('ul.holder li').click(
        function(e){
            $holder.quicksand($(this),{
                duration: 800,
            });
        return false;
    }); 
    $('#all').click(
        function(e){
            $new = $data.find('li')
            $holder.quicksand($new,{
                duration: 800
            }
        );
        return false;
    });
}) 
```

HTML

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
</head>
<body>
    <ul>
        <li id='all'>[See all items]</li>
    </ul>
    <ul class='holder'>
        <li data-id="1" data-type="a">heaven</li>
        <li data-id="2"data-type="b">love</li>
    </ul>
</body>
</html> 
```

Quiksand1.3.js 和 Easing.js 也是必需的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:02:20.173

尝试更换

```
$('ul.holder li').click(
    function(e){
        $holder.quicksand($(this),{
            duration: 800,
        });
    return false;
}); 
```

和：

```
$('ul.holder').on('click', 'li', function(e){
        $holder.quicksand($(this),{
            duration: 800,
        });
    return false;
}); 
```

这会将点击处理程序绑定到`<ul>`始终在 DOM 中的。当您删除`<li>`'s 时，您也会丢弃他们的点击处理程序。这可能是问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:15:45.020

Here is a simpler version of the code:

Markup:

```
<ul>
    <li id='all'>[See all items]</li>
</ul>
<ul class='holder'>
    <li data-id="1" data-type="a">heaven</li>
    <li data-id="2"data-type="b">Earth</li>
    <li data-id="2"data-type="b">Dirt</li>
    <li data-id="2"data-type="b">Peace</li>
    <li data-id="2"data-type="b">More</li>
</ul> 
```

jQuery:

```
$("#all").on("click",function(){
    $(".holder li").show("slow");
});
$(".holder li").on("click",function(){
    $(".holder li").not($(this)).hide("slow");
}); 
```

JSFiddle: [http://jsfiddle.net/5ChVE/5/](http://jsfiddle.net/5ChVE/5/)

# visual-studio-2010 - Visual Studio 2010 错误“应用程序无法为 OpenGL 正确启动 (0xc000007b)

> ID：14965115
> 
> 赞同：1
> 
> 时间：2013-02-19T18:49:48.100
> 
> 标签：visual-studio-2010, opengl

我正在 Visual Studio 2010 中构建一个 OpenGL 程序，我的操作系统是 windows 8，当我在成功编译后运行我的程序时。它给了我一个错误，即应用程序无法正确启动 (0xc000007b) 。谁能告诉我这个错误的原因以及如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-30T09:09:00.687

你把“glut32.dll”和“glut.dll”两个文件放在“C:\Windows\SysWOW64”，那么你的程序就会成功运行。

# c++ - Boost mpl 变换序列“真实”类型

> ID：14965116
> 
> 赞同：4
> 
> 时间：2013-02-19T18:49:50.687
> 
> 标签：c++, templates, boost, boost-mpl

请参阅 boost mpl 转换文档中的以下代码：

```
typedef vector<char,short,int,long,float,double> types;
typedef vector<char*,short*,int*,long*,float*,double*> pointers;
typedef transform< types,boost::add_pointer<_1> >::type result;
BOOST_STATIC_ASSERT(( equal<result,pointers>::value )); 
```

我想了解类型系统`boost::mpl`和“它实际上是如何工作的”。据我了解`mpl::equal`，只是比较以下两个序列的元素，而不是整个序列类型本身。我不明白为什么以下失败：

```
BOOST_STATIC_ASSERT(( std::is_same<result,pointers>::value )); //< assert fails 
```

为什么结果类型与“指针”类型不是 100% 相同？我认为这是因为 mpl 正在执行转换惰性或者结果只是一个序列而不是一个向量？是否有可能以某种方式强制 mpl 不再偷懒并获得 100% 相同的类型（我可以自己编写一个转换函数，得到这个结果，但我想知道如何在 mpl 中做到这一点）？

我已经尝试了一些事情，例如将结果插入新向量但没有成功：

```
BOOST_STATIC_ASSERT(( std::is_same<
  mpl::insert_range< mpl::vector<>, mpl::begin<mpl::vector<> >::type,
  result >::type, pointers >::value )); //< assert fails too 
```

另外，我尝试在转换函数中使用 back_insert，但也失败了：

```
typedef transform< types,boost::add_pointer<_1>,
  mpl::back_inserter< mpl::vector< > > >::type result_new;
BOOST_STATIC_ASSERT(( std::is_same<result_new,pointers>::value )); //< fails... 
```

阅读“文档”对我没有帮助。再说一遍，是否有可能使用 mpl 变换（或任何其他变换序列函数）获得 100% 相同的类型？类型的结果是什么

```
result 
```

“在现实中”当它与指针不同时？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-25T18:45:13.337

再次感谢 @llonesmiz 使用 typeid() 漂亮地打印类型的代码，这有助于了解正在发生的事情。

所以看起来真正的结果类型取决于编译器（可能是 boost #ifdefs），英特尔编译器和 Visual Studio 将它转换回 std::vectorN<> 其中最大 N 是 boost 中的预定义数字（所以它在N 太大）。对于 g++，会生成一个重整类型（甚至是我的转换调用中的 2 种不同类型）。

所以我想通过 mpl::equal 检查类型很好（检查范围的元素）。如果所有类型都应该“真正”等效（std::is_same 成立），我想您需要手动将结果转换为可变参数模板类 std::tuple。

请参阅[http://liveworkspace.org/code/3l8O9K](http://liveworkspace.org/code/3l8O9K) 16 美元[代码示例](http://liveworkspace.org/code/3l8O9K%2416)

或简而言之：

```
template < class T, class R >
struct ToStdTuple;

template < class... TTypes, class X >
struct ToStdTuple< std::tuple< TTypes... >, X >
{
  typedef std::tuple< TTypes..., X > type;
}; 
```

接着

```
// typedef mpl::vector<char,short,int,long,float,double> types;
// typedef mpl::transform< types,boost::add_pointer<mpl::_1> >::type result;

typedef mpl::fold< result, std::tuple<>,
  ToStdTuple< mpl::_1, mpl::_2 > >::type result_normalized; 
```

导致

```
std::tuple<char*, short*, int*, long*, float*, double*> 
```

对于所有转换调用

# plone - 更改 Zope 模板中的属性

> ID：14965117
> 
> 赞同：3
> 
> 时间：2013-02-19T18:49:56.487
> 
> 标签：plone, zope, template-tal, zpt

我正在为包含文件的对象编写模板。我正在遵循[主题构建块说明](http://plone.org/documentation/manual/theme-reference/buildingblocks/skin/templates/referencemanual-all-pages)。

```
<a tal:attributes="href item/id">foo</a> 
```

这使得喜欢下载文件，如下所示：

```
<a href="foo">foo</a> 
```

但我希望该链接指向文件的查看页面，显示其标题、描述以及允许下载它。所以我想得到下一个输出：

```
<a href="foo/view">foo</a> 
```

如何生成该属性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T20:10:30.170

使用`string:`表达式添加`/view`部分：

```
<a tal:attributes="href string:${item/id}/view">foo</a> 
```

请注意，您可能希望使用`.absolute_url()`(for objects) 或`.getURL()`(for catalog results) 方法来为您的项目生成完整的绝对 URL：

```
<a tal:attributes="href string:${item/absolute_url}/view">foo</a> 
```

# css - 多个浏览器中的 Nivo Slider 渲染问题

> ID：14965118
> 
> 赞同：0
> 
> 时间：2013-02-19T18:49:57.957
> 
> 标签：css, nivo-slider

![IE9截图](../Images/17bb698c066e02a7a2d1adf91b4b5e1c.png)
![在此处输入图像描述](../Images/201ad5e6aa6843a9ba5372a99c8e41d7.png)
嘿，你们！我正在使用 Nivo Slider 构建一个站点（我通常在这方面取得了巨大的成功）。但是我对这种特殊用法有一些我无法弄清楚的问题。您的代码向导的任何帮助将不胜感激！

测试站点在[这里。](http://www.603mediagroup.com/uvcleaning/site/index.html)

像往常一样，在 Firefox 中，该站点看起来很棒。一切正常，没有任何损坏。在 Opera 中，几乎相同。

~~然而，在 IE9 中，滑块看起来很棒，直到它转换到下一个图像。滑块使用 float:right 属性，在 Explorer 中，每次转换都会导致图像瞬间跳到容器 div 的左侧。~~ **这个问题解决了。** “float:right” 属性仅放置在滑块图像上，而不是滑块容器本身。更正后的代码现在会导致单个图像和整个滑块容器都向右浮动。

在 Safari 中，滑块看起来很棒，除非您将页面大小调整为小于 100% - 然后，图像不会随着周围的内容而缩小。

~~在 Chrome 中，令人惊讶的是，这一切都搞砸了。首次加载时，滑块不会出现。如果我将查看大小减小到 90%，它看起来很好，包括当我将大小恢复到 100% 时。但是，标题功能并没有像在其他浏览器上那样弹出（请参阅该站点以了解我的意思）。~~ **解决了这个问题**事实证明，控制幻灯片的子弹是问题所在。或者，更准确地说，它们周围的 div 是。.controlNav 项目符号的 div 有一个 "position:absolute" 属性，在所有其他浏览器中都可以正常工作，但不知何故搞砸了 Chrome。我完全消除了这些项目符号，因为它们对于这个特定站点实际上不是必需的。问题解决了。 **不幸的是，所使用的方法完全破坏了 Safari 对滑块的渲染，所以现在我必须弄清楚这一点。**

我对此主题进行了大量搜索，发现 Nivo Slider 存在许多问题，尤其是在 IE 中，但没有与我所经历的完全相关的问题。我怀疑某些问题是由滑块通常不使用的 float:right 属性引起的（大多数网站以页面居中的容量使用它），但我不知道这是绝对的肯定。

这是滑块 HTML（Nivo Slider 有一个度量标准的 CSS，所以我不会在这里粘贴它。您可以使用浏览器的开发人员工具查看样式表。）：

```
<div id="header">
    <div class="layout-wrapper">
        <aside id="slider" class="theme-default">
            <div id="nivo-slider" class="nivoSlider slider-underline">
                <img src="images/slider-img1.jpg" class="attachment-slider_nivo" title="#slide-1" />
                <img src="images/slider-img2.jpg" class="attachment-slider_nivo" title="#slide-2" />
                <img src="images/slider-img3.jpg" class="attachment-slider_nivo" title="#slide-3" />
            </div>
            <!-- end #nivo-slider -->
            <div id="slide-1" class="nivo-html-caption" data-position="right">
                <span class="slider_title">Tile and Ceramic Cleaning</span>
                <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Nunc suscipit. Suspendisse enim arcu, convallis non, cursus sed, dignissim et, est. Aenean semper aliquet libero.</p>
                <a href="#" title="" class="more align-right">Read more »</a>
            </div>
            <!-- end #slide-1 -->
            <div id="slide-2" class="nivo-html-caption" data-position="left">
                <span class="slider_title">Kitchen Cleaning and Sanitizing</span>
                <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Nunc suscipit. Suspendisse enim arcu, convallis non, cursus sed, dignissim et, est. Aenean semper aliquet libero.</p>
            </div>
            <!-- end #slide-2 -->
            <div id="slide-3" class="nivo-html-caption" data-position="right">
                <span class="slider_title">Full Residential Services!</span>
                <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Nunc suscipit. Suspendisse enim arcu, convallis non, cursus sed, dignissim et, est. Aenean semper aliquet libero.</p>
            </div>
            <!-- end #slide-3 -->
        </aside>
        <div class="banner-1"></div>
        <!-- end #slider -->
    </div>
    <!-- end .layout-wrapper -->
</div>
<!-- end #header -->
<div class="clear"></div> 
```

我很感激你们能想出的任何和所有提示！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:21:42.170

`<aside>`用标签替换`<div>`标签。我在 chrome 检查器工具中做到了这一点，之后它似乎工作正常。

我现在`nivo-slider`在 4-5 个不同的网站上使用，从未见过它使用`<aside>`标签。

# php - chown / chgrp 来自 php vs python

> ID：14965121
> 
> 赞同：0
> 
> 时间：2013-02-19T18:50:06.450
> 
> 标签：php, apache, permissions, file-permissions, chown

我在 Ubuntu 上有两个用户*www-data*和*labour*，他们都在*chiara*组中。两个用户都可以

```
>chown :chiara some_file
>chgrp chiara some_file 
```

我有一个`test.py`使用的 python 脚本

```
import os
os.system('whoami')     # displays 'www-data' in both cases
res = os.system('chown :chiara some_file')
print res          # 0 when called from shell, 256 when called from php script 
```

当我以任一用户的身份调用此脚本时，它可以正常工作。

但是，当我从 apache 中的 php 脚本调用此脚本时

```
shell_exec('test.py') 
```

它不起作用*-*尽管显示的用户是“www-data”。如果我将“chmod”更改为“chgrp”，此问题仍然存在。此外，使用`os.chown`不起作用。对我来说似乎是一个一般的权限问题......

* * *

编辑：在 python 中使用 subprocess.Popen，我可以检索错误消息 `changing group of '/absolute/path/to/some_file': Operation not permitted`

* * *

编辑2：我想在这个问题上投降......在我的具体应用程序中，目录上的“chmod 777”就足够了（有效！）。但是，我只想了解出了什么问题。

# android - 如何通过左右滑动更改活动

> ID：14965124
> 
> 赞同：17
> 
> 时间：2013-02-19T18:50:18.407
> 
> 标签：android, android-activity, android-viewpager, swipe

如何通过左右滑动更改活动？

我在任何地方都没有找到手册。

*例子：*

[![在此处输入图像描述](../Images/e3b7f8206b54812de3188e0a3a63e693.png)](https://i.stack.imgur.com/MhEBY.png) [![在此处输入图像描述](../Images/339bfb17533722a6b1fde20c0743c9f6.png)](https://i.stack.imgur.com/f7VDO.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T18:55:32.300

关于您的第一个链接，它称为`ViewPager`.

遵循其中一个很棒的[教程](http://thepseudocoder.wordpress.com/2011/10/05/android-page-swiping-using-viewpager/)，它肯定会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T18:54:43.487

您正在寻找[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)。有关使用它的滑动屏幕的详细信息，请参阅文档的[这一](http://developer.android.com/training/animation/screen-slide.html)部分。

# android - 如何修复“java.io.IOException：没有要写入的套接字；是一个 POST 缓存”警告

> ID：14965126
> 
> 赞同：0
> 
> 时间：2013-02-19T18:50:22.297
> 
> 标签：android, httpurlconnection

有时，当我在 Android Gingerbread (OS 2.3.3) 上运行我的应用程序时，我在 logcat 中会出现如下警告：

```
java.io.IOException: No socket to write to; was a POST cached?
at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getOutputStream(HttpURLConnectionImpl.java:618)
at com.voices.voices.webservice.WebService$WebServiceAsyncTask.downloadUrl(WebService.java:1705)
at com.voices.voices.webservice.WebService$WebServiceAsyncTask.doInBackground(WebService.java:1615)
at com.voices.voices.webservice.WebService$WebServiceAsyncTask.doInBackground(WebService.java:1)
at android.os.AsyncTask$2.call(AsyncTask.java:185)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
at java.util.concurrent.FutureTask.run(FutureTask.java:138)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
at java.lang.Thread.run(Thread.java:1019) 
```

并且该调用的 HttpUrlConnection 失败。通常，此调用工作正常，但偶尔会失败。在 Android OS > 2.3.3 上运行时似乎没有这个问题。

问题是它为什么会失败，我应该如何解决这个问题？

以下是一些附加信息：

Webservice.java 的第 1705 行

```
dataStream = new DataOutputStream(conn.getOutputStream()); 
```

错误前的行：

```
...
            HttpURLConnection conn = null;
            DataOutputStream dataStream = null;

            //SETS COOKIE This should avoid the "Too many redirects issue" because It's apparently redirecting in an infinite loop because it's not maintain the user session.
            CookieHandler.setDefault(new CookieManager(null, CookiePolicy.ACCEPT_ALL));

            if( webServiceUrl.contains("https") ){
                TrustManager[] trustAllCerts = new TrustManager[]{
                         new X509TrustManager() {
                             public java.security.cert.X509Certificate[] getAcceptedIssuers() {
                                 return null;
                                 }
                             public void checkClientTrusted( java.security.cert.X509Certificate[] certs, String authType) {
                                 }
                             public void checkServerTrusted( java.security.cert.X509Certificate[] certs, String authType) {
                             }
                         }
                 }; // Install the all-trusting trust manager
                 try {
                     SSLContext sc = SSLContext.getInstance("TLS");
                     sc.init(null, trustAllCerts, new java.security.SecureRandom());
                     HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());
                     }
                 catch (Exception e) {
                     //L.l("TRUST MANAGER EXCEPTION");
                 }
            }

            try {

                responseInputStream = null;

                System.setProperty("http.keepAlive", "false");
                URL url = new URL(webServiceUrl);

                conn = (HttpURLConnection) url.openConnection();

                conn.setReadTimeout(Constants.CONNECTION_TIMEOUT_MILLISECONDS /* milliseconds */);
                conn.setConnectTimeout(Constants.CONNECTION_TIMEOUT_MILLISECONDS /* milliseconds */);
                conn.setDoOutput(true);
                conn.setDoInput(true);
                conn.setDefaultUseCaches(false);

                if( useMultipart ){
                    conn.setRequestProperty("Content-Type", "multipart/form-data; boundary="+ Constants.MULTIPART_BOUNDARY);
                } else {
                    conn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
                }
                conn.setRequestProperty("Cache-Control", "no-cache");
                conn.connect();

                // DATA STREAM
                dataStream = new DataOutputStream(conn.getOutputStream());
  ... 
```

我不确定这是否有帮助，但在 Android 的 HttpURLConnectionImpl.java 文件中，这是发生错误的地方

```
@Override
public OutputStream getOutputStream() throws IOException {
    if (!doOutput) {
        throw new ProtocolException("Does not support output");
    }

    // you can't write after you read
    if (sentRequestHeaders) {
        // TODO: just return 'requestBodyOut' if that's non-null?
        throw new ProtocolException(
                "OutputStream unavailable because request headers have already been sent!");
    }

    if (requestBodyOut != null) {
        return requestBodyOut;
    }

    // they are requesting a stream to write to. This implies a POST method
    if (method == GET) {
        method = POST;
    }

    // If the request method is neither PUT or POST, then you're not writing
    if (method != PUT && method != POST) {
        throw new ProtocolException(method + " does not support writing");
    }

    int contentLength = -1;
    String contentLengthString = requestHeader.get("Content-Length");
    if (contentLengthString != null) {
        contentLength = Integer.parseInt(contentLengthString);
    }

    String encoding = requestHeader.get("Transfer-Encoding");
    if (chunkLength > 0 || "chunked".equalsIgnoreCase(encoding)) {
        sendChunked = true;
        contentLength = -1;
        if (chunkLength == -1) {
            chunkLength = DEFAULT_CHUNK_LENGTH;
        }
    }

    connect();

    if (socketOut == null) {
        // TODO: what should we do if a cached response exists?
        throw new IOException("No socket to write to; was a POST cached?");
    } 
```

所以出于某种原因，socketOut == null，很奇怪。

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T16:45:53.530

这可能不是最好的方法，但它对我有用。我只需要在我的 httpURLConnection 上禁用缓存

```
conn.setDefaultUseCaches(false);
conn.setUseCaches(false);
conn.setRequestProperty("Expires", "-1");
conn.setRequestProperty("Cache-Control", "no-cache"); 
```

# java - 从任何类填充活动的 TextView

> ID：14965128
> 
> 赞同：0
> 
> 时间：2013-02-19T18:50:29.840
> 
> 标签：java, android, class, textview

我有一个名为 AdapterFilaProducto.java 的类，该类在列表中显示某些信息。

这是我的课

```
public class AdapterFilaProducto extends BaseAdapter {
  protected Activity activity;
  protected ArrayList<ItemFilaProducto> items;
  protected ItemFilaProducto item;
  protected String tipo;
  protected Mascaras msk = new Mascaras();
  public ImageButton btnImDerecha ;
  public ImageButton btnImIzquierda;
  public TextView producto;
  private Venta contex;
   TextView precio;
private BaseDataAdapter db;
private TextView precioCantidad;

  public AdapterFilaProducto(Activity activity, ArrayList<ItemFilaProducto> items,String tipo) {
    this.activity = activity;
    this.items = items;
    this.tipo = tipo;
  }
  public AdapterFilaProducto(Activity activity,Venta contex, ArrayList<ItemFilaProducto> items,String tipo) {
        this.activity = activity;
        this.items = items;
        this.tipo = tipo;
        this.contex=contex;
      }

  public int getCount() {
    return items.size();
  }

  public Object getItem(int position) {
    return items.get(position);
  }

  public long getItemId(int position) {
    return items.get(position).getId();
  }
  public String getItemProducto(int position) {
        return items.get(position).getProducto();
      }
  public String getItemCantidad(int position) {
        return items.get(position).getCantidad();
      }
  public String getItemPercio(int position) {
        return items.get(position).getPrecio();
      }
  public EditText getItemEdit(int position) {
        return items.get(position).getEditTxt();
      }

  public View getView(int position, View convertView, ViewGroup parent) 
  {

    db = new BaseDataAdapter(activity);

    View vi=convertView;
    final ItemFilaProducto item = items.get(position);

    if(convertView == null) 
    {
              LayoutInflater inflater = (LayoutInflater) activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
              vi = inflater.inflate(R.layout.list_producto, null);
    }  

       btnImDerecha = (ImageButton) vi.findViewById(R.id.BtnDerechaVenta);
       btnImIzquierda = (ImageButton) vi.findViewById(R.id.BtnIzquierdaVenta);
       TextView producto = (TextView) vi.findViewById(R.id.txtProductoVenta);
       item.precio = (TextView) vi.findViewById(R.id.txtCantidadVenta);
       item.edtxt = (EditText) vi.findViewById(R.id.editTxtListVenta);
       producto.setText(item.getProducto());
       Log.i("Precio",item.montoPrecio);
       if(item.cantidad.equalsIgnoreCase("0")){
           item.precio .setText(item.Precio);
       }else 
           item.precio .setText(item.montoPrecio);

       item.edtxt.setText(""+item.cantidad);

       btnImDerecha.setOnClickListener(new OnClickListener() {

             @Override
                public void onClick(View v) {
                    int i = Integer.parseInt(item.edtxt.getText().toString());
                    i=i+1;
                    item.edtxt.setText(""+i);

             }
            });
       btnImIzquierda.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    int i = Integer.parseInt(item.edtxt.getText().toString());
                      if(0<i){
                        i=i-1;
                        item.edtxt.setText(""+i);

                        }
             }
            });
               item.edtxt.addTextChangedListener(new TextWatcher() {
               public void afterTextChanged(Editable s)
               { 

               }
            public void beforeTextChanged(CharSequence arg0, int arg1, int arg2, int arg3) {

            }
            public void onTextChanged(CharSequence s, int start, int before, int count) { 
                db.open();
                Cursor cur = db.obtenerProductosTipo(tipo,item.getIdPro());
                if(cur.moveToFirst()){
                    int precio = cur.getInt(3);
                    int cantidad = Integer.parseInt(item.edtxt.getText().toString());
                    int monto = precio*cantidad;
                    if(0 < monto){
                        item.setPrecio(msk.mascaraMontoTxt(String.valueOf(monto)));
                        item.precio .setText(item.getPrecio());
                    }
                    db.actualizarProductoMonto(item.getIdPro(),monto);
                    db.actualizarProductoCantidad(item.getIdPro(),cantidad);
                }
                cur.close();
                int montoTotal = 0;
                Cursor curAll = db.obtenerProductosTipo(tipo);
                if(curAll.moveToFirst()){

                    do{
                        montoTotal = montoTotal + curAll.getInt(5);
                        Log.e("CANTIDAD", ""+curAll.getInt(5));
                    }while(curAll.moveToNext());
                    }

                curAll.close();
                try{
                    db.borrarTablaPar("MONTO");
                }catch(Exception e){

                }
                Log.e("MONTO", ""+montoTotal);
                DtoParametro dtoParametro = new DtoParametro();
                dtoParametro.ID_PAR = "MONTO";
                dtoParametro.VALOR = String.valueOf(montoTotal);
                Log.i("MONTO",""+String.valueOf(montoTotal));
                db.insertarParametro(dtoParametro);
                db.close();
                contex.mostrarMonto();

            }
            });
    return vi;
  }     
} 
```

而我需要做的是在我的主要 Activity 中显示**montoTotal**。并在我的 Principal Activity 的 Textview 中显示它的总量。我们尝试了几种方法，但都没有成功。我会很感激你的帮助，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:15:36.143

Its really hard to follow your code but you should either be able to make this an `inner class` of your `PrincipalActivity` and make `montoTotal` a member variable so that you can access it from where you need or create an instance of this class that retrieves the variable from a function

# php - 如何解决where子句中的时间问题

> ID：14965129
> 
> 赞同：-2
> 
> 时间：2013-02-19T18:50:30.897
> 
> 标签：php, mysql

我的“用户”表如下所示。

```
 id   |   name  |   time

 1    |    a1   |  2012-11-15 06:20:28

 2    |    a2   |  2012-11-14 06:20:28

 3    |    a3   |  2012-11-13 06:20:28 
```

现在我的问题是，如何获取时间在当前时间或比当前时间少 30 秒之间的用户详细信息..

我试过了..

```
"SELECT * 

FROM user

WHERE strtotime(user_session.session_timestamp)-30 < ".time().")"; 
```

它不工作......它会抛出语法错误

请帮我解决问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T18:53:16.913

不需要 PHP。您可以使用[MySQL 日期和时间函数](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)。

```
SELECT * FROM user WHERE time BETWEEN (NOW() - INTERVAL 30 SECOND) AND NOW(); 
```

**注意：**此查询未*优化*，因为日期函数会阻止查询被缓存。如果这是一个大问题，那么使用 PHP 等效项可能会更高效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T18:54:41.803

strtotime() 是一个 PHP 函数，而不是 MySQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T18:57:15.647

你不能那样做。你需要做两个不同的`SELECT`陈述。一个来收集`user_session.session_timestamp`。调用 PHP`strtotime()`函数`-30`，然后在当前`SELECT`语句中使用该变量。根据您进行此设置的方式，您可能会使用 a`foreach( $array as $key => $value)`来逐步执行并运行尽可能多的选择以获得单独的回报。许多问题是在 SQL 语句中使用的 PHP 函数。

或者按照杰森说的去做！纯 SQL 总是更好，但我假设您出于某种原因需要或想要使用 PHP，有时需要访问 PHP 中的数据的重要原因。

# java - 在 where 子句中使用 null 的以下 HQL 查询有什么区别？

> ID：14965133
> 
> 赞同：1
> 
> 时间：2013-02-19T18:50:41.783
> 
> 标签：java, null, hql

follow to 和有什么不`HQLs`一样

```
1\. "from Object where field is null"
2\. "from Object where field = null" 
```

上述陈述中哪一项是正确的？怎么打电话`null`？`HQL`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T18:56:49.103

在 ANSI SQL 中，"Null = Null" 给你 Null，不是真的，所以如果你试图选择某个东西等于 null，其中答案需要是“是的，它是 null”，那么你需要使用“一片空白”。

# svm - 使用 SVM 进行二元分类

> ID：14965138
> 
> 赞同：0
> 
> 时间：2013-02-19T18:51:14.833
> 
> 标签：svm

我正在使用 sVM-light 进行二进制分类。我在学习模式下使用 SVM。我准备好了我的 train.dat 文件。但是当我运行这个命令时，它不是创建文件模型，而是在终端中写入一些东西：

我的命令：

./svm_learn example1/train.dat example1/model 输出：

扫描示例...完成 将示例读入内存...特征编号必须大于或等于 1！: 成功线: -1 0:1.0 6:1.0 16:1.0 18:1.0 28:1.0 29:1.0 31:1.0 48:1.0 58:1.0 73:1.0 82:1.0 93:1.0 95:1.0 106:1.0 108: 1.0 118:1.0 121:1.0 122:1.0151:1.0 164:1.0 167:1.0 169:1.0 170:1.0 179:1.0 190:1.0 193:1.0 220:1.0 237:1.0250:1.0 202:1.0 1.08:27:26 269:1.0 278:1.0 283:1.0 291:1.0 300:1.0 305:1.0320:1.0 332:1.0 336:1.0 342:1.0 345:1.0 348:1.0 349:1.0 350:1.0 368:1.0 370:1.0 370:1.0。 :1.0 394:1.0 395:1.0 396:1.0 397:1.0 400:1.0 401:1.0 408:1.0 416:1.0427:1.0 433:1.0 435:1.0 438:1.0 441:1.0 446:1.0 456:18.0 4 456:18.0 4 :1.0 510:1.0523:1.0 525:1.0 526:1.0 532:1.0 540:1.0 553:1.0 567:1.0 568:1.0 581:1.0 583:1.0604:1.0 611:1.0 615:1.0 616:1.3:68.6 1.0 624:1.0 626:1.0 651:1.0 659:1.0677:1.0 678:1.0 683:1.0 690:1。

我不知道该怎么办。

ps当我让我的 train.dat 变得更短时，一切正常！！！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T18:24:06.807

从我可以从日志中解释的内容来看，您的训练集有问题。

有问题的训练行的前几个字符是
`-1 0:1.0 6:1.0`

问题不在于大小，而在于特征索引。您从 0 (0:1) 开始您的特征索引，而`svmlight`要求所有特征索引等于或大于 1。

将索引更改为从 1 开始，它应该可以正常工作。

# jquery - Jquery ajax 如果错误再执行一次此请求

> ID：14965141
> 
> 赞同：0
> 
> 时间：2013-02-19T18:51:27.597
> 
> 标签：jquery, ajax

我有这样的代码可以通过 ajax 获取一些数据，但有时它会引发错误......

```
$.ajax({ 
      url: "/carts/get_cart_totalqnt/qnt/cart/", 
      type: "GET", 
      data: {id: $(".cartid").attr("id")},
      success: function(text)
      {
        $("#total_count").html(text + " товар(ов)");
      },
      error: function(){
        alert('Ошибка javascript');
      },
      dataType : "html"
    }); 
```

但是我该怎么做，如果我收到错误，我会再做一次这个请求？

如果出错，再做一次这个ajax请求

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T18:57:34.873

```
var retries = 3;    

error: function(jqXHR, textStatus, errorThrown) {
    if (textStatus == 'Internal Server Error') {
        do {
            $.ajax(this);
            retries--;
        } while (retries < 1)
    }
} 
```

`textStatus`您可以在[这里](http://api.jquery.com/jQuery.ajax/)找到可能的值

# html - Fb graph api权限不起作用

> ID：14965146
> 
> 赞同：0
> 
> 时间：2013-02-19T18:51:43.910
> 
> 标签：html, facebook, facebook-graph-api, facebook-javascript-sdk

我正在使用 facebook 登录及其图形 api 将用户的所有图像列出到我的网站，以下代码仅适用于我是 facebook 应用程序的管理员和所有者，当他登录时它不适用于任何其他人该网站使用 facebook 登录。

代码说明：当用户登录时，调用一个名为testAPI的函数，获取用户基本信息，然后再次调用FB.API获取权限，最后获取图片。

权限参数“res”对任何其他用户都没有任何作用，但它对我（管理员）有用。
继承人的代码：

```
<div id="fb-root"></div>
 <script>
  // Additional JS functions here
  window.fbAsyncInit = function() {
  FB.init({
   appId      : MY_APP_ID, // App ID
  status     : true, // check login status
  cookie     : true, // enable cookies to allow the server to access the session
  xfbml      : true  // parse XFBML
   });

   FB.getLoginStatus(function(response) {
    if (response.status === 'connected') {
                testAPI();
 } else if (response.status === 'not_authorized') {
       login();
     } else {
       login();
      }
     });

   };

    function login() {
       FB.login(function(response) {
           if (response.authResponse) {
            testAPI();
            } else {
           // cancelled
           }
         },{scope:'user_photos',perms:'user_photos'});
  }
   var id;
   function testAPI() {
    console.log('Welcome!  Fetching your information.... ');
    FB.api('/me', function(response) {
    console.log('Good to see you, ' + response.name + '.');
    console.log(response);
    id=response.id;

var link='/'+ id + '/permissions?access_token=FB_GENERATED_ACCESS_TOKEN';
 FB.api(link,function(res){
 console.log("permissons: ",res);
     link='/'+ id + '/photos?fields=images';
     FB.api(link, function(response) {
      //placing all pictures
      for(var i=0;i<response.data.length;i++)
      {
            var img="<img src="+response.data[i].images[0].source+" class='small' />";
         $("#images").append(img);
    }      
      console.log(response);
       });      

 });

    });}
   (function(d){
   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
   if (d.getElementById(id)) {return;}
   js = d.createElement('script'); js.id = id; js.async = true;
   js.src = "//connect.facebook.net/en_US/all.js";
   ref.parentNode.insertBefore(js, ref);
  }(document));
 </script></body>

  <fb:login-button autologoutlink='true'   
  perms='email,user_birthday,status_update,publish_stream'></fb:login-button>
 <div id="images"></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T05:21:19.257

我得到了你的实际问题，

```
<fb:login-button autologoutlink='true' 
 perms='email,user_birthday,status_update,publish_stream'></fb:login-button> 
```

您在这里错过了 user_photos 权限。你的 javascript 函数没有调用，因为 fb:login-button 自己做所有的事情。你的新代码应该是：

```
<fb:login-button autologoutlink='true' 
     perms='email,user_birthday,status_update,publish_stream,user_photos'></fb:login-button> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T13:53:30.180

代替

```
var link='/'+ id + '/permissions?access_token=FB_GENERATED_ACCESS_TOKEN';
FB.api(link,function(res){
console.log("permissons: ",res);
 link='/'+ id + '/photos?fields=images';
 FB.api(link, function(response) {
  //placing all pictures
  for(var i=0;i<response.data.length;i++)
  {
        var img="<img src="+response.data[i].images[0].source+" class='small' />";
     $("#images").append(img);
}      
  console.log(response);
   }); 
```

试试这个：

```
FB.api('/me/permissions', function (response) {
    console.log("permissons: ", res);
    var perms = response.data[0];

    if (perms.user_photos) {

        FB.api('/me/photos?fields=images', function (response) {
            //placing all pictures
            for (var i = 0; i < response.data.length; i++) {
                var img = "<img src=" + response.data[i].images[0].source + " class='small' />";
                $("#images").append(img);
            }
            console.log(response);
        } else {
            // User DOESN'T have permission. Perhaps ask for them again with FB.login?
            login();
        }
        }); 
```

# java - 在 JTable 中使用 JButton 和 Action 有什么缺点？

> ID：14965152
> 
> 赞同：1
> 
> 时间：2013-02-19T18:52:01.113
> 
> 标签：java, swing, user-interface, jtable, listener

我有一个`JTable`自定义渲染器。当单击 中的一个项目时`JTable`，我会执行一组影响我的模型的特定操作。我有两种选择来实现这一点：

**ListSelectionListener** ：我在我的整体上添加了一个侦听器，`JTable`当单击一行时触发。然后我执行动作。

*   优点：允许我选择行的任何部分（在我的情况下不是必需的），可能是 Swing*打算*让事件在`JTable`
*   缺点：我必须创建一个自定义类来处理这个并重现代码。

例子：

```
class Selector implements ListSelectionListener {
    @Override
    public void valueChanged(ListSelectionEvent event) {
        // ... write the action code here
    }
} 
```

**JButton & Action** ：我渲染一个`JButton`并添加`Action`一个`JButton`。

*   优点：我可以重复使用它`Action`，如果我改变它`Action`，所有使用它的实例都会被更新。
*   缺点：我将逻辑移动到我的渲染代码中。

例子：

```
class Renderer implements TableCellRenderer {
    @Override
    public Component getTableCellRendererComponent(JTable table, Object value,
                        boolean isSelected, boolean hasFocus, int row, int col) {
        JButton btn = new JButton(value.toString());
        btn.setAction(new SpecificAction());
        return btn;
    }
} 
```

1.  如果我使用第二种方案，会不会有火从天而降？

2.  它们是否同样可行？

3.  有什么方法可以`Action`在 a 中使用 s`ListSelectionListener`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:02:38.887

在不了解您的特定用例的情况下，这是我的想法：

1) 我不会使用 ListSelectionListener。一些用户倾向于通过箭头键滚动表格。我不希望我的听众仅仅因为用户使用箭头键“滚动”而触发。但是，我已经将它用于一些特定的、不太常见的情况。

2) 我会使用渲染器在单元格中显示一个 JButton，然后在表格上添加一个 MouseListener。将 mouseClicked 事件中的坐标转换为表格单元格。如果单元格具有 ButtonRenderer，则触发相应的代码。这更有可能过滤掉不需要的操作，因为单击特定单元格更有可能是用户的有意操作。

编辑：

这是来自 Rob Camick 网站的解决方案：[Table Button Column](http://tips4java.wordpress.com/2009/07/12/table-button-column/)

并在此处进行简短讨论：[向 JTable 添加按钮](https://stackoverflow.com/questions/9321623/adding-button-to-jtable)

# emacs - Lisp 的 Emacs 配置脚本

> ID：14965153
> 
> 赞同：0
> 
> 时间：2013-02-19T18:52:05.590
> 
> 标签：emacs, lisp, scheme

预制 Emacs 配置脚本有哪些选择？例如以 Lisp 为中心的键绑定、自动完成/“智能感知”、括号匹配、代码格式化等。

到目前为止，我只发现：

*   [emacs 入门套件](https://github.com/technomancy/emacs-starter-kit)
*   [红腿](http://www.foldr.org/~michaelw/emacs/redshank/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T00:49:37.957

还有[Prelude](https://github.com/bbatsov/prelude)，我可以推荐。它具有简洁的结构和代码，并定期更新以包含新的有趣和有用的包或设置。

不要使用来自 EmacsWiki 的配置。那里发布的大部分内容都很旧，从那以后就再也没有更新过，因此现在已经过时了。它们中的许多将无法在现代 GNU Emacs 版本中工作。

相反，还可以查看编写 Emacs 包的人的 Github 帐户，您会发现许多 Emacs 配置。其中一些是为其他人重复使用而创建的，例如[https://github.com/purcell/emacs.d](https://github.com/purcell/emacs.d)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:12:23.417

请参阅[http://emacswiki.org/emacs/CategoryDotEmacs](http://emacswiki.org/emacs/CategoryDotEmacs)，尤其是在“一些完整的 InitFiles”及以下部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T11:30:46.513

这是我的配置脚本：

[https://github.com/huseyinyilmaz/emacs-config](https://github.com/huseyinyilmaz/emacs-config)

# php - 使用 PHP GD 更改图像的色调（透明 PNG）

> ID：14965157
> 
> 赞同：1
> 
> 时间：2013-02-19T18:52:32.707
> 
> 标签：php, image-processing, gd, hue

我提到了[**这个**](https://stackoverflow.com/questions/1890409/change-hue-of-an-image-with-php-gd-library)问题的答案。我目前正在使用以下代码进行色调叠加：

```
function imagehue(&$image, $angle) {
if($angle % 360 == 0) return;
$width = imagesx($image);
$height = imagesy($image);

for($x = 0; $x < $width; $x++) {
    for($y = 0; $y < $height; $y++) {
        $rgb = imagecolorat($image, $x, $y);
        $r = ($rgb >> 16) & 0xFF;
        $g = ($rgb >> 8) & 0xFF;
        $b = $rgb & 0xFF;            
        $alpha = ($rgb & 0x7F000000) >> 24;
        list($h, $s, $l) = rgb2hsl($r, $g, $b);
        $h += $angle / 360;
        if($h > 1) $h--;
        list($r, $g, $b) = hsl2rgb($h, $s, $l);            
        imagesetpixel($image, $x, $y, imagecolorallocatealpha($image, $r, $g, $b, $alpha));
    }
  }
} 
```

它适用于 JPG。但是此代码不适用于透明的 PNG 图像。这就是我为 PNG 图像调用此函数的方式：

```
header('Content-type: image/png');
**$image = imagecreatefrompng('image.png');**
imagehue($image, 180);
imagejpeg($image); 
```

有谁知道我应该做些什么改变？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-05T12:10:53.970

这是因为您使用该`imagejpeg`功能，`imagepng`而是使用。如果您还希望它使用 alpha 透明度，请将其添加到您的代码中：

```
imagealphablending($image, false);
imagesavealpha($image, true); 
```

# jquery - Jquery - 按顺序执行自定义函数调用

> ID：14965160
> 
> 赞同：3
> 
> 时间：2013-02-19T18:52:38.347
> 
> 标签：jquery, function, sequence

我正在使用 jQuery 1.9.1。我有一个自定义函数，它执行一些操作，然后执行 $.ajax 调用。我想按顺序调用这个函数。我试过 $.when，但它并没有解决我的问题。

```
function func(param) {
    //some operations
    $.ajax()
}

main() {
    //first call
    func(param1);
    //wait for done and the run the second
    func(param2);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T18:59:07.240

AJAX 调用是异步的，这意味着您将永远无法按照您的方式调用它们。

相反，您想要做的是利用调用中的回调函数`$.ajax()`。你最终会得到这样的东西：

```
function func(param) {
   // Other stuff
   $.ajax({
      success: func(param2)
   })
} 
```

不过要小心无限循环，因为您调用的是同一个函数。查看该方法的 jQuery 源代码并了解它们如何处理回调可能是值得的`ajax()`，并以类似的方式编写您的方法，因此您最终可能会得到如下内容：

```
main() {
   func(param1, {success: func(param2)});
} 
```

（注意：`$.ajax()`确实有一个`async`设置，您可以将其设置为 false，但是 IMO，最好了解 AJAX 和回调的工作原理，因为您将使用预期的行为，而不是反对它，从长远来看，这将为您省去麻烦。此外，大型同步 AJAX 调用可能会导致您的网站无响应，这对您的用户体验不利。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T19:01:22.240

您可以将 ajax 调用作为延迟返回，这使您可以访问该`done`函数。[http://api.jquery.com/category/deferred-object/](http://api.jquery.com/category/deferred-object/)

查看 Shauna 的答案以获得对 ajax 的更深入解释。

```
function func(param) {
    //some operations
    return $.ajax()
}

main() {
    //first call
    func(param1).done(function(){
       //wait for done and the run the second
       func(param2);
    });

} 
```

# command-line - 使用代码启动 Photoshop 动作

> ID：14965163
> 
> 赞同：5
> 
> 时间：2013-02-19T18:52:45.063
> 
> 标签：command-line, photoshop, photoshop-script

是否可以使用代码启动 Photoshop 操作？我的意思是通过批处理文件在 Photoshop 中启动操作？或类似的东西？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-20T02:26:31.930

较新版本的 Photoshop（CS5 和 CS6 是我使用过的唯一版本）支持一种称为`Droplets`允许您创建可执行文件以运行一组操作的功能。

[在此处](http://www.photoshoplab.com/droplets-for-the-lazy.html)查看有关创建和运行 Droplet 的详细信息。很快就会用这些步骤更新这个答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T22:25:15.883

我相信是这样，但我自己没有尝试过。PS6 JavaScript API 有一个名为 doAction() 的方法，这可能是您正在寻找的。

[http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/products/photoshop/pdfs/cs6/Photoshop-CS6-JavaScript-Ref.pdf](http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/products/photoshop/pdfs/cs6/Photoshop-CS6-JavaScript-Ref.pdf)

# php - 将 SQL Server 与 PHP 一起使用

> ID：14965165
> 
> 赞同：-1
> 
> 时间：2013-02-19T18:52:50.673
> 
> 标签：php, sql-server-2008-r2

PHP 最初是为与 MYSQL 交互而设计的。我想知道难度级别是多少，以及将 PHP 与 SQL Server 2008 r2 一起使用的最佳方法是什么。我做了一些研究，似乎有一些可用的库。这在生产层面是可行的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T18:56:02.543

PHP 有一个处理 MSSQL 的库（[http://php.net/manual/en/book.mssql.php](http://php.net/manual/en/book.mssql.php)）。如果您希望使用更抽象的库，您也可以考虑使用带有适当驱动程序的 PDO（[http://www.php.net/manual/en/ref.pdo-sqlsrv.php ）。](http://www.php.net/manual/en/ref.pdo-sqlsrv.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T18:54:45.107

有一个在 Windows 下工作的 SQL Server 驱动程序：http: [//www.microsoft.com/en-ca/download/details.aspx?id=20098](http://www.microsoft.com/en-ca/download/details.aspx?id=20098)

[http://php.net/manual/en/book.mssql.php](http://php.net/manual/en/book.mssql.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T18:57:07.167

看看[http://puurunen.ca/blog/?p=139](http://puurunen.ca/blog/?p=139) 你应该找到一些关于 sql server 2008 r2 PDO implementation 的信息

# c++ - 错误：请求成员（也许您打算使用 '->' ？）同时使用 '->' 已经

> ID：14965170
> 
> 赞同：3
> 
> 时间：2013-02-19T18:53:05.433
> 
> 标签：c++, pointers, syntax, compiler-errors, dynamic-allocation

这个错误的含义有一个简单的解释吗？

> 错误：在“* printerInfo”中请求成员“属性”，它的指针类型为“PPRINTER_INFO_2 {aka _PRINTER_INFO_2A*}”（也许您打算使用“->”？）

```
PPRINTER_INFO_2* printerInfo = NULL;

    void ChangedPrinter()
    {
       ...
       DWORD attributesPrinterInfo;

       printerInfo = (PPRINTER_INFO_2*) malloc(bufferSize);

       attributesPrinterInfo = printerInfo->Attributes; // error

       free(printerInfo);
    } 
```

我究竟做错了什么？？？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T19:07:03.240

[PRINTER_INFO_2](http://msdn.microsoft.com/en-us/library/dd162845(v=vs.85).aspx)结构定义为：

```
typedef struct _PRINTER_INFO_2 {
  // ...
} PRINTER_INFO_2, *PPRINTER_INFO_2; 
```

`PPRINTER_INFO_2`指向的指针也是如此`PRINTER_INFO_2`。当你这样做

```
printerInfo = (PPRINTER_INFO_2*) malloc(bufferSize); 
```

`printerInfo`实际上变成了指向的指针`PRINTER_INFO_2`。我不确定这是一个意图还是一个错误，但如果它是有意的，`PPRINTER_INFO_2*`那么正确的用法是：

```
(*printerInfo)->Attributes 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-09T08:45:31.583

对于 Cpp，请参阅此[https://gcc.gnu.org/bugzilla/show_bug.cgi?id=91138](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=91138)

建议 -> 在已经使用它时没有帮助。正确的解决方法是建议 (*pp)->member

# c++ - 是否有任何 C++ 编译器删除在内联时始终保持相同答案的 if 语句？

> ID：14965171
> 
> 赞同：3
> 
> 时间：2013-02-19T18:53:06.267
> 
> 标签：c++, performance, optimization

如果我有例如以下功能：

```
void foo(DoThisSometimes, DoThisAlways)
{
  if (DoThisSometimes == 1)
    {
      //Do stuff
    }
  //Do other stuff
{ 
```

一段内联代码将此函数调用`DoThisSometimes`为 0，是否有任何编译器会从内联函数中删除这部分代码：

```
if (DoThisSometimes == 1)
    {
      //Do stuff
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T19:04:39.457

一个体面的编译器当然应该进行这种优化，而 GCC 可以。以下来源：

```
#include <cstdio>

inline void foo(bool maybe)
{
    if (maybe) {
        printf("Maybe\n");
    }
    printf("Always\n");
}

int main()
{
    foo(true);
    foo(false);
} 
```

编译（优化`-O3`）为：

```
0000000000400410 <main>:
  400410:   48 83 ec 08             sub    $0x8,%rsp
  400414:   bf e4 05 40 00          mov    $0x4005e4,%edi
  400419:   e8 d2 ff ff ff          callq  4003f0 <puts@plt>
  40041e:   bf ea 05 40 00          mov    $0x4005ea,%edi
  400423:   e8 c8 ff ff ff          callq  4003f0 <puts@plt>
  400428:   bf ea 05 40 00          mov    $0x4005ea,%edi
  40042d:   e8 be ff ff ff          callq  4003f0 <puts@plt>
  400432:   31 c0                   xor    %eax,%eax
  400434:   48 83 c4 08             add    $0x8,%rsp
  400438:   c3                      retq   
  400439:   0f 1f 00                nopl   (%rax) 
```

无条件地叫`puts`了三遍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T18:58:11.740

是的，很有可能。如果编译器可以找出值是什么，它通常会删除全部或部分 if 语句。

部分，我的意思是如果你这样做：

```
 if (DoThisSometimes == 1 || foo == 0) 
```

编译器也许可以删除`DoThisSometimes==1`，但不能删除`foo == 0`部分，因为`foo`在内联点可能没有已知值。

请记住，这是编译器实现细节，因此编译器不保证删除该语句，如果它无法弄清楚值是什么，它肯定不会。它也可能在有 if 语句时决定不内联函数，因为它认为函数太长，然后当 if 语句消失时，内联就可以了。因此，虽然您可以预期会发生这种情况，但您当然不应该依赖它，如果它是超级关键的 - 在这种情况下，创建两个函数，一个用于“DoThisSometimes == 1”，一个用于“DoThisSometimes != 1”。

# javascript - content_script 仅在匹配扩展 uri 时

> ID：14965173
> 
> 赞同：0
> 
> 时间：2013-02-19T18:53:13.950
> 
> 标签：javascript, google-chrome-extension

是否有可能只在 URL 匹配“chrome-extension://my-extension-id/*”时注入 content_script

我在网页中注入了一个 iframe（源是本地的，即 chrome-extension://.../dialog.html）以与用户交互，但我需要特殊权限，我知道它可以通过消息来完成，但我会而是仅在该页面中注入 content_script。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T15:00:41.673

我找到了一种方法，因为没有人回答并且谷歌搜索没有帮助我回答我自己的问题 - 我希望这对未来的人有所帮助。

在注入的脚本中，我通过获取自己的 url 来获取扩展路径

```
var scripts = (document.head||document.documentElement).getElementsByTagName('script');

var self = scripts[scripts.length -1];//get own script element from the DOM

var extensionURL = self.src.match(/^chrome-extension\:\/\/[^\/]+/);
extensionURL = extensionURL && extensionURL[0]; 
```

extensionURL 现在是扩展的路径

# c++ - 对基于范围的for循环的误解？

> ID：14965174
> 
> 赞同：5
> 
> 时间：2013-02-19T18:53:16.187
> 
> 标签：c++, for-loop, enum-class

当我尝试编译以下代码时发生编译器错误：

```
for(binary_instructions_t &inst: BinaryInstructions){

} 
```

`BinaryInstructions`这个枚举类是：

```
typedef unsigned int binary_instructions_t;

enum class BinaryInstructions : binary_instructions_t
{
    END_OF_LAST_INSTR = 0x0,

    RESET,
    SETSTEP,
    START,
    STOP,

    ADD,
    REMOVE,
}; 
```

我应该被允许使用枚举类中的项目“做一个”基于循环的范围吗？或者我是否巧妙地误解了基于 for 循环的范围是用于搜索数组的内容而不是枚举类之类的东西？

我也尝试过：创建实例并在实例中搜索：

```
BinaryInstructions bsInstance;
for(binary_instructions_t &inst : bsInstance){

} 
```

但没有雪茄......提前谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T18:57:43.920

基于范围的 for 循环需要一个集合，如数组或向量。枚举类不是集合。

但是，它是 C++，所以有一个解决方法。请参阅：[使用枚举类允许基于范围的 For？](https://stackoverflow.com/questions/8498300/allow-for-range-based-for-with-enum-classes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:01:48.613

基于范围的 for 循环是一种在元素列表上轻松迭代的机制。“元素列表”可以是普通数组，也可以是实现返回迭代器类型的`begin`和方法的类的实例。`end`

例子：

```
int arr[] = { 1, 2, 3, 4 };
for (int cur : arr)
   std::cout << cur << std::endl; 
```

# css - 使元素填充父容器提供的可用空间

> ID：14965180
> 
> 赞同：1
> 
> 时间：2013-02-19T18:53:38.040
> 
> 标签：css

我有一篇流畅的文章，有 2 列 1 包含一个图像，该图像填充了该列可用的任何空间，另一列有文本，但我不确定如何使该列`.content-col`占据`.article`. 谁能建议如何实现这一目标？

jsfiddle [http://jsfiddle.net/R7AuG/](http://jsfiddle.net/R7AuG/)

**CSS 片段**

```
.img-col{
    width: 25%;
    float: left;
}

.content-col{
    background: black;
    width: 75%;
    float: left;
}

.col{
    width: 50%;
    float: left;
} 
```

我也明白这可以实现，`display:table`但我想知道是否可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:04:09.527

如果你不想模仿表格，你可以使用一个小的 CSS 技巧，即添加

```
overflow: hidden 
```

to `article`, 加上应用

```
margin-bottom:-1000em;
padding-bottom:1000em; 
```

到`.content-col`

[查看示例](http://jsfiddle.net/2CM4f/)

# jquery - Jvectormap 1.2.2 颜色问题

> ID：14965181
> 
> 赞同：1
> 
> 时间：2013-02-19T18:53:41.710
> 
> 标签：jquery, map, colors, country, jvectormap

我正在使用最新的 Jvectormap (1.2.2) 但找不到**设置所有国家颜色的**任何示例。我相信在以前的版本中它只是“颜色：”，但现在已经停产了？

下面的代码有效，但颜色部分无效。我在我的网站上使用白色背景，因此希望**所有国家/地区默认具有不同的颜色。**

```
 <script>
  $(function(){
        $('#world-map').vectorMap({
    map: 'world_mill_en',
    color: '#000000',
        backgroundColor: '#ffffff',
        series: {
       regions: [{
            values: {
                IN:'#33250B',
                US:'#003366'
        }
       }]
         }
     })
  });
 </script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T10:47:38.413

我不确定您的意思是什么，但是要设置您可以使用的所有国家/地区颜色：

```
var regionStyling = {initial: {fill: '#128da7'},hover: {fill: "#A0D1DC"}};

jQuery('#world-map').vectorMap({
    map: 'world_mill_en',
    normalizeFunction: 'polynomial',
    regionStyle:regionStyling,
    backgroundColor: '#383f47',
    series: {regions: [{values: {},attribute: 'fill'}]}
}); 
```

这对我有用，如果你想指定每个国家，你可以使用：

```
 jQuery('#world-map').vectorMap({
    map: 'world_mill_en',
    normalizeFunction: 'polynomial',
    backgroundColor: '#383f47',
    series: {regions: [{values: {"US" : "#000"},attribute: 'fill'}]}
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T15:35:10.573

在 jVectorMap 的 1.xx 分支中，可以通过使用`regionStyle`配置参数来实现所需的功能。[在此处](http://jvectormap.com/documentation/javascript-api-v1/jvm-worldmap/)的文档中查看更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-22T18:20:09.583

要为所有区域设置默认颜色，请设置`regionStyle.default.fill`.

这是您进行更改的代码：

```
<script>
    $(function(){
        $('#world-map').vectorMap({
            map: 'world_mill_en',
            regionStyle: { initial: { fill: '#000000' } },  //Changed this line
            backgroundColor: '#ffffff',
            series: {
                regions: [{
                    values: {
                        IN:'#33250B',
                        US:'#003366'
                    }
                }]
            }
        })
    });
</script> 
```

# listview - 你能有多种过滤Jquery Mobile Listview的方法吗

> ID：14965196
> 
> 赞同：1
> 
> 时间：2013-02-19T18:54:24.860
> 
> 标签：listview, jquery-mobile, filtering

我有一个 JQM 列表视图，其中填充了类似于您在地址簿中看到的用户数据。我希望我的用户能够以多种方式过滤列表。

我的意思是，我想要一个带有可过滤列表视图的常规搜索字段，还有一个下拉菜单，可以让我通过某种数据类型快速过滤列表。

例如，我只想显示具有电子邮件地址的人或具有个人资料图片的人，然后使用搜索字段进一步缩小过滤列表的范围。

澄清一下，我不希望下拉列表中选择的项目出现在搜索字段中。它们应该是适用于同一个列表视图的两个单独的操作。

这样的事情可能吗？

任何帮助将非常感激。

谢谢！

# svn - 撤消 SVN 结帐

> ID：14965201
> 
> 赞同：3
> 
> 时间：2013-02-19T18:54:37.197
> 
> 标签：svn, svn-checkout

这里有多个“撤消 svn 结帐”问题，但我没有找到答案如何从字面上撤消 svn 结帐。除了手动删除还有什么办法吗？（比手动浏览几百个文件更安全的方法。）

我正在通过命令行检查一个目录，而不是输入

`svn checkout svn://server/project/ .`

我打错字了 `svn checkout svn://server/project/ /`

如果您错过了我所说的内容，而不是将项目签出到当前文件夹，而是将其签出到服务器的根目录，现在大约有一百个文件与根目录混合。

有人决定在键盘上将`.`和并排放置...`/`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-10-20T19:32:47.140

不会

```
svn up --set-depth empty / 
```

做这个把戏？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T18:55:56.667

如果您问是否有 SVN 命令为您完成工作，答案是否定的。您需要手动删除这些文件。

# jquery - 在 Wicket 中使用 JQuery 加载图像

> ID：14965209
> 
> 赞同：0
> 
> 时间：2013-02-19T18:54:48.947
> 
> 标签：jquery, wicket

我正在尝试使用与[此类](http://jqueryfordesigners.com/demo/image-load-demo.php)似的效果在检票口中加载图像。这就是我目前正在做的事情：

在我的图像组件（一个包含图像的简单面板）中：

```
@Override
public void renderHead(IHeaderResponse response) {
    super.renderHead(response);
    response.renderJavaScriptReference(GlobalNames.JQUERY_URL);
    response.renderJavaScript("$(document).ready(function(){$(\"img.elementImage\").hide().fadeIn(600);});", null);
} 
```

和html：

```
<?xml version="1.0" encoding="UTF-8"?>
<html
    xmlns:wicket="http://wicket.apache.org/dtds.data/wicket-xhtml1.4-strict.dtd">
<body>
<wicket:panel>
    <img class="elementImage" wicket:id="img"/>
</wicket:panel>
</body>
</html> 
```

我认为应该这样做，但我不断收到错误*$("img.elementImage") is null*。我还尝试使用标记 id 而不是 javascript 中的类，并使用其他方法添加 javascript，例如 renderOnDomReadyJavaScript，但我总是得到相同的错误。这是我第一次将 JQuery 与 Wicket 一起使用，所以它可能是我想念的非常简单的东西，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T17:33:53.417

我发现了错误，解决了。原来 JQuery 与之前添加的其他脚本发生冲突，因此“$”在选择器中不起作用。我改用了 jQuery(img.elementImage) 并且效果很好。感谢您的回复！

# ruby-on-rails-3 - Kaminari 参数数量错误（0 代表 1）

> ID：14965210
> 
> 赞同：0
> 
> 时间：2013-02-19T18:54:50.130
> 
> 标签：ruby-on-rails-3, kaminari, argument-error

我在我的应用程序中使用 kaminari 和 bootstrap_kaminari gems。以前他们工作得很好，但是现在，我不知道这是不是我所做的更新，每次`paginate`调用该方法时都会出现此错误：

```
ActionView::Template::Error (wrong number of arguments(0 for 1)):
7: -#    per_page:      number of items to fetch per page
8: -#    remote:        data-remote
9: %li{:class => "page#{' active' if page.current?}"}
10:   = link_to page, page.current? ? "#" : url, {:remote => remote, :method => method, :rel => page.next? ? 'next' : page.prev? ? 'prev' : nil}
app/views/kaminari/bootstrap/_page.html.haml:10:in `method'
app/views/kaminari/bootstrap/_page.html.haml:10:in `_app_views_kaminari_bootstrap__page_html_haml___4572733049493505448_70240978127920'
app/views/kaminari/bootstrap/_paginator.html.haml:14:in `block (2 levels) in _app_views_kaminari_bootstrap__paginator_html_haml__2289167586420570675_70240961152960'
app/views/kaminari/bootstrap/_paginator.html.haml:12:in `block in _app_views_kaminari_bootstrap__paginator_html_haml__2289167586420570675_70240961152960'
app/views/kaminari/bootstrap/_paginator.html.haml:8:in `_app_views_kaminari_bootstrap__paginator_html_haml__2289167586420570675_70240961152960'
app/views/network/_job_offer_results.html.erb:74:in `_app_views_network__job_offer_results_html_erb___3561074850404149034_70240933051920'
app/views/network/job_offer_home.html.erb:60:in `_app_views_network_job_offer_home_html_erb___1400061891974561937_70240932539240' 
```

我不知道哪种方法应该采用 1 个参数但采用 0\. `page.current?`，`page.next?`或者`page.prev?`

谢谢你的帮助

# html - 对齐作为 inline-block 的 div

> ID：14965213
> 
> 赞同：3
> 
> 时间：2013-02-19T18:55:07.197
> 
> 标签：html, css

任何人都可以在这里解释 div 的行为[http://jsfiddle.net/Z7z5Q/](http://jsfiddle.net/Z7z5Q/)吗？我想知道，为什么它们没有对齐在一条线上？为什么向 div 添加文本会移动其他 div？

这是html和css：

```
<!DOCTYPE html>
<html>
    <head>
        <link type="text/css" rel="stylesheet" href="stylesheet.css"/>
        <title>My Social Network</title>
    </head>
    <body>
        <!--Add your HTML below!-->
        <div class="friend">Some text in more than two line, actually in 3</div>
        <div class="family">Some text in two line</div>
        <div class="friend" id="best_friend"></div>
        <div class="enemy" id="archnemesis"></div>
        <div class="friend">Some text</div>
        <div class="family"></div>
        <div class="friend"></div>
        <div class="family"></div>

    </body>
</html> 
```

CSS：

```
div {
    display: inline-block;
    margin-left: 5px;
    height:100px;
    width:100px;
    border-radius: 100%;
    border: 2px solid black;
}

.friend {
   border: 2px dashed #008000;  
}

.family {
    border: 2px dashed #0000FF;
}

.enemy {
    border: 2px dashed #FF0000;
}

#best_friend {
    border:4px solid #00C957;
}
#archnemesis {
    border: 4px solid #CC0000;
} 
```

谢谢。将欣赏到文档或文章的链接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T19:24:30.943

元素是对齐的......但显然不是你想要的方式;）

你的问题的关键是属性**`vertical-align`**。
首先删除`border-radius`以便更好地查看框。
然后添加`vertical-align: middle;`：问题已解决（[见小提​​琴](http://jsfiddle.net/Z7z5Q/3/)）

内容与否，每个框现在都相对于其固定高度对齐（您将其固定为 100 像素）。

首先没有发生`vertical-align: middle;`什么？更改`baseline`: 你回到原来的问题。这是默认值，`span`例如在 s 中显示文本或标签和文本字段的文本时需要的默认值，无论两者的填充和边距如何。但是由于文本被迫占据 2 或 3 行（无论其内容如何，​​框都是 100 像素宽），基线与您所期望的非常不同，它是内容的基线，也就是文本的最后一行。
与 empty 相同`div`：由于它们缺少要对齐的内容，因此它们的基线是它们的底部（对此不太确定，但这似乎正在发生）。
在一些空白处添加单个字符或不可破坏的空格`div`：他们的基线现在与空 div 完全不同。查看[其他小提琴](http://jsfiddle.net/Z7z5Q/4/)

同样的现象也发生在一段文字中丢失了一个高大的图像；您可以将其对齐，`vertical-align`但不同之处在于更容易看到正在发生的事情。在这里，您没有出现一次“正常”文本，因此发现它有点困难。

为什么浮动：左；在这里工作吗？它将获取每个高度相同的框，并将其相对于框对齐，而不是与其内容对齐。但是你必须管理清除，并且在一个盒子上多 1px 可能会破坏以下所有盒子的对齐方式......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T19:19:56.907

`inline-block`是具有许多好奇心的属性。在此示例中，您可以清楚地看到，`height: 100px`从`div`CSS 规则中删除将导致元素的文本对齐，这对于华丽的圆形虚线多色边框并不那么明显。因此，要解决此问题，您将申请`vertical-align: top`. （[来源](http://designshack.net/articles/css/whats-the-deal-with-display-inline-block/)）

> 'inline-block' 的基线是其在正常流中的最后一个行框的基线，除非它没有流入行框，或者它的 'overflow' 属性具有除 'visible' 之外的计算值，在在这种情况下，基线是底部边距边缘。

[（来自另一个线程的一个很好的答案）](https://stackoverflow.com/a/9289377/395059)

相比之下，浮动默认在顶部对齐。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T19:10:27.273

对齐一行

```
div {vertical-align: middle;} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T19:40:21.380

添加一个`float:left;`将解决此问题，请参见此处：http: [//jsfiddle.net/Z7z5Q/5/](http://jsfiddle.net/Z7z5Q/5/)

添加`vertical-align:top;`也将解决它：http: [//jsfiddle.net/Z7z5Q/7/](http://jsfiddle.net/Z7z5Q/7/)

这是因为 inline-block 对 html 中的空格表现得很奇怪。

# java - 在 JUnit 测试中找不到数据源

> ID：14965214
> 
> 赞同：0
> 
> 时间：2013-02-19T18:55:11.247
> 
> 标签：java, junit

我有这个简单的 CDI bean，它将内容显示到 JSF 页面中：

```
@Named("ZonesController")
@ViewScoped
public class Zones implements Serializable
{

    @Resource(name = "jdbc/Oracle")
    private DataSource ds;
    ...........
    public int countDBRowNum() throws Exception
    {

        String SqlStatement = null;

        if (ds == null)
        {
            throw new SQLException();
        }

        Connection conn = ds.getConnection();
        if (conn == null)
        {
            throw new SQLException();
        }

        PreparedStatement ps = null;
        ResultSet resultSet = null;
        int count = 0;

        try
        {
            conn.setAutoCommit(false);
            boolean committed = false;
            try
            {
                SqlStatement = "SELECT COUNT(1) FROM component x, componentstats y WHERE x.componentstatsid = y.componentstatsid AND y.componenttypeid = 1100";

                ps = conn.prepareStatement(SqlStatement);
                resultSet = ps.executeQuery();

                if (resultSet.next())
                {
                    count = resultSet.getInt(1);
                }

                conn.commit();
                committed = true;
            }
            finally
            {
                if (!committed)
                {
                    conn.rollback();
                }
            }
        }
        finally
        {
            ps.close();
            conn.close();
        }
        // Returns total rows in table.
        return count;
        }
        .............
    } 
```

我创建了这个调用 Java 方法的 JUnit 测试用例：

```
public class ZonesTest
{

    @BeforeClass
    public static void setUpClass() throws Exception
    {
        try
        {
            // Create initial context
            System.setProperty(Context.INITIAL_CONTEXT_FACTORY,
                    "org.apache.naming.java.javaURLContextFactory");
            System.setProperty(Context.URL_PKG_PREFIXES,
                    "org.apache.naming");
            InitialContext ic = new InitialContext();

            ic.createSubcontext("java:");
            ic.createSubcontext("java:/comp");
            ic.createSubcontext("java:/comp/env");
            ic.createSubcontext("java:/comp/env/jdbc");

            // Construct DataSource
            OracleConnectionPoolDataSource ds = new OracleConnectionPoolDataSource();
            ds.setURL("jdbc:oracle:thin:@192.168.1.104:1521:oracle");
            ds.setUser("admin");
            ds.setPassword("qwerty");

            ic.bind("java:/comp/env/jdbc/oracle", ds);
        }
        catch (NamingException ex)
        {
            //Logger.getLogger(MyDAOTest.class.getName()).log(Level.SEVERE, null, ex);
        }

    }

    @Test
    public void testCountDBRowNum() throws Exception
    {

        Zones instance = new Zones();
        int rows = instance.countDBRowNum();

        System.out.println(rows);

    }
} 
```

我在这些行收到错误：

```
if (ds == null)
{
    throw new SQLException();
} 
```

我该如何解决这个问题？我想在测试期间使用来自 JUnit 测试的数据源。我可以以某种方式使用 JUnit 数据源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:23:15.483

您可以创建`DataSource ds`一个 JavaBean 属性并在您的 JUnit 测试中设置它的值。通过这种方式，您可以隐藏 JNDI 绑定的复杂性，并将您的测试仅集中在业务逻辑上。

你的控制器：

```
@Named("ZonesController")
@ViewScoped
public class Zones implements Serializable
{

    @Resource(name = "jdbc/Oracle")
    private DataSource ds;

    public void setDs(DataSource ds){this.ds=ds;}
    public DataSource getDs(){return ds;}

    ...
} 
```

你测试类：

```
public class ZonesTest
{
    private static OracleConnectionPoolDataSource ds;

    @BeforeClass
    public static void setUpClass() throws Exception
    {
        try
        {
            // Construct DataSource
            ds = new OracleConnectionPoolDataSource();
            ds.setURL("jdbc:oracle:thin:@192.168.1.104:1521:oracle");
            ds.setUser("admin");
            ds.setPassword("qwerty");
        }
        catch (NamingException ex)
        {
            //Logger.getLogger(MyDAOTest.class.getName()).log(Level.SEVERE, null, ex);
        }

    }

    @Test
    public void testCountDBRowNum() throws Exception
    {

        Zones instance = new Zones();
        instance.setDs(ds);
        int rows = instance.countDBRowNum();

        System.out.println(rows);

    }
} 
```

附带说明一下，按照[MVC 设计模式](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)，我什至会将控制器业务逻辑与数据库连接分离，因此执行单元测试不需要有效的连接，您的重点完全是控制器的行为。

如果您正在使用 Spring 并希望在您的 JUnit 类中使用所有 Spring bean，您始终可以使用`@RunWith`JUnit 注释。

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration
public class ZonesTest
{
    @Autowire
    Zones zones;

    // your BeforeClass method here

    @Test
    public void testCountDBRowNum() throws Exception
    {
        int rows = zones.countDBRowNum();

        System.out.println(rows);

    } 
```

}

# c - 在 unix 系统上确定符号链接

> ID：14965217
> 
> 赞同：1
> 
> 时间：2013-02-19T18:55:29.960
> 
> 标签：c

我正在尝试使用函数 S_ISLNK(file.st_mode) 来检查某个文件是符号链接还是目录或常规文件。但是，当我使用符号链接文件检查它时，它似乎不起作用。

这是我的代码：

```
 if(S_ISDIR(fileStat.st_mode))
            {
                // DIR - display files in the directory
                printf("    DIR         ");
                fileType = 2;

            }else if(S_ISLNK(fileStat.st_mode)){
                // LNK - display the name of the file the link is pointing to
                printf("    LNK         ");
                fileType = 3;
            }else{
                // Display general info only
                printf("    REG         ");
                fileType = 1;
            } 
```

目录检查工作正常，但是当我在符号链接文件上运行程序时，它显示为常规文件。任何人都知道我可能做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T18:56:51.023

`stat`统计链接的目标。如果`lstat`要判断文件是否为符号链接，请使用：

> `lstat()`与 相同`stat()`，除了如果 path 是符号链接，则链接本身是 stat-ed，而不是它所引用的文件。

# .htaccess - htaccess 301 重定向错误

> ID：14965227
> 
> 赞同：0
> 
> 时间：2013-02-19T18:55:56.410
> 
> 标签：.htaccess

我已经设置了重定向

重定向匹配 301 /data(.*) [http://www.site.com/sites/default/files/datassheets](http://www.site.com/sites/default/files/datassheets) $1

我收到以下错误 [http://www.site.com/sites/default/files/datasheetssheetssheetssheetssheetssheetssheetssheetssheetssheetssheetssheetssheetssheetssheets/doc3542.pdf](http://www.site.com/sites/default/files/datasheetssheetssheetssheetssheetssheetssheetssheetssheetssheetssheetssheetssheetssheetssheetssheets/doc3542.pdf) 当我将数据表目录重命名为它可以工作的其他东西时，但这不是一个选项

这是 apache 错误还是我做错了什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:21:19.590

您的 RedirectMatch 正则表达式`/data(.*)`在每个请求上都匹配，因此将无限期地继续。

完整的重定向规则是什么样的取决于您的用例。以下规则处理了无限循环问题，并将*/data/之后的内容重定向到**[http://www.site.com/sites/default/files/datasheets/](http://www.site.com/sites/default/files/datasheets/)*的新结构。

```
RedirectMatch 301 ^/data/(.+) http://www.site.com/sites/default/files/datassheets/$1 
```

> /data/ **my-cool-file** => [http://www.site.com/sites/default/files/datassheets/](http://www.site.com/sites/default/files/datassheets/) **my-cool-file**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:09:24.887

`(.*)`您之后的部分与您的网址`/data`匹配`sheets`。然后，您将获取该匹配并将其附加到重定向上。这就是给你重复词的原因。我猜你也在重定向到你自己的网站，这就是为什么它会重复很多次。

您希望在要附加到重定向的数据之后出现什么？如果是查询字符串，可以`[QSA]`在末尾添加一个标志来维护查询字符串。

例子：

```
RedirectMatch 301 /data/(.*) http://www.site.com/sites/default/files/datassheets/$1 [QSA] 
```

此外，考虑到您告诉所有人以任何目录开头的任何页面`data`都不应该存在，但您正在将它们重定向到与您应该摆脱的相同模式匹配的页面。您可能需要扩展正则表达式以仅匹配您想要的。

# c++ - C++/SDL 从 lua 加载字符串数组

> ID：14965230
> 
> 赞同：0
> 
> 时间：2013-02-19T18:56:07.167
> 
> 标签：c++, lua, transfer

我正在使用 lua 在 C++/SDL 中加载我的地​​图，并且我在 lua 中有一个数组来确定平铺图像的位置，但我不知道如何将它传输到 C++ 中的数组我已经寻找解释但它们都处理整数，而 lua 文件只有 1 个数组，由于某种原因代码不起作用，这可能是一个愚蠢的问题，但是是的

这是代码：

地图.lua

```
Tile = {}

--opens file and reads it
local file = io.open("../Maps/Map.txt")
    local n = 0
    while(n <= 494) do
        Tile[n] = file:read(1)
        n = n+1
    end
file:close()
--end of reading file

n = 0
local x = 0

-- creates a new array for the tiles
whatsTile = {}
isSolid = {}

--sets the tiles to their specific image
while(n <= 494) do
    if(Tile[n] ~= "\n" and Tile[n] ~= "\r") then
        if(Tile[n] == '0') then
            --This is the array in lua that holds the file location
            whatsTile[x] = "../GameResources/Pictures/Tile1.bmp"
            --sets this tile to non solid
            isSolid[x] = 0
        end
        --You can add new tiles just set their number and, add a directory for the Bitmap image.
        --Make sure you set the directory based on where the executable file is, not this script.
        x = x+1
    end
    n = n+1
end 
```

主文件

```
#include <SDL/SDL.h>
#include <string>
#include <iostream>
#include <lua.hpp>
#include <fstream>

using namespace std;

extern "C"{
    #include <lua.h>
    #include <lualib.h>
    #include <lauxlib.h>
    #include <luaconf.h>
}

void loadMapLua();
//This is the array i want to transfer the values into
string whatsTile[475];

int main(int argc, char** argv){

    ofstream myfile;

    SDL_Init(SDL_INIT_EVERYTHING);

    SDL_Event event;

    loadMapLua();

    SDL_Surface* Screen = SDL_SetVideoMode(800, 608, 32, SDL_SWSURFACE);
    SDL_Surface* BackGround = SDL_LoadBMP("../GameResources/Pictures/BackGround.bmp");
    SDL_Surface* Tiles[475];

    const char* c;

    SDL_Rect Tile[475];

    int n = 0;

    while(n < 475){
        c = whatsTile[n].c_str();
        Tiles[n] = SDL_LoadBMP(c);
        Tile[n].w = 32;
        Tile[n].h = 32;
        Tile[n].x = n*32;
        Tile[n].y = (n/25)*32;
        n ++;
    }

    n = 0;

    myfile.open("trolls.txt");
    myfile << whatsTile[0] << endl;
    myfile.close();
    bool gameRunning = true;

    while(gameRunning){
        while(SDL_PollEvent(&event)){
            if(event.type == SDL_QUIT){
                gameRunning = false;
            }
        }

        SDL_FillRect(Screen, 0, SDL_MapRGB(Screen->format, 255, 255, 255));
        SDL_BlitSurface(BackGround, NULL, Screen, NULL);

        while(n < 475){
            SDL_BlitSurface(Tiles[n], NULL, Screen, &Tile[n]);
            n ++;
        }
        SDL_Flip(Screen);
    }

    SDL_Quit();
    return 0;
}

void loadMapLua(){
    lua_State* Map = lua_open();
    luaL_openlibs(Map);
    luaL_dofile(Map, "../GameResources/LuaScripts/Map.lua");
    lua_pushnil(Map);
    lua_close(Map);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:36:25.680

你不能一次得到整个数组。
使用循环来获取所有字符串。

```
string whatsTile[475];
int len_whatsTile = 0;

void loadMapLua(){
   lua_State* L = lua_open();
   luaL_openlibs(L);
   luaL_dofile(L, "../GameResources/LuaScripts/Map.lua");
   lua_getglobal(L, "whatsTile");
   int Index = 0;
   do {
      lua_pushinteger(L, Index++);
      lua_gettable(L, -2);
      if (lua_isnil(L, -1))
         Index = 0;
      else
         whatsTile[len_whatsTile++].assign(lua_tostring(L, -1));
      lua_pop(L, 1);
   } while (Index > 0);
   lua_close(L);
} 
```

# javascript - Ember.js 通用计算属性模式的简写

> ID：14965235
> 
> 赞同：7
> 
> 时间：2013-02-19T18:56:23.190
> 
> 标签：javascript, ember.js

在 Ember.js 中，我发现自己定义了如下所示的计算属性：

```
someProp: function(){
  return this.get('otherProp');
}.property('otherProp') 
```

或者

```
someProp: function(){
  return this.get('otherObject.prop');
}.property('otherObject.prop') 
```

是否有更短的方法来编写遵循这些模式的计算属性？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-19T19:42:15.920

**在进行了一些研究之后，您可以在Ember.computed.alias**的帮助下执行以下操作，从而使这一点变干：

```
someProp: Ember.computed.alias("otherObject.prop") 
```

您也可以使用`alias`来设置此属性。给定一个实现上述属性的 Ember 对象，您可以执行以下操作：

```
obj.set("someProp", "foo or whatever"); // The set will be propagated to otherObject.prop 
```

[链接到 Ember.computed.alias 的 Ember 源](https://github.com/emberjs/ember.js/blob/v1.0.0-rc.6.1/packages/ember-metal/lib/computed.js#L665)

* * *

**更新：Ember.computed.oneWay**

最近在 Ember 中添加了一个新的计算属性简写 ( `oneWay`)，这对于这个需求也是可行的。不同之处在于`oneWay`速记**仅在 get 情况下有效**。因此，在对象创建过程中，这种速记比更复杂的 速记更快`alias`。

```
someProp: Ember.computed.oneWay("otherObject.prop") 
```

[链接到 Ember.computed.oneWay 的 Ember 源](https://github.com/emberjs/ember.js/blob/v1.0.0-rc.6.1/packages/ember-metal/lib/computed.js#L684)

# c# - 检查对象是否使用泛型实现接口 其中泛型类型是 T 的子类型

> ID：14965236
> 
> 赞同：0
> 
> 时间：2013-02-19T18:56:23.733
> 
> 标签：c#, generics, inheritance

我正在尝试检查给定对象是否实现了我制作的采用通用参数的接口。

```
public interface ICaseCopier<T> where T : ModelElement 
{
    T Case1 { get; set; }
    T Case2 { get; set; }

    void CopyCase(T caseToCopy, T copiedCase);
} 
```

我的一个对象实现了这样的接口：

```
public class ProcessLoad : ElectricalLoad, ICaseCopier<ProcessCase> 
```

其中 ProcessCase 是 ModelElement 的子级。我有许多对象在泛型中使用具有不同参数的接口，因此无法一一检查它们。

我尝试的是这样的：

```
ICaseCopier<ModelElement> copier = this as ICaseCopier<ProcessCase>; 
```

但我收到以下错误：

```
Cannot convert source type 'ICaseCopier<ProcessCase>' to target type 'ICaseCopier<ModelElement>' 
```

ProcessCase 可转换为 ModelElement。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T19:03:11.567

您不能这样做，因为转换不安全 - 如果是，您可以执行以下操作：

```
public class OtherElement : ModelElement { }

ICaseCopier<ModelElement> copier = this as ICaseCopier<ProcessCase>;
copier.Case1 = new OtherElement(); 
```

你可以做到这一点的唯一方法是使`ICaseCopier<T>`接口协变，你不能以当前的形式做到这一点，因为它`T`同时出现在输入和输出位置。

# c# - 为什么这个断言在比较结构时会抛出格式异常？

> ID：14965238
> 
> 赞同：94
> 
> 时间：2013-02-19T18:56:33.143
> 
> 标签：c#, unit-testing, exception-handling, mstest, string-formatting

我试图断言两个`System.Drawing.Size`结构的相等性，并且我得到一个格式异常而不是预期的断言失败。

```
[TestMethod]
public void AssertStructs()
{
    var struct1 = new Size(0, 0);
    var struct2 = new Size(1, 1);

    //This throws a format exception, "System.FormatException: Input string was not in a correct format."
    Assert.AreEqual(struct1, struct2, "Failed. Expected {0}, actually it is {1}", struct1, struct2); 

    //This assert fails properly, "Failed. Expected {Width=0, Height=0}, actually it is {Width=1, Height=1}".
    Assert.AreEqual(struct1, struct2, "Failed. Expected " + struct1 + ", actually it is " + struct2); 
} 
```

这是预期的行为吗？我在这里做错了吗？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-02-19T20:42:44.337

我懂了。是的，这是一个错误。

问题是这里有两个层次`string.Format`。

第一级格式化是这样的*：*

```
string template  = string.Format("Expected: {0}; Actual: {1}; Message: {2}",
                                 expected, actual, message); 
```

然后我们使用`string.Format`您提供的参数：

```
string finalMessage = string.Format(template, parameters); 
```

（显然提供了文化，并进行*了*某种消毒……但还不够。）

这看起来很好 - 除非预期值和实际值本身在转换为字符串后以大括号结尾 - 他们为`Size`. 例如，您的第一个尺寸最终被转换为：

```
{Width=0, Height=0} 
```

所以第二级格式化是这样的：

```
string.Format("Expected: {Width=0, Height=0}; Actual: {Width=1, Height=1 }; " +
              "Message = Failed expected {0} actually is {1}", struct1, struct2); 
```

......这就是失败的原因。哎哟。

事实上，我们可以很容易地证明这一点，方法是欺骗格式以将我们的参数用于预期和实际部分：

```
var x = "{0}";
var y = "{1}";
Assert.AreEqual<object>(x, y, "What a surprise!", "foo", "bar"); 
```

结果是：

```
Assert.AreEqual failed. Expected:<foo>. Actual:<bar>. What a surprise! 
```

显然坏了，因为我们没有预料`foo`到，实际价值也没有`bar`！

基本上，这类似于 SQL 注入攻击，但在`string.Format`.

作为一种解决方法，您可以`string.Format`按照 StriplingWarrior 的建议使用。这避免了对使用实际/预期值格式化的结果执行第二级格式化。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2013-02-19T19:34:12.300

我想你发现了一个错误。

这有效（引发断言异常）：

```
var a = 1;
var b = 2;
Assert.AreEqual(a, b, "Not equal {0} {1}", a, b); 
```

这有效（输出消息）：

```
var a = new{c=1};
var b = new{c=2};
Console.WriteLine(string.Format("Not equal {0} {1}", a, b)); 
```

但这不起作用（抛出 a `FormatException`）：

```
var a = new{c=1};
var b = new{c=2};
Assert.AreEqual(a, b, "Not equal {0} {1}", a, b); 
```

我想不出任何理由这是预期的行为。我会提交一个错误报告。与此同时，这里有一个解决方法：

```
var a = new{c=1};
var b = new{c=2};
Assert.AreEqual(a, b, string.Format("Not equal {0} {1}", a, b)); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-19T20:26:53.950

我同意@StriplingWarrior 的观点，这确实似乎是 Assert.AreEqual() 方法在至少 2 个重载上的错误。正如 StiplingWarrior 已经指出的那样，以下失败；

```
var a = new { c = 1 };
var b = new { c = 2 };
Assert.AreEqual(a, b, "Not equal {0} {1}", a, b); 
```

我一直在做一些进一步的试验，以便在代码使用方面更加明确。以下也不起作用；

```
// specify variable data type rather than "var"...no effect, still fails
Size a = new Size(0, 0);
Size b = new Size(1, 1);
Assert.AreEqual(a, b, "Not equal {0} {1}", a, b); 
```

和

```
// specify variable data type and name the type on the generic overload of AreEqual()...no effect, still fails
Size a = new Size(0, 0);
Size b = new Size(1, 1);
Assert.AreEqual<Size>(a, b, "Not equal {0} {1}", a, b); 
```

这让我开始思考。System.Drawing.Size 是一个结构。对象呢？参数列表*确实*`string`指定消息之后的列表是`params object[]`. 从技术上讲，是的结构*是*对象......但是特殊*类型*的对象，即值类型。我认为这就是错误所在。如果我们使用我们自己的对象，其用法和结构与 类似`Size`，则以下内容**确实**有效；

```
private class MyClass
{
    public MyClass(int width, int height)
        : base()
    { Width = width; Height = height; }

    public int Width { get; set; }
    public int Height { get; set; }
}

[TestMethod]
public void TestMethod1()
{
    var test1 = new MyClass(0, 0);
    var test2 = new MyClass(1, 1);
    Assert.AreEqual(test1, test2, "Show me A [{0}] and B [{1}]", test1, test2);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-19T19:20:26.583

我认为第一个断言是不正确的。

改用这个：

```
Assert.AreEqual(struct1, 
                struct2, 
                string.Format("Failed expected {0} actually is {1}", struct1, struct2)); 
```

# python - 如何使用 django 测试客户端设置 _dont_enforce_csrf_checks

> ID：14965239
> 
> 赞同：2
> 
> 时间：2013-02-19T18:56:36.920
> 
> 标签：python, django, csrf

我正在尝试使用 django 测试客户端在更高级别的集成测试期间强制执行 csrf 检查，但我不确定如何手动翻转此位（在调用客户端之前）

这是我目前失败的情况（我得到的是 201 而不是下面的 403）

```
def test_should_get_403_when_csrf_enforced(self):
    self.client.enforce_csrf_checks=False
    response = self.client.post(url, {'name': 'foobar'})
    self.assertEqual(403, response.status_code) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:08:30.823

我最终得到了这个解决方案，首先你必须设置 csrf 令牌，然后你需要在手动新建客户端时翻转 enforce_csrf_check

```
def test_should_get_403_when_csrf_enforced(self):
    self.client = test.Client(enforce_csrf_checks=True)
    self.client.cookies[settings.CSRF_COOKIE_NAME] = 'asdf'                                                  
    response = self.client.post(url, {'name': 'foobar'})
    self.assertEqual(403, response.status_code) 
```

# android - Android服务结果广播没有被广播

> ID：14965240
> 
> 赞同：0
> 
> 时间：2013-02-19T18:56:40.967
> 
> 标签：android, service, broadcastreceiver

我有一个主要活动和一个从 LogCat 收集日志
的服务 该服务运行良好，直到它必须将结果广播回主要活动广播
结果**但从未收到过** 状态广播，就在之后它被广播**和接收良好**。 运行的 LogCat 日志显示日志已被收集和广播。`broadcast(logBuffer)` **`broadcast(Status.FINISHED)`**

 *****注意：我尝试使用 sendOrderedBroadcast() 但问题仍然存在。*

服务相关代码：

```
private void broadcast(Status status) {
    Log.d(TAG, "+ broadcast(status: " + status + ")");
    Intent broadcastIntent = new Intent(MainActivity.StatusReceiver.ACTION_STATUS);
    broadcastIntent.putExtra("STATUS", status);
    sendBroadcast(broadcastIntent);
    Log.d(TAG, "- broadcast()");
}

private void broadcast(ArrayList<String> logs) {
    Log.d(TAG, "+ broadcast(logs: " + logs + ")");
    Intent broadcastIntent = new Intent(MainActivity.StatusReceiver.ACTION_RESULT);
    broadcastIntent.putExtra("LOGS", logs);
    sendBroadcast(broadcastIntent);
    Log.d(TAG, "- broadcast()");
}

@Override
protected void onHandleIntent(Intent workIntent) {

    .... some background collection work

    broadcast(logBuffer);
    broadcast(Status.FINISHED);
    Log.d(TAG, "- onHandleIntent()");
} 
```

主要活动相关代码：

```
public class StatusReceiver extends BroadcastReceiver {

    public static final String ACTION_STATUS = "com.devilstate.auxapp.action.STATUS_CHANGED";
    public static final String ACTION_RESULT = "com.devilstate.auxapp.action.RESULTS_READY";

    @Override
    public void onReceive(Context context, Intent intent) {
        Log.d(TAG, "+ onReceive(context:" + context + ", intent:" + intent + ")");
        String action = intent.getAction();
        Log.w(TAG, action);
        if( action.equals(ACTION_STATUS) ) {

            Status status = (Status) intent.getSerializableExtra("STATUS");
            switch( status ) {
            case COLLECTING:
                if( mState == State.INIT || mState == State.WAIT_FOR_RUNNING ) {
                    setViewState(State.RUNNING);
                }
                break;
            case FINISHED:
                if( mState == State.RUNNING || mState == State.WAIT_FOR_DONE ) {
                    setViewState(State.DONE);
                }
                break;
            }

        } else if( action.equals(ACTION_RESULT) ) {

            logBuffer.clear();
            logBuffer = (ArrayList<String>) intent.getSerializableExtra("LOGS");
        }
        Log.d(TAG, "- onReceive()");
    }

} 
```

LogCat 相关消息：

```
02-19 20:30:13.338: D/LogCollectorService(3880): + broadcast(logs: [02-19 20:17:37.229 I/ActivityManager(10160): Displayed com.devilstate.auxapp/.MainActivity: +8s703ms, 02-19 20:17:37.300 W/NetworkManagementSocketTagger(10160): setKernelCountSet(10013, 0) failed with errno -2, 02-19 20:17:44.928 D/MainActivity( 2372): + onStartStopButtonClick(v:android.widget.Button@41035cf8), 02-19 20:17:44.963 D/MainActivity( 2372): - onStartStopButtonClick(), 02-19 20:17:44.980 D/LogCollectorService( 2372): + onHandleIntent(workIntent: Intent { cmp=com.devilstate.auxapp/.LogCollectorService }), 02-19 20:17:44.980 D/LogCollectorService( 2372): + broadcast(status: COLLECTING), 02-19 20:17:45.208 D/MainActivity( 2372): + onReceive(context:com.devilstate.auxapp.MainActivity@41025408, intent:Intent { act=com.devilstate.auxapp.action.STATUS_CHANGED cat=[android.intent.category.DEFAULT] flg=0x10 (has extras) }), 02-19 20:17:45.218 D/LogCollectorService( 2372): - broadcast(), 02-19 20:17:46.128 D/dalvikvm( 2372): threadid=1: still suspended after undo (sc=1 dc=1), 02-19 20:17:46.368 D/dalvikvm( 2372): threadid=1: still suspended after undo (sc=1 dc=1), 02-19 20:17:46.418 D/dalvikvm( 2372): GC_CONCURRENT freed 220K, 5% free 6701K/7047K, paused 8ms+8ms, 02-19 20:17:49.863 W/MainActivity( 2372): com.devilstate.auxapp.action.STATUS_CHANGED, 02-19 20:17:50.030 D/MainActivity( 2372): + setViewState(state:RUNNING), 02-19 20:17:50.038 I/MainActivity( 2372): Current State:WAIT_FOR_RUNNING, 02-19 20:17:50.080 I/MainActivity( 2372): New State:RUNNING, 02-19 20:17:50.080 D/MainActivity( 2372): - setViewState(), 02-19 20:17:50.112 D/MainActivity( 2372): - onReceive(), 02-19 20:17:52.989 I/ActivityManager(10160): START {act=android.intent.action.MAIN cat=[android.intent.category.HOME] flg=0x10200000 cmp=com.android.launcher/com.android.launcher2.Launcher} from pid 10160, 02-19 20:17:53.009 W/WindowManager(10160): Failure taking screenshot for (250x135) to layer 21010, 02-19 20:17:53.039 W/NetworkManagementSocketTagger(10160): setKernelCountSet(10013, 1) failed with errno -2, 02-19 20:17:54.309 D/MainActivity( 2372): + onStop(), 02-19 20:17:54.440 D/MainActivity( 2372): - onStop(), 02-19 20:17:54.509 W/NetworkManagementSocketTagger(10160): setKernelCountSet(10040, 0) failed with errno -2, 02-19 20:17:56.039 I/ActivityManager(10160): START {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=com.devilstate.auxapp/.MainActivity bnds=[400,344][496,440]} from pid 10283, 02-19 20:17:56.039 W/WindowManager(10160): Failure taking screenshot for (250x135) to layer 21010, 02-19 20:17:56.089 W/NetworkManagementSocketTagger(10160): setKernelCountSet(10040, 1) failed with errno -2, 02-19 20:17:56.139 D/MainActivity( 2372): + onStart(), 02-19 20:17:56.139 D/MainActivity( 2372): + updateViewState(), 02-19 20:17:56.179 D/LogCollectorService( 2372): + isRunning(), 02-19 20:17:56.179 D/LogCollectorService( 2372): - isRunning(): true, 02-19 20:17:56.215 D/MainActivity( 2372): + setViewState(state:RUNNING), 02-19 20:17:56.215 I/MainActivity( 2372): Current State:RUNNING, 02-19 20:17:56.339 I/MainActivity( 2372): New State:RUNNING, 02-19 20:17:56.339 D/MainActivity( 2372): - setViewState(), 02-19 20:17:56.349 D/MainActivity( 2372): - updateViewState(), 02-19 20:17:56.389 D/MainActivity( 2372): - onStart(), 02-19 20:17:56.589 I/Process (10160): Sending signal. PID: 2372 SIG: 3, 02-19 20:17:56.589 I/dalvikvm( 2372): threadid=3: reacting to signal 3, 02-19 20:17:56.740 I/dalvikvm( 2372): Wrote stack traces to '/data/anr/traces.txt', 02-19 20:17:57.519 W/NetworkManagementSocketTagger(10160): setKernelCountSet(10013, 0) failed with errno -2, 02-19 20:17:58.869 D/MainActivity( 2372): + onStartStopButtonClick(v:android.widget.Button@41035cf8), 02-19 20:17:58.869 D/LogCollectorService( 2372): + forceStop(): false, 02-19 20:17:58.899 D/LogCollectorService( 2372): - forceStop(): true, 02-19 20:17:58.899 D/MainActivity( 2372): - onStartStopButtonClick(), 02-19 20
02-19 20:30:13.428: D/LogCollectorService(3880): - broadcast()
02-19 20:30:13.428: D/LogCollectorService(3880): + broadcast(status: FINISHED)
02-19 20:30:13.438: D/MainActivity(3880): + onReceive(context:com.devilstate.auxapp.MainActivity@41027a70, intent:Intent { act=com.devilstate.auxapp.action.STATUS_CHANGED cat=[android.intent.category.DEFAULT] flg=0x10 (has extras) })
02-19 20:30:13.438: W/MainActivity(3880): com.devilstate.auxapp.action.STATUS_CHANGED
02-19 20:30:13.450: D/MainActivity(3880): + setViewState(state:DONE)
02-19 20:30:13.450: D/MainActivity(3880): - setViewState()
02-19 20:30:13.450: D/MainActivity(3880): - onReceive()
02-19 20:30:13.478: D/LogCollectorService(3880): - broadcast()
02-19 20:30:13.478: D/LogCollectorService(3880): - onHandleIntent() 
```

如果不清楚，我想知道为什么在 MainActivity 端没有收到结果缓冲区

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T06:30:36.573

发现问题（真的很傻）

我没有将 ACTION_RESULT 添加到广播意图过滤器中。这就是接收方没有响应的原因`broadcast(ACTION_RESULT)`。一旦我添加它一切都很好

```
 // Register the broadcast receiver
    IntentFilter filter = new IntentFilter();
    filter.addAction(StatusReceiver.ACTION_STATUS);
    filter.addAction(StatusReceiver.ACTION_RESULT);
    filter.addCategory(Intent.CATEGORY_DEFAULT);
    receiver = new StatusReceiver();
    registerReceiver(receiver, filter); 
```****

# powershell - 使用 powershell 在不打开网络浏览器的情况下向网站发送信息

> ID：14965241
> 
> 赞同：1
> 
> 时间：2013-02-19T18:56:45.327
> 
> 标签：powershell, powershell-2.0

有没有办法使用powershell，我可以在不打开网络浏览器的情况下将信息发送到网页？

例如，我想执行以下操作，但没有打开网络浏览器。我不关心返回的数据。

```
 http://www.foobar.org/foo.php?CompName=Baz&UID=quux 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:33:06.457

如果您安装了 PowerShell 3。

[http://mcpmag.com/articles/2013/01/22/pshell-invoke-webrequest.aspx](http://mcpmag.com/articles/2013/01/22/pshell-invoke-webrequest.aspx)

```
Invoke-WebRequest  http://www.foobar.org/foo.php?CompName=Baz&UID=quux 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:01:01.817

你考虑过卷曲吗？您可以使用以下命令执行远程 http 命令：

```
curl http://www.foobar.org/foo.php?CompName=Baz&UID=quux 
```

您可以从[http://curl.haxx.se/获取它](http://curl.haxx.se/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T19:33:53.727

我相信这应该可以解决问题（如果我错了，请有人纠正我）：

```
[System.Net.WebRequest]::Create("http://www.foobar.org/foo.php?CompName=Baz&UID‌​=quux").GetResponse().Close() 
```

这将返回有关返回内容的信息，这意味着网站处理了请求。

如果没有，您始终可以使用`WebClient`响应数据并将其置空：

```
$wc = New-Object System.Net.WebClient
$wc.DownloadString("http://www.foobar.org/foo.php?CompName=Baz&UID‌​=quux") | Out-Null 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T19:50:34.110

如果你被允许使用 VBScript，你可以这样做：

```
Set req = CreateObect("MSXML2.XMLHTTP.6.0")
req.open "GET", "http://www.foobar.org/foo.php?CompName=Baz&UID=quux", False
req.send 
```

# .net - 将 PDF 与 PDFSharp 丢失表单域相结合

> ID：14965242
> 
> 赞同：5
> 
> 时间：2013-02-19T18:56:47.293
> 
> 标签：.net, merge, pdfsharp

我正在尝试使用 PDFSharp 和此代码（我在[此处](http://www.pdfsharp.net/wiki/ConcatenateDocuments-sample.ashx)找到）将两个创建的 PDF 文件连接到一个新的 PDF：

```
 // Open the output document
        PdfDocument outputDocument = new PdfDocument();
        // Iterate files
        foreach (string file in files)
        {
            // Open the document to import pages from it.
            PdfDocument inputDocument = PdfReader.Open(file, PdfDocumentOpenMode.Import);

            // Iterate pages
            int count = inputDocument.PageCount;
            for (int idx = 0; idx < count; idx++)
            {
                // Get the page from the external document...
                PdfPage page = inputDocument.Pages[idx];
                // ...and add it to the output document.
                outputDocument.AddPage(page);
            }
        }
        // Save the document...
        string filename = Path.Combine(this.tempFolder, "MyPDF.pdf");
        outputDocument.Save(filename); 
```

第二个 PDF 有我填写的表单域，也使用 PDFSharp。我遇到的问题是，当组合成一个新的 PDF 时，表单字段显示为空白。

创建并保存后，我打开了第二个 PDF，表单字段显示的文本很好。

我是否遗漏了什么，或者 PDFSharp 在这个问题上是否存在某种错误？在我看来，如果我可以很好地打开和查看 PDF，那么组合它们应该没有任何问题。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T09:10:31.310

PDFsharp 不完全支持表单域。我没有对此进行检查，但是在将 PDF 文件与填充的表单字段组合时可能会出现错误。我们继续维护和改进 PDFsharp，但没有计划改进表单域的处理。

如果您尝试不同的方式，也许它会起作用：打开第二个 PDF 进行修改，打开第一个 PDF 进行导入并在第二个文件的开头添加第一个文件的页面（如果两个文件都包含填充，这可能不起作用表单域）。
如果您必须保留原始文件，请在执行此操作之前创建第二个文件的副本。

# postgresql - PostgreSql - 在准备命令中访问修改的行

> ID：14965250
> 
> 赞同：0
> 
> 时间：2013-02-19T18:57:04.680
> 
> 标签：postgresql, transactions

在提交/回滚之前，我无法在准备好的语句中访问修改后的数据（更新和插入）。例如考虑以下块：

```
BEGIN;    
do some update;   
do some insert;    
PREPARE 'transaction1'; 
```

在执行“prepare”命令之后（以及在执行“commit”命令之前），我需要获取事务“transaction1”修改的数据。我可以使用事务修改的旧值获取行（使用 xmax 字段），但是我还需要事务在提交时将写入这些行的值。

Postgres 需要将这些值存储在某处以便在需要时提交事务，所以我的问题是：如何访问这些值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T11:24:07.470

谢谢理查德，你是对的。我无法获取“准备好的”交易的修改。我所做的解决方法是在调用 PREPARE 语句之前获取事务中化的值。

```
 BEGIN;
    execute my_stored_procedure;
    fetch modified rows;
    PREPARE TRANSACTION my_stored_procedure;' 
```

皮尔保罗

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T13:01:33.283

好的 - 我认为你的问题是[PREPARE TRANSACTION](http://www.postgresql.org/docs/current/static/sql-prepare-transaction.html)没有做你认为它做的事情。

您将 PREPARE 作为事务中的最后一件事并将其保存，以便您稍后提交。它通常用于需要同时更新多个数据库的情况。您将在两者上准备交易，然后同时在两者上提交准备（尽可能）。这会减少可能发生问题的窗口，并让一个数据库与另一个数据库脱节。

```
=> BEGIN;
BEGIN
richardh=> SELECT * FROM foo;
 app_id | rule_id
--------+---------
      1 |      10
      1 |      20
      2 |      10
(3 rows)

=> INSERT INTO foo VALUES (3,30);
INSERT 0 1
=> PREPARE TRANSACTION 'abc';
PREPARE TRANSACTION
=> SELECT * FROM foo;
 app_id | rule_id
--------+---------
      1 |      10
      1 |      20
      2 |      10
(3 rows)

=> COMMIT PREPARED 'abc';
COMMIT PREPARED
=> SELECT * FROM foo;
 app_id | rule_id
--------+---------
      1 |      10
      1 |      20
      2 |      10
      3 |      30
(4 rows) 
```

您可能想发布另一个问题来描述您要解决的问题，可能有不同的方法。

# php - 一个类和表应该彼此相同还是应该从查询中派生一个类？

> ID：14965256
> 
> 赞同：0
> 
> 时间：2013-02-19T18:57:15.467
> 
> 标签：php, class, cakephp, database-design

假设我正在制作电话簿。

班级朋友

*   ->名字
*   ->姓氏
*   ->城市
*   ->状态
*   ->邮编
*   - >电话

据我了解，对我来说，最好的做法是在我的数据库中有两个表，尽管对于这样的事情，FirstName、LastName、Phone 在一个单独的表中，地址信息在一个单独的表中，然后使用 ForeignKey 连接它们。这样，如果两个朋友住在同一个地址，我就不会重复任何信息。

那么我应该使用 INNER JOIN 查询来设置课程吗？

我目前还没有确定一个框架，所以如果你也可以告诉我：

在 CakePHP 中，我可以使用 INNER JOIN 来创建一个类还是违反约定？如果不是，我会更好地使用 Laravel、Zend、Yii、Symfony 或 CodeIgniter 等不同的框架吗？

一个人可能有多个地点，例如一个公司有两个不同的办公室，或者一个朋友有一个夏天和冬天的家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:09:47.007

这对我来说是一个值得怀疑的标准化案例。是的，从理论上讲，您可以通过将地址标准化来为自己节省一些冗余条目，但我真的会考虑在做出此决定之前您将如何处理系统中的地址。地址是否始终是用户的属性（一对一关系），或者您是否打算实际进行某种地址管理，其中用户可以拥有多个地址？在前一种情况下，我可能不会标准化，而在后一种情况下，我肯定会。

这实际上归结为地址作为一个支持对象是否在您的系统中具有任何意义，或者地址是否只是用户的一对一属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:07:54.837

如果您计划让一个人一次与多个地址相关联，则只需将地址存储在单独的表中。如果每个人只有一个地址，只需将其放在主表中即可。我记得电话簿只将一个人与一个地址联系起来......

话虽这么说，如果你确实去多个表，你很可能会坚持一个类，并执行连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T20:45:53.337

> 这样，如果两个朋友住在同一个地址，我就不会重复任何信息。

对于“精确”的数据可能很好，但地址[往往是“模糊的”](https://stackoverflow.com/a/12553900/533120)。人们会以不同的方式表达它们，有时拼写错误——如果发生这种情况，你应该使用哪个地址：数据库中已经存在的地址还是新地址？你怎么知道它们实际上是一样的，哪一个拼错了？最好“隔离”地址，这样任何错误或变化对于它们的来源人来说都是“本地的”。

从更哲学的角度来看：如果你这样做，为什么不将街道、邮政编码、城市、国家甚至（固定电话）电话号码“正常化”？你可以用“精确”的数据来做到这一点，但对于地址，试图将这个概念推向极端只会让整个系统变得脆弱。

话虽如此，允许一个人拥有多个地址是完全合理的，方法是将地址放入通过 FK 连接的单独表中（地址引用人，而不是相反），否则只需将地址保留在同一个表中。

# tfs - 如何验证是否安装了 TFS 2012 更新 1？

> ID：14965262
> 
> 赞同：3
> 
> 时间：2013-02-19T18:57:38.543
> 
> 标签：tfs, tfs-2012

我在服务器上安装了 TFS 2012，我想验证是否已安装 Update 1。我正在尝试安装 TFS Power Tools for Update 1，但在管理控制台中运行备份向导时遇到了问题。我怀疑这个问题是因为我没有在 TFS 上安装更新 1，但想在我经历漫长的过程之前确保。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-26T09:32:50.973

要验证您的 TFS 2012 是否已更新，请启动您的 TFS 管理员控制台。然后选择应用程序层，然后选择已安装的更新。

这是一个例子：

![TFS 2012 管理员控制台](../Images/cb46d568ec72f75b08371b56c73421d6.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T21:00:21.537

如果您的 Web 访问菜单栏是蓝色的，则您有更新 1。如果它是黑色的，您没有。

以下是带有两个不同 UI 屏幕截图的网页链接。

旧 UI（无更新 1） [http://blogs.msdn.com/b/govdev/archive/2012/09/06/license-the-new-tfs-2012-agile-planning-boards.aspx](http://blogs.msdn.com/b/govdev/archive/2012/09/06/license-the-new-tfs-2012-agile-planning-boards.aspx)

新用户界面（更新 1） [http://almsweden.com/magnust/2012/11/27/visual-studio-2012-update-1/](http://almsweden.com/magnust/2012/11/27/visual-studio-2012-update-1/)

# java - 使用从 HttpPost 和 Android 设备发送的 Jersey 接收 JSON 变量

> ID：14965264
> 
> 赞同：1
> 
> 时间：2013-02-19T18:57:40.353
> 
> 标签：java, android, rest, jersey

我有一个使用 HttpPost 发送数据的 Android 代码：

```
public static void sendRideIdAndEmail(String rideId,String email){
    HttpClient client = new DefaultHttpClient();
    HttpConnectionParams.setConnectionTimeout(client.getParams(), 10000); //Timeout Limit
    HttpResponse response;
    JSONObject json = new JSONObject();

    try {
        HttpPost post = new HttpPost("http://192.168.1.59/FareShareREST/api/rides/joinRide");
        json.put("rideid", rideId);
        json.put("emailid", email);
        Log.v("RideEmailJson",json.toString());
        StringEntity se = new StringEntity( json.toString());  
        se.setContentType(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
        post.setEntity(se);
        response = client.execute(post);

        /*Checking response */
        if(response!=null){
            InputStream in = response.getEntity().getContent(); //Get the data in the entity
        }

    } catch(Exception e) {
        e.printStackTrace();
        Log.v("Error", "Cannot Estabilish Connection");
    }

} 
```

我在 Tomcat 7 上运行的服务器端有一个 RestFul Post 方法：

```
 @POST
@Consumes(MediaType.APPLICATION_JSON)
@Path("joinRide")
public Response joinRide(@PathParam("rideid") long rideid,@PathParam("emailid") String     emailid) {
    System.out.println(emailid);
    Ride ride=rideRepository.getRideById(rideid);
    UserDetail userDetail=userRepository.getUserDetailbyEmailId(emailid);
    User user=new User();
    user.setName(userDetail.getName());
    user.setRegistrationId(userDetail.getRegistrationId());
    rideRepository.addUserToRide(ride, user);
    return Response.ok().build();
} 
```

但我总是收到电子邮件 ID 为 null。我尝试使用 @FormParam。但这似乎行不通。

有人可以为我提供任何帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:09:01.710

路径参数 ( `@PathParam`) 从传入的请求 URL 中提取。因此，例如，使用 URL`http://192.168.1.59/FareShareREST/api/rides/joinRide/5`和以下代码：

```
@POST
@Consumes(MediaType.APPLICATION_JSON)
@Path("/joinRide/{rideid}")
public Response joinRide(@PathParam("rideid") long rideid) {
    System.out.println(rideid);
} 
```

你会被`rideid`映射到`5`. 的值`5`来自被映射的 URL 部分 ( `/joinRide/{id}`)。***但是***，这对您的场景没有用 - 您正在创建一个 JSON 对象并将其包含在请求正文中。在这种情况下，在服务器端，JAX-RS 提供者会将此请求主体映射到资源方法上的第一个合格参数。你想要类似这样的代码：

```
@POST
@Consumes(MediaType.APPLICATION_JSON)
@Path("/joinRide")
public Response joinRide(String json) {
    System.out.println(json);
} 
```

这会将您的 JSON 字符串直接设置到变量如此巧妙地命名为`json`. 当然，您需要解析 JSON 以获取其中的数据，而您可能不想这样做。在这种情况下，创建一个包含预期数据字段的简单 POJO，并在资源方法中使用它：

```
public class EmailInfo implements Serializable {
    private String rideId;
    private String email;

    // Constructors, Getters/Setters
}

@POST
@Consumes(MediaType.APPLICATION_JSON)
@Path("/joinRide")
public Response joinRide(EmailInfo info) {
    System.out.println(info.getRideId());
    System.out.println(info.getEmail());
} 
```

# c# - String.Format 电话号码从左填充

> ID：14965270
> 
> 赞同：1
> 
> 时间：2013-02-19T18:57:55.167
> 
> 标签：c#, string, phone-number, string.format

我正在使用这样的东西：

```
String.Format("{0:+### ### ### ###}", System.Convert.ToInt64(str.Replace(" ", ""))) 
```

当我有完整号码时就可以了。但是当我在 TextBox 中使用它并且用户正在输入数字时，它从右侧填充（+ 4，+ 42，+ 420，+ 420 7，...）但我想从左侧填充它（+4，+42， +420，+420 7，...）。我怎样才能做到这一点？

**编辑：**感谢评论，我发现将电话号码转换为整数并不好，但我仍在寻找问题的答案。现在不使用 Convert.IoInt

# excel - Excel 2010 宏有运行时错误 -2147467259 (80004005)：参数无效

> ID：14965279
> 
> 赞同：4
> 
> 时间：2013-02-19T18:58:13.233
> 
> 标签：excel, charts, excel-2010, vba

运行我在 Excel 2010 中创建的 vba 宏时出现运行时错误`-2147467259 (80004005): Invalid parameter`。在设置 .CategoryType = xlTimeScale 后尝试设置 .majorUnitScale = xlMonths 时发生错误。尝试使用 .chartType = xlLineMarkers 创建图表

奇怪的是，当我在 Excel 2007 中运行此代码时，它可以完美运行并根据需要生成折线图。

以下是部分代码：

```
dim myChtObj as ChartObject

Set myChtObj = ActiveSheet.ChartObjects.Add(Left:=202, Width:=340, Top:=28,Height:=182)

With myChtObj.Chart
    ' remove extra series
    Do Until .SeriesCollection.Count = 0
        .SeriesCollection(1).Delete
    Loop

    .ChartType = xlLineMarkers

    .HasTitle = True
    .ChartTitle.Text = "Performance Trends"
    .ChartTitle.Font.Size = 12
    .ChartTitle.Font.Name = "Calibri"
    .ChartTitle.Font.FontStyle = "Bold"

    With .Axes(xlCategory)
        .CategoryType = xlTimeScale
        .BaseUnit = xlMonths
        .MajorUnit = 2
        .MajorUnitScale = xlMonths   ' run-time error occurs here
        .MinorUnit = 1
        .MinorUnitScale = xlMonths

        .TickLabels.NumberFormat = "mmm yy"
        .TickLabels.Orientation = 45
    End With
    .....
End with 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T01:23:46.257

灰 -

在您的代码中，尝试在分配轴刻度之前添加系列数据和类别标签。

只要至少有 1 个系列，并且类别轴标签采用日期格式，我就可以在图表上成功运行此代码。

我已将工作簿上传到已创建图表的 Google 文档。删除图表，但将系列数据保留在 B&C 列中，然后运行宏`AshOriginalWithAddSeries`。我所做的只是添加一系列带有 date-formatted 的数据`XValues`，然后你的代码就可以工作了。

[https://docs.google.com/file/d/0B1v0s8ldwHRYUWUtRWpqblgzM3M/edit?usp=sharing](https://docs.google.com/file/d/0B1v0s8ldwHRYUWUtRWpqblgzM3M/edit?usp=sharing)

```
Sub AshOriginalWithAddSeries()

Dim cht As Chart
Dim srs As Series
Dim dummyDate As Date

Set cht = ActiveSheet.ChartObjects.Add(Left:=202, Width:=340, Top:=28, Height:=182).Chart

dummyDate = DateSerial(2013, 2, 1)

' remove extra series
With cht
    Do Until .SeriesCollection.Count = 0
        .SeriesCollection(1).Delete
    Loop

    'Add at least one series:
     Set srs = .SeriesCollection.NewSeries
    With srs
        .Name = "Series Title"
        .Values = 0.5 '=Working!$C$3:$C$14" ' or you can pass an array of stored values
        .XValues = Array(dummyDate) '"=Working!$B$3:$B$14" 'or you can pass an array of values, make sure they are valid DATES though
    End With

    .ChartType = xlLineMarkers

    .HasTitle = True
    .ChartTitle.Text = "Performance Trends"
    .ChartTitle.Font.Size = 12
    .ChartTitle.Font.Name = "Calibri"
    .ChartTitle.Font.FontStyle = "Bold"

    With .Axes(xlCategory)
        .CategoryType = xlTimeScale
        '.BaseUnit = xlMonths
        .MajorUnit = 2
        .TickLabels.NumberFormat = "mmm yy"
        .TickLabels.Orientation = 45
        '.MajorUnitScale = xlMonths   ' run-time error occurs here
        .MinorUnit = 1
        '.MinorUnitScale = xlMonths

    End With

End With

'Now assign some real values to srs
    With srs
        .Name = "Series Title"
        .Values = "=Working!$C$3:$C$14" ' or you can pass an array of stored values
        .XValues = "=Working!$B$3:$B$14" 'or you can pass an array of values, make sure they are valid DATES though
    End With

End Sub 
```

我认为您的代码失败了，因为没有系列数据，因此没有类别值。它很奇特，因为即使轴不存在也可以设置**轴的某些属性。**我注意到图表自动化中的其他类似行为 - 有时它不会让您访问属性，除非有系列数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-16T14:59:34.083

我遇到过同样的问题。

我可以通过选择所有包含 X 轴值的单元格来解决它，右键单击以打开“设置单元格格式”，然后将数字类别（第一个选项卡）设置为“日期”。

# comments - 在 Facebook 评论插件下方添加填充

> ID：14965286
> 
> 赞同：0
> 
> 时间：2013-02-19T18:58:36.920
> 
> 标签：comments, padding, facebook-comments

我想在我的网站上添加 Facebook 评论应用程序，我能够成功地做到这一点。但是，如何在评论框下添加 10 像素的填充？下面列出了我粘贴到我的网站的代码。

```
<div class="fb-comments" data-href="http://example.com" data-width="470" data-num-posts="10"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:33:47.480

也许试试

```
<div style="padding-bottom:10px" class="fb-comments" data-href="http://example.com" data-width="470" data-num-posts="10"></div> 
```

作为 CSS 注入到 div 标签。它可能需要一个 ; 像素后

同样在 CSS 表中为其添加一个“id”，为其提供所需的参数

# ios - iOS 错误，消息发送到解除分配的实例

> ID：14965287
> 
> 赞同：0
> 
> 时间：2013-02-19T18:58:38.290
> 
> 标签：ios, memory-management, delegates, initializer

我已经编写了自己的类（NSObject 的子类），并且还为它编写了一个自定义初始化程序。我遇到的问题是，当我启动应用程序并调用 refreshData 实例方法时，一切正常。然后当我第二次调用 refreshData 方法时，对象被释放并且我得到了错误。当实例初始化时，内存被分配但不知何故被释放。我错过了什么？

UIViewController：

```
- (void)viewDidLoad {

    [super viewDidLoad];

    // Initialze an instance of our data controller class
    dataController = [FCDataController initWithObject:self animated:NO];
    [dataController refreshData];
} 
```

NS对象：

```
+ (FCDataController *)initWithObject:(id)object animated:(BOOL)animated {

    FCDataController *dataController = [[FCDataController alloc] initWithObject:object animated:animated];

    return dataController;
}

- (id)initWithObject:(id)object animated:(BOOL)animated {

    self = [super init];

    if (self) {

        self.delegate = object;
        self.animated = animated;
    }
    return self;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:23:04.290

`viewDidLoad`只会在`UIViewController`. 这个类真的是 a 的子类`UIViewController`吗？

假设这是一个视图控制器，该类的实例将已经创建并在`viewDidLoad`调用时运行。您在里面`viewDidLoad`的行将创建同一类的第二个实例，将第一个实例分配为第二个实例的委托。这可能不是你想要的。

您可能只想在加载视图时刷新数据。

```
- (void)viewDidLoad {
    [super viewDidLoad];

    // Initialze an instance of our data controller class
    [self refreshData];
} 
```

为了进一步扩展它，您可能不需要刷新数据，`init`因为您只是在视图加载时再次刷新它。

# python - %d 的使用不输出整数

> ID：14965297
> 
> 赞同：-2
> 
> 时间：2013-02-19T18:59:13.437
> 
> 标签：python, integer, string-formatting

我发现很难理解`%d`格式说明符。从文档中，我知道它是整数的占位符，但是当我使用它时，它的行为似乎不像：

```
>>> x=1
>>> x
1

>>> v = "%d" % x
>>> v
'1' 
```

你能解释一下为什么它返回一个字符串而不是一个整数吗？它与`%s`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:01:18.847

`%d`表示“有符号整数小数的字符串表示”，因此您会返回一个字符串

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:05:57.393

%d 用于表示您传递的参数的十进制形式，格式为字符串。这就是为什么`'%d' % 4`给你`'4'`。如果你这样做`'%d' % 0b101`，你会得到`'5'`. 如果您使用十六进制，情况也是如此。它为您提供格式化为字符串的十进制数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:08:47.580

> v = "%d" % x

%d 是变量的字符串中的占位符。V 是一个字符串，如引号和 %d（它是整数的字符串表示形式）所描述的那样，因此为了 'v' 的目的将 x 转换为字符串。

# asp.net-mvc - ASP.Net MVC 样式包不包括大多数文件

> ID：14965301
> 
> 赞同：17
> 
> 时间：2013-02-19T18:59:34.953
> 
> 标签：asp.net-mvc, bundling-and-minification

最近，我在本地复制的一个项目完全失去了大部分样式。我花了一段时间才弄明白，因为大部分样式都是在一个文件中完成的，其余的是像 Kendo 和 jQuery UI 这样的小东西。

其他的，次要的东西没有被添加到页面中。我认为样式已被另一位开发人员修改（有一段时间没有接触这个项目），他只测试 Web API 的东西而不是 UI，所以他可能会破坏它并且永远不知道，但我找到了问题：只有该`site.css`文件包含在捆绑包中，其他文件均未包含。我什至尝试重新排列包中包含的 CSS 文件的顺序，它只会包含`site.css`.

我重建了项目，清除了缓存等，所以它肯定看到了变化。我记得最近更新了一些 NuGet 包或 VS 包之类的东西——甚至可能是 MVC 包？

我的问题是：有什么改变导致了这种情况发生吗？这是什么原因造成的？

**编辑**：代码来自`BundleConfig.cs`：

```
public static void RegisterBundles(BundleCollection bundles)
{
    bundles.Add(new StyleBundle("~/Content/css").Include(
            "~/Content/site.css",
            "~/Content/themes/kendo/kendo.common.min.css",
            "~/Content/themes/kendo/kendo.default.min.css",
            "~/Content/themes/base/minified/jquery.ui.core.min.css",
            "~/Content/themes/base/minified/jquery.ui.resizable.min.css",
            "~/Content/themes/base/minified/jquery.ui.selectable.min.css",
            "~/Content/themes/base/minified/jquery.ui.accordion.min.css",
            "~/Content/themes/base/minified/jquery.ui.autocomplete.min.css",
            "~/Content/themes/base/minified/jquery.ui.button.min.css",
            "~/Content/themes/base/minified/jquery.ui.dialog.min.css",
            "~/Content/themes/base/minified/jquery.ui.slider.min.css",
            "~/Content/themes/base/minified/jquery.ui.tabs.min.css",
            "~/Content/themes/base/minified/jquery.ui.datepicker.min.css",
            "~/Content/themes/base/minified/jquery.ui.progressbar.min.css",
            "~/Content/themes/base/minified/jquery.ui.theme.min.css"));
} 
```

代码来自`_Layout.cshtml`：

```
@Styles.Render("~/Content/themes/base/css", "~/Content/css") 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-02-19T21:27:24.547

默认情况下，名称以“ **.min.css** ”结尾的文件只会包含在**发布**版本中。

推荐的捆绑配置是只包含非缩小的 .css 和 .js 文件，然后在发布版本中会自动选择 .min 版本（如果存在），即`<compilation debug="false">`在您的**Web.config**中。

您可以通过清除然后将忽略规则添加到[`BundleCollection.IgnoreList`](http://msdn.microsoft.com/en-us/library/system.web.optimization.bundlecollection.ignorelist.aspx). 一个示例`BundleConfig`可能如下所示：

```
public static class BundleConfig
{
    public static void RegisterBundles(BundleCollection bundles)
    {
        ConfigureIgnoreList(bundles.IgnoreList);

        // Setup your bundles...
    }

    public static void ConfigureIgnoreList(IgnoreList ignoreList)
    {
        if (ignoreList == null) throw new ArgumentNullException("ignoreList");

        ignoreList.Clear(); // Clear the list, then add the new patterns.

        ignoreList.Ignore("*.intellisense.js");
        ignoreList.Ignore("*-vsdoc.js");
        ignoreList.Ignore("*.debug.js", OptimizationMode.WhenEnabled);
        // ignoreList.Ignore("*.min.js", OptimizationMode.WhenDisabled);
        ignoreList.Ignore("*.min.css", OptimizationMode.WhenDisabled);
    }
} 
```

您还可以通过设置显式启用/禁用优化[`BundleTable.EnableOptimizations`](http://msdn.microsoft.com/en-us/library/system.web.optimization.bundletable.enableoptimizations.aspx)。

# python - 从 shell 向 python 脚本提供输入？

> ID：14965306
> 
> 赞同：2
> 
> 时间：2013-02-19T18:59:59.353
> 
> 标签：python, shell

我正在尝试编写一个 shell 脚本来运行一个接受一些原始输入的 python 文件。python脚本基本上是这样的：

```
def main():
    name=raw_input("What's your name?")
    print "Hello, "+name
main() 
```

我希望 shell 脚本运行脚本并自动向其中提供输入。我已经看到很多方法可以从 python 函数返回的内容中获取 shell 输入，或者如何使用输入从 python 运行 shell，但不是这样。基本上，我只想做一些事情：

```
python hello.py
#  give the python script some input here
#  then continue on with the shell script. 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T19:01:05.283

你的意思是这样的：

```
python hello.py <<EOF
Matt
EOF 
```

这被称为[bash HERE 文档](http://tldp.org/LDP/abs/html/here-docs.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T19:08:41.180

提供原始输入确实没有比`sys.stdin`. 它也是跨平台的。

```
import sys
print "Hello {0}!".format(sys.stdin.read()) 
```

然后

```
echo "John" | python hello.py # From the shell
python hello.py < john.txt # From a file, maybe containing "John" 
```

# c# - 使用 BCrypt 将 PHP 转换为 C#

> ID：14965309
> 
> 赞同：2
> 
> 时间：2013-02-19T19:00:06.197
> 
> 标签：c#, .net, bcrypt, bcrypt.net

我希望有人可以阐明我可以使用哪个库，如果有任何库可用于将一直使用 BCrypt $2a 的基于 PHP 的应用程序转换为基于 .Net 的应用程序，我刚刚意识到使用的当前 BCrypt C# 库正在使用$2y 所以我将无法在不导致大量密码重置的情况下无缝迁移用户。是否有可用的 C# 的 $2a 端口或 PHP 中的反向 $2y 实现，我可能会重新适应现有系统并重新散列密码。理想情况下，我想在 PHP 版本中进行零编码并能够迁移到 .Net 平台。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-10T14:19:01.863

至于 $2a$，这取决于您的 PHP bcrypt 版本有多旧。

2011 年之前，您需要将 $2a$ 更改为 $2x$。2011 年后，$2a$ 和 $2y$（除了 UTF-8 密码无法生成的 0xff 序列除外）是等效的。这三个对于 ASCII 密码都是等效的。

我的图书馆[CryptSharp](http://www.zer7.com/software/cryptsharp)可以以 $2a$（2011 年后，相当于 $2y$）、$2x$ 和 $2y$ 的形式进行 bcrypt。

# mysql - Mysql 存储过程。这个有问题吗？

> ID：14965311
> 
> 赞同：0
> 
> 时间：2013-02-19T19:00:09.160
> 
> 标签：mysql, stored-procedures, printing

这是存储的过程。我想做的是遍历所有数据库并在特定表中查找行数。如果计数为 0，则打印该表。

```
 DELIMITER $$
  CREATE PROCEDURE checkTableData()
  BEGIN
     DECLARE done INT DEFAULT 0;
     DECLARE db VARCHAR(255);
     DECLARE appDBs CURSOR FOR SELECT schema_name FROM information_schema.schemata WHERE     schema_name LIKE 'db_%';
     DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;
     DECLARE intCount INT default;

     OPEN appDBs;
     REPEAT
        FETCH appDBs INTO db;
          IF NOT done THEN
              SET @SQL = CONCAT('SELECT @intCount = COUNT(1) FROM ', db, '.SMS_CODES');
              EXECUTE @SQL;
              IF @intCount = 0 THEN
                 SELECT  db;
              END IF;    
         END IF;    
     UNTIL done END REPEAT;

     CLOSE appDBs;
  END $$
  delimiter ; 
```

错误就在这条线上

```
 IF NOT done THEN 
```

编辑：试过了`IF done != 0 THEN`。错误信息：

```
You have an error in your SQL; Check the manual that corresponds to your MySQL server version for the right syntax to use near ;

     OPEN appDBs;
     REPEAT
        FETCH appDBs INTO db;
              `IF don' at line 7 
```

编辑：根据@Gerve，我更新了proc并将intCount声明移到光标上方的顶部，然后将其设置为0。这样错误就消失了。现在另一个错误是：

```
 You have an error in your SQL; Check the manual that corresponds to your MySQL server version     for the right syntax to use near '@SQL 
 @SQL = CONCAT('SELECT @intCount = COUNT(1) FROM ', db, '.ECR_SMS_COUNTRY_CODES');
            EXECUTE @SQL;
    END IF;         
 UNTIL done END REPEAT;
     CLOSE appDBs;
  EN' at line 15 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:14:04.710

***第一个错误***

```
DECLARE intCount INT default; 
```

没有默认值，只需将其更改为：

```
DECLARE intCount INT default 0; 
```

*   MySQL 说错误是*near*，这意味着就在之前。

***第二个错误***

第二个错误是因为不能执行字符串导致的，需要先准备一个语句：[Prepare](http://dev.mysql.com/doc/refman/5.1/en/prepare.html) , [Execute](http://dev.mysql.com/doc/refman/5.1/en/execute.html)

```
PREPARE stmt1 FROM @SQL;
EXECUTE stmt1; 
```

# css - 如何使用一个标签将一个类应用于多个图像？

> ID：14965315
> 
> 赞同：1
> 
> 时间：2013-02-19T19:00:15.350
> 
> 标签：css

我正在尝试将一个类应用于多个图像。例如：

```
<img class="test" src="great.jpg" />
<img class="test" src="hello.jpg" />
<img class="test" src="pie.jpg" /> 
```

如何用一个标签包装所有这些图像以将“测试”类应用于所有图像，而无需在每个图像标签中指定类？在样式表中我有：

```
img.test {
border: 4px solid black;
} 
```

我尝试用 div 包装图像，然后用 span 标签将类作为测试，但没有。请帮忙？？谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:02:31.290

标记：

```
<div class="test">
    <img src="great.jpg" />
    <img src="hello.jpg" />
    <img src="pie.jpg" />
</div> 
```

CSS：

```
.test img
{
    border: 4px solid black;
} 
```

[**编辑**]：查看[w3.org 的 Selectors Level 3](http://www.w3.org/TR/css3-selectors/)，特别是[后代组合](http://www.w3.org/TR/css3-selectors/#descendant-combinators)器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:02:33.783

CSS后代选择器！

HTML：

```
<div class="test">
  <img src="great.jpg" />
  <img src="hello.jpg" />
  <img src="pie.jpg" />
</div> 
```

CSS：

```
.test img {
  border: 4px solid black;
} 
```

# python - 你如何将 Python 的 Noise 1.1.1 用于坐标？

> ID：14965316
> 
> 赞同：2
> 
> 时间：2013-02-19T19:00:15.477
> 
> 标签：python, perlin-noise

我环顾四周，似乎大多数人将它用于纹理，我发现自己一直在试图弄清楚如何将 Perlin/Simplex Noise 实现到一组二维坐标 x 和 y。

我要做的就是输入 2 个随机坐标 x & y，然后它返回一个改变的 x & y，或者这不可能吗？

我正在使用python[噪声](http://pypi.python.org/pypi/noise/1.1.1)来创建坐标，但我发现柏林噪声很难理解并且无法完全理解它是如何工作的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:33:09.343

可以使用 Perlin Noise 为 2D 坐标的集合添加一些不确定性（如果集合是一对，那也很好）。您可以考虑返回的噪声值（在指向库的 [-1, 1] 范围内）以及一些因素来确定它对输入坐标的影响程度。因子越大，噪声对数据的影响就越大。这是最简单的示例之一：

```
from noise import snoise2 # Simplex noise for 2D points

x, y = 0.5, 0.3
factor = 0.1
n = snoise2(x, y)
print x + n * factor, y + n * factor 
```

我们还可以考虑更大的因素并将相同的想法应用于图像。考虑`factor = 15`并将结果坐标四舍五入到最近的邻居，我们从左边的图像到右边的图像：

![在此处输入图像描述](../Images/c567cb8ed88e6150138f0513603fa343.png) ![在此处输入图像描述](../Images/0f22d1c95ea81f192646c7c240a5cb2c.png)

获取图像的完整代码如下。这些因素`n1`和`n2`用于获得“不那么无聊”的图像。

```
import sys
from noise import snoise2
from PIL import Image

img = Image.open(sys.argv[1]).convert('L')
result = Image.new('L', img.size)
width, height = img.size

factor = 15
res = result.load()
im = img.load()
for x in xrange(width):
    for y in xrange(height):
        n1 = snoise2(x, y)
        n2 = snoise2(y, x)
        pt = [int(round(x + n1 * factor)), int(round(y + n2 * factor))]
        pt[0] = min(max(0, pt[0]), width - 1)
        pt[1] = min(max(0, pt[1]), height - 1)
        res[x, y] = im[tuple(pt)]
result.save(sys.argv[2]) 
```

当然，这甚至没有涉及如何使用 Perlin Noise。再举一个例子，给定一个特定的函数，你可以对输入进行“噪声化”，并结合上述因素来创建不同的输出。例如，这是对基于余弦的某个函数执行此操作的结果：

![在此处输入图像描述](../Images/3d4685ff3524173c0772a16efa178cb3.png)

# javafx-2 - JavaFx：方法 selectAll() 仅通过键盘焦点起作用

> ID：14965318
> 
> 赞同：9
> 
> 时间：2013-02-19T19:00:26.470
> 
> 标签：javafx-2, javafx

我使用 selectionAll() 来选择我的文本字段中的整个文本，但它只在焦点来自键盘（如 Tab）时才有效。

如果我用鼠标在文本字段中单击，它会在很短的时间内选择文本。但它必须像来自键盘的焦点一样工作。

```
flaschenPreis.focusedProperty().addListener(new ChangeListener<Boolean>() {
    public void changed(ObservableValue ov, Boolean t, Boolean t1) {

        if ( flaschenPreis.isFocused() && !flaschenPreis.getText().isEmpty()) {
            flaschenPreis.selectAll();
        }              
    }
});

literPreis.focusedProperty().addListener(new ChangeListener() {
    public void changed(ObservableValue ov, Object t, Object t1) {

        if (literPreis.isFocused() && !literPreis.getText().isEmpty()) {
            literPreis.selectAll();
        }
    }
}); 
```

flaschenPreis 和 literPreis 是我的文本字段

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-19T20:40:15.627

这个技巧将帮助你：

```
final TextField tf = new TextField("Text");
tf.focusedProperty().addListener(new ChangeListener<Boolean>() {
    @Override
    public void changed(ObservableValue ov, Boolean t, Boolean t1) {

        Platform.runLater(new Runnable() {
            @Override
            public void run() {
                if (tf.isFocused() && !tf.getText().isEmpty()) {
                    tf.selectAll();
                }
            }
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-07-21T22:03:39.407

这对我有用：

```
PathField.focusedProperty().addListener((obs, wasFocused, isNowFocused) -> {
    if (isNowFocused) {
        Platform.runLater(() -> PathField.selectAll());
    }
}); 
```

# ms-word - 在 Word 模板中使用字段值

> ID：14965322
> 
> 赞同：0
> 
> 时间：2013-02-19T19:00:57.837
> 
> 标签：ms-word

我正在为更多页长的文档构建模板。我正在使用“富文本”和“文本”内容控制字段。我希望这些内容控制字段之一的文本出现在文档的页脚中。我尝试在页脚中使用 StyleRef 字段并显示具有特定样式的文本，即我要显示的字段中的样式，但它不起作用。似乎 Word 没有在这些字段中查找样式（或看到与该字段相关的不同样式？）。

我还能如何做到这一点？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:16:53.950

我可以通过使用控件的侧选项卡选择整个内容控件并插入一个新书签（通过插入书签）然后使用上述书签名称在页脚中插入一个 ref 字段来做到这一点。

# grails - Grails 2.2.0 升级导致协议缓冲区不匹配

> ID：14965323
> 
> 赞同：1
> 
> 时间：2013-02-19T19:01:00.610
> 
> 标签：grails, protocol-buffers, grails-2.2

我们正在使用 groovy 2 和 jdk 1.7升级我们的`grails 2.0.3`应用程序。`grails 2.2.0`但是，我们发现它`grails 2.2.0`与`protobuf-java 2.4.1`我们的应用程序用来与后端对话的 jar 不匹配。该系统使用`protobuf-java 2.3.0`. 因此，与该系统的任何通信都会失败。

我们尝试使用 BuildConfig.groovy 中的 excludes 标记排除 protobuf-java，如下所示 -

```
inherits("global") { excludes 'protobuf-java' } 
```

我们认为这只会排除我们从 grails 获得的 2.4.1 版本。然而，这似乎排除了这个 jar 的所有版本，即使是我们从我们正在使用的这个 jar 中获得的作为传递依赖项的版本。如果我们尝试使用 excludes 标记，然后将 protobuf-java 作为依赖项包含在我们的 pom 中，版本为 2.3.0，应用程序重新启动将失败并出现 grails 错误。

我的问题：

1.  有没有一种方法可以使用排除 jar 仅排除特定版本的 protobuf-java jar（即 2.4.1）

2.  排除 grails 的继承依赖项之一（在我们的例子中为 protobuf java 2.4.1）并建议使用降级版本

如果排除不是一种选择，有没有其他更好的方法来解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-09-07T11:27:58.180

Grails 2.0.3 和一个库在 protobuf-java 3.4.0 中也有类似的问题。我们通过运行战争而不是“grails run-app”来解决它：

```
$ grails -Dgrails.env=dev war && java -jar target/com.acme.app-2.3.0.war 
```

无论如何，类重新加载功能不适用于此项目。

# java - 如何从Java列表中随机选择一个整数？

> ID：14965326
> 
> 赞同：-2
> 
> 时间：2013-02-19T19:01:13.287
> 
> 标签：java, random, integer

这是我到目前为止所拥有的：

```
private int [] delays = {1000, 1333, 3443, 1220, 3232}; 
```

我想要一个功能，它会在继续之前睡一会儿：

```
sleep(random(delays)) 
```

我找到了字符串的解决方案，但是当涉及到整数时，我并不真正理解它。

我已经导入了随机数。我有：

```
 Random rand = new Random();
int delayIndex = rand.nextInt(delays.length); 
```

但是它说： Random 类型中的方法 nextInt(int, int) 不适用于参数 (int)

谢谢你否定我。

感谢您的帮助，但是我遇到的问题仍然存在：

Random 类型中的方法 nextInt(int, int) 不适用于参数 (int)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:15:58.640

```
sleep(delays[(int)(Math.random() * 100) / 20]); 
```

`Math.random()` returns a random number >= 0.0 and < 1.0

Multiply by 100, convert to int, and divide by 20 - you now have a random number 0 - 4\.

Or:

```
sleep(delays[new Random().nextInt(5)]); 
```

[http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#random()](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#random()) [http://docs.oracle.com/javase/7/docs/api/java/util/Random.html](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:03:20.223

使用 Java 的内置[`Random`](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html)类在 0 和数组的最后一个索引之间选择一个随机整数。

```
import java.util.*;

Random rnd = new Random();
int delayIndex = rnd.nextInt(delays.length); 
```

然后访问您的数组并将该数组元素输入`Thread.sleep`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T19:03:27.627

生成一个随机值，`0...N`其中 N 是保存持续时间的数组的大小。一旦你有了那个随机值，它是数组的索引，只需在该索引位置从数组中检索的持续时间内休眠。

```
Random random = new Random();
int randomInt = random.nextInt(delays.length);
sleep(delays[randomInt]); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T19:03:36.143

```
Random r = new Random ();

Thread.sleep (delays [r.nextInt (delays.length)]); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-19T19:05:11.763

```
Random rnd = new Random();
int index = rnd.nextInt(delays.length); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-19T19:06:47.650

```
public int random(int[] delays){
    Random rn = new Random();
    int range = delays.length - 1;
    int pos = rn.nextInt() % range;

    return delays[pos];
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-17T13:22:14.207

整数数组不是列表，数组通常具有对象的顺序内存存储（例如 0 = 1, 1 = 16, 2 = 0, 3 = 100）但是无论如何这里是如何使用整数数组来做到这一点：

```
int[] delays = {1000, 1333, 3443, 1220, 3232};
Random rand = new Random();
Thread.sleep(delays[rand.nextInt(delays.length)]); 
```

要对具有整数列表的列表执行相同的操作，它将是这样的：

```
List<Integer> delays = Lists.newArrayList(1000, 1333, 3443, 1220, 3232);
int delay;
for (Iterator<Integer> iter = delays.iterator(); iter.hasNext();){
    Random rand = new Random();
    if(rand.nextInt(delays.size()) == delays.size()){
            delay = iter.next();
            break;
    }
}
Thread.sleep(delay); 
```

正如您可能猜到的那样，我也是 java 新手，但我希望我能提供帮助。

# c# - 使用 NHibernate 调用参数化存储过程

> ID：14965338
> 
> 赞同：0
> 
> 时间：2013-02-19T19:01:54.907
> 
> 标签：c#, .net, xml, nhibernate, stored-procedures

我想调用一个返回的存储`ClassID`过程`Student id`

我的 XML 映射是

```
<sql-query name="GetClassRevenuebyStudent_Sea">
    <return-scalar column="totalRevenew" type="System.String" />
    exec GetClassRevenue_Sea ClassID, StudentID
</sql-query> 
```

我的存储过程调用代码是

```
public static double Student_ShowRevenue(string classid, string studentid)
{
    ISession session = NHibernateHelper.GetSession();
    ITransaction trans = session.BeginTransaction();
    IQuery query = (IQuery)session.GetNamedQuery("GetClassRevenuebyStudent_Sea");
    query.SetParameter("ClassID", classid);
    query.SetParameter("StudentID", studentid);

    return Convert.ToDouble(query.List()[0]); 
} 
```

但是当我运行应用程序时，它会给出异常

```
return Convert.ToDouble(query.List()[0]) 
```

没有设置所有参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T13:28:41.940

`ClassId`您需要在映射中的和属性前面放置一个冒号，`StudentId`以表明它们是您要设置的参数的占位符：

```
<sql-query name="GetClassRevenuebyStudent_Sea">
    <return-scalar column="totalRevenew" type="System.String" />
    exec GetClassRevenue_Sea :ClassID, :StudentID <!-- notice the colon (:) -->
</sql-query> 
```

然后你可以从你的代码中调用命名查询，

```
IQuery query = session.GetNamedQuery("GetClassRevenuebyStudent_Sea")
   .SetParameter("ClassID", classid)
   .SetParameter("StudentID", studentid); 
```

# c# - 播放时加载纹理

> ID：14965353
> 
> 赞同：3
> 
> 时间：2013-02-19T19:02:46.063
> 
> 标签：c#, xna

对于我的 2D 游戏：
在玩的时候，我必须加载一些大的 texture2D（2000x2500 像素）并卸载一些其他的。
当然，我想在没有游戏/绘图冻结（或更小...）的情况下加载和卸载 texture2D：x 我不知道这是否可能。

在绘制“加载屏幕”时，我已经使用线程加载了一些纹理

```
//thread Loading
ThreadStart th_loadingScreen = delegate { DisplayLoading(LoadingScreen); };
new Thread(th_loadingScreen).Start(); 
```

但我认为这是非常不同的。

当然，我尝试了一些东西：

```
private void LoadUnload()
{
    for (int j = 0; j <= NbrRow; j++)
        for (int i = 0; i <= NbrCol; i++)
        {
            if(somethingTrue)
            {
                ThreadStart th_LoadInGame = delegate
                    {
                        LoadInGame(i, j, TextureStringPathToLoad);
                    };
                new Thread(th_LoadInGame).Start();
            }
        }
} 
```

但我有一点冻结。

而且，我知道如何卸载内容，但我不知道如何卸载单个加载的纹理：x

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:46:14.223

无法卸载`ContentManager`对象中的单个元素。所以，我要做的是制作多个`ContentManager`s 并将我需要的东西分开。`Unload`例如，这样我就可以一个人，并让其他人保持记忆。

至于您看到的小冻结，线程本身并不能保证没有打嗝等。我会弄乱`Thread`' 的[`Priority`](http://msdn.microsoft.com/en-us/library/system.threading.thread.priority.aspx)属性；也许尝试将其设置得更低，看看会发生什么。然而，即使这也不能保证。来自文章：

> 操作系统不需要遵守线程的优先级。

# objective-c - 使用 CFStringRef 和 CFRelease 进行正确的内存管理

> ID：14965354
> 
> 赞同：7
> 
> 时间：2013-02-19T19:02:50.323
> 
> 标签：objective-c, automatic-ref-counting, core-foundation

考虑这个简单的方法；它是 NSString 上的一个类别。

```
- (NSString *)stringByUrlEncoding
{
    CFStringRef newString = CFURLCreateStringByAddingPercentEscapes(NULL, (CFStringRef)self, NULL, (CFStringRef)@"!*'\"();:@&=+$,/?%#[]% ", kCFStringEncodingUTF8);
    NSString *returnString = (__bridge NSString *)newString;
    CFRelease(newString);
    return returnString;
} 
```

它的工作是为 URL 编码`=`转换成`%3D`等，但这与这个问题无关。

关于内存管理的几个问题：

1.  调用后`CFRelease(newString);`，我仍然可以`po newString`在调试器中看到字符串。这是否意味着它没有被正确释放？

2.  当我将转换的 CFStringRefs 传递给 CFURLCreateStringByAddingPercentEscapes 的参数时，（例如`(CFStringRef)self`，例如）我相信我不需要将它们存储到变量中，然后由于“免费桥接”而 CFRelease 它们。它是否正确？

3.  如果它是 CGImageRef 而不是 CFStringRef，#2 的答案会改变吗？为什么CGImageRef有自己的CGImageRelease函数，却没有CFStringRelease方法？

4.  为了确保我的理解`__bridge_transfer`是正确的，这个修改后的代码是否相同？

    ```
    - (NSString *)stringByUrlEncoding
    {
        CFStringRef newString = CFURLCreateStringByAddingPercentEscapes(NULL, (CFStringRef)self, NULL, (CFStringRef)@"!*'\"();:@&=+$,/?%#[]% ", kCFStringEncodingUTF8);
        NSString *returnString = (__bridge_transfer NSString *)newString;
        // CFRelease(newString);
        return returnString;
    } 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:21:05.720

至于你的问题：

1）您没有足够的信息来知道是否`newString`应该被释放。例如，如果实际上不需要字符替换，则`CFURLCreateStringByAddingPercentEscapes`返回等效于`[self retain]`;是合理的。这只是一个例子。更广泛的观点是“你不知道”。这里的正常方法是使用 Instruments 来查找堆增长和泄漏。更多信息，谷歌“retainCount useless”（这里不再赘述。）

2) 是的。

3）`CGImageRef`不是免费桥接，但是，据我了解，`CFRetain`应该`CFRelease`可以工作。`CFRelease`和`CGImageRelease`这里的区别在于参数`CFRelease`不能是`NULL`，而`CGImageRelease`将容忍`NULL`参数。

4)`__bridge_transfer`是此处使用的适当注释。这会将 +1 保留计数从 ARC 未处理的一侧“转移”到它确实处理的一侧。换句话说，`__bridge_transfer`只是告诉 ARC 它需要`release`为此指针创建一个调用，即使它从未生成过`retain`.

# javascript - 更改 JavaScript 函数以使用多个复选框以接受条款和条件

> ID：14965355
> 
> 赞同：0
> 
> 时间：2013-02-19T19:02:58.637
> 
> 标签：javascript

我有以下功能，当页面上有一个产品时效果很好：

```
<script type="text/javascript">// <![CDATA[
function confSubmit()
{
if(!document.getElementById("one").checked)
{ 
    alert("Please read and accept the terms and conditions + Warnings in order to sign    up to Woolly Mammoth");
    return false;
}

}
// ]]></script> 
```

如果未选中条款和条件的复选框，则上述功能会显示错误。

现在我在页面上有多个产品都有自己的复选框，问题是如果我在每个产品旁边都放了一个复选框，那么它总是会显示错误，除非他们选中每个产品旁边的框。

任何人都可以帮我编辑该功能，以便我可以在多个复选框上使用它，但只需要检查一个框。

该函数在贝宝按钮上调用。确实有一种更简单的方法可以做到这一点，而不是重命名函数并更改每个产品的 ID？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:10:58.130

您可以做的是通过类名获取元素，并为复选框提供一个通用的 CSS 类名。不幸的是 < IE9 不支持 getElementsbyClassName，所以我建议使用 jQuery。

```
function confSubmit() {
    var checkCount = $('.myclass:checked').length;
    if(checkCount < 1) {
        alert('....');
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:17:27.063

我没有运行代码，所以测试它。您需要为每个复选框设置不同的 ID。

```
<script type="text/javascript">// <![CDATA[
function confSubmit()
{
var boxesChecked = 0;

if(document.getElementById("one").checked)
{ 
boxesChecked++;
}
if(document.getElementById("two").checked)
{ 
boxesChecked++;
}
//same for all boxes ....

if(boxesChecked==1)
    return true;
 else
    return false;

}
// ]]></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:22:40.117

Diodeus 的答案是正确的，但是如果你想在*没有*JQuery 的情况下这样做（上帝帮助你），你只需要一个用于 getElementsByClassName() 的 polyfill：

来自[https://gist.github.com/eikes/2299607](https://gist.github.com/eikes/2299607)

```
// Add a getElementsByClassName function if the browser doesn't have one
// Limitation: only works with one class name
// Copyright: Eike Send http://eike.se/nd
// License: MIT License

if (!document.getElementsByClassName) {
  document.getElementsByClassName = function(search) {
    var d = document, elements, pattern, i, results = [];
    if (d.querySelectorAll) { // IE8
      return d.querySelectorAll("." + search);
    }
    if (d.evaluate) { // IE6, IE7
      pattern = ".//*[contains(concat(' ', @class, ' '), ' " + search + " ')]";
      elements = d.evaluate(pattern, d, null, 0, null);
      while ((i = elements.iterateNext())) {
        results.push(i);
      }
    } else {
      elements = d.getElementsByTagName("*");
      pattern = new RegExp("(^|\\s)" + search + "(\\s|$)");
      for (i = 0; i < elements.length; i++) {
        if ( pattern.test(elements[i].className) ) {
          results.push(elements[i]);
        }
      }
    }
    return results;
  }
} 
```

然后您可以正常使用 getElementsByClassName ：

```
var elements = document.getElementsByClassName('myClass');
for(var i = 0; i < elements.length; i++) {
     if(elements[i].checked) {
        //do something here.
     }
} 
```

您需要选择的每一个元素都`myClass`适用于：`class="myClass"`或`class="something something myClass"`.

# java - 使用智能 GWT 分离 RadioGroupItem 中的单选按钮元素

> ID：14965356
> 
> 赞同：0
> 
> 时间：2013-02-19T19:03:00.400
> 
> 标签：java, ajax, gwt, smartgwt

我是 GWT 的新手，我想将 RadioGroupItem 中的单选元素分开。我的 RadioGroupItem 包含两个单独的单选值。例如

*收音机A

*收音机B

而我想要做的是将它们分开，并且能够将更多的小部件或组件放在这两个单选值之间的分隔中。例如：

*收音机A

（数据网格）

(组合框项)

*收音机B

（数据网格）

（文本字段项）

有没有办法通过 RadioGroup 实现这种分发？

```
RadioGroupItem groupRc1 = new RadioGroupItem();
        groupRc1.setTitle("");
        groupRc1.setValueMap("Radio A", "Radio B");
        groupRc1.setDefaultValue("Radio A"); 
```

我认为这应该是一种方法，就像使用 GUI Java SE 应用程序一样，您可以在其中创建一个 ButtonGroup 并将 RadioButton1 和 RadioButton2 添加到该按钮组。

我试过 .setAttribute("cellPadding", 70); 我得到了空间，但我不能将任何组件放在分隔符中。请，我将非常感谢您的帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:51:38.433

这`current behavior`是设计使然。项目之间的间距是根据列中显示的项目`automatically`的`RadioGroup's`大小和最大数量计算的。

正如您所尝试的，我们可以实现填充但无法插入`elements` `inbetween`

如果您想要自定义行为：

*   你需要自己写`widget class`

或者

*   您需要创建单独的单选按钮并将其他单选按钮设置为 false `ClickHandlers`（这很常见）。

# c# - 多线程读取文件

> ID：14965359
> 
> 赞同：0
> 
> 时间：2013-02-19T19:03:13.537
> 
> 标签：c#, multithreading

我想解析来自网络中不同用户机器的日志文件。在任何一天，要读取的机器数量可以在 10K 到 40K 之间。同样在解析日志文件之后，我想将每个解析的结果（行或 2）存储在一个公共位置（数据库表或平面文件）。他们自己的日志文件并没有那么大。

什么是最优雅和最有效的方法？

编写控制台应用程序，使用线程池并分配任务？或者 c# 中是否有更复杂的解决方案/类？
或者
我不熟悉编写 Windows 服务，但是是否可以编写一个服务并将其
部署到多台机器上？
或
任何其他方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:13:47.767

> 最有效的方法是什么？

这是有待商榷的——我敢说这个帖子的部分原因。就个人而言，我会在一台机器上对日志的读取进行线程池化，并将这些操作的结果存储在 SQL Server 后端。但是，这是重型生产环境方法，可能不适用，具体取决于您要投入多少精力。

理想情况下，这将被编写为专用的 Windows 服务，并且在 Visual Studio 的最新版本中构建/调试这些服务变得更加容易。另一种可行的方法是创建一个控制台应用程序，您可以轻松运行并查看其输出。部署时，您可以使用所有 NSSM 工具来允许控制台应用程序作为 Windows 服务运行。这可能是最不痛苦但稍微笨拙的方法 - 其他海报可能有更简洁的解决方案。

让一个应用程序或程序在单个服务器上运行是最简单的方法，但这假设服务器可以访问日志文件所在的每台机器上的相关共享。

如果您想将服务部署到有问题的每台机器上并让它在本地运行（绕过整个多线程方法，因为您有一个线程按定义的时间表检查一组日志文件），那么拥有一个 SQL Server 后端是更简单的方法是配置 SQL Server 帐户并允许远程连接比在一组机器上配置文件夹共享更容易（因为我不是域管理员，所以我会在此更正）。这样做的缺点是，如果您需要更新应用程序，那么在每台机器上进行更新会很痛苦。

归结为哪种方法最适合您的情况？需要机器共享的单一部署还是使用单个 SQL Server（或其他数据存储）实例的多重部署？

# validation - 在 zendframework2 中验证日期

> ID：14965361
> 
> 赞同：3
> 
> 时间：2013-02-19T19:03:14.643
> 
> 标签：validation, zend-framework2

嗨，我想验证 zf2 表单中的日期字段。我设置了“格式”选项以获得我需要的格式。但是每次我验证它时都会出错。验证器如下所示：

```
 $inputFilter->add($factory->createInput(array(
            'name' => 'user_data_birth',
            'required' => false,
            'validators' => array(
                array(
                'name' => 'Date',
                'options' => array(
                    'format' => 'd.m.Y',
                    'locale' => 'de',
                    'messages' => array(
                        \Zend\Validator\Date::INVALID => 'Das scheint kein gÃ¼ltiges Datum zu sein.',
                        \Zend\Validator\Date::INVALID_DATE => 'Das scheint kein gÃ¼ltiges Datum zu sein. (Invalid Date)',
                        \Zend\Validator\Date::FALSEFORMAT => 'Das Datum ist nicht im richtigen Format.',
                        ),
                    ),
                ),
                array(
                    'name' => 'NotEmpty',
                    'options' => array(
                    'messages' => array(
                        \Zend\Validator\NotEmpty::IS_EMPTY => 'Bitte geben Sie das Datum an'
                        ),
                    ),
                )
            ),
        ))); 
```

但是每次我都会收到日期格式错误的错误消息。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-10-09T04:17:57.787

你可以解决，开始日期应该小于结束日期验证的问题，使用回调函数如下：

```
 $inputFilter->add($factory->createInput(array(
                'name' => 'end_date',
                'required' => true,                 
                'filters' => array(
                        array('name' => 'StripTags'),
                        array('name' => 'StringTrim'),
                ),
                'validators' => array(
                    array(
                        'name' => 'Callback',
                        'options' => array(
                            'messages' => array(
                                    \Zend\Validator\Callback::INVALID_VALUE => 'The end date should be greater than start date',
                            ),
                            'callback' => function($value, $context = array()) {                                    
                                $startDate = \DateTime::createFromFormat('d-m-Y', $context['start_date']);
                                $endDate = \DateTime::createFromFormat('d-m-Y', $value);
                                return $endDate >= $startDate;
                            },
                        ),
                    ),                          
                ),
        ))); 
```

使用上面的代码，我已经解决了我的问题。我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-27T12:23:03.287

需要更改日期元素中的验证器。如果你将格式传递给元素，你会没事的。您也可以从元素中获取验证器。

```
$date = new Element\DateTime('test');
$date->setFormat('d.m.Y'); 
```

或者

```
$validators = $date->getValidators()
// apply you changes 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-17T08:54:26.490

如果我们只需要以一种形式使用回调函数，那么回调函数是一种非常方便的方式。大多数时候，我们需要在不止一个地方使用它。我做了一些研究并编写了这个自定义验证器。这个验证器比较两个字符串；我添加了另一个技巧，看看我们是否需要这些字符串不同或相同。

如果我们要更改密码；那么旧密码和新密码同时不同，我们需要新密码验证与新密码相同。只需将不同的参数更改为“true”或“false”，此验证器即可用于这两种情况。

```
Form Fields
user_password
new_user_password
new_user_password_verify 
```

在 Application\src\Application\Validator 中创建一个新的验证器 StringCompare.php

```
<?php

namespace Application\Validator;

class StringCompare extends \Zend\Validator\AbstractValidator {

    const SAME = 'same';
    const DIFFERENT = 'different';

    protected $messageTemplates = array(
        self::SAME => "Both the words are the same",
        self::DIFFERENT => "Both the words are different",
    );

    protected $messageVariables = array(
        'compareWith' => array( 'options' => 'compareWith' ),
        'different' => array( 'options' => 'different' ),
    );

    protected $options = array(
        'compareWith' => "",
        'different' => true,
        'encoding' => 'UTF-8',
    );

    public function __construct( $options = array( ) ) {
        parent::__construct( $options );
    }

    public function getCompareWith( ) {
        return $this->options[ 'compareWith' ];
    }

    public function getDifferent( ) {
        return $this->options[ 'different' ];
    }

    public function isValid( $value, $context=array( ) ) {

        $compareWith = $this->getCompareWith( );
        $different = $this->getDifferent( );

        $returnValue =  $value == $context[$compareWith];
        if ( $different ) {
            $returnValue = !$returnValue;
       if ( !$returnValue ) {
          $this->error( self::SAME );
           }
        } else {
        if ( !$returnValue ) {
        $this->error( self::DIFFERENT );
        }
    }
        return $returnValue;

    }

} 
```

将以下内容添加到表单过滤器

```
$this->add ( array (
    'name'  => 'new_user_password',
    'required' => true,
    'filters' => array (
        array ( 
            'name' => 'StringTrim',
        ),
    ),
    'validators' => array (
        array (
            'name' => 'StringLength',
            'options' => array (
                'min' => 8,
                'max' => 20,
            )
        ),
        array (
            'name' => 'Application\Validator\StringCompare',
            'options' => array (
                'compareWith' => 'user_password',
                'different' => true,
            ),
        ),
    )
) ); 
```

在您的控制器中执行表单验证，我们就完成了。如果我们使用 different = 'true' 验证例程确保两个值不同，如果我们使用 'false'，则它确保字符串相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-30T19:22:38.570

您是否尝试过另一种格式，例如基本格式：'Ymd'？结果是什么？

# google-chrome - Webkit 转换在 Webkit 动画中不起作用

> ID：14965362
> 
> 赞同：2
> 
> 时间：2013-02-19T19:03:19.277
> 
> 标签：google-chrome, css, animation, webkit

我制作了一个应该旋转 div 的简单动画。

```
@-webkit-keyframes turn{   
    0% { -webkit-transform:(0deg); }  
    100% { -webkit-transform:(360deg); }
} 
```

我把它分配给了 div。

```
#myDiv
{
    -webkit-animation-name:turn;
    -webkit-animation-duration:4s;
} 
```

动画在 Chrome 上不起作用，但是当我在 firefox 上使用相同的动画（添加 -moz-）时，一切正常。

这是[小提琴](http://jsfiddle.net/p6S3C/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T19:06:34.350

您忘记了转换功能。正确的语法是：

```
-webkit-transform: rotate(0deg) 
```

我已经更新了你的[演示](http://jsfiddle.net/p6S3C/1/)。

# git - Git 签出：“@{-N}”语法

> ID：14965365
> 
> 赞同：1
> 
> 时间：2013-02-19T19:03:26.777
> 
> 标签：git

我在 git 手册页中找到了这一部分，但这是一种混淆的解释：

> 作为一种特殊情况，第 N 个最后一个分支的“@{-N}”语法检出分支（而不是分离）。您也可以指定 - 与“@{-1}”同义。

这是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:12:19.307

它是说，如果你这样做：

```
git checkout @{-1} 
```

您将在签出当前分支之前签出您所在的分支。此外，它*通过 name*将其签出，因此您实际上将*在*该分支上，而不仅仅是在分离的 HEAD 状态下签出该提交。类似地，您可以使用`git checkout @{-2}`返回“之前的两个分支更改”，等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-12-15T20:25:12.060

Git 2.16（2018 年第一季度）澄清了这种有点“混淆”的解释。
`@{-N}`in " `git checkout @{-N}`" 可能指的是分离的 HEAD 状态，但文档对此并不清楚，已修复。

请参阅[Kaartic Sivaraam ( ) 的](https://github.com/sivaraam)[提交 75ce149](https://github.com/git/git/commit/75ce14957507bc310ad118df08c4a85fd9cedc0d)（2017 年 11 月 27 日[）](https://github.com/sivaraam)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 7065665](https://github.com/git/git/commit/706566524ef59a97e89ba895b800398ef823d109))^(中，2017 年 12 月 13 日）)[`sivaraam`](https://github.com/sivaraam)
^([`gitster`](https://github.com/gitster))

> `Doc/checkout`: 签出使用`@{-N}`会导致分离状态
> 
> `@{-N}`是第**N 个最后一个“结帐”**的语法，而不仅仅是第 N 个最后一个“分支”。因此，在某些情况下，使用`git checkout @{-$N}` DOES 会导致“分离 HEAD”状态。
> 这也可以通过[75d6e55](https://github.com/git/git/commit/75d6e552a8f289fb0ee606a7bdfceace6df93bb3)的提交消息（文档：`@{-N}`可以参考提交，2014-01-19，Git 1.9-rc1）来确保，该消息明确指定如何`@{-N}`不仅可以引用分支，还可以引用提交.
> 
> 更正说明`@{-N}`不分离 HEAD 的误导性句子。

[`git checkout`手册页](https://github.com/git/git/blob/75ce14957507bc310ad118df08c4a85fd9cedc0d/Documentation/git-checkout.txt#L266-L268)现在显示：

> 您可以使用`"@{-N}"`语法来引用使用“git checkout”操作签出的第 N 个最后一个分支/提交。
> 您还可以指定`-`哪个是 的同义词`"@{-1}`。

# java - 如何正确地将 Apache Commons jar 添加到类路径？

> ID：14965375
> 
> 赞同：1
> 
> 时间：2013-02-19T19:03:52.603
> 
> 标签：java, swing, netbeans, apache-commons, japplet

我正在尝试将 base64 字符串转换为我使用 Apache Commons Base64 类的字符串。此转换功能将被合并到在 NetBeans 中开发的 Java Web 小程序中。当我尝试运行网络小程序时，网络小程序声称`java.lang.NoClassDefFoundError: org/apache/commons/codec/binary/Base64`在我尝试进行 base64 转换的阶段有一个。

我试过右键单击项目并选择属性并添加

> commons-codec-1.7.jar

到我的图书馆列表。

我还尝试将 commons-codec-1.7.jar 文件包含在 WEB-INF/lib 目录中，以及与用于启动我的 Web 小程序的 html 文件相同的路径中。在任何情况下，

> java.lang.NoClassDefFoundError

不断出现。

我不确定为什么会发生这种情况，因此我目前陷入困境。

任何帮助，将不胜感激。

谢谢。

这是一个屏幕截图：

![在此处输入图像描述](../Images/215ded2d85ff4a140465c082f72090ac.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T19:09:52.257

简单地将 JAR 文件添加到其中是`WEB-INF/lib`行不通的。您需要确保 JAR 可供下载，并且它包含在 applet 标记归档列表中：

```
<applet code="MyApplet.class" width=640 height=480 archive="myapplet.jar,commons-codec-1.7.jar">
</applet> 
```

# postgresql - 需要更改压缩 sql .dmp 文件的编码

> ID：14965377
> 
> 赞同：0
> 
> 时间：2013-02-19T19:04:05.990
> 
> 标签：postgresql, character-encoding, pg-dump

我需要更改使用 pg_dump 命令创建的压缩 .dmp 文件的编码。目前我只有转储文件而不是整个数据库。如何更改文件以符合另一种编码？我想从win1252转到latin1。在 linux 机器上使用 iconv 时，它告诉我 win1252 不受支持。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:10:15.160

来自 Postgres 的 .dmp 文件是一个普通的纯文本文件，因此您应该能够使用例如 iconv。假设你想从 UTF-8 切换到 LATIN1，你可以这样做：

```
iconv -f utf-8 -t latin1 <infile >outfile 
```

请注意，这只会改变字符的编码。如果您需要更改用于创建表、列等的 DDL，则需要手动修改文件。或者导入它，进行更改，然后再次导出。

# java - Java calendar.getTimeInMillis() 返回额外的零？

> ID：14965387
> 
> 赞同：0
> 
> 时间：2013-02-19T19:04:40.030
> 
> 标签：java, calendar

我正在使用 Java`Calendar`对象设置日期，然后以毫秒为单位获取时间，以确定两个不同时代的年表。在我仔细检查返回值之前，这似乎是一个很棒的计划`getTimeInMillis()`。
**Fri Jul 17 00:00:00 CDT 2009**返回 1247806800 **000**当我用 Perl 测试返回值时，它似乎并没有抖动，它告诉我这个时代应该真的是 1247806800（短 3 个零）。

这些额外的零是从哪里来的？Java 文档只是说 getTimeInMillis()

> 返回此日历的时间值（以毫秒为单位）。

但没有解释为什么会出现这种差异。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T19:07:04.973

Perl 以秒为单位表示自纪元以来的时间，而 Java 以毫秒（1/1000 秒）表示自纪元以来的时间。所以 Perl 时间总是比 Java 时间少 1000 倍。

# java - Android 路径 + 追踪字母

> ID：14965393
> 
> 赞同：2
> 
> 时间：2013-02-19T19:05:20.157
> 
> 标签：java, android, gestures

我正在尝试追踪路径“A”

我遇到了创建手势的教程。

但我不知道如何仅针对指定部分启用此类手势。

手势也必须在特定路径上？如何设置这样的约束？

# debugging - 如何在 Visual Studio 2012 中打开 memory.dmp 文件

> ID：14965396
> 
> 赞同：4
> 
> 时间：2013-02-19T19:05:26.657
> 
> 标签：debugging, visual-studio-2012

在以前的 Visual Studio 版本中，可以打开 .dmp 文件。见链接：

[http://msdn.microsoft.com/en-us/library/fk551230(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/fk551230(v=vs.100).aspx)

但是该 MSDN 页面上的版本选择器组合中没有 VS 2012 的选项。根据经验，我无法在 2012 Ultimate 中打开这些文件，IDE 告诉我：

> 'C:\Windows\MEMORY.DMP' 没有可用的编辑器。确保已安装文件类型 (.DMP) 的应用程序。

我无法打开它并且没有记录支持的事实是巧合吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-11-15T02:02:44.203

您必须安装Windows SDK 的**调试工具**，它是**Windows SDK**的一部分。你可以只安装一个独立的*调试工具*，你不必安装整个 SDK。例如，请参阅以下资源：

*   [Windows 调试工具（WinDbg、KD、CDB、NTSD）](http://msdn.microsoft.com/library/windows/hardware/ff551063(v=vs.85).aspx)
*   [在 Visual Studio 中使用转储文件调试应用程序崩溃和挂起](http://msdn.microsoft.com/en-us/library/d5zhxt22.aspx)
*   [如何分析 BSOD 故障转储](http://www.instructables.com/id/How-to-Analyze-a-BSOD-Crash-Dump/)

您可以下载[适用于 Windows 的独立调试工具](http://msdn.microsoft.com/en-us/windows/hardware/hh852365)或整个[Windows SDK](http://msdn.microsoft.com/en-US/windows/desktop/bg162891)。

如果您只需要快速检查一个**[小型转储](http://support2.microsoft.com/kb/315263)**，您可以使用 Nirsoft 的强大的小型实用程序[BlueScreenView](http://www.nirsoft.net/utils/blue_screen_view.html)。它很简单，甚至不需要安装或任何依赖项（您不需要调试工具），并且可以显示 minidump 包含的所有内容。最好只是找出可能导致 BSOD 的原因，对于任何进一步的调试，请使用*Debugging Tools*。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-07-14T20:26:48.387

如果您希望在 Visual Studio 2013 中执行此操作，并且想知道为什么 Dawid 的答案似乎无法解决您的问题，您可能必须通过选择“文件->打开-”从 VS2013 中打开 DMP 文件>文件...”如果您双击。

我无法使用 VS2013 自动打开 DMP 文件，出现与 Puplett 相同的错误。

# java - libjpeg-turbo java 编码 jpeg

> ID：14965399
> 
> 赞同：0
> 
> 时间：2013-02-19T19:05:49.817
> 
> 标签：java, libjpeg-turbo, turbojpeg

我已经在我的 Mac 上安装了 libjpeg-turbo，并将 jar 和库添加到我的 eclipse 项目中。我试图从我的缓冲图像创建 jpeg byte[]：

```
TJCompressor tj = new TJCompressor();
tj.compress(image, TJ.PF_BGR); 
```

我得到的错误是： java.lang.Exception: tjBufSize(): Invalid argument

我使用自定义机器人创建类型为 TYPE_3BYTE_BGR 的缓冲图像。我可以使用 ImageIO 创建一个 byte[]，但速度很慢。

我试图找到一些关于 java 包装器的教程，但我没有找到任何从缓冲图像编码 jpeg 的教程。如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T17:25:39.263

您似乎将错误类型的参数传递给该方法。当您应该从`TJ`类中传递零个或多个标志（以“FLAG_”为前缀）时，您正在传递像素格式。对象会自动检测像素格式类型`TJCompressor`。

确保在使用之前将色度二次采样级别和 JPEG 质量设置为所需的级别`TJCompressor`。

示例代码：

```
TJCompressor tj = new TJCompressor();
tj.setJPEGQuality(75);
tj.setSubsamp(TJ.SAMP_420);
byte[] jpegBytes = tj.compress(image, 0); 
```

# java - 返回本地或远程的决定

> ID：14965402
> 
> 赞同：3
> 
> 时间：2013-02-19T19:05:52.707
> 
> 标签：java, jakarta-ee, ejb, jndi

我有一个简单的bean声明如下

```
 @Local(LocalInt.class)
 @Remote(RemoteInt.class)
 @Stateless(name="name")
 public MyEJB_Implementation {
    //methods
 } 
```

如您所见，它是一个具有本地接口（用于本地客户端）和远程接口（用于远程客户端）的单个 bean。

客户端（远程和本地）检索实例如下：

```
ctx = new InitialContext(environment);
ctx.lookup("name"); 
```

容器如何决定它是否将交付实现`LocalInt`接口或`RemoteInt`接口的代理？（因为我使用相同的“名称”进行查找）。

我的意思是，JNDI 注册表是否以某种方式知道查找是在同一个 JVM 中还是从远程服务器完成的？

而且，这种区别（对于本地和远程调用）是否与“查找”的语义相冲突？（它应该恰好为一个名称注册了零个或一个对象，在这种情况下，似乎有 2 个对象（本地和远程）在同一个名称下）。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T20:41:20.337

以我的经验，`local`当客户端在同一个容器（EAR 或 WAR）中时，容器将返回接口，而在它之外时将返回`remote`接口。

我不确定 Java EE 规范中是否将其声明为要求，但几乎所有标准容器都以这种方式运行（再次，根据我的经验）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T06:38:59.570

EJB 容器会将本地和远程接口绑定到不同的 JNDI 名称，因此这取决于您查找的名称。例如，在 EJB 3.1 中，标准绑定位置如下所示：

```
java:app/YourEJBModule/YourEJBName!com.your.pkg.LocalInt
java:app/YourEJBModule/YourEJBName!com.your.pkg.RemoteInt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T09:35:41.153

Jndi 是高度上下文相关的。即使您认为您使用的是绝对名称，它们通常也与您正在从中进行查找的当前组件相关。

我很惊讶“名称”有效。这实际上是为不同的命名空间（非 JNDI）设计的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T12:03:34.453

第 3 节中的 EJB 3.1 规范清楚地解释了本地和远程视图。在第 3.3.2 节中它说

> 会话 bean 可能有本地客户端。本地客户端是与会话 bean 并置在同一个 JVM 中的客户端，会话 bean 提供本地客户端视图并且可能与 bean 紧密耦合。会话 bean 的本地客户端可以是另一个企业 bean 或 Web 组件。通过本地客户端视图访问企业 bean 需要在同一 JVM 中配置本地客户端和提供本地客户端视图的企业 bean。因此，本地客户端视图不提供远程客户端视图提供的位置透明度。通过本地客户端视图访问企业 bean 只需要被打包在与提供本地客户端视图的企业 bean 相同的应用程序中的本地客户端支持。

那应该解释这种行为

# php - 添加时间 PHP

> ID：14965406
> 
> 赞同：0
> 
> 时间：2013-02-19T19:06:09.153
> 
> 标签：php

我正在尝试使用这些变量中捕获的开始时间和结束时间。我想将这些值加在一起以获得花费在各种任务上的总时间。所以我得到了这些值，并试图做这样的事情：

```
//start times
$time_1 = $_POST['start_of_service_1'];
$time_2 = $_POST['start_of_service_2'];
$time_3 = $_POST['start_of_service_3'];

//end times
$etime_1 = $_POST['end_of_service_1'];
$etime_2= $_POST['end_of_service_2'];
$etime_3 = $_POST['end_of_service_3'];

//total hours
$tot_hours_1 = date('H:i',strtotime($etime_1)-strtotime($time_1);
$tot_hours_2 = date('H:i',strtotime($etime_2)-strtotime($time_2));
$tot_hours_3 = date('H:i',strtotime($etime_3)-strtotime($time_3));

$totaltime = $tot_hours_1 + $tot_hours_2 + $tot_hours_3 
```

因此，如果时间跨度为每 5 分钟，则总计 00:05 + 00:05 + 00:05 = 00:15 分钟。

这些时间函数看起来很棘手，我遇到了可怕的麻烦和时间来克服这个障碍。

谁能给我建议如何实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:07:53.463

只需删除`date('H:i',`和对应的`)`. 这将为您留下可以相加的数字。格式化`date()`应该是你做的*最后一*件事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:09:15.423

您正在尝试添加`date formats`此行`$totaltime = $tot_hours_1 + $tot_hours_2 + $tot_hours_3`。`Time`无法使用 . 添加格式`+`。尝试仅添加纯数字，然后使用`date()`.

# google-maps - 如何自动关闭 InfoWindows

> ID：14965407
> 
> 赞同：0
> 
> 时间：2013-02-19T19:06:10.623
> 
> 标签：google-maps, google-maps-api-3

我将 google map api 用于我的个人网络照片库。对于每张带有 gps 坐标的图片，我在地图上添加了一个 Maker 对象和一个与标记关联的 InfoWindows 对象，以便在我用鼠标单击标记时显示缩略图。

我的问题：当我点击其他标记时如何自动关闭 InfoWindows？换句话说，当我点击一个标记时，我想关闭之前打开的所有其他 InfoWindows。

你可以在这里看到一些测试：http: [//avbo7291.o2switch.net/outils/test-google-map-api.html](http://avbo7291.o2switch.net/outils/test-google-map-api.html)

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:26:00.837

您可以使用 InfoWindow 的单个实例，只需在标记单击时设置新内容，如下所示：

```
var infowindow = new google.maps.InfoWindow();

google.maps.event.addListener(marker1, 'click', function() {
    infowindow.setContent("Hello World 1 !");
    infowindow.open(map, this);
});

google.maps.event.addListener(marker2, 'click', function() {
    infowindow.setContent("Hello World 2 !");
    infowindow.open(map, this);
}); 
```

然后您可以将点击事件附加到地图本身以关闭此信息窗口：

```
google.maps.event.addListener(map, 'click', function(){
    infowindow.close();
}); 
```

# javascript - 在 UIWebView 上定义事件

> ID：14965408
> 
> 赞同：0
> 
> 时间：2013-02-19T19:06:26.360
> 
> 标签：javascript, ios, xcode, uiwebview

请原谅我对 iOS 开发相当陌生（那将是非常新的）。

我刚刚实现了本机 Facebook 授权，现在我想将我的 access_token 传递给 UIWebView 中的本地 html 文件。为此，我在 html 文件中创建了一个 Javascript 对象，并带有一个接收 access_token 作为参数的 init 函数。现在我只需要从外部调用该函数。一些研究让我明白了`[UIWebView stringByEvaluatingJavaScriptFromString:(NSString *)]`——但在页面加载之前不应该调用它。

在我`ViewController.m`的定义`- (void)updateView`中，我在其中提出了一个请求，`webView`它是一个`UIWebView`. 我现在想在这个特定请求完成后立即执行一个 JavaScript 字符串。我怎么做？

```
- (void)updateView {
    AppDelegate *appDelegate = [[UIApplication sharedApplication]delegate];
    if (appDelegate.session.isOpen) {
        NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"http://mydomainwuhuu/mobile?o=Auth&accessToken=%@", appDelegate.session.accessToken]];
        NSURLRequest *request = [NSURLRequest requestWithURL:url];
        [webView loadRequest:request];
        [webView stringByEvaluatingJavaScriptFromString:@"window.alert('test')"];
    }
} 
```

这段代码没有这样做，我认为是因为我在页面加载完成之前调用了 JavaScript？我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:14:05.237

UIWebView 有委托方法，请参阅[此](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html)。对于您的情况，请使用`– webViewDidFinishLoad:`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:37:10.343

我以前也遇到过同样的问题。我最终只包含了一个“完成”按钮，并在 IBAction 按钮调用中包含了 stringbyevalatingjavascript 函数。

那时它奏效了。

# php - CakePHP 使用错误的序列名称 (PostgreSQL)

> ID：14965410
> 
> 赞同：2
> 
> 时间：2013-02-19T19:06:33.987
> 
> 标签：php, postgresql, cakephp, sequence, postgresql-9.1

当我尝试在 Postgres 表中保存一些信息时，CakePHP 为我返回此错误：

```
array(
    (int) 0 => '[PDOException] SQLSTATE[42P01]: Undefined table: 7 ERRO:  relaÃ§Ã£o "public.cashier_transaction_transaction_num_seq" nÃ£o existe
Request URL: /www/cashiers/open
Stack Trace: 
```

但是 CakePHP 是正确的：这个序列不存在。正确的顺序是**transaction_num_seq**。

如何更改**IN CAKE**（我无法更改数据库）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-22T17:59:43.550

**Postgres.php中的****describe($model)**函数似乎使用了一个未记录的可选属性

 **```
if (isset($model->sequence)) {
    $this->_sequenceMap[$table][$model->primaryKey] = $model->sequence;
} 
```

像这样使用它来指定表的主键的顺序。

```
public class YourModel extends AppModel {
    public $sequence = 'public.foobar_seq';
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T11:10:39.540

我发现修复此错误的唯一方法是在每个模型中创建一个名为“nextval ()”的操作，并运行默认的 PostgreSQL 查询以获取下一个序列。

```
public function nextval() {
    $sql = "select nextval('transaction_num_seq') as nextval";
    $result = $this->query($sql);
    return $result[0][0]['nextval'];
} 
```**

# javascript - Zurb Foundation Orbit 滑块 - 使非无限？

> ID：14965412
> 
> 赞同：3
> 
> 时间：2013-02-19T19:06:40.810
> 
> 标签：javascript, slideshow, zurb-foundation, orbit

Foundation 3 中的 Orbit 滑块是无限的，这意味着它会一遍又一遍地在其幻灯片中循环。

有没有办法让它只显示一次所有幻灯片，在最后一张幻灯片上停止？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:03:00.027

提供了一个方法（实际上存在于引用的文档@cuberoot 中），这是初始化代码：

```
$(window).load(function(){
    $("#featured").orbit({
       singleCycle: true // cycles through orbit slides only once
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T21:38:15.107

我会用 afterSlideChange 注册一个函数，检查它是否是最后一张幻灯片，然后调用 orbit.stopClock()

# character-encoding - XML 和 PHP file_get_contents 的字符编码问题

> ID：14965413
> 
> 赞同：0
> 
> 时间：2013-02-19T19:06:47.163
> 
> 标签：character-encoding, xml-parsing

我一直遇到来自 XML API 的字符编码问题，似乎无法解决问题。我想知道是否有人会知道该怎么做。我尝试了以下代码，它们都产生了一些奇怪的字符编码问题。

代码 #1

```
$xml_url = "http://myurl.com/123.xml";
$xml = simplexml_load_file($xml_url); 
```

密码 #2

```
$xml_url = "http://myurl.com/123.xml";
$contents = file_get_contents($xml_url);
$xml = new SimpleXMLElement($contents); 
```

撇号等一些字符出来的方式是这样的

```
strengthening resumÃ©s 
```

这有数百个错误。我的代码顶部看起来像这样

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
</head> 
```

我已经尝试将其删除并将其作为 HTML 5 放置，但我似乎什么也得不到。我尝试过其他拉丁字符编码等，但它变得越来越糟。有没有人对如何解决这个问题有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:44:15.960

当 UTF-8 编码文本`é`被视为 ISO-8859-1 编码文本时，它显示为`Ã©`.

如果我没记错的话，SimpleXML 仅适用于 UTF-8 编码的数据。因此，如果您的数据不是 UTF-8，您需要对您读入的所有文件以及添加到文档中的文本字符串进行编码（在对它们使用 SimpleXML 方法之前）。您可以使用`iconv()`or`utf8_encode()`进行转换。

如果您的代码包含非 ASCII 文字，还要检查代码文件的编码。

# javascript - Javascript返回值而不中断循环

> ID：14965424
> 
> 赞同：0
> 
> 时间：2013-02-19T19:07:30.830
> 
> 标签：javascript, parse.js

我的代码目前如下。我正在使用 Parse.Js 库。

```
while (i < workout) {

    return q.find({
        success: function (type) {
            if (type == 3) {
                typeCount++;
            }
        }
    });
    i++;
} 
```

问题是“返回”似乎阻止了其余功能的工作。有没有办法在不打破循环的情况下做到这一点？

我尝试一起删除返回，但是 q.find 代码没有运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:10:03.900

否。`return`结束函数的执行，中断所有循环、`if`块等。您可以将值存储在变量中并在最后返回（一旦循环完成），但`return`停止函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T19:10:08.080

没有，而不是“返回”，您可以将值添加到数组中，然后返回该数组。

# sql - tSQLt.FakeTable 似乎不适用于具有常量/派生字段的视图

> ID：14965427
> 
> 赞同：7
> 
> 时间：2013-02-19T19:07:36.407
> 
> 标签：sql, tsqlt

```
exec tSQLt.SetFakeViewOn 'dbo.viewWithIssues';
GO
CREATE PROCEDURE    TestChanges.[Test Data]
AS
BEGIN
...

exec tSQLt.FakeTable 'dbo.viewWithIssues', @identity=1, @ComputedColumns=1, @Defaults=1;
INSERT INTO dbo.viewWithIssues (clock_id, IsTerminated)
VALUES  ('1111', '0'), ('2222', '1'), ('3333', '1')

...
END
GO
exec tSQLt.SetFakeViewOff 'dbo.viewWithIssues';
GO 
```

然后在调用过程后继续填充#Actual 和#Expected。它返回的错误是：更新或插入视图或函数“dbo.viewWithIssues”失败，因为它包含派生或常量字段。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-19T19:19:04.150

问题是 SQL Server 在编译时捕获了这个，所以 FakeTable 永远不会被执行。这就是 SetFakeViewOn 应该捕获的，但是它目前不能可靠地工作。除了将插入和更新放入动态 SQL 之外，目前还没有真正干净的方法：

```
CREATE PROCEDURE    TestChanges.[Test Data]
AS
BEGIN
...

exec tSQLt.FakeTable 'dbo.viewWithIssues', @identity=1, @ComputedColumns=1, @Defaults=1;
EXEC('INSERT INTO dbo.viewWithIssues (clock_id, IsTerminated)'+
'VALUES  (''1111'', ''0''), (''2222'', ''1''), (''3333'', ''1'');');

...
END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-31T18:25:41.877

在一些朋友的帮助下，我能够解决这个问题！我将 tSQLt.FakeTable 命令移至 Setup.sql，因为 tSQLt 在该模式中的其他测试之前运行它。我们通过在同一个 sql 查询中运行 FakeTable 命令和 INSERT INTO 命令发现了这个异常。像这样：

```
EXEC [dbServername].tSQLt.FakeTable @TableName='vw_viewname', @SchemaName='dbo';
INSERT INTO     [dbServername].dbo.vw_myView
                (Column1, Column2, Column3, Column4, Column5, Column6, Column7)
VALUES          ( '100513','C','2018-12-13','2019-03-25','2014-10-27',' ',40.500,'3'); 
```

这将导致错误：[TestSchemaName].[Test usp_MyStuff_Get Get my stuff] failed: (Error) 更新或插入视图或函数“dbServername.dbo.vw_myView”失败，因为它包含派生或常量字段。

这有效：

```
CREATE PROCEDURE [TestSchemaName].[Setup]
AS
BEGIN
    IF @@TRANCOUNT > 0
        BEGIN
            EXEC [dbServername].tSQLt.FakeTable @TableName='vw_viewname', @SchemaName='dbo'
        END
    ELSE
        BEGIN
             RAISERROR('Procedure was run without tsqlt.Run. Aborting procedure', 16, 1)
        END

END 
```

```
CREATE PROCEDURE [TestSchemaName].[Test usp_MyStuff_Get Get my stuff]
AS
BEGIN
    IF @@TRANCOUNT > 0
        BEGIN
            --EXEC [dbServername].tSQLt.FakeTable @TableName='vw_viewname', @SchemaName='dbo'
            --I moved the line above to the Setup.sql

            INSERT INTO     [dbServername].dbo.vw_myView
                            (Column1, Column2, Column3, Column4, Column5, Column6, Column7)
            VALUES          ( '100513','C','2018-12-13','2019-03-25','2014-10-27',' ',40.500,'3')
       END
    ELSE
        BEGIN
            RAISERROR('Procedure was run without tsqlt.Run. Aborting procedure', 16, 1)
        END
END
GO 
```

发布项目，然后从 SSMS 运行：

```
EXEC tsqlt.run '[TestSchemaName].[Test usp_MyStuff_Get Get my stuff]' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-02T16:06:45.470

我建议您使用 insert 语句创建一个存储过程并在 exec 之后调用它`tSQLt.FakeTable`。

```
CREATE PROCEDURE    TestChanges.[Test Data]

AS
BEGIN
...
exec tSQLt.FakeTable 'dbo.viewWithIssues', @identity=1, @ComputedColumns=1, @Defaults=1;

execute TestChanges.[Insert into viewWithIssues]

...
END 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-25T15:57:23.510

正如塞巴斯蒂安所说，动态 SQL 是要走的路。如果有很多列（尤其是需要单引号的文本/日期类型），我使用这种模式：

1.  创建与视图具有相同定义的临时表
2.  填充临时表
3.  使用动态 SQL 将临时表中的数据复制到伪造的视图中

```
-- #1
SELECT TOP(0) *
INTO #tempView
FROM dbo.viewWithIssues

-- #2
INSERT INTO #tempView (clock_id, IsTerminated)
VALUES  ('1111', '0'), ('2222', '1'), ('3333', '1')

-- #3
EXEC ('INSERT INTO dbo.viewWithIssues SELECT * FROM #tempView') 
```

# jquery - 需要使用 span ID 更新 HTML 中的字段值

> ID：14965431
> 
> 赞同：0
> 
> 时间：2013-02-19T19:07:50.340
> 
> 标签：jquery

我在下面有 HTML java 代码...

```
<span id="total">
   <fmt:formatNumber value='${totalValue}' type="currency" maxFractionDigits="2"                         minFractionDigits="2"/>
</span> 
```

`${totalValue}`在进行一些计算后，我需要在 javascript 方法中更新一些值。

尝试过类似的东西`$('#total').set('${totalValue}', 'newValue');`

但不工作。请建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:12:15.673

为了选择命名空间的 xml 节点，您必须转义`:`.

```
$('#total').find('fmt\\:formatNumber').attr('value', 'newValue'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T12:45:16.653

您错过了导入 <%@taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%> 这就是 html 显示标签而不是它们的渲染器值的原因.

# c - 用字符串的一部分填充二维数组

> ID：14965436
> 
> 赞同：0
> 
> 时间：2013-02-19T19:08:00.883
> 
> 标签：c, arrays, string, token

我希望将我破坏的字符串的部分输入到二维数组中，例如： String: "one day" 数组中的结果： Col1: one Col2: day

问题是，如何用第`result2`1 列和`result`第 2 列的这两个变量填充数组？

到目前为止，这是我的代码（如您所见，我有一个单独的历史数组和一个用于保存用户输入部分的单独数组）：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main (int argc, char *argv[])
{
    int i=0; int j=0; int k=0;
    char inputString[100];
    char *result=NULL;
    char *result2=NULL;
    char delims[] = " ";
    char historyArray[100][100] = {0};
    char historyKey[] = "history";
    char *tokenArray[100][100] = {0} ;
    //char exitString[] = "exit";

    do
    {

             printf("hshell>");
             gets(inputString);
             strcpy (historyArray[k], inputString);
             k++;

             // Break the string into parts
             result = strtok(inputString, delims);

             while (result!=NULL)
             {
                   result2 = result;
                  puts(result);
                  result= strtok(NULL, delims);
                  for (int count = 0; count < k; count++)
                    tokenArray[count] = result2;
                  j++;
             }

              if (strcmp(inputString,historyKey) == 0) 
                {
                    for (i=0; i<k; i++)
                    {
                        printf("%d. %s \n",i+1,historyArray[i]);
                    }
                }  
                else if (strcmp ("exit",inputString) != 0)
                {
                    printf("\nCommand not found \n");
                }

    }while (strcmp ("exit", inputString) != 0);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:17:34.847

首先，听起来您需要一个单维数组作为输入：

```
 char tokenArray[100]; 
```

然后再往下，循环会这样做：

```
result = strtok(inputString, delims);

j = 0;
while (result!=NULL)
{
    strcpy(tokenArray[j++], result);
    puts(result);
    result= strtok(NULL, delims);
} 
```

试试这个提示，看看剩下的。

# google-apps-script - 如何使用谷歌应用脚 本删除/覆盖 CSV 文件？

> ID：14965442
> 
> 赞同：1
> 
> 时间：2013-02-19T19:08:30.827
> 
> 标签：google-apps-script

我的谷歌应用程序脚本将 csv 文件 [test.csv] 导入新选项卡，操作一些值，然后将操作的选项卡保存为 csv 文件 [test.csv]。当它保存新版本时，它只是制作另一个副本 [test(1).csv]。我希望覆盖以前的文件（或删除旧文件然后导出/写入新版本。）请帮忙？

我正在使用[Interacting With Docs List Tutorial中的参考代码](https://developers.google.com/apps-script/articles/docslist_tutorial)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-03-04T18:44:35.950

我知道这是一个老问题，但从那时起，已接受答案中的大部分信息已被 Google 弃用。DocsList 消失了，文件对象上的 clear() 和 append() 方法也消失了。

我使用以下函数来创建或覆盖文件：

```
// Creates or replaces an existing file
function updateFile (folder, filename, data) {
  try {
    // filename is unique, so we can get first element of iterator
    var file = folder.getFilesByName(filename).next()
    file.setContent(data)
  } catch(e) {
    folder.createFile(filename, data)
  }
} 
```

作为参考，这里有一些对文件夹执行相同操作的代码。它假设我们在当前工作表的父文件夹中进行操作，并且想要那里的新文件夹或现有文件夹的文件夹对象。

```
// Get folder under current folder. Create it if it does not exist
function getOrCreateFolder(csvFolderName) {
  var thisFileId = SpreadsheetApp.getActive().getId();
  var thisFile = DriveApp.getFileById(thisFileId);
  var parentFolder = thisFile.getParents().next();
  try {
    // csvFolderName is unique, so we can get first element of iterator
    var folder = parentFolder.getFoldersByName(csvFolderName).next();
    // asking for the folder's name ensures we get an error if the
    // folder doesn't exist. I've found I don't necessarily catch
    // an error from getFoldersByName if csvFolderName doesn't exist.
    fname = folder.getName()
  } catch(e) {
    var folder = parentFolder.createFolder(csvFolderName);
  }
  return folder
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T20:21:44.373

您可以这样做`DocsList.find(fileName)`，它会为您提供具有该名称的文件列表。如果文件名是唯一的，那么你可以只做`var file = DocsList.find(fileName)[0]`.

* * *

**如果您是 Google Apps 用户**，您可以使用`file.clear()`删除旧文件的所有内容，然后`file.append()`插入所有新内容。

* * *

**否则**，您将不得不`file.setTrashed(true)`然后`DocsList.createFile()`制作新的。

# android - DatagramSocket.receive 只接收前两个数据报

> ID：14965443
> 
> 赞同：0
> 
> 时间：2013-02-19T19:08:34.177
> 
> 标签：android, udp

我正在通过 UDP 向 android 应用程序发送一些数据。因此，我创建了以下 UDPReceiver-Class：

```
package com.example.urowatch;

import java.net.*;
import java.nio.ByteBuffer;
import java.io.*;

public class UDPReceiver extends Thread
{
private DatagramSocket m_Socket;
private int m_BufferSize;
private Boolean m_End = false;

private int m_TotalLength;
private int m_Received;
private byte[] m_Buffer;

private byte[] m_Result;
private Boolean m_IsNewResult = false;

private float m_Progress;

private int m_ImageCount = 0;
private int m_FrameErrors = 0;

public UDPReceiver(String name, int port, int bufferSize) throws IOException
{
    super(name);

    m_Socket = new DatagramSocket(port);
    m_BufferSize = bufferSize;
    m_Socket.setBroadcast(true);
    m_Socket.setReceiveBufferSize(m_BufferSize);
}

public void run()
{
    while(!m_End)
    {
        try
        {
            byte[] buf = new byte[m_BufferSize];
            DatagramPacket packet = new DatagramPacket(buf, buf.length);
            m_Socket.receive(packet);
            ProcessData(packet);
        }
        catch (IOException e)
        {
            if (!m_Socket.isClosed())
                e.printStackTrace();
        }
    }
}

private void ProcessData(DatagramPacket packet)
{
    if (packet.getLength() == 4)
    {
        ByteBuffer bb = ByteBuffer.wrap(packet.getData());
        m_TotalLength = bb.getInt();
        if (m_Received != 0)
            m_FrameErrors++;
        m_Received = 0;
        m_Buffer = new byte[m_TotalLength];
    }
    else if (m_Buffer != null && m_Received != m_TotalLength)
    {
        int length = packet.getLength();
        System.arraycopy(packet.getData(), 0, m_Buffer, m_Received, length);
        m_Received += length;
        m_Progress = 100 * (float)m_Received/(float)m_TotalLength;

        if (m_Received == m_TotalLength)
        {
            m_Result = new byte[m_TotalLength];
            System.arraycopy(m_Buffer, 0, m_Result, 0, m_TotalLength);
            m_IsNewResult = true;
            m_ImageCount++;
            m_Received = 0;
        }
    }
}

public Boolean IsNewResult()
{
    return m_IsNewResult;
}
public byte[] GetResult()
{
    m_IsNewResult = false;
    return m_Result;
}
public float GetProgress()
{
    return m_Progress;
}
public float GetRatio()
{
    return 100 * (float)m_ImageCount / (float)m_FrameErrors;
}

public void stopServer()
{
    m_End = true;
    if (m_Socket != null)
        m_Socket.close();
}
} 
```

我正在使用这个类：

```
package com.example.urowatch;

import java.io.IOException;
import java.text.DecimalFormat;

import android.os.*;
import android.app.Activity;
import android.app.AlertDialog;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.ImageView;
import android.widget.TextView;
import android.widget.Toast;
import android.support.v4.app.NavUtils;
import android.annotation.TargetApi;
import android.content.Context;
import android.graphics.BitmapFactory;
import android.os.Build;

public class LiveActivity extends Activity {
private static ImageView m_ImageView1;
private static TextView m_TextView1;
private static DecimalFormat m_DF;
private static Context m_Context;
private UDPReceiver m_Receiver;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_live);
    // Show the Up button in the action bar.
    setupActionBar();

    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);

    m_ImageView1 = (ImageView)findViewById(R.id.imageView1);
    m_TextView1 = (TextView)findViewById(R.id.textView1);
    m_Context = this;

    m_DF = new DecimalFormat("00.00");
}

/**
 * Set up the {@link android.app.ActionBar}, if the API is available.
 */
@TargetApi(Build.VERSION_CODES.HONEYCOMB)
private void setupActionBar() {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
        getActionBar().setDisplayHomeAsUpEnabled(true);
    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.live, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case android.R.id.home:
        // This ID represents the Home or Up button. In the case of this
        // activity, the Up button is shown. Use NavUtils to allow users
        // to navigate up one level in the application structure. For
        // more details, see the Navigation pattern on Android Design:
        //
        // http://developer.android.com/design/patterns/navigation.html#up-vs-back
        //
        NavUtils.navigateUpFromSameTask(this);
        return true;
    }
    return super.onOptionsItemSelected(item);
}

private static Handler MyHandler = new Handler()
{
    @Override
    public void handleMessage(Message msg)
    {
        if (msg.what == 100)
        {
            float[] infos = (float[])msg.obj;
            m_TextView1.setText("Empfange Bild: " + m_DF.format(infos[0]) + "% (FrameErrors: " + m_DF.format(infos[1]) + "%)");
        }
        else if (msg.what == 101)
        {
            byte[] b = (byte[])msg.obj;
            m_TextView1.setText("Empfange Bild: 100,00%");
            m_ImageView1.setImageBitmap(BitmapFactory.decodeByteArray(b, 0, b.length));
        }
        else if (msg.what == 102)
        {
            AlertDialog.Builder b = new AlertDialog.Builder(m_Context);
            b.setTitle("Fehler");
            b.setMessage("Es ist folgende Exception aufgetreten:\n" + (Exception)msg.obj);
            b.setNeutralButton("OK", null);
            b.show();
        }
    }
};

@Override
public void onBackPressed() {
    super.onBackPressed();
    if (m_Receiver != null)
        m_Receiver.stopServer();
    finish();
}

@Override
public void onPause()
{
    m_Receiver.stopServer();
    super.onPause();
}

@Override
protected void onResume()
{
    try {
        m_Receiver = new UDPReceiver("UDPReceiver", 5678, 1024);
        m_Receiver.start();
    } catch (IOException e1)
    {
        // TODO Auto-generated catch block
        e1.printStackTrace();

        AlertDialog.Builder b = new AlertDialog.Builder(this);
        b.setTitle("Fehler");
        b.setMessage("Es ist folgende Exception aufgetreten:\n" + e1);
        b.setNeutralButton("OK", null);
        b.show();
    }

//      Thread thread = new Thread()
//      {
//          @Override
//          public void run()
//          {
//              while(true)
//              {
//                  try {
                    //sleep(250);
                    Toast.makeText(getBaseContext(), "Runing Thread", Toast.LENGTH_SHORT).show();
                    Update();

//                  } catch (InterruptedException e) {
//                      // TODO Auto-generated catch block
//                      e.printStackTrace();
//                      MyHandler.sendMessage(MyHandler.obtainMessage(102, e));
//                  }

//              }
//          }
//      };
//      thread.start();
    super.onResume();
}

public void buttonClick(View v)
{
    Update();
}

private void Update()
{
    if (m_Receiver != null)
    {                               
        if (m_Receiver.IsNewResult())
        {
            byte[] b = m_Receiver.GetResult();
            MyHandler.sendMessage(MyHandler.obtainMessage(101, b));
        }
        else
        {
            float[] infos = new float[2];
            infos[0] = m_Receiver.GetProgress();
            infos[1] = m_Receiver.GetRatio();
            MyHandler.sendMessage(MyHandler.obtainMessage(100, infos));
        }
    }
}
} 
```

如您所见，我想通过线程检查 UDPReceiver-Object 的状态（是否有新的完整字节 [] 准备好？）。要更新 GUI，线程必须向 MyHandler 发送一条消息，该消息将更新 GUI。

此刻我必须单击一个按钮来引发 buttonClick-Event。稍后我想在注释的线程结构中执行此操作。

现在，这是我的问题：我启动了 Activity，一切正常。然后我开始用我的 UDP-Sender 手动发送一个数据包（它有效，我用 C#-UDP-Receiver 验证了它）。第一个数据包收到很好。然后我也发送接收到的第二个数据包。但从现在开始，我的断点在 m_Socket.receive(packet); 不会再被击中了！

我不知道这种行为是什么原因造成的，让这个应用程序工作对我来说非常重要。请，如果您有任何想法或只是猜测，请告诉我。

# wordpress - Wordpress：如何设置 /blog/post-title 永久链接？

> ID：14965447
> 
> 赞同：0
> 
> 时间：2013-02-19T19:08:45.490
> 
> 标签：wordpress

我在根目录下安装了一个 WP 实例。我想将博客文章放在标签或类别中（以最好的为准），以便通过以下方式访问它们：

```
domain.tld/blog/post-title 
```

这可能非常简单，但我能做到这一点的唯一方法是在永久链接中使用“类别”（或其他单词），如下所示：

```
domain.tld/category/blog/post-title 
```

我敢肯定这很简单。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:19:13.840

如果我正确理解您的问题，我相信您只需要转到 wp-admin => settings => Permalinks 并添加自定义结构

```
/%category%/%postname%/ 
```

# asp.net-mvc - 如何将 ASP.NET 和 Web Tools 2012.2 中的新功能添加到现有项目中？

> ID：14965449
> 
> 赞同：0
> 
> 时间：2013-02-19T19:08:49.217
> 
> 标签：asp.net-mvc, visual-studio-2012, knockout.js, asp.net-web-api, nuget

因此，Microsoft 发布了 Web Tools 的新更新。 [Web Tools 2012.2 Scot Gu Blog](http://weblogs.asp.net/scottgu/archive/2013/02/18/announcing-release-of-asp-net-and-web-tools-2012-2-update.aspx) 但是它的设计方式，它不会更新当前项目，我想更新当前项目，但不确定如何去做。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:16:19.287

You can update all of the javascript libraries that are added by default in the new templates using NuGet. You can add in the new features, such as SignalR and Web API Tracing using NuGet too.

Basically, NuGet is your friend. :)

# javascript - 检查两个对象在javascript中是否都未定义或为空

> ID：14965450
> 
> 赞同：0
> 
> 时间：2013-02-19T19:08:51.173
> 
> 标签：javascript, null, undefined, logical-operators

我有一个方法 hitTest 可以检查碰撞检测并可以返回一个 Point 对象（如果发生碰撞）或（如果没有碰撞）它返回`null`或`undefined`（我还没有深入了解它何时返回 null 或 undefined 但我相信铬控制台）。

我必须测试 2 个物体的碰撞。并检查是否发生了一次或两次碰撞。我试过这段代码：

```
var result1 = hitTest(player, object1);
var result2 = hitTest(player, object2);
if( result1 || result2 )  { blabla() }; 
```

但它不起作用。

现在..我知道 js 确实是一种棘手的语言，我想了一个聪明的方法来做到这一点，而无需编写`typeof`4 次。我正在考虑python短路逻辑运算符...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:25:48.233

您可以使用`&&`，它返回第一个检测到的`false/null/undefined/0`，即`if`不会通过，如果`result1`要么`result2`是`null`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:26:54.357

对于这种类型的东西，underscore.js 很漂亮： [http](http://underscorejs.org/#isNull) ://underscorejs.org/#isNull 和 [http://underscorejs.org/#isUndefined](http://underscorejs.org/#isUndefined)

我经常使用这些助手来解决 JS 中的边缘情况，比如你提到的那些

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T19:39:11.233

你不需要写`typeof`4 次，但无论如何；

条件语句和运算符的强制范式：

```
//TYPE           //RESULT
Undefined        // false
Null             // false
Boolean          // The result equals the input argument (no conversion).
Number           // The result is false if the argument is +0, −0, or NaN; otherwise the result is true.
String           // The result is false if the argument is the empty String (its length is zero); otherwise the result is true.
Object           // true 
```

来自 Mozilla：

**逻辑与 ( `&&`)**

> **expr1 && expr2**
> *如果第一个操作数 ( `expr1`) 可以转换为`false`，则`&&`运算符返回`false`而不是 的值`expr1`。*

**逻辑或 ( `||`)**

> **expr1 || expr2** *返回`expr1`是否可以转换为`true`; 否则，返回`expr2`。因此，当与布尔值一起使用时，如果任一操作数为;`||`则返回 true `true`如果两者都是`false`，则返回`false`。*

```
true || false // returns true
true || true // returns true
false || true // returns true
false || false // returns false
"Cat" || "Dog"     // returns Cat
false || "Cat"     // returns Cat
"Cat" || false     // returns Cat

true && false // returns false
true && true // returns true
false && true // returns false
false && false // returns false
"Cat" && "Dog" // returns Dog
false && "Cat" // returns false
"Cat" && false // returns false 
```

此外，您可以使用`isset()`类似于 PHP 中的快捷方法来正确验证您的对象：

```
function isSet(value) {
    return typeof(value) !== 'undefined' && value != null;
} 
```

所以; 你的代码是：

```
var result1 = hitTest(player, object1),
    result2 = hitTest(player, object2);
if ( isSet(result1) && isSet(result2) )  { blabla(); }; 
```

# c# - 如何根据 cookie 值设置面板的可见性

> ID：14965451
> 
> 赞同：0
> 
> 时间：2013-02-19T19:08:56.330
> 
> 标签：c#, asp.net, panel

我有一个向用户展示基本信息的网页和两个小部件插件；该页面允许通过单击显示/隐藏按钮来显示和/或隐藏任一小部件（那里都很好）。然后用户可以通过单击将页面内容（主面板）存储到 cookie 中的保存按钮来保存页面（这里有问题）。页面的整个内容部分存储在主面板控件中，两个小部件位于它们自己的面板控件中（请参阅下面的设计代码）：

...设计：

```
<asp:Panel ID="pnlSaveContent" runat="server"> //master panel
   <asp:panel ID="pnlWeatherAppCtrl" runat="server">
        <div id="weatherwidget"> 
          <!-- the widget code for displaying the weather app -->
         </div>
   </panel>
   <asp:Panel ID="pnlStockAppCtrl" runat="server">
          <div id="stockwidget">
         <!-- the widget code for displaying the stock app -->
           </div>
   </panel>
  <div>   <!-- save button -->
       <asp:Button ID="savButton" runat="server" Text="Save Page" onclick="savButton_Click" />
  </div>   
</panel>  <!--end master panel--> 
```

我让页面正常工作，因此当用户单击显示或隐藏按钮时，相应的小部件部分变得可见或不可见，但是当单击保存按钮并且页面离开然后返回时，两个小部件仍将显示。这是我保存按钮的代码：

...代码：

```
protected void savButton_Click(object sender, EventArgs e)
    {
        HttpCookie c = Request.Cookies["preferences"];
        if (c != null)
        {
            c.Values["savePg"] = pnlSaveContent.ID;
            c.Expires = DateTime.MaxValue;
            Response.Cookies.Add(c);
        }

    } 
```

有人可以就如何根据 cookie 值设置面板的可见性提供一些指导吗？谢谢

# html - 为什么我的 CSS 样式会覆盖我的内联样式？

> ID：14965453
> 
> 赞同：1
> 
> 时间：2013-02-19T19:09:05.960
> 
> 标签：html, css

我的`<input type=image>`内联宽度/高度被我的`input`样式覆盖。有没有办法纠正这个问题？还是内联样式在这种情况下不起作用？

HTML：

```
<form id="search" name="search" form method="get" action="find_search.php">
    <input type=  "text" name=     "q" value=""  />
    <input type="hidden" name=   "cat" value=""  />
    <input type="hidden" name=  "time" value="0" />
    <input type="hidden" name="letter" value=""  />
    <input type="hidden" name="offset" value="0" />
    <input type="hidden" name=  "type" value="quick" />
    <input type= "image" src="images/search_button.png" value="Search" width="200" height="50" />
</form> 
```

CSS：

```
input {
   width:50%;
   padding:0px;
   outline:none;
   height:36px;
   font-size:24px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:11:09.967

您可以通过使用更具体的 CSS 选择器（如`input[type=text]`和）来完成此操作`input[type=image]`。因此，如果您希望问题中指定的高度/宽度仅适用于`<input type="text">`，您可以执行以下操作：

将非高度/宽度属性保留在不太具体的`input`选择器中：

```
input {
   padding:0px;
   outline:none;
   font-size:24px;
} 
```

然后使用`input[type=text]`选择器中的高度/宽度属性：

```
input[type=text] {
   width:50%;
   height:36px;
} 
```

然后您可以为选择器添加不同的高度/宽度`input[type=image]`：

```
input[type=image] {
   width: 200px;
   height: 50px;
} 
```

另外，请记住，如果您在选择器中使用`id`of ，您可以使选择器更加具体`form`，如下所示：

*   `#search input`
*   `#search input[type=text]`
*   `#search input[type=image]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:14:31.367

I personally would use classes such as:

```
 <form id="search" name="search" form method="get" action="find_search.php">

    <input class="input" type=  "text" name=     "q" value=""  />
    <input type="hidden" name=   "cat" value="" />
    <input type="hidden" name=  "time" value="0" />
    <input type="hidden" name="letter" value="" />
    <input type="hidden" name="offset" value="0" />
    <input type="hidden" name=  "type" value="quick" />
    <input class="button" type="image" src="images/search_button.png"  value="Search"  width="200" height="50"
  />

  </form>

.input
{
   width:50%;
   padding:0px;
   outline:none;
   height:36px;
   font-size:24px;
}
.button{
   /*your button CSS*/
} 
```

# asp.net-mvc - Linq 左外连接无法使用 DefaultIfEmpty

> ID：14965454
> 
> 赞同：4
> 
> 时间：2013-02-19T19:09:08.017
> 
> 标签：asp.net-mvc, asp.net-mvc-3, linq, entity-framework-4

使用 MSDN 文章[“如何：执行左外连接（C# 编程指南）”](http://msdn.microsoft.com/en-us/library/vstudio/bb397895.aspx)中的技术，我尝试在我的 Linq 代码中创建左外连接。文章提到使用该`DefaultIfEmpty`方法从组连接创建左外连接。基本上，它指示程序包含左（第一个）集合的结果，即使右集合中没有结果。

然而，这个程序的执行方式，就好像没有指定外连接一样。

在我们的数据库中，`AgentProductTraining`是我们的代理所学课程的集合。通常，如果不将相应的值输入到表中，您就无法将 a 输入`Course`到相应的`CourseMaterials`表中。但是，有时可能会发生这种情况，因此我们希望确保即使在 a`Course`中列出`AgentProductTraining`而没有任何相应信息的情况下也能返回结果`CourseMaterials`。

```
var training = from a in db.AgentProductTraining
    join m in db.CourseMaterials on a.CourseCode equals m.CourseCode into apm
    where
        a.SymNumber == id 
        from m in apm.DefaultIfEmpty()
        where m.EffectiveDate <= a.DateTaken
        && ((m.TerminationDate > a.DateTaken) | (m.TerminationDate == null))
            select new
            {
                a.AgentProdTrainId,
                a.CourseCode,
                a.Course.CourseDescription,
                a.Course.Partner,
                a.DateTaken,
                a.DateExpired,
                a.LastChangeOperator,
                a.LastChangeDate,
                a.ProductCode,
                a.Product.ProductDescription,
                m.MaterialId,
                m.Description,
                a.Method
            }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:17:01.900

MSDN 示例使用了一个新变量`subpet`：

```
var query = from person in people
                    join pet in pets on person equals pet.Owner into gj
                    from subpet in gj.DefaultIfEmpty()
                    select new { person.FirstName, PetName = (subpet == null ? String.Empty : subpet.Name) }; 
```

`submat`所以你必须使用你自己的“子宠物”，我使用变量重写了你的代码：

```
 var training = from a in db.AgentProductTraining
                       join m in db.CourseMaterials on a.CourseCode equals m.CourseCode into apm
                       where
                           a.SymNumber == id
                           from submat in apm.DefaultIfEmpty()
                           where 
                           (submat.EffectiveDate <= a.DateTaken || submat.EffectiveDate == null) &&
                           (submat.TerminationDate > a.DateTaken || submat.TerminationDate == null)
                       select new
                                  {
                                      a.AgentProdTrainId,
                                      a.CourseCode,
                                      a.Course.CourseDescription,
                                      a.Course.Partner,
                                      a.DateTaken,
                                      a.DateExpired,
                                      a.LastChangeOperator,
                                      a.LastChangeDate,
                                      a.ProductCode,
                                      a.Product.ProductDescription,
                                      MaterialId = (submat==null?-1:submat.MaterialId),
                                      Description = (submat==null?String.Empty:submat.Description),
                                      a.Method
                                  }; 
```

# php - 域对象工厂是什么样的？

> ID：14965461
> 
> 赞同：3
> 
> 时间：2013-02-19T19:09:22.913
> 
> 标签：php, oop, domain-driven-design, factories

我有一个`DataMapperFactory`，我认为我做对了，有一个很有意义，但我也有一个`DomainObjectFactory`，但这似乎毫无意义。就是这个：

```
namespace libs\factories;
use models as Models;

class DomainObjectFactory {

    public function build($name) {

        $className = 'Models\\' . $name;

        return new className();

    }

} 
```

我能看到的唯一优点是我可以防止`new`操作员出现在我的代码中。

必须有`DomainObjectFactory`比这更多的权利吗？

任何帮助都会非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T19:46:09.643

使用工厂有几个主要原因：

### 1.抽象对象的创建

当涉及到单元测试时，这是架构中最有用的结构之一。让工厂负责实例的创建可以更容易地在测试时引入模拟。

此外，作为额外的好处，您不再与您使用的类的名称紧密耦合。

### 2.简化实例化

在这里，您必须考虑两个方面。首先 - 基于某些条件实例化不同对象的能力 - 在[helmbert 的回答中已经很好地描述了](https://stackoverflow.com/a/14965677/727208) [^(（+1 为他）)]。

另一种情况是当您实例化域对象时，这更复杂。像这样的东西：

```
$employees = new EmployeeCollection;
$address = new Location;
$class = $type . `Company`;
$company = new $class( $employee, $address ); 
```

在创建`HoldingCompany`. 但是这整个过程可以在工厂内完成。特别是如果您的域对象工厂充分利用正确实现的 DIC（顺便说一句，这非常罕见）。

### 3\. 在应用程序中释放对象之前准备它们

您**永远**不应该在构造函数中进行任何计算。无法测试该代码。构造函数应该只包含简单的变量赋值。

但这引入了一个问题：有时您需要做一些逻辑操作，然后才能让其他代码结构来处理您的实例化对象。作为初学者，我们通常在构造函数中这样做。但是现在放在哪里呢？

这就是工厂来救援的地方。

```
public function create( $name )
{
     $instance = new $name;
     if ( is_callable($instance, false, 'prepare') )
     {
         $instance->prepare();
     }
     return $instance;
} 
```

现在，当您使用 时`$factory->create('foobar')`，您的对象已完全准备好使用。

* * *

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T19:22:55.857

通常，您可以使用工厂从特定实现中**抽象出来。**如果使用`new <classname>`运算符，则每次都实例化一个特定的类。如果您想稍后将此类与另一个实现互换，则必须手动更改每个`new`语句。

工厂模式允许您从特定的类中**抽象出来。**一个有效的最小用例可能是这样的：

```
interface UserInterface {
    public function getName();
}

class UserImplementationA implements UserInterface {
    private $name;
    public function getName() { return $this->name; }
}

class UserImplementationB implements UserInterface {
    public function getName() { return "Fritz"; }
}

class UserFactory {
    public function createUser() {
        if (/* some condition */) return new UserImplementationA();
        else                      return new UserImplementationB();
    }
}

$f = new UserFactory();
$u = $f->createUser();   // At this point, you don't really have to care 
                         // whether $u is an UserImplementationA or
                         // UserImplementationB, you can just treat it as
                         // an instance of UserInterface. 
```

当这变得非常有用时，一个（许多）用例是在使用单元测试时。在测试驱动开发中，您经常用**模拟对象**（实现特定接口但实际上不做任何事情的对象）替换类的依赖关系。使用工厂模式，很容易用模拟类透明地替换特定类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T19:11:39.657

```
public function build($name) {

        $className = 'Models\\' . $name;

        return new $className();
} 
```

那对你有用。

定义对象工厂是一种很好的做法，当您想为对象设置一些默认属性时，您也不必担心某个类存在于哪个命名空间或目录中。

例子：

```
public function createButton($name){
    require("home/lib/display/Button.php") ;

    $button = new Button($name, "some default param") ;
    $button->visible = true ;
    return $button ;
} 
```

除了保持消息外，您只需通过此类工厂如此快速地制作默认对象`new`。

# java - 如何在 Groovy 中处理动态 JSON 元素

> ID：14965466
> 
> 赞同：2
> 
> 时间：2013-02-19T19:09:40.843
> 
> 标签：java, grails, groovy

我有类似于此的 JSON：

> {"test":{"red":"on","green":"off","yellow":"on"},"test1":{"red":"off","green":"on ","黄色":"off"},"test2":{"red":"on","green":"off","yellow":"off"}}

我用下面的代码对此进行了迭代：

```
 JSONObject t = JSON.parse(params.myObject)

    t.each { id, data ->
        println id
        println data.red
        println data.green
        println data.yellow
    } 
```

但是，有时我可以在 JSON 对象中动态地拥有不同的值。例如（添加了新颜色）：

{"test":{"red":"on","green":"off","yellow":"on","pink":"on"},"test1":{"red":"off ","green":"on","yellow":"off","pink":"on"},"test2":{"red":"on","green":"off","yellow ":"关","粉色":"开"}}

**问题**

有没有一种方法可以遍历所有 json 而无需在我的代码中对颜色进行硬编码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:24:37.760

```
JSONObject t = JSON.parse(params.myObject)
t.each { id, data ->
    println id
    data.each { prop, value ->
       println prop + " = " + value
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:23:38.437

我想到了。

我可以简单地以类似的方式迭代这些值：

```
 t.each { id, data ->
        println id
        data.each {id1, d ->
            println id1
            println  d
        }
    } 
```

# c# - 如何确保实体框架将以多对多关系而不是新记录创建关联？

> ID：14965471
> 
> 赞同：2
> 
> 时间：2013-02-19T19:09:48.317
> 
> 标签：c#, entity-framework, many-to-many

我对实体框架有疑问....我不太了解。

我正在处理一项看似简单的任务，即将**现有联系人**与我正在处理的系统中的**新订单相关联。**在与订单关联之前，联系人将始终存在。

简化的数据库表...

**订单**
OrderID
状态已
创建

**联系人 联系人**
ID
名字
姓氏

**ContactToOrderMap**
OrderID
ContactID

我已经在 DbContext 中链接了这两个表。

```
 modelBuilder.Entity<Order>()
                .HasMany<Contact>(a => a.Contacts)
                .WithMany()
                .Map(a =>
                    {
                        a.ToTable("ContactToOrderMap");
                        a.MapLeftKey("OrderID");
                        a.MapRightKey("ContactID");
                    }); 
```

我编写了一个单元测试，它简单地创建一个订单，一个联系人，将联系人添加到订单上的列表成员并尝试保存。

```
// setup 
var order = new Order() { // initialize required fields };

// add a contact that already exists in the database
var orderContact = new Contact() { ID = 2 }; 
order.Contacts.Add(orderContact);

// call
logic.Save(ref order); 
```

最终，在执行了一些不相关的业务逻辑之后，这个订单被保存了......

```
// Add to collection
_db.Orders.Add(obj);
// Commit changes
_db.SaveChanges(); 
```

**>> 在这里，我收到与联系人表上所需数据库字段相关的错误。** 不是我要找的，因为我真的只想在 ContactToOrderMap 表中添加一个关联记录。

下一步，我尝试在保存订单之前从数据库中检索现有联系人。这段代码不是很干净，但它应该解释我正在尝试什么。

```
 if (currentOrder.Contacts != null)
    {
        var matchedContacts = new List<Contact>();

        foreach (var con in currentOrder.Contacts)
        {
            matchedContacts.Add(_contactLogic.Get(con.ID));
        }

        currentOrder.Contacts.Clear();
        foreach (var item in matchedContacts)
        {
            currentOrder.Contacts.Add(item);
        }
    } 
```

这创建了关联，**但也创建了一个新的联系人（新的唯一 ID）。**

目标是仅创建关联和新订单，而不是创建新联系人。

有什么想法或指示可以让我朝着正确的方向前进吗？

如果需要其他信息，请告诉我。

编辑：固定代码 - 将 obj 重命名为 currentOrder。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T20:49:04.343

线后

```
var orderContact = new Contact() { ID = 2 }; 
```

做

```
_db.Contacts.Attach(orderContact); 
```

现在联系人是一个`Unchanged`状态的上下文的一部分，并且

```
order.Contacts.Add(orderContact); 
```

不会再改变它的状态`Added`。

# casperjs - 使用填充方法时，如何选择要按下的按钮？

> ID：14965474
> 
> 赞同：3
> 
> 时间：2013-02-19T19:09:56.223
> 
> 标签：casperjs

我想填写表格，然后按特定按钮。是否可以使用[casper.fill](http://casperjs.org/api.html#casper.fill)方法选择按钮？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T23:42:59.917

不是直接用`fill()`方法，而是用`click()`一个：

HTML：

```
<form name="plop">
    <input type="text" name="q">
    <input type="submit" name="foo" value="Foo!">
    <input type="submit" name="bar" value="Bar!">
</form> 
```

卡斯帕脚本：

```
// casperjs script
casper.fill('form[name="plop"]', {
    q: 'yeah',
});
casper.click('input[type="submit"][name="bar"]'); 
```

# jquery - HTML 中的简码，如 Wordpress

> ID：14965479
> 
> 赞同：-1
> 
> 时间：2013-02-19T19:10:03.823
> 
> 标签：jquery, html, shortcode

有没有一种有效的方法可以将多个 div 放在一个类中。就像一个简码。例如; 我写，但它会包含。可能吗？抱歉英语不好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:18:31.453

我注意到您在问题中将 jQuery 作为标签。使用 jQuery 您可以做到这一点

HTML

```
<div class="box"></div> 
```

jQuery

```
$('.box').append('<div class="heading"></div><div class="paragraph"></div><div class="bottom"></div>'); 
```

但显然这只会在页面加载后发生。

[http://jsfiddle.net/uL9LT/](http://jsfiddle.net/uL9LT/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T19:12:18.250

不，HTML 没有提供基于类创建额外元素的方法。

听起来您最好使用某种形式的模板语言。

例如，使用[模板工具包](http://template-toolkit.org/)：

# 盒子.tt

```
<div class="heading"><div class="paragraph"><div class="bottom">
[% content %]
</div></div></div> 
```

# 页面.tt

```
[% WRAPPER box.tt %]
Your content here
[% END %] 
```

# TT的输出：

```
<div class="heading"><div class="paragraph"><div class="bottom">

Your content here

</div></div></div> 
```

* * *

[伪元素](http://www.w3.org/TR/selectors/#gen-content)也可能会为您服务。它们听起来不太适合您的问题，但是您没有清楚地解释您的用例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:13:32.020

... 可以指定多个类，但必须用空格分隔

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-19T19:19:25.820

这是一个使用多个类的示例，其中红色类可以控制颜色。

```
<div class="red box">A</div>
<div class="red heading">B</div>
<div class="red paragraph">C</div>
<div class="red bottom">D</div> 
```

# cakephp - HABTM 并检索所有没有特定模型 B 的模型 A

> ID：14965481
> 
> 赞同：1
> 
> 时间：2013-02-19T19:10:14.117
> 
> 标签：cakephp, cakephp-2.1

我有 3 张桌子：`users`, `specialities`, `specialities_users`.

```
User HABTM Speciality
Speciality HABTM User
SpecialitiesUser belongsTo Speciality,User 
```

我也有模型`SpecialitiesUser`。

当我想为给定用户获取专业知识时，我可以通过

```
SpecialitiesUser->find('all' array('conditions' => array('user_id' => $given_user_id)); 
```

现在我想获取用户不属于的所有专业。我如何在 Cake 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T02:48:23.200

以下代码中的`$other_specialities`变量应该是您想要的：

```
$the_users_specialities = $this->SpecialitiesUser->find('list', array(
    'conditions' => array(
        'SpecialitiesUser.user_id' => $given_user_id
    ),
    'fields' => 'SpecialitiesUser.speciality_id'
));

$other_specialities = $this->Speciality->find('all', array(
    'conditions' => array(
        'NOT' => array(
            'Speciality.id' => $the_users_specialities
        )
    )
)); 
```

**更新：**这是使用单个查询的方法：

```
$db = $this->Speciality->getDataSource();

$sub_query = $db->buildStatement(
    array(
        'fields' => array('`SpecialitiesUser`.`speciality_id`'),
        'table' => $db->fullTableName($this->SpecialitiesUser),
        'alias' => 'SpecialitiesUser',
        'conditions' => array('`SpecialitiesUser`.`user_id`' => $given_user_id),
    ),
    $this->Speciality
);

$other_specialities = $this->Speciality->find('all', array(
    'conditions' => array(
        $db->expression('`Speciality`.`id` NOT IN (' . $sub_query . ')')
    )
)); 
```

# deployment - 将 Subrepos 部署到 Appharbor

> ID：14965483
> 
> 赞同：0
> 
> 时间：2013-02-19T19:10:15.610
> 
> 标签：deployment, mercurial, bitbucket, appharbor, mercurial-subrepos

我正在尝试在 appharbor 上为托管在 bitbucket 上的代码设置部署。我有许多使用我拥有的库项目的项目，所以我使用 subrepos 来保持我的代码可管理。这会阻止 appharbor 部署，因为下载中不包含子存储库。

这篇文章让我明白了为什么会出现这个问题：

[AppHarbor、BitBucket 和 SubRepo 变通](https://stackoverflow.com/questions/11601486/appharbor-bitbucket-and-subrepo-work-around/11602192#11602192)

我正在努力解决的是如何实施他们所说的解决方法。这个 cron 作业/zip 文件是我必须自己托管的，还是仅与 bitbucket 和 appharbor 的构建后事件有关？感谢任何可以为我指明正确方向的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T01:39:07.347

您可能希望考虑将库依赖项添加为来自私有源的 NuGet 包，而不是复杂的解决方法。可以在这里托管：[http ://www.myget.org](http://www.myget.org)

# php - 如何访问包含文件中的 $_SESSION？

> ID：14965488
> 
> 赞同：2
> 
> 时间：2013-02-19T19:10:37.880
> 
> 标签：php, session, include

这是我的代码：

我的根目录是：**root**

位于 root/index.php 的 index.php 文件

```
<?php 
require_once('root/includes/initialize.php');
<?php template('header.php', 'TITLE');?>;
?>

<div id="main">
//SOME CONTENT
</div> 
```

我的 initialize.php 文件获取了我所有的核心包含文件并将它们放入一个“require_once”中。位于根目录/includes/initialize.php

```
<?php
//Define Path
defined('LIB_PATH') ? null : define('LIB_PATH', 'root/includes/');

//Core Functions
require_once(LIB_PATH.'functions.php');

//Core Objects
require_once(LIB_PATH.'_database.php');
require_once(LIB_PATH.'_session.php');

//Classes
require_once(LIB_PATH.'_user.php');
?> 
```

**更新****

我的functions.php 文件包含一个简单的模板函数，它可以抓取一个模板文件，例如我的header.php。它位于 root/includes/functions.php

```
<?php
//Templating
function template($path="", $pageTitle=NULL) {
    if ($pageTitle != NULL) {
        $_POST['page_title'] = $pageTitle;
    }
    include(root/public/templates/'.$path);
}
?> 
```

我的 _session.php 文件负责我的会话控制。位于根目录/includes/_session.php

```
<?php

/**
* Class for Sessions
*/
class Session
{
    public $logged_in = FALSE;
    public $uid;

    function __construct() {
        session_start();
        $this->check_login();
    }

    public function check_login() {
        if (isset($_SESSION['uid'])) {
            $this->uid = $_SESSION['uid'];
            $this->logged_in = TRUE;
        } else {
            unset($this->uid);
            $this->logged_in = FALSE;
        }
    }

    public function logged_in() {
        return $this->logged_in;
    }

    public function login($user) {
        if ($user) {
            $this->uid = $_SESSION['uid'] = $user;
            $this->logged_in = TRUE;
        }
    }

    public function logout() {
        unset($_SESSION['uid']);
        session_unset();
        session_destroy();
        redirect(WEB_ROOT);
    }
}

$session = new Session();

?> 
```

**更新****

我的 header.php 位于我网站中所有页面的顶部。位于 root/public/templates/header.php。这是我遇到问题的文件，我无法弄清楚为什么我无法在此文件中回显 $session->uid 或 $_SESSION['uid'] 。

```
<html>
<head>
    <!--CSS-->
    <link rel="stylesheet" type="text/css" href="root/public/css/style.css">

    <title>MY SITE</title>
</head>
<body>
    <div id="header">
        <div id="logo">
            <a href="root"><?php echo $_POST['page_title'];?></a>
        </div>
        <?php echo $session->uid;?> //DOESN'T WORK
    </div> 
```

我能够在我的 index.php 文件和我网站上的其他文件中很好地回显所有内容，但不能在包含的 header.php 中回显。有谁知道为什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:28:47.180

`session_start()`必须在要设置或获取会话变量的每个 php 文件的开头调用。我看到你打电话的唯一地方`session_start()`是在一个文件中。

[http://www.php.net/manual/en/session.examples.basic.php](http://www.php.net/manual/en/session.examples.basic.php)

```
<?php
session_start();
if (!isset($_SESSION['count'])) {
  $_SESSION['count'] = 0;
} else {
  $_SESSION['count']++;
}
?> 
```

也在旁注中。我正在查看您的课程`Session`，但没有看到任何`$mySession = new Session();`可以开始课程的地方。

更新：

我在我的 IDE 中重新创建了您的基本文件结构和代码，并通过在类中添加这一行来使其工作。

```
public function check_login() {
    if (isset($_SESSION['uid'])) {
        $this->uid = $_SESSION['uid'];
        $this->logged_in = TRUE;
    }
    else {
        unset($this->uid);
        $this->logged_in = FALSE;
        $_SESSION['uid'] = session_id();

        /*Add this next line */
        $this->uid = $_SESSION['uid'];
    }
} 
```

我第一次运行 index.php 时，只是`<?php echo $_SESSION['uid']; ?>`header 的一部分起作用了。刷新并且`<?php echo $session->uid; ?>`也有效，因此它回响了两次。这告诉我你的类没有将 ID 分配给类变量，希望这是我想要的结果，或者你可以根据需要调整它。

![它在这里工作](../Images/faf3b7bdc2a6cc883c2df39e024dd1de.png)

更新 2：

函数文件（编辑以匹配您的路径，但您需要返回一个字符串）

```
<?php

//Templating
function template($path = "", $pageTitle = NULL) {
    if ($pageTitle != NULL) {
        $_POST['page_title'] = $pageTitle;
    }
    return "$path";
}
?> 
```

然后在 Index.php 文件中添加这种方式：

```
<?php
require_once('initialize.php');
include(template('header.php', 'TITLE'));
//include('header.php');
?>

<div id="main">
    //SOME CONTENT
</div>
</body>
</html> 
```

_session.php 文件：

```
<?php

/**
 * Class for Sessions
 */
class Session
{

    public $logged_in = FALSE;
    public $uid;

    function __construct() {
        session_start();
        $this->check_login();
    }

    public function check_login() {
        if (isset($_SESSION['uid'])) {
            $this->uid = $_SESSION['uid'];
            $this->logged_in = TRUE;
        }
        else {
            unset($this->uid);
            $this->logged_in = FALSE;

            $_SESSION['uid'] = session_id();
            $this->uid = $_SESSION['uid'];
        }
    }

    public function logged_in() {
        return $this->logged_in;
    }

    public function login($user) {
        if ($user) {
            $this->uid = $_SESSION['uid'] = $user;
            $this->logged_in = TRUE;
        }
    }

    public function logout() {
        unset($_SESSION['uid']);
        session_unset();
        session_destroy();
        redirect(WEB_ROOT);
    }

}

$session = new Session();
?> 
```

和 header.php

```
<html>
    <head>
        <!--CSS-->
        <link rel="stylesheet" type="text/css" href="style.css">

        <title>MY SITE</title>
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="root"><?php echo $_POST['page_title'];?></a>
            </div>
            <?php echo $session->uid; ?> //WORKS NOW
            <?php echo $_SESSION['uid']; ?> //WORKS NOW
        </div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:28:06.297

这个问题很模糊。我的猜测是，由于您的`index.php`文件位于 中`root/index.php`，那么您的包含路径：

```
require_once('root/includes/initialize.php');
include('root/public/templates/header.php'); 
```

不正确。您不以 a 开头`/`，因此路径是相对的，并且考虑到您的位置`index.php`，您包括`root/root/includes/initialize.php`. 如果是这种情况，您应该很容易通过缺少`<title>MY SITE</title>`和`<a href="root">TITLE</a>`在您的页面上发现它。你没有吗？

如果这是问题所在，我建议您定义某种`HOME`常量，例如

```
define ('HOME', dirname(__FILE__));
// or define ('HOME', __DIR__); depending on your PHP version 
```

这样您就可以包含与该常数相关的所有内容

```
require_once(HOME . '/includes/initialize.php'); 
```

除此之外，我在您的代码中看不到任何错误。

# keyboard - 禁用 tinyMCE ctrl+s 快捷方式以启用此快捷方式以保存 ajax 内容

> ID：14965490
> 
> 赞同：5
> 
> 时间：2013-02-19T19:10:50.760
> 
> 标签：keyboard, tinymce, shortcuts

我在页面中使用 tinyMCE。我使用ajax捕获`Ctrl`+`s`来保存内容，当焦点不在tinyMCE时，一切正常，但是当焦点在tinyMCE中时它不起作用。我需要在这段代码中插入一段代码（而不是在设置或插件中），以使内容保存工作，即使焦点在 tinyMCE 内。

```
<script type="text/javascript">
$(document).ready(function() {
    dssModify = new Sol.Dss.Modify();
    dssModify.config = 
        {
        urlActionContentSave: "<?php echo \Sol\Dss\Dss::me () -> urlActionContentSaveGet () ; ?>",
        buttonContentSaveId: "<?php echo \Sol\Dss\Dss::me () -> modifyButtonContentSaveIdGet () ; ?>",
        buttonContentSavingTitle: "<?php echo \Sol\Dss\Dss::me () -> modifyButtonContentSavingTitleGet () ; ?>",
        buttonContentSaveTitle: "<?php echo \Sol\Dss\Dss::me () -> modifyButtonContentSaveTitleGet () ; ?>",
        textareaContentId: "<?php echo \Sol\Dss\Dss::me () -> modifyTextareaContentIdGet () ; ?>",
        formId: "<?php echo \Sol\Dss\Dss::me () -> modifyFormIdGet () ; ?>",
        idRoutes: "<?php echo $route[ 'id' ] ; ?>"
    };
    whenClicked = function()
    {
        $("#"+dssModify.config.textareaContentId).val(tinyMCE.activeEditor.getContent());
        dssModify.contentSave();
    }
    $("#<?php echo Sol\Dss\Dss::me () -> modifyButtonContentSaveIdGet () ; ?>").click( whenClicked );//Click Function
    $(window).keypress(function(event) {
        if (!(event.which == 115 && event.ctrlKey) && !(event.which == 19)) 
            return true;
        whenClicked();
        event.preventDefault();
        return false;
    });

}//Ready function
);
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2018-04-29T19:07:34.727

使用`init_instance_callback`并定义您的自定义快捷方式。

**例子：**

```
tinymce.init({
    selector: "textarea",

    init_instance_callback: function (editor) {
        editor.addShortcut("ctrl+s", "Custom Ctrl+S", "custom_ctrl_s");
        editor.addCommand("custom_ctrl_s", function() {
            alert("234");
            /*
            your custom codes
            */
        });
    }

}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T11:29:23.707

这是一个棘手的问题。您必须在主文档中创建这样的函数。

```
function receiveShortCutEvent(eventObject){
    //console.log('receiveShortCutEvent', eventObject);
    $(document).trigger(eventObject);
    $(document).trigger({type: 'keydown', ctrlKey: eventObject.ctrlKey, altKey: eventObject.altKey, which: eventObject.keyCode, originalEvent:eventObject });
    return false; 
} 
```

在 tinymce 方面，如果键入 ctrl+h，您将需要调用 receiveShortCutEvent。您可以为此使用[setup 配置参数](http://www.tinymce.com/wiki.php/Configuration%3asetup)。

```
 ed.onKeyDown.add(function onkeydown(ed, evt) {
            // Shortcut:  ctrl+h 
            if (evt.keyCode == 72 && !evt.altKey && !evt.shiftKey && evt.ctrlKey && !evt.metaKey) {
                setTimeout(function(){
                    var e = { type : 'keydown'};
                    e.charCode = e.keyCode = e.which = 72;
                    e.shiftKey = e.altKey = e.metaKey = false;
                    e.ctrlKey = true;
                    window.parent && window.parent.receiveShortCutEvent && window.parent.receiveShortCutEvent(e);
                }, 1);
            }
}); 
```

我希望你能明白。

# android - 使用蓝牙不安全地连接到 RF 阅读器

> ID：14965493
> 
> 赞同：1
> 
> 时间：2013-02-19T19:11:07.523
> 
> 标签：android, bluetooth, insecure-connection

我正在尝试使用蓝牙不安全地连接到 RFreader。我尝试使用示例项目中提供的蓝牙聊天示例。我为此使用 android 2.3 及更高版本。

我遇到了很多使用链接

```
createInsecureRfcommSocketToServiceRecord() 
```

随着

```
listenUsingInsecureRfcommWithServiceRecord(String, UUID) 
```

1.  我根据需要更改了蓝牙聊天示例。
2.  最初它显示扫描设备列表（显示射频阅读器）。
3.  选择设备后，`connectThread`将调用。它将创建`BluetoothSocket`using `createInsecureRfcommSocketToServiceRecord()`。

4.  然后我正在启动取消发现并调用的线程`bluetoothSocket.connect()`。

但是，在这里给出一个`**IOException:Service discovery failed**`. 我已经删除了`AcceptThread()`监听连接的代码，因为我是通过从扫描设备列表中选择一个设备来显式连接的。

我做错了吗？是否有任何其他程序可以连接到非 UI 蓝牙设备？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T23:29:36.943

检查您使用的 UUID 是否正确，并且在 Clinet 和服务器端应该相同。

确保在 RF 阅读器端它正在等待传入连接？即有一个等价的listenUsingInsecureRfcommWithServiceRecord()。

# sql - 连接相同表之间的多个字段

> ID：14965494
> 
> 赞同：1
> 
> 时间：2013-02-19T19:11:08.800
> 
> 标签：sql, sql-server, join

我有一个名为“资源”的表，如下所示：

```
 Country        City       Street      Headcount
      UK         Halifax   High Street      20
United Kingdom   Oxford    High Street      30
    Canada       Halifax    North St        40 
```

由于位置字段的性质，我需要将它们映射到单个“地址”字段，因此我还有下表称为“地址”：

```
 Country        City       Street                 Address
      UK         Halifax   High Street     High Street, Halifax, UK
    Canada       Halifax    North St     North Street, Halifax, Canada
United Kingdom   Oxford    High Street      High Street, Oxford, UK 
```

（实际上，地址字段确实添加了信息，而不是仅仅组合已有的信息。）

我目前正在使用以下 SQL 来生成查询：

```
SELECT Resources.Country, Resources.City, Resources.Street, Addresses.Address,
       Resources.Headcount
FROM   Resources
INNER JOIN Addresses ON Resources.Country = Addresses.Country
       AND Resources.City = Addresses.City
       AND Resources.Street = Addresses.Street 
```

这对我有用，但我担心我没有看到人们在其他地方的单个连接中使用这么多 AND，所以不知道这是否是一个坏主意。（这是简化版本 - 在另一种情况下，我可能需要在单个连接中最多 8 个 AND）这是解决问题的最佳方法，还是有更好的解决方案？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:12:26.293

加入多个列很好。你不必“害怕”这一点。

至于“更好的方法”。我建议创建一些变量表，将一些数据放入其中，然后在此处发布该 TSQL（DDL 和 DML）。然后，您可以获得一些可能的替代方案。您的问题目前含糊不清（关于您问题的“有没有更好的方法”部分）

# image - SIMPLE PIE - 获取特定 rss 提要中的图像

> ID：14965496
> 
> 赞同：0
> 
> 时间：2013-02-19T19:11:14.777
> 
> 标签：image, simplepie

我正在尝试这个提要[http://servicios.elpais.com.uy/formatos/rss/index.asp?seccion=ultmom](http://servicios.elpais.com.uy/formatos/rss/index.asp?seccion=ultmom) 抛出 simplepie 演示页面，效果很好。我可以得到这个提要的很多信息，但我不知道如何获取图像，如果你尝试演示它是可能的。

我怎样才能得到这些图像？

PS：我不是说feed图片，我是说每个新闻图片

真的谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T02:28:03.993

某些版本的 RSS/Atom 有缩略图，其他版本没有。如果要从提要中获取所有图像，则需要使用 simple_html_dom 之类的东西。

这个问题一直被问到，知道 StackOverflow 和 SimplePie 如何工作的人应该合并这些[答案](https://stackoverflow.com/questions/15306738/get-youtube-thumbnail-simplepie)。

# tridion - 如果 URL 不以文件扩展名结尾，我们如何使用外部资源类型保存多媒体组件？

> ID：14965497
> 
> 赞同：9
> 
> 时间：2013-02-19T19:11:27.253
> 
> 标签：tridion, tridion-2011

我们有一个与策划内容相关的 Tridion 用例，我们正在为与我们的内容相关联的图像创建多媒体组件，这些图像指向外部资源类型而不是上传的资源类型。

我们在这个用例中遇到的一个问题是，尽管为资源显式设置了多媒体类型，但如果图像的 URL 中包含查询字符串：[http ://cdn.hw.net/UploadService/ 1c8b7f28-bb12-4e02-b888-388fdff5836e.jpg?w=160&h=120&mode=crop&404=default](http://cdn.hw.net/UploadService/1c8b7f28-bb12-4e02-b888-388fdff5836e.jpg?w=160&h=120&mode=crop&404=default)或使用“友好的 url”： http: [//www.somewhere.com/images/myimage/](http://www.somewhere.com/images/myimage/)当我们保存组件时，Tridion barfs 错误消息类似于：“属性“文件名”的值无效。意外的文件扩展名：jpg?w=160&h=120&mode=crop&404=default。期待：jpg，jpeg，jpe。

到目前为止，我们能够想出解决这个问题的唯一方法是做一些hacky，比如在以预期文件扩展名结尾的url的最后附加一个额外的查询字符串参数：[http：/ /cdn.hw.net/UploadService/1c8b7f28-bb12-4e02-b888-388fdff5836e.jpg?w=160&h=120&mode=crop&404=default&ext=.jpg](http://cdn.hw.net/UploadService/1c8b7f28-bb12-4e02-b888-388fdff5836e.jpg?w=160&h=120&mode=crop&404=default&ext=.jpg) 显然，这不是最好的解决方案，实际上可能不适用于某些图像如果提供服务的站点严格验证请求的 URL。

有人对我们如何解决这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T19:35:11.563

不幸的是，我真的想不出一个简单的解决方案，因为 Tridion 通过检查文件扩展名“检测”了 Mime 类型。

您也许可以在保存时添加它并在阅读时删除它（通过事件系统）？绝对是一个值得的增强请求，~~据我所知，这种行为在即将到来的 Tridion 2013 中没有改变......~~请参阅下面的评论，它已在 2013 年改变。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-19T19:58:29.380

努诺的回答+1。认识到您的问题标题特定于多媒体组件，您可能需要考虑另一种方法，即使用普通组件，而不是多媒体组件。您可以创建一个名为“外部图像”之类的普通组件架构，它有一个外部 URL 字段来存储您的无扩展 URL。

然后，内容作者将通过 Tridion GUI 中的常规组件链接机制包含这些图像。

然后，您将需要一个自定义链接解析器 TBB，它将解析输出项（通过正则表达式）以查找任何 Tridion 锚标记`<a tridion:href="tcm:x-y-z">`，并将每个标记替换`<img src=...>`为 src 路径来自此链接组件的标记。

有关类似方法的示例，但带有视频和自定义链接解析器 TBB 的示例代码，请查看以下帖子中的代码：[http ://www.tridiondeveloper.com/integration-sdl-tridion-jw-媒体播放器](http://www.tridiondeveloper.com/integration-sdl-tridion-jw-media-player)。

# r - 在许多列上快速子集

> ID：14965498
> 
> 赞同：1
> 
> 时间：2013-02-19T19:11:36.133
> 
> 标签：r, dataframe

我有一些代码可以识别数据框中的异常值，然后删除或限制它们。我正在尝试使用 apply() 函数（或者可能是另一种方法）来加快删除过程。

**示例数据**

```
https://github.com/crossfitAL/so_ex_data/blob/master/subset
# this is the contents of a csv file, you will need to load it into your R session.

# set up an example decision-matrix
# rm.mat is a {length(cols) x 4} matrix -- in this example 8 x 4
# rm.mat[,1:2] - identify the values for min/max outliers, respectively.
# rm.mat[,3:4] - identify if you wish to remove min/max outliers, respectively.
cols <- c(1, 6:12) # specify the columns you wish to examine
rm.mat <- matrix(nrow = length(cols), ncol= 4, 
                dimnames= list(names(fico2[cols]), 
                c("out.min", "out.max","rm outliers?", "rm outliers?")))

# add example decision criteria
rm.mat[, 1] <- apply(fico2[, cols], 2, quantile, probs= .05)
rm.mat[, 2] <- apply(fico2[, cols], 2, quantile, probs= .95)
rm.mat[, 3] <- replicate(4, c(0,1))
rm.mat[, 4] <- replicate(4, c(1,0)) 
```

**这是我当前的子集代码：**

```
df2 <- fico2 # create a copy of the data frame
cnt <- 1     # add a count variable
for (i in cols) { 
# for each column of interest in the data frame. Determine if there are min/max 
# outliers  that you wish to remove, remove them.        
  if (rm.mat[cnt, 3] == 1 & rm.mat[cnt, 4] == 1) {
    # subset / remove min and max outliers
    df2 <- df2[df2[, i] >= rm.mat[cnt, 1] & df2[, i] <= rm.mat[cnt, 2], ]  
  } else if (rm.mat[cnt, 3] == 1 & rm.mat[cnt, 4] == 0) {
    # subset / remove min outliers
    df2 <- df2[df2[, i] >= rm.mat[cnt, 1], ]
  } else if (rm.mat[cnt, 3] == 0 & rm.mat[cnt, 4] == 1) {
    # subset / remove max outliers
    df2 <- df2[df2[, i] <= rm.mat[cnt, 2], ]
  }
  cnt <- cnt + 1
} 
```

**建议的解决方案**：我认为我应该能够通过应用类型函数来做到这一点，删除 for 循环/矢量化加速了代码。我遇到的问题是我正在尝试应用一个函数*，如果且仅当*决策矩阵表明我应该这样做。IE-使用逻辑向量`rm.mat[,3] or rm.mat[,4]`来确定是否`"["`应将子集应用于数据帧`df2`。

您的任何帮助将不胜感激！另外，请让我知道示例数据/代码是否足够。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:08:34.077

这里有一个解决方案。只是为了澄清你的代码。希望其他人可以使用它来提供更好的解决方案。

因此，如果理解，您有一个决策矩阵，如下所示：

```
rm.mat
                                      c1 c2 c3 c4
amount.funded.by.investors     27925.000 NA  0  1
monthly.income                 11666.670 NA  1  0
open.credit.lines                 18.000 NA  0  1
revolving.credit.balance       40788.750 NA  1  0
inquiries.in.the.last.6.months     3.000 NA  0  1
debt.to.inc                       28.299 NA  1  0
int.rate                          20.490 NA  0  1
fico.num                         775.000 NA  1  0 
```

你尝试根据这个矩阵的值过滤一个大矩阵

```
colnames(rm.mat) <- paste('c',1:4,sep='')    
rm.mat <- as.data.frame(rm.mat)
apply(rm.mat,1,function(y){
     h <- paste(y['c3'],y['c4'],sep='')
     switch(h,
            '11'= apply(df2,2, function(x)
                               df2[x >= y['c1'] &  x <= y['c2'],]),  ## we never have this!!
            '10'= apply(df2,2, function(x)
                               df2[x >= y['c1'] , ]),   ## here we apply by columns!
            '01'= apply(df2,2,function(x) 
                               df2[x <= y['c2'], ]))   ## c2 is NA!! so !!!
 }
) 
```

# c++ - 编译按需可执行文件

> ID：14965501
> 
> 赞同：0
> 
> 时间：2013-02-19T19:11:46.107
> 
> 标签：c++, compilation, ondemand

GoToMeeting 的 gotomeeting.com/join 有一个有趣的行为 - 当您直接访问会议 URL 时，您需要下载一个新的 exe 二进制文件，该文件在执行时**已经集成**了会议 ID ，并且会自动启动程序而无需您需要输入会议 ID。

我的第一个想法是这已被合并到可执行文件的元数据中，但仔细检查后我相信这些 exe 文件是使用会议 ID 编译的。

所以这里有几个问题：

*   他们是在即时构建/编译吗？
*   如果是这样，实现这一点是否会产生巨大的开销？
*   这一定是一个**巨大的**安全风险，对吧？

所以假设我很愚蠢地尝试这样的事情 - 有没有一种*安全*的方法可以从我的基于 Web 的框架中发出`make`等？我的直觉告诉我没有。

我已经阅读了以下 SO 问题，这些问题告诉我这种问题通常会引起很多愤怒：

[快速按需 C++ 编译](https://stackoverflow.com/questions/12560287/fast-on-demand-c-compilation)

[Silverlight 按需编译/构建](https://stackoverflow.com/questions/5349218/silverlight-on-demand-compilation-build)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:21:22.380

我不明白您为什么说`make`从基于 Web 的框架内发布*一定*是不安全的。它可能会，但可能不会。它几乎肯定会很慢，并且可能会导致不可接受的延迟。

在我看来，更明智的方法是让可执行文件已经编译，在生成的文件中使用保留数据的“blob”替换所需的实际数据，然后对生成的文件进行*签名。*

这可能会比编译快得多，并且更容易实现启动！

# sql - 日期之间的 SQL 语法

> ID：14965502
> 
> 赞同：0
> 
> 时间：2013-02-19T19:11:48.863
> 
> 标签：sql, date, between

我有一个查询需要返回 ShipDate 在一系列日期之间的记录。以下查询有效：

```
$query = "SELECT ECCustomerOrder.ShipDate, 
ECCustomers.Customer, 
ECCustomerOrder.PO, 
ECCustomerOrder.TotalCases, 
ECCustomerOrder.order_number
FROM ECCustomerOrder INNER JOIN ECCustomers ON ECCustomerOrder.ID = ECCustomers.ID
WHERE ECCustomerOrder.ShipDate >= $todayMinus"; 
```

$todayMinus 是脚本前面设置的一个 php 变量，它采用当前日期并减去 15 天。我无法上班的情况如下：

```
$query = "SELECT ECCustomerOrder.ShipDate, 
ECCustomers.Customer, 
ECCustomerOrder.PO, 
ECCustomerOrder.TotalCases, 
ECCustomerOrder.order_number
FROM ECCustomerOrder INNER JOIN ECCustomers ON ECCustomerOrder.ID = ECCustomers.ID
WHERE ECCustomerOrder.ShipDate BETWEEN $todayMinus AND $todayPlus"; 
```

此 SQL 查询返回 $todayMinus 和 $todayPlus 的 ShipDates 之间的记录的正确语法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:15:18.103

assuming you're using plain dates, you'll have to quote them.

e.g.

```
ShipDate BETWEEN 2013-01-01 AND 2013-02-19 
```

is incorrect, because `2013-01-01` is a substraction, you're actually doing

```
ShipDate BETWEEN 2011 AND 1992 
```

try

```
ShipDate BETWEEN '$todayMinus' AND '$todayPlus' 
```

# visual-studio-2010 - 静态链接到打开的场景图

> ID：14965506
> 
> 赞同：0
> 
> 时间：2013-02-19T19:12:04.520
> 
> 标签：visual-studio-2010, static, static-linking, openscenegraph

有没有办法静态链接到开放的场景图库？

我在 Windows 7 上编译了 osg，它同时具有静态和 dll，但我想静态链接，所以我不必依赖 dll。关键是我可以携带 exe 文件进行分发，让其他人对其进行测试，而不必担心 dll 丢失。我不知道我必须更改设置以使其仅链接到静态库。

我正在使用视觉工作室 2010。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T01:25:24.913

请参阅 CMake 选项

DYNAMIC_OPENSCENEGRAPH 设置为 ON 以构建用于动态链接的 OpenSceneGraph。对静态使用 OFF。

# javascript - 如何自定义 Isotope for Wordpress 插件？

> ID：14965508
> 
> 赞同：2
> 
> 时间：2013-02-19T19:12:14.620
> 
> 标签：javascript, wordpress, jquery-masonry, jquery-isotope

我最近将 Metafizzy 的[同位素](http://isotope.metafizzy.co/)添加到我的 wordpress 页面，但我在将它链接到我的帖子时遇到了一些麻烦。作为解决方案，我删除了手动输入的代码，并安装了[这个 Isotope for Wordpress](http://mintthemes.com/isotope-for-wordpress/#comment-2185)插件。

有没有人使用过这个并使用 Isotope 的不同方法和布局模式对其进行自定义？我在定位那些关键代码段时遇到了一些麻烦（当您手动添加同位素时，这些代码很容易编辑）。这个插件似乎使编辑它们有点棘手。如果有人能指出我正确的方向，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T00:12:46.903

同位素函数在名为 load_isotope.js 的文件的 includes>js 文件夹中调用

您可以在第 6 行看到布局模式。可能将该功能添加到插件中是个好主意。

# linux-kernel - 重新安排内核延迟工作时会发生什么

> ID：14965513
> 
> 赞同：8
> 
> 时间：2013-02-19T19:12:25.610
> 
> 标签：linux-kernel

我正在使用内核共享工作队列，并且我有一个`delayed_work`要重新安排以立即运行的结构。

下面的代码能保证`delayed_work`尽快运行吗？

```
cancel_delayed_work(work);
schedule_delayed_work(work, 0); 
```

在工作已经在运行的情况下会发生什么？`cancel_delayed_work`将返回`0`，但我不确定`schedule_delayed_work`如果工作当前正在运行或计划外，该怎么办。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-06-27T06:52:11.943

好吧，您知道他们所说的必要性是所有发明（或本例中的研究）之母。我真的需要这个答案，并通过挖掘 kernel/workqueue.c 得到了它。尽管答案主要包含在与结合的[文档注释](https://www.kernel.org/doc/htmldocs/device-drivers/ch01s06.html)[`Documentation/workqueue.txt`](https://www.kernel.org/doc/Documentation/workqueue.txt)中，但如果不阅读有关并发管理工作队列 (cmwq) 子系统的整个规范，则无法清楚地说明它，即使这样，某些信息也已过时！

**简答**

> [您的代码] 会保证 delay_work 会尽快运行吗？

是（有以下警告）

> 在工作已经在运行的情况下会发生什么？

它将在当前运行的函数退出*后*`delayed_work`的某个时间点运行，并在与最后一个函数相同的 CPU 上运行，尽管已经在该工作队列中排队的任何其他工作（或到期的延迟工作）将首先运行。这是假设你没有重新初始化你的`delayed_work`or`work_struct`对象并且你没有改变`work->func`tion 指针。

**长答案**

所以首先，通过嵌入 a作为它的第一个成员，[`struct delayed_work`](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/include/linux/workqueue.h?id=9e895ace5d82df8929b16f58e9f515f6d54ab82d#n113)使用伪继承来派生。这个子系统使用了一些惊人的原子位触发来实现一些严重的并发性。当A的字段设置了位时，它是“拥有的” 。当工作人员执行您的工作时，它[会释放所有权并通过私有](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/kernel/workqueue.c?id=9e895ace5d82df8929b16f58e9f515f6d54ab82d#n2166)[set_work_pool_and_clear_pending()](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/kernel/workqueue.c?id=9e895ace5d82df8929b16f58e9f515f6d54ab82d#n595)函数记录最后一个工作池——这是 API 修改对象的最后一次（当然，直到您重新安排它）。调用做同样的事情。[`struct work_struct`](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/include/linux/workqueue.h?id=9e895ace5d82df8929b16f58e9f515f6d54ab82d#n113)`struct work_struct``work_struct``data`[`WORK_STRUCT_PENDING`](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/include/linux/workqueue.h?id=9e895ace5d82df8929b16f58e9f515f6d54ab82d#n42)`work_struct`[`cancel_delayed_work()`](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/kernel/workqueue.c?id=9e895ace5d82df8929b16f58e9f515f6d54ab82d#n2917)

因此，如果您`cancel_delayed_work()`在您的工作功能已经开始执行时调用，它会返回`false`（如宣传的那样），因为它不再为任何人所有，即使它可能仍在运行。但是，当您尝试使用 重新添加它时`schedule_delayed_work()`，它会[检查工作](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/kernel/workqueue.c?id=9e895ace5d82df8929b16f58e9f515f6d54ab82d#n1324)以发现最后一个`pool_workqueue`，然后确定是否有任何`pool_workqueue`工作人员当前正在运行您的工作。如果它们是（并且您没有更改`work->func`指针），它只是将工作附加到队列中，`pool_workqueue`这就是它避免重新进入的方式！否则，它将在当前 CPU 的池中排队。（指针检查的原因`work->func`是允许`work_struct`对象的重用。）

但是请注意，如果工作仍在排队，则直接调用`schedule_delayed_work()`而不先取消它不会导致*任何更改，因此您必须先取消它。*

编辑：哦，是的，如果您对`Documentation/workqueue.txt`about中的讨论感到困惑[`WQ_NON_REENTRANT`](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/Documentation/workqueue.txt?id=9e895ace5d82df8929b16f58e9f515f6d54ab82d#n169)，请忽略它。该标志已被弃用和忽略，所有工作队列现在都是不可重入的。

# javascript - 在 iframe 中获取 innerdiv 的 id

> ID：14965520
> 
> 赞同：1
> 
> 时间：2013-02-19T19:13:00.820
> 
> 标签：javascript, jquery, html, dom, iframe

我有一个 iframe，它根据菜单中选择的项目打开不同的页面。iframe 中的每个页面都包含 div 元素和表格。我的要求是将焦点放在 iframe 中的第一个 div 或表格上。因此，我正在寻找一种方法来访问第一个 div 或第一个表的 id 并专注于它。

由于 iframe 中加载的页面取决于所选的菜单项，因此我无法使用 getElementById 方法访问 iframe 中的元素。

我尝试使用以下代码访问 iframe 中的第一个 div 元素：

```
 var innerElement = iframeObject.contentWindow.document.getElementsbyTagName('div')[0];
       innerElement.focus(); 
```

但是，innerElement 被认为是未定义的。

但是，我可以使用以下方法将重点放在 iframe 上：

```
 iframeObject.contentWindow.focus(); 
```

但无法将重点放在内部 div 上。

谁能帮忙，我怎么能访问 iframe 的第一个元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:16:29.037

如果您尝试从外部源（域外的 URL）获取特定的 HTML 元素，则出于 DOM 安全原因，您不能这样做！

# java - 两个 tableView 和一个 JavaFx 选择

> ID：14965521
> 
> 赞同：1
> 
> 时间：2013-02-19T19:13:00.863
> 
> 标签：java, javafx-2, javafx

我的应用程序中有两个 tableView，我希望每次只启用一个。

例如我有 tableView1 和 tableView2

如果 tableView2 被选中（或聚焦）然后 tableView1 清除选择。

我尝试了一些代码，但它们似乎不起作用。

```
mainTableView2.focusModelProperty().addListener(new ChangeListener() {

            @Override
            public void changed(ObservableValue ov, Object t, Object t1) {
                mainTableView1.getSelectionModel().clearSelection();
            }
        }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T20:09:46.180

在此示例中，您错误地分配了侦听器。你写过：

```
mainTableView2.focusModelProperty().addListener(new ChangeListener() {

        @Override
        public void changed(ObservableValue ov, Object t, Object t1) {
            mainTableView1.getSelectionModel().clearSelection();
        }
    }); 
```

这意味着，TableView 具有更改*焦点项目或单元格*的策略，它允许以编程方式更改焦点、跟踪焦点项目等......并且您在*更改该策略*时添加侦听器，实际上通常不会更改。如果要跟踪表格的焦点项，则应在该焦点模型的属性上添加侦听器。

你想要的应该是这样的：

```
mainTableView2.focusedProperty().addListener(new ChangeListener() {

        @Override
        public void changed(ObservableValue ov, Object t, Object t1) {
            mainTableView1.getSelectionModel().clearSelection();
        }
    }); 
```

此属性（focused 属性）响应控制的焦点状态（蓝色边框 - 用于里海风格，红色边框用于摩德纳风格）。

但是，在评估过程中，我发现有一个错误（见评论），所以我建议解决这个问题：

```
 scene.focusOwnerProperty().addListener(new ChangeListener<Node>() {
        @Override
        public void changed(ObservableValue<? extends Node> ov, Node t, Node t1) {

            if (t1 == table2) {
                table1.getSelectionModel().clearSelection();
            }
            if (t1 == table1) {
                table2.getSelectionModel().clearSelection();
            }
        }
    }); 
```

粘贴任何类似的逻辑..

# java - JPanel 重写 revalidate()

> ID：14965522
> 
> 赞同：3
> 
> 时间：2013-02-19T19:13:03.707
> 
> 标签：java, swing, jpanel, jlabel

对于我的程序，我有一个`JPane`随着游戏的进行它会向面板添加标签，但是我可以使面板显示的唯一方法是使用`add(label)`then revalidating 来删除标签，反之亦然。

我的问题是，一旦我在屏幕上有超过 40 个标签，重新验证必须处理太多的事情，那么我如何覆盖`revalidate()`, ether 工作，以便它只重新验证添加的特定组件，而不是屏幕上的每个组件。我知道`revalidate()`方法中有一个循环将贯穿所有组件的循环，但我终生无法找到它。我希望能够调用`revalidate(component-here)`或`validate (component-here)`让它只更新该特定组件。

我知道还有其他编写这个程序的方法，但我只对如何覆盖感兴趣，`revalidate()`所以没有“你可以用这种方式重做你的整个代码，这只需要你大约 6 个小时 >.<”。

[http://www.fileserve.com/file/jFdQ6nv/FINAL_PROJECT.zip](http://www.fileserve.com/file/jFdQ6nv/FINAL_PROJECT.zip)一个指向我的 Eclipse 项目的链接，如果有人想提供帮助想看看我到底在说什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T13:27:24.290

我刚试过这个[例子](https://stackoverflow.com/a/7820703/261156)。添加 1000 个文本区域只需一秒钟，并且更新是即时的。标签走得更快。你可能想看看其他东西减慢它。

另外，你可以看看`CellRendererPane`. 它覆盖`invalidate()`什么都不做。

```
public void invalidate() {} 
```

# json - 如何防止 Gson 序列化/反序列化字段的第一个字符（下划线）？

> ID：14965523
> 
> 赞同：8
> 
> 时间：2013-02-19T19:13:07.503
> 
> 标签：json, parsing, gson

我的课：

```
class ExampleBean {
   private String _firstField;
   private String _secondField;
   // respective getters and setters
} 
```

我想出现如下：

```
{
     "FirstField":"value",
     "SecondField":"value"
} 
```

而不是这样

```
{
     "_FirstField":"value",
     "_SecondField":"value"
} 
```

我初始化解析器如下：

```
GsonBuilder builder = new GsonBuilder();
    builder.setDateFormat(DateFormat.LONG);
    builder.setFieldNamingPolicy(FieldNamingPolicy.UPPER_CAMEL_CASE);
    builder.setPrettyPrinting();
    set_defaultParser(builder.create()); 
```

[我可以在“FieldNamePolicy”的文档](https://sites.google.com/site/gson/gson-user-guide#TOC-JSON-Field-Naming-Support)中看到[API](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/index.html)和文档，但我很惊讶没有提供跳过“_”的选项我也知道我可以使用注释......

```
@ SerializedName (" custom_naming ") 
```

...但不想为我的所有领域写这个...

区分局部变量和类的字段对我来说非常有用。：（ 任何的想法？

**编辑：**会有很多明显的解决方案，（继承、gson 覆盖方法、正则表达式）。我的问题更侧重于是否有 gson 的本机解决方案或侵入性较小的修复？

也许我们可以提议作为新的 FieldNamePolicy？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-20T19:17:38.283

`GsonBuilder`提供了一种`setFieldNamingStrategy()`允许您传递自己的`FieldNamingStrategy`实现的方法。

请注意，这将替换调用`setFieldNamingPolicy()`- 如果您查看`GsonBuilder`这两种方法的源代码，它们是互斥的，因为它们设置了相同的内部字段（`FieldNamingPolicy`枚举*是 a* `FieldNamingStrategy`）。

```
public class App
{
    public static void main(String[] args)
    {
        Gson gson = new GsonBuilder()
                        .setFieldNamingStrategy(new MyFieldNamingStrategy())
                        .setPrettyPrinting()
                        .create();

        System.out.println(gson.toJson(new ExampleBean()));
    }
}

class ExampleBean
{

    private String _firstField = "first field value";
    private String _secondField = "second field value";
    // respective getters and setters
}

class MyFieldNamingStrategy implements FieldNamingStrategy
{
    public String translateName(Field field)
    {
        String fieldName = 
            FieldNamingPolicy.UPPER_CAMEL_CASE.translateName(field);
        if (fieldName.startsWith("_"))
        {
            fieldName = fieldName.substring(1);
        }
        return fieldName;
    }
} 
```

输出：

```
{
  "FirstField": "first field value",
  "SecondField": "second field value"
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-16T18:32:44.417

你想要的是

```
import java.lang.reflect.Field;
import java.text.DateFormat;

import com.google.gson.FieldNamingStrategy;
import com.google.gson.Gson;
import com.google.gson.GsonBuilder;

public class GsonExample {

    public static void main(String... args) throws Exception {
        final GsonBuilder builder = new GsonBuilder();
        builder.setDateFormat(DateFormat.LONG);
        builder.setPrettyPrinting();
        builder.setFieldNamingStrategy(new FieldNamingStrategy() {
            @Override
            public String translateName(Field f) {
                String fieldName = f.getName();
                if(fieldName.startsWith("_") && fieldName.length() > 1) {
                    fieldName = fieldName.substring(1, 2).toUpperCase() + fieldName.substring(2);
                }
                return fieldName;
            }
        });
        final Gson gson = builder.create();
        System.out.println(gson.toJson(new ExampleBean("example", "bean")));
    }

    private static class ExampleBean {
        private final String _firstField;
        private final String _secondField;

        private ExampleBean(String _firstField, String _secondField) {
            this._firstField = _firstField;
            this._secondField = _secondField;
        }
    }
} 
```

这会产生

```
{"FirstField":"example","SecondField":"bean"} 
```

# ajax - symfony2 控制器需要两种返回值方式，一种用于 symfony-application（symfony 内部），另一种用于移动端（json）

> ID：14965524
> 
> 赞同：2
> 
> 时间：2013-02-19T19:13:09.213
> 
> 标签：ajax, json, symfony, mobile-website

我正在尝试为我的 Symfony2 应用程序构建一个宁静的 JSON api。

我正在使用[http://jmsyst.com/libs/serializer](http://jmsyst.com/libs/serializer) `JMS\Serializer` Bundle 将我的实体序列化为`JSON`.

我有这个例子`Controller-Action`：

```
public function getFarmerByNameAction(Request $request) {
    $this->setLocale($request);

    $name = $request->get("name");
    $farmer = $this->getDoctrine()->getRepository("FarmerguideBackendBundle:Farmer")->findByName($name);

    // Return json response
    return new Response($this->jsonify($farmer));
} 
```

因为我经常使用这个序列化程序（我知道我应该做一些类似单例的事情，但目前我没有时间，我只是在玩框架）我把代码放在里面执行序列化的函数。

```
private function jsonify($object) {
        // Serialize to json
        $serializer = new Serializer(array(new GetSetMethodNormalizer()), array('json' => new
                JsonEncoder()));
        $json = $serializer->serialize($object, 'json');
        return $json;
} 
```

**我的问题如下：**

*   此代码位于 a`BackendController`中，不包含任何特定于 gui 的信息。所以只是一个 RESTful API。
*   在另一个控制器中，假设`WebappController`我有代码可以访问这些后端函数并使用 twig-files 和`render()`-methods 做一些事情。
*   我想通过ajax上的**移动设备访问所有这些信息（因此我需要这个 json 返回值）**

这里的**最佳做法**是什么？最好说：好吧，如果它是一个ajax调用（检查`if($request->isXmlHttpRequest())`），在返回repsonse之前做jsonify，如果它不返回实体（我需要twig-templates的实体..）还是有另一种方法？

`$request->getFormatType()`或者使用并进行ajax调用 是否更好`contentType="application/json; charset=utf-8"`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:18:51.457

这是 KnpBundles 处理它的方式[https://github.com/KnpLabs/KnpBundles/blob/master/src/Knp/Bundle/KnpBundlesBundle/Controller/DeveloperController.php#L35](https://github.com/KnpLabs/KnpBundles/blob/master/src/Knp/Bundle/KnpBundlesBundle/Controller/DeveloperController.php#L35)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T17:11:13.273

我想你需要弄清楚你的意图是什么。因为现在看起来好像你`WebappController`只是你的客户`Backendcontroller`。就像是：

`$result = file_get_contents('/path/to/backend/method/1/3');`

然后，您只需继续解码 json。

这当然是一些额外的开销。如果您想获取实体，我建议为您的所有后端方法创建一个服务并在那里返回实体。然后，您只需从您的`BackendController`和您的`WebappController`. 然后，您只需将您的实体 jsonify`BackendController`并在您的`WebappController`.

# sql - 即使我在字段上指定了“不为空”，查询结果也包含空字段

> ID：14965525
> 
> 赞同：2
> 
> 时间：2013-02-19T19:13:10.417
> 
> 标签：sql

我有两个表，我正在做一个`LEFT JOIN`从第一个表中获取所有记录的表，无论第二个表是否有匹配项。

我发现有时`NULL`会回到连接列。我放入了 where 子句来过滤掉`NULL`连接列中的记录，但我仍然看到这些记录。

`SQL`为了过滤掉`NULL`连接列中有 a 的记录，我需要在下面进行什么更改？

```
select
folders.FolderId,
folders.lastUpdated,
folder.FolderName,
folder.FolderParentID
from dbo.xsdl_Folder folder
left join dbo.Folders folders
on folder.FolderID = folders.FolderID
where folder.FolderID is not null; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T19:18:40.987

如果您的 FolderId 返回 NULL，并且您打算从 Folder 表中检索所有数据，并且仅从 Folders 表中检索那些匹配的记录，那么看起来您需要更改查询以使用 folder.FolderId 而不是文件夹。 SELECT 语句中的 FolderId：

```
select
   folder.FolderId,
   folders.lastUpdated,
   folder.FolderName,
   folder.FolderParentID
from dbo.xsdl_Folder folder
   left join dbo.Folders folders
      on folder.FolderID = folders.FolderID 
```

或者，如果您正在考虑从结果中删除所有 NULL 值，请不要使用`LEFT JOIN`，而是使用`INNER JOIN`：

```
select
   folders.FolderId,
   folders.lastUpdated,
   folder.FolderName,
   folder.FolderParentID
from dbo.xsdl_Folder folder
   inner join dbo.Folders folders
      on folder.FolderID = folders.FolderID 
```

的目的`LEFT JOIN`是从第二个表（在本例中为 dbo.Folders）返回 NULL 值。

# sencha-touch-2 - Sencha Touch：导航视图 ui 项不会改变

> ID：14965529
> 
> 赞同：0
> 
> 时间：2013-02-19T19:13:34.070
> 
> 标签：sencha-touch-2

我正在尝试将导航视图的“ui”属性设置为亮，但它只显示在深色主题中。这是我的看法。我错过了什么？

```
Ext.define('VisitTCMIndy.view.Social', {
extend: 'Ext.navigation.View',
xtype: 'socialcard',

config: {
    iconCls: 'chat',
    title: 'Social',
    layout: 'card',
    ui: 'light',
    items: [
        {
            xtype: 'panel',
            title: 'Social',
            layout: 'vbox',
            items: [
                {
                    xtype: 'panel',
                    layout: 'hbox',
                    flex: 1,
                    items: [
                        {
                            xtype: 'image',
                            baseCls: 'socialbutton',
                            title: 'Facebook',
                            src: "resources/images/facebookbutton.png",
                            flex: 1
                        },
                        {
                            xtype: 'image',
                            baseCls: 'socialbutton',
                            title: 'Twitter',
                            src: "resources/images/twitterbutton.png",
                            flex: 1
                        }
                    ]
                },
                {
                    xtype: 'panel',
                    layout: 'hbox',
                    flex: 1,
                    items: [
                        {
                            xtype: 'image',
                            baseCls: 'socialbutton',
                            title: 'Pinterest',
                            src: "resources/images/pinterestbutton.png",
                            flex: 1
                        },
                        {
                            xtype: 'image',
                            baseCls: 'socialbutton',
                            title: 'Instagram',
                            src: "resources/images/instagrambutton.png",
                            flex: 1
                        }
                    ]
                },
                {
                    xtype: 'button',
                    text: 'Take a Picture',
                    style: 'margin:3%'
                }
            ]
        }
    ]

}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T22:57:40.577

如果您的意思是要更改`ui`导航视图的导航栏，那么应该这样做：

```
config: {
  iconCls: 'chat',
  title: 'Social',
  layout: 'card',
  navigationBar: {
    ui: 'dark'
  }
... 
```

希望这可以帮助

# iframe - 是否可以将表单从页面提交到具有 iframe 的另一个页面？

> ID：14965532
> 
> 赞同：2
> 
> 时间：2013-02-19T19:13:58.607
> 
> 标签：iframe, submit

是否可以将表单从页面提交到具有 iframe 的另一个页面？里面有 iframe 的页面已经有一个提交到 iframe 的提交表单。

所以，我需要页面 A 提交到页面 B，该页面在其中提交给 iframe。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:16:48.293

不，您可以做以下两件事之一：

1.  最有意义的是直接提交到 Page B 中 iframe 的 URL
2.  您还可以在页面 A 上包含 iframe，并在表单本身上放置一个 target 属性以提交给 iframe。

你设置它的方式，中间有男人，是行不通的。大多数浏览器不会让您在没有某种用户交互（例如鼠标单击或键盘事件）的情况下自动提交表单。

# c# - 非线性系列的 C# 聚合函数

> ID：14965541
> 
> 赞同：0
> 
> 时间：2013-02-19T19:14:39.717
> 
> 标签：c#, math, algebra, calculus

我有两个数组，一个代表价格，另一个代表多个单位：

例如

```
decimal[] price = new decimal[] {1.65, 1.6, 1.55, 1.4, 1.3};
long[] quantity = new long[] {5000, 10000, 12000, 20000, 50000}; 
```

所以前 5000 个单位将花费 1.65 个，下一个将花费 10000 个将花费 1.6 个，依此类推......

当您知道要订购的单位数量时，使用聚合函数很容易获得平均价格，例如 7000 单位的平均价格 = (5000/7000 * 1.65) + (2000/7000 * 1.6)，但是，我当总单位数量是未知变量时，我们无法提出一个算法，并且我们得到了目标平均价格。

例如，我必须订购多少单位，所以平均单位价格 = 1.57

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:09:30.453

如果您从几何角度考虑它，请考虑一个图表，该图表显示总价格（纵坐标）作为购买的商品总数（横坐标）的函数。情节开始于`(0, 0)`（购买零成本为零）。`1.65`首先我们得到一条斜率和水平宽度的直线段`5000`。然后从它的终点出现一个新的坡度`1.6`和宽度段`10000`。总地块是连续的、分段的直线，但在单价变化的地方有弯曲。

然后要解决您的问题，找到与方程线的交点`y == 1.57 * x`，即从 开始`(0, 0)`并具有斜率的线`1.57`。对于每个段（您知道其两个端点），检查该段是否满足`y == 1.57 * x`，如果满足，则有您的解决方案。

如果您的`price`数组中的数字正在减少，则最多可以有一个解决方案（假设它`1.57`严格小于第一个价格`price[0]`），该图表示一个凹函数。

**编辑：**我试图用 C# 编写这个几何图形。我没有添加`price`所有正面和减少的支票，而且`quantity`都是正面的。你必须检查一下。这是我的代码：

```
 decimal[] price = { 1.65m, 1.6m, 1.55m, 1.4m, 1.3m, };
        long[] quantity = { 5000, 10000, 12000, 20000, 50000, };
        decimal desiredAverage = 1.57m;

        int length = price.Length;
        if (length != quantity.Length)
            throw new InvalidOperationException();

        var abscissaValues = new long[length + 1];
        var ordinateValues = new decimal[length + 1];
        for (int i = 1; i <= length; ++i)
        {
            for (int j = 0; j < i; ++j)
            {
                abscissaValues[i] += quantity[j];
                ordinateValues[i] += price[j] * quantity[j];
            }
        } // calculation of plot complete

        int segmentNumber = Enumerable.Range(1, length).FirstOrDefault(i => ordinateValues[i] / abscissaValues[i] <= desiredAverage);
        if (segmentNumber > 1)
        {
            decimal x = (ordinateValues[segmentNumber - 1] * abscissaValues[segmentNumber] - abscissaValues[segmentNumber - 1] * ordinateValues[segmentNumber])
                / (desiredAverage * (abscissaValues[segmentNumber] - abscissaValues[segmentNumber - 1]) - (ordinateValues[segmentNumber] - ordinateValues[segmentNumber - 1]));
            Console.WriteLine("Found solution x == " + x);
        }
        else
        {
            Console.WriteLine("No solution");
        } 
```

不知道有没有人能写得更漂亮一些，不过好像还行。输出是：

> 找到解决方案 x == 29705.882352941176470588235294

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:22:56.410

我相信这是因为没有一个答案，没有*一种*价格组合会导致*一个*平均值，没有紧密形式的方程式。我们可能看到的是背包问题的一个变体。[http://en.wikipedia.org/wiki/Knapsack_problem](http://en.wikipedia.org/wiki/Knapsack_problem)具有最小化价值而不是最大化。

编辑：正如下面正确指出的，这不是背包问题的变体。有一个封闭形式的解决方案：

如果 T = 购买的总单位数，

1.57 = 1.55 * (12000/T) + 1.6 * ((T-12000)/T)。求解 T。

起始价格块（此处为 1.55）是刚好低于问题中给出的每单位平均价格（此处为 1.57）的块。

# python - 提取两个符号之间的多行数据 - 正则表达式和 Python3

> ID：14965542
> 
> 赞同：4
> 
> 时间：2013-02-19T19:14:43.487
> 
> 标签：python, regex

我有一个巨大的文件，我需要从中获取特定条目的数据。文件结构为：

```
>Entry1.1
#size=1688
704 1   1   1   4
979 2   2   2   0
1220    1   1   1   4
1309    1   1   1   4
1316    1   1   1   4
1372    1   1   1   4
1374    1   1   1   4
1576    1   1   1   4
>Entry2.1
#size=6251
6110    3   1.5 0   2
6129    2   2   2   2
6136    1   1   1   4
6142    3   3   3   2
6143    4   4   4   1
6150    1   1   1   4
6152    1   1   1   4
>Entry3.2
#size=1777
AND SO ON----------- 
```

我必须实现的是我需要提取某些条目的所有行（完整记录）。例如，我需要 Entry1.1 的记录，而不是使用条目名称 '>Entry1.1' 直到下一个 '>' 作为 REGEX 中的标记来提取其间的行。但我不知道如何构建如此复杂的 REGEX 表达式。一旦我有了这样的表达，我就会把它放在一个 FOR 循环中：

```
For entry in entrylist:
    GET record from big_file
    DO some processing
    WRITE in result file 
```

什么可能是正则表达式来执行特定条目的此类记录提取？有没有更多的pythonic方法来实现这一点？我会很感激你在这方面的帮助。

AK

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T19:56:40.137

使用正则表达式

```
import re

ss = '''
>Entry1.1
#size=1688
704 1   1   1   4
979 2   2   2   0
1220    1   1   1   4
1309    1   1   1   4
1316    1   1   1   4
1372    1   1   1   4
1374    1   1   1   4
1576    1   1   1   4
>Entry2.1
#size=6251
6110    3   1.5 0   2
6129    2   2   2   2
6136    1   1   1   4
6142    3   3   3   2
6143    4   4   4   1
6150    1   1   1   4
6152    1   1   1   4
>Entry3.2
#size=1777
AND SO ON-----------
'''

patbase = '(>Entry *%s(?![^\n]+?\d).+?)(?=>|(?:\s*\Z))'

while True:
    x = raw_input('What entry do you want ? : ')
    found = re.findall(patbase % x, ss, re.DOTALL)
    if found:
        print 'found ==',found
        for each_entry in found:
            print '\n%s\n' % each_entry
    else:
        print '\n ** There is no such an entry **\n' 
```

解释`'(>Entry *%s(?![^\n]+?\d).+?)(?=>|(?:\s*\Z))'`：

# 1)

`%s`接收条目的引用： 1.1 , 2 , 2.1 等

# 2)

该部分`(?![^\n]+?\d)`是进行验证。

`(?![^\n]+?\d)` 是一个否定的前瞻断言，它表示后面的内容`%s`一定不是数字之前的`[^\n]+?\d`任何字符`[^\n]+?``\d`

我写`[^\n]`的意思是“除换行符以外的任何字符`\n`”。
我有义务写这个而不是仅仅`.+?`因为我放置了标志`re.DOTALL` 并且模式部分`.+?`将一直运行到条目结束。
但是，我只想验证在输入的引用之后（由模式中的 %s 表示），在行尾之前不会有补充数字，输入错误

所有这一切都是因为如果有一个 Entry2.1 但没有 Entry2 ，并且用户只输入 2 因为他想要 Entry2 而没有其他，那么正则表达式会检测到 Entry2.1 的存在并产生它，尽管用户真的会实际上就像Entry2一样。

# 3)

在 结束时`'(>Entry *%s(?![^\n]+?\d).+?)`，该部分`.+?`将捕获条目的完整块，因为点代表任何字符，包括一个换行符`\n`
出于这个目的，我放置了标志`re.DOTALL`以使以下模式部分`.+?`能够传递换行符，直到条目的结尾。

# 4)

我希望匹配在所需条目的末尾停止，而不是在下一个条目内，以便由括号定义的组`(>Entry *%s(?![^\n]+?\d).+?)`将准确捕获我们想要
的因此，我在末尾放了一个积极的look-ahaed断言`(?=>|(?:\s*\Z))`说运行中的不贪婪`.+?`必须停止匹配的字符是`>`（下一个条目的开始）或字符串的结尾`\Z`。
由于最后一个条目的结尾可能不完全是整个字符串的结尾，我把`\s*`它的意思是“最后可能的空格”。
所以`\s*\Z`意味着“在撞到字符串末尾之前可以有空格”空格是a `blank` , `\f`, `\n`, `\r`, `\t`,`\v`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T21:14:22.187

我不擅长正则表达式，所以我尽可能地寻找非正则表达式的解决方案。在 Python 中，存储迭代逻辑的自然位置是在生成器中，所以我会使用这样的东西（不需要 itertools 的版本）：

```
def group_by_marker(seq, marker):
    group = []
    # advance past negatives at start
    for line in seq:
        if marker(line):
            group = [line]
            break
    for line in seq:
        # found a new group start; yield what we've got
        # and start over
        if marker(line) and group:
            yield group
            group = []
        group.append(line)
    # might have extra bits left..
    if group:
        yield group 
```

在您的示例中，我们得到：

```
>>> with open("entry0.dat") as fp:
...     marker = lambda line: line.startswith(">Entry")
...     for group in group_by_marker(fp, marker):
...         print(repr(group[0]), len(group))
...         
'>Entry1.1\n' 10
'>Entry2.1\n' 9
'>Entry3.2\n' 4 
```

这种方法的一个优点是我们永远不必在内存中保留多个组，因此对于非常大的文件非常方便。它几乎没有正则表达式那么快，尽管如果文件是 1 GB，你可能无论如何都会受到 I/O 限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:23:32.620

不完全确定你在问什么。这会让你更接近吗？它会将您的所有条目作为字典键及其所有条目的列表。假设它的格式像我相信的那样。它有重复的条目吗？这是我所拥有的：

```
entries = {}
key = ''
for entry in open('entries.txt'):
    if entry.startswith('>Entry'):
       key = entry[1:].strip() # removes > and newline
       entries[key] = []
    else:
       entries[key].append(entry) 
```

# javascript - How to write a pop-up window in javascript

> ID：14965545
> 
> 赞同：1
> 
> 时间：2013-02-19T19:14:59.553
> 
> 标签：javascript

I need to create a pop-up window like this one:
[http://gyazo.com/48a138b2e40fda7e5e72acd1b653a518](http://gyazo.com/48a138b2e40fda7e5e72acd1b653a518) in JavaScript.

When the administrator clicks on `Delete` link one parameter should be passed to JavaScript on-click function.

How can I bind different actions to OK and Cancel buttons ? My actions are like this one below:

```
<a href="<c:url value="/Invalidate.do?val=INVALIDATE"/>">Logout</a> 
```

Could anyone help me writing this piece of code (complete on-click function)? It would be great if you also show me how to attach this on-click to my link.

Thanks in advance

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:16:55.973

您可以将[window.confirm](https://developer.mozilla.org/en-US/docs/DOM/window.confirm)用于简单的事情。

如果您不介意所有的 javascript 阻塞并且无法控制样式，它就可以工作。

`confirm`并且`alert`内置于所有浏览器中，但它们非常有限，通常对于一次性以外的任何事情都不是一个非常好的主意。

为了获得更多控制，您必须[从引导程序中引入诸如](http://bootboxjs.com/)[jquery ui 对话框](http://jqueryui.com/demos/dialog/)或引导箱之类的东西，这只是 html，因此更加灵活。但除非您已经在使用相关库，否则设置起来也比较麻烦。此外，所有这些都不会阻止 javascript 的执行，这同样是更强大和更好的“实践”，但对于人们 - 尤其是初学者 - 来说也更难理解。

所以你可以做类似的事情（假设 jQuery）：

```
$('button[name=delete]').click(function() {
  if(window.confirm("You really sure?"))
     doDelete();
}); 
```

或使用 jQuery 用户界面：

```
$('button[name=delete]').click(function() {
    $('<div>').text("You really sure?")  //Create a simple text element to be dialog'ed
        .dialog({
            buttons: {
                "Yes": function(){
                    doDelete()
                    $(this).dialog('close');
                }
                ,"No": function() { $(this).dialog('close'); }
        });
}); 
```

为了完整起见，这是一种删除冗余代码的巧妙方法：

```
$('button[name=delete]').click(function() {
    $('<div>').text("You really sure?")  //Create a simple text element to be dialog'ed
        .dialog({
            buttons: {
                "Yes": closeAnd(doDelete)
                ,"No": closeAnd()
        });
    function closeAnd(fn) {   //this function is automatically hoisted
        return function() {   //return a handler
             $(this).dialog('close');  //value of 'this' is determined by who invokes it               
             fn && fn();   //invoke fn if it was passed
        }
    }
}); 
```

# c - String is off by 1 character - C

> ID：14965549
> 
> 赞同：2
> 
> 时间：2013-02-19T19:15:20.707
> 
> 标签：c, string

I am writing a code for a weather database, but when I go to print out the city and temperatures my first line is off by 1 character, and I cannot figure out why. One thing I did notice was that when i print for example printf("%20s", city); only the first city is being modified.

This is for a intro to C-Programming and they have not learned much about strings yet, which is why I read in character by character.

Here is the snippet of code I am referring to;

```
while(TRUE) {
  for(
    i=0; 
    fscanf(input,"%c", &c)!=EOF && c!='#';
    i++)
  {  //i.e. city#..
    city[i]=c;
  }

  if(c=='#') {
    city[i] = '\0';         //Next line scans in the weather for the days of the week
    fscanf(input, " (%f, %f), (%d, %d), (%d, %d), (%d, %d), (%d, %d), (%d, %d), (%d, %d), (%d, %d)",&h_avg, &l_avg,&s1,&s2,&m1,&m2,&t1,&t2,&w1,&w2,&th1,&th2,&f1,&f2,&sa1,&sa2);
    printf("%20s  %d %d", city, s1,s2);
  } else {
    printf("\n"); 
    break;
  }  //Break infinite loop because for loop broke from EOF
} 
```

Sample output:

```
 Baltimore 75 60
Miami  20 10
Washington D.C.  75 50
New York  75 50 
```

only Baltimore is being right aligned. Any help is appreciated.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T19:20:11.987

`"%c"`scanf 模式不会跳过空格，因此您的城市字符串中可能会出现空格。特别是，由于您从不扫描前一行`\n`末尾的换行符 ( )，因此您的城市名称都将以换行符开头（第一个除外）。此外，您`printf`从不打印任何换行符（城市中的换行符除外），因此可以解释您所看到的内容。

更准确地说 - 您的第二个城市被读取为`"\nMiami"`（6 个字符），所以当它打印出来时`"%20s"`，它首先打印 14 个空格。这些空格都打印`Baltimore`在行尾（因为行尾没有打印换行符），然后打印`"\nMiami"`

尝试使用：

```
for (i = 0; fscanf(input,"%c", &c)!=EOF && c!='#';) {
    if (i == 0 && isspace(c)) continue;
    city[i++] = c; }
while (i>0 && isspace(city[i-1])) i--; 
```

从城市名称中去除前导和尾随空格。

# java - Searching a linked list with O(1)

> ID：14965550
> 
> 赞同：2
> 
> 时间：2013-02-19T19:15:30.910
> 
> 标签：java, linked-list, hashtable

I was in an interview and I was asked about hashtable and I had to explain structural chaining.

I was asked how to search for an element in the linked list with O(1) complexity.

Can we actually find with O(1)?

Thanks

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T19:17:09.470

不，绝对不是。链表没有快速找到项目的巧妙方法 - 它是 O(n)。

如果您有足够好的哈希码，则在哈希表中搜索只需 O(1)。如果您*所有*的密钥都具有相同的哈希码，那么无论您使用什么寻址方案，它都是 O(n)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-19T19:17:15.727

除非您在其他结构中保留对链表中节点的引用，否则您无法在 O(1) 中访问链表中的元素。这是因为链表保留了对链表头的引用，并且必须遍历每个下一个元素以找到请求的元素，结果为 O(n)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:20:16.880

不，您不能在 O(1) 复杂度内搜索链表。

Hashtable 创建具有相同哈希值的元素的结构链或链表。

如果散列是均匀分布的（好的散列），那么散列表将具有 O(1) 的搜索元素复杂度。哈希表有桶，每个桶都可以从哈希值访问，然后每个桶包含具有相同哈希值的元素的链表。

[http://www.algolist.net/Data_structures/Hash_table/Chaining](http://www.algolist.net/Data_structures/Hash_table/Chaining)

# excel - Macro to delete a checkbox from a certain cell

> ID：14965551
> 
> 赞同：4
> 
> 时间：2013-02-19T19:15:31.097
> 
> 标签：excel, vba

I am pulling check boxes into a spreadsheet to be used to select certain line items to get a final cost. There are a few unneeded check boxes that get pulled in though, probably 5 or so total. I can use macros to get to the specific cells these unneeded check boxes. These unneeded check boxes will not always be in the same place due to my data changing so I will have to delete them one at a time which shouldn't be a problem other than I don't know the code to delete a check box from the active cell. I need a code to delete check box from active cell or selected cell. I have included some of my coding I have tried below. The first section is just getting me to the correct cell to delete the check box out of. The second part are two different codes I have tried to delete the check box but neither worked. I appreciate your input.

```
'To delete unwanted checkboxes
    Sheets("Quote Sheet").Select
    Range("B9").Select
    Selection.End(xlDown).Select
    ActiveCell.Offset(0, -1).Select

    ActiveSheet.Shapes.Range(Array("Check Box 456")).Select
    Selection.Delete
    Selection.Cut

    ActiveCell.CheckBoxes.Delete
    Selection.FormatConditions.Delete 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T19:21:20.590

此代码将删除位于活动单元格的任何 Excel 复选框。

```
Sub DeleteCheckbox()
    Dim cb As CheckBox

    For Each cb In ActiveSheet.CheckBoxes
        If cb.TopLeftCell.Address = ActiveCell.Address Then cb.Delete
    Next
End Sub 
```

如果您使用 ActiveX 复选框，此代码将完成这项工作：

```
Sub DeleteActiveXCheckbox()
    Dim obj As OLEObject
    Dim cb As MSForms.CheckBox

    For Each obj In ActiveSheet.OLEObjects
        If TypeOf obj.Object Is MSForms.CheckBox Then
            Set cb = obj.Object
            If cb.ShapeRange.Item(1).TopLeftCell.Address = _
                ActiveCell.Address Then obj.Delete
        End If
    Next
End Sub 
```

# c++ - Difficulties to measure C/C++ performance

> ID：14965553
> 
> 赞同：12
> 
> 时间：2013-02-19T19:15:36.137
> 
> 标签：c++, c, performance, optimization, measurement

I wrote a piece of C code to show a point in a discussion about optimizations and branch prediction. Then I noticed even more diverse outcome than I did expect. My goal was to write it in a language that is common subset between C++ and C, that is standard-compliant for both languages and that is fairly portable. It was tested on different Windows PCs:

```
#include <stdio.h>
#include <time.h>

/// @return - time difference between start and stop in milliseconds
int ms_elapsed( clock_t start, clock_t stop )
{
    return (int)( 1000.0 * ( stop - start ) / CLOCKS_PER_SEC );
}

int const Billion = 1000000000;
/// & with numbers up to Billion gives 0, 0, 2, 2 repeating pattern 
int const Pattern_0_0_2_2 = 0x40000002; 

/// @return - half of Billion  
int unpredictableIfs()
{
    int sum = 0;
    for ( int i = 0; i < Billion; ++i )
    {
        // true, true, false, false ...
        if ( ( i & Pattern_0_0_2_2 ) == 0 )
        {
            ++sum;
        }
    }
    return sum;
}

/// @return - half of Billion  
int noIfs()
{
    int sum = 0;
    for ( int i = 0; i < Billion; ++i )
    {
        // 1, 1, 0, 0 ...
        sum += ( i & Pattern_0_0_2_2 ) == 0;
    }
    return sum;
}

int main()
{
    clock_t volatile start;
    clock_t volatile stop;
    int volatile sum;
    printf( "Puzzling measurements:\n" );

    start = clock();
    sum = unpredictableIfs();
    stop = clock();
    printf( "Unpredictable ifs took %d msec; answer was %d\n"
          , ms_elapsed(start, stop), sum );

    start = clock();
    sum = unpredictableIfs();
    stop = clock();
    printf( "Unpredictable ifs took %d msec; answer was %d\n"
          , ms_elapsed(start, stop), sum );

    start = clock();
    sum = noIfs();
    stop = clock();
    printf( "Same without ifs took %d msec; answer was %d\n"
          , ms_elapsed(start, stop), sum );

    start = clock();
    sum = unpredictableIfs();
    stop = clock();
    printf( "Unpredictable ifs took %d msec; answer was %d\n"
          , ms_elapsed(start, stop), sum );
} 
```

Compiled with VS2010; /O2 optimizations Intel Core 2, WinXP results:

```
Puzzling measurements:
Unpredictable ifs took 1344 msec; answer was 500000000
Unpredictable ifs took 1016 msec; answer was 500000000
Same without ifs took 1031 msec; answer was 500000000
Unpredictable ifs took 4797 msec; answer was 500000000 
```

**Edit:** Full switches of compiler:

> /Zi /nologo /W3 /WX- /O2 /Oi /Oy- /GL /D "WIN32" /D "NDEBUG" /D "_CONSOLE" /D "_UNICODE" /D "UNICODE" /Gm- /EHsc /GS /Gy /fp:precise /Zc:wchar_t /Zc:forScope /Fp"Release\Trying.pch" /Fa"Release\" /Fo"Release\" /Fd"Release\vc100.pdb" /Gd /analyze- /errorReport:queue

Other person posted such ... Compiled with MinGW, g++ 4.71, -O1 optimizations Intel Core 2, WinXP results:

```
Puzzling measurements:
Unpredictable ifs took 1656 msec; answer was 500000000
Unpredictable ifs took 0 msec; answer was 500000000
Same without ifs took 1969 msec; answer was 500000000
Unpredictable ifs took 0 msec; answer was 500000000 
```

Also he posted such results for -O3 optimizations:

```
Puzzling measurements:
Unpredictable ifs took 1890 msec; answer was 500000000
Unpredictable ifs took 2516 msec; answer was 500000000
Same without ifs took 1422 msec; answer was 500000000
Unpredictable ifs took 2516 msec; answer was 500000000 
```

Now I have question. What is going on here?

More specifically ... How can a fixed function take so different amounts of time? Is there something wrong in my code? Is there something tricky with Intel processor? Are the compilers doing something odd? Can it be because of 32 bit code ran on 64 bit processor?

Thanks for attention!

**Edit:** I accept that g++ -O1 just reuses returned values in 2 other calls. I also accept that g++ -O2 and g++ -O3 have defect that leaves the optimization out. Significant diversity of measured speeds (450% !!!) seems still mysterious.

I looked at disassembly of code produced by VS2010\. It did inline `unpredictableIfs` 3 times. The inlined code was fairly similar; the loop was same. It did not inline `noIfs`. It did roll `noIfs` out a bit. It takes 4 steps in one iteration. `noIfs` calculate like was written while `unpredictableIfs` use `jne` to jump over increment.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-19T19:25:40.983

使用`-O1`，gcc-4.7.1`unpredictableIfs`只调用一次并重用结果，因为它识别出它是一个纯函数，所以每次调用的结果都是一样的。（我的做到了，通过查看生成的程序集进行了验证。）

在更高的优化级别下，函数是内联的，编译器不再识别它是相同的代码，所以每次在源代码中出现函数调用时都会运行它。

除此之外，我的 gcc-4.7.1`unpredictableIfs`在使用`-O1`or时处理**得**`-O2`最好（除了重用问题，两者都产生相同的代码），而使用. 然而，相同代码的不同运行之间的时间在这里是一致的——相等或相差 10 毫秒（粒度为），所以我不知道是什么导致您报告的时间大不相同。`noIfs`**`-O3``clock``unpredictableIfs``-O3`**

 **使用`-O2`时，for 循环`unpredictableIfs`与使用生成的代码相同`-O1`（寄存器交换除外）：

```
.L12:
    movl    %eax, %ecx
    andl    $1073741826, %ecx
    cmpl    $1, %ecx
    adcl    $0, %edx
    addl    $1, %eax
    cmpl    $1000000000, %eax
    jne .L12 
```

因为`noIfs`它是相似的：

```
.L15:
    xorl    %ecx, %ecx
    testl   $1073741826, %eax
    sete    %cl
    addl    $1, %eax
    addl    %ecx, %edx
    cmpl    $1000000000, %eax
    jne .L15 
```

它在哪里

```
.L7:
    testl   $1073741826, %edx
    sete    %cl
    movzbl  %cl, %ecx
    addl    %ecx, %eax
    addl    $1, %edx
    cmpl    $1000000000, %edx
    jne .L7 
```

与`-O1`. 两个循环的运行时间相似，`unpredictableIfs`速度稍快一些。

随着`-O3`， for 循环`unpredictableIfs`变得更糟，

```
.L14:
    leal    1(%rdx), %ecx
    testl   $1073741826, %eax
    cmove   %ecx, %edx
    addl    $1, %eax
    cmpl    $1000000000, %eax
    jne     .L14 
```

对于`noIfs`（包括此处的设置代码），它变得更好：

```
 pxor    %xmm2, %xmm2
    movq    %rax, 32(%rsp)
    movdqa  .LC3(%rip), %xmm6
    xorl    %eax, %eax
    movdqa  .LC2(%rip), %xmm1
    movdqa  %xmm2, %xmm3
    movdqa  .LC4(%rip), %xmm5
    movdqa  .LC5(%rip), %xmm4
    .p2align 4,,10
    .p2align 3
.L18:
    movdqa  %xmm1, %xmm0
    addl    $1, %eax
    paddd   %xmm6, %xmm1
    cmpl    $250000000, %eax
    pand    %xmm5, %xmm0
    pcmpeqd %xmm3, %xmm0
    pand    %xmm4, %xmm0
    paddd   %xmm0, %xmm2
    jne .L18

.LC2:
    .long   0
    .long   1
    .long   2
    .long   3
    .align 16
.LC3:
    .long   4
    .long   4
    .long   4
    .long   4
    .align 16
.LC4:
    .long   1073741826
    .long   1073741826
    .long   1073741826
    .long   1073741826
    .align 16
.LC5:
    .long   1
    .long   1
    .long   1
    .long   1 
```

它一次计算四次迭代，因此`noIfs`运行速度几乎是当时的四倍。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T19:31:40.523

对了，看看64位Linux上gcc的汇编代码，第一种情况，加上-O1，`UnpredictableIfs`确实只调用了一次函数，结果被复用了。

使用 -O2 和 -O3 时，函数是内联的，所花费的时间应该相同。任何一段代码中也没有实际的分支，但是这两位代码的翻译有些不同，我已经删除了更新“sum”的行[`%edx`在这两种情况下]

不可预测的如果：

```
movl    %eax, %ecx
andl    $1073741826, %ecx
cmpl    $1, %ecx
adcl    $0, %edx
addl    $1, %eax 
```

否：

```
xorl    %ecx, %ecx
testl   $1073741826, %eax
sete    %cl
addl    $1, %eax
addl    %ecx, %edx 
```

正如你所看到的，它并不完全相同，但它做的事情非常相似。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-20T13:56:49.653

关于 Windows 上的结果范围（从 1016 毫秒到 4797 毫秒）：您应该知道`clock()`在 MSVC 中返回[elapsed wall time](http://msdn.microsoft.com/en-us/library/4e2ess30%28v=vs.100%29.aspx)。该标准说应该返回[进程花费的 CPU 时间](http://www.cplusplus.com/reference/ctime/clock/)`clock()`的近似值，而其他实现在这方面做得更好。

鉴于 MSVC 提供了挂墙时间，如果您的进程在运行一次测试迭代时被抢占，即使代码在大约相同的 CPU 时间中运行，它也可能会产生更大的结果。

另请注意，`clock()`在许多 Windows PC 上，分辨率非常差，通常为 11-19 毫秒。您已经完成了足够多的迭代，只有大约 1%，所以我认为这不是差异的一部分，但是在尝试编写基准测试时要注意这一点是很好的。我知道您追求便携性，但如果您需要在 Windows 上进行更好的测量，您可以使用[`QueryPerformanceCounter`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644904%28v=vs.85%29.aspx)它几乎肯定会为您提供更好的分辨率，尽管它仍然只是经过墙上的时间。

**更新：**在我了解到一个案例的长时间运行持续发生后，我启动了 VS2010 并重现了结果。对于某些运行，我通常会得到大约 1000 毫秒的时间，其他一些是 750 毫秒，而对于那些莫名其妙的运行，我通常会得到 5000 多毫秒。

观察：

1.  在所有情况下，都内联了不可预测的Ifs() 代码。
2.  删除 noIfs() 代码没有影响（因此长时间不是该代码的副作用）。
3.  将线程关联设置为单个处理器没有效果。
4.  5000 毫秒的时间总是后面的实例。我注意到后面的实例在循环开始 *之前*`lea ecx,[ecx]`有一个额外的指令： . 我不明白为什么会有 5 倍的差异。除此之外，早期和后来的实例是相同的代码。
5.  `volatile`从`start`和`stop`变量中删除产生*更少的*长时间运行，更多的 750 ms 运行，并且没有 1000 ms 运行。（生成的循环代码现在在所有情况下看起来都完全相同，而不是`lea`s。）
6.  `volatile`从变量中删除`sum`（但为时钟计时器保留它），长时间运行可以发生在任何位置。
7.  如果删除所有`volatile`限定符，您将获得一致、快速（750 毫秒）的运行。（代码看起来与早期的相同，但`edi`被选择为`sum`而不是`ecx`。）

我不确定从这一切中可以得出什么结论，除非它`volatile`会对 MSVC 产生不可预测的性能影响，因此您应该仅在必要时应用它。

**更新 2：**我看到与使用 volatile 相关的一致的运行时差异，即使反汇编几乎相同。

具有挥发性：

```
Puzzling measurements:
Unpredictable ifs took 643 msec; answer was 500000000
Unpredictable ifs took 1248 msec; answer was 500000000
Unpredictable ifs took 605 msec; answer was 500000000
Unpredictable ifs took 4611 msec; answer was 500000000
Unpredictable ifs took 4706 msec; answer was 500000000
Unpredictable ifs took 4516 msec; answer was 500000000
Unpredictable ifs took 4382 msec; answer was 500000000 
```

每个实例的反汇编如下所示：

```
 start = clock();
010D1015  mov         esi,dword ptr [__imp__clock (10D20A0h)]  
010D101B  add         esp,4  
010D101E  call        esi  
010D1020  mov         dword ptr [start],eax  
    sum = unpredictableIfs();
010D1023  xor         ecx,ecx  
010D1025  xor         eax,eax  
010D1027  test        eax,40000002h  
010D102C  jne         main+2Fh (10D102Fh)  
010D102E  inc         ecx  
010D102F  inc         eax  
010D1030  cmp         eax,3B9ACA00h  
010D1035  jl          main+27h (10D1027h)  
010D1037  mov         dword ptr [sum],ecx  
    stop = clock();
010D103A  call        esi  
010D103C  mov         dword ptr [stop],eax 
```

没有挥发物：

```
Puzzling measurements:
Unpredictable ifs took 644 msec; answer was 500000000
Unpredictable ifs took 624 msec; answer was 500000000
Unpredictable ifs took 624 msec; answer was 500000000
Unpredictable ifs took 605 msec; answer was 500000000
Unpredictable ifs took 599 msec; answer was 500000000
Unpredictable ifs took 599 msec; answer was 500000000
Unpredictable ifs took 599 msec; answer was 500000000

    start = clock();
00321014  mov         esi,dword ptr [__imp__clock (3220A0h)]  
0032101A  add         esp,4  
0032101D  call        esi  
0032101F  mov         dword ptr [start],eax  
    sum = unpredictableIfs();
00321022  xor         ebx,ebx  
00321024  xor         eax,eax  
00321026  test        eax,40000002h  
0032102B  jne         main+2Eh (32102Eh)  
0032102D  inc         ebx  
0032102E  inc         eax  
0032102F  cmp         eax,3B9ACA00h  
00321034  jl          main+26h (321026h)  
    stop = clock();
00321036  call        esi
// The only optimization I see is here, where eax isn't explicitly stored
// in stop but is instead immediately used to compute the value for the
// printf that follows. 
```

除了寄存器选择之外，我没有看到显着的差异。**

# linux - breaking the parameters of shell script into several causes errors

> ID：14965559
> 
> 赞同：2
> 
> 时间：2013-02-19T19:16:03.507
> 
> 标签：linux, bash, shell

I have a shell script using a phantom js function

The Phantom JS function crashes when it is run on too many urls apparently, I tried to rewrite it to only do part at a time but I get an error where the $url variable does not change so it always copies down the same url though it appears to write down the actual size of the site.

If I could be helped through that error that would be glorious.

```
#!/bin/bash
echo "Importing URLs..."
file=sizeurls.csv
url=""
while IFS= read -r line
do
     url+=" "
     url+=$line
done < "$file"
echo "Gathering page sizes..."
phantomjs yslow.js --info basic --format plain $url | grep 'url\|size' > temp.txt
echo "Formatting data..."
sed -i 's/size://g' temp.txt
sed -i 's/url://g' temp.txt
paste - - -d, < temp.txt > pagesize.csv
echo "Done!" 
```

version that is supposed to do part at a time, it may be mortally screwed because I just messed with it a little bit an d I am not sure I returned it to the previous state

```
#!/bin/bash 
echo "Importing URLs..."
file=sizeurls.csv
url=""
i=0;

while  IFS= read -r line  
do

  while [ $i -le 10 ] #10 at a time i < 10
  do
     url+=" "
     url+=$line
     i=$((i+1));

  done < "$file"

phantomjs yslow.js --info basic --format plain $url | grep 'url\|size' >> temp.txt
#echo "Formatting data..."
sed -i 's/size://g' temp.txt
sed -i 's/url://g' temp.txt
paste - - -d, < temp.txt >> pagesize.csv
done < "$file"
i = 0

echo "Done!" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:00:05.950

为什么不一次做一个呢？

```
#!/bin/bash
echo "Importing URLs..."
file=sizeurls.csv

echo "Gathering page sizes..."
while IFS= read -r url
do
  phantomjs yslow.js --info basic --format plain $url | grep 'url\|size'
done < "$file" > temp.txt

echo "Formatting data..."
sed -i -e 's/size://g' -e 's/url://g' temp.txt
paste - - -d, < temp.txt > pagesize.csv

echo "Done!" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:55:13.790

这可能会给您一些想法（未经测试，但看起来不错）。处理转移到一个函数，每 10 个 URL 调用一次，如果有任何剩余的 URL，则在最后再次调用。

```
#!/bin/bash
echo "Importing URLs..."
file=sizeurls.csv
rm pagesize.csv

ProcessURLs () {
    echo "Gathering page sizes..."
    phantomjs yslow.js --info basic --format plain $@ | grep 'url\|size' > temp.txt
    echo "Formatting data..."
    sed -i 's/size://g' temp.txt
    sed -i 's/url://g' temp.txt
    paste - - -d, < temp.txt >> pagesize.csv
}

url=""
count=0
while IFS= read -r line
do
    url+="$line$ "
    (( count++ ))
    # Procss URLs in 10-URL chunks
    if [[ $count -ge 10 ]] ; then
        ProcessURLs $url
        url=''
        count=0
    fi
done < "$file"

# Handle any remaining URLs
[ -n "$url" ] && ProcessURLs $url

echo "Done!" 
```

# html - HTML5 video and encoding checklist

> ID：14965565
> 
> 赞同：1
> 
> 时间：2013-02-19T19:16:23.610
> 
> 标签：html, html5-video

So I did a little searching about the whole issue with **HTML5 video tag** etc. My client doesnt want the videos to be played through FLASH and general youtube. So he wants a custom video player and we should upload the video files to our server.

I have a problem displaying the video in **Google Chrome** why is that? [http://www.2kfilms.com/jw_test2.html](http://www.2kfilms.com/jw_test2.html)

In the above link you can see that it displays normally in IE. I found out that the best encoding you should have with HTML5 is: **H.264** **OGG** and **WEBM**

So if I have the 3 different formats will it also play in Chrome? Even this video here: [http://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_video](http://www.w3schools.com/tags/tryit.asp?filename=tryhtml5_video) doesnt play in my Google Chrome, and I find it weird. Its black and I can only hear **Audio**

# sql - 如果查询返回空白，如何在字段中复制？

> ID：14965566
> 
> 赞同：0
> 
> 时间：2013-02-19T19:16:27.467
> 
> 标签：sql, oracle, oracle11g

我正在从两个不同的表中编写查询。

表 A 和表 B

这是查询。

```
select 
        A.OUT_NUM,
        A.TIMESTAMP,
        A.LAST_name,
        A.event_type, 
        A.comments,
        B.name
   from TABLEA A
   left outer join TABLEB B ON A.feed_id = B.id
   where A.OUT_NUM = '12345'
   and A.event_type In ('cause','status') 
```

`B.NAME`不为空，`event_type = xyz`否则为空

我只想看什么时候`event_type in ('CAUSE','STATUS')`，还想看名称字段但不为空。

第二张桌子是我想要实现的。 ![在此处输入图像描述](../Images/16d0ee9b533f99fe949636b281946ba7.png)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:42:53.483

使用 NVL() 和 LAG() 函数。

使用我的样本数据的一般示例。此查询用数据填充空白行 - 请参阅 first_exam 和 last_exam 列：

```
SELECT id, name, proc_date, proc_type, first_exam_date
     , NVL(prev_exam_date, LAG(prev_exam_date) OVER (ORDER BY name, proc_date)) last_exam_date
  FROM
   (
   SELECT id, name, proc_date, proc_type, first_exam_date
     , NVL(first_exam_date, LAG(first_exam_date) OVER (ORDER BY name, proc_date) ) prev_exam_date
    FROM
  (
  SELECT id
       , name
       , proc_date
       , proc_type
      , (SELECT MIN(proc_date) OVER (PARTITION BY name, proc_date)
           FROM stack_test WHERE proc_type LIKE 'Exam%' AND a.id = id 
       ) first_exam_date
   FROM stack_test a
  ));
  ID    NAME    PROC_DATE    PROC_TYPE    FIRST_EXAM_DATE    LAST_EXAM_DATE
  --------------------------------------------------------------------------
  1    George    1/1/2013    ExamA             1/1/2013      1/1/2013
  2    George    1/3/2013    TreatmentA                      1/1/2013
  3    George    1/5/2013    TreatmentB                      1/1/2013
  4    George    2/1/2013    ExamB             2/1/2013      2/1/2013
  5    George    2/5/2013    TreatmentA                      2/1/2013 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T20:22:58.050

对评论中的数据做出一些假设，特别是关于如何匹配和选择替代`name`值；并使用一些我认为与您匹配的虚拟数据：

```
create table tablea(out_num number,
    equip_name varchar2(5),
    event_type varchar2(10),
    comments varchar2(10),
    timestamp date, feed_id number);

create table tableb(id number, name varchar2(10));

alter session set nls_date_format = 'MM/DD/YYYY HH24:MI';

insert into tablea values (12345, null, 'abcd', null, to_date('02/11/2013 11:12'), 1);
insert into tablea values (12345, null, 'abcd', null, to_date('02/11/2013 11:11'), 1);
insert into tablea values (12345, null, 'abcd', null, to_date('02/11/2013 11:06'), 1);
insert into tablea values (12345, null, 'abcd', null, to_date('02/11/2013 11:06'), 1);
insert into tablea values (12345, null, 'SUB', null, to_date('02/11/2013 11:11'), 2);
insert into tablea values (12345, null, 'SUB', null, to_date('02/11/2013 11:12'), 2);
insert into tablea values (12345, null, 'XYZ', null, to_date('02/11/2013 11:13'), 3);
insert into tablea values (12345, null, 'XYZ', null, to_date('02/11/2013 11:13'), 3);
insert into tablea values (12345, null, 'XYZ', null, to_date('02/11/2013 11:13'), 3);
insert into tablea values (12345, null, 'XYZ', null, to_date('02/11/2013 11:13'), 3);
insert into tablea values (12345, null, 'XYZ', null, to_date('02/11/2013 11:13'), 3);
insert into tablea values (12345, null, 'XYZ', null, to_date('02/11/2013 11:03'), 3);
insert into tablea values (12345, null, 'CAUSE', 'APPLE', to_date('02/11/2013 11:13'), 4);
insert into tablea values (12345, null, 'CAUSE', 'APPLE', to_date('02/11/2013 11:13'), 4);
insert into tablea values (12345, null, 'CAUSE', 'APPLE', to_date('02/11/2013 11:13'), 4);
insert into tablea values (12345, null, 'STATUS', 'BOOKS', to_date('02/11/2013 11:13'), 5);
insert into tablea values (12345, null, 'STATUS', 'BOOKS', to_date('02/11/2013 11:13'), 5);
insert into tablea values (12345, null, 'STATUS', 'BOOKS', to_date('02/11/2013 11:03'), 5);

insert into tableb values(3, 'LION'); 
```

这会得到你的结果：

```
select * from (
    select a.out_num,
        a.timestamp,
        a.equip_name,
        a.event_type,
        a.comments,
        coalesce(b.name,
            first_value(b.name)
                over (partition by a.out_num
                    order by b.name nulls last)) as name
    from tablea a
    left outer join tableb b on a.feed_id = b.id
    where a.out_num = '12345'
    and a.event_type in ('CAUSE', 'STATUS', 'XYZ')
)
where event_type in ('CAUSE', 'STATUS');

   OUT_NUM TIMESTAMP          EQUIP_NAME EVENT_TYPE COMMENTS   NAME     
---------- ------------------ ---------- ---------- ---------- ----------
     12345 02/11/2013 11:03              STATUS     BOOKS      LION       
     12345 02/11/2013 11:13              STATUS     BOOKS      LION       
     12345 02/11/2013 11:13              STATUS     BOOKS      LION       
     12345 02/11/2013 11:13              CAUSE      APPLE      LION       
     12345 02/11/2013 11:13              CAUSE      APPLE      LION       
     12345 02/11/2013 11:13              CAUSE      APPLE      LION 
```

内部查询包括`XYZ`并使用分析`first_value()`函数来选择`name`如果直接匹配的值是`null`-`coalesce`如果真的永远不会有直接匹配，则可能没有必要。（如果假设错误，您可能还需要调整`partition by`or子句）。`order by`外部查询只是删除`XYZ`记录，因为您不想要这些记录。

* * *

如果您想`name`从任何匹配的记录中获取值，那么只需删除内部查询中的过滤器。

但是现在您可能更有可能拥有多个非空记录；如果它存在，这会给你一个匹配`a.feed_id`的，或者如果它不存在，它会给你一个匹配的“第一个”（按字母顺序，ish）`out_num`。您可以改为订购，或;`b.id`中的任何其他列 `tableb`订购任何东西`tablea`都需要不同的解决方案。如果无论如何你只会有一个可能的匹配，那么这并不重要，你可以省略`order by`，尽管最好还是拥有它。

如果我为不同的添加更多数据`out_num`：

```
insert into tablea values (12346, null, 'abcd', null, to_date('02/11/2013 11:11'), 1);
insert into tablea values (12346, null, 'SUB', null, to_date('02/11/2013 11:12'), 2);
insert into tablea values (12346, null, 'XYZ', null, to_date('02/11/2013 11:13'), 6);
insert into tablea values (12346, null, 'CAUSE', 'APPLE', to_date('02/11/2013 11:14'), 4);
insert into tablea values (12346, null, 'STATUS', 'BOOKS', to_date('02/11/2013 11:15'), 5);

insert into tableb values(1, 'TIGER'); 
```

...然后这个 - 只是过滤器被丢弃了，我`coalesce`这次省略了 - 给出了相同的答案`12345`，而这个`12346`：

```
select * from (
    select a.out_num,
        a.timestamp,
        a.equip_name,
        a.event_type,
        a.comments,
        first_value(b.name)
            over (partition by a.out_num
                order by b.name nulls last) as name
    from tablea a
    left outer join tableb b on a.feed_id = b.id
)
where out_num = '12346'
and event_type in ('CAUSE', 'STATUS');

   OUT_NUM TIMESTAMP          EQUIP_NAME EVENT_TYPE COMMENTS   NAME     
---------- ------------------ ---------- ---------- ---------- ----------
     12346 02/11/2013 11:14              CAUSE      APPLE      TIGER      
     12346 02/11/2013 11:15              STATUS     BOOKS      TIGER 
```

...`TIGER`链接到哪里`abcd`，不是`XYZ`。

# asp.net - 在 MVC4 中为 WebApi 路由多个获取

> ID：14965578
> 
> 赞同：1
> 
> 时间：2013-02-19T19:17:10.033
> 
> 标签：asp.net, asp.net-mvc, rest, routing

我在 ASP.NET MVC4 中创建了一个 rest API，并且遇到了路由问题。作为参考，我已经阅读了这些问题，但他们没有回答我的问题：

*   [Web API 路由 - api/{controller}/{action}/{id} “dysfunctions” api/{controller}/{id}](https://stackoverflow.com/questions/13596391/web-api-routing-api-controller-action-id-dysfunctions-api-controller)
*   [ASP.NET MVC 4 中多个 Get 方法的 Web Api 路由](https://stackoverflow.com/questions/12775590/web-api-routing-for-multiple-get-methods-in-asp-net-mvc-4)
*   [Asp.net Mvc 4 和 Web Api 中的路由](https://stackoverflow.com/questions/12775887/routing-in-asp-net-mvc-4-and-web-api)

我要制作的网址如下：

1.  GET /account/id（其中 id 是一个 Guid） - 相当于 GET /account/?id=x
2.  GET /account/first%20last%20name（其中 name 是一个字符串） - 相当于 GET /account/?name=x
3.  GET /pendingregistrations/?page=y （此处省略动作）
4.  POST /pendingregistrations/denyregistration?denyId=x（这里指定了一个动作）

如您所见，在某些情况下，控制器名称后的 URL 映射到参数（上面 #1,2 中的 id 和名称），有时是操作名称（上面 #4）。此外，它可能根本不存在（上面的#3），在这种情况下，我假设一个默认操作。这是适用于几乎所有情况的路由：

```
 // Match for an id next.
    config.Routes.MapHttpRoute(
        name: "WithIdApi",
        routeTemplate: "api/{controller}/{id}",
        defaults: new { action = "Index" },
        constraints: new
        {
            id = @"^(\{{0,1}([0-9a-fA-F]){8}-([0-9a-fA-F]){4}-([0-9a-fA-F]){4}-([0-9a-fA-F]){4}-([0-9a-fA-F]){12}\}{0,1})$"
        }
    );

    // Match for a name next.
    config.Routes.MapHttpRoute(
        name: "WithNameApi",
        routeTemplate: "api/{controller}/{name}",
        defaults: new { action = "Index" }
    );

    // Match for an action last.
    config.Routes.MapHttpRoute(
        name: "WithActionApi",
        routeTemplate: "api/{controller}/{action}",
        defaults: new { action = "Index" }
    ); 
```

此代码适用于除了上面的示例 #4 之外的所有内容，因为 MVC 无法区分 'name' 参数和 'action' 绑定之间的区别。如果我更改顺序（即，将匹配项放在上面），那么“名称”参数示例将永远无法工作。

有谁知道我可以做到这一点的任何方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:11:08.117

好吧，对于其他试图这样做的人来说，答案是不可能的。最好的办法是将“名称”搜索移动到它自己的操作中。例如：

*   GET /account/id（其中 id 是 Guid）
*   GET /account/name/first%20last

如果一个或另一个失败并且其他绑定可用，我会假设 MVC 会尝试匹配参数或操作，但遗憾的是事实并非如此。

# javascript - 鼠标悬停覆盖 div 仅在循环的第一个结果时保持定位

> ID：14965587
> 
> 赞同：0
> 
> 时间：2013-02-19T19:17:37.347
> 
> 标签：javascript, loops, mouseover, css-position

如果您将鼠标悬停在图像按钮上，我有一个覆盖 div 的脚本。

这适用于一个实例，但如果结果不止一个（在 mysql 循环中），则覆盖框将保留最顶部的结果。我怎样才能让这个跟随并跳下来列出每个结果，而不仅仅是第一个？如果将鼠标悬停在列表下方的每个按钮上，它会弹出，但弹出窗口的位置不会向下移动。

我确信这与位置有关：绝对与相对等。但是当我更改这些时，脚本不再起作用。不确定是否有替代此叠加功能的方法？

最终结果是我有一个结果列表供客户查看。每个列表都有按钮，他们可以将鼠标悬停在其中以查看注释。

// 循环中的 div...

```
<div style="float:left; position: relative;" onmouseover="callMouseOver()" onmouseout="callMouseOut()">
<img style="padding:0 12px 0 12px;" src="/images/llm/button-account-notes.png">
    <div id="child" class="areas_served_container shadow">
    pop up content
    </div>
</div> 
```

// 页脚中的脚本

```
<script language="javascript">
function callMouseOver(){
document.getElementById("child").style.display = "inline";
}

function callMouseOut(){    
document.getElementById("child").style.display = "none";    
}
</script> 
```

// 覆盖的 div 样式表

```
.areas_served_container {
display: none; position: absolute; 
top:44px; left:94px; 
z-index:999px; 
width:350px; padding:20px; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:46:43.130

你不能有多个相同的元素`id`。它必须是独一无二的。然后你必须为你的函数添加参数。但是你应该使用 jQuery 而不是发明轮子。

# java - 如何使用套接字编写和读取 JSON？

> ID：14965588
> 
> 赞同：2
> 
> 时间：2013-02-19T19:17:38.893
> 
> 标签：java, android, json, gson

我已经为此苦苦挣扎了一段时间，我真的不知道如何解决这个问题。我正在使用Java 服务器`JsonReader`并`JsonWriter`与之通信。

写入服务器工作正常，但每当我打电话时`reader.beginArray()`，我都会得到一个`EOFException`，所以我不知道如何正确读取和写入服务器。错误：

```
02-19 19:10:07.576: W/System.err(1334):     java.io.EOFException: End of input at line 1 column 1
02-19 19:10:07.586: W/System.err(1334):     at com.google.gson.stream.JsonReader.nextNonWhitespace(JsonReader.java:943)
02-19 19:10:07.606: W/System.err(1334):     at com.google.gson.stream.JsonReader.nextValue(JsonReader.java:771)
02-19 19:10:07.606: W/System.err(1334):     at com.google.gson.stream.JsonReader.peek(JsonReader.java:367)
02-19 19:10:07.606: W/System.err(1334):     at com.google.gson.stream.JsonReader.expect(JsonReader.java:337)
02-19 19:10:07.617: W/System.err(1334):     at com.google.gson.stream.JsonReader.beginArray(JsonReader.java:306)
02-19 19:10:07.617: W/System.err(1334):     at com.example.lecture9.MyService.write(MyService.java:40)
02-19 19:10:07.617: W/System.err(1334):     at com.example.lecture9.MyService.connect(MyService.java:70)
02-19 19:10:07.626: W/System.err(1334):     at com.example.lecture9.MainActivity$1$1.run(MainActivity.java:84) 
```

* * *

```
 @Override
        public void write(Message msg) throws IOException{
            //gson = new Gson();
            //writer = new JsonWriter(new BufferedWriter(new OutputStreamWriter(s.getOutputStream(), "UTF-8")));
            //reader = new JsonReader(new BufferedReader(new InputStreamReader(s.getInputStream(), "UTF-8")));
            writer.beginArray();

            gson.toJson(msg, msg.getClass(), writer);
            writer.flush();

            reader.beginArray();
            msg = gson.fromJson(reader, Message.class);

            System.out.println(msg);

            reader.endArray();
            writer.endArray();
            reader.close();
            writer.close();

            //try{          
                //gson.toJson(msg, msg.getClass(), writer);
                //writer.flush();
            //}
            //catch(Exception e){ e.printStackTrace(); }
        }

        @Override
        public boolean connect(String ipAddress, int port) {
            Socket s = null;
            try{
                InetAddress serverAddr = InetAddress.getByName(ipAddress);
                s = new Socket(serverAddr, port);
                gson = new Gson();
                writer = new JsonWriter(new BufferedWriter(new OutputStreamWriter(s.getOutputStream(), "UTF-8")));
                reader = new JsonReader(new BufferedReader(new InputStreamReader(s.getInputStream(), "UTF-8")));
                //writer.beginArray();

                Message login = new Message ("CLIENT");
                login.getH().setType("LOG");
                write(login);

                return true;
            } 
            catch (Exception e) {
                e.printStackTrace();
                return false;
            }
        } 
```

# ios - iOS 分享自定义对话框

> ID：14965590
> 
> 赞同：1
> 
> 时间：2013-02-19T19:17:47.850
> 
> 标签：ios, dialog, share

我想知道使用哪个 API 来显示这个内置对话框？我想，一旦我知道 api 是什么，我就可以自己弄清楚如何做 facebook、twitter、电子邮件等。

谢谢..

![对话框](../Images/8af5db8f38194bd3fcf1e1a066b8d620.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:21:02.660

活动视图控制器...

试试这个框架

[https://github.com/romaonthego/REActivityViewController](https://github.com/romaonthego/REActivityViewController)

# javascript - 是否可以流动子 div 并使用水平溢出使它们填充主 div？

> ID：14965592
> 
> 赞同：1
> 
> 时间：2013-02-19T19:17:51.190
> 
> 标签：javascript, css, html, overflow, fill

我现在开始考虑这个问题，我正在考虑是否可以仅使用 css 或需要 javascript 来实现。

我得到了一张显示此处示例的图像：![图片](../Images/4ff61095ca54dafe53ac4c27d67dad4d.png)

以前有人见过这样的东西吗？可以给我看一些例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:24:12.443

你可以用一张桌子来达到这个效果。当您添加项目时，只需附加一个新单元格。使项目稍微向左或向右只是相对位置；左：-一些像素。

![演示玩具](../Images/19ca7003a26adf45aca32ffdd94fcd11.png)

```
.table {
    display:table;
}
.table > div {
    display:table-row;
}
.table > div > div {
    display:table-cell;
    padding:2px;
    vertical-align:top;
} 
```

[演示玩具/小提琴](http://jsfiddle.net/wrq8Q/)*使用 jquery 进行演示，但实际工作是在 css 中完成的。

# android - 图片按钮 ID 冲突？

> ID：14965594
> 
> 赞同：0
> 
> 时间：2013-02-19T19:18:11.497
> 
> 标签：android, imagebutton

我的应用程序在使用按钮时工作，但是当我尝试使用图像按钮时，我得到一个运行时异常“无法启动活动.......ClassCastException：android：widget：button。

我像这样在java文件中按ID设置按钮

btn=(按钮)findViewById(R.id.button);

这是xml中的ImageButton

```
<ImageButton
    android:id="@+id/button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="@string/hello_world" 
    android:adjustViewBounds="true"
    android:src="@drawable/ball"
android:scaleType="centerCrop"/> 
```

我尝试清理项目但没有成功。我错过了什么？？

帮助！

提前致谢

大学教师

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:19:07.467

ImageButton**不是**按钮。这意味着您不能将一个投射到另一个时期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:21:26.910

[ImageButton 扩展了 ImageView](http://developer.android.com/reference/android/widget/ImageButton.html)

感谢 Android 开发人员提供了如此清晰的逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-20T05:09:58.307

正确的代码是：`btn=(ImageButton)findViewById(R.id.button);`

# javascript - Knockout JS 模型继承

> ID：14965596
> 
> 赞同：25
> 
> 时间：2013-02-19T19:18:21.733
> 
> 标签：javascript, inheritance, knockout.js

我的应用程序中有三个相对相似的淘汰模型，我想扩展一个基本模型以结合公共属性，而不是重复自己三次。

例子

```
var ItemModel = function (item) {
  var self = this;

  self.order = ko.observable(item.order);
  self.title = ko.observable(item.title);
  self.price = ko.observable(item.price);
  self.type = ko.observable(item.type);
};

var StandardItemModel = function (item, cartItemTypes) {
  var self = this;

  self.order = ko.observable(item.order);
  self.title = ko.observable(item.title);
  self.price = ko.observable(item.price);
  self.type = ko.observable(item.type);

  self.isInCart = ko.computed(function () {
    return cartItemTypes().indexOf(item.type) > -1;
  }, self);

  self.itemClass = ko.computed(function () {
     return self.isInCart() ? "icon-check" : "icon-check-empty";
  }, self);
};

var CustomItemModel = function (item) {
  var self = this;

  self.order = ko.observable(item.order);
  self.title = ko.observable(item.title);
  self.price = ko.observable(item.price);
  self.type = ko.observable(item.type);

  self.icon = item.icon;
}; 
```

我想使用 ItemModel 作为基类，并根据需要添加额外的属性。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-02-19T21:44:47.590

我认为您可以像这样使用 ko.utils.extend

```
ko.utils.extend(self, new ItemModel(item)); 
```

在 StandardItemModel 内

像这样：http: [//jsfiddle.net/marceloandrader/bhEQ6/](http://jsfiddle.net/marceloandrader/bhEQ6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:36:17.390

我想你可以这样做：

```
var StandardItemModel = function (item, cartItemTypes) {
var self = this;
self.standard = new ItemModel(item);
self.isInCart = ko.computed(function () {
return cartItemTypes().indexOf(item.type) > -1;
}, self);

self.itemClass = ko.computed(function () {
 return self.isInCart() ? "icon-check" : "icon-check-empty";
 }, self);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-20T05:35:40.340

```
function MyBaseType() {
    var self = this;
    self.Id = 1
}

function MyComplexType() {
    var self = this;

    //Extending this class from MyBaseType
    ko.utils.extend(self, new MyBaseType());

    self.Name = 'Faisal';

    self.MyComplexSubType = new MyComplexSubType();
}

function MyComplexSubType() {
    var self = this;

    self.Age = 26;
} 
```

[JSFIDDLE 示例](http://jsfiddle.net/FKN717/e5gsjb8p)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-04T01:45:35.183

您可以使用 .call 或 .apply 链接构造函数调用

```
function ItemModel (item) {
    var self = this;

    self.order = ko.observable(item.order);
    self.title = ko.observable(item.title);
    self.price = ko.observable(item.price);
    self.type = ko.observable(item.type);
}

function StandardItemModel(item, cartItemTypes) {
    var self = this;

    ItemModel.call(this, item);

    self.isInCart = ko.computed(function () {
        return cartItemTypes().indexOf(item.type) > -1;
    }, self);

    self.itemClass = ko.computed(function () {
        return self.isInCart() ? "icon-check" : "icon-check-empty";
    }, self);
}

function CustomItemModel (item) {
    var self = this;

    ItemModel.apply(this, [item]);

    self.icon = item.icon;
} 
```

The advantage over `ko.utils.extend` (or similar methods from jQuery, underscore, etc) is that you are not creating an additional object just to grab references to its methods.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-19T19:24:22.227

我做了类似的事情，经过大量的反复试验，但我得到了这个为我工作：

```
var StandardItemModel = function (item, cartItemTypes) {
    var self = this;
    ItemModel.call(self, item)
} 
```

然后，您需要添加一个原型构造函数：

```
StandardModel.prototype = new ItemModel(); 
```

如果您想拥有通用方法，则需要使用原型将它们添加到基类中以添加它们，然后使用以下方法在更高的类中调用它们：

```
ItemModel.prototype.methodName.call(self, parameters); 
```

# android - 仅通过 ViewPager 中的点击手势

> ID：14965601
> 
> 赞同：0
> 
> 时间：2013-02-19T19:18:37.660
> 
> 标签：android, android-viewpager, motionevent

我想实现一个不可滚动的`ViewPager`. [人们说](https://stackoverflow.com/questions/7814017/disable-viewpager)我应该重写`onInterceptTouchEvent`and`onTouchEvent`函数：

```
@Override
public boolean onTouchEvent(MotionEvent event) {
    if (this.enabled) {
        return super.onTouchEvent(event);
    }

    return false;
}

@Override
public boolean onInterceptTouchEvent(MotionEvent event) {
    if (this.enabled) {
        return super.onInterceptTouchEvent(event);
    }

    return false;
} 
```

好吧，我现在不能刷。但我也需要已经消失的水龙头！它们都`MotionEvents`带有`action=ACTION_DOWN`，那么在这种情况下，我如何才能将它们与另一个区分开来并仅通过水龙头？

PS什么鬼？在 iOS 中，我可以通过取消选中一个复选标记来禁用滚动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:42:12.883

答案是扫动是一种以 开头`ACTION_DOWN`和结尾的连续触摸手势`ACTION_UP`。所以我只能通过触摸`action=ACTION_DOWN`

```
@Override
public boolean onTouchEvent(MotionEvent event) {
    if (this.enabled || event.getAction() == MotionEvent.ACTION_DOWN) {
        return super.onTouchEvent(event);
    }

    return false;
} 
```

# jakarta-ee - 使用 Apache iBatis SqlMaps queryForList 进行分页

> ID：14965607
> 
> 赞同：2
> 
> 时间：2013-02-19T19:18:53.777
> 
> 标签：jakarta-ee, pagination, oracle11g, ibatis

这篇[关于使用 Apache iBatis SqlMaps 进行分页的好文章](http://www.mhaller.de/archives/86-Pagination-with-Apache-iBatis-SqlMaps.html)指出，如果我们像示例中那样调用 queryForList API，iBatis 会使用数据库游标进行物理分页，如果可用，则使用 ResultSet.absolute(position)：

```
final List<product> queryForList = sqlMapClient.queryForList("SELECT",  
          parameter, paginationContext.getSkipResults(),  
          paginationContext.getMaxResults()); 
```

在 DataSource 由通过 jdbc (ojdbc6.jar) 连接的 Oracle 11g 组成的情况下，这究竟意味着什么？

iBatis 是否会以某种方式更改发送给 Oracle 以处理分页的查询语句？我可以确定只有所需数据页的记录从数据库传输到应用程序吗？它在幕后如何运作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-26T07:23:57.417

@ibatis 首先判断数据库是否支持该`rs.absolute(seekPosion)`方法，它将取出所有记录并从记录中过滤。

对于大数据检索，不建议您这样做，而应使用数据库中的分页。

MySQL：

```
limit offset,maxSize 
```

甲骨文：

```
select B.* from (select b.*,rownum as linenum from A b where rownum>offset) B where B.linenum<mazSize; 
```

# c - 在 C 中实现连接函数的问题

> ID：14965608
> 
> 赞同：0
> 
> 时间：2013-02-19T19:18:55.723
> 
> 标签：c, string, concatenation

我对 C 中的指针仍然很陌生，并且一直在尝试制作字符串函数。这个应该连接两个字符串，但是当我尝试运行它时，它崩溃了。

```
void concatenate (char *a, char *b, int size_a, int size_b) {
    char *c, *d, *e;
    c = a;
    d = b;
    int i, j, k;
    int l = 1;

    for(i = 0; i<size_a; i++) {
        *(e+i) = *(c+i);
    }
    for (j = size_a; j<size_a+size_b; j++) {
        *(e+j) = *(d+(j-(j-l)));
        l++;
    }
    for (k = 0; k< size_a+size_b; k++){
        printf("%c",*(e+k));
    }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:24:49.503

您正在尝试访问未初始化指针`e`指向的内存，这会导致**未定义的行为**。

您的函数应如下所示：

```
char* concatenate (const char *a, const char *b, int size_a, int size_b) {
    // create new string:
    char* newStr = malloc (size_a + size_b + 1);
    int i, j;

    // copy first string into it:
    for (i = 0; i<size_a; i++)
        newStr[i] = a[i];

    // copy second string into it:
    for (j = 0; j < size_b; j++)
        newStr[i + j] = b[j];

    newStr[i + j] = '\0';
    return newStr;
} 
```

请注意，函数不会更改传递给它的字符串，因此它们可以作为`const`. `size_a`and`size_b`应该等于`strlen(a)`and ，这`strlen(b)`也意味着如果你总是将 null 终止的字符串传递给这个函数，你可以在它的主体内自己计算它们的长度（这样你就可以去掉最后两个参数）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:23:24.847

e 是一个未初始化的指针，这意味着它指向内存中的某个随机位置。当你开始写它，就好像它是一个指向字符数组的指针一样，你的程序会崩溃（或者更糟的是，改变一些状态神秘地导致稍后未指定的行为）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:30:44.407

您的代码似乎无缘无故地被混淆了。问题是您分配给`e`未初始化的 。以下几乎是您的代码以更易读的形式和已`e`分配。不过，我还没有测试过。

```
void concatenate (char *c, char *d) {    
    char *e; 
    e = calloc(strlen(c) + strlen(d) + 1, sizeof(char));
    int i, j;
    int l = 1;

    for(i = 0; c[i]; i++) {
        e[i] = c[i];
    }
    l = i;
    for (j = 0; d[j]; j++) {
        e[l + j] = d[j];
    }
    e[l + j] = '\0';

    printf("%s", e);

    free(e);
} 
```

# sql - 如何抑制 sp_configure 的输出？

> ID：14965609
> 
> 赞同：1
> 
> 时间：2013-02-19T19:18:57.627
> 
> 标签：sql, tsql

我不想从 sp_configure 的执行中得到输出消息。我该怎么做才能没有消息？

我没有发现任何有用的东西。

我在应用程序中使用该过程，我必须停止 sql(t-sql) 中的消息。

exec master..sp_configure '显示高级选项', 1 重新配置

消息配置选项“显示高级选项”从 0 更改为 1。运行 RECONFIGURE 语句进行安装。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:35:50.097

我所知道的抑制来自任何系统过程（如 和其他）的输出的唯一方法`sp_configure`是`sp_rename`创建一个小的 CLR 程序集来运行它们。除非您花费额外的精力来保存它，否则它会“吃掉”输出。

程序集可能很简单，只需在上下文连接上执行传入的命令，类似于`sp_executesql`. 但是请注意，任何结果集也不会返回。

如果您需要示例代码，请查看[tSQLt 测试框架](http://tsqlt.org)。它在 FakeTable 和 SpyProcedure 方法中使用了这种技术。

# c - OpenMP (C) 空闲线程的状态

> ID：14965610
> 
> 赞同：2
> 
> 时间：2013-02-19T19:18:58.527
> 
> 标签：c, multithreading, parallel-processing, openmp

如何在 Linux 上运行的 OpenMP (C) 代码中识别团队的空闲线程？
我想测量作为一个团队工作的线程的空闲时间。可能吗？是否有任何字段可以显示线程的状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:44:46.430

读取系统调用获取的任务 ID（每个线程唯一）在哪里的`Status`字段`/proc/self/task/$tid/status``tid``gettid()`

这也是第三个领域`/proc/self/task/$tid/stat`

`/proc/self/task/$tid/stat`还将包含每个任务`utime`的`stime`字段，因此您可以获得它们的“活动时间”。检查[http://linux.die.net/man/5/proc](http://linux.die.net/man/5/proc)以查看这些字段。

# sql-server - 手动删除 tempdb.mdf 文件是否安全？

> ID：14965611
> 
> 赞同：5
> 
> 时间：2013-02-19T19:18:59.750
> 
> 标签：sql-server, shrink, tempdb

在 SQL Server 2008 中，我试图批量插入大小约为 1GB 的 CSV。当我这样做时，它正在创建一个巨大的 tempdb.mdf 文件。现在，这个 1GB 的 CSV 文件是 35GB。

我已经尝试过[微软提供](http://support.microsoft.com/kb/307487#appliesto)的各种解决方案，但它们似乎都不起作用。

我认为在非生产系统上“缩小” tempdb.mdf 文件的最简单方法是在 SQL 服务关闭时将其删除。

这会导致任何问题吗？如果是这样，可以预期什么样的问题？

**编辑**

**1）**这是CSV中的一行（它有大约4M行）：

```
PS D:\> gc .\map.items.csv | select -last 1
40747646;jdbc:patent/8046822;8683;other/patent;12/31/69 16:00:00.00 PST;E6 E6 80 6D FD 6D 0B 5F 44 66 4E 1C 35 DE 46 BB 19 36 3C 31 37 67 4D 1D DF 58 A5 99 A8 A0 3B 52;crawled;full_patent_db2;Electronic apparatus, function selection method of electronic apparatus and management system of electronic apparatus;Sony Corporation;Tokyo;03;G06F21/00 
```

**2）**这是数据库描述表信息（没有异国情调，也没有触发器）：[https ://gist.github.com/mlissner/4cd13db5a1bbae91dd50](https://gist.github.com/mlissner/4cd13db5a1bbae91dd50)

**3)**我已将数据库设置为简单恢复模式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T19:21:32.170

不，您不能删除 tempdb mdf 文件。

如果需要再次收缩文件，请重新启动 SQL Server，然后运行[`DBCC SHRINKFILE()`](http://msdn.microsoft.com/en-us/library/ms189493%28v=sql.100%29.aspx)​​. 这是一个受支持的操作，不同于任何“在 SQL Server 不查找时删除 mdf 文件”的巫术。

您也许可以优化批量操作，因此 tempdb 一开始就不会受到如此严重的打击，但是鉴于实际问题是什么，无法通过详细信息来判断。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-26T07:04:00.700

最后，是的，删除这个文件对我来说是安全的。SHRINKFILE 无法始终如一地工作（不知道为什么，可能是一些基本的东西），并且删除文件效果很好。

是的，有点像巫术，但是文件是自动重新创建的，没有发生任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:26:04.747

可以使用 BCP 吗？这是将大型平面文件加载到 SQL Server 的推荐方法。

或者，您可以从完全恢复模式切换到简单恢复模式吗？这将减少服务器执行的事务日志记录量。

# integration - BTS ESB 链接应用程序集成类型

> ID：14965612
> 
> 赞同：0
> 
> 时间：2013-02-19T19:18:59.983
> 
> 标签：integration, biztalk, biztalk2006r2, esb-toolkit-2.0

我一直在谷歌上寻找解决方案“如何在 BizTalk ESB 2.0 中将应用程序集成样式从点对点更改为总线总线？”。

请有人建议我回答这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T18:50:50.857

将 ESB 作为 HUB 和 Spoke 放置在所有外部应用程序中。

# php - 锚标签似乎没有关闭

> ID：14965625
> 
> 赞同：0
> 
> 时间：2013-02-19T19:19:26.313
> 
> 标签：php, html

我的代码有什么问题，当我单击这段 html 中的结束标记时，它不会亮起有合作伙伴。我认为它可能与代码中的 PHP 有关，但我不确定。该链接在 safari 和 chrome 中确实有效，但在其他浏览器中存在问题。请让我知道你在想什么

```
 <td class="stat">
      <a data-ajax="false" href="following.php?id=<?php echo $row['id_user']?>">
        <div class="statnum"><?php echo $row2['COUNT(username)']?></div>
        <div class="statlabel">FOLLOWING</div>
      </a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:26:43.730

在 HTML 4.x 中，`<a>`元素不能包含`<div>`元素。

这在 HTML 5 中发生了变化，但是：

*   一些浏览器有问题，特别是如果你没有明确`display: block`设置`<a>`
*   你的编辑器的语法高亮可能没有跟上这个变化

# jquery - for循环内的JQuery load()

> ID：14965626
> 
> 赞同：0
> 
> 时间：2013-02-19T19:19:30.390
> 
> 标签：jquery, loops, for-loop, load, wait

我正在尝试编写一个 Greasemonkey 脚本，其中`.load()`使用 for 循环加载不同的页面并将它们的一些信息存储在`localStorage`. 我的问题：因为`.load()`是异步的，所以效果不好。我的脚本只存储我要存储的 Last 值。我认为那是因为我使用了`var i`内部回调函数，并且当回调函数被触发时`i`已经有另一个值。

```
for (var i = 0; i < plantsDiv.length; i++)
{
   objectid = plantsDiv[i].getAttribute('objectid');    
   $("#wrap").load("index.php?objectid="+ objectid,function(){
      //[...] what is happening
      window.localStorage.setItem(objectid,value);
   });
} 
```

当我`alert("foo")`在回调函数和 for 循环结束之间插入时，一切正常，因为该`.load`函数已加载，而我在警报窗口中单击“确定”。有没有办法让 for 循环等到整个`.load`执行完毕？

谢谢你的帮助，对不起我的英语不好:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:29:33.820

该`load()`功能与功能[几乎](http://api.jquery.com/load/)相同`get()`-

> 此方法是从服务器获取数据的最简单方法。它大致相当于 $.get(url, data, success) ，只是它是一个方法而不是全局函数，并且它具有隐式回调函数。

通过使用稍微详细一点的`ajax()`函数，您将能够指定要*同步*的请求，并将其`async`设置为 false。也许这会解决你的问题。

一个简单的同步 ajax 调用：

```
$.ajax({
  url: "example.php",
  data : yourData,
  async : false
},function(response){
  // this is the callback
}); 
```

参考 -

*   [`$.ajax()`](http://api.jquery.com/jQuery.ajax/)
*   [`$.get()`](http://api.jquery.com/jQuery.get/)
*   [`load()`](http://api.jquery.com/load/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:32:54.373

如果目标不是将内容加载到元素中，而是获取内容并将其保存到 localStorage 中，则应使用 $.get （或 $.post 如果要发布数据）。

jQuery ajax 函数返回一个 jqXHR 对象，该对象派生自 Deferred 对象，因此您可以使用 .done() 表示成功，使用 .fail() 表示失败：

```
$.get("index.php?objectid="+ objectid)
.done(function(data) {
    window.localStorage.setItem(objectid,data);
})
.fail(function() {
    // try again later?
}); 
```

编辑：请注意，请求仍将异步启动，在这种情况下，您可能有很多并行请求，完成（或失败）块中的代码将在收到每个请求的响应时运行。

# matlab - 如何在 MATLAB 中求解具有 2 个变量的 2 个复杂方程？

> ID：14965628
> 
> 赞同：0
> 
> 时间：2013-02-19T19:19:37.957
> 
> 标签：matlab, equation-solving

我有这两个方程：

```
y1=a*(10/11- (3*i)/4) + b*(5/6+ (7*i)/5)
y2= -1+(j*2) 
```

其中： y1=y2 ，我想***仅***使用MATLAB 找到“a”和“b”的确切值。

我应该使用任何 MATLAB 命令来求解这两个方程吗？

ps：我尝试使用`solve` 命令，但它没有给我任何答案：

```
syms a b
y1=a*(10/11- (3*i)/4) + b*(5/6+ (7*i)/5);
y2= -1+(j*2);
s=solve('y1-y2=0',[a b]) 
```

它给了我这个：

```
Warning: Explicit solution could not be found. 
> In solve at 160 

s =

[ empty sym ] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:52:23.800

首先，确保您正确编写了方程式（运算优先级，括号）：

在 中`y1`，第二项和第三项写得很奇怪：

如果你简化（根据你写的）它就会变成`(45/124)*i + b*(67/30)`

`i`另外，为什么要混入`j`？`y2`

如果这一切都做得很好，但仍然得到相同的答案，那就真的意味着没有解决方案。

编辑：

再看看这个，你没有一个 2 方程 / 2 变量系统，你有 3 个变量（y，a，b）......这意味着你无法解决。

编辑2：

从最后一条评论：好吧，做你说你想做的事，均衡两个方程的实部和虚部：

```
syms a;
S = solve('a*(10/11)+b*(5/6)=-1','a*(3/4)+b*(7/5)=2');
S = [S.a S.b]

S =

[-4048/855, 226/57] 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-19T19:25:59.513

```
>> syms a b
>> solve( a*(10/11- (3*i)/4) + (3/4*i+ ((12)/(31*i))) + b*(5/6+ (7*i)/5i)==-1+(j*2))
a*(- 300/737 + (45*i)/134) - 30/67 + (3045*i)/4154 
```

[见官方文档](http://www.mathworks.com/help/symbolic/solve-a-system-of-algebraic-equations.html)。

# java - 迁移到 RichFaces 4：HtmlAjaxCommandLink -> UICommandButton

> ID：14965629
> 
> 赞同：1
> 
> 时间：2013-02-19T19:19:45.003
> 
> 标签：java, jsf-2, richfaces, ajax4jsf

我将遗留项目转换为更现代的库版本。旧版本使用以下**ajax4jsf**代码：

```
HtmlAjaxCommandLink link = new HtmlAjaxCommandLink()
link.addAjaxListener(new AjaxListener() {
    @Override
    public void processAjax(AjaxEvent event) { }
}); 
```

根据文档，*HtmlAjaxCommandLink*在 Richfaces 4 中被 UICommandLink 取代*。*

不过，我似乎无法很好地替换控件的*addAjaxListener*。

可以用什么代替？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T19:34:00.940

自 JSF2 以来，ajax 已被 JSF API 标准化。所有支持客户端行为的组件都应该实现[`ClientBehaviorHolder`](http://docs.oracle.com/javaee/6/api/javax/faces/component/behavior/ClientBehaviorHolder.html)，这反过来又提供了[`addClientBehavior()`](http://docs.oracle.com/javaee/6/api/javax/faces/component/behavior/ClientBehaviorHolder.html#addClientBehavior%28java.lang.String,%20javax.faces.component.behavior.ClientBehavior%29)添加客户端行为的方法。ajax 的具体客户端行为实现是[`AjaxBehavior`](http://docs.oracle.com/javaee/6/api/javax/faces/component/behavior/AjaxBehavior.html)反过来提供[`addAjaxBehaviorListener()`](http://docs.oracle.com/javaee/6/api/javax/faces/component/behavior/AjaxBehavior.html#addAjaxBehaviorListener%28javax.faces.event.AjaxBehaviorListener%29)正是您正在寻找的方法。

总而言之，在您的特定情况下，可以将其替换如下：

```
UICommandLink link = new UICommandLink(); // Note: you can also just use standard JSF HtmlCommandLink.
link.setId("linkId"); // Fixed ID is mandatory for successful processing.
link.setValue("click here"); // Not sure if you need it. Just to be complete.
AjaxBehavior ajaxAction = new AjaxBehavior();
ajaxAction.addAjaxBehaviorListener(new AjaxBehaviorListener() {
    @Override
    public void processAjaxBehavior(AjaxBehaviorEvent event) throws AbortProcessingException {
        System.out.println("Ajax behavior listener invoked."); // Do your actual job jere.
    }
});
link.addClientBehavior("action", ajaxAction); // Note: don't use "click" event! 
```

# php - 工厂模式设计

> ID：14965633
> 
> 赞同：1
> 
> 时间：2013-02-19T19:20:10.140
> 
> 标签：php, arrays, parameters, factory-pattern

我有一个基于工厂的类，例如：

```
class AisisCore_Factory_Pattern {

    protected static $_class_instance;

    protected static $_dependencies;

    public static function get_instance(){
        if(self::$_class_instance == null){
            $_class_instance = new self();
        }

        return self::$_class_instance;
    }

    public static function create($class){
        if(empty($class)){
            throw new AisisCore_Exceptions_Exception('Class cannot be empty.');
        }

        if(!isset(self::$_dependencies)){
            throw new AisisCore_Exceptions_Exception('There is no dependencies array created. 
                Please create one and register it.');   
        }

        if(!isset(self::$_dependencies[$class])){
            throw new AisisCore_Exceptions_Exception('This class does not exist in the dependecies array!');
        }

        if(isset(self::$_dependencies[$class]['params'])){
            $new_class =  new $class(implode(', ', self::$_dependencies[$class]['params']));
            return $new_class;
        }else{
            $new_class = new $class();
            return $new_class;
        }
    }

    public static function register_dependencies($array){
        self::$_dependencies = $array;
    }

} 
```

现在使用这个类，我们执行以下操作：

**首先设置我们的类列表和它们的依赖**

```
$class_list = array(
    'class_name_here' => array(
        'params' => array(
            'cat'
        ) 
    )
); 
```

**注册他们：**

```
AisisCore_Factory_Pattern::register_dependencies($class_list); 
```

这意味着任何时候您调用 create 方法并将其传递给一个类，我们将返回该类的一个新实例，同时还传递该类的任何参数。

**创建一个类**

要创建一个类，我们要做的就是：

```
$object = AisisCore_Factory_Pattern::register_dependencies('class_name_here'); 
```

现在我们已经创建了一个新的 class: 实例`class_name_here`并将它的参数传递给它`cat`，现在我们所要做的就是访问它的方法`$object->method()`

**我对这一切的问题是：**

如果参数是数组怎么办？我该如何处理？

一种解决方案可能是：

```
public static function create($class){

    if(isset(self::$_dependencies[$class]['params'])){
        if(is_array(self::$_dependencies[$class]['params'])){
            $ref = new ReflectionClass($class);
            return $ref->newInstanceArgs(self::$_dependencies[$class]['params']);
        }
        $new_class =  new $class(implode(', ', self::$_dependencies[$class]['params']));
        return $new_class;
    }else{
        $new_class = new $class();
        return $new_class;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:40:10.090

在这种情况下，您最好的选择可能是使用反射类来创建一个传入参数数组的新实例。见[反射类：：新实例参数](http://www.php.net/manual/en/reflectionclass.newinstanceargs.php)和用户评论有类似的东西：

```
$ref = new ReflectionClass($class);
return $ref->newInstanceArgs(self::$_dependencies[$class]['params']); 
```

这应该像[call_user_func_array](http://www.php.net/call_user_func_array)一样工作，因为数组中的每个值都作为不同的参数传递给函数。

# javascript - javascript中五个值的平均值

> ID：14965637
> 
> 赞同：2
> 
> 时间：2013-02-19T19:20:16.347
> 
> 标签：javascript, average

我在一所特许学校工作，我只是在学习 JavaScript。我有一些由以前担任我职位的人编写的代码，在我看来它应该可以工作，但事实并非如此。

这是我在 SIS 的自定义 HTML 页面中的内容：

```
GED Status: <script language="Javascript">gedCheck('~(ELC_tspp_GED_read_score)','~ (ELC_tspp_GED_wri_score)','~(ELC_tspp_math_GED_score)','~(ELC_science_state_exam_score)','~(soc_sci_state_exam_score)')</script> 
```

这似乎是从各种数据库字段中正确检索值，因为 javascript 例程正在评估每个值以确保它至少为 410。但仅此而已......

这是javascript例程代码：

```
function gedCheck(read,wri,math,sci,soc) {

if( read < 0 && read > 1000 )
    read = 0;
if( wri < 0 && wri > 1000 )
    wri = 0;
if( math < 0 && math > 1000 )
    math = 0;
if( sci < 0 && read > 1000 )
    read = 0;
if( soc < 0 && soc > 1000 )
    soc = 0;        

if ( (read >= 410) && (wri >= 410) && (math >= 410) && (sci >= 410) && (soc >= 410) ) {
    if( read+wri+math+sci+soc >= 2250 )
        document.write( "PASSED" )
}
else
    document.write( "NOT PASSED" )
} 
```

它应该检查 GED 测试中的每个分数至少为 410，并且所有分数的总和应至少为 2250。但是，它没有达到最后一部分。如果所有分数都超过 410，则返回“PASSED”。

我试过这个，但它也不起作用。

```
function gedCheck(read,wri,math,sci,soc) {

if( read < 0 && read > 1000 )
    read = 0;
if( wri < 0 && wri > 1000 )
    wri = 0;
if( math < 0 && math > 1000 )
    math = 0;
if( sci < 0 && read > 1000 )
    read = 0;
if( soc < 0 && soc > 1000 )
    soc = 0;        

if ( (read >= 410) && (wri >= 410) && (math >= 410) && (sci >= 410) && (soc >= 410) )   {
    if( read+wri+math+sci+soc/5 >= 450 )
        document.write( "PASSED" )
}
else
    document.write( "NOT PASSED" )
} 
```

有人可以帮我解决这个问题，因此它要么平均所有 5 个数字并仅在平均值为 450 时才返回“PASSED”，或者仅当总和为 2250 或更大时才将所有 5 个数字相加并返回“PASSED”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:24:20.583

关于什么

```
if ((read >= 410) && 
    (wri  >= 410) && 
    (math >= 410) && 
    (sci  >= 410) && 
    (soc  >= 410) &&
    (read+wri+math+sci+soc >= 2250)) {    

    document.write( "PASSED" )
} else {

    document.write( "NOT PASSED" )
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:26:51.520

要获得平均值，您需要这样做：

```
(((read + wri + math + sci + soc) / 5) > 450) 
```

加法周围的括号确保您将所有分数的总和除以 5。按照现在的方式，您只是将`soc`分数除以 5。

编辑（重写整个方法）：

```
function gedCheck(read, wri, math, sci, soc) {
// As was said before, these should all be ORs
// If the score is less than 0, OR greater than 1000
if( read < 0 || read > 1000 ) {
    read = 0;
}
if( wri < 0 || wri > 1000 ) { // I prefer to put the braces around all if/else statements just for absolute clarity
    wri = 0;
}
if( math < 0 || math > 1000 ) {
    math = 0;
}
if( sci < 0 || read > 1000 ) {
    read = 0;
}
if( soc < 0 || soc > 1000 ) {
    soc = 0;        
}

if ( read >= 410 && // Doing this will only pass the student
     wri >= 410  && // if ALL of the conditions are met.
     math >= 410 && 
     sci >= 410  && 
     soc >= 410  &&
     (    (read + wri + math + sci + soc) >= 2250 || // Separated more for clarity
          ((read + wri + math + sci + soc) / 5) > 450) ) { 
    // Either all scores total over 2250
    // Or the average of all 5 are over 450 to pass                
        document.write( "PASSED" )
}
else
    document.write( "NOT PASSED" )
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:28:13.860

```
function gedCheck(read, wri, math, sci, soc) {

    if( read < 0 || read > 1000 )
        read = 0;

    if( wri < 0 || wri > 1000 )
        wri = 0;

    if( math < 0 && math > 1000 )
        math = 0;

    if( sci < 0 && read > 1000 )
        read = 0;

    if( soc < 0 && soc > 1000 )
        soc = 0;

    var total = read + wri + math + sci + soc;

    if (read >= 410 && wri >= 410 && math >= 410 && sci >= 410 && soc >= 410 && total >= 2250)   {   
        document.write("PASSED");
    } else {
        document.write("NOT PASSED");
    }
} 
```

整个第一部分都是不可能的代码。它正在检查一个数字是否既小于零又大于 1000。显然不可能，所以我将其更改为使用 OR。

我还创建了一个总变量，您可以像检查其他所有内容一样检查它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T19:40:10.297

在这里使用数组将帮助您减少重复代码的数量

```
function gedCheck(read, wri, math, sci, soc) {
   var subjects, totalScore, averageScore;

   subjects = [read, wri, math, sci, soc];
   totalScore = 0;
   averageScore = 0;

   for (var i = 0; i < subjects.length; i++) {
       if (subjects[i] < 0 || subjects[i] > 1000) {
           subjects[i] = 0;
       }
       totalScore += subjects[i];
   };

   averageScore = totalScore / subjects.length;

   if (averageScore >= 450 || totalScore >= 2250) {
       document.write("PASSED");
   } else {
       document.write("NOT PASSED");
   }
} 
```

第一个循环遍历每个主题并在必要时将其设置为零，然后将其添加到总分变量中。

然后总分由科目数平均。

那么如果平均分等于或大于450，或者等于或大于2250，则通过。

# jquery - 带有 number_format() 的 jQuery 表格排序器；

> ID：14965639
> 
> 赞同：4
> 
> 时间：2013-02-19T19:20:20.687
> 
> 标签：jquery, tablesorter, number-formatting

我正在使用 jQuery 表格排序器插件，我想通过在千位上使用逗号分隔符来使我的表格更具可读性，即 number_format($value, 0, " ", ",");

但是，这会破坏排序。我一直在寻找解决方案（例如[http://lab.christianmontoya.com/jquery-tablesort-numbers-commas/](http://lab.christianmontoya.com/jquery-tablesort-numbers-commas/)），但我没有设法调整它并适应我的桌子。我是脚本新手，所以请放纵一下。

我的 javascript 块应该是什么样的？

```
<head>
<script type="text/javascript">
    $(document).ready(function() { 
        $("#myTable").tablesorter( {
            sortList: [[1,1], [2,1]],
            widgets: ['zebra'],
        } );
    }); 
</script>
</head>

<body>
<table id="myTable" class="tablesorter"> 
<thead> 
<tr> 
<th>Username</th> 
<th>Level</th> 
<th>Experience</th> 
</tr> 
</thead> 
<tbody> 
<tr> 
<td>Fiery</td> 
<td><?php echo number_format(2400, 0, " ", ","); ?></td> 
<td><?php echo number_format(378433689, 0, " ", ",");?></td> 
</tr> 
<tr> 
<td>Sixten</td> 
<td><?php echo number_format(1600, 0, " ", ","); ?></td> 
<td><?php echo number_format(1000000000, 0, " ", ",");?></td> 
</tr> 
<tr>                    
<td>Penny</td> 
<td><?php echo number_format(885, 0, " ", ","); ?></td> 
<td><?php echo number_format(8900002, 0, " ", ","); ?></td> 
</tr> 
<tr>
<td>Petra</td> 
<td><?php echo number_format(2400, 0, " ", ","); ?></td> 
<td><?php echo number_format(398433889, 0, " ", ","); ?></td> 
</tr> 
<tr>
<td>Neu</td> 
<td><?php echo number_format(4974, 0, " ", ","); ?></td> 
<td><?php echo number_format(198433889, 0, " ", ","); ?></td> 
</tr> 
</tbody> 
</table>
</body> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T19:49:16.967

您需要将自定义格式应用于所需的标题/列：

标记：

```
<table id="myTable" class="tablesorter" border="0" cellpadding="0" cellspacing="1">
        <thead>
            <tr>
                <th>
                    Price
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    1,000.00
                </td>
            </tr>
            <tr>
                <td>
                    100,100.00
                </td>
            </tr>
            <tr>
                <td>
                    100,980.00
                </td>
            </tr>
            <tr>
                <td>
                    100,122.00
                </td>
            </tr>
            <tr>
                <td>
                    120,122.00
                </td>
            </tr>
            <tr>
                <td>
                    540,122.00
                </td>
            </tr>
            <tr>
                <td>
                    222,122.00
                </td>
            </tr>
            <tr>
                <td>
                    100,020.00
                </td>
            </tr>
            <tr>
                <td>
                    100,251.00
                </td>
            </tr>
            <tr>
                <td>
                    100,364.00
                </td>
            </tr>
            <tr>
                <td>
                    300,122.00
                </td>
            </tr>
        </tbody>
    </table> 
```

jQuery：

```
 $(document).ready(function () {
        jQuery.tablesorter.addParser({
            id: "fancyNumber",
            is: function (s) {
                return /^[0-9]?[0-9,\.]*$/.test(s);
            },
            format: function (s) {
                return jQuery.tablesorter.formatFloat(s.replace(/,/g, ''));
            },
            type: "numeric"
        });

        $("#myTable").tablesorter({
            headers: { 0: { sorter: 'fancyNumber'} },
            widgets: ['zebra']
        });
    }); 
```

JSFiddle：http: [//jsfiddle.net/eAgDC/](http://jsfiddle.net/eAgDC/)

# jquery - 使用 jquery 从多个元素中删除多个类

> ID：14965644
> 
> 赞同：2
> 
> 时间：2013-02-19T19:20:44.140
> 
> 标签：jquery, removeclass

这个 $ 代码和 jsfiddle 链接中链接的 animate.css 将动画效果添加到框或图像。

```
$('.box1').addClass('animated bounceInUp'); 
```

添加动画类和效果类。

```
$('.box1').removeClass('animated bounceInUp'); 
```

删除类。

这里的问题是我计划使用不少于 100 个框/图像，因此应该有一种方法可以同时添加/删除所有动画和效果类。

这是我目前正在使用的代码和 jsFiddle：

[jsfiddle](http://jsfiddle.net/derenderen/rUHpf/)

```
 $(document).ready(function () {
        $('.box1').addClass('animated bounceInUp');
        $('.box2').addClass('animated bounceInLeft');
        $('.box3').addClass('animated flipInX');
        //
        var wait = window.setTimeout(function () {
            $('#boxes *').removeClass('animated');
        }, 3300);

    }); 
```

但是，这只会从元素中删除动画类（所有效果都不同），因此您不能添加新的效果类。我不知道在'.removeClass（'animated'）'中添加什么动画。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:29:35.953

**更新：**我正在重新分配 class 属性，该属性会在初始 class 等之后删除所有`.box1`类`.box2`。

```
$(function () {
    $('.box1').addClass('animated bounceInUp');
    $('.box2').addClass('animated bounceInLeft');
    $('.box3').addClass('animated flipInX');
    //
    var wait = window.setTimeout(function () {
        $('#boxes > div').each(function(){
            this.className = this.className.split(' ')[0];
        })
    }, 3300);
}); 
```

使用直接的 JavaScript`this.className`比任何 jQuery 方法都快。

只要元素的所有直接子`divs`元素`#boxes`确实是框，那么选择器`$('#boxes > div')`就可以了。

**更新小提琴：http:** [//jsfiddle.net/rUHpf/18/](http://jsfiddle.net/rUHpf/18/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:45:55.447

您可以通过 jQuery`attr`方法设置任何 HTML 标记属性。

如果您想从具有“动画”类的任何内容中删除所有类，但保留“动画”类，则可以使用以下命令：

```
$(".animated").attr("class", "animated"); 
```

这将通过将所有匹配标签的“类”属性设置为“动画”来删除所有其他类，没有别的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-31T06:09:31.280

您可以使用队列而不是使用 setTimeout：

```
$(".box1").removeClass("animated bounceInUp").delay(1000).queue(function(next){
    $(".box2").removeClass("animated bounceInLeft");
    next();
}); 
```

# sql - 索引视图以提高 SQL Server 上多个连接的性能

> ID：14965646
> 
> 赞同：5
> 
> 时间：2013-02-19T19:20:52.167
> 
> 标签：sql, sql-server, indexing, indexed-view

我有一个对许多表执行联接的查询，这导致性能不佳。

为了提高性能，我创建了一个索引视图，并且我看到使用日期过滤器的视图查询性能有了显着提高。但是，我担心的是索引的存储。根据我的阅读，唯一聚集索引存储在 SQL Server 上。这是否意味着它将作为视图中连接的一部分产生的整个数据单独存储？如果是这样，如果我在视图中包含了属于连接一部分的表中的所有列，那么在没有索引视图的情况下，服务器上消耗的磁盘空间是否会大约是磁盘空间的两倍？每次我将数据输入基础表时，索引视图的数据都会重复吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T19:26:54.870

那是对的。索引视图基本上是一个附加表，其中包含按排序方式的所有数据的副本。这就是它如此快速的原因，但随着 SQL Server 中的所有内容落地，它是有代价的——在这种情况下，需要额外的存储空间以及保持所有数据副本同步所需的额外时间。

对于表上的普通索引也是如此。它也是索引键的副本（加上在哪里可以找到原始行的一些信息），需要额外的存储空间和额外的时间来维护更新。

要确定在表或视图上添加索引是否有意义，需要查看整个系统，看看一个查询的性能改进是否值得其他查询的性能下降。

在您的情况下，您还应该（首先）检查基础表上的其他索引是否可能有助于您的查询。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-19T19:26:26.793

对，那是正确的。索引视图将视图中的所有数据与源表分开保存。根据列和连接，数据是重复的，实际上可能比源表大很多倍。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-19T19:26:42.417

差不多，是的。您已经做出了权衡，即获得更好的性能以换取引擎的一些额外努力，以及持久化它所需的额外存储空间。

# javascript - Javascript 函数不接受 JSP 创建的字符串

> ID：14965658
> 
> 赞同：0
> 
> 时间：2013-02-19T19:21:27.067
> 
> 标签：javascript, string, jsp

我正在使用 JSP 创建动态网页...

在我的一个表单的开头，我有一些需要运行的 javascript 来初始化具有给定属性的页面。

我在要传递给 initializePage javascript 函数的 JSP <% %> 块中创建了一个 Java 字符串。

这是代码：

```
<script>
$(document).ready(function(){
<%String algorithmXMLPath = request.getContextPath() + "/" + PePw.PATH_ALGORITHM_XMLS;
String initParms = "'" + algorithmXMLPath + "'," +
                   " '" + Utilities.getString(reqBean.getMachineType()) + "'," +
                   " '" + Utilities.getString(reqBean.getModel()) + "'," +
                   " '" + Utilities.getString(reqBean.getReasonCode()) + "'";%>
initializePage(<%=initParms%>);
});
</script> 
```

这导致以下源代码：

```
initializePage('/PePasswords/data/algorithmXMLs/', '', '', ''); 
```

当我运行它时，我在 FF 错误控制台“未终止的字符串文字”中收到一个错误，它指向 initializePage 调用的结尾...当我单击错误控制台中的链接时，它实际上指向带有 } 的行);

不知道我在这里做错了什么......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:15:37.783

Looks like one of the variables had a hidden new line "\n" being passed into the JSP call...

I replaced

```
Utilities.getString(reqBean.getReasonCode()) 
```

with

```
Utilities.getString(reqBean.getReasonCode()).replace("\n", "").trim() 
```

# iphone - 当我尝试连接移动互联网连接时，我的 iPhone 应用程序无法运行

> ID：14965666
> 
> 赞同：-1
> 
> 时间：2013-02-19T19:21:44.837
> 
> 标签：iphone, ios, reachability

当我将手机与 WIFI 连接时，它工作正常，这没有问题，但是当我将移动设置更改为移动互联网连接时，我无法连接到服务器，得到 NO Internet Connection 作为 Reachability Class 的响应

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:25:32.097

*) 尝试重新启动您的设备。

*) 设置 -> 常规 -> 蜂窝数据（开）否则

*) 联系您的供应商....

# google-apps-script - 如何在 sheet.appendRow 中创建“漂亮的名字”？

> ID：14965667
> 
> 赞同：0
> 
> 时间：2013-02-19T19:21:50.387
> 
> 标签：google-apps-script, google-sheets

此代码有效，但是，我希望为工作表的 url 显示一个漂亮的名称，`link`而不是显示`url`. 我知道如何做到这一点`=hyperlink`，但在这里，我不知所措：

```
 var sheet = SpreadsheetApp.getActiveSheet();
  sheet.clearContents();
  sheet.appendRow(["Link", "Name", "Type", "ID"]);
  for (var i = 0; i < contents.length; i++) {
    file = contents[i];
    var value1,value2,value3;
    if (file.getFileType()==DocsList.FileType.SPREADSHEET) {
      var otherSheet = SpreadsheetApp.open(file).getSheetByName("Sheet1");
      value1 = otherSheet.getRange('B2').getValue();
      value2 = otherSheet.getRange('B7').getValue();
      value3 = otherSheet.getRange('B3').getValue();
    } else {
      value1 = null; value2 = null; value3 = null; value4 = null;
    }
    sheet.appendRow([ file.getUrl(),value1,value2,value3,value4]);
  }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-31T14:34:33.010

我想到了！我补充说：

```
var name = "link"; 
var semi = ";";
var hyp = "=hyperlink(\""; var quot = "\""; var clos = ")";
var pp = hyp + url + quot + semi + quot + name + quot + clos; 
```

然后改成`sheet.appendRow)[link, value1...`

# asp.net-mvc - 将静态 html/css 页面集成到 asp.net mvc 项目？

> ID：14965671
> 
> 赞同：2
> 
> 时间：2013-02-19T19:22:21.210
> 
> 标签：asp.net-mvc

我正在为一个个人项目工作（创建一个网站）。我完成了设计，然后将所有页面转换为静态 html/css 页面，然后添加了一些 javascript。现在我正处于使网站动态化的最后阶段，我的意思是将 html/css 页面集成为带有生成内容的 c# 代码的 Asp.net MVC 项目。即使我可以修补，但我更喜欢更有条理。所以我问你有什么指导方针怎么做？以及进行此转换需要牢记的事项是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-17T22:59:44.810

我将在这里记录我这样做的经验。在我在几天内完成该过程之前，这将是一个不完整和/或不正确的答案。我假设 Visual Studio 2012。

1.  创建一个新的 MVC 4 Internet 应用程序项目。
2.  为每个静态页面添加一个方法到主控制器。
3.  右键单击每个方法并选择添加视图。
4.  在 VS 中打开图像文件夹并删除每个项目（从 VS 内部）
5.  将所有静态站点图像拖到图像项目文件夹中并添加到项目中。
6.  用静态站点 css 替换 Site.css 的内容。
7.  将每个页面的 html 粘贴到相应的视图中。不理会`ViewBag.Title`代码块。

（仍然不完整）

# ios - CoreGraphics 确定模拟器中的点击位置 - 架构 i386 的未定义符号

> ID：14965675
> 
> 赞同：0
> 
> 时间：2013-02-19T19:22:46.117
> 
> 标签：ios, objective-c, uitableview, core-graphics

我正在使用动态表视图。正如之前的回复（[如何知道 UITableview 行号](https://stackoverflow.com/questions/9274494/how-to-know-the-uitableview-row-number/9274863#9274863)）中所建议的那样，我尝试使用 CGPoint。

```
CGPoint hitPoint = [sender convertPoint:CGPointZero toView:self.tableView]; 
NSIndexPath *hitIndex = [self.tableView indexPathForRowAtPoint:hitPoint]; 
```

我得到调试器错误

```
Undefined symbols for architecture i386:
  "_CGPointZero", referenced from:
      -[MessageTableViewController btnCall:] in MessageTableViewController.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

这是什么意思，不支持 i386 或者我需要以某种方式设置 GCPointZero？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:38:56.037

您必须**链接**到`CoreGraphics framework`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:30:17.993

尝试像这样在您的课程中导入 Coregraphics 框架

```
 #import <CoreGraphics/CoreGraphics.h> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-04T09:15:00.167

`CGPointZero`是`CoreGraphics`框架的一部分。所以你有两种方法可以解决这个问题。

1.  您链接到`CoreGraphics`框架，因为@user529758 已[在此处](https://stackoverflow.com/a/14965941)回答。

或者

2.  正如[文档`CGPointZero`](https://developer.apple.com/documentation/coregraphics/cgpointzero)所说，它是一个快捷方式`CGPointMake(0,0)`：

> 位置为 (0,0) 的点常数。零点等价于 CGPointMake(0,0)。

所以你可以`CGPointZero`用`CGPointMake(0,0)`.

# c++ - 用于仿真应用的 C++ normal_distribution 函数

> ID：14965680
> 
> 赞同：1
> 
> 时间：2013-02-19T19:23:04.813
> 
> 标签：c++, simulation

我想知道 normal_distribution 函数使用什么样的随机数生成器？

它适合科学模拟应用吗？

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:34:05.073

`std::normal_distribution`不进行任何随机数生成。它是一个*随机数分布*。随机数分布仅将*随机数引擎*返回的值映射到某种分布。他们自己不做任何一代。所以你关心的是随机数*引擎。*

标准提供的随机数引擎之一，`std::mersenne_twister_engine`是一个非常高质量的随机数引擎。您可以使用它来生成具有正态分布的随机数，如下所示：

```
std::random_device rd;
std::mt19937 gen(rd()); // Create and seed the generator
std::normal_distribution<> d(mean, deviation); // Create distribution
std::cout << d(gen) << std::endl; // Generate random numbers according to distribution 
```

请注意，这是`std::mt19937`一个`typedef`。`std::mersenne_twister_engine`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:32:56.903

`<random>`标准库的重点是*将*分布与随机数生成器分开。*您*提供一个生成均匀整数的随机数生成器，该分布负责将该随机、均匀的整数序列转换为所需分布的样本。

幸运的是，该`<random>`库还包含一组随机数生成器。Mersenne Twister `std::mt19937`（

（您还需要为生成器提供*种子*。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-02T14:58:01.523

我知道帖子很旧，但是，我希望我的回答是有益的。我用来`normal_distribution`为传感器生成高斯噪声。这有利于模拟传感器。例如，假设您有一个传感器，可以为您提供 2D 机器人的位置。每次移动机器人时，传感器都会为您提供机器人位置的一些读数。在 OpenGL 中，您可以模拟此示例。例如，您可以跟踪鼠标的位置，并在鼠标的真实位置上添加一些高斯噪声。在这种情况下，您有一个跟踪鼠标位置的传感器，但是由于噪声，它具有不确定性。

# php - 未从 Unrealscript 传递 PHP 参数

> ID：14965684
> 
> 赞同：1
> 
> 时间：2013-02-19T19:23:19.040
> 
> 标签：php, unrealscript

我编写的 TcpLink 类有问题。该类连接到数据库，并且可以从 echo 语句接收简单的消息。但是，由于某种原因，TcpLink 类不会发送参数。有人可以帮帮我吗？

通过浏览器运行它会返回正确的结果： "array(1) { ["turtles"]=> string(3) "yes" }

但是，所有 UnrealScript 返回的是“array(0) { }”

PHP代码：

```
<?php
$response = "";
$response = var_dump($_GET);
echo $response;
?> 
```

虚幻脚本代码：

```
 class PlayerStatsLinkClient extends TcpLink;

var string TargetHost;
var int TargetPort;
var String TargetPath;
var String RequestText; //Data To Send
var array<String> RequestQueue; //Data Waiting to be sent(used when request is already in progress)
var bool bRequestInProgress; //Currently Sending A Request

var PlayerController PC;

var bool bGetData;

var String RequestType;

//var TestDatabaseServices ServiceProvider; //Owner Service
var int SecurityKey; //Arbitrary number equivalent to what is in .php to check authority(Prevent hacking slightly[Easily hackable])

struct sParam
{
    var String Key;
    var String Value;
};

var array<sParam> ParamList;

delegate OnResponse(String Type, String Data);

function AddParam(string Key, string Value)
{
    local sParam param;

    param.Key = Key;
    param.Value = Value;

    ParamList.AddItem(param);
}

function SetStats(int level, int xp, int xpToNext){
    AddParam("level", string(level));
    AddParam("xp", string(xp));
    AddParam("xpToNext", string(xpToNext));    
}

function GetStatsFromServer(){
    bGetData = true;
    AddParam("COMMAND", "RETRIEVE");
    Execute();
    bRequestInProgress = true;
    `log("========== END GETSTATSFROMSERVER()");
}

function bool Execute()
{
    if(!SetRequest())
    {
        return false;
    }

    Resolve(targethost);

    bRequestInProgress = true;
    return true;
}

function bool SetRequest(optional String Database)
{
    local sParam param;
    local String tmpRequestText;

    tmpRequestText="securitykey="$SecurityKey;

    foreach ParamList(param)
    {
        tmpRequestText $= "&" $ param.Key $ "=" $ param.Value;
    }

    ParamList.Remove(0, ParamList.Length);

    if(!bRequestInProgress)
    {
        RequestText = tmpRequestText;
        return true;
    }
    else
    {
        RequestQueue.AddItem(tmpRequestText);
        return false;
    }
}

event Resolved( IpAddr Addr )
{
    `log("++++++++++++++ RESOLVED!");
    Addr.Port = TargetPort;

    BindPort();
    if (!Open(Addr))
    {
        `Log("[TcpLinkClient] Open failed");
    }
}

event ResolveFailed()
{
    `Log("[TcpLinkClient] Unable to resolve "$TargetHost);
}

function SetRequestText(string text){
    RequestText = text;   
}

function SetbGetData(bool delta){
   bGetData = delta;   
}

event Opened()
{  
    RequestText = "securitykey=REMOVED";
    //let the php file know what's coming
    if(bGetData){
        SendText("GET /"$TargetPath$" HTTP/1.0"$chr(13)$chr(10));
    }else{
        SendText("POST /"$TargetPath$" HTTP/1.0"$chr(13)$chr(10));
    }
    SendText("Host: "$TargetHost$chr(13)$chr(10));
    SendText("User-Agent: HTTPTool/1.0"$Chr(13)$Chr(10));
    SendText("Content-Type: application/x-www-form-urlencoded"$chr(13)$chr(10));
    SendText("Content-Length: "$len(RequestText)$Chr(13)$Chr(10));
    SendText(chr(13)$chr(10));
    //send securitykey, command and params for php to use
    SendText(RequestText);
    SendText(chr(13)$chr(10));
    SendText("Connection: Close");
    SendText(chr(13)$chr(10)$chr(13)$chr(10));
}

event Closed()
{
    if(RequestQueue.Length <= 0)
    {
        bRequestInProgress=false;
    }
    else
    {
        RequestText = RequestQueue[0];
        RequestQueue.Remove(0,1);
        Resolve(targethost);
    }
}

event ReceivedText( string Text )
{  
    Text = Split(Text, chr(13)$chr(10)$chr(13)$chr(10), true);
    WorldInfo.Game.Broadcast(self, "RECEIVED RESPONSE FROM PLAYERSTATS SERVER: " $ Text);
    `log("++++++++++++++++++++");
    `log(Text);
//    if(ServiceProvider != none)
//    {
//        ServiceProvider.RecieveDatabaseText(Text);
//    }
}

defaultproperties
{
    TargetHost="REMOVED.zzl.org"
    TargetPort=80
    TargetPath = "REMOVED.php"

    bGetData=true

    SecurityKey=REMOVED//used in PHP to authenticate
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:43:35.450

这是因为您的`Opened`方法总是在建立连接后发送查询字符串（即 POST 请求）。应该传入您的 GET 参数`TargetPath`以使其正常工作。

# c# - DataGridViewImageCell 不显示图像

> ID：14965690
> 
> 赞同：0
> 
> 时间：2013-02-19T19:23:41.620
> 
> 标签：c#, winforms, datagridview

我`DataGridViewImage`为我的`DataGridView`.

```
DataGridViewImageColumn guardar = new DataGridViewImageColumn();
{
    guardar.HeaderText = "";
    guardar.Name = "guardar";
    guardar.AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
    guardar.CellTemplate = new DataGridViewImageCell();
    guardar.Image = Properties.Resources.empty_grilla;
    guardar.ToolTipText = "Guardar";
}
dgv_Bancos.Columns.Add(guardar); 
```

问题是当我想更改特定单元格的图像时，它并没有改变。

这是我的代码，请帮忙，我不知道有什么问题

```
DataGridViewImageCell cell = (DataGridViewImageCell)dgv_Bancos.Rows[e.RowIndex].Cells["guardar"];
cell.Value = Properties.Resources.guardar_grilla; 
```

**解决！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:39:04.063

您可以像这样使用而不是使用`DataGridViewImageCell cell`

```
dataGridView1["guardar", e.RowIndex].Value = Properties.Resources.guardar_grilla; 
```

# c++ - C++ 使用范围运算符调用相同的函数 - 有用吗？

> ID：14965693
> 
> 赞同：3
> 
> 时间：2013-02-19T19:24:03.867
> 
> 标签：c++, scope

我知道 C++ 中的 :: 运算符是范围解析，但是像这样在类中调用函数的目的是什么

```
class MyClass
{
 int myFunc(int argument)
 {
     // do some stuff
     return (::myFunc(another_argument));
 }
} 
```

有实际原因吗？是“这个”的意思吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T19:26:05.000

如果您有这样的用例：

```
//in the global namespace
int myFunc(int);

//elsewhere
class MyClass
{
 int myFunc(int argument)
 {
     // do some stuff
     return (::myFunc(another_argument));
 }
} 
```

这里我们需要区分成员函数和自由函数。这在包装 C 库时很常见。

在这种情况下`::`，强制编译选择驻留在全局命名空间中的版本，而不是最终会递归调用自身的成员函数。

# c# - 在 C++/CLI 中创建和使用 System.Drawing.Bitmap

> ID：14965696
> 
> 赞同：0
> 
> 时间：2013-02-19T19:24:07.780
> 
> 标签：c#, c++-cli, gdi+

我正在尝试在 C++/CLI 中完成以下任务。

我有一个构建图像内容（位图）的本机类：

```
unsigned char* NativeClass:GetBitmapBits(void) 
```

我想使用这些数据来创建托管 System.Drawing.Bitmap。我的第一个想法是使用构造函数：

```
Bitmap(
int width, 
int height, 
int stride, 
PixelFormat format, 
IntPtr scan0
) 
```

我有这个工作，但现在遇到问题，以后使用此位图会导致 System.Drawing 中的第一次机会异常 System.AccessViolationException。我怀疑问题在于我没有正确管理非托管位图位（由本机方法返回）到将其传递给托管位图构造函数的转换。

我应该如何从第一个函数中获取本机指针并准备它（例如，我需要使用interior_ptr 还是pin_ptr？）并将其传递给需要IntPtr 的Bitmap 构造函数？

编辑：详细说明，这是我这样做的天真尝试：

```
virtual void OnPaint(PaintEventargs^ e) override
{
...
   unsigned char* bits = nativeClassObj->getBitmapBits();

   gcnew Bitmap(width, height, stride, PixelFormat::Format24bppRgb, (IntPtr)bits);

   e->Graphics->DrawImage((System::Drawing::Image^)managedBitmap,0,0);
...
} 
```

.. 和结果（我在绘图窗口中得到一个“红色 X”）：

```
A first chance exception of type 'System.AccessViolationException' occurred in System.Drawing.dll 
```

# mysql - Mysql子查询多行返回

> ID：14965698
> 
> 赞同：0
> 
> 时间：2013-02-19T19:24:11.150
> 
> 标签：mysql

我已经浏览了很多链接，但没有一个可以解决我的问题。所以请不要说虽然我以前在 MySql 上工作过但从未遇到过需要使用子查询的情况，但它显示的工作量更少。所以，这是我的疑问..

```
"SELECT * FROM klms as Klm WHERE gcil_id = (SELECT id FROM gcils WHERE genre = 'Clothes')" 
```

显然我有超过 >1 行，其中流派 = '衣服' 所以它会返回 >1 行.. 但是它显示了这个错误

```
Error: SQLSTATE[21000]: Cardinality violation: 1242 Subquery returns more than 1 row 
```

顺便说一句，我在我的应用程序中使用 cakephp，我发现使用 SQL 查询更容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:25:10.683

使用`IN`而不是相等：

```
SELECT * 
FROM klms as Klm 
WHERE gcil_id IN (SELECT id FROM gcils WHERE genre = 'Clothes') 
```

或者您可以使用`INNER JOIN`：

```
SELECT DISTINCT klm.* 
FROM klms as Klm
   INNER JOIN gcils g ON Klm.gcil_id = gcils.id
WHERE g.genre = 'Clothes' 
```

# f# - 如何在没有“printf”的情况下调用 Seq.whatever 中的函数？

> ID：14965700
> 
> 赞同：2
> 
> 时间：2013-02-19T19:24:17.043
> 
> 标签：f#, sequences, seq

我是 f# 的新手，我尝试编写一个程序，该程序应该遍历给定目录中的所有文件，并为每个“.txt”类型的文件添加一个 id 号 +“DONE”到文件中。

我的程序：

```
//const:
[<Literal>]
let notImportantString= "blahBlah"
let mutable COUNT = 1.0

//funcs:
//addNumber --> add the sequence number COUNT to each file.
let addNumber (file : string)  =
 let mutable str = File.ReadAllText(file)
 printfn "%s" str//just for check
 let num = COUNT.ToString()
 let str4 = str + " " + num + "\n\n\n DONE"
 COUNT <- COUNT + 1.0
 let str2 =  File.WriteAllText(file,str4)
 file

//matchFunc --> check if is ".txt"
let matchFunc (file : string) =
 file.Contains(".txt") 

//allFiles --> go through all files of a given dir
let allFiles dir =

seq
    { for file in Directory.GetFiles(dir) do
        yield file  
           }

////////////////////////////

let dir = "D:\FSharpTesting"
let a = allFiles dir 
         |> Seq.filter(matchFunc) 
         |> Seq.map(addNumber)
printfn "%A" a 
```

我的问题：

Tf 我没有写最后一行（printfn "%A" a）文件不会改变。（如果我写了这一行，它可以工作并更改文件）当我使用调试器时，我发现它并没有真正计算'a' 的值当它到达该行时，如果“let a =......”它继续到 printfn 行，而不是当它“看到”那里的 'a' 时，它会返回并计算 ' 的答案一种'。为什么会这样？如何在不打印的情况下“启动”该功能？

还有-有人能告诉我为什么我必须添加文件作为函数“addNumber”的返回类型吗？（我添加这个是因为它是如何工作的，但我真的不明白为什么......）

最后一个问题 - 如果我在 [] 定义的行之后立即编写 COUNT 变量，它会给出一个错误并说一个常量不能是“可变的”但是如果一个添加（这就是我这样做的原因）之前的另一行（比如字符串）它“忘记”错误并起作用。为什么？如果你真的不能有一个可变的 const 我怎么能做一个静态变量？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-19T19:49:42.583

> 如果我不写最后一行（printfn "%A" a），文件将不会改变。

F# 序列是惰性的。因此，要强制评估，您可以执行一些不返回序列的操作。例如，您可以调用[`Seq.iter`](http://msdn.microsoft.com/en-us/library/ee340396.aspx)（有副作用，返回`()`），[`Seq.length`](http://msdn.microsoft.com/en-us/library/ee370547.aspx)（返回一个`int`序列的长度）或[`Seq.toList`](http://msdn.microsoft.com/en-us/library/ee353889.aspx)（返回一个列表，一个急切的数据结构）等。

> 有人能告诉我为什么我必须添加`file : string`作为函数“addNumber”的返回类型吗？

方法和属性访问在 F# 类型推断中表现不佳。类型检查器从左到右，从上到下工作。当您说`file.Contains`时，它不知道这应该与`Contains`成员一起使用哪种类型。因此，您的类型注释是 F# 类型检查器的一个很好的提示。

> 如果我在`[<Literal>]`定义行之后立即编写 COUNT 变量，它会给出错误并说常量不能是“可变的”

引用[MSDN](http://msdn.microsoft.com/en-us/library/dd233193.aspx)：

> 打算作为常量的值可以用 Literal 属性进行标记。此属性具有将值编译为常量的效果。

可变值可以在程序中的某个时刻改变它的值；编译器抱怨是有充分理由的。您可以简单地删除`[<Literal>]`属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T19:36:29.177

`Seq.map`旨在将一个值映射到另一个值，而不是一般地改变一个值。`seq<_>`表示一个延迟生成的序列，因此，正如 Alex 指出的那样，在枚举序列之前什么都不会发生。这可能更适合[codereview](https://codereview.stackexchange.com/)，但我会这样写：

```
Directory.EnumerateFiles(dir, "*.txt")
  |> Seq.iteri (fun i path -> 
    let text = File.ReadAllText(path)
    printfn "%s" text
    let text = sprintf "%s %d\n\n\n DONE" text (i + 1)
    File.WriteAllText(path, text)) 
```

`Seq.map`需要返回类型，就像 F# 中的所有表达式一样。如果一个函数执行一个动作，而不是计算一个值，它可以返回`unit`: `()`。关于`COUNT`，值不能是`mutable`and `[<Literal>]`(`const`在 C# 中)。这些是完全相反的。对于静态变量，使用模块范围的`let mutable`绑定：

```
module Counter =
  let mutable count = 1

open Counter
count <- count + 1 
```

`count`但是您可以通过将具有计数器变量的函数作为其私有实现的一部分来避免全局可变数据。你可以用一个闭包来做到这一点：

```
let count =
  let i = ref 0
  fun () ->
    incr i
    !i

let one = count()
let two = count() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-19T19:36:44.137

为了详细说明 Alex 的答案——F# 序列被懒惰地评估。这意味着序列中的每个元素都是“按需”生成的。

这样做的好处是您不会在不需要的元素上浪费计算时间和内存。懒惰的评估确实需要一点时间来适应——特别是因为你不能假设执行顺序（或者执行甚至会发生）。

您的问题有一个简单的解决方法：只需用于`Seq.iter`强制执行/评估序列，并将“忽略”函数传递给它，因为我们不关心序列返回的值。

```
let a = allFiles dir 
     |> Seq.filter(matchFunc) 
     |> Seq.map(addNumber)
     |> Seq.iter ignore   // Forces the sequence to execute 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T19:28:01.937

f# 是从上到下评估的，但在执行 printfn 之前，您只会创建惰性值。所以， printfn 实际上是第一个被执行的东西，它反过来执行你的代码的其余部分。我认为如果您在 Seq.map(addNumber) 之后添加 println 并对其执行 toList 也可以执行相同的操作，这也将强制进行评估。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-19T19:37:04.050

这是惰性序列的一般行为。你也有同样的情况，比如使用 IEnumerable 的 C#，其中 seq 是一个别名。在伪代码中：

```
 var lazyseq = "abcdef".Select(a => print a); //does not do anything
    var b = lazyseq.ToArray(); //will evaluate the sequence 
```

ToArray 触发对序列的评估：

这说明了一个序列只是一个*描述*的事实，并没有告诉你它什么时候会被枚举：这是在控制序列的*消费者*。

* * *

要进一步了解该主题，您可能需要查看[F# wikibook 中的此页面](http://en.wikibooks.org/wiki/F_Sharp_Programming/Caching)：

```
let isNebraskaCity_bad city =
    let cities =
        printfn "Creating cities Set"
        ["Bellevue"; "Omaha"; "Lincoln"; "Papillion"]
        |> Set.ofList

    cities.Contains(city)

let isNebraskaCity_good =
    let cities =
        printfn "Creating cities Set"
        ["Bellevue"; "Omaha"; "Lincoln"; "Papillion"]
        |> Set.ofList

    fun city -> cities.Contains(city) 
```

最值得注意的是，Sequence**没有被缓存**（尽管您可以这样做）。然后您会看到，描述和运行时行为之间的差异可能会产生重要的后果，因为重新计算序列本身会产生非常高的成本，并且如果每个值本身都是线性的，则会引入二次运算！

# python - 如何检查鼠标和精灵组之间的碰撞

> ID：14965707
> 
> 赞同：0
> 
> 时间：2013-02-19T19:24:35.957
> 
> 标签：python, mouse, pygame, collision

我正在尝试检测鼠标和精灵组之间的碰撞。我已经搜索了一段时间，但找不到任何关于它的信息。所以，如果你知道怎么做，你能解释一下这样的事情是怎么做的吗？如果是这样，我将不胜感激。此外，我不确定我需要向您展示哪些代码部分，但如果您需要任何代码，请告诉我您需要其中的哪一部分，我会发布它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:48:17.577

如果你使用 pygame，最简单的方法是创建一个不会有图像的 Sprite，并且位置会随着鼠标的变化而变化。要访问鼠标坐标，请使用：

```
pygame.mouse.get_pos(): return (x, y) 
```

那么您可以将现有的碰撞检测与这个新的 Sprite 一起使用。

# sql - 使用每行返回两个值的函数插入

> ID：14965708
> 
> 赞同：3
> 
> 时间：2013-02-19T19:24:37.890
> 
> 标签：sql, postgresql, plpgsql, postgresql-9.2, composite-types

这个功能：

```
CREATE OR REPLACE FUNCTION fn_test1()
  RETURNS SETOF date AS
$BODY$
declare
i int;
begin

i:=0;
while i<5 loop
   return next '2001-01-02'::date;
   i:=i+1;
end loop;

end
$BODY$
  LANGUAGE plpgsql VOLATILE
  COST 100
  ROWS 1000; 
```

这张表：

```
CREATE TABLE teste1
(
  teste1_id serial NOT NULL,
  num integer,
  fn_date date) 
```

像这样的 INSERT 工作得很好（插入 5 行）：

```
Insert into teste1(num,fn_date)
select 1, fn_test1(); 
```

但是，如果我想要一个连续返回*两个*日期的函数，以及一个有 2 列日期的表，我应该怎么做？到目前为止，我已经做到了：

```
CREATE OR REPLACE FUNCTION fn_test2()
  RETURNS TABLE(a date, b date) AS
$BODY$
declare
_start_date date;
_end_date date;
begin

_start_date:='2001-01-01'::date;
_end_date:='2002-01-01'::date;

i:=0;
while i < 5 loop
    return query(select _start_date,_end_date);
    i:=i+1;
end loop;
end
$BODY$
  LANGUAGE plpgsql VOLATILE
  COST 100
  ROWS 1000; 
```

而这张表：

```
CREATE TABLE teste2
(
  teste2_id serial NOT NULL,
  num integer,
  start_date date,
  end_date date) 
```

现在，我不能这样做：

```
INSERT INTO teste2(num,start_date,end_date)
SELECT 1, fn_test2(); 
```

我已经让函数返回`setof mytype`（创建一个有两个日期的类型），但它似乎做同样的事情。我应该如何修改 INSERT 查询或函数以使其工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T21:18:51.473

要[访问（众所周知的）复合类型的字段](http://www.postgresql.org/docs/current/interactive/rowtypes.html#AEN7304)，您需要将标识符括在括号中。如果没有括号，点之前的标识符将被视为每个 SQL 语法规则的表名。这会起作用：

```
SELECT 1, (fn_test2()).* 
```

顺便说一句，您的虚拟函数可能更简单：

```
CREATE OR REPLACE FUNCTION fn_test2()
  RETURNS TABLE(a date, b date) AS
$func$
BEGIN

a := '2001-01-01'::date;
b := '2002-01-01'::date;

FOR i in 0 .. 4 LOOP
    RETURN NEXT;
END LOOP;

END
$func$ LANGUAGE plpgsql; 
```

或者使用这个简单的 SQL 语句[`generate_series()`](http://www.postgresql.org/docs/current/interactive/functions-srf.html)来达到同样的效果：

```
SELECT 1, '2001-01-01'::date AS a, '2002-01-01'::date AS b
FROM   generate_series(0,4); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:56:50.010

尝试使用：

```
INSERT INTO teste2(num,start_date,end_date)
SELECT 1, f.a, f.b FROM fn_test2() AS f; 
```

因为您已将 a 和 b 声明为要返回的表的列。

# php - LEFT JOIN 不太好用

> ID：14965710
> 
> 赞同：0
> 
> 时间：2013-02-19T19:24:45.563
> 
> 标签：php, mysql, join, left-join

我有两张桌子：`users`和`changes`。我想跟踪每个用户所做的更改次数。目前，我正在结合 PHP 的两个单独的语句中执行此操作：

```
// Get all users
$stmt = GlobalContainer::$dbh->prepare("SELECT 
        id, username, realname
    FROM 
        users
    ORDER BY role_id, realname");
$stmt->execute();
while ($user = $stmt->fetch()) {
    $users[$user['id']] = $user;
    $users[$user['id']]['changes'] = 0;
}

// Get number of changes for each user
$stmt = GlobalContainer::$dbh->prepare("SELECT COUNT(*) AS `count`, user_id 
    FROM 
        changes
    GROUP BY user_id");
$stmt->execute();
while ($changes = $stmt->fetch()) {
    $users[$changes['user_id']]['changes'] = $changes['count'];
} 
```

这非常有效，但我认为如果我只是将它组合到一个查询中会更整洁。这就是我所拥有的：

```
SELECT 
        users.id, users.username, users.realname, count(changes.user_id) as `count`
    FROM 
        users
    LEFT JOIN `changes` ON users.id = changes.user_id
    GROUP BY user_id
ORDER BY `count` ASC 
```

但是，由于某种原因，它会跳过所有更改为 0 的用户，即使有几个更改。还有几个用户每个都有 3 个更改，并且所有更改都正确显示。如何使此查询正常工作，以便显示所有更改为 0 的用户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:42:41.933

好吧，看起来最近删除的答案是正确的。这是一个细分（和一个[演示](http://sqlfiddle.com/#!2/52c90/7)）。原始查询将 分组`nulls`为单个结果。简单的答案是按一个不为空的值进行分组。这使得最终查询看起来像这样：

```
SELECT 
        `users`.id, `users`.username, `users`.realname, count(changes.user_id) as `count`
    FROM 
        `users`
    LEFT JOIN `changes` ON users.id = changes.user_id
GROUP BY `users`.id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:32:49.650

将您的组更改为：

```
GROUP BY users.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:33:32.260

```
SELECT users.id, users.username, users.realname, count(changes.user_ID) from `changes` as `count` from users
left join `changes` on users.id = changes.user_id
group by users.id; 
```

您的计数会影响您的结果，您可以将其嵌套在子查询中以将其从左连接中排除，这反过来仅返回 count(changes.user_id) 所在的行并将它们组合成一条记录。如果您使用子查询，您可以有效地获取 changes.user_id 的计数，而不会影响您的左连接。

# jquery - jQuery 去抖动调整大小

> ID：14965713
> 
> 赞同：0
> 
> 时间：2013-02-19T19:25:04.623
> 
> 标签：jquery, events, window

[在这里的这个例子](http://play.meyouand.us/130219-windowloadresize/test1.html)中，我试图让 H1 标签在它处于移动模式时表现得像一个可点击的按钮。当它返回桌面模式时，我需要确保该按钮不再可点击。

当页面最初以“移动模式”加载时，该按钮可以正常工作，以确保在移动模式下，该按钮仅在每次单击时触发。但是，在调整大小后，它 1\. 没有取消绑定点击，并且 2\. 它似乎再次触发了多次。

我确定我这样做是无序的或效率低下的。欢迎任何其他更好的方法来做到这一点！

这是我的代码：

```
<html>
<head>
<style type="text/css">
.mobile-mode { background: pink; }
.mobile-mode h1 { background: yellow; padding: 10px; text-align: center; font-size: 16px; line-height: 20px; cursor: poi
</style>
<script type="text/javascript" src="/_jquery/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="/_jquery/jquery.debouncedresize.js"></script>
<script type="text/javascript" src="/_jquery/jquery.throttledsize.js"></script>
<script type="text/javascript">
$(window).bind("debounced", function() {
        var viewportWidth = $(window).width();
        $('.v-width span').html(viewportWidth);
        if ( viewportWidth < 640 ) {
                $('.device span').html('mobile');
                $('body').addClass('mobile-mode');
                $('h1').click(function() {
                        $('.results').append('<li>Hey!</li>');
                });
        } else {
                $('.device span').html('desktop');
                $('body').removeClass('mobile-mode');
                $('h1').unbind();
        }

});
</script>
</head>
<body>

<div class="v-width">viewport width: <span></span></div>

<div class="device">device: <span></span></div>

<h1>Contextual Header Button</h1>

<ol class="results"></ol>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:37:47.547

我是个白痴：我错误地将函数称为“debounced”，而我应该将其称为“debouncedresize”。

# macos - OS X 上的 csplit 不能将“$”识别为行尾字符吗？

> ID：14965715
> 
> 赞同：5
> 
> 时间：2013-02-19T19:25:09.103
> 
> 标签：macos, unix

（我使用的是 Mac OS X，这个问题可能特定于那个 Unix 变体）

我正在尝试使用`csplit`正则表达式拆分文件。它由合并成一个长文本文件的各种文章组成。每篇文章都以“保留所有权利”结尾。这是在行的末尾：`grep Reserved$`找到它们。只是，`csplit`声称没有匹配项。

`csplit filename /Reserved$/`

产量

`csplit: Reserved$: no match`

这是一个明显的谎言。如果我省略`$`，它可以工作；但我想确保在文本中间没有出现任何杂散的“保留”。我用行首字符尝试了一个不同的词`^`，这似乎有效。其他词（确实出现在数据行的末尾）在使用时也不匹配（例如`and$`）。

这是 OS X 的已知错误吗？

[更新：我通过删除所有回车符来确保这不是 DOS/Unix 行尾字符问题]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T23:05:46.643

我已经从[http://www.opensource.apple.com/source/text_cmds/text_cmds-84/csplit/csplit.c](http://www.opensource.apple.com/source/text_cmds/text_cmds-84/csplit/csplit.c)下载了 csplit 的源代码，并在调试器中进行了测试。

该模式是用

```
if (regcomp(&cre, re, REG_BASIC|REG_NOSUB) != 0)
    errx(1, "%s: bad regular expression", re); 
```

并且线条匹配

```
/* Read and output lines until we get a match. */
first = 1;
while ((p = csplit_getline()) != NULL) {
    if (fputs(p, ofp) == EOF)
        break;
    if (!first && regexec(&cre, p, 0, NULL, 0) == 0)
        break;
    first = 0;
} 
```

现在的问题是返回的行`csplit_getline()`仍然有一个尾随换行符`\n`。因此，“Reserved”不是字符串中的最后一个字符，并且模式“Reserved$”不匹配。

在快速而肮脏的插入后

```
 p[strlen(p)-1] = 0; 
```

要从输入字符串中删除尾随换行符，“Reserved$”模式按预期工作。

Mac OS X 中的 csplit 似乎存在更多问题，请参阅[为 csplit 寻找正确的正则表达式](https://stackoverflow.com/questions/4323703/looking-for-correct-regular-expression-for-csplit)的答案的备注（重复计数`{*}`也不起作用）。

*备注：*您可以使用以下技巧匹配行尾的“Reserved”：

```
csplit filename /Reserved<Ctrl-V><Ctrl-J>/ 
```

您实际使用 Control 键在命令行上输入换行符的位置。

# javascript - window.history.back() 显示“文档过期”页面，有什么办法吗？

> ID：14965718
> 
> 赞同：4
> 
> 时间：2013-02-19T19:25:12.910
> 
> 标签：javascript, django, internet-explorer, history

客户要求用户能够在单击结果后返回到充满搜索结果的页面。现在这是一个简单的 jQuery 调用：

```
$('a.detail-back-button').on('click', function(evt) {
    evt.preventDefault();
    window.history.back();
}); 
```

但是，这会在 Firefox 中显示“文档已过期”页面。我知道它的存在是为了安全，但客户无论如何都希望实现它。我已经做了一些搜索，我找到了一个解决问题的 php ......

```
session_cache_limiter('private_no_expire') 
```

...但这是一个基于 Django 的网站。还有其他解决方案吗？

**2013 年 2 月 21 日更新**

以下解决方案适用，但仅适用于非 IE 浏览器。IE8/9/10 似乎没有重新请求上一页。有IE解决方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T19:32:29.973

`POST`这与ed 请求的定义非幂等性质有关。即 a`POST`是一个有效果的动作，因此重复是不安全的。为了防止这种情况意外发生，一些浏览器会在重新提交原始表单之前显示一个带有确认消息的占位符页面。

最可靠的解决方案 - 可能是唯一的解决方案 - 是使用该`GET`方法提交您的表单，无论如何这都是有道理的。

# c# - 将返回的 TypeA 对象转换为派生自 TypeA 的类型

> ID：14965719
> 
> 赞同：0
> 
> 时间：2013-02-19T19:25:19.950
> 
> 标签：c#, casting, upcasting

我正在调用一个我不拥有的方法，它返回一个“任务”对象。我想从我的方法中返回该对象，但我还需要覆盖该对象的 Exception 属性。如果底层任务捕获异常，并且我的用户通过 Exception 属性检索该异常，我需要调整他们在返回的异常中看到的数据。

我想知道这个问题是否有比通过反射进行复制更好的解决方案。我真的不想创建一个新实例，但我找不到避免它的方法。

另一种可能性是将 Task 对象包装在我自己的类中。但是我的方法不会返回一个任务（或派生自）对象，这可能会导致下游困难。更不用说实现所有 Task 的公共成员并且只调用基本版本的代码量。

显然，下面的代码不起作用，但从概念上讲，这是我想要做的：

```
public class MyTask : Task
{
    override Exception Exception { get { return Tweak(base.Exception); } }
}

public MyTask MyMethod()
{
    Task t = MethodIDontOwnThatReturnsTask();
    return (MyTask) t;     // Can I do this type of operation without copying t?
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:28:48.167

不，一旦创建对象，您就不能更改它的类型。

我也不愿意通过反射执行副本。我很想创建一个新的`TaskCompletionSource`，并从返回的任务中添加一个延续，以`TaskCompletionSource`适当地设置结果，随时调整异常。

我已经有一些代码可以做到这一点，如果你实际上有一个`Task<T>`：

```
var tcs = new TaskCompletionSource<SomeResultType>();
task.ContinueWith(completed =>
{
    PropagateResult(completed, tcs);
}, TaskContinuationOptions.ExecuteSynchronously);
return tcs.Task;
...

// Generally useful method...
private static void PropagateResult<T>(Task<T> completedTask,
    TaskCompletionSource<T> completionSource)
{
    switch (completedTask.Status)
    {
        case TaskStatus.Canceled:
            completionSource.TrySetCanceled();
            break;
        case TaskStatus.Faulted:
            // This is the bit you'd want to tweak
            completionSource.TrySetException(completedTask.Exception.InnerExceptions);
            break;
        case TaskStatus.RanToCompletion:
            completionSource.TrySetResult(completedTask.Result);
            break;
        default:
            throw new ArgumentException("Task was not completed");
    }
} 
```

或者，如果您使用的是 C# 5，您甚至可以使用：

```
public async Task MyMethod()
{
    Task t = MethodIDontOwnThatReturnsTask();
    try
    {
        await t;
    }
    catch(Exception e)
    {
        throw Tweak(e);
    }
} 
```

请注意，如果您需要抛出多个异常，这最终可能会带来更多问题——这取决于您的确切上下文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T19:28:58.980

与其试图改变现有的任务，或者改变它的显示方式，不如创建一个新的`Task`（这就是`ContinueWith`要做的）。它们并不昂贵：

```
public Task MyMethod()
{
    return MethodIDontOwnThatReturnsTask()
        .ContinueWith(t => { throw Tweak(t.Exception); }
        , TaskContinuationOptions.OnlyOnFaulted);
} 
```

# php - 创建具有不同用户的登录系统到 postgreSQL

> ID：14965722
> 
> 赞同：0
> 
> 时间：2013-02-19T19:25:37.813
> 
> 标签：php, postgresql-9.1

我是 postgreSQL 的新手，我正在使用 9.1 版我想创建一个具有不同权限的不同用户的登录系统。

我心中所想的......

有一个简单的用户，我们称他为“访客”。他只能从用户表中“选择”。当有人提供登录名和密码登录时，php 会获取登录名和密码并以“访问者”身份连接到数据库。如果找到匹配对（表中的日志/传递给定日志/传递相同），则让我们启动会话等等，例如

```
session_start();
        $_SESSION['authenticated']=true;
            while ($arr=pg_fetch_array($r)) { 
```

让我们保存用户的ID

```
$_SESSION['c_id']=$arr['c_id']; 
```

并让我们保存用户的“角色”。Role 是一个简单的 int，可以在 users 表中找到。它定义了每个用户的权限。如果是 1 ，用户可以更新/插入/删除表。如果是 2 个用户可以更新/插入/删除两个表，如果是 3 个用户可以更新/插入/删除两个表并添加新用户，在“级别”1 和 2（超级用户）。

这仅仅意味着每个用户都有不同的菜单，所以让我们使用一个简单的“如果”来引导他们使用不同的菜单。

```
$_SESSION['role']=$arr['role'];

if ($_SESSION['role']==1){header('Location:menouOne.php');} 
elseif ($_SESSION['role']==2) {header('Location:menouTwo.php');} 
elseif ($_SESSION['role']==3) {header('Location:menouThree.php');} 
```

例如，menouOne 只有“更新/删除/插入”，menouThree 除了menouOne 之外还有“添加新用户”。

这种做法对我来说听起来不错，但我必须创建很多不同的文件。

所以，我的问题

1.  这是一个好习惯，还是更容易/更快？

2.  你有关于在 postgreSQL 中创建新用户的链接吗？我找到了一些，但我仍然感到困惑。

3.  您是否有任何有关将 md5 安全性添加到 postgreSQL 的链接？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:40:09.257

就我个人而言，我会将所有用户发送到同一页面以及`switch`该页面内的不同设置之间。

例如

```
<?
$_SESSION['role']=$arr['role'];
header("location:themenu.php");
exit;
?>

<?
//themenu.php
session_start();
switch($_SESSION['role'])
{
    case 1://html for role 1
    {
        $controls['update'] = '<div id="contr_update">update</div>';
        $controls['delete'] = '<div id="contr_delete">delete</div>';
        $controls['insert'] = '<div id="contr_insert">insert</div>';
        break;
    }
    case 2://html for role 2
    {
        $controls['update'] = '<div id="contr_update">update</div>';
        $controls['delete'] = '<div id="contr_delete">delete</div>';
        $controls['insert'] = '<div id="contr_insert">insert</div>';
        $controls['adduser'] = '<div id="contr_adduser">add new user</div>';
        break;
    }
    case 3://html for role 3
    {
        $controls['update'] = '<div id="contr_update">update</div>';
        $controls['delete'] = '<div id="contr_delete">delete</div>';
        $controls['insert'] = '<div id="contr_insert">insert</div>';
        $controls['adduser'] = '<div id="contr_adduser">add new user</div>';
        $controls['other'] = '<div id="contr_other">other functions</div>';
        break;
    }
    default:
    {
        header("location:login.php");
        exit;
    }
}
?>
<html>
<head>
...
</head>
<body>
...some html
<? echo $controls['update']; ?>
...some more html
<? echo $controls['delete']; ?>
...some more html
<? echo $controls['insert']; ?>
...some more html
<? echo $controls['adduser']; ?>
...some more html
<? echo $controls['other']; ?>
</body>
</html> 
```

在数据库中存储密码时，您应该使用 MD5 对其进行加密，以便在用户登录时将其与提供的密码进行比较。

$password = md5($password); 将 $password 保存到数据库。

当用户登录时，您执行与上述相同的操作并比较两个加密密码是否匹配。

# ajax - Chrome GET 请求取消并不断重启

> ID：14965724
> 
> 赞同：1
> 
> 时间：2013-02-19T19:25:40.830
> 
> 标签：ajax, google-chrome, get

我正在尝试通过 Chrome使用**window.location = path-to-file/file-name.mp4在我的网站上播放 mp4 视频。**虽然视频播放，但 Chrome 开发者工具网络选项卡显示该请求不断被取消并重新发送：

![图像1](../Images/aa6f86be18e9362329bae24c36222d7f.png).

我已经打开了开发者工具窗口，它显示**已经发出了超过 5000 个请求并传输了超过 600 MB**： ![图3](../Images/e0dd53f2847a6b5287199cbc74664e95.png)

我不知道为什么会发生这种情况。我尝试查看前 4 个请求的请求和响应标头，看看我是否可以发现一些明显的东西（我绝不是专家）： ![图2](../Images/79bff85b8dcd2e6d8de95e49d14e4eec.png)

我唯一能看到的是请求和响应标头中的 RANGE 和 CONTENT-RANGE 似乎正在发生变化。我还注意到第一个响应将 TRANSFER-ENCODING 设置为 CHUNKED。

我尝试研究这些术语，但无法得出任何结论（除了我还有很多要学的，哈哈）。如果有人可以提供任何帮助或指出正确的方向，我将不胜感激:)

谢谢你的帮助！

**编辑：**我想补充一点，我没有使用 XMLHttpRequest 明确创建 GET 请求，只是使用 window.location 在新窗口中播放视频。

# ruby-on-rails - 将 Rails 应用程序部署到 Ubuntu 10.04 VPS 时出现 Libv8 错误

> ID：14965728
> 
> 赞同：0
> 
> 时间：2013-02-19T19:25:52.197
> 
> 标签：ruby-on-rails, node.js, deployment, vps

我已经安装了 nodejs 并且我的应用程序的 Gemfile 没有任何对 therubyracer 或 libv8 的引用。这个错误不断弹出：

`The Ruby Racer requires libv8 ~> 3.11.8...`

任何帮助深表感谢！

我的 Gemfile.lock：

```
宝石
  远程：https://rubygems.org/
  眼镜：
    ASCII85 (1.0.2)
    actionmailer (3.2.12)
      动作包（= 3.2.12）
      邮件 (~> 2.4.4)
    动作包 (3.2.12)
      活动模型（= 3.2.12）
      主动支持 (= 3.2.12)
      建造者 (~> 3.0.0)
      厄鲁比斯 (~> 2.7.0)
      旅程 (~> 1.0.4)
      机架 (~> 1.4.5)
      机架缓存 (~> 1.2)
      机架测试（~> 0.6.1）
      链轮 (~> 2.2.1)
    活动模型（3.2.12）
      主动支持 (= 3.2.12)
      建造者 (~> 3.0.0)
    活动记录（3.2.12）
      活动模型（= 3.2.12）
      主动支持 (= 3.2.12)
      雷尔 (~> 3.0.2)
      tzinfo (~> 0.3.29)
    活动资​​源（3.2.12）
      活动模型（= 3.2.12）
      主动支持 (= 3.2.12)
    主动支持 (3.2.12)
      i18n (~> 0.6)
      multi_json (~> 1.0)
    afm (0.2.0)
    雷尔 (3.0.2)
    bcrypt-ruby (3.0.1)
    更好的错误（0.6.0）
      码雷 (>= 1.0.0)
      厄鲁比斯 (>= 2.6.6)
    binding_of_caller (0.7.1)
      debug_inspector (>= 0.0.1)
    建设者（3.0.4）
    康康 (1.6.9)
    卡皮斯特拉诺 (2.14.2)
      高线
      net-scp (>= 1.0.0)
      网络 sftp (>= 2.0.0)
      网络 SSH (>= 2.0.14)
      网络 ssh 网关 (>= 1.1.0)
    水豚 (2.0.2)
      哑剧类型 (>= 1.16)
      nokogiri (>= 1.3.3)
      机架 (>= 1.0.0)
      机架测试 (>= 0.5.4)
      selenium-webdriver (~> 2.0)
      xpath (~> 1.0.0)
    载波 (0.8.0)
      活动模型 (>= 3.2.0)
      主动支持 (>= 3.2.0)
    赛璐珞 (0.12.4)
      因素 (>= 1.6.12)
      计时器 (>= 1.0.0)
    子进程（0.3.8）
      ffi (~> 1.0, >= 1.0.11)
    选择的轨道（0.9.11.2）
      咖啡轨 (>= 3.2)
      轨道（> = 3.0）
      sass-rails (>= 3.2)
    码雷 (1.0.8)
    咖啡轨 (3.2.2)
      咖啡脚本 (>= 2.2.0)
      railties (~> 3.2.0)
    咖啡脚本（2.2.0）
      咖啡脚本源
      执行
    咖啡脚本源 (1.4.0)
    分列（0.3.6）
    连接池（1.0.0）
    守护进程 (1.1.9)
    database_cleaner (0.9.1)
    debug_inspector (0.0.2)
    调试器 (1.3.1)
      列化（> = 0.3.1）
      调试器-linecache (~> 1.1.1)
      调试器-ruby_core_source (~> 1.1.8)
    调试器-linecache (1.1.2)
      调试器-ruby_core_source (>= 1.1.1)
    调试器-ruby_core_source (1.1.8)
    diff-lcs (1.1.3)
    厄鲁比斯 (2.7.0)
    事件机（1.0.0）
    执行js (1.4.0)
      multi_json (~> 1.0)
    因素 (1.6.17)
    factory_girl (4.2.0)
      主动支持 (>= 3.0.0)
    factory_girl_rails (4.2.1)
      factory_girl (~> 4.2.0)
      轨道（> = 3.0.0）
    法拉第 (0.8.5)
      多部分帖子 (~> 1.1)
    菲（1.4.0）
    哈希（2.1.0）
    哈希（1.2.0）
    高线 (1.6.15)
    远足 (1.2.1)
    httpauth (0.2.0)
    i18n (0.6.1)
    旅程 (1.0.4)
    jquery-datatables-rails (1.11.2)
      jquery-rails
    jquery-rails (2.2.1)
      railties (>= 3.0, = 0.14, = 3.1.0)
    json (1.7.7)
    jwt (0.1.5)
      multi_json (>= 1.0)
    公斤（2.8.0）
    邮件 (2.4.4)
      i18n (>= 0.4.0)
      哑剧类型 (~> 1.16)
      树顶 (~> 1.4.8)
    哑剧类型 (1.21)
    mini_magick (3.5.0)
      子执行 (~> 0.2.1)
    multi_json (1.6.1)
    多部分帖子（1.1.5）
    网络SCP（1.1.0）
      网络 SSH (>= 2.6.5)
    网络 sftp (2.1.1)
      网络 SSH (>= 2.6.5)
    网络SSH（2.6.5）
    网络 ssh 网关 (1.2.0)
      网络 SSH (>= 2.6.5)
    nokogiri (1.5.6)
    oauth2 (0.8.0)
      法拉第 (~> 0.8)
      httpauth (~> 0.1)
      jwt (~> 0.1.4)
      multi_json (~> 1.0)
      机架 (~> 1.2)
    全域认证 (1.1.3)
      哈希（〜> 1.2）
      架子
    omn​​iauth-google-oauth2 (0.1.13)
      全域认证 (~> 1.0)
      全域认证-oauth2
    omn​​iauth-oauth2 (1.1.1)
      oauth2 (~> 0.8.0)
      全域认证 (~> 1.0)
    paper_trail (2.7.1)
      活动记录 (~> 3.0)
      railties (~> 3.0)
    pdf阅读器 (1.3.1)
      Ascii85 (~> 1.0.0)
      afm (~> 0.2.0)
      哈希 (~> 2.0)
      红宝石-rc4
      ttfunk
    pg (0.14.1)
    多语言（0.3.3）
    对虾 (0.12.0)
      pdf阅读器（> = 0.9.0）
      ttfunk (~> 1.0.2)
    机架 (1.4.5)
    机架缓存 (1.2)
      机架 (>= 0.4)
    机架 SSL (1.3.3)
      架子
    机架测试（0.6.2）
      机架 (>= 1.0)
    导轨 (3.2.12)
      actionmailer (= 3.2.12)
      动作包（= 3.2.12）
      活动记录（= 3.2.12）
      活动资​​源（= 3.2.12）
      主动支持 (= 3.2.12)
      捆绑器 (~> 1.0)
      轨道（= 3.2.12）
    铁路 (3.2.12)
      动作包（= 3.2.12）
      主动支持 (= 3.2.12)
      机架 SSL (~> 1.3.2)
      耙子 (>= 0.8.7)
      rdoc (~> 3.4)
      雷神 (>= 0.14.6, 1.4)
    redis (3.0.2)
    redis 命名空间 (1.2.1)
      redis (~> 3.0.0)
    rspec 核心 (2.12.2)
    rspec-expectations (2.12.1)
      diff-lcs (~> 1.1.3)
    rspec 模拟 (2.12.2)
    rspec-rails (2.12.2)
      动作包 (>= 3.0)
      主动支持 (>= 3.0)
      轨道（> = 3.0）
      rspec-core (~> 2.12.0)
      rspec-expectations (~> 2.12.0)
      rspec-mocks (~> 2.12.0)
    红宝石-rc4 (0.1.5)
    rubyzip (0.9.9)
    萨斯（3.2.5）
    sass-rails (3.2.6)
      railties (~> 3.2.0)
      萨斯（> = 3.1.10）
      倾斜 (~> 1.3)
    硒网络驱动程序（2.29.0）
      子进程 (>= 0.2.5)
      multi_json (~> 1.0)
      rubyzip
      websocket (~> 1.0.4)
    sidekiq (2.7.2)
      赛璐珞 (~> 0.12.0)
      连接池 (~> 1.0)
      multi_json (~> 1)
      redis (~> 3)
      redis 命名空间
    simple_form (2.0.4)
      动作包 (~> 3.0)
      活动模型 (~> 3.0)
    链轮 (2.2.2)
      远足 (~> 1.2)
      multi_json (~> 1.0)
      机架 (~> 1.0)
      倾斜 (~> 1.1, != 1.3.0)
    子执行 (0.2.2)
    薄（1.5.0）
      守护进程 (>= 1.0.9)
      事件机（>= 0.12.6）
      机架 (>= 1.0.0)
    雷神 (0.17.0)
    倾斜 (1.3.3)
    计时器 (1.1.0)
    树顶 (1.4.12)
      多语种
      多语言 (>= 0.3.1)
    ttfunk (1.0.3)
    tzinfo (0.3.35)
    丑化者 (1.3.0)
      execjs (>= 0.3.0)
      multi_json (~> 1.0, >= 1.0.2)
    独角兽 (4.6.0)
      kgio (~> 2.6)
      架子
      雨滴 (~> 0.7)
    网络套接字（1.0.7）
    xpath (1.0.0)
      nokogiri (~> 1.3)

平台
  红宝石

依赖项
  bcrypt-ruby
  更好的错误
  binding_of_caller
  可以可以
  卡皮斯特拉诺
  水豚
  载波
  选择轨道
  咖啡轨
  database_cleaner
  调试器
  factory_girl_rails
  jquery-datatables-rails
  jquery-rails
  jquery-ui-rails
  mini_magick
  omn​​iauth-google-oauth2
  paper_trail
  皮克
  虾
  导轨
  rspec-rails
  sass-rails
  侧基
  简单的模式
  薄的
  丑化者
  独角兽

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:44:31.807

试试这个：

```
$ gem uninstall libv8
$ gem install therubyracer 
```

# android - Titanium - 知道联系人是否安装了我的应用程序

> ID：14965738
> 
> 赞同：0
> 
> 时间：2013-02-19T19:26:35.043
> 
> 标签：android, ios, titanium, contacts, acs

我在我的应用程序中使用 Chat ACS Titanium [http://cloud.appcelerator.com/docs/api/v1/chats/create](http://cloud.appcelerator.com/docs/api/v1/chats/create)。我需要知道我的通讯录中是否有人安装了我的应用程序（例如 whatsapp o viber）。有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:09:29.050

您可以从通讯录中获取所有电子邮件地址或电话号码或类似信息，然后运行查询以查找所有匹配的用户（提示：您将使用`email: { $in: [ 'all', 'the', 'emails' ] }`）。

[http://cloud.appcelerator.com/docs/api/v1/users/query](http://cloud.appcelerator.com/docs/api/v1/users/query)

# javascript - JavaScript：多时区时钟

> ID：14965739
> 
> 赞同：0
> 
> 时间：2013-02-19T19:26:42.580
> 
> 标签：javascript, timezone, clock

我想使用 JavaScript 显示来自 3 个不同时区的 3 个时钟。我在网上浏览了一个简单的解决方案，但我发现的只是长脚本和 .js 扩展名，所有这些都是为了完成一项简单的任务。

是否有捷径可寻？我真的必须添加一个额外的 JS 文件来完成这个任务吗？

在此先感谢帮助者！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T20:21:47.180

> 是否有捷径可寻？

是的。

> 我真的必须添加一个额外的 JS 文件来完成这个任务吗？

不。但是，JS 中的时间处理很困难，因为它没有真正跨浏览器安全的日期/时间字符串解析和格式化方法。为此使用库可能会有所帮助，但这对于您的时钟来说不是必需的。

```
// all three clocks represent current time
var clock1 = new Date(); // current moment
var clock2 = new Date();
var clock3 = new Date();

// for outputting, adjust them
// leave clock1 in UTC
clock2.setHours(clock2.getHours() + 3); // UTC+3
clock3.setHours(clock3.getHours() - 5); // UTC-5

// now for display, use these values:
clock1.getUTCHours();
clock1.getUTCMinutes();
clock1.getUTCSeconds();

clock2.getUTCHours();
clock2.getUTCMinutes();
clock2.getUTCSeconds();

clock3.getUTCHours();
clock3.getUTCMinutes();
clock3.getUTCSeconds(); 
```

# mysql - 在不依赖任何 ID 的情况下选择 MySQL 中的每隔一行？

> ID：14965747
> 
> 赞同：6
> 
> 时间：2013-02-19T19:26:57.090
> 
> 标签：mysql, sql

考虑到下表没有任何主键，我可以选择每隔一行吗？

```
col1      col2
 2         a
 1         b
 3         c
 12        g 
```

首先选择必须找到：**2、3**

第二个选择必须找到：**1、12**

**那可能吗？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T19:32:34.950

以独特的 MySQL 方式：

```
select  *
from    (
        select  *
        ,       @rn := @rn + 1 as rn
        from    Table1
        join    (select @rn := 0) i
        ) s
where   rn mod 2 = 0 -- Use = 1 for the other set 
```

[SQL Fiddle 的示例。](http://sqlfiddle.com/#!2/0bccf/20/0)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T19:38:31.787

尝试这个。我已经根据下面链接的答案对其进行了改编。我在 SQLFiddle 上对其进行了测试，它似乎可以工作。

[http://sqlfiddle.com/#!2/0bccf/28](http://sqlfiddle.com/#!2/0bccf/28)
[http://sqlfiddle.com/#!2/0bccf/29](http://sqlfiddle.com/#!2/0bccf/29)

奇数行：

```
SELECT x.*
FROM (
     SELECT @rownum:=@rownum+1 rownum, t.*
     FROM (SELECT @rownum:=0) r, table t
) x
WHERE MOD(x.rownum, 2) = 1 
```

偶数行：

```
SELECT x.*
FROM (
     SELECT @rownum:=@rownum+1 rownum, t.*
     FROM (SELECT @rownum:=0) r, table t
) x
WHERE MOD(x.rownum, 2) = 0 
```

改编自： [MySQL 行号](https://stackoverflow.com/questions/3576304/mysql-row-number)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-19T12:21:11.530

是的，可以使用临时变量

例子 ：

```
set @a := 0;
select * from car_m_city  WHERE mod((@a:=@a+1), 2) = 1 
```

解释 ：

在 sql 中，我们声明了 @a( `set @a := 0;`) 临时变量。`(@a:=@a+1)`现在`@a`增加 1.jsut 就像检查奇数或偶数的简单方法一样

`mod((@a:=@a+1), 2) = 1`对于奇数数据

`mod((@a:=@a+1), 2) = 0`对于偶数数据

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-10-09T08:13:27.140

这对我有用。

```
 SET @row_number = 0;

    select* from (
        SELECT 
        (@row_number:=@row_number + 1) AS num, col1,col2
    FROM
        TABLE1
        ) as t WHERE num%2=0 
```

您可以将 mod 1 用于奇数行或 mod 0 用于偶数行

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-19T19:32:42.190

这应该适用于 MySQL：

```
SELECT col1, col2
FROM (
   SELECT col1, col2, @rowNumber:=@rowNumber+ 1 rn
   FROM YourTable
      JOIN (SELECT @rowNumber:= 0) r
) t 
WHERE rn % 2 = 1 
```

这使用 % ，它是 MOD 运算符。

这是示例小提琴：[http ://sqlfiddle.com/#!2/cd31b/2](http://sqlfiddle.com/#!2/cd31b/2)

# javascript - 如何将图像设置为 背景

> ID：14965750
> 
> 赞同：0
> 
> 时间：2013-02-19T19:27:19.387
> 
> 标签：javascript, jquery, html, canvas

我正在开发一个项目，该项目将在表格下方有一个表格和画布字段。

我需要将其中一张图片作为背景，在我的情况下是 tshirt.png。

到目前为止，我已经完成了以下工作。我有两个文件（index.html 和 jQuery.js）

指数

```
<html>
  <head>
<script src="js/jQuery.js"></script>
 </head>
   <table border="1">
        <tr>
    <td>#</td>
    <td>filename</td>
    <td>x</td>
    <td>y</td>
    <td>z</td>
        </tr>

<tr>
    <td>1</td>
    <td><img src="images/sheep.png" width="40px" height="40px"></img></td>
    <td><input type="text" value="" name="x"></td>
    <td><input type="text" value="" name="y"></td>
    <td><input type="text" value="" name="z"></td>
</tr>
<tr>
    <td>2</td>
    <td><img src="images/tshirt.png" width="40px" height="40px"></td>
    <td><input type="text" value=""></td>
    <td><input type="text" value=""></td>
    <td><input type="text" value=""></td>
  </tr>
  <tr>
    <td>3</td>
    <td>item.png</td>
    <td><input type="text" value=""></td>
    <td><input type="text" value=""></td>
    <td><input type="text" value=""></td>
   </tr>
    </table>

   <section id="main">
   <canvas  id="canvas" width="1024" height="768" style="border:1px solid red;">    
   </canvas>
   </section>
</html> 
```

jQuery.js

```
function doFirst(){
    var x = document.getElementById('canvas');
    canvas = x.getContext('2d');

    var pic = new Image();
    pic.src = "images/sheep.png";
    pic.addEventListener("load", function() { canvas.drawImage(pic,0,0,100,200)}, false);

    var background = new Image();
    background.src = "images/tshirt.png";
    background.addEventListener("load",function(){
        canvas.drawImage(background,0,250,200,300)}, false);
    }
    window.addEventListener("load", doFirst, false); 
```

欢迎任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:07:43.873

画布当然采用不同的思维方式和方法，但请记住有时退后一步，考虑一种更“简单”的方法，这将有助于过度设计您的代码。

只需使用 CSS 定义背景

```
background: url("images/tshirt.png"); 
```

以下是如何[通过上一篇文章中的 jQuery 在 JavaScript中设置它](https://stackoverflow.com/questions/512054/setting-background-image-using-jquery-css-property)

# php - Android ListView 显示来自 php 的空值

> ID：14965751
> 
> 赞同：0
> 
> 时间：2013-02-19T19:27:26.810
> 
> 标签：php, android, mysql, null

我有一个令人作呕的问题。

我在 MySQL-DB 上有两个数据表。第一个表（用户）是给我想用 id 删除的用户。第二个表（数据）应该为我设置的每一个信息的用户设置多个信息。

创建用户作品、为用户作品创建信息、获取所有用户作品的所有信息以及编辑单个信息。

现在我正在尝试创建一个 Activity，我可以在其中显示单个用户的信息。在我选择我的用户后，Activty 启动并通过 php 获取该用户的信息（在这种情况下只有 id、用户）。

在我得到我的用户详细信息后，android 通过 php 检查是否有单个用户的任何信息。它似乎有效，但创建的 ListView 仅显示空值。

这是java：

```
private ProgressDialog pDialog;
private ProgressDialog pDialog1;

JSONParser jParser = new JSONParser();
JSONParser jsonParser = new JSONParser();
ArrayList<HashMap<String, String>> productsList;

private static String url_all_user_details = "http://10.10.0.2/get_all_user_details.php";
private static final String url_single_details = "http://192.168.222.10:81/get_single_details.php";
// JSON Node names
private static final String TAG_SUCCESS = "success";
private static final String TAG_DETAILS = "products";
private static final String TAG_PRODUCT = "product";
private static final String TAG_WID = "wid";    
private static final String TAG_ID = "id";
private static final String TAG_USER = "user";
private static final String TAG_INFO = "info";
private static final String TAG_COMMENT = "COMMENT";

String id;
String user;
String wid;                             
String info; 
String comment;                 
String stat;
TextView txtNamear;
JSONArray products;

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.tweener);

    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder()
    .permitAll().build();
    StrictMode.setThreadPolicy(policy); 

    TextView txtNamear = (TextView) findViewById(R.id.GesVerlauftxt);
    txtNamear.setText("Verlauf für: "); 
    TextView txtNamear2 = (TextView) findViewById(R.id.useruni);    
    txtNamear2.setText(user);       

    Intent i = getIntent(); 
    user = i.getStringExtra(TAG_USER);  

    Intent i3 = getIntent();    
    id = i3.getStringExtra(TAG_ID);

    Intent i1 = getIntent();    
    id = i1.getStringExtra(TAG_ID); 

    productsList = new ArrayList<HashMap<String, String>>();

    new LoadAllDetails().execute();
    new GetUserDetails().execute();

    ListView lv = getListView();            
}
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    if (resultCode == 100) {

        Intent intent = getIntent();
        finish();
        startActivity(intent);
    }
}   
class GetUserDetails extends AsyncTask<String, String, String> 
{
    @Override
    protected void onPreExecute() 
    {
        super.onPreExecute();
        pDialog = new ProgressDialog(TweenerActivity.this);
        pDialog.setMessage("Lade Informationen.Bitte warten...");
        pDialog.setIndeterminate(false);
        pDialog.setCancelable(true);
        pDialog.show();
    }
    protected String doInBackground(String... params) 
    {
        runOnUiThread(new Runnable() 
        {
            public void run() 
            { 
                int success;
                try 
                {
                    List<NameValuePair> params = new ArrayList<NameValuePair>();
                    params.add(new BasicNameValuePair("id", id));

                    JSONObject json = jsonParser.makeHttpRequest(
                            url_product_details, "GET", params);
                    Log.d("Single Product Details", json.toString());                       
                    success = json.getInt(TAG_SUCCESS);

                    if (success == 1) 
                    {

                        JSONArray productObj = json.getJSONArray(TAG_PRODUCT);                      
                        JSONObject product = productObj.getJSONObject(0);                           

                        txtNamear = (TextView) findViewById(R.id.useruni);
                        txtNamear.setText(product.getString(TAG_USER));                         
                    }
                    else
                    {   
                    }
                } 
                catch (JSONException e) 
                {
                    e.printStackTrace();
                }
            }
        });
        return null;
    }
    protected void onPostExecute(String file_url) 
    {
        pDialog.dismiss();
    }
}
class LoadAllDetails extends AsyncTask<String, String, String> 
{   
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        pDialog1 = new ProgressDialog(TweenerActivity.this);
        pDialog1.setMessage("Lade Informationen. Bitte warten...");
        pDialog1.setIndeterminate(false);
        pDialog1.setCancelable(false);
        pDialog1.show();
    }
    protected String doInBackground(String... args) {

        List<NameValuePair> params = new ArrayList<NameValuePair>();

        params.add(new BasicNameValuePair("id", id));
        JSONObject json = jParser.makeHttpRequest(url_all_user_details, "GET", params);     

        Log.d("All User details ", json.toString());
        try 
        {
            int success = json.getInt(TAG_SUCCESS);

            if (success == 1) 
            {
                products = json.getJSONArray(TAG_DETAILS);

                for (int i = 0; i < products.length(); i++)
                {
                    JSONObject c = products.getJSONObject(i);

                    wid    = c.getString(TAG_WID);                      
                    user  = c.getString(TAG_USER);      
                    info = c.getString(TAG_INFO);
                    comment  = c.getString(TAG_COMMENT);                    
                    stat   = c.getString(TAG_STAT);

                    HashMap<String, String> map = new HashMap<String, String>();

                    map.put(TAG_WID, wid);
                    map.put(TAG_USER, user);
                    map.put(TAG_INFO, info);
                    map.put(TAG_COMMENT, comment);
                    map.put(TAG_STAT, stat);

                    productsList.add(map);
                }
            } 
            else 
            {       
                Intent i4 = new Intent(getApplicationContext(),NewInfoActivity.class);
                i4.putExtra(TAG_ID, id);        

                startActivityForResult(in, 100);    
            }
        } 
        catch (JSONException e)
        {
            e.printStackTrace();
        }
        return null;
    }
    protected void onPostExecute(String file_url)
    {
        pDialog1.dismiss();

        runOnUiThread(new Runnable() 
        {
            public void run() 
            {           
                ListAdapter adapter = new SimpleAdapter(
                        TweenerActivity.this, productsList,
                        R.layout.list_item_tweener, new String[] { TAG_WID,
                                 TAG_USER, TAG_INFO, TAG_COMMENT, TAG_STAT },
                        new int[] {R.id.widTween, R.id.userTween, R.id.infoTween, R.id.commentTween, R.id.statTween});

                setListAdapter(adapter);
            }
        });
    }
} 
```

这是我的php：

//if (isset($_GET["id"])){ $id = $_GET['id'];

```
$result = mysql_query('set names utf8'); 
$result = mysql_query("SELECT * FROM daten WHERE id = $id")or die(mysql_error()); 

if (mysql_num_rows($result) > 0)  
{ 

    $response["products"] = array(); 
    while ($row = mysql_fetch_array($result))  
    { 

    $product = array(); 
            $product["wid"]          = $result["wid"]; 
            $product["user"]       = $result["user"]; 
        $product["info"]        = $result["info"]; 
    $product["comment"] = $result["comment"]; 
    $product["stat"]       = $result["stat"]; 

    array_push($response["products"], $product); 
    } 

    $response["success"] = 1; 

    echo json_encode($response); 
}  
else  
{ 

$response["success"] = 0; 
$response["message"] = "No products found"; 

echo json_encode($response); 
} 
```

Logcat 显示：

D/Single User Details(7218): {"product":[{"id":"13","user":"Test"}],"success":1} D/dalvikvm(7218): GC_CONCURRENT freed 141K , 3% 免费 8834K/9095K, 暂停 1ms+3ms D/所有用户详细信息(7218): {"success":1,"products":[{"info":null,"comment":null,"wid": null,"stat":null,"user":null},{"info":null,"comment":null,"wid":null,"stat":null,"user":null},{"info ":null,"comment":null,"wid":null,"stat":null,"user":null}]}

我真的希望你能帮助我。从这里开始无法自拔。

谢谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:08:01.597

在您的 php 文件中，您需要更改`$result`为`$row`in`while`循环

```
 while ($row = mysql_fetch_array($result))  
  { 
    $product = array(); 
    $product["wid"] = $row["wid"]; 
    $product["user"] = $row["user"]; 
    $product["info"] = $row["info"]; 
    $product["comment"] = $row["comment"]; 
    $product["stat"] = $row["stat"]; 

    array_push($response["products"], $product); 
  } 
```

# python - 在 Python 中的字符串中添加空格？

> ID：14965752
> 
> 赞同：1
> 
> 时间：2013-02-19T19:27:39.213
> 
> 标签：python, string, space

我对 Python 比较陌生（使用 v2.7.3），我决定通过编辑包含我在手机上收到的所有文本的文本文档来测试我的技能。我想编辑掉无用的信息，所以我写了一个脚本来做到这一点，但是单词之间的所有空格都被删除了。

这是输入数据的示例：

> 短信协议=“932”地址=“XXXXXXXXXX”日期=“1305655717379”类型=“1”主题=“空”正文=“和乔伊说话？” toa="null" sc_toa="null" service_center="null" read="1" status="-1" locked="0" date_sent="null" readable_date="2011 年 5 月 17 日下午 2:08:37" contact_name="大卫 XXXX" />

这是输出数据的示例：

> body="Talktojoey?"toa="null"sc_toa="null"service_center="null"read="1"status="-1"locked="0"date_sent="null"readable_date="May17,20112:08 :37PM"contact_name="DavidXXXX/>

这是我的代码：

```
line= textfile.readline() 
for line in textfile:

    line = line.strip() 
    line = line.split(' ')     
    del line[0:6]
    line.append("\n")
    print line
    output.writelines(line)

textfile.close()

output.close() 
```

任何有关如何添加空格的帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:48:55.317

如果您仔细查看您的数据行，您会发现它是缺少前导“<”的 xml 片段。如果您添加“<”，您现在将拥有一个“短信”xml 元素。

```
>>> input = '<sms protocol="932" address="XXXXXXXXXX" date="1305655717379" type="1" subject="null" body="Talk to joey?" toa="null" sc_toa="null" service_center="null" read="1" status="-1" locked="0" date_sent="null" readable_date="May 17, 2011 2:08:37 PM" contact_name="David XXXX" />' 
```

现在我们可以使用 ElementTree 之类的东西来处理它。

```
>>> import xml.etree.ElementTree as ET
>>> element = ET.fromstring(input) 
```

现在您可以将标签的属性作为友好的字典来访问。

```
>>> element.attrib 
{'body': 'Talk to joey?', 'service_center': 'null', 'protocol': '932', 'read': '1', 'sc_toa': 'null', 'readable_date': 'May 17, 2011 2:08:37 PM', 'date': '1305655717379', 'status': '-1', 'address': 'XXXXXXXXXX', 'date_sent': 'null', 'locked': '0', 'contact_name': 'David XXXX', 'toa': 'null', 'type': '1', 'subject': 'null'} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:30:14.703

这点...

```
line = line.split(' ') 
```

将其拆分为碎片时删除空格。您需要将它们重新添加到：

```
line = line.split(' ')     
del line[0:6]
line = ' '.join(line)
line += "\n"
print line,
output.write(line) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:41:48.007

这里的问题是您正在调用`output.writelines(line)`.

我不确定在给定字符串列表时您期望它做什么，但是您不能期望将它们打印为中间有空格的单词。这些词不是单独的行，你不希望它们那样。

那么，如何将单词列表连接成一个字符串，并用空格分隔单词？使用[`join`](http://docs.python.org/2/library/stdtypes.html#str.join)方法：

```
' '.join(line) 
```

然后，不要使用`writelines`（需要多行），只需使用`write`：

```
output.write(' '.join(line)) 
```

请参阅有关[输入和输出](http://docs.python.org/2/tutorial/inputoutput.html)`write`的教程，了解和`writelines`（以及其他内容）之间的区别。

# javascript - 从 JavaScript 确定元素的自定义 CSS 光标热点坐标

> ID：14965756
> 
> 赞同：11
> 
> 时间：2013-02-19T19:27:48.740
> 
> 标签：javascript, css, mouse-cursor

当我尝试在 JavaScript 中获取 HTML 元素的完整 CSS 光标定义时，由于某种原因它忽略了热点（目标像素）坐标，导致我的光标将其热点重置为光标图像的左上角像素（即不是一件好事）。

[此 JSFiddle 中演示的问题](http://jsfiddle.net/ck3nd/)。

**更新：**在某些浏览器中似乎只有这种方式，特别是（在我的测试中）Mac Chrome 和 Safari。

**更新 2：**看起来这实际上已在 WebKit 的最新夜间版本（8536.26.17、537+）中得到修复，所以我想除了它是一个错误之外不需要真正的答案，并且已经修复。

例如：

```
var elem = document.createElement("div");
elem.style.cursor = "url('path/to/cursor') 9 9, auto";
console.log( elem.style.cursor ); 
```

输出：

```
url(path/to/cursor), auto 
```

设置好后有什么方法可以从样式中获取这些坐标？我试过`window.getComputedStyle()`了，但结果是一样的。

这对我来说似乎是一个相当大的疏忽。该信息是否只是丢失并且不再可检索？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:57:03.440

据我查看 CSS 2.1 规范可知，X 和 Y 坐标不包括在内：

[http://www.w3.org/TR/CSS21/ui.html#cursor-props](http://www.w3.org/TR/CSS21/ui.html#cursor-props)

此外，[Mozilla 开发者网络](https://developer.mozilla.org/en-US/docs/CSS/cursor)将 X、Y 坐标列为“实验性”。

如果规范中没有某些内容，那么您可以期望浏览器具有不同的，有时是冲突的属性实现。

# html - 在 Yii 表单中拥有 html5 表单元素的最佳方式

> ID：14965757
> 
> 赞同：2
> 
> 时间：2013-02-19T19:27:55.417
> 
> 标签：html, forms, yii

我需要在 Yii 表单中有一些特殊的 html5 表单元素，例如**range**、**number**和 ...。

在我的表单中实现它们的最佳和最清晰的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T20:44:15.917

CHtml 自 1.1.11 起支持它们，例如。

*   [http://www.yiiframework.com/doc/api/1.1/CHtml#activeEmailField-detail](http://www.yiiframework.com/doc/api/1.1/CHtml#activeEmailField-detail)
*   [http://www.yiiframework.com/doc/api/1.1/CHtml#activeNumberField-detail](http://www.yiiframework.com/doc/api/1.1/CHtml#activeNumberField-detail)

# google-drive-api - 如果我在我的应用程序中使用 Google Drive SDK，是否可以向用户隐藏保存的数据？

> ID：14965758
> 
> 赞同：0
> 
> 时间：2013-02-19T19:27:58.130
> 
> 标签：google-drive-api

我想使用 Google drive sdk 将我的应用程序中的数据保存在用户自己的 Google drive 帐户中。这意味着应用程序的开发人员（即我）将无法访问用户存储的敏感数据。

我找到了一些有关如何执行此操作的文档（该应用程序将是 Google 应用程序引擎应用程序），但我想知道是否可以锁定此数据或完全隐藏它，以便用户无法进入并编辑数据，并且可能造成问题。

我知道使用 Google Drive 的 Android 应用程序不会留下任何可见文件，当我转到我的 Drive 帐户时可以看到这些文件。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:38:43.343

创建[文件](https://developers.google.com/drive/v2/reference/files/insert?hl=en)时，将`hidden`标签设置为 True。这将从大多数用户视图中隐藏文件。请注意，如果用户拥有该文件，它并不能完全阻止用户查找和修改该文件。

如果您需要所有者无法编辑该文件，您的应用将需要拥有它并仅授予用户查看访问权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-03T19:30:46.713

在[Google Play Services 4.3](https://developers.google.com/drive/release-notes)中，他们添加了一个“应用程序文件夹”。这旨在允许应用程序将数据存储在用户的驱动器中，而不允许他们修改这些数据。它适用于[android](https://developers.google.com/drive/android/appfolder)和[web](https://developers.google.com/drive/web/appdata)，没有看到它为 iOS 列出。

# php - PHP MYSQL 查询连接表以获取父表查询的最后一行

> ID：14965765
> 
> 赞同：1
> 
> 时间：2013-02-19T19:28:15.220
> 
> 标签：php, mysql, sql, group-by

我有两张桌子：ticket & history_ticket

桌票：

```
ticket_id  | ticket_desc   
 1         |  software   
 2         |  hardware   
 3         |  other 
```

表 history_ticket ：

```
history_id | ticket_id | message  | status    
 1         |  1        |  text    |  process 
 2         |  2        |  text    |  solve   
 3         |  3        |  text    |  process
 4         |  3        |  text    |  solve 
```

我想要这样的结果

```
ticket_id  | ticket_desc  | status 
 1         |  software    |  process
 2         |  hardware    |  solve
 3         |  other       |  solve 
```

我尝试了各种连接和子选择，但没有运气

任何帮助/方向将不胜感激！

更新：如果我改变结果，像这样

```
ticket_id  | ticket_desc  | last_status | count_message
     1     |  software    |  process    |     1
     2     |  hardware    |  solve      |     1
     3     |  other       |  solve      |     2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:30:08.930

```
select distinct ticket.ticket_id, ticket.ticket_desc, history_ticket.status 
from ticket 
join history_ticket on ticket_id 
```

据我所知，如果您有多个描述和状态，它将随机选择一个描述和状态。如果您想应用特定规则来选择哪个规则，请提供更多信息，我们可以在这方面为您提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:31:03.130

尝试

```
SELECT DISTINCT 
    tk.ticket_id, 
    tk.ticket_desc, 
    ht.status 
FROM ticket tk JOIN history_ticket ht ON tk.ticket_id = tk.ticket_id 
ORDER BY tk.ticket_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:31:13.610

尝试，

```
Select distinct t.ticket_id, t.ticket_desc, h.status 
from ticket t, history_ticket h
where t.ticket_id = h.ticket_id
order by t.ticket_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T19:32:32.070

试试这个：

```
SELECT
  t.ticket_id, 
  ticket_desc, 
  ht.status
FROM ticket AS t
INNER JOIN history_ticket AS ht ON t.ticket_id = ht.ticket_id
INNER JOIN
(
   SELECT ticket_id, MAX(history_id) maxid
   FROM history_ticket
   GROUP BY ticket_id
) AS ht2 ON ht.history_id = ht2.maxid; 
```

## [SQL 小提琴演示](http://sqlfiddle.com/#!2/0d086/3)

这会给你：

```
| TICKET_ID | TICKET_DESC |  STATUS |
-------------------------------------
|         1 |    software | process |
|         2 |    hardware |   solve |
|         3 |     Problem |   solve | 
```

* * *

## 更新 1

要获取每张票的消息数，您可以`COUNT(history_id) AS sum_message`像这样简单地包含在子查询中：

```
SELECT
  t.ticket_id, 
  ticket_desc, 
  ht.status, 
  ht2.sum_message
FROM ticket AS t
INNER JOIN history_ticket ht ON t.ticket_id = ht.ticket_id
INNER JOIN
(
   SELECT 
     ticket_id, 
     MAX(history_id) maxid, 
     COUNT(history_id) AS sum_message
   FROM history_ticket
   GROUP BY ticket_id
) AS ht2 ON ht.history_id = ht2.maxid; 
```

## [更新的 SQL Fiddle 演示](http://sqlfiddle.com/#!2/0d086/5)

这会给你：

```
| TICKET_ID | TICKET_DESC |  STATUS | SUM_MESSAGE |
---------------------------------------------------
|         1 |    software | process |           1 |
|         2 |    hardware |   solve |           1 |
|         3 |     Problem |   solve |           2 | 
```

* * *

## 更新 2

如果您想为 ids 选择名称`divisi_id`，对于简单值，您可以使用以下`CASE`表达式：

```
SELECT
  t.ticket_id, 
  ticket_desc, 
  CASE 
    WHEN t.divisi_id = 101 THEN 'Divisi A'
    WHEN t.divisi_id = 102 THEN 'Divisi B'
  END AS 'Divisi',
  ht.status, 
  ht2.sum_message
FROM ticket AS t
INNER JOIN history_ticket ht ON t.ticket_id = ht.hticket_id
INNER JOIN
(
   SELECT hticket_id, MAX(history_id) maxid, COUNT(history_id) AS sum_message
   FROM history_ticket
   GROUP BY hticket_id
) AS ht2 ON ht.history_id = ht2.maxid; 
```

## [更新的 SQL Fiddle 演示](http://sqlfiddle.com/#!2/eba04/6)

这会给你：

```
| TICKET_ID | TICKET_DESC |   DIVISI |  STATUS | SUM_MESSAGE |
--------------------------------------------------------------
|         1 |    software | Divisi A | process |           1 |
|         2 |    hardware | Divisi B |   solve |           1 |
|         3 |     Problem | Divisi A |   solve |           2 | 
```

对于多个值，您可以将它们放在临时表中，也可以在子查询中选择它们并加入表以获取如下名称：

```
SELECT
  t.ticket_id, 
  ticket_desc, 
  d.Divisi,
  ht.status, 
  ht2.sum_message
FROM ticket AS t
INNER JOIN history_ticket ht ON t.ticket_id = ht.hticket_id
INNER JOIN
(
   SELECT hticket_id, MAX(history_id) maxid, COUNT(history_id) AS sum_message
   FROM history_ticket
   GROUP BY hticket_id
) AS ht2 ON ht.history_id = ht2.maxid
INNER JOIN
(
  SELECT 101 AS divisi_id, 'Divisi A' AS Divisi
  UNION ALL
  SELECT 102             , 'Divisi B'
  ... -- here you put other values or you can join a temp table instead
) AS D ON t.divisi_id = D.divisi_id; 
```

## [更新的 SQL Fiddle 演示](http://sqlfiddle.com/#!2/eba04/7)

# tfs - 从 TFS API 获取已安装的 TFS 服务器版本（是 2010 还是 2012？）

> ID：14965769
> 
> 赞同：2
> 
> 时间：2013-02-19T19:28:23.827
> 
> 标签：tfs, tfs-sdk

我有一个调用 TFS 2010 和 2012 实例的 WCF 服务。我正在寻找一种在 API 中区分 2010 和 2012 的方法，但似乎没有 GetServerVersion() 或类似的 API。

原因是 2010 和 2012 处理工作项链接的方式略有变化：

*   2010 年工作项目链接：`http://TFSUri/web/wi.aspx?id=WorkItemID`

*   2012年工作项目链接： `http://TFSUri/TFSProject/_workitems/edit/WorkItemID`

最坏的情况是我可以让人们选择他们的版本，但如果可能的话，我真的更喜欢自动区分 2010 和 2012。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T01:42:49.543

如果我了解您的用例，另一种方法，可以说比为给定的 TFS 版本定义 URL 模式更好的方法是使用[`TswaClientHyperlinkService`](http://msdn.microsoft.com/en-us/library/ff737417.aspx)来生成您的 URL。您可以使用此 API 类为给定的工作项 ID 生成 URL，例如，通过[`GetWorkItemEditorUrl`](http://msdn.microsoft.com/en-us/library/ff736178.aspx)方法；例如使用 v11 客户端 dll：

```
var collection = new TfsTeamProjectCollection(
                     new Uri("http://<tfsuri>/tfs/<collection>/"));

var hyperlinkService = collection.GetService<TswaClientHyperlinkService>();
var link = hyperlinkService.GetWorkItemEditorUrl(<workitemid>);

// against TFS 2012:
// var link: 
//  http://<tfsuri>/tfs/web/wi.aspx?pcguid=<guid>&id=<workitemid>
// redirects to 
//  http://<tfsuri>/tfs/<collection>/<project>/_workitems#_a=edit&id=<workitemid> 
```

我没有 TFS 2010 实例来测试它，但手指交叉这将在对不同版本的调用中是透明的。

* * *

说了这么多，这个问题之前有人[问过](https://stackoverflow.com/questions/10234253/how-can-the-version-of-a-team-foundation-server-be-determined-programmatically)。但是已接受答案链接中的方法通过识别每个版本中引入的功能来派生不同的版本。这适用于区分 2005、2008 和 2010。我不知道是否可以使用相同的方法来区分 2010 和 2012（或者现在是否存在更可口的 API 方法）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T12:43:13.167

您可以使用`IBuildServer`Build.Client 中的接口来获取服务器的版本。

```
TeamFoundationServer tfs = new TeamFoundationServer(@"http://yourtfs:8080/tfs");
IBuildServer tfsb = tfs.GetService<IBuildServer>();
Console.WriteLine(tfsb.BuildServerVersion); //v3 for 2010 and v4 for 2012 
```

# android - 如何获得正确的幻灯片以在 android 中单击按钮

> ID：14965772
> 
> 赞同：3
> 
> 时间：2013-02-19T19:28:31.690
> 
> 标签：android, actionbarsherlock, slidingmenu

[嘿，我在这里](https://github.com/jfeinstein10/SlidingMenu)找到了非常好的库，它有助于在 android 中实现滑动。问题是，使用这个库，我可以一次在一侧切换，即在左侧或右侧。

我想在两侧实现切换，即如果我单击左侧按钮，我希望出现左视图，如果我单击右键，应该出现类似的右视图。

我也从同一作者那里得到了一个分支，即[在这里](https://github.com/jfeinstein10/SlidingMenu/tree/slidingright)。在此，我们可以选择在切换天气时指定向左或向右。

我们需要将它们合并在一起并使用它。但我很困惑选择哪个函数，即使两者具有相同的名称&我应该覆盖还是不覆盖？真的很困惑该怎么办。有什么帮助吗？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T19:41:35.070

第二个是旧版本的库，您仍然可以在当前版本中指定您想要的滑动模式，如下所示：

```
 SlidingMenu menu = new SlidingMenu(this);
 menu.setMode(SlidingMenu.LEFT); 
```

这会将其设置为左侧滑动菜单，但是您也可以指定`SlidingMenu.RIGHT`右侧或`SlidingMenu.LEFT_RIGHT`两者。

所以只需使用[当前版本](https://github.com/jfeinstein10/SlidingMenu)。

# python - 如何为 Gimp Python-Fu 插件定义目录输入参数

> ID：14965774
> 
> 赞同：2
> 
> 时间：2013-02-19T19:28:44.610
> 
> 标签：python, gimp, python-fu

我正在使用 Python-Fu 接口为 Gimp 构建一个插件，我希望用户指定一个输出目录，然后我的插件将在其中生成几个子目录并将输出文件保存在其中。为了为我的插件定义一个文件选择参数，我在下面对插件函数“register()”的调用中在一个参数定义数组中指定它。

```
register(
   ... ,
   [
    (PF_FILE, "filepath", "Output Filepath", "/Default/Path"), ...
   ]
   ...,
) 
```

我的问题是，使用上述参数类型 PF_FILE，出现的文件选择器对话框将不允许用户选择目录 - 它需要选择一个文件。如何更改此参数定义以使文件对话框允许返回目录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T09:31:34.487

您可以使用 PF_DIRNAME：

```
register(
   ... ,
   [
    (PF_DIRNAME, "source_directory", "Source Directory", ""), ...
   ]
   ...,
 ) 
```

[http://git.gnome.org/browse/gimp/tree/plug-ins/pygimp/gimpfu.py](http://git.gnome.org/browse/gimp/tree/plug-ins/pygimp/gimpfu.py)

# xml - XSL 到 XML 删除 {} 之间的数据

> ID：14965779
> 
> 赞同：2
> 
> 时间：2013-02-19T19:28:52.830
> 
> 标签：xml, xslt

我正在使用 XSLTproc 处理 XSL+XML-> HTML

在此过程中删除某些信息时遇到问题。

XSL：

```
<div item="{id}"> 
```

正在变成：

HTML：

```
<div item=""> 
```

我需要的结果是：

HTML：

```
<div item="{id}"> 
```

任何想法如何解决/或防止这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:42:08.000

您在当前 XSLT 中遇到的问题是它被视为属性值模板。花括号告诉 XSLT 它是一个要评估的表达式，在您的情况下，它将被评估为**id**元素的值，如果它不存在，它将是空白的。

要从字面上输出`<div item="{id}">`，您可以执行以下任一操作：

```
<div item="{'{id}'}">
</div> 
```

或者：

```
<div>
   <xsl:attribute name="item">{id}</xsl:attribute>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:46:39.667

您可以在 XSLT 中执行以下操作：

```
<div>
    <xsl:attribute name="item"><xsl:text>{id}</xsl:text></xsl:attribute>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:50:50.420

只需加倍`{}`：

**XSLT**

```
<div item="{{id}}"> 
```

**结果**

```
<div item="{id}"> 
```

# r - R中的ggplot图基于许多变量

> ID：14965784
> 
> 赞同：0
> 
> 时间：2013-02-19T19:29:14.140
> 
> 标签：r, ggplot2

我有两个数据集，`d1`在`d2`csv 文件中。每个数据有 6 列。我设法通过`melt`命令将它们组合起来，并在`ggplot`. 在我添加了一个额外的列之后，该列是图表所依赖的另一个变量，我无法获得所需的图表。提供数据集样本和我的代码。

使用打包**后**`melt`的数据集：`reshape`

```
initi A   B       C     D    E   L1
0.005 1 23.7      1.0  1.0  24.7 d2
0.005 2 31.2      2.0  2.1  31.2 d2
0.005 3 35.8      3.1  3.2  35.6 d2
 1    1 6.2       1.0  1.0  6.2  d1
 1    2 10.1      2.0  2.1  7.0  d1
 1    3 11.2      3.0  3.5  7.0  d1
 2    1 14.2      8.0 14.3  5.2  d1
 2    2 15.9      7.0 13.0  5.5  d1
 2    3 16.0      6.2 12.4  5.8  d1 
```

我需要`A`在`X-axis`和`B`中绘制图表`Y-axis`。该`initi`值将代表每个图表。换句话说，它将在传说中。对于`d1`，我需要在`A`和之间绘制结果`B`。因为`d2`我想绘制两个图，其中第一个图是`initi = 1`，第二个是`initi = 2`。和的所有图形都在`d1`和`d2`之间`A`，`B`并在图形中组合。在这种情况下，总共 3 条线组合在一张图中。在添加列之前`d1`，我设法绘制了图表。现在我在挣扎。下面是我的代码：`d2``initi`

```
 dlist <- list(d1 =data1 ,d2 = data2) 
 reshaped_data <- melt(dlist, id.vars = c('initi','A','B','C','D','E')) 
 graph_AB<-ggplot(reshaped_data,aes(x = A, y = B, colour = initi)) +  
     geom_point(size = 5)+
     geom_line() +
     ggtitle("DATA1 vs DATA2") 
```

上面的代码接近我想要的......除了线路以奇怪的方式连接。我应该将“initi”的每个模式作为一行。加上图例没有显示“init”的每个值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:28:45.560

```
dlist <- list(d1 =data1 ,d2 = data2) 
reshaped_data <- melt(dlist, id.vars = c('initi','A','B','C','D','E')) 
graph_AB<-ggplot(reshaped_data,aes(x = A, y = B, colour = initi)) +  
geom_point(size = 5)+
ggtitle("DATA1 vs DATA2") 
print(graph_AB) 
```

我刚刚从原始问题中删除了 geom_line ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:41:05.957

你说你想要两张图，一张是什么时候`initi`是 1，另一个是什么时候是 2，但它的值也是 0.005。如果要省略`0.005`级别，则需要先对数据进行子集化。

在 ggplot2 中，多个图被称为“构面”，由于你的构面依赖于一个变量，你想要的命令是`facet_wrap()`. （`facet_grid`如果你的方面取决于 2 个变量，你会使用。）方面应该是因素，所以我们会确保`initi`是一个因素

```
reshaped_data$initi <- factor(reshaped_data$initi) 
```

然后只需添加`+ facet_wrap(~ initi)`到您的 ggplot 中。

编辑：如果您只想要一张图表，请尝试

```
graph_AB<-ggplot(reshaped_data,aes(x = A, y = B, colour = initi, group = L1)) +  
    geom_point(size = 5)+
    geom_line() +
    ggtitle("DATA1 vs DATA2")

graph_AB 
```

将来，使用`dput`. 例如，如果您这样做`dput(reshaped_data)`并将其粘贴到您的问题中，输出将是这样的：

```
 structure(list(initi = c(0.005, 0.005, 0.005, 1, 1, 1, 2, 2, 
2), A = c(1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 3L), B = c(23.7, 31.2, 
35.8, 6.2, 10.1, 11.2, 14.2, 15.9, 16), C = c(1, 2, 3.1, 1, 2, 
3, 8, 7, 6.2), D = c(1, 2.1, 3.2, 1, 2.1, 3.5, 14.3, 13, 12.4
), E = c(24.7, 31.2, 35.6, 6.2, 7, 7, 5.2, 5.5, 5.8), L1 = structure(c(2L, 
2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L), .Label = c("d1", "d2"), class = "factor")), .Names = c("initi", 
"A", "B", "C", "D", "E", "L1"), class = "data.frame", row.names = c(NA, 
-9L)) 
```

任何人都可以粘贴到 R 中并轻松使用。

# parsing - StepNode 实例没有参数

> ID：14965785
> 
> 赞同：0
> 
> 时间：2013-02-19T19:29:14.510
> 
> 标签：parsing, hook, behat

我正在编写一个要在执行每个步骤之前运行的钩子。钩子函数基本上操作给步骤的参数。

这是我正在使用的代码（最后两行用于测试）：

```
/** @BeforeStep */
public function beforeStep($event) {
    $step_node = $event->getStep();
    $args = $step_node->getArguments();
    print_r($args);
    die();
} 
```

*   `$step_node`是一个实例[`StepNode`](http://docs.behat.org/gherkin-api/behat/gherkin/node/stepnode.html)
*   `$args`应该是与该步骤相关的一系列参数。

对于我测试的任何给定步骤，参数数组始终为空。我还尝试使用钩子打印出参数`AfterStep`，但数组仍然是空的。

我是否遗漏了一些关于 behat 如何抓住论点和处理步骤的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T21:37:28.130

getArguments() 返回一个 Behat\Gherkin\Node\TableNode 数组，允许访问表行。例如 ：

```
Given the following users:
  | name          | followers |
  | everzet       | 147       |
  | avalanche123  | 142       |
  | kriswallsmith | 274       |
  | fabpot        | 962       | 
```

[您可以尝试解析来自 step_node.getText() 的参数，但使用transformation](http://docs.behat.org/guides/2.definitions.html#step-argument-transformations "Behat Mink 文档")可能会更好。这将允许您在运行该步骤之前处理任何参数。

Behat Mink 文档中的一个示例：

```
/**
 * @Transform /^user (.*)$/
 */
public function castUsernameToUser($username)
{
    return new User($username);
} 
```

# javascript - 使用带有 UTF-16 属性名称的 javascript 对象

> ID：14965787
> 
> 赞同：0
> 
> 时间：2013-02-19T19:29:23.810
> 
> 标签：javascript, c++, ajax, utf-8, yajl

我正在调用一个返回 UTF-16 json 数据的服务。我的问题是，如果 JSON 对象具有 UTF-16 字符串作为属性名称，是否有一种简单的方法来引用这些属性？

例如，下面是调用 JSON.stringify 后响应数据的样子：

```
"{"C\u0000o\u0000n\u0000t\u0000e\u0000n\u0000t\u0000s\u0000":{ ... 
```

在我的代码中，我想做类似`data['Contents']`. 有没有一种简单的方法可以避免使用 unicode 转义序列对字符串进行硬编码？

更新：更改为指示字符串为 UTF-16。

这是生成 JSON 输出的调用示例 (Visual C++)：

```
wchar_t* str = _T("Contents");
yajl_gen_string(g, (unsigned char*)str, wcslen(str) * sizeof(TCHAR)); 
```

# java - 我应该使用 Java 中的哪种数据结构来以有序形式存储键值对？没有重复

> ID：14965788
> 
> 赞同：0
> 
> 时间：2013-02-19T19:29:33.110
> 
> 标签：java, data-structures, key-value

我正在做一个项目，我需要以有序的方式存储键值对（一对一映射）。然后我应该能够使用值和使用键的值来检索键。我查看了 Maps、Sets 和 Hash Tables，但它们没有被排序。

此外，虽然微不足道，但如果我们可以 DS 一次检索键和值，那就太好了，即接口支持这样的功能。

编辑：键和值都是唯一的。保持插入的顺序就足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:39:57.760

请注意，您没有定义什么是“有序的”。A[`LinkedHashMap`](http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashMap.html)允许以插入顺序迭代键（以及值）。相反，a[`TreeMap`](http://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html)允许您使用比较器指定排序顺序，并确保添加到地图的所有项目都按排序顺序存储。100 次中有 99 次，这些课程之一应该是你所需要的。或者，Google 的[Guava](http://code.google.com/p/guava-libraries/)项目有几个非常好的[BiMap](http://code.google.com/p/guava-libraries/wiki/NewCollectionTypesExplained#BiMap)实现，您可能会发现它们适合您的需要。

**我强烈警告你：如果你认为你需要的比这些类所能提供的更多，你很可能过度设计你的问题。**

* * *

由于我无法完全证明的原因，我`UniqueOrderedBiMap`为您实现了一个合适的，它与 Java Collections 框架兼容，并且所有实现的功能都可以高效运行。您可以使用您认为合适的任何底层映射（包括无序映射，如果您真的想要的话），并且键和值始终是唯一的。请注意，它是一个*非常*薄的 a 包装器`LinkedHashMap`，因为这就是您所需要的， a`LinkedHashMap`带有额外的检查以确保 Values 保持唯一。

对于好奇的人，请检查这个答案的修订历史，`UniqueOrderedMap`其中缺少`getKey()`和`removeKey()`方法，但更正确地实现了`Map`接口，并且只需要一个 HashSet 而不是 HashMap 来存储已知值。

```
import java.util.Collection;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.Map;
import java.util.Set;
import java.util.TreeMap;

public class UniqueOrderedBiMap<K, V>implements Map<K, V> {
    private Map<K, V> orderedMap;
    private HashMap<V, K> valueMap;

    public UniqueOrderedBiMap() {
        this(new LinkedHashMap<K,V>());
    }

    public UniqueOrderedBiMap(Map<K, V> underlyingMap) {
        orderedMap = underlyingMap;
        valueMap = new HashMap<V, K>(orderedMap.size());

        for(Map.Entry<K, V> e : orderedMap.entrySet()) {
            if(!valueMap.containsKey(e.getValue())) { // Duplicate value
                // could instead fail softly by removing the associated item from the map, but this seems cleaner/clearer.
                // generally this constructor should be passed an empty map anyways
                throw new IllegalArgumentException("Duplicate value "+e.getValue()+" found in underlying map.");
            }
            valueMap.put(e.getValue(), e.getKey());
        }
    }

    @Override
    public int size() {
        return orderedMap.size();
    }

    @Override
    public boolean isEmpty() {
        return orderedMap.isEmpty();
    }

    @Override
    public boolean containsKey(Object key) {
        return orderedMap.containsKey(key);
    }

    @Override
    public boolean containsValue(Object value) {
        // more efficient than iterating over the map
        return valueMap.containsKey(value);
    }

    @Override
    public V get(Object key) {
        return orderedMap.get(key);
    }

    public K getKey(V value) {
        return valueMap.get(value);
    }

    // Likely want to implement a forcePut(K, V) method like Guava's BiMaps do
    @Override
    public V put(K key, V value) {
        if(valueMap.containsKey(value)) {
            throw new IllegalArgumentException("Cannot insert non-unique value "+value);
        }
        V ret = orderedMap.put(key, value);
        valueMap.remove(ret);
        valueMap.put(value, key);
        return ret;
    }

    @Override
    public V remove(Object key) {
        V ret = orderedMap.remove(key);
        valueMap.remove(ret);
        return ret;
    }

    public K removeKey(V value) {
        K ret = valueMap.remove(value);
        orderedMap.remove(ret);
        return ret;
    }

    @Override
    public void putAll(Map<? extends K, ? extends V> m) {
        // Existing Map implementation's putAll have some optimizations we
        // could take advantage of, but this isn't unreasonable for a first pass
        for(Entry<? extends K, ? extends V> e : m.entrySet()) {
            put(e.getKey(), e.getValue());
        }
    }

    @Override
    public void clear() {
        orderedMap.clear();
        valueMap.clear();
    }

    @Override
    public Set<K> keySet() {
        return orderedMap.keySet();
    }

    @Override
    public Collection<V> values() {
        return orderedMap.values();
    }

    @Override
    public Set<java.util.Map.Entry<K, V>> entrySet() {
        return orderedMap.entrySet();
    }

    @Override
    public boolean equals(Object o) {
        if(o instanceof UniqueOrderedBiMap) {
            UniqueOrderedBiMap<?,?> map = (UniqueOrderedBiMap<?,?>)o;
            return orderedMap.equals(map.orderedMap); 
        }
        return false;
    }

    @Override
    public int hashCode() {
        return orderedMap.hashCode();
    }

    @Override public String toString() {
        return orderedMap.toString();
    }

    public static void main(String[] args) {
        String[] names = { "Marcus", "Jim", "Tom", "Sam" };
        String[] grades = { "A", "B", "D", "F" };

        UniqueOrderedBiMap<String,String> insertionMap = new UniqueOrderedBiMap<>();
        UniqueOrderedBiMap<String,String> sortedMap = new UniqueOrderedBiMap<>(new TreeMap<String,String>());

        for(int i = 0; i < names.length; i++) {
            insertionMap.put(names[i], grades[i]);
            sortedMap.put(names[i], grades[i]);
        }

        // Poor man's assert
        System.out.println(insertionMap.toString().equals("{Marcus=A, Jim=B, Tom=D, Sam=F}"));
        System.out.println(sortedMap.toString().equals("{Jim=B, Marcus=A, Sam=F, Tom=D}"));

        insertionMap.put("Tom", "C");
        sortedMap.put("Tom", "C");
        System.out.println(insertionMap.toString().equals("{Marcus=A, Jim=B, Tom=C, Sam=F}"));
        System.out.println(sortedMap.toString().equals("{Jim=B, Marcus=A, Sam=F, Tom=C}"));

        try {
            insertionMap.put("Sam", "C");
        } catch (IllegalArgumentException e) {
            System.out.println(e.getMessage());
        }
        try {
            sortedMap.put("Sam", "C");
        } catch (IllegalArgumentException e) {
            System.out.println(e.getMessage());
        }

        insertionMap.remove("Tom");
        sortedMap.remove("Tom");
        insertionMap.put("Sam", "C");
        sortedMap.put("Sam", "C");
        System.out.println(insertionMap.toString().equals("{Marcus=A, Jim=B, Sam=C}"));
        System.out.println(sortedMap.toString().equals("{Jim=B, Marcus=A, Sam=C}"));

        insertionMap.removeKey("A");
        sortedMap.removeKey("A");
        System.out.println(insertionMap.toString().equals("{Jim=B, Sam=C}"));
        System.out.println(sortedMap.toString().equals("{Jim=B, Sam=C}"));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:42:47.523

如果您可以使用第三方库，请考虑使用[`ImmutableBiMap`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/index.html?com/google/common/collect/ImmutableBiMap.html). 它是一个 Guava Collection 类，提供

1.  用户指定的迭代顺序
2.  从键到值的法线映射和从值到键的逆映射

一个考虑因素是，一旦创建地图，地图就是不可变的，无法修改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:33:03.803

[LinkedHashMap](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedHashMap.html)应该适合你。阅读链接

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T19:33:15.960

您将需要两个`LinkedHashMap`. 您可以创建内部使用两个`LinkedHashMap`. 一种用于将键映射到值，另一种用于将值映射到键。

# jquery - 使用 JQuery/AJAX 使用 XML 文件填充下拉菜单。

> ID：14965790
> 
> 赞同：1
> 
> 时间：2013-02-19T19:29:32.660
> 
> 标签：jquery, html, xml, ajax

我有一个需要从 XML 文件填充的下拉菜单。这是我尝试使用的脚本：

```
 $(document).ready(function(){       // load jQuery 1.5
  function loadfail(){
  alert("Error: Failed to read file!");
 }

 function parse(document){
 $(document).find("menuItem").each(function(){
    var optionLabel = $(this).find('text').text();
    var optionValue = $(this).find('value').text();
    $('.opening').append(
   '<option value="'+ optionValue + '">' + optionLabel + '</option>'
    );
 });
 }

 $.ajax({
  url: 'http://ourwebserver/Online%20App/jobTitles.xml',    // name of file with our data - link has been renamed
  dataType: 'xml',    // type of file we will be reading
  success: parse,     // name of function to call when done reading file
  error: loadfail     // name of function to call when failed to read
 });
}); 
```

以下是 xml 文件中的示例：

```
<menu>
<menuItem>
    <value>612</value>
    <text>CLERK-CMH HOS HIM</text>
</menuItem>
<menuItem>
    <value>1632</value>
    <text>FAM PRACT-CMH CLN Southside Medical</text>
</menuItem> 
```

这是包含我要填充的下拉列表的 html 代码：

```
 <strong>Position(s) Desired</strong>
             <select name="opening" size="5" multiple="multiple" id="opening">
      </select> 
```

我没有收到错误消息，但也没有在菜单中填充任何数据。

我还尝试了此链接上的代码/解决方案： [使用 xml 文件填充下拉菜单](https://stackoverflow.com/questions/3485359/populating-a-drop-down-menu-with-xml-file) 并得到类似的结果，没有错误，但没有数据。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:07:05.397

jQuery 文档是你最好的朋友，[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:34:40.593

我认为您在成功回调中调用了错误的函数。

`success: parse,`

应该是这样的。

`success: function(){parse(data);},`

但我可能是错的，因为我在这里没有太多经验。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:37:52.497

检查`document`您的解析中实际设置的内容。它可能与 HTML 冲突`document`。

```
function parse(document){
   console.log(document)
   $(document).find("menuItem").each(function(){ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-19T19:59:45.887

您正在使用类选择器 ( `.opening`) 而不是 ID ( `#opening`) 来查找`<select>`元素。`$('#opening')`在您的函数中使用`parse`应该可以按预期工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-22T09:17:50.043

```
 <!DOCTYPE html>
  <html xmlns="http://www.w3.org/1999/xhtml">
 <head>
<title></title>
<style>
    body
    {
        width: 610px;
        font-family: calibri;
    }

    .frmDronpDown
    {
        border: 1px solid #7ddaff;
        background-color: #C8EEFD;
        margin: 2px 0px;
        padding: 40px;
        border-radius: 4px;
    }

    .demoInputBox
    {
        padding: 10px;
        border: #bdbdbd 1px solid;
        border-radius: 4px;
        background-color: #FFF;
        width: 50%;
    }

    .row
    {
        padding-bottom: 15px;
    }
</style>

<!--  <script src="jquery-3.2.1.min.js" type="text/javascript"></script>-->
<script type="text/javascript" 
    src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $("#divEnvironment").hide();
        $("#divService").hide();
        $("#divButton").hide();
        getDropDownValue(document.getElementById('sor-list'), '', 'sorid', 
         '');
    });

    function getEnvironment(val) {
        if (val != 0) {
            $("#divEnvironment").show();
            $("#divService").hide();
            $("#divButton").hide();
        }
        else {
            $("#divEnvironment").hide();
            $("#divService").hide();
            $("#divButton").hide();
        }
        $('#environment-list option').remove();
        $('#service-list option').remove();
        $('#service-list').append("<option class='ddindent' value='0'>Please 
       Select</option>");
        getDropDownValue(document.getElementById('environment-list'), 
       'sorid', 'envid', val);
    }

    function getService(val) {
        if (val != 0) {
            $("#divEnvironment").show();
            $("#divService").show();
            $("#divButton").hide();
        }
        else {
            $("#divService").hide();
            $("#divButton").hide();
        }
        $('#service-list option').remove();
        getDropDownValue(document.getElementById('service-list'), 'envid', 
        'servid', val);
    }

    function getSubmit(val) {
        if (val != 0) {
            $("#divButton").show();
        }
        else {
            $("#divButton").hide();
        }
    }
    function getDropDownValue(dropdown, id1, id2, val) {
        $.ajax({
            type: "GET",
            url: "make.xml",
            dataType: "xml",
            success: function (xml) {
                var selectCity = $('#' + dropdown.id);
                selectCity.append("<option class='ddindent' value='0'>Please 
            Select</option>");
                $(xml).find('dropdown').each(function () {
                    $(this).find(dropdown.name).each(function () {
                        if (val != '') {
                            if ($(this).attr(id1) == val) {
                                var value = $(this).attr(id2);
                                var label = $(this).text();
                                selectCity.append("<option class='ddindent' 
         value='" + value + "'>" + label + "</option>");
                            }
                        }
                        else {
                            var value = $(this).attr(id2);
                            var label = $(this).text();
                            selectCity.append("<option class='ddindent' 
        value='" + value + "'>" + label + "</option>");
                        }
                    });
                });
            } //sucess close
        });
    }

</script>
  </head>
 <body>
<div class="frmDronpDown">
    <div class="row">
        <label>SOR:</label><br />
        <select name="sor"
            id="sor-list" class="demoInputBox"
            onchange="getEnvironment(this.value);">
        </select>
    </div>
    <div class="row" id="divEnvironment">
        <label>Environment:</label><br />
        <select name="environment"
            id="environment-list" class="demoInputBox"
            onchange="getService(this.value);">
            <option value="">Select Enviroment</option>
        </select>
    </div>
    <div class="row" id="divService">
        <label>Service:</label><br />
        <select name="service" multiple
            id="service-list" class="demoInputBox" 
       onchange="getSubmit(this.value);">
            <option value="">Select Service</option>
        </select>
    </div>
    <div class="row" id="divButton">
        <label></label>
        <br />
        <button type="button" id="btnSubmit" style="padding: 10px; width: 
       100px;">Submit</button>
    </div>
  </div>
 </body>
 </html>      

 <dropdown>
  <sor sorid="1">sor1</sor>
  <sor sorid="2">sor2</sor>
  <environment envid="1" sorid="1">environment1</environment>
  <environment envid="2" sorid="1">environment2</environment>
  <environment envid="3" sorid="2">environment3</environment>
  <environment envid="4" sorid="2">environment4</environment>
  <service servid="11" envid="1">service11</service>
  <service servid="12" envid="1">service12</service>
  <service servid="21" envid="2">service21</service>
  <service servid="22" envid="3">service22</service>
  </dropdown> 
```

# c# - 从基类继承时的引用规则

> ID：14965793
> 
> 赞同：6
> 
> 时间：2013-02-19T19:29:43.777
> 
> 标签：c#

假设项目 A 是一个 C# 类库，而项目 B 是一个依赖于项目 A 的控制台应用程序。

在项目 A 中定义了以下类：

```
public class ActionMailNotifier : RazorMailerBase
{
        private readonly string _viewPath;
        private readonly EmailHost _emailConfig;
                   ...
                   ...
} 
```

“RazorMailBase”包含在项目 A 引用的外部 dll、ActionMailer.dll 中。

在项目 B 中定义了以下类：

```
public class EmailFareMonitorAlertNotifier : ActionMailNotifier
{
                        ...
                        ...
} 
```

如果项目 B 中未引用 ActionMailer.dll，编译器会生成一条错误消息，指示需要对 ActionMailer.dll 的引用。有没有办法构建这个结构，以便在项目 B 中不需要对外部 dll 的引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:32:21.533

不，只要`EmailFareMonitorAlertNotifier`最终派生自程序集`external.dll`，您就需要引用它，以便编译器和运行时拥有使用该类型所需的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:32:32.543

不会。如果您要删除对 Project B 中引用 ActionMailer.dll 的任何类型的所有引用，您将不会看到任何错误。但由于`RazorMailBase`是在 ActionMailer.dll 中定义的，因此您必须拥有该引用才能使用`ActionMailNotifier`，或从外部库中的类派生的任何其他类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T19:34:54.153

作为绝对最低限度，项目 B 必须引用其自身类型的继承层次结构中存在的所有程序集`EmailFareMonitorAlertNotifier`，所以我猜答案是否定的。

# c# - WPF DataBinding 不更新？

> ID：14965796
> 
> 赞同：19
> 
> 时间：2013-02-19T19:30:03.703
> 
> 标签：c#, wpf, data-binding

我有一个项目，我在其中将复选框的 IsChecked 属性与代码隐藏中的 get/set 绑定。但是，当应用程序加载时，由于某种原因，它不会更新。很感兴趣，我将其简化为基础，如下所示：

```
//using statements
namespace NS
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        private bool _test;
        public bool Test
        {
            get { Console.WriteLine("Accessed!"); return _test; }
            set { Console.WriteLine("Changed!"); _test = value; }
        }
        public MainWindow()
        {
            InitializeComponent();
            Test = true;
        }
    }
} 
```

XAML：

```
<Window x:Class="TheTestingProject_WPF_.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525" DataContext="{Binding RelativeSource={RelativeSource Self}}">
<Grid>
    <Viewbox>
        <CheckBox IsChecked="{Binding Path=Test, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    </Viewbox>
</Grid> 
```

而且，你瞧，当我将它设置为 true 时，它​​并没有更新！

任何人都可以提出解决方案，或解释原因？

谢谢，不胜感激。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-19T19:37:11.393

为了支持数据绑定，你的数据对象必须实现[`INotifyPropertyChanged`](http://wpftutorial.net/INotifyPropertyChanged.html)

[此外，将数据与演示文稿分开](https://stackoverflow.com/questions/14381402/wpf-programming-methodology/14382137#14382137)总是一个好主意

```
public class ViewModel: INotifyPropertyChanged
{
    private bool _test;
    public bool Test
    {  get { return _test; }
       set
       {
           _test = value;
           NotifyPropertyChanged("Test");
       }
    }

    public PropertyChangedEventHandler PropertyChanged;

    public void NotifyPropertyChanged(string propertyName)
    {
         if (PropertyChanged != null)
             PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
}

<Window x:Class="TheTestingProject_WPF_.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<Grid>
    <Viewbox>
        <CheckBox IsChecked="{Binding Path=Test, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
    </Viewbox>
</Grid> 
```

代码背后：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        DataContext = new ViewModel{Test = true};
    }
} 
```

# java - 在 Java 中读取文本文件并转换为多个向量

> ID：14965801
> 
> 赞同：0
> 
> 时间：2013-02-19T19:30:18.507
> 
> 标签：java, arrays, vector

我对Java相当陌生，我正试图让它读取一个文件。

我有一个需要作为数组导入 Java 的数据文本文件。

数据文件的第一行是名称行。所有变量的名称都在第一行，数据聚集在列中。我只想将它导入 Java 并能够根据需要导出所有变量，就像它们是 MATLAB 中的向量一样。所以基本上我们获取数据并标记每个向量。我需要代码尽可能通用，因此它应该读取可变数量的列和行。我相信我能够使用一种非有效的方法来创建数组。现在我需要将数组分成多个数组，然后将它们转换为数字。但是我需要根据它们所属的向量对数字进行分组。

文本文件是从 Excel 电子表格创建的，因此它基本上具有用于不同测量的列，这将创建向量。另一个向量中的每一列包含行中的数据。

我搜索了很多试图实现的代码，但到了没有帮助的情况下我无法继续的地步。有人可以告诉我如何在任何意义上进行。甚至还可以改进阅读部分，因为我知道这不是在 Java 中这样做的最佳方式。这是我手头的东西：

```
package Testing;

import java.io.*;
import java.nio.charset.Charset;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.*;

public class Read1 {

    public static void main(String[] args) {
        try {
            FileReader fin = new FileReader("C:/jade/test/Winter_Full_clean.txt");
            BufferedReader in = new BufferedReader(fin);
            String str = "";
            int count = 0;
            String line;
            while ((line=in.readLine()) != null) {
                if (count==0) {
                    str = line;
                }
                else if (in.readLine()!=null) {
                    str = str + line;
                }
                count++;                
            }

            in.close();
            //System.out.printf(str);

            System.out.print(tokens);
       } catch (Exception e) {
          System.out.println("error crap" + e.getClass());
       }

    }

    //{

    //    Path yourFile = Paths.get("C:/jade/test/Winter_Full_clean.txt");
    //    Charset charset = Charset.forName("UTF-8");

    //    List<String> lines = null;
    //    try {
    //        lines = Files.readAllLines(yourFile, charset);
    //    } catch (IOException e) {
              // TODO Auto-generated catch block
    //        e.printStackTrace();
    //    }
    //    String[] arr = lines.toArray(new String[lines.size()]);
    //    System.out.println(arr);  
    //}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:01:25.550

我有一些功能性代码，可以将文本文件读入数组并在选项卡上拆分（它是一个 tsv 文件）。您应该能够将此作为读取初始数据的起点，然后根据数组中包含的数据，更改您的逻辑以适应：

```
 try (BufferedReader reader = new BufferedReader(new FileReader(path))) { //path is a String pointing to the file
                int lineNum = 0;
                String readLine;
                while ((readLine = reader.readLine()) != null) { //read until end of stream
                    if (lineNum == 0) { //Skip headers, i.e. start at line 2 of your excel sheet
                        lineNum++;
                        continue;
                    }
                    String[] nextLine = readLine.split("\t"); //Split on tab
                    for (int x = 0; x < nextLine.length; x++) { //do something with ALL the lines.
                        nextLine[x] = nextLine[x].replace("\'", "");
                        nextLine[x] = nextLine[x].replace("/'", "");
                        nextLine[x] = nextLine[x].replace("\"", " ");
                        nextLine[x] = nextLine[x].replace("\\xFFFD", "");
                    }
                //In this example, to access data for a certain column, 
                //call nextLine[1] for col 1, nextLine[2] for col 2 etc. 
                } //close your loop and go to the next line in your file
} //close your resources. 
```

# sql-server - 在 left(date,4) 上创建索引，这可能吗？还是有更好的方法来处理大数据？

> ID：14965808
> 
> 赞同：1
> 
> 时间：2013-02-19T19:30:47.197
> 
> 标签：sql-server, tsql, indexing

我正在接管一个带有失控表的数据库。它有 2011 年、2012 年、2013 年和未来的交易记录。

这张桌子对公司的运营至关重要。但随着 730k 条记录的增加，它越来越失控，并且随着每两周添加一次交易而增长。

我不希望更改表的现有结构，因为许多现有操作都依赖于它，到目前为止它有一个关于交易 ID 和交易日期的索引。但是查询表变得非常麻烦。

是否明智，甚至可以通过使用 left(date,4) 作为索引的一部分将它们索引到交易日期的年份？

编辑：该表未规范化（而且我看不到规范化的目的，因为每一行对于索赔号都是唯一的），并且每条记录有 168 个字段，其中包含 varchar(255) 的 5 个不同“备忘录”字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:44:21.333

其中一个选项是创建[过滤索引](http://technet.microsoft.com/en-us/library/cc280372.aspx)- 这就像根据特定条件合并一组记录。

在您的情况下，您应该创建几个索引 - 每个都过滤特定年份的记录。例如：

```
CREATE NONCLUSTERED INDEX IndexFor2013Year
    ON MyTable.BillOfMaterials (SomeDate)
    WHERE SomeDate>"2013-01-01 00:00:00" and SomeDate<"2014-01-01 00:00:00";
GO 
```

无论如何，为经常在 DML 操作（UPDATE/INSERT/DELETE）下的表创建许多索引甚至可能导致性能下降。

您应该执行一些测试并比较执行计划。

请注意，我只是举一个例子——根据你的查询到底是什么，你应该创建一个索引。有时，查看 SQL Management Studio (2012) 向我提出的查询的执行计划，究竟哪些索引可以带来更好的性能。

# backbone.js - 使用主干进行站点范围的错误管理

> ID：14965815
> 
> 赞同：0
> 
> 时间：2013-02-19T19:31:14.437
> 
> 标签：backbone.js, error-handling

## 问题

我想在我的应用程序中有一个默认错误处理程序来处理所有意外错误，但有时（例如在保存模型时）可能会出现许多错误，所以我想以自定义方式处理它们而不是显示通用错误页面。

## 我之前的解决方案

我的`Backbone.sync`功能曾经有这个：

```
if(options.error)
  options.error(response)
else
  app.vent.trigger('api:error', response) # This is the global event channel 
```

但是，这不再有效，因为主干总是包装错误函数，因此它可以触发`error`模型上的事件。

## 新解决方案 1

我可以覆盖模型和集合上的`fetch`and方法来包装并在上面放置代码，但这感觉有点难看。`save``options.error`

## 新解决方案 2

听`error`模型，但这不会让我覆盖默认的错误处理程序。

## 新解决方案 3

传入一个自定义选项来禁用错误的全局触发，但这感觉是多余的。

* * *

我错过了什么吗？有推荐的方法吗？

* * *

我可以补充一点，我使用的是他们 git repo 中的最新版本，而不是他们主页上的最新版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:45:42.087

您可以在覆盖的同步中执行此操作吗？这似乎完成了与您之前所做的相同的事情。

```
// error is the error callback you passed to fetch, save, etc.
var error = options.error;
options.error = function(xhr) {
  if (error) error(model, xhr, options);
  // added line below.
  // no error callback passed into sync.
  else app.vent.trigger('api:error', xhr); 

  model.trigger('error', model, xhr, options);
}; 
```

这段代码来自 Backbone 源代码，我只添加了这一`else`行。

编辑：

这不是最漂亮的解决方案，但可能对您有用。创建一个新的模型基类来使用，而不是扩展 Backbone.Model，扩展它。

```
var Model = Backbone.Model.extend({

  // override fetch. Do something similar for save, destroy.
  fetch: function(options){
     options = options ? _.clone(options) : {};
     var error = options.error;
     options.error = function(model, resp) {
       if (error) error(model, resp);
       else app.vent.trigger('api:error', resp); 
     };

     return Backbone.Model.prototype.fetch.apply(this, [options]);
  },
});

var MyModel = Model.extend({});
var model = new MyModel();
model.fetch(); // error will trigger 'api:error' 
```

实际上，这可能比覆盖更好`sync`。

可能的替代方法是使用这个：[http](http://api.jquery.com/ajaxError/) ://api.jquery.com/ajaxError/ 。但是这样一来，无论您是否将错误回调传递给主干获取/保存/销毁，您都会收到错误消息。

# virtualenv - 监视与 virtualenv 一起使用

> ID：14965817
> 
> 赞同：0
> 
> 时间：2013-02-19T19:31:28.863
> 
> 标签：virtualenv, monit

我想使用monit监控django服务器。但是，它不会让我运行“python manage.py runserver”，因为它是特定于我使用的 virtualenv 的环境。

所以我想做..

```
workon myvirtualenv 
```

然后运行

```
python manage.py runserver 
```

但是我能做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T15:32:30.800

您可以将命令串在一起作为启动命令吗？

```
"workon myvirtualenv && python manage.py runserver" 
```

# c# - 为什么没有办法在 C# 中约束构造函数的签名？

> ID：14965819
> 
> 赞同：0
> 
> 时间：2013-02-19T19:31:32.427
> 
> 标签：c#, constructor

这个问题看起来很奇怪，但我们确实有需要修复构造函数签名的情况。

例如，我希望它用于在 DI 中解析依赖项。如果构造函数被扩展并且需要更多参数，其中一些非常依赖于上下文，我就有麻烦了。
如果 DI 容器无法解决依赖关系，肯定会抛出异常，但这不是我认为的最佳方式。

我只是重构我们的应用程序并了解最初计划成为 DI 的良好候选者的东西现在由于故意的构造函数扩展而被破坏，而没有了解后果。阻止它的唯一方法就是开发人员之间的约定。
语言支持会很有帮助，但 C# 和 Java 都没有。

所以我认为这个功能没有实现应该有一些原因......为什么？

这是我们工厂的样子：

```
public class EntityBase : IEntity
{
   public EntityBase(IBusinessModel model, IAppContext context)
   {
   }
}

public class DescendatnEntity : EntityBase, IDescendatnEntity
{
   public DescendatnEntity(IBusinessModel model, IAppContext context, ...additional params...)
   {
   }
}

public interface IEntitiesFactory
{
     IEntity GetBaseEntity();
     IDescendantEntity GetDescendantEntity(...those additional params...); 
} 
```

`IBusinessModel`和`IAppContext`单例，而附加参数是瞬态的。

如果只有调用者知道瞬态参数的值，工厂就不需要知道这些参数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:17:17.137

You could use constructor chaining to provide your default implementation.

```
public class DescendantEntity : EntityBase, IDescendatnEntity
{

   public DescendantEntity(IBusinessModel model, IAppContext context, ...additional params...)
   {
   }
   public DescendantEntity(IBusinessModel model, IAppContext context)
       this(model, context, ...additional params defaults...)
   {
   }
} 
```

# javascript - jQuery在动画后更新元素的css高度

> ID：14965825
> 
> 赞同：0
> 
> 时间：2013-02-19T19:31:42.637
> 
> 标签：javascript, jquery, html, css

这是我正在研究的小提琴：http: [//jsfiddle.net/fFYqF/](http://jsfiddle.net/fFYqF/)

基本上它是一个在它们之间有一些隐藏段落的上面`h1`。`h2`这一切都包含在一个 div 中，我试图使它在视觉上居中（在屏幕上水平和垂直。我在容器 div 上使用了这个 css 来将其在页面上居中：

```
div#holder {
    position: absolute;
    top:0;
    bottom: 0;
    left: 0;
    right: 0;
    margin: auto;
    height:40%;
    width:60%;
    min-width:300px;
} 
```

为此，必须指定 div 的宽度和高度。我有 2 个问题...首先，我不知道 div 的高度，所以我尝试使用 jQuery 动态应用它：

```
var h = $('#holder').height();
$('#main').css('height', h + 'px'); 
```

其次，我还有一点 jQuery 来为打开的文本段落设置动画。这会改变持有人 div 的高度，从而使先前计算的高度不正确，并且 div 不再垂直居中。

有没有办法让持有人 div 始终居中在页面上？即它应该在打开时向上移动。

请参阅上面的小提琴以了解我的意思。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:42:43.130

您是否尝试过 .animate 方法？我没有像您描述的那样在垂直居中的情况下对此进行测试，但是当我将其他元素带入视野时，我已经使用这种方法来增加容器的高度。

```
$('#main').animate({height: '+='h }, 'slow'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T20:23:24.597

我已经更新了[你的小提琴的一个分支，](http://jsfiddle.net/jagzviruz/fFYqF/4/)以混合使用`.animate()`元素的高度和顶部位置，使其看起来像它的开放。

# mongodb - MongoDB - 具有聚合的地理空间索引

> ID：14965826
> 
> 赞同：2
> 
> 时间：2013-02-19T19:31:42.953
> 
> 标签：mongodb, aggregation-framework, geospatial

我从 to docs 中读到无法在 MongoDB 的聚合上使用地理空间索引。有没有替代方案？我正在尝试运行查询以获取特定半径内的所有活动，然后按活动发生的次数对它们进行分组/排序。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:51:21.647

您可以在地理查询上使用 map-reduce。这是一个基于 geo_mapreduce.js 的示例（来自 mongodb jstests）：

```
// setup test collection
var act_date = new Date(2010,06,07);
for (i = 1; i <= 10; i++) {
    db.activity.insert( { "geo" : { "lat" : 32.68331909, "long" : 69.41610718 }, "date":act_date, "activity" : 9 * i } );
    db.activity.insert( { "geo" : { "lat" : 35.01860809, "long" : 70.92027283 }, "date":act_date, "activity" : 3 } );
    db.activity.insert( { "geo" : { "lat" : 31.11639023, "long" : 64.19970703 }, "date":act_date, "activity" : 11 } );
    db.activity.insert( { "geo" : { "lat" : 32.64500046, "long" : 69.36251068 }, "date":act_date, "activity" : 9 } );
    db.activity.insert( { "geo" : { "lat" : 33.23638916, "long" : 69.81360626 }, "date":act_date, "activity" : 22 } );
    act_date.setDate(act_date.getDate() + 1);
}

db.activity.ensureIndex( { "geo" : "2d" } );
center = [ 32.68, 69.41 ];
radius = 10 / 111; // 10km; 1 arcdegree ~= 111km
geo_query = { geo : { '$within' : { '$center' : [ center, radius ] } } };

// map function
m = function() {
    emit( this.date, { "activity" : this.activity } );
};

// reduce function
r = function(key, values) {
    var total = 0;
    for ( var i = 0; i < values.length; i++ ) {
        total += values[i].activity;
    }
    return {"activity":total };
};

// mapreduce with geo query 
res = db.activity.mapReduce( m, r, { out : { inline : 1 }, query : geo_query } );
// sort results
res.results.sort(function(a, b){return b.value.activity - a.value.activity})
for (var i=0; i < res.results.length; i++) {
    print("Date: " + res.results[i]._id + " Activity: " 
                       + res.results[i].value.activity)
} 
```

# entity-framework - EF 代码首先为一个导航属性指定关系表

> ID：14965829
> 
> 赞同：0
> 
> 时间：2013-02-19T19:31:47.310
> 
> 标签：entity-framework, entity-framework-4, ef-code-first

我首先是 EF 代码的新手，并试图强制 ICollection 导航属性使用我手动创建的特定关系表来映射实体。

我被迫这样做的原因是我的所有表上都有一个 TenantId 列。这有可能吗？

```
[Table("Tenants")]
public class Tenant
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }

    // This should use ContactAddressesForTenants table
    public virtual ICollection<Address> ContactAddresses {get; set;}

}

[Table("BusinessProfiles")]
public class BusinessProfile
{
    [Key, ForeignKey("Tenant")]
    public int TenantId { get; set; }

    public virtual Tenant Tenant { get; set; }

    // This should use the AddressesForBusinessProfiles table
    public virtual ICollection<Address> ProfileAddresses { get; set; }
}

[Table("Addresses")]
public class Address
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }

    [ForeignKey("Tenant")]
    public int TenantId { get; set; }
}

[Table("ContactAddressesForTenants")]
public class ContactAddressForTenant
{
    [ForeignKey("Tenant")]
    public int TenantId { get; set; }

    [ForeignKey("Address")]
    public int AddressId { get; set; }

    public virtual Tenant Tenant { get; set; }

    public virtual Address Address {get; set;}
}

[Table("AddressesForBusinessProfiles")]
public class AddressForBusinessProfile
{
    [ForeignKey("BusinessProfile")]
    public int TenantId { get; set; }

    [ForeignKey("Address")]
    public int AddressId { get; set; }

    public virtual BusinessProfile BusinessProfile { get; set; }

    public virtual Address Address { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:30:40.697

如果我理解正确的话。您可以尝试在模型中更改它。

在哪儿：

```
// This should use ContactAddressesForTenants table
public virtual ICollection<Address> ContactAddresses {get; set;}
// This should use the AddressesForBusinessProfiles table
public virtual ICollection<Address> ProfileAddresses { get; set; } 
```

改成：

```
public virtual ICollection<ContactAddressForTenant> ContactAddresses {get; set;}
public virtual ICollection<AddressForBusinessProfile> ProfileAddresses { get; set; } 
```

# iphone - XCode iOS 模拟器 - 应用程序像素化

> ID：14965830
> 
> 赞同：0
> 
> 时间：2013-02-19T19:31:56.080
> 
> 标签：iphone, ios, xcode

我是 XCode 的初学者，我遇到了一个问题。当我构建我的应用程序时，它在标准 iPhone 模拟器中看起来不错，但是当我将硬件更改为视网膜设备时，我的应用程序的 UI 元素变得像素化。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:34:16.120

您会看到这一点，因为视网膜屏幕正在将您提供的图像拉伸到屏幕上的更多点。`@2x`您可以通过附加到文件名来在捆绑包中提供高分辨率图像

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html)：“如果从名称包含@2x 修饰符的文件中加载图像，则会设置比例到 2.0。您还可以在从 Core Graphics 图像初始化图像时指定显式比例因子。假设所有其他图像的比例因子为 1.0。"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T19:40:17.930

这是[支持高分辨率屏幕的指南](http://developer.apple.com/library/ios/#documentation/2DDrawing/Conceptual/DrawingPrintingiOS/SupportingHiResScreensInViews/SupportingHiResScreensInViews.html#//apple_ref/doc/uid/TP40010156-CH15-SW1)。

正如@RobotWoods 提到的，您的应用程序中的所有图像都需要有`@2x`版本。

如果您使用的是 OpenGL ES、创建图像的自定义代码或核心动画，您需要确保您的代码考虑了显示器的比例。

如果您只使用标准的 UIKit 元素，如 UIButton、UILabel、UITableView 等，那么您需要做的就是提供`@2x`图像。

如果这没有帮助，请发布看起来模糊的屏幕截图和相关代码。

# android - Android 文本转语音可靠吗？

> ID：14965832
> 
> 赞同：2
> 
> 时间：2013-02-19T19:31:59.770
> 
> 标签：android, text-to-speech, voice

我是一个相当新的 Android 开发人员，正在开发一个应用程序，我希望能够说出应用程序提供的文本。我发现了几个关于在 Android 手机上使用文本到语音功能的示例，例如[这个](http://android-developers.blogspot.com/search/label/Text-to-Speech)），并且我已经能够让它们在大部分时间里工作，但是它们在 Eclipse 模拟器上并不能始终如一地工作而没有问题或者我用来测试的HTC手机。问题包括语音有时工作有时不工作，或者导致手机去谷歌播放下载“SpeechSynthesis Data Installer”的应用程序，即使手机已经展示了文本到语音的能力，即使商店说项目已安装在手机上。我赢了'

我的问题是，是否有人将文本转语音功能放在市场上或多部手机上的应用程序中，并发现它相对可靠、简单和直接，还是无论实施得多么好，它都是一个不可靠且不一致的功能？谢谢。

# http - 登录后如何读取服务器响应的内容？（HTTP相关）

> ID：14965836
> 
> 赞同：0
> 
> 时间：2013-02-19T19:32:27.843
> 
> 标签：http, post, winsock, content-length

我的目标是使用 C++/Winsock 登录 vBulletin 论坛。论坛是 forums.randi.org

为此，我一直在嗅探数据包，这是服务器对提供登录详细信息的 POST 请求的响应的标头：

```
HTTP/1.1 200 OK
Date    Tue, 19 Feb 2013 18:12:52 GMT
Server  Apache/2.0.63 (Unix) mod_ssl/2.0.63 OpenSSL/0.9.8e-fips-rhel5 mod_bwlimited/1.4 PHP/5.2.8
X-Powered-By    PHP/5.2.8
Set-Cookie  bblastvisit=1361297572; expires=Wed, 19-Feb-2014 18:12:52 GMT; path=/
Set-Cookie  bblastactivity=0; expires=Wed, 19-Feb-2014 18:12:52 GMT; path=/
Set-Cookie  bbwelcomeheaders=1361297572; path=/
Set-Cookie  bbsessionhash=9ad9da23b1399e81772437c3819a2501; path=/; HttpOnly
Cache-Control   private
Pragma  private
X-UA-Compatible IE=7
Content-Encoding    gzip
Content-Length  2152
Connection  close
Content-Type    text/html; charset=ISO-8859-1 
```

我的问题是我一直试图阅读响应的内容无济于事。如标题所示，内容的长度应为 2152 字节。我确实将 2152 个字节读入了一些缓冲区，但它们是乱码（而响应标头看起来非常好）。同时，我的嗅探器（HttpFox，一个 Firefox 插件）显示了一个完全合法的内容，但其大小远大于指示的 2152 字节（大约 5900 字节）。

成功登录后由嗅探器检索的内容如下。我想知道如何使用 winsock 读取此内容，为什么这比标题中指示的 Content-Length 长得多。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- BEGIN TEMPLATE: STANDARD_REDIRECT -->

<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en">
<head>

<!-- Tapatalk Detect Start -->
<script type="text/javascript">
var tapatalk_iphone_msg = "This forum has an app for iPhone and iPod Touch! Click OK to learn more about Tapatalk.";
var tapatalk_iphone_url = "http://itunes.apple.com/us/app/tapatalk-forum-app/id307880732?mt=8";
var tapatalk_ipad_msg = "This forum has an app for iPad! Click OK to learn more about Tapatalk.";
var tapatalk_ipad_url = "http://itunes.apple.com/us/app/tapatalk-hd-for-ipad/id481579541?mt=8";
var tapatalk_kindle_msg = "This forum has an app for Kindle Fire! Click OK to learn more about Tapatalk.";
var tapatalk_kindle_url = "http://www.amazon.com/gp/mas/dl/android?p=com.quoord.tapatalkpro.activity";
var tapatalk_android_msg = "This forum has an app for Android. Click OK to learn more about Tapatalk.";
var tapatalk_android_url = "market://details?id=com.quoord.tapatalkpro.activity";
var tapatalk_chrome_enable = true;
var tapatalkdir = "mobiquo";
</script>
<script type="text/javascript" src="http://forums.randi.org/mobiquo/tapatalkdetect.js"></script>
<!-- Tapatalk Detect End -->

<!-- BEGIN TEMPLATE: headinclude -->
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="generator" content="vBulletin 3.7.7" />

<meta name="keywords" content="randi, amazing, jref, skeptic, pigasus, debunk, critical thinking, lecture, geller, dowsing, cold reading, cottingley, weird things, paranormal, million dollar challenge, magic, faith healer, nostradamus, fraud, hoax, occult, supernatural, conjuring, uri geller, yuri, flim flam, psychics, john edward, sylvia browne, clock, van praagh,vbulletin,forum,bbs,discussion,jelsoft,bulletin board, psi, amazing meeting" />
<meta name="description" content="The JREF Forum is provided by the James Randi Educational Foundation, a non-profit educational organisation whose goals include promoting critical thinking everywhere, go to http://forums.randi.org/." />

<!-- CSS Stylesheet -->
<style type="text/css" id="vbulletin_css">
/**
* vBulletin 3.7.7 CSS
* Style: 'JREF'; Style ID: 23
*/
@import url("clientscript/vbulletin_css/style-f5050f4f-00023.css");
</style>
<link rel="stylesheet" type="text/css" href="clientscript/vbulletin_important.css?v=377" />

<!-- / CSS Stylesheet -->

<script type="text/javascript" src="http://yui.yahooapis.com/2.9.0/build/yahoo-dom-event/yahoo-dom-event.js?v=377"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.9.0/build/connection/connection-min.js?v=377"></script>
<script type="text/javascript">
<!--
var SESSIONURL = "";
var SECURITYTOKEN = "guest";
var IMGDIR_MISC = "http://forums.randi.org/helloworld2/misc";
var vb_disable_ajax = parseInt("0", 10);
// -->
</script>
<script type="text/javascript" src="clientscript/vbulletin_global.js?v=377"></script>
<script type="text/javascript" src="clientscript/vbulletin_menu.js?v=377"></script>

    <link rel="alternate" type="application/rss+xml" title="JREF Forum RSS Feed" href="external.php?type=RSS2" />

<!-- END TEMPLATE: headinclude -->
<title>JREF Forum</title>
</head>
<body>

<br />
<br />
<br />
<br />

<form action="http://forums.randi.org/forumindex.php" method="post" name="postvarform">
<div style="width: 70%; margin: 0 auto;">
<table class="tcat-rounded" cellpadding="0" cellspacing="0" border="0" width="100%" align="center">
    <tr>
        <td width="10" class="tcat-rounded-left"><img src="http://forums.randi.org/helloworld2/misc/spacer.gif" width="10" height="28" border="0" alt="" /></td>

    <td class="tcat">Redirecting...</td>
        <td width="10" class="tcat-rounded-right"><img src="http://forums.randi.org/helloworld2/misc/spacer.gif" width="10" height="28" border="0" alt="" /></td>
    </tr>
</table>
</div>
<table class="tborder" cellpadding="6" cellspacing="1" border="0" width="70%" align="center">
<tr>
    <td class="panelsurround" align="center">
    <div class="panel">

        <blockquote>
            <p>&nbsp;</p>
            <p><strong>Thank you for logging in, XXXX.</strong></p>

                <p class="smallfont"><a href="http://forums.randi.org/forumindex.php">Click here if your browser does not automatically redirect you.</a></p>
                <div>&nbsp;</div>

        </blockquote>

    </div>
    </td>
</tr>
</table>
</div>
</form>

<noscript>
<meta http-equiv="Refresh" content="2; URL=http://forums.randi.org/forumindex.php" />
</noscript>

<script type="text/javascript">
<!--
function exec_refresh()
{
    window.status = "Redirecting..." + myvar;
    myvar = myvar + " .";
    var timerID = setTimeout("exec_refresh();", 100);
    if (timeout > 0)
    {
        timeout -= 1;
    }
    else
    {
        clearTimeout(timerID);
        window.status = "";
        window.location = "http://forums.randi.org/forumindex.php";
    }
}

var myvar = "";
var timeout = 20;
exec_refresh();
//-->
</script>

</body>
</html>
<!-- END TEMPLATE: STANDARD_REDIRECT --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:50:36.790

I think the `2152` bytes are reffered to the `gzipped data` sent (look at the `Content-Encoding gzip` header) while `HttpFox` show you the data already un-gzipped.

# html - 如何将其中一列的文本居中

> ID：14965844
> 
> 赞同：0
> 
> 时间：2013-02-19T19:32:48.713
> 
> 标签：html, css

我知道这很有趣，但我从未听说过使用标签 col 将特定列居中的最佳方法

我有桌子

```
<table>
<colgroup>
    <col />
    <col style="text-align: center;" />
</colgroup>
<tbody>
<tr>
    <td>
    </td>
    <td>
       I must be in center
    </td>
</tr>
<tbody>
</table> 
```

但它没有使我的文字居中，我想知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:35:32.820

```
<table>
<colgroup>
    <col />
    <col style="text-align: center;" />
</colgroup>
<tbody>
<tr>
    <td>
    </td>
    <td class="center">
       I must be in center
    </td>
</tr>
<tbody>
</table> 
```

CSS：

```
.center{
 text-align:center;
} 
```

[http://jsfiddle.net/cty4q/](http://jsfiddle.net/cty4q/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:44:23.163

虽然在一个完美的世界中，您的解决方案可以工作，但 CSS 级联并不完全以这种方式工作。但并非如此，因为 CSS 选择器很强大。在我看来，您最好的选择是使用[`:nth-child`](https://developer.mozilla.org/en-US/docs/CSS/%3anth-child)or [`:nth-of-type`](https://developer.mozilla.org/en-US/docs/CSS/%3anth-of-type)。

或者，您可以向您的单元格添加一个类名（手动或最好以编程方式），但这只是采取简单的方法;-)

进一步阅读：

*   [我可以使用 CSS3 选择器吗](http://caniuse.com/css-sel3)
*   [如何`:nth-child`工作](http://css-tricks.com/how-nth-child-works/)。

更新：

不过，显然，可以将样式应用于实际`colgroup`：http: [//jsfiddle.net/aRYqx/](http://jsfiddle.net/aRYqx/)。

# url - 如何使用 CXF 和 ANT 从非本地 wsdl url 生成存根

> ID：14965852
> 
> 赞同：1
> 
> 时间：2013-02-19T19:33:05.363
> 
> 标签：url, wsdl, cxf, stub

我想要 ANT 脚本（不是 Maven）从 wsdl url 生成存根。如果文件 wsdl 留在我的本地（c 驱动器）中，我知道该怎么做，但是当 wsdl 保持远程时不能这样做。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:23:37.813

你试过这个吗？

```
 <target name="cxfWSDLToJava">
      <java classname="org.apache.cxf.tools.wsdlto.WSDLToJava" fork="true">
         <arg value="-client"/>
         <arg value="-d"/>
         <arg value="src"/>
         <arg value="http://somehost.com/service?wsdl"/>
         <classpath>
            <path refid="cxf.classpath"/>
         </classpath>
      </java>
   </target> 
```

# css - CSS - 溢出高度和宽度，以及自动换行

> ID：14965856
> 
> 赞同：0
> 
> 时间：2013-02-19T19:33:15.667
> 
> 标签：css, overflow, word-wrap

我在制作具有定义的高度和宽度的项目列表以在 IE 中正确显示时遇到问题。在 IE 中，溢出对高度和宽度都不起作用，而在 chrome 中，只有框的高度被弄乱了，右边的溢出按预期隐藏。

我运行一个 jquery 脚本来截断溢出的文本，使其适合高度。此脚本在 ie 中不起作用，因为滚动高度始终与高度相同。但是，在 Chrome 中，如果其中一行向右（宽度）溢出，则文本不会正确换行，因此我尝试将其添加`word-wrap`到 css 中但没有任何效果。

我一直在这个[fiddle](http://jsfiddle.net/8GWah/10/)中处理这个问题，并且该问题的所有细节都应该在那里可用。

我已经用 IE9 和 Chrome 24 进行了测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:43:34.523

解决这个问题的方法是去掉孩子身上的`display: table`and `display: table-cell`。这样，the`word-wrap`和 overflow 都适用于 IE 和 Chrome。此外，已编辑 javascript 以将高度与其父高度进行比较。这需要父级具有指定的高度和溢出才能隐藏工作。

我已经编辑了[fiddle](http://jsfiddle.net/8GWah/16/)。

编辑：然而，一个小提示：这可以防止文本垂直居中。我现在正在努力解决这个问题......

编辑：好的，所以将列表项中的文本垂直居中的解决方案不是一个好的解决方案，也不是我引以为豪的解决方案。我更改了我的 javascript 以直接在元素上添加 css 规则。看小提琴

# mysql - MySQL SET max_connections

> ID：14965858
> 
> 赞同：0
> 
> 时间：2013-02-19T19:33:16.387
> 
> 标签：mysql

¿ 有没有办法在命令行中更改 max_connections 值并使其永久保存？

我用过 SET GLOBAL max_connections=xxx; 但每次我重新启动mysql服务时它总是回到100（默认值）。我已经读过，如果你从 mysql 的 my.ini 文件中更改它，更改将保持永久性，但这对我的情况来说不是一个可行的解决方案。

谢谢指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:06:58.683

如果您使用的是 php，则可以在 mysql 连接包装器中运行此查询（如果有的话）。

例如：

```
<?php
class CDBCnx {
    Public Function CDBCnx() {       

        /* implement your favorite pdo/mysqli driver to create your connection */
        /* the query function is imaginary: just run the query the way you wish */
        query("SET GLOBAL max_connections=xxx");
    }
}
?> 
```

这样，每次您在脚本中实例化一个新连接时，您都会以您希望的方式获得最大连接数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-12T04:14:56.643

我发现，当我的连接超出系统可以处理的限制时，它会重置为默认值。例如，默认值为 214，而我试图设置超过 1000。我的系统可以处理的最大值是 800。只要确保你没有超过限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-06T16:52:50.763

第 1 步：在控制台中执行

```
set global max_connections=xxx; 
```

第 2 步：在 mysqld 部分的 /etc/my.cnf 或 my.ini（在 Windows 中）中永久编辑它，以便下次重新启动不会将其回滚到旧值。

```
[mysqld] 
max_connections = xxx 
```

# quartz.net-2.0 - 如何获取由具有不同名称的零线程调度程序实例创建的 JobDetails/Triggers？

> ID：14965860
> 
> 赞同：0
> 
> 时间：2013-02-19T19:33:21.733
> 
> 标签：quartz.net-2.0

我正在从 Quartz.net 1.x 迁移到 2.x，由于某种原因，创建作业/触发器的调度程序的实例名称现在似乎非常重要......列`SCHED_NAME`已添加到大多数石英表中，并且它如果创建这些作业/触发器的零线程调度程序实例与用于获取和显示它们的实例具有不同的名称，则无法获取存储在数据库中的所有作业/触发器...

以下是关于我如何使用石英帮助您更好地理解问题的更多细节......

我有一个用于创建大多数作业/触发器的 UI，当我使用quartz.net 1.x 时，我正在创建具有不同名称的零线程调度程序实例，具体名称取决于应用程序的功能区域，我可以毫无问题地检索所有这些触发器由具有不同名称的实例触发。当我开始使用quartz.net 2.x时，由实例创建的作​​业/触发器与用于检索现有触发器以在UI中显示的实例不同，在使用`IScheduler.GetJobDetail`和`IScheduler.GetTriggersOfJob`函数时没有返回，因此我修改了UI以使用单个实例和解决了这个问题。

但是，我也有一个 Windows 服务，每次将文件放入由`FileSystemWatcher`.NET 对象观察到的热文件夹时，该服务都会实例化我的自定义文件处理器对象，因此该文件处理器对象的每个实例都必须创建一个quartz.net 零线程调度程序使用唯一的名称来安排作业来处理被删除的文件，因为可以同时删除多个文件，并且如果文件处理器对象的两个实例试图创建 quart.net 零线程调度程序的实例相同的名称会导致quartz.net 中的异常。因此，这些由 windows 服务创建的作业/触发器不再对 UI 中使用的零线程调度程序可见，并且这些由 windows 服务创建的触发器不再显示在我的 UI 中。

无论如何，我的问题是有没有一种方法可以从数据库中检索所有作业/触发器，而不管石英.net 2.x 中调度程序的实例名称如何，如果没有，是否有关于如何解决此问题的任何想法？另外，有没有人知道为什么要`SCHED_NAME`添加到所有表中，为什么调度程序名称现在在 2.x 中如此重要，以及进行此更改背后的想法是什么？

编辑：哇，刚刚花了几个小时试图弄清楚这一点，看起来（除非我遗漏了什么）Quartz.net 2 由于这个调度程序名称问题而存在严重缺陷，这就是为什么......

由零线程调度程序创建的实例名称与多线程调度程序的实例名称不同的任何触发器将被多线程调度程序忽略，并且如果所有使用的调度程序具有相同的实例名称（或者您让 Quartz.net给所有调度程序默认实例名称）在多个并发线程上创建触发器变得不可能，因为在这些线程上创建的所有零线程调度程序都是以相同的名称创建的，这将导致 Quartz 中的异常......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T23:14:28.840

我能找到的唯一解决方案是完全放弃为零线程或多线程调度程序提供实例名称。

这导致所有调度程序名称默认为`QuartzScheduler`，这使得任何调度程序创建的所有作业/触发器对我的 UI 用于显示和管理作业/触发器的零线程调度程序可见...

我还通过一次将多个文件放入热文件夹来测试我的热文件夹，这导致了多个自定义`FileProcessor`对象的实例化，每个对象都使用自己的零线程调度程序，并且由于所有这些同时创建的零线程，Quartz 没有引发异常调度程序使用相同的默认名称。

我希望能够继续为不同的调度程序使用不同的实例名称，但这解决了问题，因此这是一个可以接受的解决方案。

# mysql - 将 AES_DECRYPT 与 SELECT * 一起使用

> ID：14965862
> 
> 赞同：1
> 
> 时间：2013-02-19T19:33:27.730
> 
> 标签：mysql, select, encryption, aes

是否可以选择所有记录并使用带有 AES_DECRYPT 函数的星号对其进行解密？这就是我希望能够做到的：

```
SELECT AES_DECRYPT(*, SOMESTATICKEY) FROM some_table 
```

编辑：我想我应该澄清我的问题，因为我知道我的要求是行不通的。我想知道的是在语法或功能上是否有任何其他方式可以做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T20:07:59.657

如果您查看有关 `SELECT`mysql 语法
[http://dev.mysql.com/doc/refman/5.0/en/select.html](http://dev.mysql.com/doc/refman/5.0/en/select.html)
的此链接， 您可以看到在`SELECT`动词之后，命令需要一个`select_expr`或一个列表`select_expr`

这意味着您必须以这种形式发出命令。

```
SELECT AES_DECRYPT(Field1, SOMESTATICKEY),
       AES_DECRYPT(Field2, SOMESTATICKEY),
       AES_DECRYPT(Field3, SOMESTATICKEY)
FROM some_table 
```

此外，AES_DECRYPT() 函数期望字符串作为其第一个参数，而不是列表。

所以答案显然是否定的

# asp.net-mvc - 向右“下降”的 CSS 选择列表

> ID：14965864
> 
> 赞同：0
> 
> 时间：2013-02-19T19:33:40.300
> 
> 标签：asp.net-mvc, css, razor, html.dropdownlistfor

我在 MVC4 中工作，并希望有一个 DropDownList 向右“下降”，而不是向下。

[http://tympanus.net/Development/SimpleDropDownEffects/](http://tympanus.net/Development/SimpleDropDownEffects/)

上面的演示显示了我正在寻找的样式。但是，我希望它在右侧，而不是下拉。

像这样： ![在此处输入图像描述](../Images/c527600b4017f191ae4b4ba725a3429a.png)

我知道上面的链接使用 ul/li，但如果我可以将其绑定为使用 DropDownListFor，那将是理想的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:55:44.360

实际上你应该像往常一样使用 DropDownListFor 。您唯一应该做的就是在感兴趣的下拉列表中调用 jQuery 的扩展方法。像这样：

```
$(document).ready(function(){
  $('#dorpdownId').dropdown();
}); 
```

实际上[这篇文章](http://tympanus.net/codrops/2012/11/29/simple-effects-for-drop-down-lists/)有很好的文档。

# java - 有没有在度量空间中聚类的方法？

> ID：14965867
> 
> 赞同：0
> 
> 时间：2013-02-19T19:33:52.253
> 
> 标签：java, cluster-analysis

我想对来自 Twitter 的数据进行聚类。我有用户和他们的距离。我不能使用 K-means，因为 k-means 不支持度量空间中的聚类。是否有在度量空间中进行聚类的实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T06:59:52.773

说真的，买一本关于聚类分析的书。

必须有**数百种聚类算法**，其中许多都适用于您具有某种相似性概念的任意空间。只要您的相似性概念良好，它们就可以对数据进行聚类。大多数时候他们失败了，你的相似性首先不起作用。

无论如何，**你的问题太宽泛了，无法给你一个好的答案**。您需要自己尝试这数百种算法中的一些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T20:07:25.807

您是否考虑过使用层次聚类来解决这个问题？

这里还有一堆关于度量空间中聚类的讲座，可能会有所帮助： [Clustering Large Datasets in Arbitrary Metric Spaces](http://www.cs.virginia.edu/~cyberia/papers/ICDE99.pdf)

[度量空间中的聚类](http://cseweb.ucsd.edu/~dasgupta/291/lec1.pdf)

下面是一些java的集群包：

[机器学习](http://java-ml.sourceforge.net/content/clustering-algorithms)

[平均数](http://commons.apache.org/math/apidocs/org/apache/commons/math3/stat/clustering/KMeansPlusPlusClusterer.html)

[层次聚类](https://code.google.com/p/cluster-algorithms-java-alpha/source/browse/tags/rewritepending/src/algorithms/HierarchicalClustering.java?r=5)

有一个关于交叉验证的问题可能会有所帮助，他们没有使用 java，但他们提供的解决方案可能会有所帮助：[Clustering with a distance matrix](https://stats.stackexchange.com/questions/2717/clustering-with-a-distance-matrix)

# html - Facebook 喜欢不发布到墙上

> ID：14965870
> 
> 赞同：1
> 
> 时间：2013-02-19T19:34:04.913
> 
> 标签：html, facebook

我正在尝试将 Facebook Like 按钮发布到墙上，但它不会。我不确定为什么当我复制 + 粘贴 Facebook 网站提供的代码时。当我在检查器中检查网络面板时，我看到与 Facebook 建立了 200-OK 连接。当我去我的 Facebook 墙时，我没有看到那个帖子。当我尝试点赞其他网站的内容时，我发现它会立即贴在我的墙上。

`<div class="fb-like services" data-href="http://www.my-url.com/" data-send="false" data-show-faces="false" data-layout="button_count"></div>`

```
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<meta property="og:title" content="My Site" />
<meta property="og:type" content="game" />
<meta property="og:url" content="http://www.my-url.com" />
<meta property="og:image" content="" />
<meta property="og:site_name" content="My Site" />
<meta property="fb:admins" content="100002412494318" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:06:17.500

正如对 OP 的评论中所述，这里有两个问题可能会导致您的类似插件出现问题。

首先，必须注意`og:meta`在您想要放置“赞”按钮的 URL 上实现一些标签。这些元标签帮助 Facebook 决定在用户​​墙/时间轴上发布的故事中使用什么标题、描述和图像。

您需要注意的第二件事是 Facebook 的爬虫必须能够访问您的 URL - 只有这样 Facebook 才能创建指向您的 URL 的提要故事。正如您[在评论](https://stackoverflow.com/questions/14965870/facebook-like-not-posting-to-wall#comment21012016_14965870)中所说，您正在调试的 URL 位于您的本地计算机上，因此 Facebook 的服务器无法访问它。Facebook 不会在无法访问的 URL 上发布类似的故事（这样做有什么意义？）。

为了确保您的“点赞”按钮正常运行，您需要等到 Facebook 的服务器可以访问您的 URL。如果您将网站上传到“真实”的实时服务器，您仍然可以使用密码和 IP 限制来限制对该 URL 的访问。在这种情况下，您可能会将[Facebook 的服务器 IP 地址包含](https://stackoverflow.com/questions/7535553/what-is-the-ip-address-of-the-facebook-server-that-sends-me-app-deauthorization)到您的白名单中，或者使用其他方法（可能检查用户代理）来允许 Facebook 访问您的 URL 及其`og:meta`标签。

Facebook 为我们提供了调试此类问题的绝佳机会。这个工具被恰当地命名为**[Facebook 调试器](https://developers.facebook.com/tools/debug)**。它将检查您提供的 URL，列出它检索到的数据并准确显示 Facebook 如何看待您的网站。它还会提醒您任何丢失的数据，并建议纠正这些问题的步骤。

# sql - 覆盖索引的有用性

> ID：14965880
> 
> 赞同：0
> 
> 时间：2013-02-19T19:35:04.950
> 
> 标签：sql, sql-server, indexing, covering-index

我有一个在多个表上执行连接的查询。我在表的外键上有非聚集索引，在主键上有聚集索引。在分析查询计划时，我发现查询优化器选择对所有表进行聚集索引扫描，或者在某些情况下结合非聚集索引扫描和键查找来获取其他非键列。为了解决这个问题，我在非聚集索引中包含（覆盖）了此查询中所需的非键列。因此，我可以看到非聚集索引搜索/扫描按预期执行。

现在我的问题是，如果我有其他查询需要许多其他非键列作为结果集的一部分，那么我最终可能会将所有列添加（包括）到非聚集索引中以提高所有查询的性能. 这是个好主意吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:42:36.253

它非常了解您的使用情况。为您可能查询的所有内容添加索引真的很容易，但与所有内容一样，这是一个权衡。每个索引都会花费您的时间和存储空间 - 因此它可能会减慢您的插入/更新速度，并且索引越多，此成本就越高。

如果您的使用非常倾向于读取而不是写入，那么一切都很好，您需要做的就是支付一些存储费用。如果您也需要良好的写入性能，那么您真正能做的就是了解您的应用程序并索引您最重要的内容。

我强烈推荐“inside sql server”系列书籍（Kalen Delaney 等人）——阅读大量内容，但我保证它们会帮助您了解您所做的权衡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T20:00:08.953

听起来您包含了 WHERE 子句所需的列，因此您得到了索引搜索。

您还可以包含 SELECT 列表中的列，这会给您带来不同的好处。如果您的索引包含查询所需的所有字段，包括 SELECT 列表，那么查询结果可以直接从索引中返回，并且根本不需要返回表记录。

当然，UPDATE、INSERT 和 DELETE 操作包括索引构建的额外成本。

您可以运行 SQL Server Management Studio 工具 > SQL Server Profiler 来获取当前数据库活动的示例。然后，您可以将其提供给 Tools > Database Engine Tuning Advisor。如果您有很多 INSERT 和 UPDATE 活动，Tuning Advisor 可能会建议删除一些索引。如果您的活动主要是 SELECT 语句，则很可能会建议附加索引。

我发现数据库引擎优化顾问经常建议在许多列上覆盖索引，例如您所描述的。在这件事上，我有时会同意它的建议，但通常会将索引限制在键和条件列，除非特定查询存在特定的性能问题。

# php - 根据数组为查询分配变量

> ID：14965882
> 
> 赞同：0
> 
> 时间：2013-02-19T19:35:15.527
> 
> 标签：php, javascript, arrays, associative-array

我想从查询中获取 PHP 变量

```
?q=aaa 
```

并根据关联数组在JS中定义一个变量：

```
{
    "aaa": "111",
    "bbb": "222",
    "ccc": "333"
}; 
```

所以如果

```
var oldVariable = '<?php echo $q; ?>' ; 
```

然后

```
var newVariable = ...   // '222' when $q is 'bbb' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:42:13.423

享受：

```
<script>
<?php $q =  (isset($_GET['q'])) ? $_GET['q'] : "default" ;?>

var arr = {
    "aaa": "111",
    "bbb": "222",
    "ccc": "333"
};

var oldVariable = '<?php echo $q ; ?>' ;
var newVariable = (typeof arr['<?php echo $q ; ?>'] != "undefined") ? arr['<?php echo $q ; ?>'] : "No var from get" ;

alert(newVariable) ;

</script> 
```

# php - 获取字段名称和值：数组

> ID：14965885
> 
> 赞同：-2
> 
> 时间：2013-02-19T19:35:34.777
> 
> 标签：php, mysql, mysqli

我正在使用 *mysql_fetch_assoc* 但是：

```
This extension is deprecated as of PHP 5.5.0, and will be removed in the future 
```

php.net 推荐 *MySQLi 或 PDO_MySQL*

我试过`mysqli_fetch_assoc`但不知道如何获取实际的字段名称（属性）和相应的值。

假设我只有 1 行用户信息：

**例如**，结果字段名称：“姓名”和“年龄”以及值：“约翰”和“18”。

我的目标是获取实际的字段名称（姓名和年龄），同时在同一循环中获取特定字段名称的值，如 $column['Name'] 或 $column['Age']。

现有循环中的示例 sql：

```
$sqlUpdate = "Update report SET `" . $key. "` = " . $value . " where Name = '" . $value . "'" 
```

.

因为如果我只使用 $value 我将如何知道我所指的字段名称`...where Name = '" . $value . "'"?`

仅当其他表行中的记录是我的其他表的字段名称（列）时，才用于报告目的。

希望这能更多地解释我的担忧。

顺便说一句 mysql_fetch_assoc 和 mysqli_fetch_assoc 只是我告诉那些可能有足够知识的人如果这些扩展（旧的或新的）仍然有用解决我的问题的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:49:08.073

1.  不要使用 mysqli。请改用 PDO。
    每个人都在敦促您从 mysql_ 转移，只是为了准备好的语句，但 mysqli 无法与它们一起使用。
2.  正如评论中所说，关联数组已经拥有所有这些信息——名称作为键，值作为值。无论它来自哪里——mysql、mysqli 或手动创建的数组：

.

```
$arr['Name'] = 'John'; 
```

因此，您可以通过各种方式获得您的密钥。

```
$key = key($arr); // $key="Name" now
foreach ($arr as $key => $value) {  // another way to get keys and values.
    echo $key .' ' . $value;
}
$keys = array_keys($arr); // $keys=array('Name'); now 
```

但是我有一种感觉，您的问题在其他地方，但您无法正确解释它。
你的最终目标是什么？为什么需要该字段名称？

# java - 使用 NIO2 从现有路径对象创建新路径

> ID：14965886
> 
> 赞同：1
> 
> 时间：2013-02-19T19:35:34.263
> 
> 标签：java, nio

我有一个`java.nio.file.Path`代表某个目录的对象（例如，`/var/log`）。我想要一个新的 Path 对象来表示目录中的一个文件（例如，`/var/log/something.log`）。我一直在使用

```
Path logDir = ...
Path logFile = Paths.get(logDir.toString(), "something.log"); 
```

但是必须将 logDir 转换为字符串，然后构造新的 Path 对象，这似乎很愚蠢。如何在不使用 toString 的情况下获取 logFile 对象？例如，

```
Path logDir = ...
Path logFile = Paths.get(logDir, "something.log"); // Doesn't exist 
```

# excel - 使用 C# 对现有 excel 文件进行身份验证并将其移动到 sharepoint webfolder

> ID：14965891
> 
> 赞同：0
> 
> 时间：2013-02-19T19:36:03.073
> 
> 标签：excel, sharepoint

使用有效的用户名和密码，如何将现有的 excel 文件发送到 Web 文件夹（Sharepoint 文档）？

例如，我要发送的文件是

```
C:\Source.xls 
```

我想把它寄给：

```
\\somesharepointintranetwebsite.com@SSL\DavWWWRoot\somefolder\ 
```

但是，当我尝试使用普通复制功能执行此操作时，我收到找不到路径的错误（这是在我手动登录到我在本地机器上创建的 web 文件夹之前）。

如何使用 C# 编程登录，以便我可以“始终”毫无问题地移动文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T23:05:16.877

这在命令行下进行了身份验证。
net use \someserversite.com\somefolder /USER:DOMAIN\username 密码

# php - 如何在命令 shell 中使用 PHP 中的特殊字符？

> ID：14965893
> 
> 赞同：3
> 
> 时间：2013-02-19T19:36:07.863
> 
> 标签：php

对于学校，我们被迫用 BASIC 或“任何其他语言”编写一个小程序，所以我将用 PHP 来做。

我必须通过命令提示符运行它，所以我想我会用线条等对 shell 的“UI”进行一些改进。我使用 ALT+nnn 将它们插入到我的代码中，但是当我在 shell 中执行它时我在它的地方得到了奇怪的字符。

有谁知道如何解决这一问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T19:54:02.090

从这个[SO 线程](https://stackoverflow.com/a/388500/137626)

*   将字体切换到 Lucida
*   然后将 shell 代码页切换为 UTF-8，输入：

    `chcp 65001`

这在 Windows 上似乎非常有问题，所以你可能会更好地使用[850](http://en.wikipedia.org/wiki/Code_page_850)（Latin-1，在 Windows 中相当于 1252 的 MS-DOS）这样的代码。我的意思是`chcp 850`。

# android - Android 运行时异常 - 找不到从方法 XXX 引用的类 XXX。

> ID：14965895
> 
> 赞同：0
> 
> 时间：2013-02-19T19:36:14.013
> 
> 标签：android, android-ndk, native, aidl, multi-project

我有一些我正在尝试组合的 android 项目，但我面临一些我无法理解的运行时异常。

这些项目是这样构建的：

* * *

C/C++ 项目 ProjCore（具有 .c 和 .h 文件）

* * *

Android Project ProjB -> 使用 -> ProjCore

注意：ProjB 实现了一个**Service**，并通过aidl 生成的 java 类使用 ProjCore。ProjCore 位于**jni**文件夹中。NDK 已安装。ProjB 配置为自动运行 ndk-build。ProjCore 的编译生成一个带有 .so 文件的**libs目录。**

* * *

Android 项目 ProjA -> 使用 -> ProjB

注：ProjA 实现了一个 Activity 并使用 ProjB Service 类。

* * *

ProjA 和 ProjB（包括 ProjCore）构建成功，生成了 apk，但是在运行时，当我运行 ProjA 的活动时，我收到以下错误消息：

```
W/dalvikvm(5357): Unable to resolve superclass of Lcom/signove/health/servicetest/HealthServiceTestActivity$1; (16)

W/dalvikvm(5357): Link of class 'Lcom/signove/health/servicetest/HealthServiceTestActivity$1;' failed

E/dalvikvm(5357): Could not find class 'com.signove.health.servicetest.HealthServiceTestActivity$1', referenced from method com.signove.health.servicetest.HealthServiceTestActivity.<init> 
```

* * *

据我所知，这些消息通常与使用外部 jar 的项目相关联，人们忘记将这些 jar 放在 libs 文件夹中。但是项目崩溃（ProjA）仅与项目 ProjB 具有依赖关系，并且依赖关系在项目属性中配置。

我正在使用： - Kubuntu 10.04 - Eclipse Indigo - Android NDK-r8 - 安装了 Eclipse CDT

有谁知道问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T21:20:17.740

我刚刚在我的项目中发现了问题。Eclipse android 插件无法将aidl 文件夹识别为源文件夹，因此它不会从aidl 生成java 类。

我已经在 ProjB 中修复了这个问题，但忘记在 ProjA 中修复（也有aidl文件）......

如果有人有同样的问题，要修复进入项目 - > 属性，选择“Java 构建路径”，转到选项卡“源”并添加aidl 文件夹。在选项卡中订购和导出将“aidl”文件夹移到“src”文件夹之前。

希望对其他人有所帮助。

# c++ - 如何格式化浮点值，使其从不使用指数表示法，也没有尾随零？

> ID：14965902
> 
> 赞同：9
> 
> 时间：2013-02-19T19:36:40.667
> 
> 标签：c++, floating-point, string-formatting, iostream

根据[ios_base manipulators](http://en.cppreference.com/w/cpp/io/manip/fixed)，我基本上可以在格式化没有指数表示法的浮点数（使用十进制数）之间`defaultfloat`和何时进行选择。`fixed`

但是，我想选择[最大精度](http://en.cppreference.com/w/cpp/io/manip/setprecision)，这将为许多数字（例如）产生*很多*尾随零，但避免使用指数表示法。如果设置为，它会在*大多数*情况下看起来正确，除非该值真的很小，但不是。在这种情况下，默认表示会自行切换为科学记数法，这会破坏格式化输出的接收器（因为它不知道什么意思。`fixed``1.``defaultfloat`*`0.``2.22045e-16`*

 *那么，我怎样才能拥有我的馅饼并吃掉它呢？也就是说，**没有不必要的尾随零的非指数符号**。

* * *

[*注意：我没有测试该`defaultfloat`标志的效果，因为我的 gcc 似乎还没有实现该标志，但我认为它是默认设置，无需使用任何标志即可应用。我确实检查了`fixed`标志，它的行为符合预期。*]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T20:13:43.780

一个简单的方法是这样的：

```
std::string float2string(double f)
{
    std::stringstream ss;

    ss << std::fixed << std::setprecision(122) << f;   // 122 is LARGE, but you may find that really tiny or really large numbers still don't work out... 

    std::string s = ss.str();

    std::string::size_type len = s.length();

    int zeros = 0;
    while(len > 1 && s[--len] == '0')
        zeros++;
    if (s[len] == '.')  // remove final '.' if number ends with '.'
        zeros++;
    s.resize(s.length()-zeros);

    return s;
} 
```

我已经对其进行了一些测试。最大的问题是它为某些数字提供了大量的小数，像 0.05 这样的东西出来，`0.05000000000000000277555756156289135105907917022705078125` 而 0.7 变成： `0.05000000000000000277555756156289135105907917022705078125`

那是因为它不是二进制形式的“精确”数字。

我认为解决方案是通过取整数位数（或 floor(log(f)/log(10)+1)）然后从常数中减去该数字来粗略计算您想要的结果位数，例如 17，这是您可以从 double 中获得的位数。然后删除多余的零。

我暂时先把它留下，因为我还有一些其他的事情要做，我应该在不久前就开始做……；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T20:37:42.360

由于似乎没有使用标准库执行此操作的正确方法，因此这是我的包装器。

```
 template <typename T>
  struct FpFormat {
    template <typename Stream>
    static Stream& setfmt(Stream& str) {
      return str;
    }
    template <typename String>
    static String const& untrail(String const& str) {
      return str;
    }
  };
  template <typename T>
  struct FpFormatFloats {
    template <typename Stream>
    static auto setfmt(Stream& str) -> decltype(str << std::fixed << std::setprecision(std::numeric_limits<T>::digits10)) {
      return str << std::fixed << std::setprecision(std::numeric_limits<T>::digits10);
    }
    template <typename String>
    static String untrail(String str) {
      if (str.find('.') == String::npos)
        return str;
      return ([](String s){
        return String(s.begin(),s.begin()+((s.back() == '.')?(s.size()-1):s.size()));
      })(str.substr(0,(str+"0").find_last_not_of('0')+1));
    }
  };
  template <> struct FpFormat<float> : FpFormatFloats<float> {};
  template <> struct FpFormat<double> : FpFormatFloats<double> {};
  template <> struct FpFormat<long double> : FpFormatFloats<long double> {};

  template <typename T>
  std::string toString(T x) {
    std::stringstream str;
    FpFormat<T>::setfmt(str) << x;
    return FpFormat<T>::untrail(str.str());
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-06T11:23:34.927

`iostream`可悲的是，在或中似乎没有代码可以做到这一点`printf()`。任何“这个”我的意思是：

1.  以固定格式打印。
2.  打印*最小*位数，以便编码无损（即最接近的有效浮点数是您打印的那个）。

您*不能*仅以非常大的精度打印并去除尾随零，因为可能存在不必要的非零数字。

我相信真正做到这一点的唯一好方法是使用像[Ryu](https://github.com/ulfjack/ryu)这样的专用代码。

另一种方法是以非常大的精度打印下一个和上一个数字，并取小数点后相同的数字（加一个）。不过会很丑。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-19T20:04:58.637

没有内置格式可以为您执行此操作。您可以从头开始生成自己的格式化程序，也可以编写一个对字符串进行后处理以删除不必要的尾随零的格式化程序。

例如，您可以使用正则表达式替换：

```
#include <iomanip>
#include <iostream>
#include <sstream>
#include <regex>

// not thoroughly tested
std::string format(double d, int precision = 100) {
   std::stringstream ss;
   ss << std::fixed << std::setprecision(precision);
   ss << d;

   return std::regex_replace(
       std::regex_replace(ss.str(), std::regex(R"((-?\d*\.\d*?)0*$)"), "$1"),
       std::regex(R"(\.$)"), "");
}

int main() {
   std::cout << format(-1) << '\n';
   std::cout << format(1e20) << '\n';
   std::cout << format(1e-20) << '\n';
   std::cout << format(2.22045e-16) << '\n';
} 
```

尽管使用正则表达式可能不是一个特别有效的解决方案。*

# spring - Spring/JPA/Hibernate 事务管理问题

> ID：14965905
> 
> 赞同：1
> 
> 时间：2013-02-19T19:36:52.630
> 
> 标签：spring, hibernate, jpa, transactions

使用：

*   春天 3.1.2
*   Spring Data JPA 1.1.0.RELEASE
*   休眠 4.1.6
*   RESTEasy 2.3.5

我正在构建一个与 Oracle 数据库通信的 RESTful Web 服务平台。现在我们正在开发订阅者 API。我们的订阅者存储库对象映射到 Oracle 中的 USERS 表。对于版本控制，我们在 USERS 表上使用 ORA_ROWSCN 伪列。这是订阅者类的版本成员变量：

```
@Column(name = "ORA_ROWSCN", nullable = false, updatable = false, insertable = false)
@Version
@Generated(value = GenerationTime.ALWAYS)
protected long version = 0; 
```

当我尝试执行创建订阅者请求时，我在应用程序日志中看到以下内容：

```
Hibernate: select USERIDSEQUENCE.nextval from dual
Hibernate: insert into USERS (...[snip]...) values (...[snip]...)
Hibernate: select subscriber_.ORA_ROWSCN as ORA19_5_ from USERS subscriber_ where subscriber_.id=? 
```

前两行显然是 Hibernate 插入新的 USERS 记录；大概第三行是 Hibernate 尝试为新行加载 ORA_ROWSCN 值，以便它可以在订阅者对象上设置版本属性。但是，这会导致此异常：

```
org.springframework.orm.hibernate3.HibernateSystemException: Null value was assigned to a property of primitive type setter of com.mycompany.webservices.model.Subscriber.version;
nested exception is org.hibernate.PropertyAccessException: Null value was assigned to a property of primitive type setter of com.mycompany.webservices.model.Subscriber.version 
```

我认为这意味着选择 ORA_ROWSCN 值的尝试没有返回任何内容。为什么会这样？我有一个`@Transactional`围绕创建订阅者的服务方法的包装器；我假设在该方法（或子方法）中运行的任何代码都可以看到临时数据库插入/更新。但从这个例外看来，或许并非如此？

# sql - Wordpress 最大用户数与 SQL 登录

> ID：14965906
> 
> 赞同：1
> 
> 时间：2013-02-19T19:36:59.480
> 
> 标签：sql, wordpress

我正在开发一个 Wordpress 网站，除了基本内容之外，该网站还要求用户登录和注册一些信息，以便查看数据并进行购买……但他们可能永远不会回来，或者少于 5 次。

我开始使用 Wordpress 登录并注册用户，但我担心用户负载。我们正在关注每天可能有 500 多个用户注册。我看过报告 Wordpress 可以处理它，但我想知道它是否太多了。

认为最好使用平面 MySQL 并仅在 Wordpress 上为购买者创建自己的登录名？还是坚持使用 Wordpress？Wordpress 可以为用户处理的最大负载是多少？

# ios - iOS：在 UIImageViews 之间移动图像

> ID：14965910
> 
> 赞同：2
> 
> 时间：2013-02-19T19:37:17.290
> 
> 标签：ios

我有一个视图控制器，其中有一个默认的 UIview 放置整个屏幕。我在这个视图中添加了几个 UIImageViews（比如 20 个左右）。我想支持在这些 UIImageViews 之间交换图像。我已经使用 UITapGestureRecogniser 来处理这些 UIImageViews 上发生的触摸。我可以在这个 UITapGestureRecogniser 事件本身下处理这些 UIImageViews 之间的图像拖放吗？（或）我需要使用 UIPanGestureRecognizer 或触摸事件吗？在这些 UIImageView 之间实现图像拖放的最简单和最简单的方法是什么？请建议？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T20:08:51.253

几个想法。

1.  您可以通过点击手势来实现这一点（例如点击第一个图像视图，点击目标图像视图），但这不是很直观。使用 a 进行适当的拖放`UIPanGestureRecognizer`对于您的最终用户来说将更加直观。

2.  从技术上讲，您不是从图像视图中拖动图像，而是实际上是在拖动图像视图本身。（如果没有图像视图，图像本身就没有视觉表示。）当您放手时，您将动画化图像视图帧的变化以完成错觉。

* * *

如果你有一个 NSArray `imageViews`，你可以在他们的超级视图中添加一个手势：

```
@property (nonatomic, strong) NSMutableArray *imageViews;

- (void)viewDidLoad
{
    [super viewDidLoad];

    [self createImageViewArray];

    UIPanGestureRecognizer *gesture = [[UIPanGestureRecognizer alloc] initWithTarget:self
                                                                              action:@selector(handlePan:)];
    [self.view addGestureRecognizer:gesture];
}

- (void)createImageViewArray
{
    self.imageViews = [NSMutableArray array];

    // add your imageviews to the array any way you want

    ...
}

- (void)handlePan:(UIPanGestureRecognizer *)gesture
{
    static UIImageView *draggedImage = nil;
    static CGRect draggedImageOriginalFrame;

    CGPoint location = [gesture locationInView:gesture.view];

    if (gesture.state == UIGestureRecognizerStateBegan)
    {
        // see if we grabbed an imageview

        draggedImage = [self determineImageForLocation:location];

        // if so, save its old location for future reference and bring it to the front

        if (draggedImage)
        {
            draggedImageOriginalFrame = draggedImage.frame;
            [draggedImage.superview bringSubviewToFront:draggedImage];
        }
    }
    else if (gesture.state == UIGestureRecognizerStateChanged && draggedImage != nil)
    {
        // if we're dragging it, then update its location 

        CGPoint translation = [gesture translationInView:gesture.view];
        CGRect frame = draggedImageOriginalFrame;
        frame.origin.x += translation.x;
        frame.origin.y += translation.y;
        draggedImage.frame = frame;
    }
    else if (draggedImage != nil && (gesture.state == UIGestureRecognizerStateEnded ||
                                     gesture.state == UIGestureRecognizerStateCancelled ||
                                     gesture.state == UIGestureRecognizerStateFailed))
    {
        // if we let go, let's see if we dropped it over another image view

        UIImageView *droppedOver = nil;

        if (gesture.state == UIGestureRecognizerStateEnded)
            droppedOver = [self draggedImageView:draggedImage toLocation:location];

        if (droppedOver == nil)
        {
            // fail; animate the restoring of the view back to it's original position

            [UIView animateWithDuration:0.25
                             animations:^{
                                 draggedImage.frame = draggedImageOriginalFrame;
                             }];
        }
        else
        {
            // succeed; make sure to bring the view we're about to animate to the front

            [droppedOver.superview bringSubviewToFront:droppedOver];

            // animate the swapping of the views

            [UIView animateWithDuration:0.25
                             animations:^{
                                 draggedImage.frame = droppedOver.frame;
                                 droppedOver.frame = draggedImageOriginalFrame;
                             }];
        }
    }
}

// see if we dragged an imageview over one of our imageviews, returning a point
// to the image view we dropped it over

- (UIImageView *)draggedImageView:(UIImageView *)draggedView toLocation:(CGPoint)location
{
    for (UIImageView *imageview in self.imageViews)
        if (CGRectContainsPoint(imageview.frame, location) && imageview != draggedView)
            return imageview;

    return nil;
}

// see if we started the gesture over an imageview
// (turns out that this is the same as "did we drag an image over another",
// but as we're not dragging an image yet, just pass nil)

- (UIImageView *)determineImageForLocation:(CGPoint)location
{
    return [self draggedImageView:nil toLocation:location];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-19T15:09:52.717

Rob 的回答非常好。`handlePan`我稍微修改了他的方法以允许图像的热交换。

![热插拔](../Images/b2ae5e0cd1ba0e73a1d70a9d18b4f97f.png)

```
- (void)handlePan:(UIPanGestureRecognizer *)gesture
{
    static UIImageView *draggedImage = nil;
    static CGRect draggedImageLastFrame;

    CGPoint location = [gesture locationInView:gesture.view];

    if (gesture.state == UIGestureRecognizerStateBegan) {

        // see if we grabbed an imageview

        draggedImage = [self determineImageForLocation:location];

        // if so, save its old location for future reference and bring it to the front

        if (draggedImage) {
            draggedImageLastFrame = draggedImage.frame;
            [draggedImage.superview bringSubviewToFront:draggedImage];
            draggedImage.alpha = 0.6f;
        }

    } else if (gesture.state == UIGestureRecognizerStateChanged && draggedImage != nil) {

        // if we're dragging it, then update its horizontal location

        CGPoint translation = [gesture translationInView:gesture.view];
        CGRect frame = draggedImage.frame;
        frame.origin.x += translation.x;
        draggedImage.frame = frame;
        [gesture setTranslation:CGPointZero inView:gesture.view];

        UIImageView *draggedOver = [self draggedImageView:draggedImage toLocation:location];
        if (draggedOver != nil) {

            // animate the draggedOver image to the the draggedImage's last location

            [UIView animateWithDuration:0.25
                             animations:^{
                                 CGRect currentFrame = draggedOver.frame;
                                 draggedOver.frame = draggedImageLastFrame;
                                 draggedImageLastFrame = currentFrame;
                             }];
        }

    } else if (draggedImage != nil && (gesture.state == UIGestureRecognizerStateEnded ||
                                       gesture.state == UIGestureRecognizerStateCancelled ||
                                       gesture.state == UIGestureRecognizerStateFailed)) {

        // finished, animate the draggedImage into place

        [UIView animateWithDuration:0.25
                         animations:^{
                             draggedImage.frame = draggedImageLastFrame;
                             draggedImage.alpha = 1.0f;
                         }];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T21:53:10.307

事实上，根本不要使用轻击手势。

秘诀就是使用imageView的superview。

你需要3个图像视图......

```
UIImageView *ImageViewA

UIImageView *ImageViewB

UIImageView *DraggableImageView 
```

假设您单击屏幕并且主机视图收到一个 touchesBegan 事件...如果您使用 ImageViewA 并使用以下方法测试它的 rect：

```
[rect containsPoint:touchPoint]; 
```

如果这是真的并且你已经成功地触摸了第一个 imageView... 在 touchesMoved 中开始拖动操作，如下所示：

如果您使用 ImageViewA.superview，您将获得视图的主机视图...然后主机视图应收到以下命令：

```
[newDraggableImageView setFrame:ImageViewA.frame];
[newDraggableImageView setImage:ImageViewA.image];
[hostView addSubview:newDraggableImageView]; 
```

现在您可以使用 UIResponder 方法 touchesBegain touchesMoved 和 touchesEnded 在宿主视图上跟踪触摸事件

当你通过 touchesMoved: 将移动的坐标发送到 newDraggableImageView 的框架中......

因为它正在拖动...... touchesEnded 方法之一：

如果图像的框架在第二个拖动点的框架内，那么您可以设置最终的图像视图

```
if ([frame containsRect:anotherFrame])
    ImageViewB.image = draggableImageView.image; 
```

抱歉，这是伪代码...希望您了解逻辑流程...将图像添加到主机视图...或应用程序的窗口视图并移动它...一旦移动结束...测试位置的 imageView 并适当地设置新的图像视图......

祝你好运！和快乐的编码！

# sql - 过滤多个 XML 元素

> ID：14965911
> 
> 赞同：1
> 
> 时间：2013-02-19T19:37:18.617
> 
> 标签：sql, xml, sql-server-2008, xquery, xquery-sql

```
<Root>
    <Sub>
        <Name>a</Name>
        <Value>1</Value>
    </Sub>
    <Sub>
        <Name>b</Name>
        <Value>2</Value>
    </Sub>
</Root> 
```

我知道我可以做一个

```
SELECT * FROM table WHERE column.exist('/Root/Sub[Name="a" and Value="1"]') = 1 
```

但是如何过滤两个名称/值对？a/1 和 b/2？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:30:16.433

怎么样：

`SELECT * FROM table WHERE (column.exist('/Root/Sub[Name="a" and Value="1"]') = 1 OR (column.exist('/Root/Sub[Name="b" and Value="2"]') = 1)`

注意额外的括号。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-02-10T04:11:55.857

这将按预期工作：

```
SELECT *
  FROM TableName
 WHERE XMLColumnName.Exist('/Root/Sub[Id = "IdValue"][LimitType = "LimitTypeName"]') = 1 
```

# jquery - jQuery 对话框 + iframe 在 IE9 中出现此错误：SCRIPT5009: 'Array' is undefined

> ID：14965912
> 
> 赞同：4
> 
> 时间：2013-02-19T19:37:21.447
> 
> 标签：jquery, iframe, internet-explorer-9

我一直在与一个只有 IE9 才会遇到的错误作斗争。根据 jQuery 和 jQuery-UI 的版本，错误消息会有所不同。使用 jquery 1.8.3 和 jquery-ui 1.8.24，我会收到以下错误消息：

> SCRIPT5009：“数组”未定义

但是，使用 jquery 1.7.x 和 jquery-ui 1.7.x，我会收到以下错误消息：

> SCRIPT5009：“对象”未定义

这是违规页面的代码：

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script type="text/javascript" src="http://code.jquery.com/ui/1.8.24/jquery-ui.min.js"></script>
<title></title>
    <script type="text/javascript">
        $(document).ready(function() {
            $("#dialog").dialog();
        });
    </script>
</head>
<body>
    <div id="dialog">
        <iframe id="iframe1" src="jqtest2.htm"></iframe>
    </div>
</body>
</html> 
```

这是该页面中 iframe 的代码：

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.js"></script>
</head>
<body>
</body>
</html> 
```

在使用兼容性视图模式的 IE 9、Google Chrome 或 Firefox 中，我没有收到这些错误消息。

iframe 中包含 jquery 似乎是罪魁祸首。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-19T19:37:21.447

这是我解决问题的方法。我将 iframe src 属性留空，并且仅在调用 dialog() 之后才使用 jquery 对其进行初始化。我想，这样 IE 稍后会加载 iframe 内容，在这种情况下，问题不会出现。这是修改后的代码：

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script type="text/javascript" src="http://code.jquery.com/ui/1.8.24/jquery-ui.min.js"></script>
<title></title>
    <script type="text/javascript">
        $(document).ready(function() {
            $("#dialog").dialog();
            $("#iframe1").attr("src", "jqtest2.htm");
        });
    </script>
</head>
<body>
    <div id="dialog">
        <iframe id="iframe1" src=""></iframe>
    </div>
</body>
</html> 
```

iframe html 文件保持不变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-22T14:38:42.650

```
function waitForjQuery(){
    if(typeof jQuery!='undefined'){
        //Do yor stuff!
    }
    else{
        setTimeout(function(){
            waitForjQuery();
        },500);
    }
}
waitForjQuery(); 
```

# php - 尽管我没有收到任何 mysql 错误，但 mysql_query 更新不起作用

> ID：14965913
> 
> 赞同：0
> 
> 时间：2013-02-19T19:37:22.097
> 
> 标签：php, mysql, sql-update

我刚刚为 mysql 数据库编写了一个更新查询。问题既不是显示任何 mysql 错误，也不是更新行。my_sql_rows 总是输出假，这意味着我的表中没有任何更新代码如下

```
if(isset($_POST['update_subject']))
{  
    $id  = $_POST['id'];
    $menu_name  = $_POST['menu_name'];
    $visible  = $_POST['visible'];
    $position  = $_POST['position'];
    $content  = $_POST['content'];

    mysql_query("UPDATE subjects SET menu_name ='$menu_name', visible = $visible, position = $position,
                    content =    '$content'  WHERE id =  $id ")
                     or die("updation of '$menu_name' in table subjects failed due to : " . mysql_error ());
    if(mysql_affected_rows == 1 ) {
        echo "Updation of '$menu_name' in table subjects is done successfully !!! ";
    } else {
        echo "something went wrong. updation process is halted.";
    }   
} 
```

它总是返回我“出了点问题。更新过程已停止”我知道 mysql 命令已经过时但我仍然想学习。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:42:32.813

Ita是因为您使用了不将括号与您的if语句合并的禁忌做法，此外还需要函数后的括号

```
if(mysql_affected_rows() == 1 ){
    echo "Updation of '$menu_name' in table subjects is done successfully !!! ";
}
else{
    echo "something went wrong. updation process is halted.";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T19:42:06.920

`mysql_affected_rows`是函数，因此你需要在它后面加上括号，例如：

```
$result = mysql_query($yourquery);
if(mysql_affected_rows($result) === 1) {
  // logic
} 
```

现在继续弃用垃圾邮件......

[`ext/mysql`不应该用于新项目](http://www.php.net/manual/en/intro.mysql.php)：

> 此扩展自 PHP 5.5.0 起已弃用，不推荐用于编写新代码，因为它将在未来被删除。相反，应该使用 mysqli 或 PDO_MySQL 扩展。在选择 MySQL API 时，另请参阅 MySQL API 概述以获得更多帮助。

相反，您应该使用[`mysqli`](http://www.php.net/manual/en/book.mysqli.php)or[`PDO`](http://www.php.net/manual/en/book.pdo.php)与 mysql 驱动程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T19:43:57.430

几件事，

1.  `UPDATE`如果它们是字符串，查询需要`'`在列值周围加上引号。所以检查查询。

    ```
    mysql_query("UPDATE subjects SET menu_name ='$menu_name', visible = '$visible', position = '$position', content = '$content'  WHERE id =  '$id' ") 
    ```

2.  `mysql_affected_rows`是一个函数，所以它必须是，

    ```
    if(mysql_affected_rows() == 1 ) 
    ```

**注意：**不推荐使用 Mysql_* 扩展。如果可能，使用`Mysqli`或。`PDO`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T19:53:12.493

如果您想使用 PDO + 更简洁的代码来实现这一点，请尝试：

```
<?php
try {
    $db = new PDO("mysql:host=127.0.0.1;dbname=databasename", 'dbuser', 'dbpassword');
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $db->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
}catch (Exception $e){
    die('Cannot connect to mySQL server.');
}

if($_SERVER['REQUEST_METHOD']=='POST' && isset($_POST['update_subject'])){
    if(!empty($_POST['id'])){

        $sql = "UPDATE subjects SET menu_name = :menu_mame,
                                    visible   = :visible,
                                    position  = :position,
                                    content   = :content
                                WHERE id = :id";

        $update = array(':menu_name'=>$_POST['menu_name'],
                        ':visible'=>$_POST['visible'],
                        ':position'=>$_POST['position'],
                        ':content'=>$_POST['content'],
                        ':id'=>$_POST['id']);

        $query = $db->prepare($sql);
        $query->execute($update);

        $affected = $query->rowCount();

        if($affected > 0 ){
            echo htmlspecialchars($_POST['menu_name'])." updated successfully !!!";
        }else{
            echo "Something went wrong or no rows were found tobe updated";
        }
    }
}
?> 
```

# .net - 点“。”的用法 推特标签中的符号

> ID：14965916
> 
> 赞同：1
> 
> 时间：2013-02-19T19:37:33.597
> 
> 标签：.net, twitter, hashtag

在关于主题标签的官方[Twitter 常见问题解答](https://support.twitter.com/articles/49309-what-are-hashtags-symbols)中，不清楚点“。”是如何使用的。可以使用符号。

一个简单的比较：#.net VS #dotnet（我指的是 Microsoft .NET Framework）。

大多数主题标签分析器站点似乎第一个主题标签获得了更多搜索结果。但是，官方 Twitter.com 并没有突出显示包含点作为链接的主题标签，因此您无法单击它并搜索类似的推文。

我想知道使用点“。”是个好主意。推文标签中的字符以便更好地理解并将其总长度缩短 2 个字符（“。”VS“点”）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-19T19:55:39.510

由于带有点的主题标签不会出现在搜索中，因此这些主题标签在当前系统中无效是理所当然的。

此博客条目指出了您可以和不能（或不应该）做的一些事情：http: [//andrewtaylr.tumblr.com/post/1448457139/five-ways-you-are-doing-twitter-wrong](http://andrewtaylr.tumblr.com/post/1448457139/five-ways-you-are-doing-twitter-wrong)

# c++ - 试图将 c# 转换为 c++

> ID：14965918
> 
> 赞同：-2
> 
> 时间：2013-02-19T19:37:44.753
> 
> 标签：c++, type-conversion

```
byte[] len = BitConverter.GetBytes((ulong)text.Length);
Array.Reverse(len);
list.AddRange(len); 
```

不知道如何将此代码段转换为 C++，有什么帮助吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-19T19:50:44.613

```
//this is your list
std::list<char> list;
std::string     text;
//populate with whatever

constexpr count=sizeof(std::string::size_type);
std::array<char, count> len;

auto size=text.size();
std::memcpy(len.data(), &size, count);

list.insert(list.end(), len.rbegin(), lend.rend()); 
```

编辑：为 memset 获取错误的参数。现在修复了。

# c# - MasterPage 按钮单击事件不会在第一次单击时触发，而是在第二次单击时触发

> ID：14965921
> 
> 赞同：0
> 
> 时间：2013-02-19T19:37:48.303
> 
> 标签：c#, asp.net, events

您好，提前感谢您的帮助。这是我的问题：

*   我有一个网页，它分为 MasterPage 和 Main Page。
*   任何一个页面中的任何内容都不是动态设置的（没有代码隐藏），它们都是在 .aspx 页面上设置的。
*   在 MasterPage 上，我有一个“保存”按钮。
*   在主页上，我有几个文本框。
*   主页文本框有一个事件 (void SumAll(...))，当焦点离开这些复选框时会触发该事件。
*   在 MasterPage 上，我有一个连接到“保存”按钮的单击事件。

这就是发生的事情：

*   我对主页上的任何一个文本框进行了更改，但焦点不会离开此文本框（没有立即触发 SumAll() 事件）。
*   然后我单击 MasterPage 中的“保存”按钮。

我希望 MasterPage“保存”按钮单击事件会触发，但它永远不会触发！Main Page textchange (SumAll()) 事件会触发，但 MasterPage click 事件不会。

如果我再次单击 MasterPage“保存”按钮，MasterPage click 事件会成功触发，但当然不会触发 Main Page textchanged 事件。当我只单击 MasterPage“保存”按钮而不在主页上进行任何更改时也是如此。

这是我的代码示例。主页 textchanged 事件：

```
protected void SumTheAmounts(object sender, EventArgs e)
    {
        Decimal lease = 0.00M;
        Decimal securityDeposit = 0.00M;
        Decimal miscellanious = 0.00M;
        Decimal sumTotal = 0.00M;

        Decimal.TryParse(txtMiscellaneousAmount.Text, out miscellanious);
        Decimal.TryParse(txtSecurityDepositAmount.Text, out securityDeposit);
        Decimal.TryParse(txtLeaseAmount.Text, out lease);

        sumTotal = miscellanious + securityDeposit + lease;
        txtAmount.Text = sumTotal.ToString();

        // Set focus to the next textbox
        TextBox tb = (TextBox)sender;
        switch (tb.ID)
        {
            case "txtLeaseAmount":
                txtSecurityDepositAmount.Focus();
                break;
            case "txtSecurityDepositAmount":
                txtMiscellaneousAmount.Focus();
                break;
            case "txtMiscellaneousAmount":
                txtMiscellaneousAmount.Focus(); // Send back to the same. .
                break;
            default:
                break;
        }
    } 
```

而我的 MasterPage 的“保存”按钮点击事件：

```
 protected void btnSave_Click(object sender, EventArgs e)
    {
        // Save every little thing...
        switch (ContentPageLoaded)
        {
            case "CheckRequest":
                ((CheckRequest)ContentMain.Page).UpdateMe();
                break;
            case "PicturesLoad":
                ((PicturesLoad)ContentMain.Page).UpdateMe();
                break;
            default:
                break;
        }
    } 
```

标记：

```
<asp:Panel ID="pnlSave" CssClass="ButtonClass" runat="server">
   <asp:Button ID="btnSave" style="width:160px; font-size:small; position:relative; color:Blue; top: 0px; left: 0px;" runat="server" Text="Save" onclick="btnSave_Click" CausesValidation="False" /> 
</asp:Panel> 
```

页面加载：

```
if (!IsPostBack) 
{ 
   Button saveButton = (Button)Master.FindControl("btnSave"); 
   branchName = (string)Session["BranchName"]; 
   branchLegalData = new Classes.BranchLegalData(); 
   if ((branchName != null) && (branchName.Length > 0)) 
   { 
      FillThisPageData(); 
   } 
} 
else { } 
Master.ContentPageLoaded = "CheckRequest"; 
```

非常感谢任何帮助！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T00:14:10.850

这是在黑暗中拍摄的，但请尝试为所有文本框设置 autopostback="false"。我怀疑可能发生的情况是，当您将注意力集中在文本框上然后一口气单击按钮时，您正在触发两次回发。

仅当您将自动回发设置为 true 时才会发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:53:01.413

感谢大家！

在文本框上设置 autopostback="false" 有效！我认为发生的事情是，使用 autopostback="true" 文本框会触发它自己的文本更改事件，并且由于某种原因，MasterPage 按钮单击事件在那之后不会触发？！有人可以告诉我为什么文本框事件会触发而不是按钮事件吗？？？

无论如何，这个问题已经得到解决，我感谢所有的意见......你们摇滚！

史蒂夫

# c# - 在列表视图列中添加动态超链接

> ID：14965923
> 
> 赞同：1
> 
> 时间：2013-02-19T19:37:50.363
> 
> 标签：c#, wpf, listview, hyperlink

我用代码创建了一个列表视图，我希望第二列包含一个超链接，它打开默认浏览器并加载 url。

我像这样创建列表视图：

```
GridView myGridView = new GridView();
myGridView.AllowsColumnReorder = false;

ListView l1 = new ListView();

GridViewColumn gvc0 = new GridViewColumn();
gvc0.DisplayMemberBinding = new Binding("AA");
gvc0.Header = "A/A";
gvc0.Width = 30;
myGridView.Columns.Add(gvc0);
GridViewColumn gvc1 = new GridViewColumn();
gvc1.DisplayMemberBinding = new Binding("Description");
gvc1.Header = "Description";
gvc1.Width = 300;
myGridView.Columns.Add(gvc1);

l1.View = myGridView; 
```

我也像这样填写列表视图：

```
l1.Items.Add(new { AA = aa++, Description = descriptions}); 
```

我希望描述文本成为超链接。有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T20:47:40.477

在代码隐藏中，您可以创建`CellTemplate`：

```
GridView myGridView = new GridView();
myGridView.AllowsColumnReorder = false;

ListView l1 = new ListView();

GridViewColumn gvc0 = new GridViewColumn();
gvc0.DisplayMemberBinding = new Binding("AA");
gvc0.Header = "A/A";
gvc0.Width = 30;
myGridView.Columns.Add(gvc0);

GridViewColumn gvc1 = new GridViewColumn();
gvc1.Header = "Description";
gvc1.Width = 300;
FrameworkElementFactory fef = new FrameworkElementFactory(typeof(TextBlock));
FrameworkElementFactory hyperlinkHolder = new FrameworkElementFactory(typeof(Hyperlink));
hyperlinkHolder.SetBinding(Hyperlink.NavigateUriProperty, new Binding("Description"));
hyperlinkHolder.AddHandler(Hyperlink.RequestNavigateEvent, new RequestNavigateEventHandler(Hyperlink_RequestNavigate));
FrameworkElementFactory fef2 = new FrameworkElementFactory(typeof(TextBlock));
Binding placeBinding = new Binding();
fef2.SetBinding(TextBlock.TextProperty, placeBinding);
placeBinding.Path = new PropertyPath("Description");
hyperlinkHolder.AppendChild(fef2);
fef.AppendChild(hyperlinkHolder);
var dataTemplate = new DataTemplate();
dataTemplate.VisualTree = fef;
dataTemplate.DataType = typeof(ListViewItem);
gvc1.CellTemplate = dataTemplate;           
myGridView.Columns.Add(gvc1);

l1.View = myGridView; 
```

事件处理程序：

```
private void Hyperlink_RequestNavigate(object sender, RequestNavigateEventArgs e)
{
    Process.Start(new ProcessStartInfo(e.Uri.AbsoluteUri));
    e.Handled = true;
} 
```

您应该使用 XAML 来做到这一点，它比您在代码隐藏中定义的所有 GUI 的第一个解决方案更清楚。

```
<ListView Name="l1">
    <ListView.View>
        <GridView>
            <GridView.Columns>
                <GridViewColumn Header="A/A" Width="30" DisplayMemberBinding="{Binding AA}" />
                <GridViewColumn Header="Description" Width="300">
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock>
                                <Hyperlink NavigateUri="{Binding Description}" RequestNavigate="Hyperlink_RequestNavigate">
                                    <TextBlock Text="{Binding Description}" />
                                </Hyperlink>
                            </TextBlock>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
            </GridView.Columns>
        </GridView>
    </ListView.View>
</ListView> 
```

# c# - 浮点数格式问题

> ID：14965927
> 
> 赞同：0
> 
> 时间：2013-02-19T19:38:03.510
> 
> 标签：c#, string-formatting, tostring

我注意到当我将一个值格式化为货币时会出现一个舍入问题——一旦我通过某个阈值，十进制值就会改变。

这里有 3 个样本 - 第一个成功，但其他 2 个不成功，因为初始值增加了。

1)

```
float value = 10000.25;

value_as_string = value .ToString( "0,0.00", CultureInfo.InvariantCulture );

--> "10000.25";  // great 
```

2)

```
float value = 100000.25;

value_as_string = value .ToString( "0,0.00", CultureInfo.InvariantCulture );

--> "100,000.20"  // why 20 cents? 
```

3)

```
float value = 1000000.25;

value_as_string = value .ToString( "0,0.00", CultureInfo.InvariantCulture );

--> "1,000,000.00"  // where did my 25 cents go? 
```

请让我知道是否有解决方法。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:16:24.187

You lose precision because of the `float` value type. Use the `decimal` type:

```
decimal valueDec = 1000000.25M;

string valueDec_string = valueDec.ToString("0,0.00", System.Globalization.CultureInfo.InvariantCulture ); 
```

Output:

> 1,000,000.25

# c++ - C++ 中的继承和虚拟析构函数的问题

> ID：14965928
> 
> 赞同：0
> 
> 时间：2013-02-19T19:38:14.297
> 
> 标签：c++, inheritance, base-class, virtual-destructor

所以我有两个类，一个是抽象的，一个不是。

抽象类是Iterator，具体类是LinkedListIterator。两者的代码都在帖子的底部。

我遇到的问题是代码如下，我在析构函数的最后一行的 LinkedListIterator 中出现 1 个错误说

```
undefined reference to `Iterator<int>::~Iterator()' 
```

现在我尝试注释掉虚拟 ~Iterator() 析构函数，没有错误，但我收到警告说：

```
Class '[C@800c1' has virtual method 'remove' but non-virtual destructor 
```

所以我的问题是：抽象迭代器基类中是否需要一个虚拟析构函数？我读过你应该总是有一个，但在这种情况下，LinkedListIterator 中的析构函数只是设置值，它不会释放任何东西......

谢谢！

迭代器代码：

```
template<class T>
class Iterator {

    public:
        //~Constructors/Destructors------------//
        /*
         * Destroys necessary resources.
         */
        virtual ~Iterator() = 0;

        //~Methods-------------------//
        /*
         * Informs the user whether there are more elements to be iterated
         * over in a List.
         *
         * @return true if there are more elements to iterate over, false otherwise.
         */
        virtual bool hasNext() = 0;

        /*
         * Gets the next element to iterate over.
         *
         * @return the next element in the iteration.
         */
        virtual T next() = 0;

        /*
         * Adds an element to the List being iterated over.
         *
         * @param element the element to add.
         * @return true if successful, false otherwise.
         */
        virtual bool add(T element) = 0;

        /*
         * Removes the element last returned by next from
         * the List being iterated over.
         *
         * @return true if successful, false otherwise.
         */
        virtual bool remove() = 0;
}; 
```

相关 LinkedListIterator 代码（这是一个较长的类）：

```
template<class T>
class LinkedListIterator : public Iterator<T> {

    private:
        //~Data Fields---------------------------------//
        /*
         * Pointer to the node that the iterator is currently at.
         */
        Node<T>* current;
        /*
         * Pointer to the LinkedList being iterated through.
         */
        LinkedList<T>* list;
        /*
         * Boolean value indicating whether next has been called since
         * the last remove operation.
         */
        bool nextCalled;

    public:
        //~Constructors/Destructors------------------//
        /*
         * Constructor for LinkedListIterator, takes in a pointer to a Node
         * to initialize current to point to (intended to be the head of the
         * the LinkedList).
         *
         * @param theList pointer to the LinkedList being iterated through.
         */
        LinkedListIterator(LinkedList<T>* theList) {

            current = theList->head;
            list = theList;
            nextCalled = false;
        }

        /*
         * Destructor, resets pointer values to 0.
         */
        ~LinkedListIterator() {

            current = 0;
            list = 0;
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-19T19:41:57.713

您的基类应该有一个`virtual`析构函数，但不是*纯* `virtual`析构函数 (*)。

纯虚函数（即标记为`virtual`并在`= 0`其签名后附加后缀的函数）没有实现。然而，基类的析构函数总是需要被子类的析构函数调用，你应该为它提供一个定义（可能是一个空的）：

```
template<class T>
class Iterator {

    public:
        //~Constructors/Destructors------------//
        /*
         * Destroys necessary resources.
         */
        virtual ~Iterator() { }
    ... 
```

另请参阅**[StackOverflow 上的此问答以](https://stackoverflow.com/questions/630950/pure-virtual-destructor-in-c)**获取相关信息。

(*) 如链接的问答中所述，可以有一个纯虚拟析构函数（仍然需要定义），但我认为这不是一个特别好的编程实践。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-19T19:41:33.620

您需要为您的虚拟基础析构函数提供定义，无论它是否是纯析构函数。

```
virtual ~Iterator() { } 
```

应该修复它。

PS：仅供参考，有一个标准链接列表，std::list

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-19T19:42:00.770

尽管您的析构函数是纯虚拟的，但您*确实*需要在基类中提供一个实现以使该类型可用。

`Iterator`只需为;添加一个空的析构函数 您不需要丢失“纯”析构函数（尽管它没有多大意义，因为您已经拥有其他纯虚方法）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-19T20:05:04.410

其他人已经回答了如何解决您看到的错误，但是您的问题

> 我需要抽象迭代器基类中的虚拟析构函数吗？

尚未得到答复。

答案是这取决于您（和其他用户）打算如何使用这些类。没有`virtual`析构函数并没有错，一切都会正常工作，*直到*有人决定通过指针`delete`的实例。例如：`LinkedListIterator``Iterator`

```
Iterator<int> *iter = new LinkedListIterator<int>(...);
delete iter; // undefined behavior if Iterator destructor is not virtual 
```

但是，由于您正在实现一个迭代器类，因此动态分配实例的可能性应该很小，更不用说尝试对其进行多态删除了。但是，由于您已经拥有其他虚函数，因此我也想不出声明析构函数的缺点`virtual`。

# python - 在python cgi中获取表单字段的ID

> ID：14965930
> 
> 赞同：2
> 
> 时间：2013-02-19T19:38:19.343
> 
> 标签：python, cgi

我正在使用 Python 编程 CGI，发现 CGI 以名为 FieldStorage 的类的形式将信息传递给 Python。我遇到的 FieldStorage 类的主要属性是“getvalue”，用于从表单字段中获取数据。是否可以获取字段的 id 值？

编辑

我想知道我是否可以获得有关表单发送数据的一些独特信息。这是因为，我有一个表单和 2 个脚本。在表单中，我放置了项目详细信息，然后脚本 1 获取该数据并将其保存在数据库中。我有另一个脚本2，它查询已保存的项目数据，创建表单并使用数据填充表单以启用编辑项目，并且在用户编辑后，数据将更新回数据库。

更新回数据库是问题所在。我想使用脚本 1 进行更新，但在这种情况下，我不会执行 INSERT INTO ... 我将执行 UPDATE Table1 ... 现在，我如何知道哪个请求用于编辑或更新。我这样做是因为我在表单有 70 个字段的情况下创建另一个脚本只会复制 script1 并添加更新逻辑。这就是我想用脚本做的

脚本1.py

```
#!/usr/bin/env python

import cgi
import cgitb; cgitb.enable()     # for troubleshooting
import MySQLdb

form = cgi.FieldStorage()

#there are 70 fields
id = form.getfirst("id");
error = form.getfirst("error");
comment = form.getfirst("comment");
product_name = form.getfirst("product_name");
verified_product_name = form.getfirst("verified_product_name");
url = form.getfirst("url");
verified_url= form.getfirst("verified_url");
.
.
.
source = form.getfirst("source");

print 'Content-type: text/html\r\n\r'
print '<html>'
print 'Update Successfull ! !'
print '</html>'

db = MySQLdb.connect(host="localhost", user="root", passwd="", db="products")

cursor = db.cursor()
sql=""

### Check the request---How do i do this?

if update: ##if the request is for updating

sql = """UPDATE item SET (id=id, error=error, comment=comment, product_name=product_name, verified_product_name=verified_product_name, url=url, verified_url=verified_url, image_url=image_url,..., source=source)"""

else: ##if the request is for inserting

sql = """INSERT INTO item (id, error, comment, product_name, verified_product_name, url, verified_url, image_url, verified_image_url, brand, verified_brand, type, verified_type, price, min_price, max_price, verified_price,..., source) VALUES ('%s', '%s', "%s", '%s', '%s', '%s', '%s', '%s', '%s', '%s', '%s',..., '%s')""" %(id, error, comment, product_name, verified_product_name, url, verified_url, image_url, verified_image_url, brand,..., source)

try:
  cursor.execute(sql,(id, error, comment, product_name, verified_product_name, url, verified_url, image_url, verified_image_url, brand, verified_brand, type, verified_type, price, min_price, max_price, verified_price, measure_unit, ..., source))

   db.commit()
except Exception as err:

   db.rollback()

   db.autocommit(True)
cursor.execute(sql)
cursor.fetchall()
db.close() 
```

希望你能解决我的问题。我可以在不创建另一个脚本单独进行更新的情况下执行此操作吗？

# wcf - 将 MVC WebAPI 控制器转换为 WCF 服务

> ID：14965935
> 
> 赞同：0
> 
> 时间：2013-02-19T19:38:38.463
> 
> 标签：wcf, web-services, asp.net-mvc-4, asp.net-web-api, wcf-web-api

我必须复制一个 MVC4 WebAPI 应用程序，但我的只会回显发送给它的数据，所以我想知道我是否应该使用更简单的 WCF 服务，因为 MVC4 WebAPI 应用程序有很多文件。暴露的 API 非常简单：

```
public Task<HttpResponseMessage> PostData(HttpRequestMessage requestMessage) 
```

我有三个问题：

1.  是否可以从 MVC4 WebAPI 中删除所有额外的 .js 和其他文件，因为我只需要公开一个 API 而不需要任何视图？
2.  如果我要将它移植到 WCF，签名会是什么样子？

    [OperationContract] HttpResponseMessage PostData(HttpRequestMessage 请求)

3.  是否值得在 WCF 中编写 echo 服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:16:53.247

*不要*为此使用 WCF……而且我碰巧喜欢 WCF，所以这不是一个讨厌告诉你的人。

如果您的 MVC4 WebAPI 项目中有很多文件，我不确定出了什么问题。您根本不需要任何 /Content 或 /Views。你几乎只需要 /Controllers/MyController.cs 文件本身和映射到它的路由，它应该在默认的 /App_Start/WebApiConfig.cs 中。

# wcf - 从多个 WCF 服务引用中进行选择

> ID：14965940
> 
> 赞同：0
> 
> 时间：2013-02-19T19:38:52.833
> 
> 标签：wcf, wcf-binding

我想知道在单个应用程序中选择和/或在一组到不同端点的服务调用之间切换的最佳做法是什么。现在，我有一个非常笨拙的系统，其中有多个应用程序（.exe），每个应用程序都有不同的代码来针对其所需的服务运行。

我尝试在 app.config 中放置多个端点，但它弄乱了系统并且存在运行时异常。

谢谢 ！

# java - 从两个类中获取功能

> ID：14965942
> 
> 赞同：1
> 
> 时间：2013-02-19T19:39:01.367
> 
> 标签：java

假设我有一个抽象类 A 和一个抽象类 B：

```
abstract class A {
    public void doA(){
        //some stuff
    }
}

abstract class B{
    public void doB(){
        //some stuff
    }
} 
```

现在我想完成以下情况：

类`C`具有**仅** `A`
类`D`的功能，具有**仅** `B`
类`E`的功能，具有**两者** `A`的功能`B`。

我该怎么做？这在java中是否可能，因为一个不能扩展多个类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:40:05.710

Java 不支持多重继承。如果您想同时拥有 A 和 B 的功能，则必须将其中至少一个声明为接口。

要获得仅 A 的功能，例如。

```
public class C extends A {
    //your methods
} 
```

正如其他人所说，您的外观模式具有两个类的功能

假设 A 和 B 不是抽象的，因为您不能实例化抽象类。

```
public class Facade {
    private A mA = new A();
    private B mB = new B();

    private void doB() {
        mB.doB();
    }

    private void doA() {
        mA.doA(); // as long as these are visible
    }    
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T19:47:30.277

这是多态的情况。您应该使用接口和适配器模式来实现这一点。Mkae 确保您的`doB()`and`doA()`是抽象类中的最终方法。

```
interface IA {
    public void doA();
}

interface IB {
    public void doB();}
}

abstract class A implements IA {
    public final void doA() { ... }
}

abtstract class B implements IB {
    public final void doB() { ... }
}

class C extends A {
}

class D extends B {
}

class E implements IA, IB {
    IA a = new C();
    IB b = new D();
    public void doA() { a.doA(); }
    public void doB() { b.doB(); }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-19T19:55:33.427

这与其他答案非常相似，但不同之处在于它不尝试实例化抽象类。

相似的三个答案都是用Composition来解决问题的。有人称它为外观，另一种适配器。我称之为代理。我不确定哪个（如果有的话）是正确的。这三个中的重要事实是我们使用组合而不是继承。

从创建接口开始。例如：

```
public interface iA
{
  public void doA();
}

public interface iB
{
  public void doB();
} 
```

改变你的抽象类来实现这些接口

```
abstract class A implements iA
{
  public void doA()
  {
    ... blah ...
  }
}

abstract class B implements iB
{
  public void doB()
  {
    ... blah ...
  }
} 
```

创建 A 和 B 的具体版本（这里我将其作为 C 的内部类），在 C 中实现这两个接口，并将 C 类的调用 doA() 和 doB() 代理到具体实现。

```
public class C implements iA, iB
{
  private ConcreteA cA = new ConcreteA();
  private ConcreteB cB = new ConcreteB();

  public void doA()
  {
    cA.doA();
  }

  public void doB()
  {
    cB.doB();
  }

  private class ConcreteA extends A
  {
    public doA()
    {
      ... blah ...
    }
  }

  private class ConcreteB extends B
  {
    public doB()
    {
      ... blah ...
    }
  } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-19T20:07:46.350

```
abstract class A {
    public void doA(){
        // some stuff
    }
}

abstract class B{
    public void doB(){
        // some stuff
    }
}
class C {
    private A a; // assume getter/setter methods or constructor for initialization
    public void doA()
    {
        a.doA();
    }
}
class D {
    private B b;// assume getter/setter methods or constructor for initialization
    public void doB(){
        b.doB();
    }
}
class E{
    private A a;// assume getter/setter methods or constructor for initialization
    private B b;// assume getter/setter methods or constructor for initialization
    public void doAB(){
        a.doA();
        b.doB();
    }
} 
```

我建议您更多地研究抽象类和接口。要理解上述代码，您需要了解“策略模式”。阅读“策略模式”后，您将能够更精细地修改我给定的代码。我还没有完成接口编码，因为它会创建更复杂的东西来理解。

阅读“Head First Design Pattern”中的“Strategy Pattern”

# python - 在浏览器中打开 Google 搜索的脚本

> ID：14965946
> 
> 赞同：3
> 
> 时间：2013-02-19T19:39:21.597
> 
> 标签：python

我是一名编程新手，其经验仅限于用 Python 编写非常简单的程序。对于我的第一个“真实”项目的一部分，我想编写一个脚本，该脚本接受输入并打开一个浏览器窗口，并通过 Google 搜索该输入。我在海上如何做到这一点；我一直在摆弄像[这样](http://www.catonmat.net/blog/python-library-for-google-search/)的脚本的变体，但这会通过将结果打印到控制台来输出结果；出于我的目的，我希望输出实际上打开一个带有查询搜索结果的窗口（最终我还希望脚本截取浏览器窗口的屏幕截图并将其粘贴到 Word 文档中，但有一件事在一次）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-19T19:43:27.233

在 Python 中打开网页非常简单。

```
import webbrowser
url = "https://www.google.com.tr/search?q={}".format(search_term)    
webbrowser.open(url) 
```

为了提高可靠性，您可以将 search_term 传递给[`urlencode`](http://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlencode)first。

# postgresql - @> 运算符不适用于 int2[] 类型

> ID：14965947
> 
> 赞同：0
> 
> 时间：2013-02-19T19:39:24.587
> 
> 标签：postgresql

我有一列类型为 int2[] 数组。我想对此列进行 IN 查询。

我在谷歌上搜索它，发现 @> 运算符在数组列中搜索，但它似乎不适用于 int2 类型的数组列。但它适用于 int[]

有谁知道为什么它在 int2[] 上不起作用？

```
ecabuk=# CREATE TABLE "Test"("Column1" int2[]);
CREATE TABLE

ecabuk=# INSERT INTO "Test" VALUES ('{10, 15, 20}');
INSERT 0 1

ecabuk=# INSERT INTO "Test" VALUES ('{10, 20, 30}');
INSERT 0 1

ecabuk=# EXPLAIN ANALYZE SELECT * FROM "Test" WHERE "Column1" @> ARRAY[20];
ERROR:  operator does not exist: smallint[] @> integer[]
LINE 1: ...LAIN ANALYZE SELECT * FROM "Test" WHERE "Column1" @> ARRAY[2...
                                                             ^
HINT:  No operator matches the given name and argument type(s). You might need to add explicit type casts.

ecabuk=# ALTER TABLE "Test" ALTER COLUMN "Column1" type int[];
ALTER TABLE

ecabuk=# EXPLAIN ANALYZE SELECT * FROM "Test" WHERE "Column1" @> ARRAY[20];
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Seq Scan on "Test"  (cost=0.00..26.38 rows=7 width=32) (actual time=0.200..0.204 rows=2 loops=1)
   Filter: ("Column1" @> '{20}'::integer[])
 Total runtime: 0.256 ms
(3 rows)

ecabuk=# 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T21:43:16.417

当您指定 ARRAY[20] 时，它会将其视为 int[] 而不是 int2[]。合适的演员表会让它表现得很好。

```
test=# EXPLAIN ANALYZE SELECT * FROM "Test" WHERE "Column1" @> ARRAY[2];
ERROR:  operator does not exist: smallint[] @> integer[]
LINE 1: ...LAIN ANALYZE SELECT * FROM "Test" WHERE "Column1" @> ARRAY[2...
                                                             ^
HINT:  No operator matches the given name and argument type(s). You might need to add explicit type casts.
test=# EXPLAIN ANALYZE SELECT * FROM "Test" WHERE "Column1" @> ARRAY[20::int2];
                                            QUERY PLAN

--------------------------------------------------------------------------------------------------
 Seq Scan on "Test"  (cost=0.00..26.38 rows=7 width=32) (actual time=0.060..0.064 rows=2 loops=1)
   Filter: ("Column1" @> '{20}'::smallint[])
 Total runtime: 0.116 ms
(3 rows)

test=# EXPLAIN ANALYZE SELECT * FROM "Test" WHERE "Column1" @> ARRAY[20]::int2[];
                                            QUERY PLAN

--------------------------------------------------------------------------------------------------
 Seq Scan on "Test"  (cost=0.00..26.38 rows=7 width=32) (actual time=0.028..0.032 rows=2 loops=1)
   Filter: ("Column1" @> '{20}'::smallint[])
 Total runtime: 0.080 ms
(3 rows) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T20:04:47.543

在这里工作。恐怕你需要提供一个失败的例子：

```
=> SELECT ARRAY[1,2,3]::int2[] @> ARRAY[1,2]::int2[];
 ?column? 
----------
   t
  (1 row)

=> SELECT ARRAY[1,2,3]::int2[] @> ARRAY[3,4]::int2[];
 ?column? 
----------
  f
 (1 row) 
```

如果它不起作用，那会很奇怪，因为它是在 anyarray 上定义的：

```
=> \do '@>'
                               List of operators

   Schema   | Name | Left arg type | Right arg type | Result type | Description 
------------+------+---------------+----------------+-------------+-------------
 pg_catalog | @>   | aclitem[]     | aclitem        | boolean     | contains
 pg_catalog | @>   | anyarray      | anyarray       | boolean     | contains
 ... 
```

在 9.1 和 9.2 中测试

# windows - 用于创建多个 m3u8 清单文件的批处理脚本

> ID：14965953
> 
> 赞同：0
> 
> 时间：2013-02-19T19:39:46.863
> 
> 标签：windows, batch-file

我试图创建一个批处理脚本来创建多个 m3u8 清单文件。这是我尝试做的一些伪代码

```
for (int i= 0; i < numberOfFiles; i++)
{
    write preset lines to file.
    for (int x = i x < i+10; x++)
    {
        write string + x in line to file
    }
    write end of file line to file
} 
```

这就是我到目前为止所拥有的。我遇到了内部 for 循环的问题。我怎样才能让它从 x 运行到 x + 10？

```
@echo on

setlocal enabledelayedexpansion

set x=0

for /L %%x IN (0,1,5) do (
set file="index%%x.m3u8"

@echo #EXTM3U>>!file!
@echo #EXT-X-TARGETDURATION:10>>!file!
@echo #EXT-X-VERSION:3>>!file!
@echo #EXT-X-MEDIA-SEQUENCE:0>>!file!
@echo #EXT-X-PLAYLIST-TYPE:VOD>>!file!

set n=%x%
for /L %%n IN (n, 1, %x%+10) do (
    @echo #EXTINF:10.00000,>>!file!
    @echo fileSequence!n!.ts>>!file!

)

@echo #EXT-X-ENDLIST>>!file!

) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T21:57:56.457

您似乎将环境变量与循环变量混淆了。两者没有任何关系。

尝试对脚本进行以下修改：

```
@echo on

setlocal enabledelayedexpansion

~~set x=0~~

for /L %%x IN (0,1,5) do (
set file="index%%x.m3u8"

@echo #EXTM3U>>!file!
@echo #EXT-X-TARGETDURATION:10>>!file!
@echo #EXT-X-VERSION:3>>!file!
@echo #EXT-X-MEDIA-SEQUENCE:0>>!file!
@echo #EXT-X-PLAYLIST-TYPE:VOD>>!file!

set **/a** n=**%%x+10**
for /L %%n IN (**%%x**, 1, **!n!**) do (
    @echo #EXTINF:10.00000,>>!file!
    @echo fileSequence**%%n**.ts>>!file!

)

@echo #EXT-X-ENDLIST>>!file!

) 
```

我不确定为什么要在开头设置 echo ，然后抑制单个`echo`s，但是您可以通过将抑制和重定向应用到块而不是单个命令来稍微简化脚本。特别是，`echo`主循环中的一系列 s 可以这样重写：

```
@(
    echo #EXTM3U
    echo #EXT-X-TARGETDURATION:10
    echo #EXT-X-VERSION:3
    echo #EXT-X-MEDIA-SEQUENCE:0
    echo #EXT-X-PLAYLIST-TYPE:VOD
)>>!file! 
```

内部循环的`echo`s 可以以类似的方式转换为块。当然，块内的缩进是可选的。

# security - 如何在多个位置重用 NGINX 代理设置

> ID：14965957
> 
> 赞同：10
> 
> 时间：2013-02-19T19:40:00.220
> 
> 标签：security, proxy, nginx, webserver, dry

我需要根据查询字符串参数限制对某些文件的访问。我有一个 NGINX 代理服务器，它位于其他几个 nginx Web 服务器的前面，用于负载平衡。我已决定在代理服务器级别强制执行此查询字符串参数，以合并配置更改。这给我的设置增加了一些复杂性，因为请求不能被困在 if 中，因为它需要被发送到上游。

```
server {
        listen 443;
        # SSL Settings

        server_name staging.xxxx.com;

        location / {
                proxy_pass http://webdav-cluster;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header X-Real-IP       $remote_addr;
                proxy_set_header Host            $http_host;
        }

        # Unless the correct application token is passed in as a query parameter
        # then deny access.
        location ~ \/protected\/.*txt$ {
                if ($arg_secret != abc) {
                        return 403;
                }

                proxy_pass http://webdav-cluster;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header X-Real-IP       $remote_addr;
                proxy_set_header Host            $http_host;
        }
} 
```

有没有办法将这 4 个代理行存储在一个位置或变量中，然后用一行在内部重定向到该位置？我也可以在不同的虚拟主机中使用相同的设置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T18:39:10.433

在这种情况下，您应该使用`include`指令： http: [//nginx.org/r/include](http://nginx.org/r/include)

# c# - 从任何电子邮件帐户向任何收件人发送电子邮件

> ID：14965965
> 
> 赞同：0
> 
> 时间：2013-02-19T19:40:16.973
> 
> 标签：c#, email, sendmail, send

您能否告诉我是否可以使用 C# 从**任何**电子邮件帐户向**任何**收件人发送电子邮件？我的意思是两者的 smtp 服务器是不同的。

我阅读了很多关于此的文章，尝试了不同的方法但没有效果。使用一种方法，我收到错误“邮箱不可用。服务器响应是：必须是本地收件人”。这意味着发件人和收件人应该来自同一个 smtp 服务器。

另一种方法来自[codeproject](http://www.codeproject.com/Articles/26663/Email-Sender)。很多时候，电子邮件不会发送给某个收件人，有时会发送 4 次而不是 1 次。这对所有电子邮件地址都不可靠。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T19:50:59.620

在 C# 中，您可以从任何帐户发送到任何帐户，*前提是 SMTP 服务器允许您将*. 您无法连接到随机 SMTP 服务器并期望从该服务器将邮件发送到其他服务器上的地址。这样的事情被称为开放中继，并且是（或至少曾经是）大量垃圾邮件的来源。

通常，如果您想使用 SMTP 服务器发送邮件，您必须使用您的用户名和密码登录（验证）。这样，ISP 就不会在不知不觉中促成垃圾邮件问题。登录后，您可以告诉 SMTP 服务器将您的邮件转发给在另一台服务器上拥有帐户的人。

如果您想将邮件发送到 name@somewhere.com 并且您无法登录到将为您进行中继的 SMTP 服务器，那么您需要直接连接到为某个域提供服务的 SMTP 服务器。即使那样，它也可能不接受您的邮件，具体取决于它的设置方式。SMTP 服务器通常会进行反向查找，以查看您的 IP 地址是否与已知（由 DNS 系统）处理 yourname@yourdomain.com 的邮件的 SMTP 服务器的 IP 地址匹配。

C# 中的 SMTP 支持将允许您连接到服务器、登录和发送邮件。服务器是否允许您这样做完全是另一回事。

# javascript - AngularJS 浏览器使用指令自动填充解决方法

> ID：14965968
> 
> 赞同：111
> 
> 时间：2013-02-19T19:40:23.790
> 
> 标签：javascript, mvvm, angularjs

在 AngularJS 中提交表单并使用浏览器记住密码功能时，在随后的登录尝试中，您让浏览器使用用户名和密码填写登录表单，`$scope`模型不会基于自动填充而更改。

我发现的唯一肮脏的黑客是使用以下指令：

```
app.directive("xsInputSync", ["$timeout" , function($timeout) {
    return {
        restrict : "A",
        require: "?ngModel",
        link : function(scope, element, attrs, ngModel) {
            $timeout(function() {
                if (ngModel.$viewValue && ngModel.$viewValue !== element.val()) {
                    scope.apply(function() {
                        ngModel.$setViewValue(element.val());
                    });
                }
                console.log(scope);
                console.log(ngModel.$name);
                console.log(scope[ngModel.$name]);
            }, 3000);
        }
    };
}]); 
```

问题是`ngModel.$setViewValue(element.val());`不会根据`element.val()`返回值更改模型或视图。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-02-19T20:25:50.803

[显然，这是 Angular 的一个已知问题，目前是开放的](https://github.com/angular/angular.js/issues/1460)

除了像您正在尝试的某种工作之外，我不确定您可以在这里做什么。看来你在正确的轨道上。我无法让我的浏览器尝试记住您的 plunk 密码，所以我不确定这是否可行，但请看一下：

```
app.directive('autoFillSync', function($timeout) {
   return {
      require: 'ngModel',
      link: function(scope, elem, attrs, ngModel) {
          var origVal = elem.val();
          $timeout(function () {
              var newVal = elem.val();
              if(ngModel.$pristine && origVal !== newVal) {
                  ngModel.$setViewValue(newVal);
              }
          }, 500);
      }
   }
}); 
```

```
<form name="myForm" ng-submit="login()">
   <label for="username">Username</label>
   <input type="text" id="username" name="username" ng-model="username" auto-fill-sync/><br/>
   <label for="password">Password</label>
   <input type="password" id="password" name="password" ng-model="password" auto-fill-sync/><br/>
   <button type="submit">Login</button>
</form> 
```

我认为你只需要稍微简化你的方法。我绝对推荐的一件事是检查`ngModel.$pristine`并确保您没有覆盖一些糟糕的用户输入。此外，3 秒可能太长了。您不必在 $timeout 中调用 $apply()，顺便说一句，它应该自动为您排队 $digest。

**真正的问题：你的浏览器会在执行方面击败 Angular 吗？我的浏览器呢？**

这可能是一场无法取胜的战争，这就是为什么 Angular（或 Knockout）无法轻易解决它的原因。在指令初始执行时，无法保证输入中的数据状态。甚至在 Angular 初始化的时候都没有……所以这是一个很难解决的问题。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2014-01-12T09:22:35.870

这是一个比其他解决方案更简单的解决方案，并且在语义上是合理的 AngularJS：http: [//victorblog.com/2014/01/12/fixing-autocomplete-autofill-on-angularjs-form-submit/](http://victorblog.com/2014/01/12/fixing-autocomplete-autofill-on-angularjs-form-submit/)

```
myApp.directive('formAutofillFix', function() {
  return function(scope, elem, attrs) {
    // Fixes Chrome bug: https://groups.google.com/forum/#!topic/angular/6NlucSskQjY
    elem.prop('method', 'POST');

    // Fix autofill issues where Angular doesn't know about autofilled inputs
    if(attrs.ngSubmit) {
      setTimeout(function() {
        elem.unbind('submit').submit(function(e) {
          e.preventDefault();
          elem.find('input, textarea, select').trigger('input').trigger('change').trigger('keydown');
          scope.$apply(attrs.ngSubmit);
        });
      }, 0);
    }
  };
}); 
```

然后，您只需将指令附加到您的表单：

```
<form ng-submit="submitLoginForm()" form-autofill-fix>
  <div>
    <input type="email" ng-model="email" ng-required />
    <input type="password" ng-model="password" ng-required />
    <button type="submit">Log In</button>
  </div>
</form> 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2013-11-08T08:28:13.197

您不必使用 a`$timeout`或类似的东西。您可以使用事件系统。

我认为它更 Angularish 并且不依赖于 jQuery 或自定义事件捕获。

例如在您的提交处理程序上：

```
$scope.doLogin = function() {
    $scope.$broadcast("autofill:update");

    // Continue with the login.....
}; 
```

然后你可以有一个`autofill`这样的指令：

```
.directive("autofill", function () {
    return {
        require: "ngModel",
        link: function (scope, element, attrs, ngModel) {
            scope.$on("autofill:update", function() {
                ngModel.$setViewValue(element.val());
            });
        }
    }
}); 
```

最后，您的 HTML 将如下所示：

```
<input type="text" name="username" ng-model="user.id" autofill="autofill"/> 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-09-05T13:47:10.790

**无需再破解！**Angular dev **[tbosch](https://github.com/tbosch)**制作了一个 polyfill，当浏览器更改表单字段而不触发更改事件时触发更改事件：

[https://github.com/tbosch/autofill-event](https://github.com/tbosch/autofill-event)

目前他们不会将其构建到 Angular 代码中，因为这是浏览器的错误修复，并且在没有 Angular 的情况下也可以工作（例如，对于普通的 jQuery 应用程序）。

“polyfill 将检查文档加载时的更改以及留下输入时的更改（仅以相同的形式）。但是，如果您愿意，可以手动触发检查。

该项目有单元测试和半自动测试，所以我们终于有一个地方可以收集所有不同的用例以及所需的浏览器设置。

请注意：这个 polyfill 适用于普通的 AngularJS 应用程序、AngularJS/jQuery 应用程序以及不使用 Angular 的普通 jQuery 应用程序。”

它可以安装：

```
bower install autofill-event --save 
```

在页面中的 jQuery 或 Angular`autofill-event.js` **之后**添加脚本。

这将执行以下操作：

*   在 DOMContentLoaded 之后：检查所有输入字段
*   剩下一个字段：检查同一表单中的所有其他字段

API（手动触发检查）：

*   `$el.checkAndTriggerAutoFillEvent()`：对给定的 jQuery / jQLite 元素中的所有 DOM 元素执行检查。

## 这个怎么运作

1.  记住用户对输入元素的所有更改（监听更改事件）以及 JavaScript（通过拦截 jQuery / jQLite 元素的 $el.val() ）。更改后的值存储在私有属性中的元素上。

2.  检查元素是否自动填充：将元素的当前值与记住的值进行比较。如果不同，则触发更改事件。

## 依赖项

AngularJS 或 jQuery（与其中之一或两者一起使用）

更多信息和来源在[github 页面](https://github.com/tbosch/autofill-event)。

[可以在此处阅读](https://github.com/angular/angular.js/issues/1460)Github 上的原始 Angular Issue #1460 。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-05-28T20:33:28.227

脏代码，在使用此代码之前检查问题[https://github.com/angular/angular.js/issues/1460#issuecomment-18572604](https://github.com/angular/angular.js/issues/1460#issuecomment-18572604)是否已修复。该指令在字段填充时触发事件，不仅在提交之前（如果您必须在提交之前处理输入，则必须这样做）

```
 .directive('autoFillableField', function() {
    return {
                   restrict: "A",
                   require: "?ngModel",
                   link: function(scope, element, attrs, ngModel) {
                       setInterval(function() {
                           var prev_val = '';
                           if (!angular.isUndefined(attrs.xAutoFillPrevVal)) {
                               prev_val = attrs.xAutoFillPrevVal;
                           }
                           if (element.val()!=prev_val) {
                               if (!angular.isUndefined(ngModel)) {
                                   if (!(element.val()=='' && ngModel.$pristine)) {
                                       attrs.xAutoFillPrevVal = element.val();
                                       scope.$apply(function() {
                                           ngModel.$setViewValue(element.val());
                                       });
                                   }
                               }
                               else {
                                   element.trigger('input');
                                   element.trigger('change');
                                   element.trigger('keyup');
                                   attrs.xAutoFillPrevVal = element.val();
                               }
                           }
                       }, 300);
                   }
               };
}); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-11-22T16:03:06.540

似乎是明确的直接解决方案。不需要 jQuery。

**更新：**

*   仅当模型值不等于实际输入值时才更新模型。
*   检查不会在第一次自动填充时停止。例如，如果您希望使用其他帐户。

* * *

```
app.directive('autofillable', ['$timeout', function ($timeout) {
    return {
        scope: true,
        require: 'ngModel',
        link: function (scope, elem, attrs, ctrl) {
            scope.check = function(){
                var val = elem[0].value;
                if(ctrl.$viewValue !== val){
                    ctrl.$setViewValue(val)
                }
                $timeout(scope.check, 300);
            };
            scope.check();
        }
    }
}]); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-05-28T18:36:26.293

**解决方案 1 [使用 $timeout]：**

*指示：*

```
app.directive('autoFillSync', function($timeout) {
    return {
      require: 'ngModel',
      link: function(scope, elem, attrs, model) {
          var origVal = elem.val();
          $timeout(function () {
              var newVal = elem.val();
              if(model.$pristine && origVal !== newVal) {
                  model.$setViewValue(newVal);
              }
          }, 500);
      }
    };
}); 
```

*HTML：*

```
<form name="myForm" ng-submit="login()">
  <label for="username">Username</label>
  <input type="text" id="username" name="username" ng-model="username" auto-fill-sync/><br/>
  <label for="password">Password</label>
  <input type="password" id="password" name="password" ng-model="password" auto-fill-sync/><br/>
  <button type="submit">Login</button>
</form> 
```

**解决方案 2 [使用角度事件]：**

参考：[Becko 的回答](https://stackoverflow.com/users/1372111/bekos)

*指示：*

```
app.directive("autofill", function () {
    return {
        require: "ngModel",
        link: function (scope, element, attrs, ngModel) {
            scope.$on("autofill:update", function() {
                ngModel.$setViewValue(element.val());
            });
        }
    };
}); 
```

*HTML：*

```
<form name="myForm" ng-submit="login()">
  <label for="username">Username</label>
  <input type="text" id="username" name="username" ng-model="username" autofill/><br/>
  <label for="password">Password</label>
  <input type="password" id="password" name="password" ng-model="password" autofill/><br/>
  <button type="submit">Login</button>
</form> 
```

**解决方案3【使用中继方法调用】：**

*指示：*

```
app.directive('autoFill', function() {
    return {
        restrict: 'A',
        link: function(scope,element) {
            scope.submit = function(){
                scope.username = element.find("#username").val();
                scope.password = element.find("#password").val();
                scope.login();//call a login method in your controller or write the code here itself
            }

        }
    };
}); 
```

*HTML：*

```
<form name="myForm" auto-fill ng-submit="submit()">
   <label for="username">Username</label>
   <input type="text" id="username" name="username" ng-model="username" />
   <label for="password">Password</label>
   <input type="password" id="password" name="password" ng-model="password" />
   <button type="submit">Login</button>
</form> 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-09-06T21:31:27.480

嗯，最简单的方法是模拟浏览器的行为，所以如果更改事件有问题，请自己触发它。简单得多。

指示：

```
yourModule.directive('triggerChange', function($sniffer) {
    return {
        link : function(scope, elem, attrs) {
            elem.on('click', function(){
                $(attrs.triggerChange).trigger(
                    $sniffer.hasEvent('input') ? 'input' : 'change'
                );
            });
        },
        priority : 1
    }
}); 
```

HTML：

```
<form >
    <input data-ng-model="user.nome" type="text" id="username">

    <input data-ng-model="user.senha" type="password" id="password" >

    <input type="submit" data-ng-click="login.connect()" id="btnlogin" 
           data-trigger-change="#password,#username"/>
</form> 
```

您可以做一些变化，例如将指令放在表单上，​​并在表单提交时使用 .dirty 类在所有输入上触发事件。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-10-22T04:46:04.893

**这是 jQuery 方式：**

```
$(window).load(function() {
   // updates autofilled fields
   window.setTimeout(function() {
     $('input[ng-model]').trigger('input');
   }, 100);
 }); 
```

**这是角方式：**

```
 app.directive('autofill', ['$timeout', function ($timeout) {
    return {
        scope: true,
        require: 'ngModel',
        link: function (scope, elem, attrs, ctrl) {
            $timeout(function(){
                $(elem[0]).trigger('input');
                // elem.trigger('input'); try this if above don't work
            }, 200)
        }
    }
}]); 
```

**HTML**

```
<input type="number" autofill /> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-03-24T01:43:48.013

这是我发现的唯一解决方案，它允许我的所有 Angular 验证按设计工作，包括禁用/启用提交按钮。使用 bower 和 1 个脚本标签安装。巴津加！

[https://github.com/tbosch/autofill-event](https://github.com/tbosch/autofill-event)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-06-19T19:11:22.433

这是另一种不那么棘手的解决方法，但需要在控制器中添加一些额外的代码。

HTML：

```
<form ng-submit="submitForm()" ng-controller="FormController">
    <input type="text" ng-model="username" autocomplete-username>
    <input type="submit">
</form> 
```

指令（CoffeeScript）：

```
directives.directive 'autocompleteUsername', ->
    return (scope, element) ->
        scope.getUsername = ->
            element.val() 
```

控制器：

```
controllers.controller 'FormController', [->
    $scope.submitForm = ->
        username = $scope.getUsername?() ? $scope.username
        # HTTP stuff...
] 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-08-21T00:14:47.883

更改模型值，而不是使用超时功能对我有用。

这是我的代码：

```
module.directive('autoFill', [ function() {
    return {
        require: 'ngModel',
        link:function(scope, element, attr, ngModel) {
            var origVal = element.val();
            if(origVal){
                ngModel.$modelValue = ngModel.$modelValue || origVal;
            }
        }
    };
}]); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-10-18T16:21:37.047

提交处理程序中的单行解决方法（需要 jQuery）：

```
if (!$scope.model) $scope.model = $('#input_field').val(); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-10-16T17:45:57.327

我在提交时强制使用 $setValue(val()) ：（这在***没有***jQuery 的情况下有效）

```
 var ValidSubmit = ['$parse', function ($parse) {
    return {
        compile: function compile(tElement, tAttrs, transclude) {
            return {
                post: function postLink(scope, element, iAttrs, controller) {
                    var form = element.controller('form');
                    form.$submitted = false;
                    var fn = $parse(iAttrs.validSubmit);
                    element.on('submit', function(event) {
                        scope.$apply(function() {
                            var inputs = element.find('input');
                            for(var i=0; i < inputs.length; i++) {
                                var ele = inputs.eq(i);
                                var field = form[inputs[i].name];
                                field.$setViewValue(ele.val());
                            }
                            element.addClass('ng-submitted');
                            form.$submitted = true;
                            if(form.$valid) {
                                fn(scope, {$event:event});
                            }
                        });
                    });
                    scope.$watch(function() { return form.$valid}, function(isValid) {
                        if(form.$submitted == false) return;
                        if(isValid) {
                            element.removeClass('has-error').addClass('has-success');
                        } else {
                            element.removeClass('has-success');
                            element.addClass('has-error');
                        }
                    });
                }
            }
        }
    }
}]
app.directive('validSubmit', ValidSubmit); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-03-20T20:34:22.507

对此答案的小修改（[https://stackoverflow.com/a/14966711/3443828](https://stackoverflow.com/a/14966711/3443828)）：使用 $interval 而不是 $timeout 这样您就不必与浏览器竞争。

```
mod.directive('autoFillSync', function($interval) {
    function link(scope, element, attrs, ngModel) {
        var origVal = element.val();
        var refresh = $interval(function() {
          if (!ngModel.$pristine) {
            $interval.cancel(refresh);
          }else{
            var newVal = element.val();
            if (origVal !== newVal) {
              ngModel.$setViewValue(newVal);
              $interval.cancel(refresh);
            }
          }
        }, 100);
    }

    return {
      require: 'ngModel',
      link: link
    }
  }); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-04-24T00:27:23.027

这是一个简单的修复程序，适用于我在 Firefox 和 Chrome 中测试过的所有情况。请注意，对于最佳答案（带超时的指令），我遇到了问题 -

*   浏览器后退/前进按钮，不要重新触发页面加载事件（因此修复不适用）
*   在页面加载后的某个时间加载凭据。例如，在 Firefox 中，双击登录框并从存储的凭据中进行选择。
*   需要一个在提交表单之前更新的解决方案，因为我禁用登录按钮，直到提供有效输入

此修复程序显然非常愚蠢和hacky，但它在100％的时间内都有效 -

```
function myScope($scope, $timeout) {
    // ...
    (function autoFillFix() {
        $timeout(function() { 
            $('#username').trigger('change'); 
            $('#password').trigger('change'); 
            autoFillFix(); }, 500);                    
    })();
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-02-05T09:17:20.533

我对 Angularjs 很陌生，但我找到了一个解决该问题的简单方法=> 强制 Angular 重新评估表达式……通过更改它！（当然你需要记住初始值才能恢复到初始状态）这是在你的控制器函数中提交表单的方式：

```
 $scope.submit = function () {
                var oldpassword = $scope.password;
                $scope.password = '';
                $scope.password = oldpassword;
//rest of your code of the submit function goes here... 
```

当然，密码输入中输入的值是由 windows 设置的，而不是用户设置的。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-04-10T11:13:53.343

没有指令的解决方案：

```
.run(["$window", "$rootElement", "$timeout", function($window, $rootElement, $timeout){

        var event =$window.document.createEvent("HTMLEvents");
        event.initEvent("change", true, true);

        $timeout(function(){

            Array.apply(null, $rootElement.find("input")).forEach(function(item){
                if (item.value.length) {
                    item.$$currentValue = item.value;
                    item.dispatchEvent(event);
                }
            });

        }, 500);
    }]) 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-04-08T10:58:18.823

这是我最终在表单中使用的解决方案。

```
.directive('autofillSync', [ function(){
  var link = function(scope, element, attrs, ngFormCtrl){
    element.on('submit', function(event){
      if(ngFormCtrl.$dirty){
        console.log('returning as form is dirty');
        return;
      }   
      element.find('input').each(function(index, input){
        angular.element(input).trigger('input');
      }); 
    }); 
  };  
  return {
    /* negative priority to make this post link function run first */
    priority:-1,
    link: link,
    require: 'form'
  };  
}]); 
```

表单的模板将是

```
<form autofill-sync name="user.loginForm" class="login-form" novalidate ng-submit="signIn()">
    <!-- Input fields here -->
</form> 
```

通过这种方式，我能够运行我在 ng-model 上拥有的任何解析器/格式化程序，并使提交功能透明。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-03-20T10:21:04.880

你可以试试这段代码：

```
yourapp.directive('autofill',function () {

    return {
        scope: true,
        require: 'ngModel',
        link: function (scope, elem, attrs, ctrl) {
            var origVal = elem.val();
            if (origVal != '') {
                elem.trigger('input');
            }
        }
    }
}); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-06-12T19:06:42.630

这些解决方案都不适用于我的用例。我有一些表单字段使用 ng-change 来观察变化。使用`$watch`没有帮助，因为它不是由自动填充触发的。因为我没有提交按钮，所以没有简单的方法来运行一些解决方案，而且我没有成功使用间隔。

我最终禁用了自动填充 - 并不理想，但对用户来说不会那么混乱。

```
<input readonly onfocus="this.removeAttribute('readonly');"> 
```

[在这里](https://stackoverflow.com/a/24247840/856498)找到了答案

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2013-10-21T15:48:16.303

如果您使用的是 jQuery，您可以在表单提交时执行此操作：

HTML：

```
<form ng-submit="submit()">
    <input id="email" ng-model="password" required 
           type="text" placeholder="Your email">
    <input id="password" ng-model="password" required 
           type="password" placeholder="Password">
</form> 
```

JS：

```
 $scope.submit = function() {
     $scope.password = $('#password').val();
} 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2014-10-04T07:17:30.870

如果您想保持简单，只需使用 javascript 获取值

在您的 Angular js 控制器中：

var username = document.getElementById('username').value;

# javascript - 如何从 window.location.pathname 获取文件名

> ID：14965970
> 
> 赞同：0
> 
> 时间：2013-02-19T19:40:32.880
> 
> 标签：javascript, file

如何使用 javascript 获取文件名：window.location.pathname

```
window.location.pathname = G:\AS\Asf\ASF\RSSIMS\welcome.hta 
```

id 像 var x = welcome.hta

如何获取文件名？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T19:42:15.473

你不能 - 这是一个不向客户端公开的**服务器属性。**

# ruby-on-rails - 为什么删除 () 用于 ruby 条件抛出错误？

> ID：14965971
> 
> 赞同：2
> 
> 时间：2013-02-19T19:40:35.883
> 
> 标签：ruby-on-rails, ruby

```
if (ax_response = OpenID::AX::FetchResponse.from_success_response openid_response) 
```

如果我删除 ( ) 括号，上面的行会引发语法错误 ..Unexpected tIdentifier 。为什么 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T19:53:05.750

Ruby 非常擅长学习任意语法，但如果没有括号来指导它，有时它无法弄清楚你的意图。在这种情况下，您有两个选择。

`if`语句周围的括号：

```
if (var = method arg)
end 
```

参数周围的括号：

```
if var = method(arg)
end 
```

如果没有某种形式的指导，它将无法锁定您陈述的确切含义。如果您来自 Perl、C++ 或 JavaScript 等括号不是可选的背景，这绝不是问题。Ruby 异常宽容。

# python - 如何使用列键访问 jinja 模板中的 SQLalchemy 对象

> ID：14965973
> 
> 赞同：2
> 
> 时间：2013-02-19T19:40:53.600
> 
> 标签：python, sqlalchemy, flask, jinja2

我有一个`reference`带有 columns的表`id, parent, number, href`，当我想访问该表的特定行时，我将查询对象传递给`render_template`方法，如下所示：

```
render_template('home.html',\
               ref = db.session.query(reference).filter(reference.parent == 1).all()) 
```

现在，每当我想访问第一个返回的行时，我都会使用

```
{{ ref[0].href }} 
```

我应该怎么做才能将**键**从更改`0`为说`number`列的值。我需要这个来访问模板中的行，而不是按它们的顺序，而是按它们的列值，即

```
{{ ref['column_value'].href }} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T21:27:12.130

您可以将您的收藏加载到字典中：

```
ref_by_number = dict(
  (row.number, row)
  for row in db.session.query(reference).filter(reference.parent == 1)
) 
```

然后您可以访问您想要使用的内容`ref_by_number[number]`（这假设`number`属性是唯一的）。

# c - 使用 SIGUSR1 的两个进程之间的 Posix 可靠信号

> ID：14965975
> 
> 赞同：1
> 
> 时间：2013-02-19T19:41:04.153
> 
> 标签：c, signals, posix, kill

我必须在两个不同的终端上运行进程（服务器和客户端）。客户端读取用户输入，将其保存到文件（hello.txt），发出 SIGUSR1 信号，然后休眠。服务器然后唤醒，读取文件（hello.txt），打印它，向客户端发出信号它工作，然后休眠。客户端然后唤醒，打印成功，然后等待另一个用户输入。

稍后还有更多内容，但这就是我目前想要完成的全部。我很难在两个独立的、不相关的进程之间找到使用 sigaction 和 SIGUSR1 的示例。这是我到目前为止的代码：

服务器.c

```
#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>

volatile sig_atomic_t myFlag = 0;
static void myHandler(int);
struct sigaction newAction, oldAction;

int main(int argc, char* argv[])
{
    //setup signal stuff
    sigset_t zeromask;
    sigemptyset(&newAction.sa_mask);
    sigemptyset (&oldAction.sa_mask);
    sigemptyset(&zeromask);
    newAction.sa_flags = 0;
    newAction.sa_handler = myHandler;
    sigaddset (&newAction.sa_mask, SIGUSR1);
    if ( sigaction(SIGUSR1, &newAction, &oldAction))
            return;

    for ( ; ; ) {
            //Loop
            //This is so I can manually enter the pid into the client 
            printf("%d\n",getpid());
            while(myFlag == 0)
                    sigsuspend (&zeromask);
            myFlag = 0;
            printf("Got signal, process it\n");

    //signal occured process it
    }

    sigprocmask (SIG_SETMASK, &oldAction.sa_mask, NULL);
    exit(0);
    }

static void myHandler(int sigNo) {
    myFlag = 1;

    printf("finally made it");
    sigprocmask (SIG_BLOCK, &newAction.sa_mask, &oldAction.sa_mask);
    return;
} 
```

客户端.c

```
#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>

volatile sig_atomic_t myFlag = 0;
static void myHandler(int);
struct sigaction newAction, oldAction;

int main(int argc, char* argv[])
{
    printf("begin\n");
    //Signal stuff 
    sigset_t zeromask;
    sigemptyset(&newAction.sa_mask);
    newAction.sa_flags = 0;
    newAction.sa_handler = myHandler;
    sigemptyset (&oldAction.sa_mask);
    sigemptyset(&zeromask);
    sigaddset (&newAction.sa_mask, SIGUSR1);
    if ( sigaction(SIGUSR1, &newAction, &oldAction))
            return;
    sigprocmask (SIG_BLOCK, &newAction.sa_mask, &oldAction.sa_mask);

    //loop
    for ( ; ; ) {
            printf("This is where you would get user input\n");
            //Signal Server
            //For now I just manually enter the pid that was printed out when I ran server.c. This does not work and I do not think it is the right thing to do 
            kill(27514,SIGUSR1);
            //loop while waiting for server to respond
            while(myFlag == 0)
                    sigsuspend (&zeromask);

            myFlag = 0;
            printf("this is where you would process return signal\n");
    //signal occured process it
    }

    sigprocmask (SIG_SETMASK, &oldAction.sa_mask, NULL);
    exit(0);
    }

    static void myHandler(int sigNo) {
          myFlag = 1;
          sigprocmask (SIG_BLOCK, &newAction.sa_mask, &oldAction.sa_mask);
          return;
    } 
```

现在，所有这些代码应该做的就是从客户端向服务器发送信号。从那里我将实施其余的。但是，这不起作用，我似乎无法弄清楚。

kill 是用来实现 SIGUSR1 的正确命令吗？我是否需要知道每个客户端和服务器的 PID 才能进行通信？我完全只是在做错事吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T20:57:02.007

您尚未说明实际发生的情况，但要回答您的问题：

“kill 是用来执行 SIGUSR1 的正确命令吗？” 是的。

“我是否需要知道每个客户端和服务器的 PID 才能进行通信？” 是的。

“我完全只是在做错事吗？” 是的。

使用信号的主要问题是 1）它在程序执行的任何时候到达，2）你只准备在特定时间处理它。

您上面的代码只有在信号恰好在 sigsuspend() 中等待时才会正确处理它。这不是每时每刻都是真的！当您处于循环的其他部分时，即当您向另一个进程发送 kill() 时，请考虑如果另一个进程 kill() 在您再次到达 sigsuspend 之前返回会发生什么......您赢了不要等待信号，它会来来去去。您的实现不可靠。

更可靠的实现是在进程之间使用套接字连接；您可以通过这种连接传递信号甚至数据本身。事实上，有很多方法可以做到这一点，请参阅[http://en.wikipedia.org/wiki/Inter-process_communication](http://en.wikipedia.org/wiki/Inter-process_communication)（您似乎正在使用上面的 POSIX 接口）。

结果是信号是异步的，会中断任何程序的流程，并且特定于您的程序，您并不总是为它做好准备，如果您错过它，它就消失了。使用套接字（或管道或其他具有实际文件描述符的东西），数据（您的信号）将导致 select() 或 poll() 返回，而不仅仅是飞过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T20:53:00.100

这确实不是客户端和服务器之间通信的最佳方式。您应该查看命名管道。

您的主要问题是`myFlag`客户端和服务器之间不共享。两个程序在独立内存中运行；如果您想以这种方式进行交流，则需要使用共享内存。（这将是命名管道的另一种选择。）

正如您所指出的，另一个问题是客户端没有简单的方法来发现服务器的 pid。确实没有一个好的方法可以做到这一点，尽管服务器可以将其 pid 存储在具有已知名称的文件中（许多这样做是为了使管理任务更容易），但这会产生许多可能比赛条件；无论如何，它都不是一个可靠的机制。同样，命名管道（或命名共享内存段）为同一主机上的进程之间的进程间通信提供了可靠的机制。

如果客户端和服务器可能在不同的机器上运行——一个非常常见的用例——你可能想要使用套接字，它也适用于单个主机。

# tomcat - Tomcat 不启动 OS X

> ID：14965977
> 
> 赞同：0
> 
> 时间：2013-02-19T19:41:08.837
> 
> 标签：tomcat

我使用此网页安装 Tomcat：[http ://wolfpaulus.com/journal/mac/tomcat7](http://wolfpaulus.com/journal/mac/tomcat7)

当我在终端中输入以下代码时，我会得到这些输出：

```
Trevor-Truogs-MacBook-Pro:~ trevortruog$ /Library/Tomcat/bin/startup.sh
Using CATALINA_BASE:   /Library/Tomcat
Using CATALINA_HOME:   /Library/Tomcat
Using CATALINA_TMPDIR: /Library/Tomcat/temp
Using JRE_HOME:        /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home
Using CLASSPATH:       /Library/Tomcat/bin/bootstrap.jar:/Library/Tomcat/bin/tomcat-juli.jar 
```

该网站说Tomcat应该在我运行启动脚本后启动，但是没有任何反应并且我没有收到任何错误消息。我的问题是为什么软件实际上没有启动？

# c# - 这是什么魔法？

> ID：14965984
> 
> 赞同：4
> 
> 时间：2013-02-19T19:41:42.977
> 
> 标签：c#, xml, linq

我最近看到了臭名昭著的 Jon Skeet 关于使用 LINQ to XML 的帖子。这个特殊的代码片段引起了我的注意：

```
// Customers is a List<Customer>
XElement customersElement = new XElement("customers",
    customers.Select(c => new XElement("customer", //This line is "magic"
        new XAttribute("name", c.Name),
        new XAttribute("lastSeen", c.LastOrder)
        new XElement("address",
            new XAttribute("town", c.Town),
            new XAttribute("firstline", c.Address1),
            // etc
    )); 
```

我决定在我的应用程序中自己测试它，在那里我设置了一个 foreach 循环，如下所示：

```
foreach (var kvp in m_jobs) {    //m_jobs is a Dictionary<string,Job>
    m_xmlDoc.Root.Element("SCHED_TABLE").Add(
        kvp.Value.GenerateXmlNode())
    );
} 
```

我修改为：

```
m_xmlDoc.Root.Element("SCHED_TABLE").Add(
    m_jobs.Select(job => job.Value.GenerateXmlNode())
}; 
```

其中 GenerateXmlNode() 是一种为特定作业项生成适当 XML 标记的方法。我不确定会发生什么，但你瞧，它的工作原理与我的 foreach 循环完全一样。我不太明白的是为什么？！另外，这被认为是 LINQ 的“滥用”还是“功能”？

**为清楚起见进行编辑：**我知道 .Select 将返回一个 IEnumerable ，其中包含我所要求的内容，但我没有明确列举它。我了解 .Add 的工作原理，因为它接受可变数量的参数，但同样，我没有明确枚举传递这些参数。那么......它仍然如何工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T19:51:56.200

该`XElement.Add`方法在引擎盖下看起来像这样：

```
public void Add(object content)
{
    if (content is IEnumerable)
    {
        foreach (object child in (IEnumerable)content)
            Add(child);
    }
    else
    {
        //process individual element
    }
} 
```

因此，虽然从 的公共接口中不清楚，但`Add`您可以将一系列项目或单个项目传递给它，它会在运行时确定它是哪个并采取相应的行动。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-19T19:48:38.873

没有魔法；该`Add`方法接受 a`object`或 a `params object[]`- 并且在内部它简单地检查每个输入的一系列常见场景，包括`IEnumerable`等。然后它简单地展开序列，添加它发现的子元素/属性。LINQ（在这种情况下）`IEnumerable`从 中返回一个序列`Select`，这使得它完全可用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T20:01:02.540

`Select`是一种[LINQ](http://msdn.microsoft.com/en-us/library/bb397933.aspx) [扩展方法](http://msdn.microsoft.com/en-us/library/vstudio/bb383977.aspx)，可以应用于任何实现`IEnumerable<T>`. 作为参数，它接受委托或[lambda 表达式](http://msdn.microsoft.com/en-us/library/bb397687.aspx)（此处为 lambda 表达式）。这个 lambda 表达式定义了一个 ad-hoc 函数，该函数应用于集合的每个元素。这些元素在`c`这里表示。`Select`产生一个`IEnumerable<U>`where`U`是 lambda 表达式返回的项目的类型。换句话说，通过 lambda 表达式（此处为 Customer 到 XElements）将类型元素`Select`转换为类型`T`元素。`U`

由于`XElement`构造函数的第二个参数也接受枚举，因此这种“魔法”是可能的。

```
public XElement(
    XName name,
    Object content
) 
```

`content`可以是其中`IEnumerable<XElement>`之一。`System.Xml.Linq`命名空间非常灵活。还有一个隐式转换 from `string`to`XName`允许您将字符串作为第一个参数传递。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T00:50:06.927

这个问题，其实是由**三个为什么**组成的。在**魔术最大的秘密最终揭开**之前，我们首先需要**破解魔术师的密码**，这样我们才能看穿问题：

```
Func<Customer, XElement> selector=
    c => {
        var xe=new XElement("address",
            new XAttribute("town", c.Town),
            new XAttribute("firstline", c.Address1)
            // , etc
            );

        return
            new XElement("customer", // This line is a part of the "magic"
                new XAttribute("name", c.Name),
                new XAttribute("lastSeen", c.LastOrder),
                xe
                );
    };

XElement customersElement=new XElement("customers", customers.Select(selector)); // This line is another part of the "magic" 
```

该类`Customer`假定在 、 和 的字段`LastOrder`或属性`Address1`中。以下是分开的问题和答案：`Town``Name`

> **Q1** : 看了你眼前一亮的代码片段，为什么`IEnumerable`不用你明确列举就可以访问 an 中 element 的成员？

**A1**：元素通过**lambda 表达式**传递。也就是说，传递给的参数`Select`是一个委托。因此，您可以访问通过`c`. 我们在委托中调用的构造函数是 的重载`XElement(XName name, params object[] content)`，您可以传递对象`XAttribute`或`XElement`。

> **Q2**`Add` ：使用代码的两种不同语法的片段，为什么带有投影可枚举的语句`Select`像调用`XElement`带有选定可枚举的构造函数一样产生与代码使用相同的结果`foreach`？

**A2** : `IEnumerable`or`IEnumerable<T>`作为对象传递给 的重载构造函数`XElement`和`Add`继承自 的方法`XContainer`。

> **Q3**：根据Q2，为什么`IEnumerable`在已经作为对象传递的情况下仍然可以枚举？

**A3**：一个类的实例总是**它的一个（n）个**实例，即使你用更大的类型、泛型类型或接口传递它。虽然在这里我们没有遇到界面问题，但我建议看一下[ [this answer](https://stackoverflow.com/questions/14562047/generic-type-parameter-covariance-and-multiple-interface-implementations/14712923#14712923) ]以了解这一点。在 的代码中`XContainer.Add(object content)`，传递的 an 参数`IEnumerable`将使用以下代码进行处理：

```
IEnumerable enumerable=content as IEnumerable;

if(enumerable!=null) {
    foreach(object element in enumerable) {
        this.Add(element);
    }
}
else {
    this.AddString(GetStringValue(content));
} 
```

但是，如果`content`是一个数组，而不是`as IEnumerable`它，将使用以下代码进行处理（也许是为了获得性能）：

```
object[] objArray=content as object[];

if(objArray!=null) {
    foreach(object element in objArray) {
        this.Add(element);
    }
} 
```

您可能想知道为什么即使传递一个数组也会调用`XContainer.Add(object content)`，这是因为`Add`for 数组的重载是：

```
public void Add(params object[] content) {
    this.Add(content);
} 
```

现在，你知道它是如何完成的了。

# java - 将 Tomcat 上的 Spring Security 和 Waffle 与角色检查集成

> ID：14965989
> 
> 赞同：4
> 
> 时间：2013-02-19T19:41:58.010
> 
> 标签：java, windows, spring, tomcat, spring-security

正如标题所示，我正在尝试使用角色在 Tomcat 上集成 Spring Security 和 Waffle。该应用程序将部署到 Windows 环境中，用户已经通过域身份验证并且我想执行单点登录。更进一步，我想检查经过身份验证的用户所属的组并配置拦截器以防止不是已批准组成员的用户访问 Web 应用程序。

这是应用程序上下文的样子：

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:cache="http://www.springframework.org/schema/cache"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xmlns:sec="http://www.springframework.org/schema/security"
xmlns:context="http://www.springframework.org/schema/context"
xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security-3.1.xsd
http://www.springframework.org/schema/mvc
http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
http://www.springframework.org/schema/context
http://www.springframework.org/schema/context/spring-context-3.0.xsd
http://www.springframework.org/schema/cache http://www.springframework.org/schema/cache/spring-cache-3.1.xsd">

<mvc:annotation-driven />
<cache:annotation-driven />
<import resource="mvc-config.xml"/>

<!--WAFFLE CONFIG-->

<!-- windows authentication provider -->
<bean id="waffleWindowsAuthProvider" class="waffle.windows.auth.impl.WindowsAuthProviderImpl" />

<!-- collection of security filters -->
<bean id="negotiateSecurityFilterProvider" class="waffle.servlet.spi.NegotiateSecurityFilterProvider">
    <constructor-arg ref="waffleWindowsAuthProvider" />
</bean>

<bean id="waffleSecurityFilterProviderCollection" class="waffle.servlet.spi.SecurityFilterProviderCollection">
    <constructor-arg>
        <list>
            <ref bean="negotiateSecurityFilterProvider" />
            <ref bean="basicSecurityFilterProvider" />
        </list>
    </constructor-arg>
</bean>

<!-- spring filter entry point -->
<sec:http use-expressions="true" entry-point-ref="negotiateSecurityFilterEntryPoint">
    <sec:intercept-url pattern="/**" access="hasRole('APP_USER')" />
    <sec:custom-filter ref="waffleNegotiateSecurityFilter" position="BASIC_AUTH_FILTER" />
</sec:http>

<bean id="basicSecurityFilterProvider" class="waffle.servlet.spi.BasicSecurityFilterProvider">
    <constructor-arg ref="waffleWindowsAuthProvider" />
</bean>   

<bean id="negotiateSecurityFilterEntryPoint" class="waffle.spring.NegotiateSecurityFilterEntryPoint">
    <property name="Provider" ref="waffleSecurityFilterProviderCollection" />
</bean>

<!-- spring authentication provider -->
<sec:authentication-manager alias="authenticationProvider" />

<!-- spring security filter -->
<bean id="waffleNegotiateSecurityFilter" class="waffle.spring.NegotiateSecurityFilter">
    <property name="Provider" ref="waffleSecurityFilterProviderCollection" />
    <property name="AllowGuestLogin" value="false" />
    <property name="PrincipalFormat" value="fqn" />
    <property name="RoleFormat" value="both" />
</bean>

<!--END WAFFLE CONFIG-->

<!-- the mvc resources tag does the magic -->
<mvc:resources mapping="/css/**" location="/css/" />
<mvc:resources mapping="/js/**" location="/js/" />
<mvc:resources mapping="/img/**" location="/img/" />

    <bean id="multipartResolver"
    class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
    <property name="maxUploadSize" value="1000000" />
</bean>

    <bean id="excelExportView" class="com.mycompany.appname.view.ExcelExportView"></bean>

<context:component-scan base-package="com.mycompany.appname" />
    <bean id="cacheManager" class="org.springframework.cache.support.SimpleCacheManager">
        <property name="caches">
        <set>
            <bean class="org.springframework.cache.concurrent.ConcurrentMapCacheFactoryBean" p:name="columnNames"/>
        </set>
        </property>
    </bean>

    <beans profile="dev">
        <bean id="dataSource" destroy-method="close" class="org.apache.commons.dbcp.BasicDataSource">
            <qualifier value="internal"/>
            <property name="driverClassName" value="${jdbc.driverClassName}" />
            <property name="url" value="${jdbc.internal.url}" />
            <property name="username" value="${jdbc.internal.username}" />
            <!--<property name="password" value="${jdbc.internal.password}"/>-->
            <property name="minEvictableIdleTimeMillis" value="120000"/>
            <property name="testOnBorrow" value="true" />
            <property name="timeBetweenEvictionRunsMillis" value="120000"/>
            <property name="minIdle" value="1"/>
        </bean>

        <bean id="dataSourceExternal" destroy-method="close" class="org.apache.commons.dbcp.BasicDataSource">
            <qualifier value="external"/>
            <property name="driverClassName" value="${jdbc.driverClassName}" />
            <property name="url" value="${jdbc.external.url}" />
            <property name="username" value="${jdbc.external.username}" />
            <!--<property name="password" value="${jdbc.external.password}"/>-->
            <property name="minEvictableIdleTimeMillis" value="120000"/>
            <property name="testOnBorrow" value="true" />
            <property name="timeBetweenEvictionRunsMillis" value="120000"/>
            <property name="minIdle" value="1"/>
        </bean>
        <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
                <property name="location" value="/WEB-INF/db-dev.properties"></property>
        </bean>
    </beans>

    <beans profile="test">
        <bean id="dataSource" destroy-method="close" class="org.apache.commons.dbcp.BasicDataSource">
            <qualifier value="internal"/>
            <property name="driverClassName" value="${jdbc.driverClassName}" />
            <property name="url" value="${jdbc.internal.url}" />
            <property name="minEvictableIdleTimeMillis" value="120000"/>
            <property name="testOnBorrow" value="true" />
            <property name="timeBetweenEvictionRunsMillis" value="120000"/>
            <property name="minIdle" value="1"/>
        </bean>

        <bean id="dataSourceExternal" destroy-method="close" class="org.apache.commons.dbcp.BasicDataSource">
            <qualifier value="external"/>
            <property name="driverClassName" value="${jdbc.driverClassName}" />
            <property name="url" value="${jdbc.external.url}" />
            <property name="minEvictableIdleTimeMillis" value="120000"/>
            <property name="testOnBorrow" value="true" />
            <property name="timeBetweenEvictionRunsMillis" value="120000"/>
            <property name="minIdle" value="1"/>
        </bean>
        <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
                <property name="location" value="/WEB-INF/db-test.properties"></property>
        </bean>
    </beans>

    <beans profile="production">
        <bean id="dataSource" destroy-method="close" class="org.apache.commons.dbcp.BasicDataSource">
            <qualifier value="internal"/>
            <property name="driverClassName" value="${jdbc.driverClassName}" />
            <property name="url" value="${jdbc.internal.url}" />
            <property name="minEvictableIdleTimeMillis" value="120000"/>
            <property name="testOnBorrow" value="true" />
            <property name="timeBetweenEvictionRunsMillis" value="120000"/>
            <property name="minIdle" value="1"/>
        </bean>

        <bean id="dataSourceExternal" destroy-method="close" class="org.apache.commons.dbcp.BasicDataSource">
            <qualifier value="external"/>
            <property name="driverClassName" value="${jdbc.driverClassName}" />
            <property name="url" value="${jdbc.external.url}" />
            <property name="minEvictableIdleTimeMillis" value="120000"/>
            <property name="testOnBorrow" value="true" />
            <property name="timeBetweenEvictionRunsMillis" value="120000"/>
            <property name="minIdle" value="1"/>
        </bean>
        <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
                <property name="location" value="/WEB-INF/db-prod.properties"></property>
        </bean>
    </beans> 
```

和 web.xml

```
<?xml version="1.0" encoding="ISO-8859-1"?> 
```

```
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<!-- Beans in these files will makeup the configuration of the root web application context -->
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/appname-servlet.xml</param-value>     
</context-param>

<context-param>
    <param-name>log4jConfigLocation</param-name>
    <param-value>/WEB-INF/log4j.properties</param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
</listener>

<!--  Protect against XSS -->
<context-param>
    <param-name>defaultHtmlEscape</param-name>
    <param-value>true</param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener> 

<!-- Deploys the 'accounts' dispatcher servlet whose configuration resides in /WEB-INF/mvc-config.xml -->
<servlet>
    <servlet-name>appname</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/appname-servlet.xml</param-value>
    </init-param>
</servlet>

<!-- Maps all URLs to the 'appname' servlet -->
<servlet-mapping>
    <servlet-name>appname</servlet-name>
    <url-pattern>*.htm</url-pattern>
</servlet-mapping>

<!-- 
<error-page>
    <exception-type>java.lang.Exception</exception-type>
    <location>/error.jsp</location>
</error-page>
 -->
    <welcome-file-list>
        <welcome-file>/WEB-INF/views/appname_main.jsp</welcome-file>
    </welcome-file-list>     
<session-config>
    <session-timeout>60</session-timeout>
            <cookie-config>
              <http-only>true</http-only>
            </cookie-config>                
</session-config> 
```

现在发生的事情是所有尝试点击应用程序“appName”的结果都会立即提示进行身份验证。通过阅读 Waffle，我只能假设这是后备身份验证，因为它无法获取 Windows 令牌并对用户进行身份验证（通过失败的尝试或无效的凭据）。

以前的尝试包括不使用“hasRole”，而是使用

```
access="IS_AUTHENTICATED_FULLY" /> 
```

这不会检查用户的角色，但至少会根据域身份验证限制对应用程序的访问。不幸的是，在这种情况下，每次用户点击应用程序时，它仍然会提示用户。至少这种配置实际上允许域用户访问应用程序，不像“hasRole”方法每次都返回访问被拒绝。

任何见解将不胜感激...

[编辑：从我们的日志中添加一些细节]

事实证明，当我认为单点登录正在使用“IS_AUTHENTICATED_FULLY”时，我实际上得到了误报。浏览器正在缓存凭据并将其应用于请求，因此 SSO 从未真正起作用。我总是得到提示。ROLE_USER 产生相同的结果：提示并接受凭据。

奇怪的是，我们在试图从华夫饼中提取一些细节时遇到了麻烦。我们在 Tomcat 的 conf logging.properties 中添加了以下几行：

```
waffle.servlet.NegotiateSecurityFilter.level = FINE
waffle.servlet.spi.SecurityFilterProviderCollection.level = FINE
waffle.servlet.spi.NegotiateSecurityFilterProvider.level = FINE
waffle.servlet.spi.BasicSecurityFilterProvider.level = FINE 
```

然而，localhost、catalina 等没有提供关于华夫饼的额外细节。

我们能找到的与角色相关的唯一日志信息是：

```
token:'org.springframework.security.authentication.AnonymousAuthenticationToken@905571d8:     Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details:     org.springframework.security.web.authentication.WebAuthenticationDetails@0:     RemoteIpAddress: 10.10.90.70; SessionId: null; Granted Authorities: ROLE_ANONYMOUS'>
2013-02-21 11:25:10,527 DEBUG [org.springframework.security.web.FilterChainProxy] -     </WEB-INF/views/ourappname_main.jsp at position 6 of 8 in additional filter chain; firing     Filter: 'SessionManagementFilter'>
2013-02-21 11:25:10,528 DEBUG [org.springframework.security.web.FilterChainProxy] -     </WEB-INF/views/ourappname_main.jsp at position 7 of 8 in additional filter chain; firing     Filter: 'ExceptionTranslationFilter'>
2013-02-21 11:25:10,528 DEBUG [org.springframework.security.web.FilterChainProxy] -     </WEB-INF/views/ourappname_main.jsp at position 8 of 8 in additional filter chain; firing     Filter: 'FilterSecurityInterceptor'>
2013-02-21 11:25:10,529 DEBUG    [org.springframework.security.web.access.intercept.FilterSecurityInterceptor] - <Secure     object: FilterInvocation: URL: /WEB-INF/views/ourappname_main.jsp; Attributes:     [IS_AUTHENTICATED_FULLY]>
   2013-02-21 11:25:10,529 DEBUG         [org.springframework.security.web.access.intercept.FilterSecurityInterceptor] - <Previously         Authenticated:        org.springframework.security.authentication.AnonymousAuthenticationToken@905571d8:         Principal: anonymous 
```

从 WFETCH 我们捕捉到了这一点：

```
User; Credentials: [PROTECTED]; 
Authenticated: true; 
Details: org.springframework.security.web.authentication.WebAuthenticationDetails@0: 
RemoteIpAddress: 10.10.10.10; 
SessionId: null; 
Granted Authorities: ROLE_ANONYMOUS>
http://10.10.10.10/ourappname/
Transfer-Encoding: chunked
Date: Thu, 21 Feb 2013 16:29:42 GMT 
```

[再次编辑] 请求失败呼叫的标头信息。值得注意的是，当使用 localhost 时，Waffle-filter 示例可以正常工作，无需用户提示。使用IP或域时，会提示。我猜这是系统管理/可信主机问题？

```
GET /ourappnameHTTP/1.1
Accept: text/html, application/xhtml+xml, */*
Accept-Language: en-US
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)
Accept-Encoding: gzip, deflate
Host: localhost:8080
Connection: Keep-Alive

HTTP/1.1 302 Found
Server: Apache-Coyote/1.1
Location: http://localhost:8080/ourappname/
Transfer-Encoding: chunked
Date: Thu, 21 Feb 2013 20:15:51 GMT

GET /ourappname/ HTTP/1.1
Accept: text/html, application/xhtml+xml, */*
Accept-Language: en-US
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)
Accept-Encoding: gzip, deflate
Host: localhost:8080
Connection: Keep-Alive

HTTP/1.1 401 Unauthorized
Server: Apache-Coyote/1.1
Set-Cookie: JSESSIONID=F2216F75CBA6AC8476189DA48A63A872; Domain=.domain.tld;     Path=/something/; HttpOnly
Connection: keep-alive
WWW -Authenticate: Negotiate
WWW-Authenticate: NTLM
WWW-Authenticate: Basic realm="BasicSecurityFilterProvider"
Transfer-Encoding: chunked
Date: Thu, 21 Feb 2013 20:15:51 GMT

GET /fismacm/ HTTP/1.1
Accept: text/html, application/xhtml+xml, */*
Accept-Language: en-US
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)
Accept-Encoding: gzip, deflate
Host: localhost:8080
Connection: Keep-Alive
Authorization: Negotiate     YHkGBisGAQUFAqBvMG2gMDAuBgorBgEEAYI3AgIKBgkqhkiC9xIBAgIGCSqGSIb3EgECAgYKKwYBBAGCNwICHqI5BDd    OVExNU1NQAAEAAACXsgjiBAAEADMAAAALAAsAKAAAAAYBsR0AAAAPVzJLOFIyLURFVjFHT0xE

HTTP/1.1 401 Unauthorized
Server: Apache-Coyote/1.1
Set-Cookie: JSESSIONID=2CC0FDBF578629857113C6A72EE67FF5; Domain=.domain.tld;     Path=/something/; HttpOnly
Connection: keep-alive
WWW-Authenticate: Negotiate
WWW-Authenticate: NTLM
WWW-Authenticate: Basic realm="BasicSecurityFilterProvider"
Transfer-Encoding: chunked
Date: Thu, 21 Feb 2013 20:15:51 GMT

GET /favicon.ico HTTP/1.1
Accept: */*
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)
Host: localhost:8080
Connection: Keep-Alive

HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Accept-Ranges: bytes
ETag: W/"21630-1349272326000"
Last-Modified: Wed, 03 Oct 2012 13:52:06 GMT
Content-Type: image/x-icon
Content-Length: 21630
Date: Thu, 21 Feb 2013 20:16:07 GMT 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-16T12:34:04.727

我今天遇到了同样的问题。

这个问题原来与Spring 安全上下文中生成的**GrantedAuthority的名称有关。**这将默认设置为 ROLE_"domain"\"role"，例如**ROLE_MYDOMAIN\MYROLE**。

这是您应该在 hasRole 检查中检查的名称。

请参阅以下文档：[https](https://github.com/Waffle/waffle/blob/master/Docs/spring/SpringSecurityAuthenticationProvider.md) ://github.com/Waffle/waffle/blob/master/Docs/spring/SpringSecurityAuthenticationProvider.md ，

**授予权限**

成功登录后，Waffle 将使用 GrantedAuthority 的实例填充 Spring Security 的 Authentication 对象。

默认情况下，Waffle 将使用以下内容填充 Authentication 对象：

带有字符串 ROLE_USER 的 GrantedAuthority。用户所属的每个组一个 GrantedAuthority。GrantedAuthority 字符串将是带有 ROLE_ 前缀的大写组名。例如，如果用户是Everyone 组的成员，他将获得ROLE_EVERYONE 授予的权限。可以通过在 waffleSpringAuthenticationProvider 上配置不同的 defaultGrantedAuthority 和 grantAuthorityFactory 来更改默认行为