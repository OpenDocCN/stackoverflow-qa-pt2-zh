# StackOverflow 问答 13420000-13420999

# php - 删除 cookie 数组中的值

> ID：13420002
> 
> 赞同：0
> 
> 时间：2012-11-16T15:54:21.467
> 
> 标签：php, arrays, cookies, shopping-cart

我有一个带有像这样的 json 项目的 cookie 数组

```
//set my cookie

setcookie("my_Cookie", $cookie_content, time()+3600);

//this is the content of my cookie for example with 2 items
[{"item_id":"9","item_tag":"AS","session_id":"554obe5dogsbm6l4o9rmfif4o5"},{"item_id":"6","item_tag":"TE","session_id":"554obe5dogsbm6l4o9rmfif4o5"}] 
```

工作流程就像一个购物车，我可以添加和删除项目。我网站上的一个“产品”包含：item_id、item_tag 和 session_id；

为了添加一个项目，cookie 将扩展为 item_id":"X","item_tag":"X","session_id":"X

现在，如果我单击删除，我想删除 cookie 中的当前三个值

我试试

unset($_COOKIE["my_Cookie", 'item_id'=> $item_id, 'item_tag'=> $item_tag, 'session_id'=> $session_id]); 但这不起作用

是否可以删除我的 cookie 的特定值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T15:58:49.707

像这样：

```
setcookie('cookie_name'); // Deletes the cookie named 'cookie_name'. 
```

这是有效的，因为设置一个没有值的 cookie 与删除它是一样的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T15:59:41.077

如果我没记错的话，你不能直接修改 cookie 的值；您必须读取该值，进行任何修改，然后使用相同的名称替换 cookie。

因此，在这种情况下，一旦用户点击删除链接，您的脚本应该保存他们想要删除的项目的 ID，读取 cookie 值，重写数组，然后用更新的值替换 cookie。

也许这个演示会有所帮助：

```
// Should be the user submitted value to delete.
// Perhaps a $_GET or $_POST value check.
$value_to_delete = 9;  

// Should be the cookie value from $_COOKIE['myCookie'] or whatever the name is.
// Decode from JSON values if needed with json_decode().
$cookie_items = array( 
    array("item_id" => 9, "item_tag" => "RN"), 
    array("item_id" => 6, "item_tag" => "RN"), 
    array("item_id" => 4, "item_tag" => "RN")
);

// Run through each item in the cart 
foreach($cookie_items as $index => $value)
{
    $key = array_search($value_to_delete, $value);

    if($key == "item_id")
    {
        unset($cookie_items[$index]);
    }
}

// Reset the index
$cookie_items = array_values($cookie_items);

// Set the cookie
setcookie($cookie_items);

// Debug to view the set values in the cookie
print_r($cookie_items); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:00:22.183

我相信一个 cookie 将简单地存储为一个字符串，所以你最好只是覆盖它......

# c# - 与事件共享对象

> ID：13420005
> 
> 赞同：1
> 
> 时间：2012-11-16T15:54:33.637
> 
> 标签：c#, asp.net, .net, events

目前我有一个包含大量项目（在运行时不会更改）的对象，它占用大量内存，并且该对象将在多个会话（每个用户）中使用，并且每个会话都应该相同。

因此，我决定将其用作共享资源，而不是复制大对象或在每个会话中创建一个新实例。这样每个会话都会从对象的列表中读取以获取项目并执行它需要对它们执行的操作。我想节省内存，因为这是一个 Web 应用程序。

但是，列表中的这些项目也有事件，每个会话都需要订阅这些事件。

因此，当一个项目事件被触发时，它会在所有会话中触发它。所以我不得不添加一些逻辑来检查哪个会话触发了这个事件并且只将它用于那个会话。

有一个更好的方法吗？更有效的方法？我担心，如果我有大量的用户会话，那么当这些共享项目上的事件被触发时，这将真正使处理陷入困境。

你怎么认为？另外值得注意的是，在处理这些“项目”时，无法知道每个项目需要多长时间，因此我倾向于使用事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:31:13.533

> 因此，当一个项目事件被触发时，它会在所有会话中触发它。所以我不得不添加一些逻辑来检查哪个会话触发了这个事件并且只将它用于那个会话。

这意味着，只要请求启动最终触发该事件的操作，共享数据中的事件仍然会被触发，但是您可以防止该事件冒泡到每个会话。尽管如此，这意味着在共享数据和所有会话之间创建事件处理程序。

> 有一个更好的方法吗？更有效的方法？我担心，如果我有大量的用户会话，那么当这些共享项目上的事件被触发时，这将真正使处理陷入困境。

您的解决方案确实会带来一些问题。由于事件处理程序是在会话和共享数据之间创建的，因此会话到期时无法对会话对象进行垃圾收集（我在这里假设您在会话到期时不清理事件处理程序，如果我错了请纠正我）。结果：内存泄漏。

> 你怎么认为？另外值得注意的是，在处理这些“项目”时，无法知道每个项目需要多长时间，因此我倾向于使用事件。

我不确定我明白你的意思。当您不知道每个事件需要多长时间时，为什么事件可以解决任何问题？事件及其事件处理程序仍按顺序执行。

恐怕我无法为此提供更好的解决方案，因为我不清楚会话应用程序之间如何共享共享数据。您在共享数据中提到了事件，但它们是如何工作的？您已经提到该事件应仅由启动该操作的会话处理，因此我认为一种解决方案是在您启动共享数据操作时为共享数据提供一个[回调函数。](http://msdn.microsoft.com/en-us/library/018hxwa8.aspx)然后可以在必要时调用回调函数，这样就不会创建将会话对象绑定到共享数据的事件处理程序，因此垃圾收集应该不是问题。

# asp.net - 如何为asp.net中的所有分辨率监视器设计一个网页？

> ID：13420008
> 
> 赞同：0
> 
> 时间：2012-11-16T15:54:35.743
> 
> 标签：asp.net

我的 asp.net Web 应用程序遇到了屏幕分辨率问题。我从设计专家那里得到了解决方案。解决方案之一是将 100% 宽度应用于所有表格和分区。我将 100% 的宽度应用于所有表格和分区。但我仍然面临着这个问题。在某些系统分辨率中，我的 Web 应用程序运行良好，没有任何拉伸。但在其他一些解决方案中，我的 Web 应用程序被拉伸了。如何纠正这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:00:49.217

您是否考虑过使用[Fluid 960 Grid](http://www.designinfluences.com/fluid960gs/)？

它基于[960 Grid](http://960.gs/)，但适用于所有分辨率。

准备好`CSS`文件后，您只需将 main 设置`div`为其中一个`container`类，然后将其中一个`grid`类应用于其子类。

就像是：

```
 <!-- this will give a 12 piece container -->
 <div class="container_12">

    <!-- all grids used should add up to 12 -->

    <!-- I.E this 4 piece grid -->
    <div class="grid_4">some content</div>
    <!-- plus this 8 piece = 12 -->
    <div class="grid_8">some more content</div>
    <!-- then clear the grids floating -->
    <div style="clear:both;"></div>

</div> 
```

深思熟虑。。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:13:28.163

将此作为 CSS 的问题来解决（因为该问题绝不是 asp.net 所特有的），处理这个问题的现代方法是设置所有你的宽度（以及左右边距和填充）元素使用百分比，按照您的指示，然后使用 CSS 媒体查询根据浏览器视口的宽度更改这些元素的样式。

这些可以像这样进入您的样式表的主体（与您的正常样式声明一起）：

```
@media screen and (max-width:800px){ /*rough viewport width for tablets */

/* style declarations go here, just 
 as they would in any other stylesheet, for example*/

#myDiv{ width:60%;}

}

@media screen and (max-width:480px){ /*rough viewport width for smartphones */

} 
```

或者，您可以将该分辨率的样式放在一个完全独立的样式表中，并有条件地调用该文件，如下所示：

```
<link rel='stylesheet' media='screen and (min-width: 701px) and (max-width: 900px)' href='css/medium.css' /> 
```

# javascript - 使用 jQuery 和 JSON 获取 feedburner 订阅者数量

> ID：13420021
> 
> 赞同：-2
> 
> 时间：2012-11-16T15:55:42.763
> 
> 标签：javascript, jquery, json, feedburner

我需要显示没有 PHP 的 feedburner 订阅者的总数。该脚本应该在标准的 HTML / jQuery 页面中工作。

像这样的东西：

```
        $(文档).ready(函数(){

            var username = "feeder_username";   
            var feedburnerurl = "http://query.yahooapis.com/v1/public/yql?q=SELECT%20*%20FROM%20xml%20WHERE%20url%3D'https%3A%2F%2Ffeedburner.google.com%2Fapi %2Fawareness%2F1.0%2FGetFeedData%3Furi%3D"+ 用户名 +"%26format%3Djson%26callback%3D'&format=json&callback=?";   

            $.getJSON（feedburnerurl，函数（数据）{                                             
                feed_count = data(['query']['results']['rsp']['feed']['entry'].circulation);  
                $('#feed').html(feed_count);
            });

        });             

```

你有一个可行的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:07:31.360

feedburner API 不再可用。据此： [https ://developers.google.com/feedburner/](https://developers.google.com/feedburner/)

所以你不能再这样了。。

# ruby - 切换到 postgres 适配器时，Sequel 默认示例失败

> ID：13420023
> 
> 赞同：0
> 
> 时间：2012-11-16T15:55:43.800
> 
> 标签：ruby, postgresql, sequel

我正在尝试从[http://sequel.rubyforge.org/](http://sequel.rubyforge.org/)运行 Sequel 示例。在 sqlite 上一切正常，但当我切换到 postgres 时失败。

这是连接代码：

```
DB = Sequel.connect(:adapter=>'postgres', :host=>'localhost', :database=>'testing', :user=>'postgres', :default_schema=>'sequel') 
```

这是我得到的错误：

```
postgres.rb:145:in `async_exec': PG::Error: ERROR:  relation "items" does not exist (Sequel::DatabaseError) 
LINE 1: INSERT INTO "items" ("price", "name") VALUES (12.45377636338... 
```

我怀疑问题是 Sequel 试图执行 INSERT INTO *"items"*而不是*"sequel.items"*，即使 :default_schema 设置正确。

有人知道我在做什么错吗？提前致谢。

编辑 - 这是使用的代码：

```
require "rubygems"
require "sequel"

# connect to an in-memory database
#DB = Sequel.sqlite
DB = Sequel.connect(:adapter=>'postgres', :host=>'localhost', :database=>'testing', :user=>'postgres', :default_schema=>'sequel')

# create an items table
DB.create_table :items do
  primary_key :id
  String :name
  Float :price
end

# create a dataset from the items table
items = DB[:items]

# populate the table
items.insert(:name => 'abc', :price => rand * 100)
items.insert(:name => 'def', :price => rand * 100)
items.insert(:name => 'ghi', :price => rand * 100)

# print out the number of records
puts "Item count: #{items.count}" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T09:26:06.357

看起来您缺少`password`connect 方法中的 （这是与文档示例的唯一区别）。密码通常只是用户名，因此如果您不确定密码是什么，请尝试使用。

还建议对每个项目使用不同的 postgresql 用户，这也使用户命名直观（项目名称）。避免潜在的名称冲突。

无论如何，看看这是否有效：

```
DB = Sequel.postgres 'testing', host: 'localhost', default_schema: 'sequel', 
       user: 'postgres', password: 'postgres' 
```

# c# - 未选中只是与编译时错误有关吗？

> ID：13420029
> 
> 赞同：2
> 
> 时间：2012-11-16T15:56:02.933
> 
> 标签：c#

[MSDN 示例](http://msdn.microsoft.com/en-us/library/a569z7k8(v=vs.71).aspx)只是编译时错误。

只是我看到@JonSkeet 在这里使用了它的答案：[https://stackoverflow.com/a/263416/360211](https://stackoverflow.com/a/263416/360211)我不明白为什么它只是编译时间。

```
 static void Main()
    {
        const int x = 4;
        int y = int.MaxValue;
        int z = x*y;
        Console.WriteLine(z);
        Console.ReadLine();
    } 
```

产生`-4`，与此相同：

```
 static void Main()
    {
        unchecked
        {
            const int x = 4;
            const int y = int.MaxValue;
            int z = x*y; // without unchecked, this is compile error
            Console.WriteLine(z);
            Console.ReadLine();
        }
    } 
```

这会引发运行时：

```
 static void Main()
    {
        checked
        {
            const int x = 4;
            int y = int.MaxValue;
            int z = x*y; //run time error, can checked be set system wide?
            Console.WriteLine(z);
            Console.ReadLine();
        }
    } 
```

那么 Jon 这样做是因为它可以设置系统范围、编译器标志或其他方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T15:58:14.763

绝对不。它确定如果操作溢出，是否*在执行时*抛出异常（[`OverflowException`](http://msdn.microsoft.com/en-us/library/system.overflowexception.aspx)） 。

 *例如，在[Noda Time](http://noda-time.googlecode.com)中，我们几乎在检查上下文中执行所有算术（这是项目默认设置）。然而，对于哈希码，我们总是使用一个`unchecked`块，因为哈希码计算溢出绝对没问题——值的大小并不重要；溢出不会影响正确性。

它仅在编译时与编译器可以*知道*由于涉及常量值而溢出的操作相关。

有关详细信息，请参阅 C# 4 规范的第 7.6.12 节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:00:51.883

在实际计算值时执行操作是否在 a`checked`或块中。`unchecked`当两个变量相乘/相加时，这几乎总是在运行时，因为它们在编译时是未知的。

在您的示例中，这两个变量都是常量；这意味着编译时文字之间的计算结果可以在编译时完成（确实如此）。由于结果是在编译时计算的，而且它不在一个`unchecked`块中，所以它不能在没有错误的情况下计算结果。这并不*意味着*检查/未检查块通常是编译时检查；他们很少。

是的，可以更改整个代码库是否处于选中/未选中上下文中的项目属性。如果您正在编写一个库，也可以从任一上下文中调用该方法。出于这个原因，如果有一个代码块*必须*在已检查或未检查的上下文中运行，那么添加这样的块是一个好习惯，即使您当前的项目设置对于该方法是正确的。此外，如果不出意外，它使该片段的意图对未来的读者更清楚，“此方法依赖于整数溢出”与“此方法绝不能溢出”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:09:03.183

通过转到以下位置设置既不`checked`或代码的默认行为：`unchecked`

> 项目属性->构建->高级->检查算术上溢/下溢

新项目的默认设置是关闭的，这就是我认为`unchecked`没有运行时影响的原因。*

# android - 带有活动的 TabHost 与带有片段的 ActionBar

> ID：13420031
> 
> 赞同：9
> 
> 时间：2012-11-16T15:56:22.603
> 
> 标签：android, android-fragments, android-actionbar, android-tabhost

我发现了一些与此问题相关的讨论，但没有明确或明确的。

构建一个基于选项卡的应用程序，似乎被迫在（A）为每个屏幕使用带有活动的 TabHost 和（B）为每个屏幕使用带有片段的 ActionBar 之间做出选择。这提出了几个问题：

1）这是真正的困境，还是可以将ActionBar与不同的活动一起使用。

2）如果困境是真实的，为什么事情会这样设置？Google 是否计划弃用 TabHost 和基于标签的导航的多活动方法？多活动方法有什么不好的地方吗？

3) 如果这两种方法都将继续得到支持，那么每种方法的优缺点是什么？如果我使用 ActionBar+Fragments，我会遇到任何问题吗？例如，当我希望我的一个选项卡式屏幕滑过/弹出另一个屏幕/片段时，我会在 ActionBar 中的选项卡之间切换到/从选项卡获得有趣的行为吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T19:47:52.543

您还可以使用带有片段的 TabHost 的第三个选项。这使得您只有一个活动和多个片段作为孩子。

[http://developer.android.com/reference/android/support/v4/app/FragmentTabHost.html](http://developer.android.com/reference/android/support/v4/app/FragmentTabHost.html)

我用这个类创建了一个简单的例子。

[https://github.com/marsucsb/nested-fragments](https://github.com/marsucsb/nested-fragments)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:06:42.517

我和你在一起。在 Fragments 出现之前，我就开始开发“Droid Bones”（一定要使用引号）。当我开始研究该架构时，它似乎无法满足我的结构要求。也就是说，我发现多活动方法非常流畅和灵活。我担心的是，一些 TabHost 文档最近似乎“消失了”！

# sql - “Y”上的“X”属性无法设置为“null”值。您必须将此属性设置为“Int32”类型的非空值

> ID：13420037
> 
> 赞同：32
> 
> 时间：2012-11-16T15:56:41.433
> 
> 标签：sql, visual-studio-2010, entity-framework

当我运行我的应用程序并单击特定按钮时，我收到错误消息：

```
"The "X" property on "Y" could not be set to a 'null' value. You must set this property to a non-null value of type 'Int32'." 
```

很酷，所以我去我的实体项目，去 Y 表，找到 X 列，右键单击并转到 X 的属性，发现 Nullable 设置为 False。

我在 SQL 中验证在 Y 表中，X 设置为允许空值，并且确实如此。

然后我回到我的实体项目，将 Nullable 设置为 True，保存并构建，我收到：

```
Error 3031: Problem in mapping fragments starting at line 4049:Non-nullable column "X" in table "Y" is mapped to a nullable entity property. 
```

我听说从 .edmx 文件中删除表然后重新添加它是可能的，但我从来没有这样做过，也没有充分理解这样做的含义。

我听说它可能在视图中，可能在存储过程中......

也听说这是一个bug。

有没有人遇到过这个问题并找到了“全面”修复或某种路线图来寻找这个错误？

谢谢！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-16T18:16:31.023

```
 "The "X" property on "Y" could not be set to a 'null' value. You must set this property to a non-null value of type 'Int32'." 
```

在您的 EDMX 中，如果您在 Y 表下单击 X 列，右键单击，单击属性，向下滚动到`Nullable`并从更改`False`为`True`。

如果您收到“映射片段”错误，则必须从 EDMX 中删除表并重新添加它，因为在模型浏览器中它存储表属性以及刷新该表的唯一方法（据我所知）是从模型浏览器中删除表，然后使用命令`<database>.Store`检索它。`Update Model from Database..`

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-05-27T11:19:50.527

我只是将数据类型替换`int`为`int32?`

```
public Int32 Field{ get; set; } 
```

到

```
public Int32? Field{ get; set; } 
```

问题就解决了

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-09T00:52:21.750

我的问题是我的模型数据库与实际（开发）数据库不同步。所以 EDMX 认为它是，`smallint`但实际的列是 int。我将模型数据库更新为`int`并将 EDMX 更新为`Int32`，现在它可以工作了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-01-07T17:02:10.433

对于未来的读者。

当我有一个多结果存储过程时出现此错误。

如此处所示：

[http://msdn.microsoft.com/en-us/data/jj691402.aspx](http://msdn.microsoft.com/en-us/data/jj691402.aspx)

如果您尝试访问第一个结果中的项目，在执行 a 之后`.NextResult`，您可能会收到此错误。

来自文章：

```
 var reader = cmd.ExecuteReader();

    // Read Blogs from the first result set
    var blogs = ((IObjectContextAdapter)db)
        .ObjectContext
        .Translate<Blog>(reader, "Blogs", MergeOption.AppendOnly);   

    foreach (var item in blogs)
    {
        Console.WriteLine(item.Name);
    }        

    // Move to second result set and read Posts
    reader.NextResult();
    var posts = ((IObjectContextAdapter)db)
        .ObjectContext
        .Translate<Post>(reader, "Posts", MergeOption.AppendOnly);

    foreach (var item in posts)
    {
        Console.WriteLine(item.Title);
    } 
```

现在，如果在行**之前**

```
foreach (var item in posts) 
```

你输入这段代码

```
Blog foundBlog = blogs.FirstOrDefault(); 
```

我认为您可以模拟错误。

经验法则：

你还是要把这个东西当成`DataReader`（消防水管）。

为了我的需要，我不得不转换为`List<>`.

所以我改变了这个：

```
 foreach (var item in blogs)
    {
        Console.WriteLine(item.Name);
    } 
```

对此：

```
 List<Blog> blogsList = blogs.ToList();
    foreach (var item in blogsList )
    {
        Console.WriteLine(item.Name);
    } 
```

而且我能够导航对象而不会出现错误。

这是我遇到的另一种方式。

```
 private void DoSomething(ObjectResult<Blog> blogs, ObjectResult<Post> posts)
    {

    } 
```

然后在这段代码之后（在原始示例中）

```
foreach (var item in posts)
{
    Console.WriteLine(item.Title);
} 
```

输入这段代码：

```
DoSomething(blogs,posts); 
```

如果我调用该例程并开始访问博客和帖子中的项目/属性，我会遇到这个问题。我明白为什么，我应该第一次抓住它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-16T18:09:12.927

我验证了实体指向正确的数据库。

然后我从 .edmx 文件中删除了该表并再次添加它。

问题解决了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-05-02T07:54:02.490

检查您的模型和数据库都应该相应地定义......

公共Int32？X { 得到；放; } ----> Nullable 因此在 DB 'X' 中应该为 Nullable = True

或者

公共 Int32 X { 获取；放; } ----> not Nullable 因此在 DB 'X' 中应该为 Nullable = false

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-02-19T07:41:45.943

在我选择的包含空值的 DB 列中创建的视图中，我通过此 select 语句更改了该值：

在我改变之前

```
 select 
     ..., GroupUuId , .. 
```

在我改变之后

```
 select 
     ..., ISNULL(GroupUuId, 0), ... 
```

对不起，我的英语不好

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-11-13T10:17:39.130

当数据库表允许 NULL 并且存在具有空值的记录并且您尝试使用 EF 读取此记录并且映射类不允许空值时，可能会发生这种情况。

解决方案是更改数据库表以使其不允许 null 或更改您的类以允许 null。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-12-12T11:36:42.963

对我来说，以下步骤纠正了错误：

1.  从“Y”表中删除“X”属性
2.  保存 EDMX
3.  从模型构建数据库
4.  编译
5.  再次将“X”属性添加到“Y”表（不可为空和 int16）
6.  保存 EDMX
7.  从模型构建数据库
8.  编译

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-09-10T12:45:13.740

修复错误

```
 Error 3031: Problem in mapping fragments starting at line 4049:Non-nullable column "X" in table "Y" is mapped to a nullable entity property. 
```

使用 xml 编辑器打开您的 EDMX 文件并在其中查找您的表格

> edmx：存储模型

找到给出错误的属性并设置或添加

> Nullable="false" >> 到 Nullable="true"

保存 edmx，在 Visual Studio 中打开并构建它。问题解决了

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-11-10T08:24:12.527

得到相同的错误但不同的上下文，尝试使用 linq 连接表，其中对于数据库中的一个表，非空列插入了空值，将值更新为默认值，问题已解决。

# asp.net - RegularExpressionValidator 不能使用在代码隐藏中定义的字符串

> ID：13420038
> 
> 赞同：0
> 
> 时间：2012-11-16T15:56:42.583
> 
> 标签：asp.net, validation

我想使用 asp:RegularExpressionValidator 控件来验证多个文本框。一些文本框包含电子邮件地址。我不想为每个不同的文本框在 RegularExpressionValidator 的属性中重复相同的正则表达式。因此，我在代码隐藏中将表达式定义为常量

```
Const regEmail As String = "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$" 
```

同样，我以这种方式定义错误消息。

```
const regEmailMsg = "Email address does not appear to be valid." 
```

但是，我找不到将这些字符串包含在我的 ASPX 页面中的 RegularExpressionValidator 控件中的方法。有效的表达式被标记为无效。作为另一个失败，ValidatorCalloutExtender 出现了，但它的中间部分丢失了 - 错误消息没有出现。这是一个示例文本框和验证器：

```
<asp:TextBox ID="txtIndividualEmail" runat="server" Width = "200"></asp:TextBox>

<asp:RegularExpressionValidator ID="revIndividualEmail" runat="server" ErrorMessage="<% =regEmailMsg %>" Display="None" 
ControlToValidate="txtIndividualEmail" ValidationExpression="<% =regEmail %>" >    </asp:RegularExpressionValidator>

<cc1:ValidatorCalloutExtender ID="vceIndividualEmail" runat="server" 
Enabled="True" TargetControlID="revIndividualEmail" HighlightCssClass="validatorCalloutHighlight">
</cc1:ValidatorCalloutExtender> 
```

当我将字符串直接包含在 ASPX 中时，一切正常：

```
<asp:RegularExpressionValidator ID="revIndividualEmail" runat="server" ErrorMessage="Email address does not appear to be valid." Display="None" 
ControlToValidate="txtIndividualEmail" ValidationExpression="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$" 
```

电子邮件只是我想重复使用字符串进行验证的一个例子，因此不想在我的 ASPX 中重复它。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:02:12.440

您在这里真正可以做的唯一一件事就是在`OnInit`or`OnLoad`事件的代码隐藏中设置属性。就像是：

```
protected override void OnLoad(EventArgs e)
{
   txtIndividualEmail.ValidationExpression = myExpressionConstant;
   txtIndividualEmail.ErrorMessage = myErrorMessageConstant;
   // etc
} 
```

# xaml - 在 WinPRT Xaml/DirectX 示例中使用的外部 DLL 中使用 D3D 设备进行渲染具有恒定的黑色闪烁

> ID：13420042
> 
> 赞同：1
> 
> 时间：2012-11-16T15:56:52.037
> 
> 标签：xaml, dll, directx, windows-phone-8, winprt

我有一个基于 C++ DirectX 的第三方游戏引擎编译成一个 Windows Phone 运行时组件 DLL。我正在努力将它集成到一个基于 Windows Phone Direct3D 和 XAML 应用程序的项目中。游戏引擎 DLL 使用应用程序的 Direct3DBackground::Draw() 方法提供的 D3D 设备、上下文和渲染视图纹理。

示例中的内置渲染器已消失，取而代之的是游戏引擎。

我可以渲染，但有持续的黑色闪烁。每隔一帧都是黑色的。为了向自己证明它不是渲染器（已被证明可以在其他地方工作），我将游戏引擎 DLL 中的所有渲染代码都剪掉了，只设置了一个清晰的颜色。结果还是一样。

起初我以为是因为示例生成的 Direct3DXamlAppComponent 可能运行在与游戏引擎 DLL 不同的线程中，但事实并非如此。他们在同一个线程上。

*   此配置可能导致什么渲染问题？
*   游戏引擎的渲染器是否需要单独的 d3d 设备？
*   游戏引擎的渲染器是否需要单独的 d3d 设备上下文？

我还没有尝试过的事情：

*   在 DLL 上创建第二个 d3d 设备
*   转换游戏引擎以提供自己的 IDrawingSurfaceManipulationHandler。但我不确定它是否会出现与上述相同的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T20:00:12.253

问题来自渲染目标视图。我没有意识到指向它的指针每帧都会更新。我刚刚在启动时将其设置为游戏引擎渲染器。现在我每帧更新渲染视图目标指针，现在黑色闪烁消失了。

# c# - Asp.Net MVC 路由在路由中使用 C# 关键字

> ID：13420043
> 
> 赞同：1
> 
> 时间：2012-11-16T15:56:52.770
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing

我想创建一个使用参数作为 URL 一部分的路由。

我遇到的问题是当我创建默认值时，我不能使用 params 作为其保留的 c# 字。

想知道是否有办法解决这个问题。（请参阅路由中参数的使用，当用作默认值时，我得到一个编译器错误：预期表达式）

这是示例代码：

```
 routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{db}/{proc}/{params}",
            defaults: new { controller = "Data", action = "Index", db = UrlParameter.Optional, proc = UrlParameter.Optional, params = UrlParameter.Optional}
        ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T15:58:37.887

正如 MSDN 建议的那样，您可以通过在它们前面加上 @ 符号来使用 C# 关键字。在您的情况下，请使用`@params`而不是`params`.

[引用 MSDN](http://msdn.microsoft.com/en-us/library/x53a06bb.aspx)

> 关键字是预定义的、保留的标识符，对编译器具有特殊含义。除非它们包含 @ 作为前缀，否则它们不能用作程序中的标识符。例如，@if 是有效标识符，但 if 不是，因为 if 是关键字。

是否有任何特殊原因需要调用此变量`params`？

# javascript - iOS webviews中backbone.js和require.js的问题

> ID：13420044
> 
> 赞同：2
> 
> 时间：2012-11-16T15:57:01.417
> 
> 标签：javascript, backbone.js, webkit, ios6, requirejs

我的应用程序不执行 javascript 时遇到一些奇怪的问题

我有一个加载在 iPad 应用程序中的网络视图。页面使用 require 和主干呈现，但有些东西阻止了外部库的执行。

问题在于 d3.js 和 jquery 倒计时插件。

使用萤火虫我没有得到任何错误，但倒计时没有开始。与 d3 绘制一些东西相同，但单击功能不起作用

我不确定它是需要问题还是 iOS6 问题。如果这是一个需要问题，我认为我们会收到错误。但我们没有。

有人对可能是什么问题有任何线索吗？

主控制器看起来像这样

```
/*global require: false */
/*jslint nomen: true */

// Sets up common libraries for all pages
require.config({
paths: {
    // Major libraries
    'jquery': 'lib/jquery-1.8.2.min',
    //'jquery.mobile': 'lib/jquery.mobile-1.2.0.min',
    //'jquery.mobile-config': 'lib/jquery.mobile-config',

    'underscore': 'lib/underscore-min',
    'backbone': 'lib/backbone-min',
    'fastclick': 'lib/fastclick.min',
    'easing': 'lib/jquery.easing.1.3',
    'countdown':'lib/jquery.countdown.min',
    // Require.js plugins
    'text': 'lib/text',
    'socket.io': 'lib/socket.io.min'
},

shim: {
    'jquery': {
        exports: '$',
        exports: 'jQuery'

    },
    'easing': ['jquery'],
    //'jquery.mobile-config': ['jquery'],
    //'jquery.mobile': ['jquery','jquery.mobile-config'],
    'fastclick': {
        exports: 'FastClick'
    },
    'countdown': {
        deps: ['jquery'],
        exports: 'countdown'
    },
    'underscore': {
        exports: '_'
    },
    'backbone': {
        deps: ['underscore', 'jquery'],
        exports: 'Backbone'
    },
    'socket.io': {
        exports: 'io'
    }
}
});

require(['jquery', 'underscore', 'views/main-view', 'view-controller','fastclick', 'easing', 'countdown'], function ($, _, MainView, ViewController, fc, easing, countdown) {
"use strict";

var mainView = new MainView();
$("body").html(mainView.render().el);

ViewController.initialize();
}); 
```

# python - 使用 xlrd 读取 Excel 时使用哪种编码

> ID：13420049
> 
> 赞同：2
> 
> 时间：2012-11-16T15:57:12.353
> 
> 标签：python, encoding, utf-8, xlrd, latin1

我正在尝试使用 xlrd 读取 Excel 文件以写入 txt 文件。一切都写得很好，除了一些行有一些西班牙字符，比如“Téd”。我可以使用 latin-1 编码对它们进行编码。但是，对于具有 'â' 和 unicode u'\u2013' 的其他行，该代码将失败。u'\2013' 不能使用 latin-1 编码。使用 UTF-8 时，'â' 写得很好，但 'Téd' 写成 'Téd'，这是不可接受的。我该如何纠正这个。

下面的代码：

```
#!/usr/bin/python
import xlrd
import csv
import sys

filePath     = sys.argv[1]

with xlrd.open_workbook(filePath) as wb:
     shNames = wb.sheet_names()
     for shName in shNames:
         sh = wb.sheet_by_name(shName)
         csvFile = shName + ".csv"
         with open(csvFile, 'wb') as f:
              c = csv.writer(f)
              for row in range(sh.nrows):
                  sh_row = []
                  cell = ''
                  for item in sh.row_values(row):
                      if isinstance(item, float):
                         cell=item
                      else:
                         cell=item.encode('utf-8')
                      sh_row.append(cell)
                      cell=''
                  c.writerow(sh_row)
         print shName + ".csv File Created" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:04:18.543

[Python的`csv`模块](http://docs.python.org/2/library/csv.html)

> 不支持 Unicode 输入。

您在编写输入之前正确编码了输入 - 所以您不需要`codecs`. 只是`open(csvFile, "wb")`（`b`很重要）并将该对象传递给作者：

```
with open(csvFile, "wb") as f:
    writer = csv.writer(f)
    writer.writerow([entry.encode("utf-8") for entry in row]) 
```

或者，是处理编码[`unicodecsv`](http://pypi.python.org/pypi/unicodecsv/0.9.0)的直接替代品。`csv`

* * *

你得到`Ã©`而不是`é`因为[你把 UTF-8 编码的文本误认为 latin-1](http://www.weblogism.com/item/270/why-does-e-become-a)。这可能是因为您编码了两次，一次 as`.encode("utf-8")`和一次 as `codecs.open`。

* * *

顺便说一句，检查`xlrd`单元格类型的正确方法是执行`cell.ctype == xlrd.ONE_OF_THE_TYPES`.

# android - NetBeans 上的 Android ActionBarSherlock - 工作但编辑器显示错误

> ID：13420050
> 
> 赞同：2
> 
> 时间：2012-11-16T15:57:13.313
> 
> 标签：android, netbeans, actionbarsherlock

我正在将 NetBeans 用于 android 应用程序。我正确安装了（我认为）ActionBarSherlock 包作为 android 库项目。一切正常，我可以构建和运行应用程序，但代码编辑器无法识别 ABS 类（只需查看屏幕截图，BUILD SUCCESSFUL 但存在错误）并且代码完成也不起作用。

我的配置：

*   带有 android 插件版本的稳定 NetBeans 7.2。1.13
*   Linux Mint 13 Maya 64 位，伴侣
*   ActionBarSherlock 4.2 版（稳定版）

我是如何安装 ABS 的：

1.  下载并解压源码
2.  从 sdk/tools 运行命令：

    ./android 更新项目 -p path_to_ActionBarSherlock/library/

3.  将 android 项目库与我的测试项目连接的类似命令（Netbeans IDE 中有类似的选项，但我收到错误，这不是 android 库项目）

    ./android 更新项目 -l path_to_ActionBarSherlock/library/ -p path_to_my_test_project

我已经尝试过干净并在这两个项目上进行构建，但没有结果。任何想法？

问候

![在此处输入图像描述](../Images/c33dcd91f8c21dd8b51e948e3385c08d.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T04:09:44.380

我最终设法将 ActionBarSherlock 添加到我在 Netbeans 上的 android 项目中的方法是：

1.  下载最新版本的 ActionBarSherlock 并解压
2.  转到名为 library 的子文件夹并从那里删除 pom.xml 文件（其中一个以前的版本不起作用。我必须先构建它，关闭它并不仅删除 pom.xml 还删除一些 netbeans 属性文件)
3.  在 Netbeans 中打开该子项目（库）

现在这个项目将不再被视为一个 Maven 项目。Netbeans 将其视为一个 Android 项目。然后我：

1.  清理并构建它
2.  将其添加到我的项目的库属性中（右键单击我的项目，属性，库，添加，指向库项目的正确位置）。这里重要的是在我的项目附近复制/移动该库项目。否则它声称它无法打开它。从现在开始，它工作正常。

这种想法的关键是 Netbeans 不想添加提供的库项目，因为它认为它是一个 Maven 项目。当 pom 被删除后，Netbeans 不再将其视为 Android 项目的 Maven 项目，它可以毫无异议地将其添加为 Android 的项目库。

可能有更好的解决方案，但我没有找到任何解决方案，这是唯一对我有用的解决方案。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T10:44:35.083

您也可以新建一个Android项目，然后将需要的文件复制粘贴到新项目中。所以只复制：libs, res, src, AndroidManifest.xml

# facebook - Facebook 调试器：清除整个站点缓存

> ID：13420051
> 
> 赞同：1
> 
> 时间：2012-11-16T15:57:18.843
> 
> 标签：facebook, facebook-like

我知道 Facebook 会在您第一次访问您网站上的特定页面时缓存它们的 Like 数据，并且将 url 输入调试器页面会清除缓存。但是，我们现在已经改进了 Facebook 描述/图像/等，我们需要刷新整个站点（大约 300 个页面）的缓存。

有没有一种简单的方法可以做到这一点，或者如果我们需要编写一个例程来逐个纠正它们，那么实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:14:02.203

> 有没有一种简单的方法可以做到这一点，

不像清除整个域的缓存的按钮那么简单，不。

> 或者如果我们需要编写一个例程来一一纠正它们，那么实现这一点的最佳方法是什么？

您可以通过向以下位置发出 POST 请求来重新抓取 Open Graph URL：

```
https://graph.facebook.com/?id=<URL>&scrape=true&access_token=<app_access_token> 
```

因此，您必须为 300 个对象循环执行此操作。但是不要做得太快，否则你可能会达到你的应用程序速率限制 - 尝试在请求之间留出几秒钟，根据 FB 开发人员组最近的讨论应该可以正常工作。（并且不要忘记在将`<URL>`值插入 API 请求 URL 之前正确地对值进行 URL 编码。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-09T14:22:00.893

wordpress 中的简单解决方案，转到永久链接并更改永久链接并使用自定义永久链接，在我的情况下，我只是添加了一个下划线，所以这样做了... /_%postname%/

Facebook 然后没有关于（现在）新的信息网址，以便他们将其全部刮掉。

我一直在寻找相同的答案，但作为非编码人员，所有答案对我来说都非常复杂。

原来有一个非常简单的答案，我自己想出了这一切:)。

我有一个带有各种插件的 wordpress 网站，我已经批量上传了 4,000 多张图片，这些图片创建了 4,000 条帖子。
问题是我上传了它们，然后在对 og:meta 标签问题进行排序之前尝试设置 facebook 共享插件，因此 FB 抓取了总共 4,000 个帖子而没有 og:meta，所以当我添加它们时没有任何区别。无法使用 fb 调试器，因为我有超过 4k 个帖子。

我必须承认我有点兴奋，多年来我从谷歌搜索中得到了有用的答案，把我送到了这个论坛。通常我发现的建议远远超出我的想象，因为我不是编码员，我是一个“复制粘贴”。

我很高兴能够回馈这个伟大的论坛并帮助其他人:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-27T09:01:06.227

好吧，我也遇到了相同的情况并使用了 hack 并且它可以工作，但显然正如@Cbroe 在他的回答中提到的那样，API 调用对速率限制有一些限制，所以我想你应该注意它，在我的情况下，我只有 100 个 URL重新刮。

所以这里是解决方案：

```
$xml = file_get_contents('http://example.com/post-sitemap.xml'); // <-- Because i have a wordpress site which has sitemap.

$xml = simplexml_load_string($xml); // Load it as XML
$applicationAccessToken = 'YourToken'; // Application Access Token You can get it from https://developers.facebook.com/tools/explorer/    

$urls = [];
foreach($xml->url as $url) {
    $urls[] = $url->loc; // Get URLS from site map to our new Array
}

$file = fopen("response.data", "a+"); // Write API response to another file so later we can debug it.
foreach($urls as $url) {
    echo "\033[Sending URL for Scrape $url \n";
    $data = file_get_contents('https://graph.facebook.com/?id='.$url.'&scrape=true&access_token='.$applicationAccessToken);

    fwrite($file, $data . "\n"); //Put Response in file
    sleep(5); // Sleep for 5 seconds!
}
fclose($file); // Close File as all the urls is scraped.

echo "Bingo  It's Compelted!"; 
```

# tsql - 如何将动态枢轴变量输出保存为 SQL Server 表

> ID：13420054
> 
> 赞同：1
> 
> 时间：2012-11-16T15:57:23.767
> 
> 标签：tsql, sql-server-2005, variables, pivot

我已经成功地构建了我一直在使用动态 SQL 来创建具有动态创建的列名的数据透视表的输出。

我的代码是：

```
IF OBJECT_ID('tempdb..#TempDB') IS NOT NULL
DROP TABLE #TempDB
SELECT CASEID, FORMNAME, NAME, VALUE INTO #TempDB FROM dbo.EFORM WHERE FORMNAME='IncidentReporting'

 IF OBJECT_ID('tempdb..#TempDB1') IS NOT NULL
DROP TABLE #TempDB1
SELECT DISTINCT Name INTO #TempDB1 FROM #TempDB

DECLARE @columns varchar(max)
DECLARE @query varchar(max)

SELECT @columns = COALESCE(@columns + ',[' + cast([Name] as varchar(100)) + ']', 
             '[' + cast([Name] as varchar(100))+ ']') 
             FROM #TempDB1

SET @query = 'SELECT * FROM #TempDB AS PivotData '
SET @query = @query  + 
'PIVOT (MAX(VALUE) FOR [NAME] IN (' + @columns + ')) AS p'

EXEC (@query) 
```

这成功地给了我这样的结果：

```
CASEID  FORMNAME             Column1    Column2 Column3
501000000621    IncidentReporting   Value1  Valuea  Valuev
501000000622    IncidentReporting   Value2  Valueb  Valuew
601000000126    IncidentReporting   Value3  Valuec  Valuex
601000000127    IncidentReporting   Value4  Valued  Valuey
601000000128    IncidentReporting   Value5  Valuee  Valuez 
```

从@query 变量输出的这些结果正是我希望这些结果的表格所在的格式。

谁能告诉我如何将@query 变量中的结果放入标准 SQL 表中？

我试过做这样的声明，但我收到消息“'+ @columns +'附近的语法不正确”：

```
SELECT *
INTO #TempDB4
FROM (SELECT * FROM #TempDB AS PivotData 
PIVOT (MAX(VALUE) FOR [NAME] IN (' + @columns + ')) AS p) 
```

提前谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:02:57.190

在您现有的代码中，将您添加`into`到此行：

```
SET @query = 'SELECT * FROM #TempDB AS PivotData ' 
```

让你得到：

```
SET @query = 'SELECT * INTO #TempDB4 FROM #TempDB AS PivotData ' 
```

或者`insert`以同样的方式添加。

要让不成功的查询按预期工作，您必须将其转换为动态 SQL，就像您成功的查询一样，并使用`exec`或调用它`sp_executesql`

# windows - 在 Windows 上查看进程的打开文件处理程序

> ID：13420057
> 
> 赞同：17
> 
> 时间：2012-11-16T15:57:30.183
> 
> 标签：windows, process

我想查看 Windows 上某个进程的打开文件处理程序，以验证是否读取了正确的配置文件。ProcMon 和其他工具显示引用的模块 - dll。我需要查看所有文件（如 xml、txt 等）的打开文件句柄。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-16T16:01:52.420

[Process Explorer](http://technet.microsoft.com/en-gb/sysinternals/bb896653.aspx)可以提供此信息，但默认情况下它是隐藏的。

要显示句柄：`View -> Lower Pane View -> Handles`

Process Explorer 还允许您搜索文件名并确定打开了哪个进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-23T20:54:10.470

Sysinternal Suite 附带`handle.exe`用于在 CLI 中转储：

```
 handle
 handle -a
 handle -p 10832 
```

# playframework-2.0 - Ebean - 包含外键的复合主键

> ID：13420063
> 
> 赞同：8
> 
> 时间：2012-11-16T15:57:58.243
> 
> 标签：playframework-2.0, ebean

我正在使用最新版本的 playframework (2.0.4) 和 Ebean ORM。这是我的简化数据库架构

```
TABLENAME (FIELD_NAME (, ...) )
User (id)
Group (id)
UserGroup (user_id, group_id, is_active) 
```

我想创建我的实体模型，如下所示：

```
@Entity
public class UserGroup extends Model {
    private static final long serialVersionUID = 1L;

    @EmbeddedId
    public UserGroupPK pk;
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "user_id", insertable = false, updatable = false)
    public User user;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "group_id", insertable = false, updatable = false)
    public Group group;
}

@Embeddable
public class UserGroupPK implements Serializable{
    private static final long serialVersionUID = 1L;

    public Long userId;
    public Long groupId;

    public UserGroupPK(Long userId, Long groupId) {
        this.userId = userId;
        this.groupId = groupId;
    }

    @Override
    public boolean equals(Object obj) {
        if (obj == null) {
            return false;
        }
        if (getClass() != obj.getClass()) {
            return false;
        }
        final UserGroupPK other = (UserGroupPK) obj;
        if ((this.userId == null) ? (other.userId != null) : !this.userId.equals(other.userId)) {
                return false;
            }
        if ((this.groupId == null) ? (other.groupId != null) : !this.groupId.equals(other.groupId)) {
            return false;
        }
        return true;
    }

    @Override
    public int hashCode() {
        int hash = 3;
        hash = 89 * hash + (this.userId != null ? this.userId.hashCode() : 0);
        hash = 89 * hash + (this.groupId != null ? this.groupId.hashCode() : 0);
        return hash;
    }
} 
```

适合你吗。如果这个中间表没问题，那么 User 和 Group 实体呢？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-06T21:47:57.003

一些注释似乎不正确，但无论如何都可以工作。

如果我是你，我会这样做：

```
@Embeddable
public class UserGroupPK implements Serializable{
    private static final long serialVersionUID = 1L;

    @Column(name = "user_id")
    public Long userId;
    @Column(name = "group_id")
    public Long groupId; 
```

对于多对一列：

```
@ManyToOne
@JoinColumn(name = "user_id", referenceColumnName = "id", nullable = false) // insertable and updatable by default are true, which I think are correct here
public User user;

// same for group 
```

在您的用户实体中，您需要以下内容：

```
@OneToMany(mappedBy = "user", cascade = CascadeType.ALL)
public Set<UserGroup> groups 
```

当你找到时，就像

```
// find all users within a certain group
Ebean.find(User.class)
     .fetch("groups")
     .where().eq("groups.groupId", "...").findList(); 
```

# android - Android、AES-GCM 或普通 AES 上的数据加密？

> ID：13420065
> 
> 赞同：8
> 
> 时间：2012-11-16T15:58:12.110
> 
> 标签：android, encryption, aes, bouncycastle, aes-gcm

我的团队需要开发一种解决方案，`byte[]`在用 Java 编写的 Android 应用程序的上下文中加密二进制数据（存储为 ）。加密后的数据会以多种方式传输和存储，期间不能排除数据损坏的可能。最终，另一个 Android 应用程序（同样是用 Java 编写的）必须解密数据。

已经决定加密算法必须是 AES，密钥为 256 位。但是，我想就我们应该使用哪种 AES 实现和/或“模式”做出明智的决定。我读过一种叫做 GCM 模式的东西，我们已经用它做了一些测试（使用 BouncyCastle/SpongyCastle），但我并不完全清楚 AES-GCM 到底是做什么用的，以及与普通模式相比它“购买”我们的是什么AES - 以及是否需要考虑任何权衡。

以下是我们的关注/要求/问题列表：

*   **填充：**我们需要加密的数据并不总是 128 位的倍数，因此 AES 实现/模式应该添加填充，但仅在必要时。我的印象是，简单的 AES 实现（例如由 提供`javax.crypto.Cipher`）不会这样做，但最初的测试表明确实如此。所以我猜测填充要求本身并没有理由求助于 GCM 而不是“普通”AES。那是对的吗？

*   **身份验证：**我们需要一种万无一失的方法来检测是否发生了数据损坏。但是，理想情况下，我们还希望检测何时尝试使用不正确的密钥进行解密。因此，我们希望能够区分这两种情况。我最终考虑 GCM 的原因首先是由于这个[Stackoverflow 问题](https://stackoverflow.com/q/12228250/1084488)，其中一位响应者似乎暗示使用 AES-GCM 可以进行这种区分，尽管他没有提供详细的解释（更不用说代码了） .

*   **最小化开销：**我们需要限制加密数据的存储和传输开销。因此，我们希望了解特定 AES 实现/模式的选择是否以及在多大程度上会影响开销量。

*   **加密/解密性能：**虽然这不是主要问题，但我们想知道特定 AES 实现/模式的选择在 CPU 时间和内存占用方面影响加密和解密性能的程度。

提前感谢您提供任何建议、说明和/或代码示例。

**编辑：** delnan 有用地指出没有“普通 AES”之类的东西。所以澄清一下，我的意思是使用 Java 的内置 AES 支持。
像这样：`Cipher localCipher = Cipher.getInstance("AES");`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-16T18:26:36.613

2012 年的答案是选择 GCM，除非您有严重的兼容性问题。

[GCM](http://en.wikipedia.org/wiki/Galois/Counter_Mode)是一种经过*身份验证的加密*模式。它一次性为您提供机密性（加密）、完整性和身份验证 (MAC)。

到目前为止，正常的操作模式是 ECB（这是[Java](https://stackoverflow.com/questions/6258047/java-default-crypto-aes-behavior)的默认值）、CBC、CTR、OFB 和其他一些。他们都只提供加密。但是，如果没有完整性，保密性本身很少有用。必须以一种特别的方式将这种经典模式与完整性检查结合起来。由于密码学很难做到正确，因此这种组合通常是不安全的，比必要的慢，甚至两者兼而有之。

*密码学家（最近）创建了经过*身份验证的加密模式来解决该问题。*GCM 是最成功的一种：它已被[NIST](http://csrc.nist.gov/publications/nistpubs/800-38D/SP-800-38D.pdf)选中，它高效、无专利，并且可以携带*Additional Authenticated Data*（即保持清晰但您可以验证其真实性的数据） . 有关其他模式的描述，请参阅[Matthew Green 的这篇优秀文章](http://blog.cryptographyengineering.com/2012/05/how-to-choose-authenticated-encryption.html)。*

 *解决您的担忧：

*   **填充：**默认情况下，Java 使用 PKCS#7 填充。这行得通，但它通常容易受到[填充 oracle 攻击](http://usenix.org/events/woot10/tech/full_papers/Rizzo.pdf)，最好用[MAC](http://en.wikipedia.org/wiki/Message_authentication_code)击败。GCM 已经嵌入了一个 MAC（称为 GMAC）。

*   **身份验证：** AES-GCM 仅将一个 AES 密钥作为输入，而不是密码。它会告诉您 AES 密钥是否错误或负载是否已被篡改，但此类情况被视为一个。相反，您应该考虑使用适当的密钥派生算法（如[PBKDF2](http://en.wikipedia.org/wiki/PBKDF2)或[bcrypt](http://en.wikipedia.org/wiki/Bcrypt)）从密码中派生 AES 密钥。我不认为总是可以判断密码是否不正确或有效负载是否已被修改，因为验证前者所需的数据总是可能被破坏。您可以加密一个小的已知字符串（使用 ECB AES），将其发送，并使用它来验证密码是否正确。

*   **最小化开销：**归根结底，如果您需要身份验证，所有模式都会导致相同的开销（大约 10-20 个字节）。除非您使用非常小的有效负载，否则可以忽略这一点。

*   **性能：** GCM 非常好，因为它是一种*在线*模式（不需要缓冲整个有效负载，因此内存更少），它是可并行化的，并且每个明文块需要一次 AES 操作和一次伽罗瓦乘法。像 ECB 这样的经典模式更快（每个块只有一个 AES 操作），但是 - 再次 - 您还必须考虑完整性逻辑，这可能最终会比 GMAC 慢。

话虽如此，人们必须意识到 GCM 安全性依赖于良好的随机数生成来创建 IV。*

# mongodb - Mongod 运行，但 Mongo 返回错误

> ID：13420073
> 
> 赞同：0
> 
> 时间：2012-11-16T15:58:42.707
> 
> 标签：mongodb

以前有人问过这个问题，但从未回答过。此外，我的错误日志略有不同：

当我运行“mongo”时，出现此错误：

```
MongoDB shell version: 2.2.0
connecting to: test
Fri Nov 16 10:52:05 Error: couldn't connect to server 127.0.0.1:27017 src/mongo/shell/mongo.js:91
exception: connect failed 
```

这是我的错误日志：

```
Fri Nov 16 10:47:44 [initandlisten] MongoDB starting : pid=46508 port=27017     dbpath=/usr/local/var/mongodb 64-bit host=Brians-MacBook-Pro-2.local
Fri Nov 16 10:47:44 [initandlisten] 
Fri Nov 16 10:47:44 [initandlisten] ** WARNING: soft rlimits too low. Number of files is 256, should be at least 1000
Fri Nov 16 10:47:44 [initandlisten] db version v2.2.0, pdfile version 4.5
Fri Nov 16 10:47:44 [initandlisten] git version: f5e83eae9cfbec7fb7a071321928f00d1b0c5207
Fri Nov 16 10:47:44 [initandlisten] build info: Darwin bs-osx-106-x86-64-1.local 10.8.0 Darwin Kernel Version 10.8.0: Tue Jun  7 16:33:36 PDT 2011; root:xnu-1504.15.3~1/RELEASE_I386 i386 BOOST_LIB_VERSION=1_49
Fri Nov 16 10:47:44 [initandlisten] options: { bind_ip: "127.0.0.1", config: "/usr/local/etc/mongod.conf", dbpath: "/usr/local/var/mongodb", logappend: "true", logpath: "/usr/local/var/log/mongodb/mongo.log" }
Fri Nov 16 10:47:44 [initandlisten] journal dir=/usr/local/var/mongodb/journal
Fri Nov 16 10:47:44 [initandlisten] recover begin
Fri Nov 16 10:47:44 [initandlisten] couldn't open /usr/local/var/mongodb/journal/lsn errno:13 Permission denied
Fri Nov 16 10:47:44 [initandlisten]   Assertion failure f.is_open() src/mongo/db/dur_journal.cpp 552
0x10037637b 0x1000b0196 0x100105ec2 0x10049de46 0x10049e445 0x10049e628 0x1002401ac     0x1000057ec 0x10000608d 0x10000d534 0x10000f309 0x100000ea4 0x3 
 0   mongod                              0x000000010037637b _ZN5mongo15printStackTraceERSo + 43
 1   mongod                              0x00000001000b0196 _ZN5mongo12verifyFailedEPKcS1_j + 310
 2   mongod                              0x0000000100105ec2 _ZN5mongo3dur14journalReadLSNEv + 898
 3   mongod                              0x000000010049de46 _ZN5mongo3dur11RecoveryJob2goERSt6vectorIN5boost11filesystem210basic_pathISsNS4_11path_traitsEEESaIS7_EE + 86
 4   mongod                              0x000000010049e445 _ZN5mongo3dur8_recoverEv + 405
 5   mongod                              0x000000010049e628 _ZN5mongo3dur7recoverEv + 40
 6   mongod                              0x00000001002401ac _ZN5mongo3dur7startupEv + 124
 7   mongod                              0x00000001000057ec _ZN5mongo14_initAndListenEi + 1052
 8   mongod                              0x000000010000608d _ZN5mongo13initAndListenEi + 29
 9   mongod                              0x000000010000d534 _ZL11mongoDbMainiPPc + 29348
 10  mongod                              0x000000010000f309 main + 9
 11  mongod                              0x0000000100000ea4 start + 52
 12  ???                                 0x0000000000000003 0x0 + 3
Fri Nov 16 10:47:44 [initandlisten] dbexception during recovery: 13611 can't read lsn file in journal directory : assertion src/mongo/db/dur_journal.cpp:552
Fri Nov 16 10:47:44 [initandlisten] exception in initAndListen: 13611 can't read lsn file in journal directory : assertion src/mongo/db/dur_journal.cpp:552, terminating
Fri Nov 16 10:47:44 dbexit: 
Fri Nov 16 10:47:44 [initandlisten] shutdown: going to close listening sockets...
Fri Nov 16 10:47:44 [initandlisten] shutdown: going to flush diaglog...
Fri Nov 16 10:47:44 [initandlisten] shutdown: going to close sockets...
Fri Nov 16 10:47:44 [initandlisten] shutdown: waiting for fs preallocator...
Fri Nov 16 10:47:44 [initandlisten] shutdown: lock for final commit...
Fri Nov 16 10:47:44 [initandlisten] shutdown: final commit...
Fri Nov 16 10:47:44 [initandlisten] shutdown: closing all files...
Fri Nov 16 10:47:44 [initandlisten] closeAllFiles() finished
Fri Nov 16 10:47:44 [initandlisten] shutdown: removing fs lock...
Fri Nov 16 10:47:44 dbexit: really exiting now 
```

我运行时没有输出：

```
netstat -f inet -a -n | grep 27101 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:16:14.447

正如@Nilam 所说，您的问题之一是期刊，但是，您实际上在这里有两个问题，我所说的一个更像是一个警告：

```
Fri Nov 16 10:47:44 [initandlisten] ** WARNING: soft rlimits too low. Number of files is 256, should be at least 1000 
```

这具体涉及：[https ://jira.mongodb.org/browse/SERVER-4407](https://jira.mongodb.org/browse/SERVER-4407)

您应该考虑增加 Linux 中的 openfile 计数，否则您可能会得到：[http](http://www.mongodb.org/display/DOCS/Too+Many+Open+Files) ://www.mongodb.org/display/DOCS/Too+Many+Open+Files当然，此页面还告诉您如何解决问题。

注意：作为日志点的旁注，看起来您的 MongoDB 节点可能正在尝试从某些东西中恢复。我会检查为什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T15:34:50.447

与@Hartator 的回答类似，这为我解决了这个问题：

```
chmod -R 777 /data/db 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:03:05.117

你有

```
journal dir=/usr/local/var/mongodb/journal 
```

错误显示是

```
[initandlisten] couldn't open /usr/local/var/mongodb/journal/lsn errno:13 Permission denied 
```

因此，请检查日志目录是否存在以及是否为该文件夹提供了适当的写入权限。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-16T16:32:41.737

尝试运行：

```
chmod 777 -R /usr/local/var/mongodb 
```

# jquery - 在页面模板中使用自定义 jquery

> ID：13420077
> 
> 赞同：2
> 
> 时间：2012-11-16T15:58:51.583
> 
> 标签：jquery, wordpress, jquery-ui, templates

我制作了自定义页面模板，该模板在带有嵌套手风琴和二级子页面的选项卡中显示一级页面的所有子页面。这是我的页面： [http ://avgustin.dn.ua/en/menu/](http://avgustin.dn.ua/en/menu/)

由于这个问题 -[选项卡中的 jquery ui 手风琴](https://stackoverflow.com/questions/1542161/jquery-ui-accordions-within-tabs)我不能使用插件 JQuery UI，因为它默认在手风琴之前初始化选项卡。所以我像这样手动添加jquery（我在function.php中按照建议进行编辑）：

```
 function my_enqueue_jquery_ui() {
    wp_enqueue_script( 'jquery-ui-1.8.2', '/wp-content/themes/papyrus/js/jquery-1.8.2.js', '1.8.2', array( 'jquery' ) );
}
function my_enqueue_jquery_ui2() {
    wp_enqueue_script( 'jquery-ui-1.9.1.custom', '/wp-content/themes/papyrus/js/jquery-ui-1.9.1.custom.js', '1.9.1', array( 'jquery' ) );
}
add_action('wp_enqueue_scripts', 'my_enqueue_jquery_ui');
add_action('wp_enqueue_scripts', 'my_enqueue_jquery_ui2'); 
```

而不是在制表符之前初始化手风琴

```
jQuery(document).ready(function($) {    
    <?php
        foreach( $mypages as $page ) {      
            $content = $page->post_content;
            if ( ! $content ) // Check for empty page
                continue;?>
            $("#accordion<?php echo $page->ID ?>").accordion({collapsible: true, active: -10 });    
        <?php 
                }
        ?>      
              $("#tabs").tabs();     
    }); 
```

一切正常，直到我激活任何使用 jquery 的插件，例如 flash 库。如何以正确的方式将自定义 jquery 支持添加到页面模板。使用 jquery 制作通用工作页面模板是否真的可以与任何模板一起使用而无需修改？请帮帮我！这是完整的代码

```
<?php
/*
Template Name: Menu_page
*/
?><?php get_header(); ?>
  <div id="content">
  <div class="entry"/>
  <?php if (have_posts()) : while (have_posts()) : the_post(); ?>
    <div class="post" id="post-<?php the_ID(); ?>">
        <h2><?php the_title(); ?></h2>
        <div class="post-content">        
<?php
    $mypages = get_pages( array( 'child_of' => $post->ID, 'sort_column' => 'post_date', 'sort_order' => 'desc', 'parent' =>  $post->ID) );?>
    <div id="tabs"> 
       <ul>
<?php
    foreach( $mypages as $page ) {      
        $content = $page->post_content;
        if ( ! $content ) // Check for empty page
            continue;
        $content = apply_filters( 'the_content', $content );
    ?>
         <li><a href="#tab<?php echo $page->ID ?>"><?php echo $page->post_title; ?></a></li>        
    <?php   
    }?>
</ul>
<?php
    foreach( $mypages as $page ) {      
        $content = $page->post_content;
        if ( ! $content ) // Check for empty page
            continue;
        $content = apply_filters( 'the_content', $content );
    ?>
         <div id="tab<?php echo $page->ID ?>">
         <?php echo $content;?>
         <div id="accordion<?php echo $page->ID ?>">
         <?php 
         $mypages2 = get_pages( array( 'child_of' => $page->ID, 'sort_column' => 'menu_order', 'sort_order' => 'asc', 'parent' =>  $page->ID) );
         foreach( $mypages2 as $page2 ) {
            $content2 = $page2->post_content;
            if ( ! $content2 ) // Check for empty page
                continue;
            $content2 = apply_filters( 'the_content', $content2 );?>

            <h3><a href="#"><?php echo $page2->post_title; ?></a></h3>
            <div>   
                <?php echo $content2;?>
            </div>
            <?php }?>
            </div>
            </div>
    <?php   
    }?></div>     

<script>        
jQuery(document).ready(function($) {    
<?php
    foreach( $mypages as $page ) {      
        $content = $page->post_content;
        if ( ! $content ) // Check for empty page
            continue;?>
        $("#accordion<?php echo $page->ID ?>").accordion({collapsible: true, active: -10 });    
    <?php 
            }
    ?>      
          $("#tabs").tabs();     
});
</script>       
            <?php the_content('<p class="serif">Р§РёС‚Р°С‚СЊ РїРѕР»РЅРѕСЃС‚СЊСЋ &raquo;</p>'); ?>
            <?php link_pages('<p><strong>РЎС‚СЂР°РЅРёС†С‹:</strong> ', '</p>', 'number'); ?>
        </div>
    </div>

  <?php endwhile; endif; ?>
    </div>
  </div><!--/content -->

<?php get_sidebar(); ?>

<?php get_footer(); ?> 
```

当我在 chrome 的源代码中激活其他插件（flash galery）时，我看到：

```
<script type='text/javascript' src='http://avgustin.dn.ua/wp-includes/js/jquery/jquery.js?ver=1.7.2'></script> 
```

在我用 jquery 初始化的行之后。所以我的jQuery不起作用:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:05:18.963

你为什么不尝试通过`wp_enqueue_script()`函数包含 jQuery 呢？像这样：

```
function my_enqueue_jquery_ui() {
    wp_enqueue_script( 'jquery-ui-1.9.1.custom', '/wp-content/uploads/jquery-ui-1.9.1.custom/js/jquery-ui-1.9.1.custom.js', '1.9.1', array( 'jquery' ) );
}
add_action('wp_enqueue_scripts', 'my_enqueue_jquery_ui'); 
```

据我了解，您的问题是其他插件需要 jQuery，然后它们都发生冲突（一个覆盖另一个）并且您的代码不再正常工作。

此外，我会考虑将 jQuery UI 脚本保留在主题目录中，但这取决于您。

# grails - GORM：不可知地映射大型文本字段数据库

> ID：13420081
> 
> 赞同：2
> 
> 时间：2012-11-16T15:59:11.547
> 
> 标签：grails, groovy, grails-orm

我有一个将针对 SQL Server 或 Oracle 后端运行的 Grails 应用程序。我正在使用 GORM 作为 ORM。

我想以支持两种数据库类型的方式映射一个大文本字段。在我的 Grails 域类中，我有类似的内容：

```
class Note {
    String content

    static constraints = {
        content nullable: false, blank: false
    }
} 
```

然后我声明如下所示的数据库表：

```
-- oracle
CREATE TABLE NOTE 
(
    id NUMBER(19, 0) NOT NULL,
    version NUMBER(19, 0) NOT NULL,
    content CLOB NOT NULL
);

-- SQL Server
CREATE TABLE NOTE 
(
    id NUMERIC(19, 0) NOT NULL,
    version NUMERIC(19, 0) NOT NULL,
    content NVARCHAR(MAX) NOT NULL
); 
```

GORM`validate`在启动时以模式运行，我找不到 Oracle 和 SQL Server 数据类型和 GORM 映射的组合，它们允许存储或大型文本字段，而没有 GORM 无法正确启动。

我试过了：

*   将类型设置为`text`in `mappings`，但这似乎不起作用。Oracle 抱怨期望该`content`字段为 type `long`，而 SQL Server`text`在这些情况下需要 type of 。

*   设置`type`to `clob`，它通过模式验证但不允许我将字段设置为字符串值 - GORM 需要类型的数据`CLOB`。

我应该如何配置我的数据库定义和 GORM 以使其工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T16:38:20.343

尽管有点骇人听闻，但最终还是出现了一个解决方案：通过在启动时查询 Grails 配置，您可以选择合适的数据类型。

```
class Note {

    String content

    static constraints = {
        content nullable: false, blank: false
    }

    static mappings = {
        content sqlType: DbSupport.bigStringType
    }
}

class DbSupport {

    static def getBigStringType() {

        // examine which hibernate dialect is selected, and pick
        // an appropriate type mapping for that database type:
        def dialect = ApplicationHolder.application.config.dataSource.dialect
        switch (dialect) {

            case "org.hibernate.dialect.SQLServerDialect":
                return "nvarchar"
                break

            case "org.hibernate.dialect.Oracle10gDialect":
                return "clob"
                break
        }

    }
} 
```

# jquery - 更改 iframe 高度以适应动画内容

> ID：13420084
> 
> 赞同：0
> 
> 时间：2012-11-16T15:59:27.637
> 
> 标签：jquery, animation, iframe, height

我在 iframe 中有一些内容，但是点击时的内容会通过动画改变高度。我需要更改 iframe 的高度以匹配新的动画高度，这将如何完成？

[http://www.klossal.com/b_iframe.html](http://www.klossal.com/b_iframe.html)

您可以看到那里的设置不起作用，您单击其中一个名称，您将看到动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:03:58.233

您可以使用JS从父文档中获取函数，只需在父节点中定义一个函数并像这样调用它；

```
parent.setIFrameHeight(newValue); 
```

你的`setIFrameHeight`功能应该是这样的；

```
function setIFrameHeight(value) {
   document.getElementById("iframe").height = value + "px";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:09:46.393

您可以使用[jQuery](http://jquery.com/)库来做到这一点，甚至可以轻松地为事件设置动画。

一个简单的 jQuery 示例示例：

HTML：

```
<iframe id="iframe-box" src="httml://jsfiddle.com" height="100px" width="50px"></iframe>   

<div id="clickme" >
  click me
</div>​ 
```

Javascript

```
$(function(){
    $('#clickme').click(function(){
      $('#iframe-box').animate({'width':'200'})  
    })
});​ 
```

[例子](http://jsfiddle.net/b6qfJ/)

**更新**

如果你想访问 iframe 中的内容，你也可以使用 jQuery 和`content()`函数：

```
jQueryObject = $("#iframe-box").contents().find("#somecontent") 
```

# jquery - 使用一组默认值在“编辑”按钮上应用 Jquery 自动完成功能

> ID：13420089
> 
> 赞同：2
> 
> 时间：2012-11-16T15:59:40.907
> 
> 标签：jquery, asp.net, visual-studio-2010, asp.net-mvc-3-areas

我有一个内置于 asp.net MVC3、VS2010 的 Web 应用程序。我的网站显示包含一组列和行的数据表。我在整个网页上只有一个“新建”选项，它在表格上创建了​​一个新行。我在表格数据的每一行都有“编辑”选项，允许用户编辑单个行。每行对应不同的员工 ID。因此，例如，我想编辑员工 id=120，我可以单击具有该员工 id 的行上的特定“编辑”按钮。

我可以使用 Jquery UI 成功地为“新建”字段应用自动完成功能。但是对于每一行数据的“编辑”选项，我可以应用相同的自动完成逻辑，但它的作用是在初始单击“编辑”时不显示字段的默认值，它显示一个空文本框和键入自动完成功能。

更具体地说，默认情况下没有任何自动完成等，当我在特定行上单击“编辑”时，它通常会显示具有默认值的字段。因此，在这里，当我应用 autcomplete 时，我想保留这些字段的默认值，然后当用户单击“编辑”时，他应该能够看到所有字段的默认值以及何时更改特定字段- 他可以单击该字段并擦除并开始使用自动完成选项输入。

此外，“编辑”字段的默认值是从未硬编码的数据库中提取的。我是asp.net mvc的新手，请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T16:21:14.823

我之前使用自动完成逻辑的视图没有连接到模型。我按照这个来解决问题[http://blogs.msdn.com/b/stuartleeks/archive/2012/04/23/asp-net-mvc-amp-jquery-ui-autocomplete.aspx](http://blogs.msdn.com/b/stuartleeks/archive/2012/04/23/asp-net-mvc-amp-jquery-ui-autocomplete.aspx)

# asp.net-mvc-3 - MVC 3 RAZOR - 如何使用隐藏字段来维护页面请求之间的复选框状态？

> ID：13420105
> 
> 赞同：0
> 
> 时间：2012-11-16T16:00:37.143
> 
> 标签：asp.net-mvc-3, razor, checkbox, hidden-field

我正在使用隐藏字段来维护页面请求之间的复选框状态，除非它不起作用。因此，当我单击我的 webgrid 转到接下来的 15 条记录时，它会忘记选中了哪些复选框。

**索引视图**

```
@model IEnumerable<UserManager.Models.vw_UserManager_Model>
@{
    ViewBag.Title = "User Manager Dashboard";
}
@Html.ActionLink("Create New User", "CreateUser")
@using (@Html.BeginForm())
{
    <div class="webgrid-filter">
        @{Html.RenderAction("_WebGridFilter", "UserManager");}
    </div>

    <div id="webgrid-wrapper">
        @Html.Partial("~/Views/Partial/_WebGridUserManager.cshtml", Model)
    </div>
    <br />
}
<script type="text/javascript">
    $(document).ready(function () {

        // Disable checkboxs where a user is not active.
        $(".webgrid-wrapper input:not(:checked)").attr("disabled", "disabled");

        // Style tables.
        function jQueryUIStyling() {
            $('input:button, input:submit').button();

            $('.webgrid-wrapper').addClass('ui-grid ui-widget ui-widget-content ui-corner-all');
            $('.webgrid-title').addClass('ui-grid-header ui-widget-header ui-corner-top');
            jQueryTableStyling();
        } // end of jQueryUIStyling

        function jQueryTableStyling() {
            $('.webgrid').addClass('ui-grid-content ui-widget-content');
            $('.webgrid-header').addClass('ui-state-default');
            $('.webgrid-footer').addClass('ui-grid-footer ui-widget-header ui-corner-bottom ui-helper-clearfix');
        } // end of jQueryTableStyling
    });
</script>
<script type="text/javascript">

    function filterGrid() {
        var filters = getFilterVals();
        $.ajax({
            url: '@Url.Action("Index", "UserManager")',
            type: "POST",
            async: true,
            dataType: "html",
            data: "alfConnect=" + filters.alfConnect + "&" + "alfIntelligence=" + filters.alfIntelligence + "&" + "brad=" + filters.brad,
            success: function (data) {
                $('#webgrid-wrapper').empty().html(data);
                //                $('#webgrid-wrapper').html(data);
            }
        });
    }

    function getFilterVals() {
        filters = new Object();
        if ($('.webgrid-filter #chkFilterAlfIntell').is(':checked')) {
            filters.alfIntelligence = 1;
        }
        else {
            filters.alfIntelligence = 0;
        }

        if ($('.webgrid-filter #chkFilterAlfConn').is(':checked')) {
            filters.alfConnect = 1;
        }
        else {
            filters.alfConnect = 0;
        }

        if ($('.webgrid-filter #chkFilterBrad').is(':checked')) {
            filters.brad = 1;
        }
        else {
            filters.brad = 0;
        }
        return filters;

    }

    function logUserOff(url) {
        var answer = confirm('Are you sure you want to save this data?')
        if (answer) {
            //            alert(url + ": " + value);

            $.ajax({
                url: url,
                type: "POST"
                //                data: value
            }).done(function () {
                $(this).addClass("done");
            });

            return true;
        }
        else {
            return false;
        }
    };
</script> 
```

**带有隐藏字段的局部视图**

```
@model UserManager.Models.webgrid_validation
<b>@Html.Label("Select a filter: ")</b>
<br />

@Html.Label("Toggle ALF Intelligence users:")
@Html.CheckBoxFor(model => model.chkBoxAlfIntelligence, new
{
    id = "chkFilterAlfIntell",
    onclick = "filterGrid()",
    @checked = "checked"

})
@Html.Hidden("hdnAlfIntelligence", Model.chkBoxAlfIntelligence)

@Html.Label("Toggle ALF Connect users:")
@Html.CheckBoxFor(model => model.chkBoxAlfConnect, new
{
    id = "chkFilterAlfConn",
    onclick = "filterGrid()",
    @checked = "checked"
})
@Html.Hidden("hdnAlfConnect", Model.chkBoxAlfConnect)

@Html.Label("Toggle BRAD users:")
@Html.CheckBoxFor(model => model.chkBoxBrad, new
{
    id = "chkFilterBrad",
    onclick = "filterGrid()",
    @checked = "checked"

})
@Html.Hidden("hdnBrad", Model.chkBoxBrad) 
```

**控制器**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using UserManager.Models;

namespace UserManager.Controllers
{
    public class UserManagerController : Controller
    {
        //
        // GET: /UserManager/

        public ActionResult Index()
        {
            try
            {
                var model = new UserManagerTestEntities().vw_UserManager_Model;
                return View(model.ToList());

            }
            catch (Exception ex)
            {
                return View(ViewBag);
            }

        }

        [HttpPost]
        public ActionResult Index(int alfConnect, int alfIntelligence, int brad)
        {
            List<UserManager.Models.vw_UserManager_Model> modelList = DAL.getGrid(alfConnect, alfIntelligence, brad);

                        switch (alfConnect)
            {
                case 1:
                    ViewData["chkBoxAlfConnect"] = 1;
                    break;
                case 0:
                    ViewData["chkBoxAlfConnect"] = 0;
                    break;
            }

            switch (alfIntelligence)
            {
                case 1:
                    ViewData["chkBoxAlfIntelligence"] = 1;
                    break;
                case 0:
                    ViewData["chkBoxAlfIntelligence"] = 0;
                    break;
            }

            switch (brad)
            {
                case 1:
                    ViewData["chkBoxBrad"] = 1;
                    break;
                case 0:
                    ViewData["chkBoxBrad"] = 0;
                    break;
            }

            return PartialView("~/Views/Partial/_WebGridUserManager.cshtml", modelList);  
        }

        [ChildActionOnly]
        public ActionResult _WebGridFilter ()
        {
            UserManager.Models.webgrid_validation model = new webgrid_validation();

            return PartialView("~/Views/Partial/_WebGridFilter.cshtml", model);
        }

        //public ActionResult _WebGridFilter(int alfConnect, int alfIntelligence, int brad)
        //{
        //    UserManager.Models.webgrid_validation model = new webgrid_validation();

            //switch (alfConnect)
            //{
            //    case 1:
            //        model.chkBoxAlfConnect = true;
            //        break;
            //    case 0:
            //        model.chkBoxAlfConnect = false;
            //        break;
            //}

            //switch (alfIntelligence)
            //{
            //    case 1:
            //        model.chkBoxAlfIntelligence = true;
            //        break;
            //    case 0:
            //        model.chkBoxAlfIntelligence = false;
            //        break;
            //}

            //switch (brad)
            //{
            //    case 1:
            //        model.chkBoxBrad = true;
            //        break;
            //    case 0:
            //        model.chkBoxBrad = false;
            //        break;
            //}
        //    return PartialView("~/Views/Partial/_WebGridFilter.cshtml", model);
        //}

        #region ajaxMethods
        public ActionResult LookUpGroupName(string q, int limit)
        {

            try
            {
                //TODO: Map list to autocomplete textbox control
                DAL d = new DAL();
                List<string> groups = d.groups();

                var GroupValue = groups
                    .Where(x => x.Contains(q))
                    .OrderBy(x => x)
                    .Take(limit)
                    .Select(r => new { group = r });

                // Return the result set as JSON
                return Json(GroupValue, JsonRequestBehavior.AllowGet);
            }
            catch (Exception ex)
            {
                return View(ex.ToString());
            }
        }

        public ActionResult LogUserOff(string userid)
        {

            try
            {
                //TODO: Map list to autocomplete textbox control

                return View();

            }
            catch (Exception ex)
            {
                return View(ex.ToString());
            }
        }

        //[HttpPost]
        //public ActionResult FilterGrid(int alfConnect, int alfIntelligence, int brad)
        //{
        //    List<UserManager.Models.vw_UserManager_Model> modelList  = DAL.getGrid(alfConnect, alfIntelligence, brad);

        //    return PartialView("_WebGridUserManager", modelList);
        //}

        #endregion

        #region crud
        public ActionResult CreateUser()
        {
            //var data = new UserManager.Models.UserManagerTestEntities();
            ViewBag.Message = "Create New User";
            var model = new vw_UserManager_Model();
            return View(model);
        }

        [HttpPost]
        public ActionResult CreateUser (vw_UserManager_Model model)
        {

                int outcome = 0;
                if (ModelState.IsValid)
                {
                    //var data = new UserManager.Models.UserManagerTestEntities();
                    // Pass model to Data Layer
                     outcome = UserManager.DAL.CreateUser(model, outcome);
                    //data.SaveChanges();
                }

                if (outcome > 0) // Success
                {

                    return RedirectToAction("showSuccess", model);

                }
                else // Failure
                {
                    return RedirectToAction("showError", new { ErrorMessage = "Error" });
                }
        }

        public ActionResult EditUser(Guid userid, string salutation, string firstname, string lastname, string password, Nullable<bool> isactive,  Nullable<int> maxconcurrentusers, string email, string module, string group)
        {
            vw_UserManager_Model editUser = new vw_UserManager_Model();
            editUser.userid = userid;
            editUser.salutation = salutation;
            editUser.firstname = firstname;
            editUser.lastname = lastname;
            editUser.password = password;
            editUser.isactive = isactive;
            editUser.MaxConcurrentUsers = maxconcurrentusers;
            editUser.email = email;
            editUser.module_name = module;
            editUser.group_name = group;
            return View(editUser);
        }

        [HttpPost]
        public ActionResult EditUser(vw_UserManager_Model editUser)
        {
            if (ModelState.IsValid)
            {
                UserManager.DAL.EditUser(editUser);
            }

            return View();
        }

        public ActionResult DeleteUser(Guid userid, string username, string salutation, string firstname, string lastname, string password, bool isactive, string email, string module, string group)
        {
            vw_UserManager_Model DeleteUser = new vw_UserManager_Model();
            DeleteUser.userid = userid;
            DeleteUser.UserName = username;
            DeleteUser.salutation = salutation;
            DeleteUser.firstname = firstname;
            DeleteUser.lastname = lastname;
            DeleteUser.password = password;
            DeleteUser.isactive = isactive;
            DeleteUser.email = email;
            DeleteUser.module_name = module;
            DeleteUser.group_name = group;

            return View(DeleteUser);
        }

        [HttpPost]
        public ActionResult DeleteUser(vw_UserManager_Model deleteUser)
        {
            if (ModelState.IsValid)
            {
                UserManager.DAL.DeleteUser(deleteUser);
                return RedirectToAction("showSuccess", new { SuccessMessage = "Success" });
            }

            return View();
        }
        #endregion crud

        #region successErrorHandling
        public ActionResult showError(List<string> ErrorMessage)
        {
                ViewBag.ErrorMessage = ErrorMessage[0];
                return View("ErrorMessageView");
        }

        public ActionResult showSuccess(vw_UserManager_Model model)
        {

            return View("SuccessMessageeView", model);
        }
        #endregion
    }
} 
```

我的问题是如何使用隐藏字段来维护页面请求之间的复选框状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T10:51:05.070

您可以删除表单并将数据作为 JSon 值发送到控制器，从而仅刷新需要刷新的页面部分。

问候

# xslt - 使用带有主题的重氮将类添加到正文标签已启用

> ID：13420114
> 
> 赞同：7
> 
> 时间：2012-11-16T16:01:05.410
> 
> 标签：xslt, plone, diazo

我想知道如何使用带有主题的 Diazo 将类添加到 body 标签。我将`if-content`用来检查是否`portal-column-two`存在，并根据此将一个类放入 body 标签中。

一种解决方案是：

```
<replace theme="/html/body/@class">
  <xsl:attribute name="class"><xsl:copy-of select="." /> three_col</xsl:attribute>
</replace> 
```

并在此处进行了描述： [使用带有 notheme 的 diazo 将类添加到 body 标签，](https://stackoverflow.com/questions/11672440/add-class-to-body-tag-using-diazo-with-notheme)但仅在设置 notheme 时才有效。

那么我怎样才能将一个简单的附加 css 类即时放入 body 标记中呢？

编辑：这适用于纯重氮与主题和克隆（plone.app.theming）：

```
<before theme-children="/html/body"><xsl:attribute name="class"><xsl:value-of select="/html/body/@class" /> three_col</xsl:attribute>
</before> 
```

并根据条件：

```
<before theme-children="/html/body" css:if-content="#portal-column-two">
  <xsl:attribute name="class"><xsl:value-of select="/html/body/@class" /> three_col</xsl:attribute>
</before>
<before theme-children="/html/body" css:if-not-content="#portal-column-two">
  <xsl:attribute name="class"><xsl:value-of select="/html/body/@class" /> two_col</xsl:attribute>
</before> 
```

我的最终解决方案在这里描述：[https ://plone-theming-with-diazo.readthedocs.org/en/latest/snippets_diazo/recipes/index.html#add-css-class-depending-on-existing-portal-columns](https://plone-theming-with-diazo.readthedocs.org/en/latest/snippets_diazo/recipes/index.html#add-css-class-depending-on-existing-portal-columns)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T13:46:40.037

@MrTango 使用的解决方案在这里描述：[https ://plone-theming-with-diazo.readthedocs.org/en/latest/snippets_diazo/recipes/index.html#add-css-class-depending-on-existing-门户列](https://plone-theming-with-diazo.readthedocs.org/en/latest/snippets_diazo/recipes/index.html#add-css-class-depending-on-existing-portal-columns)

# java - 在 JSONObject 中填充引号

> ID：13420115
> 
> 赞同：6
> 
> 时间：2012-11-16T16:01:08.187
> 
> 标签：java, android, json

我正在构建一个 JSON 字符串以发送到我的 Web 服务。由于其中一个部分是用户输入的，因此可能会出现双引号。我试图通过逃避它来解决这个问题。

```
String strValue = "height of 6\"";
JSONObject json = new JSONObject();
json.put("key", strValue.replaceAll("\"","\\\"")); 
```

这里的问题是当我这样做时`json.toString()`，我得到 3 个斜线。

前任：

```
{"key","height of 6\\\""} 
```

如果我不尝试进行任何替换，`json.toString()`则会给我损坏的 json。

前任：

```
{"key", "height of 6""} 
```

我怎样才能正确地做到这一点？

注意：当我的网站保存这个值并显示它时，它会显示`height of 6\"`

更新：

看来罪魁祸首是`json.toString()`

当我调用该`replaceAll`方法时 - 正确 - 只转义双引号。它似乎`json.toString()`逃脱了斜线。要解决这个问题，我必须这样做`json.toString().replace("\\\\", "")`。这就引出了一个问题：为什么 JSONObject 转义斜杠而不是双引号？？？？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T17:25:46.877

看来罪魁祸首是`json.toString()`

当我调用 replaceAll 方法时，它——正确——只转义双引号。它似乎`json.toString()`逃脱了斜线。要解决这个问题，我必须这样做`json.toString().replace("\\\\", "")`。

这就引出了一个问题：为什么 JSONObject 转义斜杠而不是双引号？？？？？？

# macos - 如何在 CMake 脚本中获取应用程序包的路径以将其提供给 fixup_bundle()？

> ID：13420117
> 
> 赞同：4
> 
> 时间：2012-11-16T16:01:14.440
> 
> 标签：macos, qt, cmake, bundle

我有一个用 C++、Qt 和一点 Objective C 编写的 Win 和 Mac OSX 平台的跨平台应用程序。在支持两个不相关的平台特定项目（VS 2010 和 xCode）一段时间后，我们决定创建一个单一的 CMake脚本。我们生成一个特定于平台的项目并使用它。

经过相当长时间的研究，我设法编译并链接了我的应用程序。但是创建一个合适的包仍然有很多问题（没有任何努力，xCode 只是创建了一个二进制文件）。设置一些变量后，xCode 编译并创建一个没有 plist 文件和应用程序可执行文件的虚拟包。所以我需要将所有必需的框架和资源复制到包中。

我尝试了几种方法来创建捆绑包。第一个是使用`SET_SOURCE_FILES_PROPERTIES( ${resourcePath} PROPERTIES MACOSX_PACKAGE_LOCATION ${pathInsideBundle} )`并将它们（框架\资源）添加到 ADD_EXECUTABLE 中，如下所示：`ADD_EXECUTABLE( FranchiseTracker MACOSX_BUNDLE ${headers} ${sources} ${form_headers} ${resources_rcc} ${thirdparty_sources} ${BUNDLE_COPY_RESOURCES} )`。它成功了 - 我已经设法将图标和 Sparkle 框架复制到包中，但问题是我无法复制 Qt 框架，因为变量`FIND_PACKAGE`为空`${QT_LIBRARIES}`，所以我无法获得路径“手动”复制框架。

现在我将使用“fix_bundle”方法，因为它保证我可以在没有我干预的情况下复制所有必需的资源。所以，这是我与 fixup_bundle() 相关的代码：

```
# Fixup bundle, copy dynamic libraries into app bundle
SET( EXECUTABLE_OUTPUT_PATH ${CMAKE_CURRENT_BINARY_DIR}/out )
SET( APPS "\${CMAKE_CURRENT_BINARY_DIR}/out/${APP_NAME}.app" ) # paths to executables
SET( DIRS "${CMAKE_SOURCE_DIR}/osx/FRP/vendors/libraries/lib" ) # directories to search for prerequisites
INSTALL( CODE "
    include(BundleUtilities)
    fixup_bundle(\"${APPS}\" \"\" \"${DIRS}\")
") 
```

现在我被一点细化难住了。事情是顽固的 xCode 坚持生成和写入我的包`${CMAKE_CURRENT_BINARY_DIR}/out/Debug`，因此 fixup_bundle 根本找不到任何包。

**我的具体问题**（如标题所示）：如何在 CMake 脚本中获得正确的路径（带调试）？我想避免使用 Debug 对路径进行硬编码，因为在存档的情况下这将是错误的。

**我更常见的问题**是：有没有更简单的方法可以使用 CMake 为 Qt 应用程序创建包？也许我的整个方法都是错误的？

**PS我已在**[此处](https://codereview.stackexchange.com/questions/18706/how-to-do-this-cmake-script-in-a-right-way)将完整的脚本发布到 Code Review中。

**PPS**对于那些认为我的问题过于冗长的人。我发布了完整的脚本并编写了我的尝试（除了我想让它工作）的原因是互联网上几乎没有关于在 CMake 中使用 Mac OSX 框架、包等的信息。我不得不阅读大量的邮件列表，因为我找不到任何结构化的教程或至少一个像样的文档。学习的唯一来源是其他人编写的其他脚本。所以我希望我的脚本和解释对某人有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T16:39:55.190

我已经完成了仅`macdeployqt`在 Mac OSX 平台上使用该实用程序的操作。我使用 xCode 来构建我的应用程序，所以我用 xCode 的宏解决了路径问题，`${CONFIGURATION}`如下所示：

```
....
elseif( APPLE )
    ADD_EXECUTABLE( FranchiseTracker MACOSX_BUNDLE ${headers} ${sources} ${form_headers} ${resources_rcc} ${thirdparty_sources} ${BUNDLE_COPY_RESOURCES} )
    SET_TARGET_PROPERTIES( FranchiseTracker PROPERTIES OUTPUT_NAME ${APP_NAME} )
    SET_TARGET_PROPERTIES( FranchiseTracker PROPERTIES MACOSX_BUNDLE_INFO_PLIST "${CMAKE_SOURCE_DIR}/osx/FRP/info.plist") #or else you'll get an auto generated plist

    # Fixup bundle, copy dynamic libraries into app bundle
    ADD_CUSTOM_COMMAND( TARGET FranchiseTracker COMMAND macdeployqt ARGS ${CMAKE_CURRENT_BINARY_DIR}/\${CONFIGURATION}/${APP_NAME}.app ) # add -dmg for an image
endif( WIN32 ) 
```

注意转义 $ 字符以防止`${CONFIGURATION}`被扩展为 CMake 变量。

**PS**我发布到 CodeReview 的代码有点过时了，所以如果有人遇到同样的问题（在 OSX 上创建捆绑包）并想查看完整的工作变体，请告诉我，我会在某处发布（也许更新我在 CodeReview 上的帖子）。

# c# - 实体框架 - InverseProperty 和 IQueryable（或等效）

> ID：13420121
> 
> 赞同：4
> 
> 时间：2012-11-16T16:01:36.507
> 
> 标签：c#, .net, entity-framework-4.1

我对 EF (v4.1) 还是很陌生，所以如果我错了，请纠正我，但如果我有一个 InverseProperty 如下：

```
public virtual ICollection<ItemComment> Comments { get; set; } 
```

这将在访问属性时延迟加载。但是，如果我希望过滤此列表 - 例如，仅获取活动评论，我可以添加另一个属性，如下所示：

```
public IEnumerable<ItemComment> ActiveComments {
    get { return Comments.Where(x => x.IsActive); }
} 
```

但是，这会先加载整个 Comments 集合，然后过滤，对吗？所以不使用 IQueryable？为了性能，理想情况下我想使用 IQueryable 获取列表。

所以我的问题是，这可以使用这样的实体的属性来完成吗？还是我必须直接在 ItemComments 上做一个 where：

```
var comments = itemCommentRepository.QueryAll()
    .Where(x => x.IsActive && x.ItemId == XX). 
```

这显然会奏效......但我想知道是否有更好的解决方案？

更新：似乎整个结果集都已加载，并且任何过滤都将在整个数据集客户端完成。除了 hack 或更改实体以传递上下文（糟糕！）之外，似乎没有内置的方法可以这样做。已将@Slauma 的回复标记为答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:15:41.543

> 这将首先加载整个评论集合，然后过滤对吗？

是的。

> 这可以使用实体的属性来完成吗

理论上，通过将存储库甚至上下文注入实体构造函数。但是您的 POCO 实体将依赖于数据访问层。我不喜欢这个解决方案。

您提出的解决方案是一种方法。您也可以使用显式加载：

```
itemRepository.LoadActiveComments(item); 
```

像这样实现：

```
void LoadActiveComments(Item item)
{
    context.Entry(item).Collection(i => i.Comments).Query()
        .Where(c => c.IsActive).Load();
} 
```

# android - 将 Android 调试器附加到使用我不拥有的 Eclipse 项目构建的进程

> ID：13420122
> 
> 赞同：3
> 
> 时间：2012-11-16T16:01:36.133
> 
> 标签：android, debugging

我想调试我没有用于构建它的原始 Eclipse 项目的 Android 应用程序的一部分。

我已经构建了一个`.jar`实现 Android 活动的文件。我使用 Eclipse 来开发和调试它，并使用适当的类`javac/jar`来构建它。`.jar`将`.jar`其运送给客户，然后客户将其构建到他们的应用程序中。

现在他们希望我调试一些东西，并为他们的应用程序提供了一个 .apk 来调用`android.os.Debug.waitForDebugger()`. 我没有他们的源代码或项目。我安装并运行该应用程序，当它调用该调用时，我在 Eclipse DDMS 选项卡中看到该进程正在等待附件（它有红色的错误图标）。当我尝试附加到 Eclipse 中的进程时，通过单击“调试所选进程”按钮，我收到以下错误消息：

*没有为 <their-app-package-name> 找到打开的项目。调试会话失败！*

在没有原始应用程序项目的情况下，有没有办法让我附加到这个过程？如果不是，我将诉诸`android.util.Log`声明，但出于显而易见的原因，我宁愿不这样做。

正如我在上面所写的，我有自己的项目，其中包含用于构建`.jar`该应用程序的所有源代码。我已经尝试在我的测试项目清单中更改包名称，但就 Eclipse 而言，这似乎并没有改变任何东西。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T17:55:53.777

回答我自己的问题——我创建了远程 Java 应用程序类型的调试配置，并指定了 DDMS 窗口中显示的端口。我假设我可以使用任何符合 JDWP 的调试器来执行此操作。

# haskell - OpenCL 准引用

> ID：13420137
> 
> 赞同：4
> 
> 时间：2012-11-16T16:02:23.667
> 
> 标签：haskell, opencl

我正在寻找一种在 Haskell 中很好地使用 OpenCL 的方法，并找到了 Benedict Gaster 的[这些幻灯片](http://amddevcentral.com/afds/assets/presentations/2910_3_final.pdf)（[替代来源](http://benedictgaster.org/wp-content/uploads/2012/08/2910_3_final.pdf)）。他们提到了令人印象深刻的“HOpenCL 上下文 API”，但我找不到任何有形的东西。

唯一接近显示的 C quasiquotation 似乎是[language-c-quote](https://github.com/mainland/language-c-quote/blob/master/Language/C/Quote/OpenCL.hs)并且它的 OpenCL-C 支持以类型结束，它不支持额外的关键字。

而[加速](https://github.com/AccelerateHS)则完全不同，主要针对 CUDA，OpenCL 后端处于早期 alpha 阶段。

然后是[HIPERFIT](https://github.com/HIPERFIT)，一年没有发布代码（但项目仍在运行），它似乎结合了 C quasiquotation 和 OpenCL，它们的绑定甚至被称为 HOpenCL，但只是一个包装器，单子变换没什么可看的等等

这一切似乎都还没有接近完成并准备好建立......</p>

我错过了任何新闻或其他项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T14:22:13.813

我正在寻找完全相同的东西，我遇到了这个：[https ://github.com/bgaster/hopencl](https://github.com/bgaster/hopencl)

这一定是不再为 AMD 工作的 Benedict Gaster 所说的。git 上的活动量不是很大，但大约 2 个月前有一次更新，仍然比一年好。

编辑：实际上 J. Garret Morris（HOpenCL 的另一位作者）创建了一个分支：[https ://github.com/jgbm/hopencl](https://github.com/jgbm/hopencl)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-08T12:53:45.873

现在第一次看到你在这里发帖。我是 HIPERFIT-hopencl 包的作者，并且对 language-c-quote OpenCL C 支持有点负责。我为命名混乱道歉，我们现在有两个希望包。我已经向 Benedict Gaster 和 J. Garret Morris 邮寄了关于我们如何解决这个问题的邮件。

您发现语言-c-quote 中缺少什么？你能举一个它不处理的 OpenCL C 代码的例子吗？

（PS。我是新来的，找不到评论你的帖子的方法，所以我不得不发布这个作为答案——也许我还没有达到正确的“清除水平”）

# vim - 为什么当我开始一个新会话时 Vim 不使用我的键映射？

> ID：13420142
> 
> 赞同：0
> 
> 时间：2012-11-16T16:02:31.170
> 
> 标签：vim, keymapping

按以下顺序在 Vim 中映射 F2 键后，它在新的 Vim 会话中不起作用：

```
:map <F2> :ls<CR> 
```

在此处按 F2 显示文件。

```
:mkexrc! 
```

关闭 Vim。

重新打开 Vim。

现在按 F2 什么也不做。

映射在 _exrc 文件中可见：

```
map <F2> :ls 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:30:37.173

我认为您只是缺少文字`<CR>`. 在命令行中键入此命令，然后按 Enter。

```
:map <F2> :ls<CR> 
```

如果它不起作用……</p>

1.  查看该`_exrc`文件是否由 Vim 执行：`:scriptnames`应该在顶部附近显示它。

2.  如果执行了，看看是否`<F2>`映射到别处：`:verbose map <F2>`.

无论如何，Vim 不是 Vi。你应该使用`:mkvimrc!`. 还是正常的`$HOME/_vimrc`。

***编辑***

仅供参考，我刚刚创建了一个`~/.exrc`文件`:mkexrc!`，Vim 在启动时没有执行它。您绝对应该使用普通的`$HOME/_vimrc`.

# node.js - 如何调用自定义 asnyc 代码来初始化 Node.io 作业一次（在连续调用 input() 之前）？

> ID：13420143
> 
> 赞同：0
> 
> 时间：2012-11-16T16:02:32.617
> 
> 标签：node.js, node.io

刚刚发现[Node.io](https://github.com/chriso/node.io)，浏览了文档、api 等，它看起来很棒。但是，在构建我的第一份工作`exports.job = new nodeio.Job(..)`时，`input, run,output, reduce, complete`我需要某种`initialize()`方法，这种方法在连续调用`input()`完成之前调用一次。`complete`（在工作完成之前调用一次类似的方法）

周围有这样的方法吗？

为了完整性：此代码恕我直言必须是 node.io 流程的一部分（通过一些专用方法），因为在 node.io 范围之外初始化我的异步代码并不能保证在 node.io 作业之前数据已经存在执行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T23:09:34.730

不知道有没有这样的方法，你浏览过源码了吗？看起来有一个“init”方法，如果处理器在工作，它会调用它。如果您尝试这样做，但它不是您想要的，您可以在[node.io github 站点上将](https://github.com/chriso/node.io/issues)其作为一项功能提出建议。

否则，这将是一个非常简单的添加自己的东西。只需向您的对象添加一个“初始化”方法，然后将以下行放在“输入”或“运行”方法的顶部（如果您需要数据已经准备好，我认为这可能会更好）：

```
if (!this.initialized) {
   this.initialized = true;
   this.initialize();
} 
```

请注意，当然，这里对性能的影响很小。但在大多数情况下，这只是检查一个变量的值所花费的时间，与您实际需要的处理量相比，这可能非常少。

# c# - 如何排队和取消多个事件？

> ID：13420146
> 
> 赞同：0
> 
> 时间：2012-11-16T16:02:57.707
> 
> 标签：c#, cancellationtokensource

假设我们有一个触发以下方法的事件：

```
 public static void DoSomeWork(object obj)
    {
        CancellationTokenSource cts = (CancellationTokenSource)obj;
        if (cts.IsCancellationRequested) 
            return;
        Console.WriteLine("Started thread {0}.", Name);
        for (int i = 0; i < 3; i++)
        {
            Console.WriteLine("Working on thread {0} at step {1}.", Name, i);
            Thread.Sleep(10000);
            if (cts.IsCancellationRequested)
            {
                Console.WriteLine("Canceled thread {0} at step {1}.", Name, i);
                return;
            }
        }
        Console.WriteLine("Completed thread {0}.", Name);
    } 
```

您可以忽略该`Name`变量，因为原始对象是包含名称作为字符串和`CancellationTokenSource`. 据我了解，如果我在检测到之后`ManualResetEvent.WaitOne()`调用，我可以使用等待取消完成。如果我只有一个新事件要处理，这似乎工作正常。但是，如果我在当前进程取消时多次触发此事件，它现在会同时运行这两个事件。期望的结果是最近事件之前的所有事件都被取消并且处理在最近的事件上运行。`ManualResetEvent.Set()``cts.IsCancellationRequested == true`

我怎样才能使这项工作？我在正确的轨道上吗？如果我可以提供任何其他信息来帮助回答这个问题，请告诉我。

# java - Java内部类的使用和实例化

> ID：13420151
> 
> 赞同：9
> 
> 时间：2012-11-16T16:03:26.487
> 
> 标签：java, swing, user-interface, inner-classes

前段时间我用Java写了一个小图像查看器/处理程序，一个迷你Photoshop，如果你愿意的话。

我希望有一个下拉菜单，我可以在其中选择我打开的哪一张图像将是“在桌子上”，即。显示和应用的方法。我希望图像的名称是菜单中显示的 JMenuItem 的名称。我还希望在添加新图像时出现一个新按钮。

我想了一段时间，最后产生了这个解决方案，一个新的类，在添加图像时处理新按钮的创建。代码如下：

```
import java.awt.event.*;
import javax.swing.*;
import java.util.*;

public class ImageList{

    private ArrayList<JMenuItem> list;
    private ImageHandler main;
    private ImageLevel img;

    public ImageList() {}

    public void setHandler(ImageHandler hand) {
        main = hand;
        img = main.getImg1();
    }

    public void add(Buffer addi) {
        final String added = addi.getName();
        JMenuItem uusi = new JMenuItem(added);

        main.getMenu5().add(uusi);
        uusi.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                img.setBuffer(added);
                main.getScr().updateUI();
            }
        });
   }
} 
```

这可以正常工作。对于这个网站，我将原来的芬兰名字翻译成英文，想知道为什么我最初用芬兰语写它们……我不擅长命名。

方法 add 应该在程序运行时被多次调用。

我真正无法理解的是接口ActionListener的内部类实现，即它的编译和它是如何工作的。

如果我的界面上有两个按钮，我希望它们做不同的事情，我需要两个内部类，每个类一个，每个都有自己的接口 ActionListener 的内部实现。但是在我的代码中，有一个类似乎可以完成许多工作，一个为它编译的 .class 文件，但最终结果就像有很多一样。

有人可以就这个问题教育我吗？这里的代码是一类，新按钮是它的实例吗？他们是新课程吗？每个新按钮都应该有一个新的 .class 文件吗？ETC...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T16:10:15.613

通常，内部类在只调用一次的代码中实例化（例如，当您在构造函数中扩展`JPanel`并添加`ActionListeners`到`JButton`s 时）。在这里，您在多次调用的方法中实例化一个内部类（如果我正确理解您的描述）。每次调用`add()`，都会创建一个内部类的新实例。与命名类一样，只有*一个*类，但可能有很多实例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-16T16:15:57.453

在这段代码中：

```
public void add(Buffer addi) {
    . . .
    uusi.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            img.setBuffer(added);
            main.getScr().updateUI();
        }
    });
} 
```

该`new ActionListener() {...}`构造是一个匿名内部类。它的行为就好像它被单独声明为常规内部类一样。主要区别在于名称是由编译器自动生成的。它相当于：

```
private class Anonymous implements ActionListener {
    public void actionPerformed(ActionEvent e) {
        img.setBuffer(added);
        main.getScr().updateUI();
    }
}

public void add(Buffer addi) {
    . . .
    uusi.addActionListener(new Anonymous());
} 
```

每次执行`addActionListener`代码时，它都会创建此类的一个新实例。

匿名内部类还有一些其他限制，这些限制是匿名的后果。例如，如果他们声明了字段，则这些字段只能从类中访问（不使用反射）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:10:34.287

您正在为菜单项操作侦听器创建新的匿名类。

基本上，你的代码

```
menuItem.addActionListener(new ActionListener() {
  public void actionPerformed(ActionEvent e) {
      img.setBuffer(added);
      main.getScr().updateUI();
  }
}); 
```

为 ActionListener 定义一个新的类实现

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T16:13:58.833

*   `main.getScr().updateUI();`不是更新已经可见的 Swing 对象的正确方法，此方法对外观敏感

*   使用`JPanel`（不要忘记覆盖`PreferredSize`否则返回`Dimension (0, 0)`）与`paintComponent`，

*   如果你想删除然后添加一个新的容器来保存 Image 然后你必须调用`revalidate()`和`repaint()`

* * *

*   与图像一起使用`JList`，而不是`JMenuItem`

*   添加`ListSelectionListener`到`JList`，然后您可以在图像之间切换

* * *

*   如果没有在holds中添加任何其他`JComponent`（s），则与`Container``Image``JLabel``Icon / ImageIcon`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T16:17:11.643

您正在做的是创建接口 ActionListener 的匿名实现。每个匿名实现都有自己的类文件（称为 ImageList$1.class、ImageList$2.class 等）。

你也可以这样做，得到类似的结果：

```
class MyActionListener implements ActionListener {
    public void actionPerformed(ActionEvent e) {
      img.setBuffer(added);
      main.getScr().updateUI();
    }
};

menuItem.addActionListener(new MyActionListener()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-16T16:24:48.390

类中的内部类被编译到“父”.class 文件中。您可以在 1 个类中拥有多个内部类。（编译后生成 1.class 文件）每次对内部类（运行时）的“调用”都将创建该内部类的一个对象（与“规范类”相同）。但它不会改变你的 .class 文件。

因此，当添加 3 个相同类型的按钮时，每次都会创建一个内部类的新对象。与按钮本身的原理相同。

# html - 将不同的文本标题应用于 html 具有相同类的元素

> ID：13420153
> 
> 赞同：1
> 
> 时间：2012-11-16T16:03:30.583
> 
> 标签：html, css

我正在尝试使用该`<hr>`标签为我的网站的某些部分设置样式并包含不同的标题。我正在使用 CSS 伪元素将标题文本添加到`<hr>`元素中。

我的 HTML 看起来像：

```
<div id="steps">
    <div id="step1"><hr class="stepheading">contentcontent</div>
    <div id="step2"><hr class="stepheading">contentcontent</div>
    <div id="step3"><hr class="stepheading">contentcontent</div>
    <div id="step4"><hr class="stepheading">contentcontent</div>
</div> 
```

我的 CSS 看起来像：

```
hr.stepheading{
    padding: 0;
    border: none;
    border-top: medium double #333;
    text-align: center;
    color: #333;
    margin: 130px 0px;
}

hr.stepheading:after{
    content: "The First Step";
    position: relative;
    top: -0.7em;
    display: inline-block; 
    padding: 0 0.25em;
    background: white;
} 
```

因此，我可以看到问题在于我的每个标题都将包含“第一步”，而不是其他步骤的其他标题。

[**演示**](http://jsfiddle.net/bQBgL/16/)

我希望每个标题都有一个不同的标题：“第一步”、“第二步”等......

我该怎么做？我使用什么技术？这可以在纯 HTML 和 CSS 中完成，还是我必须使用 Javascript/JQuery 来实现我想要的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:08:26.210

`nth-child()`在`div`元素上使用：

```
hr.stepheading:after{
    content: "The First Step";
    position: relative;
    top: -0.7em;
    display: inline-block; 
    /* Other details */
}

div:nth-child(2) hr.stepheading:after{
    content: "The Second Step";
}
div:nth-child(3) hr.stepheading:after{
    content: "The Third Step";
}
div:nth-child(4) hr.stepheading:after{
    content: "The Fourth Step";
}​
​ 
```

演示：http: [//jsfiddle.net/bQBgL/4/](http://jsfiddle.net/bQBgL/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:09:39.307

```
#step2 hr.stepheading:after { content: "The Second Step"; }​
#step3 hr.stepheading:after { content: "The Third Step"; }​ 
```

ETC...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:14:12.570

检查这个演示：http: [//jsfiddle.net/gLQ37/](http://jsfiddle.net/gLQ37/)

HTML：

```
<div id="steps">
 <div id="step1"><h1 class="stepheading"id="hr1"></h1>contentcontent</div>
 <div id="step2"><h1 class="stepheading" id="hr2"></h1>contentcontent</div>
 <div id="step3"><h1 class="stepheading" id="hr3"></h1>contentcontent</div>
 <div id="step4"><h1 class="stepheading" id="hr4"></h1>contentcontent</div>
</div>​ 
```

CSS：

```
h1.stepheading{
padding: 0;
border: none;
border-top: medium double #333;
text-align: center;
color: #333;
margin: 130px 0px;
}

h1.stepheading:after{
position: relative;
top: -0.7em;
display: inline-block; 
padding: 0 0.25em;
background: white;
}

#hr1:after{content: "The First Step";}
#hr2:after{content: "The Second Step";}
#hr3:after{content: "The Third Step";}
#hr4:after{content: "The Fourth Step";}​ 
```

# asp.net-mvc - ASP.NET MVC 备用路由

> ID：13420156
> 
> 赞同：0
> 
> 时间：2012-11-16T16:03:38.520
> 
> 标签：asp.net-mvc, asp.net-mvc-3

有没有办法在 ASP.NET MVC v3 中进行回归路由处理？

这是我的商业案例示例：如果给定 URL “www.mysite.com/faq/Index”，我希望它检查控制器“FAQ”、操作“Index”是否存在路由

```
routes.MapRoute("Default","{controller}/{action}/{id}",
            new { id = UrlParameter.Optional }); 
```

如果无法解决，通常会抛出 404 错误。相反，我希望它使用这条路线：

```
routes.MapRoute("Content", "Content/{*contentPath}", 
            new { controller = "Content", action = "RenderPageByURL" }); 
```

如果失败，那么它应该返回 404。

我在想我可以创建一个自定义错误处理程序，但这似乎很笨拙。关于从哪里开始的任何想法？或者这是一个真正的坏主意(TM)，我应该回到企业并告诉他们使用正确的路径开始？谢谢。

*编辑*. 澄清一下，我不是想通过简单的 URL 匹配来查看它是否与路由匹配。我希望路由机制足够智能，可以知道路由是否成功并找到合适的控制器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:53:41.303

在 Globasl.asax.cs下定义`Content`路由。`Default`

```
routes.MapRoute("Default","{controller}/{action}/{id}",
            new { id = UrlParameter.Optional });

routes.MapRoute("Content", "Content/{*contentPath}", 
            new { controller = "Content", action = "RenderPageByURL" }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T15:15:02.373

我根据同事的建议和以下链接回答我的问题（谢谢，乔希！）：

[http://stephenwalther.com/archive/2008/08/07/asp-net-mvc-tip-30-create-custom-route-constraints.aspx](http://stephenwalther.com/archive/2008/08/07/asp-net-mvc-tip-30-create-custom-route-constraints.aspx)

基本上，我在路线上添加了一个自定义约束。

```
 routes.MapRoute("Content", "{*contentPath}", 
        new { controller = "Content", action = "RenderPageByURL" }, 
        new { matchController = new ContentRouteConstraint() });

 routes.MapRoute("Default","{controller}/{action}/{id}",
        new { id = UrlParameter.Optional }); 
```

ContentRouteConstraint() 实现了 IRouteConstraint，并且仅当 Match 方法与我们现有的路由控制器之一不匹配时才返回 true。如果 Match 方法在 ContentRouteConstraint() 上失败，那么它会下降到下一个路由。

这样做的好处是我可以在尝试生成 URL 时忽略此路由（我们希望在本例中这样做）。

# jquery - JSON 字符串太大

> ID：13420158
> 
> 赞同：4
> 
> 时间：2012-11-16T16:03:49.903
> 
> 标签：jquery, json, autocomplete

我正在使用一个使用 JSON 字符串来建议其数据的[jQuery 插件。](http://tomcoote.co.uk/wp-content/CodeBank/Demos/JSONSuggestBox/demo.html)

如果 JSON 字符串的元素少于 X，则一切正常。超过此限制没有任何反应，自动建议失败。我想这是因为有一种解析限制，但是我该如何绕过呢？我有一个 +5000 个元素的数组...

这是我的 json 代码：

```
var SearchTxt = '[{"t":"word one"},{"t":"word two"}, ...]'; 
```

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T18:00:03.553

[`$.getJSON()`](http://api.jquery.com/jQuery.getJSON/)正在使用该`GET`方法，该方法[受限于每个浏览器的不同长度](https://stackoverflow.com/a/812962/913097)。因此，在您的情况下，返回的结果显然超过了该限制。你想做的是改变

```
$.getJSON(settings.url,{search:text},function(data){if(data){buildResults(data,text);}
else{$(results).html('').hide();}}); 
```

在插件的源代码中放入

```
$.post(settings.url,{search:text},function(data){if(data){buildResults(data,text);}
else{$(results).html('').hide();}},'json'); 
```

这将使它`POST`改为执行请求。此外，请确保在您的服务器端脚本中将对全局`$_GET`数组的引用更改为（如果有）。`$_POST`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T09:05:11.843

好的，所以我终于找到了这个问题的根源。由于简单的引号导致解析错误......不要问我为什么它只开始发生在一定数量的元素上，而所有引号都已经转义。

好吧，所以我改变了这个：

```
var SearchTxt = '[{"t":"word one"},{"t":"word two"}, ...]'; 
```

至

```
var SearchTxt = [{"t":"word one"},{"t":"word two"}, ...]; 
```

它奏效了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:16:35.410

JSON 没有“解析限制”，任何限制都是由解析 JSON 请求的服务器设置的。

# javascript - 从 Javascript 中的字符串（从数组）中删除

> ID：13420163
> 
> 赞同：2
> 
> 时间：2012-11-16T16:04:14.297
> 
> 标签：javascript

> **可能重复：**
> [从字符串中删除一个单词](https://stackoverflow.com/questions/2533807/remove-a-word-from-a-string)

我有一个简单的字符串`var mystr = "Lorem ipsum dolor sit amet, consectetur adipiscing elit"`，我有一个数组`var lipsums = new Array("dolor","consectetur","elit");`现在，我想要一个简单的函数来删除字符串中的任何相同单词。

所以，在上面的例子中，它应该删除单词“dolor”、“consectetur”和“elit”，我的字符串`mystr`应该是`"Lorem ipsum sit amet, adipiscing"`

这个脚本应该是 Javascript（没有 jQuery）。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:06:57.113

像这样：

```
for(i=0; i<lipsums.length; i++) {
   mystr = mystr.replace(new RegExp(lipsums[i],"g"), "");
} 
```

在循环之后添加这个以删除双空格：

```
mystr = mystr.replace(/\s{2,}/g, ' '); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:07:32.673

遍历要删除的单词数组，通过 split/join 删除所有出现的单词：

```
for (var i = 0; i < lipsums.length; i++) {
    mystr = mystr.split(lipsums[i]).join('');
} 
```

[http://jsfiddle.net/9Rgzd/](http://jsfiddle.net/9Rgzd/)

您可能还想在之后清理空白，您可以使用正则表达式：

```
// Note: don't do this in the loop!
mystr = mystr.replace(/\s{2,}/g, ' '); 
```

[http://jsfiddle.net/9Rgzd/1/](http://jsfiddle.net/9Rgzd/1/)

# tfs - 在 TFS 中回滚单个文件

> ID：13420165
> 
> 赞同：73
> 
> 时间：2012-11-16T16:04:27.613
> 
> 标签：tfs

如果我在源代码管理中查看单个文件的历史记录，我可以右键单击列表中的更改集并选择“回滚整个更改集”。

这会回滚我在该签入期间签入的所有其他文件还是仅回滚我当前正在查看的文件？如果它确实回滚所有文件，有没有办法只回滚选定的文件？

谢谢

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-11-19T12:57:18.330

如前所述，回滚变更集会将其全部回滚。

安装**Team Foundation Power Tools**（我认为几乎每个人都应该安装）为您提供了另一种选择：如果您想回滚单个文件，您可以在源代码管理资源管理器中右键单击单个文件并选择**回滚...**

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-11-16T16:08:15.867

是的，回滚整个变更集将回滚其中的所有更改。

但是，回滚不是即时的，当您单击该选项时，回滚将执行反向合并并将更改保留在您的工作区中。因此，您可以在 Pending Changes 中查看它们。

在您的情况下，只需执行回滚，然后撤消除您实际要回滚的文件之外的所有内容。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2016-03-30T08:24:26.570

从现在开始，至少在 Visual Studio 2015 中，您可以转到源代码管理，右键单击文件并选择回滚。这将询问您要回滚该文件的哪些变更集，并且只会回滚该文件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-08-16T06:52:46.203

非常简单的解决方法:) 1\. 回滚整个变更集 2\. 撤消所有文件，除了你真正想要的文件。

# c# - MySQL 过程在 php 中有效，但在 asp.net (C#) 中无效

> ID：13420166
> 
> 赞同：-1
> 
> 时间：2012-11-16T16:04:32.190
> 
> 标签：c#, php, asp.net, mysql

我已经用 php 作为服务器语言建立了一个带有 MySQL 后端的网站，现在我将在 asp.net 中建立相同的网站

MySQL 数据库中定义了以下过程：

```
DELIMITER //
CREATE PROCEDURE Login(
    IN Username VARCHAR(16),
    IN UserPassword VARCHAR(16),
    OUT UID int,
    OUT SL INT,
    OUT SP VARCHAR(8),
    OUT MA BOOL)    -- missing admin entry
BEGIN
    DECLARE adminID INT DEFAULT -1;
    DECLARE lastTimeout DATETIME DEFAULT NULL;
    SET UID = -1;

    SELECT ID, SecurityLevel, LoginTimeout INTO UID, SL, lastTimeout
    FROM User
    WHERE User.UserName = Username and User.Password = UserPassword;

    IF NOW() > lastTimeout OR lastTimeOut IS NULL THEN
        IF lastTimeOut IS NOT NULL THEN
            INSERT INTO UserLog (UserID, Date, Action) VALUES (UID, NOW(), 'TIMEOUT');
        END IF;

        SELECT ID, Password INTO SL, SP
        FROM SecurityLevels
        WHERE ID = SL;

        SELECT UserID INTO adminID
        FROM Admin
        WHERE UserID = UID;

        IF adminID = -1 AND SL = 4 THEN SET MA = TRUE;
        ELSE SET MA = FALSE;
        END IF;

        IF UID != -1 THEN
            INSERT INTO UserLog (UserID, Date, Action) VALUES (UID, NOW(), 'LOGIN');
            UPDATE User SET User.LoginTimeOut = DATE_ADD(NOW(), INTERVAL 1 HOUR) WHERE User.ID = UID;
        END IF;
    ELSE
        SET UID = -1;
    END IF;

END //
DELIMITER ; 
```

我使用的用户是：

```
CREATE USER 'LOGIN'@'%' IDENTIFIED BY '6Jd8kKi0';
GRANT execute ON procedure b09xxxxx.Login TO 'LOGIN'@'%'; 
```

现在，在 php 中我这样做，它就像一个魅力：

```
$pdo = new PDO('mysql:dbname=b09xxxxx;host=wwwlab.xxx.xxx.se', 'LOGIN', '6Jd8kKi0');
$pdo->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_WARNING );

$userID = 0;
$securityLevel = 0;
$securityPassword = "";

//$sql = "SELECT UserName, ID, SecurityLevel FROM User WHERE UserName = '" . $_POST['username'] . "' and Password = '" . $_POST['password'] . "';";
$sql = "CALL Login(:USERNAME, :PASSWORD, @UID, @SL, @SP, @MA);";

$stmt = $pdo->prepare($sql);
$stmt->bindParam(':USERNAME', $_POST['username']);
$stmt->bindParam(':PASSWORD', $_POST['password']);
$stmt->execute();

//$q     = $pdo->query($sql) or die("ERROR:DB");

$sql = "SELECT @UID, @SL, @SP, @MA;";

$q   = $pdo->query($sql) or die("ERROR:DB");

$r = $q->fetch(PDO::FETCH_ASSOC); 
```

但是这个 asp.net (C#) 版本不起作用：

```
string connectionString = "Server=wwwlab.xxx.xxx.se; Database=b09xxxxx; User ID=LOGIN; Password=6Jd8kKi0; Pooling=false;";
MySqlConnection dbcon = new MySqlConnection(connectionString);
dbcon.Open();

//string query = "CALL Login(:USERNAME, :PASSWORD, @UID, @SL, @SP, @MA);";
//Now changed to this thanks to John Woo
string query = "Login";

MySqlCommand sqlCmd = new MySqlCommand(query, dbcon);
sqlCmd.CommandType = System.Data.CommandType.StoredProcedure;

sqlCmd.Parameters.AddWithValue(":USERNAME", loginUsername.Text);
sqlCmd.Parameters[":USERNAME"].Direction = ParameterDirection.Input;
sqlCmd.Parameters.AddWithValue(":PASSWORD", loginPassword.Text);
sqlCmd.Parameters[":PASSWORD"].Direction = ParameterDirection.Input;

sqlCmd.Parameters.Add(new MySqlParameter("@UID", MySqlDbType.Int64));
sqlCmd.Parameters["@UID"].Direction = ParameterDirection.Output;
sqlCmd.Parameters.Add(new MySqlParameter("@SL", MySqlDbType.Int64));
sqlCmd.Parameters["@SL"].Direction = ParameterDirection.Output;
sqlCmd.Parameters.Add(new MySqlParameter("@SP", MySqlDbType.String));
sqlCmd.Parameters["@SP"].Direction = ParameterDirection.Output;
sqlCmd.Parameters.Add(new MySqlParameter("@MA", MySqlDbType.Byte));
sqlCmd.Parameters["@MA"].Direction = ParameterDirection.Output;

sqlCmd.ExecuteNonQuery();

MySqlDataAdapter adapter = new MySqlDataAdapter("SELECT @UID, @SL, @SP, @MA;", dbcon);
DataSet ds = new DataSet();
adapter.Fill(ds, "result");

CustomerGrid.DataSource = ds.Tables["result"];
CustomerGrid.DataBind();               

dbcon.Close();http://stackoverflow.com/editing-help 
```

我收到以下错误：

`CALL Login(:USERNAME, :PASSWORD, @UID, @SL, @SP, @MA)`在数据库“ ”中找不到过程或函数“ `b09xxxxx`”。

编辑：现在这是新问题：SELECT command denied to user 'LOGIN'@'193.11.99.23' for table 'proc'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:57:30.453

我认为调用 .Fill 方法时正在生成错误。

更改以下代码；

```
MySqlDataAdapter adapter = new MySqlDataAdapter("SELECT @UID, @SL, @SP, @MA;", dbcon);
DataSet ds = new DataSet();
adapter.Fill(ds, "result");
CustomerGrid.DataSource = ds.Tables["result"]; 
```

和;

```
DataTable table = new DataTable();
table.Columns.Add("UID", typeof(int));
table.Columns.Add("SL", typeof(int));
table.Columns.Add("SP", typeof(string));
table.Columns.Add("MA", typeof(boolean));

table.Rows.Add(sqlCmd.Parameters["@UID"].Value, sqlCmd.Parameters["@SL"].Value, sqlCmd.Parameters["@SP"].Value, sqlCmd.Parameters["@MA"].Value);
CustomerGrid.DataSource = table 
```

# c# - ASP MVC 3 自定义路由

> ID：13420180
> 
> 赞同：1
> 
> 时间：2012-11-16T16:05:52.457
> 
> 标签：c#, asp.net-mvc, model-view-controller

我如何处理这样的网址：

```
{subdomain}.{domainname}/{areas}/{controller}/{action} 
```

例如：`user1.contoso.com/Manage/User/View`

我希望它是路线：

```
{area} = Manage
{controller} = User
{action} = View
{username} = user1 // View action parameter 
```

任何帮助将不胜感激 ：-）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:47:10.293

通常路由在文件**Global.asax**的方法 RegisterRoutes中定义

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "Export",                                                            // Route name
            "Export/{action}/{table}",                                       // URL with parameters
            new { controller = "Export", action = "AsExcel", table = "" }  // Parameter defaults
        );

        routes.MapRoute(
            "Default",                                              // Route name
            "{controller}/{action}/{id}",                           // URL with parameters
            new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
        );
    } 
```

使用上面的定义，您可以为**ExportController**使用单独的路由，以便默认操作是**AsExcel**

在您所描述的路线的情况下，我不确定***区域***是否是 MVC 模式的一部分。

仍然物有所值，您可能会从这个线程 [ASP.Net MVC 中获得一些好处，其中包含复杂的路由 - 如何保持“理智”？](https://stackoverflow.com/questions/9556831/asp-net-mvc-with-complex-routes-how-to-keep-it-sane)

# c - 动态库（.so）版本的兼容性

> ID：13420182
> 
> 赞同：0
> 
> 时间：2012-11-16T16:05:55.047
> 
> 标签：c, linux, gcc, linux-kernel, shared-libraries

我有一个在 centos 5 上编译和运行的软件，现在我很想在 Centos 6 上运行它，未经修改而无需在新机器上编译。

这是挑战：-
我的过程需要某些库，比如*libcap.so.1*，但 centos 6 有更新的版本，比如*libcap.so.2*
我能够使旧软件与以下任何黑客一起工作

1.  创建到 libcap.so.2 的符号链接（libcap.so.1）
2.  将 libcap.so.1 复制到新机器（centos 6）

两者之间推荐什么以及这种方法是否存在任何已知问题，在centos6上编译将是我的最后选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:13:16.407

创建这样的符号链接有时会起作用，具体取决于导致新版本的更改究竟是什么 - 它们必须是最小的更改，尤其是不会删除对旧库具有或彻底更改的任何例程/变量的访问保留的任何例程/变量的签名。如果库使用符号版本控制（如`gcc`标准 C 库那样），则该`.2`版本可能仍包含先前版本提供的完整 API，但我不知道是否`libpcap`这样做......

如果新库没有封装旧 API，那么最安全的选择是重新编译。如果您的应用程序不是关键任务，和/或您可以处理崩溃和数据损坏的可能性，那么尝试符号链接路由应该不会（太大）伤害......

# python - 如何在 python 中编写反向“猜我的号码”游戏？

> ID：13420186
> 
> 赞同：0
> 
> 时间：2012-11-16T16:06:12.870
> 
> 标签：python, python-3.x

我写了一个游戏，玩家试图猜测一个随机数（见下面的代码）。还提供了诸如“太低……”和“太高……”之类的建议。但是如果反过来让计算机猜测玩家选择的数字呢？我对此有困难，我不知道为什么。我认为我需要某人的“推动”，而不是实际的代码，因为我需要自己尝试。如果有人能帮助我，我将不胜感激。

这是玩家必须猜测数字的代码（Python 3）：

```
#Guess my Number - Exercise 3
#Limited to 5 guesses

import random 

attempts = 1
secret_number = random.randint(1,100)
isCorrect = False
guess = int(input("Take a guess: "))

while secret_number != guess and attempts < 6:

    if guess < secret_number:
        print("Higher...")
    elif guess > secret_number:
        print("Lower...")
    guess = int(input("Take a guess: "))
    attempts += 1

if attempts == 6:
    print("\nSorry you reached the maximum number of tries")
    print("The secret number was ",secret_number) 

else:
    print("\nYou guessed it! The number was " ,secret_number)
    print("You guessed it in ", attempts,"attempts")

input("\n\n Press the enter key to exit") 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T16:10:11.510

在循环的每次迭代中，您都需要一个新的`random.randint(low,high)`. `low`并且`high`可以通过将您的计算机猜测收集到 2 个列表 ( `low_list`) 和 ( `high_list`) 中来计算，这取决于当计算机告诉用户它是猜测时用户如何响应。然后你过去了`low`，`max(low_list)+1`你过去了`high`。`min(high_list)-1`当然，您必须初始化`low_list`并`high_list`使用允许的最低和最高数字。

您可以只保留“太高”猜测中的最低值和“too_low”猜测中的最高值，而不是列表。它的效率会稍微高一些，而且编写代码的工作量可能相同，但是你不能为了好玩而回顾计算机的猜测:)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:19:16.387

假设您知道它可能是（a，b）的数字范围。

考虑如何缩小范围。你会从中间猜测开始。如果你的猜测很低，你会在你最后的猜测和最高值之间进行猜测。如果它很高，您会在可能的最低值和最后一次猜测之间进行猜测。通过迭代缩小范围，最终你会找到这个数字。

这是一些伪代码：

```
loop{

guess = (a+b)/2

if high:
    b = guess - 1
else if low:
    a = guess + 1
else:
    guess = answer
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T16:17:44.033

您从最小允许数到最大允许数的范围开始，因为未知数可能在该范围内的任何位置。

每一步都需要选择一个数字进行查询，所以将空间分成两块；查询号码错误一侧的那些将被删除。在最少数量的查询中做到这一点的最有效方法是每次平分空间。

我建议您将游戏限制为整数，否则您最终会在公差和精度等浮点值方面遇到很多麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-24T23:29:21.477

我只是和另一个人一起做了这个，使用一个while循环并使用print（“<，>，=”），然后做一个if语句。您需要一个最大点、中间点和低点，要获得中间点，您需要执行 midpoint=((highpoint=lowpoint)//2) 并且在 if 语句中您必须更改最大点和低点。

# jquery-isotope - 带有起始大块的jQuery同位素不起作用

> ID：13420189
> 
> 赞同：3
> 
> 时间：2012-11-16T16:06:25.923
> 
> 标签：jquery-isotope

我创建了一个同位素页面，上面有许多不同的高度元素。大多数元素的宽度相同，但是我希望能够使用跨越前两列的“大”框来启动流程。

将较大的块放置在正常布局中是可以的，前提是 isoTope 从较小宽度的块之一开始。但是，如果我放入一个较大的，它会突然将所有内容放入一列，尽管我在 jQuery 语句中进行了任何设置（例如将列宽指定为 300 宽）。

有没有人可以查看我所做的并建议这是一个实际的错误还是我遗漏的东西？我尝试将大块放在底部，然后使用排序功能将其置于顶部，但同样的问题发生了。

[http://territorydigital.com/mmrs/index.html](http://territorydigital.com/mmrs/index.html) <- 这是起始大块 [http://territorydigital.com/mmrs/index2.html](http://territorydigital.com/mmrs/index2.html) <- 这只是普通块，后面有大块

任何帮助将不胜感激，因为我不确定我做错了什么！

干杯，

担

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T21:27:22.153

不知何故，这可能会奏效..

引自[http://isotope.metafizzy.co/docs/layout-modes.html](http://isotope.metafizzy.co/docs/layout-modes.html)

> Masonry 是 Isotope 的默认布局模式。项目元素在垂直网格内智能排列。对于每个项目元素，脚本计算网格中项目的下一个最佳拟合。
> 
> 网格中一列的宽度。***如果没有为 columnWidth 设置值，则默认为第一个 item 元素的宽度。***

解决方案将是

```
$('#container').isotope({
  masonry: {
    columnWidth: 1 // or any number smaller than your medium size box/item
  }
}); 
```

通过设置`columnWidth`为`'1'`，它将强制同位素使用定义的`columnWidth`而不是第一个元素的大小。因此，证明我从之前的回复中的回答是合理的（已删除：（）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-27T01:42:43.060

您现在可以将列宽设置为选择器，可能是一个仅用于查找未包含在布局中的事物大小的项目。排水沟也是如此。

看这里：

[http://isotope.metafizzy.co/layout-modes/masonry.html#columnwidth](http://isotope.metafizzy.co/layout-modes/masonry.html#columnwidth)

# jquery - 在现有内容之后将ajax内容加载到div中

> ID：13420190
> 
> 赞同：0
> 
> 时间：2012-11-16T16:06:36.060
> 
> 标签：jquery, ajax

我需要将网页的内容加载到我现有的页面中，特别是在现有内容之后，而不是太替换它。我需要在我希望将内容拉入的 div 中的最后一个 HR 标记之后执行此操作。

所以，我拥有的html是：

```
<article>
<p>My content</p>
</article>
<hr> 
```

`<hr>`所以我希望我的内容在该标签之后直接加载。但我试图在之后使用，它对`<hr>`标签做了一些奇怪的事情，试图让它成为`<hr>`我的 ajax 内容`</hr>`

```
$(document).ready(function(){
  $('.news-ajax-link').click(function(){
    $("article hr").after().load('/news/ajax_news/?offset=2');
    event.preventDefault();
  });
});
</script> 
```

任何帮助都会很棒！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:14:17.787

jQuery`.load()`函数专门设计用于将*内容加载到容器元素*中，因此它试图做的正是您告诉它的：在您的`<hr>`元素中加载该 URL 的内容。

如果您想在之后附加内容，`<hr>`您需要使用 jQuery 提供的其他 AJAX 函数之一 - 我建议使用[`jQuery.ajax()`](http://api.jquery.com/jQuery.ajax/)- 并在回调函数中自己进行附加：

```
$(document).ready(function(){
    $('.news-ajax-link').click(function(event){ // note the event parameter added here
        $.ajax({
            url: '/news/ajax_news/?offset=2',
            type: 'post',
            success: function(content) {
                $("article hr").after(content);
            });
        });
        event.preventDefault();
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:14:15.243

我想你可能需要关闭小时，所以使用这个

```
<hr /> 
```

否则 jQuery（或者可能是浏览器）认为它是一个未封闭的标签

编辑：实际上我认为问题出在 after()

after() 意味着有一个论点，所以试试这个：

```
.after(/*AJAXED content here*/); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:14:48.017

您可以尝试使用`.append()`而不是`.after()`.

或者也许添加一个`html`标签并`load()`进入它。

如

```
<article>
<p>My content</p>
</article>
<hr>
<span id="loadedContent"></span>

$(document).ready(function(){
   $('.news-ajax-link').click(function(){
     $("#loadedContent").load('/news/ajax_news/?offset=2');
    event.preventDefault();
   });
 }); 
```

# c# - 停止 SoundEffect 循环

> ID：13420193
> 
> 赞同：1
> 
> 时间：2012-11-16T16:06:50.990
> 
> 标签：c#, visual-studio, xna

我正在用 C#/XNA 构建一个游戏，它是一个顶视图赛车游戏，我想在我的车撞到墙上时播放声音效果。

问题是我的声音一直在循环，所以当我撞到墙时，歌曲会立即开始播放，但我想让它播放，等它播放完后，可以再次播放。

这是处理碰撞的代码：

`if (map[x][y] == 0)` `{` `car.speed = 0;`

```
crash.Play(); } 
```

请问我是否有不清楚的地方。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T17:37:57.417

这是您问题的完整答案：http: [//msdn.microsoft.com/en-us/library/dd940203.aspx](http://msdn.microsoft.com/en-us/library/dd940203.aspx)

```
SoundEffectInstance instance = soundEffect.CreateInstance();
instance.IsLooped = true; 
```

但是，默认情况下，SoundEffect 不应循环播放...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T16:34:35.840

调用[SoundEffect.CreateInstance()](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.audio.soundeffect.createinstance.aspx)以获取[SoundEffectInstance](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.audio.soundeffectinstance.aspx)。然后在调用[Play](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.audio.soundeffectinstance.play.aspx)之前将[IsLooped](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.audio.soundeffectinstance.islooped.aspx)属性设置为 false ：

```
crashSoundEffectInstance.IsLooped = false; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T16:11:52.037

您可能想查看`SoundEffectInstance`课程。这是一个如何正确使用它的[示例。](http://rbwhitaker.wikidot.com/playing-sound-effects)

可以查看音效状态是否在播放

**编辑：**我添加了一个更完整的代码，因为我觉得它是必要的。这与我提供的链接中的示例大致相同。（注：此代码未经测试）

```
//In your content load
SoundEffect crash;
crash = Content.Load<SoundEffect>("PathToYourSoundEffect");
SoundEffectInstance sei = crash.CreateInstance();

//In your update code
if(sei.State == SoundState.Stopped || sei.State == SoundState.Paused)
{
    sei.Play();
} 
```

# javascript - 带有条件的JQuery选择框循环

> ID：13420194
> 
> 赞同：2
> 
> 时间：2012-11-16T16:06:53.087
> 
> 标签：javascript, jquery, jquery-selectors

我尝试使用 JQuery 选择框和循环帮助问题中的内容，但似乎我的实现有点不同，我似乎无法使其工作。

我有一个 fromSelectBox 和一个 toSelectBox ，我试图在其中移动选项。我试图设置两个条件。如果选项 A 放置在 toSelectBox 一侧，它应该始终位于底部。如果选项 B 已经在 toSelectBox 一侧，则不应允许移动选项 B。

我做到了，所以我不能从列表底部移动选项 A 或 B，也不能移动 A 或 B 下面的任何东西，但是当我一次移动一组项目时，订单可能会被打乱。

基本上我想要做的是任何时候一个项目从fromSelectBox移动到toSelect框，它应该循环并在必要时使用。

这是我到目前为止所拥有的。

```
function resortOnMove() {
    $('select').each(function(){
       $('option', this).each(function(){
        if ($('#toSelectBox option:selected').val() == '03' || $('#toSelectBox option:selected').val() == '01') {
           alert("moving now");
            if ($('#toSelectBox option:selected').index() < $('#toSelectBox option:last').index()) {
               $('#toSelectBox option:selected').insertAfter($('#toSelectBox option:last'));
          }
       }
       })
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T20:20:02.200

我决定与其重新排序，不如在添加倍数时在末尾附加值。

```
 $('#moveright').click(function () {
    var tempObjects = null;
    $('#fromSelectBox option:selected').each(function () {
        if (($('#toSelectBox option:last').val() == "03" || $('#toSelectBox option:last').val() == "01") && ($('#fromSelectBox option:selected').val() == "03" || $('#fromSelectBox option:selected').val() == "01")) {
            alert($('#toSelectBox option:last').text() + " and " + $('#fromSelectBox option:selected').text() + " cannot both be in Prioritized Categories.");
            return false
        }
        else if ($('#toSelectBox option:last').val() == "03" || $('#toSelectBox option:last').val() == "01") {
                var movingObjects = $(this);
                movingObjects.remove();
                movingObjects.insertBefore($('#toSelectBox option:last'));
        }
        else {
            $('#fromSelectBox option:selected').each(function () {
                if ($(this).val() === "01" || $(this).val() === "03") {
                    if (tempObjects!=null){
                        alert(tempObjects.text()+ " and " + $(this).text() + " cannot both be in Prioritized Categories.");
                        return false
                    }
                    tempObjects = $(this);
                    $(this).remove();
                }
                $(this).remove().appendTo('#toSelectBox');
            });
            if (tempObjects != null) {
                tempObjects.appendTo('#toSelectBox');
            }
        }
    });
}); 
```

# javascript - IE9 中的 jQuery Kwicks 导航

> ID：13420197
> 
> 赞同：0
> 
> 时间：2012-11-16T16:06:57.323
> 
> 标签：javascript, jquery, kwicks

我正在尝试使用导航的 jQuery Kwicks 插件构建一个站点，并且在 Chrome（我的默认浏览器）中一切正常，但是当我在 IE 中打开该站点时，这是客户使用的，导航得到菜单项之间的空格，我似乎找不到解决方案。

这是网站： [http ://www.webexplosive.com/pb_design](http://www.webexplosive.com/pb_design)

旁注：我已经将此插件用于另一个网站[http://www.webexplosive.com/accu1](http://www.webexplosive.com/accu1)，它在每个浏览器中都可以正常工作并且看起来正确......非常困惑！

# javascript - 为什么这个 Javascript 原型不会被覆盖

> ID：13420198
> 
> 赞同：1
> 
> 时间：2012-11-16T16:07:02.800
> 
> 标签：javascript, prototypal-inheritance

我正在查看此处的示例[Using apply to chain constructors](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)

我理解它，除了这一行：

```
fNewConstr.prototype = fConstructor.prototype; 
```

为什么它是必要的，为什么它不会使它失去刚刚为 fNewConstr 定义的函数？

```
Function.prototype.construct = function (aArgs) {
    var fConstructor = this, fNewConstr = function () { fConstructor.apply(this, aArgs); };
    // Why doesn't fNewConstr.prototype get completely overwritten?
    fNewConstr.prototype = fConstructor.prototype;
    return new fNewConstr();
};

function MyConstructor () {
    for (var nProp = 0; nProp < arguments.length; nProp++) {
        this["property" + nProp] = arguments[nProp];
    }
}

var myArray = [4, "Hello world!", false];
var myInstance = MyConstructor.construct(myArray);

alert(myInstance.property1); // alerts "Hello world!"
alert(myInstance instanceof MyConstructor); // alerts "true"
alert(myInstance.constructor); // alerts "MyConstructor" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:09:10.640

如果你的意思是，为什么`fNewConstr`在你写的时候（函数）没有被覆盖

```
fNewConstr.prototype = ...; 
```

...答案是因为没有任何东西可以覆盖它。该代码只是设置`prototype`函数的属性。

如果您的问题是：为什么每次调用都不重新创建，答案是：是`fNewConstr`的*。*`construct`

# c# - 基于多个语句的 linq to xml 查询，以便提供上一个/下一个按钮

> ID：13420201
> 
> 赞同：1
> 
> 时间：2012-11-16T16:07:05.870
> 
> 标签：c#, linq, linq-to-xml, linq-to-objects

我是 Linq 的新手，很难解决一个简单的问题……因为我以前从未做过。

该场景是一个带有书籍的单个 XML 表..like ：

```
<?xml version="1.0" encoding="utf-8"?>
<dbproject>
<books_dataset>
<book>
  <id>23</id>
  <isbn>075221912X</isbn>
  <title>Big Brother: The Unseen Story</title>
  <author>Jean Ritchie</author>
  <publicationYr>2000</publicationYr>
  <publisher>Pan Macmillan</publisher>
  <pages>169</pages>
  <imageBigLink>/images/P/075221912X.01.LZZZZZZZ.jpg</imageBigLink>
  <priceActual>0</priceActual>
  <numberOfBids>0</numberOfBids>
  <sf>kw</sf>
  <df></df>
  <ef></ef>
  <description>Lorem ipsum dolor sit amet</description>
</book>
</books_dataset>
</dbproject> 
```

我正在尝试创建一个查询，它为我提供下一本/上一本书的 ID（下一本/第一本），该书在节点中有一个“kw”字符串。

ID 不连续，也没有索引。因此，例如，下一个按钮正在查找 ID，如下所示：

1.  下一（更高）ID = 下一本书
2.  其中有一个“kw”字符串

我尝试了很多解决方案，但只是感到困惑：/。

我能够跳到下一个/上一个节点.. 但老实说，我确信这不是完成任务的最佳方法。

我可以列出具有 kw 字符串的书籍，但这两个要求不能一起使用：/

我使用这个查询来询问下一个 ID：

```
var btnNextEval = (from databack in xmlData.Element("dbproject").Elements(QRY).Elements(QRY_sub)
                           where databack.Element(fid1).Value == trgtCounter.ToString() 
                           select     databack).Single().ElementsAfterSelf().First().Element("id").Value;

trgtCounter = Convert.ToInt16(btnNextEval); 
```

我尝试使用 && 创建多个 where 但没有工作：/

请帮助并向我展示这个愚蠢问题的可能解决方案。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T16:36:01.397

尝试这个：

```
var nextId = (
    from book in xmlData.Elements("book")
    let id = (int)book.Element("id")
    where ((string)book.Element("sf")) == "kw"
        && id > currentId
    select (int)book.Element("id")
).DefaultIfEmpty(-1).Min(); 
```

这将返回下一个 ID。要获取具有下一个 ID 的图书，请执行以下操作：

```
var nextBook = (
    from book in xmlData.Elements("book")
    where (int)book.Element("id") == nextId
    select book
).First(); 
```

笔记：

*   这假设有一个包含当前 id`currentId`的类型变量。`int`
*   如果`DefaultIfEmpty`没有比当前 ID 更大的 ID，则需要。在这种情况下，`Min`将返回错误。Using`DefaultIfEmpty(-1)`将返回一个带有`-1`.
*   如果在空序列上使用 First 也会返回错误。

# javascript - 本机 JavaScript 等效于单个选定元素的 text()

> ID：13420207
> 
> 赞同：3
> 
> 时间：2012-11-16T16:07:32.080
> 
> 标签：javascript

如果不使用 jQuery，我将如何从以下三个元素返回`Some Text`、`<a href="abc.html">Some Anchor</a>`和？`<img src="abc.jpg" />`换句话说，如果不使用 jQuery ，我将如何返回`$('#t1).text()`, ？如果有多个元素，我不需要返回数组，因为我一次只会选择一个元素。`$('#t2).text()``$('#t3).text()`

```
<td id="t1">Some Text</td>
<td id="t2"><a href="abc.html">Some Anchor</a></td>
<td id="t3"><img src="abc.jpg" /><td> 
```

jQuery 执行 text() 如下。这似乎有点矫枉过正，因为我不担心为多个元素返回一个数组。

```
text: function( value ) {
    return jQuery.access( this, function( value ) {
        return value === undefined ?
            jQuery.text( this ) :
            this.empty().append( ( this[0] && this[0].ownerDocument || document ).createTextNode( value ) );
    }, null, value, arguments.length );
}, 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T16:10:33.520

您可以像这样检索节点的文本：

```
var el = document.getElementById("t1");
var text = el.textContent || el.innerText; 
```

MDN 网站上有关 textContent 和 innerText 的更多[信息](https://developer.mozilla.org/en-US/docs/DOM/Node.textContent)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T16:14:35.527

`data`是节点上的一个属性，用于获取其数据（非递归）。`innerHTML`是 HTML，Elements 上的一个属性。`textContent`是获取元素文本（不含 HTML）的标准属性。`innerText`是获取`textContent`.

你现在应该知道你需要什么了:-)

# asp.net - 验证站点订阅用户的真实性

> ID：13420208
> 
> 赞同：0
> 
> 时间：2012-11-16T16:07:53.297
> 
> 标签：asp.net, security, authentication, authorization

我有一个创建用户帐户的 Web 应用程序，但我也希望能够让用户无需帐户即可注册订阅。他们所拥有的只是一个订阅页面，用于修改电子邮件设置并启用时事通讯订阅。

我的问题是如何在没有用户名/密码的情况下验证用户是他们所说的那个人，我的第二个问题是他们应该如何访问这个页面。我不希望任何人输入带有电子邮件的 url 并访问该用户的订阅设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:14:49.237

对于每个用户条目，您创建一个在 url 中使用的唯一访问代码，以验证这是您想要的用户。订阅表格将提供以下选项：

*   通过填写您的电子邮件订阅
*   只需将您的电子邮件发送到另一个字段即可请求更改您的设置

这两个操作都会向您发送一封带有特殊 URL 的电子邮件

*   第一个验证这是由您制作的，因此您将启用此用户及其电子邮件
*   第二个是向他发送另一个特殊的 url，以在此使用在您的数据库中处于活动状态的情况下对他的设置进行任何更改。

对于这个唯一的代码，您可以使用他的电子邮件的 md5 和他注册时的时间戳。

# java - 使用动态规划的最长之字形子序列

> ID：13420212
> 
> 赞同：3
> 
> 时间：2012-11-16T16:08:24.447
> 
> 标签：java, dynamic-programming

我需要写一个`method that needs to return the length of the longest subsequence of sequence that is a zig-zag sequence.`算法方法应该是**动态编程**。

* * *

如果连续数字之间的差异在正负之间严格交替，则数字序列称为[之字形序列。](http://community.topcoder.com/stat?c=problem_statement&pm=1259&rd=4493)第一个差异（如果存在）可以是正面的也可以是负面的。

```
Eg - 1,7,4,9,2,5   is a zig-zag sequence
because the differences (6,-3,5,-7,3) are alternately positive and negative. 

1,4,7,2,5 is not a zig-zag sequence. 
```

* * *

**我的代码：**

* * *

```
public static int longestZigZag(int[] seq){

    int len = seq.length;
    int[] count= new int[len];

    for(int i=0;i<len;i++)
        count[i]=1;

    for(int i=1;i<len;i++){
        int k = (int)Math.pow(-1, i+1);

        if(seq[i]>(k*seq[i-1])){
            count[i]=count[i-1]+1;
        }
    }

    int max=1;
    for(int i=0;i<len;i++)
        if(count[i]>max)
            max=count[i];

    return max;
} 
```

* * *

**解释：**

对应于每个元素，我有一个`count`元素，它代表了直到那个点的连续交替序列。

```
seq:    1, 7, 4, 9, 2, 5
count:  1, 1, 1, 1, 1, 1

i=1 7 > 1    count[1]= count[0]+1 = 2
i=2 4 > -7   count[2]= count[1]+1 = 3
i=1 9 > 4    count[3]= count[2]+1 = 4
i=1 2 > -9   count[4]= count[3]+1 = 5
i=1 5 > 2    count[5]= count[4]+1 = 6 
```

之后，我只是打印计数数组的最大值。

* * *

**错误：**

以上适用于

```
{ 1, 7, 4, 9, 2, 5 }                     ->  6
{ 1, 17, 5, 10, 13, 15, 10, 5, 16, 8 }   ->  7 
```

但是，它给出了错误的结果

```
{ 1, 2, 3, 4, 5, 6, 7, 8, 9 } gives 9 but should be 2.
{ 70, 55, 13, 2, 99, 2, 80, 80, 80, 80, 100, 19, 7, 5, 
  5, 5, 1000, 32, 32 } gives 2 but should be 8. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:39:13.190

我不确定这是如何回答的。. . 你的方法真的是完全错误的。：-/

要看到这一点，请考虑以下几点：您对 的每个元素的计算`count`仅取决于 的单个前一个元素`count`，而您对 的运行计算`max`仅取决于 的当前元素`count`。这意味着您甚至不需要`count`数组：您的整个算法可以转换为需要 O(1) 空间的单遍。但是，作为“应试者”，您知道这个问题*不能*（容易）在 O(1) 空间中一次性解决，因为如果*可以*，您就不会被指示使用动态规划.

您的算法错误的核心原因是您只会将 的每个元素`seq`与其直接前任进行比较，但允许（并且通常会）“跳过”中间值。

一个混淆因素是导致您的输出中一些更令人困惑的方面，即`seq[i]>(k*seq[i-1])`检查并不意味着我认为您认为它意味着什么。你可能想要更接近的东西`k*(seq[i]-seq[i-1])>0`——但即使这样也会给出非常错误的结果。你真的只需要废弃这个算法并编写一个新算法。

# mongodb - mongo-erlang distinct 命令不起作用

> ID：13420214
> 
> 赞同：1
> 
> 时间：2012-11-16T16:08:25.633
> 
> 标签：mongodb, erlang, distinct

我正在尝试获取某个集合的所有不同值，我可以通过`db.$cmd.findOne({distinct: collection_name, key: some_key})`在 shell 中执行来获得结果。但是，当我这样做时：

```
mongo:do(safe, master, DbConn, some_db,
  fun() ->
    mongo:command(
      {
        distinct, some_collection,
        key, some_key
      }
    )
  end
 ) 
```

我总是得到一个空白列表。我正在开发 Ubuntu 12.04 + MongoDb 2.2.1 + Erlang R15B02。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T02:29:04.620

找到了解决方案。这是 bson-erlang 的问题，因为根据 bson 规范不推荐使用符号。

请参阅[此处](https://github.com/lastomato/bson-erlang/commit/a6061211c611655d1e4850caba75fd9cadc8144a)了解更多信息。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-11-16T19:10:20.163

```
mongo:do(safe, master, DbConn, some_db,
  fun() ->
    mongo:command(
    {
     'distinct'=>'some_collection',
     'key'=> 'some_key'
   }
  )
end
) 
```

我在我的锂项目中使用该命令。它给了我结果。

```
Users::connection()->connection->command(array(
    'distinct' => 'users',
    'key' => 'status',
)); 
```

所以上面的内容也应该为你工作......

# sql - 删除视图中连接字符串列中的空格

> ID：13420216
> 
> 赞同：0
> 
> 时间：2012-11-16T16:08:28.037
> 
> 标签：sql, tsql, sql-server-2005

我已经运行以下脚本来创建一个视图，该视图提供了我想要的结果：

```
SELECT     ACTNUMBR_1, ACTNUMBR_2, ACTNUMBR_3, ACTNUMBR_1 + '-' + ACTNUMBR_2 AS Match_Account, ACTNUMBR_1 + '-' + ACTNUMBR_2 + '-' + ACTNUMBR_3 AS Full_Account_Number
FROM dbo.GL00100 
```

但我的数据在 Match_Account 和 Full_Account_Number 列中存在差距。请参阅下面的输出：

![在此处输入图像描述](../Images/d424d3ad560488cbe55e6a954abed166.png)

我希望我的帐号显示为 - A100-000 或 A100-000-000。

删除此视图上的所有空格以实现此目的的最简单方法是什么？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:10:57.563

只需使用[`REPLACE`](http://msdn.microsoft.com/en-us/library/ms186862.aspx)删除您的空间：

```
SELECT ACTNUMBR_1, ACTNUMBR_2, ACTNUMBR_3, 
    REPLACE(ACTNUMBR_1 + '-' + ACTNUMBR_2, ' ', '') AS Match_Account, 
    REPLACE(ACTNUMBR_1 + '-' + ACTNUMBR_2 + '-' + ACTNUMBR_3, ' ', '') AS Full_Account 
```

# dynamics-crm-2011 - 如何在CRM中进行相对补充查询？

> ID：13420217
> 
> 赞同：4
> 
> 时间：2012-11-16T16:08:29.877
> 
> 标签：dynamics-crm-2011, fetchxml, query-expressions

## 背景（即到底什么是相对补充？）

[相对补](http://en.wikipedia.org/wiki/Complement_%28set_theory%29#Relative_complement)

## 我正在尝试做的事情

假设我有一个自定义`Vehicle`实体，它的`VehicleType`选项集是“汽车”或“卡车”。Contact 和 Vehicle 之间存在一对多的关系（即，ContactId 在车辆实体上）。如何编写只返回汽车联系人的 XRM 查询（Linq To CRM、QueryExpression、获取 Xml 等）？

![相对补文维恩图](../Images/19f5ccd90731c8edb519d0dbcdcd85bd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:56:11.823

## 选项1：

我更喜欢对 AdamV 上面提出的建议进行修改。我想不出一种方法可以单独使用 Linq to CRM、查询表达式、FetchXML 来回答这个特定的查询。Daryl 不提供客户端，但我想如果 Linq 和查询表达式是可接受的产品，.NET 就在桌面上。在父实体（本例中为联系人）上创建包含相关实体计数的聚合字段提供的不仅仅是布尔选项。如果查询要求曾经更改为阈值（多于 X 辆汽车，少于 Y 辆卡车，总车辆数介于 X 和 Y 辆之间），则布尔选项无法交付。此问题中的客户未知，

优势：

1.  在查询方法中保持客户纯度
2.  简单的客户端查询
3.  可能尽可能高效

缺点：

1.  聚合字段的设置
2.  用于管理聚合字段的增量和减量的工作流或插件
3.  用于聚合初始加载的 SQL 脚本。
4.  聚合字段不同步的风险（工作流程或插件失败）

## 选项 2：

如果客户端中的纯度不是必需的，并且 .NET 就在桌面上 - 跳过聚合字段和设置，只需针对视图运行 SQL。如果您不想使用 ADO.NET，像 Dapper、Massive 或 PetaPOCO 这样的瘦 ORM 仍然可以为您提供对象模型。正如 Andreas 在他对 OP 的第一个答案的评论中所提供的那样，在 SQL 中做这件事似乎相当微不足道。

从脑海中勾勒出一些东西：

```
SELECT c.*
FROM Contact 
WHERE C.Contactid in (
    Select contactid 
    FROM Vehicle v 
    group by v.contactid , v.type
    having v.type = ‘Car’ and count(contactid) > 1 
) 
AND NOT IN (
    Select contactid 
    FROM Vehicle v 
    group by v.contactid , v.type
    having v.type <> ‘Car’ and count(contactid) > 1 
) 
```

优势：

1.  工作量少很多
2.  CRM 实体不受打扰

缺点：

1.  取决于客户端和/或应用程序混合 DataAccess 方法有点笨拙。
2.  性能可能低于选项 1

## 选项 3：

混合和匹配：从选项 1 中获取聚合字段。但使用计划的 SQL 作业（或类似的东西）更新它们，查询类似于您需要在选项 1 中编写的初始加载作业

优势：

1.  消除选项 1 的大部分工作和风险
2.  保留选项 1 的所有性能

缺点：

1.  有些人会将此视为不受支持的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T17:02:03.303

为了执行真正的相对补充查询，您需要能够执行子查询。

您的查询基本上会说给我所有与汽车的联系人，然后在这些结果中，删除所有拥有非汽车车辆的联系人。这就是@JasonKoopmans 答案中的 SQL 所做的。不幸的是，[CRM 不支持 SubQueries](http://community.dynamics.com/product/crm/crmtechnical/b/crminthefield/archive/2013/01/14/dynamics-crm-2011-sdk-query-limitations-by-api.aspx)。

因此，实现这一点的唯一方法是在客户端执行子查询，就像我采取的那样，或者以可以通过主查询访问的方式存储子查询的结果（即存储依靠联系实体）。

理论上，您可以通过创建一个存储, 和的`SubQueryResult`实体来“即时”执行此操作。您首先要拉回至少有 1 辆汽车的联系人，并为每个记录创建一个 SubQueryResult 记录，它是 contactId，以及在客户端生成的单个 SubQueryId 以将它们捆绑在一起。 `ContactId``SubQueryId`

然后你会做另一个查询，告诉我这个 SubQueryResult 中带有这个 SubQueryId 的所有联系人，这些联系人没有任何不是汽车的车辆。

我只能假设这不会比执行两个单独的查询和执行过滤器客户端更有效。尽管使用新 CRM 版本中的新 ExecuteMultipleRequests，它可能已接近。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T22:11:22.070

由于 CRM 2011 不支持通过查询表达式进行此操作，因此我已求助于撤回我在 CRM 中的所有记录，并在客户端执行检查。

您可以编写两条 Fetch XML 语句，一条返回所有联系人及其车辆数量，另一个返回所有联系人及其车辆数量，然后在客户端比较列表。但是再一次，您必须返回每个联系人并在客户端对其进行过滤。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T07:26:30.250

它没有经过测试，但是这个查询表达式怎么样？我将*Vehicle*实体链接为内部连接，要求它是*Car*。我假设字段*VehicleType*是一个*字符串*，因为我有点懒，不想测试它（我正在输入这种硬核风格，没有编译 - 纯大脑工作）。

或者，您可能还想添加一个*Criteria*部分来控制实际检索到哪些*Contact*实例。一定要告诉它是怎么回事！

很抱歉冗长。我知道你喜欢简短。我的大脑在迂回时工作得更好。

```
new QueryExpression
{
  EntityName = "contact",
  ColumnSet = new ColumnSet("fullname"),
  LinkEntities =
  {
    new LinkEntity 
    { 
      JoinOperator = JoinOperator.Inner, 
      LinkFromEntityName = "contact", 
      LinkFromAttributeName = "contactid", 
      LinkToEntityName = "vehicle", 
      LinkToAttributeName = "contactid",
      Columns = new ColumnSet("vehicletype"),
      EntityAlias = "Vroom",
      //LinkCriteria = { Conditions = 
      //{
      //  new ConditionExpression(
      //    "vehicletype", ConditionOperator.Equal, "car")
      //} }
      LinkCriteria = { Conditions = 
      {
        new ConditionExpression(
          "vehicletype", ConditionOperator.NotEqual, "truck") 
      } }
    } 
  }
}; 
```

编辑：

我已经与我的 MVP Gustaf Westerlund 进行了交谈，他建议了以下解决方法。让我强调一下，这不是您最初问题的答案。这只是解决它的一种方法。而且很麻烦。:)

因此，提示是在*Contact*或*Person*实体中添加一个标志。然后，每次创建*Vehicle*的新实例时，都需要触发一条消息并使用插件，更新第一个关于创建后者的信息。

这有几个缺点。

1.  它要求我们做事。
2.  这不是直截了当的做这做那类型的方法。
3.  每增加一种新型*车辆*，维护费用就更高。
4.  由于有很多情况需要考虑（重新分配、删除*Vehicle*实例等时标记会发生什么），因此提高了错误率。

所以，我对你的问题的回答改为：“做不到”。这一直有效，直到（很高兴）被提出的替代解决方案证明是错误的。鸭子！

就个人而言，我会获取（几乎）所有东西并将 LINQ 的猎犬释放到它上面。但我不会微笑也不会骄傲。:)

# objective-c - 是否可以通过电子邮件发送 UIView？

> ID：13420219
> 
> 赞同：4
> 
> 时间：2012-11-16T16:08:50.157
> 
> 标签：objective-c, ios, email, uiview, drawing

我的应用程序在 上绘制`UIView`，我想通过电子邮件发送此图。这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T16:11:33.987

将其转换为图像并将该图像作为附件邮寄。

```
+ (UIImage *) imageWithView:(UIView *)view
{
    UIGraphicsBeginImageContextWithOptions(view.bounds.size, view.opaque, [[UIScreen mainScreen] scale]);
    [view.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage * img = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return img;
}

-(void)displayComposerSheet 
{
    MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init];
    picker.mailComposeDelegate = self;
    [picker setSubject:@"Check out this image!"];

    // Set up recipients
    // NSArray *toRecipients = [NSArray arrayWithObject:@"first@example.com"]; 
    // NSArray *ccRecipients = [NSArray arrayWithObjects:@"second@example.com", @"third@example.com", nil]; 
    // NSArray *bccRecipients = [NSArray arrayWithObject:@"fourth@example.com"]; 

    // [picker setToRecipients:toRecipients];
    // [picker setCcRecipients:ccRecipients];   
    // [picker setBccRecipients:bccRecipients];

    // Attach an image to the email
    UIImage *coolImage = ...;
    NSData *myData = UIImagePNGRepresentation(coolImage);
    [picker addAttachmentData:myData mimeType:@"image/png" fileName:@"coolImage.png"];

    // Fill out the email body text
    NSString *emailBody = @"My cool image is attached";
    [picker setMessageBody:emailBody isHTML:NO];
    [self presentModalViewController:picker animated:YES];

    [picker release];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-16T16:13:47.743

只有将其转换为图像时才能执行此操作。

**转换为图像**

您必须首先链接 QuartzCore 框架，并且`#import <QuartzCore/QuartzCore.h>`

接下来插入代码：

```
UIGraphicsBeginImageContext(myView.bounds.size);
[myView.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

*来源：http: [//iphonedevelopment.blogspot.com/2008/10/getting-contents-of-uiview-as-uiimage.html](http://iphonedevelopment.blogspot.com/2008/10/getting-contents-of-uiview-as-uiimage.html)*

**以电子邮件形式发送**

您可以使用 MFMailComposeViewController 类，这样您就不必离开您的应用程序。本教程帮助了我：

[http://iphonedevsdk.com/forum/tutorial-discussion/43633-quick-tutorial-how-add-mfmailcomposeviewcontroller.html](http://iphonedevsdk.com/forum/tutorial-discussion/43633-quick-tutorial-how-add-mfmailcomposeviewcontroller.html)

要添加图像，您可以使用同一个类的方法：[addAttachmentData:mimeType:fileName:](http://developer.apple.com/library/ios/#documentation/MessageUI/Reference/MFMailComposeViewController_class/Reference/Reference.html)接受三个参数。查看苹果文档以获取更多信息。

# javascript - 主干复制一个视图事件到另一个

> ID：13420223
> 
> 赞同：1
> 
> 时间：2012-11-16T16:09:02.577
> 
> 标签：javascript, jquery, backbone.js

我在 Backbone 中有这个视图，它根据用户的操作更改其事件。

所以我有三个视图，都已经初始化了。

```
var view1 = new MainView({el : '#view1'});

var view2 = new ProductsView({el : '#prodcuts'});

var view3 = new StoresView({el : '#stores'}); 
```

现在我想做的是将事件从一个视图复制到另一个视图，然后更新视图 el。我试过了：

```
if($option == 'products') {
  view1.events = view2.events
  $("div[data-role='content']", view1.el).html(content);
} else {
    view1.events = view3.events
  $("div[data-role='content']", view1.el).html(content);
} 
```

问题是即使现在内容是相同的，并且存在与事件相对应的元素，但事件不再触发。为什么会这样，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:12:03.630

您需要调用[delegateEvents](http://documentcloud.github.com/backbone/#View-delegateEvents)方法。

例如以下内容（鉴于您提供的代码）。

```
if($option == 'products') {
  view1.delegateEvents(view2.events)
  $("div[data-role='content']", view1.el).html(content);
} else {
    view1.delegateEvents(view3.events);
  $("div[data-role='content']", view1.el).html(content);
} 
```

另请注意，要删除事件，请使用[undelegateEvents()](http://documentcloud.github.com/backbone/#View-undelegateEvents)方法。

# git - 撤消最近的两个提交

> ID：13420227
> 
> 赞同：0
> 
> 时间：2012-11-16T16:09:08.690
> 
> 标签：git

我想撤消最近的两个提交。这些提交已经被推送到远程仓库，但我想一旦我在本地撤消了它们，我可以再次推送，它们将在远程仓库中有效地被撤消。

我有这些提交的哈希值，那么我需要运行什么命令来撤消它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:14:15.573

做就是了：

```
git revert HEAD~2 
```

使用`git help revert`会给你更多的细节。

如果您的工作目录中有待处理的更改，请在之前存储并在之后取消存储。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T16:17:32.517

如果您只想摆脱提交：

```
git checkout <branch>
git reset --hard <commit before the two commits>
git push <remote> +<branch> 
```

`+`强制推动。

您可以使用`HEAD^^`来引用最后两个之前的提交。

编辑：`git revert`是一种在不从历史记录中删除提交的情况下撤消提交的方法。当更改已被其他人拉取时，它很有用。

# ios - SoundCloud Widget 外部控制 iOS 问题

> ID：13420228
> 
> 赞同：1
> 
> 时间：2012-11-16T16:09:08.313
> 
> 标签：ios, soundcloud

我在 iOS 上使用 html5 小部件的外部控件发现了一个错误，我已经用 iphone 和 ipad 进行了测试。小部件内的控件工作正常。但是在我的客户网站[http://www.bushytunes.net](http://www.bushytunes.net)和小部件 api 游乐场[http://w.soundcloud.com/player/api_playground.html](http://w.soundcloud.com/player/api_playground.html)上，外部控件运行错误。

以下是小部件游乐场的控制台打印的内容：

```
SC.Widget.Events.PLAY {"loadedProgress":null,"currentPosition":0,"relativePosition":0}
SC.Widget.Events.PAUSE {"loadedProgress":null,"currentPosition":0,"relativePosition":0}
SC.Widget.Events.PLAY {"loadedProgress":null,"currentPosition":0,"relativePosition":0}
SC.Widget.Events.PLAY {"loadedProgress":null,"currentPosition":0,"relativePosition":0}
SC.Widget.Events.PLAY {"loadedProgress":null,"currentPosition":0,"relativePosition":0}
SC.Widget.Events.READY {}
Loading... 
```

谢谢，詹姆斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T17:16:11.717

**TL;DR**：iOS 6 应该通过用户操作来限制播放调用，iOS5 及更低版本可能无法修复。

我们将尝试通过某种 hack 来解决这个问题，但很可能这不会很快得到适当的解决方案。

SoundCloud Widget 使用 HTML5 Audio 在 iOS 上播放声音。在 iOS 中开始播放有两个限制：

1.  播放**必须**由用户操作开始（因此在事件处理程序中）
2.  对`audio.play`方法的调用必须在该事件处理程序的同步调用堆栈中。

这意味着，这有效：

```
document.querySelector('.play-button').addEventListener('click', function () {
    audioController.play();
}, false); 
```

但这不会：

```
document.querySelector('.play-button').addEventListener('click', function () {
    setTimeout(function () {
        audioController.play();
    }, 500);
}, false); 
```

iframe 之间的跨域通信只能以异步方式进行。我们的实现使用的是`postMessage`DOM API，但即使是旧的技术，例如正在使用的 Fragment Identifier Messaging (FIM)，也是`location.hash`异步的。这意味着我们目前看不到通过适用于 iOS5 及更低版本的 API 启用播放的方法（因为也没有 Flash 后备）。

~~不过，也有好消息：**iOS6 取消了 No2 的限制**。这意味着只要`play`通过用户操作调用 API 调用，您就可以播放声音。即使您的父窗口和小部件的 iframe 之间的通信仍然是异步的。~~不幸的是，iOS 并没有放弃这个限制。

我希望这会有所帮助，如果我们找到合适的解决方法，我会更新这个答案。

我的建议是使用[Audio5JS](http://zohararad.github.com/audio5js/)或[SoundManager2](http://www.schillmania.com/projects/soundmanager2/)等库构建您自己的自定义播放器，以防在 iOS 上控制播放对您的应用程序至关重要。

[您可以在developer.apple.com](http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Device-SpecificConsiderations/Device-SpecificConsiderations.html)资源上看到我在谈论的内容的模糊描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-17T21:46:36.707

我无法完全判断@gryzzly 是否试图这么说，但**Widget API 的外部控件在 mobile 上完全被破坏了**。答案确实解释了为什么 - 你不能同步告诉 iFrame 播放声音，但我的理解是正确的 iframe.contentWindow 调用将是同步的？我可能错了。

尝试将您的手机定向到小部件 API 游乐场：[https ://w.soundcloud.com/player/api_playground.html](https://w.soundcloud.com/player/api_playground.html)

即使在那里，除非您按下橙色按钮，否则它实际上也不会播放。

Pretty irritating since there's no application to get around the streaming API limit either. There seems to be literally no way to get a site that may experience more than 15,000 requests/plays per day to work with SoundCloud on mobile. I just want continuous music playback.

# linux - gnu C++ 库在向量分配期间卡在循环中

> ID：13420230
> 
> 赞同：4
> 
> 时间：2012-11-16T16:09:19.640
> 
> 标签：linux, gcc, gdb

运行linux内核3.6.6-1，gcc 4.7.2-2，程序如下：

```
1 #include <vector>
2 using namespace std;
3 int main ()
4 {
5     vector<size_t> a (1 << 24);
6     return 0;
7 } 
```

永远不会从第 5 行返回。

当我在 gdb 中运行时，我看到它卡在第 743/744 行的 stl_algobase.h 中：

```
0x000000000040101c in std::__fill_n_a<unsigned long*, unsigned long, unsigned long> (__first=0x7fffeffd8060, __n=16777216, __value=@0x7fffffffe0a8: 0)
    at /usr/lib/gcc/x86_64-redhat-linux/4.7.2/../../../../include/c++/4.7.2/bits/stl_algobase.h:743
740     __fill_n_a(_OutputIterator __first, _Size __n, const _Tp& __value)
741     {
742       const _Tp __tmp = __value;
743       for (__decltype(__n + 0) __niter = __n;
744        __niter > 0; --__niter, ++__first)
745     *__first = __tmp;
746       return __first;
747     } 
```

__niter 只是保持在值 1 并且从不倒数到 0。

此行为仅在我的系统运行一段时间后才会发生。当它发生时，整个系统似乎很无聊。也就是说，gui 很快停止响应，但我可以 ssh 进入并做一些事情，但最终整个系统变得无法使用，我重新启动。

重新启动后，上述程序按预期运行。

显然，问题不在于我的程序。这只是一些更大问题的症状。

我的问题是：接下来我该怎么做？

我检查了所有错误日志，但一无所获。我没有遇到硬件异常或类似的情况，因此很难准确判断我的系统何时进入此状态。

我没有想法，所以任何帮助将不胜感激。

*编辑：*

我将编译器选项更改为`-g -Wall`并得到相同的结果。

这是 __fill_n_a 的反汇编（带有新选项）：

```
 1 0x00000000004010bd <+0>:    push   %rbp
  2 0x00000000004010be <+1>:    mov    %rsp,%rbp
  3 0x00000000004010c1 <+4>:    mov    %rdi,-0x18(%rbp)
  4 0x00000000004010c5 <+8>:    mov    %rsi,-0x20(%rbp)
  5 0x00000000004010c9 <+12>:   mov    %rdx,-0x28(%rbp)
  6 0x00000000004010cd <+16>:   mov    -0x28(%rbp),%rax
  7 0x00000000004010d1 <+20>:   mov    (%rax),%rax
  8 0x00000000004010d4 <+23>:   mov    %rax,-0x10(%rbp)
  9 0x00000000004010d8 <+27>:   mov    -0x20(%rbp),%rax
 10 0x00000000004010dc <+31>:   mov    %rax,-0x8(%rbp)
 11 0x00000000004010e0 <+35>:   jmp    0x4010f7 <std::__fill_n_a<unsigned long*, unsigned long, unsigned long>(unsigned long*, unsigned long, unsigned long const&)+58>
 12 0x00000000004010e2 <+37>:   mov -0x18(%rbp),%rax
 13 0x00000000004010e6 <+41>:   mov -0x10(%rbp),%rdx
 14 0x00000000004010ea <+45>:   mov %rdx,(%rax)
 15 0x00000000004010ed <+48>:   subq $0x1,-0x8(%rbp)
 16 0x00000000004010f2 <+53>:   addq $0x8,-0x18(%rbp)
 17 0x00000000004010f7 <+58>:   cmpq $0x0,-0x8(%rbp)
 18 0x00000000004010fc <+63>:   setne  %al
 19 0x00000000004010ff <+66>:   test   %al,%al
 20 0x0000000000401101 <+68>:   jne    0x4010e2 <std::__fill_n_a<unsigned long*, unsigned long, unsigned long>(unsigned long*, unsigned long, unsigned long const&)+37>
 21 0x0000000000401103 <+70>:   mov -0x18(%rbp),%rax
 22 0x0000000000401107 <+74>:   pop %rbp
 23 0x0000000000401108 <+75>:   retq 
```

我还运行了系统的内存诊断工具，没有出现任何错误，并且按照 DL 的建议，运行 memtest86 时没有出现任何错误。

*编辑：*

通过在不同的机器上运行相同的代码，我已经确认这不是硬件问题。另一台机器安装了相同的内核和编译器软件，它以同样的方式失败。

我对 ImageMagick 持怀疑态度。这似乎只有在我运行了许多 ImageMagick 转换调用的脚本之后才会发生。我之前在使用 ImageMagick 时遇到过问题，不得不设置 shell 变量 MAGICK_THREAD_LIMIT=1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T19:20:51.797

您描述的总体症状听起来像是内存不足。正如评论者所指出的，如果系统内存使用率没有读到高，这可能是由于某种 RAM 问题。

你说：

> __niter 只是保持在值 1 并且从不倒数到 0。

但这不太有意义——__niter 应该从 16777216 开始并倒数到 0。如果你随机闯入这个程序，它几乎肯定会在这个循环中，但 __niter 的值几乎肯定不会1，如果你单步执行循环，它似乎只是循环。我高度怀疑 gcc 4.7 发布的调试信息（实际上，自 gcc 4.0 以来，它几乎是一个问题），因为 gdb 似乎经常打印出错误的局部变量值，但是如果您检查代码并查看和内存/寄存器直接你可以看到正确的值。如果这就是这里发生的情况，那么您的问题可能与该程序无关；它是一种系统不稳定（可能是由于硬件问题），表现为挂起的东西，例如这个程序。鉴于该程序的作用，当它触及以前未触及的页面（出现页面错误）并且内核尝试分配页面时，可能会发生挂起。这表明存在内存问题，但您注意到您已经运行了内存诊断程序。还要确保您没有任何超频或超出规格的东西。

# java - Hibernate mapping 列出双方的关系。

> ID：13420239
> 
> 赞同：1
> 
> 时间：2012-11-16T16:09:53.087
> 
> 标签：java, hibernate, list

我有两个对象；`Document`和`DocumentBatch`

**文档**

```
public class Document implements Serializable {

....
private String documentId; //PK of Document
private DocumentBatch documentBatch;
....} 
```

**文档批处理**

```
public class DocumentBatch implements Serializable {

private String batchId;//PK of DocumentBatch

private List<Document> lDocuments = new LinkedList<Document>();
.....
public void insertDocument(Document document) {
    lDocuments.add(document); // lDocuments is a list DocumentBatch
    document.setDocumentBatch(this);
....} 
```

**休眠映射：**

**文档**

```
 <class name="Document" table="DOCUMENTS">
  .....
  <id name="documentID" column="DOCUMENT_ID" type="string" />
  <many-to-one name="documentBatch" class="DocumentBatch" not-null="false" 
  cascade="save-update" lazy="false" insert="false" update="false">
        <column name="BATCH_ID" not-null="true" />
    </many-to-one>
  ......
</class> 
```

**文档批处理**

```
 <class name="DocumentBatch" table="DOCUMENT_BATCHES">
     <id name="batchId" column="BATCH_ID" type="string" /> 
     <list name="lDocuments" table="DOCUMENTS" cascade="all"
        inverse="false" lazy="false" mutable="true">
        <key not-null="true">
            <column name="BATCH_ID" />
        </key>
        <list-index column="LIST_INDEX" base="0" />
        <one-to-many class="Document" />
       </list>
     ......
 </class> 
```

DocumentBatch 有一个 Document 列表

文档有 batchId，它是 DocumentBatch 的 PK。我已经在 DocumentBatch 中设置了 Hibernate 列表的映射

逆=“假”

并在 Document 中的多对一关系集 insert="false" update="false"

但是当我尝试保存一个 Document obj 时，它的 DocumentBatch 将不会被保存。

怎么解决。如果有人可以帮忙....希望大家周末愉快。

**甲骨文数据库：**

文件的

```
CREATE TABLE DOCUMENTS(
DOCUMENT_ID VARCHAR2(255 CHAR) NOT NULL,
BATCH_ID VARCHAR2(255 CHAR) NOT NULL,
...);  

CREATE UNIQUE INDEX PK_DOCUMENT ON DOCUMENTS (DOCUMENT_ID); 
ALTER TABLE DOCUMENTS ADD (CONSTRAINT PK_DOCUMENT PRIMARY KEY (DOCUMENT_ID) USING INDEX PK_DOCUMENT); 

ALTER TABLE DOCUMENTS ADD (CONSTRAINT FK_DOCUMENT_BATCH_ID FOREIGN KEY (BATCH_ID) REFERENCES DOCUMENT_BATCHES (BATCH_ID) ON DELETE CASCADE); 
```

DocumentBatch 的

```
CREATE TABLE DOCUMENT_BATCHES(
BATCH_ID VARCHAR2(255 CHAR)     NOT NULL
...);

ALTER TABLE DOCUMENT_BATCHES ADD (
PRIMARY KEY (BATCH_ID)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:22:58.250

如果我理解正确的话。从您展示的片段中，我会说*您遇到的行为是正确的*。你说的问题是：

> 但是当我尝试保存一个 Document obj 时，它的 DocumentBatch 将不会被保存。

因为有明确的设置不插入和不更新：

```
<many-to-one name="documentBatch" class="DocumentBatch" 
    not-null="false" cascade="save-update" lazy="false" 
    insert="false" // Hibernate do not insert
    update="false" // Hibernate do not update
> 
```

那么结果是正确的。如果您想将关系保存到 ，`DocumentBatch`则只需更改该映射：

```
insert="true" // Hibernate DO insert
update="true" // Hibernate DO update 
```

*（或删除它们，因为默认为`true`）*，然后如果您将 a 分配`DocumentBatch`给您`Document`并保存它 - 所有内容都将正确保存。这应该解决它。

### 编辑：重复列异常

我猜你的实体`Document`有另一个字段映射到`batch_id`.

```
<many-to-one name="documentBatch" class="DocumentBatch" not-null="false" 
  cascade="save-update" lazy="false" insert="false" update="false">
  <column name="BATCH_ID" not-null="true" />
</many-to-one>
// this is not in the snippet above, but I guess it is there
<property name="batchId" column="BATCH_ID"/> 
```

在代码中：

```
public class Document implements Serializable {
private String documentId; //PK of Document
private DocumentBatch documentBatch;
// this is not in the snippet above, but I guess it is there
private String batchId;
....} 
```

如果是这种情况，那么两个不同的属性将映射到同一列，这就是我们遇到的原因：`duplicated column exception` 如果我的期望是正确的，请以这种方式更改映射：

```
<many-to-one name="documentBatch" class="DocumentBatch" not-null="false" 
  cascade="save-update" lazy="false" > // insert and update removed
  <column name="BATCH_ID" not-null="true" />
</many-to-one>
<property name="batchId" formula="[BATCH_ID]" insert="false" update="false"/> 
```

因此`documentBatch`将用于*insert*和*update*，而 batchId 将仅用于只读。

# java - 检查整数中是否只设置了一个位（无论其位置如何）

> ID：13420241
> 
> 赞同：8
> 
> 时间：2012-11-16T16:10:00.990
> 
> 标签：java, binary, bit-manipulation, bit, bitwise-operators

我使用 64 位整数中的位存储标志。
我想知道在 64 位整数中的任何位置是否都设置了一个位（我不关心任何特定位的位置）。

```
boolean isOneSingleBitSet (long integer64)
{
   return ....;
} 
```

[*我可以使用Bit Twiddling Hacks* (by Sean Eron Anderson)](http://graphics.stanford.edu/~seander/bithacks.html)计算位数，但我想知道检测是否设置了一个位的最有效方法是什么......

我发现了一些其他相关的问题：

*   [(8051) 检查是否设置了单个位](https://stackoverflow.com/questions/3007541/8051-check-if-a-single-bit-is-set)
*   [检测整数内的单个一位流](https://stackoverflow.com/questions/462609/detecting-single-one-bit-streams-within-an-integer)

还有一些维基百科页面：

*   [找到第一个](http://en.wikipedia.org/wiki/Find_first_one)
*   [位操作](http://en.wikipedia.org/wiki/Bit_manipulation)
*   [汉明重量](http://en.wikipedia.org/wiki/Hamming_weight#Efficient_implementation)

注意：我的应用程序是用 java 编写的，但我对使用其他语言的优化感到好奇......

* * *

**编辑**：[Lưu Vĩnh Phúc](https://stackoverflow.com/users/995714)指出，我的问题中的第一个链接已经得到了答案：请参阅Bit Twiddling Hacks 中的[Determining if an integer is a power of 2](http://graphics.stanford.edu/~seander/bithacks.html#DetermineIfPowerOf2) in the *Bit Twiddling Hacks*（Sean Eron Anderson）部分。我没有意识到***一位与二的******幂***相同。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-16T16:18:24.517

如果您只是想检查是否设置了一个位，那么您实际上是在检查该数字是否为 2 的幂。为此，您可以执行以下操作：

```
if ((number & (number-1)) == 0) ... 
```

这也将 0 视为 2 的幂，因此如果这很重要，您应该检查数字是否不是 0。那么：

```
if (number != 0 && (number & (number-1)) == 0) ... 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-11-16T16:21:18.450

（使用 x 作为参数）

检测是否设置了至少一位很容易：

```
return x!=0; 
```

同样，检测第一个位（第二个最低位）是否设置很容易：

```
return (x&2)!=0; 
```

如果它是 2 的幂，则恰好设置了一位。这有效：

```
return x!=0 && (x & (x-1))==0; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-16T16:18:03.753

包装类`java.lang.Long`有一个静态函数`bitCount()`，它返回 long（64 位 int）中的位数：

```
boolean isSingleBitSet(long l)
{
     return Long.bitCount(l) == 1;
} 
```

请注意，int 在 java 中是 32 位的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-16T16:20:14.070

让我们假设 X 是一个 64 位的中间，除了你正在寻找的那个之外，它充满了 0；

```
 return ((64bitinteger&X)==X) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-16T16:17:02.367

假设您已经有一个高效的 - 或硬件 - 实现`ffs()`- find first set - 您可以执行以下操作：

```
bool isOneSingleBitSet (long integer64)
{
   return (integer64 >> ffs(integer64)) == 0;
} 
```

该`ffs()`功能可能已经可用，或者您可能希望在[上面查看您自己的链接](http://en.wikipedia.org/wiki/Find_first_one)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-16T16:18:46.670

似乎您可以对`long`要检查的单个位的表示进行按位与运算。例如，检查 LSB

```
return(   (integer64 & 1L)!=0  ); 
```

或者检查右边的第 4 位

```
return(   (integer64 & 8L)!=0  ); 
```

# alloy - 合金中带参数的谓词和不带参数的谓词

> ID：13420249
> 
> 赞同：2
> 
> 时间：2012-11-16T16:10:38.687
> 
> 标签：alloy

我在一本书中看到了以下定义：

```
pred show(b: Book){
  some b.addr
} 
```

在哪里

```
abstract sig Name, Addr {}
sig Book { addr: Name lone -> lone Addr } 
```

在玩过合金分析仪后，我意识到这和

```
pred show(){
  some b:Book | some b.addr
} 
```

我很好奇将 Book 指定为参数有什么好处，而不是使用量词的第二种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:02:40.083

对谓词使用或不使用参数不是一种“方法”，它具有不同的语义。如果您包含`some b`在谓词中，则不能在谓词`all b`之外使用...

例如：

```
sig Addr {}

sig Book {
    addr: Addr
}

pred show {
    some b:Book | some b.addr
}

pred show'[b:Book] {
    some b.addr
}

check { show }

// These are not possible without an argument to show'
check { all b:Book | show'[b] }
check { some b:Book | show'[b] }
check { no b:Book | show'[b] } 
```

# javascript - html列表添加文本框

> ID：13420250
> 
> 赞同：0
> 
> 时间：2012-11-16T16:10:41.853
> 
> 标签：javascript, jquery, html, css, cordova

我需要你的帮助，每次我在列表中添加一种成分时，我都想放一个小文本框。就在它旁边，所以我可以把数量。有人可以帮助我吗？
这是html：

```
<html>
    <head>
    <title>Ingredient</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="themes/receta.min.css" />
    <link rel="stylesheet" href="themes/receta.css" />
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
    <script src="js/recetas.js">  </script>  

<body>
    <label for="receta">Nombre Receta:</label><br>
    <input type="text" name="receta" value="" maxlength="20" /><br>

<h1>INGREDIENTES</h1>
<ul>

</ul>
<select onchange="selectIngredient(this);">
    <option value="Cheese">Cheese</option>
    <option value="Olives">Olives</option>
    <option value="Pepperoni">Pepperoni</option>
    <option value="Milk">Milk</option>
</select>
<button>GUARDAR</button>    
<li><a href="resumen.html" data-transition="none" rel="external">testing2</a></li>
</body>
</html> 
```

* * *

这是我不知道如何更改的js，因此我可以放置文本框：

```
 function selectIngredient(select)
        { 
          var $ul = $(select).closest('.ui-select').prev('ul');
    console.log($ul[0])
      if ($ul.find('input[value=' + $(select).val() + ']').length == 0) {
        console.log('s')
            $ul.append('<li onclick="$(this).remove();">' +
              '<input type="hidden" name="ingredients[]" value="' + 
              $(select).val() + '" /> ' +
              $(select).find('option:selected').text() + '</li>');
      }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:50:38.143

我不知道我是否理解正确，但我在您的代码中看到的是隐藏的输入和列表中的删除。我删除了隐藏属性并将成分的名称放在一个跨度上以设置删除函数，并为 ul 命名的成分设置一个 id。

这是代码：

```
$("#addIng").change(function(){
      var $ul = $("#ingredientes");
console.log($ul[0])
  if ($ul.find('input[value=' + $(this).val() + ']').length == 0) {
    console.log('s')
        $ul.append('<li>' +
          '<input name="ingredients[]" value="' + 
          $(this).val() + '" /> <span onclick="$(this).parent().remove();">' +
          $(this).find('option:selected').text() + '</span></li>');
      }

}); 
```

[jsfiddle](http://jsfiddle.net/jorgehdez/UXsjd/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:49:40.453

您的 html 存在一些问题，这让它很奇怪，但只是为了回答您的问题并帮助您继续工作。

```
function selectIngredient(select)
{ 
  var ul = $("ul");
  if (ul.find('input[value=' + $(select).val() + ']').length == 0) 
  {
    var li = '<li><input type="hidden" name="ingredients[]" value="' + $(select).val() + '" /> ' + $(select).find('option:selected').text() + '<input type="text" name="quantity[]" value="0" />' + '<a onclick="$(this).parent().remove();"> Remove </a> </li>';
    ul.append(li);
  }
} 
```

这应该可行，但是您应该为列表提供一个 id 或类，这样会更容易找到它，此代码将向整个页面中的每个列表添加一个项目。

我希望它对你有帮助。

# perl - 我可以在 Perl 中使用 sprintf 为数字指定最大精度宽度吗？

> ID：13420251
> 
> 赞同：3
> 
> 时间：2012-11-16T16:10:50.980
> 
> 标签：perl

是否可以使用 Perl 的`sprintf`函数来指定浮点数的最大精度宽度？阅读文档后，我相信不是，但可能是我忽略了一些东西。

所以，如果我有 4.12，我希望将数字格式化为`4.12`.

```
my $abc = 4.12;
my $out = sprintf("%?...", $abc); # $out eq '4.12'; 
```

但是，如果数字的精度超过 6 位，我只需要 6 位：

```
my $def = 1.23456789;
my $out = sprintf("%?...", $def); # $out eq '1.234568'; 
```

这可能`sprintf`吗？

**编辑**

Currentyl，我正在使用

```
sub output_number {
  my $number = shift;

  my $ret = sprintf("%.6f", $number);

  $ret =~ s/0*$//g;
  $ret =~ s/\.$//g;

  return $ret;
} 
```

出于我的目的，这可以满足我的需要。但我希望有一种更优雅的方式。最好是一个衬里，不一定限于使用`sprintf`。

另请注意，建议的`printf ("%.7g", $number)`行为方式不符合我的要求（例如对于`$n = 0.00000000001;`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T16:13:54.513

我相信你可以使用`%.<n>g`：

```
perl -e 'printf "%.7g", 4.12'          =>   4.12
perl -e 'printf "%.7g", 4.12345678'    =>   4.123457 
```

但是，如果指数符号真的毁了你的一天，而且你安装的 perl 足够现代，总有

```
sprintf("%.6f",$number) =~ s/\.?0+$//r 
```

# c# - LINQ 中的日期格式

> ID：13420252
> 
> 赞同：1
> 
> 时间：2012-11-16T16:10:56.080
> 
> 标签：c#, winforms, linq, telerik

我的 LINQ 格式化日期有问题。这是代码

```
 var resultCustomer = from row in formDg.dtCustomer.AsEnumerable()
                          where row.Field<int>("customerID") == customerID2
                          select new
                          {
                              name = row["customerName"].ToString(),
                              ic = row["customerIC"].ToString(),
                              add1 = row["customerAdd1"].ToString(),
                              add2 = row["customerAdd2"].ToString(),
                              tel = row["customerTel"].ToString(),
                              tel2 = row["customerTel2"].ToString(),
                              tel3 = row["customerTel3"].ToString(),
                              email = row["customerEmail"].ToString(),
                              dateRegister = row["customerDateRegister"].ToString(),
                              customerRef = row["customerRef"].ToString(),
                              customerGroup = row["groupCustName"].ToString(),
                              panelName = row["panelName"].ToString(),
                              };

var firstRecord = resultCustomer.First();// My record return single row only 
```

我的问题是如何在**customerDateRegister 中格式化自定义日期，如“dd/MM/yyyy”？**, 因为当我的文本框显示**16-Nov-12 12:00:00 AM**时出现问题。我不想显示时间，只想显示日期。

我试过这样**tbDateRegOv.Text = firstRecord.dateRegister.ToString("dd/MM/yyyy");** . 不行。然后我在 LINQ 中尝试**dateRegister = row["customerDateRegister"].ToString("dd/MM/yyyy")**。同样的问题。

那么我该如何解决这个问题呢？感谢帮助。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:12:02.530

您需要将您的行作为`DateTime`第一个。这将允许您对日期使用自定义格式字符串。

```
dateRegister = ((DateTime)row["customerDateRegister"]).ToString("dd/MM/yyyy") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T16:13:56.837

如果`customerDateRegister`是类型`DateTime`，则应`DateTime`首先将其设为 a。因此使用`DataRow`扩展方法[`Field<T>`](http://msdn.microsoft.com/en-us/library/bb360891.aspx)：

```
dateRegister = row.Field<DateTime>("customerDateRegister") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T16:14:36.037

你可以试试这个，用这个替换你的 dateRegister 行。

```
dateRegister = ((DateTime)row["customerDateRegister"]).ToString("dd/MM/yyyy"), 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T11:50:22.587

或者，您可以将 MaskedEditBox 与所需的日期时间掩码一起使用

# visual-studio-2010 - TFS 2010：更改工作项类型并保留现有源历史记录

> ID：13420255
> 
> 赞同：1
> 
> 时间：2012-11-16T16:10:57.127
> 
> 标签：visual-studio-2010, tfs, tfs-workitem, cmmi

我们开始在一个使用敏捷工作项模板的项目中进行编程。现在，我们想要保留一些代码历史记录。

此外，我们想更改为自定义的 CMMI 模板，因此它接近 CMMI，但经过自定义，工作项略有不同，还有一些新的/删除的（出于测试目的，我们将其设置在不同的项目中）。

我们现在如何将一个项目的源（和历史）与另一个项目的工作项合并？

据我了解，您可以简单地导出/导入工作项类型，但是，所有报告和查询以及仪表板也不会正确更新？因此，我们现在可以提出的所有方案都会导致版本历史丢失（只需使用 CMMI 将源的当前状态导入新创建的项目，然后更新工作项）。

有更好的解决方案吗？

（使用 TFS 2010 和 VS 2010）

编辑：可以在这里找到一些有用的信息：http: [//blogs.msdn.com/b/willy-peter_schaub/archive/2011/05/17/tfs-integration-tools-where-does-one-start-part- 3-dust-has-settled-did-it-work.aspx](http://blogs.msdn.com/b/willy-peter_schaub/archive/2011/05/17/tfs-integration-tools-where-does-one-start-part-3-dust-has-settled-did-it-work.aspx) - 像我一样，您可能会特别遇到 ProcessBuildTemplates 的麻烦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T17:44:16.343

您是否考虑过使用[TFS 集成工具](http://visualstudiogallery.msdn.microsoft.com/eb77e739-c98c-4e36-9ead-fa115b27fefe)？我不确定使用不同模板成功迁移团队项目的工作项，但我已经能够成功地在团队项目之间迁移代码及其历史记录。

# jquery - 如何通过 th id 更改 html 表中列的背景颜色？

> ID：13420258
> 
> 赞同：1
> 
> 时间：2012-11-16T16:11:09.340
> 
> 标签：jquery, html-table

我想使用 jQuery 通过 id 更改列的背景颜色。

html表：

```
<table id="financial_table" style="background-color:#EEE;">
   <tbody>
      <tr>
         <th>Date</th>
         <th id="1041051600000">12 2002</th>
         <th id="1072587600000">12 2003</th>
         <th id="1104210000000">12 2004</th>
         <th id="1135746000000">12 2005</th>
         <th id="1167282000000">12 2006</th>
         <th id="1198818000000">12 2007</th>
         <th id="1230440400000">12 2008</th>
         <th id="1261976400000">12 2009</th>
         <th id="1293512400000">12 2010</th>
         <th id="1325048400000">12 2011</th>
      </tr>
      <tr>
         <td>Share</td>
         <td>12.1</td>
         <td>14.08</td>
         <td>15.97</td>
         <td>16.98</td>
         <td>18.14</td>
         <td>21.2</td>
         <td>22.67</td>
         <td>22.43</td>
         <td>22.38</td>
         <td>23.77</td>
      </tr>

       <tr>
         <td>Revenue</td>
         <td>12.1</td>
         <td>14.08</td>
         <td>15.97</td>
         <td>16.98</td>
         <td>18.14</td>
         <td>21.2</td>
         <td>22.67</td>
         <td>22.43</td>
         <td>22.38</td>
         <td>23.77</td>
      </tr>
   </tbody>
</table>​ 
```

jQuery：

```
$(function() {
   $('#1135746000000').css('background-color','blue');
});​ 
```

我知道它只能改变 id 为 1135746000000 的背景。我想用这个 id 改变整个列的背景颜色。

[示例小提琴](http://jsfiddle.net/donli/CnxGn/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-16T16:17:38.570

组合[`.index()`](https://api.jquery.com/index/)和[`:nth-child()`](https://api.jquery.com/nth-child-selector/)选择器

> [`.index()`](https://api.jquery.com/index/)
> 
> 从匹配的元素中搜索给定的元素。
> 
> 如果没有参数传递给该`.index()`方法，则返回值是一个整数，指示 jQuery 对象中的第一个元素相对于其兄弟元素的位置。

> [`:nth-child()`](https://api.jquery.com/nth-child-selector/)
> 
> 选择作为其父级的第 n 个子级的所有元素。
> 
> 因为 jQuery 对`:nth-`选择器的实现严格源于 CSS 规范，所以 的值为`n`“1-indexed”，即从 1 开始计数。

一个可能的解决方案可能如下所示：

```
// get the index of the column
var colIdx = $("#1041051600000")​​.index();

// grab all <td> and <th> elements from the (colIdx + 1) column
$("td, th").filter(":nth-child(" + (colIdx + 1) + ")")
           .css("background-color", "red")​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​; 
```

```
var colIdx = $("#1041051600000").index();

$("td, th").filter(":nth-child(" + (colIdx + 1) + ")")
           .css("background-color", "red");
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<table>
   <tbody>
      <tr>
         <th>Date</th>
         <th id="1041051600000">12 2002</th>
         <th id="1072587600000">12 2003</th>
         <th id="1104210000000">12 2004</th>
      </tr>
      <tr>
         <td>Share</td>
         <td>12.1</td>
         <td>14.08</td>
         <td>15.97</td>
      </tr>
       <tr>
         <td>Revenue</td>
         <td>12.1</td>
         <td>14.08</td>
         <td>15.97</td>
      </tr>
   </tbody>
</table>
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T16:23:58.390

尝试这个，

```
$('#1135746000000, td:nth-child('+($("#1135746000000").index()+1)+')').css('background-color','blue'); 
```

**演示：http:** [//jsfiddle.net/U8LxX/2/](http://jsfiddle.net/U8LxX/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:20:10.130

给你……读一读，看看它是否对你有帮助

[如何：使用 jQuery 更改表格的行和列颜色](http://keithrull.com/blog/index.php/2010/05/jquery/how-to-change-the-row-and-column-colors-of-a-table-using-jquery/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T16:14:42.060

您需要根据表的行确定 THs[索引](http://api.jquery.com/index/)，然后将相同的规则应用于具有相同索引的 TDS。

因此，如果您确定 TH 1041051600000 需要样式，请找出它在行中的第一个，然后使用该数字为您的 TD 设置样式。

# javascript - JavaScript 检查并在提交按钮单击时动态地将文本添加到表格中

> ID：13420264
> 
> 赞同：2
> 
> 时间：2012-11-16T16:11:35.003
> 
> 标签：javascript, appendchild, createtextnode

基本上我的 HTML 看起来像这样：

```
<form method="post" name="htmlform" onsubmit = "checkFields()">
  <table style="width: 479px;" border="30" cellspacing="3" cellpadding="10">
  <tbody>
  <tr>
  <td valign="top"><span id="firstNameSpan" >First Name *</span></td>
  <td valign="top"><input type="text" name="first_name" id="first_name"
                    size="30" maxlength="50" /></td>
  </tr>
  <tr>
  <td valign="top"><span id = "lastNameSpan" >Last Name *</span></td>
  <td valign="top"><input type="text" name="last_name" size="30" maxlength="50"/> 
      /td>
  </tr>
  <tr>
  <td style="text-align: center;" colspan="2"><input type="radio" name="sex" 
  value="male" /> Male <input type="radio" name="sex" 
  value="female" /> Female</td>
  </tr>
  <tr>
  <td style="text-align: center;" colspan="2"><input type="submit" value="submit" 
       /></td>
  </tr>
  </tbody>
  </table>
  </form> 
```

提交表单时，onsubmit() 事件检查 first_name 文本字段是否为空，如果是，则将其左侧的标签或跨度附加到输出“名字*”+“您必须输入名字”，类似地姓氏和性别。

问题是表中的文本没有用 appendchild 更新。当我将该语句包含在调试警报中时，该消息被附加然后消失。

下面是 onsubmit = "checkFields()" 的 JavaScript 代码。

```
function checkFields() {
    var firstName = document.getElementById("first_name").value;
    var lastName = document.getElementById("last_name").value;
    if (firstName == "") {
        //<span style='color:red'> Please enter a first name </span>
        var nameHint = " Please enter a first name";
        var node = document.getElementById("firstNameSpan");
        //alert(node.appendChild(document.createTextNode(nameHint)) );
        //not working
        node.appendChild(document.createTextNode(nameHint));

    } if (lastName == "") {
        //additional code
    }
} 
```

在此先感谢，非常感谢您的帮助。还有 JavaScript 调试器吗？

问候

大卫 D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:55:21.860

我相信您的示例代码由于 html 不正确而无法正常工作。`document.getElementById("last_name")`将返回未定义。

[http://jsfiddle.net/5E6my/1/](http://jsfiddle.net/5E6my/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T20:14:43.730

谢谢大家，我得到了 JFiddle 的绳索，虽然错误消息对调试没有用，但分屏非常有用。这是完整的代码 (1) HTML (2) JavaScript。

```
<form method="post" name="htmlform" onsubmit="return checkFields();">
  <table style="width: 479px;" border="30" cellspacing="3" cellpadding="10">
  <tbody>
  <tr>
  <td valign="top"><span id="firstNameSpan" >First Name *</span></td>
  <td valign="top"><input type="text" name="first_name" id="first_name"
                                            size="30" maxlength="50" /></td>
  </tr>
  <tr>
  <td valign="top"><span id = "lastNameSpan" >Last Name *</span></td>
  <td valign="top"><input type="text" name="last_name" id="last_name" size="30" 
  maxlength="50" /></td>
  </tr>
  <tr>
  <td style="text-align: center;" colspan="2" id = "sexMessage">
      Please select Male or Female*</td>
  </tr>
  <tr>
  <td style="text-align: center;" colspan="2"><input type="radio"
   name="sex" value="male" /> Male <input type="radio" name="sex"
  value="female" /> Female</td>
  </tr>
  <tr>
  <td style="text-align: center;" colspan="2"><input type="submit" value="submit"    
   /></td>
  </tr>
  </tbody>
  </table>
  </form> 
```

对表单中 onsubmit 按钮的未填充字段做出反应的 JavaScript 代码是：（有什么方法可以使此代码更简单？？）

```
window.checkFields = function()
  {
  var firstName = document.getElementById("first_name");
  var lastName = document.getElementById("last_name");
  if(firstName.value == "")
  {
  //<span style='color:red'> Please enter a first name </span>
    var nameHint = " *Please enter a first name ";
    var fnNode = document.getElementById("firstNameSpan");
    while(fnNode.firstChild)
    {
        fnNode.removeChild(fnNode.firstChild)
    }
    fnNode.appendChild(document.createTextNode(nameHint));
    fnNode.style.color="red";

  } else{
      var nameHint = " First Name *";
      var fnNode = document.getElementById("firstNameSpan");
      while(fnNode.firstChild)
      {
        fnNode.removeChild(fnNode.firstChild)
      }
      fnNode.appendChild(document.createTextNode(nameHint));
      fnNode.style.color="black";
  }
  if (lastName.value == "")
  {
  //additional code
    var nameHint = " *Please enter a last name";
    var lnNode = document.getElementById("lastNameSpan");
    while(lnNode.firstChild)
    {
        lnNode.removeChild(lnNode.firstChild)
    }
    lnNode.appendChild(document.createTextNode(nameHint));
    lnNode.style.color="red";
  } else{
      var nameHint = " Last Name *";
      var lnNode = document.getElementById("lastNameSpan");
      while(lnNode.firstChild)
      {
        lnNode.removeChild(lnNode.firstChild)
      }
      lnNode.appendChild(document.createTextNode(nameHint));
      lnNode.style.color="black";
  }
      var radios = document.getElementsByName("sex");
      var radioValue = ""
      for(var i=0; i<radios.length; i++)
      {
          if(radios[i].checked)
          {
              radioValue = radios[i].value;
          }

      }
      if(radioValue === "")
      {
          var sexNode = document.getElementById("sexMessage");
          var nameHint = "*You did not choose a sex";
          while(sexNode.firstChild)
          {
              sexNode.removeChild(sexNode.firstChild);
          }
          sexNode.appendChild(document.createTextNode(nameHint));
          sexNode.style.color="red";
      } else {
          var sexNode = document.getElementById("sexMessage");
          var nameHint = "Please select Male or Female*";
          while(sexNode.firstChild)
          {
              sexNode.removeChild(sexNode.firstChild);
          }
          sexNode.appendChild(document.createTextNode(nameHint));
          sexNode.style.color="black";
      }               
      return false;
  } 
```

诀窍是按照 Yury 的建议使用 onsubmit="return checkfields()" ，然后在代码块中使用 window.checkFields = function() { 等。

我有一个问题... JQuery 使用起来要简单得多，我在 JQuery 之前学习 JavaScript... 我应该跳到 JQUery 吗？JQuery 也支持 AJAX 框架吗？

非常感激

大卫

# rtc - 当用户创建新流时添加弹出/提醒

> ID：13420265
> 
> 赞同：1
> 
> 时间：2012-11-16T16:11:37.543
> 
> 标签：rtc

要在 RTC 源代码控制中创建新流，我右键单击快照并选择“新建”->“来自快照的流”。是否可以在此时添加提醒/弹出窗口以向用户指示应更改某些文件作为创建此新流的一部分？或者更好地更新流本身的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:26:42.187

我看不到任何方法可以在 Stream 创建中添加弹出窗口。

您可以定义一个挂钩，但“团队配置/操作行为”部分不包含“创建流”操作。
因此，似乎没有任何*本机*方式可以实现您的需求。

# jquery - 在使用 jQuery 提交之前如何检查 POST 数据大小？

> ID：13420266
> 
> 赞同：3
> 
> 时间：2012-11-16T16:11:38.090
> 
> 标签：jquery, file-upload, postdata

我有一个网络应用程序，允许用户添加多个图像，然后在他们按下“保存”按钮时一次性上传它们以及其他数据。我正在尝试在发送 POST 数据之前计算它的*总*大小，这样我就可以将请求分成多个，以避免遇到 PHP`post_max_size`或`max_file_uploads`错误。

目前，我使用此代码仅使用 HTML5 File API（属性）检查*图像的整体大小：*`size`

```
// Calculate size of all files being submitted
var ttlSize = 0;
$('form').find('input[type=file]').each(function() {
    ttlSize += this.files[0].size;
});

if (ttlSize > 4 * 1048576) { // >4MB
    // this will exceed post_max_size PHP setting, now handle...
} else if ($('form').find('input[type=file]').length >= 10) {
    // this will exceed max_file_uploads PHP setting, now handle...
} 
```

我想通过包括其余的 POST 数据来更精确。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:37:32.770

您可以通过计算序列化表单的长度来估算它，不包括文件上传字段。所以它会是沿着这些路线的某个地方：

`$("form").not("[type='file']").serialize().length`;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:40:28.437

出于安全目的，对文件上传元素的访问仅限于文件名。访问客户端计算机上文件的唯一方法是通过新的 FormData 对象使用 html5。看看这里：[FormData - 文档对象模型](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/FormData)。如果没有这个对象，您将无法获得文件的大小。否则：为什么不实现异步上传？

# rss-reader - 阅读RSS并显示

> ID：13420276
> 
> 赞同：1
> 
> 时间：2012-11-16T16:12:11.617
> 
> 标签：rss-reader

我试图阅读 RSS 并简单地在 ListView 上显示结果。我的应用程序运行然后崩溃。我认为这是因为我为列表适配器创建的类“theAdapter”。

```
public class MainActivity extends Activity {
ArrayList<handler> PostList=new ArrayList<handler>(1000);
ListView list;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    list=(ListView)findViewById(R.layout.activity_main);
    new loading().execute("http://theurlfeed");
    }
class loading extends AsyncTask<String, Void, String>{

    @Override
    protected String doInBackground(String... params) {
        try {
            helper.parse(params[0]);
        } catch (IOException e) { e.printStackTrace();} 
              catch (XmlPullParserException e) {e.printStackTrace();}
        return null;
    }

    protected void onPostExecute(String s) {
        list.setAdapter(new theAdapter(MainActivity.this, PostList));
    }       
}}

public class handler {
String title="";
handler(String s){
    title=s;
}
String getTitle(){
    return title;
}} 
```

读取和解析我的 xml 的类

```
public class helper {

 public static ArrayList<handler> parse(String url) throws IOException, XmlPullParserException {
        final ArrayList<handler> results = new ArrayList<handler>(1000);
        String die=url;
        XmlPullParserFactory factory = XmlPullParserFactory.newInstance();
        factory.setNamespaceAware(true);
        XmlPullParser xpp = factory.newPullParser();
        URL input = new URL(die);
        xpp.setInput(input.openStream(), null);

        int eventType = xpp.getEventType();
        String currentTag = null;
        Integer id = null;
        String title = null;

            while (eventType != XmlPullParser.END_DOCUMENT) {
            if (eventType == XmlPullParser.START_TAG) {
                currentTag = xpp.getName();
            } else if (eventType == XmlPullParser.TEXT) {
                if ("id".equals(currentTag)) {
                    id = Integer.valueOf(xpp.getText());
                }
                if ("title".equals(currentTag)) {
                    title = xpp.getText();
                }
            } else if (eventType == XmlPullParser.END_TAG) {
                if ("recipe".equals(xpp.getName())) {
                    results.add(new handler(title));
                }
            }
            eventType = xpp.next();
        }
        return results;
    }} 
```

列表适配器

```
public class theAdapter extends BaseAdapter {
private Activity activity;
private ArrayList<handler> data;
private static LayoutInflater inflater = null;
ViewHolder holder;

theAdapter(Activity a, ArrayList<handler> d) {
    activity = a;
    data = d;
    inflater = (LayoutInflater) activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
}
public static class ViewHolder {
    public TextView label;
}

public View getView(int position, View convertView, ViewGroup parent) {
    View vi = convertView;
    if (convertView == null) {
        vi = inflater.inflate(R.layout.text, null);
        holder = new ViewHolder();
        holder.label = (TextView) vi.findViewById(R.id.title);
        vi.setTag(holder);
    } else
        holder = (ViewHolder) vi.getTag();
    holder.label.setText(data.get(position).getTitle());
    return vi;
}
public int getCount() {
    return 0;
}

public Object getItem(int position) {
    return null;
}

public long getItemId(int position) {
    return 0;
}} 
```

这是日志。

I/Process(1627)：发送信号。PID：1627 SIG：9

我错过了什么？

# spring - Spring 3 Hibernate Spring MVC Arch 类型

> ID：13420280
> 
> 赞同：1
> 
> 时间：2012-11-16T16:12:42.567
> 
> 标签：spring, maven, spring-mvc

有谁知道带有 Hibernate 的 Spring Web MVC 的良好原型？我一直在寻找并没有找到任何东西？

亲切的问候，

穆罕默德·马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T23:25:57.707

您可以使用 appFuse：[http ://static.appfuse.org/archetypes.html](http://static.appfuse.org/archetypes.html)

但是，我会推荐 spring ROO。Spring ROO 不提供原型，但通过 spring roo 命令提供了类似的骨架设置。

# google-chrome - 为什么这张图片在 Photoshop 和 Chrome 中看起来不同？

> ID：13420282
> 
> 赞同：2
> 
> 时间：2012-11-16T16:13:02.720
> 
> 标签：google-chrome, colors, photoshop, color-profile

我使用嵌入式 sRGB 配置文件保存了下面的图像。Photoshop 设置了正确的颜色设置（RGB 为 sRGB IEc61966-2.1），校样设置为“Internet 标准 RGB (sRGB)”。该图像在 Photoshop、Safari 和 Firefox 中看起来相同。但是在 Chrome 23 中查看它会给我一个非常沉闷的图像，就好像它没有读取嵌入的颜色配置文件一样。

此类页面[表明](http://www.petapixel.com/2012/06/25/is-your-browser-color-managed/)Chrome 正在正确管理颜色配置文件。那么我在这里做错了吗？Chrome 处理颜色配置文件的方式是否可能存在错误？我已经看到 Chrome 在以前的版本中做了一些奇怪的事情（当我滚动时，颜色配置文件被遵守和来回忽略）。

![样本 sRGB 图像](../Images/4d9a8403d4a8ea559e21fe0e3e5a01ad.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:53:08.480

您可以尝试删除颜色配置文件，然后按照[此人的指导再次保存图像 »](http://viget.com/inspire/the-mysterious-save-for-web-color-shift)

不幸的是，一旦颜色配置文件被剥离，您可能不得不摆弄您的图像，但至少您将拥有一张干净的石板。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-11-18T14:30:21.070

使用#颜色代码。它比 R、G、B 和...

# java - 如何在调用类中捕获抛出的异常

> ID：13420283
> 
> 赞同：-1
> 
> 时间：2012-11-16T16:13:03.810
> 
> 标签：java, jsf

如果我尝试在数据库中插入现有对象，我会得到一个抛出异常的方法。

```
 public void addInDB() throws Exception {
    if (isInBase()){
          throw new Exception ("[ReqFamily->addInDB] requirment already in base");
    }
    int idParent = m_parent.getIdBdd();

    idBdd = pSQLRequirement.add(name, description, 0, idParent,   
    ReqPlugin.getProjectRef().getIdBdd(), 100);
} 
```

因此，当抛出异常时，我想捕获它并在我的托管 bean 中显示错误消息。

PS：在我的托管 bean 中，我只调用该方法：

```
void addReq(Requirement req){
    try {
        ReqFamily pReqParent = (ReqFamily) selectedNode.getData();
        req.setParent(pReqParent);
        req.addInDB();//here i want to catch it 

        DefaultTreeNode newReqNode = new DefaultTreeNode(req,selectedNode);
        if (pReqParent!=null){
            pReqParent.addRequirement(req);
        }

    } catch (Exception ex){

        ex.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:16:32.427

试试这个：

```
 try {
            req.addInDB();//here i want to catch it 
        } catch (Exception ex){
            ex.printStackTrace();
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:19:13.713

接住或扔出是不好的做法`Exception`。如果您使用的任何代码引发检查异常，则只需捕获该特定异常，并尝试最小化`try-catch`块的大小。

```
class MyException extends Exception {
    ...

public void addInDB() throws MyException {
    if (isInBase()){
        throw new MyException ("[ReqFamily->addInDB] requirment already in base");
    }
    ...

void addReq(Requirement req){
    ReqFamily pReqParent = (ReqFamily) selectedNode.getData();
    req.setParent(pReqParent);

    try {
        req.addInDB();
    } catch (MyException ex){
        ex.printStackTrace();
    }

    DefaultTreeNode newReqNode = new DefaultTreeNode(req,selectedNode);
    if (pReqParent!=null){
        pReqParent.addRequirement(req);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T16:22:00.203

你可以试试这个：

```
void addReq(Requirement req){
    try {
        ReqFamily pReqParent = (ReqFamily) selectedNode.getData();
        req.setParent(pReqParent);
        req.addInDB();//here i want to catch it 

        DefaultTreeNode newReqNode = new DefaultTreeNode(req,selectedNode);
        if (pReqParent!=null){
            pReqParent.addRequirement(req);
        }

    } catch (Exception ex){

        JOptionPane.showMessageDialog(null, ex);
    }
} 
```

如果您想捕获所有堆栈跟踪以显示在显示中，您可以使用这个：

```
catch (Exception ex) {

   String
   ls_exception = "";

   for (StackTraceElement lo_stack : ex.getStackTrace()) {

      ls_exception += "\t"+lo_stack.toString()+"\r\n";

   }

   JOptionPane.showMessageDialog(null, ls_exception);
} 
```

# ruby-on-rails - Events sent to Google Analytics with Gabba don't have a hostname

> ID：13420285
> 
> 赞同：0
> 
> 时间：2012-11-16T16:13:13.327
> 
> 标签：ruby-on-rails, ruby-on-rails-3, google-analytics, gabba

I'm using [Gabba](https://github.com/hybridgroup/gabba) to send events to Google Analytics from my rails back-end.

When I send events, the "hostname" is not set (in Content > Events > click on an event > set "Second dimension" to hostname).

* * *

![](../Images/082fc0d69825c3964ffe00fd09ee242d.png)

* * *

Here's a simplified version of how I send my events:

```
gabba ||= Gabba::Gabba.new(Settings.google_analytics.ua_code, "none")
gabba.identify_user(cookies[:__utma], cookies[:__utmz])
gabba.event("Submissions", "submit_for_review") 
```

My question is: **where does Google Analytics pick up the hostname from?**

I thought it was from the utmz cookie, but it doesn't work.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:44:35.857

Try this:

```
g = Gabba::Gabba.new("CODE", "mydomain.com") 
```

# javascript - 用chrome调试node js垃圾收集/内存问题

> ID：13420287
> 
> 赞同：7
> 
> 时间：2012-11-16T16:13:16.107
> 
> 标签：javascript, node.js, memory, garbage-collection

我试图解决我在使用 Node 应用程序（v 0.8.6）时遇到的一些内存泄漏的根本问题。

为了帮助解决这个问题，我正在使用[https://github.com/c4milo/node-webkit-agent](https://github.com/c4milo/node-webkit-agent)。因为应用程序很大，所以我在测试台中隔离了这个问题，以限制大型应用程序中的噪音量。

我们运行测试，然后将 Chrome 代理附加到进程。该对象似乎应该被清理，因为没有保留路径在任何根对象处结束。我对保留路径的理解是否存在缺陷，还有什么我遗漏的吗？我在调试会话下方上传了一个屏幕截图，显示了我认为应该被 GC 处理的对象以及不会返回任何 GC 根对象的保留路径。

![http://imgur.com/xV9xR](../Images/167df64f0b7f69462ab85734affc5ebf.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:42:37.773

另一种解决问题的方法是尝试 d​​trace。我强烈建议将您的项目放在基于 illumos 的发行版中，例如[smartOS](http://smartos.org/)：

这是一篇关于如何使用 dtrace 来查找节点应用程序中的内存泄漏的文章：http: [//dtrace.org/blogs/bmc/2012/05/05/debugging-node-js-memory-leaks/](http://dtrace.org/blogs/bmc/2012/05/05/debugging-node-js-memory-leaks/)

# .htaccess - 使用 CodeIgniter 和 HTTPS 时摆脱 URL 中的索引

> ID：13420288
> 
> 赞同：0
> 
> 时间：2012-11-16T16:13:17.553
> 
> 标签：.htaccess, codeigniter, https, url-rewriting

我一直在开发一个 codeigniter 应用程序。当我第一次开始开发它时，我使用了以下 url 结构：

[http://somewebsite.com/application/login/](http://somewebsite.com/application/login/)

我将网站更改为通过 https 运行

[https://www.somewebsite.com/application/login/](https://www.somewebsite.com/application/login/)

问题是对服务器的任何调用都只能这样工作。

[https://www.somewebsite.com/application/index.php/login/](https://www.somewebsite.com/application/index.php/login/)

我想摆脱 index.php。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:19:31.810

您需要让 .htaccess 正确地重写 SSL。这是我使用的有效的 .htaccess - 尽管它强制使用 SSL。不确定您是否要这样做：

```
<IfModule mod_rewrite.c>
RewriteEngine On

#Force SSL
RewriteCond %{SERVER_PORT} 80 
RewriteRule ^(.*)$ https://yourdomain.com/$1 [R,L]

#Removes access to the system folder by users.
#Additionally this will allow you to create a System.php controller,
#previously this would not have been possible.
#'system' can be replaced if you have renamed your system folder.
RewriteCond %{REQUEST_URI} ^system.*
RewriteRule ^(.*)$ /index.php?/$1 [L]

#When your application folder isn't in the system folder
#This snippet prevents user access to the application folder
#Submitted by: Fabdrol
#Rename 'application' to your applications folder name.
RewriteCond %{REQUEST_URI} ^application.*
RewriteRule ^(.*)$ /index.php?/$1 [L]

#Checks to see if the user is attempting to access a valid file,
#such as an image or css document, if this isn't true it sends the
#request to index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?/$1 [L]
</IfModule>

<IfModule !mod_rewrite.c>
# If we don't have mod_rewrite installed, all 404's
# can be sent to index.php, and everything works as normal.
# Submitted by: ElliotHaughin

ErrorDocument 404 /index.php
</IfModule> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T17:34:33.503

检查并编辑 application/config/config.php。在那个更改以下行

```
$config['index_page'] = 'index.php'; 
```

到

```
$config['index_page'] = ''; 
```

只需删除`index.php`，然后它应该可以正常工作......

# matlab - MATLAB 创建一个包含来自单元格的数字和字符串的 .txt 文件

> ID：13420289
> 
> 赞同：2
> 
> 时间：2012-11-16T16:13:16.323
> 
> 标签：matlab

亲爱的stackoverflowers，

我想使用 matlab 创建一个 .txt 文件。内容应该用制表符分隔。它应该有 3 列，并且第 3 列应该用元胞数组中的字符串填充。比方说

```
A=[2; 3; 3;];
B=2*A;
C=cell(3,1);
C{1,1}='string1'; C{2,1}='string2'; C{3,1}='string3'; 
```

最后，它应该如下所示：

```
 2  4  string1
    3  6  string2
    3  6  string3 
```

我已经发现，如何将 2 个矩阵放在一个文本文件中： dlmwrite('filename.txt', [AB], 'delimiter', '\t')

但是如何附加单元格的内容呢？最好只在文件中包含字符串，而不是单引号。我没有在其他地方找到解决方案，也没有在其他地方问过这个问题。我很欣赏各种建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:36:51.893

尝试以下操作：

```
% Open a file for writing (if you want to append to file use 'a' instead of 'w')
fid = fopen(file,'w');

for i = 1:size(A,1)
    fprintf(fid,'%d  %d  %s\n',A(i),B(i),C{i})
end

fclose(fid) 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:35:35.213

dlmwrite 上的文档指出：

> **评论**
> 
> 生成的文件可由电子表格程序读取。
> 
> dlmwrite 函数不接受输入矩阵 M 的元胞数组。要导出仅包含数值数据的元胞数组，请在调用 csvwrite 之前使用 cell2mat 将元胞数组转换为数值矩阵。
> 
> 要导出包含混合字母和数字数据的元胞数组，其中每个元胞包含一个元素，您可以使用 xlswrite 创建一个 Excel 电子表格（如果您的系统安装了 Excel）。对于所有其他情况，您必须使用低级导出函数来写入数据。

因此，要么将其编写为 Excel 电子表格，要么使用必须编写自己的转换函数。

例如

```
A=[2; 3; 3;];
B=2*A;
C=cell(3,1);
C{1,1}='string1'; C{2,1}='string2'; C{3,1}='string3';

% First solution
f = fopen('filename.txt', 'w');
for n = 1:3
    fprintf(f, '%d\t%d\t%s\n', A(n), B(n), C{n});
end
fclose(f);

% Another solution
% create the table as a single cell array with only strings
C2 = [arrayfun(@num2str, [A, B], 'UniformOutput', false) C]'; % <- note the transpose

f = fopen('filename.txt', 'w');
fprintf(f, '%s\t%s\t%s\n', C2{:}); % <- every three entries are written as a line
fclose(f); 
```

# c# - 在单个 linq 查询中进行多个分组

> ID：13420290
> 
> 赞同：0
> 
> 时间：2012-11-16T16:13:18.540
> 
> 标签：c#, asp.net, asp.net-mvc-3, linq, entity-framework

我相信我需要在单个 linq 查询中有多个“Group into”语句。这是我正在尝试做的事情：

```
var queryNew = from a in ICDUnitOfWork.AlphaGroups.Find()
               join e in ICDUnitOfWork.Alphas.Find()
                      on a.AlphaGroupID equals e.AlphaGroupID into g
               join c in ICDUnitOfWork.Codes.Find()
                      on a.CodeID equals c.CodeID into co
               join cod in ICDUnitOfWork.Codes.Find()
                        on g.CodeID equals cod.CodeID
               select new HomeSearchViewModel
               {
                   Alphas = g,
                   AlphaGroups = a,
                   AlphaGroupCode = co,
                   AlphasCodes = cod
               }; 
```

一个 Alpha 组具有一组 Alpha。每个 AlphaGroup 都有一个对应的 AlphaGroup.CodeId，每个 Alpha 都有一个 Alpha.CodeId 需要加入“代码”类。我不知道如何调整我的查询来完成这个。

**编辑：** 最终结果应该类似于：

AlphaGroup -> 包含多个“Alpha”

每个 AlphaGroup 都有一个来自“Codes”类的对应 CodeId，每个 Alpha 也有一个对应的 CodeID。

所以 ViewModel 看起来像：

```
public class HomeSearchViewModel
{
    public IEnumerable<Alpha> Alphas { get; set; }
    public AlphaGroup AlphaGroups { get; set; }
    public IEnumerable<Code> AlphasCodes { get; set; }
    public Code AlphaGroupCode { get; set; }
    public string SearchTerm { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:05:15.397

完全未经测试，但尝试类似：

```
select new
    {
      Alphas = g
      AlphaGroups = a,
      AlphaGroupCode = co,
      AlphasCodes = cod
    }
 .GroupBy(grp => grp.AlphaGroups)
 .Select(grp => new HomeSearchViewModel
    {
       AlphaGroups = grp.Key,
       AlphaGroupCode = grp.Key.Code,
       Alphas = grp.ToList(),
       AlaCodes = grp.Select(alp => alp.Code)
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T23:49:12.707

在这种情况下，将其置于流畅的语法中可能会更容易，如果我了解您的要点，您正在尝试执行以下操作：

```
var result = ICDUnitOfWork.AlphaGroups.Find()
                          .GroupJoin( ICDUnitOfWork.Alphas.Find()
                                                   .Join( ICDUnitOfWork.Codes.Find(),
                                                          alpha => alpha.CodeID,
                                                          code => codeID,
                                                          (alpha,code) => new
                                                                    {
                                                                      Alpha = alpha,
                                                                      AlphaCode = code
                                                                    }),
                                       alphaG => alphaG.AlphaGroupID,
                                       anon => anon.Alpha.AlphaGroupID,
                                       (alphaG, anonG) => new
                                                       {
                                                        AlphaGroup = alphaG,
                                                        AnonG = anonG
                                                       })
                          .Join( ICDUnitOfWork.Codes.Find(),
                                 anon => anon.AlphaGroup.CodeID,
                                 code => code.CodeID,
                                 (anon, g) => new HomeSearchViewModel()
                                              {
                                                     AlphaGroups = anon.AlphaGroup,
                                                     AlphaGroupCode = g,
                                                     Alphas = anon.AnonG
                                                                  .Select(anonG => anonG.Alpha),
                                                     AlphaCodes = anon.AnonG
                                                                      .Select(anonG => anonG.AlphaCode)
                                                   }); 
```

因此，这是在假设 alpha 的代码是一对一的，或者您不希望它们的嵌套组（这似乎是您从视图结构而不是您的查询中所说的......）的假设下工作的。

同样，将它放在静态语法中会是这样的：

```
var result = from ag in (from AlphaG in ICDUnitOfWork.AlphaGroups.Find()
                                 join AlphaGCode in ICdUnitOfWork.Codes.Find()
                                 on AlphaG.CodeID = AlphaGCode.CodeID)
             join a in (from Alpha in ICDUnitOfWork.Alphas.Find()
                                 join AlphaCode in ICdUnitOfWork.Codes.Find()
                                 on Alpha.CodeID = AlphaCode.CodeID)
             into Alphas
             select new HomeSearchViewModel
                    {
                     AlphaGroups = ag.AlphaG,
                     AlphaGroupCode = ag.AlphaGCode,
                     Alphas = Alphas.Select(anon => anon.Alpha),
                     AlphasCodes = Alphas.Select(anon => anon.AlphaCode)
                    }; 
```

虽然这可能需要一些调整，因为无法访问 vs ATM。

# c++ - 在 Pro*C 中使用 LIKE

> ID：13420296
> 
> 赞同：0
> 
> 时间：2012-11-16T16:13:43.983
> 
> 标签：c++, sql, oracle, oracle-pro-c

如何在 Pro*C 中使用 LIKE？下面的代码不起作用。我需要在数据库中搜索记录。

```
cout<<"Employee name\t\t: ";
cin.getline(name,50);

EXEC SQL SELECT NAME INTO :nameResult FROM EMPLOYEE WHERE NAME LIKE '%:name%'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:38:23.050

像这样声明一个宿主变量：“char hLikeVar[64];”。然后将字符串复制 "%[empl name]%" 到其中。对于 [empl name]，请使用您从用户那里获得的输入。然后你可以这样做：

...在哪里命名：hLikeVar；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T08:27:12.573

所以 Pro * C 提供了`varchar`结构，你不需要处理很多事情。因此，如果您要声明

```
varchar LikeVar[Length_of_Variable]; 
```

并使用

```
strcpy(LikeVar.arr); /* .arr is the character array */
LikeVar.len = strlen(LikeVar.arr); 
```

之后就可以直接在sql语句中使用：with。

# sql-server - 在 SQL Server 中存储文件

> ID：13420305
> 
> 赞同：89
> 
> 时间：2012-11-16T16:14:14.027
> 
> 标签：sql-server

这是我知道的一个老问题，但是使用 SQL Server 2012 最终可以将文件存储在数据库中，还是应该将它们真的保存在文件系统中，只在数据库中引用它们？

如果现在认为将它们存储在数据库中是可以接受的，那么最有效的方法是什么？

我计划应用加密，所以我很欣赏处理不会很快。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-11-16T16:56:40.157

Microsoft Research 有一篇非常好的论文，名为[To Blob 或 Not To Blob](http://research.microsoft.com/apps/pubs/default.aspx?id=64525)。

他们经过大量的性能测试和分析后得出的结论是：

*   如果您的图片或文档的大小通常低于 256K，则将它们存储在数据库的 VARBINARY 列中会更有效

*   如果您的图片或文档的大小通常超过 1 MB，则将它们存储在文件系统中会更有效（并且使用 SQL Server 2008 的 FILESTREAM 属性，它们仍处于事务控制之下并且是数据库的一部分）

*   在这两者之间，根据您的使用情况，这有点折腾

如果您决定将图片放入 SQL Server 表中，我强烈建议您使用单独的表来存储这些图片 - 不要将员工照片存储在员工表中 - 将它们保存在单独的表中。这样，假设您并不总是需要选择员工照片作为查询的一部分，那么 Employee 表可以保持精简、平均和非常高效。

对于文件组，请查看[文件和文件组架构](http://msdn.microsoft.com/en-us/library/ms179316.aspx)以获得介绍。基本上，您可以从一开始就为大型数据结构创建带有单独文件组的数据库，或者稍后添加一个额外的文件组。我们称之为“LARGE_DATA”。

现在，每当您要创建一个需要存储 VARCHAR(MAX) 或 VARBINARY(MAX) 列的新表时，您都可以为大数据指定此文件组：

```
 CREATE TABLE dbo.YourTable
     (....... define the fields here ......)
     ON Data                   -- the basic "Data" filegroup for the regular data
     TEXTIMAGE_ON LARGE_DATA   -- the filegroup for large chunks of data 
```

查看有关文件组的 MSDN 介绍，并尝试使用它！

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-11-16T16:18:15.470

***仍然***没有简单的答案。这取决于你的场景。 [MSDN 有帮助您决定的文档。](http://msdn.microsoft.com/en-us/library/hh403405.aspx)

这里还介绍了其他选项。您可以使用 SQL Server 2012 中的 FileStream 或 File Table，而不是直接存储在文件系统中或存储在 BLOB 中。File Table 的优点似乎很简单（但我承认我没有亲身体验过它们） .)

这篇文章绝对值得一读。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-11-16T16:18:11.320

您可能会阅读[FILESTREAM](http://msdn.microsoft.com/en-us/library/gg471497.aspx)。以下是文档中的一些信息，可以帮助您做出决定：

> 如果满足以下条件，则应考虑使用 FILESTREAM：
> 
> *   正在存储的对象平均大于 1 MB。
> *   快速读取访问很重要。
> *   您正在开发将中间层用于应用程序逻辑的应用程序。
> 
> 对于较小的对象，将 varbinary(max) BLOB 存储在数据库中通常可以提供更好的流式传输性能。

# macos - libiconv.2.dylib 山狮问题

> ID：13420308
> 
> 赞同：4
> 
> 时间：2012-11-16T16:14:16.400
> 
> 标签：macos, git, libiconv

每当我尝试安装依赖于**git的东西（例如****自制软件**）时，我都会收到此错误：

```
> Incompatible library version: git requires version 8.0.0 or later, but
> libiconv.2.dylib provides version 7.0.0 
```

我已经重新安装了 git 和**xcode**，但错误一直被抛出。我没有安装**macports**。

有人对如何解决有想法吗？

# asp.net - 用户控件属性

> ID：13420315
> 
> 赞同：0
> 
> 时间：2012-11-16T16:14:35.323
> 
> 标签：asp.net, linq

我有一个带有以下标记的详细视图，此详细视图的数据源来自存储过程“spDocResult”，如下所示：

```
select DocId,TransId,FileId,Filename,ContentType,Data,DocumentNo,Title,TRANSMITTAL
from DocumentSum2
where (DocId=@Docid)AND(Transid=@Transid) 
```

此详细视图的一个字段应显示 Efile Names，因此我为此设置了 1 个用户控件

```
public partial class FileTemp : System.Web.UI.UserControl
{
    private EDMSDataContext _DataContext;
private IEnumerable<tblFile> _Efiles;

public IEnumerable<tblFile> Efiles
{
    set { _Efiles = value; }
}
protected void Page_Load(object sender, EventArgs e)
{ 
}
    protected void LinkButton1_Command(object sender, CommandEventArgs e)
{
    if (e.CommandName == "Download")
    {
         _DataContext = new EDMSDataContext();
        //you can get your command argument values as follows
        string FileId = e.CommandArgument.ToString();
       int _FileId = Convert.ToInt32(FileId);
       tblFile Efile = (from ef in _DataContext.tblFiles
                    where ef.FileId == _FileId
                    select ef).Single();
       if (Efile != null)
       {

           download(Efile);

       }}}

        private void download ( tblFile Efile) 
```

{

```
Byte[] bytes = (Byte[])Efile.Data.ToArray();
Response.Clear();

Response.Buffer = true;

Response.Charset = "";

Response.Cache.SetCacheability(HttpCacheability.NoCache);

Response.ContentType = Efile.ContentType.ToString();

Response.AddHeader("content-disposition", "attachment;filename="

+ Efile.FileName.ToString());

Response.BinaryWrite(bytes);

Response.Flush();

Response.End(); 
```

}

```
public override void DataBind()
        {
            base.DataBind();
            GridViewEfile.DataSource = _Efiles;
            GridViewEfile.DataBind();

        } 
```

}

现在我有问题，因为 detailview 的数据源来自存储过程，而用户控件的属性来自 tblFile，所以当我使用 DetailsView1_DataBound 时，我不知道如何获取用户控件属性。当我使用下面的代码时，我有错误

```
can not implicity convert type string to system.collection.generic.iEnumerable<tblfile> 
```

我对这条线有错误

```
fileList.Efiles = docresult.Filename;

protected void DetailsView1_DataBound(object sender, EventArgs e)
{

    spDocResultResult docresult = (spDocResultResult)DetailsView1.DataItem;
    FileTemp fileList = (FileTemp)DetailsView1.FindControl("FileTemp1");

    fileList.Efiles = docresult.Filename;
    fileList.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:46:20.977

这可能根本不是数据绑定问题。从上下文中收集起来有点困难，但是......

```
FileTemp fileList = (FileTemp)DetailsView1.FindControl("FileTemp1");    
fileList.Efiles = docresult.Filename; 
```

fileList.Efiles 是您只想为其分配文件名的项目列表吗？如果是这样，您可能只需要遍历它们。

```
foreach (var file in fileList.Efiles)
{
    file.FileName = docresult.Filename;
} 
```

此外，将此行添加到您的 Efiles 声明以解决 Get 访问器错误。

```
public IEnumerable<tblFile> Efiles
{
    get { return _Efiles; } // <- here
    set { _Efiles = value; }
} 
```

# c# - 带有成功和失败操作的 MVC 4 删除操作

> ID：13420316
> 
> 赞同：0
> 
> 时间：2012-11-16T16:14:37.740
> 
> 标签：c#, jquery, .net, asp.net-mvc

您认为处理删除项目的最佳方法是什么。

下面是我最初想法的代码示例，但问题是`return RedirectToAction("Index")`丢失了上下文，因此索引不知道无法删除角色，因为有用户附加到它。

因此，如果无法删除它，我可以显示隐藏 div 中包含的消息，甚至可以显示带有警报的方法，让用户知道为什么无法删除它，但索引应该意识到问题。

我不想使用 Session 或 ViewData。我曾尝试使用一个，`@Ajax.ActionLink()`但总是收到一个 GET 请求。

jQuery 1.7.1 可供使用。

控制器

```
public ActionResult Delete(string roleName)
{
    RoleProvider roleProvider = new SARoleProvider();
    bool isDelete = roleProvider.DeleteRole(roleName, true);

    if (isDelete)
    {
        return RedirectToAction("Index");
    }

    return RedirectToAction("Index");
} 
```

看法

```
@Html.ActionLink("Delete", "Delete", new { roleName = item.Role }, new { @class = "confirmDelete btn btn-danger btn-mini", onclick = "return confirm('Delete this item?');" }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T14:17:24.277

我最终使用 jQuery 帖子根据项目是否可以删除来​​发送和接收我需要的信息。

索引.cshtml

```
<div class="alert alert-error" id="DeleteError">
    <a class="close" data-dismiss="alert">×</a>
    <span>There was a problem deleting the Role. Please check that there are no Users in the Role and try again or contact an Administrator.</span>
</div>

@Html.Raw("<a href=\"javascript:deleteRole('" + item.Role + "');\" class=\"confirmDelete btn btn-danger btn-mini\">Delete</a>")

<script type="text/javascript">

    $(document).ready(function () {
        $('#DeleteError').hide();
    });

    function deleteRole(roleName) {

        if (confirm('Delete the item?')) {

            // Begin the request
            $.post('@Url.Action("Delete")/?roleName=' + roleName, {}, function(data) {
                if (data.IsDeleted) {
                    // Refresh the page
                    window.location.reload();
                } else if (data.IsError) {
                    $("#DeleteError").show();
                }
            });
        }
    }
</script> 
```

控制器.cs

```
 [OutputCache(Duration = 0)]
    public JsonResult Delete(string roleName)
    {
        bool isError = false;
        bool isDeleted = Roles.Provider.DeleteRole(roleName, true);

        if (!isDeleted)
        {
            isError = true;
        }

        return Json(new { IsDeleted = isDeleted, IsError = isError }, JsonRequestBehavior.AllowGet);
    } 
```

# asp.net - 在构造函数asp net中访问WebControls可标记属性

> ID：13420320
> 
> 赞同：5
> 
> 时间：2012-11-16T16:14:49.123
> 
> 标签：asp.net, custom-server-controls

这是我的自定义控件。它从 WebControl 类继承 [Height] 属性。我想在构造函数中访问它以计算其他属性。但它的值始终为 0。知道吗？

```
 public class MyControl : WebControl, IScriptControl
{

    public MyControl()
    {
       AnotherProperty = Calculate(Height);
       .......
    } 
```

我的 aspx

```
 <hp:MyControl   Height = "31px" .... /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:39:03.510

标记值在控件的构造函数中不可用，但在控件的 OnInit 事件中可用。

```
protected override void OnInit(EventArgs e)
{
    // has value even before the base OnInit() method in called
    var height = base.Height;

    base.OnInit(e);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T02:38:08.653

正如@andleer 所说，尚未在控件的构造函数中读取标记，因此在标记中指定的任何属性值在构造函数中均不可用。在即将使用时按需计算另一个属性，并确保在 OnInit 之前不要使用：

```
private int fAnotherPropertyCalculated = false;
private int fAnotherProperty;
public int AnotherProperty
{
  get 
  {
    if (!fAnotherPropertyCalculated)
    {
       fAnotherProperty = Calculate(Height);
       fAnotherPropertyCalculated = true;
    }
    return fAnotherProperty;
  }
} 
```

# java - Does Pattern.compile cache?

> ID：13420321
> 
> 赞同：13
> 
> 时间：2012-11-16T16:14:49.987
> 
> 标签：java, regex

It is likely an implementation detail, but for the Oracle and IBM JDKs at least is the compiled pattern cached or do we as application developers need to perform the caching of compiled patterns ourselves?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-16T16:23:31.973

As far as I know from looking at the code (JDK 6) it doesn't do caching but once constructed, Pattern object could be cached on application side and shared among multiple threads. Standard pattern seems to be to assign it to final static variable:

```
private static final Pattern p = Pattern.compile(","); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-16T16:21:57.473

I don't believe the results are cached and there's no evidence of such behaviour in the [code](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/regex/Pattern.java) or the [documentation](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html). It would (of course) be relatively trivial to implement such a cache yourself, but I would be interested in a use case in which such caching is beneficial.

Re. the comment below and [String.split()](http://www.docjar.com/html/api/java/lang/String.java.html), there's a different approach in that the code takes a distinct path for trivial 1 or 2 char patterns vs more complex regexps. But it still doesn't appear to cache.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-04-06T19:34:00.663

I've created a class **CachedPattern** that can cache **Pattern** objects. If you run the **main** method you'll see that Java's **Pattern** objects are in fact different instances, which also consumes memory.

```
import java.util.HashMap;
import java.util.regex.Pattern;
import org.eclipse.core.runtime.Assert;

public class CachedPattern {

public static void main(String[] args){
    Pattern p1 = Pattern.compile("abc");
    Pattern p2 = Pattern.compile("abc");
    Pattern p3 = Pattern.compile("abc");
    Pattern p4 = Pattern.compile("abc");
    Pattern p5 = Pattern.compile("abc");

    Pattern x1 =  CachedPattern.compile("abc");
    Pattern x2 =  CachedPattern.compile("abc");
    Pattern x3 =  CachedPattern.compile("abc");
    Pattern x4 =  CachedPattern.compile("abc");
    Pattern x5 =  CachedPattern.compile("abc");
    // are cached objects the same ? YES!
    Assert.isTrue(x1.equals(x2));
    Assert.isTrue(x1.equals(x3));
    Assert.isTrue(x1.equals(x4));
    Assert.isTrue(x1.equals(x5));
    // are non-cached objects the same ? NO!
    Assert.isTrue(p1.equals(p2)); //AssertionFailedException
}

 private static HashMap<String, Pattern> cached = new HashMap<>();

 /**
  * This value must be unique, to make sure user won't use this inside "regex" variable,
  * so that objects without flags would be returned
  * For example if UNIQUE_HASH would be empty:
  *     compile(pattern = "abc1")
  *          VS.
  *     compile(pattern = "abc", flag = 1)
  * This would give same keys "abc1" and "abc1"
  */
 private static final String UNIQUE_HASH = "(())[]+@#$%^@!@#$%*";

 public static Pattern compile(String regex){
     if(cached.containsKey(regex)){
         return cached.get(regex);
     }
     Pattern p = Pattern.compile(regex);
     cached.put(regex, p);
     return p;
 }
 public static Pattern compile(String regex, int flags){
     String uniqueKey = regex + UNIQUE_HASH + flags;
     if(cached.containsKey(uniqueKey)){
         return cached.get(uniqueKey);
     }
     Pattern p = Pattern.compile(regex);
     cached.put(uniqueKey, p);
     return p;
 }

} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-01-07T12:11:46.783

According to **[Joshua_Bloch] Effective_Java**:

Some object creations are much more expensive than others. If you’re going to need such an “expensive object” repeatedly, it may be advisable to cache it for reuse. Unfortunately, it’s not always obvious when you’re creating such an object. Suppose you want to write a method to determine whether a string is a valid Roman numeral. Here’s the easiest way to do this using a regular expression:

```
// Performance can be greatly improved!
static boolean isRomanNumeral(String s) {
return s.matches("^(?=.)M*(C[MD]|D?C{0,3})"
+ "(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})$");
} 
```

The problem with this implementation is that it relies on the String.matches method. While String.matches is the easiest way to check if a string matches a regular expression, it’s not suitable for repeated use in performance-critical situations. The problem is that it internally creates a Pattern instance for the regular expression and uses it only once, after which it becomes eligible for garbage collection. Creating a Pattern instance is expensive because it requires compiling the regular expression into a finite state machine. To improve the performance, explicitly compile the regular expression into a Pattern instance (which is immutable) as part of class initialization, cache it, and reuse the same instance for every invocation of the isRomanNumeral method:

```
// Reusing expensive object for improved performance
public class RomanNumerals {
private static final Pattern ROMAN = Pattern.compile(
"^(?=.)M*(C[MD]|D?C{0,3})"
+ "(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})$");
static boolean isRomanNumeral(String s) {
return ROMAN.matcher(s).matches();
}} 
```

The improved version of isRomanNumeral provides significant performance gains if invoked frequently. On my machine, the original version takes 1.1 μs on an 8-character input string, while the improved version takes 0.17 μs, which is 6.5 times faster

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-11-16T16:26:42.480

It doesn't. If you have performance sensitive areas, you might want to hold your pattern objects as member variables.

Clojure does this more or less automatically when you have a regex in a function though.

# php - Mysql设置值相对于其他值？

> ID：13420323
> 
> 赞同：1
> 
> 时间：2012-11-16T16:14:57.067
> 
> 标签：php, mysql

> **可能重复：**
> [创建一个触发器，当另一个表中的列更新时更新一个表上的列](https://stackoverflow.com/questions/2678102/create-a-trigger-that-updates-a-column-on-one-table-when-a-column-in-another-tab)

我有一个包含这些值的数据库表

```
UpVotes | DownVotes | PercentVotes
8       | 2         | 80
10      | 0         | 100
5       | 5         | 50
560     | 34        | 94 
```

是否可以让 mysql 数据库像这样工作：

```
UpVotes | DownVotes | PercentVotes
8       | 2         | (UpVotes/(UpVotes + DownVotes)) x 100 = 80
10      | 0         | (UpVotes/(UpVotes + DownVotes)) x 100 = 100
5       | 5         | (UpVotes/(UpVotes + DownVotes)) x 100 = 50
560     | 34        | (UpVotes/(UpVotes + DownVotes)) x 100 = 94 
```

无需通过任何脚本自动更新？就像在 excel 中一样，您可以更改 UpVotes 值或 DownVotes 值，并且 PercentVotes 值会根据总票数自动成为新的正确百分比。

对不起我的英语不好，但我希望你明白我的意思。:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-16T16:15:59.720

你可以使用 a `trigger`。像这样的东西：

```
delimiter |
CREATE TRIGGER calc_percentages BEFORE INSERT on your_table
FOR EACH ROW
BEGIN
    SET NEW.PercentVotes = NEW.UpVotes/(NEW.UpVotes + NEW.DownVotes);
END
|
delimiter ; 
```

它将在每次插入时运行并添加计算值。如果您希望它在 an 之后更新，`update`那么只需添加另一个触发器`after update`而不是`before insert`.

由于百分比信息是一个计算值，您可以在您的选择中即时计算它，而不是将其存储在您的数据库中。但是，如果您真的需要性能增益，请使用触发器来存储它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:21:22.117

你会想在选择上运行这样的东西，你可能需要检查数学。

```
select UpVotes, DownVotes ((UpVotes / (UpVotes + DownVotes)) * 100) as PercentVotes from my_table; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:26:10.677

```
delimiter //
CREATE TRIGGER ins_votepercent BEFORE INSERT ON votetable FOR EACH ROW 
  SET NEW.PercentVotes = (NEW.UpVotes/(NEW.UpVotes+NEW.DownVotes)) * 100  
  END;//

CREATE TRIGGER upd_votepercent BEFORE UPDATE ON votetable FOR EACH ROW 
  SET NEW.PercentVotes = (NEW.UpVotes/(NEW.UpVotes+NEW.DownVotes)) * 100 
  END;// 
```

见[MySQL 手册](http://dev.mysql.com/doc/refman/5.1/en/trigger-syntax.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T16:21:40.080

对的，这是可能的。您可以使用触发器。只需在更新和插入时设置触发器，它就会改变列的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T16:24:26.837

如果您正在使用触发器，请尝试这样的事情

```
delimiter |

CREATE TRIGGER insertPercentVotes AFTER INSERT ON YourTableName

// calculate percentage here
      // Execute Update query here  
 END;
| 
```

# xml - 需要 XLST 来为 filemaker 读取 XML 文件结果

> ID：13420325
> 
> 赞同：1
> 
> 时间：2012-11-16T16:15:13.917
> 
> 标签：xml, parsing, xslt, import, filemaker

不是 xml 专家我试图从打印机导入日志文件，我需要一个 xlst 文件将其导入文件制作器，但出了点问题

*   我想要什么结果？
*   _Version 下结果=3.05
*   在“autoDischargeComposition”下结果=1
*   在“高度”结果=500.12077
*   在“宽度”下结果=400.22566
*   在“scaleFixedRatio”下结果=真
*   在“高度”下结果=56.20050
*   在“宽度”下结果=56.10050

所以我只需要名称和结果 xlst 文件现在发生的情况是它只获取

*   _版本 3.05
*   自动放电组合 1
*   并跳过其余的！！！！

这是打印机 log.xml 文件：

```
 <?xml version="1.0" encoding="UTF-8"?> 
    <java version="1.6.0_27" class="java.beans.XMLDecoder"> 
    <object class="rip.properties.XmlEdit"> 
    <void property="_VERSION"> 
    <string>3.05</string> 
    </void> 
    <void property="autoDischargeComposition"> 
    <int>1</int> 
    </void>  
    <void property="scale"> 
    <object class="cmn.math.DimDouble"> 
    <void property="height"> 
    <double>500.12077</double> 
    </void> 
    <void property="width"> 
    <double>400.22566</double> 
    </void> 
    </object> 
    </void> 
   <void property="scaleFixedRatio"> 
   <boolean>true</boolean> 
  </void> 
  <void property="scaleRatio"> 
  <object class="cmn.math.DimDouble"> 
  <void property="height"> 
  <double>56.20050</double> 
  </void> 
  <void property="width"> 
  <double>56.10050</double> 
  </void> 
 </object> 
 </void> 
 </object> 
</java> 
```

这是 xlst 文件

```
 <?xml version="1.0" encoding="UTF-8"?>
    <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:output method="xml" version="1.0" encoding="utf-8" indent="yes"/>

    <xsl:template match="/">

    <FMPXMLRESULT xmlns="http://www.filemaker.com/fmpxmlresult">
    <ERRORCODE>0</ERRORCODE>
    <PRODUCT BUILD="" NAME="" VERSION=""/>
    <DATABASE DATEFORMAT="" LAYOUT="" NAME="" RECORDS="" TIMEFORMAT=""/>

    <METADATA>
    <FIELD NAME="_VERSION" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
    <FIELD NAME="autoDischargeComposition" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>

    <FIELD NAME="height" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
    <FIELD NAME="width" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>

    <FIELD NAME="scaleRatio" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
    <FIELD NAME="height" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
    <FIELD NAME="width" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>

    </METADATA>

    <RESULTSET FOUND="">

    <xsl:for-each select="java/object">
    <ROW MODID="" RECORDID="">
    <COL><DATA><xsl:value-of select="void[@property='_VERSION']/string"/></DATA></COL>
    <COL><DATA><xsl:value-of select="void[@property='autoDischargeComposition']/int"/></DATA></COL>

    <COL><DATA><xsl:value-of select="void[@property='height']/string"/></DATA></COL>
    <COL><DATA><xsl:value-of select="void[@property='width']/string"/></DATA></COL>

    <COL><DATA><xsl:value-of select="void[@property='scaleRatio']/string"/></DATA></COL>
    <COL><DATA><xsl:value-of select="void[@property='height']/string"/></DATA></COL>
    <COL><DATA><xsl:value-of select="void[@property='width']/string"/></DATA></COL> 

    </ROW>

    </xsl:for-each>

    </RESULTSET>
    </FMPXMLRESULT>

    </xsl:template>
    </xsl:stylesheet> 
```

*   任何帮助将不胜感激谢谢

西宁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:42:21.907

问题是对于您的“高度”和“宽度”属性，它们嵌套在**void内的其他****对象**元素中

 **```
<void property="scaleRatio">
   <object class="cmn.math.DimDouble">
      <void property="height"> 
```

但是，您只是`<xsl:value-of select="void[@property='height']/string"/>`为了获取值，这只会在当前**对象元素中查找****void**元素。我认为您可能应该做这样的事情来应对双重嵌套的空白。

 **```
<xsl:value-of 
   select="void[@property='scale']/object/void[@property='height']/double"/> 
```

您遇到的唯一其他问题是您正在为您的 'scaleRatio' 元素寻找一个字符串值。我认为您可能需要在这里使用“scaleFixedRatio”。

尝试以下 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" version="1.0" encoding="utf-8" indent="yes"/>
   <xsl:template match="/">
      <FMPXMLRESULT xmlns="http://www.filemaker.com/fmpxmlresult">
         <ERRORCODE>0</ERRORCODE>
         <PRODUCT BUILD="" NAME="" VERSION=""/>
         <DATABASE DATEFORMAT="" LAYOUT="" NAME="" RECORDS="" TIMEFORMAT=""/>
         <METADATA>
            <FIELD NAME="_VERSION" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
            <FIELD NAME="autoDischargeComposition" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
            <FIELD NAME="height" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
            <FIELD NAME="width" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
            <FIELD NAME="scaleRatio" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
            <FIELD NAME="height" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
            <FIELD NAME="width" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
         </METADATA>
         <RESULTSET FOUND="">
            <xsl:for-each select="java/object">
               <ROW MODID="" RECORDID="">
                  <COL>
                     <DATA>
                        <xsl:value-of select="void[@property='_VERSION']/string"/>
                     </DATA>
                  </COL>
                  <COL>
                     <DATA>
                        <xsl:value-of select="void[@property='autoDischargeComposition']/int"/>
                     </DATA>
                  </COL>
                  <COL>
                     <DATA>
                        <xsl:value-of select="void[@property='scale']/object/void[@property='height']/double"/>
                     </DATA>
                  </COL>
                  <COL>
                     <DATA>
                        <xsl:value-of select="void[@property='scale']/object/void[@property='width']/double"/>
                     </DATA>
                  </COL>
                  <COL>
                     <DATA>
                        <xsl:value-of select="void[@property='scaleFixedRatio']/boolean"/>
                     </DATA>
                  </COL>
                  <COL>
                     <DATA>
                        <xsl:value-of select="void[@property='scaleRatio']/object/void[@property='height']/double"/>
                     </DATA>
                  </COL>
                  <COL>
                     <DATA>
                        <xsl:value-of select="void[@property='scaleRatio']/object/void[@property='width']/double"/>
                     </DATA>
                  </COL>
               </ROW>
            </xsl:for-each>
         </RESULTSET>
      </FMPXMLRESULT>
   </xsl:template>
</xsl:stylesheet> 
```

当应用于您的 XML 时，将输出以下内容

```
<FMPXMLRESULT xmlns="http://www.filemaker.com/fmpxmlresult">
   <ERRORCODE>0</ERRORCODE>
   <PRODUCT BUILD="" NAME="" VERSION=""/>
   <DATABASE DATEFORMAT="" LAYOUT="" NAME="" RECORDS="" TIMEFORMAT=""/>
   <METADATA>
      <FIELD NAME="_VERSION" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
      <FIELD NAME="autoDischargeComposition" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
      <FIELD NAME="height" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
      <FIELD NAME="width" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
      <FIELD NAME="scaleRatio" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
      <FIELD NAME="height" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
      <FIELD NAME="width" TYPE="NUMBER" EMPTYOK="YES" MAXREPEAT=""/>
   </METADATA>
   <RESULTSET FOUND="">
      <ROW MODID="" RECORDID="">
         <COL>
            <DATA>3.05</DATA>
         </COL>
         <COL>
            <DATA>1</DATA>
         </COL>
         <COL>
            <DATA>500.12077</DATA>
         </COL>
         <COL>
            <DATA>400.22566</DATA>
         </COL>
         <COL>
            <DATA>true</DATA>
         </COL>
         <COL>
            <DATA>56.20050</DATA>
         </COL>
         <COL>
            <DATA>56.10050</DATA>
         </COL>
      </ROW>
   </RESULTSET>
</FMPXMLRESULT> 
```****

# objective-c - 如何将自定义按钮添加到导航栏？

> ID：13420330
> 
> 赞同：0
> 
> 时间：2012-11-16T16:15:43.777
> 
> 标签：objective-c, rubymotion

我正在创建一个 Rubymotion 应用程序，我需要在导航栏中创建一个自定义按钮。我正在控制器中运行代码。

*我正在使用这段代码：*

```
button = UIBarButtonItem.alloc.init
    button.title = 'Add'
    button.style = UIBarButtonItemStylePlain
    button.target = self
    button.action = 'performAdd'
    button.setBackgroundImage(checkInImage, forState:UIControlStateNormal, forBarMetrics:UIBarMetricsDefault)
    button.setBackgroundImage(checkInPressed, forState:UIControlStateHighlighted, forBarMetrics:UIBarMetricsDefault)
    self.navigationItem.rightBarButtonItem = button 
```

*但是在运行 rake 时出现此错误：*

```
Terminating app due to uncaught exception 'NoMethodError', reason: 'first_controller.rb:21:in `button': undefined method `setBackgroundImage' for #<UIBarButtonItem:0x6b3c1d0> (NoMethodError) 
```

**解决方案**

```
 button = UIBarButtonItem.alloc.init
        button.title = 'Add'
        button.target = self
        button.action = 'performAdd'
        button.setBackgroundImage(checkInImage, forState:UIControlStateNormal, barMetrics:UIBarMetricsDefault)
        button.setBackgroundImage(checkInPressed, forState:UIControlStateHighlighted, barMetrics:UIBarMetricsDefault)
self.navigationItem.rightBarButtonItem = button 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:02:25.513

根据我的阅读，它是`barMetrics`，不是`forBarMetrics`。所以：

```
setBackgroundImage(checkInImage,
                   forState:UIControlStateNormal, barMetrics:UIBarMetricsDefault) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:22:05.313

我是 RubyMotion 的新手，但仍在努力帮助你。如果我在任何地方不正确，请原谅我。

**编辑：** 查看您的崩溃日志`Terminating app due to uncaught exception 'NoMethodError', reason: 'first_controller.rb:21:in`按钮': undefined method `setBackgroundImage' for #<UIBarButtonItem:0x6b3c1d0> (NoMethodError)`。我认为，你没有调用正确的方法来设置你的背景图像，`View controller`这就是为什么会出现这样的异常，我猜是这样。

而且我认为确切原因可能是方法。我`setBackgroundImage`想那不是正确的方法。应该是 `backgroundImage`。然后你应该在你的`ViewController`.

```
 button.backgroundImage(checkInPressed, forState:UIControlStateHighlighted, forBarMetrics:UIBarMetricsDefault). 
```

这是您的代码，只是更改了那一行。

```
 button = UIBarButtonItem.alloc.init
  button.title = 'Add'
  button.style = UIBarButtonItemStylePlain
  button.target = self
  button.action = 'performAdd'
  button.backgroundImage(checkInImage, forState:UIControlStateNormal, forBarMetrics:UIBarMetricsDefault)
  button.backgroundImage(checkInPressed, forState:UIControlStateHighlighted, forBarMetrics:UIBarMetricsDefault)
  self.navigationItem.rightBarButtonItem = button 
```

[这是相同的链接您应该查看此链接。](http://rubymotion-tutorial.com/4-containers/)

我希望你能得到一些想法..

# php - Drupal 7在节点旁边显示一个块，当节点具有具有特定值的字段时

> ID：13420331
> 
> 赞同：1
> 
> 时间：2012-11-16T16:15:44.180
> 
> 标签：php, drupal-7, drupal-webform

我试图在节点旁边显示一个块（Webform），但仅当节点具有具有特定值的字段时。

一个例子是：

*   节点是一家餐厅
*   The Block 是一个 50% 的预订表格 (Webform)
*   该块仅在餐厅的 Field_50%_Off 值等于“是”时显示

我需要的（我认为）是将 php 代码放入块可见性标准中。即仅当以下 php 代码为真时才显示此块。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T01:17:52.543

您可以使用节点引用 URL 模块并捕获提供的折扣的字段值，该字段可以从显示中隐藏，但可以传递给 Web 表单。

您还可以探索上下文和引用实体模块。

# c++ - 如何实现平台无关的异步写入文件？

> ID：13420334
> 
> 赞同：5
> 
> 时间：2012-11-16T16:15:55.147
> 
> 标签：c++, multithreading, thread-safety, boost-asio, boost-interprocess

我正在创建一个程序，该程序将从远程机器接收消息并需要将消息写入磁盘上的文件。我发现的困难在于这个程序的目的是测试接收消息的库的性能，因此，我需要确保将消息写入磁盘不会影响库的性能. 该库通过回调函数将消息传递给程序。另一个困难是解决方案必须独立于平台。

我有什么选择？

我想到了以下几点：

*   用于`boost:asio`写入文件，但似乎（请参阅[此](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/overview/posix/stream_descriptor.html)文档）异步写入文件位于该库的 Windows 特定部分中 - 因此无法使用。
*   `boost::interprocess`用于创建消息队列，但[本文档](http://www.boost.org/doc/libs/1_52_0/doc/html/interprocess/synchronization_mechanisms.html#interprocess.synchronization_mechanisms.message_queue)表明有 3 种方法可以发送消息，如果消息队列已满，所有方法都需要程序阻塞（隐式或不阻塞），我不能冒险。
*   创建一个`std::deque<MESSAGES>`从回调函数推送到双端队列，并在写入文件时弹出消息（在单独的线程上），但[不保证 STL 容器是线程安全的](https://stackoverflow.com/questions/4105930/is-using-stddeque-or-stdpriority-queue-thread-safe)。我可以锁定双端队列的推送和弹出，但我们谈论的是连续消息之间的 47 微秒，所以我想完全避免锁定。

有人对可能的解决方案有更多想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T22:14:18.107

boost::thread 与平台无关，因此您应该能够利用它创建一个线程来执行阻塞写入。为了避免每次将消息放入主线程时都需要锁定容器，您可以通过创建嵌套容器来利用双缓冲技术的修改，例如：

```
std::deque<std::deque<MESSAGES> > 
```

然后仅在准备添加充满消息的双端队列时锁定顶级双端队列。写入线程将反过来仅锁定顶级双端队列以弹出一个充满要写入的消息的双端队列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T00:25:27.830

STL 容器可能不是线程安全的，但我从未遇到过不能在不同时间在不同线程上使用的容器。将所有权传递给另一个线程似乎是安全的。

我已经使用了以下几次，所以我知道它有效：

*   创建一个指向 std::vector 的指针。
*   创建一个互斥锁来保护向量指针。
*   使用 new[] 创建一个 std::vector ，然后为它保留一个大尺寸。

在接收者线程中：

*   每当将项目添加到队列时锁定互斥锁。这应该是一个短锁。
*   添加队列项目。
*   释放锁。
*   如果您觉得它表示条件变量。我有时不这样做：这取决于设计。如果音量非常高并且接收端没有暂停，则跳过该条件并改为轮询。

在消费者线程（磁盘写入器）上：

*   通过轮询或等待条件变量来寻找工作：
*   锁定队列互斥锁。
*   查看队列长度。
*   如果队列中有工作，则将指针分配给消费者线程中的变量。
*   使用 new[] 和 reserve() 创建一个新的队列向量并将其分配给队列指针。
*   解锁互斥锁。
*   离开并将您的项目写入磁盘。
*   delete[] 已用完的队列向量。

现在，根据您的问题，您最终可能需要一种阻止方法。例如，在我的一个程序中，如果队列长度达到 100,000 个项目，则生产线程刚刚开始进行 1 秒的睡眠并抱怨很多。这是不应该发生的事情之一，但确实发生了，所以你应该考虑一下。完全没有任何限制，它只会使用机器上的所有内存，然后出现异常崩溃，被 OOM 杀死或在交换风暴中停止。

# java - 使用 SessionBean EJBObject 和 EJBHome 接口创建 EJB

> ID：13420344
> 
> 赞同：2
> 
> 时间：2012-11-16T16:16:51.380
> 
> 标签：java, ejb, ejb-3.1, openejb

我对创建 EJB 感到困惑

我在 Internet 上看到了许多 EJB 示例，以及使用 SessionBean 、 EJBObject 和 EJBHome 接口开发 EJB 的示例项目。在其他一些示例中，EJB 是在没有这些接口的情况下创建的，并且只使用一个或两个接口，例如，如果它的本地可访问，则使用 javax.ejb.Local 接口，而远程访问则使用 javax.ejb.Remote。

所以我对创建 EJB 感到困惑。这两种类型有什么区别？

我知道第一个是为远程访问实现 EJB，但另一个让我感到困惑

请帮我...！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:39:35.663

这些是在 javadoc 中看到的 pre EJB 3.0：http: [//docs.oracle.com/javaee/6/api/javax/ejb/package-summary.html](http://docs.oracle.com/javaee/6/api/javax/ejb/package-summary.html)

```
javax.ejb.EJBObject 
```

> 写入 EJB 3.0 和更高版本 API 的企业 bean 不需要扩展 EJBObject 接口的远程接口。可以改为使用远程业务接口。

```
javax.ejb.EJBHome 
```

> 写入 EJB 3.0 和更高版本 API 的企业 bean 不需要主接口。

因此，如果您现在从头开始，请专注于学习以下内容，因为它们与 ejb 3.1 相关

```
javax.ejb.Local
javax.ejb.Remote
javax.ejb.LocalBean 
```

这是解释差异的一个很好的答案：[https ://stackoverflow.com/a/10896403/1418643](https://stackoverflow.com/a/10896403/1418643)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T18:20:25.807

*EJBHome*和*EJBObject*来自旧版本的 EJB（EJB 3.0 之前）。

你可以完全忽略它们。

与旧版本相比，EJB 3.0 非常简单明了。

# python - 捕捉芹菜连接错误

> ID：13420347
> 
> 赞同：1
> 
> 时间：2012-11-16T16:17:09.943
> 
> 标签：python, redis, celery

我对 celery 和 redis 作为经纪人有疑问。一段时间后，我的芹菜工人停止工作并给我消息“消费者：连接拒绝了太多打开的文件。在 32 秒内重试”。我知道这个错误，即使它试图在 32 秒内连接到 redis，它也无法连接到它，我应该做的就是重新启动 worker。但是如何捕捉这个错误以便我可以处理它。我所能看到的只是在控制台中打印错误消息。

我正在使用 task.prerun、task.postrun 和 task.failure，但在打印错误消息期间没有人被调用。所以我认为芹菜内部正在发生一些事情。是否有某种 celery redis 侦听器，我可以在其中处理此错误并重新启动 worker。

# java - 将链表添加到链表，JAVA

> ID：13420351
> 
> 赞同：1
> 
> 时间：2012-11-16T16:17:15.067
> 
> 标签：java, linked-list

我想设计一个链表到另一个链表，到目前为止我在 MyLinkedList 类中有这个方法：

```
public void addList(int index, E e){
        if(index == 0){
            addFirst(e);
        } else if (index >= size){
            addLast(e);
        }
        else{
            Node<E> current = head;
            for(int i = 1; i < index; i++){
                current = current.next;
            }
            Node<E> temp = current.next;
            current.next = new Node<E>(e);
            (current.next).next = temp;
            size++;
        }
    } 
```

我被困在方法本身上，我的主程序有两个看起来像这样的 LinkedList：

```
MyLinkedList<String> strings1 = new MyLinkedList<String>();
        strings1.add("java");
        strings1.add("language");
        strings1.add("cooler");
        strings1.add("noob");
        System.out.println(list1);

        MyLinkedList<String> strings2 = new MyLinkedList<String>();
        strings2.add("artistic");
        strings2.add("cereal");
        strings2.add("bowl");
        System.out.println(list2); 
```

然后我想将string2的链表添加到string1的链表中。我该怎么做？我曾想过使用

```
strings1.addList(2, strings2); 
```

但它没有用，它不会让我将strings2添加到strings1我想如果我完成它的输出会是这样的：java，语言，艺术，谷物，碗，冷却器，菜鸟或类似的东西，请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:24:03.753

您的类中有一个接受单个节点的方法，只需根据第二个列表的需要多次调用它：

例如

```
void addAll(int index, MyList<> second_list)
{
  for(Object o : second_list)
  {
    addList(index, o);
    ++index;
  }
} 
```

除非您的类实现了正确的接口，否则上述基于范围的 for 循环可能不起作用，我很懒 - 使用您的类支持的正常迭代......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:18:58.993

使用 方法`addAll(int index, Collection c)`将两个列表相加。

```
strings1.addAll(startIndex, strings2); 
```

您还必须为您的 MyLinkedList 类实现 List 接口。您的 MyLinkedList 类的外观也不是很清楚？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:27:43.597

最简单的方法......

```
public void insertList(int index, List<String> list) {
    Collections.reverse(list);
    for (String str : list) {
        add(index, str);
    }
} 
```

# c# - 无法连接到服务器的 SMTP 端口

> ID：13420355
> 
> 赞同：0
> 
> 时间：2012-11-16T16:17:24.887
> 
> 标签：c#, asp.net, email, smtp

我有以下代码，我正在尝试发送电子邮件。我正在使用另一台服务器作为 SMPTClient。

```
MailMessage message = new MailMessage();
message.To.Add(toEmailId);
message.Subject = "test Subject";
message.From = new System.Net.Mail.MailAddress("myid@xyz.com");
message.Body = "This is a system generated email. Please do not reply";
SmtpClient smtp = new SmtpClient("anotherservername"); 
smtp.Send(message); 
```

在调试时，我在最后一行得到错误。错误是：

```
An attempt was made to access a socket in a way forbidden by its access permissions SERVER IP :25 
```

我从互联网上发现我的防火墙可能阻止我访问该服务器的端口，或者是否有任何我错过的设置、配置。显然，部署在该服务器上的应用程序能够发送电子邮件。我还在建造一个来测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:01:54.150

某些服务器通过在连接到 SMTP 之前检查您是否已连接到 POP 服务器来执行身份验证和授权。您应该先尝试使用 POP 连接和验证，然后再连接到 SMTP。

从历史上看，电子邮件客户端首先检查然后在 Send&Receive 例程中发送电子邮件，因此这被用作差人授权。[**查看有关SMTP before POP**](http://en.wikipedia.org/wiki/POP_before_SMTP)[的维基百科文章](http://en.wikipedia.org/wiki/POP_before_SMTP)**。**

 *** * *

[对某些人](http://social.msdn.microsoft.com/Forums/en-US/ncl/thread/573f98e3-67cb-4e2b-9d5e-6b815b5ed230)来说造成这种情况的另一个问题是如何将服务器地址提供给[`SmtpClient`](http://msdn.microsoft.com/en-us/library/k0y6s613.aspx). 您应该使用明确提供端口号的构造函数，而不是将其附加到 IP/主机名。IE

代替 `new SmtpClient("123.123.123.123:25")`

利用 `new SmtpClient("123.123.123.123", 25)`**

# php - 把逗号放在alexa排名中

> ID：13420356
> 
> 赞同：2
> 
> 时间：2012-11-16T16:17:28.093
> 
> 标签：php

我有 alexa 函数并返回 alexa 排名。我想在每三位数字中加上逗号。

例如：1,500,500

我曾尝试使用 number_format() 但它不适用于我。这是功能

```
<?php
/**
 * Get Popularity Text of a Domain via Alexa XML Data
 *
 * @return string|FALSE text or FALSE on error
 */
function alexa_get_rank($domain)
{
    $alexa = "http://data.alexa.com/data?cli=10&dat=s&url=%s";
    $request_url =  sprintf($alexa, urlencode($domain));

    $xml = simplexml_load_file($request_url);
    if (!$xml) {
        return FALSE;
    }

    $nodeAttributes = $xml->SD[1]->POPULARITY->attributes();
    $text = (int) $nodeAttributes['TEXT'];

    $num = number_format($text);

    return $num;
} 
```

这只返回 3 个数字

例如：排名是 1,500,500，但它只显示 500。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:37:19.047

快速而肮脏的答案：尝试定义数字格式的所有参数，因为我知道它应该起作用。最后，如果 nothign else 有效，您不需要使用正则表达式，只需使用您的号码的字符串版本：

```
function addCommas($number) {
    return strrev(join(",",str_split(strrev($number),3)));
} 
```

在键盘上进行简短的测试后，我可以向您保证，您的代码应该按原样工作，在[http://codepad.org/0zLuBQp8](http://codepad.org/0zLuBQp8) ，您会发现一个稍作修改的演示（我已通过查询检索数据并粘贴了 xml作为字符串来规避一些键盘限制）。

（我建议您将 xml 加载阶段一分为二，以检查您的输入是否正常并且您正在操作正确的数据）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-16T16:21:18.887

你总是可以运行一个简单的 while 语句::

```
$text = (int) $nodeAttributes['TEXT'];
while (true){
    $num = preg_replace('/(-?\d+)(\d\d\d)/', '$1,$2', $text );
    if ($num != $text ) {
        $text = $num;
    } else {
        break;
    }
}
return $num; 
```

# python - 获得两个列表差异的更好方法是什么？

> ID：13420363
> 
> 赞同：0
> 
> 时间：2012-11-16T16:17:49.310
> 
> 标签：python

每次生成新文件时，都会在一个目录中生成一些日志文件。

我的目的是获取 10 分钟内生成的大量文件。要实时获得这样的值。数据如下：

```
00:00 ~ 00:10        10 files

00:10 ~ 00:20        23 files

...

23:50 ~ 23:59        12 files 
```

所以我的想法是在 Linux 系统上通过 crontab 任务每 10 分钟运行一次统计脚本。逻辑第一次运行脚本：通过 . 获取当前文件列表`glob.glob("*")`。

让我说A，所以当脚本下次运行时（10分钟后），它将`glob`再次运行以获取当前文件列表B。我需要B中的不同值。没有A。所以我可以获得数量。怎么做？如果你有其他好的方法，请分享。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:31:51.023

你想看看[set](http://docs.python.org/2/library/stdtypes.html#set)。您可以执行以下操作：

```
setA = set(listA)
setB = set(listB)
new_list = list(setB - setA) 
```

您还可以执行其他设置逻辑来识别已删除的文件等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:58:19.313

正如我对@tcaswell 的[回答](https://stackoverflow.com/a/13420585/355230)所评论的那样，使用 Python 的内置 set 类是解决此类问题的绝佳方法。下面是一些基于 Tim Golden 的 Python Stuff 文章[*Watch a Directory for Changes*](http://timgolden.me.uk/python/win32_how_do_i/watch_directory_for_changes.html)的示例代码：

```
import os

firstime = False
path_to_watch = '.'

try:
    with open('filelist.txt', 'rt') as filelist:
        before = set(line.strip() for line in filelist)
except IOError:
    before = set(os.listdir(path_to_watch))
    firstime = True

if firstime:
    after = before
else:
    after = set(os.listdir(path_to_watch))
    added = after-before
    removed = before-after
    if added:
        print 'Added: ', ', '.join(added)
    if removed:
        print 'Removed: ', ', '.join(removed)

# replace/create filelist
with open('filelist.txt', 'wt') as filelist:
    filelist.write('\n'.join(after) + '\n') 
```

# wix - Wix 安装许可证接受文本在 XP 上换行

> ID：13420389
> 
> 赞同：-1
> 
> 时间：2012-11-16T16:19:19.507
> 
> 标签：wix, wix3.6

我有一个 WIX 3.6 捆绑包设置。在许可对话框中，带有“我同意许可条款和条件”的复选框被包裹，当在 XP 上运行安装时，顶部和底部的截断，但在 Vist、Win 7 和 8 中，文本没有被包裹. 我正在使用 Mondo 对话框。

无论如何我可以调整复选框文本的大小使其不换行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:13:56.057

是的，但它并不完全直截了当。

首先，您必须从 wix 源获取 RtfTheme.xml 的副本。将其复制到单独的主题 ml 中将允许您在安装程序页面上重新定位元素。

（您可以在此处找到原始文件：[源文件夹]\src\ext\BalExtension\wixstdba\Resources）

编辑复选框的 X 位置会将其移动到您需要的位置。

```
<Checkbox Name="EulaAcceptCheckbox" X="11" Y="-41" Width="260" Height="17"
    TabStop="yes" FontId="3" HideWhenDisabled="yes">
    #(loc.InstallAcceptCheckbox)
</Checkbox> 
```

您还必须添加`WixBalExtension`到您的命名空间

```
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
  xmlns:bal="http://schemas.microsoft.com/wix/BalExtension"> 
```

`BootstrapperApplicationRef`并在标签中添加对您的主题文件的引用

```
<BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.RtfLicense">
  <bal:WixStandardBootstrapperApplication 
    ThemeFile="path/to/mytheme.xml" />
      ...
</BootstrapperApplicationRef> 
```

# jquery - jQuery隐藏/取消隐藏切换图像

> ID：13420390
> 
> 赞同：0
> 
> 时间：2012-11-16T16:19:20.613
> 
> 标签：jquery, toggle

我有通过单击一个小箭头来显示和隐藏的 div。单击时可以展开更多信息的日历条目。到目前为止，一切都很好。

我希望我使用的小箭头能够取消隐藏内容以从“向上”状态变为“向下”状态，或者在内容可见时更好地旋转 180 度。

```
 jQuery('.openheader').click(function() {
    jQuery(this).parent().next().toggle('slow');
    return false;
}).parent().next().hide(); 
```

.openheader 类应用于箭头图像周围的链接。

当我在它的时候 - 如果 .calendarhidden DIV（包含额外信息的 div）中没有内容，一个不错的功能也将能够隐藏相应的链接或图像。

有任何想法吗？无法理解如何将其合并到切换动作中。谢谢*编辑：这里是 js 小提琴：http: [//jsfiddle.net/marknolan/gtEdy/](http://jsfiddle.net/marknolan/gtEdy/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:25:42.780

我相信你可以这样做`if (document.getElementById(event.target.id).src.indexOf('right.png') > 0) { document.getElementById(event.target.id).src = 'path/arrow_left.png'; } else { document.getElementById(event.target.id).src = 'path/arrow_right.png'; }`

**编辑**应该说这需要函数（事件）

# regex - 为什么这个使用lookbehinds的正则表达式在R中无效？

> ID：13420391
> 
> 赞同：21
> 
> 时间：2012-11-16T16:19:22.870
> 
> 标签：regex, r

我正在尝试在 R 中做一个后向正则表达式来找到一个模式。我希望这会在'bob'中拉出'b'，但我得到了一个错误。

```
> regexpr("(?<=a)b","thingamabob")
Error in regexpr("(?<=a)b", "thingamabob") : 
invalid regular expression '(?<=a)b', reason 'Invalid regexp' 
```

这不会引发错误，但它也找不到任何东西。

```
> regexpr("(.<=a)b","thingamabob")
[1] -1
attr(,"match.length")
[1] -1
attr(,"useBytes")
[1] TRUE 
```

我很困惑，因为 regexpr 的帮助页面特别指出后向应该可以工作：[http ://stat.ethz.ch/R-manual/R-patched/library/base/html/regex.html](http://stat.ethz.ch/R-manual/R-patched/library/base/html/regex.html)

有任何想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-16T16:30:49.387

您只需要通过设置切换到 PERL 正则表达式`perl = TRUE`。

# android - 安装时查看日志

> ID：13420392
> 
> 赞同：0
> 
> 时间：2012-11-16T16:19:31.077
> 
> 标签：android, logging

我想在安装 gmy Android 应用程序时查看日志记录，因为我想查看在安装期间安装了哪些提供程序。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:32:14.447

Logcat 将是你最好的朋友......要详细了解它的一切，请查看这篇文章 [http://forums.androidcentral.com/general-help-how/141073-learn-logcat-like-pro.html](http://forums.androidcentral.com/general-help-how/141073-learn-logcat-like-pro.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:33:06.927

只需查看 android 文档[LogCat Link](http://developer.android.com/reference/android/util/Log.html)

在 eclipse 中打开 logcat 窗口的步骤：

第一步：在eclipse的菜单栏中选择Window options。

第 2 步：转到显示视图选项

第 3 步：选择其他菜单

第 4 步：在其中选择 Android-> Logcat。

它将打开一个窗口，您可以看到应用程序的堆栈跟踪

# android - 禁止用户切换飞行模式

> ID：13420396
> 
> 赞同：0
> 
> 时间：2012-11-16T16:19:36.933
> 
> 标签：android

我不知道这是否可以做到，但是我希望我的应用程序能够打开/关闭飞行模式。好的，这很简单。但是在关闭它时，用户应该无法通过进入 android 设置来打开它。这应该被禁用。只有应用程序才能恢复更改。或者至少直到应用程序关闭。任何想法 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T17:19:47.163

请注意，从 Android 4.2（Jelly Bean 主要版本 1）开始，无法再打开/关闭飞行模式。查看此链接[Android 4.2](http://developer.android.com/about/versions/android-4.2.html)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:45:36.000

> 我希望我的应用打开/关闭飞行模式。

请注意，从 Android 4.2 开始，这不再可能。

> 但是在关闭它时，用户应该无法通过进入 android 设置来打开它。

将源代码下载到 Android，进行所需的更改，编译修改后的操作系统并将其倒入 ROM 模块中，然后在任何 Android 设备上安装该 ROM 模块。

IOW，您不能从 SDK 应用程序执行此操作。

# perl - 在 perl 中，使用必需的命令将参数传递给脚本

> ID：13420398
> 
> 赞同：0
> 
> 时间：2012-11-16T16:19:45.013
> 
> 标签：perl

我有两个文件 tmp.pl 和 tmp2.pl。我想用 require 命令调用 tmp2.pl 但也发送一个参数。有没有更好的方法来做到这一点？

tmp.pl

```
require "tmp2.pl" "passed parameter"; 
```

tmp2.pl

```
print @_; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T16:31:12.210

据我所知，`require`不能用于发送参数。但这是一件好事，我认为，因为我想不出你应该这样做的理由。在我看来，你的设计是错误的。

`tmp2.pl`应该是：

*   一个独立的 perl 程序，你应该运行它`system`或`qx()`
*   一个模块，带有可选的导出标签等。
*   定义类的包

但这只是我的想法....

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T21:54:10.287

可能有更好的方法来完成您想要做的任何事情，但是您可以通过类似的方式实现当前的子目标

```
{
    local @_ = ("passed parameter");
    require "tmp2.pl";
} 
```

在我想从 perl 脚本中运行 perl 脚本的地方，我可能会考虑这个习惯用法。也就是说，我可以说

```
{
    local @ARGV = ("foo","bar");
    require "my_script.pl";
} 
```

代替

```
system("perl","my_script.pl","foo","bar"); 
```

（这两个调用之间有很多微妙和不那么微妙的区别，所以很大程度上取决于您需要这些调用的哪些“功能”）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T06:10:41.473

是的，我认为这应该有效。使用“require”来包含脚本。之后，您可以通过调用子函数来传递参数。修改后的脚本可以

> `require "tmp2.pl" ;`
> `subfunc(parameter);`
> `print @_;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T04:53:48.220

假设您要执行其他程序并捕获其输出，我偏爱使用 IPC::Run 模块。

```
#!/usr/bin/perl

use strict;
use warnings;
use IPC::Run qw( run );

run( [ './tmp2.pl', @ARGV ], \'', \my $out, \my $err );

print "out: $out\n";
print "err: $err\n"; 
```

# css - 图像以黑色显示 - CSS

> ID：13420402
> 
> 赞同：0
> 
> 时间：2012-11-16T16:19:59.503
> 
> 标签：css, image, button

我有一张有时显示正常的图像，但有时它只是显示为黑色：

的HTML：

```
 <button class="myImage">
    <?php echo _('My image') ?>
 </button> 
```

CSS：

```
.myImage { 
    background: url("../img/myImage.png") no-repeat;
} 
```

我认为问题来自分配给按钮标签的背景。但是我无法更改按钮标签，所以我该如何规避呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:22:52.743

为什么不为您使用的所有按钮设置默认背景，这样如果图像失败，它就不会闪烁黑色？

```
button { background: transparent; } /* Or some solid color that's not black */ 
```

# python - 模仿 fileno() 的行为并选择

> ID：13420405
> 
> 赞同：1
> 
> 时间：2012-11-16T16:20:02.330
> 
> 标签：python, file, networking

我正在尝试编写一个与 Python 2 标准库的`socket.socket`.

当程序尝试调用对象时，我在尝试重现对象应具有的行为时遇到问题`select.select()`。
条目中的文档`select.select`说：

> 你也可以自己定义一个包装类，只要它有一个适当的 fileno() 方法（它真的返回一个文件描述符，而不仅仅是一个随机整数）。

我想尝试这样的事情：创建一个类似文件的对象，该对象可以由我的程序的一个线程使用 select 控制，而当我的对象准备好读写时，我的程序的另一个线程可以设置它。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:30:27.327

fileno() 函数需要返回一个内核文件描述符，以便可以将其传递给 select 系统调用（或 poll/epoll/whatever）。由 select-like 操作完成的多路复用基本上是一个必须在 OS 对象上工作的 OS 操作。

如果要为不基于实际文件描述符的对象实现此功能，可以执行以下操作：

*   创建管道
*   从 fileno() 返回管道的读取端
*   当您想将对象标记为“就绪”时，向另一端写入一个字节。这将唤醒任何选择调用。
*   请记住从您真正的“读取”实现中读取该字节。

这个管道技巧应该是相当便携的。

# c++ - C++ OpenGL线框立方体渲染空白

> ID：13420407
> 
> 赞同：5
> 
> 时间：2012-11-16T16:20:10.060
> 
> 标签：c++, opengl, pointers, glew, glfw

我只是想画一堆组成“立方体”的线条。我一生都无法弄清楚为什么会产生黑屏。调试器不会在任何时候中断。

我确信这是我的指针的问题，因为我只在常规 c++ 中表现得很好，而在 OpenGL 中它变得更糟。

```
const char* vertexSource = 
    "#version 150\n"
    "in vec3 position;"
    "void main() {"
    "   gl_Position = vec4(position, 1.0);"
    "}";

const char* fragmentSource = 
    "#version 150\n"
    "out vec4 outColor;"
    "void main() {"
    "   outColor = vec4(1.0, 1.0, 1.0, 1.0);"
    "}";

int main() {

    initializeGLFW();

    // Initialize GLEW
    glewExperimental = GL_TRUE;
    glewInit();

    // Create Vertex Array Object
    GLuint vao;
    glGenVertexArrays(1, &vao);
    glBindVertexArray(vao);

    // Create a Vertex Buffer Object and copy the vertex data to it
    GLuint vbo;
    glGenBuffers( 1, &vbo );

    float vertices[] = {
         1.0f,  1.0f,  1.0f, // Vertex 0 (X, Y, Z)
        -1.0f,  1.0f,  1.0f, // Vertex 1 (X, Y, Z)
        -1.0f, -1.0f,  1.0f, // Vertex 2 (X, Y, Z)
         1.0f, -1.0f,  1.0f, // Vertex 3 (X, Y, Z)
         1.0f,  1.0f, -1.0f, // Vertex 4 (X, Y, Z)
        -1.0f,  1.0f, -1.0f, // Vertex 5 (X, Y, Z)
        -1.0f, -1.0f, -1.0f, // Vertex 6 (X, Y, Z)
         1.0f, -1.0f, -1.0f  // Vertex 7 (X, Y, Z)
    };

    GLuint indices[] = {
        0, 1,
        1, 2,
        2, 3,
        3, 0,
        4, 5,
        5, 6,
        6, 7,
        7, 4,
        0, 4,
        1, 5,
        2, 6,
        3, 7
    };

    glBindBuffer( GL_ARRAY_BUFFER, vbo );
    glBufferData( GL_ARRAY_BUFFER, sizeof( vertices ), vertices, GL_STATIC_DRAW );
    //glBindBuffer( GL_ELEMENT_ARRAY_BUFFER, vbo);
    //glBufferData( GL_ELEMENT_ARRAY_BUFFER, sizeof( indices ), indices, GL_STATIC_DRAW );

    // Create and compile the vertex shader
    GLuint vertexShader = glCreateShader( GL_VERTEX_SHADER );
    glShaderSource( vertexShader, 1, &vertexSource, NULL );
    glCompileShader( vertexShader );

    // Create and compile the fragment shader
    GLuint fragmentShader = glCreateShader( GL_FRAGMENT_SHADER );
    glShaderSource( fragmentShader, 1, &fragmentSource, NULL );
    glCompileShader( fragmentShader );

    // Link the vertex and fragment shader into a shader program
    GLuint shaderProgram = glCreateProgram();
    glAttachShader( shaderProgram, vertexShader );
    glAttachShader( shaderProgram, fragmentShader );
    glBindFragDataLocation( shaderProgram, 0, "outColor" );
    glLinkProgram (shaderProgram);
    glUseProgram( shaderProgram);

    // Specify the layout of the vertex data
    GLint posAttrib = glGetAttribLocation( shaderProgram, "position" );
    glEnableVertexAttribArray( posAttrib );
    glVertexAttribPointer( posAttrib, 3, GL_FLOAT, GL_FALSE, 0, 0 );

    // Main loop
    while(glfwGetWindowParam(GLFW_OPENED)) {

        // Clear the screen to black
        glClearColor( 0.0f, 0.0f, 0.0f, 1.0f );
        glClear( GL_COLOR_BUFFER_BIT );

        // Draw lines from 2 vertices
        glDrawElements(GL_LINES, sizeof(indices), GL_UNSIGNED_INT, indices );

        // Swap buffers
        glfwSwapBuffers();
    }

    // Clean up
    glDeleteProgram( shaderProgram );
    glDeleteShader( fragmentShader );
    glDeleteShader( vertexShader );

    //glDeleteBuffers( 1, &ebo );
    glDeleteBuffers( 1, &vbo );

    glDeleteVertexArrays( 1, &vao );

    glfwTerminate();
    exit( EXIT_SUCCESS );
} 
```

编辑：尝试第一个答案的建议的完整代码。还是空白。

```
#define GLEW_STATIC

#include <GL/glew.h>
#include <GL/glfw.h>
#include <iostream>

#pragma comment( lib, "glfw.lib")
#pragma comment( lib, "opengl32.lib")
#pragma comment( lib, "glew32s.lib")

const char* vertexSource = 
    "#version 150\n"
    "in vec3 position;"
    "void main() {"
    "   gl_Position = vec4(position.x, position.y, position.z - 0.9, 1.0);"
    "}";

const char* fragmentSource = 
    "#version 150\n"
    "out vec4 outColor;"
    "void main() {"
    "   outColor = vec4(1.0, 1.0, 1.0, 1.0);"
    "}";

void initializeGLFW();

int main() {

    initializeGLFW();

    // Initialize GLEW
    glewExperimental = GL_TRUE;
    glewInit();

    // Create Vertex Array Object
    GLuint vao;
    glGenVertexArrays(1, &vao);
    glBindVertexArray(vao);

    // Create a Vertex Buffer Object and copy the vertex data to it
    GLuint vbo;
    glGenBuffers( 1, &vbo );

    float vertices[] = {
         1.0f,  1.0f,  1.0f, // Vertex 0 (X, Y, Z)
        -1.0f,  1.0f,  1.0f, // Vertex 1 (X, Y, Z)
        -1.0f, -1.0f,  1.0f, // Vertex 2 (X, Y, Z)
         1.0f, -1.0f,  1.0f, // Vertex 3 (X, Y, Z)
         1.0f,  1.0f, -1.0f, // Vertex 4 (X, Y, Z)
        -1.0f,  1.0f, -1.0f, // Vertex 5 (X, Y, Z)
        -1.0f, -1.0f, -1.0f, // Vertex 6 (X, Y, Z)
         1.0f, -1.0f, -1.0f  // Vertex 7 (X, Y, Z)
    };

    size_t vertCount = sizeof( vertices ) / sizeof( float );
    for( size_t i = 0; i < vertCount; ++i ) {
        vertices[i] /= 2.0f;
    }

    GLubyte indices[] = {
        0, 1,
        1, 2,
        2, 3,
        3, 0,
        4, 5,
        5, 6,
        6, 7,
        7, 4,
        0, 4,
        1, 5,
        2, 6,
        3, 7
    };

    glBindBuffer( GL_ARRAY_BUFFER, vbo );
    //glBindBuffer( GL_ELEMENT_ARRAY_BUFFER, vbo);
    glBufferData( GL_ARRAY_BUFFER, sizeof( vertices ), vertices, GL_STATIC_DRAW );

    // Create and compile the vertex shader
    GLuint vertexShader = glCreateShader( GL_VERTEX_SHADER );
    glShaderSource( vertexShader, 1, &vertexSource, NULL );
    glCompileShader( vertexShader );

    // Create and compile the fragment shader
    GLuint fragmentShader = glCreateShader( GL_FRAGMENT_SHADER );
    glShaderSource( fragmentShader, 1, &fragmentSource, NULL );
    glCompileShader( fragmentShader );

    // Link the vertex and fragment shader into a shader program
    GLuint shaderProgram = glCreateProgram();
    glAttachShader( shaderProgram, vertexShader );
    glAttachShader( shaderProgram, fragmentShader );
    glBindFragDataLocation( shaderProgram, 0, "outColor" );
    glLinkProgram (shaderProgram);
    glUseProgram( shaderProgram);

    // Specify the layout of the vertex data
    GLint posAttrib = glGetAttribLocation( shaderProgram, "position" );
    glEnableVertexAttribArray( posAttrib );
    glVertexAttribPointer( posAttrib, 3, GL_FLOAT, GL_FALSE, 0, vertices );

    // Main loop
    while(glfwGetWindowParam(GLFW_OPENED)) {

        // Clear the screen to black
        glClearColor( 0.0f, 0.0f, 0.0f, 1.0f );
        glClear( GL_COLOR_BUFFER_BIT );

        // Draw lines from 2 vertices
        glDrawElements(GL_LINES, 24, GL_UNSIGNED_BYTE, indices);

        // Swap buffers
        glfwSwapBuffers();
    }

    // Clean up
    glDeleteProgram( shaderProgram );
    glDeleteShader( fragmentShader );
    glDeleteShader( vertexShader );

    //glDeleteBuffers( 1, &ebo );
    glDeleteBuffers( 1, &vbo );

    glDeleteVertexArrays( 1, &vao );

    glfwTerminate();
    exit( EXIT_SUCCESS );
}

void initializeGLFW() {
    glfwInit();
    glfwOpenWindowHint( GLFW_OPENGL_VERSION_MAJOR, 3 );
    glfwOpenWindowHint( GLFW_OPENGL_VERSION_MINOR, 2 );
    glfwOpenWindowHint( GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE );

    glfwOpenWindowHint( GLFW_WINDOW_NO_RESIZE, GL_TRUE );
    glfwOpenWindow( 800, 600, 0, 0, 0, 0, 0, 0, GLFW_WINDOW );
    glfwSetWindowTitle( "OpenGL" );
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T17:03:29.777

“默认”投影本质 `glOrtho(-1, 1, -1, 1, -1, 1)`上是相机`(0,0,0)`向下看 -Z 轴。

将相机向后移动：

```
const char* vertexSource = 
    "#version 150\n"
    "in vec3 position;"
    "void main() {"
    "   gl_Position = vec4(position.x, position.y, position.z - 0.9, 1.0);"
    "}"; 
```

并使您的对象更小：

```
float vertices[] = {
     1.0f,  1.0f,  1.0f, // Vertex 0 (X, Y, Z)
    -1.0f,  1.0f,  1.0f, // Vertex 1 (X, Y, Z)
    -1.0f, -1.0f,  1.0f, // Vertex 2 (X, Y, Z)
     1.0f, -1.0f,  1.0f, // Vertex 3 (X, Y, Z)
     1.0f,  1.0f, -1.0f, // Vertex 4 (X, Y, Z)
    -1.0f,  1.0f, -1.0f, // Vertex 5 (X, Y, Z)
    -1.0f, -1.0f, -1.0f, // Vertex 6 (X, Y, Z)
     1.0f, -1.0f, -1.0f  // Vertex 7 (X, Y, Z)
};

size_t vertCount = sizeof( vertices ) / sizeof( float );
for( size_t i = 0; i < vertCount; ++i )
{
    vertices[i] /= 2.0f;
} 
```

[![信封](../Images/c1a20ccca4f87c9f359c2374c2917835.png)](https://i.stack.imgur.com/CjWPr.png)

完全的：

```
#include <GL/glew.h>
#include <GL/glfw.h>
#include <cstdlib>

const char* vertexSource = 
    "#version 150\n"
    "in vec3 position;"
    "void main() {"
    "   gl_Position = vec4(position.x, position.y, position.z - 0.9, 1.0);"
    "}";

const char* fragmentSource = 
    "#version 150\n"
    "out vec4 outColor;"
    "void main() {"
    "   outColor = vec4(1.0, 1.0, 1.0, 1.0);"
    "}";

void initializeGLFW() 
{
    glfwInit();
    glfwOpenWindowHint( GLFW_OPENGL_VERSION_MAJOR, 3 );
    glfwOpenWindowHint( GLFW_OPENGL_VERSION_MINOR, 2 );
    glfwOpenWindowHint( GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE );

    glfwOpenWindowHint( GLFW_WINDOW_NO_RESIZE, GL_TRUE );
    glfwOpenWindow( 800, 600, 0, 0, 0, 0, 0, 0, GLFW_WINDOW );
    glfwSetWindowTitle( "OpenGL" );
}

int main()
{
    initializeGLFW();

    // Initialize GLEW
    glewExperimental = GL_TRUE;
    glewInit();

    // Create Vertex Array Object
    GLuint vao;
    glGenVertexArrays(1, &vao);
    glBindVertexArray(vao);

    // Create a Vertex Buffer Object and copy the vertex data to it
    GLuint vbo;
    glGenBuffers( 1, &vbo );

    float vertices[] = 
    {
         1.0f,  1.0f,  1.0f, // Vertex 0 (X, Y, Z)
        -1.0f,  1.0f,  1.0f, // Vertex 1 (X, Y, Z)
        -1.0f, -1.0f,  1.0f, // Vertex 2 (X, Y, Z)
         1.0f, -1.0f,  1.0f, // Vertex 3 (X, Y, Z)
         1.0f,  1.0f, -1.0f, // Vertex 4 (X, Y, Z)
        -1.0f,  1.0f, -1.0f, // Vertex 5 (X, Y, Z)
        -1.0f, -1.0f, -1.0f, // Vertex 6 (X, Y, Z)
         1.0f, -1.0f, -1.0f  // Vertex 7 (X, Y, Z)
    };

    size_t vertCount = sizeof( vertices ) / sizeof( float );
    for( size_t i = 0; i < vertCount; ++i )
    {
        vertices[i] /= 2.0f;
    }

    GLuint indices[] = 
    {
        0, 1,
        1, 2,
        2, 3,
        3, 0,
        4, 5,
        5, 6,
        6, 7,
        7, 4,
        0, 4,
        1, 5,
        2, 6,
        3, 7
    };

    glBindBuffer( GL_ARRAY_BUFFER, vbo );
    glBufferData( GL_ARRAY_BUFFER, sizeof( vertices ), vertices, GL_STATIC_DRAW );

    // Create and compile the vertex shader
    GLuint vertexShader = glCreateShader( GL_VERTEX_SHADER );
    glShaderSource( vertexShader, 1, &vertexSource, NULL );
    glCompileShader( vertexShader );

    // Create and compile the fragment shader
    GLuint fragmentShader = glCreateShader( GL_FRAGMENT_SHADER );
    glShaderSource( fragmentShader, 1, &fragmentSource, NULL );
    glCompileShader( fragmentShader );

    // Link the vertex and fragment shader into a shader program
    GLuint shaderProgram = glCreateProgram();
    glAttachShader( shaderProgram, vertexShader );
    glAttachShader( shaderProgram, fragmentShader );
    glBindFragDataLocation( shaderProgram, 0, "outColor" );
    glLinkProgram (shaderProgram);
    glUseProgram( shaderProgram);

    // Specify the layout of the vertex data
    GLint posAttrib = glGetAttribLocation( shaderProgram, "position" );
    glEnableVertexAttribArray( posAttrib );
    glVertexAttribPointer( posAttrib, 3, GL_FLOAT, GL_FALSE, 0, 0 );

    // Main loop
    while(glfwGetWindowParam(GLFW_OPENED)) 
    {
        // Clear the screen to black
        glClearColor( 0.0f, 0.0f, 0.0f, 1.0f );
        glClear( GL_COLOR_BUFFER_BIT );

        // Draw lines from 2 vertices
        glDrawElements(GL_LINES, sizeof(indices), GL_UNSIGNED_INT, indices );

        // Swap buffers
        glfwSwapBuffers();
    }

    // Clean up
    glDeleteProgram( shaderProgram );
    glDeleteShader( fragmentShader );
    glDeleteShader( vertexShader );

    //glDeleteBuffers( 1, &ebo );
    glDeleteBuffers( 1, &vbo );

    glDeleteVertexArrays( 1, &vao );

    glfwTerminate();
    exit( EXIT_SUCCESS );
} 
```

# jquery - Jquery Ajax重定向不起作用

> ID：13420409
> 
> 赞同：0
> 
> 时间：2012-11-16T16:20:16.247
> 
> 标签：jquery, ajax, redirect

我有几个问题需要帮助。首先，我希望以下重定向起作用。但是浏览器不会重定向。这是我的jsp的全部内容

```
function testAjax(){
alert("In test Ajax");
$.ajax({
    type: "GET",
    url: "http://xyz.com/",
    data:   "param1=value1" +
        "&target=http://abc.com"
    ,
    success: function(data, textStatus, xhr) {
            alert("Success ");
            window.location.href = "http://abc.com";
    },
    error: function(data) {
        alert("Success");
    },
    async: false
}); 
```

}

参数 target 基本上指向 xyz.com，因此当该服务器进行重定向时，它会重定向到目标中的任何内容。但是，当我调用这个javascript（通过点击jsp）时，浏览器不会重定向。我尝试使用开发人员工具在 Firefox 上进行调试，我看到对 xyz 的 GET 请求返回带有位置标头的 302。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:29:18.543

你确定你得到了一个成功的响应 - 如果你看到一个提示“成功”的警报，你可能实际上并不好，因为你有成功和错误：

```
success: function(data, textStatus, xhr) {
        alert("Success ");
        window.location.href = "http://example.com";
},
error: function(data) {
    alert("Success");
}, 
```

我推荐更多类似的东西：

```
error: function(jqXHR, textStatus, errorThrown) {
    alert("Fail " + textStatus + " - " + errorThrown);
}, 
```

这可能会为您指明正确的方向，因为我相信如果您取得了真正的成功，地点将会改变。

我对这个错误的猜测是您正试图对另一个域进行 AJAX 调用，这将被浏览器安全性阻止。您需要使用 JSONP 或 CORS 来发出跨域请求。

# c++ - 无法将 std::string::c_str 从 'const char *' 转换为 'char *'

> ID：13420410
> 
> 赞同：3
> 
> 时间：2012-11-16T16:20:18.577
> 
> 标签：c++

这给出了错误：无法从 'const char *' 转换为 'char *'。

```
class Mock
{
public:
    ...
    static void func(char **result)
    {
          *result = (resultsI++)->c_str();
    }
static std::vector<std::string> results;
static std::vector<std::string>::iterator resultsI;
};

std::vector<std::string> Mock::results;
std::vector<std::string>::iterator Mock::resultsI; 
```

如何在不更改函数 func 的接口的情况下有效地消除此错误？该接口的实现者：

```
void (func*)(char **result) 
```

忘记在签名中使用 const char**。我无法改变它。

请记住，这是一个模拟，我只在我的单元测试中使用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T16:25:05.690

尝试：

```
*result = &(*resultsI++)[0]; 
```

尽管这不能保证在 C++11 之前可以正常工作，但已知在大多数或所有当前编译器上都可以。

危险在于，如果函数试图更改字符串的长度，您可能会遇到一些令人讨厌的错误。更改单个字符应该没问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-16T16:24:54.770

如果您绝对确定接口函数不会修改字符串，则可以使用

```
*result = const_cast<char *>((resultsI++)->c_str()); 
```

去除`const`ness。

否则，另一种选择是从使用切换`std::vector<std::string>`到，`std::vector<std::vector<char>>`但是您必须确保正确地为空终止字符串。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-16T16:24:15.220

在测试代​​码中，如果您*确定*界面的用户不会改变 char*，也许您可​​以使用`const_cast`?

假设调用者不拥有`char *`; 如果是这种情况，那么您应该制作一份副本。

# python - 找不到使用 pip 安装的软件包

> ID：13420413
> 
> 赞同：4
> 
> 时间：2012-11-16T16:20:35.377
> 
> 标签：python, pip

我正在使用 Mac OS X 10.6.8 和 python 2.7.3。我正在尝试使用 pip 安装 ipython，并且运行 sudo pip install ipython 安装成功，但是当我尝试运行 ipython 时，我得到“找不到命令”。我找不到 pip 安装包的位置，或者为什么它没有正确链接。我对此很陌生，请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-01-26T16:50:59.197

我遇到了这个问题并通过重新启动我的终端来解决它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-16T16:33:18.633

对我来说，在 OS X 10.5 上，Python 的默认安装是软链接的`/Library/Frameworks/Python.framework/Versions/Current/`，而 ipython 是在`/Library/Frameworks/Python.framework/Versions/Current/bin/ipython`. 确保`bin`它所在的目录在你的 shell 中`PATH`。类型：

`$ export PATH=/Library/Frameworks/Python.framework/Versions/Current/bin:$PATH`

，然后尝试运行 ipython。如果可行，请编辑您的以永久`~/.profile`更新您的。`PATH`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-05-20T00:10:31.870

我通过使用 sudo 解决了这个问题。sudo 将在系统文件夹中安装 ipython。

pip 卸载 ipython

然后

须藤 pip 安装 ipython

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-24T12:53:51.817

与acjay类似，对我来说，使用过：

```
/Library/Frameworks/Python.framework/Versions/Current/lib/python2.7/site-packages/
```

添加到路径（10.12 Sierra）。

# actionscript-3 - Flex 4.6 Mobile - TextArea 和 TextInput 皮肤问题

> ID：13420415
> 
> 赞同：0
> 
> 时间：2012-11-16T16:20:46.027
> 
> 标签：actionscript-3, apache-flex, textarea, flex4.6

这适用于 AIR 3.1 上的 Flex 4.6。我在 AIR 3.5 中也遇到了同样的问题。

在我目前正在开发的应用程序中，我遇到了来自 textinputs 和 textareas 的文本在视图之间停留在屏幕上的问题，同时滚动等。

我看到的修复建议是为 textinput 和 textarea 使用不同的皮肤类：

```
skinClass="spark.skins.spark.TextAreaSkin" 
```

[Adobe Flex Mobile - TextArea 拒绝在 Android 上滚动，StageWebView 根本不会滚动](https://stackoverflow.com/questions/11350828/adobe-flex-mobile-textarea-refuses-to-scroll-on-android-stagewebview-wont-sc)是使用 TextAreaSkin 的这些建议之一的示例。

但是，在使用它和等效的 TextInputSkins 时，我现在遇到了一些相当大的问题。

在 iPad 2 (iOS6) 上，我们使用的软键盘根本不会出现，而在我们的三星 Galaxy 平板电脑 (Android 4) 上，键盘将只允许输入数字和某些特殊字符（如果我按住它也允许输入大写字母在特定的字母上，但在正常输入时不会）。

我在这里发现了另一个与我类似的问题： [http](http://forums.adobe.com/message/4078890) ://forums.adobe.com/message/4078890但它没有解决方案。

奇怪的是，在我的 Android (Desire) 手机上一切正常，或者如果我在三星 Galaxy 平板电脑上使用不同的键盘应用程序 (Swiftkey)，那么它也可以正常工作。

我已经在我们的另一个应用程序中对此进行了测试，并且在该应用程序中遇到了相同的问题。（我必须为该应用程序使用皮肤的唯一情况是不可编辑的文本区域 - 我从未见过我在该应用程序中提到的第一个问题）。

编辑：我创建了一个相当基本的演示，其中包含一些视图，其中我复制了我遇到的大部分问题。这是一个使用拆分视图导航器的移动应用程序。主要申请文件：

```
<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>

<!-- Split View Navigator used for Tablet for panelled functionality -->
<s:SplitViewNavigator width="100%" height="100%">
    <s:layout.landscape>
        <s:HorizontalLayout />
    </s:layout.landscape>
    <s:layout.portrait>
        <s:VerticalLayout />
    </s:layout.portrait>
    <s:ViewNavigator width.landscape="35%" height.landscape="100%"
                     width.portrait="100%" height.portrait="30%" 
                     firstView="views.TestView" />
    <s:ViewNavigator width="100%" height="100%" height.portrait="100%"
                     firstView="views.TestFormHomeView" />
</s:SplitViewNavigator>
</s:Application> 
```

主页视图：

```
<fx:Script>
    <![CDATA[
        protected function buttonClick():void
        {
            navigator.pushView(TestView2);
        }

        protected function listClick():void
        {
            navigator.popView();
            navigator.pushView(TestFormHomeView);
        }
    ]]>
</fx:Script>

<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>
<s:Scroller width="100%" height="100%">
    <s:HGroup width="100%">
        <s:List width="50%" click="listClick()">
            <s:ArrayCollection>
                <fx:String>Test1</fx:String>
                <fx:String>Test2</fx:String>
                <fx:String>Test3</fx:String>
                <fx:String>Test4</fx:String>
                <fx:String>Test5</fx:String>
            </s:ArrayCollection>
        </s:List>
        <s:VGroup width="50%">
            <s:TextArea id="testing" skinClass="spark.skins.spark.TextAreaSkin" />
            <s:TextArea id="testing2" />
            <s:Button click="buttonClick()" label="Next Screen" />
        </s:VGroup>
    </s:HGroup>
</s:Scroller>
</s:View> 
```

测试视图：

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark" title="TestView">
<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>

<s:TextArea id="testing2" />
</s:View> 
```

测试视图2：

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark" title="TestView2">
<fx:Script>
    <![CDATA[
        protected function goBack():void
        {
            navigator.popView();                
        }
    ]]>
</fx:Script>
<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>
<s:layout>
    <s:VerticalLayout />
</s:layout>
<s:TextArea id="testing2" />
<s:Button label="Back" click="goBack()" />
</s:View> 
```

HomeView 上的主要文本区域应用了皮肤类，这对我来说有以下问题：

iOS (iPad2)：根本没有软键盘。

Android（Samsung Galaxy Tab）：键盘出现但只允许数字和某些特殊字符

我无法重现问题（没有其他皮肤类），文本留在屏幕上，但在 Android 上，如果您在“TestView”上的文本框中键入内容并单击 Next Screen，TestView 中的文本将在视图已加载（直到您单击文本框）。如果你的屏幕足够长，如果你不使用其他皮肤类，那么滚动文本框会导致很多问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T11:08:27.587

好的，我发现了我的问题。最终证明是一个非常简单的。

我用错了皮肤。有一种手机专用皮肤叫做：

```
spark.skins.mobile.TextInputSkin 
```

它还没有完美地工作，但事实上我有一些工作是一种解脱，哈哈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-19T00:31:55.843

当我们需要在移动设备中对 TextInput 和 TextArea 进行皮肤处理时，我们需要继承默认 spark.skins.mobile.MobileSkin（或 MobileTextInputSkin），因为与默认 MXML 皮肤相比，使用 Actionscript 的移动设备皮肤是轻量级皮肤。如果您使用 MXML 对 TextInput 和 TextArea 进行皮肤，在某些设备上，例如三星的手机和平板电脑（不使用默认的 Google Android 键盘），您会遇到输入焦点时不会出现 SoftKeyboard 的问题。

另一件事是：我们永远不应该在 TextInput 和 TextArea 上使用**限制**属性，否则，我们将得到文本相互覆盖的错误。希望这有帮助，Rjs37

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-23T07:42:56.383

我为 StageTextAreaSkin 和 StageTextInputSkin 创建了一个解决方法，可以在 Scroller 中使用这些皮肤。如果您想使用 TextInputSkin 的唯一原因是支持滚动，这应该会有所帮助。它在 GitHub 上可用：

[https://github.com/lizardon/TouchScrollStageText](https://github.com/lizardon/TouchScrollStageText)

它通过更改 StyleableStageText 类来侦听触摸事件和对祖先 Scroller 组件的位置更改来工作。

希望 Apache 很快会解决这个错误，并且不需要解决方法。

# javascript - 当响应为带有位置标头的 303 时，防止 xhr 重定向

> ID：13420417
> 
> 赞同：3
> 
> 时间：2012-11-16T16:20:52.213
> 
> 标签：javascript, jquery, xmlhttprequest

我收到带有位置标头的 303 响应，如何防止 XMLHttpRequest 重定向？

下面是代码

```
var xhr = new XMLHttpRequest();

xhr.open('GET', '/api/v1/test' + $(e.target).data('machineimage'));

xhr.onreadystatechange = function () {
    if (xhr.readyState == 4) {
        // here I need to get the `location` header and do something with it
        // xhr.getResponseHeader('location')
        // but before it reaches here, there is a redirect
    }
};

xhr.send(); 
```

我也观察到它与 jquery 相同，有没有绕过这个？

# c# - MVC4 分页（续）

> ID：13420420
> 
> 赞同：0
> 
> 时间：2012-11-16T16:20:59.473
> 
> 标签：c#, razor, asp.net-mvc-4

我的问题是这个问题的延续：

[MVC 4 中的过滤器和分页](https://stackoverflow.com/questions/13298605/filter-and-pagination-in-mvc-4/13407785)

在开始的代码块中：

```
<div>Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber)
of @Model.PageCount 
```

我已经在我的项目中实现了这一点，它非常适合创建页面和适当的导航链接。但它并没有从数据库中提取我的实际列表；只是页面链接。

这是我之前在 Index.cshtml 文件中的内容：

```
@model IEnumerable<PtoTracker.Employee>

@{
ViewBag.Title = "Employees";
}

<h2>Employees</h2>

<p>
@Html.ActionLink("Add New Employee", "Create")
</p>
<table>
<tr>
    <th></th>
    <th></th>
</tr>

@foreach (var item in Model) {
<tr>
    <td>
        @Html.DisplayFor(modelItem => item.EmployeeName)
    </td>
    <td>
        @Html.ActionLink("Edit", "Edit", new { id=item.EmployeeID }) |
        @Html.ActionLink("Details", "Details", new { id=item.EmployeeID }) |
        @Html.ActionLink("Delete", "Delete", new { id=item.EmployeeID })
    </td>
</tr>
}
</table> 
```

上面的代码效果很好，但这只是一长串员工。如何将上述代码与此处显示的分页部分合并：

```
<div>Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber)
of @Model.PageCount

@if (Model.HasPreviousPage)
{
@Html.ActionLink("<<", "Index", new { page = 1, sortOrder = ViewBag.CurrentSort });
@Html.Raw(" ");
@Html.ActionLink("< Prev", "Index", new { page = Model.PageNumber - 1, sortOrder = ViewBag.CurrentSort });
}
else
{
@:<<
@Html.Raw(" ");
@:< Prev
}

@if (Model.HasNextPage)
{
@Html.ActionLink("Next >", "Index", new { page = Model.PageNumber + 1, sortOrder = ViewBag.CurrentSort });
@Html.Raw(" ");
@Html.ActionLink(">>", "Index", new { page = Model.PageCount, sortOrder = ViewBag.CurrentSort });
}        
else
{
@:Next >
@Html.Raw(" ");
@:>>
}
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:30:11.593

网格和分页的另一个很好的选择：[MvcContrib Grid](http://mvccontrib.codeplex.com/wikipage?title=Grid)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:14:10.987

我想到了。我只需要将第一行从 to 更改为`@model IEnumerable...`然后`@model PageList.IPagedList...`将两个块拍打在一起。

这是我的工作代码：

```
@model PagedList.IPagedList<PtoTracker.Employee>

@{
ViewBag.Title = "Employees";
}

<h2>Employees</h2>

<p>
@Html.ActionLink("Add New Employee", "Create")
</p>
<table>
<tr>
    <th></th>
    <th></th>
</tr>

@foreach (var item in Model) {
<tr>
    <td>
        @Html.DisplayFor(modelItem => item.EmployeeName)
    </td>
    <td>
        @Html.ActionLink("Edit", "Edit", new { id=item.EmployeeID }) |
        @Html.ActionLink("Details", "Details", new { id=item.EmployeeID }) |
        @Html.ActionLink("Delete", "Delete", new { id=item.EmployeeID })
    </td>
</tr>
}
</table>

<div>
Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber)
of @Model.PageCount

@if (Model.HasPreviousPage)
{
    @Html.ActionLink("<<", "Index", new { page = 1, sortOrder = ViewBag.CurrentSort });
    @Html.Raw(" ");
    @Html.ActionLink("< Prev", "Index", new { page = Model.PageNumber - 1, sortOrder = ViewBag.CurrentSort });
}
else
{
    @:<<
    @Html.Raw(" ");
    @:< Prev
}

@if (Model.HasNextPage)
{
    @Html.ActionLink("Next >", "Index", new { page = Model.PageNumber + 1, sortOrder = ViewBag.CurrentSort });
    @Html.Raw(" ");
    @Html.ActionLink(">>", "Index", new { page = Model.PageCount, sortOrder = ViewBag.CurrentSort });
}        
else
{
    @:Next >
    @Html.Raw(" ");
    @:>>
} 
```

# javascript - 如何在单击该行中的链接按钮时从gridviews当前行获取文本框文本

> ID：13420421
> 
> 赞同：0
> 
> 时间：2012-11-16T16:21:15.190
> 
> 标签：javascript, asp.net

这是我的网格视图

```
<asp:GridView ID="gvEmployee" runat="server" AutoGenerateColumns="false" GridLines="Both">
            <Columns>
                <asp:TemplateField HeaderText="Name">
                    <ItemTemplate>
                        <asp:TextBox ID="txtName" runat="server" Text='<%#Eval("Name") %>'></asp:TextBox>
                    </ItemTemplate>
                </asp:TemplateField>
                <asp:BoundField DataField="Emailid" HeaderText="EmailId" />
                <asp:TemplateField >
                    <ItemTemplate>
                        <asp:LinkButton ID="lnkgettext" runat="server"  OnClientClick="return callme(<%= txtName.ClientID %>);" Text="Gettextboxvalue" ></asp:LinkButton>
                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
        </asp:GridView>
  <script type="text/javascript">
        function callme(txt) {
            alert(txt);
        }
    </script> 
```

LinkBut​​ton 的 Onclick 我想从 gridview 的当前行获取文本框的值

请帮我用javascript

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:06:06.533

您将不得不使用如下绑定的行数据
这也可以通过 jQuery 来完成。但首先，目的应该是明确的。
即你想回发或不回发的天气等

```
protected void gvEmployee_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        LinkButton lk = (LinkButton)e.Row.FindControl("lnkgettext");
        TextBox textBox = (TextBox)e.Row.FindControl("txtName");
        lk.Attributes.Add("onclick", "return callme('" + lk.ClientID + "')");
    }
} 
```

和你的gridview如下

```
<asp:GridView ID="gvEmployee" runat="server" AutoGenerateColumns="false" GridLines="Both"
        OnRowDataBound="gvEmployee_RowDataBound">
        <Columns>
            <asp:TemplateField HeaderText="Name">
                <ItemTemplate>
                    <asp:TextBox ID="txtName" runat="server" Text='<%#Eval("Name") %>'></asp:TextBox>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:BoundField DataField="Emailid" HeaderText="EmailId" />
            <asp:TemplateField>
                <ItemTemplate>
                    <asp:LinkButton ID="lnkgettext" runat="server" Text="Gettextboxvalue"></asp:LinkButton>
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
    </asp:GridView>
    <script type="text/javascript">
        function callme(txt) {
            alert(txt);
        }
    </script> 
```

甚至 jquery 函数如下

```
 $(document).ready(function () {
        $('#gvEmployee a').click(function () {
            alert($(this).parent("td").parent("tr").find("input:text").val());
        });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T22:28:56.353

修改您的链接按钮代码如下：

```
 <asp:LinkButton ID="lnkgettext" runat="server"  
CommandArgument='<%#DataBinder.Eval(Container.DataItem, "Name")%>' 
 OnCommand="Load_Data" ></asp:LinkButton> 
```

您可以获取一个**隐藏字段，**您可以从中检索值，隐藏字段将从以下代码中获取值：

```
<asp:HiddenField ID="hiddenfield1" runat="server" /> 
```

在服务器端

```
protected void Grid_RowCommand(object sender, GridViewCommandEventArgs e)
{
    switch (e.CommandName)
    {
        case "Load_Data":
        {
            hiddenfield1.value = e.CommandArgument.ToString();
            break;
        }
        default:
            break;
    }
} 
```

# ios - 保护 ipad 应用中的 plist

> ID：13420432
> 
> 赞同：0
> 
> 时间：2012-11-16T16:21:40.697
> 
> 标签：ios, plist

在我的应用程序中，我当前将服务 url 及其用户/密码保存在文档目录中的 plist 中。我想将用户和密码移动到钥匙串并保护 plist 文件。我尝试使用此[示例](http://developer.apple.com/library/ios/#documentation/Security/Conceptual/keychainServConcepts/iPhoneTasks/iPhoneTasks.html)中给出的 keychainwrapper 类，但不知道如何向其中添加项目。

如何将包含用户名和密码的字典数组添加到钥匙串中，并保护我的 plist 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:33:32.807

如果您想使用钥匙串，最好的解决方案是使用第三方库（[STKeychain](https://github.com/ldandersen/STUtils/blob/master/Security/STKeychain.h)）。使用它非常简单。

如果要将数组存储到钥匙串中，您可以将数组转换为序列化字符串并将该字符串存储到一个钥匙串中。或者，如果您愿意，您可以将字典存储到多个钥匙串中。

我不明白你为什么还要保护你的 plist？Keychain就够了，不用再存plist了！

# python - 窗口中的图标覆盖未反映在资源管理器中

> ID：13420436
> 
> 赞同：0
> 
> 时间：2012-11-16T16:21:51.247
> 
> 标签：python, windows, explorer, py2exe, shell-icons

我正在使用 python2.7 和 py2exe 从我的 python 脚本创建 dll。

成功创建了一个 DLL 并为我的图标覆盖状态注册了一个条目，然后通过任务管理器重新启动了 Windows 资源管理器进程。

验证我的条目是否在注册表中，是的，它在那里。

但是，当我通过 python 测试应用程序脚本为特定文件夹位置设置我的状态时。

我希望所选路径中的所有文件和文件夹都应该覆盖我的覆盖图标。

但是不，图标覆盖根本没有发生。

但是当我通过python脚本测试注册条目（不创建DLL）并通过我的测试应用程序脚本设置我的图标覆盖时。

是的，它工作得很好。

我很困惑为什么在尝试使用我的 DLL 时它没有发生？？？

下面是我注册状态条目的python脚本

```
import os
import win32traceutil
import pythoncom
import winerror
from win32com.shell import shell, shellcon
from multiprocessing.connection import Client

REG_PATH = r'Software\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers'
REG_KEY  = "IconOverlayTest"

class IconOverlay:
    _reg_desc_       = 'Icon Overlay COM Server'
    _public_methods_ = ['GetOverlayInfo', 'GetPriority','IsMemberOf']
    _com_interfaces_ = [shell.IID_IShellIconOverlayIdentifier, pythoncom.IID_IDispatch]
    def __init__(self, *_args, **_kwargs):
        self._icon = None
        self._icon_id = None
        raise NotImplementedError
    def GetOverlayInfo(self):
        return self._icon, 0, shellcon.ISIOI_ICONFILE
    def GetPriority(self):
        return 0
    def IsMemberOf(self, path, _attrs):
        if is_member(path, self._icon_id):
            return winerror.S_OK
        return winerror.E_FAIL

class IconOverlay_test(IconOverlay):
    _reg_progid_     = 'a.TestServer1'
    _reg_clsid_      = '{8B19F050-8354-11E1-A0FE-5C260A5D15E4}'
    def __init__(self):
        self._icon = "C:\\Users\\Administrator\\mat\\icon_overlay\\icons\\1.ico"
        self._icon_id = 101 

classes =   [IconOverlay_test,]

def is_member(path, icon_id):
    try:
        conn = None
        conn = Client("\\\\.\\pipe\\test.listener", "AF_PIPE")
        conn.send(path)
        if conn.poll(3):
            reply   =   conn.recv()
            return reply == icon_id
    except Exception:
        pass
    finally:
        conn and conn.close()
    return False

def DllRegisterServer():
    print("Registering %s ......."%IconOverlay._reg_desc_)
    import winreg
    #winreg = _winreg
    for view in [winreg.KEY_WOW64_64KEY, winreg.KEY_WOW64_32KEY]:
        for cls in classes:
            with winreg.CreateKeyEx(winreg.HKEY_LOCAL_MACHINE, r"%s\%s" %
                    (REG_PATH, cls._reg_progid_), 0,
                    winreg.KEY_ALL_ACCESS|view) as hkey:
                print("    %s"%cls)
                winreg.SetValueEx(hkey, None, 0, winreg.REG_SZ, cls._reg_clsid_)
    print("Registration complete: %s" % IconOverlay._reg_desc_)

def DllUnregisterServer():
    print("Unregistering %s ......."%IconOverlay._reg_desc_)
    import winreg
    #winreg = _winreg
    for view in [winreg.KEY_WOW64_64KEY, winreg.KEY_WOW64_32KEY]:
        for cls in classes:
            try:
                _key = winreg.DeleteKeyEx(winreg.HKEY_LOCAL_MACHINE, r"%s\%s"
                        % (REG_PATH, cls._reg_progid_),
                        winreg.KEY_ALL_ACCESS|view)
            except WindowsError as err:
                if err.errno != 2:
                    raise
    print("Unregistration complete: %s" % IconOverlay._reg_desc_)

if __name__ == '__main__':
    from win32com.server import register
    register.UseCommandLine(*classes,
                            finalize_register = DllRegisterServer,
                            finalize_unregister = DllUnregisterServer) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:00:59.650

正常工作真的很痛苦，祝你好运！

我相信 Windows 将只允许注册 10 个不同的图标，并且它只适用于按字母顺序注册的前 10 个图标。你已经有10个注册了？如果您安装了 dropbox、tor​​toise-svn 等，则很容易超过 10 个，因为每个图像都算作一个条目。如果是这种情况，请尝试在名称前加上下划线或 0 以确保它获得优先权，尽管这意味着另一个图标会丢失——我认为没有办法解决这个问题。

有时windows也不知道刷新图标的状态。你运行的是哪个版本的windows？有些人比其他人更糟。我似乎记得 XP 不是很擅长这个。虽然有一些技巧可以让它更新，你可以通过 windows api 刷新窗口，但它看起来很可怕，整个资源管理器都会闪烁。我发现一个更好的方法是更改​​文件的属性。这是我使用的技巧：

```
import stat,os

file_att= os.stat(path)[0]
if file_att & stat.S_IWRITE:
    os.chmod(path,stat.S_IREAD)
    os.chmod(path,stat.S_IWRITE)
else:
    os.chmod(path,stat.S_IWRITE)
    os.chmod(path,stat.S_IREAD) 
```

# google-maps - 客户网站上的谷歌地图

> ID：13420439
> 
> 赞同：0
> 
> 时间：2012-11-16T16:21:54.667
> 
> 标签：google-maps

我在 2012 年之前用谷歌地图建立了几个网站。但在 2012 年谷歌做了一些改变，我很困惑我应该遵循什么程序才能将谷歌地图添加到新网站。

我正在为客户构建网站，那么我应该如何获取 API 密钥？在我所见之处，只有诸如“如何将谷歌地图添加到我的网站？”之类的问题的答案。我不想将地图添加到我的网站。我想将地图添加到我的客户网站。

现在每个 API 密钥都链接到 google 帐户，因此我无法使用我的 API 密钥，因为这可能会导致超出我的使用限制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T08:35:33.537

首先，获取地图功能的密钥并不是强制性的。如果您的应用程序[超出使用限制](https://developers.google.com/maps/documentation/javascript/usage)，那么您必须采取进一步的措施。

如果您想监控使用情况，请为您的客户创建一个帐户并为他获取密钥。

# c# - 在 C# 中实现大规模并行应用程序的最佳方式

> ID：13420447
> 
> 赞同：3
> 
> 时间：2012-11-16T16:22:16.753
> 
> 标签：c#, .net, multithreading

我正在开发一个网络绑定应用程序，它应该有很多（数百个，可能是数千个）并行进程。

我正在寻找实现它的最佳方法。

当我尝试设置

```
ThreadPool.SetMaxThreads(int.MaxValue, int.MaxValue); 
```

与创建 1000 个线程并让它们并行执行相比，应用程序的执行变得非常复杂。

我听说过某处`delegate.BeginInvoke`更好`new Thread(...)`，所以我尝试了它，然后在调试器中打开了应用程序，我看到的是并行线程。

如果我必须创建大量线程，那么确保应用程序顺利运行的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-16T16:25:40.273

您是否尝试过`await / async`C# 5 / .NET 4.5 中的新模式？

我没有关于它如何在后台运行的消息来源，但这个新功能最常见的用例之一是等待 IO 绑定的东西。

* * *

线程**不是**轻量级对象。它们的创建和上下文切换成本很高；因此线程池的原因（预先创建和回收）。涉及网络或其他 IO 端口的最常见解决方案利用较低级别的 IO 完成端口（这里有一个托管库[）](http://www.codeproject.com/Articles/10280/Managed-I-O-Completion-Ports-IOCP)在端口上“等待”，但线程可以继续正常执行。

`BeginInvoke`***将使用线程池线程，因此它比仅***在线程可用时创建自己的线程要好。这种方法如果使用过多，会立即导致线程饥饿。

从长远来看，设置如此高的线程池计数是行不通的，因为线程对于你想要做的事情来说太重了。

* * *

Axum 是一种前 Microsoft Research 语言，用于实现适合此任务的大规模并行性。它的操作类似于 Stackless Python 或 Erlang。来自 Axum 的许多概念进入了 C# 5 和 .NET 4.5 的并行驱动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T16:48:53.253

设置 ThreadPool.SetMaxThreads 只会影响线程池有多少线程，并且不会对您使用 new Thread() 创建的线程产生影响。

正如许多人所建议的那样去异步（模型，而不是关键字）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T17:55:04.820

您应该遵循其他答案和评论中提到的建议。正如 fsimonazzi 所说，直接创建新线程与 ThreadPool 无关。为了快速测试，降低最大工作线程和完成端口线程并使用[ThreadPool.QueueUserWorkItem](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.queueuserworkitem.aspx)方法。ThreadPool 将决定您的系统可以处理什么，将您的任务排队并尽可能重用线程。

如果您的任务不受计算限制，那么您还应该使用异步 I/O。您不需要您的工作线程等待 I/O 完成。您需要这些工作线程尽快返回到池中，并且不会阻塞 I/O 请求。

# android - 我如何用 setRetainInstance(true) 破坏片段并将它们添加到后台堆栈？

> ID：13420448
> 
> 赞同：24
> 
> 时间：2012-11-16T16:22:16.893
> 
> 标签：android, android-fragments, android-orientation

setRetainInstance 上的文档说：

> 这只能与不在后台堆栈中的片段一起使用。

所以我开始玩它。

我有一个添加第一个片段 A 的 Activity

```
FragmentManager fm = getSupportFragmentManager();
FragmentTransaction ft = fm.beginTransaction();
ft.replace(R.id.content, new PackageFragment());
ft.commit 
```

然后从这个片段中，我从父 Activity 运行一个方法，将片段 B 添加到后台堆栈

```
FragmentManager fm = getSupportFragmentManager();
FragmentTransaction ft = fm.beginTransaction();
ft.replace(R.id.content, new OrderFragment());
ft.addToBackStack(null);
ft.commit(); 
```

然后我从 onCreate、onDestroy、onSaveInstanceState、onActivityCreated...等创建日志消息

我尝试了这个过程的两个版本。在每个片段上旋转设备。

1.  默认

一切都如预期的那样。onCreate, onDestroy on Fragments 触发

1.  设置保留实例（真）

一切如预期？onCreate, onDestroy on Fragments 不触发

当片段在后台时，一切似乎都可以工作..那么为什么文档说我不应该使用它？在哪些情况下我可能会遇到麻烦？

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-08T01:23:24.947

更新的答案：

> 在哪些情况下我可能会遇到麻烦？

将 a 添加`Fragment`到后台堆栈并在配置更改时将 a`Bundle`从`Fragment`from传递`onSaveInstanceState()`到。`onCreateView()`调用`setRetainInstance(true)`将在配置更改时将 设置`Bundle`为空。

（我不确定开发人员是否真的会尝试这样`setRetainInstance(true)`做，因为 using`onSaveInstanceState()`有点多余，但我没有看到 API 文档中记录的行为，所以我写了这个答案）。

如果同时调用 和 ，则`addToBackStack()`与仅调用 相比，会在配置更改`setRetainInstance(true)`时`setRetainInstance()`部分更改`Fragment`生命周期方法调用和参数值`addToBackStack()`。

`addToBackStack()`具体来说，在下面的测试中，查看仅调用和调用之间的差异`setRetainInstance(true)`，并查看配置更改会发生什么：

打电话`addToBackStack()`但不打电话`setRetainInstance(true)`；

*   `onCreate()`并被`onDestroy()`调用。
*   传入的包`onSaveInstanceState()`作为参数接收`onCreateView()`。

同时调用`addToBackStack()`和`setRetainInstance(true)`：

*   `onCreate()`并且`onDestroy()`不被调用。这在 API 文档中有所提及。
*   从 传递的捆绑包`onSaveInstanceState()`未在 中接收`onCreateView()`。传入的`Bundle`为空。

记录方法调用和参数的测试是否为空：

在`Activity`：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    MyFragment fragment;
    if (savedInstanceState != null) {
        fragment = (MyFragment) getFragmentManager().findFragmentByTag("my_fragment_tag");
    } else {
        fragment = new MyFragment();
        FragmentTransaction t = getFragmentManager().beginTransaction();
        t.addToBackStack(null);//toggle this
        t.add(android.R.id.content, fragment, "my_fragment_tag").commit(); 
    }
} 
```

在`Fragment`：

```
@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    setRetainInstance(true);//toggle this
} 
```

和

```
@Override
public void onSaveInstanceState(Bundle outState) {
    outState.putString("test", "value");
    super.onSaveInstanceState(outState);
} 
```

测试1：片段生命周期何时*被*`addToBackStack()`调用，`setRetainInstance(true)`未被调用

 **   onAttach()
*   onCreate()
*   onCreateView()
*   onActivityCreated()
*   开始（）
*   onResume()

[设备从纵向旋转到横向]

*   暂停（）
*   onSaveInstanceState()
*   停止()
*   onDestroyView()
*   **onDestroy()**
*   onDetach()
*   onAttach()
*   **onCreate()**
*   **带有捆绑参数的 onCreateView() ！= null**
*   开始（）
*   onResume()

测试 2 和 3：片段生命周期调用，`setRetainInstance(true)`调用、`addToBackStack()`调用/未调用（结果相同）：

*   onAttach()
*   onCreateView()
*   onActivityCreated()
*   开始（）
*   onResume()

[设备从纵向旋转到横向]

*   暂停（）
*   onSaveInstanceState()
*   停止()
*   onDestroyView()
*   onDetach()
*   onAttach()
*   **onCreateView() 与捆绑参数 == null**
*   开始（）
*   onResume()*

# python - python mysql连接错误

> ID：13420450
> 
> 赞同：0
> 
> 时间：2012-11-16T16:22:40.340
> 
> 标签：python, mysql, mysql-python

```
>>> db=MySQLdb.connect(passwd="king123",db="thangs",host="localhost",port=3306,user="user")

Traceback (most recent call last):
  File "<pyshell#6>", line 1, in <module>
    db=MySQLdb.connect(passwd="king123",db="thangs",host="localhost",port=3061,user="user")
  File "C:\Python27\lib\site-packages\MySQLdb\__init__.py", line 81, in Connect
    return Connection(*args, **kwargs)
  File "C:\Python27\lib\site-packages\MySQLdb\connections.py", line 187, in __init__
    super(Connection, self).__init__(*args, **kwargs2)
OperationalError: (2003, "Can't connect to MySQL server on 'localhost' (10061)") 
```

我在正确的端口上运行它，它仍然给我错误。任何人都可以给我任何想法吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:39:23.553

如果你看不到这个端口，这意味着 mysql 没有运行，在这种情况下错误是有意义的。请参阅[如何](http://dev.mysql.com/doc/refman/5.0/en/windows-start-command-line.html)打开 mysql 服务器。

# jquery - 通过 jquery 同时发布两个输入数组

> ID：13420455
> 
> 赞同：0
> 
> 时间：2012-11-16T16:22:58.537
> 
> 标签：jquery, html, mysql

我正在附加多个输入框并成功地将一个输入数组发布到 mysql，就像这里一样。

```
$('<p><input type="text"  class="name" name="task" ></p>').appendTo($('#add_here'));

function addmem(id, text, number) {
    $('input.name').each(function() {
        // var te=$('input.task').val();
        $.post(
            'sendchat2.php', 
            { option: 'add_mem', id: id , text: $(this).val() }, 
            function(data) {
                alert(data);
            });
        });
    } 
```

但现在我需要同时发布两个输入数组。一个输入是客户姓名，另一个是他的手机号码。我尝试了以下方法，但它无法正常工作。请帮助或建议任何替代方法。

```
$('<p><input type="text"  class="name" ><input type="text"  class="number" name="task" ></p>').appendTo($('#add_here'));

function addmem(id, text, number) {
    $('input.name').each(function() {
        $('input.number').each(function() {
            $.post(
                'sendchat2.php', 
                { option: 'add_mem', id: id, text: $(this).val(), number: $(this).val()}, 
                function(data) {
                    alert(data);
                }
            );
        });
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:35:33.400

您应该使用 $.ajax{}) 函数而不是 $.post。

```
$.ajax({
  type: 'POST',
  data: array1.serialize() + array2.serialize(), //(if this info is coming from a form, just do $(form identifier).serialize(); and it will send all form elements).
  url: <destination url>
  success: function (data){
          <what you want to do when the request is successful here>
         }
}) 
```

这样做，您只需对所有数据进行 1 次 ajax 调用，而不是在循环中的每次迭代中调用 ajax。它应该更有效率。

我认为这个函数也更容易与多个数据源一起使用，但我相信你可能会想出一种方法来使用 $.post 来做到这一点（也许序列化两个数组，或者在传递给之前将两个数组组合成一个数组）服务器。如果你能告诉我你的表单是什么样子的，我会更具体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:33:09.480

如果标记将始终符合方案`<name><number>`

```
function addmem(id, text, number) {
    $('input.name').each(function() {
        var input = $(this),
            name = input.val(),
            number = input.next().val();

        $.post(
            "sendchat2.php", 
            { "option": "add_mem", "id": id, "text": name, "number": number }, 
            function(data) {
               alert(data);
            }
        );
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:29:45.687

突出的是这个循环

```
$('input.name').each(function(){

    $('input.number').each(function(){

$.post('sendchat2.php', {option:'add_mem', id:id , text:$(this).val(),number:$(this).val()}, function(data) {
 alert(data);
});
    });

}); 
```

看起来您正在为 the`text`和`number`post 变量分配相同的值，因为`this`关键字将始终引用`input.number`内部`each`循环中的元素。试试这个：

```
$('input.name').each(function(){
  var nameval = $(this).val();

  $('input.number').each(function(){
    var numval = $(this).val();

    $.post('sendchat2.php', {option:'add_mem', id:id , text:nameval, number:numval}, function(data) {
     alert(data);
    });

  });
}); 
```

# javascript - Uncaught SyntaxError: Unexpected token {

> ID：13420457
> 
> 赞同：-1
> 
> 时间：2012-11-16T16:23:16.037
> 
> 标签：javascript, jquery, html

在我的代码中，一行代码在我的控制台中产生了这个错误：

```
Uncaught SyntaxError: Unexpected token { 
```

它以前工作得很好，只是决定停止。它提到的行上的代码是：

```
$('#next').click(){
    $('#atestimonial').load('http://website.com/testimonialPull.php');
    return false;
  }); 
```

我看不出有什么问题，我已经检查过它的加载存在并且它生成了所需的文本，所以它的加载/.click（）有问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T16:25:44.477

看起来您正在尝试将函数传递给`click`函数，但没有正确执行。而是尝试这样的事情：

```
$('#next').click(
   function(){
      $('#atestimonial').load('http://website.com/testimonialPull.php');
      return false;
   }
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:23:51.327

```
 $('#next').click(){ //<<<
    $('#atestimonial').load('http://website.com/testimonialPull.php');
    return false;
  }); 
```

删除`)`：

```
 $('#next').click(function(){
    $('#atestimonial').load('http://website.com/testimonialPull.php');
    return false;
  }); 
```

# iphone - 跟踪启动错误

> ID：13420458
> 
> 赞同：0
> 
> 时间：2012-11-16T16:23:16.050
> 
> 标签：iphone, objective-c, nsuserdefaults

我找到了一些讨论这个问题的线程并将其实现到我的代码中，但是我遇到了一个错误。

我正在尝试每 5 次发布时做一些事情。

还有代码集`launchAmounts`，是内置的`userDefaults`，还是我必须在某处声明？

我`viewwillappear`在我的主视图控制器中这样做。

```
NSUserDefaults * userDefaults = [NSUserDefaults standardUserDefaults];
NSInteger appLaunchAmounts = [userDefaults integerForKey:@"LaunchAmounts"];
appLaunchAmounts = appLaunchAmounts %5;
NSLog(@"app has been launched = %d", appLaunchAmounts);
[userDefaults setInteger:appLaunchAmounts+1 forKey:@"LaunchAmounts"];

if (appLaunchAmounts==0) { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:44:54.780

该代码看起来应该可以工作，除了您在 viewWillAppear 中拥有它。如果您在不同的视图控制器之间来回切换，则可以在一次运行中多次调用该方法。您应该将它放在应用程序委托的 applicationDidFinishLaunching 方法中。

什么不符合你现在的方式？

# android - 如何使用自定义适配器在我的列表视图中获取 itemid

> ID：13420459
> 
> 赞同：0
> 
> 时间：2012-11-16T16:23:22.330
> 
> 标签：android, custom-adapter

我为具有复选框和文本项的列表视图实现了一个自定义适配器。我可以通过我的覆盖参数获得位置。但是如何获取我的列表行的 id 呢？

以下是自定义适配器的代码 -

```
@Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View rowView = convertView;
        if (rowView == null) {
            LayoutInflater inflater = context.getLayoutInflater();
            rowView = inflater.inflate(R.layout.reminder_row, null);
            ViewHolder viewHolder = new ViewHolder();
            viewHolder.text = (TextView) rowView.findViewById(R.id.reminderRowTextId);
            viewHolder.reminderCheckBox = (CheckBox) rowView.findViewById(R.id.CheckBoxId);
            rowView.setTag(viewHolder);
        }

        final int pos = position;
        final ViewHolder holder = (ViewHolder) rowView.getTag();
        int idRow = holder.text.getId();
        Log.i(TAG, "id of item selected-->" + idRow); <<<<<<------- IT IS GIVING SOME VALUE LIKE 2030771-------->>>
        String s = names[position];
        holder.text.setText(s);

        holder.reminderCheckBox.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                if (holder.reminderCheckBox.isChecked()) {
                    Toast.makeText(getContext(), "pos-->chkd" + pos, Toast.LENGTH_SHORT).show();
                    long longPos = (long)pos;
                    dbHelper.completeTask(longPos + 1);

                } else {
                    Toast.makeText(getContext(), "pos-->un--chkd" + pos, Toast.LENGTH_SHORT).show();
                }
            }
        });

        holder.text.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                Toast.makeText(getContext(), "TEXT CLICKED" + pos , Toast.LENGTH_SHORT).show();

                Intent intent = new Intent(context,ReminderModificationActivity.class);
                long longPos = (long)pos;
                intent.putExtra(TasksDBAdapter.KEY_ROWID, longPos + 1);
                Log.i(TAG, "row clickd --> " + longPos);
                ((Activity) context).startActivityForResult(intent, ACTIVITY_EDIT);
            }
        });
        return rowView;
    } 
```

编辑 1.1

```
public static final String KEY_TITLE = "title";                  
    public static final String KEY_BODY = "body";
    public static final String KEY_DATE_TIME = "reminder_date_time"; 
    public static final String KEY_ROWID = "_id";                
    public static final String KEY_IS_COMPLETE = "is_complete";
    private static final String TAG = "TasksDBAdapter";

private static final String DATABASE_CREATE =                        
           "create table " + DATABASE_TABLE + " ("
                   + KEY_ROWID + " integer primary key autoincrement, "
                   + KEY_IS_COMPLETE + " boolean default 'false', "
                   + KEY_TITLE + " text not null, " 
                   + KEY_BODY + " text , " 
                   + KEY_DATE_TIME + " text);"; 
```

请看一下标记线。任何人都可以帮助我如何获得身份证。我正在学习android，请详细说明。在此先感谢，雷

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:28:34.737

您正在调用`getId()`a `TextView`，[根据文档](http://developer.android.com/reference/android/view/View.html#getId%28%29)返回与属性关联的值`android:id`。该值是自动生成的，可能与`R.id.reminderRowTextId`.

基本上，您实际上并没有在`ViewHolder`课堂上设置有意义的 ID。只需添加另一个成员变量，然后存储您需要的任何内容。

详细地说，适配器用于描述后备列表/数组的大小，并为每个元素提供一个视图。要正确执行此操作，您需要实现`getView()`and `getItem()`。

`getItem()`接受一个位置，它是 的一个参数`getView()`。传递`position`到`getItem()`，这将为您提供 SQLite 中的项目。获取该对象的 ID，并在`ViewHolder`.

# modx - 如何为前端的特定私有资源组创建用户会话？

> ID：13420460
> 
> 赞同：0
> 
> 时间：2012-11-16T16:23:22.947
> 
> 标签：modx, modx-revolution

我有一个完整的网站，其中包含两种不同语言的两种上下文。唯一的公共页面是两种语言的登录页面。其余的应该是私有的/受保护的。这是我通过资源组和匿名用户限制实现的。在登录页面上，匿名用户应该可以看到所有受保护的菜单条目，如果单击，应该会显示一个带有两个登录表单的弹出窗口。这些登录表单来自其他站点，如果用户在输入凭据时是否具有权限，它们将返回。只要这个会话存在，如果用户当然被批准，用户应该能够查看所有页面。

我作为非 modx- 或 php- pro 的猜测是，我应该在加载登录页面（以及所有子页面）时检查会话是否存在。如果没有用户登录，所有链接都将指向弹出窗口。然后用户登录，将信息发送到外部服务器，如果成功，将被重定向到私有/受保护的登录页面。这就是我找不到任何信息的原因，可能是因为我不完全确定要寻找什么。我需要一个片段来检查受保护页面是否存在有效会话，如果不显示登录名。如果外部登录成功，我需要的其他代码是为用户创建会话的代码。这应该是服务器上的一个片段还是只是一个 php 文档。以及如何为受保护页面启动会话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:54:14.977

MODX Revolution 在尝试访问受保护的页面时检查用户是否已登录，但如果您想手动检查，此代码段将执行以下操作：

```
 if (!$modx->user->hasSessionContext($modx->context->get('key'))) {
    $modx->sendUnauthorizedPage(); // redirect to the informative page for non-logged users
} 
```

如果您需要检查正在登录的用户并在没有登录的情况下显示登录弹出窗口，那么使用带有简单用户 ID 检查的输出修饰符可能会起作用：

```
[[+modx.user.id:if=`[[+modx.user.id]]`:eq:=`0`:then=`Not logged in`:else=`logged in`]] 
```

当它为从 MODX 站点外部验证的用户创建会话时，我建议编写一个片段来检查来自永恒页面的状态并登录用户。这样会话检查将被省略，但仍然是功能目标应该达到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T03:03:29.480

您可以通过两种不同的方式执行此操作：

1.  创建一个未连接到 Modx 的用户系统。我发现这很容易，而且我之前已经做过好几次了。您需要为具有用户名和密码的用户创建一个表，并从中创建一个对象，以便您可以使用 xpdo 进行查询。随着这个系统启动并运行，在每个模板中包含一个片段以确保用户确实登录是没有问题的。如果没有，只需将他重定向到正确的首页/登录页面。这将需要一些编码，但正如我所说，它就像一个魅力。

2.  下载代码片段[http://modx.com/extras/package/login](http://modx.com/extras/package/login)（来自 Spittingred，一个真正的传奇人物），然后查看代码。我以前没有使用过这个 Extra，但我很确定它使用与 Modx 相同的用户系统，因此你应该能够实现你想要的。除了“查看源代码并弄清楚 Spittingred 是如何做到的”之外，我无法为您提供更多帮助。

# oracle - Oracle 'INSERT ALL' 忽略重复项

> ID：13420461
> 
> 赞同：11
> 
> 时间：2012-11-16T16:23:24.657
> 
> 标签：oracle, insert, duplicates, unique-constraint

我有一个带有唯一约束的数据库表（唯一`(DADSNBR, DAROLEID)`对）。我将同时向该表中插入多个值，所以我想使用一个查询来完成它 - 我假设这将是更快的方法。因此，我的查询是：

```
INSERT ALL
    INTO ACCESS (DADSNBR, DAROLEID) VALUES (68, 1)
    INTO ACCESS (DADSNBR, DAROLEID) VALUES (68, 2)
    INTO ACCESS (DADSNBR, DAROLEID) VALUES (68, 3)
    INTO ACCESS (DADSNBR, DAROLEID) VALUES (68, 4)
SELECT 1 FROM DUAL 
```

由于语句中的某些条目与数据库中已有的条目重复，因此整个插入失败并且没有插入任何行。

有没有办法忽略唯一约束失败的情况，只插入唯一约束，而不必将其拆分为单独的 INSERT 语句？

**编辑：**我意识到我可能不想这样做，但我仍然很好奇它是否可能。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-16T17:02:55.517

在 Oracle 中，语句要么完全成功，要么完全失败（它们是原子的）。但是，您可以在某些情况下添加子句来记录异常而不是引发错误：

*   使用`BULK COLLECT - SAVE EXCEPTIONS`，如[askTom 上的此线程所示](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:1422998100346727312)，
*   或使用[`DBMS_ERRLOG`](http://docs.oracle.com/cd/E11882_01/appdev.112/e25788/d_errlog.htm#BABGGCDF)（我认为从 10g 开始可用）。

第二种方法是全自动的，这里有一个演示（使用 11gR2）：

```
SQL> CREATE TABLE test (pk1 NUMBER,
  2                     pk2 NUMBER,
  3                     CONSTRAINT pk_test PRIMARY KEY (pk1, pk2));

Table created.

SQL> /* Statement fails because of duplicate */
SQL> INSERT into test (SELECT 1, 1 FROM dual CONNECT BY LEVEL <= 2);

ERROR at line 1:
ORA-00001: unique constraint (VNZ.PK_TEST) violated

SQL> BEGIN dbms_errlog.create_error_log('TEST'); END;
  2  /

PL/SQL procedure successfully completed.

SQL> /* Statement succeeds and the error will be logged */
SQL> INSERT into test (SELECT 1, 1 FROM dual CONNECT BY LEVEL <= 2)
  2   LOG ERRORS REJECT LIMIT UNLIMITED;

1 row(s) inserted.

SQL> select ORA_ERR_MESG$, pk1, pk2 from err$_test;

ORA_ERR_MESG$                                       PK1 PK2
--------------------------------------------------- --- ---
ORA-00001: unique constraint (VNZ.PK_TEST) violated   1   1 
```

您可以将该`LOG ERROR`子句与`INSERT ALL`（感谢[@Alex Poole](https://stackoverflow.com/users/266304/alex-poole)）一起使用，但您必须在每个表之后添加该子句：

```
SQL> INSERT ALL
  2   INTO test VALUES (1, 1) LOG ERRORS REJECT LIMIT UNLIMITED
  3   INTO test VALUES (1, 1) LOG ERRORS REJECT LIMIT UNLIMITED
  4  (SELECT * FROM dual);

0 row(s) inserted. 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-16T17:24:24.757

使用 MERGE 语句来处理这种情况：

```
merge into "ACCESS" a
using
( 
   select 68 as DADSNBR,1 as DAROLEID from dual union all
   select 68,2 from dual union all
   select 68,3 from dual union all
   select 68,4 from dual
) t 
on (t.DADSNBR = a.DADSNBR and t.DAROLEID = a.DAROLEID)
when not matched then 
  insert (DADSNBR, DAROLEID)
  values (t.DADSNBR, t.DAROLEID); 
```

# macos - Valgrind 支持 Mac OS 10.8？

> ID：13420462
> 
> 赞同：8
> 
> 时间：2012-11-16T16:23:26.303
> 
> 标签：macos, debugging, memory-leaks, malloc, valgrind

我在 Mac OS 10.8.2 中使用 valgrind 3.8.1 我使用 Homebrew 安装了 Valgrind。

但是当我尝试在我的代码上运行 valgrind 时，我从库中得到了一大堆错误，这些错误我什至没有在我的代码中使用过。

```
valgrind --leak-check=full ./a.out

==92079== 
==92079== HEAP SUMMARY:
==92079==     in use at exit: 70,861 bytes in 362 blocks
==92079==   total heap usage: 529 allocs, 167 frees, 75,151 bytes allocated
==92079== 
==92079== 16 bytes in 1 blocks are definitely lost in loss record 7 of 85
==92079==    at 0x54D7: malloc_zone_malloc (in /usr/local/Cellar/valgrind/3.8.1/lib/valgrind/vgpreload_memcheck-amd64-darwin.so)
==92079==    by 0x373381: recursive_mutex_init (in /usr/lib/libobjc.A.dylib)
==92079==    by 0x372025: _objc_init (in /usr/lib/libobjc.A.dylib)
==92079==    by 0xBB27: libSystem_initializer (in /usr/lib/libSystem.B.dylib)
==92079==    by 0x7FFF5FC13377: ImageLoaderMachO::doModInitFunctions(ImageLoader::LinkContext const&) (in /usr/lib/dyld)
==92079==    by 0x7FFF5FC13761: ImageLoaderMachO::doInitialization(ImageLoader::LinkContext const&) (in /usr/lib/dyld)
==92079==    by 0x7FFF5FC1006D: ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&, unsigned int, ImageLoader::InitializerTimingList&) (in /usr/lib/dyld)
==92079==    by 0x7FFF5FC0FFC3: ImageLoader::recursiveInitialization(ImageLoader::LinkContext const&, unsigned int, ImageLoader::InitializerTimingList&) (in /usr/lib/dyld)
==92079==    by 0x7FFF5FC0FEB9: ImageLoader::runInitializers(ImageLoader::LinkContext const&, ImageLoader::InitializerTimingList&) (in /usr/lib/dyld)
==92079==    by 0x7FFF5FC01F9D: dyld::initializeMainExecutable() (in /usr/lib/dyld)
==92079==    by 0x7FFF5FC05B03: dyld::_main(macho_header const*, unsigned long, int, char const**, char const**, char const**, unsigned long*) (in /usr/lib/dyld)
==92079==    by 0x7FFF5FC01396: dyldbootstrap::start(macho_header const*, int, char const**, long, macho_header const*, unsigned long*) (in /usr/lib/dyld)
.....
..... 
.....
.....
==92079== 
==92079== LEAK SUMMARY:
==92079==    definitely lost: 16,816 bytes in 16 blocks
==92079==    indirectly lost: 1,168 bytes in 5 blocks
==92079==      possibly lost: 4,941 bytes in 67 blocks
==92079==    still reachable: 47,936 bytes in 274 blocks
==92079==         suppressed: 0 bytes in 0 blocks
==92079== Reachable blocks (those to which a pointer was found) are not shown.
==92079== To see them, rerun with: --leak-check=full --show-reachable=yes
==92079== 
==92079== For counts of detected and suppressed errors, rerun with: -v
==92079== ERROR SUMMARY: 21 errors from 21 contexts (suppressed: 0 from 0) 
```

谁能展示如何抑制 Mac OS 10.8 的这些错误？（或者只显示我的代码的错误）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T05:11:18.623

抱歉，这不是您想听到的，但是如果您运行，`valgrind ./a.out` 您应该会看到类似于以下内容的输出

```
==18604== WARNING: Support on MacOS 10.8 is experimental and mostly broken.
==18604== WARNING: Expect incorrect results, assertions and crashes.
==18604== WARNING: In particular, Memcheck on 32-bit programs will fail to
==18604== WARNING: detect any errors associated with heap-allocated data. 
```

即使你压制了你想要压制的东西，Valgrind 也很可能不会帮助你调试你的程序。如果您愿意使用 Xcode 自带的称为 Instruments 的内存分析工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-21T18:22:58.437

`valgrind v3.9.0`解决了这个问题。尽管官方发布说明`v3.9.0`指出支持`Mac OSX 10.8`已得到改进。但它似乎也可以正常工作`Mac OSX 10.9`。

您可以在 Homebrew 上获取最新版本：

```
brew update
brew install valgrind 
```

# ruby-on-rails - Easy Rails 问题：全局用户变量？

> ID：13420466
> 
> 赞同：0
> 
> 时间：2012-11-16T16:23:49.870
> 
> 标签：ruby-on-rails, model-view-controller, global-variables

我有一堆不同的控制器，我希望能够执行标准的“欢迎，用户”。如何分配用户变量以使其可以从任何控制器进行访问？

这是我到目前为止在应用程序控制器中的内容：

```
class ApplicationController < ActionController::Base
    before_filter :authorize

  protect_from_forgery

    private

        def current_user
            User.find(session[:user_id])
        end

  protected

    def authorize
        unless User.find_by_id(session[:user_id])
            redirect_to login_url, :notice => "Please Login"
        end
    end
end 
```

这是我的 application.html.haml 文件：

```
!!!
%html
    %head
        %title Pears
        = stylesheet_link_tag    "application", :media => "all"
        = javascript_include_tag "application"
        = csrf_meta_tags
    %body
        %header
            = link_to('Home', '/')
            - if session[:user_id]
                Welcome, 
                = current_user.firstname
                = link_to('Logout', logout_path, method: :delete)
            - else
                = link_to('Login', login_path)
                = link_to('Signup', signup_path)
        = yield 
```

最好的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:38:38.670

`current_user`是一种私有方法，将其公开，您的代码可能会正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:32:35.997

如果您想要的只是能够将用户名嵌入到欢迎消息中，我可能会将其存储在会话中（作为一种优化，以防止每次都获取它），然后创建一个显示的部分

```
Hello, <%= session[:username] %> 
```

并将部分包含在您的布局中，或者您想要显示此消息的任何位置。

如果您要查找的不仅仅是用户名或类似的少量数据，部分仍然是显示它的最佳选择，但要从数据库中获取信息，请使用 before_filter 加载数据（如 MrYoshiji 所建议），可能是个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:49:45.520

通常，视图不能调用控制器方法。但是，如果您愿意，您可以允许对特定方法执行此操作，例如

```
class ApplicationController < ActionController::Base
  ...
  def current_user
    ...
  end
  helper_method :user
end 
```

用户每次是从数据库中获取还是在会话中存储了一些数据并不重要，但是您的视图不应该与该细节耦合。

在不首先了解它对性能的影响有多大的情况下，我也会对在会话中仅存储用户名作为优化稍有警惕

# scala - 使用两个 scala 库运行 scalatest 和 Maven - 一个用于 Maven，另一个用于 Scala Eclipse 插件

> ID：13420468
> 
> 赞同：2
> 
> 时间：2012-11-16T16:23:54.863
> 
> 标签：scala, maven

scala Eclipse 插件需要 scala 2.10.0 才能运行：

![在此处输入图像描述](../Images/5802a65506dc3fe938d3f7df448f5921.png)

要在 Maven 上运行“测试”目标，我需要依赖项：

```
<dependency>
    <groupId>org.scalatest</groupId>
    <artifactId>scalatest_2.9.0-1</artifactId>
    <version>2.0.M5</version>
</dependency> 
```

作为此依赖项的一部分，“scala-library-2.9.0-1.jar”也被添加到构建路径中：

![在此处输入图像描述](../Images/591a87f596c14a6617d753fbc609ec95.png)

这会导致在 Eclipse 的问题选项卡上显示错误：

> 在构建路径中找到多个 scala 库。至少有一个版本不兼容。请更新项目构建路径，使其仅包含兼容的 scala 库。

我该如何解决这个错误？我需要两个 scala 库，一个用于 scala eclipse 插件，另一个用于 scalatest maven 插件。我不想只是从问题选项卡中删除错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T21:45:25.660

> scala Eclipse 插件需要 scala 2.10.0 才能运行：

它有 2.10 和 2.9 的版本，安装 2.9.2 的版本（并使用 ScalaTest 版本 2.9.2）。或者使用 ScalaTest 的 2.10 版本，但您似乎需要在本地构建和安装它，http://mvnrepository.com/artifact/org.scalatest 中没有列出适用于 2.10.0-RC2 的[版本](http://mvnrepository.com/artifact/org.scalatest)。

# sql - 泛化一个涉及三个表的多个实例的查询 SQL

> ID：13420470
> 
> 赞同：1
> 
> 时间：2012-11-16T16:24:01.263
> 
> 标签：sql, join, statistics

我正在做一个公式来在 SQL 中进行一些统计，但我不知道如何改进我正在处理的查询......

我做了一个[sqlfiddle，所以你可以更好地理解我](http://sqlfiddle.com/#!2/d2ff6/9)

所以我有3个表，我需要解决一个改变索引的公式，i，j ...

```
i j
---
1 1
1 2
1 3
2 1
2 2
2 3
3 1
3 2
3 3 
```

然后做一些 sqrt 和 pow。我想要一个表中的结果，但我不知道如何将所有这些长查询概括为一个......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:46:21.803

这似乎只需要几个`CROSS JOIN`s：

```
SELECT  ((N.n*M1.m)-(S1.s*S2.s)) / 
               (SQRT((N.n*M2.m)-(pow(S1.s,2))) * SQRT((N.n*M3.m)-(pow(S2.s,2))))
FROM N
CROSS JOIN sums as S1
CROSS JOIN sums as S2
JOIN mults as M1
     ON M1.i = S1.i
     AND M1.j = S2.i
JOIN mults as M2
     ON M2.i = S1.i
     AND M2.j = S1.i
JOIN mults as M3
     ON M3.i = S2.i
     AND M3.j = S2.i; 
```

（我已经修改了[Fiddle](http://sqlfiddle.com/#!2/d2ff6/15)以包含这个。感谢您提供一个！）。

但是，您的整体设计对我来说有点可疑；你到底想完成什么？

# caching - 您可以强制浏览器始终获取缓存文件而不是为 304 进行往返吗？

> ID：13420471
> 
> 赞同：5
> 
> 时间：2012-11-16T16:24:01.967
> 
> 标签：caching, browser, header, http-headers, browser-cache

据我了解，这就是浏览器缓存的工作方式。假设，一个遥远的未来标头已设置为假设一年，并且 foo.js 设置为缓存。以下是一些场景：

1.  第一次访问页面，server返回200，foo.js缓存一年。

2.  下次访问时，浏览器会检查缓存，但如果 foo.js 已被修改，则必须检查服务器。如果不是，服务器返回 304 - Not Modified。

3.  用户已经在页面上（并且 foo.js 在缓存中）单击链接以转到另一个页面，浏览器查看 foo.js 的缓存版本并提供它而无需往返服务器并返回 200（缓存）。

4.  用户已经在页面上（并且 foo.js 在缓存中）并且由于某种原因点击 F5/Reload，浏览器检查缓存但必须往返于服务器并检查 foo.js 是否已被修改。如果不是，服务器返回 304。

如您所见，每当刷新页面时，它总是需要访问服务器以检查文件是否已被修改。我知道这不是很多，服务器只会返回标头信息，但在某些情况下往返时间非常重要。

问题是，有没有办法可以避免这种情况，因为我已经设置了文件的过期时间。我只是希望它始终从缓存中获取它，直到过期或用其他东西替换文件（通过版本控制）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T08:37:23.403

据我了解，按 F5/Ctrl-R 是浏览器特定的操作，因此将控件留给浏览器。

如果用户在点击另一个动作之前清除了缓存怎么办？因此，即使在 F5 中有强制使用缓存的 HTTP 规范，也不能保证您能够满足您的需求。

只需配置和编码以尽可能多地缓存，其余的留给用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T08:53:32.527

看起来，当您导航到一个页面（即在 URL 栏中输入地址或单击链接）时，会从缓存中获取资源，而无需向服务器发送 HEAD 请求。但是当您刷新页面时，它会执行 HEAD 请求和 RTT。

这在 IE 的开发者工具的网络选项卡中看起来更清楚。如果您看到 initator 列，它表示`navigate`第一种情况和`refresh`for `CTRL+R`or `F5`。

您可以通过在它们上添加事件侦听器并执行 a来覆盖`F5`and行为并阻止默认行为或类似的行为。这将导致页面导航而不是刷新。`CTRL+R``window.location = window.location``event.peventDefault`

另外，我没有测试缓存资源在服务器上实际发生变化的情况。如果这被证明是一个问题，您可以通过资源的版本编号和生成带有指向最新版本资源的 URL 的 HTML 来解决它（有点像 HTML5 离线应用程序的缓存清单问题）。

编辑：但是，如果用户单击浏览器的刷新按钮，这并不能解决问题；`onbeforeunload`在这种情况下，事件可能会有所帮助。

# c++ - VS2010 C++ 中的 Resource.h 编辑不适用于 anhksvn

> ID：13420473
> 
> 赞同：1
> 
> 时间：2012-11-16T16:24:04.943
> 
> 标签：c++, visual-studio-2010, svn, ankhsvn

我试图弄清楚为什么 anhksvn 正在破坏 Visual C++ 中资源的编辑。文件 resource.h 和 project.rc 被标记为 svn:needs-lock 因为它们不容易被合并。编辑资源时 anhksvn 正确要求锁定两个文件并且编辑很好。然而，当编辑被保存时，resource.h 被标记为“新”而不是“修改”。

当然，在存储库中完全相同的位置已经有一个现有的 resource.h 文件，所以在提交时它会失败，说该文件已经存在。工作副本中的文件本身是完全有效的，并且可以毫无问题地编译。我找到的唯一解决方案是复制resource.h，删除文件并更新以取回旧文件，然后复制新文件并提交，尽管这是一个巨大的痛苦，但它工作正常。

我试图弄清楚为什么会这样。SVN 知道该文件存在并且可以正常运行。但是，由于某种原因，有时它认为当资源编辑器保存在 resource.h 上时，该文件永远不存在并且必须添加，即使它知道该文件存在于任何提交操作中。

编辑：我最终发现问题出在文件盒上。该项目有Resource.h，但文件实际上是resource.h。由于 Windows 中的文件大小写被忽略，Visual Studio 可以使用它。但是，当 VS2010 保存 resource.h 文件时，它会将正确的文件大小写传递给 anhksvn，并且它认为添加了一个新文件 Resource.h。当它检查它看到resource.h的实际文件时，anhksvn看到它已经被添加，因此不能再次添加。我不得不复制resource.h，在SVN下重命名文件然后删除它。然后我重命名了副本 resource.h 并将其再次添加到项目中。然后该项目的文件大小写正确，问题得到解决。

# wcf - WCF WebGet 被防火墙阻止

> ID：13420475
> 
> 赞同：0
> 
> 时间：2012-11-16T16:24:08.207
> 
> 标签：wcf, wcf-data-services

我有一个带有 [WebGet] 方法的 WCF 数据服务。发送到服务的 url 看起来像

```
http://example.com/MyMethod?param='test' 
```

但由于参数被单引号括起来，我的防火墙阻止传入请求，说这是一次 SQL 注入攻击尝试。

将单引号编码为 %27 也不起作用。

有没有办法在 WCF 中的查询参数值周围包含单引号？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:44:37.380

您正在使用`RESTFul`服务。

例如：如果方法如下

```
[OperationContract]
[WebGet(UriTemplate = "{param}")]
void MyMethod(string param); 
```

然后你可以直接使用`url`下面的类似而不用单引号。

```
http://example.com/MyMethod?param=test 
```

或者

```
http://example.com/MyMethod/param=test 
```

# mysql - MySql：插入行时的事务安全

> ID：13420491
> 
> 赞同：0
> 
> 时间：2012-11-16T16:24:54.980
> 
> 标签：mysql, sql, transactions, sqltransaction

我想执行以下两个 MySQL 语句：

```
1) SELECT * FROM table1 WHERE field1=val1 FOR UPDATE;
2) UPDATE table1 SET field2=val2 WHERE field1=val1; 
```

重要的是，第二个语句准确地更改了第一个语句返回的行（没有额外的行，也没有更少的行）。因此，我使用 auto_commit=false 执行事务并使用 select 语句的“for update”版本。

“For Update”会锁定它返回的所有行，因此在执行第二条语句时它们处于原始状态。但是插入呢？是否有可能另一个线程插入一个新行，其间有 field1=val1，然后被第二条语句更改？

还有一个问题：如果第二条语句不改变行本身，但执行以下操作，是否会有所不同？

```
3) INSERT INTO table2 (SELECT * FROM table1 WHERE field1=val1) 
```

如果（3）与（1）在同一个事务中，那么确保两个选择返回完全相同的元素吗？

**编辑：**

我正在使用 InnoDB 并且我阅读了一些关于下一个键锁定和间隙锁定的内容。据我了解，在执行（1）时，InnoDB 不仅会锁定选定的行，还会锁定访问的索引。

那么我是否可以说如果我在列“field1”上有一个索引就不会发生这个问题？如果没有索引怎么办？那不一样了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:56:23.727

我不能完全谈论 mySQL 案例，但我对此表示怀疑。`SELECT FROM ... FOR UPDATE`（似乎）要做的唯一一件事是防止*其他*事务[修改给定的一组行](http://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html)。它不限制未来的语句 - 如果在该`UPDATE`语句运行之前（由另一个事务）插入另一行，它也会被更新。
不用说，您给出的第三个陈述也将成为同一问题的牺牲品。

你想在这里实际做什么？可能还有另一种方法可以实现这一点。例如，如果有某种“insertedAt”时间戳，您可能只需将其添加为额外条件。

# firefox - 一次搜索多个标签

> ID：13420494
> 
> 赞同：2
> 
> 时间：2012-11-16T16:25:09.607
> 
> 标签：firefox, google-chrome

我希望在我的公司为代表创建一个 ubersearch。我需要能够一次搜索多个应用程序，每个选项卡一个。

这方面的例子是：

*   合流
*   雾虫
*   知识库。

我真的只是在寻找一种将搜索条件发送到大约五个选项卡并一次提交的方法。

# android - 在 Eclipse 中扩展 Android 类

> ID：13420495
> 
> 赞同：0
> 
> 时间：2012-11-16T16:25:18.727
> 
> 标签：android, eclipse

据我所知，Eclipse 仅支持为 Android 中极少数的类扩展（例如`Activity`）制作“骨架代码”。如果我想扩展`TextView`,`Fragment`等。我必须完全从头开始并提供我*自己的*骨架代码。

这是真的，还是我在 Eclipse 中遗漏了一些为各种类扩展创建骨架代码的简单内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:32:18.637

如果通过骨架代码您的意思是覆盖超类中的方法，请尝试以下操作：

在包资源管理器中，右键单击类，转到`Source`选项卡并选择`Override/Implement Methods...`. 这将列出您可以覆盖和实现的方法。

或者，转到现有方法之外的类编辑器中的新行，然后按 调`control + space`出可以覆盖的方法列表。当只覆盖一个或两个方法时，这会更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:29:14.980

`Activity`从 Eclipse 向导创建新类之间或`TextView`创建新类时没有区别。

默认情况下，所有需要实现的方法都将自动生成（构造函数、抽象方法、接口的方法）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T16:32:44.047

假设你的类扩展了 TextView。

Eclipse 将要求您覆盖类中的某些必需方法。

如果你想覆盖一些额外的方法。右键单击类名`TextView`。转到源并选择`Override/Implement methods`。然后在自己的类中选择要覆盖的方法。

# php - PHP从另一个列表中删除一个列表中的字符

> ID：13420496
> 
> 赞同：1
> 
> 时间：2012-11-16T16:25:23.900
> 
> 标签：php, list, special-characters

我有一个由 分隔的特殊字符列表`|`，可以说`$chars = "@ | ; | $ |";`

我有一个字符串，比方说`$stringToCut = 'I have @ list ; to Cut';`

`$stringToCut`我想从`$chars`.

我该怎么做？

提前谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:36:04.433

我会将要删除的字符列表转换为数组并使用`str_replace`：

```
$chars_array = explode($chars);
// you might need to trim the values as I see spaces in your example

$result = str_replace($chars_array, '', $stringToCut); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:33:09.287

用于`preg_replace()`删除

```
<?php
$chars = "@ | ; | $ |";

$stringToCut = 'I have @ list ; to Cut';
$pattern = array('/@/', '/|/', '/$/', '/;/');
$replacement = '';
echo preg_replace($pattern, $replacement, $stringToCut);

?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T16:37:48.467

好的，而不是使用正则表达式，只需分解字符列表：

```
$chars = explode('|',str_replace(' ','','@ | ; | $ |'));//strip spaces, make array
echo str_replace($chars,'',$string); 
```

`str_replace`接受一个数组作为第一个和/或第二个参数，也[请参阅文档](http://be1.php.net/str_replace)。
这使您可以用不同的对应物替换每个字符，或者（就像我在这里所做的那样）将它们全部替换为空（也就是删除它们）。

# c# - 比较 SqlCommand 中的 DateTime

> ID：13420497
> 
> 赞同：1
> 
> 时间：2012-11-16T16:25:37.807
> 
> 标签：c#, .net, datetime, sqlcommand

我有一个简单`SqlCommand`的方法，我想返回指定日期时间范围内的所有记录。（包括日期和时间）

```
var dataReader = new SqlCommand(
    @"Select RecordID from RecordTable
    where RecordTable.WorkingDT between '"+ _startDt +"' and '"+ _endDt +"'",
    _sqlConnection).ExecuteReader(); 
```

如何设置和的`_startDt`值`_endDt`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T17:08:55.513

你可以试试这个：

```
var dataReader = new SqlCommand(
    @"Select RecordID from RecordTable
    where RecordTable.WorkingDT between '"+ _startDt.ToString("yyyy-MM-dd HH:mm:ss") +"' and '"+ _endDt.ToString("yyyy-MM-dd HH:mm:ss") +"'",
    _sqlConnection).ExecuteReader(); 
```

DateTime的类型`_startDt`和位置。`_endDt`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T17:16:15.917

如果将它们作为适当的参数添加到命令中，则无需担心格式化。养成使用这些习惯的额外好处是，当您将字符串作为参数提供时，您不必担心 SQL 注入。

看看[http://www.csharp-station.com/Tutorial/AdoDotNet/lesson06](http://www.csharp-station.com/Tutorial/AdoDotNet/lesson06)

它显示了如何在查询中使用参数。我不认为它需要完全拼写出来。

一个例子（从网站复制/粘贴）：

```
// 1\. declare command object with parameter
SqlCommand cmd = new SqlCommand(
    "select * from Customers where city = @City", conn);

// 2\. define parameters used in command object
SqlParameter param  = new SqlParameter();
param.ParameterName = "@City";
param.Value         = inputCity;

// 3\. add new parameter to command object
cmd.Parameters.Add(param);

// get data stream
reader = cmd.ExecuteReader(); 
```

是的，定义参数可以比每个参数 3 行更短。但这留给读者。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T17:43:50.670

@kmatyaszek，虽然常用，但不能保证 SQL 服务器明确解析“yyyy-mm-dd HH:mm:ss”日期格式。如果您必须从连接字符串创建 SQL（在这种情况下不是必要的，正如 René 所示），那么您应该使用 ISO8601 格式，它是相同的，但中间有一个 T：“yyyy-mm-ddTHH:mm:ss ”。

[http://msdn.microsoft.com/en-us/library/ms190977%28v=sql.90%29.aspx](http://msdn.microsoft.com/en-us/library/ms190977%28v=sql.90%29.aspx)

> “使用 ISO 8601 格式的优势在于它是一个国际标准。此外，使用此格式指定的日期时间值是明确的。此外，此格式不受 SET DATEFORMAT 或 SET LANGUAGE 设置的影响。”

为了演示为什么，试试这个可重新运行的 Sql 脚本。

```
if object_id('tempdb..#Foo') is not null drop table #Foo;
create table #Foo(id int, d datetime)

-- Intend dates to be 12th Jan.
set dateformat ymd
insert into #Foo(id, d) values (1, '2012-01-12 01:23:45')   -- ok
insert into #Foo(id, d) values (2, '2012-01-12T01:23:45')   -- ok
set dateformat ydm
insert into #Foo(id, d) values (3, '2012-01-12 01:23:45')   -- wrong!
insert into #Foo(id, d) values (4, '2012-01-12T01:23:45')   -- ok

select * from #Foo order by id

if object_id('tempdb..#Foo') is not null drop table #Foo; 
```

# android - Android - 调用相同 DatePicker 的两个按钮必须单击两次才能工作

> ID：13420498
> 
> 赞同：2
> 
> 时间：2012-11-16T16:25:37.790
> 
> 标签：android, android-button, android-datepicker

我有一个带有两个按钮的活动，它们调用相同的 DatePicker。我的活动必须处理日期间隔。一个按钮用于设置“开始”日期，另一个按钮用于设置“结束”日期。

就在活动的 onCreate 之后，如果我单击我想要的任何按钮，它运行良好：它正确调用 DatePicker 并且运行顺利。如果我单击肯定按钮，它会按预期完成所有工作，但是如果我想再次调用 datePicker，我必须单击两次，因为第一次单击按钮时它什么也不做。

所以，总结一下：

*   单击一个按钮；它运作良好
*   点击否定按钮；一切都按预期工作
*   再次点击；再次它工作正常
*   点击正面按钮；有用
*   单击一个按钮（两个按钮中的任何一个）；除了在按下状态下短暂显示按钮外什么都不做
*   再次点击；它按预期工作

这是我的代码：

公共类 MyActivity 扩展 ListActivity{

```
private int mYear;
private int mMonth;
private int mDay;

private Date fromDate, toDate;

private Button fromBtn, toBtn;
Calendar cal;

DatePickerDialog datePicker;

static final int DATE_DIALOG_ID = 0;

private int pressedBtn=-1; // 0=from & 1=to

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.myLayout);

    cal = Calendar.getInstance();
    mYear = cal.get(Calendar.YEAR);
    mMonth = cal.get(Calendar.MONTH);
    mDay = cal.get(Calendar.DAY_OF_MONTH);
    cal.add(Calendar.MONTH, +1);
    this.toDate = cal.getTime();
    cal.add(Calendar.MONTH, -2);
    this.fromDate = cal.getTime();

    SimpleDateFormat dateFormat = new SimpleDateFormat("dd-MM-yyyy");
    fromBtn = (Button) findViewById(R.id.frombtn);
    fromBtn.setText(dateFormat.format(fromDate));
    toBtn = (Button) findViewById(R.id.tobtn);
    toBtn.setText(dateFormat.format(toDate));

    datePicker = new DatePickerDialog(this, mDateSetListener, mYear, mMonth, mDay);
    updateDisplay();
}

public void setData(View target) {

    switch(target.getId()) {
    case R.id.frombtn:
        pressedBtn = 0;
        cal.setTime(fromDate);
        break;
    case R.id.tobtn:
        pressedBtn = 1;
        cal.setTime(toDate);
        break;
    }

    mYear = cal.get(Calendar.YEAR);
    mMonth = cal.get(Calendar.MONTH);
    mDay = cal.get(Calendar.DAY_OF_MONTH);

    datePicker.updateDate(mYear, mMonth, mDay);

    showDialog(DATE_DIALOG_ID);
}

@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {
    case DATE_DIALOG_ID:
        return datePicker;
    }
    return null;
}

private DatePickerDialog.OnDateSetListener mDateSetListener =
    new DatePickerDialog.OnDateSetListener() {

    public void onDateSet(DatePicker view, int year, int monthOfYear, int dayOfMonth) {
        mYear = year;
        mMonth = monthOfYear;
        mDay = dayOfMonth;
        updateDisplay();
    }
};

private void updateDisplay() {

    Date date = new Date(mYear-1900, mMonth, mDay);
    SimpleDateFormat dateFormat = new SimpleDateFormat("dd-MM-yyyy");

    if(this.pressedBtn==0) {
        this.fromDate = data;
        daBtn.setText(dateFormat.format(fromDate));
    }
    else if(this.pressedBtn==1){
        this.toDate = data;
        aBtn.setText(dateFormat.format(toDate));
    }
    toDate.setHours(23);
    toDate.setMinutes(59);
    toDate.setSeconds(59);
    fromDate.setHours(0);
    fromDate.setMinutes(0);
    fromDate.setSeconds(0);

    //riparte storico
    progDialog = ProgressDialog.show(MyActivity.this, "", "Doing stuff with dates...", true, true);
    Thread thrd = new Thread()
    {
        public void run() {

            ...

        }
    };
    thrd.start();
} 
```

}

这是布局：

```
<Button
   android:id="@+id/frombtn"
   android:layout_width="100dp"
   android:layout_height="wrap_content"
   android:background="@drawable/textedit_state"
   android:onClick="setData" />

<Button
   android:id="@+id/tobtn"
   android:layout_width="100dp"
   android:layout_height="wrap_content"
   android:background="@drawable/textedit_state"
   android:onClick="setData" /> 
```

我认为这与焦点冲突，但我使用了

机器人：可聚焦=“假”

和

安卓：focusableInTouchMode = “假”

两个按钮。我在视图中没有任何其他可点击的项目...

我什至尝试为按钮制作两种不同的方法，两个不同的选择器和两个不同的 onDateSetListener；什么也没有变！

对不起，如果我不是很清楚，但我是意大利人......

所以，提前感谢您的每一个帮助！

# php - 将php查询结果存储到数组中

> ID：13420501
> 
> 赞同：3
> 
> 时间：2012-11-16T16:25:39.597
> 
> 标签：php, sql, arrays

我知道这可能会很愚蠢，但我很沮丧没有找到解决方案。我去：我有一个包含玩家的表，我想将玩家存储到一个数组中，如下所示：

```
Array ( [0] => player1 [1] => player2 [2] => player3) 
```

现在我从下面的代码中得到的是：

```
Array ( [0] => Array ( [player] => player1 ) [1] => Array ( [player] => player2 ) [2] =>   Array ( [player] => player3 )) 
```

因此，我将这个额外的层放入名为“player”的数组中，这是我从中选择的列字段的名称。如何调整我的代码？

```
$query_players="SELECT player FROM `whiteboard_games` WHERE id='$id'";
$result = mysql_query($query_players) or die;
$players = array();
while($row = mysql_fetch_assoc($result))
{ $players[] = $row; } 
```

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T16:27:47.990

有很多方法可以处理这个问题。如果你只有一列，而不是附加整个`$row`，最直接的就是附加你想要的列：

```
while($row = mysql_fetch_assoc($result))
{
  // Append only the `player` column rather than the whole $row (which is an array)
  $players[] = $row['player'];
}
var_dump($players); 
```

如果您已经拥有多维数组并且需要将其展平，则可以使用循环来实现；

```
$players_flattened = array();
foreach ($players as $p) {
  $players_flattened[] = $p['player'];
}
// Or via array_map()
$players_flattened = array_map(function($p){ return $p['player']; }, $players); 
```

注意：我们假设您已经`$id`在查询中进行了过滤和验证，以防止 SQL 注入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:30:07.883

仅将键的值添加`player`到数组`$players`中，

```
 while($row = mysql_fetch_assoc($result)) {
   $players[] = $row['player']; 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:35:28.067

```
$players = array();
while($row = mysql_fetch_assoc($result)) 
{ 
  $players[] = $row['player'];
} 
echo "<pre>";
print_r($players); 
```

# php - Yii-1.1.12 框架，使用另一个控制器

> ID：13420506
> 
> 赞同：-1
> 
> 时间：2012-11-16T16:25:52.000
> 
> 标签：php, yii

我尝试使用 yii 框架制作网站，并制作友好的网址。如果我使用友好的网址，例如：

```
http://localhost/eshops/     -> calls protected/controllers/SiteController->actionIndex()
http://localhost/eshops/login -> calls protected/controllers/SiteController->actionLogin()
http://localhost/eshops/logout -> calls protected/controllers/SiteController->actionLogout()
 ... 
```

但是如何使用另一个控制器 AbcController

```
http://localhost/eshops/abc/a -> calls protected/controllers/AbcController->actionA()
http://localhost/eshops/abc/b -> calls protected/controllers/AbcController->actionB() 
```

它不显示“错误404”？

.htaccess 是

```
Options +FollowSymLinks
IndexIgnore */*
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php 
```

规则在 protected/config/main.php

```
'urlManager'=>array(
    'urlFormat'=>'path',
    'showScriptName'=>false,
    'caseSensitive'=>false,
    'rules'=>array(
        'gii'=>'gii',
        '<action>'=>'site/<action>',
        '<controller:\w+>/<id:\d+>'=>'<controller>/view',
        '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
        '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
    ),
), 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T16:38:48.277

您需要记住执行规则的顺序！您只需要设置正确的规则顺序

```
'rules'=>array(
        'gii'=>'gii',
        '<controller:\w+>/<id:\d+>'=>'<controller>/view',
        '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
        '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
        '<action:(login|logout|register|contact)>' => 'site/<action>',
//      or full access 
//      '<action:\w+>' => 'site/<action>',
    ), 
```

# ruby-on-rails - Rails：编辑/更新记录，用当前记录字段条目填充文本字段

> ID：13420507
> 
> 赞同：2
> 
> 时间：2012-11-16T16:25:54.470
> 
> 标签：ruby-on-rails, forms, controller, helpers

我有一个存储酱汁细节的程序。基本上，当我进入编辑表单时，我正在做我应该做的所有事情，id 已成功通过，但是所有表单字段都保持为空，而不是显示数据库中已经存在的值。

在我的控制器中：

```
def edit 
 @sauce = Sauce.find(params[:id])
 @pagetitle = "Edit #{@sauce.name} Sauce"
end

def update
 # Find object using form parameters
 @sauce = Sauce.find(params[:id])
 # Update the object
 if @sauce.update_attributes(params[:page])
   # If update succeeds, redirect to the list action
   flash[:notice] = "Sauce updated."
   redirect_to(:action => 'list')
 else
   # If save fails, redisplay the form so user can fix problems
   render('edit')
 end 
```

形式部分：

```
<%= error_messages_for(@sauce) %> 
 <table summary="Sauces Form Fields">
  <tr>
   <th><%= f.label(:name,"Sauce Name") %></th>
   <td><%= f.text_field(:name) %></td>
  </tr>
  <tr>
   <th><%= f.label(:description, "Description") %></th>
   <td><%= f.text_area(:description, :size => '40x5') %></td>
  </tr>
  <tr>
   <th><%= f.label(:heat_level, "Heat Level") %></th>
   <td><%= f.select(:heat_level,{ 1 => "1", 2 => "2", 3 => "3", 4 => "4", 5 => "5"}) %></td>
  </tr>
  <tr>
   <th><%= f.label(:pic_url, "Picture URL") %></th>
   <td><%= f.text_field(:pic_url) %></td>
  </tr>
  <tr>
   <th><%= f.label(:title_colour, "Title Colour") %></th>
   <td><%= f.text_field(:title_colour) %></td>
  </tr>
  <tr>
   <th><%= f.label(:description_colour, "Desc Colour") %></th>
   <td><%= f.text_field(:description_colour) %></td>
  </tr>
 </table> 
```

我的edit.html.erb

```
<%= form_for(:subject, :url => {:action => 'update', :id => @sauce.id}) do |f| %>
<%= render(:partial => "form", :locals => {:f => f}) %>  
<%= submit_tag("Update Subject") %>
<% end %> 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:32:26.183

错误是`form_for(:subject)`。如果您希望 Rails 正确填写表格，您需要使用与实例变量相同的符号，或者只使用实例变量。试试这个：

```
<%= form_for(@sauce, :url => {:action => 'update', :id => @sauce.id}) do |f| %> 
```

# sql - 检查字段是否为数字，然后仅对一条语句中的那些字段执行比较？

> ID：13420508
> 
> 赞同：16
> 
> 时间：2012-11-16T16:25:55.247
> 
> 标签：sql, sql-server-2008, tsql, comparison

这可能很简单，但我不是 SQL 专家，所以我迷路了。我了解 sql 获取您的查询并按特定顺序执行它，我相信这就是为什么此查询不起作用的原因：

```
select * from purchaseorders
where IsNumeric(purchase_order_number) = 1
and cast(purchase_order_number as int) >= 7 
```

大多数 purchar_order_number 字段是数字的，但我们最近引入了字母数字字段。我试图获取的数据是查看“7”是否大于最高数字 purchase_order_number。

Numeric() 函数可以很好地过滤掉字母数字字段，但是进行后续的强制转换比较会引发此错误：

```
Conversion failed when converting the nvarchar value '124-4356AB' to data type int. 
```

我不是在问错误是什么意思，这很明显。我在问是否有一种方法可以在单个查询中完成我想要的，最好是在 where 子句中，因为 ORM 约束。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-16T16:45:58.797

这对你有用吗？

```
select * from purchaseorders
where (case when IsNumeric(purchase_order_number) = 1
       then cast(purchase_order_number as int)
       else 0 end) >= 7 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:30:05.783

您可以使用子选择进行选择

```
select * from (
select * from purchaseorders
where IsNumeric(purchase_order_number) = 1) as correct_orders
where cast(purchase_order_number as int) >= 7 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-15T16:26:34.887

尝试这个：

```
select * from purchaseorders
where try_cast(purchase_order_number as int) >= 7 
```

# c# - 如何使用 fileupload 读取两次文件

> ID：13420511
> 
> 赞同：1
> 
> 时间：2012-11-16T16:26:01.063
> 
> 标签：c#, asp.net

我正在尝试两次读取同一个文件。

我一直在使用 a`FileUpload`来查找文件。我在第一次阅读时成功了，我使用 C# ans asp.net 中的下一个代码找出文件有多少行：

```
Stream data_file;
data_file=FileUpload1.PostedFile.InputStream;
string line;
int elements;
StreamReader sr = new StreamReader(data_file);
line = sr.ReadLine();
while (line != null)
{
elements = elements + 1;
line = sr.ReadLine();
}
sr.Close(); 
```

有了这个数字，我现在可以通过设置数组要容纳多少个元素来创建一个数组数组。这次的数组将保存文件中的数字，如下所示：

数据文件：

1,1

2,3

数组L[0][0]=1

数组L[0][1]=1

数组L[1][0]=2

数组L[1][0]=3

所以执行此操作的代码是下一个：

```
double [][] dime= new double [elements][];
string[] div;
string line2;
int nn=0;
StreamReader ssr = new StreamReader(data_file);
line2 = ssr.ReadLine();
while (line2 != null)
{
dimen[nn] = new double[2];
for (int m2 = 0; m2 < 2; m2++)
{
div=line2.Split(new Char[] { ' ', ',', '\t' });
dimenc[nn][m2] = Convert.ToDouble(div[m2]);
}
nn=nn+1;
line2 = ssr.ReadLine();
}
ssr.Close(); 
```

但是，数组说它是空的，但我知道我是否在完全不同的方法/第二个按钮中使用了代码的第二部分，但如果它使用相同的方法它不起作用，所以我的问题是：

怎么了？为什么第二个流媒体阅读器不工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:48:41.460

实际上@NLemay 评论可能是更好的解决方案。

但是如果有人需要两次读取上传的文件，您需要将文件缓存在内存中。将流读入 a`byte[]`或 a`MemoryStream`然后从中工作您的流阅读器。你会发现这`HttpPostedFile.InputStream.CanSeek`是错误的，这就是你想要做的。

对于一个`byte[]`：

```
HttpPostedFile uFile = uploadFile.PostedFile;

byte[] data = new byte[uFile.ContentLength];
uFile.InputStream.Read(data, 0, uFile.ContentLength); 
```

`MemoryStream`查找CopyStream[方法](https://stackoverflow.com/questions/230128/best-way-to-copy-between-two-stream-instances)。

# c# - 动态分析 - CLR 探查器？

> ID：13420513
> 
> 赞同：1
> 
> 时间：2012-11-16T16:26:20.253
> 
> 标签：c#, .net, profiling, dynamic-analysis

我对此有点陌生，需要确认，MS CLR Profiler，它是动态分析工具吗？它是否能够找到一些内存泄漏，或者为此我需要更复杂的工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:39:10.273

我个人对用于内存泄漏诊断的 ANTS 内存分析器非常满意。据我所知，MS CLR Profiler 被认为已经过时，微软为此创建了新工具。

性能视图

*   [Perfview 发布公告](http://blogs.msdn.com/b/vancem/archive/2011/12/28/publication-of-the-perfview-performance-analysis-tool.aspx)
*   [下载链接](http://www.microsoft.com/en-us/download/details.aspx?id=28567)
*   [教程](http://channel9.msdn.com/Series/PerfView-Tutorial)

# ios - 为什么 MFMailComposeViewController 返回 MFMailComposeResultFailed？

> ID：13420514
> 
> 赞同：3
> 
> 时间：2012-11-16T16:26:29.057
> 
> 标签：ios, mfmailcomposeviewcontroller, email-attachments

我在我的应用程序中遇到了一个奇怪的问题，我需要你的帮助！
我正在使用 MFMailComposeViewController 发送带有附件数据的电子邮件。附件是 PDF、CSV 或 XLS 文件。ZIP 文件也可以添加到邮件中。

在大多数情况下一切正常，但有时（实际上很常见），当附件是 XLS 并添加了 ZIP 时，我收到多个内存警告并且作曲家返回 MFMailComposeResultFailed，并出现一个根本没有帮助的错误（只说代码错误 1，“操作无法完成。（MFMailComposeErrorDomain 错误 1.）”）。

我的问题是它为什么这样做？我假设内存警告告诉我一些事情没有得到很好的管理，但我不知道是什么......

这是我发送电子邮件的代码

```
-(void) sendMail {

    MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init]; 
    [self prepareMailPicker:picker];

    NSString *filePath = [self getFilePath:pType];

    NSString *zipFile = [self getZipPath];

    NSString *mimeType;
    int userPhoto = [User getCSVPhoto];

    switch (pType) {
        case EPDF:
            mimeType = @"application/pdf";
            userPhoto = [User getPDFPhoto];
            break;
        case ECSV:
            mimeType = @"text/csv";
            break;
        case EExcel:
            mimeType = @"application/vnd.ms-excel";
            break;

        default:
            break;
    }

    NSData *attachmentData = [NSData dataWithContentsOfFile:filePath];
    [picker addAttachmentData:attachmentData mimeType:mimeType fileName:[filePath lastPathComponent]];

    if (userPhoto == 1 && shouldAddZip) {
        NSData *zipData = [NSData dataWithContentsOfFile:zipFile];
        [picker addAttachmentData:zipData mimeType:@"application/zip" fileName:[zipFile lastPathComponent]];
    }

    shouldAddZip = NO;

    [self presentModalViewController:picker animated:YES];
}

-(void) prepareMailPicker:(MFMailComposeViewController*)picker {

    picker.mailComposeDelegate = (id<MFMailComposeViewControllerDelegate>)self;

    picker.navigationBar.tintColor = grayDark;

    [picker setSubject:[TextManager textForKey:@"EMAIL_SUBJECT"]];

    NSString *email = [[User currentUser] getEmail];

    if (email && ![email isEqualToString:@""])
        [picker setToRecipients:[NSArray arrayWithObject:email]];

    NSString *emailBody = [TextManager textForKey:@"EMAIL_TEXT"];
    [picker setMessageBody:emailBody isHTML:YES];
} 
```

任何帮助将不胜感激！

编辑：正如@matt 所问，这里有一个日志来证明没有设置为 nil ：

```
filePath : /var/mobile/Applications/A57F5CD2-E3FE-4417-8810-D746A22CF434/Documents/iNdF_Export_2012-11-19.xls
zipFile : /var/mobile/Applications/A57F5CD2-E3FE-4417-8810-D746A22CF434/Documents/iNdF_recus_2012-11-19.zip
attachmentData : (NSConcreteData *) <0x1d9c3c20> 53 874 bytes
zipData : (NSConcreteData *) <0x1f989100> 6 838 456 bytes 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T06:38:12.277

正如您所说，鉴于您收到的内存警告，问题似乎很可能与内存管理有关。

您的代码保留了对第一个文件的 attachmentData 的引用计数，即使它出去获取第二个文件的 zipData 也是如此。在内部，选择器可能正在复制该数据……</p>

因此，您越能尽早释放对大数据的引用，就越有可能不会收到内存警告。

如果问题是由于内存不足导致选择器无法完成附件，并且您可以通过提前释放来解决它，那么按照以下方式分解代码可能会对您有所帮助。

```
- (void)sendMailPicker:(MFMailComposeViewController*)picker addAttachmentUsingMimeType:(NSString*)mimeType {
    NSString *filePath = [self getFilePath:pType];
    NSData *attachmentData = [NSData dataWithContentsOfFile:filePath];
    [picker addAttachmentData:attachmentData mimeType:mimeType fileName:[filePath lastPathComponent]];
}

- (void)sendMailAddPhotoUsingPicker:(MFMailComposeViewController*)picker {
    NSString *zipFile = [self getZipPath];
    NSData *zipData = [NSData dataWithContentsOfFile:zipFile];
    [picker addAttachmentData:zipData mimeType:@"application/zip" fileName:[zipFile lastPathComponent]];
}

- (void)sendMail {

    MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init]; 
    [self prepareMailPicker:picker];

    NSString *mimeType;
    int userPhoto = [User getCSVPhoto];

    switch (pType) {
        case EPDF:
            mimeType = @"application/pdf";
            userPhoto = [User getPDFPhoto];
            break;
        case ECSV:
            mimeType = @"text/csv";
            break;
        case EExcel:
            mimeType = @"application/vnd.ms-excel";
            break;

        default:
            break;
    }

    [self sendMailPicker:picker addAttachmentUsingMimeType:mimeType];
    if (userPhoto == 1 && shouldAddZip) {
        [self sendMailAddPhotoUsingPicker:picker];
    }

    shouldAddZip = NO;

    [self presentModalViewController:picker animated:YES];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T06:47:32.170

我猜这个问题与内存有关，当您创建 NSData 时，您会在堆中创建。如果它太大，您将开始收到内存警告。避免内存的一种方法是创建内存映射的 NSData 或 NSStream，但我不知道如何将 NSStream 集成到邮件编写器中。您的附件的平均大小是多少？
您还可以尝试使用分配来分析您的应用程序，以查看您的应用程序的内存占用量，可能已经太高了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T07:23:01.830

就像我之前遇到的一些问题一样。1\. 请使用“Reachability”类文件检查是否有 Internet 可用性。2\. 请检查您的数据大小是否在限制范围内。3\. 请检查您使用您的设备配置了您的电子邮件 ID。你也可以调用[yourobj cansendmail]函数来检查它是否可以发送邮件。

# ajax - Drupal Ajax Form Ajax Form 拉取两种不同的视图

> ID：13420515
> 
> 赞同：0
> 
> 时间：2012-11-16T16:26:32.577
> 
> 标签：ajax, forms, drupal, views, drupal-views

我有两个不同的视图需要在节点页面上切换。我无法将这两个视图放在一起，所以我创建了一个表单，它基本上将采用我创建的表单的值，并将它们作为参数发送到视图并显示视图。我正在尝试使用这个 ajax。它工作正常，但问题是我第二次运行表单时它不会刷新或更新该视图。

```
 function photoflight_albums() {
        photoflight_gallery_themes();
      $output = render(drupal_get_form('photoflight_gallery_form'));
      $output .= "<div id='gallery-ajax-wrapper'>";
      $output .= views_embed_view('gallery', 'default');
      $output .= "</div>";

      return $output;

    }

    //Grabs the node titles
    function photoflight_gallery_themes(){
        $type = "photo_theme"; 
        $theme_list = array();
        $nodes = node_load_multiple(array(), array('type' => $type)); 
        foreach($nodes as $themes){
            $theme_list[$themes->title] = $themes->title;
        }
        return $theme_list;
    }

//Form calls back to the function above to the gallery-ajax-wrapper div output above
    function photoflight_gallery_form($form, &$form_state){
        $form = array();

      $form['themes'] = array(
        '#type' => 'select',
        '#options' => array(photoflight_gallery_themes()),
        '#ajax' => array(
                'callback' => 'photoflight_simplest_callback',
                'wrapper' => 'gallery-ajax-wrapper',
            ),
      );
      //debug($form);
      return $form;
    }

    //Ajax callback
    function photoflight_simplest_callback($form, $form_state) {
        $view = views_get_view('gallery');
        $args = array( 'title' => $form_state['values']['themes']);
        $view->set_exposed_input($args);
        $output = $view->preview('default', $args);
        return array("#markup" => $output);

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:13:50.583

问题在于它正在删除 HTML 元素，因此第二次调用没有要替换的 HTML。更改为使用 ajax 更新或在回调中再次将返回值包装在 div 中

```
function photoflight_simplest_callback($form, $form_state) {
    $view = views_get_view('gallery');
    $args = array( 'title' => $form_state['values']['themes']);
    $view->set_exposed_input($args);
    $output = '<div id="gallery-ajax-wrapper">';
    $output .= $view->preview('default', $args);
    $output .= '</div>';
    return array("#markup" => $output);

} 
```

# bash - SGE 上的非法变量名，但不是本地的。

> ID：13420516
> 
> 赞同：1
> 
> 时间：2012-11-16T16:26:35.273
> 
> 标签：bash, sungridengine

我有一个运行 samtools mpileup 的简短 bash 脚本。它在本地运行良好，但是当我尝试在 SGE 上运行它时，我收到“非法变量名”反馈。

```
#!/bin/bash
for f in $(find /bed_files  -name '*.bed' )
do 
name=$(echo $f | awk 'gsub("/", "_")')
name2=$(echo $name | awk 'gsub("_bed_files_", "")')
name3=$(echo $name2 | awk 'gsub(".bed", "")')
samtools runs here 
done 
```

SGE 变量语法与 bash 不同吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T17:03:47.810

是的，我需要将第一行更改为：

```
 #$ -S /bin/sh 
```

# c# - 以 SQL+ 使用的相同方式连接到 oracle

> ID：13420519
> 
> 赞同：0
> 
> 时间：2012-11-16T16:26:44.627
> 
> 标签：c#, oracle

我经常对我们拥有的多个不同的 oracle 数据库运行相同的 SQL 命令。我正在尝试创建一个简单的 C# 程序，它允许我运行命令并在 DataGrid 中显示数据。我不是数据库的 DBA，目前可以使用 SQL+ 访问数据库。有没有一种方法可以连接到数据库，运行语句并断开连接，以便它以与使用 SQL plus 完全相同的方式运行数据库端？

我已经看到了从 C# 连接到 oracle 的不同方法，但我的问题主要是为了找出哪种方法可以在我当前的设置中工作，而 SQL+ 工作的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T19:38:35.723

以哪种方式连接到数据库并不重要。权限与您的 Oracle 数据库用户名相关联。SQL+ 只是用于连接数据库的工具。

因此，如果您能够使用您的用户名在代码中连接到数据库，您可以像在 SQL+ 中一样发出查询。

# java - java SSL Connect 在 curl -E 成功时获得 403

> ID：13420520
> 
> 赞同：0
> 
> 时间：2012-11-16T16:26:46.193
> 
> 标签：java, ssl, https, jks

这个问题类似于[How to use PEM file to create a SSL socket in Java?](https://stackoverflow.com/questions/723368/how-to-use-pem-file-to-create-a-ssl-socket-in-java) 但是，我似乎无法从该问题中获得建议的解决方案。我曾经能够连接到 .Net Web 服务，但现在他们已经通过证书实现了 SLL，我无法再访问它。服务器团队为我提供了一个证书，使我能够再次连接到 Web 服务。我已经确认这是使用 curl 工作的：

```
curl -E cer_file.pem:password https://hostname/servicename.svc?wsdl 
```

所以，上面正确地返回了 wsdl。我必须为 curl 调用创建 .cacert.pem 文件才能正常工作，以避免出现此消息（curl：（77）错误设置证书验证位置）：

```
curl http://curl.haxx.se/ca/cacert.pem > .cacert.pem
export SSL_CERT_FILE=/Users/jcran/.cacert.pem 
```

现在，当我尝试使用下面的 Java 时，我仍然得到 403。我想知道是否有人能发现我做错了什么？

```
import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import javax.net.ssl.HttpsURLConnection;
import javax.net.ssl.SSLSocketFactory;

public class TestSSL {

private static final String WS_URL 
    = "https://hostname/servicename.svc?wsdl";
private static final String KS_FILE 
    = "C:/tstfolder/client_side_keystore.jks";
private static final String TS_FILE 
    = "C:/tstfolder/curl_trusted_ca.jks";

public static void main(String... args) throws Exception {
    testConn();
}

public static void testConn() throws Exception {
    System.setProperty("javax.net.ssl.keyStore", KS_FILE);
    System.setProperty("javax.net.ssl.keyStoreType", "jks");
    System.setProperty("javax.net.ssl.keyStorePassword", "importkey");
    System.setProperty("javax.net.ssl.trustStoreType", "jks");
    System.setProperty("javax.net.ssl.trustStore", TS_FILE);
    System.setProperty("javax.net.ssl.trustStorePassword", "password");
    System.setProperty("javax.net.debug", "all");

    SSLSocketFactory sslsocketfactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
    URL url = new URL(WS_URL);
    HttpsURLConnection conn = (HttpsURLConnection)url.openConnection();
    conn.setSSLSocketFactory(sslsocketfactory);

    InputStream inputstream = conn.getInputStream();
    InputStreamReader inputstreamreader = new InputStreamReader(inputstream);
    BufferedReader bufferedreader = new BufferedReader(inputstreamreader);

    String string = null;
    while ((string = bufferedreader.readLine()) != null) {
        System.out.println("Received " + string);
    }
}
} 
```

以下是我用来创建信任库和密钥库的步骤。将 cer_file.pem 分解为单独的 cert.pem 和 key.pem。然后使用以下链接[http://www.agentbob.info/agentbob/79-AB.html](http://www.agentbob.info/agentbob/79-AB.html)中的说明，我创建了 client_side_keystore.jks。[然后我通过使用http://code.google.com/p/java-keyutil/](http://code.google.com/p/java-keyutil/)上的实用程序将 curl 证书文件导入 jks 来创建信任库

不幸的是，当我尝试通过 java 测试类读取 wsdl 时，我得到一个 403。当它通过 curl 调用工作时。我怀疑我在做一些愚蠢的事情，或者误解了某些事情。但我想知道是否有人能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:40:35.907

听起来您的密钥库没有正确转换。

直接从 OpenSSL 构建 PKCS#12 文件可能更容易：

```
openssl pkcs12 -export -in file.crt -inkey file.key -out file.p12 
```

然后，`PKCS12`直接用作密钥库类型（或使用 将其转换为 JKS `keytool`）。

如果有中间证书，您可能需要检查链是否正确，如此处[所述](https://stackoverflow.com/a/9300727/372643)。

# perl - Perl 脚本在 cron 作业中显示不同的行为

> ID：13420523
> 
> 赞同：1
> 
> 时间：2012-11-16T16:26:57.323
> 
> 标签：perl, scripting, cron

我在 perl 脚本中执行以下命令。

```
#!/usr/bin/perl

my $MPSTAT="/usr/bin/mpstat";
my $GREP="/bin/grep";
my $FREE = "/usr/bin/free";
my $AWK = "/bin/awk";
my $cpu = `$MPSTAT | $GREP all | $AWK '{print (100 - \$12)}'`;
print "CPU is $cpu"; 
```

当我手动运行此 perl 脚本时，它会正确执行并*以 % (100 - Idle CPU) 为单位提供正确的 CPU 使用率*。

但是当我将它作为一个 cronjob 执行时，它总是打印 100 并且 awk 的 12 美元似乎得到了 0 的值。任何关于它为什么在 cron 中表现不同的指针都会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:30:07.797

作为 cron 的孩子运行的主要区别是：

1.  用户 ID 可能不同（root 用户与普通用户）
2.  环境几乎是空的，至少完全不同

第二部分通常意味着程序可能会以不同的语言或数字格式输出，因为`LANG`和`LC_*`环境变量的值可能是为普通用户设置的，但在 cron 下运行时不会（反之亦然）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:56:05.023

使用@WinnieNicklaus 提供的提示找到了解决方案

mpstat 在 cron 中给出不同的结果。

**正常执行：**

```
04:53:18 PM  all   49.51    0.00    4.79    2.67    0.02    0.34    0.00    0.00   42.68 
```

**内部 Cron：**

```
16:54:01   all   49.51    0.00    4.79    2.67    0.02    0.34    0.00    0.00   42.68 
```

由于 PM 没有在 cron 中打印，当将 awk 的参数更改为 $11 而不是 $12 时，它开始工作。

# eclipse - 将 Teneo 更新到 1.2 版

> ID：13420527
> 
> 赞同：1
> 
> 时间：2012-11-16T16:27:17.370
> 
> 标签：eclipse, hibernate, version, teneo

我有 Eclipse SDK 版本：4.2.1 和 Teneo 1.1.2

我正在学习教程[EMF-Development](http://www.rcp-vision.com/?p=1157&lang=en)

这里有如何将我的 Teneo 更新到 1.2.0 版的[说明](http://www.rcp-vision.com/?p=542&lang=en)

我做了所有写在那里的事情，但是 Eclipse 给出了一个错误：

> 无法完成安装，因为找不到一项或多项所需项目。正在安装的软件：EMF Teneo Hibernate Runtime 1.2.0.v201211052304 (org.eclipse.emf.teneo.hibernate.feature.group 1.2.0.v201211052304) 缺少要求：EMF Teneo Hibernate 1.2.0.v201211052304 (org.eclipse.emf .teneo.hibernate 1.2.0.v201211052304) 需要 'package org.hibernate.criterion [3.6.0,4.0.0)' 但找不到无法满足依赖关系：来自：EMF Teneo Hibernate Runtime 1.2.0.v201211052304 ( org.eclipse.emf.teneo.hibernate.feature.group 1.2.0.v201211052304）到：org.eclipse.emf.teneo.hibernate [1.2.0.v201211052304]

我已经尝试了一切。而现在我不知道该怎么办。

# iphone - 以编程方式将 UITableViewController 添加到当前视图

> ID：13420528
> 
> 赞同：1
> 
> 时间：2012-11-16T16:27:27.307
> 
> 标签：iphone, objective-c, ios, uitableview, uiviewcontroller

我需要从现有视图中以编程方式显示 UITableViewController。

我有一个 MyAppViewController，它的视图上的按钮应该打开一个新的 UITableViewController。但到目前为止，我似乎无法让它工作。这是 UITableViewController 的样子：

```
@interface SecondViewController : UITableViewController{} 
```

在主视图上，我使用以下命令添加表视图控制器：

```
SecondViewController vc2 = [[SecondViewController alloc] init];
vc2.view.frame = {...}
[self.view addSubview: vc2.view]; 
```

这就是我通常添加一个简单视图控制器的方式，所以我认为 UITableViewController 是相同的。

我得到的结果是整个屏幕上的空单元格。这是因为未设置委托，我假设，但我会在哪里设置呢？所以我的困惑是 UITableViewController 视图控制器上的委托设置器并从主视图控制器的视图中正确显示 UITableViewController 。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T17:17:57.570

# 编辑

这个答案已经过时了。将视图控制器的视图添加为另一个视图控制器的子视图的正确方法是实现容器视图控制器。

[https://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html](https://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html)

# 原始答案

你的模式有点不同寻常。执行您所描述的操作的最常见方法是初始化并呈现 SecondViewController。如果这确实是您想要的，我强烈建议您仔细阅读 Apple 的文档，了解如何创建、自定义和呈现`UIViewController`和`UITableViewController`.

如果您知道所有这些并且真的想做一些自定义的事情，那么请继续阅读。

相反，您正在创建 SecondViewController 的实例，而不是呈现它，而是将其视图添加到当前视图控制器视图中。如果你知道你想要完成什么，而这实际上是你想要的结果，那就去做吧。

配置这种通用模式的方法不止一种。在此示例中，我将坚持使用最简单的方法。

1）`MainViewController`（MVC）应该在`SecondViewController`需要时将（SVC）实例保留在属性中。

2) SVC 是`UITableViewController`so 默认的子类，它被设置为`dataSource`and `delegate`for it's `UITableView`。这意味着您需要为要填充数据的表实现`UITableViewDataSource`和`UITableViewDelegate`方法。`SVC`假设`MVC`知道需要将哪些数据放入表中，它应该将其传递给`SVC`. 最简单的方法是定义一个`SVC`可以`MVC`在初始化时设置的属性。

3）假设有一种方法可以在表格呈现后将其关闭，您会想`MVC`要这样做。基本上，`MVC`会从它的超级视图中删除`SVC`的视图，然后将`SVC`属性设置为 nil。

这是一些快速的伪代码。我写了最低限度的例子。

```
// MainViewController.h
//
#import "SecondViewController.h"

@interface MainViewController : UIViewController
@property (nonatomic, strong) SecondViewController *svc;
@end

// MainViewController.m
//
#import "MainViewController.h"

@implementation MainViewController

// init and configure views w/ init, loadView, viewDidLoad, etc

// present SecondViewController
- (void)presentSecondViewController:(id)sender {
    self.svc = [[SecondViewController alloc] init];
    // this example uses an array as the SVC data
    self.svc.tableData = @[@"first", @"second", @"third", @"fourth"];
    self.svc.view.frame = self.view.bounds;
    [self.view addSubview:self.svc.view];
}

// dismiss SecondViewController
- (void)dismissSecondViewController:(id)sender {
    if (self.svc) {
        [self.svc.view removeFromSuperview];
        self.svc = nil;
    }
}

// SecondViewController.h
//
@interface SecondViewController : UITableViewController
@property (nonatomic, strong) NSArray *tableData;
@end

// SecondViewController.m
//
@implementation SecondViewController

// init and configure views w/ init, loadView, viewDidLoad, etc

// override tableData getter to create empty array if nil
- (NSArray *)tableData
{
    if (!tableData) {
        _tableData = @[];
    }
    return _tableData;
}

// override tableData setter to reload tableView
- (void)setTableData:(NSArray *)tableData
{
    _tableData = tableData;
    [self.tableView reloadData];
}

// implement UITableViewDelegate and UITableViewDataSource methods using
// the self.tableData array 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:30:09.820

这是代码

1）添加数据源和委托`.h`

2）创建一些代码`.m`

```
 thisTableView = [[UITableView alloc] initWithFrame:CGRectMake(6.5, 60,      self.view.bounds.size.width - 10, 350) style:UITableViewStylePlain];

    [thisTableView setBounces:NO];
    thisTableView.backgroundColor = [UIColor whiteColor];

thisTableView.delegate = self;
thisTableView.dataSource = self;
[self.view addSubview:thisTableView];
    [thisTableView release]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:33:46.640

在您的标题中，您必须告诉您的视图控制器符合 UITableViewDataSource 和 UITableViewDelegate。在“UIViewController”之后添加这个

```
<UITableViewDataSource, UITableViewDelegate> 
```

然后在您的实现文件中，您需要为表添加委托和数据源方法，例如：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section 
```

和

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

[您可以在UITableViewDataSource](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITableViewDataSource)和[UITableViewDelegate](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITableViewDelegate)类参考中找到完整列表。

此外，在您分配初始化表视图的位置，您需要将其委托和数据源设置为当前类：

```
[myTableView setDelegate:self];
[myTableView setDataSource:self]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T17:30:11.697

好的，首先我想你在做什么`[self.view addSubview]`将项目中的所有视图堆积到同一个视图控制器中，更传统的方法是在完成视图控制器后关闭它并自行创建新的视图控制器。您正在做的堆积是非常规的，我认为这会误导将来尝试查看您的代码的人。此外，如果您真的开始尝试进行标准导航，那将是一件令人头疼的事情。此外，它看起来像是一场内存管理的噩梦（尽管我承认我对此仍然有些模糊，所以我不知道 ARC 是否会为你清理它，如果你真的在使用 ARC）。也就是说，在某些情况下您可能会尝试这样做 - 但如果您不确定，那意味着这不是您想要做的（如果这是您想要做的，请查看 XJones' 回答）。我认为你正在寻找的是`presentViewController`- 这是摆脱不需要的控制器并用新控制器替换它的更传统的方法。摆脱

```
vc2.view.frame = {...}
[self.view addSubview: vc2.view]; 
```

并将其替换为

```
[self presentViewController:vc2 animated:/*YES or NO, try them both and use whichever one you like better*/ completion:NULL]; 
```

注意：我不完全确定是什么`completion`（我认为它可能允许您在构建 vc2 后运行额外的方法 - 如果您搜索“presentViewController 示例”，您可以查看一些示例以获取更多信息，或查看[Apple 文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)）。我确实知道保留它`NULL`会起作用，并且可能会满足您的需要。

完成所有这些操作后，您将立即回到现在所在的位置，在那里您将看到上面有一堆空单元格的视图（但您将以更传统的方式到达那里）。

从这里开始，您需要向您的 SecondViewController.m 添加一些代码来告诉它您想要显示的内容。通常，您将有一个字符串数组，并且您希望表格的第一个单元格有一个标签，显示该数组中的第一个字符串，第二个单元格显示第二个字符串，依此类推。为此，您将拥有类似`cell.textLabel = [myArray objectAtIndex:indexPath.row];`.

设置 UITableViewController 的内容比我在这篇文章中介绍的要多得多，因此请查看 YouTube 上的一些教程或其他内容，因为他们已经花时间以更易于理解的格式解释您需要的所有内容（我发现当我第一次开始使用表格视图时，[这个](http://www.youtube.com/watch?v=9S114beUwPM)非常有帮助，但那里也有很多其他的）。

# .htaccess - 使用 .htaccess 和 codeigniter 获取 xampp 启动画面

> ID：13420529
> 
> 赞同：0
> 
> 时间：2012-11-16T16:27:30.117
> 
> 标签：.htaccess, codeigniter

我在本地系统上安装了 xampp。我正在使用 codeigniter 构建一个应用程序，并希望省略中间的 index.php。

这是我的 .htaccess 文件，来自这里[http://www.farinspace.com/codeigniter-htaccess-file/](http://www.farinspace.com/codeigniter-htaccess-file/)：

```
<IfModule mod_rewrite.c>

RewriteEngine On
RewriteBase /

### Canonicalize codeigniter URLs

# If your default controller is something other than
# "welcome" you should probably change this
#RewriteRule ^(welcome(/index)?|index(\.php)?)/?$ / [L,R=301]
#RewriteRule ^(.*)/index?$ $1 [L,R=301]

# Removes trailing slashes (prevents SEO duplicate content issues)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)/$ $1 [L,R=301]

# Enforce www
# If you have subdomains, you can add them to 
# the list using the "|" (OR) regex operator
RewriteCond %{HTTP_HOST} !^(www|subdomain) [NC]
RewriteRule ^(.*)$ http://localhost/masalewala/$1 [L,R=301]

# Enforce NO www
#RewriteCond %{HTTP_HOST} ^www [NC]
RewriteRule ^(.*)$ http://www.localhost/masalewala/$1 [L,R=301]

###

# Removes access to the system folder by users.
# Additionally this will allow you to create a System.php controller,
# previously this would not have been possible.
# 'system' can be replaced if you have renamed your system folder.
RewriteCond %{REQUEST_URI} ^system.*
RewriteRule ^(.*)$ /index.php/$1 [L]

# Checks to see if the user is attempting to access a valid file,
# such as an image or css document, if this isn't true it sends the
# request to index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L] 
```

```
# Without mod_rewrite, route 404's to the front controller
ErrorDocument 404 /index.php 
```

访问 url 时：localhost/masalewala/anything，firefox 给我以下信息：

“Firefox 检测到服务器正在以永远不会完成的方式重定向对该地址的请求。”

任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:34:25.547

您不需要 .htaccess 文件中的所有内容。试试这个，它是我使用的：

```
Options FollowSymLinks
<IfModule mod_rewrite.c>
    RewriteEngine on

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?/$1 [L]
</IfModule> 
<IfModule !mod_rewrite.c>
    ErrorDocument 404 /index.php
</IfModule> 
```

# crystal-reports - 如何在 Crystal Reports 中将字段总和插入到文本对象中？

> ID：13420531
> 
> 赞同：1
> 
> 时间：2012-11-16T16:27:38.047
> 
> 标签：crystal-reports, field

我正在编写一份在我开始在这里工作之前制作的报告，而最初制作它的人已经走了。因此，我不知道他是如何制作他制作的，这是：

有一组文本对象包含汇总字段（例如，其中的文本是“{Sum of Job.ServiceCharge}”，省略了引号但实际上有大括号）。我可以将 Job.ServiceCharge 拖放到文本对象中，但这不是摘要。我可以创建 Job.ServiceCharge 的摘要，但这不在文本对象中。我可以创建 Job.ServiceCharge 的 Running Total Field 并将其放入 Text Object 中，但他确实没有显示在 Running Total Fields 列表中，所以这不可能是他这样做的方式。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T16:34:56.617

如果您要汇总的字段是一个字符串，那么您可以像往常一样创建汇总（“插入”->“汇总”-> 设置您的汇总），然后将其从插入报告的位置拖到您的文本字段。

~~如果该字段**不是**字符串，则必须先通过公式将其转换为字符串。假设您想显示整个报告的服务费用总和。您将创建一个这样的公式：`totext(sum({Job.ServiceCharge}))`然后，您可以将该公式拖到您想要的文本字段中。~~

~~如果要对组求和，请查看 CR 帮助以了解如何在公式中使用汇总函数。~~

**编辑 1**实际上，第二部分是不正确的。您甚至不需要转换即可将其嵌入文本字段。您只需将其格式化为您想要的格式，就像您报告中的任何数字字段一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-11T10:11:14.910

我已经用不同的方式完成了.. 没有悬停和拖放。添加公式后，您 Ctrl-X 所需的字段并双击文本字段，然后粘贴在其中。

# linux - 如何替换目录中所有文件名中的字符串？（具体来说，我需要从目录中的所有文件名中删除“\#015”

> ID：13420539
> 
> 赞同：7
> 
> 时间：2012-11-16T16:28:18.300
> 
> 标签：linux, unix, replace, sed, awk

目录中的许多文件 ( `/root/path/`) 都附加了一个奇怪的字符串 ( `\#015`)。帮我用没有奇怪字符串的常规名称替换它们。

我需要：

```
/root/path/img1.png\#015
/root/path/img2.jpg
/root/path/img3.png\#015 
```

成为：

```
/root/path/img1.png
/root/path/img2.jpg
/root/path/img3.png 
```

你能帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T16:55:01.173

```
for file in *\#015
do
   mv -- "$file" "${file%\#015}"
done 
```

您可能需要转义“\”。首先在 tmp 目录中尝试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-16T23:02:20.433

如果您已经`rename`安装，这将成为一项相当简单的任务：

```
rename 's/\\#015$//' /root/path/*\\#015 
```

`-f`如有必要，您可以添加标志以强制覆盖现有文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T16:36:17.487

这就是我过去用一个小外壳解决类似问题的方法。

```
cd /root/path/
ls | grep '\#015' | sed 's/\(.*\)\\#015/mv & \1/' | sh 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T16:52:31.387

您可以使用`find`和参数替换来执行此操作，如下所示：

```
#!/bin/bash

find -name '*\\#015' | while IFS= read -r f
do
    mv -- "${f}" "${f%?????}"
done 
```

*   将上面的代码放在`my_script.sh`你的脚本中`/root/path/`，然后运行它`chmod +x my_script.sh && ./my_script.sh`
*   请注意，这也会将更改递归地应用于所有子文件夹`/root/path/`。

**解释：**

*   `find -name '*\\#015'`: 查找所有以`\#015`
*   然后对于找到的每个此类文件：`mv "${f}" "${f%?????}"`将其从旧名称重命名为新名称，并删除文件名中的最后 5 个字符。

# fatal-error - 每次 php 生成致命错误时发送电子邮件

> ID：13420542
> 
> 赞同：1
> 
> 时间：2012-11-16T16:28:53.447
> 
> 标签：fatal-error, php

我将如何编写一个 PHP 代码，每次我收到一个电子邮件时都会向我发送一封电子邮件

`Fatal error: Allowed memory size of 33554432 bytes exhausted (tried to allocate 14373306 bytes) in on line <b>443</b><br />`.

我正在运行一个脚本，其中用户具有此 URL，它将由我的代码处理，但这里的问题是有时它会导致`Fatal error Allowed memory size exhausted`. 我想向我发送一封电子邮件，告诉我同时存在这个错误是哪个 URL 导致了该错误。

所以逻辑是这样的。

```
if( error == "Fatal Error Allowed memory Size" ) {
 mail("myemail@email.com", "Fatal Error - URL: http://google.com");
} 
```

我希望指示很清楚。您的帮助将不胜感激和奖励！

谢谢！:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T16:40:22.723

你可以看看使用`register_shutdown_function()`. 它可以用来执行`E_ERROR`（致命错误）

```
register_shutdown_function('shutdown');

function shutdown()
{
  if(!is_null($e = error_get_last()))
  {
    mail("myemail@email.com", "Fatal Error - ". var_export($e, true));
  }
} 
```

但是，我会在上面的评论中附和一些想法，即最好使用日志监控来处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-08T11:24:17.890

```
Init following function inside your php file.

register_shutdown_function('mail_on_error'); //inside your php script

/** If  any file having any kind of fatal error, sln team will be notified when cron will
become fail : following is the name of handler and its type
E_ERROR: 1 | E_WARNING: 2 | E_PARSE: 4 | E_NOTICE: 8
*/

function mail_on_error() {
    global $objSettings;

    $error = error_get_last();
    //print_r($error);    

  if ($error['type'] == 1) {

        // update file path into db
        $objSettings->update_records($id=1,array('fatal_error' => json_encode($error)));

        $exception_in_file_path = __FILE__;
        fatal_error_structure($exception_in_file_path);

  }// end if

}// end mail_on_error

fatal_error_structure should be defined on some global location. like function.inc.php. This will send an email to registered user.

function fatal_error_structure($exception_in_file_path){

        $subject = "FATAL: Cron Daemon has failed";

    sln_send_mail(nl2br("Please check $exception_in_file_path, This cron having FATAL error."), 
        $subject, 'email@address.com',$name_reciever='', 'text/plain');

}// end fatal_error_structure

vKj 
```

# python - 根据先前列表的百分比创建新列表？

> ID：13420544
> 
> 赞同：0
> 
> 时间：2012-11-16T16:29:03.197
> 
> 标签：python

大家好，所以我在这里有一个程序，让用户输入一系列数字，然后将其覆盖到列表中

```
total = int(input("How many numbers do you want to enter? "))

myList = []
for i in range (total):
    n = int(input("Enter a number >> "))
    myList.append(n)

print ("The list is")
for i in range(total):
    print (myList[i]) 
```

它工作正常并且与程序的其余部分兼容，但我需要的是从 myList 创建一个新列表，但是新列表只能包含属于原始数据的 5%- 95% 子范围的数据

我不太确定该怎么做...使用 python 3.2.3 IDLE

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T23:38:35.043

您可以使用一点随机性从列表中选择任意数量的值：

```
total = int(input("How many numbers do you want to enter? "))
import random as ran
vList=[]
myList = []
for i in range (total):
    n = int(input("Enter a number >> "))
    myList.append(n)

print myList

x=ran.uniform(1, len(myList))
x=int(round(x))
for i in range(x):
    y=ran.choice(myList)
    myList.remove(y)
    vList.append(y)

print vList 
```

那应该工作:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:31:46.340

这对你有用吗？

```
In [72]: L = range(100)

In [73]: L[int(len(L)*0.05):int(len(L)*0.95)]
Out[73]: 
[5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94] 
```

# .net-4.0 - 使用 CurrentDomain.SetData("APP_CONFIG_FILE") 在 PowerShell ISE 中不起作用

> ID：13420545
> 
> 赞同：9
> 
> 时间：2012-11-16T16:29:08.313
> 
> 标签：.net-4.0, windows-8, powershell-3.0, powershell-ise

我正在尝试在 PowerShell ISE 中使用 .NET 4.0 程序集，并尝试更改通过以下方式使用的配置文件：

```
[System.AppDomain]::CurrentDomain.SetData("APP_CONFIG_FILE", $PathToConfig); 
```

[Configuration.ConfigurationManager]::ConnectionStrings.Count 总是返回“1”，
而“[Configuration.ConfigurationManager]::ConnectionStrings[0].Name”总是返回“LocalSqlServer”，并且那个 ConnectionString 名称不在我的“.config”中文件。

请注意，从 PowerShell 命令提示符执行 PowerShell 脚本会按预期运行。只是当我从 PowerShell ISE 中执行它时，它没有按预期工作。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-14T07:20:41.147

It's because the path to app.config for PowerShell ISE has already been loaded and cached so changing the app.config path afterwards won't make a difference: [stackoverflow.com/q/6150644/222748](https://stackoverflow.com/q/6150644/222748)

Here is an example script that will clear the cached path so it will work under PowerShell ISE:

```
[System.AppDomain]::CurrentDomain.SetData("APP_CONFIG_FILE", $PathToConfig)
Add-Type -AssemblyName System.Configuration
[Configuration.ConfigurationManager].GetField("s_initState", "NonPublic, Static").SetValue($null, 0)
[Configuration.ConfigurationManager].GetField("s_configSystem", "NonPublic, Static").SetValue($null, $null)
([Configuration.ConfigurationManager].Assembly.GetTypes() | where {$_.FullName -eq "System.Configuration.ClientConfigPaths"})[0].GetField("s_current", "NonPublic, Static").SetValue($null, $null)
[Configuration.ConfigurationManager]::ConnectionStrings[0].Name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-28T01:15:06.117

起飞`[0]`对我有用。

`([Configuration.ConfigurationManager].Assembly.GetTypes() | where {$_.FullName -eq "System.Configuration.ClientConfigPaths"}).GetField("s_current", "NonPublic, Static").SetValue($null, $null)`

# c# - 使用数据源的 NUnit 数据驱动单元测试

> ID：13420547
> 
> 赞同：2
> 
> 时间：2012-11-16T16:29:13.307
> 
> 标签：c#, unit-testing, tdd, nunit, test-data

我有一个像 -4,-3,-3,-2,-1,0,1,2,2,3,4 这样的数据源，我有一个函数，这个函数可以捕获重复的数字，例如在这个数据源中我们有 -3,2 重复。重复的数字在程序结束时报告。我找不到好的例子（我花了 3 个小时）。我如何使用 NUnit 实现可以测试相同情况的单元测试并告诉我结果，如果你有一些示例，它将对我非常有用。（非常感谢）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T16:40:55.857

您可以将`TestCase`属性用于您所描述的简单数据。

```
[Test]
[TestCase(new[] { -4, -3, -3, -2, -1, 0, 1, 2, 2, 3, 4 }, new []{-3,2})]
public void YourTest(int[] given, int[] expected)    
{  ... } 
```

注意：ReSharper（至少是我的版本）不支持像这样的多个测试用例，因此我必须使用 NUnit GUI 确认多个测试用例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T01:05:55.320

首先要做的事情是进行工作测试。像这样的东西：

```
 [Test]
    public void DetectsMinusThreeAndTwo()
    {
        RepeatingDigitsDetector target = new RepeatingDigitsDetector();
        int[] source = new int[] { -4, -3, -3, -2, -1, 0, 1, 2, 2, 3, 4 };
        int[] expected = new int[] { -3, -2 };
        int[] actual = target.GetRepeats(source);
        Assert.AreEqual(expected.Length, actual.Length, "checking lengths");
        for (int i = 0; i < expected.Length; i++)
        {
            Assert.AreEqual(expected[i], actual[i], "checking element {0}", i);
        }
    } 
```

`TestCase`稍后，您可以开始添加诸如或`TestCaseSource`属性之类的好东西。但是，如果您尝试进行 TDD（正如[tdd](/questions/tagged/tdd "显示标记为“tdd”的问题")标签所暗示的那样），则需要从**测试**开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T16:50:32.090

在这种情况下，我会推荐[TestCaseSource 。](http://nunit.org/index.php?p=testCaseSource&r=2.5)一些测试可能会使 TestCase 属性中的数据更难读取。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-30T18:29:07.000

随着您的测试数据变得复杂，将难以处理。考虑将数据存储在其他源中，例如 excel、json 或数据库。

我个人喜欢将测试数据存储在嵌入式 json 文件中。[JsonSectionReader](https://www.nuget.org/packages/WonderTools.JsonSectionReader/)包对此提供了很好的支持。

# php - 显示事件不起作用

> ID：13420550
> 
> 赞同：0
> 
> 时间：2012-11-16T16:29:22.073
> 
> 标签：php, mysql

我正在尝试在完整的日历中显示来自 MySQL 数据库的事件。这是我的代码，json-events.php：

```
 @mysql_connect($host,$user,$pass)
    or die("Impossible de se connecter ! Vérifier le nom du serveur, le login ou le mot de passe !");

@mysql_select_db("$bdd")
    or die ("Impossible de trouver la base de données !");  

$req_lire ="SELECT idfiches,titrefiches,DATE_FORMAT(fiches.rvfiches, '%Y-%m-%d') as startdate FROM fiches"; 

    $lire2 = mysql_query($req_lire) or die($req_lire."<br>\n".mysql_error());

 $events = array();
    while ($reponse = mysql_fetch_array($lire2))
{
$id = $reponse['idfiches'];
$title = $reponse['titrefiches'];
$start = $reponse['startdate'];

$events = array(
            'id' => "$id",
            'title' => "$title",
            'start' => "$start"
            );
}
echo json_encode($events); 
```

什么都没有显示，也没有错误。当我在一个单独的文件中尝试我的请求时，没关系。你可以帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:37:17.117

首先，您将 $events 数组替换为您在上次迭代中获得的任何内容。

尝试更新这个：

```
$events = array(
        'id' => "$id",
        'title' => "$title",
        'start' => "$start"
        ); 
```

进入这个：

```
$events[] = array(
        'id' => "$id",
        'title' => "$title",
        'start' => "$start"
        ); 
```

这样，您将每次迭代的数据附加到您的 $events 数组中。

# javascript - 停止加载页面中的所有脚本

> ID：13420552
> 
> 赞同：2
> 
> 时间：2012-11-16T16:29:37.033
> 
> 标签：javascript, html, google-chrome, dom

我一直试图让这段代码在 Google Chrome 中运行，但我似乎无法阻止来自“已删除”脚本的服务器请求的发生。

我想要做的是删除页面中的所有脚本，下面的代码从 DOM 中删除脚本，但它们仍然加载和执行。

代码：

```
document.addEventListener("DOMContentLoaded", function(){
    var e2 = document.getElementsByTagName("script");
    for(var i = e2.length; i--; e2[i].parentNode.removeChild(e2[i]));
});​ 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T18:24:31.827

脚本是阻塞的，因此在结束正文标记之前出现的任何脚本标记都会在`DOMContentLoaded`事件之前被下载、解析和执行。

您总是可以查看脚本标签上的 async 或 defer 属性，但您仍然会猜测它们是否已在您的`DOMContentLoaded`侦听器执行时被执行。

你真的应该尝试寻找一种替代方法来实现你想要在这里完成的事情。我可以问你想做什么吗？

# ios - 如何停止 MPMoviePlayerViewController 在moviePlaybackDidFinish 上的自动关闭？

> ID：13420564
> 
> 赞同：7
> 
> 时间：2012-11-16T16:30:15.550
> 
> 标签：ios, mpmovieplayercontroller

以模态方式呈现的 MPMoviePlayerViewController`presentMoviePlayerViewControllerAnimated:`在其内容播放完毕时会自动关闭。

我试图禁用它，因为我想在之后播放其他内容。但是，即使我注册到 NSNotificationCenter`[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(movieFinishedCallback:) name:MPMoviePlayerPlaybackDidFinishNotification object:playerVC.moviePlayer];`并设置了一些其他内容，它仍然会关闭。

如何阻止 MPMoviePlayerViewController 自动关闭？

**更新：**

作为澄清，这个问题*只是*关于删除自动解雇，而不是关于处理禁用的“完成”按钮。所选答案反映。这是设计使然，因为我们假设开发人员添加了他们自己的方法来关闭 MPMoviePlayerViewController。但是，**@bickster**的回答也涉及“完成”按钮。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-16T16:30:15.550

感谢[这篇博客文章](http://josebolanos.wordpress.com/2011/09/28/dismissing-mpmovieplayerviewcontroller-the-right-way/)，我发现 MPMoviePlayerViewController 在创建时会自动将自身注册到 NSNotificationCenter。您必须先删除此注册，它会自动停止自行关闭。

```
// Initialize the movie player view controller with a video URL string
MPMoviePlayerViewController *playerVC = [[[MPMoviePlayerViewController alloc] initWithContentURL:[NSURL URLWithString:aVideoUrl]] autorelease];
// Remove the movie player view controller from the "playback did finish" notification observers
[[NSNotificationCenter defaultCenter] removeObserver:playerVC  name:MPMoviePlayerPlaybackDidFinishNotification object:playerVC.moviePlayer]; 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-10-25T18:02:11.593

您可以使用此代码来阻止视图控制器在用户单击“完成”按钮时自动关闭并捕获事件，以便您可以自己关闭视图控制器。

第 1 步 - 分配一个 MPMoviePlayerViewController

```
videoPlayer = [[MPMoviePlayerViewController alloc] initWithContentURL:[[NSURL alloc ]initWithString:[aURL]; 
```

第 2 步 - 删除默认 MPMoviePlayerPlaybackDidFinishNotification 观察者并添加您自己的

```
[[NSNotificationCenter defaultCenter] removeObserver:videoPlayer
name:MPMoviePlayerPlaybackDidFinishNotification object:videoPlayer.moviePlayer];
[[NSNotificationCenter defaultCenter] addObserver:self
selector:@selector(videoFinished:) name:MPMoviePlayerPlaybackDidFinishNotification object:videoPlayer.moviePlayer]; 
```

第 3 步 - 呈现视图控制器

```
[self presentMoviePlayerViewControllerAnimated:videoPlayer]; 
```

第 4 步 - 添加 videoFinish: 方法

```
-(void)videoFinished:(NSNotification*)aNotification{
    int value = [[aNotification.userInfo valueForKey:MPMoviePlayerPlaybackDidFinishReasonUserInfoKey] intValue];
    if (value == MPMovieFinishReasonUserExited) {
        [self dismissMoviePlayerViewControllerAnimated];
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-16T17:25:09.390

你可以尝试这样的事情。

当 mpmovieplayercontroller 播放完视频并且您在方法**movieFinishedCallback 中收到通知时：** implemect

```
 [playerVC.movieplayer setContentURL:// set the url of the file you want to play here];

       [playerVC.moviePlayer play]; 
```

希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-31T09:35:24.263

`MPMoviePlayerPlaybackDidFinishNotification`由于如果我从中删除“完成”按钮不再起作用`NSNotificationCenter`，我将重复模式更改为`MPMovieRepeatModeOne`。然后，除了重复视频外，一切正常。

```
MPMoviePlayerViewController *playerVC = [[[MPMoviePlayerViewController alloc] initWithContentURL:[NSURL URLWithString:aVideoUrl]] autorelease];
[playerVC.moviePlayer setRepeatMode:MPMovieRepeatModeOne]; 
```

# javascript - 如何在 iScroll4 中同时动态添加和删除元素？

> ID：13420568
> 
> 赞同：3
> 
> 时间：2012-11-16T16:30:21.213
> 
> 标签：javascript, html, iscroll4

我从安静的时候就一直在使用 iScroll4 进行工作

尽管我在使用它时遇到了一个问题，即在一端动态添加元素时，我还需要从另一端删除元素。在我的工作中，我可能必须动态添加大量数据（保存图像），但我想保持相同数量的子元素以管理内存/性能问题。如果有人可以向我建议任何方法，那将有很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-04T07:22:13.963

您需要使用 jquery 从特定容器中添加或删除元素。

并且在添加和删除内容时，需要刷新 iScroll。

例如，您创建一个 iscroll 为，

```
var myScroll = new iScroll('scrollwrapper', {   }); 
```

然后在添加或删除滚动包装器内容后，刷新 iScroll，使其正常工作。

```
myScroll.refresh(); 
```

# mysql - Mysql MAX值和Last Record同时

> ID：13420572
> 
> 赞同：1
> 
> 时间：2012-11-16T16:30:40.393
> 
> 标签：mysql

如果您有包含 2 个字段的表：

身份证 | 数量

您如何使用 1 个查询获得最大（AMOUNT）和最后输入的记录的数量（按 id desc 排序）？

感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:32:02.330

```
select amount as last_amount, 
      (select max(amount) from your_table) as max_amount
from your_table
order by id desc
limit 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:34:31.610

你可以这样做：

```
SELECT
    (SELECT MAX(amount) FROM table) as Max,
    (SELECT amount FROM table ORDER BY id DESC LIMIT 1) as Last 
```

# sql - 如何在 sql join 中解析表可见性

> ID：13420578
> 
> 赞同：1
> 
> 时间：2012-11-16T16:31:04.820
> 
> 标签：sql, join, visibility

我在使用显式连接理解正确的 sql 语法时遇到问题。例如在第一个片段中，在第二个连接中“ec”是可见的并且限制有效。但在第二个片段中，“op”无法解决。

**第一个片段：**

```
select im.* 
  from gestion_corte gc 
  join evento_corte ec
       on ec.id_corte = gc.id_corte
  join op_corte op
       on op.id_corte = gc.id_corte
       and op.fecha_evento = ec.fecha_evento        
  join img_corte im        
       on op.id_corte = im.id_corte                     
 where ec.fecha_evento > '01092012' 
```

**第二个片段**，“op”在第一次加入时无法解析：

```
select im.* 
  from gestion_corte gc 
  join evento_corte ec
       on ec.id_corte = gc.id_corte
       and op.fecha_evento = ec.fecha_evento -- This condition has moved
  join op_corte op
       on op.id_corte = gc.id_corte        
  join img_corte im        
       on op.id_corte = im.id_corte                     
 where ec.fecha_evento > '01092012' 
```

结果，可见性是从上到下解决的处理吗？还有其他重要的事情需要考虑吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T17:09:16.617

在 SQL 连接语法中，别名在定义之前是未知的。所以，你可以这样做：

```
from A a join
     B b
     on a.val = b.val join
     C c
     on a.val = c.val 
```

但是，您不能这样做：

```
 from A a join
     B b
     on a.val = b.val and
        a.id = c.id join
     C c
     on a.val = c.val 
```

`from`SQL 引擎根本不知道“c”是什么，因为在语句中还没有看到“c” 。

正如您所发现的，您的第二个查询很容易通过移动条件来修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T19:52:27.287

连接是在两个虚拟表之间。

连接谓词只能引用这两个虚拟表中的列（尽管每个虚拟表可能包含来自多个基表的列）。

**有效使用的顺序不一定**是自上而下的，因为逻辑连接顺序是由`ON`子句的顺序决定的。因此，例如在以下查询（[SQL Fiddle](http://www.sqlfiddle.com/#!3/d36fb/1)）中，虚拟表`(a join b)`连接到虚拟表`(c join d join e)`

```
SELECT *
FROM   a
       JOIN b
         ON a.id = b.id /*Only a and b in scope here*/
       JOIN c
            JOIN d
              ON c.id = d.id /*Only c and d in scope here*/
            JOIN e
              ON e.id = d.id /*Only c, d, e in scope here*/
         ON d.id = a.id  /*a,b,c,d,e all in scope*/ 
```

此查询（[SQL Fiddle](http://www.sqlfiddle.com/#!3/d36fb/3)）会给出一个错误，因为`a`它不在范围内。

```
SELECT *
FROM   a
       JOIN b
         ON a.id = b.id
       JOIN c
            JOIN d
              ON c.id = d.id
            JOIN e
              ON e.id = a.id -- Can't reference a here
         ON d.id = a.id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T17:17:51.810

我没有得到你的第二个问题，所以我只回答第一个问题。
可以这样想象您的连接：

“结果” = 从“任何来源”中选择“某些列”

“任何来源”可以是表或子查询（即另一个“结果”）或“任何来源”连接“任何来源”：
“任何来源”=表| “结果” | “任何来源”**加入**“任何来源”

所以如果你想要一个“结果”，你应该首先确定“任何来源”然后是“一些列”（我们不要专注于它）。让我们去“任何来源”的定义来确定它。表被确定，“结果”递归地导致前一个句子和连接构造有一个规则 - 确定它首先得到左“任何来源”然后右。
 **所以，看看你的第二个片段。由于 op_corte 尚未确定，这部分`gestion_corte join evento_corte`尚未计算**

# hadoop - 不使用 reducer 读/写 Hbase，异常

> ID：13420581
> 
> 赞同：0
> 
> 时间：2012-11-16T16:31:30.063
> 
> 标签：hadoop, mapreduce, hbase

我想在不使用任何减速器的情况下读写 hbase。

我按照“The Apache HBase™ 参考指南”中的示例进行操作，但也有例外。

这是我的代码：

```
public class CreateHbaseIndex { 
static final String SRCTABLENAME="sourceTable";
static final String SRCCOLFAMILY="info";
static final String SRCCOL1="name";
static final String SRCCOL2="email";
static final String SRCCOL3="power";

static final String DSTTABLENAME="dstTable";
static final String DSTCOLNAME="index";
static final String DSTCOL1="key";
public static void main(String[] args) {
    System.out.println("CreateHbaseIndex Program starts!...");
    try {
        Configuration config = HBaseConfiguration.create();
        Scan scan = new Scan();
        scan.setCaching(500);
        scan.setCacheBlocks(false);
        scan.addColumn(Bytes.toBytes(SRCCOLFAMILY), Bytes.toBytes(SRCCOL1));//info:name
        HBaseAdmin admin = new HBaseAdmin(config);
        if (admin.tableExists(DSTTABLENAME)) {
            System.out.println("table Exists.");
        }
        else{
            HTableDescriptor tableDesc = new HTableDescriptor(DSTTABLENAME);
            tableDesc.addFamily(new HColumnDescriptor(DSTCOLNAME));
            admin.createTable(tableDesc);
            System.out.println("create table ok.");
        }
        Job job = new Job(config, "CreateHbaseIndex");
        job.setJarByClass(CreateHbaseIndex.class);
        TableMapReduceUtil.initTableMapperJob(
                SRCTABLENAME, // input HBase table name
                scan, // Scan instance to control CF and attribute selection
                HbaseMapper.class, // mapper
                ImmutableBytesWritable.class, // mapper output key
                Put.class, // mapper output value
                job);
        job.waitForCompletion(true);
    } catch (IOException e) {
        e.printStackTrace();
    } catch (InterruptedException e) {
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    }
    System.out.println("Program ends!...");
}

public static class HbaseMapper extends TableMapper<ImmutableBytesWritable, Put> {
    private HTable dstHt;
    private Configuration dstConfig;
    @Override
    public void setup(Context context) throws IOException{
        dstConfig=HBaseConfiguration.create();
        dstHt = new HTable(dstConfig,SRCTABLENAME);
    }

    @Override
    public void map(ImmutableBytesWritable row, Result value, Context context) throws IOException, InterruptedException {
        // this is just copying the data from the source table...
        context.write(row, resultToPut(row,value));
    }

    private static Put resultToPut(ImmutableBytesWritable key, Result result) throws IOException {
        Put put = new Put(key.get());
        for (KeyValue kv : result.raw()) {
            put.add(kv);
        }
        return put;
    }

    @Override
    protected void cleanup(Context context) throws IOException, InterruptedException {
        dstHt.close();
        super.cleanup(context);
    }
}
} 
```

顺便说一下，“souceTable”是这样的：

```
key  name    email
1    peter   a@a.com
2    sam     b@b.com 
```

“dstTable”将是这样的：

```
key    value
peter  1
sam    2 
```

我是这个领域的新手，需要你的帮助。谢谢~

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T16:37:31.867

您是正确的，您不需要减速器来写入 HBase，但在某些情况下减速器可能会有所帮助。如果您正在创建索引，您可能会遇到两个映射器尝试写入同一行的情况。除非您小心确保它们写入不同的列限定符，否则由于竞争条件，您可能会用另一个更新覆盖一个更新。虽然 HBase 确实进行了行级锁定，但如果您的应用程序逻辑有问题，它也无济于事。

在没有看到您的异常的情况下，我猜您失败了，因为您试图将源表中的键值对写入不存在列族的索引表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-18T13:24:37.153

在此代码中，您没有指定输出格式。您需要添加以下代码

```
 job.setOutputFormatClass(TableOutputFormat.class);

    job.getConfiguration().set(TableOutputFormat.OUTPUT_TABLE,
            DSTTABLENAME); 
```

此外，我们不应该在设置中创建新配置，我们需要使用上下文中的相同配置。

# javascript - 获取父类属性

> ID：13420582
> 
> 赞同：1
> 
> 时间：2012-11-16T16:31:38.100
> 
> 标签：javascript, jquery

我有一个 javascript 类，它有一个使用 jQuery 发送 Ajax 请求并处理响应的方法。

我遇到的问题是我无法弄清楚如何从 jQuery 函数中获取初始父类的属性。我已经尝试过`$(this).parent()`，但是由于某种原因这并没有得到我需要的东西。

我的代码如下。谁能告诉我如何从这个循环中到达基类？

```
function companiesPage()
{
    this.childCategoriesSelectid = '#childCategoryid';

    this.setChildCategories = function()
    {
        $.ajax({
            url: this.url,
            dataType: 'json',
            success: function(data)
            {
                $.each(data.childCategories, function()
                {
                    $($(this).parent().childCategoriesSelectid)//problem here
                    .append(
                        $('<option></option>')
                        .attr('value', this.childCategoryid)
                        .text(this.name)
                    );
                });
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:36:40.597

`parent()`用于 DOM 遍历。您所拥有的是范围界定问题。

进入新函数范围时，`this`关键字并不总是引用同一个对象。使用 jQuery 的方法时就是这种情况，该[`.each()`](http://api.jquery.com/jQuery.each/)方法将设置`this`为被迭代的对象/元素。

看起来您正在使用构造函数实例模式，因此您只需`this`通过 var 声明存储对关键字引用的原始对象（实例）的引用。此引用在作用域链中将保持不变：

```
function companiesPage()
{
    var _this = this; //stores a reference to this instance object
    this.childCategoriesSelectid = '#childCategoryid';

    this.setChildCategories = function()
    {
        $.ajax({
            url: this.url,
            dataType: 'json',
            success: function(data)
            {
                $.each(data.childCategories, function()
                {
                    $(_this.childCategoriesSelectid) //NO problem here :)
                    .append(
                        $('<option></option>')
                        .val(this.childCategoryid)
                        .text(this.name)
                    );
                });
            }
        });
    }
} 
```

这样，您将能够在实例内部的任何位置访问实例的任何公共方法和属性。

附言。按照惯例，Instanceables/Constructors 通常首字母大写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:34:35.923

## `this`在异步 Ajax 调用之前捕获

Ajax 成功处理程序是异步执行的，因此会丢失其被调用者上下文（或范围）。您必须捕获`this`自由变量并在函数闭包中使用捕获的变量。

### 看来您期望`this`有两个含义

1.  当你使用时，`$(this).parent()...`你期望`this`成为一些`HTMLDOMElement`
2.  当您使用时，`this.name`您期望成为（可能的数组）`this`中的对象项。`data`

## 获取对象实例引用的解决方案

很明显，companyPage 是您的类（应该是 Pascal 大小写而不是骆驼大小写）。因此使用`this`inside。您可能通过以下方式创建它：

```
var obj = new CompaniesPage();
obj.setChildCategories(); 
```

您的代码应如下所示：

```
var CompaniesPage = function()
{
    // keep this as public object property
    this.childCategoriesSelectId = "#childCategoryid";

    // keep this as public object method
    this.setChildCategories = function() {
        // private reference to object instance for later reuse
        var me = this;
        $.ajax({
            url: this.url, // not sure where this one's coming from
            dataType: 'json',
            success: function(data) {
                $.each(data.childCategories, function() {
                    $(me.childCategoriesSelectId).append(
                        $('<option></option>')
                            .attr('value', this.childCategoryid)
                            .text(this.name)
                    );
                });
            }
        });
    }
}; 
```

## 对您的课程进行额外优化

您还必须意识到，您定义类级方法的方式不是内存效率高，因为各个对象实例不会共享相同的方法，而是希望每个实例都有自己的方法，这会反映内存资源，尤其是当您创建同一类的多个实例。

这是您的课程的优化版本：

```
var CompaniesPage = function() {
    // keep this as public object property
    this.childCategoriesSelectId = "#childCategoryid";
}

CompaniesPage.prototype.setChildCategories = function() {
    // private reference to me as object instance
    var me = this;

    $.ajax({
        url: this.url, // not sure where this one's coming from
        dataType: 'json',
        success: function(data) {
            $.each(data.childCategories, function() {
                $(me.childCategoriesSelectId).append(
                    $('<option></option>')
                        .attr('value', this.childCategoryid)
                        .text(this.name)
                );
            });
        }
    });
}; 
```

# c# - 右键单击固定应用时添加任务选项

> ID：13420586
> 
> 赞同：3
> 
> 时间：2012-11-16T16:31:56.070
> 
> 标签：c#, options, tasklist, jump-list, right-click

我们有 ac# 应用程序，需要在每次启动之前完成几个步骤。我编写了 ac# app 来自动执行这些步骤。

谁能帮我弄清楚如何为我的应用程序[编辑：配置 JumpList]？

我已经包含了一个[屏幕截图](https://dev.alinity.com/LSS/WebClient/TBD/capture.jpg)，希望能够理解我的观点，因为我不确定如何更好地解释它。

提前感谢您提供的任何指导；山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:35:47.070

这些被称为“跳转列表”，请在[此处](http://archive.msdn.microsoft.com/WindowsAPICodePack)查看 Windows API 代码包。我不能确切地告诉你如何实现它们，因为它非常依赖于你的应用程序代码。但这应该给你一个开始的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:42:52.120

对于本机界面，请参阅[任务栏扩展 (Windows)](http://msdn.microsoft.com/en-us/library/windows/desktop/dd378460%28v=vs.85%29.aspx)。具体来说，我认为您正在寻找[ICustomDestinationList::AddUserTasks](http://msdn.microsoft.com/en-us/library/windows/desktop/dd378395%28v=vs.85%29.aspx)方法。

如果您使用的是 .Net 4+，您现在可以使用 System.Windows.Shell 命名空间中的内置类来做很多此类事情，而不是像 Coding Gorilla 建议的那样添加 Windows API 代码包。参见例如[System.Windows.Shell 命名空间](http://msdn.microsoft.com/en-us/library/system.windows.shell%28VS.100%29.aspx)

# jquery - 在 indexedDB 中创建两个对象存储并添加内容

> ID：13420587
> 
> 赞同：0
> 
> 时间：2012-11-16T16:31:59.180
> 
> 标签：jquery, indexeddb

关于[在同一脚本中创建各种 IndexedDB objectStores 的最佳方法是什么？](https://stackoverflow.com/questions/12638253/what-is-the-best-way-to-create-various-indexeddb-objectstores-within-the-same-sc)我创建了两个对象库：

```
var opinionObjectStore = thisDb.createObjectStore("opinion", {keyPath: "id", autoIncrement: false});
var commentObjectStore = thisDb.createObjectStore("comment", {keyPath: "id", autoIncrement: false}); 
```

然后我打开一个事务并获取两个对象存储：

```
var transo = myDataBase.transaction(["opinion", "comment"], "readwrite");
var opinionsObjectStore = transo.objectStore("opinion");
var commentsObjectStore = transo.objectStore("comment"); 
```

然后我创建我的“需要存储”对象：

```
var comment = {id: "myid"};
var resp = commentsObjectStore.add(comment);
// other instructions [...]
var opinion = {};
opinion.id = tagElement.id;
var resp = opinionsObjectStore.add(opinion); 
```

我得到一个例外：

```
DataError: Data provided to an operation does not meet requirements.
[Break On This Error]
var resp = commentsObjectStore.add(comment); 
```

你能帮我让我添加我的评论并且不要抛出异常吗？

在 indexedDB 中添加数据时，我已经阅读了[DOM IDBDatabase 异常 5，](https://stackoverflow.com/questions/10509546/getting-uncaught-error-data-err-dom-idbdatabase-exception-5-while-trying-to-ad)并且[在尝试将数据添加到 indexedDB 时出现错误“提供给操作的数据不符合要求”，](https://stackoverflow.com/questions/9900705/indexeddb-sorrow)这无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T03:02:39.940

`DataError`是关键错误。所以一定是您没有提供密钥或密钥无效。

但是，从您的代码中，您提供了一个有效的密钥，它可能是密钥已经存在。在这种情况下，浏览器应该抛出`ConstraintError`. 它是哪个浏览器？

还要清除浏览器中的应用数据（IndexedDB 数据），然后重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T08:26:59.180

也许试试我的 indexedDBViewer，用它你可以检查你的 indexeddb 结构+数据。也许有了这个，您可以找出问题所在。我认为这与评论的对象存储定义有关。也许您最初使用其他选项创建了对象存储，并且没有使用您现在提供的版本重新创建。

[你可以在这里](http://www.kristofdegrave.be/2012/11/indexeddbviewer-take-look-inside-your.html)找到我的 indexeddbviewer ，[在这里](http://linq2indexeddb.codeplex.com/releases)你可以找到一篇关于如何使用它的博文。如果您是 Visual Studio 开发人员，您还可以在 nugget 上搜索“indexedDBViewer”包。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T11:50:37.093

发现问题：

```
tagElement.id; 
```

如果 tagElement 是来自的 xml 节点：

```
liveXml.find('Comment').each(function(){
    var tagElement = $(this); 
```

然后`tagElement.id`是未定义的，但`tagElement.attr('id')`已定义。jQuery 很重要！

# unix - How do I get the maximum value for a text in a UNIX file as shown below?

> ID：13420594
> 
> 赞同：0
> 
> 时间：2012-11-16T16:32:17.590
> 
> 标签：unix

I have a unix file with the following contents.

```
$cat myfile.txt
abc:1
abc:2
hello:3
hello:6
wonderful:1
hai:2
hai:4
hai:8 
```

How do I get the max value given for each text in the file above.

'abc' value 2 'hello' value 6 'hai' value 8 'womderful' 1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T01:22:00.637

Based on the current example in your question, minus the first line of expected output:

```
awk -F':' '{arr[$1]=$2 ; next} END {for (i in arr) {print i, arr[i]} } ' inputfile 
```

You example input and expected output are very confusing.... The reason I posted this is to get feedback from the OP forthcoming

This assumes the data is unsorted, but also works with sorted data (New):

```
sort -t: -k2n inputfile | awk -F':' '{arr[$1]=$2 ; next} END {for (i in arr) {print i, arr[i]} } ' 
```

# android - 如何频繁添加和删除相同的片段

> ID：13420596
> 
> 赞同：0
> 
> 时间：2012-11-16T16:32:20.243
> 
> 标签：android, fragment, fragmenttransaction

我的应用程序通常会多次添加然后删除相同的片段。下面是我如何做到这一点：

`Add fragment`

```
if (mHomeFragment == null)
    {
        mHomeFragment = new HomeFragment();
        new Handler().postDelayed(new Runnable()
        {
            @Override
            public void run()
            {
                getSupportFragmentManager().beginTransaction().add(R.id.dummy, mHomeFragment).commit();
            }
        }, getResources().getInteger(R.integer.transition_duration));
    }
else
    {
        getSupportFragmentManager().beginTransaction().add(R.id.dummy, mHomeFragment).commit();
    } 
```

`Remove fragment`

```
getSupportFragmentManager().beginTransaction().remove(mHomeFragment).commit(); 
```

问题是，有时当从包含该片段（HomeFragment）的活动导航到另一个活动时，我的应用程序崩溃了。我试图找出原因，但仍然没有办法。我这里没有完整的错误日志，因为此错误不经常发生，但错误与此相同[https://android.googlesource.com/platform/frameworks/support/+/5506618c80a292ac275d8b0c1046b446c7f58836%5E!/](https://android.googlesource.com/platform/frameworks/support/+/5506618c80a292ac275d8b0c1046b446c7f58836%5E!/)：

```
IllegalStateException: Failure saving state......active HomeFragment{419494f0} has cleared index: -1 
```

有没有人看到我的代码有任何问题，或者只是知道如何解决这个错误，请帮助我。谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:54:57.137

听起来，在活动暂停或完成后，runnable 可能正在运行。只需确保在活动的 onPause 方法上调用 handler.removeCallback 以避免活动完成后的回调。

如果你需要经常交换片段，你可以使用 FragmentTransaction 的[hide](http://developer.android.com/reference/android/app/FragmentTransaction.html#hide%28android.app.Fragment%29)和[show](http://developer.android.com/reference/android/app/FragmentTransaction.html#show%28android.app.Fragment%29)方法来避免初始化开销。

# replace - 将文本替换为数字php

> ID：13420599
> 
> 赞同：0
> 
> 时间：2012-11-16T16:32:28.713
> 
> 标签：replace, str-replace

我需要用逗号替换一个简单的文本来编号。

```
CSV File: 

Test1
Test1, Test2
Test1, Test2, Test3 
```

php代码

```
$text = "Test1";
$text1 = "Test1, Test2";
$text1 = "Test1, Test2, Test3";

$search = array('$text','$text1','$text2');
$replace = array('10','11','12');
$result = str_replace($search, $replace, $file);
echo "$result"; 
```

结果是： "10","10, 11","10, 11, 12"

但我想得到“10”、“11”、“12”。

这是最终脚本，但其中一个我得到“10、12”

```
$text1 = "Test1";
$text2 = "Test2";
$text3 = "Test3";
$text4 = "Test1, Test2, Test3";
$text5 = "Test1, Test2";
$text6 = "Test1, Test3";
$text7 = "Test2, Test3";
$text8 = "Blank";
array($text8,$text7,$text6,$text5,$text4,$text3,$text2,$text1);
array('10','11','12','13','14','15','16','17'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:37:15.083

您可能不想拥有这些字符串文字：

```
$search = array('$text','$text1','$text2'); 
```

尝试

```
$search = array($text,$text1,$text2); 
```

当你使用单引号时，变量不会被解析，所以

```
$text1 = 'Hello';
$text2 = '$text1';
echo $text2; // $text1 
```

VS

```
$text1 = 'Hello';
$text2 = $text1;
echo $text2; // Hello 
```

结果来自：

```
Test1
Test1, Test2
Test1, Test2, Test3 
```

将是 Test1 的每个实例都替换为 10，依此类推 - 所以：

```
10
10, 11
10, 11, 12 
```

*更新*

我明白你在做什么。当你将数组传递给`str_replace`它时，它会按顺序处理它们——所以当它寻找`Test1, Test2`你的时候，你已经`Test1`用 10 个替换了。颠倒顺序做你想做的事......

```
$text = "Test1";
$text1 = "Test1, Test2";
$text2 = "Test1, Test2, Test3";

$search = array($text2,$text1,$text); // reversed
$replace = array('12', '11', '10');// reversed
$result = str_replace($search, $replace, $file);
echo $result; 
```

# java - 从公共方法返回 InputStream

> ID：13420600
> 
> 赞同：11
> 
> 时间：2012-11-16T16:32:31.620
> 
> 标签：java, io, inputstream

我有一个类，一方面，`InputStream`从公共方法返回一个感觉是正确的，例如

```
public class MyClass {

    private File _file;

    ...

    public InputStream getInputStream() {
        return new FileInputStream( _file );
    }
} 
```

但是，我对此也非常谨慎，因为它使调用者有责任关闭此流。我可以通过哪些方式潜在地避免这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-16T16:40:16.767

取决于为什么这是您眼中的问题。如果您绝对必须返回一个`InputStream`并且有问题的文件不是太大，您可以将整个文件缓冲到一个字节数组中，关闭原始流和`return new ByteArrayInputStream(buf)`. 关闭 a`ByteArrayInputStream`不是必需的（实际上没有效果）。

但是，如果返回 an “感觉正确” `InputStream`，那么调用者应该*期待*an`InputStream`以及随之而来的所有事情，包括完成后关闭流的必要性，这难道没有意义吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-17T08:43:12.080

回归`InputStream`本质上并不是一件坏事。现在，如果您希望您的调用者在不负责关闭资源的情况下访问数据，您可以这样做：

```
interface InputReader {
    void readInput(InputStream is);
}
public class MyClass {
    void feed(InputReader ir){
       try(InputStream is=new FileInputStream( _file )){
          ir.readInput(is);
       }
    }
} 
```

调用者指定一个实例`InputReader`，它将接收可关闭资源作为参数，并且不再负责关闭它。

```
MyClass myClass = ... ; //Get the instance
myClass.feed( new InputReader() {
    @Override
    void readInput(InputStream is){
       ... ; // Use at will without closing
    }
}); 
```

应该考虑`InputStream`在将其传递给抛出和异常之前对其`InputReader`进行`.close()`装饰。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-16T16:39:03.100

实际上，如果不了解有关课程的更多详细信息，您将无能为力。您可以通过 MyClass 中的方法提供文件处理（这需要知道文件内容的含义）并在流为空时关闭流。但除此之外，该类的用户对该对象负责，您无法真正避免这种情况。如果没有析构函数的能力，就像在 C++ 中一样，你不能对任何离开你的类范围的对象负 100% 的责任。

您*可以*做的是`close()`在您的类上放置一个方法来清理所有打开的文件处理程序、连接等，并要求该类的用户负责调用`close()`. 有关如何使用该方法跟踪调用者是否正确关闭您的课程的一些讨论，请参阅[此问题。](https://stackoverflow.com/questions/158174/why-would-you-ever-implement-finalize)`finalize`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-16T16:37:42.390

> ...因为它使调用者有责任关闭此流。

是的，调用者负责处理返回的流的关闭操作。由于您的方法无法跟踪其返回的内容，*因此该任务完全属于调用者*。这种情况和使用异常有一个类比。开发人员使用异常是因为 API 作者不能总是控制他们呈现给我们的内容。我们必须小心，例如当有可能将数字除以零时。

# javascript - 在对象内设置 onCLick 回调？

> ID：13420606
> 
> 赞同：0
> 
> 时间：2012-11-16T16:32:48.610
> 
> 标签：javascript, html

我有一个轮播对象，带有图像和寻呼机。问题是我无法将 onClick 设置为寻呼机。我显然在这里遗漏了一些东西，但我不知道是什么。

单击寻呼机项目时的错误是：

`Uncaught TypeError: Object #<HTMLDivElement> has no method 'scrollCarouselTo'`

我设置了我的点击

```
 carouselDots.on('click',function(){  
        this.scrollCarouselTo(1,5);   // <-- problem lies here, how can i call this method?
    }); 
```

和 scrollTo 方法

```
this.scrollCarouselTo=function(dotIndex, numDots)
    {       
        //H_SCROLL.scrollToElement("#carouselItem"+dotIndex, 300);
        H_SCROLL.scrollToPage(dotIndex, 0 , 300);
        this.highlightCarouselDot(dotIndex, numDots);
    } 
```

最后，在我的 HTML 文件中，我是这样设置的：

```
var tempCarousel = new Carousel();
tempCarousel.initialize(params,cont,scrollContainer); 
```

我的轮播课程：（我认为相关的部分）

```
function Carousel() {

var container;
var pager;
var opt;
var thisCarousel;

//render the correct number of dots and highlight the indexed one
this.highlightCarouselDot=function(dotIndex, numDots)
    {       
        var ui_str="";
        console.log("numDots" + numDots);
        for (var i=0;i<numDots;i++)
        {
            if (i==dotIndex)
                ui_str+='<div class="carouselDot selected" id="carouselDot'+i+'"></div>';
            else
                ui_str+='<div class="carouselDot" id="carouselDot'+i+'"></div>';
        }

        console.log(ui_str);
        console.log(pager);
        pager.html(ui_str);

        var carouselDots = $(pager.selector + " .carouselDot");
        var dotSelected = $(pager.selector + " .selected");
        carouselDots.css('background',opt.pagerImage);
        carouselDots.width(opt.pagerSize);
        carouselDots.height(opt.pagerSize);
        carouselDots.on('click',function(){  //replace with touch
            this.scrollCarouselTo(0,5);
        });
        dotSelected.css('background',opt.pagerSelectedImage);

    }

    this.scrollCarouselTo=function(dotIndex, numDots)
    {       
        //H_SCROLL.scrollToElement("#carouselItem"+dotIndex, 300);
        H_SCROLL.scrollToPage(dotIndex, 0 , 300);
        this.highlightCarouselDot(dotIndex, numDots);
    }

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:40:01.260

您无法理解代码中范围的变化。是`this`指您所在的对象，但是当您分配事件处理程序（例如 onclick）时，该函数将在被单击的 UI 元素的范围内运行。这意味着在您的 onclick 代码中，`this`指的是被点击的 html 对象，而不是`highlightCarouselDot`对象。

这个问题的一个常见解决方案是使用一个额外的变量来存储 this 的值。

```
var self = this; 
```

在对象的开头，这样当您想要引用外部对象时，您可以在事件处理程序中引用 self 。

# mysql - CREATE TABLE 上不存在表？

> ID：13420608
> 
> 赞同：1
> 
> 时间：2012-11-16T16:32:57.370
> 
> 标签：mysql, phpmyadmin

我正在尝试将 SQL 转储导入另一台服务器。它在第一行失败。我首先创建`exp_actions`表，然后将一堆数据插入其中，但我得到了这个非常奇怪的错误。

```
SQL query:

--
-- Database: `ee_cmssite`
--
-- --------------------------------------------------------
--
-- Table structure for table `exp_actions`
--
CREATE TABLE  `exp_actions` (

 `action_id` INT( 4 ) UNSIGNED NOT NULL AUTO_INCREMENT ,
 `class` VARCHAR( 50 ) NOT NULL DEFAULT  '',
 `method` VARCHAR( 50 ) NOT NULL DEFAULT  '',
PRIMARY KEY (  `action_id` )
) ENGINE = MYISAM DEFAULT CHARSET = latin1 AUTO_INCREMENT =21;

MySQL said: 

#1146 - Table 'site_ee.exp_actions' doesn't exist 
```

为什么不存在？我只是指示它被创建。我完全感到困惑。我试过有无`IF_NOT_EXISTS`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-16T11:28:04.487

如果其他人遇到这个看似奇怪的错误 - 请参阅[https://stackoverflow.com/a/11696069](https://stackoverflow.com/a/11696069)以获取解决方案。

我有同样的症状，原因也是一样的——移动到新机器我采用了旧的捷径，只需将我需要的 mysql/data 目录中的数据库直接复制到新机器中，但是有些是较新的 InnoDb 类型. 这会导致 Create Table throws table doesn't exist 错误。我不得不删除数据库并重新创建它，然后从 sql 转储中导入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:36:24.077

根据 SQL 脚本，该表存在于另一个数据库中：

> --
> 
> ## -- 数据库：`ee_cmssite`
> 
> ## -------------------------------------------------- --------
> 
> -- 表的表结构`exp_actions`

尝试改用`ee_cmssite`数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T01:01:39.183

虽然错误不清楚，但我认为这与`USE`文件开头的缺失有关。`USE`当您转储单个数据库时，mysqldump 不会添加语句。所以你应该添加：

```
USE `ee_cmssite`; 
```

# c# - 如何将内部文本和 Xml 复制到另一个标签中

> ID：13420609
> 
> 赞同：0
> 
> 时间：2012-11-16T16:32:57.007
> 
> 标签：c#, xml, xslt

我正在开发一个 C# 应用程序，该应用程序将两个 Xml 文档分开，合并它们的一些标记内容，并生成第三个 Xml 文档。我面临一种情况，我需要提取一个标签的值，包括内部标签，并将其转移到另一个标签。我开始做这样的事情：

```
var summaryElement = elementExternal.Element("summary");
var summaryValue = (string)summaryElement;
var summaryValueClean = ElementValueClean(summaryValue);

var result = new XElement("para", summaryValueClean) 
```

ElementValueClean 函数删除无关空白的地方。

如果摘要标签的值仅包含文本，这将令人满意。当摘要标签包含子元素时，问题就来了：

```
<summary>
   Notifies the context that a new link exists between the <paramref name="source" /> and <paramref name="target" /> objects
   and that the link is represented via the source.<paramref name="sourceProperty" /> which is a collection.
   The context adds this link to the set of newly created links to be sent to
   the data service on the next call to SaveChanges().
</summary> 
```

我想制作这样的东西：

```
<para>
Notifies the context that a new link exists between the <paramref name="source" /> and <paramref name="target" /> objects
and that the link is represented via the source.<paramref name="sourceProperty" /> which is a collection.
The context adds this link to the set of newly created links to be sent to
the data service on the next call to SaveChanges().
</para> 
```

在我的源标签目录中可能出现大约十几个可能的嵌入标签，我必须将其内容合并到输出标签中。所以我想要一个可以概括的 C# 解决方案。但是，如果它足够简单，我可以将其应用于 Xml 片段以生成 Xml 片段的 Xslt 转换也对我有用。我的 Xslt 技能因废弃而减少。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:51:10.280

您可以更新`ElementValueClean()`函数以支持内联节点并接受 Element 而不是其字符串值：

```
foreach (XmlNode n in summaryElement.Nodes()) {
  if (node.NodeType == XmlNodeType.Text) {
      //do text cleanup
  }
  else n
} 
```

重新包装元素的 XSLT 非常简单，但我认为 C# 解决方案仍然更有意义，因为您已经有了可用的 C# 文本清理解决方案。

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    exclude-result-prefixes="xs"
    version="2.0">

    <xsl:template match="summary">
        <para><xsl:apply-templates/></para>
    </xsl:template>

    <xsl:template match="node()|@*" priority="-1" mode="#default">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*" mode="#current"/>
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

或者您可以在 XSLT 中完成所有工作，包括文本清理。不清楚该函数的作用，但这是在 XSLT 中启动它的方式：

```
<xsl:template match="text()">
    <xsl:value-of select="normalize-space(.)"/>
</xsl:template> 
```

# grails - Grails commandObject beforeValidate

> ID：13420615
> 
> 赞同：2
> 
> 时间：2012-11-16T16:33:14.310
> 
> 标签：grails, command-objects

看起来 grails 中的命令对象缺少域类具有的 beforeValidate 方法？

我不太清楚为什么会这样，或者我是否遗漏了什么？

我有几个命令类，我想在验证之前做一些空白修剪等，这样我就可以轻松地使用一些标准验证约束，而不必创建自定义验证器来完成这项任务。

是否有公认的最佳方法来做到这一点？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-08-19T13:37:59.147

见：[https ://github.com/grails/grails-core/issues/3895](https://github.com/grails/grails-core/issues/3895)

我猜他们重复了实现......当然，这是grails，他们没有很好的质量保证......（使用Java-EE的验证API（javax.validation）可能会更好）

# java - Hibernate Envers - 被审计实体无法从空的审计表关系中恢复 ID

> ID：13420618
> 
> 赞同：2
> 
> 时间：2012-11-16T16:33:27.423
> 
> 标签：java, hibernate, entity

我需要一些有关 Hibernate Envers 的帮助。我有以下情况：

我在 Hibernate/JPA 中有一个实体，这个实体有一个正常的配置：

```
 package com.algar.fsw.siscos.model;

/**
 * TbUsuario generated by hbm2java
 */
@Entity
@Table(name = "SCCTB023_USUARIO")
@Audited
@AuditTable("SCCTB047_USUARIO_ADTRA")
public class Usuario implements java.io.Serializable {

    @Id
    @Column(name = "NU_USUARIO", nullable = false, scale = 0)
    @NotNull
    private Long id;

    @Column(name = "NO_USUARIO", nullable = false, length = 50)
    @NotNull
    @Length(max = 50)
    private String nome;

    @Column(name = "NO_LOGIN", unique = true, nullable = false, length = 16)
    @NotNull
    @Length(max = 16)
    private String login;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "NU_PERFIL", nullable = false)
    private Perfil perfil = new Perfil();

    @OneToMany(fetch = FetchType.LAZY, mappedBy = "usuario" , cascade = CascadeType.ALL)
    private List<UsuarioGrupo> usuariosGrupos = new ArrayList<UsuarioGrupo>();

    public Usuario() {
    }

    public Usuario(Long id ) {
        this.id = id;
    }

    public Long getId() {
        return this.id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getNome() {
        return nome;
    }
    public void setNome(String nome) {
        this.nome = nome;
    }

    public String getLogin() {
        return login;
    }
    public void setLogin(String login) {
        this.login = login;
    }

    public Perfil getPerfil() {
        return perfil;
    }
    public void setPerfil(Perfil perfil) {
        this.perfil = perfil;
    }

    public List<UsuarioGrupo> getUsuariosGrupos() {
        return usuariosGrupos;
    }
    public void setUsuariosGrupos(List<UsuarioGrupo> usuariosGrupos) {
        this.usuariosGrupos = usuariosGrupos;
    }
} 
```

并且，这个实体与这个实体有关系：

```
package com.algar.fsw.siscos.model;

@Entity
@Table(name = "SCCTB018_PERFIL")
@Audited
@AuditTable("SCCTB042_PERFIL_ADTRA")
public class Perfil implements java.io.Serializable {

    @Id
    @Column(name = "NU_PERFIL", nullable = false, scale = 0)
    @NotNull
    private Long id;

    @Column(name = "NO_PERFIL", nullable = false, length = 30)
    @NotNull
    @Enumerated(EnumType.STRING)
    private PerfilEnum perfilEnum;

    @Column(name = "IC_ATIVO", nullable = false, precision = 1, scale = 0)
    private boolean ativo = true;

    @Column(name = "NU_NIVEL", nullable = false, precision = 1, scale = 0)
    private Long nivel;

    public Long getId() {
        return this.id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getNome() {
        return perfilEnum.toString();
    }

    public boolean isAtivo() {
        return ativo;
    }
    public void setAtivo(boolean ativo) {
        this.ativo = ativo;
    }

    public Long getNivel() {
        return nivel;
    }

    public void setNivel(Long nivel) {
        this.nivel = nivel;
    }

    public PerfilEnum getPerfilEnum() {
        return perfilEnum;
    }

    public void setPerfilEnum(PerfilEnum perfilEnum) {
        this.perfilEnum = perfilEnum;
    }
} 
```

当我检索 Usuario 信息时，一切正常，但是当我调用**getPerfil**方法时，由于关系的 ID，我收到了 NoEntityFoundException。数据只存在于常规表中，在审计表中数据不存在，因为审计表是在原始表中已经存在数据之后创建的，因此审计表中没有记录。我只需要恢复 ID，不需要来自 Perfil 的数据。所以，如果我调用**getPerfil**，我唯一需要的就是 ID 信息。

有谁知道此类问题的解决方法或解决方案？

我需要这个的原因是因为一个 WEB 应用程序有一个屏幕显示某些实体的更改，显示值：date_created、property_changed、value_before 和 value_after。因此，我正在构建逻辑以在 java 中手动比较修订。

请问，谁能帮帮我？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-10-07T16:35:44.137

您将需要对表进行本机 sql 查询并提取 id。您最初需要提取修订 id（进行查询），然后重新请求数据（使用本机查询获取必要的 id）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T19:37:48.243

如果您在开始使用 Envers 之前有数据，您应该创建一个包含所有数据的初始“0”版本。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-12-04T13:17:19.473

我遇到了类似的问题，唯一对我有帮助的解决方案（解决方法）是在 envers 之前手动插入所有数据作为具有零时间戳（1970-01-01）的初始修订版 1。对于您的情况，它将是这样的：

```
INSERT INTO REVINFO(REV, REVTSTMP) VALUES(1, 0);

INSERT INTO SCCTB047_USUARIO_ADTRA
(REV, REVTYPE, NU_USUARIO, NO_USUARIO, NO_LOGIN, NU_PERFIL)
SELECT 1, 0, NU_USUARIO, NO_USUARIO, NO_LOGIN, NU_PERFIL FROM SCCTB023_USUARIO;

INSERT INTO SCCTB042_PERFIL_ADTRA
(REV, REVTYPE, NU_PERFIL, NO_PERFIL, IC_ATIVO, NU_NIVEL)
SELECT 1, 0, NU_PERFIL, NO_PERFIL, IC_ATIVO, NU_NIVEL FROM SCCTB018_PERFIL; 
```

# ruby-on-rails - 批量分配、嵌套表单和当前用户作为作者

> ID：13420623
> 
> 赞同：0
> 
> 时间：2012-11-16T16:33:37.027
> 
> 标签：ruby-on-rails, nested-attributes, fields-for

我有几个对象，foo、bar 和 user。

我有一个用于创建新的 foo 对象的表单，它使用 simple_fields_for 和 accept_nested_attributes_for 同时创建一个新的子栏对象。

现在，我想将 current_user 设置为新栏的作者属性，但我不知道如何最好地做到这一点。（仍然是 Rails 的新手。）

我在 foo 控制器的 create 方法中尝试了以下操作：

```
def create
    @foo = Foo.build(params[:foo])

    @foo.bars.find(:first).author = current_user 
```

但是，当我运行它时，我得到了一个例外。

```
undefined method `author=' for nil:NilClass 
```

任何人都可以就如何最好地解决这个问题提供任何建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:41:48.067

您可能需要`Bar`在`@foo`. IE

```
def new
  @foo = Foo.new
  @foo.bars.build
end

def create
   @foo = Foo.new(params[:foo])
   @foo.bars.first.author = current_user
   if @foo.save 
     redirect_to @foo
   else
     render action: "new"
   end
end 
```

嵌套表单的好资源：[http ://railscasts.com/episodes/196-nested-model-form-part-1?view=asciicast](http://railscasts.com/episodes/196-nested-model-form-part-1?view=asciicast)

如果您在模型中设置了accepts_nested_attributes_for 并`fields_for`在表单中正确使用，`params[:foo]`将包含一个名为的元素，该元素`bar_attributes`将包含在表单中输入的关于 bar 对象的数据。查看我链接到的铁路广播以获取更多信息。

# android - 同一类内的访问变量

> ID：13420625
> 
> 赞同：2
> 
> 时间：2012-11-16T16:33:43.163
> 
> 标签：android

我有一个带有按钮的自定义视图类，我让用户触摸屏幕，以便检索坐标。我想要做的是，每当他单击按钮时，将其文本设置为他的触摸坐标。我该怎么做呢？

```
public class TargetView extends RelativeLayout{
    .
    .
    .
    public float x=0;
    public float y=0;

    public TargetView(final Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);

    ((Activity)getContext())
        .getLayoutInflater()
        .inflate(R.layout.target_view, this, true);

    Target=findViewById(R.id.target);
    Undo=(Button)findViewById(R.id.undo_bt);

    Undo.setOnClickListener(new OnClickListener(){

        public void onClick(View v) {
            Log.d("x,y",(String.valueOf(x)+","+String.valueOf(y)));
            Undo.setText(String.valueOf(x)+","+String.valueOf(y));

        }

    });

        @Override
        public boolean onTouchEvent(MotionEvent event){

        switch (event.getAction()){
        case (MotionEvent.ACTION_DOWN): {

                 x = event.getX();
                 y = event.getY();
            }
            return false;
        } 
        . 
        .
        .
 } 
```

**编辑** 我在按钮侦听器中添加了一个 Log.d ，似乎只有在用户触摸屏幕的其余部分并更改 x、y （文本更改为“0.0”）之前单击按钮。

我的 .xml 文件：

```
 <?xml version="1.0" encoding="utf-8"?>
      <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

       <android.archer.test.TargetView
        android:id="@+id/myTargetView"
        android:layout_width="300dip"
        android:layout_height="300dip"
        android:layout_gravity="center_horizontal"
        android:background="@drawable/target" >
       </android.archer.test.TargetView> 

      </LinearLayout> 
```

```
<merge xmlns:android="http://schemas.android.com/apk/res/android">

  <View
       android:id="@+id/target"
       android:layout_width="300dp"
       android:layout_height="350dip" />

    <RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <Button
      android:id="@+id/undo_bt"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:layout_alignParentBottom="true"
      android:layout_alignParentLeft="true"
          android:text="-" />

    </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:05:01.663

**-**`super.onTouchEvent(event)`在 onTouchEvent 方法结束时返回。

**例如：**

```
@Override
    public boolean onTouchEvent(MotionEvent event){

    switch (event.getAction()){
    case (MotionEvent.ACTION_DOWN): {

             x = event.getX();
             y = event.getY();
        }
        return super.onTouchEvent(event);
    } 
```

**-**此外，Android 维护视图的层次结构，并相应地处理事件。层次结构中的每个视图都会获取事件，**但前提是父事件尚未使用它**。含义 - 如果您有一个`onTouchEvent()`每次都处理并返回 true的父视图，**那么子视图永远不会收到事件**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:35:58.680

更改`return`您的代码段：

```
 @Override
    public boolean onTouchEvent(MotionEvent event){

    switch (event.getAction()){
    case (MotionEvent.ACTION_DOWN): {

             x = event.getX();
             y = event.getY();
        }
        return false;
    } 
```

至`return true;`

如果可能的话，您可以将日志放入您的 onTouchEvent 以查看它是否可以返回坐标。

# android - 如何对活动进行着色/调暗

> ID：13420632
> 
> 赞同：1
> 
> 时间：2012-11-16T16:34:00.337
> 
> 标签：android, android-layout

我的操作栏中有一个按钮，当我单击我想调暗当前活动时。褪色 alpha 不起作用，因为背景是白色的，我需要它变暗。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:53:40.293

用暗灰色透明图像覆盖整个布局（即，用整个屏幕覆盖图像）。我希望这个想法对你有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:54:44.590

可能最简单的方法是创建一个缩放以覆盖整个活动的视图，将其背景颜色设置为半透明。您还可以检查股票警报应用程序是如何做到的。

# powershell - 远程机器不执行程序

> ID：13420634
> 
> 赞同：0
> 
> 时间：2012-11-16T16:34:03.607
> 
> 标签：powershell, powershell-2.0

这是我到目前为止所拥有的：

```
$source1="C:\Folder\Files\IPList.txt"
Get-Content $source1 |
Where-Object {-not(gwmi win32_process -ComputerName $_ -filter "name='Program.exe'")} |
Foreach-Object {Invoke-Command -ComputerName $_ -ScriptBlock {"C:\Program Files\Folder\Folder\Program.exe"}} 
```

当我在 ISE 中运行它时，一切都恢复正常并说它运行正确。但是，当我查看我的远程机器时，什么都没有执行。Process Program.exe 未运行，应启动该 exe。我正在从服务器运行它来访问大约 50 台远程机器。一旦它通过所有 50，我将循环它并让它再次执行，然后在无限循环中继续该过程。

程序远程启动我缺少什么？顺便说一句，我在 Server 2008 R2 上运行这个脚本，它正在运行 Windows 7 机器。

***编辑***

我想知道，因为我可以看到进程启动，这是 Windows 7 的问题吗？我知道微软改变了一些事情，服务无法在用户空间中启动应用程序。你认为这会是同一个问题的一部分吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:29:47.723

尝试将调用 (&) 运算符添加到 ScriptBlock：

```
$source1="C:\Folder\Files\IPList.txt"
Get-Content $source1 |
Where-Object {-not(gwmi win32_process -ComputerName $_ -filter "name='Program.exe'")} |
Foreach-Object {Invoke-Command -ComputerName $_ -ScriptBlock {& "C:\Program Files\Folder\Folder\Program.exe"}} 
```

这是一篇关于您可以使用的各种方法的好文章： http: [//social.technet.microsoft.com/wiki/contents/articles/7703.powershell-running-executables.aspx](http://social.technet.microsoft.com/wiki/contents/articles/7703.powershell-running-executables.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T15:22:44.573

在您当前的语法中，您传递的命令只是一个字符串！这是远程端发生的事情：

```
PS C:\> "C:\Program Files\Console2\Console.exe"
C:\Program Files\Console2\Console.exe 
```

Powershell 正在回显您的字符串！

我将引用此处提到的 Oliver Lipkau：[来源](http://social.technet.microsoft.com/Forums/en-US/ITCG/thread/ead19612-5e7b-4012-8466-0d650232c7a5/)

*如果您需要在脚本完成后继续运行的远程计算机上启动一个进程，请使用此函数：*

```
Function New-Process ([string]$computername, [string]$name) {   
  ([WMICLASS]"\\$computername\ROOT\CIMV2:win32_process").Create($name) 
} 
```

# ruby-on-rails - 水豚提交表单后的空参数哈希

> ID：13420635
> 
> 赞同：1
> 
> 时间：2012-11-16T16:34:05.423
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cucumber, capybara

当我使用下面指定的代码（在 Cucumber 测试中）填写表单并提交表单时，我的`params`哈希在控制器处完全为空。

我已经进行了一些调试，并且在 Capybara 的某个深层，当它实际发送时，Nokogiri 节点在调用`value`之前没有设置属性。`click_button`

```
visit '/'
click_link 'Sign out' if has_link? 'Sign out'
click_link 'Log in'

find(:css, '#user_email').set 'my@email.com'
find(:css, '#user_password').set 'foobar'
find(:css, '#user_remember_me').set true

click_button 'Sign in' 
```

我`params`在控制器的哈希：

```
{"utf8"=>"✓", "user"=>{"email"=>"", "password"=>"", "remember_me"=>"1"}, "commit"=>"Sign in", "action"=>"create", "controller"=>"auth"} 
```

HTML 表单是这样的：

```
<form accept-charset="UTF-8" action="/users/sign_in" class="new_user" id="new_user" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="blah-blah-blah"></div>
<div class="email">
<label for="user_email" title="Email or LDAP username">Login</label>
:
<input autofocus="autofocus" id="user_email" name="user[email]" placeholder="EMAIL or LDAP" size="30" title="Email or LDAP username" type="text" value="">
</div>
<div class="password">
<label for="user_password">Password</label>
:
<input id="user_password" name="user[password]" placeholder="PASSWORD" size="30" type="password">
</div>
<div class="rememberable">
<label for="user_remember_me">Remember me</label>
:
<div class="checkbox">
<input name="user[remember_me]" type="hidden" value="0"><input id="user_remember_me" name="user[remember_me]" type="checkbox" value="1">
</div>
</div>
<div class="signin">
<div class="wrapper">
<div class="input">
Sign in
<input name="commit" type="submit" value="Sign in">
</div>
</div>
</div>
</form> 
```

运行的输出`cucumber features/my_feature.feature -vb`：

```
shybovycha@shybovycha-laptop:~/projects/rails/my_project$ cucumber features/my_feature.feature -vb
Using the default profile...
Code:
  * features/support/env.rb
[RailsAdmin] RailsAdmin initialization disabled by default. Pass SKIP_RAILS_ADMIN_INITIALIZER=false if you need it.
Clearing database
Running db:migrate
Running db:seed for our instance
  * features/support/capybara_headers.rb
  * features/step_definitions/backoffice.rb
  * features/step_definitions/content_verification .rb
  * features/step_definitions/db_manipulation.rb
  * features/step_definitions/forms_and_links.rb
  * features/step_definitions/jenkins_integration.rb
  * features/step_definitions/mobile_view.rb
  * features/step_definitions/navigation.rb
  * features/step_definitions/users_manipulation.rb

Features:
  * features/my_feature.feature
Parsing feature files took 0m0.135s

Feature: my_feature

  Scenario: do some actions               # features/my_feature.feature:3
    Given a logged in user                 # features/step_definitions/users_manipulation.rb:45
    And some data exists                      # features/step_definitions/db_manipulation.rb:12
    When I visit some page        # features/step_definitions/navigation.rb:13
    And click "Subscribe" link                      # features/step_definitions/forms_and_links.rb:6
      no link with title, id or text 'Subscribe' found (Capybara::ElementNotFound)
      /var/lib/gems/1.9.1/gems/capybara-1.1.3/lib/capybara/node/finders.rb:154:in `raise_find_error'
      /var/lib/gems/1.9.1/gems/capybara-1.1.3/lib/capybara/node/finders.rb:27:in `block in find'
      /var/lib/gems/1.9.1/gems/capybara-1.1.3/lib/capybara/node/base.rb:54:in `wait_until'
      /var/lib/gems/1.9.1/gems/capybara-1.1.3/lib/capybara/node/finders.rb:27:in `find'
      /var/lib/gems/1.9.1/gems/capybara-1.1.3/lib/capybara/node/actions.rb:27:in `click_link'
      (eval):2:in `click_link'
      /var/lib/gems/1.9.1/gems/capybara-1.1.3/lib/capybara/dsl.rb:161:in `click_link'
      /home/shybovycha/projects/rails/my_project/features/step_definitions/forms_and_links.rb:8:in `block in <top (required)>'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/core_ext/instance_exec.rb:48:in `instance_exec'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/core_ext/instance_exec.rb:48:in `block in cucumber_instance_exec'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/core_ext/instance_exec.rb:69:in `cucumber_run_with_backtrace_filtering'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/core_ext/instance_exec.rb:36:in `cucumber_instance_exec'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/rb_support/rb_step_definition.rb:69:in `invoke'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/step_match.rb:25:in `invoke'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/step_invocation.rb:60:in `invoke'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/step_invocation.rb:38:in `accept'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:99:in `block in visit_step'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:163:in `broadcast'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:98:in `visit_step'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/step_collection.rb:15:in `block in accept'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/step_collection.rb:14:in `each'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/step_collection.rb:14:in `accept'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:93:in `block in visit_steps'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:163:in `broadcast'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:92:in `visit_steps'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/scenario.rb:55:in `block (2 levels) in accept'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:80:in `block (2 levels) in with_hooks'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:96:in `before_and_after'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:79:in `block in with_hooks'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:120:in `call'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:120:in `block (3 levels) in around'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/language_support/language_methods.rb:9:in `block in around'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/language_support/language_methods.rb:91:in `call'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/language_support/language_methods.rb:91:in `execute_around'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/language_support/language_methods.rb:8:in `around'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:119:in `block (2 levels) in around'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:117:in `call'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime/support_code.rb:117:in `around'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:91:in `around'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:78:in `with_hooks'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/scenario.rb:53:in `block in accept'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/scenario.rb:108:in `with_visitor'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/scenario.rb:47:in `accept'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:51:in `block in visit_feature_element'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:163:in `broadcast'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:50:in `visit_feature_element'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/feature.rb:43:in `block in accept'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/feature.rb:42:in `each'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/feature.rb:42:in `accept'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:20:in `block in visit_feature'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:163:in `broadcast'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:19:in `visit_feature'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/features.rb:29:in `block in accept'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/features.rb:17:in `each'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/features.rb:17:in `each'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/features.rb:28:in `accept'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:14:in `block in visit_features'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:163:in `broadcast'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/ast/tree_walker.rb:13:in `visit_features'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/runtime.rb:46:in `run!'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/cli/main.rb:43:in `execute!'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/lib/cucumber/cli/main.rb:20:in `execute'
      /var/lib/gems/1.9.1/gems/cucumber-1.2.1/bin/cucumber:14:in `<top (required)>'
      /usr/local/bin/cucumber:19:in `load'
      /usr/local/bin/cucumber:19:in `<main>'
      features/my_feature.feature:7:in `And click "Subscribe" link'
... 
```

除了找不到内容外，该错误不会告诉您任何内容。原因是，`devise`不进行身份验证，因为**哈希`params`为空**。因此它无法获取任何用户数据。所以它无法验证一个。所以它不会让用户查看页面并将他重定向到显示错误消息的主页。所以没有找到测试应该使用的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T11:43:40.297

找到解决方案和问题的原因。

## 原因

### 短版

**Capybara**（即使使用**PhantomJS** ）不知何故无法识别元素是否可见。这是 Capybara 的内部结构，而不是我的测试。

### 详细原因说明

看，我们在一页上有两个表格——**注册表格**和**登录表格**。两者都是隐藏的，但是当用户点击*登录*或*注册*按钮时，会显示相应的表单。两种形式都包含字段**#user_email**和**#user_password**。但是*注册表单*包含**#user_password_confirmation**，而*登录*表包含**#user_remember_me**。

看看表格的代码：

```
<div class="forms">
    <div class="signup-form" style="display: block;">
        <form accept-charset="UTF-8" action="/users" class="new_user" id="new_user" method="post">
            <div style="margin:0;padding:0;display:inline">
                <input name="utf8" type="hidden" value="&#10003;" />
                <input name="authenticity_token" type="hidden" value="viNleUNDfdlp92j9vVU9QravqMRbmCUZDqw3pV9jQK0=" />
            </div>

            <div class="email">
                <input autofocus="autofocus" id="user_email" name="user[email]" placeholder="EMAIL or LDAP" size="30" type="email" value="" />
            </div>

            <div class="password">
                <input id="user_password" name="user[password]" placeholder="PASSWORD" size="30" type="password" />
            </div>

            <div class="password">
                <input id="user_password_confirmation" name="user[password_confirmation]" placeholder="PASSWORD CONFIRMATION" size="30" type="password" />
            </div>

            <div class="signup">
                Sign up
                <input name="commit" type="submit" value="Sign up" />
            </div>
        </form>
    </div>

    <div class="signin-form" style="display: none;">
        <form accept-charset="UTF-8" action="/users/sign_in" class="new_user" id="new_user" method="post">
            <div style="margin:0;padding:0;display:inline">
                <input name="utf8" type="hidden" value="&#10003;" />
                <input name="authenticity_token" type="hidden" value="viNleUNDfdlp92j9vVU9QravqMRbmCUZDqw3pV9jQK0=" />
            </div>

            <div class="email">
                <input autofocus="autofocus" id="user_email" name="user[email]" placeholder="EMAIL or LDAP" size="30" title="Email or LDAP username" type="text" value="" />
            </div>

            <div class="password">
                <input id="user_password" name="user[password]" placeholder="PASSWORD" size="30" type="password" />
            </div>

            <div class="rememberable">
                <label for="user_remember_me">Remember me</label>:

                <div class="checkbox">
                    <input name="user[remember_me]" type="hidden" value="0" />
                    <input id="user_remember_me" name="user[remember_me]" type="checkbox" value="1" />
                </div>
            </div>

            <div class="signin">
                Sign in
                <input name="commit" type="submit" value="Sign in" />
            </div>
        </form>
    </div>
</div> 
```

现在，在测试中，有一行应该使**登录表单**可见。然后 test 尝试填写**可见表单**并将其发送到服务器。

然而，水豚为什么不区分**有形**和**无形**。因此，它会在第一个表单中填写输入，该表单以前是**注册**表单。

然后有一个代码行，它点击**登录按钮**。看？填写的表格是**注册**，提交的表格是**登录**。

## 解决方案

### 短版

不要使用`fill_in 'Input', :with => 'value'`.

使用`find(:css, '#selector').set 'value'`或`find(:xpath, '/selector').set 'value'`代替。

### 详细说明

由于所描述的原因，`fill_in`搜索**与给定标签/id/标题匹配的第一个可见元素** *（`Input`在我的示例中为上面的几行）*。

如果您在一页上可能有几个输入具有相同的标签/id/标题，但在不同的表单中，则`fill_in`可能会模棱两可并填写错误的元素。

该`find`方法搜索**与给定选择器规则匹配的第一个元素** *（`css selector`或者`xpath`，基于您提供的第一个参数；`css selector`在我上面的示例中）*。

## 重要的提示

因此，**请始终尝试传递尽可能多的特定选择器**。

# c++ - 为什么编译器不为类中声明的变量分配内存？

> ID：13420637
> 
> 赞同：-2
> 
> 时间：2012-11-16T16:34:16.703
> 
> 标签：c++, c

`class`当我们在 C/C++ 内部或在 C/C++ 中声明某个变量时`struct`，我们必须为该变量创建一个对象`class`或`struct`为该变量分配内存。

为什么我们不能在没有任何对象的情况下访问这些变量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T16:39:56.113

嗯，答案是真的：因为这就是这个语言特性的全部意义所在。*类的数据成员的*想法是让它成为类对象的一个​​组成部分。它与整个类对象一起开始它的生命，它与整个类对象一起结束它的生命。

如果你有两个类对象，你就有两组完全独立的数据成员。如果您有 50 个类对象，那么您就有 50 个完全独立的数据成员集。如果您有零类对象，则您没有要访问的数据成员集。换句话说，没有类对象就不能访问这些“变量”，因为没有类对象它们就不存在。

当您在类定义中声明类的数据成员时，您并没有真正“声明变量”。类定义简单地描述了类类型的布局。就其本身而言，它不会产生任何物理内容，即指出它将存在于数据内存中，并指出您可以物理访问。

*同时，C++语言有类的静态*成员这样的概念。类的静态数据成员不与特定的类对象相关联。它们独立存在。事实上，静态数据成员只是普通的全局变量，被一层相当薄的 C++ 特定的“语法糖”（更精细的命名、访问控制等）覆盖。类的静态数据成员可以作为普通变量访问，无需任何目的。

换句话说，这不是一个“为什么”的问题。而是你需要什么的问题。如果您想要非静态数据成员功能，请使用非静态数据成员。如果你想要静态数据成员功能......好吧，你明白了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-16T16:37:17.487

类只是一个“布局”，用于指定实例对象将如何构造、销毁以及它们的行为方式。对于与建筑物的图像比较：类是用于建造房屋的计划。对象是房子本身。

如果您想要没有对象的变量，请使用全局变量。您可以将它们放在命名空间中：

```
namespace test
{
    int answer = 42; // Initialization is optional
}

// ...

void f()
{
    // Use it like this:
    test::answer = 0;
} 
```

您还可以使用静态成员：

```
class MyClass
{
    public:
        static int value;
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T16:41:02.140

**使用静态关键字：**

```
class A {
public:
    static int varaible;
};

int A::variable = 5; 
```

然后，您可以随时访问没有对象的变量。如下。

```
A::varaible = 25; 
```

**你需要知道的事情：**

1.  您将需要使用范围运算符（::) 来访问静态成员。
2.  静态成员的定义必须在类之外完成。上面的语句`int A::variable = 5;`是一个静态成员的定义。
3.  所有类型的对象`A`（包括继承的对象）共享一个静态成员。[1]

[1]

```
A a;
A b;
a::variable == b::variable == 25;
//if we change a::variable
a::variable = 26;
//b::variable has the same value.
b::variable == a::variable == 26; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-16T16:39:48.000

通常，您在类中声明一个成员变量正是因为您希望它成为该类类型对象的一部分。这就是该语言功能的用途：允许您拥有许多不同的对象，每个对象都有自己的状态，独立于任何其他对象。

在 C++（但不是 C）中，`static`如果您想要一个独立于任何对象的变量，则可以声明它。这将具有静态存储持续时间，就像在类外部声明的变量一样。在 C 中，如果你想要这样的东西，全局变量是唯一的选择。

例如：

```
struct thing {
    int a;         // part of a "thing" object
    static int b;  // not part of a "thing"
};

// Static variables need a definition, in exactly one source file
int thing::b;

int main() {
    thing::b = 1; // OK: no object needed
    thing::a = 2; // ERROR: object needed

    thing t1;
    t1.a = 3;     // OK: accessing object member
    t1.b = 4;     // OK: equivalent to "thing::b"

    thing t2;
    t2.a = 5;     // OK: accessing object member
    t2.b = 6;     // OK: equivalent to "thing::b"

    std::cout << t1.a;  // prints 3
    std::cout << t2.a;  // prints 5 - independent of t1.a

    std::cout << t1.b;  // prints 6
    std::cout << t2.b;  // prints 6 - same variable as t1.b (aka thing::b)
} 
```

# java - Eclipse、QueryDSL 和 Spring Roo 一起工作？

> ID：13420639
> 
> 赞同：3
> 
> 时间：2012-11-16T16:34:20.830
> 
> 标签：java, maven, jpa, spring-roo, querydsl

我正在尝试在 Eclipse 中使用 QueryDSL 设置基于 maven 的 SpringRoo 项目，并且在启用 Roo 时似乎无法使生成器工作。如果我创建一个普通项目，并使用必要的 querydsl 插件/依赖项填充我的 pom.xml，我的元模型类会自动生成。

但是，如果我切换到基本的 ROO 项目，并添加必要的 querydsl 插件/依赖项，则不会生成元模型类。

这些是我在 pom.xml 中添加的内容：

```
<!-- Querydsl -->
<dependency>
    <groupId>com.mysema.querydsl</groupId>
    <artifactId>querydsl-core</artifactId>
    <version>${querydsl.version}</version>
</dependency>
<dependency>
    <groupId>com.mysema.querydsl</groupId>
    <artifactId>querydsl-apt</artifactId>
    <version>${querydsl.version}</version>
</dependency>
<dependency>
    <groupId>com.mysema.querydsl</groupId>
    <artifactId>querydsl-jpa</artifactId>
    <version>${querydsl.version}</version>
</dependency> 
```

* * *

```
 <plugin>
        <!-- Requires mysema m2e plugin (http://ilx.github.com/m2e-querydsl/repository/0.0.5/) -->
        <groupId>com.mysema.maven</groupId>
        <artifactId>maven-apt-plugin</artifactId>
        <version>1.0.4</version>
        <executions>
            <execution>
                <goals>
                    <goal>process</goal>
                </goals>
                <configuration>
                    <logOnlyOnError>true</logOnlyOnError>
                    <outputDirectory>target/generated-sources/apt</outputDirectory>
                    <processor>com.mysema.query.apt.jpa.JPAAnnotationProcessor</processor>
                </configuration>
            </execution>
        </executions>
        <dependencies>
            <dependency>
                <groupId>com.mysema.querydsl</groupId>
                <artifactId>querydsl-apt</artifactId>
                <version>${querydsl.version}</version>
            </dependency>
            <dependency>
                <groupId>com.mysema.querydsl</groupId>
                <artifactId>querydsl-jpa</artifactId>
                <classifier>apt</classifier>
                <version>${querydsl.version}</version>
            </dependency>
        </dependencies>
    </plugin>
    <!-- right now this seems needed -->

    <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>build-helper-maven-plugin</artifactId>
        <version>1.7</version>
        <executions>
            <execution>
                <id>add-source</id>
                <phase>generate-sources</phase>
                <goals>
                    <goal>add-source</goal>
                </goals>
                <configuration>
                    <sources>
                        <source>target/generated-sources/apt</source>
                    </sources>
                </configuration>
            </execution>
        </executions>
    </plugin> 
```

我正在使用 Eclipse 3.7、m2e 1.2、Java 6。我还从[http://ilx.github.com/m2e-querydsl/repository/0.0.5/](http://ilx.github.com/m2e-querydsl/repository/0.0.5/)安装了 mysema m2e 插件。

有没有人有一个有效的 Roo 和 QueryDSL 配置？如果是这样，你能分享你的 pom.xml 吗？

谢谢，

埃里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T12:51:39.730

com.mysema.query.apt.jpa.JPAAnnotationProcessor 需要 javax.persistence.Entity 注释的 Java 文件。如果在运行时使用其他注解或添加实体注解，则不会生成任何类。

请参阅 Querydsl 参考文档的本章，了解基于类加载器的代码生成作为 APT 的替代方法[http://www.querydsl.com/static/querydsl/2.8.2/reference/html/ch03s02.html](http://www.querydsl.com/static/querydsl/2.8.2/reference/html/ch03s02.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:05:11.780

出于某种我不明白的原因，我需要在我的 pom.xml 中添加一个 spring-tx 依赖项。一旦到位，元模型类就会自动生成。但是有一个警告，我需要使用 @Entity 手动注释我的实体，而不是依赖 Roo 通过方面对其进行注释。最后，将我的插件更新到 1.0.7 消除了使用 maven-build-helper 的需要。

```
 <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-tx</artifactId>
        <version>${spring.version}</version>
    </dependency>

        <!-- QueryDSL plugin -->
        <plugin>
        <!-- Requires mysema m2e plugin (http://ilx.github.com/m2e-querydsl/repository/0.0.5/) -->
        <groupId>com.mysema.maven</groupId>
        <artifactId>apt-maven-plugin</artifactId>
        <version>1.0.7</version>
        <executions>
            <execution>
                <goals>
                    <goal>process</goal>
                </goals>
                <configuration>
                    <outputDirectory>target/generated-sources/apt</outputDirectory>
                    <processor>com.mysema.query.apt.jpa.JPAAnnotationProcessor</processor>
                </configuration>
            </execution>
        </executions>
        <dependencies>
            <dependency>
                <groupId>com.mysema.querydsl</groupId>
                <artifactId>querydsl-apt</artifactId>
                <version>${querydsl.version}</version>
            </dependency>
            <dependency>
                <groupId>com.mysema.querydsl</groupId>
                <artifactId>querydsl-jpa</artifactId>
                <classifier>apt</classifier>
                <version>${querydsl.version}</version>
            </dependency>
        </dependencies>
    </plugin> 
```

示例 Java Bean：

```
@RooJavaBean
@RooToString
@RooJpaEntity
@Entity
public class Client {
    @Temporal(TemporalType.TIMESTAMP)
    @DateTimeFormat(style = "M-")
    private Date created_on;
    private String name;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T11:22:45.830

有关于这个主题的旧讨论，Ken Rimple 指出“我在使用预构建的 ITD 的 QueryDSL 生成器上遇到任何问题。因为实际的类上没有 @Entity（直到 AspectJ 编译器出现）并添加它）当 QueryDSL 生成代码时，它不会将它们视为实体。”

[http://www.manning-sandbox.com/thread.jspa?threadID=51012&tstart=15](http://www.manning-sandbox.com/thread.jspa?threadID=51012&tstart=15)

对我来说，这似乎是一个可以尝试通过改变 maven 使用插件的顺序（生命周期阶段）来调整的东西。

# transactional - 使用事务性 NTFS 的替代方案

> ID：13420643
> 
> 赞同：7
> 
> 时间：2012-11-16T16:34:34.843
> 
> 标签：transactional, txf

鉴于 Microsoft 已[弃用 Transactional NTFS (TxF)](http://msdn.microsoft.com/en-us/library/windows/desktop/hh802690%28v=vs.85%29.aspx)：

> Microsoft 强烈建议开发人员使用替代方法来满足您的应用程序的需求。开发 TxF 的许多场景都可以通过更简单、更容易获得的技术来实现。此外，TxF 可能在 Microsoft Windows 的未来版本中不可用。
> 
> 虽然 TxF 是一组功能强大的 API，但自 Windows Vista 以来，开发人员对该 API 平台的兴趣极为有限，这主要是由于其复杂性和开发人员在应用程序开发中需要考虑的各种细微差别。因此，Microsoft 正在考虑在未来版本的 Windows 中弃用 TxF API，以便将开发和维护工作重点放在对大多数客户具有更大价值的其他功能和 API 上。

这意味着我需要一个替代方案：

*   [`CreateTransaction`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366011%28v=vs.85%29.aspx)
*   [`MoveFileTransacted`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365241%28v=vs.85%29.aspx)
*   [`CommitTransaction`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366001%28v=vs.85%29.aspx)

我的交易要求相当简单——移动两个文件：

```
tx = BeginTransaction();
{
   MoveFile(testResults, testResultsArchive); //throws if there's a problem
   MoveFile(cdcResponse, cdcResponseArchive); //throws if there's a problem

   CommitTransaction(tx);
}
finally
{
    CloseHandle(tx);
} 
```

我考虑过`MoveFile`转为`CopyFile`+ `DeleteFile`：

```
CopyFile(testResults, testResultsArchive); //throws if there's a problem
CopyFile(cdcResponse, cdcResponseArchive); //throws if there's a problem

DeleteFile(testResults);
DeleteFile(cdcResponse); 
```

但我希望有一个*好的*解决方案，而不是一个错误的解决方案。所以我再试一次：

```
CopyFile(testResults, testResultsArchive); //throws if there's a problem
CopyFile(cdcResponse, cdcResponseArchive); //throws if there's a problem

try
{
    DeleteFile(testResults);
}
catch (Exception e)
{
   DeleteFile(testResultsArchive);
   throw e;
}
try
{
    DeleteFile(cdcResponse);
}
catch (Exception e)
{
   DeleteFile(cdcResponseArchive);
} 
```

除了我希望有一个*好的*解决方案，而不是一个错误的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-08T01:07:54.680

从链接：

> 因此，Microsoft 正在考虑弃用 TxF API

它还没死！我不知道他们为什么要删除 Windows 的原子文件系统 API，即使它还没有得到很大的支持。应该有一个 .NET BCL 以便于使用 TxF 作为初学者。对网络副本的 TxF 样式支持也很棒。

如果有的话，微软应该改进 API！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-08T11:46:50.233

试试[.NET Transactional File Manager](http://transactionalfilemgr.codeplex.com/)。安全使用它相当简单。页面中的以下示例显示了该方式。甚至看起来作者反应灵敏，并且能够使用新的有用功能扩展库。

```
// Wrap a file copy and a database insert in the same transaction
TxFileManager fileMgr = new TxFileManager();
using (TransactionScope scope1 = new TransactionScope())
{
    // Copy a file
    fileMgr.Copy(srcFileName, destFileName);

    // Insert a database record
    dbMgr.ExecuteNonQuery(insertSql);

    scope1.Complete();
} 
```

如果您对自己的事务管理器感兴趣，请务必查看[这篇](http://www.codeproject.com/Articles/31270/A-Transactional-Repository-Implementation-in-NET)文章。如果你仔细检查上面提到的库，你会发现它是这样实现的。

# html - 定位 div 时遇到问题

> ID：13420647
> 
> 赞同：4
> 
> 时间：2012-11-16T16:34:49.553
> 
> 标签：html, css

![我想要的是](../Images/fb79cb2b2d86f1d4631a92f8b2a8c173.png)这基本上是我想要的。左侧记录 ID，右侧记录实际帖子。相反，我得到[了这个。](http://jsfiddle.net/dPX8J/)

```
body{
    background-color: #333333;
    color: #ffffff;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 16pt;
}
h2{
  display:inline;
}
h2 a{
  color:#ffffff;
}
hr{
  border: 1px solid #db8039;
}
.post {
  margin-left:auto;
  margin-right:auto;
  width: 66%;
    background-color: #1a1a1a;
    border-radius:10px;
    font-size: 15px;
    padding: 10px 10px 5px 10px;
}
.button{
  background: -webkit-gradient(linear, left top, left bottom, from(#333), to(#222));
  background: -moz-linear-gradient(top,  #333,  #222);
  color:#888;
  height:40px;
}
div.test{
  border: 1px solid white;
}

<div id="post'.$row['postId'].'" class="post">
      <div id="left" style="float:left">
        <h2>0</h2>
      </div>
      <div id="right">
        <div style="float:left;">
          <h2><a href=#>TITLE</a></h2>
        </div>
        <div style="float:right;">
          Posted By: USER on DATE
        </div>
        <br style="clear:both;"/>
        <hr />
        <p>BODY</p>
      </div>
</div> 
```

我确信这非常简单，我只是不知所措，我的 CSS 技能......我想低于标准。

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:43:28.133

如果你想检查一下，我做了一个全新的 1

[**演示**](http://jsfiddle.net/dPX8J/28/)

编辑：[**新演示**](http://jsfiddle.net/dPX8J/26/)

HTML

```
<div class="container">
    <div class="count">1</div>
    <div class="upper">Test 2</div>
    <hr>
    <div class="down">Body</div>
</div> 
```

CSS

```
.container {
    width: 500px;
    height: 100px;
    background: #000;
    position: relative;
}

.count {
    float: left;
    color: #fff;
    font-size: 30px;
    line-height: 100px;
    width: 50px;
    text-align: center;
}

.upper {
    color: #fff;
    font-size: 22px;
    line-height: 40px;
}

.down {
    color: #fff;
    font-size: 22px;
    line-height: 40px;
} 
```

虽然我不建议使用它，但使用表格也更容易实现

[**表演示**](http://jsfiddle.net/mKP3s/)

HTML

```
<table border="1">
    <tr>
        <td rowspan="2">&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
</table> 
```

CSS

```
table {
    width: 50%;
    margin: 30px;
}

table tr:nth-child(1) td:nth-child(1) {
    width: 100px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:47:03.740

尝试添加以下规则：

```
#left{
  width:5%;
  display:inline-block
}
#left h2{
 font-size:40px;
}
#right{
  width:94%;
  display:inline-block
} 
```

jsfiddle：http: [//jsfiddle.net/dPX8J/15/](http://jsfiddle.net/dPX8J/15/)

# sql - if 检查后在 Select 语句中查找重复项

> ID：13420648
> 
> 赞同：0
> 
> 时间：2012-11-16T16:34:50.103
> 
> 标签：sql, tsql, select, group-by

我正在做一个跟踪维修过的手机的项目。

在 select 语句中，我想查找重复的 IMEI 号码并检查重复项之间的 AdditionalDate 是否小于 30 天。换句话说，如果 AdditionalDate 超过 30 天，选择应该列出所有电话，甚至包括重复的 IMEI 号码。

我希望我描述得足够清楚。谢谢你。

补充说明：

我已经通过在确实找到重复项的子选择下包含 groupBy 来尝试它，但是我无法实现 if 条件。相反，我打算将所有重复项放入一个动态表中，然后对该表使用 select 语句。在这样做之前，我想在这里发布我的问题。

例如 DB_Phones 有以下行

ID - 添加日期 - IMEI

1 - 01.10.2012 - 123456789012345

2 - 15.10.2012 - 987654321012345

3 - 2012 年 10 月 20 日 - 123456789012345

根据上表，我只想列出第二行（ID#2），因为最后一个副本（ID#3）没有在 ID#1 的行后 30 天添加。如果行如下：

ID - 添加日期 - IMEI

1 - 01.10.2012 - 123456789012345

2 - 15.10.2012 - 987654321012345

3 - 2012 年 10 月 20 日 - 123456789012345

4 - 21.11.2012 - 123456789012345

然后应该返回第二行和第四行。如果满足 30 天的条件，我只需要返回一个副本（最后一个）。

我希望它现在更有意义。再次感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:51:12.233

猜猜你在追求什么：

```
SELECT
  r.*,
  (SELECT COUNT(*) FROM Repairs r2 WHERE r.IMEI = r2.IMEI
  AND r.ID != r2.ID) as NumberOfAllDuplicates,
  (SELECT COUNT(*) FROM Repairs r2 WHERE r.IMEI = r2.IMEI
  AND ABS(DATEDIFF(day, r.AddedDate, r2.AddedDate)) < 30
  AND r.ID != r2.ID) as NumberOfNearDuplicates
FROM
  Repairs r 
```

这取决于有一个 ID 字段，以及一个表中存在的所有内容。使用相关的子查询，在长数据上可能不是很快。

# java - HotSpot JVM 选项 HeapDumpOnOutOfMemoryError - 有什么问题吗？

> ID：13420649
> 
> 赞同：0
> 
> 时间：2012-11-16T16:34:51.550
> 
> 标签：java, out-of-memory, jvm-arguments

我最近了解了`-XX:+HeapDumpOnOutOfMemoryError`VM 参数，并被告知应该将它添加到 HotSpot JVM 中，因为默认情况下它是关闭的。我的一位同事评论说也许我们不应该这样做，因为他听说这样做有一些陷阱，但他不记得那是什么。我讨厌这样含糊不清的陈述，但在做出最终决定之前，我正在努力尽职调查，所以我正在做一些调查。

我能找到的大多数对它的引用更多地是关于如何使用它（以及转储文件所在的位置），并且没有谈到使用它的任何问题。这个 SO question 引用了一个不同的论点，但答案似乎也与这个论点相关，并暗示没有问题：[为什么这个 Hotspot JVM 选项不是默认选项？-XX:+PrintConcurrentLocks](https://stackoverflow.com/questions/7071643/why-is-this-hotspot-jvm-option-not-the-default-xxprintconcurrentlocks)

有谁知道不转的理由`-XX:+HeapDumpOnOutOfMemoryError`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:38:50.250

有了这个特殊的标志，我认为没有任何问题（不知道其他标志）。这甚至不是诊断标志。它只是在 JVM 遇到 OutofMemoryError 时打印 GC/Memory 状态（仅发生一次，并且在 JVM 停止时也会发生）。

您需要接受的一件事是，它可能（或）可能不会按预期运行，因为它是 -XX 和

> 使用 -XX 指定的选项不稳定，如有更改，恕不另行通知

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T17:02:50.690

主要的缺点是每次新程序遇到此错误时（该 JVM 第一次发生此错误）时，它都会创建一个大文件。如果你有一个 2 GB 的堆，它每次都可以创建一个那么大的文件，用你不需要的堆转储来填满磁盘空间。由于它仅用于调试/开发目的，因此对大多数最终用户无用。

# c++ - Visual Studio 调试器监视问题

> ID：13420650
> 
> 赞同：2
> 
> 时间：2012-11-16T16:34:52.983
> 
> 标签：c++, native, visual-studio-debugging

如何在 Visual Studio 调试器监视窗口（或其他地方？）中找出堆栈上变量的地址

读取变量工作正常：

```
streets     streets [11790](0x1c66a690 [...] std::vector<Street *,std::allocator<Street *> > 
```

但前缀 & 并没有给我一个地址：

```
&streets        streets [11790](0x1c66a690 [...] std::vector<Street *,std::allocator<Street *> > 
```

另外，尝试读取大小不起作用，这是为什么呢？

```
streets.size()  CXX0075: Error: Cannot set up Function Evaluation 
```

该程序在调试模式下编译。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T18:36:06.270

**Visual Studio 调试器通过一个名为autoexp.dat**的文件中的架构定义的转换来驱动调试器监视、快速监视、自动和局部变量视图（取决于您的 VS 版本，其中的内容可能会有很大差异）。该文件位于您的 VS-InstallDir/Common7/Packages/Debugger 文件夹中（至少它适用于 VS2010 和 VS2012）。

知道了这一点，您可以尝试/考虑一些想法：

**方法一：图书馆知识**

要访问向量中第一个元素*的*实际*地址*，我最终只是这样做：

 *```
streets._Myfirst 
```

如果您知道要查看的元素数量，可以通过以下方式使用数组扩展扩展：

```
streets._Myfirst,N 
```

其中`N`是元素的数量

注意：这仅适用于如上所示的向量。具体做法因您使用的容器而异。毫无疑问，有一些更简单的方法可能不太依赖于 std::vector<> 的实现，但这是我知道如何让你快速启动和调试的最简单的方法。

* * *

**方法二：焦土**

在工具/选项/调试/常规下是您可以打开和关闭的功能列表。您会发现其中一个对这个问题特别有用：

> 在可变窗口中显示对象的原始结构。

打开此**选项可查看****所有**结构和容器的原始成员变量，包括标准容器，如 std::vector<>。这有效地禁用了**autoexp.dat中模板的使用**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-16T18:48:43.773

要查看地址，请转换为`void *`，如下所示：`(void *)&streets`。

这是 Visual Studio 通过直接向您显示指向的向量来提供帮助的尝试。类似的问题会影响向量数组。*

# ms-access - ODBC 连接到 Ubuntu 上的 MS-Access

> ID：13420653
> 
> 赞同：8
> 
> 时间：2012-11-16T16:35:12.740
> 
> 标签：ms-access, ubuntu, odbc

我们的一名员工创建了一个 Microsoft Access 数据库并构建了一个 Joomla！围绕它的模块。它当前在 WAMP 服务器上运行，并通过 ODBC 连接到 accdb 文件。

如何在 Ubuntu 上为 Access 数据库创建 ODBC 连接？

在这一点上，我愿意让数据库在我的 Ubuntu 服务器上本地运行，或者在某个地方的 SMB 共享上。
已经提议将其从 Access 转移到 MySql。归根结底可能是这样，但我真的被迫寻找另一种选择。

有谁知道这是否可行以及如何实现？

如果这个问题已经被问过，我很抱歉；我确实已经在寻找它，但找不到任何特定于在 Linux 上通过 ODBC 连接 Access 的内容。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-17T07:33:20.623

我不完全确定我理解这里的用例，但这里有一些想法：

*   Access 数据库是基于文件的数据库，因此是无服务器的。
    这意味着数据库文件本身可以驻留在本地 Windows 机器、Windows 网络共享或 linux 机器上的 SMB 共享上。

*   但是，查询数据库的应用程序必须有权访问必要的驱动程序来操作数据库。
    在 Windows 上，这不是问题：所有 Windows 版本都预装了旧`.mdb`格式的 Jet 驱动程序。对于新`.accdb`格式，您必须安装 MSOffice 2007/2010/2013、Access 2007/2010/2013、Access Runtime 2007/2010/2013 或独立 ACE 驱动程序之一，才能使用新的数据库格式。

*   在 Linux 上，该`mdbtools`包提供了与`.mdb`文件格式的某种程度的兼容性，允许 Linux 应用程序直接查询和修改这样的数据库。另一个用于操作 (和) 数据库的
    开源库 (java)是[jackcess](http://jackcess.sourceforge.net)。`.mdb``.accdb`

*   Linux 的 ODBC 驱动程序存在，但据我所知，它们是商业的并且可能相当昂贵，请参阅[easysoft Access ODBC 驱动程序](http://www.easysoft.com/products/data_access/odbc-access-driver/index.html)。

*   另请参阅此 SO 问题：[Connecting to access database from linux](https://stackoverflow.com/questions/5742322/connecting-to-access-database-from-linux)

基本上，如果您正在寻找一个简单的开源解决方案，那么在 Linux 上使用 MySQL 或使用本地 SQLite 数据库将更可行。

# asp.net - 在单声道 xsp 上托管 asp.net - raspberry pi

> ID：13420654
> 
> 赞同：4
> 
> 时间：2012-11-16T16:35:17.180
> 
> 标签：asp.net, mono, arm, raspberry-pi, xsp

我正在尝试在我的 Raspberry Pi（运行 arch linux）上运行 xsp 包附带的示例应用程序，但不幸的是，显然在将任何 http 响应发送到浏览器之前连接已关闭。我在 chrome 上收到“未收到数据”消息。

然而，xsp 只输出“Application_Start”，没有其他任何事情发生（除了 chrome 说没有收到数据）

这就是我所做的：

```
$ xsp2
xsp2
Listening on address: 0.0.0.0
Root directory: /srv/http/test
Listening on port: 8080 (non-secure)
Hit Return to stop the server.
Application_Start 
```

和 Chrome 的输出：

```
No data received
Unable to load the webpage because the server sent no data.
Here are some suggestions:
Reload this webpage later.
Error 324 (net::ERR_EMPTY_RESPONSE): The server closed the connection without sending any data. 
```

当然，在我的 Linux PC 机上它运行良好。

如果除了我试图从我 35 美元的董事会中拿走太多东西之外，有人有任何见解，请告诉我？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-07T15:01:58.973

有关访问此页面的人员的信息：

*   Raspberry pi 没有关于硬浮点操作的官方单声道实现。这就是为什么很多单声道的东西不起作用的原因，包括 xsp =]

*   一位绅士在树莓派论坛上发布了一个实验版本的单声道，它实现了硬浮点，我的工作正常。[帖子在这里](http://www.raspberrypi.org/phpBB3/viewtopic.php?f=34&t=37174)。

*   对于 Arch Linux 用户，我提出了一个包构建，以便您可以创建一个 Arch Linux 包，并发布在同一个线程上。[正是在这里](http://www.raspberrypi.org/phpBB3/viewtopic.php?p=331863#p331863)。关于如何构建它的说明也在那里。

*   在此之后运行 xsp 将起作用，至少对我来说是这样。我也确实使用 .NET 来处理 GPIO，而且一切都很好。

希望这会有所帮助！=]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T22:37:41.193

通过一些反射和一个套接字服务器，创建自己的 asp.net 主机并不难（好吧，我让它支持 <% %> 语法，后面有代码和用户控件（不要使用/想要内置控件）因为它们不那么便携，也不像我想要的那样透明））。在我的拱莓上效果很好。

或者您可以尝试从 MS [http://www.asp.net/web-api/overview/hosting-aspnet-web-api/self-host-a-web-api](http://www.asp.net/web-api/overview/hosting-aspnet-web-api/self-host-a-web-api)进行自我托管，不确定它是否适用于单声道虽然（但如果确实如此，请告诉我们；））。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:55:11.450

如果您使用的是 Raspbian 发行版，则 Mono 包在编译时会出现问题，并且由于 Raspbian 所利用的特定处理器功能，因此存在运行 .Net 应用程序的问题。您必须使用不使用 Hard Float armhf 的旧版 Debian。

[http://www.raspberrypi.org/phpBB3/viewtopic.php?f=66&t=11634&start=75](http://www.raspberrypi.org/phpBB3/viewtopic.php?f=66&t=11634&start=75)

# c# - 从 HTML 代码 C# 中提取特定 ID

> ID：13420655
> 
> 赞同：1
> 
> 时间：2012-11-16T16:35:19.770
> 
> 标签：c#, html-parsing

我正在制作一个程序，您可以登录 facebook，去某人的墙上并在上面发帖。我有所有这些工作，如果我手动输入我去的 ID 并在 HTML 中找到你写状态的文本视图框和你点击发布的发布按钮。我的问题是，此文本框的 ID 和发布按钮在您每次访问页面或页面刷新时都会更改。所以你不能只在 ID 中编码来获得它，`HtmlElement element = browser.Document.GetElementById("some-ID");`我需要以某种方式解析 HTML 代码，并在每次页面刷新时提取 textview 和按钮的特定 ID。我研究了 html 敏捷包，但它并没有真正帮助我。任何人都可以帮忙吗？

**编辑** 这是我试图从您发布的文本区域中获取 ID 的代码行。你可以看到它只是一个随机的字母乱码，最后是一些数字。每次加载页面时它都会更改。而且我还没有看过 facebook api 会有帮助吗？

```
<DIV class="innerWrap"><TEXTAREA aria-expanded="false" onkeydown='Bootloader.loadComponents(["control-textarea"], function() { TextAreaControl.getInstance(this) }.bind(this)); ' id="ujkzdk454" class="DOMControl_placeholder uiTextareaAutogrow input mentionsTextarea textInput" title="Write something..." role="textbox" aria-owns="typeahead_list_ujkzdk453" name="xhpc_message" autocomplete="off" aria-autocomplete="list" placeholder="Write something..." aria-label="Write something...">Write something...</TEXTAREA></DIV></DIV></DIV><INPUT 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:24:32.757

我同意你可能应该使用 Facebook API，但无论如何，用 jquery 来做这样的事情怎么样？

```
var textarea = $('textarea', '.innerWrap');
var button = $('.innerWrap').next('input'); 
```

如果你还想要 id

```
var textareaId = textarea.attr('id')
var buttonId = button.attr('id') 
```

# php - 更新密码时出现 SQL 语法错误

> ID：13420660
> 
> 赞同：-1
> 
> 时间：2012-11-16T16:35:40.440
> 
> 标签：php, mysql

> **可能重复：**
> [PHP/MySQL - SQL 语法错误？](https://stackoverflow.com/questions/1875747/php-mysql-sql-syntax-error)

我正在尝试使用以下脚本更新用户密码，但是我只是收到以下错误。我已经使用 PHP 和 MySQL 大约 2 个月了，所以我还是一个初学者，所以我非常感谢任何关于我下面的代码的评论。预先感谢您的帮助。

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '(password, salt) VALUES ('fcf829e6c3478752799b7d49798a14640f110dd4f8767' 附近使用正确的语法

```
<?php

//Pull in form info

$pass1 = $_POST['pass1'];
$pass2 = $_POST['pass2'];

//Chrck if the 2 password fields match
if($pass1 != $pass2) {
    header('Location: ../admin/pass-change.php?pw=notmatched');
    die();
}

//encrypts the password

$hash = hash('sha256', $pass1);

//creates a 3 character sequence

function createSalt()
{
    $string = md5(uniqid(rand(), true));
    return substr($string, 0, 3);
}
$salt = createSalt();
$hash = hash('sha256', $salt . $hash);

//initialise connection with databse

require_once('../Connections/EliteGrooming.php');

mysql_select_db($database_EliteGrooming, $EliteGrooming);

//Execute the query

$username = $_SESSION['username'];

$query = "UPDATE admin_users (password, salt)
        VALUES ( '$hash', '$salt' )
        WHERE username = '$username';";
mysql_query($query) or die(mysql_error());;
mysql_close();
header('Location: ../admin/pass-change.php?PassChanged');

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:36:53.340

不，应该是

```
UPDATE admin_users 
   SET password = '$hash', 
        salt = '$salt' 
WHERE username = '$username' 
```

请注意，您的查询易受攻击`SQL Injection`，请参阅下面的文章

*   [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-16T16:50:24.933

在我看来，输入密码以某种方式在输入之前和之后添加。翻译你正在放入数据库：

```
 $query = "UPDATE admin_users (password, salt)
    VALUES ( ''f124782349023589270365fhjdhf2893'', '$salt' )
    WHERE username = '$username';"; 
```

我之所以这么说是因为它只返回一个值输入。那个或你的盐没有被发现。

编辑：上面是对的。您缺少 SET 命令。

# c# - C# OnCommand 调用警报框

> ID：13420661
> 
> 赞同：1
> 
> 时间：2012-11-16T16:35:40.133
> 
> 标签：c#, javascript, asp.net

我有一个页面，其中列出了数据网格中的一堆项目。

每个项目都有一个 cooresponding `remove link button`，它从列表中删除该项目。在我的事件处理程序中——项目被删除的地方——我检查项目是否是列表中的最后一项。如果是最后一项，我不会删除，而是发送一个警告框，告诉用户该项目不能被删除。我不确定如何让 C# 触发此警报框。

我的代码如下所示：

在我的 aspx 中，我有一个带有各种链接按钮的数据网格。代码片段如图所示：

```
<ItemTemplate>
    <asp:LinkButton runat="server" ID="Remove"
                OnCommand="lnkRemove_Command" CommandArgument='<%# Eval("Id") %>
                OnClientClick="return false;">
    </asp:LinkButton>
</ItemTemplate> 
```

在我后面的代码中，我的事件处理程序如下所示：

```
 private List<MyItem> _items;

   protected void lnkRemove_Command(object sender, CommandEventArgs e)
   {
      int ID = Convert.ToInt32(e.CommandArgument);
      MyItem item = MyItem.GetItemByID(id); //This gets the item cooresponding to the ID
      if (_items.Count != 1) 
      {
          //code to delete item   
      }
      else
      {
           //Generate an alert box to tell the user that this item cannot be deleted.
           //I have tried the following two lines of commented code, which didn't work for me
           //Response.Write(@"<script language='javascript'>alert('HERE');</script>");
           //Page.ClientScript.RegisterStartupScript(this.GetType(), "hwa", "alert('Hello World');", true);

      }
   } 
```

此外，可能需要注意的是，在我的 中`Page_Load`，我已经做了一个`Context.RegisterResource(this, StyleSheet, Script)`. 换句话说，我有工作的 JavaScript 和 CSS，它们与 MyFile.js 中此页面的其他功能的代码相一致

如果可能的话，我想在 MyFile.js 中创建一个 JS 函数，其中我已经有由各种 OnClientClicks 等触发的 js 函数......

是否有可能做这样的事情：

```
in MyFile.js

var GetAlertMessage = function()
{
    alert("Can't delete this item");
} 
```

并在我上面列出的 C# 函数中调用此函数？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T17:27:32.680

您应该像对待任何其他验证例程一样对待它。应该有一个客户端验证功能和一个服务器端验证功能。

**客户端验证**

在每个可删除的项目上，添加一个`onclick="ValidateDeletion();"`和`class="deleteable-item"`

```
function ValidateDeletion()
{
    var itemCount = $(".deleteable-item").length;
    if(itemCount == 1)
    {
        alert("Sorry, you cant delete this item.")
        return false;
    }
    else
    {
        //let it pass through
    }

} 
```

# javascript - jQuery XML选择上的转义点

> ID：13420665
> 
> 赞同：1
> 
> 时间：2012-11-16T16:35:47.880
> 
> 标签：javascript, jquery, xml

我有一个 XML：

```
<computers>
  <computer>
    <description>Description</description>
    <computer.always></computer.always>
  </computer>
</computers> 
```

所以我想访问 computer.always 元素，所以我使用这个：

```
$(xml).find('computer ' + "computer.always".replace(/\./g,'\\\\.')) 
```

并且找不到该元素。（我写了 "computer.always".replace(/./g,'\\.') 因为 "computer.always" 可以是一个变量，我需要使这个选择器动态化。）

奇怪的是：

**当我做 ：**

```
$(xml).find('computer computer\\.always') // Element found 
```

**我的元素是找到。**

但是当我使用“computer.always”.replace(/./g,'\\.') 的结果时，它失败了。

```
"computer.always".replace(/\./g,'\\\\.') // return "computer computer\\.always" in the console
 $(xml).find("computer.always".replace(/\./g,'\\\\.')) => [] 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:08:47.557

"computer.always".replace(/./g,'\\.') 不起作用，因为您只需要 "computer\.always"。

因此，如果您这样做，它应该可以工作。

`$(xml).find( "computer " + "computer.always".replace(/./g,'\\.') )`

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T10:13:02.290

事实上，我的错误是使用双 \，所以控制台使用它来回显而不是我的代码。我的解决方案是使用：

```
$(xml).find("computer.always".replace(/\./g,'\\.')) 
```

# iphone - 更新推送通知徽章计数

> ID：13420668
> 
> 赞同：0
> 
> 时间：2012-11-16T16:35:56.783
> 
> 标签：iphone, ios, xcode, ipad, apple-push-notifications

我声明要在我的应用程序中实现推送通知，并且对徽章计数有疑问。我希望我的应用程序的行为类似于电子邮件和其他应用程序，这样每次收到警报时，徽章计数都会增加。

由于徽章计数编号是有效负载的一部分，因此增加它的最佳方法是什么？

当我发送带有消息和徽章编号的第一个通知时，我如何处理后续通知？我需要存储我发送的所有通知吗？

对此的任何澄清将是最有帮助的。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T16:38:54.633

如果你想增加数字，你必须在服务器上跟踪它，没有别的办法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T16:47:45.073

这实际上取决于通知的用途。如果它用于新闻应用程序并且您正在推送突发新闻，那么正确增加徽章将非常困难。就好像它是一个游戏应用程序，而您正在推动告诉玩家轮到他们了，这会容易得多。

示例（伪）：

新闻应用

1.  文章发表

    1.1 推送发送

    1.2 添加到推送数据库，包括发送给谁，检查数据库是否有其他推送给同一用户，看不到以前的推送，BADGE = 1。

2.  应用程序已打开

    2.1 Badge 返回 0，告诉数据库删除该设备/用户/BADGE = 0 的所有推送

3.  文章发表

    3.1 推送发送

    3.2 添加到推送数据库，包括发送给谁，检查数据库是否有其他推送给同一用户，看不到以前的推送，BADGE = 1。

4.  文章发表

    4.1。添加到推送数据库，包括发送给谁，检查数据库是否有其他推送到同一用户，查看之前的推送，BADGE = 2。

5.  应用程序已打开

    5.1 徽章回到 0，告诉数据库删除该设备/用户的推送。徽章 = 0

游戏应用

1.  玩家 2 去
2.  推送到玩家 1，检查数据库以查看在任何其他游戏中是否轮到玩家 1，BADGE = 轮到其 P1 的游戏计数。

# c# - XmlAttribute/XmlText 不能用于编码复杂类型

> ID：13420670
> 
> 赞同：1
> 
> 时间：2012-11-16T16:35:58.380
> 
> 标签：c#, .net, xml, serialization, xml-serialization

我想将一个类序列`Ticket`化为 xml。由于我的自定义字段类，我收到错误消息：“XmlAttribute/XmlText 不能用于编码复杂类型”。

这就是自定义字段的 xml 应该是什么样子（属性数组是 nesseray，但我不明白如何创建它）：

```
<custom_fields type="array">
<custom_field name="Standby Reason" id="6">
<value/>
</custom_field>
<custom_field name="Close Date" id="84"> 
```

**班票**

```
public class Ticket
{
    [XmlElement("custom_fields")]
    public CustomFields Custom_fields { get; set; } 
```

**类自定义字段**

```
[Serializable]
public class CustomFields
{
    [XmlAttribute("array")]
    public List<CustomField> custom_field { get; set; } 
```

**类 CustomField**

```
[Serializable]
public class CustomField
{
    [XmlIgnore]
    public string Name { get; set; }

    [XmlElement]
    public int Id { get; set; }

    [XmlElement]
    public string Value { get; set; } 
```

**序列化方法**

```
public string Serialize(object obj)
{
    var nsSerializer = new XmlSerializerNamespaces();
    nsSerializer.Add(String.Empty, String.Empty);

    var serializer = new XmlSerializer(typeof(Ticket), String.Empty);

    using (StringWriter writer = new StringWriter())
    {
        ExtendedXmlTextWriter xmlTextWriter = new ExtendedXmlTextWriter(writer);
        serializer.Serialize(xmlTextWriter, obj, nsSerializer);

        //return writer.ToString();

        XElement root = new XElement("custom_fields", new XAttribute("type", "array"),
            new XElement("custom_field",
                new XAttribute("name", "Standby Reason"),
                new XAttribute("id", 6)
                ), new XElement("value"),
                    new XElement("custom_field",
                        new XAttribute("name", "Close Date"),
                        new XAttribute("id", 84)
                        )
                        );

        return (writer.ToString() + root.ToString());
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T17:07:18.527

有时 Linq To Xml 会很有帮助

```
XElement root = new XElement("ticket",
                        new XElement("custom_fields",
                            new XAttribute("type", "array"),
                            new XElement("custom_field",
                                new XAttribute("name", "Standby Reason"),
                                new XAttribute("id", 6)
                            ),
                            new XElement("value"),
                            new XElement("custom_field",
                                new XAttribute("name", "Close Date"),
                                new XAttribute("id", 84)
                            )
                        )
                );

string xml = root.ToString(); 
```

输出：

```
<ticket>
  <custom_fields type="array">
    <custom_field name="Standby Reason" id="6" />
    <value />
    <custom_field name="Close Date" id="84" />
  </custom_fields>
</ticket> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:57:18.713

班票

```
public class Ticket
{
    [XmlElement("custom_fields")]
    public CustomFields Custom_fields { get; set; } 
```

类自定义字段

```
[Serializable]
public class CustomFields
{
    [XmlArray("array"), XmlArrayItem("custom_field")]
    public List<CustomField> custom_field { get; set; } 
```

类 CustomField

```
[Serializable]
public class CustomField
{
    [XmlAttribute("name")]
    public string Name { get; set; }

    [XmlAttribute("id")]
    public int Id { get; set; }

    [XmlElement("value")]
    public string Value { get; set; } 
```

XML:

```
<ticket>
   <custom_fields>
     <array>
        <custom_field name="Standby Reason" id="6"><value /></custom_field>
        <custom_field name="Close Date" id="84"><value /></custom_field>
     </array>
   </custom_fields>
</ticket> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:39:04.233

List<CustomField> 不能是 XML 属性。

# sql-server - 动态创建的临时表不持久

> ID：13420671
> 
> 赞同：0
> 
> 时间：2012-11-16T16:36:01.933
> 
> 标签：sql-server, sql-server-2008-r2

我想在动态查询中创建一个临时表，然后使用它。它将从永久表创建：

```
create table t (a integer);
insert into t values (1); 
```

临时表的创建是这样的：

```
declare @command varchar(max) = '
    select *
    into #t
    from t
    ;
    select * from #t;
';
execute (@command); 
```

当@command 被执行时`select from`，临时表就起作用了。

现在，如果我从临时表中选择，则会显示一条错误消息：

```
select * from #t;

Invalid object name '#t' 
```

如果临时表是在动态查询之外创建的，它可以工作：

```
select top 0 *
into #t
from t

declare @command varchar(max) = '
    insert into #t
    select *
    from t
';
execute (@command);

select * from #t; 
```

是否可以持久化动态创建的临时表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:59:45.060

`EXECUTE`您很接近在不同会话中进行的假设。

根据[这里的 MSDN](http://msdn.microsoft.com/en-us/library/ms188332%28v=sql.105%29.aspx)

> 在 Transact-SQL 批处理中执行命令字符串或字符串

所以你的临时表只存在于`EXECUTE`命令执行的 SQL 范围内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:45:28.493

您还可以创建全局临时表。例如，##MyTemp。但是，全局临时表对所有 SQL Server 连接都是可见的。

# jenkins - 远程访问受保护的 Jenkins 服务器

> ID：13420673
> 
> 赞同：2
> 
> 时间：2012-11-16T16:36:02.530
> 
> 标签：jenkins, hudson

我在运行 Windows Server 2008 的机器上安装了 Jenkins。使用 Jenkins 自己的用户数据库和基于矩阵的安全授权来保护 Jenkins 安装。匿名用户没有任何访问权限，除了注册一个帐户。我已经设置了一个帐户并授予该帐户完全访问权限。

现在我想从托管存储库的另一台机器远程触发构建。我相信这应该可以通过访问以下 URL 来实现：

```
https://[username]:[user_api_token]@[address.of.jenkins]:8080/job/[project]/build?token=[project_api_token] 
```

但是，这似乎对我不起作用。当我在浏览器中访问该站点时，Jenkins 会转发到登录页面，并且不会开始构建。

我究竟做错了什么？这似乎是一个身份验证问题，因为我在打开上面的 URL 后没有登录。此外，如果我授予匿名用户完全访问权限，则 URL 有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T21:55:34.587

尝试从 curl 等命令行程序调用构建：

```
curl http://[userid]:[user_token]@localhost:8080/job/[project]/build?token=[proj_token] 
```

或者

```
curl --user [userid]:[user_token] http://localhost:8080/job/[project]/build?token=[proj_token] 
```

我认为您的问题可能与浏览器相关，在 URL 中嵌入凭据（在我的情况下，Firefox 会弹出一个警告，告诉我我即将登录 Jenkins）

# sql - SQL Server 2008 试图通过视图和架构使其更安全

> ID：13420675
> 
> 赞同：2
> 
> 时间：2012-11-16T16:36:08.180
> 
> 标签：sql, sql-server-2008, security

您好，感谢您抽出宝贵时间阅读本文，

我在我们的沙箱中闲逛，我正在努力寻找使我们的数据库更安全的最佳方法。

我们遇到的问题是我们有 3 个数据库，我们需要每个数据库的信息（使用联合和视图）。我们还有外部航运公司和商家需要访问我们数据库中的某些信息。

我的想法是创建一个具有不同商家模式（称为`MVIEW`）的单独数据库。然后根据商家的需要在这些模式中创建视图。然后视图将访问来自其他服务器的数据（问题是这将要求商家拥有`SELECT`其他服务器的权限等）

所以在这一点上，我认为在每个数据库中创建商家模式并在其中创建可以访问数据库中必要信息的视图，然后让`HVIEW`数据库访问这些视图是明智的。这样我就可以让商家只选择这些模式。

问题仍然存在，错误表明权限被拒绝并且用户无权访问视图试图查看的模式。

你有什么建议吗？

感谢你的宝贵时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T21:46:46.897

仅授予他们对某些视图的访问权，而不是对数据表的访问权。并在视图中，引用用户登录 ID。因此，在幕后，隐藏在视图中，您将使用 WHERE 子句限制他们的访问

示例：选择 . . . . 其中供应商用户=SYSTEM_USER

示例：选择 . . . . 其中 externalAccess=1 和 SYSTEM_USER in（从 tbl_externalUsers 中选择名称）

# javascript - Javascript - 自动完成的数组推送

> ID：13420676
> 
> 赞同：0
> 
> 时间：2012-11-16T16:36:10.703
> 
> 标签：javascript, arrays, json, autocomplete, array-push

我正在开发一个从数组中读取的自动完成搜索栏。我需要解析一个 JSON 文件并将名称推送到一个数组中。除了推送到实际数组的正确命令外，我一切正常。我会用什么来推送到下面的数组？

```
 $("#schoolLocal").autocompleteArray(
    [],
    {
        delay:10,
        minChars:1,
        matchSubset:1,
        onItemSelect:selectItem,
        onFindValue:findValue,
        autoFill:true,
        maxItemsToShow:10
    }
); 
```

我用 $("#schoolLocal").autocompleteArray.push(name);

当然，这没有用。

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:45:28.803

什么是自动完成数组？数组还是函数？

假设它是一个数组，那么：

```
// declare the array  with 2 sub arrays,1 for names and other for definitions (?)
$("#schoolLocal").autocompleteArray = new Array(new Array(),{
        delay:10,
        minChars:1,
        matchSubset:1,
        onItemSelect:selectItem,
        onFindValue:findValue,
        autoFill:true,
        maxItemsToShow:10
    }
);

//push to the names array
$("#schoolLocal").autocompleteArray[0].push(name); 
```

# json - 在 Yesod 中保留具有用户引用的实体？

> ID：13420680
> 
> 赞同：1
> 
> 时间：2012-11-16T16:36:18.427
> 
> 标签：json, haskell, yesod

我正在更改我现有的 Yesod 应用程序以在 SQL 后端而不是 mongo 上运行。生成的表结构比 mongo 后端更严格。插入时应正确创建外键引用。

```
postFeedingsR :: Handler RepJson
postFeedingsR  = do
  muser <- maybeAuth
  parsedFeeding <- parseJsonBody_ --get content as JSON
  let userId = getUserId muser
  let feedingWithUser = Feeding (feedingDate parsedFeeding) (feedingSide parsedFeeding) (feedingTime parsedFeeding) (feedingExcrements parsedFeeding) (feedingRemarks parsedFeeding) userId --should be linked to user..
  fid <- runDB $ insert feedingWithUser --store in database
  --runDB $ update fid [ FeedingUserId =. userId ] --Old mongo style of linking the feeding to the user
  sendResponseCreated $ FeedingR fid --return the id 
```

我尝试使用来自 MaybeAuth 的用户 UID 更新从 parseJsonBody 获得的实体。但是，这给了我以下错误：

```
No instance for (aeson-0.6.0.2:Data.Aeson.Types.Class.FromJSON
                   (FeedingGeneric backend0))
  arising from a use of `parseJsonBody_'
Possible fix:
  add an instance declaration for
  (aeson-0.6.0.2:Data.Aeson.Types.Class.FromJSON
     (FeedingGeneric backend0))
In a stmt of a 'do' block: parsedFeeding <- parseJsonBody_
In the expression:
  do { muser <- maybeAuth;
       parsedFeeding <- parseJsonBody_;
       let userId = getUserId muser;
       let feedingWithUser
             = Feeding
                 (feedingDate parsedFeeding)
                 (feedingSide parsedFeeding)
                 (feedingTime parsedFeeding)
                 (feedingExcrements parsedFeeding)
                 (feedingRemarks parsedFeeding)
                 userId;
       .... }
In an equation for `postFeedingsR':
    postFeedingsR
      = do { muser <- maybeAuth;
             parsedFeeding <- parseJsonBody_;
             let userId = ...;
             .... } 
```

我不确定为什么会这样。谁能让我找到正确的方向来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T08:55:49.203

Solved by changing the auth line to:

```
Entity uid u <- requireAuth 
```

and by adding the function:

```
addUserToFeeding :: UserId -> Feeding -> Feeding                                                                                                                                                            
addUserToFeeding uid Feeding {feedingDate=date, feedingSide=side, feedingTime=time, feedingExcrements=ex, feedingRemarks=remarks} = Feeding date side time ex remarks uid 
```

to create a new Feeding with associated user. This Feeding can then be stored in the normal way in Yesod:

```
let feedingWithUser = addUserToFeeding uid parsedFeeding                                                                                                                                              
fid <- runDB $ insert feedingWithUser --store in database 
```

# git - git push 错误 [远程拒绝]（内部错误）

> ID：13420682
> 
> 赞同：0
> 
> 时间：2012-11-16T16:36:33.997
> 
> 标签：git

最近我面临一个关于 git push 的特殊问题。

推送分支或标签时，出现以下错误：

```
[remote rejected] some refs cannot be pushed ..... (internal error) 
```

然后我尝试运行“git gc”命令。然后推送命令成功。

我试图通过谷歌搜索找到根本原因，但没有找到。

有没有人有任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:14:43.503

你有一些过时的远程分支引用，我怀疑你正在跟踪。我以前见过这个，通过清理你的回购，它删除了悬空的引用。

# java - java NullPointerException 尝试绘制时

> ID：13420685
> 
> 赞同：1
> 
> 时间：2012-11-16T16:36:43.467
> 
> 标签：java, swing

我正在尝试根据随机数字数组绘制图片。到目前为止，我已经取得了部分成功，因为背景颜色（白色）确实出现了。

但是，图片没有绘制。相反，我看到的只是白色背景和这个错误：

```
PixelAvatarGen
XphnX
Black and white or 8-bit color?
0 = B&W, 1 = 8bit
1
Print name to make into avatar.
2
5:2:7:0:3:6:7:0:6:7:7:3:1:4:0:6:5:1:7:4:0:0:5:6:6:3:0:2:3:7:2:4:7:5:4:2:3:6:0:1:4:1:6:4:1:1:1:5:7:5:1:5:4:0:4:5:1:5:6:0:5:4:6:0:0:6:0:0:0:6:7:5:2:6:4:0:1:1:1:7:0:2:1:4:0:2:3:3:3:3:2:6:6:2:6:4:2:7:5:4:7:3:3:3:1:5:1:6:1:3:4:6:0:1:1:2:5:7:4:1:0:2:4:4:4:6:3:7:7:1:0:6:3:6:3:7:6:5:2:5:5:3:5:3:5:4:4:7:0:5:7:4:2:4:5:7:1:0:3:2:7:7:2:3:5:5:2:7:5:6:6:7:4:3:0:7:4:7:1:0:0:7:4:4:3:7:6:0:4:2:7:6:7:3:2:4:2:7:3:0:5:6:6:7:7:2:2:0:2:5:7:6:5:1:0:6:1:5:2:0:7:0:7:0:4:1:0:3:4:3:7:7:4:4:2:7:0:7:4:7:1:6:1:4:4:2:4:7:3:0:4:4:6:6:3:5:
Drawing11
Exception in thread "AWT-EventQueue-0" Drawing11
java.lang.NullPointerException
at xphnx.pixelgen.Screen.paintComponent(Screen.java:25)
at javax.swing.JComponent.paint(Unknown Source)
at javax.swing.JComponent.paintChildren(Unknown Source)
at javax.swing.JComponent.paint(Unknown Source)
at javax.swing.JComponent.paintChildren(Unknown Source)
at javax.swing.JComponent.paint(Unknown Source)
at javax.swing.JLayeredPane.paint(Unknown Source)
at javax.swing.JComponent.paintChildren(Unknown Source)
at javax.swing.JComponent.paintToOffscreen(Unknown Source)
at javax.swing.RepaintManager$PaintManager.paintDoubleBuffered(Unknown Source)
at javax.swing.RepaintManager$PaintManager.paint(Unknown Source)
at javax.swing.RepaintManager.paint(Unknown Source)
at javax.swing.JComponent.paint(Unknown Source)
at java.awt.GraphicsCallback$PaintCallback.run(Unknown Source)
at sun.awt.SunGraphicsCallback.runOneComponent(Unknown Source)
at sun.awt.SunGraphicsCallback.runComponents(Unknown Source)
at java.awt.Container.paint(Unknown Source)
at java.awt.Window.paint(Unknown Source)
at javax.swing.RepaintManager.paintDirtyRegions(Unknown Source)
at javax.swing.RepaintManager.paintDirtyRegions(Unknown Source)
at javax.swing.RepaintManager.prePaintDirtyRegions(Unknown Source)
at javax.swing.RepaintManager.access$700(Unknown Source)
at javax.swing.RepaintManager$ProcessingRunnable.run(Unknown Source)
at java.awt.event.InvocationEvent.dispatch(Unknown Source)
at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
at java.awt.EventQueue.access$200(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue.dispatchEvent(Unknown Source)
at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.run(Unknown Source)
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
at xphnx.pixelgen.Screen.paintComponent(Screen.java:25)
at javax.swing.JComponent.paint(Unknown Source)
at javax.swing.JComponent.paintToOffscreen(Unknown Source)
at javax.swing.RepaintManager$PaintManager.paintDoubleBuffered(Unknown Source)
at javax.swing.RepaintManager$PaintManager.paint(Unknown Source)
at javax.swing.RepaintManager.paint(Unknown Source)
at javax.swing.JComponent._paintImmediately(Unknown Source)
at javax.swing.JComponent.paintImmediately(Unknown Source)
at javax.swing.RepaintManager.paintDirtyRegions(Unknown Source)
at javax.swing.RepaintManager.paintDirtyRegions(Unknown Source)
at javax.swing.RepaintManager.prePaintDirtyRegions(Unknown Source)
at javax.swing.RepaintManager.access$700(Unknown Source)
at javax.swing.RepaintManager$ProcessingRunnable.run(Unknown Source)
at java.awt.event.InvocationEvent.dispatch(Unknown Source)
at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
at java.awt.EventQueue.access$200(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue.dispatchEvent(Unknown Source)
at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.run(Unknown Source) 
```

这是程序的完整输出。0 = B&W 后面的“1”和“Print name to...”后面的“2”是用户输入。

这是 Screen.java：

```
public class Screen extends JPanel {

  String[] pixels;
  Color[] proxlol;

  public Screen(String[] in1, Color[] in2) {
    in1 = pixels;
    in2 = proxlol;
  }

  public void paintComponent(Graphics g) {
    super.paintComponent(g);
    this.setBackground(Color.WHITE);
    int row = 1, column = 1, row10, column10;
    for(int i = 0; i != 256; i++) {
      System.out.println("Drawing" + row + column);
      g.setColor(proxlol[i]);
      if(i == 17 || 
          i == 33 || 
          i == 49 || 
          i == 65 || 
          i == 81 ||
          i == 97 ||
          i == 113 ||
          i == 129 ||
          i == 145 ||
          i == 161 ||
          i == 177 ||
          i == 193 ||
          i == 209 ||
          i == 225 ||
          i == 241
          ){
        row++;
        column = 1;
      }
      row10 = row*10;
      column10 = column*10;
      g.fillRect(row10, column10, 10, 10);
      System.out.println("Done drawing" + row + column);
      column++;     
    }
  }
} 
```

如果需要，[Main.java](http://pastebin.com/WkKea2q2)和[Arranger.java](http://pastebin.com/Eh29zgjm)在 pastebin 上。

我以前对 Swing 的经验很少。这是怎么回事？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T16:40:28.670

你永远不会为你的类变量赋值`proxlol`。

```
public class Screen extends JPanel {
    String[] pixels;
    Color[] proxlol;

    public Screen(String[] in1, Color[] in2) {
        in1 = pixels;
        in2 = proxlol;
    }
} 
```

您将未初始化的类变量分配给输入参数（无效）`in2`。因此，在您的绘画方法中，当您引用颜色数组时，您会得到一个 NPE。

# php - 使用带有 OR / GROUP BY / ORDER BY 的索引：如何避免文件排序？

> ID：13420686
> 
> 赞同：-2
> 
> 时间：2012-11-16T16:36:51.047
> 
> 标签：php, mysql

我正在尝试对以下查询使用索引，但结果是`filesort`.
我应该如何更改查询和/或索引以提高性能（避免文件排序）？

我尝试使用`UNION`但`filesort`仍然存在。

```
CREATE TABLE message (  
  Ms_ID INT(16) UNSIGNED NOT NULL AUTO_INCREMENT, 
  conversation INT(16) UNSIGNED NOT NULL, 
  subject ENUM('E', 'F', 'S-C', 'S-A', 'R-RS', 'R-ILP', 'Re-M', 'Re-I', 'Re-R', 'O', 'SP', 'T', 'I', 'C', 'Of', 'R') DEFAULT NULL, 
  subject_ID INT(16) UNSIGNED DEFAULT NULL, 
  sender INT(11) UNSIGNED, -- NULL=guest
  recipient INT(11) UNSIGNED NOT NULL, 
  message VARCHAR(256), 
  status ENUM('U','R','SD', 'RD', 'SRD'), -- (unread, read, sender deleted, recipient deleted) 
  dateTime DATETIME NOT NULL,   
  PRIMARY KEY (Ms_ID), 
  FOREIGN KEY (sender) REFERENCES member (M_ID),
  FOREIGN KEY (recipient) REFERENCES member (M_ID)

CREATE INDEX xMs_C ON message (conversation, sender, recipient, status, subject, dateTime)
CREATE INDEX xMs_D ON message (dateTime, conversation, recipient, sender, status, message)
CREATE INDEX xMs_R ON message (recipient, sender, status, dateTime, message)
CREATE INDEX xMs_S ON message (sender, recipient, status, dateTime, message)

EXPLAIN
  SELECT Ms.*, M.userName   
  FROM message Ms -- FORCE INDEX (xMs_S)
    INNER JOIN member M ON M_ID=IF (sender='3', recipient, sender)
  WHERE Ms.status!='SRD' AND ((sender='3' AND Ms.status!='SD') OR (recipient='3' AND Ms.status!='RD')) 
  GROUP BY conversation   
  ORDER BY dateTime DESC 
```

* * *

```
id  select_type     table   type    possible_keys   key     key_len     ref     rows    Extra
1   SIMPLE  Ms  ALL     xMs_S   NULL    NULL    NULL    77  Using where; Using temporary; Using filesort
1   SIMPLE  M   eq_ref  PRIMARY     PRIMARY     4   func    1   Using where 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:15:20.470

你可以尝试这样的事情：

```
SELECT *

FROM

(
SELECT Ms.*, M.userName   
FROM message Ms -- FORCE INDEX (xMs_S)
    INNER JOIN member M ON M_ID = recipient
  WHERE Ms.status!='SRD' AND sender='3' AND Ms.status!='SD' 

UNION ALL

SELECT Ms.*, M.userName   
FROM message Ms -- FORCE INDEX (xMs_S)
    INNER JOIN member M ON M_ID = sender
  WHERE Ms.status!='SRD' recipient='3' AND Ms.status!='RD'
) a

GROUP BY conversation   
ORDER BY dateTime DESC; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:43:26.523

`GROUP BY`并`ORDER BY`要求分类；如果不对数据进行排序，MySQL 根本无法产生您要求的结果。 *使用文件*排序意味着 MySQL 正在对您的数据表进行排序。继续对机器大发雷霆，但它正在做你要求它做的事情。

它可能使用索引排序而不是文件排序，但您按`conversation`. 该列不会作为您在问题中显示的任何索引的第一个组成部分出现。

发生的事情是服务器必须将您连接的数据收集到一个临时表中以对其进行排序。查看 MySQL / MariaDB 开发人员的 Sergey Petrunia 的博客，了解其工作原理。

[http://s.petrunia.net/blog/?p=24](http://s.petrunia.net/blog/?p=24)

您还在`GROUP BY`语句中包含了许多隐藏的列。`GROUP BY`隐藏列的能力是 MySQL 独有的（错误）功能。这些隐藏的列可能是服务器收集您的连接数据然后在不同步骤中对其进行排序的原因之一。阅读 MySQL 手册的这一页以了解更多信息。

[http://dev.mysql.com/doc/refman/5.6/en/group-by-hidden-columns.html](http://dev.mysql.com/doc/refman/5.6/en/group-by-hidden-columns.html)

除了在输出中看到*Using filesort*`EXPLAIN`之外，你怎么知道你遇到了性能问题？您正在处理多少数据？需要多长时间？

# ruby-on-rails - Heroku 使用 JRuby 1.7 和 Rails 3.2 运行进程挂起

> ID：13420690
> 
> 赞同：2
> 
> 时间：2012-11-16T16:36:51.977
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, jruby

我能够使用 JRuby 和 trinidad 在 heroku 上运行 Web 进程。我在我的 Gemfile 中使用它，这似乎是目前自定义 heroku buildpack 的最佳实践：

```
ruby "1.9.3", :engine => "jruby", :engine_version => "1.7.0" 
```

但是，在尝试通过以下方式加载数据库（或连接到 rails 控制台）时：

```
heroku run rake db:schema:load 
```

或者

```
heroku run console 
```

该命令只是挂起。跟踪 heroku 日志，我看到进程启动并没有错误地完成，但我从来没有在本地命令行上得到任何输出，它只是挂起。

```
2012-11-16T16:02:46+00:00 heroku[api]: Starting process with command `bundle exec rake db:schema:load`
2012-11-16T16:02:51+00:00 heroku[run.1]: Awaiting client
2012-11-16T16:02:51+00:00 heroku[run.1]: Starting process with command `bundle exec rake db:schema:load`
2012-11-16T16:02:51+00:00 heroku[run.1]: State changed from starting to up
2012-11-16T16:02:51+00:00 heroku[run.1]: State changed from starting to up
2012-11-16T16:03:21+00:00 heroku[run.1]: State changed from up to complete
2012-11-16T16:03:21+00:00 heroku[run.1]: State changed from up to complete
2012-11-16T16:03:21+00:00 heroku[run.1]: Process exited with status 0 
```

我猜我需要在 Procfile 中添加一个 rake 和控制台项，并尝试了一些不同的组合，但没有任何效果。它总是挂起。我也没有看到任何其他人的 JRuby Procfile 包括这些项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T21:44:26.163

这原来是从 JRuby 中运行 heroku gem 的一个问题。从 JRuby（MRI 1.9.3）外部通过 heroku 工具带运行命令可以正常工作。

# vba - 如何将 VBA 文本框格式化为长日期

> ID：13420691
> 
> 赞同：0
> 
> 时间：2012-11-16T16:36:52.267
> 
> 标签：vba, excel

我有一个用于日期显示的文本框，它以这种格式显示日期：2012 年 4 月 17 日，但我想将其格式化为“2012 年 4 月 17 日”。我试过这段代码

```
UserForm1.txtDate = Format(Long Date) 
```

我从编译器收到语法错误。你能告诉我该怎么做吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T17:33:20.820

有几个关于这个的帖子。罪魁祸首似乎是您的系统日期格式。当系统设置改变时，使用短、中、长格式会改变结果。

*   在美国系统中，主要是这样完成的，例如`Format$(yourdate, “dd/mm/yyyy”)`
*   作为欧洲系统，例如`Format$(yourdate, “short date”)`

如果我们着眼于明确定义您的格式，您正在制定您的区域设置！

好的*，例如短日期并不总是 mm/dd/yyyy，但可能是 dd/mm/yyyy。*这是实际指定格式的关键优势。您可以简单地更改您希望日期的外观，而不是依赖于系统（无论您是否知情）。

当我们第一次遇到这种情况时，我们有一些制作 VBA 应用程序并将其发送到另一个地方，他们有自己的本地化系统日期格式。你的电话响了... ;)

*   短/长日期：根据系统的长日期格式显示日期。
*   中日期：使用适用于主机应用程序语言版本的中日期格式显示日期。

在您的情况下，您可以使用，

```
UserForm1.txtDate.Value = Format$(Date,"mmmm dd, yyyy") 
```

或者为了超级安全，

```
Dim dtDate as Date
    dtDate = DateSerial(Year(Date), Month(Date), Day(Date)) 
    UserForm1.txtDate.Value = Format$(dtDate, "mmmm dd, yyyy") 
```

希望有帮助。

*   [参考](http://chandoo.org/forums/topic/format-date-to-get-august-24-2012)

# angularjs - 是否可以在 AngularJS 中转换视图和模型之间的值以供输入？

> ID：13420693
> 
> 赞同：41
> 
> 时间：2012-11-16T16:36:54.147
> 
> 标签：angularjs

AngularJS 的新手。试图弄清楚我将如何做到这一点，或者是否有可能。

我知道我可以通过使用将值绑定到输入框

```
<input type="number" ng-model="myvalue"> 
```

但是如果我想要模型和视图之间的值被转换怎么办？

例如，对于货币，我喜欢以美分存储我的价值。但是，我想允许我的用户输入美元金额。所以我需要在视图和控制器之间将值转换为 100 倍，即在模型中我将有 100，而在视图中我将有 1。

那可能吗？如果是这样，我该如何实现？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-09-11T14:13:44.407

我遇到了和你一样的问题。我开始使用 wciu 的解决方案，但遇到了一个问题，即数值会在美分和美元之间闪烁。我最终连接到用于在视图和模型之间进行绑定的管道。

```
merchantApp.directive('transformTest', function() {
  return { restrict: 'A',
    require: 'ngModel',
    link: function(scope, element, attrs, ngModel) {

      if(ngModel) { // Don't do anything unless we have a model

        ngModel.$parsers.push(function (value) {
          return value*100;
        });

        ngModel.$formatters.push(function (value) {
          return value/100;
        });

      }
    }
  };
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-04-09T15:14:32.543

我只会使用 Object.defineProperty 来解决这个问题，例如：

```
var prop = 0;
Object.defineProperty($scope, "prop", {
    get: function () {
        return prop / 100;
    },
    set: function (value) {
        prop = parseInt(value) * 100;
    }
}); 
```

变量 prop 现在总是 = $scope.prop * 100。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-17T04:18:45.867

[从该页面http://docs.angularjs.org/api/ng.directive:ngModel.NgModelController](http://docs.angularjs.org/api/ng.directive:ngModel.NgModelController)了解如何使用 NgModelController 的指令执行此操作

基本上，以下指令将为带有 transformTest 作为属性的输入字段乘/除 100。

```
merchantApp.directive('transformTest', function() {
  return { restrict: 'A',
    require: 'ngModel',
    link: function(scope, element, attrs, ngModel) {
      if (!ngModel) return;

      ngModel.$render = function () {
        element.val(ngModel.$viewValue / 100);
      }

      element.bind('blur keyup change', function() {
        scope.$apply(read);
        ngModel.$render();
      }); 

      read();

      function read() {
        ngModel.$setViewValue(element.val() * 100);
      }
    }
  };
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-16T17:33:05.980

您可以在输入元素上使用[ngChange](http://docs.angularjs.org/api/ng.directive%3ainput)可选方法来执行一个函数，以将用户输入操作为您在每次更改时查找的格式。

```
 function Ctrl($scope) {
        $scope.valueEntered = '';
        $scope.value = '';

        $scope.valueEnteredChanged = function () {
            // more robust logic here
            $scope.value = $scope.valueEntered * 100;
        }
    } 
```

并带有看起来像这样的标记。

```
<div ng-controller="Ctrl">
    <input type="number" ng-model="valueEntered" ng-change="valueEnteredChanged()" /><br />
    <span ng-bind="valueEntered"></span><br />
    <span ng-bind="value"></span>
</div> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-16T23:54:33.567

$watch the model/dollar value and keep a cents property in synch:

```
function MyCtrl($scope) {
    $scope.$watch('dollars', function(dollars) {
        $scope.cents = $scope.dollars * 100;
    })
}​ 
```

Markup:

```
<input type="number" ng-model="dollars">
<br>{{dollars}} {{cents}} 
```

# android - 我必须运行垃圾收集吗？

> ID：13420696
> 
> 赞同：-1
> 
> 时间：2012-11-16T16:37:06.853
> 
> 标签：android, animation

```
 import android.app.Activity;

import android.graphics.drawable.AnimationDrawable;
import android.os.Bundle;

import android.widget.ImageView;

public class GenieComesOut extends Activity 
{

ImageView genie;
AnimationDrawable genieout;

@Override
 public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.genie_out);
        genie = (ImageView)findViewById(R.id.genieout);

        genieout = (AnimationDrawable) genie.getDrawable();
        genie.post(new Runnable() {public void run() {genieout.start();}});
    } 
```

我让动画开始运行，我只能在一个帧中容纳 20 帧，比我得到的 VM 不会分配更多，这些是全屏图像，我还剩下大约 50 帧，所以，我可以制作一个新的 /anim/xml切换到 ImageView 垃圾收集并运行另外 20 帧，这样做的正确方法是什么？感谢您的时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:41:45.403

如果真的是全屏动画，您应该考虑将动画转换为视频。然后可以轻松播放视频，并且不会占用您的内存。

以下是支持的格式列表：[Android 支持的媒体格式](http://developer.android.com/guide/appendix/media-formats.html)。您可以使用 H264 或 3GP，尝试看起来最好并且性能更好的。

# wpf - 在 WPF 应用程序中访问 MVC 4 MembershipProvider

> ID：13420697
> 
> 赞同：2
> 
> 时间：2012-11-16T16:37:08.177
> 
> 标签：wpf, asp.net-mvc, wcf, asp.net-membership

我有一个 MVC 应用程序，它使用实体框架创建一个 SQL DB，并通过 WCF DataService 提供对此的访问。我还有一个 WPF 应用程序，我想用它来控制 MVC 应用程序的 MembershipProvider 功能，例如注册新用户、更新用户名/密码等。

我查看了有关使用 MembershipProvider 函数在 WPF 应用程序中提供安全性的大量材料，但我很难找到有关如何*从*WPF 访问 MVC 函数的任何内容。

这是否可以使用 WCF DataService 或类似的东西？

# r - R ggplot2/ggmap 同心圆作为点

> ID：13420700
> 
> 赞同：6
> 
> 时间：2012-11-16T16:37:11.043
> 
> 标签：r, geolocation, ggplot2, geocoding, ggmap

我正在尝试绘制一些信息，这些信息显示全部人口，然后按地图上的位置显示该人口的一个子集。我已经看到使用同心圆或 3-d 倒锥形来传达这一点的数据可视化。我只是不知道如何在`ggplot`/`ggmap`

这是一个免费的版本，`Paint`其中显示了我要做什么的粗略想法： ![在此处输入图像描述](../Images/6e70c1a710dd94fa0ee35ca11e879f77.png)

这是一个粗略的数据示例：

```
> dput(df1)
structure(list(zip = c("00210", "00653", "00952", "02571", "04211", 
"05286", "06478", "07839", "10090", "11559"), city = c("Portsmouth", 
"Guanica", "Sabana Seca", "Wareham", "Auburn", "Craftsbury", 
"Oxford", "Greendell", "New York", "Lawrence"), state = c("NH", 
"PR", "PR", "MA", "ME", "VT", "CT", "NJ", "NY", "NY"), latitude = c(43.005895, 
17.992112, 18.429218, 41.751554, 44.197009, 44.627698, 41.428163, 
41.12831, 40.780751, 40.61579), longitude = c(-71.013202, -66.90097, 
-66.18014, -70.71059, -70.239485, -72.434398, -73.12729, -74.678956, 
-73.977182, -73.73126), timezone = c(-5L, -4L, -4L, -5L, -5L, 
-5L, -5L, -5L, -5L, -5L), dst = c(TRUE, FALSE, FALSE, TRUE, TRUE, 
TRUE, TRUE, TRUE, TRUE, TRUE), totalPop = c(43177, 37224, 37168, 
15492, 1614, 88802, 2587, 80043, 78580, 87461), subPop = c(42705, 
36926, 27556, 10827, 774, 39060, 1542, 21304, 53438, 2896)), .Names = c("zip", 
"city", "state", "latitude", "longitude", "timezone", "dst", 
"totalPop", "subPop"), row.names = c(1L, 50L, 200L, 900L, 1500L, 
2000L, 2500L, 3000L, 3500L, 4000L), class = "data.frame") 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-16T17:16:55.763

基本思想是为两个种群使用单独的几何图形，确保较小的几何图形在较大的图形之后绘制，因此其图层位于顶部：

```
library(ggplot2) # using version 0.9.2.1
library(maps)

# load us map data
all_states <- map_data("state")

# start a ggplot. it won't plot til we type p
p <- ggplot()  

# add U.S. states outlines to ggplot
p <- p + geom_polygon(data=all_states, aes(x=long, y=lat, group = group),
     colour="grey", fill="white" )

# add total Population
p <- p + geom_point(data=df1, aes(x=longitude, y=latitude, size = totalPop), 
     colour="#b5e521")

# add sub Population as separate layer with smaller points at same long,lat
p <- p + geom_point(data=df1, aes(x=longitude, y=latitude, size = subPop), 
     colour="#00a3e8")

# change name of legend to generic word "Population"
p <- p + guides(size=guide_legend(title="Population"))

# display plot
p 
```

![在此处输入图像描述](../Images/4f0d247bc5e2d29528866b14ee116491.png)

从地图中可以清楚地看出，您的数据包括非连续的美国位置，在这种情况下，您可能需要不同的基础地图数据。 `get_map()`from `ggmap`package 提供了几个选项：

```
require(ggmap)
require(mapproj)
map <- get_map(location = 'united states', zoom = 3, maptype = "terrain", 
       source = "google")
p <- ggmap(map) 
```

之后添加总人口和子人口 geom_point() 图层并像以前一样显示它。

# windows - 如何将用户组从一个域复制到另一个域？

> ID：13420709
> 
> 赞同：0
> 
> 时间：2012-11-16T16:37:49.200
> 
> 标签：windows, vbscript, batch-file, cmd, usergroups

所以基本上，我有一个小组在生产域上说“Prod”。我想将此组复制到我的测试域并保留用户和权限。

我怎样才能做到这一点？有没有办法使用`BATCH`or来做到这一点`VBscript`？

我试过`net group`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T10:22:39.170

`net group`不能跨域工作。您可以尝试[`ldifde`](http://support.microsoft.com/kb/237677)在源域中导出并在目标域中重新导入。[ADMT v3.0](http://www.microsoft.com/en-us/download/details.aspx?id=17488)用于使用 Windows NT 4.0 至 Windows 2003 的环境，或[ADMT v3.2](http://www.microsoft.com/en-us/download/details.aspx?id=8377)用于 Windows 2000 至 2008 R2 环境可能是另一种选择。

这两个域是否在同一个林中（或者，更具体地说，它们之间是否存在信任）？否则，您不仅要迁移组，还要迁移用户（也可以由 ADMT 处理）。

# python - 如何检查Python中的数组/列表中是否存在条目？

> ID：13420710
> 
> 赞同：0
> 
> 时间：2012-11-16T16:37:56.600
> 
> 标签：python, arrays, list

我的代码正在为列表中的名称分配值。如果我的列表中没有要分配给其中一个名称的条目，我需要知道如何检索或设置默认值。到目前为止我的代码：

```
array =[[a],[b],[c],[d]]
no1 = array[0]
no2 =array[1]
no3 =array[2]
no4 =array[3]
# if array[4] exists:
    no5 = array[4]
else
    no5 = 0 
```

我试过了-

```
try:
    array[4]
except ValueError:
    no5 = 0 
```

但它作为数组 [4] 超出范围出现。

澄清一下，由于我的代码编写并不出色，基本上我得到了一个程序的三个不同输入，该程序应该读取这些输入，然后将输出写入文件。问题是所有输入都有不同的数组长度。所以我想要做的是以某种方式让程序检查是否存在（比如说）array[4] 的条目，如果该条目不存在，则创建条目 array[4] 并将其设为零。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:45:22.497

你去`try`和/`except`很好。如果你得到一个，`IndexError`那么你真的很接近，你只是在你的`except`. 这会奏效：

```
try:
    no5 = array[4]
except IndexError:
    no5 = 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:45:28.407

您应该捕获`IndexError`（由 引发的实际错误`array[4]`）而不是`ValueError`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:48:14.743

而不是`try`你也可以检查数组的长度

```
def: elem_exists(arr, idx):
   return 0 <= ldx < len(arr) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T16:49:21.707

您试图捕获错误的异常类型

```
try:
    no5 = array[4]
except IndexError:
    no5 = 0 
```

一个漂亮的单线解决方案是使用[`itertools`](http://docs.python.org/2/library/itertools.html)

```
import itertools
(no1,no2,no3,no4,no5),_ = zip(*itertools.izip_longest(array[:5],range(5),fillvalue=0)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T16:50:48.233

为什么不像下面这样？

```
if len(array) > 4:
    no5 = array[4]
else:
    no5 = 0 
```

# java - Java - 从文本文件中读取对象

> ID：13420711
> 
> 赞同：1
> 
> 时间：2012-11-16T16:38:02.647
> 
> 标签：java, file, text, io

我有一个带有几个类的 Java 程序，它们是：

i) 形状 ii) 正方形 iii) 矩形 iv) 圆形 v) 三角形 vi) 画布 vii) 应用

Square、Rectangle、Circle 和 Triangle 都继承自**Shape类**

现在，在**绘图画布**类中，我有两种方法，一种用于将 Shape 类型的对象写入文件，另一种用于从文件中读取对象。

这是代码：

保存到文件的方法效果很好。但是，我在从文件中读取对象并将它们附加到 Shapes ArrayList 时遇到问题。

实际上，应用程序给了我**java.lang.String 无法转换为 shape_assignment.Shape**的错误。

如何读取存储在文本文件中的文本并使用它再次重新创建对象？谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:44:30.080

您需要编写一个读取器来获取输入字符串，并从中制作一个形状。这是一个简单的示例，向您展示如何使用[Java Date 类](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Date.html)进行操作。没有您的 Shape 构造函数，我无法为您编写您的 Shape 。

```
Date today=new Date();
long var_to_write=today.getTime();

//Save this in to a file, then read it out as long var_in_file

Date previousTime=new Date(var_in_file); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:48:35.127

您正在将一个字符串添加到您的 ArrayList 中。

```
 while(input.hasNext())
            {
                temp.add(input.next());
            }

            Shapes.add((Shape)temp.get(i)); 
```

在这里，您尝试将**String** **(** temp.get(i) 将返回 String) 转换为Shape **type**，这会导致**ClassCaseException**。

从文件中读取并使用 Shape 实例填充 ArrayList (temp) 后创建一个 Shape 实例。

```
 List<Shape> temp = new ArrayList<Shape>();
      //read from the scanner and make an Shape object. 
       Shape shape = new Shape(your arguments to the Shape cons);
       now, while adding into shapes you wont need a case, as you made yourself sure that your ArrayList would only accept Shape

       shapes(temp.get(i)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T17:02:32.557

您应该使用 an`ObjectOutputStream`来编写形状列表，并从 a 中检索它们`ObjectInputStream`：

```
out.writeObject(Shapes);

Shapes = (ArrayList)in.readObject(); 
```

假设`Shapes`是一个`ArrayList`.

# php - $.ajax 使用 jsonp 将空数据发布到服务器

> ID：13420713
> 
> 赞同：0
> 
> 时间：2012-11-16T16:38:10.790
> 
> 标签：php, jquery

下面的代码无法将数据发送到其他服务器。我想`"aaa-bbb-ccc"`用 $.ajax 发送。但在回`userCode`发后，那是从 $_POST 发布空数据。对不起我的英语不好

jQuery代码：

```
<script type="text/javascript">
$(function(){
    $.ajax({
        url: "http://www.site.com/index.php",
        type: "POST",
        dataType: "jsonp",
        data: {userCode: "aaa-bbb-ccc"}
    }).done(function(data){
        alert(data.message);
    });
});
</script> 
```

服务器 index.php ：

```
<?php
include_once ('./AFactory.class.php');
$database= new AFactory;
$db=new AFactory();
$link=$db->getDBO();
if ( $_POST['userCode'] == '')
{
    $data['success']=false;
    $data['message']='ERROR ...';
}
else {
    $query=array('id'=>NULL,'userCode'=>$_POST['userCode']);
    $sql=$db->insertQuery('`alachiq_takhmis`.`users`',$query);
    if ( mysql_query($sql) ) 
        {
            $data['success']=true;
            $data['message']=$_POST['userCode']; 
        }
    else 
        {
            $data['success']=false;
            $data['message']=$_POST['userCode'];
        }
}
echo $_GET['callback'] . '('. json_encode($data) . ')';
?> 
```

回帖：

```
({"success":false,"message":'ERROR ...'}) 
```

我的代码问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:40:03.290

JSONP 通过将具有属性的`<script>`元素注入到文档中来工作。`src`

那只能发出 GET 请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:07:41.103

```
$.ajax({
    url: "http://www.site.com/index.php",
    type: "GET",
    dataType: "jsonp",
    data: {userCode: "aaa-bbb-ccc"}
}); 
```

# .net - 添加第二个 GridView 时 ConnectionString 发生变化

> ID：13420716
> 
> 赞同：0
> 
> 时间：2012-11-16T16:38:22.960
> 
> 标签：.net

我被迫在 MSc 实验室使用 .NET WebForms 向导。我无法描述 Spring on Java 之后的感受，我很痛苦。

在为 GridView 配置数据源时，我注意到 ConnectionString 会在您添加第二个 GridView2 并选择与 GridView1 相同的数据源到服务器表单时覆盖自身，同时更改 SQL 以显示来自另一个表的数据。结果，它使 GridView1 查询与第二个 GridView2 相同的数据。

这是如何运作的？在 java 中，dataSource 没有绑定到任何 ConnectionString/SQL 语句... - 我们可以根据需要将它与任意数量的不同 sql 查询一起使用，为什么这是一个问题？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T19:55:27.010

`SqlDataSource`在其属性中包含选择字符串，在属性中包含`SelectCommand`连接字符串`ConnectionString`。因此，您必须为第二个 GridView 创建另一个数据源或在 C# 中动态更改其属性。

```
if(dataBoundFirstGridView)
{
    SqlDataSource1.ConnectionString = "..";
    SqlDataSource1.SelectCommand = "select * from table1";
} 
```

# mongodb - 使用 MongoDB 订购待办事项列表

> ID：13420720
> 
> 赞同：4
> 
> 时间：2012-11-16T16:38:45.157
> 
> 标签：mongodb

我正在尝试使用 Javascript、Python 和 MongoDB 创建自己的待办事项列表。我被困在如何处理任务排序上。

我目前的想法是在每个任务文档中都有一个订单字段，当客户端上的订单发生变化时，我会从数据库中获取任务列表并单独/按顺序重新排序每个任务。这看起来很尴尬，因为大的待办事项列表意味着大量的查询。有没有办法按顺序更新多个文档中的字段？

我也在寻找关于这是否是最好的方法的建议。我希望能够保持待办事项列表的顺序，但也许我做错了。

```
{
  "_id" : ObjectId("50a658f2cace55034c68ce95"),
  "order" : 1,
  "title" : "task1",
  "complete" : 0
}

{
  "_id" : ObjectId("50a658fecace55034c68ce96"),
  "order" : 2,
  "title" : "task2",
  "complete" : 1
}

{
  "_id" : ObjectId("50a65907cace55034c68ce97"),
  "order" : 3,
  "title" : "task3",
  "complete" : 1
}

{
  "_id" : ObjectId("50a65911cace55034c68ce98"),
  "order" : 4,
  "title" : "task4",
  "complete" : 0
}

{
  "_id" : ObjectId("50a65919cace55034c68ce99"),
  "order" : 5,
  "title" : "task5",
  "complete" : 0
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T17:25:06.233

Mongo 的查询速度非常非常快，您不应该像使用功能齐全的关系数据库那样关心性能。如果您想谨慎一点，只需创建一个包含 1k 项的待办事项列表并尝试一下，它应该是非常即时的。

```
for (var i = 0; i < orderedListOfIds.length; i++)
{
  db.collection.update({ '_id': orderedListOfIds[i] }, { $set: { order:i } })
} 
```

然后

```
db.collection.find( { } ).sort( { order: 1 } ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:55:42.343

是的，mongo 允许更新多个文档。只需使用[修饰符操作](http://www.mongodb.org/display/DOCS/Updating#Updating-ModifierOperations)和`multi=True`. 例如，`order`对于所有`order`大于 5 的文档，这会增加 1：

```
todos.update({'order':{'$gt':5}}, {'$inc':{'order':1}}, multi=True) 
```

至于最好的方法，通常最好使用“自然”排序（按名称、日期、优先级等），而不是为此创建一个假字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T01:59:03.293

我正在做类似的事情。`ind`我在列表项中添加了一个字段。以下是我将列表项移动到新位置的方法：

```
moveItem: function (sourceIndex, targetIndex) {
    var id = Items.findOne({ind:sourceIndex})._id;
    var movinUp = targetIndex > sourceIndex;
    shift = movinUp ? -1 : 1;
    lowerIndex = Math.min(sourceIndex, targetIndex);
    lowerIndex += movinUp ? 1 : 0;
    upperIndex = Math.max(sourceIndex, targetIndex);
    upperIndex -= movinUp ? 0 : 1;
    console.log("Shifting items from "+lowerIndex+" to "+upperIndex+" by "+shift+".");
    Items.update({ind: {$gte: lowerIndex,$lte: upperIndex}}, {$inc: {ind:shift}},{multi:true});
    Items.update(id, {$set: {ind:targetIndex}});
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-19T21:19:49.100

如果您在猫鼬中使用本机承诺（es6），`mongoose.Promise = global.Promise`您可以执行以下批处理：

```
function batchUpdate(res, req, next){
  let ids = req.body.ids
  let items = []
  for(let i = 0; i < ids.length; i++)
    items.push(db.collection.findOneAndUpdate({ _id:ids[i] }, { $set: { order:i } }))

  Promise.all(items)
    .then(() => res.status(200).send())
    .catch(next)
} 
```

# android - 将位图从 ZipinputStream 直接保存到文件

> ID：13420721
> 
> 赞同：0
> 
> 时间：2012-11-16T16:38:47.457
> 
> 标签：android, android-image

我有一个 zip 文件，通过使用`zis.getNextEntry()`.

可以很好地从 ZipEntry 获取`String`对象，我需要将副本保存到我的应用程序的目录中。

我很好的目录部分我只需要知道如何立即保存每个位图，而不必对其进行解码并在内存中创建一个位图对象。

这是我获取每个文本文件内容的代码。

```
if (decodeFile) { // WE ARE LOOKING AT A FILE WE CAN DECODE
    while ((read = zis.read(buffer, 0, 1024)) >= 0) {
        String string = new String(buffer, 0, read);
        s.append(string);
    }
    stringArray.add(s.toString());
} else { // WE ARE LOOKING AT AN IMAGE/DIRECTORY

} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:54:05.580

您应该简单地创建一个 OutputStream，而不是将值读取到 String，而是将它们直接写入 OutputStream。

它应该是这样的：

```
ZipFile zipFile = new ZipFile("foo.zip");
InputStream in = null;
OutputStream out = new FileOutputStream("...");

in = zipFile.getInputStream(zipFile.getEntry("yourbitmap.jpg"));

byte data[] = new byte[1024];
while ((count = in.read(data, 0, 1024)) != -1) {
    out.write(data, 0, count);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:50:04.687

```
if (decodeFile) { // WE ARE LOOKING AT A FILE WE CAN DECODE
        FileWriter fw = new FileWriter("path/name.ext");
        while ((read = zis.read(buffer, 0, 1024)) >= 0) {
            String string = new String(buffer, 0, read);
            fw.write(string);
        }
        fw.close();
    } else { // WE ARE LOOKING AT AN IMAGE/DIRECTORY

    } 
```

也许像这样？

# c# - Validationssummary 未显示控制器中生成的错误

> ID：13420730
> 
> 赞同：2
> 
> 时间：2012-11-16T16:39:10.680
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

当我在控制器中生成错误并返回视图时，验证摘要不会显示。对于视图本身生成的错误，一切正常。我们怎样才能使摘要显示出来？

这是简化的控制器方法：

```
[HttpPost]
public ActionResult EditProfil(Prospect prospect)
{
    ModelState.AddModelError(string.Empty, "You have an error");

    if (!ModelState.IsValid)
        return View("Edit", prospect);

    return Json(prospect);
} 
```

视图如下所示：

```
@model Prospect

@{
    ViewBag.Title = "Profil du prospect";
    Layout = null;
}

//Some javascript and CSS unrelated to validations

@using (Html.BeginForm())
{
    @Html.ValidationSummary(false)
    //My form controls...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:43:01.260

**编辑**

问题是

```
ModelState.AddModelError(string.Empty, "You have an error"); 
```

和

```
@Html.ValidationSummary(false) 
```

一个空字符串是`""`作为属性名称插入的，事件认为它是一个空字符串。`false`从呈现摘要中删除布尔值或传递`null`给模型状态包。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-04T14:34:04.920

使用 MVC4，传递`null`到`ModelState.AddModelError`是无效的。这实际上使用：

```
ModelState.AddModelError(string.Empty, "Error"); 
```

和

```
@Html.ValidationSummary(false) 
```

原来我有两个问题。

1.  我返回了错误的观点。
2.  我正在使用 Ajax 调用而不是更新`div`.

以下为我解决了它：

```
 <div id="results">
    @{
    using (Ajax.BeginForm("CreateLookupTable", "Lookup", new AjaxOptions { HttpMethod = "POST", OnSuccess = "FormSuccess()", UpdateTargetId ="results" }))
    {
        @Html.ValidationSummary(false)

        // Form
    }
    </div> 
```

# automation - 使用控制台应用程序连接到 Windows Phone 8

> ID：13420733
> 
> 赞同：5
> 
> 时间：2012-11-16T16:39:14.360
> 
> 标签：automation, windows-phone-8

我对 Windows Phone 开发非常陌生。我想开发一个应用程序，当我将 Windows 8 手机连接到我的笔记本电脑时将启动它。我正在学习本教程（[http://justinangel.net/WindowsPhone7EmulatorAutomation](http://justinangel.net/WindowsPhone7EmulatorAutomation)）并且能够连接到我的 Windows 7 手机/模拟器，但我无法连接到我的 Windows 8 手机或模拟器。有没有其他方法可以连接到 Windows 8 手机？

请让我知道是否有任何可能的解决方案，

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-17T10:32:25.767

我还没有机会更新这篇博文。Delvis Gomez（我的一位同事）更新了最终的代码示例并可以自由分发。将来我会为 WP8 更新该博客文章，但与此同时，这里有一个关于如何自动化 WP8 模拟器的很好记录的代码片段。

此外，请确保添加对所需的新 DLL 的引用，例如 Microsoft.SmartDevice.MultiTargeting.Connectivity。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.IO;
using System.Reflection;

// Libraries needed to connect to the Windows Phone X Emulator
using Microsoft.SmartDevice.Connectivity;
using Microsoft.SmartDevice.Connectivity.Interface;
using Microsoft.SmartDevice.MultiTargeting.Connectivity;
using System.Globalization;
using System.Collections.ObjectModel;

namespace AutomatedUnitTestDriver
{
    class Program
    {
        static void Main(string[] args)
        {
            MultiTargetingConnectivity connectivity = new MultiTargetingConnectivity(CultureInfo.CurrentUICulture.LCID);

            // Get a connectable device for a specific Device ID (from the CoreCon datastore)
            string deviceId = "5E7661DF-D928-40ff-B747-A4B1957194F9";
            ConnectableDevice connectableDevice = connectivity.GetConnectableDevice(deviceId);
            Console.WriteLine("Found Connectable Device \'" + connectableDevice.Name + "\' for Device id {" + connectableDevice.Id + "}.");

            // Connect to the Device
            Console.WriteLine("Connecting to Device...");
            IDevice iDevice = connectableDevice.Connect();
            Console.WriteLine("Done!");

            // Check if the application is already install, if it is remove it (From WMAppManifect.xml)
            Guid appID = new Guid("{b6635769-b7ac-41a5-915d-5a7b0ae34481}"); 

            if (iDevice.IsApplicationInstalled(appID))
            {
                Console.WriteLine("Uninstalling application...");
                iDevice.GetApplication(appID).Uninstall();
                Console.WriteLine("Done!");
            }

            Guid productId = appID;
            Guid instanceId = appID;
            string applicationGenre = "NormalApp";
            string iconPath = @"C:\Share\LatestAPI\TestCode\Automated\AutomatedUnitTests\Bin\Debug\ApplicationIcon.png";
            string xapPackage = @"C:\Share\LatestAPI\TestCode\Automated\AutomatedUnitTests\Bin\Debug\AutomatedUnitTests.xap";

            // Install the application 
            Console.WriteLine("Installing the application...");
            IRemoteApplication remoteApplication = iDevice.InstallApplication(appID, appID, applicationGenre, iconPath, xapPackage);
            Console.WriteLine("Done!");

            // Launch the application
            Console.WriteLine("Starting the application...");
            remoteApplication.Launch();

            int startStopWaitTime = 1000;   // msec
            int executionWaitTime = 180000; // msec

            // Note that IRemoteApplication has a 'IsRunning' method but it is not implemented.
            // So, for the moment we sleep few msec.
            Thread.Sleep(startStopWaitTime);
            Console.WriteLine("Done!");

            // Allow application to complete 
            Console.WriteLine("Application is running! Waiting few seconds...");
            Thread.Sleep(executionWaitTime);

            try
            {
                IRemoteIsolatedStorageFile remoteIsolatedStorageFile = remoteApplication.GetIsolatedStore();
                string sourceDeviceFilePath = (object)Path.DirectorySeparatorChar + "TestResults.trx";
                string targetDesktopFilePath = @"C:\Share\LatestAPI\TestCode\Automated\AutomatedUnitTests\Bin\Debug\" + "TestResults.trx";
                remoteIsolatedStorageFile.ReceiveFile(sourceDeviceFilePath, targetDesktopFilePath,true);
            }
            catch (Exception exception)
            {
                Console.WriteLine("Exception \'" + exception.Message + "\' reading file from device.");
            }

            // Terminate application
            Console.WriteLine("Terminating the application...");
            remoteApplication.TerminateRunningInstances();

            Thread.Sleep(startStopWaitTime);
            Console.WriteLine("\nDone!");

            // Disconnect from the emulator
            Console.WriteLine("Disconnecting Device...");
            iDevice.Disconnect();
            Console.WriteLine("\nDone!");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T19:38:21.060

我在实施接受的解决方案时遇到了麻烦，因为我缺少这些命名空间的引用：

```
Microsoft.SmartDevice.Connectivity.Interface
Microsoft.SmartDevice.MultiTargeting.Connectivity 
```

这是我找到它们的地方：

```
C:\Windows\Microsoft.NET\assembly\GAC_MSIL\
   Microsoft.SmartDevice.Connectivity.Interface\
   v4.0_11.0.0.0__b03f5f7f11d50a3a\
   Microsoft.Smartdevice.Connectivity.Interface.dll 
```

和

```
C:\Windows\Microsoft.NET\assembly\GAC_MSIL\
   Microsoft.SmartDevice.MultiTargeting.Connectivity\
   v4.0_11.0.0.0__b03f5f7f11d50a3a\
   Microsoft.Smartdevice.MultiTargeting.Connectivity.dll 
```

请注意，这些路径，尤其是`v4.0_11.0.0.0__b03f5f7f11d50a3a`部件，在您的系统上可能会有所不同。在您的项目中添加对这些 DLL 的引用，一切都应该正常工作。

# php - 连接和排序两个具有相同列的表

> ID：13420734
> 
> 赞同：0
> 
> 时间：2012-11-16T16:39:18.013
> 
> 标签：php, mysql

我正在尝试将这两个表组合起来，然后按一列 ( `stamp`) 对其进行排序，并对第二个表的`id`字段进行别名。我尝试过加入、合并，但似乎没有任何效果。我也试图按`mm`

桌子`note`

```
 id | mm |   stamp    |
==========================
  1  | 5  | 2009-12-11 |
  2  | 33 | 2010-09-10 |
  3  | 22 | 2011-07-08 |
  4  | 1  | 2012-05-06 | 
```

桌子`note_admin`

```
 id | mm |   stamp    |
==========================
  1  | 5  | 2009-08-15 |
  2  | 5  | 2011-11-11 |
  3  | 5  | 2012-01-08 |
  4  | 35 | 2012-02-06 | 
```

我认为可行的查询：

```
(SELECT * FROM note WHERE mm=5)
UNION
(SELECT id AS a_id, mm, stamp FROM note_admin WHERE mm=5) 
ORDER BY stamp DESC 
```

预期结果

```
 id | a_id | mm |   stamp    |
================================
     |   3  | 5  | 2012-01-08 |
     |   2  | 5  | 2011-11-11 |
  1  |      | 5  | 2009-12-11 |
     |   1  | 5  | 2009-08-15 | 
```

我什至不知道这是否可能。我找到了一种在 PHP 中对其进行排序的方法，但如果可以在 mySQL 中完成它会容易得多。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:51:17.953

我认为您的意思是，请注意相同的 4 列名称（虽然不确定顺序）：

```
(SELECT a_id as NULL, note.* FROM note WHERE mm=5) UNION (SELECT id AS a_id, NULL as id, mm, stamp FROM note_admin WHERE mm=5) ORDER BY stamp DESC 
```

# javascript - 刷新后显示和隐藏块

> ID：13420739
> 
> 赞同：0
> 
> 时间：2012-11-16T16:39:39.370
> 
> 标签：javascript, html, css

我想在页面刷新后保持隐藏块的状态。当我刷新页面时，“隐藏”块现在是“显示”。请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:46:56.907

我建议在刷新时将“隐藏”值（true/false）传回服务器，然后在每次加载页面时分配它（不要忘记为首次访问设置默认值）。

如果您发布代码示例或告诉我您使用的是什么技术（例如 .NET、MVC3），我可以为您提供一些示例代码或资源，让您开始了解如何做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:02:16.380

这确实需要[CSS3 :target](http://www.w3schools.com/cssref/sel_target.asp)伪选择器，但它可能是一个可行的解决方案：

**CSS：**

```
#myblock {
    width:100px;
    height:100px;
    background-color:#3a6d90;
    display:none; // div starts out as hidden
}

#myblock:target {
    display:block;
} 
```

**HTML：**

```
<a href='javascript:showBlock();'>Show It</a>
<div id='myblock'></div> 
```

**Javascript：**

```
function showBlock() {
    document.getElementById('myblock').style.display = "block";
    window.location.hash = "myblock"; // set url hash
} 
```

该解决方案通过在元素通过`showBlock()`. 当`#myblock:target`#myblock 散列存在时，通过将显示属性设置为 'block' 来实现魔法

# spring-mvc - 在spring mvc中创建和访问属性文件

> ID：13420741
> 
> 赞同：0
> 
> 时间：2012-11-16T16:39:45.747
> 
> 标签：spring-mvc

[阅读关于 SO 的这篇文章](https://stackoverflow.com/questions/10044789/accessing-application-properties-in-spring-mvc)，并有一些澄清问题。

我将 config.properties 放在 src/main/resources 下

在`spring-servlet.xml config file`

我添加了以下内容：

```
<context:property-placeholder location="classpath:config.properties"/> 
```

在我的业务层中，我试图通过

```
@Value("${upload.file.path}")
private String uploadFilePath; 
```

Eclipse 显示错误：

```
The attribute value is undefined for the annotation type Value 
```

我不能访问业务层中的属性还是只能在控制器中读取属性文件？

更新:: src/main/java/com.companyname.controllers/homecontroller.java

```
public String home(Locale locale, Model model) {
    MyServiceObject myObj = new MyServiceObject();
    System.out.println("Property from my service object: = " + myObj.PropertyValue());

    if(myObj.PerformService())
    {
      ///
    }
} 
```

src/main/java/com.companyname.services/MyService.java

```
public class MyServiceObject {

    @Value("${db.server.ip}")
    private String _dbServerIP;

    public String PropertyValue() {

        return _dbServerIPaseURL;
    }

} 
```

[我找到解释的另一个网站](http://www.finalconcept.com.au/article/view/spring-using-the-value-annotation)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:59:47.603

请检查您是否从 org.springframework.beans.factory.annotation 包中导入了 Value：

```
import org.springframework.beans.factory.annotation.Value; 
```

属性占位符也必须在相应的上下文配置文件中声明，如果是控制器，它可能是 Spring 调度程序 servlet 配置文件。

**更新**您[`property-placeholder`](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-factory-placeholderconfigurer)对 post 处理包含美元符号`${<property name>}`的bean 值感到困惑， [Spring 表达式语言容器扩展](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/expressions.html#expressions-beandef)处理包含哈希符号的值`#{<Spring expression language expression>}`，在您显示的链接中使用了后一种方法。

**关于 MyServiceObject myObj 的实例化** 如果您希望对象由 Spring 管理，您应该将其创建委托给容器：

*   如果`MyServiceObject`是无状态服务，那么它是具有单例 bean 范围的单例，您应该在应用程序上下文中注册它，例如使用以下 xml 配置：

    ```
    <bean class="my.package.MyServiceObject"/> 
    ```

    并将其注入您的控制器：

    ```
    private MyServiceObject myServiceObject;
    @Autowired 
    public void setMyServiceObject(MyServiceObject myServiceObject){
       this.myServiceObject = myServiceObject;
    } 
    ```

*   如果需要许多实例`MyServiceObject`，您可以将其声明为具有其他（非单例）bean 范围（例如原型或请求）的 bean。但是，由于控制器只有一个实例，因此不能仅仅让 Spring 容器将`MyServiceObject`实例自动装配到控制器字段，因为将只有一个字段和多个`MyServiceObject`类实例。[您可以在文档的相应部分](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html#beans-factory-scopes)了解解决此问题的不同方法（针对不同的 bean 范围）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-05T22:09:19.813

这是一种允许我们从属性文件中获取所需值的方法。这可以在 Java 代码（控制器类）或 JSP 中。

*   创建一个属性文件 WEB-INF/classes/ **messageSource.properties**它将位于类路径中，并且可以在控制器和 JSTL 中访问。像任何属性文件一样，这个文件由一个键和一个值组成

    例如：
    hello=Hello JSTL、Hello Contoller

**对于控制器**

*   找到用于定义 Spring bean 的 xml 文件。在我的例子中，它被命名为 servlet-context.xml。在使用 servlet contextConfigLocation 属性的情况下，您可能需要通过查看 web.xml 来确定这一点。

*   使用 id="messageSource" 添加一个新的 Spring bean 定义。这个 bean 将在运行时由 Spring 与属性文件键值对一起加载。使用以下属性创建 bean：

    *   bean id="messageSource"

    *   类 = org.springframework.context.support.ReloadableResourceBundleMessageSource

    *   属性名称="basename" 值="WEB-INF/classes/messageSource

*   在控制器类 (testController) 的 bean 定义文件中，添加 messageSource 作为属性。这会将 messageSource bean 注入控制器。

    *   bean id="testController" 类="com.app.springhr.TestController"
    *   豆类：**属性名称=“消息来源”参考=“消息来源**”
*   在控制器 JAVA 类中，添加 messageSource Spring Bean 字段及其 getter 和 setter。注意字段类型是 ReloadableResourceBundleMessageSource。

    私人 org.springframework.context.support。**ReloadableResourceBundleMessageSource**消息源；

    公共 org.springframework.context.support。**ReloadableResourceBundleMessageSource** getMessageSource() { return messageSource; }

    公共无效 setMessageSource（org.springframework.context.support.ReloadableResourceBundleMessageSource messageSource）{ **this.messageSource** = messageSource; }

*   在您的控制器代码中，您现在可以从包中获取任何已知的属性值。

    String propValue = getMessageSource().getMessage("hello", objArray, null);

**使用 JSTL**

由于属性文件 messageSource.properties 在类路径中，JSTL 将能够找到它并获取给定键的值。

*   添加 fmt taglib 的导入

    *   taglib uri="http://java.sun.com/jsp/jstl/fmt" 前缀="fmt"

    *   使用 JSP 中的 fmt:tag 从属性文件中获取值。

        抱歉伪语法，这个编辑器似乎没有呈现任何 XML。

        fmt:bundle basename="messageSource"

        fmt:消息键="你好"

    *   希望这对其他人有帮助

# c - 两个偏移量的 Visual-C++ 内联汇编程序差异

> ID：13420744
> 
> 赞同：1
> 
> 时间：2012-11-16T16:39:54.983
> 
> 标签：c, windows, x86, inline-assembly

我正在将代码块从 MASM 移植到 C 内联汇编程序（x86、Windows、MS VC） Foolowing 不是真正的代码，只是为了给出一个想法。假设我有一些数据定义为静态数组，甚至是两个标签之间的代码块，我需要获取它的大小。

```
 label1:
    bla bla bla
    label2:
    ....
    mov eax, (offset label2 - offset label1) 
```

这样的代码在 MASM 中像魅力一样工作，但在 CI 中得到以下错误消息：“错误 C2425：'-'：'第二个操作数'中的非常量表达式”我可以编译：

```
 mov eax, offset label1
    mov eax, offset label2 
```

我希望编译器在编译时评估 (offset label1 - offset label2)，但看起来我错了。我也不能添加偏移量（为什么？这些只是在编译过程中添加的两个整数......？）当然，我可以编译 mov eax, offset label2 mov edx, offset label1 sub eax, edx，但这是一个额外的代码只是为了计算一个常数。有人可以解释一下，我的代码有什么问题吗？

会不会是搬家造成的？如何推动它通过？

期待解答，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:04:44.440

是的，它可能是由重定位的威胁引起的，也可能是由处理相对跳转的可变长度指令的威胁引起的。很可能是因为一些小麻烦，汇编器编写者采取了简单的方法，并实现了 1 遍或 2 遍编译器，以便尽快做出最终决定。因此不支持一些方便的表达式。

正如评论中已经建议的那样，汇编程序可能仍然支持 mov + sub 组合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:56:07.150

真正的汇编程序在获得所有标签的固定地址之前，可能会多次运行代码。例如，根据您想跳多远，一些跳跃有短形式和长形式。如果标签之间有这样的跳跃，那么距离取决于跳跃的位置。

C 编译器可能会将其中的一些留给链接器/加载器，并且在编译时没有固定值。

您可以将地址计算代码简化为两条指令

```
mov EAX, offset Label2
sub EAX, offset Label1 
```

我认为这不会完全破坏代码的性能。

# algorithm - 四向导航算法

> ID：13420747
> 
> 赞同：13
> 
> 时间：2012-11-16T16:39:58.273
> 
> 标签：algorithm, keyboard, user-experience

考虑一个矩形画布，其中包含随机大小和位置的矩形。要在这些矩形之间导航，用户可以使用四个箭头：上、下、左、右。

您是否熟悉任何可以产生相当直接的用户体验的导航算法？

我遇到了一些解决方案，但似乎都不合适。我知道没有解决方案是“理想的”。但是，我正在寻找的算法是用于仅使用箭头键在桌面上的图标之间导航的算法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-16T00:49:08.930

**[编辑 21/5/2013：正如 Gene 在评论中指出的那样，我的加权方案实际上并不能保证每个矩形都可以从每个其他矩形到达 - 只是每个矩形都会在每个方向上连接到某个其他矩形.]**

一个很好的方法是使用[最大加权二分匹配](http://en.wikipedia.org/wiki/Matching_%28graph_theory%29#Maximum_matchings_in_bipartite_graphs)。

我们要做的是构建一个定义函数 f(r, d) 的表，如果用户当前位于矩形 r 并且点击方向 d（上、下、左或右），则返回用户将移动到的矩形。我们希望这个函数有一些不错的属性，例如：

1.  必须可以从每个其他矩形到达每个矩形
2.  按左然后右，反之亦然，或上，下，反之亦然，应该将用户留在同一个地方
3.  按下 eg left 应该将用户带到左侧的一个矩形（这有点难以准确说明，但我们可以使用评分系统来衡量质量）

对于每个矩形，在图中创建 4 个顶点：一个顶点对应于在该矩形上可以按下的每个可能的键。对于特定的矩形 r，称它们为 r [U]、 r [D]、 r [L]和 r [R]。对于每对矩形 r 和 s，创建 4 条边：

*   (r [U] , s [D] )
*   (r [D] , s [U] )
*   (r [L] , s [R] )
*   (r [R] , s [L] )

该图有 2 个连通分量：一个包含所有 U 和 D 顶点，另一个包含所有 L 和 R 顶点。每个组件都是二分的，因为例如没有 U 顶点连接到另一个 U 顶点。实际上，我们可以在每个组件上分别运行最大加权二分匹配，尽管在分组后讨论在整个图上运行一次更容易，例如，U 顶点与 L 顶点和 D 顶点与 R 顶点。

根据这对矩形通过那对键连接起来的意义，为这些边中的每一个分配一个非负权重。您可以自由选择此评分函数的形式，但它可能应该是：

*   与矩形之间的距离成反比（您可以使用它们中心之间的距离），并且
*   与矩形中心之间的角度与所需的水平或垂直线的差异成反比，并且
*   每当矩形以错误的方式定向时为零（例如，如果对于边缘 (r [U] , s [D] )，如果 r 的中心实际上在 s 的中心之上）。或者，您可以只删除这些零权重边。

此函数尝试满足顶部的要求 3。

**[EDIT #2 24/5/2013：在下面添加了一个示例函数。]**

这是满足这些属性的示例函数的 C-ish 伪代码。它取 2 个矩形的中心点和矩形 1 的方向（矩形 2 的方向始终与此方向相反）：

```
const double MAXDISTSQUARED = /* The maximum possible squared distance */;
const double Z = /* A +ve number. Z > 1 => distance more important than angle */

// Return a weight in the range [0, 1], with higher indicating a better fit.
double getWeight(enum direction d, int x1, int y1, int x2, int y2) {
    if (d == LEFT  && x1 < x2 ||
        d == RIGHT && x1 > x2 ||
        d == UP    && y1 < y2 ||
        d == DOWN  && y1 > y2) return 0;

    // Don't need to take sqrt(); in fact it's probably better not to
    double distSquared = (x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2);
    double angle = abs(atan2(x1 - x2, y1 - y2));   // 0 => horiz; PI/2 => vert
    if (d == UP || d == DOWN) angle = PI / 2 - angle;
    return 1 - pow(distSquared / MAXDISTSQUARED, Z) * (2 * angle / PI);
} 
```

现在运行最大加权二分匹配。这将尝试找到具有最高总权重的边集，使得每个顶点（或至少尽可能多的顶点）都与所选边相邻，但没有顶点与多于一条边相邻。（如果我们允许一个顶点与多个边相邻，这意味着在该矩形处按下该键会将您带到多个目标矩形，这是没有意义的。）此匹配中的每条边对应到一*对*双向按键，以便按下例如向上然后向下将返回到您所在的位置，自动满足顶部的要求2。

到目前为止，这种方法没有自动满足的唯一要求是重要的第 1 个要求：它不一定保证每个矩形都可以到达。如果我们只使用“原始”质量分数作为边缘权重，那么这实际上可能发生在某些配置中，例如，当屏幕的 4 个角各有一个矩形，再加上一个在中心的矩形时，中心的一个可能是遥不可及。

**[编辑 2013 年 5 月 21 日：正如 Gene 所说，我提出的新加权方案满足属性 1 的说法是错误的。在许多情况下，每个矩形都是可达的，但一般来说，您需要解决 NP-hard Hamiltonian Cycle 问题来保证这一点。我会留下解释，因为它让我们了解了一些情况。无论如何，只要检测到子周期，就可以通过向上调整连接组件之间的权重来破解它。]**

为了保证匹配算法总是返回每个矩形都可达的匹配，我们需要调整边权重，以使匹配永远不可能比具有更多边的匹配得分更高。这可以通过将评分函数缩放到 0 和 1 之间，并将*矩形的数量*n 添加到每条边的权重来实现。这是有效的，因为完整匹配的得分至少为 4n^2（即，即使质量得分为 0，边缘本身的权重为 n，并且有 4n 个），而任何具有较少边缘的匹配最多得分4(n-1)(n+1) = 4n^2 - 4，严格来说是更少。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-15T17:22:07.170

不言而喻，对于一个拿着锤子的人来说，一切看起来都像钉子。最短路径算法在这里是一个明显的工具，因为最短距离看起来很直观。

然而，我们正在设计一个 UI，其中逻辑距离比物理距离更重要。

因此，让我们尝试不同的想法。

一个限制是重复点击向上（右、下或左）箭头最终应该循环通过所有矩形。否则可能会出现一些无法访问的“孤儿”。使用基于物理 (2d) 距离的算法来实现这一点很困难，因为 2d 中最近的项目可能在对应于正在使用的箭头对的 1d 投影中处于错误的方向。即点击向上箭头可以轻松选择当前下方的框。哎哟。

所以让我们采用一个极其简单的解决方案。只需在其质心的 x 坐标上对所有矩形进行排序。按此顺序点击左右箭头在矩形中循环：从右到下一个最高的 x，从左到下一个最低的 x。包裹在屏幕边缘。

也对 y 坐标执行相同的操作。按此顺序使用向上和向下循环。

成功的关键（双关语）是在循环时向屏幕添加动态信息，以向用户展示正在发生的事情的逻辑。这是一个建议。其他是可能的。

在第一次垂直（向上或向下）键时，矩形上方会出现浅色半透明覆盖。它们以由质心的 y 坐标交替的模式着色为淡红色或蓝色。整个窗口还有匹配颜色的水平哈希标记。使用两种颜色的唯一原因是提供线条和矩形之间对应关系的视觉指示。当前选择的矩形是非半透明的，并且井号比其他所有的都亮。当您继续按向上或向下键时，突出显示的框会按照质心 y 顺序发生变化，如上所述。当半秒左右没有按下箭头键时，覆盖消失。

如果按下水平键，则会出现非常相似的叠加层，只有垂直哈希标记和 x 顺序。

作为用户，我真的很喜欢这个方案。但是YMMV。

实现这一点所需的算法和数据结构是显而易见的、微不足道的，并且可以很好地扩展。将努力使叠加层看起来不错。

NB 现在我已经完成了所有的绘图，我意识到在每个盒子的质心放置一个正确颜色的点来显示哪条线与其相交是一个好主意。下面是一些说明性图表。

**裸盒**

![裸箱](../Images/5668756ea8b2a9d177f65a8518c4befa.png)

**使用向上或向下箭头进行选择**

![使用向上或向下箭头进行选择](../Images/1dd5cb81455633e9d178dcb37123e7e8.png)

**使用左箭头或右箭头进行选择**

![用左箭头或右箭头选择](../Images/5f4d3f1a498063753bebc725c960c120.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-16T16:49:28.710

如下构建运动图怎么样：

*   对于任何方向，尝试在给定方向上找到最近的矩形，其中心点是当前矩形边的中间。
*   尝试消除循环，例如从 A 移动“右”应该尝试产生与从 A 移动“右上”不同的矩形。例如在[这个图](http://sketchia.com/draw.html#kQDeP1d)中，从绿色的“右”应该是橙色，即使粉红色是最近的中点
*   （感谢 biziclop）：如果在图中无法访问任何矩形，则重新映射相邻的矩形之一以到达它，可能是误差最小的一个。重复直到所有矩形都可以到达（我认为该算法将终止......）

然后存储图形并仅使用它来导航。您不想在会话中间更改方向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-15T00:59:09.900

这个问题可以建模为一个`graph`问题，并且`algorithm of navigation`可以作为一个`shortest path routing`.

**这里是建模。**

每个矩形都是图中的一个顶点。从每个顶点（又名矩形），您有四个选项 - 上、下、左、右。因此，您可以达到四个不同的矩形，即该顶点将有四个邻居，并且您将这些边添加到图形中。

我不确定这是否是问题的一部分——“可以​​使用特定操作（例如向上）从一个矩形到达多个矩形”。如果没有，上面的建模就足够了。如果是，则添加所有此类顶点作为该顶点的邻居。因此，您可能不会得到一个 4 正则图。否则，您会将问题建模为 4 正则图。

现在，问题是`how do you define your "navigation" algorithm`。如果您不想区分您的动作，即如果上、下、左和右都相等，那么您可以将权重 1 添加到所有边。

如果您决定赋予特定动作比其他动作更高的优先级，例如比其他动作`up`更好，那么您可以将向上运动产生的边缘的权重设置为 1，将剩余的边缘设置为 2。这个想法是通过分配不同的权重，您可以区分您将行驶的边缘。

如果您确定所有`up`边不相等，即 A 和 B 之间的向上距离小于 C 和 D 之间的向上距离，那么您可以在图形构建过程中相应地为边缘分配权重。

**这里是路由**

现在如何查找路线——您可以使用它`dijkstra's algorithm`来查找给定顶点对之间的最短路径。如果您对多条最短路径感兴趣，可以使用`k-shortest path`算法找到`k`一对节点之间的最短路径，然后选择您的最佳路径。

请注意，您最终得到的图不一定是有向图。如果您更喜欢有向图，您可以在构建边时为其指定方向。否则，您应该很好地使用无向图，因为您只关心使用一条边从另一个边到达顶点。此外，如果`A`使用`up`from rectangle 可以到达 rectangle `B`，那么`rectangle B`可以使用`down`from rectangle到达`A`。因此，如果您出于其他原因不需要它们，方向真的无关紧要。如果你不喜欢我刚才所做的假设，那么你需要构造一个有向图。

希望这可以帮助。

# java - Java EE 安全性 - 登录后未重定向到初始页面

> ID：13420748
> 
> 赞同：10
> 
> 时间：2012-11-16T16:39:58.040
> 
> 标签：java, security, jsf-2, login, jboss

我刚开始学习 Java EE。我的目标是为羽毛球运动员实现一个门户网站（使用 EJB 3 和 JSF），用户可以在其中发布和分析他们的结果。

为了简单起见（事实证明并非如此），我决定使用容器提供的安全系统（JBoss as7）。在出现一些问题后，我设法让身份验证/授权正常工作。但是，我有一个问题我无法解决。

当我尝试访问受保护的页面时，如预期的那样，我被安全系统拦截了。但是，在我登录后，我并没有重定向到我最初请求的页面。相反，我再次被要求登录。如果我手动输入原始地址，我可以毫无问题地访问该页面。

我在stackoverflow上阅读了很多线程，但无法解决我的问题。如果有人可以帮助我，我将不胜感激！

**身份验证.java：**

```
@ManagedBean
@SessionScoped
public class Authentication {

    private String username = "";
    private String password = "";

    private User user = new User();

    @EJB
    UserService service;

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public User getUser() {
        return user;
    }

    public void login() {
        FacesContext context = FacesContext.getCurrentInstance();
        HttpServletRequest request = (HttpServletRequest) context
            .getExternalContext().getRequest();

        try {
            Principal userPrincipal = request.getUserPrincipal();
            if (userPrincipal != null) {
                request.logout();
            }
            request.login(username, password);
            user = service.find(username, password);
        } catch (ServletException e) {
            context.addMessage(null, new FacesMessage("Unknown login"));
        }
    }

    public String logout() {
        FacesContext.getCurrentInstance().getExternalContext()
            .invalidateSession();
        return "login";
    }
} 
```

**登录.xhtml**

```
<h:body>
    <h:form>
        <h:outputLabel for="username" value="Username" />
        <h:inputText id="username" value="#{authentication.username}" required="true" />
        <h:message for="username" />
        <br />
        <h:outputLabel for="password" value="Password" />
        <h:inputSecret id="password" value="#{authentication.password}" required="true" />
        <h:message for="password" />
        <br />
        <h:commandButton value="Login" action="#{authentication.login()}" />
       <h:messages globalOnly="true" />
   </h:form>
</h:body> 
```

**主页.xhtml**

```
<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'
xmlns:f='http://java.sun.com/jsf/core'
xmlns:h='http://java.sun.com/jsf/html'
xmlns:ui='http://java.sun.com/jsf/facelets'
xmlns:p="http://primefaces.org/ui">
<h:head>
    <link type="text/css" rel="stylesheet"
        href="#{request.contextPath}/themes/cupertino/skin.css" />
</h:head>
<h:body>
    <h:form>
        <h:commandButton action="login" value="Log in" />
    </h:form>
</h:body> 
```

**web.xml**

```
....
<display-name>BadmintonPortal</display-name>
<welcome-file-list>
    <welcome-file>/pages/protected/user/user_home.xhtml</welcome-file>
</welcome-file-list>
<servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>/faces/*</url-pattern>
    <url-pattern>*.jsf</url-pattern>
    <url-pattern>*.xhtml</url-pattern>
</servlet-mapping>
<context-param>
    <param-name>primefaces.THEME</param-name>
    <param-value>cupertino</param-value>
</context-param>

<!-- Protected area definition -->
<security-constraint>
    <web-resource-collection>
        <web-resource-name>Restricted Area - ADMIN Only</web-resource-name>
        <url-pattern>/pages/protected/admin/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>admin</role-name>
    </auth-constraint>
</security-constraint>
<security-constraint>
    <web-resource-collection>
        <web-resource-name>Restricted Area - USER and ADMIN</web-resource-name>
        <url-pattern>/pages/protected/user/*</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>user</role-name>
        <role-name>admin</role-name>
    </auth-constraint>
</security-constraint>

<!-- Login page -->
<login-config>
    <auth-method>FORM</auth-method>
    <form-login-config>
        <form-login-page>/pages/public/login.xhtml</form-login-page>
        <form-error-page>/pages/public/loginError.xhtml</form-error-page>
    </form-login-config>
</login-config>

<!-- System roles -->
<security-role>
    <role-name>admin</role-name>
</security-role>
<security-role>
    <role-name>user</role-name>
</security-role> 
```

**编辑：**

忘记包含**faces-config.xml**文件

```
<?xml version="1.0" encoding="UTF-8"?>

<faces-config xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_1.xsd"
    version="2.1">

    <navigation-rule>
        <navigation-case>
            <from-outcome>login</from-outcome>
            <to-view-id>/pages/protected/user/user_home.xhtml</to-view-id>  
            <redirect/>
        </navigation-case>
    </navigation-rule>
</faces-config> 
```

**jboss-web.xml**

```
<?xml version='1.0' encoding='UTF-8'?>

<jboss-web>
    <context-root>BadmintonPortal</context-root>
    <security-domain>java:/jaas/BadmintonPortalRealm</security-domain>
</jboss-web> 
```

**编辑2：**

**工作解决方案**

```
@ManagedBean
@ViewScoped
public class Authentication {
    ...
    public Authentication() {
        ExternalContext eContext = FacesContext.getCurrentInstance()
            .getExternalContext();
        uri = (String) eContext.getRequestMap().get(
            RequestDispatcher.FORWARD_REQUEST_URI);
    }

    public void login() {
        FacesContext context = FacesContext.getCurrentInstance();
        HttpServletRequest request = (HttpServletRequest) context
            .getExternalContext().getRequest();

        try {
            Principal userPrincipal = request.getUserPrincipal();
            if (userPrincipal != null) {
                request.logout();
            }
            request.login(username, password);
            user = service.find(username, password);
            context.getExternalContext().getSessionMap().put("user", user);
            context.getExternalContext().redirect(uri);
        } catch (ServletException e) {
            context.addMessage(null, new FacesMessage("Unknown login"));
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public String logout() {
        FacesContext.getCurrentInstance().getExternalContext()
            .invalidateSession();
        return "login";
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-16T17:57:35.647

您通过使用 JSF 表单来接管登录部分，该表单在提交时在 JSF 托管 bean 中执行编程登录。如果您使用的是直接提交到[本答案](https://stackoverflow.com/questions/2206911/best-way-for-user-authentication-on-javaee-6-using-jsf-2-0/2207147#2207147)`j_security_check`第一部分中概述的容器管理身份验证 URL 的纯 HTML 表单，那么您确实会自动被重定向到初始页面。

但是，由于您自己使用 JSF 进行登录，那么您也应该自己使用 JSF 导航到初始页面。由于登录页面通常由服务器端 forward by 打开[`RequestDispatcher#forward()`](http://docs.oracle.com/javaee/6/api/javax/servlet/RequestDispatcher.html#forward%28javax.servlet.ServletRequest,%20javax.servlet.ServletResponse%29)，因此最初请求的页面可用作请求属性，其名称由[`RequestDispatcher.FORWARD_REQUEST_URI`](http://docs.oracle.com/javaee/6/api/javax/servlet/RequestDispatcher.html#FORWARD_REQUEST_URI)常量指定。因此，在 JSF 术语中，可用如下方式：

```
String originalURI = (String) externalContext.getRequestMap().get(RequestDispatcher.FORWARD_REQUEST_URI); 
```

*（请记住，在它返回的情况下有一个备用 URL `null`，即直接打开它而不先点击受限 URL 时）*

收集它的最佳位置是`@ViewScoped`与登录页面关联的 bean 的（后）构造函数。使用当前会话范围的 bean 方法，最好将其设置为视图范围，并在登录期间明确地将其`User`放入会话范围，如下所示：

```
externalContext.getSessionMap().put("user", user); 
```

这样，用户可以`#{user}`直接通过而不是`#{authentication.user}`.

# oracle - 事务范围内的多次发布失败

> ID：13420754
> 
> 赞同：1
> 
> 时间：2012-11-16T16:40:09.023
> 
> 标签：oracle, nservicebus, transactionscope, distributed-transactions

我为不同子系统之间的集成架构建模。来自子系统的所有通知都使用原语发送到订阅的子系统`Publish`。这些通知在方法`for`内循环发送`Handler`，所以它们都在同一个`TransactionScope`. 我做了一个简单的例子来解释这一点：客户端向服务器发送一条消息，该服务器使用原语发送可变数量的消息`Publish`。这是服务器处理程序：

```
public void Handle(MyMessage message)
    {

        for (int i = 0; i < message.numberOfNotifications; i++)
        {
            Bus.Publish<NotificationMessage>(m =>
            {
                m.myPersonalCount= i;
            }
            );
        }
    } 
```

我正在寻找但我无法弄清楚的是，当我设置`i`为 30 或更少时，一切正常。从 31 或更多我收到此错误消息：

```
could not execute query
[ SELECT this_.SubscriberEndpoint as y0_ FROM "Subscription" this_ WHERE this_.MessageType in (?) ] 
```

并查看我得到的内部异常`Unable to enlist in a distributed transaction`。

我使用原语尝试了相同的操作，`Send`但一切都是（尝试使用 10k 条消息），所以这是一个仅与`Publish`指令相关的问题。

我将 Oracle 10g 用于 dbms，将 Oracle 11g 用于客户端。

如果端点不是事务性的，我没有任何问题，所以问题似乎只与 TransactionScope 有关。

任何帮助表示赞赏，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:50:33.073

无论如何，我都不是 Oracle 专家。我可能连新手的资格都达不到。

但是，我知道 NServiceBus 会为每个发布查询订阅存储，以防发布之间的订阅发生更改。

Oracle 客户端是否可能对可以在分布式事务中登记的查询数量有某种限制？也许是为了防止 N+1 类型的性能问题？

也就是说，您想要发布 30 多个相同类型的事件似乎很奇怪。我想知道您的业务用例是什么。事件通常应该宣布发生了不可撤销的事情。为什么会发生30件事？

如果业务案例是可靠的，那么实现自己的订阅存储引擎可能是个好主意，该引擎使用一些有限的缓存（甚至 5 秒），这样您就不会在每次发布时都返回查询数据库。

# java - Spring AOP xml配置不起作用

> ID：13420755
> 
> 赞同：0
> 
> 时间：2012-11-16T16:40:15.433
> 
> 标签：java, xml, spring, namespaces, aop

我尝试编写一个简单的 AOP 程序，并像下面这样配置 xml 文件。但是当我运行程序时，结果似乎没有调用建议，而只执行了非建议部分。

这是方法类：

```
public class MessageWriterStdOut {
    public void writeMessage() {
        System.out.print("World");
    }
} 
```

这是豆类：

```
public class MyBeanOfHelloWorld {
  private MessageWriterStdOut messageWriterStdOut;
    public void execute() {
        messageWriterStdOut.writeMessage();
    }
    public void setMessageWriterStdOut(MessageWriterStdOut messageWriterStdOut) {
        this.messageWriterStdOut = messageWriterStdOut;
    }
} 
```

建议类是这样的：

```
public class MessageDecorator implements MethodInterceptor {
    @Override
    public Object invoke(MethodInvocation invocation) throws Throwable {
        System.out.print("Hello ");
        Object retVal = invocation.proceed();
        System.out.println("!");
        return retVal;
    }
} 
```

主要方法是：

```
public class HelloWorldAopExample {
    public static void main(String[] args) {
        GenericXmlApplicationContext ctx = new GenericXmlApplicationContext();
        ctx.load("/META-INF/spring/context-aop.xml");
        ctx.refresh();
        MyBeanOfHelloWorld myBeanOfHelloWorld = (MyBeanOfHelloWorld) ctx.getBean("myBeanOfHelloWorld");
        myBeanOfHelloWorld.execute();
    }
} 
```

xml配置是：

```
<aop:config>
        <aop:pointcut id="helloExecution"
            expression="execution(* com..playground..writeMessage*()) and args(invocation)" />
        <aop:aspect ref="advice">
            <aop:around pointcut-ref="helloExecution" method="invoke" />
        </aop:aspect>
    </aop:config>
    <bean id="advice" class="com..playground.aophelloworld.MessageDecorator" />
    <bean id="messageWriterStdOut"
        class="com..playground.aophelloworld.MessageWriterStdOut" />
    <bean id="myBeanOfHelloWorld" class="com..playground.aophelloworld.MyBeanOfHelloWorld">
        <property name="messageWriterStdOut" ref="messageWriterStdOut" />
    </bean> 
```

但结果仍然只有“世界”，而预期的结果是“你好世界！”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:49:40.047

在 xml 配置中，为什么您的某些包路径有两个点？例如：

```
<aop:pointcut id="helloExecution"
        expression="execution(* com..playground..writeMessage*()) and args(invocation)" /> 
```

应该：

```
<aop:pointcut id="helloExecution"
        expression="execution(* com.playground.writeMessage*()) and args(invocation)" /> 
```

和其他一些地方：

```
<bean id="advice" class="com.playground.aophelloworld.MessageDecorator" />
<bean id="myBeanOfHelloWorld" class="com.playground.aophelloworld.MyBeanOfHelloWorld">
    <property name="messageWriterStdOut" ref="messageWriterStdOut" /> 
```

更新：你可以试试这个：

```
<aop:pointcut id="helloExecution"
        expression="execution(* com..playground.MessageWriterStdOut.writeMessage(..))" /> 
```

# game-center - Game Center 回合制自动匹配不起作用

> ID：13420757
> 
> 赞同：3
> 
> 时间：2012-11-16T16:40:18.967
> 
> 标签：game-center, gamekit

我正在使用标准配对用户界面和两台 iPad iOS6。问题是当我在第一个设备中创建新匹配时，第二个设备应该在我查看匹配用户界面时看到现有匹配，但事实并非如此。我确定我的代码是正确的。这是方法：

```
-(void)findMatchWithMinPlayers:(int)minPlayers maxPlayers:(int)maxPlayers viewController:(UIViewController*)viewController {

    // the view that will present Matchmaker View Controller
    self.viewCaller = viewController;

    GKMatchRequest *request = [[GKMatchRequest alloc] init];
    request.minPlayers = minPlayers;
    request.maxPlayers = maxPlayers;

    GKTurnBasedMatchmakerViewController *viewMatchmaker = [[GKTurnBasedMatchmakerViewController alloc] initWithMatchRequest:request];
    viewMatchmaker.turnBasedMatchmakerDelegate = self;
    viewMatchmaker.showExistingMatches = YES;
    [self.viewCaller presentViewController:viewMatchmaker animated:YES completion:nil];
} 
```

我什至尝试了两个不同的示例游戏但同样的问题，那么我该如何解决呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-10T16:56:30.633

当 Gamekit 为回合制比赛做媒人时，它试图找到一个有空位的比赛来填补玩家。如果它找不到一个空位来填补玩家，则创建一个新的比赛。

尝试在一台设备上创建匹配并使用该设备转一圈，即当您调用...

```
 endTurnWithNextParticipants:turnTimeout:matchData:completionHandler: 
```

然后在另一台设备上尝试寻找匹配项。

# php - 如何修复 file_get_contents() 警告：无法打开流？

> ID：13420761
> 
> 赞同：1
> 
> 时间：2012-11-16T16:40:35.437
> 
> 标签：php, apache, fopen

我不知道为什么，但是当我想用 file_get_contents 获取 PHP 数据时，我总是遇到这个错误。

我检查了我的 PHP.ini 和 allow_url_fopen 是：ON 所以这不可能是问题。

这是我正在使用的代码：

```
$id='54352';
$url='http://www.google.com';
$data = file_get_contents('http://www.####.###/###.php?id='.$id.'&url='.urlencode($url));

var_dump($data); 
```

我不知道这里发生了什么，我只收到此错误消息和值：bool(false)。

我也尝试过 cURL，但它没有返回任何值给我。

谁能帮帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:49:34.480

尝试类似：

```
 $data = file_get_contents('http://www.####.###/###.php?id='.$id.'&url='.urlencode($url),true); 
```

# linux - 需要使用不同 linux 服务器的“sendmail”发送邮件（bash 或 php 脚本）

> ID：13420768
> 
> 赞同：1
> 
> 时间：2012-11-16T16:41:00.740
> 
> 标签：linux, sendmail

有什么方法可以指定我们要连接的 IP 地址以发送该邮件。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:27:23.793

使用 PHP 的 PEAR 库类[Mail](http://pear.php.net/package/Mail)。这真的很简单。

示例：（它使用带有 SMTP AUTH 的远程 SMTP 服务器，您不需要使用它）

```
<?php
 require_once "Mail.php";

 // mail data
 $from = "You <sender@example.com>";
 $to = "Her <recipient@example.com>";
 $subject = "Hi!";
 $body = "Hi,\n\nHow are you?";

 // SMTP server info
 $host = "mail.example.com";
 $username = "smtp_username";
 $password = "smtp_password";

 // create mail headers
 $headers = array(
   'From' => $from,
   'To' => $to,
   'Subject' => $subject);

 // create PEAR Mail object passing SMTP server info
 $smtp = Mail::factory('smtp',
   array (
     'host' => $host,
     'auth' => true,
     'username' => $username,
     'password' => $password));

 // send the email
 $mail = $smtp->send($to, $headers, $body);

 // check the result
 if (PEAR::isError($mail)) {
   echo("<p>" . $mail->getMessage() . "</p>");
 } else {
   echo("<p>Message successfully sent!</p>");
 }
?> 
```

# jquery - JQuery Dialog 正在加载整个页面作为内容？

> ID：13420771
> 
> 赞同：0
> 
> 时间：2012-11-16T16:41:03.643
> 
> 标签：jquery, asp.net, html, ajax, dialog

我想要一个非常基本的 JQuery 对话框，但我不能让它工作。

我使用了网站上的示例，就像我以前一样（并且它有效），但是对于这个特定的项目，对话框的行为很奇怪。这可能是我犯的一个愚蠢的错误，但我找不到它，所以我希望你们能帮帮我。

当我打电话时：

```
$('#TextOnlyDialog').dialog(); 
```

我得到了对话框，但我也得到了里面的整个原始 html 页面（当它应该在它后面时），它后面的所有东西都消失了。

这就是我正在做的事情（不是整个代码，而是基本结构）：

```
<link type="text/css" href="Extras/css/smoothness/jquery-ui-1.8.23.custom.css" rel="stylesheet" />
<script type="text/javascript" src="Extras/js/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="Extras/js/jquery-ui-1.8.23.custom.min.js"></script>
<script type="text/javascript">
    function Initialize() {
        $('#TextOnlyDialog').dialog();
    }
</script>
<body onload="Initialize();">
 <form id="MainForm" runat="server">
<asp:ScriptManager ID="PageScriptManager" runat="server" />
<asp:UpdatePanel ID="PageUpdatePanel" runat="server">
    <ContentTemplate>
        <div id="TextOnlyDialog" title="Dialog Title">
    </ContentTemplate>
</asp:UpdatePanel>
</form>
</body> 
```

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:42:41.853

首先，你没有关闭`</div>`你的对话

应该：

```
<div id="TextOnlyDialog" title="Dialog Title"></div> 
```

其次，您是否尝试过将其从 html 中取出`<asp:UpdatePanel`并放在 html 的底部，在`</form>`. 这是一个对话，不需要与其他任何东西联系在一起。

最后。您通常使用初始化对话框，`$('#TextOnlyDialog').dialog();` 但要正常打开它`$('#TextOnlyDialog').dialog('open');`并`$('#TextOnlyDialog').dialog('close');`关闭它。

我可能在最后一点上错了，尽管我自己就是这样使用它的。

# ruby-on-rails - 将 ActiveRecord habtm 查询转换为 Arel

> ID：13420773
> 
> 赞同：6
> 
> 时间：2012-11-16T16:41:14.447
> 
> 标签：ruby-on-rails, activerecord, arel

我有一个很常见的`habtm`关系：

```
Photo has_and_belongs_to_many :tags
Tag has_and_belongs_to_many :photos 
```

在我的照片模型中，我有一个“带有标签”的方法，我用它来查找一张用给定的 tag_ids 集标记的照片。此查询只需要匹配具有所有给定标签的照片，但不考虑是否存在任何其他标签。这是我的方法：

```
def self.with_terms( array )
  select('distinct photos.*').joins(:tags).where('tags.id' => array).group("photos." + self.column_names.join(', photos.')).having("count(*) = #{array.size}")
end 
```

这按预期工作。

现在，为了更好地将它与我正在使用的其他一些库集成，我需要在 Arel 中重新编写它。（让它成为一个 Arel 节点？，不确定你通常称之为什么）。

我一直在尝试这个，但老实说我以前从未尝试过使用 Arel，所以我有点迷茫。我一直在控制台中进行试验并尝试过：

```
t = Photo.arel_table
q = t.join(:tags).on(t[:tags_id].in(array))
Photo.where(q) 
```

但是，（1）我认为首先不是`q`正确的查询，并且（2）它创建一个`Arel::SelectManager`，当传递给 where 调用 raises 时`Cannot visit Arel::SelectManager`。所以，显然我做错了。

*更新：在这里更具体一点，我希望返回一个 Arel 节点，因为我正在使用一个 gem（ransack），它希望您将 Arel 节点传递给它以用于搜索方法。Ransack 将把这个 Arel 节点与其他节点链接起来以生成复杂的搜索查询。*

Arel 大师能告诉我如何正确地做到这一点吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-18T23:51:04.707

很难找到好的 Arel 文档，但是@Philip [C](https://stackoverflow.com/users/456636/philip-c)整理了一些有用的[幻灯片](http://www.slideshare.net/flah00/activerecord-arel)，在他对这个[问题](https://stackoverflow.com/questions/5688386/where-can-i-find-good-arel-documentation)的回答中引用了这些幻灯片。

以下应该是您正在寻找的内容：

```
photos = Arel::Table.new(:photos)
tags = Arel::Table.new(:tags)
photo_tags = Arel::Table.new(:photo_tags)

q = photos[:id].in(
   photos.project(photos[:id])
  .join(photo_tags).on(photos[:id].eql(photo_tags[:photo_id]))
  .join(tags).on(photo_tags[:tag_id].eql(tags[:id]))
  .where(tags[:id].in(array))
  .group(photos.columns)
  .having(tags[:id].count.eq(array.length))
) 
```

这会产生一个`Arel::Nodes::In`您应该能够直接使用的实例，如`Photo.where(q)`.

* * *

更新：

在查看文档和一些 ransack 的源之后，似乎没有任何自然的方法来定义涉及子查询的自定义谓词，这在您的情况下是必要的（因为谓词必须适合`where`子句）。解决此问题的一种方法可能是利用`:formatter`谓词使用的优势，如下所示：

```
Ransack.configure do |config|
  config.add_predicate 'with_tag_ids',
                   :arel_predicate => 'in',
                   :formatter => proc {|tag_ids| tags_subquery(tag_ids) },
                   :validator => proc {|v| v.present?},
                   :compounds => true
end 
```

您可以定义`tags_subquery(tag_ids)`为生成上述 arel 节点的方法，但在返回之前替换`array`为`tag_ids`并调用`.to_sql`它（格式化程序需要返回字符串，而不是节点）。

我还没有尝试过，所以如果它有效，我会很高兴！

# javascript - 按钮未在 Bootstrap 弹出框内触发

> ID：13420774
> 
> 赞同：0
> 
> 时间：2012-11-16T16:41:19.117
> 
> 标签：javascript, twitter-bootstrap

我正在单击一个按钮来触发一个事件，但它不起作用..不确定是什么原因造成的..

```
<div class="popOverProgressInsideRightDiv">
        <button id="popOverPause" class="btn btn-mini btn-gray btn-right">Pause</button>
    </div>

render : function() {
var compiledTemplate = Handlebars.compile(aTemplate);

$('#popOverPause').on('click', this.handlePausePress);

this.delegateEvents();

},
handlePausePress : function(event) {
alert("here");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T06:24:06.173

您没有提供足够的信息，但看起来您在页面加载期间`button`不可用`DOM`并且在某个点动态插入，在这种情况下，您需要一个委托的事件处理程序，例如

```
$(document).on('click', '.popOverProgressInsideRightDiv #popOverPause', this.handlePausePress); 
```

这只是一个猜测，所以不确定它是否会起作用，可能您需要发布更多代码并进行广泛描述。

看看[jQuery on](http://api.jquery.com/on/)`Direct and delegated events`中的部分。

# jquery - jquery - 如何在悬停时不更改动态表标题行的背景颜色

> ID：13420775
> 
> 赞同：1
> 
> 时间：2012-11-16T16:41:18.490
> 
> 标签：jquery, css

jquery - 如何在悬停时**不更改动态表****标题**行的背景颜色我有一个使用 jquery 构建的动态表，并且正在使用 .on

请参阅显示标题行 bg 颜色在悬停时确实发生变化的[小提琴示例。](http://jsfiddle.net/remy/sCGRL/)

[http://jsfiddle.net/remy/sCGRL/](http://jsfiddle.net/remy/sCGRL/)

```
$(document).on({
    mouseenter: function () {
        $(this).css("background-color", "lightgoldenrodyellow");
    },
    mouseleave: function () {
        $(this).css("background-color", "");
    }
}, "#PersonOrgTBL tr"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:43:19.107

```
}, "#PersonOrgTBL tr:not(:eq(0))"); 
```

你也可以这样写：

```
$(document).on('mouseenter mouseleave','#PersonOrgTBL tr:not(:eq(0))', function( e ){
    var color = e.type=='mouseenter' ? "lightgoldenrodyellow" : "";
    $(this).css({backgroundColor: color});
}); 
```

**[小提琴演示](http://jsfiddle.net/sCGRL/10/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:53:30.193

这是一个条件看这里一个实际的例子

```
if(!$(this).is(":first-child")) {
    $(this).css("background-color", "lightgoldenrodyellow");
} 
```

[http://jsfiddle.net/sCGRL/12/](http://jsfiddle.net/sCGRL/12/)

# javascript - 编辑 HTML 字符串中的属性值

> ID：13420776
> 
> 赞同：0
> 
> 时间：2012-11-16T16:41:33.260
> 
> 标签：javascript, jquery

所以，我有一个字符串。该字符串包含 html。我正在检查字符串中的“名称”，如果没有，我正在使用其中的一个，如果它确实需要更改它是什么。

```
var myString = '<input id="accountUser_c967817c993e62b1de50e4f0401a03ae" type="hidden" value="c967817c993e62b1de50e4f0401a03ae" name="addRow[]"><div class="colors goldbluegreenorange"></div>';
if (myString.indexOf('name') == -1) {
    myString = myString.substr(0,myString.indexOf('>')) + ' name="addRow[]"' + myString.substr(myString.indexOf('>'));
} else {
    //get what's inside name's quotes and change it to removeRow[]. 
} 
```

如果这比直接的 javascript 更有意义的话，我也有 jquery 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:49:38.693

既然您使用的是 jQuery，为什么不从该字符串中创建一个 jQuery 元素，以便我们可以使用 jQuery 的漂亮 API 呢？它比原始字符串操作更不容易出错。

这是一些示例代码：

```
var $element = $('<input id="accountUser_c967817c993e62b1de50e4f0401a03ae" type="hidden" value="c967817c993e62b1de50e4f0401a03ae" name="addRow[]"><div class="colors goldbluegreenorange"></div>');

$element.filter('input').prop('name', function(i, v) {
    return v ? 'removeRow[]' : 'addRow[]';
}); 
```

**注意：**该`v`函数中的 是`name`属性的当前值，jQuery 会自动将其传递给回调函数。返回值是属性的值应更新为的值。

* * *

**更新**：如果您想将其全部转换回字符串，请使用：

```
var theHTMLstring = $element.wrapAll('<div>').parent().html(); 
```

这是小提琴：http: [//jsfiddle.net/kBF3c/](http://jsfiddle.net/kBF3c/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:49:24.337

为什么不直接使用 jQuery 的内置功能。

演示**[在这里](http://jsfiddle.net/bruno/zfmCP/)**

```
// specify string representing input element
var str = '<input id="accountUser_c967817c993e62b1de50e4f0401a03ae" type="hidden" value="c967817c993e62b1de50e4f0401a03ae" name="addRow[]"><div class="colors goldbluegreenorange"></div>';

var els = $(str);
// create element
var el = $(els).filter("input");

if( $(el).prop("name") ) {
    $(el).prop( "name", "removeRow[]" );
} else {
    $(el).prop("name", "anynameyouwant");​​​​​​​​​​​​​​
} 
```

我猜您需要将上述元素添加到 DOM 中，您可以这样做

```
$("#parentId").append( els ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:49:45.887

尝试将字符串转换为 jQuery 对象并从中读取参数：

```
var myString = '<input id="accountUser_c967817c993e62b1de50e4f0401a03ae" type="hidden" value="c967817c993e62b1de50e4f0401a03ae" name="addRow[]"><div class="colors goldbluegreenorange"></div>';
var $input = $(myString).filter('input');
$input.attr('name') = ($input.attr('name') == "") ? 'addRow[]' : 'removeRow[]'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T16:52:31.923

既然您无论如何都在使用 jQuery，为什么不只*解析*字符串并将标签视为 HTML 呢？

```
var html = $.parseXML(string);
$.each(html.find('*'),function()
{
    if ($(this).attr('name'))
    {
        $(this).attr('name', 'addRow[]');
    }
    else
    {
        $(this).attr('name','removeRow[]');
    }
}); 
```

从那里拿东西？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T17:11:37.760

你可以试试这个

```
var str = '<input id="accountUser_c967817c993e62b1de50e4f0401a03ae" type="hidden" value="c967817c993e62b1de50e4f0401a03ae" name="addRow[]"><div class="colors goldbluegreenorange"></div>';
$(str).prop('name', (!$(str).prop('name') ? "addRow[]" : "removeRow[]"));
str=$('<div/>').html(obj).html(); // str contains new value 
```

[**演示**](http://jsfiddle.net/J7x7J/1/)。

# sql - Oracle SQL 查找热门查询

> ID：13420780
> 
> 赞同：1
> 
> 时间：2012-11-16T16:41:58.907
> 
> 标签：sql, oracle

我在 SQL 中有一个名为 Questionnaire 的表，其中有名为 ID、Newspaper 和 CreditCards 的列。我需要输出至少拥有 3 张信用卡的 ID 中最受欢迎的报纸。

例子：

```
身份证信用卡报纸
--------------------------------------
10354 3 独立
12154 4 独立
11354 2时代
14587 3 每日邮报
19874 5 星期日新闻
16847 1 独立报

```

你能帮忙用一个sql命令来输出上述查询吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:35:17.947

```
select *
from (
    select newspaper, 
           rank() over (order by count(*) desc) as rnk
    from Questionnaire
    where credit_cards >= 3
    group by newspaper
) t
where rnk = 1 
```

如果两张报纸具有相同的“人气”，则两者都将被退回。

SQLFiddle 演示：[http ://sqlfiddle.com/#!4/16dcb/1](http://sqlfiddle.com/#!4/16dcb/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:10:10.470

如果您只想获取最受欢迎的报纸[s]，那么这可以解决查询。

```
select 
    newspaper
    , count(1) as fct 
from 
  Questionnaire 
where 
  CreditCards >= 3
group by newspaper 
having fct = 
            (
              select 
                max(ct) 
              from 
                ( 
                    select 
                        newspaper 
                        ,count(1) as ct 
                    from 
                        Questionnaire 
                    where 
                        CreditCards >= 3 
                    group by newspaper
                )
             )
/ 
```

# html - 样式化标签，不包括具有特定样式的标签

> ID：13420782
> 
> 赞同：1
> 
> 时间：2012-11-16T16:42:15.197
> 
> 标签：html, css, ms-word

我正在尝试在排除某些标签的同时设置一些 html 的样式。例如，下面我有一个 html，它为 2 段不同字体的文本设置样式：

```
<span style="font-family: Tahoma, Arial, sans-serif">Test 1</span>
<span style="font-family: Verdana, Arial, Helvetica, sans-serif">Test 2</span>
<span style="font-family: Arial, Helvetica, sans-serif">Test 3</span> 
```

我想将不是 Arial 字体的跨度样式覆盖为 Times New Roman，并且我尝试了以下 css：

```
span {
   font-family: "Times New Roman" !important;
   font-weight: normal !important;
   font-size: 12pt !important;
   font-size-adjust: none !important;
   font-stretch: normal !important;
   font-variant: normal !important;
   font-style: normal !important;
   background-color: white !important;
} 
```

以上也改变了 Arial 文本的样式，我想排除正在设置样式的 Arial 文本。

注意css是用来对多个源html进行样式化的，而源html的样式中可以有更多的标签，定义了文本的大小、粗细等，所以样式标签的内容是不可预测的。

如何告诉 css 排除样式为 Arial 字体的标签。

我还在 Microsoft Word 中打开 html 以打印 html，因此这也需要使用 Word 工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:53:16.983

一般来说，没有简单的方法可以做到这一点，但如果 HTML 标记的使用非常一致，您可以使用以下规则设置样式表

```
*[style="font-family: Tahoma, Arial, sans-serif"],
*[style="font-family: Verdana, Arial, Helvetica, sans-serif"] {
   font-family: Times New Roman;
} 
```

但是您写道“样式标签的内容是不可预测的”（显然是指`style` *属性*）。如果真的是这样，答案是“不”。</p>

我想知道这背后的想法是什么。如果使用 Tahoma 或 Verdana 有任何意义，为什么 Times New Roman 会成为他们的合适替代品，而不是 Arial？在缺少名为 Tahoma 的字体的系统中会发生什么？他们应该买 Arial 还是 Times New Roman？

# apache - 同一个域，两台服务器...一台linux，一台windows

> ID：13420783
> 
> 赞同：0
> 
> 时间：2012-11-16T16:42:18.943
> 
> 标签：apache, iis, subdomain

我希望我的网站大部分都在 linux 服务器上，但我希望我的网站的一小部分能够托管 silverlight 应用程序。

是否可以有两台服务器，一台linux，另一台windows在同一个域下？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:44:10.163

您可能也想考虑在 Linux 上托管您的 Silverlight - 您可以这样做。

[使用 Apache 服务器运行 Silverlight（在 linux 下）](https://stackoverflow.com/questions/729294/run-silverlight-with-apache-server-under-linux)

# sql - 查找匹配项在 postgresql 中的总时间

> ID：13420785
> 
> 赞同：2
> 
> 时间：2012-11-16T16:42:20.880
> 
> 标签：sql, postgresql, aggregate-functions, window-functions

我有一个数据库，其中有一个名为 matchstats 的表，其中包含一个名为 time 的列，每次发生操作时都会更新它。我还有一个名为 groundstatsid 的列，当它不为空时，表示动作发生在地面上，而不是站立。最后，我有一个名为 Round 的专栏。

例子：

```
Time | groundstatsid | Round

 1   | NULL          |  1
 8   | NULL          |  1
 15  | NULL          |  1
 18  | 1             |  1
 20  | 1             |  1
 22  | NULL          |  1
 30  | NULL          |  1
 1   | NULL          |  2 
```

为了获得全职站立，我基本上希望查询第一次 (1) 并存储它，然后查看 groundstatsid 直到它看到一个 NON NULL 值并在该位置花费时间，减去存储到的较早数字获得站立时间 (17)。然后它会继续寻找 groundstatsid IS NULL 的位置。一旦找到该值，它应该执行相同的查找过程，直到在 groundstatsid 或新一轮中找到 NON NULL 值，在这种情况下，它将重新开始整个过程​​。

一旦它完成了整场比赛，我希望它对结果求和。

我希望该示例的查询返回 25。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T17:11:21.903

我会把这个问题归结为一个你考虑成对的行，`time`在每一轮中排序。PostgreSQL 可以一次性做到这一点——没有 JOIN，没有 PL/pgSQL——使用[窗口函数](http://www.postgresql.org/docs/current/static/tutorial-window.html)：

```
SELECT
  round,
  first_value(time) OVER pair AS first_time,
  last_value(time) OVER pair AS last_time,
  first_value(groundstatsid IS NULL) OVER pair AS first_is_standing,
  last_value(groundstatsid IS NULL) OVER pair AS last_is_standing
FROM matchstats
WINDOW pair AS (PARTITION BY round ORDER BY time ROWS 1 PRECEDING); 
```

这告诉 PostgreSQL 从表中读取行（可能受约束`WHERE fightid=?`或其他东西），但要`round`分别考虑每个行以进行窗口操作。Window 的功能类似于`first_value`并且`last_value`可以访问我指定为的“窗口”，这`ORDER BY time ROWS 1 PRECEDING`意味着该窗口既包含当前行，也包含时间上紧接在其前面的行（如果有的话）。因此，窗口函数让我们可以直接输出当前行及其前行的值。

对于您提供的数据，此查询产生：

```
 round | first_time | last_time | first_is_standing | last_is_standing 
-------+------------+-----------+-------------------+------------------
     1 |          1 |         1 | t                 | t
     1 |          1 |         8 | t                 | t
     1 |          8 |        15 | t                 | t
     1 |         15 |        18 | t                 | f
     1 |         18 |        20 | f                 | f
     1 |         20 |        22 | f                 | t
     1 |         22 |        30 | t                 | t
     2 |          1 |         1 | t                 | t 
```

查看这些结果帮助我决定下一步该做什么。根据我对您的逻辑的理解，我得出的结论是，该人应被视为从时间 1..1、1..8、8..15、15..18 开始，而不是从 18..20 开始，不站立从 20..22 开始，并从 22..30 再次站立。换句话说，我们想要总结两者之间的差异`first_time`和`last_time`哪里`first_is_standing`是真的。将其转回 SQL：

```
SELECT round, SUM(last_time - first_time) AS total_time_standing
FROM (
  SELECT
    round,
    first_value(time) OVER pair AS first_time,
    last_value(time) OVER pair AS last_time,
    first_value(groundstatsid IS NULL) OVER pair AS first_is_standing,
    last_value(groundstatsid IS NULL) OVER pair AS last_is_standing
  FROM matchstats
  WINDOW pair AS (PARTITION BY round ORDER BY time ROWS 1 PRECEDING)
) pairs
WHERE first_is_standing
GROUP BY round;
 round | total_time_standing 
-------+---------------------
     1 |                  25
     2 |                   0 
```

您还可以从同一个内部查询中获取其他值，例如总时间或通过使用`SUM(CASE WHEN ...)`计数独立条件的跌倒次数：

```
SELECT
  round,
  SUM(CASE WHEN first_is_standing THEN last_time - first_time ELSE 0 END) AS total_time_standing,
  SUM(CASE WHEN first_is_standing AND NOT last_is_standing THEN 1 ELSE 0 END) AS falls,
  SUM(last_time - first_time) AS total_time
FROM (
  SELECT
    round,
    first_value(time) OVER pair AS first_time,
    last_value(time) OVER pair AS last_time,
    first_value(groundstatsid IS NULL) OVER pair AS first_is_standing,
    last_value(groundstatsid IS NULL) OVER pair AS last_is_standing
  FROM matchstats
  WINDOW pair AS (PARTITION BY round ORDER BY time ROWS 1 PRECEDING)
) pairs
GROUP BY round;

 round | total_time_standing | falls | total_time 
-------+---------------------+-------+------------
     1 |                  25 |     1 |         29
     2 |                   0 |     0 |          0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T17:55:50.190

这将计算任意轮数的站立时间：

```
SELECT round, sum(down_time - up_time) AS standing_time
FROM  (
   SELECT round, grp, standing, min(time) AS up_time
         ,CASE WHEN standing THEN 
             lead(min(time), 1, max(time)) OVER (PARTITION BY round
                                                 ORDER BY min(time))
          ELSE NULL END AS down_time
   FROM  (
      SELECT round, time, groundstatsid IS NULL AS standing
            ,count(groundstatsid) OVER (PARTITION BY round
                                        ORDER BY time) AS grp
      FROM tbl
      ) x
   GROUP BY 1, 2, standing
   ) y
WHERE  standing
GROUP  BY round
ORDER  BY round; 
```

[**-> sqlfiddle**](http://sqlfiddle.com/#!12/250c9/1)

### 解释

*   子查询 x：

    `count()`利用不计算值的事实`NULL`（既不作为聚合也不作为窗口函数）。具有“站立”动作 ( `groundstatsid IS NULL`) 的连续行以相同的值结束`grp`。

    简化`groundstatsid`为 boolean var `standing`，以便于使用和优雅。

*   子查询 y：

    每组汇总 - 站立时间很重要。从地面开始，我们只需要每个站立阶段后的第一排。

    以每组的最短时间为`up_time`（站立）

    取下`time`一行 ( ) 中的 ( `lead(min(time) ...`) 作为`down_time`(在地面上)。请注意，您可以在窗口函数中使用聚合值：

    `lead(min(time), 1, max(time)) OVER ...`如果回合结束（没有下一行），则`min(time)`默认为当前行的下一个回合。`max(time)`

*   最终选择：

    只考虑站立时间：`WHERE groundstatsid IS NULL`

    `sum(down_time - up_time)`汇总每轮的总站立时间。

    每轮结果排序。瞧。

这使得大量使用[窗口函数](http://www.postgresql.org/docs/current/interactive/functions-window.html)。需要 PostgreSQL 8.4 或更高版本。
如果性能是您的首要要求，您可以在 plpgsql 函数中执行相同的程序。[此处](https://stackoverflow.com/a/13079901/939860)或[此处](https://stackoverflow.com/a/12502786/939860)
的 示例。

# java - libgdx 如何在触摸时缩放和旋转 3d 模型

> ID：13420787
> 
> 赞同：5
> 
> 时间：2012-11-16T16:42:25.717
> 
> 标签：java, libgdx

我正在尝试创建一个简单的应用程序，它允许您从 .obj 加载 3d 模型并通过触摸屏幕来缩放/旋转它。

我设法编写了从文件加载 3d 模型并检测手势的代码，但现在我不确定如何通过触摸屏幕来启用缩放/旋转功能。

这是我现在的代码：

```
public class RenderObjApp implements ApplicationListener, GestureDetector.GestureListener {
    public static int SCREEN_WIDTH = 800;
    public static int SCREEN_HEIGHT = 600;

    private static final String TAG = RenderObjApp.class.getSimpleName();

    private Mesh model;
    private PerspectiveCamera camera;

    private float scale = 1f;

    @Override
    public void create() {
        model = ObjLoader.loadObj(Gdx.files.internal("data/cessna.obj").read(), true);
        Gdx.gl.glEnable(GL10.GL_DEPTH_TEST);
        Gdx.input.setInputProcessor(new GestureDetector(this));
    }

    @Override
    public void dispose() {
    }

    @Override
    public void pause() {
    }

    @Override
    public void render() {
        Gdx.gl.glClearColor(0.0f, 0.0f, 0.0f, 1.0f);
        Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);
        camera.update();
        camera.apply(Gdx.gl10);
        model.render(GL10.GL_TRIANGLES);
    }

    @Override
    public void resize(int arg0, int arg1) {
        float aspectRatio = (float) arg0 / (float) arg1;
        camera = new PerspectiveCamera(75, 2f * aspectRatio, 2f);
        camera.near = 0.1f;
        camera.translate(0, 0, 0);
    }

    @Override
    public void resume() {
    }

    @Override
    public boolean touchDown(float x, float y, int pointer) {
        Gdx.app.log(TAG, "touchDown: ");
        return false;
    }

    @Override
    public boolean tap(float x, float y, int count, int pointer, int button) {
        Gdx.app.log(TAG, "tap: ");   
        return false;
    }

    @Override
    public boolean longPress(float x, float y) {
        Gdx.app.log(TAG, "zoom: ");
        return false;
    }

    @Override
    public boolean fling(float velocityX, float velocityY, int pointer, int button) {
        Gdx.app.log(TAG, "fling: ");
        return false;
    }

    @Override
    public boolean pan(float x, float y, float deltaX, float deltaY) {
        Gdx.app.log(TAG, "pan: ");
        return false;
    }

    @Override
    public boolean zoom(float initialDistance, float distance) {
        Gdx.app.log(TAG, "zoom: initialDistance=" + initialDistance + ", distance=" + distance);
        return false;
    }

    @Override
    public boolean pinch(Vector2 initialPointer1, Vector2 initialPointer2, Vector2 pointer1, Vector2 pointer2) {
        Gdx.app.log(TAG, "pinch: ");
        return false;
    }
} 
```

所以我正在寻找如何旋转 PerspectiveCamera 和 Mesh 本身。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:21:33.830

我一直在研究一种“Blender 风格”的相机，它具有捏合缩放功能以及（在桌面上）您使用 Blender 相机获得的大部分功能。这是一项正在进行的工作——它还不能完美地模仿 Blender 相机的行为。我认为这会让你指出正确的方向。你应该知道的一些事情：

1.  您可能必须翻译您的模型，使其位于原点。除非您翻译它，否则相机将始终指向原点。（目前只能在台式机上翻译，不能在安卓上翻译）；

2.  我在这里获得了大部分捏到缩放处理代码：[https](https://code.google.com/p/libgdx-users/wiki/PinchToZoom) ://code.google.com/p/libgdx-users/wiki/PinchToZoom 。

3.  对不起魔术数字。我将在未来制作这些常量。

4.  如果您或其他任何人改进此代码，如果您与我共享副本，我会很高兴。

抽象类：

```
/* Author: Christopher Grabowski, yourchristopher6334 gmail.com */

package ...;

import com.badlogic.gdx.InputProcessor;
import com.badlogic.gdx.graphics.PerspectiveCamera;
import com.badlogic.gdx.input.GestureDetector.GestureListener;
import com.badlogic.gdx.math.Vector2;

abstract public class ControllableCamera extends PerspectiveCamera implements InputProcessor{

    abstract public void resize(int width, int height);
    abstract public void render();

    public ControllableCamera(int fieldOfView, int width, int height) {
        super(fieldOfView, width, height);
    }

    @Override
    public boolean keyDown(int keyCode) {
        return false;
    }

    @Override
    public boolean keyTyped(char arg0) {
        return false;
    }

    @Override
    public boolean keyUp(int arg0) {
        return false;
    }

    @Override
    public boolean touchDown(int x, int y, int pointer, int button) {
        return false;
    }

    @Override
    public boolean touchDragged(int screenX, int screenY, int pointer) {
        return false;
    }

    @Override
    public boolean touchUp(int x, int y, int pointer, int button) {
        return false;
    }

    @Override
    public boolean mouseMoved(int arg0, int arg1) {
        return false;
    }

    @Override
    public boolean scrolled(int direction) {
        return false;
    }
} 
```

具体类：

```
 /* Author: Christopher Grabowski, yourchristopher6334 gmail.com */

package ...;

import com.badlogic.gdx.Gdx;
import com.badlogic.gdx.Input.Keys;
import com.badlogic.gdx.math.Vector3;

/*
 * the pause, resize, and render methods must be called within their corresponding
 * methods in the ApplicationListener
 */

public class BlenderStyleCamera extends ControllableCamera {
    public static final Vector3 ORIGIN = new Vector3(0, 0, 0);

    private static boolean shiftIsPressed = false, controlIsPressed = false,
            isScrollingUp = false, isScrollingDown = false,
            isSingleTouched = false, justSingleTouched = false;

    private float aspectRatio;
    private int x = -1, y = -1;
    private float dx = 0.0f, dy = 0.0f;
    private final Vector3 tmp = new Vector3();

    // fields related to pinch-to-zoom
    private int numberOfFingers = 0;
    private int fingerOnePointer;
    private int fingerTwoPointer;
    private float lastDistance = 0;
    private final Vector3 fingerOne = new Vector3();
    private final Vector3 fingerTwo = new Vector3();

    public BlenderStyleCamera(int fieldOfView, int width, int height) {
        super(fieldOfView, width, height);
        aspectRatio = viewportHeight / viewportWidth;
        Gdx.input.setInputProcessor(this);
        up.set(0.0f, 1.0f, 0.0f);
        position.set(0.0f, 0.0f, 30.0f);
        far = 300.0f;
        lookAt(0, 0, 0);
        translate(0.0f, 0.0f, 2.1f);
        lookAt(0, 0, 0);
        update();
    }

    public void pause() {
        numberOfFingers = 0;
    }

    @Override
    public void resize(int width, int height) {
        viewportWidth = width;
        viewportHeight = height;
        aspectRatio = viewportHeight / viewportWidth;
        update();
    }

    @Override
    public void render() {
        if (isSingleTouched) {

            // This gets the change in touch position and
            // compensates for the aspect ratio.
            if (x == -1 || y == -1 || justSingleTouched) {
                x = Gdx.input.getX();
                y = Gdx.input.getY();
            } else {
                dx = (x - Gdx.input.getX());
                dy = (y - Gdx.input.getY()) / aspectRatio;
            }

            // This zooms when control is pressed.
            if (controlIsPressed && dy > 0) {
                scrollIn();
            } else if (controlIsPressed && dy < 0) {
                scrollOut();
            }

            // This translates the camera blender-style
            // if shift is pressed.
            // Note that this will look weird with a
            // perspective camera.
            else if (shiftIsPressed) {
                translateTangentially();
            }

            // Default is to rotate the object
            // (actually rotate the camera about a sphere
            // that surrounds the object).
            else {
                travelAround();
            }

            x = Gdx.input.getX();
            y = Gdx.input.getY();

            justSingleTouched = false;
        }

        // this zooms when the mouse wheel is rotated
        if (isScrollingUp) {
            scrollIn();
            isScrollingUp = false;
        } else if (isScrollingDown) {
            scrollOut();
            isScrollingDown = false;
        }

        // Some key controls
        if (Gdx.input.isKeyPressed(Keys.LEFT) || Gdx.input.isKeyPressed(Keys.A)) {
            translateTangentially(1, 0);
        } else if (Gdx.input.isKeyPressed(Keys.RIGHT)
                || Gdx.input.isKeyPressed(Keys.D)) {
            translateTangentially(-1, 0);
        }

        if (Gdx.input.isKeyPressed(Keys.UP) || Gdx.input.isKeyPressed(Keys.W)) {
            translateTangentially(0, 1);
        } else if (Gdx.input.isKeyPressed(Keys.DOWN)
                || Gdx.input.isKeyPressed(Keys.S)) {
            translateTangentially(0, -1);
        }

        update();
    }

    // These methods create the pinch zoom
    // and set some flags for logic in render method.
    @Override
    public boolean touchDown(int x, int y, int pointer, int button) {
        // for pinch-to-zoom
        numberOfFingers++;
        if (numberOfFingers == 1) {
            isSingleTouched = true;
            justSingleTouched = true;
            fingerOnePointer = pointer;
            fingerOne.set(x, y, 0);
        } else if (numberOfFingers == 2) {
            isSingleTouched = false;
            fingerTwoPointer = pointer;
            fingerTwo.set(x, y, 0);

            float distance = fingerOne.dst(fingerTwo);
            lastDistance = distance;
        }
        return true;
    }

    @Override
    public boolean touchDragged(int x, int y, int pointer) {
        if (numberOfFingers > 1) {
            if (pointer == fingerOnePointer) {
                fingerOne.set(x, y, 0);
            }
            if (pointer == fingerTwoPointer) {
                fingerTwo.set(x, y, 0);
            }

            float distance = fingerOne.dst(fingerTwo);

            if (lastDistance > distance) {
                scrollOut();
            } else if (lastDistance < distance) {
                scrollIn();
            }

            lastDistance = distance;
            update();
        }
        return true;
    }

    @Override
    public boolean touchUp(int x, int y, int pointer, int button) {
        isSingleTouched = false;
        if (numberOfFingers == 1) {
            Vector3 touchPoint = new Vector3(x, y, 0);
            unproject(touchPoint);
        }
        numberOfFingers--;

        // just some error prevention... clamping number of fingers (ouch! :-)
        if (numberOfFingers < 0) {
            numberOfFingers = 0;
        }

        lastDistance = 0;
        return false;
    }   

    // These methods set flags for logic in render method.
    @Override
    public boolean keyDown(int keycode) {

        switch (keycode) {
        case (Keys.SHIFT_LEFT):
        case (Keys.SHIFT_RIGHT):
            shiftIsPressed = true;
            break;
        case (Keys.CONTROL_LEFT):
        case (Keys.CONTROL_RIGHT):
            controlIsPressed = true;
            break;
        case (Keys.O):
            this.up.set(0.0f, 1.0f, 0.0f);
            this.position.set(0.0f, 0.0f, 30.0f);
            this.lookAt(0, 0, 0);
            this.update();
        }
        return true;
    }

    @Override
    public boolean keyUp(int arg0) {
        shiftIsPressed = controlIsPressed = false;
        return true;
    }

    @Override
    public boolean scrolled(int direction) {
        if (direction == -1) {
            isScrollingUp = true;
        } else if (direction == 1) {
            isScrollingDown = true;
        }
        return true;
    }

    // The rest of the methods translate the camera.
    public void scrollIn() {
        float magnitude = 1.0f;
        scrollIn(magnitude);
    }

    public void scrollIn(float magnitude) {
        if (position.dst2(ORIGIN) > 2.0f) {
            tmp.set(position);
            tmp.nor();
            this.translate(-tmp.x * magnitude, -tmp.y * magnitude, -tmp.z
                    * magnitude);
            update();
        }
    }

    public void scrollOut() {
        float magnitude = 1.0f;
        scrollOut(magnitude);
    }

    public void scrollOut(float magnitude) {
        tmp.set(position);
        tmp.nor();
        this.translate(tmp.x * magnitude, tmp.y * magnitude, tmp.z * magnitude);
        update();
    }

    private void travelAround() {
        tmp.set(up);
        rotateAround(ORIGIN, tmp, dx);
        tmp.crs(position).nor();
        rotateAround(ORIGIN, tmp, dy);
    }

    private void translateTangentially() {
        translateTangentially(dx, dy);
    }

    private void translateTangentially(float dx, float dy) {
        tmp.set(up);
        tmp.crs(position);
        if (dx > 0) {
            translate(tmp.x / 15.0f, tmp.y / 15.0f, tmp.z / 15.0f);
        } else if (dx < 0) {
            translate(-tmp.x / 15.0f, -tmp.y / 15.0f, -tmp.z / 15.0f);
        }

        if (dy > 0) {
            translate(-up.x, -up.y, -up.z);
        } else if (dy < 0) {
            translate(up);
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T18:34:16.630

请看一下：[网格渲染问题 libgdx](https://stackoverflow.com/questions/11927277/mesh-rendering-issue-libgdx)。

方法**render**包含您需要的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T04:29:57.460

您要么需要旋转相机，要么旋转模型。

我相信 libGDX [Camera.rotateAround](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/graphics/Camera.html)方法可以满足您的需求。将“点”作为模型的中心，并根据用户投掷/平移的方式设置“轴”参数。“角度”可以是固定值，也可以是相对于抛/平移的强度。

# ios - 为多个 iOS 版本开发应用程序

> ID：13420788
> 
> 赞同：6
> 
> 时间：2012-11-16T16:42:32.653
> 
> 标签：ios, compiler-construction, build, target, deprecated

我正在使用 iOS 5.1 的 iPhone 4 和使用 iOS 6.0 的 iPad 4 上测试应用程序。我环顾四周，令人惊讶的是没有发现类似的问题：

1-我的应用程序有一些在 iOS 6.0 中已弃用的方法，所以我相信我必须构建一些 if/then 条件来测试系统版本，使用：[[UIDevice currentDevice] systemVersion]，然后使用版本适当的方法。这是最有效的方法吗？

2-我的理解是，只有一个目标，“项目”部署目标和“目标”部署目标具有相同的目的。而且我需要将其中之一或两者都作为 iOS 5.1，因为这是支持的最低 iOS。令人困惑的是，如果目标是基于 iOS 5.1 构建的，它如何在 iOS 6.0 的 iPad4 上运行：

*   iPad OS 是在运行之前检查目标版本还是只是尝试运行代码而 iOS 5.1 目标没有任何与 6.0 不兼容的代码？

*   即使是这样，5.1 目标如何支持我为有条件地替换不推荐使用的方法而构建的 6.0 方法？

非常感谢！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-16T17:06:10.963

### 已弃用的方法

如果您的目标是在不推荐使用这些方法*之前*发布的 iOS 版本，则可以使用不推荐使用的方法。但是假设您的部署目标设置正确，您将不会收到任何编译器错误，除非那些不推荐使用的方法*始终*针对您的目标版本不推荐使用。换句话说，如果您在代码中看到弃用警告，则需要修复它们或检查您的部署目标设置是否正确。不要忽视他们！

### Xcode 设置级别

您提到可以在目标和项目级别定义部署目标设置的事实。目标级别的 Xcode 构建设置将覆盖项目设置。因此，仅在其中一个级别定义部署目标，然后转到另一个并单击删除，这样您就没有重复的值。如果您只有一个目标，那么在目标或项目级别定义它并不重要。

### 向后和向前兼容性

最后，有许多因素会影响向后和向前兼容性。有时会有新的 iOS 6 方法，比如`supportedInterfaceOrientations`在旧的 iOS 版本上会被忽略。其他时候您需要添加显式检查：

*   如果你在一个对象上调用一个方法并且这个方法只在 iOS 6 中被引入，你需要`respondsToSelector:`像这样添加一个检查：

    ```
    // only available on iOS 6
    if ([locationManager respondsToSelector:@selector(pausesLocationUpdatesAutomatically)]) {
        locationManager.pausesLocationUpdatesAutomatically = YES;
    } 
    ```

*   如果要检查当前 iOS 版本上是否存在特定类，可以检查 +class 方法的返回值，如下所示：

    ```
    // Only available on iOS 6
    if ([UICollectionView class]) {
        // ...
    } else {
        // class doesn't exist in this iOS version
    } 
    ```

*   如果要检查特定功能是否可用，请对其执行简单的 if 语句：

    ```
    // Only available in iOS 6
    if (ABAddressBookCreateWithOptions) {
        ABAddressBookCreateWithOptions(...);
    } else {
        ABAddressBookCreate(...);
    } 
    ```

*   最后，如果你想检查一个常量是否可用，检查它的地址：

    ```
    // Only available in iOS 4
    if (&UIApplicationProtectedDataDidBecomeAvailable) {
        // subscribe to notification
    } 
    ```

您的 Base SDK 设置应始终设置为“最新”。

如果您遵循所有这些准则，您将能够解决大部分问题，而无需添加显式版本检查。检查 iOS 版本或设备 ID 非常脆弱，很可能会导致您的应用在未来的版本中崩溃。你真的想避免它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-16T16:51:48.557

1.  您可以使用`[[UIDevice currentDevice] systemVersion]`来检测操作系统版本，这将起作用。除了检测操作系统版本之外，您还可以使用`respondsToSelector:`来查看存在哪些方法，`NSClassFromString() != nil`查看类是否存在，如果该方法不可用则回退。

2.  iOS 向后兼容，因此 iOS 6 可以正常运行 iOS 5 应用程序。但是，如果您想使用 iOS 6 的特定功能但仍支持 iOS 5.1，您必须：

    *   使用 6.0 SDK 进行编译，以便编译器知道新的 API
    *   将您的目标版本设置为支持的最低版本，也就是。5.1。任何高于该数字的系统都将运行代码。任何更低的都不会尝试。
    *   使用 1\. 中描述的方法之一确保每个设备执行操作系统支持的代码。

我希望这很清楚，如果您有更多问题，请不要犹豫

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-16T16:56:43.383

您必须做的是检测功能，而不是 iOS 版本，请查看此线程：

[在 iOS 5 应用程序中对 iOS 6 功能的条件支持](https://stackoverflow.com/questions/12589866/conditional-support-of-ios-6-features-in-an-ios-5-app/12590035#12590035)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T16:45:49.160

iOS 向后兼容。如果你为 iOS 5.1 编译你的应用程序，它也可以在 iOS 6 上完美运行。无需重新实现已弃用的类。

但是如果您将部署版本从 5.0 更改为 6.0，如果您使用不推荐使用的方法，Xcode 会向您显示警告

如果您想使用仅在 iOS 6 中可用的方法，您可以使用此检查：

```
if ([self respondsToSelector:@selector(doSomething:)]) {
        [self doSomething];
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T16:48:46.070

您不应检查系统版本，而应检查您尝试使用的功能。请记住，已弃用并不意味着已删除，因此您尝试做的任何事情都可能适用于 iOS6。要检查特定功能，您可以执行以下操作：

```
if([TheClassInQuestion class] != nil)
{
    //use it
} 
```

# java - Ant 不受支持的错误不会消失

> ID：13420789
> 
> 赞同：-1
> 
> 时间：2012-11-16T16:42:37.127
> 
> 标签：java, ant

我收到此错误并尝试了几乎所有我能想到的东西。

我什至重新安装了 Ubuntu，从 Oracle 下载了 jdk 5，然后安装了`maven2`，`ant 1.8`但一切都是徒劳的。

我在上面写了一个 helloworld 'build.xml `and ran`ant`，但我仍然得到下面的错误。

只是想知道是否存在不符合正确版本的编译器的隐藏 jar 文件。

> 构建失败 java.lang.UnsupportedClassVersionError: java.lang.ClassLoader.defineClass1(Native Method) 的 java.lang.ClassLoader.defineClass(ClassLoader.java:621) 的 java.security.SecureClassLoader.defineClass 的 .class 文件中的版本号错误(SecureClassLoader.java:124) 在 java.net.URLClassLoader.defineClass(URLClassLoader.java:260) 在 java.net.URLClassLoader.access$100(URLClassLoader.java:56) 在 java.net.URLClassLoader$1.run(URLClassLoader. java:195) 在 java.security.AccessController.doPrivileged(Native Method) 在 java.net.URLClassLoader.findClass(URLClassLoader.java:188) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:307) 在 sun.misc .Launcher$AppClassLoader.loadClass(Launcher.java:268) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:300) 在 java.lang.ClassLoader。loadClass(ClassLoader.java:252) 在 javax.xml.parsers.FactoryFinder.newInstance(FactoryFinder.java:88) 在 javax.xml.parsers.FactoryFinder.findJarServiceProvider(FactoryFinder.java:278) 在 javax.xml.parsers.FactoryFinder .find(FactoryFinder.java:185) at javax.xml.parsers.SAXParserFactory.newInstance(SAXParserFactory.java:107) at org.apache.tools.ant.util.JAXPUtils.newParserFactory(JAXPUtils.java:120) at org. org.apache.tools.ant.util.JAXPUtils.getNamespaceXMLReader(JAXPUtils.java:172) 在 org.apache.tools.ant.helper 的 apache.tools.ant.util.JAXPUtils.getNSParserFactory(JAXPUtils.java:104)。 ProjectHelper2.parse(ProjectHelper2.java:273) at org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:178) at org.apache.tools.ant.ProjectHelper.configureProject(ProjectHelper.java:82)在组织。org.apache.tools.ant.Main.startAnt(Main.java:217) 上的 apache.tools.ant.Main.runBuild(Main.java:793) org.apache.tools.ant.launch.Launcher.run( Launcher.java:280) 在 org.apache.tools.ant.launch.Launcher.main(Launcher.java:109)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:45:29.423

> org.apache.tools.ant.util.JAXPUtils.getNSParserFactory(JAXPUtils.java:104) 在 org.apache.tools.ant 的 rg.apache.tools.ant.util.JAXPUtils.newParserFactory(JAXPUtils.java:120)。 util.JAXPUtils.getNamespaceXMLReader(JAXPUtils.java:172) 在 org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2.java:273) 在 org.apache.tools.ant.helper.ProjectHelper2.parse(ProjectHelper2\. java:178) at org.apache.tools.ProjectHelper.configureProject(ProjectHelper.java:82) at org.apache.tools.ant.Main.runBuild(Main.java:793) at org.apache.tools.ant .Main.startAnt(Main.java:217) 在 org.apache.tools.ant.launch.Launcher.run(Launcher.java:280) 在 org.apache.tools.ant.launch.Launcher.main(Launcher.java :109)

似乎您在类路径中有错误版本的 apache jar，这些 jar 不是为您在机器上的 jdk 运行时编译的。

# c# - MVC 编辑器不适用于收藏

> ID：13420791
> 
> 赞同：1
> 
> 时间：2012-11-16T16:42:40.310
> 
> 标签：c#, asp.net-mvc, editorfor

我有一个名为 Events 的模型类和一个名为 EventRange 的模型类：

```
public class Event
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }

    public List<EventRange> RangesCollection { get; set; }
}

public class EventRange
{
    public int Id { get; set; }

    public string RangeName { get; set; }
    public string RangeDescription { get; set; }
    public int Capacitiy { get; set; }
} 
```

如您所见，Event 类包含一个 List，其中包含尽可能多的 EventRanges，用户应该能够添加许多 EventRanges。

我创建了一个名为 events 的视图，它动态地为 evenrange 附加一个局部视图。例如，如果用户想要保存 5 个 EventRanges，他可以按下 Add Event Range 按钮 5 次。

事件视图：

```
@using (Ajax.BeginForm("CreateEvent", "Events", new AjaxOptions { HttpMethod = "POST" }, new { @class = "mainForm" }))
{
    @*Event data:*@
    @Html.LabelFor(m => m.Name)@Html.TextBoxFor(m => m.Name)
    @Html.LabelFor(m => m.Description)@Html.TextBoxFor(m => m.Description)

    @*EventRange data:*@

    <div id="EventRangediv">
    @Html.EditorFor(m => m.RangesCollection)
    </div>

} 
```

事件范围的部分视图保存在“~/views/events/EditorTemplates/EventRange.cshtml”下

事件范围.cshtml：

```
@model fanaticksMain.Models.EventRange

@Html.HiddenFor(m => m.Id)
@Html.DisplayFor(m => m.RangeName)
@Html.LabelFor(m => m.RangeName)@Html.TextBoxFor(m => m.RangeName)
@Html.LabelFor(m => m.RangeDescription)@Html.TextBoxFor(m => m.RangeDescription) 
```

但是，加载事件视图不会从局部视图加载任何元素，事件名称和描述的标签和文本框工作。但是 eventrange 部分视图没有显示任何内容。

有人知道我做错了什么吗？另外，如果这是绑定集合以发布表单的正确方法，是否有人有任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:45:11.993

EventRange.cshtml 具有指定为 EventRange 的模型。m.RangesCollection 是 EventRange 对象的集合。

我没有看到定义为接受 EventRange 集合的模型。

尝试在代码中放置一个 for 循环来迭代每个 EventRange 并为每个 EventRange.cshtml 显示编辑器：

代替：

```
@Html.EditorFor(m => m.RangesCollection) 
```

尝试：

```
@for (int i = 0; i < m.RangeCollection.Count; i++)
{
    @Html.EditorFor(m => m.RangeCollection[i])
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:48:13.563

尝试将“EventRange.cshtml”放在“~/Views/Shared/EditorTemplates/”文件夹中。

# c# - 创建发送邮件后的GridView到excel c#

> ID：13420796
> 
> 赞同：0
> 
> 时间：2012-11-16T16:43:04.227
> 
> 标签：c#, excel, gridview, sendmail

我想发送一个 .xlsx ，首先我创建（它有 html 代码）然后我使用 SMTP 服务器发送它，它确实附加了文件但是当我试图打开它时“它说文件已损坏等“有什么帮助吗？

这是我的代码

```
 try
            {

            System.IO.StringWriter sw = new System.IO.StringWriter();
            System.Web.UI.HtmlTextWriter htw = new System.Web.UI.HtmlTextWriter(sw);

            // Render grid view control.
            gvStock.RenderControl(htw);

            // Write the rendered content to a file.
            string renderedGridView = sw.ToString();
            File.WriteAllText(@"C:\test\ExportedFile.xls", renderedGridView);

           // File.WriteAllText(@"C:\test\ExportedFile.xls", p1);
            }
            catch (Exception e) 
            {
            Response.Write(e.Message);
            }

            try
            {
            MailMessage mail = new MailMessage();
            SmtpClient SmtpServer = new SmtpClient("server");
            mail.From = new MailAddress("no-reply@mail.com");
            mail.To.Add("db@gmail.com");
            mail.Subject = "Test Mail - 1";
            mail.Body = "mail with attachment";

            Attachment data = new Attachment("C:/test/ExportedFile.xls");
            mail.Attachments.Add(data);

            SmtpServer.Port = 25;
            SmtpServer.Credentials = new System.Net.NetworkCredential("user", "pass");
          //  SmtpServer.EnableSsl = true;
            SmtpServer.UseDefaultCredentials = false;
            SmtpServer.Send(mail);
            }
            catch( Exception e) 
            {
            Response.Write(e.Message);
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:04:31.013

您可能需要指明附件的类型

# php - 是否可以使用 PHP 找到用户的子网掩码？

> ID：13420798
> 
> 赞同：0
> 
> 时间：2012-11-16T16:43:10.247
> 
> 标签：php, networking, ip

我为我工作的公司创建了一个网站。
我想使用子网掩码限制对用户预设的访问。这可以用 PHP 吗？IP 是已知的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T17:33:27.430

你问问题的方式？不可以。您无法从服务器端确定客户端的子网掩码。

但是，您*可以*在服务器端定义自己的网络和掩码，以匹配客户端 IP，以确定是否授予访问权限。您应该首先[阅读子网的工作原理](http://compnetworking.about.com/od/workingwithipaddresses/a/subnetmask.htm)，然后使用[`ip2long()`](http://php.net/manual/en/function.ip2long.php)函数和[按位运算](http://php.net/manual/en/language.operators.bitwise.php)来授予对特定网段的访问权限。

老实说，大多数情况下，当您希望通过 IP 地址限制访问时，您会希望在网络/防火墙级别执行此操作，而不是在应用程序中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:12:16.860

这很简单：给定 IP 地址的“子网”掩码是`255.255.255.255`.

* * *

子网掩码与子网一起定义了一个 IP 地址范围。

因此，要从 IP 地址收集子网掩码，您需要子网。

* * *

我上面有点讽刺的回答假设子网和IP地址是相同的。哪种技术是不可能的，因为所有 4x255 位都用于子网，并且没有更多位可用于任何 IP 地址。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-16T17:19:39.370

我相信这可能会做你想要实现的目标：

见[http://php.net/manual/en/function.ip2long.php](http://php.net/manual/en/function.ip2long.php)

```
<?php
/**
 * Check if a client IP is in our Server subnet
 *
 * @author david dot schueler at tel-billig dot de
 * @param string $client_ip
 * @param string $server_ip
 * @return boolean
 */
function clientInSameSubnet($client_ip=false,$server_ip=false) {
    if (!$client_ip)
        $client_ip = $_SERVER['REMOTE_ADDR'];
    if (!$server_ip)
        $server_ip = $_SERVER['SERVER_ADDR'];
    // Extract broadcast and netmask from ifconfig
    if (!($p = popen("ifconfig","r"))) return false;
    $out = "";
    while(!feof($p))
        $out .= fread($p,1024);
    fclose($p);
    // This is because the php.net comment function does not
    // allow long lines.
    $match  = "/^.*".$server_ip;
    $match .= ".*Bcast:(\d{1,3}\.\d{1,3}i\.\d{1,3}\.\d{1,3}).*";
    $match .= "Mask:(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})$/im";
    if (!preg_match($match,$out,$regs))
        return false;
    $bcast = ip2long($regs[1]);
    $smask = ip2long($regs[2]);
    $ipadr = ip2long($client_ip);
    $nmask = $bcast & $smask;
    return (($ipadr & $smask) == ($nmask & $smask));
}
?> 
```

# c# - 从 C# 为 PowerShell 启用执行策略

> ID：13420799
> 
> 赞同：3
> 
> 时间：2012-11-16T16:43:13.100
> 
> 标签：c#, powershell

我有一个调用 PowerShell 的 ASP.NET MVC 4 页面。但是，我遇到了一个问题，因为我使用的模块没有签名，所以我必须启用*Unrestricted*策略。如何强制 PowerShell 孩子使用*不受限制*的策略？

我在我的脚本中启用了它，但它被忽略了。此外，当我尝试在代码中设置策略时，会引发异常。

```
 using (Runspace myRunSpace = RunspaceFactory.CreateRunspace())
    {
        myRunSpace.Open();

        using (PowerShell powerShell = PowerShell.Create())
        {
            powerShell.Runspace = myRunSpace;
            powerShell.AddCommand("Set-ExecutionPolicy").AddArgument("Unrestricted");
            powerShell.AddScript(script);

            objectRetVal = powerShell.Invoke();
        }
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-19T03:28:11.277

如果您只需要运行一个没有交互的脚本，您可以通过命令提示符设置执行策略，如下所示：

```
string command = "/c powershell -executionpolicy unrestricted C:\script1.ps1";
System.Diagnostics.Process.Start("cmd.exe",command); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-09-02T01:47:32.480

对于 PowerShell 5.1 和 PowerShell 7 Core，您可以使用[ExecutionPolicy 枚举](https://docs.microsoft.com/en-us/dotnet/api/microsoft.powershell.executionpolicy?view=powershellsdk-7.0.0)来设置执行策略，如下所示：

```
using Microsoft.PowerShell;
using System.Management.Automation;
using System.Management.Automation.Runspaces;
...
public class MyClass
{
     public void MyMethod() 
     {
          // Create a default initial session state and set the execution policy.
          InitialSessionState initialSessionState = InitialSessionState.CreateDefault();
          initialSessionState.ExecutionPolicy = ExecutionPolicy.Unrestricted;

          // Create a runspace and open it. This example uses C#8 simplified using statements
          using Runspace runspace = RunspaceFactory.CreateRunspace(initialSessionState);
          runspace.Open();

          // Create a PowerShell object 
          using PowerShell powerShell = PowerShell.Create(runspace);

          // Add commands, parameters, etc., etc.
          powerShell.AddCommand(<command>).AddParameter(<parameter>);

          // Invoke the PowerShell object.
          powerShell.Invoke()
     }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-07-06T02:00:02.030

您必须使用参数－Scope = CurrentUser：

```
 powershell.AddCommand("Set-ExecutionPolicy").AddArgument("Unrestricted")
    .AddParameter("Scope","CurrentUser"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-02-12T10:23:52.517

这与@kravits88 答案相同，但不显示 cmd：

```
static void runPowerShellScript(string path, string args) {
        ProcessStartInfo startInfo = new ProcessStartInfo();
        startInfo.FileName = "cmd.exe";
        startInfo.Arguments = @"/c powershell -executionpolicy unrestricted " + path + " " + args;
        startInfo.UseShellExecute = false;
        startInfo.WindowStyle = ProcessWindowStyle.Hidden;
        startInfo.CreateNoWindow = true;
        Process process = new Process();
        process.StartInfo = startInfo;
        process.Start();
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-19T16:20:47.653

我的解决方案是对我从 IIS Express 运行的模块和脚本进行自签名。我仍在开发中，发现 IIS Express 看不到您可能已在 \System32\WindowsPowerShell...\Modules 路径中安装的所有模块。我将正在使用的模块移动到另一个驱动器，并使用该位置将模块导入到我的脚本中。

感谢您的回复:-)

# c++ - 通过main传递文件位置？

> ID：13420801
> 
> 赞同：1
> 
> 时间：2012-11-16T16:43:16.863
> 
> 标签：c++, g++

我正在为我的 C++ 程序构建一个 Web 应用程序/接口，该程序将托管在服务器上，然后使用脚本语言（“PHP”）我将执行该程序以运行。

我正在使用 G++ 编译代码并执行命令以像这样运行： ("./main") 现在我可以传入文件位置以便我的程序可以运行吗？所以例如像这样：

```
int main(int argc, char *argv[], string* fileLoc)
{
    // code

} 
```

然后像这样执行（“./main（FILE_LOCATION）”）？

希望有人可以帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T16:45:38.813

您应该保留标准`main`签名`int main(int argc, char *argv[])`。如果您像这样执行它，文件名将是 in `argv[1]`：

> ./main somefilename.txt

```
//main.cpp
#include <iostream>
int main(int argc, char* argv[])
{
  if (argc > 1)
    std::cout << argv[1] << "\n";
} 
```

> ./main Hello_there
> 
> 你好呀

# php - 在动态页面中有不同的静态 url

> ID：13420806
> 
> 赞同：0
> 
> 时间：2012-11-16T16:43:31.277
> 
> 标签：php, friendly-url, dynamic-url

我有一个网站，每个人都有他的个人资料。我想拥有像*mywebsite/user1*、*mywebsite/user2*这样的静态 URL ，但实际上我会留在同一页面并动态更改内容。一个原因是，当我打开站点时，我会向数据库询问一些数据，而我不想每次更改页面时都询问它。我不喜欢像*mywebsite?user=1这样的 url*

有解决办法吗？

谢谢

[编辑更好的解释]

我有一个动态页面，显示我网站的用户资料。所以 URL 类似于*http://mywebsite.me?user=2* 但我想要一个静态链接，比如 *http://mywebsite.me/user2name*

我为什么要这个？因为它易于记忆和书写，并且因为我可以动态更改页面的内容，而无需每次向我的数据库询问数据（我需要所有页面中的一些共享信息。所有页面的信息都相同）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T17:01:35.687

是的，您的问题有解决方案！

第一个解决方案是服务器依赖。我有点不确定这在 IIS 服务器上是如何工作的，但在 Apache 中它很简单。Apache 可以从名为[.htaccess](http://httpd.apache.org/docs/2.2/howto/htaccess.html)的文件中获取指令。.htaccess 文件需要与您的活动脚本位于同一文件夹中才能工作。它还需要在主服务器配置中加载指令`AllowOverride All`和模块。[`mod_rewrite`](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)如果您已完成所有这些设置，则需要编辑 .htaccess 文件以包含以下内容

```
RewriteEngine on
RewriteRule ^mywebsite/([^/\.]+)/?$ index.php?user=$1 [L] 
```

这将允许您`mywebsite/index.php?user=12`使用`mywebsite/12`. [mod_rewrite](http://www.addedbytes.com/articles/for-beginners/url-rewriting-for-beginners/)的初学者指南。

你也可以只用 PHP 来伪造它。它不会像前面的例子那样漂亮，但它是可行的。此外，请考虑您正在使用用户输入，因此数据将被认为受到污染。用户需要通过 访问脚本`mywebsite/index.php/user/12`。

```
<?php
    $request = $_SERVER['REQUEST_URI'];
    $request = explode($request, '/'); // $request[0] will contain the name of the .php file
    $user[$request[1]] = $request[2];

    /* Do stuff with $user['user'] */
?> 
```

这些是我所知道的实现你想要的最快的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:53:47.490

首先，请熟悉我在这里介绍的解决方案：http: [//codeumbra.eu/how-to-make-a-blazing-fast-ajax-call-to-a-zend-framework-application](http://codeumbra.eu/how-to-make-a-blazing-fast-ajax-call-to-a-zend-framework-application)

这完全符合您的建议：消除所有不必要的数据库查询并仅执行当前需要的查询（在您的情况下：获取用户数据）。如果您的应用程序不使用 Zend Framework，则原则保持不变——您只需按照应用程序所需的方式打开数据库连接。或者只是使用 PDO 或任何你喜欢的东西。

本质上，该方法假定您对站点进行 AJAX 调用以获取所需的数据。在 jQuery 中很容易（上面提到的文章中提供了示例）。您也可以在成功时将之前用户的数据替换为请求的使用 JavaScript 的数据（希望您熟悉 AJAX；如果不熟悉，请发表评论，我会更详细地解释）。

[编辑]

由于您在编辑中解释了您的意思是 URI 重写，我可以建议实施一个简单的 URI 路由器。此处描述了其工作原理的基础知识：http: [//mingos.eu/2012/09/the-basics-of-uri-routing](http://mingos.eu/2012/09/the-basics-of-uri-routing)。您可以根据应用程序的需要使路由器变得复杂或简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T17:05:13.500

URL 并不规定您是否进行数据库调用。这是两个不同的问题。您通常设置您的服务器，以便`example.com/username`在内部*重写*`example.com/user.php?id=username`为. 您仍在运行 PHP，URL 只是掩盖它。这就是所谓的*漂亮 URL*，通过*URL 重写*来实现。

如果您想避免调用数据库，请*缓存*您的数据。例如，在上面的`user.php`脚本中，您生成了一个完整的 HTML 页面，然后将其写入某个缓存文件夹中，然后下次脚本不会再次生成页面，而是输出已经创建的页面的内容。或者您只是将数据库数据缓存在某处，但每次仍然重新生成 HTML。

您*可以*将实际的 HTML 文件写入 . `/username`，因此 Web 服务器将直接提供它，甚至无需打扰 PHP。不过，这通常*不是*您想要的，因为很难更新/使这些文件过期，而且您通常还需要*一些*动态内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T17:12:02.120

从您的数据库中选择所有。

然后为每个创建包含脚本内容（index.php?user='s）的文件。将文件名设置为您从 SELECT 语句中获得的 user_id/user_name。

这将为当前文件夹中的每个用户创建一个页面。

为了避免重新创建“静态”页面，您可以设置一个名为“indexedyet”的新列，并在创建文件时将其更改为 1。您只选择此为 0 的文件。您可以每天左右通过 cronjob 执行此操作。

但是，这使您容易受到用户数据更改的影响，因为它们不会自动更新。这里使用的一种策略是在任何编辑时更新静态页面。

另一个可能更好（抱歉还没有足够的咖啡）理想的方法是在用户注册时创建一个文件夹。在注册时为他们量身定制 index.php 页面，然后像 www.mysite.com/myuser 这样的任何内容都会显示他们的“定制版本”。再次更新用户更新页面。

我很乐意根据您的方法提供示例。

# scala - 记录发送到 Akka TestKit TestProbe 的所有消息

> ID：13420809
> 
> 赞同：8
> 
> 时间：2012-11-16T16:43:42.397
> 
> 标签：scala, akka, testkit

我正在尝试记录TestKit TestProbe*收到*的所有消息，这被证明有些困难。我知道文档中的[Actor Logging](http://doc.akka.io/docs/akka/snapshot/scala/testing.html#actor-logging-scala)部分，它说应该将该`debug.receive`选项与`LogginReceive`块结合使用。但是，当我无法控制演员的实施时，这不起作用。

我唯一的想法是`akka.testkit.TestActor`使用 a`LoggingReceive`子类，然后使用子类`TestKit`来创建我的子类的实例`TestActor`，但这不起作用，因为大多数功能都是`akka`命名空间私有的（我想这是有充分理由的）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-21T15:20:58.827

有一个（可能令人惊讶）简单的答案：

```
probe.setAutoPilot(new TestActor.AutoPilot {
  def run(sender: ActorRef, msg: Any) = {
    log.debug("whatever")
    this
  }
}) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-27T19:04:07.087

使用罗纳德的回答我写了这个有一个更简单的方法来定义我的探针：

```
object LoggingTestProbe {
  def apply()(implicit system: ActorSystem) : TestProbe = {
    val probe = TestProbe()
    probe.setAutoPilot(new TestActor.AutoPilot {
      def run(sender: ActorRef, msg: Any) = {
        val other = sender.path
        val me = probe.ref.path
        system.log.debug(s"$me received $msg from $other")
        this
      }
    })
    probe
  }
} 
```

`LoggingTestProbe()`有了这个，我使用而不是定义我的探针`TestProbe()`。

我是 Scala 的新手，所以这可能不是最佳的，但对我来说非常有用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-16T18:28:24.573

对不起，一开始你的问题有点错误，所以这是我的方法。

创建一个包装器actor，用于记录消息：

```
class LoggingActor(fac: => Actor) extends Actor {

  val underlying = context.system.actorOf(Props(fac))

  def receive = {
    LoggingReceive {
      case x ⇒ underlying.tell(x, sender)
    }
  }
} 
```

然后只需创建你`TestActorRef`的演员包裹在`LoggingActor`：

```
 val echo = TestActorRef(new LoggingActor(new FooActor))

  echo ! "hello world" 
```

# c# - 文本框中的“结束编辑”事件

> ID：13420810
> 
> 赞同：3
> 
> 时间：2012-11-16T16:43:44.020
> 
> 标签：c#, winforms, controls

我在 winform (c#) 中使用文本框并使用文本在数据库中进行咨询。

但是每次文本更改时，我都需要不断地查阅文本框的文本。所以对于这些，我使用 KeyUp。但是这个事件太慢​​了。

文本框编辑完成后是否会触发任何事件？我考虑完成 2 个条件

控制失去焦点。控件有 200ms 无按键

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T16:46:35.143

您可以使用[LostFocus](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.lostfocus.aspx)事件来捕获用户单击文本框外的控件的时间。

否则，您需要从现有事件之一中进行选择。（[这里列出](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox_events.aspx)）

想一想，您可能必须捕获多个事件。DragDrop 如果有人复制/粘贴，例如...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T16:46:11.943

你的意思是这样的？

[Control.LostFocus](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.lostfocus.aspx)

前提是当他们单击文本框时您认为已完成。

# javascript - document.ready 与 document.onLoad

> ID：13420811
> 
> 赞同：3
> 
> 时间：2012-11-16T16:43:48.693
> 
> 标签：javascript, jquery, onload, document-ready

我想知道哪一个是运行 js 代码的正确代码，该代码根据窗口高度计算垂直菜单的高度并按时设置，不迟到，不早。

我正在使用`document.ready`，但它并没有真正帮助我解决这个问题，有时它没有设置，我必须重新加载页面，然后它才能工作，但不是在第一次加载时。

如何解决这个问题呢？

这是我的代码：

```
$(document).ready(function(){
     var winh = document.body.clientHeight;
     var footer = document.getElementById('footer').offsetHeight;
     document.getElementById('sidebar').style.height = winh - 5/2*footer + 'px';
     document.getElementById('sidebar').style.marginBottom = footer + 'px';

     $(window).resize(function(){
         var winh = document.body.clientHeight;
         var footer = document.getElementById('footer').offsetHeight;
         document.getElementById('sidebar').style.height = winh - 5/2*footer + 'px';
         document.getElementById('sidebar').style.marginBottom = footer + 'px';
     });
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T16:52:37.283

**准备好**

当您在文档准备好时运行代码时，这意味着 DOM 已加载——但不是图像之类的东西。如果图像会影响高度和宽度，并且图像标签没有设置宽度和高度，那么 ready 不是您的选择 - 否则可能是。

**负载**

这包括图像 - 所以一切都会被加载。这意味着它会稍后触发。

**两个都**

```
var calculateSize = function () {
     var winh = document.body.clientHeight;
     var footer = document.getElementById('footer').offsetHeight;
     document.getElementById('sidebar').style.height = winh - 5/2*footer + 'px';
     document.getElementById('sidebar').style.marginBottom = footer + 'px';
}

$(document).ready(function(){
    calculateSize();

     $(window).resize(calculateSize);
});

window.onload = calculateSize ; 
```

# java - HTTPURLConnection - 内容完整性

> ID：13420814
> 
> 赞同：1
> 
> 时间：2012-11-16T16:43:59.653
> 
> 标签：java, httpurlconnection, put

我正在与`HttpUrlConnection`班级一起上传文件。

```
conn.setRequestMethod("PUT");
conn.setDoOutput(true);
conn.setDoInput(true);
conn.setRequestProperty("Trailer", "Content-Integrity");              
conn.setFixedLengthStreamingMode((int) (getSourceSize()-pos));

while ((bytes = in.read(block, 0, DEFAULT_BLOCK_SIZE)) > 0) {
        out.write(block, 0, bytes);
} 
```

之后我需要发送 Content-Integrity 标头，例如： *Content-Integrity: sha-256:bdcf7f645fd53dd3b3763f59376134ff58cc337247c978bdd178b6ccdfbff19f*

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:57:06.517

一般来说，HTTP/TCP 已经可以确保数据被正确重组，如果您担心数据安全性，那么 SSL（或其他加密方式）会更好。

# xcode - Xcode 通过 X-Cord 排序 UIImages 数组

> ID：13420819
> 
> 赞同：3
> 
> 时间：2012-11-16T16:44:25.697
> 
> 标签：xcode, uiimageview, sorting

我有一组 UIImageViews：

```
NSMutableArray *imagesArray = [[NSMutableArray alloc] init];
[imagesArray addObject:smallBox];
[imagesArray addObject:medBox];
[imagesArray addObject:largeBox];
[imagesArray addObject:xlBox]; 
```

这些框正在屏幕上移动。我希望对数组进行排序，以便屏幕左侧的任何一个框（x 位置）都位于数组的第一个位置等。我想如果我知道如何访问属性，我就能弄清楚在数组中的图像。我尝试使用像 imagesArray[0].frame.origin.x; 这样的代码。但这不起作用。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T07:30:23.833

我会这样做：

```
NSSortDescriptor *desc = [NSSortDescriptor sortDescriptorWithKey:@"frame.origin.x" ascending:YES];
[imagesArray sortUsingDescriptors:@[desc]]; 
```

这是假设数组中的所有对象都是视图——确保`smallBox`,`medBox`等都是`UIImageView`and not的实例`UIImage`。另外，请注意，为了使图像视图的`x`坐标按照您希望的方式排序，它们都应该是同一个超级视图的子视图。如果他们不是，你不是在比较苹果和苹果。如果视图不是同一视图的所有子视图，则需要编写一个比较器，`frame`在比较之前先将视图转换为屏幕坐标。

您的表达式 ( `imagesArray[0].frame.origin.x`) 应该为您提供`x`视图的坐标`imagesArray[0]`，如果没有，了解它如何/为什么失败会很有帮助。

# sql - 如何使长桌宽而不聚合？

> ID：13420824
> 
> 赞同：2
> 
> 时间：2012-11-16T16:44:46.007
> 
> 标签：sql, sql-server, sql-server-2008

我有这张金融交易表..

```
 PersonID  |  SeqId   | FundId | PortfolioDbu |    Date
    ----------------------------------------------------------
      456     |    1     |   B    |     0.1      |  2012-04-03
      456     |    1     |   F    |     0.5      |  2012-04-03
      456     |    1     |   H    |     0.3      |  2012-04-03
      456     |    1     |   Z    |     0.1      |  2012-04-03
       8      |    1     |   B    |     0.5      |  2012-03-23
       8      |    1     |   A    |     0.5      |  2012-03-23
       8      |    2     |   C    |     0.3      |  2011-03-24
       8      |    2     |   X    |     0.3      |  2011-03-24
       8      |    2     |   F    |     0.4      |  2011-03-24
      6001    |    1     |   J    |     0.5      |  2008-01-01
      6001    |    1     |   R    |     0.5      |  2008-01-01
       76     |    1     |   A    |     0.25     |  2010-09-26
       76     |    1     |   B    |     0.25     |  2010-09-26
       76     |    1     |   C    |     0.25     |  2010-09-26
       76     |    1     |   D    |     0.25     |  2010-09-26
      321     |    1     |   X    |     0.2      |  2012-02-21
      321     |    1     |   Y    |     0.2      |  2012-02-21
      321     |    1     |   U    |     0.2      |  2012-02-21
      321     |    1     |   P    |     0.2      |  2012-02-21
      321     |    1     |   W    |     0.2      |  2012-02-21
      456     |    2     |   Y    |      1       |  2012-11-01 
```

我需要将其转换为“宽”格式，就像这样..

```
 Date     | PersonId | SeqId | Fund1 | Fund2 | Fund3 | Fund4 | Fund5 | Dbu1 | Dbu2 | Dbu3 | Dbu4 | Dbu5  
    ----------------------------------------------------------------------------------------------------------
     2012-04-03  |   456    |   1   |   B   |   F   |   H   |   Z   |   .   |  0.1 |  0.5 |  0.3 |  0.1 |   .   
     2012-03-23  |    8     |   1   |   B   |   A   |   .   |   .   |   .   |  0.5 |  0.5 |   .  |   .  |   .    
     2012-03-24  |    8     |   2   |   C   |   X   |   F   |   .   |   .   |  0.3 |  0.3 |  0.4 |   .  |   .   
     2008-01-01  |   6001   |   1   |   J   |   R   |   .   |   .   |   .   |  0.5 |  0.5 |   .  |   .  |   . 
     2010-09-26  |    76    |   1   |   A   |   B   |   C   |   D   |   .   | 0.25 | 0.25 | 0.25 | 0.25 |   .   
     2010-02-21  |   321    |   1   |   X   |   Y   |   U   |   P   |   W   |  0.2 |  0.2 |  0.2 |  0.2 |  0.2  
     2012-11-01  |   456    |   2   |   Y   |   .   |   .   |   .   |   .   |   1  |   .  |   .  |   .  |   . 
```

即使我不想以任何方式聚合数据，这是否可能？

[SQL小提琴](http://sqlfiddle.com/#!3/c2169)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T19:08:58.243

我不是真正的 PIVOT 表，但您可以使用以下替代`CASE`语句模式来获取您正在寻找的输出：

```
WITH T AS (
  SELECT
    personid,
    seqid,
    row_number() over (partition BY personid,seqid ORDER BY FundId) AS ROW,
    FundId,
    portfoliodbu,
    date
  FROM
    transactions
)
SELECT
  date,
  personid,
  seqid,
  max(CASE WHEN ROW=1 THEN fundid END) AS fund1,
  max(CASE WHEN ROW=2 THEN fundid END) AS fund2,
  max(CASE WHEN ROW=3 THEN fundid END) AS fund3,
  max(CASE WHEN ROW=4 THEN fundid END) AS fund4,
  max(CASE WHEN ROW=5 THEN fundid END) AS fund5,
  max(CASE WHEN ROW=1 THEN portfoliodbu END) AS dbu1,
  max(CASE WHEN ROW=2 THEN portfoliodbu END) AS dbu2,
  max(CASE WHEN ROW=3 THEN portfoliodbu END) AS dbu3,
  max(CASE WHEN ROW=4 THEN portfoliodbu END) AS dbu4,
  max(CASE WHEN ROW=5 THEN portfoliodbu END) AS dbu5
FROM
  T
GROUP BY
  date,personid,seqid 
```

演示：**[SQL 小提琴](http://sqlfiddle.com/#!3/6155e/23)**

**[结果](http://sqlfiddle.com/#!3/6155e/23/0)**：

```
|                             DATE | PERSONID | SEQID | FUND1 |  FUND2 |  FUND3 |  FUND4 |  FUND5 | DBU1 |   DBU2 |   DBU3 |   DBU4 |   DBU5 |
----------------------------------------------------------------------------------------------------------------------------------------------
|   January, 01 2008 00:00:00+0000 |     6001 |     1 |     J |      R | (null) | (null) | (null) |  0.5 |    0.5 | (null) | (null) | (null) |
| September, 26 2010 00:00:00+0000 |       76 |     1 |     A |      B |      C |      D | (null) | 0.25 |   0.25 |   0.25 |   0.25 | (null) |
|     March, 24 2011 00:00:00+0000 |        8 |     2 |     C |      F |      X | (null) | (null) |  0.3 |    0.4 |    0.3 | (null) | (null) |
|  February, 21 2012 00:00:00+0000 |      321 |     1 |     P |      U |      W |      X |      Y |  0.2 |    0.2 |    0.2 |    0.2 |    0.2 |
|     March, 23 2012 00:00:00+0000 |        8 |     1 |     A |      B | (null) | (null) | (null) |  0.5 |    0.5 | (null) | (null) | (null) |
|     April, 03 2012 00:00:00+0000 |      456 |     1 |     B |      F |      H |      Z | (null) |  0.1 |    0.5 |    0.3 |    0.1 | (null) |
|  November, 01 2012 00:00:00+0000 |      456 |     2 |     Y | (null) | (null) | (null) | (null) |    1 | (null) | (null) | (null) | (null) | 
```

# osx-lion - OS X，为什么注册帮助手册后 NSMenu 中的帮助 NSMenuItem 被禁用？

> ID：13420825
> 
> 赞同：0
> 
> 时间：2012-11-16T16:44:49.790
> 
> 标签：osx-lion, nsmenuitem

OS X，为什么在注册帮助手册后 mainMenu 中的帮助 NSMenuItem 被禁用

标签：OSX, HelpBook, NSMenuItem, AHRegisterHelpBookWithURL

帮助手册无法使用，因为帮助菜单已禁用。选择帮助菜单时，帮助子菜单显示如下：

```
 Spotlight Search searchBar here - BLUE
    HungryMe Help  - GREYED OUT 
```

MainWindow.nib 包含菜单。帮助菜单项在 Xcode 中启用。

帮助手册

HelpBook Info.plist 如下；

```
 <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
    <plist version="1.0">
    <dict>
        <key>CFBundleDevelopmentRegion</key>
        <string>en_US</string>
        <key>CFBundleIdentifier</key>
        <string>com.DrummingGrouse.HungryMe.help</string>
        <key>CFBundleInfoDictionaryVersion</key>
        <string>6.0</string>
        <key>CFBundleName</key>
        <string>HungryMe</string>
        <key>CFBundlePackageType</key>
        <string>BNDL</string>
        <key>CFBundleShortVersionString</key>
        <string>1.0</string>
        <key>CFBundleSignature</key>
        <string>hbwr</string>
        <key>CFBundleVersion</key>
        <string>1.0</string>
        <key>HPDBookAccessPath</key>
        <string></string>
        <key>HPDBookIconPath</key>
        <string>shrd/EyeOnly.png</string>
        <key>HPDBookIndexPath</key>
        <string></string>
        <key>HPDBookKBProduct</key>
        <string></string>
        <key>HPDBookKBURL</key>
        <string></string>
        <key>HPDBookRemoteURL</key>
        <string></string>
        <key>HPDBookTitle</key>
        <string>HungryMe Help</string>
        <key>HPDBookType</key>
        <string>3</string>
    </dict>
    </plist> 
```

测试标题页 HungryMe.html 如下：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" AppleTitle="com.DrummingGrouse.HungryMe.help" />
    <title>HungryMe</title>
    </head>
    <body>
    <a name="hungryme_page"></a>
    <div class="container">
    <p>This is some text. <img src="../shrd/EyeOnly.png"  align="middle"> This is some more text.</p>
      <div class="content">
         <h1>Getting Started - Cooking with HungryMe</h1>
         <p>HungryMe has a main window with Category elements on the left and Recipe elements on the right.</p>
         <p>The display of a recipe's details is done as follows:</p>
         <p>    1\. Select a recipe Category in the left table of the main window. Select &quot;Browse All&quot; if you wish to have all recipes to be listed.</p>
         <p>2\. Double click the desired recipe and a separate window will appear displaying the details for the selected recipe. Multiple recipes can be displayed simultaneously.</p>
      <!-- end .content --></div>
      <!-- end .container --></div>
    </body>
    </html> 
```

该应用程序的 Info.plist 有：

CFBundleHelpBookFolder HungryMe.help CFBundleHelpBookName com.DrummingGrouse.HungryMe.help

Apple 帮助编程指南有：

```
 The CFBundleHelpBookName key identifies the help book. The value associated with this key 
    should be a string specifying the help book title, as defined by the AppleTitle tag in the 
    title page of the book. For example, here is how you would enter the title 
    of the SurfWriter Help book:

    <key>CFBundleHelpBookName</key>
    <string>com.mycompany.surfwriter.help</string> 
```

帮助手册包 HungryMe.help 被添加到 Xcode 项目的 Resources/ 文件夹中。Bundle 的结构是这样的：

```
 HungryMe.help/
        Contents/
            Info.plist
            Resources/
                shrd/ <shared artwork>
                English.lproj/
                    HungryMe.html <title page>
                    pgs/ <the rest of the content pages>
                    gfx/ <localized artwork>
                    sty/ <style sheets, generated list template>
                    scrpt/ <scripts> 
```

无论帮助手册是否使用 AHRegisterHelpBookWithURL 注册，将显示帮助手册的帮助菜单项都是灰色的。

如果使用 AHRegisterHelpBookWithURL，则下面代码中返回的 err 为零。

```
 OSStatus RegisterMyHelpBook(void)
    {
        CFBundleRef myApplicationBundle;
        CFURLRef myBundleURL;
        OSStatus err = noErr;

        myApplicationBundle = NULL;
        myBundleURL = NULL;

        myApplicationBundle = CFBundleGetMainBundle();// 1
        if (myApplicationBundle == NULL) {err = fnfErr; return err;}

        myBundleURL = CFBundleCopyBundleURL(myApplicationBundle);// 2
        if (myBundleURL == NULL) {err = fnfErr; return err;}

        if (err == noErr){
            err = AHRegisterHelpBookWithURL(myBundleURL);// 3
        }

        return err;
    } 
```

以下代码在启动时执行，

```
NSMenu *mainMenu = [[NSApplication sharedApplication] mainMenu];
NSMenuItem *menuItemHelp = [mainMenu itemWithTitle:@"Help"];
NSMenu *menuHelp = [menuItemHelp submenu];
NSMenuItem *menuItemHelpHungryMe = [menuHelp itemAtIndex:0];
DLog(@"menuItemHelpHungryMe=%@",menuItemHelpHungryMe);
DLog(@"menuHelp=%@",menuHelp); 
```

产生以下输出。

```
2012-11-16 11:30:03.167 HungryMe[62153:303] -[AppDelegate applicationDidFinishLaunching:]
   menuItemHelpHungryMe=<NSMenuItem: 0x1b6e3c0 HungryMe Help>
2012-11-16 11:30:03.168 HungryMe[62153:303] -[AppDelegate applicationDidFinishLaunching:]
   menuHelp=<NSMenu: 0x1b6e3a0>
Title: Help
Supermenu: 0x1b6c8e0 (MainMenu), autoenable: YES
Items:     (
    "<NSMenuItem: 0x1b6e3c0 HungryMe Help>"
) 
```

我观察到上面的 menuHelp 只有一项。

无论 NIB 中是否启用了帮助菜单，标题为“HungryMe 帮助”的帮助菜单项都是灰色的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T15:44:01.450

我从 NIB 文件中删除了帮助菜单项，然后在 Xcode 中重新添加了它。由于我不明白的原因，帮助菜单随后启用。以下代码使帮助查看器出现：

```
 - (IBAction) showHelp:(id)sender {

      int status =  MyGotoHelpPage();
        DLog(@"status for HelpBook load is %d",status);
    }

    OSStatus MyGotoHelpPage (void)
    {
        CFBundleRef myApplicationBundle = NULL;
        CFStringRef myBookName = NULL;
        OSStatus err = noErr;

        myApplicationBundle = CFBundleGetMainBundle();// 1
        //if (myApplicationBundle == NULL) {err = fnfErr; goto bail;}// 2
        myBookName = 
```

CFBundleGetValueForInfoDictionaryKey(myApplicationBundle, CFSTR("CFBundleHelpBookName"));
if (myBookName == NULL) {err = fnfErr; 返回错误；}

```
 if (CFGetTypeID(myBookName) != CFStringGetTypeID()) {// 4
            err = paramErr;
        } 

        err = AHGotoPage (myBookName, NULL,NULL);// load title page
        return err;
    } 
```

帮助查看器出现一条消息：“所选主题​​当前不可用。” 这是进步。

# ios - UITableView reloadData 和 @catch 块

> ID：13420826
> 
> 赞同：3
> 
> 时间：2012-11-16T16:44:50.647
> 
> 标签：ios, uitableview, try-catch

`[UITableView reloadData]`未在 @catch 块中调用

这是我的代码：

```
@try {
    [self.tableView insertRowsAtIndexPaths:indexPaths withRowAnimation:UITableViewRowAnimationAutomatic];
}
@catch (NSException *exeption) {
    [self.tableView reloadData];
} 
```

有时在 tableview 中插入新行时会出现问题（具体哪个都没有关系），我想处理它。虽然我测试异常引发 @catch 块处理它并且不会发生崩溃，但 reloadData 也没有调用。我还尝试使用`perfomSelectorOnMainThread:`GCD 在主线程上手动调用 reloadData：

```
@catch (NSException *exeption) {
    dispatch_async(dispatch_get_main_queue(), ^{
        [self.tableView reloadData];
    });
} 
```

但它也没有产生任何效果。有人可以提出一些建议吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:32:44.690

In Objective-C, it's not a good idea to catch the exception and keep going. It's better to figure out what's wrong and prevent the exception from happening.

But for whatever reason, you can try `-performSelector:withObject:afterDelay:`.

```
[self.tableView performSelector:@selector(reloadData) withObject:nil afterDelay:0.0]; 
```

* * *

**Update**

`-performSelector:withObject:afterDelay:` always runs in a later [run loop](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/Multithreading/RunLoopManagement/RunLoopManagement.html) even when the delay is 0.

```
[self.tableView performSelector:@selector(reloadData) withObject:nil afterDelay:0.0]; 
```

The effect is to call the `-reloadData` method in the next run loop. This is useful when there are UI changes are pending in the current run loop.

# python - Python调用与命名参数同名的函数

> ID：13420827
> 
> 赞同：1
> 
> 时间：2012-11-16T16:45:00.827
> 
> 标签：python, function, scope, global-variables, local-variables

在一个模块中，我有两个函数，我们称它们`f`为`g`. `g`接受一个命名参数`f`。我想`f`从里面打电话`g`。如何访问该功能`f`？不幸的是，由于兼容性问题，我无法更改它们的名称。

**编辑**

为了澄清，这就是我的意思：

```
def f():
  ... code ...

def g(f=1):
  ... code ...
  x = f() # error, f doesn't name the function anymore
  ... code ... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-16T16:47:09.817

您可以为该函数添加一个新名称。

例如：

```
def f():
    pass

f_alt = f

def g(f=3):
    f_alt() 
```

只是不要从模块中导出 f_alt 。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-16T16:47:10.050

使用的基本示例`globals`：

```
def f():
    print 'f'

def g(name):
    globals()[name]()

g('f') 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-16T17:08:51.433

虽然`globals()`在这里看起来是一个简单的解决方案，但您也可以通过在内部定义一个`g()`调用 global的内部函数来实现相同的目的`f`：

```
def f():print "hello"

def g(f):
    def call_global_f():
        global f
        f()
    call_global_f()      #calls the global f
    print f              #prints the local f

g('foo') 
```

**输出：**

```
hello
foo 
```

# php - iPhone中对php的请求和响应降低了速度

> ID：13420829
> 
> 赞同：0
> 
> 时间：2012-11-16T16:45:06.933
> 
> 标签：php, iphone, mysql, json, ipad

我正在使用 php 文件从 mysql 获取数据到 iPhone 应用程序，以说明我在 php 中使用此代码的意思

```
<?php

$host = "localhost";
$user_name = "user_name";
$password = "password";
$db_name = "db_name";
$con = mysql_connect($host,$user_name,$password)or die (mysql_error());
mysql_select_db($db_name)or die (mysql_error());
mysql_query("set names utf8");

$SQL= "SELECT * FROM emails WHERE 1";

$RS = mysql_query($SQL) or die(mysql_error());
mysql_query("set character_set_server='utf8'");

while($row=mysql_fetch_assoc($RS))
$output[]=$row;

    $json_encode =json_encode($output);
    $utf8_decode = utf8_decode($json_encode);
    echo $json_encode;
    mb_convert_encoding($json_encode, 'UTF-8');
    $html_entity_decode = html_entity_decode($json_encode); 
```

?>

在 iPhone 中，我使用了以下代码：

```
NSString *phpUrl = @"url of my php file";

SBJsonParser *parser = [[SBJsonParser alloc] init];

NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:phpUrl]];

NSData *response = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];

NSString *json_string = [[NSString alloc] initWithData:response encoding:NSUTF8StringEncoding];

NSArray *statuses = [parser objectWithString:json_string error:nil];

for (NSDictionary *status in statuses)
{
    NSString *sEmailID = [status objectForKey:@"ID"];
    NSString *sEmail = [status objectForKey:@"Email"];
    NSString *sPassword = [status objectForKey:@"Password"];
    NSString *sSMTP = [status objectForKey:@"SMTP"];
} 
```

这对我来说没问题，我得到了我的数据。我也在我的应用程序中多次使用这种方式。但我的问题是请求和响应导致我的应用程序的速度降低并使其运行缓慢。是否有任何方法可以降低请求和响应的速度，或者是否有其他替代方法？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:08:46.757

问题是您正在发送一个同步请求，这将阻塞您的线程，直到请求完成。一般来说，不建议这样做，也是因为您无法正确处理错误。您应该改为执行异步请求。像这样的东西：

```
NSString *phpUrl = @"url of my php file";

SBJsonParser *parser = [[SBJsonParser alloc] init];

NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:phpUrl]];

[NSURLConnection sendAsynchronousRequest:request queue:[NSOperationQueue mainQueue] completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
    if (error != nil) {
        NSLog(@"%@", error);
        return;
    }

    NSString *json_string = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];

    NSArray *statuses = [parser objectWithString:json_string error:nil];

    for (NSDictionary *status in statuses)
    {
        NSString *sEmailID = [status objectForKey:@"ID"];
        NSString *sEmail = [status objectForKey:@"Email"];
        NSString *sPassword = [status objectForKey:@"Password"];
        NSString *sSMTP = [status objectForKey:@"SMTP"];
    }
}]; 
```

[RTM](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html#//apple_ref/occ/clm/NSURLConnection/sendAsynchronousRequest:queue:completionHandler:)了解更多详情。

# c - 只有以 2 为底的对数可用时的自然对数实现

> ID：13420831
> 
> 赞同：4
> 
> 时间：2012-11-16T16:45:22.447
> 
> 标签：c, logging, cuda, ptx

我正在尝试用 PTX 实现自然对数​​。PTX 本身只提供`lg2.approx.f32`实现以 2 为底的对数。因此，应用简单的数学，只需将以 2 为底的对数乘以欧拉数 e 的以 2 为底的对数即可得到自然对数：

`log_e(a) = log_2(a) / lg_2(e)`

第一个近似值`1/lg_2(e)`是`0.693147`。所以，我只想乘以这个数字。

我已经`nvcc`将函数（来自 CUDA C）编译`log`成 PTX（请在下面找到输出）。我可以看到最后与数字常数相乘。但是还有很多事情要做。这很重要吗？有人可以解释为什么会有这么多开销吗？

```
 .entry _Z6kernelPfS_ (
        .param .u64 __cudaparm__Z6kernelPfS__out,
        .param .u64 __cudaparm__Z6kernelPfS__in)
    {
    .reg .u32 %r<13>;
    .reg .u64 %rd<4>;
    .reg .f32 %f<48>;
    .reg .pred %p<4>;
    .loc    14  3   0
$LDWbegin__Z6kernelPfS_:
    .loc    14  5   0
    ld.param.u64    %rd1, [__cudaparm__Z6kernelPfS__in];
    ld.global.f32   %f1, [%rd1+0];
    .loc    16  9365    0
    mov.f32     %f2, 0f00000000;        // 0
    set.gt.u32.f32  %r1, %f1, %f2;
    neg.s32     %r2, %r1;
    mov.f32     %f3, 0f7f800000;        // ((1.0F)/(0.0F))
    set.lt.u32.f32  %r3, %f1, %f3;
    neg.s32     %r4, %r3;
    and.b32     %r5, %r2, %r4;
    mov.u32     %r6, 0;
    setp.eq.s32     %p1, %r5, %r6;
    @%p1 bra    $Lt_0_2306;
    .loc    16  8512    0
    mov.b32     %r7, %f1;
    and.b32     %r8, %r7, -2139095041;
    or.b32  %r9, %r8, 1065353216;
    mov.b32     %f4, %r9;
    mov.f32     %f5, %f4;
    .loc    16  8513    0
    shr.u32     %r10, %r7, 23;
    sub.u32     %r11, %r10, 127;
    mov.f32     %f6, 0f3fb504f3;        // 1.41421
    setp.gt.f32     %p2, %f4, %f6;
    @!%p2 bra   $Lt_0_2562;
    .loc    16  8515    0
    mov.f32     %f7, 0f3f000000;        // 0.5
    mul.f32     %f5, %f4, %f7;
    .loc    16  8516    0
    add.s32     %r11, %r11, 1;
$Lt_0_2562:
    .loc    16  8429    0
    mov.f32     %f8, 0fbf800000;        // -1
    add.f32     %f9, %f5, %f8;
    mov.f32     %f10, 0f3f800000;       // 1
    add.f32     %f11, %f5, %f10;
    neg.f32     %f12, %f9;
    div.approx.f32  %f13, %f9, %f11;
    mul.rn.f32  %f14, %f12, %f13;
    add.rn.f32  %f15, %f9, %f14;
    mul.f32     %f16, %f15, %f15;
    mov.f32     %f17, 0f3b2063c3;       // 0.00244735
    mov.f32     %f18, %f17;
    mov.f32     %f19, %f16;
    mov.f32     %f20, 0f3c4c4be0;       // 0.0124693
    mov.f32     %f21, %f20;
    mad.f32 %f22, %f18, %f19, %f21;
    mov.f32     %f23, %f22;
    mov.f32     %f24, %f23;
    mov.f32     %f25, %f16;
    mov.f32     %f26, 0f3daaab50;       // 0.0833346
    mov.f32     %f27, %f26;
    mad.f32 %f28, %f24, %f25, %f27;
    mov.f32     %f29, %f28;
    mul.f32     %f30, %f16, %f29;
    mov.f32     %f31, %f30;
    mov.f32     %f32, %f15;
    mov.f32     %f33, %f14;
    mad.f32 %f34, %f31, %f32, %f33;
    mov.f32     %f35, %f34;
    cvt.rn.f32.s32  %f36, %r11;
    mov.f32     %f37, %f36;
    mov.f32     %f38, 0f3f317218;       // 0.693147
    mov.f32     %f39, %f38;
    add.f32     %f40, %f9, %f35;
    mov.f32     %f41, %f40;
    mad.f32 %f42, %f37, %f39, %f41;
    mov.f32     %f43, %f42;
    .loc    16  8523    0
    mov.f32     %f44, %f43;
    bra.uni     $Lt_0_2050;
$Lt_0_2306:
    .loc    16  8526    0
    lg2.approx.f32  %f45, %f1;
    mov.f32     %f46, 0f3f317218;       // 0.693147
    mul.f32     %f44, %f45, %f46;
$Lt_0_2050:
    .loc    14  5   0
    ld.param.u64    %rd2, [__cudaparm__Z6kernelPfS__out];
    st.global.f32   [%rd2+0], %f44;
    .loc    14  6   0
    exit;
$LDWend__Z6kernelPfS_:
    } // _Z6kernelPfS_ 
```

*** 编辑 ***

只是为了完整。这里是我编译成上述 PTX 的 CUDA C 内核：

```
__global__ void kernel(float *out, float *in)
{
  *out = log( *in );
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-16T19:32:07.167

`1<x<2`该函数似乎通过将指数部分设置为 1（有效缩放到 range ）然后计算 3 次多项式近似来计算浮点数的 log2 。**编辑**：似乎是有理的[Pade 近似](http://www.nezumi.demon.co.uk/consult/logx.htm)，因为 log(1+x) 的泰勒级数收敛严重。从而计算倒数。

可能最多只能削减少量指令。（代码乘以 0.5，而不是从指数中减去这些琐碎的东西。例如测试参数 x<=0。）

# jquery - 当包含到达窗口中心的对象时放大对象 - jquery？

> ID：13420832
> 
> 赞同：1
> 
> 时间：2012-11-16T16:45:24.783
> 
> 标签：jquery

我正在发布小提琴。 [http://jsfiddle.net/HWzz3/3/](http://jsfiddle.net/HWzz3/3/) 就是这种情况。当涉及到窗口的垂直中心时，我想缩放或缩放容器。当它不在该位置或滚动出该位置时返回其原始位置。用jquery可以吗？

```
<div id="container">My content</div> 
```

我会尝试在到达中心时放大并在远离中心时缩小。任何想法或帮助？

太感谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:34:06.483

## *[jsFiddle 演示](http://jsfiddle.net/HWzz3/4/)*

```
var contPos = $('#container').position().top;
var conthH = $('#container').height()/2;

$(window).on('scroll resize', function(){
    var scr = $(this).scrollTop(),
        winH = $(this).height()/2,
        curr = Math.abs((scr+winH)-(contPos+conthH)),  
        size = (curr<150)  ?  500:200   ;
    $('#container').stop(1).animate({width:size, height:size, marginTop:-size/2},300);   
}); 
```

您会看到`size = (curr<150) ? 500:200 ;`
`150`px 中的“屏幕中心区域”来做某事（您可以根据需要使用该值）
白色`500`，并且`200`是您要应用的**MAX**和**MIN尺寸。**

# java - Tomcat：共享库目录如何工作？

> ID：13420839
> 
> 赞同：0
> 
> 时间：2012-11-16T16:45:34.080
> 
> 标签：java, spring, tomcat

我对主题进行了搜索，但没有找到任何易于理解的内容……我们有一个 tomcat (v5.5)。上面部署了很多webapp。每个 webapp 都有 WEB-INF/lib 目录中的所有库。所以有很多重复。

为了组织一些常用方法，创建了一个经典库（XXX_API）。所以这个库被添加到每个 web 应用程序中进行编译但不与它们一起部署。该库部署在 Tomcat 的共享目录中。

我们尝试在公共库中使用 Spring 3.1.1 的 JdbcTemplate 集成一些 DAO。所以我们必须在共享目录中部署 Spring 库才能部署我们的 XXX_API。

现在，我们无法启动所有应用程序。其中一些因以下异常而崩溃：java.lang.IllegalArgumentException。org.springframework.jdbc.config.JdbcNamespaceHandler 类没有实现 NamespaceHandler 接口。有关信息，它们是使用 Spring 2.0.6 开发的 :(

问题似乎在 applicationContext.xml 中本地化。

所以，这是我的问题：

*   Tomcat的共享目录如何工作？
*   与 web 应用程序的 lib 目录相比，它是否优先加载？
*   只是关于 applicationContext.xml 中声明的命名空间的 pb 吗？
*   是否可以同时拥有两个弹簧版本？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:48:23.190

您真正要问的是类加载器如何加载、以什么顺序加载等。此页面很好地解释了在 tomcat 容器内执行 webapp 所涉及的所有类加载器。它告诉他们在哪里寻找类，以什么顺序，以及每个 webapp 以及容器本身可以看到哪些类。请注意，对此的更改在不同的 tomcat 版本中都很重要。

[http://tomcat.apache.org/tomcat-5.5-doc/class-loader-howto.html](http://tomcat.apache.org/tomcat-5.5-doc/class-loader-howto.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:54:41.980

我看到的共享 lib 文件夹的主要用途是用于 jdbc 驱动程序、jta 事务管理器和其他基础设施，例如：

1.  容器需要可用（在 jdbc 和 jta 的情况下，创建 jndi 数据源和 jta 用户事务）
2.  当您要使用 OCI 版本的 oracle 驱动程序时，是否特定于环境，例如 jdbc 驱动程序。在这种情况下，您必须将 ojdbc.jar 文件与安装在该机器上的本机 oracle 客户端库的版本相匹配。另一个例子是 jms 连接器。
3.  任何使用本机库的东西，因为多次加载该 jar 会在第二次尝试加载本机库时导致问题。

我不会将诸如 spring 之类的实际应用程序库放在共享 lib 文件夹中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T16:56:50.967

可能是因为一个类由应用程序类加载器加载，另一个由共享类加载器加载。

省去麻烦，不要使用共享目录。做什么的？为了节省一些磁盘空间？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T16:12:51.930

所以，我已经删除了每个 web 应用程序中的所有 spring jar。我导入了共享目录中的spring lib（3.1.1）。我取消选中它们（在 netbeans 下）以使它们不在构建中。

我什至更改了 web.xml、applicationContext.xml 和 Spring Servlet 中的声明，以便使用 servlet v2.5 进行标准化。

现在一切似乎都很好...

# android - 是否需要配置 Flurry AppCircle 以通过基本设置开始接收广告？

> ID：13420845
> 
> 赞同：1
> 
> 时间：2012-11-16T16:45:48.943
> 
> 标签：android, flurry

我已按照 flurry.com 上的所有 Android 集成指南进行操作，但没有收到任何广告。FlurryAgent.getAd 总是返回 false。并且详细的输出状态 - >“广告请求成功，但服务器未交付任何广告单元”。文档指出，开始接收广告唯一要做的就是进行基本设置（创建应用并为此应用配置广告空间），但是，我开始怀疑是否需要在 flurry.com 上配置 AppCircle 选项卡.

有人可以帮忙吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T11:29:04.760

要在 Flurry 上获得广告，您只需在 Flurry 网站 (dev.flurry.com) 上创建一个广告空间并在代码中调用它。所有广告空间配置都需要在 Publishers 选项卡下完成。仅当您使用 Flurry 推广您的应用时，才需要使用 AppCircle 选项卡。关于未显示的广告，能否请您将以下详细信息发送至 support@flurry.com： 1\. Flurry SDK 版本 2\. 集成片段 3\. 应用名称和广告空间名称（完全披露：我在支持团队工作在乱舞）

# .net - 尝试使用正则表达式解析 vCard 名称条目

> ID：13420851
> 
> 赞同：1
> 
> 时间：2012-11-16T16:46:34.820
> 
> 标签：.net, regex, vcf-vcard

我有以下正则表达式来解析 vCard：（VB）

```
 Dim options As New RegexOptions()
        options = RegexOptions.IgnoreCase Or RegexOptions.Multiline Or RegexOptions.IgnorePatternWhitespace
        regex = New Regex("(?<strElement>(N)) (;[^:]*)? (;CHARSET=UTF-8)? (:(?<strSurname>([^;\n\r]*))) (;(?<strGivenName>([^;\n\r]*)))? (;(?<strMidName>([^;\n\r]*)))? (;(?<strPrefix>([^;\n\r]*)))? (;(?<strSuffix>[^;\n\r]*))?", options)
        m = regex.Match(s)
        If m.Success Then
            Surname = m.Groups("strSurname").Value
            GivenName = m.Groups("strGivenName").Value
            MiddleName = m.Groups("strMidName").Value
            Prefix = m.Groups("strPrefix").Value
            Suffix = m.Groups("strSuffix").Value
        End If 
```

当我有像这样的 vCard 时，它可以工作：

```
BEGIN:VCARD
VERSION:2.1
N:Bacon;Kevin;Francis;Mr.;Jr.
FN: Mr. Kevin Francis Bacon Jr.
ORG:Movies.com 
```

但是当 vCard 是这样的时候，它就不能正常工作了：

```
BEGIN:VCARD
VERSION:2.1
N:Bacon;Kevin
FN:Kevin Bacon
ORG:Movies.com 
```

正则表达式将 <strSuffix> 分配给 Kevin，而不是像我想要的那样分配 <strGivenName>。我怎样才能解决这个问题？

改编的正则表达式来自这里：[vCard regex](http://sourceforge.net/apps/trac/syncmldotnet/wiki/vCard)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:58:19.707

你应该擅长正则表达式模式

```
^N(?:;(?!CHARSET=UTF-8)[^:]*|)(?:;CHARSET=UTF-8|):(?<strSurname>[^;\n\r]*);?(?<strGivenName>[^;\n\r]*);?(?<strMidName>[^;\n\r]*);?(?<strPrefix>[^;\n\r]*);?(?<strSuffix>[^;\n\r]*) 
```

请参阅**[此](http://ideone.com/m1thJq)**示例和**[此](http://ideone.com/l4HETA)**示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T20:04:29.870

我会避免使用唯一的正则表达式解析每一行，而是对每一行进行标记。然后让生成的过程确定是否缺少（可选）项目。这是一种通过代码和数据项简单地标记每一行的模式（*使用显式捕获和多行*）。

```
^(?<Code>[^:]+)(:)((?<Tokens>[^;\r\n]+)(;?))+ 
```

这将重点放在创建单独的代码对象上，这些代码对象处理数据是否丢失的业务逻辑。故障不再是正则表达式故障，而是业务逻辑后处理故障，恕我直言，更好地调试和维护。

# spring - Maven 模块依赖一个 IoC 问题

> ID：13420853
> 
> 赞同：2
> 
> 时间：2012-11-16T16:46:36.050
> 
> 标签：spring, maven, inversion-of-control

我有三个 Maven 模块：

*   Dao（包含 DAO 接口），
*   DaoImpl（包含实现 Dao 的 DAO 类），
*   服务（包含使用 DaoImpl 对象的服务）。

三个模块之间的依赖关系是这样的：

DaoImpl -> Dao <- 服务

'->' 表示'取决于'

我想将 DaoImpl bean 注入服务 bean。问题是由于 Service 不依赖于 DaoImpl，它无法访问其类路径。因此，Service 中声明的 DaoImpl bean 不能自动装配到 DaoImpl 的应用程序上下文中声明的 bean。

一种解决方案是使 Service 依赖于 DaoImpl。

Dao <- DaoImpl <- 服务

但是在这种情况下，为 DAO 提供接口没有任何意义。不再需要模块 Dao 并且 DaoImpl 将被公开。

你对这个话题有什么争论吗？

最好的祝福。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:56:00.007

恕我直言，您应该介绍依赖于 dao、（之一）daoimpl 和服务的第四个模块。

这是一种“应用程序部署”模块——通常是 WAR 或类似的东西。

*   应用程序 -> 服务 -> 道
*   应用程序 -> DaoImpl -> Dao

Application 模块的作用主要是准备完整的类路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:23:40.890

也可以通过以下方式解决

```
Service
  |_DaoIface
  |_DaoImpl 
```

这里 spring 可以从服务中加载，因此 IFace 和 Impl 都可见。

由于 Impl 对服务是直接可见的，并不意味着 DaoIface 没有必要。这是您的设计决定。如果 DAOImpls 实现将在运行时发生更改，或者如果您想要向其公开 DAO 层的任何其他组件，那么 iface 将很方便。

# c# - 查找未转义字符时使用正则表达式替换

> ID：13420854
> 
> 赞同：4
> 
> 时间：2012-11-16T16:46:40.590
> 
> 标签：c#, .net, regex

我有一个基本上是这样的要求。如果我有一串文本，例如

```
"There once was an 'ugly' duckling but it could 
never have been \'Scarlett\' Johansen" 
```

那么我想匹配尚未转义的引号。这些将是“丑陋”周围的那些，而不是“斯嘉丽”周围的那些。

我已经花了很长时间使用一个小的 C# 控制台应用程序来测试事情，并提出了以下解决方案。

```
private static void RegexFunAndGames() {

  string result;
  string sampleText = @"Mr. Grant and Ms. Kelly  starred in the film \'To Catch A Thief' but not in 'Stardust' because they'd stopped acting by then";
  string rePattern = @"\\'";
  string replaceWith = "'";

  Console.WriteLine(sampleText);

  Regex regEx = new Regex(rePattern);
  result = regEx.Replace(sampleText, replaceWith);

  result = result.Replace("'", @"\'");

  Console.WriteLine(result);
} 
```

基本上我所做的是一个两步过程，找到那些已经被转义的字符，撤消然后再次执行所有操作。这听起来有点笨拙，我觉得可能有更好的方法。

**测试信息**

我得到了两个非常好的答案，所以我认为值得进行测试，看看哪个运行得更好。我有这两个功能：

```
 private static string RegexReplace(string sampleText) {
        Regex regEx = new Regex("(?<!\\\\)'");
        return regEx.Replace(sampleText, "\\'");           
    }

    private static string ReplaceTest(string sampleText) {
        return sampleText.Replace(@"\'", "'").Replace("'", @"\'");
    } 
```

我通过控制台应用程序中的 Main 方法调用它们：

```
 static void Main(string[] args) {

        string sampleText = @"Mr. Grant and Ms. Kelly  starred in the film \'To Catch A Thief'  but not in 'Stardust' because they'd stopped acting by then.";
        string testReplace = string.Empty;
        System.Diagnostics.Stopwatch sw = new System.Diagnostics.Stopwatch();

        sw.Start();
        for (int i = 1000000; i > 0; i--) {
            testReplace = ReplaceTest(sampleText);
        }

        sw.Stop();
        Console.WriteLine("This method took '" + sw.ElapsedMilliseconds.ToString() + "'");

        sw.Reset();
        sw.Start();
        for (int i = 1000000; i > 0; i--) {
            testReplace = RegexReplace(sampleText);
        }

        sw.Stop();
        Console.WriteLine("This method took '" + sw.ElapsedMilliseconds.ToString() + "'");
} 
```

ReplaceTest 方法需要 2068 毫秒。RegexReplace 方法需要 9372 毫秒。我已经运行了几次这个测试，并且 ReplaceTest 总是最快的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T16:51:40.710

您可以使用*否定的lookbehind*来确保引用*没有*被转义：下面的表达式

```
(?<!\\)' 
```

匹配单引号*，除非*它前面紧跟一个斜杠。

请注意，进入字符串常量的斜线必须加倍。

```
var sampleText = @"Mr. Grant and Ms. Kelly  starred in the film \'To Catch A Thief' but not in 'Stardust' because they'd stopped acting by then";
var regEx = new Regex("(?<!\\\\)'");
var result = regEx.Replace(sampleText, "\\'");
Console.WriteLine(result); 
```

以上印刷品

```
Mr. Grant and Ms. Kelly  starred in the film \'To Catch A Thief\' but not in \'Stardust\' because they\'d stopped acting by then 
```

[链接到ideone。](http://ideone.com/SBycCd)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-16T18:56:20.447

我很惊讶您为什么使用 RegEx 来执行此操作，为什么不简单地使用：

```
string result = sampleText.Replace(@"\'", "'").Replace("'", @"\'"); 
```

这将逃脱所有未逃脱的`'`.

它将首先使所有转义`'`（单引号）未转义，然后将 escape `all`。

好吧，如果`RegEx is the requirement`，您将接受您已经说过的正确解决方案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-16T16:55:21.843

你可以使用

```
 string rePattern = @"[\\'|\']"; 
```

反而

# line-breaks - IDML RightIndentTab 导致换行

> ID：13420855
> 
> 赞同：1
> 
> 时间：2012-11-16T16:46:45.060
> 
> 标签：line-breaks, idml

我正在处理 InDesign 使用的 IDML 文件。我在插入特殊指令时遇到问题。我需要使用 IDML 文件嵌入 RightIndentTab。相同的 unicode 是 U+0008。当我尝试添加它时，它会引发错误，因为 XML 规范不支持此 unicode。

我对其进行了更多研究，IDML 有一个可以插入的特殊处理指令，现在看起来问题是当我添加它时，它会在 RightIndent 符号之前引入一个换行符。在调试时我发现内容元素看起来像

```
 <Content>
                <?ACE 8?>9731396</Content> 
```

它是一个 XElement，当我在其上调用 ToString() 时，我看到了 \r\n。我也尝试过使用 XmlWriter。

我想要的是一个看起来像的 XElement 对象

```
 <Content><?ACE 8?>9731396</Content> 
```

先谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:59:58.350

我在使用 .NET 向 IDML 添加处理指令时遇到了完全相同的问题。即使关闭了重要的空白，我也得到了 InDesign 将其视为文本的一部分的换行符。

我找到的唯一解决方案是将文件保存为 XML，然后将其作为文本文档打开并使用正则表达式替换`>\r\n<?`为`><?`. 它丑陋而笨拙，但它确实有效 - 我手头没有正则表达式，但你应该能够很快弄清楚。

不过，将 unicode 字符添加到 XML 中，我从来没有遇到过任何问题。我会使用`&#x0008;`并将 XmlWriter 编码设置为使用 unicode。有关示例，请参见此处： http: [//bytes.com/topic/net/answers/176665-how-write-unicode-using-xmlwriter](http://bytes.com/topic/net/answers/176665-how-write-unicode-using-xmlwriter)建议：

```
XmlTextWriter myWriter = new XmlTextWriter( fileStream,
new System.Text.UnicodeEncoding( false, false) ); 
```

# jquery - 使用 jquery 事件使用 Ajax 搜索登录

> ID：13420862
> 
> 赞同：0
> 
> 时间：2012-11-16T16:47:16.083
> 
> 标签：jquery, html, ajax

我想使用 Ajax 搜索登录，所以我不必刷新页面并使用 jquery 事件这里是代码，但它不起作用:(

```
 $(document).ready(function(){
    $("#login").keyup(submitForm);

 });
function submitForm()
{
var xhr= new XMLHttpRequest();
xhr.onreadystatechange=function()
{

    if (xhr.readyState==4 && xhr.status==200)
    {
        document.getElementById("zone").innerHTML=xhr.responseText;
    }
}
    var str="SearchLogin.php?login="+document.getElementById("login").value;

xhr.open("GET",str,true);
xhr.send();
} 
```

欣赏它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:56:51.390

我会改用 jquery $.ajax 函数：

```
function submitForm(){
    $.ajax({
        method: 'GET',
        url: 'SearchLogin.php',
        data: {
            login: $('#login').val()
        }
    }).done(function(response){
        $('#zone').html(response);
    });
} 
```

`console.log(response)`您可以在 .done 函数中使用 with firebug 检查输出。Firebug 也被证明是有用的，因为您可以使用控制台查看它是否找到该页面、是否发布成功、是否发送回数据等。只需单击请求，您就可以查看所有详细信息。我建议通过在服务器端脚本上回显“Hello World”来测试它，以查看连接是否正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:48:47.840

你有一个非常奇怪的 jQuery 和 JavaScript 组合。如果您使用的是 jQuery，那么坚持使用它会更容易。有一个 jQuery AJAX 函数，它可能比使用 JavaScript 函数更容易。请参阅此处的文档：http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

如果我将您的代码放入 jQuery 函数而不是使用 JavaScript AJAX：

```
function submitForm()
{
    $.ajax({
      url: "SearchLogin.php?login="+$('#login').attr('value'),
    }).done(function(response) { 
      $('#zone').innerHTML = response;
    });
} 
```

这是否有助于澄清一些事情？

# ruby - content_tag 条件 HTML 属性

> ID：13420867
> 
> 赞同：2
> 
> 时间：2012-11-16T16:48:04.343
> 
> 标签：ruby, ruby-on-rails-3

我有一个相对简单的问题。我有这样一行代码：

```
content_tag(:span, some_variable, { :class => span_class }) 
```

但如果变量`span_class`为零，则输出`<span class>some_variable</span>`.

我希望哈希仅在某些条件下发生。有没有办法做这样的事情：

```
content_tag(:span, some_variable, { :class => span_class } if some_condition) 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T16:54:27.497

我很惊讶它正在做你所说的，我期望：

```
content_tag :span, some_variable, :class => span_class 
```

`span_class`如果为 nil ，则不返回类。但是，我认为您可以通过传递来返回有效标记`||''`，如下所示：

```
content_tag( :span, some_variable, :class => span_class||'' ) 
```

# java - 索引目录不断变化的lucene

> ID：13420872
> 
> 赞同：0
> 
> 时间：2012-11-16T16:48:28.020
> 
> 标签：java, indexing, lucene

我已经使用文件系统创建了一个索引，到目前为止它已经索引了我指向的目录中的所有文件。这里的问题是，目前该目录只有 45 个文件，并且这 45 个文件已被索引。现在，该目录不断地在其中获取文本文件，我想以这样的方式对该目录进行索引，即它只索引新进入的文件，而不是每次文件进入时一次又一次地索引整个目录。我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T17:09:29.460

您可以使用[`WatchService`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/WatchService.html)which 会在新文件出现在文件夹中时告诉您。

但是，如果您的应用处于离线状态并且在此期间出现了新文件，这并没有多大用处。为了解决这个问题，您可以在 Lucene 中添加一个单独的字段并在索引任何新文件之前查询索引以检查该文件是否存在。

# jquery - Waypoint jQuery - 上下滚动的 2 个不同偏移量

> ID：13420874
> 
> 赞同：1
> 
> 时间：2012-11-16T16:48:32.300
> 
> 标签：jquery

为什么它不能正常工作？我需要创建两个不同的偏移量。向上滚动小，向下滚动最大。这段代码不能很好地工作。

```
// The same for all waypoints

$('body').delegate('section > article', 'waypoint.reached', function(event, direction) {
    var $active = $(this);

    if (direction === "up") {
        $active = $active.prev();
        $('section > article').waypoint({ offset: '10%' });
    }
    if (!$active.length) $active = $active.end();

            if (direction === "down") {

        $('section > article').waypoint({ offset: '60%' });
    }

    $('.link-active').removeClass('link-active');
    $('a[href=#'+$active.attr('id')+']').addClass('link-active');
});

// Register each section as a waypoint.

$('section > article#p1').waypoint({ offset: '28%' });
$('section > article').waypoint({ offset: '0' }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-10T18:56:10.773

您可以通过使用两个航点来做到这一点：

```
$('.thing').waypoint(function(direction) {
  if (direction === 'down') {
    // Do stuff
  }
}, {
  offset: '25%'
}).waypoint(function(direction) {
  if (direction === 'up') {
    // Do stuff
  }
}, {
  offset: '75%'
}); 
```

有关更多信息，请查看大师本人回答的主题：

[jquery航点“向上”事件的不同偏移量](https://stackoverflow.com/questions/19181435/different-offset-for-jquery-waypoint-up-event)

# javascript - 查看 geolocation.getCurrentPosition 是否已被禁用

> ID：13420882
> 
> 赞同：0
> 
> 时间：2012-11-16T16:48:48.063
> 
> 标签：javascript, geolocation

是否有一些简单的设置来检查用户是否为您的站点禁用了 GPS，或者您是否必须使用`geolocation.getCurrentPosition`和使用错误回调？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:09:31.657

除了特征检测——`if ("geolocation" in navigator) {`用户是否允许你使用位置服务只能通过首先表达你对服务的兴趣来确定，或者通过使用`getCurrentPosition()`或`watchPosition()`传递你的错误处理程序。

# sql - Oracle 10g 在查询中选择

> ID：13420885
> 
> 赞同：0
> 
> 时间：2012-11-16T16:48:54.257
> 
> 标签：sql, oracle

我想制定一个返回`vin`,的查询`customer_id`，`model_id`其中**相同** `customer_id`的**多**条记录具有表`model_id`中的“*丰田*” `CAR`。中的`vin`主键且唯一。有任何想法吗？我正在使用 Oracle 10g。

**汽车表：**

```
vin varchar (primary key)
customer_id varchar
model_id varchar 
```

**数据：**

```
vin        customer_id   model_id 
------------------------------------  
222313XYZ,   cust1234,   toyota
123232SSS,   cust1234,   toyota
111111ERE,   cust1111,   bmw
999999LKO,   cust1224,   bmw 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:08:23.640

[SQL小提琴](http://sqlfiddle.com/#!4/0fdae/1)

**Oracle 11g R2 模式设置**：

```
CREATE TABLE car
    (vin varchar2(9), customer_id varchar2(8), model_id varchar2(6))
;

INSERT ALL 
    INTO car (vin, customer_id, model_id)
         VALUES ('222313XYZ', 'cust1234', 'toyota')
    INTO car (vin, customer_id, model_id)
         VALUES ('123232SSS', 'cust1234', 'toyota')
    INTO car (vin, customer_id, model_id)
         VALUES ('111111ERE', 'cust1111', 'bmw')
    INTO car (vin, customer_id, model_id)
         VALUES ('999999LKO', 'cust1234', 'bmw')
SELECT * FROM dual
; 
```

**查询 1**：如果您想查看其所有者还拥有多个丰田的**所有模型**

```
select vin, customer_id, model_id from (
 select vin, customer_id, model_id, 
 count( decode(model_id, 'toyota', 1) ) over (partition by customer_id) cnt
  from car
)
where cnt > 1 
```

**[结果](http://sqlfiddle.com/#!4/0fdae/1/0)**：

```
|       VIN | CUSTOMER_ID | MODEL_ID |
--------------------------------------
| 999999LKO |    cust1234 |      bmw |
| 222313XYZ |    cust1234 |   toyota |
| 123232SSS |    cust1234 |   toyota | 
```

**查询 2**：如果您只想查看拥有多个所有者的丰田汽车：

```
select vin, customer_id, model_id from (
 select vin, customer_id, model_id, 
 count(*) over (partition by customer_id) cnt
  from car
 where model_id = 'toyota'
)
where cnt > 1 
```

**[结果](http://sqlfiddle.com/#!4/0fdae/1/1)**：

```
|       VIN | CUSTOMER_ID | MODEL_ID |
--------------------------------------
| 123232SSS |    cust1234 |   toyota |
| 222313XYZ |    cust1234 |   toyota | 
```

# php - 构造具有特定格式的日期时间

> ID：13420893
> 
> 赞同：-1
> 
> 时间：2012-11-16T16:49:42.763
> 
> 标签：php

我有一个来自我的数据库的日期字符串，日期是`16/11/2010`，它的格式是`d/m/Y`，我想像这样修改它。

```
<?php
   $date_from_db= '16/11/2010'; // format is d/m/Y
   $date = new DateTime($date_from_db);
   $date-> modify('+1 week');
   echo $date-> format('d/m/Y') ;
?> 
```

我有这个错误

```
Fatal error: Uncaught exception 'Exception' with message 'DateTime::__construct(): Failed to parse time string (16/11/2012) at position 0 (1). 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:51:52.557

尝试

```
 $date = DateTime::CreateFromFormat("d-m-y", "16-11-2010"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T16:55:56.633

不幸的是，这不是 DateTime 类构造函数支持的时间格式之一。

此页面显示有效格式

[http://www.php.net/manual/en/datetime.formats.date.php](http://www.php.net/manual/en/datetime.formats.date.php)

您应该在数据库中使用实际的符合 SQL 的日期字段（通常为 YYYY-MM-DD）。或者，如果您无法更改存储日期的方式，请`DateTime::CreateFromFormat`按照其他答案中的建议使用。

我强烈建议使用更标准的存储格式。

# javascript - 我可以使用 jQuery 或其他方式访问然后根据 src 值替换图像吗？

> ID：13420895
> 
> 赞同：-1
> 
> 时间：2012-11-16T16:49:45.153
> 
> 标签：javascript, jquery

我有一个地狱 CMS 可以使用，我想知道我是否可以使用 jQuery（或直接使用 JS）执行以下操作

显示的图像没有 ID 或类，我想根据它们的 src 值替换图像

伪代码将类似于...

在 src = /img/00789-reg-1.jpg' 处找到 img；并将 src 值替换为 ='img/much-better-img.jpg';

谢谢 -

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T16:55:28.273

每个图像都是由 提供的数组的一部分`document.images`。您可以循环浏览图像以找到具有所需来源的图像。

```
var index=0;
while(document.images[index]){
    alert(document.images[index].src);
    index++;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-16T16:53:24.857

是的你可以：

```
jQuery('img[src=/img/00789-reg-1.jpg]').attr('src','img/much-better-img.jpg'); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-16T16:56:28.070

你能用：

```
var images = document.images;
var iLength = images.length;
for (var i=0; i<iLength; i++){
    thisImage = images[i];
    if (thisImage.src == "theOneThatIWantToReplace"){
        thisImage.src = "myNewSrc"
        break;
    }
} 
```

如果您不需要它，至少这不会涉及到使用 JQuery。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T16:55:25.203

```
var  replace = {
  "/img/00789-reg-1.jpg": "img/much-better-img.jpg",
  "/img/another.jpg": "img/another-img.jpg"
}

for (var src in replace){
  $("img[src="+src+"]").attr("src", replace[src]);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T16:52:28.000

您可以使用[Attribute Starts With Selector](http://api.jquery.com/attribute-starts-with-selector/)来查找您的图像，然后进行替换：

```
$("img[src^='/img']").each(function(){
    $(this).attr("src", "new image");
}); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-16T16:53:33.083

您可以获取所有图像，然后检查它的来源

```
$('img').foreach(function(o){
  if (o.attr('src')=='oldfile')
    o.attr('src', 'newfile');
}); 
```

这很长，但我不知道其他方式。

# maven - 在 pom 文件中执行算术运算

> ID：13420898
> 
> 赞同：3
> 
> 时间：2012-11-16T16:49:48.863
> 
> 标签：maven, maven-2, maven-3, pom.xml

是否可以在 pom.xml 文件中执行算术运算？我需要根据时间生成一个id，然后除以100。所以我想知道我是否可以在pom文件中进行这种除法操作。任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T17:01:29.680

pom.xml 中无法进行任何操作 - 但在您的具体情况下，您可以使用以下属性：

*   `maven.build.timestamp`
*   `maven.build.timestamp.format`

实现基于时间的价值。例子：

```
...
<properties>
    <maven.build.timestamp.format>yyyyMMddHHmmss</maven.build.timestamp.format>
</properties>
...
   <configuration>
      <someproperty>${maven.build.timestamp}</someproperty>
   </configuration>
... 
```

您可以使用[SimpleDateFormat](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)模式来格式化结果字符串。不幸的是，似乎没有办法只打印毫秒的第一个数字 - 但也许只有几秒钟可能对你有用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-17T11:11:09.090

有人写了一个允许动态属性的插件： http: [//evgeny-goldin.com/wiki/Properties-maven-plugin](http://evgeny-goldin.com/wiki/Properties-maven-plugin)

或其他人的尝试： [https ://connect.gxsoftware.com/Blogs/Bram-de-Kruijff/Maven-secrets-Dynamic-Maven-properties-with-Beanshell.htm](https://connect.gxsoftware.com/Blogs/Bram-de-Kruijff/Maven-secrets-Dynamic-Maven-properties-with-Beanshell.htm)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-16T17:41:44.403

我认为 Pom.xml 不允许进行任何算术运算。

相反，您可以尝试使用此 Using [MavenXpp3Reader](http://maven.apache.org/maven-1.x/reference/maven-model/3.0.2/apidocs/org/apache/maven/project/io/xpp3/MavenXpp3Reader.html) and [MavenXpp3Writer](http://maven.apache.org/maven-1.x/reference/maven-model/3.0.2/apidocs/org/apache/maven/project/io/xpp3/MavenXpp3Writer.html)来编写新的 pom xml，其中包含您的值。

[这个话题](https://stackoverflow.com/questions/2131365/is-there-a-java-class-that-generates-a-pom-xml-file)会让你更深入地了解这个......

# c# - MathLogic / C#：计算登录会话来自不同系统的可能性

> ID：13420902
> 
> 赞同：0
> 
> 时间：2012-11-16T16:50:27.017
> 
> 标签：c#, math

我们有很多用户，有很多用户会话。我们想确定该软件是否正在不同的机器上使用。我们想要计算我们创建的不同变量的可能性。所以它在另一台电脑上使用的可能性：

我们使用的变量是 ip 和其他变量。

但可以说用户有一个动态 IP 地址。IP 地址变化很大，但其他变量可以保持不变。只有当所有变量都发生变化时，我们才希望创建更大的可能性，即它正在另一个系统上使用。

有谁知道计算这种可能性的公式或实现？

谢谢马蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:07:35.143

这个问题正在寻找一个非常具体的答案，因为细节非常模糊，但这是我的想法：

*   如果不是多台计算机，您不太可能在短时间内让同一用户从两个 IP 地址登录。特别是如果这种情况经常发生。
*   您可以尝试为每个变量提供某种*权重*指标，您可以将其用作乘数或常数值。对您的日志或任何有数据的地方进行分析，以得出所有变量的加权总数。
*   请记住，您可能会遇到一些变量或场景，这些变量或场景会降低机会并帮助抵消其他变量。
*   选择一个阈值，即在给定计算值的情况下，用户可能从多台机器登录的时间。

这不是你可以猜测的东西。您可能需要进行一些场景测试并收集统计数据。根据这些统计数据，您可以尝试权重方法并找出合理的阈值并做出相应的反应。

# ruby-on-rails - 在警报消息中显示会话变量

> ID：13420904
> 
> 赞同：0
> 
> 时间：2012-11-16T16:50:35.370
> 
> 标签：ruby-on-rails, view, controller, haml, session-variables

我目前在我的控制器中有这个：

```
 if c.save 
    session[:success] = "Career updated successfully."
    redirect_to "/career" 
```

在我看来，这是：

```
- if session[:success]
  .alert.alert-success.fade.in
    %button.close{"data-dismiss" => "alert", :type => "button"} ×
    %strong Well Done!
    = session[:success] 
```

然而无论如何都没有出现..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:53:23.953

Wooo Wooo Wooo 从不使用`session`这种工作，`flash`而是使用（[文档](http://api.rubyonrails.org/classes/ActionDispatch/Flash.html)）：

```
# in the controller:
if c.save 
  flash[:success] = "Career updated successfully."
  redirect_to "/career"

# in the view:
- if flash[:success]
  .alert.alert-success.fade.in
    %button.close{"data-dismiss" => "alert", :type => "button"} ×
    %strong Well Done!
    = flash[:success] 
```

来自文档的引用：

> 你放在闪光灯里的任何东西都会暴露在下一个动作中，然后被清除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:04:00.657

您可以将其分配给控制器中的实例变量，然后将其显示在视图中。您可能还希望将 session[:success] 设为布尔值。所以它可能是这样的：

在控制器中：

```
 if c.save 
  session[:success] = true
  @status = "Career updated successfully."      
  redirect_to "/career" 
```

在视图中：

```
- if session[:success]
  .alert.alert-success.fade.in
  %button.close{"data-dismiss" => "alert", :type => "button"} ×
  %strong Well Done!
  = @status 
```

但一般来说，这样的事情通常是通过一条消息来完成的。

# variables - 尝试获取值并保存在 Dim 变量上时，SendKeys 出现 VBS 问题

> ID：13420905
> 
> 赞同：0
> 
> 时间：2012-11-16T16:50:36.960
> 
> 标签：variables, vbscript, telnet, sendkeys

我需要一些有关 VBS 脚本的帮助。我想使用 VBS 脚本通过 telnet 访问路由器并将路由器上的参数值保存到 Dim 变量。

问题是 DIM 变量不保存路由器参数的输出。

这是我的脚本：

```
option explicit

DIM x

Set oShell = CreateObject("WScript.Shell")
oShell.run "cmd.exe"

WScript.Sleep 500

oShell.SendKeys "telnet 192.168.1.254"
oShell.SendKeys ("{Enter}")

WScript.Sleep 500

oShell.SendKeys "Administrator"
oShell.SendKeys ("{Enter}")

WScript.Sleep 500

oShell.SendKeys ""
oShell.SendKeys ("{Enter}")

WScript.Sleep 500

x = oShell.SendKeys ("env get var=_SW_FLAG") and oShell.SendKeys ("{Enter}") 

WScript.Sleep 500

oShell.SendKeys "exit"
oShell.SendKeys ("{Enter}")

WScript.Sleep 500

oShell.SendKeys "exit"
oShell.SendKeys ("{Enter}")

WScript.Sleep 500

MsgBox "The value of the parameter is:" & x 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:40:10.680

[像这样](http://www.mofeel.net/902-microsoft-public-scripting-vbscript/17104.aspx)的线程让我认为使用您的方法无法获得输出的特定细节。

我能得到的最接近的是这个先前提出的问题：[vbs to log (.txt) telnet output](https://stackoverflow.com/q/8260702/422353)

# string - Clojure 从 for 方法返回字符串列表

> ID：13420908
> 
> 赞同：1
> 
> 时间：2012-11-16T16:50:41.140
> 
> 标签：string, data-structures, map, clojure

我有一张地图，我想用它来处理和添加它的所有值以及作为输出的一部分的键。

```
(def map {:a (:b :c :d) :e (:f :g :h)}) 
```

我想做'对于所有键返回“a：包含（：b：c和：d）”'并将字符串添加在一起以获得最终输出：“a：包含（：b：c和：d）：e包含 (:f :g 和 :h)""

我最初尝试了一个doseq，在我的地图中我尝试将键和值解构为'k'和'v'然后（str k“包含”v）然后我把字符串吐到一个文件中。

这什么也没做，所以我添加了一个打印语句，说明键和值对。它们被打印出来但没有添加到文件中。

我读了起来，似乎我需要使用一个“for”，它可以与 doseq 互换，但很懒，但很重要地返回值。

更改为 for 立即给了我错误数量的参数错误，这很奇怪，因为我有两个解构和一个返回字符串的方法体。我摆弄并结束了编译 for 循环，但我将对象作为字符串而不是内容。

这让我发疯。

任何人都可以帮助我需要做的事情吗？

非常感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:35:48.927

首先，Joost 所说的是正确的。

我想你想要的是这个？

```
(def my-map {:a '(:b :c :d) :e '(:f :g :h)})

(apply str (map #(str (first %) " contains " (second %) " ") my-map))
":a contains (:b :c :d) :e contains (:f :g :h) " 
```

# java - AdMob 不会以编程方式加载

> ID：13420909
> 
> 赞同：1
> 
> 时间：2012-11-16T16:50:44.933
> 
> 标签：java, android, xml, admob

我需要在我的应用中包含广告，并且我有一个禁用广告的设置选项。所以我需要在代码中加载广告。我从谷歌复制了代码来处理这个问题，当我设置`ads:loadAdOnCreate`为时`true`，它工作得很好。

但是如果我将它设置为 false 并添加两行

```
 AdView adView = (AdView)this.findViewById(R.id.ad);
    adView.loadAd(new AdRequest()); 
```

广告停止显示。如果我查看日志猫，它表明它正在接收广告并尝试显示它。但是它实际上不会显示在屏幕上。帮助？

无论我是在 xml 中还是在代码中加载广告，以下警告都会显示在 logcat 中，尽管我将横幅显示在整个屏幕上。
`11-16 18:53:37.128: W/Ads(19401): Not enough space to show ad! Wants: <480, 75>, Has: <456, 133>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T04:48:29.290

我发现出了什么问题。我包括一个高度设置为的片段`fill_parent`。我将该设置更改为`wrap_content`，一切正常。

# heroku - 避免新遗物附加到 Heroku 上的 leiningen

> ID：13420912
> 
> 赞同：2
> 
> 时间：2012-11-16T16:50:50.170
> 
> 标签：heroku, clojure, leiningen, newrelic

我为在 Heroku 上运行的 Clojure 应用启用了 New Relic 监控。为了避免将我的应用程序嵌套在 Leiningen 的 JVM 进程中的开销，我从`lein trampoline run`.

这显然增加了 New Relic 附加到初始 Leiningen 进程的一些开销，该进程然后关闭并启动我的应用程序，导致 New Relic 再次附加延迟。这有时会导致无法在 30 秒的引导超时窗口内启动并导致停机。

显示两个 New Relic 代理启动的日志输出：

```
heroku/web.1:  Starting process with command `lein trampoline run`
app/web.1: [date] NewRelic 1 INFO: Agent is using Log4j
app/web.1: [date] NewRelic 1 INFO: Loading configuration file "/app/newrelic/./newrelic.yml"
app/web.1: [date] NewRelic 1 INFO: Agent Host: 866e2426-7a0f-4293-ae89-b55c0332253e IP: 10.159.0.212
app/web.1: [date] NewRelic 1 INFO: Setting audit_mode to false
app/web.1: [date] NewRelic 1 INFO: Setting protocol to "http"
app/web.1: [date] NewRelic 1 INFO: Configuration file is /app/newrelic/./newrelic.yml
app/web.1: [date] NewRelic 1 INFO: New Relic Agent v2.9.0 has started
app/web.1: [date] NewRelic 1 INFO: Java version: 1.6.0_20
app/web.1: [date] NewRelic 1 INFO: Agent class loader: sun.misc.Launcher$AppClassLoader@7ea2dfe
app/web.1: [date] NewRelic 5 INFO: JVM is shutting down
app/web.1: [date] NewRelic 5 INFO: New Relic Agent has shutdown
app/web.1: [date] NewRelic 1 INFO: Agent is using Log4j
app/web.1: [date] NewRelic 1 INFO: Loading configuration file "/app/newrelic/./newrelic.yml"
app/web.1: [date] NewRelic 1 INFO: Agent Host: 866e2426-7a0f-4293-ae89-b55c0332253e IP: 10.159.0.212
app/web.1: [date] NewRelic 1 INFO: Configured to connect to New Relic at collector.newrelic.com:80
app/web.1: [date] NewRelic 1 INFO: Setting audit_mode to false
app/web.1: [date] NewRelic 1 INFO: Setting protocol to "http"
app/web.1: [date] NewRelic 1 INFO: Configuration file is /app/newrelic/./newrelic.yml
app/web.1: [date] NewRelic 1 INFO: New Relic Agent v2.9.0 has started
app/web.1: [date] NewRelic 1 INFO: Java version: 1.6.0_20
app/web.1: [date] NewRelic 1 INFO: Agent class loader: sun.misc.Launcher$AppClassLoader@7ea2dfe 
```

有没有办法避免将 New Relic 附加到 leiningen 进程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T19:22:35.307

与其在 Heroku 配置的 JVM_OPTS 中设置，不如在`-javaagent:newrelic/newrelic.jar`您的生产配置文件中设置它？`:jvm-opts``project.clj`

# pygame - 如何使用pygame正确清除屏幕上“blitted”的所有图像？

> ID：13420914
> 
> 赞同：1
> 
> 时间：2012-11-16T16:50:54.040
> 
> 标签：pygame, blit

我想知道 pygame.blit 如何管理屏幕上的图像。当我在屏幕上对多个图像进行 blit 时，我看到每个图像都堆叠在前一个图像之上。

如何清除所有这些图像？当屏幕上有很多图像堆叠在一起时（不知何故）不会有大问题吗？目前，我只是在整个屏幕上使用白色背景或自定义背景来“清除”屏幕。到目前为止，没有任何问题或任何问题，因为我正在开发的应用程序非常小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T20:02:04.117

当您将图像blit 到表面时，它基本上将其绘制在表面上。blitting 的位置或 blitting 的对象不保存，不能更改。就像您将图像绘制到画布上一样。新的会超越旧的，如果一个图像与另一个图像发生冲突，就没有办法摆脱它。

解决此问题的最常见方法是使用 完全清除屏幕`surface.fill()`，然后每帧重绘图像。

要回答您关于当有很多图像时是否会出现问题的问题，没有。窗口只会保存为特定颜色的每个单独像素，就像您拍摄相机的普通照片一样，因此无论您使用多少物体，游戏将始终花费相同的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:12:28.447

有多种方法：

*   像你一样清洁整个背景。如果计算机跟上 fps，也许最好保持这种状态。

*   只清理你 blitted 对象的区域（参见[pygame.sprite.RenderUpdates](http://www.pygame.org/docs/ref/sprite.html#pygame.sprite.RenderUpdates)）

*   在您的情况下，如果您有许多堆叠的对象，也许最好编写自己的解决方案，尝试找到碰撞矩形之间的*联合*，以避免一遍又一遍地重新调整相同的背景。

# java - 具有更高速度 remove() 的延迟队列？

> ID：13420915
> 
> 赞同：11
> 
> 时间：2012-11-16T16:51:02.273
> 
> 标签：java, performance

我有一个项目可以跟踪超过 500k 个对象的状态信息，该程序每秒接收 10k 次关于这些对象的更新，更新包括新建、更新或删除操作。

作为程序的一部分，必须大约每五分钟对这些对象执行一次内务管理，为此我将它们放置在`DelayQueue`实现接口中，允许控制这些对象的内务`Delayed`处理的阻塞功能。`DelayQueue`

*   在 new 上，一个对象被放置在`DelayQueue`.

*   更新后，对象`remove()`从 'd' 中`DelayQueue`更新，然后重新插入到由更新信息指定的新位置。

*   删除后，该对象`remove()`将从`DelayQueue`.

我面临的问题是，`remove()`一旦队列通过大约 450k 个对象，该方法就会变成一个非常长的操作。

该程序是多线程的，一个线程处理更新，另一个处理内务。由于`remove()`延迟，我们遇到了令人讨厌的锁定性能问题，最终更新线程缓冲区消耗了所有堆空间。

我设法通过创建一个来解决这个问题`DelayedWeakReference (extends WeakReference implements Delayed)`，它允许我将“影子”对象留在队列中，直到它们正常过期。

这消除了性能问题，但会导致内存需求显着增加。这样做会导致`DelayedWeakReference`每个实际需要在队列中的对象大约 5 。

有人知道`DelayQueue`允许快速`remove()`操作的附加跟踪吗？或者有什么更好的方法来处理这个问题而不消耗更多的内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T17:00:50.393

花了我一些时间思考这个问题，
但是在阅读了你有趣的问题几分钟后，我的想法是：
A. 如果你的对象有某种 ID，用它来散列，实际上没有一个延迟队列，但有 N 个延迟队列。
这将使锁定因子减少 N。
将有一个中央数据结构，
保存这 N 个队列。由于 N 是预配置的，
因此您可以在系统启动时创建所有 N 个队列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T16:58:38.253

如果您只需要“大约每五分钟”执行一次内务管理，那么这就是维护它的工作量。

我要做的是有一个每分钟运行一次（或根据需要更少）运行的任务，以查看自上次更新以来是否已经过了五分钟。如果您使用这种方法，则无需维护额外的集合，并且更新时不会更改数据结构。扫描组件的开销增加了，但保持不变。执行更新的开销变得微不足道（设置最后一次更新的字段）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T17:52:10.990

如果我正确理解你的问题，你想对一个对象做一些事情，如果它没有被触摸 5 分钟。

你可以有一个自定义的链表；尾巴是最近触摸的。删除节点很快。

簿记线程可以简单地每 1 秒唤醒一次，并删除 5 分钟前的头。但是，如果 1 秒延迟是不可接受的，请计算准确的暂停时间

```
// book keeping thread

void run()

  synchronized(list) 

    while(true)

        if(head==null)
            wait();
        else if(  head.time + 5_min > now )
            wait( head.time + 5_min - now );
        else 
            remove head
            process it

// update thread

void add(node)
  synchronized(list) 
    append node
    if size==1
        notify()  

void remove(node)
  synchronized(list) 
    remove node 
```

# r - 在 r 中进行循环计算

> ID：13420917
> 
> 赞同：4
> 
> 时间：2012-11-16T16:51:10.377
> 
> 标签：r, loops, dataframe

我在执行迭代定义的计算时遇到困难。以下数据作为示例（实际数据集更大）：

```
## DATA ##
# Columns
   Individual<-c("A","B","C","D","E","F","G","H1","H2","H3","H4","H5","K1","K2","K3","K4","K5")
   P1<-c(0,0,"A",0,"C","C",0, rep("E",5),"H1","H2","H3","H4","H5")
   P2<-c(0,0,"B",0,"D", "E",0,rep("G",5),"H1","H2","H3","H4","H5")
# Dataframe
   myd<-data.frame(Individual,P1,P2,stringsAsFactors=FALSE)

   Individual P1 P2
1           A  0  0
2           B  0  0
3           C  A  B
4           D  0  0
5           E  C  D
6           F  C  E
7           G  0  0
8          H1  E  G
9          H2  E  G
10         H3  E  G
11         H4  E  G
12         H5  E  G
13         K1 H1 H1
14         K2 H2 H2
15         K3 H3 H3
16         K4 H4 H4
17         K5 H5 H5 
```

数据表示 和 个人与两个父母之间的关系，`P1`，`P2`。

所需的计算，标记为`relationA`，表示每个人与 A 的相关程度。

根据定义，A 和 A 之间的关系被赋值为 1。所有其他个体的值需要根据表中的信息计算，如下所示：

```
The value of relationA for an individual should be equal to 
   1/2 (the value of relationA of P1 of the individual)  
 + 1/2 (the value of relationA of P2 of the individual) 
```

例如

```
 Individual P1 P2      relationA
1           A  0  0       1
2           B  0  0       0
3           C  A  B       (A = 1 + B = 0)/2 = 0.5
4           D  0  0       0
5           E  C  D       (C= 0.5 + D = 0)/2 = 0.25
6           F  C  E       (C = 0.5 + E = 0.25)/2 = 0.375 
```

预期的输出如下：

```
 Individual P1 P2  relationA
1           A  0  0   1
2           B  0  0   0
3           C  A  B   0.5
4           D  0  0   0
5           E  C  D   0.25
6           F  C  E   0.375
7           G  0  0   0 
8          H1  E  G   0.125
9          H2  E  G   0.125
10         H3  E  G   0.125
11         H4  E  G   0.125
12         H5  E  G   0.125
13         K1 H1 H1   0.125
14         K2 H2 H2   0.125
15         K3 H3 H3   0.125
16         K4 H4 H4   0.125
17         K5 H5 H5   0.125 
```

我的困难在于以适当的方式表达这一点`R`。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T18:57:09.983

您可以编写一个函数来计算给定个体的值和（隐式）关系作为简单的递归函数。

```
relationA <- function(ind) {
  if(ind == "A") {
    1
  } else if (ind == "0") {
    0
  } else {
    pts <- myd[myd$Individual == ind,]
    (relationA(pts[["P1"]]) + relationA(pts[["P2"]])) / 2
  }
} 
```

简单地说，如果个人是A，它就是1；如果个人为0，则为0；对于其他任何事情，递归调用与个人相对应的`relationA`每个父母（`P1`和`P2`）并将它们相加并除以2。这一次仅适用于一个人：

```
> relationA("A")
[1] 1
> relationA("F")
[1] 0.375
> relationA("K5")
[1] 0.125 
```

但是您可以相对容易地将其矢量化到所有个体：

```
> sapply(myd$Individual, relationA)
    A     B     C     D     E     F     G    H1    H2    H3    H4    H5    K1 
1.000 0.000 0.500 0.000 0.250 0.375 0.000 0.125 0.125 0.125 0.125 0.125 0.125 
   K2    K3    K4    K5 
0.125 0.125 0.125 0.125 
```

这可以分配`myd`回

```
myd$relationA <- sapply(myd$Individual, relationA) 
```

这不是特别有效，因为它必须`relationA`为每种情况一遍又一遍地计算。当它到达“K5”时，它调用`reationA("H5")`了两次，每次调用`relationA("E")`and `relationA("G")`，而那些调用`relationA("C")`,和`relationA("D")`，等等。也就是说，没有结果被缓存，而是每次都重新计算。对于这么小的数据集，没关系，因为即使是低效的仍然非常快。`relationA("0")``relationA("0")`

如果您想要/需要缓存结果并使用该缓存，那么您可以修改`relationA`以执行此操作。

```
relationAc <- function(ind) {
  pts <- myd[myd$Individual == ind,]
  if(nrow(pts) == 0 | any(is.na(pts[["relationA"]]))) {
    relationA <-
      if(ind == "A") {
        1
      } else if (ind == "0") {
        0
      } else {
        (relationAc(pts[["P1"]]) + relationAc(pts[["P2"]])) / 2
      }
    myd[myd$Individual == ind, "relationA"] <<- relationA
    relationA
  } else {
    pts[["relationA"]]
  }
} 
```

然后你必须初始化缓存：

```
myd$relationA <- NA_real_ 
```

一次调用将填写所需的值，调用整个个人集将导致填写所有值。

```
> myd
   Individual P1 P2 relationA
1           A  0  0        NA
2           B  0  0        NA
3           C  A  B        NA
4           D  0  0        NA
5           E  C  D        NA
6           F  C  E        NA
7           G  0  0        NA
8          H1  E  G        NA
9          H2  E  G        NA
10         H3  E  G        NA
11         H4  E  G        NA
12         H5  E  G        NA
13         K1 H1 H1        NA
14         K2 H2 H2        NA
15         K3 H3 H3        NA
16         K4 H4 H4        NA
17         K5 H5 H5        NA
> relationAc("K5")
[1] 0.125
> myd
   Individual P1 P2 relationA
1           A  0  0     1.000
2           B  0  0     0.000
3           C  A  B     0.500
4           D  0  0     0.000
5           E  C  D     0.250
6           F  C  E        NA
7           G  0  0     0.000
8          H1  E  G        NA
9          H2  E  G        NA
10         H3  E  G        NA
11         H4  E  G        NA
12         H5  E  G     0.125
13         K1 H1 H1        NA
14         K2 H2 H2        NA
15         K3 H3 H3        NA
16         K4 H4 H4        NA
17         K5 H5 H5     0.125
> sapply(myd$Individual, relationAc)
    A     B     C     D     E     F     G    H1    H2    H3    H4    H5    K1 
1.000 0.000 0.500 0.000 0.250 0.375 0.000 0.125 0.125 0.125 0.125 0.125 0.125 
   K2    K3    K4    K5 
0.125 0.125 0.125 0.125 
> myd
   Individual P1 P2 relationA
1           A  0  0     1.000
2           B  0  0     0.000
3           C  A  B     0.500
4           D  0  0     0.000
5           E  C  D     0.250
6           F  C  E     0.375
7           G  0  0     0.000
8          H1  E  G     0.125
9          H2  E  G     0.125
10         H3  E  G     0.125
11         H4  E  G     0.125
12         H5  E  G     0.125
13         K1 H1 H1     0.125
14         K2 H2 H2     0.125
15         K3 H3 H3     0.125
16         K4 H4 H4     0.125
17         K5 H5 H5     0.125 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-16T17:47:48.617

### 编辑：

更简洁地说，您可以在一行代码中使用`sapply`和`rowSums`取消：`for-loop`

```
# Initialize values of relationA
myd$relationA <- 0
myd$relationA[myd$Individual=="A"] <- 1

# Calculate relationA
myd$relationA <-   myd$relationA + rowSums(sapply(myd$Individual, function(indiv) 
     myd$relationA[myd$Individual==indiv]/2 * ((myd$P1==indiv) + (myd$P2==indiv)))) 
```

* * *

你正在寻找这样的东西吗？

```
# Initialize values of relationA
myd$relationA <- 0
myd$relationA[myd$Individual=="A"] <- 1

# Iterate over all Individuals
for (indiv in myd$Individual) {

  indiVal <- myd$relationA[myd$Individual==indiv]

  # all columns handled at once, thanks to vectorization;  no need for myd$P1[i]
  myd$relationA <- myd$relationA  + 
                 indiVal/2 * ((myd$P1==indiv) + (myd$P2==indiv))
} 
```

**输出**

```
myd
   Individual P1 P2 relationA
1           A  0  0     1.000
2           B  0  0     0.000
3           C  A  B     0.500
4           D  0  0     0.000
5           E  C  D     0.250
6           F  C  E     0.375
7           G  0  0     0.000
8          H1  E  G     0.125
9          H2  E  G     0.125
... 
```

# ruby-on-rails - 配置 Warden 以在 RSpec 控制器规范中使用

> ID：13420923
> 
> 赞同：21
> 
> 时间：2012-11-16T16:51:26.700
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, warden

我能够使用 Devise 的`sign_in`方法在我的控制器规格中登录用户。但是现在我要从我的应用程序中删除 Devise，我不太确定如何仅使用 Warden 来获得类似的功能。

我应该如何设置`spec/spec_helper.rb`和相关`spec/support/*.rb`文件以使 Warden 在控制器规格内充分运行？

我尝试`spec/support/warden.rb`使用以下内容设置文件：

```
RSpec.configure do |config|
  config.include Warden::Test::Helpers

  config.after do
    Warden.test_reset!
  end
end 
```

然后我有`before`与此类似的调用来验证`user`工厂：

```
before { login_as FactoryGirl.create(:user) } 
```

但这是我一直看到的错误：

```
NameError:
  undefined method `user' for nil:NilClass 
```

此错误可追溯到我`authenticate_user!`在控制器中的方法：

```
def authenticate_user!
  redirect_to login_path, notice: "You need to sign in or sign up before continuing." if env['warden'].user.nil?
end 
```

我将不胜感激任何人都可以提供的任何指导。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-16T19:09:50.810

我不认为这个问题适用于我的情况，但确实适用：[Stubbing Warden on Controller Tests](https://stackoverflow.com/questions/9261191/stubbing-warden-on-controller-tests)

事实证明，Warden 没有包含在 RSpec 控制器规范中，所以你需要做一些魔法来解决它。

[Kentaro Imai](https://stackoverflow.com/users/1222666/kentaro-imai)的 Warden博客文章的[控制器测试助手特别有用。](http://kentaroimai.com/articles/1-controller-test-helpers-for-warden)这是我如何让它为 RSpec 工作的。

**第 1 步：**创建`spec/spec_helper/warden.rb`并粘贴这些内容，这些内容是 Kentaro 从 Devise 派生的：

```
module Warden
  # Warden::Test::ControllerHelpers provides a facility to test controllers in isolation
  # Most of the code was extracted from Devise's Devise::TestHelpers.
  module Test
    module ControllerHelpers
      def self.included(base)
        base.class_eval do
          setup :setup_controller_for_warden, :warden if respond_to?(:setup)
        end
      end

      # Override process to consider warden.
      def process(*)
        # Make sure we always return @response, a la ActionController::TestCase::Behavior#process, even if warden interrupts
        _catch_warden {super} || @response
      end

      # We need to setup the environment variables and the response in the controller
      def setup_controller_for_warden
        @request.env['action_controller.instance'] = @controller
      end

      # Quick access to Warden::Proxy.
      def warden
        @warden ||= begin
          manager = Warden::Manager.new(nil, &Rails.application.config.middleware.detect{|m| m.name == 'Warden::Manager'}.block)
          @request.env['warden'] = Warden::Proxy.new(@request.env, manager)
        end
      end

      protected

      # Catch warden continuations and handle like the middleware would.
      # Returns nil when interrupted, otherwise the normal result of the block.
      def _catch_warden(&block)
        result = catch(:warden, &block)

        if result.is_a?(Hash) && !warden.custom_failure? && !@controller.send(:performed?)
          result[:action] ||= :unauthenticated

          env = @controller.request.env
          env['PATH_INFO'] = "/#{result[:action]}"
          env['warden.options'] = result
          Warden::Manager._run_callbacks(:before_failure, env, result)

          status, headers, body = warden.config[:failure_app].call(env).to_a
          @controller.send :render, :status => status, :text => body,
            :content_type => headers['Content-Type'], :location => headers['Location']

          nil
        else
          result
        end
      end
    end
  end
end 
```

**第 2 步：**在块中`spec/spec_helper.rb`，`RSpec.configure`添加此行以包含新模块：

```
config.include Warden::Test::ControllerHelpers, type: :controller 
```

**第 3 步：**要在块中登录用户`before`，请使用类似于以下的语法：

```
before { warden.set_user FactoryGirl.create(:user) } 
```

**第 4 步：**确保`request.env['warden']`在控制器中引用，而不是`env['warden']`. 后者不适用于`test`环境中的控制器规格。

给今井健太郎的帽子小费，我有一天（或在另一种生活中）欠他一杯啤酒！

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-06-11T18:18:31.703

您正在尝试做的事情存在一个基本问题。Warden 是一个 Rack 中间件，但 RSpec 控制器规范甚至不包括 Rack，因为这些类型的规范并不意味着运行您的完整应用程序堆栈，而只是您的控制器代码。您可以使用单独的测试来测试您的中间件，但在这种情况下，我认为测试 Warden 本身是否有效是没有意义的。

要测试您是否正确配置了 Warden，您应该使用请求规范或集成规范（黄瓜、水豚或类似的）。

尽管在控制器规范中模拟 Warden 在技术上是可能的，但我认为它并没有给您带来太多好处，同时显着增加了测试代码的复杂性。请记住，Rack 中间件旨在以透明的方式运行，以便您可以轻松地根据需要交换中间件。实际上，您的控制器根本不应该直接依赖于 Warden（也许除了`ApplicationController`），因此对控制器的 Warden 测试依赖是封装损坏的标志。

我最近遇到了同样的问题，所以我希望这个评论会有用。

# python - 如何运行 ajax 请求处理程序龙卷风

> ID：13420927
> 
> 赞同：5
> 
> 时间：2012-11-16T16:51:38.290
> 
> 标签：python, tornado

我有一个处理程序不起作用，但它应该与 ajax 需要方向一起使用。

样本：

```
from tornado.web import RequestHandler

class MyHandler(RequestHandler):

    def get(self):
        self.write("ok!") 
```

如果不是 MyHandler == Ajax 请求，那么 Redirect "/" ??

谢谢你...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:53:19.457

所以; 您可以使用的**装饰器。**创造

> 装饰器.py

添加 is_ajax 函数；

```
# decorators.py
def is_ajax(method):

    @wraps(method)
    def wrapper(self, *args, **kwargs):
        if "X-Requested-With" in self.request.headers:
            if self.request.headers['X-Requested-With'] == "XMLHttpRequest":
                return method(self, *args, **kwargs)

        else:                                                                                                                                                                 
            self.redirect("/")                                                     

    return wrapper 
```

和

```
from tornado.web import RequestHandler
from decorators import is_ajax

class MyHandler(RequestHandler):

    @is_ajax # is_ajax decorators.
    def get(self):
        self.write("ok!") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-08T13:52:10.200

看看这个：这个应该更容易理解：

[https://github.com/zhanglongqi/TornadoAJAXSample](https://github.com/zhanglongqi/TornadoAJAXSample)

# .net - 如何使用 log4net 登录到 RichTextBox？

> ID：13420929
> 
> 赞同：3
> 
> 时间：2012-11-16T16:51:46.350
> 
> 标签：.net, c#-4.0, log4net

我想查看 Windows.Forms.RichTextBox 中显示的 log4net 条目。我正在考虑使用 MemoryAppender，但我不确定每次将其添加为事件时如何获取该条目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-16T18:30:18.670

[log4net](http://logging.apache.org/log4net/)本质上是一个推送模型，这并不明显（大多数人将方法调用与拉模型相关联），但我们可以将其更改为大多数 .NET 开发人员更熟悉的另一个推送模型（事件），并在上面构建另一个推送模型这使我们更容易订阅/取消订阅这些事件（可观察对象）。

您需要做的是创建接口的实现并将对[`IAppender`接口](http://logging.apache.org/log4net/release/sdk/html/T_log4net_Appender_IAppender.htm)实现的调用转换为事件。

让我们定义`EventArgs`您将用来指示事件已发生的类：

```
public class LogEventArgs : EventArgs
{
    public LogEventArgs(IEnumerable<LoggingEvent> loggingEvents)
    {
        // Validate parameters.
        if (loggingEvents == null) 
            throw new ArgumentNullException("loggingEvents");

        // Assign values.
        LoggingEvents = loggingEvents;
    }

    // Poor-man's immutability.
    public IEnumerable<LoggingEvent> LoggingEvents { get; private set; }
} 
```

值得注意的是，这暴露了一系列[`LoggingEvent`](http://logging.apache.org/log4net/release/sdk/html/T_log4net_Core_LoggingEvent.htm)实例，因为我们也希望支持该[`IBulkAppender`接口](http://logging.apache.org/log4net/release/sdk/html/T_log4net_Appender_IBulkAppender.htm)。

有了这个，我们可以创建一个`IAppender`. 请注意，您只需实现[两种方法](http://logging.apache.org/log4net/release/sdk/html/Methods_T_log4net_Appender_IAppender.htm)。两者中更重要的是[`DoAppend`](http://logging.apache.org/log4net/release/sdk/html/M_log4net_Appender_IAppender_DoAppend.htm)将调用转换为事件的位置：

```
public class EventAppender : AppenderSkeleton
{
    // Note, you will probably have to override other things here.

    // The lock for the event.
    private readonly object _eventLock = new object();

    // The backing field for the event.
    private EventHandler<LogEventArgs> _loggedEventHandlers;

    // Add and remove methods.
    public event Logged
    {
        add { lock(_eventLock) _loggedEventHandlers += value; }
        remove { lock(_eventLock) _loggedEventHandlers -= value; }
    }

    // Singular case.
    protected override void Append(LoggingEvent loggingEvent)
    {
        // Validate parameters.
        if (loggingEvent == null) 
            throw new ArgumentNullException("loggingEvent");

        // Call the override that processes these in bulk.
        Append(new [] { loggingEvent });
    }

    // Multiple case.
    protected override void Append(LoggingEvent[] loggingEvents)
    {
        // Validate parameters.
        if (loggingEvents == null)
            throw new ArgumentNullException("loggingEvents");

        // The event handlers.
        EventHandler<LogEventArgs> handlers;

        // Get the handlers.
        lock (_eventLock) handlers = _loggedEventHandlers;

        // Fire if not null.
        if (handlers != null) handlers(new LogEventArgs(loggingEvents);
    }
} 
```

一旦你有了这个，你可以[以编程方式附加 appender](https://stackoverflow.com/q/769983/50776)。以编程方式执行此操作可能更容易，因为它有助于查找要将事件附加到的实例。但是，如果这是您的偏好，[您可以遍历附加程序列表来找到它。](https://stackoverflow.com/questions/13420929/how-can-i-use-log4net-to-log-to-a-richtextbox/13422344#comment18343930_13422344)

然后，只需将此实例中的事件连接到将写入[`RichTextBox`](http://msdn.microsoft.com/en-us/library/system.windows.forms.richtextbox.aspx).

一旦你有了这个，你可以很容易地把它变成一个[`IObservable<T>`](http://msdn.microsoft.com/en-us/library/dd990377.aspx)实现，并扁平化所有的`LoggingEvent`实例。

首先，您将学习上面的课程，并`IObservable<LogEventArgs>`使用以下[`Observable.FromEvent`方法](http://msdn.microsoft.com/en-us/library/hh211795%28v=vs.103%29.aspx)创建一个：

```
// The appender that was added programmatically.
EventAppender appender = ...;

// Get the observable of LogEventArgs first.
IObservable<LogEventArgs> logEventObservable = 
    Observable.FromEvent<LogEventArgs>(
        a => appender.Logged += a, a => appender.Logged -= a); 
```

但此时，我们想让处理`LoggingEvent`类的单个实例变得更容易一些。*您的*代码没有理由必须这样做。这可以通过[`SelectMany`扩展方法](http://msdn.microsoft.com/en-us/library/hh211809%28v=vs.103%29.aspx)轻松完成：

```
// The observable of the individual LoggingEvent instances.
IObservable<LoggingEvent> loggingEvents = logEventObservable.
    SelectMany(e => e.LoggingEvents); 
```

从那里，您可以轻松地订阅`IObservable<LoggingEvent>`实例以在新事件出现时发布到 UI 线程：

```
// The RichTextBox.
RichTextBox rtb = ...;

// This code goes where you want to start subscribing.  This needs to be
// called on the UI thread, because you need the proper
// SynchronizationContext:
IObservable<LoggingEvent> synchronized = loggingEvents.ObserveOn(
    SynchronizationContext.Current);

// Subscribe to the event.  Store the result of this.
IDisposable unsubscribe = synchronized.
    // If you need to do anything fancier, then use the
    // LoggingEvent represented in e and update the
    // RichTextBox accordingly.
    Subscribe(e => rtb.AppendText(e.RenderedMessage)); 
```

然后，如果您想取消订阅（停止接收更新），您只需在调用返回的实现上调用该[`Dispose`方法](http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx)即可。[`IDisposable`](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)`Subscribe`

使用`IObservable<T>`here 的一些优点是：

*   回调到 UI 线程的编组由该`ObserveOn`方法为您处理。
*   您可以过滤/转换/等。序列通过使用[`System.Reactive.Linq`命名空间](http://msdn.microsoft.com/en-us/library/system.reactive.linq%28v=vs.103%29.aspx)中的扩展方法，特别是允许[在 C# 中使用查询表达式的](http://msdn.microsoft.com/en-us/library/bb397676.aspx)[`Observable`类](http://msdn.microsoft.com/en-us/library/system.reactive.linq.observable%28v=vs.103%29.aspx)的扩展方法。
*   实现的扩展`IObservable<T>`允许你做一些事情，比如缓冲（以防你一次收到*太多*消息）、滑动窗口等。
*   您可以轻松地将此事件流与其他事件流结合起来。

# python - PyQt - 从另一个线程修改 GUI

> ID：13420931
> 
> 赞同：5
> 
> 时间：2012-11-16T16:51:47.660
> 
> 标签：python, multithreading, user-interface, pyqt

我正在尝试从另一个线程修改我的主布局。但是函数 run() 从未被调用，我遇到了错误：

> QObject::setParent：无法设置父级，新父级在不同的线程中

这是我的代码：

```
class FeedRetrievingThread(QtCore.QThread):
    def __init__(self, parent=None):
        super(FeedRetrievingThread, self).__init__(parent)
        self.mainLayout = parent.mainLayout
    def run(self):
        # Do things with self.mainLayout

class MainWindow(QtGui.QDialog):
    def __init__(self, parent=None):  
        super(MainWindow, self).__init__(parent)
        self.mainLayout = QtGui.QGridLayout() 
        self.setLayout(self.mainLayout)  
        self.feedRetrievingThread = FeedRetrievingThread(self)
        self.timer = QtCore.QTimer()
        self.timer.timeout.connect(self.updateFeed)
        self.timer.start(1000)

    def updateFeed(self):
        if not self.feedRetrievingThread.isRunning():
            print 'Running thread.'
            self.feedRetrievingThread.start()

if __name__ == '__main__':  
    app = QtGui.QApplication(sys.argv)  
    mainWindow = MainWindow()  
    mainWindow.show()
    sys.exit(app.exec_()) 
```

我真的不明白，为什么用 PyQt 访问 GUI 这么难？在 C# 中，您有 Invoke。PyQt 中有类似的东西吗？

我尝试直接从`MainWindow.__init__`（不使用计时器）创建线程，但它也不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-16T18:41:51.143

在 Qt 中，您永远不应该尝试从 GUI 线程外部*直接*更新 GUI。

相反，让您的线程发出信号并将它们连接到从 GUI 线程中进行必要更新的槽。

请参阅有关[Threads 和 QObjects](https://doc.qt.io/qt-4.8/threads-qobject.html)的 Qt 文档。

# jquery - jQuery AJAX - 控制器的数据参数空白

> ID：13420932
> 
> 赞同：1
> 
> 时间：2012-11-16T16:51:48.737
> 
> 标签：jquery, asp.net, asp.net-mvc, asp.net-mvc-3

使用`ASP.NET MVC 3`，我正在做一个 jQuery ( `ver 1.7.1`) AJAX 调用，就像我做了十亿次一样。但是，我注意到了一些奇怪的事情。**以下调用工作正常**：

```
// license object
var license = {
    City: "New York",
    CompanyID: 1,
    County: "N/A",
    IsActive: true
};
// make the request
var $req = $.post('/License/theLicense', license); 
$req.success(function () {
    // this works!
});

[HttpPost]
public void Save(License theLicense)
{
    // save
} 
```

**但是，当我为控制器指定数据参数时，它不会在控制器上注册**

```
// license object
var license = {
    City: "New York",
    CompanyID: 1,
    County: "N/A",
    IsActive: true
};
// make the request
// this time the controller parameter is specified
// the object will be blank at the server
var $req = $.post('/License/theLicense', { theLicense: license });
$req.success(function () {
    // this does not work
}); 
```

**该对象在控制器处为空白，如下所示**

![在此处输入图像描述](../Images/df5826c8e598ff17b9d192028f451fdb.png)

这很烦人，因为我需要传递另一个数据参数，但由于这个问题我不能。

**注意：** JSON 与 POCO 相同。

**为什么当我指定数据参数时，对象在控制器上显示为空白，但当我不这样做时，它就好了？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-27T15:51:47.587

有时 POCO 反序列化器会因为奇怪的原因而流行起来。我以前见过我的 JSON 对象与 POCO 完全匹配的地方，但它仍然不会反序列化。

发生这种情况时，我通常将对象作为 JSON 字符串发送到服务器，然后在服务器上对其进行反序列化。我个人使用 ServiceStack.Text 因为它是最快的。

所以你的 jQuery 会是这样的：

```
var license = {
    City: "New York",
    CompanyID: 1,
    County: "N/A",
    IsActive: true
};

var $req = $.post('/License/theLicense', JSON.stringify(license)); 
```

然后你的控制器会接受一个字符串参数（json）来反序列化对象：

```
 [HttpPost]
   public void Save(string json)
   {
       License theLicense = JsonSerializer<License>.DeserializeJsonString(json);
       // save
   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T17:03:43.463

发生这种情况是因为您正在发送一个包含许可证的对象作为成员，但您的控制器需要一个`License` 对象。

您必须为您的数据声明一个包装类，如下所示：

```
 public Class MyWrapperClass
  {
      public License theLicense;
      //declare other extra properties here  
  } 
```

和你的控制器：

```
[HttpPost]
public void Save(MyWrapperClass thewrraper)
{
    var license = thewrapper.theLicense;
    // save
} 
```

**编辑：** 尝试用引号包围你的 json 对象的成员。例如（`{"theLicense": license }`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T17:42:01.440

试试这个：

JS：

```
// license object
var license = {
    City: "New York",
    CompanyID: 1,
    County: "N/A",
    IsActive: true
};

var $req = $.post('/License/Save', { theLicense: license });
$req.success(function () {
    // this does not work
}); 
```

。网

```
public class LicenseController: Controller 
{
   ...

   [HttpPost]
   public void Save(License theLicense)
   {
       // save
   }

   ...
} 
```

# applescript - Applescript 更改到文件夹保存对话框

> ID：13420933
> 
> 赞同：0
> 
> 时间：2012-11-16T16:51:49.110
> 
> 标签：applescript, save-dialog

我正在尝试在 applescript 中自动打开和保存文件。不过，我似乎无法通过保存对话框获得一致的结果。是否可以将保存对话框更改为 applescript 中的特定文件夹？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:06:26.210

一旦出现保存对话框，这可能会帮助您导航到文件夹：

```
set the clipboard to "/path/to/your/folder"

tell application "System Events" to tell process "SketchUp" -- I'm guessing on SketchUp name
    keystroke "G" using {command down, shift down}
    delay 1
    keystroke "v" using {command down}
    delay 1
    keystroke return
    delay 1
    keystroke return
    delay 1
end tell 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-13T07:23:43.213

我认为，您可以做到并保持剪贴板完好无损。例如，如果您的保存对话框在 TextEdit 中，如果您上次将某些内容保存到桌面，则以下内容会将您的目标更改回 Documents。使用起来更容易`⌘</kbd>+`D` for that, of course, but you can use substitute pretty much whatever path you need. If you have a path with a folder having non-AppleScript allowable characters in the path (such as quotes), you can escape each with the backslash ("\") character.`

```
tell application "TextEdit"
    activate
    try
        tell application "System Events"
            keystroke "g" using {shift down, command down}
            do shell script "sleep 0.2"
            keystroke "~/Documents"
            do shell script "sleep 0.2"
            keystroke return
        end tell
    end try
end tell 
```

# ios - 我从哪里获得 iPhone SDK

> ID：13420939
> 
> 赞同：0
> 
> 时间：2012-11-16T16:52:02.887
> 
> 标签：ios, webdriver

我正在尝试设置一些 WebDriver 测试以在 iPad 上运行，而且我玩得很开心。

Selenium 的说明说：现在，您将需要苹果的全套开发工具才能安装在您的设备上。

如上所述安装 iphone SDK 并配置您的构建环境。您还需要为您的设备安装和配置 Apple 的配置文件。

我从哪里获取 iPhone SDK 以安装到设备上？我在设备上的 App Store 上的任何地方都找不到它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T16:56:38.583

如果您有 Mac，则可以下载 XCode 4，其中包含为 iPhone 开发所需的所有内容，包括：

-IDE -性能分析 -iOS SDK -OSX SDK

[https://developer.apple.com/devcenter/ios/index.action](https://developer.apple.com/devcenter/ios/index.action)

要在您的设备上加载应用程序，您需要注册为开发人员才能访问*供应门户*。成为开发者需要 99 美元的年费，其中包括在 App Store 上的分发等。

# php - MySQL 用户使用现有数据更新行

> ID：13420940
> 
> 赞同：0
> 
> 时间：2012-11-16T16:52:07.057
> 
> 标签：php, mysql, sql-update

我正在开发一个 PHP Web 应用程序，它允许用户编辑从数据库中获取的值。用户单击“编辑”链接，字段将填充数据库中表中的数据（如果有）。如果没有任何数据，则所有字段都显示为空白。

当用户单击“保存”时，表单被提交到 POST，并且这些值通过“更新”查询保存到数据库中。

我通过检查“受影响的行”来检查查询结果。如果它等于 0，那么更改没有通过，我告诉用户。

但是，当用户使用该行已经包含的完全相同的值进行更新时，我遇到了一个小问题。

例如，我有 A 行，其中 A、B、C、D 列的值分别为 1、2、3、4。

如果用户编辑该行并使用值 1、2、3、4 提交，则该行不会受到影响，并且我的输出消息会说当“更新”与以前完全相同并且刚刚通过时查询失败美好的。

现在我坚持输出：

“更新后的值与旧值相同，或者表和列名有问题。检查日志。”

我向日志发送有关此错误的消息。然后我输出查询，以便用户可以看到。

问题是，我希望我的程序在遇到错误时能够提供信息。有没有办法让程序对与最初的行完全相同的更新进行分类..成功？

```
 // construct query, execute query, check if any rows have been affected
    $query = "UPDATE table SET status='$status', client='$client' WHERE key='$key'";
    $result = $conn->query($query);
    if(mysqli_affected_rows($conn) === 0)
    {
        echo "Something went wrong. Entry not updated. Check the logs.\n";
        echo $query;
        error_log(mysqli_error($conn));
    } 
```

我也考虑过只检查 if`$result === false`或`$result === true`if 条件，但这会起作用吗？

非常感谢任何见解。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:04:16.467

如果要检查查询是否有错误，可以检查`-1`而不是`0`.

如果[`mysqli_affected_rows`](http://php.net/manual/en/mysqli.affected-rows.php)返回`0`，则表示由于没有更改值或没有匹配`WHERE`条件，没有更新任何内容。如果您需要区分这两者，您可能需要进行额外的`SELECT`查询。

并且您需要使用带有绑定变量的准备好的语句来避免 sql 注入问题。

# matlab - 如何在matlab中快速bin数据

> ID：13420941
> 
> 赞同：1
> 
> 时间：2012-11-16T16:52:16.847
> 
> 标签：matlab

我有数十万行。我想要的是每 10 行，我想取它的平均值或装箱。我可以运行一个 for 循环来实现这个，但这需要很长时间。有没有更直接的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T17:13:43.110

这应该可以工作，只要你的向量的长度是 10 的倍数：

```
data = rand(100,1);
result = mean(reshape(data, 10, length(data)/10),1) 
```

如果长度不是 10 的倍数，您需要决定如何处理额外的元素，并为此添加一些特殊情况。

**更新**

受 Rody 解决方案的启发，只要第一个维度是 10 的倍数，以下将适用于任意维度的矩阵：

```
data = rand(100,3,2);
sz = size(data);
result = squeeze(mean(reshape(data, [10 sz(1)/10 sz(2:end)]),1)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T18:01:55.560

或者：

```
result = arrayfun(...
    @(x) mean(data(x:min(x+9,end),:),1), ...
    1:10:size(data,1), 'UniformOutput', false);
result = cat(1, result{:}); 
```

这对 . 中的确切行数不太敏感`data`。如果最后只剩下 6 行，它将平均这 6 行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T18:10:35.777

使用`y=smooth(x,10)`or`y=filter(ones(1,10), 1, x)`然后使用`y(1:10:end)`来选择每 10 个元素。

# c - 在C中生成随机整数，不在一个范围内

> ID：13420950
> 
> 赞同：2
> 
> 时间：2012-11-16T16:53:00.663
> 
> 标签：c, random

我想生成 100 个具有随机 x 和 y 坐标的节点。但我不想指定任何范围。像 rand(100) 只会生成 1 到 100 之间的数字。但我希望这些数字分布在一个大区域内，并且我希望它们是随机的。我如何使用 C 来实现它？我努力了：

```
 int gen_rand_position(void)  
{  
     int i,j,a[100],b[100];  
    for(i=0,j=0;i<100,j<100;i++,j++)  
{
    x=rand();  
        y=rand();  
    a[i]=x;  
    b[j]=y;  
}  
} 
```

这不是随机选择的。我可以有更有效的随机函数吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-16T16:55:14.093

您需要有一个范围，否则您将如何处理无限数？

没有参数 - rand() 将返回一个介于 0 和 RAND_MAX 之间的整数（通常为 32765）。

如果您需要一个大于此的数字，您可以组合两个 rand() 数字。关于组合随机数的最佳方法存在复杂的统计论据，因此您不会更改随机性，但我认为您无需担心这一点。

编辑：由于 RAND_MAX 是（在这种情况下）一个 15 位数字，要获得 30 位范围将两个 rand() 相乘，再获得 32 位范围相乘 - 它可能会环绕，但不会改变随机性（显着）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T17:11:26.217

要获得分布在整个`int`范围内的随机数，请将来自多次调用的随机位组合到`rand()`：

```
#include <stdlib.h>

int large_rand()
{
  const int RAND_BITS = 15;  /* covers stdc minimum for RAND_MAX */
  const int INT_BITS = 8 * sizeof(int);
  const int ITERS = (INT_BITS + RAND_BITS - 1) / RAND_BITS;
  int i, result = 0;
  for (i = 0; i < ITERS; i++) {
    result <<= RAND_BITS;
    result |= rand() & ~(~0U << RAND_BITS);
  }
  return result;
} 
```

要获得所需范围内的随机数，请使用`large_rand() % (MAX + 1)`，其中`MAX`是您想要获得的最大数。

# php - PHP CURL DELETE 请求

> ID：13420952
> 
> 赞同：111
> 
> 时间：2012-11-16T16:53:04.363
> 
> 标签：php, http, curl, request

我正在尝试使用 PHP 和 cURL 执行 DELETE http 请求。

我已经在很多地方阅读了如何做到这一点，但似乎没有什么对我有用。

我就是这样做的：

```
public function curl_req($path,$json,$req)
{
    $ch = curl_init($this->__url.$path);
    $data = json_encode($json);
    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, $req);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: application/json','Content-Length: ' . strlen($data)));
    $result = curl_exec($ch);
    $result = json_decode($result);
    return $result;
} 
```

然后我继续使用我的功能：

```
public function deleteUser($extid)
{
    $path = "/rest/user/".$extid."/;token=".$this->__token;
    $result = $this->curl_req($path,"","DELETE");
    return $result;

} 
```

这给了我 HTTP 内部服务器错误。在我的其他函数中，使用与 GET 和 POST 相同的 curl_req 方法，一切顺利。

那么我做错了什么？

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2013-07-29T22:52:04.480

我终于自己解决了这个问题。如果其他人遇到此问题，这是我的解决方案：

我创建了一个新方法：

```
public function curl_del($path)
{
    $url = $this->__url.$path;
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "DELETE");
    $result = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    curl_close($ch);

    return $result;
} 
```

**更新 2**

由于这似乎对某些人有所帮助，因此这是我的最终 curl DELETE 方法，它以 JSON 解码对象返回 HTTP 响应：

```
 /**
 * @desc    Do a DELETE request with cURL
 *
 * @param   string $path   path that goes after the URL fx. "/user/login"
 * @param   array  $json   If you need to send some json with your request.
 *                         For me delete requests are always blank
 * @return  Obj    $result HTTP response from REST interface in JSON decoded.
 */
public function curl_del($path, $json = '')
{
    $url = $this->__url.$path;
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "DELETE");
    curl_setopt($ch, CURLOPT_POSTFIELDS, $json);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    $result = curl_exec($ch);
    $result = json_decode($result);
    curl_close($ch);

    return $result;
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2017-06-09T12:49:18.067

调用 GET,POST,DELETE,PUT 各种请求，我创建了一个通用函数

```
function CallAPI($method, $api, $data) {
    $url = "http://localhost:82/slimdemo/RESTAPI/" . $api;
    $curl = curl_init($url);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);

    switch ($method) {
        case "GET":
            curl_setopt($curl, CURLOPT_POSTFIELDS, json_encode($data));
            curl_setopt($curl, CURLOPT_CUSTOMREQUEST, "GET");
            break;
        case "POST":
            curl_setopt($curl, CURLOPT_POSTFIELDS, json_encode($data));
            curl_setopt($curl, CURLOPT_CUSTOMREQUEST, "POST");
            break;
        case "PUT":
            curl_setopt($curl, CURLOPT_POSTFIELDS, json_encode($data));
            curl_setopt($curl, CURLOPT_CUSTOMREQUEST, "PUT");
            break;
        case "DELETE":
            curl_setopt($curl, CURLOPT_CUSTOMREQUEST, "DELETE"); 
            curl_setopt($curl, CURLOPT_POSTFIELDS, json_encode($data));
            break;
    }
    $response = curl_exec($curl);
    $data = json_decode($response);

    /* Check for 404 (file not found). */
    $httpCode = curl_getinfo($curl, CURLINFO_HTTP_CODE);
    // Check the HTTP Status code
    switch ($httpCode) {
        case 200:
            $error_status = "200: Success";
            return ($data);
            break;
        case 404:
            $error_status = "404: API Not found";
            break;
        case 500:
            $error_status = "500: servers replied with an error.";
            break;
        case 502:
            $error_status = "502: servers may be down or being upgraded. Hopefully they'll be OK soon!";
            break;
        case 503:
            $error_status = "503: service unavailable. Hopefully they'll be OK soon!";
            break;
        default:
            $error_status = "Undocumented error: " . $httpCode . " : " . curl_error($curl);
            break;
    }
    curl_close($curl);
    echo $error_status;
    die;
} 
```

> CALL 删除方法

```
$data = array('id'=>$_GET['did']);
$result = CallAPI('DELETE', "DeleteCategory", $data); 
```

> CALL 发布方法

```
$data = array('title'=>$_POST['txtcategory'],'description'=>$_POST['txtdesc']);
$result = CallAPI('POST', "InsertCategory", $data); 
```

> CALL 获取方法

```
$data = array('id'=>$_GET['eid']);
$result = CallAPI('GET', "GetCategoryById", $data); 
```

> CALL Put 方法

```
$data = array('id'=>$_REQUEST['eid'],'title'=>$_REQUEST['txtcategory'],'description'=>$_REQUEST['txtdesc']);
$result = CallAPI('POST', "UpdateCategory", $data); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-07T11:03:06.937

我自己的带有 wsse 身份验证的课程请求

```
class Request {

    protected $_url;
    protected $_username;
    protected $_apiKey;

    public function __construct($url, $username, $apiUserKey) {
        $this->_url = $url;     
        $this->_username = $username;
        $this->_apiKey = $apiUserKey;
    }

    public function getHeader() {
        $nonce = uniqid();
        $created = date('c');
        $digest = base64_encode(sha1(base64_decode($nonce) . $created . $this->_apiKey, true));

        $wsseHeader = "Authorization: WSSE profile=\"UsernameToken\"\n";
        $wsseHeader .= sprintf(
            'X-WSSE: UsernameToken Username="%s", PasswordDigest="%s", Nonce="%s", Created="%s"', $this->_username, $digest, $nonce, $created
        );

        return $wsseHeader;
    }

    public function curl_req($path, $verb=NULL, $data=array()) {                    

        $wsseHeader[] = "Accept: application/vnd.api+json";
        $wsseHeader[] = $this->getHeader();

        $options = array(
            CURLOPT_URL => $this->_url . $path,
            CURLOPT_HTTPHEADER => $wsseHeader,
            CURLOPT_RETURNTRANSFER => true, 
            CURLOPT_HEADER => false             
        );                  

        if( !empty($data) ) {
            $options += array(
                CURLOPT_POSTFIELDS => $data,
                CURLOPT_SAFE_UPLOAD => true
            );                          
        }

        if( isset($verb) ) {
            $options += array(CURLOPT_CUSTOMREQUEST => $verb);                          
        }

        $ch = curl_init();
        curl_setopt_array($ch, $options);
        $result = curl_exec($ch);                   

        if(false === $result ) {
            echo curl_error($ch);
        }
        curl_close($ch);

        return $result; 
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-12T11:36:23.637

```
switch ($method) {
    case "GET":
        curl_setopt($curl, CURLOPT_CUSTOMREQUEST, "GET");
        break;
    case "POST":
        curl_setopt($curl, CURLOPT_CUSTOMREQUEST, "POST");
        break;
    case "PUT":
        curl_setopt($curl, CURLOPT_CUSTOMREQUEST, "PUT");
        break;
    case "DELETE":
        curl_setopt($curl, CURLOPT_CUSTOMREQUEST, "DELETE"); 
        break;
} 
```

# ajax - 类路径中的 ICEfaces 库可防止在文件下载时弹出“另存为”对话框

> ID：13420958
> 
> 赞同：2
> 
> 时间：2012-11-16T16:53:22.553
> 
> 标签：ajax, jsf, jsf-2, download, icefaces

一旦我将库 icefaces.jar icepush.jar icefaces_ace.jar 添加到我的类路径以使用 ACE 组件，我的 SaveAs 对话框就不会弹出？我不确定这是否是一个错误，但没有类路径中的库它可以工作。这是我的另存为方法：

```
 public void downloadFile(String propertyPath) throws IOException {

     ProxyFile fileToDownload = repBean.downloadFile(propertyPath);

     FacesContext facesContext = FacesContext.getCurrentInstance();
     ExternalContext externalContext = facesContext.getExternalContext();
     HttpServletResponse response = (HttpServletResponse) externalContext.getResponse();

     response.reset();         response.setContentType(fileToDownload.getContentType()); 
     response.setHeader("Content-Length", String.valueOf(fileToDownload.getLength()));
     response.setHeader("Content-disposition", "attachment; filename=\"" + fileToDownload.getName() + "\""); 

     BufferedInputStream input = null;
     BufferedOutputStream output = null;

     try {
         input = new BufferedInputStream(fileToDownload.getContent());
         output = new BufferedOutputStream(response.getOutputStream());

         byte[] buffer = new byte[10240];
         for (int length; (length = input.read(buffer)) > 0;) {
            output.write(buffer, 0, length);
         }
     } finally {
         output.close();
         input.close();
         facesContext.responseComplete(); 
        }
     } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T18:36:13.857

您不能使用 ajax 下载文件。

Ajax 是由 JavaScript 的`XMLHttpRequest`对象执行的。请求将成功执行，响应将被成功检索。然而，JavaScript 无法将响应写入客户端的磁盘文件系统，也无法强制与给定响应进行“*另存为*”对话。那将是一个巨大的安全漏洞。

您的具体问题的原因是 ICEfaces 本身。也就是说，当您将 ICEfaces 集成到 JSF Web 应用程序中时，所有标准`<h:commandXxx>`链接/按钮都会默默地变成启用 ajax 的链接/按钮，这确实会引起初学者的混淆。确保下载链接/按钮没有隐式使用 ICEfaces 引入的 ajax 工具。根据他们[关于该主题的 wiki 页面](http://www.icesoft.org/wiki/display/ICE/Disabling+Ajax)，您需要显式嵌套 a`<f:ajax disabled="true">`以禁用此功能。

> ### 禁用组件的 Ajax
> 
> 您还可以在单​​个组件级别禁用 Ajax：
> 
> ```
> <h:commandButton value="Send" actionListener="#{bean.sendMessage}">
>     <f:ajax disabled="true"/>
> </h:commandButton> 
> ```

将其应用于您的下载链接/按钮。

# c++ - 链接错误（collect2：ld 返回 1）

> ID：13420963
> 
> 赞同：-1
> 
> 时间：2012-11-16T16:53:27.000
> 
> 标签：c++, linker, md5

好的，所以我一直在经历这个错误的各种案例，到目前为止，我还无法弄清楚这次是什么原因造成的（我有点阅读障碍，如果它盯着我的脸，我深表歉意) 我一直在寻找对此类问题的引用：[对 main 的未定义引用 - collect2：ld 返回 1 退出状态](https://stackoverflow.com/questions/7965437/undefined-reference-to-main-collect2-ld-returned-1-exit-status)和[QtCreator build 返回 collect2：ld 返回退出状态 1](https://stackoverflow.com/questions/1485239/qtcreator-build-returns-collect2-ld-returned-exit-status-1)但这些类型的情况似乎不适合。

我正在编写一个程序，它会在消息被编辑后自动重新签名。签名函数接收一些信息，使用 md5 对其进行哈希处理（我知道，但有遗留要求），然后使用 Base64 对输出进行编码（通过 const unsigned char* 获取一系列字节，以及消息的总大小）

我首先尝试了 MD5 的 Crypto++ 库，它会在未来为其他哈希和协议提供扩展。在链接阶段出现大量未定义的引用错误后，我尝试了我在网上找到的另一个 md5 实现。这个只给了我两个链接错误，但我认为它们可能是由相同的原因引起的，所以我将使用第二个库以节省帖子空间。

我用于消息签名的 C++ 代码片段：

```
string createMessageSignature(string input)
{
    //byte digest[ CryptoPP::MD5::DIGESTSIZE ];

    //CryptoPP::MD5().CalculateDigest( digest, (byte*) input.c_str(), input.length() );

    //cout << "md5 signature: " << digest << endl;

    //string encodedDigest = base64_encode(digest, 32);

    int size = md5(input).length();
    string stringDigest = md5(input);

    const unsigned char* digest = reinterpret_cast<const unsigned char*>(stringDigest.c_str());

    cout << "md5 signature hash: " << digest << endl;

    string encodedDigest = base64_encode(digest, size);

    cout << "signature base64 encoded: " << encodedDigest << endl;

    return encodedDigest;
} 
```

我目前正在使用的 md5 库在这里：[http](http://www.zedwood.com/article/121/cpp-md5-function) ://www.zedwood.com/article/121/cpp-md5-function （虽然我想最终转向 Crypto++，或者可能是 OpenSSL）。

来自链接器的错误消息（在 Win7 上使用 MinGW，但在 linux 环境中的 GCC 上也会发生）：

```
C:\Users\j********\Desktop\MessageSigner>C:/MinGW/bin/g++ -o MessageSigner.exe M
essageSigner.cpp
C:\Users\J****~1\AppData\Local\Temp\ccLejcEo.o:MessageSigner.cpp:(.text+0xc54):
 undefined reference to `md5(std::string)'
C:\Users\J****~1\AppData\Local\Temp\ccLejcEo.o:MessageSigner.cpp:(.text+0xc9f):
 undefined reference to `md5(std::string)'
collect2: ld returned 1 exit status 
```

有什么想法吗？一切似乎都已定义，并且代码可以编译。我从来没有太多调试链接器错误的经验。我一直在使用的唯一编译选项是 -o 文件名，'-o MessageSigner.exe'

-吉米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T17:05:18.663

您必须将您的程序与您正在使用的库链接起来。将 -lmd5 或您的库调用的任何内容添加到您的 g++ 命令，并在必要时添加库路径（选项 -Lpath）

如果您不使用库而是将 md5.h 和 md5.cpp 复制到源目录中，则必须将 md5.cpp 添加到编译器调用中。

# speech-recognition - 语音识别使用服务

> ID：13420967
> 
> 赞同：1
> 
> 时间：2012-11-16T16:53:33.250
> 
> 标签：speech-recognition, speech-to-text

我有一个在 Activity 中使用语音识别的 Android 应用程序。我想把它移植到一个服务上，这样我就可以在应用程序在后台运行时与它交谈。

但是，据我所知，语音识别服务必须使用 onActivityResult，这对于 Services 是不可用的。有没有办法在服务中包含一个活动而不显示其 GUI，或者在服务而不是活动中执行语音识别？

# delphi - 消息队列中的访问被拒绝

> ID：13420970
> 
> 赞同：2
> 
> 时间：2012-11-16T16:53:45.670
> 
> 标签：delphi, windows-services, delphi-2010, msmq

我在 Delphi 2010 中开发了一个从事务队列读取 XML 数据的应用程序。如果队列是本地或远程的，它工作正常，我不必在这两种情况下设置权限。

现在我必须将该应用程序转换为 Windows 服务。我将相同的应用程序复制并粘贴到服务代码中，但是当我尝试读取队列时，我收到“拒绝访问”错误。我正在本地机器上进行测试。

有人说这是权限问题。我在 Stack Overflow 中找到了一些针对相同问题的帖子，但我没有找到解决方案。

有任何想法吗？我也在使用 Windows 7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T04:40:01.620

如果您在本地运行该应用程序，则您是在您的 Windows 登录凭据下运行它。默认情况下，服务是在不同的用户帐户下启动的，该用户帐户的权限可能与您的帐户不同。

调出服务管理器（start->services.msc），在列表中找到您的服务，右键单击它并选择属性。然后选择登录选项卡并将其更改为特定的帐户名/密码。（使用您的帐户名/密码。）然后您将使用相同的凭据执行代码，因此您的访问被拒绝错误应该消失。

# ruby-on-rails - Rails：在一个模型中创建的数组，从另一个模型中的形式到达

> ID：13420973
> 
> 赞同：0
> 
> 时间：2012-11-16T16:53:47.873
> 
> 标签：ruby-on-rails, arrays, forms, select, models

我有一个带有选择选项的订单模型（orders_form.html.erb）的表单视图：

```
<%= f.select :pay_type, PaymentType.array_of_payment_types,
             :prompt => 'Select a payment method' %> 
```

PaymentType 是另一个模型， .array_of_payment_types 是根据 payment_type_name 列中的条目创建的数组，如下所示：

```
def self.array_of_payment_types
  @array_of_payment_types ||= PaymentType.pluck(:pay_type_name)
end 
```

...来自模型\payment_type.rb

但我得到一个 proc 'empty?' 错误：

> 未定义的方法“空？” 为了 ＃

我希望我的问题很清楚，似乎有一个明显的解决方案，但到目前为止我还没有找到一个阅读其他问题的人......

我将更新模型中的关系......

我的模型：

付款类型.rb：

```
class PaymentType < ActiveRecord::Base
  attr_accessible :pay_type_name

  has_many :orders

  validates :pay_type_name, :uniqueness

  def self.names
    all.collect { |pt| pt.pay_type_name }
  end 

  def self.array_of_payment_types
    PaymentType.all.map{ |p| [p.pay_type_name, p.id] }
  end
end 
```

订单.rb：

```
class Order < ActiveRecord::Base
  attr_accessible :address, :email, :name, :pay_type, :payment_type_id, :cart_id, 
                  :product_id

  has_many :line_items, :dependent => :destroy
  belongs_to :payment_type

  #PAYMENT_TYPES = ['Check','Purchase order','Credit card']

  validates :name, :address, :email, :presence => true
  validates  :pay_type,
             :presence => true,
             :inclusion => { :in => proc { PaymentType.array_of_payment_types } }

  def add_line_items_from_cart(cart)
    cart.line_items.each do |item|
      item.cart_id = nil
      line_items << item
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T17:03:37.860

尝试使用[options_for_select](http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/options_for_select)：

```
# in the view:
<%= f.select :pay_type, options_for_select(PaymentType.array_of_payment_types),
         :prompt => 'Select a payment method' %>

# in the PaymentType model:
def self.array_of_payment_types
  PaymentType.all.map{ |p| [p.pay_type_name, p.id] }
end 
```

您还需要更新 Order 模型中的 validates 语句：

```
validates  :pay_type,
           :presence => true,
           :inclusion => { :in => proc { PaymentType.pluck(:pay_type_name) } } 
```

# javascript - 使用 js 数组为 Leaftlet 标记创建弹出内容

> ID：13420974
> 
> 赞同：2
> 
> 时间：2012-11-16T16:53:52.237
> 
> 标签：javascript, popup, leaflet

在我的leaflet.js 脚本中，我有一个已成功为其创建标记的位置数组。我还想使用 bind.Popup 函数来显示存储在数组中的内容。要对 bind.Popup 内容进行编码，它似乎只适用于 HTML 段落标记，但我希望引用数组中的第三项。我不确定这是否必须改为在 HTML 中完成，但任何帮助将不胜感激，因为我是 Java 新手！这是一段代码供参考，（我计划添加更多位置和内容，但想先弄清楚代码）：

```
var locations = [
["Warren", 43.059908,-89.442229, "Barn"],
["Brunsell", 43.058618,-89.442032, "House"],
["Jacobs", 43.058618,-89.441726, "Jacobs/Usonia 1"]
];

var marker, i
for (i = 0; i < locations.length; i++){

    var markerLocation = new L.LatLng(locations[i][1], locations[i][2]);
    marker = new L.Marker(markerLocation);
    westmorland.addLayer(marker);

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:59:26.177

也许我在这里误解了你，但我很确定以下应该有效。

```
var marker, i;

for (i = 0; i < locations.length; i++){
  var markerLocation = new L.LatLng(locations[i][1], locations[i][2]);
  marker = new L.Marker(markerLocation);
  marker.bindPopup(locations[i][3]);
  westmorland.addLayer(marker);
}; 
```

# php - 如果我只允许整数，我需要使用 xss_clean 吗？

> ID：13420976
> 
> 赞同：1
> 
> 时间：2012-11-16T16:53:56.870
> 
> 标签：php, codeigniter

这只是我想知道的事情。

如果我有一个规则，我只允许整数作为输入，例如：

```
$this->form_validation->set_rules('item_id', 'item id', 'required|is_natural_no_zero'); 
```

有必要在上面运行 xss_clean 吗？我不明白在这种情况下 XSS 怎么可能是一个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T16:57:29.653

不，你可能不需要。使用 XSS 清理功能更适合人们可以输入文本和符号的输入。如果您只需要 int 或 alpha 或字母数字，则不允许他们输入将成为 XSS 一部分的符号。另一方面，如果你想通过 XSS 过滤器运行每一个输入，它不会受到伤害。

# c# - WebClient UploadFileAsync 报告中的奇怪行为

> ID：13420983
> 
> 赞同：10
> 
> 时间：2012-11-16T16:54:30.943
> 
> 标签：c#, webclient, system.net

我需要一些关于奇怪 WebClient.UploadFileAsync() 行为的帮助。我正在使用 POST 方法将文件上传到远程 HTTP 服务器（nginx）。POST 通过 PHP 脚本（地址指代）进行处理。

我有这个简单的代码

```
public void uploadFile(string filePath)
{
    webClient = new WebClient();
    webClient.Credentials = new NetworkCredential(Constant.HTTPUsername,Constant.HTTPPassword);
    webClient.Headers.Add("Test", TestKey);
    webClient.UploadProgressChanged += webClient_UploadProgressChanged;
    webClient.UploadFileCompleted += webClient_UploadFileCompleted;

    try
    {
        webClient.UploadFileAsync(new Uri(Address), "POST", filePath);
    }
    catch (Exception error)
    {
        throw new CustomException(error.Message);
    }
} 
```

在 UploadProgressChanged 中，我只需使用给定的 ProgressPercentage 更新 progressBar。第一个问题是报告的进度百分比，任何文件大小都是：

```
[17.38.14] Progress: 0 Bytes Sent: 175 / 269264
[17.38.14] Progress: 1 Bytes Sent: 8367 / 269264
[17.38.14] Progress: 3 Bytes Sent: 16559 / 269264
[17.38.14] Progress: 4 Bytes Sent: 24751 / 269264
[17.38.14] Progress: 6 Bytes Sent: 32943 / 269264
[17.38.14] Progress: 7 Bytes Sent: 41135 / 269264
[17.38.14] Progress: 9 Bytes Sent: 49327 / 269264
[17.38.14] Progress: 10 Bytes Sent: 57519 / 269264
[17.38.14] Progress: 12 Bytes Sent: 65711 / 269264
[17.38.14] Progress: 13 Bytes Sent: 73903 / 269264
[17.38.14] Progress: 15 Bytes Sent: 82095 / 269264
[17.38.14] Progress: 16 Bytes Sent: 90287 / 269264
[17.38.14] Progress: 18 Bytes Sent: 98479 / 269264
[17.38.15] Progress: 19 Bytes Sent: 106671 / 269264
[17.38.15] Progress: 21 Bytes Sent: 114863 / 269264
[17.38.15] Progress: 22 Bytes Sent: 123055 / 269264
[17.38.15] Progress: 24 Bytes Sent: 131247 / 269264
[17.38.15] Progress: 25 Bytes Sent: 139439 / 269264
[17.38.15] Progress: 27 Bytes Sent: 147631 / 269264
[17.38.16] Progress: 28 Bytes Sent: 155823 / 269264
[17.38.16] Progress: 30 Bytes Sent: 164015 / 269264
[17.38.16] Progress: 31 Bytes Sent: 172207 / 269264
[17.38.16] Progress: 33 Bytes Sent: 180399 / 269264
[17.38.16] Progress: 35 Bytes Sent: 188591 / 269264
[17.38.16] Progress: 36 Bytes Sent: 196783 / 269264
[17.38.17] Progress: 38 Bytes Sent: 204975 / 269264
[17.38.17] Progress: 39 Bytes Sent: 213167 / 269264
[17.38.17] Progress: 41 Bytes Sent: 221359 / 269264
[17.38.17] Progress: 42 Bytes Sent: 229551 / 269264
[17.38.17] Progress: 44 Bytes Sent: 237743 / 269264
[17.38.17] Progress: 45 Bytes Sent: 245935 / 269264
[17.38.17] Progress: 47 Bytes Sent: 254127 / 269264
[17.38.18] Progress: 48 Bytes Sent: 262319 / 269264
[17.38.18] Progress: 49 Bytes Sent: 269220 / 269264
[17.38.18] Progress: 50 Bytes Sent: 269264 / 269264
[17.38.25] Progress: -50 Bytes Sent: 269264 / 269264
[17.38.25] Progress: 100 Bytes Sent: 269264 / 269264
[17.38.25] FileCompleted event raised! 
```

所以，在网上搜索，我发现从 50->100 的跳跃只是百分比报告中的一个设计选择......所以我很好。奇怪的问题是，即使在 50%（发送整个文件时），网络接口仍然会产生流量并且仍在上传。事实上，从上面日志中的时间可以看出，文件发送后需要 7 秒才能引发 UploadFileCompletedEvent..事实上，与此同时，我仍然通过 HTTP 发送文件。

这里的问题是我无法可靠地更新我的 UI：进度条会增长到 50%，但随后会卡住等待上传完成（这是一种不好的行为，因为对于大文件，这个时间会显着增长）。

问题是：如何可靠地让用户了解文件上传进度？

谢谢。

PS该方法工作得很好，文件已正确上传到远程服务器。唯一的问题是进度报告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-20T10:25:30.007

我刚刚发现了问题：它在基本的 HTTP 身份验证中。出于某种奇怪的原因，即使我指定了凭据，WebClient 也会提交第一个 POST 请求而没有在 HTTP 标头中指定凭据。在服务器回复 auth-request 后，它会提交第二个 POST 请求，正确指定凭据。在这 2 次重试中，我的应用程序发送了 2 次文件！（这就是为什么即使在文件完全发送后我也经历了上传活动）

解决方案是通过手动添加 Authentication 标头（并删除 WebClient.Credentials.. 行）来强制 HTTP 基本身份验证：

```
string authInfo = userName + ":" + userPassword;
authInfo = Convert.ToBase64String(Encoding.Default.GetBytes(authInfo));
req.Headers["Authorization"] = "Basic " + authInfo; 
```

这样，第一个（也是唯一的）POST 请求将使用 Authentication 标头正确提交，并且报告进度正确（仅用于共享，出于上述原因，我在进度栏中将进度报告为（e.ProgressPercentage * 2）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T22:54:28.170

```
string authInfo = userName + ":" + userPassword;
authInfo = Convert.ToBase64String(Encoding.Default.GetBytes(authInfo));
req.Headers["Authorization"] = "Basic " + authInfo; 
```

将此放置在您的发布请求的开头，`e.ProgressPercentage * 2`用于您的进度报告。

# php - php socket 偶尔无响应并且没有抛出错误

> ID：13420985
> 
> 赞同：1
> 
> 时间：2012-11-16T16:54:35.793
> 
> 标签：php, sockets, apache-flex

我已经在服务器端和客户端使用`MySQL`and编写了一个数据库应用程序。我使用 php 套接字让它在对数据库进行更改时自动更新所有客户端。`PHP``Flex`

整个系统运行顺畅，但套接字似乎时不时停止响应。奇怪的是连接仍然很好——客户端执行的任何更改都已实现，但套接字不会广播消息。套接字文件没有抛出任何错误（尽管当我从套接字运行 error_log 时会出现这些消息）。服务器上套接字的内存使用不会改变，也不会发送断开信号。更奇怪的是，大约半小时左右后，套接字最终再次开始工作。如果我重新启动也可以解决问题的套接字。

我正在研究一个 hacky 解决方案，允许客户端在套接字变得无响应时重新启动它，但这并不令人满意并且容易出错。我真正想要的是了解为什么会发生这种情况。在一定数量的连接后，套接字是否会以某种方式“饱和”？我应该做些什么来清理套接字服务器吗？我尝试了三种不同的物理服务器（一台本地服务器和两台在线服务器）并且发生了同样的事情，所以肯定是我。

我觉得我做错了一些基本的事情。这是我用于套接字服务器的代码（它是 Raymond Fain 在 kirupa.com 上编写的稍微修改过的套接字版本，所以我将他的原始评论留在了顶部）：

```
#!/usr/bin/php -q
<?php
/*
Raymond Fain
Used for PHP5 Sockets with Flash 8 Tutorial for Kirupa.com
For any questions or concerns, email me at ray@obi-graphics.com
or simply visit the site, www.php.net, to see if you can find an answer.
*/

//ini_set('display_errors',1);
//ini_set('display_startup_errors',1);
error_reporting(E_ALL);
ini_set('error_log', 'socket_errors.log');
ini_set('log_errors', 'On');
ini_set('display_errors', 'Off');

set_time_limit(0);

ob_implicit_flush();

error_log('testing');

$address = 'xxx.xxx.xx.xx';
$port = xxxxx;

function send_Message($allclient, $socket, $buf)
{
    $buf = str_replace("\0","",$buf);
    //echo "<mbFeed>$buf</mbFeed>\n\0";
    foreach($allclient as $client)
    {
        socket_write($client, "<mbFeed>$buf</mbFeed>\n\0");
    }
}

echo "connecting...
";
//---- Start Socket creation for PHP 5 Socket Server -------------------------------------

if (($master = socket_create(AF_INET, SOCK_STREAM, SOL_TCP)) < 0)
{
    echo "socket_create() failed, reason: " . socket_strerror($master) . "\n";
}

socket_set_option($master, SOL_SOCKET,SO_REUSEADDR, 1);

if (($ret = socket_bind($master, $address, $port)) < 0)
{
    echo "socket_bind() failed, reason: " . socket_strerror($ret) . "\n";
}

echo 'socket bind successfull.
';

if (($ret = socket_listen($master, 5)) < 0)
{
    echo "socket_listen() failed, reason: " . socket_strerror($ret) . "\n";
}

$read_sockets = array($master);

echo "connected.";

//---- Create Persistent Loop to continuously handle incoming socket messages ---------------------
while (true)
{ 
    $changed_sockets = $read_sockets;
    $num_changed_sockets = socket_select($changed_sockets, $write = NULL, $except = NULL, NULL);
    foreach($changed_sockets as $key => $socket)
    {
        if ($socket == $master)
        {
            if (($client = socket_accept($master)) < 0)
            {
                echo "socket_accept() failed: reason: " . socket_strerror($msgsock) . "\n";
                continue;
            } 
            else
            {
                array_push($read_sockets, $client);
            }
        }
        else
        {
            $bytes = socket_recv($socket, $buffer, 8192, 0);

            if ($bytes == 0)
            {
                unset($read_sockets[$key]);
                unset($changed_sockets[$key]);
                socket_close($socket);
            }
            else
            {
                $allclients = $read_sockets;
                array_shift($allclients);
                //any messages starting with ::: are not to be broadcast, and may be used for other things. This message
                //usually comes from the client.
                if (substr($buffer, 0, 3) == ":::") handleSpecial(substr($buffer, 3));
                else
                {
                    //otherwise the message comes from a php file that will be closed, so the socket needs to be closed.
                    unset($read_sockets[$key]);
                    unset($changed_sockets[$key]);
                    socket_close($socket);
                    send_Message($allclients, $socket, $buffer);
                }
            }
        }
    }
}

function handleSpecial($message)
{
    error_log($message);
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:18:42.683

由于正在使用的套接字似乎阻塞了调用，`socket_recv()`因此在读取请求的数据量之前可能不会返回。并且这不处理任何其他读取套接字，包括接受套接字。

为了解决这个问题`socket_set_nonblock()`，让套接字畅通无阻。请注意，`socket_recv()`对非阻塞套接字的调用可能返回读取的字节数少于请求的字节数，因此应跟踪每个套接字的读取数据量。

# c++ - boost::assign::list_of 没有重载函数接受 2 个参数错误

> ID：13420987
> 
> 赞同：2
> 
> 时间：2012-11-16T16:54:44.280
> 
> 标签：c++, boost

为什么这会给出错误：`Test::Test: no overloaded function takes 2 arguments`

```
class Test
{
public:
    Test(const std::vector<int>&)
    {
    }
};

Test test(boost::assign::list_of(4)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T17:52:00.000

boost::assign::list_of 的实现需要容器类型，在本例中是您的 Test 类，具有两个参数构造函数，该构造函数采用第一个和最后一个迭代器（也称为范围）来初始化容器。

具体来说，错误来自下一行，在 boost::assign_detail::converter 类的转换方法中返回容器：

```
 template< class Container >
    Container convert( const Container*, default_type_tag ) const
    {
        return Container( begin(), end() );
    } 
```

hmjd 的解决方法成功的原因是 std::vector 有一个构造函数需要两个迭代器。

# python - Python GUI 事件

> ID：13420988
> 
> 赞同：0
> 
> 时间：2012-11-16T16:54:44.183
> 
> 标签：python, events, wxpython, wxwidgets

我敢肯定这个问题之前已经被问过很多次了，所以我提前道歉。我根本无法通过谷歌或搜索堆栈溢出找到答案。

我正在使用 wx 库在 python 中工作。`wx.EVT_CHAR`无论焦点如何，只要用户按下一个键，我只需要抛出一个。如何实现？有没有办法绑定所有的小部件？或者当应用程序收到按键时总是抛出事件的方法？

我尝试绑定应用程序本身、主框架和主面板。这些都没有完成在`wx.EVT_CHAR`按下键时总是抛出 a 的工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:48:57.807

我能够通过编写一个递归方法来解决我的问题，该方法将每个小部件设置为接收字符并将每个小部件绑定到我的回调函数。这很简单，但我在谷歌上搜索了一下才意识到并非每个小部件都可以固有地接收文本事件（例如按钮）。希望这将在未来节省一些时间。需要注意的是，只有作为传递的父窗口的子窗口或子窗口的小部件才会绑定到回调方法。

```
def __RecursiveBinding(self, parent):
    try:
        parent.Bind(wx.EVT_CHAR, self.CharInputCallback)
        parent.SetWindowStyleFlag(wx.WANTS_CHARS)
        parent.Refresh()

        children = parent.GetChildren()

        if(children):
            for child in children:
                self.__RecursiveBinding(child) 
```

# c# - 如何在 wpf 的分层数据模板中显示树视图项的上下文菜单

> ID：13420994
> 
> 赞同：12
> 
> 时间：2012-11-16T16:54:56.077
> 
> 标签：c#, wpf, treeview, contextmenu

如何使用分层数据模板在 wpf 中显示树视图项的上下文菜单？如何仅为 CountryTemplate 显示上下文菜单：

```
 <HierarchicalDataTemplate  x:Key="DispTemplate">
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="{Binding Path=Label}" Style="{StaticResource TreeTextStyle}" ToolTip="{Binding Path=Description}" Tag="{Binding Path=Tag}">
            </TextBlock>
        </StackPanel>
    </HierarchicalDataTemplate>
    <HierarchicalDataTemplate  x:Key="BuildingTemplate"  ItemsSource="{Binding Path=Building}" ItemTemplate="{StaticResource BuildingTemplate}">
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="{Binding Path=Label}" Style="{StaticResource TreeTextStyle}" ToolTip="{Binding Path=Description}"/>
        </StackPanel>
    </HierarchicalDataTemplate>
    <HierarchicalDataTemplate  x:Key="CityTemplate"  ItemsSource="{Binding Path=City}" ItemTemplate="{StaticResource CityTemplate}">
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="{Binding Path=Label}" Style="{StaticResource TreeTextStyle}" ToolTip="{Binding Path=Description}"/>
        </StackPanel>
    </HierarchicalDataTemplate>
    <HierarchicalDataTemplate x:Key="CountryTemplate" ItemsSource="{Binding Path=Country}" ItemTemplate="{StaticResource CountryTemplate}">
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="{Binding Path=RootName}" Style="{StaticResource TreeTextStyle}" ToolTip="{Binding Path=Description}"/>
        </StackPanel>
    </HierarchicalDataTemplate> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-16T19:39:44.700

您还可以将 添加`ContextMenu`到数据模板中的任何可视子项中，例如：

```
<HierarchicalDataTemplate x:Key="CountryTemplate" ItemsSource="{Binding Path=Country}" ItemTemplate="{StaticResource CountryTemplate}">
    <StackPanel Orientation="Horizontal">
        <StackPanel.ContextMenu>
            <ContextMenu>
                 <MenuItem Header="Header" Command="{Binding Command}"/> <!--This command should be in the data context (each country item)-->
            </ContextMenu>
        </StackPanel.ContextMenu>
        <TextBlock Text="{Binding Path=RootName}" Style="{StaticResource TreeTextStyle}" ToolTip="{Binding Path=Description}"/>
    </StackPanel>
</HierarchicalDataTemplate> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-03T23:12:19.167

上下文菜单无法尽可能干净地工作的原因之一是因为默认情况下，它们与其他所有内容位于不同的可视化树中，因此`DataContext`无法找到。

> 关键的见解是创建一个`<Style>`定义上下文菜单的样式，然后将该样式附加到目标元素，从而连接上下文菜单。*这会将上下文菜单转换为与您想要**的默认值对齐的可视树。`DataContext`*

首先，创建样式：

```
<UserControl.Resources>                                                                                                                        
    <ResourceDictionary>

        <!-- For the context menu to work, we must shift it into a style, which means that the context menu is now in a
        visual tree that is more closely related to the current data context. All we have to do then is set the style, 
        which hooks up the context menu. -->
        <Style x:Key="ContextMenuStyle" TargetType="{x:Type StackPanel}">
            <Setter Property="ContextMenu" Value="{DynamicResource TreeViewContextMenu}"/>
        </Style>
        <ContextMenu x:Key="TreeViewContextMenu">
            <MenuItem Header="Test" Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}, Path=DataContext.CmdDisplayDetailsGraph}"/>
        </ContextMenu> 
```

然后，将上下文菜单连接到您想要的任何位置，而不会遇到由不同的视觉树引起的问题。

示例 1：

```
<HierarchicalDataTemplate DataType="{x:Type snapshot:Details}" ItemsSource="{Binding DetailsList}">
    <StackPanel Orientation="Vertical" Style="{StaticResource ContextMenuStyle}">
        <ContentPresenter Content="{Binding}" ContentTemplate="{Binding View.DefaultDataRowTemplate}" />
</StackPanel> 
```

示例 2：

```
<DataTemplate DataType="{x:Type snapshot:InstrumentDetails}">
  <StackPanel Orientation="Vertical" Style="{StaticResource ContextMenuStyle}">                 
      <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center"> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-16T17:04:18.673

```
<HierarchicalDataTemplate x:Key="CountryTemplate" ItemsSource="{Binding Path=Country}" ItemContainerStyle="{StaticResource CountryTemplateItemContainerStyle}" ItemTemplate="{StaticResource CountryTemplate}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding Path=RootName}" Style="{StaticResource TreeTextStyle}" ToolTip="{Binding Path=Description}" />
                        </StackPanel>
</HierarchicalDataTemplate>

<Style x:Key="CountryTemplateItemContainerStyle" TargetType="{x:Type TreeViewItem}">
<Setter Property="ContextMenu" Value="{DynamicResource TreeViewContextMenu}"/>
</Style>
 <ContextMenu x:Key="TreeViewContextMenu">
        <MenuItem .../>
 </ContextMenu> 
```

如您所见，您可以在 HierarchicalDataTemplate 的 Itemcontainerstyle 中添加上下文菜单

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-19T22:56:20.007

基本上我想出了这个

```
<HierarchicalDataTemplate  x:Key="ChildTemplate">
            <StackPanel Orientation="Horizontal">
                <StackPanel.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Copy" CommandParameter="{Binding CopyTag}">
                        </MenuItem>
                        <MenuItem Header="Paste" CommandParameter="{Binding PasteTag}">
                        </MenuItem>
                        <ContextMenu.ItemContainerStyle>
                            <Style TargetType="MenuItem">
                                <Setter Property="Command" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}, Path=DataContext.CopyPaste}"/>
                            </Style>
                        </ContextMenu.ItemContainerStyle>
                    </ContextMenu>
                </StackPanel.ContextMenu>
                <Image Source="/Images/Child.png" Stretch="None" VerticalAlignment="Center" HorizontalAlignment="Center" Style="{StaticResource TreeIconStyle}"/>
                <TextBlock Text="{Binding Path=Label}" Style="{StaticResource TreeTextStyle}" ToolTip="{Binding Path=Description}" Tag="{Binding Path=Tag}">
                </TextBlock>
            </StackPanel>
        </HierarchicalDataTemplate> 
```

并具有用于复制和粘贴的单独参数，以区分单个命令中的复制和粘贴。

# asp.net-mvc - 在自定义模型活页夹中保存/处理文件是个坏主意吗？

> ID：13420996
> 
> 赞同：0
> 
> 时间：2012-11-16T16:55:08.570
> 
> 标签：asp.net-mvc, model-binding

我正在尝试找出为我的模型处理文件上传的最佳方法。

我的实体层中有一个对象，它有一个文件名字段来存储有关保存到文件系统的上传文件的信息。我不想在我的对象上为 HttpPostedFileBase 创建属性。

通常，我会在上传文件的操作中添加另一个参数，然后手动将其复制到我的对象中。但是，在默认模型绑定发生后，所有这些都发生在我的控制器中。

我在想我可以创建一个自定义模型绑定器来处理上传流，调整图像大小并将其保存到驱动器。然后它将对象的属性设置为具有正确的文件名。

这似乎是一种不好的做法？有更好的想法吗？我真的不想为这个回发设置一个 ViewModel，因为我所有的数据注释都在我的实体对象上。

# eclipse - 需要在 Eclipse 工作区中运行一个批处理文件

> ID：13420998
> 
> 赞同：0
> 
> 时间：2012-11-16T16:55:13.217
> 
> 标签：eclipse, maven

我有一个包含多个项目的工作区。都是 Maven 项目。其中一个项目的目标目录在构建后包含一个批处理文件。现在，我需要工作区中的其他项目之一来运行此批处理文件。因此，我想以编程方式获取当前工作区的路径，而不需要引入新的依赖项来完成此操作。有人知道这样做的方法吗？

编辑 1：我在工作区中有一个父 Maven 项目。其子目标目录之一包含批处理文件。父项（这是一个测试项目）的不同子项需要运行批处理文件。如果我使用 Eclipse 运行单个测试，我可以使用 Maven basedir 变量来获取不漂亮且不起作用的批处理文件。所以我想避免这种解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T21:45:17.097

[maven-antrun-plugin](http://maven.apache.org/plugins/maven-antrun-plugin/)怎么样？它不漂亮，但它完成了工作：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-antrun-plugin</artifactId>
    <version>1.7</version>
    <executions> 
        <execution> 
            <id><!-- insert an id --></id> 
            <phase><!-- insert a maven lifecycle phase --></phase> 
            <configuration> 
                <tasks> 
                    <exec 
                        dir="${basedir}" 
                        executable="${basedir}/src/main/sh/your-script.sh" 
                        failonerror="true"> 
                        <arg line="arg1 arg2 arg3" /> 
                    </exec> 
                </tasks> 
            </configuration> 
            <goals> 
                <goal>run</goal> 
            </goals> 
        </execution> 
    </executions>
</plugin> 
```

参考：[http ://maven.apache.org/plugins/maven-antrun-plugin/usage.html](http://maven.apache.org/plugins/maven-antrun-plugin/usage.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T17:29:58.010

您将遇到的问题是 Eclipse 中的项目不一定存储在工作区目录中；它们可以在文件系统上的任何位置。这意味着仅仅知道工作区的位置不一定能帮助您找到批处理文件。

例如：我的工作区是`$HOME/workspace`，但我所有的项目（工作副本）都在`$HOME/code/project`. 能够确定工作空间并不是很有帮助。项目可以存在于工作区之外，并且仍然可以使用*File -> Import*出现在 Eclipse 中。

您最好的选择可能是使用build-helper-maven-plugin的[attach-artifact目标将批处理文件“附加”到构建中。](http://mojo.codehaus.org/build-helper-maven-plugin/attach-artifact-mojo.html)[这里](http://mojo.codehaus.org/build-helper-maven-plugin/usage.html#Attach_additional_artifacts_to_your_project)有一个如何做到这一点的例子。

```
 <plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>build-helper-maven-plugin</artifactId>
    <version>1.7</version>
    <executions>
      <execution>
        <id>attach-artifacts</id>
        <phase>package</phase>
        <goals>
          <goal>attach-artifact</goal>
        </goals>
        <configuration>
          <artifacts>
            <artifact>
              <file>script.bat</file>
              <type>bat</type>
            </artifact>
          </artifacts>
        </configuration>
      </execution>
    </executions>
  </plugin> 
```

然后，您的其他项目可以使用 maven-dependency-plugin 的[复制目标](http://maven.apache.org/plugins/maven-dependency-plugin/examples/copying-artifacts.html)将脚本解析到自己的目录中并从那里运行它。

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-dependency-plugin</artifactId>
    <version>2.5.1</version>
    <executions>
      <execution>
        <id>copy</id>
        <phase>package</phase>
        <goals>
          <goal>copy</goal>
        </goals>
        <configuration>
          <artifactItems>
            <artifactItem>
              <groupId>...</groupId>
              <artifactId>...</artifactId>
              <version>...</version>
              <type>bat</type>
              <overWrite>true</overWrite>
            </artifactItem>
          </artifactItems>
          <outputDirectory>${project.build.directory}/scripts</outputDirectory>
          <overWriteSnapshots>true</overWriteSnapshots>
        </configuration>
      </execution>
    </executions>
  </plugin> 
```