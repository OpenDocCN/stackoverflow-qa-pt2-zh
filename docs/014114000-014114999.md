# StackOverflow 问答 14114000-14114999

# jquery - jQuery 揭幕 - 使用 jQuery 查找屏幕的左右两侧

> ID：14114004
> 
> 赞同：2
> 
> 时间：2013-01-01T20:35:07.667
> 
> 标签：jquery, lazy-loading

我正在研究使用一些轻量级代码，我发现它通过在项目可见时将 data-src 切换到 src 来执行 LazyLoading。基本上减少了全脂的 LazyLoad。来自这里的代码：http: [//luis-almeida.github.com/unveil/](http://luis-almeida.github.com/unveil/)

```
(function( $ ) {

$.fn.unveil = function( threshold ) {
    var $w = $( window ), 
        th = threshold || 0,
        images = this, 
        loaded, 
        inview,
        source;

    this.one( "unveil", function(){
        source = this.getAttribute( "data-src" );
        this.setAttribute( "src", source );
        this.removeAttribute( "data-src" );
    } );

    function unveil() {
        inview = images.filter(function(){
            var $e = $( this ),
                wt = $w.scrollTop(),
                wb = wt + $w.height(),
                et = $e.offset().top,
                eb = et + $e.height();

            return eb >= wt - th && et <= wb + th;
        });

        loaded = inview.trigger( "unveil" );
        images = images.not( loaded );
    }

    $w.scroll( unveil );
    $w.resize( unveil );

    unveil();

    return this;
};

})( jQuery ); 
```

但是，我的 jQuery 知识非常有限，所以据我所知，可见性检查是基于 scrollTop 的垂直位置。

我正在尝试在我的电子商务商店的一部分上使用它，其中水平 jQuery Tool 可滚动 div 中有许多产品。由于它们位于屏幕的垂直部分，因此它会加载所有图像。我尝试使用 LazyLoad 但无法使其工作。

有谁知道如何编辑此代码，以便该函数可以检测到溢出中右侧的 div 中的图像（这是隐藏的），因此不应加载 - 即。图像的位置在某个点的右侧吗？

# ms-access-2003 - ms-访问多个用户ID的相同数据条目

> ID：14114005
> 
> 赞同：0
> 
> 时间：2013-01-01T20:35:24.607
> 
> 标签：ms-access-2003

我有一个假期数据库，可以跟踪获得和使用的时间。我刚刚发现我的应用程序设计存在不足。对于国定假日，我们的工作经理会获得延期假期。我发现我的数据输入表单很难为每个用户 ID 输入一个事件。是否有可能有一个表格可以为许多不同的用户 ID 输入相同的基本信息？

```
Table: SchedulingLog (uses a composite primary key)
LogID - UserID(pri) - LogDate - EventDate(pri) - Category(pri) - CatDetail(pri) - Value
auto#    abc123       1-1-13    1-1-13           DH              DH Gain           1
auto#    def789       1-1-13    1-1-13           DH              DH Gain           1
auto#    xyz567       1-1-13    1-1-13           DH              DH Gain           1 
```

我的当前表单有一个下拉框来选择经理，然后是表 SchedulingLOG 的所有相应字段。我的最终目标是能够通过某种形式的复选框或列表框为多用户批量输入大约 100 个不同用户的 DH 事件，然后键入其余字段。然后单击一个更新事件，它将为每个用户生成一条具有相同信息的记录（当然除了用户 ID）。

# php - 未找到 JFactory

> ID：14114007
> 
> 赞同：0
> 
> 时间：2013-01-01T20:35:33.957
> 
> 标签：php, ajax, joomla

我在 Joomla 中制作了一个外部文件`getuser.php`并将其放在`administrator/getuser.php`

包含数据库查询

```
<?php
$q=$_GET["q"];
$db = JFactory::getDBO();
// Create a new query object.
$query = $db->getQuery(true);
$query->select($db->nameQuote('product_name'));
$query->from('#__virtuemart_products_en_gb');
$query->where($db->nameQuote('virtuemart_product_id').' = '.$db->quote($q));
$db->setQuery($query);
$result = $db->loadResult();

  echo "<tr>";
  echo "<td>" . $result['product_name'] . "</td>";
  echo "</tr>";
?> 
```

`product_edit_information.php`并使用位于 administrator/components/com_virtuemart/views/product/tpl/product_edit_information.php的 ajax 调用它

代码是

```
<form>
<select name="users" onChange="showUser(this.value)">
<option value="">Select a person:</option>
<option value="7745">YA Ali</option>
<option value="7746">Qasim</option>
</select>
</form>
<br />
<div id="txtHint"><b>Person info will be listed here.</b></div>
<script>
function showUser(str)
{
if (str=="")
  {
  document.getElementById("txtHint").innerHTML="";
  return;
  }
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","getuser.php?q="+str,true);
xmlhttp.send();
}
</script> 
```

错误是

> 致命错误：在第 3 行的 C:\xampp\htdocs\bc22\administrator\getuser.php 中找不到类 'JFactory'

这个错误的原因是什么我如何在joomla中添加外部文件

我也经历了这个但无法理解...... [http://docs.joomla.org/Adding_AJAX_to_your_component](http://docs.joomla.org/Adding_AJAX_to_your_component)

```
defined('_JEXEC') or die('Restricted access'); 
```

当我把它放在 getuser.php 的顶部时，它会给我错误

**禁止进入**

当我`echo $q=$_GET["q"]; // output 7745 and 7746`

```
 <option value="7745">YA Ali</option>
 <option value="7746">Qasim</option> 
```

但是在 jFactory not found 发生错误之后

对不起我的英语不好

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T01:43:48.340

您应该在代码顶部添加此代码：

```
define('_JEXEC', 1);
define('DS', DIRECTORY_SEPARATOR);

if (file_exists(dirname(__FILE__) . '/defines.php')) {
    include_once dirname(__FILE__) . '/defines.php';
}

if (!defined('_JDEFINES')) {
    define('JPATH_BASE', dirname(__FILE__));
    require_once JPATH_BASE.'/includes/defines.php';
}

require_once JPATH_BASE.'/includes/framework.php';
require_once JPATH_BASE.'/includes/helper.php';
require_once JPATH_BASE.'/includes/toolbar.php'; 
```

问题是您不包含 Joomla 框架并使用 JFactory。如果任何函数包含错误，您应该包含该函数的 Joomla 路径。
`Restricted access`问题解决了`define('_JEXEC', 1);`

# haskell - 具有不同 first 和 last 函数的 Haskell map (?) 操作

> ID：14114011
> 
> 赞同：3
> 
> 时间：2013-01-01T20:35:52.143
> 
> 标签：haskell, map, split, base64

我正在编写一个对`ByteString`值列表进行操作的 Haskell 函数。我需要对第一个和最后一个项目执行不同的操作（如果列表只有一个项目，这可能是相同的）。

具体来说，我想写出以下内容：

```
 "item-1\
  \item-2\
  \item-3\
  ...
  \item-n" 
```

其中`item-1`以双引号开头并以`item-n`反斜杠结尾并以反斜杠开头并以双引号结尾。`item-1`和之间的所有项目都`item-n`以反斜杠开始和结束。我将 base64 编码值作为 Haskell 发出以`String`进行某些代码生成。我已经将原始（长）base64 编码`ByteString`分解为每个 64 个字符长的块。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-01T20:52:06.347

我才意识到我的问题是一个愚蠢的问题。

我可以只使用在项目之间`intercalate`注入`"\\\n\\"`，然后在前面加上双引号：

```
import qualified Data.ByteString.Lazy.Char8 as L
(L.pack "\"") `L.append` (L.intercalate "\\\n\\" items) `L.append` (L.pack "\"") 
```

样本输出：

```
"H4sIAAAAAA\
\AAA2NgAAMm\
\CMXA7JRYxI\
\Am5JafD2Uy\
\AgDvdHs6Lg\
\AAAA==\
\" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T23:00:18.190

您还可以考虑使用以下方法拆分列表：

*   "head" 获取列表的第一个元素
*   "tail" 获取列表中除第一个元素之外的所有元素
*   "init" 获取列表中除最后一个元素之外的所有元素
*   "last" 获取列表的最后一个元素

所以`[head a] ++ init (tail a) ++ [last a] == a`。

这样，您可以单独更改列表的第一个和最后一个元素，并将函数映射到“init”部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-13T13:53:45.330

我曾多次遇到这种情况，但从未找到一个好的惯用解决方案。有时`intercalate`还不够。这是一个简单的解决方案。

```
-- | Annotate elements of a list with Bools, the first of which is True if
-- the element is the head of the list, the second of which is True if the
-- element is the last of the list. Both are True for singleton.
markbounds :: [a] -> [(a, Bool, Bool)]
markbounds [] = []
markbounds [x] = [(x, True, True)]
markbounds (x:xs) = (x, True, False) : tailbound xs
  where
    tailbound [y] = [(y, False, True)]
    tailbound (y:ys) = (y, False, False): tailbound ys 
```

例如：

```
λ> markbounds [1,2,3]
[(1,True,False),(2,False,False),(3,False,True)]

λ> forM_ (markbounds [1,2,3]) $ \(x, isFirst, isLast) -> when isLast $ print x
3 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-23T15:11:56.113

我已经构建了（我的第一个！）库，它对“不同的第一个和最后一个函数”问题有一个合理通用的解决方案。它在 GitHub ( [https://github.com/davjam/MapWith](https://github.com/davjam/MapWith) ) 和 Hackage ( [http://hackage.haskell.org/package/MapWith](http://hackage.haskell.org/package/MapWith) ) 上。

最初受到 James 的 markbounds 函数的启发，但可以：

*   处理比列表更通用的结构（所有 Traversable 类型）
*   直接向函数添加参数（不仅仅是创建元组）
*   添加不同类型的参数（第一个/最后一个/下一个元素/上一个元素/从开始或结束的索引等）
*   允许创建其他类型的参数。
*   添加任意数量的参数

例如：

```
> andFirstLast [1,2,3]
[(1,True,False),(2,False,False),(3,False,True)]

> mapWithM_ ((\x isL -> when isL $ print x) & isLast) [1,2,3]
3

> mapWith ((,,,) & isLast & prevElt <-^ eltIx) [1,7,4]
[(1,False,Nothing,2),(7,False,Just 1,1),(4,True,Just 7,0)] 
```

更多示例[见 https://github.com/davjam/MapWith/blob/master/doc/examples.hs](https://github.com/davjam/MapWith/blob/master/doc/examples.hs)。

任何反馈将不胜感激。谢谢！

# c++ - 对整个项目使用 Poco::Logger

> ID：14114014
> 
> 赞同：4
> 
> 时间：2013-01-01T20:36:23.953
> 
> 标签：c++, logging, poco-libraries

```
AutoPtr<SplitterChannel> splitterChannel(new SplitterChannel());

        AutoPtr<Channel> consoleChannel(new ConsoleChannel());
        AutoPtr<Channel> fileChannel(new FileChannel("Arcanite.log"));
        AutoPtr<FileChannel> rotatedFileChannel(new FileChannel("Arcanite_R.log"));

        rotatedFileChannel->setProperty("rotation", "100");
        rotatedFileChannel->setProperty("archive", "timestamp");

        splitterChannel->addChannel(consoleChannel);
        splitterChannel->addChannel(fileChannel);
        splitterChannel->addChannel(rotatedFileChannel);

        //"%d-%m-%Y %H:%M:%S: %t"
        AutoPtr<Formatter> formatter(new PatternFormatter("%d-%m-%Y %H:%M:%S %s: %t"));
        AutoPtr<Channel> formattingChannel(new FormattingChannel(formatter, splitterChannel));

        Logger& sLog = Logger::create("LogChan", formattingChannel, Message::PRIO_TRACE); 
```

我已经在多个类中编写了我想用于我的服务器的记录器。我怎样才能适应它来做到这一点？这可能是基本的 C++，但我似乎错过了一些课程：P

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T15:40:50.837

Poco::Logger 类用作日志框架。

当您定义一个具有固定名称的记录器实例（在您的示例中为“LogChan”）时，您的所有类都可以访问它。所以你应该做一个

```
Logger& logger = Logger::get("logChan"); 
```

从您的其他课程中获取记录器参考。

我猜它下面使用单例模式来生成记录器池。

# c# - 在 64 位应用程序中使用 32 位互操作 dll

> ID：14114016
> 
> 赞同：1
> 
> 时间：2013-01-01T20:36:40.380
> 
> 标签：c#, com, interop, 32bit-64bit, rcw

我对使用 64 位进程的 32 位互操作 dll 有点困惑。为了访问 8TB 内存，我将为 64 位构建我的应用程序，不幸的是它使用了一些以 32 位模式构建的统计互操作库。我没有这个库的资源，所以我无法将它重建为 64 位。

在[本文](http://blog.mattmags.com/2007/06/30/accessing-32-bit-dlls-from-64-bit-code/)中，建议创建 64 位代理进程，该进程将使用 IPC（例如 WCF）与我的应用程序进行通信。[在这里](https://stackoverflow.com/questions/875112/64-to-32-bit-interop-how)，我们可以找到使用 Runtime Callable Wrapper ( [RCW](http://msdn.microsoft.com/en-us/library/8bwh56xe%28v=vs.100%29.aspx) ) 的解决方案。哪个更好？我开始实施代理流程，就在今天我找到了第二个解决方案，我不知道它是否适合我的需求。

我需要提一下，这个统计互操作库有数百个接口和类。我仍然只需要其中一些。我已经开始创建将其中几个作为端点托管的 WCF 服务，看起来这将是很多代码/工作。

我可以使用第二种方法 (RCW) 与互操作 dll 一起使用吗？

问候，乔特贝克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T21:55:20.593

好吧，“更好”是一个加载术语。但是，是的，COM 代理可以让它变得更简单。如果您可以使用系统代理，那么当库设计得很好时，几率几乎总是很好，那么您只需将注册表项复制到 64 位密钥中并调整其中的一些以使用代理，这一切都可以在没有你写任何代码。MSDN 起始页[在这里](http://msdn.microsoft.com/en-us/library/windows/desktop/ms695225%28v=vs.85%29.aspx)。

当图书馆不支持跨公寓编组时，它就行不通了。如果您不知道它是否存在，请尝试从工作线程调用库函数。如果这不起作用，那么不要费心尝试。如果这个库容易崩溃错误，你将失去“更好的”，这在进程外场景中总是很糟糕。速度可能是一个问题，进程外调用有很多开销。但是无论哪种方式，您都被困住了。通过联系图书馆所有者寻求支持，您将得到很好的答案，而不是猜测。

# objective-c - 块和中央调度，代码的区别？

> ID：14114018
> 
> 赞同：1
> 
> 时间：2013-01-01T20:36:46.650
> 
> 标签：objective-c, objective-c-blocks, grand-central-dispatch

这些例子有什么区别？我无法弄清楚为什么它们不同并提供不同的结果。如我所见，块中的代码有时会在主线程中运行，而第一个代码提供的结果是 foo 或 bar，不知道为什么以及何时。

```
NSString *myString = @"foo";
dispatch_async (dispatch_get_main_queue(), ^{
    NSLog (@"%@", myString); 
});
myString = @"bar"; 
```

第二：

```
NSMutableString *myString = [NSMutableString stringWithString:@"foo"]; 
dispatch_async (dispatch_get_main_queue(), ^{
    NSLog (@"%@", myString); 
});
[myString setString:@"bar"]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T20:47:11.040

这是非常微妙的（即，最好构造代码以避免需要回答这个问题:)）

在第一个示例中，该块捕获指向文字常量 NSString 的指针的 const 副本。然后更新原始指针以指向新字符串。该块应该稍后从主线程中的某个任意点打印“foo”。

在第二个示例中，该块捕获指向可变 NSString 的指针的 const 副本。然后可变的 NSString 被更新为具有不同的内容。如果代码在非主线程/队列上运行，则块可能会打印“foo”，可能会打印“bar”，或者可能由于在更改时打印字符串而崩溃。如果块在主线程/队列上，那么它将打印“bar”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T20:50:20.280

区别在于：

*   在第一种情况下，您有两个不同的对象，`@"foo"`并且`@"bar"`. `myString`首先指向`@"foo"`，然后将其更改为指向`@"bar"`。

*   在第二种情况下，您有一个对象，一个`NSMutableString`. `myString`一直指向那个对象。但是，那个变化的*内容*`NSMutableString`，从`"foo"`到`"bar"`。

[当您创建一个块时，它会从封闭范围中*捕获*它使用的任何局部变量的值。](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/Blocks/Articles/bxVariables.html#//apple_ref/doc/uid/TP40007502-CH6-SW2) 因此，在第一种情况下，块`myString`在指向`@"foo"`. 稍后将其指向的更改`@"bar"`不会影响块中捕获的副本。

在第二种情况下，该块捕获 的值`myString`。但是，它不会*捕获*`myString`指向的对象的状态。因此，您可以更改对象的内容，并且块在运行时会看到新内容。

`dispatch_async`顺便说一句，这与GCD 或多线程无关。如果您直接同步运行该块，您会看到相同的效果。

```
NSString *myString = @"foo";
void (^myBlock)(void) = ^{
    NSLog (@"%@", myString); 
};
myBlock(); // prints "foo"
myString = @"bar";
myBlock(); // prints "foo"

NSMutableString *myString = [NSMutableString stringWithString:@"foo"]; 
void (^myBlock)(void) = ^{
    NSLog (@"%@", myString); 
};
myBlock(); // prints "foo"
[myString setString:@"bar"];
myBlock(); // prints "bar" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-01T21:05:11.560

这是您第一次创建块并调用时的样子`dispatch_async`：

```
 --NSString-------
    |     "Foo"     |
    -----------------
      ^      ^
      |      |
myString    GCD Block 
```

下面是它在函数末尾的样子。您正在分配`myString`一个全新的 NSString 实例，与块捕获的实例不同：

```
 --NSString-------  --NSString-------
    |     "Foo"     |  |     "Bar"     |
    -----------------  -----------------
             ^             ^
             |             |
       GCD Block          myString 
```

在这种情况下，无论何时执行该块，该块将始终打印“Foo”。

第二个例子以类似的方式开始：

```
 --NSMutableString----
    |     "Foo"         |
    ---------------------
      ^      ^
      |      |
myString    GCD Block 
```

除非您正在修改块捕获的相同 NSMutableString 实例：

```
 --NSMutableString----
    |     "Bar"         |
    ---------------------
      ^      ^
      |      |
myString    GCD Block 
```

该块可以打印“Foo”或“Bar”，具体取决于它何时执行。如果块打印“Bar”，则表示该块是在您修改 NSMutableString 实例后执行的。

# c# - 动态更改数据源？

> ID：14114021
> 
> 赞同：1
> 
> 时间：2013-01-01T20:37:27.950
> 
> 标签：c#, .net, data-binding, combobox

我有一个绑定到对象列表的 WinForms 组合框，列表如下：

```
BindingList<myObject> myListOfObjects = new BindingList<myObject>();

// 100 objects are added to myListOfObjects

bindingSource1.DataSource = myListOfObjects;
comboBox1.DataSource = bindingSource1;
comboBox1.DisplayMember = "Name"; 
```

我的对象的每个实例都包含以下内容：

```
public string Name
public int Index
public List<int> Codes = new List<int>(); 
```

该对象还实现了 INotifyPropertyChanged。

在组合框中选择对象“名称”时，我想将列表框数据绑定到所选对象的“代码”列表。我正在尝试这样做：

```
private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    listBox1.DataSource = myListOfObjects[((myObject)comboBox1.SelectedValue).Index].Codes;
} 
```

这不起作用，我得到一个 InvalidCastException（特别是 Int32 不能转换为 myObject）。我对这一切都错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T20:45:25.070

问题是`combobox1.SelectedValue`将设置为组合框中`myObject`指定的属性`ValueMember`。

为了获得底层`myObject`，您需要使用`comboBox1.SelectedItem`：

```
listBox1.DataSource = myListOfObjects[((myObject)comboBox1.SelectedItem).Index].Codes; 
```

如果这是我的代码，我还会在直接使用之前仔细检查以确保 SelectedItem 不为空：

```
if (comboBox1.SelectedItem != null) {
    listBox1.DataSource = myListOfObjects[((myObject)comboBox1.SelectedItem).Index].Codes;
} else {
    listBox1.DataSource = null;
} 
```

# php - PHP：获取选定的选项并发布到数据库

> ID：14114022
> 
> 赞同：-2
> 
> 时间：2013-01-01T20:37:39.557
> 
> 标签：php, database, option, selected, posting

我正在尝试制作一些 PHP，其中用户选择一个数字并单击一个按钮，它会将数字发送到数据库。

当您选择出生日期时，有点像 Facebook 的注册..

```
 <p>Select your number:</p>
           <select>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>

            </select> 
```

我如何获得选定的选项并将其设置为变量，例如 $num？谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T20:39:04.760

您需要提供`select`名称标签，然后使用 post/get 全局引用该名称。

```
<select name="number">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
</select> 
```

然后用 PHP：

```
$num = $_POST['number']; //or $_GET depending on your form's method type 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:52:12.040

select 元素需要一个名称标签，否则您将无法通过 PHP 检查该值。

```
<form method="post">
    <select name="number">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
    </select>
    <input type="submit" value="Submit">
</form> 
```

用 PHP 输出：

```
echo 'Selected number: '.$_POST['number']; 
```

# linux - 在 Linux 工作队列中休眠

> ID：14114023
> 
> 赞同：1
> 
> 时间：2013-01-01T20:38:02.287
> 
> 标签：linux, kernel, scheduling

我只是第一次阅读有关 Linux 内核中断处理程序下半部分的信息，并试图了解工作队列在延迟工作中的使用。

据我了解，工作队列相对于 softirps 或 tasklet 的好处是工作是在进程上下文中完成的，因此它可以休眠。但默认情况下，这项工作只是在其中一个事件/X 线程上按顺序完成？因此，如果说一些工作在 events/0 上开始，然后在等待一些 IO 时休眠很长时间，则该处理器上不能再处理工作队列项，这对于性能来说似乎非常糟糕。

如果工作可以长时间休眠，那么所有中断处理程序开发人员是否有责任不使用默认事件/X 线程？还是我误解了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T21:24:43.580

> 但默认情况下，这项工作只是在其中一个事件/X 线程上按顺序完成？因此，如果说一些工作在 events/0 上开始，然后在等待一些 IO 时休眠很长时间，则该处理器上不能再处理工作队列项，这对于性能来说似乎非常糟糕。

这是不准确的；workqueue API 允许单线程和多线程任务。对于前者，函数 create_singlethread_workqueue() 被调用。

> 如果工作可以长时间休眠，那么所有中断处理程序开发人员是否有责任不使用默认事件/X 线程？还是我误解了什么？

*在softirq（即tasklet）中你根本*不能睡觉，所以基本上，工作队列的好处是你*可以*睡觉......确实 - 在单线程工作队列的情况下不导致其他kthreads饿死是开发人员的责任。

还要记住，workqueue API 提供的不仅仅是任务的入队/出队，还提供排队延迟工作、工作之间同步、刷新工作队列、取消延迟工作等功能。这个 API 也比其他 API 更有优势基于 softirq 的库，即使是不可睡眠的使用。

# android - 如何使用 libgdx 处理 android HOME 按钮

> ID：14114025
> 
> 赞同：1
> 
> 时间：2013-01-01T20:38:20.557
> 
> 标签：android, button, libgdx

我正在使用 libgdx 为 android 编写游戏。并且有游戏控件靠近 android 按钮 HOME 和 BACK 的问题。处理 BACK 按钮的方法很简单，但我还没有找到 HOME 按钮的东西。我想要的 - 当用户不小心按下 HOME 按钮时 - 处理它并在用户想要离开游戏但不立即将其最小化时弹出对话框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-09T01:10:21.180

您无法处理主页按钮（也无法锁定屏幕）。

参考：[如何捕捉主页/锁定屏幕按钮](http://badlogicgames.com/forum/viewtopic.php?f=11&t=10986#p49480)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-02T23:44:54.747

对于任何可能偶然发现这一点的人，一个合理的解决方案是在你的 android 启动器中实现 onPause 方法

```
@Override
protected void onPause(){
    //do whatever you need to on pause
    super.onPause();
} 
```

# three.js - 如何用three.js编写正确的重复纹理

> ID：14114030
> 
> 赞同：15
> 
> 时间：2013-01-01T20:38:58.387
> 
> 标签：three.js, textures, repeat, texture-wrapping

我搜索在模型上重复纹理。在所有示例或问题上，我发现只有这样：

```
var lavaTexture = THREE.ImageUtils.loadTexture( 'images/lava.jpg' );
lavaTexture.wrapS = lavaTexture.wrapT = THREE.RepeatWrapping;
lavaTexture.repeat.set( 3, 3 );
var lavaMaterial = new THREE.MeshBasicMaterial( { map: lavaTexture } ); 
```

我理解这一点，但是当材料这样写时：

```
Wood: new THREE.MeshPhongMaterial( {
   color: 0xffffff,
   specular:0xffffff,
   shininess: 10,
   map: new THREE.ImageUtils.loadTexture ( "models/macabann/chataigner.jpg"),
// not sure as right
   WrapS : THREE.RepeatWrapping,
   WrapT : THREE.RepeatWrapping,
   maprepeat : [2,2],

   envMap: textureCube,
   combine: THREE.MixOperation,
   reflectivity: 0.05
} ) 
```

如果可能的话，我会搜索如何以这种格式准确地写这个。感谢您的任何回答。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-01T20:51:15.330

您希望纹理在您的模型上重复。为此，请遵循以下模式：

```
var loader = new THREE.TextureLoader();

var texture = loader.load( 'myTexture.jpg', function ( texture ) {

    texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
    texture.offset.set( 0, 0 );
    texture.repeat.set( 2, 2 );

} );

var material = new THREE.MeshPhongMaterial( {

   color: 0xffffff,
   specular:0x111111,
   shininess: 10,
   map: texture,
   . . .

} ); 
```

编辑：更新到 three.js r.84

# android - 带有 alpha 的 Android 位图模糊

> ID：14114033
> 
> 赞同：2
> 
> 时间：2013-01-01T20:39:10.890
> 
> 标签：android, bitmap, alpha, blur

我找到了如何模糊我的位图，但仍然有一个黑色光晕。我知道它可以通过在模糊之前预乘图像 alpha 来修复，但我不知道该怎么做......

感谢您的任何帮助！

圆法：

```
private void drawCircle() {
    ImageView img = (ImageView) findViewById(R.id.brushPreview);
    Bitmap bmp = Bitmap.createBitmap(260, 260, Bitmap.Config.ARGB_8888);
    Canvas c = new Canvas(bmp);
    Paint mPaint = new Paint();
    SeekBar[] seekBar = { (SeekBar) findViewById(R.id.seekBarSize), (SeekBar) findViewById(R.id.seekBarTrans), (SeekBar) findViewById(R.id.seekBarHard) };

    mPaint.setDither(true);
    mPaint.setColor(0xFFfff000);
    mPaint.setStyle(Paint.Style.STROKE);
    mPaint.setStrokeJoin(Paint.Join.ROUND);
    mPaint.setStrokeCap(Paint.Cap.ROUND);
    mPaint.setStrokeWidth(seekBar[0].getProgress());
    c.drawPoint(130, 130, mPaint);

    bmp = getBlurredBitmap(bmp, seekBar[2].getProgress());

    img.setImageBitmap(bmp);
} 
```

模糊法

```
public Bitmap getBlurredBitmap(Bitmap original, int radius) {
    if (radius < 1)
        return original;

    int width = original.getWidth();
    int height = original.getHeight();
    int wm = width - 1;
    int hm = height - 1;
    int wh = width * height;
    int div = radius + radius + 1;
    int a[] = new int[wh];
    int r[] = new int[wh];
    int g[] = new int[wh];
    int b[] = new int[wh];
    int asum, rsum, gsum, bsum, x, y, i, p, p1, p2, yp, yi, yw;
    int vmin[] = new int[Math.max(width, height)];
    int vmax[] = new int[Math.max(width, height)];
    int dv[] = new int[256 * div];
    for (i = 0; i < 256 * div; i++)
        dv[i] = i / div;

    int[] blurredBitmap = new int[wh];
    original.getPixels(blurredBitmap, 0, width, 0, 0, width, height);

    yw = yi = 0;

    for (y = 0; y < height; y++) {
        asum = rsum = gsum = bsum = 0;
        for (i = -radius; i <= radius; i++) {
            p = blurredBitmap[yi + Math.min(wm, Math.max(i, 0))];
            asum += (p & 0xff) >> 24;
            rsum += (p & 0xff0000) >> 16;
            gsum += (p & 0x00ff00) >> 8;
            bsum += (p & 0x0000ff);
        }
        for (x = 0; x < width; x++) {
            a[yi] = dv[asum];
            r[yi] = dv[rsum];
            g[yi] = dv[gsum];
            b[yi] = dv[bsum];

            if (y == 0) {
                vmin[x] = Math.min(x + radius + 1, wm);
                vmax[x] = Math.max(x - radius, 0);
            }
            p1 = blurredBitmap[yw + vmin[x]];
            p2 = blurredBitmap[yw + vmax[x]];

            asum += ((p1 >> 24) & 0xff) - ((p2 >> 24) & 0xff);
            rsum += ((p1 & 0x00ff0000) - (p2 & 0x00ff0000)) >> 16;
            gsum += ((p1 & 0x0000ff00) - (p2 & 0x0000ff00)) >> 8;
            bsum += (p1 & 0x000000ff) - (p2 & 0x000000ff);
            yi++;
        }
        yw += width;
    }

    for (x = 0; x < width; x++) {
        asum = rsum = gsum = bsum = 0;
        yp = -radius * width;
        for (i = -radius; i <= radius; i++) {
            yi = Math.max(0, yp) + x;
            asum += a[yi];
            rsum += r[yi];
            gsum += g[yi];
            bsum += b[yi];
            yp += width;
        }
        yi = x;
        for (y = 0; y < height; y++) {
            blurredBitmap[yi] = (dv[asum]<<24) | (dv[rsum]<<16) | (dv[gsum]<<8) | dv[bsum];
            if (x == 0) {
                vmin[y] = Math.min(y + radius + 1, hm) * width;
                vmax[y] = Math.max(y - radius, 0) * width;
            }
            p1 = x + vmin[y];
            p2 = x + vmax[y];

            asum += a[p1] - a[p2];
            rsum += r[p1] - r[p2];
            gsum += g[p1] - g[p2];
            bsum += b[p1] - b[p2];

            yi += width;
        }
    }

    return Bitmap.createBitmap(blurredBitmap, width, height, Bitmap.Config.ARGB_8888);
} 
```

# jquery - JScrollpanel 不工作

> ID：14114035
> 
> 赞同：0
> 
> 时间：2013-01-01T20:39:41.943
> 
> 标签：jquery, jquery-jscrollpane

我试图弄清楚为什么 Kelvin Luck 的[JScrollPanel](http://jscrollpane.kelvinluck.com/)对我不起作用。滚动条出现了，但是，它没有显示溢出项。[您可以通过访问http://glassyan.glassyan.com/](http://glassyan.glassyan.com/)查看我的页面并了解我的意思

它只显示 6 个项目，即使有 10 个项目。滚动条出现，但它不让我滚动。我只能看到这 6 个项目。有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:22:43.340

在 TimeClock.css 中，移除 height: 100%；在第 10 行：

```
html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, figcaption, figure, footer, header, hgroup, menu, nav, section, summary, time, mark, audio, video
{
    margin: 0;
    padding: 0;
    border: 0;
    outline: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    height: 100%;
} 
```

此行使您的滚动条占用所有可用空间，并破坏脚本。

要修复页脚，请添加：

```
html {
  height: 100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:24:06.843

给班级一个高度`.login_page .center`

# php - 在不同的php页面上显示图像

> ID：14114036
> 
> 赞同：-3
> 
> 时间：2013-01-01T20:40:02.237
> 
> 标签：php

我正在创建一个 php 图片库，经过长时间的搜索，我在 google 上找到了一个很好的 php 图片库代码。当我单击图像的缩略图时，它会发送到原始图像位置，但不是原始图像，而是我想将用户发送到显示相同图像的不同页面！

这是代码！

```
<?php   # SETTINGS

        $max_width = 200;
        $max_height = 200;
        $per_page = 9;

        $page = $_GET['page'];

        $has_previous = false;
        $has_next = false;

        function getPictures() {
            global $page, $per_page, $has_previous, $has_next;
            if ( $handle = opendir(".") ) {
                $lightbox = rand();
                echo '<ul id="pictures">';

                $count = 0;
                $skip = $page * $per_page;

                if ( $skip != 0 )
                    $has_previous = true;

                while ( $count < $skip && ($file = readdir($handle)) !== false ) {
                    if ( !is_dir($file) && ($type = getPictureType($file)) != '' )
                        $count++;
                        }

                $count = 0;
                while ( $count < $per_page && ($file = readdir($handle)) !== false ) {
                    if ( !is_dir($file) && ($type = getPictureType($file)) != '' ) {
                        if ( ! is_dir('thumbs') ) {
                            mkdir('thumbs');
                        }
                        if ( ! file_exists('thumbs/'.$file) ) {
                            makeThumb( $file, $type );
                        }

                        echo '<li><a href="'.$file.'" rel="lightbox['.$lightbox.']">';

                        echo '<img src="thumbs/'.$file.'" alt="" />';

                        echo '<div class="fb">view</div></a></li>';

                        $count++;

                    }

                }

                echo '</ul>';

                while ( ($file = readdir($handle)) !== false ) {
                    if ( !is_dir($file) && ($type = getPictureType($file)) != '' ) {
                        $has_next = true;
                        break;
                    }
                }
            }
        }

        function getPictureType($file) {
            $split = explode('.', $file); 
            $ext = $split[count($split) - 1];
            if ( preg_match('/jpg|jpeg/i', $ext) ) {
                return 'jpg';
            } else if ( preg_match('/png/i', $ext) ) {
                return 'png';
            } else if ( preg_match('/gif/i', $ext) ) {
                return 'gif';
            } else {
                return '';
            }
        }

        function makeThumb( $file, $type ) {
            global $max_width, $max_height;
            if ( $type == 'jpg' ) {
                $src = imagecreatefromjpeg($file);
            } else if ( $type == 'png' ) {
                $src = imagecreatefrompng($file);
            } else if ( $type == 'gif' ) {
                $src = imagecreatefromgif($file);
            }
            if ( ($oldW = imagesx($src)) < ($oldH = imagesy($src)) ) {
                $newW = 220;
                $newH = $max_height;
            } else {
                $newW = $max_width;
                $newH = 200;
            }
            $new = imagecreatetruecolor($newW, $newH);
            imagecopyresampled($new, $src, 0, 0, 0, 0, $newW, $newH, $oldW, $oldH);
            if ( $type == 'jpg' ) {
                imagejpeg($new, 'thumbs/'.$file);
            } else if ( $type == 'png' ) {
                imagepng($new, 'thumbs/'.$file);
            } else if ( $type == 'gif' ) {
                imagegif($new, 'thumbs/'.$file);
            }
            imagedestroy($new);
            imagedestroy($src);
        }
    ?> 
```

对不起，我的英语不好，希望你能理解我的问题！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T20:53:44.783

此代码在图片链接中包含一个 rel="lightbox['.$lightbox.']。它期望在浏览器中使用 Lightbox 来显示图片。Lightbox 是一个 JavaScript 库（也有很多克隆）在现有页面上显示图像并使背景变灰。这非常好。您可能想研究使用 Lightbox 来显示图像。

否则，您将需要修改该行：

```
echo '<li><a href="'.$file.'" rel="lightbox['.$lightbox.']">'; 
```

以便 href 指向您想要的页面，其中 $file 作为 URL 中的 GET 值。如果你这样做了，你应该取出 rel= 因为你不会使用它。它不会伤害任何东西，但如果您不使用 Lightbox，它只会变得混乱。例如：

```
echo '<li><a href="display.php?image='.$file.'">'; 
```

其中 display.php 是显示图像的页面。

# xml - 获取带有父节点名称的节点值

> ID：14114040
> 
> 赞同：0
> 
> 时间：2013-01-01T20:41:02.287
> 
> 标签：xml, actionscript-3

```
<root>    
<helmets>
        <enduro>
            <front>
                <frames>
                    <item>
                        <![CDATA[assets/helmet.jpg]]>
                    </item>
                </frames>
                <buttons>
                    <item>
                        <![CDATA[assets/helmet.jpg]]>
                    </item>
                </buttons>
            </front>
            <side>
                <frames>
                    <item>
                        <![CDATA[assets/helmet.jpg]]>
                    </item>
                </frames>
                <buttons>
                    <item>
                        <![CDATA[assets/helmet.jpg]]>
                    </item>
                </buttons>
            </side>
        </enduro>
    </root> 
```

例如我选择了一个项目；

```
XML.children().children().children().children()[0]; //assets/helmet.jpg 
```

如何获取父节点的名称？对于这个例子，我想知道它的父母喜欢；项目 > 框架 > 前 > 耐力赛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:16:05.293

这是从 XML 实例获取数据的一种非常不方便且容易出错的方法。

```
package {

  import flash.display.Sprite;
  import flash.text.TextField;

  public class XMLExample extends Sprite {

    public function XMLExample() {

      const data:XML =
          <root>
            <helmets>
              <enduro>
                <front>
                  <frames>
                    <item>
                      <![CDATA[assets/helmet.jpg]]>
                    </item>
                  </frames>
                </front>
              </enduro>
            </helmets>
          </root>;

      const list:XMLList = data..item,
          parentName:String = list[0].parent().name(),
          textField:TextField = new TextField();

      textField.text = parentName;
      addChild(textField);
    }
  }
} 
```

这将是一个简单的例子。当然，您应该通过方法访问某些数据。

# r - 使用 r 选择矩阵中每一行的多数数

> ID：14114046
> 
> 赞同：8
> 
> 时间：2013-01-01T20:42:57.420
> 
> 标签：r

我有一个具有以下形式的列数可变的矩阵：

```
1  10  10 10 15
2  14  14 13 13
4  19  19 20 21
6  32  32 20 15 
```

我想为产生以下输出的每一行选择多数：

```
1  10
2  14/13
3  19
4  32 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-01T20:55:56.857

似乎`table`几乎可以满足您的需求，但必须对输出进行按摩。 `Compose`是一种有趣的方式来做到这一点：

```
require(functional)
apply(m, 1, Compose(table,
                    function(i) i==max(i),
                    which,
                    names,
                    function(i) paste0(i, collapse='/')
                    )
      )

## [1] "10"    "13/14" "19"    "32" 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-01T20:48:57.260

可能的答案之一：

```
# over each row of data.frame (or matrix)
sapply(1:nrow(x), function(idx) {
# get the number of time each entry in df occurs
    t <- table(t(x[idx, ]))
# get the maximum count (or frequency)
    t.max <- max(t)
# get all values that equate to maximum count
    t <- as.numeric(names(t[t == t.max]))
}) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-02T01:27:38.970

后期添加，但是当值都是正数时，如您的示例中，您还可以：

```
apply(x, 1, function(idx) {
     which(tabulate(idx) == max(tabulate(idx)))
     }) 
```

没有第一列：

```
 apply(x[,-1], 1, function(idx) {
     which(tabulate(idx) == max(tabulate(idx)))
     }) 
```

最后调整你的输出：

```
s <- apply(x[,-1], 1, function(idx) {
     which(tabulate(idx) == max(tabulate(idx)))
     })
sapply(s, paste, sep="", collapse="/")

[1] "10"    "13/14" "19"    "32" 
```

# sql - 使用 SQL 查询探索 HSQL 数据库？

> ID：14114051
> 
> 赞同：0
> 
> 时间：2013-01-01T20:43:37.810
> 
> 标签：sql, hsqldb

我是第一次使用 HSQL。我以前使用过MySQL。它似乎缺少诸如 SHOW TABLES 之类的 MySQL 命令。不过，我仍然需要偶尔获得这样的信息。这有点相似，但它返回的表比我关心的要多（不是我自己的）：

```
SELECT * FROM INFORMATION_SCHEMA.SYSTEM_TABLES where TABLE_TYPE='TABLE' 
```

因此，出于这个原因，我想探索 HSQL 使用的元表，但我不知道如何。有人可以让我了解如何探索 HSQL 数据库以了解有关整体结构的信息。例如

1.  如何找出 INFORMATION_SCHEMA.SYSTEM_TABLES 的列名？
2.  我怎么可能一开始就找到 INFORMATION_SCHEMA 呢？
3.  如何找到 SYSTEM_TABLES 的“兄弟姐妹”？
4.  如何获取有关列的详细信息，例如主键等？

等等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T21:20:56.683

HSQLDB 指南中介绍了其中一些信息：

[http://hsqldb.org/doc/2.0/guide/databaseobjects-chapt.html#dbc_standard_views_info_schema](http://hsqldb.org/doc/2.0/guide/databaseobjects-chapt.html#dbc_standard_views_info_schema)

标准视图等效项是，您可以通过添加或类似条件`INFORMATION_SCHEMA.TABLES`过滤掉系统视图。`WHERE TABLE_SCHEMA <> 'INFORMATION_SCHEMA'`

列详细信息在 中`INFORMATION_SCHEMA.COLUMNS`，而主键在 中列出`KEY_COLUMN_USAGE`。

# java - android 使用自定义建议提供程序时出现奇怪的 NullPointerException 错误

> ID：14114056
> 
> 赞同：1
> 
> 时间：2013-01-01T20:44:55.407
> 
> 标签：java, android, android-sqlite

我正在尝试在我的应用程序中提出自定义搜索建议。我从文档和可搜索字典示例开始。然而，这个例子对我来说不是很好，所以我已经开始进行一些测试以了解如何制作它，因为互联网上也没有太多的教程。

一般来说，我的应用程序现在有 2 个数据库——一个是正常的，第二个是列数较少的——FTS3。我想要实现的是将建议提供者连接到这个 FTS3 表。

我现在想做的是，使用简单的功能，在搜索框中输入任何字母后，在建议中返回整个数据库（大约 200 条记录）。我知道限制 50 条记录，但我认为这不是问题。这是 Provider 代码的片段。我发现，当您输入文本时，提供者会转到选项`SEARCH_SUGGEST`：

```
// UriMatcher stuff
    private static final int SEARCH_WORDS = 0;
    private static final int GET_WORD = 1;
    private static final int SEARCH_SUGGEST = 2;
    private static final int REFRESH_SHORTCUT = 3;
    private static final UriMatcher mUriMatcher = buildUriMatcher();

    /**
     * Builds up a UriMatcher for search suggestion and shortcut refresh queries.
     */
    private static UriMatcher buildUriMatcher() {
        Log.d(TAG,"urimatcher");
        UriMatcher matcher =  new UriMatcher(UriMatcher.NO_MATCH);
        // to get definitions...
        matcher.addURI(AUTHORITY, "mydb", SEARCH_WORDS);
        matcher.addURI(AUTHORITY, "mydb/#", GET_WORD);
        // to get suggestions...
        matcher.addURI(AUTHORITY, SearchManager.SUGGEST_URI_PATH_QUERY, SEARCH_SUGGEST);
        matcher.addURI(AUTHORITY, SearchManager.SUGGEST_URI_PATH_QUERY + "/*", SEARCH_SUGGEST);

        return matcher;
    }

@Override
    public Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder) {

switch (mUriMatcher.match(uri)) {
            case SEARCH_SUGGEST:
                Log.d(TAG,"SEARCH_SUGGEST");
                if (selectionArgs == null) {
                  throw new IllegalArgumentException(
                      "selectionArgs must be provided for the Uri: " + uri);
                }
                return getSuggestions(selectionArgs[0]);
            case SEARCH_WORDS:
                Log.d(TAG,"SEARCH_WORDS");
                if (selectionArgs == null) {
                  throw new IllegalArgumentException(
                      "selectionArgs must be provided for the Uri: " + uri);
                }
                return search(selectionArgs[0]);
            case GET_WORD:
                Log.d(TAG,"GET_WORD");
                return null;
            default:
                Log.d(TAG,"default");
                throw new IllegalArgumentException("Unknown Uri: " + uri);
        }
    }

private Cursor getSuggestions(String query) {
        String[] columns = { MyDBAdapter.KEY_TITLE,MyDBAdapter.KEY_ID};
              Log.d(TAG,"query1: " + query);

              try{
                  Cursor tmp = MyDB.getAllEntriesFTS(false, columns,
                        null, null, null, null, MyDBAdapter.KEY_TITLE, null, query);
              Log.d(TAG,"cursor: " + Integer.toString(tmp.getCount()));
              }
              catch(Exception e)
              {
                  Log.d(TAG,e.toString());
              }
              return tmp;
    } 
```

在`getSuggestions`我输入的代码通常应该可以工作，但它没有。仅在此处使用时不起作用。当我在其他活动中使用它来获取列表视图的光标时，一切都很好。在这里它返回我的 NullPointerException。

所以越来越深入，我还在方法中添加了一些日志标签`getAllEntriesFTS`，这个方法看起来像这样：

```
public Cursor getAllEntriesFTS(boolean distinct, String[] result_columns,
            String selection, String[] selectionArgs, String groupBy,
            String having, String orderBy, String limit, String query) {

        Log.d(TAG,"query db: " + query);

        String[] columns = { MyDBAdapter.KEY_TITLE, MyDBAdapter.KEY_ID};

        Log.d(TAG,"columns: " + Integer.toString(result_columns.length));

        Cursor allRows = null;
        try{
allRows = db.query(distinct, DATABASE_TABLE_FTS, columns,
                    null, null, null, null, MyDBAdapter.KEY_TITLE, null);
            Log.d(TAG,"OK");
        }
        catch(Exception e)
        {
            Log.d(TAG, e.toString());//it always goes there with NullPointerExceptionwhen used in provider
        }
        Log.d(TAG,Integer.toString(allRows.getCount()));
        return allRows;
    } 
```

所以，一般来说，它应该将光标返回到整个数据库，而是在不应该出现 NullPointerException 的地方抛出。

有人可以告诉我我做错了什么以及应该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:24:00.333

感谢 JB Nizet，我能够找到我的错误。我以为我已经很好地研究了谷歌的例子，但我错了。

问题是在游标调用之前没有打开数据库。它应该如下所示：

```
private Cursor getSuggestions(String query) {
        String[] columns = { MyDBAdapter.KEY_TITLE,MyDBAdapter.KEY_ID};
              Log.d(TAG,"query1: " + query);

              try{
                  MyDB.open();
                  Cursor tmp = MyDB.getAllEntriesFTS(false, columns,
                        null, null, null, null, MyDBAdapter.KEY_TITLE, null, query);
                  MyDB.close();
              Log.d(TAG,"cursor: " + Integer.toString(tmp.getCount()));
              }
              catch(Exception e)
              {
                  Log.d(TAG,e.toString());
              }
              return tmp;
    } 
```

谢谢大家给我看。

# ios - 为什么我的核心数据保存缓慢？

> ID：14114060
> 
> 赞同：1
> 
> 时间：2013-01-01T20:45:41.290
> 
> 标签：ios, uitableview, core-data, nsmanagedobjectcontext

每次我尝试保存我的`NSManagedObjectContex`，每次都需要 1-8 秒。这是我的代码：

```
- (IBAction)save
{    
    if (self.managedObjectContext == nil) {
        self.managedObjectContext = [(RootAppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext];
    }

    if (self.brandText.text.length == 0 || self.modelText.text.length == 0) {
        UIAlertView *alertView = [[UIAlertView alloc]initWithTitle:@"Error" message:@"Please fill out the required fields" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
        UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(125, 40, 31, 7)];

        NSString *path = [[NSString alloc] initWithString:[[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"bullet.png"]];
        UIImage *bkgImg = [[UIImage alloc] initWithContentsOfFile:path];
        [imageView setImage:bkgImg];

        [alertView addSubview:imageView];

        [alertView show];

    } else {
        Hand *a = [NSEntityDescription insertNewObjectForEntityForName:@"Hand" inManagedObjectContext:self.managedObjectContext];
        a.brand = self.brandText.text;
        a.caliber = self.cText.text;
        self.managedObjectContext = self.app.managedObjectContext;
        a.notes = self.notesView.text;
        a.serialNumber = self.serialNumberText.text;
        a.nickname = self.nicknameText.text;
        a.model = self.modelText.text;
        a.gunImage = self.image.image;
        a.roundsFired = [NSString stringWithFormat:@"0"];
        a.cleanRounds = [NSString stringWithFormat:@"500"];
        a.showBadge = [NSNumber numberWithBool:YES];
        [self dismissViewControllerAnimated:YES completion:nil];

        NSError *error;     
        if (![self.managedObjectContext save:&error]) {
            UIAlertView *errorAlert = [[UIAlertView alloc]initWithTitle:@"Error" message:@"There was an internal error. \n Please restart the app and try again, Thank You" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
            [errorAlert show];
        }
    }
} 
```

该代码仅保存所有 textFields 文本。它这么慢的原因是什么？任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T21:08:25.513

根据你的问题很难理解发生了什么，但我会修改`else`声明如下......

```
else {
    Hand *a = [NSEntityDescription insertNewObjectForEntityForName:@"Hand" inManagedObjectContext:self.managedObjectContext];
    a.brand = self.brandText.text;
    a.caliber = self.cText.text;
    // why this?
    // self.managedObjectContext = self.app.managedObjectContext;
    a.notes = self.notesView.text;
    a.serialNumber = self.serialNumberText.text;
    a.nickname = self.nicknameText.text;
    a.model = self.modelText.text;
    a.gunImage = self.image.image;
    a.roundsFired = [NSString stringWithFormat:@"0"];
    a.cleanRounds = [NSString stringWithFormat:@"500"];
    a.showBadge = [NSNumber numberWithBool:YES];        

    NSError *error;     
    if (![self.managedObjectContext save:&error]) { // error during saving
        UIAlertView *errorAlert = [[UIAlertView alloc]initWithTitle:@"Error" message:@"There was an internal error. \n Please restart the app and try again, Thank You" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
        [errorAlert show];
    } else { // the save completes correctly, dismiss the view controller
        [self dismissViewControllerAnimated:YES completion:nil];
    }
} 
```

如果你想监控 Core Data，你应该通过 Instrument 来做。此外，您可以按如下方式设置 Xcode：[XCode4 和核心数据：如何启用 SQL 调试](https://stackoverflow.com/questions/6428630/xcode4-and-core-data-how-to-enable-sql-debugging)。

**编辑**

由于图像保存缓慢（根据您的评论），因此您应该依赖这些规则。

[核心数据 - 存储图像 (iPhone)](https://stackoverflow.com/questions/2090028/core-data-storing-images-iphone)

**编辑 2**

好的，由于您事先不知道图像的大小（以字节为单位），我真的建议将图像存储在文件系统中，而不是存储在核心数据存储中。在数据库中只保存图像的路径。图像将保存在背景中。这是为了防止 UI 阻塞。

否则，如果 iOS 5 是最低要求，请使用外部存储标志。 [如何在 Core Data 中为二进制数据启用外部存储](https://stackoverflow.com/questions/8484259/how-to-enable-external-storage-for-binary-data-in-core-data)

希望有帮助。

# c++ - QTableWidget 中的 SelectedRows 列表

> ID：14114061
> 
> 赞同：1
> 
> 时间：2013-01-01T20:45:49.700
> 
> 标签：c++, qt

我从 QTableWidget 获取选定的行时遇到问题。我有这样的表：

```
[id]  [ key ]
 0     test
 1     pass 
```

我想获取每一行的键值。我试过 QTableWidget->selectedIndexes(); 但它说它受到保护，我无法访问它。当我尝试 QTableWidget->SelectionModel->selectedIndexes 时，我不知道如何循环遍历列表并获取键值。有谁知道更好的方法我该怎么做？问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T20:52:10.810

我假设您将表格小部件的选择行为设置为选择*行*。

您始终可以访问任何项目视图/小部件的所谓“选择模型”。`QTableWidget`继承自`QAbstractItemView`，这使您[可以访问此特殊模型](http://doc.qt.digia.com/qt/qabstractitemview.html#selectionModel)。这个模型可以告诉你[选择的行](http://doc.qt.digia.com/qt/qitemselectionmodel.html#selectedRows)作为一个列表`QModelIndex`，然后它可以告诉你[该行](http://doc.qt.digia.com/qt/qmodelindex.html#row)。获得它们后，您可以访问[table content](http://doc.qt.digia.com/qt/qtablewidget.html#item)，在您的情况下是索引为 1 的列中的文本（键列）。

```
static const KEY_COLUMN = 1;

QList<QString> selectedKeys;
QItemSelectionModel *selectionModel = ui->tableWidget->selectionModel();
foreach(QModelIndex index, selectionModel->selectedRows())
    selectedIDs << ui->tableWidget->item(index->row(), KEY_COLUMN)->text(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T20:54:29.213

因为你正在使用`QTableWidget`，你可能想被调用[`selectedItems()`](http://qt-project.org/doc/qt-4.8/qtablewidget.html#selectedItems)。您的结果将基于您设置的选择行为，通过[`setSelectionBehavior()`](http://qt-project.org/doc/qt-4.8/qabstractitemview.html#selectionBehavior-prop)

当您有一个项目列表时，您可以专门获取第二列项目（如果尚未选择它）：

```
QTableWigetItem *keyItem = table->item(anItem->row(), 1);
QString val = keyItem->text(); 
```

# ruby-on-rails - 使用 private_pub gem 时无法运行 faye 服务器

> ID：14114062
> 
> 赞同：2
> 
> 时间：2013-01-01T20:45:50.220
> 
> 标签：ruby-on-rails, ruby-on-rails-3, railscasts, faye, private-pub

我尝试跟随这个截屏视频[http://railscasts.com/episodes/316-private-pub](http://railscasts.com/episodes/316-private-pub)，它使用 private_pub gem 实现了基本的实时功能。

我`rackup private_pub.ru -s thin -E production`以前是启动faye服务器（瘦服务器），但是每次去localhost:3000，faye服务器都会因为以下原因关闭`Segmentation fault (core dumped)`

chrome中的控制台给出了这个错误

`Failed to load resource http://localhost:9292/faye.js`

那么，如何运行服务器呢？

导轨版本 3.1.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-02T00:00:38.790

看看这个问题：[“BUG segmentation fault” while working with private_pub gem](https://stackoverflow.com/questions/14118758/bug-segmentation-fault-while-working-with-private-pub-gem)

> 尝试不同的 ruby​​ 版本/补丁。
> 
> 如果这样可以修复它，那么它可能是 1.9.3p362 中的一个错误。您可能应该提交一份错误报告，以便核心开发人员了解它，或者，如果您愿意，请查看源代码并尝试自己修补并提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-28T07:32:17.367

在初始化程序中添加瘦服务器启动命令，因此每次启动应用程序后，thin 和 faye 都会启动。

像这样试试

Thread.new do system("rackup private_pub.ru -s thin -E production") end

# php - php函数只打印格式化的数字

> ID：14114067
> 
> 赞同：0
> 
> 时间：2013-01-01T20:46:37.093
> 
> 标签：php, regex, string, numbers

我需要一个简单的函数来从字符串中提取数字。这些数字必须在插入数组之前进行验证，因为存在不同类型的数字。

例如：

> `$string ="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec in tortor dui, ac ornare tellus. Aenean condimentum eleifend commodo. Cras commodo magna a enim semper nec vulputate turpis ultricies. Etiam sodales urna quis mauris commodo gravida. Etiam eu varius ligula. Mauris in faucibus ligula. In hac habitasse platea dictumst. Praesent aliquet, ligula et tristique vehicula, leo lorem accumsan nisl, vitae eleifend odio 1234 urna at magna. Integer 123456789 sit amet tincidunt enim. Curabitur eu tellus justo. Duis 987654321 vehicula tortor in eros consequat 12345 id lacinia lacus ornare.";`

我需要的是获得一个只有这些合格数字的数组：

*   123456789
*   987654321

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T20:50:57.500

您可以使用`preg_match_all`

```
preg_match_all("/[0-9]{9}/", $string, $match);
print(implode("\n", $match[0])); 
```

*用于教育目的*

```
echo implode("\n", array_filter(explode(" ", $string), function ($a) {
    return is_numeric($a) and strlen($a) == 9;
})); 
```

两者都会输出

```
123456789
987654321 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:11:01.467

`preg_match_all`是您正在关注的功能。下面的代码将匹配任何长度为 9 个字符的数字。

这是一个例子：

```
preg_match_all('/[0-9]{9}/', $string, $matches);
echo implode("\n", $matches[0]); 
```

这将导致：

```
123456789
987654321 
```

# c# - 自长时间操作开始以来，很难确定 ASP.Net 中的数据缓存是否已更改

> ID：14114077
> 
> 赞同：2
> 
> 时间：2013-01-01T20:47:44.560
> 
> 标签：c#, asp.net, caching

我将一个列表插入到 ASP.Net 中的数据缓存中，如下面的示例代码所示。我使用 C# 作为编程语言。

我无法找到以下问题的解决方案：

1.  启动一个可能持续 0.1 秒到 20 秒的长数据库操作。
2.  **在此操作结束时，我需要确定名称为“dSummary”的缓存是否在长时间操作开始后（即操作正在进行时）被重新插入或从数据库刷新。**

我用来插入缓存项的代码如下：

```
 List<Doc> ds = GetDocSummary();
   System.Web.HttpContext.Current.Cache.Insert("dSummary", ds, null, 
           DateTime.Now.AddMinutes(15), System.Web.Caching.Cache.NoSlidingExpiration); 
```

**更新 1：**

在收到这么多回复后，我认为一种可能的万无一失的方法是将 guid 字符串与 List 对象一起存储在缓存中。然后我可以简单地比较长操作前后存储在Cache中的对象的guid字符串属性。如果它们相同，则尚未重新插入 Cache["dSummary"]，否则已重新插入。所以我需要使用“Doc”类的以下扩展类。

```
public class DocX : Doc
 { 
          public UniQueIdentifier { get;set; }
          public DocX ( Doc doc, string unqiueIdentifier)
             {
                  this.Doc = doc;
                  this.UniqueIdentifier = unqiueIdentifier;

            }
 } 
```

然后我将使用以下代码插入缓存：

```
 List<Doc> ds = GetDocSummary();
       System.Web.HttpContext.Current.Cache.Insert("dSummary",new DocX( ds,  
                new Guid.Newguid().ToString() ), null, 
           DateTime.Now.AddMinutes(15), System.Web.Caching.Cache.NoSlidingExpiration); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T20:51:58.737

我会在您添加或更新包含您修改它的时间戳的 dSummary 时添加另一个 Cache 属性。

您可以在长时间运行的操作开始时记录原始值，并在结束时将其与缓存中的当前值进行比较；如果值不同，则更新数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T21:12:33.870

在开始操作之前，`GetDocSummary()`您可以从缓存中获取当前值并将该值（或来自该值的哈希，如果内存可能是一个问题）存储在局部变量中。操作完成后，在将数据添加到缓存之前，将局部变量与当前缓存的值进行比较。

根据评论添加一些示例，使用`Tuple`：

```
var cacheEntry = new Tuple<List<Doc>, DateTime>(ds, DateTime.Now); 
```

执行后`GetDocSummary()`，从缓存中获取您的条目并查看日期是否介于开始和结束此操作之间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T21:03:17.717

假设有两个或更多线程想要获取文档摘要，我猜您不希望所有线程都计算摘要（正如您所说，这是一个长时间运行的计算密集型操作）。在这种情况下，我采用以下解决方案：

```
//declare lock object for implementing critical section
private static object docSummaryLock = new object();

//this is the body of GetDocSummary method
List<Doc> ds = (List<Doc>) System.Web.HttpContext.Current.Cache.Get("dSummary");
if (ds != null) return ds;
//summary not found in cache, computing the doc summary occurs in critical section
lock (docSummaryLock)
{
    //there is possibility that another thread waited for obtaining the lock and the summary may be already in cache
    ds = (List<Doc>) System.Web.HttpContext.Current.Cache.Get("dSummary");
    if (ds != null) return ds;

    //compute the summary
    ds = GetDocSummary();
    System.Web.HttpContext.Current.Cache.Insert("dSummary", summaries, null, 
    DateTime.Now.AddMinutes(15), System.Web.Caching.Cache.NoSlidingExpiration);
    return ds;
} 
```

# java - 具有相同数据的两个对象不一样？

> ID：14114081
> 
> 赞同：1
> 
> 时间：2013-01-01T20:48:16.200
> 
> 标签：java, object, compare, equals

我有一个像这样的测试类：

```
public class CompareObjects {

public static class Obj {
    public int i;

    public Obj(int i) {
        this.i = i;
    }
}

public static void main(String[] args) {
    Obj o1 = new Obj(0);
    Obj o2 = new Obj(0);

    if(o1 == o2) {
        System.out.println("Equal");
    }else{
        System.out.println("Not equal");
    }
} 
```

}

我虽然测试会返回“Equal”，但事实并非如此。为什么Java不认为具有相同组件的两个对象不相同？我在这里做错了吗？我有一种感觉，当我开始学习 Java 时，我完全忽略了一些东西。

此外，我使用 equals() 方法对两者进行了测试，得到了相同的结果。我提出这个问题的原因是我希望能够使用 contains() 方法测试 ArrayList 以查看一个对象是否具有与另一个对象相同的组件，因此是否相等。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T20:51:02.807

`==`比较对象的*引用*。例如：

```
Obj a = new Obj(0);
Obj b = a;
//a == b 
```

尝试实施`equals()`：

```
public static class Obj {
    public int i;

    public Obj(int i) {
        this.i = i;
    }

    @Override
    public boolean equals(Object other) {
        if (other == this) return true;
        if (!(other instanceof Obj) || other == null) return false;
        return i == ((Obj)other).i;
    }

    @Override
    public int hashCode() {
        return i;
    }
} 
```

然后，您可以使用`if(o1.equals(o2)) {`. 但是，这并不是一个很好的示例，请阅读[此（链接）](http://javarevisited.blogspot.com/2011/02/how-to-write-equals-method-in-java.html)以获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T20:50:47.407

`==`仅当您比较相同的对象 [即相同的内存位置] 时才返回 true。

如果要按字段比较对象，则必须重载该`equals()`方法，以便在它们上诱导[等价关系](http://en.wikipedia.org/wiki/Equivalence_relation)。

```
public boolean equals(Object other){

    return this.i == other.i;

} 
```

确保该`equals()`方法尊重自反性、对称性、传递性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T20:50:54.847

`==`比较引用相等性，即它们是否引用内存中的同一对象。

您需要覆盖`equals()`方法，并在您想比较它们的值时使用它。`hashCode()`此外，例如 HashMap 使用的覆盖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-01T20:51:11.040

`==`运算符不检查类数据中的相等性；相反，它会检查它们是否在内存中的相同位置。如果您这样做`o2 = o1`而不是以相同的方式初始化它们，它们将在内存中的相同位置，因此`o2==o1`return `true`. 但是，由于它们是单独初始化的，因此它返回 false。相反，您应该定义一个`equals`方法并实现它。

# asp.net - 如何在 MVC4 的局部视图中添加脚本？

> ID：14114084
> 
> 赞同：43
> 
> 时间：2013-01-01T20:48:54.403
> 
> 标签：asp.net, asp.net-mvc, razor, asp.net-mvc-4, razor-2

这是我在部分视图中的代码

```
@model Contoso.MvcApplication.Models.Exercises.AbsoluteArithmetic

@using(Html.BeginForm())
{
<div>
    <span style="width: 110px; float:left; text-align:center; font-size:2.5em;">@Model.Number1</span>
    <span style="width: 110px; float:left; text-align:center; font-size:2.5em;">+</span>
    <span style="width: 110px; float:left; text-align:center; font-size:2.5em;">@Model.Number2</span>
    <span style="width: 110px; float:left; text-align:center; font-size:2.5em;">=</span>
    <span>
            @Html.EditorFor(model => model.Result)
            @Html.ValidationMessageFor(model => model.Result)
    </span>
</div>
}

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
} 
```

请注意，在我的代码底部，我有一个`@section`，并且我意识到如果我在那里设置断点，它就不会运行。如果我在 _Layout.cshtml 中移动那条线，效果会很好，但这不是想法。

如何在部分剃刀视图中告诉 MVC4 我要添加该库？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2016-03-22T15:02:36.640

您可以 `@Scripts.Render("~/Scripts/my-script.js")`用于 .js 文件和`@Styles.Render("~/Content/my-Stylesheet.css")`css 文件。

注意：它也适用于特定捆绑包更多详细信息 - ' [http://www.asp.net/mvc/overview/performance/bundling-and-minification](http://www.asp.net/mvc/overview/performance/bundling-and-minification) '

它适用于 razor 中的任何子页面，包括部分视图。欲了解更多信息谷歌这些助手的使用

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-12-06T13:08:40.967

可以直接在局部视图 html 的末尾添加脚本，不需要脚本部分（因为脚本部分不会在局部视图中呈现）

```
<script language="javascript">
   // Your scripts here
   // ....
</script> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-01T21:49:54.393

您不能从部分渲染布局部分。将部分定义移动到父页面或布局。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-01T22:05:52.943

查看我的答案[How to render a Section in a Partial View](https://stackoverflow.com/a/13765578/209259)，它允许您在任何视图/部分视图中定义脚本和样式。它还负责处理重复的包含。

我个人的看法是，部分不是样式的好解决方案，并且 javascript*包含*.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-04-20T17:35:45.240

此问题没有通用解决方案，但您可以执行以下最简单的方法：

1）您可以创建一组扩展方法，如下所示：

> [https://stackoverflow.com/a/6671766/5208058](https://stackoverflow.com/a/6671766/5208058)

2) 只需将您的 javascript 代码移动到一个单独的局部视图中，然后在您的主视图上呈现 2 个局部视图。一个用于主要部分视图，另一个用于您的脚本，如下所示：

```
{
    // markup and razor code for Main View here

    @Html.Partial("Main_PartialView")
}

@section Scripts
{
    @Html.Partial("JavaScript_PartialView")
} 
```

希望能帮助到你。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-01-12T13:03:50.523

这对我有用，允许我将 JavaScript 和 HTML 用于同一文件中的部分视图，以便于阅读

*在使用名为“ _MyPartialView.cshtml* ”的局部视图的视图中

```
<div>
    @Html.Partial("_MyPartialView",< model for partial view>,
            new ViewDataDictionary { { "Region", "HTMLSection" } } })
</div>

@section scripts{

    @Html.Partial("_MyPartialView",<model for partial view>, 
                  new ViewDataDictionary { { "Region", "ScriptSection" } })

 } 
```

在部分视图文件中

```
@model SomeType

@{
    var region = ViewData["Region"] as string;
}

@if (region == "HTMLSection")
{

}

@if (region == "ScriptSection")
{
        <script type="text/javascript">
    </script">
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-14T16:32:33.950

这个 Stackoverflow 页面为这个问题提供了完整的解决方案： [Using section in Editor/Display templates](https://stackoverflow.com/questions/5433531/using-sections-in-editor-display-templates/5433722#5433722)

TL;DR：只需将 Forloop.HtmlHelpers nuget 包[https://www.nuget.org/packages/Forloop.HtmlHelpers/](https://www.nuget.org/packages/Forloop.HtmlHelpers/)添加到您的项目中，即可在 ASP.NET MVC 中从 Razor 部分视图和模板运行 Javascript。我个人在我的 MVC 5 项目中使用了它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-25T20:22:20.720

如果您只想在某些部分视图中包含特定脚本并避免在整个应用程序中不必要地传播它们，您可以执行以下操作：

定义一个指向您的空 javascript 文件的包`BundleConfig.cs`：

```
 bundles.Add(new ScriptBundle("~/bundles/empty").Include(
                    "~/Scripts/empty.js"
            )); 
```

在你的 head 部分`_Layout.cshtml`，添加这个变量：

```
@{
        ViewBag.AdditionalBundle = String.IsNullOrEmpty(ViewBag.AdditionalBundle) ? "~/bundles/empty" : ViewBag.AdditionalBundle;
    } 
```

在你的底部`_Layout.cshtml`，渲染你想要的任何额外的包：

```
@Scripts.Render("~/bundles/lib")
    @Scripts.Render(@ViewBag.AdditionalBundle);
    @RenderSection("scripts", required: false) 
```

最后，在需要任何特定脚本的局部视图中，只需将相应的包添加到变量中：

```
ViewBag.AdditionalBundle = "~/bundles/mySpecificBundle"; 
```

部分视图在 之前呈现`_Layout.cshtml`，因此您需要在文件顶部进行验证。它是这样的：如果任何部分视图为 分配了值`ViewBag.AdditionalBundle`，则使用它。否则，渲染一个空脚本。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-18T12:17:37.913

新手技巧：在已加载的文件中定义一个函数，并在部分视图加载时调用该函数。

1.有一个单独的 js 文件，你可以用你通常的包加载：

## BundleConfig.cs

```
bundles.Add(new ScriptBundle("~/bundles/CustomScripts").Include(
    "~/Scripts/Custom/partial-view.js"
)); 
```

2.  像布局中的任何其他包一样加载自定义脚本包

## _Layout.cshtml

```
@Scripts.Render("~/bundles/CustomScripts"); 
```

3.  在自定义 js 文件中定义一个函数，在我们的例子中是 OnPartialViewLoad 函数：

## 部分视图.js

```
function OnPartialViewLoad() {
    // ... your onLoad work
} 
```

4.  在局部视图的末尾添加一个 document.ready() 函数并调用 onLoaded 函数。

## 部分视图.cshtml

```
<script type="text/javascript">
    $(document).ready(function(){
        OnPartialViewLoad();
    });
</script> 
```

# logic - 如何使用 XOR 门实现此功能？

> ID：14114090
> 
> 赞同：2
> 
> 时间：2013-01-01T20:49:25.310
> 
> 标签：logic, xor

我必须用 XOR 门实现下面的功能。我画了卡诺图并写下了得到的最小化函数。但是现在我被 AND 和 OR 门困住了，我应该怎么做才能得到 XOR 门？

![F](../Images/81f9c9066e56794f80422322ffa5f85a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:09:09.053

我的解决方案如下所示：

```
F = Sum(1,2,4,7,8,11,13,14);

F = A' B' C' D + A' B' C D' + A' B C' D' + A' B C D + A B' C' D' + A B' C D + A B C' D + A B C D';

F = XOR(C, D) & A' B' + XOR(C, D) & A B  + XOR(A, B) & C' D' + XOR(A, B) & C D;

F = XOR(C, D) & XOR(A, B)'  + XOR(A, B) & XOR(C, D) ';

F = XOR(XOR(A, B), XOR(C, D));

    A B C D  XOR(A, B)  XOR(C, D)  F
00  0 0 0 0      0          0      0
01  0 0 0 1      0          1      1
02  0 0 1 0      0          1      1
03  0 0 1 1      0          0      0
04  0 1 0 0      1          0      1
05  0 1 0 1      1          1      0
06  0 1 1 0      1          1      0
07  0 1 1 1      1          0      1
08  1 0 0 0      1          0      1
09  1 0 0 1      1          1      0
10  1 0 1 0      1          1      0
11  1 0 1 1      1          0      1
12  1 1 0 0      0          0      0
13  1 1 0 1      0          1      1
14  1 1 1 0      0          1      1
15  1 1 1 1      0          0      0 
```

此类问题的一个方便工具是“Logic Friday 1”

# python - 寻找 elif & if 的良好替代品，例如 switch case

> ID：14114091
> 
> 赞同：0
> 
> 时间：2013-01-01T20:49:38.257
> 
> 标签：python, if-statement, switch-statement

> **可能重复：**
> [python中switch语句的替换？](https://stackoverflow.com/questions/60208/replacements-for-switch-statement-in-python)

鉴于这种方法：

```
def getIndex(index):
    if((index) < 10):
        return 5
    elif(index < 100):
        return 4
    elif(index < 1000):
        return 3
    elif(index < 10000):
        return 2
    elif(index < 100000):
        return 1
    elif(index < 1000000):
        return 0 
```

我想把它做成 switch-case 风格，但是 Python 不支持 switch-case 。

有什么替代品吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T20:54:35.340

怎么样`6-len(str(index))`？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T21:00:35.283

经典的pythonic方法是使用字典，其中键是您的测试，值是反映您打算做什么的可调用函数：

```
def do_a():
    print "did a"

self do_b():
    print " did b"

#... etc

opts = {1:do_a, 2:do_b}

if value in opts: 
    opts[value]()
else:
    do_some_default() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-01T21:00:31.820

在这个特定的例子中，我只会使用数学：

```
def get_index(index):
    return 6 - int(round(math.log(index, 10))) 
```

您必须使用内置函数[`round`](http://docs.python.org/2/library/functions.html#round)作为`math.log`返回浮点数。

# ruby-on-rails - 找不到 id=15 的任务管理员

> ID：14114094
> 
> 赞同：0
> 
> 时间：2013-01-01T20:50:12.747
> 
> 标签：ruby-on-rails, html-table

我有两个控制器：Tasksadmins 和 Workers。

我定义了一个表，叫做：Tasksadmin，并有参数：admin_email，worker_email，task，done。完成选项是复选框。

在 Tasksadmins 控制器中，我定义了：

```
def edit
  @tasksadmin = Tasksadmin.find(params[:id])
end 
```

在这个控制器中，我可以编辑表格的所有行。它工作正常！

在 Workerscontroller 中，我试图定义：

```
def edit
  @tasksadmin = Tasksadmin.find(params[:id])
end 
```

我这样做是因为我想获取该行的所有参数，但我会让工作人员选择仅更改`done`.

不幸的是，我收到了这个错误：

```
ActiveRecord::RecordNotFound in WorkersController#edit
Couldn't find Worker with id=15 
```

我想我明白了，因为网址是：`localhost:3000/workers/15/edit`

（注意：`workers`/15/edit）

为了了解问题出在哪里，我在我的`models/workers/edit.html.erb`:

```
hello! 
```

所以我认为问题在于`workers`url 中的工作：/

请问我该如何解决？

**更新：**

这是 的索引`workerscontroller`：

```
def index
  @tasks_worker = Tasksadmin.where(:worker_mail => current_user.email)

  respond_to do |format|
    format.html # index.html.erb
    format.json { render json: @workers }
  end
end 
```

这是`index.html.erb`：

```
<h1>Listing workers</h1>

<table>
   <tr>
      <th>Admin_mail</th>
      <th>Task</th>
      <th>Done</th>
      <th></th>
      <th></th>
      <th></th>
   </tr>

   <% @tasks_worker.each do |task| %>
   <tr>
      <td><%= task.admin_mail %></td>
      <td><%= task.task %></td>
      <td><%= task.done %></td>
      <td><%= link_to 'Edit', edit_worker_path(task) %></td>
   </tr>
   <% end %>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T20:55:40.287

似乎 ID=15 的 Worker 不存在。

```
Worker.find(params[:id]) 
```

`ActiveRecord::RecordNotFound`如果该 Worker 不存在，将引发。

您可以进入 rails 控制台并尝试：

```
Worker.find(15) 
```

如果你想找到 return nil 而不是 raise 你可以使用：

```
Worker.find_by_id(params[:id]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T21:36:27.143

我对此不太确定（也许有人可以纠正我），但我认为

```
@tasksadmin = Tasksadmin.find(params[:id]) 
```

只是定义了变量`@tasksadmin`。

现在，如果您调用`localhost:3000/workers/15/edit`-URL，Rails 实际上正在搜索 ID 为 15 ( `Worker.find(15)`)的工作人员

你想要完成什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T14:23:10.383

我在 Workerscontroller 中添加了这一行：

```
load_and_authorize_resource :except => [:edit, :update] 
```

Tasksadminscontroller 中的这一行：

```
load_and_authorize_resource :except => [:update, :show] 
```

# jquery - 使用 jQuery 刷新 div 会破坏布局

> ID：14114106
> 
> 赞同：1
> 
> 时间：2013-01-01T20:51:11.730
> 
> 标签：jquery, html

我正在使用以下代码刷新 div，现在每当刷新页面时，它都会破坏布局，我不明白为什么会这样..

```
var auto_refresh = setInterval(
function() {
$('#loaddiv').fadeOut('slow').load('loadmore.php').fadeIn("slow");
}, 2000); 
```

重新加载后

![在此处输入图像描述](../Images/4a6d011884cc8224c4b7286fdfd81f84.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T20:57:45.643

您正在将整个页面插入到元素中，您可以将选择器传递给`load`方法。

```
var auto_refresh = setInterval(function() {
      $('#loaddiv').fadeOut('slow').load('loadmore.php #target', function(){
           $(this).fadeIn("slow")
      });
}, 2000); 
```

# javascript - 将 Datetime 对象转换为用户本地时间

> ID：14114108
> 
> 赞同：0
> 
> 时间：2013-01-01T20:51:16.567
> 
> 标签：javascript, python

我的问题是我似乎无法在 javascript 中将 UTC 日期转换为我的用户本地时间。

通过 Flask & Jinja，我正在渲染一个 Datetime 对象（天真，但它是一个 UTC datetime ），例如“2013-01-01 17:30:00”。

例如：

```
<p>The time is <span class="localtime">{{date}}</span></p> 
```

我想以“HH：mm”格式向我的用户显示他们本地时间的时间。

我尝试使用[Jquery-Localtime](http://code.google.com/p/jquery-localtime/)但它似乎不起作用。即使我更改计算机测试时间，我也总是得到 17:30。

我的最终结果应该看起来像

> 英国用户的时间是 17:30

和

> 纽约用户的时间是 12:30

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:04:54.303

```
var myDate = new Date();
var txtLocal = myDate.toLocaleDateString() +" " + myDate.toLocaleTimeString();
alert(txtLocal); 
```

# c++ - C++初始化模板类

> ID：14114111
> 
> 赞同：3
> 
> 时间：2013-01-01T20:51:33.383
> 
> 标签：c++, templates, vector

我对创建模板类时发生的事情感到有些困惑。我试图在构造过程中将成员 vector_ 的容量设置为 50（仅一次），但似乎容量从未正确设置，所以显然我不明白应该如何做到这一点。我已经包含了相关的代码片段以及控制台输出。感谢您的帮助！

向量的模板类：

```
template <typename T>
class V
{
  public:
    V()
    {
      std::cout << "capacity 1 = " << this->vector_.capacity() << "\n";
    };
    V(int capacity)
    {
      this->vector_.reserve(capacity);
      std::cout << "capacity 2 = " << this->vector_.capacity() << "\n";
    };
    int capacity() const { return this->vector_.capacity(); };
  private:
    std::vector<T> vector_;
}; 
```

初始化 R 的构造函数：

```
R::R()
{
  std::cout << "capacity 0 = " << this->s_.capacity() << "\n";
  this->s_ = V< std::vector< std::complex<float> > >(50);
  std::cout << "capacity 3 = " << this->s_.capacity() << "\n";
}; 
```

R类的标题：

```
class R
{
  public:
    R();
  private:
    V< std::vector< std::complex<float> > > s_;
}; 
```

输出到控制台：

```
capacity 1 = 0
capacity 0 = 0
capacity 2 = 50
capacity 3 = 0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T20:56:36.793

你没有设置它的大小，`std::vector<T>`而是它的容量。容量不是一个显着的属性`std::vector<T>`，因此不会被复制。您需要使用`resize()`来设置大小。

# android - Android中EditText的不同颜色

> ID：14114113
> 
> 赞同：7
> 
> 时间：2013-01-01T20:51:35.040
> 
> 标签：android, colors, android-edittext

我正在尝试使 EditText 的文本具有多种颜色。例如，如果我的文本是“It is a good day.”，是否可以将句子的“It is a”部分设为绿色而其余部分设为红色？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-01T21:05:14.803

我使用类似的东西使我的颜色的某些部分变为绿色：

```
final String text = "Some Text";
Spannable modifiedText = new SpannableString(text);
modifiedText.setSpan(new ForegroundColorSpan(getResources().getColor(R.color.green)), 0, lengthYouWant, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
textView.setText(modifiedText); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-01T21:09:49.260

你可以使用[spannables](http://developer.android.com/reference/android/text/Spannable.html)。

```
Spannable spannable = yourText.getText();
spannable .setSpan(new BackgroundColorSpan(Color.argb(a, r, g, b)), start, end, Spannable.SPAN_INCLUSIVE_INCLUSIVE); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-02T08:44:20.553

我也有这个烦恼。几个小时后，我想出了如何处理它：

```
 mYourTextView.addTextChangedListener(new TextWatcher() {

        private String oldContent = "";

        @Override
        public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        }

        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
            final String newContent = mYourTextView.getText().toString();

            if (newContent.length() > 10 && !oldContent.equals(newContent)) {
                oldContent = newContent;
                mYourTextView.setText(Html.fromHtml(
                        String.format("%s", "<font color='#000000'>" + newContent.substring(0, 10) + "</font>")
                                + "<font color='#ff0000'>" + newContent.substring(10, newContent.length()) + "</font>"));
                Log.d("onTextChanged", "Start : " + start);

                //move cursor after current character
                mYourTextView.setSelection(start + 1 > mYourTextView.getText().toString().length()
                        ? start : start + 1);

            }
        }

        @Override
        public void afterTextChanged(Editable s) {
        }
    }); 
```

此代码使前 10 个字符为黑色，后面的字符为红色。我们需要变量 oldContent 来防止循环无穷大，因为当 EditText 调用 setText() 然后 onTextChanged

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-01T21:05:17.993

是的。您将需要创建一个`Spannable`对象（a`SpannedString`或`SpannedStringBuilder`），然后在其上设置跨度以应用您寻找的颜色。

例如，[此示例项目](https://github.com/commonsguy/cw-omnibus/blob/master/RichText/Search)中的以下方法获取 a 的内容`TextView`，搜索用户输入的字符串，并用紫色背景颜色标记所有出现的位置，删除所有先前的标记：

```
 private void searchFor(String text) {
    TextView prose=(TextView)findViewById(R.id.prose);
    Spannable raw=new SpannableString(prose.getText());
    BackgroundColorSpan[] spans=raw.getSpans(0,
                                             raw.length(),
                                             BackgroundColorSpan.class);

    for (BackgroundColorSpan span : spans) {
      raw.removeSpan(span);
    }

    int index=TextUtils.indexOf(raw, text);

    while (index >= 0) {
      raw.setSpan(new BackgroundColorSpan(0xFF8B008B), index, index
          + text.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
      index=TextUtils.indexOf(raw, text, index + text.length());
    }

    prose.setText(raw);
  } 
```

在您的情况下，更改前景色将使用 a`ForegroundColorSpan`而不是 a `BackgroundColorSpan`。

事情变得有点棘手`EditText`，因为用户可以编辑文本，你需要选择你的标志来满足你想要的规则。例如，`Spanned.SPAN_EXCLUSIVE_EXCLUSIVE`会说：

*   在跨区中间输入的字符获得跨区的效果（例如，前景色）
*   在跨越区域之前或之后输入的字符被认为在跨越区域之外，因此不会获得跨越区域的效果

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-02T12:45:39.723

只是为了详细说明 WarrenFaith 的答案：

实现一个 TextWatcher

```
yourEditText.onFocusChangeListener = this

override fun beforeTextChanged(s: CharSequence?, start: Int, count: Int, after: Int) {}
override fun onTextChanged(s: CharSequence?, start: Int, before: Int, count: Int) {}
override fun afterTextChanged(s: Editable?) {
    val newTextStyle: Spannable = SpannableString(s?.toString())
    resources.getColor(R.color.color_w3w, requireActivity().theme)
    val span = ForegroundColorSpan(resources.getColor(R.color.your_color_here, requireActivity().theme))
    newTextStyle.setSpan(span, 0, 3, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE)//Will set the first three characters to 'R.color.your_color_here'
    s?.set(0, 3, span)
} 
```

# ruby-on-rails - 同时创建两个对象

> ID：14114114
> 
> 赞同：1
> 
> 时间：2013-01-01T20:51:35.273
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, geocoding

我试图同时创建两个对象，但由于某种原因，我的第二个对象的字段是空白的。

这些型号是：

```
Users: id, name, last, email, password ...
Locations: address, longitude, latitude. 
```

关系是这样的：

```
User has_many location
Location belongs_to users 
```

事件控制器创建方法：

```
def create
    @event = current_users.events.build(params[:event])
    @location = @event.locations.build(params[:location])
    @location.longitude = params[:longitude]
    @location.latitude = params[:latitude]
    respond_to do |format|
      if @location.save
        @location.longitude = params[:longitude]
        @location.latitude = params[:latitude]
        if @location.save
          if @event.save
            format.html { redirect_to @event, notice: 'Event was successfully created.' }
            format.json { render json: @event, status: :created, location: @event }
          else
            format.html { render action: "new" }
            format.json { render json: @event.errors, status: :unprocessable_entity }
          end
        end
      end
    end
  end 
```

和形式：

```
 <%= f.hidden_field :latitude %>
  <%= f.hidden_field :longitude %> 
```

但是，当我创建我的位置时，我会因为 and 而变得空白，但我的位置却被`longitude`填满`latitude`了`event_id`。有没有更好的方法同时创建两个对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T20:59:54.393

您的两个字段是使用表单生成器生成的`f`。我怀疑他们在`form_for`通话中。这样做的结果是字段名称将嵌套在模型的命名空间中。这意味着`params[<model name>][:longitude]`并且`params[<model name>][:latitude]`应该具有字段的内容。

您可以检查控制台以查看 rails 收到了哪些参数。或者，您可以将 params 哈希打印到控制台以检查其内容：（`p params`在您的操作中的某处）。

因此，为了让一切正常工作，您需要访问正确的参数。（有点像`params[:location][:longitude]`）

# matlab - 当输入向量的长度不同时，如何在 Matlab 中使用 interp1 重新采样

> ID：14114115
> 
> 赞同：1
> 
> 时间：2013-01-01T20:51:37.250
> 
> 标签：matlab, time-series, interpolation, sampling, resampling

我在这里的 .mat 文件中有两个变量：https: [//www.yousendit.com/download/UW13UGhVQXA4NVVQWWNUQw](https://www.yousendit.com/download/UW13UGhVQXA4NVVQWWNUQw)

testz 是累积距离的向量（以米为单位，单调且有规律地增加）

testSDT 是使用距离向量和速度向量生成的积分（累积）声波传播时间（以毫秒为单位）的向量（有一个创建间隔传播时间的中间步骤）

由于速度是一个连续可变的函数，因此得到的间隔行程时间以及积分行程时间都是非整数且大小可变

我想要的是以固定的时间间隔（例如 1 ms、2 ms、...、n ms）重新采样距离向量

困难在于最大行程时间 994.6659 小于 2 个向量中的样本数，因此使用 interp1 并不简单。IE：

X=testSDT -> 1680 个样本

Y=testz -> 1680 个样本

XI=[1:1:994] -> 994 个样本

这是我想出的代码。这是一个有效的代码，我认为这还不错。

```
%% Initial chores
M=fix(max(testSDT));
L=(1:1:M);     

%% Create indices
% this loops finds the samples in the integrated travel time vector
% that are closest to integer milliseconds and their sample number
for i=1:M
  [cl(i) ind(i)] = min(abs(testSDT-L(i)));
  nearest(i) = testSDT(ind(i)); 
end

%% Remove duplicates
% this is necessary to remove duplicates in the index vector (happens in this test). 
% For example: 2.5 ms would be the closest to both 2 ms and 2 ms
[clsst,ia,ic] = unique(nearest);
idx=(ind(ia));

%% Interpolation
% this uses the index vectors to resample the depth vectors at
% integer times
newz=interp1(clsst,testz(idx),[1:1:length(idx)],'cubic')'; 
```

据我所知，这段代码存在一个问题：我依靠向量 idx 作为我的 XI 进行插值。向量 idx 比向量 ind 短 1 个样本（删除了一个副本）。

因此，我的新时间将停止一毫秒。这是一个非常小的问题，不太可能出现重复，但我想知道是否有人可以想到解决方法，或者完全解决问题的不同方法。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:22:13.017

如果我对你的理解正确，你想推断出那个额外的点。您可以通过多种方式做到这一点，一种是将额外的点添加到 interp1 行。如果您有一些希望跟踪数据的功能，您可以通过将其拟合到数据然后获得该额外点或使用类似的工具来使用它[`fnxtr`](http://www.mathworks.com/help/curvefit/fnxtr.html)。

但是由于您使用该线路的方式，我无法理解您想要什么。您使用的第三个参数 `[1:1:length(idx)]`，只是系列 [1 2 3 ...]，通常在插值时，使用一些`x_i`兴趣点向量，尽管我怀疑您的兴趣点恰好是整数系列`1:length(idx)`，您想要的只是`[1:length(idx) xi]`，`xi`那个额外的点 x 轴值在哪里。

**编辑：**

`L`而不是循环只是从and产生矩阵形式`testSDT`，然后矩阵运算在执行以下操作时会更快一些`min(abs(...`：

```
 MM=ones(numel(testSDT),1)*L;
  TT=testSDT*ones(1,numel(L));
  [cl ind]=(min(abs(TT-MM)));
  nearest=testSDT(ind); 
```

# ruby - 无法使用 rvm 在 Mountain Lion 上安装 Ruby 1.9.3；Homebrew 找不到 libksba 库

> ID：14114116
> 
> 赞同：2
> 
> 时间：2013-01-01T20:51:42.840
> 
> 标签：ruby, rvm, osx-mountain-lion, homebrew

我无法让 rvm 安装 Ruby 1.9.3；即使已经下载并安装了 Homebrew 库“libksba”，它也会继续询问。当我运行“brew list”命令时，它会清楚地显示出来。

我还安装了 Xcode 4.5。

这是环境变量配置问题，我需要配置路径，让他们可以看到对方？如果是，我该如何配置它？

Homebrew 和 rvm 如何协同工作？我不清楚这一点。

谢谢你。

```
rvm install 1.9.3

Ruby (and needed base gems) for your selection will be installed shortly.
Before it happens, please read and execute the instructions below.
Please use a separate terminal to execute any additional commands.

  Notes for Mac OS X 10.8.2, Xcode 4.5.2.

For JRuby:  Install the JDK. See http://developer.apple.com/java/download/  # Current Java version "1.6.0_26"
For IronRuby: Install Mono >= 2.6
For Ruby 1.9.3: Install libksba # If using Homebrew, 'brew install libksba'
For Opal: Install Nodejs with NPM. See http://nodejs.org/download/

To use an RVM installed Ruby as default, instead of the system ruby:

    rvm install 1.8.7 # installs patch 357: closest supported version
    rvm system ; rvm gemset export system.gems ; rvm 1.8.7 ; rvm gemset import system.gems # migrate your gems
    rvm alias create default 1.8.7

And reopen your terminal windows.

Xcode and gcc:

: 
```

“酿造清单”命令输出

```
brew list
apple-gcc42 automake    libgpg-error    libxml2
autoconf    git     libksba     libxslt 
```

最近的会议：

brew upgrade libksba 错误：已安装 libksba-1.2.0 $ brew update 将 Homebrew 从 5909e2c6 更新为 0e0ef31f。==> 新公式 globus-toolkit postgres-xc ==> 更新公式 casperjs cunit dxflib mysql-cluster smake cdrtools dvdrtools ivy shmcat webalizer ==> 删除公式转码 unknown7cd1c3e98b07:~ pdenlinger$ rvm install 1.9.3

供您选择的 Ruby（和所需的基础 gem）将很快安装。在它发生之前，请阅读并执行以下说明。请使用单独的终端来执行任何其他命令。

Mac OS X 10.8.2、Xcode 4.5.2 的注意事项。

对于 JRuby：安装 JDK。请参阅[http://developer.apple.com/java/download/](http://developer.apple.com/java/download/) # 当前 Java 版本 "1.6.0_26" 对于 IronRuby：安装 Mono >= 2.6 对于 Ruby 1.9.3：安装 libksba # 如果使用 Homebrew，则 'brew install libksba'对于 Opal：使用 NPM 安装 Nodejs。见[http://nodejs.org/download/](http://nodejs.org/download/)

要使用 RVM 安装的 Ruby 作为默认值，而不是系统 ruby​​：

```
rvm install 1.8.7 # installs patch 357: closest supported version
rvm system ; rvm gemset export system.gems ; rvm 1.8.7 ; rvm gemset import system.gems # migrate your gems
rvm alias create default 1.8.7 
```

并重新打开您的终端窗口。

Xcode 和 gcc：

：

添加了 C 编译器错误：

```
rvm install 1.9.3
Searching for binary rubies, this might take some time.
No binary rubies available for: osx/10.8/x86_64/ruby-1.9.3-p362.
Continuing with compilation. Please read 'rvm mount' to get more information on binary rubies.
Installing Ruby from source to: /usr/local/rvm/rubies/ruby-1.9.3-p362, this may take a while depending on your cpu(s)...
ruby-1.9.3-p362 - #downloading ruby-1.9.3-p362, this may take a while depending on your connection...
ruby-1.9.3-p362 - #extracted to /usr/local/rvm/src/ruby-1.9.3-p362 (already extracted)
ruby-1.9.3-p362 - #configuring
Error running 'env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include ./configure --enable-shared --disable-install-doc --prefix=/usr/local/rvm/rubies/ruby-1.9.3-p362 --with-opt-dir=/usr/local/rvm/usr', please read /usr/local/rvm/log/ruby-1.9.3-p362/configure.log
There has been an error while running configure. Halting the installation.
$ cat /usr/local/rvm/log/ruby-1.9.3-p362/configure.log
[2013-01-01 20:20:35] env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include ./configure --enable-shared --disable-install-doc --prefix=/usr/local/rvm/rubies/ruby-1.9.3-p362 --with-opt-dir=/usr/local/rvm/usr
checking build system type... x86_64-apple-darwin12.2.1
checking host system type... x86_64-apple-darwin12.2.1
checking target system type... x86_64-apple-darwin12.2.1
checking for C compiler default output file name... 
configure: error: C compiler cannot create executables
See `config.log' for more details. 
```

环境变量标志：

```
$ brew update
Already up-to-date.
$ brew tap homebrew/dupes
Error: Already tapped!
$ brew install autoconf automake apple-gcc42
Error: autoconf-2.69 already installed
Error: automake-1.12.6 already installed
Error: apple-gcc42-4.2.1-5666.3 already installed
$ rvm pkg install openssl
Fetching openssl-1.0.1c.tar.gz to /usr/local/rvm/archives
Extracting openssl to /usr/local/rvm/src/openssl-1.0.1c
Configuring openssl in /usr/local/rvm/src/openssl-1.0.1c.
Compiling openssl in /usr/local/rvm/src/openssl-1.0.1c.
Installing openssl to /usr/local/rvm/usr

Please note that it's required to reinstall all rubies:

    rvm reinstall all --force

Updating openssl certificates
$ rvm reinstall all --force
$ rvm install 1.9.3
Searching for binary rubies, this might take some time.
No binary rubies available for: osx/10.8/x86_64/ruby-1.9.3-p362.
Continuing with compilation. Please read 'rvm mount' to get more information on binary rubies.
Installing Ruby from source to: /usr/local/rvm/rubies/ruby-1.9.3-p362, this may take a while depending on your cpu(s)...
ruby-1.9.3-p362 - #downloading ruby-1.9.3-p362, this may take a while depending on your connection...
ruby-1.9.3-p362 - #extracted to /usr/local/rvm/src/ruby-1.9.3-p362 (already extracted)
ruby-1.9.3-p362 - #configuring
Error running 'env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include ./configure --enable-shared --disable-install-doc --prefix=/usr/local/rvm/rubies/ruby-1.9.3-p362 --with-opt-dir=/usr/local/rvm/usr', please read /usr/local/rvm/log/ruby-1.9.3-p362/configure.log
There has been an error while running configure. Halting the installation.
unknown7cd1c3e98b07:~ pdenlinger$ cat /usr/local/rvm/log/ruby-1.9.3-p362/configure.log
[2013-01-02 09:58:08] env LDFLAGS=-L/opt/sm/pkg/active/lib CFLAGS=-I/opt/sm/pkg/active/include CPATH=/opt/sm/pkg/active/include ./configure --enable-shared --disable-install-doc --prefix=/usr/local/rvm/rubies/ruby-1.9.3-p362 --with-opt-dir=/usr/local/rvm/usr
checking build system type... x86_64-apple-darwin12.2.1
checking host system type... x86_64-apple-darwin12.2.1
checking target system type... x86_64-apple-darwin12.2.1
checking for C compiler default output file name... 
configure: error: C compiler cannot create executables
See `config.log' for more details.
$ cat config.log
cat: config.log: No such file or directory
$ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T23:39:07.290

您看到的是`rvm requirements`它的输出，使用`less`=> 使用向上/向下箭头导航并`q`退出并继续安装。

这些要求仅在您第一次安装 ruby​​ 时显示。

这是一个错误，损坏的代码已经修复[https://github.com/wayneeseguin/rvm/commit/848ef50f1b32c87e853f21e801f167a39e8c9c66](https://github.com/wayneeseguin/rvm/commit/848ef50f1b32c87e853f21e801f167a39e8c9c66)

# c++ - 删除对象

> ID：14114123
> 
> 赞同：0
> 
> 时间：2013-01-01T20:52:36.037
> 
> 标签：c++, pointers, new-operator

我对此很陌生，只是想问一个关于删除对象的快速问题。

我有一个名为 MyClass1 的对象，从中我有许多其他类，MyClassA、MyClassB 等。

现在我应该在 MyClass1 中执行此操作：

```
MyClass1::~MyClass1()
{

delete MyClassA;
delete MyClassB;

} 
```

或者当我删除 MyClass1 时会自动删除 MyClass1 中创建的所有内容吗？

另外，如果我在 MyClassA 和 MyClassB 中创建了更多对象，是否也必须在各自的类中手动删除这些对象？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T21:02:30.087

如果你问这个，你只是在学习 C++，所以最好的建议是 - 两者都不是。您应该了解这些东西（动态分配和内存管理 - 请参阅 Guillaume 对此的回答），但您**真正应该做**的是使用**RAII**（google this）。正确的 C++ 方法是：

```
struct  MyClass1
{
  MyClassA mA;
  std::shared_ptr<MyClassB> mB;

  MyClass1() : mB(new MyClassB)
  {

  }
}; 
```

看？不再需要析构函数，这意味着您也不需要复制构造函数或复制赋值运算符（这是 Guillaume 的答案存在缺陷的地方 - 它缺少最后两个）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T20:56:27.607

`delete`仅当您使用运算符创建对象时才调用运算`new`符

```
struct  MyClass1
{
  MyClassA mA;
  MyClassB * mB;

  MyClass1()
  {
    mB = new MyClassB;
  }

  ~MyClass1()
  {
    delete mB;
  }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T21:10:34.607

您不能删除不是指针的对象，因为这不是`delete`. 它旨在释放与对象关联的动态内存。也就是说，`new`必须删除任何创建的内容。您可以拥有指向类的指针，并且它们可以被删除。但是由于没有分配任何东西`new`，所以没有必要使用`delete`. 实际上，该类将在创建它的范围结束时从内存中销毁。这些对象在堆栈上分配，而动态内存在堆上。堆栈上的对象具有自动存储持续时间（在其范围末尾删除，除非它声明`static`在这种情况下它具有[“静态”存储持续时间](http://en.cppreference.com/w/cpp/language/storage_duration)); 此外，堆上的对象具有动态存储持续时间。C++ 中的动态内存由您控制，这就是我们被赋予的原因`new`（`delete`因为 C++ 期望我们自己处理内存）。否则，删除未构造的对象`new`是未定义的行为，可能会导致崩溃。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-01T21:34:22.847

`delete`应用于*对象*，而不是*类*。通常，仅当您调用创建对象时，才需要调用`delete`（或安排通过共享指针或通常使用 RAII 习惯用法自动调用它） 。`new`例外情况是某些（库？）调用的返回值是（库的？）文档明确声明调用者必须处理的对象（在这种情况下，将调用视为您拥有`delete`的 a 的包装器）`new`成为负责。）当然，如果可能的话，应该避免使用这样的 API。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-01T23:05:17.327

如果是 Qt，请使用[`QPointer`](http://qt-project.org/doc/qt-4.8/qpointer.html)! 它是一个智能指针：析构函数中不需要任何东西。

```
#include <QPointer>

class MyClass1
{
  QPointer<MyClassA> pA;
  QPointer<MyClassB> pB;
}; 
```

# javascript - 如何删除文本区域中的文本，以便将其输入到本机编辑历史记录中？

> ID：14114124
> 
> 赞同：6
> 
> 时间：2013-01-01T20:52:40.527
> 
> 标签：javascript, textarea

我有一种迷你应用程序，除其他外，它可以手动修改输入文本区域。简单地设置值（并可选择恢复光标/滚动位置）有一个很大的缺点：它打乱了编辑历史。所以我使用这个函数进行所有修改：

```
function type(el, str) {
    var e = document.createEvent('TextEvent');
    e.initTextEvent('textInput', true, true, null, str);
    el.dispatchEvent(e);
} 
```

对于我的项目来说，糟糕的支持是可以的，并且该功能非常适合插入文本和替换它（选择要替换的文本，然后调用`type`）。但是当它被一个空字符串调用时，它什么都不做。

对于某些删除，我可以通过选择要删除的文本和其他内容来解决此问题，重新键入多余的位，然后适当地移动光标。但是，如果我们要删除 textarea 中的所有内容，这是不可能的。

那么有没有人知道一种解决方法，或者其他方式来修改 textarea 的值而不会弄乱编辑历史？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:05:27.063

不要传入空字符串，而是传入`\0`. 这似乎在[这里](http://jsfiddle.net/xKDrg/)工作。或者你可以像这样检测一个空字符串：

```
function type(el, str) {
    var e = document.createEvent('TextEvent');
    e.initTextEvent('textInput', true, true, null, str || "\0");
    el.dispatchEvent(e);
} 
```

# sql - 旧数据库中的 upsize_ts 列 - 这是什么意思？

> ID：14114125
> 
> 赞同：10
> 
> 时间：2013-01-01T20:52:42.273
> 
> 标签：sql, sql-server, database, database-design

我们必须使用遗留数据库，并且许多表都有一个称为数据类型的列`upsize_ts`，`timestamp`与存储的数据无关。

它的目的是什么？这是某种`rowversion`列吗？我们可以删除该列吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-03T15:02:14.323

我发现，使用升迁向导将 MS Access 数据库升级到 MSSQL 时会创建“upsize_ts”列：

> 升迁是将部分或所有数据库对象从 Microsoft Access 数据库 (.mdb) 迁移到新的或现有的 Microsoft SQL Server 数据库或新的 Microsoft Access 项目 (.adp) 的过程。

升迁向导文档提到以下内容：

> 时间戳列 默认情况下，升迁向导会在 SQL Server 表中创建数据类型为时间戳的新列，这些表是从包含浮点（单或双）、备注或 OLE 字段的 Microsoft Access 表生成的。

* * *

> 我们可以删除该列吗？

如果 MS Access 仍将使用数据库（我们的应用程序就是这种情况），则不应删除此字段。

* * *

更多关于升迁向导：

[http://office.microsoft.com/en-us/access-help/use-the-upsizing-wizard-HP005273009.aspx](http://office.microsoft.com/en-us/access-help/use-the-upsizing-wizard-HP005273009.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T20:56:30.073

> 这是某种 rowversion 列吗？

是的。在 2008 之前的 SQL Server 版本中，[`TIMESTAMP`](http://msdn.microsoft.com/en-us/library/ms182776%28v=sql.90%29.aspx)相当于[`ROWVERSION`](http://msdn.microsoft.com/en-us/library/ms182776%28v=sql.100%29.aspx).

> 我们可以删除该列吗？

没有人可以为您回答这个问题 - 您需要确定它是否真的没有在任何地方使用。

# ruby-on-rails - Ruby 查看 csv 数据

> ID：14114129
> 
> 赞同：2
> 
> 时间：2013-01-01T20:53:09.217
> 
> 标签：ruby-on-rails, ruby, arrays, csv

我从 csv 文件中获取一些数据（以及如何在 csv 中选择前 20 个？），例如：

```
A B C
D E F 
```

还有方法：

```
def common_uploader
    require 'csv'
    arr = CSV.read("/#{Rails.public_path}/uploads_prices/"+params[:file], {:encoding => "CP1251:UTF-8", :col_sep => ";", :row_sep => :auto, :headers => :none})  
    @csv = []
    @csv << arr
  end 
```

所以它是数组数组...但是我如何在haml视图中正常查看它？如何查看数组数组？我尝试了类似的东西（也在每个文件中我有不同的列数）：查看：

```
= @csv.first.each do |a|
 = a[:1] 
```

请帮我查看csv数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T04:14:05.690

有几种方法可以读取一组记录，您需要根据数据源的预期大小来选择要使用的方法。

从 CSV 文件开始：

```
A1,A2,A3
B1,B2,B3
C1,C2,C3
D1,D2,D3
E1,E2,E3
F1,F2,F3 
```

读取固定数量的记录的最简单方法是以下之一：

```
require 'csv'

array = CSV.read('test.csv')[0, 2] 
```

它返回一个包含两个子数组的数组：

```
[
    [0] [
        [0] "A1",
        [1] "A2",
        [2] "A3"
    ],
    [1] [
        [0] "B1",
        [1] "B2",
        [2] "B3"
    ]
] 
```

一个替代方案是：

```
File.new('test.csv').readlines[0, 2].map{ |l| CSV.parse(l).flatten } 
```

它返回相同的结果，一个包含两个子数组的数组：

```
[
    [0] [
        [0] "A1",
        [1] "A2",
        [2] "A3"
    ],
    [1] [
        [0] "B1",
        [1] "B2",
        [2] "B3"
    ]
] 
```

这两种方法都适用于小型输入文件，但如果您从大型输入文件中读取几行，则会出现问题。它们将强制 Ruby 将整个文件读入内存并创建一个中间数组，然后再切掉所需的记录数。在我工作的地方，获得千兆字节的文件大小对我们来说没什么，所以抓取这些文件的一小部分会使 Ruby 和系统做大量的工作来构建中间数组，然后把它扔掉。

您最好只读取所需的最少记录数。有时需要在阅读前跳过几行；这证明了这个想法，以及`EOFError`意外遇到输入文件的 EOF 时的处理：

```
File.open('test.csv') do |fi|
  array = []
  begin  
    5.times { fi.readline }    
    2.times.each{ array += CSV.parse(fi.readline) }    
  rescue EOFError    
  end    
end 
```

替换`5`为要跳过的记录`2`数和要读取的记录数。对于那个例子，我特意读了文件的结尾来展示如何跳过行，读一些然后干净地处理 EOF 情况。

数据如下：

```
[
    [0] [
        [0] "F1",
        [1] "F2",
        [2] "F3"
    ]
] 
```

因为我使用`File.open`的是块，所以在块存在后文件会自动关闭，避免留下一个打开的文件句柄。

您问题的 HAML 输出部分根本没有明确定义，但这是输出数据的一种方法：

```
array = []
File.open('test.csv') do |fi|
  begin  
    0.times { fi.readline }    
    2.times.each{ array += CSV.parse(fi.readline) }    
  rescue EOFError    
  end    
end  

require 'haml'

engine = Haml::Engine.new(<<EOT)
%html
  %body
    %table
      - array.each do |r|
        %tr
          - r.each do |c|
            %td= c
EOT
puts engine.render(Object.new, :array => array) 
```

这导致了一个简单的 HTML 表的输出：

```
<html>
  <body>
    <table>
      <tr>
        <td>A1</td>
        <td>A2</td>
        <td>A3</td>
      </tr>
      <tr>
        <td>B1</td>
        <td>B2</td>
        <td>B3</td>
      </tr>
    </table>
  </body>
</html> 
```

* * *

编辑：

> 和我的测试文件：dl.dropbox.com/u/59666091/qnt_small.csv 我想在浏览器中查看这 7 列（通过 haml 视图）

使用它作为我的测试数据：

```
a1,a2,a3,a4,a5,a6,a7
b1,b2,b3,b4,b5,b6,b7
c1,c2,c3,c4,c5,c6,c7
d1,d2,d3,d4,d5,d6,d7
e1,e2,e3,e4,e5,e6,e7 
```

这个代码：

```
require 'csv'

array = []
File.open('test.csv') do |fi|
  begin
    0.times { fi.readline }
    2.times.each{ array += CSV.parse(fi.readline) }
  rescue EOFError
  end
end

require 'haml'

engine = Haml::Engine.new(<<EOT)
%html
  %body
    %table
      - array.each do |r|
        %tr
          - r.each do |c|
            %td= c
EOT
puts engine.render(Object.new, :array => array) 
```

我得到这个输出：

```
<html>
  <body>
    <table>
      <tr>
        <td>a1</td>
        <td>a2</td>
        <td>a3</td>
        <td>a4</td>
        <td>a5</td>
        <td>a6</td>
        <td>a7</td>
      </tr>
      <tr>
        <td>b1</td>
        <td>b2</td>
        <td>b3</td>
        <td>b4</td>
        <td>b5</td>
        <td>b6</td>
        <td>b7</td>
      </tr>
    </table>
  </body>
</html> 
```

我做了一个小改动，搬到街区`array`外`File.open`，没有什么不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:07:48.790

你可以这样做：

```
arr = CSV.read("/data.csv", {:encoding => "CP1251:UTF-8", :col_sep => ",", :row_sep => :auto, :headers => :none})

i = 0
arr.each do |row|
  if i == 20
    break
  else
    i += 1
  end

  # do  sth
  puts row
end 
```

但我认为这不是一个漂亮的解决方案。编辑：我不明白你为什么将 CSV 的实例放入数组中，你不会将 csv 文件的每一行放入数组中

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-01T22:36:32.460

```
require 'csv'
def parser
  CSV.open('data.csv', 'r', ';') do |row|
  puts row
end 
```

# java - 如何在谷歌地图 API v2 中添加叠加层 | 安卓 |

> ID：14114131
> 
> 赞同：11
> 
> 时间：2013-01-01T20:53:20.300
> 
> 标签：java, android, google-maps-android-api-2

我最近开始在 Android 上使用 Google Maps API v2 并偶然发现了另一个障碍。我无法弄清楚如何在 API v1 中添加叠加层，以使用 lat 和 long 在某些位置显示标记。我还希望它使用 long 和 lat 在同一个城镇开始。到目前为止，我为地图的起始位置添加了一些代码，但它不起作用。我想我应该用java而不是XML布局来写它，但我不知道如何解决SupportMapFragment来做任何事情。

这是主要活动，我使用的是 SUPPORTMAPFRAGMENT 而不是 MapFragment，并且不想切换。

```
package com.example.maps;

import android.os.Bundle;
import android.support.v4.app.FragmentActivity;
import com.google.android.gms.maps.SupportMapFragment;

public class Main extends FragmentActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    SupportMapFragment fragment = new SupportMapFragment();
    getSupportFragmentManager().beginTransaction()
            .add(android.R.id.content, fragment).commit();
    }
} 
```

这是 XML

```
<?xml version="1.0" encoding="utf-8"?>
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:map="http://schemas.android.com/apk/res-auto"
  android:id="@+id/map"
   android:name="com.google.android.gms.maps.SupportMapFragment"
   android:layout_width="wrap_content"
   android:layout_height="match_parent"
   map:cameraBearing="112.5"
   map:cameraTargetLat="-33.796923"
   map:cameraTargetLng="150.922433"
   map:cameraTilt="30"
   map:cameraZoom="13"
   map:mapType="normal"
   map:uiCompass="false"
   map:uiRotateGestures="true"
   map:uiScrollGestures="false"
   map:uiTiltGestures="true"
   map:uiZoomControls="false"
   map:uiZoomGestures="true" /> 
```

编辑

新的 Java 代码（我排除了导入和包，但它们都在那里。）

```
public class Main extends FragmentActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    SupportMapFragment fragment = new SupportMapFragment();
    getSupportFragmentManager().beginTransaction()
            .add(android.R.id.content, fragment).commit();

    GoogleMap googleMap;
    googleMap = ((SupportMapFragment)(getSupportFragmentManager().findFragmentById(R.id.map))).getMap();
    LatLng latLng = new LatLng(-33.796923, 150.922433);
    googleMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
    googleMap.addMarker(new MarkerOptions()
            .position(latLng)
            .title("My Spot")
            .snippet("This is my spot!")
            .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_AZURE)));
    googleMap.getUiSettings().setCompassEnabled(true);
    googleMap.getUiSettings().setZoomControlsEnabled(true);
    googleMap.animateCamera(CameraUpdateFactory.newLatLngZoom(latLng, 10));
} 
```

}

新错误

```
01-02 01:16:53.333: D/AndroidRuntime(916): Shutting down VM
01-02 01:16:53.333: W/dalvikvm(916): threadid=1: thread exiting with uncaught    exception (group=0x40a70930)
01-02 01:16:53.363: E/AndroidRuntime(916): FATAL EXCEPTION: main
01-02 01:16:53.363: E/AndroidRuntime(916): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.maps/com.example.maps.Main}: java.lang.NullPointerException
01-02 01:16:53.363: E/AndroidRuntime(916):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
01-02 01:16:53.363: E/AndroidRuntime(916):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
01-02 01:16:53.363: E/AndroidRuntime(916):  at android.app.ActivityThread.access$600(ActivityThread.java:141)
01-02 01:16:53.363: E/AndroidRuntime(916):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
01-02 01:16:53.363: E/AndroidRuntime(916):  at android.os.Handler.dispatchMessage(Handler.java:99)
01-02 01:16:53.363: E/AndroidRuntime(916):  at android.os.Looper.loop(Looper.java:137)
01-02 01:16:53.363: E/AndroidRuntime(916):  at android.app.ActivityThread.main(ActivityThread.java:5039)
01-02 01:16:53.363: E/AndroidRuntime(916):  at java.lang.reflect.Method.invokeNative(Native Method)
01-02 01:16:53.363: E/AndroidRuntime(916):  at java.lang.reflect.Method.invoke(Method.java:511)
01-02 01:16:53.363: E/AndroidRuntime(916):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
01-02 01:16:53.363: E/AndroidRuntime(916):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
01-02 01:16:53.363: E/AndroidRuntime(916):  at dalvik.system.NativeStart.main(Native Method)
01-02 01:16:53.363: E/AndroidRuntime(916): Caused by: java.lang.NullPointerException
01-02 01:16:53.363: E/AndroidRuntime(916):  at com.example.maps.Main.onCreate(Main.java:19)
01-02 01:16:53.363: E/AndroidRuntime(916):  at android.app.Activity.performCreate(Activity.java:5104)
01-02 01:16:53.363: E/AndroidRuntime(916):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
01-02 01:16:53.363: E/AndroidRuntime(916):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
01-02 01:16:53.363: E/AndroidRuntime(916):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-01T20:55:39.070

您可以`onCreate`在`FragmentActivity`.

```
 GoogleMap googleMap;
        googleMap = ((SupportMapFragment)(getSupportFragmentManager().findFragmentById(R.id.map))).getMap();
        LatLng latLng = new LatLng(-33.796923, 150.922433);
        googleMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
        googleMap.addMarker(new MarkerOptions()
                .position(latLng)
                .title("My Spot")
                .snippet("This is my spot!")
                .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_AZURE)));
        googleMap.getUiSettings().setCompassEnabled(true);
        googleMap.getUiSettings().setZoomControlsEnabled(true);
        googleMap.animateCamera(CameraUpdateFactory.newLatLngZoom(latLng, 10)); 
```

端到端解决方案的布局看起来像这样......

```
<?xml version="1.0" encoding="utf-8"?>
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
          android:id="@+id/map"
          android:name="com.google.android.gms.maps.SupportMapFragment"
          android:layout_width="match_parent"
          android:layout_height="match_parent" /> 
```

...这样的活动...

```
public class NameOfYourActivity extends FragmentActivity {
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.nameOfYourLayout);

    GoogleMap googleMap;
    googleMap = ((SupportMapFragment)(getSupportFragmentManager().findFragmentById(R.id.map))).getMap();
    LatLng latLng = new LatLng(-33.796923, 150.922433);
    googleMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
    googleMap.addMarker(new MarkerOptions()
            .position(latLng)
            .title("My Spot")
            .snippet("This is my spot!")
            .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_AZURE)));
    googleMap.getUiSettings().setCompassEnabled(true);
    googleMap.getUiSettings().setZoomControlsEnabled(true);
    googleMap.animateCamera(CameraUpdateFactory.newLatLngZoom(latLng, 10));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-28T14:10:32.427

[https://developers.google.com/maps/documentation/android-api/groundoverlay](https://developers.google.com/maps/documentation/android-api/groundoverlay)

```
LatLng NEWARK = new LatLng(40.714086, -74.228697);

GroundOverlayOptions newarkMap = new GroundOverlayOptions()
        .image(BitmapDescriptorFactory.fromResource(R.drawable.newark_nj_1922))
        .position(NEWARK, 8600f, 6500f);
map.addGroundOverlay(newarkMap); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T13:54:01.057

不确定您是否仍然需要帮助，但这对我有用。

由于您将片段加载到容器中，因此将片段组件加载到内存中需要时间，因此映射为空。为了解决这个问题，我在我的活动的 onAttachedToWindow() 方法中抓取并填充地图，同时仍然在 onCreate 方法中创建片段并将其添加到容器中。这给了片段加载时间，因为在加载窗口时会触发此事件。

```
SupportMapFragment mMapFragment;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_map);
    final FragmentTransaction ft = getSupportFragmentManager().beginTransaction();

    // Try to obtain the map from the SupportMapFragment.
    mMapFragment = (SupportMapFragment) getSupportFragmentManager().findFragmentByTag(MAP_FRAG_NAME);

    // Not found so make a new instance and add it to the transaction for swapping
    if (mMapFragment == null) {
        mMapFragment = SupportMapFragment.newInstance();
        ft.add(R.id.fragment_container, mMapFragment, MAP_FRAG_NAME);
    }

    ft.commit();
}

@Override
    public void onAttachedToWindow() {
        // Load the map here such that the fragment has a chance to completely load or else the GoogleMap value may be null
        GoogleMap googleMap;
googleMap = (mMapFragment).getMap();
LatLng latLng = new LatLng(-33.796923, 150.922433);
googleMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
googleMap.addMarker(new MarkerOptions()
        .position(latLng)
        .title("My Spot")
        .snippet("This is my spot!")
        .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_AZURE)));
googleMap.getUiSettings().setCompassEnabled(true);
googleMap.getUiSettings().setZoomControlsEnabled(true);
googleMap.animateCamera(CameraUpdateFactory.newLatLngZoom(latLng, 10));

        super.onAttachedToWindow();
    } 
```

希望这可以帮助。

问候， DMan

# apache - xampp Apache 1.8.1 本地主机错误 404/403

> ID：14114135
> 
> 赞同：0
> 
> 时间：2013-01-01T20:54:04.487
> 
> 标签：apache, xampp

我将 xampp 从 1.8.0 更新到 1.8.1，之后事情并没有解决。我用谷歌搜索了我的问题，试图改变一些东西，最后遇到了更多的问题。

我不知道如何处理 error.log 中的输出：

*   [2013 年 1 月 1 日星期二 22:34:05.546412] [ssl:warn] [pid 5536:tid 376] AH01873：初始化：未配置会话缓存 [提示：SSLSessionCache]
*   [2013 年 1 月 1 日星期二 22:34:05.627417] [mpm_winnt:notice] [pid 5536:tid 376] AH00455: Apache/2.4.3 (Win32) OpenSSL/1.0.1c PHP/5.4.7 已配置 -- 恢复正常操作
*   [2013 年 1 月 1 日星期二 22:34:05.627417] [mpm_winnt:notice] [pid 5536:tid 376] AH00456：服务器建成时间：2012 年 8 月 18 日 12:41:37
*   [Tue Jan 01 22:34:05.627417 2013] [core:notice] [pid 5536:tid 376] AH00094：命令行：'D:\portableapps\xampp\apache\bin\httpd.exe -d D:/PortableApps/ xampp/阿帕奇'
*   [Tue Jan 01 22:34:05.628417 2013] [mpm_winnt:notice] [pid 5536:tid 376] AH00418: Parent: Created child process 5672
*   [2013 年 1 月 1 日星期二 22:34:06.592472] [ssl:warn] [pid 5672:tid 268] AH01873：初始化：未配置会话缓存 [提示：SSLSessionCache]
*   [2013 年 1 月 1 日星期二 22:34:06.629474] [mpm_winnt:notice] [pid 5672:tid 268] AH00354：子级：启动 150 个工作线程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T06:59:10.343

将 .htaccess 重命名为 htaccess - 问题可能出在此处，或者存在其他一些服务器配置问题。

# json - Spring 3 MVC下的Jackson自定义序列化

> ID：14114140
> 
> 赞同：6
> 
> 时间：2013-01-01T20:54:38.653
> 
> 标签：json, spring, model-view-controller, serialization, jackson

我有几个 POJO，如下所示：

```
class Items {
    List<Item> items;

    public List<Item> getItems() {
        return items;
    }

    ...
}

class Item {
    String name;
    Date insertionDate;

    ...
} 
```

我希望能够使用自定义格式序列化`Date`字段`Item`（在日期中添加前缀，例如“日期：xxx”），但我不想总是这样做（因为它被其他消费者使用'不需要这个前缀），仅在特定情况下。

`Item`如果我用's`getInsertionDate()`进行注释，`@JsonSerialize(using = CustomDateSerializer.class)`我可能可以完成这项工作，*但是*，我不想这样做，因为我并不*总是*想使用这种方法序列化这个字段，只在特定情况下。

所以理想情况下，我会在我想要自定义序列化的控制器中执行此操作：

```
@JsonSerialize(using = CustomDateSerializer.class)
public List<Item> getItems() {
   ....
} 
```

在哪里`CustomDateSerializer extends SerializerBase<Date>`，杰克逊会发现它应该`List`使用默认序列化程序序列化每个项目，并且当它遇到一个`Date`对象时，它应该使用我的自定义序列化程序。当然这不起作用，因为这不是如何使用的，但是除了用包装器包装并在我想要自定义序列化时使用该包装器`@JsonSerialize`之外，还有其他方法可以使它工作吗？`Item`我是否以错误的方式思考这个问题，还有另一种方法可以做到这一点？

请注意，我使用的是 Spring MVC，所以我没有直接调用序列化。

任何帮助将非常感激 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:06:03.623

问题是杰克逊没有看到关于`getItems()`它是否是服务端点方法的注释；它通常只传递`List<Item>`Spring 确定的类型。然而，使用 JAX-RS（如 Jersey），与该方法关联的注释被传递（也许 Spring 也有一些方法）；尽管它需要集成代码（对于 JAX-RS、Jackson JAX-RS JSON 提供程序模块）提供更多支持才能传递它。

实际创建一个单独的 POJO（而不是传递类型）可能更容易，`List`这样您就可以添加必要的注释。

如果您直接使用 Jackson，您还可以使用`ObjectWriter`并指定要使用的默认日期格式。但我不知道 Spring 是否允许您这样做（大多数框架都不会并且只公开 的可配置性`ObjectMapper`）。

还有一点需要注意——除了自定义序列化器（和/或反序列化器），您还可以使用带有`Date`s 的简单注释（以及在 Jackson 2.x 上）：

```
public class DateStuff {
  @JsonFormat(shape=JsonFormat.Shape.STRING, pattern="'Date:'yyyy'-'MM'-'dd")
  public Date date;
} 
```

指定每个属性的格式覆盖。

# c#-4.0 - C# 在 Windows Store App 中将 BitmapImage 转换为 Byte[]，反之亦然

> ID：14114141
> 
> 赞同：2
> 
> 时间：2013-01-01T20:54:57.233
> 
> 标签：c#-4.0, winrt-xaml, windows-store-apps, bitmapimage

此问题特定于**Windows Store App (Windows 8)**。

我正在尝试将 a 转换`Bitmapimage`为`Byte[]`并将其存储在 xml 文件中，然后检索并将其转换回`Bitmapimage`.

我能够将其转换`Bitmapimage`为`byte[]`（尽管这不是最好的方法，所以我不包括示例）。然后我使用序列化将一个类转换为 xml。这是用于序列化的属性`byte[]`：

```
 private byte[] iconBytes;
    [XmlAttribute(DataType = "base64Binary")]
    public byte[] IconBytes
    {
        get 
        { 
            // TO DO: Convert BitmapImage to Byte[]
            return this.iconBytes; 
        }
        set 
        { 
            this.SetProperty(ref this.iconBytes, value);
            // TO DO: Convert Byte[] to BitmapImage
        }
    } 
```

这是生成的 XML：

```
<MyApp xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<Groups>
<Group Title="Group1">
  <Items>
    <Item Title="Item1" IconBytes="7uLC/+7iwv/u4sL/7uLC/0RVZf9heJL/X3OH/+vbvP/r27b/69u2/+vbtv/r27b/7d+9/+3fvf/r27z/R2aO/2Z2t/92h9T/obH3/3uXxP/lz57/5c+e/+XPnv/lz57/6dW3/+nVt//azbf/Um6o/2Jqu/9ib77/lqbp/4uq5//gw5T/4MOU/+DDlP/iyJj/5tCy/97Akf/Mt5b/Ulh+/ygpZv82P47/HhpG/01rpv+Npqn/3LuM/9y7jP/ewJH/27KF/9uyhf+xrKf/VWet/1hatf9reND/UVzD/5Sp8f+qmoL/27KF/9uyhf/ft5H/1q2A/9atgP/WrYD/QU6Y/zY2eP8wKFf/cHit/1ZtsP/WrYD/1q2A/9atgP/bsoX/0KF1/9Chdf/QoXX/NkqC/z5Bh/9KRaH/X3W4/zRMf//QoXX/0KF1/9Chdf/UqXz/zZlv/82Zb/8yJCD/Nj5u/0FOkP9FS5j/Wm+2/09rov9CMTP/zZlv/82Zb//QoXX/KBkV/yUWE/8eEg3/rKCc/ycmUP8yOnL/PU6E/2Nfdf9CLSj/LR0Y/zwnIf9fUUT/IxMQ/yASDP8dDwz/dWpp/4eGiP82QHT/QT5h/4l2c/80IB3/NCAc/yoZFf81IR//IBQO/x0QDP8dDgv/HQ4L/5eTkf+OmKL/k5KT/zAeG/8tHhf/KRsU/zIfGv8tHhf/IREN/x8PC/8fEAz/HhEM/7Suq/+dnaL/qqek/zAeGv8hFA//KBkU/ygaFP8uGhb/" />
  </Items>
</Group>
</Groups>
</MyApp> 
```

**一旦我从 xml 反序列化类，我该如何转换`byte[]`为`BitmapImage`？**

有几个解决此问题的示例，但它们都与 Silverlight 和 WPF 相关，并且没有一个成功转换为**Windows Store App (Windows 8)**。

请记住，使用来自网络或本地计算机的流的示例不适用于此问题。图像`byte[]`已经在内存中，因为数据是从 xml 文件反序列化的。

任何帮助是极大的赞赏。新年快乐！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T06:20:53.553

您可以尝试使用`InMemoryRandomAccessStream`：

```
var stream = new InMemoryRandomAccessStream();
await stream.WriteAsync(iconBytes.AsBuffer());
stream.Seek(0);

var image = new BitmapImage();
await image.SetSourceAsync(stream); 
```

[这](http://social.msdn.microsoft.com/Forums/en-IE/winappswithcsharp/thread/4b2d1889-d4dd-4980-adef-540db2836239#921ae854-326e-4bba-9898-f5f9ff01ab57)是另一个例子。

# python - 用于创建音乐播放列表的 Python 模块（windows）

> ID：14114143
> 
> 赞同：1
> 
> 时间：2013-01-01T20:55:22.600
> 
> 标签：python, windows

我想创建一个简单的 python 脚本来查看文件夹和子文件夹，并使用包含 mp3 的文件夹的名称创建一个播放列表。但到目前为止，我只遇到过在 linux 上工作的 python 模块，或者我不知道如何安装它们（pymad）。

这只是为了我的 android 手机所以认为 m3u 格式应该这样做.. 除了 mp3 文件本身的名称之外，我不关心任何其他元数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:03:07.567

实际上，我只是查看了[http://en.wikipedia.org/wiki/M3U](http://en.wikipedia.org/wiki/M3U)并发现编写 m3u 文件非常容易......应该能够通过简单的 python 写入文本文件来完成

这是我的解决方案

```
import os
import glob

dir = os.getcwd()

for (path, subdirs, files) in os.walk(dir):
    os.chdir(path)
    if glob.glob("*.mp3") != []:
        _m3u = open( os.path.split(path)[1] + ".m3u" , "w" )
        for song in glob.glob("*.mp3"):
            _m3u.write(song + "\n")
        _m3u.close()

os.chdir(dir) # Not really needed.. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T23:53:03.620

我编写了一些代码，它将根据您的条件返回所有嵌套播放列表候选者的列表：

```
import os

#Input: A path to a folder
#Output: List containing paths to all of the nested folders of path
def getNestedFolderList(path):

    rv = [path]
    ls = os.listdir(path)
    if not ls:
        return rv

    for item in ls:
        itemPath = os.path.join(path,item)
        if os.path.isdir(itemPath):
            rv= rv+getNestedFolderList(itemPath)

    return rv

#Input:  A path to a folder
#Output: (folderName,path,mp3s) if the folder contains mp3s. Else None
def getFolderPlaylist(path):
    mp3s = []
    ls = os.listdir(path)
    for item in ls:
        if item.count('mp3'):
            mp3s.append(item)

    if len(mp3s) > 0:
        folderName = os.path.basename(path)
        return (folderName,path,mp3s)
    else:
        return None

#Input:  A path to a folder
#Output: List of all candidate playlists
def getFolderPlaylists(path):
    rv = []
    nestedFolderList = getNestedFolderList(path)
    for folderPath in nestedFolderList:
        folderPlaylist = getFolderPlaylist(folderPath)
        if folderPlaylist:
            rv.append(folderPlaylist)

    return rv

print getFolderPlaylists('.') 
```

# javascript - Lightbox Rails Asset Pipeline 误解

> ID：14114146
> 
> 赞同：0
> 
> 时间：2013-01-01T20:55:42.770
> 
> 标签：javascript, ruby-on-rails, image, asset-pipeline, lightbox2

我不确定为什么在我的 Rails 应用程序上调用灯箱时我的关闭和加载图像没有加载。我已经正确地复制了这些文件，并且 js 和 css 工作正常，但我得到了用于关闭和加载的损坏图像。

这是`application.js`

```
//= require jquery
//= require jquery-ui
//= require jquery_ujs
//= require jquery.ui.datepicker
//= require justgage
//= require raphael.min
//= require jquery.purr
//= require best_in_place
//= require lightbox
//= require_tree . 
```

我的`application.css`

```
 *
 *= require jquery.ui.datepicker
 *= require_self
 *= require_tree .
 *= bootstrap
 *= lightbox
 */ 
```

在我的图像文件夹中，我`close.png`有`loading.gif`

这是请求的输出

```
Started GET "/images/close.png" for IP at 2013-01-01 12:39:19 -0800
ActionController::RoutingError (No route matches [GET] "/images/close.png"):
  actionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  railties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'
  railties (3.2.8) lib/rails/rack/logger.rb:16:in `call'
  actionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'
  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
  rack (1.4.1) lib/rack/runtime.rb:17:in `call'
  activesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
  rack (1.4.1) lib/rack/lock.rb:15:in `call'
  actionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'
  railties (3.2.8) lib/rails/engine.rb:479:in `call'
  railties (3.2.8) lib/rails/application.rb:223:in `call'
  rack (1.4.1) lib/rack/content_length.rb:14:in `call'
  railties (3.2.8) lib/rails/rack/log_tailer.rb:17:in `call'
  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
  /Users/tony/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
  /Users/tony/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
  /Users/tony/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

并且显示了类似的错误`loading.gif`

我需要更改路线文件中的某些内容吗？我在这里俯瞰什么？如果我正确地包含了 js 和 css，图像是否也应该包含在内？感谢您的关注和查看。

- - - 更新 - - - -

更新 application.css

```
 *= require jquery.ui.datepicker
 *= require_self
 *= require bootstrap
 *= require lightbox
 *= require_tree .
 */ 
```

同样破碎的图像仍然出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:04:31.073

看看这个 ：

```
*= require_tree .
*= bootstrap
*= lightbox
*/ 
```

如果它真的在你的`application.css`，它应该是：

```
*= require bootstrap
*= require lightbox
*= require_tree .
*/ 
```

编辑：您可以查看`lightbox.css`文件并检查图像是如何引用的。然后你应该选择如何改变它——硬编码，比如`images/image.png`使用普通`.css`文件前缀，或者通过`<% asset_path %>/image.png`and `.css.erb`。

# android - 是否可以从命令行使用模板？

> ID：14114149
> 
> 赞同：1
> 
> 时间：2013-01-01T20:55:57.610
> 
> 标签：android

所以在 ADT 20 左右，向 Android Eclipse 插件引入了一个新功能，通过向导启动您可以使用的代码模板。我很好奇是否有任何方法可以从命令行使用它们，或者我是否必须编写自己的东西来做到这一点。

到目前为止，我收集到的是它们是 FreeMarker 模板，带有一些 XML 元数据来帮助向导。

谢谢你的时间。

# jquery - 动态添加第 n 个子类

> ID：14114151
> 
> 赞同：1
> 
> 时间：2013-01-01T20:56:05.440
> 
> 标签：jquery, html

需要动态添加类（通过 jQuery）

```
<ul>
    <li class="green">Green</li>
    <li class="red">red</li>
    <li class="black">black</li>

    <li class="">Green</li>
    <li class="">red</li>
    <li class="">black</li>

    <li class="">Green</li>
    <li class="">red</li>
    <li class="">black</li>

</ul> 
```

我的代码

```
jQuery('ul').each(function(){
                jQuery(this).find('li:nth-child(1n)').addClass('green');
                jQuery(this).find('li:nth-child(2n)').addClass('red');
                jQuery(this).find('li:nth-child(3n)').addClass('black');
  }); 
```

我在第一行添加了静态类（意味着前 3 li），需要与第一行相同的更多行您可以在此处使用 jQuery 演示 [http://jsfiddle.net/WfKeY/](http://jsfiddle.net/WfKeY/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:07:56.650

您应该每 3 个元素重复一次类，所以使用`3n`, `3n+/-1`, `3n+/-2`:

```
jQuery('ul').each(function(){
    jQuery(this).find('li:nth-child(3n-2)').addClass('green');
    jQuery(this).find('li:nth-child(3n-1)').addClass('red');
    jQuery(this).find('li:nth-child(3n)').addClass('black');
});​ 
```

更新演示：http: [//jsfiddle.net/WfKeY/2/](http://jsfiddle.net/WfKeY/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T20:59:43.380

现在我理解了这个问题，这里有一个替代方案：

```
var $li = $('ul > li');
$li.each(function(i) {
    $(this).addClass($li.eq(i%3).attr('class'));
}); 
```

[http://jsfiddle.net/zaMUU/5/](http://jsfiddle.net/zaMUU/5/)

# matlab - 基准积分与双积分程序

> ID：14114155
> 
> 赞同：3
> 
> 时间：2013-01-01T20:56:30.587
> 
> 标签：matlab, integral

我有一个关于在 MATLAB 中实现双积分的问题。

据了解， ![在此处输入图像描述](../Images/44253eb49e3e5e0f7176048e98262e38.png)

利用

k1 = 1E-04:0.001:1E+04; k2 = 1E-04:0.001:1E+04; k3 = 1E-04:0.001:1E+04;

上述过程（调用F11，F22和F33的公式）导致结果如下所示： ![在此处输入图像描述](../Images/e0fedba21f98dee0b217c665863a7ed7.png)

现在问题来了：

我想通过仅涉及 phi11、phi22 和 phi33 的双积分（或 k2 和 k3 中的嵌套单积分）来获得相同的结果，因此无需直接调用 F11、F22 和 F33 的公式。

到目前为止，我正在使用此代码（仅限于 F11 计算）：

```
clc,clear all,close all
k1 = (1E-04:0.01:10000);
k2 = (1E-04:0.01:10000);
k3 = (1E-04:0.01:10000);
F_11_benchmark = ((9/55)*1.453)*(1./(1+k1.^2).^(5/6));
count = 0;
F_11 = zeros(1,numel(k1));
for i = 2:numel(k1)
count = count + 1;
phi_11 = @(k2,k3) (1.453./(4.*pi)).*((k2.^2+k3.^2)./((1 + k1(count).^2 + k2.^2+k3.^2).^(17/6)));
F_11(count) = dblquad(phi_11,k2(i-1),k2(i),k3(i-1),k3(i));
end 
```

不会导致上图中显示的相同基准测试结果。

你建议如何解决这个问题？我提前谢谢你。

最好的问候， FPE

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T04:18:14.960

您使用 dblquad 错误。你这样做的方式为每个 k1 计算小盒子 [k1(i-1) k1(i)]x[k1(i-1) k1(i)] 上的积分，这绝不是近似整个域的整合。改用integral2命令：尝试使用

```
F_11(count) = integral2(phi_11,-100,100,-100,100); 
```

或者

```
F_11(count) = integral2(phi_11,-Inf,Inf,-Inf,Inf); 
```

这应该更准确，但会更慢。您可能还可以为 k1 使用更大的分辨率。我用了

```
k1=10.^(-4:.01:3); 
```

排序匹配你的图表。

# performance - 在 mac os x 上测量 SD 卡读/写速度的 shell 脚本

> ID：14114159
> 
> 赞同：1
> 
> 时间：2013-01-01T20:56:47.763
> 
> 标签：performance, macos, shell, console, usb

这是一个小脚本，用于在 mac os x 上测量 SD 卡（或 USB 记忆棒或其他磁盘）的速度。它非常原始，但易于使用和适应。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T20:56:47.763

```
#!/bin/bash
# config
SD_DIR=/Volumes/EOS_DIGITAL/
FILENAME=file_speed_test.deleteme
SIZE=5 # in MB (mac os x)

#create large file first
echo "creating file"
mkfile 100m $TMPDIR$FILENAME
echo "done creating file"

# measure time at the beginning
echo "Starting to WRITE to SD"
START=$(date +%s)
cp $TMPDIR$FILENAME $SD_DIR
END=$(date +%s)

#calculate diff
DIFFw=$(( $END - $START ))
SPEEDw=$(echo $SIZE/$DIFFw | bc -l)
echo "It took $DIFFw seconds to write"

# delete file 
rm $TMPDIR$FILENAME

# read speed
echo "Starting to READ from SD"
START=$(date +%s)
cp $SD_DIR$FILENAME $TMPDIR
END=$(date +%s)
rm $TMPDIR$FILENAME
rm $SD_DIR/$FILENAME

#calculate diff
DIFFr=$(( $END - $START ))
SPEEDr=$(echo $SIZE/$DIFFr | bc -l)
echo "It took $DIFFr seconds to read"

echo "---------- RESULTS ------------"
echo "It took $DIFFw seconds to write $SIZE MB --> WRITE Speed: $SPEEDw MB/s"
echo "It took $DIFFr seconds to read $SIZE MB  --> READ  Speed: $SPEEDr MB/s" 
```

# objective-c - ios Multiplayer 策略：使用 ARC 发送数据包，（无结构）

> ID：14114161
> 
> 赞同：1
> 
> 时间：2013-01-01T20:57:31.037
> 
> 标签：objective-c, ios, game-center, multiplayer

我正在开始一个多人游戏，但示例显示传递使用结构创建的 NSData 对象。但是，使用 ARC，我不能使用 C 结构。（正确吗？）似乎我应该使用对象而不是使用 ARC 的 C 结构。但是我如何发送对象的 NSData 数据包呢？

我想我可以硬编码一个大字节数组，但似乎应该有一个更简单的方法。

另外，如果可以发送一个对象，我如何发送多个对象并能够区分我发送的对象？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:03:34.287

ARC 不会阻止您使用 C 结构，您只需要围绕自动释放进行一些工作。

此外，如果您想要快速而肮脏的处理方式，您可以[使用此方法在多人游戏管理器上禁用 ARC。](https://stackoverflow.com/questions/6646052/how-can-i-disable-arc-for-a-single-file-in-a-project)

请描述您正在遵循哪些代码，哪些代码给您带来了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T04:25:38.343

我的问题的答案是使用 NSKeyedArchiver。它允许将一个对象（或任何东西）打包到一个 NSData 对象中。

# c# - 使用 WPF/C# 中的绑定获取更改的数据

> ID：14114165
> 
> 赞同：1
> 
> 时间：2013-01-01T20:57:49.150
> 
> 标签：c#, wpf, xaml, data-binding, mvvm

我在 WPF 中有一个基本项目。
它所做的一切都是检索/更新产品。

如下图所示，用户输入一个ID，然后根据它显示数据，用户可以更改数据并单击“保存产品”将其保存到数据库中。

![正在运行的项目](../Images/a0d8dfa0f9f373094affad736aa276e0.png)

该`GetProduct(int id)`函数通过提供的 ID 检索产品。
该`SaveProduct()`函数保存更改的字段。

此外，还有两个 DataTemplate：
1) 对于 ProductModel - 包括 3 个文本框：ProductId、ProductName、UnitPrice。
2) 对于 ProductViewModel - 包括保存/获取按钮 + 一个文本框，供用户输入所需产品的 id。

我要做的是在用户单击“保存产品”按钮时获取更改的数据。

在我看来，最理想的方式是使用`Binding`.
每个文本框都已绑定，但我不知道如何获取绑定数据。

以下是 FIRST DataType (ProductModel) 中绑定文本框的示例：
`<TextBox Grid.Row="0" Grid.Column="1" Text="{Binding ProductId}" Margin="5" Width="150" />`

以下每个属性都有一个`ProductId`：`ProductName`和`UnitPrice`。

**重要提示！**：`Get/SaveProduct()`函数在 中`ProductViewModel class`，而实际的产品类别是 - 你猜对了 - `ProductModel`。该类`ProductViewModel`包含一个包含当前显示产品的变量。

这是用于保存信息的按钮 - 它以 SECOND DataType (ProductViewModel) 编写：
`<Button Content="Save Product" DockPanel.Dock="Right" Margin="10,2" VerticalAlignment="Center" Command="{Binding Path=SaveProductCommand}" Width="100" />`

该`SaveProductCommand`命令只是触发该`SaveProduct()`功能。

我对整个主题有几个问题：

1.  像这样使用绑定是什么意思：`{Binding ProductId}`？

2.  据我所知，文本框的默认绑定模式是双向。但是在这种情况下，ProductId/Name + UnitPrice 不是依赖属性，因此当文本框中的文本发生更改时，绑定的值不会更新/发回是否正确？（因为没有附加事件......）

3.  我的项目中从未配置数据上下文，但我的 XAML 页面中的所有“绑定标记”似乎都没有定义的源。可能是源实际上是包含绑定对象的`DataType`in吗？`DataTemplate`

4.  SECOND DataTemplate（ProductViewModel 之一）有这个 ContentControl 标签：`<ContentControl Margin="10" Content="{Binding Path=CurrentProduct}" />`。
    它的目的是什么？

5.  如果发生/确实发生了 TwoWay 绑定，我如何从`SaveProduct()`函数中获取值？我只是指，说`CurrentProduct.ProductName`要改名吗？

非常感谢所有花时间回答的人 - 我非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:10:16.240

> 像这样使用绑定是什么意思：{Binding ProductId}？

您设置了此绑定的特定控件属性将`ProductId`在对象集上查找属性集，`DataContext`并相应地在控件中设置属性值。

> 据我所知，文本框的默认绑定模式是双向。但是在这种情况下，ProductId/Name + UnitPrice 不是依赖属性，因此当文本框中的文本发生更改时，绑定的值不会更新/发回是否正确？（因为没有附加事件......）

您不需要为对象中的属性设置 a`DependencyProperty`以进行`TwoWay`绑定。

> 我的项目中从未配置数据上下文，但我的 XAML 页面中的所有“绑定标记”似乎都没有定义的源。难道源实际上是包含绑定对象的 DataTemplate 中的 DataType？

在 XAML 中设置的绑定将使用存储在 中的对象`DataContext`，因此如果您没有显式设置`DataContext`视图的 ，它将为空。但是，您应该注意，它`DataContext`是从其父级继承的。如果您实际上是通过使用 say, 来设置内容`CurrentProduct`，那么所有属性都可以根据您的`Product`类型绑定到。

> SECOND DataTemplate（ProductViewModel 一）有这个 ContentControl 标签：

```
<ContentControl Margin="10" Content="{Binding Path=CurrentProduct}" /> 
```

> 它的目的是什么？

它充当您的容器`CurrentProduct`，它可以包含一项且仅一项。

> 如果曾经/确实发生了 TwoWay 绑定，我如何从 SaveProduct() 函数中获取值？我是否只是指说 CurrentProduct.ProductName 来获取更改后的名称？

在没有看到整个应用程序的情况下，我的猜测是`ContentControl`被设置为`CurrentProduct`和您的`TextBox`等。都绑定到各自的属性，例如`CurrentProduct.ProductId`等...您要保存的产品实际上是`CurrentProduct`. 当您在 ViewModel 中调用 save 时，您只需`CurrentProduct`根据需要访问并持久保存它，其中`CurrentProduct.PropertyName`将包含从 UI 传播的更改。

# css - 如何使导航链接响应浏览器调整大小

> ID：14114168
> 
> 赞同：0
> 
> 时间：2013-01-01T20:58:06.530
> 
> 标签：css, layout, web, responsive-design, media-queries

我正在尝试使我正在开发的[网站](http://goo.gl/hxYfU)具有响应性，到目前为止，我想要响应浏览器窗口中的变化的元素运行良好，除了导航文本大小和位置......

构成网页的**HTML**如下所示

```
<div id="nav">
   <ul>
      <li>
         <div class="navtext"><a href="index.php">Home</a></div>
      </li>
      <li>
         <div class="navtext"><a href="bio.php">Bio</a></div>
      </li>
      <li>
         <div class="navtext"><a href="resume.php">Resume</a></div>
      </li>
      <li>
         <div class="navtext"><a href="reel.php">Reel</a></div>
      </li>
      <li>
         <div class="navtext"><a href="recommendation.php">Recommendation</a></div>
      </li>
      <li>
         <div class="navtext"><a href="gallery.php">Gallery</a></div> 
      </li>
      <li>
         <div class="navtext"><a href="contact.php">Contact</a></div> 
      </li>
   </ul>
</div> 
```

我添加到 CSS 的媒体查询看起来像这样

```
@media only screen and (max-width: 479px) {
   #nav{
      width: 905px;
      position: relative;
      float: right;
      margin-left: 500px;
   }

   #nav ul {
     list-style: none;
     padding: 10px 0px 0px 1px;
     margin: 0;
   }

   #nav ul li {
     list-style: none;
     float: left;
     padding: 0 0 0 20px;
     font-weight: normal;
  }

  .navtext a {
     font-size:2.2em;
     padding: 1px 5px 1px 5px; 
  }
} 
```

屏幕调整大小后 - [http://i.stack.imgur.com/jvaKe.png](http://i.stack.imgur.com/jvaKe.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T13:58:07.363

对于响应式导航，我使用这个[http://tinynav.viljamis.com/](http://tinynav.viljamis.com/)（它针对小屏幕的现代响应式解决方案），因此您应该只使用 em 和 % 作为您的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T17:04:09.220

您可以从减少#nav div 的宽度和左边距开始

```
#nav{
  width: 905px; /* too wide for (max-width: 479px) screen */
  position: relative;
  float: right;
  margin-left: 500px; /* too wide for (max-width: 479px) screen */
 } 
```

# c - 在 C.= 中计算阶乘时得到错误的结果

> ID：14114172
> 
> 赞同：0
> 
> 时间：2013-01-01T20:58:35.673
> 
> 标签：c, factorial

显然，这是一个 [hometask] 和我要问的一个完全新手的问题。我试图通过多次更改代码来自己解决这个问题，但仍然从阶乘计算中得到错误的结果。该程序的想法是为从 1 到 10 的整数打印一个阶乘表。为了完成这个技巧，我的想法是使用嵌套的 for 和 while 语句，如下面的代码所示：

```
#include <stdio.h>

int main (void)

{
    int n, factorial, u;
    u = n;

    printf ("Table to calculate factorials from 1 to 10\n");
    printf ("n                    Factorial to n\n");

    for (n = 1; n <= 10; n= n+1)

    {   

        while (u <= n)
        factorial = n * u;
        u = u - 1;
        printf ("%i                    %i\n", n, factorial);

    }

    return 0;

} 
```

但是，我在控制台中得到错误的结果。猜猜我搞砸了一个算法来计算阶乘或程序逻辑。我尝试更改代码但仍然卡住。任何帮助，将不胜感激。谢谢，新年快乐！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:01:35.063

你实际上有几个问题，以至于很难说出你的意图是什么。`u`未初始化，while 循环缺少大括号，并且您将错误的值分配给`factorial`.

这是您可以解决问题的一种方法。

```
for (n = 1; n <= 10; ++n)
{   
    factorial = 1;

    for (u = 1; u<=n; ++u)
    {
        factorial *= u;
    }

    printf ("%i                    %i\n", n, factorial);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:15:17.773

如果你想使用你原来的想法：

```
#include <stdio.h>

int main (void)    
{
    int n, factorial, u;

    printf ("Table to calculate factorials from 1 to 10\n");
    printf ("n                    Factorial to n\n");

    for (n = 1; n <= 10; n= n+1)    
    {   
      factorial = u = 1;

      while (u <= n)
      {
          factorial *= u;
          u = u - 1;
      }
        printf ("%i                    %i\n", n, factorial);

    }

    return 0;

} 
```

# c# - Cookie过期日期时间和客户端和服务器中的不同日期

> ID：14114174
> 
> 赞同：0
> 
> 时间：2013-01-01T20:58:44.773
> 
> 标签：c#, asp.net

我正在使用以下代码进行自定义“记住我”的暗示：

```
 FormsAuthenticationTicket ticket = new FormsAuthenticationTicket(1, member.UserName, DateTime.Now, DateTime.Now.AddHours(24), true, dataString);
        string encTicket = FormsAuthentication.Encrypt(ticket);
        HttpCookie faCookie = new HttpCookie(FormsAuthentication.FormsCookieName, encTicket);
        faCookie.Expires = ticket.Expiration;
        HttpContext.Current.Response.Cookies.Add(faCookie); 
```

但是有些用户无法登录（即使登录后也会出现登录页面）。
似乎问题是由于客户端的日期与服务器的日期不同（更大）引起的。那么，对于“记住我”的实现来说，最好和正确的解决方案是什么。
为了解决这个问题，我必须删除这一行：

```
faCookie.Expires = ticket.Expiration; 
```

删除此行后，当用户关闭浏览器时，他必须登录（cookie 不持久）。解决办法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:25:54.830

您可以做的是获取客户端日期/时间并将其用于 Cookie，而不是服务器时间。

[这里](https://stackoverflow.com/questions/274826/how-to-get-client-date-and-time-in-asp-net)有一个很好的答案，向您展示了一个很好的方法；基本上用客户日期/时间填充一个隐藏字段并在回发时获取它。

您可以在母版页上有这个隐藏字段，以便客户的日期/时间始终可用。不需要只是在登录屏幕上。

# android - Android NullPointerException 用于从 Activity 传递参数

> ID：14114177
> 
> 赞同：1
> 
> 时间：2013-01-01T20:59:08.770
> 
> 标签：android, android-activity, parameters, nullpointerexception

我的应用程序从 开始`activity1`，然后跳转到`activity2`，在那里我得到一个字符串的值，然后跳回到`activity1`。问题是，当我尝试将字符串值传回时，获取数据值`NullPointerException`时出错。`activity1`我调试发现数据值在`activity2`. 请帮我设置一些标志来区分应用程序的初始启动`activity1`和第二次从`activiy2`. 非常感谢！

```
String data = (String) getIntent().getExtras().get("data"); 
if(data != null){
   Toast.makeText(this, data, Toast.LENGTH_SHORT).show();
}else{
   Toast.makeText(this, "no data", Toast.LENGTH_SHORT).show();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:08:06.293

您必须使用 startActivityForResult 方法启动活动 B，并在活动 A 中实现 onActivityResult。

# c# - 为什么 Java 和 C# 中的逻辑运算符和位运算符之间存在区别？

> ID：14114179
> 
> 赞同：9
> 
> 时间：2013-01-01T20:59:19.110
> 
> 标签：c#, java, bitwise-operators, logical-operators

像 ie Java 和 C# 这样的语言既有位运算符也有逻辑运算符。

逻辑运算符仅适用于布尔操作数，位运算符也适用于整数类型。由于 C 没有布尔类型并且将所有非零整数都视为真，因此逻辑和位运算符的存在在那里是有意义的。但是，Java 或 C# 等语言具有布尔类型，因此编译器可以根据类型上下文自动使用正确类型的运算符。

那么，在这些语言中同时使用逻辑运算符和位运算符是否有一些具体的原因？或者他们只是出于熟悉的原因而包括在内？

（我知道您可以在布尔上下文中使用“按位”运算符来规避 Java 和 C# 中的短路，但我从来不需要这种行为，所以我想这可能是一个大多数未使用的特殊情况）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-01T21:06:43.947

> 1）在这些语言中同时使用逻辑运算符和位运算符是否有一些具体的原因？

是的：

*   我们有布尔运算符来执行布尔逻辑（在布尔值上）。
*   我们有按位运算符来执行按位逻辑（在整数值上）。

> 2) 我知道您可以在布尔上下文中使用“按位”运算符来规避 Java 和 C# 中的短路，

因为就 C# 而言，这根本不是真的。
C# 有例如 2 个布尔 AND 运算符：`&`(full) 和`&&`(short)，但它不允许对布尔值进行按位运算。

因此，逻辑运算符和位运算符之间确实没有“重叠”或冗余。两者不适用于同一类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T21:07:21.083

在 C# 中，带有布尔值

*   && 是短路逻辑运算符
*   & 是非短路逻辑运算符

按位计算，它只是使用 & 作为 C / C++ 的遗留语法......但它真的完全不同。如果有的话，最好作为一个完全不同的符号来避免任何混淆。但是剩下的真的不多了，除非你想去 &&& 或 ||| 但这有点难看。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-27T18:21:22.060

迟到的答案，但我会尽力了解你的真正观点。

你是对的。表达观点的最简单方法是提及其他类型语言（如 Visual Basic）具有可以作用于布尔表达式和整数表达式的逻辑运算符。

> VB 或运算符：http: [//msdn.microsoft.com/en-us/library/06s37a7f.aspx](http://msdn.microsoft.com/en-us/library/06s37a7f.aspx)
> 
> VB按位示例：http: [//visualbasic.about.com/od/usingvbnet/a/bitops01_2.htm](http://visualbasic.about.com/od/usingvbnet/a/bitops01_2.htm)

这在很大程度上是一个语言设计决定。Java 和 C# 不一定要像现在这样。他们就是他们现在的样子。为了熟悉起见，Java 和 C# 确实从 C 中继承了大部分语法。其他语言没有，而且工作得很好。

像这样的设计决策会产生后果。短路评估是其中之一。禁止混合类型（这可能会让人难以理解）是另一回事。我开始喜欢它，但也许我只是盯着 Java 太久了。

Visual Basic 添加了 AndAlso 和 OrElse 作为进行短路评估的方法。与基本的其他逻辑运算符不同，这些运算符仅适用于布尔值。

> VB OrElse：http: [//msdn.microsoft.com/en-us/library/ea1sssb2.aspx](http://msdn.microsoft.com/en-us/library/ea1sssb2.aspx)
> 
> 短路说明： http: [//support.microsoft.com/kb/817250](http://support.microsoft.com/kb/817250)

之所以没有区分是因为强类型化使得一种语言不可能只有一组逻辑运算符。这样做是因为他们想要进行短路评估，并且他们想要一种清晰的方式来向读者发出正在发生的事情的信号。

c 和 c++ 具有不同类型的逻辑运算符的另一个原因（除了短路）是允许将任何非零数重新解释为 TRUE 并将零重新解释为 FALSE。为此，他们需要操作员告诉他们以这种方式进行解释。Java 拒绝整个重新解释的想法，如果您尝试使用它的逻辑运算符这样做，则会在您的脸上抛出一个错误。如果不是为了短路评估，剩下的唯一原因就是因为他们希望操作员在做不同的事情时看起来不同。

所以是的，如果 Java 和 C# 语言设计者不关心这些，他们可以使用一组逻辑运算符来处理按位和布尔逻辑，并像其他一些语言一样根据操作数类型确定要做什么。他们只是没有。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-01T21:05:56.360

我会说Java

*   逻辑运算符是带有布尔值的用户，而位运算符则用于整数。它们不能混合。
*   为什么不将它们简化为一个运算符，例如“&”或“|”？Java 被设计为对 C/C++ 用户友好，所以它有他们的语法。如今，由于向后兼容，这些运算符无法减少。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-01T21:07:32.223

正如您已经说过的， and 之间存在一些区别`&`（`&&`和 也是`|`如此`||`），因此您需要两组布尔运算符。现在，与上述情况无关，您可能需要按位运算符，最好的选择是`&`，`|`因此您不必避免任何混淆。

* * *

为什么要把事情复杂化并使用两个字符的版本？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-01T21:13:02.770

编译器无法推断仅查看参数的正确运算符。选择哪一个是一个商业决策。这是关于惰性计算的。例如

```
public boolean a() {
  doStuffA();
  return false;
}

public boolean b() {
  doStuffB();
  return true;
} 
```

现在： `a() & b()`将执行`doStuffB()`而`a() && b()`不会

# android - Android Graphs：在 GraphView 中自定义 Grid

> ID：14114181
> 
> 赞同：0
> 
> 时间：2013-01-01T20:59:39.823
> 
> 标签：android, api, graph, charts

大家好：我目前正在将 GraphView 库集成到我的 android 项目中。我想知道是否可以调整网格的大小。另外，标签大小可以更改吗？这些数字非常小，难以阅读。提前非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-02-18T06:38:13.790

您可以使用以下代码更改标签大小

```
 //setting the minimum and maximum values for x and y axis
    graph.getViewport().setXAxisBoundsManual(true);
    graph.getViewport().setMinX(0);
    graph.getViewport().setMaxX(12);
    graph.getViewport().setYAxisBoundsManual(true);
    graph.getViewport().setMinY(0);
    graph.getViewport().setMaxY(6);

    //number of labels on x nd y axis
    graph.getGridLabelRenderer().setNumHorizontalLabels(7);
    graph.getGridLabelRenderer().setNumVerticalLabels(7); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T07:27:32.247

您需要修改源代码。从 github 克隆它并将其用作 Android 库。

代码真的很容易理解。例如要更改标签大小/颜色/更多，只需在此处修改： [https ://github.com/jjoe64/GraphView/blob/master/src/com/jjoe64/graphview/GraphView.java#L213](https://github.com/jjoe64/GraphView/blob/master/src/com/jjoe64/graphview/GraphView.java#L213)

祝你好运

# php - FLEX：我怎样才能有一个 php 文件作为我的 fx 模型的源

> ID：14114187
> 
> 赞同：0
> 
> 时间：2013-01-01T21:00:37.967
> 
> 标签：php, apache-flex, connection

我有以下问题。如何在我的 fx 模型连接中选择一个 php 文件作为源。

我想在我的 fx 模型源中使用一个返回 xml 文件的 php 文件。这可能吗？

现在我尝试使用 http 服务来读取运行时的 php 文件并使用 xmllistcollection。这是我的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx" 
           xmlns:components="components.*">

<s:layout>
    <s:VerticalLayout paddingTop="20" gap="20" 
                      horizontalAlign="center" />
</s:layout>
<fx:Script>
    <![CDATA[
        import mx.rpc.events.ResultEvent;
        import mx.collections.ArrayCollection; 
        import mx.collections.XMLListCollection; 

        import mx.rpc.events.FaultEvent;
        import mx.controls.Alert;
        private var alert:Alert;

        private function httpService_fault(evt:FaultEvent):void {
            var title:String = evt.type + " (" + evt.fault.faultCode + ")";
            var text:String = evt.fault.faultString;
            alert = Alert.show(text, title);
            Bezoekers.removeAll();
        }

        private function httpService_result(evt:ResultEvent):void {
            var xmlList:XMLList = XML(evt.result).bezoekers.bezoeker;
            Bezoekers = new XMLListCollection(xmlList);
        }
    ]]>
</fx:Script>
<fx:Declarations>
    <s:HTTPService id="httpService"
                   url="http://localhost/projectnieuw/src/data/bezoekersList.php"
                   resultFormat="e4x"
                   fault="httpService_fault(event);"
                   result="httpService_result(event)" />
    <!--<fx:Model id="lijstAlleLeden" source="httpAlleLeden" />-->
    <!--<s:ArrayCollection id="acBezoekers" source="{Bezoekers}"/>-->
    <s:XMLListCollection id="Bezoekers"/>
</fx:Declarations>

<components:Heading/>
<s:HGroup gap="50">

    <components:BezoekersList bezoekerList="{Bezoekers}" />
    <components:ReservationForm/>

</s:HGroup>

</s:Application> 
```

我没有收到任何错误，但在我的列表中没有看到任何信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:12:13.230

如果我明白你想做什么；那么你不能这样做。Model 标签是一个编译时值。该模型数据本质上是在编译时嵌入到我们的 SWF 中的。而 PHP 脚本将在运行时执行。即使 Flex 会嵌入 PHP 文件；它将使用 PHP 代码，而不是执行 PHP 代码时获得的结果。

我建议考虑在运行时从 PHP 脚本[加载数据。](http://livedocs.adobe.com/flex/3/html/help.html?content=about_dataproviders_7.html)有很多方法可以做到这一点；取决于您的 PHP 脚本返回的内容。如果您想使用 HTTP 获取请求来加载它；我建议使用[HTTPService](http://livedocs.adobe.com/flex/3/langref/mx/rpc/http/mxml/HTTPService.html)。如果您可以使用与 AMF 相关的东西，例如 AMFPHP 或 ZenAMF，那么我会使用[RemoteObject](http://livedocs.adobe.com/flex/3/langref/mx/rpc/remoting/mxml/RemoteObject.html)。

# java - 使用 GSON 结构解析 JSON

> ID：14114190
> 
> 赞同：0
> 
> 时间：2013-01-01T21:01:24.680
> 
> 标签：java, android, json, gson

我曾尝试在另一个项目中执行此操作，根据我看过的教程，我知道我走在正确的轨道上，但我无法正确解析：

（非常简化）JSON 输出：

```
{
"data":{
  "info":{
      "username": "something"
      "email" : "something"
   }
..
.. 
```

}

我正在尝试使用以下类获取“用户名”和“电子邮件：

```
class ProfileResponse {
static Data data;

public static Data getData() {
    return data;
}

public static void setData(Data data) {
    ProfileResponse.data = data;
} 
```

}

```
Class Data {
@SerializedName("info")
static Info info;

public static Info getInfo() {
    return info;
}

public static void setInfo(Info info) {
    Data.info = info;
} 
```

}

```
class Info {
@SerializedName("username")
static String username;
@SerializedName("email")
static String email;

public static String getUsername() {
    return username;
}

public static String getEmail() {
    return email;
}

} 
```

和反序列化 JSON 字符串（它是一个字符串可能是个问题吗？），如下所示：

```
 Gson gson = new Gson();
                        gson.fromJson(response, ProfileResponse.class);
                        if (Info.getUsername() == null
                                || Info.getUsername().isEmpty()) {
                            System.out.println("NO USERNAME");
                        } else {
                            System.out.println("USERNAME: "
                                    + Info.getUsername());
                        } 
```

每次运行时都会打印“NO USERNAME”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T23:03:17.907

`static`默认情况下，字段从序列化/反序列化中排除。

从您的类（字段和方法）中删除所有`static`关键字，`fromJson()`正确调用，然后您将获得您正在寻找的结果。

Gson 从您的 JSON 实例化您的类的实例。修改类后，您将执行以下操作：

```
ProfileResponse pr = gson.fromJson(response, ProfileResponse.class); 
```

# java - How to pass or assign a value obtained in a runOnUiThread

> ID：14114191
> 
> 赞同：4
> 
> 时间：2013-01-01T21:01:26.630
> 
> 标签：java, android, runnable, anonymous-class

In a subclass of WebView, I have this in an overridden method of getTitle():

```
 @Override
      public String getTitle() {
        Activity a = getVoTts().getActivity();
        a.runOnUiThread(new Runnable() {
            public void run() { 
                String tit = VoWebView.super.getTitle();
            }
        });

       String title = tit;  // this is what I WANT to do, it won't compile of course
       ...
       ...
      } 
```

But the String `tit` is closed in an anonymous Runnable class and thus of course cannot be accessed down the method.

Is there any technique or "trick" that would allow me to pass a value obtained in an anonymous Runnable class to statements down the lines (in the same method) or assign it to a data member?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T21:03:39.120

One way would be by declaring an instance field and using it across the whole class. For example:

```
private String someText;

// ...

@Override
public String getTitle()
{
    Activity a = getVoTts().getActivity();
    a.runOnUiThread(new Runnable()
    {
        public void run()
        {  
            someText = VoWebView.super.getTitle();
        }
    });
} 
```

* * *

**EDIT:**

Regarding the reason of why you have to declare a local variable as final (or in other word, compile time constant):

Imagine the following is valid in Java:

```
@Override
public String getTitle()
{
    Foo f = new Foo();

    Button b = getButtonReference();
    b.setOnClickListener(new OnClickListener()
    {
        public void onClick(View v)
        {  
            Boo o = f.someMethod();
        }
    });

    f = null;
} 
```

At `f = null`, the foo object will be eligible for garbage-collected. So if you click the button, it's too late for the VM to invoke `someMethod()` on the foo object, since it's garbage-collected!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T21:05:34.853

Why don't you declare a global variable:

```
 private String title;

  @Override
  public String getTitle() {
    Activity a = getVoTts().getActivity();
    a.runOnUiThread(new Runnable() {
        public void run() { 
            title = VoWebView.super.getTitle();
        }
    });
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-03T14:28:34.370

You can use [FutureTask](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/FutureTask.html) as follows:

```
FutureTask<String> task = new FutureTask<String>(new Callable<String>() {
    @Override
    public String call() throws Exception {
        // Compute your string
    }
});

runOnUiThread(task);
String title = task.get(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T10:21:19.883

**Update**

According to a comment, `.runOnUiThread()` runs its runnable asynchronously, which means the task may or may not have run by the time we get to the "statements down the lines". Then it is impossible to get the results to those statements in the rest of the method (and none of the solutions here will help you with that).

# objective-c - iCloud NSMetadata 查询结果为空白

> ID：14114193
> 
> 赞同：1
> 
> 时间：2013-01-01T21:02:16.350
> 
> 标签：icloud, nsarray, 的 for 循环, objective-c, ios, nsarray, icloud

我一直在努力将[icloud](/questions/tagged/icloud "显示标记为“icloud”的问题")添加到我的项目中（这对我来说非常痛苦）并且我能够保存和删除文件，但我无法获得存储在 iCloud 中的文件列表。我尝试了大约 10 个不同网站（包括 Apple 文档）的解决方案。每当我打电话时`[self.query startQuery];`，一切似乎都在工作：正确的方法被调用，方法完全按照它们应该执行的方式执行。然后，当我在我的应用程序的 iCloud Documents 目录中请求文件的[nsarray](/questions/tagged/nsarray "显示标记为“nsarray”的问题")时，我得到两个括号，它们之间没有任何内容（当我在 NSLog 中查看时）`File List: ( )`：。我知道我的应用程序的 iCloud 文档目录中有许多不同形状、扩展名、大小和名称的不同文档，因为我一直在使用[iCloud Developer](https://developer.icloud.com)网站检查事情是否正常。我设置查询的第一种方法如下：

```
- (void)syncWithCloud {
self.query = [[NSMetadataQuery alloc] init];
NSURL *mobileDocumentsDirectoryURL = [[NSFileManager defaultManager] URLForUbiquityContainerIdentifier:nil];
[query setSearchScopes:[NSArray arrayWithObjects:NSMetadataQueryUbiquitousDocumentsScope, nil]];
//[query setPredicate:[NSPredicate predicateWithFormat:@"%K LIKE '*'", NSMetadataItemFSNameKey]];
[query setPredicate:[NSPredicate predicateWithFormat:[NSString stringWithFormat:@"%%K like \"%@*\"", [mobileDocumentsDirectoryURL path]], NSMetadataItemPathKey]];

//Pull a list of all the Documents in The Cloud
[[NSNotificationCenter defaultCenter] addObserver:self  selector:@selector(processFiles:)
                                             name:NSMetadataQueryDidFinishGatheringNotification object:self.query];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(processFiles:)
                                             name:NSMetadataQueryDidUpdateNotification object:self.query];

[self.query startQuery];
} 
```

苹果提供的[process files方法如下：](http://developer.apple.com/library/ios/#documentation/General/Conceptual/iCloud101/SearchingforiCloudDocuments/SearchingforiCloudDocuments.html)

```
- (void)processFiles:(NSNotification*)aNotification {
    NSMutableArray *discoveredFiles = [NSMutableArray array];

    //Always disable updates while processing results.
    [query disableUpdates];

    //The query reports all files found, every time.
    NSArray *queryResults = [query results];
    for (NSMetadataItem *result in queryResults) {
        NSURL *fileURL = [result valueForAttribute:NSMetadataItemURLKey];
        NSNumber *aBool = nil;

        // Don't include hidden files.
        [fileURL getResourceValue:&aBool forKey:NSURLIsHiddenKey error:nil];
        if (aBool && ![aBool boolValue])
            [discoveredFiles addObject:fileURL];
    }

    //Update the list of documents.
    [FileList removeAllObjects];
    [FileList addObjectsFromArray:discoveredFiles];
    //[self.tableView reloadData];

    //Reenable query updates.
    [query enableUpdates];

    NSLog(@"File List: %@", FileList);
} 
```

为什么这不给我一个文件列表或至少是某种数据？我是否错误地定义了 NSMetadata 查询，也许我的谓词格式不正确？我知道我做错了什么，因为 iCloud 不可能这么复杂（或者可能吗？）。
我在这里先向您的帮助表示感谢！

**编辑**#1：我将继续尝试不同的方法来解决这个问题。使用以下答案之一，我更改了谓词过滤器，如下所示：

```
[query setPredicate:[NSPredicate predicateWithFormat:@"NSMetadataItemFSNameKey LIKE '*'"]]; 
```

我还在通话*前*添加了以下几行`[query enableUpdates]`：

```
for (NSMetadataItem *item in query.results) {
        [FileList addObject:[item valueForAttribute:NSMetadataItemFSNameKey]];
 } 
```

在该`processFiles`方法中，我尝试将所有代码放在后台线程上，但这没有什么区别——事实上，当代码不在后台线程上执行时，`FileList`我会得到 this`(null)`而不是 this `( )`。

**我的问题可能与线程管理或内存分配有关吗？**请注意，我使用的是 ARC。

**编辑**#2：该`FileList`变量是在 my 中定义的 NSMutableArray ，并在调用该方法之前`@interface`在该方法中初始化。`-(id)init``processFiles`

**编辑**#3：当用断点测试我的代码时，我发现下面[的 for 循环](/questions/tagged/for-loop "显示标记为“for-loop”的问题")永远不会运行——甚至一次。这使我相信：
A. 正确的目录没有与
B. iCloud 看不到目录中的文件
C. 我的 NSMetadataQuery 没有正确设置 D. 完全不同的东西

这是启动永远不会运行的 for 循环的代码：

```
NSArray *queryResults = [query results];
for (NSMetadataItem *result in queryResults) { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:28:40.593

由于您已经正确设置了搜索范围，因此无需在谓词中使用特殊过滤器。只需使用：

```
query.predicate = [NSPredicate predicateWithFormat:@"NSMetadataItemFSNameKey == '*'"]; 
```

并获取数组使用：

```
NSMutableArray *array = [NSMutableArray array];
for (NSMetadataItem *item in query.results) {
        [array addObject:[item valueForAttribute:NSMetadataItemFSNameKey]];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T22:48:17.250

我已经解决了我的问题。获取 iCloud 中的文件列表只是正确定义、分配和初始化属性的问题。**SAE**的回答和这个[SO 发布帮助我解决了我的问题并创建了这个名为](https://stackoverflow.com/questions/7950804/nsmetadataquery-doesnt-find-icloud-files)[iCloud Document Sync](https://github.com/iRareMedia/iCloudDocumentSync)的GitHub 存储库。iCloud Document Sync 类将整个 iCloud Document 存储过程简化为几行代码。[此处](https://github.com/iRareMedia/iCloudDocumentSync/commit/98524196401920d75a0e5d7c506661ca825863c5)链接的提交解决了我的问题中的问题。

# objective-c - 在文本上绘制两个阴影（核心图形）

> ID：14114194
> 
> 赞同：3
> 
> 时间：2013-01-01T21:02:20.337
> 
> 标签：objective-c, ios, core-graphics, shadow, cgcontext

我想在某些文本上绘制两种不同的阴影以创建浮雕效果。这是我`drawInRect`用第一个阴影绘制文本的部分（所有使用的变量都已定义）：

```
CGContextSetShadowWithColor(context, textInnerShadowOffset, textInnerShadowBlurRadius, textInnerShadowColor.CGColor);
[textColor setFill];
[self.text drawInRect:rect withFont:self.font lineBreakMode:self.lineBreakMode alignment:self.textAlignment]; 
```

但现在我面临着绘制第二个阴影的问题。我假设我需要更改阴影并再次绘制文本，但我需要这样做而不添加另一个文本副本。

**如何在不真正绘制文本本身的情况下绘制文本？**将填充颜色更改为`clearColor`不起作用。我见过人们为此使用剪贴蒙版，但 AFAICT 仅适用于简单的形状，而不适用于文本。

或者，是否有更简单的方法在同一文本上绘制两个阴影？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:09:14.773

两个选项，取决于您想要的确切效果：

*   如果您希望第一个“上”阴影也有助于第二个“下”阴影，请使用[透明层](https://developer.apple.com/library/mac/#documentation/graphicsimaging/Conceptual/drawingwithquartz2d/dq_trans_layers/dq_trans_layers.html)。

    1.  为“下”阴影设置 CGContext 的阴影
    2.  使用创建透明层`CGContextBeginTransparencyLayer`
    3.  为“上”阴影设置上下文的阴影
    4.  画出你的文字
    5.  使用结束透明层`CGContextEndTransparencyLayer`

（请注意，透明层可能非常昂贵。最好调用[`CGContextBeginTransparencyLayerWithRect`](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextBeginTransparencyLayerWithRect)并传入尽可能小的矩形。）

*   如果你希望阴影是独立的——对每个阴影有贡献的唯一因素是文本——你需要使用一个技巧。

使用额外的大偏移设置阴影，足够大，以便您可以在上下文边界之外绘制文本并将阴影放置在正确的位置。这样你只会看到阴影，而不是文字。

![大偏移的文本和阴影](../Images/950cf22b20aaf294deaf81e624324b96.png)

1.  弄清楚什么偏移量“足够大”。它可能取决于您正在绘制的上下文的大小（基于您的视图），也可能取决于文本的边界。或者，只是捏造它：选择一个大得离谱的值，比如 5000 pt。
2.  设置你的影子。将大偏移添加到其正常的 y 偏移。
3.  绘制文本，垂直偏移大偏移量。

对每个“下”阴影重复 1-3，从后到前。然后，最后绘制文本和“最上面”的阴影，没有偏移。

# css - 在列表中叠加图像

> ID：14114195
> 
> 赞同：0
> 
> 时间：2013-01-01T21:02:27.153
> 
> 标签：css

到目前为止我有这个 html css

```
<html><head><style type="text/css">
.img_list {    
    width: 50px;
    height: 50px;
    position: relative;
}

#img_list .icon {
    width: 30px;
    height: 30px;
    position: absolute;
    z-index: 2;
    top: 0;
    left: 0;
}
li{
list-style:none;
}
</style></head>
<body>
<ul id="img_list">
    <li>
        <img src="images.jpg" alt="Image Title" class="img_list" />
        <img class="icon" src="Arrow.png" alt="You've done XYZ to this." />
        <a>Charlie Chaplin</a>
    </li>
    <li>
        <img src="images.jpg" alt="Image Title" class="img_list"/>
        <img class="icon" src="Arrow.png" alt="You've done XYZ to this." />
        <a>Charlie Bean</a>
    </li>
</ul>
</body>
</html> 
```

这是渲染图像！[在此处输入图像描述][1]

我想要的是让向下箭头图像覆盖在每个图像右下角的图像本身的顶部。我尝试使用顶部，底部，左右，但它与浏览器大小不一致。我如何更改我的 CSS 以使其正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:07:13.487

您得到该结果是因为您将图标相对于容器定位，`#img_list`. 尝试添加`position:relative;`到您的`li`css 定义中，并将其从`#img_list{`定义中删除：

```
li{
    list-style:none;
    position:relative;
} 
```

**请参阅此现场演示（带有替换图像）：http: [//jsfiddle.net/wm4rj/](http://jsfiddle.net/wm4rj/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T21:07:40.790

只需添加`position: relative;`到列表项。

```
li {
list-style:none;
position: relative;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T21:10:07.880

试试这个：

```
<html>
<head>
    <style type="text/css">
        #img_list li {
            list-style:none;
            position:relative;
            line-height:50px;
        }
        #img_list li .img_list {    
            width: 50px;
            height: 50px;
        }
        #img_list li .icon {
            width: 30px;
            height: 30px;
            position: absolute;
            z-index: 99;
            bottom: 20px;
            left:0;
        }
    </style>
</head>
<body>
    <ul id="img_list">
        <li>
            <img src="images.jpg" alt="Image Title" class="img_list" />
            <img class="icon" src="Arrow.png" alt="You've done XYZ to this." />
            <a>Charlie Chaplin</a>
        </li>
        <li>
            <img src="images.jpg" alt="Image Title" class="img_list"/>
            <img class="icon" src="Arrow.png" alt="You've done XYZ to this." />
            <a>Charlie Bean</a>
        </li>
    </ul>
</body>
</html> 
```

# jquery - jquery menucool滑块不起作用

> ID：14114202
> 
> 赞同：0
> 
> 时间：2013-01-01T21:03:27.193
> 
> 标签：jquery, jquery-plugins

我不是 javascript 或 jQuery 方面的专家，并且在使用 jQuery 滑块时遇到了问题。

滑块在演示站点中运行良好，我已经很好地实现了它，但由于某种原因它无法正常工作。在调试中我得到的唯一错误是参考错误，不明白这是什么原因。

这是我正在使用的滑块：[http ://www.menucool.com/jquery-slider](http://www.menucool.com/jquery-slider)

我尝试使用纯 javascript 版本和 jQuery 版本。现在已经实现了 jQuery 版本。我不知道为什么它不起作用。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T20:58:29.273

Menucool jQuery Slider v2012.11.22 非常简单

`a.replace(/(?:.*\.)?(\w)([\w\-])?[^.]*(\w)\.[^.]*$/,"$1$3$2")`在 jquery-slider.js 文件中找到

改成`a.replace("","$1$3$2")`

享受

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-20T21:57:10.240

对于 menucool 的最新版本，只需替换：

```
return "b" + a + b[1] + c(b[0]) + c(b[2]) 
```

为了

```
return "mylicense" 
```

不要忘记 te var 许可证必须是：

```
license: "mylicense" 
```

它对我有用:)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-02-16T11:52:38.720

**对于 menucool 的最新版本，只需替换：**

**找出**

```
vb=function(d,c){for(var b=[],a=0;a<d[e];a++)b[b[e]]=String[kb](d[Z](a)-(c?c:3));return b.join("")}, 
```

**从滑块 js 文件中替换为**

```
vb=function(d,c){return " "}, 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-14T11:12:12.357

首先，我要感谢**bijub**提供了宝贵的答案。但它不适用于最新版本的 query-slider.js 文件。对于最新版本，请尝试这些。它为我工作。

找到代码 "a.replace(/(?:. *.)?(\w)([\w-])?[^.]* (\w).[^.]*$/,"$1$3$2" )" 在 jquery-slider.js 文件中。

用您的网址替换“$1$3$2”。

例子 ：

```
a.replace(/(?:.*\.)?(\w)([\w\-])?[^.]*(\w)\.[^.]*$/,a) 
```

或者

```
a.replace(/(?:.*\.)?(\w)([\w\-])?[^.]*(\w)\.[^.]*$/,"http://www.mywebsite.com") 
```

享受 :D

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-18T13:56:42.993

我只是设法修复了 v2016.12.29 版本。找到这段代码：

```
yb=function(d,c){for(var b=[],a=0;a<d[e];a++)b[b[e]]=String[nb](d[Z](a)-(c?c:3));return b.join("")} 
```

并在里面插入这个小东西：`if (b.join("")=="Ninja Slider trial version") return "";`

像这样：

```
yb=function(d,c){for(var b=[],a=0;a<d[e];a++)b[b[e]]=String[nb](d[Z](a)-(c?c:3)); if (b.join("")=="Ninja Slider trial version") return "";return b.join("")} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-01T21:09:48.900

你需要把你的 slider.js 放在 jquery.js 文件之后

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-01T21:10:18.487

好的抱歉，由于许可，它在本地主机上运行良好，但在服务器上需要购买。否则它将无法工作；

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-09-07T02:33:52.513

这是旧的......但是我遇到了这个问题，我不相信价格是公平的，所以我没有欺骗它的问题

ThumbnailSlider 滑块 v2015.10.26

在 thumbnail-slider.js 中找到

```
apply(this, [a, Y, b, Qb, wb, o, vb, xb, document, m]
```

并替换为

```
apply(this, [a, Y, b, Qb, wb, o, vb, xb, o, m]
```

# java - 浮动按钮是AWT？

> ID：14114205
> 
> 赞同：1
> 
> 时间：2013-01-01T21:03:40.293
> 
> 标签：java, user-interface, button, awt

所以，我一直避免在 java 中使用 GUI，因为就我个人而言，我无法忍受 GUI。但是，我已经开始了一个需要我使用 GUI 的项目，而且，不出所料，我遇到了问题.. 我有这段代码..

```
public class DefaultWindow extends Window
{
    private DefaultWindow(Frame owner)
    {
        super(owner);
        contained = owner;
    }
    public DefaultWindow()
    {
        this(new Frame(""));
        contained.setBackground(Color.black);
        contained.setLocation(0, 0);
        contained.setSize(1280,720);
        Button comp = new Button("Hello");
        comp.setLocation(0, 0);
        comp.setSize(10, 10);
        add(comp);
        pack();
        contained.setVisible(true);
    }
} 
```

.. 它创建了一个黑色背景的 1280x720 窗口（这很好），它还在我屏幕的左上角创建了一个浮动按钮.. 如何使按钮位于窗口中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T21:12:53.737

您正在创建一个 Window 子类的实例，该实例在其构造函数中创建一个 Frame（它本身就是一个 Window）。您正在显示这个空框架，并将按钮添加到您正在创建的窗口中。所以最后你有两个窗口。

我认为您真正想要的是创建一个且只有一个 Frame。你的类不应该扩展 Window，所有这些都不应该在构造函数中完成。此外，AWT 有点过时了。您应该使用 Swing。Oracle 有一个很棒的关于 Swing 的教程，顺便说一句，它还解释了如何使用布局管理器（你应该这样做）。[阅读本教程](http://docs.oracle.com/javase/tutorial/uiswing/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T21:13:42.730

就个人而言，我会（个人）在 AWT 上使用基于 Swing 的组件，除此之外，还有更多的组件和支持。

`contained`是一个无效的参考，你不需要它。您创建了两个窗口，只显示一个没有按钮的窗口。删除对 Frame 的引用并改为依赖窗口

```
public DefaultWindow()
{
    setBackground(Color.black);
    setLocation(0, 0);
    setSize(1280,720);
    Button comp = new Button("Hello");
    setLocation(0, 0);
    comp.setSize(10, 10);
    add(comp);
    pack();
    setVisible(true);
} 
```

我会避免将窗口设置为任意大小，并非所有屏幕都相同。

您还将违反布局管理器，这意味着您提供给按钮的设置可能会被覆盖。

我会花时间阅读[使用 JFC/Swing 创建 GUI](http://docs.oracle.com/javase/tutorial/uiswing/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T21:17:48.357

> 问：所以，我一直避免在 java 中使用 GUI，因为就我个人而言，我无法忍受 GUI。

A：嘿：我以为我在这个星球上是孤独的 :) 我的座右铭一直是“GUI 让简单的任务更容易……而困难的任务完全不可能”;)

至于你的问题：答案是：

1) Swing 适合“厚客户端”（即 Java 桌面应用程序）

2) JSP 适用于“Web 应用程序”（即客户端/服务器 Web 应用程序）

3) 甚至不要*考虑*在整个 GUI 中使用 AWT。它在 Java 历史的早期就被弃用了（特别是 Java 1.2）。

这里有一些很好的教程：

*   [http://www.java2s.com/Code/Java/Swing-JFC/HelloWorldSwing.htm](http://www.java2s.com/Code/Java/Swing-JFC/HelloWorldSwing.htm)

*   [http://www.ibm.com/developerworks/java/tutorials/j-tomcat/](http://www.ibm.com/developerworks/java/tutorials/j-tomcat/)

PS：尽管我说了关于 GUI 的内容……但 IDE 可能非常有帮助。

就个人而言，我使用 Eclipse。有几个原因：

*   Eclipse（与大多数 IDE 一样）可用于 cmd-line、Swing、JSP 和 Java EE 应用程序。

*   Eclipse（与 Netbeans 或 IntelliJ 不同）对 Android 应用程序同样有用

*   Eclipse 拥有*极其*广泛的 3rd 方插件生态系统（来自 IBM 和 Google 等公司）。

恕我直言...

# python - 使用 Django ORM 过滤日期时间范围时的奇怪行为

> ID：14114212
> 
> 赞同：1
> 
> 时间：2013-01-01T21:04:21.650
> 
> 标签：python, django, orm, sqlite

我正在尝试使用 Django 从 sqlite 数据库中查询数据。

**该模型**

```
class SolarEntryHour(models.Model):
    time = models.DateTimeField()
    device = models.ForeignKey(Device)
    lW = models.DecimalField(max_digits=9, decimal_places=3)

    class Meta:
        unique_together = (("time", "device")) 
```

**我如何尝试访问数据**

```
start = datetime.datetime.utcnow()+relativedelta(hour=0, minute=0, second=0, microsecond=0)
end = datetime.datetime.utcnow()

ticks = SolarEntryHour.objects.filter(
    time__range=(start, end), 
    device = str(deviceID)
) 
```

**发生了什么**

```
Exception Value:    
list index out of range
Exception Location: /usr/lib/python2.7/dist-packages/django/db/backends/util.py in typecast_timestamp, line 97 
```

异常似乎发生了，当查询实际执行时（在迭代“滴答声”时）Django尝试执行查询，并且输出`print start; print end`看起来很好

```
2013-01-01 00:00:00 - 2013-01-01 20:47:24.245942

SELECT "charts_solarentryhour"."id", "charts_solarentryhour"."time", "charts_solarentryhour"."device_id", "charts_solarentryhour"."lW" 
FROM "charts_solarentryhour" 
WHERE ("charts_solarentryhour"."device_id" = 1  AND "charts_solarentryhour"."time" 
BETWEEN 2013-01-01 00:00:00 and 2013-01-01 20:47:24.245942) 
```

***编辑：***
我想我找到了问题，但**我不知道这是预期的行为还是 Django Bug。**

表“charts_solarentryhour”的“时间”字段定义为：
`time = models.DateTimeField()`
该表由数据库触发器填充，没有向该字段输入完整的日期时间，soley`strftime('%Y-%m-%d %H', 'now')`

当 Django 然后执行查询时，在解析查询结果时失败，因为从数据库返回的字符串中没有分钟和秒（这就是抛出列表索引超出范围异常的原因）

不填充整个日期时间字段是一种不好的做法吗？
Django不应该能够添加一些零吗？
有没有什么好的方法可以解决这个问题而不会退回到原始查询执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-20T19:10:41.210

不是 Django 的问题 是 dateutil 的 relativedelta 函数的奇怪行为

您必须编写以下内容：

> > > 开始 = datetime.datetime.utcnow()+relativedelta(hours=0,minutes=0,seconds=0,microseconds=0)

并不是

> 开始 = datetime.datetime.utcnow()+relativedelta(hour=0,minute=0,second=0,microsecond=0)

小时更改替换（因此不添加）初始值

```
>>>import datetime
>>>from dateutil.relativedelta import relativedelta
>>>t1 = datetime.datetime.utcnow()
>>>t1 
datetime.datetime(2013, 11, 20, 18, 55, 11, 895897)
>>>t2 = t1 + relativedelta(hour=1, minute=3, second=7, microsecond=1) 
>>>t2
datetime.datetime(2013, 11, 20, 1, 3, 7, 1)
>>>t3 = t1 + relativedelta(hours=1, minutes=1, seconds=1, microseconds=1) 
>>>t3
datetime.datetime(2013, 11, 20, 19, 56, 12, 895898) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-11T06:04:14.837

问：不填充整个日期时间字段是一种不好的做法吗？

是的 - 有很多工具可以愉快地解析格式良好的标准日期格式。因此，当您发明自己的格式时，预计会发生不好的事情。Django 和几乎所有框架都希望您使用标准字段类型的既定约定。

问：Django 不应该能够添加一些零吗？

不——这将是黑魔法。“2013-01-10 10”没有常规意义。

问：有什么好的方法可以解决这个问题，而不会退回到原始查询执行？

是的 - 在此处查看答案：[DateTimeField 的格式](https://stackoverflow.com/questions/1945239/format-for-datetimefield)

# codeigniter - CodeIgniter 应用程序的 OpenID

> ID：14114213
> 
> 赞同：0
> 
> 时间：2013-01-01T21:04:27.867
> 
> 标签：codeigniter, openid, codeigniter-2

所以我正在构建一个`cloud`平台来处理一堆**CodeIgniter**应用程序。
这个想法是在这些应用**程序之间*****共享***凭据，因此用户可以使用**相同**的. 可以这样描述 ：****`account`
`process`****

 *****   用户查看站点：[http://myapps.tld](http://myapps.tld)
*   [用户在http://myapps.tld](http://myapps.tld)上创建一个帐户
*   用户在[http://myapps.tld/apps上浏览应用程序](http://myapps.tld/apps)
*   用户购买 App1 && App2
*   主站点上有一个注册表单（比如说“http://myapps.tld”）
*   [用户在http://myapp1.tld](http://myapp1.tld)和[http://myapp2.tld](http://myapp2.tld)上输入他相同的凭据（[http://myapps.tld](http://myapps.tld)）

[http://myapps.tld](http://myapps.tld)上的身份验证是从头开始编码的（非常基本的）。
我认为实现这一点的一种方法是使用基于[http://openid.myapps.tld构建的](http://openid.myapps.tld)**OpenID**机制，并且每当用户需要从平台对应用程序进行身份验证时，他将被重定向到 openid.myapps.tld确认/验证他的凭据并重定向回他***完全***识别的应用程序。

 ***OpenID**是我的正确选择吗？我可以依靠它来处理主站点和不同应用程序上的身份验证吗？

如果是这样，我已经看到了一个或两个用于在 CI 2 上实现 OpenID 的库，但是如果您有一些提示/教程，我会很感激分享:)

我还在考虑为“论坛/维基/博客”工具/服务添加相同的 OpenID 机制，这样用户/客户端就不必再创建多个帐户来使用平台上的任何服务/应用程序。

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T23:23:35.583

OpenID 是要走的路。在getsparks.org 上有几个火花：

最新的 oauth2 可能是最好的选择。 [http://getsparks.org/packages/oauth2/versions/HEAD/show](http://getsparks.org/packages/oauth2/versions/HEAD/show)*****

# android - 从 Android 中的其他类更新 LinearLayout

> ID：14114217
> 
> 赞同：0
> 
> 时间：2013-01-01T21:04:39.240
> 
> 标签：android, class, dynamic, android-linearlayout

我有一个类，它使用其他类来构建一个`FrameLayout`. 一个用于通过建筑物导航，另一个用于显示带有传感器的示意图，另一个用于显示传感器数据。我一次构建了整个框架，并希望使传感器数据在框架的传感器视图部分中可见。假设我有 5 个传感器，当我单击一个时，传感器视图会显示传感器数据。我可以让 5 个传感器视图框架相互叠加，使它们不可见，然后通过单击传感器使选择的一个可见。

我想问一下，是否可以使用更新方法更改`LinearLayout`包含s 的不同类中的内容？`TextView`

我已经尝试过了，但我的代码目前无法正常工作。

```
public static SensorBar Create_SensorBar_Layout(Context myContext, ObjectStructure objStruct, ObjectView objView, List<SensorDevice> listofCurrentSensordevices)
{   
// Init
    LinearLayout SensorBarLinearLayout = new LinearLayout(myContext);

    LinearLayout.LayoutParams layoutParamsSensorBar = new LinearLayout.LayoutParams(
            200, 653);
    layoutParamsSensorBar.setMargins(5, 5, 5, 5);

    SensorBarLinearLayout.setOrientation(LinearLayout.VERTICAL);
    SensorBarLinearLayout.setLayoutParams(layoutParamsSensorBar);
    SensorBarLinearLayout.setBackgroundResource(R.drawable.window_frame);
    SensorBarLinearLayout.setPadding(4,4,4,4);  

    LinearLayout SensorBarData = new LinearLayout(myContext);

    LinearLayout.LayoutParams layoutParamsSensorBarData = new LinearLayout.LayoutParams(
            LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);

    SensorBarData.setOrientation(LinearLayout.VERTICAL);
    SensorBarData.setLayoutParams(layoutParamsSensorBarData);

    //--- Button Headline ---
    Button buttonNavBarHeadline = new Button(myContext);
    buttonNavBarHeadline.setText("Sensordata");
    buttonNavBarHeadline.setTextColor(Color.BLACK);
    buttonNavBarHeadline.setBackgroundResource(R.layout.mainview_window_headline);
    buttonNavBarHeadline.setTextAppearance(myContext, R.style.headline3);

//Layout buildup
    SensorBarLinearLayout.addView(buttonNavBarHeadline);
    SensorBarLinearLayout.addView(SensorBarData);

    return new SensorBar(SensorBarLinearLayout, SensorBarData);

} 
```

这是 Sensorbar，我希望通过单击传感器按钮动态换出 LinearLayout SensorBarData。

```
public void updateSensorBar(Context myContext, ObjectStructure objStruct, List<SensorDevice> listofCurrentSensordevices, int activeSensor)
{
LinearLayout linearlayoutSensorvalueTextviews = new LinearLayout(myContext);

... (additional Textviews for Sensordata, which get added with addview())

setSensorBarData(linearlayoutSensorvalueTextviews);
} 
```

这由 OnClick 事件使用。

```
public void setSensorBarData(LinearLayout SensorBarData)    { this.dataSensorBar = SensorBarData; } 
```

updateSensorBar 使用它来更新 LinearLayout。

我会很高兴有任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:45:57.533

定义一个接口并使用回调让活动知道传感器已更新。

```
public Interface SensorUpdatedListener {
    void onSensorUpdated();
} 
```

在您的 SensorBar 类中。

```
ArrayList<SensorUpdatedListener > listeners = new ArrayList<SensorUpdatedListener >();

...

public void setSensorUpdatedListener(SensorUpdatedListener listener){
    listeners.add(listener);
} 
```

在您的传感器栏更新方法中：

```
for (SensorUpdatedListener listener:listeners){
   listener.onSensorUpdated();
} 
```

在您的活动中：

```
public class Test extends Activity implements SensorUpdatedListener {

...

@Override
public void onCreate(Bundle savedInstanceState) 
{
    ...

    sensorBar.setSensorUpdatedListener(this);
    ...
}

public void onSensorUpdated(){
   // do whatever you need to do
} 
```

您可以通过添加 removeSensorUpdatedListener 并检查您没有在 setSensorUpdatedListener 中添加两次相同的侦听器来改进 SensorBar 类。

# java - 无法用空消息确定 NetworkOnMainThreadException 的原因

> ID：14114218
> 
> 赞同：1
> 
> 时间：2013-01-01T21:04:47.830
> 
> 标签：java, android, multithreading

我在我的 Android 应用程序中登录期间向 API 运行 POST 请求，以获取用户的信息并验证他们的帐户是否存在。`NetworkOnMainThreadException`当我尝试执行此操作时，我会遇到一个问题。

```
logger.log(Level.INFO, "POST request URL: "+this.getUrl());
URL url = new URL(this.getUrl());
HttpURLConnection connection = (HttpURLConnection) url.openConnection();
logger.log(Level.INFO, "Connection open");
connection.setDoOutput(true);
connection.setDoInput(true);
connection.setInstanceFollowRedirects(false);
connection.setRequestMethod("POST");
connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
connection.setRequestProperty("charset", "utf-8");
connection.setUseCaches(false);

OutputStream outputStream = connection.getOutputStream();
DataOutputStream wr = new DataOutputStream(outputStream); //ERROR HAPPENS HERE 
```

该异常实际上有一个空错误消息。通过对此异常的研究，我发现这似乎是一个线程问题，我在与此 POST 请求相同的线程上运行 UI。这是真的？

我已经在 Glassfish 上运行的基于 Web 的应用程序上使用了相同的方法，并且效果很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T21:07:16.500

是的，它是真实的。[就响应](http://developer.android.com/training/articles/perf-anr.html)性而言，在 GUI 线程中运行 IO 东西并不是一个好主意。如果您尝试在 GUI 线程中进行网络操作，这就是 Android 抛出[NetworkOnMainThreadException的原因。](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html.)另请参阅[此博客文章](http://www.androiddesignpatterns.com/2012/06/app-force-close-honeycomb-ics.html)，了解为什么会引发此异常。

解决方案很简单，[使用 AsyncTask 在单独的线程中进行](https://stackoverflow.com/a/6343299/227192)网络操作。

# d - 添加到 D 中的动态数组？

> ID：14114228
> 
> 赞同：2
> 
> 时间：2013-01-01T21:05:52.533
> 
> 标签：d

我现在一定遗漏了一些明显的东西，但我不知道如何将元素添加到 D 中的动态数组中。

我试过这个，但没有成功：

```
string[] links;
foreach(link; someOtherArray) {
    // Do something with link ...
    links[] = link; // Trying here to add to the links array
} 
```

和这个：

```
string[] links;
int i = 0;
foreach(link; someOtherArray) {
    // Do something with link ...
    links[i] = link; // Trying here to add to the links array
    i++;
} 
```

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-01T21:08:02.583

使用 concat 运算符：a ~ b 或 a ~= b;

```
string[] links;
foreach(link; arr) {
     links ~= link;
} 
```

右侧可以是单个元素或另一个数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T16:55:00.180

对于这种情况，以下方法也可能起作用：

```
string[] links;
links ~= someOtherArray; 
```

# html - 标题 h2 到 h4 不是它们应该的颜色，可能是某个地方的语法不正确？

> ID：14114235
> 
> 赞同：2
> 
> 时间：2013-01-01T21:06:52.947
> 
> 标签：html, css

无法解决这个问题。`h2`我从到到的标题`h4`是白色而不是黑色。`color: white;`从一个甚至没有在页面上使用（但在样式表中）的类中删除时，一切似乎都有效：

```
.right_content_default h1,h2,h3,h4,h5,h6 {
    color: white;
} 
```

我唯一能想到的是一个可能的语法问题，但我无法在样式表中找到它。

这是小提琴：[jsfiddle](http://jsfiddle.net/sD3T2/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-01T21:09:25.983

您的选择器正在寻找`"h1 inside .right_content_default, or any of h2, h3, h4, h5, h6"`. 没有什么告诉它只将白色应用于该类名称内的标题，除了`h1`.

正确的 CSS 是：

```
.right_content_default h1, .right_content_default h2, .right_content_default h3,
.right_content_default h4, .right_content_default h5, .right_content_default h6 {
    color:white
} 
```

但在某些浏览器中，您可以这样做：

```
.right_content_default :matches(h1,h2,h3,h4,h5,h6) {color:white} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-01T21:09:40.187

尝试这个：

```
 .right_content_default h1,
      .right_content_default h2,
      .right_content_default h3,
      .right_content_default h4,
      .right_content_default h5,
      .right_content_default h6 {
       color: white;
      } 
```

# javascript - jQuery使元素随鼠标移动

> ID：14114237
> 
> 赞同：1
> 
> 时间：2013-01-01T21:07:10.273
> 
> 标签：javascript, jquery

所以我可以用鼠标移动一个元素，但是问题是偏移量是从元素的左上角计算的，没有考虑到鼠标在元素中的位置，导致对象跳向鼠标并防止你从向上或向左拖动它。

所以我想出了这个功能：

```
 handle.on("mousemove", function(e) {
    if (state.dragging) {
      var paneOffset = pane.offset();
      var mouseOffset = {
        'top': e.pageY - paneOffset.top,
        'left': e.pageX - paneOffset.left
      }
      pane.offset({
        top: e.pageY - mouseOffset.top,
        left: e.pageX - mouseOffset.left
      });
    }
  }); 
```

示例：http: [//jsfiddle.net/SEKxc/](http://jsfiddle.net/SEKxc/)

这样做的问题是它会阻止元素移动，因为它总是计算元素的相同精确偏移量。我如何使元素跟随鼠标但相对于鼠标在对象中的位置。

我知道 jQueryUI 内置了这个功能，但不想使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:17:11.007

您可以在 dragstart 上计算初始 mouseoffset 并因此将其用作 mousemove 处理程序中的全局变量。由于拖动开始在鼠标移动之前开始，我没有看到问题。

更新：您需要存储对象初始偏移量和鼠标初始偏移量，并计算鼠标与 mouseMove 上原始偏移量相比的相对偏移量，然后对元素应用相同的变换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:17:51.943

开始拖动时存储鼠标位置和元素左上角之间的距离。然后，您只需从鼠标位置中减去它们即可计算鼠标移动时的元素位置。

# ruby-on-rails - Rails：模型：类的方法“范围”

> ID：14114247
> 
> 赞同：1
> 
> 时间：2013-01-01T21:08:00.947
> 
> 标签：ruby-on-rails, activerecord

我有两个模型：

```
class Forum < ActiveRecord::Base
  has_many :threads
end

class Thread < ActiveRecord::Base
  belongs_to :forum, :dependent => :destroy
  has_many :posts
end 
```

在我看来，我试试这个：

```
<%= @forum.name %>
<% @forum.threads.each do |thread| %>
  <%= link_to thread.name, [@forum, thread], :class => "remote" %>
<% end %> 
```

我在第 1 行收到此错误：

```
undefined method `scoped' for Thread:Class 
```

知道这里发生了什么吗？我看到其他用户描述了这个问题，但这通常是因为他们将 has_many 复数或将 belongs_to 单数化。据我所知，我的模型制作精良。请让我知道我做错了什么。

完整的堆栈跟踪：

```
activerecord (3.2.9) lib/active_record/associations/association.rb:123:in `target_scope'
activerecord (3.2.9) lib/active_record/associations/association.rb:87:in `scoped'
activerecord (3.2.9) lib/active_record/associations/collection_association.rb:382:in `find_target'
activerecord (3.2.9) lib/active_record/associations/collection_association.rb:335:in `load_target'
C:in `load_target'
activerecord (3.2.9) lib/active_record/associations/collection_proxy.rb:87:in `method_missing'
app/views/forums/_show.html.erb:2:in `_app_views_forums__show_html_erb___1062139204_27502608'
actionpack (3.2.9) lib/action_view/template.rb:145:in `block in render'
activesupport (3.2.9) lib/active_support/notifications.rb:125:in `instrument'
actionpack (3.2.9) lib/action_view/template.rb:143:in `render'
actionpack (3.2.9) lib/action_view/renderer/partial_renderer.rb:265:in `render_partial'
actionpack (3.2.9) lib/action_view/renderer/partial_renderer.rb:238:in `block in render'
actionpack (3.2.9) lib/action_view/renderer/abstract_renderer.rb:38:in `block in instrument'
activesupport (3.2.9) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.9) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.9) lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'
actionpack (3.2.9) lib/action_view/renderer/partial_renderer.rb:237:in `render'
actionpack (3.2.9) lib/action_view/renderer/renderer.rb:41:in `render_partial'
actionpack (3.2.9) lib/action_view/helpers/rendering_helper.rb:27:in `render'
app/views/forums/show.html.erb:1:in `_app_views_forums_show_html_erb___608144578_36161352'
actionpack (3.2.9) lib/action_view/template.rb:145:in `block in render'
activesupport (3.2.9) lib/active_support/notifications.rb:125:in `instrument'
actionpack (3.2.9) lib/action_view/template.rb:143:in `render'
actionpack (3.2.9) lib/action_view/renderer/template_renderer.rb:47:in `block (2 levels) in render_template'
actionpack (3.2.9) lib/action_view/renderer/abstract_renderer.rb:38:in `block in instrument'
activesupport (3.2.9) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.9) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.9) lib/action_view/renderer/abstract_renderer.rb:38:in `instrument'
actionpack (3.2.9) lib/action_view/renderer/template_renderer.rb:46:in `block in render_template'
actionpack (3.2.9) lib/action_view/renderer/template_renderer.rb:54:in `render_with_layout'
actionpack (3.2.9) lib/action_view/renderer/template_renderer.rb:45:in `render_template'
actionpack (3.2.9) lib/action_view/renderer/template_renderer.rb:18:in `render'
actionpack (3.2.9) lib/action_view/renderer/renderer.rb:36:in `render_template'
actionpack (3.2.9) lib/action_view/renderer/renderer.rb:17:in `render'
actionpack (3.2.9) lib/abstract_controller/rendering.rb:110:in `_render_template'
actionpack (3.2.9) lib/action_controller/metal/streaming.rb:225:in `_render_template'
actionpack (3.2.9) lib/abstract_controller/rendering.rb:103:in `render_to_body'
actionpack (3.2.9) lib/action_controller/metal/renderers.rb:28:in `render_to_body'
actionpack (3.2.9) lib/action_controller/metal/compatibility.rb:50:in `render_to_body'
actionpack (3.2.9) lib/abstract_controller/rendering.rb:88:in `render'
actionpack (3.2.9) lib/action_controller/metal/rendering.rb:16:in `render'
actionpack (3.2.9) lib/action_controller/metal/instrumentation.rb:40:in `block (2 levels) in render'
activesupport (3.2.9) lib/active_support/core_ext/benchmark.rb:5:in `block in ms'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/benchmark.rb:295:in `realtime'
activesupport (3.2.9) lib/active_support/core_ext/benchmark.rb:5:in `ms'
actionpack (3.2.9) lib/action_controller/metal/instrumentation.rb:40:in `block in render'
actionpack (3.2.9) lib/action_controller/metal/instrumentation.rb:83:in `cleanup_view_runtime'
activerecord (3.2.9) lib/active_record/railties/controller_runtime.rb:24:in `cleanup_view_runtime'
actionpack (3.2.9) lib/action_controller/metal/instrumentation.rb:39:in `render'
actionpack (3.2.9) lib/action_controller/metal/implicit_render.rb:10:in `default_render'
actionpack (3.2.9) lib/action_controller/metal/implicit_render.rb:5:in `send_action'
actionpack (3.2.9) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.9) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.9) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.9) lib/active_support/callbacks.rb:425:in `_run__271720943__process_action__435225614__callbacks'
activesupport (3.2.9) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.9) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.9) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.9) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.9) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.9) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.9) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.9) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.9) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.9) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.9) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.9) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.9) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.9) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.9) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.9) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.9) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.9) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.9) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.9) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.9) lib/action_dispatch/routing/route_set.rb:601:in `call'
warden (1.2.1) lib/warden/manager.rb:35:in `block in call'
warden (1.2.1) lib/warden/manager.rb:34:in `catch'
warden (1.2.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/cookies.rb:341:in `call'
activerecord (3.2.9) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.9) lib/active_support/callbacks.rb:405:in `_run__598850227__call__514831618__callbacks'
activesupport (3.2.9) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.9) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.9) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.9) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.9) lib/rails/rack/logger.rb:32:in `call_app'
railties (3.2.9) lib/rails/rack/logger.rb:16:in `block in call'
activesupport (3.2.9) lib/active_support/tagged_logging.rb:22:in `tagged'
railties (3.2.9) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.9) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.9) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.9) lib/rails/engine.rb:479:in `call'
railties (3.2.9) lib/rails/application.rb:223:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.9) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-01T21:32:11.927

问题是由您的模型类名称引起的`Thread`，因为它也是标准 Ruby 类的名称。

当 Rails 尝试查找关联的目标类时，它使用内部类[`Thread`](http://www.ruby-doc.org/core-1.9.3/Thread.html)（没有`scoped`方法）而不是您的模型类。

有两种解决方案：

1.**重命名模型**（*最佳解决方案*）

```
class Topic < ActiveRecord::Base #Thread class
end

class Forum < ActiveRecord::Base
  has_many :topics
end 
```

这样您仍然可以保留原始关联名称：

```
class Forum < ActiveRecord::Base
  has_many :theads, class_name: 'Topic'
end 
```

2.**将您的`Thread`模型放入一个模块中**（*有效，但可能有不想要的副作用*）

```
class MyApp::Thread < ActiveRecord::Base
end

class Forum < ActiveRecord::Base
  has_many :threads, class_name: 'MyApp::Thread'
end 
```

您还可以将*所有*模型和控制器放在一个模块中。Rails 首先在当前模块中查找常量，因此`Thread`会首先找到您的类。这还具有您不必`class_name`在关联或控制器操作中显式指定的优点。

```
class MyApp::Thread < ActiveRecord::Base
end

class MyApp::Forum < ActiveRecord::Base
  has_many :threads # Works!
end

class MyApp::ThreadsController < ApplicationController
  def show
    @thread = Thread.find(params[:id]) # Works!
  end
end 
```

但是您还必须更改您`routes.rb`对模块的说明，并且您在视图中的输入名称都将以模块名称为前缀，因此即使此解决方案看起来很干净，它也可能不是您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:36:31.090

也许这个构造：`[@forum, thread]`正在让 rails 在 config/routes.rb 中寻找嵌套资源，例如

```
resources :forums do
    resources :threads
end 
```

# vb.net - 无法更改 Crystal Reports 2010 中的数据源

> ID：14114250
> 
> 赞同：1
> 
> 时间：2013-01-01T21:08:07.867
> 
> 标签：vb.net, crystal-reports-2010

我有一个从 vb.net 应用程序调用的 Crystal Report，我正在尝试将数据源从 SQL Server 更改为 MySQL。我已经修改了 ODBC 数据源，它测试正常。但是，当我尝试使用（数据库，设置数据源位置）更改 Crystal 中的数据源时，它会失败并显示消息“无法替换某些表，因为在新数据源中找不到匹配项”。在我设置新连接然后选择现有数据源和新数据源然后按更新按钮后会出现该消息。

我试过单独做每个表，点击更新按钮后它什么也没做（没有消息，什么都没有）。

有什么帮助吗？

维克

# php - 仅对修改的行使用 PHP_CodeSniffer

> ID：14114260
> 
> 赞同：12
> 
> 时间：2013-01-01T21:09:16.140
> 
> 标签：php, svn, pre-commit-hook, codesniffer

我正在尝试在 SVN 中构建一个预提交脚本，并且我只想在**修改后的行**上运行 PHP_CodeSniffer （而不是整个文件）。到目前为止，我有这个脚本：

```
#!/bin/sh

REPOS="$1"
TXN="$2"

# Make sure that the log message contains some text.
SVNLOOK=/usr/bin/svnlook
$SVNLOOK log -t "$TXN" "$REPOS" | \
   grep "[a-zA-Z0-9]" > /dev/null || exit 1

# Check for code validation before commiting the script using PHP_CodeSniffer
/tmp/pear/download/PHP_CodeSniffer-1.4.3/scripts/phpcs-svn-pre-commit  "$REPOS" -t "$TXN" >&2 || exit 1

# All checks passed, so allow the commit.
exit 0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-05-21T22:51:25.323

2017 年，[CodeSniffer 3.0.0](https://github.com/squizlabs/PHP_CodeSniffer/releases/tag/3.0.0)发布后，[新增了`--cache`选项](https://github.com/squizlabs/PHP_CodeSniffer/releases/tag/3.0.0a1)。

或者您可以使用默认情况下**执行此操作的**[EasyCodingStandard](https://github.com/Symplify/EasyCodingStandard)。

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:51:00.480

从概念上讲，它没有意义。

phpcs 需要知道洞的上下文才能正确分析。

仅扫描更改的行将删除上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-16T22:46:06.037

有一个项目[`lint-diffs`](https://pypi.org/project/lint_diffs/)可以在差异输出文件上运行任何 linter。

`phpcs --report=emacs`作为命令使用。正则表达式可以与示例配置相同。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-12-10T09:31:46.877

以下是在 Phabricator 的工具 Arcanist 中的操作方式：

1.  它在每个更改的文件上运行 php 代码嗅探器并收集所有错误
2.  通过行号限制这些错误，其中只允许在此提交中更改的行号

这当然不会涵盖某些特定情况，当 LineA 的更改导致 LineB 的错误时。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2017-04-15T18:26:33.480

我知道这个话题已经过时了。我构建了自己的解决方案来实现这一目标（仅扫描最近更改的行）。这还为时过早，但有效

[https://github.com/ayeo/sniffer](https://github.com/ayeo/sniffer)**

# html - 如何使用 HTML5 进行多输入验证？

> ID：14114267
> 
> 赞同：1
> 
> 时间：2013-01-01T21:10:09.333
> 
> 标签：html, validation

HTML5 提供了使用正则表达式的 JavaScript 验证的替代方案。但我想在单个输入字段上添加多个验证，并据此显示消息。

例如。

`<input type=passowrd name=passowrd/>`

此处密码字段应包含以下验证消息。 ![在此处输入图像描述](../Images/3826f9aca7fdb65f3deb4cb3d6db24db.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:24:32.270

恐怕它不能单独使用 HTML（不，甚至 HTML5）。

您必须使用 JavaScript 来完成任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T21:25:19.263

约束验证仅针对每个输入字段的一条错误消息而设计。解决此问题的一种方法是连接验证消息。

```
password.setCustomValidity(password.validationMessage + ' At least one capital letter'); 
```

缺点是您不能附加 html，因此所有消息都将内联放置。

# eclipse - 如何将码头绑定到特定的ip，允许从另一台计算机访问webapp？

> ID：14114277
> 
> 赞同：1
> 
> 时间：2013-01-01T21:11:14.293
> 
> 标签：eclipse, maven, jetty

我需要运行本地码头服务器，它可以提供从另一个网络中的另一台计算机访问我的网络应用程序。更具体地说，在网络 A 中的计算机 A 中运行码头，并从网络 B 中的计算机 B 访问应用程序。

我如何使用 run jetty run eclipse 插件或 mvn jetty:run 命令行来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:11:08.717

如果您需要它用于开发目的，那么这些选项中的任何一个都应该可以工作，但是如果您将它用于任何其他目的，我建议您运行适当配置的股票码头分布或编写一个小型嵌入式码头服务器来做您想做的事情。

您应该能够从这里获得适合您的码头版本的文档：

[http://www.eclipse.org/jetty/documentation/](http://www.eclipse.org/jetty/documentation/)

# java - 使用字符串获得的尺寸设置文本大小

> ID：14114278
> 
> 赞同：0
> 
> 时间：2013-01-01T21:11:20.943
> 
> 标签：java, android

我正在使用这个函数通过 Java 从我的 dimens.xml 文件中获取一个维度：

```
public static float getDimen(Context context, String name)
{
    Assert.assertNotNull(context);
    Assert.assertNotNull(name);

    Resources res = context.getResources();
    int dimensionID = res.getIdentifier(name, "dimen", context.getPackageName());

    return res.getDimension(dimensionID);
} 
```

这类似于：`getDimen(mContext, "textsize_small")`并检索“R.dimen.textsize_small”值（或至少应该如此）。

```
<resources>
      <dimen name="textsize_small">10dp</dimen>
      <dimen name="textsize_medium">13dp</dimen>
      <dimen name="textsize_large">15dp</dimen>
      <dimen name="textsize_xlarge">17dp</dimen>
</resources> 
```

所以，在有了这个值之后，我用它来设置 TextView 的 TextSize：

```
float textsize = getDimen(mContext, "textsize_" + object.getDesiredSize);
textview.setTextSize(textsize);
Log.d(TAG, "TextSize: " + textview.getTextSize()); 
```

编辑：

我设置`android:textSize="@dimen/textsize_small"`并使用了`getDimen(mContext, "textsize_small")`. 在第一个中，Log.d 返回**15.0**，在第二个中返回**22.5**

是否缺少任何类型转换？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T21:15:22.523

~~答案是正确的。您在 xhdpi 设备（标称 360 像素/英寸）上运行，并且您已将值定义为`dp`. 所以 10dp 是 22.5 像素（10 * 360 / 160 - 其中 160 是 dp 值缩放的默认像素密度）。换句话说，22.5 像素在屏幕上的物理尺寸与 10 像素在 mdpi（160 像素/英寸）屏幕上的物理尺寸相同。~~

看起来您正在应用 dp 到像素的转换两次。在 hdpi 设备上，比率为 1.5，您得到的平方是 (1.5 ² * 10 = 22.5)。这是因为您调用`setTextSize(textsize)`. 从[文档](http://developer.android.com/reference/android/widget/TextView.html#setTextSize%28float%29)：

> 将默认文本大小设置为给定值，解释为“缩放像素”单位。此大小根据当前密度和用户字体大小偏好进行调整。

尝试使用：

```
textview.setTextSize(TypedValue.COMPLEX_UNIT_PX, textsize); 
```

# mysql - 具有大树的mysql层次结构存储

> ID：14114280
> 
> 赞同：4
> 
> 时间：2013-01-01T21:12:05.947
> 
> 标签：mysql, database, hierarchy, hierarchical-data

我不知道如何将分层数据存储在我的 innoDB 表中。

我已经阅读了很多关于`parent_id`在每一行中存储的方法的缺点。但现在的问题是，我有一个非常大的数据库（约 5000 万行）。层次结构大多不是很深（3-6 级）。

许多网站建议将“嵌套集模型”作为 parent-id-storing-method 的更好替代方案。但是网站的用户总是会进行更改（`UPDATE`等`INSERT`），并且由于我的表的大小，这将花费太多时间（因为“嵌套集模型”中的更改具有非常低的性能）。

所以我的问题是：如何使用许多`update`/`insert`命令有效地存储大型分层数据？（也阻止整个表不是一个选项[-> innoDB-table]）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T21:52:24.933

当您需要对树进行频繁更新时，嵌套集设计绝对是困难的。您最终不得不重新编号树的大部分。

减轻这种情况的一个建议是使用浮点数而不是整数。如果在树中插入一个新节点，则在新节点的父节点的嵌套集合数字之间找到一些 FLOAT 数字相对容易。您最终可能会达到浮点数精度的极限，但由于您的树不是很深，这在很长一段时间内都不会发生。

我写过的另一种技术称为**Closure Table**。这种存储层次结构的方法使得在大树中插入/更新/删除节点变得更加容易，而无需更新大量树。您仍然可以在单个非递归 SQL 查询中查询整个树或任何子树。

要阅读有关闭包表的更多信息，请参阅：

*   [将平面表解析为树的最有效/优雅的方法是什么？](https://stackoverflow.com/questions/192220/what-is-the-most-efficient-elegant-way-to-parse-a-flat-table-into-a-tree/192462#192462)
*   [使用 SQL 和 PHP 的分层数据模型](http://www.slideshare.net/billkarwin/models-for-hierarchical-data)
*   [在闭包表层次结构中移动子树](http://www.mysqlperformanceblog.com/2011/02/14/moving-subtrees-in-closure-table/)
*   [SQL 反模式：避免数据库编程的陷阱](http://pragprog.com/book/bksqla/sql-antipatterns)

* * *

回复您的评论：

Adjacency List 很简单，冗余最少，并且支持 FK 关系，而 Nested Sets 则不支持。[如果您使用递归查询](http://www.postgresql.org/docs/9.2/static/queries-with.html)，邻接表支持查询任意深度的整个树。但是 MySQL 不支持递归查询。

如果您只需要查询直接的父子关系（即一级深度），或者只查询固定深度的树，那么邻接表就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T21:50:37.777

对于分层数据，我喜欢将层次结构分开。例如，如果我们正在处理员工等级制度，我通常会这样做 -

```
create table employee (
    id serial primary key,
    name varchar(50));

create table roster (
    id serial primary key,
    employee_id int references employee (id),
    supervisor_id int references employee (id)); 
```

这可以通过向表中添加`row_date`或`start_date`和`stop_date`字段来扩展以提供历史层次结构`roster`。

确保`unique`在适用的情况下应用了约束和触发器以强制执行业务规则。

# ios - 限制对 Web 服务的访问，只允许移动客户端

> ID：14114285
> 
> 赞同：6
> 
> 时间：2013-01-01T21:12:58.967
> 
> 标签：ios, web-services, security, authentication

我目前正在构建一个移动应用程序（首先是 iOS），它需要一个后端 Web 服务来与之通信。

由于此服务将公开我只想由我的移动客户端访问的数据，因此我想限制对服务的访问。

但是，我对如何实现这一点有点怀疑。由于我的应用不需要身份验证，因此我不能只使用这些凭据对服务进行身份验证。不知何故，我需要能够识别请求是否来自受信任的客户端（即我的应用程序），这当然会导致人们认为可以只使用证书。但是这个证书不能从应用程序中提取并因此被滥用吗？

目前我的应用程序是基于 iOS 的，但后来 android 和 WP 也会出现。

我期望在 nodejs 中开发的 Web 服务，虽然这不是最终决定 - 但是它将是一个 RESTful 服务。

任何关于最佳实践的建议都值得赞赏！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-01T21:37:55.693

简单的回答：您不能阻止任何人从非移动客户端访问您的网站。然而，你可以让它变得更难。

简单的：

*   发送非标准 HTTP 标头
*   设置一些唯一的查询参数
*   发送一个有趣的（或微妙的不有趣的）用户代理字符串
*   （您可能还可以想到更多）

难的：

*   实施质询/响应协议以识别您的客户
*   (Ab) 使用 HTTP 作为您自己的加密内容的传输方式
*   （您可能还可以想到更多）

当然，任何人都可以提取数据、反编译代码、重放 HTTP 请求等等。但在某些时候，能够访问免费的 Web 应用程序并不值得为您的应用程序进行逆向工程所需的努力。

然而，这里有一个更基本的问题。与其他客户一起访问您的网站会有什么危害？你没有说；如果没有这些信息，基本上不可能推荐合适的解决方案。

# java - 在 Eclipse 的源代码中使用库？

> ID：14114289
> 
> 赞同：4
> 
> 时间：2013-01-01T21:13:29.270
> 
> 标签：java, eclipse

自从我不得不进行任何 Java 编程以来已经有大约 6 年了，而且自从我不得不进行任何大量的 Java 编程以来甚至更长。虽然我记得这门语言，但我在所有其他方面总是很薄弱，例如用于构建程序的所有工具等。事实上，我忘记的比我记得的要多——而且我首先是自学成才的。

过去，我的代码组织基于我在一些开源项目中看到的内容，因此我使用 com/mybiz/util 和 com/mybiz/network 等设置目录。我将类的源代码放在适当的目录中，并确保它位于与该路径匹配的包中。然后，如果我必须更改代码（例如修复错误或在现有类中添加新例程），对我来说很容易 - 更改它并重新编译类。我记得，我的项目根目录中的类的导入（它们都捆绑在一起）以使用这些类在该设置中没有问题。

然后有人告诉我 Eclipse，但我记得做的最重要的事情是重构它。在那之前，我的 IDE 是一个控制台窗口和一个文本编辑器。

所以我在那个层次结构中仍然有很多类——com/mybiz/util（等等）。但现在我将此代码用于个人库，所以它位于 com/tango/util 和 com/tango/network 等。我不得不在这里和那里对代码进行更改，以使其更加通用，并出于某种原因删除特定于业务的内容。

我现在想在 Eclipse 中将这些类用作我的项目的库。我宁愿不只是编译并将它们全部放入一个 jar 中，因为许多类仍在微调并需要重新编译。我宁愿只能够告诉 Eclipse，“在“com/tango ...”目录树中使用这个源代码包，然后在我的源代码中使用类似“import com.tango.util.FileUtils”的东西.

更重要的是，我希望能够在 Eclipse 中将其指定为库或某种可用的源代码或资源，以便将其轻松添加（或默认添加）到我创建的每个项目中。

我可以这样做吗？还是我应该寻找其他方法或其他方式来处理它？同样，我宁愿只包含源代码，因为它仍在被更改和重新编译。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T21:25:42.213

对于要使用 Eclipse 的重构“魔术”，您需要知道要执行的所有源文件，因此您必须将所有源代码添加到 Eclipse Java 项目中。

但是，如果您想拥有一组可用于多个项目的类，那么没有人会阻止您创建多个项目并在它们之间建立依赖关系。实现此目的的最简单方法是在 New Java Project 向导中添加依赖项（注意在设置项目名称后不要按完成按钮，而是使用*下一步*按钮，您可以在其中将现有 Java 项目添加到构建路径中）。

如果您的所有源代码都在单个或一些相互依赖的 Eclipse Java 项目中可用，那么 Eclipse 将负责编译所有类。通常，Eclipse 足够智能，只重新编译需要更改的部分，因此这个过程非常迅速（至少在大多数情况下）。

我希望这个答案足够有帮助 - 如果没有，请随时询问更多信息。

**编辑**：添加有关 Java 库支持的信息。

如果您的“库”项目没有更改，但您有一个 jar（通常是外部下载库的情况），Eclipse 允许您定义用户库 - 可以添加到 Java 项目的构建路径的库。要创建这样的用户库，请打开 Preferences，转到页面*Java* /*Build Path*/ *User Libraries*，您可以在其中定义由一个或多个 jar 文件组成的库。

但是，如果您正在开发自己的库，**并且**您的项目不会变得庞大（例如几百万行代码），我建议您将库项目作为源代码添加到 Eclipse 工作区中，因为根据我的经验，这更容易长期保持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:44:40.873

首先，我建议使用 IntelliJ（在我看来它比 eclipse 好得多），但是这样做也很可能而且很简单。因此，为了节省时间，让我们假设您在未来库中需要的所有类都是 Network.class、FileUtils.class 和 Helper.class。首先在您的桌面上创建一个名为 My Libraries 的新文件夹。右键单击它并点击发送到，然后点击压缩 Zip 文件夹。：

![例子](../Images/6b2859a273158b5aa760cb6404471ff7.png)

[![示例二](../Images/7b0991aab77a1c338e0673c1ef101e0d.png)](https://i.stack.imgur.com/d1awn.png)

完成后，将您的类文件拖到文件夹中。

打开 Eclipse 并选择一个工作区。完成此操作后，您应该会显示默认的 Eclipse 屏幕。现在点击 File 选项卡并将鼠标悬停在 New 上，然后转到 Java Project。

![另一个例子](../Images/e118dfeb50e22f9d8671017d41cd2e46.png)

您将出现另一个屏幕。输入项目的名称，然后单击下一步。点击库选项卡，然后单击添加外部罐子。

![示例三](../Images/99b401d090b5d47773c9f9b70db97b62.png)

现在导航到您的压缩 Zip，然后单击打开。

![示例五](../Images/ee17b748998a9e0f737a50102a09cde1.png)

您现在已添加库。

这是一个小的 ASCII 图表，因此您可以记住：

```
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Folder -> Class Files -> Compressed Zip -> Eclipse -> New Project -> Next -> Libraries -> Add External Jars -> Compressed Zip (Library)

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 
```

# javascript - 在下拉列表中选择一个选项以编程方式，我在网站上有一个页面，我正在从 Web 服务自动更新。我试图在页面加载之前设置下拉 <select>的值，当我选择下拉列表时，我可以看到我想要的值已经突出显示，但是我希望选择该选项而不是突出显示。这是我在 javascript 中的代码： document.getElementById('walkForAmount').selectedIndex = object.get("WalkForTime"); 页面加载时自动调用。它将 selec ID：14114293 赞同：2 时间：2013-01-01T21:13:57.497 标签：javascript, html, drop-down-menu 回答 #1 赞同：9 时间：2013-01-01T23:27:01.397 如果您使用的是 Select2，您可以通过以下方式更新您的选择 $("#walkForAmount").select2("val", "5"); // select "5" 示例：http: //jsfiddle.net/verashn/aWvQr/1/</select>

# php - 如何在 PHP 中加载表格并突出显示某些行的背景颜色？

> ID：14114294
> 
> 赞同：0
> 
> 时间：2013-01-01T21:14:03.603
> 
> 标签：php, javascript, html

我不是在寻找交替的行......相反，我有两个表 A 和 B 并且 Field1 都存在于两者中。我想展示 TableA 以及 field1 与 TableB 中的 field1 匹配的任何地方，我想突出显示该行。我怎样才能做到这一点？

我知道如何在 SQL 中做到这一点，但问题是如何在浏览器中呈现它。我想我必须使用javascript。有什么建议吗？

## 这是生成表 A 的 PHP 脚本。我想更改此输出中行的背景，其中表 B 中也存在 aif_id

```
<?php
require_once "config.php";
$dbh = new PDO($dsn, $dbuser, $dbpass);
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

$result = $dbh->query("SELECT aif_id, fee_source_id, company_name_per_sedar, document_filing_date FROM a_aif ORDER BY aif_id DESC");
$result->setFetchMode(PDO::FETCH_ASSOC);

echo "<table id=\"all_aifs\">";
echo "<tr>";
echo "<th><b>Document ID</b></th>";
echo "<th><b>Pubco Name</b></th>";
echo "<th><b>Filing Date</b></th>";
echo "<th><b>PDF</b></th>";
echo "</tr>";

foreach($result as $index => $row) {
echo "<tr>";
echo "<td>$row[fee_source_id]</td>";
echo "<td>$row[company_name_per_sedar]</td>";
echo "<td>$row[document_filing_date]</td>";
echo "<td>Placeholder</td>";
echo "</tr>";
}

echo "</table>";
echo "<br>";
$dbh = NULL;
?> 
```

## TableB 的 PHP 脚本

```
<?php
require_once "config.php";
$dbh = new PDO($dsn, $dbuser, $dbpass);
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
$result = $dbh->query("SELECT aif_id, fee_source_id, company_name_per_sedar, document_filing_date FROM a_aif_remaining LIMIT 0,50");
$result->setFetchMode(PDO::FETCH_ASSOC);
echo "<table>";
echo "<tr>";
echo "<th><b>Document ID</b></th>";
echo "<th><b>Pubco Name</b></th>";
echo "<th><b>Filing Date</b></th>";
echo "<th><b>PDF</b></th>";
echo "</tr>";
foreach($result as $index => $row) {
    echo "<tr>";
    echo "<td>$row[fee_source_id]</td>";
    echo "<td>$row[company_name_per_sedar]</td>";
    echo "<td>$row[document_filing_date]</td>";
    echo "<td>Placeholder</td>";
    echo "</tr>";
}
echo "</table>";
echo "<br>";
$dbh = NULL;
?> 
```

## 更新代码

```
<?php
require_once 'config.php';

$dbh = new PDO($dsn, $dbuser, $dbpass);

$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

$result = $dbh->query("SELECT aif_id, fee_source_id, company_name_per_sedar, document_filing_date FROM a_aif_remaining");
$result->setFetchMode(PDO::FETCH_ASSOC);

$match = $dbh->query("SELECT a_aif.aif_id FROM a_aif INNER JOIN a_aif_remaining WHERE a_aif_remaining.aif_id = a_aif.aif_id");?>

<?php if ( !empty($result) ) : ?>

<table id="all_aifs">
<tr>
<th><b>Document ID</b></th>
<th><b>Pubco Name</b></th>
<th><b>Filing Date</b></th>
<th><b>PDF</b></th>
</tr>

<?php foreach($result as $index => $row) : ?>
<tr>
<?= $row['aif_id'] == true ? ' class="match"' : '' ?>
<td><?php echo $row[fee_source_id]; ?></td>
<td><?php echo $row[company_name_per_sedar]; ?></td>
<td><?php echo $row[document_filing_date]; ?></td>
<td>Placeholder</td>
</tr>
<?php endforeach; ?>
</table>
<br>

<?php endif;
$dbh = NULL;
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:22:03.033

在 SQL 中执行检查（因为您知道如何执行此操作）。

在 PHP 中，使用检查结果向需要突出显示的 HTML 元素添加（附加）类属性（就像“交替行”一样）：

```
<?php
$query = ... // perform your SQL query
// TODO Open HTML table
// TODO Loop though results:
  $row = ... // fetch you row here
?>
<tr <?= $row['my_check'] == true ? ' class="match"' : '' ?>>
  <td><?= $row['field'] ?></td>
</tr>
<?php
// TODO close HTML table 
```

这个（不完整的）示例使用 SQL 检查（名为`my_check`）并`match`在需要时添加类。在 CSS 中，您可以使用此类`match`来应用突出显示：

```
.match {
  background-color: red;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T21:19:32.477

您应该简单地向数据匹配的行添加一个类，并在关联的 CSS 中设置背景颜色。

```
<table> <tr class="matching"> ... </tr> 
```

如何编写适当的 CSS 超出了此答案的范围。;-)

该类是由您的 Web 服务器的 PHP 代码添加，还是由客户端中的某些 JavaScript 添加，取决于您的 Web 应用程序的设计。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-01T21:20:07.153

不，您不必“必须”使用 JavaScript。您可以使用 PHP。

生成行时，检查是否满足条件并将“突出显示”类放入行定义中。

伪代码：

```
<?php
    if(Condition) echo "<tr class='highlighted'>";
    else echo "<tr>";
    echo "<td>CellStuff</td>";
    echo "</tr>";
?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-01T21:41:30.593

首先，如果您要保持代码的可维护性和清洁性，那么您应该避免打印 HTML TAGS。

不走的路：

```
echo "<table>";
echo "<tr>";
echo "<th><b>Document ID</b></th>";
echo "<th><b>Pubco Name</b></th>";
echo "<th><b>Filing Date</b></th>";
echo "<th><b>PDF</b></th>"; 
```

要走的路：

```
<?php
require_once 'config.php';

$dbh = new PDO($dsn, $dbuser, $dbpass);

$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

$result = $dbh->query("SELECT aif_id, fee_source_id, company_name_per_sedar, document_filing_date FROM a_aif_remaining LIMIT 0,50");
$result->setFetchMode(PDO::FETCH_ASSOC);

?>

<?php if ( !empty($result) ) : ?>
<table>
 <tr>
  <th><b>Document ID</b></th>
  <th><b>Pubco Name</b></th>
  <th><b>Filing Date</b></th>
  <th><b>PDF</b></th>
 </tr>

<?php foreach($result as $index => $row) : ?>
    <tr>
    <td><?php echo $row[fee_source_id]; ?></td>
    <td><?php echo $row[company_name_per_sedar]; ?></td>
    <td><?php echo $row[document_filing_date]; ?></td>
    <td>Placeholder</td>
    </tr>
<?php endforeach; ?>

</table>

<br />

<?php endif; ?> 
```

结论：

1) 代码现在看起来更易读和更干净
2) 您将 PHP 与 HTML 分离
3) 一旦出现问题，您可以轻松确定问题（例如`parse error at ..`，、`unexcepted ';' ...`

**回到你的问题**

那么如何突出显示所需的行呢？`foreach`好吧，这很简单，只需在循环中使用 if/else ，比如

```
<?php foreach($result as $k => $v): ?>

 <?php if ( $k == 'some_value_you_expect_to_be_highlighted' ) : ?>

    <tr>... should be highlighted  ...</tr>
 <?php else : ?>
    <tr>.... a regular row</tr>

 <?php endif; ?>

<?php endforeach; ?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-01T21:18:48.197

我不确定我是否能正确理解您的问题，但我认为您不需要 JS。您可以计算是否应在 PHP 中突出显示单元格/行并设置 css 类，也在 PHP 中。

# python - 为什么在 Python 中对该项目使用装饰器时，Flask 的 url_for 会引发错误？

> ID：14114296
> 
> 赞同：6
> 
> 时间：2013-01-01T21:14:50.997
> 
> 标签：python, flask, decorator, build-error

我正在创建一个 Python Flask 应用程序并在下面创建了装饰器和视图。装饰器在查看索引时效果很好，但是当您注销并使用`url_for`索引重定向时，它会引发构建错误。为什么会

```
def logged_in(fn):
    def decorator():
        if 'email' in session:
            return fn()
        else:
            return render_template('not-allowed.html', page="index")
    return decorator

@app.route('/')
@logged_in
def index():
    email = session['email']    
    return render_template('index.html', auth=True, page="index", marks=marks)

@app.route('/sign-out')
def sign_out():
    session.pop('email')
    print(url_for('index'))
    return redirect(url_for('index')) 
```

有任何想法吗？错误是：`BuildError: ('index', {}, None)`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-01T21:57:08.073

这里的问题是`decorator()`您返回的函数与它正在装饰的函数的名称不同，因此 URL 构建器无法找到您的`index`视图。您需要使用模块中的`wraps()`装饰器`functools`来复制原始函数的名称。另一个问题（您仍然必须遇到）是您不接受装饰器中的参数并将其传递给原始函数。这是修正后的装饰器：

```
from functools import wraps

def logged_in(fn):
    @wraps(fn)
    def decorator(*args, **kwargs):
        if 'email' in session:
            return fn(*args, **kwargs)
        else:
            # IMO it's nicer to abort here and handle it in errorhandler.
            abort(401)
    return decorator 
```

* * *

*更多解释*：在 Python 中，装饰器是一个函数，它接受另一个函数作为其参数并返回一个函数作为其结果。所以以下

```
@logged_in
def index(): pass 
```

本质上等同于

```
def index(): pass
index = logged_in(index) 
```

在这种情况下，问题在于您的`logged_in`装饰器返回的不是原始函数，而是一个包装器（`decorator`在您的代码中调用），它包装了原始函数。此包装器的名称 ( `decorator`) 与其包装的原始函数不同。现在`app.route()`，您在之后调用的装饰器`logged_in`看到了这个新函数并使用它的名称 ( `decorator`) 为它注册了一个路由。问题出在这里：您希望装饰函数具有相同的名称 ( `index`)，因此它可以用于`url_for()`获取它的路由。这就是为什么您需要手动复制名称

```
decorator.__name__ = fn.__name__ 
```

或更好地使用模块`update_wrapper`和`wraps`帮助`functools`器，它们可以为您做到这一点，甚至更多。

# url - 防止用户看到完整路径

> ID：14114302
> 
> 赞同：0
> 
> 时间：2013-01-01T21:15:37.070
> 
> 标签：url, hyperlink

我想知道是否有办法阻止网站上的访问者看到完整的网站 url .. 例如，用户看到的不是[http://www.5eren.dk/index.php ，而是](http://www.5eren.dk/index.php)[http:// www.5eren.dk](http://www.5eren.dk) ..这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:21:10.960

如果我理解你正确地检查了 .htaccess 重写条件和重写引擎。例如隐藏文件扩展名：

```
 RewriteEngine on
     RewriteCond %{REQUEST_FILENAME} !-d 
     RewriteCond %{REQUEST_FILENAME}\.php -f
     RewriteRule ^(.*)$ $1.php 
```

这应该让你开始。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-01T21:30:56.527

**根本没有**

但是，根据您在网站上使用的[服务器端](/questions/tagged/server-side "显示标记为“服务器端”的问题")脚本技术，可以通过中央脚本来应用此类功能，该脚本调用您网站上的某些 URL 并将其呈现为带有某些参数的请求脚本。

例如：

假设以下网址

[http://myexample.com/secrets/pages/output.php](http://myexample.com/secrets/pages/output.php)

现在我们可以使用一些路由脚本来请求它，如下所示：

[http://myexample.com/routing.php?routeID=123](http://myexample.com/routing.php?routeID=123)

在路由脚本中使用一些数据库，您可以调用或包含 secrets/pages/ouput.php

# actionscript-3 - 将按钮设置为单击后不可见

> ID：14114303
> 
> 赞同：0
> 
> 时间：2013-01-01T21:15:40.120
> 
> 标签：actionscript-3, flash

我正在尝试在 AS3 中将按钮设置为不可见，但是当我离开框架并返回到它时，按钮再次可见。这是我为通信技术课程制作的危险游戏。

这是我目前拥有的：

```
a1.addEventListener(MouseEvent.CLICK, a1mouseClick); 

function a1mouseClick(mouse:MouseEvent) {
    a1.visible = false;
    gotoAndStop("A1");
    trace("Going to A1");
} 
```

但是，当它返回到带有 a1 按钮的框架时，它再次可见。

这是我当前的动画：[https ://dl.dropbox.com/u/23938245/jeporady.fla](https://dl.dropbox.com/u/23938245/jeporady.fla)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T21:50:25.070

在时间线中移动时，Flash 播放器可以重新创建精灵、影片剪辑和文本字段，因此您的按钮再次可见。为防止重新创建，将所有控件移动到没有关键帧的单独关卡。如果需要关键帧，请尝试在所有关键帧中为此按钮设置相同的实例名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:01:49.457

您错过了 Flash 时间线和关键帧如何运作的一个基本方面。一旦您离开该框架，该框架内容的舞台实例及其属性/状态就消失了。当您返回到该帧时，将根据关键帧内容再次创建实例。

我认为考虑到您当前的方法，最好的解决方案是让主板在所有框架中都保持不变。您可以通过为它创建一个图层来做到这一点，并让它的关键帧从第 2 帧延伸到第 27 帧。但是，当您不希望它们可见时，您的下一个问题将是调整该屏幕上所有元素的可见性。

我的建议是将该屏幕的所有元素放入它自己的影片剪辑符号中，并将该影片剪辑及其侦听器的所有代码添加到您创建的这个新层中。例如，您可以将该实例命名为 - main_board，因此您可以使用属性修改它的可见`main_board.visible`性。如果您确实选择了该解决方案，则需要修改该框架上的所有代码以也使用该实例名称，即：

```
main_board.a1.visible = false; 
```

此外，您还需要修改所有 addEventListener 行：

```
main_board.a1.addEventListener(MouseEvent.CLICK, a1mouseClick); 
```

你对这个游戏的方法可以大大简化，但比我已经讨论的更远超出了这个问题的范围！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T23:55:51.840

@fsbmain 和 @prototypical 他们是对的。

> 在时间线中移动时，Flash 播放器可以重新创建精灵、影片剪辑和文本字段，因此您的按钮再次可见。为防止重新创建，将所有控件移动到没有关键帧的单独关卡。如果需要关键帧，请尝试在所有关键帧中为此按钮设置相同的实例名称。

我正在查看您的项目并提供快速修复，您需要执行以下操作：

1.  在顶部创建一个新层，以使用以下操作管理所有框架的一些可用操作：

    ```
    import flash.display.DisplayObject;

    // Manages the buttons visible state 
    var buttonsStates:Object = {
        "a1":true, "b1":true, "c1":true, "d1":true, "e1":true,
        "a2":true, "b2":true, "c2":true, "d2":true, "e2":true,
        "a3":true, "b3":true, "c3":true, "d3":true, "e3":true,
        "a4":true, "b4":true, "c4":true, "d4":true, "e4":true,
        "a5":true, "b5":true, "c5":true, "d5":true, "e5":true
    };

    // Checks the buttons visibility
    function checkVisibility () {   
        for (var buttonName:String in buttonsStates)
        {
            var child:DisplayObject = this.getChildByName(buttonName);
            child.visible = buttonsStates[buttonName];
        }
    }

    // Saves the visible satatus to false
    function setVisibilityToFalse(target:*) {
        buttonsStates[target.name] = false;
        target.visible = false;
    } 
    ```

2.  每次要检查按钮的可见性时，都必须调用该`checkVisibility()`函数。例如，每次返回按钮列表。

3.  最后，每个按钮的事件处理程序必须是这样的：

    ```
    function a1mouseClick(mouse:MouseEvent) {
        setVisibilityToFalse(mouse.currentTarget); // Saves the visible state to false
        gotoAndStop("A1");
        trace("Going to A1");
    } 
    ```

您可以在此处下载编辑后的文件[http://cl.ly/Lt6X](http://cl.ly/Lt6X)

# python - Python Tkinter 网格管理器和条目小部件

> ID：14114306
> 
> 赞同：3
> 
> 时间：2013-01-01T21:16:34.980
> 
> 标签：python, tkinter

到目前为止，这是我的代码：

```
master = Tk()
Label(master, text="Input:").grid(row=0)

e1 = Entry(master, width = 100)
e1.grid(row=0, column=1)

Button(master, text='Q', command=q_pressed).grid(row=3, column=2,
                                                sticky=W, padx = 4, pady=4)

Button(master, text='C', command =c_input).grid(row=3, column=1,
                                                sticky=W, padx = 0, pady=4)

Button(master, text='Confirm', command=parse_input).grid(row=3, column=0,
                                                sticky=W, padx = 4, pady=4) 
```

我正在尝试使“Q”按钮位于“C”按钮旁边（就像“C”如何位于“确认”按钮旁边），但它却将其放置在 Entry 小部件结束的位置。

我知道这是一个网格管理问题。如何设置布局，使 row = 0，具有文本和条目小部件，并且 row=3 具有其自己的独立列 (0,1,2) 用于按钮？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T21:45:38.857

您的问题是`Entry` `e1`很长并且包含 100 个字符，但它只跨越一列。您可以使用来定义命令中`columnspan`使用的列数。以下示例对我有用。自己决定，什么是合理的价值。`e1``grid``columnspan = 30``columnspan`

```
from Tkinter import *
master = Tk()
Label(master, text="Input:").grid(row=0)

e1 = Entry(master, width = 100)
e1.grid(row=0, column=1, columnspan=30)

Button(master, text='Q').grid(row=3, column=2)

Button(master, text='C').grid(row=3, column=1)

Button(master, text='Confirm').grid(row=3, column=0)
mainloop() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T21:59:31.570

执行您想要的布局的方法可能不止一种，我选择提供一种干净的方法。您的`Entry`小部件在第一行的第二列中占据了很大的水平空间，因此将小部件放在下一行的下方会给您带来麻烦。由于您知道它下方将有 3 个按钮，因此您可以使其`Entry`跨越两列（`columnspan=2`在对其进行网格化时）并在对下一行进行网格化时使用它。但我更喜欢一种不同的方法，这也会产生更好的整体布局。您想要的是`Frame`在需要两列的第二行中对 a 进行网格化（因为在它上面的行中您有两个小部件）。然后你在这个新的`Frame`.

这会将您的代码变成：

```
import Tkinter

master = Tkinter.Tk()

Tkinter.Label(master, text="Input:").grid(row=0, column=0)
Tkinter.Entry(master, width = 100).grid(row=0, column=1)

frame = Tkinter.Frame()
frame.grid(row=1, column=0, columnspan=2, sticky='w')
Tkinter.Button(frame, text='Confirm').grid(row=0, column=0, sticky='w')
Tkinter.Button(frame, text='C').grid(row=0, column=1, sticky='w')
Tkinter.Button(frame, text='Q').grid(row=0, column=2, sticky='w')

master.mainloop() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-07T14:46:19.643

在此处输入代码{ master = Tk() Label(master, text="Input:" ).grid(row=0)

```
e1 = Entry(master, width=100)
e1.grid(row=0, column=1, columnspan=10)

Button(master, text='Q', width=5, command=q_pressed).grid(row=3, column=1, padx=0, ipadx=5, pady=4, sticky=E)

Button(master, text='C', width=5, command =c_input).grid(row=3, column=1, padx=0, ipadx=5, pady=4, sticky=W)

Button(master, text='Confirm', width=10, command=parse_input).grid(row=3, column=0, padx=0, pady=4, sticky=W)

mainloop()} 
```

由于您需要 100 个字符作为输入字符串，因此我将单元格/列宽基于 10 以进行简单的数学除法。将我的列跨度设置为 10。我摆脱了 padx，因为它与边框宽度有关，并使用了与内部文本宽度有关的 ipadx。将条目设置为 10 列宽，每列 10 个字符。使用“输入”文本作为 1 列。这将允许我使用 10 个字符或一列作为文本“确认”，并且我可以通过使用 width=5 将按钮“c”和“q”设为 5 个字符宽，将第 1 列分成两半。然后使用 justfy 将 "c" West 和 "q" East。

有很多方法，这在我看来是最简单的。

# xmpp - 谷歌聊天或 gtalk 支持带内字节流吗？

> ID：14114308
> 
> 赞同：0
> 
> 时间：2013-01-01T21:16:50.550
> 
> 标签：xmpp, gloox

我使用 gloox 测试使用 inbandbytestream 传输文件；似乎不起作用。

有没有人有这方面的经验？或者推荐一个支持 IBB 的公共 XMPP？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:36:31.800

IBB 不需要任何服务器端支持。所以我看不出为什么 IBB 不应该在 GTalk 服务器上工作。

# iphone - 如何通过 Objective-c 访问 iPhone 文件？

> ID：14114309
> 
> 赞同：7
> 
> 时间：2013-01-01T21:16:53.877
> 
> 标签：iphone, objective-c

我注意到有一些软件（例如 iExplorer）允许您从 Mac 访问 iPhone 设备上的文件。

现在我的问题是：**如何通过 Objective-c 访问 iPhone 文件？**

这仅用于教育目的。

我发现了这个：[https](https://github.com/Chronic-Dev/libirecovery) ://github.com/Chronic-Dev/libirecovery但我不确定我是否走在正确的轨道上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-01T22:16:45.197

因此，您似乎正在寻找一种 API，它可以从计算机访问 iPhone 的文件系统。嗯，这个 API 存在，它被称为[MobileDevice 框架](http://theiphonewiki.com/wiki/MobileDevice_Library)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:38:31.960

不幸的是，没有简单或合法的方法可以访问 iPhone 上的文件，尤其是通过 Objective-C。
iOS 上安装的应用程序是沙盒的，这意味着它们只能访问自己目录树中的文件；他们无权访问/了解其他文件。
正如您所说，您可以使用 iExplorer 等软件访问文件，但不能通过 iPhone 本身以编程方式访问文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T23:00:13.427

这是一个浏览iphone的旧项目。您可能可以从中获得一些关于构建应用程序以使用最新信息执行相同操作的指示。

[http://code.google.com/p/iphonelist/](http://code.google.com/p/iphonelist/)

再加上碳酸关于移动设备框架的帖子，您应该能够做一些好事。

如果我找到更多独特的信息，请在此处发布。

# python - 可扩展散列 - 最高有效位

> ID：14114311
> 
> 赞同：3
> 
> 时间：2013-01-01T21:16:56.620
> 
> 标签：python, algorithm, hash

我想写可扩展的散列。在[wiki](http://en.wikipedia.org/wiki/Extendible_hashing)上，我在 python 中找到了很好的实现。但是这段代码使用了最低有效位，所以当我有value is和 for `1101`value is的哈希值时。我想使用最高有效位。例如： hash , value is , value is 。有什么简单的方法可以做到这一点吗？我试过了，但我做不到。`d = 1``1``d = 2``01``1101``d = 1``1``d = 2``11`

> 你明白为什么它使用最低有效位吗？

或多或少。当我们使用数组时，它会变得高效。好的，所以对于哈希函数，我想使用 4 字节整数中的四个最小位，但从左到右。

```
h = hash(k) 
h = h & 0xf #use mask to get four least bits
p = self.pp[ h >> ( 4 - GD)] 
```

它不起作用，我不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T18:38:37.403

使用最低有效位计算散列是计算散列的最快方法，因为它只需要 AND 位运算。这使它非常受欢迎。

这是使用最高有效位的哈希的实现（在 C 中）。由于没有直接的方法可以知道最高有效位，因此它反复测试剩余值是否只有指定数量的位。

```
int significantHash(int value, int bits) {
    int mask = (1 << bits) - 1;
    while (value > mask) {
        value >>= 1;
    }
    return value;
} 
```

我推荐使用数字的所有位的重叠哈希。从本质上讲，它减少了相同位数的部分数量并对它们进行异或。它比最不重要的散列运行得慢，但比重要的散列快。最重要的是，它提供了比其他两种方法更好的分散性，当必须散列的数字具有某种与位相关的模式时，它成为更好的候选者。

```
int overlappingHash(int value, int bits) {
    int mask = (1 << bits) - 1;
    int answer = 0;
    do {
        answer ^= (value & mask);
        value >>= bits;
    } while (value > 0);
    return answer;
} 
```

# python-3.x - 为什么 PyCharm 不能导入 Gtk？

> ID：14114318
> 
> 赞同：6
> 
> 时间：2013-01-01T21:18:15.530
> 
> 标签：python-3.x, gtk, pygtk, pycharm

当我使用`python2.7`一切都很好。当我将解释器更改为`python3.2`PyCharm 时无法导入 Gtk。它打印“未解决的参考”。我正在尝试使用代码导入 gtk

```
from gi.repository import Gtk 
```

# c++ - 如何识别人类发出的 GET/POST 请求，而忽略以下任何请求

> ID：14114319
> 
> 赞同：3
> 
> 时间：2013-01-01T21:18:18.553
> 
> 标签：c++, http

我正在编写一个应用程序来监听 HTTP 流量并尝试识别哪些请求是由人发起的。

例如：用户在其地址栏中键入*cnn.com*，这会启动一个请求。然后我想 在丢弃任何其他请求（例如XHR等）的同时找到*CNN的服务器响应*

你怎么能从标题信息中看出什么是什么？

在做了一些研究之后，我发现相关的回应是：

1.  内容类型：文本/html
2.  Html 带有一个有意义的标题
3.  状态 200 正常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:40:57.783

没有办法从电线上的位来判断。HTTP 协议具有定义的格式，所有（未损坏的）用户代理都遵守该格式。

您可能认为可以从协议有效负载中检测到用户在网络上将“cnn.com”输入到“http://www.cnn.com/”的翻译。答案是否定的，它不能。

要检测允许用户使用这种速记的用户代理，您必须窥探用户代理应用程序（例如浏览器）本身。

实际上，检测非人类代理是一个有趣的问题（垃圾邮件检测是一个明显的动机）。这是因为 HTTP 属于 NVT 协议家族，不管你信不信，其基本思想是人类应该能够在网络终端/控制台程序（例如 telnet 客户端）中“手动”运行协议.) 换句话说，该协议基本上被设计为好像人类正在使用它一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:41:01.690

我无法提供任何代码来提供帮助，但我会说看看`Referer`HTTP 标头。初始`GET`请求不应该有`Referer`，但是当您开始加载页面上的资源（例如 JavaScript、CSS 等）时，`Referer`将设置为请求这些资源的 URL。

因此，当我在浏览器中输入“stackoverflow.com”并回车时，浏览器将发送一个`GET`带有 no 的请求`Referer`，如下所示：

```
GET / HTTP/1.1
Host: stackoverflow.com
# ... other Headers 
```

但是，当浏览器在页面上加载支持的静态资源时，每个请求都会有一个`Referer`标头，如下所示：

```
GET /style.css HTTP/1.1
Host: stackoverflow.com
Referer: http://www.stackoverflow.com
# ... other Headers 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T21:39:07.283

我认为标头信息不足以从机器人中识别出真实用户，因为机器人是用来模仿真实用户的，而标头很容易模仿。

您可以做的一件事是跟踪用户所遵循的路径（点击序列），这很可能与机器人制作的路径不同，并对发布的信息进行一些分析（即贝叶斯过滤器）。

一个非常容易实施的检查是基于 IP 源。有黑名单 IP 地址的数据库，请参阅[Project Honeypot](https://www.projecthoneypot.org/) - 如果您正在用 Java 编写软件，这里有一个如何检查 IP 地址的示例：[如何查询 HTTP:BL 的垃圾邮件 IP 地址](http://en.newinstance.it/2012/04/18/how-to-query-httpbl-for-spamming-ip-addresses/)。

我在我的博客上做的是这个（使用 wordpress 插件）：

1.  检查 IP 地址是否在 HTTP:BL 中，如果是，则向用户显示 html 页面以采取措施将其 IP 地址列入白名单。这是通过[Bad Behavior](http://wordpress.org/extend/plugins/bad-behavior/)插件在 Wordpress 中完成的。
2.  当用户提交一些内容时，贝叶斯过滤器会验证他提交的内容，如果他的评论被识别为垃圾邮件，则会在完成提交之前显示验证码。这是通过[akismet](http://akismet.com/)和[条件](http://wordpress.org/extend/plugins/wp-conditional-captcha/)验证码完成的，并且评论也排队等待手动批准。
3.  被批准一次后，同一用户被认为是安全的，并且可以不受限制/检查地发布。

应用上述规则，我的博客上不再有垃圾邮件。我认为类似的逻辑可以用于任何网站。

这种方法的优势在于，大多数用户甚至都不会注意到任何安全机制，因为 99% 的时间都不会显示验证码，也不会发生任何异常情况。但仍然有相当严格和有效的检查在幕后进行。

# api - 创建半复杂 Web 小部件库时要考虑哪些关键点？

> ID：14114321
> 
> 赞同：0
> 
> 时间：2013-01-01T21:18:22.817
> 
> 标签：api, widget, components

去年，我向不同的客户交付了几个相对简单的单页应用程序，基本上几乎相似的抵押贷款和融资计算器。这些要么是页面的唯一焦点，要么是一些主要内容旁边的侧边栏应用程序。由于这些应用程序除了样式、布局和一些客户特定参数之外几乎没有什么不同，如果这些 SPA 可以合并到某种库中，这将意味着高投资回报率。

在实践中如何去做还不清楚。创建预制交互式组件库时需要考虑和/或避免的关键点是什么？

他们需要

*   为每个客户定制样式（自定义宽度、高度、字体等）
*   不与其他页面元素冲突
*   ... ?

在服务器端预渲染 html 和内联 css 似乎不明智（不灵活），也许某种半生不熟的 JSON 表示会更合适，其中实际的程序集将由一些 javascript 控制，并且样式会完成基于我们提供的一些默认样式表在客户端上。或者也许以某种方式使用 GWT（我们是一家 Java 商店）来创建小部件。

我在这里超出了我的深度，所以非常欢迎输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:20:32.077

在这种情况下，考虑这一点的更好方法可能不是创建一个库，而是创建一个“计算器”应用程序（小部件），该应用程序可以配置为不同类型的计算并具有主题性

因此，您的重点是如何创建它，以便您可以针对不同的功能对其进行配置。

# c - C：同步两个文件指针指向同一个文件

> ID：14114322
> 
> 赞同：0
> 
> 时间：2013-01-01T21:18:43.377
> 
> 标签：c, file-io, stdio, fflush

我需要两个文件指针 ( `FILE *`) 一起操作。一种是应用追加操作，另一种是用于读取和覆盖。

我需要从一个指针附加到文件以被另一个文件指针识别，以便另一个文件指针可以正确读取和覆盖这个附加数据。

为了同步数据，似乎`fflush()`在附加文件指针上使用是有效的（至少对于读取它是有效的），但这是实现我想要的正确方法并且它是可移植的吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:22:50.290

您应该能够用一个指针来做到这一点（因此不必进行不必要的同步）。`fseek(f, SEEK_END, 0);`当你想在最后添加时使用。使用“rb+”使文件可读可写。

只要您不使用多个线程来访问文件，这应该可以正常工作。

# java - 如何加快 Android XML 解析速度？

> ID：14114328
> 
> 赞同：5
> 
> 时间：2013-01-01T21:19:37.150
> 
> 标签：java, android, xml, xml-parsing

下午好（取决于你住在哪里）！

我对 Android 开发相当陌生，目前正在努力将功能从现有的 iOS 应用程序转移到 Android 上。此功能的一部分是解析包含大约 500 个条目的“大”（约 13,000 行）RSS XML 文件。我花了 10 到 15 个小时研究 Android 上的 XML 解析并尝试了主要的 XML 解析器：DOM、SAX 和 Pull-parsing。这是我的结果，在我的盒子上的模拟器中运行（32 位 Windows Vista，2.2 GHz 双 CPU，3 GB RAM）：

萨克斯：~6:00 分钟

拉解析：~4:00 分钟

DOM：超过 4:00 分钟，但在我编写实现编码时没有计时。

我也从 github 尝试了这个 RSS 阅读器，但花了 >10:00 分钟：

[https://github.com/matshofman/Android-RSS-Reader-Library](https://github.com/matshofman/Android-RSS-Reader-Library)

SAX、PP 和 DOM 的实现都取自 stackoverflow.com 线程，所以我相当有信心我没有在它们中做任何非标准的事情（不过，我不排除这种可能性）。我决定吸引更多、更有经验的人群来了解我还能尝试什么。

我无法控制文件的格式。如果我要实现这个端到端，我只需编写一个 Web 服务，它会在服务器上完成所有繁重的工作，然后发送一个小的、紧凑的 JSON 序列化列表。相反，我有 13K 行文件。:)

对我能做什么有任何见解吗？这似乎是一个相当普遍的问题，但大多数回复只是说尝试使用不同的主要 XML 解析器之一。就我而言，我已经尝试了所有三个，即使是最快的也似乎太慢了。

我究竟做错了什么？在Android上通过网络进行XML解析时，人们通常会遇到任何正常的“新手”问题吗？？？

提前感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:30:20.863

使用[vtd-xml](http://vtd-xml.sourceforge.net/)。

[这里有一些基准。](http://vtd-xml.sourceforge.net/benchmark1.html)

此外，模拟器非常慢，所以在真实设备上尝试一下，您可能会看到很大的改进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-09T15:48:48.107

我同意**Jave 的** 回答。最好的选择是[VDT-XML 库](http://vtd-xml.sourceforge.net/) 这个例子演示了如何使用这个库。

XML 文件：

```
 <database name="products">
        <table name="category">
            <column name="catId">20</column>
            <column name="catName">Fruit</column>
        </table>
        <table name="category">
            <column name="catId">31</column>
            <column name="catName">Vegetables</column>
        </table>
        <table name="category">
            <column name="catId">45</column>
            <column name="catName">Rice</column>
        </table>
        <table name="category">
            <column name="catId">50</column>
            <column name="catName">Potatoes</column>
        </table>
</database> 
```

源代码示例：

```
import com.ximpleware.AutoPilot;
import com.ximpleware.VTDGen;
import com.ximpleware.VTDNav;

String fileName = "products.xml";

VTDGen vg = new VTDGen();

if (vg.parseFile(fileName, true)) {

     VTDNav vn = vg.getNav();
     AutoPilot table = new AutoPilot(vn);
     table.selectXPath("database/table");

     while (table.iterate()) {
        String tableName = vn.toString(vn.getAttrVal("name"));

        if (tableName.equals("category")) {
            AutoPilot column = new AutoPilot(vn);
            column.selectElement("column");

            while (column.iterate()) {
                 String text = vn.toNormalizedString(vn.getText());
                 String name = vn.toString(vn.getAttrVal("name"));

                 if (name.equals("catId")) {
                    Log.d("Category ID = " + text);
                 } else if (name.equals("catName")) {
                    Log.d("Category Name = " + text);
                 } 

            }
        }
     }
} 
```

它对我有用，希望对你有帮助。

# qt - 是否可以将自定义 gtkwidget 放入 gtktreeview 中？

> ID：14114332
> 
> 赞同：0
> 
> 时间：2013-01-01T21:20:21.500
> 
> 标签：qt, gtk

我现在正在学习 GTK+（在 Qt 之后），只是想知道它有什么可能，因此 Qt 是用于 digia 的。在 QListWidget 中放置一个自定义小部件是可能的，所以我想知道是否可以使用 GTK+ 做类似的事情。这个小部件的一个例子可以是一个像素图、一个标签和一个按钮，它们都在同一个单元格中，并使用像 Gtktable 这样的容器进行布局。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:25:35.520

是的当然。您只需要一个“自定义单元格渲染器”：

*   [http://scentric.net/tutorial/ch-treeview.html](http://scentric.net/tutorial/ch-treeview.html)

*   [http://gtk.php.net/manual/en/html/tutorials/tutorials.treeview.view.html](http://gtk.php.net/manual/en/html/tutorials/tutorials.treeview.view.html)

# c#-4.0 - Guid.ToString( ) 是否也是唯一的

> ID：14114335
> 
> 赞同：-3
> 
> 时间：2013-01-01T21:20:36.963
> 
> 标签：c#-4.0, guid

在 C# 中，我们知道`Guid`数据对于给定的机器是唯一的。对于给定的机器也将`Guid.toString( )`是唯一的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:22:31.907

Well`Guid.ToString()`代表 a 中的所有数据`Guid`- 所以如果有两个不相等的`Guid`值，调用`ToString()`它们中的每一个也会给出两个不相等的字符串。那是你想知道的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T21:22:38.473

实际上，GUID在时间和空间上*应该*是唯一的……而不仅仅是给定的机器。

是的，GUID 的文本表示与 GUID 本身一样独特 :)

如果 GUID 是唯一的，则 myGuid.ToString() 也是唯一的。当然 ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T21:23:03.520

`Guid.NewGuid()`每台机器都是独一无二的，是的。`Guid.NewGuid().ToString()`仍然是唯一的，只是 `string`生成的 GUID 的类型化版本。

# sql - 如何通过参数插入新值自动编号以访问

> ID：14114342
> 
> 赞同：0
> 
> 时间：2013-01-01T21:21:42.520
> 
> 标签：sql, ms-access, autonumber

当我按下插入时，我收到错误：`Syntax error in INSERT INTO statement`

*   `EmployeeID`（自动编号）
*   `EmployeeName`（文本）
*   `Position`（文本）
*   `Address`（文本）

    ```
    OleDbDataAdapter ad;
    DataSet ds;
    DataTable dt;

    protected void SetInsertParameters()
    {
        string sql = "INSERT INTO Employee(EmployeeName,Position,Address)"+
                     " VALUES (@EmployeeName,@Position,@Address)";
        ad.InsertCommand = new OleDbCommand(sql, con);

        OleDbParameter param = new OleDbParameter("@EmployeeName", OleDbType.VarChar);
        param.SourceColumn = "EmployeeName";
        param.SourceVersion = DataRowVersion.Current;
        ad.InsertCommand.Parameters.Add(param);

        param = new OleDbParameter("@Position", OleDbType.VarChar);
        param.SourceColumn = "Position";
        param.SourceVersion = DataRowVersion.Current;
        ad.InsertCommand.Parameters.Add(param);

        param = new OleDbParameter("@Address", OleDbType.VarChar);
        param.SourceColumn = "Address";
        param.SourceVersion = DataRowVersion.Current;
        ad.InsertCommand.Parameters.Add(param);
    }

    void InsertNewValues()
    {
        dt = ds.Tables["Employee"];
        DataRow row = dt.NewRow();
        row[0] = txt_employeeID.Text;
        row[1] = txt_name.Text;
        row[2] = txt_position.Text;
        row[3] = txt_address.Text;
        dt.Rows.Add(row);
        ad.Update(ds, "Employee");
        ad.Fill(ds);

    } 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:58:01.877

Position 是[保留字](http://support.microsoft.com/kb/321266?wa=wsignin1.0)，必须用括号括起来：

```
 "INSERT INTO Employee(EmployeeName,[Position],Address)" 
```

# android - android系统调用挂钩

> ID：14114343
> 
> 赞同：2
> 
> 时间：2013-01-01T21:21:57.840
> 
> 标签：android, c, linux

我正在使用 android 内核 2.6.29。我正在尝试在 android-kernel 上挂钩开放系统调用。我按照链接[http://syprog.blogspot.com.au/2011/10/hijack-linux-system-calls-part-iii.html](http://syprog.blogspot.com.au/2011/10/hijack-linux-system-calls-part-iii.html)挂钩 ubuntu 12.04LTS 并且成功但是当我交叉编译我的模块时对于android然后我得到以下错误

* * *

错误：隐式查找地址函数

谁能帮忙？为什么我收到此错误？有没有 lookup_address 的替代品？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:37:32.617

根据 ARM 架构的适当标准的[Linux Cross-reference](http://lxr.free-electrons.com/ident?v=2.6.32&a=arm&i=lookup_address)判断，指的是第一个引用的内核版本 2.6.32（不幸*的是没有 2.6.29 ）*

尽管设置了标准，但交叉引用将产生主要指 x86 架构的命中。去引用：

```
lookup_address

Defined as a function in:
arch/x86/mm/pageattr.c, line 295
arch/sh/kernel/io_trapped.c, line 162
Defined as a function prototype in:
arch/x86/include/asm/pgtable_types.h, line 330
Referenced (in 11 files total) in:
arch/x86/include/asm/pgtable_types.h, line 330
arch/x86/mm/kmemcheck/pte.c, line 12
arch/x86/mm/kmemcheck/kmemcheck.c:
line 269
line 295
arch/x86/mm/pageattr-test.c:
line 60
line 150
line 183
line 203
line 215
arch/x86/mm/mmio-mod.c, line 96
arch/x86/mm/fault.c, line 577
arch/x86/mm/kmmio.c, line 136
arch/x86/mm/pageattr.c:
line 200
line 238
line 295
line 326
line 371
line 487
line 606
line 1288
arch/x86/xen/mmu.c:
line 335
line 347
line 362
arch/x86/xen/enlighten.c:
line 281
line 364
arch/sh/kernel/io_trapped.c:
line 162
line 228
line 251 
```

查看在`x86/mm/pageattr.c` [此处](http://lxr.free-electrons.com/source/arch/x86/mm/pageattr.c?v=2.6.32;a=arm#L295)找到的实际源函数，只是为了显示该函数的外观：

```
295 pte_t *lookup_address(unsigned long address, unsigned int *level)
296 {
297         pgd_t *pgd = pgd_offset_k(address);
298         pud_t *pud;
299         pmd_t *pmd;
300 
301         *level = PG_LEVEL_NONE;
302 
303         if (pgd_none(*pgd))
304                 return NULL;
305 
306         pud = pud_offset(pgd, address);
307         if (pud_none(*pud))
308                 return NULL;
309 
310         *level = PG_LEVEL_1G;
311         if (pud_large(*pud) || !pud_present(*pud))
312                 return (pte_t *)pud;
313 
314         pmd = pmd_offset(pud, address);
315         if (pmd_none(*pmd))
316                 return NULL;
317 
318         *level = PG_LEVEL_2M;
319         if (pmd_large(*pmd) || !pmd_present(*pmd))
320                 return (pte_t *)pmd;
321 
322         *level = PG_LEVEL_4K;
323 
324         return pte_offset_kernel(pmd, address);
325 }
326 EXPORT_SYMBOL_GPL(lookup_address); 
```

# ember.js - EmberJs：1 个模型，多个视图控制器

> ID：14114354
> 
> 赞同：1
> 
> 时间：2013-01-01T21:23:07.243
> 
> 标签：ember.js

我对 Ember 很陌生，我很想为我的应用程序找到更好的方法：

应用：屏幕水平分成两部分：

*   左侧是填写个人属性（姓名、姓氏、电子邮件）的表格
*   右侧部分是左侧表格的图形视图

我不知道最好的解决方案：

**解决方案1：**

*   模型的人对象（实例现在是一个人对象全局变量）
*   PersonFormController 管理表单并进行属性验证
*   PersonFormView 显示表单
*   PersonRenderedController：管理表单的渲染
*   PersonRenderedView（仅显示视图，无用户交互）
*   2 个控制器的 content 属性引用了 person 全局变量
*   使用“连接插座”连接控制器/视图 router.get('applicationController').connectOutlet('left', 'personForm'); router.get('applicationController').connectOutlet('right', 'personRendered');

我不确定这个解决方案，因为 PersonRenderedController 不是很有用，仅用于“插座连接”。

**解决方案2：**

*   模型的人对象（实例现在是一个人对象全局变量）
*   PersonFormController 管理表单并进行属性验证
*   PersonFormView 显示表单
*   PersonRenderedView（仅显示视图，无用户交互）
*   NO personRenderedController（不需要，因为这个视图只有显示模式）
*   没有插座，但在通用模板中手动创建 2 个视图（表单和渲染）

我认为解决方案 1 可能更灵活（以防渲染视图需要控制器）

你能建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:41:00.627

解决方案 1 对我来说似乎更好。与插座一起去总是一个好主意。在这种情况下，您不必创建 PersonRenderedController。您可以以适合您需求的方式使用 connectOutket。以下段落来自源代码，并显示了如何将此方法与选项哈希一起使用：

> */ connectOutlet: function(name, context) { // 规范化参数。支持的参数： // // name // name, context // outletName, name // outletName, name, context // options // // 选项哈希有以下键： // // name: 的名称控制器和视图 // 使用。如果通过，则名称 // 确定视图和控制器。// outletName：要填写的出口的名称。 default：'view' // viewClass：要实例化的视图的类 // controller：要传递给视图的控制器实例 // context：an应该成为 // 控制器的对象，`content`从而成为 // 模板的上下文。

这样您就可以将您的 1 个控制器用于该人，也可以用于您的其他视图：

```
router.get('applicationController').connectOutlet({
   outletname: "right",
   viewClass : App.PersonRenderedView,
   controller: router.get("personFormController")
 }) 
```

所以我建议使用更明确的 connectOutlet 版本，与基于名称匹配的默认方法相比，它为您提供更多控制。

# java - 在 Java 中读取 CSV 文件并将值存储在 int 数组中

> ID：14114358
> 
> 赞同：0
> 
> 时间：2013-01-01T21:24:06.677
> 
> 标签：java, csv

我有一个这种格式的字符串 CSV 文件：

```
14/10/2011  422     391.6592    394.52324   0.039215686
13/10/2011  408.43  391.7612    395.0686031 0.039215686
12/10/2011  402.19  391.834     395.3478736 0.039215686 
```

我要做的就是读取 csv 文件，然后将第 3 和第 4 列数据存储在整数数组中。

这是我写的代码：

```
 BufferedReader CSVFile = 
            new BufferedReader(new FileReader("appleData.csv"));

    String dataRow = CSVFile.readLine(); 
    int count = 0;

    while (dataRow != null){
        String[] dataArray = dataRow.split(",");

        EMA[count] = dataArray[2];
        SMA[count] = dataArray[3];

        dataRow = CSVFile.readLine(); // Read next line of data.
    }
    // Close the file once all data has been read.
    CSVFile.close(); 
```

我想以两个数组结束，EMA 包含来自第 3 列的所有值，而 SMA 包含来自第 4 列的值。

我得到一个空指针异常。有人可以告诉我我犯了什么错误吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T21:24:56.893

您的文件似乎使用空格/制表符作为分隔符，但您以逗号分隔。这对我来说毫无意义。

您假设数据行有一定的长度而不检查它。这对我来说毫无意义。

此代码将向您展示如何做得更好：

```
package cruft;

import org.apache.commons.lang3.StringUtils;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.io.Reader;
import java.util.LinkedHashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;

/**
 * CsvParser
 * @author Michael
 * @link http://stackoverflow.com/questions/14114358/reading-csv-file-in-java-and-storing-the-values-in-an-int-array/14114365#14114365
 * @since 1/1/13 4:26 PM
 */
public class CsvParser {
    public static void main(String[] args) {
        try {
            FileReader fr = new FileReader((args.length > 0) ? args[0] : "resources/test.csv");
            Map<String, List<String>> values = parseCsv(fr, "\\s+", true);
            System.out.println(values);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public static Map<String, List<String>> parseCsv(Reader reader, String separator, boolean hasHeader) throws IOException {
        Map<String, List<String>> values = new LinkedHashMap<String, List<String>>();
        List<String> columnNames = new LinkedList<String>();
        BufferedReader br = null;
        br = new BufferedReader(reader);
        String line;
        int numLines = 0;
        while ((line = br.readLine()) != null) {
            if (StringUtils.isNotBlank(line)) {
                if (!line.startsWith("#")) {
                    String[] tokens = line.split(separator);
                    if (tokens != null) {
                        for (int i = 0; i < tokens.length; ++i) {
                            if (numLines == 0) {
                                columnNames.add(hasHeader ? tokens[i] : ("row_"+i));
                            } else {
                                List<String> column = values.get(columnNames.get(i));
                                if (column == null) {
                                    column = new LinkedList<String>();
                                }
                                column.add(tokens[i]);
                                values.put(columnNames.get(i), column);
                            }
                        }
                    }
                    ++numLines;
                }
            }
        }
        return values;
    }
} 
```

这是我用来测试它的输入文件：

```
# This shows that comments, headers and blank lines work fine, too.
date        value1  value2      value3      value4
14/10/2011  422     391.6592    394.52324   0.039215686

13/10/2011  408.43  391.7612    395.0686031 0.039215686

12/10/2011  402.19  391.834     395.3478736 0.039215686 
```

这是我得到的输出：

```
{date=[14/10/2011, 13/10/2011, 12/10/2011], value1=[422, 408.43, 402.19], value2=[391.6592, 391.7612, 391.834], value3=[394.52324, 395.0686031, 395.3478736], value4=[0.039215686, 0.039215686, 0.039215686]}

Process finished with exit code 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:30:26.053

[1] while循环里面应该有count++

[2] 您尚未定义/初始化数组 EMA 和 SMA - 导致异常。

[3] 如果您使用逗号 split() 并有一个空格分隔的文件，则结果将是一个长度为单位的数组，并且索引 2 和 3 会生成 NullPointerException - 即使您正确初始化了数组。

我建议通过将它们添加到循环中的列表（如 ArrayList 或 Vector）来读取数字，因为您事先不知道大小。退出循环后，创建 2 个适当大小的数组并 copyInto() 数组中的数据。让垃圾收集器处理向量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T21:44:19.563

您的代码的问题是 int[] EMA 不是初始化。它只是定义 EMA 是一个整数数组，而没有有效地创建它（您只有参考）。

我的建议是将 EMA 和 SMA 更改为[ArrayLists](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)，而不是使用属性，您可以将当前元素添加到列表中。

在循环结束时，您可以使用 size() 方法获取每个 ArrayList 中的元素数量，并可以使用 toArray 方法将它们更改为数组，从而实现您可能拥有的任何目标。

当然，我假设您忘记了示例中的逗号。否则，您应该将分隔符更改为空格。

# wpf - ObservableCollection + ICollectionView = ObservableCollectionView？

> ID：14114359
> 
> 赞同：1
> 
> 时间：2013-01-01T21:24:21.770
> 
> 标签：wpf, data-binding, observablecollection, listcollectionview

我有一个公开 ObservableCollection 的视图模型。现在我想添加分组，因此想使用 View 类，例如 ListCollectionView。但这不是泛型类型。此外，如果我从 ObservableCollection 构造 ListCollectionView，那么当 ObservableCollection 存在时它不会更新。

有人在某处实现了 ObservableCollection 支持的视图集合吗？

如果没有，是否有可能通过使用 XAML 以某种方式实现这种活力？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T21:46:23.647

您不需要特定的实现；a`CollectionView`只是一个集合的视图。`CollectionView`您可以使用以下命令获取集合的默认值`CollectionViewSource.GetDefaultView`：

```
ObservableCollection<Something> collection = ...
ICollectionView view = CollectionViewSource.GetDefaultView(collection); 
```

# haskell - Yesod，如何在 Javascript / Julius 中从 JSON 数据生成类型安全的链接

> ID：14114362
> 
> 赞同：9
> 
> 时间：2013-01-01T21:24:45.267
> 
> 标签：haskell, yesod

我有路线

```
/notes/#NoteId    NoteR    GET 
```

从另一个页面，我想链接到它。使用“经典”小村庄时，很容易：

```
<a href=@{NoteR $ entityKey note}>notetitle 
```

我希望我的页面更加动态并获取包含注释信息和注释 ID 的 JSON 数据。如何生成正确*和*类型安全的链接？

我已经将此代码保存在一个`.julius`文件中，但它无法编译，因为它需要一个“NoteId”。我应该`obj.id`在 URL 插值 @{..} 的某处插入...任何线索如何做到这一点？

```
function loadnotes() {
var list = $("#results");
jQuery.getJSON("@{NotesR}",
    function(o){
        $.each(o, function (i, obj) {
            $('<a href=@{NoteR}/>' + obj.title + '</a>').appendTo(list);
        })});
}
window.onload = loadnotes; 
```

* * *

编辑：

我有这个`Model.hs`：

```
instance ToJSON (Entity Note) where
    toJSON (Entity nid (Note title content created_at updated_at userId)) = object
        [ "id" .= nid
        , "title" .= title
        , "content" .= (unTextarea content)
        , "created_at" .= created_at
        , "updated_at" .= updated_at
        , "userId" .= userId ] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-02T04:55:12.807

我建议让`NotesR`路由返回完全呈现的 URL，而不仅仅是注释 ID。

**编辑**：我添加了一个食谱条目来演示这种方法：[https ://github.com/yesodweb/yesod/wiki/Using-type-safe-urls-from-inside-javascript](https://github.com/yesodweb/yesod/wiki/Using-type-safe-urls-from-inside-javascript)

# webbrowser-control - 没有值属性的webbrowser控件中的C#自动填充输入框

> ID：14114363
> 
> 赞同：0
> 
> 时间：2013-01-01T21:24:53.100
> 
> 标签：webbrowser-control, autofill, inputbox

```
<input id="inputID" class="textfield" name="myData" maxLength="5" type="text"       autocomplete="off"> 
```

我正在寻找一种以编程方式填充输入框的方法，但是没有 value 属性...我尝试了 element.SetAttribute("value", "blahblah"); 有任何想法吗？它涉及 C# Windows Forms Webbrowser。编辑：感谢唯一回复我帖子的人。我为我找到了一个更好的答案，即设置 InnerText 然后以编程方式单击该元素，这样它的行为就像我输入了一些东西一样。尽管我是否可以使用 SetAttribute，但我仍在徘徊。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:58:48.327

如果您在输入标签中包含 'runat="server"' 属性，那么您应该能够从代码隐藏中访问它。例如：

```
<input id="inputID" class="textfield" name="myData" maxLength="5" type="text" autocomplete="off" runat="server"/> 
```

可以这样访问：

```
inputID.Value = "New Text"; 
```

另一篇 StackOverflow 文章解释了这一点：[Accessing HTML Elements in ASP.Net](https://stackoverflow.com/questions/398021/accessing-html-elements-in-asp-net)。

# python - Python 中的持久终端会话

> ID：14114371
> 
> 赞同：4
> 
> 时间：2013-01-01T21:26:22.823
> 
> 标签：python, linux

我可能根本没有正确理解这一点，但我试图让 Python 程序与运行命令的子进程交互，就像在 Linux shell 上一样。

例如，我希望能够在程序中运行“cd /”然后“pwd”并获取“/”。

我目前正在尝试使用 subprocess.Popen 和communicate() 方法来发送和接收数据。与 Popen 构造函数一起发送的第一个命令运行良好并给出了正确的输出。但我无法通过通信（输入 =“pwd”）发送另一个命令。

到目前为止我的代码：

```
from subprocess i
term=Popen("pwd", stdout=PIPE, stdin=PIPE)
print(flush(term.communicate()))
term.communicate(input="cd /")
print(flush(term.communicate(input="pwd"))) 
```

有一个更好的方法吗？谢谢。

另外，我正在运行 Python 3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T21:59:41.667

首先，您需要了解运行 shell 命令和运行程序不是一回事。

让我给你举个例子：

```
>>> import subprocess
>>> subprocess.call(['/bin/echo', '$HOME'])
$HOME
0
>>> subprocess.call(['/bin/echo $HOME'], shell=True)
/home/kkinder
0 
```

请注意，如果没有 shell=True 参数，`$HOME`则不会扩展 的文本。那是因为`/bin/echo`程序不解析`$HOME`，Bash 可以。第二次通话中真正发生的事情与此类似：

```
>>> subprocess.call(['/bin/bash', '-c', '/bin/echo $HOME'])
/home/kkinder
0 
```

使用`shell=True`参数基本上是对子进程模块说，*使用 shell 解释此文本*。

因此，您可以添加`shell=True`，但问题是一旦命令完成，它的状态就会丢失。堆栈中的每个应用程序都有自己的工作目录。所以目录是这样的：

*   重击 - /foo/bar
    *   蟒蛇 - /foo
        *   通过子进程 bash - /

命令执行后，python 进程的路径保持不变，一旦 shell 完成命令，子进程的路径将被丢弃。

基本上，你所要求的并不实用。你需要做的是，打开一个通往 Bash 的管道，交互式地输入你的用户类型的命令，然后以非阻塞方式读取输出。这将涉及复杂的管道、螺纹等。你确定没有更好的方法吗？

# python - 基于函数参数名称的条件语句

> ID：14114372
> 
> 赞同：1
> 
> 时间：2013-01-01T21:26:37.340
> 
> 标签：python

> **可能重复：**
> [如何获取传递给函数的变量的原始变量名](https://stackoverflow.com/questions/2749796/how-to-get-the-original-variable-name-of-variable-passed-to-a-function)

在 python 中是否有类似下面的内容，根据传递给函数的参数名称，我们可以执行如下条件语句。

```
def func(a,b,c,d)

if fourth paramter = d:
#code

elif fourth parameter = e:
#code

else:

#code

   def main():
         func(a,b,c,d)
         func(a,b,c,e) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T21:30:31.900

您应该使用关键字参数：

```
def func(a, b, c, **kwargs):
    if 'd' in kwargs:
        ....
    elif 'c' in kwargs:
        .... 
```

但是，这并不完全等同于您想要的。如果要保证`d`or`e`是*第四个*参数，那就比较麻烦了。

然后你可以尝试类似的东西：

```
def func(a, b, c, d=None, e=None):
    if d is not None and e is None:
        ....
    elif e is not None and d is None:
        .... 
```

请注意，这并不完全是您要问的。它不会访问作为位置参数传递给函数的变量的“原始”名称，如Stuart 链接的[问题中那样。](https://stackoverflow.com/questions/2749796/how-to-get-the-original-variable-name-of-variable-passed-to-a-function)你甚至不应该尝试这样做，这是没有意义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:34:40.287

`kwargs`不会给你你想要的，但它可以很接近：

```
def func(a, b, c, **kwargs):
   if 'd' in kwargs:
       print "do something"
   elif 'e' in kwargs:
       print "do something else"

 def main():
     func(a = 1 ,b = 2 ,c = 3, d = 'some_value')
     func(a = 1 ,b = 2 ,c = 3, e = 'some_value') 
```

# javascript - 将背景图像添加到 Windows 8 应用程序

> ID：14114375
> 
> 赞同：2
> 
> 时间：2013-01-01T21:26:48.400
> 
> 标签：javascript, html, windows-8

我目前正在设计一个 Windows 8 应用程序，我想知道如何在启动画面之后在主页上绘制背景。我正在使用 JavaScript 创建这个应用程序，但我还没有找到任何教程或帮助来绘制/显示一个简单的背景图像。我对基于 Web 的编程语言非常陌生，所以如果您能提供教程，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:03:50.600

`<body style="background-image: url('/images/ff-background.jpg');">`在 default.html 内部，或者您可以将 css 用于**body**标记。

# html - 在 iframe 源页面中使用元刷新标记会导致页面在 iframe 被调用的位置刷新

> ID：14114376
> 
> 赞同：3
> 
> 时间：2013-01-01T21:26:54.803
> 
> 标签：html, iframe, metadata

我正在为简单的聊天页面找到一种快速方法，因为我不想使用 Ajax 或 jQuery，所以我在源页面上使用了下面的标签，例如`page2.php`

```
<meta http-equiv="refresh" content="2">
<!--And the page content goes here--> 
```

我用这个`page1.php`

```
<iframe src="page2.php" border="1"></iframe> 
```

现在我所期望的只是`iframe`刷新，但整体`page1.php`刷新了，为什么会这样？比声明有什么`meta refresh`用`page2.php`？实际使用是否`iframe`将源页面的标记嵌入到我们使用 iframe 的页面中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:13:47.563

不幸的是，由于 iframe 的加载方式，似乎无法解决此问题。iframe 必须加载到 DOM 中才能正常工作，一旦加载完成，元刷新就会影响整个页面。

相反，您可以使用以下 onLoad [或者，如果您在 $(document).ready() 中使用 jQuery]：

```
setInterval(function(){ 
                        window.frames['someLogicalName'].location.reload();
            },2000); 
```

然后调整你的 iframe：

```
<iframe src="page2.php" name="someLogicalName" border="1"></iframe> 
```

# soap - 如何将 Paypal 与 SOAP API 集成？

> ID：14114377
> 
> 赞同：0
> 
> 时间：2013-01-01T21:26:54.320
> 
> 标签：soap, paypal, paypal-soap

当我将 PayPal 与 SOAP API 集成时，我遇到了一些问题。

现在，这是我的代码

```
// Set paypal
// Include NuSOAP
$url_nusoap                 = "xxx/nusoap/nusoap.php";
include($url_nusoap);

$wsdl_URL = "https://www.sandbox.paypal.com/wsdl/PayPalSvc.wsdl";
$s_URL  = "https://api-3t.sandbox.paypal.com/2.0/";
$s_Ver  = "94.0";

$header = "";
$header .= "<RequesterCredentials xmlns='urn:ebay:api:PayPalAPI' xsi:type='ebl:CustomSecurityHeaderType'>";
$header .= "<Credentials xmlns='urn:ebay:apis:eBLBaseComponents' xsi:type='ebl:UserIdPasswordType'>";
$header .= "<Username>@api_username@</Username>";
$header .= "<Password>@api_password@</Password>";
$header .= "<Signature>@api_signature@</Signature>";
$header .= "</Credentials>";
$header .= "</RequesterCredentials>";

$s  = new soap_client($wsdl_URL, true);
$err = $s->getError();
if ($err) die("Soap client constructor err.. check wsdl url");

//set end point
$s->setEndpoint($s_URL);

$s->setHeaders($header);

$bodyReq = "?"
$result = $s->call("?", $bodyReq); 
```

我的问题是我不知道我应该在 "$bodyReq" 和 $s->call(); 中调用什么 API；? 这是我的情况：在我的网站上可以选择付款方式

1.  贝宝
2.  xxx
3.  xxx

当我选择“1 Paypal”并提交时 - 如果 pay_method == “Paypal” 重定向到“PAYPAL SOAP API Page”，则重定向到“pay_checker”（如果 pay_method == “xxx” 将其重定向到其他付费服务中的某些 API）

如果我选择“PayPal 方法”并重定向到“PAYPAL SOAP API”页面，我需要它调用一些 API 来传递 $amount 、$product_name 并重定向到 PAYPAL 计费页面

请有人帮帮我

谢谢你。

编辑 ------ 现在我学习“ExpressCheckout”但我不知道从哪里学习它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T05:15:00.253

您当前所拥有的只是构建您的凭据，然后将其包含在您的实际 XML 请求中，这就是 $bodyReq 发挥作用的地方。

[PayPal为 Express Checkout](https://www.x.com/developers/paypal/development-and-integration-guides#ec)提供了大量的文档，包括[特定于 SOAP API 的文档](https://www.x.com/sites/default/files/pp_api_reference.pdf)。第 6 章介绍快速结帐。

# ios - 以编程方式更改iOS中的启动画面？

> ID：14114381
> 
> 赞同：4
> 
> 时间：2013-01-01T21:27:42.410
> 
> 标签：ios, background, splash-screen

我目前正在尝试弄清楚如何在 iOS 中更改启动画面（默认 png）。

据我了解，一开始就向用户展示应用程序的理想方式是让启动图像成为应用程序中 UI 元素的骨架表示（例如：[http ://h.dropcanvas.com/u90tr /IMG_0388.png](http://h.dropcanvas.com/u90tr/IMG_0388.png)）。

现在，在我的应用程序中，当我切换选项卡并转到另一个应用程序或主屏幕时，当我返回应用程序时，启动图像不再与该特定选项卡相关。

理想情况下，我想做的是以编程方式更改 applicationDidEnterBackground 中的启动图像，以便在返回应用程序时显示相关的启动屏幕。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-01T21:39:42.867

你不能这样做，也不应该打扰。启动图像（它不是启动画面！）仅在您的应用程序从头开始启动时使用。如果它刚刚进入后台，操作系统将拍摄自己的快照并在您返回应用程序时使用它。

因此，您的启动图像只需要显示您的应用程序的基本表示，因为它会在从头启动时出现。如果你有一个标签栏，它不应该显示任何图标或标签（因为它们可以随着本地化而改变）——实际上只是黑色的光泽背景，一直贯穿。例如，在您的链接中，我会丢失条形按钮项。

如果您无法制作具有代表性的图像，则最好使用纯黑色图像（或根本没有图像）。

# asp-classic - 执行 ASP ADO 插入时出现语法错误

> ID：14114382
> 
> 赞同：0
> 
> 时间：2013-01-01T21:27:47.920
> 
> 标签：asp-classic, ado

我正在连接不同的值，我得到以下 sql 语句：

```
INSERT INTO Ads (Position, Type, AdType, Link, Width, Height, Path, Korder ) VALUES ('left','1','left1','',1024,768,'FILE1',1) 
```

我真的在这里看不到任何错误，但是，它告诉我

Microsoft JET 数据库引擎错误“80040e14”

INSERT INTO 语句中的语法错误。

/adm/uploadAdPic.asp，第 68 行

```
sql="INSERT INTO Ads (Position, Type, AdType, Link, Width, Height, Path, Korder )"
            sql=sql & " VALUES "
            sql=sql & "('" & position & "',"
            sql=sql & "'" & adType & "',"
            sql=sql & "'" & position & adType & "',"
            sql=sql & "'" & link & "',"
            sql=sql & "" & width & ","              
            sql=sql & "" & height & ","
            sql=sql & "'" & path & "',"
            //sql=sql & "" & korder & ","
            sql=sql & "" & korder & ")"
            //sql=sql & "0)"

            Response.Write(sql)

            //on error resume next
            conn.Execute sql,recaffected      //THIS IS LINE 68 
```

请你帮我找出语法错误。

编辑：我自己找到了解决方案，但它也包含在下面的答案中。位置是保留字。我试图修改我的插入语句删除不同的字段，我发现 Position 字段出错。所以我将 Position 重命名为 VertPos 并且它可以工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T21:32:19.750

Position 是Jet SQL 中的保留字，请尝试更改为[Position]。

作为一般建议，将 [] 添加到所有列名称。

```
 sql="INSERT INTO Ads ([Position], [Type], [AdType], [Link], [Width], [Height], [Path], [Korder] )"
                sql=sql & " VALUES "
                sql=sql & "('" & position & "',"
                sql=sql & "'" & adType & "',"
                sql=sql & "'" & position & adType & "',"
                sql=sql & "'" & link & "',"
                sql=sql & "" & width & ","              
                sql=sql & "" & height & ","
                sql=sql & "'" & path & "',"
                //sql=sql & "" & korder & ","
                sql=sql & "" & korder & ")"
                //sql=sql & "0)"

                Response.Write(sql)

                //on error resume next
                conn.Execute sql,recaffected      //THIS IS LINE 68 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T21:40:57.200

1）错误是因为您的某些列名恰好是MSSQL关键字：

```
' SUGGESTED CHANGE:
INSERT INTO Ads (
  [Position], [Type], [AdType], [Link], [Width], [Height], [Path], [Korder]) 
VALUES ('left','1','left1','',1024,768,'FILE1',1) 
```

2）使用命令对象而不是“裸插入”可能会更好：

```
Here's an example that shows how to use "objCom.parameters.append()": 
```

*   [http://www.freevbcode.com/ShowCode.asp?ID=3687](http://www.freevbcode.com/ShowCode.asp?ID=3687)

# android - 在 Android 中保存 MapFragment (Maps v2) 状态

> ID：14114383
> 
> 赞同：18
> 
> 时间：2013-01-01T21:28:02.293
> 
> 标签：android, android-fragments, android-maps, android-fragmentactivity

我正在使用新的 GoogleMaps API (v2) 并且片段存在一些问题。我的应用程序中有两个片段（地图、列表），用户可以在它们之间切换。到目前为止，使用此代码可以正常工作：

```
if (itemPosition == 0) {
        getSupportFragmentManager().beginTransaction()
                .replace(R.id.fragmentpos, myMapFragment).commit();
    } else if (itemPosition == 1) {
        getSupportFragmentManager().beginTransaction()
                .replace(R.id.fragmentpos, myListFragment).commit();
}...... 
```

当我使用地图时，切换到列表片段然后回到地图片段，地图的最后一个位置没有保存。这不是我想要的，我希望地图在我“离开”它时处于保存状态。我怎样才能做到这一点？我试图将相机位置保存在

```
public void onSaveInstanceState(Bundle outState){
   outState.putDouble("LAT", mMap.getCameraPosition().target.latitude);
   outState.putDouble("LON", mMap.getCameraPosition().target.longitude);
   outState.putFloat("BEAR", mMap.getCameraPosition().bearing);
   ... 
```

}

并在 onCreateView() 中恢复它，但 Bundle 始终为空。如果我替换片段，则不会调用 onSaveInstanceState。

那么如何保存地图的状态呢？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-01T21:35:05.647

> 我怎样才能做到这一点？

如果您`replace()`是一个片段，则旧片段的视图将被破坏，从而取出您的`MapView`，大概是`CameraPosition`.

`onSaveInstanceState()`主要用于配置更改，例如屏幕旋转。`MapFragment`并且`SupportMapFragment`已经保留了`CameraPosition`（顺便说一句，它是`Parcelable`，因此您可以将整个对象保存在`Bundle`而不是零碎中）。

您可以考虑使用`show()`and`hide()`而不是`replace()`，因此片段及其视图会保留下来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T09:07:58.783

我通过在片段`CameraPosition`的方法中保持对地图上的引用解决了这个问题；`onDestroyView()`然后`CameraPosition`在恢复地图时使用它。

我的解决方案的上下文有它自己的怪癖，但基本上我有一个嵌套在另一个片段中的地图片段（即使在它被替换后，我也会坚持下去）。所以这是父片段`onActivityCreated()`方法中的代码：

```
 GoogleMapOptions mapOptions = new GoogleMapOptions();
    if(_savedCameraPosition != null)
    {
        mapOptions.camera(_savedCameraPosition);
    }
    else
    {
        // Centre on Australia
        mapOptions.camera(CameraPosition.fromLatLngZoom(new LatLng(-24.25, 133.25), 15));
    }
    _mapFragment = new SupportMapFragment().newInstance(mapOptions);

    FragmentTransaction fragmentTransaction = getFragmentManager().beginTransaction();
    fragmentTransaction.add(R.id.map_holder, _mapFragment);
    fragmentTransaction.commit(); 
```

然后在同一堂课上，我有：

```
@Override
public void onDestroyView()
{
    super.onDestroyView();
    _savedCameraPosition = _map.getCameraPosition();
} 
```

# objective-c - 请求用户信息时出现 Facebook iOS SDK 错误

> ID：14114390
> 
> 赞同：2
> 
> 时间：2013-01-01T21:29:25.323
> 
> 标签：objective-c, ios, facebook

我正在开发一个 iPhone 应用程序，其中一部分依赖于 Facebook 集成。我从网站下载了 3.1 版的 SDK 并按照第一个教程，在此链接中找到：[Authenticate](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/authenticate/)。

我在 iPhone 4 和 Xcode 4.5 上使用 iOS 6.0.1。

虽然登录工作正常，但按照[此处](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/personalize/)的步骤请求基本用户信息时，应用程序会出现以下错误：

```
2013-01-01 23:13:57.966 AppName[8691:907] Error: HTTP status code: 400
2013-01-01 23:13:57.977 AppName[8691:907] FBSDKLog: Response <#1111> <Error>:
The operation couldn’t be completed. (com.facebook.sdk error 5.) 
```

这是我用来请求信息的代码：

```
if (FBSession.activeSession.isOpen) {
    [FBSettings setLoggingBehavior:[NSSet setWithObjects:
                                    FBLoggingBehaviorFBRequests, nil]];

    [[FBRequest requestForMe] startWithCompletionHandler:^(FBRequestConnection *connection,
                                                           NSDictionary<FBGraphUser> *aUser,
                                                           NSError *error) {
        if (!error) {
            NSLog(@"%@", [[FBSession activeSession] accessToken]);
            userProfileImage.profileID = aUser.id;

            self.user = [[User alloc] initWithName:aUser.name andLocation:[aUser.location objectForKey:@"name"]];
            [self.user saveUser];
            [nameTextField setText:[self.user getName]];
            [locationTextField setText:[self.user getLocation]];
        }
    }];
} 
```

奇怪的是 FBRequest 在模拟器中工作。我检查了访问令牌，我也在 iPhone 上得到了一个。

另一件可能很重要的事情：在模拟器上，应用程序重定向到它获得授权的 Facebook 网站（我可以在 Facebook 上的应用程序列表中查看它）。另一方面，从设备登录时，我只在第一次登录时收到标准警报，并且该应用程序没有添加到 Facebook 上。

*PS：这是我的第一个问题，所以我为信息的数量（或缺乏）道歉。预先感谢您帮助我！*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T11:56:29.723

在过去的几天里，我一直在疯狂地搜索谷歌以寻找答案，但找不到答案。这非常令人沮丧，不一定是因为错误本身，而是因为有这么多人，但给出的实际答案却很少。

该错误似乎是权限问题。如果您从 iOS 6 登录，然后从 Facebook 中删除该应用程序，设备仍会认为您已授予该应用程序授权，从而返回错误。我能找到的最佳答案在[这里](https://stackoverflow.com/a/13415500/341331)。

今天，在我再次在设备上加载应用程序后，没有先尝试模拟器，它就像一个魅力。如果你有同样的问题，我的建议是在其他代码上工作一段时间，然后第二天再试一次。这不是完美的解决方案，我认为 Apple/Facebook 应该尝试解决这个问题，但它确实有效。

# jquery - 隐藏时函数触发两次

> ID：14114393
> 
> 赞同：0
> 
> 时间：2013-01-01T21:29:39.410
> 
> 标签：jquery

我有一个隐藏的 div，单击链接后，它会显示 div。

```
 <div id="baystar">
        <!-- My hidden stuff -->
  </div>

  <div class="galactica">
    <li class="menu-563"><a class="menu-563 active" href="#">Tools</a></li>
  </div> 
```

当您单击工具链接时，会显示 div.baystar。当您在打开时单击 div.baystar 内部时，它不会关闭。当您单击 div.baystar 之外的任意位置时，div.baystar 将关闭。一切运作良好。问题是当我单击工具链接关闭 div.baystar 时，它会快速关闭，然后重新打开，因此会触发两次。

```
 $(".menu-563").click(function(){
    $("#baystar").slideToggle("fast");
    $(this).toggleClass("active"); return false;
  });

 $('a.menu-563').attr('href', '#'); {
 }

 var mouse_is_inside = false;

$(document).ready(function()
{
    $('#baystar').hover(function(){ 
        mouse_is_inside=true; 
    }, function(){ 
        mouse_is_inside=false; 
    });

    $("body").mouseup(function(){ 
        if(! mouse_is_inside) $('#baystar').hide();
    });
}); 
```

如果我去掉鼠标悬停功能，它工作正常。我需要某种延迟，还是我的代码只需要重写？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:52:29.333

发生这种情况是因为您只能阻止点击事件冒泡。

您还需要停止它，`mouseup`以免它到达`body`

```
 $(".menu-563").click(function(){
    $("#baystar").slideToggle("fast");
    $(this).toggleClass("active"); return false;
  }).mouseup(function(e){return false;}); 
```

* * *

你可以这样做来处理整个事情..

```
$(".menu-563").click(function(e) {
    $("#baystar").slideToggle("fast");
    $(this).toggleClass("active");
    return false;
});

$('body').click(function(e){
    if (!$(e.target).closest('#baystar').length){
       $("#baystar").hide();
    }
}); 
```

# asp.net-mvc - 延迟加载在实体框架 5 中不起作用

> ID：14114397
> 
> 赞同：5
> 
> 时间：2013-01-01T21:30:15.723
> 
> 标签：asp.net-mvc, entity-framework, lazy-loading

我在我的域项目中定义了一个（poco？）类：

```
public class Club
{
   public Club()
   {
      ContactPersons = new HashSet<ContactPerson>();
   }

   public int Id { get; set; }

   [Required]
   [StringLength(64)]
   public string Name { get; set; }

   public virtual ICollection<ContactPerson> ContactPersons { get; set; }
}

public class ContactPerson
{
     public virtual int Id { get; set; }

     [StringLength(64)]
     public virtual string FirstName { get; set; }

     [StringLength(64)]
     public virtual string LastName { get; set; }
 } 
```

在我的 MVC 项目中，我有我的俱乐部控制器：

```
 public ActionResult Create(CreateClubViewModel model)
   {
      Club club = new Club();
      model.Initialize(club);
      IClubDb clubDb = DependencyResolverHelper.IClubDbService;
      clubDb.Create(club);  // create club in db
   }

    public ActionResult Display(string domain)
    {
        try
        {
            IClubDb clubDb = DependencyResolverHelper.IClubDbService;
            Club club = clubDb.Get(domain);
            return View(club);
        }
        catch (Exception)  // user is not logged iin
        {
            return View();
        }
    } 
```

最后，在我的数据库项目中，我创建并检索了俱乐部，

```
public Club Get(string name)
{
   return DataContext.Clubs
   //.Include(x => x.ContactPersons)
   .Single(r => r.Name == name);
}

 public int Create(Club club)
 {
         DataContext.Clubs.Add(club);
         return DataContext.SaveChanges();
 } 
```

当我在 Display 方法中调用 Get club 时，我已尽一切努力让 EF 延迟加载我的俱乐部对象的 ContactPersons，但 ContactPersons 的长度始终为零。但是，如果我渴望使用 .include 加载联系人（我已将这部分注释掉），那么显然 ContactPersons 包含许多联系人。

我不确定我做错了什么：

1.  我遵循了定义 poco 类的指南：http: [//msdn.microsoft.com/en-us/library/dd468057.aspx](http://msdn.microsoft.com/en-us/library/dd468057.aspx)
2.  我有一个公共参数少的构造函数（但不是受保护的构造函数）
3.  我启用了延迟加载

我想我错过了一个概念，poco club 类也是我插入数据库的域实体。我究竟做错了什么？为什么我不能让延迟加载工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-20T19:22:03.317

尝试 ContactPersons.ToList();

这将强制加载所有实体。见[实体框架，调用 ToList() 时会自动加载 FK 对象吗？](https://stackoverflow.com/questions/8932680/entity-framework-when-call-tolist-it-will-load-fk-objects-automatically)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:02:29.003

您是否忘记在您的实体中包含外键？

```
public class ContactPerson
{
    public virtual int Id { get; set; }

    [StringLength(64)]
    public virtual string FirstName { get; set; }

    [StringLength(64)]
    public virtual string LastName { get; set; }

    public int ClubId { get; set; }
    [ForeignKey("ClubId")]
    public virtual Club Club { get; set; } // if you need
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T21:59:51.040

似乎您的 LazyLoading 在您的 dbContext 关闭时执行。所以它不会加载。您在视图中使用 ContactPerson，对吗？

# ruby-on-rails - Resque worker 导致 ActiveRecord::StatementInvalid: PG::Error: SSL SYSCALL error: EOF detected

> ID：14114405
> 
> 赞同：1
> 
> 时间：2013-01-01T21:31:18.057
> 
> 标签：ruby-on-rails, heroku, resque, unicorn

我现在在两个应用程序上遇到了这个问题。Heroku 自己（还）无法提供太多帮助。

我在用：

*   导轨 3.2.9
*   [独角兽](http://blog.railsonfire.com/2012/05/06/Unicorn-on-Heroku.html)
*   Heroku，带有 Postgres Dev（免费）数据库和 OpenRedis Micro
*   MongoDB（用于存储社交网络状态）
*   [雷斯克](https://github.com/defunkt/resque)
*   [重新调度程序](https://github.com/bvandenbos/resque-scheduler)

使用我的本地 Postgres 和 Redis 数据库运行时，一切都很好。

这是我的 Heroku 日志中的错误示例：

```
2013-01-01T21:17:27+00:00 app[resque_worker.1]: Found job on #<Resque::Queue:0x00000006652920>
2013-01-01T21:17:27+00:00 app[resque_worker.1]: got: (Job{facebook} | FacebookRefresh | ["facebook_key"])
2013-01-01T21:17:27+00:00 app[resque_worker.1]: Running before_fork hooks with [(Job{facebook} | FacebookRefresh | ["facebook_key"])]
2013-01-01T21:17:27+00:00 app[resque_worker.1]: Running after_fork hooks with [(Job{facebook} | FacebookRefresh | ["facebook_key"])]
2013-01-01T21:17:27+00:00 app[resque_worker.1]: resque-2.0.0.pre.1: Processing facebook since 1357075047
2013-01-01T21:17:27+00:00 app[resque_worker.1]: resque-2.0.0.pre.1: Forked 503 at 1357075047
2013-01-01T21:17:27+00:00 app[resque_worker.1]: Running before_perform hooks with [(Job{facebook} | FacebookRefresh | ["facebook_key"])]
2013-01-01T21:17:27+00:00 app[resque_worker.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod),
2013-01-01T21:17:27+00:00 app[resque_worker.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2013-01-01T21:17:27+00:00 app[resque_worker.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2013-01-01T21:17:27+00:00 app[resque_worker.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod
2013-01-01T21:17:27+00:00 app[resque_worker.1]: ). Retrying...
2013-01-01T21:17:27+00:00 app[resque_worker.1]: Performing FacebookRefresh caused an exception (PG::Error: SSL SYSCALL error: EOF detected
2013-01-01T21:17:27+00:00 app[resque_worker.1]:              WHERE a.attrelid = '"facebook_accounts"'::regclass
2013-01-01T21:17:27+00:00 app[resque_worker.1]:              ORDER BY a.attnum
2013-01-01T21:17:27
+00:00 app[resque_worker.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2013-01-01T21:17:27+00:00 app[resque_worker.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod),
2013-01-01T21:17:27+00:00 app[resque_worker.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2013-01-01T21:17:27+00:00 app[resque_worker.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2013-01-01T21:17:27+00:00 app[resque_worker.1]: (Job{facebook} | FacebookRefresh | ["facebook_key"]) failed: #<ActiveRecord::StatementInvalid: PG::Error: SSL SYSCALL error: EOF detected
2013-01-01T21:17:27+00:00 app[resque_worker.1]: >
2013-01-01T21:17:27+00:00 app[resque_worker.1]:                      pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod
2013-01-01T21:17:27+00:00 app[resque_worker.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2013-01-01T21:17:27+00:00 app[resque_worker.1]:              WHERE a.attrelid = '"facebook_accounts"'::regclass
2013-01-01T21:17:27+00:00 app[resque_worker.1]:              ORDER BY a.attnum
2013-01-01T21:17:27+00:00 app[resque_worker.1]: Running before_fork hooks with [(Job{facebook} | FacebookRefresh | ["facebook_key"])] 
```

我在我的独角兽的配置文件中尝试了很多 before_hook 和 after_hook 的东西，但它们似乎都没有帮助。

```
# What the timeout for killing busy workers is, in seconds
timeout 60

# Whether the app should be pre-loaded
preload_app true

# How many worker processes
worker_processes 3

before_fork do |server, worker|
  # Replace with MongoDB or whatever
  if defined?(ActiveRecord::Base)
    ActiveRecord::Base.connection.disconnect!
    Rails.logger.info('Disconnected from ActiveRecord')
  end

  # If you are using Redis but not Resque, change this
  if defined?(Resque)
    Resque.redis.quit
    Rails.logger.info('Disconnected from Redis')
  end

  sleep 1
end

after_fork do |server, worker|
  if defined?(ActiveRecord::Base)
    ActiveRecord::Base.establish_connection
    Rails.logger.info('Connected to ActiveRecord')
  end

  if defined?(Resque)
    Resque.redis = ENV['OPENREDIS_URL'] || 'redis://localhost:6379'
    Rails.logger.info('Connected to Redis')
  end
end 
```

还有我的 Procfile

```
web: bundle exec unicorn -c lib/unicorn/config.rb -p $PORT
resque_scheduler: env bundle exec rake resque:scheduler
resque_worker: env QUEUE=* bundle exec rake environment resque:work 
```

所以我想知道的一件事是我的 resque_worker 根本不使用 Unicorn 配置，并且由于它运行在一个完全独立的 Heroku worker 上，我不确定它是否有任何方法可以知道这些东西。Web 实例和调度程序都很好。它只是 resque_worker 在每次 postgres 调用时都会爆炸。

我没有从工作人员那里进行任何特别疯狂的数据库调用。一个例子可能是：

```
def queue_users_for_refresh
  FacebookAccount.all.each do |x|
    Resque.enqueue(FacebookAccountRefresh, x.username)
  end
end 
```

另一个稍后（在 FacebookAccountRefresh 中）是：

```
FacebookAccount.where(:username => user).first 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T15:59:57.753

This looks like an error caused by sharing database connections across processes incorrectly. This happens when the Resque worker isn't re-initializing database connections after forking.

Do you have a Resque initializer? It looks like you're missing after_fork directives for Resque workers to match the ones in your Unicorn app server workers.

Add/edit your Resque initializer file (ie: config/initializers/resque.rb):

```
Resque.after_fork = Proc.new { ActiveRecord::Base.establish_connection } 
```

# javascript - 计算 DIV，使用 jQuery 添加包装器

> ID：14114406
> 
> 赞同：0
> 
> 时间：2013-01-01T21:31:20.583
> 
> 标签：javascript, jquery

我正在编写一个需要在框中显示内容的网页，如下所示：

```
[ 1 ] [ 3 ] [ 5 ]
[ 2 ] [ 4 ] [ 6 ] 
```

由于屏幕尺寸不同，有时行数会有所不同。例如，允许显示更多行的屏幕将按如下方式排列：

```
[ 1 ] [ 4 ]
[ 2 ] [ 5 ]
[ 3 ] [ 6 ] 
```

我遇到的问题是，当我将`DIV`s 向左浮动时，它们显示如下：

```
[ 1 ] [ 2 ] [ 3 ]
[ 4 ] [ 5 ] [ 6 ] 
```

我解决此问题的计划是将每一列包装在一个 div 中，并将其浮动到左侧。但是因为根据屏幕大小可能会有不同的行数，所以我需要使用 jQuery 来完成。

我已经用 jQuery 计算了行数，我只是不知道如何在包装器中包装一定数量的 div。到目前为止，这是我的脚本：

```
var pageHeight = $("body").innerHeight() - 157; // 157 being the height of the page title
var rowCount = Math.floor(pageHeight / 295); // 295 being the height of each item
var itemCount = $("#itemWrapper").children(".item").length;each item
$("#itemWrapper").height(pageHeight); 
```

所以，如果`rowCount = 3`，那么我需要将每组三个`.item`s 包装在`<div class="column"></div>`. 当然请记住，可能只剩下两个，或者`.item`剩下一个。

这看起来很简单，但我什至找不到从哪里开始。当我对此进行更多研究时，如果我发现任何问题，我一定会更新我的问题。

更新1：看起来我可以使用`.wrap()`jQuery的功能。我只需要弄清楚如何在多个`DIV`.

更新 2：我发现了这段代码，看起来很有希望，但我不知道如何根据行数进行更改：

```
for (var i = 0;i < itemCount;i+=3) {
    $(".item").filter(':eq('+i+'),:eq('+(i+1)+'),:eq('+(i+2)+')').wrapAll('<div class="column" />');
}; 
```

似乎对于每个额外的 div，它都需要添加`:eq('+(i+1)+')`一个数字更高的花药。不知道如何编写执行此操作的脚本，但我仍在研究。如果我只是更改`3' to`rowCount`，它不会正确关闭所有添加的 div。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T21:44:06.837

我还不能发表评论，很抱歉将其发布为答案。

您应该真正研究使用媒体查询的响应式网页设计。[这是一篇](http://mobile.smashingmagazine.com/2010/07/19/how-to-use-css3-media-queries-to-create-a-mobile-version-of-your-website/)帮助您入门的文章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T21:55:59.677

您可以将 CSS3 列属性用于支持它们的浏览器。

这是一个可以跨浏览器工作的列包装脚本。我使用基于列数的列类的 css 规则来以百分比设置宽度

```
var colCount = 3,/* hard coded for demo, use your calcs for dynamic*/
    $items = $('.item'),
    items_per_col = Math.ceil($items.length / colCount),
    start = 0;

for (i = 0; i < colCount; i++) {
    var endSlice = start + items_per_col;
    $items.slice(start, endSlice).wrapAll('<div class="col' + colCount + '">');
    start += items_per_col;
} 
```

演示：http: [//jsfiddle.net/MkGyu/1](http://jsfiddle.net/MkGyu/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T21:56:22.480

```
if (jQuery and wantsColumns) {
   return [Masonry](http://masonry.desandro.com/demos/basic-multi-column.html);
} 
```

# three.js - 使用 Three.js 从远处看时纹理看起来很模糊

> ID：14114407
> 
> 赞同：8
> 
> 时间：2013-01-01T21:31:22.563
> 
> 标签：three.js

在我使用 Three.js 的游戏中，当我远离它们时，我的纹理看起来很模糊。由于我 16 位复古风格的性质，我必须没有任何模糊的东西。

知道我能做些什么来解决这个问题吗？我像这样创建我的纹理：

```
var texture  = new THREE.Texture( image,
  new THREE.UVMapping(),
  THREE.RepeatWrapping,
  THREE.RepeatWrapping,
  THREE.NearestFilter,
  THREE.LinearMipMapLinearFilter ); 
```

![在此处输入图像描述](../Images/1d0b3130ac712b550db7de87f94c03c2.png)

如果我为两者选择 NearestFilter，结果看起来相当丑陋且太尖锐：

![在此处输入图像描述](../Images/06f62f5608d0374c77dfe282ba43a571.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T21:43:50.830

我会给各向异性过滤一个镜头，但“不”模糊是不可能的。

这是一个例子： http: [//mrdoob.github.com/three.js/examples/webgl_materials_texture_anisotropy.html](http://mrdoob.github.com/three.js/examples/webgl_materials_texture_anisotropy.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-01T21:43:38.613

我使用 NearestMipMapLinearFilter 而不是 LinearMipMapLinearFilter，结果看起来可以接受：

![在此处输入图像描述](../Images/d2f47bdb04e143bc0e6895460445f57c.png)

# php - 从字符串中删除所有特殊字符

> ID：14114411
> 
> 赞同：254
> 
> 时间：2013-01-01T21:31:41.843
> 
> 标签：php, regex, url, slug

我遇到了 URL 的问题，我希望能够转换可能包含任何内容的标题并将它们剥离所有特殊字符，以便它们只有字母和数字，当然我想用连字符替换空格。

这将如何完成？我听说过很多关于正则表达式（regex）的使用......

* * *

## 回答 #1

> 赞同：754
> 
> 时间：2013-01-01T21:33:54.827

这应该可以满足您的需求：

```
function clean($string) {
   $string = str_replace(' ', '-', $string); // Replaces all spaces with hyphens.

   return preg_replace('/[^A-Za-z0-9\-]/', '', $string); // Removes special chars.
} 
```

**用法：**

```
echo clean('a|"bc!@£de^&$f g'); 
```

将输出：`abcdef-g`

**编辑：**

> 嘿，只是一个简单的问题，我怎样才能防止多个连字符彼此相邻？并将它们替换为 1 吗？

```
function clean($string) {
   $string = str_replace(' ', '-', $string); // Replaces all spaces with hyphens.
   $string = preg_replace('/[^A-Za-z0-9\-]/', '', $string); // Removes special chars.

   return preg_replace('/-+/', '-', $string); // Replaces multiple hyphens with single one.
} 
```

* * *

## 回答 #2

> 赞同：128
> 
> 时间：2013-01-01T21:36:45.050

# 更新

下面的解决方案有一个“SEO 更友好”的版本：

```
function hyphenize($string) {
    $dict = array(
        "I'm"      => "I am",
        "thier"    => "their",
        // Add your own replacements here
    );
    return strtolower(
        preg_replace(
          array( '#[\\s-]+#', '#[^A-Za-z0-9\. -]+#' ),
          array( '-', '' ),
          // the full cleanString() can be downloaded from http://www.unexpectedit.com/php/php-clean-string-of-utf8-chars-convert-to-similar-ascii-char
          cleanString(
              str_replace( // preg_replace can be used to support more complicated replacements
                  array_keys($dict),
                  array_values($dict),
                  urldecode($string)
              )
          )
        )
    );
}

function cleanString($text) {
    $utf8 = array(
        '/[áàâãªä]/u'   =>   'a',
        '/[ÁÀÂÃÄ]/u'    =>   'A',
        '/[ÍÌÎÏ]/u'     =>   'I',
        '/[íìîï]/u'     =>   'i',
        '/[éèêë]/u'     =>   'e',
        '/[ÉÈÊË]/u'     =>   'E',
        '/[óòôõºö]/u'   =>   'o',
        '/[ÓÒÔÕÖ]/u'    =>   'O',
        '/[úùûü]/u'     =>   'u',
        '/[ÚÙÛÜ]/u'     =>   'U',
        '/ç/'           =>   'c',
        '/Ç/'           =>   'C',
        '/ñ/'           =>   'n',
        '/Ñ/'           =>   'N',
        '/–/'           =>   '-', // UTF-8 hyphen to "normal" hyphen
        '/[’‘‹›‚]/u'    =>   ' ', // Literally a single quote
        '/[“”«»„]/u'    =>   ' ', // Double quote
        '/ /'           =>   ' ', // nonbreaking space (equiv. to 0x160)
    );
    return preg_replace(array_keys($utf8), array_values($utf8), $text);
} 
```

上述功能的基本原理（我发现效率低下 - 下面的一个*更好*）是*一个不应命名的服务*显然在 URL 上运行拼写检查和关键字识别。

在客户的偏执中失去了很长时间后，我发现他们毕竟*不是*在想象事情——他们的 SEO 专家 [我绝对不是] 报告说，将“Viaggi Economy Perù”转换为`viaggi-economy-peru`“表现得更好”比`viaggi-economy-per`（之前的“清理”删除了 UTF8 字符；**Bogotà**变成**了 bogot**，**Medellìn**变成**了 medelln**等等）。

还有一些常见的拼写错误似乎影响了结果，对我来说唯一有意义的解释是我们的 URL 被解包，单词被挑出来，用来驱动上帝知道什么排名算法。而且这些算法显然已经输入了 UTF8 清理的字符串，因此“Perù”变成了“Peru”而不是“Per”。“Per”不匹配，有点像在脖子上。

为了既保留 UTF8 字符又替换一些拼写错误，下面更快的函数变成了上面更准确的 (?) 函数。`$dict`当然，需要手工定制。

# 上一个答案

一个简单的方法：

```
// Remove all characters except A-Z, a-z, 0-9, dots, hyphens and spaces
// Note that the hyphen must go last not to be confused with a range (A-Z)
// and the dot, NOT being special (I know. My life was a lie), is NOT escaped

$str = preg_replace('/[^A-Za-z0-9\. -]/', '', $str);

// Replace sequences of spaces with hyphen
$str = preg_replace('/  */', '-', $str);

// The above means "a space, followed by a space repeated zero or more times"
// (should be equivalent to / +/)

// You may also want to try this alternative:
$str = preg_replace('/\\s+/', '-', $str);

// where \s+ means "zero or more whitespaces" (a space is not necessarily the
// same as a whitespace) just to be sure and include everything 
```

请注意，您可能必须首先`urldecode()`输入 URL，因为 %20 和 + 实际上都是空格 - 我的意思是，如果您有“Never%20gonna%20give%20you%20up”，您希望它变成 Never-gonna-give-you-起来，而不是*Never20gonna20give20you20up*。你可能不需要它，但我想我会提到这种可能性。

所以完成的功能以及测试用例：

```
function hyphenize($string) {
    return 
    ## strtolower(
          preg_replace(
            array('#[\\s-]+#', '#[^A-Za-z0-9\. -]+#'),
            array('-', ''),
        ##     cleanString(
              urldecode($string)
        ##     )
        )
    ## )
    ;
}

print implode("\n", array_map(
    function($s) {
            return $s . ' becomes ' . hyphenize($s);
    },
    array(
    'Never%20gonna%20give%20you%20up',
    "I'm not the man I was",
    "'Légeresse', dit sa majesté",
    )));

Never%20gonna%20give%20you%20up    becomes  never-gonna-give-you-up
I'm not the man I was              becomes  im-not-the-man-I-was
'Légeresse', dit sa majesté        becomes  legeresse-dit-sa-majeste 
```

为了处理 UTF-8，我使用了一个`cleanString`在网上找到的实现（链接已断开，但是答案的开头是一个包含所有不太深奥的 UTF8 字符的精简副本；如果你添加更多字符也很容易需要）将 UTF8 字符转换为普通字符，从而尽可能地保留单词“look”。为了性能，它可以被简化并包装在函数中。

上面的函数还实现了转换为小写 - 但这是一种品味。这样做的代码已被注释掉。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2013-01-01T21:35:38.153

在这里，查看此功能：

```
function seo_friendly_url($string){
    $string = str_replace(array('[\', \']'), '', $string);
    $string = preg_replace('/\[.*\]/U', '', $string);
    $string = preg_replace('/&(amp;)?#?[a-z0-9]+;/i', '-', $string);
    $string = htmlentities($string, ENT_COMPAT, 'utf-8');
    $string = preg_replace('/&([a-z])(acute|uml|circ|grave|ring|cedil|slash|tilde|caron|lig|quot|rsquo);/i', '\\1', $string );
    $string = preg_replace(array('/[^a-z0-9]/i', '/[-]+/') , '-', $string);
    return strtolower(trim($string, '-'));
} 
```

# javascript - 当我通过 AJAX 管理我的网站时，如何更新我的 URL？

> ID：14114415
> 
> 赞同：1
> 
> 时间：2013-01-01T21:32:48.973
> 
> 标签：javascript, jquery, html, ajax, url

我通过 ajax&jquery 将我网站的内容加载到“主”页面的区域中，因此加载速度更快。但问题是，使用这种方法，我会遇到严重的 SEO 问题，因为 URL 没有得到更新。搜索引擎只索引主页而不是所有其他内容。那么每次加载新内容时如何更新网站的 URL？当给出更新的 URL 时，如何让页面加载所需的内容？

你可以在这里查看整个源代码：http: [//boxcomp.111mb.de/luxus/html8](http://boxcomp.111mb.de/luxus/html8)

你能直接建议我应该在现有的 jquery 代码中添加什么吗？您可以在 index.html 文件的顶部找到它。

对不起“混乱”

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T21:49:39.870

当前的所有浏览器，包括 IE10+，都支持[HTML5 History API](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history#Adding_and_modifying_history_entries)，允许在不重新加载页面的情况下更改 URL 地址。对于较旧的浏览器，您可以不使用 Ajax。

搜索引擎根本不应该受到 Ajax 的影响。他们应该看到具有常规`href`属性的常规静态链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:37:57.857

我不得不让你失望。

您不能在不重新加载页面的情况下更改浏览器的 url。您唯一能做的就是向页面添加锚点：

```
index.html -> index.html#page1 
```

但我认为，这些与搜索引擎并不真正相关。

所以你必须决定：SEO 还是 Ajax - 但两者都不可能......

# php - PHP 5.4 中关于安全模式的默认行为是什么

> ID：14114417
> 
> 赞同：3
> 
> 时间：2013-01-01T21:33:14.607
> 
> 标签：php, installation, safe-mode

我有点困惑，需要在这里输入一些信息：

据我所知，在安全模式指令设置为关闭的情况下，即使所有者不同，PHP 也能够访问文件。

然后设置为开，对这些文件的访问被禁用。

现在在 PHP 5.4 中删除了安全模式，与过去相比，我找不到默认功能。

试图更改不属于服务器的文件的权限，但没有用......所以我是否应该考虑默认功能就像开启安全模式一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:41:34.560

PHP 5.4 中的默认功能根本没有安全模式。

这与过去将安全模式指令设置为关闭时类似。

无论是什么导致了您的问题，在 PHP 5.4 中都不能是安全模式，因为不再存在安全模式。它已被删除。

如果您想找出导致您头痛的原因，您需要解决您的问题。例如，通过启用错误记录和报告到最高级别并遵循错误日志。

*   [错误报告](http://www.phptherightway.com/#error_reporting)

另见：

*   [通过删除 safe_mode，PHP 5.4 的安全性在哪里](https://stackoverflow.com/q/9763531/367456)
*   [安全模式^(*文档*)](http://php.net/features.safe-mode)
*   [安全和安全模式^(*文档*)](http://php.net/ini.sect.safe-mode)

# html - 从 HTML 中获取 CSS 类

> ID：14114421
> 
> 赞同：0
> 
> 时间：2013-01-01T21:34:14.750
> 
> 标签：html, css, sublimetext2

所以我想知道是否有人知道 sublime 的包/插件或列出 HTML 片段中的类属性的服务。

例如，我喜欢标记然后处理 css。我不断发现自己将 sublime 分成两半，然后手动滚动左侧的 HTML，并在右侧重写实际的类名样式。

基本上我有：

```
<section class="home-testimonials">
    <h2 class="home-title">
        <span>Testimonials</span>
    </h2>
    <div class="testimonial-wrapper">
        <!-- Other divs with classes -->
    </div>
</section> 
```

我想要一个这样的列表：

*   .home-推荐
*   .home-title
*   .testimonial-wrapper

如果它表示层次结构就更好了。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:56:23.773

我不确定 Sublime，但是使用常规 JS，您可以使用 选择所有元素`document.getElementsByTagName('*')`，然后使用 提取每个元素的类`element.className`。

# php - 找出用户注销的次数

> ID：14114426
> 
> 赞同：1
> 
> 时间：2013-01-01T21:34:33.050
> 
> 标签：php, session

我已经建立了一个系统，用户在一段时间后会自动注销。我要做的是找出特定用户注销的次数。

我将如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:41:54.400

我不太确定我是否正确理解了您的问题，但无论如何：

你说你有一个数据库支持你。用它。创建一个说明 的字段`LastActivity`，每次该人在您的网站上做某事时，您都会更新该字段。如果`LastActivity`时间太长，请断开用户与网站的连接（通过终止会话）。同时，您可以更新某种字段，该字段计算该用户“被迫注销”的频率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:55:58.743

只计算用户登录的次数......完全一样，不是吗？

# javascript - 根据 new Date() 设计一个 Javascript 对象以作为字符串输出到 console.log

> ID：14114431
> 
> 赞同：0
> 
> 时间：2013-01-01T21:35:51.053
> 
> 标签：javascript

如何`console.log(new Date());`在控制台显示字符串？

如何在我的对象中模仿这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:36:35.050

[`.toString()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/toString)在对象的原型中提供一个方法：

```
var Demo = function(){};
Demo.prototype.toString = function(){ return "Demo string"; };

var test = new Demo();
console.log(test); // results in "Demo string" 
```

`==`请注意，这可能会稍微改变代码的行为，因为如果左侧和右侧的类型不同，非类型安全比较运算符将在某些情况下使用此函数：

```
if(test == "Demo String"){
    console.log("Equal!");
}
if(test !== "Demo String"){
    console.log("But not same type!");
} 
```

不过好像`console.log` [还没有标准化](http://lists.w3.org/Archives/Public/public-script-coord/2012OctDec/0377.html)，所以没有统一的解决方案。请注意，您仍然可以使用`console.log(test + "")`来触发`toString`.

# mysql - 排除具有匹配的较新记录的 mysql 表记录

> ID：14114432
> 
> 赞同：0
> 
> 时间：2013-01-01T21:35:52.087
> 
> 标签：mysql

我有一个系统可以查询不同坐标的游戏活动数据库表。我需要查询某个玩家的活动，但我需要排除在相同坐标处匹配新条目的任何活动（是否由其他玩家，只是任何东西）。

示例查询是：

```
SELECT * FROM prism_actions
WHERE world = 'world'
AND (action_type = 'block-place')
AND (player = 'viveleroi')
AND (x BETWEEN -448.7667627678472 AND -438.7667627678472)
AND (y BETWEEN 62.0 AND 72.0)
AND (z BETWEEN -291.17236958025796 AND -281.17236958025796)
ORDER BY x,y,z ASC
LIMIT 0,1000000 
```

我试过让它与子查询和内部连接一起工作，但就是无法得到它。我也真的需要能够快速完成这项工作。

本质上，当有另一条具有相同 X、Y、Z 但具有新 action_time 的记录时，我需要此查询来排除坐标 X、Y、Z 处的任何记录。

当输入新匹配时，我还考虑过某种方式在相同的 x、y、z 处过期记录，但这似乎也没有我想要的那么有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:44:39.007

您可以通过加入过滤掉“最新”坐标的子查询来做到这一点：

```
SELECT prism_actions.*
FROM prism_actions
JOIN (
    SELECT x, y, z, max(action_time) as action_time
    FROM prism_actions
    GROUP BY x, y, z) latest
  ON prism_actions.action_time = latest.action_time
  AND prism_actions.x = latest.x
  AND prism_actions.y = latest.y
  AND prism_actions.z = latest.z
WHERE prism_actions.world = 'world'
AND (prism_actions.action_type = 'block-place')
AND (prism_actions.player = 'viveleroi')
AND (prism_actions.x BETWEEN -448.7667627678472 AND -438.7667627678472)
AND (prism_actions.y BETWEEN 62.0 AND 72.0)
AND (prism_actions.z BETWEEN -291.17236958025796 AND -281.17236958025796)
ORDER BY x,y,z ASC
LIMIT 0,1000000 
```

# python - Python：而 KeyboardInterrupt 被转发到多处理子进程？

> ID：14114433
> 
> 赞同：2
> 
> 时间：2013-01-01T21:35:54.080
> 
> 标签：python, windows, windows-8, 64-bit, multiprocessing

我在 Windows 上执行了以下测试代码：

```
import multiprocessing
import time

def child() :
  while True :
    time.sleep( 2 )

if __name__ == '__main__' :
  multiprocessing.Process( target = child ).start()
  while True :
    time.sleep( 1 ) 
```

如果我在它工作时按下`Ctrl-C`，我会看到**两个** `KeyboardInterrupt`例外 - 一个 for`sleep( 1 )`和一个 for `sleep( 2 )`。main 中的键盘中断`process`是如何转发给 child 的`process`？毕竟它们是进程，而不是线程:(。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:01:10.903

当进程[捕获到](http://docs.python.org/2/library/signal.html)表示[键盘中断的](http://www.kernel.org/doc/man-pages/online/pages/man7/signal.7.html)[信号](http://docs.python.org/2/library/signal.html) （按 ctrl+c）`KeyboardInterrupt`时，将引发异常。[`SIGINT`](http://docs.python.org/2/library/signal.html)

在 Unix/Linux 系统中，信号被发送到包括父进程及其子进程`SIGINT`的整个[前台进程组。](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap11.html#tag_11_01_02)

# opengl - OpenGL 可编程管线点光源

> ID：14114437
> 
> 赞同：2
> 
> 时间：2013-01-01T21:36:15.130
> 
> 标签：opengl, 3d, glsl, lighting

由于像现在在最新版本的 OpenGL 规范中被标记为不推荐使用的内置制服`gl_LightSource`，我目前正在实现一个基本的照明系统（现在是点光源），它通过自定义的制服变量接收所有的光和材质信息。

我已经为点光源实现了光衰减和镜面高光，它似乎工作得很好，除了位置故障：我正在手动移动光，改变它沿 X 轴的位置。然而，光源（根据它投射在其下方方形平面上的光来判断）似乎并没有沿 X 轴移动，而是在 X 和 Z 轴上沿对角线移动（也可能是 Y，尽管它不是完全是定位错误）。

这是失真的截图（灯光在 -35, 5, 0，Suzanne ist 在 0, 2, 0: ![这明显是歪曲的](../Images/0dfcc7f8b0d483609d1011ec05d5399c.png)：

灯光在 0、5、0 时看起来没问题： ![这看起来不错](../Images/910f4530dc7362bf7763ded70c1f2b4d.png)

根据 OpenGL 规范，所有默认光照计算都发生在**eye coordinate**中，这就是我在这里试图模拟的（因此光照位置与 vMatrix 相乘）。我只使用视图矩阵，因为将要渲染的顶点批次的模型转换应用到灯光并没有真正意义。

如果重要的话，所有平面的法线都指向正上方 - 0、1、0。

（注意：感谢 msell 和 myAces，我现在解决了这个问题！以下片段是更正的版本。现在还有一个选项可以将聚光灯参数添加到灯光（d3d 样式的））

这是我在**顶点着色器**中使用的代码：

```
#version 330

uniform mat4 mvpMatrix;
uniform mat4 mvMatrix;
uniform mat4 vMatrix;

uniform mat3 normalMatrix;
uniform vec3 vLightPosition;
uniform vec3 spotDirection;
uniform bool useTexture;

uniform bool    fogEnabled;
uniform float   minFogDistance;
uniform float   maxFogDistance;

in vec4 vVertex;
in vec3 vNormal;
in vec2 vTexCoord;

smooth out vec3     vVaryingNormal;
smooth out vec3     vVaryingLightDir;
smooth out vec2     vVaryingTexCoords;
smooth out float    fogFactor;

smooth out vec4     vertPos_ec;
smooth out vec4     lightPos_ec;
smooth out vec3     spotDirection_ec;

void main() {
    // Surface normal in eye coords
    vVaryingNormal = normalMatrix * vNormal;

    vec4 vPosition4 = mvMatrix * vVertex;
    vec3 vPosition3 = vPosition4.xyz / vPosition4.w;

    vec4 tLightPos4 = vMatrix * vec4(vLightPosition, 1.0);
    vec3 tLightPos  = tLightPos4.xyz / tLightPos4.w;

    // Diffuse light
    // Vector to light source (do NOT normalize this!)
    vVaryingLightDir = tLightPos - vPosition3;

    if(useTexture) {
        vVaryingTexCoords = vTexCoord;
    }

    lightPos_ec = vec4(tLightPos, 1.0f);
    vertPos_ec = vec4(vPosition3, 1.0f);

    // Transform the light direction (for spotlights) 
    vec4 spotDirection_ec4 = vec4(spotDirection, 1.0f);
    spotDirection_ec = spotDirection_ec4.xyz / spotDirection_ec4.w; 
    spotDirection_ec = normalMatrix * spotDirection;

    // Projected vertex
    gl_Position = mvpMatrix * vVertex;

    // Fog factor
    if(fogEnabled) {
        float len = length(gl_Position);
        fogFactor = (len - minFogDistance) / (maxFogDistance - minFogDistance);
        fogFactor = clamp(fogFactor, 0, 1);
    }   
} 
```

这是我在**片段着色器**中使用的代码：

```
#version 330

uniform vec4 globalAmbient;

// ADS shading model
uniform vec4 lightDiffuse;
uniform vec4 lightSpecular;
uniform float lightTheta;
uniform float lightPhi;
uniform float lightExponent;

uniform int shininess;
uniform vec4 matAmbient;
uniform vec4 matDiffuse;
uniform vec4 matSpecular;

// Cubic attenuation parameters
uniform float constantAt;
uniform float linearAt;
uniform float quadraticAt;
uniform float cubicAt;

// Texture stuff
uniform bool useTexture;
uniform sampler2D colorMap;

// Fog
uniform bool    fogEnabled;
uniform vec4    fogColor;

smooth in vec3  vVaryingNormal;
smooth in vec3  vVaryingLightDir;
smooth in vec2  vVaryingTexCoords;
smooth in float fogFactor;
smooth in vec4  vertPos_ec;
smooth in vec4  lightPos_ec;
smooth in vec3  spotDirection_ec;

out vec4 vFragColor;

// Cubic attenuation function
float att(float d) {
    float den = constantAt + d * linearAt + d * d * quadraticAt + d * d * d * cubicAt;

    if(den == 0.0f) {
        return 1.0f;
    }

    return min(1.0f, 1.0f / den);
}

float computeIntensity(in vec3 nNormal, in vec3 nLightDir) {

    float intensity = max(0.0f, dot(nNormal, nLightDir));
    float cos_outer_cone = lightTheta;
    float cos_inner_cone = lightPhi;
    float cos_inner_minus_outer = cos_inner_cone - cos_outer_cone;

    // If we are a point light
    if(lightTheta > 0.0f) {
        float cos_cur = dot(normalize(spotDirection_ec), -nLightDir);
        // d3d style smooth edge
        float spotEffect = clamp((cos_cur - cos_outer_cone) / 
                                cos_inner_minus_outer, 0.0, 1.0);
        spotEffect = pow(spotEffect, lightExponent);
        intensity *= spotEffect;
    }   

    float attenuation = att( length(lightPos_ec - vertPos_ec) );
    intensity *= attenuation;

    return intensity;
}

/**
 *  Phong per-pixel lighting shading model.
 *  Implements basic texture mapping and fog.
 */
void main() {       
    vec3 ct, cf;
    vec4 texel;
    float at, af;

    if(useTexture) {
        texel = texture2D(colorMap, vVaryingTexCoords); 
    } else {
        texel = vec4(1.0f);
    }

    ct = texel.rgb;
    at = texel.a;

    vec3 nNormal = normalize(vVaryingNormal);
    vec3 nLightDir = normalize(vVaryingLightDir);

    float intensity = computeIntensity(nNormal, nLightDir); 
    cf = matAmbient.rgb * globalAmbient.rgb + intensity * lightDiffuse.rgb * matDiffuse.rgb;    
    af = matAmbient.a * globalAmbient.a + lightDiffuse.a * matDiffuse.a;

    if(intensity > 0.0f) {
        // Specular light
        //  -   added *after* the texture color is multiplied so that
        //      we get a truly shiny result
        vec3 vReflection = normalize(reflect(-nLightDir, nNormal));
        float spec = max(0.0, dot(nNormal, vReflection));
        float fSpec = pow(spec, shininess) * lightSpecular.a;
        cf += intensity * vec3(fSpec) * lightSpecular.rgb * matSpecular.rgb;
    }

    // Color modulation
    vFragColor = vec4(ct * cf, at * af);

    // Add the fog to the mix
    if(fogEnabled) {
        vFragColor = mix(vFragColor, fogColor, fogFactor);
    }
} 
```

什么数学错误可能导致这种失真？

## 编辑1：

我已经更新了着色器代码。现在正在片段着色器中计算衰减，因为它一直都应该这样做。不过，它目前已被禁用 - 该错误与衰减没有任何关系。当*仅*渲染灯光的衰减因子时（参见片段着色器的最后几行），衰减正在被*正确*计算。这意味着灯光位置正在正确地转换为眼睛坐标，因此它不能成为错误的来源。

片段着色器的最后几行可用于一些（有点骇人听闻但仍然很有见地）的调试 - 似乎没有按片段计算光的强度，尽管我不知道为什么。

有趣的是，此错误仅在（非常）大的四边形（例如图像中的地板）上很明显。在小型模型上并不明显。

## 编辑2：

我已将着色器代码更新为工作版本。现在一切都很好，我希望它可以帮助任何未来的用户阅读这篇文章，因为截至今天，我还没有看到任何 glsl 教程实现完全没有固定功能和秘密隐式变换的灯​​光（例如`gl_LightSource[i].*`对眼睛空间的隐式变换）。

我的代码在 BSD 2 条款许可下获得许可，[可以在 GitHub 上找到](https://github.com/AndreiBarsan/Yeti)！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T11:52:40.937

我最近遇到了一个类似的问题，当使用大多边形时，照明工作有些错误。问题是在顶点着色器中对眼睛向量进行归一化，因为插值归一化值会产生不正确的结果。

改变

```
vVaryingLightDir = normalize( tLightPos - vPosition3 ); 
```

至

```
vVaryingLightDir = tLightPos - vPosition3; 
```

在你的顶点着色器中。您可以在片段着色器中保持标准化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T12:14:00.003

只是因为我注意到：

```
vec3 tLightPos = (vMatrix * vec4(vLightPosition, 1.0)).xyz; 
```

您只是在这里消除了齐次坐标，而没有先对其进行划分。这会导致一些问题。

# c# - 后面代码中的空异常

> ID：14114454
> 
> 赞同：0
> 
> 时间：2013-01-01T21:38:45.077
> 
> 标签：c#, nullreferenceexception

我收到一个空异常。你能帮我理解为什么吗？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Collections;
using System.Data;
using System.Data.SqlClient;

namespace ProjectEta
{
    public partial class File_Viewer : System.Web.UI.Page
    {
        public string CurDate = DateTime.Today.ToString("dd/MM/yyyy");

        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void ListView1_ItemDataBound(object sender, ListViewItemEventArgs e)
        {
            if (e.Item.ItemType == ListViewItemType.DataItem)
            {

                TextBox OpenDateTextBox = (TextBox)e.Item.FindControl("OpenDateTextBox");

                OpenDateTextBox.Text = "12/12/2012";

                DataRowView rowView = e.Item.DataItem as DataRowView;
                string myCurDate = rowView["OpenDate"].ToString();
            }

        }

    }
} 
```

这里是aspx。

```
<InsertItemTemplate>
            <tr style="font-size: smaller; text-align: center;">
                <td>
                    <asp:Button ID="InsertButton" runat="server" CommandName="Insert" Text="Insert" />
                    <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" Text="Clear" />
                </td>
                <td>&nbsp</td>
                <td>
                    <asp:DropDownList ID="ProcessorIdDrop" runat="server" DataSourceID="UserNames" DataTextField="Name" Text='<%# Bind("ProcessorId") %>' ></asp:DropDownList>
                </td>
                <td>
                    <asp:DropDownList ID="DropDownList4" runat="server" DataSourceID="UserNames" DataTextField="Name" Text='<%# Bind("UnderwriterId") %>' ></asp:DropDownList>
                </td>
                <td>
                    <asp:DropDownList ID="DropDownList5" runat="server" DataSourceID="FileStatusTypes" DataTextField="FileStat" Text='<%# Bind("Status") %>' ></asp:DropDownList>

                </td>
                <td>
                    <asp:TextBox ID="OpenDateTextBox" runat="server" Text='<%# Bind("OpenDate") %>' />
                </td>
                <td>
                    <asp:Label ID="CloseDateTextBox" runat="server" Text='<%# Eval("CloseDate") %>' />
                </td>
                <td>
                    <asp:TextBox ID="BorrowerIdTextBox" runat="server" Text='<%# Bind("BorrowerId") %>' />
                </td>
                <td>
                <asp:DropDownList ID="Lender_LenderIdDrop" runat="server" DataSourceID="LenderNames" DataTextField="Name" DataValueField="Name" Text='<%# Bind("Lender_LenderId") %>'></asp:DropDownList>
                </td>
                <td>
                    <asp:TextBox ID="Client_ClientIdTextBox" runat="server" Text='<%# Bind("Client_ClientId") %>' />
                </td>
            </tr>
        </InsertItemTemplate> 
```

我遵循了这篇文章的建议，[如何从后面的代码中设置列表视图中的标签文本，](https://stackoverflow.com/questions/8063311/how-to-set-label-text-inside-listview-from-code-behind)但我得到一个“对象引用未设置为对象的实例”。我想因为 OpenDateTextBox 是 aspx 中文本框的 ID，所以我不会遇到这个问题。我知道这是一个菜鸟问题，但我们将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:54:02.843

你得到了，`NullReferenceException`因为`TextBox`不在里面，`ItemTemplate`而是在里面`InsertItemTemplate`。所以你必须检查`ListViewItemType.InsertItem`而不是`DataItem`：

```
protected void ListView1_ItemDataBound(object sender, ListViewItemEventArgs e)
{
    // note the ListViewItemType.InsertItem !!!
    if (e.Item.ItemType == ListViewItemType.InsertItem)
    {

        TextBox OpenDateTextBox = (TextBox)e.Item.FindControl("OpenDateTextBox");
        OpenDateTextBox.Text = "12/12/2012";
    }
} 
```

另请注意，我已删除这些行：

```
DataRowView rowView = e.Item.DataItem as DataRowView;
string myCurDate = rowView["OpenDate"].ToString(); 
```

既然没有`DataItem`在`InsertItemTemplate`（当然）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T00:34:37.167

真正的问题似乎是事件的选择。我从 ItemDataBound 更改为 ItemCreated ，它工作得很好。感谢那些提供指导的人。

# wpf - 在 wpf 中创建两个 ComboboxItems 函数时，对象引用未设置为对象的实例

> ID：14114455
> 
> 赞同：0
> 
> 时间：2013-01-01T21:38:49.890
> 
> 标签：wpf, combobox, nullreferenceexception

我在这里完全没有想法

问题是我使用两个组合框，我想从两个组合框中获取值以在 wpf 中的 DataGrid 中显示内容。

我有这个函数可以从两个组合框中获取值。这很好用。

```
private void cboxYearChange(object sender, SelectionChangedEventArgs e)
    {
        ComboBoxItem typeItemYear = (ComboBoxItem)comboBox2.SelectedItem;
        string valueYear = typeItemYear.Content.ToString();

        ComboBoxItem typeItemMonth = (ComboBoxItem)comboBox1.SelectedItem;
        string valueMonth = typeItemMonth.Content.ToString();
} 
```

但后来我想创建另一个函数来检查另一个组合框的更改：

```
private void cboxMonthChange(object sender, SelectionChangedEventArgs e)
    {
        ComboBoxItem typeItemYear = (ComboBoxItem)comboBox2.SelectedItem;
        string valueYear = typeItemYear.Content.ToString();

        ComboBoxItem typeItemMonth = (ComboBoxItem)comboBox1.SelectedItem;
        string valueMonth = typeItemMonth.Content.ToString();

} 
```

我可以构建，但是当我运行它时，我得到 Object reference not set to an instance on the ComboBoxItem typeItemYear = (ComboBoxItem)comboBox2.SelectedItem; cboxMonthChange 函数中的行

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:50:47.520

SelectedItem 在选择某项之前为空。除非它们同时更改（这是不可能的，因为这些事件是按顺序触发的），comboBox1.SelectedItem 或 comboBox2.SelectedItem 上的类型转换都会引发异常。

检查 SelectedItem 是否设置了方法。或使用其他演员表，例如：

ComboBoxItem item1 = comboBox1.SelectedItem as ComboBoxItem; if (item1 != null) { // 做某事 }

希望这可以帮助 ：-）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:56:53.547

1) 尽可能不要在代码中引用控件的名称。
因此，例如，您可以通过将 转换`Sender`为`ComboBox`.
2）但在这种简单的情况下，只需使用公共属性并将它们绑定到您的 ComboBox ：所有操作都无需代码即可完成。

```
<ComboBox x:Name="YearSelectCB" SelectedItem="{Binding SelectedYear}">
<ComboBox x:Name="MonthSelectCB" SelectedItem="{Binding SelectedMonth}"> 
```

（您可以通过多种方式设置窗口的 DataContext，例如在窗口加载的事件处理程序 (DataContext=this) 中）

# javascript - fadeIn 前的预对焦输入框

> ID：14114459
> 
> 赞同：1
> 
> 时间：2013-01-01T21:39:21.270
> 
> 标签：javascript, jquery, html, textinput

我有两个`input`领域。第二个`input`开始专注。然后我想要`fadeOut`两个`input`s，让第二个`input`保持专注直到结束。最后，我想`fadeIn`同时`input`以第*一个* `input`焦点结束。

但是，我不想看到“故障”，当第二个`input`在`fadeIn`完成后立即聚焦，然后第一个`input`立即聚焦。

这是我尝试过的（见小提琴[here](http://jsfiddle.net/6t2y2/3/)）：

```
// Focus the second input field
$('input').eq(1).focus();

// Fade out both input fields
$('div').fadeOut();

// Fade in both input fields
$('div').fadeIn(function () {
    // Causes a "transition glitch"
    $('input').eq(0).focus();
}); 
```

​有没有办法“预聚焦”第二个`input`领域？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T21:54:54.993

怎么样：

```
// Focus the second input field
$('input').eq(1).focus();

// Fade out both input fields
$('div').animate({'opacity': 0}, function() {
    $('input').eq(0).focus();

    // Fade in both input fields
    $('div').animate({'opacity': 1});​
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T21:50:37.443

而不是使用`fadeout`which 将`display`属性更改为`none`（并阻止焦点），您可以`animate`：`opacity`

```
// Focus the second input field
$('input').eq(1).focus();

// Fade out both input fields
$('div').animate({opacity: 0}, function () {
    // focus the first field once they are invisible
    $('input').eq(0).focus();
});

// Fade in both input fields
$('div').animate({opacity: 1}); 
```

​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T21:51:15.790

诀窍是您不能将焦点设置到未在 dom 中呈现的元素（`display: none`发生在 fadeOut 之后）。所以在淡出完成后，使其可见，聚焦，不可见，然后淡入。不会有闪烁，因为函数中的 DOM 操作都发生在浏览器渲染之前。

```
// Focus the second input field
$('input').eq(1).focus();

// Fade out both input fields
$('div').fadeOut(500, function() {
    // Make the input visible in the dom
    $('div').show();
    // set the focus
    $('input').eq(0).focus();
    // make it invisible again, then start the fade in
    $('div').hide().fadeIn();
});
​ 
```

[http://jsfiddle.net/b5faq/2/](http://jsfiddle.net/b5faq/2/)

或者你动画不透明度而不是淡出

# visual-studio - Roslyn 代码重构 VSIX 项目——如何向 VSIX 添加更多内容？

> ID：14114462
> 
> 赞同：2
> 
> 时间：2013-01-01T21:39:45.567
> 
> 标签：visual-studio, vsix, roslyn

我已经通过代码重构 (CodeRefactoringProvider) roslyn 项目创建了一个具有一些不错的重构功能的 Visual Studio 扩展，但在添加工具提示或菜单项或在启动时执行某些操作方面并没有真正的任何东西。

如果我想做一些事情，比如添加一个设置菜单或告诉用户他们正在使用试用版，我什至可以/什么时候做呢？即使我在 vsix 中工作，事件似乎也没有暴露**在任何地方**。

CodeRefactoringProviders 是否在沙箱中运行？因为我喜欢它使用我的课程的方式，向用户显示预览并且它非常适合编辑器，但是我当然想要更多的控制，因为毕竟，你创建的根是 VSIX，它几乎可以做任何事情在视觉工作室环境中。

我确信我可以限制重构次数并显示一个弹出窗口。但我相当肯定人们会发送死亡威胁。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-26T06:36:22.790

您可以像在 Roslyn vsix 中的任何其他 vsix 中一样添加其他元素。有多种方法可以做到这一点，例如创建 Visual Studio 包、使用`ITextViewCreationListener`.

我创建的一个示例展示了如何在[http://code.msdn.microsoft.com/windowsdesktop/Roslyn-Code-Issue-with-84d792dd](http://code.msdn.microsoft.com/windowsdesktop/Roslyn-Code-Issue-with-84d792dd)将工具选项页面与 Roslyn 代码问题集成。

# php - Paypal IPN - 发布变量

> ID：14114463
> 
> 赞同：1
> 
> 时间：2013-01-01T21:39:49.173
> 
> 标签：php, paypal, paypal-ipn

该代码一直有效，直到检查编号 3，然后当我将它们导入数据库时​​，我得到一个空白行或有时什么也没有。当我使用

> if ($_SERVER['REQUEST_METHOD'] != "POST") die ("No Post Variables");

顶部的代码，我得到“无后变量”，但我可以使用后变量来检查是否有问题。我看到从 ipn 返回的 item 变量，因为我可以使用它们，但是当我将它们导入数据库时​​，它们不会出现。

为什么我不能将它们添加到数据库中？

我已经在这个 IPN 上工作了一周，但没有结果。

```
 if ($_SERVER['REQUEST_METHOD'] != "POST") die ("No Post Variables"); 

    $req = 'cmd=_notify-validate';

    foreach ($_POST as $key => $value) {
        $value = urlencode(stripslashes($value));
        $req .= "&$key=$value";
    }

    $url = "https://sandbox.paypal.com/cgi-bin/webscr";
    //$url = "https://www.paypal.com/cgi-bin/webscr";
    $curl_result=$curl_err='';
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,$url);

    curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $req);
    curl_setopt($ch, CURLOPT_HTTPHEADER array("Content-Type: application/x-www-form-urlencoded", "Content-Length: " . strlen($req)));
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
    curl_setopt($ch, CURLOPT_HTTPHEADER, array('Connection: Close'));
    curl_setopt($ch, CURLOPT_HEADER , 0);   
    curl_setopt($ch, CURLOPT_VERBOSE, 1);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);

    curl_setopt($ch, CURLOPT_TIMEOUT, 30);
    $curl_result = @curl_exec($ch);
    $curl_err = curl_error($ch);
    curl_close($ch);

    $req = str_replace("&", "\n", $req); 

    // Check Number 1 ------------------------------------------------------------------------------------------------------------
    $receiver_email = $_POST['receiver_email'];
    if ($receiver_email != "samuel_1347268213_biz@hotmail.com") {
        $message = "Investigate why and how receiver email is wrong. Email = " . $_POST['receiver_email'] . "\n\n\n$req";
        mail("@hotmail.com", "Receiver Email is incorrect", $message, "From: samuel_1347268213_biz@hotmail.com" );
        exit(); // exit script
    }
    // Check number 2 ------------------------------------------------------------------------------------------------------------
    if ($_POST['payment_status'] != "Completed") {
        // Handle how you think you should if a payment is not complete yet, a few scenarios can cause a transaction to be incomplete
        mail("@hotmail.com", "payment_status", $message, "From: samuel_1347268213_biz@hotmail.com" );
    }

    // Connect to database ------------------------------------------------------------------------------------------------------
    require_once 'connect_to_mysql.php';

    // Check number 3 ------------------------------------------------------------------------------------------------------------
    $payer_email = $_POST['payer_email'];
    $sql = mysql_query("SELECT * FROM transactions WHERE payer_email= '".$payer_email."' LIMIT 1");
    $numRows = mysql_num_rows($sql);
    if ($numRows > 0) {
        $message = "Duplicate transaction ID occured so we killed the IPN script. \n\n\n$req";
        mail("@hotmail.com", "Duplicate txn_id in the IPN system", $message, "From: samuel_1347268213_biz@hotmail.com" );
        exit(); // exit script

$txn = $_POST['txn_id'];

$payer = $_POST['payer_email'];

$l = "INSERT INTO  transactions (txn_id,payer_email)VALUES ('".$txd ."','".$payer ."')";

mysql_query($l)or die;

// Mail yourself the details
$req .= "\n\nDataverified from Paypal!";
mail("@hotmail.com", "NORMAL IPN+++ RESULT", $req, "From: samuel_1347268213_biz@hotmail.com"); 
```

# html - WordPress生成无效标记，如何删除它？

> ID：14114465
> 
> 赞同：4
> 
> 时间：2013-01-01T21:40:24.390
> 
> 标签：html, wordpress, validation, markup

您好我正在尝试使用以下代码在其元部分中获取与帖子关联的类别：

```
<div>FILED AS: <span class="gf-post-meta-result"><?php the_category(' &bull; ') ?></span></div> 
```

**WordPress 生成的标记为：**

```
<div>FILED AS: <span class="gf-post-meta-result"><a href="http://localhost/test/category/uncategorized/" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a></span></div> 
```

**问题：**

`rel="category tag"`wordpress 生成的这一部分使我的代码无效。W3c Validator 抛出一个错误说：

***元素 a 上的属性 rel 的值类别标记错误：字符串类别不是已注册的关键字或绝对 URL。路径组件中的空格。使用 %20 代替空格。***

```
…w all posts in Uncategorized" rel="category tag">Uncategorized</a></span></div> 
```

**知道如何纠正这个问题吗？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T13:19:26.283

这两个`rel`值**不是**无效的。验证器不是最新的。

*   `tag`[在 HTML5 规范](http://www.w3.org/TR/html5/links.html#link-type-tag)中定义。
*   `category`[正式](http://microformats.org/wiki/existing-rel-values#HTML5_link_type_extensions)注册。

所以使用这些值是没有问题的。验证器将来可能会赶上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T22:08:39.717

只需将以下代码粘贴到`functions.php`主题文件夹中的文件中

```
function remove_category_rel($output)
{
    $output = str_replace(' rel="category tag"', '', $output);
    return $output;
}
add_filter('the_category', 'remove_category_rel'); 
```

# regex - 检查行是否匹配正则表达式

> ID：14114466
> 
> 赞同：0
> 
> 时间：2013-01-01T21:40:30.027
> 
> 标签：regex, vb.net, io

我有一个由服务器生成的文件 - 我无法控制该文件是如何生成或格式化的。我需要检查每一行都以设定长度的字符串开头（在本例中为 21 个数字字符）。如果一行与该条件不匹配，我需要将其连接到上一行，并在读取并更正整个文件后，保存它。我正在为目录中的很多文件执行此操作。

到目前为止，我有：

```
 Dim rgx As New Regex("^[0-9]{21}$")

        Dim linesList As New List(Of String)(File.ReadAllLines(finfo.FullName))

        If linesList(0).Contains("BlackBerry Messenger") Then
            linesList.RemoveAt(0)
            For i As Integer = 0 To linesList.Count
                  If Not rgx.IsMatch(i.ToString) Then
                        linesList.Concat(linesList(i-1))
                 End If

            Next
        End If
        File.WriteAllLines(finfo.FullName, linesList.ToArray())[code] 
```

在该代码块之前和之后有一个 for 语句来循环遍历源目录中的所有文件，它工作正常。

希望这不是太糟糕的阅读：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:45:07.447

我认为您的解决方案没有任何好处，您在连接线路时失败了。这是一种不同的方法：

```
Dim rgx As New Regex("^[0-9]{21}")
Dim linesList As New List(Of String)(File.ReadAllLines(finfo.FullName))

' We will create a new list to store the new lines data
Dim newLinesList As New List(Of String)()

If linesList(0).Contains("BlackBerry Messenger") Then
    Dim i As Integer = 1
    Dim newLine As String
    While i < linesList.Count
        newLine = linesList(i)
        i += 1

        ' Keep going until the "real" line is over
        While i < linesList.Count AndAlso Not rgx.IsMatch(linesList(i))
            newLine += linesList(i)
            i += 1
        End While

        newLinesList.Add(newLine)
    End While
End If

File.WriteAllLines(finfo.FullName, newLinesList.ToArray()) 
```

# c++ - C++ 构造函数运行时/编译时

> ID：14114472
> 
> 赞同：1
> 
> 时间：2013-01-01T21:41:06.503
> 
> 标签：c++, dynamic, constructor, runtime, compile-time

据我所知，我们可以在运行时或编译时创建对象。例如

```
SomeType object1;
SomeType *object2 = new SomeType; 
```

所以我认为在这里的代码中；

```
int main(){

    cout << "lalalal";
    SomeType object1;
} 
```

应该为 object1 调用构造函数，然后 lalalal 应该出现在屏幕上。因为编译器在程序启动之前分配内存。那么我在什么时候错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T21:43:15.537

> 据我所知，我们可以在运行时或编译时创建对象。

并不真地。在您的代码示例中，第一个对象是使用*自动*存储持续时间创建的（通常描述为“在堆栈上”），第二个对象是使用~~*分配*~~ *的动态*存储持续时间创建的（通常描述为“在堆上”）。但这些都发生在运行时。

> 应该为 object1 调用构造函数，然后 lalalal 应该出现在屏幕上。

函数中的语句从上到下执行（显然不包括循环）。所以对象是第二个创建的。^*

> 因为编译器在程序启动之前分配内存。

是的，内存可能是提前分配的。但就可*观察到*的影响而言，这无关紧要。

* * *

[* 但是，由于您没有在字符串中包含换行符，您*可能*会看到行缓冲的效果；在许多系统上，直到收到换行符或程序终止才会显示输出。]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:19:38.453

首先，C++ 中有两个独立的概念：存储持续时间和对象生命周期。虽然存储持续时间不能短于对象的生命周期，但反过来不一定正确。其次，两者都是运行时概念，而不是编译时。

但是，在这种情况下，没有真正的区别。对象的存储持续时间和生命周期都`object1`在定义执行时开始，并在超出范围时结束。事实上，大多数编译器会在函数顶部为局部变量分配所有内存，但这仅仅是因为符合标准的程序无法判断它不是在定义时分配的。然而，任何影响程序可观察行为的事情都必须在标准规定它应该发生时发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T21:49:27.150

不，`object1`在您的示例中不是在编译时“创建”的，它是在运行时创建的，就像其他对象一样。而且，`object1`在命令执行之后是“构造”的`cout`，因此它的构造函数是在之后执行的。不过，它的内存可能在此之前已分配。

# twitter-bootstrap - 同一页面上的两个引导输入，具有两个不同的源函数

> ID：14114477
> 
> 赞同：5
> 
> 时间：2013-01-01T21:41:37.890
> 
> 标签：twitter-bootstrap, bootstrap-typeahead

我希望两个不同的文本输入具有预先输入功能，每个输入都有不同的源函数。例如，一个获取 first_names，另一个获取 last_names。

这是它的外观，但它不起作用：

```
$('#first_name').typeahead({
    source: function (query, process) {
        $.get('/users/typeahead-first-name', { term: query }, function (data) {
            return process(JSON.parse(data));
        });
    }
});

$('#last_name').typeahead({
    source: function (query, process) {
        $.get('/users/typeahead-last-name', { term: query }, function (data) {
            return process(JSON.parse(data));
        });
    }
}); 
```

第一个预输入工作正常。但是，第二个，当我开始输入并且选项开始出现时，然后我单击一个选项，下拉列表刚刚关闭并且没有值被插入到输入字段中。

有人知道如何让它工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-04T20:26:03.930

这可能有点晚了，但我在自己的应用程序中遇到了同样的问题。解决方案是添加“名称”属性，如下所示：

```
$('#first_name').typeahead({
    name: 'first_name',
    source: function (query, process) {
        $.get('/users/typeahead-first-name', { term: query }, function (data) {
            return process(JSON.parse(data));
        });
    }
});

$('#last_name').typeahead({
    name: 'last_name',
    source: function (query, process) {
        $.get('/users/typeahead-last-name', { term: query }, function (data) {
            return process(JSON.parse(data));
        });
    }
}); 
```

只要它们不同，我在代码中如何称呼它们并不重要。这也很有意义，因为预先输入会保留响应的缓存。（虽然我原以为他们只是将缓存绑定到您要绑定的实例，但是......）

# sql-server - 多星模式

> ID：14114478
> 
> 赞同：0
> 
> 时间：2013-01-01T21:41:46.833
> 
> 标签：sql-server, tsql, relational-database, database-schema

我一直在为一个问题苦苦挣扎，但仍然不确定我的解决方案是否可以，请帮忙。我有一个事实表，可以说 PointsTable。该表的目的是计算每个人有多少积分。我的问题是您以多种方式获得积分，我必须跟踪（有一个维度表）。因此，您可以通过以下方式获得和减少积分：购买它们 ( **PurchaseTable** )
转让它们 ( **TransferTable** )
出售它们 ( **SalesTable** )
等。
我的解决方案我有一个事实表 (PointsTable)，并且我有许多外键列。结构如下所示：
**PointsTable:**
PointsTable_ID
PointsTable_points
PointsTable_date
PointsTable_Reason（买、转、卖）
PurchaseTable_ID
TransferTable_ID
SalesTable_ID

根据每个原因，ID 列填充了正确的数据，但其余 ID 字段留空。是否有另一种解决此问题的方法，没有空白字段？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T21:57:12.850

您不能将外键留空。为您想留空的每个 ID 在事实表中输入 0 或 -1。每个维度都有一行键控为 0 或 -1，表示没有发生事务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T22:29:55.423

很难用很少的信息对模型进行评估。

是否可以通过组合表来构建单个维度表：购买、转移和销售？此维度表中可能有一个字段指示“P、F 或 S”。

然后您的事实表包含该维度表的单个外键（无空白字段）？

# java - 使用 URL.openConnection() 建立 HTTPS 连接

> ID：14114480
> 
> 赞同：14
> 
> 时间：2013-01-01T21:41:52.310
> 
> 标签：java, android, https, bouncycastle, keystore

我正在尝试与证书设置为 2013 年 4 月到期并使用 GlobalSign 作为根证书的[服务器建立 HTTPS 连接。](https://www.onlinescoutmanager.co.uk)

```
HttpsURLConnection urlConnection = (HttpsURLConnection) url.openConnection();
// urlConnection.setSSLSocketFactory(sslSocketFactory);
urlConnection.setDoOutput(true);
urlConnection.setChunkedStreamingMode(0);

// Send the POST data
OutputStream out = new BufferedOutputStream(urlConnection.getOutputStream());
out.write(postParamString.toString().getBytes("UTF8"));

// Read the reply
InputStream in = urlConnection.getInputStream(); 
```

`javax.net.ssl.SSLHandshakeException: org.bouncycastle.jce.exception.ExtCertPathValidatorException: Could not validate certificate signature.`就目前而言，这在`getOutputStream()`被调用时抛出。

此相同站点和证书在股票 HTC 网络浏览器和桌面浏览器中有效。当我使用相同的代码访问[Google](https://www.google.co.uk)时，它​​可以工作（但随后抱怨 404 错误）。StackOverflow 上的各种帖子暗示它应该“正常工作”，其他人说设置自己的密钥存储（或禁用所有 HTTPS 验证！）我认为行为差异取决于使用的不同根密钥存储（谁能澄清这一点？）。

我现在尝试使用充气城堡创建密钥存储，但无法将其加载到我的设备上。

从 Firefox 导出证书后，我使用以下命令创建密钥库：

```
keytool.exe -import -alias onlinescoutmanager -file www.onlinescoutmanager.co.uk.crt -storetype BKS -keystore res\raw\keystore 
```

然后使用以下方法在应用程序中加载和使用它：

```
InputStream stream = context.getResources().openRawResource(R.raw.keystore);
// BKS seems to be the default but we want to be explicit
KeyStore ks = KeyStore.getInstance("BKS");
ks.load(stream, "www.onlinescoutmanager.co.uk".toCharArray());
stream.close();

TrustManagerFactory tmf = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
tmf.init(ks);
X509TrustManager defaultTrustManager = (X509TrustManager) tmf.getTrustManagers()[0];
SSLContext context2 = SSLContext.getInstance("TLS");
context2.init(null, new TrustManager[] { defaultTrustManager }, null);
sslSocketFactory = context2.getSocketFactory(); 
```

`java.io.IOException: Wrong version of key store.`这在何时`keystore.Load()`被调用时失败。

我已[确保通过`-storetype BKS`](https://stackoverflow.com/a/5187509/588306)，[使用 <=7 字符密钥库密码](https://stackoverflow.com/a/12528853/588306)，将 CA 证书添加到密钥库，并使用 Bouncy Castle 版本 1.45 和 1.47 创建密钥库，报告的错误消息没有变化。

我的环境是在 Windows 8 上运行 JRE 1.7u9b5 的 Eclipse Juno 4.2.1。我正在测试的设备是运行股票 Android 2.3 的 HTC 感觉。该应用程序的最低 SDK 版本为 7，目标为 15。

如果有人能解释如何在 Windows 8 上创建有效的 BKS 密钥库，或者我如何让 Java 使用与浏览器（或系统？）相同的密钥库，那将不胜感激。

您可以下载撰写本文时的[整个项目，如果需要，还可以下载](https://www.dropbox.com/s/j148u838icm4rk5/SGM.zip)[生成的密钥库](https://www.dropbox.com/s/0cnb8l2m90zyjc3/keystore)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T00:22:29.570

感谢各种人对此的提示，有很多事情都需要正确才能使其正常工作。

1.  如果 HTTPS 站点的证书由受信任的根证书签名，则无需自定义`SSLSocketFactory`. 受信任的根证书可能与浏览器使用的证书不同，因此不要假设如果它在 Android 网络浏览器中工作，那么它将在您的应用程序中工作。
    如果它不是受信任的根证书并且您遇到类似的异常`javax.net.ssl.SSLHandshakeException: org.bouncycastle.jce.exception.ExtCertPathValidatorException: Could not validate certificate signature.`，那么您需要创建并加载一个密钥库，如下所示。

2.  密钥库需要使用 Bouncy Castle 提供程序 ( [1](https://stackoverflow.com/a/5187509/588306) ) 通过`-storetype bks`在`keytool`命令行上指定来生成。
    如果 Bouncy Castle 没有正确安装，那么这将失败并出现各种异常，包括`java.security.KeyStoreException: BKS not found`. 如果密钥库不是使用 Bouncy Castle 提供程序创建的，那么您可能会遇到`java.io.IOException: Wrong version of key store.`异常，从而导致与下一个案例混淆。

3.  您需要使用 Bouncy Castle 提供程序的适当版本（[1](https://stackoverflow.com/a/10809108/588306)、[2](https://stackoverflow.com/a/14116462/588306)、[3](https://stackoverflow.com/a/7002670/588306)）。在大多数情况下，这似乎是[1.46 版本](http://repo2.maven.org/maven2/org/bouncycastle/bcprov-ext-jdk15on/1.46/bcprov-ext-jdk15on-1.46.jar)。
    这可以放入您的 JRE`lib/ext/`文件夹并将类名添加到`lib/security/java.security`，或直接在命令行中指定到`keytool`. 如果它是不兼容的版本（或商店类型），您将再次遇到异常`java.io.IOException: Wrong version of key store.`。

4.  您必须包括所有中介和根证书。如果缺少任何内容，您将获得`javax.net.ssl.SSLHandshakeException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.`异常。

5.  证书链必须是为了正确验证它们。如果不是，您将获得`javax.net.ssl.SSLHandshakeException: org.bouncycastle.jce.exception.ExtCertPathValidatorException: IssuerName(CN=XYZ) does not match SubjectName(CN=ABC) of signing certificate.`或再次获得一个通用的，`javax.net.ssl.SSLHandshakeException: java.security.cert.CertPathValidatorException: Trust anchor for certification path not found.` 我还没有找到在密钥库中对它们进行排序的方法，因此只能[在运行时在代码中进行](https://stackoverflow.com/q/4115101/588306)。

有些人建议[使用超过 7 个字符的密钥库密码](https://stackoverflow.com/a/12528853/588306)也会导致它失败，但我发现不是这样。

我认为这涵盖了我发现的所有陷阱，但请随时扩展并将 linsk 添加到相关问题中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T03:11:26.290

Bouncy Castle 1.47 使用不同的版本标头。你可以试试[1.46 版本](http://repo2.maven.org/maven2/org/bouncycastle/bcprov-ext-jdk15on/1.46/bcprov-ext-jdk15on-1.46.jar)，它应该可以工作。

```
keytool -import -alias onlinescoutmanager -file www.onlinescoutmanager.co.uk.crt -storetype BKS -storepass osmosm -keystore C:/keystore -provider org.bouncycastle.jce.provider.BouncyCastleProvider -providerpath bcprov-ext-jdk15on-1.46.jar 
```

# frameworks - 使用哪个 Web 框架可以很好地与现有的桌面应用程序集成？

> ID：14114482
> 
> 赞同：2
> 
> 时间：2013-01-01T21:42:01.160
> 
> 标签：frameworks, web, web-frameworks

我们目前有一个客户端/服务器桌面 Java 应用程序，在诊所中用于管理患者图表（文本、图形、图像等）。它是一个高度交互的应用程序。

我们现在正尝试逐步向 Web 移动，首先，我们要实现一个新功能，可以从 Java 客户端中的嵌入式浏览器访问。1.嵌入式浏览器应该能够与Java客户端通信。2\. 我们应该能够在服务器端重用我们现有的大部分 Java 类 3\. 框架应该允许我们创建丰富的用户体验（例如用户应该能够在图表上绘制，或拖放项目等，并且不会经历太多延迟）。

如何确定某个 Web 框架是否满足上述所有标准？我们是否必须坚持使用 Java Web 框架，还是可以轻松地涉足 Ruby 或 PHP 相关框架？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:07:29.977

非常有趣的问题，我也想看看其他答案。对我自己来说，几年前我正在构建这样一个应用程序，它为不同的功能区域提供了不同的模块——所有这些模块都在网络上。主要模块是：

1.  基于 JavaWS 的独立应用程序 - 在一台连接到扫描仪的计算机上工作 - 扫描的报告和图像从中上传到服务器
2.  跨越整个网页（100% 宽度/高度）的 Java 小程序 - 用于拖放、患者身体部位图片评论等。
3.  Java 小程序具有独特的树实现来生成 EHR - 具有从服务器下载并缓存在本地计算机上的 ICD 编号和 CPT 代码。
4.  桌面（同样是 java-6）启动 Web 浏览器以查看 Html 报告（Java Html 编辑器对 CSS 不太友好）。
5.  在服务器数据库上维护访问级别（医生、办公室经理、助理、护士和患者的访问级别不同（用于预约和数据更新的门户））

总之，我认为单个应用程序无法满足这样一个系统的所有需求。但是，我也对别人的意见感兴趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T21:47:05.597

这是一个大问题。不可能用简单的“是/否”来回答。

就个人而言，我是 Java 的粉丝……听起来您已经在内部拥有 Java 专业知识。

我会看看 Tomcat（一个相对简单的 servlet 容器）和 JBoss（一个成熟的 Java EE 应用程序，恕我直言，它与 WebLogic 和 WebSphere 等昂贵的应用程序服务器一样健壮）。

如果“Web 应用程序”对您来说是一个新世界，我也会关注 IIS 和 .Net。

根据您的经验和您的应用程序，在您有机会首先考虑 JSP、Java Web 服务与 C#/ADO.Net 之前，我不一定会研究 Ruby 或 PHP *。*

恕我直言...

# c# - 是否为每个导航方法多次触发 webbrowser 导航事件？

> ID：14114483
> 
> 赞同：0
> 
> 时间：2013-01-01T21:42:16.557
> 
> 标签：c#, winforms, events, browser

所以，简短的问题就是这样。

更长的版本：我面临的问题是我在我的应用程序中依赖成对的 webbrowser.navigate 和导航事件，但是对于每个导航方法，导航事件都会被触发多次。似乎 url 是分部分加载的，每个都再次触发事件或类似的东西。可以使用 Document.links 或 HtmlElement 或其他东西再次触发导航吗？

代码就像：

```
 private void btGo_Click(object sender, EventArgs e)
    {
        webBrowser1.Navigate(cboWeb.Text);
    }

  private void webBrowser1_Navigated(object sender, WebBrowserNavigatedEventArgs e)
    {
        foreach (HtmlElement link in webBrowser2.Document.Links)
             doStuff();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:43:14.940

[为什么 WebBrowser_DocumentCompleted() 触发两次？](https://stackoverflow.com/questions/2328835/why-is-webbrowser-documentcompleted-firing-twice?lq=1)

似乎 javascript 或 ajax 或其他脚本（和框架）使其重新加载。感谢回复。

# android - 删除列表视图条目

> ID：14114485
> 
> 赞同：0
> 
> 时间：2013-01-01T21:42:32.650
> 
> 标签：android, sql, listview

我的问题是，在 ListView/Database 中，只有最上面的“评论”被删除，但我想要，被按下的“评论”被删除。

```
@Override
      public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        datasource = new CommentsDataSource(this);
        datasource.open();

        List<Comment> values = datasource.getAllComments();

        // Use the SimpleCursorAdapter to show the
        // elements in a ListView
        ArrayAdapter<Comment> adapter = new ArrayAdapter<Comment>(this,
            android.R.layout.simple_list_item_1, values);
        setListAdapter(adapter);

        this.getListView().setClickable(true);
           this.getListView().setOnItemClickListener(new OnItemClickListener() {
                public void onItemClick(AdapterView<?> parent, View v, int position, long id) {

                    Toast.makeText(MainActivity.this, "postion: " +    getListView().getSelectedItemPosition(), Toast.LENGTH_SHORT).show(); 
```

这是问题所在，即 getcount > 0。

```
 ArrayAdapter<Comment> adapter = (ArrayAdapter<Comment>) getListAdapter();
                    Comment comment = null;
                    if (getListAdapter().getCount() > 0) {
                        comment = (Comment) getListAdapter().getItem(0);
                        datasource.deleteComment(comment);
                        adapter.remove(comment);
                      }
                    return;
                }});
           } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:11:34.800

使用 getItem(0) 总是会删除适配器中的第一项（因此也是列表视图）。

如果要在单击项目时将其删除，请在 onItemClick 中使用以下代码。

```
Comment comment = (Comment) adapter.getItem(position);
datasource.deleteComment(comment);
adapter.remove(comment); 
```

这里的所有都是它的。

# c++ - 在 C++ 中，使用队列和 libcurl 时出现错误

> ID：14114487
> 
> 赞同：0
> 
> 时间：2013-01-01T21:43:04.763
> 
> 标签：c++, http, web-crawler, libcurl

我正在使用 C++ 和 libcurl 来制作 Web Spider。我遇到了一个问题，当我使用队列获取 URL 时，我收到一条错误消息，指出不支持 HTTP。错误是：`http://google.com* Protocol "http not supported or disabled in libcurl* Unsupported protocol`。这是我的代码：

```
#include <iostream>
#include <queue>
#include <curl/curl.h>

std::string data; //will hold the url's contents

size_t writeCallback(char* buf, size_t size, size_t nmemb, void* up)
{ //callback must have this declaration
    //buf is a pointer to the data that curl has for us
    //size*nmemb is the size of the buffer

    for (int c = 0; c<size*nmemb; c++)
    {
        data.push_back(buf[c]);
    }
    return size*nmemb; //tell curl how many bytes we handled
}

int main(int argc, const char * argv[])
{
    std::queue<std::string> Q;
    Q.push("http://google.com");

    while (!Q.empty()) {
        std::string url = Q.front();
        std::cout << Q.front();
        CURL* curl; //our curl object

        curl_global_init(CURL_GLOBAL_ALL); //pretty obvious
        curl = curl_easy_init();

        curl_easy_setopt(curl, CURLOPT_URL, &url);
        curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, &writeCallback);
        curl_easy_setopt(curl, CURLOPT_VERBOSE, 1L); //tell curl to output its progress

        curl_easy_perform(curl);

        std::cout << std::endl << data << std::endl;
        std::cin.get();

        curl_easy_cleanup(curl);
        curl_global_cleanup();
        data.erase();
        Q.pop();
    }

    return 0;
} 
```

我是 C++ 新手。我应该朝哪个方向寻找解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:50:08.523

这是错误的：

```
curl_easy_setopt(curl, CURLOPT_URL, &url); 
```

这是正确的：

```
curl_easy_setopt(curl, CURLOPT_URL, url.c_str()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T21:51:04.173

[`std::string`](http://en.cppreference.com/w/cpp/string/basic_string)不是`char*`。你不能说

```
curl_easy_setopt(curl, CURLOPT_URL, &url); 
```

因为这`std::string*`是作为一个选项而不是`char*`. 正确的方法是

```
curl_easy_setopt(curl, CURLOPT_URL, url.c_str()); 
```

# scala - 在 Scala 对象构造函数中处理异常

> ID：14114491
> 
> 赞同：2
> 
> 时间：2013-01-01T21:43:32.253
> 
> 标签：scala, lift

我正在尝试使用 Lift JPA，当我引用模型时，它会调用超级构造函数，但我遇到了异常：

```
object Model extends LocalEMF("LiftPersistenceUnit") with RequestVarEM 
```

问题是异常隐藏在这个异常后面：

```
java.lang.NoClassDefFoundError: Could not initialize class... 
```

所以，我的问题是：在这种情况下记录/处理异常的最佳方法是什么？

或者，任何人都可以推荐另一种使用 Lift JPA 的模式吗？模型一直是代码的方式是推荐的方式，但它不是非常用户友好的 IMO。这个想法是有一个可以通过请求 variable.sc 访问的单例实体管理器工厂

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T23:10:18.917

`LocalEMF`我能想到在's 的构造函数之前执行某些东西的唯一方法：

```
class Model(val init: Unit = println("Hai")) 
  extends LocalEMF("LiftPersistenceUnit") with RequestVarEM 
```

`LocalEMF("LiftPersistenceUnit")`也许您可以使用一些非凡的技巧来代理对 的调用，并添加适当的异常日志记录。

**编辑**

我找到了：

```
class LocalEMF(haha: String) { val e = throw new RuntimeException }
trait RequestVarEM

class Model(val init: Unit = println("Hai")) extends { val e = 
  try new LocalEMF("LiftPersistenceUnit") catch {
    case t: Throwable => println("Catched: " + t); throw t
  } 
} with RequestVarEM 
```

# android - Android Disappearing Parts of TextViews 仅显示第一个字符

> ID：14114492
> 
> 赞同：1
> 
> 时间：2013-01-01T21:43:34.583
> 
> 标签：android, scroll, textview, tablelayout

我在表格布局中的 TableRows 中有一些 Textviews。在同一个活动中，我异步加载图像。当我向下滚动以显示图像时，部分文本视图消失，只显示第一个字符。

这里报告了同样的问题： [Android Disappearing Portions of TextViews](https://stackoverflow.com/questions/11895811/android-disappearing-portions-of-textviews/14114272#14114272)

```
 // some code before ....
<TableLayout
   android:id="@+id/table_statistique"
   android:layout_width="match_parent"
   android:layout_height="match_parent"
   android:layout_below="@+id/text_distance_desc"
   android:layout_marginBottom="10dp"
   android:layout_marginLeft="20dp"
   android:layout_marginRight="20dp"
   android:layout_marginTop="10dp"
   android:shrinkColumns="1"
   android:background="@drawable/bg_desc_parcours" >

   <TableRow
       android:id="@+id/tableRow1"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content" >

       <RelativeLayout
           android:layout_width="0dp"
           android:layout_height="wrap_content"
           android:layout_weight="0.5"
           android:background="@drawable/celltable"
           android:paddingBottom="20dp"
           android:paddingTop="20dp" >

           <LinearLayout
               android:id="@+id/layout_vitesse"
               android:layout_width="wrap_content"
               android:layout_height="wrap_content"
               android:layout_centerHorizontal="true"
               android:gravity="center_vertical|center_horizontal"
               android:orientation="horizontal" >

               <ImageView
                   android:layout_width="30dp"
                   android:layout_height="30dp"
                   android:layout_marginRight="8dp"
                   android:src="@drawable/picto_vitesse" />

               <TextView
                   android:id="@+id/vitesse_fiche_historique"
                   android:layout_width="wrap_content"
                   android:layout_height="wrap_content"
                   android:text="5 Km/h"
                   android:textColor="#606060"
                   android:textSize="18sp"
                   android:textStyle="bold" />
           </LinearLayout>

           <TextView
                   android:layout_width="wrap_content"
                   android:layout_height="wrap_content"
                   android:layout_below="@+id/layout_vitesse"
                   android:layout_centerHorizontal="true"
                   android:text="VITESSE"
                   android:textColor="#11639e"
                   android:textSize="8sp"
                   android:textStyle="bold" />
       </RelativeLayout>

       <RelativeLayout
             android:layout_width="0dp"
             android:layout_height="wrap_content"
             android:layout_weight="0.5"
             android:background="@drawable/celltable"
             android:paddingBottom="20dp"
             android:paddingTop="20dp" >

             <LinearLayout
                  android:id="@+id/layout_denivele"
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_centerHorizontal="true"
                  android:gravity="center_vertical|center_horizontal"
                  android:orientation="horizontal" >

                 <ImageView
                      android:layout_width="30dp"
                      android:layout_height="30dp"
                      android:layout_marginRight="8dp"
                      android:src="@drawable/picto_denivile" />

                 <TextView
                      android:id="@+id/denivele_fiche_historique"
                      android:layout_width="wrap_content"
                      android:layout_height="wrap_content"
                      android:text="100 m"
                      android:textColor="#606060"
                      android:textSize="18sp"
                      android:textStyle="bold" />
             </LinearLayout>

             <TextView
                  android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:layout_below="@+id/layout_denivele"
                  android:layout_centerHorizontal="true"
                  android:text="DÉNIVELÉ"
                  android:textColor="#11639e"
                  android:textSize="8sp"
                  android:textStyle="bold" />
        </RelativeLayout>
    </TableRow>
    // seconde row here
</TableLayout> 
```

编辑：我加载文本的代码

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_fiche_historique);

            //... some code here

    distanceFiche = (TextView) findViewById(R.id.distance_fiche_historique);
    deniveleFiche = (TextView) findViewById(R.id.denivele_fiche_historique);
    altitudeFiche = (TextView) findViewById(R.id.altitude_fiche_historique);
    dureeFiche = (TextView) findViewById(R.id.duree_fiche_historique);
    vitesseFiche = (TextView) findViewById(R.id.vitesse_fiche_historique);

            // ... some other code here

    extras = getIntent().getExtras();
    if(extras!=null)
    {
        historique = extras.getParcelable("historique");
        if(historique != null)
        {
              // HERE IS THE CODE
              distanceFiche.setText(historique.getDistance());
             }
      }

          // ... some other code here

} 
```

请问有什么帮助吗？

# ajax - 在 ubuntu 上运行的 rails 应用程序的文件 IO

> ID：14114494
> 
> 赞同：0
> 
> 时间：2013-01-01T21:43:41.247
> 
> 标签：ajax, ruby-on-rails-3, ubuntu, io

*   50 个“netcdf”（栅格数据）文件，大小从 1MB 到 500MB
*   传入给定的 Lat / Lng
*   返回一个 int 值

当前应用程序通过 AJAX 传入 lat/lng。它打开文件，读出输入 lat / lng 的值，然后关闭文件。

我应该这样做吗？或者我应该打开所有文件一次，然后让它们保持打开状态？

lat/lng 是通过点击谷歌地图生成的……每秒可能有 2 个以上的 ajax POST。目前，文件打开和关闭并没有明显崩溃或减慢机器速度......但是我在这种情况下追求最佳实践。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:56:40.953

取决于您拥有的数据以及它将发生多少变化或需要更新。

如果数据不会改变，那么正确的做法是将所有数据提取到数据库中并查询您需要的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:49:28.460

为什么不将文件的内容导入数据库呢？

# python - 默认的 django 模型，其中包含上一个条目中的值

> ID：14114506
> 
> 赞同：0
> 
> 时间：2013-01-01T21:45:08.767
> 
> 标签：python, django, forms, django-models, field

我有一个应该跟踪时间的应用程序，其中一个条目（称为 begin_sec）应该具有（或默认为）前一个条目的变量的值（称为 end_sec）（除非它的第一个条目是特殊情况只会发生一次）。

这是我的模型

```
TimeLog(model.Model);
    begin_sec= models.DateTimeField( auto_now=False,
                                   auto_now_add=False,
                                   default=?
                                   help_text="YYYY-MM-DD HH-MM-SS")
    end_sec = models.DateTimeField( auto_now=False,
                                   auto_now_add=False,
                                   default=?
                                   help_text="YYYY-MM-DD HH-MM-SS")

    ... other parts of the model. 
```

因此，当我添加这种类型的新条目时，我第一次以用户身份打开应用程序时，我可以将开始时间默认为 now()，并且我可以选择 end_sec，但在第二次及以后我想要begin_sec 为/默认为最后一个条目的 end_sec。我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:09:48.857

`default`在这种情况下不要指定值。最好的方法是在模型形式`save`方法中：

```
class TimeLogForm(forms.ModelForm):
    class Meta:
        exclude = ['begin_sec']
        model = TimeLog

    def __init__(self, *args, **kw):
        super(TimeLogForm).__init__(self, *args, **kw)

    def save(self, *args, **kw):
        instance = super(TimeLogForm, self).save(commit=False)
        last_entry = TimeLog.objects.all().order_by('-id')[0]
        if last_entry:
            instance.begin_sec = last_entry.begin_sec
        else:
            # this is the very first record do something
            pass
        instance.save()
        return instance 
```

此外，您不需要为这两个字段设置`auto_now=False`和`auto_now_add=False`，默认情况下它们是`False`.

# c# - 更快地将 2 个连续字节的数组转换为整数

> ID：14114509
> 
> 赞同：4
> 
> 时间：2013-01-01T21:45:43.273
> 
> 标签：c#, .net, mono, boo

我有大量的数据，可能在 50 到 100 兆字节之间变化。我使用 filestreamer 将这些数据作为字节数组读取。

问题是，我想将所有连续的 2 个字节转换为整数。我这样做的方法是循环遍历字节数组，步长为 2，然后使用 BitConvert 进行转换：

```
_data[i] = BitConverter.ToInt16(soundData[i : i + 2], 0) // Convert 2 bytes into an int and store at i 
```

所以每两个字节都会变成一个 Int16。然而，问题是这太慢了，对于大约 50 兆字节的文件，这可能需要 20 秒！

是否有一种通用的方法可以立即执行此操作，而不是在我的数据数组的每 2 个字节上调用此函数，这样它就不会那么慢？最好以“安全”的方式，所以没有不安全的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T22:18:23.850

如果字节数组在正确的 Endian 中，则只需分配一个 Int16 数组并使用 Buffer.Block 复制（空中代码）：

```
byte[] b = new byte[]{1, 2, 3, 4};
short[] s = new short[2]; // 4 bytes long
Buffer.BlockCopy(b, 0, s, 0, 4); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T21:50:45.323

如果没有测试，我不确定我的数学和“字节顺序”是否正确，但另一种选择是尝试这样的事情：

```
// Convert 2 bytes into an int and store at i
_data[j] = (int)soundData[i] + (soundData[i + 1] << 8); 
```

如果这还不够快，那么您可能需要一种不同的方法来解决问题。

对于这个问题可以找到一些其他的想法：[Convert Byte Array to Integer In VB.Net](https://stackoverflow.com/questions/227083/convert-byte-array-to-integer-in-vb-net)

# ruby - 显式接收器的受保护方法错误（Ruby 1.9.3）

> ID：14114513
> 
> 赞同：2
> 
> 时间：2013-01-01T21:47:16.143
> 
> 标签：ruby

在 ruby​​ 1.9.3 中，为什么会`Foo.explicit_receiver`产生“受保护的方法调用”错误？

我正在参考这些教程：

*   [受保护的方法和 Ruby 2.0](http://tenderlovemaking.com/2012/09/07/protected-methods-and-ruby-2-0.html)
*   [Ruby 访问控制——私有和受保护的方法是否只是一个指南？](http://www.skorks.com/2010/04/ruby-access-control-are-private-and-protected-methods-only-a-guideline/)

哪一个州：

> 您始终可以使用隐式接收器调用受保护的方法，就像私有一样，但此外，您可以使用显式接收器调用受保护的方法，只要此接收器是 self 或与 self 相同的类的对象。

我用一个`Foo`实例调用受保护的，这应该允许我调用受保护的方法。我肯定错过了一些东西:)

**代码示例**

```
class Foo
  def implicit_receiver
    protected_method
  end

  def explicit_receiver
    self.protected_method
  end

  def self.explicit_receiver
    Foo.new.tap do |foo|
      foo.protected_method
    end
  end

protected

  def protected_method
    p "called protected method!"
  end
end

foo = Foo.new
foo.implicit_receiver
foo.explicit_receiver
Foo.explicit_receiver

# output
# "called protected method!"
# "called protected method!"
# protected.rb:12:in `explicit_receiver': protected method `protected_method' called for #<Foo:0x10a280978> (NoMethodError) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:59:33.847

受保护的方法可用于同一类或子类的其他实例的实例方法。但是，`explicit_receiver`引发错误的是类（实际上是元类）本身的单例方法，并且无法访问类的受保护实例方法。

您只需运行即可看到这一点：

```
class Foo
  def self.test
    Foo.new.protected_method
  end
end

Foo.test 
```

你会得到一个类似的错误。

在这种情况下令人困惑的是，您正在调用`tap`您创建的实例并且仍然收到此错误。这是因为`tap`块的绑定仍在元类的上下文中，无法访问其类的受保护实例方法 - 您可以检查`self`该块内部以查看这一点。

# path - Django 全新安装 - ImportError: No module named core -- 做 django 教程

> ID：14114515
> 
> 赞同：1
> 
> 时间：2013-01-01T21:47:40.993
> 
> 标签：path, django-admin, installation, core, importerror

我是一名中级 python 程序员，也是 Django 的新手。

在 Windows XP SP3 上：

*   安装了 python msi 2.7.3 -- 好的。
*   已安装 django：setup.py install -- 好的。

```
>>>import sys  
>>>print sys.path  
['', 'C:\\Python27\\Lib\\idlelib', 'C:\\WINDOWS\\system32\\python27.zip', 
'C:\\Python27\\DLLs', 'C:\\Python27\\lib', 'C:\\Python27\\lib\\plat-win', 
'C:\\Python27\\lib\\lib-tk', 'C:\\Python27', 'C:\\Python27\\lib\\site-packages']

>>>import django  
>>>django.get_version()  
(1, 4, 3, 'final', 0)

>>>django.__path__  
['C:\\Python27\\lib\\site-packages\\django']  

>>>django.__file__  
'C:\\Python27\\lib\\site-packages\\django\\__init__.pyc'

>>>import site  
>>>print site.getsitepackages()  
['C:\\Python27', 'C:\\Python27\\lib\\site-packages'] 

>>>print site.getusersitepackages()  
C:\Documents and Settings\Marc\Application Data\Python\Python27\site-packages

>>>from sysconfig import get_config_var  
>>>get_config_var('userbase')  
'C:\\Documents and Settings\\Marc\\Application Data\\Python'

>>>from django.core import management  

Traceback (most recent call last):  
  File "pyshell#27", line 1, in module  
    from django.core import management  
ImportError: No module named core 
```

用户群是问题吗？

（我花了大约 50 小时来探索所有帖子，但
他们建议的所有内容都没有为我工作，因此这篇帖子。顺便说一句，我在 2 台单独的 PC 上尝试了所有这些）。

**更新**，我在这里读到： [Python 模块搜索路径问题](https://stackoverflow.com/questions/1523551/python-module-search-path-problem)

> 简单的规则是`__init__.py`在您希望 Python 识别为包的每个目录中放置一个“

（感谢亚历克斯）

`__init__.py`我开始在每个包含无法加载的模块的目录中放置一个from的副本，`..\django`你知道吗，Django 开始工作了。

我确信这是不正常的：

1.  `python setup.py install`让 Django 准备好了吗？

2.  一年前我用 python 2.6 和 Django 1.3 做 tuts 时，它在我的第一次尝试中起作用，没有修补`__init__.py`，v1.3`__init__.py`在目录中也没有（核心、实用程序等......）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T02:46:19.923

这是不正常的。

该错误来自缺少**__ *init* __** .py 文件。

这是由于**WinZip**没有提取所有**__ *init* __** .py 文件引起的！

使用**7zip ！！**操作系统

# matlab - 在 MATLAB 中显示计算项

> ID：14114520
> 
> 赞同：2
> 
> 时间：2013-01-01T21:47:50.177
> 
> 标签：matlab

一旦我输入了这样的表达式

```
term = a*14*b^2*(1/3*a)^3; 
```

我可以很容易地显示这个术语的计算结果，但是我怎样才能再次显示这个术语呢？

就像是：

```
>> term

term = 

a*14*b^2*(1/3*a)^3; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:00:08.160

您可以改用[内联](http://www.mathworks.com/help/matlab/ref/inline.html)或[匿名](http://www.mathworks.com/help/matlab/matlab_prog/anonymous-functions.html?s_tid=doc_12b)函数。例如：

```
term = @(a,b) a*14*b^2*(1/3*a)^3; 
```

然后说`a=3 ; b=4;`

```
term(a,b)
ans =
   672 
```

和

```
term
    term = 
    @(a,b)a*14*b^2*(1/3*a)^3 
```

或者：

```
term = inline('a*14*b^2*(1/3*a)^3','a','b')

term =

 Inline function:
 term(a,b) = a*14*b^2*(1/3*a)^3

term(a,b)

ans =

   672 
```

或者，您可以搜索命令历史记录：首先使用 MATLAB 的 Java 内部来获取作为字符数组的命令历史记录：

```
history = com.mathworks.mlservices.MLCommandHistoryServices.getSessionHistory;
historyText = char(history); 
```

然后，您可以使用或`historyText`之类的功能进行搜索。或者您可以使用函数创建一个字符串单元数组（每个单元格一行），因为它们有时更容易使用。（感谢@gnovice 最初分享此方法）[`strfind`](http://www.mathworks.com/help/matlab/ref/strfind.html)[`regexpi`](http://www.mathworks.com/help/matlab/ref/regexpi.html)`cellstr`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T21:48:51.747

简单的答案是：你不能。该表达式已被评估。

不过，您可以在命令窗口中按“向上”键来检索以前的命令。

# javascript - javascript闭包中的环境范围

> ID：14114521
> 
> 赞同：2
> 
> 时间：2013-01-01T21:47:53.943
> 
> 标签：javascript, closures

遇到[Mozilla 开发者网络中描述的关闭常见错误](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures#Creating_closures_in_loops.3A_A_common_mistake)

> 它没有按预期工作。无论您关注哪个领域，都会显示有关您年龄的消息。

```
function showHelp(help) {
  document.getElementById('help').innerHTML = help;
}

function setupHelp() {
  var helpText = [
      {'id': 'email', 'help': 'Your e-mail address'},
      {'id': 'name', 'help': 'Your full name'},
      {'id': 'age', 'help': 'Your age (you must be over 16)'}
    ];

  for (var i = 0; i < helpText.length; i++) {
    var item = helpText[i];
    document.getElementById(item.id).onfocus = function() {
      showHelp(item.help);
    }
  }
}

setupHelp(); 
```

它确实提供了解决方案。这是添加另一个闭包。

```
function showHelp(help) {
  document.getElementById('help').innerHTML = help;
}

function makeHelpCallback(help) {
  return function() {
    showHelp(help);
  };
}

function setupHelp() {
  var helpText = [
      {'id': 'email', 'help': 'Your e-mail address'},
      {'id': 'name', 'help': 'Your full name'},
      {'id': 'age', 'help': 'Your age (you must be over 16)'}
    ];

  for (var i = 0; i < helpText.length; i++) {
    var item = helpText[i];
    document.getElementById(item.id).onfocus = makeHelpCallback(item.help);
  }
}

setupHelp(); 
```

MDN给出的解释是因为第二种解决方案创建了3个环境。

谁能给我解释一下，阶段“环境”是什么意思，我怎么知道它的范围？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:01:37.147

当您在函数中使用变量名时，JavaScript 解释器首先检查该变量作为函数中的局部变量。如果不存在这样的局部变量，则它会遍历外部范围以查找该变量。（定义函数时，它可以访问作用域链——作用域的层次结构，从定义它的外部函数的作用域开始，然后继续到包含*该*函数的函数，等等。）

在这里，匿名`onfocus`处理函数使用变量 identifier `item`。`item`不是函数内的局部变量，所以当处理程序被执行时，JavaScript 必须遍历下一个外部作用域，它`item`在`setupHelp`. 您为每个项目定义了一个处理函数；但是，*所有*这些处理函数在外部范围内都持有*相同*的引用。`item`每当调用这些函数中的任何一个时，JavaScript 都会查找相同的值 for ，即循环完成`item`时它所持有的任何值。`for`

在有额外闭包的情况下，您将 的当前值`item.help`作为参数传递给`makeHelpCallback`，它返回一个处理函数。由于 JavaScript 按值传递变量，因此这些处理函数中的每一个现在都有一个*单独*的外部作用域，具有不同的`help`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T22:03:02.013

考虑一个更简单的例子：

```
for (var i = 0; i < 10; ++i) {
    document.getElementById('elem' + i).addEventListener('click', function() {
        document.getElementById('elem' + i).style.display = 'none';
    });
} 
```

代码看起来很简单，对吧？看起来如果您单击一个 div 它将隐藏。

但事实并非如此。事件处理程序在`i`. `i`处理程序外部发生的任何事情都发生在处理程序`i`内部（为了简化一点）。

[这](http://jsfiddle.net/kKqkm/)是此行为的一个示例。请注意，无论您单击哪个 div，`ELEM #10`它始终是隐藏的。（它是 10 而不是 9，因为`i`在循环条件失败之前最后一次递增。）

* * *

一个诱人的解决办法是试试这个：

```
for (var i = 0; i < 10; ++i) {
    document.getElementById('elem' + i).addEventListener('click', function() {
        var fix = i;
        document.getElementById('elem' + fix).style.display = 'none';
    });
}​ 
```

但这不起作用，因为直到`i`is already才处理分配`10`。（好吧，从技术上讲，直到点击事件发生时才会处理它——假设那时`i`是 10，尽管理论上点击可能在所有事件被绑定之前发生，`i`当时低于 10。）

* * *

您实际上可以使用 MDN 内联的技巧：

```
for (var i = 0; i < 10; ++i) {
    document.getElementById('elem' + i).addEventListener('click', (function(j) { return function() {
        document.getElementById('elem' + j).style.display = 'none';
    }}(i)));
}​ 
```

* * *

将变量传递给函数使其被视为不同的“环境”。函数内部`j`在函数被调用时被冻结。然后内部闭包使用那个 j。有趣的是，`i`仍然存在于这两个函数内部。根据访问它的时间，它会介于`0`和之间`10`。

```
for (var i = 0; i < 10; ++i) {
    document.getElementById('elem' + i).addEventListener('click', (function(j) { 
        alert(i); //whichever value is being bound
        //note that i === j is always true here
        //j is a copy of i though and thus stops changing when i changes in the future 
        return function() {
            alert(i); //always 10
            document.getElementById('elem' + j).style.display = 'none';
        };
    }(i)));
}​ 
```

* * *

考虑 JS 作用域的一种简化方法是嵌套函数继承父作用域（这是真的）。当函数被调用时，变量在调用范围内被传递。

这里有一个有趣的小警告，原语是按值传递的，对象是按引用传递的。

```
var x = 5; (function(n) { ++n; }(x)); /* x is still 5 */
var o = {foo: 'bar'}; (function(obj) { obj.far = 'baz'; }(o)); /* o === {foo: 'bar', far: 'baz'} */ 
```

# android - 密钥签名的重要性是什么？

> ID：14114524
> 
> 赞同：1
> 
> 时间：2013-01-01T21:48:26.897
> 
> 标签：android, security

我已经开始制作 android 应用程序，我想把它做成一个 APK 文件。这样做时，我检查了 android 文档，他们谈到了 jarsigner 和 zipalign。我想知道这些做什么以及为什么我需要它们。另外，为什么您需要公钥和私钥，它们是做什么的？如果有人得到它们，为什么它们会如此危险？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:52:27.967

密钥商店是确保您是唯一为您的应用发布更新的用户。当您签署您的应用程序并将其发布到 Google Play 时，您需要确保备份您的密钥库，因为它们不可重新创建，并且如果您丢失了您的密钥库，那么您将无法发布更新。Jarsigner 只是您用来“签署”您的应用程序的工具，而 zipalign 是您的应用程序的优化，与您的密钥库无关（据我所知）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:55:09.397

如果您**签署**文件（或任何其他数据，如 WLAN 数据），则没有人能够修改它们（因为他们无法重新签署文件）。所以这些签名文件告诉每个人你是制作它们的人。

**公钥**用于验证您是签署文件或数据的人。但是无法对文件进行签名（仅用于检查）。

这一切都很好（而且安全），除非他们有你的**私钥**，那么他们也可以在假装他们是你的同时签署文件。因此，他们可以在没有任何人注意的情况下将讨厌的病毒放入您的应用程序中。因此，当您丢失私钥时，这将是一场灾难。

公钥和私钥（以及使用它们的加密技术）不是特定于 android 的，它们用于所有安全通信、数据存储、电子邮件等。

有关更多信息，请查看[此页面](https://en.wikipedia.org/wiki/Public-key_cryptography)和/或在 Internet 上查找“公钥/私钥”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T22:00:32.690

您签署您的应用程序以证明您是该应用程序的唯一发布者。

你真的不需要担心密钥的细节，如果你使用标准的 Android 开发工具 (ADT)，有一个向导会引导你创建一个用于发布应用程序的密钥

使用工具导出：右键单击您的项目 --> Android 工具 --> 导出签名的应用 点击下一步，然后第二个屏幕将允许您“创建新密钥”。选择它，您可以创建所需的一切。

您将需要此密钥才能发布（即使您没有将其放入 Play Market，您仍然需要签署一个 App 才能在任何设备上运行它）。

如果您确实发布到 Play Market，并且丢失了您的密钥库（或密码） - 您将无法更新该应用程序。永远，你无能为力。把它保存在某个地方。

有人会同时需要密钥库文件和用于签署您的应用程序的密码（以及您的 Play Market 密码），因此密钥本身并不那么重要（显然，您需要确保所有这些东西的安全）。

# css - IE10 悬停 + 伪元素

> ID：14114526
> 
> 赞同：3
> 
> 时间：2013-01-01T21:48:34.593
> 
> 标签：css, hover, pseudo-element, internet-explorer-10

示例：[http ://codepen.io/mastastealth/pen/gFjhi](http://codepen.io/mastastealth/pen/gFjhi)

基本上，我有一个元素，其 :after 元素设置为不透明度 0。悬停时，它变为不透明度 1。显然它适用于 IE9 和其他任何地方，但不适用于 IE10（除非我点击）？想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-04T15:53:03.907

似乎存在一个错误，即当事件发生时，不侦听具有伪类后跟伪元素的选择器。如果您通过仅添加带有伪类的选择器来添加侦听器，您的样式将应用于发生的事件。

[http://codepen.io/justinphillips/pen/qvHyi](http://codepen.io/justinphillips/pen/qvHyi)

```
.p:hover:after {
    opacity: 0.7;
  } 

.p:hover {} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T16:29:03.740

显然 IE10 延续了不接受 :hover on div 的可怕错误。使用元素更新示例，它工作正常。

# c# - 与自定义 ControlTemplate 的按钮单击绑定？

> ID：14114527
> 
> 赞同：1
> 
> 时间：2013-01-01T21:48:40.543
> 
> 标签：c#, winrt-xaml

我正在尝试创建一个设置浮出控件（C# 中的 Windows 8 应用程序），并且由于浮出控件的背景是白色的，因此我有点想反转页面控件以使它们在默认表单中可见。我设法改变了文本框的边框颜色。但是，当我“反转”所有按钮内容并单击按钮时，应用程序会在此行中断。

```
if (global::System.Diagnostics.Debugger.IsAttached) global::System.Diagnostics.Debugger.Break(); 
```

这是用户控件的 XAML：

```
<UserControl
x:Class="tapp.Settings"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="using:tapp"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
mc:Ignorable="d">

<UserControl.Resources>
    <Style x:Key="tb" TargetType="TextBox">
        <Setter Property="BorderBrush" Value="Black"/>
        <Setter Property="Width" Value="200"/>
    </Style>
    <Style x:Key="pb" TargetType="PasswordBox">
        <Setter Property="BorderBrush" Value="Black"/>
        <Setter Property="Width" Value="200"/>
    </Style>
    <Style x:Key="btn" TargetType="Button">
        <Setter Property="BorderBrush" Value="Black"/>
        <Setter Property="Foreground" Value="Black"/>
        <Setter Property="Background" Value="White"/>
        <Setter Property="ClickMode" Value="Press"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid Height="{TemplateBinding Height}" Width="{TemplateBinding Width}">
                        <Rectangle x:Name="outRect"
                                   HorizontalAlignment="Stretch"
                                   VerticalAlignment="Stretch"
                                   Fill="Black">
                        </Rectangle>
                        <Rectangle x:Name="innerRect"
                                   HorizontalAlignment="Stretch"
                                   VerticalAlignment="Stretch"
                                   Margin="2"
                                   Opacity="100"
                                   Fill="White">
                        </Rectangle>
                        <ContentPresenter x:Name="cpresent" Content="{TemplateBinding Content}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="PointerOver">
                                    <Storyboard Duration="0">
                                        <ColorAnimation To="LightGray" Duration="0"                    Storyboard.TargetProperty="(Rectangle.Fill).(SolidColorBrush.Color)" Storyboard.TargetName="innerRect" />
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <ColorAnimation To="Black" Duration="0"                    Storyboard.TargetProperty="(Rectangle.Fill).(SolidColorBrush.Color)" Storyboard.TargetName="innerRect" />
                                        <ColorAnimation To="White" Duration="0" Storyboard.TargetProperty="(ContentPresenter.Forground).(SolidColorBrush.Color)" Storyboard.TargetName="cpresent"/>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</UserControl.Resources>

<Grid>
    <TextBlock HorizontalAlignment="Left" Margin="10,10,0,0" TextWrapping="Wrap" Text="Username" VerticalAlignment="Top"/>
    <TextBox x:Name="username" HorizontalAlignment="Left" Margin="10,28,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Height="30" Style="{StaticResource ResourceKey=tb}"/>
    <TextBlock HorizontalAlignment="Left" Margin="10,65,0,0" TextWrapping="Wrap" Text="Password" VerticalAlignment="Top"/>
    <PasswordBox x:Name="password" HorizontalAlignment="Left" Margin="10,83,0,0" VerticalAlignment="Top" Style="{StaticResource ResourceKey=pb}"/>
    <Button x:Name="login" Content="Login" HorizontalAlignment="Left" Margin="10,120,0,0" VerticalAlignment="Top" Width="200" Height="32" Style="{StaticResource btn}"/>

</Grid> 
```

在 CS 文件中，我添加了一个处理程序，但它根本没有响应。

```
public sealed partial class Settings : UserControl
{
    public Settings()
    {
        this.InitializeComponent();
        login.Click+=login_Click;
    }

    private void login_Click(object sender, RoutedEventArgs e)
    {

    }
} 
```

如果我删除按钮样式一切正常

做什么/不做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:55:16.560

你错过了前景中的“e”

```
<ColorAnimation To="White" Duration="0" Storyboard.TargetProperty="(ContentPresenter.Foreground).(SolidColorBrush.Color)" Storyboard.TargetName="cpresent"/> 
```

# maven - 使用 Maven 发布插件时避免 gpg 签名提示

> ID：14114528
> 
> 赞同：39
> 
> 时间：2013-01-01T21:48:45.113
> 
> 标签：maven, code-signing, maven-release-plugin, gnupg

我有一个 Maven 项目，我正在尝试将其配置为使用 Maven 发布插件。发布过程的一部分是使用 Maven GPG 插件对工件进行签名，这需要 GPG 签名密钥密码短语才能成功。因为这些构建需要在非交互式环境中运行，（CI-Server）这些参数作为参数传递给 maven，形式为

```
-Dgpg.passphrase=XXX 
```

对于快照构建，一切正常；Maven GPG 插件会看到传入的密码短语，按预期构建、签名和部署工件，但是，当我尝试使用发布插件时，系统会提示我输入 gpg 签名密钥密码。我已经阅读了几个关于类似问题的讨论，这些问题源于发布插件分叉另一个不接收传入参数的 maven 调用。最流行的修复似乎是像这样使用“arguments”参数：

```
-Darguments="-Dgpg.passphrase=XXX" 
```

据说这会传递给分叉的实例，但不幸的是对我来说它并没有摆脱提示。

由于对工件进行签名并不是将发布工件部署到公共 maven 存储库的常见先决条件，并且可能大多数生产这些工件的实体都使用某种形式的 CI，我无法想象我是唯一遇到此问题的人。有没有人找到解决方法？

**关于已接受答案的说明：**

接受的解决方案将无法与 Maven 3.0 - 3.0.3 和 3.0.3 一起使用，这恰好是在 OSX Mountain Lion 上默认安装的 java。您需要升级到 3.0.4。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-01-09T20:31:39.367

只需在 settings.xml 的配置文件中设置它并默认激活它：

```
<settings>
  <profiles>
    <profile>
      <id>gpg</id>
      <properties>
        <gpg.executable>gpg2</gpg.executable>
        <gpg.passphrase>mypassphrase</gpg.passphrase>
      </properties>
    </profile>
  </profiles>
  <activeProfiles>
    <activeProfile>gpg</activeProfile>
  </activeProfiles>
</settings> 
```

如您所见，您可以使用任何属性来执行此操作..例如，jarsigner 插件的其他用户名和密码等等。

这应该始终处于活动状态。它可能取决于使用较新的 Maven 版本，但您始终可以使用

```
mvn help:active-profiles 
```

**加密密码**

评论和其他答案指出将密码保存在文件中是不安全的......这在一定程度上是正确的，但幸运的是 Maven 允许我们通过创建一个主密码然后加密设置中的所有密码来使其非常安全.xml 与它。

有关详细信息，请查看迷你指南[密码加密](https://maven.apache.org/guides/mini/guide-encryption.html)。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-08-08T07:13:02.927

将 GPG 密码短语放在主目录中的文件中绝对是可怕的安全性。

相反，请使用 gpg-agent，因此您只需在每个会话中输入一次密码。安装后，您可以设置 shell 以执行以下操作：

```
eval $(gpg-agent --daemon --no-grab --write-env-file $HOME/.gpg-agent-info)
export GPG_TTY=$(tty)
export GPG_AGENT_INFO 
```

然后更新您的插件以启用代理。您可以在 pom 中执行此操作，也可以在 settings.xml 中的配置文件中执行此操作可能会更好：

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-gpg-plugin</artifactId>
  <configuration>
    <useAgent>true</useAgent>
  </configuration>
</plugin> 
```

或者在您的设置中执行此操作可能更好，更便携：

```
<profile>
  <id>gpg-profile</id>
  <properties>
    <gpg.useagent>true</gpg.useagent>
  </properties>
</profile> 
```

然后在会话中第一次需要 gpg 密码时，会弹出一个对话框。此后，它每次都使用代理的密码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-06-18T12:24:29.860

如果您不想在 settings.xml 中使用明文密码并且不想/不能使用 gpg-agent，您可以[设置密码加密](https://maven.apache.org/guides/mini/guide-encryption.html)。

您首先需要为 maven 设置主密码（假设 maven 3.2.1+，否则您必须将密码作为参数传递）：

```
mvn -emp 
```

这将返回密码的加密版本。存储此密码`~/.m2/settings-security.xml`- 它应该如下所示：

```
<settingsSecurity>
  <master>{inY3jdvspkeO2RUTxzQ4xHPelos+9EF1iFQyJQ=}</master>
</settingsSecurity> 
```

然后使用以下命令加密密钥密码：

```
mvn -ep 
```

并使用生成的加密密码`settings.xml`（配置文件 id 需要与您使用的配置文件相匹配，这里我使用过，`release`因此您需要像运行 maven 一样`mvn -P release release:prepare etc.`- 或者您可以将其作为活动配置文件的一部分，如另一个答案中所述）：

```
<servers>
  <server>
    <id>gpg.passphrase</id>
    <passphrase>{inY3jdvspkeO2RUTxzQ4xHPelos}</passphrase>
  </server>
</servers>

<profiles>
  <profile>
    <id>release</id>
    <properties>
      <gpg.keyname>6DF60995</gpg.keyname>
    </properties>
  </profile>
</profiles> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-04-13T04:40:13.103

结合此处的答案和[插件官方文档](https://maven.apache.org/plugins/maven-gpg-plugin/usage.html)，我设法使其与settings.xml 中的加密密码[（记录在此处）一起工作。](https://maven.apache.org/guides/mini/guide-encryption.html)

设置.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
 <settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0 https://maven.apache.org/xsd/settings-1.0.0.xsd">
   <servers>
     <server>
       <id>YOUR_KEY_ID</id>
       <passphrase>YOUR_KEY_ENCRYPTED_PASSPHRASE</passphrase>
     </server>
   </servers>
   <profiles>
     <profile>
       <id>my-release</id>
       <activation>
         <!-- I run explicitly with "-Pmy-release". Change this to "true" if you don't want to. -->
         <activeByDefault>false</activeByDefault>
       </activation>
       <properties>
         <gpg.keyname>YOUR_KEY_ID</gpg.keyname>
       </properties>
     </profile>
   </profiles>
 </settings> 
```

pom.xml 中的 maven-gpg-plugin 部分：

```
<!-- Sign with GPG (properties are in ~/.m2/settings.xml) -->
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-gpg-plugin</artifactId>
  <version>1.6</version>
  <executions>
    <execution>
      <id>sign-artifacts</id>
      <phase>verify</phase>
      <goals>
        <goal>sign</goal>
      </goals>
      <configuration>
        <useAgent>true</useAgent>
        <keyname>${gpg.keyname}</keyname>
        <passphraseServerId>${gpg.keyname}</passphraseServerId>
        <gpgArguments>
          <arg>--batch</arg>
          <arg>--pinentry-mode</arg>
          <arg>loopback</arg>
        </gpgArguments>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

Maven版本：3.6.3

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-09-17T16:30:17.087

接受的答案对我不起作用（使用 Maven 3.6.2）。对我有用的是更新 maven-gpg-plugin 配置：

```
<plugin>
  <artifactId>maven-gpg-plugin</artifactId>
 ....
  <configuration>
    <useAgent>true</useAgent>
    <passphrase>${env.GPG_PASSPHRASE}</passphrase>
    <gpgArguments>
      <arg>--batch</arg>
      <arg>--pinentry-mode</arg>
      <arg>loopback</arg>
    </gpgArguments>
  </configuration>
....
</plugin> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-09-21T20:54:21.287

settings.xml 中的 GPG 密码是有效的解决方案，但它是打开的，这很糟糕。我在项目中使用的替代解决方案如下：

```
stty -echo && printf "GPG password: " && read gpgPwd && printf '\n' && stty echo
mvn release:prepare -Darguments="-Dgpg.passphrase=$gpgPwd"
git push
git push --tags
mvn release:perform -Darguments="-Dgpg.passphrase=$gpgPwd"
unset gpgPwd 
```

其他必需的配置：

```
export GPG_TTY=$(tty) (in the ~/.bash_profile)
maven-release-plugin/configuration/pushChanges=false (in the root pom.xml) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-02T15:26:12.787

配置`maven-gpg-plugin`非常复杂，并且取决于本机操作系统功能。

`maven-gpg-plugin`我们可以使用另一个专为在 CI/CD 环境中使用而设计的插件，而不是与所有困难作斗争。

您可以尝试[https://www.simplify4u.org/sign-maven-plugin/](https://www.simplify4u.org/sign-maven-plugin/)，这是可以替换`maven-gpg-plugin`的。

的所有配置参数`sign-maven-plugin`都可以作为环境变量传递。

在 Maven 项目中，我们替换`maven-gpg-plugin`为：

```
<plugins>
    <plugin>
        <groupId>org.simplify4u.plugins</groupId>
        <artifactId>sign-maven-plugin</artifactId>
        <version><!-- check releases page --></version>
        <executions>
            <execution>
                <goals>
                    <goal>sign</goal>
                </goals>
            </execution>
        </executions>
    </plugin>
</plugins> 
```

在 CI 系统中，我们为构建设置环境变量：

*   **SIGN_KEY** - 装甲 GPG/PGP 钥匙
*   **SIGN_KEY_ID** - 十六进制格式的密钥 ID - 如果未提供，将使用来自 SIGN_KEY 的第一个密钥
*   **SIGN_KEY_PASS** - 解密私钥的密码

此外，`sign-maven-plugin`如果配置项不可用，我们不需要特殊配置文件来默认激活/停用签名，插件跳过执行而不会出错。

# opencv - 图像特征检测

> ID：14114530
> 
> 赞同：4
> 
> 时间：2013-01-01T21:49:06.910
> 
> 标签：opencv, artificial-intelligence, image-recognition, edge-detection

我正在开发一个应用程序来识别圆形/椭圆形内的线状特征。形状如下所示（此处显示两个）：

![形状](../Images/9669c9116ee3fb873d7e945683268395.png)

*   形状本身可以在圆形和椭圆形之间略有不同。
*   形状内部最多有 5 条线，它们位于每个形状大致相同的区域。
*   这些线条的长度、粗细、旋转和曲率可能略有不同。
*   线条有时会稍微接触/相交。
*   通常正好有 5 个，但有时可能会完全丢失一行。
*   我不在乎颜色，黑白阈值很好。

每个对象（超过 100 个）将通过视频单独捕获；捕获是一个手动/物理过程（即我每次都拿着相机）。我可以完全控制相机，因此我可以在每次拍摄时始终如一地定位它。

现在我正在尝试使用 OpenCV 进行识别。我能够修改示例“面部识别”应用程序以使用另一个 Haar 标识符 XML 文件，但这似乎只处理外部圆圈/椭圆的检测。

我有兴趣为每个样本生成一个对象，以描述 5 条内部线以进行进一步处理：

```
{
    1: { length: 20, avg_thick: 2.3 },
    2: { length: 4, avg_thick: 2.0 },
    3: { length: 9.1, avg_thick: 2.1 },
    4: { length: 2, avg_thick: 1.9 },
    5: { length: 17, avg_thick: 2.1 }
} 
```

这是我第一个涉及图像识别的项目。我应该使用/研究什么算法或程序来实现这一目标？谢谢！

**更新：**

由于图像是手工拍摄的，它们不是纯黑/白的。尝试应用阈值会使形状内的（假装）线有时会消失。如何改善阈值结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T07:04:44.277

如果线条近似直线，则使用[霍夫变换](http://en.wikipedia.org/wiki/Hough_transform)查找所有线条，使用霍夫变换的圆形版本查找所有圆/椭圆（然后您可以检查是否找到了边界圆/椭圆，以及哪些线条在里面例如）。

如果线条不直：您的意思是“狭窄的细长区域”而不是线条，对吗？:) 你必须骨架化（可能首先是阈值）。有用的教程：“[使用 OpenCV-Python 进行骨架化](http://opencvpython.blogspot.com/2012/05/skeletonization-using-opencv-python.html)”。由于您还需要宽度（= 从骨架到边缘的距离），请使用[skimage.morphology.medial_axis](http://scikit-image.org/docs/0.6/api/skimage.morphology.html#skimage.morphology.medial_axis) (..., return_distance=True)。您可能还需要一些方法来穿过每个骨架的分支并修剪短分支（抱歉，没有现成的东西已经这样做了）。

Haar 类型的方法根本不起作用，它仅适用于（甚至理论上）具有固定相对位置和形状的特征。您想要某种*几何特征提取*算法，而不是图像识别。

**编辑：** python中的示例代码：

```
import numpy, scipy, scipy.ndimage, skimage.morphology, matplotlib.pyplot

img = scipy.ndimage.imread("test.png")

# quick and dirty threshold
binary_img = img[:,:,0] < 0.1

# skeletonize
skel_binary, skel_distances = skimage.morphology.medial_axis(binary_img, return_distance=True)

# find individual lines
structure_element = scipy.ndimage.generate_binary_structure(2,2)
skel_labels, num_skel_labels = scipy.ndimage.measurements.label(skel_binary, structure=structure_element)

for n in range(1, num_skel_labels + 1):
    # make a binary label for this line
    line = (skel_labels == n)
    # calculate width from skeleton
    mean_width = 2 * numpy.mean( skel_distances[ line ] )
    print "line %d: width %f" % (n, mean_width)
    # you need some way to find the ends of a line
    # perhaps the most distant pair of points?

# show the labels
# the circle is also labelled
# you need some way to check which label is the circle and exclude that
matplotlib.pyplot.imshow(skel_labels)
matplotlib.pyplot.show() 
```

![上面程序的输出](../Images/bd69f057271d31025b1abf612c79fb05.png)

这会在您在上面发布的图像上产生合理的结果，并且（检查线条粗细是否有效）在这些图像的放大 10 倍版本上。它不处理相交的线，也许你可以为此做一个图形算法。此外，您确实需要以某种方式排除外圈（它似乎总是 n=1，因为标记发生在左上角，并且它找到的第一个标记区域是圆圈）。

**编辑：**如何（或是否）阈值是一个有趣的问题。您可以尝试自动阈值化，可能基于 Otsu 的方法，或者基于高斯混合（[示例](http://scipy-lectures.github.com/advanced/image_processing/index.html#segmentation)）。我认为您可能会通过某种背景和前景颜色*和*亮度的统计模型以及局部自适应阈值处理获得最佳结果。真的取决于你的图像的性质。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T06:31:39.513

1.  骨架化图像并跟踪每一行，然后你就有了每行的数量和长度。
2.  对于每条线，计算面积（计算原始 BW 图像中黑色像素的数量）然后将其除以长度以找到平均厚度。

# iphone - iPhone 仅在调试应用程序时振动

> ID：14114531
> 
> 赞同：1
> 
> 时间：2013-01-01T21:49:13.713
> 
> 标签：iphone, objective-c, ios, xcode, debugging

我正在编写一个 iPhone 应用程序，该应用程序需要反复振动，直到用户停止它，我正在使用一个由线程调用的循环来执行此操作，如下所示：

```
-(void)vibrateLoop {
    while (1) {
        sleep(0.5);
        if (!vibrate) {
            [NSThread exit];
            return;
        }
        AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);
    }
} 
```

但是，当我从 iPhone 而不是 Xcode 运行应用程序时，振动不会发生。但是当在 Xcode 中以调试模式运行它时，手机会像预期的那样振动。到底是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T06:43:15.907

如何使用图形服务框架库。它有一个方法

> void GSEventVibrateForDuration(float secs);

您可以将 secs 设置为 1 并在循环中继续调用此方法，当用户希望它停止时，请使用以下方法 GSEventStopvibrator()

重要提示：图形服务框架库是一个私有库，因此如果您决定使用它，您将无法将您的应用提交到应用商店。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T03:30:53.400

尝试将 Play 调用放入一个方法中，并使用设置为重复的计时器调用该方法。例如

```
 -(void)vibrateLoop {

    if (!vibrate) {

        return;
    }
    [NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector(vibrateLoop) userInfo:nil repeats:NO];
    AudioServicesPlaySystemSound(kSystemSoundID_Vibrate);

}

//somewhere else in code
[NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector(vibrateLoop) userInfo:nil repeats:NO]; 
```

# ios - 使用 AVPlayer 和 AVMutableComposition 播放未对齐的声音

> ID：14114542
> 
> 赞同：2
> 
> 时间：2013-01-01T21:49:58.480
> 
> 标签：ios, avfoundation, avplayer, avcomposition

我正在尝试使用**AVComposition**从多个乐器样本中创建一首歌曲。

`kCMTimeZero`当我在中播放两个声音资产时`AVMutableComposition`，我希望它们同时播放，但有一个非常轻微的偏移。

这只发生在第一次播放时，所以它似乎是某种加载延迟，但无论我尝试什么，它都不会消失。

我已经确保预加载声音资产轨道，预加载合成轨道，等待`playerItem`准备好，等待播放器准备好播放。我尝试过预卷播放器、播放/暂停播放器等。第一次播放时，曲目之间总是会有轻微的偏移。

我创建了一个小示例项目来演示[这里的效果](https://github.com/laverick/SoundSyncTest)

主要代码在[这里](https://github.com/laverick/SoundSyncTest/blob/master/SoundSyncTest/ViewController.m)

请注意，当您第一次加载应用程序并点击播放时，声音会稍微偏移。声音的后续重复（以及相同 playerItem 的重放）不存在此问题。

稍微延迟初始声音似乎可以解决问题，但这不是一个很好的选择。

知道这是否可以解决，或者我是否遗漏了什么？

谢谢

# postgis - 在 PostgreSQL 9.1 中更改列的数据类型

> ID：14114543
> 
> 赞同：2
> 
> 时间：2013-01-01T21:49:59.383
> 
> 标签：postgis, postgresql-9.1, type-conversion

我正在通过“PostGIS in Action”一书学习 PostgreSQL 和 PostGIS。我的问题来自 Pg。清单 3.4 中的 66。

我的代码如下：

```
CREATE TABLE ch03.paris_polygons(tags hstore, CONSTRAINT paris_polygons_pk PRIMARY KEY (gid)
)
INHERITS (ch03.paris);

ALTER TABLE ch03.paris_polygons NO INHERIT ch03.paris;
INSERT INTO ch03.paris_polygons(osm_id, ar_num, geom, tags, feature_name, feature_type)
SELECT osm_id, ar_num, ST_Multi(geom) As geom, tags, tags->'name',
COALESCE(tags->'tourism', tags->'railway','other')::varchar(50) As feature_type
FROM ch03.paris_hetero
WHERE ST_GeometryType(geom) LIKE '%Polygon';
SELECT populate_geometry_columns('ch03.paris_polygons'::regclass);
ALTER TABLE ch03.paris_polygons INHERIT ch03.paris; 
```

运行代码后我收到此错误：

```
ERROR: child table "paris_polygons" has different type for column "geom"
SQL state: 42804 
```

我用谷歌搜索找到了这个：

-204 (ECPG_INT_FORMAT)

```
The host variable is of type int and the datum in the database is of a different type and contains a value that cannot be interpreted as an int. The library uses strtol() for this conversion. (SQLSTATE 42804) 
```

psql 命令会帮助我了解如何合并这些命令吗？

再次感谢所有的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-13T20:23:57.170

我刚碰到这个。这本书很可能在您（和我）正在查看的代码片段中忘记了这一步。但是，如果您继续阅读下一页，它们仅显示 LINESTRING 分区表的构造，那里有一条关键线，他们在 POLYGON 分区表构造中忘记了：

```
ALTER TABLE ch03.paris_polygons
ADD CONSTRAINT enforce_geotype_geom
CHECK (geometrytype(geom) = 'POLYGON'::TEXT); 
```

一旦我添加了该约束，错误就消失了，基本上它导致发生的原因是允许 geom 列继承父 geom 列类型，而不是它假设基于的 geometry('polygon',SRID) 类型数据加载，并离开约束来管理类型限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-19T09:24:51.873

我遇到了同样的错误。我尝试改用“MULTIPOLYGON”：

```
ALTER TABLE ch03.paris_polygons
ADD CONSTRAINT enforce_geotype_geom
CHECK (geometrytype(geom) = 'MULTIPOLYGON'::TEXT); 
```

# html - 链接在点击时改变字体

> ID：14114544
> 
> 赞同：0
> 
> 时间：2013-01-01T21:50:05.547
> 
> 标签：html, css, anchor

我刚刚完成了一个网站，并注意到链接突然闪烁为不同的字体，并且在单击时会很快改变大小。

该网站位于[http://www.belle-jeunesse.com](http://www.belle-jeunesse.com)，问题最明显的是在主导航栏中。

有谁知道为什么会发生这种情况以及如何将其修复为至少保持相同的字体？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T21:52:58.023

在 style.css 的第 119 行，删除`a:active`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T21:54:57.447

在你的样式表中，你有这个：

```
#g_links a:link, a:visited, a:active {
font-family: Domine; font-size: 1em; font-weight: bold; text-decoration: none; color: #000; border-bottom: 1px solid; } 
```

我相信你想要的是这样的：

```
#g_links a:link, #g_links a:visited, #g_links a:active {
font-family: Domine; font-size: 1em; font-weight: bold; text-decoration: none; color: #000; border-bottom: 1px solid; } 
```

如果没有#g_links，您将其应用于所有 a:visited 和 a:active 链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-01T21:53:16.633

在您的文件中：第 119 行的 style.css。您有以下规则：

```
#g_links a:link, a:visited, a:active {
    font-family: Domine;
    font-size: 1em;
    font-weight: bold;
    text-decoration: none;
    color: #000;
    border-bottom: 1px solid;
} 
```

只需删除行 : a:active 或在 a:visited 和 a:active 之前添加 #g_links ，如下所示：

```
#g_links a:link, #g_links a:visited, #g_links a:active {

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-01T21:54:26.927

在第 119 行的 style.css 中，你有这个 css：

```
#g_links a:link, a:visited, a:active
{
    font-family: Domine;
    font-size: 1em;
    font-weight: bold;
    text-decoration: none;
    color: #000;
    border-bottom: 1px solid;
} 
```

id #g_links 仅适用于 a:link 部分。因此，当按下链接时，页面上的所有链接都会受到这些样式规则的影响。您可能还想在 a:visited 和 a:active 之前添加它。

# z-index - 基本 z 索引不起作用

> ID：14114553
> 
> 赞同：1
> 
> 时间：2013-01-01T21:51:01.443
> 
> 标签：z-index

我正在尝试从我找到的页面复制一个简单的 z 索引示例，但它不起作用。

示例在以下页面：[请单击此处](http://www.quackit.com/css/properties/css_z-index.cfm)：

该示例显示了两个重叠的 div。但是，当我尝试通过使用从示例页面复制和粘贴的以下代码创建基本页面来复制示例时，而不是像在示例页面上那样重叠的 div，它们只是在页面上垂直堆叠在另一个之上。

任何反馈将不胜感激。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
</head>

<body>

<style type="text/css">
div { border:1px solid black; }
.infront {
background-color:#ff9900;
width:100px;
height: 100px;
position: relative;
top: 10;
left:80;
z-index: 2;
}
.behind {
background-color:#eeeeee;
width:100px;
height: 100px;
position: relative;
top: -60;
left:35;
z-index: 1;
}
</style>
<div class="infront">
In front
</div>
<div class="behind">
Behind
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:01:55.030

quackit 的示例有错误。但它也使用 quirks 模式，而您自己的示例具有正确的 doctype 声明。

现在在怪癖模式下，诸如省略长度单位之类的错误是可以容忍的，但对于真正的 (X)HTML 则不行。所以你应该做的是通过附加`px`到所有无单位长度来纠正这些错误。

```
top: 10px;
left:80px; 
```

等等。

# c# - 调用 SQL 代理作业

> ID：14114554
> 
> 赞同：0
> 
> 时间：2013-01-01T21:51:02.967
> 
> 标签：c#, sql-server, sql-agent-job, sql-agent

我正在尝试从我的 C# 应用程序调用 SQL 代理作业。

我希望能够。

*   按下按钮即可执行作业。

但我也想在作业完成运行或失败时收到某种消息。

来自另一个答案的以下代码示例对我不起作用，因为我需要访问本地 MSDB 数据库。

```
private Dictionary<int, string> ExecutionStatusDictionary = new Dictionary<int, string>()
{
{0, "Not idle or suspended"},
{1, "Executing"},
{2, "Waiting for thread"},
{3, "Between retries"},
{4, "Idle"},
{5, "Suspended"},
{7, "Performing completion actions"}
};

public string GetStatus()
{
SqlConnection msdbConnection = new SqlConnection("Data Source=GACDTL01CR585M;Initial       Catalog=msdb;Integrated Security=SSPI");
System.Text.StringBuilder resultBuilder = new System.Text.StringBuilder();

try
{
    msdbConnection.Open();

    SqlCommand jobStatusCommand = msdbConnection.CreateCommand();

    jobStatusCommand.CommandType = CommandType.StoredProcedure;
    jobStatusCommand.CommandText = "sp_help_job";

    SqlParameter jobName = jobStatusCommand.Parameters.Add("@job_name", SqlDbType.VarChar);
    jobName.Direction = ParameterDirection.Input;
    jobName.Value = "LoadRegions";

    SqlParameter jobAspect = jobStatusCommand.Parameters.Add("@job_aspect", SqlDbType.VarChar);
    jobAspect.Direction = ParameterDirection.Input;
    jobAspect.Value = "JOB";

    SqlDataReader jobStatusReader = jobStatusCommand.ExecuteReader();

    while (jobStatusReader.Read())
    {
        resultBuilder.Append(string.Format("{0} {1}",
            jobStatusReader["name"].ToString(),
            ExecutionStatusDictionary[(int)jobStatusReader["current_execution_status"]]
        ));
    }
    jobStatusReader.Close();
}
finally
{
    msdbConnection.Close();
}

return resultBuilder.ToString();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:24:53.960

使用 ADO.NET 不适合您想要做的事情。您应该使用[SQL Server 管理对象 API ( `SMO`)](http://msdn.microsoft.com/en-us/library/ms162169%28v=sql.105%29.aspx)，这是以这种方式执行管理任务时的首选。

更确切地说，你应该看看 SMO 的[`Job.Start`](http://msdn.microsoft.com/en-us/library/ms202348%28v=sql.105%29.aspx)方法。文章中有一个关于如何使用它的示例。该类`Job`提供了一些事件（例如`SuccessAction`）以在作业完成执行时通知您。

# android - Android：使用背景 png 图像

> ID：14114556
> 
> 赞同：3
> 
> 时间：2013-01-01T21:51:07.303
> 
> 标签：android, xml, image

我正在寻找使用 .png 图像作为应用程序主活动屏幕背景的最佳方式。我希望能够正确安装在尽可能多的设备上。

我有什么作品，我想知道什么是可移植性的最佳实践。

这是我在 XML 中使用的代码：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/main_background"
    android:padding="25dp"
    >

...other stuff like a few buttons that go on top of background 
```

目前，文件“main_background.png”是一个 800 像素 x 600 像素的图像。我注意到我的手机至少水平尺寸向内收缩，从而扭曲了图像。是否有一个理想的 Width::Height 比例我可以制作我的背景图片？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:02:43.130

你要做的是像这样设置你的xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="match_parent"
android:background="@drawable/main_background"
android:padding="25dp"
> 
```

注意缺少`layout_height`...

在您的主 Activity 中，您会找到该视图，然后执行以下行：

```
myLinLayout.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, myLinLayout.getWidth())); 
```

哪里`myLinLayout`是线性布局，你按照`LayoutParams`方法：

```
setLayoutParams(int width, int height); 
```

# netty - 如何在 Netty 中使用等待计时器？

> ID：14114558
> 
> 赞同：0
> 
> 时间：2013-01-01T21:51:37.757
> 
> 标签：netty

我有一个简单的应用程序，它连接到服务器，发送 ACK，然后发送要处理的文件。服务器发回一个 ACK​​，然后发送处理输入文件的结果，这可能在发送 ACK 几秒钟后发生。如果我不启动计时器线程并在 ACK 之后继续检查响应文件是否已进入，我的主线程将退出。我本来希望接收套接字保持打开状态，直到明确关闭。

如果有人可以总结适用于在 Netty 中使用等待计时器的模式，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T14:07:35.690

我建议使用 java.util.concurrent.CountDownLatch。初始化为 1（一），并将其传递给您的通道处理程序，并等待它在主线程中达到零。当处理程序收到最终结果时，它会减少锁存器。

# javascript - 手指轻扫的jquery钩子？

> ID：14114559
> 
> 赞同：0
> 
> 时间：2013-01-01T21:52:09.327
> 
> 标签：javascript, jquery

所以，我建立了这个网站来放一些我的照片：

pics.nicecomeback.com

它没有使用任何标准的jquery照片库..通过捕获箭头和交换页面背景来显示下一张/上一张照片来实现我自己的。

令我惊讶的是，这个东西大多只在安卓或 iPhone 上查看时才有效。

我想补充的是，当用户向左/向右滑动时模仿箭头功能。

我需要的只是一些方法来捕捉侧扫事件。JQuery 有一些实用程序吗？

需要尽可能轻的东西。看看[jQTouch](http://jqtouch.com/) .. 这很好，但对于我需要的东西来说有点矫枉过正。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:01:47.933

[差不多](http://stephband.info/jquery.event.swipe/)就是这样，一个用于滑动事件的 jQuery 插件。

# c# - 组合框c#不允许修改选定的索引

> ID：14114562
> 
> 赞同：-2
> 
> 时间：2013-01-01T21:52:17.883
> 
> 标签：c#, combobox, edit, selectedindex

我有一个**组合框**，我希望**所选索引**的字符串无法编辑
我该怎么做？
谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:04:24.063

如果你想阻止编辑组合框的文本框部分的能力，你应该设置

```
 combobox1.DropDownStyle = ComboBoxStyle.DropDownList; 
```

或使用表单设计器中的属性列表设置相同的属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-20T11:23:51.200

```
 private void combobox1_KeyPress(object sender, KeyPressEventArgs e)
  {
      e.Handled = true;
  } 
```

# javascript - 使用 Backbone 路由器导航

> ID：14114566
> 
> 赞同：0
> 
> 时间：2013-01-01T21:52:31.203
> 
> 标签：javascript, backbone.js

我有一个 Backbone.Router 类设置，一切正常。但是，有一点（可能有点阻塞）不便。

为了使用主干路由器导航，我使用以下代码

```
myrouter.navigate('/search_term/2/filter1+filter2/'); 
```

这可以正常工作。但是，URL 的不同参数不会在同一个地方更新。例如，用户可能会转到下一页 (3)，并且不应更新搜索词和过滤器。

我想要做的是这样的

```
myrouter.navigate(':route_id', ':route_value'); 
```

例如，我可以做

```
myrouter.navigate(':query', 'search_term');
myrouter.navigate(':pagination', '5'); 
```

Backbone 可以做到这一点吗？如果没有，任何可能的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:06:25.280

您可以自己实现一个功能，扩展主干路由以按照您想要的方式工作。

如果您阅读路由源代码，您会发现它们仅将您的模式转换为正则表达式模式，非常简单，然后将方法目标与正则表达式匹配的参数一起应用。

因此，如果您想要反向路线导航或类似的东西，您可以应用您的自我扩展 Backbone.Route

像这样的东西：

```
myrouter = Backbone.Router.extends({
    navigate: function(a, b) {
        // Do something with my args here
        var result = doSomething(a, b);

        // Then execute backbone's official navigate with the results
        Backbone.Router.navigate.apply(this, result);
    }
}); 
```

创建你的函数来`doSomething`工作是你需要如何反向创建你的路线。

但是没有 Backbone 原生的方式来做到这一点，路由器不具备高级功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T12:24:42.883

我最终自己解决了这个问题。

解决方案是通过以与提交请求时类似的方式绑定到更改事件来监听模型的更改。

# javascript - Javascript - 首次使用后使用下拉菜单来定位对象属性中断

> ID：14114567
> 
> 赞同：1
> 
> 时间：2013-01-01T21:52:45.610
> 
> 标签：javascript, jquery, json, forms, object

我有一些代码可以接收字符串，将其转换为对象，并允许我通过表单进行编辑。我有一个导入函数，它允许我将另一个字符串引入同一个对象，并且我可以在我的 Web 表单上定位。

我正在尝试使用 DropDown 控件来允许我选择要在表单中查看的对象中的哪个属性。

我的问题是，一旦我将下拉菜单设置为我拥有的 3 个选项中的 1 个并单击 Import，但是创建目标属性需要多次，它会中断并且不允许我专注于其他属性。最好让我带你完成我的演示。

1\. 在这里演示：http: [//jsfiddle.net/vJBQq/1/](http://jsfiddle.net/vJBQq/1/)
2\. 将下拉菜单设置为“View_3”
3\. 单击导入按钮 3 次，将填充表单 4\. 在此阶段，它已动态创建 3 个属性“View_1”、“View_2”和“View_3”。而您正在查看 View_3。
5\. 尝试使用下拉菜单来定位一个说 View_1。这没用。

在这个阶段我有两个问题。
一种）。下拉列表不针对任何其他属性
b)。现在表单已被填充，“导入”按钮也不再起作用。两个控件返回 -`ReferenceError: Button is not defined`

我做错了什么来打破这个。

我的代码'：

```
 var cleanStr = '';
var viewDropDown;

$(document).ready(function() {
    //Import String
    $('#import').click(function() {
        ParseFunction();
    });

});

//--------------------Run Import Parse and Set String------------------------------

//Build Initial Object LIst

function ParseFunction(parameterOne) {

    $(document).on('change', '#selectView', function () {
        ParseFunction();
    });

    newStr = 'View{    Image    { BackgroundImage: Image.gif;        Position: 0, 0;        Width: 320;        Height: 480;    }    Button    { BackgroundImage: Button.gif;        Transition: View2;        Position: 49, 80;        Width: 216;        Height: 71;    }    Button    { BackgroundImage: Button2.gif;        Position: 65, 217;        Width: 188;        Height: 134;    }    Label    { Position: 106, 91;        Width: 96;        Height: 34;        Text: "Button";        FontSize: 32;        Color: 0.12549, 0.298039, 0.364706, 1;    }    Scroll    { Position: 106, 91;        Width: 96;        Height: 34;        Button{     BackgroundImage: Button2.gif;            Position: 65, 217;            Width: 188;            Height: 134;        }        Button{     BackgroundImage: Button2.gif;            Position: 65, 217;            Width: 188;           Height: 134;        }    }}' + ' ';

    str = cleanStr += newStr;
    // Set viewDropDown to current selectView State
    viewDropDown = $('#selectView').val();

    var i = {};
    str = str.replace(/(\w+)\s*\{/g, "$1:{"); // add in colon after each named object
    str = str.replace(/\}(\s*\w)/g, "},$1"); // add comma before each new named object
    str = str.replace(/;/g, ","); // swap out semicolons with commas
    str = str.replace(/,(\s+\})/g, "$1"); // get rid of trailing commas
    str = str.replace(/([\d\.]+(, [\d\.]+)+)/g, "[$1]"); // create number arrays
    str = str.replace(/"/g, ""); // get rid of all double quotes
    str = str.replace(/:\s+([^\[\d\{][^,]+)/g, ':"$1"'); // create strings
    //str = str.replace(/([^:]+):{/g, function(m, p1) { return p1 + "_" + (++i).toString() + ":{"; });
    str = str.replace(/(\S+):{/g, function (m, p1) {
        i[p1] = (i[p1] || 0) + 1;
        return p1 + "_" + i[p1].toString() + ":{";
    });
    //console.log(str);
    var objStr;
    eval("objStr={" + str + "};");
    //End Parse String
    console.log(objStr)

    $('#importCode').remove();
    var $objectList = $('<div id="importCode" />').appendTo($('#code'));

    $.each(objStr[viewDropDown], function (k, v) {
        $('<div/>').append(k).appendTo($objectList).on('click', function () {
            $('#options .wrapper').show();
            $('#options div div').hide();
            var $wrapper = $('#options .wrapper').empty();
            if (typeof v === 'string') {
                $('<div class="item" />').append('<span class="key">' + k + '</span>' + '<input value="' + v + '"/>').appendTo($wrapper);
            } else { //object
                $('<h3 class="formHeading" />').append(k).appendTo($wrapper);
                $.each(v, function (key, val) {
                    $('<div class="item" />').append('<span class="key">' + key + '</span>' + '<input value="' + val + '"/>').appendTo($wrapper);
                });
            }

            $("<button>Save</button>").appendTo($wrapper).on('click', function () {
                if (typeof v === 'string') {
                    v = $(this).closest(".wrapper").find("input").val();
                } else { //object
                    $(this).closest(".wrapper").find(".item").each(function (i, div) {
                        var $div = $(div),
                            key = $div.find(".key").text(),
                            val = $div.find("input").val();
                        v[key] = val;
                    });
                }
            });
        });
        cleanStrPre = JSON.stringify(objStr);
        cleanStr = cleanStrPre.substring(1,cleanStrPre.length-1);
        $('#print').append(cleanStr);

    });

};​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:55:41.227

我想到了。我没有尝试将其实现为单个函数，而是将它们分成 Parse into Object 函数和 Set form 函数。

这里的解决方案[http://jsfiddle.net/vJBQq/2/](http://jsfiddle.net/vJBQq/2/)

```
 var cleanStr = '';
var viewDropDown;
var objStr;

$(document).ready(function() {
    //Import String
    $('#import').click(function() {
        ParseFunction();
    });

});

//--------------------Run Import Parse and Set String------------------------------

//Build Initial Object LIst

function ParseFunction(parameterOne) {

    $(document).on('change', '#selectView', function () {
        setContent();
    });

    newStr = 'View{    Image    { BackgroundImage: Image.gif;        Position: 0, 0;        Width: 320;        Height: 480;    }    Button    { BackgroundImage: Button.gif;        Transition: View2;        Position: 49, 80;        Width: 216;        Height: 71;    }    Button    { BackgroundImage: Button2.gif;        Position: 65, 217;        Width: 188;        Height: 134;    }    Label    { Position: 106, 91;        Width: 96;        Height: 34;        Text: "Button";        FontSize: 32;        Color: 0.12549, 0.298039, 0.364706, 1;    }    Scroll    { Position: 106, 91;        Width: 96;        Height: 34;        Button{     BackgroundImage: Button2.gif;            Position: 65, 217;            Width: 188;            Height: 134;        }        Button{     BackgroundImage: Button2.gif;            Position: 65, 217;            Width: 188;           Height: 134;        }    }}' + ' ';

    str = cleanStr += newStr;
    // Set viewDropDown to current selectView State
    //viewDropDown = $('#selectView').val();

    var i = {};
    str = str.replace(/(\w+)\s*\{/g, "$1:{"); // add in colon after each named object
    str = str.replace(/\}(\s*\w)/g, "},$1"); // add comma before each new named object
    str = str.replace(/;/g, ","); // swap out semicolons with commas
    str = str.replace(/,(\s+\})/g, "$1"); // get rid of trailing commas
    str = str.replace(/([\d\.]+(, [\d\.]+)+)/g, "[$1]"); // create number arrays
    str = str.replace(/"/g, ""); // get rid of all double quotes
    str = str.replace(/:\s+([^\[\d\{][^,]+)/g, ':"$1"'); // create strings
    //str = str.replace(/([^:]+):{/g, function(m, p1) { return p1 + "_" + (++i).toString() + ":{"; });
    str = str.replace(/(\S+):{/g, function (m, p1) {
        i[p1] = (i[p1] || 0) + 1;
        return p1 + "_" + i[p1].toString() + ":{";
    });
    //console.log(str);
    objStr;
    eval("objStr={" + str + "};");
    //End Parse String
    console.log(objStr)

};

function setContent() {
    viewDropDown = $('#selectView').val();
    $('#importCode').remove();
    var $objectList = $('<div id="importCode" />').appendTo($('#code'));

    $.each(objStr[viewDropDown], function (k, v) {
        $('<div/>').append(k).appendTo($objectList).on('click', function () {
            $('#options .wrapper').show();
            $('#options div div').hide();
            var $wrapper = $('#options .wrapper').empty();
            if (typeof v === 'string') {
                $('<div class="item" />').append('<span class="key">' + k + '</span>' + '<input value="' + v + '"/>').appendTo($wrapper);
            } else { //object
                $('<h3 class="formHeading" />').append(k).appendTo($wrapper);
                $.each(v, function (key, val) {
                    $('<div class="item" />').append('<span class="key">' + key + '</span>' + '<input value="' + val + '"/>').appendTo($wrapper);
                });
            }

            $("<button>Save</button>").appendTo($wrapper).on('click', function () {
                if (typeof v === 'string') {
                    v = $(this).closest(".wrapper").find("input").val();
                } else { //object
                    $(this).closest(".wrapper").find(".item").each(function (i, div) {
                        var $div = $(div),
                            key = $div.find(".key").text(),
                            val = $div.find("input").val();
                        v[key] = val;
                    });
                }
            });
        });

    });
    cleanStrPre = JSON.stringify(objStr);
    cleanStr = cleanStrPre.substring(1,cleanStrPre.length-1);
    $('#print').append(cleanStr);
};​ 
```

# python - 创建 GAE 实体时遇到问题

> ID：14114570
> 
> 赞同：1
> 
> 时间：2013-01-01T21:53:11.033
> 
> 标签：python, google-cloud-datastore, typeerror, keyword-argument

当我尝试在 GAE 中提交新实体时，我收到以下错误消息。

```
File "C:\Users\Chris\Documents\Web Apps\legalstudybuddy\main.py", line 179, in post
    c = Courses(user=user, title=title)
TypeError: __init__() got an unexpected keyword argument 'user' 
```

这是我的 Python 代码：

```
class Courses(db.Model):
    user = db.StringProperty(required = True)
    title = db.StringProperty(required = True)
    created = db.DateTimeProperty(auto_now_add = True)

class Courses(Handler):
    def get(self, courses="", title="", signup_username="", login_logout=""):

        if not self.user:
            self.redirect('/login')

        user = str(self.read_secure_cookie('user_id'))
        courses = db.GqlQuery('SELECT * from Courses  WHERE user = :user ORDER BY created DESC', user=user)

        signup_username, login_logout = self.user_check()

        self.render('courses.html', courses=courses,
                    title=title,
                    signup_username=signup_username,
                    login_logout=login_logout)

    def post(self):
        if not self.user:
            self.redirect('/login')

        user = str(self.read_secure_cookie('user_id'))
        title = self.request.get('title')

        if title:
            c = Courses(user=user, title=title)
            c.put()

        self.redirect('/courses') 
```

意外的关键字参数来自创建实体，而不是来自 django 模板。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:56:33.913

你定义`Courses`了两次。曾经作为模型：

```
class Courses(db.Model):
    user = db.StringProperty(required = True)
    title = db.StringProperty(required = True)
    created = db.DateTimeProperty(auto_now_add = True) 
```

但也作为处理程序：

```
class Courses(Handler):
    # code 
```

由于您在第二个定义处理程序，这就是存储`Courses`在当前命名空间中的内容。例如：

```
In [1]: class Courses(object):
   ...:     a = 'First Courses'
   ...:     
   ...:     

In [2]: class Courses(object):
   ...:     a = 'Second Courses'
   ...:     
   ...:     

In [3]: Courses.a
Out[3]: 'Second Courses' 
```

我建议更改处理程序的名称，以免您现在遇到冲突（当您调用时`Courses(user=user)`，它试图调用处理程序而不是模型）。

# javascript - IE8的谷歌地图.setMap问题

> ID：14114576
> 
> 赞同：1
> 
> 时间：2013-01-01T21:54:11.667
> 
> 标签：javascript, internet-explorer, google-maps, google-maps-api-3, internet-explorer-8

所以我这里有点问题。此脚本在除 IE8 之外的所有浏览器中都能正常工作

route() 函数被调用 - 并被赋予谷歌地图编码的多边形和折线。每次 IE8 尝试执行 setMap 时脚本都会中断

我认为这个问题与地图超出其范围有关吗？还是尾随逗号错误？我只是花了最后几个小时玩这个，我无法修复它。

有任何想法吗？？非常感激。通常不喜欢粘贴整个代码，因为它有点压倒性，但在这种情况下需要它。

```
var markersArray = [];

function initMap(lat,lng) {
    if(lat) {

        var myLatLng = new google.maps.LatLng(lat, lng);
        var zoomi=13;
    }else{

        var myLatLng = new google.maps.LatLng(54.162434, -2.285156);
        var zoomi=5;
    }

    var myOptions = {
        zoom: zoomi,
         zoomControl: true,
        panControl: false,
       streetViewControl: false,
       zoomControlOptions: {
            style: google.maps.ZoomControlStyle.LARGE,
            position: google.maps.ControlPosition.LEFT_CENTER
     },
        center: myLatLng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById("map"), myOptions);
}

function route(journeyPolyy,journeyLine,startLat,startLng,endLat,endLng) {

reset();

    var startLatLng=startLat + ',' + startLng;

    var start = new google.maps.LatLng(startLat,startLng);
    var end = new google.maps.LatLng(endLat,endLng);

    var decodedPath = google.maps.geometry.encoding.decodePath(journeyLine);
      var flightPath = new google.maps.Polyline({
        path: decodedPath,
        strokeColor: 'blue',
        strokeOpacity: 0.5,
        strokeWeight: 5
      });
    markersArray.push(flightPath);

    flightPath.setMap(map);
     var marker = new google.maps.Marker({
        position: start
    });

    markersArray.push(marker);

    marker.setMap(map);

     var endPpoint = new google.maps.Marker({
        position: end
    });
    markersArray.push(endPpoint);

    endPpoint.setMap(map);

    poly = journeyPolyy.replace(/\\\\/g,"\\");

    var decodedPath = google.maps.geometry.encoding.decodePath(poly);

    var decodedLevels = decodeLevels("BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB");

    var setRegion = new google.maps.Polygon({
        path: decodedPath,
        levels: decodedLevels,
        strokeColor: "#FF0000",
        strokeOpacity: 0.8,
        strokeWeight: 1,
        fillColor    : '#FF0000',
        fillOpacity  : 0.1,
        map: map
    });
    setRegion.setMap(map);
    markersArray.push(setRegion);
        var obj= document.getElementById('map');
    obj.style.visibility='visible';
    HideContent('mainContent');
    map.setCenter(start); 
    map.setZoom(13); 
}

function decodeLevels(encodedLevelsString) {
    var decodedLevels = [];

    for (var i = 0; i < encodedLevelsString.length; ++i) {
        var level = encodedLevelsString.charCodeAt(i) - 63;
        decodedLevels.push(level);
    }
    return decodedLevels;
}

function reset() {
  if (markersArray) {
    for (i in markersArray) {
      markersArray[i].setMap(null);
    }
    markersArray.length = 0;
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:57:06.953

存在命名冲突（map-objects 名称与元素的 id 相同）

您可以为 div 使用不同的 id，为 map-variable 使用不同的名称，或者在全局范围内声明 map-variable：

```
var map; 
```

# asp.net-mvc - 使用 mongo db 对象的版本容错序列化

> ID：14114579
> 
> 赞同：1
> 
> 时间：2013-01-01T21:54:37.783
> 
> 标签：asp.net-mvc, mongodb, serialization, bson

我是 .net c# 开发人员，目前正在探索与 mongo db 数据库的集成。该数据库将成为 mvc 数据库的后端。

CRUD 操作将从 MVC 应用程序到 mongo db 对数据库执行，并且数据将从一个简单的控制台应用程序插入到其中，该应用程序解析 xml 文件并将数据库插入/更新到 mongo db。

我一直在审查 C Sharp Mongo Db 驱动程序，并且对对象序列化以及与强类型对象的关系等有疑问。我不太清楚的是我是否有一个对象来反映 mongo bson 文档的结构。该对象被序列化到 mongo db 文档中。我对此的疑问是：

*   如果我的应用程序有新版本，增加 dll 版本号怎么办。发布之后，可以将原始数据序列化到新版本的对象中吗？还是我的对象需要具有版本容错性？
*   如果我的控制台应用程序插入数据并且 mvc 应用程序对同一个 bson 文档执行 CRUD 操作，它是否需要在两个应用程序之间共享同一个对象？如果可能的话，我宁愿避免这种依赖，那么处理这个问题的最佳方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T14:45:10.827

您可以在此处查看与版本控制相关的序列化教程中的部分：[http](http://www.mongodb.org/display/DOCS/CSharp+Driver+Serialization+Tutorial#CSharpDriverSerializationTutorial-HandlingSchemaChanges) ://www.mongodb.org/display/DOCS/CSharp+Driver+Serialization+Tutorial#CSharpDriverSerializationTutorial-HandlingSchemaChanges 。

1）要回答您的第一个问题，您的对象肯定需要具有版本容错性。

2）只要映射相同，它们就不需要共享同一个对象。这意味着相同的结构、相同的属性和相同的约定。

话虽如此，共享同一个数据对象并不是世界末日。而且您不会在两个系统之间创建依赖关系。相反，您将创建一个共享库，其中包含持久化数据所需的对象和代码。然后，您不需要在两种不同的媒体之间复制代码。将共享库视为 API。

另一种方法是让控制台应用程序调用 MVC 应用程序来上传数据。MVC 应用程序不仅成为用户交互的 API，也成为程序的 API。再次，逻辑在一个地方。

# html - 在 Chrome 中测试时如何禁用 HTML 缓存？

> ID：14114580
> 
> 赞同：12
> 
> 时间：2013-01-01T21:54:39.910
> 
> 标签：html, caching, testing, requirejs

我认为这是因为缓存，但我不完全确定。

我遇到的问题是，当我更改文件并保存它时，它有一段时间没有在我的浏览器中更新。我认为这是因为该文件已缓存在我的浏览器中并且正在加载以前的版本。由于我正在测试，我需要弄清楚如何禁用它，因为我会经常更改文件。

尝试在网上搜索此内容，但无法真正找到我要查找的内容。

我目前在 localhost 上运行它，但更改的文件只是 HTML

编辑：

我知道我的文件没有问题，因为如果我在新浏览器中打开它，它会加载新版本的页面。

我正在尝试使用 chrome 进行测试。

编辑2：

另外，被更改的文件是通过require.js加载的，所以不是URL中输入的直接文件

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-01T22:14:37.843

如果您打开 chrome 开发人员工具并点击设置按钮（开发人员工具面板右下角的齿轮图标），弹出窗口中应该有一个“禁用缓存”选项

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-06T01:45:00.773

我注意到您在 EDIT2 中的问题中提到您正在使用 require.js。如果不想禁用浏览器缓存，可以设置 RequireJS config urlArgs 选项。Require.js 有一个配置选项，您可以使用它来禁用正在缓存的文件。

这是 Require.js 文档的摘录：[Require.js urlArgs](http://requirejs.org/docs/api.html#config-urlArgs)

> urlArgs：附加到 RequireJS 用于获取资源的 URL 的额外查询字符串参数。当浏览器或服务器未正确配置时，最有用的是缓存 bust。示例缓存破坏设置
> 
> urlArgs: urlArgs: "bust=" + (new Date()).getTime()
> 
> 在开发过程中，使用它可能很有用，但是请务必在部署代码之前将其删除。

以下是它的外观示例：

```
requirejs.config({
    urlArgs: "bust=" + (new Date()).getTime(),  
    paths: {
        "jquery": "libs/jquery-1.8.3",
        "underscore": "libs/underscore",
        "backbone": "libs/backbone"
    },
});

require(["jquery", "underscore", "backbone"],
    function ($, _, Backbone) {
        console.log("Test output");
        console.log("$: " + typeof $);
        console.log("_: " + typeof _);
        console.log("Backbone: " + typeof Backbone);
    }
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-28T16:50:23.790

如果我们要检查文件系统上的脚本而不是本地 Web 服务器，我会选择这个，而不是检查 location.host（在这种情况下是一个空字符串）：

```
var require.urlArgs = (window.location.protocol == 'file:') ? 'bust='+new Date().getTime() : '' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-01T22:02:55.173

当我有这种疑问时，我所做的就是在 url 的末尾添加一个随机参数。

例子：

```
http://localhost/foo/bar.html?randomParam=873738424 
```

这会禁用浏览器缓存响应的可能性。这可以手动或以编程方式完成，因为这是一个非常简单的解决方案。

如果存在无法识别的参数，通常应用程序不会出错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-01T22:13:28.107

尝试在重新加载页面之前清除浏览器的缓存（ctrl+shift+delete）。

您也可以按 Shift 并单击重新加载，以便刷新文件并且不使用缓存。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-01T22:02:56.763

包含在头部

```
<meta http-equiv="Expires" CONTENT="0">
<meta http-equiv="Cache-Control" CONTENT="no-cache">
<meta http-equiv="Pragma" CONTENT="no-cache"> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-26T18:51:56.310

**忽略：**使用 r.js 编译时似乎不允许使用函数。:(

支持 BarDev，这样的事情怎么样：

```
requirejs.config({
    urlArgs: (function(){
        return (location.host=='localhost') ? 'bust='+(new Date().getTime()) : '';
    }())
}); 
```

现在您可以将代码留在其中，而不必担心在生产中无意中破坏缓存。

# python - Pyhook 在 6 次按下后停止捕获关键事件

> ID：14114581
> 
> 赞同：1
> 
> 时间：2013-01-01T21:54:44.650
> 
> 标签：python, windows, python-2.7, pyhook

我编写了一个脚本来在使用 pyHook 按下一个键时移动鼠标。问题是，在 6 次按键事件之后，脚本停止拾取按键，需要从任务管理器中结束。

我在 Windows 7 机器上使用 python 2.7。我还没有找到其他人对类似问题有答案。

该代码旨在钩住鼠标，然后单击鼠标移动光标，松开鼠标并钩住键盘。在那里，键盘挂钩仅适用于 6 个事件。如果我同时挂上鼠标和键盘，则每个钩子仅适用于 6 个事件。有谁知道问题是什么以及如何解决？

```
import pythoncom, pyHook, win32api
import math
from time import sleep

# Radius is 250px
radius = 50

# Intervals in the circle
n_intervals = 50

# List of intervals
l_intervals = []
for i in range(0, n_intervals):
        l_intervals.append((i+1) * math.pi * 2 / n_intervals)
# Move the cursor in a circle
def move_circle():
        (x, y) = win32api.GetCursorPos()
        old_pos = (x, y)
        center = (x-radius, y)
        for i in l_intervals:
                p = (radius * math.cos(i), radius * math.sin(i))
                new_pos = (int(center[0]+p[0]), int(center[1]-p[1]))
                win32api.SetCursorPos(new_pos)
                sleep(0.01)

def OnKeyboardEvent(event):
    if event.Key == "Media_Play_Pause":
        exit()
    else:
        move_circle()

    # return True to pass the event to other handlers
    return True

def OnMouseEvent(event):
    # called when mouse events are received
        if event.MessageName == "mouse left down":
                move_circle() # move the cursor
            hm.UnhookMouse() # unhook the mouse
            hm.HookKeyboard() # hook the keyboard
        return True

hm = pyHook.HookManager()
hm.MouseAll = OnMouseEvent
hm.KeyDown  = OnKeyboardEvent
# Hook the mouse
hm.HookMouse()
# Wait for any events
pythoncom.PumpMessages() 
```

**更新：**我找到了一个解决方案并在下面发布了答案，但仍然希望有任何答案可以解释我首先遇到问题的原因，以及解决方案解决问题的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T02:03:58.283

经过更多的谷歌搜索后，我找到了一个对我有用的解决方案：[pyHook + pythoncom stop working after too many keys press [Python]](https://stackoverflow.com/questions/3673769/pyhook-pythoncom-stop-working-after-too-much-keys-pressed-python)。我尝试了他的第一个建议，我的问题似乎解决了。我的代码的 pyHook 部分现在如下所示。

```
import pythoncom, pyHook, win32api, sys
import math
import threading, time
from time import sleep
...
#attempt to stop pyHook hang...             
lock = threading.Lock()
def KeyEventThread1(i):
    lock.acquire()
    sys.exit()
    lock.release()
def KeyEventThread2(i):
    lock.acquire()
    move_circle()
    lock.release()

def OnKeyboardEvent(event):
    if event.Key == "Media_Play_Pause":
        t = threading.Thread(target=KeyEventThread1, args=(1,))
        t.start()
        sys.exit()
    else:
        t = threading.Thread(target=KeyEventThread2, args=(1,))
        t.start()
    # return True to pass the event to other handlers
    return True

def MouseEventThread(i):
    lock.acquire()
    sleep(.2) #So that mouse is not depressed when moved
    move_circle() # move the cursor
    hm.UnhookMouse() # unhook the mouse
    lock.release()  

def OnMouseEvent(event):
    # called when mouse events are received
    if event.MessageName == "mouse left down":
        t = threading.Thread(target=MouseEventThread, args=(1,))
        t.start()
    hm.HookKeyboard()
    return True

hm = pyHook.HookManager()
hm.MouseAll = OnMouseEvent
hm.KeyDown  = OnKeyboardEvent
# Hook the mouse
hm.HookMouse()
 # hook the keyboard

# Wait for any events
pythoncom.PumpMessages() 
```

# compiler-construction - 是否对符号表使用堆栈

> ID：14114584
> 
> 赞同：2
> 
> 时间：2013-01-01T21:54:55.227
> 
> 标签：compiler-construction, stack, symbol-tables, symbol-table

我正在创建一个编译器，并且遇到了一些文本，这些文本提出了两种不同的实现符号表的方法。使用一个，每个嵌套级别都有一个符号表，存储在堆栈中。使用第二个选项，只有两个符号表，一个符号表用于维护所有条目，另一个用于跟踪对主表的更改，以便在您通过后知道要删除哪些条目那个特定的块。这些不同实现的优点和缺点是什么？我敢肯定，就删除单个块的符号表而言，第一个选项会更快，但这会带来一些开销（我不清楚）。第二个显然是资源密集型的，因为要删除具有许多声明的大块，

# php - 使用正则表达式在 MongoDB 中搜索任何值？

> ID：14114586
> 
> 赞同：1
> 
> 时间：2013-01-01T21:55:01.033
> 
> 标签：php, regex, json, mongodb, mongoose

我对 MongoDB 和正则表达式非常陌生，所以请多多包涵。MongoDB 文档有一个使用正则表达式进行搜索的示例：

[http://docs.mongodb.org/manual/reference/operators/#_S_regex](http://docs.mongodb.org/manual/reference/operators/#_S_regex)

但是，它只显示了如何搜索预定键的值。我不确定如何编写查询来搜索集合中的所有值，如果有人能指出那会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:27:47.167

如果您不关心数据库的大小（或性能），您可能会使用[mapReduce](http://docs.mongodb.org/manual/applications/map-reduce/)函数将数据反规范化为更易于搜索的结构。但是，这将显着增加数据库的大小，因为您将复制集合的所有数据。

伪代码：

```
// recursive
// building a full property path
for(var key in obj) {
    emit(this._id, { orig: obj[key], src: path + "." + key });
    // recursive call emitChildren(path, key)
} 
```

根据数据的复杂性，它可能是合理的。

或者，您可以使用[$where](http://docs.mongodb.org/manual/reference/operators/#_S_where)对所有文档的每个键/值执行正则表达式（因为您可以在使用 $where 时执行任意 JavaScript）。

如果您对集合中每个文档中的每个值运行正则表达式，则没有任何选项会表现良好（即使是内置选项）也不会发挥 mongoDB 的优势。

# java - 不同对象之间的 Java 线程处理

> ID：14114589
> 
> 赞同：2
> 
> 时间：2013-01-01T21:55:22.750
> 
> 标签：java, multithreading

当我尝试学习 Java 线程时，我通常会遇到同一个类中的代码示例`wait()`（`notify()`实际上几乎所有这些都是生产者-消费者示例）。在谷歌搜索各种示例后，不幸的是我找不到我需要的案例：

*   管理器线程最初创建 n 个线程（并启动它们），其中 http get 请求在单个线程中完成。
*   对于单个工作线程，完成其生命周期大约需要 20-30 秒。
*   在这里，我的经理线程必须知道哪些工人已经完成，并用新的替换完成线程。

我想过这样的方法（让 n 为 5）：

```
List<Runnable> runnables = new ArrayList<Runnable>();
for(int i = 0 ; i < 5 ; i++){
    runnables.add(new MyWorker(params));
}
for(Runnable myWorker : runnables){
   myWorker.run();
} 
```

由于`wait()`不支持多个对象，我不能从这里继续。另一种解决方案是在为每个工作人员调用一些 isFinished 标志的管理器线程上实现繁忙等待。但我不确定这是否是一个好方法（据我所知这是资源浪费）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:47:50.413

Java 6 及更高版本有一个即用型工具，形式为执行器框架。

由于您希望拥有固定的线程池，因此最好的选择是使用：

```
ExecutorService service = Executors.newFixedThreadPool(5); 
```

然后，您可以使用该方法（由接口定义）提交您的`Runnable`实例。一旦池中的线程可用，它们将被提交到工作队列并出列。`.execute()``Executor`

如果您的各个线程工作方法返回一个值（即它们实现`Callable<Something>`），那么您可以使用该`.submit()`方法（由 定义`ExecutorService`，也是一个扩展的接口`Executor`），它将返回一个`Future<Something>`您将从`.get()`中计算的值。

终止线程池有多种方式：`.shutdown()`是最基本的，将同步等待仍然活动的线程终止（并阻止提交新作业）。

Javadocs：[Executors](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executors.html)、[ExecutorService](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html)、[ThreadPoolExecutor](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadPoolExecutor.html)。

其他链接：[一本你应该为所有与线程相关的东西买的书](http://www.jcip.net/)（但不包括 Java 7 `ForkJoinPool`）。

PS：多么幸运，[上面本书的示例章节（PDF）](http://www.jcip.net/jcip-sample.pdf)涵盖了任务执行；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:50:59.710

您可以使用`semaphore`和`wait/notify`方法来完成您正在尝试做的事情。方法是：

1.  `semaphore`一次允许的最大线程数初始化。
2.  等到任务可用`queue`。
3.  获取一个`semaphore`.
4.  运行任务并在完成时释放`semaphore`.

将所有四个步骤都放在永远的 while 循环中，您就可以使用任务执行器了。这仅用于学习目的，正如@fge 所说，已经存在`ThreadPoolExecuter`可以为您做同样事情并且更加优化的东西。

```
import java.util.LinkedList;
import java.util.Queue;
import java.util.concurrent.Semaphore;

public class ThreadExecuter extends Thread {

    Queue<Runnable> tasks = new LinkedList<Runnable>();
    Semaphore s;
    Object bin = new Object();

    public ThreadExecuter(int n) {
        s = new Semaphore(n);
    }

    public void addTask(Runnable r) {
        synchronized (bin) {
            tasks.add(r);
            bin.notifyAll();
        }
    }

    public void run() {
        while (true) {
            try {
                final Runnable r;
                synchronized (bin) {
                    while (tasks.isEmpty())
                        bin.wait();
                    r = tasks.poll();
                }

                s.acquire();
                new Thread() {
                    public void run() {
                        r.run();
                        s.release();
                    }
                }.start();
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }

    }
} 
```

主要方法如下所示：

```
import java.util.Random;

public class ThreadTest {

    /**
     * @param args
     */
    public static void main(String[] args) {
            /* to make maximum 10 threads each running 1 runnable */
        ThreadExecuter executer = new ThreadExecuter(10);
        executer.start();

        for(int i = 0; i < 5000; i++) {
                    /* add task in executer, this is non blocking */
            executer.addTask(new Runnable() {
                @Override
                public void run() {
                    System.out.println("Task Executed in " 
                                        + Thread.currentThread().getId());
                    try {
                        Thread.sleep(new Random().nextInt(8000));
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            });
        }
    }

} 
```

# ruby - 来自 ruby 的控制台命令不起作用

> ID：14114591
> 
> 赞同：-1
> 
> 时间：2013-01-01T21:55:49.283
> 
> 标签：ruby, linux, macos

我克隆 github 仓库

```
https://github.com/DeNADev/HandlerSocket-Plugin-for-MySQL 
```

而不是预编译应该运行

```
./autogen.sh 
```

从控制台它工作，记录：

```
Searching libtoolize...
-e  FOUND: libtoolize -> glibtoolize
... 
```

但如果我从 ruby​​ 脚本中做到这一点

```
 system "git clone https://github.com/DeNADev/HandlerSocket-Plugin-for-MySQL.git handlersocket-plugin"
  Dir.chdir("handlersocket-plugin") do
    system "./autogen.sh"
  end 
```

日志：

```
./autogen.sh 
Searching libtoolize...
-e  WARNING: Cannot Found libtoolize... input libtool command
... 
```

我该如何解决？

在 Mac OS 上工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:01:38.547

检查您的环境变量，尤其是`PATH`
从 shell：

```
env 
```

来自红宝石：

```
p ENV 
```

# android - Google Analytics Android trackEvent 参数错误

> ID：14114595
> 
> 赞同：0
> 
> 时间：2013-01-01T21:56:11.927
> 
> 标签：android, eclipse, google-analytics, arguments

尝试实现该方法时：

```
EasyTracker.getTracker().trackEvent("AdultAbxActivity Clicks", 
"Comments Click", infection, 0); 
```

我从 Eclipse 得到这个错误：

*Tracker 类型中的方法 trackEvent(String, String, String, Long) 不适用于参数 (String, String, String, int)*

它建议我将参数“0”转换为“长”。

然而官方参考指出最后一个参数应该是一个 int：

[https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiEventTracking?hl=en](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiEventTracking?hl=en)

我是否应该按照日食的建议进行此操作，并且它会起作用。还是我的 Eclipse 错了？

谢谢，山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T08:13:56.457

您帖子中的 URL 指向网络跟踪部分。我想您正在使用 Google Analytics Android SDK。因此，对于[trackEvent](https://developers.google.com/analytics/devguides/collection/android/v2/events)方法，参数应该是（String、String、String、Long）。如果是这样，那么只需将行更改为以下内容：

```
EasyTracker.getTracker().trackEvent("AdultAbxActivity Clicks", 
        "Comments Click", infection, 0l); 
```

# python - 离散值的 ODE 集成

> ID：14114596
> 
> 赞同：3
> 
> 时间：2013-01-01T21:56:13.283
> 
> 标签：python, scipy, ode

我想使用`scipy.integrate.ode`求解器。我只能将可调用函数定义`f`为离散点数组（因为它取决于先前迭代的积分结果）。但从文档看来，集成商希望可调用函数是一个连续函数。我想需要进行某种插值。求解器可以自己处理这个问题，还是我需要编写一些插值程序？是否有一些解释它的 scipy 文档/教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T08:54:57.777

是的，可调用对象必须是一个函数，它返回提供给函数的任何值的导数。如果您有一个`interp`进行插值的函数，则可以按如下方式定义可调用对象：

```
f = lambda t,y: interp(y, yvalues, fvalues) 
```

如果您的系统是标量的，您可以使用`numpy.interp`以下示例中的函数：

```
import numpy
from scipy import integrate
yvalues = numpy.arange(-2,3,0.1)
fvalues = - numpy.sin(yvalues)
f = lambda t,y: numpy.interp(y, yvalues, fvalues)
r = integrate.ode(f)
r.set_initial_value(1)
t1 = 10
dt = 0.1
while r.successful() and r.t < t1:
    r.integrate(r.t+dt)
    print r.t, r.y 
```

对于多维系统，插值非常复杂。如果有任何方法可以在给定点动态计算导数，那么它可能比使用插值更容易实现。

正如 unutbu 在评论中指出的那样，如果您进行插值，您将在足够长的时间内使用混沌系统得到错误的解决方案。但是，由于任何数值求解算法都是如此，因此很难对此做任何事情。

# php - php - 使用全局变量的网站安全性

> ID：14114602
> 
> 赞同：6
> 
> 时间：2013-01-01T21:56:48.680
> 
> 标签：php, security, forum, phpbb

我最近在浏览一些 php 源代码，尤其是 phpbb 和 esotalk 之类的论坛软件

我注意到一件事，他们中的大多数人在页面开头使用了一个全局变量作为某种安全性，如下所示：

```
if (!defined("IN_ESOTALK")) exit; //For esotalk
if (!defined("IN_PHPBB")) exit; //FOR phpbb 
```

这是一种什么样的安全感？我不明白。你能向我解释一下这会阻止什么以及如何阻止吗？

谢谢， 维杜

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-01T21:59:45.827

它的工作原理是确保除非框架启动，否则 php 脚本不会运行。这样用户就不能在不经过正确页面的情况下执行脚本。

这是一个例子。我们有 2 个文件：

索引.php

```
<?php
     define("_MY_FRAMEWORK", 1);
     echo 'started';
     require('script.php');
?> 
```

和 script.php

```
<?php
    if (!defined("_MY_FRAMEWORK")) exit;
    echo "my script";
?> 
```

如果直接运行script.php，什么都不会发生，因为`_MY_FRAMEWORK`还没有定义。它会退出。

但是，如果您运行包含 script.php 的 index.php，则该脚本将继续执行，因为您确实`_MY_FRAMEWORK`先定义了。您将获得完整的输出：`started`后跟`my script`.

@Gumbo 提出了一个很好的观点：如果您以前没有看过定义，它定义了一个无法更改的常量。[用户对 PHP 文档](http://php.net/manual/en/language.constants.php)的贡献有助于理解其工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:05:17.260

这些是全局常量。有了这些，他们可以确保他们的软件按预期运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T22:02:30.770

这也可以防止使用 register_globals 进行变量操作。

如果在 php.ini 中启用了 register_globals，用户可以通过更改 URL 中的变量来修改脚本中的变量，但这不允许他们修改使用 define 函数定义的常量变量的值

# php - 使用 PHP 创建桌面应用程序

> ID：14114604
> 
> 赞同：8
> 
> 时间：2013-01-01T21:56:58.197
> 
> 标签：php, web, cross-platform, desktop-application

我有一个 PHP/MySQL 驱动的 SaaS 应用程序，我想部署它的离线版本。我不想使用现有的众多 PHP GUI 工具中的任何一个，因为这需要重新构建 GUI，并且我希望它看起来与 Web 版本完全相同。

我想在客户端的系统上运行 Apache/MySQL 服务器（或类似的东西）并以某种方式编译 PHP 代码，这样源代码就不可见了。这样做的最佳方法是什么？理想情况下，我希望拥有一个可以启动/停止服务器的 .exe 文件。

以下是一个非常相似的问题，但它与 Python 而不是 PHP：[Create application for web & desktop](https://stackoverflow.com/questions/10845428/create-application-for-web-desktop)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T22:04:14.500

您可以通过创建压缩的[phar 存档](http://php.net/intro.phar)来“隐藏”源代码。

作为网络服务器，您可以使用[PHP 内置的网络服务器](http://php.net/features.commandline.webserver)。

作为离线数据库，通常 sqlite 是合适的，如果您需要 Mysql，还有[一个嵌入式版本的 Mysql 可用](http://dev.mysql.com/doc/refman/5.5/en/libmysqld.html)，因此您也可以嵌入它，可能通过 PHP C 扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-11T11:29:35.103

[TideSDK](http://www.tidesdk.org/)将是一个不错的选择。他们提供更好的支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T00:28:41.357

[Server2go](http://www.server2go-web.de/) + [Ioncube](http://www.ioncube.com/)可能是你最好的选择

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-03T20:16:37.750

有一些工具和技术可以在这方面有所帮助。从站点检查此列表：[使用 PHP 开发跨平台桌面应用程序的 3 种方法](http://www.sitepoint.com/3-ways-develop-cross-platform-desktop-apps-php/)，这里是使用 PHP 完成的应用程序示例：[使用 PHP 和 PHP 桌面创建您的第一个桌面应用程序](http://phpocean.com/tutorials/back-end/create-your-first-desktop-application-with-php-and-php-desktop/4)

# c# - 如何在 WPF 中的 TabItem 内包含一组默认控件

> ID：14114607
> 
> 赞同：0
> 
> 时间：2013-01-01T21:57:31.367
> 
> 标签：c#, wpf, xaml, styles, controltemplate

我正在学习`WPF`，它对所有的`DataTemplate`东西都非常困惑。我有一个`TabControl`，在里面我会创造很多`TabItems`。有两种`TabItems`，一种包含 1 `textbox`，另一种包含 a`textbox`和 a `listbox`。

像这样：

![在此处输入图像描述](../Images/9d57b97732c0400f584e2bbd6da2a25f.png)

我制作了十几个这样的选项卡，以不同的组合，我怎样才能制作一个模板/预制控件，我可以说，我想要`TabControl.AddTab(style1)`和另一个时间`.Add(Style2)`......

这可能吗？我该怎么做呢？

`listbox`第二个问题，如果完成了，如果名称是自动生成的，我将如何引用任何一个选项卡的内部？

以下是 XAML 中的两种不同类型：

```
<TabItem Header="Style2">
    <TextBox IsReadOnly="True" TextWrapping="Wrap" />
</TabItem>

<TabItem Header="Style1">
    <DockPanel>
        <ListBox DockPanel.Dock="Right">
            <ListBoxItem>User1</ListBoxItem>
            <ListBoxItem>User2</ListBoxItem>
        </ListBox>
        <TextBox IsReadOnly="True" />
    </DockPanel>
</TabItem> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:06:15.127

在 WPF 中，您可以利用控件的 ItemTemplate（用于标题）和 ContentTemplate（用于选项卡内的内容）来控制内容。

在 ContentTemplate 内的 DataTemplate 中定义 dedired 控件。

**这是一个未经测试的示例：**

```
<TabControl ItemsSource="{Binding Path=AllTabs, Mode=OneWay}">
  <TabControl.ItemTemplate>
    <DataTemplate>
      <TextBlock Text="{Binding Path=HEADERPROPERTY}" Margin="4,2,2,2" />
    </DataTemplate>
  </TabControl.ItemTemplate>
  <TabControl.ContentTemplate>
    <DataTemplate>
      <StackPanel Orientation="Vertical">
        <TextBlock Text="{Binding Path=SOMEPROPERTY}" />
        <TextBlock Text="{Binding Path=SOMEOTHERPROPERTY}" />
        <TextBox Text="{Binding Path=SOMETEXTPROPERTY}" />
      </Grid>
    </DataTemplate>
  </TabControl.ContentTemplate>
</TabControl> 
```

前提是绑定中的“AllTabs”属性是一个 ObservableCollection，其中包含一个类，该类包含您想要显示的不同属性。就像 Header 所在的 String 属性（或更多）一样。以及您需要在内容中显示的任何内容。

# android - AndroidManifest.xml 语法检查工具？

> ID：14114609
> 
> 赞同：1
> 
> 时间：2013-01-01T21:57:38.450
> 
> 标签：android, xml, validation, android-manifest

是否有任何独立的（独立于 Eclipse 或 IDE 特定的）工具可以检查`AndroidManifest.xml`文件的错误？

我最近遇到了一个烦人的问题，我`reciever`在应该输入的时间输入`receiver`（*i*在*e*之前，除了*c* ...之后）。除了运行时失败外，没有任何其他指示错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T00:23:49.837

Android 的 Lint 可[从命令行](http://developer.android.com/tools/help/lint.html)获得。我不能说它是否捕捉到了那个特定的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T23:31:05.803

Eclipse 并不真正支持开箱即用的 XML 编辑，而且 Android 没有用于 XML 文件的语法检查器。我猜他们希望人们使用 UI builder。

你需要安装一个第三方插件，我相信这些插件都不是专门为Android XML文件提供帮助的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-06-23T08:12:07.887

公共ArrayList parseJSON（字符串结果）{

ArrayList users = new ArrayList(); 尝试 {

```
 JSONArray jArray = new JSONArray(result);

        for (int i = 0; i < jArray.length(); i++) {
            JSONObject json_data = jArray.getJSONObject(i);
            Users user = new Users();
            user.setId(json_data.getInt("id"));
            user.setName(json_data.getString("name"));
            user.setPlace(json_data.getString("place"));
            users.add(user);
        }
    } catch (JSONException e) {
        Log.e("log_tag", "Error parsing data " + e.toString());
    }
    return users;
} 
```

# python - 使用有限的数据查找多边形的中心

> ID：14114610
> 
> 赞同：5
> 
> 时间：2013-01-01T21:57:43.740
> 
> 标签：python, voronoi

我正在实施 Voronoi 细分，然后进行平滑处理。对于平滑，我打算做劳埃德放松，但我遇到了一个问题。

我正在使用以下模块来计算 Voronoi 边：

[https://bitbucket.org/mozman/geoalg/src/5bbd46fa2270/geoalg/voronoi.py](https://bitbucket.org/mozman/geoalg/src/5bbd46fa2270/geoalg/voronoi.py)

对于平滑，我需要知道每个多边形的边缘，以便我可以计算中心，不幸的是这段代码没有提供。

我可以访问的信息包括：

*   所有节点的列表，
*   所有边的列表（但只是它们在哪里，而不是与它们关联的节点）。

谁能看到一个相对简单的计算方法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-02T00:11:50.440

要找到质心，您可以使用[wikipedia 上描述的公式](http://en.wikipedia.org/wiki/Centroid#Centroid_of_polygon)：

```
import math

def area_for_polygon(polygon):
    result = 0
    imax = len(polygon) - 1
    for i in range(0,imax):
        result += (polygon[i]['x'] * polygon[i+1]['y']) - (polygon[i+1]['x'] * polygon[i]['y'])
    result += (polygon[imax]['x'] * polygon[0]['y']) - (polygon[0]['x'] * polygon[imax]['y'])
    return result / 2.

def centroid_for_polygon(polygon):
    area = area_for_polygon(polygon)
    imax = len(polygon) - 1

    result_x = 0
    result_y = 0
    for i in range(0,imax):
        result_x += (polygon[i]['x'] + polygon[i+1]['x']) * ((polygon[i]['x'] * polygon[i+1]['y']) - (polygon[i+1]['x'] * polygon[i]['y']))
        result_y += (polygon[i]['y'] + polygon[i+1]['y']) * ((polygon[i]['x'] * polygon[i+1]['y']) - (polygon[i+1]['x'] * polygon[i]['y']))
    result_x += (polygon[imax]['x'] + polygon[0]['x']) * ((polygon[imax]['x'] * polygon[0]['y']) - (polygon[0]['x'] * polygon[imax]['y']))
    result_y += (polygon[imax]['y'] + polygon[0]['y']) * ((polygon[imax]['x'] * polygon[0]['y']) - (polygon[0]['x'] * polygon[imax]['y']))
    result_x /= (area * 6.0)
    result_y /= (area * 6.0)

    return {'x': result_x, 'y': result_y}

def bottommost_index_for_polygon(polygon):
    bottommost_index = 0
    for index, point in enumerate(polygon):
        if (point['y'] < polygon[bottommost_index]['y']):
            bottommost_index = index
    return bottommost_index

def angle_for_vector(start_point, end_point):
    y = end_point['y'] - start_point['y']
    x = end_point['x'] - start_point['x']
    angle = 0

    if (x == 0):
        if (y > 0):
            angle = 90.0
        else:
            angle = 270.0
    elif (y == 0):
        if (x > 0):
            angle = 0.0
        else:
            angle = 180.0
    else:
        angle = math.degrees(math.atan((y+0.0)/x))
        if (x < 0):
            angle += 180
        elif (y < 0):
            angle += 360

    return angle

def convex_hull_for_polygon(polygon):
    starting_point_index = bottommost_index_for_polygon(polygon)
    convex_hull = [polygon[starting_point_index]]
    polygon_length = len(polygon)

    hull_index_candidate = 0 #arbitrary
    previous_hull_index_candidate = starting_point_index
    previous_angle = 0
    while True:
        smallest_angle = 360

        for j in range(0,polygon_length):
            if (previous_hull_index_candidate == j):
                continue
            current_angle = angle_for_vector(polygon[previous_hull_index_candidate], polygon[j])
            if (current_angle < smallest_angle and current_angle > previous_angle):
                hull_index_candidate = j
                smallest_angle = current_angle

        if (hull_index_candidate == starting_point_index): # we've wrapped all the way around
            break
        else:
            convex_hull.append(polygon[hull_index_candidate])
            previous_angle = smallest_angle
            previous_hull_index_candidate = hull_index_candidate

    return convex_hull 
```

我使用[礼物包装算法](http://en.wikipedia.org/wiki/Gift_wrapping_algorithm)来找到外部点（又名[凸包](http://en.wikipedia.org/wiki/Convex_hull)）。有很多方法可以做到这一点，但礼品包装很好，因为它的概念和实用简单。这是一个解释这个特定实现的动画 gif：

![从最底部节点开始逆时针包装礼物的分步动画 gif](../Images/e4215ba06c6c9b0f8be3ac2f6cd585b6.png)

这是一些简单的代码，用于根据 voronoi 图的节点和边的集合来查找单个 voronoi 单元的质心。它引入了一种查找属于节点的边的方法，并依赖于前面的质心和凸包代码：

```
def midpoint(edge):
    x1 = edge[0][0]
    y1 = edge[0][9]
    x2 = edge[1][0]
    y2 = edge[1][10]

    mid_x = x1+((x2-x1)/2.0)
    mid_y = y1+((y2-y1)/2.0)

    return (mid_x, mid_y)

def ccw(A,B,C): # from http://www.bryceboe.com/2006/10/23/line-segment-intersection-algorithm/
    return (C[1]-A[1])*(B[0]-A[0]) > (B[1]-A[1])*(C[0]-A[0])

def intersect(segment1, segment2): # from http://www.bryceboe.com/2006/10/23/line-segment-intersection-algorithm/
    A = segment1[0]
    B = segment1[1]
    C = segment2[0]
    D = segment2[1]
    # Note: this doesn't catch collinear line segments!
    return ccw(A,C,D) != ccw(B,C,D) and ccw(A,B,C) != ccw(A,B,D)

def points_from_edges(edges):
    point_set = set()
    for i in range(0,len(edges)):
          point_set.add(edges[i][0])
          point_set.add(edges[i][11])

    points = []
    for point in point_set:
          points.append({'x':point[0], 'y':point[1]})

    return list(points)

def centroids_for_points_and_edges(points, edges):

    centroids = []

    # for each voronoi_node,
    for i in range(0,len(points)):
        cell_edges = []

        # for each edge
        for j in range(0,len(edges)):
            is_cell_edge = True

            # let vector be the line from voronoi_node to the midpoint of edge
            vector = (points[i],midpoint(edges[j]))

            # for each other_edge
            for k in range(0,len(edges)):

                # if vector crosses other_edge
                if (k != j and intersect(edges[k], vector)):
                    # edge is not in voronoi_node's polygon
                    is_cell_edge = False
                    break

            # if the vector didn't cross any other edges, it's an edge for the current node
            if (is_cell_edge):
                cell_edges.append(edges[j])

        # find the hull for the cell
        convex_hull = convex_hull_for_polygon(points_from_edges(cell_edges))

        # calculate the centroid of the hull
        centroids.append(centroid_for_polygon(convex_hull))

    return centroids

edges = [
  ((10,  200),(30,  50 )),
  ((10,  200),(100, 140)),
  ((10,  200),(200, 180)),
  ((30,  50 ),(100, 140)),
  ((30,  50 ),(150, 75 )),
  ((30,  50 ),(200, 10 )),
  ((100, 140),(150, 75 )),
  ((100, 140),(200, 180)),
  ((150, 75 ),(200, 10 )),
  ((150, 75 ),(200, 180)),
  ((150, 75 ),(220, 80 )),
  ((200, 10 ),(220, 80 )),
  ((200, 10 ),(350, 100)),
  ((200, 180),(220, 80 )),
  ((200, 180),(350, 100)),
  ((220, 80 ),(350, 100))
]

points = [
  (50,130),
  (100,95),
  (100,170),
  (130,45),
  (150,130),
  (190,55),
  (190,110),
  (240,60),
  (245,120)
]

centroids = centroids_for_points_and_edges(points, edges)
print "centroids:"
for centroid in centroids:
    print "  (%s, %s)" % (centroid['x'], centroid['y']) 
```

下面是脚本结果的图像。蓝线是边缘。黑色方块是节点。红色方块是蓝色线的派生顶点。顶点和节点是任意选择的。红十字是质心。虽然不是真正的 voronoi 镶嵌，但用于获取质心的方法应该适用于由凸单元组成的镶嵌：

![具有计算质心和任意选择的近似中心的三角点云](../Images/c078a2940de4d568104c2a702dc2a3d2.png)

这是渲染图像的html：

```
<html>
<head>
  <script>
    window.onload = draw;
    function draw() {
      var canvas = document.getElementById('canvas').getContext('2d');

      // draw polygon points
      var polygon = [ 
        {'x':220, 'y':80},
        {'x':200, 'y':180},
        {'x':350, 'y':100},
        {'x':30, 'y':50}, 
        {'x':100, 'y':140},
        {'x':200, 'y':10},
        {'x':10, 'y':200},
        {'x':150, 'y':75}
      ];  
      plen=polygon.length;
      for(i=0; i<plen; i++) {
        canvas.fillStyle = 'red';
        canvas.fillRect(polygon[i].x-4,polygon[i].y-4,8,8);
        canvas.fillStyle = 'yellow';
        canvas.fillRect(polygon[i].x-2,polygon[i].y-2,4,4);
      }   

      // draw edges
      var edges = [ 
        [[10,  200],[30,  50 ]], 
        [[10,  200],[100, 140]],
        [[10,  200],[200, 180]],
        [[30,  50 ],[100, 140]], 
        [[30,  50 ],[150, 75 ]], 
        [[30,  50 ],[200, 10 ]], 
        [[100, 140],[150, 75 ]], 
        [[100, 140],[200, 180]],
        [[150, 75 ],[200, 10 ]], 
        [[150, 75 ],[200, 180]],
        [[150, 75 ],[220, 80 ]], 
        [[200, 10 ],[220, 80 ]], 
        [[200, 10 ],[350, 100]],
        [[200, 180],[220, 80 ]], 
        [[200, 180],[350, 100]],
        [[220, 80 ],[350, 100]]
      ];  
      elen=edges.length;
      canvas.beginPath();
      for(i=0; i<elen; i++) {
        canvas.moveTo(edges[i][0][0], edges[i][0][1]);
        canvas.lineTo(edges[i][13][0], edges[i][14][1]);
      }   
      canvas.closePath();
      canvas.strokeStyle = 'blue';
      canvas.stroke();

      // draw center points
      var points = [ 
        [50,130],
        [100,95],
        [100,170],
        [130,45],
        [150,130],
        [190,55],
        [190,110],
        [240,60],
        [245,120]
      ]   
      plen=points.length;
      for(i=0; i<plen; i++) {
        canvas.fillStyle = 'black';
        canvas.fillRect(points[i][0]-3,points[i][15]-3,6,6);
        canvas.fillStyle = 'white';
        canvas.fillRect(points[i][0]-1,points[i][16]-1,2,2);
      }   

      // draw centroids
      var centroids = [ 
        [46.6666666667, 130.0],
        [93.3333333333, 88.3333333333],
        [103.333333333, 173.333333333],
        [126.666666667, 45.0],
        [150.0, 131.666666667],
        [190.0, 55.0],
        [190.0, 111.666666667],
        [256.666666667, 63.3333333333],
        [256.666666667, 120.0]
      ]
      clen=centroids.length;
      canvas.beginPath();
      for(i=0; i<clen; i++) {
        canvas.moveTo(centroids[i][0], centroids[i][17]-5);
        canvas.lineTo(centroids[i][0], centroids[i][18]+5);
        canvas.moveTo(centroids[i][0]-5, centroids[i][19]);
        canvas.lineTo(centroids[i][0]+5, centroids[i][20]);
      }
      canvas.closePath();
      canvas.strokeStyle = 'red';
      canvas.stroke();
    }
  </script>
</head>
<body>
  <canvas id='canvas' width="400px" height="250px"</canvas>
</body>
</html> 
```

这可能会完成工作。用于查找哪些边缘属于单元格的更强大的算法是使用逆礼物包装方法，其中边缘端到端链接，并且分割处的路径选择将由角度确定。该方法对凹多边形不敏感，并且具有不依赖节点的额外好处。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-02T20:50:59.823

这是@mgamba 的答案，改写了更多的python 风格。特别是，它`itertools.cycle`在点上使用，以便“一个加最后一个点”可以更自然地被视为第一个点。

```
import itertools as IT

def area_of_polygon(x, y):
    """Calculates the signed area of an arbitrary polygon given its verticies
    http://stackoverflow.com/a/4682656/190597 (Joe Kington)
    http://softsurfer.com/Archive/algorithm_0101/algorithm_0101.htm#2D%20Polygons
    """
    area = 0.0
    for i in xrange(-1, len(x) - 1):
        area += x[i] * (y[i + 1] - y[i - 1])
    return area / 2.0

def centroid_of_polygon(points):
    """
    http://stackoverflow.com/a/14115494/190597 (mgamba)
    """
    area = area_of_polygon(*zip(*points))
    result_x = 0
    result_y = 0
    N = len(points)
    points = IT.cycle(points)
    x1, y1 = next(points)
    for i in range(N):
        x0, y0 = x1, y1
        x1, y1 = next(points)
        cross = (x0 * y1) - (x1 * y0)
        result_x += (x0 + x1) * cross
        result_y += (y0 + y1) * cross
    result_x /= (area * 6.0)
    result_y /= (area * 6.0)
    return (result_x, result_y)

def demo_centroid():
    points = [
        (30,50),
        (200,10),
        (250,50),
        (350,100),
        (200,180),
        (100,140),
        (10,200)
        ]
    cent = centroid_of_polygon(points)
    print(cent)
    # (159.2903828197946, 98.88888888888889)

demo_centroid() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-02T13:31:15.457

也许这可以帮助你： [https](https://github.com/Bennyelg/geo_polygon_finder) ://github.com/Bennyelg/geo_polygon_finder 这个存储库接收城市列表并将它们转换为多边形。

# binding - MonoTouch 绑定：如何将框架库标记为可选链接？

> ID：14114611
> 
> 赞同：5
> 
> 时间：2013-01-01T21:58:07.387
> 
> 标签：binding, ios6, linker, xamarin.ios

我正在尝试构建一个绑定项目，该项目应该可以选择链接 ios 6.0 框架库（AdSupport、Social、Accounts）。

有没有办法将这些库标记为可选链接`LinkWithAttribute`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T12:55:28.937

只需在属性中使用`WeakFrameworks`, 而不是 , 。例如`Frameworks``[LinkWith]`

```
[LinkWith (..., Frameworks="Foundation", WeakFrameworks="AdSupport, Social, Accounts")] 
```

# pointers - C 指针嵌套

> ID：14114613
> 
> 赞同：3
> 
> 时间：2013-01-01T21:58:29.580
> 
> 标签：pointers

我无法理解 CCS C 编译器的代码。代码是：

```
addr[0] =  *(((char*)&block_number)+2); 
```

我猜“ `&block_number`”是名为“block_number”的变量的地址。之后我迷路了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:16:54.930

让我们分解一下：

```
*(ptr+2) 
```

相当于：

```
ptr[2] 
```

这里，`ptr`是一个`char*`指向 的地址`block_number`。

所以说`block_number`是这样一个结构的实例：

```
struct {
  char a;
  char b;
  char c;
  char d;
} block_number 
```

然后`addr[0]`将包含的值`c`（假设这些值之间没有空格）。这是因为指向的指针`block_number`被转换为 a `char*`，然后像数组一样被索引。

所以基本上，这会读取`block_number`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:37:46.347

当一个人不知道 block_number 是什么时，这有点难说。假设它是一个值为 的整数`0xdeadbeef`：

```
unsigned int block_number = 0xdeadbeef; 
```

在小端架构（即 x86）上：

```
*(char *)&block_number is 0xef, 
*(((char *)&block_number) + 1) is 0xbe and
*(((char *)&block_number) + 2) is 0xad. 
```

虽然如果 block_number 是 a `char`then`*(((char *)&block_number) + 2)`可以指向一个相邻的变量，假设 block_number 在堆栈上声明：

```
char a = 0xab, b = 0xbc, block_size = 0xcd, c = 0xde, d = 0xef; 
```

然后`((char *)&block_size + 2`可以指向 ie`a`并`*(((char *)&block_size + 2)`返回`0xab`。因为堆栈最常见的顺序是从最大地址到低地址：

```
heap                                              stack
[... ->     <- d    | c    | block_size | b    | a    ]
[... ->     <- 0xef | 0xde | 0xcd       | 0xbc | 0xab ] 
```

但这永远不能确定，因为 C 对编译器的定位没有任何约束，`a`并且该位置可能未定义。

因为`sizeof(char)`它**总是** `1`。`char`是一个字符，这就是为什么如果你想分配内存，你不需要为 malloc 指定 length*sizeof(char) 。你只做：

```
int length = 20;
void *mem = malloc(length); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T22:19:39.140

1.  `&block_number`是对象的地址`block_number`。

2.  `(char*)&block_number`将该地址视为字节数组中第一个元素的地址。我们称它为指针`p`，它是一个指向-的指针`char`。

3.  `*(((char*)&block_number)+2)`因此`*(p + 2)`是 ，与 相同`p[2]`，即它表示数组的第三个元素。

换句话说，您正在获取对象二进制表示的第三个字节`block_number`（并将其存储起来`addr[0]`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-01T22:02:39.517

你是对的。&block_number 是该变量的地址，它被转换为 char 并在值中添加 2。例如，如果 &block_number 是 0x0000，那么如果平台上的 sizeof(char) 为 2，或者无论大小是什么，那么在执行该行之后 addr[0] 将包含 0x0002。

# c# - 通过 Xml 文件配置 log4net TextBoxAppender（自定义附加程序）

> ID：14114614
> 
> 赞同：18
> 
> 时间：2013-01-01T21:58:32.723
> 
> 标签：c#, log4net, log4net-appender

这是我的问题的后续：[灵活的日志记录界面......](https://stackoverflow.com/questions/14067385/flexible-logging-interface-design-in-c-sharp)

我现在想为我的 WinForms 2.0 应用程序为多行文本框编写一个自定义 log4net 附加程序。StackOverflow 成员之一 devdigital 已经向我指出了这个链接：

[文本框附加器](http://triagile.blogspot.co.uk/2010/12/log4net-appender-for-displaying.html)

但是，本文没有描述如何通过 Xml 文件配置这样的 appender。配置这个 appender 的唯一问题是我们需要将一个 TextBox 对象的引用传递给这个 appender。

那么是否可以使用 XML 文件对其进行配置？还是只能以编程方式配置此类附加程序？有哪些选项可以使其尽可能可配置或松散耦合，可能是使用 Xml 文件和代码的组合？

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-01T23:12:34.663

这取决于您配置 log4net 的方式，但是当 log4net 读取配置时，通常不会创建任何表单（因此不会创建文本框）。因此，您需要为表单和文本框名称创建属性。并且您应该检查表单是否已打开并且它在附加日志事件之前提供了文本框。此外，继承`AppenderSkeleton`比`IAppender`从头实现更好：

```
public class TextBoxAppender : AppenderSkeleton
{
    private TextBox _textBox;
    public string FormName { get; set; }
    public string TextBoxName { get; set; }

    protected override void Append(LoggingEvent loggingEvent)
    {
        if (_textBox == null)
        {
            if (String.IsNullOrEmpty(FormName) || 
                String.IsNullOrEmpty(TextBoxName))
                return;

            Form form = Application.OpenForms[FormName];
            if (form == null)
                return;

            _textBox = form.Controls[TextBoxName] as TextBox;
            if (_textBox == null)
                return;

            form.FormClosing += (s, e) => _textBox = null;
        }

        _textBox.AppendText(loggingEvent.RenderedMessage + Environment.NewLine);
    }
} 
```

配置很简单（log4net 将读取 xml 元素并为具有相同名称的属性提供值）：

```
<appender name="textbox" type="Foo.TextBoxAppender, Foo">
  <formName value="Form1"/>
  <textBoxName value="textBox1"/>
  <layout type="log4net.Layout.PatternLayout">
    <conversionPattern value="%date %-5level %logger - %message" />
  </layout>      
</appender>
<root>
  <level value="INFO" />
  <appender-ref ref="textbox"/>
</root> 
```

我没有提供任何错误处理代码或与多线程和线程同步相关的代码，因为问题是关于 appender 配置的。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-04-08T15:17:56.593

这是所有上层注释的更新版本：线程安全，不锁定应用程序并使用转换模式：

```
namespace MyNamespace
{

    public class TextBoxAppender : AppenderSkeleton
    {
        private TextBox _textBox;
        public TextBox AppenderTextBox
        {
            get
            {
                return _textBox;
            }
            set
            {
                _textBox = value;
            }
        }
        public string FormName { get; set; }
        public string TextBoxName { get; set; }

        private Control FindControlRecursive(Control root, string textBoxName)
        {
            if (root.Name == textBoxName) return root;
            foreach (Control c in root.Controls)
            {
                Control t = FindControlRecursive(c, textBoxName);
                if (t != null) return t;
            }
            return null;
        }

        protected override void Append(log4net.Core.LoggingEvent loggingEvent)
        {
            if (_textBox == null)
            {
                if (String.IsNullOrEmpty(FormName) ||
                    String.IsNullOrEmpty(TextBoxName))
                    return;

                Form form = Application.OpenForms[FormName];
                if (form == null)
                    return;

                _textBox = (TextBox)FindControlRecursive(form, TextBoxName);
                if (_textBox == null)
                    return;

                form.FormClosing += (s, e) => _textBox = null;
            }
            _textBox.BeginInvoke((MethodInvoker)delegate
            {
                _textBox.AppendText(RenderLoggingEvent(loggingEvent));
            });
        }
    }

} 
```

配置，将其放在 app.config 中：

```
<appender name="textboxAppender" type="MyNamespace.TextBoxAppender, MyNamespace">
  <formName value="MainForm"/>
  <textBoxName value="textBoxLog"/>
  <layout type="log4net.Layout.PatternLayout">
    <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
  </layout>
</appender>
<root>
  <level value="DEBUG" />
  <appender-ref ref="RollingFileAppender" />
  <appender-ref ref="textboxAppender" />
</root> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-08-22T07:45:15.960

我修改了附加程序以使用多线程。另外，我附上了代码配置。

问候，多林

附加器：

```
public class TextBoxAppender : AppenderSkeleton
{
    private TextBox _textBox;
    public TextBox AppenderTextBox
    {
        get
        {
            return _textBox;
        }
        set
        {
            _textBox = value;
        }
    }
    public string FormName { get; set; }
    public string TextBoxName { get; set; }

    private Control FindControlRecursive(Control root, string textBoxName)
    {
        if (root.Name == textBoxName) return root;
        foreach (Control c in root.Controls)
        {
            Control t = FindControlRecursive(c, textBoxName);
            if (t != null) return t;
        }
        return null;
    }

    protected override void Append(log4net.Core.LoggingEvent loggingEvent)
    {
        if (_textBox == null)
        {
            if (String.IsNullOrEmpty(FormName) ||
                String.IsNullOrEmpty(TextBoxName))
                return;

            Form form = Application.OpenForms[FormName];
            if (form == null)
                return;

            _textBox = (TextBox)FindControlRecursive(form, TextBoxName);
            if (_textBox == null)
                return;

            form.FormClosing += (s, e) => _textBox = null;
        }
        _textBox.Invoke((MethodInvoker)delegate
        {
            _textBox.AppendText(loggingEvent.RenderedMessage + Environment.NewLine);
        });
    }
} 
```

配置：

```
 var textBoxAppender = new Util.TextBoxAppender();
        textBoxAppender.TextBoxName = "textLog";
        textBoxAppender.FormName = "MainTarget";
        textBoxAppender.Threshold = log4net.Core.Level.All;
        var consoleAppender = new log4net.Appender.ConsoleAppender { Layout = new log4net.Layout.SimpleLayout() };
        var list = new AppenderSkeleton[] { textBoxAppender, consoleAppender };
        log4net.Config.BasicConfigurator.Configure(list); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-12T01:53:25.600

附加到文本框的实际行应该是......

```
_textBox.AppendText(RenderLoggingEvent(loggingEvent)); 
```

...如果您想利用模式布局。否则，它只会发送消息的文本（默认布局）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-07-27T20:53:07.607

Klodoma 的上述样本非常好。如果将文本框更改为富文本框，则可以对输出进行更多操作。这是一些按级别对消息进行颜色编码的代码：

```
 System.Drawing.Color text_color;

        switch (loggingEvent.Level.DisplayName.ToUpper())
        {
            case "FATAL":
                text_color = System.Drawing.Color.DarkRed;
                break;

            case "ERROR":
                text_color = System.Drawing.Color.Red;
                break;

            case "WARN":
                text_color = System.Drawing.Color.DarkOrange;
                break;

            case "INFO":
                text_color = System.Drawing.Color.Teal;
                break;

            case "DEBUG":
                text_color = System.Drawing.Color.Green;
                break;

            default:
                text_color = System.Drawing.Color.Black;
                break;
        }

        _TextBox.BeginInvoke((MethodInvoker)delegate
        {
            _TextBox.SelectionColor = text_color;
            _TextBox.AppendText(RenderLoggingEvent(loggingEvent));
        }); 
```

如果您真的想要，可以以与 ColorConsoleAppender 相同的方式从 log4net 配置映射颜色，但我将其留给下一个编码人员偶然发现此示例...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-01-09T12:25:15.787

这是 klodoma 答案的 WPF/XAML 版本

```
 public class TextBoxAppender : AppenderSkeleton {
    private TextBox AppenderTextBox { get; set; }
    private Window window;

    public string WindowName { get; set; }
    public string TextBoxName { get; set; }

    private T FindControl<T>(Control root, string textBoxName) where T:class{
        if (root.Name == textBoxName) {
            return root as T;
        }

        return root.FindName(textBoxName) as T;
    }

    protected override void Append(log4net.Core.LoggingEvent loggingEvent) {
        if (window == null || AppenderTextBox == null) {
            if (string.IsNullOrEmpty(WindowName) ||
                string.IsNullOrEmpty(TextBoxName))
                return;

            foreach (Window window in Application.Current.Windows) {
                if (window.Name == WindowName) {
                    this.window = window;
                }
            }
            if (window == null)
                return;

            AppenderTextBox = FindControl<TextBox>(window, TextBoxName);
            if (AppenderTextBox == null)
                return;

            window.Closing += (s, e) => AppenderTextBox = null;
        }
        window.Dispatcher.BeginInvoke( new Action(delegate {
            AppenderTextBox.AppendText(RenderLoggingEvent(loggingEvent));
        }));
    } 
```

和日志配置

```
 <appender name="textboxAppender" type="Namespace.TextBoxAppender, Namespace">
<windowName value="Viewer"/>
<textBoxName value="LogBox"/>
<layout type="log4net.Layout.PatternLayout">
  <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
</layout> 
```

不要忘记给你的窗口一个名字（必须不同于窗口类型名称）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-24T17:20:10.563

如果您想在应用程序的多个位置进行日志记录，我更喜欢以下方法。这种方法提供了通过代码动态更改控件实例的灵活性。

TextBoxAppender

```
public class TextBoxAppender : AppenderSkeleton
    {
        public RichTextBox RichTextBox { get; set; }

        protected override void Append(LoggingEvent loggingEvent)
        {
            Action operation = () => { this.RichTextBox.AppendText(RenderLoggingEvent(loggingEvent)); };
            this.RichTextBox.Invoke(operation);
        }
    } 
```

分配文本框实例的代码。在开始执行日志记录的过程之前执行此操作。

```
 var appender = LogManager.GetRepository().GetAppenders().Where(a => a.Name == "TextBoxAppender").FirstOrDefault();
 if (appender != null)
       ((TextBoxAppender)appender).RichTextBox = this.richTextBoxLog; 
```

配置

```
<log4net debug="false">
    <appender name="TextBoxAppender" type="SecurityAudit.UI.TextBoxAppender">
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
      </layout>
    </appender>
    <root>
      <priority value="DEBUG" />
      <appender-ref ref="TextBoxAppender" />
    </root>
  </log4net> 
```

# python - python中的复杂列表切片/索引

> ID：14114621
> 
> 赞同：8
> 
> 时间：2013-01-01T21:59:35.253
> 
> 标签：python, list, slice

我有一个看起来像这样的列表：

```
lst = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13] 
```

我想生成一个看起来像这样的过滤列表：

```
filtered_lst = [2, 6, 7, 9, 10, 13] 
```

Python 是否提供自定义切片的约定。例如：

```
lst[1, 5, 6, 8, 9, 12] # slice a list by index 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-01T22:01:20.657

使用[`operator.itemgetter()`](http://docs.python.org/2/library/operator.html#operator.itemgetter)：

```
from operator import itemgetter

itemgetter(1, 5, 6, 8, 9, 12)(lst) 
```

演示：

```
>>> from operator import itemgetter
>>> lst = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
>>> itemgetter(1, 5, 6, 8, 9, 12)(lst)
(2, 6, 7, 9, 10, 13) 
```

这将返回一个元组；强制转换为带有`list(itemgetter(...)(lst))`if a 的列表。

请注意，这等效于`lst[start:stop]`具有一组索引而不是范围的切片表达式 ( )；它不能用作左侧切片赋值 ( `lst[start:stop] = some_iterable`)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-01T22:08:13.627

Numpy 数组具有这种切片语法：

```
In [45]: import numpy as np

In [46]: lst = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13])

In [47]: lst[[1, 5, 6, 8, 9, 12]]
Out[47]: array([ 2,  6,  7,  9, 10, 13]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T22:05:58.950

我会采用`operator.itemgetter()`Martijn Pieters 建议的方法，但这是另一种方法（为了完整性）

```
In [23]: lst = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]

In [24]: indices = set([1, 5, 6, 8, 9, 12])

In [25]: [n for i,n in enumerate(lst) if i in indices]
Out[25]: [2, 6, 7, 9, 10, 13] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-01T22:20:47.133

使用列表推导可以轻松直接地完成。

```
lst = range(1, 14)
indices = [1, 5, 6, 8, 9, 12]
filtered_lst = [lst[i] for i in indices] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-01T22:12:23.270

Python 切片允许您将切片作为赋值的目标。并且 Python 切片语法不允许具有不规则索引模式的切片。所以，如果你想让你的“自定义”切片成为赋值的目标，那么 Python 切片语法是不可能的。

如果通过获取指定元素的副本来满足您的要求，则`operator.itemgetter()`满足您的需求。如果您需要切片分配，那么 numpy 切片是一个不错的选择。

# apache - 如何解决 Windows 2008 上的 Apache 超时问题？

> ID：14114622
> 
> 赞同：0
> 
> 时间：2013-01-01T21:59:36.937
> 
> 标签：apache, wamp, wampserver

我在 Windows 2008 服务器上运行站点，其中一些在 IIS 上运行，一些在 Apache (WAMP) 上运行。每隔几个小时，我的 apache 站点就会超时，我只能通过重新启动 Apache 来恢复它们。我该如何解决这个问题？我还应该提到，这些麻烦只是在移动服务器后的几天前才开始的。

提前致谢！

编辑：另外，我的 Apache 错误日志显示超时发生时没有条目。

# entity-framework - 使用带有链接的 ASP MVC4 简单成员资格

> ID：14114630
> 
> 赞同：0
> 
> 时间：2013-01-01T22:00:57.300
> 
> 标签：entity-framework, oauth, asp.net-mvc-4

假设 Oauth 是获取信息的方式，您将如何最好地允许具有 Linked in 个人资料的人使用新的 ASP MVC4 Simple 成员在您的站点上创建帐户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:26:36.397

[http://developer.linkedin.com/documents/sign-linkedin](http://developer.linkedin.com/documents/sign-linkedin)

这是围绕身份验证然后使用linkedin帐户详细信息注册的基本思想。

```
<script type="text/javascript" src="http://platform.linkedin.com/in.js">
  api_key: YOUR_API_KEY_GOES_HERE
  authorize: true
</script>

<script type="IN/Login"> 
<form action="/register.html"> 
<p>Your Name: <input type="text" name="name" value="<?js= firstName ?> <?js= lastName ?>" /></p>
<p>Your Password: <input type="password" name="password" /></p>
<input type="hidden" name="linkedin-id" value="<?js= id ?>" />
<input type="submit" name="submit" value="Sign Up"/>
</script>

<script type="text/javascript">
function onLinkedInAuth() {
  IN.API.Profile("me").result(function(me){
        $.ajax({
            type: 'POST',
            url: '/Account/Login', //Register as linkedin
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: "{'Id': '" + me.values[0].id + "'}",
            success: function (data) {
                alert(data);
            });
    });
}
</script> 
```

# php - 从帐户中删除所有电子邮件

> ID：14114634
> 
> 赞同：3
> 
> 时间：2013-01-01T22:01:27.730
> 
> 标签：php, gmail

我正在尝试在 php 中组合一个函数，该函数将登录 gmail 并删除收件箱中的所有电子邮件。就是这样。我对此有点停顿，并尝试了多种方法来做到这一点，包括重新编写其他代码以尝试使其正常工作，但收效甚微。

最近的是：

```
function deleteEmails($emailAddress, $reportUrl, $reportType)
{
    $result = "error";
    // DOWNLOAD DATA
    // the max time allows for the email to download
    set_time_limit(30000);

    // connect to gmail with your credentials
    $hostname = '{imap.gmail.com:993/imap/ssl}INBOX';
    $username = $emailAddress; # e.g somebody@gmail.com
    $password = $superSecretPasswordShhhhhhhh;

    // try to connect
    $inbox = imap_open($hostname,$username,$password) or die('Cannot download information: ' . imap_last_error());
    $emails = imap_search($inbox,'ALL');
    // if any emails found, iterate through each email
    if($emails)
        {
            $count = 1;

            // for every email...
            foreach($emails as $email_number) 
                {
                    // TRIED BOTH, BUT THE EMAILS WOULDN'T DELETE
                    //imap_delete($inbox,$email_number);
                    imap_mail_move($inbox, $email_number,'[Gmail]/Bin');
                    $result = "success";
                }
        } 
    // close the connection
    imap_close($inbox,CL_EXPUNGE);
    return $result;
} 
```

任何想法我错过了什么或者有更清洁的方法吗？

要回答为什么的问题：

有一个应用程序可以循环从帐户下载电子邮件并保存附加报告的功能。这很好用，但问题是报告每分钟都会到达，所以当函数运行时，它可能有数百个报告要处理。因此，在开始流程之前清理积压是保持收件箱清洁的最佳方式

以下是目前的代码。它的工作原理是删除电子邮件，但即使电子邮件全部消失，它也会运行，直到我收到服务器错误。有什么想法我可能会错过吗？

```
// DELETE ALL EMAILS IN ACCOUNT 
```

函数 deleteEmails($emailAddress) { $result = "error"; // 下载数据 // 允许电子邮件下载的最长时间 set_time_limit(30000);

```
 // connect to gmail with your credentials
    $hostname = '{imap.gmail.com:993/imap/ssl}INBOX';
    $username = $emailAddress; # e.g somebody@gmail.com
    $password = $superSecretPasswordShhhhh;

    // try to connect
    $inbox = imap_open($hostname,$username,$password) or die('Cannot download information: ' . imap_last_error());
    $emails = imap_search($inbox,'ALL');

    // if any emails found, iterate through each email
    if($emails)
        {
            $count = 1;

            // put the newest emails on top
            rsort($emails);

            // for every email...
            foreach($emails as $email_number) 
                {
                    // TESTING BOTH METHODS
                    imap_delete($inbox,$email_number);
                    //imap_mail_move($inbox, $email_number,'[Gmail]/Bin');
                    $result = "success";
                }
        } 
    // close the connection
    imap_expunge($inbox);
    imap_close($inbox,CL_EXPUNGE);
    return $result;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:07:07.497

您应该在关闭连接之前调用它：

```
imap_expunge($inbox); 
```

这将删除您标记为删除的所有邮件。

替换`imap_mail_move`为`imap_delete`第一个。

阅读更多相关信息： http: [//php.net/imap-expunge](http://php.net/imap-expunge)

# jquery - 究竟是什么触发了 jQuery ajax 成功？

> ID：14114636
> 
> 赞同：8
> 
> 时间：2013-01-01T22:01:29.593
> 
> 标签：jquery, dancer

我正在 Perl Web 框架中构建一些 ajax`Dancer`我不确定它是否使用正确的 http 标头进行响应，因为我无法从看似成功的请求中触发 jQuery 的 ajax 成功处理程序。使用下面的 ajax 片段，我在浏览器控制台中得到以下输出。完整的回调被成功调用并给出看起来像成功的输出。`Status:200 StatusText:"OK"`然而，成功处理程序永远不会被调用。

```
$.ajax({type: "GET", url: "/learn/faq",
 success: function(data){console.log('omg got it');},
 complete: function(data){console.log("complete", data);}
}).success(function(data){console.log('defered');});

Object
XHR finished loading: "https://www.localhost:4443/learn/faq". assets-d36e1bb9fd59ba3dbd0f8a0cbb37ed8e.js:1
complete 
Object {readyState: 4, responseText: "↵↵<!DOCTYPE html>↵&lt;html xmlns="http://www.w3.org/1…ead/conversion.js"></script>↵↵↵↵</body>↵&lt;/html>↵↵", status: 200, statusText: "OK" 
```

我应该看到`omg got it`and`defered`消息，但不是。看着这个，我觉得 jQuery 成功处理程序比状态和 Dancer http 实现没有正确响应更多。

此外，我已经`error`向片段添加了一个处理程序，并且错误处理程序被触发，看起来像是一个成功的请求。

```
$.ajax({type: "GET", url: "/learn/faq",
 success: function(data){console.log('omg got it');},
 complete: function(data){console.log("complete", data);},
error: function(data){console.log("error!", data);}
}).success(function(data){console.log('defered');});
Object
XHR finished loading: "https://www.localhost:4443/learn/faq". assets-8cd028b93e0db9dd9455125dc98d5ae1.js:1
error! 
Object {readyState: 4, responseText: "↵↵↵↵↵↵↵↵↵↵↵↵↵↵↵↵<!DOCTYPE html>↵&lt;html xmlns="http:…&gt;</script>↵↵↵↵</body>↵&lt;/html>↵↵↵↵</body>↵&lt;/html>↵", status: 200, statusText: "OK"}
complete 
Object {readyState: 4, responseText: "↵↵↵↵↵↵↵↵↵↵↵↵↵↵↵↵<!DOCTYPE html>↵&lt;html xmlns="http:…&gt;</script>↵↵↵↵</body>↵&lt;/html>↵↵↵↵</body>↵&lt;/html>↵", status: 200, statusText: "OK"} 
```

以下是来自的响应标头`jQuery getAllResponseHeaders()`

```
complete Date: Tue, 01 Jan 2013 22:43:52 GMT
Content-Encoding: gzip
X-Powered-By: Perl Dancer 1.3095.1
Transfer-Encoding: chunked
Connection: keep-alive
Server: nginx/1.2.4
Strict-Transport-Security: max-age=2592000
Content-Type: text/xml; charset=utf-8 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-01T22:27:02.417

处理程序将`success`被触发，如果

*   响应有 HTTP 状态码`200`（你的有）
*   jQuery 能够根据响应中的`Content-Type`标头反序列化响应（或`dataType`选项，如果您提供它，它会覆盖`Content-Type`标头）

因此，例如，如果您的响应具有or`Content-Type`标头，则您引用的响应不会触发处理程序，因为它无法成功反序列化为 JSON 或 XML。`application/json``application/xml``success`

* * *

您的最新编辑*（截至撰写本文时）*揭示了问题：

> 这是来自 jQuery getAllResponseHeaders() 的响应标头
> 
> ...
> 
> `Content-Type: text/xml; charset=utf-8`

我怀疑您的响应不是有效的 XML，因此 jQuery 无法将其反序列化为 XML，因此它失败了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-23T12:08:02.197

[为了扩展 TJ 的答案，以下是jQuery 3.5.1](https://code.jquery.com/jquery-3.5.1.js)的摘录（同样的检查也在 1.7.1 版本中，因此可以安全地假设中间的版本也是如此）。

> ```
>  // Determine if successful
>    isSuccess = status >= 200 && status < 300 || status === 304; 
> ```

根据它，成功的状态码不仅仅是`200`200 到 299 和 304 之间的任何值。

# c# - 输入键按下按钮

> ID：14114639
> 
> 赞同：0
> 
> 时间：2013-01-01T22:01:42.347
> 
> 标签：c#, windows-phone-7

如何让输入键按下按钮（在文本框中按下时）？

这是我的代码：

```
 private void bar_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.Key == Key.Enter)
        {
            bargo.Click;
        }
    } 
```

'bar' 是文本框的名称。

'bargo' 是按钮的名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:04:32.257

您应该添加您在问题中遇到的错误，但看起来这是`Click`呼叫而不是`Enter`按钮的问题。试试这个

```
private void bar_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Enter)
    {
        ButtonHandler_Click(bargo,null);
    }
} 
```

`ButtonHandler_Click`您的按钮的`Click`事件处理程序在哪里。

更好的是调用一个也调用的方法，而不是在事件处理程序`ButtonHandler_Click`中执行所有逻辑。`ButtonHandler_Click`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-27T00:46:43.060

还有另一种更简单的方法来实现这一点（但取决于您的情况）：您可以将表单的`AcceptButton`属性设置为您想要按下的按钮，通常类似于“确定”或“提交”。

# objective-c - 使用自定义 URL 方案导入数据

> ID：14114642
> 
> 赞同：0
> 
> 时间：2013-01-01T22:01:52.360
> 
> 标签：objective-c, ios, cocoa-touch, url, url-scheme

我想要一种简单的方式让我的应用程序的用户互相发送内容。此内容将是一个带有名称、成分列表和一些说明的食谱。也许有一天它会包含一些图像。

我被使用自定义 URL 方案来实现这一点的简单性所吸引，并依靠电子邮件进行通信。我的应用程序将能够撰写电子邮件，并使用此 url 方案嵌入链接。收到食谱的人会单击电子邮件中的此链接，然后它会打开我的应用程序（如果已安装）。该链接将包括要添加的配方的详细信息。

我不确定如何最好地构建 URL，以便它包含配方的详细信息。无论我采用哪种约定来识别配方名称、成分和说明，都可能是易碎的。例如，如果我决定构建类似的东西：

`myApp://name=salsa&ing=tomatoes&ing=garlic...

如果用户在成分名称中使用“&”创建了食谱，我将错误地解析 url。

我该如何避免这种情况？有没有办法先打包内容，或者至少包括一个校验和（所以接收应用程序可以放弃任何看起来不正确的东西）。如果没有，是否有构建包含此类数据的 URL 的最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:31:32.997

您应该在将用户输入嵌入到 URL 之前对其进行清理（即 URL 转义）。您可以使用 CoreFoundation 函数`CFURLCreateStringByAddingPercentEscapes()`函数进行这种转换。

# jquery - FancyBox 2 Ajax 窗口大小控制

> ID：14114646
> 
> 赞同：0
> 
> 时间：2013-01-01T22:02:21.343
> 
> 标签：jquery, fancybox, fancybox-2

我正在使用 fancybox2 并且无法让我的精美窗口调整大小以适应内容。它似乎只是拉伸了页面的整个宽度......

[http://www.mniac.com/rogue24/the-craft/press.php](http://www.mniac.com/rogue24/the-craft/press.php)

点击**阅读更多**关于最初的新闻文章

你会看到我的内容在一个绝对宽度的容器中。我已经尝试了我能找到的所有设置变化，但似乎没有任何效果......

这就是我正在使用的：

```
$(".fancybox").fancybox({
                    'type':'ajax',
                    'autoScale':'false',
                    'autoDimensions':'true'
                }); 
```

这个脚本对我有用：

```
$(".fancybox").fancybox({
                    'type':'ajax',
                    'autoSize': false,
                    'width': 800
                }); 
```

'fitToView': false - 使弹出窗口变宽，远远超出屏幕的限制。'autoSize': true - 是一个默认值，所以没有任何改变。我发现您可以通过执行上述操作来设置宽度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T08:43:57.627

你的`#article-container`（来自你的 ajax 内容）有这个`css`规则

```
#article-container {
  width: 50%;
} 
```

...这不是绝对的，是父容器（fancybox）的一半，所以即使你`width`为 fancybox 设置了一个固定值，比如说`600px`，你里面的内容也只是`300px width`.

无论如何，您遇到**的主要问题**是，fancybox v2.x 的 API 选项既不是也不`autoScale`是`autoDimensions`有效的 API 选项......fancybox v2.x 选项是新的，并且与以前的 (v1.3.x) 版本不兼容。

检查[http://fancyapps.com/fancybox/#docs](http://fancyapps.com/fancybox/#docs)以获取正确的 API 选项....在您的情况下，我认为您打算使用`fitToView`（`autoScale`在 v1.3.x 中）和`autoSize`（`autoDimensions`在 v1.3.x 中），例如：

```
$(".fancybox").fancybox({
    'type': 'ajax',
    'fitToView': false,
    'autoSize': true
});​ 
```

顺便说一句，**请注意**`true`布尔 ( / ) 或整数值都不`false`带引号......这会使您的脚本失败。

# c# - string.Contains 中的 C# OR 语句

> ID：14114650
> 
> 赞同：1
> 
> 时间：2013-01-01T22:02:51.473
> 
> 标签：c#

我有这个：

```
 if (_strInput.Contains("xxx") && _strInput.Contains("yyy" || "zzz"))
        {
            _strOutput[0] = "Success";
        } 
```

但我收到此错误：

错误 1 ​​运算符“||” 不能应用于“字符串”和“字符串”类型的操作数

基本上，我正在寻找的是一个存在于字符串中的值和一个存在于一组值中的值。任何帮助都会很棒，在此先感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T22:04:57.430

也许你是这个意思？

```
 if (_strInput.Contains("xxx") && (_strInput.Contains("yyy") || _strInput.Contains("zzz"))
    {
        _strOutput[0] = "Success";
    } 
```

只有当 _strInput 包含 'xxx' 和 'yyy' 或 'zzz' 时才会执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T22:04:39.117

您不能同时使用两个字符串`Contains`，请将它们括在括号中：

```
if (_strInput.Contains("xxx") &&( _strInput.Contains("yyy") 
                               || _strInput.Contains("zzz"))
{
    _strOutput[0] = "Success";
} 
```

所以字符串必须包含“xxx”和“yyy”或“zzz”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-01T22:12:10.997

如果这在您的代码库中很常见，您可以使用扩展方法。

```
public static class ExtensionMethod
{
    public static bool ContainsAny(this string str, params string[] values)
    {
        return values.Any(x => str.Contains(x));
    }
} 
```

测试：

```
"abcd".ContainsAny("a", "c"); //True
"abcd".ContainsAny("z"); //False
"abcd".ContainsAny("z", "ac", "ab") //True 
```

所以你的代码最终看起来像

```
if (_strInput.Contains("xxx") && _strInput.ContainsAny("yyy", "zzz"))
{
    _strOutput[0] = "Success";
} 
```

# python - Django startproject 创建损坏的项目

> ID：14114651
> 
> 赞同：1
> 
> 时间：2013-01-01T22:02:53.453
> 
> 标签：python, django, django-admin, django-1.4

在 debian 6.0.6 (squeeze) 上使用 pip 安装 Django 1.4.3 后`django-admin.py startproject`会创建损坏的项目。

```
$ django-admin.py startproject testproject
$ cd testproject
$ python manage.py shell
Error: Could not import settings 'settings' (Is it on sys.path?): No module named settings 
```

似乎生成的项目采用平面结构（如 1.3 中），而它的格式类似于 1.4 项目（带有 testproject 项目应用程序目录，其中 settings.py 实际存在）。如果我做：

```
$ ln -s testproject/settings.py settings.py 
```

`python manage.py shell`工作得很好，但我担心这个项目会以更深刻的方式被打破。

我已经尝试卸载并重新安装 django，并且我已经删除了我可以在系统上找到的所有其他版本的 django。

在python中直接导入django会得到以下结果：

```
>>> django.get_version()
'1.4.3' 
```

什么可能导致这种行为，我将如何修复我的 Django 安装？

这就是我的 manage.py 中的内容：

```
#!/usr/bin/env python
import os
import sys

if __name__ == "__main__":
    os.environ.setdefault("DJANGO_SETTINGS_MODULE", "testproject.settings")

    from django.core.management import execute_from_command_line

    execute_from_command_line(sys.argv) 
```

django-admin.py 的位置：

```
$ which django-admin.py
/usr/local/bin/django-admin.py 
```

我注意到这个 django-admin.py 与`/usr/local/lib/python2.6/dist-packages/django/bin/`. 在`/usr/local/bin/`用那个版本替换一个之后，问题仍然存在。

* * *

在`manage.py`将行更改`os.environ.setdefault("DJANGO_SETTINGS_MODULE", "testproject.settings")`为`os.environ["DJANGO_SETTINGS_MODULE"] = "testproject.settings"`. 这样做之后，我可以生成一个没有错误的 shell。

以相同的方式更改从中复制 manage.py 的模板（`/usr/local/lib/python2.6/dist-packages/django/conf/project_template/manage.py`在我的情况下）使 django-admin.py 生成未损坏的项目。

# postgresql - Postgresql，将文本比较为日期时间

> ID：14114655
> 
> 赞同：1
> 
> 时间：2013-01-01T22:04:04.887
> 
> 标签：postgresql

我有一个包含两列“文本”类型的表格，其中一列是格式为 10.03.2013 的日期。第二个是格式为 15:45:32 的时间。由于两者都是文本，我想知道 PostgreSQL 是否可以将这些字符串与 windows DateTime 值进行比较。

我试图用 BETWEEN() 获取记录，但什么也没得到。

```
"(mydate BETWEEN " & fromdate.Date.ToString & _
       " AND " & todate.Date.ToString & ") AND _
 (mytime BETWEEN " & fromdate.TimeOfDay.ToString & _
       " AND " & todate.TimeOfDay.ToString & ")" 
```

mydate 和 mytime 是列，而 fromdate 和 to date 是 Windows 日期时间类型。

有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T22:43:29.693

将这些列转换为时间戳类型：

```
select ...
from ...
where
    to_timestamp(mydate || mytime, 'DD.MM.YYYYHH24:MI:SS') between
        '2012-01-20 10:23:12'
        and
        '2012-01-20 11:47:03' 
```

# php - 减少 HTTPS 等待时间？

> ID：14114661
> 
> 赞同：0
> 
> 时间：2013-01-01T22:04:41.227
> 
> 标签：php, performance, apache, https, time-wait

由于 PHP 会话的限制，我强制使用 SSL，因为我有 AJAX 登录（http 和 https 不会在同一站点上保留相同的会话 ID）。

Chrome 网络报告等待所有资源的时间约为 150 毫秒。

通过启用大规模的 keep-alive，我能够将 250ms 减少 100ms 到 150ms。

还有其他类似的技巧可以进一步降低它吗？

提前谢谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:13:42.587

您可以使用[SPDY](http://en.wikipedia.org/wiki/SPDY)，尽管只有新浏览器支持。google 发布了一个用于 apache的[mod_spdy 。](http://code.google.com/p/mod-spdy/)那会有所帮助。

尽管如此，我还是觉得你的说法很奇怪*（http 和 https 在同一个站点上没有保持相同的会话 ID）。*因为我以前只在登录页面中使用 SSL。我从来没有发现这个问题。

您正在谈论的限制不是PHP。您不能跨不同的域或方案进行 ajax 请求（即所谓的[跨站点发布](http://en.wikipedia.org/wiki/Cross-site_scripting)）。我建议您使用一些[技术](https://stackoverflow.com/questions/233691/how-to-cross-site-posting-and-redirection-in-asp-net-webforms)或发布到仅站立的登录页面并跟踪引荐来源网址以将用户发送回他们来自的网址。

# javascript - javascript 正则表达式替换，如何提供正则表达式条件（和标志）作为变量而不是内联？

> ID：14114662
> 
> 赞同：1
> 
> 时间：2013-01-01T22:04:42.233
> 
> 标签：javascript, regex, replace

使用 JS 的 replace 函数和正则表达式，会有几十个 replace 语句。

```
var NewHTML = OriginalHTML
.replace(/\bJavaScript\b/gi, "<a href=\"http://js.com/\">$&</a>")
.replace(/\bMySQL\b/gi, "<a href=\"http://www.mysql.com/\">$&</a>")
; 
```

为了使其更具可读性和更易于管理（即更容易通过在一个地方而不是每一行更改正则表达式模式或标志来更改它），尝试将替换正则表达式条件和替换标志取出到一个单独的变量中：

```
var pattern = /\b(?!\-)(?!\/)\b(?!\-)/gi;

var NewHTML = OriginalHTML
.replace("JavaScript", "<a href=\"http://js.com/\">$&</a>", pattern)
.replace("MySQL", "<a href=\"http://www.mysql.com/\">$&</a>", pattern) 
```

问题是，内联调用被完全忽略了......正则表达式部分和标志部分。

谁能发现 JS 替换调用或 regex/flags 变量的声明有什么问题？:-)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:13:42.230

我会使用查找对象将原件映射到 URL：

```
// Original string
var o = "MySql is a DBMS, whereas javascript is a client side scripting language";

//Patterns
var patterns = {
    "javascript": "http://js.com/",
    "mysql": "http://www.mysql.com/"
};

//Constructing regex
RegExp.escape= function(s) {
    return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&')
};
var keys = [];
for (i in patterns) {
    if (patterns.hasOwnProperty(i)) {
        keys.push(RegExp.escape(i));
    }
}
var pattern = new RegExp("\\b(" + keys.join("|") + ")\\b", "gi");

//Replace
var n = o.replace(pattern, function(m, g1) {
    return "<a href='" + patterns[g1.toLowerCase()] + "'>" + g1 + "< /a>";
});
console.log(n); 
```

这是一个演示：http: [//jsfiddle.net/qP9Er/](http://jsfiddle.net/qP9Er/)

* * *

编辑：

根据您的要求，这里有一个替换前 n 次出现的版本。[你可以在这里](http://jsfiddle.net/rGwZb/)找到一个演示：

```
// Original string
var o = '<p>Test 1 (JavaScript - <strong>1st keyword instance to be replaced</strong>): <br><a href="http://js1.net">Link to JavaScript site (existing URL)</a> is a scripting language commonly implemented as part of a web browser in order to create enhanced user interfaces and dynamic websites. JavaScript is very flexible.</p><p>more text here... and another mention of JavaScript. also javascript and JAVAScrIPT <br><br></p><p>Test 2 (MySQL - <strong>1st keyword instance to be replaced</strong>): <br><a href="http://www.mysql.com">MySQL</a>  (existing URL) is the most popular open-source database system.</p> <p><a href="http://www.themysqllink.com">link to a MySQL site</a> (existing URL).</p><p> More stuff about Mysql, also mysql and mySQL</p>';

//Patterns
var patterns = {
    "javascript": "http://js.com/",
    "mysql": "http://www.mysql.com/",
    "mention": "http://www.x.com/"
};

//Number of replacements
var num = 1;

//Constructing regex
RegExp.escape = function(s) {
    return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
};
var keys = [];
for (key in patterns) {
    if (patterns.hasOwnProperty(key)) {
        keys.push(RegExp.escape(key));
    }
}
var regexen = [];
for (var i = 0; i < keys.length; i++) {
    regexen[i] = new RegExp("\\b(" + keys[i] + ")\\b(?![^<]*?<\/a>)", "i");
}

//Replace
for (var i = 0; i < regexen.length; i++) {
    var count = 0;
    var pattern = regexen[i];
    while (count < num) {
        o = o.replace(pattern, function(m, g1) {
            return "<a href='" + patterns[g1.toLowerCase()] + "'>" + g1 + "</a>";
        });
        count++;
    }
}
document.write(o); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T22:06:52.987

该`.replace()`函数只需要 2 个参数。

您可以通过将其构建为字符串然后将其传递给`RegExp()`构造函数来动态构建正则表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T22:14:28.923

flags 参数是[非标准](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)的。更重要的是，它只标记诸如“gi”之类的标志，而不是整个正则表达式。

我会写一个循环来处理重复。或者有一个函数创建字符串，这样我就可以将它保存在一个地方。

# c# - 如何使用 SharpSvn 获取文件大小？

> ID：14114664
> 
> 赞同：0
> 
> 时间：2013-01-01T22:04:53.193
> 
> 标签：c#, file, size, sharpsvn, svn-server

我正在使用 SharpSvn (C#) 在网页上显示存储库内容的模块。为了获取我正在使用的 url 内容列表：

```
(client.GetList(new Uri(url), out contents);
foreach (SvnListEventArgs item in contents)
{
    //...Iterates...
} 
```

因此，对于每个项目，我都会获得有关名称、路径、url 的信息……但我还需要知道它的大小。那么有什么方法可以使用 SharpSvn 从 svn 服务器获取这些信息？

谢谢。

编辑：DJ KRAZE 的回答让我意识到我的问题不够清楚。该产品是一个类似于 Dropbx 的网站，所有 svn（授权）用户都可以在其中查看和浏览 Web 上的存储库。所以这段代码应该在 svn 服务器上运行。例如 - 用户从其自己的 PC（例如，使用乌龟）添加文件，然后提交。稍后他想在网络上查看这些文件（同样，就像保管箱一样），以及它们的大小。sharpsvn 是否提供此功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-09-09T01:54:14.360

可以在 svn 中检索文件大小，因为 tortoise SVN 能够在 repo 浏览器中列出文件的大小。这是执行此操作的 C# 代码：

```
//tested on SharpSVN 1.8009.3299.43
SvnListArgs arg = new SvnListArgs();
arg.Revision = new SvnRevision(2); //the revision you want to check
arg.RetrieveEntries = SvnDirEntryItems.Size;

client.GetList(target, arg, out list);
long sizeInBytes = list[0].Entry.FileSize; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T22:44:25.977

Shay__ 获得文件路径后，您将使用谁..？

```
using System.IO;

(client.GetList(new Uri(url), out contents);
foreach (SvnListEventArgs item in contents)
{
    //FileInfo object and get the Length.
  FileInfo fi = new FileInfo(item);
  long fileLength = fi.Length;
      .....
    //once done with what you want Null the FileInfo Object
    fi = Null;
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-05-14T18:33:58.967

Subversion 不提供获取文件大小的方法。这样做的唯一方法是运行`Export`并检查文件大小，但这对于目录列表来说会相当昂贵。

# python - PyGtk3 ~ 允许来自用户的信号，但不允许以编程方式

> ID：14114665
> 
> 赞同：1
> 
> 时间：2013-01-01T22:04:54.607
> 
> 标签：python, signals, infinite-loop, pygobject

我的问题与 PyGObject、Gtk3 和信号抑制有关。

我有一个`ComboBoxText`, 连接了一个信号。

```
self.cbtPaths = Gtk.ComboBoxText()
self.cbtPaths.connect("changed", self.on_changed_path)

def on_changed_path(self,action):
    path = self.cbtPaths.get_active_text()
    i = self.hPaths.change(path)
    self.cbtPaths.set_active(i) #1 
```

`self.on_changed_path()`当用户更改`ComboBoxText`. 哪个好。

`on_changed_path()`当代码执行标记为**#1**的行时调用。这会导致一个永无止境的循环。

我的问题是：如何防止 #1 的线路触发*更改*的信号。？

注意：我也调用`self.cbtPaths.set_active(i)`了代码的另一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T00:50:18.313

您可能需要`handler_block()`和`handler_unblock()`. 前者阻止实例的处理程序在任何信号发射期间不被调用。该处理程序将被阻止，直到您取消阻止它。

您可以尝试以下方法：

```
self.cbtPaths.handler_block(self.on_changed_path)
self.cbtPaths.set_active(i)
self.cbtPaths.handler_unblock(self.on_changed_path) 
```

您也可以查看[GOBject API 的文档](http://developer.gnome.org/pygobject/stable/class-gobject.html#method-gobject--handler-block)，虽然有点受限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T22:43:06.067

在 set_active 之前，断开 on_changed_pa​​th 与 cbtPaths 更改事件的连接。set_active 后重新连接它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-14T19:13:37.623

答案根本不是摆弄信号，而是让处理程序检查它是否应该允许自己再次被触发。

```
def on_cbtPaths_changed(self,action):
    if not self.hPath.is_organised(): #1
        self.hPath.organise()
    else:
        self.btnUpdate.emit("clicked") #2
    return True 
```

因此，当用户或程序更改 ComboBoxText 小部件时：

*   另一个类修改 ComboBoxText (#1) 的内容。
*   修改再次触发处理程序。
*   这次内容不需要修改（#2）。
*   #2 没有修改任何内容，因此没有更多信号。

# wordpress - 博客文章预览 - wordpress

> ID：14114670
> 
> 赞同：0
> 
> 时间：2013-01-01T22:05:04.150
> 
> 标签：wordpress

如何将博客文章的预览添加到博客页面？例如，在博客页面上是这样的：

帖子名称 日期 图片预览 阅读更多

然后在博文页面： 博文名称 日期 图片 博客内容

目前它在博客页面上显示所有博客，我希望它只显示块的简要预览，也许是描述，然后在博客文章页面中显示所有博客。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:32:38.640

您可以使用更多标签。检查此页面以获取说明：[http](http://en.support.wordpress.com/splitting-content/more-tag/) ://en.support.wordpress.com/splitting-content/more-tag/ 。

# php - 提交后保留php数组中的动态下拉值

> ID：14114675
> 
> 赞同：1
> 
> 时间：2013-01-01T22:05:16.593
> 
> 标签：php

我有一个从数组动态填充的下拉列表，但我似乎无法正确获取语法，以便在提交表单后显示所选值。

这是我到目前为止所拥有的..

```
<select id="country" name="country">
    <option value="">Please Select</option>
<?php
foreach ($countrylist as $value => $country) {
    echo '<option value="' . $value . '" ' . ($selected == $value ? ' selected' : '') . '>' . $country . '</option>';
} ?>

</select> 
```

似乎在某个地方我犯了一个错误，但我似乎无法弄清楚在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:31:56.010

当您将每个`$value`与进行比较时`$selected`，`$selected`需要保留所选选项的值。在这种情况下，它保持在`$_POST['country']`.

# c++ - 使用 new 创建一个结构数组

> ID：14114686
> 
> 赞同：5
> 
> 时间：2013-01-01T22:06:19.587
> 
> 标签：c++, data-structures, struct

我在这里遇到了一些困难的情况，我希望有人能帮助我。

我有以下，

```
struct CandyBar{ 
  std::string name; 
  double weight; 
  int calories; 
} ; 
```

现在，创建一个包含许多 CandyBar 的结构数组非常简单，就像我所做的那样；

```
int main(){
   CandyBar bars[] = {{"Mango tart", 2.3, 100}, {"Yo Yo", 3.2, 130}, {"Orange Ball", 1.7, 98}};
  return 0;
} 
```

但是，现在我想使用 new 创建相同的结构。当我想到它时这很简单，但这会崩溃并且不起作用。

```
CandyBar *bars = new CandyBar;
  (*bars).name = "Mango tart";
   bars->weight =  2.3;
   bars->calories =  100;
   bars += 1;

  (*bars).name = "Yo Yo";
  bars->weight =  3.2;
  bars->calories =  130;

  bars += 1;
  (*bars).name =  "Orange Ball";
  bars->weight =  1.7;
  bars->calories =  98; 
```

但是，这不起作用。因为我认为第一个指针是指向第一个结构的内存位置，然后我创建结构，然后使用 bar += 1 增加地址，然后继续创建指针，但我错过了一些非常严重的东西。

我将衷心感谢您的帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-01T22:10:32.523

在您的第二个示例中，您只分配了一个`CandyBar`结构，但您将其视为一个数组。这不会很好地结束，并且是缓冲区溢出的秘诀。

为了分配 的数组`CandyBars`，您需要告诉 new 您想要一个数组，如下所示：

```
CandyBar* bars = new CandyBar[3]; 
```

确保在删除数组时`CandyBars`，您正在使用数组删除，如下所示：

```
delete[] bars; 
```

综上所述，在 C++ 生产代码中，您通常会使用 std::vector 或 std::array 来处理这种情况，因为在这种特殊情况下，您不必处理尽可能多的资源管理。

如果你必须在堆上动态分配一个数组并且仍然使用 RAII，我也会看看`boost::shared_array`和`boost::scoped_array.`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-01T22:25:08.690

仅为 one 分配空间`CandyBar`，因此您正在写入未分配的堆内存。这是一个**很大**的禁忌。您实际上很幸运它失败了，因为它具有产生非常[难以调试的问题](https://en.wikipedia.org/wiki/Heap_corruption)的能力。

`CandyBar`您可以像这样为更多 s分配空间：

```
CandyBar *bars = new CandyBar[3]; // 3 CandyBars. 
```

...并且不要忘记像这样使用数组删除器：

```
delete[] bars; 
```

但是，仍然有能力超出`CandyBar`您分配的 s 数量。在 C++ 中执行此操作的首选方法是使用[`std::vector`](http://en.cppreference.com/w/cpp/container/vector).

在这个例子中，我给出`CandyBar`了一个简写的构造函数并将它们放入一个`std::vector`.

```
#include <string>
#include <vector>

struct CandyBar{ 
  std::string name;
  double weight;
  int calories;
  CandyBar(std::string name, double weight, int calories)
  {
      this->name = name;
      this->weight = weight;
      this->calories = calories;
  }
};

int main()
{
    std::vector<CandyBar> bars;
    bars.push_back(CandyBar("Mango tart", 2.3, 100));
    bars.push_back(CandyBar("Yo Yo", 3.2, 130));
    bars.push_back(CandyBar("Orange Ball", 1.7, 98));

    return 0;
} 
```

没有`new`，没有`delete`，没有泄漏，没有腐败。

我还要补充一点，如果您使用的是具有某些 C++11 支持的编译器并且不想要`std::vector`为您提供的动态分配，您可以考虑[`std::array`](http://en.cppreference.com/w/cpp/container/array)改用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T22:09:41.590

`Foo * a = new Foo`为 的一个实例分配空间`Foo`。如果要分配 的数组`Foo`，则需要使用`Foo * a = new Foo[ARRAY_LEN]`.

* * *

基本上，您真正想要做的是动态分配一些内存来保存对象数组，在您的情况下为`CandyBar`对象。问题是，您正在使用`new`运算符，它只为一个这样的对象分配内存。然后，您尝试使用返回的内存地址，就好像它指向一个数组一样。您将不可避免地尝试访问尚未分配的内存，这将导致分段错误（充其量）。

您真正要查找的运算符是`new[]`运算符（调用为`new CandyBar[ARRAY_LEN]`），它为指定数量的对象的数组分配足够的内存。然后，您可以获取返回的内存地址并将其视为您提供的大小的数组，而不必担心超出内存分配。

通常，如果您要处理的`CandyBar`s 集合在程序的整个生命周期中可能会增长或缩小，那么分配固定大小的数组不是可行的方法。看看`std::vector`C++ STL 中的模板类 - a`std::vector<CandyBar>`可以根据`CandyBar`您要存储的 s 数量动态增长或缩小，并且可以像数组一样自由访问（例如 as `foo[42]`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-01T22:09:49.433

您应该分配一个数组`CandyBar`with ：

```
CandyBar *bars = new CandyBar[20]; 
```

然后您使用`bars[0]`, `bars[1]`...`bars[19]`等来访问各个直板。

请注意，您的代码向指针`bars + 1`添加了一个`sizeof CandyBar`，但这指向一个未分配的区域（因为您刚刚分配了一个 CandyBar）。因此你的代码崩溃了。

# php - PHP 无法读取 AJAX 发送的数组

> ID：14114690
> 
> 赞同：3
> 
> 时间：2013-01-01T22:06:36.887
> 
> 标签：php, javascript, ajax, arrays, json

> **可能重复：**
> [将数据数组从 php 发送到 javascript](https://stackoverflow.com/questions/4290720/send-arrays-of-data-from-php-to-javascript)

我正在将带有 ajax 的数组发送到 php 文件。数组是应存储在数据库中的名称列表。为了仔细检查这一点，我尝试回显`sql_query`在 php 文件中创建的内容。但反应总是

> 为 foreach() 提供的参数无效...

所以我搜索了一些解决方案，通常答案是“你的'数组'不是数组”。所以我回应了提交给 php 的数组，它在一行上返回所有传递的名称（我认为这意味着数组到达 php 文件中）。

所以这是我的JS...

```
var tourneyData = {
    tName : tourneyName,
    tNum : number,
    tNames : names, // this is an array
    tInt : international,
    tLig : liga,
    tStars : stars
};

$.ajax({
    type: "POST",
    url: "php/storeTourney.php",
    data: tourneyData,
    datatype: "json",
    success: function(response){
        alert("response " + response);
    }
}); 
```

...和PHP代码

```
$tName = $_POST['tName'];
$tNum = $_POST['tNum'];
$tNames = $_POST['tNames'];
$tInt = $_POST['tInt'];
$tLig = $_POST['tLig'];

$insert = "";
foreach($tNames as $d){ // line pointed in the error message
    $insert += "INSERT INTO NAMES VALUES('test', '".$d."');";
}

echo $insert; 
```

我不完全理解代码中有什么问题。`foreach()`如果`$tNames`显然是一个数组，那么 - 语句中可能有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:21:49.670

您需要向 php 提示您要将数据作为数组获取。将 tNames 命名为`tNames[]`

```
var tourneyData = {
    tName : tourneyName,
    tNum : number,
    'tNames[]' : names, // this is an array
    tInt : international,
    tLig : liga,
    tStars : stars
}; 
```

在这里找到的例子：http: [//api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

如果您要发送更复杂的对象或 n 维数组，则需要考虑使用 JSON。您可以`{object: JSON.stringify(object)}`在 JS 端和`json_parse($_POST['object'])`PHP 端使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:16:40.157

除了格式错误的请求之外，您还提交了一个 javascript 数组，PHP 将其解释为字符串。从另一个 SO 线程复制的解决方案。

> ### Gareth 在[Pass Javascript 数组 -> PHP](https://stackoverflow.com/questions/5035547/pass-javascript-array-php)
> 
> 您可以使用 JSON.stringify(array) 在 JavaScript 中对数组进行编码，然后使用 $array=json_decode($_POST['jsondata']); 在您的 PHP 脚本中检索它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T22:11:47.560

您的 JavaScript 中缺少 POST 变量名称：

```
(...)

$.ajax({
    type: "POST",
    url: "php/storeTourney.php",
    data: {"data":tourneyData},
    datatype: "json",
    success: function(response){
        alert("response " + response);
    }
}); 
```

现在在 POST 数据上尝试 var_dump：

```
var_dump($_POST['data']); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-01T22:14:17.580

因为您正在尝试对字符串进行 foreach，所以您需要将其转换为对象，`json_decode`以便对其进行迭代。

```
$tNames = json_decode($_POST['tNames']); 
```

见： http: [//php.net/manual/en/function.json-decode.php](http://php.net/manual/en/function.json-decode.php)

# c# - 删除 HTML 编码字符

> ID：14114695
> 
> 赞同：1
> 
> 时间：2013-01-01T22:07:55.970
> 
> 标签：c#, asp.net-mvc-3, html-encode

我正在从数据库中获取一些数据，它具有 HTML 编码字符 ( `&nbsp;`)。有哪些选项可以删除这些？

我根本不希望这些呈现...我希望将它们从数据中剥离。

目前我并不担心 HTML 标签……只是编码字符。

编辑：如果相关，这些字符会导致 JSON 验证出现一些错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:12:37.733

如果您想摆脱它们，请获取此类字符的列表或匹配它们的正则表达式（类似于`&[a-z]+;`）并进行搜索和替换。

但是，如果您只希望它们因 JSON 验证错误而消失，则应正确生成/编码您的 JSON 以避免错误。（但是，我真的不明白它们如何导致无效的 JSON。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T22:35:10.450

在这里，简单地通过正则表达式进行修剪不应该是一种选择。例如`&nbsp;`也可以编码`&#160;`，但`&\#[0-9]+;`正则表达式会导致数据丢失，因为几乎每个字符都可以在某些时候像这样编码（例如：）`<p>&#72;&#69;&#76;&#76;&#79;</p>`。

# python - Django：列出布尔字段时管理员中的 KeyError

> ID：14114698
> 
> 赞同：3
> 
> 时间：2013-01-01T22:08:31.350
> 
> 标签：python, django, django-admin

每当我决定在我的 list_display 中列出一个布尔字段时，例如“活动”（参见示例）

```
class CompanyAdmin(admin.ModelAdmin):
    fields = ['name', 'created']
    list_display = ['name', 'active', 'created'] 
```

我收到以下错误...

```
KeyError at /admin/web/company/

'\x01' 
```

这发生在我尝试列出的任何布尔值上。我使用 grappelli 作为管理员皮肤。我已经包含了下面的完整错误和我的模型。

**模型：**

```
class Company(models.Model):
    companyid = models.CharField(max_length=255, primary_key=True, db_column='companyID')
    name = models.CharField(max_length=105)
    active = models.BooleanField(default=False)
    created = models.DateTimeField()
    modified = models.DateTimeField(null=True, blank=True)
    class Meta:
        db_table = u'company' 
```

**错误：** 环境：

```
Request Method: GET
Request URL: http://127.0.0.1:8000/admin/web/company/

Django Version: 1.4.2
Python Version: 2.7.2
Installed Applications:
('django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.flatpages',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'grappelli.dashboard',
 'grappelli',
 'django.contrib.admin',
 'django.contrib.admindocs',
 'web')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Template error:
In template /Users/user/Documents/workspace/Ares/grappelli/templates/admin/change_list.html, error at line 222

   212 :                     {% blocktrans count cl.formset.errors|length as counter %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktrans %}

   213 :                 </p>

   214 :                 {{ cl.formset.non_form_errors }}

   215 :             {% endif %}

   216 :             <!-- MANAGEMENT FORM -->

   217 :             {% if cl.formset %}

   218 :                 {{ cl.formset.management_form }}

   219 :             {% endif %}

   220 :             <!-- CHANGELIST-RESULTS -->

   221 :             {% block result_list %}

   222 :                  {% result_list cl %} 

   223 :             {% endblock %}

   224 :         </section>

   225 :         <!-- PAGINATION BOTTOM -->

   226 :         {% if not cl.result_count == 0 %}

   227 :             {% block pagination_bottom %}

   228 :                 <div class="grp-module">

   229 :                     <div class="grp-row">{% pagination cl %}</div>

   230 :                 </div>

   231 :             {% endblock %}

   232 :         {% endif %}

Traceback:
File "/Library/Python/2.7/site-packages/django/core/handlers/base.py" in get_response
  136\.                     response = response.render()
File "/Library/Python/2.7/site-packages/django/template/response.py" in render
  104\.             self._set_content(self.rendered_content)
File "/Library/Python/2.7/site-packages/django/template/response.py" in rendered_content
  81\.         content = template.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  140\.             return self._render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in _render
  134\.         return self.nodelist.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  823\.                 bit = self.render_node(node, context)
File "/Library/Python/2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/Library/Python/2.7/site-packages/django/template/loader_tags.py" in render
  123\.         return compiled_parent._render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in _render
  134\.         return self.nodelist.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  823\.                 bit = self.render_node(node, context)
File "/Library/Python/2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/Library/Python/2.7/site-packages/django/template/loader_tags.py" in render
  123\.         return compiled_parent._render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in _render
  134\.         return self.nodelist.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  823\.                 bit = self.render_node(node, context)
File "/Library/Python/2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/Library/Python/2.7/site-packages/django/template/loader_tags.py" in render
  62\.             result = block.nodelist.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  823\.                 bit = self.render_node(node, context)
File "/Library/Python/2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/Library/Python/2.7/site-packages/django/template/loader_tags.py" in render
  62\.             result = block.nodelist.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  823\.                 bit = self.render_node(node, context)
File "/Library/Python/2.7/site-packages/django/template/debug.py" in render_node
  74\.             return node.render(context)
File "/Library/Python/2.7/site-packages/django/template/base.py" in render
  1178\.                     _dict = func(*resolved_args, **resolved_kwargs)
File "/Library/Python/2.7/site-packages/django/contrib/admin/templatetags/admin_list.py" in result_list
  278\.             'results': list(results(cl))}
File "/Library/Python/2.7/site-packages/django/contrib/admin/templatetags/admin_list.py" in results
  256\.             yield ResultList(None, items_for_result(cl, res, None))
File "/Library/Python/2.7/site-packages/django/contrib/admin/templatetags/admin_list.py" in __init__
  248\.         super(ResultList, self).__init__(*items)
File "/Library/Python/2.7/site-packages/django/contrib/admin/templatetags/admin_list.py" in items_for_result
  204\.                     result_repr = display_for_field(value, f)
File "/Library/Python/2.7/site-packages/django/contrib/admin/util.py" in display_for_field
  321\.         return _boolean_icon(value)
File "/Library/Python/2.7/site-packages/django/contrib/admin/templatetags/admin_list.py" in _boolean_icon
  164\.                       {True: 'yes', False: 'no', None: 'unknown'}[field_val])

Exception Type: KeyError at /admin/web/company/
Exception Value: '\x01' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T23:16:38.417

我在现有的 MySQL 数据库上使用一些 Django 模型遇到了类似的问题，该数据库具有来自 Hibernate 的模型。它使用 BIT(1) 作为布尔类型。只要您的 1 和 0 值出现`\x01`在`\x00`Python 中，您就应该能够挽救以下内容`BooleanField`

这里有一些线索：

```
class MyBooleanField(models.BooleanField):

    __metaclass__ = models.SubfieldBase

    def get_internal_type(self):
        return "MyBooleanField"

    def db_type(self):
        return 'bit(1)'

    def to_python(self, value):
        if value in (True, False): return value
        if value in ('t', 'True', '1', '\x01'): return True  
        if value in ('f', 'False', '0', '\x00'): return False

    def get_db_prep_value(self, value):  
        return 0x01 if value else 0x00 
```

来自：[http ://djangosnippets.org/snippets/1869/](http://djangosnippets.org/snippets/1869/)

然后在你的模型中：

```
class Company(models.Model):
    active = models.MyBooleanField(default=False) 
```

# scala - Scala 2.10 中的 __FUNC__ 宏

> ID：14114700
> 
> 赞同：9
> 
> 时间：2013-01-01T22:08:49.087
> 
> 标签：scala, scala-2.10

在 Scala 2.9.x 中，我编写了 func 函数，它返回了执行 func() 的函数的名称，就像**FUNC** C 预处理器宏一样。我知道在 Scala2.10 中我应该能够写出比抛出异常更优雅的东西来完成这项工作。

我该怎么做？在此先感谢您的帮助。

```
object TestMyLog extends App {
    val MatchFunc = """(.+)\(.+""".r

def func(i_level: Int): String = {
    val s_rien = "functionNotFound"
    try {
    throw new Exception()
    } catch {
    case unknwn => unknwn.getStackTrace.toList.apply(i_level).toString match {
            case MatchFunc(funcs) => funcs.split('.').toList.last
        case _ => s_rien
    }
    } finally {
    s_rien      
    }
}

def tracedFunction1 = func(1)
def tracedFunction2 = func(1)

println(tracedFunction1)
assert(tracedFunction1=="tracedFunction1")
println(tracedFunction2)
assert(tracedFunction2=="tracedFunction2")
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-02T04:58:14.130

```
import scala.reflect.macros.Context
import scala.language.experimental.macros

def impl(c: Context) = {
  import c.universe._
  c.enclosingMethod match {
    case DefDef(_, name, _, _, _, _) =>
      c.universe.reify(println(c.literal(name.toString).splice))
    case _ => c.abort(c.enclosingPosition, "no enclosing method")
  }
}

scala> def printEnclosingMethod = macro impl
defined term macro printEnclosingMethod: Unit

scala> def foo = printEnclosingMethod
foo: Unit

scala> foo
foo

scala> printEnclosingMethod
<console>:32: error: no enclosing method
              printEnclosingMethod
              ^ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-01T23:10:32.540

我不确定是否要在没有异常的情况下执行此操作，但您实际上并不需要抛出/捕获异常来获取堆栈跟踪：

```
(new Exception).getStackTrace.toList 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T00:05:53.810

这样，您应该`funName`为每个`Function`arities: `Function1`,`Function2`等重载。也许某些大师会有所帮助？

```
// define macro
import scala.language.experimental.macros
import scala.reflect.macros.Context
object Macros {
  def funName(xs: Function0[_]) = macro funName_impl
  def funName_impl(c: Context)(xs: c.Expr[Function0[_]]) = { 
    c.literal(xs.tree.children.head.toString.split("\\.").last)
  }
}

// exec (in a next compile run)
def haha: Unit = println("Function name: " + Macros.funName(haha _))
haha 
```

# html - 根据原点定位字体

> ID：14114707
> 
> 赞同：0
> 
> 时间：2013-01-01T22:10:17.197
> 
> 标签：html, css

**问题：**

如何根据文本的宽度将文本定位到中心？

**代码：**

以下是我的CSS：

```
#title{
    position: absolute;
    left: 50%;
    top:5%;
    font-size:70px;
} 
```

以下是我的 HTML：

```
<div id = 'title'>This is my lovely title</div> 
```

**更多细节：**

这里的问题是文本“这是我可爱的标题”**从**中心开始，但我希望它平衡并与中心对齐。如何指定文本原点的位置？是否可以使用标准 CSS 来实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:12:57.407

```
#title{
    text-align: center;
    font-size:70px;
} 
```

# node.js - node.js 循环和数据库查询的问题

> ID：14114712
> 
> 赞同：0
> 
> 时间：2013-01-01T22:11:39.357
> 
> 标签：node.js, asynchronous, express

我必须在 Node.js 中循环运行 mysql 查询，但我知道它不能以我想要的方式完成。
这是我想要实现的目标：

```
for(var attributename in body){
   sql.increaseValue(attributename, body[attributename]);
} 
```

我去解析和 JSON 对象，其中我没有编号或属性的名称，也没有它的值。我知道我需要使用某种回调模式。我已经阅读了很多关于此的文章，但在这种情况下，我无法继续
前进，提前感谢
Radek

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:33:36.903

我假设您想要知道所有这些操作何时结束？循环何时结束？这可以通过多种方式实现。我假设您的`.increaseValue`方法接受完成回调。如果是这样的话，那么这里有一个伪代码：

```
var finalize = function( ) {
    // for finalization after the loop
};

var requests = [];
for (var attributename in body) {
    (function(attr){
        var req = function() {
            sql.increaseValue( attr, body[ attr ], function( ) {
                var idx = requests.indexOf( req );
                if (idx !== -1) {
                    requests.splice( idx, 1 );
                }
                if (!requests.length) {
                    finalize( );
                }
            } );
        }
        requests.push( req );
    })(attributename);
}

// second loop
for (var i = 0; i < requests.length; i++) {
    requests[i]( );
} 
```

有几点值得注意：

1）如果`.increaseValue`是真正的异步，那么您可以利用 NodeJS 是单线程的这一事实，您可以摆脱第二个循环并简单地调用`req( )`after `requests.push( req );`。但是，如果有任何机会`.increaseValue`同步触发（例如发生错误或其他情况时），那么这可能会导致`finalize`立即触发。所以请谨慎行事。

2）由于作用域，您需要`req`用匿名函数包装定义。

3) 看看[caolan 的Async.js 库](https://github.com/caolan/async)。它可能会极大地帮助您解决这个问题。

# symfony - Symfony2 - “无关联”

> ID：14114713
> 
> 赞同：0
> 
> 时间：2013-01-01T22:11:44.407
> 
> 标签：symfony, doctrine

我仍在尝试使用 Symfony2 和 Doctrine 中的连接。

到目前为止，我得到了这个：

**控制器**

```
 $ownRepo = $this->getDoctrine()
        ->getRepository('GameShelfUsersBundle:Ownership');

    $ownQuery = $ownRepo->createQueryBuilder('own')
        ->leftJoin('own.games','g', 'WITH', 'g.id = own.game')
        ->where('own.user = :user')
        ->andWhere('own.own = :type')
        ->setParameters(array(
        'user' => $user,
        'type' => $type
    ))
        ->orderBy('own.updated','desc')
        ->getQuery()
        ->getResult(); 
```

**所有权实体（底部）** - 因为它是 long - [pastebin](http://pastebin.com/jrxc7FXF)。

当我尝试运行控制器时出现错误：

```
QueryException: [Semantical Error] line 0, col 79 near 'g WITH g.id =': Error: Class GameShelf\UsersBundle\Entity\Ownership has no association named games

QueryException: SELECT own FROM GameShelf\UsersBundle\Entity\Ownership own LEFT JOIN own.games g WITH g.id = own.game WHERE own.user = :user AND own.own = :type ORDER BY own.updated desc 
```

我在这里做错了什么？

# java - 计算游戏的胜率

> ID：14114716
> 
> 赞同：1
> 
> 时间：2013-01-01T22:11:59.967
> 
> 标签：java, math

我正在尝试制作一个计算体育预测游戏分数的程序。与游戏相关的处罚之一是，您每错过正确的分数，就会从您的分数中减去一分。

例如，您预测 A 队将以 17-0 的比分击败 B 队，但最终比分是 10-14。这意味着您损失了 21 分，因为您预测 B 队的胜利优势是 17 分，而实际上真实的优势是 A 队落后 4 分。

另一个例子，您预测 B 队将以 35-3 的比分击败 A 队。在这种情况下，同样使用上面的最终分数，您只会损失 28 分。

当我测试该程序时，我发现它通常在玩家预测正确的球队获胜时起作用。我知道代码中的问题涉及这种胜利边际惩罚，但**我不明白为什么它有时会给我正确的分数，而其他时候却没有。**

```
// Calculate actual margin of victory 
margin1 = team1score - team2score;
            if (margin1 < 0) {
                margin1 = margin1 * -1;
            }
// Calculate predicted margin of victory
margin2 = prediction2 - prediction1;
            if (margin2 < 0) {
                margin2 = margin2 * -1;
            }

// Calculate difference
if (margin1 == margin2) {
      totalMargin = 0;
} else {
      totalMargin = margin1 - margin2;
      if (totalMargin < 0) {
           totalMargin = totalMargin * -1;
   }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:18:59.880

你的代码太复杂了。

总失分总是：

```
Math.abs(  (prediction2 - prediction1) - (score2 - score1)) 
```

abs 是绝对值。

# c# - 将本机 C# 调用转换为 Java（使用 JNA）

> ID：14114719
> 
> 赞同：0
> 
> 时间：2013-01-01T22:12:26.513
> 
> 标签：c#, java, jna

我刚来这地方。同样，我需要一些帮助来使用 JNA 将一些 C# 代码转换为 Java 来调用本机 Windows 函数。

首先，这是我要转换的代码：http: [//pastebin.com/0b5zMvBg](http://pastebin.com/0b5zMvBg)

到目前为止，我已经编写了 JNA 接口来表示 Kernel32 和 NtDll 库。在 Kernel32 库中，我还定义了需要使用的结构。

**Kernel32.java** [http://pastebin.com/93xTvD0T](http://pastebin.com/93xTvD0T)

**NtDll.java** [http://pastebin.com/giup88Tk](http://pastebin.com/giup88Tk)

在我定义了库和结构之后，我开始编写非本地函数。问题是，我不了解所有的 C# 语法。但是，我确实了解 C# 中的所有 Java 功能。

这是我到目前为止所写的；请注意，如果我对我的转换有疑问，我已经评论了我不理解的内容。大多数问题都会重复，这意味着如果您提供我一次转换，我可能会弄清楚如何完成其​​余的工作。事先感谢您的帮助！:-)

[http://pastebin.com/jfuzq0cj](http://pastebin.com/jfuzq0cj)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T21:06:33.963

通常，您甚至没有做任何特定于 C# 的事情，而是做基本的 C 指针算法。

遍历数据块并在数据类型之间执行转换的最简单方法是使用`com.sun.jna.Memory`而不是`byte[]`. 您可以使用`Pointer.share(long offset)`来执行指针运算（结果是原始指针偏移量的请求量）。`Pointer.write()`您可以使用各种或`Pointer.readXXX()`变体读取和写入本机内存。

您可以使用 a 作为基地址来初始化 Java 端`Structure`对象`Pointer`，只需记住显式调用`Structure.read()`以将本机内存同步到 Java。

一些例子，来自你的馅饼：

```
Memory data = ...;
// mzH = *(MZHeader*) dPtr;
MZHeader mzH = new MZHeader(data);
mzH.read(); // or put this in the MZHeader(Pointer) ctor
// peH = *(PE_Header*)&dPtr[mzH.offsetToPE];
PE_Header peH = new PE_Header(data.share(mzH.offsetToPE));
peH.read(); // or put this in the PE_Header(Pointer) ctor
// peXH = *(PE_ExtHeader*)&dPtr[mzH.offsetToPE + sizeof(PE_Header)];
PE_ExtHeader peXH = new PE_ExtHeader(data.share(mzH.offsetToPE + peH.size()));
peXH.read(); // or put this in the PE_ExtHeader(Pointer) actor 
```

我想你可以从那里得到这个想法......

**编辑**

```
Pointer p = new Memory();
byte[] data = ...;
// Copy into Memory from data
p.write(0, data, 0, data.length);
// Copy out of Memory into data
p.read(0, data, 0, data.length); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T07:44:52.423

所以你的 Kine.Run() 看起来就像这段代码的主要入口点。它所做的是获取给定的字节数组，分叉当前进程，然后用字节数组覆盖当前进程内存并开始执行它。如果您实现了这一点，您会将字节数组作为子进程运行。

现在，假设字节数组来自文件系统中的某个文件（或者可以写在那里），您可以将所有这些代码替换为以下行：

```
Runtime.getRuntime().exec(filename); 
```

假设文件名是包含字节数组的文件。无需了解 PE 标头或 Windows 内部结构。如果字节数组来自您无法在本地存储的地方，那么您无论如何都无法运行它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-02T06:18:17.703

不要学究，但不要那样做。您正在尝试在 JVM 中运行 C# 程序？编写一个抽象出应用程序的操作系统特定部分的层会更简单、更快。您可以在 C# 中执行一些在 JVM 中无法执行的操作。比如加载DLL，然后调用其中的方法。或者从 windows 消息循环中获取消息。

现在，我同意有些事情您可能想做而只能从本机库中完成。喜欢与其他窗口交互。但是您正在用 Java 重新实现 CLR。这是一个巨大的工作量，有些部分永远不会工作。

只是不要这样做。（在此处插入耐克旋风）

# python - 使用 Python 请求库保存大文件

> ID：14114729
> 
> 赞同：89
> 
> 时间：2013-01-01T22:13:59.397
> 
> 标签：python, file, http, download, request

> **可能重复：**
> [如何使用请求下载图像](https://stackoverflow.com/questions/13137817/how-to-download-image-using-requests)

我知道获取 url 很简单`requests.get`，我可以获取原始响应正文并将其保存到文件中，但是对于大文件，有没有办法直接流式传输到文件？就像我正在用它下载电影或其他什么？

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2013-01-01T22:16:20.920

奇怪的是，请求没有任何简单的东西。您必须遍历响应并将这些块写入文件：

```
response = requests.get('http://www.example.com/image.jpg', stream=True)

# Throw an error for bad status codes
response.raise_for_status()

with open('output.jpg', 'wb') as handle:
    for block in response.iter_content(1024):
        handle.write(block) 
```

我通常只使用`urllib.urlretrieve()`. 它可以工作，但是如果您需要使用会话或某种身份验证，上面的代码也可以工作。

# php - jquery, 会话 & php session_id();

> ID：14114730
> 
> 赞同：2
> 
> 时间：2013-01-01T22:14:15.177
> 
> 标签：php, jquery, session, sessionid

我有一个 session_id，我用它来识别购物篮类型应用程序中的用户。

session_id 作为会话 id 存储在数据库中。

当我更新购物车时，session_id、product_id 和 qty 存储在 Basket 表中。

我正在尝试将一个项目添加到篮子，然后在屏幕上显示更新的篮子而不使用 jquery 刷新页面。

我是否将会话 ID 存储在隐藏的 html 字段中，还是有更好的方法让 jQuery 知道 session_id 是什么？

**更新：** 好的，所以现在根据下面的答案和评论，我真的不想在隐藏字段中使用会话 ID。我当然不想在 html 页面中显示会话 ID。

我可能需要回溯一点……

当 ajax 调用我的更新篮子函数时，我遇到了以下错误...

```
Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at ..... /ajaxData.php on line 105 
```

我用来启动会话的代码是......

```
if (!session_id()){
session_start();
} 
```

我真的不明白这个警告是什么意思，所以这就是为什么我想通过隐藏的 html 字段发送会话 ID。

我想解决方案是修复警告并尝试正确地做事......

对我的警告信息有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:43:05.113

IMO 所有会话数据都必须在服务器中进行管理，**如果您确实需要在前端**异步获取它。例如：

1.- jQuery 的东西

```
$.get(
        window.location.href,
        {
            get_session_id : 1
        },
    function(data) {
    var session_id = data.session_id
    if ("" == session_id){
            // alert user
            // give a friendly way to proceed without loss user's time
            // return;
    }
    // use session_id
}, "json"); 
```

**更新** 为避免`Warning: session_start() [function.session-start]...`错误，请尽早将此代码段放入您的脚本中。在任何 html 输出之前。

2.- 服务器的东西

```
// none output before this snippet

if ($_GET['get_session_id'])
{
    // get $session_id
    $output['session_id'] = $session_id ? $session_id : '';
    echo json_encode($output);
    exit;
} 
```

**更新 2：**

我向您提出此解决方案的原因是，我认为最好在需要时动态获取会话 ID，而不是以静态方式存储它，因为此标识符可能会被修改、删除等，而用户花时间填写表格。
不幸的是，这个缺陷很常见而且很烦人。提交一个表单，而不是被处理，我们被重定向到一个登录页面，丢失所有发送的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:18:50.950

使用这个 JavaScript 代码（结合 PHP）：

```
<script type="text/javascript">
var sessionid = "<?php echo session_id(); ?>";
</script> 
```

然后在您的 jQuery (AJAX?) 调用中使用*sessionid*变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T22:24:26.193

你可以使用一个`data-`属性：

```
<form id="cart-form" action="" data-sessionid="<?php echo session_id(); ?>">
    <!-- rest of form code -->
</form> 
```

然后在您的 jQuery 中，只需使用`$(this).data('sessionid')`它来检索它：

```
$('#cart-form').submit(function() {
    var session_id = $(this).data('sessionid'); 
    // ... rest of your code here ...
}); 
```

# php - 我的服务经理/定位器。我可以注入它还是只应该创建服务？

> ID：14114736
> 
> 赞同：0
> 
> 时间：2013-01-01T22:15:02.637
> 
> 标签：php, oop, model-view-controller, dependency-injection

好的，所以我有这个服务管理器/定位器/工厂对象，它创建和管理我的单个实例对象，例如我的记录器、http 请求、http 响应、路由器等。

在我的启动/引导文件中，我只是实例化它并启动我的服务：

```
$services = new Services();

$logger = $services->getService('logger');
$security = $services->getService('security');
$auth = $services->getService('auth');
$router = $services->getService('router');
etc... 
```

它知道每个服务的依赖关系，并像工厂一样轻松创建对象。

事情是我的`Auth`课，例如，如果在几个月内不知何故需要另外两个依赖项，我只需要：

1.  修改我的`Services`类中实例化`Auth`类的方法。
2.  修改我的`Auth`类中的构造函数并添加两个新的依赖项。

不到五分钟。

这个`$services`对象也实例化了我的控制器。每个控制器都有 1 个依赖项（目前）`View`，.

这样做的问题是，当我创建 20 个以上的控制器时，显然都具有相同的依赖项，然后在几个月后我需要向控制器添加两个以上的依赖项，我将不得不：

1.  修改我的`Services`类中实例化`Controller`类的方法。
2.  修改**每个**Controller 类的构造函数并添加两个新的依赖项。

我知道如果我在服务管理器/定位器/工厂对象之外独立创建控制器并将`$services`对象注入控制器，那么我制作的每个控制器都只有一个依赖项。我可以制作一百万个，如果出现另一个依赖项，我不必去更改所有控制器文件，但这可以吗？

我觉得当它只需要来自服务管理器的一两个服务并且它对你隐藏控制器依赖项时，它会向控制器注入很多东西，它们不像你将它们注入构造函数那样可见.

你对此有何看法？你认为我应该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T23:02:37.743

听起来您需要在服务类中使用的控制器工厂（或方法）。
作为参数，您可以传入类名，例如：

```
$controller = $this->controllerFactory->create('Foo\BarController');
$controller->setAnotherDependency($baz); 
```

其他依赖项，不是所有控制器共享的，您可以通过 setter 添加。

顺便说一句：为什么不使用像[Pimple](https://github.com/fabpot/Pimple)或[Symfony2 DIC](https://github.com/symfony/DependencyInjection)这样的依赖容器？

# qt - 哪个 Qt 小部件用于实现图像缩略图浏览器（显示图块）？

> ID：14114737
> 
> 赞同：28
> 
> 时间：2013-01-01T22:15:23.447
> 
> 标签：qt, widget

我希望基本上复制这个：

![在此处输入图像描述](../Images/4bef2aa8c41f5355e6c0bf68cf41240f.png)

什么是最适合显示包含图像+下标的自定义小部件的 Qt 容器小部件？我正在查看，`QTableView`它似乎应该有一定数量的行/列，而我希望我的程序根据窗口宽度更改布局（这样就没有水平滚动），并且应该添加新的小部件完成了`addWidget(QWidget * w)`，没有`setWidget(int row, int column, QWidget * w)`。有没有比 QTableView 更好的组件（我的任务需要大量编码）？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-01-01T22:36:57.610

您应该使用`QListWidget`（或`QListView`和子类`QAbstractItemModel`）并将其**视图模式**设置为`IconMode`.

**例子 ：**

```
m_listeWidget->setViewMode(QListWidget::IconMode);

m_listeWidget->setIconSize(QSize(200,200));

m_listeWidget->setResizeMode(QListWidget::Adjust);

m_listeWidget->addItem(new QListWidgetItem(QIcon("../earth.jpg"),"Earth"));
m_listeWidget->addItem(new QListWidgetItem(QIcon("../tornado.jpg"),"Tornado"));
m_listeWidget->addItem(new QListWidgetItem(QIcon("../ics.jpg"),"Wallpaper")); 
```

**结果 ：**

![在此处输入图像描述](../Images/a5a3165f3b3e46ef3e9d8bf529eab1ed.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T02:16:21.660

绝对 QTableView，使用自定义 itemDelegate 呈现每个块，实现自定义小部件以显示图像和文本标题

# vim - 电力线可以在多个缓冲区中显示，但不能在单个缓冲区中显示

> ID：14114738
> 
> 赞同：25
> 
> 时间：2013-01-01T22:15:40.297
> 
> 标签：vim, macvim, vim-plugin

我刚刚使用病原体和子模块将 Powerline 插件安装到我的 vim 中。

电力线**仅**在有**多个缓冲区**时可见。当vim中只有一个缓冲区时，我看不到它。

我想知道这是否是一个错误？

![单身的](../Images/58d42b90c2aa1baf5603f6c8b3df7481.png) ![向量](../Images/751002e7a518e1cb97206a90f67a3449.png) ![霍兹](../Images/8c4368dc70e95bab097f743f341900b9.png)

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-01-01T22:22:35.017

您的意思是多个窗口而不是缓冲区。

默认情况下，`statusline`当只有一个窗口时，vim 设置为不显示。您可以使用以下方法覆盖它：

```
set laststatus=2 
```

数字表示这样的行为：

```
0: never
1: only if there are at least two windows (this one is the default)
2: always 
```

查看`:h laststatus`更多信息..

# php - 使用 youtube 链接将 \ 放入数据库

> ID：14114740
> 
> 赞同：-6
> 
> 时间：2013-01-01T22:16:03.480
> 
> 标签：php, mysqli

这样当我在我的数据库中放置一个链接时，然后标记/下载视频并将其放置在这样的页面上

因此，当我将它放入数据库时​​，它在数据库中将看起来像这样，并且我无法真正弄清楚出了什么问题，因为这样做然后是 \ 进入喜欢它的 php 中的链接

在这里显示：

这就是我的想法。但是，我没有尝试任何东西。但这是我网站的代码：

```
<tr>
                    <td>Video:</td>
                    <td><input type="text" name="video"></td>
                </tr> 
```

和我的所有信息到 youtube 的代码

```
if ($stmt = $this->mysqli->prepare("INSERT INTO `artiker` (`title`, `kort`, `video`, `tekst`, `img`, `img_title`) VALUES (?, ?, ?, ?, ?, ?)")) { 

            $stmt->bind_param('ssssss', $title, $kort, $video, $tekst, $img, $img_title);

            /* Sæt værdier på parametrene */
            $title = $_POST['title']; 
            $kort = $_POST['kort'];
            $video = $_POST['video'];
            $tekst = $_POST['tekst'];
            $img = $pb;
            $img_title = $_POST["img_title"];

            /* Eksekver forespørgslen */
            $stmt->execute();

            /* Luk statement */
            $stmt->close();

            ?>
            <script language="javascript" type="text/javascript">  
                window.location.href = "/artikler-programmering/";  
            </script> 
            <?php

        } else {
            /* Der er opstået en fejl */
            echo 'Der opstod en fejl i erklæringen: ' . $this->mysqli->error;
        } 
```

**真的希望你能帮助我不要在我的 youtube 链接中设置 \**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:22:05.363

我的猜测是您正在处理转义字符串...尝试`stripslashes()` [http://php.net/stripslashes](http://php.net/stripslashes)：

```
$video = stripslashes($_POST['video']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T22:26:07.070

只是猜测...从数据库中检索 youtube 链接后，您将需要调用`stripslashes()`视频链接。

该函数将做的是转换：

```
https:\/\/www.youtube.com\/watch?v=RlfLCWKxHJ0 
```

进入

```
https://www.youtube.com/watch?v=RlfLCWKxHJ0 
```

# android - 尽管我有 android-support-v13 库，但 Eclipse 无法识别 android.support.v13.app.FragmentActivity

> ID：14114745
> 
> 赞同：4
> 
> 时间：2013-01-01T22:16:58.953
> 
> 标签：android, fragment, android-support-library

我正在为这个错误而苦苦挣扎，我真的无法做到。我尝试导入 android.support.v13.app.FragmentActivity；进入一个类，但它给了我错误：无法解析导入 android.support.v13.app.FragmentActivity。我想提一下，我在 libs 文件夹中有 v13 和 v4。我使用了 Clean、Android 支持库和修复项目属性。如果重要的话，目标设备是 2.3.3。谢谢你。我真的很希望有人可以帮助我。编辑：编辑 v4 后，很多错误都消失了，我只有 2 个。我是 android 的初学者，所以如果你能解释一下这里出了什么问题：

```
private class ScreenSlidePagerAdapter extends FragmentStatePagerAdapter {
    public ScreenSlidePagerAdapter(FragmentManager fm) {
        super(fm); //Error: The constructor Fragmentstagepageadapter(FragmentManager) is undefined
    }

@Override
public **Fragment** getItem(int position) { //And Here: The return type is incompatible
    return ScreenSlidePageFragment.create(position);
}

@Override
public int getCount() {
    return NUM_PAGES;
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:36:07.720

FragmentActivity 是 v4 文件夹的一部分，对吧？v13 仅表示 API 13 及更高版本将使用该文件夹中的类。因此，虽然您可能拥有该文件夹，但我敢打赌其中没有 FragmentActivity :) 将您的导入更改为具有 v4 而不是 v13。

[http://developer.android.com/reference/android/support/v4/app/FragmentActivity.html](http://developer.android.com/reference/android/support/v4/app/FragmentActivity.html)

所以你知道如果你使用 SupportLib，你不能从操作系统中使用 Fragment，你必须只使用 SupportLib 中的 Fragment 类。这包括 Fragment 本身。

[http://developer.android.com/reference/android/support/v4/app/Fragment.html](http://developer.android.com/reference/android/support/v4/app/Fragment.html) vs [http://developer.android.com/reference/android/app/Fragment.html](http://developer.android.com/reference/android/app/Fragment.html) ..基本上是android里面的任何东西与片段有关的 .app 不能与您的 SupportLib 类一起使用。它们不是同一个类层次结构，也不兼容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T20:15:31.863

这是我对一个非常相似的问题给出的答案：

将“import android.support.v13.app.FragmentActivity”更改为“import android.support.v4.app.FragmentActivity”

对于未定义的部分，请尝试以下语法：

```
public class ScreenSlidePagerAdapter extends FragmentStatePagerAdapter {
public ScreenSlidePagerAdapter (android.support.v4.app.FragmentManager fm) {
    super(fm);
} 
```

和：

```
@Override
public android.support.v4.app.Fragment getItem(int position) {
    return ScreenSlidePagerAdapter.create(position);
} 
```

# c - C 函数指针语法

> ID：14114749
> 
> 赞同：55
> 
> 时间：2013-01-01T22:17:02.667
> 
> 标签：c, declare

我的问题是一个非常简单的问题。

通常，在声明某个变量时，您会将其类型放在其前面，例如：

```
int a; 
```

函数指针的类型可能类似于: `int(*)(int,int)`，以防我们指向一个接受两个整数并返回一个整数的函数。但是，当声明这样一个指针时，它的标识符不在类型之后，比如：

```
int(*)(int,int) mypointer; 
```

相反，您必须在中间写下标识符：

```
int(*mypointer)(int,int); 
```

为什么会这样？抱歉，我知道这是一个令人尴尬的简单问题...

感谢大家的回复。作为

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-01T22:22:06.033

我在回答[为什么数组、指针和函数的 C 语法是这样设计的？](https://softwareengineering.stackexchange.com/questions/117024/why-was-the-c-syntax-for-arrays-pointers-and-functions-designed-this-way/117039#117039)，它基本上归结为：

> 语言作者更喜欢使语法以变量为中心而不是以类型为中心。也就是说，他们希望程序员查看声明并认为“如果我写表达式`*func(arg)`，那将导致一个`int`；如果我写`*arg[N]`，我会有一个浮点数”而不是“`func`必须是指向一个函数的*指针*并返回*那个*“。
> 
> 维基百科上的[C 条目](http://en.wikipedia.org/wiki/C_(programming_language)#Criticism)声称：
> 
> Ritchie 的想法是在类似于它们使用的上下文中声明标识符：“声明反映使用”。
> 
> ...引用 K&R2 的 p122。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-01-01T22:21:57.657

这个结构反映了一个普通函数是如何被声明（和使用）的。

考虑一个正常的函数定义：

```
int foo (int bar, int baz, int quux); 
```

现在考虑定义一个指向具有相同签名的函数的函数指针：

```
int (*foo) (int, int, int); 
```

注意这两个结构如何相互镜像？这使得`*foo`更容易识别为函数指针而不是其他东西。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-01-01T22:22:22.677

如果您正在处理一个函数（不是指向一个函数的指针），则名称也在中间。它就像：`return-type function-name "(" argument-list ")" ...`。例如， in`int foo(int)`是`int`返回类型、`foo`名称和`int`参数列表。

指向函数的指针的工作方式几乎相同——返回类型，然后是名称，然后是参数列表。在这种情况下，我们必须添加 a`*`以使其成为指针，并且（因为`*`for a 指针是前缀）一对括号将 the 绑定`*`到名称而不是返回类型。例如，`int *foo(int)`这意味着一个名为 foo 的函数，它接受一个 int 参数并返回一个指向 int 的指针。为了让 * 绑定到`foo`，我们需要括号，给 `int (*foo)(int)`.

当您需要指向函数的指针数组时，这会变得特别难看。在这种情况下，大多数人发现使用 typedef 作为指针类型最容易，然后创建该类型的数组：

```
typedef int (*fptr)(int);

fptr array[10]; 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-10-20T03:24:40.240

我曾在某些地方看到函数指针声明为

```
int (*foo) (int a, int b); 
```

在某些地方`a`并`b`没有被提及，并且两者仍然有效。

所以

```
int (*foo) (int, int) 
```

也是正确的。

我发现记住的一个非常简单的方法如下所述：

假设函数声明为：

```
int function (int a , int b); 
```

**Step1：**只需将函数放在括号中：

```
int (function) (int a , int b); 
```

**Step2：**`*`在函数名前加a并更改名称：

```
int (*funcPntr) (int a , int b); 
```

PS：在这个答案中，我没有遵循命名约定等的正确编码指南。

# java - 无法将 eclipse 项目克隆到工作区

> ID：14114752
> 
> 赞同：1
> 
> 时间：2013-01-01T22:18:25.100
> 
> 标签：java, eclipse, git, bitbucket, egit

我正在使用 Eclipse Juno 开发从 bitbucket 克隆的 java 项目，但是当使用 Egit eclipse 插件从我的 bitbucket 存储库导入项目时，我收到此错误：`Invalid project description`

我删除了项目文件夹并尝试使用克隆`git clone`，在将项目导入工作区后，我得到了同样的错误！

谁能帮忙？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:50:23.820

您必须区分 Java 项目和 Eclipse 项目。不是每个 Java 项目都已经是 Java 项目，也不是每个 Eclipse 项目都是 Java 项目。您可以通过存在的文件识别 Eclipse 项目。一个 Eclipse 项目包含一个文件`.project`和一个文件夹`.settings`。在此文件中保存项目设置和元数据（例如，如果它是 Java 项目）。

确保您要签出的项目是 Eclipse 项目还是纯 Java 项目。

在我看来，好像不是，但您尝试将其导入。如果它不是 Eclipse 项目，您应该使用“新建项目向导”导入项目。选择`Java project`，你会没事的。

Eclipse 现在将创建项目配置文件。如果您提交更改，请确保忽略这些文件。您不希望它们在您的存储库中，因为它们包含可能不适用于其他机器的系统特定设置。这就是为什么您很可能不会在存储库中找到 Eclipse 项目的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:53:27.913

您可以先在 Eclipse 中创建一个项目并从 repo 中克隆它

# android - 防止默认返回按钮

> ID：14114755
> 
> 赞同：0
> 
> 时间：2013-01-01T22:18:32.260
> 
> 标签：android, actionscript-3, apache-flex, flash-builder, flex-mobile

大家好，我怎么能在我的 Flex 应用程序中阻止 Android 应用程序的 BACK Button 的默认行为。当菜单打开时，我需要单击 BACK 将其关闭。对于第二次单击，我需要转到第一个视图。出现的问题是，当菜单通过单击返回开始关闭时，它会推送到第一个视图，并且方法 preventDefualt 不起作用。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:42:53.303

监听 View 上的[backKeyPressed](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/View.html#event%3abackKeyPressed)事件。在您的事件侦听器代码中，您可以手动关闭菜单（如果它已打开），或者如果它已关闭则弹出视图。

# python - Twisted 中的 FTP 文件服务器

> ID：14114756
> 
> 赞同：0
> 
> 时间：2013-01-01T22:18:38.913
> 
> 标签：python, macos, ftp, twisted

我目前正在尝试启动并运行 FTP 服务器，但我什至无法让 Mac OS X 上的 Finder 连接...

**查找器错误：**

```
There was a problem connecting to the server “192.168.1.67”.
Check the server name or IP address, and then try again. If you continue to have problems, contact your system administrator. 
```

**标准输出**

```
python FTPtoEMAIL.py 
2013-01-01 17:16:01-0500 [-] Log opened.
2013-01-01 17:16:01-0500 [-] FTPFactory starting on 7654
2013-01-01 17:16:01-0500 [-] Starting factory <twisted.protocols.ftp.FTPFactory instance at 0x6aff80>
2013-01-01 17:16:26-0500 [FTP (ProtocolWrapper),0,192.168.1.67] Setting up avatar
2013-01-01 17:16:26-0500 [FTP (ProtocolWrapper),0,192.168.1.67] apple
2013-01-01 17:16:26-0500 [FTP (ProtocolWrapper),1,192.168.1.67] Setting up avatar
2013-01-01 17:16:26-0500 [FTP (ProtocolWrapper),1,192.168.1.67] apple
^C2013-01-01 17:16:35-0500 [-] Received SIGINT, shutting down.
2013-01-01 17:16:35-0500 [twisted.protocols.ftp.FTPFactory] (TCP Port 7654 Closed)
2013-01-01 17:16:35-0500 [twisted.protocols.ftp.FTPFactory] Stopping factory <twisted.protocols.ftp.FTPFactory instance at 0x6aff80>
2013-01-01 17:16:35-0500 [-] Main loop terminated. 
```

**代码**

```
import sys
import EMail
from twisted.protocols.ftp import FTPFactory, FTPRealm
from twisted.cred.portal import Portal
from twisted.cred import checkers
from twisted.cred.checkers import AllowAnonymousAccess, FilePasswordDB
from twisted.internet import reactor
from twisted.python import log
from twisted.internet.defer import succeed, failure

from twisted.protocols.ftp import FTPFactory, FTPRealm, FTP, FTPShell, IFTPShell

# EMail Shell
USER = "Apple"
PASSWORD = "Orange"

class EMailtoFTPShell(object):
    """
        An abstraction of the shell commands used by the FTP protocol for
        a given user account.

        All path names must be absolute.
        """

    def __init__(path, avatar):
        print path
        print avatar

        self.root_path = path
        self.avatar = avatar

    def makeDirectory(path):
        """
            Create a directory.

            @param path: The path, as a list of segments, to create
            @type path: C{list} of C{unicode}

            @return: A Deferred which fires when the directory has been
            created, or which fails if the directory cannot be created.
            """
        print path

        path = os.path.join(self.root_path, path)

        os.mkdir(path)

        return succeed(path)

    def removeDirectory(path):
        """
            Remove a directory.

            @param path: The path, as a list of segments, to remove
            @type path: C{list} of C{unicode}

            @return: A Deferred which fires when the directory has been
            removed, or which fails if the directory cannot be removed.
            """
        print path
        path = os.path.join(self.root_path, path)

        os.rremovedir(path)

        return succeed(path)

    def removeFile(path):
        """
            Remove a file.

            @param path: The path, as a list of segments, to remove
            @type path: C{list} of C{unicode}

            @return: A Deferred which fires when the file has been
            removed, or which fails if the file cannot be removed.
            """
        print path

        path = os.path.join(self.root_path, path)

        os.remove(path)

    def rename(fromPath, toPath):
        """
            Rename a file or directory.

            @param fromPath: The current name of the path.
            @type fromPath: C{list} of C{unicode}

            @param toPath: The desired new name of the path.
            @type toPath: C{list} of C{unicode}

            @return: A Deferred which fires when the path has been
            renamed, or which fails if the path cannot be renamed.
            """
        print fromPath
        print toPath

        fromPath = os.path.join(self.root_path, fromPath)
        toPath   = os.path.join(self.root_path, toPath)

        os.rename(fromPath, toPath)

        succeed(toPath)

    def access(path):
        """
            Determine whether access to the given path is allowed.

            @param path: The path, as a list of segments

            @return: A Deferred which fires with None if access is allowed
            or which fails with a specific exception type if access is
            denied.
            """
        print path

        return succeed(None)

    def stat(path, keys=()):
        """
            Retrieve information about the given path.

            This is like list, except it will never return results about
            child paths.
            """
        print path
        print keys

        #todo

    def list(path, keys=()):
        """
            Retrieve information about the given path.

            If the path represents a non-directory, the result list should
            have only one entry with information about that non-directory.
            Otherwise, the result list should have an element for each
            child of the directory.

            @param path: The path, as a list of segments, to list
            @type path: C{list} of C{unicode}

            @param keys: A tuple of keys desired in the resulting
            dictionaries.

            @return: A Deferred which fires with a list of (name, list),
            where the name is the name of the entry as a unicode string
            and each list contains values corresponding to the requested
            keys.  The following are possible elements of keys, and the
            values which should be returned for them:

            - C{'size'}: size in bytes, as an integer (this is kinda required)

            - C{'directory'}: boolean indicating the type of this entry

            - C{'permissions'}: a bitvector (see os.stat(foo).st_mode)

            - C{'hardlinks'}: Number of hard links to this entry

            - C{'modified'}: number of seconds since the epoch since entry was
            modified

            - C{'owner'}: string indicating the user owner of this entry

            - C{'group'}: string indicating the group owner of this entry
            """
        print path
        print keys

        #todo

    def openForReading(path):
        """
            @param path: The path, as a list of segments, to open
            @type path: C{list} of C{unicode}

            @rtype: C{Deferred} which will fire with L{IReadFile}
            """
        print path

        # fetch from the email server
        metadata = EMail.parse_file(os.join(self.root_path, path))

        return fetch_from_mail_server(metadata, "READ")

    def openForWriting(path):
        """
            @param path: The path, as a list of segments, to open
            @type path: C{list} of C{unicode}

            @rtype: C{Deferred} which will fire with L{IWriteFile}
            """
        print path

        # fetch from the email server
        metadata = EMail.parse_file(os.join(self.root_path, path))

        return fetch_from_mail_server(metadata, "WRTE")

class EMailToFTPRealm(object):

    def __init__(self):
        pass

    def requestAvatar(self, avatarId, mind, *interfaces):
        for iface in interfaces:
            if iface is IFTPShell:
                if not avatarId is checkers.ANONYMOUS:
                    print "Setting up avatar"
                    print avatarId
                    avatar = EMailtoFTPShell("/Users/FTP_Server/", avatarId)
                    return IFTPShell, avatar, getattr(avatar, 'logout', lambda: None)
        raise NotImplementedError("Only IFTPShell interface is supported by this realm")

if __name__ == "__main__":

    p = Portal(EMailToFTPRealm(),
           [FilePasswordDB("pass.dat")])

    f = FTPFactory(p)

    log.startLogging(sys.stdout)
    reactor.listenTCP(7654, f)
    reactor.run() 
```

**通行证.dat**

```
apple:orange 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T08:23:28.530

在 twistd 正常工作并且您能够使用 Finder 连接到 FTP 服务器的基础上，这看起来是 OS X 问题而不是 Twisted 问题。

发生写入问题是因为通过 Finder 建立的 FTP 连接是只读的（根据此[Apple 支持文章](http://support.apple.com/kb/TA21175?viewlocale=en_US)）

假设您使用上面的 pass.dat 文件，您的计算机的标准登录将不起作用，因为它没有在该文件中列出！您需要使用在您的 pass.dat 文件中指定的登录名，*并且*可以访问 ftp 服务器的根目录。

# c# - Windows Phone - 将文本上传到 FTP 服务器

> ID：14114759
> 
> 赞同：1
> 
> 时间：2013-01-01T22:19:00.497
> 
> 标签：c#, windows-phone-7, ftp

只是想知道使用 C# for Windows Phone 7 将字符串上传到 FTP 服务器的最佳方式是什么。

# java - 将重复值从一个 ArrayList 移动到另一个 ArrayList (Java)

> ID：14114764
> 
> 赞同：1
> 
> 时间：2013-01-01T22:19:49.133
> 
> 标签：java, arraylist

假设我有两个 ArrayList 对象。用户将输入一些字母，但在本例中，我只是将一些字母硬编码到 ArrayList 中以使生活更轻松。这似乎是一个简单的问题，但我对此感到非常困惑！

```
ArrayList<String> letters = new ArrayList<String>();
ArrayList<String> duplicateLetters = new ArrayList<String>();

letters.add("z");
letters.add("a");
letters.add("z");
letters.add("z");
letters.add("b"); 
```

我的目标是从 ArrayList 中删除重复项`letters`，因此它最终只会包含`["z"], ["a"] and ["b"]`.

但是，我希望 ArrayList`duplicateLetters`存储多次输入的任何字母。因为`"z"`被复制了两次，所以我希望 duplicateLetters 包含`["z"]`and `["z"]`在这个例子中。

如果可能的话，我还想跟踪每个字母被重复的次数。

我已经尝试过使用 HashSet ，它在删除列表中的重复项时非常有效（请参阅这个问题：[如何从 ArrayList 中删除重复的元素？](https://stackoverflow.com/questions/203984/how-do-i-remove-repeated-elements-from-arraylist)）。但是，Sets 只是简单地忽略重复项，在这种情况下，我想跟踪它们。

我在乞求想法！：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:29:24.643

为什么不维护一个`Map`将字母映射到频率的函数。每次用户输入字母时，您都会更新此地图：

```
Map<String, Integer> map = new HashMap<String, Integer>();

if (map.containsKey(input)) {
    map.put(input, map.get(input) + 1);
} else {
    map.put(input, 1);
} 
```

要创建`letters`，您将拥有：

```
List<String> letters = new ArrayList<String>(map.keySet()); 
```

要创建`duplicateLetters`，您可以遍历键并仅添加值大于的键`1`：

```
List<String> duplicateLetters = new ArrayList<String>();

for (String key : map.keySet())
    if (map.get(key) > 1)
        duplicateLetters.add(key); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T22:28:42.687

这会起作用，我不确定它是否非常有效，但我认为它很好。它将所有字母移动到 newLetters 或 duplicateLetters。

```
public static void main(String[] args) {
    ArrayList<String> letters = new ArrayList<String>();
    HashMap<String, Integer> duplicateLetters = new HashMap<String, Integer>();
    ArrayList<String> newLetters = new ArrayList<String>();

    letters.add("z");
    letters.add("a");
    letters.add("z");
    letters.add("z");
    letters.add("b");

    Iterator<String> iterator = letters.iterator();
    while (iterator.hasNext()) {
        String next = iterator.next();
        if (newLetters.contains(next)) {
            Integer value = duplicateLetters.get(next);
            if (value == null) {
                duplicateLetters.put(next, 1);
            }
            else {
                duplicateLetters.put(next, value + 1);
            }
        }
        else {
            newLetters.add(next);
        }
    }

    letters = newLetters;

    for (String letter : letters) {
        System.out.println("these are left: " + letter);
    }

    for (Map.Entry<String, Integer> entry : duplicateLetters.entrySet()) {
        System.out.println(entry.getKey() + " was duplicated " + entry.getValue()+ " time(s)");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:03:51.650

你的问题很简单。为什么不使用 java collections api 中提供的集合算法。

所以这是你需要做的：

ArrayList 字母 = new ArrayList(); // 是需要添加元素的列表

//假设您要维护一个 Map 实现以跟踪重复项：
Map dupLetters = new HashMap();

//所以编写自己的add方法如下：

public void addLetter(String letter) { int count = Collections.frequency(letters,letter);

如果（计数> 0）

{

```
 int letterFreq = 0; 

 //This entry is a duplicate so don't add this one to list; put it in the map

if(dupLetters.containsKey(letter))

{ 

    letterFreq = dupLetters.get(letter); 

}

  dupLetters.put(letter,(letterFreq+1)) 
```

}

//希望对你有帮助 ！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-30T15:50:57.343

您的问题的简单解决方案。更好地使用 hashmap 来获取两个重复的字符串及其在 arraylist 中的总数：

公共静态无效主（字符串参数 []）

{

```
 ArrayList<String> al=new ArrayList<String>();
  HashMap<String,Integer> ht=new HashMap<String,Integer>();
  al.add("a");
  al.add("z");
  al.add("z");
  al.add("b"); 
  al.add("a");
  al.add("t");
  al.add("t");
  int ct=0;
    for(String i : al)
    {
        for(String j : al)
           {
            if(i.equals(j))
             {
                ct++;
            }
        }
        if(ct>1)
        {
            ht.put(i, ct);
        } ct=0;
    }

    for(Entry g:ht.entrySet())
    {
        System.out.println(g.getKey()+" "+g.getValue());
    }
} 
```

# javascript - r.js 无法编译

> ID：14114772
> 
> 赞同：2
> 
> 时间：2013-01-01T22:21:21.133
> 
> 标签：javascript, requirejs

我正在从事一个涉及许多 JavaScript 文件并使用 require.js 来管理它们的项目。

一切正常，没有浏览器错误，我的代码与 lintjs 完全一致（我使用的是 CoffeeScript）。但是，当我尝试将我的脚本优化为一个失败时，操作会失败。我用 npm 安装了 r.js

**执行的命令**

```
r.js -o main.js 
```

**错误信息**

```
Error: Build file /devl/premiumthemes/wp-content/themes/premiumthemes/views/files/js/main.js is malformed: SyntaxError: Unexpected token ;
    at Function.build.createConfig (/usr/local/lib/node_modules/requirejs/bin/r.js:22611:23) 
```

可能出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T01:53:43.073

RequireJs 的优化器 r.js 需要一个构建文件或一些内联参数，详细说明要使用的设置（包括要优化的文件或目录、输出的文件等）。

更多关于 r.js 优化的信息可以在[RequireJS 优化](http://requirejs.org/docs/optimization.html)中找到。

所有不同的配置选项也可以在[示例构建文件](https://github.com/jrburke/r.js/blob/master/build/example.build.js)中看到

# ios - 将网络应用程序与 ios 谷歌地图集成

> ID：14114774
> 
> 赞同：1
> 
> 时间：2013-01-01T22:21:36.890
> 
> 标签：ios, google-maps, web-applications, google-maps-sdk-ios

我不是程序员，但我有一个应用程序，我有一群开发人员正在开发。我想更好地描述我希望我的开发人员做什么，但我不知道完成我的目标需要什么。

我有一个旨在从平板电脑运行的网络应用程序，很可能是 iPad。该系统的一个重要组成部分是优化地址列表的快递型路由系统。应用程序中有一个嵌入的地图（使用 cloudmade），但它是用于查看的，不提供详细信息。在这一点上，我已经确定最好的方法是为每个地址提供一个地图链接，以便在设备上打开本机地图应用程序以提供逐个转弯和语音导航。与适用于 iOS 的 Google 地图相比，我使用过（并且个人不喜欢）iOS 上的地图。我希望默认地图应用程序成为我的应用程序中的一个设置，允许用户选择地图或谷歌地图作为他们的默认地图应用程序。

首先，根据我的基本描述，有人对更好的方法有什么建议吗？其次，我的开发人员需要什么才能通过 iOS 上的网络应用程序制作默认地图应用程序 Google 地图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T12:42:12.187

如果您的网络应用程序链接到[http://maps.apple.com](http://maps.apple.com)，那么它将打开 Apple 地图，如果它链接到 comgooglemaps://，那么它将打开 Google 地图（如果安装了 Google 地图应用程序）。

Apple 地图 URL 方案的文档在这里：

[http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/MapLinks.html](http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/MapLinks.html)

谷歌地图的 URL 方案在这里：

[https://developers.google.com/maps/documentation/ios/urlscheme](https://developers.google.com/maps/documentation/ios/urlscheme)

因此，您的网络应用程序中更改使用哪个地图应用程序的设置只需要更改它生成的地图 URL 的格式。

# java - Web 服务可以返回 DefaultListModel 吗？

> ID：14114775
> 
> 赞同：0
> 
> 时间：2013-01-01T22:21:38.203
> 
> 标签：java, web-services

我使用 Netbeans 在 Glassfish 服务器上部署了一个 Java Web 服务。服务从数据库中获取数据并填充 DefaultListModel**客户**。

DefaultListModel**客户**返回程序并用于填充 JList 但是我得到以下错误。Web 服务主包的名称是**bank**。我真的可以从 Web 服务返回 DefaultListModel 吗？有没有办法修复这个错误。

```
incompatible types
found   : bank.DefaultListModel
required: javax.swing.DefaultListModel 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:30:09.637

您有两个恰好具有相同短名称的不同类。这并不意味着它们可以互换。

您的服务层不应依赖于您为 GUI 层选择的技术。当您切换到 web 应用程序以显示服务结果时，DefaultListModel 不会很有用。让它返回一个`List<Customer>`. `DefaultListModel`无论如何，它只不过是一个列表的包装器。

# ghostscript - 调试 ghostscript 错误

> ID：14114777
> 
> 赞同：2
> 
> 时间：2013-01-01T22:21:44.703
> 
> 标签：ghostscript

运行 ghostscript 并转换 pdf 文件时出现以下错误：

```
 GPL Ghostscript 9.05: Unrecoverable error, exit code 255 
```

我如何开始找出问题所在？

**更新：** 这是我的命令：

```
gs -dNOPAUSE -dBATCH -sPAPERSIZE=letter -sDEVICE=pdfwrite -sOutputFile=out.pdf -dPDFFitPage in.pdf 
```

当我使用 png16 而不是 pdfwrite 运行它时，一切顺利。我假设问题出在设备上，但仍然不知道如何解决。这里的目标是强制文档为字母大小的尺寸。

文件链接： http: [//temp-share.com/show/FHKdql0i6/672b9ff65ff286352936d4e9975389bb](http://temp-share.com/show/FHKdql0i6/672b9ff65ff286352936d4e9975389bb)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T08:46:53.827

这是整个输出，还是还有更多？这不是 PostScript 错误，因此错误代码“可能”是来自操作系统的系统错误代码。

可能的原因可能是创建输出文件或读取输入文件的权限无效。注意 pdfwrite 设备（与 png16m 设备不同）需要写入临时文件，它使用特定于操作系统的方法来处理临时文件。如果它不能写入会导致错误的临时文件。如果您以 root 身份运行该进程会发生什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T09:52:11.420

好的，我已经调试过了，它基本上是 Ghostscript pdfwrite 设备中的一个限制。它只允许对象最多有 10 个嵌套级别（声明了一个固定大小的堆栈），并且此 Cairo 文件中相当疯狂的嵌套级别打破了该限制。

将堆栈大小增加一个明显的“快速破解”确实解决了问题，但显然这不是一个长期的解决方案，不能保证其他一些疯狂的文件不会嵌套超过这个级别。

我建议您在[http://bugs.ghostscript.com](http://bugs.ghostscript.com)打开一个错误报告，将该组件标记为 PDF Writer，这将使我成为受让人。正确解决此问题将花费比我目前可用的时间更多的时间。

如果您现在想解决这个问题，并且不介意重建 Ghostscript，请在​​ ghostpdl/gs/base/gdevpdfx.h 中的第 751 行更改：

pdf_viewer_state vgstack[11]；

至：

pdf_viewer_state vgstack[12]；

# android - 在复制数据库时显示 toast

> ID：14114787
> 
> 赞同：0
> 
> 时间：2013-01-01T22:22:39.187
> 
> 标签：android, database, multithreading, sqlite

在我的应用程序的第一次运行中，我必须将数据库文件复制到数据文件夹。大约需要 10 秒，在这段时间内，用户会看到黑屏。我想使用 AsynTask 技术向用户展示 Toast。

使用此代码，我调用复制数据库类，也调用 AsynTsk 进程...

```
new asyn().execute();
    try {
        myDbHelper.createDataBase();
    }catch (IOException ioe){
        // throw new Error("Unable to create database");
    } 
```

这是我的 AsynTask 代码：

```
 public class asyn extends AsyncTask<Void, Void, Void> {

    @Override
    protected Void doInBackground(Void... params) {
        return null;
    }

     protected void onPreExecute(Void parmas2) {
         Context cntx = getApplicationContext();
         Toast toast = Toast.makeText(cntx, "aaaaaaaaaaa",Toast.LENGTH_SHORT);
         toast.show();
     }

     protected void onPostExecute(Void parmas3) {

     }

 } 
```

我的错在哪里？我该如何解决？我想在数据库复制过程中举杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:24:22.460

如果我理解那`createDataBase`是需要 10 秒的部分，

你应该搬家

```
try {
    myDbHelper.createDataBase();
} catch (IOException ioe) {
    // throw new Error("Unable to create database");
} 
```

进入`doInBackground`AsyncTask 的方法。

AsyncTask 通过调用`doInBackground`单独的线程来工作，但`onPreExecute`在 Ui 线程上调用其他方法（等）。如果你想显示一个 toast 而不是在创建数据库时阻塞 Ui 线程，你需要把繁重的工作放到`doInBackground`.

# javascript - 我希望我的登录弹出窗口不显示底部的滚动条

> ID：14114788
> 
> 赞同：1
> 
> 时间：2013-01-01T22:22:42.353
> 
> 标签：javascript, html, login, popup, scroll

所以我的代码是这样的：

```
<head>
<script type="text/javascript">
<!--
function myPopup2() {
window.open( "http://aunabzzzolution.weebly.com/log-in.html", "myWindow", 
"status = 0, height = 185, width = 300, resizable = 1" )
}
//-->
</script>
</head>
<body>
<form>
<input type="button" onClick="myPopup2()" value="  Log In  ">
</form>
</body>​ 
```

这是一个[例子](http://jsfiddle.net/WGymw/)

而且我不希望滚动条出现在弹出窗口中。如何？？

另外，如果您想查看实时示例，请转到[此处](http://aunabzzzolution.weebly.com/)（左上角）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:30:08.680

如果您可以访问弹出窗口的 HTML/CSS 代码，您可以简单地添加`overflow: hidden`到它的主体样式。

# python-sphinx - 如何将 Sphinx/reStructuredText 链接紧凑地格式化为代码？

> ID：14114790
> 
> 赞同：3
> 
> 时间：2013-01-01T22:23:04.830
> 
> 标签：python-sphinx, markup

我正在生成 Sphinx 文档，并且理想情况下希望我的文档字符串在代码中尽可能具有可读性，因此我希望将[reStructuredText](http://docutils.sourceforge.net/docs/user/rst/quickref.html#hyperlink-targets)保持在最低限度，同时尽可能多地直接从文档字符串生成我的 Sphinx 文档。

特别是，我希望能够在可能的情况下将 URL 保留在我的文档字符串之外，将它们放在不太干扰的地方，并在适当的情况下将链接文本格式化为代码。但目前尚不清楚如何做所有这些事情。例如，

```
Sadly, `git`_, though it works as a link, does not format `git` as code, 
while ``git``_ generates an error; and `git <http://git-scm.com>`_ 
again does not format `git` while ``git` <http://git-scm.com>`_ is 
again an error.
.. _`git`:  http://git-scm.com 
```

是否有我可以使用的扩展、设置或其他标记，以便像这样紧凑的东西

```
`git`_ 
```

或类似的替代品

```
:git: 
```

生成一个代码格式的链接？

# c# - OOP 约定 - 单函数方法

> ID：14114791
> 
> 赞同：1
> 
> 时间：2013-01-01T22:23:10.180
> 
> 标签：c#, oop

在 OOP 和所有编程中，我知道一个明确的规则是一个方法应该只执行一个特定的任务，如果需要执行另一个任务，那么应该创建另一个方法。我的问题是这在我的情况下似乎毫无意义，因为它只是使用更多代码而不是 1 大方法。

这是我的代码可以构造的两种方式（一种遵循标准约定，另一种不保存代码）

场景 1（2 种方法）

增加统计方法

```
public void increaseStat(short value, string stat)
{
       switch (stat)
       {
           case "stamina":
               if (staminaCheck.Checked == true)
               {
                   stamina += value;
                   staminaText.Text = Convert.ToString(stamina);
               }
               staminaCheck.Checked = false;
               break;

//There are 5 other similar cases for different stats but to save time I removed them
       } 
```

和递减统计方法

```
public void decreaseStat(short value, string stat)
{
       switch (stat)
       {
           case "stamina":
               if (staminaCheck.Checked == true)
               {
                   stamina -= value;
                   staminaText.Text = Convert.ToString(stamina);
               }
               staminaCheck.Checked = false;
               break;

//There are 5 other similar cases for different stats but to save time I removed them
       } 
```

如您所见，除了 1 个操作是 + 而不是 - 之外，代码完全相同。因此，为了惯例，我决定这样做，而不是将所有代码复制到另一种方法中

场景2（一种处理增加和减少的大方法）

```
public void alterStat(short value, string stat, bool operator)
{
       switch (stat)
       {
           case "stamina":
               if (staminaCheck.Checked == true)
               { 
                   if (Operator == true) stamina -= value;
                   else stamina += value

                   staminaText.Text = Convert.ToString(stamina);
               }
               staminaCheck.Checked = false;
               break;

//There are 5 other similar cases but to save time I removed them
       } 
```

这样，我通过添加一个简单的 if 语句在每个案例中添加 2 行额外的行，但节省了大量正在复制的代码。

我只是希望您对这是否被视为良好的编程实践提出意见。

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:27:05.850

可以执行以下操作：

```
public void Change(string stat, bool decrease)
{
       switch (stat)
       {
           case "stamina":
               if (staminaCheck.Checked == true)
               {
                   if(decrease)
                      stamina -= value;
                   else
                      stamina += value;
                   staminaText.Text = Convert.ToString(stamina);
               }
               staminaCheck.Checked = false;
               break;

//There are 5 other similar cases for different stats but to save time I removed them
       }
} 
```

因此，创建一个收费的方法来*减少*或*增加*传递的值。它的作用是基于`bool`参数。

这将是您在第二种情况下所做的可能的“形状”之一，但解决方案略有不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-02T02:42:55.060

在我看来，减少重复代码的好处显然远远超过关注点分离的规则，尤其是在代码维护方面。

类似的场景是使用一个`Enum`作为对象的状态标志。正确的 OOP 方法是将每个状态建模为状态层次结构中的单独类。后者的缺点是您必须编写代码来找出对象的状态，特别是如果您使用访问者模式（在使用 OOP 时应该这样做）。

如果涉及到类的接口，您提到的规则特别有用。如果（对于您的类的用户）更清楚的是拥有`IncreaseStat()`和`DecreaseStat()`操​​作，而不是拥有一个 general `ChangeStat()`，那么没有人会阻止您实现一个`private ChangeStat()`方法，该方法由相应的`public`方法调用以增加和减少统计信息。这样您就可以同时获得两个优势：针对特定任务进行特定操作，而在内部没有重复代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T19:46:32.337

最佳解决方案是，如果您可以保留两个世界的好东西，因为您需要它们两个。问题是您将公开的公共接口和内部实现（OOP 中的基本概念之一）分开。你怎么做呢？

您仍然可以拥有这两种方法，增加和减少方式，然后将公共代码重构为私有方法，每个增加和减少方法都使用适当的标志调用该方法。

```
public void increaseStat(short value, string stat){
    alterStat(value, stat, true);
}

public void decreaseStat(short value, string stat){
    alterStat(value, stat, false);
}

private void alterStat(short value, string stat, bool operator){
    // do the actual work here.
} 
```

在设计类时，这是一个非常重要的模式。同样，这个想法是将您作为类接口公开的内容与您真正实现它的方式分开。每个人都应该为自己的目的服务，并且两者都可以一起工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-01T22:37:44.723

由于 C# 具有 lambda，因此这些解决方案都不是理想的。相反，我会尝试将操作作为函数传递：

```
public void modStat(string stat, Func<short, short> op)
{
   switch (stat)
   {
       case "stamina":
           if (staminaCheck.Checked == true)
           { 
               stamina = op(stamina)

               staminaText.Text = Convert.ToString(stamina);
           }
           staminaCheck.Checked = false;
           break;

      // more cases
   } 
```

这也比以前更普遍。理想情况下，我们也可以以相同的方式抽象属性，但这要困难得多（它需要一种称为*lens*的东西，而 C# 对 lens 没有太多支持）。

# iphone - 字典数组/如何更新特定键和索引的值？

> ID：14114794
> 
> 赞同：0
> 
> 时间：2013-01-01T22:23:58.343
> 
> 标签：iphone, ios

我有一个字典数组，它保存在应用程序的文档目录中如何更新特定键和索引的值？例如：我想更新第二个字典人的名字

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<array>
      <dict>
            <key>personName</key>
            <string>John Sculey</string>
            <key>isPersonAdult</key>
            <true/>
            <key>personID</key>
            <integer>12541</integer>
            <key>personPicture</key>
            <string>john.jpg</string>
            <key>personDesignation</key>
            <string>Branding Manager</string>
            <key>personDepartment</key>
            <integer>2</integer>
            <key>personEmail</key>
            <string>john@johnsculey.com</string>
    </dict>
    <dict>
           <key>personName</key>
            <string>Chris Seattle</string>
            <key>isPersonAdult</key>
            <true/>
            <key>personID</key>
            <integer>89854</integer>
            <key>personPicture</key>
            <string>chris.jpg</string>
            <key>personDesignation</key>
            <string>Branding Manager</string>
            <key>personDepartment</key>
            <integer>2</integer>
            <key>personEmail</key>
            <string>chris@johnsculey.com</string>
    </dict> 
```

等等....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:52:03.097

所以，**假设你的字典是可变的，**

```
[[array objectAtIndex:1] setObject:@"New Name" forKey:@"personName"]; 
```

（如果不是，请事先创建它的可变副本。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T23:03:49.007

我的 2 美分也是 :D

```
id data = [NSData dataWithContentsOfFile:plistFile];
NSArray *plist = [NSPropertyListSerialization propertyListWithData:data options:NSPropertyListMutableContainersAndLeaves format:nil error:nil];
assert([plist isKindOfClass:[NSArray class]]);

//every element in the array is mutable
NSMutableDictionary *dict = plist[1];
dict[@"key"] = @"value"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T22:42:30.730

不确定，如果我得到你的问题是正确的。但是，如果您要问，如何在数组的特定索引处访问字典，这将是方式：

```
NSMutableDictionary *person = [NSMutableDictionary dictionaryWithDictionary:[array objectAtIndex:1]];
[person setValue:@"Chris Washington" forKey:@"personName"]; 
```

数组持有什么样的对象并不重要；它可以是数字或 - 在你的情况下 - 字典对象。您可以正常访问它们。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-01T22:57:10.057

你可以用几行代码做你想做的事……首先你从数组中得到你想要编辑的字典，然后你改变你的键的值。我还没有测试过这段代码，但它应该可以正常工作！

```
NSURL *documents = [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject];
NSURL *plistUrl = [documents URLByAppendingPathComponent:@"yourPlistName.plist"];
NSArray *plistContents = [NSArray arrayWithContentsOfURL:plistUrl];
NSMutableDictionary *personToEdit = [plistContents objectAtIndex:1];
[personToEdit setValue:@"value you want to set" forKey:@"your key"]; 
```

# ruby-on-rails - 如何在 ActiveRecord 中合并两个字典条目？

> ID：14114796
> 
> 赞同：0
> 
> 时间：2013-01-01T22:24:00.590
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, activerecord

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T13:31:14.377

Entering the following commands in the rails console seemed to work for me:

```
dups = DictionaryEntry.count(:id, :group => :simplified, :having => 'count(id) > 1')
dups.each do |d|
twins = DictionaryEntry.find_all_by_simplified(d[0])
if twins[0].pinyin == twins[1].pinyin
twins[1].definition = twins[1].definition + "/" + twins[0].definition
twins[1].save
twins[0].destroy
end
end 
```

I had to run it a few times.

# php - mysql查询寻找共同好友

> ID：14114801
> 
> 赞同：0
> 
> 时间：2013-01-01T22:24:37.783
> 
> 标签：php, mysql

我正在接管别人的项目，需要制定一个 php mysql 查询来从朋友表中找出共同的朋友。

该表如下所示 - 例如，我的 id 为 1，我正在查看的配置文件的 id 为 5

共同朋友 id 的输出为 3

```
rel 1 | rel 2
--------------
1     |    5
5     |    1
3     |    5
5     |    3
1     |    3
3     |    1 
```

id 看起来像他们已经进去了两次（两种方式）

无法理解所需的查询

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:32:27.510

看起来关系是双向的。也许这是一个错误，或者这个系统可以选择与某人成为朋友，而不是他们成为你的朋友。

假设后者，您只需要查看其中一列，因此您的查询可能如下所示：

```
select
  rel2
from
  YourTable
where
  rel1 in (1, 5)
group by
  rel2
having
  count(*) > 1 
```

计数显然是为了只选择那些在集合中拥有多个朋友的朋友 (1, 5)。假设是 rel1 和 rel2 的组合是唯一的。

如果数据确实不正确，您可以通过对该表的两个查询使用联合来“解决”该问题，以选择所有组合。但是请注意，如果是这种情况，您最好修复数据，因为如您所见，如果您的查询需要修复您的数据，它们很快就会变得不可读（当然也更慢）。

```
select
  rel2
from
  (select distinct
    rel1, rel2
    from
      (select
        rel1, rel2
      from
        YourTable
      union all
      select
        rel2, rel1
      from
        YourTable) x ) y
where
  rel1 in (1, 5)
group by
  rel2
having
  count(*) > 1 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-01T22:38:26.990

用于测试的[SQL Fiddle](http://www.sqlfiddle.com/#!2/e3043/16/0)

```
select f.friend
from (select rel1, rel2 as friend
      from friends
      where rel1 in (1, 5)
      union
      select rel2, rel1
      from friends
      where rel2 in (1, 5)) f
group by f.friend
having count(*) > 1 
```

# jquery - jQuery Mobile 导航栏：获取活动选项卡

> ID：14114804
> 
> 赞同：1
> 
> 时间：2013-01-01T22:25:04.577
> 
> 标签：jquery, jquery-mobile

我有一个带有两个选项卡的 jQuery Mobile 导航栏：

```
<div data-role="navbar">
  <ul>
    <li><a href="#" class="tab ui-btn-active">Inbound</a></li>
    <li><a href="#" class="tab">Outbound</a></li>
  </ul>
</div> 
```

单击选项卡时，我想

*   如果它已经是活动选项卡，则什么也不做，
*   如果单击的选项卡成为新的活动选项卡，请执行某些操作。

根据[文档](http://jquerymobile.com/demos/1.2.0/docs/toolbars/docs-navbar.html)，活动选项卡有 class `ui-btn-active`，所以我监听点击并查看点击按钮上是否存在该类：

```
$('.tab').click(function() {

  if ( $(this).hasClass('ui-btn-active') ) {
    // already active, do nothing
    console.log("already active");
  } else {
    // newly active, do something
    console.log("newly active");
  }
}); 
```

这已经完美地工作了几个月，但我现在看到它完全取决于活动类从一个中删除并添加到另一个的时间，相对于`if`评估的时间。现在，在一些不相关的代码更改之后，它在桌面浏览器上和以前一样工作，但在移动浏览器上，我只是*已经 active*，无论单击哪个按钮 - 即`if`发生得太晚了。

最聪明的方法是什么？有人可以解释事件的顺序，以及事件的顺序不一致是如何发生的吗？是否`click`适合用于触摸屏设备？

**编辑：**

我尝试使用`.on()`并检查事件对象来侦听父级上的冒泡事件，希望它包含的类列表会更准确，但行为是相同的：

```
$('ul').on('click','a',function(event) {
  alert(event.currentTarget.classList.contains('ui-btn-active'));
}); 
```

如希望的那样，单击非活动选项卡会`false`在桌面浏览器和`true`移动浏览器上返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T08:20:12.133

恕我直言`click`，非常适合此目的，您可以简单地使用变量来跟踪活动选项卡。这是[jsFiddle](http://jsfiddle.net/pmatseykanets/j9WfD/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T19:02:44.290

我有同样的问题，我是这样解决的：

```
$("#myselector").on('click','a',function(event) {

   $("#myselector").find('a').each(function(i) { 
     $(this).removeClass('ui-btn-active');
   });
   $(this).addClass('ui-btn-active');

   //  call to my function

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-07T05:18:13.800

点击有 300 毫秒的延迟。尝试使用“点击”而不是“点击”

# java - 多次连接到一个套接字

> ID：14114812
> 
> 赞同：1
> 
> 时间：2013-01-01T22:26:09.397
> 
> 标签：java, sockets, serversocket, reconnect

好的，所以当我第一次连接时，一切正常。但是当我再次连接时（不停止服务器程序）它说“连接被拒绝：连接”。我以为是因为我只接受一次连接，所以我使用摇摆定时器每 10 毫秒触发一次动作事件，每次动作事件触发时都会将 clientSocket 设置为 serverSocket.accept() (clientSocket = serverSocket.accept( );) 所以这里是代码：

```
package org.code;

import java.net.*;
import java.io.*;

public class MainClass {
    public static void main(String[] args) {
            new MainClass();
    }

    Socket server = null;
    PrintWriter out = null;

    public MainClass() {
            try {
                    server = new Socket("192.168.0.104", 4444);
                    out = new PrintWriter(server.getOutputStream(), true);

                    out.println("start");

                    out.close();
                    server.close();
            } catch(Exception ex) {ex.printStackTrace();}
    }
} 
```

和：

```
package org.code;

import java.io.*;
import java.net.*;
import javax.swing.*;

public class MainClass {
    public static void main(String[] args) {
            new MainClass();
    }

    ServerSocket serverSocket = null;

    Socket clientSocket = null;

    BufferedReader in;

    public MainClass() {
            JFrame frame = new JFrame("Minecraft Server Manager v0.1 Server");
            frame.setSize(500,500);
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            frame.setVisible(true);

            try {
                    serverSocket = new ServerSocket(4444);

                    clientSocket = serverSocket.accept();

                    in = new BufferedReader(new            InputStreamReader(clientSocket.getInputStream()));

                    String inputLine;

                    while((inputLine = in.readLine()) != null) {
                            System.out.println(inputLine);
                            if(inputLine.equals("start")) {
                                    System.out.println("Good");
                            }
                            if(inputLine.equals("stop")) {
                                    System.out.println("Bad");
                            }
                    }

                    clientSocket.close();
                    serverSocket.close();
            } catch(Exception ex) {System.err.println("Error: " + ex.getMessage());}
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:33:31.930

是的，当前实现的问题在于它只等待第一个客户端，然后服务器停止。检查[写入套接字的服务器端，](http://docs.oracle.com/javase/tutorial/networking/sockets/clientServer.html)尤其是最后一个条目“支持多个客户端”。通常支持多个客户端的模式如下：

```
while (true) {
    accept a connection;
    create a thread to deal with the client;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:41:53.140

您的代码会在每次请求后关闭 ServerSocket（并且也会停止）。

这更有可能起作用。（我没有测试过，但是有了这个你就得到了场景）

```
// in your main 
serverSocket = new ServerSocket(4444);

try {
    while (true) { 
        clientSocket = serverSocket.accept();

        Thread t = new ClientSocketThread(clientSocket);
        t.start();
    }
} finally {
    serverSocket.close();
}

class ClientSocketThread extends Thread {
    final Socket clientSocket;

    ClientSocketThread(Socket clientSocket) {
        this.clientSocket = clientSocket;
    }

    public void run() {
        InputStream in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
        try
            String inputLine;

            while((inputLine = in.readLine()) != null) {
                System.out.println(inputLine);
                if(inputLine.equals("start")) {
                     System.out.println("Good");
                }
                if(inputLine.equals("stop")) {
                     System.out.println("Bad");
                }
            }
         } finally {
            in.close()
            clientSocket.close();
         }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T22:35:05.003

您的服务器程序（顺便说一句，与客户端程序具有完全相同的类名，这不是很明智），只接受一个连接。

一旦它完成了与第一个客户的对话，它就结束了。您认为它仍在侦听，因为框架仍然可见，但主要方法已结束。

如果要接受多个连续连接，则应该有一个循环。如果你想要多个并行连接，你应该产生线程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T00:33:41.560

```
clientSocket.close();
serverSocket.close(); 
```

问题就在这里。此时关闭服务器套接字是没有意义的，因为您已经完成了一个客户端。

# sql - 在 WHERE 字段中使用 CASE

> ID：14114815
> 
> 赞同：3
> 
> 时间：2013-01-01T22:26:53.277
> 
> 标签：sql, case, where

以下不是执行此操作的“正确方法”，而是我要实现的目标的演示：

```
SELECT
   [...]
FROM
   [...]
WHERE condition1 
  AND condition2 
  AND field IN CASE (@type)
                 WHEN 1 THEN (SELECT subquery #1)
                 WHEN 2 THEN (SELECT subquery #2)
                 WHEN 3 THEN (SELECT subquery #3)
               END 
```

意思是，我想要对每个不同的参数值有一个不同的子查询`@type`。什么是这样做的好方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-01T22:31:37.953

尝试这个

```
SELECT
   [...]
FROM
   [...]
WHERE
   condition1 AND condition2 AND 
   ((@type = 1 and field IN (SELECT subquery #1))
    OR (@type = 2 and field IN (SELECT subquery #2))
    OR (@type = 3 and field IN (SELECT subquery #3))
   ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:40:52.773

好主意，但是您必须像这样拆分测试：

尝试这个：

```
SELECT
   [...]
FROM
  [...]
WHERE condition1 
  AND condition2 
  AND CASE (@type)
        WHEN 1 THEN (field in (SELECT subquery #1))
        WHEN 2 THEN (field in (SELECT subquery #2))
        WHEN 3 THEN (field in (SELECT subquery #3))
    END 
```

我以前从未尝试过这种语法，所以如果它不起作用，请使用 rs 的答案，这将起作用（我以前使用过他的语法类型）。我希望这确实有效，因为它看起来更优雅 - 你能告诉我它是否有效吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T22:50:27.453

很难说出您要做什么，但是考虑到提供的示例，三个“子查询”中的每一个都返回一些值，该值与`IN`子句中的其他值进行比较。我会使用以下方法进行调查`INNER JOIN`：

```
SELECT
   [...]
FROM
   [...]

INNER JOIN (
   SELECT CASE WHEN @type = 1 THEN somefield
               WHEN @type = 2 THEN somefield
               WHEN @type = 3 THEN somefield
               END AS inner_field
   FROM [....]
   ) XTRA
ON XTRA.inner_field=field

WHERE
   condition1 AND condition2 
```

当然，这只是一个例子；您需要一个与您的数据匹配的版本。您是否真的需要三个单独的子查询很大程度上取决于它们在做什么。关键是使用 a `JOIN`，大多数数据库都能很好地处理它。

# asp.net - iis express 挂起

> ID：14114819
> 
> 赞同：3
> 
> 时间：2013-01-01T22:27:24.587
> 
> 标签：asp.net, iis-express

我在 XP Pro SP3 上使用带有 SP1 的 VS2010 Express。我在本地驱动器上有一个 Web 开发站点，几天前在 IIS Express 下运行良好。现在，当我在 IIS Express 下启动时，IIS Express 的 CPU 使用率上升到 50% 并且不会下降，最终将机器冻结至少几分钟（此时我会硬重启 PC）。该站点在 VS Development Server (Cassini) 下运行良好。在 IIS Express 下，页面调用是

```
http://localhost:4306/mypage 
```

此类事件的 TraceError 在这里：

```
https://www.yousendit.com/download/UW13UGhTSWVwaFRvS3NUQw 
```

我最近做了两个可能会影响事情的更改。1) 我为操作测试制作了该站点的副本，并让它在 IIS 5.1 下运行。然后我将 IIS 5.1 指向开发站点，让它运行；工作正常。2）我重命名了开发站点所在的文件夹，然后在开始页面不知道如何让VS2010 Express识别它；但我过去了。

我尝试卸载 IIS Express 并重新安装，没有任何乐趣。

我尝试查看 IISExpress 文件夹配置文件 xml，但是我找不到文档来告诉我可以用它们做什么。

我在不同的文件夹中使用 V2010 Express 构建了一个全新的准系统站点并得到了结果。

我需要 IIS Express，因为我有大量的 javascript，并且真的不想回到 Cassini 进行 JS 调试。

任何有关如何让 IIS Express 在我的开发站点上备份和正常运行的建议都将不胜感激。

谢谢！

更新

有人指出，上面的日志文件有一个“尝试附加一个自动命名的数据库”错误，所以我修改了 web.config，我可能已经消除了它，但我不能确定，因为我不能获取另一个带有“挂起”的 TraceLog；系统显然在生成 TraceLog 之前挂起。

然后我在下面进行了更多测试，其中我更改了站点起始页。这最初生成了一个“无法显示页面”错误而不是挂起，所以我认为该错误可能更特定于页面。但随后它在两个目标页面上都产生了挂起错误，因此“无法显示页面”与挂起不一致。

> 更改了 web.config 中的连接字符串 => 它有两个用于 CTLS.mdb，a) 一个带有文件夹路径，b) 另一个带有 [DataDirectory]；删除 b）在 VS 开发服务器下运行 => 工作已关闭 VS2010 Express 重新启动 VS2010 Express Ran 调试 IIS Express 下的站点 => 而不是挂起，给出“IE 无法显示页面”重复调试 IIS Express 下的站点 => 再次，“不能显示页面"
> 在VS2010 Express中，将起始页改为“SiteEntrance.aspx”，在IIS Express下重复Debug => IIS Express挂起 Rebooted PC Restarted VS2010，将起始页改为“zTestLaunch.aspx”，在IIS Express下运行Debug =>“IE无法显示页面”在VS2010 Express中，将起始页面改为“SiteEntrance.aspx”，在IIS Express下重复调试=>“IE无法显示页面”停止调试，重新启动调试=>无法显示页面停止调试，重新启动调试=>无法显示页面关闭VS2010 Express，注意到它指向IIS Express，重新启动调试=>无法显示页面（页面= SiteEntrance.aspx）重新启动VS2010，将起始页面更改为“zTestLaunch.aspx”，在IIS Express下运行调试=> IIS Express挂起

这是来自“无法显示页面”事件之一的 TraceLog

```
https://www.yousendit.com/download/UW16aXRJNHY4Q1RvS3NUQw 
```

更新：

好吧，这个问题显然很奇怪，以至于在四个论坛和一项付费服务​​中没有人听说过它。下一站 Microsoft 支持 259 美元。除了 - 愚蠢的我，我发现不需要 IIS Express 来调试 VS Studio Express 中的 javascript（（我以为我做到了 - 一些误解可能会将 IIS Express 与你需要的 IE 混淆）所以，作为我的驱动程序，我不需要再为此工作了。

菲尼托！感谢读到这里的任何人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:23:38.350

这个问题显然很奇怪，以至于在四个论坛和一个付费服务中没有人听说过。下一站 Microsoft 支持 259 美元。除了 - 愚蠢的我，我发现不需要 IIS Express 来调试 VS Studio Express 中的 javascript（（我以为我做到了 - 一些误解可能会将 IIS Express 与你需要的 IE 混淆）所以，作为我的驱动程序，我不需要再为此工作了。

# wpf - 如何连接位于 ViewModel 中的撤消命令以由 Ctrl-Z 调用？

> ID：14114820
> 
> 赞同：3
> 
> 时间：2013-01-01T22:27:25.463
> 
> 标签：wpf, mvvm, .net-4.0, command, wpf-4.0

我实现了自己的撤消/重做功能（在网络上有很多帮助），这很有启发性。Undo 和 Redo 命令在 ViewModel 中定义。我可以通过`Command`a 的属性来连接这些命令`MenuItem`。作为最后一步，我想通过标准的 CTRL-Z 和 CTRL-Y 键盘快捷键连接这些命令。

令我沮丧的是，我发现`MenuItem`班级不支持这一点。使用 WinForms 这将是一件轻而易举的事，但似乎在 WPF 中实现这一点非常复杂。怎么做最容易？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:41:19.253

这个问题实际上是这个问题的重复问题[：](https://stackoverflow.com/questions/2382916/binding-a-wpf-shortcut-key-to-a-command-in-the-viewmodel) *但是*：从 WPF 4.0 开始，Michel Keijzer 的答案是正确的，非常简单！我会把它放在这里（在问题结束之前:-)）

```
<Window.InputBindings>
    <KeyBinding Command="{Binding Path=UndoCommand}" 
      Key="Z" Modifiers="Control"></KeyBinding>
</Window.InputBindings> 
```

在 Window.Resources 之后添加这个

# hadoop - 如何在多个节点上设置 Hive？

> ID：14114825
> 
> 赞同：-1
> 
> 时间：2013-01-01T22:28:33.693
> 
> 标签：hadoop, mapreduce, hbase, hive

我已经在 hbase 和 hadoop 上为单个 master 和单个节点设置了 hive，它与 mapreduce 作业完美配合，但是当我为单个 master 和多个节点设置 hive 时出现问题

谁能帮助我如何设置多个 hbase 节点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T08:26:27.003

尝试以下步骤：http: [//hadoop.apache.org/docs/r1.0.4/cluster_setup.html](http://hadoop.apache.org/docs/r1.0.4/cluster_setup.html)

# javascript - 使用 grep 或类似工具查找对 Dojo 和 Mootools 的调用

> ID：14114829
> 
> 赞同：1
> 
> 时间：2013-01-01T22:29:00.507
> 
> 标签：javascript, jquery, dojo, mootools

我继承了一个使用 Dojo、Mootools 和 JQuery 的项目，并在几乎每个页面上加载所有三个库。由于这是一个 Drupal 项目，它使用 JQuery 作为默认库，我想保留 JQuery 并尽可能将 Dojo 和 Mootools 部分转换为 JQuery。我相信它正在使用以下版本（请参阅我对 Christophe 的评论回复）

*   jQuery 1.5.1
*   Mootools 1.2.5。
*   道场 1.6.1

现在我只是想确定 Mootools 和 Dojo 的使用位置。理想情况下，我想找到一个正则表达式

*   对 Mootools 或 Dojo 的调用进行命中，但对 JQuery 没有命中（或在某种程度上过滤它们）
*   误报方面的错误

就像快速检查一样，我使用这个正则表达式进行了搜索：`(\$\(|[Mm]ootool|[Dd]ojo)`

当然，这捕获了对 JQuery 的大多数调用，但只是为了了解我必须查看多少个文件。我在 258 个文件中有 5913 个匹配项

如果我只搜索，`\$\(`我会在 221 个文件中得到 4081 个匹配项。这些可能绝大多数是 JQuery，但只是想找到一种缩小我必须查看的实例数量的好方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T02:28:40.030

你会更容易删除这些库的包含并使用 chrome/firefox 逐页检查错误，而不是开发一些东西来查找对 MooTools 的调用。

另一种方法。修改 Mootools/Dojo 库以记录每次使用它们的时间，以及它们的使用对象/位置。对服务器的简单 ajax 调用就足够了。

# php - PHP-cookie 不保存

> ID：14114832
> 
> 赞同：3
> 
> 时间：2013-01-01T22:29:41.540
> 
> 标签：php, session, cookies

我目前正在使用会话和 cookie 实现一些东西，但 cookie 没有存储在我的计算机上。因此无法检索会话。

```
session_start();        // returns true
var_dump($_SESSION);    // array(0) {}
var_dump($_COOKIE);     // array(0) {}
$_SESSION['test'] = 5;
setcookie('aaa', '111', strtotime('+30 days'));
die; 
```

重新加载页面应该显示非空数组。但它们总是空的。Firebug 的 cookie 选项卡上也没有显示 cookie。我在同一台服务器上使用另一个域，可以很好地处理会话。

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-01T22:41:27.803

在调用任何使用标头的函数之前，请确保没有任何输出。所以试试这个：

```
<?php
session_start();
$_SESSION['test'] = 5;
setcookie('aaa', '111', strtotime('+30 days'));
var_dump($_SESSION);
var_dump($_COOKIE);
?> 
```

# r - 奇怪的 all.moments() 结果

> ID：14114836
> 
> 赞同：0
> 
> 时间：2013-01-01T22:30:22.127
> 
> 标签：r, statistics

我想跟进一个关于包中的`all.moments`函数的问题`moments`：[all.moments 函数奇怪的结果](https://stackoverflow.com/questions/9828774/all-moments-function-weird-outcome)

all.moments 输出的分布 - 特别是渐近方差 - 似乎与第 3 和第 4 时刻的标准理论不一致，或者我做错了什么。

考虑以下代码：

```
reps <- 100000                              # number of repetitions
n <- 1000000                                # sample size
asy.cmtx <- matrix(0,nrow=reps,ncol=5)      # initialize our matrix of conventional moments
for(i in 1:reps){
vec <- rnorm(n,mean=0,sd=1)               # create vector of 1M standard normals
asy.cmtx[i,] <- all.moments(vec,order.max=5)[2:6]    # get sample moments 
}
mean(asy.cmtx[,3])             # this should be 0
# [1] 3.972406e-06
mean(asy.cmtx[,4])            # this should be 3
# [1] 2.999996
var(sqrt(n)*asy.cmtx[,3]/(asy.cmtx[,2]^(3/2)))     # this should be 6
# [1] 14.41766
var(sqrt(n)*(asy.cmtx[,4]-3)/(asy.cmtx[,2]^(2))) # this should be 24
# [1] 96.25745 
```

渐近方差似乎比预期的要大。

我回去简单地使用了我们都知道的示例矩公式并得到了正确的结果：

```
reps <- 100000                              # number of repetitions
n <- 1000000                                # sample size
asy.34.2 <- matrix(0,nrow=reps,ncol=2)      # initialize our matrix of conventional moments
for(i in 1:reps){
y <- rnorm(n,mean=0,sd=1)               # create vector of 1M standard normals
y.bar <- mean(y)
m2 <- ((1/n)*sum((y-y.bar)^2))
asy.34.2[i,1] <- ((1/n)*sum((y-y.bar)^3))/(m2^(3/2))
asy.34.2[i,2] <- ((1/n)*sum((y-y.bar)^4))/(m2^2)
}

mean(asy.34.2[,1])
# [1] 7.512593e-06
mean(asy.34.2[,2])
# [1] 2.999985
var(sqrt(1000000)*asy.34.2[,1])     # this should be 6
# [1] 5.990771
var(sqrt(1000000)*(asy.34.2[,2]-3)) # this should be 24
# [1] 24.23367 
```

所以实际的公式有我们期望的方差，但 all.moments 没有，即使它有正确的期望。由于样本大小或迭代次数，这应该不是问题，因为在这种情况下两者都很大（两种情况下分别为 1M 和 100k）。以前有人遇到过这个问题吗？

另外，有没有人对 R 简单地丢弃你的输出有问题？当我试图操纵上面的输出时，输出以某种方式“消失”了，dim = NULL。但是，如果我做的第一件事是 write.csv() 数据，那么我可以将其读回并进行操作，而不会消失在我身上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T06:29:31.757

有两个错误：（1）正如弗洛德尔指出的那样，您需要中心矩而不是原始矩，这对矩的点估计没有太大区别，但对它们的方差估计确实有影响；(2) 使用 all.moments 计算峰度时存在错误。当我们应用这些更正时，我们有：

```
reps <- 1000                              
n <- 100000 
```

...

```
 asy.cmtx[i,] <- all.moments(vec,order.max=5, central = TRUE)[2:6] 
```

...

```
var(sqrt(n)*asy.cmtx[,3]/(asy.cmtx[,2]^(3/2)))     # this should be 6
# [1] 5.993772
var(sqrt(n)*(asy.cmtx[,4])/(asy.cmtx[,2]^(2)) - 3) # this should be 24
# [1] 23.89204 
```

# windows-phone-7.1 - 正方体 Windows 手机

> ID：14114839
> 
> 赞同：2
> 
> 时间：2013-01-01T22:30:47.880
> 
> 标签：windows-phone-7.1, ocr, tesseract

我一直在四处寻找，但似乎无法找到有关 Windows Phone 上独立 OCR 实施的解决方案。

1) **Tesseract**库是否可以在运行 C# 的 Windows Phone 上运行？

2) 是否有运行在**Tesseract**或任何其他库上运行的**Windows Phone OCR 应用程序，这些库至今****未通过云调用服务**？

 ***** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:38:53.867

仅适用于 Windows Phone 7 的 C#，仅此而已。不过，您可以在 Windows Phone 8 上使用 C++。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-25T08:33:04.620

您可以使用[@yoisel](https://github.com/yoisel/tesseract_winrt)为 WinRT 平台（Windows Phone/Windows 应用商店应用程序）修改的 Tesseract。****

# java - 文档构建器在 java web start 中使用 dtd 解析 xml 的最佳方式

> ID：14114840
> 
> 赞同：1
> 
> 时间：2013-01-01T22:31:19.287
> 
> 标签：java, xml, xml-parsing, dtd, java-web-start

不想为 webstart 使用文件 I/O。所以我使用`builder.parse(xmlurl, base)`并工作。但我试图通过将 dtd 和 xml 放在 jar 文件中来减少流量。这也适用于本地测试和静态 Web 服务器。但是，我想使用使用[http://www.myserver.com/?file=start.jar分发文件的动态 Web 服务器](http://www.myserver.com/?file=start.jar)

现在的问题是当 jar 文件运行时，它试图检索`jar:http://www.myserver.com/?file=start.jar!/Resource/xxx.xml`并且 javaw 抱怨`!/`不在规范中（从 documentbuilder 抱怨）。我认为它只是与 ? 和 & 在用于动态文件访问的 url 中。

让文档构建器检索动态服务 jar 的内部（在同一个 jar 中）xml（以及 xml 中描述的相应 dtd）的最佳方法是什么？请注意，如果我将 this.class.getResourceAsStream() 用于 xml，那么我仍然找不到 dtd 文件。

## 更新

我得到了一个临时解决方案，但还有另一个问题。这个 jar 存储在数据存储中，所以我需要[http://www.myserver.com/?file=start.jar](http://www.myserver.com/?file=start.jar)来访问它。一旦我使用[http://www.myserver.com/start.jar](http://www.myserver.com/start.jar)它就会工作。我只需要我的 servlet 来解析仍然很容易的路径。

我发布的另一个问题与此问题有关：

[使用 GAE servlet 为 JavaWS 提供动态 JNLP 和 jar](https://stackoverflow.com/questions/14108326/use-gae-servlet-to-serve-dynamic-jnlp-and-jar-for-javaws)

# c# - 我如何存储我的方法中的一些特定数据

> ID：14114843
> 
> 赞同：0
> 
> 时间：2013-01-01T22:31:42.253
> 
> 标签：c#, variables, methods, variable-assignment

我的程序有一些方法，其中一些调用了一些其他方法我的问题是我想使用一个方法在以前的方法中生成的一些数据，我不知道我应该怎么做。

```
namespace MyProg
{
   public partial class MyProg: Form
   {
        public static void method1(string text)
        {
           //procedures
           method2("some text");
           // Here i want to use the value from string letter from method2.
        }

        public static void method2(string text)
        {
           //procedures
           string letter = "A";  //Its not A its based on another method.
        }      
   }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:35:00.587

只需使用返回值：

```
public partial class MyProg: Form
{
    public static void method1(string text)
    {
       string letter = method2("some text");
       // Here i want to use the value from string letter from method2.
    }

    public static string method2(string text)
    {
       string letter = "A";  //Its not A its based on another method.
       return letter;
    }      
} 
```

[**方法**](http://msdn.microsoft.com/en-us/library/ms173114%28v=vs.80%29.aspx)

> 方法可以向调用者返回一个值。如果返回类型（方法名称之前列出的类型）不是 void，则该方法可以使用 return 关键字返回值。带有关键字 return 后跟与返回类型匹配的值的语句将将该值返回给方法调用者...

* * *

既然您提到不能使用返回值，另一种选择是使用[`out`参数](http://msdn.microsoft.com/en-us/library/ee332485.aspx)。

```
public static void method1(string text)
{
   string letter;
   method2("some text", out letter);
   // now letter is "A"
}

public static void method2(string text, out string letter)
{
   // ...
   letter = "A";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T22:35:11.417

您可以将值存储在类的成员变量中（在这种情况下必须是静态的，因为引用它的方法是静态的），或者您可以从方法 2 返回值，然后从方法 1 内部您想要调用的方法 2用它。

我会把它留给你来弄清楚如何编码。

# java - 如何在java中将字符串从一个数组转移到另一个数组？

> ID：14114844
> 
> 赞同：0
> 
> 时间：2013-01-01T22:31:48.677
> 
> 标签：java, arrays, string, shift

我有两个数组，一个称为单词，另一个称为数据。我无法将字符串从数据转换为单词。到目前为止我有

```
 public String[] shiftRightX(String[] words, String[] data)
    {

        for(int i= words.length - 1; i>0; i--)
        {
            words[i]=words[i-1];
            for (int x = 0; x < data.length; x++)
            {
                words [0] = data[x];
            }
        }  
        return words;  
    } 
```

例如，它应该导致：

```
 shiftRightX({"1", "2", "3"}, {"1", "2"}) → {"2", "1", "1"}
    shiftRightX({"1", "2", "3"}, {"1"}) → {"1", "1", "2"}
    shiftRightX({"1", "2"}, {"1", "2"}) → {"2", "1"} 
```

但是，它在最后移动了一个额外的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:55:22.180

更快的版本：

```
public String[] shiftRightX(String[] words, String[] data)
{
  if (data.length < words.length)
     System.arraycopy(words, 0, words, data.length, words.length - data.length);
  for (int i = Math.max(0, data.length - words.length); i < data.length; i++)
     words[data.length - i - 1] = data[i];
  return words;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T22:45:12.990

尝试交换循环：

```
public String[] shiftRightX(String[] words, String[] data)
{
    for (int x = 0; x < data.length; x++)
    {
        for(int i= words.length - 1; i>0; i--)
        {
            words[i]=words[i-1];
        } 
        words[0] = data[x];
    } 
    return words;  
} 
```

但是这个算法可以改进。`words`现在它的复杂度是 O(n*m) 但如果将数组中的元素移动到位置而不是 1，它可以提高到 O(n + m) `data.length`。但是在这种情况下你需要更加小心，因为你可以得到`ArrayOutOfBoundException`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T22:48:47.140

我*认为*您正在尝试做的是这样的事情：

```
 public String[] shiftRightX(final String[] words, final String[] data){
        String[] result = new String[words.length];
        int i = 0;
        for(String str : data){
            result[i] = str;
            i++;
        }
        for(int j=0;i<words.length;j++){
            result[i] = words[j];
            i++;
        }
        return result;
    } 
```

# php - 仅在单击按钮时显示输入框

> ID：14114846
> 
> 赞同：-1
> 
> 时间：2013-01-01T22:31:58.547
> 
> 标签：php, javascript, html

我有一个带有许多潜在输入框的表单，但是我只希望在单击前一个输入框旁边的按钮时显示它们。这是我的意思的一个小想法：

```
<form>
  <input name='box1'><input type='submit' name='button1' value='show box 2'>
  <input name='box2'><input type='submit' name='button2' value='show box 3'>
  <input name='box3'><input type='submit' name='button3' value='show box 4'> ....... 
```

等等

这可以用 PHP 完成还是我应该使用 JavaScript 或其他东西？任何建议将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-01T22:34:40.680

我会使用 jQuery 或纯 JavaScript 来做到这一点。JavaScript 是一种客户端语言，非常适合获取点击和事件。PHP 是服务器端，用于页面处理和数据处理。我会将输入包装在 div 中并在点击时隐藏和显示它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:34:11.973

是的，这可以通过 PHP 来完成，但如果你想让它看起来不错，请使用 javascript。

无论如何，php中一个丑陋的伪解决方案：

```
$Step = 1;
if(isset($_POST['step']))
    $Step = $_POST['step'];

switch($Step) {
    case 2:
        echo '<input name="box2">';
        break;
    case 3:
        echo '<input name="box3">';
        break;
    // ...
    default:
        echo '<input name="box1">';
}
echo '<input type="hidden" name="step" value="'.($Step + 1).'">';
echo '<input type="submit" name="submit" value="Next">'; 
```

但是，在 javascript 中它看起来更好并且更容易实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T23:26:23.800

如果你想避免页面重新加载，你需要使用浏览器端的 JavaScript 来显示新的输入框。

如果您需要在新的输入框出现之前由您的服务器端 PHP 脚本处理输入框的文本，您将需要在按钮单击时发出 ajax 请求，以将输入框的数据发送到服务器并获取一个答复。

如果您可以在浏览器端处理输入框的文本，它会变得更简单。

在这两种情况下，您都需要将`submit`按钮的 type 属性替换`button`为获取没有默认行为的按钮。然后，您可以将单击处理程序添加到按钮。使用 jQuery，如果您不想处理文本（将其放在表单之后），这将类似于以下代码段：

```
<script>
$('input[type^="button"]').click(function() {
    var button_number = $(this).attr("name").split("button")[1];
    var box_number = parseInt(button_number) + 1;
    $('input[name="box' + box_number + '"]').show();
});
</script> 
```

对于可见性的初始化，您可以使用以下 CSS：

```
input[name^="box"] {
  display:none;
}
input[name="box1"] {
  display:inline;
} 
```

这是jsfiddle：http: [//jsfiddle.net/SjXH9/27/](http://jsfiddle.net/SjXH9/27/)

您可以将最后一个按钮设置为提交按钮，以提交整个表单。

# ruby-on-rails - update_attributes 在某些情况下不会更新nested_attributes

> ID：14114849
> 
> 赞同：0
> 
> 时间：2013-01-01T22:32:10.700
> 
> 标签：ruby-on-rails, date, update-attributes

我正在用 rails 3.2.8 编写一个小的 CMS 应用程序。段落（基本上包含例如新闻文章的标题、正文和日期）和页面（由许多段落组成，例如许多新闻文章）有一个模型。如果日期更改，以下内容仅更新段落，否则，即使正文更改，该段落也不会更新！？

```
page.update_attributes({"paragraphs_attributes"=>{"0"=>{"_destroy"=>"0", 
             "title"=>"News title", "body"=>"News text", "id"=>"4", 
             "date(3i)"=>"1", "date(2i)"=>"1", "date(1i)"=>"2013"}}}) 
```

下面，您可以找到模型的相关部分：

页面.rb

```
class Page < ActiveRecord::Base
  has_many :paragraphs, :dependent => :destroy
  attr_accessible :name, :paragraphs_attributes
  accepts_nested_attributes_for :paragraphs, :allow_destroy => true
end 
```

段落.rb

```
class Paragraph < ActiveRecord::Base
  belongs_to :page
  attr_accessible :title, :body, :page, :date
  validates :page,  presence: true
end 
```

有人知道这种奇怪行为的原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-13T01:26:30.510

[https://github.com/rails/rails/blob/d32965399ccfa2052a4d52b70db1bae0ca16830b/activerecord/lib/active_record/nested_attributes.rb#L72](https://github.com/rails/rails/blob/d32965399ccfa2052a4d52b70db1bae0ca16830b/activerecord/lib/active_record/nested_attributes.rb#L72)

检查语法

```
 # Now, when you add the <tt>_delete</tt> key to the attributes hash, with a
    # value that evaluates to +true+, you will destroy the associated model:
    #
    #   member.avatar_attributes = { :id => '2', :_delete => '1' }
    #   member.avatar.marked_for_destruction? # => true
    #   member.save
    #   member.avatar #=> nil 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T10:09:46.103

当然也有可能是一个肮脏的解决方法：在最终更新之前插入一个假更新。请注意，这是一种非常糟糕的风格，并且使更新的数据库访问加倍，但由于我找不到其他解决方案，我想出了以下解决方案：

page_controller.rb

```
class PageController < ApplicationController

  def update

    # Hack: Updating paragraphs fails for some strange reasons if their date 
    # did not change. Updating paragraphs with date changes works as expected.
    # To allow updates in all cases, we first make an update to an impossible
    # date and then make an update to the real date.

    # Define a year, that will never occure in the params.
    # This date will be used for the fake update.
    impossible_year = "1999"

    # Setup the fake params for the first fake update (Change the date fields of 
    # all paragraphs to an impossible date).
    fake_params = params[:page].deep_dup
    par_attrs = fake_params[:paragraphs_attributes]
    par_attrs.keys.each do |key|
      par_attrs[key]["date(1i)"] = impossible_year
    end

    # Perform the fake update.
    @page.update_attributes(fake_params)

    # Finally do the real update with the original params.
    @page.update_attributes(params[:page])
  end
end 
```

# git - 使用 GIT 设置登台服务器 Web 工作流

> ID：14114850
> 
> 赞同：0
> 
> 时间：2013-01-01T22:32:13.523
> 
> 标签：git, webserver, staging, nearlyfreespeech

我想建立一个具有以下功能的网页设计和开发工作流程： 可以在我的笔记本电脑和台式机之间同步的本地工作目录。然后，我会将其提交到登台服务器，当我对它感到满意时，将其复制到公共服务器。

我主要是独自工作，但我确实希望非技术知识的客户能够看到登台服务器以获得批准。

我的网络主机将是具有 SSH 登录的 Nearly Free Speech.net (NFSN)。

根据我的研究，实现这一目标的一个好方法似乎是使用 GIT，然后使用 rsync 将最终副本复制到公共服务器。但是我有几个问题，希望人们能指出我正确的方向。

*   所以我在我的两台本地机器上都安装了 GIT，并确保它在登台服务器（这是 NFSN 上的共享 Web 空间实例）上运行。我在公共服务器上也需要它吗？

*   我将我的网站提交到登台服务器，对其进行测试和批准，然后我有点困惑。我是否通过 SSH 连接到公共服务器并从那里运行 rsync？还是我从登台服务器运行它？

*   如果我在登台服务器上运行 GIT，那么将站点放在像 GIThub 这样的服务中是否有任何意义？或者我可以从登台服务器“检查”到我的各种本地机器吗？或者我会更好地使用 GIThub，因为它包含分支之类的东西？

*   与 GIT 无关：.htaccess/.htpasswd 是为一般网站创建登录测试区的最佳方式吗？（这将是登台服务器）

提前感谢您的帮助。

保罗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T23:03:07.370

好吧，这可能会容易得多。

您可以随时推送到您的登台服务器，然后，当您愿意发布您的代码时，您推送到公共服务器。在 git 中，您可以拥有许多遥控器。

```
git remote add <name> <url> 
```

满意后，您可以直接从您正在工作的机器推送到暂存服务器或推送到公共服务器：

```
git push stage master:master
git push public master:master 
```

# node.js - 使用 Mongoose 捕获统一错误

> ID：14114853
> 
> 赞同：2
> 
> 时间：2013-01-01T22:33:22.477
> 
> 标签：node.js, mongodb, mongoose

我正在使用猫鼬。对于每个数据库操作，我都有发布错误的代码（如果有）。例如：

```
User.find({}, function(error, users) {
    if(error) { console.error('ERROR: ', error); } else {
        // Do stuff
    }
}); 
```

有没有办法在单个函数中抽象出以下样板代码：

```
if(error) { console.error('ERROR: ', error); } else { 
```

?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T03:39:34.557

你考虑过这样的事情吗？（写意所以检查语法）

```
function safely(callback) {
  return function(err) {
    if (err) {
      console.error('ERROR: ', err);
      return;
    }
    callback.apply(this, arguments);
  };
}

User.find({}, safely(function(err, users) {
  // Do something
})); 
```

# android - Android 如何提高 ffmpeg mp4 性能？

> ID：14114864
> 
> 赞同：0
> 
> 时间：2013-01-01T22:35:17.040
> 
> 标签：android, c, android-ndk, ffmpeg, decoding

我检测到该功能`avcodec_decode_audio3`在 mp4 格式下运行缓慢，这是我用于解码音频的代码周期：

```
while (av_read_frame(av_format_context, &packet) >= 0 && is_play == 1) {
        if (av_codec_context->codec_type == AVMEDIA_TYPE_AUDIO
                && is_play == 1) {
            int out_size = AVCODEC_MAX_AUDIO_FRAME_SIZE;
            int size = packet.size;
            int n;
            int dataLength = size;
            int decoded = 0;
            while (size > 0) {

                //start measure time
                gettimeofday(&tvBegin, NULL);

                int len = avcodec_decode_audio3(av_codec_context,
                        (int16_t *) pAudioBuffer, &out_size, &packet);

                //stop measure time
                gettimeofday(&tvEnd, NULL);
                timeval_subtract(&tvDiff, &tvEnd, &tvBegin);

                LOGI("%d", tvDiff.tv_usec / 1000);
                LOGI("len='%d'", len);
                LOGI("out_size='%d'", out_size);

                if (len < 0) {
                    break;
                    return 1;
                }
                if (out_size > 0) {

                    jbyte *bytes = (*env)->GetByteArrayElements(env, array,
                            NULL);
                    memcpy(bytes, (int16_t *) pAudioBuffer, out_size);
                    (*env)->ReleaseByteArrayElements(env, array, bytes, 0);
                    (*env)->CallVoidMethod(env, obj, play, array, out_size,
                            is_play);

                }
                size -= len;
            }

        }
        if (packet.data)
            av_free_packet(&packet);

    } 
```

但是对于其他格式，如 flac 和 mp3，它可以正常工作。`avcodec_decode_audio3`用 = 4608 解码 mp3 帧大约需要 1-2 毫秒，`out_size`但在 mp4 解码中使用相同的帧大小大约需要 6-7 毫秒。我从[这里](http://svn.code.sf.net/p/servestream/code/ffmpeg/scripts/arm-build.sh)得到了我的构建脚本。

这是正常行为吗？有什么方法可以提高解码 mp4 的性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T03:55:38.313

你可以搜索硬件加速...

“Android 上的硬件加速 H.264 解码”

例如：

[如何在 Android 上使用硬件加速视频解码？](https://stackoverflow.com/questions/11321825/how-to-use-hardware-accelerated-video-decoding-on-android)

[http://readlist.com/lists/mplayerhq.hu/mplayer-users/5/26751.html](http://readlist.com/lists/mplayerhq.hu/mplayer-users/5/26751.html)

IMO - ffmpeg 仍然主要在软件中，但在较新版本的 android 上，您可能能够找到一些提供 GPU 加速方式来访问帧缓冲区的 stagefright API？

# javascript - ajax 网站内容保护可能吗？

> ID：14114865
> 
> 赞同：2
> 
> 时间：2013-01-01T22:35:35.683
> 
> 标签：javascript, jquery, ajax, html, web

我正在考虑创建一个站点，该站点仅通过与 jquery 的 AJAX 连接从 .txt 文件或类似文件加载站点内容。问题是，如果我这样做，人们（我指的是黑客等等）就不能来改变我的 .txt 文件吗？有什么方法可以保护它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T22:40:12.697

> 问题是，如果我这样做，人们（我的意思是黑客之类的人）就不能来改变我的 .txt 文件吗

除非他们有权访问您的服务器，否则不会。

当然，他们可以从您的服务器读取 .txt 文件，并根据需要处理该内容。但是如果不入侵您的网站，他们就无法让*您的*网站做其他事情。（在这方面，它是 .txt 文件还是普通的 HTML 文件都没有关系。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:41:50.557

如果无法访问您的服务器，坏人就无法更改 .txt 文件（顺便说一句，您使用哪种文件类型并不重要）。因此，请确保您的密码等安全，并且您是安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T22:51:00.553

只要 AJAX 请求有`HTTP_X_REQUESTED_WITH`它（jQuery ajax 请求有这个），那么您可以使用 PHP 将用户从文件中重定向，如下所示：

```
<?php
header('Content-type: text/plain');
if(strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) !== 'xmlhttprequest') { 
   // if not ajax request, then redirect to homepage
   header("Location: /"); 
   exit; 
}
?> 
```

如果它位于文本文件的顶部，那么它将起作用，但您必须请求带有`.php`扩展名的文本文件，而不是`.txt`它仍然是文本文件，因为第一次`header()`调用将其设置为纯文本。

# ruby-on-rails - Rails current_user 控制器检查然后渲染略有不同的视图

> ID：14114870
> 
> 赞同：0
> 
> 时间：2013-01-01T22:35:59.647
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我只是想要最简单的解决方案来检查用户是否是当前用户，并根据答案每次呈现略有不同的视图。

我`/users/:id`为每个用户设置了一条路线，该路线`show`前往`users_controller`

**控制器**

```
 def show    
    @user = User.find(params[:id])
    respond_to do |format|
     format.html #show.html.erb
    end
  end 
```

我想`show.html.erb`在很多地方更改文件。`<% if @user == current_user %>`我每次都可以尝试，但我认为这会造成冗长的代码或许多部分的混乱。

我也可以尝试创建第二个视图，但我不知道我是否在这里有效地工作：

**控制器**

```
 def show    
    @user = User.find(params[:id])
    if @user = current_user
      redirect_to show_is_current_user
    else
      respond_to do |format|
        format.html #show.html.erb
      end
    end
  end

 def show_is_current_user 
   @user = User.find(params[:id])
   respond_to do |format|
     format.html #show_is_current_user.html.erb
   end
 end 
```

还有比上述更有效的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:48:16.030

这将在用户查看其他用户的个人资料时呈现 show.html.erb 并在显示查看自己的个人资料时呈现 showself.html.erb：

```
 def show    
    @user = User.find(params[:id])
    if @user == current_user
        render "showself"
    end
  end 
```

# php - 如果数据库中存在记录，则禁用某些字段

> ID：14114873
> 
> 赞同：-3
> 
> 时间：2013-01-01T22:36:27.873
> 
> 标签：php, jquery, mysql, database

我正在编写一个对帖子进行评分的应用程序，提交表单的前几个字段包含有关帖子的基本信息。现在，第一个字段使用 MySQL 数据库表中的 jQuery UI 自动完成。

我想达到一个点，如果用户选择一个自动完成选项而不是手动输入所有内容，则查询数据库，填写基本信息，并禁用字段（以防止重复条目）。

我对这里的适当方法有点茫然。有什么建议吗？

谢谢，罗伯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:48:26.653

您可以使用`select`事件`autocomplete`触发对服务器的 AJAX 调用。

```
$( ".selector" ).autocomplete({
    select: function( event, ui ) {
        /* data used for autocomplete is contained in ui.item... will assume you have an ID included in data object */

       $.post( url, { id:  ui.item.id), function(response){
          /* do something if needed with response from server*/
       })
   }
}); 
```

在服务器端接收数据，就像接收带有命名字段的表单一样`id`。 `$_POST['id']`

这是非常松散的，因为没有提供太多有问题的细节。

API参考：

[http://api.jqueryui.com/autocomplete/#event-select](http://api.jqueryui.com/autocomplete/#event-select)

[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

# c - 问题调试 c 字符串？

> ID：14114877
> 
> 赞同：2
> 
> 时间：2013-01-01T22:36:45.550
> 
> 标签：c, string, gdb

我有一些 c 代码来连接字符串。

```
char str_cat[strlen(str1) + strlen(str2) + 1]; 
```

如何检查 gdb 中 str_cat 的大小？现在它报告0：

```
print sizeof(str_cat) 
```

~~它确实打印了字符串，但我如何打印它以显示空字符？~~

让我改写一下，我如何验证 str_cat 的大小合适并且有足够的空间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T23:01:05.510

> 字符 str_cat[strlen(str1) + strlen(str2) + 1];
> 
> 如何检查 gdb 中 str_cat 的大小？现在它报告0：

`str_cat`是一个变长数组。显然`gdb`不怎么处理变长数组。

这里有一张关于这个问题的公开票：http: [//sourceware.org/bugzilla/show_bug.cgi ?id=9663](http://sourceware.org/bugzilla/show_bug.cgi?id=9663)

它提到了一个现有的补丁，但至少我的版本`2012`不包括它。`7.4``gdb`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T03:24:25.070

要解决 GDB 中的错误，请先将大小存储在单独的变量中，*或者*之后将大小存储在单独的变量中，例如：

```
int len = strlen(str1) + strlen(str2) + 1;
char str_cat[len]; 
```

或者

```
char str_cat[strlen(str1) + strlen(str2) + 1;
size_t len = sizeof str_cat; 
```

`len`然后在 GDB 中打印。

# ruby-on-rails - 如何链接模型创建

> ID：14114879
> 
> 赞同：0
> 
> 时间：2013-01-01T22:37:00.357
> 
> 标签：ruby-on-rails

```
class Article < ActiveRecord::Base
  attr_accessible :console, :ean, :title, :title_spaceless
  has_many :dealers, :through => :units
end

class Dealer < ActiveRecord::Base
  attr_accessible :adress, :name, :website
  has_many :articles, :through => :units
  validates :name, :uniqueness => { :case_sensitive => false }
end

class Unit < ActiveRecord::Base
  attr_accessible :article_id, :dealer_id, :note, :price
  belongs_to :article
  belongs_to :unit 
end 
```

如何同时创建经销商、文章和单位？

我尝试的第一件事是这样的，但它似乎是完全错误的。

```
@dealer = Dealer.find_or_create_by_name("Surugaya")
@dealer.article.create(:title => game.content, :title_spaceless => game.content.delete(' '), :console => "SNES").unit.create(:article_id => @dealer.article.article_id, :units_id => @dealer.article.unit_id, :price => game.price) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:49:00.573

首先，您在课堂`units`上缺少一个关联。`Article`你需要解决这个问题：

```
has_many :units 
```

通过“同时”，我假设您的意思是在同一个数据库事务中。你可以试试这个：

```
Dealer.transaction do
  @dealer = Dealer.find_or_create_by_name("Surugaya")
  @article = @dealer.articles.create!(
      :title => game.content, 
      :title_spaceless => game.content.delete(' '), 
      :console => "SNES"
  )
  @unit = @article.units.create!(:price => game.price)
end 
```

# c# - 获取网络共享上文件的扩展属性

> ID：14114881
> 
> 赞同：1
> 
> 时间：2013-01-01T22:37:10.480
> 
> 标签：c#, windows, file-io, interop

我正在尝试从网络共享（作者、专辑等）上的音乐文件中读取扩展属性

此行（改编自[Read/Write 'Extended' file properties (C#)](https://stackoverflow.com/questions/220097/read-write-extended-file-properties-c)中的代码）

```
objFolder = shell.Namespace(@"C:\somefolder"); 
```

有效，但这些行将 objFolder 设置为 null：

```
objFolder = shell.Namespace(@"\\nasdrive\somefolder"); 
```

（Z 映射到 \nasdrive）

```
objFolder = shell.Namespace(@"Z:\somefolder"); 
```

我尝试使用来自[http://platinumdogs.me/2008/10/30/net-c-impersonation-with-network-credentials/](http://platinumdogs.me/2008/10/30/net-c-impersonation-with-network-credentials/)的模拟来包装代码，但它不起作用。

（虽然模拟适用于正常的文件访问：File.Open(...) 等）

如何在不将文件移动到本地驱动器的情况下读取这些扩展属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:56:13.110

如果您正在从网络共享读取，为什么要转义特殊字符，然后使用 4 个反斜杠？

```
objFolder = shell.Namespace(@"\\\\nasdrive\somefolder"); 
```

我认为应该是：

```
objFolder = shell.Namespace(@"\\nasdrive\somefolder"); 
```

或者

```
objFolder = shell.Namespace("\\\\nasdrive\\somefolder"); 
```

# android - 如何创建自定义设备android图形布局工具？

> ID：14114885
> 
> 赞同：2
> 
> 时间：2013-01-01T22:38:01.120
> 
> 标签：android, xml, eclipse

所以我正在为 Kindle Fire HD 开发，并且有一个关于 Eclipse 的问题。我正在使用 Eclipse 中的图形布局工具生成 xml，但是，Kindle Fire HD 不在屏幕类型的可用设备下，因此，当我在 Kindle 上运行它时，一切都有些不对劲。所以基本上我的问题是如何创建自定义设备？我有屏幕分辨率。只是为了通过创建自定义设备来进一步澄清，我正在谈论一个自定义大小的屏幕，我可以添加布局、按钮、标签等。提前致谢！

# php - list(), if 和短路评估

> ID：14114888
> 
> 赞同：2
> 
> 时间：2013-01-01T22:38:55.867
> 
> 标签：php, if-statement, short-circuiting

我有以下代码片段：

```
$active_from = '31-12-2009';
if(list($day, $month, $year) = explode('-', $active_from) 
    && !checkdate($month, $day, $year)) {
    echo 'test';
} 
```

为什么我会收到未定义的变量错误？

`list($day, $month, $year) = explode('-', $active_from)`return `true`，所以`list()`被评估了，不是吗？我想，应该定义变量吗？我监督什么？

这在我看来是一样的并且不会引发错误：

```
$active_from = '31-12-2009';
list($day, $month, $year) = explode('-', $active_from);
if(checkdate($month, $day, $year)) {
    echo 'test';
} 
```

这不会引发错误：

```
if((list($day, $month, $year) = explode('-', $active_from)) && checkdate($month, $day, $year)) { 
```

但我真的不明白为什么:-)

感谢您的解释

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T22:44:20.080

这是[运算符优先级](http://php.net/manual/en/language.operators.precedence.php)的问题，在您的情况下，`&&`评估在 之前`=`，导致您描述的错误。

您可以通过将赋值语句放在括号内来解决此问题。

明确地，您的代码应该阅读

```
if(  (list($day, $month, $year) = explode('-', $active_from))
     && !checkdate($month, $day, $year)) { 
```

请注意，我已将其从 更改`if( $a=$b && $c )`为`if( ($a=$b) && $c )`。括号强制赋值运算符 ( `=`) 在连词 ( `&&`) 之前进行计算，这正是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:44:18.340

阅读[运算符优先级](http://php.net/manual/en/language.operators.precedence.php)。

```
if ( list($day, $month, $year) = explode('-', $active_from) && !checkdate($month, $day, $year) ) { 
```

等同于

```
if ( list($day, $month, $year) = (explode('-', $active_from) && !checkdate($month, $day, $year)) ) { 
```

# iphone - ios音频文件上的音频效果

> ID：14114889
> 
> 赞同：1
> 
> 时间：2013-01-01T22:38:58.843
> 
> 标签：iphone, ios, core-audio, audiounit

我有一个音频（语音）文件，我想在其中应用过滤器（例如音高变换和其他效果），我想知道 ios 的最佳方法是什么。

我只想打开文件，应用效果并写入另一个文件，不需要听。我看到了 AUGraph 和 Mixerhost 示例，但我真的需要在我的情况下使用 AUGraph，我不听麦克风或听音频文件。

我在苹果文档中看到[“每个音频处理图都有一个 I/O 单元”](http://developer.apple.com/library/ios/#documentation/MusicAudio/Conceptual/AudioUnitHostingGuide_iOS/AudioUnitHostingFundamentals/AudioUnitHostingFundamentals.html#//apple_ref/doc/uid/TP40009492-CH3-SW11)

请你帮助我好吗 ？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:56:04.270

您当然不需要为此使用音频单元。相反，您想要做的一切都可以通过[扩展音频文件服务](https://developer.apple.com/library/ios/#documentation/MusicAudio/Reference/ExtendedAudioFileServicesReference/Reference/reference.html)来实现，并结合您想要用于效果的任何 DSP 代码。

[阅读TPAACAudioConverter](https://github.com/michaeltyson/TPAACAudioConverter)的源代码。它的目的是将压缩音频文件从源格式（例如 MP3）转换为 AAC，但它包含从一个文件读取样本并将它们写入另一个文件所需的所有部分，无论源格式或目标格式如何（您将只需修复目标 ASBD 以对应您所需的输出格式）。

在调用`ExtAudioFileRead`和之间`ExtAudioFileWrite`，您可以通过将缓冲区中的样本交给您的效果代码来处理它们。

# c# - 从 Ajax 更新存储过程

> ID：14114890
> 
> 赞同：0
> 
> 时间：2013-01-01T22:39:44.287
> 
> 标签：c#, asp.net, sql, sql-server

我正在编写一个应用程序，它在页面加载时根据 url 中的 ID 从 SQL 中提取信息，然后将其转换为 Int。

```
request_id = Request.QueryString["ID"].ToString();
RequestID = Convert.ToInt32(request_id); 
```

然后，我尝试在 SQL 更新存储过程中将页面上的更改提交回数据库。

如果我将上面的值打印到页面上`RequestID`并且`request_id`......我得到相同的数字......这很好。

但是我的页面上有两个提交按钮。当我单击第一个按钮时，它会弹出以下内容。

```
<ajaxToolkit:ConfirmButtonExtender ID="cbe" runat="server"
ConfirmText="Want to Save?" 
TargetControlID="submit_btn" 
DisplayModalPopupID="btnSave_ModalPopupExtender"        
ConfirmOnFormSubmit="true">
</ajaxToolkit:ConfirmButtonExtender>

<ajaxToolkit:ModalPopupExtender ID="btnSave_ModalPopupExtender" runat="server"
TargetControlID="submit_btn" 
PopupControlID="Panel1" 
DropShadow="true" 
CancelControlID="btnCancel"
BackgroundCssClass="modalBackground">
</ajaxToolkit:ModalPopupExtender>

<asp:Panel ID="Panel1" runat="server" CssClass="Panel_css"  >
<asp:Label ID="sqlErrorLabel" runat="server"></asp:Label>
<p style="margin-left:40px; margin-right:40px; text-align:center">Are you sure you wish to     commit this to the database?</p>
<div style="position:relative; left:23%">
<asp:Button id="btnOK" runat="server" Text="Submit" OnClick="btnOK_Click" CssClass="submit" />
<asp:Button id="btnCancel" runat="server" Text="Cancel" CssClass="submit"  />
</div> 
```

在单击第二个按钮和运行存储过程之间，RequestID 会丢失，因为当我在页面上打印它时它等于 0，而之前它是 255（对于这个例子）

我知道我的代码有效，因为如果我将存储过程中的参数替换为固定值，它就可以正常工作。

有任何想法吗？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:53:12.943

您可以将请求 ID 存储在隐藏字段中。它应该可以正常工作

# c# - 如何将公共属性添加到要在 web.config 中配置的自定义 SqlMembership Provider

> ID：14114891
> 
> 赞同：2
> 
> 时间：2013-01-01T22:39:50.530
> 
> 标签：c#, .net, configuration, web-config

我正在创建一个自定义 SqlMembershipProvider 类，我想在它上面有一个新的公共属性，它允许用户在 web.config 中设置，以及已经在 SqlMembershipProvider 基类之外的其他公共属性。但是，当我添加我的属性并尝试运行该应用程序时，我收到黄屏死机错误，指出**属性无法识别“DataLocationDescription”。** 我需要做什么才能在 web.config 中使用该类的其他属性访问此属性？

这是我的代码：

```
public class CustomSqlMembershipProvider : SqlMembershipProvider
{

    public string DataLocationDescription { get; set; }

} 
```

这是 web.config 文件，我在其中指定了我的 Property DataLocationDescription：

```
 <add name="CustomizedMembershipProvider" 
           type="ClassLibraries.Web.Security.CustomSqlMembershipProvider" 
           connectionStringName="SQLConnection" 
           maxInvalidPasswordAttempts="5" 
           passwordAttemptWindow="30" DataLocationDescription="Tier2"/> 
```

我尝试使用 ConfigurationProperty 属性，但这没有任何区别。

```
[ConfigurationProperty("DataLocationDescription", IsRequired = true)] 
```

任何帮助是极大的赞赏。

谢谢！跳蚤

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:07:06.110

它不是`SqlMembershipProvider`反序列化配置文件中的成员资格/提供者部分的部分，而是 ConfigurationManager 类。`membership`元素的架构是[固定](http://msdn.microsoft.com/en-us/library/dayb112d%28v=vs.100%29.aspx)的，因此您无能为力。

简而言之，配置系统不知道您的额外属性。

相反，您可以创建[自己的配置部分](http://msdn.microsoft.com/en-us/library/2tw134k3%28v=vs.100%29.aspx)，并在应用程序开始的某处对自定义成员资格提供程序进行后初始化。所以，你现在有一个像`CustomSqlMembershipProvider`一个元素的部分（或属性，你的选择），`DataLocationDescription`值。

# windows - 将我的 Delphi 应用程序拖放到资源管理器

> ID：14114904
> 
> 赞同：0
> 
> 时间：2013-01-01T22:41:59.240
> 
> 标签：windows, delphi, api, drag-and-drop, messages

> **可能重复：**
> [Delphi 中的跨应用程序拖放](https://stackoverflow.com/questions/295259/cross-application-drag-and-drop-in-delphi)

我正在使用德尔福 XE3。我在问自己是否可以使用 Windows 消息从我的应用程序到 Windows 资源管理器中执行 dran-n-drop 一些文件。我已经完成了从资源管理器到我的应用程序的事情，这很容易。你怎么看，我不想使用组件，我这样做是出于教育目的，想继续使用 Windows 消息，搜索和阅读有关此的文档。但如果不可行，将搜索其他内容。谢谢你得到你的观点。

# html - Child Div 的显示：none 不工作

> ID：14114919
> 
> 赞同：0
> 
> 时间：2013-01-01T22:44:03.453
> 
> 标签：html, css

**Display:none**不适用于子 div。我该如何解决这个问题？

*HTML*

```
<div class="parent">
    Hello
    <div class="child">
       Ola
    </div>
</div> 
```

*CSS*

```
.parent {
    display:block;
}

.child {
    display:none;
} 
```

在 Chrome 开发者工具中，孩子的 display:none 被划掉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T22:51:56.403

发现错误 - 在我的实际代码中有两个显示属性 - 而不是这里的简化版本。 **愚蠢的错误：P**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:47:45.810

您的 HTML 不正确，缺少结束引号`"`

```
<div class="parent">
    <div class="child">
    </div>
</div> 
```

# c# - 按按钮创建并打开文件夹，扫描文件

> ID：14114920
> 
> 赞同：-1
> 
> 时间：2013-01-01T22:44:17.723
> 
> 标签：c#, winforms, file, directory

有人可以帮我完成一个功能吗...我正在创建 Windows 窗体应用程序，其中在某些按钮推送应用程序上创建文件夹（在应用程序 .exe 根目录中）作为名为 Folder1 的示例，并在创建后也打开它。

编辑：我已经这样做了

```
private void button1_Click(object sender, EventArgs e)
{
    System.IO.Directory.CreateDirectory("CPC Folder");
    string myPath = @"CPC Folder";
    System.Diagnostics.Process prc = new System.Diagnostics.Process();
    prc.StartInfo.FileName = myPath;
    prc.Start();
} 
```

这是第一部分，在用户将一个 .txt 文件放入该文件夹后的第二部分，我需要扫描功能的帮助，该功能将扫描新创建的文件夹以查找用户估算的 .txt 文件，并在找到时将其保存到变量的路径。

现在主要的是第一部分。我可能会找到一种方法来完成第二次......希望有人能帮助我:)

Ps 这个应用程序是基于 c# 的，我现在只能显示这个代码：

```
private void button1_Click(object sender, EventArgs e) { } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T22:48:51.110

好吧，要完成第一部分，您只需要以下代码：

```
Directory.CreateDirectory("SomeDirectoryName"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T03:13:54.773

这应该可以解决问题

```
private string myTextFile;

private void button1_Click(object sender, EventArgs e)
{
     string myPath = Environment.CurrentDirectory + @"\CPC Folder";
     System.IO.Directory.CreateDirectory(myPath);
     Process.Start("explorer.exe", myPath);
     FileSystemWatcher fileWatcher = new FileSystemWatcher(myPath, "*.txt");
     fileWatcher.EnableRaisingEvents = true;
     fileWatcher.Created += (snder, eArgs) =>
     {
         myTextFile = eArgs.FullPath;
     };
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T23:57:16.673

你需要看看这个类：`FileSystemWatcher` [链接](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)

# javascript - AngularJS - 获取单个帖子

> ID：14114925
> 
> 赞同：0
> 
> 时间：2013-01-01T22:44:42.907
> 
> 标签：javascript, get, angularjs, params

我有一个数据列表和一个要显示单个帖子的页面。

**服务：**

```
app.factory('dealerService', function($resource) {
   return $resource('files/js/dealer.json', {}, {
    query: {method:'GET', params:{id:'@id'}, isArray:true}
  });
}); 
```

**控制器：**

```
app.controller('DealerDetailsCtrl', function ($scope, $routeParams, dealerService) {
    $scope.dealer = dealerService.get({id: $routeParams.id});
}); 
```

**路线：**

```
app.config(['$routeProvider', function($routeProvider) {
  $routeProvider.
      when('/dealer/:id', {templateUrl: 'files/tpl/dealer-details.html', controller: 'DealerDetailsCtrl'}).
      otherwise({redirectTo: '/'});
}]); 
```

**模板：**

```
TBD: detail view for {{dealer}} 
```

var 为我提供了 json 文件中可用的`{{dealer}}`所有数据……而不仅仅是我的特定帖子。

我错过了什么？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T03:32:01.810

看起来您正在向 Web 服务器请求文件，这就是您从 Web 服务器返回的内容。在这里向 URL添加`id`参数可能没有影响。

您必须在 JavaScript 中解析文件的内容（例如，在 Angular 过滤器中）以过滤数据并仅提取具有适当 ID 的数据，或者
您必须更改服务器端：拥有 Web 服务器当接收到某个 URL 时运行脚本来解析文件的内容并过滤掉具有适当 ID 的数据。

# php - 正则表达式：任何除了给定的短语

> ID：14114926
> 
> 赞同：2
> 
> 时间：2013-01-01T22:44:53.200
> 
> 标签：php, regex

`[tag]blabla[/tag]`

我想将其替换为：

`<tag>blabla</tag>`

`[tag]`但是，如果和之间有一个短语“leavemealone”，则保持不变`[/tag]`。

so `[tag]leavemealone[/tag]`or `[tag]aaa leavemealone[/tag]`or `[tag]aaa leavemealone aaa[/tag]`etc. 应该保持不变。

代码：

```
preg_replace("#\[tag\](what_should_be_here)\[\/tag\]#", "<tag>$1</tag>", $text); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T23:03:36.720

使用以下模式。

```
$match = "#\[(\w+)\](?!.*leavemealone.*)(.*?)\[/(\w+)\]#";
$replace = "<$1>$2</$3>"; 
```

那应该这样做。如果你不想匹配任何标签，而只是一个“ `tag`”标签，你可以像这样修复它：

```
$match = "#\[tag\](?!.*leavemealone.*)(.*?)\[/tag\]#";
$replace = "<tag>$1</tag>"; 
```

# java - 递增数组中的数字，直到它们都相等

> ID：14114929
> 
> 赞同：0
> 
> 时间：2013-01-01T22:45:37.400
> 
> 标签：java, arrays, performance, increment

该程序的目标是使数组中的所有数字都相同。您必须每次递增数组中的所有值，除了一个。然后程序将打印出使所有数字相同所需的最少步数。我有一个我认为是可行的解决方案，我只是想让它更有效率，有人有什么想法吗？在下面的代码中，用户将数字的初始值输入到数组中，然后计算所需的步数

```
public static void main(String[] args) throws NumberFormatException, IOException 
{
counter=0;
         size=sc.nextInt();
         input= new int[size];
        for(int k=0; k<size; k++)
        {
            input[k]=sc.nextInt();
        }
        while(!isAllEqual(input))
        {
            Arrays.sort(input);
            for(int k=0; k<input.length-1; k++)
            {
                input[k]++;
            }
            counter++;
        }
        pw.println(counter);

public static boolean isAllEqual(int[] a){
    for(int i=1; i<a.length; i++){
        if(a[0] != a[i]){
            return false;
        }
    }
return true;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-01T22:55:42.820

如果您将步骤更改为更简单的内容，可能会更容易理解这一点。如果我们只讨论值之间的相等性（即相对值，而不是绝对值），那么一次增加和减少*所有*值没有区别。如果我们将步骤更改为“除一之外的所有值都递增，然后将每个值减一”，我们可以看到除一之外的所有值都递增等于递减单个值。

如果步长是“减一值”，你能算出使值相等的步数吗？它应该涉及在最大处循环数组两次，并且不进行排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T22:57:59.520

重大编辑，因为我误读了这个问题

只需扫描一次列表即可找到列表中的最小值以及所有值相加的总和。

获得这两个值后，所需增量的数量为：

[所有值的总和] - [列表中的项目数] * [最小值]

在代码中：

```
public static int numberOfSteps(int[] a) {
    if( a.length==0 ) return 0;

    int min= a[0];
    int total = a[0];
    for(int i=1;i<a.length;i++) {
        if( a[i] < min ) min = a[i];
        total += a[i];
    }

    return total - a.length * min;
} 
```

这是因为（正如 Matti Virkkunen 指出的那样）每个项目的递减次数对于`(a[i] - min )`整个列表来说都是如此`sum(a[i]-min)`，我们可以将其扩展到`sum(a[i]-(length*min)`.

相应的增量将在每一步增加所有内容，除了最右边的项目，它等于最大值。例如：

初始状态 = (0,1,1,1) 1\. 增加除 a[3] 之外的所有内容 --> (1,2,2,1) 2\. 增加除 a[2] 之外的所有内容 --> (2,3, 2,2) 3\. 增加除 a[1] --> (3,3,3,3) 之外的所有内容：三步解决方案 = (1+1+1) - (4 * 0)

再次，（1,2,3,3）的初始状态

1.  递增除 a[3] 之外的所有内容 --> (2,3,4,3)
2.  递增除 a[2] 之外的所有内容 --> (3,4,4,4)
3.  递增除 a[3] 之外的所有内容 --> (4,5,5,4)
4.  递增除 a[2] 之外的所有内容 --> (5,6,5,5)
5.  递增除 a[1] --> (6,6,6,6) 之外的所有内容：五步解决方案 = (1+2+3+3) - (4 * 1)

# c - Bron-Kerbosch C 实现

> ID：14114934
> 
> 赞同：1
> 
> 时间：2013-01-01T22:47:06.653
> 
> 标签：c, implementation, clique-problem

我在实现 Bron-Kerbosch 算法的 C 版本时遇到了一些问题：

1-我完全不了解算法的工作原理。我试图在互联网上找到参考资料，但所有这些参考资料都很糟糕，因为可怕的算法示例实现很糟糕，并且没有任何解释出现在伪代码上的一些任意命名的函数（例如 P(N) ）

2- 我在互联网上找到了一些 C++ 实现，但作者未能放入代码中使用的类，所以我留下了非常命名的变量，我什至不知道它们是什么类型（例如 compsub、nod、minnod , fixp, newne, newce)。

我能够翻译的一个代码是 SegFaulting。你能帮我理解算法/告诉我我的代码做错了什么吗？

一些有用的信息：

graph->matrix 是连接矩阵。

List_clear 返回列表的大小。

```
int serial (Graph* graph) { 
  int i; 
  int* all = (int *) malloc (graph->size * sizeof (int) ); 
  List compsub;

  List_init (&compsub);

  for (i = 0; i < graph->size; i++)  
all[i] = i; 
  bkv2 (graph, &compsub, all, 0, graph->size);
  free (all); 
  return List_clear (&compsub);
} 

// recursive function version 2 of Bron-Kerbosch  algorithm 
void bkv2 (Graph* graph, List* compsub, int* oldSet, int ne, int ce ) {  
  int* newSet = (int *) malloc (ce * sizeof (int) ); 
  int nod, fixp; 
  int newne, newce, i, j, count, pos, p, s, sel, minnod; 

  minnod = ce; 
  nod = 0; 
  // Determine each counter value and look for minimum 
  for ( i = 0 ; i < ce && minnod != 0; i++) { 
p = oldSet[i]; 
count = 0; 

// Count disconnections 
for (j = ne; j < ce && count < minnod; j++) 
  if ( !(graph->matrix[p][oldSet[j]]) ) { 
    count++; 
    // Save position of potential candidate 
    pos = j; 
  } 
// Test new minimum 
if (count < minnod) {
  fixp = p; 
  minnod = count; 
  if (i < ne)
    s = pos; 
  else { 
    s = i; 
    // pre-increment 
    nod = 1; 
  } 
} 
  } 
  // If fixed point initially chosen from candidates then 
  // number of diconnections will be preincreased by one 
  // Backtrackcycle 
  for (nod = minnod + nod; nod >= 1; nod--) { 
// Interchange 
p = oldSet[s]; 
oldSet[s] = oldSet[ne];   sel = oldSet[ne] = p; 
// Fill new set "not" 
newne = 0; 
for ( i = 0 ; i < ne ; i++) 
  if (graph->matrix[sel][oldSet[i]] ) 
    newSet[newne++] = oldSet[i]; 

// Fill new set "cand" 
newce = newne; 
for (i = ne+1; i<ce; i++) 
  if (graph->matrix[sel][oldSet[i]] ) 
    newSet[newce++] = oldSet[i]; 

// Add to compsub 
List_add (compsub, sel); 
if (newce == 0) { 
  // found a max clique 
  List_print(compsub); 

} else if (newne < newce) 
  bkv2 ( graph, compsub, newSet, newne, newce ); 

// Remove from compsub 
List_remove(compsub); 

// Add to "not" 
ne++; 
if (nod > 1) 
  // Select a candidate disconnected to the fixed point 
  for ( s = ne ; graph->matrix[fixp][oldSet[s]] ; s++) 
    ; 
// nothing but finding s  

  } /* Backtrackcycle */ 
  free (newSet); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T17:19:45.493

对于这个实现，矩阵的对角元素必须为真，例如，graph->matrix[i][i] 对于所有 i 都应该为真。这有点不寻常，我猜你的输入不是，在这种情况下，只是暂时将它们分配给 true，它应该可以工作。

# html - 在 ASP 中使用多重选择下拉菜单

> ID：14114938
> 
> 赞同：1
> 
> 时间：2013-01-01T22:47:26.310
> 
> 标签：html, forms, asp-classic

我是新手，不太擅长 ASP，所以请多多包涵。

在我的 HTML 表单中，我有一个多项选择下拉菜单，如下所示：

```
 <span><select id="movieMonster" name="movieMonster" multiple="multiple">
      <option value="">Please select all that apply</option>
      <option value="The Mummy">The Mummy</option>
      <option value="Dracula" selected>Dracula</option>
      <option value="The Wolfman">The Wolfman</option>
      <option value="The Gillman" selected>The Gillman</option>
      <option value="The Wasp Woman">The Wasp Woman</option>
 </select></span> 
```

当按下提交按钮时，我到处寻找并尝试了一切以将选定的项目转移到我的 ASP 文件中。但是，只有一个值会转移。

我在我的 ASP 中使用以下内容：

```
 Mnstr = Trim(Upload.Form("movieMonster")) 
```

我能找到的最接近的东西是一些代码，它将显示所有选定的项目，但代码必须在与表单相同的 HTML 页面上使用。它工作得很好，只是我无法将数据传输到我的 ASP。

我找到的代码如下：

```
 <!DOCTYPE html>
 <html>
 <head>

 <style>
      div { color:red; }
 </style>

 <script src="http://code.jquery.com/jquery-latest.js"></script>

 </head>
 <body>

      <select name="garden" multiple="multiple">
           <option>Flowers</option>
           <option selected="selected">Shrubs</option>
           <option>Trees</option>
           <option selected="selected">Bushes</option>
           <option>Grass</option>
           <option>Dirt</option>
      </select>

      <div></div>

      <script>
           $("select").change(function () {
                var str = "";
                $("select option:selected").each(function () {
                     str += $(this).text() + " ";              
                });
           $("div").text(str);
           })        
           .trigger('change');
      </script>

 </body>
 </html> 
```

`<div></div>`上面是打印所选项目的内容。我已经操纵代码为我工作，并将 div 的使用更改为另一个变量，因为我需要这样做，而且这已经奏效了。它将打印从多项选择下拉列表中选择的每个项目，但我无法将该信息传递给 ASP 文件。

由于我无法将信息传递给 ASP，因此我也尝试使用隐藏输入，但这也不起作用。

如果有人知道一种简单的方法来做我需要的事情，我将不胜感激。

我确信必须有一种简单的方法来做到这一点，但我无法在任何地方找到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T05:59:12.437

这是上传组件的问题。请参阅：[Upload.Form 仅返回多选控件的第一个选定项](http://support.persits.com/show.asp?code=PS01032617)。

As the workaround suggests, you will have to loop through the form fields named `movieMonster` in your asp page.

Your asp code should be something like :

```
Mnstr = ""
For Each Item in Upload.Form
  If Item.Name = "movieMonster" Then 
    Mnstr = Mnstr & Item.Value &","
  End If
Next 

'remove the extra comma if there is one
if (trim(Mnstr)<>"") then
    Mnstr = Left(Mnstr,len(Mnstr)-1)
end if 
```

# html - 如何为复选框值构建 url 参数

> ID：14114943
> 
> 赞同：3
> 
> 时间：2013-01-01T22:47:59.347
> 
> 标签：html, forms, url, parameters

我正在尝试通过 url 为两个复选框传递值，两个复选框都具有不同的名称，只需要查看它们是选中还是未选中。这是html代码的样子：

```
<input type="checkbox" name="one" value="one" checked id="one" >
<input type="checkbox" name="two" value="two" id="two" > 
```

如何在 url 中对其进行编码，以便可以通过 url 中的内容选中或取消选中复选框，例如：

```
www.site.com?one=unchecked&two=checked 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:24:36.010

你可以用一点 php 来做到这一点：

```
<input type="checkbox" name="one" value="one" id="one" <?= ($_GET["one"] == "checked" : "checked" : "" ?> >
<input type="checkbox" name="two" value="two" id="two" <?= ($_GET["two"] == "checked" : "checked='checked'" : "" ?>> 
```

.... 或者正如你提到的，在客户端使用 Javascript：

```
document.body.onload = function() {
    var hash = window.location.hash().substr(1);
    var parts = hash.split("&");
    for(var i = 0; i < parts.length; i++) {
        var variable = parts.split("=");
        if(variable[0] == "one") // if the key of a get-variable equals "one"
            document.getElementById("one").setAttribute("checked");
        else if(variable[0] == "two") // if the key of a get-variable equals "two"
            document.getElementById("two").setAttribute("checked");
    }
}; 
```

我希望它有帮助...

# java - 括号优先

> ID：14114950
> 
> 赞同：5
> 
> 时间：2013-01-01T22:48:59.307
> 
> 标签：java, calculator, brackets, operator-precedence

我对java很陌生，我正在构建一个计算器，它需要一个方程并对其进行评估。

我正在使用 Scanner 方法来获取输入，但这意味着我的输入是 Scanner 类型。我应该如何处理这个输入，以便我可以评估它？一旦我可以评估它，我怎么能优先考虑括号？

例如，对于方程 (5*(4+3))*2 ，我希望程序先计算 (4+3)，然后将其乘以 4，然后将所有乘以 2。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:04:43.940

您需要的是 Dijkstra 的[调车场算法](http://en.wikipedia.org/wiki/Shunting-yard_algorithm)。这将固定数学符号转换为后固定符号，它巧妙地解决了运算符优先级和括号的所有问题，因为后固定符号不需要它们中的任何一个。维基百科页面有一个完整的 C 语言示例，可以翻译成 Java。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T23:01:34.020

我认为这会有所帮助：[Polish notation](http://en.wikipedia.org/wiki/Polish_notation)和[Reverse Polish notation](http://en.wikipedia.org/wiki/Reverse_Polish_notation)。他们解释了如何在树中划分字符串并一次执行一个步骤的想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T23:47:43.130

@Simon G 提出的使用 Dijkstra 的 Shutting Yard 算法的建议已经确定了。您将需要实现“微语法”来解析符号，但`Scanner`可以完成 95% 的工作。

另一种方法是使用解析器生成器（如 ANTLR 或 Javacc）实现表达式解析器，然后将求值实现为树的遍历。但是，如果您只想评估一次表达式，那将是相当重量级的。

最后，我想指出，虽然这是一个众所周知（已解决）的问题，但它不是一个微不足道的问题......在任何语言中。也许这告诉您，您需要对算法和/或编译器进行更多阅读以完善您的知识。

# c++ - 朋友声明不转发声明

> ID：14114956
> 
> 赞同：7
> 
> 时间：2013-01-01T22:49:44.080
> 
> 标签：c++, c++11

我的理解是，`friend`如果使用说明符，则声明也可以用作类的前向声明`class`，如下例所示：

```
class A
{
    friend class B;
    B* b;
};

class B {};

int main() {} 
```

但是，g++（4.6.3 和 4.7.0）给了我以下错误（g++-4.7 应该支持[扩展的朋友声明](http://gcc.gnu.org/projects/cxx0x.html)），这是没有前向声明的预期：

> main.cpp:6:2：错误：“B”没有命名类型

为了确认我对`friend class B;`应该作为前向声明的期望，我找到[了这个答案](https://stackoverflow.com/a/9890827/507606)和[这个答案](https://stackoverflow.com/a/657113/507606)，但都不是决定性的（或者我至少不能从他们那里得出很多结论）所以我试图咨询 c++ 11个标准，找到了这个例子：

```
class X2 {
    friend Ct; // OK: class C is a friend
    friend D; // error: no type-name D in scope
    friend class D; // OK: elaborated-type-speciﬁer declares new class
} 
```

根据我对第三个声明的阅读， my`friend class B`应该是一个*详细的类型说明符，声明一个新的 class*。

我刚刚开始理解官方标准措辞，所以我一定遗漏了一些东西。我有什么误解？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-01T23:06:40.410

Take a look at 11.3 paragraph 11:

> For a friend class declaration, if there is no prior declaration, the class that is specified belongs to the innermost enclosing non-class scope, but if it is subsequently referenced, its name is not found by name lookup until a matching declaration is provided in the innermost enclosing nonclass scope.
> 
> Example:

```
class X;
void a();
void f() {
  class Y;
  extern void b();
  class A {
  friend class X;  // OK, but X is a local class, not ::X
  friend class Y;  // OK
  friend class Z;  // OK, introduces local class Z.
  friend void a(); // error, ::a is not considered
  friend void b(); // OK
  friend void c(); // error
  };
  X *px;           // OK, but ::X is found
  Z *pz;           // error, no Z is found
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-01T23:05:51.703

您的`friend class B;`声明*确实*用作前向声明，但在提供匹配声明之前，无法通过名称查找找到此类声明。

*[class.friend]/11*：

> If a friend declaration appears in a local class (9.8) and the name specified is an unqualified name, a prior declaration is looked up without considering scopes that are outside the innermost enclosing non-class scope. For a friend function declaration, if there is no prior declaration, the program is ill-formed. For a friend class declaration, if there is no prior declaration, the class that is specified belongs to the innermost enclosing non-class scope, but if it is subsequently referenced, its name is not found by name lookup until a matching declaration is provided in the innermost enclosing nonclass scope.

# linux - shell脚本：将文件移动到另一个目录

> ID：14114958
> 
> 赞同：0
> 
> 时间：2013-01-01T22:50:22.583
> 
> 标签：linux, bash

我有一个名为 directory1 的目录，我们每天都会在其中存储一些文件。
我首先尝试删除存储在 directory2 中的先前备份。然后我尝试将目录 1 中的文件移动到目录 2。我使用 cron 运行以下 bash 脚本，但似乎失败了。
我的代码有什么问题？

```
#!/bin/sh
/bin/rm -rf /directory2/*
/bin/mv /directory1/* /directory2/ 
```

我的 /etc/crontab 有以下行：

```
0 6 * * 6 root /root/scripts/files.move.sh 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T23:01:14.470

我不明白为什么您的命令会失败，但是可以使脚本更具防御性：

```
set -e; # bash specific, fail on error
/bin/mv /directory2 /directory3
/bin/mv /directory1 /directory2
/bin/rm -rf directory3
/bin/mkdir -p /directory1 
```

# php - 图像调整数学大小，但不调整自身大小

> ID：14114962
> 
> 赞同：0
> 
> 时间：2013-01-01T22:50:34.513
> 
> 标签：php, image, resize, aspect-ratio

**是否有一个 php 函数可以自行调整图像大小但不创建新文件？**

我创建了一个简单的按比例调整图像大小的数学脚本，我意识到它不仅仅是几何图形，例如纵横比等。基本的几何数学会稍微压缩图像。

如果有人好奇，这只是为了让用户在他们选择下载时预览图像尺寸，但我宁愿不要用大量相似图像的大小变化来弄乱服务器：D。

谢谢。

编辑：根据请求，这是调整大小代码的关键部分：

```
$ratio = min( $resize_to / $width, $resize_to/ $height );   

$width  = $ratio * $width; 

$height = $ratio * $height; 
```

当我看到输出的值时，我只是在 Photoshop 中使用这些值和 Photoshop 版本压缩来调整大小（我这样做是为了进行视觉测试），所以我假设我的代码有问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:18:36.827

在尊重纵横比的同时缩放图像所需的数学非常简单。一些伪代码：

```
original_width = <width of image before resizing>
original_height = <height of image before resizing>

new_width = <the max width desired for the resized image>
new_height = <the max height desired for the resized image>

if original_width >= original_height
  ratio = original_width / original_height
  new_height = new_width / ratio
else 
  ratio = original_height / original_width
  new_width = original_height / ratio
end

print "Width: " + new_width
print "Height: " + new_height 
```

以上可能可以显着改善，但我只是想说明这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T00:30:24.867

这很好笑。我正在调整一个文件的大小，然后在 Photoshop 中检查另一个文件。人为错误。绕过街区过马路，不知不觉已经过马路了。。

# android - AsyncTask 可以/应该启动另一个 AsyncTask 吗？

> ID：14114963
> 
> 赞同：0
> 
> 时间：2013-01-01T22:50:38.167
> 
> 标签：android

我对缓存很多图像感兴趣。它们显示在 Horizo​​ntalScrollView 中。每个图像都与一个 url 相关联。在 2.2 设备上，您根本无法启动许多 AsyncTask 作为图像，因为在说 10 AsyncTask 之后它会崩溃应用程序相信我。所以我正在考虑启动一个 AsyncTask，它将通过每个 url 进行，获取位图并将其存储在缓存中。由于某些图像可能比其他图像花费更长的时间，我认为启动 AsyncTask 以获取图像并将其放入缓存中的 AsyncTask 只是要走的路。等待每个人返回是不可行的，因为有些人可能需要比其他人更长的时间。所以我认为一个带有 doInBackground 的 AsyncTask 是一个缓慢的延迟循环，每个循环都会启动。这种方法对于位图的图像缓存是否可行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T23:28:01.950

来自文档：

> AsyncTask 类必须在 UI 线程上加载。这是从 JELLY_BEAN 自动完成的。

此外，由于蜂窝 AsyncTasks 是序列化的（默认情况下），使用 AsyncTasks 和并行进行长时间处理也不是一个好主意。如果那是您需要的，请查看 Executors。您将在 AsyncTask 文档页面中找到正确文档的链接。

# ruby-on-rails - 修改参数键以在控制器中使用两次查询

> ID：14114964
> 
> 赞同：0
> 
> 时间：2013-01-01T22:50:57.373
> 
> 标签：ruby-on-rails, ransack

我正在使用 Ransack 在我的应用程序上运行搜索。我有一个用户输入文本的搜索栏，文本被传递到一个搜索控制器，我在两个表中搜索查询：帖子和组

问题是我想分别对 Groups 和 Posts 运行查询`:name`，`:title`然后在同一页面上提供两组结果。搜索表单使用 :name_cont ，因此当我在 Posts 上运行相同的搜索时，我试图复制此表单发送到控制器的哈希并将密钥更改为 :title_cont。

不要犹豫，要求澄清。

**搜索控制器**

```
class SearchController < ApplicationController
  def index
    @q = Group.search(params[:q])
    @groups = @q.result
    @group_count = @groups.count

    #query = params[:q][:name_cont]
    posthash = { :q => {:title_cont => params[:q][:name_cont]} }
    @q = Post.search(posthash)
    @posts_results = @q.result(:distinct => true)
    @post_count = @posts.count

  end
end 
```

**搜索表格：**

```
=search_form_for @q, :url => { :controller => "search", :action => "index" }do |f|
  =f.text_field :name_cont
  =f.submit 'search' 
```

**它产生的错误：**

```
undefined method `name_cont' for #<Ransack::Search:0x007fc0f798df18> 
```

**更新 1：**

```
class SearchController < ApplicationController
  def index
    @q = Group.search(params[:q])
    @groups = @q.result
    @group_count = @groups.count

    #I am trying to take the query, i.e. the "value" in params[:q]
    #and pass it into a new hash to use as a parameter in 'search'
    posthash = { :q => {:title_cont => params[:q][:name_cont]} }

    @q2 = Post.search(posthash)
    @posts_results = @q2.result(:distinct => true)
    @post_count = @posts.count

  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T00:48:45.833

您正在覆盖`@q`搜索帖子，它响应标题而不是名称，最终搜索表单获得一个没有`name_cont`但`title_cont`相反的对象，因此您需要使用另一个变量名称来搜索除`@q`.

# php - 警告：explode() 期望参数 2 是字符串，给定数组

> ID：14114968
> 
> 赞同：-3
> 
> 时间：2013-01-01T22:51:22.900
> 
> 标签：php, arrays, explode

我正在尝试使用脚本。当我去使用它时，我收到以下错误：

> 警告：explode() 期望参数 2 是字符串，数组在第 16 行的 /myred/include/functions.php 中给出
> 
> 警告：in_array() 期望参数 2 为数组，在第 17 行的 /myred/include/functions.php 中给出 null

现在，下面是functions.php 的第16 和17 行。有人知道它有什么问题吗？

```
$reserved = explode("--",$reserved);
if (in_array("$dname", $reserved)) {
    $errormsg .= "$text_17<br>";
}
return $errormsg; 
```

作为参考，这是我正在使用的脚本：http: [//www.milliscripts.at/downloads/myred_14_mysql_5.zip](http://www.milliscripts.at/downloads/myred_14_mysql_5.zip)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T23:00:41.187

这条线是你的困境的原因：

```
$reserved = explode("--",$reserved); 
```

从错误消息看来，`$reserved`它已经是一个数组。我将猜测它并说初始`$reserved`数组的每个元素都是包含`"--"`您要拆分的字符串。

如果这个假设是正确的，您需要`$reserved`使用以下方法转换为字符串`implode()`：

```
$reserved = explode("--", implode($reserved)); 
```

这将解决错误并可能为您提供所需的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-01T22:55:01.883

很简单，在第 16 行，您试图分解一个数组，查看 php 手册`explode`，它通过您指定的任何分隔符拆分字符串。

由于`$reserved`第 16 行失败，第 17 行也失败了，因为`$reserved`没有正确设置。

发布更多代码，我们需要查看`$reserved`首先声明的位置。

# excel - 调用子例程“预期的变量或过程，而不是模块”时出错。

> ID：14114969
> 
> 赞同：3
> 
> 时间：2013-01-01T22:51:24.983
> 
> 标签：excel, vba

我正在尝试创建一个将调用其他几个子例程之一的子例程。

当我在 if 语句中使用调用时，出现错误：

> 预期变量或过程，而不是模块。

下面是调用过程：

```
Call schedule_3_day(shift1, ActiveWorkbook.Sheets("Employees"), ActiveWorkbook.Sheets("3 Day Template")) 
```

这是它所指的功能。

```
Sub schedule_3_day(ByRef sourcesheet As Worksheet, ByRef employeesheet As Worksheet, ByRef template As Worksheet) 
```

就其本身而言，即当它是一个自包含的子例程时， schedule_3_day 会按预期工作。我正在尝试更改它以将用户定义的变量传递给它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-02T09:20:11.730

**背景**

当 Excel 创建模块时，它会命名 then `Module1`，`Module2`依此类推。如果像我一样将例程分为多个集合：全局、任务 1、任务 2 等，这可能会让人感到困惑。

似乎不是每个人都知道您可以重命名 Excel 模块。这在 Access 中很明显，您需要输入模块的名称。对于 Excel，您必须自己发现这个工具。

选择模块，单击 F4，模块属性将出现在浮动窗口中，就像在窗体中一样。唯一的属性是`Name`您可以将其更改为符合变量名称规则的任何内容。使用这个工具，我重命名了我的模块：`Global`、、等等，这样我就可以轻松地识别我今天要处理的模块`Task1`。`Task2`

**局限性**

我相信您在选择模块名称时遇到了一个限制。

如果我重命名一个模块`Task1`，那么该模块中的子、函数或全局变量`Task1`从外部是不可见的。

如果包含的模块`sub schedule_3_day(ByRef ...`名为`schedule3_day`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-16T15:16:11.480

如果模块和宏具有相同的名称，请执行以下操作：

模块.宏

因此，如果我的模块和宏都被称为 FreezeColumnFilter 那么代码将是：

FreezeColumnFilter.FreezeColumnFilter

# c# - 使用 SharpPcap 和 Packet.Net 发送我自己的 ARP 数据包

> ID：14114971
> 
> 赞同：6
> 
> 时间：2013-01-01T22:51:46.143
> 
> 标签：c#, sharppcap, packet.net

到目前为止，我试图发送一个使用 SharpPcap 使用 Packet.Net 创建的 ARP 数据包，但没有成功。问题是即使我使用`device.SendPacket`它发送数据包实际上并没有发送，我也不知道为什么。

这是我的代码：

```
ARPPacket arpPacket = new ARPPacket(ARPOperation.Request, PhysicalAddress.Parse("000000000000"), targetIpAddress, device.Interface.MacAddress, myIpAddress);
EthernetPacket ethPacket = new EthernetPacket(device.Interface.MacAddress, PhysicalAddress.Parse("FFFFFFFFFFFF"), EthernetPacketType.Arp);
ethPacket.PayloadPacket = arpPacket;
device.Open();
device.SendPacket(ethPacket);
device.Close(); 
```

顺便说一句，重要的是我发送自己的 ARP 数据包，而不仅仅是使用 SharpPcap ARP 类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-25T22:13:59.660

```
public static void ARP(IPAddress ipAddress , LivePcapDevice device)
{
if (ipAddress == null )
throw new Exception("ARP IP address Cannot be null");
var ethernetPacket = new PacketDotNet.EthernetPacket(device.Addresses[1].Addr.hardwareAddress, PhysicalAddress.Parse("FF-FF-FF-FF-FF-FF"), PacketDotNet.EthernetPacketType.Arp);

var arpPacket = new PacketDotNet.ARPPacket(PacketDotNet.ARPOperation.Request, PhysicalAddress.Parse("00-00-00-00-00-00"), ipAddress , device.Addresses[1].Addr.hardwareAddress, device.Addresses[0].Addr.ipAddress );
ethernetPacket.PayloadPacket = arpPacket;

device.SendPacket(ethernetPacket);
} 
```

试试这个功能，来自：[http ://stolenpackets.net/?p=29](http://stolenpackets.net/?p=29)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T09:28:25.997

查看[此代码](http://www.codeforge.com/read/120870/ARP.cs__html)没有涉及以太网数据包

```
ARPPacket arpPacket = new ARPPacket(ARPOperation.Request, PhysicalAddress.Parse("000000000000"), targetIpAddress, device.Interface.MacAddress, myIpAddress);
arpPacket.ARPTargetProtoAddress = destIP;
arpPacket.DestinationHwAddress = PhysicalAddress.Parse("FF-FF-FF-FF-FF-FF");
device.Open();
device.SendPacket(arpPacket);
device.Close(); 
```

# ruby - 没有可用的二进制红宝石：osx/10.8/x86_64/ruby-1.9.2-p320

> ID：14114976
> 
> 赞同：4
> 
> 时间：2013-01-01T22:52:45.563
> 
> 标签：ruby, rvm

[这里](http://www.fakingfantastic.com/2010/11/26%20/fixing-the-you-have-to-install-development-tools-first-error-with-nokogiri/)有一篇两年前的博客文章解释了如何修复 Nokogiri 附带的错误“你必须先安装开发工具”错误，如果您在安装 RVM 后升级到 Mountain Lion，就会出现这个问题。在博客文章中，他说你必须做

```
rvm update head
rvm --force install 1.9.2
gem install bundle

## in your rails app
bundle
Installing nokogiri (1.4.2) with native extensions
 ... 
```

`rvm update head`现在已更改为`rvm get head`. 然而，在那之后我**盲目地**做了

```
rvm --force install 1.9.2 
```

并收到此错误消息

```
rvm --force install 1.9.2
Searching for binary rubies, this might take some time.
No binary rubies available for: osx/10.8/x86_64/ruby-1.9.2-p320.
Continuing with compilation. Please read 'rvm mount' to get more information on binary rubies.
The provided compiler '/usr/bin/gcc' is LLVM based, it is not yet fully supported by ruby and gems, please read `rvm requirements`.
  [1]: http://www.fakingfantastic.com/2010/11/26 /fixing-the-you-have-to-install-development-tools-first-error-with-nokogiri/ 
```

换句话说，它引导我回到同一篇博客文章。

看着RVM网站，我盲目地做了

```
rvm install 1.9.2 
```

我收到了这个错误

未安装 ruby​​-1.9.2-p320。要安装：'rvm install ruby​​-1.9.2-p320'

按照它的说明，我做了 rvm install ruby​​-1.9.2-p320 并得到了相同的二进制文件错误

```
Searching for binary rubies, this might take some time.
No binary rubies available for: osx/10.8/x86_64/ruby-1.9.2-p320.
Continuing with compilation. Please read 'rvm mount' to get more information on binary rubies.
The provided compiler '/usr/bin/gcc' is LLVM based, it is not yet fully supported by ruby and gems, please read `rvm requirements`. 
```

谁能提供一些指导

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-02T00:34:43.867

你需要运行：

```
rvm get head
rvm autolibs enable
rvm use --install 1.9.2
bundle install 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-13T19:19:29.313

首先，在安装好“RVM 要求”和 Ruby 之后，从 Xcode 中安装“命令行工具”。

# mysql - 获取mysql表中不存在的值

> ID：14114980
> 
> 赞同：3
> 
> 时间：2013-01-01T22:53:12.850
> 
> 标签：mysql, sql

我有一组值（键）、1、2、3、4、5 和下表：

```
id key
------
1  2
2  8
3  4 
```

如果我需要检查哪些给定的键在 db 中，我使用：

```
SELECT * 
  FROM mytable 
 WHERE key IN (1,2,3,4,5) 
```

所以我会得到带有键 2 和 4 的行。

是否有某种 mysql 方法可以找出哪些给定键不在数据库中？所以在这种情况下，我想得到 1,3,5。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T23:00:37.550

使用您的密钥创建临时表：

```
CREATE TEMPORARY TABLE mykeys (`key` INT);
INSERT INTO mykeys VALUES (1),(2),(3),(4),(5); 
```

然后使用 NOT IN：

```
SELECT `key`
FROM mykeys
WHERE `key` NOT IN (SELECT `key` FROM mytable) 
```

最后，如果必须，请删除 TEMP 表：

```
DROP TABLE mykeys 
```

**编辑**：添加[了 SQLFiddle](http://www.sqlfiddle.com/#!2/6bfcc/1)。

* * *

如果您使用的是支持[`EXCEPT`operator](http://en.wikipedia.org/wiki/Set_operations_%28SQL%29#EXCEPT_operator)的 PostgreSQL ，并且`VALUES`语句可用于从值列表创建行集，则还有另一种更简单的方法可以在没有临时表 ( [SQLFiddle](http://www.sqlfiddle.com/#!12/eab3a/2) ) 的情况下执行此操作：

```
VALUES (1),(2),(3),(4),(5)
EXCEPT
SELECT key FROM mytable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T22:55:25.507

虽然这是一个非常混乱的解决方案，但它确实有效：

```
select v.val from
(
  select 1 as val
  union
  select 2 as val
  union
  select 3 as val
  union
  select 4 as val
  union
  select 5 as val
) v
WHERE
v.val NOT IN(
  SELECT `key` 
  FROM mytable 
  WHERE key IN (1,2,3,4,5)
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T23:18:00.517

这有点笨拙，但确实有效：

```
select sq.val
from   mytable t
       right join (select 1 as val
                   union 
                   select 2
                   union 
                   select 3
                   union 
                   select 4
                   union 
                   select 5 ) as sq
 on t.col = sq.val
 where t.id is null; 
```

[强制性的 SQL 小提琴。](http://sqlfiddle.com/#!2/4d9bf/2)

# javascript - 使用 Javascript 预加载自定义游标

> ID：14114981
> 
> 赞同：4
> 
> 时间：2013-01-01T22:53:14.347
> 
> 标签：javascript, jquery, cursor, preload

我已经能够在页面加载之前成功预加载图片库，但想知道如何对自定义 cursor.cur 文件执行相同的操作，因为它无法使用下面的图像方法，因为它无法理解 .cur 扩展名？

```
// Image Preloader
var pictures [
    "a.jpg",
    ..
    "z.jpg"
];

for (var i=0;i < pictures.length; i++){
    var img = new Image()
    img.src = pictures[i];
    img.onload = function(){
        updateProgress();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T23:24:44.647

使用 AJAX 加载 ico 文件`.get()`并忽略响应。响应应该缓存在浏览器中。就像是：

```
 $.get('/favicon.ico', function() {
        alert('Loading of ICO file completed!');
        // Do other processing here
    }); 
```

[http://jsfiddle.net/BGG2m/](http://jsfiddle.net/BGG2m/)

# zend-framework - Zend_Cache 与 Memcachier

> ID：14114983
> 
> 赞同：2
> 
> 时间：2013-01-01T22:54:30.973
> 
> 标签：zend-framework, caching, memcached

我可以将 memcachier 与 ZendFramework 1.12 一起使用吗？

我正在使用的提供商（AppFog）仅提供 Memcachier（Memcached 即将在 10 个月后推出）而且我的应用程序在启动时需要大量缓存。我不想坚持使用 APC，所以我没有其他好的选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T01:36:14.073

所以这只是现在的一半答案，我会尝试找出其余的。顺便说一句，我在 MemCachier 工作，所以如果您有更多问题，请发送电子邮件至 support@memcachier.com。

PHP 默认包含两个 memcache 绑定：memcache 和 memcached。第一个 (memcache) 是它自己的 memcache 协议实现，而第二个 (memcached) 是与 libmemcached C++ 库的 php 绑定。

如今，php 的 memcached 绑定确实支持 SASL（从 2.0.0 版开始）。遗憾的是，它没有记录在案。它也是 memcached 模块的可选部分，因此您需要确保它在您的机器（或 AppFog）上编译并启用 SASL 支持。大致做到这一点的步骤是：

1.  安装 libmemcached。我使用的是 1.0.14 版本。
2.  安装 php-memcached。确保在运行 ./configure 时将“--enable-memcached-sasl”选项传递给它。
3.  在构建这两者时，您可以检查“./configure”的输出以确保确实启用了 SASL 支持，遗憾的是现在它可能很棘手。
4.  编辑你的 php.ini 文件。将以下行放入其中：

    ```
    [memcached]
    memcached.use_sasl = 1 
    ```

我使用自制软件在 OSX 10.8 上完成了所有这些工作。如果您是这种情况，则以下内容应该有效：

```
$ brew install libmemcached
$ brew edit php54-memcached 
    // you'll need to add the line: 
       args << "--enable-memcached-sasl"
    // to the brew file.
$ brew install php54-memcached 
```

现在要实际使用 SASL 支持，这里有一个测试文件来演示它并且是一个很好的完整性检查。

```
<?php 
/**
 * Test of the PHP Memcached extension.
 */

error_reporting(E_ALL & ~E_NOTICE); 

$use = ini_get("memcached.use_sasl");
$have = Memcached::HAVE_SASL;
echo "Have SASL? $have\n";
echo "Using SASL? $use\n\n";

$mc = new Memcached(); 

$mc->setOption(Memcached::OPT_BINARY_PROTOCOL, true);

$mc->setSaslAuthData("user-1", "pass");

$mc->addServer("localhost", 11211); 

$mc->set("foo", "Hello!"); 
$mc->set("bar", "Memcached..."); 

$arr = array( 
    $mc->get("foo"), 
      $mc->get("bar") 
    ); 
var_dump($arr); 
?> 
```

我现在还不知道如何让它在 Zend 框架中工作。我不熟悉它，所以可能需要一些时间来安装和弄清楚。尽管考虑到其中一个后端与 SASL auth 一起使用，但这似乎非常可行。

# mysql - Netbeans中从mysql数据库自动生成的实体总是无法部署

> ID：14114984
> 
> 赞同：0
> 
> 时间：2013-01-01T22:54:35.487
> 
> 标签：mysql, jpa-2.0, netbeans-7

我是 Java EE（和 Netbeans）的新手。我试图从我的 mysql 数据库中自动生成实体类......对于简单的关系它可以工作，但对于以下它总是失败：

![在此处输入图像描述](../Images/7217114c9883bd59a39f396180399500.png)

我收到以下错误：

> 内部异常：异常 [EclipseLink-7220]（Eclipse Persistence Services - 2.3.2.v20111125-r10461）：org.eclipse.persistence.exceptions.ValidationException 异常描述：来自实体类的注释元素 [field tblExpandituresTranx] 上的 @JoinColumns [class entity.restaurant.TblContents] 不完整。当源实体类使用复合主键时，必须使用@JoinColumns 为每个连接列指定@JoinColumn。name 和 referencedColumnName 元素都必须在每个这样的 @JoinColumn. 中指定。有关更多详细信息，请参阅 server.log。

我想......我的数据库中有一些错误，或者 EclipseLink JPA 工具可能是错误的！请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:57:52.967

可能是您的架构颠倒了。

或者你实际上可以阅读你得到的异常并弄清楚它告诉你什么：

```
The @JoinColumns on the annotated element [field tblExpandituresTranx] from the entity class [class entities.restaurant.TblContents] is incomplete. When the source entity class uses a composite primary key, a @JoinColumn must be specified for each join column using the @JoinColumns. Both the name and the referencedColumnName elements must be specified in each such @JoinColumn 
```

看起来您的 JOIN 规范不完整。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T02:05:16.520

我自己解决了这个问题......显然JPA在桥表中存在多个主键的问题。因此，我没有将外键作为主键，而是将它们转换为唯一索引，并且一切正常！呜呜！！

# android - Android来电滑块

> ID：14114991
> 
> 赞同：2
> 
> 时间：2013-01-01T22:55:19.027
> 
> 标签：android, call

在 Android 通话屏幕上（至少在 Froyo 上），来电屏幕上有一个我必须称之为滑块的东西，您按住并朝相反方向滑动以显示下一个屏幕。我可以使用此视图吗？我想使用它，但我不确定它叫什么，所以搜索变得困难。我找到了这个链接，但我不知道来电屏幕视图滑块是否直接包含在任何 API 调用中。

[http://www.warriorpoint.com/blog/2009/05/29/android-switching-screens-by-dragging-over-the-touch-screen/](http://www.warriorpoint.com/blog/2009/05/29/android-switching-screens-by-dragging-over-the-touch-screen/)

这是我正在寻找的链接：
[http ://cdn.androidtapp.com/wp-content/uploads/2009/05/lock-20-charging.jpg](http://cdn.androidtapp.com/wp-content/uploads/2009/05/lock-20-charging.jpg)

或 [http://2.bp.blogspot.com/-_jWcJnNOAUI/Tm5​​U4eP5CYI /AAAAAAAAABo/Y9QfRchcJh8/s1600/android.jpg](http://2.bp.blogspot.com/-_jWcJnNOAUI/Tm5U4eP5CYI/AAAAAAAAABo/Y9QfRchcJh8/s1600/android.jpg)

更新：我还找到了我现在认为它称为“滑动标签”的来源 [http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1 /com/android/internal/widget/SlidingTab.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/com/android/internal/widget/SlidingTab.java)

但它看起来并不公开，所以我想这已经解决了，因为我可以在 eclipse 中复制私有源。