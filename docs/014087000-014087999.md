# StackOverflow 问答 14087000-14087999

# java - 如何在 Java 类方法中访问私有变量

> ID：14087002
> 
> 赞同：0
> 
> 时间：2012-12-29T23:49:58.687
> 
> 标签：java, private-members

我正在尝试`x`在我的方法中访问私有变量 ( )，`distanceFromPoint`但它似乎不起作用。我怎样才能访问它？`0.0`无论其他值如何，我的方法都会一直返回。

### 代码

```
public class Pointdeclare {
    private static int x;
    private static int y;

    Pointdeclare (int x_ , int y_ ){
        this.x = x_;
        this.y = y_;
    }

    int getX(){
        return x;
    }

    int getY(){
        return y;
    }

    static double distanceFromZero (){
        return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));
    }

    double distanceFromPoint(Pointdeclare point){
        int distX = point.getX()- this.x;
        int distY = point.getY()- this.y;

        return (double) Math.sqrt(Math.pow(distX, 2) + Math.pow(distY, 2));
    }
} 
```

### 主班

```
public class main {
    static Pointdeclare p1 = new Pointdeclare(6, 7);
    static Pointdeclare p2 = new Pointdeclare(3, 7);

    public static void main (String[] args){
        System.out.println(p2.distanceFromZero());

        System.out.print(p1.distanceFromPoint(p2));
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:57:04.363

这将更适合您：

```
package cruft;

/**
 * Point2 description here
 * @author Michael
 * @link http://stackoverflow.com/questions/14087002/how-to-access-private-variables-in-a-java-class-method
 * @since 12/29/12 6:52 PM
 */
public class Point2 {

    private int x;
    private int y;

    Point2(int x_, int y_) {
        this.x = x_;
        this.y = y_;
    }

    int getX() {
        return x;
    }

    int getY() {
        return y;
    }

    double distanceFromZero() {
        return distanceFromPoint(new Point2(0, 0));
    }

    double distanceFromPoint(Point2 point) {
        int distX = point.getX()-this.x;
        int distY = point.getY()-this.y;

        return (double) Math.sqrt(Math.pow(distX, 2)+Math.pow(distY, 2));
    }

    public static void main(String[] args) {
        Point2 p1 = new Point2(6, 7);
        Point2 p2 = new Point2(3, 7);
        System.out.println(p2.distanceFromZero());
        System.out.print(p1.distanceFromPoint(p2));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:52:11.670

您声明了 "x" 和 "y" `static`，这意味着它们是类变量，而不是实例变量。

因此，每次对构造函数的新调用都会覆盖旧值。因此`distanceFromPoint`总是返回零，因为只有 one`x`和 one `y`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T23:52:40.063

您不应该将您的类字段声明为`static`，而是将它们保留为`private`。

顺便说一句，考虑使用包中的`Point`或`Point2D`本机类`java.awt.geom`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T23:52:50.630

问题不是由于私有，而是由于静态。x 是静态的。在您的方法中，您应该使用 x 作为：

```
int distX = point.getX()- Pointdeclare.x; // You could use this.x because x is static. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-30T00:15:20.100

我希望你觉得这很相关，它不能直接回答你的问题，但我最近被告知我的理解`static`是不正确的，所以刚刚研究了我认为也许我可以提供帮助的主题。`Static`变量属于一个类而不是它的对象，一个类的对象可以访问一个静态变量，但是无论类的对象有多少，静态变量都只会有一个副本。所以我认为我之前的人所说的不是 p1 和 p2 拥有自己的 x 和 y 副本，两个对象共享相同的 x 和 y 字段，因此您返回的值是 0。在其他世界中，您试图找到之间的距离一个位置，它总是为零。希望这会有所帮助:-)。很抱歉我错过了 main 方法的第一行。p2 应该返回一个值，只要它不为零，但 p1 不会。

# maven - 当 IntelliJ '更新' maven repo 时实际上会发生什么？

> ID：14087004
> 
> 赞同：9
> 
> 时间：2012-12-29T23:50:22.003
> 
> 标签：maven, intellij-idea

使用 IntelliJ 12 之后`Settings->Maven->Repositories`，我注意到我的最近没有更新。在我选择了一个 repo 并等待了一两分钟后，它们被更新了。

`IntelliJ's`我想知道，从角度来看，实际上发生了什么？

它是否预先缓存内容？repos 应该多久“更新”一次？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-24T10:17:07.773

IntelliJ IDEA 在用户编辑 pom.xml 时下载 maven 存储库的索引以建议 groupId、artifactId 和 maven artifact 的版本。当我向项目添加新存储库时，我会更新存储库索引。

# mysql - SQL 一对多 LEFT OUTER JOIN：执行 AND 查询

> ID：14087009
> 
> 赞同：2
> 
> 时间：2012-12-29T23:51:16.537
> 
> 标签：mysql, sql

这应该很常见，我正在寻找在一个 SQL 查询（MySQL）中执行此操作的“最佳”方式。

我有三张桌子，一张`items`桌子，一张`linker`桌子，一张`tags`桌子。项目可以被标记多次，因此链接器是一个简单的外键链接器表：

```
items   | linker  | tags  
--------+---------+-------
item_id | item_id | tag_id
...     | tag_id  | name  
--------+---------+------- 
```

我可以`items`轻松搜索单个标签，我将如何搜索具有 2 个或更多特定标签的项目？

```
SELECT *, `tags`.`name`
FROM `items`
LEFT OUTER JOIN `linker` USING (`item_id`)
LEFT OUTER JOIN `tags` USING (`tag_id`)
WHERE `tags`.`name` = "tag-a" 
```

一个理智的人如何搜索 2 个或更多标签，一个项目必须具有所有标签，即`AND`查询？

* * *

编辑：到目前为止，我所拥有的是以下内容，它有效并且似乎并不慢，但看起来很疯狂：

```
SELECT `items`.* FROM `items`
LEFT OUTER JOIN `linker` USING (`item_id`)
LEFT OUTER JOIN `tags` USING (`tag_id`)
WHERE (
        `item_id` IN (SELECT item_id FROM linker LEFT JOIN tags USING (tag_id) WHERE name = "tag-a")
    AND `item_id` IN (SELECT item_id FROM linker LEFT JOIN tags USING (tag_id) WHERE name = "tag-b")
    AND `item_id` IN (SELECT item_id FROM linker LEFT JOIN tags USING (tag_id) WHERE name = "tag-c")
    AND `item_stuff` = "whatever"
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:31:41.087

假设链接器表的 PK 是 (item_id,tag_id)，我将使用以下内容：

```
select *
  from items
  where item_id in (
    select item_id
      from linker
      join tags using(tag_id)
     where name in ('tag1', 'tag2', 'tag3')
     group by item_id
     having count(tag_id)=3
  )
; 
```

上面的查询应该很容易维护。您可以轻松添加或减去所需的标签名称。您只需要确保拥有计数与列表中的名称数量相匹配。

如果链接器表 PK 不是 (item_id,tag_id)，则 having 子句必须更改为`having count(distinct tag_id)=3`，尽管该查询可能不会执行得那么好，这取决于存在多少重复 (item_id,tag_id) 对。

关于上述内容的另一个不错的功能是您可以轻松回答问题，例如哪些项目与以下标签列表中的至少 2 个相关联（'tag1'、'tag2'、'tag3'）。您只需将拥有计数设置为正确的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T01:06:57.090

要重申您的问题，您希望表`items`中的所有列都包含`tags`某个列表中的所有列，对吗？如果是这样，我认为您需要为每个人加入您的`tags`表格并使用 a`INNER JOIN`而不是 a `LEFT OUTER JOIN`。像这样的东西：

```
SELECT DISTINCT `items`.* 
FROM   `items` a
JOIN   `linker` b 
ON     b.item_id=a.item_id

JOIN   `tags` c1
ON     c1.tag_id=b.tag_id
   and c1.name = "tag-a"

JOIN   `tags` c2
ON     c2.tag_id=b.tag_id
   and c2.name = "tag-a"

JOIN   `tags` c3
ON     c3.tag_id=b.tag_id
   and c3.name = "tag-c" 
```

使用 an`INNER JOIN`将仅选择具有所有三个标签的行。我不确定您将如何使用可变数量的标签来做到这一点（我认为这是您真正想要的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T01:20:25.570

当然这已经被问过了：[How to filter SQL results in a has-many-through relationship](https://stackoverflow.com/questions/7364969/how-to-filter-sql-results-in-a-has-many-through-relation)

原来我的临时解决方案是最快的解决方案之一（链接问题中的第 4 位），这里是：

```
SELECT *
FROM `items`
WHERE (
        `item_id` IN (SELECT item_id FROM linker INNER JOIN tags USING (tag_id) WHERE name = "tag-a")
    AND `item_id` IN (SELECT item_id FROM linker INNER JOIN tags USING (tag_id) WHERE name = "tag-b")
    AND `item_id` IN (SELECT item_id FROM linker INNER JOIN tags USING (tag_id) WHERE name = "tag-c")
    AND `item_stuff` = "whatever"
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T00:00:36.187

如果我理解正确（我不确定我是否理解 :) ...），您想要查找包含某个字符串的结果（如正则表达式搜索）。

你可以试试这个`RLIKE`功能

```
SELECT *, `tags`.`name`
FROM `items`
LEFT OUTER JOIN `linker` USING (`item_id`)
LEFT OUTER JOIN `tags` USING (`tag_id`)
WHERE `tags`.`name` RLIKE("tag-a"|"tag-b") 
```

我想这就是你的意思，但也许不是：

[http://dev.mysql.com/doc/refman/5.0/en/regexp.html](http://dev.mysql.com/doc/refman/5.0/en/regexp.html)

* * *

或者，如果每个条目只有一个标签，那么使用`IN`：

```
SELECT *, `tags`.`name`
FROM `items`
LEFT OUTER JOIN `linker` USING (`item_id`)
LEFT OUTER JOIN `tags` USING (`tag_id`)
WHERE `tags`.`name` IN ("tag-a","tag-b") 
```

[http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_in](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_in)

* * *

为什么不只是一个基本的`OR`

```
 WHERE `tags`.`name` = "tag-a" OR `tags`.`name` = "tag-b" 
```

我希望我能正确理解你的目标，如果我不明白，请告诉我。

**编辑**我误读了你问题的一部分......我可能不理智，但希望这不会取消我的资格：P

# python - 从隐藏目录（包）导入模块

> ID：14087011
> 
> 赞同：3
> 
> 时间：2012-12-29T23:51:33.090
> 
> 标签：python, import, module, hidden

我最近将一个 Django 项目从 sqlite3 切换到了 postgres。我想从放置在隐藏目录中的模块中读取数据库密码。

```
.secrets
    __init__.py
    db.py # DB_PASSWORD = 'mypassword' 
```

如何从隐藏的 .secrets 目录中的 db 模块导入 DB_PASSWORD？以下不起作用（ImportError）：

```
from .secrets.db import DB_PASSWORD 
```

我必须使用这个`__import__`技巧吗？对于代码样式约定，我更喜欢使用 from/import 模式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T00:05:04.010

从 PEP 328，[http:](http://www.python.org/dev/peps/pep-0328/#rationale-for-relative-imports) //www.python.org/dev/peps/pep-0328/#rationale-for-relative-imports你**实际上应该避免命名以“点”开头的 python 模块，**因为它意味着相对导入Python。

如果你真的坚持这样做，你可以，但你必须使用该`imp`模块。

示例用法：-

```
import imp
with open('.secret/__init__.py', 'rb') as fp:
    secret = imp.load_module('.secret', fp, '.secret/__init__.py', \
    ('.py', 'rb', imp.PY_SOURCE)) 
```

因此，对于您要从中加载值的用例`db.py`，它看起来像这样：-

```
import imp
with open('.secret/db.py', 'rb') as fp:
    db = imp.load_module('.secret', fp, '.secret/db.py', \
    ('.py', 'rb', imp.PY_SOURCE))  

print db.DB_PASSWORD  # This will print out your DB_PASSWORD's value. Or use it whichever way you want. 
```

虽然不会建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T00:04:12.337

在 Python 中，`from .module import something`语法[用于相对导入](http://www.python.org/dev/peps/pep-0328/#guido-s-decision)。

因此，如果您尝试在包名称中使用前导点，Python 会感到困惑并尝试相对导入，这将失败。

在相关的说明中，做`import .module`实际上是`SyntaxError`

* * *

我不认为这很糟糕。只需将您的秘密存储在其他地方并将其添加到您的路径中，或者将其放入您可以打开的文件中（例如，JSON 配置文件）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T00:07:31.560

您应该将其设为`db.py`配置文件并使用[configparser](http://docs.python.org/3/library/configparser.html)加载它。或者您可以将其存储为 JSON 文件并使用[json](http://docs.python.org/3/library/json.html)加载，或者将其存储为 YAML 并使用[PyYAML](http://pyyaml.org/)加载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T00:14:39.343

[我在Python 参考](http://docs.python.org/2/reference/simple_stmts.html#the-import-statement)中找到了正式的答案。

`from`表格是：

```
"from" relative_module "import" identifier ["as" name] ( "," identifier ["as" name] )* 
```

或者

```
"from" module "import" "*" 
```

在第一种形式中，点与“隐藏包”的错误概念无关，它指的是相对导入（如 Thomas Orozco 所述）。在第二种形式中，模块定义如下：

```
module ::=  (identifier ".")* identifier 
```

并且标识符[**必须**以字母开头](http://docs.python.org/2/reference/lexical_analysis.html#grammar-token-identifier)。

正如您所建议的，我将使用外部配置文件，而不是 Python 代码。

# c# - 属性构造函数与范围声明

> ID：14087012
> 
> 赞同：1
> 
> 时间：2012-12-29T23:51:45.160
> 
> 标签：c#

我正在 WCF 中创建一个双工合同，并且正在关注如何正确构建的教程。在声明我的客户端服务回调接口实例时，我最初声明了实例属性，`private readonly`如下所示：

```
private readonly IEventServiceCallback Callback = OperationContext.Current.GetCallbackChannel<IEventServiceCallback>(); 
```

但是在查看 MSDN 示例时，接口引用是通过 getter 语法定义的，如下所示：

```
IEventServiceCallback Callback
    {
        get
        {
            return OperationContext.Current.GetCallbackChannel<IEventServiceCallback>();
        }
    } 
```

我只是好奇是否真的有理由做一种方式而不是另一种方式，或者这只是个人喜好？对于任何反馈，我们都表示感谢。

# scala - Scala for-comprehensions 中 val 的作用域规则是什么

> ID：14087014
> 
> 赞同：6
> 
> 时间：2012-12-29T23:52:09.843
> 
> 标签：scala, for-comprehension

当我在理解中使用 val 时，我收到警告：

> 警告：不推荐使用用于理解的 val 关键字

尽管在规范的语法附录中产生。

这表明当我做类似的事情时

```
for (x <- xs; a = x) 
```

我并没有真正引入变量，例如如果我做类似的事情

```
for (x <- xs) yield { implicit val a = x; /* more */ } 
```

像往常一样，大括号开始一个新的范围，我可以在其中引入一个新的 val，甚至是一个新的隐式。

我到底在做什么`a`？

我在消耗堆栈空间吗？堆？其他类型的别名？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T23:52:09.843

就像一个普通的`val pat = expr`定义一样，等号左边的东西只是一个模式。

语法规范中的 Enumerator 产生式表明 for-expr 中的子句可以是 generator `(a <- b)`、 guard`if cond`或 val def `a = b`。

可以是任意表达式的部分是（在and`b`的右侧给出）和条件。`<-``=`

`Responder.exec`利用条件来执行任意代码，同时对`true`.

这意味着您可以从条件中执行任意副作用：

```
// yucky, yet instructive
scala> val xs = List(1,2,3)
scala> def bar(implicit i: Int) = Some(i+1)
scala> implicit var imp: Int = 0
scala> for { a<-xs; if { imp=a; true }; b<-bar } yield b
res6: List[Int] = List(2, 3, 4) 
```

同样，val def 脱糖如下：

```
tmp <- xs
a = f(tmp)  // some arbitrary function of tmp
// amounts to
(tmp, a) <- for (x@tmp <- xs) yield { val x0@a=f(tmp); (x, x0) } 
```

等等，真的吗？

```
scala> def f(vs: List[Int]) = for (a <- vs; b = a+1) yield b
f: (vs: List[Int])List[Int] 
```

您需要最近的 repl 才能执行此操作：

```
scala> :javap f
[snip]
  public scala.collection.immutable.List<java.lang.Object> f(scala.collection.immutable.List<java.lang.Object>);
    flags: ACC_PUBLIC

    Code:
      stack=3, locals=2, args_size=2
         0: aload_1       
         1: new           #16                 // class $anonfun$f$1
         4: dup           
         5: invokespecial #17                 // Method $anonfun$f$1."<init>":()V
         8: getstatic     #22                 // Field scala/collection/immutable/List$.MODULE$:Lscala/collection/immutable/List$;
        11: invokevirtual #26                 // Method scala/collection/immutable/List$.canBuildFrom:()Lscala/collection/generic/CanBuildFrom;
        14: invokeinterface #32,  3           // InterfaceMethod scala/collection/TraversableLike.map:(Lscala/Function1;Lscala/collection/generic/CanBuildFrom;)Ljava/lang/Object;
        19: checkcast     #28                 // class scala/collection/TraversableLike
        22: new           #34                 // class $anonfun$f$2
        25: dup           
        26: invokespecial #35                 // Method $anonfun$f$2."<init>":()V
        29: getstatic     #22                 // Field scala/collection/immutable/List$.MODULE$:Lscala/collection/immutable/List$;
        32: invokevirtual #26                 // Method scala/collection/immutable/List$.canBuildFrom:()Lscala/collection/generic/CanBuildFrom;
        35: invokeinterface #32,  3           // InterfaceMethod scala/collection/TraversableLike.map:(Lscala/Function1;Lscala/collection/generic/CanBuildFrom;)Ljava/lang/Object;
        40: checkcast     #37                 // class scala/collection/immutable/List
        43: areturn 
```

我看到两次 map 调用，用于中间表达式和 yield。

进一步检查，第一个 anonfun 不是 a `Int => Int`(ie, `a+1`) 而是 a `Int => (Int,Int)`。

所以我们介绍的 val 只是作为元组的一部分传递。

# android - 安卓 sqlite 不在

> ID：14087023
> 
> 赞同：1
> 
> 时间：2012-12-29T23:52:30.323
> 
> 标签：android, sqlite, android-sqlite

我有方案 1 的数据库。_id 2。字

我有 ArrayList，例如 5 个单词（a1、a2、a3、a4、a5）

构造查询以从 DB 中获取不包含 ArrayList 中单词的单词的最佳方法是什么？

像播种一样

> Select * from MYTABLE where WORD not in "all words from ArrayList"

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T23:58:39.420

构建一个表示单词集的字符串，并将其用作查询的参数。

```
StringBuilder wordSet = new StringBuilder();
wordSet.append('(');
for( String word : wordsList )
{
    if(wordSet.length() > 1)
        wordSet.append(',');
    wordSet.append(word);
}
wordSet.append(')'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:03:01.650

伪查询

从 mytable 中选择 *

对包含数组列表 [http://en.wikipedia.org/wiki/Set_operations_(SQL)#EXCEPT_operator中的单词的选择使用 except 运算符](http://en.wikipedia.org/wiki/Set_operations_(SQL)#EXCEPT_operator)

# javascript - 使用原型调用方法

> ID：14087030
> 
> 赞同：1
> 
> 时间：2012-12-29T23:53:55.353
> 
> 标签：javascript

```
<script>     
  var Kevin = function(){   
       this.name = 'kevin'
  }          
  Kevin.prototype.getKevin = function(){          
       alert(this.name);        
  }            
  Kevin.prototype.getKevin();

  function John(){
     this.name = 'john'
  }      
  John.getStaticJohn = function(){
     alert(this.name);    
  }

  John.prototype.getJohn();
  John.getStaticJohn();

</script> 
```

1.  为什么在使用原型调用方法时我会遇到`undefined`这两种情况。
2.  当我尝试在 John 类中调用静态方法时，它会完美地打印输出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T23:55:05.590

如果要从构造函数中调用方法，则需要创建一个匿名实例：

```
(new Kevin).getKevin(); // or new Kevin().getKevin() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T23:55:44.220

你得到`undefined`是因为原型没有“名称”属性。另请注意，您对“getStaticJohn()”的调用实际上并不能“完美运行”——它用大写的“J”警告“John”，因为它正在访问函数对象“John”的“name”属性。

当您通过表单的表达式调用方法时，函数内部的`something.functionName`值`this`将始终是 的值`something`。因此，当你打电话

```
John.prototype.getJohn(); 
```

`this`“getJohn()”函数内部的值将是`John.prototype`，而不是由“John()”构造函数构造的任何实例。

如果你添加这个：

```
John.prototype.name = "John's prototype"; 
```

那么您的呼叫`John.prototype.getJohn()`将提醒除`undefined`.

# javascript - jQuery Mobile "enhance" dynamically re-generated html

> ID：14087032
> 
> 赞同：4
> 
> 时间：2012-12-29T23:54:12.880
> 
> 标签：javascript, jquery-mobile

jQuery Mobile 1.2.0

I generate the HTML using JavaScript (`$(selector).html(content)`), add it to the DOM and then display it (`$.mobile.changePage()`).

Then I invoke an AJAX call, get some data, and re-generate the html (but the parent element, the same `$(selector)`, stays the same, I just change its `html(...)`).
**At this poing the HTML is not "enhanced" by jQM, no styling applied on it.**

Now according to the [docs](http://jquerymobile.com/demos/1.0rc2/docs/pages/page-scripting.html) I should simply call the `page()` function on the parent element, i.e `$(selector).page()`.

Other places in the docs suggest triggering the `create` event, i.e `$(selector).trigger("create")`.

The problem is that non of the above two methods works - the styling of jQM is not applied.

Looking at the code of jQM, **I've tried triggering the `pagecreate` event on that element and it does work**, but, this is not documented anywhere, so I'm uncertain of it, especially concerning future releases of jQM.

At some poing in the docs I've read that I can call `page()` on a page only once..

Anyway, is there any concise/standard way to tell jQM to "enhance" the whole element and its child-elements? Or should I simply stay with triggering the `pagecreate` event?

Thank you!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:10:31.417

$(selector).trigger("create"); 的作用域是什么？

您应该能够在 'pageshow' jqm 样式应用于元素之前的 'pagecreate' 事件上添加任何元素。例如，我像这样动态添加页眉/页脚

```
$(document).on('pagecreate', "[data-role=page]", function() {

var header = "<div data-role='header'>some header stuff</div>";
 var footer= "<div data-role='footer'>some footer stuff</div>";

$(this).prepend(header);
$(this).append(footer);

$("[data-role=header]").fixedtoolbar({tapToggle: false});
$("[data-role=footer]").fixedtoolbar({tapToggle: false});

}); 
```

确保您使用的是 jquery 1.7 或更高版本，我认为那是引入 on 方法的时候；

听起来您可能正在生成 DOM 然后更改页面，反之尝试先转到页面然后动态编辑 dom。

编辑将重新加载页面选项设置为 true

```
 $.mobile.changePage($(page), {reloadPage: true}); 
```

编辑 2

```
$(selector).children().each(function(){
   $(this).trigger('create');
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T00:04:23.417

要重新创建整个页面，请使用：

```
$(selector).trigger("pagecreate"); 
```

这是我对类似问题的回答：[https](https://stackoverflow.com/a/14011070/1848600) ://stackoverflow.com/a/14011070/1848600 。有一个页面重建的例子。看一下，这应该可以解决你的问题。

# php - Trying to populate second dropdown menu from first dropdown menu php mysql

> ID：14087034
> 
> 赞同：0
> 
> 时间：2012-12-29T23:54:19.290
> 
> 标签：php, javascript, mysql, ajax

I am trying to populate 3 menus, 1st menu is created from mysql query and php and displays TVshows ( ie. Modern Family, Dexter, etc ), what I would like to do is once the TVShow is selected populate the next drop down with a new mysql query for seasons ( 1 ,2 ,3 etc.) , then populate a 3rd drop down via mysql query based off the first 2 options being selected for episode

The table is as follows | id | Title | Season | Episode | Extension | URL

I can get the first drop down to display with the following code

```
<?php
$sql="Select distinct title from TVShows";
$result=mysql_query($sql);

echo "<select name='TVShow'><option value=''>Select TV Show</option>";
while($row = mysql_fetch_array($result))
{
echo    "<option value=$row[title]>$row[title]</option>";
}
echo "</select>";
?> 
```

I have tried many examples but none seem to work right, I would like to be able to do this on the same page as opposed to having the user click submit to go to another page to select the second drop down.

I would like code to dynamically setup the 2nd dropdown based on the first choice, then dynamically setup the 3rd dropdown based on the 1st and second dropdowns

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:55:49.137

`mysql_fetch_array` does not fetch an associative array.

Try using `mysql_fetch_assoc` instead

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-28T23:40:31.007

为了在用户端获得更好的性能，您可以考虑从数据库加载所有结果（然后理想地缓存它们），然后使用 javascript 隐藏和显示适当的结果。

这样，如果用户经常单击您的菜单，您就不会对数据库进行大量不必要的往返。

# algorithm - 采样信号的相似度算法（数学）

> ID：14087045
> 
> 赞同：1
> 
> 时间：2012-12-29T23:55:47.920
> 
> 标签：algorithm, math, vectorization, som, self-organizing-maps

假设我已经对一些信号进行了采样，并为每个信号构建了一个样本向量。计算这些向量的（不）相似度的最有效方法是什么？请注意，采样的偏移量不得计算在内，例如 sin 和 cos 信号的采样向量应该被认为是相似的，因为它们在顺序上是完全相同的。

有一种简单的方法是通过“滚动”另一个向量的单位，计算每个滚动点的欧几里得距离并最终选择最佳匹配（最小距离）。这个解决方案工作得很好，因为我唯一的目标是从向量池中找到输入信号最相似的样本向量。

但是，当向量的维数增长时，上述解决方案也非常低效。与 N 维向量的“非序列向量匹配”相比，序列向量的计算距离要多 N 倍。

是否有任何更高/更好的数学/算法来比较具有不同偏移量的两个序列？

用例是使用 SOM 进行序列相似性可视化。

**编辑：**比较每个向量的积分和熵怎么样？它们都是“序列安全的”（= 时不变的？）并且计算速度非常快，但我怀疑它们本身是否足以区分所有可能的信号。除了这些，还有其他东西可以使用吗？

**EDIT2：** Victor Zamanian 的回复不是直接的答案，但它给了我一个可能的想法。解决方案可能是通过计算它们的傅里叶变换系数并将它们插入到样本向量中来对原始信号进行采样。第一个元素 (X_0) 是信号的平均值或“水平”，随后的 (X_n) 可直接用于比较与其他样本向量的相似性。n 越小，它对相似性计算的影响就越大，因为用 FT 计算的系数越多，FT 信号的表示就越准确。这带来了一个**额外的问题：**

假设我们有 FT-6 采样向量（值刚刚从天而降）

*   X = {4, 15, 10, 8, 11, 7}
*   Y = {4, 16, 9, 15, 62, 7}

这些向量的相似度值可以这样计算：|16-15| + (|10 - 9| **/ 2** ) + (|8 - 15| **/ 3** ) + (|11-62| **/ 4** ) + (|7-7| **/ 5** )

那些加粗的是奖金问题。是否有一些系数/其他方式可以知道每个 FT 系数对与其他系数的相似性有多大影响？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:07:16.373

如果我正确理解您的问题，也许您会对某种类型的[互相关](http://en.wikipedia.org/wiki/Cross-correlation)实现感兴趣？我不确定这是否是最有效的事情或是否符合目的，但我想我会提到它，因为它似乎相关。

*编辑*：也许可以选择[快速傅立叶变换（FFT）](http://en.wikipedia.org/wiki/Fast_Fourier_transform)？傅里叶变换非常适合区分信号，我相信也有助于找到相似的信号。例如，正弦波和余弦波在实平面上是相同的，只是具有不同的虚部（相位）。FFT 可以在 O(N log N) 内完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T00:37:33.850

谷歌“翻译不变信号分类”，你会找到[类似](http://jacr.iausari.ac.ir/NO%201/4_Doc3.pdf) [的](http://harmony.cs.pusan.ac.kr/lecture/lecture_data/09_A%20Translation%20and%20Scale-Invariant%20Adaptive%20Wavelet%20Transform.pdf)东西。

# ios - 在 Xcode 4.5 中打开 Google+ 应用程序

> ID：14087047
> 
> 赞同：2
> 
> 时间：2012-12-29T23:56:18.013
> 
> 标签：ios, ios-simulator, social-networking, xcode4.5, google-plus

我制作了一个需要 Google+ 的社交应用程序。我知道我可以打开 Google+ 作为 Safari 的链接（这对于用户来说并不友好，必须切换应用程序只是为了发布一些东西）。此代码打开到 Safari 的链接：

```
 -(IBAction)Google+:(id)sender  {  
            NSLog(@"Google+");
        //The link will go to Stack Overflow Google+ Page
        NSURL *GooglePlus = [NSURL URLWithString:@"https://plus.google.com/+StackExchange/posts"];
           [[UIApplication sharedApplication] openURL:GooglePlus];        
 } 
```

但是有没有办法检测是否安装了 Google+ 应用程序并在那里打开应用程序（如果没有，则打开到 Safari 的链接）。我感谢所有花时间阅读我的帖子的人（即使你没有）:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-06T13:14:29.343

现在您可以使用下一个协议启动 Google+ 应用：

```
gplus:// 
```

例如

> [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"gplus://"]];

**UPD：** 因此，要在 G+ 应用程序中启动任何页面，您只需在 gplus:// 的 URL 中更改 https://，例如这将启动用户配置文件：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"gplus://plus.google.com/u/0/105819873801211194735/"]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T00:07:50.913

根据这篇[文章](https://stackoverflow.com/questions/419119/launch-an-app-from-within-another-iphone)，不可能在另一个应用程序中运行一个应用程序，但可以启动任何注册了`URL Scheme`. 您应该检查`Google+ Application`.

**编辑** Google+ 似乎不在[列表中](http://wiki.akosma.com/IPhone_URL_Schemes):-(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-23T15:36:32.633

在 Xcode 6 和 Swift 中，您可以编写：

```
 let gplusURL = "gplus://your url"    
                if UIApplication.sharedApplication().canOpenURL(NSURL.URLWithString(gplusURL)){
                   UIApplication.sharedApplication().openURL(NSURL.URLWithString(gplusURL))
                }
                else{
                        var alertView = UIAlertView()
                        alertView.addButtonWithTitle("OK")
                        alertView.title = "HEY"
                        alertView.message = "It seems Google Plus is not installed on your device"
                        alertView.delegate = self
                        alertView.show() 
```

# java - 如何从拦截器发送响应并停止进一步执行？

> ID：14087049
> 
> 赞同：12
> 
> 时间：2012-12-29T23:56:42.070
> 
> 标签：java, spring, spring-mvc, interceptor

我有一个拦截器，在某种情况下，我想向浏览器发送一个字符串响应，然后完全停止执行。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-30T00:01:20.930

如果要停止执行，请覆盖 preHandle 方法并返回 false。

```
@Override
public boolean preHandle(HttpServletRequest request,
        HttpServletResponse response, Object handler) throws Exception {
    response.getWriter().write("something");
    return false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-03-24T19:33:50.590

您可以这样做，这将向客户端返回 json 响应

```
@Override
public boolean preHandle(HttpServletRequest request,
        HttpServletResponse response, Object handler) throws Exception {
    response.getWriter().write("{ \"error_description\": \"Invalid Value\"}");
    response.setContentType("application/json");
    response.setCharacterEncoding("UTF-8");
    response.setStatus(400);
    return false;
} 
```

# c# - 使用 GDI+ 在表单外渲染图形

> ID：14087051
> 
> 赞同：2
> 
> 时间：2012-12-29T23:56:59.930
> 
> 标签：c#, winforms, gdi+

我目前正在使用 GDI+ 制作游戏，我知道这不是开发游戏的最佳解决方案，但由于它是一个学校项目，我别无选择。

大约每运行一次游戏，图形就会呈现在屏幕左上角的表单之外。

如果这有助于缩小问题范围，我正在使用双缓冲。

渲染代码如下所示：

```
while (true)
{       
    // Create buffer if it don't exist already
    if (context == null)
    {
        context = BufferedGraphicsManager.Current;
        this.buffer = context.Allocate(CreateGraphics(), this.DisplayRectangle);
    }

    // Clear the screen with the forms back color
    this.buffer.Graphics.Clear(this.BackColor);

    // Stuff is written to the buffer here, example of drawing a game object:
    this.buffer.Graphics.DrawImage(
        image: SpriteSheet,
        destRect: new Rectangle(
            this.Position.X
            this.Position.Y
            this.SpriteSheetSource.Width,
            this.SpriteSheetSource.Height),
        srcX: this.SpriteSheetSource.X,
        srcY: this.SpriteSheetSource.Y,
        srcWidth: this.SpriteSheetSource.Width,
        srcHeight: this.SpriteSheetSource.Height,
        srcUnit: GraphicsUnit.Pixel);

    // Transfer buffer to display - aka back/front buffer swapping 
    this.buffer.Render();
} 
```

用截图更容易解释：

![游戏 gfx 外赢形式问题](../Images/8310df366fcb2601a153aa0f729f26f0.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T18:15:32.870

在 Winforms 中将 BufferedGraphicsXxx 类公开是一个设计错误。它们是 Winforms 中双缓冲支持的一个实现细节，并且它们对于错误使用它们并不是非常有弹性。

您肯定使用的是从 Allocate() 错误返回的 BufferedGraphics。您在游戏循环中以高速率创建缓冲区。但是您忘记在循环结束时处理您使用的缓冲区。这将以高速率消耗设备上下文 (HDC)。这不会永远持续下去，如果你的程序没有让垃圾收集器运行，那么 Windows 会拔掉插头，不会让你创建新的设备上下文。内部 CreateCompatibleDC() 调用将失败并返回 NULL。否则 BufferedGraphicsContext 类会错过检查此错误的代码并继续使用 NULL 句柄。并开始绘制到桌面窗口而不是窗体。

一个解决方法是将 Allocate() 调用移到循环之外，这样您只需执行一次。但是现在当用户更改窗口大小时，您将遇到一个新问题，缓冲区不再是正确的大小。

更好的捕鼠器是不使用 BufferedGraphics 类，而是将其留给 Winforms 来解决。在 Winforms 中获得游戏循环的方法有多种，但最简单的一种是使用 OnPaint() 方法渲染场景并立即请求另一个绘制，这样它就会不断地被一遍又一遍地调用。与此类似：

```
public partial class Form1 : Form {
    public Form1() {
        InitializeComponent();
        this.DoubleBuffered = true;
        this.ResizeRedraw = true;
    }
    protected override void OnPaint(PaintEventArgs e) {
        RenderScene(e.Graphics);
        this.Invalidate();
    }
} 
```

RenderScene() 应该使用传递的 Graphics 实例绘制游戏对象。请注意，您不再需要使用 Clear()，这已经完成了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T17:26:17.073

> 大约每运行一次游戏，图形就会呈现在屏幕左上角的表单之外。

从屏幕截图和您的描述中，您偶尔会绘制到 Window 的桌面设备上下文 (DC)；这是在获取 DC 时使用零窗口句柄 (IntPtr.Zero) 的效果。这使我相信您可能在创建表单窗口之前开始游戏循环，从而导致图形上下文指向零窗口句柄。

正如评论中所确认的那样，您正在为您的游戏循环使用单独的线程，从而导致这种情况发生的随机行为。一旦处理线程，在启动和完成线程的时间（尤其是当线程可以通过多核/cpu 计算机并行运行时）时，您并不总是两次得到相同的结果。每次运行游戏应用程序时，游戏循环线程都有可能在 UI 线程上的窗体窗口被创建和显示之前启动并执行。

# java - android phonegap 科尔多瓦 webview 事件

> ID：14087053
> 
> 赞同：4
> 
> 时间：2012-12-29T23:57:24.703
> 
> 标签：java, android, cordova

在我的代码中，我正确地使用了 webview 并处理了 onPageFinished 和 shouldOverrideUrlLoading 事件。现在我将它重新定义为 DroidGap 以处理它的功能。然后我应该继续拦截这些事件，因为如果我覆盖它，phonegap 函数将不再执行（就像我在 iOS 上所做的那样）！如何嵌入它并处理描述的事件？谢谢你

```
public class webPush extends Activity implements CordovaInterface{ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T07:56:21.003

嵌入Webview我们基本上可以这样做

```
public class CordovaViewTestActivity extends Activity implements CordovaInterface {
    CordovaWebView cwv;
    /* Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        cwv = (CordovaWebView) findViewById(R.id.tutorialView);
        cwv.loadUrl("file:///android_asset/www/index.html");
    } 
```

如果您仍然收到错误，请将您的代码与 logcat 输出一起发布，这将很容易解决问题..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T16:49:50.653

您无需将其重新定义为 DroidGap。您可以使用 CordovaInterface 使用您自己的实现，只需从 DroidGap java 类中复制您需要的函数。这样您就可以编辑现有代码或添加自己的代码。

这是官方PhoneGap文档所说的：

> 修改您的活动，使其实现 CordovaInterface。建议您实现包含的方法。您可能希望从 /framework/src/org/apache/cordova/DroidGap.java 复制方法，或者您可能希望实现自己的方法

[在 Android 上嵌入 Cordova WebView](http://docs.phonegap.com/en/2.3.0/guide_cordova-webview_android.md.html#Embedding%20Cordova%20WebView%20on%20Android)

# c++ - strcmp() 和 strcoll() 有什么区别？

> ID：14087062
> 
> 赞同：12
> 
> 时间：2012-12-29T23:59:24.180
> 
> 标签：c++, c, string, locale

我试着理解他们两个，但我没有发现任何差异，除了`strcoll()` [这个](http://en.cppreference.com/w/c/string/byte/strcoll)参考说它

> 根据 LC_COLLATE 类别定义的当前语言环境比较两个以空字符结尾的字符串。

第二个想法，我知道我在问另一个问题以获得详细答案，对于 C 和 C++，这个语言环境到底是什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-30T00:14:30.523

`strcmp()`一个接一个地获取字符串的字节并将它们与字节进行比较。

`strcoll()`获取字节，使用语言环境转换它们，然后比较结果。转换根据语言重新排序。在法语中，重音字母在非重音字母之后。所以**é**在**e**之后。但是，**é**在**f**之前。`strcoll()`做对了。`strcmp()`不太好。

但是，在许多情况下`strcmp()`就足够了，因为您不需要显示以使用的语言（区域设置）排序的结果。例如，如果您只需要快速访问由字符串索引的大量数据，您将使用由该字符串索引的地图。`strcoll()`对那些通常非常慢的使用进行排序可能完全没用（`strcmp()`至少与此相比。）

有关字符的详细信息，您可能还需要查看[Unicode](http://unicode.org/)网站。

关于语言环境，它是语言。默认情况下，它设置为“C”（或多或少，没有语言环境）。选择位置后，将相应地设置区域设置。您还可以设置 LC_LOCALE 环境变量。实际上有很多这样的变数。但一般来说，您使用预定义的函数会自动考虑这些变量并为您做正确的事情。（即格式化日期/时间、格式化数字/度量、计算大写/小写等）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-31T14:05:47.743

由于某种原因，在我测试的所有 unicode 语言环境中，在几个不同版本的 glibc 上，strcoll() 对任何两个平假名都返回零。这会破坏**sort**、**uniq**以及以某种方式与字符串顺序交互的所有内容。

> $ echo -e -n 'い\nろ\nは\nに\nほ\nへ\nと\n' | 排序 | 独特的
> 
> い</p>

这简直是​​坏了，无法修复。世界不同地方的人可能对“い”应该放在“ろ”之前还是之后有不同的想法，但没有理智的人会认为它们是相同的。

不，将您的语言环境设置为日语并不重要：

> $ LC_ALL=ja_JP.utf8 LANG=ja_JP.utf8 LC_COLLATE=ja_JP.utf8 echo -e -n 'い\nろ\nは\nに\nほ\nへ\nと\n' | 排序 | 独特的
> 
> い</p>

There was discussion in some official mailing list, but guess what, it was in 2002 and it was never fixed because people don't care: [https://www.mail-archive.com/linux-utf8@nl.linux.org/msg02658.html](https://www.mail-archive.com/linux-utf8@nl.linux.org/msg02658.html)

That bug happened to us in some day and in the end our only way out was to set the collate locale to "C" and rely on the nice properties of utf-8 encoding. That's a horrible experience, since one shouldn't really work under "C" locale when processing all-Japanese data.

So for your sanity's sake, do NOT directly use strcoll. A safer variant might be:

```
int safe_strcoll(const char *a, const char *b)
{
  int ret = strcoll(a, b);
  if (ret != 0) return ret;
  return strcmp(a, b);
} 
```

just in case strcoll() decides to screw you...

EDIT: I just repeated the experiment out of curiosity, and my current system (with glibc 2.29) works without problems now. Locale doesn't matter either.

# ios - 为什么发送 addTarget 方法有 : 才能工作

> ID：14087065
> 
> 赞同：1
> 
> 时间：2012-12-29T23:59:50.323
> 
> 标签：ios, uibutton

希望有人能帮助我解释为什么我应该添加一个 : 来调用该方法。

这是 viewDidLoad 方法

```
- (void)viewDidLoad
{
[super viewDidLoad];
self.view.backgroundColor= [UIColor yellowColor];
//Add Button
CGRect buttonRect= CGRectMake(100, 100, 100, 44);
UIButton *clickButton=[UIButton buttonWithType:UIButtonTypeRoundedRect];
[clickButton setFrame: buttonRect];
[clickButton setTitle:@"Click Me" forState: UIControlStateNormal];
[clickButton addTarget:self action:@selector(buttonPressed:)    forControlEvents:UIControlEventTouchUpInside];
[self.view addSubview:clickButton];
[self buttonPressed:clickButton];
//Add UILabel
CGRect labelViewRect= CGRectMake(50, 30, 200, 44);
UILabel *labelview= [[UILabel alloc]initWithFrame:labelViewRect];
[labelview setText:@"Hello welcome to my app!"];
//Clear the UIView button's background
[labelview setBackgroundColor:[UIColor clearColor]];
[self.view addSubview:labelview];
} 
```

这是按钮按下方法

```
-(void)buttonPressed:(UIButton *)sender{
NSLog(@"This button was pressed");
self.view.alpha=((double)arc4random()/0x100000000);
} 
```

当我删除 : 从

```
 [clickButton addTarget:self action:@selector(buttonPressed:)    forControlEvents:UIControlEventTouchUpInside]; 
```

即正在将上面的行更改为类似的内容

```
 [clickButton addTarget:self action:@selector(buttonPressed)    forControlEvents:UIControlEventTouchUpInside]; 
```

抛出异常：

> 2012-12-29 17:56:18.209 AlphaSchoolColor[11414:c07]-[com_skminfotekViewController buttonPressed]：无法识别的选择器发送到实例 0xde2f050 2012-12-29 17:56:18.210 AlphaSchoolColor[11414:c07] ***由于未捕获而终止应用程序异常“NSInvalidArgumentException”，原因：“-[com_skminfotekViewController buttonPressed]：无法识别的选择器发送到实例 0xde2f050”

向社区提出的问题是它正在发生什么：我可以在哪里了解更多关于它的重要性的信息。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T00:06:57.490

你的方法有一个参数。如果您想发送不带“：”的操作，请更改您的方法。

```
-(void)buttonPressed{
} 
```

# python - 在任务之前禁用 QPushButton

> ID：14087066
> 
> 赞同：1
> 
> 时间：2012-12-30T00:00:09.230
> 
> 标签：python, qt, pyqt, pyqt4

我创建`QPushButton`并建立了与特定任务的连接。除了这个任务，我想禁用这个`QPushButton`。因此我`mypushbutton.setEnabled(False)`在任务之前添加，但它不会像我预期的那样工作，我的任务完成后按钮被禁用。但是，当我删除我的任务时，它可以工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:00:17.777

**你可以做：**

```
mypushbutton.setEnabled(False);
QCoreApplication::processEvents();
// do something 
```

[http://doc.qt.digia.com/qt/qcoreapplication.html#processEvents](http://doc.qt.digia.com/qt/qcoreapplication.html#processEvents)

***更新了文档评论***

# sql - 将嵌入代码存储在 sql 中后，Youtube 视频无法在 Firefox 中播放

> ID：14087067
> 
> 赞同：0
> 
> 时间：2012-12-30T00:00:29.827
> 
> 标签：sql, asp.net-mvc, youtube, embed

问题如标题所述。我正在使用 C#、MVC3、实体框架和 SQL Server。

在我使用的视图中公开数据时，`@Html.Raw(Model.Code)`它会完全按照预期呈现 html。问题是没有视频，只有一个黑色的 div。

这是呈现的 Html：

```
<iframe width="400" height="225" src="http://www.youtube.com/embed/PjWktOLFFuA?rel=0" frameborder="0" allowfullscreen></iframe> 
```

它在所有其他浏览器中正常工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:07:35.093

找到了。它与 css 相关。包装 div 是 isotope.js 插件的一部分，以下属性被添加到 div 中，导致它不会在 Firefox 中显示。

```
transform: translate(0px, 0px); 
```

# database-design - DynamoDB + 将值存储为项目或 JSON

> ID：14087070
> 
> 赞同：10
> 
> 时间：2012-12-30T00:01:08.927
> 
> 标签：database-design, amazon-dynamodb, amazon

DynamoDB 的新手。

我正在使用主键“UserID”、复合键“DateTime”创建一个表，然后我将以下值作为值（注意：我不需要查询以下数据中的任何细节 - 只需编写和阅读它） ：

```
UserID1
UserID2
Message
DateTime 
```

问题：

1.  将这 4 个值存储为单独的项目或一个 JSON 字符串有什么好处吗？
2.  存储值中的 UserID1 和 Datetime 也构成主/复合键 - 我是否正确假设将这些存储在数据/值中没有意义，因为我可以在查询时从返回的键中访问它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-04T12:35:38.373

所以你的选择是：

```
Hash Key | Range Key  | Attributes
----------------------------------
user id  | utc time   | json data
----------------------------------
user123  | 1357306017 | {UserID1:0, UserID2:0, Message:"", DateTime:0} 
```

或者

```
Hash Key | Range Key  | Attributes
--------------------------------------------------------------
user id  | utc time   | UserID1 | UserID2 | Message | DateTime
--------------------------------------------------------------
user123  | 1357306017 | 0       | 0       | ""      | 0 
```

两者都是可行的选择，并且选择取决于您希望如何读取数据，如果您对每个项目都有一个属性，那么您可以单独请求这些属性。

我们倾向于根据我们的使用模式使用混合方法。我们需要单独访问的元素被赋予了它们自己的属性。我们只想访问的元素以及其他元素的集合都被分配了一个属性，然后存储为 JSON 字符串的单个 blob 或 base64 编码数据。

对于第二部分，确实，您是对的，您不需要再次将用户 ID 和日期时间存储为属性的一部分，因为它们是哈希和范围键，当您发出请求时会返回它们。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-10-10T22:03:27.977

1.  您可以将 JSON blob 中的条目存储为单独的 AttributeValue。在 DynamoDB 引入 JSON 文档支持之前，您的选项将仅限于单独的属性，或者您存储这些属性的 JSON 表示的一个“字符串”属性。现在亚马逊为 DynamoDB 引入了 JSON 文档支持，您可以将这种详细的属性映射直接存储在项目中。使用适用于 DynamoDB 的新 Java 文档 SDK，添加 JSON 值使用 Item.withJSON() 方法，如下所示：

    ```
    DynamoDB dynamodb = new DynamoDB(client);
    Table messagesTable = dynamodb.getTable("MESSAGES");

    // create the item
    Item item = new Item().withString("UserID", "user123").withString("DateTime", "1357306017")
        .withJSON("Details", "{ \"UserID1\": 0, \"UserID2\": 0, \"Message\": \"my message\", \"DateTime\": 0}");

    // put the item
    messagesTable.putItem(item);

    // get the item
    Item itemGet = messagesTable.getItem(new KeyAttribute("UserID", "user123"), new KeyAttribute("DateTime", "1357306017")); 
    ```

2.  我同意 Pooky 的观点，即无需在详细信息图中复制 Hash+Range 键。您需要这两者才能使用 GetItem 来获取项目。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-09T07:09:02.193

DynamoDB 现在支持 json 对象直接存储。阅读：[http ://aws.amazon.com/blogs/aws/dynamodb-update-json-and-more/](http://aws.amazon.com/blogs/aws/dynamodb-update-json-and-more/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-31T06:53:23.057

1.  我假设“单独的项目”是指“单独的属性”，在这种情况下它并不重要。我可能会将它们存储为单独的属性，因为可以检索属性的子集（尽管您说您现在不需要此功能）。将来，如果您想查看用户发送了多少条消息，但又不想等待慢速网络返回许多 KB 的消息，则具有单独的属性会很有用。

2.  是的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-07-02T18:38:15.453

您始终可以将数据存储为 JSON 并轻松查询。

```
{
  sequence: "number",
  UserID1: "id",
  UserID2: "id",
  Message: "message text",
  DateTime: "1234567890"
} 
```

我假设您的目的是某种消息传递系统。在这种情况下，UserID1 和 UserID2 不能是哈希键，因为您显然会有重复的条目（例如 UserID1 有多个消息）。

您可以有一个索引，它是一个排序的会话 ID。

然后，您可以在结构的 [DateTime] 部分创建二级索引，以便您可以查询该会话的早于某个给定时间戳的消息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-07-06T16:18:41.290

使用 DynamoMapper，您可以在 Java 中执行此操作：

```
@DynamoDBTable(tableName = "myClass")
public class MyClass {

    @DynamoDBHashKey(attributeName = "id")
    private String id;

    @DynamoDBRangeKey(attributeName = "rangeKey")
    private long rangeKey;

    @DynamoDBTypeConvertedJson
    private Content content;

} 
```

内容类可以是：

```
public class Content {

    @JsonProperty
    private List<Integer> integers = new ArrayList();

    @JsonProperty
    private List<String> strings = new ArrayList();

} 
```

# winapi - Pascal - 将背景设置为白色（不是灰色，纯白色）

> ID：14087072
> 
> 赞同：1
> 
> 时间：2012-12-30T00:01:14.347
> 
> 标签：winapi, console, pascal, freepascal, turbo-pascal

是否可以将 Pascal 中的控制台背景设置为纯白色？我不满意

```
TextBackground(White); 
```

如果有任何改变，我可以使用 WinApi 函数。我知道控制台中的背景可以设置为纯白色（不是灰色）。我曾经看过它的程序。我认为这是批处理脚本。但我想在控制台中实现它。任何技巧都可以。如果没有其他办法，它可以是非常低的水平。

更新。我找到了批处理命令。

```
"COLOR arg" 
```

我知道我可以通过使用在 C++ 中使用它

```
System("COLOR fc"); 
```

但我在 Pascal 中找不到任何“系统”命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-08-31T20:26:57.150

您可以将背景更改为白色，然后将 textcolor 更改为闪烁并清除屏幕。

`TextBackground(white); TextColor(Blink); Crt.ClrScr;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-27T07:44:06.923

**霍奇**，你是对的。

如果我打电话`TextBackground(White);`或者`TextBackground(White);`这会变成灰色。

对于纯白色需要 write `TextAttr:=$f0;`，其中 $ **f** _ 是背景颜色（例如白色），而 $_ **0**是文本颜色（例如黑色）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-30T00:46:23.923

您可以使用此代码

```
swapvectors;  exec('cmd','/c color f0');  swapvectors; 
```

这是设置控制台窗口颜色的命令提示符

*   f：浅白色：背景
*   0：黑色：文字颜色
*   你可以去cmd，输入COLOR /? 了解更多

要使用此代码，您必须使用 DOS 单元。

对不起我的英语，我是学生。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-30T00:11:50.403

右键单击 CMD 窗口顶部 -> 属性 -> 颜色 -> 选择任何你想要的。

也试试`TextBackground(15);`

# php - 检查坐标是否在与其他坐标的特定距离内

> ID：14087076
> 
> 赞同：3
> 
> 时间：2012-12-30T00:01:36.270
> 
> 标签：php, math, coordinates, match, distance

好的，所以我在某些坐标上有一个目标，在其他坐标上有一些“人”，我想检查这些人的坐标是否在距离目标坐标 2 公里（2000 米）的范围内。

下面的代码只是为了说明我想要更清楚的内容，问题当然是如何做到这一点？我真的很感激这个问题的解决方案，谢谢！

```
$person0 = Array('56.34342', '49.324523');
$person1 = Array('57.49544', '47.421524');
$person2 = Array('56.74612', '48.722323');

$target = Array('56.35343', '49.342343');

for (var $i = 0; $i < 4; i$++) {
    CheckIfMatch($person + i$);
}

function CheckIfMatch($person) {
    if($person is within 2km from target) {
        echo 'Match!';
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T14:47:30.220

您可以使用 Great Circle 算法来做到这一点。[http://en.wikipedia.org/wiki/Great-circle_distance](http://en.wikipedia.org/wiki/Great-circle_distance)

以下是如何找到距离。

**编辑**

这是您执行此操作的完整代码！

```
<?php
$persons = Array();

$persons[] = Array('52.00951','4.36052');//Delft is more than 2 km from den haag
$persons[] = Array('52.03194','4.31769');//Rijswijk is less than 2 km from den haag
$persons[] = Array('52.07097','4.29945');//A place near den Haag almost 2 streets from center and my favourite coffee shop
$persons[] = Array('52.37022','4.89517');//Amsterdamn is about 60 km *DRIVING* from the hagues according to Gmaps

$target = Array('52.07050', '4.30070');//Den Haag
$i = 0;
foreach($persons as $person){
    $i++;
    $distance = calculate_distance($person, $target);
    if($distance <= 2 ){ 
        echo "Person $i is within 2km with a distance to taget of $distance</br>";
    }else{
        echo "Person $i is <b>not</b> within 2km with a distance to taget of $distance</br>";
    }

}

function calculate_distance($person, $target){

    $lat1 = $person[0];
    $lng1 = $person[1];
    $lat2 = $target[0];
    $lng2 = $target[1];
    $pi = 3.14159;
    $rad = doubleval($pi/180.0);

    $lon1 = doubleval($lng1)*$rad;
    $lat1 = doubleval($lat1)*$rad; 
    $lon2 = doubleval($lng2)*$rad; 
    $lat2 = doubleval($lat2)*$rad; 
    $theta = $lng2 - $lng1; 

    $dist = acos(sin($lat1) * sin($lat2) + cos($lat1) * cos($lat2) * cos($theta)); 

    if ($dist < 0) 
        $dist += $pi;

    $miles = doubleval($dist * 69.1); 
    $inches = doubleval($miles * 63360); 
    $km  =  doubleval($dist * 115.1666667);

    $dist = sprintf( "%.2f",$dist); 
    $miles = sprintf( "%.2f",$miles); 
    $inches = sprintf( "%.2f",$inches); 
    $km = sprintf( "%.2f",$km);
    //Here you can return whatever you please
    return $km;
}

?> 
```

当然还有结果：

```
Person 1 is not within 2km with a distance to taget of 4.24
Person 2 is within 2km with a distance to taget of 1.21
Person 3 is within 2km with a distance to taget of 0.09
Person 4 is not within 2km with a distance to taget of 41.56 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T00:30:23.347

我有这个函数，它计算点 1 和 2 之间的差。函数返回英里，所以我乘以 1.609344 将其转换为公里。

```
<?php
function lat_long_dist($lat1, $long1, $lat2, $long2){
    $pi = pi();
    $x  = sin($lat1 * $pi/180) * 
          sin($lat2 * $pi/180) + 
          cos($lat1 * $pi/180) * 
          cos($lat2 * $pi/180) * 
          cos(($long2 * $pi/180) - ($long1 * $pi/180));
    $x  = atan((sqrt(1 - pow($x, 2))) / $x);
    return (1.852 * 60.0 * (($x/$pi) * 180)) / 1.609344;
}

$people   = array();
$people[] = array(56.34342, 49.324523);
$people[] = array(57.49544, 47.421524);
$people[] = array(56.74612, 48.722323);

foreach($people as $person){
    $lat1 = $person[0];
    $lon1 = $person[1];
    $distance = lat_long_dist($lat1, $lon1, 56.35343, 49.342343) * 1.609344;
    if($distance <= 2){
        echo "$i is within 2km!\n";
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T00:24:02.933

用毕达哥拉斯依次找出目标与每个人的距离，并检查是否小于2公里。如果 x,y 是目标的坐标，p,q 是其中一个人的坐标，则两者之间的距离为： ((xp)^2 + (yq)^2)^(1/2) ^ 符号意思是“被提升到权力之下”。

# php - WP Timthumb 路径错误 - 可能与缓存相关？

> ID：14087077
> 
> 赞同：0
> 
> 时间：2012-12-30T00:02:22.057
> 
> 标签：php, wordpress, url, pathing

我将带有 wp 安装的子域 (actividades.acropolis.org.mx) 从一台服务器复制到另一台服务器。长话短说，虽然我进行了转移并且域的 DNS 尚未重定向到新服务器，但我使用了服务器的预览 URL，它是：

[http://actividades.acropolis.org.mx.s160231.gridserver.com](http://actividades.acropolis.org.mx.s160231.gridserver.com)

现在 DNS 传输已经结束，我将 wp_options 表中具有上述 url 的两行更改为新行：actividades.acropolis.org.mx

一切正常，除了 timthumb.php 的路径。

我的怀疑是它在dns更改发生之前以某种方式存储了以前的url，现在正在使用导致问题的那个......

这可以在主页上看到

[http://actividades.acropolis.org.mx/actividades/](http://actividades.acropolis.org.mx/actividades/)

滑动画廊没有拇指图像，只有少数（出于某种奇怪的原因，即使它很长，这少数也有正确的路径）

如果您获取丢失图像的来源，例如：

[http://actividades.acropolis.org.mx/wp-content/themes/eVid/timthumb.php?src=http://actividades.acropolis.org.mx.s160231.gridserver.com/wp-content/uploads/ 2012/11/EL-ARTE-DE-VIVIR_EL-ARTE-DE-SERVIR.jpg&h=277&w=858&q=80&zc=1](http://actividades.acropolis.org.mx/wp-content/themes/eVid/timthumb.php?src=http://actividades.acropolis.org.mx.s160231.gridserver.com/wp-content/uploads/2012/11/EL-ARTE-DE-VIVIR_EL-ARTE-DE-SERVIR.jpg&h=277&w=858&q=80&zc=1)

导致错误

所以我不禁想知道如何将路径 timthumb 使用设置为正确的。

问候索特拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T00:52:39.257

Timthumb.php 在主题/eVid/ 中

所以我去了管理面板，禁用 evid 作为主题，启用标准的 211 主题，禁用它并重新启用 eVid ... bam，它更新了它的文件路径，现在一切正常。

# python - 使用 Biopython 从斯德哥尔摩（Rfam）对齐导入 SS_cons

> ID：14087081
> 
> 赞同：0
> 
> 时间：2012-12-30T00:03:11.717
> 
> 标签：python, biopython

有人知道如何使用 Biopython 从多重对齐（斯德哥尔摩，Rfam）中恢复 SS_cons 吗？该文件作为 AlignIO 对象读入。我正在导入具有以下格式的多重比对（1990 序列）：

```
BAAY01001440.1/1679-1604                   ....................GG.CU.G.U.G.AC.G.C.AA.AGC.U..A
BABD01024787.1/545-457                     ....................CA.UA.A.G.G.UC.G.C.AA.AGC.C..A
AAUQ01092265.1/84-10                       ....................GG.CG.G.G.G.AC.G.G.AA.AGC.C..A
#=GC SS_cons                               ....................>>.>>.>.>......>.>....<<<.<...
#=GC RF                                    ~~~~~~~~~~~~~~~~~~~.gg.cg.g.g.G.AC.G.C.AA.AgC.c..A 
```

我试过了：

```
record.letter_annotations('secondary_structure') 
```

但我得到：

```
TypeError: '_RestrictedDict' object is not callable 
```

可能只有当每个序列都有二级结构时，调用才可用，这里不是这种情况。无论如何，我认为应该可以恢复 SS_cons。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T10:10:27.930

您应该像在典型的 Python 字典中那样使用方括号：

```
record.letter_annotations['secondary_structure'] 
```

Python 对函数或方法参数使用圆括号（或者在 Python 的术语中，可调用对象），这不是函数或方法（这是 Python 异常试图告诉你的）。

但是，这不会给你你想要的，这是整个对齐的属性，而不是任何单独的记录 - 请参阅[https://redmine.open-bio.org/issues/3387](https://redmine.open-bio.org/issues/3387)

# c# - Ticker 正在转移注意力

> ID：14087082
> 
> 赞同：0
> 
> 时间：2012-12-30T00:03:19.047
> 
> 标签：c#, timer, focus

我有一个计时器来更新我的代码中的进度条。它每秒更新一次。但是，当我尝试在应用程序中做任何事情（比如从组合框中选择一个项目）时，我不能这样做，因为一旦代码更新，组合框就会关闭，所以我最多只有一秒钟的时间这样做。我怎样才能阻止自动收报机每秒钟都将注意力集中在自己身上？（我想这就是原因..）

好的，因为我似乎无法正确格式化注释中的代码，所以我把它放在这里：在`Form1_load()`：

```
 Timer ticker = new Timer();
        ticker.Interval = 1000;
        ticker.Tick += new EventHandler(ticker_Tick);
        ticker.Start(); 
```

这里是计时器方法：

```
 string time = string.Empty;
        int a = 0;
        foreach (XmlNode cas in UpdateFlights)
        {
            time = cas.Attributes.GetNamedItem("time").Value;
            a = Int32.Parse(time);
        }
        toolStripProgressBar1.Step = 3;
        toolStripProgressBar1.Maximum = a * 3;
        toolStripProgressBar1.PerformStep(); 
```

# php - 使用 PHPMailer 添加一些图像

> ID：14087092
> 
> 赞同：0
> 
> 时间：2012-12-30T00:05:35.110
> 
> 标签：php, image, phpmailer

我正在使用 phpmailer 发送电子邮件。电子邮件是带有一堆图像的模板。所以我使用 AddEmbeddedImage() 方法来添加图像。问题是我想添加很多图像，如何指定路径参数以便一次加载所有图像？AddEmbeddedImage('images/*.jpg',...) 有意义吗？

对于信息，我实例化`$mailer = new PHPMailer();`然后我使用`$mail->AddEmbeddedImage('img/some_image.jpg', 'image');`但我不能为二十张图像做二十次

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:25:36.463

您可以遍历文件夹中的所有图像并使用 foreach 循环添加它。例如：

```
<?php
function get_files ($dir, $_ext = 'jpg') {
    $files = array();
    if (is_dir($dir)) {
        if ($dh = opendir($dir)) {
            while (($file = readdir($dh)) !== false) {
                if ($file == '.' || $file == '..') continue;
                $ext = pathinfo($file, PATHINFO_EXTENSION);

                if ($ext == $_ext) {
                    $files[] = $file;
                }
            }
            closedir($dh);
        }
    }
    return $files;
}

/**
* You can change the second parameter so you can get other image types 
* (png, gif, etc.)
*/
$images = get_files ("/path/to/folder/of/images/");
foreach ($images as $image) {
    $mail->AddEmbeddedImage ($image, 'image');
}
?> 
```

取自[PHP.net](http://si1.php.net/manual/en/function.opendir.php)的目录代码。

# objective-c - 将 NSString 转换为 NSData 是否会强制使用尾随字节？

> ID：14087094
> 
> 赞同：17
> 
> 时间：2012-12-30T00:05:50.297
> 
> 标签：objective-c, cocoa

这是对这个错误答案的回应： [https ://stackoverflow.com/a/7894952/192819](https://stackoverflow.com/a/7894952/192819)

是否像这样转换 NSString：

```
NSString *str = @"teststring";
NSData *data = [str dataUsingEncoding:NSUTF8StringEncoding]; 
```

强制尾随 \0 字节，这意味着

```
-[NSJSONSerialization:JSONObjectWithData:] 
```

除非您将其删除，否则其他人将失败。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-30T00:05:50.297

不，不是的。看这个例子：

```
NSDictionary *dict = [NSDictionary dictionaryWithObjectsAndKeys:
                      @"v1", @"k1", 
                      @"v2", @"k2",
                      nil];
NSLog(@"dict=%@", dict);

NSData *jsonData = [NSJSONSerialization dataWithJSONObject:dict options:0 error:nil];    

NSString *jsonAsString = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];

NSData *jsonDataFromString = [jsonAsString dataUsingEncoding:NSUTF8StringEncoding];

// DO NOT DO THIS:
// jsonDataFromString = [jsonDataFromString subdataWithRange:NSMakeRange(0, [jsonDataFromString length] - 1)];

NSDictionary *jsonObject = [NSJSONSerialization JSONObjectWithData:jsonDataFromString options:0 error:nil];
NSLog(@"jsonObject=%@", jsonObject); 
```

尝试一下，然后在未注释的“不要这样做”行中尝试。你会看到没有问题。

# php - 同步 PHP Git 项目的 MySQL 结构

> ID：14087097
> 
> 赞同：0
> 
> 时间：2012-12-30T00:06:01.313
> 
> 标签：php, mysql, git, ubuntu, wampserver

我最近学会了使用 git，有一个很好的支持它的编辑器，以及一个很好的钩子，可以在推送时将所有内容上传到实时站点。所以现在我有一个本地版本、一个开发测试版本和一个实时版本，一切都很精彩。我没有设法找到的唯一问题是关于如何在数据库之间有效地同步 MySQL 结构的一个很好的解决方案。

我在扩展项目时经常遇到的两种情况是添加额外的列或创建新表。我经常通过 phpmyadmin 执行此操作，虽然我可以将给定的更改复制粘贴为 SQL，但我努力寻求一种更有效的解决方案，而不是在 3 个以上的存储库中复制粘贴。

目前这些是我考虑的方法，但我更喜欢更有效的方法。

**存储库：**

*   live - 服务器上的实时站点
*   dev - 服务器上的开发站点
*   local - 计算机上的本地站点

# 方法#1

将 phpmyadmin 生成的所有 SQL 命令复制/粘贴到每个项目的数据库中。

*   最终并不是一个真正有效的解决方案

# 方法#2

不知何故（启发我）用一个数组填充一个 php 文件，该数组中包含从 phpmyadmin 生成的所有 SQL 命令，然后从钩子中执行该 php 文件。我会在服务器的一个存储库中进行所有结构更改，并在从本地拉取并合并到 live 时，更改 MySQL 结构。

*   会很整洁，但不完全确定如何执行它
*   需要在 ubuntu 服务器和本地 wampserver 上工作

# 方法#3

通过 MySQL 的一些不错的解决方案，可以在服务器和本地工作。

*   不知道那将如何工作。

感谢您的宝贵时间，如果您知道更好的方法，请分享！我正在寻找一种有意义的自动解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T17:58:53.327

试试[http://www.liquibase.org/](http://www.liquibase.org/)

我还在 yii 看到了不错的迁移：[http ://www.yiiframework.com/doc/guide/1.1/en/database.migration](http://www.yiiframework.com/doc/guide/1.1/en/database.migration)

如果 CodeIgniter 支持这样的东西——它也很好。是的——我看到它的支持：向上和向下。

如果 man，这将与迁移一起工作知道编程语言——那么使用框架中的工具就可以了。如果没有 - 那么最好使用 xml/config 之类的东西[http://www.liquibase.org/](http://www.liquibase.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T17:04:03.373

我意识到我使用的两个 CodeIgniter 似乎都有很好的方法来处理这个问题。不知道用[**Migration**](http://ellislab.com/codeigniter/user-guide/libraries/migration.html)这个词搜索。

希望所有发现这个问题的人都注意到这一点；关键字是**数据库迁移**以找到好的解决方案。

感谢评论指出在哪里看。

# php - 计算 Ubuntu 中的逻辑代码行数

> ID：14087100
> 
> 赞同：6
> 
> 时间：2012-12-30T00:06:19.397
> 
> 标签：php, javascript, html, css, ubuntu

我正在开发一个 Web 应用程序，我需要能够跟踪目录中的`php`、`css`和代码`html`行。`JavaScript``/var/www`

但是使用代码计数器的终端行，我自然想写更多的行并间隔代码，例如：

```
if($var == $other)echo("hi"); 
```

将作为：

```
if($var == $other)
{
    echo("hi");
} 
```

这样我就可以在不做任何实际工作的情况下得出非常多的行数，有什么方法可以计算目录中代码的逻辑行数吗？有没有什么程序可以做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T00:09:20.633

需要注意的是，“代码行”指标的意义非常可疑，您可以从找出空白行开始。

```
find . -name '*.php' -print0 | xargs -0 cat | egrep -v '^[ \t]*$' | wc 
```

（例如）。

对于像 JavaScript 这样的语言，个人编码风格会对原始 LOC 产生非常重要的影响。考虑到有些人是这样写的：

```
if (testSomething()) return null;

if (somethingElse()) {
  doThis();
} else {
  doThat();
} 
```

有些人是这样写的：

```
if (testSomething())
{
  return null;
}

if (somethingElse())
{
  doThis();
}
else
{
  doThat();
} 
```

更有用的东西（尽管在我看来仍然是可疑的）将是一些类似于“陈述”的东西。当然，您需要一个能够明确理解不同语言语法的工具。

我将此统计数据称为“可疑”，因为在组织中，数字的弱本质往往会被遗忘，因为它会在一个又一个电子表格中使用。项目经理开始根据 LOC、记录的错误（也是可疑的）、签入（同上）等来提取趋势，而与真实生产力的相关性如此微弱的事实就消失了。

布道结束:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T00:24:30.373

有一些程序，例如[CLOC](http://cloc.sourceforge.net/)，可以计算不包括注释和空行的代码行数，但我认为它们不适用于您的示例代码。

我认为可能会为每种语言找到一些自动代码格式化程序，例如[http://jsbeautifier.org/](http://jsbeautifier.org/)，并测量输出中的行数（最好使用前面提到的 CLOC）。可能会减少特定程序员的编码风格对结果的影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T05:57:26.330

如果您想避免使用正则表达式的麻烦或实际尝试解析代码，您可以只计算分号和右大括号的数量。我的意思是，这两件事几乎总是有自己的台词。

# javascript - 如何修改（数据绑定）ListView.oniteminvoked 事件中的单元格内容？[W8 Metro UI，WinJS]

> ID：14087111
> 
> 赞同：0
> 
> 时间：2012-12-30T00:08:35.140
> 
> 标签：javascript, listview, microsoft-metro, refresh, databound

我在 Windows 8 HTML5/JavaScript 应用程序中创建了一个数据绑定列表视图，我想修改绑定到单击单元格的数据。为此，我使用 ListView.oniteminvoked 事件。

数据修改成功，但单元格没有刷新。

[文档](http://msdn.microsoft.com/en-us/library/windows/apps/br211827.aspx)说我可能应该使用“ msSetImmediate”，但我不明白如何。

如何刷新单个单元格？您能否提供一个示例，其中一旦单击，单元格会根据修改后的数据更改其内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T18:18:36.530

问题（以某种方式）解决了：

```
eventObject.detail.itemPromise.done(function (invokedItem) {
    DataExample.data[invokedItem.index] = { newobject }
    dataList.setAt(invokedItem.index, { newobject });
}); 
```

唉，`setAt`- 虽然实际上刷新了单元格内容 - 似乎并没有修改用于创建 dataList 的数据数组，因此我之前手动更新它。

# c# - 滚动查看器中的文本框

> ID：14087113
> 
> 赞同：0
> 
> 时间：2012-12-30T00:09:01.713
> 
> 标签：c#, wpf, wpf-controls

*   在我的 c# wpf windows 应用程序中.. 我想建立一个空间来写一些项目的历史作为项目符号点。
*   我在 scrollviewer 中放了一个文本框，以便能够写出我想要的内容……但我遇到了 3 个麻烦：
*   第一个麻烦：我不能在我的文本中添加项目符号？？
*   第二个麻烦：我的文本从左到右在一个垂直方向上..所以垂直滚动条出现而水平滚动条不出现，即我只想使用水平滚动条......我想以水平方式查看我的整个文本只要
*   第三个麻烦：按 Enter 不会移动到下一个新行
*   等待您的建议..谢谢 ![在此处输入图像描述](../Images/5edb0fd9ba8456a3e56609b7058cf17d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:50:26.030

要使用 TextBox 执行您想要的操作（减去项目符号），您需要设置一些属性，以允许在 Enter set AcceptsReturn="True" 上换行，以允许包装文本集 TextWrapping="Wrap" 等等. 你可以用 RichTextBox 做同样的事情

```
 <TextBox Width="300" 
             Height="300" 
             TextWrapping="Wrap" 
             AcceptsReturn="True" 
             VerticalScrollBarVisibility="Visible">
        </TextBox> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:41:46.573

要获得子弹，我会使用`RichTextBox`. [这](http://msdn.microsoft.com/en-us/library/system.windows.documents.editingcommands.togglebullets.aspx)是您可以执行以插入项目符号的命令的链接。然后为了允许换行，`AcceptsReturn`您需要将一个属性设置为 true。

# php - 从字符串中提取地址

> ID：14087116
> 
> 赞同：4
> 
> 时间：2012-12-30T00:09:26.260
> 
> 标签：php, javascript, jquery

假设我有这个字符串：

```
<div>john doe is nice guy btw 8240 E. Marblehead Way 92808  is also</div> 
```

或这个字符串：

```
<div>sky being blue? in the world is true? 024 Brea Mall  Brea, California 92821 jackfroast nipping on the firehead</div> 
```

我将如何从这些字符串之一中提取地址？这将涉及某种正则表达式，对吧？

我尝试在网上寻找使用 JavaScript 或 PHP 的解决方案，但无济于事。Stack Overflow 上没有其他帖子（据我所知）提供使用 jQuery 和/或 Javascript 和/或 PHP 的解决方案。（最接近的是[Parse usable Street Address, City, State, Zip from a string](https://stackoverflow.com/questions/16413/parse-usable-street-address-city-state-zip-from-a-string)，在线程中没有任何关于从字符串中提取邮政编码的代码。

有人可以指出我正确的方向吗？我将如何在 jQuery 或 JavaScript 或 PHP 中完成此任务？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-02T00:16:40.920

在与你的相似的十二个不同的字符串上尝试了这个，它工作得很好：

```
function str_to_address($context) { 

    $context_parts = array_reverse(explode(" ", $context)); 
    $zipKey = ""; 
    foreach($context_parts as $key=>$str) { 
        if(strlen($str)===5 && is_numeric($str)) { 
            $zipKey = $key;
            break; 
        }
    }

    $context_parts_cleaned = array_slice($context_parts, $zipKey); 
    $context_parts_normalized = array_reverse($context_parts_cleaned); 
    $houseNumberKey = ""; 
    foreach($context_parts_normalized as $key=>$str) { 
        if(strlen($str)>1 && strlen($str)<6 && is_numeric($str)) { 
            $houseNumberKey = $key;
            break; 
        }
    }

    $address_parts = array_slice($context_parts_normalized, $houseNumberKey);
    $string = implode(' ', $address_parts);
    return $string;
} 
```

这假设门牌号至少为两位数，并且不超过六位。这也假设邮政编码不是“扩展”形式（例如 12345-6789）。然而，这可以很容易地修改以适应该格式（正则表达式在这里是一个不错的选择，例如`(\d{5}-\d{4})`.

但是使用正则表达式来解析用户输入的数据......这里不是一个好主意，因为我们只是不知道用户将输入什么，因为（可以假设）没有验证。

遍历代码和逻辑，从从上下文创建数组并获取 zip 开始：

```
// split the context (for example, a sentence) into an array, 
// so we can loop through it. 
// we reverse the array, as we're going to grab the zip first. 
// why? we KNOW the zip is 5 characters long*.
$context_parts = array_reverse(explode(" ", $context));  

// we're going to store the array index of the zip code for later use 
$zipKey = ""; 

// foreach iterates over an object given the params, 
// in this case it's like doing... 
// for each value of $context_parts ($str), and each index ($key)
foreach($context_parts as $key=>$str) { 

    // if $str is 5 chars long, and numeric... 
    // an incredibly lazy check for a zip code...
    if(strlen($str)===5 && is_numeric($str)) {  
        $zipKey = $key;

        // we have what we want, so we can leave the loop with break
        break; 
    }
} 
```

做一些整理，这样我们就有一个更好的对象来伪装门牌号码

```
// remove junk from $context_array, since we don't 
// need stuff after the zip
$context_parts_cleaned = array_slice($context_parts, $zipKey); 

// since the house number comes first, let's go back to the start
$context_parts_normalized = array_reverse($context_parts_cleaned); 
```

然后让我们使用与邮政编码相同的基本逻辑来获取门牌号：

```
$houseNumberKey = ""; 
foreach($context_parts_normalized as $key=>$str) { 
    if(strlen($str)>1 && strlen($str)<6 && is_numeric($str)) { 
        $houseNumberKey = $key;
        break; 
    }
}

// we probably have the parts we for the address.
// let's do some more cleaning 
$address_parts = array_slice($context_parts_normalized, $houseNumberKey);

// and build the string again, from the address
$string = implode(' ', $address_parts);

// and return the string
return $string; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T00:15:15.797

正则表达式用于针对**模式**进行测试。你需要知道你在寻找什么模式。从您提供的两个示例中，我会查找一个数字，然后是一些文本，以一个五位数字结尾。

所有地址都必须采用这种格式。您不能神奇地从字符串中提取地址。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T13:34:44.327

如果您的所有地址都以数字开头和结尾，您可以使用此正则表达式来提取您需要的数据：

```
/[0-9].+[0-9]/gi 
```

Javascript 示例：

```
"<div>john doe is nice guy btw 8240 E. Marblehead Way 92808  is also</div>".match(/[0-9].+[0-9]/gi) // ["8240 E. Marblehead Way 92808"]
"<div>sky being blue? in the world is true? 024 Brea Mall  Brea, California 92821 jackfroast nipping on the firehead</div>".match(/[0-9].+[0-9]/gi) // ["024 Brea Mall  Brea, California 92821"] 
```

对于包含电话号码的新示例，您可以执行以下操作：

```
/[0-9].*[0-9]/gi 
```

Javascript 示例：

```
"john doe 7143138656 is 8240 e marblehead way 92808".match(/[0-9].*[0-9]/gi) // ["7143138656 is 8240 e marblehead way 92808"] 
```

但这只有在每行都有匹配信息时才会对您有所帮助。如果您真的需要一个强大的地址匹配器，您将需要继续，并创建强大的分析。

您可以开始在文本中搜索目标关键字，然后过滤段落，然后剥离您要查找的信息。

这不是一个简单的问题，但可以做到，您可以使用多个正则表达式进行某些匹配，但是如果地址没有模式，则正则表达式将无用，到时您将需要更改方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-01T20:16:44.087

由于方便，尝试使用正则表达式解析所有内容是一个常见的“错误”。然而，正则表达式并不是万能的。在这种情况下，看起来您不是在寻找文本中的常规模式，而是有人会写的“自然”表达，就好像他们在和你说话一样。这些自然的表达方式根本不一定遵循任何一致的模式。有些人把appt号码放在前面，然后是建筑物号码，有些人把城市省略了，直接跳到邮政编码，有些人可能把城市、州、国家放在后面。只是不可能枚举某人可以用地址编写的每个可能的正则表达式模式。

对于自然语言地址，我会忘记正则表达式地址检测并转向有状态解析算法。

1.  我会从从左到右（至少是英文）一次读一个单词开始。对于每个单词，您都会做一个逻辑测试“这个单词会是地址的开头吗？”。我想这是一个建筑物编号或 appt/unit/box 编号的数字（所以“Box XXX”、“PO BOX XXX”、“PO XXX”、“Unit XXX”、“#XXX”或任何更少的数字长度超过 6 位）。虽然我不知道这是否属实，但我从未见过北美的建筑物编号长度为 7 位数，这是电话的最小值。所以我怀疑你可以很容易地整理出电话号码和建筑物号码。这个“地址开始”测试*可能*是一组正则表达式匹配，但我们没有匹配整个地址，只是测试以地址开头的单词或短语。我什至可能会说它会是*没有正则表达式匹配更简单*。

2.  一旦你检测到一个地址的开始，你就创建了一个“地址解析状态对象”（一些你用来保存地址作为你继续解析的类，并跟踪你到目前为止所拥有的东西以及你接下来的期望）。现在您可以继续单步执行该句子并继续添加到您的解析器状态对象。在建筑物编号之后，我可能会期望街道名称或方向指示符（NEWS NE. NW. SE. SW.）。如果接下来这些都没有停止您的地址解析并假定地址无效或不完整，请继续寻找地址字的新开头。否则，将街道名称和/或方向指示符添加到您的解析树并继续！

3.  街道名称后面的任何内容都可以无限变化。一些用户可能只停留在建筑物编号和街道名称（假设他们当地的城市/地区/国家）。否则，您可能正在寻找城市名称或邮政编码/邮政编码。如果找到，则添加到您的地址解析状态对象，如果没有，则假定地址不完整（填写用户默认位置信息？）或无效地址（忽略并继续寻找另一个地址开始？）。

最终，这种方法可能是一种相当简单的 JavaScript 方法，可能只有几百行代码（我不是 PHP 人，但我认为它会相似）。如果您尝试枚举所有可能的正则表达式模式，有人可以用它来构造一个地址，那么您将拥有数百个这样的地址，但它仍然不可靠！（如果您尝试匹配数百个正则表达式模式，可能也很慢）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-17T04:48:02.887

我在使用**Google Geocode API**时获得了最好的运气。尝试考虑输入地址字符串的所有可能方式是很困难的。

我最近不得不从一个房地产网站的单个字符串中提取部分地址，我发现最好的选择是使用 google geocode API。它允许我为输入的每个地址获取街道、城市、州、邮编、纬度、经度等信息。

我在这里找到了有关设置 google geocode API (PHP) 的出色指南：[http ://www.andrew-kirkpatrick.com/2011/10/google-geocoding-api-with-php/](http://www.andrew-kirkpatrick.com/2011/10/google-geocoding-api-with-php/)

最好的部分，它甚至适用于地名。因此，搜索“UCLA”或“Apple 总部”将为您提供您可能需要的地址的所有部分。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-01-01T10:41:00.157

我的想法是你应该有一些东西来告诉你的代码“从这里到这里是一个地址，其余的是简单的文本”。为此，您可以创建一个地址数组或将地址保存在数据库中，您可以将其与插入的值进行比较

# php - PHP、.htaccess、DDoS 和快速请求保护

> ID：14087117
> 
> 赞同：4
> 
> 时间：2012-12-30T00:09:31.763
> 
> 标签：php, .htaccess, security, ddos, flooding

我有一个问题，我构建了这个小脚本来检查某个 ip 是否淹没了我的网站。当它这样做时，我拒绝 .htaccess 文件中的 ip。我的问题是，有人可以告诉我这个脚本是完全没用还是值得一试...该脚本在配置文件中被调用，因此它在每个页面加载时运行。

```
<?php
#get the visitor ip
$ip = $_SERVER["REMOTE_ADDR"];

#start the session
@session_start();

#check if the ip is banned
if( $_SESSION['~b'] ){

#check if we can open htaccess
$fp = @fopen('./.htaccess','a'); 
    if($fp){
        #add the ip to htaccess
        @fwrite($fp,"\r\ndeny from $ip"); 
        #close
        @fclose($fp);
        #destroy the session
        @session_destroy();
        @mail("my-email","IP Banned","Ip: $ip");
    }
    #let the user know why we deny him or her access
    die('To many requests.');
    }
#get the filename and location
$f = './log/'.@ip2long($ip);

#check if the file exists
if ( @is_file($f) ) {
        #get the last filetime
        $a = @filemtime($f);
        #touch the file, give a new filetime
        @touch($f,time());
        #the ip is not banned
        $_SESSION['~b']  = false;
        #add the time diff
        $_SESSION['~r'] += @time()-$a;
        #add the latest hit
        $_SESSION['~h'] += 1;
    }else{
        #create the file if it doesn't exist
        @file_put_contents($f,''); #size: 0kb
        #if touch() doesn't work
        #chmod($ipfile,0755); 
    }

#calculate the diff after 10 hits, and ban when the avg is smaller than 0.25 seconds
if( $_SESSION['~h'] > 10 && ($_SESSION['~r']/$_SESSION['~h']) < 0.25 ) $_SESSION['~b'] = true;
?> 
```

只是遵循了避免会话的建议，所以我使它基于文件，而不必依赖于 cookie 和会话：

```
<?php
# get the visitor ip
$i = $_SERVER["REMOTE_ADDR"];
# get the filename and location
$f = './log/'.ip2long($i).'.dat';
# check if the file exists and we can write
if ( is_file($f) ) {
    # get the last filetime
    $a = filemtime($f);
    # get the file content
    $b = file_get_contents($f);
    # create array from hits & seconds
    $d = explode(':',$b);
    # calculate the new result
    $h = (int)$d[0] + 1;
    $s = (int)$d[1] + (time()-$a);  
    # add the new data tot text file
    file_put_contents($f,"$h:$s",LOCK_EX);
    unset($d);
}else{
    # create the file if it doesn't exist hits:seconds
    file_put_contents($f,"1:1",LOCK_EX); #size: 3kb
    # to make sure we can write
    # chmod($f,0755); 
    # set the hits to zero
    $h = 0;
}
# create a result var
$r = $h > 10 ? (float)$s/$h : (float)1;
# calculate the diff after 10 hits, and ban when the avg is smaller than 0.20 seconds (5 hits per second)
if( $r < 0.20 ) {
    # check if we can open htaccess
    $fp = @fopen('./.htaccess','a'); 
    if($fp){
        # add the ip to htaccess
        @fwrite($fp,"\r\ndeny from $i"); 
        # close
        @fclose($fp);
        # mail the admin
        @mail("email","IP Banned","Ip: $i with $r sbh (Seconds Between Hits)");
    }
    # let the user know why we deny him or her access
    die('To many requests.');
    # remove the file
    unlink($f);
}
# if the user leaves, reset
if( $r > 30 ) {
    unlink($f);
}
echo 'Result: '.$r.'sbh (Seconds Between Hits)';
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T01:36:12.903

如果您想阻止临时用户在一定时间内发送太多请求，那么**是**的，脚本可以工作。调出一个 catpcha 屏幕，你就开始做生意了。

但

真正的答案是**否定**的。

此代码的主要错误是依赖会话来确定用户活动的频率。“好”的攻击者可以用禁用 cookie 的请求淹没您的服务器，并欺骗他/她的 IP。

阻止攻击的一种方法是进入服务器级别，并安装 iptables。事实上，大多数 linux 发行版都附带 iptables。它需要很少的配置并且开箱即用。

另一种方法是，如果您对服务器具有 root 访问权限，则将会话处理移至 Memcached。它有一个叫做防洪的功能，非常BOSS。

防止 DDOS 的另一条途径是来自第三方服务，例如 blockdos [http://www.blockdos.net/](http://www.blockdos.net/)

有点贵，但它可以为你工作。

但是 PHP 本身无法配置为处理 DDOS 攻击。在访问 PHP 脚本之前，您需要在所有要审查的请求前面放置某种设备或防火墙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:20:29.450

我的两分钱。这是一个好主意，但是您最终可能会阻止合法用户访问您的网站。这也将是机器人（例如 Google 机器人）的问题。因此我会很小心。也许还要检查用户代理，如果它以 Google 的形式出现，那么无论其他条件如何都允许它。当然，这为恶意用户打开了一个新的漏洞。通常这样的事情是在 Web 服务器上完成的，而不是使用 PHP 代码。另一种方法是令牌系统。也就是说，我认为通过进一步的改进，你可以用你的方法来做一些事情。

您还看到针对多个快速请求问题[的 .htaccess 或 PHP 保护代码吗？](https://stackoverflow.com/questions/2820699/htaccess-or-php-protection-code-against-multiple-speedy-requests?rq=1)它表明你正在设计的东西以前已经尝试过。这告诉您可能正朝着正确的方向前进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T13:13:38.043

通过设置基于请求率的 IP 阻止规则来缓解 DDoS 总是会以失败告终，因为：

1.  此类规则会影响合法用户（误报）
2.  对于 IP 欺骗，这对于大多数（即使不是所有）攻击者都不起作用是很常见的。

IPTables 也是如此。您可以在这里了解更多信息：http: [//www.incapsula.com/ddos/ddos-protection-service#iptables-ddos-protection](http://www.incapsula.com/ddos/ddos-protection-service#iptables-ddos-protection)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-03T22:20:56.713

该解决方案非常有帮助。同时，关于@lopata 提出的问题，您可能宁愿注释掉脚本中的 unlink() 函数并设置一个 cron 作业，该作业将在一段时间后从 htaccess 中解锁 IP 并删除文件。

```
<?php

function unban_ip($ip){
    $filename='.htaccess';
    $line="deny from $ip";
    file_put_contents($filename, str_replace("\r\n".$line, "", file_get_contents($filename)));
    $f = './log/'.@ip2long($ip);
    if(@is_file($f))unlink($f);
    return true;
}

$time=time();   
$path='./log';
$handle=@opendir($path);
$x=0;

while(($file=@readdir($handle))!==false){
    if($file=='.'||$file=='..')continue;
    $filepath="$path/$file";

    if(is_file($filepath)){
        $ftime=@filemtime($filepath);
        if($time-$ftime>600){  //unban after 10 minutes
            $ip=long2ip($file);
            unban_ip($ip);
            $x++;
        }
    }
}

echo "$x IPs Unbanned"; 
```

# java - 应用程序设置？我必须使用 startActivity 吗？

> ID：14087122
> 
> 赞同：1
> 
> 时间：2012-12-30T00:10:15.027
> 
> 标签：java, android

我终于完成了我正在开发的应用程序。这是一个篮球记分牌应用程序。它完全按预期工作，但在开发阶段我已经硬编码了所有变量。这对我来说很好，但如果这个应用程序对其他人有用，那么一些变量需要能够更改。

我认为最好的方法是使用选项菜单。当用户单击菜单中的“设置”选项时，我的菜单出现在屏幕上。我创建了一个名为 SettingsActivity 的新 Activity，并且能够使用 startActivity(R.layout.settings) 方法显示这个 XML 布局。但是当我单击设备上的 BACK 按钮时，它会退出程序。

我对几件事感到好奇......我的理解是，如果我使用 startActivity() 方法，它将基本上删除我当前的活动并转到新的活动。但是，在不太可能的情况下，用户在游戏中间这样做，我不认为它会抹去一切。当用户点击 BACK 按钮时，我需要它从停止的地方继续。

我应该如何去完成这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T04:41:36.960

您应该将“设置”活动作为 PreferenceActivity (http://developer.android.com/reference/android/preference/PreferenceActivity.html) 而不是普通的活动，假设它不是太复杂。这真的取决于你的偏好屏幕需要什么。

```
public class Prefs extends PreferenceActivity{

 @Override
 public void onCreate(Bundle savedInstanceState){
     super.onCreate(savedInstanceState);
     addPreferencesFromResource(R.xml.preferences);
 }
} 
```

在您的 res/menu 文件夹中，您可以有一个 menu.xml 对应于用户按下菜单按钮时将显示的内容：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:id="@+id/miPrefs" android:title="Preferences" android:icon="@android:drawable/ic_menu_preferences"></item>
</menu> 
```

然后你可以把它与你的主要活动联系起来：

```
@Override
public boolean onCreateOptionsMenu(Menu menu){
  getMenuInflater().inflate(R.menu.menu,menu);
  return true; 
} 
```

然后最后，在您的主要活动中，您可以添加以下内容：

```
@Override
public boolean onMenuItemSelected(int featureId, MenuItem item){
  switch(item.getItemId()){
  case R.id.miPrefs:
    startActivity(new Intent().setClass(this,Prefs.class));
    break;
  }
} 
```

整个过程将允许您打开一个 PreferenceActivity（它将在您的 Main Activity 上打开），然后一旦您返回，您将回到未更改的 MainActivity。

如果这不是您要寻找的方法，则必须使用 onSaveInstanceState 进行操作，并在 saveInstanceState != null 时在 onCreate 中恢复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:19:31.180

我首先假设您在指向您的新类/新活动而不是 XML 布局的 Intent 上使用 startActivity。如果您想保存一些数据，请在 onpause 方法中使用 sharedpreferences ，您可以重新加载 onresume 但它应该保留，除非它被您或 Android 关闭（如果内存不足）。

# node.js - 如何将会话传递到 Node/Express 中的视图中？

> ID：14087125
> 
> 赞同：2
> 
> 时间：2012-12-30T00:10:41.610
> 
> 标签：node.js, express

我正在玩 Node/Express 3.0。但我不确定如何让会话结束。特别是我不确定我在 routes/session.js 中的以下内容是否正确。

```
app.use(function(req, res, next) {
  res.locals.session = req.session;
  next();
}); 
```

以下是更多细节。

我在 app.js 中有这个

```
var express = require('express')
  , routes = require('./routes')
  , http = require('http')
  , path = require('path')
  ;

var app = express();

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.favicon());
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.cookieParser('testtest'));
  app.use(express.session({
    secret: 'testtest',
    maxAge: 3600000
  }));
  app.use(app.router);
  app.use(express.static(path.join(__dirname, 'public')));
});
...
require ('./routes/session')(app);
...
http.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

在 routes/session.js 中

```
module.exports = function(app) {

  app.use(function(req, res, next) {
    res.locals.session = req.session;
    next();
  });

  app.get('/session/new', function(req, res) {
    res.render('session/new', {title: "Log in"});
  });

  app.post('/session', function(req, res) {
    if (users[req.body.username] && 
      users[req.body.username].password === req.body.password) {
        req.session.user = users[req.body.username];
        res.redirect('/users');
      } else {
        res.redirect('/session/new')
      }
  });

  app.del('/session', function(req, res, next) {
    req.session.destroy();
    res.redirect('/users');
  });

}; 
```

我有这个想法。

```
- if (session.user) {

  p
    span Hello&nbsp;
    span= session.user.name
    span= session
    span !
  p
    form(method="POST", action="/session")
      input(type="hidden", name="_method", value="DELETE")
      input(type="submit", value="Log out")

- } else {

  p
    a(href="/session/new") Login
    span &nbsp;or&nbsp;
    a(href="/users/new") Register

- } 
```

但这不会拿起会话并给出错误。

```
1| > 2| - if (session.user) { 3| 4| p 5| span Hello  session is not defined 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T02:16:04.570

要使中间件方法起作用，您需要确保`app.use`安装中间件的调用在调用`app.use(app.router);`. 目前，您在通过调用后调用它`require('./routes/session')(app);`：

```
require ('./routes/session')(app);
app.use(app.router); 
```

要在没有中间件的情况下执行此操作，请更改您的`res.render`调用以传递`session`您希望视图可用的局部变量：

```
app.get('/session/new', function(req, res) {
  res.render('session/new', {title: "Log in", session: req.session});
}); 
```

# maven - 鉴于工件，是否有可能知道 maven repo 托管它？

> ID：14087133
> 
> 赞同：0
> 
> 时间：2012-12-30T00:12:35.790
> 
> 标签：maven

假设我希望在我的项目中包含一些[番石榴](http://code.google.com/p/guava-libraries/)库。我被[告知](http://mvnrepository.com/artifact/com.google.guava/guava/13.0.1)这是让 Maven 为我获取它的正确方法：

```
<dependency>
    <groupId>com.google.guava</groupId>
    <artifactId>guava</artifactId>
    <version>13.0.1</version>
</dependency> 
```

现在，这一切都很好，假设我指向的 Maven 存储库实际上有这个代码。

**是否有可能知道那里的许多回购有特定的二进制文件供您下载？换句话说，假设你指向的仓库没有你需要的东西，你应该在哪里得到它？**

让我详细说明。我的 pom 目前列出了以下 repo：

```
<repository>
    <id>JBOSS_NEXUS</id>
    <url>http://repository.jboss.org/nexus/content/groups/public</url>
</repository> 
```

[除非我的眼睛在愚弄我，否则该服务器](https://repository.jboss.org/nexus/content/groups/public/com/google/guava/guava/)上不存在番石榴库（在此版本中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:22:48.007

Maven 无法知道世界上有哪些 Maven 存储库。它只能看到您声明的存储库。

除非您付出了额外的努力，否则您总是拥有 Maven 中央存储库，然后是其他任何存储库。几乎你想要的一切都在中央：使用[search.maven.org](http://search.maven.org/)来搜索它。

如果您想要的东西不在中央，那么您就无法确定它是否在其他地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T00:21:28.893

通常使用 Maven 依赖项，除非您被明确告知，否则您会期望在 maven Central 中找到它们，这是 maven 的默认位置，不需要显式配置。

# rtmp - 我将如何使用 rtmpdump 下载此流？

> ID：14087135
> 
> 赞同：9
> 
> 时间：2012-12-30T00:13:50.113
> 
> 标签：rtmp

我是 rtmpdump 的新手，正在努力学习。有什么想法可以使用 rtmpdump 下载此流吗？

```
<script type="text/javascript" src="http://castalba.tv/js/jwplayer.js"></script>
    <script type="text/javascript">
        jwplayer("mediaspace").setup({
        'flashplayer': "http://static.castalba.tv/player.swf",
        'width': '650',
        'height': '400',
        'allowfullscreen':'true',
        'allowscriptaccess':'always',
        'wmode':'opaque',
        'controlbar':'over',
        'dock':'true',
        'dock.position':'left',
        'mute':'false',
        'stretching':'uniform',
        'autostart': 'true',
        'rtmp.subscribe': 'true',
        'file': 'ChelTV_Ch01_1000k@26291',
        'streamer': 'rtmpe://cp96798.live.edgefcs.net/live/',
        'rtmp.tunneling': 'false',
        'logo.file':'http://castalba.tv/images/playerlogo.png',
        'logo.hide':'false',
        'logo.position':'top-right',
        'logo.link':'http://castalba.tv',
        'abouttext':'CastAlba.TV - Stream Live Video',
        'aboutlink':'http://castalba.tv',
        'skin':'http://static.castalba.tv/bluez.zip'
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-10-07T10:10:26.713

根据[Emre 的回答](https://stackoverflow.com/a/17404343/624466)，对于那些想要使用 ffmpeg（而不是 flv）保存 mp4 文件的人，您可以使用以下命令：

```
ffmpeg -i "rtmp://domain.com/path/to/video.mp4" -vcodec copy -acodec copy out.mp4 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-01T12:18:07.983

您可以使用 ffmpeg 保存实时流，类似于 rtmp 转储。下载适用于 windows 或 linux 的 zeranoe ffmpeg 构建。使用 cmd line 到达目录。

```
ffmpeg -i "stream_link" -y -f flv emre.flv 
```

其中 stream_link 可以是 udp:// ... rtmp://... rtsp://... http://...

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-05-02T16:37:31.170

我无法流式传输上面代码片段中提到的 url，无论如何我在 Ubuntu 系统中的操作是：

`$ sudo apt-get install rtmpdump`

这将安装 rtmpdump。然后将 rtmp 流下载到文件“downloaded_file.mp4”，我使用：

`$ rtmpdump -r rtmp://example.com/path/to/video -o downloaded_file.mp4`

-r 后跟 rtmp 流，-o 后跟将保存流的文件名。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-06-05T20:00:56.800

对于 Google Chrome，我开发了一个扩展程序，可以帮助您捕获任何流媒体链接。这是个好助手，名字叫[Grab Any Media](http://grabanymedia.altervista.org/)，希望能帮助你捕捉到这个链接，在主站点你可以找到更多的视频教程

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T15:04:42.017

使用 rtmp explorer 查看页面。 [http://www.videohelp.com/tools/RTMPExplorer](http://www.videohelp.com/tools/RTMPExplorer)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-08T05:41:23.247

如果流是**实时**的，那么您必须使用**-v**开关

例如，如果示例 url 是*rtmp://serverip/live/streamname*然后使用 rtmpdump 的以下命令行开始下载**直播**流

```
rtmpdump -r "rtmp://serverip/live/streamname" -o "anyfileNameforOutput.mp4" -v 
```

请注意，您可以通过在命令行中键入以下内容来查看**rtmpdump的所有详细命令行参数**

```
rtmpdump --help 
```

您可以使用[此链接](https://rtmpdump.mplayerhq.hu/)下载**RTMPDUMP**。

# r - 如何添加行中包含的特定数据？

> ID：14087136
> 
> 赞同：3
> 
> 时间：2012-12-30T00:13:55.063
> 
> 标签：r, plyr

我是 R 新手。这是我的具体问题。假设我正在使用以下名为“data”的数据集，用于此示例。我的标题是`state`,`type`和`value`.

```
structure(list(state = structure(c(1L, 1L, 1L, 1L, 2L, 2L), .Label = c("AK", 
"AL"), class = "factor"), type = structure(c(2L, 2L, 1L, 1L, 
2L, 1L), .Label = c(" D", " R"), class = "factor"), value = c(100L, 
200L, 100L, 150L, 100L, 150L)), .Names = c("state", "type", "value"
), class = "data.frame", row.names = c(NA, -6L))

  state type value
1    AK    R   100
2    AK    R   200
3    AK    D   100
4    AK    D   150
5    AL    R   100
6    AL    D   150 
```

我想编写一个函数，将每种类型和状态的值相加。例如。对于`AK`类型`R`，输出为 300。对于`AK`类型`D`，输出为 250。对于`AL`类型`R`，输出为 100，对于`AL`类型`D`，输出为 150。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T00:25:23.203

不是plyr，只是`aggregate`

```
> aggregate(value~state+type, data=data,FUN=sum)
  state type value
1    AK    D   250
2    AL    D   150
3    AK    R   300
4    AL    R   100 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T00:24:23.700

你可以使用[`tapply`](http://www.sigmafield.org/2009/09/20/r-function-of-the-day-tapply)

```
data <- read.csv(header=TRUE,text="state, type, value
AK, R, 100
AK, R, 200
AK, D, 100
AK, D, 150
AL, R, 100
AL, D, 150")

tapply(data$value, list(data$state,data$type), sum)
#     D   R
# AK  250 300
# AL  150 100 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-30T00:36:19.920

尽管@Matthew Lundberg 的回答是最好的，但这里有一些替代方案。

如果你真的想使用 plyr 你可以这样做：

```
ddply(DF, .(state, type), numcolwise(sum))
  state type value
1    AK    D   250
2    AK    R   300
3    AL    D   150
4    AL    R   100 
```

这是使用 reshape2 包的另一个解决方案

```
library(reshape2)
dcast( melt(DF), state + type ~ variable, sum)
Using state, type as id variables
  state type value
1    AK    D   250
2    AK    R   300
3    AL    D   150
4    AL    R   100 
```

如果您只想要一个向量，那么这可能很有用：

```
sapply(with(DF, split(value, list(state, type))), sum)
AK.D  AL.D  AK.R  AL.R 
250   150   300   100 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-30T00:34:16.757

一个 plyr 解决方案是：

```
ddply(data, .(state,type),summarise, total=sum(value, na.rm = TRUE))
#   state type total
# 1    AK    D   250
# 2    AK    R   300
# 3    AL    D   150
# 4    AL    R   100 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-30T10:07:01.220

为了完整起见，还有“data.table”包，`by`在基础 R 中。假设您的数据集称为“myd”：

```
by(myd$value, list(myd$state, myd$type), FUN=sum)
# : AK
# :  D
# [1] 250
# ------------------------------------------------------------------------------ 
# : AL
# :  D
# [1] 150
# ------------------------------------------------------------------------------ 
# : AK
# :  R
# [1] 300
# ------------------------------------------------------------------------------ 
# : AL
# :  R
# [1] 100

library(data.table)
DT <- data.table(myd)
DT[, sum(value), by = "state,type"]
#    state type  V1
# 1:    AK    R 300
# 2:    AK    D 250
# 3:    AL    R 100
# 4:    AL    D 150 
```

# java - 如何从 Java 中的包中访问不在包中的文件

> ID：14087141
> 
> 赞同：0
> 
> 时间：2012-12-30T00:14:31.310
> 
> 标签：java, package

我尝试搜索如何从 Java 包中访问不在指定包中的文件，但无法找到答案。有谁知道怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:43:51.750

如果您的意思是要从命名包访问默认（未命名）包中的 CLASS，则不能。JLS 是这样说的：

> *“未命名包中的类型（第 7.4.2 节）没有规范名称，因此每种导入声明中对规范名称的要求意味着（a）无法导入未命名包中的类型，以及（b）静态无法导入未命名包中的类型成员。因此，第 7.5.1 节、第 7.5.2 节、第 7.5.3 节和第 7.5.4 节在任何尝试导入类型时都需要编译时错误（或其静态成员）在一个未命名的包中。”*

这意味着您不能使用单一类型的导入。并且“通配符”导入将不起作用，因为您无法命名包。

^(是的，您可以通过使用反射来解决此限制，但它非常麻烦，并且会使您的代码变得缓慢和脆弱。如果您想了解 Java 中的反射，请从这里开始 - [http://docs.oracle.com/javase/tutorial/reflect/index.html](http://docs.oracle.com/javase/tutorial/reflect/index.html)。但这不是解决这个“问题”的好方法。)

正确的解决方案是使用包……正如 Java 语言设计者所期望的那样。JLS 是这样说的：

> *“Java SE 平台提供了未命名的包，主要是为了在开发小型或临时应用程序或刚开始开发时方便。”*

这意味着您应该*只*将 / 一个未命名的包用于小型/临时应用程序（或作为权宜之计），而对于任何严重的事情都应该使用命名包。

* * *

如果您的意思是要访问未命名包中的文件（例如资源），那么您只需在资源名称前面加上一个斜杠即可；例如

```
 InputStream is = classLoader.getResourceAsStream("/someresource"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:19:03.157

你不能没有反思。

真的不鼓励使用“默认包”（根本没有包），这是阻止它的原因之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T00:36:12.300

“默认”包实际上是根目录。使用绝对路径：

```
URL url = getClass().getResource("/myphoto.jpg");
InputStream in = getClass().getResourceAsStream("/myphoto.jpg"); 
```

使用 7zip/WinZip 等打开创建的 jar。您应该在根目录中看到该文件。

# python - 如何在 tkinter 中使用文件对话框来获取文件名？

> ID：14087146
> 
> 赞同：1
> 
> 时间：2012-12-30T00:14:56.470
> 
> 标签：python, tkinter

我正在编写一个小程序来在 python tkinter 的条目对话框中输入文件名。当前使用输入对话框的代码允许我手动输入文件名。但是，我希望使用文件浏览器类型的功能来代替手动输入文件。另外，我希望不在对话框本身中打开文件，而是将整个路径存储到变量中。有可能这样做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T00:53:32.760

使用`tkFileDialog.askopenfilename()`，如 [tkinter.unpythonic.net](http://tkinter.unpythonic.net/wiki/tkFileDialog)网页中所述。

`askopenfilename(**options)`获取一个或多个名称并具有选项`defaultextension, filetypes, initialdir, initialfile, multiple, message, parent, title`

# android - 将随机大小的图像放入 ImageView

> ID：14087147
> 
> 赞同：-1
> 
> 时间：2012-12-30T00:14:58.470
> 
> 标签：android, imageview

我有一个图像视图，稍后将包含一些随机大小的图像我想用图像填充图像视图但保持比例（所以不要使用比例类型 FITXY 或 centercrop，因为它会修剪我的图像的一部分）

我怎样才能做到这一点 ？

在这个测试代码中，我的图像左右两边都有空格

```
 <?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"

     >

   <ImageView
        android:id="@+id/imgTest"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:adjustViewBounds="true"
        android:scaleType="fitCenter"

        android:src="@drawable/test"
      /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:46:11.077

用矩阵和屏幕的高度/宽度解决

```
private Bitmap resize(Bitmap bm, int w, int h)
    {
        int width = bm.getWidth();
        int height = bm.getHeight();
        int newWidth = w;
        int newHeight = h;
        float scaleWidth = ((float) newWidth) / width;
        float scaleHeight = ((float) newHeight) / height;

        Matrix matrix = new Matrix();
        matrix.postScale(scaleWidth, scaleHeight);
        Bitmap resizedBitmap = Bitmap.createBitmap(bm, 0, 0, width, height, matrix, true);

        return resizedBitmap;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T14:19:54.050

试试这个：

```
<ImageView
    android:id="@+id/imgTest"
    android:layout_width="wrap_content"
    android:layout_height="100dp"
    android:layout_alignParentLeft="true"
    android:paddingRight="20dp"
    android:scaleType="fitStart"
    android:src="@drawable/test"/> 
```

# javascript - 登录到路由器

> ID：14087148
> 
> 赞同：0
> 
> 时间：2012-12-30T00:15:15.630
> 
> 标签：javascript, basic-authentication

我制作了一个简单的脚本来显示来自路由器的数据，但是有一个错误：

无法加载资源

但位置可用。那么问题的真正原因可能是什么。

```
var xmlhttp = null;
if ( window.ActiveXObject )
{
    xmlhttp = new ActiveXObject ( "Microsoft.XMLHTTP" );
} 
else 
{
xmlhttp = new XMLHttpRequest();
}

xmlhttp.open ( "POST", "http://" + routerIP + port + link, true );
xmlhttp.setRequestHeader ( "Content-type", "application/x-www-form-urlencoded" );
//base64UserPass in format user:pass
xmlhttp.setRequestHeader ( "Authorization", "Basic " + base64UserPass );
xmlhttp.setRequestHeader ( "Connection", "close" );

xmlhttp.onreadystatechange = function() 
{
    if ( xmlhttp.readyState == 4 )
    {
        document.write ( xmlhttp.responseText );
    } 
    else 
    {
        alert ( "Error ocurred: server not responding!\n" + xmlhttp.responseText );
    }
};

xmlhttp.send ( "" ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T00:16:42.517

出于安全原因，您不能使用 AJAX 与不同的域进行交互。

这是完全不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:23:17.887

jQuery 还支持 ACD（AJAX 跨域）。检查[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)（设置“crossDomain”）

# kernel - 如何使用 PID 从服务器层获取进程名称

> ID：14087151
> 
> 赞同：1
> 
> 时间：2012-12-30T00:15:25.257
> 
> 标签：kernel, minix

我希望能够使用进程的名称，`servers/sched/schedule.c`但是`schedproc`结构不包含名称变量。我考虑过使用`endpoint_lookup()`函数来获取指向`proc`结构的指针，但由于它是在中定义的，`kernel/proc.c`我不确定是否可以在`schedule.c`（从用户空间）中调用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T08:21:38.713

在用户空间中，您可以使用`/proc/<pid>/cmdline`来获取进程的名称，例如

```
$cat /proc/$$/cmdline 
```

`bash`

# css - 图像之间的内部间距？

> ID：14087152
> 
> 赞同：1
> 
> 时间：2012-12-30T00:15:40.443
> 
> 标签：css

我想用缩略图创建一个画廊，但是我遇到了一个问题。如果我想隔开拇指，我应该做类似的事情`margin-right: 15px;`，但是这会为最右边的图像创造空间。如果不将它们放在模板的边缘，我将如何创建这些空间？

例子： ![在此处输入图像描述](../Images/a941d3fcc3bedf43b3b022d40de23c9d.png)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:30:32.597

您需要的是容器元素上的负边距：

[http://jsfiddle.net/LYhum/](http://jsfiddle.net/LYhum/)

```
.container {
    margin: -10px 0 0 -10px;
}

.container .image {
    margin: 10px 0 0 10px;
    /* either floated or set to inline-block */
} 
```

如果您的容器是响应式的（即您不知道它的宽度），那么 flexbox 值得一看：

[http://jsfiddle.net/LYhum/4/](http://jsfiddle.net/LYhum/4/)（对于不支持 flexbox 的浏览器有后备）

```
.container {
    margin: -10px 0 0 -10px;
    display: flex;
    -moz-flex-flow: row wrap;
    -webkit-flex-flow: row wrap;
    flex-flow: row wrap;
    -moz-justify-content: space-between;
    -webkit-justify-content: space-between;
    justify-content: space-between;
}

.container .image {
    margin: 10px 0 0 10px;
    background: red;
    width: 100px;
    height: 100px;
    display: inline-block;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T00:27:57.870

如果你想让它们均匀分布，边缘到边缘，你必须做一些数学运算。

用你想要的边距减去正方形的宽度，这样就没有间隙了。

```
(width of container) - ((# of squares)*(width of squares))
divided by (# of squares - 1)) == margin required for even spacing 
```

例如：

如果容器宽度是 300 像素，正方形是 30 像素，则让 margin-right == 37.5 像素（150 像素除以 4（它们之间有 4 个空格））...*然后使用类似 :last-child 的技巧来纠正最后一个正方形. （或者只是硬编码最后一个方格上的 0 边距）*如果不进行正确的数学运算，最后一个方格的间距将与其他 4 个方格不同。

```
| ------------------------   300px    ------------------| == the container
|square1-----square2-----square3-----square4-----square5|
|   ^     ^    ^      ^    ^      ^     ^      ^    ^
|  30   37.5   30    37.5  30   37.5   30    37.5  30   | == 300px

* not to scale :)

.square {
    width:30px;
    margin-right:37.5px;
}
#square5 {
    margin-right:0;
} 
```

**编辑**这将完全取决于容器的宽度...如果它不是以像素为单位硬编码（即它是 %），那么我建议做同样的数学运算，但使用 %width 和 %margin反而。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T00:17:54.767

我在这里假设`<li>`，但如果我错了，请纠正我：

```
ul.thumbs li {
  margin-right: 15px;
}
ul.thumbs li:last-child {
  margin-right: 0;
} 
```

使用`:last-child`伪选择器。（请记住一些[怪癖](http://www.quirksmode.org/css/firstchild.html)）

# android - ScrollView 和 Achartengine 位置和崩溃

> ID：14087154
> 
> 赞同：1
> 
> 时间：2012-12-30T00:16:11.253
> 
> 标签：android, charts, scrollview, achartengine, android-scrollview

我正在使用适用于 Android 的 Achartengine，并且我的布局由 LinearLayout 中的 ScrollView 母亲组成。它包含一个线性布局，它是图形和一些文本视图和编辑文本。

问题是，如果我在 LinearLayout 的顶部插入图形然后程序运行，但如果我在底部插入图形，在所有 textview 和 edittext 之后程序崩溃。为什么？

这是我的 XML 代码：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:fillViewport="true" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

        <!-- android:layout_weight="1" -->

        <LinearLayout
            android:id="@+id/chart"
            android:layout_width="fill_parent"
            android:layout_height="200dp"
            android:layout_margin="2dp"
            android:orientation="horizontal" />

        <TextView
            android:id="@+id/txtX"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="X: 0"
            android:textSize="15sp" >
        </TextView>

        <TextView
            android:id="@+id/txtZ"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="39dp"
            android:text="Z: 0"
            android:textSize="15sp" />

        <TextView
            android:id="@+id/txtY"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="35dp"
            android:text="Y: 0"
            android:textSize="15sp" />

        <TextView
            android:id="@+id/txtM"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="35dp"
            android:text="M: 0"
            android:textSize="15sp" />

        <TextView
            android:id="@+id/txtM2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="35dp"
            android:text="M: 0"
            android:textSize="15sp" />

        <EditText
            android:id="@+id/et1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="39dp"
            android:ems="10"
            android:focusable="false"
            android:inputType="textMultiLine" >
        </EditText>
    </LinearLayout>

</ScrollView> 
```

谢谢！:)

PS：这是应用程序崩溃时的LogCat：

```
12-31 13:56:26.839: I/ActivityManager(169): Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10000000 cmp=com.spettro1/.MainActivity } from pid 2688
12-31 13:56:26.849: I/Launcher(2252): onPause()
12-31 13:56:26.859: D/AndroidRuntime(2688): Shutting down VM
12-31 13:56:26.889: I/AndroidRuntime(2688): NOTE: attach of thread 'Binder Thread #3' failed
12-31 13:56:26.899: I/ActivityManager(169): Start proc com.spettro1 for activity com.spettro1/.MainActivity: pid=2697 uid=10125 gids={}
12-31 13:56:26.969: I/OrientationDebug(169): [pwm] in updateOrientationListenerLp()
12-31 13:56:26.969: V/OrientationDebug(169): in updateOrientationListenerLp(), Screen status=true, current orientation=-1, SensorEnabled=true
12-31 13:56:26.969: I/OrientationDebug(169): [pwm] needSensorRunningLp(), return true #4
12-31 13:56:26.979: I/Launcher(2252): onWindowFocusChanged(false)
12-31 13:56:26.989: D/Launcher(2252): setWallpaperDimension() called
12-31 13:56:26.989: D/Launcher(2252): USE_NON_SCROLLABLE_IMAGE_WALLPAPER is true
12-31 13:56:27.019: D/Launcher(2252): It's image wallpaper. suggestDesiredDimensions(-1,-1)
12-31 13:56:27.039: D/SensorManager(2697): ====>>>>>Num Sensor: 1
12-31 13:56:27.039: D/SensorManager(2697): ====>>>>>Num Sensor: 2
12-31 13:56:27.039: D/SensorManager(2697): ====>>>>>Num Sensor: 3
12-31 13:56:27.039: D/SensorManager(2697): ====>>>>>Num Sensor: 4
12-31 13:56:27.039: D/SensorManager(2697): ====>>>>>Num Sensor: 5
12-31 13:56:27.039: D/SensorManager(2697): ====>>>>>Num Sensor: 6
12-31 13:56:27.039: D/SensorManager(2697): ====>>>>>Num Sensor: 0
12-31 13:56:27.039: E/SensorManager(2697): registerListener :: handle = 1600940398  name= Linear Acceleration Sensor delay= 10000 Listener= com.spettro1.MainActivity@40519c70
12-31 13:56:27.049: E/SensorManager(2697): =======>>>Sensor Thread RUNNING <<<========
12-31 13:56:27.049: E/SensorHAL(169): +__poll_activate: handle=0 enabled=1
12-31 13:56:27.119: D/AndroidRuntime(2697): Shutting down VM
12-31 13:56:27.119: W/dalvikvm(2697): threadid=1: thread exiting with uncaught exception (group=0x40018578)
12-31 13:56:27.139: E/AndroidRuntime(2697): FATAL EXCEPTION: main
12-31 13:56:27.139: E/AndroidRuntime(2697): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.spettro1/com.spettro1.MainActivity}: java.lang.ClassCastException: android.widget.LinearLayout
12-31 13:56:27.139: E/AndroidRuntime(2697):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at android.os.Looper.loop(Looper.java:130)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at android.app.ActivityThread.main(ActivityThread.java:3687)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at java.lang.reflect.Method.invokeNative(Native Method)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at java.lang.reflect.Method.invoke(Method.java:507)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at dalvik.system.NativeStart.main(Native Method)
12-31 13:56:27.139: E/AndroidRuntime(2697): Caused by: java.lang.ClassCastException: android.widget.LinearLayout
12-31 13:56:27.139: E/AndroidRuntime(2697):     at com.spettro1.MainActivity.initComponents(MainActivity.java:112)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at com.spettro1.MainActivity.onCreate(MainActivity.java:94)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-31 13:56:27.139: E/AndroidRuntime(2697):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
12-31 13:56:27.139: E/AndroidRuntime(2697):     ... 11 more
12-31 13:56:27.139: W/ActivityManager(169):   Force finishing activity com.spettro1/.MainActivity
12-31 13:56:27.149: E/(169): Dumpstate > /data/log/dumpstate_app_error
12-31 13:56:27.649: W/ActivityManager(169): Activity pause timeout for HistoryRecord{4082f818 com.spettro1/.MainActivity} 
```

这是 initComponents() 内 112 行附近的崩溃代码：

```
 txtX = (TextView) findViewById(R.id.txtX);
        txtY = (TextView) findViewById(R.id.txtY);
        txtZ = (TextView) findViewById(R.id.txtZ);
        txtM = (TextView) findViewById(R.id.txtM);
        txtM2 = (TextView) findViewById(R.id.txtM2); 
112     ed1 = (EditText) findViewById(R.id.et1); 

        for(int i=0; i<camp.length; ++i)
            camp[i]=0; 
```

注意：textview 和 edittext 的定义是全局的（在 mainactivity 的顶部）和私有的，事实上它们在图形位于顶部时运行。

Edit1：我尝试将 XML 中的第一个 LinearLayout 更改为 TableLayout，然后我验证问题不是第一个 LinearLayout，而是我实现图形的 LinearLaoyut：

```
LinearLayout layout = (LinearLayout) findViewById(R.id.chart);
mChartView = ChartFactory.getBarChartView(getBaseContext(), dataset, multiRenderer, BarChart.Type.DEFAULT);
layout.addView(mChartView); 
```

这在编译器标记错误的 initComponents() 中调用。我试图在 textview 声明之前插入这个声明和实例化，唯一改变的是 logcat 没有标记任何指定的错误，只是在 ActivityThread.performLaunchActivity(ActivityThread$ActivityClientRecord, Intent) 行崩溃：1651。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:45:37.457

我解决了向 LinearLayout 父级添加 ID 的问题：

```
android:id="@+id/general" 
```

我不知道它为什么会起作用，所以我感觉很糟糕，因为我担心它将来是否会起作用。也许线性布局之间存在冲突。如果有人理解解决方案可以在这里写。

谢谢你帮助我！@芒果

# java - Netty 握手问题

> ID：14087158
> 
> 赞同：0
> 
> 时间：2012-12-30T00:16:55.780
> 
> 标签：java, http, asynchronous, netty

为了获得与服务器的异步握手，我有以下代码，但我似乎无法弄清楚为什么我无法连接到该网站。

```
import java.net.InetSocketAddress;
import java.net.SocketAddress;
import java.util.Arrays;
import java.util.Date;
import java.util.concurrent.Executor;
import java.util.concurrent.Executors;

import org.jboss.netty.bootstrap.ClientBootstrap;
import org.jboss.netty.channel.Channel;
import org.jboss.netty.channel.ChannelFactory;
import org.jboss.netty.channel.ChannelFuture;
import org.jboss.netty.channel.ChannelFutureListener;
import org.jboss.netty.channel.ChannelHandler;
import org.jboss.netty.channel.ChannelPipeline;
import org.jboss.netty.channel.ChannelPipelineFactory;
import org.jboss.netty.channel.Channels;
import org.jboss.netty.channel.socket.nio.NioClientSocketChannelFactory;
import org.jboss.netty.handler.codec.http.HttpRequestDecoder;
import org.jboss.netty.handler.codec.http.HttpRequestEncoder;
import org.jboss.netty.handler.codec.http.HttpResponseDecoder;
import org.jboss.netty.handler.logging.LoggingHandler;

public class Handshake
{
    public static String remoteHost = "http://google.com";
    public static int remotePort = 80;
    private static ClientBootstrap bootstrap;
    private static Channel channel;
    private static final ChannelHandler HTTP_REQUEST_ENCODER = new HttpRequestEncoder();
    private static final ChannelHandler HTTP_REQUEST_DECODER = new HttpRequestDecoder();
    private static final ChannelHandler HTTP_RESONPSE_DECODER = new HttpResponseDecoder();
    private static final ChannelHandler LOG_HANDLER = new LoggingHandler();

    public static void main(String[] args)
    {
        attemptConnection();
    }

    public static void attemptConnection()
    {
        Thread thread = new Thread()
        {
            public void run()
            {
                Executor bossPool = Executors.newCachedThreadPool();
                Executor workerPool = Executors.newCachedThreadPool();
                ChannelFactory channelFactory = new NioClientSocketChannelFactory(bossPool, workerPool);
                ChannelPipelineFactory pipelineFactory = new ChannelPipelineFactory()
                {
                    public ChannelPipeline getPipeline() throws Exception
                    {
                        ChannelPipeline pipeline = Channels.pipeline();
                        pipeline.addLast("requestencoder", HTTP_REQUEST_ENCODER);
                        pipeline.addLast("reqeustdecoder", HTTP_REQUEST_DECODER);
                        pipeline.addLast("responsedecoder", HTTP_RESONPSE_DECODER);
                        pipeline.addLast("logger", LOG_HANDLER);
                        return pipeline;
                    }
                };
                bootstrap = new ClientBootstrap(channelFactory);
                bootstrap.setPipelineFactory(pipelineFactory);
                SocketAddress address = new InetSocketAddress(remoteHost, remotePort);

                ChannelFuture cf = bootstrap.connect(address);
                cf.addListener(new ChannelFutureListener()
                {
                    public void operationComplete(ChannelFuture future)
                    {
                        // check to see if we succeeded
                        if (!future.awaitUninterruptibly().isSuccess())
                        {
                            System.out.println("Failed to connect to server.");
                            bootstrap.releaseExternalResources();
                        }
                        else
                        {
                            System.out.println("Connected.");
                            channel = future.getChannel();
                            channel.write(new Date());
                        }
                    }
                });
            }
        };
        thread.start();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T00:39:04.767

因为`http://google.com`不是主机，所以它是一个 URL。

```
ChannelFuture future = bootstrap.connect(new InetSocketAddress("google.com", 80)); 
```

**编辑添加：** `InetSocketAddress`如果无法解析主机名，则不会引发异常。你必须检查`isUnresolved()`-

```
InetSocketAddress i = new InetSocketAddress("http://google.com", 80);

if (i.isUnresolved())
    System.out.println("Yup"); 
```

此外，`future.getCause()`可能对这个问题有更多的了解；我必须对其进行测试以验证。

# javascript - 嵌入视频总是自动播放

> ID：14087163
> 
> 赞同：1
> 
> 时间：2012-12-30T00:18:29.177
> 
> 标签：javascript, html, css, video

我不明白为什么我的嵌入式总是自动播放。

```
<div id="body15">
    <video width="480" height="270" controls>
        <source src="videos/ryan1.ogg" type="video/ogg">
        <source src="videos/ryan1.mp4" type="video/mp4">
        <source src="videos/ryan1.webm" type="video/webm">
        <object data="videos/ryan1.mp4" width="480" height="270">
            <embed width="600" height="270" src="movie.swf">
        </object>
    </video>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:54:11.073

你试过controls="controls"吗？

```
<video width="480" height="270" controls="controls">
    <source src="videos/ryan1.ogg" type="video/ogg">
    <source src="videos/ryan1.mp4" type="video/mp4">
    <source src="videos/ryan1.webm" type="video/webm">
    <object data="videos/ryan1.mp4" width="480" height="270">
        <embed width="600" height="270" src="movie.swf">
    </object>
</video> 
```

# haskell - Haskell：在堆分析期间使用未装箱的元组会导致奇怪的类型

> ID：14087164
> 
> 赞同：6
> 
> 时间：2012-12-30T00:18:42.863
> 
> 标签：haskell, profiling

最初，我有一段代码如下：

```
data Something = Something !Word32 !Word32

retrieveSomething :: Socket -> IO (Something)
retrieveSomething sock = do
    ...

function sock = do
    (Something x y) <- retrieveSomething sock
    let (a,b,c) = case x of
      0 -> (foo,bar,baz)
      1 -> (foo2,bar2,baz2)
      ...

    doIOwithParams a b c 
```

我使用`-hy -hC"..."`RTS 选项对其进行了分析。

查看堆配置文件，我发现使用 3 元组会消耗太多内存，因此我使用`(# a,b,c #)`了似乎更适合返回多个值的未装箱元组扩展名（即 ）。

我或多或少确信堆使用量已经减少，因为我`stuff`在尝试未装箱的元组之前通过显式调用来测试它，但是通过这样做，我现在无法观察成本中心分配的不同类型的值。

为了更清楚地说明这个问题，我可以看到在没有未装箱元组的情况下分析应用程序后，Something 类型（以及其他任何东西）在堆中占用了多少空间值。现在，在堆图上只能看到一种类型，我认为它与我在函数调用中进行的可变哈希表调用有关。

有没有办法来解决这个问题？

编辑：虽然未装箱的元组没有出现在配置文件上是完全有道理的，但我仍然很困惑为什么使用它们会隐藏函数调用/成本中心中的*所有其他内容。*

我尝试使用显式调用而不是使用未装箱的元组进行分析，如下所示：

```
 case x of
      0 -> doIOwithParams foo bar baz
      1 -> doIOwithParams foo2 bar2 baz2 
```

除了能够看到 3 元组的开销不再存在之外，函数中使用的Something 和所有其他类型也是可见的，这与我只能看到节点类型的未装箱元组的情况相反（这可能与我正在使用的哈希表有关，也可能不相关）与其他类型相比几乎没有空间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T12:56:39.420

> 我已经看到使用 3 元组消耗了太多内存，所以我使用了未装箱的元组扩展名（即 (#a,b,c#)），它似乎更适合返回多个值。

只需使用具有严格字段的​​常规数据类型。然后 GHC 可以将它映射到堆栈上的堆或未装箱的元组，因为它认为合适。

```
data Something = Something {-# UNPACK #-}!Word32 {-# UNPACK #-}!Word32 
```

这具有未装箱元组的所有优点，没有任何缺点。

# c# - 自动刷新数据到数据库

> ID：14087165
> 
> 赞同：3
> 
> 时间：2012-12-30T00:18:46.033
> 
> 标签：c#, nhibernate, fluent-nhibernate

99% 肯定这只是我不知道要搜索什么，所以请随时向我指出正确的术语，但这里有。

我正在开发一个使用 Fluent NHibernate 将数据存储在 SQLite 后端的项目。它的负载极低（启动时读取十几次左右，然后可能每分钟写入一次或 2 次作为高负载。）我正在尝试比其他任何东西更容易编写，所以我想要它所以我只需更改对象的属性，它就会自动将其刷新到后端。就像我说的，这是一个负载非常低的单用户应用程序，所以即使（最坏的情况）5 次写入一秒钟也不会那么明显。

我确实知道我可以在属性设置器中设置保存，但我正在尝试减少冗余代码，这对我来说似乎过于冗余。

我正在寻找的是这样的

```
class MainConfig
{
    public virtual bool Enabled { get; set; }
} 
```

然后能够将其绑定到控件，以便对控件的更改命中属性，然后将其保存。

使用很多额外的代码，我可以完成它

```
class MainConfig
{
    bool _Enabled;
    public virtual bool Enabled
    {
        get { return _Enabled; }
        set { _Enabled = value; mainSession.Save() }
    }
} 
```

其中 mainSession 是一个 ISession，在应用程序的整个生命周期中都是静态的

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T14:25:55.753

这不是完美的解决方案，但我想出的是一个 T4 模板，它处理每个配置对象并为其构建代理及其所有属性。

```
class MainConfigProxy : MainConfig
{
    public override Enabled
    {
         get { return base.Enabled; }
         set
         {
             base.Enabled = value;
             mainSession.Save();
         }
    }
} 
```

然后构建一个包含基类及其代理的类型字典。

然后我的代码检查该字典，如果有代理，则加载/实例化它。不完美，但节省了很多打字

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:24:46.333

您需要做的就是刷新会话。以下示例来自[nHibernate 参考文档](http://nhforge.org/doc/nh/en/index.html#manipulatingdata-flushing)。

```
sess = sf.OpenSession();
ITransaction tx = sess.BeginTransaction();
sess.FlushMode = FlushMode.Commit; //allow queries to return stale state
Cat izi = (Cat) sess.Load(typeof(Cat), id);
izi.Name = "iznizi";
// execute some queries....
sess.Find("from Cat as cat left outer join cat.Kittens kitten");
//change to izi is not flushed!
...
tx.Commit(); //flush occurs 
```

请注意，文档还指出在其他时候会发生自动刷新（即您不必像前面提到的示例那样启动它）。**这对您来说是个好消息，因为这实际上就是您正在寻找的东西。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T14:09:41.703

您没有说明您正在开发的平台是什么，但一般来说，由于您使用的是数据绑定，最简单的方法是将事件处理程序附加到每个控件的更改事件。当 changed 事件触发时，数据绑定对象已更改，然后您可以将更改刷新到数据库。

# android - 向反编译的 APK 添加新活动

> ID：14087175
> 
> 赞同：-1
> 
> 时间：2012-12-30T00:20:22.177
> 
> 标签：android, android-activity, apk, decompiling

我对可以用来反编译apk的dextool和apktool有所了解。但他们都没有明确解释向反编译的 APK 添加任何新活动。有可能吗，如果你能给我一个例子或任何链接引导我解释吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T00:55:27.013

首先不要以险恶的方式使用它，我们已经有足够多的人这样做了。可以通过从现有源导入将反编译的应用程序添加到 eclipse 中。在此您可以添加一个新类，然后导出一个签名包（使用新密钥对其进行签名）。

一步一步可以在[这里](http://kkinder.com/2011/11/27/so-you-want-to-reverse-engineer-an-android-app-apk/)找到。

# jquery - 将一个表单附加到另一个 jQuery

> ID：14087180
> 
> 赞同：5
> 
> 时间：2012-12-30T00:21:35.823
> 
> 标签：jquery, forms, submit

我有两个表单，我想在表单一个提交期间动态地将第二个表单的所有输入字段附加到第一个表单。我更喜欢jquery。我想附加为隐藏输入。我在 javascript 中有工作解决方案

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T00:25:21.263

```
$("#form1").find(":input").appendTo("#form2"); 
```

# android - 在简单适配器上使用自定义字体出现错误，错误是什么？

> ID：14087185
> 
> 赞同：-1
> 
> 时间：2012-12-30T00:22:16.837
> 
> 标签：android, layout, simpleadapter

我是 android 新手...我想在我的 android 项目中使用自定义字体，所以我把我的代码[库放在这个教程上](https://stackoverflow.com/questions/3651086/android-using-custom-font)。我想在 R.id.Headline 和一些 xml 元素中使用我的自定义字体

我的问题是：

- 我的代码有问题吗？

- 有没有从 xml 构建自定义 UI 的教程？

这是我的代码

```
 import java.util.ArrayList;
    import java.util.HashMap;
    import java.util.concurrent.ExecutionException;

    import android.app.ListActivity;
    import android.content.Context;
    import android.net.ConnectivityManager;
    import android.net.NetworkInfo;
    import android.os.Bundle;
    import android.util.Log;
    import android.view.Menu;
    import android.view.MenuInflater;
    import android.view.View;
    import android.view.ViewGroup;
    import android.widget.ListAdapter;
    import android.widget.ListView;
    import android.widget.SimpleAdapter;

    public class MainActivity extends ListActivity {
        private static String url = "http:some url";
        private static final String TAG_HEADLINE = "headline";
        private static final String TAG_PROVIDER = "provider";
        private static final String TAG_TYPE = "deal_type";
        private static final String TAG_BLURB = "blurb";
        private static final String TAG_FEATURED = "featured";
        private static final String TAG_URL = "url";
        private static final String TAG_PRICE = "price";
        private static final String TAG_LOCATION = "location";
        private static final String TAG_IMAGE = "image";
        private static final String TAG_OFFER = "offer";
        private static final String TAG_THUMBNAIL = "thumbnail";
        private static final String TAG_FORMATED = "formatted";
        ArrayList<HashMap<String, String>> dealArrayList = new ArrayList<HashMap<String, String>>();

        @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            MenuInflater inflater = getMenuInflater();
            inflater.inflate(R.menu.activity_main, menu);
            return super.onCreateOptionsMenu(menu);
        }

        @Override
        protected void onCreate(Bundle savedInstanceState) {

            super.onCreate(savedInstanceState);
            try {
                ArrayList<HashMap<String, String>> deals = new NetraAsycn()
                        .execute(url).get();
                ListAdapter adapter = new SimpleAdapter(this, deals,
                        R.layout.list_item, new String[] { TAG_THUMBNAIL,
                                TAG_FORMATED, TAG_PROVIDER, TAG_LOCATION,
                                TAG_HEADLINE }, new int[] { R.id.thumbnail,
                                R.id.price, R.id.provider, R.id.location,
                                R.id.headline });
  Typeface myTypeface = Typeface.createFromAsset(getAssets(), "fonts/myFont.ttf");
    TextView myTextView = (TextView)findViewById(R.id.headline);
    myTextView.setTypeface(myTypeface);

                setListAdapter(adapter);
                ListView lv = getListView();
                lv.setDividerHeight(0);

            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {

                e.printStackTrace();
            }

        }

        public View getView(int position, View convertView, ViewGroup parent) {
            View rowView = convertView;
             if (rowView == null) {
                  LayoutInflater inflater = context.getLayoutInflater();
                  rowView = inflater.inflate(R.layout.list_item, null);
                  ViewHolder viewHolder = new ViewHolder();
                  viewHolder.text = (TextView) rowView.findViewById(R.id.TextView01);
                  viewHolder.image = (ImageView) rowView
                      .findViewById(R.id.ImageView01);
                  rowView.setTag(viewHolder);
                }
            return rowView;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:11:11.910

几周前我遇到了同样的问题。我认为在这种“createFromAsset”方法中使用目录是不可能的。将您的字体文件复制到您的父资产目录中。

```
Typeface myTypeface = Typeface.createFromAsset(getAssets(), "myFont.ttf"); 
```

你的logcat在说什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:00:15.680

你的代码没问题。我也以同样的方式使用了自定义字体。作为：

```
Typeface typeFace = Typeface.createFromAsset(getAssets(),"fonts/LCALLIG.TTF");          
textView.setTypeface(typeFace); 
```

只需检查字体名称是否正确，是否正确复制到资产文件夹中。
如果是，则显示您的错误或 logcat。

# winapi - 帕斯卡中的 System() 函数？

> ID：14087190
> 
> 赞同：-2
> 
> 时间：2012-12-30T00:23:09.027
> 
> 标签：winapi, pascal, freepascal, fpc

我需要 Pascal 程序中的 C++ 函数“System()”的功能。有没有可能使用它或类似的方法？

比如我想模仿C++函数：

```
System("COLOR fc"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T01:09:52.460

C++ 库函数`system`启动一个新进程。在我看来，FreePascal 函数`SysUtils.ExecuteProcess`会做你想做的事。

如果您真正想做的只是更改控制台上的背景颜色，您的另一种选择是调用 Windows API 函数[SetConsoleTextAttribute](http://msdn.microsoft.com/en-us/library/ms686047%28v=vs.85%29.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T21:15:10.213

问题有点复杂。有几种方法可以解决这个问题。

1.  在***nix 上，**系统可以作为 unix.fpsystem() 使用。（虽然不严格 100% 与 libc 系统函数相同）

2.  在**Windows**上，FPC 是*原生的*，不能通过 POSIX 或 C 库层工作。因此，Windows 上没有 system() 仿真。

3.  sysutils.Executeprocess 抽象了 Windows“createprocess(ex)”和*nix Exec* () 函数。这不是用于 shell 扩展，并且需要执行二进制文件的完整路径（例如，通过使用 fsearch 或等效的 Delphi 函数）

4.  Process.TProcess 是另一个涉及更多此类抽象的抽象，可以访问更多功能（如管道）。2.6.2 中流程单元的新功能是 Runcommand 函数，它们是常见情况的简单 tprocess 包装器。

5.  此外，问题是在 Windows 上有很多不同的方法可以做这样的事情，那么选择什么？

    1.  旧的和跨 Windows 版本的移植方式：搜索 command.com 并使用 /C 执行
    2.  old/console 风格，NT 方式，使用 COMSPEC 用 /C 启动 cmd.exe
    3.  GUI方式，使用shellexecute()。主要用于启动与扩展相关的浏览器和其他应用程序。
    4.  创建自己的，搜索 PATH，展开环境变量，自己解析 cmdline，然后调用基本的 createprocess() 例程。

一般来说，我会使用 shellexecute ，除非它真的是命令行的东西（比如这个特定的情况），然后我会使用方法 5.2。

稍后添加，经过验证的执行过程代码（方法 5.2）

```
uses 
 Sysutils;
begin
  ExecuteProcess(getenvironmentvariable('COMSPEC'), ['/C','COLOR fd']);
end. 
```

请注意，我将命令 (color fd) 作为一个参数传递，尽管 afaik 在 *nix 情况下更为重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T17:32:01.720

`system()`调用特定于平台的命令行处理器。例如，在 Windows 上，`system("command")`调用`CreateProcess()`invoke `%COMSPEC% /C "command"`，其中`%COMSPEC%`是`command.com`或`cmd.exe`取决于 Windows 版本。

# git - 从存储库历史记录中删除提交

> ID：14087197
> 
> 赞同：1
> 
> 时间：2012-12-30T00:24:33.020
> 
> 标签：git, github, commit

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T00:38:51.460

# php - SELECT 语句无法正常工作

> ID：14087198
> 
> 赞同：1
> 
> 时间：2012-12-30T00:24:33.670
> 
> 标签：php, sql, database, select

我正在使用此代码从我创建的表中检索数据。

```
SELECT id,shirt_name,boys FROM shirts WHERE boys IS NOT NULL 
```

它不只是选择男孩列输入的行，而是选择所有这些行。这是我创建表格的方式

```
CREATE TABLE shirts (
    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY NOT NULL,
    shirt_name VARCHAR(20) NOT NULL,
    men VARCHAR(10) NULL,
    women VARCHAR(10) NULL,
    boys VARCHAR(10) NULL,
    girls VARCHAR(10) NULL,
    babies VARCHAR(10) NULL,
)ENGINE=INNODB;

INSERT INTO shirts(shirt_name,men,women,boys,girls,babies) VALUES
    ('Crewneck Tee','me_crn','wo_crn','bo_crn','gi_crn','ba_crn'),
    ('V-Neck Tee','me_vnc','wo_vnc','','',''),
    ('Scoop Neck Tee','','wo_sco','','',''),
    ('Raglan Tee','me_rag','wo_rag','bo_rag','gi_rag',''),
    ('Ringer Tee','me_rin','wo_rin','bo_rin','gi_rin',''),
    ('Cap Sleeve Tee','','wo_cap','','gi_cap',''),
    ('Tank Top','me_tan','wo_tan','bo_tan','gi_tan',''),
    ('Spaghetti Strap','','wo_spa','','',''),
    ('Hoodie','me_hod','wo_hod','bo_hod','gi_hod','ba_hod'); 
```

我做错什么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T00:26:00.727

您没有`NULL`在`boys`列中插入任何记录。只记录空字符串。并且空字符串 ( `''`) 与 不同`NULL`，所以它匹配`IS NOT NULL`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T00:31:50.037

```
SELECT id,shirt_name,boys FROM shirts WHERE boys != '' 
```

是您需要使用此数据的内容吗

# tcl - TCL等待时间倒计时

> ID：14087207
> 
> 赞同：1
> 
> 时间：2012-12-30T00:25:31.273
> 
> 标签：tcl, eggdrop

```
if {[info exists queue($variable)} {
    if {[expr [unixtime] - $queue($variable)]<86400} {
        set calctime [expr [unixtime] - queue($variable)]
        putquick "PRIVMSG $channel :you cant because you need to wait $calctime"
    }
}
set queue($variable) [unixtime] 
```

我的 Tcl 脚本中有这段代码，所以每个用户都需要等待 24 小时才能再次执行该命令。我会倒计时显示他们需要等待多少时间（小时、分钟、秒）才能再次执行此操作。但此刻我唯一能做的就是将秒数与`$calctime`

知道我该怎么做吗？绝对我的尝试`$calctime`是失败的：P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T07:42:47.200

将秒视为相对于具有[时钟格式](http://www.tcl.tk/man/tcl8.6/TclCmd/clock.htm#M7)的纪元。不要遗漏`-gmt 1`，否则你会弄错几个小时。多少取决于你所在的时区。

```
putquick "PRIVMSG $channel :you cant because you need to wait \
  [clock format $calctime -format "%T" -gmt 1]" 
```

或者自己计算：

```
set seconds [expr {$calctime % 60}]
set calctime [expr {$calctime / 60}]
set minutes [expr {$calctime % 60}]
set hours [expr {$calctime / 60}]
putquick "PRIVMSG $channel :you cant because you need to wait \
  $hours hours, $minutes minutes and $seconds seconds" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:16:57.800

要显示用户必须等待的时间，您可以使用 eggdrop 特定命令`duration`。

```
if {[info exists queue($variable)} {
    if {[clock seconds] - $queue($variable) < 60*60*24 } {
        set calctime [duration [expr {[clock seconds] - queue($variable)}]]
        putmsg $channel "you cant because you need to wait $calctime"
        return
    }
}
set queue($variable) [clock seconds]
# Do the command stuff 
```

# sql - 以下是在 SSRS 中实现级联参数的合法方式吗？

> ID：14087211
> 
> 赞同：1
> 
> 时间：2012-12-30T00:25:56.540
> 
> 标签：sql, stored-procedures, ssrs-2008, reporting-services

我知道这可能是一个非常新手的问题，但我想在 SSRS 中使用带有 CASE 和 WHEN/THEN 语句的查询。但这会被允许吗？附上图片： ![在此处输入图像描述](../Images/1b0879dcb4ec7a4b343099a8da426873.png)

这是我的 SSRS 的屏幕，所以我有 6 个参数 - 最后一个参数 ClientResponseRange 被隐藏并依赖于 ResponseRange。对于除一种以外的所有情况，ClientResponseRange 只会获得与 ResponseRange 获得的完全相同的参数：

![在此处输入图像描述](../Images/86c6f3e32af052a5753197b67a8e0e40.png)

那么这里是这些参数的图片：

![在此处输入图像描述](../Images/d6e43942a780cfdabf92befc33f3650e.png)![在此处输入图像描述](../Images/b915d4c138b24905d2f39ed5b1917559.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T09:14:52.550

您应该设置一个虚拟查询或内置 vb 代码来接收`@ResponseRange`并吐出您想要的字符串。

示例 sql：

```
Select case when :ResponseRange= '3' then null
            Else :ResponseRange
       End as out1 
```

`@ClientResponseRange`然后，您应该使用“从查询中获取值”选项设置此查询的默认值。

# angularjs - AngularJS plupload 指令绑定问题

> ID：14087216
> 
> 赞同：0
> 
> 时间：2012-12-30T00:27:07.900
> 
> 标签：angularjs

我正在尝试为 plupload 创建一个指令。为了一次一步完成，我首先在不使用指令（控制器和标准 html）的情况下使文件上传工作。然后我添加了指令并成功地让 html 正确呈现。不幸的是，plupload 绑定随后中断了。

乍一看，在 plupload 进行绑定之前，该指令*似乎*没有呈现，但是如果我在代码中添加日志语句，该指令确实返回了哈希值，并且所有 html 元素似乎都存在于 DOM 中。

关于如何使这项工作的任何想法？

### html

```
<div ng-controller="ProfilePhotoUploader">
    This does not work
    <uploader url="<%= profile_image_uploader_path %>"></uploader>

    This works
    <div id="profile-image-container">
        <div id="select-file">Select File</div>
        <div id="drop-area">Drop file here</div>
        <button class="button small" ng-click="upload('<%= profile_image_uploader_path %>')">Upload File</button>
    </div>
  </div> 
```

### 上传者.js

```
var uploader = angular.module('uploader', []);

uploader.directive('uploader', function () {
alert("in directive");
return  {
    restrict: 'E',
    scope: {
        url:'@'
    },
    templateUrl: "/assets/uploader.html"
}
}); 
```

### 资产/uploader.html

```
<div id="profile-image-container">
  <div id="select-file">Select File</div>
  <div id="drop-area">Drop file here</div>
  <button class="button small" ng-click="upload('{{url}}')">Upload File</button>
</div> 
```

### profile_photo_uploader.js

```
var ProfilePhotoUploader = function ($scope) {

console.log($("uploader"));
$scope.uploader = new plupload.Uploader({
    runtimes: "html5",
    browse_button: 'select-file',
    max_file_size: '10mb',
    container: "profile-image-container",
    drop_element: "drop-area",
    multipart: true,
    multipart_params : {
        authenticity_token: $('meta[name="csrf-token"]').attr('content'),
        _method: 'PUT'
    },
    filters: [
        {title: "Image Files", extensions: "jpg,jpeg,png"}
    ]
});

$scope.upload = function(url) {
    $scope.uploader.settings.url = url;
    $scope.uploader.start();
};

$scope.uploader.init();
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T19:11:09.693

这是该指令的两个版本的[小提琴。](http://jsfiddle.net/mrajcok/tsSJA/)一个不会创建新的范围。另一个创建一个隔离范围。我发现 ng-click 不能包含 {{}}，所以我们需要使用编译函数通过属性参数 (tAttrs) 将 URL 字符串获取到模板中。

**没有新的范围**。HTML：

```
<uploader url="http://someplace.com/pic.jpg" upload-fn="upload"></uploader> 
```

指示：

```
myApp.directive('uploader', function () {
    return {
        restrict: 'E',
        templateUrl: "/assets/uploader.html",
        compile: function (tElement, tAttrs) {
            var buttonElement = tElement.find('button')
            buttonElement.attr('ng-click', tAttrs.uploadFn + "('" + tAttrs.url + "')")
            console.log(tElement.html())
        }
    }
}); 
```

上面，该指令使用与控制器相同的作用域，因此 ng-click 属性的值被设置为调用 HTML 中的 upload-fn 属性定义的函数。

upload-fn 属性不是必需的，但它确实使指令更可重用，因为指令被告知要调用什么范围方法——“上传”——因此可以在 HTML 中轻松更改。如果可重用性不是问题，这里有一个更简单的选择：

HTML：

```
<uploader url="http://someplace.com/pic.jpg"></uploader> 
```

指令变更：

```
buttonElement.attr('ng-click', "upload('" + tAttrs.url + "')") 
```

**隔离范围**。HTML：

```
<uploader-isolate url="http://someplace.com/pic.jpg" upload-fn="upload(url)">
</uploader-isolate> 
```

指示：

```
myApp.directive('uploaderIsolate', function () {
    return {
        restrict: 'E',
        scope: {
            uploadFn: '&'
        },
        templateUrl: "/assets/uploader.html",
        compile: function (tElement, tAttrs) {
            var buttonElement = tElement.find('button')
            buttonElement.attr('ng-click', "uploadFn({url:'" + tAttrs.url + "'})")
            console.log(tElement.html())
        }
    }
}); 
```

上面，该指令创建了一个新的范围——一个*隔离*范围。这个范围在原型上不是从父/控制器范围继承的，所以它（和指令的模板）不能访问在控制器的 $scope 上定义的 upload() 函数。'&' 符号用于创建“委托”uploadFn 函数。这意味着当“uploadFn”用于隔离作用域时（即，在指令的模板中），它实际上会调用父作用域上的“upload”函数。

此外，我们指定上传函数采用一个参数*url*。当在指令模板中使用委托函数时，我们不能只传递一个参数。即，这不起作用：uploadFn('http://...')。相反，我们需要使用映射/对象来指定任何参数值。例如，uploadFn({url: 'http://...'})。

隔离范围对象哈希不包含`url: '@'`，因为我认为属性 ng-click 的值不能包含`{{}}`s。这就是我们使用编译函数并通过编译函数的属性参数获取url属性值的原因。如果 url 值仅在模板中的其他地方使用，例如`<span>url = {{url}}</span>`，则将使用 '@' 表示法。

修改了模板以删除 ng-click 属性的值。该值被分配给编译函数中的属性。

```
<button class="button small" ng-click>Upload File</button> 
```

# objective-c - 当我不为 Core Data 标量属性编写访问器方法时会发生什么？

> ID：14087218
> 
> 赞同：1
> 
> 时间：2012-12-30T00:27:18.203
> 
> 标签：objective-c, core-data, nsmanagedobject

我正在使用用于生成 NSManagedObject 子类的几个核心数据实体，在生成这些类时，我选择了“使用原始数据类型的标量属性”选项。正如预期的那样，在生成的接口中，整数属性被声明为`int16_t`属性，浮点属性被声明为属性：`float`

```
@interface TeamStats:NSManagedObject
@property (nonatomic) int16_t pointsScored;
@property (nonatomic) float winPercentage;
@end 
```

在此接口的生成实现中，我看到这些属性声明为`@dynamic`：

```
@implementation TeamStats
@dynamic pointsScored;
@dynamic winPercentage;
@end 
```

现在，根据 Core Data 文档，我应该需要为这些标量属性编写访问器方法，因为 Core Data 无法为我生成它们：

> 您可以将属性声明为标量值，但对于标量值，Core Data 不能动态生成访问器方法——您必须提供自己的实现（参见“托管对象访问器方法”（第 44 页））。Core Data 自动合成原始访问器方法（primitiveLength 和 setPrimitiveLength:)，但您需要声明它们以抑制编译器警告。

这一切都是有道理的，我可以看到许多 SO 帖子询问应该如何编写这些访问器方法，并提供了很多好的答案。

我想不通的是：我在阅读文档中的这个细节之前就编写了这段代码并开始使用它，所以我从未编写过任何访问器方法。我的类实现中只有@dynamic 声明。尽管没有编写我应该需要的访问器方法，但代码似乎工作得很好。我已经创建了这个 NSManagedObject 子类的实例。我已发送此类 a 的实例`setPointsScored:`和一条`pointsScored`消息，并将生成的实例保存到其持久性存储中。一切似乎都奏效了。

我在这里想念什么？尽管 Core Data 文档说了什么，是否会生成默认实现？是否会有我需要注意的当前代码不起作用的情况？在编写更多 NSManagedObject 子类之前，我很想了解这里发生了什么......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T13:43:12.733

为原始数据类型创建标量访问器是 Xcode 4 引入的一项功能，但显然没有很好的文档记录。WWDC 2011 会议视频中提到了它

*   “303 iOS 核心数据的新功能”（幻灯片 95）
*   “315 Mac OS X 上核心数据的新功能”（幻灯片 90）

根据这些会话的信息，标量访问器避免了构造`NSNumber`对象的开销，因此它们比“核心数据编程指南”中显示的实现更有效。

所以回答你的问题：标量属性的默认访问器是自动生成的。“Core Data Programming Guide”关于这个特性已经过时了。

# objective-c - 学习手册保留/释放的价值是什么？(iOS)

> ID：14087219
> 
> 赞同：2
> 
> 时间：2012-12-30T00:27:52.067
> 
> 标签：objective-c, ios, memory-management, automatic-ref-counting

> **可能重复：**
> [到 ARC 还是不到 ARC？优缺点都有什么？](https://stackoverflow.com/questions/8760431/to-arc-or-not-to-arc-what-are-the-pros-and-cons)

我刚刚开始使用 Objective-C 和 iOS 开发。似乎自动引用计数（ARC）现在（并且已经有一段时间了）为 OSX 和 iOS 开发处理内存管理的首选方式。

此时学习手动保留/释放 (MRR) 有什么好处？跳过 MRR 并直接转向 ARC 有什么好处？

我目前的经验几乎完全是垃圾收集语言，包括 AS3、Java 和 JavaScript。我有兴趣了解有关内存管理的更多信息，但由于 ARC 实际上禁止使用`retain`、`release`、`autorelease`、`retainCount`和`dealloc`，所以我不愿意编写使用这些的代码。

我也没有预见到我未来会转向低级编程，所以如果跳过 MRR 意味着我仍然不了解内存管理最佳实践，这些实践最终可能不会对我产生重大影响。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T00:38:11.647

我认为您不太可能需要编写使用`retain`,`release`等的代码。我想不出为什么您需要开始编写这样的代码的许多原因。

话虽如此，我发现在编写应用程序时了解编译器代表我在做什么非常有帮助。了解一些细节将帮助您编写更好优化的代码。

因此，作为 Objective-C 的初学者，我认为刚开始时不应该过多关注内存管理细节，但是随着您的专业知识的增长，我相信它是有用的背景信息，可以帮助您编写更好的代码，即使你总是使用ARC。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T00:44:06.447

实际上有几个原因可以理解手动保留/释放。显而易见的答案是维护旧的 iOS 和 MAC 项目。另一个原因是 Core Foundation 对象不使用 ARC。此外，手动范例中有一些非常有用的内存管理模式。

查看这些资源以获取更多信息...

[ARC还是不ARC？优缺点都有什么？](https://stackoverflow.com/questions/8760431/to-arc-or-not-to-arc-what-are-the-pros-and-cons)

[http://www.learn-cocos2d.com/2012/06/mythbusting-8-reasons-arc/](http://www.learn-cocos2d.com/2012/06/mythbusting-8-reasons-arc/)

# clojure - 无法在 incanter 1.4.0 中创建矩阵

> ID：14087222
> 
> 赞同：3
> 
> 时间：2012-12-30T00:28:13.240
> 
> 标签：clojure, leiningen, incanter

我在学习 clojure 时正在玩 incanter，当我尝试在 lein 下的 REPL 中创建矩阵时，我不断收到错误消息：

```
user=> (use 'incanter.io)
nil
user=> (use 'incanter.core)
nil
user=> (def A (matrix [[1 2 3] [4 5 6] [7 8 9]])) 
NoSuchMethodError edu.emory.mathcs.utils.ConcurrencyUtils.getThreads
BeginN_2D()Icern.colt.matrix.tdouble.impl.DenseColumnDoubleMatrix2D.assign (DenseColumnDoubleMatrix2D.java:661) 
```

它看起来像一个依赖问题，但不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T01:33:03.240

使用 [org.clojure/clojure "1.4.0"] 和 [incanter "1.4.1"] 遇到同样的问题。Def 有一种类路径阴影的感觉。

在 repl 中执行以下操作来确定 ConcurrencyUtils 来自哪个 jar：

```
(.getResource edu.emory.mathcs.utils.ConcurrencyUtils
    "/edu/emory/mathcs/utils/ConcurrencyUtils.class") 
```

这指向 jplasma。果然，jplasma 有它自己的那个类的副本，其中有各种方法，包括缺少 getThreadsBeginN_2D。

查看 deps（“lein pom”后跟“mvn dependency:tree”）表明这是由 incanter 1.4.1 引入的依赖项：

```
[INFO] |  +- incanter:incanter-core:jar:1.4.1:compile
[INFO] |  |  +- org.clojure:math.combinatorics:jar:0.0.3:compile
[INFO] |  |  \- net.sourceforge.parallelcolt:parallelcolt:jar:0.10.0:compile
[INFO] |  |     +- net.sourceforge.jplasma:jplasma:jar:1.2.0:compile 
```

将 project.clj 中的 incanter 条目更改为排除 jplasma：

```
[incanter "1.4.1"
    :exclusions [net.sourceforge.jplasma/jplasma]] 
```

这从 jtransforms 获取 ConcurrencyUtils（因此仍然不是从 parallelcolt），但至少解决了矩阵问题：

```
=> (matrix [[1 2 3] [4 5 6] [7 8 9]])
[1.0000 2.0000 3.0000
4.0000 5.0000 6.0000
7.0000 8.0000 9.0000] 
```

不知道排除的影响是什么。clojars 上有一个旧版本的 jplasma 不会破坏矩阵，您可以尝试将其添加到您的 project.clj：

```
[incanter/jplasma "0.9.4"] 
```

不过，这些部门显然需要由了解它们的人正确分类。

# c++ - c++在linux下编译运行

> ID：14087226
> 
> 赞同：-1
> 
> 时间：2012-12-30T00:29:06.827
> 
> 标签：c++, linux, pointers, g++

> **可能重复：**
> [未定义的引用](https://stackoverflow.com/questions/2569399/undefined-reference-to)

在我的目录中，我有：

```
main.cpp
tree.cpp
tree.h 
```

我在 main.cpp 中包含了 tree.h

```
#include "tree.h" 
```

然后在我的主要功能中我写

```
tree* t=new tree() 
```

为了编译我会做

```
g++ main.cpp 
```

但我有错误

```
undefined reference to `tree::tree()' 
```

有什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T00:31:35.207

您还需要编译和链接 Tree 源代码：

```
$ g++ -c -o tree.o tree.cpp
$ g++ -o test main.cpp tree.o 
```

运行您的应用程序：

```
$ ./test 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T00:46:06.883

您可能想为此创建一个 make 文件。一个 make 文件将自动编译多个文件程序。

例如，您可以创建一个文件“makefile”，其中包含 billz 建议的行。

```
all:
    g++ -c -o tree.o tree.cpp
    g++ -o test main.cpp tree.o 
```

然后，`make`从 makefile 文件夹中的终端运行将执行该`all`部分。

有关 makefile 的更多信息，请参阅[http://www.cs.bu.edu/teaching/cpp/writing-makefiles/](http://www.cs.bu.edu/teaching/cpp/writing-makefiles/)

我还没有测试过上面的代码，可能需要进行一些调整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T01:47:04.747

放头球后卫，像这样

```
#ifndef NAME_H
#define NAME_H

//your codes

#endif 
```

# haskell - ST有多严格

> ID：14087230
> 
> 赞同：3
> 
> 时间：2012-12-30T00:30:07.370
> 
> 标签：haskell

ST Monad中的[STRef](http://hackage.haskell.org/packages/archive/base/4.3.0.0/doc/html/Data-STRef.html)有多严格？如果我向 STRef 写一些东西，我能确定它会在没有空间泄漏的情况下得到全面评估吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T00:34:36.610

这是您可以轻松测试自己的事情。

```
Prelude Data.STRef Control.Monad.ST> :{
| runST $ do
|   newSTRef (error "strict!")
|   return "not strict!"
| :}
"not strict!" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-30T00:40:03.097

`ST`monad 本身是严格的，因为它强制执行严格的事件排序。直观地说，当您评估时，`runST`您不会“直到”所有从内存中读取和写入的信息都完成。但是，在执行严格性方面就是这样。例如，`STRef`默认是惰性的（存在严格版本）。您可能想要恢复严格性，例如

```
writeSTRef r $! 7 
```

至于避免空间泄漏……这是一个更复杂的问题。仅仅使用正确的 monad 是不够的。

# php - 多个日期列按第一个即将到来的日期的顺序 Mysql

> ID：14087231
> 
> 赞同：0
> 
> 时间：2012-12-30T00:30:12.143
> 
> 标签：php, mysql

我有个问题。多个 Dj 正在我们的收音机上制作音乐，但我们想制定一个时间表，所以我们制作了很多关于 DJ 信息的专栏，但也在十二个不同的专栏中包含十二个日期时间戳。

问题是，我如何选择第一个即将到来的日期？或者我如何选择日期高于当前日期的第一列。以及以下的。

如果解决了这个问题，我在回显它时遇到了另一个问题，因为它下面的脚本如何知道我使用了哪个变量。

我使用了以下变量和列：$date1、$date2、$date3 等。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T02:44:09.663

通常，我会通过执行正常的 SELECT 语句但将结果限制为“1”并使用 WHERE 子句来获取日期，并确保结果按日期排序，从而从数据库中获取下一个（即将到来的）日期。

在下面的示例中，我从数据库中选择了下一个日期的记录，其中也可能包括今天本身。如果您不关心今天的记录，那么只需将选择命令中的“newtime”变量更改为“todaydate”。

```
$todaydate = date('Y-m-d');
$newdate = strtotime ( '-1 day' , strtotime ( $todaydate ) ) ;
$newdate = date ( 'Y-m-j' , $newdate );

SELECT * FROM table WHERE date > '$newdate' ORDER BY table.`date`ASC LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T06:44:53.670

```
SELECT *
FROM (
    SELECT dj, 'date1' whichdate, if (date1 >= now(), date1, null) nextdate
    union
    SELECT dj, 'date2' whichdate, if (date2 >= now(), date2, null) nextdate
    union
    SELECT dj, 'date3' whichdate, if (date3 >= now(), date3, null) nextdate
    union
    SELECT dj, 'date4' whichdate, if (date4 >= now(), date4, null) nextdate
    union
    SELECT dj, 'date5' whichdate, if (date5 >= now(), date5, null) nextdate
    union
    SELECT dj, 'date6' whichdate, if (date6 >= now(), date6, null) nextdate
    union
    SELECT dj, 'date7' whichdate, if (date7 >= now(), date7, null) nextdate
    union
    SELECT dj, 'date8' whichdate, if (date8 >= now(), date8, null) nextdate
    union
    SELECT dj, 'date9' whichdate, if (date9 >= now(), date9, null) nextdate
    union
    SELECT dj, 'date10' whichdate, if (date10 >= now(), date10, null) nextdate
    union
    SELECT dj, 'date11' whichdate, if (date11 >= now(), date11, null) nextdate
    union
    SELECT dj, 'date12' whichdate, if (date12 >= now(), date12, null) nextdate
)
WHERE nextdate IS NOT NULL
ORDER BY dj, nextdate 
```

# javascript - 带有 Bootstrap 模态视图的 Rails 应用程序，包含表单、提交和消失模态视图，无需重新加载页面

> ID：14087235
> 
> 赞同：1
> 
> 时间：2012-12-30T00:30:32.783
> 
> 标签：javascript, ruby-on-rails, twitter-bootstrap, modal-dialog

我有一个 Rails 应用程序，它在模式视图中为访问者提供一个表单。单击提交按钮时，我希望表单提交并且模式视图消失而不重新加载其后面的页面。我已经尝试将模态视图的解除绑定到 javascript 中表单的提交函数，但它无法正常工作。我是 javascript 新手，所以我可能没有正确编写脚本。这是我所拥有的：

```
<script type="text/javascript">
    $("document").on("submit", ".new_user", function() {
        $('.signup').modal("close");
    });
</script>
<fieldset>

      <!-- The sign up modal view -->
       <div id="signup" class="modal hide fade in" style="display: none;">  
        <% @user = User.new %>
        <%= form_for(@user, :remote => true) do |f| %>
        <div class="modal-header">  
          <a class="close" data-dismiss="modal">×</a>  
          <h3>Want to be notified when preorders start? Fill out this form!</h3>  
        </div>  
        <div class="modal-body">  
            <div class="field">
              <%= f.label :email %>
              <%= f.text_field :email, :class => 'modal_input'%>
            </div>
            <div class="field">
              <%= f.label :website %>
              <%= f.text_field :website, :class => 'modal_input'%>
            </div>
            <div class="field">
              <%= f.label :projects, "Projects you've worked on"  %>
              <%= f.text_area :projects, :size => "43x10", :class => 'modal_input' %>
            </div>
        </div>
        <div class="modal-footer">  
        <button type="submit" class="btn btn-success">Submit</button>
        </div>  
       </div>  
      <% end %>

       <!-- The modal view is triggered here -->
        <a data-toggle="modal" href="#signup" class="btn btn-primary
        btn-large btn-signup">Sign up</a>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>  
        <script src="/twitter-bootstrap/twitter-bootstrap-v2/js/bootstrap-modal.js"></script>
  </fieldset> 
```

我的 javascript 函数没有关闭模式视图。功能有什么问题？

**编辑**：更新了 javascript 函数，仍然无法正常工作

**编辑 2**：如果有帮助的话，结果是根本没有调用 javascript 函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:50:47.833

`close()`不是 jQuery 方法，也不是 Bootstrap 模态库的工作方式。此外，应该将提交绑定更改为绑定，以便在设置绑定后将内容插入 DOM。

您可能应该将您的功能更改为以下内容：

```
$(function () {
  $("document").on("submit", ".new_user", function() {
      $('.signup').modal("close");
  });
}); 
```

此外，请确保您已在此函数之前加载了 jQuery 和 Bootstrap 模态脚本文件。

# jquery - 获取真正的 iphone 分辨率 - jquery

> ID：14087236
> 
> 赞同：3
> 
> 时间：2012-12-30T00:30:50.820
> 
> 标签：jquery, iphone, ipad, resolution

我正在编写一个 jQuery 插件，它需要精确的屏幕分辨率。

众所周知，iphone 响应 320*480（iphone 4），但我需要正确的尺寸（视网膜尺寸）。

当然，视网膜 ipad 也存在问题。

在这种情况下我该怎么办？

感谢您的回复。

**/编辑**

好的，我已经做到了，但我认为有一个错误

我的脚本：

```
var screenWidth = $(window).width() * window.devicePixelRatio;
var screenHeight = $(window).height() * window.devicePixelRatio;

i get the following values:
portrait:
screenWidth = 640
screenHeight = 960

landscape:
screenWidth = 960
screenHeight = 960 
```

带有以下元标记：

```
meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:36:43.133

在 webkit 浏览器中，您可以使用`window.devicePixelRatio`. 将其乘以分辨率，您应该得到您正在寻找的数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:36:47.307

您应该将其乘以 2，您将获得真正的分辨率。[http://smartphones.techcrunch.com/q/152/4793/What-are-the-specifications-of-the-Apple-iPhone-4S-smartphone](http://smartphones.techcrunch.com/q/152/4793/What-are-the-specifications-of-the-Apple-iPhone-4S-smartphone)

# iphone - UIView 布局被重置

> ID：14087245
> 
> 赞同：1
> 
> 时间：2012-12-30T00:33:11.397
> 
> 标签：iphone, ios, uiview, uitextview

我正在使用情节提要创建我的初始状态`view`。然后我有一个`button`改变布局的（它扩展了一个`UITextView`占据屏幕的一半）。

每当我尝试以编程方式更改屏幕上标签的文本时，`UIView`都会重置为情节提要布局。

是否有一种方法可以将 a 重置`UIView`为导致这种情况发生的初始状态？或任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:36:03.330

您为情节提要打开了自动布局。自动布局系统将（在不同时间）根据情节提要中的布局约束设置视图层次结构中每个视图的位置和大小。

您可以[在 storyboard 中关闭自动布局](https://stackoverflow.com/questions/13201586/nsinvalidunarchiveoperationexception-could-not-instantiate-class-named-nslayout/13201690#13201690)，也可以通过修改布局约束来调整文本视图的大小。

如果您想使用自动布局并修改约束，请至少观看 WWDC 2012 的这三个视频中的第一个：

*   [第 202 课 - iOS 和 OS X 的自动布局简介](https://developer.apple.com/videos/wwdc/2012/?id=202)
*   [会话 228 - 掌握自动布局的最佳实践](https://developer.apple.com/videos/wwdc/2012/?id=228)
*   [会话 232 - 示例自动布局](https://developer.apple.com/videos/wwdc/2012/?id=232)

# mysql - MySQL不会将整数保存到十进制列中

> ID：14087248
> 
> 赞同：0
> 
> 时间：2012-12-30T00:33:48.863
> 
> 标签：mysql, sql, decimal, currency

我有这些值需要保存到 MySQL 中（列**DECIMAL 10, 2**）。

```
-500.00
-500.00
35000.00 
```

当 PHP 脚本将这些值保存到数据库中并且我将查看这些保存的值时，只有：

```
500.00
500.00
5000.00 
```

怎么可能？

**编辑：**

保存到数据库：

```
mysql_query("INSERT INTO table (name, address, salary) VALUES ('$name', '$address', $salary)"); 
```

我还尝试在**$salary**中添加撇号，但同样的事情，并没有帮助我保存正确的值。

**编辑2：**

当我在执行 SQL 查询之前用这些数字打印出变量时，这些值是正确的。但是当我打印出当前执行的 SQL 查询时，有不正确的值......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T00:43:32.793

列定义应该*不*`DECIMAL(10, 2)`跟在后面。丢失的符号可能是由“未签名”引起的。*`UNSIGNED`*

 *35000.00 上的错误可能是输出错误 ( `sprintf`)。

**最统一的是，您在输出时删除第一个字符。**

也许你试图改变一个'。薪水一无所有，删除第一个字符。*

# javascript - 将元素作为第一个参数传递给 JavaScript 中的事件处理程序的最简单方法是什么？

> ID：14087249
> 
> 赞同：5
> 
> 时间：2012-12-30T00:33:52.507
> 
> 标签：javascript, jquery, event-handling, bind, this

我知道`this`在事件处理函数中将值更改为接收事件的元素非常有用。但是，我想让我的函数总是在我的应用程序上下文中调用，而不是在元素上下文中。这样，我可以将它们用作事件处理程序以及以其他方式（例如在`setTimeout`调用中）。

所以，像这样的代码：

```
window.app = (function () {
    var that = {
        millerTime: function () {},
        changeEl: function (el) {
            el = el || this;
            // rest of code...
            that.millerTime();
        }
    };
    return that;
}()); 
```

可能是这样的：

```
window.app = (function () {
    return {
        millerTime: function () {},
        changeEl: function (el) {
            // rest of code...
            this.millerTime();
        }
    };
}()); 
```

第一种方式让我看起来很困惑。有没有一种简单的方法可以将接收事件的元素作为第一个参数（最好是 jQuery 包装的元素）传递给我的事件处理函数并在 的上下文中调用`app`？假设我使用 jQuery 绑定了一堆事件处理程序。我不想一直包含匿名函数：

```
$('body').on('click', function (event) {
    app.changeEl.call(app, $(this), event);  // would be nice to get event too
}); 
```

我需要一个函数来为我处理这一切。在这一点上，我觉得传递匿名函数是没有办法的，但我只是想看看是否有人有解决方案。

我的尝试：

```
function overrideContext (event, fn) {
   if (!(this instanceof HTMLElement) ||
         typeof event === 'undefined'
   ) {
       return overrideContext;
   }

   // at this point we know jQuery called this function // ??
   var el = $(this);

   fn.call(app, el, event);
}

$('body').on('click', overrideContext(undefined, app.changeEl)); 
```

**编辑：** 使用`Function.prototype.bind`（我是新手），我仍然无法获得元素：

```
window.app = (function () {
    return {
         millerTime: function () {},
         changeEl: function (el) {
            // rest of code...
            console.log(this); // app
            this.millerTime();
         }
    };
}());

function overrideContext (evt, fn) {
    var el = $(this); // $(Window)
    console.log(arguments); // [undefined, app.changeEl, p.Event] 
    fn.call(app, el, event);
}

$('body').on('click', overrideContext.bind(null, undefined, app.changeEl)); 
```

`$('body').on('click', overrideContext.bind(app.changeEl));`相反，使用`this`指向我的`app.changeEl`函数，我的参数长度为 1 并且仅包含`p.Event`. 在这两种情况下，我仍然无法获取元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T00:38:35.627

您可以使用`Function.prototype.bind`.

```
$('body').on('click', overrideContext.bind(null, undefined, app.changeEl)); 
```

您也可以传入实际`element`作为方法的上下文

```
$('body').on('click', overrideContext.bind(app.changeEl)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T16:51:53.420

我相信你的错误是试图控制哪些参数将传递给事件处理程序。如果您真的非常想要，您必须创建自己的事件处理实用程序，就像 jQuery 一样，并手动调用处理程序，传递您想要的任何参数作为参数。

但是，你真的需要吗？如果您依赖于附加的常规处理程序`addEventListener`，或者附加有 jQuery 中可用的各种方法之一的处理程序，您将始终将`event`对象作为第一个参数。并且触发事件的元素将始终在`event.target`.

考虑到这一点，您可以`Function.prototype.bind`像 jAndy 建议的那样使用 来设置`this`您想要的任何值。

# php - Symfony 1.4 如何链接到或 url_for 管理员生成的模块？

> ID：14087250
> 
> 赞同：0
> 
> 时间：2012-12-30T00:33:59.527
> 
> 标签：php, symfony-1.4

所以我一直在使用`url_for()`链接到模块，`/frontend_dev.php`在我的链接中获取它很重要。但是，此功能不会找到管理员生成的模块。如何躲避它，让我得到 backend_dev.php 前缀？

# sql - 匹配数据库中的数据以显示正确的信息

> ID：14087252
> 
> 赞同：0
> 
> 时间：2012-12-30T00:34:14.443
> 
> 标签：sql

我有 3 个不同的数据库，我想根据要求从中获取信息。

```
CREATE TABLE IF NOT EXISTS `catbreeds` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `information_breed` varchar(30) NOT NULL,
  `information_breed_seo` varchar(30) NOT NULL,
  `information_ems` varchar(4) NOT NULL,
  `information_ipaddress` text NOT NULL,
  `fact_head` text NOT NULL,
  `fact_ears` text NOT NULL,
  `fact_eyes` text NOT NULL,
  `fact_eyecolor` text NOT NULL,
  `fact_body` text NOT NULL,
  `fact_legs` text NOT NULL,
  `fact_paws` text NOT NULL,
  `fact_tail` text NOT NULL,
  `fact_coat` text NOT NULL,
  `fact_extra` text NOT NULL,
  `date_added` datetime NOT NULL,
  `date_edited` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `id` (`id`)
)

CREATE TABLE IF NOT EXISTS `catbreeds_personality` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `information_name` varchar(50) NOT NULL,
  `information_name_seo` varchar(50) NOT NULL,
  `information_ipaddress` text NOT NULL,
  `date_added` datetime NOT NULL,
  `date_edited` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `id` (`id`)
)

CREATE TABLE IF NOT EXISTS `catbreeds_personality_links` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `id_breed` int(10) DEFAULT '0',
  `id_personality` int(10) DEFAULT '0',
  `information_ipaddress` text NOT NULL,
  `date_linked` datetime NOT NULL,
  `date_edited` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `id` (`id`)
) 
```

在源代码中，我循环来自`catbreeds_personality`数据库的个性。每个性格都链接在网站上，当我点击每个链接时，猫品种列表（从数据库中的列表中获取`catbreeds`）将在我选择的性格之后对猫品种进行排序。

* * *

**例子**

数据库中有2个猫品种`catbreeds`；`Burmilla`和`Abessinier`。

数据库有4个`catbreeds_personality`个性；`Social`, `Playful`,`Active`和`Curious`.

该`catbreeds_personality_links`数据库有 3 个关联的人物；`Social`, `Playful`, 和`Curious`.

在网站上，当访问者点击该品种的链接时，`Cursious`该品种的链接`Burmilla`将显示并`Abessinier`隐藏。如果点击个性`Social`和`Playful`，该品种`Abessinier`将显示而其他品种将隐藏。等等。我希望你明白这一切将如何运作。

* * *

这里唯一的问题是我不知道 SQL 的样子。目前我的 SQL 查询如下所示：

```
SELECT * FROM catbreeds AS cb, catbreeds_personality AS cbp, catbreeds_personality_links AS cbpl
WHERE cbp.id = '6'
AND cbpl.id_breed = cb.id
ORDER BY cb.information_breed ASC 
```

SQL 查询返回 4 个结果，其中甚至没有 ID 号 6。

我怎么解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:51:51.610

```
SELECT * FROM catbreeds_personality_links AS cbpl
INNER JOIN catbreeds AS cb ON cbpl.id_breed = cb.id
INNER JOIN catbreeds_personality AS cbp ON cbpl.id_personality = cbp.id
WHERE cbp.id = '6'
ORDER BY cb.information_breed ASC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:57:20.197

`Select * from catbreeds cb inner join catbreeds_personality_links cbpl on ( cb.id=cbpl.id_breed) inner join catbreeds_personality cbp on (cbpl.id_personality = cbp.id) where cbp.id = '6' order by cb.information_breed asc`

# perl - 检查文件是否存在，如果不存在，PERL

> ID：14087255
> 
> 赞同：-2
> 
> 时间：2012-12-30T00:34:22.490
> 
> 标签：perl

* * *

我需要 PERL 脚本的帮助，我正在尝试在 irc 机器人上执行以下操作：

*   在用户命令上查看文件是否存在。
*   如果不存在，则创建新文件，然后打印值“1”。
*   如果存在则进入下一阶段。
*   获取文件里面的文件信息，是一个数字。
*   information + 1 然后打印到一个新文件中，同名。

这是脚本：

```
 my ($who,$channel,$message) = @_;
my @things = split(' ', $message);
            my @args = @things[1..$#things]; 
```

* * *

```
 if ($message =~ /^&cookie/i && @args[0..$#args]) {

    if ( -s '@args[0..$#args].txt') { $varr = 1; goto varrr;
    } else {
    open (USER, ">", "@args[0..$#args].txt") or die "failed: $!";
    my $sum = 1;
    print USER "$sum";
    close (USER);
    }
       varrr:
       if ($varr == 1) {
    open (USER, "<@args[0..$#args].txt");
    while (my $use = <USER>) {
    my $sum = 1;
    my $newuse = ($use + $sum);

    close (USER);

    open (USER, ">@args[0..$#args].txt");
    my $usee = $use + 1;
    print USER "$newuse\n";
    close (USER);
    print $sock "PRIVMSG $channel :You have given @args[0..$#args] a cookie! \n";
    $varr = 0;
    }
    }
    }
    elsif ($message =~ /^&cookie/i) {
    print $sock "PRIVMSG $channel :Invalid parameter, use &cookie [name]. \n";
    } 
```

* * *

编辑：

已修复，goto 必须保留，谢谢大家 :)

[编辑]

D：我必须有一个名为我测试它的文件，如果该文件不存在，它现在将不再创建该文件，现在怎么办？我只有 3 天的 perl 经验。

也试过：

```
 if ($message =~ /^&cookie/i && @args[0..$#args]) {

unless ( -s '@args[0..$#args].txt') { $varr = 1;
} else {
open (USER, ">", "@args[0..$#args].txt") or die "failed: $!";
my $sum = 1;
print USER "$sum";
close (USER);
}
   varrr:
   if ($varr == 1) {
open (USER, "<@args[0..$#args].txt");
while (my $use = <USER>) {
my $sum = 1;
my $newuse = ($use + $sum);

close (USER);

open (USER, ">@args[0..$#args].txt");
my $usee = $use + 1;
print USER "$newuse\n";
close (USER);
print $sock "PRIVMSG $channel :You have given @args[0..$#args] a cookie! \n";
$varr = 0;
}
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T22:16:07.960

您正在尝试在第一个条件中使用字符串插值`'@args[0..$#args].txt'`。perl 仅在双引号中或使用`qw//`. 这意味着您正在检查是否存在名为`@args[0..$#args].txt`而不是 args 的值的文件。`@args[0..$#args]`是一个数组切片，当字符串内场时将用空格连接。这可能会导致某些文件系统出现问题。

此外，使用 -e 而不是 -s 来检查文件是否存在可能会更好，因为在某些文件系统上可能有一个 0 长度的文件。$varr 变量是不必要的，因为您可以将代码从第二个条件移动到第一个而不改变函数。

# c# - 如何将同步上下文添加到异步测试方法

> ID：14087257
> 
> 赞同：5
> 
> 时间：2012-12-30T00:35:08.010
> 
> 标签：c#, mstest, async-await

我有 Visual Studio 2012 和需要同步上下文的异步测试。
但是 MSTest 的默认同步上下文为空。
我想测试在具有同步上下文的 WPF 或 WinForms-UI 线程上运行。
将 SynchronizationContext 添加到测试线程的最佳方法是什么？

```
 [TestMethod]
    public async Task MyTest()
    {
        Assert.IsNotNull( SynchronizationContext.Current );
        await MyTestAsync();
        DoSomethingOnTheSameThread();
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T16:04:48.903

`SynchronizationContext`您可以在我的[AsyncEx 库](http://nitoasyncex.codeplex.com/)中使用一个名为`AsyncContext`：

```
[TestMethod]
public void MyTest()
{
  AsyncContext.Run(async () =>
  {
    Assert.IsNotNull( SynchronizationContext.Current );
    await MyTestAsync();
    DoSomethingOnTheSameThread();
  });
} 
```

但是，这并不能完全伪造特定的 UI 环境，例如，`Dispatcher.CurrentDispatcher`仍将是`null`. 如果您需要这种级别的伪造，您应该使用`SynchronizationContext`原始 Async CTP 中的实现。它附带了三个`SynchronizationContext`可用于测试的实现：一个通用的（类似于 my `AsyncContext`），一个用于 WinForms，一个用于 WPF。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-04T15:44:36.090

使用 Panagiotis Kanavos 和 Stephen Cleary 提供的信息，我可以像这样编写我的测试方法：

```
 [TestMethod]
    public void MyTest()
    {
      Helper.RunInWpfSyncContext( async () =>
      {
        Assert.IsNotNull( SynchronizationContext.Current );
        await MyTestAsync();
        DoSomethingOnTheSameThread();
      });
    } 
```

内部代码现在在 WPF 同步上下文中运行并处理用于 MSTest 的所有异常。Helper 方法来自 Stephen Toub：

```
using System.Windows.Threading; // WPF Dispatcher from assembly 'WindowsBase'

public static void RunInWpfSyncContext( Func<Task> function )
{
  if (function == null) throw new ArgumentNullException("function");
  var prevCtx = SynchronizationContext.Current;
  try
  {
    var syncCtx = new DispatcherSynchronizationContext();
    SynchronizationContext.SetSynchronizationContext(syncCtx);

    var task = function();
    if (task == null) throw new InvalidOperationException();

    var frame = new DispatcherFrame();
    var t2 = task.ContinueWith(x=>{frame.Continue = false;}, TaskScheduler.Default);
    Dispatcher.PushFrame(frame);   // execute all tasks until frame.Continue == false

    task.GetAwaiter().GetResult(); // rethrow exception when task has failed 
  }
  finally
  { 
    SynchronizationContext.SetSynchronizationContext(prevCtx);
  }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-31T10:59:19.870

您可以创建自定义 SynchronizationContext 派生类并将其注册为当前上下文[SynchronizationContext.SetSynchronizationContext](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.setsynchronizationcontext.aspx)。阅读 Stephen Toub 关于“ [Await、SynchronizationContext 和控制台应用程序](http://blogs.msdn.com/b/pfxteam/archive/2012/01/20/10259049.aspx)”和“ [Await、SynchronizationContext 和控制台应用程序：第 2 部分](http://blogs.msdn.com/b/pfxteam/archive/2012/01/21/10259307.aspx)”的文章。

您的自定义 SynchronizationContext 只需覆盖接收异步执行回调的 Post 方法。如何执行它们取决于您。

第一篇文章提供了一个同步上下文，它将所有已发布的操作存储在一个队列中，并提供了一个阻塞循环，该循环从队列中获取操作并在单个线程中执行它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-07-10T12:25:28.620

可以声明自己的测试方法属性，您可以在测试运行中注入自定义代码。使用它，您可以用您自己的 [SynchronizationContextTestMethod] 替换 [TestMethod] 属性，它会自动使用上下文集运行测试（仅在 VS2019 中测试）：

```
public class SynchronizationContextTestMethodAttribute : TestMethodAttribute
{
    public override TestResult[] Execute(ITestMethod testMethod)
    {
        Func<Task> function = async () =>
        {
            var declaringType = testMethod.MethodInfo.DeclaringType;
            var instance = Activator.CreateInstance(declaringType);
            await InvokeMethodsWithAttribute<TestInitializeAttribute>(instance, declaringType);
            await (Task)testMethod.MethodInfo.Invoke(instance, null);
            await InvokeMethodsWithAttribute<TestCleanupAttribute>(instance, declaringType);
        };
        var result = new TestResult();
        result.Outcome = UnitTestOutcome.Passed;
        var stopwatch = Stopwatch.StartNew();
        try
        {
            RunInSyncContext(function);
        }
        catch (Exception ex)
        {
            result.Outcome = UnitTestOutcome.Failed;
            result.TestFailureException = ex;
        }
        result.Duration = stopwatch.Elapsed;
        return new[] { result };
    }

    private static async Task InvokeMethodsWithAttribute<A>(object instance, Type declaringType) where A : Attribute
    {
        if (declaringType.BaseType != typeof(object))
            await InvokeMethodsWithAttribute<A>(instance, declaringType.BaseType);

        var methods = declaringType.GetMethods(BindingFlags.Instance | BindingFlags.Public);
        foreach (var methodInfo in methods)
            if (methodInfo.DeclaringType == declaringType && methodInfo.GetCustomAttribute<A>() != null)
            {
                if (methodInfo.ReturnType == typeof(Task))
                {
                    var task = (Task)methodInfo.Invoke(instance, null);
                    if (task != null)
                        await task;
                }
                else
                    methodInfo.Invoke(instance, null);
            }
    }

    public static void RunInSyncContext(Func<Task> function)
    {
        if (function == null)
            throw new ArgumentNullException(nameof(function));
        var prevContext = SynchronizationContext.Current;
        try
        {
            var syncContext = new DispatcherSynchronizationContext();
            SynchronizationContext.SetSynchronizationContext(syncContext);
            var task = function();
            if (task == null)
                throw new InvalidOperationException();

            var frame = new DispatcherFrame();
            var t2 = task.ContinueWith(x => { frame.Continue = false; }, TaskScheduler.Default);
            Dispatcher.PushFrame(frame);   // execute all tasks until frame.Continue == false

            task.GetAwaiter().GetResult(); // rethrow exception when task has failed
        }
        finally
        {
            SynchronizationContext.SetSynchronizationContext(prevContext);
        }
    }
} 
```

# c - Ruby 覆盖 Enumerable 方法

> ID：14087258
> 
> 赞同：3
> 
> 时间：2012-12-30T00:35:09.477
> 
> 标签：c, ruby, monkeypatching

我正在尝试覆盖 Enumerable 模块上的方法，如下所示：

```
module Enumerable
  def collect(&block)
    puts 'collect'
    super
  end
end 
```

（注意这是一个简单的例子）。

理论上，当我调用`collect`or时`map`，Ruby 应该使用我覆盖的版本，对吗？但事实并非如此。它总是使用内置的 Enumerable 方法。是不是因为`collect`实际上是`enum_collect`遵从源头的？

```
[1,2,3].map(&:to_s) # never prints anything 
```

是的，我知道 Monkey-Patching 很糟糕，等等等等，我知道还有其他选择，包括子类化等，但我想知道是否可以用 Ruby 覆盖内置的 C 函数。

```
Enumerable.class_eval do
  def collect(&block)
    puts 'collect was class_eval'
    super
  end
end 
```

```
eigen = class << Enumerable; self; end
eigen.class_eval do
  def collect(&block)
    puts 'collect was eigen'
    super
  end
end 
```

```
module Enumerable
  def collect(&block)
    puts 'collect was opened up'
    super
  end
end 
```

```
Array.send(:include, Enumerable) 
```

以及几乎所有的组合。

PS。这是 Ruby 1.9.3，但理想情况下，我正在寻找一种适用于所有版本的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T01:19:58.870

我认为您的问题是 Array 定义了自己的[`collect`方法](https://ruby-doc.org/core/Array.html#method-i-collect)，而不是使用 Enumerable 的：

> **收集{|物品| 方块 } → new_ary**
> **地图 {|item| 块 } → new_ary**
> **收集 → an_enumerator**
> **映射 → an_enumerator**
> 
> 为 的每个元素调用一次*块*`self`。创建一个包含块返回值的新数组。另请参阅`Enumerable#collect`。

因此，您可以随心所欲地修补`Enumerable#collect`所有内容，但`Array`不在乎，因为它不使用`Enumerable#collect`. 如果您使用猴子补丁，您将会有更好的运气`Array#collect`：

```
class Array
  def collect
    #...
  end
end 
```

您也需要打补丁`Array#map`或只是打补丁`map`并让别名处理`collect`.

请注意，这`Array#map`是在 C 中实现的，因此 C 部分与您的问题无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-31T17:14:03.147

您可以使用同一组方法在 Ruby 中迭代许多不同类型的对象。例如，您可以使用包含？方法来迭代数组和哈希以查看它们是否包含特定对象，并且类似地使用 map 方法来转换它们。你可能认为每个方法都自己实现了这些方法，但你错了。

在 Ruby 中，这些类型的方法在 Enumerable 模块中实现。如果你的类实现了 each 方法并包含 Enumerable 模块，那么你的类将响应大量涉及集合的消息，包括迭代、映射、搜索等。

# macos - 在终端中看不到“Escape”颜色

> ID：14087267
> 
> 赞同：1
> 
> 时间：2012-12-30T00:36:30.427
> 
> 标签：macos, shell, colors, terminal, iterm

有人可以帮助我吗？我不知道如何让这个工作。我看不到“转义”颜色，或者我不知道它们在我的终端中是如何被调用的：

[http://cl.ly/image/0U3N0Z2M2q2m](http://cl.ly/image/0U3N0Z2M2q2m)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:48:18.717

假设`tpb.sh`只打印输出到终端的内容，最简单的方法可能是：

```
echo -e "$(./tpb.sh)" 
```

该`-e`选项启用了反斜杠转义的解释`echo`。

# hash - 哈希函数和组合多个键

> ID：14087272
> 
> 赞同：2
> 
> 时间：2012-12-30T00:37:28.893
> 
> 标签：hash

我在每个元素中有三个键（两个字符串和一个整数），我想设计一个哈希函数。为了使哈希表统一，我想使用所有三个键。我应该走什么路？

```
private:
    string name; 
    int age;        
    string homeTown; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:56:56.840

最简单的实现会使用每个字段的键总和，如下所示：

```
return fieldA.getHashCode() + fieldB.getHashCode() + fieldC.getHashCode(); 
```

我大部分时间都使用这种方法。然而，这不是最优化的设计，因为关键基数确实对“最独特”的行为有影响。哈希键的设计目标很简单——用几个字节获得对象数据的最独特表示，所以如果“fieldA”具有更多的逻辑权重，那么你最好使用某种多项式公式，例如：

```
 a^2 + b*2 + c //where a,b,c are hashes of fields 
```

或者

```
 a^3 + b^2 + c ^1 
```

指数部分比线性求和产生更好的结果，因为它为位置分配不同的权重，所以如果第二个和第三个字段产生相同的哈希，结果仍然会不同。

```
10 + 2 + 18 = 18 + 10 + 2 
```

但

```
10^3 + 2^2 + 18 != 18^3 + 10^2 + 2 
```

哈希函数的正确设计确实不是一个简单的话题，它涉及概率论。

# c - “->”和“.”的区别 在 C 中

> ID：14087274
> 
> 赞同：8
> 
> 时间：2012-12-30T00:37:47.843
> 
> 标签：c

> **可能重复：**
> [C 中的箭头运算符 (->) 用法](https://stackoverflow.com/questions/2575048/arrow-operator-usage-in-c)

我试图找出“。”之间的区别。和“->”C 语言中的数据访问样式。例如。

```
struct div{
    int quo;
    int rem;
}; 
```

1）使用“->”

```
struct div *d = malloc(sizeof(struct div));
d->quo = 8/3;
d->rem = 8%3;
printf("Answer:\n\t Quotient = %d\n\t Remainder = %d\n-----------\n",d->quo,d->rem); 
```

2）使用“。”

```
struct div d;
d.quo = 8/3;
d.rem = 8%3;
printf("Answer:\n\t Quotient = %d\n\t Remainder = %d\n-----------\n",d.quo,d.rem); 
```

对于这两种情况，我得到相同的输出。

> 答案：商 = 2 余数 = 2

这两种方法在内部如何运作？什么时候应该使用哪一个？我尝试在互联网上搜索它，但没有太大帮助。任何相关链接也表示赞赏。

它们在内存中的存储也有什么区别吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-30T00:40:08.947

基本区别是这样的：

```
. is the member of a structure
-> is the member of a POINTED TO structure 
```

因此，`.`当可以直接访问结构中的变量时使用。但是`->`当您通过指向该结构的指针访问该结构的变量时使用。

假设你有 struct `a`：

```
struct a{
    int b;
} 
```

但是 say`c`是一个指向`a`然后你知道的指针：`c = (*a)`. 因此，`->`它被用作特定情况的替代方案`.`。因此`(*a).b`，您可以做而不是做`c->b`，这是完全相同的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-30T00:40:54.947

`->`定义为`.`

也就是说，`a->b`等价于`(*a).b`，因此您显然会得到相同的结果。

`->`为方便而存在。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-30T00:40:23.697

当处理指向结构的指针时，使用`->`，当直接使用它们时，使用`.`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-30T00:41:38.207

当您需要手动管理已创建对象的生命周期时，请使用第一种方法。当创建的对象的生命周期仅限于创建它的范围或包含它的对象的范围时，请使用第二种方法。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-30T02:43:04.490

在 C 中，`->`与 非常相似`.`，但处理的是指针。在结构中，`.`用于直接引用结构内的成员，而`->`用于引用指向结构的成员。根据具体情况，使用或不使用指针，您会得到几乎相同的结果。

`a -> b`是相同的`(*a).b`

想想就好`a = a + 1`。为了简单和方便，`a++`用于完成相同的确切结果。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-30T00:50:23.083

简而言之，期望给出相同的结果，您所做的是更改内存分配以及如何访问结构中的数据。关于您想要了解的内容的一些很好的链接是[关于动态内存分配](https://users.cs.jmu.edu/bernstdh/web/common/lectures/slides_cpp_dynamic-memory.php)和[使用 C++ 中的动态内存](http://www.informit.com/articles/article.aspx?p=1944072)的教程。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-12-30T03:10:02.250

当**.** 被使用，它被称为结构到成员..

当使用**->**时，它被称为指向成员的指针。

但是，如果使用指向成员的指针，它可以像这样解决..

x -> y 和 (*x).y 都是一样的..

# php - Rijndael-256 加密 - 解密字符串末尾的填充

> ID：14087276
> 
> 赞同：1
> 
> 时间：2012-12-30T00:37:57.653
> 
> 标签：php, mcrypt

所以，我正在尝试使用 mcrypt 解密 Rijndael-256，这一切都很好。但是，在字符串的最后有填充以使其正好为 32 字节长。知道为什么吗？这是它的输出。

```
array (size=9)
  'cryptedText' => string 'O¿{žû¦ê§Þøµ; *¬rÄÅÏ§„•T' (length=32)
  'IV' => string 'ÄêKG£ED^°“F¨ŠêFx)\e_¶üŠèJÂ|' (length=32)
  'title' => string 'Untitled' (length=8)
  'deleteKey' => string 'ff349d33af4cff27143f66680586121e3c17d1f81aee42c7beb645684ca95558447f0eba757c7ecc785ea39633cfad5a6144fd5ea5028ca9c342e15291d7fd60' (length=128)
  'date' => string '1356827615' (length=10)
  'uid' => string '0' (length=1)
  'urlID' => string '2' (length=1)
  'id' => string '2' (length=1)
  'decryptedText' => string 'hello woaaaaaaaaarld������������' (length=32)
                                                 ^^^^^^^^^^^^ This 
```

如果我添加超过 32 个字符，它会填充到 64，等等......

这是我解密它的方式：

```
 $cipher = mcrypt_module_open(MCRYPT_RIJNDAEL_256, '', MCRYPT_MODE_CBC, '');

        if (mcrypt_generic_init($cipher, $key, $result_set['IV']) != -1) {
            $decrypted = mdecrypt_generic($cipher, $result_set['cryptedText']);
            mcrypt_generic_deinit($cipher);
            mcrypt_module_close($cipher);
            $result_set['decryptedText'] = $decrypted;
        } 
```

Rijndael-256 加密数据以 LONGBLOB（二进制）数据类型以及 IV 存储在我的数据库中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:49:22.867

[http://php.net/manual/en/function.mcrypt-encrypt.php](http://php.net/manual/en/function.mcrypt-encrypt.php)

> **数据**
> 
> 将使用给定密码和模式加密的数据。 **如果数据的大小不是 n * blocksize，数据将用 '\0' 填充**。
> 
> 返回的密文可以大于 data 给出的数据的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:49:56.313

base64_encoding 我的数据在加密之前解决了这个问题。耶！

# php - php mysql 注册表邀请码

> ID：14087281
> 
> 赞同：0
> 
> 时间：2012-12-30T00:39:34.890
> 
> 标签：php, mysql, registration, invite

如果有人可以帮助我，我将再次感激不尽！我正在制作一个可以正常工作的注册表单，但我也想在那里实现邀请码检查。

我以前从来没有这样做过，因为我是新手，我只是在寻找解决方案，试图理解并采用......所以请不要评判我：）我只是在努力学习每一步！

这么快我想做的事->

1.  用户输入邀请码 2.如果不正确（然后在数据库中检查 -> 错误消息）
2.  如果正确（在数据库中检查 -> 然后被使用）
3.  代码数据库得到更新，代码不再可用

这是我的代码：

```
$invite_code = ($_POST['invite_code']);
// Validate invite code
if (empty($_POST['invite_code'])) {
$err7 = "Wrong invitation code";
}  
//check if invitation code is valid in the database and not already taken
$rs_check = mysql_query("SELECT `code` from tableinvitecodes WHERE '$invite_code' 
AND `taken` = '0'") or die (mysql_error()); 
$num = mysql_num_rows($rs_check);
// Match row found with more than 0 results  - the code is invalid. 
if ( $num <= 0) { 
$err7 = "Invite code is invalid";
}
else {
$invite_code = $_POST['invite_code'];
} 
```

不工作的是检查“正在使用”，它会在数据库中更新......这很好。错误一定是检查，但我不知道如何将它与“if (empty($_POST['invite_code']))...”连接起来：-/

在此先感谢您的帮助！

那部分有效！->

```
//set approved code to 1 to block that code
if(empty($err7)) {
$rs_invite_code = mysql_query("update tableinvitecodes set `taken` = '1' WHERE 
code='$invite_code' ") or die(mysql_error());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:45:36.950

看起来您的查询格式错误。你有：

```
SELECT `code` from tableinvitecodes WHERE '$invite_code' AND `taken` = '0' 
```

我认为你应该有类似的东西：

```
SELECT `code` from tableinvitecodes WHERE <<SOMETHING HERE>> = '$invite_code' AND `taken` = '0' 
```

# c# - 我为 WP7 编码的 C# 应用程序无法在部署的 WP8 手机上正确启动

> ID：14087286
> 
> 赞同：0
> 
> 时间：2012-12-30T00:40:37.333
> 
> 标签：c#, windows-phone-7, compatibility, windows-phone-8

因此，我创建了一个 (C#) WP7 应用程序，其中没有太多复杂的东西。一个网络浏览器控件、IsolatedStorageSettings 和其他一些基本的东西。当我在我的一台 WP7 设备上测试这个应用程序时，它运行良好。调试工作正常。部署也可以正常工作。该应用程序的行为完全正常。

当我拿到诺基亚 Lumia 822 时，我开发人员解锁了该设备。我部署了WP7版本的XAP文件，然后试了一下。第一次启动，完美运行！然后，我使用后退按钮完全退出应用程序。我尝试再次打开它，发生了什么？它甚至不显示启动画面。我尝试多启动几次，还是不行。

我重新启动了我的 WP8 设备。然后我再次启动我的应用程序，它工作。我做了我上次做的事情，退出应用程序然后重新启动它。问题又来了，没有闪屏。

在我受够了挫折之后，我启动了 Visual Studio 2012。我连接了我的 WP8，然后对其进行了调试。工作正常！我使用后退按钮退出设备上的应用程序，Visual Studio 仍然认为应用程序正在运行。然后我从设备重新启动应用程序，它再次工作！我又试了一次，它仍然有效。每当应用程序不处于调试模式时，它就会崩溃。只要应用程序处于调试模式，它就可以工作。

这是正在发生的事情的视频：http: [//youtu.be/3zKFxj98liY](http://youtu.be/3zKFxj98liY)

有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T00:25:15.223

哈哈，我才发现原因！WP8 不再支持 Clipboard.SetText，它会使应用程序崩溃。

# postgresql - 在 Django 中设置测试数据库

> ID：14087290
> 
> 赞同：3
> 
> 时间：2012-12-30T00:41:16.850
> 
> 标签：postgresql, session, django-testing

我想创建集成测试，以便可以在我的数据库中创建单个模型的 1000 条记录。

对于我的 settings.py 文件，我指定`default`在运行测试时使用相同的数据库。

```
if 'test' in sys.argv or 'test_coverage' in sys.argv:
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.postgresql_psycopg2', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
            'NAME': 'TableName',                      # Or path to database file if using sqlite3.
            'USER': 'postgres',                      # Not used with sqlite3.
            'PASSWORD': 'password',                  # Not used with sqlite3.
            'HOST': 'localhost',                      # Set to empty string for localhost. Not used with sqlite3.
            'PORT': '5432',                      # Set to empty string for default. Not used with sqlite3.
        }
    } 
```

当我运行该命令时，`python manage.py test <app>`我收到一条错误消息，指出我有两个会话正在运行。

```
 Got an error creating the test database: source database "template1" is being accessed by other users
DETAIL:  There are 1 other session(s) using the database. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T00:48:35.223

确保`python manage.py runserver`在运行测试之前禁用该或任何其他访问您的 postgresql 的进程（例如 pgadmin3 或 phppgadmin）。

换句话说，请确保您已经**为您的应用程序终止了正在运行的 postgresql 连接**。

您还可以通过以下方式确定应用程序正在与您的 postgresql 数据库建立哪些打开的连接

```
psql -U postgres

postgres=# SELECT * FROM pg_stat_activity; 
```

如果你想具体一点，你可以这样做： -

```
postgres=# SELECT * FROM pg_stat_activity where datname = 'TaleeboBixin'; 
```

# iphone - 如何在iphone5手机缝隙上打开苹果地图

> ID：14087291
> 
> 赞同：0
> 
> 时间：2012-12-30T00:41:34.697
> 
> 标签：iphone, ios, google-maps, cordova

我已经在手机间隙开发了一个移动应用程序，它在 android 和 Iphone 4 中运行良好，因为我使用谷歌地图来加载商店的信息。但是在 Iphone5 中，我无法打开谷歌地图，而且我不知道如何打开苹果地图。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-09T10:17:52.633

要打开 Apple 地图，最简单的方法是使用 HTML 样式的链接：

**打开地图：**

```
<a href="http://maps.apple.com/">Open Apple Maps</a> 
```

**打开带有路线的地图：**

```
<a href="http://maps.apple.com/?saddr=&daddr=">Open Route in Apple Maps</a> 
```

其中saddr 是起始地址，daddr 是目标地址。您可以通过“Current%20Location”来使用他们的当前位置

# ruby - 我应该在 Ruby 中验证方法参数吗？

> ID：14087294
> 
> 赞同：3
> 
> 时间：2012-12-30T00:42:28.647
> 
> 标签：ruby, arguments, type-safety, method-parameters

我有 Java 背景，在 Java 中，当程序员使用错误的参数调用方法时，会抛出异常。Ruby 程序员如何处理错误的方法参数？

核心类的两个相反的例子：

```
irb(main):009:0> "" * (-2)
ArgumentError: negative argument
        from (irb):9:in `*'
        from (irb):9
        from C:/Ruby/Ruby193/bin/irb:12:in `<main>'

irb(main):013:0> (-2).times { puts 'hello' }
=> -2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T01:16:06.293

我通常倾向于避免在 Ruby 中进行参数验证。

但是，这实际上取决于您的主要目的是什么。如果您担心可靠性，那么只要参数将导致不可恢复的错误，请采取防御措施并引发异常。

这也取决于您的用例：

*   它们是公共 API 吗？您可能会强烈考虑验证。
*   它们是私有 API/方法吗？好吧，我通常会信任程序员。

一种有效的方法可能是在调试阶段使用参数检查，这有助于检测 API 的错误和滥用，然后 - 一旦测试 - 删除检查。

归根结底，这个棘手的问题没有完美的答案。它非常依赖于上下文和开发人员的个人判断。

# json - JSON解析总是导致第一个值的NaN

> ID：14087295
> 
> 赞同：1
> 
> 时间：2012-12-30T00:42:37.387
> 
> 标签：json

[在这里摆弄](http://jsfiddle.net/2DTX8/3/)

我有我的 JSON 代码，当我尝试解析它时，第一个 ID 始终为 0，我不知道为什么。

迭代：

```
for (var i = 0; i < myFirstJSON.length; i++) {
    var dayEvent = dayEvent + myFirstJSON[i].ID + '   ';
} 
```

结果：

南 491 489 482

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:46:15.480

NaN 来自`var dayEvent = dayEvent + myFirstJSON[i].ID + ' ';`您`dayEvent`在初始化它之前使用的位置（未定义 + 一个数字为您提供 NAN）。如果你初始化它，NaN 就会消失

```
var dayEvent = '';
for (var i = 0; i < myFirstJSON.length; i++) {
    dayEvent = dayEvent + myFirstJSON[i].ID + '   ';
} 
```

[http://jsfiddle.net/2DTX8/4/](http://jsfiddle.net/2DTX8/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:46:34.590

您需要`dayEvent`在开始使用它之前定义初始值：

```
var dayEvent = "";
for (var i = 0; i < myFirstJSON.length; i++) {
    dayEvent = dayEvent + myFirstJSON[i].ID + '   ';
}

document.writeln(dayEvent); 
```

# java - 使用 Spring MVC 控制器处理和验证 HTML 复选框

> ID：14087296
> 
> 赞同：2
> 
> 时间：2012-12-30T00:43:20.330
> 
> 标签：java, html, spring-mvc, thymeleaf

我正在使用 Spring MVC，我想要一个页面来注册我的用户。我想给他们接收电子邮件通知的选项，我有一些他们必须接受的服务条款，所以有两个复选框。我受到 HTML 复选框的限制，因为我还使用 thymeleaf 作为我的模板引擎。我想知道您将如何处理和验证复选框的值，无论它们是否被选中。当您使用复选框进行表单提交时，如果选中它们，则将值作为复选框的名称-值对传递给服务器，否则不传递任何内容。您是否有不同的处理程序方法，如下所示：

```
@RequestMapping(value = "/register, 
method = RequestMethod.POST, 
params = {"notify", "agreed_tos"})
public String register(/* other params like username/email */) {
    //register user
}

@RequestMapping(value = "/register, 
method = RequestMethod.POST)
public String registerMissingToS(/* other params like username/email */) {
    // return that agreed_tos checkbox wasn't checked
} 
```

这样，如果复选框被选中，将调用第一个方法，如果没有选中，则调用第二个方法。有没有办法检查是否选中了复选框，以便我可以在单个控制器方法中完成所有这些操作？你会怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T02:33:18.707

解决方案 A：有点难看，但最快：从 RequestMapping 中删除参数，然后使用 request.getParameter("agreed_tos") 来检查这个参数。

解决方案 B：在表单中使用命令对象，因此如果用户将复选框留空并且 SpringMVC 将此输入绑定到命令对象字段，则 thymeleaf 或 spring 标签可以自动添加发送的隐藏输入

解决方案 C：可能 @RequestParam 与 defaultValue 和 required=false 允许在一种方法中完成这两种情况

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T16:20:57.883

您不必担心禁用时不会通过复选框。Spring MVC 为您完成了这项工作，Thymeleaf 为其提供了足够的基础设施。如果你的表单支持 bean（在 Spring MVC 术语中也称为*命令*）有一个布尔字段，你可以将它映射到一个复选框，不用担心。

每当`input type="checkbox"`在 Spring MVC 应用程序（无论是 JSP 还是 thymeleaf）中使用 an 时，`input type="hidden"`都会在其后面添加 an，以便控制器层能够完美地区分禁用或未选中的字段。

免责声明，根据 StackOverflow 规则：我是 thymeleaf 的作者。

# php - 动态代码风格而不是硬编码

> ID：14087298
> 
> 赞同：-4
> 
> 时间：2012-12-30T00:43:32.577
> 
> 标签：php, mysql, webserver

插入更新时我习惯

```
 $sql = sprintf("INSERT INTO emp_detail  VALUES ('%s')", implode ("', '",$formData));
    if (!mysql_query($sql,$con)){die('Error: ' . mysql_error()); 
```

是上面的编码风格导致服务器机器变慢。而不是像下面这样的编码。

```
$sql ="INSERT INTO emp_detail  VALUES ('aa','bbb','ccc');
 if (!mysql_query($sql,$con)){die('Error: ' . mysql_error()); 
```

我的意思是执行时间，性能等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T00:52:12.690

执行时间的差异很难衡量，因为字符串插值和`implode`调用将比到数据库服务器的往返时间快几个数量级。我们说的是纳秒与毫秒。

不过，你问错问题了。在应用程序中编写文字 SQL 语句是一种非常糟糕的做法，它的级别太低，无法在任何非平凡的应用程序中持续存在。

你应该使用像[Doctrine](http://www.doctrine-project.org/)这样的东西来管理你的数据库内容。像[Yii](http://www.yiiframework.com/)或[CakePHP](http://cakephp.org/)这样的框架也消除了很多这种超低级的实现。

请记住，当您使用 时`mysql_query`，您直接与 MySQL C 驱动程序交互。这是一个非常糟糕的主意，实际上在 PHP 5.5.0 中已被弃用，会产生警告。您不应该在新应用程序中使用它。至少使用[PDO](http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/)来为 MySQL 提供更好的包装器。

# c - C：字符串文字到 int 数组

> ID：14087304
> 
> 赞同：1
> 
> 时间：2012-12-30T00:44:54.667
> 
> 标签：c, arrays, string, string-literals

我有一个函数，将`int`数组作为参数。该`int`数组表示一个字符串，但必须能够包含`EOF`，因此不能是 type `char[]`。我的函数看起来像这样：

```
_Bool fun(int str[]) {
  // does something involving checking elements for EOF, e.g.:
  return (str[0]==EOF);
} 
```

出于测试目的，我想`fun`使用字符串文字进行调用（尽管字符串文字自然是类型`char[]`并且不能包含`EOF`），实际上：

```
fun("test"); 
```

它将编译但带有关于错误参数类型的警告。这是意料之中的，因为字符串文字是`char[]`并且参数是`int[]`。

我可以这样做：

```
fun( (int*) "test"); 
```

这可能是等价的，只是我正在明确地进行强制转换，同样的编译警告。

我正在阅读不能保证转换为的内容（`char*`链接[）](https://stackoverflow.com/questions/4291048/casting-an-int-pointer-to-a-char-ptr-and-vice-versa)。在一般情况下这是很自然的，因为如果我现在尝试写一个大的 to ，它可能不适合 -只为 a 分配了内存（告诉我我是否错了）。`int*``int``str[some_index]``str[some_index]``char`

但是因为我不会做任何这样的写，而只是比较（并且比较 char 和 int 应该没问题） - 我可以接受上述任何一个吗？在这种情况下如何摆脱编译警告？或者解决这个问题的最佳方法是什么？

我当然可以编写一个简单的函数来将`char`字符串文字给出的数组复制到一个`int`数组中，值对值，但必须有更好的方法。这样的解决方案也会浪费内存。

（顺便说一句 - 当使用 进行测试时`EOF`，我会做这样的事情：

```
int str[] = {'t', 'e', 's', 't', EOF};
fun(str); 
```

应该可以正常工作。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T00:54:25.200

您提出的演员阵容是一场灾难，除了编译器（有理由）抱怨它之外。

假设您使用的是 little-endian (Intel) 机器，该函数需要这样的内存布局（其中空白方块包含所有位为零）：

```
+---+---+---+---+
| t |   |   |   |
+---+---+---+---+
| e |   |   |   |
+---+---+---+---+
| s |   |   |   |
+---+---+---+---+
| t |   |   |   |
+---+---+---+---+
|EOF|EOF|EOF|EOF|
+---+---+---+---+ 
```

您传递的是这样的内存布局：

```
+---+---+---+---+
| t | e | s | t |
+---+---+---+---+
| \0| 
+---+ 
```

这根本不是一回事。这完全忽略了可能的对齐问题；您正在传递 5 个字节的数据，没有 EOF 标记来标记字符串的结尾。

简而言之，*不要这样做！*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T10:54:50.833

好的，总结一下：

隐含或显式强制转换（`fun("test")`以及`fun( (int*) "test")`相应地）*不会*做我想要的（有关详细信息，请参阅 Jonathan Lefflers 的回答）。

这里的方法可能是编写一些自定义函数，将字符串文字与一个`EOF`值结合起来，并将其全部作为`int[]`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-30T00:52:44.397

尝试与 0 进行比较，因为 EOF 是 0 的定义，而 char 等效项是 '\0'

# c++ - 使用 delete 关键字删除具有动态分配块的对象是否安全

> ID：14087305
> 
> 赞同：3
> 
> 时间：2012-12-30T00:45:07.243
> 
> 标签：c++, memory-management

这个问题对某些人来说可能听起来太简单了，但我试图了解如果我使用**delete 关键字删除具有动态分配块的对象会发生什么**

调用 delete 会做两件事，首先调用析构函数，然后释放内存。如果 delete 正在释放对象内存，那么它是否也会释放动态分配的内存，或者我是否必须在析构函数中编写一段代码才能真正安全地释放内存块。

此外，如果对象在堆中分配内存，那么除了成员变量之外的其他东西将占用分配给对象的内存。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T01:01:06.157

如果你有这样的事情：

```
class Foo
{
public:
   int* block;

   Foo()
   {
       block = new int[10];
   }

private:
   Foo(const Foo&);
   Foo& operator =(const Foo&);
}; 
```

随后执行此操作：

```
Foo* foo = new Foo;
delete foo; 
```

那么是的，你正在泄漏内存。Foo 对象中的动态块永远不会被释放。您可以使用释放它的析构函数来解决这个问题。（源代码，您还需要在类声明中声明析构函数）：

```
Foo::~Foo()
{
    delete [] block;
} 
```

我建议你做两件事

1.  计算删除的和新的。如果它们不一样，那通常是一个问题。
2.  阅读有关C++ 动态指针和内存使用的[信息性文档。](http://dl.dropbox.com/u/6101039/Modern%20C++.pdf)

在 #2 之后，顺便说一句，可能会给您一个类似于此的对象：

```
class Foo
{
public:
   std::array<int,10> block;

   Foo() // note: default-construction of `block`
   {
   }

   // note: default *destructor* will clean up member variables
   //  by firing their destructors for you. in this case the destructor
   //  for our 'block' member is a std::array that knows how to self-clean.

   // note: we no longer have to hide or implement copy construction and
   //  assignment operator functionality. The default implementation of 
   //  these properly member-copy and member-assign respectively.
}; 
```

和这样的用法（许多可能性之一）：

```
std::unique_ptr<Foo> foo(new Foo); 
```

请注意最后一个示例源代码中的注释。通过使用练习自我管理成员的类，你的内存管理肩上的重担*会减轻很多*。在提升这个重量的过程中，引入与之相关的错误的可能性也会增加，比如内存泄漏、浅拷贝风险等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T00:52:21.660

调用时释放的内存`delete`只是对象本身占用的内存。该对象占用多个连续字节，这些字节在`delete`. `sizeof(MyType)`会告诉你有多少字节。并且*没有*其他任何东西被释放`delete`。其他一切都由析构函数（或单个成员对象的析构函数）释放

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T01:02:40.530

使用动态分配的块，您需要调用 delete[]。

例如：

```
class C
{
    //some members
public:
    C() {...}
    ~C() {...} 
    // some methods
};

int main()
{
C * arr = new C[10]; // Dynamically allocated memory

// some code using arr . . .

delete[] arr; // Calling ~C() for each C element in arr and then releasing the dynamically alloacted memory on the heap pointed by arr.
} 
```

但是，如果另外你有一个动态分配的成员指针，你需要在对象的析构函数中删除它：

```
C::C()
: memberArray(new int[10]) {  }

C::~C()
{
   delete[] memberArray;
   memberArray = NULL;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T00:52:15.497

析构函数的一个用途是调用`delete`它包含的每个指针属性的语句。例如，如果我有一个类“car”，它有一个属性“tire”，它是一个指针，你需要在汽车的析构函数中删除这个属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T00:53:18.023

不，分配的内存不会被释放。

当一个分配了动态内存并分配给指针的对象被删除时，只会释放指针，不会释放它指向的数据。当一个对象分配内存时，您**必须**在其析构函数中手动调用该数据的删除，或者确保它被其他获得该数据指针的对象删除。

自动删除它是不可能的，因为该对象可能已经将分配的数据传递给另一个在分配对象被删除后仍然需要它的对象。

# php - 文件成功上传后，成功消息更改为取消消息

> ID：14087309
> 
> 赞同：2
> 
> 时间：2012-12-30T00:45:56.900
> 
> 标签：php, jquery, html

成功上传文件后，我无法显示正确的消息。

发生的情况是，当文件成功上传时，它会在一瞬间显示成功消息，然后突然变为取消消息。我的问题是，如果文件成功上传，我希望显示成功消息，显然我不希望它更改为取消消息。

下面是一个包含文件输入以及上传和取消按钮的表单；

```
<form action='imageupload.php' method='post' enctype='multipart/form-data' target='upload_target_image' onsubmit='return imageClickHandler(this);' class='imageuploadform' > 
 Image File: <input name='fileImage' type='file' class='fileImage' /></label><br/><br/><label class='imagelbl'>
 <input type='submit' name='submitImageBtn' class='sbtnimage' value='Upload' /></label>
 <input type='reset' name='imageCancel' class='imageCancel' value='Cancel' /></label>
 <iframe class='upload_target_image' name='upload_target_image' src='#' style='width:0px;height:0px;border:0px;solid;#fff;'></iframe></form> 
```

下面是开始文件上传的函数：

```
function startImageUpload(imageuploadform){

  $(imageuploadform).find('.imagef1_cancel').css('visibility','visible');
  sourceImageForm = imageuploadform;

        $(imageuploadform).find(".imageCancel").on("click", function(event) {
    $('.upload_target_image').get(0).contentwindow
    $("iframe[name='upload_target_image']").attr("src", "javascript:'<html></html>'");
     $request = $.ajax("cancelimage.php").done(function(data) {

        return stopImageUpload(2);

    });  

}); 

      return true;
} 
```

以下是停止文件上传的功能：

```
var imagecounter = 0;

function stopImageUpload(success, imagefilename){

      var result = '';
      imagecounter++;

      if (success == 1){
         result = '<span class="imagemsg'+imagecounter+'">The file was uploaded successfully</span>';      
      }
      else if (success == 2){
          result = '<span class="imagemsg'+imagecounter+'"> The file upload was cancelled</span>';
      }
      else {
         result = '<span class="imagemsg'+imagecounter+'">There was an error during file upload</span>';
      }

      $(sourceImageForm).find('.imagef1_cancel').css('visibility','hidden');
      $(sourceImageForm).find('.imagemsg').html(result);
      $(sourceImageForm).find(".fileImage").replaceWith("<input type='file' class='fileImage' name='fileImage' />");

      return true;   
} 
```

下面是 clickHandler 函数：

```
 function imageClickHandler(imageuploadform){ 
          if(imageValidation(imageuploadform)){ 
              window.lastUploadImageIndex = $('.imageuploadform').index(imageuploadform); 
              return startImageUpload(imageuploadform); 
              $request.abort()
          } 
          return false;
      } 
```

下面是上传文件的 imageupload.php 页面：

```
<?php

ini_set('display_errors', 1);
error_reporting(E_ALL);

session_start();

if ($_FILES['fileImage']['error'] === UPLOAD_ERR_OK) {
    $result = 0;

    if (getimagesize($_FILES['fileImage']['tmp_name'])) {
        if ((($_FILES["fileImage"]["type"] == "image/gif") || ($_FILES["fileImage"]["type"] == "image/jpeg") || ($_FILES["fileImage"]["type"] == "image/pjpeg") || ($_FILES["fileImage"]["type"] == "image/jpg")) && ($_FILES['fileImage']['size'] > 0)) {
            if (is_file("ImageFiles/" . $_FILES['fileImage']['name'])) {
                $parts = explode(".", $_FILES['fileImage']['name']);
                $ext   = array_pop($parts);
                $base  = implode(".", $parts);
                $n     = 2;

                while (is_file("ImageFiles/" . $base . "_" . $n . "." . $ext))
                    $n++;
                $_FILES['fileImage']['name'] = $base . "_" . $n . "." . $ext;

                move_uploaded_file($_FILES["fileImage"]["tmp_name"], "ImageFiles/" . $_FILES["fileImage"]["name"]);
                $result = 1;

            }

            else {
                move_uploaded_file($_FILES["fileImage"]["tmp_name"], "ImageFiles/" . $_FILES["fileImage"]["name"]);
                $result = 1;
            }

        }

    }
} else {
    echo "Upload was not successful";
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:20:48.277

您的代码调用：

```
stopImageUpload(2); 
```

ajax调用完成后。通过`2`会导致您的代码显示上传已取消。所以，现在代码正在做你要求它做的事情（也就是说，上传被取消了）。

您需要区分成功和 ajax 函数可能完成的其他方式，以便在完成时显示正确的状态。

# eclipse - 与 Eclipse 中的剪贴板比较

> ID：14087313
> 
> 赞同：5
> 
> 时间：2012-12-30T00:46:25.507
> 
> 标签：eclipse, eclipse-plugin, intellij-idea

我被迫在一个新项目中使用 Eclipse，但我的心仍然渴望 IntelliJ，我在 Eclipse 诞生之前就一直在使用它。

我已经习惯了，但我真正怀念的一个功能是“与剪贴板比较”。

例如，如果您在一个类中看到两个相似的方法，您可以将一个复制到剪贴板，然后与另一个进行比较，这样可以很容易地重构。

是否有“与剪贴板比较”的 Eclipse 插件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T01:07:59.883

标准 Eclipse 没有`Compare to Clipboard`选项，但有一个 Eclipse 插件可以让您这样做：[AnyEdit 工具](http://andrei.gmxhome.de/anyedit/)。

我刚刚尝试过，它似乎是您正在寻找的：它将选项添加`Compare to Clipboard`到编辑器的弹出菜单和文件资源管理器视图中。对选定文本或整个文件进行比较。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-02T15:48:24.917

可能不是您希望通过*比较剪贴板*命令实现的目标（我不知道如何使用 IntelliJ），但您也可以通过大纲视图将两种方法一起比较：

*   打开包含您的方法的 Java 类
*   选择两种方法
*   右键单击然后使用*比较 > 其他元素...*

这将打开一个比较对话框，显示两种方法之间的差异。此对话框不允许内联编辑，但它是发现两种相似方法之间差异的好方法。

请注意，您可以通过包资源管理器执行相同操作，从而允许在不同 java 文件的方法（或内部类）之间进行比较。为此，您需要确保 Package Explorer 不会过滤*Java 成员*。由于我真的不知道除了图像之外如何解释这一点，请使用*过滤器*视图菜单（通过包资源管理器视图右上角的向下箭头）：![包资源管理器菜单](../Images/87e916b566eed22869101198f796ea02.png)

并在打开的对话框中，确保未勾选*Java Member*。然后您可以简单地扩展一个 java 类以在包资源管理器中查看它的成员，并将它们一起比较：![在此处输入图像描述](../Images/eaab5d589c6000d186a9ff24e4a058e1.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-09T20:33:04.883

另一种方法，虽然笨重，是使用你的版本控制系统的差异工具来做这个比较。只需将一组文本替换为另一组文本，保存文件，然后使用 VCS 的更改工具查看文件的更改情况。如果您使用 Eclipse 的 Git 插件，最简单的方法是打开 Git Staging 视图，在列表中找到您的文件，然后双击它。

# java - Netbeans GUI 和 SQL 问题

> ID：14087314
> 
> 赞同：0
> 
> 时间：2012-12-30T00:46:25.057
> 
> 标签：java, sql, user-interface, netbeans, project

//我在使用 Netbeans 时遇到问题。当我单击注册时，我试图让我在注册表单中输入的值进入 sql 表，但没有任何反应。任何人都可以帮忙吗？

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package networking;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.Statement;

/**
 *
 * @author user
 */
public class Registration extends javax.swing.JFrame {

    /**
     * Creates new form Registration
     */
    public Registration() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        FullNameField = new javax.swing.JTextField();
        EmailField = new javax.swing.JTextField();
        Username = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        AdressField = new javax.swing.JTextArea();
        PasswordField = new javax.swing.JPasswordField();
        Registeration = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jLabel1.setText("Registration Form ");

        jLabel2.setText("Full Name");

        jLabel3.setText("Email");

        jLabel4.setText("Username");

        jLabel5.setText("Password");

        jLabel6.setText("Adresse");

        FullNameField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                FullNameFieldActionPerformed(evt);
            }
        });

        AdressField.setColumns(20);
        AdressField.setRows(5);
        jScrollPane1.setViewportView(AdressField);

        Registeration.setText("Register");
        Registeration.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                RegisterationActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(105, 105, 105)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(Registeration)
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                        .addComponent(jLabel3, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(jLabel4, javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(jLabel5, javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(jLabel6, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                                .addGap(18, 18, 18)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(PasswordField)
                                    .addComponent(Username)
                                    .addComponent(EmailField)
                                    .addComponent(FullNameField)
                                    .addComponent(jScrollPane1)))))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(21, 21, 21)
                        .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(105, 282, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(26, 26, 26)
                .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(28, 28, 28)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(FullNameField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel3)
                    .addComponent(EmailField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel4)
                    .addComponent(Username, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5)
                    .addComponent(PasswordField, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(20, 20, 20)
                        .addComponent(jLabel6)))
                .addGap(18, 18, 18)
                .addComponent(Registeration)
                .addContainerGap(27, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>

    private void RegisterationActionPerformed(java.awt.event.ActionEvent evt) {
     try{
         Connection con = DriverManager.getConnection("jdbc:mysql://localhost/networks","root","mamaendbaba");
         Statement stat = (Statement) con.createStatement();
         String Name = FullNameField.getText();
         String UserName= Username.getText();
         String Adr = AdressField.getText();
         String Pass = PasswordField.getText();
         String Emai = EmailField.getText(); 
         String excmd = "INSERT INTO networks registerd(Name, UserName, Address, Password, Email)" +
    " VALUES (?, ?, ?, ?, ?)";
         @SuppressWarnings("UnusedAssignment")
PreparedStatement statement =con.prepareStatement(excmd);
statement = (PreparedStatement) con.createStatement();

// get field values ... 
statement.setString(1, Name);
statement.setString(2, UserName);
statement.setString(3, Adr);
statement.setString(4, Pass);
statement.setString(5, Emai);
statement.executeUpdate();
     }
     catch(Exception e)
     {
     }    

    }

    private void FullNameFieldActionPerformed(java.awt.event.ActionEvent evt) {
        // TODO add your handling code here:
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(Registration.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(Registration.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(Registration.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Registration.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Registration().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify
    private javax.swing.JTextArea AdressField;
    private javax.swing.JTextField EmailField;
    private javax.swing.JTextField FullNameField;
    private javax.swing.JPasswordField PasswordField;
    private javax.swing.JButton Registeration;
    private javax.swing.JTextField Username;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JScrollPane jScrollPane1;
    // End of variables declaration
} 
```

这是完整的代码，它不需要任何解释，它是一个用于注册的 jform 只是看看可以做什么，所以你可以看到我正在从表单中获取值并尝试将它们插入到表中，无论如何它不管用 ..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T00:50:51.220

您的 SQL 参数变量中缺少许多单引号：

```
String excmd = "INSERT INTO networks registerd VALUES ('" + Name + "','"+ UserName +"','"+ Adr +"','"+ Pass +"','"+ Emai +"')"; 
```

此外，您没有在异常块中显示任何使代码静默失败的内容。您可以添加：

```
e.printStackTrace(); 
```

最好在这里使用[PreparedStatement](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)，因为它不仅可以消除提供这些引号的需要，还可以防止[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)攻击。

* * *

另一个潜在的错误来源是列顺序可能不完全匹配，例如，可能有一个*自动递增*列，这意味着您必须在 SQL 中指定列名。您也可以省略数据库名称，例如：

```
String excmd =
    "INSERT INTO registerd(Name, UserName, Address, Password, Email)" +
    " VALUES (?, ?, ?, ?, ?)";
PreparedStatement statement = con.createPreparedStatement(excmd);
// get field values ... 
statement.setString(1, Name);
statement.setString(2, UserName);
statement.setString(3, Adr);
statement.setString(4, Pass);
statement.setString(5, Emai);
statement.executeUpdate(); 
```

# code-behind - Site.Master 和隐藏 MenuItem 问题

> ID：14087315
> 
> 赞同：0
> 
> 时间：2012-12-30T00:46:27.977
> 
> 标签：code-behind, menuitem, master-pages

我想要的是根据用户角色从 Site.Master 页面显示不同的 MenuItems。由于我没有找到如何做，我创建了两个站点母版页 - Site.Master 和 Acct_Site.Master。在 Site.Master 我有 CodeBehind="Site.master.cs" 和在 Acct_Site.Master 我有 CodeBehind="Acct_Site.master.cs"。我在 Site.Master.cs 和 Acct_Site.master.cs 中的 Page_Load 方法的第一条语句上设置了一个断点。

在第一个屏幕上，我编程在 Site.Master.cs 中的中断处停止，但接下来它在 Site.Master.cs 中的中断处停止，但显示 Acct_Site.Master。所以看起来Site.Master.cs被执行了，甚至显示Acct_Site.Master。任何想法为什么？

谢谢，

扎莱克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T02:52:02.003

我的错误 - 我发现名称 Acct_Site.Master 是一个无效名称 - 看起来我们无法在名称中添加下划线。我将 Acct_Site.Master 重命名为 AcctSite.Master 并且我的程序正常工作。

扎莱克

# java - Java多态错误？

> ID：14087318
> 
> 赞同：-7
> 
> 时间：2012-12-30T00:46:48.420
> 
> 标签：java, oop

```
public abstract class Animal {
    public abstract void move(int speed);
}

class C1 extends Animal {
    public void move(int speed) {
    }
}

class Cat extends C1 {
    public void move() {
        super.move(2);
    }
}

Cat c = new Cat();
// c.move(); 
```

但我不能打电话`c.move()`；为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T00:49:51.157

// c.move();

这应该在方法/构造函数体中。

```
public static void main(string[] args) {
Cat c = new Cat();
 c.move();
} 
```

# movieclip - 需要 Quartz Composer Expect - 这可能吗？

> ID：14087319
> 
> 赞同：0
> 
> 时间：2012-12-30T00:47:04.480
> 
> 标签：movieclip, quartz-composer

刚刚开始使用 QTZ。

想在我加入之前确保这是可能的。

我可以让我的 QTZ 在文件夹中选择一个随机电影，运行它，然后当 mov 部分结束时，加载一个静态 PNG 并让它保持直到 qtz 卸载？

我假设每次加载 QTZ 时，它都会获取随机 mov 然后重复该过程。

这将用于 BB-TV 或类似系统中的电台创意。

所以我还需要能够在 720p 帧大小内调整和移动“图像”。（即在角落显示MOV和静态图像）

谢谢，

伊恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T09:53:27.680

您可能想看看[http://kineme.net/上的 Kineme Video Tools 和 Data Tools](http://kineme.net/)

对于随机加载，您可以在返回的文件路径结构上选择一个随机索引（随机 -> 结构索引成员）。

然后你将不得不在你的视频显示和你的 PNG 显示之间切换（它们都在喂一个精灵或一个广告牌）。使用 Quartz Composer，您可以根据需要放置和调整显示器大小。

# android - 以编程方式在android中启用和禁用振动

> ID：14087322
> 
> 赞同：8
> 
> 时间：2012-12-30T00:48:12.480
> 
> 标签：android

在我的一个 android 应用程序中，我需要完全启用或禁用振动，而与模式无关（即静音或一般或响亮）。

我目前在**已弃用的函数 setVibrateSetting的帮助下使用以下代码**

// 用于开启振动模式

```
audio.setVibrateSetting(AudioManager.VIBRATE_TYPE_RINGER,
            AudioManager.VIBRATE_SETTING_ON);
audio.setVibrateSetting(AudioManager.VIBRATE_TYPE_NOTIFICATION,
            AudioManager.VIBRATE_SETTING_ON); 
```

// 用于关闭振动模式

```
audio.setVibrateSetting(AudioManager.VIBRATE_TYPE_RINGER,
            AudioManager.VIBRATE_SETTING_OFF);
audio.setVibrateSetting(AudioManager.VIBRATE_TYPE_NOTIFICATION,
            AudioManager.VIBRATE_SETTING_OFF); 
```

但我想知道是否有明确的方法可以做到这一点。

欢迎提出建议:)

问候， Jujare

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-04-19T04:42:00.890

的弃用文本[`setVibrateSetting()`](https://developer.android.com/reference/android/media/AudioManager.html#setVibrateSetting%28int,%20int%29)说：

> 此方法应仅由替换音频设置的平台范围管理或主要电话应用程序的应用程序使用。

据我了解，没有其他选项可以全局启用或禁用振动，因此如果您有诸如铃声配置文件管理器之类的应用程序，则可能需要使用它。

恕我直言，谷歌在这里不恰当地使用了弃用。

我使用以下类将弃用隐藏在一个“compat”类中：

```
@SuppressWarnings("deprecation")
class AudioManagerCompat {
    final static int VIBRATE_TYPE_RINGER = AudioManager.VIBRATE_TYPE_RINGER;
    final static int VIBRATE_TYPE_NOTIFICATION = AudioManager.VIBRATE_TYPE_NOTIFICATION;
    final static int VIBRATE_SETTING_ON = AudioManager.VIBRATE_SETTING_ON;
    final static int VIBRATE_SETTING_OFF = AudioManager.VIBRATE_SETTING_OFF;
    final static int VIBRATE_SETTING_ONLY_SILENT = AudioManager.VIBRATE_SETTING_ONLY_SILENT;

    static int getVibrateSetting(AudioManager am, int vibrateType) {
        return am.getVibrateSetting(vibrateType);
    }

    static void setVibrateSetting(AudioManager am, int vibrateType, int vibrateSetting) {
        am.setVibrateSetting(vibrateType, vibrateSetting);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:25:35.327

这是我的代码

```
switch (position) {
    case 0:
        audioManager.setRingerMode(AudioManager.RINGER_MODE_SILENT);
        break;
    case 1:
        audioManager.setRingerMode(AudioManager.RINGER_MODE_VIBRATE);
        break;
    case 2:
        audioManager.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
        audioManager.setVibrateSetting(AudioManager.VIBRATE_TYPE_RINGER, 
                AudioManager.VIBRATE_SETTING_OFF);
        break;
    case 3:
        audioManager.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
        audioManager.setVibrateSetting(AudioManager.VIBRATE_TYPE_RINGER, 
                AudioManager.VIBRATE_SETTING_ON);
        break;
    } 
```

当我将我的 nexus 与 Gingerbread 和 IceCreamSandwich 一起使用时，setVibrateSetting 工作正常，我使用 ICS 开发它，但是最近我发现它不适用于 Jelly Bean，并且 getVibrateSetting 也不起作用。期待更好的方法~

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-03T10:40:33.670

您可以使用以下代码行：

```
Vibrator v = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);

vibration.cancel(); 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-12-30T01:20:57.973

检查[这个](https://stackoverflow.com/questions/10014005/enable-disable-vibration-function-in-android)，我发现这是第一个谷歌结果。编码：

```
if(isVibrate){
Vibrator vib = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);  
     vib.vibrate(500);
      Toast.makeText(this, "vib started", Toast.LENGTH_LONG).show();
}

else{

// do nothing

} 
```

# c# - MVC 4 Razor Html.Checkbox 列表从多对多关系

> ID：14087325
> 
> 赞同：1
> 
> 时间：2012-12-30T00:48:37.090
> 
> 标签：c#, razor, asp.net-mvc-4

我想知道如何从以下模型中获取值并显示复选框列表，并选中相应的复选框。为简单起见简化了模型。

**模型**_

 **```
 public class Project
 {
    public int ProjectID { get; set; }
    public string Title { get; set; }
    public virtual ICollection<Characteristic> Characteristic { get; set; }
 }
 public class Characteristic
 {
    public int CharacteristicID { get; set; }
    public string CharacteristicName { get; set; }

    public virtual ICollection<Project> Project { get; set; }
 }
 public class ProjectCharacteristic
 {
    public int ID { get; set; }
    public int ProjectID { get; set; }
    public int CharacteristicID { get; set; }

    public Project Project { get; set; }
    public Characteristic Characteristic { get; set; }
 } 
```

视图**模型**

```
public class ProjectEditIndexData
{
    public Project Project{ get; set; }
    public List<Characteristic> Chars { get; set; }
} 
```

**控制器**_

 **```
 public ActionResult Edit(int id = 0)
    {
        ProjectEditIndexData project = new ProjectEditIndexData();
        project.Project = db.Projects.Find(id);
        project.Chars = db.Characteristics.ToList();
        return View(project);
    } 
```

**重申：** 如何将项目中所有给定特征的列表作为复选框，其中已选中的特征标记为已选中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T04:46:26.110

我无法让助手工作，所以我只是编写了一个 foreach 循环来检查查找表中是否存在该值并将其标记为我自己检查。我在 Razor 视图中执行此操作。有用。不确定这是否是不好的做法。

```
 foreach(var c in Model.Chars) {
            string checkedStatus = "";
            if (Model.Project.ProjectCharacteristic.Any(x => x.CharacteristicID == c.CharacteristicID))
            {
                checkedStatus = "checked";
            }
            <label class="label_check">
                <input type="checkbox" name="Characteristic" value="@c.CharacteristicID" @checkedStatus> @c.CharacteristicName
            </label>
        } 
```****

# c# - C# 有什么方法可以将 byte[]/int32 转换为 int24？

> ID：14087326
> 
> 赞同：3
> 
> 时间：2012-12-30T00:49:22.020
> 
> 标签：c#

我有一个文件。我从偏移量 05 中读取了 3 个字节。那么如何将该字节 [] 转换为 int24？或者，如果我将该数组转换为 int32，然后将该 int32 转换为 int24，它会起作用吗？以及如何转换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T00:52:06.550

不直接支持 Int24，但是有一个类似的问题描述了如何实现您的需要：

```
public struct UInt24 {
   private Byte _b0;
   private Byte _b1;
   private Byte _b2;

   public UInt24(UInt32 value) {
       _b0 = (byte)(value & 0xFF);
       _b1 = (byte)(value >> 8); 
       _b2 = (byte)(value >> 16);
   }

   public unsafe Byte* Byte0 { get { return &_b0; } }
   public UInt32 Value { get { return _b0 | ( _b1 << 8 ) | ( _b2 << 16 ); } } 
```

}

```
UInt24 uint24 = new UInt24( 123 ); 
```

[C# 中是否有任何 Int24 实现？](https://stackoverflow.com/questions/12549197/are-there-any-int24-implementations-in-c)

# jquery - jQuery Click 功能在 Chrome 上不起作用

> ID：14087332
> 
> 赞同：0
> 
> 时间：2012-12-30T00:49:54.773
> 
> 标签：jquery, css, click

我想将菜单的样式切换器放在我的网站上，但它在 Chrome / IE / Safari 上不起作用（在 FireFox 上运行良好）。这是一些代码：

```
 // Menu Style Switcher
    $("#option-1").click(function(){
        $("#navigation").removeClass("style-2");
    });

    $("#option-2").click(function(){
        $("#navigation").addClass("style-2");
    });

<div class="menu-style">
    <select>
        <option id="option-1">Style 1</option>
        <option id="option-2">Style 2</option>
    </select>
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T00:52:50.770

`addClassName`不存在。函数的正确名称是`addClass`

* * *

另一个改进是使用元素的`change`事件而不是选项上的..`select``click`

```
// Menu Style Switcher
$('.menu-style select').change(function(){
    if (this.value === 'Style 1'){
        $("#navigation").removeClass("style-2");
    } else {
        $("#navigation").addClass("style-2");
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T00:52:24.287

您应该收听[`change`](http://api.jquery.com/change/)整个`<select>`元素的事件。

**标记**：

```
<select id="yourSelect">
    <option value="1">1</option>
    <option value="2">2</option>
</select> 
```

**JS**：

```
$('#yourSelect').change(function(e){

    if( $(this).val() == 1){

        $("#navigation").removeClass("style-2");        

    }else{

        $("#navigation").addClass("style-2");        

    }
} 
```

[见小提琴](http://jsfiddle.net/ACW27/)。

# python - 查找文本中出现在列表单词中的单词

> ID：14087336
> 
> 赞同：2
> 
> 时间：2012-12-30T00:50:45.703
> 
> 标签：python, nlp

> **可能重复：**
> [检查另一个字符串中是否存在多个字符串](https://stackoverflow.com/questions/3389574/check-if-multiple-strings-exist-in-another-string)

假设我有一个允许的单词/短语列表：

```
'Stack'
'Overflow'
'Stack Overflow'
'Stack Exchange'
'Exchange' 
```

以及要解析的以下文本：

```
'Hello, and welcome to Stack Overflow. 
 Here are some words which should match: Stack, Exchange.' 
```

我想获取在允许列表中找到的单词列表：

*   '堆栈溢出'
*   '堆'
*   '交换'

实现结果的最佳方法是什么？

我将使用的允许列表可能至少有一千个单词/短语。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:15:36.127

将单词放在列表中并在使用后

```
def intersect(x, y):
    return list(set(x) & set(y))
word_list_text=string.split(text)
words_found={}
words_found=intersect(word_list_text, words) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:10:52.457

如果您有以下短语：

```
phrases = ['Stack','Overflow','Stack Overflow','Stack Exchange','Exchange'] 
```

然后文本为：

```
text = """Hello, and welcome to Stack Overflow. 
Here are some words which should match:Stack, Exchange.""" 
```

然后可以进行以下操作：

```
found_words = [word for word in phrases if word in text] 
```

如果它们不在文本中，这将消除其他短语。尽管除了指定的内容之外，这也会溢出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T01:16:23.083

让单词成为您要搜索的单词列表和要搜索单词的段落（给出的信息段落）

```
for i in words:
    if i in paragraph:
        print i 
```

此代码适用于您问题中的段落和单词，但请注意，如果我们有 stackoverflow 而没有堆栈（单独），此代码将打印堆栈，这既是优点也是缺点，取决于您的目的，如果您想要它对于单个单词使用这个

```
y=paragraph.split()
for i in words:
    if i in y:
        print i 
```

# facebook-graph-api - Grails spring security如何在自定义身份验证中记住我？

> ID：14087342
> 
> 赞同：1
> 
> 时间：2012-12-30T00:52:09.320
> 
> 标签：facebook-graph-api, grails, spring-security, oauth-2.0, grails-plugin

我使用带有自定义身份验证方法的 grails spring security 进行 facebook 身份验证：

```
def auth() {
    ...
} 
```

当我在浏览器中检查 cookie 时，我可以看到当浏览器会话关闭时 cookie 的生命周期已经结束。只有当我使用插件中的默认登录/身份验证操作时，才会设置持久的 rememberMe cookie。

我必须进行哪些更改才能使使用我的自定义身份验证方法登录的用户不会在会话之间注销？

对于重新身份验证，我使用：

```
def success() {

    // get facebook user data

    springSecurityService.reauthenticate username

    if(springSecurityService.loggedIn) {
            // do something

    }
} 
```

如何设置 rememberMe cookie？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T17:36:13.233

思路：让spring security记住我服务知道应该考虑登录成功。

1.  在您的 facebook 成功操作中，成功验证后，请执行以下操作：

    ```
    //wire remember me services
    def rememberMeServices

    //... in your action:
    springSecurityService.reauthenticate username

    def authentication = SecurityContextHolder.context.authentication
    rememberMeServices.loginSuccess(request, response, authentication) 
    ```

2.  在您的 Config.groovy 中，添加以下内容

    ```
    grails.plugins.springsecurity.rememberMe.alwaysRemember = true 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T19:34:07.343

在提交的原始 auth.gsp 和自定义的 auth.gsp 之间比较请求的 POST 参数。将有一个额外的隐藏字段，这是缺失的。为此使用 Firebug。

# javascript - iOS 中 html5 音频限制的功能测试？

> ID：14087355
> 
> 赞同：4
> 
> 时间：2012-12-30T00:54:09.713
> 
> 标签：javascript, ios, html, web, html5-audio

我知道您无法在 iOS 中更改（或静音）HTML5 音频元素的音量，因此我正在寻找一种方法来测试这一点（以便我可以删除与音量相关的 UI 元素）。

看完之后：

[http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Device-SpecificConsiderations/Device-SpecificConsiderations.html#//apple_ref/doc/uid/TP40009523-CH5-SW10](http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Device-SpecificConsiderations/Device-SpecificConsiderations.html#//apple_ref/doc/uid/TP40009523-CH5-SW10)

具体来说：

“在 iOS 设备上，音频电平始终在用户的物理控制之下。在 JavaScript 中无法设置音量属性。读取音量属性始终返回 1。”

我想我可以创建一个新的 Audio 对象，尝试将音量更改为 1 以外的值，然后测试音量。IE ：

```
var isIOS = false; 
var test = new Audio(); 
test.volume = 0.5; 
if (test.volume === 1) { 
    isIOS = true; 
} 
```

我只是想知道是否有人知道这有任何可能的问题，和/或有更好的解决方案。有误报的可能吗？

此外，有没有人知道任何其他不允许音量更改但不以这种方式实现的设备？

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T18:46:47.583

好的，所以我已经在少数设备和模拟器上对此进行了测试，它看起来足够可靠。我能看到的唯一危险是（现在或将来）存在一些不允许此类音量更改的其他设备，但它以其他方式实现了该限制。如果有人遇到这个问题可以告诉我，那就太好了。干杯。

编辑：作为记录，我现在使用这个： http: [//mobiledetect.net/](http://mobiledetect.net/)并且只是关闭所有移动设备的音量 UI 元素。似乎越来越多的设备对音频进行了限制，并且考虑到可以通过物理按钮轻松更改音量以及受限的屏幕空间，最好关闭所有移动设备的音量 UI 元素。

# ruby - 将任何 URL 或路径规范化为标准路径语法

> ID：14087359
> 
> 赞同：2
> 
> 时间：2012-12-30T00:54:34.633
> 
> 标签：ruby

我想获取一个 URL 或仅一个路径，并以一致的语法去除路径之外的所有内容，例如没有结尾斜杠等。

例子：

```
'/categories/cameras/'             => '/categories/cameras'
'http://domain.com/products/'      => '/products'
'products'                         => '/products'
'deals/newyears/'                  => '/deals/newyears'
'https://domain.com/'              => '/'
'https://domain.com/terms#refunds' => '/terms'
''                                 => '/' 
```

任何想法如何制作一种方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:06:18.503

这是一个相当具体的用例。除非您愿意编写自己的函数，否则我想不出任何可以用单个函数处理此问题的方法。

通常类似的东西`"products"`被认为是相对路径，其中`"/products"`是文字路径并且`"http://example.com/products"`是绝对URI。这些中的每一个在`URI.join`.

我不确定如何`"domain.com/products"`解释为，`"/products"`除非您假定路径的第一部分不允许包含`.`. 一个相当有说服力的假设，但也许这适用于您的用例。

这是一个可能有效的片段：

```
require 'uri'

def remap(path)
  uri = nil

  case (path)
  when %r<^https?://>
    uri = URI.parse(path)
  when %r<^/>
    uri = URI.parse("http://example.com#{path}")
  when %r<^[\w\-]+\.\w+/>
    uri = URI.parse("http://#{path}")
  else
    uri = URI.parse("http://example.com/#{path}")
  end

  uri and uri.path
end 
```

我不确定为什么`"/"`会返回空字符串，因为所有其他字符串都以斜杠为前缀。如果您愿意，您可以随时添加该逻辑，但它似乎不一致。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T04:02:13.343

这似乎有效：

```
require 'uri'

def standard_path(p)
  path = URI.parse(p).path
  path.insert(0, '/') if (path[0] != '/')
  path.chomp!('/') if (path > '/')
  path
end

[
  '/categories/cameras/',
  'http://domain.com/products/',
  'products',
  'deals/newyears/',
  'https://domain.com/',
  'https://domain.com/terms#refunds',
  '',
].each do |p|
  puts standard_path(p)
end 
```

哪个输出：

```
/categories/cameras
/products
/products
/deals/newyears
/
/terms
/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T01:01:27.297

您是否尝试过仅使用[Ruby 标准 URI 库](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/uri/rdoc/URI.html)？

```
> require "uri"
 => true 
> URI.parse("/foo").path
 => "/foo" 
> URI.parse("http://google.com/foo").path
 => "/foo" 
> URI.parse("http://google.com").path
 => "" 
```

# jquery - 在选中的复选框上动态更改背景图像

> ID：14087360
> 
> 赞同：3
> 
> 时间：2012-12-30T00:54:46.337
> 
> 标签：jquery, html

嗨这是我在stackoverflow社区中的第一个问题，我在检查复选框时动态地改变我的网页背景图像的问题

HTML：

```
<ul>
    <li><label for="Lines">Add Fun: </label><input type="checkbox" id="Lines" name="Lines" /></li>
</ul> 
```

jQuery：

```
<script type="text/javascript">
        if ($('#Lines').is(':checked')) {
                    $("body").css({'background-image': 'url(http://upload.wikimedia.org/wikipedia/commons/d/d3/Mud_wrestling_couple.jpg)'});
        }
</script> 
```

我希望它在选中复选框后立即更改正文的背景。图片是我在网上随便找的一张。想我可能忽略了一些东西。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T01:02:13.647

你可以试试这个

```
​$(function(){
    $('#Lines').on('change', function(){
        if($(this).is(':checked')) 
        {
            $("body").css({ 'background-image': 'url(image url)' });
        }
        else $("body").css({'background-image':''});
    });
});​ 
```

[**例子**](http://jsfiddle.net/xhwFd/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T01:02:59.133

好吧，一旦复选框被更改，您需要进行检查..所以使用[`.change()`](http://api.jquery.com/change)事件处理程序

```
<script type="text/javascript">
    $('#Lines').change(function(){
       if (this.checked){
          $("body").css({'background-image': 'url(http://upload.wikimedia.org/wikipedia/commons/d/d3/Mud_wrestling_couple.jpg)'});
       } else {
          // here you should do what you want when the user un-checks the checkbox..
       }
    });
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T01:03:41.637

```
$('#Lines').click(function ()
{
 if ($(this).is(':checked'))
 {
   $("body").css({'background-image': 'url(http://upload.wikimedia.org/wikipedia/commons/d/d3/Mud_wrestling_couple.jpg)'});
 }
}); 
```

# ruby-on-rails - 撬：ctrl-arrow（ubuntu）上的工件

> ID：14087361
> 
> 赞同：0
> 
> 时间：2012-12-30T00:55:02.803
> 
> 标签：ruby-on-rails, ruby, readline, pry

我使用 rvm 安装了 ruby​​，并在 RoR 项目中使用它。问题是，当我`pry`在该项目中开始时，我无法使用 ctrl-arrows 快捷方式>而不是左/右获取单词，而是打印工件，例如`;5D`or `;5C`。当我`pry`在那个项目之外打电话时，一切都很好。ctrl-arrows 也适用于常规控制台。我已经尝试使用 readline 支持重新安装 readline 和 ruby​​。我还能做什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T13:00:07.453

我发现了问题。我`rb-readline`的`Gemfile`. 一旦我删除它，问题就消失了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-02T03:08:21.047

解决此问题的一种方法是`.inputrc`在您的主目录中创建一个包含以下内容的：

```
"\033[1;5C": forward-word
"\033[1;5D": backward-word 
```

我在 bash 和 pry 上都遇到了这个问题，上面为我解决了这个问题。

请注意，这`"\033[1;5C"`似乎因您的操作系统或您正在使用的终端软件而异。在 OSX 上，您可以通过转到 Terminal.app 的“设置”对话框、选择配置文件并单击“键盘”选项卡来查看按 ctrl-right 时实际生成的指令：

*   在雪豹上，默认值为`\033[5D`
*   在 Mavericks 上，默认值为`\033[1;5C`

发生此问题是因为您的 shell 无法识别您的终端发送的指令（？请耐心等待 - 以下主要是基于我的谷歌搜索的猜测）

以下是这些代码的分解方式：

`\033`是 ASCII[转义字符](https://en.wikipedia.org/wiki/Escape_character)的八进制表示。它的意思是“将以下内容解释为操作终端的说明——而不是文本”。它还可以根据上下文以其他方式表示，包括：

*   十六进制为`^[`（例如`^[[1;5D`）
*   在 bash 中作为`\e`（例如`\e[5D`或`\e\e[D`）

我认为`1`just 的意思是“在与光标相同的行上执行此操作，并且`5D`旨在解释为“向前跳过一个单词”。只是将`;`两条指令分开。

我的猜测是，这个问题来自一些 shell 或实用程序，要么本身不理解`5D`应该意味着“跳过一个单词”，要么不支持使用`;`. 添加一个`.inputrc`填充空白并使一切正常:)

# html - Pevent Inspect Element html 从保存到数据库更改为下拉菜单值（和其他用户输入的内容）

> ID：14087365
> 
> 赞同：0
> 
> 时间：2012-12-30T00:56:26.240
> 
> 标签：html, forms, security, firebug, web-inspector

我最近才开始测试我的网站是否存在错误等，我遇到了一个我从未想过会成为问题的巨大问题，因为我认为使用 Firebug 和类似插件等对网站所做的更改实际上并没有通过......但他们确实......

当我将值更改为表单等并保存更改时，无论我如何尝试传递数据，我使用 Inspect Element 所做的更改都会通过。显然，肯定有办法阻止这种情况。

我一直在寻找这个问题的答案，但一无所获。

**编辑**

也许这只是我如何提交表格和信息的问题。我正在使用 jQuery 的 ajax 并从表单中手动选择信息，这显然是获取更改信息的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:15:38.113

没有办法阻止这种情况。Web 应用程序永远无法信任客户端（浏览器），因为客户端处于外部控制之下。用户甚至可以完全绕过网络浏览器，通过 curl 之类的工具将数据提交到您的服务器。

无论您多么彻底地验证和检查浏览器中输入的数据，当它到达您的服务器时，您也必须检查它。

# clojure - clojure 版本之间的差异

> ID：14087366
> 
> 赞同：2
> 
> 时间：2012-12-30T00:56:32.950
> 
> 标签：clojure

我找不到任何关于它的文档。有什么区别？只有错误修复吗？新版本是旧版本的替代品吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T01:01:07.483

源代码树中有发行说明。

[https://github.com/clojure/clojure/blob/master/changes.md](https://github.com/clojure/clojure/blob/master/changes.md)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T11:37:46.257

过去从 1.2 到 1.3 发生了巨大的变化——不是在核心，而是在*contrib*库中。我们不得不重写所有依赖于旧 contrib 的代码，这是一项艰巨的工作。`Integer`1.4 版引入了关于整数文字的重大更改，从`Long`. 这破坏了很多 Java 互操作代码，但修复起来很简单。1.5 版是最干净的增量，根本没有重大更改（据我所知）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T01:06:44.807

通常，它将是错误修复和新增强功能的结合。您还可以期待一些性能改进。

它*通常是*一个直接替换，因为其目的是保持向后兼容性。在特殊情况下可能会发生一些重大更改，但是我自己已经将几个项目从 1.4 版本更新到 1.5 beta 并且没有出现任何问题。

与更新主要依赖项时一样，您应该彻底测试新版本。

# javascript - For Loop 不会在 Javascript 中退出，无限循环

> ID：14087371
> 
> 赞同：0
> 
> 时间：2012-12-30T00:57:21.363
> 
> 标签：javascript, for-loop

我的脚本导致浏览器冻结并要求我停止脚本。使用 firebug 我可以看到 for 循环无休止地循环并且没有取得任何进展。这是循环：

```
for (var x = 1; x < 7; x++) {
    var y = x; //to stop the value of x being altered in the concat further down
    var questionidd = "mcq_question_id";
    console.log("1 = " + questionidd);
    var questionid = questionidd.concat(y); // mcq_question_id$ctr the question number
    console.log("2 = " + questionid);
    var mcqid = form[questionid].value; // the questions id on db
    console.log("3 = " + mcqid);

    var answerr = "mcq_question";
    var answer = answerr.concat(y); // mcq_question$ctr the questions chosen answer
    var chosenanswer = form[answer].value; // the answers value
    console.log("4 = " + chosenanswer);
    var amp = "&";
    var equal = "=";
    var questionide = questionid.concat(equal); // "mcq_question_id$ctr="
    var questionida = amp.concat(questionide); // "&mcq_question_id$ctr="
    var answere = amp.concat(answer, equal); // "&mcq_question$ctr="
    if (x = 1) {
        send.push(questionide, mcqid, answere, chosenanswer);
    }
    else {
        send.push(questionida, mcqid, answere, chosenanswer);
    }
} 
```

更新 - 已修复！愚蠢的错误是最糟糕的

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T00:58:48.667

```
if (x = 1) { 
```

应该

```
if (x === 1) { 
```

`===`运算符在赋值运算符赋值时*进行**比较*。很多人都会犯这个错误。:)`=`

 *当第一个循环运行时，它设置`x`为零，并且无限循环直到进程终止。这就是循环不会停止的原因。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T00:58:39.043

`if (x = 1) {`应该`if (x === 1) {`

考虑切换到可以捕获此类简单编程错误的 IDE。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T01:00:13.740

看起来您应该使用“if (x == 1)”而不是“if (x = 1)”。

您的代码反复将 x 设置为值 1，而不是检查它是否等于 1。*

# c# - ASP.net 正确登录 - 注销类 - 控制登录状态

> ID：14087374
> 
> 赞同：0
> 
> 时间：2012-12-30T00:58:19.170
> 
> 标签：c#, asp.net, login, logout, login-control

您对以下函数类有什么改进建议吗？

好的，我如何进行注册会员登录

```
 HttpCookie LoginInfo = new HttpCookie("LoginInfo");
    LoginInfo.Values["UserName"] = srUserName;
    LoginInfo.Values["Password"] = srPassword;
    LoginInfo.Values["selectedLanguage"] = srSelectedLanguage;
    Response.Cookies.Add(LoginInfo); 
```

在这里我如何检查访问者是否登录

```
public static void controlOfLoginStatus()
{
    string srQuery = "";
    string srUserName = "";
    string srPassword = "";
    string srLang = "";

    if (HttpContext.Current.Session["UserId"] == null)
    {
        if (HttpContext.Current.Request.Cookies["LoginInfo"] != null)
        {
            try
            {
                srUserName = HttpContext.Current.Request.Cookies["LoginInfo"]["UserName"].ToString();
                srPassword = HttpContext.Current.Request.Cookies["LoginInfo"]["Password"].ToString();
                srLang = HttpContext.Current.Request.Cookies["LoginInfo"]["selectedLanguage"].ToString();
            }
            catch
            {

            }
        }
        string srUserIdTemp = csPublicFunctions.ReturnUserIdUsernamePassword(srUserName, srPassword);
        if (srUserIdTemp == "0")
        {
            HttpContext.Current.Session.Clear();
            HttpContext.Current.Session.Abandon();
            HttpContext.Current.Response.Redirect("Login");
        }
        else
        {
            csPublicFunctions.insertIntoOnlineUsers(srUserIdTemp, HttpContext.Current.Session.SessionID);
            HttpContext.Current.Session["UserId"] = srUserIdTemp;
            if (HttpContext.Current.Session["lang"] == null)
                HttpContext.Current.Session["lang"] = srLang;
        }
    }

    srQuery = "SELECT UserId " +
     " FROM BannedUsers" +
     " WHERE UserId = " + HttpContext.Current.Session["UserId"].ToString();
    using (DataTable dtTemp = DbConnection.db_Select_DataTable(srQuery))
    {
        if (dtTemp.Rows.Count > 0)
        {
            HttpContext.Current.Response.Redirect("exit.aspx");
        }
    }
} 
```

在这里我如何注销

```
public static void exitLogout()
{
    string srQuery = "delete from OnlineUsers where UserId=" + HttpContext.Current.Session["UserId"].ToString();
    DbConnection.db_Update_Delete_Query(srQuery);

    try
    {
        HttpContext.Current.Session["UserId"] = "0";
        HttpContext.Current.Session.Clear();
        HttpContext.Current.Session.Abandon();
    }
    catch
    {

    }

    try
    {
        HttpCookie LoginInfo = new HttpCookie("LoginInfo");
        LoginInfo.Values["UserName"] = "21412zxcvzxc343245243vvc";
        LoginInfo.Values["Password"] = "21412zxcvzxc343245243vvc";
        LoginInfo.Values["selectedLanguage"] = "en";
        HttpContext.Current.Response.Cookies.Add(LoginInfo);
    }
    catch
    {            
    }
} 
```

`csPublicFunctions.ReturnUserIdUsernamePassword`使用参数化查询，因此没有 SQL 注入的风险

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:42:03.423

我强烈建议您使用 asp.net FormsAuthentication 和内置的成员资格提供程序。代码将变得更加清晰和标准化。

在你的情况下，我会使用 SqlMembershipProvider。检查此链接

[http://bensteinhauser.wordpress.com/2012/07/16/using-the-sqlmembershipprovider/](http://bensteinhauser.wordpress.com/2012/07/16/using-the-sqlmembershipprovider/)

以下是登录代码示例

```
var authTicket = new FormsAuthenticationTicket(1, //version
    login.UserName, // user name
    DateTime.Now, //creation
    DateTime.Now.AddMinutes(30), //Expiration
    true, //Persistent
    userId);

    var encTicket = FormsAuthentication.Encrypt(authTicket);
    Response.Cookies.Add(new HttpCookie(FormsAuthentication.FormsCookieName, encTicket)); 
```

注销很简单

```
FormsAuthentication.SignOut(); 
```

并且用于检查用户是否仅登录

```
User.Identity.IsAuthenticated 
```

# c# - Visual Studio：C# GridView - 与行内联的列标题

> ID：14087379
> 
> 赞同：0
> 
> 时间：2012-12-30T00:59:55.313
> 
> 标签：c#, .net, visual-studio, gridview

我不知道如何做到这一点，因为我在 Visual Studio 2012 中使用 GridView：

GridView 默认为：

```
-------------------------
| Column 1  | Column 2 |
-------------------------
| Data 1    | Data 2    |
------------------------- 
```

基本上标题（“第 1 列”）在顶部我想得到以下视图：

```
-------------------------
| Column 1 | Data 1    |
-------------------------
| Column 2 | Data 2    |
------------------------- 
```

我在 GridView 属性中找不到执行此操作的选项。有解决方法还是我应该只使用 Form View ？

# jquery - 链接到 jQuery 作品集风格画廊 (Galleriffic) 上的特定项目

> ID：14087380
> 
> 赞同：0
> 
> 时间：2012-12-30T01:00:01.947
> 
> 标签：jquery, html, onclick, galleriffic

我为你创建了一个演示，[在这里](http://lorenzoraffio.com/test.php)。如您所见，下面有一个带有相关标题的主图像和其他小图像。如果您单击其中一个，则主图像/标题会更改为显示您选择的那个。如果您注意到当您将指针悬停在大图像下方的任何图像上时，您会得到一个类似 test.php/#image3 或 test.php/#image6 的链接。

如果您访问 test.php/#image3（直接，而不是通过 onClick 事件），我正在寻找一种方法，您将 #image3 作为主图像（因此无需单击它）。test.php/#image4 / #image5 等也是如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T02:01:22.000

你可以使用这个：

```
$url  =  window.location.hash; 
```

这为您提供了网址的#imagex 部分

# r - 在 xts/zoo 数据集中设置特定时间段值

> ID：14087381
> 
> 赞同：1
> 
> 时间：2012-12-30T01:00:04.770
> 
> 标签：r, xts, zoo

尝试为日期“2010-09-24”和所有其他时间段的值为 100 和 NA 的数据集生成第三个变量，称为“var”。

```
> dataset
           weight
2010-10-04  52495
2010-10-01  53000
2010-09-30  52916
2010-09-29  52785
2010-09-28  53348
2010-09-27  52885
2010-09-24  52174
2010-09-23  51461
2010-09-22  51286
2010-09-21  50968
2010-09-20  49250
> dataset=merge(dataset,var=NA) 
```

我知道我可以使用`ifelse(index(dataset)=="2010-09-24",100,NA)`来生成变量。但是是否有任何函数可以用来将样本限制为“2010-09-24”，然后将值放在正确的列和行中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:35:13.200

我以前从未见过以这种方式使用 merge() ，并且该命令对我不起作用。所以也许我误解了这个问题或遗漏了关于时间序列数据的一些东西，但我会这样做：

1：添加一个新的 NAs 向量

> 数据集$var<-NA

2：索引到您想要的日期并将值 100 保存到变量 var

> 数据集[dataset$date=="24-09-2010","var"]<-100

那是你要找的吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T01:17:24.483

是 - 如果您使用具有适当时间索引的数据类型，例如[zoo](http://cran.r-project.org/package=zoo)或[xts](http://cran.r-project.org/package=xts)。

在这里查看关于这两个问题的先前问题，和/或阅读[zoo](http://cran.r-project.org/package=zoo)包中的小插曲。

# crossrider - Crossrider：更改链接的标题

> ID：14087384
> 
> 赞同：0
> 
> 时间：2012-12-30T01:00:43.527
> 
> 标签：crossrider

使用 crossrider，是否可以在 dom 中获取链接对象并更改链接的标题。我正在创建一个插件来检测恶意站点并在链接前面添加 [Malicious]。

我可能可以通过解析字符串来做到这一点，但如果 DOM 支持它，它会让我的生活变得更轻松。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T09:06:58.893

Crossrider 扩展支持 jQuery ($) 对象，因此您可以使用它从 extension.js 文件中获取链接，如下所示：

```
appAPI.ready(function ($) {
    // Where <linkSel> is the selector for retrieving the link or links you require
    $(<linkSel>).text(); // retrieves the text for the specified <linkSel> object

    // OR the following to prefix the link's text with '[Malicious] '
    $(<linkSel>).text('[Malicious] ' + $(<linkSel>).text());
}); 
```

# winrt-xaml - 来自 DataTemplate 的 WinRT 事件处理

> ID：14087387
> 
> 赞同：1
> 
> 时间：2012-12-30T01:01:11.240
> 
> 标签：winrt-xaml

我有一个 DataTemplate，它需要一个对象的事件处理程序。此 DataTemplate 包含在 ResourceDictionary 中。向此模板添加事件处理程序的最佳方法是什么？

我尝试在 app.xaml.cs 中定义事件处理程序，但处理程序没有执行。为 ResourceDictionary 创建代码隐藏文件会导致应用程序启动期间在 MergedDictionaries 中出现加载错误。

来自 GraphStyles.xaml

```
<DataTemplate x:Key="PieTemplate">
    <Grid HorizontalAlignment="Left" Width="350" Height="350" >
        <Border>
            <Charting:Chart
            x:Name="PieChart"
            Title="Play Attempts"
            Margin="70,0" Loaded="PieChart_Loaded">
                <Charting:Chart.Series>
                    <Charting:PieSeries
                    Title="Attempts"
                    ItemsSource="{Binding Items}"
                    IndependentValueBinding="{Binding Name}"
                    DependentValueBinding="{Binding Value}"
                    IsSelectionEnabled="True" />
                </Charting:Chart.Series>
            </Charting:Chart>
        </Border>
    </Grid>
</DataTemplate> 
```

在 App.Xaml.cs 中

```
 private void PieChart_Loaded(object sender, RoutedEventArgs e)
    {
        var pieChart = sender as Chart;
        var legendItems = ((PieSeries)pieChart.Series[0]).LegendItems;

        foreach (LegendItem item in legendItems)
        {
            pieChart.LegendItems.Add(item);
            pieChart.LegendStyle = item.Style;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T17:20:56.207

**选项1**

据我所知，您必须在顶部的页面/用户控件的资源中引用数据模板。使用合并字典，以便您仍然可以使用 graphstyles.xaml。

如果您因为这违反了惯例而感到不舒服，那么有一个相当冗长的替代方案：

**选项 2**

1.  使用 MVVM Viewmodel 并设置页面/用户控件 DataContext。
2.  将数据模板保存在 graphstyles.xaml 中，并使用[附加行为](http://azurecoding.net/browniepoints/blogs/brownie/2012/07/30/attached-behaviors-in-winrt)来挂钩 Loaded 事件，将事件触发器传递给 viewmodels 命令。
3.  在 UI 可以响应的 ViewModel 中创建一个事件，然后像您所做的那样挂钩并在 Views 代码隐藏中处理。

我必须说我对选项 2 并不生气，因为它破坏了一些视图/VM 分离，但它应该可以完成工作 - 请注意，您必须将图表作为对象从附加的行为传递到视图模型然后回到视图，然后再将其转换回图表。

# c# - 更新，插入到 sql .. 已经有一个打开的 DataReader 关联

> ID：14087391
> 
> 赞同：-1
> 
> 时间：2012-12-30T01:01:31.167
> 
> 标签：c#, asp.net, sql

![在此处输入图像描述](../Images/40c085598cf518c88321abb09d24f66e.png)

```
string[] stringList2 = new string[10];
if (VaildDataRow == true)
{                        
//Response.Write("<script>alert('2valid data row" + TbRow + "')</script>");
TbCol = 0;
TcCol = 1;
foreach (TableCell tc in tr.Cells)
{
#region //Load array with valid row text boxes' value
foreach (Control c1 in tc.Controls)
{
if (c1 is TextBox)
{
if (c1.ID.StartsWith("DataTbFld_"))
{
TextBox txt = (TextBox)t11.FindControl(c1.ID);
if (string.IsNullOrEmpty(txt.Text))
{
//Response.Write("<script>alert('txt#id ..not hidden..: " + txt.ID + " found data in textbox, rec is valid , will break')</script>");
txt.Text="Null";
}
stringList2[TbCol] = txt.Text.ToString();
//Response.Write("<script>alert('TbRow : " + TbRow + " TcCol : " + TcCol + " TbCol : " + TbCol + " txt.Text.ToString() : " + txt.Text.ToString() + "')</script>");
}
TbCol += 1;
}                          
}
#endregion//===
TcCol += 1;
}
Response.Write("<script>alert('TbRow : " + TbRow + "')</script>");
#region //if exist update else insert
Response.Write("<script>alert('InputDate = " + stringList2[6] + 
" and Dept= " + stringList2[7] + " and DeptType= " + stringList2[8] + 
" and DeptSubType= " + stringList2[9] + "')</script>");
con.Open();
cmd = new SqlCommand("SELECT * FROM MainDailyData WHERE Dept= '" + stringList2[7] + "' and DeptType = '" + stringList2[8] + "' and DeptSubType= '" + stringList2[9] + "'", con);

dr = cmd.ExecuteReader();
if (dr != null && dr.HasRows)
{
Response.Write("<script>alert('Found,Update')</script>");
SqlDataAdapter myda = new SqlDataAdapter();
myda.UpdateCommand = new SqlCommand("UPDATE MainDailyData SET Product1 = @Prod1, Product2 = @Prod2, Product3 = @Prod3, Product4 = @Prod4, Product5 = @Prod5, Product6 = @Prod6, InputDate = @InDate, Dept = @Dpt, DeptType = @DptType, DeptSubType = @DptSubType", con);
myda.UpdateCommand.Parameters.Add("@Prod1", SqlDbType.VarChar).Value = stringList2[0];
myda.UpdateCommand.Parameters.Add("@Prod2", SqlDbType.VarChar).Value = stringList2[1];
myda.UpdateCommand.Parameters.Add("@Prod3", SqlDbType.VarChar).Value = stringList2[2];
myda.UpdateCommand.Parameters.Add("@Prod4", SqlDbType.VarChar).Value = stringList2[3];
myda.UpdateCommand.Parameters.Add("@Prod5", SqlDbType.VarChar).Value = stringList2[4];
myda.UpdateCommand.Parameters.Add("@Prod6", SqlDbType.VarChar).Value = stringList2[5];
myda.UpdateCommand.Parameters.Add("@InDate", SqlDbType.VarChar).Value = stringList2[6];
myda.UpdateCommand.Parameters.Add("@Dpt", SqlDbType.VarChar).Value = stringList2[7];
myda.UpdateCommand.Parameters.Add("@DptType", SqlDbType.VarChar).Value = stringList2[8];
myda.UpdateCommand.Parameters.Add("@DptSubType", SqlDbType.VarChar).Value = stringList2[9];
//dr.Close();
//con.Open();
myda.UpdateCommand.ExecuteNonQuery();
}
else
{
Response.Write("<script>alert('not Found,Insert')</script>");
SqlDataAdapter myda = new SqlDataAdapter();
myda.InsertCommand = new SqlCommand("INSERT INTO MainDailyData (Product1,Product2,Product3,Product4,Product5,Product6,InputDate,Dept,DeptType,DeptSubType) VALUES(@Prod1,@Prod2,@Prod3,@Prod4,@Prod5,@Prod6,@InDate,@Dpt,@DptType,@DptSubType)", con);
myda.InsertCommand.Parameters.Add("@Prod1", SqlDbType.VarChar).Value = stringList2[0];
myda.InsertCommand.Parameters.Add("@Prod2", SqlDbType.VarChar).Value = stringList2[1];
myda.InsertCommand.Parameters.Add("@Prod3", SqlDbType.VarChar).Value = stringList2[2];
myda.InsertCommand.Parameters.Add("@Prod4", SqlDbType.VarChar).Value = stringList2[3];
myda.InsertCommand.Parameters.Add("@Prod5", SqlDbType.VarChar).Value = stringList2[4];
myda.InsertCommand.Parameters.Add("@Prod6", SqlDbType.VarChar).Value = stringList2[5];
myda.InsertCommand.Parameters.Add("@InDate", SqlDbType.VarChar).Value = stringList2[6];
myda.InsertCommand.Parameters.Add("@Dpt", SqlDbType.VarChar).Value = stringList2[7];
myda.InsertCommand.Parameters.Add("@DptType", SqlDbType.VarChar).Value = stringList2[8];
myda.InsertCommand.Parameters.Add("@DptSubType", SqlDbType.VarChar).Value = stringList2[9];
//dr.Close();
//con.Open();
myda.InsertCommand.ExecuteNonQuery();
}
con.Close();
#endregion
}
#endregion
TbRow += 1;
} 
```

锻炼时

```
myda.InsertCommand.ExecuteNonQuery(); 
```

或者

```
myda.UpdateCommand.ExecuteNonQuery(); 
```

我收到错误消息 已经有一个打开的 DataReader 与此命令关联，必须先关闭

如果我关闭博士，结果会很混乱。如果它在表的第 2 行找到记录，它将从表中插入第 1 行的记录到我尝试启用 MultipleActiveResultSets="true" 的数据库中，但我遇到了一个问题，属性不允许！

我想检查记录是否存在，更新其他，插入。如何实现这一点或如何更正我的代码？

版后：

```
#region //if exist update else insert inserting code
//Response.Write("<script>alert('InputDate = " + stringList2[6] + 
//" and Dept= " + stringList2[7] + " and DeptType= " + stringList2[8] + 
//" and DeptSubType= " + stringList2[9] + "')</script>");
con.Open();
//cmd = new SqlCommand("SELECT 1 FROM MainDailyData WHERE Dept= '" + stringList2[7] + 
//    "' and DeptType = '" + stringList2[8] + "' and DeptSubType= '" + stringList2[9] + "'", con);
cmd = new SqlCommand("SELECT 1 FROM MainDailyData WHERE Dept= @dpt and DeptType = @dptType and DeptSubType= @DptSbType", con);
cmd.Parameters.AddWithValue("@dpt", stringList2[7]);
cmd.Parameters.AddWithValue("@dptType", stringList2[8]);
cmd.Parameters.AddWithValue("@DptSbType", stringList2[9]);

bool fRecordExists = false;
SqlDataReader dr = cmd.ExecuteReader();
//SqlDataReader dr = cmd.ExecuteScalar();
if (dr != null && dr.HasRows)
{
fRecordExists = true;
}
dr.Close();
dr.Dispose();
if (fRecordExists)
{
Response.Write("<script>alert('Found,Update')</script>");
SqlDataAdapter myda = new SqlDataAdapter();
myda.UpdateCommand = new SqlCommand("UPDATE MainDailyData SET Product1 = @Prod1, Product2 = @Prod2, Product3 = @Prod3, Product4 = @Prod4, Product5 = @Prod5, Product6 = @Prod6, InputDate = @InDate, Dept = @Dpt, DeptType = @DptType, DeptSubType = @DptSubType", con);
myda.UpdateCommand.Parameters.Add("@Prod1", SqlDbType.VarChar).Value = stringList2[0];
myda.UpdateCommand.Parameters.Add("@Prod2", SqlDbType.VarChar).Value = stringList2[1];
myda.UpdateCommand.Parameters.Add("@Prod3", SqlDbType.VarChar).Value = stringList2[2];
myda.UpdateCommand.Parameters.Add("@Prod4", SqlDbType.VarChar).Value = stringList2[3];
myda.UpdateCommand.Parameters.Add("@Prod5", SqlDbType.VarChar).Value = stringList2[4];
myda.UpdateCommand.Parameters.Add("@Prod6", SqlDbType.VarChar).Value = stringList2[5];
myda.UpdateCommand.Parameters.Add("@InDate", SqlDbType.VarChar).Value = stringList2[6];
myda.UpdateCommand.Parameters.Add("@Dpt", SqlDbType.VarChar).Value = stringList2[7];
myda.UpdateCommand.Parameters.Add("@DptType", SqlDbType.VarChar).Value = stringList2[8];
myda.UpdateCommand.Parameters.Add("@DptSubType", SqlDbType.VarChar).Value = stringList2[9];
myda.UpdateCommand.ExecuteNonQuery();
}
else
{
Response.Write("<script>alert('not Found,Insert')</script>");
SqlDataAdapter myda = new SqlDataAdapter();
myda.InsertCommand = new SqlCommand("INSERT INTO MainDailyData (Product1,Product2,Product3,Product4,Product5,Product6,InputDate,Dept,DeptType,DeptSubType) VALUES(@Prod1,@Prod2,@Prod3,@Prod4,@Prod5,@Prod6,@InDate,@Dpt,@DptType,@DptSubType)", con);
myda.InsertCommand.Parameters.Add("@Prod1", SqlDbType.VarChar).Value = stringList2[0];
myda.InsertCommand.Parameters.Add("@Prod2", SqlDbType.VarChar).Value = stringList2[1];
myda.InsertCommand.Parameters.Add("@Prod3", SqlDbType.VarChar).Value = stringList2[2];
myda.InsertCommand.Parameters.Add("@Prod4", SqlDbType.VarChar).Value = stringList2[3];
myda.InsertCommand.Parameters.Add("@Prod5", SqlDbType.VarChar).Value = stringList2[4];
myda.InsertCommand.Parameters.Add("@Prod6", SqlDbType.VarChar).Value = stringList2[5];
myda.InsertCommand.Parameters.Add("@InDate", SqlDbType.VarChar).Value = stringList2[6];
myda.InsertCommand.Parameters.Add("@Dpt", SqlDbType.VarChar).Value = stringList2[7];
myda.InsertCommand.Parameters.Add("@DptType", SqlDbType.VarChar).Value = stringList2[8];
myda.InsertCommand.Parameters.Add("@DptSubType", SqlDbType.VarChar).Value = stringList2[9];
myda.InsertCommand.ExecuteNonQuery();
}
con.Close();
#endregion 
```

更新或插入第二行仍然存在问题，如果我填写第一条记录并将第二条记录留空，它将将其插入数据库，但不会接受稍后插入第二行，而是复制第一行记录。可互换，因为如果我先填充第二行。如果我同时填写它们@开头，它将同时插入它们，但不会识别第二条记录并复制第一条记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T01:37:10.237

只要确定有没有结果就立即关闭dr；除了确定记录是否存在之外，您没有将其用于任何其他用途，因此这根本不会影响您的逻辑。

代替：

```
dr = cmd.ExecuteReader();
if (dr != null && dr.HasRows) 
```

和：

```
 bool fRecordExists = false;
        dr = cmd.ExecuteReader();
        if (dr != null && dr.HasRows)
        {
            fRecordExists = true;
        }
        dr.Close();
        if (fRecordExists) 
```

您还应该将 select 语句更改为参数化查询，以防止由于数据中的意外字符导致 SQL 注入攻击和异常。

此外，如果 select 语句除了存在验证之外不用于任何其他用途，则应该只做`SELECT 1`而不是`SELECT *`防止在数据库和应用程序中进行不必要的处理。

最后，如果您的应用程序数据支持它（即选择标准最多只能选择 1 条记录），我建议使用[ExecuteScalar](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)而不是`ExecuteReader`，这将完全消除您的问题。

# networking - 本地主机上的多播数据包顺序

> ID：14087392
> 
> 赞同：2
> 
> 时间：2012-12-30T01:01:52.030
> 
> 标签：networking, multicast

因为多播数据包通常是基于 udp 的，所以它是不可靠的

在本地主机上，我会假设一个数据包只是从一个进程的缓冲区复制到另一个，因此它会按照发送者传输的顺序排队，对吗？

我不确定的是：

1.  我可以在本地主机上为多播（或 udp）假设正确的包顺序吗？如果没有，为什么？
2.  不同操作系统处理（win，mac，linux）的具体区别是什么？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:11:29.603

**我可以在本地主机上为多播（或 udp）假设正确的包顺序吗？如果没有，为什么？**

不，因为这些数据包没有编目。另外，您可能已经知道，不能保证环回连接将保持 UDP 有序。

**不同操作系统处理（win、mac、linux）的具体区别是什么？**

协议没有区别（请参阅[RFC](http://www.ietf.org/rfc/rfc768.txt)），但细节很可能取决于平台（和版本），我敢肯定没有人会立即知道它们（无论如何有些是封闭的）。这是很可能无法保证有序性的另一个原因。即使您确实对此进行了测试并且数据包按顺序排列，但在环回连接中依赖诸如 UDP 数据包顺序之类的东西也是一个非常糟糕的主意 (tm)。

**另外**：UDP“不可靠”的论点虽然是真的，但可能会产生误导。许多具有安全意识的软件通过 UDP 工作，并且通常只有一小部分数据包被丢弃。有了适当的应急措施，如果使用 UDP（假设是为了性能）并且数据包丢失，一个软件不应该崩溃。但是，如果您对此感到担心，为什么不使用 TCP 呢？

# crossrider - Crossrider：外部数据库？

> ID：14087395
> 
> 赞同：1
> 
> 时间：2012-12-30T01:02:20.050
> 
> 标签：crossrider

是否可以从 Crossrider 访问 Sql Server 实例？它有本地数据库的文档，我假设它用于在浏览器的机器上存储数据。我有由插件用户不断更新/读取的中央数据，并且需要一种访问外部数据库的方法（最好是 Sql Server，但我很灵活）。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T09:46:36.543

Crossrider 不提供与 SQL 服务器（或任何其他外部数据库）交互的本机方式，您对我们的[本地数据库](http://docs.crossrider.com/staging/#!/api/appAPI.db)支持是正确的。

但是，如果您有用于访问数据库的 HTTP URL，则可以使用[appAPI.request.get](http://docs.crossrider.com/#!/api/appAPI.request-method-get)和[appAPI.request.post](http://docs.crossrider.com/#!/api/appAPI.request-method-post)方法与数据库进行交互。

# java - GAE 通道接口

> ID：14087396
> 
> 赞同：0
> 
> 时间：2012-12-30T01:02:37.213
> 
> 标签：java, javascript, google-app-engine, sockets, channel

我正在使用频道 api（java 后端 - javascript 前端）构建一个聊天应用程序。每次用户获得用户名时，它都会在剩余用户屏幕中列出。新用户从频道发送给每个用户，并将被显示。但如果他们关闭窗口，我想从列表中删除用户。我真的想知道如何识别用户是否使用频道 api 关闭了他的窗口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T01:13:09.340

需要直接执行此操作的不是通道 API；在 JavaScript 中，您可以使用它`onunload`来确定用户何时离开页面，然后像往常一样触发通道 API。但是，不能保证它会被调用（想想如果我硬关闭我的机器会发生什么）。您可以使用 JavaScript 提供心跳并在服务器上实现逻辑来表示“如果我在 X 秒/分钟/任何时间内没有收到来自客户端的任何消息，则认为该用户的会话已关闭。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:43:30.867

我在 python 上做同样的事情。您需要做的就是启用[存在](https://developers.google.com/appengine/docs/java/channel/overview#Tracking_Client_Connections_and_Disconnections "在场")入站服务，然后每当客户端断开连接时，您将在 /_ah/channel/disconnected/ 上接收请求。从请求参数中，您可以确定客户是谁，并发送将他从应用程序的用户列表中删除（如果存在）和（如果有必要）向剩余的客户端发送一条频道消息，以将他从他们看到的列表中删除

# javascript - 避免 Redis 持久化（Socket.io + Cluster + RedisStore）

> ID：14087399
> 
> 赞同：0
> 
> 时间：2012-12-30T01:02:58.550
> 
> 标签：javascript, node.js, redis, socket.io

我知道您可以使用[Redis 在 node.js 中来自不同集群工作人员的 socket.io 套接字之间进行通信](https://stackoverflow.com/questions/4647348/send-message-to-specific-client-with-socket-io-and-node-js)，也可以在这些工作人员之间共享其他对象。

但我正在努力解决以下问题：

Redis 数据的持久性会阻碍这一点吗？当主进程关闭时，如何确保从 redis 中删除套接字数据？以及如何确保对象相同？我只需要这些数据，直到进程/套接字终止。

也许我必须删除保存到磁盘的间隔并在主启动时重新加载整个 Redis 服务器？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T23:24:41.963

您可以使用`FLUSHDB`删除当前数据库中的`FLUSHALL`所有数据或删除所有数据库中的所有数据。

# actionscript-3 - 在动作脚本 3 中保存和加载进度

> ID：14087401
> 
> 赞同：1
> 
> 时间：2012-12-30T01:03:48.363
> 
> 标签：actionscript-3, flash

我到处寻找这个答案..但我不太确定如何做到这一点......

我正在使用 Flash AS3 制作 Flash 游戏...

我需要用户可以保存和加载他们的进度的选项..

有人可以逐步说明如何做到这一点吗？我对动作脚本很陌生...

通常其他 tuts 会告诉你如何保存某些变量

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-07T21:44:13.610

**饼干！**

幸运的是，这很简单。不幸的是，我们不清楚它是如何完成的：

```
// have that referenced all the time:
var cookies: SharedObject = SharedObject.getLocal("myGameData");

// start saving
cookies.data.progress = 50;
cookies.data.lives = 5;
cookies.data.anyRandomVariable = "my name or something";
cookies.flush();
// now it's saved

// start loading
var progress: Number = cookies.data.progress;
var lives: int = cookies.data.lives = 5;
var anyRandomBlah: String = cookies.data.anyRandomVariable;
// now it's loaded 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T05:06:51.230

（根据上面的评论......）

是的，几乎沿着这些路线。我一直在问问题，试图让您看到您确实有要保存的变量/数据。=b

如果你想在关卡中间保存，这取决于你......我不知道你是如何设计你的游戏的，但基本上你可以根据任何条件编写保存代码以随时触发你要。

为了在级别的中间保存，因为您正在处理保存和加载，您可以尝试使用级别“7.5”之类的值或任何您想要表示已完成的级别的符号。或者只使用像 750 这样的整数并将其视为百分比（完成 50% 时的级别 7）。等等。由你决定。

一个非常相似的问题被问到如何使用 SharedObject 保存当前帧值。在您的情况下，将“当前帧”替换为您要保存的任何值：

[Actionscript 3 将当前帧位置保存到本地硬盘驱动器？](https://stackoverflow.com/questions/13413027/actionscript-3-saving-currentframe-location-to-local-hard-drive)

# c# - 我可以使用 xcode 在 c# 中编程吗？

> ID：14087402
> 
> 赞同：5
> 
> 时间：2012-12-30T01:04:00.330
> 
> 标签：c#, macos, user-interface, mono

我几乎完全用 c# 开发，但拥有一台 mac 电脑。我有在并行桌面上运行的 Windows 以使用 Visual Studio。我想用 c# 为 mac os 开发并下载了 monodevelop，这很棒，除了它的 GUI 设计器我完全讨厌它，甚至不知道人们如何使用它。我的意思是，在使用 Visual Studio 设计器创建 GUI 应用程序是多么容易之后，我觉得使用它很奇怪。

我对此进行了调查，发现苹果的界面生成器可以为我解决这个问题。但是，现在获取它的唯一方法显然是下载 xcode，因为苹果现在不将它作为独立应用程序分发。（那就是我所想的）

我知道 Xcode 不支持 c#，但我读到了一些可以添加这些功能的插件。

你能告诉我是否可以将这种兼容性添加到 xcode 中？或者，如果您知道具有更类似于 VS 的 GUI 设计器的 monodevelop 替代方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T01:14:20.837

从 2.8 版开始，MonoDevelop 支持将 XCode 与 MonoTouch（适用于 iOS）和 MonoMac 一起使用。[这是](http://monodevelop.com/Download/What%27s_new_in_MonoDevelop_2.8)发布文档的链接。

是的，您必须下载 XCode，如果我没记错的话，它可能会收取象征性的费用，但最低成本（如果有的话）将值得提高生产力。

话虽如此，对于来自 VS 世界的人来说，使用 XCode 的界面构建器需要很多时间来适应。

# php - 将 JS 函数转换为 PHP

> ID：14087403
> 
> 赞同：1
> 
> 时间：2012-12-30T01:04:02.497
> 
> 标签：php, javascript

我正在尝试将 JS 函数“翻译”为 PHP 等效函数。对于以下 JS 函数：

```
function dF(s,n)
{
n=parseInt(n);
var s1=unescape(s.substr(0,n)+s.substr(n+1,s.length-n-1));
var t='';
for(i=0;i<s1.length;i++)
{
t+=String.fromCharCode(s1.charCodeAt(i)-s.substr(n,1));
}
return(unescape(t));
} 
```

我在 PHP 中做到了这一点：

```
function dF( $s, $n ) {
    $n1 = intval( $n );
    $s1 = urldecode( substr( $s, 0, $n1 ) . substr( $s, $n1+1, strlen( $s)-$n1-1 ));
    $t = '';
    for( $i = 0; $i < strlen($s1); $i++ ) {
        $t .= unichr(substr($s1, $i) - substr($s, $n1, 1));
    }
    return urldecode($t);
}

/**
 * Return unicode char by its code
 *
 * @param int $u
 * @return char
 */
function unichr($u) {
    return mb_convert_encoding('&#' . intval($u) . ';', 'UTF-8', 'HTML-ENTITIES');
} 
```

我认为它在某个地方失败了`urldecode()`。我究竟做错了什么？

- - 更多信息 - -

JS 函数的结果，例如`dF('8%3Fn%3FAAl%3A%3Ej%3D%3C%3B%3A%3DA%3Ail%40llk%3Aj%3B8%38El%3B%40m','55');`将是`07f799d26b5432592ad8ddc2b306d38e`

但我没有得到这个结果。从第一个答案修复后， `echo dF('8%3Fn%3FAAl%3A%3Ej%3D%3C%3B%3A%3DA%3Ail%40llk%3Aj%3B8%38El%3B%40m', '55')`是空的，空白的，没有打印。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T01:07:58.267

在我看来这是罪魁祸首：

```
$t .= unichr(ord( $s1[$i] ) - substr($s, $n1, 1));
                       // ^ This 
```

如果您执行 substr($str, 3) 它会在第三个字母之后得到所有内容，而不仅仅是第三个字母。我假设这就是您的 JS 中的 charCodeAt(...) 所做的，只使用一个字母？

要只收到一封信，请执行以下操作：

```
echo $str[$i]; // echos the first character of $str if $i was 0 
```

# breeze - ODataActionFilter 被调用两次

> ID：14087404
> 
> 赞同：1
> 
> 时间：2012-12-30T01:04:09.390
> 
> 标签：breeze

这是我第一次尝试使用微风.js，所以我可能有一些设置不正确，但不确定它是什么。

执行简单查询时遇到错误。我首先在 VS2012 项目中使用 EF 5.0 DB。

发生了错误。值不能为空。参数名称：System.Linq.Queryable.Where[TSource](IQueryable `1 source, Expression`1 predicate) at Breeze.WebApi.ODataActionFilter.OnActionExecuted(HttpActionExecutedContext actionExecutedContext) at System.Web.Http.Filters .ActionFilterAttribute.CallOnActionExecuted(HttpActionContext actionContext, HttpResponseMessage response, Exception exception) at System.Web.Http.Filters.ActionFilterAttribute.<>c_ *DisplayClass2.b* _0(HttpResponseMessage response) at System.Threading.Tasks.TaskHelpersExtensions.<>c__DisplayClass41`2.<Then>b__40(Task`1 t) 在 System.Threading.Tasks.TaskHelpersExtensions.ThenImpl[TTask,TOuterResult](TTask 任务，Func`2 继续，CancellationToken cancelToken，布尔值 runSynchronously)

为了确定我做错了什么，我下载了微风服务器源代码并将该项目包含在解决方案中，以便我可以跟踪错误。错误发生在 ODataActionFilter.cs 中的 OnActionExecuted 事件中。奇怪的是，对于同一个查询，该函数被调用了两次。该函数首先使用 responseObject 中的查询调用。第二次调用事件时，查询的结果在 responseObject 中。这不再是导致错误的 iQueryable 对象。我无法确定为什么该函数已经有正确的结果而被第二次调用。

有没有人见过这个并且可以告诉我修复它的方向？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T21:29:56.197

我在回答我自己的问题。

解决方案是我的 api 控制器没有应用新的 BreezeController 属性。这不在任何文档中。但是，我确实在样本中找到了它。

即来自文档：[http ://www.breezejs.com/documentation/web-api-controller](http://www.breezejs.com/documentation/web-api-controller)

```
[JsonFormatter, ODataActionFilter]
public class TodosController : ApiController { 
```

但是，当前的样本有这个：

```
[BreezeController]
public class TodosController : ApiController { 
```

这纠正了问题，但很难找到。我也不清楚是否应该将新的 BreezeController 属性添加到原始的两个属性中，或者是否完全替换它们。

# c# - 在 C# 4.0 Winform 中为程序（如 MS Word）只打开一次文件

> ID：14087406
> 
> 赞同：2
> 
> 时间：2012-12-30T01:04:51.237
> 
> 标签：c#, winforms, file

我正在开发一个桌面应用程序（C# 4.0 Winforms），其中一个要求是程序可以多次打开。但是，我不希望用户能够多次打开给定文档（可能会发生坏事）。

基本上我希望它的功能类似于 MS Word（至少是较新版本），如果您尝试打开一个已经打开的文档，它会将您带到已经打开该文档的程序实例。

我大部分时间都在做 Web 开发，所以可能有一些我不知道的简单解决方案。

所以我真的有两种不同的需求。

1) 防止文件被打开超过一次 2) 如果他们试图再次打开它，将实例带到前台。

我可以想到几种方法来处理＃1，但我很好奇其他人是如何解决这个问题的。

实际上，我真的不知道从哪里开始尝试让#2 工作，而无需制作一些保持打开状态并创建子程序的主表单/流程。IE 创建了另一个窗体，它实际控制当前程序主窗体的打开和关闭，因此它更像是一种“选项卡式”体验，而不是实际的多窗口体验。更像是老式的 MDI（仍然会留下问题 #1）。

此处的任何帮助（要阅读的站点、要查看的名称空间等）将不胜感激。

**编辑 -**我看到这已被标记为重复，并且“重复”位于页面顶部。我的要求之一是程序必须能够多次打开。你们还看帖子吗？其他人可以进来投票重新讨论这个问题吗？

**进一步编辑 -**我采用了 Mutex 的想法，以防止程序多次打开同一个文档。我从来没有找到一种简单的方法来确定程序的哪个实例打开了文档并将其放在前面，所以我现在放弃了，只是弹出一个消息框告诉他们它已经打开了。命名管道似乎有点矫枉过正，因为它不完全是我想要做的，并且会涉及很多开销（而且 WCF 不是世界上最简单的事情），所以任何进一步的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:17:58.827

您在询问互斥锁。在 Windows 中，您可以创建一个 MUTEX（互斥标志），因此即使进程的第二个实例打开，它也会尝试创建互斥体然后失败。互斥锁是用于此目的的操作系统范围的全局变量（有点），用于 IPC/协调。

另一种方法是这样 - 创建一个具有嵌入文档名称的类名称（在 windows API 中的类而不是在 C# 或 C++ 中的类），并使用 FindWindow() 函数首先查看这样的窗口是否已经打开。然后您可以 SendMessage(HWND) 向该窗口发送一条消息以将其置于最前面，因此如果用户在资源管理器“myfile.doc”中单击并且它已经打开 - 您只需将其置于最前面。要查看的 API（从我的大脑 ram 中，我如何记住这些东西？）：

```
 CreateMutex() / OpenMutex()
 FindWindow() / CreateWindow()
 SendMessage() / PostMessage()
 ShowWindow()/ SetWindowPosition()/BringWinToTop() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T01:23:10.200

我怀疑有很多方法可以解决这个问题，但这是我的处理方法：

只有一个应用程序实例，并在应用程序的新窗口中打开每个请求的文档。

这将需要一些协调，因为随后打开的文档将导致创建一个新实例，但您可以设置应用程序的第一个实例创建并检查后续实例的进程间通信机制（例如命名管道）。

如果他们发现 IPC 存在，他们将请求的文件名传递给第一个应用程序实例（打开指定的文件），然后终止。

这是微软关于命名管道使用的一篇好文章：[如何：使用命名管道进行网络进程间通信](http://msdn.microsoft.com/en-us/library/bb546085.aspx)

# java - 在 android 中以编程方式更新联系人姓名会导致模拟器中出现非法参数异常

> ID：14087407
> 
> 赞同：2
> 
> 时间：2012-12-30T01:05:05.573
> 
> 标签：java, android, contacts, illegalargumentexception

在开始之前，我知道我正在使用代码中已弃用的 API 调用来管理联系人，这是因为我正在尝试扩展现有库而无需对其进行太多更改。我不介意改变它，但是那里的东西太多了，我只是在试验一个想法，不想再写一个完整的框架。

所以现在谈到这个问题，我正在尝试更新联系人，但到目前为止我还没有得到任何结果。我可以创建和删除联系人。他们都在模拟器中工作。当我尝试更新时，我实际上收到了一个非法参数异常：空值消息。相关代码如下。

```
Uri uri = Uri.parse(fullUri);
ContentValues updateValues = new ContentValues();
// updateValues.put(Contacts.People.DISPLAY_NAME, value);
updateValues.put(Contacts.People.NAME, value);
contentResolver.update(uri, updateValues, null, null); 
```

下面是我的堆栈跟踪

```
12-30 00:45:05.819: RpcServer:101(2592): java.lang.IllegalArgumentException: Empty values
12-30 00:45:05.819: RpcServer:101(2592):    at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:170)
12-30 00:45:05.819: RpcServer:101(2592):    at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:140)
12-30 00:45:05.819: RpcServer:101(2592):    at android.content.ContentProviderProxy.update(ContentProviderNative.java:507)
12-30 00:45:05.819: RpcServer:101(2592):    at android.content.ContentResolver.update(ContentResolver.java:990)
12-30 00:45:05.819: RpcServer:101(2592):    at com.fun.rpc.SimpleServer$ConnectionThread.run(SimpleServer.java:91) 
```

有没有人见过这个问题？我尝试将 ID 作为 where 子句的一部分发送，但这也不起作用。此外，如果我尝试更新电子邮件地址，代码不会引发任何错误，但联系人的电子邮件地址不会得到更新。但是当我尝试更新名称时，我得到了上述错误。请问有什么提示或想法吗？如果您需要更多信息，请告诉我。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-09-11T09:45:19.583

我参加聚会迟到了，但我的回答如下。

我遇到了同样的错误。

```
java.lang.IllegalArgumentException: Empty values
at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:165)
at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:135)
at android.content.ContentProviderProxy.update(ContentProviderNative.java:572)
at android.content.ContentResolver.update(ContentResolver.java:1672)
... 
```

当我尝试更改`MediaStore.Images.Media.BUCKET_ID`字段时遇到了同样的错误。虽然该领域`MediaStore.Images.Media.DESCRIPTION`被改变没有问题。

正如您可能猜到的那样，该`BUCKET_ID`字段用作多个表的关键字段。如果你知道数据库开发的理论。因此，不允许更改此类**关键字段。**

在您的情况下，这样的（受保护的）字段是`Contacts.People.NAME`.

**更新**。从源代码：

*图像的桶 id。这是从 DATA 列自动计算的只读属性。*

# visual-studio-2010 - 安装 libqxt VS2010

> ID：14087408
> 
> 赞同：1
> 
> 时间：2012-12-30T01:05:40.020
> 
> 标签：visual-studio-2010, qt4.7, installation, libqxt

抱歉，如果我对这类东西有点菜鸟，但无论如何谢谢。
基本上我已经设法正确安装了 QT4.7，它可以工作并编译东西。（我将它与 vs2010 结合使用）。但是，我想尝试一些需要 libqxt 的东西。不幸的是，[这](http://dev.libqxt.org/libqxt/wiki/user_guide)似乎是唯一的安装指南。我真的*不*明白。它提到了这一点：

“配置

确保 qmake 在您的 PATH 中并运行“

我想这就是我被绊倒的地方。这与我用于 QT4.7 的 qmake 相同吗？（如果是这种情况，我不应该更改任何内容？它应该看起来像这样：“c:\Qt\4.7\bin”。通过转到 > 控制面板|系统|高级|环境变量添加菜单。安装 qt4.7 时已经存在）

或者在某个地方是否有用于 libqxt 的新 qmake？我是否错误地理解了 PATH 一词？

在任何情况下，现在单击 configure.bat 只会回显“正在搜索”，然后在我阅读其他内容之前关闭。我最好只打开一个 cmd 提示符并 cd'ing 到 libqxt 目录并从那里运行配置文件吗？

如果有人知道某个地方可能对我也有帮助的备用安装 libqxt 教程。感谢任何可以花一分钟时间为我指明正确方向的人。

# html - 有没有任何工具可以将 html 转换为 twig？

> ID：14087411
> 
> 赞同：0
> 
> 时间：2012-12-30T01:06:38.197
> 
> 标签：html, symfony, twig

我正在学习 Symfony2，并且正在做一些小测试。

好吧，我制作了一个小 html 来测试树枝模板。

```
<html>
    <head>
        <title>test00</title>
        <link rel="stylesheet" href="test.css" />
</head>
<body>
    <div id="test">
        <img src="test.png" /><br />
        <a href="test.php">test</a>
    </div>
</body> 
```

并且文件在html的同一目录中。

然后将所有文件（html、css 和图像）复制到我的测试中：/var/www/Symfony/src/Test/TestBundle/Resources/views/Default 并将 html 重命名为 html.twig。

但是当使用这个 html 作为 twig 模板时会失败，因为 Symphony 尝试使用“http://localhost/Symfony/web/test.png”作为链接图像。

是的，我已阅读文档并知道“资产”，我可以使用一些示例 test.png')" /> 更改文件的路径，并将所有文件复制到 budle 中的 web 目录。

但我想知道“是否有任何工具可以将 html 转换为 twig？” 因为例如我不能对我的老板说：

“Symfony2 很棒。但是你的设计师必须学习 Twig，当她用 Dreamweaver 完成 html 时，她必须更改所有指向 CSS 和图像的链接以制作模板……是的，她什么都看不到，只能发送给我放入网络服务器以检查它是否正确。”

你希望我的老板对 Symfony2 有什么看法？他会认为这很疯狂，这是两次工作。

我认为最好的是它是一个自动工具，可以将带有相对路径的 html 翻译成 twig 之类的东西，将包文件放入 web 目录中。并且设计者不需要知道任何东西，只需要制作漂亮的 html，几乎没有奇怪的东西，比如放 {{page_name}} 而不是“页面名称”。

问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T04:08:39.993

从 html 编码人员的角度来看，Twig 是 HTML。只要在您的服务器上设置模板语言支持，编写 twig 或 HTML 就没有区别。唯一的区别是`<h1>{{variables}}<\h1>.`您的 HTML 编码人员应该知道他们可以访问哪些变量。话虽如此，从开发人员的角度来看，twig 要多得多，所以我并没有简化 twig。但是如果有人知道 HTML，他们就会知道如何处理 twig。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T12:20:33.747

```
Then copy all files (html, css and the images) to my test: 
/var/www/Symfony/src/Test/TestBundle/Resources/views/Default And rename the html to html.twig. 
```

Nope. Your html.twig files need to end up somewhere under views so the template processor can get to them. However, your css and images need to be copied to your root web directory. Same place where app.php lives.

```
But fail when use this html as twig template, because the Symphony try to use
"http://localhost/Symfony/web/test.png" as link the image. 
```

It's is not symfony generating this link but your web browser. Use Control-U to examine the generated html source from within your browser. You will find that your links such as href="test.css" have not been changed. Twig will not change anything unless it has has some curly brackets around it.

So your designer can continue to use her current workflow and deliver a set of files. You just need to deploy the files to the correct locations.

Of course symfony/twig can do a lot more that simple variable replacements so eventually you might want to change things. But you can get started just fine.

# python - 检查 Bottle 中每个请求的身份验证

> ID：14087418
> 
> 赞同：1
> 
> 时间：2012-12-30T01:08:19.133
> 
> 标签：python, authorization, bottle

对于 Bottle 中的每个请求，我想通过 HTTP 身份验证检查该请求是否符合条件。`@route`我的想法是使用一个函数，它在每个函数的开头被调用。

```
def check_authentificaiton(requests):
    auth = request.headers.get('Authorization')
    credentials = parse_auth(auth)
    if credentials[0] is not 'user' or credentials[1] is not 'password':
        raise Exception('Request is not authorized') 
```

这似乎有点多余，因为我想保护每个请求，如果我忘记调用它可能会失败。有没有更好的办法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T01:42:40.937

我认为您正在寻找一个装饰器，它要求只有在用户登录时才能访问路由。就像下面的例子一样，`@require_uid`是一个装饰器，你可以在需要用户登录的任何功能周围使用它。Flask 有一个[login_required 装饰器](http://flask.pocoo.org/docs/patterns/viewdecorators/)。

[使用装饰器要求使用 bottle.py 登录](http://tumblr.kurttheviking.com/post/13053496552/using-decorators-to-require-sign-in-with-bottle-py)

```
def require_uid(fn):
    def check_uid(**kwargs):   
        cookie_uid = request.get_cookie('cookieName', secret='cookieSignature')

        if cookie_uid:
            # do stuff with a user object
            return fn(**kwargs)
        else:
            redirect("/loginagain")

    return check_uid

@route('/userstuff', method='GET')
@require_uid
@view('app')
def app_userstuff():
    # doing things is what i like to do
    return dict(foo="bar") 
```

# php - 仅为特定 Joomla 用户组加载 css 样式

> ID：14087419
> 
> 赞同：2
> 
> 时间：2012-12-30T01:08:37.137
> 
> 标签：php, joomla

我想执行一个 css 样式，但只针对特定的 Joomla 用户组。我的目标是将 php 代码直接包含在我的 Joomla 模板中。

我试图找到如何做（我不是编码员）并且我做了一些测试但没有成功。例如，我在论坛中找到了这段代码：

```
<?php
$user =& JFactory::getUser();
if (!$user->author) {
?>
<style>#myclass{display:none; width:0px;}</style>
<?php
}
?> 
```

但这不起作用，因为我想通过用户组 ID 执行样式，还因为这段代码似乎适用于 Joomla 1.5 而我在 Joomla 2.5 下。

请问有什么线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T04:49:26.107

```
$user =& JFactory::getUser();
$groupIDs = array();
foreach( $user->groups as $groupID ){
  $groupIDs[] = $groupID;
}

var_dump( $groupIDs ); 
```

如果您`$groupIDs`的数组包含您需要的 id，则像您现在所做的那样回显样式。记住`$groupIDs`是一个数组，因此您将遍历数组以找到所需的 id。使用 a`foreach`来完成它。

如果您有任何问题，请告诉我。

***根据要求更新了答案。***

```
$user =& JFactory::getUser();
$groupIDs = array();
foreach( $user->groups as $groupID ){
  $groupIDs[] = $groupID;
}
foreach($groupIDs as $groupID)
{
 if($groupID == 2)
 {
 echo '<style>#myclass{display:none; width:0px;}</style>';
 }
} 
```

# c# - InvalidOperationException 未处理 - 为什么？

> ID：14087427
> 
> 赞同：-1
> 
> 时间：2012-12-30T01:11:05.750
> 
> 标签：c#, arraylist, foreach, unhandled-exception, invalidoperationexception

首先，在我的代码开头我声明了一个 ArrayList `public ArrayList ArrivalsInApp = new ArrayList();`。然后，很久以后，我从 XML 文件下载一些数据。对于每个名为“flight”的 XmlNode，我正在创建一个面板。

在创建面板时，我将其名称添加到`ArrivalsInApp`ArrayList 中。面板的生成是一种方法。该方法有几个 foreach 循环和 IF 条件。从技术上讲，它所做的一切都是决定是否应该创建 Panel（如果它在 XML 中而不是在应用程序中）、更新（在两者中）或删除（在应用程序中但不在 XML 中）。

在该方法中，我以 XML 格式获取所有航班的名称，并保存到 ArrayList 中。现在使用 foreach，我检查应用程序中的所有航班（因此在 ArrivalsInApp ArrayList 中）是否也在 XML 中。我使用以下代码执行此操作：

```
foreach (string y in ArrivalsInApp)
{
if (XmlArrivals.Contains(y) == false)
{
*code*
}
} 
```

“决定”方法在 form1_load 上调用，每 30 秒使用一个 Timer。当计时器达到指定值时，我重新加载 XML，然后调用该方法。但是，我收到了一个 InvalidOperationException，并附有“集合已修改；枚举操作可能无法执行”的注释。在线`foreach (string y in ArrivalsInApp)`。我完全绝望，我不知道是什么原因造成的。

如果我运行 .exe 文件（如果我只是调试它，在计时器达到该值后，程序会关闭并显示此错误）会发生什么，无论是否应该更新或删除面板都会被删除，并且弹出未处理的异常错误。对不起，如果解释有点混乱。如果有人希望我发布整个源文件（可能是整个项目），请告诉我。但是，由于它现在有大约 1800 行代码，因此需要大量解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:32:06.003

> 我收到一个 InvalidOperationException 注释“集合已修改；枚举操作可能无法执行”。

错误消息中的解释是正确的。集合（在本例中为“ArrivalsInApp”）在循环期间被修改。您要么向其中添加了某些内容，要么从中删除了某些内容。

如果您想遍历一个集合并同时对其进行修改，那么您需要先获取该集合的副本，然后在修改原始集合时遍历该副本。

制作副本的最简单方法是使用 Linq 和 ToArray() 或 ToList()

在文件的顶部，如果它不存在于那里：

```
using System.Linq; 
```

然后在 foreach 语句中，您可以执行以下操作：

```
foreach(string y in ArrivalsInApp.ToArray())
{
  // code to do stuff.
} 
```

# asp.net-mvc - 不支持关键字：“数据源”。：EF 代码优先使用 ObjectContext 和 LocalDB

> ID：14087430
> 
> 赞同：2
> 
> 时间：2012-12-30T01:11:46.060
> 
> 标签：asp.net-mvc, entity-framework, code-first, localdb

当我尝试使用 ObjectContext 连接到 LocalDB 数据库时，出现“关键字不支持错误”。

这是我的连接字符串：

```
<add name="connStr" providerName="System.Data.SqlClient" connectionString="Data Source=(LocalDb)\v11.0;Initial Catalog=proj1db;Integrated Security=True" /> 
```

这是尝试创建 ObjectContext 实例的代码：

```
var connectionString = ConfigurationManager
                .ConnectionStrings["connStr"]
                .ConnectionString;
ObjectContext _context = new ObjectContext(connectionString); 
```

最后一行抛出 System.ArgumentException: Keyword not supported: 'data source'。

我正在使用 Visual Studio 2012 for Web 并以 .NET Framework 4.5 为目标。我的机器上安装了 LocalDB。

如果我使用 DbContext 代替它可以工作：

```
public class proj1dbContext: DbContext
{
    public proj1dbContext() : base("name=connStr")
    ... 
```

似乎这是一个类似的问题 [Help with EF Code first connection string](https://stackoverflow.com/questions/6916785/help-with-ef-code-first-connection-string) 但不幸的是，它没有给出为什么实例化 ObjectContext 会引发该错误的明确答案。

任何帮助都会受到重视。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T01:13:44.353

`ObjectContext`采用 EF 连接字符串（带有`Metadata`和`Provider Connection String`关键字），而不是提供程序特定的连接字符串。

您不能将 ObjectContext 与 Code-First 一起使用；ObjectContext 需要元数据 XML 文件。

# objective-c - SSL 的问题或我对它的误解

> ID：14087433
> 
> 赞同：0
> 
> 时间：2012-12-30T01:12:49.713
> 
> 标签：objective-c, ios, ssl

我从 Instantssl 获得了我的 crt，并使用 open ssl 制作了一个 .p12 java keytool 来使我成为一个 java 密钥库。

```
openssl pkcs12 -export -in AddTrustExternalCARoot.crt -in UTNAddTrustSGCCA.crt -in ComodoUTNSGCCA.crt -in EssentialSSLCA_2.crt -in www_geobomber_com.crt -inkey www.geobomber.com.key -out www.geobomber.com.p12

keytool -importkeystore -destkeystore www.thedomain.com.jks -srckeystore www.thedomain.com.p12 -srcstoretype PKCS12 -alias 1 
```

我用于 SSL 连接的 iOS 程序如下。这一切都运行，似乎很好。我的第一个问题是（ NSDictionary *settings ）设置正确吗？- 这就是我成功进行 SSL 连接所需要的一切。我的印象是我需要在 iPhone 上安装 crts。

```
 CFReadStreamRef readStream;
            CFWriteStreamRef writeStream;
            CFStreamCreatePairWithSocketToHost(NULL, (CFStringRef)@"www.thedomain.com", port, &readStream, &writeStream);

            NSInputStream *inputStream = (__bridge_transfer NSInputStream *)readStream;
            NSOutputStream *outputStream = (__bridge_transfer NSOutputStream *)writeStream;
            [inputStream open];
            [outputStream open];

            BOOL    result = [inputStream    setProperty:NSStreamSocketSecurityLevelNegotiatedSSL forKey:NSStreamSocketSecurityLevelKey];
            NSLog(@"inputStream result %i",result);
            result =[outputStream   setProperty:NSStreamSocketSecurityLevelNegotiatedSSL forKey:NSStreamSocketSecurityLevelKey];
            NSLog(@"outputStream result %i",result);
            if (YES){
                NSDictionary *settings = [[NSDictionary alloc] initWithObjectsAndKeys:
                                          [NSNumber numberWithBool:NO], kCFStreamSSLAllowsExpiredCertificates,
                                          [NSNumber numberWithBool:NO], kCFStreamSSLAllowsAnyRoot,
                                          [NSNumber numberWithBool:YES], kCFStreamSSLValidatesCertificateChain,
                                          kCFNull,kCFStreamSSLPeerName,
                                          nil];

                CFReadStreamSetProperty((CFReadStreamRef)inputStream, kCFStreamPropertySSLSettings, (CFTypeRef)settings);
                CFWriteStreamSetProperty((CFWriteStreamRef)outputStream, kCFStreamPropertySSLSettings, (CFTypeRef)settings);
            }
            //endstuff

            NSString *response  = @"hello from iphone stream";
            NSData *data = [[NSData alloc] initWithData:[response dataUsingEncoding:NSASCIIStringEncoding]];
            NSLog(@"going to try to write.");
            [outputStream write:[data bytes] maxLength:[data length]]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:21:30.463

如果您的证书由公认的 CA 签名，您无需对客户端执行任何操作。客户端应该已经信任公认的 CA。

# performance - 堆排序是否曾经在实践中使用过？

> ID：14087434
> 
> 赞同：10
> 
> 时间：2012-12-30T01:12:53.910
> 
> 标签：performance, sorting, heapsort

在实践中，快速排序优于堆排序。Mergesort 是 3 个中唯一稳定的一个（在普通的实现中）。因此，根据手头的情况（在内存中就地或外部排序等）使用快速排序或合并排序

那么，是否存在确实使用堆数据结构进行排序的情况？无论我多么“谷歌”或尝试提出应用程序，几乎总是有人选择合并/快速排序而不是堆排序。我也从未遇到过在我的职业生涯中实际使用堆排序的情况。出于好奇，在实践中（如果有的话）堆排序实际上是一个好的用例吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T01:25:01.040

我想到了一些好处（在我做更多研究后会修改这个列表：

*   ~~几乎排序的集合受益于堆排序。~~
*   注重空间的环境通常更喜欢堆排序的 O(1) 空间复杂度。想想嵌入式系统。
*   巨大的数据集受益于O(nlog n)的*保证运行时间，而不是快速排序**可能*更好的运行时间。想想医疗、空间、生命支持等。

# xcode - 使用 XCode 开发控制台客户端/服务器应用程序

> ID：14087437
> 
> 赞同：1
> 
> 时间：2012-12-30T01:13:00.600
> 
> 标签：xcode, client-server, console-application, xcode4.5

我有一个基于控制台的服务器和客户端应用程序，它们通过本地主机上的 TCP 套接字相互通信（尽管最终将在不同的机器上使用）。

我看到如果我手动启动服务器目标然后是客户端，XCode 似乎很高兴能够在单独的调试器上下文中运行它们，它们连接并工作得很好。

理想情况下，我想设置它（通过方案或预运行步骤或其他方式），以便我可以单击“运行”（或 cmd-R），这两个上下文都会弹出并愉快地运行。

到目前为止，我对将“$(BUILT_PRODUCTS_DIR)/cclient”传递给 /bin/sh 的运行后脚本（用于服务器）的实验似乎不起作用，而且无论如何这都不理想，因为它不会在调试器中运行无论如何。

有没有办法可以轻松设置？

谢谢，戴夫

编辑：添加了我可以通过几次单击实现的屏幕截图，但希望通过单击/组合键来实现...

![截屏](../Images/a7f44b50c884aaec6ea149b8830e5c86.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T02:03:37.513

您可以在断点中设置脚本和其他操作。

点击编辑器左侧创建断点，CMD+OPT+点击断点图标编辑其选项。

此外，为方便起见，您可以选择“评估后自动继续”选项。

[有关详细信息，请参阅WWDC 2012 视频](http://developer.apple.com/wwdc/)中的 Session 412 Debugging in Xcode 。本次会议恰好演示了在客户端-服务器设置中使用 Xcode 进行调试的技巧。

# python - 在 Python 中保护 HTTP 请求

> ID：14087444
> 
> 赞同：1
> 
> 时间：2012-12-30T01:14:49.713
> 
> 标签：python, encryption, https, bottle

[Bottle](http://bottlepy.org/docs/stable/)仅提供基本身份验证，这似乎还可以，因为摘要身份验证不是非加超。但究竟是什么？我曾想过：

*   在发出请求之前使用 BCrypt 加密用户名和密码

但这是否有意义，还是我应该放弃这个想法，只使用 HTTPS (SSL) 建立一个安全的 HTTP 连接并完成它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T01:27:51.700

# 何苦？

在客户端散列密码提供了一点额外的好处，即密码本身不会以明文形式发送（因此不会泄露），

但是，它并不能阻止窃听者伪装成他获得密码的用户。

# **您应该只使用 HTTPS。**

这是最可靠（也是最简单！）的解决方案。

此外，您还将获得 HTTPS 的额外好处：

*   不会窃听您的任何通信（不仅仅是登录！）
*   不可篡改
*   服务器身份验证它的视觉“绿色锁”对应物（您的用户可能会喜欢）。

* * *

*作为安全和加密的一般经验法则，您应该始终遵守标准。*

# python - Pygame：将所有白色像素转换为png图像中的完全透明

> ID：14087450
> 
> 赞同：5
> 
> 时间：2012-12-30T01:15:42.623
> 
> 标签：python, image, image-processing, pygame, alpha

我一直在尝试创建一个图像处理程序来获取加载图像中的所有白色像素（255,255,255）并将它们的 alpha 通道设置为 0（不透明），然后保存图像。

我一直在使用 Python 的 pygame 扩展来帮助我实现这一目标，但到目前为止，我还没有找到一种简单的方法来完成我刚才描述的操作。

请记住，我不是在尝试显示图像，而是在尝试操纵它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T03:41:50.643

我还建议使用 PIL 或[ImageMagick](http://imagemagick.org/script/index.php "ImageMagick")，但这是在 pygame 中执行此操作的一种方法：

```
import pygame

def convert():    
    pygame.init()
    pygame.display.set_mode()
    image = pygame.image.load("triangle.png").convert_alpha()
    for x in range(image.get_width()):
        for y in range(image.get_height()):
            if image.get_at((x, y)) == (255, 255, 255, 255):
                image.set_at((x, y), (255, 255, 255, 0))
    pygame.image.save(image, "converted.png")

if __name__ == "__main__":
    convert() 
```

以上适用于白色背景。下面是*triangle.png*和*convert.png*使用洋红色而不是白色的外观，因此您可以看到区别：

![洋红色 bg](../Images/a389e9443662232d0052d5f73428d033.png) ![透明背景](../Images/de5c4ea48c89166ba3491225fce439d4.png)

使用 ImageMagick 实用程序，就像在命令行上运行它一样简单：

```
convert original.png -transparent white converted.png 
```

# django - django POST [合法性]

> ID：14087452
> 
> 赞同：2
> 
> 时间：2012-12-30T01:16:12.843
> 
> 标签：django

假设我有一个 Web 应用程序，它在每个会话上显示 2 个随机按钮，我希望用户单击一个按钮或另一个。如果单击按钮，我想增加该按钮的分数。但是，用户无法控制每次显示哪两个按钮，并且有数千个可能的按钮。

如果我创建一个视图来增加按钮，我将如何确定用户不会只是通过浏览器手动转到该视图。

我的想法是您需要创建一个表单并让用户发布到某个地址，但是您怎么知道用户不只是通过 AJAX 发送发布请求来增加按钮，并且用户实际上是从那里收到该按钮的带有 2 个按钮的随机会话。

我将如何在 Django 中处理这个问题是否有详细说明 Django 如何具体支持这个的文档？

编辑：或者您是否必须为每个选择会话的按钮创建一个唯一的会话 ID，并根据唯一的会话 ID 检查每个按钮的单击。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T02:12:07.007

创建一个会话变量来跟踪他们看到的按钮，例如：

```
def button_display_view(request):
    # ...lots of cool logic
    session['buttons_shown'] = [button_1_primary_key, button_2_primary_key]
    return response 
```

然后，在您的按钮单击视图中，确保单击的按钮位于显示它们的按钮列表中。用户对您的会话变量的了解为零，也无法对其进行编辑，就像他/她在您使用会话变量跟踪身份验证等时不能一样。

如果您正在构建一个多变量测试系统（甚至是 AB 测试系统），可能值得查看[这个 MVT 应用程序](https://github.com/ubiquitousthey/django-mvtester)以获取想法。

# ruby-on-rails-3 - 带有两个单词控制器名称的rails路由上的ruby问题

> ID：14087458
> 
> 赞同：2
> 
> 时间：2012-12-30T01:17:34.043
> 
> 标签：ruby-on-rails-3, controller, routes, action

我想创建一个名为 Database Importer 的控制器。

这是我跑的：

```
rails generate controller database_importer index 
```

这产生了：

```
class DatabaseImporterController < ApplicationController
  def index
  end

  def import
    # to do.
    # Receive the uploaded CSV file and import to the database.
    CSV.foreach("parse.csv") do |row|

    end
  end
end 
```

当我访问时，`http://0.0.0.0:3000/database_importer/index`我得到：

```
Routing Error

No route matches {:action=>"import", :controller=>"database_importer"}
Try running rake routes for more information on available routes. 
```

这是我的相关路线：

```
get 'database_importer/index' 
```

为什么路由引擎试图将我推向导入操作方法？

当我尝试更改路由以反映实际的控制器名称（它没有下划线）时，我得到：

```
get 'databaseimporter/index'

Routing Error

uninitialized constant DatabaseimporterController
Try running rake routes for more information on available routes. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:20:03.833

您是否还定义了如下路线：

```
post 'database_importer/import' 
```

我认为当 Rails 尝试为表单生成路由时，表单操作是失败的。

# javascript - 给定页面标题列表，自动在 MediaWiki 页面中添加 wikilinks

> ID：14087461
> 
> 赞同：5
> 
> 时间：2012-12-30T01:18:19.683
> 
> 标签：javascript, regex, mediawiki

现在，我正在尝试创建一个脚本，该脚本会自动创建指向 wiki 文档中其他页面的链接。

```
function createLinks(startingSymbol, endingSymbol, text, links){
    //this needs to be implemented somehow - replace every match of the list of links with a link
}
createLinks("[[", "]]", "This is the text to wikify", ["wikify", "text"]);
//this function would return "This is the [[text]] to [[wikify]]" as its output. 
```

最明显的解决方案是简单地将字符串的每个匹配项替换为`text`，`[[text]]`但随后我会遇到一些问题 - 例如，如果我尝试对字符串进行 wikify`"some problems"`并`"problems"`在字符串中“一些问题”，我最终会得到字符串`"[[some [[problems]]]]"`。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:16:22.130

我创建了一个脚本的工作演示，它几乎完全符合我的需要。

[http://jsfiddle.net/8JcZC/2/](http://jsfiddle.net/8JcZC/2/)

```
alert(wikifyText("[[", "]]", "There are cars, be careful, carefully, and with great care!!", ["text", "hoogahjush", "wikify", "car", "careful", "carefully", "great care"]));

function wikifyText(startString, endString, text, list){
    //sort list into ascending order
    list.sort(function(a, b){
        return a.length - b.length; // ASC -> a - b; DESC -> b - a
    });
    //replace every element in the array with the wikified text
    for(var i = 0; i < list.length; i++){
        text = text.replace(list[i], startString + list[i] + endString);
    }
    return text;
} 
```

提醒一句：在某些情况下，此脚本可能会将属于其他单词的单词 wikify。例如，如果该单词`"careful"`不在列表中，而该单词`car`在列表中，则该单词`"car"`将在单词 中被维基化`"careful"`，如下所示：`"[[car]]eful"`. 我希望我能够解决这个限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T02:38:57.770

这是另一种基于动态构建正则表达式的方法：

```
function wikifyText (startString, endString, text, list) {
    list = list.map( function (str) {
        return str.replace( /([^a-z0-9_])/g, '\\$1' );
    });
    list.sort();
    list.reverse();
    var re = new RegExp( '\\b(' + list.join('|') + ')\\b', 'g' );
    return text.replace( re, startString + '$1' + endString );
} 
```

( [JSFiddle](http://jsfiddle.net/hHfQU/) )

`\b`正则表达式两端的锚点可防止此版本尝试对任何部分单词进行维基化，但如果您愿意，可以放宽此限制。例如，将正则表达式构造替换为：

```
 var re = new RegExp( '\\b(' + list.join('|') + ')(?=(e?s)?\\b)', 'g' ); 
```

将允许在最后一个维基化单词（ [JSFiddle](http://jsfiddle.net/wh7sN/)）的末尾添加一个`s`或后缀。请注意，当显示页面时，MediaWiki 会自动将这些后缀作为链接文本的一部分。`es`

* * *

**编辑：**这是一个版本，它还允许每个短语的第一个字母不区分大小写，就像 MediaWiki 页面标题一样。它还用对`\b`Unicode 更友好的解决方案替换了锚点：

```
function wikifyText (startString, endString, text, list) {
    list = list.map( function (str) {
        var first = str.charAt(0);
        str = first.toUpperCase() + first.toLowerCase() + str.substr(1);
        str = str.replace( /(\W)/ig, '\\$1' );
        return str.replace( /^(\\?.\\?.)/, '[$1]' );
    });
    list.sort();
    list.reverse();
    var re = new RegExp( '(^|\\W)(' + list.join('|') + ')(?=(e?s)?\\W)', 'g' );
    return text.replace( re, '$1' + startString + '$2' + endString );
} 
```

( [JSFiddle](http://jsfiddle.net/UAd3b/) )

如果 JavaScript 正则表达式支持诸如不区分大小写的部分、后视或 Unicode 字符类之类的标准 PCRE 功能，这将不会那么混乱。

特别是，由于这些缺失的最后一个功能，即使这个解决方案仍然不能*完全*识别 Unicode：特别是，它允许链接在任何匹配的字符之后开始或结束`\W`，其中包括标点符号以及所有非 ASCII 字符，甚至是字母。*（但是，链接中*的非 ASCII 字母得到了正确处理。）在实践中，我不认为这应该是一个主要问题。

# c - 使用子目录中的程序集对象文件

> ID：14087463
> 
> 赞同：2
> 
> 时间：2012-12-30T01:18:28.070
> 
> 标签：c, gcc, makefile

我有一个包含几个 .c 文件和一个 .s 程序集文件 (crt0.s) 的小项目。.c 文件被编译成 .o 文件，并存储在 ./build 子目录中。这些文件可以正确编译和链接。

我希望 .s 文件也存储在 ./build 目录中。到目前为止，我的 makefile 编译了 .s 文件并将其存储在正确的位置，但是链接器找不到它。

我得到的错误是“ld.exe 找不到 crt0.o”。crt0.o 肯定是在 ./build 目录中创建的。

这是生成文件：

```
CC=arm-none-eabi-gcc
AS=arm-none-eabi-as

CFLAGS=-nostartfiles -nodefaultlibs -fno-builtin -Wall -T linker.ld -I./Include

objects=$(addprefix $(OBJDIR)/,crt0.o main.o gpiopins.o framebuffer.o drawchar.o putchar.o intconv.o strlen.o kprintf.o kputchar.o)

OBJDIR=./build

$(OBJDIR)/%.o: %.s
    $(AS) -o $@ $< 

$(OBJDIR)/%.o: %.c $(DEPS)
    $(CC) -c -o $@ $< $(CFLAGS)

kernel.img: $(objects)
    $(CC) -o kernel.img $(objects) $(CFLAGS)

.PHONY : clean
clean:
    rm -f kernel.img
    rm -f *.o
    rm -f $(OBJDIR)/*.o 
```

我可能会出错的任何想法？

谢谢

* * *

编辑：如果我手动进行，那很好。例如：

```
kernel.img: $(objects)
    arm-none-eabi-as -o crt0.o crt0.s
    $(CC) -o kernel.img $(objects) $(CFLAGS) 
```

但是，这意味着 crt0.o 不在 ./build 目录中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T11:24:53.897

“手动”变体怎么会好？var 对象包含 ./build/crt0.o ，这是您的链接器需要的。你推入的 as 命令没有提供它，那么它有什么帮助呢？即使这样做了，也为时已晚，因为所有对象加在一起都是规则的依赖项。

做清洁并向我们展示输出，这可能有助于发现发生了什么。

# php - SQL 查询问题 - 每年客户支出的总和

> ID：14087466
> 
> 赞同：0
> 
> 时间：2012-12-30T01:19:31.973
> 
> 标签：php, mysql, sql

我正在尝试构建（无论如何在我看来）应该是一个简单的 SQL 查询，以了解每个财政年度为客户开具的发票。输出可能如下所示：

{clientName (Client A)} - {2010/2011 Value} - {2011/2012 Value} - {2012/2013 Value}

我能够实现的是如下所示的输出：

```
{clientName (Client A)} - {2010/2011 Value}
{clientName (Client A)} - {2011/2012 Value}
{clientName (Client A)} - {2012/2013 Value}
{clientName (Client B)} - {2010/2011 Value} 
```

等等……</p>

现在，我知道这是不正确的，但我正在使用的查询如下所示：

```
$query = "SELECT i.invoiceValue, fy.year, c.clientName, c.clientID FROM cms_invoices i
LEFT JOIN cms_financialYear fy ON fy.yearID = i.yearID
LEFT JOIN cms_projects p ON p.projectID = i.projectID
LEFT JOIN cms_clients c ON c.clientID = p.clientID
ORDER BY fy.year, c.clientName";
$result = mysql_query($query) or die(mysql_error());
while($row = mysql_fetch_array($result)) {
echo $row['year'] . " - ";
echo $row['clientName'] . " - $";
echo number_format($row[invoiceValue], 2, '.', ',') . "";
echo "<br>"; 
```

如果我能对此有所指导，我将不胜感激。我已经尝试了几个小时，但很遗憾，没有运气。

谢谢，@rrfive

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:30:34.103

你可以尝试这样的事情：

```
SELECT c.clientID
     , c.clientName
     , SUM(IF(fy.year=2010,i.invoiceValue,0)) AS fy_2010
     , SUM(IF(fy.year=2011,i.invoiceValue,0)) AS fy_2011
     , SUM(IF(fy.year=2012,i.invoiceValue,0)) AS fy_2012
  FROM cms_invoices i
  LEFT
  JOIN cms_financialYear fy ON fy.yearID = i.yearID
  LEFT
  JOIN cms_projects p ON p.projectID = i.projectID
  LEFT
  JOIN cms_clients c ON c.clientID = p.clientID
 GROUP BY c.clientID, c.clientName
 ORDER BY c.clientID, c.clientName 
```

“技巧”是使用一个`IF`函数（或更 ANSI 可移植的 CASE 表达式）来确定一行是否适用于给定的会计年度。如果是，则返回发票值，否则返回 0。

将这些表达式包装在 SUM 聚合函数中，并在客户端上执行 GROUP BY。

如果要防止返回 NULL 值，则可以将这些 SUM 表达式包装在`IFNULL( ... ,0)`

# c - 如何解决 OpenCV libjpeg 和 fltkjpeg 之间的库冲突？

> ID：14087475
> 
> 赞同：1
> 
> 时间：2012-12-30T01:21:08.520
> 
> 标签：c, opencv, shared-libraries, static-libraries, fltk

问题是，我必须链接一个名为 fltkjpeg.lib 的库才能读取 *.jpg 格式。但我的应用程序还需要与 OpenCV libjpeg.lib 库链接。当我链接 fltkjpeg 库时，OpenCV jpeg 库不起作用。当我链接 OpenCV jpeg 时，FLTK jpeg 不会读取 jpeg 图像。

我怎样才能消除这个冲突？

顺便问一下，如何将 OpenCV 图像数据设置为 FLTK 图像数据？目前我像这样使用 Fl_Shared_Image::get(filepath);

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T13:23:50.063

我已经以这种方式解决了，它工作得很好。

```
Oimg1 = cvLoadImage(Image1, 0);
if(Oimg1 == NULL) {return 0;}

unsigned char* imgdata1 = new unsigned char[Oimg1->width*Oimg1->height*Oimg1->nChannels];
GetImageDataFromOpenCV(Oimg1, imgdata1);
Fl_RGB_Image *rgb_img0 = new Fl_RGB_Image((const uchar *) imgdata1, Oimg1->width, Oimg1->height, Oimg1->nChannels);
FLTKimg[0] = (Fl_Shared_Image *)rgb_img0; 
```

# django - 使用 Grappelli 时覆盖模板

> ID：14087476
> 
> 赞同：3
> 
> 时间：2012-12-30T01:21:13.023
> 
> 标签：django, django-grappelli

我在 Django 中使用 Grappelli。当我按照[Django 文档中概述](https://docs.djangoproject.com/en/dev/ref/contrib/admin/)的过程覆盖特定模型的特定模板时，似乎 Django（或 Grappelli??）正在努力正确呈现模板。

我已`change_form.html`使用以下子路径将文件复制到模板目录：

```
admin/properties/Calendar 
```

where`properties`是应用程序`Calendar`的名称，并且是我要为其覆盖更改表单的模型的名称。现在出现以下

![在此处输入图像描述](../Images/7ec6d8c04b604af2af9394e7a69a0f17.png)

至少有两件事没有正确呈现：

*   面包屑栏要薄得多，面包屑与栏的左边框紧密对齐。

*   更改历史记录的链接在错误的位置（显示在左侧），样式错误（没有圆角）并且出现了两次。

我仔细检查了 Django 使用了正确的模板文件，因此尽管存在上述缺陷，但记录的机制仍然有效。当我重命名重复的模板文件或从我的应用程序中删除它时，一切看起来都很好。

在我深入研究之前，我希望有人能暗示这里出了什么问题。所有未覆盖的模板似乎都可以正常工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T02:24:51.623

从我读到的内容，我怀疑您复制了默认的管理`change_form.html`模板，而不是 grapelli 版本，在`grappelli/templates/admin/change_form.html`.

如果您想覆盖grapelli 模板，那么您应该使用它作为源！

# drupal - 您如何访问 Drupal 7 中的标题（节点模块元素）字段？

> ID：14087479
> 
> 赞同：4
> 
> 时间：2012-12-30T01:21:40.080
> 
> 标签：drupal, drupal-7

我有一个 Drupal 7 内容类型的计算字段，由我的描述（文本）字段填充：

```
$entity_field[0]['value'] = $entity->field_desciption['und'][0]['value']; 
```

它工作正常。我想创建另一个由标题（节点模块元素）字段填充的计算字段。

我尝试了以下几行，但它们不起作用。

```
$entity_field[0]['value'] = $entity->title['und'][0]['value']; 
```

```
$entity_field[0]['value'] = $node->title; 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T10:52:40.803

节点标题不是字段；因此，使用`$entity->title['und'][0]['value']`将不起作用。你应该使用的是`$entity->title`.

作为旁注，要获取字段的值，您应该使用[field_get_items()](http://api.drupal.org/api/drupal/modules!field!field.module/function/field_get_items/7)，它负责为字段设置的语言，这不一定是`LANGUAGE_NONE`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T14:31:23.610

如果它是一个节点模块元素，它应该可以通过`$entity->title`直接访问。尝试 a`print_r($entity); die;`获取实体的所有元素。希望这对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T12:09:25.187

您应该查看将数组/对象打印到页面以查看您正在使用的确切内容。

尝试将`print_r($entity);`或添加`print_r($node);`到显示实体或节点的页面，然后`exit;`

然后，您可以右键单击该页面并单击“查看页面源”以结构化格式显示输出。使用它来查看变量名称、对象/数组类型和层次结构，然后正确编写完整的变量代码。

```
print_r($node);
exit; 
```

我想它应该是 $node->title 虽然......

# html - 使用Javascript在PHP中获取数组时如何转义HTML元素？

> ID：14087482
> 
> 赞同：1
> 
> 时间：2012-12-30T01:22:24.080
> 
> 标签：html, jquery, pdo

**我认为问题出在“aif.php”文件中”**

我正在尝试使用 PHP 获取并显示一个数组，但 HTML 元素`<br>`显示在我的以下脚本的结果中。我知道我必须转义 HTML 标签，但我只是不确定如何！此外，将不胜感激有关此代码的任何其他建议（即是否有任何冗余或需要改进的地方？谢谢。

## HTML

```
<DOCTYPE! html>
<html>
    <head>
        <title>The Auditors' Report: Data Entry</title>
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body>
        <header><h1>Work Station<h1></header>
        <div = id="leftnav">
        <h2>Select Action</h2>
        Name: <input type="text" id="name">
        <input type="submit" id="grab" Value="Grab">
        </div>
        <div id="content"></div>
        <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
        <script src="aif.js"></script>
        </body>
</html> 
```

## PHP - 配置（文件名：“config.php”）

```
<?php
$dbhost = "localhost";
$dbname = "x";
$dbuser = "y";
$dbpass = "z";
$dsn = "mysql:host=$dbhost;dbname=$dbname";
$dbh = NULL
?> 
```

## PHP - 查询/结果内容（文件名：“aif.php”）

```
<?php
require "config.php";
$dbh = new PDO($dsn, $dbuser, $dbpass);
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
$sql = "SELECT * FROM table1 LIMIT 0,10";
$sth = $dbh->prepare($sql);
$sth->execute();
while ($row = $sth->fetch(PDO::FETCH_ASSOC)) {
    echo $row['field1'],"<br>";
    echo $row['field2'],"<br>";
    echo $row['field3'],"<br>";
}
?> 
```

## Javascript

```
$('input#grab').on('click', function() {
    var name = $('input#name').val();
    if ($.trim(name) !='') {
        $.post('aif.php', {name: name}, function(data) {
            $('div#content').text(data);
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T02:35:46.610

我在 Javascript 中犯了一个简单的错误。我想传回**HTML**而不是**TEXT**。

通过以下更改，PHP 可以正确呈现：

```
$('div#content').text(data); 
```

至

```
$('div#content').html(data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T01:55:36.630

如果要对这样的行进行 html 编码：

```
this is <br /> a test 
```

变成这样的一行：

```
this is &lt;br /&gt; a test 
```

使用此处描述的漂亮小功能： [HTML-encoding lost when attribute read from input field](https://stackoverflow.com/questions/1219860/javascript-jquery-html-encoding)

# javascript - 如何按比例调整画布中的图像大小？

> ID：14087483
> 
> 赞同：9
> 
> 时间：2012-12-30T01:22:45.610
> 
> 标签：javascript, html, canvas

AFAIK，要在 HTML5 画布中调整加载图像的大小，可以这样完成：

```
var img = new Image();
img.onload = function () {
  ctx.drawImage(img, 0, 0, 300, 200); // resizes image to 300px wide, 200px high
}
img.src = 'images/myimage.jpg'; 
```

但后来我意识到图像不会按比例正确。所以我尝试只使用一个参数（就像在 HTML 中一样），但我发现它也不起作用。

如何按比例调整图像大小？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-30T01:31:37.207

获取`img.width`and `img.height`，然后根据您要调整的宽度计算比例高度。

[例如](http://jsfiddle.net/robertc/LjhdU/)：

```
ctx.drawImage(img, 300, 0, 300, img.height * (300/img.width)); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-30T01:47:13.977

去年我写了一篇关于这个主题的博客文章。你可以在[这里](http://selbie.wordpress.com/2011/01/23/scale-crop-and-center-an-image-with-correct-aspect-ratio-in-html-and-javascript/)阅读。基本上，它提供了一种以适当的纵横比缩放图像的功能。它包括支持横向和纵向方向以及两者之间的大小。您甚至可以在“信箱”和“平移和扫描（缩放）”模式之间进行选择。

它是在考虑 div 定位的情况下编写的，但对于 canvas 来说很容易理解。

靠近页面底部的是“ScaleImage”功能。这可能就是你想要的。然后你可以按如下方式应用它：

```
var img = new Image();
img.onload = function () {

  var result = ScaleImage(img.width, img.height, 300, 200, true);

  ctx.drawImage(img, result.targetleft, result.targettop, result.width, result.height); // resizes image to a target size of 300x200 using letterbox mode
}
img.src = 'images/myimage.jpg'; 
```

如果您不希望图像居中，您可以将 result.targetleft 和 result.targettop 替换为“0”。

# ios - iOS iPad 模拟器横向模式下的黑色第二屏

> ID：14087485
> 
> 赞同：1
> 
> 时间：2012-12-30T01:24:01.117
> 
> 标签：ios, ios-simulator, uiwindow, device-orientation, uiscreen

我正在尝试启动并运行 iOS iPad 应用程序的外部屏幕。目前我只能用 iOS 模拟器测试这个（VGA 连接套件正在开发中）。

我的问题是，当以横向（左侧或右侧）或纵向倒置启动应用程序时，外部显示器仍然是黑色的。如果以正常人像模式开始，那么一切都很好。

您可以使用 Apple 提供的示例项目来测试整个事情。它适用于 4 种情况中的 1 种（见下文），其行为与我的项目完全相同：
[https ://developer.apple.com/library/ios/#samplecode/ExternalDisplay/Introduction/Intro.html#//apple_ref/doc/uid /DTS40010724](https://developer.apple.com/library/ios/#samplecode/ExternalDisplay/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010724)

重现问题的步骤：

1.  手动启动您的 iPad 6.0 模拟器（不是通过 Xcode，运行项目）。
2.  在菜单栏中：Hardware > TV-Out - 选择屏幕分辨率。将出现第二个窗口并充当第二个屏幕。
3.  通过 CMD+ArrowLeft/Right 将其转为横向左/右或纵向倒置。
4.  现在在您的 iPad 6.0 模拟器中运行该项目。
5.  如果应用程序已经启动（别担心，这个应用程序不是由 Apple 设计来正确旋转其界面）按下导航栏中的按钮。
    -> 第二个屏幕将保持黑色。

在纵向模式下进行相同的测试（将正常工作）：
退出模拟器，重复步骤 1,2,4,5，不要转动模拟器，让它处于正常的纵向模式。
-> 第二个屏幕将被填满。

现在我想知道为什么会这样。如果应用程序以纵向模式启动，那么只有第二个屏幕在手边并不是很好。而且用这个问题来开发和测试也不是很愉快。有趣的是，每当您以纵向模式启动应用程序时，它都可以工作，但是如果您以其他方向启动它一次，它将不再工作，直到您重新启动模拟器。也许你也可以告诉我这是否也是真实设备和连接套件/airplay的问题。

具体问题：
**- 模拟器的这种行为正常吗？
- 我是不是忘记了什么？
- 这个问题是否只是在模拟器中出现，而不是在连接到秒屏幕的设备上运行应用程序？**

感谢您的任何提示或建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-08T14:08:32.463

问题自己解决了。使用最新版本的 Xcode/iOS 模拟器，它现在可以按预期工作。代码本身没问题，只是模拟器没有像真实设备那样处理所有事情。

# java - 如何在不将所有表单字段定义为类属性的情况下将对象从 JSP 表单传递到 Struts2 中的 Action 类？

> ID：14087486
> 
> 赞同：5
> 
> 时间：2012-12-30T01:24:12.410
> 
> 标签：java, jsp, struts2, struts, ognl

为了让问题更清楚，我举了一个例子：

1.  考虑`theSubscriber`下面定义的形式`first.jsp`：

    ```
    <s:form id="theSubscriber" name="theSubscriber" method="post" action="next.action">
        <s:bean name="my.hibernate.actors.Subscriber" var="user">
            <s:hidden name="id" key="id" value="%{user.id}"  />
            <s:textfield id="subscriberForename" name="forename"
                        key="forename" value="%{user.forename}" label="Forename" />
            <s:textfield id="subscriberSurname" name="surname" 
                        key="surname" value="%{user.surname}" label="Surname" />
        </s:bean>
    </s:form> 
    ```

2.  为 next.action 考虑以下动作类

    ```
    public class NextAction extends ActionSupport {

        private Subscriber user = new Subscriber();

        private String forename;

        public String getForename() {
            return forename;
        }        
        public void setForename(String forename) {
            this.forename = forename;
        }

        public ManageSubscriber() {
            // TODO Auto-generated constructor stub
        }

        public ManageSubscriber(Subscriber user) {
            this.user = user;
        }

        public Subscriber getUser() {
            return user;
        }                
        public void setUser(Subscriber user) {
            this.user = user;
        }

        public String execute() {
            System.out.println(getUser());//This prints out null
            System.out.println(getForename());//This prints out the posted forename
            return SUCCESS;
        }
    } 
    ```

3.  问题是：我知道将所有表单字段定义为操作类属性可以让类正确填充它们。但我想让它填充另一个包含所有必要属性的类中的相关字段。用户/订阅者类是这样的：

    ```
    public class User {
        private long id;
        private String username;
        private String password;
        private UserLevel userLevel;
        private String forename;
        private String surname;
        private String email;
        private String phoneNumber;
        private String address;
        private Date birthday;
        private Date registrationDate;
    } 
    ```

我已经定义了所有访问器方法。事实上，问题是为`nextAction`类定义所有这些字段然后评估该类中的用户实例看起来非常烦人和多余。

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T03:05:24.153

这比你想象的要容易。

你已经很接近了，你已经为`value`属性做了它（用于为页面上的项目预先设置值）：现在只需为`name`属性做它（用于将值发送到Action），如下所示：

```
<s:hidden name="user.id" key="id" value="%{user.id}"  />
<s:textfield id="subscriberForename" name="user.forename"
    value="%{user.forename}" label="Forename" />
<s:textfield id="subscriberSurname" name="user.surname" 
    value="%{user.surname}" label="Surname" /> 
```

（`Key`这里不需要属性）

请注意，要使其正常工作，您将需要一个带有无参数构造函数的 bean（正如您所拥有的那样）。

避免自己初始化它。

改变这个：

```
private Subscriber user = new Subscriber(); 
```

对此

```
private Subscriber user; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T01:43:44.533

我想您是在问如何在内存中持久保存一个将在多个操作中使用的用户对象。

如果我正确理解您的问题，您有几个选择。

一种不太像 Struts 的选项是将 User 对象添加到会话变量中。[您可以按照此处](http://www.mkyong.com/struts2/how-to-get-the-httpservletrequest-in-struts-2/)所述访问会话变量。

如果您计划在会话中为一组特定的操作（或步骤，例如应用程序的“向导”部分）维护对象，我会推荐另一个选项是 ScopeInterceptor。你可以在[这里](http://struts.apache.org/2.0.6/struts2-core/apidocs/org/apache/struts2/interceptor/ScopeInterceptor.html)和[这里](https://stackoverflow.com/questions/8441702/scope-interceptor-in-struts2)阅读。

希望有帮助。

# arrays - TypeScript 和数组归约函数

> ID：14087489
> 
> 赞同：86
> 
> 时间：2012-12-30T01:25:19.420
> 
> 标签：arrays, typescript

你知道`reduce`TypeScript 中数组方法的作用吗？你能提供一个简单的使用例子吗？

我在 Google 和[TypeScript 语言规范](http://www.typescriptlang.org/Content/TypeScript%20Language%20Specification.pdf)上进行了搜索，但找不到任何体面的解释和示例。

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2017-11-24T13:54:58.193

除了其他答案之外，只是一个注释。

如果提供了一个初始值来减少，那么有时必须指定它的类型，即：-

```
a.reduce(fn, []) 
```

可能必须是

```
a.reduce<string[]>(fn, []) 
```

或者

```
a.reduce(fn, <string[]>[]) 
```

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2012-12-30T02:00:57.647

它实际上是 JavaScript 数组`reduce`函数，而不是特定于 TypeScript 的东西。

如[文档中所述](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/Reduce)： *对累加器和数组的每个值（从左到右）应用一个函数，以将其减少为单个值。*

这是一个汇总数组值的示例：

```
let total = [0, 1, 2, 3].reduce((accumulator, currentValue) => accumulator + currentValue);
console.log(total);
```

该片段应该产生`6`.

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-09-12T13:32:55.117

使用 TypeScript 泛型，你可以做这样的事情。

```
class Person {
    constructor (public Name : string, public Age: number) {}
}

var list = new Array<Person>();
list.push(new Person("Baby", 1));
list.push(new Person("Toddler", 2));
list.push(new Person("Teen", 14));
list.push(new Person("Adult", 25));

var oldest_person = list.reduce( (a, b) => a.Age > b.Age ? a : b );
alert(oldest_person.Name); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2019-06-05T04:31:12.297

[减少（）](https://www.youtube.com/watch?v=-LFjnY1PEDA)是..

*   reduce() 方法将数组缩减为单个值。
*   reduce() 方法为数组的每个值（从左到右）执行提供的函数。
*   函数的返回值存储在累加器中（结果/总计）。

它是 ..

```
let array=[1,2,3];
function sum(acc,val){ return acc+val;} // => can change to (acc,val)=>acc+val
let answer= array.reduce(sum); // answer is 6 
```

改成

```
let array=[1,2,3];
let answer=arrays.reduce((acc,val)=>acc+val); 
```

您也可以在

1.  找到最大值

```
 let array=[5,4,19,2,7];
    function findMax(acc,val)
    {
     if(val>acc){
       acc=val; 
     }
    }

    let biggest=arrays.reduce(findMax); // 19 
```

2.  [找到一个不重复的元素](https://hackernoon.com/xor-the-magical-bit-wise-operator-24d3012ed821)。

```
 arr = [1, 2, 5, 4, 6, 8, 9, 2, 1, 4, 5, 8, 9]
    v = 0
    for i in range(len(arr)):
    v = v ^ arr[i]
    print(value)  //6 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-05T12:17:26.400

计算数值数组乘积的简单示例。我总是忘记的位是`variable as type`作为初始累加器传递的参数的语法。

```
const product = (nums: number[]): number => nums.reduce((acc: number, v: number): number => acc * v, 1 as number);
alert(product([1, 2, 3, 4])); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-03-03T13:55:47.757

+1 @JohnnyHK 回答它是标准的 Javascript 函数。

我来到这里是因为我在输入这个函数时遇到了一些问题，所以我会把我的发现留在这里。如果你有一个标准的 IDE，如果你点击`reduce`函数，你会得到它的类型定义。

```
/**
 * Calls the specified callback function for all the elements in an array. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.
 * @param callbackfn A function that accepts up to four arguments. The reduce method calls the callbackfn function one time for each element in the array.
 * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.
 */
reduce(callbackfn: (previousValue: T, currentValue: T, currentIndex: number, array: T[]) => T): T;
reduce(callbackfn: (previousValue: T, currentValue: T, currentIndex: number, array: T[]) => T, initialValue: T): T;

/**
 * Calls the specified callback function for all the elements in an array. The return value of the callback function is the accumulated result, and is provided as an argument in the next call to the callback function.
 * @param callbackfn A function that accepts up to four arguments. The reduce method calls the callbackfn function one time for each element in the array.
 * @param initialValue If initialValue is specified, it is used as the initial value to start the accumulation. The first call to the callbackfn function provides this value as an argument instead of an array value.
 */
reduce<U>(callbackfn: (previousValue: U, currentValue: T, currentIndex: number, array: T[]) => U, initialValue: U): U; 
```

第一组用于将数组减少`T`到`T`值本身。

@Quentin 提到的还有第二种用法，即您可能希望将数组减少`T`为其他类型。大多数情况下，我看到它被用作：

```
const keyToValMap = [{key: 'k1', val: 1}].reduce<Record<string, number>>((map, el) => {
  map[el.key] = el.val;
  return map
}, {}) 
```

# mysql - mysql 具有...> avg() 无法按预期工作

> ID：14087490
> 
> 赞同：0
> 
> 时间：2012-12-30T01:25:30.253
> 
> 标签：mysql, having, average

我创建了两个视图来帮助计算 user_diary_number，然后选择日记数 > 总用户 user_diary_number 的平均值的用户。

两个视图如下：

```
create view user_diary_number as
(
select user_id,count( distinct diary_id ) as diary_num
from user_diary

group by user_id
); 
```

第二次使用`having`and `avg`：

```
create view hw_diary as
(
select u.user_id, u.realname, ud.diary_num, school.school_name
from (user as u cross join user_diary_number as ud on u.user_id = ud.user_id )cross join school on u.school_id = school.school_id
having diary_num > avg(diary_num)

); 
```

现在的问题是，第二个视图只有 1 行结果。当然，我们有超过 1 个用户的日记数 > 平均日记数。事实上，我总共有 251 篇日记和 103 个用户。一些用户有 9、4、5 份日记。但结果仅出现在 1 个拥有 3 篇日记的用户中。

我的相对表是：

```
CREATE TABLE IF NOT EXISTS `school` (
  `school_id` int(11) NOT NULL,
  `school_name` varchar(45) NOT NULL,
  `location` varchar(45) NOT NULL,
  `master` varchar(45) NOT NULL,
  `numbers_of_student` int(11) NOT NULL,
  PRIMARY KEY (`school_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS `user_diary` (
  `diary_id` int(11) NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `title` varchar(45) NOT NULL,
  `content` varchar(255) NOT NULL,
  `addtime` DATETIME NOT NULL,
  PRIMARY KEY (`diary_id`,`user_id`),
  KEY `fk_diary_user_id_idx` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ; 
```

交叉连接有问题吗？或者是其他东西？多谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T01:33:19.710

你不能那样使用 avg 。在我的个人电影数据库中，

```
select * from movie having year > avg(year); 
```

不产生任何东西，并且

```
select * from movie having year > (select avg (year) from movie); 
```

产生预期的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T01:37:59.810

您必须在单独的子查询中计算平均值。

就像是：

```
select ...
from ...
group by ...
having diary_num > (
    select avg(diary_num)
    from ...) 
```

你可以用有意义的东西填空

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T01:51:12.623

像这样的东西应该返回您正在寻找的结果集：

```
 SELECT u.user_id
      , u.realname
      , c.diary_num
      , s.school_name
   -- , a.diary_avg
   FROM ( SELECT d.user_id
               , COUNT(DISTINCT d.diary_id) AS diary_num
            FROM user_diary d
        ) c
   JOIN user u
     ON u.user_id = c.user_id
   JOIN school s
     ON s.school_id = u.school_id
   JOIN ( SELECT AVG(v.diary_num) AS diary_avg
            FROM ( SELECT t.user_id
                        , COUNT(DISTINCT t.diary_id) AS diary_num
                     FROM user_diary t
                 ) v
        ) a
     ON a.diary_avg < c.diary_num
  ORDER BY 1 
```

别名为 as 的内联视图为`c`我们提供了每个用户的 diary_num（计数）。

别名为 as 的内联视图为`a`我们提供了所有用户的所有 diary_num 的平均值。这使我们获得了计数的“平均值”，这看起来就像您的原始查询打算做的那样。

作为替代方案，我们可以得到每个用户的“平均”日记数……所有日记的总数除以所有用户的总数。为此，请将别名为`a`类似这样的内联视图替换为：

```
 ( SELECT COUNT(DISTINCT t.diary_id)
                 / NULLIF(COUNT(DISTINCT v.user_id),0) AS diary_avg
            FROM user v
            LEFT
            JOIN user_diary t
              ON t.user_id = v.user_id
        ) a 
```

这会产生略有不同的结果，因为它是对总计数的计算，而不是计算的平均值。

* * *

**笔记**

该`CROSS`关键字对 MySQL 优化器没有影响。

我们通常会将`CROSS`关键字作为文档提供给未来的审阅者。它表明我们故意省略了通常的`ON`子句。（作为审稿人，当我们看到一个没有 ON 子句的 JOIN 时，我们的头脑会争先恐后地想到“可能的意外笛卡尔积”……作者包含`CROSS`关键字提醒我们（审阅者）该`ON`子句的省略是有目的的。

但是 MySQL 优化器并不关心`CROSS`关键字是包含还是省略。

* * *

**还有一个问题：MySQL 是否支持“视图的 SELECT 在 FROM 子句中包含子查询”？**

**答：** MySQL 的真正旧版本（3.x？）不支持子查询。但可以肯定的是，MySQL 5.1 及更高版本确实支持子查询。

要回答您的问题，是的，可以将 SELECT 语句用作内联视图作为另一个查询的行源，例如

```
SELECT v.*
  FROM (
         SELECT 1 AS foo
       ) v 
```

# java - Android：实现 ViewHolder

> ID：14087495
> 
> 赞同：17
> 
> 时间：2012-12-30T01:26:21.793
> 
> 标签：java, android

我正在尝试在我的 Android 应用程序中实现 ViewHolder，但我一直认为 ViewHolder 无法解析为类型，没有任何导入建议。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-30T01:29:35.963

那是因为 a`ViewHolder`不是*来自*Android SDK 的类，您自己制作。根据我能[找到](http://xjaphx.wordpress.com/2011/06/16/viewholder-pattern-caching-view-efficiently/)的，a`ViewHolder`是一种实现，可以为更大的区域存储视图（通常是 ListView 中的每行），因此它是一种辅助类和缓存机制。这是我在 Android Developers 上找到的一个[示例](http://developer.android.com/training/improving-layouts/smooth-scrolling.html)`ViewHolder`，说明 a包含的内容。

```
static class ViewHolder {
  TextView text;
  TextView timestamp;
  ImageView icon;
  ProgressBar progress;
  int position;
} 
```

然后你可以在一个`ListAdapter`或类似的类中实现它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-25T06:26:20.797

```
**Create a Holder class**

protected static class ViewHolderItems
{
    private ImageView mStoreImage;
    private TextView mStoreName;
}

And use In getView method of adapter

 public View getView(int position, View convertView, ViewGroup parent) {

        ViewHolderItems viewHolder;
        if (inflater == null)
            inflater = (LayoutInflater) activity
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        if (convertView == null) {
            convertView = inflater.inflate(R.layout.coupen_row, null);
            viewHolder = new ViewHolderItems();
            viewHolder.mStoreImage = (ImageView) convertView.findViewById(R.id.storeImage);

            viewHolder.mStoreName = (TextView) convertView.findViewById(R.id.storeName);

            convertView.setTag(viewHolder);

        } 
       else 
        {
            viewHolder = (ViewHolderItems) convertView.getTag();
        }

         return convertView;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-13T01:54:21.900

也许您正在寻找 RecyclerView.ViewHolder，它是 android 支持库的一部分。

[就像Paul Burke](https://github.com/iPaulPro/Android-ItemTouchHelper-Demo/blob/master/app/src/main/java/co/paulburke/android/itemtouchhelperdemo/RecyclerListAdapter.java)的这个链接要点的代码一样

```
public static class ItemViewHolder extends RecyclerView.ViewHolder implements 
        ItemTouchHelperViewHolder { 

    public final TextView textView;
    public final ImageView handleView;

    public ItemViewHolder(View itemView) {
        super(itemView);
        textView = (TextView) itemView.findViewById(R.id.text);
        handleView = (ImageView) itemView.findViewById(R.id.handle);
    } 

    @Override 
    public void onItemSelected() { 
        itemView.setBackgroundColor(Color.LTGRAY);
    } 

    @Override 
    public void onItemClear() { 
        itemView.setBackgroundColor(0); 
    } 
} 
```

如果您使用的是[Android RecyclerView ，这对您来说很有意义](https://developer.android.com/reference/android/support/v7/widget/RecyclerView.htmlhttps://developer.android.com/reference/android/support/v7/widget/RecyclerView.html)

在这种情况下，他们需要一个对象来保存视图，以便可以根据需要填充内容。

# jsp - 在 JSP 中将 JavaBean 放入 HttpSession

> ID：14087499
> 
> 赞同：0
> 
> 时间：2012-12-30T01:27:16.393
> 
> 标签：jsp, arraylist, javabeans, httpsession

我试图做一个关于调查的“简单”应用程序。您有一些选项（复选框），然后结果（投票）显示在其他页面中。

我有这个类，我可以一直保留结果（我想更新这个类，使用 HttpSession）。我使用的是HashMap类，但我改变了，我认为没关系：

```
package beans;
import java.util.ArrayList;
import java.util.List;

public class SurveyBean {

    private List<String> keys;
    private List<String> values;

    public SurveyBean() {
        keys = new ArrayList<String>(); //keys: {"Cat", "Dog", "Other animal"}
        values = new ArrayList<String>(); //Values: {"12","5","4"}
        // By example, a value of 12 means, 12 people like cats.

        keys.add("Cat");
        keys.add("Dog");
        keys.add("Bird");

        // Don't ask me why did I use Strings instead of Integers.
        values.add("0"); // Zero votes 
        values.add("0");
        values.add("0");

    }

    // add one vote to the list of values
    public void addVote( String key, int value ) {
        int index = keys.indexOf(key);
        int newValue = Integer.parseInt(values.get(index)) + value;
        values.set(index, "" + newValue);
    }

    /********* Get and set methods *********/ 
```

现在，这是主窗体 (jsp)，它尝试将 JavaBean 放入会话中： 注意：我正在使用 JSP 的旧 sintaxis，因为我还在学习。

```
<%@page contentType="text/html" session="true" pageEncoding="UTF-8"%>
<!DOCTYPE html>

<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>JSP Page</title>
</head>
<body>
    <!-- Create the JavaBean "SurveyBean" (Scope: session) -->
    <jsp:useBean id="survey" class="beans.SurveyBean" scope="session"  />

    What's your favorite animal ?
    <form action="page2.jsp" method="POST">
        <%
            java.util.List<String> list = survey.getKeys();

            /* It prints:
             * What's your favorite animal? (Bird,Dog,Cat, etc.)    
            */
            for( int i = 0; i < list.size(); i++ ) {
                out.println("<input type=\"radio\" name=\"name\" value=\"" + list.get(i) +"\">" + list.get(i) + "<br>");
            }
        %>

        <input type="submit" value="Send" />
    </form>

</body> 
```

这是结果页面：

```
<%@page import="beans.SurveyBean, java.util.*"%>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>JSP Page</title>
</head>
<body>

    <%

      // getting the checKbox selected
      String name = request.getParameter("name");

      // Trying to get the object survey from the session
      HttpSession ses = request.getSession(false);
      SurveyBean sv = (SurveyBean) request.getAttribute("survey");

      // Add one vote to the list of values
      List<String> keys = sv.getKeys();
      List<String> values = sv.getValues();

      // I can't use the objects "Keys" and "values", because they are marked as Null.
      // Why they are Null !!!! ???

    %>

</body> 
```

这里的问题是我不能使用 object `SurveyBean`。我不确定第一页（表单）是否正确初始化了 bean。而且我无法从会话中获取对象。
注意：对不起，我的英语真的很差。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T20:31:36.113

现在我已经解决了这个问题。在第一个 jsp 中，它将对象调查放入会话中。我添加这一行：

```
request.setAttribute("survey2",survey2); 
```

在接收对象的第二页中，我添加了另一行：

```
<%@page contentType="text/html" pageEncoding="UTF-8" session="true"%> 
```

我想在指令@page 中添加属性“会话”是必要的。

编辑：实际上，这不是解决方案。我认为它有效，因为我已将代码放入 Servlet，如下所示：

```
PrintWriter out = response.getWriter();
    try {

        //Getting the parameter and the object survey
        String name = request.getParameter("name");
        HttpSession ses = request.getSession(false);
        SurveyBean survey = (SurveyBean) ses.getAttribute("survey");

        // Adding one vote
        survey.addVote(name,1);

        // Forwarding
        ses.setAttribute("survey", survey);
        RequestDispatcher rd = request.getRequestDispatcher("/page2.jsp");
        rd.forward(request, response);

    } finally {            
        out.close();
    } 
```

# jquery - jQuery datepicker 在 Ajax 调用后不起作用

> ID：14087501
> 
> 赞同：2
> 
> 时间：2012-12-30T01:27:50.890
> 
> 标签：jquery, ajax, datepicker

情况如下：我正在使用 jQuery 动态加载表单。在这种形式中，有一个来自 jQueryUI 的日期选择器。问题是日期选择器第一次加载，但是如果再次加载表单，日期选择器就不起作用。我知道每次加载页面时我都需要重新绑定 datepicker 函数，但我所有的尝试都失败了。任何帮助，将不胜感激！

下面的代码片段：

```
function makeMyDay() 
{
    $(".datepicker").datepicker(
    {
        inline: true
    });
}

function getNewPage(id,idTwo)
{
    $.ajax(
    {
        type: "GET",
        url: 'foo.php',
        data: "id=" + id,
        success: function(data) 
        {
            $('.bar' + idTwo).html(data);
            makeMyDay();
        }
    });
} 
```

以防万一需要澄清，foo.php 被加载到 .bar 中。日期选择器本身在 foo.php 中，外部的 JS 文件在主文件中，而不是 foo.php。

**编辑**

更新了下面的代码，但问题仍然存在：

```
$(function()
{
    $('.datepicker').datepicker({inline: true});
});

function getNewPage(id,idTwo)
{
    $.ajax(
    {
        type: "GET",
        url: 'foo.php',
        data: "id=" + id,
        success: function(data) 
        {
            $('.bar' + idTwo).html(data).find(".datepicker").datepicker(
            {
                inline: true
            });
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:51:11.610

切换`$(makeMyDay);`到`makeMyDay();`应该可以解决问题，因为 makeMyDay 是一个函数而不是选择器。

或者尝试在 ajax 调用之后直接绑定 datepicker()，只要 .datepicker 在 .bar 容器中，这应该可以工作：

```
function getNewPage(id,idTwo)
{
    $.ajax({
        type: "GET",
        url: 'foo.php',
        data: "id=" + id,
        success: function(data) {
             $('.bar' + idTwo).html(data).find(".datepicker").datepicker({
                   inline: true
              });
        }
    });
} 
```

可以在此处找到模拟该过程的工作示例：http: [//jsfiddle.net/7wBWB](http://jsfiddle.net/7wBWB)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T00:19:24.973

今天下午我遇到了类似的问题并解决了这些问题，这要感谢@Chris Kempen 对在这里测试 hasDatePicker 类的想法的回答：[jQuery datepicker won't work on a AJAX added html element](https://stackoverflow.com/questions/4812784/jquery-datepicker-wont-work-on-a-ajax-added-html-element)

我使用这一行来绑定使用 ajax 调用未更新的元素：

```
$('.container').on('focus', 'input[type=date]', this.bindDatepicker); 
```

在 this.bindDatepicker 中，我选择了焦点而不是他的点击，但使用他的想法来测试 hasClass('hasDatepicker')。

我正在使用 Modernizr 来测试 Modernizr.inputtypes.date，然后加载绑定 datepicker 的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-29T09:46:51.553

试试这些代码。在我的情况下，通过 ajax 加载内容它可以工作

```
$(document).ready(function() {
 $('body').click(function(event) {
   if ($(event.target).is("#new_datepicker")) {
     $("#new_datepicker").datepicker({showOn: 'focus'}).focus();
   }
 });
}); 
```

# grails - 结构登录成功和失败特征

> ID：14087502
> 
> 赞同：0
> 
> 时间：2012-12-30T01:29:08.797
> 
> 标签：grails, cucumber, geb

我刚刚开始使用 Cucumber，我在 Grails 2.1.1 应用程序中使用 Geb。我已经完成了第一个测试，测试成功登录。

```
Feature: login to system
  As a user of the system
  I want to log in to the application
  so that I can use it

  Scenario: login
    Given I access the login page
    When I enter "user_10001" and "10001"
    Then I see the dashboard

Given(~'^I access the login page$') {->
  to LoginPage
  at LoginPage
}

When(~'^I enter "([^"]*)" and "([^"]*)"$') { String username, String password ->
  page.add(username, password)
}

Then(~'^I see the dashboard$') {->
  at DashboardPage
}

Then(~'^I see an error message on the login page$') { ->
  at LoginPage
} 
```

这很好用。我还想测试登录失败时会发生什么。我意识到这是另一种情况，但它是另一个功能吗？或者它是同一功能的附加场景？任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T17:43:43.647

特性是一种功能。将场景划分为多个功能的唯一原因是使文件的长度更短，并使有关功能的信息更易于搜索。

您的方案是身份验证功能的一部分。但是如果你有很多与身份验证相关的功能（几个登录页面、忘记密码、短信/电话确认），身份验证功能可以分为几个功能文件放入身份验证文件夹中。这取决于您的应用程序

我认为在任何情况下成功和不成功登录的场景都更适合同一个文件。

* * *

此外，您的场景对我来说看起来有点脆弱和必要。阅读以下：

*   [用户故事中的命令式与声明式场景](http://benmabey.com/2008/05/19/imperative-vs-declarative-scenarios-in-user-stories.html)
*   [Cucumber 书中重构的示例](https://gist.github.com/2057807)

我会这样写：

```
Scenario: Login
  Given I'm at login page
  When I login with valid credentials
  Then I see the dashboard 
```

# intellij-idea - 管理 IntelliJ 工具窗口，如何

> ID：14087504
> 
> 赞同：9
> 
> 时间：2012-12-30T01:29:29.763
> 
> 标签：intellij-idea

目前我的`IntelliJ`节目除其他外

![在此处输入图像描述](../Images/5757472bbda97c08fb64e3d0f4d0c8b6.png)

我如何决定

1.  显示了哪些工具窗口
2.  它们在哪里显示

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-30T02:00:57.970

这些东西称为*工具窗口*，您可以在`View > Tool Windows`.

要禁用其中一些，您可以安装插件[ToolWindow Manager](http://plugins.jetbrains.com/plugin?pr=idea&pluginId=1489)并一一禁用。

您可以启用/禁用所有工具窗口`Settings > Appearance > Show tool window bars`

[您可以在此处](http://www.jetbrains.com/idea/webhelp/manipulating-the-tool-windows.html)找到有关它们的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T01:43:00.887

这些被称为“工具窗口”。如果您右键单击它们，它会显示一个菜单，底部有一个“隐藏”选项。我注意到其中一些无法隐藏，但您可以将它们拖到您视野之外的其他地方。例如，您可以将它们从底部拖到侧面。您也可以拖动来回答您的第二个问题。

# cuda - 数据传输和内核执行的 CUDA 重叠，流的隐式同步

> ID：14087508
> 
> 赞同：2
> 
> 时间：2012-12-30T01:30:04.353
> 
> 标签：cuda

1.  看完《CUDA C编程指南》中CUDA的“数据传输和内核执行的重叠”部分，我有个疑问：数据传输到底指的是什么？是否包括`cudaMemsetAsync`, `cudaMemcpyAsync`, `cudaMemset`, `cudaMemcpy`. 当然，分配给 memcpy 的内存是固定的。

2.  在隐式同步（流）部分，书中说“设备内存集”可以序列化流。那么，它指的是`cudaMemsetAsync`, `cudaMemcpyAsync`, `cudaMemcpy`,`cudaMemcpy`吗？我不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T04:59:10.080

任何以`Async`a 结尾的函数调用都有一个流参数。此外，CUDA 工具包提供的一些库也有设置流的选项。通过使用它，您可以同时运行多个流。

这意味着，除非您专门创建和设置流，否则您将使用默认流。例如，没有默认值`data transfer`和`kernel execution`流。您将必须创建两个（或更多）流，并为它们分配选择的任务。

一个常见的用例是拥有编程指南中提到的两个流。请记住，这仅在您启动多个内核时才有用。在计算当前内核的结果时，您可以获得下一个（独立）内核或当前内核的下一次迭代所需的数据。这可以最大化计算和带宽能力。

对于您提到的函数调用，`cudaMemcpy`并且`cudaMemcpyAsync`是唯一执行数据传输的函数。我不认为`cudaMemset`并且`cudaMemsetAsync`可以称为数据传输。

两者`cudaMempyAsync`和`cudaMemsetAsync`都可以与流一起使用，而`cudaMemset`和`cudaMemcpy`正在阻塞不使用流的调用。

# xcode - 如何在 Xcode 中将控件锚定到一侧？

> ID：14087509
> 
> 赞同：2
> 
> 时间：2012-12-30T01:30:13.273
> 
> 标签：xcode, macos, interface-builder

好的，所以我是在 PC 上使用 Visual Basic 进行编程的，现在我正在尝试使用 Xcode 在 OS X 上重新制作我的程序，到目前为止我已经成功了。然而，我注意到的一件事是，当我尝试调整窗口大小时，控件要么留在同一个地方，要么粘在一侧。在 Visual Basic 中，我使用“anchor”或“dock”属性来决定控件是否会随着窗口大小的调整而拉伸，或者是否停留在一侧。我只是想知道在 Interface Builder 中是否有一种简单的方法可以做到这一点。我正在使用 Xcode 4.5.1，我能得到的任何帮助都会很棒。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T01:35:39.790

在 IB 中，单击文件检查器（第一个图标），然后确保未选中自动布局。然后转到尺寸检查器（第 5 个图标）并进行更改。

[![](../Images/fa06826d0a412c619898923c84ad1ab0.png)](https://i.stack.imgur.com/1jnyN.png)
[（来源：[fredandrandall.com](http://fredandrandall.com/blog/wp-content/uploads/2011/08/saveasautolayout.png)）]

# javascript - 引导程序 - 404 找不到文件

> ID：14087512
> 
> 赞同：2
> 
> 时间：2012-12-30T01:30:41.927
> 
> 标签：javascript, jquery, html, jquery-ui, widget

当我调试我的网站时，谷歌浏览器会这样说：

```
GET http://localhost/index.php/js/vendor/bootstrap.min.js 404 (Not Found) localhost:247
GET http://localhost/index.php/js/main.js 404 (Not Found) 
```

据我了解，它找不到这两个文件。但我从来没有要求它找到他们。这是我的html文件的标题：

```
 <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">

    <link href="/jquery_ui/development-bundle/themes/base/jquery.ui.all.css" rel="stylesheet">
    <link href="/jquery_ui/development-bundle/themes/smoothnes-edit/jquery.ui.all.css" rel="stylesheet">

    <!--<link href="/jquery_ui/css/smoothness/jquery-ui-1.9.2.custom.css" rel="stylesheet">-->
    <script src="/jquery_ui/js/jquery-1.8.3.js"></script>
    <script src="/jquery_ui/js/jquery-ui-1.9.2.custom.js"></script>

    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
    <style>
        body {
            padding-top: 60px;
            padding-bottom: 40px;
        }
    </style>
    <link rel="stylesheet" href="/bootstrap/css/bootstrap-responsive.min.css">
    <link rel="stylesheet" href="/bootstrap/css/main.css">

    <script src="/bootstrap/js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>

    <!-- LOADING CUSTOMS -->

    <?php require('application/views/wqWidgets.php'); ?>

    <link href="/Styles/buttons.css" rel="stylesheet" />

    <link href="/Styles/colorbox.css" rel="stylesheet" />
    <script type="text/javascript" src="/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="/jquery.colorbox.js"></script>

    <script type="text/javascript" src="/result.js"></script>

    <script src="/jquery.colorbox.js"></script> 
```

我确实有一些其他框架，如 jqwidgets 和 jquery-ui，在修复此错误之前，这些框架将无法工作。是的，我已经检查了所有链接是否有效，并且它们确实有效。

这是怎么回事，难道是命令？

编辑：完整代码：

```
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <link href="/jquery_ui/development-bundle/themes/base/jquery.ui.all.css" rel="stylesheet">
        <link href="/jquery_ui/development-bundle/themes/smoothnes-edit/jquery.ui.all.css" rel="stylesheet">

        <!--<link href="/jquery_ui/css/smoothness/jquery-ui-1.9.2.custom.css" rel="stylesheet">-->
        <script src="/jquery_ui/js/jquery-1.8.3.js"></script>
        <script src="/jquery_ui/js/jquery-ui-1.9.2.custom.js"></script>

        <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
        <style>
            body {
                padding-top: 60px;
                padding-bottom: 40px;
            }
        </style>
        <link rel="stylesheet" href="/bootstrap/css/bootstrap-responsive.min.css">
        <link rel="stylesheet" href="/bootstrap/css/main.css">

        <script src="/bootstrap/js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>

        <!-- LOADING CUSTOMS -->

        <link rel="stylesheet"        href="/JQWidgets/jqwidgets/styles/jqx.base.css" type="text/css" />
<link rel="stylesheet"        href="/JQWidgets/jqwidgets/styles/jqx.fresh.css" type="text/css" />

<script type="text/javascript" src="/JQWidgets/scripts/gettheme.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxcore.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxbuttons.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxdatetimeinput.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxcalendar.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxtooltip.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/globalization/jquery.global.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxradiobutton.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxprogressbar.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxcheckbox.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxscrollbar.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxlistbox.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxcombobox.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxdropdownlist.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxpanel.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxlistmenu.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxdata.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxchart.js"></script>
<script type="text/javascript" src="/JQWidgets/scripts/json2.js"></script> 
<script type="text/javascript" src="/JQWidgets/scripts/knockout-2.1.0.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxmenu.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxgrid.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxgrid.selection.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxgrid.edit.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxknockout.js"></script> 
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxdata.export.js"></script> 
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxgrid.export.js"></script> 
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxtree.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxsplitter.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxbuttons.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxpanel.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxlistbox.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxscrollbar.js"></script>
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxgrid.sort.js"></script> 
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxgrid.pager.js"></script> 
<script type="text/javascript" src="/JQWidgets/jqwidgets/jqxgrid.selection.js"></script> 

        <link href="/Styles/buttons.css" rel="stylesheet" />

        <link href="/Styles/colorbox.css" rel="stylesheet" />
        <script type="text/javascript" src="/jquery.colorbox-min.js"></script>
        <script type="text/javascript" src="/jquery.colorbox.js"></script>

        <script type="text/javascript" src="/result.js"></script>

        <script src="/jquery.colorbox.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <div class="navbar navbar-inverse navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="#">Utoping</a>
                    <div class="nav-collapse collapse">
                        <ul class="nav">
                            <li class="active" ><a href="/index.php/">Home</a></li>
                            <li  ><a href="/index.php/about/">About</a></li>
                            <li  ><a href="/index.php/contact/">Contact</a></li>

                                                    </ul>
                        <form class="navbar-form pull-right">
                            <input class="span2" type="text" placeholder="Email">
                            <input class="span2" type="password" placeholder="Password">
                            <button type="submit" class="btn">Sign in</button>
                        </form>
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </div>

        <div class="container"><!-- Main hero unit for a primary marketing message or call to action -->
<div class="hero-unit">
    <h1>Utoping</h1>
    <p>Virtual Connection. Achieving Perfection!</p>
    <p><a class="btn btn-primary btn-large" href="/index.php/about/">Learn more &raquo;</a></p>
</div>

<!-- Example row of columns -->
<div class="row">
    <div class="span4">
        <h2>Diversity</h2>
        <p>Blablabla...</p>
        <p><a class="btn" href="#">View details &raquo;</a></p>
    </div>
    <div class="span4">
        <h2>Integrity</h2>
        <p>Blablabla...</p>
        <p><a class="btn" href="#">View details &raquo;</a></p>
   </div>
    <div class="span4">
        <h2>Creativity</h2>
        <p>Blablabla...</p>
        <p><a class="btn" href="#">View details &raquo;</a></p>
    </div>
</div>
</div>

<div id="register-unit" class="hero-unit-register">
    <h1><a id="clickme">Register</a></h1>
    <p>Virtual Connection. Achieving Perfection!</p>

        <label for="_Email">Email</label>
        <input style='margin-left: 10px; margin-top: 10px;' type="email" name="_Email" id="_Email" class="text ui-widget-content ui-corner-all" />

        </br>

        <label for="_Nickname">Company Name</label>
        <input style='margin-left: 10px; margin-top: 10px;' type="text" name="_Nickname" id="_Nickname" value="" class="text ui-widget-content ui-corner-all" />

        </br>

        <select style='visibility: hidden' id='select'>
            <option>Primary</option>
            <option>Secundary</option>
            <option>Tertiary</option>
        </select>

        <label for="jqxIndustry">Industry</label>
        <div style='margin-left: 10px; margin-top: 10px;' id='jqxIndustry'></div>
        <input type="hidden" id="Industry" name="Industry">

        </br>

        <label for="jqxDateTimeInput" title="NOTE: Please change this date, or else the chosen date will be invalid!">Date of creation</label>
        <div style='margin-left: 10px; margin-top: 10px;' id='jqxDateTimeInput'></div>
        <input type="hidden" id="date" name="date">

        </br>

        <label for="_Password">Password</label>
        <input type="password" id="_Password" name="_Password" class="text ui-widget-content ui-corner-all">

        </br>

        <label for="pr" title="For your security, we ask you to repeat your password">Repeat:</label>
        <input type="password" id="pr" name="pr" class="text ui-widget-content ui-corner-all">

       </br>

    <p><a class="btn btn-primary btn-large">Register Now &raquo;</a></p>
</div>

<script>
var toggle_ = [];
$(document).ready(function () {
    toggle_.toggled = false;

    $('#clickme').click(function() {
        if (toggle_.toggled)
        {
            $('#register-unit').animate({
                bottom: '-=200',
              }, 2000, function() {
                // Animation complete.
              });
        }
        else
        {
            $('#register-unit').animate({
                bottom: '+=200',
              }, 2000, function() {
                // Animation complete.
              });
        }

        {if (toggle_.toggled){toggle_.toggled = false;}else{toggle_.toggled = true;}}
    });

    $( document ).tooltip();

    // JQ WIDGETS

    var theme = getTheme();

    //JQX
    $("#jqxDateTimeInput").jqxDateTimeInput({ animationType: 'fade', height: '25px', theme: theme });

    $("#jqxIndustry").jqxDropDownList({ animationType: 'fade', width: "510px", height: '25px', theme: theme });
    // Load the data from the Select html element.
    $("#jqxIndustry").jqxDropDownList('loadFromSelect', 'select');

    $("#jqxDateTimeInput").bind('valuechanged', function (event) {
        var date = event.args.date;
        var hiddenField = document.getElementById('date');

        hiddenField.value = date;
    });

    $('#jqxIndustry').bind('select', function (event) {
        var args = event.args;
        var item = $('#jqxIndustry').jqxDropDownList('getItem', args.index);
        if (item != null) {
            var hiddenField = document.getElementById('Industry');
            hiddenField.value = item.label;
        }
    });

    $('#jqxIndustry').bind('unselect', function (event) {
        var args = event.args;
        var item = $('#jqxIndustry').jqxDropDownList('getItem', args.index);
    });
});
</script>

<div class="container">         <hr>

            <footer>
                <p>&copy; Vinci Enterprise 2012</p>
            </footer>

        </div> <!-- /container -->

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.3.min.js"><\/script>')</script>

        <script src="js/vendor/bootstrap.min.js"></script>

        <script src="js/main.js"></script>

        <script>
            var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:54:03.203

在最底部的引导程序请求这些文件（就在谷歌分析代码上方）：

```
<script src="js/vendor/bootstrap.min.js"></script>
<script src="js/main.js"></script> 
```

# javascript - (Javascript/RaphaelJS) 如何将变量附加到新数组中的新对象？

> ID：14087521
> 
> 赞同：0
> 
> 时间：2012-12-30T01:32:09.230
> 
> 标签：javascript, arrays, variables, object, raphael

抱歉，如果这看起来很短/未经研究（我可能一直在寻找所有错误的地方并考虑到错误的逻辑），但我觉得答案会很简单/直截了当。

假设我设置了一些变量，例如：

```
var path1 = paper.path("M 95, 259 L 110, 250... etc. etc.. ");

var path2 = paper.path("M 96 138 L 55, 100,... etc... etc.."); 
```

将它们插入一组...

```
var set1 = paper.set();
    set1.push(icon1, path1); 
```

编辑：这两个步骤 x2 ^^^^^^^^^

然后想继续将该新集合插入到一个新数组中，其中包含具有自己 id 的新对象，因此我稍后可以在设置点击处理程序函数时引用该数组。

基本上有什么方法我应该/可以将每个集合附加到这个新的新对象数组？

编辑：

这是我正在使用的更具体的内容。我创建了一个 for 循环来运行该数组...虽然有效，但无论单击哪个集合，它都只显示第一个开关 DIV。相反，我想在单击 set2 时显示 switch2 ......甚至用 set3 显示 switch3 ......等等。谢谢。

```
 switches = [
        { id: 'switch1', set: set1 },
        { id: 'switch2', set: set2 }

    ],
    current,
    max,
    i;

for (i = 0, max = switches.length; i < max; i++) {
    initSwitch(switches[i].set, switches[i].id);
}

function initSwitch(switchStr, targetId) {

        txElm = document.getElementById(targetId);

     var clickHandler2 = (function (e) {
         if (current) {
             if (current === txElm) {
                 return;
             }
             current.style.display = '';
         }
         current = txElm;
         current.style.display = 'block';
         //this.toFront();
         paper.safari();
    });

    set1.click( clickHandler2 );
    set2.click( clickHandler2 ); 
```

最终编辑：

看看我刚刚写的这个jsfiddle。我希望第一个框和图像显示“switch1”Div，第二个两个框显示“switch2”Div。

[http://jsfiddle.net/thecomplex/AEa2X/13/](http://jsfiddle.net/thecomplex/AEa2X/13/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:26:18.080

我认为你正在寻找的是这样的：

```
var switches = [
    { id: 'switch1', set: set1 },
    { id: 'switch2', set: set2 }
]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T01:36:54.277

```
var switches = [
        { id: 'switch1', set: set1 },
        { id: 'switch2', set: set2 }
];
var current;

for (var i = 0, max = switches.length; i < max; i++) {
    initSwitch(switches[i].set, switches[i].id);
}

function initSwitch(set, targetId) {
    var txElm = document.getElementById(targetId);

    set.click(function(e) {
        if(current == txElm)
            return;
        if(current)
             current.style.display = '';
        current = txElm;
        current.style.display = 'block';
        paper.safari();
    });
} 
```

# jquery - flash actionscript 可以检测到哪个设备正在输入吗？

> ID：14087522
> 
> 赞同：2
> 
> 时间：2012-12-30T01:32:18.737
> 
> 标签：jquery, actionscript-3, flash, web-applications, barcode-scanner

我为我的商店建立了一个小型网络应用程序数据库，通过条形码扫描仪跟踪我的库存和员工。

我已经完成了所有的工作，但是在我一直在使用数据库搜索数字等之后，扫描仪输入框没有焦点出现问题。

我有一些预防措施，例如`$('#Barcode_box').focus();`在单击不需要交互的任何内容（即不是输入框）和如果鼠标在这么多分钟/秒内不活动时启动的计时器（不理想）。但这仍然不是故障保险！

我知道网页上的 flash 可以访问网络摄像头和麦克风，我知道如何调用 javascript 函数或让 java-s 从网页调用其函数。

但我想知道，由于条形码扫描仪有效地输入和返回（ascii 13）**，实际上有什么方法可以检测到什么设备正在输入或向客户端机器发送信号？**

我试过用谷歌搜索很多不同的东西，即使是任何可以直接监听 Bcode 扫描器的 com 端口输入并直接发布到盒子的 as3 代码，但无济于事。

非常感谢任何帮助。我想也许有一个闪光击键监听器，但觉得这可能有点沉重。

哦，这是在运行 wamp 的内部网络上。

我确实遇到过[使用闪存中的 actionscript 3 进行 USB 设备检测](https://stackoverflow.com/questions/3387397/usb-device-detection-using-actionscript-3-from-flash)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T20:09:44.410

我现在能想到的最好的解决方案是一个 jquery：

```
$("body").click(function(e) {
if($('input:not(#Barcode)').is(":focus")){}
else{
$('#Barcode').focus();} 
```

});

经过几分钟的测试似乎可以正常工作....

编辑：万一有人从ag搜索中遇到这个，代码就是说：当用户点击任何东西时->如果它没有专注于输入，则将焦点设置为条形码条目。

我也可以尝试按键监听器，只是为了确定！

# python - python多处理挂起，潜在的队列内存错误？

> ID：14087527
> 
> 赞同：3
> 
> 时间：2012-12-30T01:33:54.167
> 
> 标签：python, queue, multiprocessing

我最近发布了一个问题[Using multiprocessing for find network paths](https://stackoverflow.com/questions/13993674/using-multiprocessing-for-finding-network-paths)，很高兴@unutbu 提供了一个简洁的解决方案

然而，我在执行`test_workers()`（利用多处理）功能时遇到了困难。`N`代码运行，但在我的网络中有大量节点挂起`G`

使用 Mac OS X Lion 10.7.5 -- python 2.7 运行，当 N>500 时挂起。logging 带来以下消息，之后它会挂起

```
[DEBUG/MainProcess] doing self._thread.start()
[DEBUG/MainProcess] starting thread to feed data to pipe
[DEBUG/MainProcess] ... done self._thread.start() 
```

通过 VMware fusion 在 Windows 7 上运行有助于更大的网络，但最终会在 N> 20,000 个节点周围出现图表（理想情况下，我希望在 N = 500,000 的网络上使用它）。悬挂点来自窗户一侧的消息：

```
[DEBUG/MainProcess] starting thread to feed data to pipe
[DEBUG/MainProcess] ... done self._thread.start()[DEBUG/MainProcess] telling queue thread to quit
Traceback (most recent call last):
      File "C:\Users\Scott\Desktop\fp_test.py", line 75, in <module>
    Traceback (most recent call last):
          File "C:\Python27\lib\multiprocessing\queues.py", line 264, in _feed
    test_workers()
    MemoryError 
```

我想知道是否有人对为什么会发生这种情况有任何想法？如果有任何建议如何让它适用于更大的网络？

非常感谢您提出的任何建议。

@unutbu 的代码：

```
import networkx as nx
import multiprocessing as mp
import random
import sys
import itertools as IT
import logging
logger = mp.log_to_stderr(logging.DEBUG)

def worker(inqueue, output):
    result = []
    count = 0
    for pair in iter(inqueue.get, sentinel):
        source, target = pair
        for path in nx.all_simple_paths(G, source = source, target = target,
                                        cutoff = None):
            result.append(path)
            count += 1
            if count % 10 == 0:
                logger.info('{c}'.format(c = count))
    output.put(result)

def test_workers():
    result = []
    inqueue = mp.Queue()
    for source, target in IT.product(sources, targets):
        inqueue.put((source, target))
    procs = [mp.Process(target = worker, args = (inqueue, output))
             for i in range(mp.cpu_count())]
    for proc in procs:
        proc.daemon = True
        proc.start()
    for proc in procs:    
        inqueue.put(sentinel)
    for proc in procs:
        result.extend(output.get())
    for proc in procs:
        proc.join()
    return result

def test_single_worker():
    result = []
    count = 0
    for source, target in IT.product(sources, targets):
        for path in nx.all_simple_paths(G, source = source, target = target,
                                        cutoff = None):
            result.append(path)
            count += 1
            if count % 10 == 0:
                logger.info('{c}'.format(c = count))

    return result

sentinel = None

seed = 1
m = 1
N = 1340//m
G = nx.gnm_random_graph(N, int(1.7*N), seed)
random.seed(seed)
sources = [random.randrange(N) for i in range(340//m)]
targets = [random.randrange(N) for i in range(1000//m)]
output = mp.Queue()

if __name__ == '__main__':
    test_workers()
    # test_single_worker()
    # assert set(map(tuple, test_workers())) == set(map(tuple, test_single_worker())) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T15:23:24.487

您遇到了`logging`模块的死锁。

该模块保留了一些线程锁以允许跨线程进行安全日志记录，但是当当前进程被分叉时它不能很好地发挥作用。例如，请参阅[此处](http://www.linuxprogrammingblog.com/threads-and-fork-think-twice-before-using-them)以了解正在发生的事情。

解决方案是删除`logging`调用或使用 plain `print`s 代替。

无论如何，作为一般规则，避免使用线程+分叉。并始终检查哪些模块在幕后使用线程。

请注意，在 windows 上它可以正常工作，因为 windows 没有`fork`，因此不存在锁定克隆和后续死锁的问题。在这种情况下，`MemoryError`表明该进程正在消耗过多的 RAM。您可能不得不重新考虑算法以使用更少的 RAM，但这与您在 OSX 上遇到的问题完全不同

# php - 如何在mysql数据库中获取货币汇率并更新旧汇率

> ID：14087529
> 
> 赞同：0
> 
> 时间：2012-12-30T01:34:19.253
> 
> 标签：php, mysql, sql, api

我厌倦了寻找有关如何获取货币汇率并将其定期使用 PHP 存储在我的数据库中的解决方案。我已成功连接到我的数据库，但无法更新速率。

我有一个名为 Stock_currency 的表

我也有名为 [Currency] [Spot_Rate] [Sell_Rate] [Amont] [Buy_Rate] 的列

这是我试图更改为我的解决方案的 PHP 代码

```
class CurrencyConverter {

       var $xml_file = "www.ecb.int/stats/eurofxref/eurofxref-daily.xml";
       var $localhost, $root, $root, $mohamed, $stock_currency;
       var $exchange_rates = array();

       //Load Currency Rates

       function CurrencyConverter($host,$user,$pass,$db,$tb) {

          $this->localhost = $host;
          $this->root = $user;
          $this->root = $pass;
          $this->mohamed = $db;
          $this->stock_currency = $tb;

          $this->checkLastUpdated();

          $conn = mysql_connect($this->localhost,$this->root,$this->root);

          $rs = mysql_select_db($this->mohamed,$conn);

          $sql = "SELECT * FROM ".$this->stock_currency;

          $rs =  mysql_query($sql,$conn);

          while($row = mysql_fetch_array($rs)) {

             $this->exchange_rates[$row['currency']] = $row['rate'];
          }

       }

       /* Perform the actual conversion, defaults to £1.00 GBP to USD */
       function convert($amount=1,$from="GBP",$to="USD",$decimals=2) {

          return(number_format(($amount/$this->exchange_rates[$from])*$this->exchange_rates[$to],$decimals));
       }

       /* Check to see how long since the data was last updated */
       function checkLastUpdated() {
          $conn = mysql_connect($this->localhost,$this->root,$this->root);

          $rs = mysql_select_db($this->mohamed,$conn);

          $sql = "SHOW TABLE STATUS FROM ".$this->mohamed." LIKE '".$this->stock_currency."'";

          $rs =  mysql_query($sql,$conn);

          if(mysql_num_rows($rs) == 0 ) {

             $this->createTable();
          } else {
             $row = mysql_fetch_array($rs);
             if(time() > (strtotime($row["Update_time"])+(12*60*60)) ) {

                $this->downloadExchangeRates();
             }
          }
       }

       /* Download xml file, extract exchange rates and store values in database */

       function downloadExchangeRates() {
          $currency_domain = substr($this->xml_file,0,strpos($this->xml_file,"/"));
          $currency_file = substr($this->xml_file,strpos($this->xml_file,"/"));
          $fp = @fsockopen($currency_domain, 80, $errno, $errstr, 10);
          if($fp) {

             $out = "GET ".$currency_file." HTTP/1.1\r\n";
             $out .= "Host: ".$currency_domain."\r\n";
             $out .= "User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8) Gecko/20051111 Firefox/1.5\r\n";
             $out .= "Connection: Close\r\n\r\n";
             fwrite($fp, $out);
             while (!feof($fp)) {

                $buffer .= fgets($fp, 128);
             }
             fclose($fp);

             $pattern = "{<Cube\s*currency='(\w*)'\s*rate='([\d\.]*)'/>}is";
             preg_match_all($pattern,$buffer,$xml_rates);
             array_shift($xml_rates);

             for($i=0;$i<count($xml_rates[0]);$i++) {

                $exchange_rate[$xml_rates[0][$i]] = $xml_rates[1][$i];
             }

             $conn = mysql_connect($this->localhost,$this->root,$this->root);

             $rs = mysql_select_db($this->mohamed,$conn);

             foreach($exchange_rate as $currency=>$rate) {

                if((is_numeric($rate)) && ($rate != 0)) {

                   $sql = "SELECT * FROM ".$this->stock_currency." WHERE currency='".$currency."'";
                   $rs =  mysql_query($sql,$conn) or die(mysql_error());
                   if(mysql_num_rows($rs) > 0) {

                      $sql = "UPDATE ".$this->stock_currency." SET rate=".$rate." WHERE currency='".$currency."'";
                   } else {

                      $sql = "INSERT INTO ".$this->stock_currency." VALUES('".$currency."',".$rate.")";
                   }

                   $rs =  mysql_query($sql,$conn) or die(mysql_error());
                }

             }
          }
       }

       /* Create the currency exchange table */
       function createTable() {

          $conn = mysql_connect($this->localhost,$this->root,$this->root);

          $rs = mysql_select_db($this->mohamed,$conn);

          $sql = "CREATE TABLE ".$this->stock_currency." ( currency char(3) NOT NULL default '', rate float NOT NULL default '0', PRIMARY KEY(currency) ) ENGINE=MyISAM";

          $rs =  mysql_query($sql,$conn) or die(mysql_error());

          $sql = "INSERT INTO ".$this->stock_currency." VALUES('EUR',1)";

          $rs =  mysql_query($sql,$conn) or die(mysql_error());

          $this->downloadExchangeRates();
       }

    }

    ?> 
```

我已要求兑换 1.00 英镑 £

```
<?php
   include('CurrencyConverter');
   $x = new CurrencyConverter('localhost','root','root','mohamed','Stock_Currency');
   echo $x->convert(1.00,'GBP','USD');
?> 
```

这是我收到的错误

```
( ! ) Warning: include(CurrencyConverter) [<a href='function.include'>function.include</a>]: failed to open stream: No such file or directory in C:\wamp\www\Currency.php on line 2
Call Stack
#   Time    Memory  Function    Location
1   0.0005  672752  {main}( )   ..\Currency.php:0 
```

我也不明白这个错误信息

```
( ! ) Warning: include() [<a href='function.include'>function.include</a>]: Failed opening 'CurrencyConverter' for inclusion (include_path='.;C:\php\pear') in C:\wamp\www\Currency.php on line 2
Call Stack
#   Time    Memory  Function    Location
1   0.0005  672752  {main}( )   ..\Currency.php:0 
```

这告诉我第 3 行有错误，我不明白

```
( ! ) Fatal error: Class 'CurrencyConverter' not found in C:\wamp\www\Currency.php on line 3
Call Stack
#   Time    Memory  Function    Location
1   0.0005  672752  {main}( )   ..\Currency.php:0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T01:56:22.830

错误消息非常简单：失败，因为您的目录`include('CurrencyConverter');`中没有调用文件。你的意思是？`CurrencyConverter``C:\wamp\www\``CurrencyConverter.php`

第二个错误消息也抱怨`CurrencyConverter`不存在。这次它也在PHP的扩展目录中寻找文件，但在那里找不到。

第三个错误是抱怨，`$x = new CurrencyConverter(...)`因为您从未加载过`CurrencyConverter`该类 - 我假设它在丢失的文件中。

这三个错误消息将通过包含该文件得到纠正。具有`CurrencyConverter`该类的 PHP 文件在哪里？您需要将文件名放在`include`语句中，而不是类名。

PS - 请不要使用这些`mysql_*`功能。 **它们已被弃用**。使用[mysqli](http://us2.php.net/mysqli)或[pdo](http://us2.php.net/pdo)。

# ruby-on-rails - 在 Rails 中引导 Typeahead

> ID：14087538
> 
> 赞同：2
> 
> 时间：2012-12-30T01:36:10.370
> 
> 标签：ruby-on-rails, twitter-bootstrap, autocomplete, sass

我在我的 Rails 应用程序中使用 Bootstrap-sass 和 formtastic，但我不确定为什么 bootstrap-typeahead 功能不起作用。

*表格部分：*

```
<%= f.input :tag, :input_html => { :'data-provide' => "typeahead", :'data-source' => '["hello", "hellow", "heaven", "helo", "herr"]' } %> 
```

*application.js 清单：*

```
//= require bootstrap-typeahead //typeahead is correctly loaded, checked with firebug 
```

*结果 HTML 源代码：*

```
<input :data-minLength="2" data-provide="typeahead" data-source="[&quot;hello&quot;, &quot;hellow&quot;, &quot;heaven&quot;, &quot;helo&quot;, &quot;herr&quot;]" 
```

最后，我需要自定义 typeahead 以获得我想要的性能，但即使是这个简单的 javascript 由于某种原因也无法正常工作。我找不到代码有什么问题。有人可以帮我吗？

**更新：** 我以javascript方式尝试如下：

```
<script> //call typeahead
$(function() {
    $('input#type_ahead').typeahead({
        'source' : ["hello", "heaven", "heythere"]
    });
})
</script>

<%= f.input :tag_list, :input_html => { :id => "type_ahead" }, %> //input tag 
```

而且似乎预输入仍然无法正常工作。即）输入“他”不会让我得到上述数组中这三个项目的下拉列表。有人有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:25:05.947

我认为你需要设置`html_safe`：

```
{ :'data-source' => '["hello", "hellow", "heaven", "helo", "herr"]'.html_safe } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T09:41:02.763

您是否在页面加载时调用了 typeahead() 方法？你需要做这样的事情；

```
$(function() {
  $('input').typeahead();
}) 
```

您需要为您的输入分配一个类或 id 以专门将 typeahead 绑定到它（Rails 可能已经自动为其分配了一个 id，我假设您已经专门省略了它）

```
$(function() {
  $('input#my-tag-field-with-a-cool-typeahead').typeahead();
}) 
```

编辑：

以下对我有用。需要对导轨部分进行一些修改以适应您的情况，但这绝对有效。

```
<script>
$(function() {
  $('input#type_ahead').typeahead()
}
</script>

<%= text_field_tag :test_type, '', data: {provide: 'typeahead', source: "['hello','heythere','heaven']"} %> 
```

# ruby-on-rails - 如何在 Rails 中处理 youtube 的缩略图？

> ID：14087540
> 
> 赞同：2
> 
> 时间：2012-12-30T01:36:11.940
> 
> 标签：ruby-on-rails, ruby-on-rails-3, youtube

如果用户在正文中键入 youtube url 并保存记录，我想在视图中显示其缩略图。

有什么好的技巧吗？还是好的宝石？

输入网址的示例：

```
http://www.youtube.com/watch?v=qrO4YZeyl0I 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T02:51:20.427

您是否从 URL 解析视频 ID 代码？即在你的例子中它会是`qrO4YZeyl0I`.

一旦你有了这个，你就可以用它做任何你想做的事情。每个视频生成四个缩略图。

```
http://img.youtube.com/vi/qrO4YZeyl0I/0.jpg
http://img.youtube.com/vi/qrO4YZeyl0I/1.jpg
http://img.youtube.com/vi/qrO4YZeyl0I/2.jpg
http://img.youtube.com/vi/qrO4YZeyl0I/3.jpg 
```

要简单地选择视频的默认缩略图，请使用：

```
http://img.youtube.com/vi/qrO4YZeyl0I/default.jpg 
```

有关更多详细信息，请参阅此答案 -[如何从 YouTube API 获取 YouTube 视频缩略图？](https://stackoverflow.com/questions/2068344/how-to-get-thumbnail-of-youtube-video-link-using-youtube-api)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-05T20:39:31.363

我最近需要 youtube 缩略图，所以只是更新。目前的网址看起来像：

```
http://i1.ytimg.com/vi/video_id/default.jpg
http://i1.ytimg.com/vi/video_id/mqdefault.jpg
http://i1.ytimg.com/vi/video_id/hqdefault.jpg
http://i1.ytimg.com/vi/video_id/sddefault.jpg
http://i1.ytimg.com/vi/video_id/1.jpg
http://i1.ytimg.com/vi/video_id/2.jpg
http://i1.ytimg.com/vi/video_id/3.jpg 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-30T02:49:55.310

您可以解析 url，并在保存模型之前从 youtube 获取缩略图：

宝石文件：

```
gem 'youtube_it' 
```

模型：

```
before_save :get_youtube_thumbnail

def get_youtube_thumbnail
  url = extract_url_from_body

  unless url.blank?
    client   = YouTubeIt::Client.new
    response = client.video_by(url)
    self.thumbnail = response.thumbnails.first.url
  end
end

def extract_url_from_body
  URI.extract(body).first
end 
```

看法：

```
<%= image_tag model.thumbnail, alt: model.title %> 
```

# nuget - NuGet 和可移植类库 - 包不针对任何框架

> ID：14087543
> 
> 赞同：5
> 
> 时间：2012-12-30T01:36:20.457
> 
> 标签：nuget, portable-class-library

几个月来，我一直在使用 NuGet 来管理我内部创建的程序集，它运行良好。我最近“发现”了可移植类库，它也很棒——直到安装包的时候。

假设我有一个针对 Windows 应用商店应用程序的 .NET 4.5、SL5 和 .NET 的 PCL。我运行`nuget spec`以创建 .nuspec 文件，编辑值，将其打包，然后将 .nupkg 添加到我们的内部提要中。如果我在 Package Explorer 中打开 .nupkg 文件，我会在 lib 下看到一个名为portable-win+net45+sl50 的内容文件夹。

当我尝试从另一个解决方案中的任何兼容项目安装包时，我收到以下消息：

“'Project.PCL' 无法安装，因为它与解决方案中的任何项目都不兼容。该包不针对任何框架。”

如果我在包资源管理器中手动创建 .nupkg，更新版本号，为每个目标框架添加一个 lib 文件夹（不是可移植文件夹）并将 Project.PCL.dll 添加到每个文件夹，我可以将包添加到解决方案中的兼容项目。但是每次我想更新 PCl 时都执行这个过程有点乏味（我一直在项目根文件夹中创建一个小 .cmd 文件以快速打包和部署）。

其他人有这个问题吗？如何以与其他类型项目相同的方式打包 PCL？

注意 - 我正在使用 VS 2012 Ultimate 和 NuGet 2.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T16:26:40.187

听起来可能`nuget spec`不适用于可移植类库 - 这值得在[NuGet 站点](http://nuget.codeplex.com/)上启动线程或提交问题。

但是，您也可以从 NuGet 包资源管理器创建 .nuspec 文件。只需像您已经做的那样创建包，然后选择“将元数据另存为...”以将其保存为 .nuspec。之后您可能需要手动编辑 nuspec 文件中的源路径，但您应该能够自动创建包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T00:19:21.373

对我来说，nuget spec 和 nuget pack 在创建包并将其安装在兼容项目上时可以很好地与便携式项目配合使用。
你想检查你是否有最新的 nuget.exe (2.2)，它可以从[http://nuget.org/nuget.exe](http://nuget.org/nuget.exe)下载或者可以通过运行 nuget update -self 来更新

# python - 在样条上采样到给定的最大弦偏差

> ID：14087545
> 
> 赞同：0
> 
> 时间：2012-12-30T01:36:34.903
> 
> 标签：python, numpy, scipy

我正在寻找一种对样条曲线上的点进行采样的快速方法，这样通过这些点的多边形或线串不会超过原始样条曲线的给定弦误差。我有一个我前段时间写的算法，它产生了图片中的结果（如果有兴趣，请参阅下面的代码；我不希望任何人仔细研究它）。它工作正常，但速度不是很快（在我的计算机上生成该图形大约需要 2 秒）。有没有更简单的东西，可能内置到 numpy 或 scipy 中来完成这个？

谢谢

![在此处输入图像描述](../Images/5d94ea58fde2e87bf51e1200eca4fcbd.png)

```
import numpy as np
from scipy.optimize import brentq
from scipy.interpolate import splev

def get_rhos(ts, tck):
    """Get (signed) rhos (1/rad of curvature) for a given
    set of t values.
    """
    tanvs = np.array(splev(ts, tck, der=1)).T
    accvs = np.array(splev(ts, tck, der=2)).T
    if tanvs.ndim == 1:
        tanvs = tanvs.reshape(1, -1)
        accvs = accvs.reshape(1, -1)

    crossp = np.cross(accvs, tanvs, axis=1)
    tanvms = np.array([np.sqrt(np.dot(v, v)) for v in tanvs])
    rhos = crossp / tanvms**3
    return rhos

def calc_rad(pt0, pt1, pt2, calcdrop=False):
    """Calculate a radius from three points on the arc.
    Lifted from http://www.physicsforums.com/showthread.php?t=173847
    """
    pt0 = np.array(pt0)
    pt1 = np.array(pt1)
    pt2 = np.array(pt2)

    v0 = pt1 - pt0
    v1 = pt2 - pt0
    v2 = pt2 - pt1
    a = np.sqrt(np.dot(v0, v0))
    b = np.sqrt(np.dot(v1, v1))
    c = np.sqrt(np.dot(v2, v2))
    R = (a*b*c) / np.sqrt(  2 * a**2 * b**2
                          + 2 * b**2 * c**2
                          + 2 * c**2 * a**2
                          - a**4 - b**4 - c**4)
    if calcdrop:
        # Calculate arc drop
        drop = R - np.sqrt(R**2 - (b/2.)**2)
        return R, drop
    else:
        return R

def chordal_sample(tck, chordaltol, oversample=10):
    """Given a spline definition and a chordal tolerance
    (intol/outol), get the t-values for the spline such
    that, when adjacent points are connected, the chordal
    tolerance is not violated.

    Accomplishes this by bracketing a solution, then using
    the brentq solver to find the point where the chordal
    error equals the chordal tolerance.

    Note that a few extra points may be inserted where there
    are inflections in the cubic; these are sometimes missed
    by the arc-radius-calculating portion of the code.
    """

    # This is the function we'll need when we have to
    # go searching for the answer via brentq
    def makeerrfunc(st, spt, tck, chordaltol):
        def errfunc(et):
            mt = (st + et) / 2.0
            mpt = np.array(splev(mt, tck))
            ept = np.array(splev(et, tck))
            _, arcdrop = calc_rad(spt, mpt, ept, calcdrop=True)
            diff = arcdrop - chordaltol
            return diff
        return errfunc

    # Make sure we're sampling enough points
    # TODO: How can we be sure?
    ts = np.linspace(0, 1, oversample * len(tck[1][0]))
    newts = [0]
    # Loop through the time values
    for nt in ts:
        st = newts[-1]
        rts = ts[ts > st] # Only consider remaining time values
        # Step through adjacent pairs of time values and find
        # ones that bracket the solution.
        for et0, et1 in zip(rts[0:-1], rts[1:]):
            # Get a 'middle time' that we can use to calc
            # a 'middle point' for our arc calculations
            mt0 = (st + et0) / 2.
            mt1 = (st + et1) / 2.

            # Interpolate points at the critical t values
            ipts = np.array(splev([st, mt0, et0, mt1, et1], tck))
            spt, mpt0, ept0, mpt1, ept1 = ipts.T

            _, arcdrop0 = calc_rad(spt, mpt0, ept0, calcdrop=True)
            _, arcdrop1 = calc_rad(spt, mpt1, ept1, calcdrop=True)

            # Have we bracketed the solution yet? If so, use
            # brentq to find a better one within the bracketed
            # range, then move on to a new start t.
            if arcdrop0 > chordaltol: # Check the initial pair
                errfunc = makeerrfunc(st, spt, tck, chordaltol)
                mdt = brentq(errfunc, st, et0)
                newts.append(mdt)
                break
            if arcdrop0 <= chordaltol and arcdrop1 > chordaltol:
                errfunc = makeerrfunc(st, spt, tck, chordaltol)
                mdt = brentq(errfunc, et0, et1)
                newts.append(mdt)
                break
            # Check for the existence of an inflection point
            # in the bracketed range by checking the signs
            # of the two calculated curvatures and looking for
            # a reversal.
            if get_rhos(et0, tck)[0] * get_rhos(et1, tck)[0] < 0:
                newts.append((et0 + et1) / 2.0)
                break
        if et1 == 1.0: # No more points to try
            newts.append(1.0)
            break
    return newts

if __name__ == '__main__':
    import matplotlib.pyplot as plt
    from scipy.interpolate import splprep

    # Create a hi-res sample spline. Start with some
    # low-res points and then resample at a higher
    # res.
    XY = np.array([[0.0,  1.0,  2.0, 3.0, 2.0, 1.0, 0.0],
                   [0.0, -1.0, -0.5, 0.0, 2.5, 1.2, 2.0]])
    tck, u = splprep(XY, s=0)
    XY = splev(np.linspace(0, 1, 400), tck)
    tck, u = splprep(XY, s=0)

    # Get a set of t values that will plot out
    # a linestring with no more than 0.1 chordal
    # error to the original.
    ts = chordal_sample(tck, 0.1)

    fig, ax = plt.subplots()
    # Plot the hi-res spline
    ax.plot(*XY)
    # Plot the approximated spline
    ax.plot(*np.array(splev(ts, tck)), marker='o')

    ax.axis('equal')
    ax.grid()
    plt.show() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:33:31.387

我在我最喜欢的模块之一 - Shapely 中找到了一个很好的解决方案。Shapely 几何对象有一种`simplify()`方法，它采用公差并产生相同的 0.1 值： ![在此处输入图像描述](../Images/67243623372fb428961dcda425c62ab5.png)

对我来说看起来更好，并且只用了 1.65 毫秒（对于 ~1200 倍的加速）！

# python - 是否可以在不使用原始说明符的情况下抑制 Python 对给定字符串的转义序列处理？

> ID：14087547
> 
> 赞同：4
> 
> 时间：2012-12-30T01:36:53.560
> 
> 标签：python

**结论：**不可能覆盖或禁用 Python 的内置转义序列处理，因此，您可以跳过使用原始前缀说明符。我深入研究了 Python 的内部结构来解决这个问题。因此，如果有人尝试将在复杂字符串（如正则表达式）上工作的对象设计为某种框架的一部分，请确保在文档字符串中指定对象的字符串参数`__init__()` **必须**包含`r`前缀！

**原始问题：**我发现强制 Python 不“更改”有关用户输入字符串的任何内容有点困难，其中可能包含正则表达式或转义的十六进制序列。我已经尝试过各种原始字符串组合`.encode('string-escape')`（及其解码对应项），但我找不到正确的方法。

给定文档 IPv6 地址的转义十六进制表示`2001:0db8:85a3:0000:0000:8a2e:0370:7334`，使用`.encode()`这个小脚本（称为`x.py`）：

```
#!/usr/bin/env python

class foo(object):
    __slots__ = ("_bar",)
    def __init__(self, input):
        if input is not None:
            self._bar = input.encode('string-escape')
        else:
            self._bar = "qux?"

    def _get_bar(self): return self._bar
    bar = property(_get_bar)
#

x = foo("\x20\x01\x0d\xb8\x85\xa3\x00\x00\x00\x00\x8a\x2e\x03\x70\x73\x34")
print x.bar 
```

执行时将产生以下输出：

```
$ ./x.py
 \x01\r\xb8\x85\xa3\x00\x00\x00\x00\x8a.\x03ps4 
```

请注意已`\x20`转换为 ASCII 空格字符以及其他一些字符。这基本上是正确的，因为 Python 处理了转义的十六进制序列并将它们转换为可打印的 ASCII 值。

`foo()`如果将初始化程序视为原始字符串（并`.encode()`删除调用），则可以解决此问题，如下所示：

```
x = foo(r"\x20\x01\x0d\xb8\x85\xa3\x00\x00\x00\x00\x8a\x2e\x03\x70\x73\x34") 
```

但是，我的最终目标是创建一种可以使用的框架，并且我想对最终用户隐藏这些“实现细节”。如果他们`foo()`以转义的十六进制形式（没有原始说明符）调用上述 IPv6 地址并立即将其打印回来，他们应该在不知道或使用原始说明符的情况下*准确地返回他们输入的内容。*所以我需要找到一种方法来让`foo`'`__init__()`做任何必要的处理来实现它。

**编辑：**根据[这个 SO question](https://stackoverflow.com/a/647787)，这似乎是 Python 的一个缺陷，因为它**总是**执行某种转义序列处理。似乎没有任何设施可以完全关闭转义序列处理，即使是暂时的。糟透了。我想我将不得不研究子类化`str`来创建类似的东西`rawstr`，智能地确定 Python 在字符串中处理的转义序列，并将它们转换回原来的格式。这不会很有趣...

**Edit2：**另一个例子，给定下面的示例正则表达式：

```
"^.{0}\xcb\x00\x71[\x00-\xff]" 
```

如果我将其分配给 var 或将其传递给函数**而不**使用 raw 说明符，则将`\x71`转换为 letter `q`。即使我添加`.encode('string-escape')`或`.replace('\\', '\\\\')`，转义序列**仍然被处理**。因此导致此输出：

```
"^.{0}\xcb\x00q[\x00-\xff]" 
```

我怎样才能在不使用原始说明符的情况下再次停止这种情况？是否有某种方法可以“关闭”转义序列处理或在事实`q`转回之后“恢复”它`\x71`？有没有办法在转义序列处理发生**之前处理字符串并转义反斜杠？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T04:58:28.490

我认为您对 Python 字符串文字（源代码表示）、内存中的 Python 字符串对象以及如何打印这些对象（它们可以在输出中以什么格式表示）之间的区别有一个可以理解的混淆。

如果您将文件中的一些字节读入字节串，您可以按原样将它们写回。

`r""`仅存在于源代码中，在运行时没有这样的东西，即相等`r"\x"`，`"\\x"`它们甚至可能是内存中完全相同的字符串对象。

要查看输入没有损坏，您可以将每个字节打印为整数：

```
print " ".join(map(ord, raw_input("input something"))) 
```

或者只是按原样回显（可能存在差异，但与您的`"string-escape"`问题无关）：

```
print raw_input("input something") 
```

* * *

身份功能：

```
def identity(obj):
    return obj 
```

如果您对字符串**不执行任何操作，那么您的用户将收到****完全相同的对象**。您可以在文档中提供您认为将输入字符串表示为 Python 文字的简洁易读方式的示例。如果您发现使用二进制字符串感到困惑，`"\x20\x01"`那么您可以接受 ascii 十六进制表示：（`"2001"`您可以使用 binascii.hexlify/unhexlify 将一个字符串转换为另一个字符串）。

* * *

正则表达式的情况更复杂，因为有两种语言：

1.  Python 根据其字符串文字语法解释转义序列
2.  正则表达式引擎将字符串对象解释为也有自己的转义序列的正则表达式模式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T01:58:04.673

我认为您将不得不走加入路线。

这是一个例子：

```
>>> m = {chr(c): '\\x{0}'.format(hex(c)[2:].zfill(2)) for c in xrange(0,256)}
>>>
>>> x = "\x20\x01\x0d\xb8\x85\xa3\x00\x00\x00\x00\x8a\x2e\x03\x70\x73\x34"
>>> print ''.join(map(m.get, x))
\x20\x01\x0d\xb8\x85\xa3\x00\x00\x00\x00\x8a\x2e\x03\x70\x73\x34 
```

* * *

我不完全确定你*为什么*需要它。如果您的代码需要与其他代码交互，我建议您同意定义的格式，并坚持下去。

# ssas - 在 SSAS 中，静态命名集何时优于动态命名集？

> ID：14087550
> 
> 赞同：1
> 
> 时间：2012-12-30T01:37:12.827
> 
> 标签：ssas, mdx

好的，所以这个问题是关于在分析服务器中使用动态和静态集的。据我了解，静态集是在处理多维数据集的过程中评估的，不考虑 MDX 中 WHERE 切片器中指定的任何条件。而动态集是在查询执行期间评估的。

我有一个多维数据集，其维度中包含大量客户索赔编号。如果我的客户想要查看与这些索赔编号相关的任意数量的度量，但想要查看一个范围，他们必须过滤大量的索赔编号。

为了缓解这种情况，我创建了一个动态集，它只不过将数千个数字组合成一个他们可能使用的组。问题是我已经看到使用动态集的性能大幅下降，所以我认为静态集可能足以满足这种类型的场景。

那么，如果静态集只是一组没有包含计算的维度成员，那么它就足够了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T01:08:58.907

至少静态集使 SSAS 能够缓存结果；所以你可能会得到一些性能改进，但如果可能的话，重新考虑 [Claim] 维度会更好。

# c++ - 是否以某种方式优化了对同一类成员的连续多次访问？

> ID：14087551
> 
> 赞同：2
> 
> 时间：2012-12-30T01:37:17.640
> 
> 标签：c++, optimization

在这段代码中，我连续多次访问 exitButton.rectangle，我想知道它是否经过优化，因此生成的目标代码不必每次都`exitButton`要求：`rectangle`

```
struct MenuItem {
    Rectangle rectangle;
};

MenuItem exitButton;

exitButton.rectangle.top = 383;
exitButton.rectangle.height = 178;
exitButton.rectangle.left = 0;
exitButton.rectangle.width = 1024; 
```

我需要写这样的东西来保证它是优化的吗？

```
Rectangle &tempRectangle = exitButton.rectangle;

tempRectangle.top = 383;
tempRectangle.height = 178;
tempRectangle.left = 0;
tempRectangle.width = 1024; 
```

它会是一样的，但使用一个类而不是一个结构吗？提前致谢。

**编辑**

g++ -o0，无参考：

```
 CPU Disasm
Address   Hex dump          Command                                  Comments
004013B0  /$  55            PUSH EBP                                 ; CppTest.004013B0(guessed void)
004013B1  |.  89E5          MOV EBP,ESP
004013B3  |.  83E4 F0       AND ESP,FFFFFFF0                         ; DQWORD (16.-byte) stack alignment
004013B6  |.  83EC 10       SUB ESP,10
004013B9  |.  E8 42060000   CALL 00401A00                            ; [CppTest.00401A00
004013BE  |.  C70424 7F0100 MOV DWORD PTR SS:[LOCAL.4],17F
004013C5  |.  C74424 04 B20 MOV DWORD PTR SS:[LOCAL.3],0B2
004013CD  |.  C74424 08 000 MOV DWORD PTR SS:[LOCAL.2],0
004013D5  |.  C74424 0C 000 MOV DWORD PTR SS:[LOCAL.1],400
004013DD  |.  B8 00000000   MOV EAX,0
004013E2  |.  C9            LEAVE
004013E3  \.  C3            RETN 
```

g++ -o0，参考：

```
CPU Disasm
Address   Hex dump          Command                                  Comments
004013B0  /$  55            PUSH EBP                                 ; CppTest.004013B0(guessed void)
004013B1  |.  89E5          MOV EBP,ESP
004013B3  |.  83E4 F0       AND ESP,FFFFFFF0                         ; DQWORD (16.-byte) stack alignment
004013B6  |.  83EC 20       SUB ESP,20
004013B9  |.  E8 62060000   CALL 00401A20                            ; [CppTest.00401A20
004013BE  |.  8D4424 0C     LEA EAX,[LOCAL.5]
004013C2  |.  894424 1C     MOV DWORD PTR SS:[LOCAL.1],EAX
004013C6  |.  8B4424 1C     MOV EAX,DWORD PTR SS:[LOCAL.1]
004013CA  |.  C700 7F010000 MOV DWORD PTR DS:[EAX],17F
004013D0  |.  8B4424 1C     MOV EAX,DWORD PTR SS:[LOCAL.1]
004013D4  |.  C740 04 B2000 MOV DWORD PTR DS:[EAX+4],0B2
004013DB  |.  8B4424 1C     MOV EAX,DWORD PTR SS:[LOCAL.1]
004013DF  |.  C740 08 00000 MOV DWORD PTR DS:[EAX+8],0
004013E6  |.  8B4424 1C     MOV EAX,DWORD PTR SS:[LOCAL.1]
004013EA  |.  C740 0C 00040 MOV DWORD PTR DS:[EAX+0C],400
004013F1  |.  B8 00000000   MOV EAX,0
004013F6  |.  C9            LEAVE
004013F7  \.  C3            RETN 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T02:37:46.927

在这种特殊情况下，编译器实际上不需要执行任何优化。事实上，编译器实际上可能不得不在第二种情况下更加努力地工作以生成同样高效的代码。因为为此它必须解析引用别名。

原因是因为`Rectangle`不是指针，而是直接嵌入到了`MenuItem`. 在这种情况下，编译器实际上将整个结构树视为一组平面变量。编译器根据*从 struct 开始的字节偏移量来*考虑事情。例子：

```
struct Item1 {
    int i1, i2, i3;
};
struct Item2 {
    Item1  item1;
    int    t1, t2;
}; 
```

...在内部结构上等效于：

```
struct ItemAll {
    int i1, i2, i3;
    int t1, t2;
}; 
```

在此示例中，您实际上可以在`Item2`和之间使用静态转换。`ItemAll`在任何一种情况下，如果您引用其中一个`ItemAll.i2`或`Item2::Item1.i2`编译器在内部将其视为`variable_base_address + sizeof(int)`. **这同样适用于类和结构。**

您需要关心的是当您使用 时`-> operator`，例如，如果您的结构是这样设计的：

```
struct MenuItem {
    Rectangle* rectangle;
}; 
```

在这种情况下，编译器必须执行额外的取消引用步骤来访问`Rectangle`. 启用优化后，任何现代编译器都会尽其所能优化取消引用。这不是问题。可能出现问题的地方是，如果您有很多交叉解引用，这些解引用只是超出了 cpu 上的可用寄存器：

```
struct MenuItem {
    Rectangle* rect1;
    Rectangle* rect2;
    Point*     point1;
    Point*     point2;
};

menuItem.rect1->top = 50;
menuItem.rect2->top = 50;
menuItem.point1->x  = 33;
menuItem.point2->x  = 45;

menuItem.rect1->bottom = 450;
menuItem.rect2->bottom = 450;
// etc... 
```

在上述情况下，编译器可能会用完适合用作基址寄存器的寄存器，从而迫使它冗余地重新计算取消引用以供以后使用（在此特定示例中它不会用完寄存器，因为它们正在分配立即数，但是如果涉及任何可变算术，则机会变得更高）。显然，在这种情况下，对您重新排序以使所有 rect1 分配配对等也是微不足道的。不过，如果我们做的事情比简单分配更复杂，那么这也可能是不可能的。

然而，在这种情况下，即使使用引用也无济于事。无论如何，编译器都必须以相同的方式溢出并重新加载指针取消引用。

结论：随意`Rectangle& var = menuItem.var;`用作代码简化工具。它可以使您的代码更易于维护并减少您的一些输入！但它不会帮助编译器完成它的工作，所以如果这是你的目标，请不要打扰。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T01:44:34.610

首先考虑第二个问题，类与结构没有区别（至少对于任何理智的编译器）。两者之间的唯一区别是成员的默认可访问性（类的私有，结构的公共）。

*关于确定*优化的唯一方法是查看目标代码，但我*希望*任何合理的编译器都可以确定您正在使用相同系列的引用来`exitButton.rectangle`重复访问，并自动使用寄存器来引用用于连续访问。

如果您关闭*所有*优化，情况可能并非如此，但基本上允许任何优化，您可以期待它——这种优化已经众所周知多年（它基本上是一个常见的子表达式消除）。

# javascript - 在 Rails 中访问 js 变量/值，反之亦然

> ID：14087552
> 
> 赞同：0
> 
> 时间：2012-12-30T01:37:29.817
> 
> 标签：javascript, ruby-on-rails, rating-system

所以我的问题是我需要找到一种方法来制作由下面的代码创建的图表，以将值保存到我在 rails 中创建的选票中。选票使用手动值，如最后几行代码所示，但我需要从图中获取值以提交，我还需要找出一种方法将选票中的值加载回图中。

到目前为止，我尝试了 gon gem，但没有成功，还尝试了很多其他不起作用的方法。

* * *

```
**editablegraph.html.erb**

<div class="container-fluid" id="graphT" style="width:300px;height:700px;">

<script style="text/javascript">

    var paper3 = Raphael("graphT");

    var val1T = 0 * 6;

    var val2T = 0 * 6;

    var val3T = 0 * 6;

    var val4T = 0 * 6;

    var val5T = 0 * 6;

    var begin1 = val1T;
    var begin2 = val2T;
    var begin3 = val3T;
    var begin4 = val4T;
    var begin5 = val5T;

var load = function()
{       
    paper3.clear();

    var bar1 = paper3.set();
    bar1.push(
        paper3.rect( 30, 650 - val1T, 40, val1T)
            .attr({
                fill : "80-#151515-#000", 
                opacity : .8,
                stroke : "none"
            }),
        paper3.path( paralel3( val1T, 30))
            .attr({ 
                fill : "#000",
                opacity : .6,
                stroke : "none"
            }),
        paper3.path( paralel4( val1T, 30))
            .attr({ 
                fill : "90-#151515-#000",
                opacity : 1,
                stroke : "none"
            }),
        paper3.text( 40, 630 - val1T, Math.floor(val1T/6).toString() )
            .attr({
                "font-size" : 18,
                "font-family" : "Times-Bold",
                fill: "#fff"
            })
    );

    var bar2 = paper3.set();
    bar2.push(
        paper3.rect( 86, 650 - val2T, 40, val2T)
            .attr({
                fill : "80-#151515-#39f",
                opacity : .8,
                stroke : "none"
            }),
        paper3.path( paralel3( val2T, 86))
            .attr({ 
                fill : "#39f",
                opacity : .6,
                stroke : "none"
            }),
        paper3.path( paralel4( val2T, 86))
            .attr({ 
                fill : "90-#151515-#39f",
                opacity : 1,
                stroke : "none"
            }),
        paper3.text( 96, 630 - val2T, Math.floor(val2T/6).toString() )
            .attr({
                "font-size" : 18,
                "font-family" : "Times-Bold",
                fill: "#fff"
            })
    );

    var bar3 = paper3.set();
    bar3.push(
        paper3.rect( 142, 650 - val3T, 40, val3T)
            .attr({
                fill : "80-#151515-#73b",
                opacity : .8,
                stroke : "none"
            }),
        paper3.path( paralel3( val3T, 142))
            .attr({ 
                fill : "#73b",
                opacity : .6,
                stroke : "none"
            }),
        paper3.path( paralel4( val3T, 142))
            .attr({ 
                fill : "90-#151515-#73b",
                opacity : 1,
                stroke : "none"
            }),
        paper3.text( 152, 630 - val3T, Math.floor(val3T/6).toString() )
            .attr({
                "font-size" : 18,
                "font-family" : "Times-Bold",
                fill: "#fff"
            })
    );

    var bar4 = paper3.set(); 
    bar4.push(
        paper3.rect( 198, 650 - val4T, 40, val4T)
            .attr({
                fill : "80-#151515-#ee1fa5",            
                opacity : .8,
                stroke : "none"
            }),
        paper3.path( paralel3( val4T, 198))
            .attr({ 
                fill : "#ee1fa5",
                opacity : .6,
                stroke : "none"
            }),
        paper3.path( paralel4( val4T, 198))
            .attr({ 
                fill : "90-#151515-#ee1fa5",
                opacity : 1,
                stroke : "none"
            }),
        paper3.text( 208, 630 - val4T, Math.floor(val4T/6).toString() )
            .attr({
                "font-size" : 18,
                "font-family" : "Times-Bold",
                fill: "#fff"
            })
    );

    var bar5 = paper3.set();
    bar5.push(
        paper3.rect( 254, 650 - val5T, 40, val5T)
            .attr({
                fill : "80-#151515-#26701c",
                opacity : .8,
                stroke : "none"
            }),
        paper3.path( paralel3( val5T, 254))
            .attr({ 
                fill : "#26701c",
                opacity : .6,
                stroke : "none"
            }),
        paper3.path( paralel4( val5T, 254))
            .attr({ 
                fill : "90-#151515-#26701c",
                opacity : 1,
                stroke : "none"
            }),
        paper3.text( 264, 630 - val5T, Math.floor(val5T/6).toString() )
            .attr({
                "font-size" : 18,
                "font-family" : "Times-Bold",
                fill: "#fff"
            })
        );  

start = function () {
  this.odx = 0;
  this.ody = 0;
},
move1 = function (dx, dy) {
  val1T = begin1-dy;
  this.odx = dx;
  this.ody = dy;
  load();
},
move2 = function (dx, dy) {
  val2T = begin2 - this.ody;
  this.ody = dy;
  load();
},
move3 = function (dx, dy) {
  val3T = begin3 - this.ody;
  this.ody = dy;
  load();
},
move4 = function (dx, dy) {
  val4T = begin4 - this.ody;
  this.ody = dy;
  load();
},
move5 = function (dx, dy) {
  val5T = begin5 - this.ody;
  this.ody = dy;
  load();
},
up1 = function(){
    if( val1T < 0 ) 
{
    val1T = 0;
}
else if( val1T > 600 )
{
val1T = 600;
}
    begin1 = val1T;
    document.getElementById('attra').value = Math.floor(val1T/6);
    load();
},
up2 = function(){
        if( val2T < 0 ) 
{
    val2T = 0;
}
else if( val2T > 600 )
{
    val2T = 600;
}
    begin2 = val2T;
    document.getElementById('attrb').value = Math.floor(val2T/6);
    load();
},
up3 = function(){
        if( val3T < 0 ) 
{
    val3T = 0;
}
else if( val3T > 600 )
{
    val3T = 600;
}
    begin3 = val3T;
    document.getElementById('attrc').value = Math.floor(val3T/6);
    load();
},
up4 = function(){
        if( val4T < 0 ) 
{
    val4T = 0;
}
else if( val4T > 600 )
{
    val4T = 600;
}
    begin4 = val4T;
    document.getElementById('attrd').value = Math.floor(val4T/6);
    load();
},
up5 = function(){
        if( val5T < 0 ) 
{
    val5T = 0;
}
else if( val5T > 600 )
{
    val5T = 600;
}
    begin5 = val5T;
    document.getElementById('attre').value = Math.floor(val5T/6);
    load();
}
    bar1.drag( move1, start, up1);
    bar2.drag( move2, start, up2);
    bar3.drag( move3, start, up3);
    bar4.drag( move4, start, up4);
    bar5.drag( move5, start, up5);
};
load();
</script>

<%= form_for(@ballot) do |f| %>

<%= f.hidden_field :user_id, value: current_user.id %>
<%= f.hidden_field :target_id, value: @user2.id %>

<%= f.text_field :attr_A, id: "attra" %>

<%= f.text_field :attr_B, id: "attrb" %>

<%= f.text_field :attr_C, id: "attrc" %>

<%= f.text_field :attr_D, id: "attrd" %>

<%= f.text_field :attr_E, id: "attre" %>

<% end %>

<%= link_to "Thy judgment be cast upon the unworthy", vote_path( target_user: @user2, attrA: 20, attrB: 20, attrC: 20, attrD: 20, attrE: 20, ballot: @ballot ), method: "post" %>

</div> 
```

我想我应该补充一点，这是我的第一个 Rails 应用程序。这是我完成第一个应用程序需要做的最后一件事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T09:16:57.273

那是一段很长的代码。我做了一些与您的要求非常相似的事情。我建议**JSON gem 和 json.js**从 GUI 到 rails 来回传输数据。

创建一个在浏览器端保存数据的 javascript 类。要将数据传递给 rails，您可以使用**JSON.stringify(object)**并在 ajax 调用中传递它。并在 ruby​​ 端使用**JSON.parse**以 hashmap 的形式获取数据。

将数据从 ruby​​ 传递到 javascript 时，请确保创建您在 javascript 端创建的类的对象并手动将值加载到该对象中。

我不知道gon gem。

# ios - 视频播放后语音到文本 sdk 冻结

> ID：14087555
> 
> 赞同：1
> 
> 时间：2012-12-30T01:38:04.903
> 
> 标签：ios, speech-recognition, speech, speech-to-text

我正在使用[https://github.com/todoroo/iPhone-Speech-To-Text提供的语音转文本 sdk](https://github.com/todoroo/iPhone-Speech-To-Text)

识别器工作得很好，直到我使用 MPMoviePlayerController 播放视频。这是我用来调用识别器的代码：

```
- (IBAction)actionBtRecognition:(id)sender {
    if(recognizer == nil){
       recognizer = [[SpeechToTextModule alloc] init];
    }
    [recognizer beginRecording];
} 
```

要播放电影，我使用[了本教程](http://www.techotopia.com/index.php/Video_Playback_from_within_an_iOS_5_iPhone_Application)

因此，一旦我播放电影并呼叫识别器，它就会冻结。调试sdk源码的时候，发现自己的声音没有录音。变量meterStateDB.maveragePower 总是 = -120

请注意，在我的 Mac iphone 模拟器上一切正常！但是在真实设备（iphone 4，ios 5.1.1）上会发生我上面描述的问题。也许这只是我的设备问题？

如果有人会在他自己的设备上检查同样的事情，我将不胜感激。

# oracle11g - 我可以将 Excel 工作表中的行加载到 BULK 的数据库表中吗

> ID：14087556
> 
> 赞同：0
> 
> 时间：2012-12-30T01:38:08.413
> 
> 标签：oracle11g, oracle11gr2, oracle11gr1

我必须`INSERT`在 Oracle 11g 中对一个表添加 500 行。我正在一个一个地使用以下命令。我可以一次完成所有操作吗？

例如我现在在做什么——

```
INSERT INTO bonus SELECT ename, job, sal, comm FROM emp
   WHERE comm > sal * 0.25;
...
INSERT INTO emp (empno, ename, job, sal, comm, deptno)
   VALUES (4160, 'STURDEVIN', 'SECURITY GUARD', 2045, NULL, 30);
...
INSERT INTO dept
   VALUES (my_deptno, UPPER(my_dname), 'CHICAGO'); 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:42:34.033

下载 SQL Developer。它有一个很好的功能，可以从 Excel 电子表格插入表格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T01:44:37.033

我会以 CSV 格式导出我的 Excel 表，并在编辑器中使用搜索和替换，使用正则表达式，将每行逗号分隔值替换为 INSERT 命令，然后运行这些命令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T02:33:23.477

查看**SQLLoader**。

这句话故意留白。

# javascript - 每个扩展类的唯一 ID

> ID：14087558
> 
> 赞同：0
> 
> 时间：2012-12-30T01:39:28.780
> 
> 标签：javascript, backbone.js, coffeescript

我在用 Coffeescript 编写的 Backbone 中有一个 baseCollection 和 baseModel，如下所示：

```
class Collection extends Backbone.Collection

  constructor: (attrs = {}, options = {}) ->
   return attrs if attrs instanceof Collection
   return self if self = constructorCheck attrs, options

   super attrs
   constructorCreate @, attrs, options 
```

所有模型/系列都从这些基本单元扩展而来。是否可以为从这些基类扩展的每个类创建一个 uniqueID？喜欢：

```
class Animals extends Collection --> given a uniqueID
class Monkeys extends Animals --> given a uniqueID 
```

目标是从缓存我所有模型和集合的通用集合存储中过滤集合/模型。我想按照 [本文所述重新创建模型存储](http://backstage.soundcloud.com/2012/06/building-the-next-soundcloud/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T05:21:34.770

我不确定我是否完全遵循，但我猜您正在尝试创建一种方法来跨视图访问 Animals 和 Monkeys 集合的单例实例？

如果是这种情况，这是我第一次使用咖啡脚本 - 与您正在寻找的模式不完全相同，而是咖啡/javascript中的一个选项

```
class Registry
  find: (t) ->
    lookup = @lookup ||= {}
    lookup[t] ||= new t

class People extends Backbone.Collection
class Things extends Backbone.Collection

r = new Registry

p = r.find(People)
p2 = r.find(People)
t = r.find(Things)
t2 = r.find(Things)

if p != p2 || t != t2 || p == t
  alert('failure')
else
  alert('pass') 
```

但是，为了更接近我第一次阅读它的方式来回答您的问题 - 这是您如何为每个扩展类生成唯一 id 的方法。我不完全确定这是你真正想要的，因为每个集合都是它自己的实例/不会跨视图同步（但是，相同“类型”的所有集合都将具有相同的“myId”）。

```
index = 0
lookup = {}

class MyCollection extends Backbone.Collection
  constructor: ->
    f = arguments.callee.caller
    if(lookup[f]?)
      @myId = lookup[f]
    else
      lookup[f] = index
      @myId = index
      index += 1

class People extends MyCollection
class Things extends MyCollection

p = new People()
p2 = new People()
t = new Things()
t2 = new Things()

if p.myId != p2.myId || t.myId != t2.myId || p.myId == t.myId
  alert('failure')
else
  alert('pass') 
```

我自己可能不会采用后一种方法，但它应该有效。

# jquery - 没有子对象 - ASP.net Jquery ajax post

> ID：14087560
> 
> 赞同：-1
> 
> 时间：2012-12-30T01:40:28.803
> 
> 标签：jquery, asp.net, ajax, json

该错误是由我想的数据部分引起的，但我找不到解决方案帖子失败，并且在 firefox firebug 上显示的错误是

```
There are no child objects 
```

这里的代码

```
 var PostData = '1';
        jQuery.ajax({
            type: "POST",
            url: "myASM.asmx/SetOff",
            data: PostData,
            async: true,
            contentType: "application/json; charset=utf-8",
            dataType: "json"
        }); 
```

这里是网络方法

```
[WebMethod]
public void SetOff(string prefixText)
{
    HttpContext.Current.Session["SetDisplay"] = prefixText;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:47:00.487

我相信该错误与您的“数据”参数有关。它需要一个键值对，而不仅仅是一个值。而不是“1”，它应该类似于 {“myKey”：1 } 或 myKey=1。

# python - 我的代码似乎得到了不正确的推文计数

> ID：14087561
> 
> 赞同：2
> 
> 时间：2012-12-30T01:40:30.623
> 
> 标签：python, twitter

出于某种原因，我只能从这段代码中获得 100 条推文。根据 Twitter API，我相信我应该得到 1500。

我在这里做错了什么？

具体来说，有问题的问题是：

```
twiturl = "http://search.twitter.com/search.json?q=" + urlinfo + "&rpp=99&page=15" + "&since_id=" + str(tweetdate)

for x in arg1:
                        urlinfo = x[2]
                        idnum = int(x[1])
                        name = x[0]
                        twiturl = "http://search.twitter.com/search.json?q=" + urlinfo + "&rpp=99&page=15" + "&since_id=" + str(tweetdate)
                        response = urllib2.urlopen(twiturl)
                        twitseek = simplejson.load(response)
                        twitsearch = twitseek['results']
                        tweets = [x['text'] for x in twitsearch]
                        tweetlist = [tweets, name]
                        namelist.append(tweetlist) 
```

应该在 x[2] 中的项目只是一个单词或短语，如“我是”或“我感觉”更改为 url 友好编码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T02:17:16.690

[Twitter 搜索 API](https://dev.twitter.com/docs/api/1/get/search)状态的文档：

> **rpp**（可选）：每页返回的推文数量，最多 100 条。

和

> **page**（可选）：要返回的页码（从 1 开始），最多大约 1500 个结果（基于 rpp * page）。

因此，您应该发出多个请求，每个请求都有一个不同的页码，每个请求最多 100 条推文：

```
import urllib, json

twiturl = "http://search.twitter.com/search.json?q=%s&rpp=99&page=%d"

def getmanytweets(topic):
    'Return a list of upto 1500 tweets'
    results = []
    for page in range(1, 16):
        u = urllib.urlopen(twiturl % (topic, page))
        data = u.read()
        u.close()
        t = json.loads(data)
        results += t['results']
    return results

if __name__ == '__main__':
    import pprint
    pprint.pprint(getmanytweets('obama')) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T01:47:50.500

单页结果中返回的最大结果数为 100。为了获得所有结果，您需要使用`next_page`响应中包含的 URL 来“翻页”它们（有关文档，请参见[此处](https://dev.twitter.com/docs/api/1/get/search)）。然后，您可以遍历响应，调用`next_page`每个响应的参数，直到参数不再存在（表明您已收集所有结果）。

```
import json
import urllib
import urllib2

# General query stub
url_stub = 'http://search.twitter.com/search.json'

# Parameters to pass
params = {
    'q': 'tennis',
    'rpp': 100,
    'result_type': 'mixed'
    }

# Variable to store our results
results = []

# Outside of our loop, we pull the first page of results
# The '?' is included in the 'next_page' parameter we receive
# later, so here we manually add it
resp = urllib2.urlopen('{0}?{1}'.format(url_stub, urllib.urlencode(params)))
contents = json.loads(resp.read())
results.extend(contents['results'])

# Now we loop until there is either no longer a 'next_page' variable
# or until we max out our number of results
while 'next_page' in contents:

  # Print some random information
  print 'Page {0}: {1} results'.format(
      contents['page'], len(contents['results']))

  # Capture the HTTPError that will appear once the results have maxed
  try:
    resp = urllib2.urlopen(url_stub + contents['next_page'])
  except urllib2.HTTPError:
    print 'No mas'
    break

  # Load our new contents
  contents = json.loads(resp.read())

  # Extend our results
  results.extend(contents['results'])

# Print out how many results we received
print len(results) 
```

输出：

```
Page 1: 103 results
Page 2: 99 results
Page 3: 100 results
Page 4: 100 results
Page 5: 100 results
Page 6: 100 results
Page 7: 100 results
Page 8: 99 results
Page 9: 98 results
Page 10: 95 results
Page 11: 100 results
Page 12: 99 results
Page 13: 99 results
Page 14: 100 results
Page 15: 100 results
No mas
1492 
```

# apache - 防止 Zend Server CE 在启动 Mac OS X 时加载？

> ID：14087562
> 
> 赞同：2
> 
> 时间：2012-12-30T01:40:36.677
> 
> 标签：apache, zend-framework, zend-studio

我在我的 MacBook Pro 上安装了最新版本的 Zend Server CE，我希望有人指导我如何在启动时阻止它加载。如果我选择启动它，我只希望它运行。我确定这很简单，但到目前为止，我无法在任何地方找到此信息。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T22:55:14.817

我在这里找到了答案：http: [//bit.ly/WemVm5](http://bit.ly/WemVm5)

本质上，您需要完全删除或（就像我一样）简单地注释掉里面的所有代码`ZendServer_init`；完成后，重新启动您的 Mac，Zend Server CE 将不再自动加载。

# ruby-on-rails - 将变量传递给 Jade 中的局部变量

> ID：14087564
> 
> 赞同：2
> 
> 时间：2012-12-30T01:41:16.130
> 
> 标签：ruby-on-rails, pug

在 Rails 中，我们可以通过以下方式将 varialbe 传递给 partial：

```
<%= render partial: "myPartial", locals: {:key => "value"} %> 
```

我怎么能为杰德这样做？

看来我必须`include`在 Jade 中使用它，这相当于`render`在 Rails 中。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:47:23.450

```
!=partial('myPartial', { locals: { key: 'value' } }); 
```

# java - TreeMap 中的“自然排序”是什么？

> ID：14087575
> 
> 赞同：13
> 
> 时间：2012-12-30T01:42:50.807
> 
> 标签：java, treemap

> **可能重复：**
> [如何在 Java 中对 Map 的键进行排序？](https://stackoverflow.com/questions/571388/how-can-i-sort-the-keys-of-a-map-in-java)

在课堂`TreeMap`上，Java API 说：

> 基于红黑树的 NavigableMap 实现。地图根据其键的自然顺序排序，或者由地图创建时提供的 Comparator 排序，具体取决于使用的构造函数。

自然排序是什么意思？用作键的类不必实现`Comparable`接口，但是将使用什么顺序来代替？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-30T01:53:45.487

如果你自己尝试这个，你会发现你不能使用没有实现`TreeMap`的 a （除非你通过构造函数显式地提供 a ）。`K``Comparable``Comparator``TreeMap`

```
public class App 
{
    public static void main( String[] args )
    {
        TreeMap<App,String> tm = new TreeMap<App,String>();
        tm.put(new App(), "value");
    }
} 
```

> 线程“主”java.lang.ClassCastException 中的异常：应用程序无法转换为 java.lang.Comparable

javadoc`put()`明确说明了这一点：

> **抛出：**
> ClassCastException - 如果指定的键无法与地图中当前的键进行比较

[“自然排序”的 TreeMap 的 javadocs 中](http://docs.oracle.com/javase/6/docs/api/java/util/TreeMap.html)的链接将您带到`Comparable`界面

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T01:44:40.203

“自然”排序是[`Comparable`](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html)在`TreeMap`. 本质上，RBTree 必须能够分辨哪个键小于另一个键，并且有两种方法可以将该逻辑提供给 RBTree 实现：

*   [`Comparable`](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html)在用作键的类中实现接口`TreeMap`，或
*   提供一个[`Comparator`](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)可以在键类本身之外进行比较的实现。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-30T01:56:15.453

这**是**实施的要求`Comparable`。它只是在编译时没有强制执行。

```
jamlong% cat Wah.java

import java.util.*; 

public class Wah {

    public static void main(String[] args) {
        TreeMap<Wah, Integer> wah = new TreeMap<Wah, Integer>(); 
        wah.put(new Wah(), 1); 
        wah.put(new Wah(), 2);
    } 
}

jamlong% java Wah

Exception in thread "main" java.lang.ClassCastException: Wah cannot be cast to java.lang.Comparable
    at java.util.TreeMap.put(TreeMap.java:542)
    at Wah.main(Wah.java:8) 
```

如有疑问，[请阅读`TreeMap`来源](http://www.docjar.com/html/api/java/util/TreeMap.java.html)。例如，第 541 行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-30T01:55:17.900

自然排序只是`Comparable`接口提供的顺序。您可以创建`TreeMap`不带 a 的 a `Comparator`，但是任何尝试放置任何未实现自然顺序的键都会抛出 a `ClassCastException`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T01:43:52.697

自然顺序由键确定。

因此，如果您使用字符串，您将获得一个排序；整数将给出另一个。

我认为 Comparable 是一个要求。

# java - 使用 JTextField 提示输入输出

> ID：14087578
> 
> 赞同：-5
> 
> 时间：2012-12-30T01:43:09.823
> 
> 标签：java, swing, jtextfield, readline

我正在尝试提示来自 JTextField 的输入。也就是说，我想要类似于 的东西`String input = console().readLine()`，它等到输入给出，然后使用该字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T01:46:36.353

将一个附加`ActionListener`到文本字段。`ActionEvent`s 在`Enter`被按下时生成，而文本字段具有焦点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T02:28:22.900

您可以使用模式对话框来提示用户。这将暂停应用程序，直到对话框关闭。

查看[如何使用对话框](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html#input)，了解如何自定义`JOptionPane`

# android - ArrayList 或 SQLite

> ID：14087580
> 
> 赞同：2
> 
> 时间：2012-12-30T01:43:41.313
> 
> 标签：android, sqlite, arraylist

在 Android 中存储数据方面，使用大型 ArrayList 或设置 SQLite 数据库会更有效吗？我有大约 9000 个巴士站和站名（都在字符串中）需要存储，我想知道哪种方法最快或最有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:00:20.547

ArrayList 可能是一个非常糟糕的主意。我假设您希望数据是持久的，因此如果您的用户杀死您的应用程序，如果您使用 ArrayList，您的数据将会丢失。数据库是持久的（除非用户清除应用程序的缓存）。所以我强烈建议在 ArrayList 上使用数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:31:13.847

1.) 因为您需要持久性，所以从 SQLite DB 存储和检索您的数据。而且由于您说您有 9k+ 行，因此一个简单的选择将立即为您提供所有内容，并且如果需要，您也可以轻松过滤数据

2.) 在启动时，将所有数据放入高效的内存结构中，如 HashMaps（或在您的情况下为数组列表），并在整个应用程序中引用它们。这样，您只会进行一次访问。

3.) 如有疑问，请建立数据库。无害，比文件更高效、更容易处理

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T02:15:33.307

如果您的数据没有更改，那么您可能会在启动时读取它并在应用程序运行时将其保存在内存中。例如，拥有一个包含所有停止的 .json 文件，在启动时读取它，将数据放入 HashMap 或易于使用的东西，因为您可能会查找内容。它可能适用于约 9000 个条目。

如果您要在使用期间添加或更新有关停靠点的信息，那么 SQLite 是更好的选择。

# umbraco - Umbraco - 分类的终极选择器

> ID：14087584
> 
> 赞同：0
> 
> 时间：2012-12-30T01:44:05.080
> 
> 标签：umbraco, categorization

我正在为 umbraco 做一个简单的项目，我需要一个类别部分。这就是我开始为类别创建页面的原因。在网站中，我使用终极选择器来选择类别。到目前为止，一切都很好，我可以看到我在网站页面中选择的类别。

```
Websites
- XXX
- YYY
- ZZZ
- ...
Categories
- Fashion
- Electronics
- ... 
```

我的问题是在时尚类别页面下列出所有时尚选择的网站。我找不到任何例子。如果你能在这件事上帮助我，我会很高兴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T09:44:52.303

您使用的是哪个版本的 Umbraco？如果您使用的是支持 Razor 脚本的版本，那么您可以创建一个并执行以下操作：

```
@inherits umbraco.MacroEngines.DynamicNodeContext
@using umbraco;
@using umbraco.MacroEngines;
@{    
  var node = Library.NodeById(identifierOfFashionNode);
  foreach (var child in node.Children) {
    // do something with the children of the fashion category
  }
} 
```

实际实现可能会因您的版本而异，这恰好适用于 4.7.2。

# php - 两个或多个 PHP 框架可以一起使用吗？

> ID：14087585
> 
> 赞同：1
> 
> 时间：2012-12-30T01:44:07.990
> 
> 标签：php, codeigniter, zend-framework, frameworks

> **可能重复：**
> [在一个网站上使用多个 php 框架](https://stackoverflow.com/questions/11786649/using-multiple-php-frameworks-on-one-website)

我想第一次开始构建一个 Web 应用程序。我至少擅长 PHP，但想使用一个框架（请不要气馁）。我搜索了大多数 PHP 框架，发现 Zend 和 CodeIgniter 最适合我的项目。我可以在同一个 Web 应用程序中同时使用两个或多个框架吗？如果是，有什么优点和缺点？？...请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:49:25.523

我认为没有人应该阻止你使用框架：它会为你省去很多麻烦，尽管它会引入少量的复杂性。有关详细信息，请参见例如[http://symfony.com/doc/2.0/book/from_flat_php_to_symfony2.html](http://symfony.com/doc/2.0/book/from_flat_php_to_symfony2.html) :)（是的，我喜欢 symfony）。

现在大多数严肃的框架都设计得很好，它们可以让你使用其他设计得很好的框架的一部分（我认为 symfony 使用来自 zend 的位）。话虽这么说，框架有点复杂，我会说你最好一次只使用一个，如果绝对必要的话，*可以在以后扩展。*

# gdb - 调试服务器 [proftpd]

> ID：14087589
> 
> 赞同：1
> 
> 时间：2012-12-30T01:44:40.087
> 
> 标签：gdb, exploit

我正在尝试调试proftpd，以便更好地理解这个漏洞[http://www.phrack.org/issues.html?issue=67&id=7](http://www.phrack.org/issues.html?issue=67&id=7)。易受攻击的部分在 mod_sql.c 中，我试图断点 sql_prepare_where 函数（这是堆溢出完成的地方），然后调用 USER ... 和 PASS ... 命令，但它从未被触发。

为了找出为什么我在 mod_sql.c 的数百行都有断点，然后启动程序（带有完整的调试选项），触发了一些断点（sql_setuserinfo、set_sqlauthenticate、get_auth_entry ...）但仅在启动的最开始进程，然后当程序进入主循环时，不会发生其他与断点相关的事情（而 proftpd 的日志中提到 USER 和 PASS 命令被分派到 mod_sql.c）..

有人知道我错过了什么吗？

[我可能错过了 GDB 的一些基本内容，我正在学习 :) ]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:56:38.313

服务器程序通常使用“每个连接单独程序”的方法，其中成功后`accept`，父`fork`级由子级处理当前连接，并返回`accept`更多连接。

我不确定，但如果`proftpd`使用该模型，它将准确解释您描述的症状。

您可以使用`(gdb) set follow-fork-mode child`.

# javascript - 动态 JQuery 调整大小

> ID：14087592
> 
> 赞同：1
> 
> 时间：2012-12-30T01:45:12.403
> 
> 标签：javascript, jquery, responsive-design

我正在使用一个响应式设计网站，更具体地说是一个包含多个 Div 的页面。当您重新调整网页大小时，div 的宽度会随着它们设置为百分比而变化。由于高度必须保持不变，除非 div 会消失，否则我必须设置断点来更改高度。如果我不改变高度，它会保持不变并在下面的 div 之间添加“边距”。本质上，我的逻辑是：当窗口重新调整大小并且宽度小于 810px 时，然后删除所有 CSS 样式，并添加边距顶部，项目 2 到无穷大。由于这很难通过写作来解释，所以我在最后添加了以下代码。

当我重新调整浏览器窗口的大小并且内容 div 小于 810px 时，样式不会被删除。查看我的代码，罪魁祸首可能是什么？

该函数位于第 27-50 行：[https ://github.com/jdmagic21/coded_container/blob/master/work.js](https://github.com/jdmagic21/coded_container/blob/master/work.js)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T02:04:18.733

您应该考虑使用 CSS 媒体查询来根据浏览器的宽度更改样式，而不是使用 Javascript。

[这是一个教程 - Google 上的热门文章之一“如何使用 CSS 媒体查询”](http://www.htmlgoodies.com/beyond/css/introduction-to-css-media-queries.html)

[这是媒体查询的浏览器兼容性表。只要不要太在意IE8或之前的版本就可以！](http://caniuse.com/css-mediaqueries)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:40:27.357

您可以使用 CSS 媒体查询来做到这一点。

```
@media screen and (max-width: 810px) {
     /* reset the styles of the divs here */
} 
```

# linux - 如何在 Linux 中安装 urwfonts-8.71.tar.bz2？

> ID：14087595
> 
> 赞同：-1
> 
> 时间：2012-12-30T01:45:40.920
> 
> 标签：linux, fonts, installation, centos, centos5

我已经下载了这套免费的 80 种标准字体，但我不确定如何在我的 Linux 机器（CentOS 5.4）中安装它。任何建议将不胜感激！

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:46:36.253

这是[CentOS 的字体指南](http://www.centos.org/docs/5/html/Deployment_Guide-en-US/s1-x-fonts.html)。

基本上，您将字体解压缩到`/usr/share/fonts/local`（如有必要，创建文件夹），然后调用`fc-cache /usr/share/fonts/local`.

# python - Python 3 ImportError：没有名为“ConfigParser”的模块

> ID：14087598
> 
> 赞同：369
> 
> 时间：2012-12-30T01:46:32.750
> 
> 标签：python, python-3.x

我正在尝试打包，但我得到了`pip install`一个.`MySQL-python``ImportError`

```
Jans-MacBook-Pro:~ jan$ /Library/Frameworks/Python.framework/Versions/3.3/bin/pip-3.3 install MySQL-python
Downloading/unpacking MySQL-python
  Running setup.py egg_info for package MySQL-python
    Traceback (most recent call last):
      File "<string>", line 16, in <module>
      File "/var/folders/lf/myf7bjr57_jg7_5c4014bh640000gn/T/pip-build/MySQL-python/setup.py", line 14, in <module>
        from setup_posix import get_config
      File "./setup_posix.py", line 2, in <module>
        from ConfigParser import SafeConfigParser
    ImportError: No module named 'ConfigParser'
    Complete output from command python setup.py egg_info:
    Traceback (most recent call last):

  File "<string>", line 16, in <module>

  File "/var/folders/lf/myf7bjr57_jg7_5c4014bh640000gn/T/pip-build/MySQL-python/setup.py", line 14, in <module>

    from setup_posix import get_config

  File "./setup_posix.py", line 2, in <module>

    from ConfigParser import SafeConfigParser

ImportError: No module named 'ConfigParser'

----------------------------------------
Command python setup.py egg_info failed with error code 1 in /var/folders/lf/myf7bjr57_jg7_5c4014bh640000gn/T/pip-build/MySQL-python
Storing complete log in /Users/jan/.pip/pip.log
Jans-MacBook-Pro:~ jan$ 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：451
> 
> 时间：2014-06-01T10:35:25.347

您可以改为使用该[`mysqlclient`](https://pypi.python.org/pypi/mysqlclient)包作为 MySQL-python 的替代品。它是一个分支，`MySQL-python`增加了对 Python 3 的支持。

我很幸运

```
pip install mysqlclient 
```

在我的python3.4 virtualenv之后

```
sudo apt-get install python3-dev libmysqlclient-dev 
```

这显然是 ubuntu/debian 特有的，但我只是想分享我的成功:)

* * *

## 回答 #2

> 赞同：435
> 
> 时间：2012-12-30T02:12:13.697

在 Python 3 中，[`ConfigParser`](https://docs.python.org/2/library/configparser.html)已重命名为以[`configparser`](https://docs.python.org/3/library/configparser.html)符合 PEP 8。您正在安装的软件包似乎不支持 Python 3。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2014-08-05T09:42:37.617

这是应该在 Python 2.x 和 3.x 中都可以使用的代码

显然，您将需要该`six`模块，但几乎不可能编写在没有六个版本的情况下在两个版本中都工作的模块。

```
try:
    import configparser
except:
    from six.moves import configparser 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2018-04-09T22:00:58.553

```
pip install configparser
sudo cp /usr/lib/python3.6/configparser.py /usr/lib/python3.6/ConfigParser.py 
```

然后尝试再次安装 MYSQL-python。这对我有用

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-07-22T14:29:41.020

python3 不支持 MySQL-python 而不是这个，你可以使用**[mysqlclient](https://pypi.python.org/pypi/mysqlclient#downloads)**

如果您正在`fedora/centos/Red Hat`安装以下软件包

1.  `yum install python3-devel`
2.  `pip install mysqlclient`

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-12-12T07:33:11.707

如果你使用的是 CentOS，那么你需要使用

1.  `yum install python34-devel.x86_64`
2.  `yum groupinstall -y 'development tools'`
3.  `pip3 install mysql-connector`
4.  `pip install mysqlclient`

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2018-03-09T12:29:16.030

Python 2/3 for 的兼容性`configparser`可以简单地通过`six`库来解决

```
from six.moves import configparser 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2019-02-26T02:54:42.733

我遇到了同样的问题。事实证明，我需要在我的 centos 上安装 python3 devel。首先，您需要搜索与您的系统兼容的软件包。

```
yum search python3 | grep devel 
```

然后，将软件包安装为：

```
yum install -y python3-devel.x86_64 
```

然后，从 pip 安装 mysqlclient

```
pip install mysqlclient 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2019-05-01T18:58:51.317

做`pip3 install PyMySQL`然后`pip3 install mysqlclient`。为我工作

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-05-27T17:14:34.370

我进一步了解 Valeres 的回答：

> pip install configparser sudo cp /usr/lib/python3.6/configparser.py /usr/lib/python3.6/ConfigParser.py 然后尝试再次安装MYSQL-python。这对我有用

我建议链接文件而不是复制它。保存更新。我将文件链接到`/usr/lib/python3/`目录。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2021-06-29T06:28:53.083

附加信息：

**蟒蛇 2x**

```
import ConfigParser 
```

**蟒蛇 3x**

```
import configparser 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-05-26T20:16:38.537

试试[这个](https://stackoverflow.com/a/50546125/6069796)对我来说很好的解决方案。

基本上是从**brew重新安装/升级到最新版本的****mysql**，然后安装or从而不是.**`mysqlclient``MySQL-Python``global pip3``virtualenv pip3`**

 **然后访问`virtualenv`并成功安装`mysqlclient`或`MySQL-Python`。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2020-09-14T13:03:18.747

我仍然有这个问题，所以我转到 /usr/lib/python3.8 并输入 sudoer：

```
cp configparser.py ConfigParser.py 
```

您可能有另一个 Python 版本而不是 3.8。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-09-25T14:42:04.560

对我来说，以下命令有效：

```
sudo python3 -m pip install mysql-connector 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-09-06T12:14:39.023

如何首先检查您正在使用的 Python 版本。

```
import six
if six.PY2:
    import ConfigParser as configparser
else:
    import configparser 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-01-06T10:39:14.830

我运行 kali linux-Rolling 并遇到了这个问题，当我尝试在终端中运行 cupp.py 后，更新到 python 3.6.0。经过一些研究和试验，我发现改变 `ConfigParser`为 `configparser`对我有用，但后来我遇到了另一个问题。

`config = configparser.configparser() AttributeError: module 'configparser' has no attribute 'configparser'`

经过更多研究后，我意识到对于 python 3 `ConfigParser`已更改为， `configparser`但请注意它有一个属性 `ConfigParser()`。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-04-29T15:08:36.857

我在 Mac OS 10、Python 3.7.6 和 Django 2.2.7 上遇到了同样的错误。在尝试了许多解决方案后，我想借此机会分享对我有用的方法。

脚步

1.  [从链接](https://dev.mysql.com/downloads/connector/python/)安装了适用于 Mac OS 的 Connector/Python 8.0.20

2.  将当前依赖项复制到 requirements.txt 文件中，停用当前虚拟环境，并使用删除它；

    如果尚未创建文件，请创建文件；`touch requirements.txt`

    将依赖项复制到文件；`python -m pip3 freeze > requirements.txt`

    停用和删除当前的虚拟环境；`deactivate && rm -rf <virtual-env-name>`

3.  创建另一个虚拟环境并使用激活它；`python -m venv <virtual-env-name> && source <virtual-env-name>/bin/activate`

4.  使用安装以前的依赖项；`python -m pip3 install -r requirements.txt`

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-10-21T08:02:45.623

在[@MaciejNg](https://stackoverflow.com/a/38994435/16936415)之后，我尝试制作一个副本，但没有成功：

```
sudo cp ./env/lib/python3.8/site-packages/configparser.py ./env/lib/python3.8/site-packages/ConfigParser.py 
```

因为`configparser.py`和`ConfigParser.py`是相同的，所以我重命名了文件：

```
sudo mv ./env/lib/python3.8/site-packages/configparser.py ./env/lib/python3.8/site-packages/ConfigParser.py 
```

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2015-12-17T11:35:28.867

请看`/usr/bin/python`指向什么

如果它指向`python3 or higher` 更改为`python2.7`

这应该可以解决问题。

我收到所有 python 包的安装错误。Abe Karplus 的解决方案和讨论给了我关于可能是什么问题的提示。然后我回想起我手动将`/usr/bin/python`from更改`python2.7`为`/usr/bin/python3.5`，这实际上是导致问题的原因。曾经我`reverted`也一样。它得到了解决。

* * *

## 回答 #20

> 赞同：-3
> 
> 时间：2016-08-17T10:44:19.353

这对我有用

```
cp /usr/local/lib/python3.5/configparser.py /usr/local/lib/python3.5/ConfigParser.py 
```**

# c++ - 无法复制 std::vector > 使用统一初始化。它是否正确？

> ID：14087600
> 
> 赞同：11
> 
> 时间：2012-12-30T01:46:36.057
> 
> 标签：c++, c++11, initializer-list

以下代码无法在 GCC 4.7.2 或 Clang 3.2 中编译：

```
#include <vector>
#include <functional>

int main()
{
   std::vector<std::function<void()>> a;
   std::vector<std::function<void()>> b{a};
} 
```

问题是编译器将尝试使用 initializer_list 创建 b，而显然它应该只是调用复制构造函数。然而，这似乎是理想的行为，因为标准说 initializer_list 构造函数应该优先。

此代码适用于其他 std::vector，但对于 std::function，编译器无法知道您是否需要 initializer_list 构造函数或另一个构造函数。

似乎没有办法解决它，如果是这种情况，那么您永远不能在模板代码中使用统一初始化。这将是一个巨大的耻辱。

另一方面，Visual Studio（2012 年 11 月 CTP）并没有抱怨这一点。但是目前对 initializer_list 的支持不是很好，所以它可能是一个错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-30T12:29:38.170

这是[LWG 2132](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3473.html#2132)，它还不是缺陷报告，但有明确的共识（和实施经验）来修复它。标准规定`std::function`' 的构造函数将接受任何类型，因此如果可行的话，初始化列表构造函数总是比其他构造函数更受欢迎，因此您的代码会尝试从`std::initializer_list<std::function<void()>>`具有从 object 初始化的单个元素的 a构造向量`a`。然后会导致错误，因为尽管您可以`std::function<void()>`从`a`结果对象构造 a 是不可调用的。

换句话说，问题在于`std::function`有一个不受约束的模板构造函数，允许从任何类型进行转换。这会导致您的情况出现问题，因为如果可行，初始化列表构造函数比其他构造函数更受欢迎，并且不受约束的`function`构造函数意味着始终可以`initializer_list<function<void()>>`从任何类型创建一个，因此初始化列表构造函数始终是可行的。

提议的 2132 解决方案阻止`std::function`从不可调用的类型构造 a，因此初始化列表构造函数不可行，`vector`而是调用了复制构造函数。 [我为 GCC 4.8 实现了该解决方案](http://gcc.gnu.org/ml/libstdc++/2012-04/msg00083.html)，并且它也已经在 Clang 的 libc++ 库中实现了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T01:58:27.963

我看不出任何不应该编译的原因，并且 gcc（版本 4.8.0 20121111）和 clang（版本 3.3（主干 171007））都编译了代码。也就是说，“统一初始化”远非统一：在调用构造函数时肯定存在不能使用大括号的情况。

# matlab - 在matlab中交换矩阵的两列

> ID：14087602
> 
> 赞同：2
> 
> 时间：2012-12-30T01:46:48.413
> 
> 标签：matlab

有没有办法在 matlab 中交换两列，以便可以在一个语句中完成？我知道`A(:,[i,j])=A(:,[j,i])`可以完成这项工作。但我希望它是形式`swap_column(A, i, j)`。是否有这样的内置或仅使用内置的简单操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T08:20:44.953

两种可能：

1.  如果您同意，`A=swap_cols(A,i,j);`那么您只需编写一个函数

    ```
    `function A = swap_cols(A,i,j)
    assert( i > 0 && i < size(A,2) && j > 0 && j < size(A,2) );
    A(:,[i j]) = A(:,[j i]);` 
    ```

`*   如果你想要一个没有输出参数的类似“操作符”的函数，那么你可能想要这样的东西：

    ```
    `function swap_cols(Astr,i,j)
    m = evalin('caller', sprintf('size(%s,2);', Astr));
    assert( i > 0 && i < m && j > 0 && j < m );
    evalin('caller', sprintf('%s(:,[%d %d] = %s(:,[%d,%d]);', Astr, j, i, Astr, i, j) );` 
    ```` 

 ``**您使用矩阵的名称**调用此函数，而不是矩阵本身：

> swap_cols('A', i, j);

干杯!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-07-02T19:24:09.190

permute 在 Matlab 中完成工作

```
A = permute(A,[2 1]); 
`````

# php - 下载 php composer 依赖项的更好方法

> ID：14087605
> 
> 赞同：6
> 
> 时间：2012-12-30T01:47:00.347
> 
> 标签：php, build-process, composer-php

我一直在 JAVA 中使用 maven 并开始使用 PHP Maven，最近我切换到了 composer。

我的项目使用 Zend Framework 2，团队只签入应用程序代码，而不是供应商目录中的任何内容。这样做是为了避免冲突并且不让库在 SVN 下。

现在，每次开发人员设置他或她的新环境时，我们观察到，作曲家从互联网上提取依赖项。这需要相当长的时间。

有没有更好的想法/方法来加快速度或以不同的方式处理项目以避免这个问题？

maven 使用 maven 代理服务器，可以缓存下载，可以再次在网络中使用，但是我们有什么解决方案来处理这样的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T07:56:44.243

Composer 是一个非常年轻的项目，因此可能会缺少一些东西，例如 Maven 可以轻松完成。

[您可以按照composer docs](http://getcomposer.org/doc/05-repositories.md#packagist)中的描述设置您自己的 Packagist 服务器。我相信 packagist 有一些缓存选项，可用于在 packagist 服务器上存储包。

您还可以做的是分叉您的依赖项并将它们推送到公司拥有的私有存储库。在您的 composer.json 中，您现在将只使用此依赖项，从而加快克隆速度。当然，这需要您维护所有不同的依赖项（尽管这可以通过脚本和 cronjob 完成，从 github 存储库中提取数据并将其推送到您的公司拥有）。

我也相信作曲家有一些代理选项，但我不认为这些是为了缓存依赖项。

最后一个选择是开发类似的东西，作为作曲家/打包师的一部分或作为独立的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-04T10:23:18.007

在 PHP 中，有一个现有的选项可以在本地运行像 repo 这样的作曲家，它在这里被称为 Satis（它实际上是由 Composer 提供的）：[https ://github.com/composer/satis](https://github.com/composer/satis)

因此，您可以在您的服务器上本地运行它，并让您的作曲家将其用作默认作曲家存储库，Satis 确保所有已安装的包和不同版本都作为 ZIP 文件缓存在磁盘上，因此与总是从以下位置下载它们相比，可以更快地检索它们互联网。

你可以这样做：

```
{
    "repositories": [ 
        { 
            "type": "composer", 
            "url": "http://satis.example.org/" 
        }
    ],
    "require": {
        "company/package": "1.2.0",
        "company/package2": "1.5.2",
        "company/package3": "dev-master"
    }
} 
```

这还允许您拥有私有包和库，而无需在 GitHub 上公开它们。

另一个巨大的优势是当 GitHub 由于任何原因出现故障时，您仍然可以部署，因为所有依赖项都在本地缓存。这是假设您没有向发行版添加新的、不存在的包。

# php - Laravel 验证未显示错误

> ID：14087608
> 
> 赞同：1
> 
> 时间：2012-12-30T01:47:17.023
> 
> 标签：php, laravel

这可能是一个简单的修复......但我无法让验证工作。

我已经简化了我的测试回到这个......

```
 $input = array(
       'name' => ''
    );

    $rules = array(
       'name' => 'required|min:3|max:50|alpha'

    );

    $v = Validator::make($input, $rules); 
```

即使“名称”是必需的并且具有所有其他规则，验证器也不包含任何错误。

```
dd($v->errors); // returns NULL 
```

然而

```
dd($v->fails()); // returns bool(true) 
```

为什么没有错误信息？当我转储整个 $v 对象时，任何地方都看不到任何消息。非常困惑...帮助表示赞赏。谢谢。

- - 编辑

我进一步简化了这一点。我把这个直接放在测试中...

```
<?php

$input = array(
   'name' => ''
);

$rules = array(
   'name' => 'required'
);

$v = Validator::make($input, $rules);

dd($v);

?> 
```

我仍然遇到完全相同的问题？

这是 $v 对象

```
object(Laravel\Validator)#32 (9) {

  ["attributes"]=>
  array(1) {
    ["name"]=>
    string(0) ""
  }
  ["errors"]=>
  NULL
  ["rules":protected]=>
  array(1) {
    ["name"]=>
    array(1) {
      [0]=>
      string(8) "required"
    }
  }
  ["messages":protected]=>
  array(0) {
  }
  ["db":protected]=>
  NULL
  ["bundle":protected]=>
  string(11) "application"
  ["language":protected]=>
  NULL
  ["size_rules":protected]=>
  array(4) {
    [0]=>
    string(4) "size"
    [1]=>
    string(7) "between"
    [2]=>
    string(3) "min"
    [3]=>
    string(3) "max"
  }
  ["numeric_rules":protected]=>
  array(2) {
    [0]=>
    string(7) "numeric"
    [1]=>
    string(7) "integer"
  }
} 
```

我的安装/设置中有什么东西坏了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T02:11:41.513

在出现任何错误之前，您必须测试您的验证器。尝试这个：

```
if ($v->fails()) {
  dd($v->errors);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T02:11:56.773

我认为您需要先调用`$v->passes`or `$v->fails`，以便它实际评估您的验证规则并生成错误。然后你可以使用...

```
dd($v->errors->all()); 
```

# python - Pygame 中的平滑键盘移动

> ID：14087609
> 
> 赞同：7
> 
> 时间：2012-12-30T01:47:19.847
> 
> 标签：python, animation, pygame, sprite, game-physics

当按下箭头键时，我正在使用此代码让玩家精灵在屏幕上移动：

```
import pygame, sys, time
from pygame.locals import *

pygame.init()

FPS=30
fpsClock=pygame.time.Clock()

width=400
height=300
DISPLAYSURF=pygame.display.set_mode((width,height),0,32)
pygame.display.set_caption('Animation')
background=pygame.image.load('bg.png')

UP='up'
LEFT='left'
RIGHT='right'
DOWN='down'

sprite=pygame.image.load('down.png')
spritex=200
spritey=130
direction=DOWN

pygame.mixer.music.load('bgm.mp3')
pygame.mixer.music.play(-1, 0.0)
while True:
    DISPLAYSURF.blit(background,(0,0))

    DISPLAYSURF.blit(sprite,(spritex,spritey))

    for event in pygame.event.get():
        if event.type==QUIT:
            pygame.quit()
            sys.exit()

        if event.type == KEYDOWN:
            if (event.key == K_LEFT):
                spritex-=5
                sprite=pygame.image.load('left.png')
            elif (event.key == K_RIGHT):
                spritex+=5
                sprite=pygame.image.load('right.png')
            elif (event.key == K_UP):
                spritey-=5
                sprite=pygame.image.load('up.png')
            elif (event.key == K_DOWN):
                spritey+=5
                sprite=pygame.image.load('down.png')

    pygame.display.update()
    fpsClock.tick(FPS) 
```

图像能够实际移动，但按下键时只有 5 个像素。我希望图像在按住键时继续移动（并添加与窗口的基本碰撞检测，但这是一个不同的问题）。按下键时，什么会使图像继续移动？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T02:17:26.623

我建议使用变量来跟踪哪些箭头键被按下，哪些没有。您可以使用`KEYDOWN`和`KEYUP`事件来更新变量。然后，您可以根据按下的键来调整每帧精灵的位置。这也意味着您可以通过更改每帧移动的距离来轻松设置精灵在不同方向上的速度。

编辑：

或者正如@monkey 建议的那样，您可以改用[key.get_pressed()](http://www.pygame.org/docs/ref/key.html#pygame.key.get_pressed)。

这是一个未经测试的示例：

```
while True:
    DISPLAYSURF.blit(background,(0,0))

    DISPLAYSURF.blit(sprite,(spritex,spritey))

    for event in pygame.event.get():
        if event.type==QUIT:
            pygame.quit()
            sys.exit()

        if event.type == KEYDOWN:
            if (event.key == pygame.K_LEFT):
                sprite=pygame.image.load('left.png')
            elif (event.key == pygame.K_RIGHT):
                sprite=pygame.image.load('right.png')
            elif (event.key == pygame.K_UP):
                sprite=pygame.image.load('up.png')
            elif (event.key == pygame.K_DOWN):
                sprite=pygame.image.load('down.png')

    keys_pressed = pygame.key.get_pressed()

    if keys_pressed[pygame.K_LEFT]:
        spritex -= 5

    if keys_pressed[pygame.K_RIGHT]:
        spritex += 5

    if keys_pressed[pygame.K_UP]:
        spritey -= 5

    if keys_pressed[pygame.K_DOWN]:
        spritey += 5

    pygame.display.update()
    fpsClock.tick(FPS) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-20T11:35:42.497

我建议使用 set_repeat 函数。持有的键会定期生成多个事件（由函数的参数设置）。这允许您使用未经修改的代码（不需要额外的变量）。

函数原型：

set_repeat（延迟，间隔）

第一个参数 delay 是发送第一个重复的 pygame.KEYDOWN 之前的毫秒数。之后，另一个 pygame.KEYDOWN 将每间隔毫秒发送一次。如果没有传递参数，则禁用键重复。

只需在主循环之前使用此函数。

```
 pygame.key.set_repeat(10,10) 
```

来源： http: [//www.pygame.org/docs/ref/key.html#pygame.key.set_repeat](http://www.pygame.org/docs/ref/key.html#pygame.key.set_repeat)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T02:21:14.057

我是这样做的：

```
import pygame, sys, time
from pygame.locals import *

pygame.init()

FPS=30
fpsClock=pygame.time.Clock()

width=400
height=300
DISPLAYSURF=pygame.display.set_mode((width,height),0,32)
pygame.display.set_caption('Animation')
background=pygame.image.load('bg.png')

UP='up'
LEFT='left'
RIGHT='right'
DOWN='down'

sprite=pygame.image.load('down.png')
spritex=200
spritey=130
direction=None

def move(direction, sprite, spritex, spritey):
    if direction:
        if direction == K_UP:
            spritey-=5
            sprite=pygame.image.load('up.png')
        elif direction == K_DOWN:
            spritey+=5
            sprite=pygame.image.load('down.png')
        if direction == K_LEFT:
            spritex-=5
            sprite=pygame.image.load('left.png')
        elif direction == K_RIGHT:
            spritex+=5
            sprite=pygame.image.load('right.png')
    return sprite, spritex, spritey

pygame.mixer.music.load('bgm.mp3')
pygame.mixer.music.play(-1, 0.0)
while True:
    DISPLAYSURF.blit(background,(0,0))

    DISPLAYSURF.blit(sprite,(spritex,spritey))

    for event in pygame.event.get():
        if event.type==QUIT:
            pygame.quit()
            sys.exit()

        if event.type == KEYDOWN:
            direction = event.key
        if event.type == KEYUP:
            if (event.key == direction):
                direction = None
    sprite, spritex, spritey = move(direction, sprite, spritex, spritey)

    pygame.display.update()
    fpsClock.tick(FPS) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T02:21:13.463

我会通过在循环内采取稍微不同的行动来做到这一点。

要更新精灵，我会首先检查一个`KEYDOWN`事件，然后`direction`根据它进行设置。然后，我会更新`sprite`,`spritex`和`spritey`基于`direction`. 然后，如果合适的话，我会检查`KEYUP`事件并`direction`根据它进行设置。

这是我可能的编码方式：

```
sprite=pygame.image.load('down.png')
spritex=200
spritey=130
direction='down'

dir_from_key = {
  K_LEFT: 'left',
  K_RIGHT: 'right',
  K_UP: 'up',
  K_DOWN: 'down'
}

pygame.mixer.music.load('bgm.mp3')
pygame.mixer.music.play(-1, 0.0)
while True:
    DISPLAYSURF.blit(background,(0,0))

    DISPLAYSURF.blit(sprite,(spritex,spritey))

    # Get all the events for this tick into a list
    events = list(pygame.event.get()) 

    quit_events = [e for e in events if e.type == QUIT]
    keydown_events = [e for e in events if e.type == KEYDOWN 
                                           and e.key in dir_from_key]
    keyup_events = [e for e in events if e.type == KEYUP 
                                         and e.key in dir_from_key]

    # If there's no quit event, then the empty list acts like false
    if quit_events:
        pygame.quit()
        sys.exit()

    # Non-last key down events will be overridden anyway
    if keydown_events:
      direction = dir_from_key[keydown_events[-1].key]

    # Change location and image based on direction
    if direction == 'left':
      spritex-=5
      sprite=pygame.image.load('left.png')
    elif direction == 'right':
      spritex+=5
      sprite=pygame.image.load('right.png')
    elif direction == 'up':
      spritey-=5
      sprite=pygame.image.load('up.png')
    elif direction == 'down':
      spritey+=5
      sprite=pygame.image.load('down.png')

   # If there's a keyup event for the current direction.
   if [e for e in keyup_events if dir_from_key[e.key] == direction]:
      direction = None

   pygame.display.update()
   fpsClock.tick(FPS) 
```

# r - 是什么意思 。在聚合函数中？

> ID：14087610
> 
> 赞同：5
> 
> 时间：2012-12-30T01:47:25.133
> 
> 标签：r

> **可能重复：**
> [以下 R 摘录中的句号是什么意思？](https://stackoverflow.com/questions/6951090/what-does-the-period-mean-in-the-following-r-excerpt)

在汇总帮助文件中：

```
Dot notation:  
aggregate(. ~ Species, data = iris, mean)  
aggregate(len ~ ., data = ToothGrowth, mean) 
```

这里是什么意思`.` ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T01:48:34.167

它的意思是“所有其他变量”。也就是说，公式中不存在的那些数据变量。

在第一个表达式中，这些是`Sepal.Length`, `Sepal.Width`, `Petal.Length`，`Petal.Width`可以通过运行命令看到：

```
aggregate(. ~ Species, data = iris, mean)  
     Species Sepal.Length Sepal.Width Petal.Length Petal.Width
1     setosa        5.006       3.428        1.462       0.246
2 versicolor        5.936       2.770        4.260       1.326
3  virginica        6.588       2.974        5.552       2.026 
```

这个语句是等价的：

```
aggregate(cbind(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width) ~ Species, data = iris, mean) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-30T01:50:07.863

从[`?formula`](http://stat.ethz.ch/R-manual/R-devel/library/stats/html/formula.html)

> '.' 有两种特殊的解释。在一个公式中。通常的一个是在模型拟合函数的“数据”参数的上下文中，意思是“公式中没有的所有列”：参见“terms.formula”。在“update.formula”的上下文中，*only*表示“公式的这一部分之前的内容”。

# javascript - 我如何使用调用或应用方法检查该对象的实例

> ID：14087616
> 
> 赞同：-1
> 
> 时间：2012-12-30T01:49:16.513
> 
> 标签：javascript

```
function User(first, last){
  if ( !(this instanceof arguments.callee) )
    return new User(first, last);

  this.name = first + " " + last;
}

var name = "Resig";
var user = User("John", name);

assert( user, "This was defined correctly, even if it was by mistake." );
assert( name == "Resig", "The right name was maintained." ); 
```

要检查是否使用 new 运算符创建了实例，我们在构造函数中执行这些操作。

```
if ( !(this instanceof arguments.callee) ) 
```

或者

```
if ( !(this instanceof ___) ) 
```

或者

```
if ( !(this instanceof User) ) 
```

我在这个论坛上读到 arguments.callee 已贬值，我们必须使用 apply 或 call 方法。

如何使用 call 或 apply 方法检查该对象的实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T01:59:13.183

我认为您显示的最后一个选项是查看构造函数是否用 new 调用的正确方法。但是，我个人并不喜欢这个过程。它鼓励开发人员在没有 new 运算符的情况下调用构造函数。

# java - 如何在声明java中初始化点数组

> ID：14087620
> 
> 赞同：1
> 
> 时间：2012-12-30T01:50:58.930
> 
> 标签：java, arrays, collections

我想知道如何在声明点数组时对其进行初始化。我在想它会类似于

```
int[] num = {4,7,8}; 
```

但是我意识到点具有 x 和 y 值，那么您将如何对点数组执行上述操作？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-30T01:52:22.037

考虑做类似的事情：

```
Point[] myPoints = {
  new Point(1, 2),
  new Point(3, 4)
} 
```

这是通用参考数组的一个特例。

```
MyType[] myTypeArray = {
   new MyType(...),
   new MyType(...),
   // .... etc
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T01:52:58.707

你的意思是，像

```
int[][] num = new int[][] {
    new int[] {1, 2, 3},
    new int[] {4, 5, 6},
    new int[] {7, 8, 9},
};

int x = 1, y = 0;

System.out.println( num[y][x] );  // -> 2 
```

?

# java - 在 Linux 上，Java 在打开套接字时发出反向 DNS 查找。为什么，我该如何阻止它？

> ID：14087634
> 
> 赞同：3
> 
> 时间：2012-12-30T01:54:31.647
> 
> 标签：java, linux, dns

我们在 Linux wrt Java DNS 查找上遇到了一个非常奇怪的行为（更新：Mac OS X 上也发生了——我错了）。

我们将 Google 公共 DNS 服务器 8.8.8.8 设置为 JVM DNS 服务器。然而，系统 (/etc/resolv.conf) 服务器仍然是标准服务器 ghost.di.unimi.it。

当使用 InetAddress.getAllByName() 或 DNSJava 的 Addess.getAllByName() 查找地址时，一切都按预期工作（特别是，这是 DNSJava）：

```
01:39:11.832438 IP nexus.law.di.unimi.it.33195 > google-public-dns-a.google.com.domain: 46509+ A? www.uffa.com。(30)
01:39:11.832820 IP nexus.law.di.unimi.it.52782 > ghost.di.unimi.it.domain: 42740+ PTR？8.8.8.8.in-addr.arpa。(38)
01:39:11.833510 IP ghost.di.unimi.it.domain > nexus.law.di.unimi.it.52782: 42740 1/2/0 PTR google-public-dns-a.google.com。(128)
01:39:11.865165 IP google-public-dns-a.google.com.domain > nexus.law.di.unimi.it.33195: 46509 1/0/0 A 208.87.35.103 (46)

```

如您所见，我们解析 www.uffa.com，然后出于身份验证目的进行 8.8.8.8 的反向查找（在第一次查找时仅发生一次）。此时，www.uffa.com 的 IP 地址已被缓存，如果我们在 TTL 内再次调用，则不会发生任何查找。

尽管如此，当我们实际尝试使用 Apache HTTP 组件的 DefaultHttpClient 在 www.uffa.com 上打开一个套接字时，我们会看到：

```
01:40:06.892383 IP nexus.law.di.unimi.it.53977 > ghost.di.unimi.it.domain: 22255+ PTR？103.35.87.208.in-addr.arpa。(44)
01:40:07.204359 IP ghost.di.unimi.it.domain > nexus.law.di.unimi.it.53977:22255 1/2/2 PTR 208-87-35-103.securehost.com。(154)

```

也就是说，Java（或机器上的其他东西）正在将 www.uffa.com 的地址反向查找*到我们的系统服务器*，而不是谷歌的服务器。使用 URL.openConnection().getContent() 也会发生同样的情况。

我们使用 BTrace 来检测 InetAddress/Address 代码，并且没有执行可能暗示反向 DNS 查找的调用。

坦率地说，我们甚至不知道要寻找什么。

我们的大问题是我们正在编写一个高性能爬虫，虽然我们尝试仔细调整 DNS 查找的速度，但我们无法调整这种反向查找的速度，因为它们是在打开套接字时执行的，这发生在抓取数以千计的线程。

附加信息，wget 也执行反向 DNS 查找，但端口 80 上的 nc（当然没有提供任何信息）没有。

像往常一样，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T03:30:20.763

最后，唯一真正的问题是我没有给 tcpdump 提供 -n 选项。我观察到的反向查找只是 tcpdump 的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T08:51:31.213

反向 DNS 查找由 SecurityManager 完成，您无法禁用它们。

# apache - 设置我的 crontab 不起作用。我一定是把它放在了错误的地方。设置它的正确位置在哪里？

> ID：14087637
> 
> 赞同：0
> 
> 时间：2012-12-30T01:55:54.447
> 
> 标签：apache, crontab

前几天我编辑了我的 crontab 文件，但旧设置仍在运行。

我正在使用 Apache。所以我去了

```
/etc/crontab 
```

我保存了它。但是旧的 crontab 仍在运行。这不是编辑 crontab 的地方吗？我哪里做错了？

谢谢！

这是我的 grep cron：

```
[root]# ps aux | grep cron
root      1396  0.0  0.4   3000   704 pts/0    S+   21:12   0:00 grep cron
root      8114  0.0  0.5   4412   968 ?        Ss    2011   0:02 crond 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T01:57:58.113

这可能是其他一些板的问题，但答案是您不直接编辑 cron 文件，您使用工具“crontab”作为可执行文件。运行 man crontab 或 Google crontab。

```
EDITOR=emacs (or vim or whatever) to set you editor first.

crontab -e 
```

编辑

```
crontab -l 
```

列出当前的 cron 任务

# javascript - 如何使用另一个 onclick 事件触发包装在一个事件中的代码

> ID：14087643
> 
> 赞同：1
> 
> 时间：2012-12-30T01:57:24.607
> 
> 标签：javascript, jquery

将此代码包装在 HOVER 事件中...

```
$("#div_ID").hover(function() {
  // perform stuff here...
}
); 
```

当我使用 ONCLICK 事件单击链接时，我想触发上述内容...

```
$("anchor_ID").click (function() {
 $("div_ID").trigger('hover'); // Not sure if this is even correct
}
); 
```

但它不起作用。我怎样才能做到这一点？甚至可能吗？仅在 FF v16、IE8 和 GC v23 上使用 JQuery

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:01:45.630

这个怎么样：

```
var dosomething = function() {
    // perform the stuff here
}

$('#div_ID').hover(dosomething);
$('anchor_ID').click(dosomething); 
```

但是如果你打算使用`.trigger`，你的问题可能是你`#`之前忘记包含了`div_ID`。并更改`hover`为`mouseenter`（jQuery 中的“悬停”功能只是“mouseenter”的快捷方式——感谢@FabrícioMatté 捕捉到这一点）即：

```
//change this:
$('div_ID').trigger('hover');
//To this:
$('#div_ID').trigger('mouseenter'); 
```

同样可能适用于`anchor_ID`，但除非您发布您的 HTML，否则我不会知道。

**更新**：@FabrícioMatté 的另一个建议：当您如上所示调用它时，`this`内部的关键字可能会有点混乱，所以请注意它。关键字`dosomething`的工作方式与 using 不同，所以它只是一个提示....`this``.trigger`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T02:07:41.613

`hover`不是一个事件，所以你不能[`trigger`](http://api.jquery.com/trigger/)。[`.hover()`](http://api.jquery.com/hover/)只是附加`mouseenter`和`mouseleave`处理程序的简写。

```
$("#anchor_ID").click(function() {
    $("#div_ID").trigger('mouseenter');
}); 
```

[**小提琴**](http://jsfiddle.net/AhEuq/)

请注意，`.hover`当传递单个参数时，会将函数附加到两者`mouseenter`，`mouseleave`因此您可以触发其中任何一个。如果您打算仅在用户将
鼠标[`mouseenter`](http://api.jquery.com/mouseenter/)移到.`hover``div`

# android - 如何将 mp3 添加到铃声偏好列表中？

> ID：14087646
> 
> 赞同：2
> 
> 时间：2012-12-30T01:57:51.033
> 
> 标签：android, mp3, ringtone

我有一个包含一些 mp3 资源的隐藏目录，我想让这些 mp3 文件显示在我的警报应用程序中。如何将我的 mp3 文件添加到 ringtonePreference 的铃声列表中？

我在下面尝试过，但似乎不起作用。

```
@Override
protected void onPrepareRingtonePickerIntent(Intent ringtonePickerIntent) {
    super.onPrepareRingtonePickerIntent(ringtonePickerIntent);
    ringtonePickerIntent.putExtra(RingtoneManager.EXTRA_RINGTONE_EXISTING_URI, Uri.parse("file:///hidden_directory/mp3/test.mp3"));

} 
```

# sql - SQL 选择/加入性能 (PHP, PDO)

> ID：14087650
> 
> 赞同：0
> 
> 时间：2012-12-30T01:58:11.100
> 
> 标签：sql, select, join

从以下方式设置的两个表中获取数据的最**有效方法是什么：**

## 表格1：

```
ID(PK)  |  Name  |  Age
--------------------------
 1      |  Jim   |  44
 2      |  Jane  |  35
 3      |  John  |  22 
```

## 表 2

```
Name(PK)  |  Pet(PK)
-----------------
Jim       |  Cat
Jim       |  Dog
Jane      |  Fish 
```

表 2 中的 FK 对“名称”有一个约束

## 结果

**我想要特定人的年龄和所有宠物。**

```
Name  |  Age  |  Pet
---------------------
Jim   |  44   |  Cat
Jim   |  44   |  Dog 
```

在我看来，这些是我的选择：

1）在 Name 上左连接表 2，并在我的 Name 和 Age 的结果数组中得到冗余数据（如上）。

2）使用将宠物变成逗号分隔列表的功能。

3）使用2个单独的选择。

我的问题与上述 3 个选项的性能有关。我不需要 SQL（特别是，除非您想建议另一种方法）。

谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2016-03-16T12:14:31.497

```
 select 
  tb01.name, tb01.age, tb02.pet
  from 
  table01 tb01
  left join table02 tb02 on tb02.name = tb01.name 
```

# mysql - SQL WHERE 子句：x 和 x 之间的年龄在哪里？

> ID：14087656
> 
> 赞同：0
> 
> 时间：2012-12-30T02:00:48.673
> 
> 标签：mysql, where-clause

> **可能重复：**
> [如何根据出生日期和 getDate() 计算年龄（以年为单位）](https://stackoverflow.com/questions/1572110/how-to-calculate-age-in-years-based-on-date-of-birth-and-getdate)

有谁知道我如何设置 where 子句，通过从出生日期计算年龄，只获取 26-33 岁的用户？

我以前用它来获取所有 25 岁以下的用户，现在我只是想知道我是否可以使用它来获取 26-33 岁的用户，或者是否有更好的方法？

```
AND DOB >= ADDDATE(CURRENT_DATE(), INTERVAL -25 YEAR) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:05:34.820

```
AND DOB BETWEEN ADDDATE(CURRENT_DATE(), INTERVAL -33 YEAR) AND ADDDATE(CURRENT_DATE(), INTERVAL -26 YEAR) 
```

（作为建议 - 未经测试）

# facebook - 通过 API：如何获取锁定或设置为私有的 Facebook 相册的公开共享链接？

> ID：14087662
> 
> 赞同：0
> 
> 时间：2012-12-30T02:01:30.633
> 
> 标签：facebook, facebook-graph-api, facebook-fql

有没有办法通过**Facebook API (graph/fql) 获取***Facebook 相册的***公共** 链接，可以与不在 Facebook 上的人共享？

 ***此专辑不可公开访问。它受用户设置的相册共享权限的限制。但我正在寻找一种方法来生成此受限相册的公共链接，以便发送此链接的任何人都可以无条件地查看相册。

*我知道这可以*通过Facebook 网站上的“**共享相册”**功能通过“共享对话框”实现：您可以通过提供链接将此相册发送给朋友或亲戚。

我在 Graph API 中找不到解决方法。

编辑：我说的是通过 facebook 上的此功能可用的公共链接：facebook.com/help/124590517619792

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T13:58:58.580

您没有提供示例或测试用例，也没有提供任何可使用的 API 代码。我将以 Facebook 用户名**Hostess**的以下链接为例（*Twinkies 万岁！*）：

**主要：[https](https://www.facebook.com/Hostess)**
**://www.facebook.com/Hostess相册：[https ://www.facebook.com/Hostess/photos_albums](https://www.facebook.com/Hostess/photos_albums)**

首先，我们需要 Facebook 用户*编号*。
您可以执行`GET`请求或在浏览器中输入：
**Facebook 用户信息： http: [//graph.facebook.com/Hostess](http://graph.facebook.com/Hostess)**

为了继续这个例子，我们将使用上一步提供的 Facebook 号码：
**Facebook ID：[145369525544570](https://graph.facebook.com/?ids=145369525544570)**

> 有没有办法通过 Facebook API (graph/fql) 获取 Facebook 相册的公共链接，可以与不在 Facebook 上的人共享？

是的，有办法！此链接将为您提供`json`所有专辑的结果，在本例中为 6：
**Facebook 专辑，来自`json`： http: [//graph.facebook.com/145369525544570/albums](http://graph.facebook.com/145369525544570/albums)**

要限制返回的结果，您可以使用`?limit=1`（其中 1 是返回的专辑数量）：
**Facebook Album (1) via `json`：[http ://graph.facebook.com/145369525544570/albums?limit=1](http://graph.facebook.com/145369525544570/albums?limit=1)**

> 此专辑不可公开访问。它受用户设置的相册共享权限的限制。但我正在寻找一种方法来生成此受限相册的公共链接，以便发送此链接的任何人都可以无条件地查看相册。

你运气不好，没有办法。但是，您无需成为 Facebook 会员即可查看相册中的图像。**当相册公开时，可以**使用`json`上一步中的数据。只需使用一个简单的请求：**`GET`**

 **[**jsFiddle DEMO：来自 Facebook ID 的 Facebook 相册链接**](http://jsfiddle.net/GPuH7/)

```
// Console log messages are provided, activate your browsers console.

$.ajax({
  url: 'http://graph.facebook.com/145369525544570/albums',
  dataType: "json",
  success: function(yourVar) {

    // Make sure the request, 1 json object, was returned.
    if (yourVar) {

      console.log('This is the jQuery Object received. Click on it to explore contents');
      console.log(yourVar);

      // This will parse the Objects received in 'data' variable.
      // Having said that, it's coincidental the data the wrapped in a 'data' name.
      $(yourVar.data).each(function(index) {

        // Only process Objects that have valid Album links.
        // Having said that, only Photo Albums are returned in initial data, not Video Albums.
        if(this.link){

          // Display in console the jQuery zero indexed number
          console.info('Album Index object: ' + index);
          //
          // Display in HTML via append, the same information.
          $('body').append('<b>Album Index Object: </b>' + index + '<br />');

          // Display in console the Album Names available
          console.info('Name: ' + this.name);
          //
          // Display in HTML via append, the same information.
          $('body').append('<b>Name: </b>' + this.name + '<br />');

          // Display in console the Album Name Url;
          console.log('Url: ' + this.link);
          //
          // Display in HTML via append, the same information.
          $('body').append('<b>Url: </b>' + this.link + '<br />');

          // Display in console dashed lines before next item is shown.
          console.log('-------');
          //
          // Display in HTML via append, the same information.
          $('body').append('<hr><br /><br />');

        }

      });

    } else {
        console.log('Was data expected? Check your jQuery or JavaScript for errors.');
    }
  }

});

// Power-Tip!
// You can also use .ajax() with a YQL Rest Query url.
// See YQL Console with Rest Statement at: 
// http://developer.yahoo.com/yql/console/?q=SELECT%20data.link%20FROM%20json%20WHERE%20url%3D%22https%3A%2F%2Fgraph.facebook.com%2F145369525544570%2Falbums%22&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys
// As seen there, the   data.link   is providing just the links.
// Change   data.link   to   *   to see all data nodes available in json tree.
// That being said, your .ajax() url for above is at the bottom: The Rest Query. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T05:28:26.743

## *详细：为什么它不能完成。（否则就是安全问题！！！）*

**照片和相册的 Facebook 设置：**
[*当我分享内容时，我如何选择谁可以看到它？*](http://www.facebook.com/help/?faq=120939471321735)

上面的 Facebook 文档指出，如果相册通过**Only Me**设置为 Private ，那么它只会对您可用，***即使您可能有一个可共享的链接。***

为了证明相册/照片确实被锁定且不可共享，这里是使用**Yahoo!进行的实际现场测试。查询语言**以对锁定的相册执行请求：

[![](../Images/70a4af78991f8377e8c0208bd6cf6671.png)](http://y.ahoo.it/BABrr "单击图像到 YQL 实时请求")

随意点击图片访问上面的 YQL 声明。

可以肯定的是，上面的示例本身表明链接不是问题，真正的主题是**内容**，因为这是需要 Facebook 令牌密钥的锁定项目。*****

# git - 从本地文件夹创建远程 git repo

> ID：14087667
> 
> 赞同：7
> 
> 时间：2012-12-30T02:02:52.553
> 
> 标签：git

我认为必须有一种更简单的方法来做到这一点。现在我发现自己遵循以下步骤：

**在遥控器上：**

```
mkdir my_repo
cd my_repo
git init --bare 
```

**然后在本地：**

```
mv my_repo old_my_repo
git clone ssh://myserver/my_repo
mv old_my_repo/* my_repo
rmdir old_my_repo
cd my_repo
git add .
git commit -m 'foo'
git push origin master 
```

有什么捷径吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-30T02:07:31.513

不幸的是，几乎所有步骤都是必需的，即使在本地您可以通过克隆来避免重新创建 repo。

只需初始化 repo 并添加一个遥控器

```
cd my_repo
git init
git remote add origin ssh://myserver/my_repo
git add .
git commit -m "Initial commit"
git push -u origin master 
```

请注意，该`-u`选项将添加跟踪参考，因此稍后您可以简单地键入`git push`而不是`git push origin master`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-15T01:32:38.867

Gabriele 的回答几乎对我有用。

在`git push -u origin master`a之前`git init --bare my_repo`需要在`ssh:://myserver`指向的目录中调用。

# c++ - 为什么我不能用列表初始化来初始化 std::vector

> ID：14087668
> 
> 赞同：6
> 
> 时间：2012-12-30T02:03:32.693
> 
> 标签：c++, c++11

为什么这不起作用？

```
#include <vector>

struct A {
   template <typename T> void f(const std::vector<T> &) {}
};

int main() {

   A a;

   a.f({ 1, 2, 3 });

} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-30T02:09:56.867

您*可以*`std::vector<T>`使用列表初始化来初始化。但是，您不能使用参数列表中的 a来*推断*模板参数，并将非 a 的东西传递给函数。例如，这有效：`T``std::vector<T>``std::vector<T>`

```
#include <vector>

template <typename T>
struct A {
   void f(const std::vector<T> &) {}
};

int main() {

    A<int> a;

   a.f({ 1, 2, 3 });

} 
```

# c# - C# 中带有构造函数的 AsyncResult 类

> ID：14087682
> 
> 赞同：0
> 
> 时间：2012-12-30T02:06:50.500
> 
> 标签：c#, asp.net, iasyncresult

我希望实例化一个 AsyncResult 对象，但在.Net Frameowork 中似乎没有可以实例化的带有构造函数的 AsyncResult 类。

有人可以在 C# 中提供 IAsynResult 接口的现成实现吗？还是有一些技巧方法来实例化 AsyncResult 对象？

**编辑 1：** 我正在 ASP.Net 页面中创建一个异步任务。在开始方法中，我调用了一个名为“AsyncBeginGetSummary”的数据层静态方法。

**我通常会在此静态方法中使用 ADO.Net BeginExecuteReader，它可以完美运行，并且我不需要实例化 AsyncResult 对象。**但是，如果数据对象存在于 ASP.Net 应用程序的缓存中，那么从“AsyncBeginGetSummary”的这个静态方法中，我不想调用 BeginExecuteReader。

但是，我仍然需要返回 AsyncResult 对象，以便可以调用 ASP.Net 中任务的 End 方法。我的 ASP.Net 页面代码如下所示。

```
 IAsyncResult BeginAsyncOperation1(object sender, EventArgs e, AsyncCallback cb,
                                                           object state)
    {
         //call a static method from DAL that returns IAsyncResult.
         //call 'AsyncBeginGetSummary' static method in DAL
    }

    void EndAsyncOperation1(IAsyncResult ar)
    {
        //call a static method in DAL that gets your data here 
        //call 'AsyncEndGetSummary' static method in DAL
    } 
```

**编辑 2：** 我有以下内容，我不需要为实例化 AsyncResult 对象而烦恼，因为我使用虚拟方法委托来调用 BeginInvoke。

```
 IAsyncResult BeginAsyncOperation1(object sender, EventArgs e, AsyncCallback cb, object state)
    {
         //call a static method from DAL that return IAsyncResult. 
         if((Cache["abc"] !=null)
         {
             return (new dummy(DummyMethod)).BeginInvoke(cb, new FinalDataForDocumentsSummary(listFromCache.Count, listFromCache));
         } 

        return NFM.Data.Mappers.DocumentsSummaryByProgramDataMapper.AsyncBeginEndDocumentsSummaryByProgramAll( vendorId, cb);

    }

    void EndAsyncOperation1(IAsyncResult ar)
    {
        //call a static method in DAL that gets your data here

    }

    public delegate void dummy();

    private void DummyMethod()
    {
    } 
```

**编辑 3：**我在 WCF 中使用了以下 AsyncResult 实现。我想我也可以在 ASP.Net 中使用它。

```
 class AsyncResult<T> : IAsyncResult
{
    private T data;
    private object state;
    private bool isCompleted = false;
    private AutoResetEvent waitHandle;
    private bool isSynchronous = false;

    public T Data
    {
        set { data = value; }
        get { return data; }
    }

    public AsyncResult(bool synchronous, object stateData)
    {
        isSynchronous = synchronous;
        state = stateData;
    }

    public void Complete()
    {
        isCompleted = true;
        ((AutoResetEvent)AsyncWaitHandle).Set();
    }

    public object AsyncState
    {
        get { return state; }
    }

    public WaitHandle AsyncWaitHandle
    {
        get
        {
            if (waitHandle == null)
                waitHandle = new AutoResetEvent(false);

            return waitHandle;
        }
    }

    public bool CompletedSynchronously
    {
        get
        {
            if (!isCompleted)
                return false;
            else
                return isSynchronous;
        }
    }

    public bool IsCompleted
    {
        get { return isCompleted; }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T02:43:47.753

听起来你想要一个`IAsyncResult`指示同步完成的 - 结果已经可用。

在这种情况下，您可以创建自己的简单类，该类返回`true`for`IsCompleted`和`CompletedSynchronously`，并返回调用者的参数 in`AsyncState`和`null`for `WaitHandle`。

如果您希望调用者能够使用`WaitHandle`，您需要创建一个`ManualResetEvent`并在某个时候处理它；看到[这篇文章](http://msdn.microsoft.com/en-us/magazine/cc163467.aspx)。

# python - 嵌入在 C++ 中的 Lua 是否能够具有持久的局部变量？如果没有，是否有脚本语言可以做到？

> ID：14087686
> 
> 赞同：2
> 
> 时间：2012-12-30T02:08:11.123
> 
> 标签：python, scripting, lua, v8, luabind

我使用 LuaBind 在我的 C++ 应用程序中嵌入了 Lua。我需要有在多次运行中持续存在的变量，运行相同文件名的其他对象无法访问这些变量。

例如：假设我有一个名为`NPC`. An`NPC`包含一个字符串，即它们运行的​​脚本的名称。创建an 时，`NPC`会创建一个名为 的变量`Health`。当一个`NPC`被击中时，他们会失去 5 点生命值。脚本在 Lua 中是这样的：

```
local health = 10

function onHit()
    health = health - 5
end 
```

我遇到的问题是每个`NPC`运行这个脚本的人都没有自己的健康实例。例如，假设我创建`NPC A`，并从其生命值中减去 5。然后，我创建`NPC B`. 因为它会将生命值重置为 10，所以如果我告诉`NPC A`打印生命值，它会返回 10，即使它应该是 5。

如果我要为每个对象使用不同的 Lua 实例，那么它会以这种方式工作，但在这种情况下，我会一次得到数百个实例，我知道这不是一件好事。

有没有办法让变量在 Lua 中像这样工作？如果没有，是否有一种脚本语言可以有效地像这样工作？

作为参考，这是我正在测试的代码：

卢阿：

```
local health = 10;

function onHit()
    health = health - 5
    print_out(health)
end 
```

C++：

```
class NPC
{
public:
   NPC(lua_State* inState);
   void onHit();

   const char* behavior;
   lua_State* luaState;  
};

NPC::NPC(lua_State* inState)
{
   luaState = inState;
   behavior = "testBehavior.lua";
   luaL_dofile(luaState, behavior);
}

void NPC::onHit()
{    
   luaL_loadfile(luaState, behavior); 
   luabind::call_function<int>(luaState, "onHit");
}

void print_out(int number) {
   cout << "Health : " << number << endl;
}

int main() 
{
   lua_State *myLuaState = luaL_newstate();
   luabind::open(myLuaState);

   luabind::module(myLuaState) [
      luabind::def("print_out", print_out)
   ];

   NPC test(myLuaState);
   NPC test2(myLuaState);
   test.onHit();
   test2.onHit();
   test.onHit();

   lua_close(myLuaState);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T05:05:26.677

您可以查看 Lua 的[闭包](http://www.lua.org/pil/6.1.html)。它看起来像这样：

```
function healthPoints()
    local health = 10
    return function()
        health = health - 5
        return health
    end
end 
```

发生的情况是，每个 NPC 都有自己的功能和自己的计数器。每次它们被击中时，您只需调用该`onHit`函数。你会像这样使用它：

```
npc1.onHit = healthPoints()
npc2.onHit = healthPoints()
npc1.onHit() -- Now at 5, while npc2 is still at 10 
```

您可以像这样添加参数：

```
function healthPoints(hp)
    local health = hp
    return function(dmg)
        health = health - dmg
        return health
    end
end

npc1.onHit = healthPoints(100)
npc1.onHit(-12) 
```

我认为值得一试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-30T21:30:41.930

> 作为参考，这是我正在测试的代码：

这里有很多错误。你不断地重新运行你的 Lua 脚本；这就是它不断重置的原因。另一个问题是您的脚本正在创建一个*全局*函数，因此每次运行它时，您都会得到一个*新*的全局函数，该函数使用一个*新* `local`变量。

停止使用全局变量。每个 NPC 都是一个*单独*的对象。因此，它需要具有特定于对象的数据。

```
behavior = "testBehavior.lua";
luaL_dofile(luaState, behavior); 
```

这不会创建任何特定于对象的数据。它只是运行一个 Lua 脚本并完全丢弃任何返回值。除非该脚本实际上全局存储了特定于对象的东西，否则不会创建任何特定于对象的数据。

您的 Lua 脚本需要做的是返回一个表，*其中包含*脚本对对象所需的特定于对象的数据。脚本应如下所示：

```
local function onHit(self)
    self.health = self.health - 5
end

return {
  health = 10,
  onHit = onHit,
} 
```

您的 C++ 代码需要将此表*存储*在 NPC 类中，然后使用它。这可以通过 Luabind 调用轻松完成。您的构造函数应如下所示：

```
NPC::NPC(lua_State* L)
{
    behavior = "testBehavior.lua";
    int err = luaL_loadfile(L, behavior);
    //Handle compiler errors. DON'T FORGET THIS!
    luabind::object func = luabind::from_stack(L, -1);
    lua_pop(L, 1);
    luaData = func(); //Catch exceptions for runtime errors
    lua_pop(L, 1);
} 
```

你不是`lua_State* luaState`在你的班级里，而是`luabind::object luaData`在你的班级里。如果您需要`lua_State`，您可以随时从`luabind::object`.

要调用 Lua`onHit`函数，只需使用`luabind::object`接口：

```
void NPC::onHit()
{    
    luaData["onHit"](luaData);
} 
```

请注意，您*不会*重新运行 Lua 脚本。这就是你的问题所在。您只是在调用 Lua 脚本已经定义的函数。

现在，您似乎想使用本地而不是表内存。没关系; 它会阻止 C++ 代码直接访问`health`（并非没有诡计）。它会简化我们的代码，因为我们不必传递`luaData`给`onHit`. 你可以在 Lua 中这样做：

```
local health = 10
local NPC = {}

function NPC.onHit()
  health = health - 5
end

return NPC 
```

NPC构造函数不需要改变；只是我们的呼吁`onHit`。

```
void NPC::onHit()
{    
    luaData["onHit"]();
} 
```

如果您对使用全局变量一无所知，您可以在环境中玩游戏，但这相当复杂。它将在各个脚本调用之间提供有保证的隔离。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T03:57:43.850

我不了解Lua，所以我不会谈论这个。该问题也标记为python。为此，我认为您可以序列化所有“重要”的局部变量。

或者，您可以查看我的技巧，在此处保留一个名为 PyDON 的字典：http: [//code.activestate.com/recipes/577508-pydon-an-alternative-to-xml/](http://code.activestate.com/recipes/577508-pydon-an-alternative-to-xml/)

还要检查一下，我认为这会更有帮助：[如何将 Python 字典序列化为字符串，然后再返回字典？](https://stackoverflow.com/questions/4342176/how-do-i-serialize-a-python-dictionary-into-a-string-and-then-back-to-a-diction)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-30T04:00:34.320

这似乎有点矫枉过正，但为什么不将所需的值存储在 SQLite 表中呢？

# c++ - 替代函数语法差异

> ID：14087689
> 
> 赞同：7
> 
> 时间：2012-12-30T02:08:52.670
> 
> 标签：c++, c++11, declaration, function-declaration

这两个函数有什么区别？

```
auto func(int a, int b) -> int;

int func(int a, int b); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-30T02:13:02.123

除了符号之外，上述情况没有任何区别。当您想要引用一个或多个参数来确定函数的返回类型时，替代函数声明语法变得很重要。例如：

```
template <typename S, typename T>
auto multiply(S const& s, T const& t) -> decltype(s * t); 
```

（是的，这是一个愚蠢的例子）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T02:13:44.630

这两个声明之间没有有用的区别；两个函数都返回一个`int`.

C++11 的尾随返回类型对于带`template`参数的函数很有用，其中返回类型在编译时才知道，例如在这个问题中：[如何正确编写尾随返回类型？](https://stackoverflow.com/questions/14080135/how-do-properly-write-trailing-return-type)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T02:12:08.287

它们使用不同的语法，并且只有一种在 C++11 之前的 C++ 版本中有效。除此之外，您在问题中显示的两个函数声明之间没有区别。

# php - exec 导致永久加载

> ID：14087690
> 
> 赞同：0
> 
> 时间：2012-12-30T02:08:55.977
> 
> 标签：php

我注意到 exec 和 shell_exec 导致永久加载。

基本上，我正在尝试做一些简单的事情，比如在后台加载 PHP 脚本。当我尝试这样做时，它只是加载和加载。

我的代码如下

```
exec('php test.php -- '.escapeshellarg($param1).'  > /dev/null  '); 
```

我首先认为这是我的另一个脚本，所以我将它指向一个文件，其中只包含：

```
echo $agrv[1]; 
```

但它仍然会永久加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T02:22:54.757

[不要等待进程退出](https://stackoverflow.com/questions/136429/dont-wait-for-the-process-to-exit)

exec() 等待进程给出退出代码。我上面提供的链接可能会对您有所帮助。

哦，既然您出于某种原因标记了 Linux，我假设您使用的是 Linux 发行版。

你也可以考虑这个：http: [//ca1.php.net/pcntl_fork](http://ca1.php.net/pcntl_fork)

# android - 异步 GET 搞砸了 ListView

> ID：14087693
> 
> 赞同：0
> 
> 时间：2012-12-30T02:10:02.513
> 
> 标签：android, asynchronous, android-asynctask

我正在尝试将我拥有的 JSON 提要中的内容放入 ListView，使用 Android 异步 Http 客户端处理 HTTP 请求。但是，我认为请求的性质会导致适配器接收一个`null`值，而不是我想要的数据数组。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    ApplicationGlobal g = (ApplicationGlobal) getApplication();
    boolean userLoggedIn = g.getUserLoggedIn();
    AsyncHttpClient clientSession = new AsyncHttpClient();
    PersistentCookieStore cookieStore = g.getCookieStore();
    clientSession.setCookieStore(cookieStore);
    if (!userLoggedIn) {
        login();
    } else {

        ArrayList<HashMap<String, String>> newsFeed = getNewsJson();

        // Second to be printed:
        System.out.println("LIST DATA");

                    System.out.println(newsFeed);
        SimpleAdapter adapter = new SimpleAdapter(
                this,
                newsFeed,
                R.layout.assignment_list_row_view,
                new String[] { "photo", "dateAssigned", "dateDue",
                        "description" },
                new int[] { R.id.text1, R.id.text2, R.id.text3, R.id.text4 });
        setListAdapter(adapter);
    }
}

ArrayList<HashMap<String, String>> newsFeed = new ArrayList<HashMap<String, String>>();

private ArrayList<HashMap<String, String>> getNewsJson() {
    ApplicationGlobal g = (ApplicationGlobal) getApplication();
    AsyncHttpClient clientSession = new AsyncHttpClient();
    PersistentCookieStore cookieStore = g.getCookieStore();
    clientSession.setCookieStore(cookieStore);
    clientSession.get("http://192.168.1.42:5000/news/dummy/all/",
            new JsonHttpResponseHandler() {
                @Override
                public void onSuccess(JSONObject response) {
                    JSONArray assignments = new JSONArray();
                    try {
                        assignments = response.getJSONArray("assignments");
                        JSONObject c = assignments.getJSONObject(0);

                        for (int i = 0; i < assignments.length() + 1; i++) {

                            JSONObject individualAssignment = new JSONObject(
                                    c.getString(Integer.toString(i)));

                            HashMap<String, String> map = new HashMap<String, String>();
                            map.put("photo",
                                    individualAssignment.getString("photo"));
                            map.put("dateAssigned", individualAssignment
                                    .getString("date_assigned"));
                            map.put("dateDue", individualAssignment
                                    .getString("date_due"));
                            map.put("description", individualAssignment
                                    .getString("description"));

                            newsFeed.add(map);

                            // Last to be printed (and printed multiple times, as expected)

                            System.out.println("RAW DATA");
                            System.out.println(newsFeed);
                        }

                    } catch (JSONException e) {
                        e.printStackTrace();
                    }
                }
            });

    // First to be printed:

    System.out.println("RETURNED DATA");
    System.out.println(newsFeed);
    return newsFeed;
} 
```

我认为正在发生的事情，如上面三个放置的评论所示，`onSuccess()`是没有足够快地调用数据以将数据传递给具有非空值的适配器。

重新设计此代码片段以使其正常工作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:22:08.987

该方法将在异步内容仍在执行时立即返回 newsFeed。将适配器的初始化放在 onSuccess 流程中可能会解决您的问题。

我建议将 AsyncTask 用于后台操作，因为它更清楚在后台执行的操作并知道主（UI）线程应该处理什么。

AsyncTask 信息：http: [//developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

# unix - 为什么这个简单的 Hydra 命令不起作用？

> ID：14087694
> 
> 赞同：1
> 
> 时间：2012-12-30T02:10:16.993
> 
> 标签：unix, cmd, hydra

我正在尝试掌握 hydra 的窍门。

当我这样做来测试我的 ftp 站点时，它可以工作。我正在使用正确的用户名和密码（例如 username1 和 password1）访问我自己的 ftp 站点（例如 www.mysite.com）：

```
./hydra -l username1 -p password1 -vV -f www.mysite.com ftp
Hydra v7.4.1 (c)2012 by van Hauser/THC & David Maciejak - for legal purposes only

Hydra (http://www.thc.org/thc-hydra) starting at 2012-12-29 21:06:20
[VERBOSE] More tasks defined than login/pass pairs exist. Tasks reduced to 1.
[DATA] 1 task, 1 server, 1 login try (l:1/p:1), ~1 try per task
[DATA] attacking service ftp on port 21
[VERBOSE] Resolving addresses ... done
[ATTEMPT] target www.mysite.com - login "username1" - pass "password1" - 1 of 1 [child 0]
[21][ftp] host: 200.200.240.240   login: username1   password: password1
[STATUS] attack finished for www.mysite.com (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (http://www.thc.org/thc-hydra) finished at 2012-12-29 21:06:21 
```

但是，当我这样做是为了`http://browserspy.dk/password-ok.php`使用正确的用户名和密码（`test`和`test`）测试公共基本身份验证测试页面（）时，hydra 只是停止并显示“正在解析地址...完成”消息。

```
./hydra -l test -p test -vV -f browserspy.dk http-get /password-ok.php
Hydra v7.4.1 (c)2012 by van Hauser/THC & David Maciejak - for legal purposes only

Hydra (http://www.thc.org/thc-hydra) starting at 2012-12-29 21:02:58
[VERBOSE] More tasks defined than login/pass pairs exist. Tasks reduced to 1.
[DATA] 1 task, 1 server, 1 login try (l:1/p:1), ~1 try per task
[DATA] attacking service http-get on port 80
[VERBOSE] Resolving addresses ... done 
```

hydra 进程似乎在这里死了，我返回到命令提示符。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T11:36:51.297

您没有做错任何事情，它是 hydra 中的一个错误，它会影响模式`http-get`和`http-head`irc。降级到 v7.3 或等待 v7.5 将解决此问题。

# database - LINQ 查询以选择最新记录

> ID：14087695
> 
> 赞同：0
> 
> 时间：2012-12-30T02:10:18.613
> 
> 标签：database, linq, row

我们的表结构如下所示：

```
appointmentID    

1abc   --------------->1              
1abc (latest)  ------------>2            
1hjt               
990aa             
990aa              
990aa (latest 
```

* * *

```
DateTime start = DateTime.Now.AddDays(0);
DateTime end = DateTime.Now.AddDays(7));

List<JobCustomers> appointments = objectContext.JobCustomers.Where(
                    a => a.StartTime >= start && a.EndTime <= end && !string.IsNullOrEmpty(a.AppointmentId)).ToList();   

foreach (JobCustomers appointmentItem in appointments) {
    // HERE I WANT TO WRITE SOME CODE
    -- WHEN WE ARE INSERTING NEW RECORD OF A SAME ID EX "1abc" IT MUST 
    COMPARE WITH LATEST RECORD "-----2> 
} 
```

* * *

我的要求：如果有超过 1 行具有相同的 id，那么我需要通过约会 id 带来最新记录，如下所示

```
List<JobCustomers> appointments = objectContext.JobCustomers.Where(
                    a => a.StartTime >= start && a.EndTime <= end && !string.IsNullOrEmpty(a.AppointmentId).**take(0**)).ToList(); 
```

简而言之：使用 LINQ 当我们插入具有相同 id 的新记录时，我们需要与最后插入的记录进行比较

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T15:17:54.320

```
var latestAppts = appointments.GroupBy(x => x.AppointmentId)
                              .Select(g => g.Last()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T02:44:33.330

LINQ 和 SQL 都不知道您插入数据的顺序，您需要有一个额外的字段来保存此顺序（可以是日期或自动数字）。一旦你有了它，你将能够使用：

```
YourList.OrderBy(i => i.Id).ThenByDescending(i => i.YourColumnToSaveOrder) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T21:41:47.960

如果我没看错，那么您正在尝试专门获取具有相同 ID 的最新记录，这只需使用 LINQ 的 LastOrDefault 扩展方法即可：

```
//Variable 'yourNewRecord' is what you're about to enter into the database
var latestAppt = objectContext.JobCustomers
                              .LastOrDefault(a => a.StartTime >= start && 
                                                  a.EndTime <= end &&
                                                  a.AppointmentID.Equals(yourNewRecord.AppointmentID) 
```

编辑：有关 LastOrDefault 的更多信息，请查看[此处](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.lastordefault.aspx)的 MSDN 链接。

# php - jQuery $.ajax POST 函数到 WPSC

> ID：14087698
> 
> 赞同：1
> 
> 时间：2012-12-30T02:11:10.330
> 
> 标签：php, jquery, ajax, post

我正在使用 Wordpress 购物车。我想根据 3 种变体附加或修改产品名称，价格也一样。我试图在单个产品页面中使用 AJAX $.post 方法在图像上实现一个简单的 Jquery 点击事件。即使我使用 JSON 对其进行编码，它也不会发送数据值。我必须说我是 JSON 和 PHP 的新手。提前致谢 ！

在单品页面

```
$(function() {
$('#div_img_link').click(function() { 
    $.ajax({
    type: 'POST',
    data: "test value",
 // dataType : "json",
    url: '../wpsc-cart_widget.php',
    cache:false
    });
  });
 }); 
```

在 wpsc-cart_widget.php

```
 $name=wpsc_cart_item_name();

if (isset($_POST['data'])){
$value1 = $_POST['data'];  
  }else{
  $value1 = "";
}

 echo "$name $value1"; 
```

我知道那里有一些类似的帖子，我读过它们都无法弄清楚。我想知道 WPSC 是否可以在不刷新页面的情况下执行 jQuery POST 功能。任何帮助将不胜感激！！

[原理图](http://i.stack.imgur.com/RLTIO.jpg)

## **编辑**

SCHEMATICS 2 - 更简洁！

[我想要完成的事情](http://i.stack.imgur.com/WYoS4.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T08:06:07.153

SEA，您缺少处理从服务器返回的响应的功能。

我希望看到这样的东西：

```
$(function() {
    $('#div_img_link').click(function() { 
        $.ajax({
            url: '../wpsc-cart_widget.php',
            type: 'POST',
            data: "test value",
            dataType : "JSON",
            cache:false,
            success: function(data) {
                //do something here with the data.
                //eg.
                alert(data);
            },
            error: function() {
                //do something here if an error occurs.
                //eg.
                alert("an error occurred");
            },
        });
    });
}); 
```

了解更多关于 ajax 的最佳位置是[jQuery API 文档中的 ajax() 页面](http://api.jquery.com/jQuery.ajax/)。

您还需要确保服务器响应和客户端期望是兼容的。对于客户端的期望`dataType: "JSON"`，您必须确保服务器返回一个[json 编码的](http://php.net/manual/en/function.json-encode.php)响应。只有单个响应中的多个数据才需要 Json 编码。单个数据项可以不编码发送。

## 编辑：

看到您的示意图 2 后，我认为您的 ajax 请求数据应该如下所示：

```
data: {
    'pid': '12345678',
    'quantity': '1'
), 
```

`pid`“产品 ID”在哪里，是`quantity`用户想要添加到他/她的购物篮中的产品数量。

但是 WPSC 文档肯定包含这些东西的示例吗？你不应该为自己解决这个问题。

# objective-c - NSManagedContext 问题多次从上下文中获取

> ID：14087706
> 
> 赞同：0
> 
> 时间：2012-12-30T02:12:30.253
> 
> 标签：objective-c, core-data, nsmanagedobjectcontext

我有两个视图控制器。一个是 searchResults 表视图控制器 (VC1)，用户在其中看到与选择条件匹配的行列表；另一个是 ViewDetail (表视图控制器) (VC2)，用户在其中看到 VC1 所选行的详细信息。通过设置 VC2 的相关属性，获取所选行的详细信息所需的信息以及 managedContext 引用在 VC1 的 prepareforsegue 方法中从 VC1 传递到 VC2。在我的测试过程中，每次在 VC1 上选择不同的行以查看不同项目的详细信息时，我都会在（使用导航控制器后退按钮）VC1 和 VC2 之间切换。这可以正常工作 7-15 次切换，但在尝试切换后突然崩溃。我已尽我所能对此进行了调查，但没有解决方案就陷入困境，因此发布了这个。请帮忙。错误是一个特定的数组超出了索引 0 的范围。虽然我理解，但我不希望这个由获取请求的结果填充的数组为空。因此，我怀疑托管上下文有问题。提供了来自 VC2 的代码片段

```
//All this is in  ViewDidLoad of VC2 App crashes at the last line of this snippet. trying to get an object at index 0 which is non existent but should not be ...
NSFetchRequest *request  = [[NSFetchRequest alloc] init];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@" cameraid ==  %@",(NSNumber *)self.selectedCameraid];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Cameras"
                                          inManagedObjectContext:self.managedContext];

//Configure core data request
[request setEntity:entity];
[request setPredicate:predicate];

//Execute request
NSError *error = nil;

NSMutableArray *mutableFetchResults =  [[self.managedContext executeFetchRequest:request error:&error] mutableCopy];

if (mutableFetchResults == nil) {
    // Handle the error.
    NSLog(@"Some error in fetching results");

}
NSLog(@"Mutable fetch results data %@",mutableFetchResults);
self.resultsArray = mutableFetchResults;
Cameras *rowdata = [self.resultsArray objectAtIndex:0]; //Cameras is a managed object 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:05:31.440

After a bit of further digging I found the issue... I am type casting a string as NSNumber (NSNumber *)self.selectedCameraid in the above code. Apparently this is what has been causing the crash. I converted the NSString object to a NSNumber object using NSNumberformatter and everything seems to work fine. I realised it is not safe to type cast objects in this manner.

# java - Java App - 启动表单小程序出现在任何表单上的 JOptionPane 事件之后

> ID：14087708
> 
> 赞同：-1
> 
> 时间：2012-12-30T02:12:48.407
> 
> 标签：java, swing, jframe, joptionpane, japplet

我是新来的，对小程序不太熟悉。我搜索了该网站和许多其他论坛的答案，但我一无所获。我在 Java 中创建了一个应用程序，它从一个小程序登录表单开始，然后是 JFrame 子表单，这些子表单正在做一些事情，比如运行 JOptionPanes，例如当客户更改他的个人资料时。我的问题是，当 JOptionPane 出现时，即使我打开了 2 或 3 个 JFrame，小程序启动表单也会出现在顶部。我忘了说我的应用程序很大，所以我不能发布任何代码（我认为不需要）。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T02:35:26.110

避免混合使用框架和小程序，避免使用相互竞争的范例。如果您必须使用小程序，请使用类似`CardLayout`或`JTabbedPane`允许用户在表单之间切换的东西。

如果可以，请尝试使用[Java Web Start](http://docs.oracle.com/javase/tutorial/deployment/webstart/index.html)，这将允许您从 Web 启动应用程序，但与任何嵌入式 GUI 具有相同的限制。

至于您的问题，它发送就像您正在为`JOptionPane`. 确保父引用正确（即引用框架或框架的子框架）

# c# - 替代字典进行快速键查找？

> ID：14087713
> 
> 赞同：6
> 
> 时间：2012-12-30T02:13:53.747
> 
> 标签：c#, .net, vb.net, data-structures

如果我处理了特定值，我会遇到需要跟踪的情况。在这些情况下，我使用`Dictionary(Of TKey, TValue)`来跟踪我已处理的值。基本上，在处理每个值时，我将处理后的值作为键插入到字典中。当我想查看是否已处理该值时，我使用该`ContainsKey`方法查看该值是否存在于集合中。

这很好用，但我必须在键值对的值侧插入一些东西。我只会使用 a`List(Of T)`但我想要 Dictionary 提供的哈希表查找的性能。.Net 中是否有更适合此目的的数据收集？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-30T02:34:34.037

我建议一个[`HashSet<T>`](http://msdn.microsoft.com/en-us/library/bb359438.aspx). 如果您只需要知道该密钥已被使用，您可以只输入密钥。

这也很简单：

```
if (myHashSet.Add(key))
{
    // item wasn't in the hash set, so process it.
} 
```

`Add`就像“如果不存在就添加”。`true`如果添加了项目，则返回。`false`如果该项目已经在集合中，则返回。

或者，您可以使用`Contains`来测试，然后`Add`添加。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T02:33:06.880

在 .NET 3.5 或更高版本上，您可以将 a`HashSet`用于该目的。您需要的方法称为`Add`和`Contains`。这两个操作的时间复杂度为 O(log *n* )，而 a 的时间复杂度为 O( *n* ) `List`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T02:30:53.497

您可能会使用[System.Collections.Specialized.StringCollection](http://msdn.microsoft.com/en-us/library/system.collections.specialized.stringcollection.aspx)，但我不确定它是否与 Dictionary 一样高效，并且需要您将键转换为字符串。

如果始终在 Add 方法中包含某些内容的要求很烦人，您可以创建自己的通用键类，它可以适应更好的底层 .Net 实现，因为它们被发现。例如，假设 VB.Net：

```
Public Class KeyDictionary(Of T)
    Inherits Dictionary(Of T, Boolean)

    Public Overloads Sub Add(key As T)
        MyBase.Add(key, False)
    End Sub
End Class 
```

然后声明一个实例并添加一个值：

```
 Dim cKeys As New KeyDictionary(Of Integer)

    If Not cKeys.ContainsKey(1) Then
        cKeys.Add(1)
    End If 
```

而且，在 C# 中：

```
public class KeyDictionary<T> : Dictionary<T, bool>
{
    public void Add(T key)
    {
        base.Add(key, false);
    }
} 
```

声明一个实例并添加一个值：

```
 var cKeys = new KeyDictionary<int>();

        if (!(cKeys.ContainsKey(1)))
        {
            cKeys.Add(1);
        } 
```

# mysql - 如何在没有分配键名且自动增加主键的情况下向 mysql 插入新记录？

> ID：14087715
> 
> 赞同：0
> 
> 时间：2012-12-30T02:14:20.887
> 
> 标签：mysql

如何在没有分配键名且自动增加主键的情况下向 mysql 插入新记录？

请参阅[PHP mySQL - 将新记录插入表中，主键自动递增](https://stackoverflow.com/questions/7492145/php-mysql-insert-new-record-into-table-with-auto-increment-on-primary-key)
将第一个值更改为 DEFAULT ，但仍然发生相同的错误

![在此处输入图像描述](../Images/05769d2956db0e7b1e75c48dee9f82a8.png)

表结构：

```
DROP TABLE IF EXISTS `configuration_copy`;
CREATE TABLE `configuration_copy` (
  `configuration_id` int(11) NOT NULL auto_increment,
  `configuration_title` text NOT NULL,
  `configuration_key` varchar(255) NOT NULL default '',
  `configuration_value` text NOT NULL,
  `configuration_description` text NOT NULL,
  `configuration_group_id` int(11) NOT NULL default '0',
  `sort_order` int(5) default NULL,
  `last_modified` datetime default NULL,
  `date_added` datetime NOT NULL default '0001-01-01 00:00:00',
  `use_function` text,
  `set_function` text,
  PRIMARY KEY  (`configuration_id`),
  UNIQUE KEY `unq_config_key_zen` (`configuration_key`),
  KEY `idx_key_value_zen` (`configuration_key`,`configuration_value`(10)),
  KEY `idx_cfg_grp_id_zen` (`configuration_group_id`)
) ENGINE=MyISAM AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of configuration_copy
-- ----------------------------
INSERT INTO `configuration_copy` VALUES ('1', 'World Points', 'WORD_POINTS', '0', 'Points required upgrading to world grade', '1', '1', '0000-00-00 00:00:00', '2012-12-30 09:38:23', null, null);
INSERT INTO `configuration_copy` VALUES ('2', 'Iron Points', 'IRON_POINTS', '1000', 'Points required upgrading to iron grade', '1', '2', null, '0001-01-01 00:00:00', null, null);
INSERT INTO `configuration_copy` VALUES ('3', 'Bronze Points', 'BRONZE_POINTS', '2000', 'Points required upgrading to bronze grade', '1', '3', null, '0001-01-01 00:00:00', null, null);
INSERT INTO `configuration_copy` VALUES ('4', 'Silver Points', 'SILVER_POINTS', '3000', 'Points required upgrading to silver grade', '1', '4', null, '0001-01-01 00:00:00', null, null);
INSERT INTO `configuration_copy` VALUES ('5', 'Gold Points', 'GOLD_POINTS', '4000', 'Points required upgrading to gold grade', '1', '5', null, '0001-01-01 00:00:00', null, null); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:20:35.863

`unq_config_key_zen`列上有一个唯一键`configuration_key`，因此您不能插入具有相同`configuration_key`值的行。

```
 UNIQUE KEY `unq_config_key_zen` (`configuration_key`), 
```

# css - CSS：使绝对嵌套的DIV左对齐

> ID：14087716
> 
> 赞同：3
> 
> 时间：2012-12-30T02:14:38.537
> 
> 标签：css, alignment, css-position, absolute

我有一个包含内容的下拉菜单。我正在尝试使内容在屏幕左侧的 0px 处对齐。无论我尝试什么，它仍然在其父容器中保持对齐。

由于下拉菜单在浏览器中居中，我很难让它在我想要的地方工作。

[http://jsfiddle.net/XkuHy/2/](http://jsfiddle.net/XkuHy/2/)

```
<div id="sticky">
    <div id="nav">
        <div class="logo">logo</div>
        <span class="n list">browse</span>
        <span class="n list">search</span>
        <div class="n drop">
            <span>My Account</span>
            <div>
                hello, world!
            </div>
        </div>
    </div> 
```

注意：CSS*不是*我的强项。

注意 2：StackOverflow 一直在讨论所需的代码，而不仅仅是指向 jsFiddle 的链接——不知道为什么要忽略转储的代码，因为你可以在 fiddle 中看到它。

![在此处输入图像描述](../Images/09a479506658dafef84dc475721068dc.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:53:23.443

当您将其边距设置为 0px 时。它将变为 0px，但相对于其父级。因此，您可以尝试对其 css 的负值边距：

```
margin-left:-205%; 
```

像这样：http: [//jsfiddle.net/XkuHy/13/](http://jsfiddle.net/XkuHy/13/) 或

```
left: -345px; 
```

像这样：http: [//jsfiddle.net/XkuHy/13/](http://jsfiddle.net/XkuHy/13/)

但是它们都存在跨浏览器可比性问题。

我通过将它添加到 css 解决了这个问题，其中“hello world”的类名是“dropmenu”：

```
.drop:hover .dropmenu{
    position: fixed;
    top:  100px;
    left: 0;
    width: 100%;
    height:100px;
    padding:0;
    margin:0;
    z-index:998;
    background-color:white; 
}
​ 
```

惊喜！惊喜！我认为它有效！查看：http: [//jsfiddle.net/XkuHy/10/](http://jsfiddle.net/XkuHy/10/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T02:26:12.913

该`.content`框相对于其父`.n.drop`级 div 定位，因为它具有相对定位。如果您从`.n.drop`元素中删除相对定位，您会发现`.content`元素将自身定位在您想要的位置。您可能还需要向元素添加 a`margin-top: 16px;`以`.content`使其清除菜单。

你可以在这里看到更新的演示：http: [//jsfiddle.net/XkuHy/14/](http://jsfiddle.net/XkuHy/14/)

# ruby - 将简单的 CSV 文件上传到控制器

> ID：14087717
> 
> 赞同：0
> 
> 时间：2012-12-30T02:14:44.800
> 
> 标签：ruby, arrays, ruby-on-rails-3, file-upload, hash

我正在尝试将 CSV 文件上传到我的控制器并访问其中的数据。

这是控制器的代码：

```
class DatabaseImporterController < ApplicationController
  def index
  end

  def import
    # Receive the uploaded CSV file and import to the database.
    csv_file = params[:csv_file]
    logger.debug  { csv_file.inspect }
    #CSV.foreach("parse.csv") do |row|

    #end
    render :template => "database_importer/index"
  end
end 
```

和输出`logger.debug`：

```
{"utf8"=>"✓", 
 "authenticity_token"=>"Z4+XlmrcH+8JPL6Yq52ymVOMfiGEI9mN8LuoxoBLp8M=", 
 "csv_file"=>#<ActionDispatch::Http::UploadedFile:0x007feca81b3fb8 @original_filename="Install-Linux-tar.txt", @content_type="text/plain", @headers="Content-Disposition: form-data; name=\"csv_file\"; filename=\"Install-Linux-tar.txt\"\r\nContent-Type: text/plain\r\n", @tempfile=#<File:/tmp/RackMultipart20121229-10294-1ngf634>>, 
 "commit"=>"Import CSV Car Database", 
 "controller"=>"database_importer", 
 "action"=>"import"} 
```

根据官方[Ruby on Rails 页面](http://guides.rubyonrails.org/form_helpers.html)上的文档：

> params 哈希中的对象是 IO 子类的一个实例。根据上传文件的大小，它实际上可能是 StringIO 或**由临时文件支持的 File 实例。**

据我了解，上传的文件位于我的光盘中（在我的 Heroku 实例中），我可以暂时访问它。

如何访问该文件？我尝试了以下方法，并收到错误消息：

```
csv_file = params[:csv_file][:tempfile] # This is how I try to get the file page of the temporary file.

undefined method `[]' for #<ActionDispatch::Http::UploadedFile:0x007fecb02103c8> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:17:37.487

你想打电话`tempfile`，而不是`[:tempfile]`：

```
params[:csv_file].tempfile 
```

您可以在[文档中`ActionDispatch::Http::UploadedFile`](http://api.rubyonrails.org/classes/ActionDispatch/Http/UploadedFile.html)查看所有可用的方法。

# javascript - 使用 Backbone.js 填充在 save() 上发送的 JSON 对象

> ID：14087720
> 
> 赞同：4
> 
> 时间：2012-12-30T02:15:51.173
> 
> 标签：javascript, ruby, backbone.js

我正在尝试将一个对象从 Backbone.js 发送到我的 Rails 后端。目前，当我调用`save()`我的模型时，它会将其发送到服务器：

```
{"program_id":1,"issuer_id":4} 
```

但 Rails 期望它采用以下格式：

```
{"program_issuer_link":{"program_id":1,"issuer_id":4}} 
```

`save()`当我调用我的模型时，有什么方法可以对从 Backbone.js 发送到 Rails 的 JSON 对象进行这种封装？我浏览了文档，但找不到任何关于它的信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T02:21:46.867

如果您使用的是`backbone-rails`gem，那么您可以这样做。

```
var User = Backbone.Model.extend({
   paramRoot: 'user'
}); 
```

您也可以`toJSON`像这样覆盖该方法

```
var User = Backbone.Model.extend({
  toJSON: function(){
    return {user: _.clone(this.attributes)}
  },
}); 
```

# ios - 自定义 UIButton 触摸时不突出显示

> ID：14087725
> 
> 赞同：27
> 
> 时间：2012-12-30T02:17:18.860
> 
> 标签：ios, xcode, uibutton

我有一个创建自定义 UIButton 的方法，它允许我使用 QuartzCore 更改按钮的颜色。但是按钮在触摸时不会突出显示。

```
- (UIButton *)makeHeaderButton {
    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    UIFont *textFont = [UIFont boldSystemFontOfSize:12];
    UIColor *textColor = [UIColor colorWithRed:80/255.0 green:109/255.0 blue:145/255.0 alpha:1.0];
    UIColor *backgroundColor = [UIColor colorWithRed:250/255.0 green:250/255.0 blue:250/255.0 alpha:1.0];
    [button setTitleColor:textColor forState:UIControlStateNormal];
    button.titleLabel.font = textFont;
    button.autoresizesSubviews = YES;
    button.layer.cornerRadius = 8;
    button.layer.borderWidth = 1;
    // next 2 properties set using QuartzCore class, no other way to set button colors
    button.layer.borderColor = [UIColor grayColor].CGColor;
    button.layer.backgroundColor = backgroundColor.CGColor;
    button.clipsToBounds = YES;
    return button;
} 
```

如何使这些按钮像常规圆形矩形按钮一样突出显示？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2018-04-24T08:46:25.713

在 Swift 中，您还可以覆盖`isHighlighted`var 并在其上添加 alpha 动画。

```
override var isHighlighted: Bool {
    didSet {
        UIView.animate(withDuration: 0.25, delay: 0, options: [.beginFromCurrentState, .allowUserInteraction], animations: {
            self.alpha = self.isHighlighted ? 0.5 : 1
        }, completion: nil)
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-30T03:02:35.790

在您的代码中，添加该行`button.showsTouchWhenHighlighted = TRUE;`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-07-21T11:21:55.363

如果有人仍然遇到问题 - 您应该像这样创建 UIButton：

```
UIButton *btn = [UIButton buttonWithType:UIButtonTypeSystem];

btn.layer.cornerRadius = 4;
btn.layer.masksToBounds = YES;

[btn setTranslatesAutoresizingMaskIntoConstraints:NO];

[btn setBackgroundColor:[UIColor greenColor]];
[btn setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];

[btn setTitle:@"ok" forState:UIControlStateNormal];

*** any customisation that you would like ***

[parentView addSubview: btn]; 
```

所以这样你仍然有 iOS 来处理所有的突出显示。主要是使用

```
[UIButton buttonWithType:UIButtonTypeSystem]; 
```

如果您使用 initWithFrame 或任何其他方法 - 您必须实施

```
setTitleColor: forState: 
setBackgroundImage: forState: 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-11-09T21:27:53.713

对于*Swift*，创建一个继承`UIButton`并覆盖`isHighlighted`属性的自定义类：

```
class ButtonWithHighlight: UIButton {

    override var isHighlighted: Bool {
        get {
            return super.isHighlighted
        }
        set {
            if newValue {
                backgroundColor = <#color when highlighted#>
            }
            else {
                backgroundColor = <#color for normal state#>
            }
            super.isHighlighted = newValue
        }
    }

} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-01-13T13:56:56.920

您可以创建自己的子类`UIButton`（然后您只需在构造函数中设置所有这些属性）。

而且您必须覆盖的 highlight 方法`UIButton`

```
- (void)setHighlighted:(BOOL)highlighted {
    if (highlighted) {
        self.backgroundColor = [UIColor redColor];
    } else {
        self.backgroundColor = [UIColor blueColor];
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-05-30T17:37:39.880

有一种简单的方法可以在自定义按钮上实现高亮。1.为高亮状态创建.png图像（带有颜色，alpha等）；2.进入yourbutton.xib；3.选择XCode右侧的Attributes Inspector；4\. 将状态配置设置为突出显示 5\. 将您的 .png 图像设置为背景图像。不客气 ：）

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2014-11-13T08:28:18.460

在 Storyboard 中设置按钮背景默认图像和突出显示的图像。在按钮操作上写下这一行，即更改按钮颜色 1 秒

```
[[NSRunLoop currentRunLoop] runUntilDate:[NSDate dateWithTimeIntervalSinceNow:1]]; 
```

# javascript - 下拉菜单打乱了其他标签

> ID：14087729
> 
> 赞同：1
> 
> 时间：2012-12-30T02:17:37.597
> 
> 标签：javascript, jquery, css

我正在开发一个带有下拉菜单的导航栏（稍后会添加另一个）。当按下下拉菜单时，它会将所有导航链接向右移动。期望的行为是所有导航链接都是静态的。我尝试在标签`fixed`上使用`div`带有`absolute`css 的`li`标签，但 IE 会将`li`标签呈现在父 div 之外。

我当前的实现正在使用`float:left`，但这也没有产生预期的结果。下拉菜单是标有“Solace”的菜单。任何帮助或建议表示赞赏。我创建了一个演示来说明我的问题。[http://jsfiddle.net/xbB4M/1/](http://jsfiddle.net/xbB4M/1/)。

另外，一个附带问题。如果这需要一个新帖子，请告诉我，我会提出一个新问题。每当用户单击下拉菜单时，如何监听下一次鼠标单击以关闭下拉菜单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T02:26:23.593

如果你给你的`.menu`班级一个`absolute`位置，它应该阻止其他菜单项向右滑动。至于您的第二个问题，如果您检查工作示例，我为菜单项添加了另一个单击事件处理程序，如果单击它们，它将关闭菜单。

试试这个：

```
.menu {
    margin-top:10px;
    background-color:#17406B;
    position: absolute;
} 
```

工作示例：http: [//jsfiddle.net/fewds/xbB4M/5/](http://jsfiddle.net/fewds/xbB4M/5/)

# objective-c - ZBarReaderView UIView 相机方向问题

> ID：14087736
> 
> 赞同：3
> 
> 时间：2012-12-30T02:18:25.847
> 
> 标签：objective-c, ios, uiview, zbar-sdk, zbar

我目前正在开发一个使用 ZBarSDK 读取 QR 码的 iPad 应用程序。

我正在使用`ZBarReaderView` （NOT ），所以我正在使用绘制`UIViewController`的前置摄像头（参见下面的代码）。`UIView``CGRect`

我的问题是相机出现在视图的一侧。iPad 应用程序只能在横向模式下工作。

现在出现`UIView`时，图像在它的一侧，我不知道如何修复它。我尝试使用`CGAffineTransform`which 成功地稍微改变了角度，但是如果 iPad 以另一种方式翻转，它将如何处理？

我看到了一些关于这个类似问题的其他帖子，但没有对我有用的解决方案。值得注意的是我正在使用 IOS6，请记住我正在使用`ZBarReaderView`，因此`supportedOrientationsMask`不可用。

我希望用户在直立位置看到相机视图，无论横向是左侧还是右侧。但现在，无论转向哪个方向，视频都是横向的（所以我可以看到自己与侧面成 90 度角）。当`UIView`屏幕转动时，它根本不会改变。我有点失落。

代码：

```
- (void) viewDidAppear: (BOOL) animated {

    ZBarReaderView * readerView = [ZBarReaderView new];
    ZBarImageScanner * scanner = [ZBarImageScanner new];
    [scanner setSymbology: ZBAR_I25
                   config: ZBAR_CFG_ENABLE
                       to: 0];

    [readerView initWithImageScanner:scanner];
    readerView.readerDelegate = self;
    readerView.tracksSymbols = YES;

    readerView.frame = CGRectMake(20,220,230,230);
    readerView.torchMode = 0;
    readerView.device = [self frontFacingCameraIfAvailable];
    [readerView start];

    [self.view addSubview: readerView];

}

-(void)relocateReaderPopover:(UIInterfaceOrientation)toInterfaceOrientation {
    if (toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft) {
        readerView.previewTransform = CGAffineTransformMakeRotation(M_PI_2);
    } else if (toInterfaceOrientation == UIInterfaceOrientationLandscapeRight) {
        readerView.previewTransform = CGAffineTransformMakeRotation(-M_PI_2);
    } else if (toInterfaceOrientation== UIInterfaceOrientationPortraitUpsideDown) {
        readerView.previewTransform = CGAffineTransformMakeRotation(M_PI);
    } else {
        readerView.previewTransform = CGAffineTransformIdentity;
    }
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    if (interfaceOrientation == UIInterfaceOrientationLandscapeLeft) {
        return YES;
    } else if (interfaceOrientation == UIInterfaceOrientationLandscapeRight) {
        return YES;
    } else {
        return NO;
    }
}

- (void) willRotateToInterfaceOrientation: (UIInterfaceOrientation) orient
                                 duration: (NSTimeInterval) duration
{
    if (orient == UIInterfaceOrientationLandscapeLeft) {
        [readerView willRotateToInterfaceOrientation: orient
                                            duration: duration];

    }
    if (orient == UIInterfaceOrientationLandscapeRight) {
        [readerView willRotateToInterfaceOrientation: orient
                                            duration: duration];

    }
}

- (BOOL)shouldAutorotate {

    UIInterfaceOrientation orientation = [[UIDevice currentDevice] orientation];

    if (orientation == UIInterfaceOrientationLandscapeLeft) {
        return YES;
    } else if (orientation == UIInterfaceOrientationLandscapeRight) {
        return YES;
    } else {
        return NO;
    }
}

-(NSUInteger) supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscape;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-03T17:46:25.827

我遇到了同样的问题并简单地解决了！

我只需要打电话：

```
[reader willRotateToInterfaceOrientation: toInterfaceOrientation duration: duration]; 
```

在包含 ZbarReaderView 的视图控制器的 willRotate... 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T08:03:30.583

好的，我现在可以进行定向了。不知道为什么它现在可以工作，但这是 readerView 部分的结束代码：

```
readerView = [ZBarReaderView new];
ZBarImageScanner * scanner = [ZBarImageScanner new];
[scanner setSymbology: ZBAR_I25
               config: ZBAR_CFG_ENABLE
                   to: 0];
[readerView initWithImageScanner:scanner];
readerView.readerDelegate = self;

readerView.tracksSymbols = YES;

readerView.frame = CGRectMake(20,220,230,230);
readerView.torchMode = 0;
readerView.device = [self frontFacingCameraIfAvailable];

[self relocateReaderPopover:[self interfaceOrientation]];

[readerView start];

[self.view addSubview: readerView]; 
```

请注意，唯一真正的区别是这一行：

```
ZBarReaderView * readerView = [ZBarReaderView new]; 
```

更改该行已修复初始方向问题。不知道为什么，但确实如此。现在，如果用户旋转 iPad，我只需要修复旋转的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T07:55:48.060

这对我来说很好：

```
// ADD: present a barcode reader that scans from the camera feed
ZBarReaderViewController *reader = [ZBarReaderViewController new];
reader.readerDelegate = self;
//reader.supportedOrientationsMask = ZBarOrientationMaskAll;
ScanOverlay *overlayController = [[ScanOverlay alloc] initWithNibName:@"ScanOverlay" bundle:nil];
reader.cameraOverlayView = overlayController.view;
ZBarImageScanner *scanner = reader.scanner;
// TODO: (optional) additional reader configuration here
reader.supportedOrientationsMask = ZBarOrientationMask(UIInterfaceOrientationLandscapeRight||UIInterfaceOrientationLandscapeLeft);
reader.wantsFullScreenLayout = YES;
reader.showsZBarControls = NO;  //If we don't set this to NO, the overlay may not display at all
reader.tracksSymbols = YES; 
```

//支持横向

```
UIInterfaceOrientation orientation = [UIApplication sharedApplication].statusBarOrientation;
if (UIDeviceOrientationLandscapeLeft == orientation) {
    //Rotate 90
    reader.cameraViewTransform = CGAffineTransformMakeRotation (3*M_PI/2.0);
} else if (UIDeviceOrientationLandscapeRight == orientation) {
    //Rotate 270
    reader.cameraViewTransform = CGAffineTransformMakeRotation (M_PI/2.0);
} 
```

# c# - 如何使用 AJAX 和 MVC 实现文件下载

> ID：14087743
> 
> 赞同：12
> 
> 时间：2012-12-30T02:20:15.643
> 
> 标签：c#, ajax, asp.net-mvc

我想通过在 MVC 下使用带有一些参数的 jQuery AJAX 调用来提供文件下载操作

例子

```
(javascript)
function DoDownload(startDate) {

  $.ajax({ 
     url:"controller/GetFile/",
     data: {startDate:startDate}
     ...
  });

}

C# Controller Code

 public void GetFile(string startDate) {

  var results = doQueryWith(startDate);

   // Create file based on results
   ....
   // How do I tell the server to make this a file download??
 } 
```

我通常只会让我的文件下载一个链接，例如：

```
<a h r e f="mycontroller/getfile/1"/>Download</a> 
```

但在上述情况下，日期将是动态的。

如果我不使用 ajax，那么使用 javascript 将参数传递给 MVC 控制器的首选方法是什么？

例子：

```
window.location  = "mycontroller/GetFile/" + $("#fromDate").val(); 
```

假设日期是 12-25-2012

这会产生

```
mycontroller/GetFile/12/25/2012 
```

MVC 会将其视为三个参数吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-07T15:11:55.850

我最终做的是从我的 javascript 中调用我的控制器，例如：

```
var url = "/mycontroller/GetFile?startDate=" + $("#mydate").val() + etc...

window.location = url; 
```

我的控制器.cs

```
 public void GetFile(DateTime startDate) 
{

} 
```

我最初关心的是日期参数。我不想解析它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T04:15:02.580

您可以使用[`File`](http://msdn.microsoft.com/en-us/library/dd470835%28v=vs.98%29.aspx)控制器类的方法将文件返回给浏览器。

下面的示例返回一个 pdf 文件。

```
public ActionResult GetFile(int id)
{
  var fileInfo=repositary.GetFileDedetails(id);
  var byteArrayOFFile=fileInfo.FileContentAsByteArray();
  return File(byteArrayOFFile,"application/pdf","yourFriendlyName.pdf");
} 
```

假设`repositary.GetFileDedetails`方法从 id 返回文件的详细信息。

您还可以从物理位置（路径）或流返回文件。检查方法的所有[重载](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.file%28v=vs.98%29.aspx)`File`并使用适当的重载。

*这与ajax无关。这是浏览器上的正常`GET`请求。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-30T14:32:35.400

使用 ActionLink 帮助器，您可以将多个参数传递给您的控制器：

```
HtmlHelper.ActionLink(
    string linkText, 
    string actionName, 
    string controllerName, 
    object routeValues, 
    object htmlAttributes
) 
```

所以在你的情况下：

```
@Html.ActionLink("Download file", "GetFile", "MyController", new { startDate = "##" }, new { id="mydownloadlink" }) 
```

使用 jQuery，您可以使用`startDate`日期选择器或文本框的内容更改链接中的值。

```
$("#mydownloadlink").attr("href").replace("##", $("#yourdatetexbox").val); 
```

然后，在您的控制器中，只需使用此处的其他答案之一， about `FileResult`。

希望这可以帮助你...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T03:44:13.997

您的控制器操作方法应返回 FileResult 而不是 void。并且没有必要通过 AJAX 执行此操作 - 事实上，您不想使用 AJAX 执行此操作。您将需要涉及的浏览器，以便它知道为用户提供下载对话框。

请参阅以下链接：

[处理 (jQuery) Ajax 调用中返回的 ASP.NET MVC FileResult](https://stackoverflow.com/questions/6028623/handeling-an-asp-net-mvc-fileresult-returned-in-an-jquery-ajax-call)

[Asp.Net MVC 2 中的文件下载](https://stackoverflow.com/questions/3597179/file-download-in-asp-net-mvc-2)

我希望这有帮助。

# list - 将列表中的多个元素添加到 list.count (Python)

> ID：14087752
> 
> 赞同：2
> 
> 时间：2012-12-30T02:21:55.337
> 
> 标签：list, python-2.7

为有点模糊的标题道歉，我会在这里尝试更多解释。

目前，我有以下代码，它计算值“y”和“n”出现在名为“结果”的列表中的次数。

```
NumberOfA = results.count("y")
NumberOfB = results.count("n") 
```

有没有一种方法可以使诸如“是”之类的值也计入 NumberOfA？我正在考虑以下几点：

```
NumberOfA = results.count("y" and "yes" and "Yes")
NumberOfB = results.count("n" and "no" and "No") 
```

但这不起作用。这可能是一个很容易解决的问题，但是，嘿。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:28:19.023

至于你上面的答案为什么不起作用，那是因为 Python 只会取你传入的表达式的最终值：

```
>>> 'Yes' and 'y' and 'yes'
'yes' 
```

因此，您`count`将关闭，因为它只是在寻找最终值：

```
>>> results.count('yes' and 'y')
1
>>> results.count('yes' and '???')
0 
```

像这样的东西会起作用吗？请注意，这取决于他们在列表中是否只有是/否式的答案（如果那里有“是的....嗯不”之类的东西，那将是错误的）：

```
In [1]: results = ['yes', 'y', 'Yes', 'no', 'NO', 'n']

In [2]: yes = sum(1 for x in results if x.lower().startswith('y'))

In [3]: no = sum(1 for x in results if x.lower().startswith('n'))

In [4]: print yes, no
3 3 
```

一般的想法是获取您的结果列表，然后遍历每个项目，将其小写，然后获取第一个字母 ( `startswith`) - 如果字母是 a `y`，我们知道它是 a `yes`；否则，它将是`no`.

如果您愿意，也可以通过执行以下操作来组合上述步骤（注意这需要 Python 2.7）：

```
>>> from collections import Counter
>>> results = ['yes', 'y', 'Yes', 'no', 'NO', 'n']
>>> Counter((x.lower()[0] for x in results))
Counter({'y': 3, 'n': 3}) 
```

`Counter`对象可以像字典一样对待，因此您现在基本上拥有一个包含`yes`'s 和`no`'s 计数的字典。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T02:28:58.580

```
NumberOfA = results.count("y") + results.count("yes") + results.count("Yes")
NumberOfB = results.count("n") + results.count("no") + results.count("No") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T02:35:19.500

创建一个方法

```
def multiCount(lstToCount, lstToLookFor):
    total = 0
    for toLookFor in lstToLookFor:
        total = total + lstToCount.count(toLookFor)
    return total 
```

然后

```
NumberOfA = multiCount(results, ["y", "yes", "Yes"])
NumberOfB = multiCount(results, ["n", "no", "No"]) 
```

# javascript - 尝试将输入单击绑定到字段的 onkeyup 事件

> ID：14087753
> 
> 赞同：5
> 
> 时间：2012-12-30T02:21:58.253
> 
> 标签：javascript, html

所以在正常情况下，我允许 jquery 并且我可以绑定我将使用的字段 onkeyup：

```
$('#something').keyup(function(e) {
    var enterKey = 13;
    if (e.which == enterKey){
        somefunction();
     }
 }); 
```

但是我不能使用它，必须使用类似的东西：

```
<input id="something" onkeyup="onkeyup_colfield_check(this)" type="text"> 
```

```
 function onkeyup_colfield_check(e){
    var enterKey = 13;
        if (e.which == enterKey){
            somefunction();
        }
} 
```

但是，这不像上面那样工作。

我怎样才能达到与第一个示例相同的结果，但使用类似的东西？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-30T02:24:34.100

您需要`event`作为参数传入，而不是`this`.

```
<input id="something" onkeyup="onkeyup_colfield_check(event)" type="text"> 
```

此外，为了与所有主流浏览器完全兼容，您可能希望使用以下方法来检测按下的键的键码。

```
var charCode = (typeof e.which === "number") ? e.which : e.keyCode; 
```

# ios - Rails 3.2.8 + RestKit - 没有 KVC 的映射

> ID：14087760
> 
> 赞同：2
> 
> 时间：2012-12-30T02:23:04.043
> 
> 标签：ios, restkit, xcode4.5

所以我正在尝试使用 RestKit 从我的 Rails 应用程序中获取 JSON 格式的信息

我这样做的代码是这样的：

**应用代理**

```
@implementation AppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    //Initialise RestKit
    NSURL *URL = [NSURL URLWithString:@"https://myapp.dev"];
    AFHTTPClient* client = [[AFHTTPClient alloc] initWithBaseURL:URL];

    //Enable Activity Indicator Spinner
    [AFNetworkActivityIndicatorManager sharedManager].enabled = YES;

    [client setDefaultHeader:@"Accept" value:RKMIMETypeJSON];

    RKObjectManager *objectManager = [[RKObjectManager alloc] initWithHTTPClient:client];

    RKObjectMapping *eventMapping = [RKObjectMapping mappingForClass:[Info class]];

    [infoMapping addAttributeMappingsFromDictionary:@{
     @"sample":@"sample",
     @"sample_1":@"sample_1"
     }];

    RKResponseDescriptor *infoDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:infoMapping
                                                                                        pathPattern:@"/info"
                                                                                        keyPath:nil
                                                                                        statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

    [objectManager addResponseDescriptor:infoDescriptor];
} 
```

**查看文件**

```
- (void)loadInfo
{

    RKObjectManager *objectManager = [RKObjectManager sharedManager];

    [objectManager getObjectsAtPath:@"/info"
                         parameters:nil
                            success:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {

                                NSArray *info = [mappingResult array];

                                NSLog(@"Loaded info: %@", info);

                                _info = info;

                            } failure:^(RKObjectRequestOperation *operation, NSError *error) {

                                UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error getting into"
                                                                                message:[error localizedDescription]
                                                                                delegate:nil
                                                                                cancelButtonTitle:@"OK"
                                                                                otherButtonTitles:nil];
                                [alert show];
                                NSLog(@"Hit error: %@", error);

                            }];
} 
```

问题是。在日志输出中，RestKit 告诉我它成功映射了所有内容。但是，当我尝试使用登录视图文件的方法和使用调试器的方法查看对象时，`po`我得到以下信息

```
374 Finished performing object mapping. Results: {
    "<null>" = "<Info: 0xa291b30>";
} 
```

我无法查看该对象，并且带有断点，它显示为：

![对象存在但无法查看](../Images/7c0d1754c65c325cbfff8e66dbcc559e.png)

我已经为此苦苦挣扎了几天，我不确定还有什么可以尝试的。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T01:07:54.907

我遇到了类似的问题。我不太清楚为什么，但是当我执行以下操作时，它修复了它。

```
- (void)loadInfo
{

    RKObjectManager *objectManager = [RKObjectManager sharedManager];

    [objectManager getObjectsAtPath:@"/info"
                         parameters:nil
                            success:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {

                                NSArray *info = [mappingResult array]; 
                                NSLog(@"Loaded info: %@", info);                                  
                                _info = info;

                            } failure:^(RKObjectRequestOperation *operation, NSError *error) {

                                UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error getting into"
                                                                                message:[error localizedDescription]
                                                                               delegate:nil
                                                                      cancelButtonTitle:@"OK"
                                                                      otherButtonTitles:nil];
                                [alert show];
                                NSLog(@"Hit error: %@", error);

                            }];
}

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

    //Initialise RestKit
    NSURL *URL = [NSURL URLWithString:@"https://myapp.dev"];
    AFHTTPClient* client = [[AFHTTPClient alloc] initWithBaseURL:URL];

    //Enable Activity Indicator Spinner
    [AFNetworkActivityIndicatorManager sharedManager].enabled = YES;

    [client setDefaultHeader:@"Accept" value:RKMIMETypeJSON];

    RKObjectManager *objectManager = [[RKObjectManager alloc] initWithHTTPClient:client];

    RKObjectMapping *eventMapping = [RKObjectMapping mappingForClass:[Info class]];

    [infoMapping addAttributeMappingsFromDictionary:@{
     @"sample":@"sample",
     @"sample_1":@"sample_1"
     }];

    RKResponseDescriptor *infoDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:infoMapping
                                                                                        pathPattern:@"/info/:id"
                                                                                        keyPath:nil
                                                                                        statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

    [objectManager addResponseDescriptor:infoDescriptor];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T12:36:40.947

当您加载没有嵌套 keyPath 的对象表示时，RestKit 将映射的对象存储在`[NSNull null]`字典中的键下（因为`nil`不是有效的字典键）。您可以通过调用`firstObject`、`array`或`dictionary`在`RKMappingResult`对象上访问映射的对象来检索映射结果。

我看到一个关于将数组映射到单个对象的后续问题......你的 JSON 是什么样的，你是如何尝试表示它的？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-03T03:16:51.163

```
 RKResponseDescriptor *infoDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:infoMapping
                                                                                    pathPattern:nil
                                                                                    keyPath:nil
                                                                                    statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)]; 
```

# facebook - 允许我的应用用户在他们的墙上分享 URL - 并计算每个用户的分享数量

> ID：14087763
> 
> 赞同：0
> 
> 时间：2012-12-30T02:23:26.307
> 
> 标签：facebook, facebook-like, share

我有一个用 Drupal + PHP + JS 编写的 FB 应用程序。用户已经可以使用“Drupal For Facebook”模块（http://drupal.org/project/fb）连接到我的应用程序。

我向我的应用程序用户展示了几个外部帖子，每个帖子都有自己的 URL，每个帖子旁边都有一个分享/点赞按钮，应该允许用户在他的墙上分享*那个 URL 。*

我有以下要求：

1.  当用户单击按钮时，我希望打开一个对话框，允许他将指定的 URL 作为消息发布到他的 FB 墙上。
2.  当用户发布 URL 时，我不想知道它并将其计入他的用户个人资料中。

问题：

*   最好的方法是什么？
*   可以通过 FB Share/Like/Send 按钮来完成吗？
*   还是我需要构建自己的帖子并代表用户发送？在那种情况下，我的应用程序需要哪些权限？
*   如何实际做到这一点？（代码示例会很棒）。

请记住，我必须计算每个用户的实际份额

提前致谢，

阿姆农

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T12:07:40.543

尝试以下 json 代码，似乎适用于 4 个主要社交网络[http://www.internoetics.com/2012/05/16/count-shares-to-facebook-twitter-linkedin-googleplus/](http://www.internoetics.com/2012/05/16/count-shares-to-facebook-twitter-linkedin-googleplus/)

# image - Go 代码在 go test 和 go run 中的行为不同

> ID：14087766
> 
> 赞同：6
> 
> 时间：2012-12-30T02:24:34.780
> 
> 标签：image, http, get, go, jpeg

我在我的 Ubuntu 12.04.1 笔记本电脑上运行 go 1.0.3，我偶然发现了一个问题，如果我在 main() 中运行一些代码，它的行为与使用 go test 运行它的行为大不相同。

这是我的示例：
来自 main.go

```
package main

import (
    "image"
    "image/jpeg"
    "fmt"
    "myproj/htmlutil"
    [some imports removed]
)

func main() {
    img, err := htmlutil.GetResizedImageFromWeb("http://img.foodnetwork.com/FOOD/2011/05/04/FNM_060111-OOT-B005_s4x3.jpg")

    if err != nil {
        fmt.Println("There was a problem ",err)
    }
    fmt.Println("Bounds were ",img.Bounds())
} 
```

来自 myproj/htmlutil_test.go

```
package htmlutil

import (
    "image"
    "fmt"
    "testing"
    [some imports removed]
)

func TestGetImageFromURL(t *testing.T){
    img, err := GetResizedImageFromWeb("http://img.foodnetwork.com/FOOD/2011/05/04/FNM_060111-OOT-B005_s4x3.jpg")

    if err != nil {
        t.Fatalf("There was a problem %q",err)
    }
    fmt.Println("Bounds were ",img.Bounds())
} 
```

他们调用的函数 GetResizedImageFromWeb() 在 myproj/htmlutil.go 中：

```
package htmlutil

import (
    "errors"
    "fmt"
    "image"
    "io/ioutil"
    "net/http"
    [some imports removed]
)

func GetResizedImageFromWeb(imageURL string) (image.Image, error) {
    resp, err := http.Get(imageURL)
    if err != nil {
        return nil, errors.New(fmt.Sprint("There was a problem reading the site %q Debug[%s]",imageURL, err))
    }
    defer resp.Body.Close()
    //Decode the image using image's general purpose decoder
    image, s, err := image.Decode(resp.Body)
    if err != nil {
        return nil, err
    }

    return resizeImage(image), nil
} 
```

当我从命令行运行“go run main.go”时，我会从 url 看到图像的边界，如果我想使用 main.go 中的函数，可以将其保存为磁盘上的 jpg 文件。但是，当我从 htmlutil 包运行“go test”时，出现以下错误：

```
There was a problem "image: unknown format" 
```

是什么导致问题仅在单元测试中失败？我究竟做错了什么？

我唯一的猜测是，无论出于何种原因， html.Get() 都没有返回测试场景中的所有数据，但我仍然对为什么会发生这种情况感到困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T04:06:21.393

在测试中，您应该真正检查函数调用的结果。

测试在控制台上使用 /dev/null 运行。因此 fmt / log 输出不可见。您应该在 htmlutil_test.go 中执行以下操作

```
func TestMain(t *testing.T) {
    img, err := GetResizedImageFromWeb("http://img.foodnetwork.com/FOOD/2011/05/04/FNM_060111-OOT-B005_s4x3.jpg")
    if err != nil {
        t.Error("There was a problem ", err)
    }

    bounds := image.Rectangle{
        image.Point{0, 0},
        image.Point{616, 462}}

    if img.Bounds() != bounds {
        t.Error("Incorrect Bounds were ", img.Bounds())
    }

} 
```

我刚刚复制了您的代码，如下所示：

main.go

```
package main

import (
    "errors"
    "fmt"
    "image"
    _ "image/jpeg"
    "net/http"
)

func GetResizedImageFromWeb(imageURL string) (image.Image, error) {
    resp, err := http.Get(imageURL)
    if err != nil {
        return nil, errors.New(fmt.Sprint("There was a problem reading the site %q Debug[%s]", imageURL, err))
    }
    defer resp.Body.Close()
    //Decode the image using image's general purpose decoder
    image, _, err := image.Decode(resp.Body)
    if err != nil {
        return nil, err
    }

    return image, nil
}

func main() {
    img, err := GetResizedImageFromWeb("http://img.foodnetwork.com/FOOD/2011/05/04/FNM_060111-OOT-B005_s4x3.jpg")

    if err != nil {
        fmt.Println("There was a problem ", err)
    }
    fmt.Println("Bounds were ", img.Bounds())
} 
```

main_test.go

```
package main

import (
    "image"
    "log"
    "testing"
)

func TestMain(t *testing.T) {
    img, err := GetResizedImageFromWeb("http://img.foodnetwork.com/FOOD/2011/05/04/FNM_060111-OOT-B005_s4x3.jpg")
    if err != nil {
        t.Error("There was a problem ", err)
    }

    bounds := image.Rectangle{
        image.Point{0, 0},
        image.Point{616, 462}}

    if img.Bounds() != bounds {
        t.Error("Incorrect Bounds were ", img.Bounds())
    }
} 
```

go test 的输出

```
PASS
ok      test    0.843s 
```

我的 go 版本是`go version devel +87f67aadaed6 Sat Dec 22 17:41:00 2012 -0800 darwin/amd64`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T17:40:33.563

我尝试了 rputikar 的解决方案（使用 t.Fatal() 而不是 fmt.Println()），但这没有帮助。

我**确实**注意到 rputikar 对他的进口产品做了一些与我不同的事情。我在 htmlutil.go 中的导入看起来像：

```
package htmlutil    

import (
    "errors"
    "fmt"
    "image"
    "io/ioutil"
    [some imports removed]
    "net/http"
) 
```

但我的 main.go 和 rputikar 的 main_test.go 都包含一个额外的导入 **"image/jpeg"**。因此，我将其添加到我的 htmlutil.go 导入列表中，从而解决了问题。我想我会添加**“_ image/png”**和**“_ image/gif”**只是为了未来的证明

# python - 如何将字符串拆分为多个字符并将拆分字符保留在返回值中？

> ID：14087769
> 
> 赞同：1
> 
> 时间：2012-12-30T02:26:00.447
> 
> 标签：python

这是一个示例输入：

```
(a1 b2 c3) 
```

由 ' ', '(', ')' 分割，这是所需的输出：

```
['(', 'a1', ' ', 'b2', ' ', 'c3', ')'] 
```

Pythonism 的做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T02:31:28.503

使用 Python 的[正则表达式模块](http://docs.python.org/2/library/re.html)：

```
>>> import re
>>> re.split(r'(\w+)', '(a1 b2 c3)')
['(', 'a1', ' ', 'b2', ' ', 'c3', ')'] 
```

或者，与`findall`orokusaki 的答案一样，但具有字符类（也算作`_`单词字符）：

```
>>> re.findall(r'\W+|\w+', '(a1 b2 c3)')
['(', 'a1', ' ', 'b2', ' ', 'c3', ')'] 
```

或者，如果您想明确说明仅在`(`, `,上进行拆分`)`：`

 ````
>>> re.split(r'([^\(\) ]+)', '(a1 b2 c3)')
['(', 'a1', ' ', 'b2', ' ', 'c3', ')'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T02:29:07.090

```
>>> import re
>>> re.findall(r'[a-zA-Z0-9]+|[^a-zA-Z0-9]', '(a1 a2 a3)')
['(', 'a1', ' ', 'a2', ' ', 'a3', ')'] 
````

# wordpress - 如何从 NGIX 服务器 wordpress 博客访问日志中提取特定 IP

> ID：14087771
> 
> 赞同：0
> 
> 时间：2012-12-30T02:26:17.000
> 
> 标签：wordpress, apache, logging, nginx

这是一个非常具体的问题，我不太熟悉 NGIX 或 Wordpress，但情况就是这样。

我正在尝试解析与特定表单提交相关的 IP 地址的访问日志文件。

该表单位于本地路径 /about/ 但在日志中我找不到任何与此请求匹配的页面，我认为这是由于 wordpress 路由系统造成的。表单 html 看起来像这样

```
 <form action="/about/#wpcf7-f7730-p2-o1" method="post" class="wpcf7-form">
 <div style="display: none;">
 <input type="hidden" name="_wpcf7" value="7730">
 <input type="hidden" name="_wpcf7_version" value="3.3.2">
 <input type="hidden" name="_wpcf7_unit_tag" value="wpcf7-f7730-p2-o1">
 <input type="hidden" name="_wpnonce" value="79e7f7dc53">
 </div>
 <p>Your Name (required)<br>
 <span class="wpcf7-form-control-wrap your-name"><input type="text" name="your-name" value="" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required" size="40">       </span> </p>
<p>Your Email (required)<br>
<span class="wpcf7-form-control-wrap your-email"><input type="text" name="your-email"   value="" class="wpcf7-form-control wpcf7-text wpcf7-email wpcf7-validates-as-required  wpcf7-validates-as-email" size="40"></span> </p>
<p>Subject<br>
<span class="wpcf7-form-control-wrap your-subject"><input type="text" name="your-subject" value="" class="wpcf7-form-control wpcf7-text" size="40"></span> </p>
<p>Your Message<br>
<span class="wpcf7-form-control-wrap your-message"><textarea name="your-message" class="wpcf7-form-control  wpcf7-textarea" cols="40" rows="10"></textarea></span> </p>
<p><input type="submit" value="Send" class="wpcf7-form-control  wpcf7-submit"><img class="ajax-loader" src="http://outoftheboxfood.com/wp-content/plugins/contact-form- 7/images/ajax-loader.gif" alt="Sending ..." style="visibility: hidden;"></p>
<div class="wpcf7-response-output wpcf7-display-none"></div>
</form> 
```

我有访问日志，但不知道要查找什么来查找此表单的任何提交。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T12:08:28.407

从访问日志中获取另一行，以便您了解另一页的外观。它可能看起来像 /?p=3453 或只是 /page-slug 没有以下斜杠。

在第一种情况下，您必须找到关于页面的 id，然后在日志中查找它。

如果您不需要自动寻找 ip，您可以在 shell 中使用 grep：

```
grep '/the-page-pattern' access.log 
```

# java - JPA2中使用字符串创建表（类似于JDBC）

> ID：14087773
> 
> 赞同：0
> 
> 时间：2012-12-30T02:26:43.287
> 
> 标签：java, jdbc, jpa-2.0

使用 JDBC，我可以使用 String 来创建表的模式：

```
String sql = "CREATE TABLE REGISTRATION " +
               "(id INTEGER not NULL, " +
               " first VARCHAR(255), " + 
               " last VARCHAR(255), " + 
               " age INTEGER, " + 
               " PRIMARY KEY ( id ))"; 
stmt = conn.createStatement();
stmt.executeUpdate(sql); 
```

有没有办法使用字符串在 JPA2 中指定一个表？

编辑：

如果不清楚：我的意思是不要创建一个`@Entity`类来表示我的表。`String`我想使用`JDBC`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:47:04.257

不。JPA 不提供任何方法来定义表（或非关系数据库中的相应事物）。

JPA 通过实体类处理数据组织的规范；您编写和注释对数据建模的类。然后，JPA 提供者可能会提供一些方法来设置底层存储以匹配实体，但这不是标准化的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T02:41:30.547

我不确定您是否可以通过代码执行此操作。如果不存在，则无法创建表。大多数应用程序使用现有的数据库。

您可以使用可以为您创建模式的 eclipseLink（如果您使用）。阅读此页面[EclipseLink/Examples/JPA/DDL](http://wiki.eclipse.org/EclipseLink/Examples/JPA/DDL)以了解如何启用此功能

您需要在您的`persistence.xml`

```
<property name="eclipselink.ddl-generation" value="drop-and-create-tables"/>
<property name="eclipselink.create-ddl-jdbc-file-name"
     value="createDDL_ddlGeneration.jdbc"/>
<property name="eclipselink.drop-ddl-jdbc-file-name" 
       value="dropDDL_ddlGeneration.jdbc"/> 
```

# r - 为什么将聚合函数应用于分组列？

> ID：14087774
> 
> 赞同：0
> 
> 时间：2012-12-30T02:27:10.550
> 
> 标签：r, aggregate

有一个简单的聚合：

```
dat = read.table(textConnection(
  'ID value
  1 4
  1 7
  2 8
  2 3
  2 3'), header = TRUE)

aggregate(dat,by=list("type"=dat$ID),sum) 
```

我得到结果输出：

```
 type ID value
    1    1  2    11
    2    2  6    14 
```

我想知道：
1.在第一行，为什么ID是2？
2.在第二行，为什么ID是6？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:29:44.157

您请求了每列的总和，按 聚合`dat$ID`。使用此界面，将包括所有列。 `dat$ID`只是一个向量，因此`ID`不会从聚合结果中删除该列。该功能`sum`也适用`ID`于每个组内。

对于第一行，您正在计算`with(dat, sum(ID[dat$ID==1]))`或 1+1。
对于第二行，您正在计算`with(dat, sum(ID[dat$ID==2]))`or 2+2+2
（我有意`dat$ID`在每个索引中指定，而不是`ID`，因为这就是您的`aggregate`调用正在执行的操作。）

使用公式界面`aggregate`更简洁，并给出你想要的。使用此接口，`aggregate`给出`value`列的总和，`ID`并显示在每个聚合组中：

```
> aggregate(value ~ ID, data=dat, sum)
  ID value
1  1    11
2  2    14 
```

# perl - 为什么我的 `my` 变量不能在 sub 中访问？

> ID：14087779
> 
> 赞同：2
> 
> 时间：2012-12-30T02:28:16.993
> 
> 标签：perl, scope, mason

我正在编写一个 Mason 1.x 组件页面，但它的行为不像我预期的那样。perlsub 手册页指出一个`my`变量应该可以在`sub`. 但是下面的代码：

```
my @myOrderBy = @orderBy;
sub sortAll
{
  my $ret = 0;
  foreach my $sortStr (@myOrderBy)
  {
  }
} 
```

给我错误：

> 编译 /opt/rt4/local/plugins/RTx-Foo/html/cf/helpers/ticketQuery.ajx 时出错：变量“@myOrderBy”在 /opt/rt4/local/plugins/RTx-Foo/html 不可用/cf/helpers/ticketQuery.ajx 第 206 行。

（第206行是`foreach`行）

相同的代码在非 Mason 上下文中运行良好。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T02:47:11.073

Mason 显然将您的代码包装在一个 sub 中（就像 mod_perl 一样）。这意味着你最终会得到类似的东西

```
$ perl -we'sub { my $x; sub sortAll { $x } }'
Variable "$x" is not available at -e line 1. 
```

解释很复杂，但归结为：Perl 不支持嵌套的命名子程序。尝试这样做会导致奇怪的错误。

我可以建议你在这种情况下使用`local our $x;`而不是吗？`my $x;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-27T10:38:18.790

您不应该在 Mason 组件中使用命名的 subs，命名空间是共享的。改用这个：

我的 $sortall = sub { ... };

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-12-30T02:31:11.157

`my`变量仅在声明它们的代码块中可见。`sub`是不同的代码块，因此 @myOrderBy 在其中不可用。见[http://www.perlmonks.org/index.pl?node_id=66677](http://www.perlmonks.org/index.pl?node_id=66677)

# restructuredtext - reStructuredText 中的链接图像

> ID：14087784
> 
> 赞同：59
> 
> 时间：2012-12-30T02:28:44.540
> 
> 标签：restructuredtext

如何使用 reStructuredText 创建链接图像？

我找到了

```
.. image:: /path/to/image.jpg 
```

对于图像和外部超链接，如

```
'Python <http://www.python.org/>'_ 
```

对于链接，但我不知道如何组合它们或者是否有可能。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2013-01-17T20:31:42.637

有两种方法：

1.  在内联图像中：

    ```
    .. image:: pageflip-200.png
       :target: pageapplet/index.html 
    ```

2.  有一个参考，比如：

    ```
    Click on my |ImageLink|_

    .. |ImageLink| image:: /images/link.png
    .. _ImageLink: http://link.url/ 
    ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-03-03T20:49:47.430

以下站点提供了 reStructuredText 的参考，还有 Markdown、MediaWiki、asciidoc 和 org-mode。

[http://hyperpolyglot.org/lightweight-markup](http://hyperpolyglot.org/lightweight-markup)

# php - 在php上写文件

> ID：14087789
> 
> 赞同：1
> 
> 时间：2012-12-30T02:29:23.250
> 
> 标签：php, ip, fwrite

我想保留访问者的 ips 并将它们放在一个文件中。
我尝试了 fwrite() 函数，但我认为它是在文件上的 previus ip 上重写。

例子。

ip.txt 为空。

当我运行 write.php 脚本时，在 ip.txt 我有 xxxx ip（我的 ip）

如果我的朋友运行 write.php 脚本，在 ip.txt 我有 aaaa ip（仅限朋友的 ip）

我的ip在哪里？我想在 ip.txt 文件上有以下内容：

```
x.x.x.x   ip1  
a.a.a.a   ip2 
```

write.php 上的代码如下。

```
<?php
$file = fopen("ip.txt","w");
$ip=$_SERVER['REMOTE_ADDR'];
echo fwrite($file,$ip);
fclose($file);
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T02:30:32.953

将“w”更改为“a”

W 表示写入（over），a 表示追加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T02:33:15.153

```
<?php
$file = fopen("ip.txt","a");
$ip=$_SERVER['REMOTE_ADDR'];
echo fwrite($file,$ip);
fclose($file);
?> 
```

看[说明书](http://php.net/manual/en/function.fopen.php)

检查第二个参数的含义。

您选择`w`了覆盖模式。改为尝试`a`模式（附加）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-22T18:57:39.483

数据库版本的“优点”是没有人可以查看数据。如果需要，您可以使用 .htaccess 文件避免访问该文件：

对于 Apache 2.2

```
# Protect log.txt
<Files ./inscription/log.txt>
Order Allow,Deny
Deny from all
</Files> 
```

对于 Apache 2.4

```
# Protect log.txt
<Files ./inscription/log.txt>
Require all denied
</Files> 
```

# php - PHP登录页面安全审计

> ID：14087791
> 
> 赞同：0
> 
> 时间：2012-12-30T02:30:19.717
> 
> 标签：php, security, authentication

我正在对我的登录逻辑进行安全审计，并试图找出哪个密码检查更安全，以及更好的算法。下面是伪 PHP 代码中的两种方法：

方法一：

```
$bcrypt = new Bcrypt();
$password_hash = $bcrypt->hash($_POST['password']);
$result = mysqli_query_check_login($username, $password_hash);

if(mysqli_numb_rows($result) > 0) {
   //is valid
} 
```

方法二：

```
$bcrypt = new Bcrypt();
$result = mysqli_query_check_login($username);

//Note $result->password is a bcrypt hash
if($bcrypt->verify($_POST['password'], $result->password)) {
   //is valid
} 
```

不同之处在于`method I`运行 bcrypt hash，然后在 mysql 查询中发送用户名和散列密码。`Method II`仅通过用户名从 mysql 获取哈希密码，然后在 PHP 中比较这两个值。

安全性有区别吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T02:35:37.663

这些实际上是同一件事。使用这两种方法都不应该有安全隐患。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T02:46:49.000

1.  `Method II`可能会使获取用户信息和更新诸如“登录尝试失败”计数器之类的内容变得更简单。我见过的大多数实现`Method I`只是依赖于`WHERE user=$login AND password=$password`在密码不匹配时不选择用户。

# php - 无法使用 mySQLi 获取要发布的表单数据

> ID：14087797
> 
> 赞同：0
> 
> 时间：2012-12-30T02:31:11.750
> 
> 标签：php, forms, post, mysqli

几乎与上一个问题相同，但是我现在尝试使用 mySQLi 记录一些表单数据。

我提交后，数据不会发布到表格中。我一直在阅读 mySQLi 文档和一些不同的视频，但我无法弄清楚。

提前致谢！

```
<?php

include('config.php');

if (
isset($_POST['store_id']) &&
isset($_POST['item_title']) &&
isset($_POST['date']) &&
isset($_POST['price'])
)

{

$store = get_post('store_id');
$item = get_post('item_title');
$date = get_post('date');
$price = get_post('price');

$query = "INSERT INTO ebay_data VALUES('".$store."', '".$item."', '".$date."', '".$price."')";

$input = $db_mysqli->query($query);

}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T06:32:38.653

当然，您要确保您的配置实际上正在连接。如果我卡住了，我通常只会在一页上做，无论哪种方式尝试：

```
$mysqli = new mysqli('localhost', 'my_user', 'my_password', my_databasename);

/* check connection */
if (mysqli_connect_errno()) {
  printf('Connect failed: %s\n', mysqli_connect_error());
  exit();
}

$query = 'INSERT INTO ebay_data VALUES($store, $item, $date, $price)';
$mysqli->query($query);

printf ('New Record has id %d.\n', $mysqli->insert_id);

/* close connection */
$mysqli->close(); 
```

看看你是否在页面上得到任何东西。还应该仔细检查您的帖子值是否为空。我也遇到了奇怪的问题，将帖子设置为 var 搞砸了 sql 查询，也许试试：

```
if (isset($_POST['store_id']) && isset($_POST['item_title']) && isset($_POST['date']) && isset($_POST['price']))

{
$query = "INSERT INTO ebay_data VALUES($_POST['store_id'], $_POST['item_title'], $_POST['date'], $_POST['price'])";
... 
```

您还需要 100% 检查这些帖子值，以确保您的数据库和用户安全。准备好的陈述是一个开始。你确实需要更多的东西来保证它的安全...... [http://php.net/manual/en/mysqli.quickstart.prepared-statements.php](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)

# c# - 创建简单的自定义 XAML/C# 按钮

> ID：14087801
> 
> 赞同：0
> 
> 时间：2012-12-30T02:31:46.227
> 
> 标签：c#, xaml, windows-8

首先，我是 XAML / C# 的新手（我是 iOS/Android 程序员），所以请多多包涵，不要立即投反对票。我的应用程序有一些包含按钮的 GridView。很多这些按钮是相似的，我想重构它。为简单起见，假设我的按钮只是具有给定颜色的矩形。此颜色可能来自定义 GridView 中特定项目的 Item 类，也可能是硬编码的。我希望矩形在悬停和按下状态时改变颜色。我希望这些颜色也成为参数。

实现这一目标的最佳方法是什么？

1.  我试图创建一个 Button 子类，但不知何故我无法访问 VisualStateManager 中的依赖项属性
2.  我试图在代码隐藏中编写东西，但后来我不确定如何将点击命令委托给 ViewModel 类。

有人可以给我一个小的工作示例吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T02:52:35.967

您可以使用样式模板来做到这一点。

在 Visual Studio 设计器中，右键单击您的按钮，然后选择`Edit Template`然后选择`Edit a Copy...`.

![按钮模板编辑](../Images/16382bb060ad5f6ab27d0503ff6d98ed.png)

然后将提示您命名新样式以及将其存储在哪个文件中。现在，只需给它一个唯一的名称，例如`MyButtonStyle`，然后选择当前文件。

![样式创建弹出窗口](../Images/2482e40acb2726e0e303963e2decdbd9.png)

然后，Visual Studio 会将样式的副本添加到当前的 xaml 文档中，并更新您的按钮以使用新样式。

```
<Button x:Name="Download" Style="{StaticResource MyButtonStyle}"></Button> 
```

在此之后，您可以更新新样式，包括更改不同视觉状态的颜色，例如悬停或单击。

然后，您可以继续在同一文档的其他按钮中使用新样式。要在多个 xaml 文档中使用该样式，您必须将其拉出到一个公共资源文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T22:38:07.570

所以你想使用自定义属性来调整你的按钮。这是使用自定义控件的好时机。您可以创建所需的任何依赖属性并在代码中调整布局。 [http://timheuer.com/blog/archive/2012/03/07/creating-custom-controls-for-metro-style-apps.aspx](http://timheuer.com/blog/archive/2012/03/07/creating-custom-controls-for-metro-style-apps.aspx)

# php - 使用不同的数据度量而不是 KB

> ID：14087802
> 
> 赞同：0
> 
> 时间：2012-12-30T02:32:04.120
> 
> 标签：php

我目前正在修改一些允许我将文件上传到我的网站的代码。我将在配置文件中设置一个选项，允许用户设置最大上传限制。目前必须以千字节为单位输入，我想知道是否可以以 MB 为单位输入？

```
if ((($_FILES["file"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/png")
|| ($_FILES["file"]["type"] == "image/pjpeg"))
**&& ($_FILES["file"]["size"] < 2000000)** <---- Entered in Kilobytes, not MB.
&& in_array($extension, $allowedExts)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:34:11.463

只需这样做：

```
$b = 1000000;
$kb = $b / 1024;
$mb = $kb / 1024;
if($_FILES['size']['size'] < $mb * 2) {
    // do something;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T02:56:10.747

```
<?php
    define('MB', 1024*1024);
    echo 10*MB;
?> 
```

这是另一种方法。

`#define`此外，C 中没有宏。因此，这些东西不可能像 C、C++ 中那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T02:35:54.690

最好定义一个将 MB 转换为字节的函数，即：

```
function MB($mb) {
   return $mb*1024*1024;
} 
```

然后你可以像这样进行比较：

```
($_FILES["file"]["size"] < MB(2000)) 
```

# c++ - C++：使用 GCC 编译器链接文件

> ID：14087807
> 
> 赞同：2
> 
> 时间：2012-12-30T02:33:02.713
> 
> 标签：c++, linker, declaration, undefined-reference

我有三个文件：myh.h；我的.cpp；使用.cpp。以下是文件的内容：

**我的**

```
extern int foo;
void print_foo();
void print(int); 
```

**我的.cpp**

```
#include "myh.h"
#include <iostream>
void print_foo()
{
    std::cout<<foo<<std::endl;
}
void print(int i)
{
    std::cout<<i<<std::endl;
} 
```

**使用.cpp**

```
#include "myh.h"
int main()
{
    foo=7;
    print_foo();
    print(99);
    return 0;
} 
```

GCC 吐出以下错误：

```
my.o:my.cpp:(.text+0x7): undefined reference to `foo'
use.o:use.cpp:(.text+0x10): undefined reference to `foo'
collect2: ld returned 1 exit status 
```

我使用 -c 命令编译文件，它没有给出错误。我使用以下命令链接：

```
g++ -o final my.o use.o 
```

这里有什么问题，我看了其他类似问题的主题，这里的案例很奇怪......

对于好奇的人，这是 Stroustrup 的《使用 C++ 编程原理》一书中的练习练习

**编辑：**我按照 dasblinkenlight 说的做了，在 use.cpp 中我在 foo 前面添加了一个 int （所以现在定义了 foo ），但我仍然得到这个错误：

```
my.o:my.cpp:(.text+0x7): undefined reference to `foo'
collect2: ld returned 1 exit status 
```

这告诉我它也没有在 my.cpp 中定义？如果我必须在任何地方定义它，将它包含在头文件中的意义何在，或者应该如何更恰当地处理它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T02:37:48.843

你得到一个链接器错误，因为你*声明* `foo`了，但你从未*定义*它。

`extern int foo`只是一个声明；它不会导致为`foo`变量分配内存，只会保证您将在其他地方执行此操作。要修复它，您需要将此行添加到其中一个 cpp 文件中，如下所示：

```
#include "myh.h"
int foo;
int main()
{
    foo=7;
    print_foo();
    print(99);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-30T02:37:53.120

问题是`foo`已声明但未定义。您需要`foo`在其中一个翻译单元中进行定义，例如：

```
int foo = 0; 
```

# uinavigationcontroller - 为什么 ADBannerView 在顶部显示导航栏，仅在 iOS 6 中

> ID：14087810
> 
> 赞同：0
> 
> 时间：2012-12-30T02:33:15.360
> 
> 标签：uinavigationcontroller, ios6, uitabbarcontroller, iad, adbannerview

我有一个 iOS 应用程序，其中 iAd 使用 ADBannerView。它在 iOS 5 中完美运行，当用户点击横幅时会全屏显示广告。但是当我在 iOS 6 中运行完全相同的代码时，导航栏和标签栏会显示在广告顶部：

![在此处输入图像描述](../Images/b3156f2714af2193c78e449cf2f990eb.png)

请注意，导航栏后面广告上的“X”按钮可以正常工作以关闭广告，导航栏和标签栏按钮也可以正常工作。

我的应用程序有一个 UITabBarController 作为根控制器，它下面有 4 个 UINavigationControllers。我确实在 didFinishLaunchingWithOptions 中调用了这个：

```
[self.window setRootViewController:tabBarController]; 
```

有什么问题？我猜视图层次结构设置不正确。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T15:13:55.740

我想我找到了问题所在。这很可能是因为我的 UIViewController 层次结构没有正确设置，因为我没有在`addChildViewController:`需要的地方调用。[何时使用 addChildViewController 与 pushViewController](https://stackoverflow.com/questions/8084050/when-to-use-addchildviewcontroller-vs-pushviewcontroller)线程非常有帮助。

我现在推荐的另一种方法是简单地使用`TabbedBanner`Apple [iAdSuite](http://developer.apple.com/library/ios/samplecode/iAdSuite/Introduction/Intro.html)示例中项目中的代码。

# android - Android onTouch Activity 新建 XML 文件错误

> ID：14087816
> 
> 赞同：0
> 
> 时间：2012-12-30T02:33:44.397
> 
> 标签：android, android-layout, android-xml, ontouchlistener

我有 3 个 XML 文件。第一个用于主要活动。它有一个按钮。当我触摸此按钮时，它会起作用并将我发送到第二个 XML 文件。第二个屏幕也有一个按钮。现在，我想在这里做同样的操作，我想去第三个 XML 文件。但它不起作用。

我对所有按钮都做了同样的程序。我找不到我的错在哪里。

`MainPageActivity`：

```
public class MainPageActivity extends Activity {
  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main_page);

    ImageButton b1 = (ImageButton) findViewById(R.id.button_compare);
    ImageButton b2 = (ImageButton) findViewById(R.id.button_find);
    b1.setOnTouchListener(new View.OnTouchListener(){
      @Override
      public boolean onTouch(View comparePage, MotionEvent event) {
        setContentView(R.layout.compare_pagee);
        return true;
      }

    });

    b2.setOnTouchListener(new View.OnTouchListener(){
      @Override
      public boolean onTouch(View findPage, MotionEvent event) {
        setContentView(R.layout.find_page);
        return true;
      }

    });

  }

  @Override
  public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main_page, menu);
    return true;
  }
} 
```

`activity_main_page.xml`：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainPageActivity"
android:id="@+id/mainActivity" >
<ImageButton
android:id="@+id/button_compare"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentLeft="false"
android:layout_alignParentTop="false"
android:adjustViewBounds="true"
android:scaleType="center"
android:src="@drawable/compare"
/>
<ImageButton
android:id="@+id/button_find"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentBottom="true"
android:layout_alignParentLeft="true"
android:layout_marginLeft="69dp"
android:adjustViewBounds="true"
android:src="@drawable/find" 
/>
<TextView
android:id="@+id/textView1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_centerHorizontal="true"
android:layout_centerVertical="true"
android:gravity="center_vertical|center_horizontal"
android:text="Tap the top to Compare!"
android:textAppearance="?android:attr/textAppearanceLarge" />
<TextView
android:id="@+id/textView2"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_alignParentLeft="true"
android:layout_below="@+id/button_compare"
android:gravity="center_vertical|center_horizontal"
android:text="Tap the bottom to Find!"
android:textAppearance="?android:attr/textAppearanceLarge" />
</RelativeLayout> 
```

`Compare`：

```
public class Compare extends Activity{

  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.compare_pagee);

    ImageButton b3 = (ImageButton) findViewById(R.id.compareButton);
    b3.setOnTouchListener(new View.OnTouchListener(){
      @Override
      public boolean onTouch(View comparePage, MotionEvent event) {
        setContentView(R.layout.compare_pagee);
        return true;
      }

    });

  }
} 
```

`compare_pagee.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/backgroundwallpaper"
android:clickable="true"
android:orientation="vertical"
tools:context=".Compare" >
<Spinner
android:id="@+id/spinner2"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_weight="1" />
<Spinner
android:id="@+id/spinner3"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_weight="1" />
<Spinner
android:id="@+id/spinner5"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_weight="1" />
<ImageButton
android:id="@+id/compareButton"
android:layout_width="139dp"
android:layout_height="74dp"
android:src="@drawable/comparebutton" />
<Spinner
android:id="@+id/spinner6"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_weight="1" />
<Spinner
android:id="@+id/spinner4"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_weight="1" />
<Spinner
android:id="@+id/spinner1"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:layout_weight="1" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:07:57.190

你没有开始新的活动，你只是在第一个活动中切换布局。所以第一个按钮会起作用，因为它在 MainActivity 中分配了一个监听器。但是`b3`，另一个 Activity 永远不会启动，因此根据您想要执行的操作，您可以为每个按钮单击启动一个新的 Activity，或者您可以将`b3`Listener 移到里面`MainActivity`。

第一种方法（新活动）

```
ImageButton b1 = (ImageButton) findViewById(R.id.button_compare);
ImageButton b2 = (ImageButton) findViewById(R.id.button_find);
b1.setOnTouchListener(new View.OnTouchListener(){
  @Override
  public boolean onTouch(View comparePage, MotionEvent event) {
    startIntent (new Intent (MainPageActivity.this, Compare.class));
    return true;
  }

});

b2.setOnTouchListener(new View.OnTouchListener(){
  @Override
  public boolean onTouch(View findPage, MotionEvent event) {
    startIntent (new Intent (MainPageActivity.this, Find.class));//You will NEED to make a new Activity called Find.
    return true;
  }

}); 
```

第二种方式（在同一活动中重置内容视图）。我不推荐它，因为它使事情变得混乱并且违背了 Activity 应该是什么，但它仍然是一个（坏的）选项。

```
ImageButton b1 = (ImageButton) findViewById(R.id.button_compare);
ImageButton b2 = (ImageButton) findViewById(R.id.button_find);
b1.setOnTouchListener(new View.OnTouchListener(){
  @Override
  public boolean onTouch(View comparePage, MotionEvent event) {
    setContentView(R.layout.compare_pagee);
    ImageButton b3 = (ImageButton) findViewById(R.id.compareButton);
    b3.setOnTouchListener(new View.OnTouchListener(){
      @Override
      public boolean onTouch(View comparePage, MotionEvent event) {
        setContentView(R.layout.compare_pagee);
        return true;
      }

    });
    return true;
  }

});

b2.setOnTouchListener(new View.OnTouchListener(){
  @Override
  public boolean onTouch(View findPage, MotionEvent event) {
    setContentView(R.layout.find_page);
    return true;
  }

});

} 
```

如您所见，b3 的 Listener 极其多余——它没有做任何有用的事情。

我建议重新考虑你想让你的代码做什么，并正确地重写它，因为这不是正确的结构。

# sql - 如何编写触发器以防止预订日期重叠

> ID：14087817
> 
> 赞同：0
> 
> 时间：2012-12-30T02:33:58.613
> 
> 标签：sql, triggers

我有一个简单的预订表：

```
id
date_start (date)
date_end (date) 
```

编写触发器以禁止插入与另一个预订重叠的预订的正确方法是什么？

基本上，我不能有 2 个相互重叠的预订。

有没有解决这个问题的通用方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T02:38:21.250

编写一个触发器`ON INSERT OR UPDATE`，当满足以下条件时抛出异常：

```
EXISTS
(
    SELECT 1
    FROM bookings
    WHERE date_start <= NEW.date_end
    AND date_end >= NEW.date_start
    AND (INSERTING OR id <> NEW.id)
) 
```

该`date_start <= NEW.date_end AND date_end >= NEW.date_start`条件将匹配任何现有的重叠与新记录。在 UPDATE 的情况下，该`INSERTING OR id <> NEW.id`条件将排除当前记录（否则它将始终与自身重叠）。

请注意，如果您愿意，可以删除最后一个条件并使用两个单独的触发器 - 一个用于 INSERT，一个用于 UPDATE。

您可能需要根据您的 RDBMS 更改确切的查询，但逻辑应该相同。请注意，通常从触发器引发异常将导致事务回滚并且不允许新的预订。

# javascript - 动态图像高度

> ID：14087823
> 
> 赞同：-4
> 
> 时间：2012-12-30T02:34:51.473
> 
> 标签：javascript, jquery, html, css

所以我真的不知道该怎么做，但这就是我想要做的。我正在从 API 服务器调用静态图像，该服务器使用参数高度和宽度来了解生成图像时应该有多大。

现在我的网站是 css 动态的，这意味着它可以根据浏览器的尺寸进行缩放，甚至适用于移动浏览器。我的问题是，我将如何确定高度和宽度的参数。我正在考虑使用 javascript 来获取类似大小的 div 的高度和宽度，然后使用它们。

还有其他想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T02:37:34.507

只需设置`width:100%`（或任何宽度），高度将自动成为要保持接受比的正确尺寸。

# python - 如何使用 sqlautocode？

> ID：14087828
> 
> 赞同：1
> 
> 时间：2012-12-30T02:35:44.803
> 
> 标签：python, orm, sqlalchemy

我已经从它的站点下载了一个 sqlautocode zip 文件。并运行：

```
python e:\sqlautocode\setup.py install 
```

但是当我尝试：

```
import sqlautocode 
```

它说“没有名为 sqlautocode 的模块”。

一些博客说：

```
sqlautocode.py xxx 
```

但是我在我的系统中找不到任何名为 sqlautocode.py 的文件。

那么，我应该怎么做才能运行它？

谢谢！

这是我安装 sqlautocode 后得到的：

```
C:\Users\Aman>python f:\sqlautocode\setup.py install
running install
running bdist_egg
running egg_info
writing requirements to sqlautocode.egg-info\requires.txt
writing sqlautocode.egg-info\PKG-INFO
writing top-level names to sqlautocode.egg-info\top_level.txt
writing dependency_links to sqlautocode.egg-info\dependency_links.txt
writing entry points to sqlautocode.egg-info\entry_points.txt
warning: manifest_maker: standard file 'setup.py' not found

reading manifest file 'sqlautocode.egg-info\SOURCES.txt'
writing manifest file 'sqlautocode.egg-info\SOURCES.txt'
installing library code to build\bdist.win32\egg
running install_lib
warning: install_lib: 'build\lib' does not exist -- no Python modules to install

creating build\bdist.win32\egg
creating build\bdist.win32\egg\EGG-INFO
copying sqlautocode.egg-info\PKG-INFO -> build\bdist.win32\egg\EGG-INFO
copying sqlautocode.egg-info\SOURCES.txt -> build\bdist.win32\egg\EGG-INFO
copying sqlautocode.egg-info\dependency_links.txt -> build\bdist.win32\egg\EGG-INFO
copying sqlautocode.egg-info\entry_points.txt -> build\bdist.win32\egg\EGG-INFO
copying sqlautocode.egg-info\requires.txt -> build\bdist.win32\egg\EGG-INFO
copying sqlautocode.egg-info\top_level.txt -> build\bdist.win32\egg\EGG-INFO
copying sqlautocode.egg-info\zip-safe -> build\bdist.win32\egg\EGG-INFO
creating 'dist\sqlautocode-0.6b1-py2.7.egg' and adding 'build\bdist.win32\egg' to it
removing 'build\bdist.win32\egg' (and everything under it)
Processing sqlautocode-0.6b1-py2.7.egg
removing 'c:\python27\lib\site-packages\sqlautocode-0.6b1-py2.7.egg' (and everything under it)
creating c:\python27\lib\site-packages\sqlautocode-0.6b1-py2.7.egg
Extracting sqlautocode-0.6b1-py2.7.egg to c:\python27\lib\site-packages
sqlautocode 0.6b1 is already the active version in easy-install.pth
Installing sqlautocode-script.py script to C:\Python27\Scripts
Installing sqlautocode.exe script to C:\Python27\Scripts

Installed c:\python27\lib\site-packages\sqlautocode-0.6b1-py2.7.egg
Processing dependencies for sqlautocode==0.6b1
Searching for sqlalchemy==0.8.0b2
Best match: sqlalchemy 0.8.0b2
Processing sqlalchemy-0.8.0b2-py2.7.egg
sqlalchemy 0.8.0b2 is already the active version in easy-install.pth

Using c:\python27\lib\site-packages\sqlalchemy-0.8.0b2-py2.7.egg
Finished processing dependencies for sqlautocode==0.6b1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:01:05.980

您能否提供有关安装的更多信息？我只能给你一些建议。

1.  检查安装日志，是否有一些错误信息。
2.  检查您安装到的 python 版本。
3.  我推荐使用 pip 安装第三个库，它可以自动安装依赖项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:48:58.720

根据您对 jinghli 的回答的评论，我怀疑您的 PATH 环境变量中缺少 C:\Python27\Scripts 。

虽然将 sqlautocode 文件夹移动到 C:\Python27 已经解决了这个特定问题，但您将来在安装其他模块时会遇到类似的问题。

将 C:\Python27\Scripts 添加到您的 PATH 变量（记住注销并重新登录）应该是理所当然的事情，但是您可以通过修改 PATH 来测试这一点，将自动编码文件夹移回其原始位置并看看它是否仍然有效。

# variables - 从单独的 mixin 访问 less 变量

> ID：14087832
> 
> 赞同：4
> 
> 时间：2012-12-30T02:36:38.187
> 
> 标签：variables, less

基本上我想从 mixin 访问变量 @b 以在其他地方使用。我正在尝试做的一个例子如下，但这不起作用：

```
.mixin (@x:@x, @y:@y, @z:@z) {
       @b: (@x + @y) / @z; 
}

.item (@x:@x, @y:@y, @z:@z) {
       .mixin (@x, @y, @z);
       margin-left: @b;
 }

.item2 (@x:@x, @y:@y, @z:@z) {
       .mixin (@x, @y, @z);
       margin-right: @b;
} 
```

任何帮助将不胜感激，并提前感谢您。

杰森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T02:53:22.730

显然，您的主要问题是变量范围。根据[我的另一个答案](https://stackoverflow.com/questions/11405742/can-you-set-a-variable-inside-a-mixin-in-less-css/11647477#11647477)，在某些情况下，您可以在 mixin 中设置一个变量并使其在该 mixin 之外可用，但正如该答案所示，LESS 中的一个明显错误会阻止通过传入其他变量来设置该变量（这就是你需要的）。注意：据说该错误已修复，因此 LESS 编译器的最新下载可能会解决您的问题；我知道我通常测试的在线编译器仍然不允许这种类型的变量设置。

所以这是另一个建议的替代方案：在你的内部创建你需要的嵌套参数混合，`.mixin`它可以`@b`完全访问。

所以这个**LESS**

```
@x: 3;
@y: 3;
@z: 2;

.mixin (@x:@x, @y:@y, @z:@z, @bProp: null) {
       //all your other mixin code

       @b: (@x + @y) / @z;

       //set up pattern matching for props
       //that need @b

       .prop(null) {} //default none
       .prop(ml) {
          margin-left: @b;
       }
       .prop(mr) {
          margin-right: @b;
       }
       //call the property
       .prop(@bProp);
}

.item (@x:@x, @y:@y, @z:@z) {
       //this is a pure default of .mixin()
       .mixin (@x, @y, @z); 
 }

.item1 (@x:@x, @y:@y, @z:@z) {
       //this is set up to call the margin-left pattern
       .mixin (@x, @y, @z, ml);
 }

.item2 (@x:@x, @y:@y, @z:@z) {
       //this is set up to call the margin-right pattern
       .mixin (@x, @y, @z, mr);
}

.item(); 
.item1(); 
.item2(6,6,3); 
```

生成这个**CSS**（显然它实际上会在选择器中使用，但我想你明白了）。

```
//note that nothing is produced for .item() because it
//defaults to no extra properties other than the base .mixin()
margin-left: 3;
margin-right: 4; 
```

# ruby-on-rails - Rails 缓存没有过期

> ID：14087833
> 
> 赞同：0
> 
> 时间：2012-12-30T02:36:41.537
> 
> 标签：ruby-on-rails, caching, memcached, dalli

由于某种原因，以下内容不会在 10 秒后过期

```
def rcache_value
  @random_val_from_cache = Rails.cache.fetch("random_val_from_cache",:expires_in=>10.seconds) do
  rand 10000
end 
```

`@random_val_from_cache`我在我的应用程序的页脚中输出。我的参数错了吗？我在 Rails 3 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T00:14:48.023

找到了答案。expires_in 已被弃用，`fetch`取而代之的是在 write 中设置它。因此，您必须编写检查以查看它是否已存在于缓存中，如果不存在则进行写入

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T05:57:39.170

好吧，假设您的示例中的语法错误只是 SO 上的一个错字，那么问题很可能是因为您使用的是实例变量。缓存的值被设置为该实例变量，除非手动这样做，否则不会重置该实例变量，或者除非重新加载类（这在服务器重新启动之前不会发生）。你应该这样做：

```
def rcache_value
  Rails.cache.fetch("random_val_from_cache", :expires_in => 10.seconds) do
    rand 10000
  end
end 
```

并调用它：

```
<%= rcache_value %> 
```

# javascript - 节点重启时丢失所有 Kue/Redis 作业

> ID：14087838
> 
> 赞同：0
> 
> 时间：2012-12-30T02:37:37.247
> 
> 标签：javascript, node.js, redis, jobs

我正在查看一些在 Node 中实现作业队列的选项，并偶然发现了使用 Redis 的 Kue。

是不是因为作业存储在 Redis 中，如果我要重新启动 Node 或服务器，所有作业都会丢失？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T03:01:52.487

Redis 是内存中的持久存储。它在 conf 文件中配置的一定时间后将数据存储在键值对中。因此，即使服务器或节点出现故障或重新启动，您提交的数据也将保持不变。

# php - HTML 文件 选择目录中的特定文件

> ID：14087844
> 
> 赞同：-4
> 
> 时间：2012-12-30T02:38:49.097
> 
> 标签：php, jquery, html, file, upload

是否可以对 HTML 文件输入进行编程以选择目录或卷中的特定文件。

单击文件输入按钮时，文件选择器打开，用户选择文件夹或拇指驱动器。然后在 jQuery 中，在所选目录中选择一个特定文件。

例如，用户在文件选择器中选择一个拇指驱动器，然后在提交表单时，只上传一个特定的（隐藏的）文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T02:39:48.813

不，出于安全原因，这是不可能的。

# c# - C# - 使用 Twitterizer 的“无效令牌”

> ID：14087845
> 
> 赞同：0
> 
> 时间：2012-12-30T02:38:53.577
> 
> 标签：c#, twitterizer

我对这段代码有疑问：

```
OAuthTokens tokens = new OAuthTokens();
tokens.AccessToken = "****";
tokens.AccessTokenSecret = "****";
tokens.ConsumerKey = "****";
tokens.ConsumerSecret = "****"; 
```

小程序（根据要求）：

```
//cutted out default "using"'s
using Twitterizer;

namespace Mustache_Tweet_App
{
    public partial class Main : Form
    {
        // config
        OAuthTokens Tokens = new OAuthTokens();
        Tokens.AccessToken = "...";
        Tokens.AccessTokenSecret = "...";
        Tokens.ConsumerKey = "...";
        Tokens.ConsumerSecret = "...";
        Tokens.RequestToken = Twitterizer.OAuthUtility.GetRequestToken(Tokens.ConsumerKey, Tokens.ConsumerSecret, "");
        public Main()
        {
            InitializeComponent();
        }

        private void GetAuthKey_Click(object sender, EventArgs e)
        {
            String AuthUri = Twitterizer.OAuthUtility.BuildAuthorizationUri();
            System.Diagnostics.Process(AuthUri);
            MessageBox.Show("Please authorize and copy the key then click OK and paste it into the the key box.", "Info");
        } 
    }
} 
```

错误：

```
****.Main.tokens' is a 'field' but is used like a 'type'
Invalid token '=' in class, struct, or interface member declaration 
```

在所有“令牌”上获得相同的错误。

使用 Twitterizer 2-2-4。也使用 Visual Studio 2012。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T09:58:28.077

该`OAuthTokens`对象没有属性`RequestToken`

并且`OAuthTokens.ConsumerKey`and`OAuthTokens.ConsumerSecret`没有`get`访问器，因此您不能按照您的方式使用它们。

为什么你不想要请求令牌？您已经在`Tokens`对象中拥有它们。

# python - Python psycopg2 - 记录事件

> ID：14087853
> 
> 赞同：7
> 
> 时间：2012-12-30T02:40:56.227
> 
> 标签：python, postgresql, psycopg2, pgadmin

我正在使用 psycopg2，我在将事件（执行的查询、通知、错误）记录到文件时遇到问题。我想像在 PgAdmin 历史记录窗口中一样生效。

例如我正在执行这个查询：

```
insert into city(id, name, countrycode, district, population) values (4080,'Savilla', 'ESP', 'andalucia', 1000000) 
```

在 PgAdmin 我看到这样的效果：

```
Executing query: 
insert into city(id, name, countrycode, district, population) values (4080,'Sevilla', 'ESP', 'andalucia', 1000000)

Query executed in 26 ms.
One row affected. 
```

我可以使用 psycopg2 获得类似的效果吗？

我尝试使用[LoggingCursor](http://initd.org/psycopg/docs/advanced.html#connection-and-cursor-factories)，但对我来说并不满意，因为它只记录查询。

感谢帮助。

* * *

编辑：

我的代码：

```
conn = psycopg2.extras.LoggingConnection(DSN)
File=open('log.log','a')
File.write('================================')
psycopg2.extras.LoggingConnection.initialize(conn,File)

File.write('\n'+time.strftime("%Y-%m-%d %H:%M:%S") + '---Executing query:\n\t')
q="""insert into city(id, name, countrycode, district, population) values (4080,'Sevilla', 'ESP', 'andalucia', 10000)"""
c=conn.cursor()
c.execute(q)
File.write('\n'+time.strftime("%Y-%m-%d %H:%M:%S") + '---Executing query:\n\t')
q="""delete from city where id = 4080"""
c=conn.cursor()
c.execute(q)
conn.commit()
File.close() 
```

这是我的输出日志：

```
================================
2012-12-30 22:42:31---Executing query:
    insert into city(id, name, countrycode, district, population) values (4080,'Sevilla', 'ESP', 'andalucia', 10000)

2012-12-30 22:42:31---Executing query:
    delete from city where id = 4080 
```

我想在日志文件中查看受影响的行数和错误信息。最后，我想要一个包含所有事件的完整日志文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T23:06:42.863

据我所知，您有三个 LoggingCursor 类未满足的要求

1.  查询执行时间
2.  受影响的行数
3.  包含所有事件的完整日志文件。

对于第一个要求，请查看 psycopg2.extras 中[MinTimeLoggingConnection](https://github.com/dvarrazzo/psycopg/blob/devel/lib/extras.py)类的源代码。它子类 LoggingConnection 并输出超过最小时间的查询的执行时间（注意这需要与 MinTimeLoggingCursor 结合使用）。

对于第二个需求，游标类的[rowcount属性指定](http://initd.org/psycopg/docs/cursor.html?highlight=rows%20affected#cursor.rowcount)

> 最后一次执行*() 产生的行数（对于像 SELECT 这样的 DQL 语句）或受影响的（对于像 UPDATE 或 INSERT 这样的 DML 语句）

因此，应该可以创建您自己的包含此附加功能的 LoggingConnection 和 LoggingCursor 类型。

我的尝试如下。只需在您的代码中替换为，这一切都应该有效`LoggingConnection`。`LoggingConnection2`作为旁注，您不需要为第二个查询创建新游标。`c.execute(q)`定义第二个查询后，您可以再次调用。

```
import psycopg2
import os
import time
from psycopg2.extras import LoggingConnection
from psycopg2.extras import LoggingCursor

class LoggingConnection2(psycopg2.extras.LoggingConnection):
    def initialize(self, logobj):
        LoggingConnection.initialize(self, logobj)

    def filter(self, msg, curs):
        t = (time.time() - curs.timestamp) * 1000
        return msg + os.linesep + 'Query executed in: {0:.2f} ms. {1} row(s) affected.'.format(t, curs.rowcount)

    def cursor(self, *args, **kwargs):
        kwargs.setdefault('cursor_factory', LoggingCursor2)
        return super(LoggingConnection, self).cursor(*args, **kwargs)

class LoggingCursor2(psycopg2.extras.LoggingCursor):    
    def execute(self, query, vars=None):
        self.timestamp = time.time()
        return LoggingCursor.execute(self, query, vars)

    def callproc(self, procname, vars=None):
        self.timestamp = time.time()
        return LoggingCursor.execute(self, procname, vars) 
```

我不确定如何创建所有事件的完整日志，但连接类的[notices 属性可能很有趣。](http://initd.org/psycopg/docs/connection.html#connection.notices)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-11T16:31:04.117

也许您无需编写任何代码即可获得所需的内容。

postgresql 本身有一个名为“log_min_duration”的选项可能会帮助您。

您可以将其设置为零，并且将记录每个查询及其运行时成本。或者您可以将其设置为某个正数，例如 500，并且 postgresql 只会记录运行至少需要 500 毫秒的查询。

您不会在日志文件中获得查询结果，但您将获得准确的查询，包括插值绑定参数。

如果这对您很有效，稍后请查看 auto_explain 模块。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T15:17:59.513

看看 LoggingCursor 是如何实现的，然后编写自己的游标子类：非常简单。

# javascript - 如何对所有表格单元格进行操作（隐藏），其中 ID 不包含某些字符串

> ID：14087856
> 
> 赞同：0
> 
> 时间：2012-12-30T02:41:43.027
> 
> 标签：javascript, jquery, user-interface

我得到了整个表格，其中包含具有特定 ID 的单元格，例如：“2012-01-01_841241”等。日期，然后是一些数字。

我想过滤我的表格，所以我发送了一些请求并获取例如三个应该只显示的数字。

我想隐藏 ID 中没有这些数字的所有单元格 - 除了遍历所有单元格并检查它们的 ID 是否与我的 ID 字符串匹配之外，还有其他方法吗？（看起来很贵）。

所以，我试图避免它（特别是当我有一个 someNumbers 表时:)）：

```
$('td').each(function(){
    if($(this).attr("id") != someNumber) $(this).hide();
}) 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:06:06.037

你有没有考虑过这样的事情：你总是可以隐藏所有的 td，而不是只显示你想显示的那些

```
var id = getCurrentIdNotToHide();
$('td#'+id).show(); 
```

但我不确定这是否是更好的解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:08:21.740

好吧，这是一种可以做到的方法（[此处为 jsFiddle](http://jsfiddle.net/33QjR/1/)）：

本质上，您可以隐藏所有内容，然后使您想要的内容可见：

```
 $("#myTable td").hide();
showCells("2012-01-01_841242", "2012-01-01_841247");

function showCells() {
 for (var i = 0; i < arguments.length; i++)   
 {
     $("#" + arguments[i]).show();
 }
} 
```

然而，在表格上执行此操作的问题在于，您最终可能会`<td>`在各种`<tr>`标签中使用奇数数量的标签，因此您可能希望找到一种不同的方式来布置它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T03:44:41.743

使用此代码：

```
$('td:not([id="' + someNumber + '"])').hide(); 
```

# java - Struts：生成 HTML 而不是简单的消息？

> ID：14087858
> 
> 赞同：1
> 
> 时间：2012-12-30T02:42:31.967
> 
> 标签：java, jsp, struts

在我的 ApplicationResource.properties 文件中，我可以使用“welcome.message="Welcome"”之类的内容

我会在我的jsp页面中生成它......

```
<h3><bean:message key="welcome.message"/></h3> 
```

但是比如说，我有很多 html 要生成，比如那个部分的列表和列表项......

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T03:15:33.570

没有什么可以阻止您在属性文件中提供整个 HTML 代码。例如，如果您希望文本显示为粗体，您可以这样做`<B>Bold Text</B>`。因此，对于您的选择框，您可以将整组 HTML 标记放在一个属性中，并将其设置在您想要设置的位置。

至于动态内容，您可以在操作类中获取对象列表，然后使用**struts UI 标签**创建列表或您想要的任何内容。

# node.js - 如何处理在单个服务器上运行的多个应用程序？

> ID：14087860
> 
> 赞同：1
> 
> 时间：2012-12-30T02:42:47.067
> 
> 标签：node.js, chef-infra

我是厨师的新手。我刚刚创建了一个部署 node.js 应用程序的说明书，配置 Nginx，然后将应用程序作为 1 个或多个由 Nginx “负载平衡”的工作人员启动。它工作得很好。我确保保持它非常通用，并且所有应用程序级别的配置都是通过属性完成的。

现在我正在尝试考虑一个实例，其中我有多个 node.js 应用程序在同一台服务器上运行。例如，主 API 应用程序和另一个注册为 Gearman 工作者的应用程序。

我该怎么做呢？我是否会简单地创建另一个特定于该应用程序的食谱，确保它包含通用食谱的食谱，然后仅为该应用程序的食谱进行属性覆盖？

或者，如果我不再使用应用程序配置的属性，而是使用 data_bags 会更好吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T17:20:43.463

我会将 nginx 和 node.js 安装/配置分离到单独的说明书中。

如果您必须在 node.js 上运行多个不同的应用程序，我认为可以为 node.js 说明书中的每个应用程序添加一个配方，并确保每个应用程序都包含 node.js 本身的安装。

如果你必须有多个实例 1 并且运行相同的应用程序/服务，那么最好使用具有不同属性或数据包的一个配方来引入实例之间的差异。

还有更具体的问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T23:43:34.163

您应该使用角色[角色](http://wiki.opscode.com/display/chef/Roles)来管理服务器上的多个说明书。

我不太确定你的情况，但根据你的描述，我会创建 3 本食谱。一种安装 nginx，一种安装您的应用程序，另一种进行节点特定配置和部署。将这些捆绑到角色“app_server”中，并将角色放入 run_list。

这使您的应用程序更具可组合性，并且将来更容易更改任何部分。

# c - C if 语句的问题？

> ID：14087862
> 
> 赞同：0
> 
> 时间：2012-12-30T02:43:43.813
> 
> 标签：c

我正在尝试练习制作 if 语句，但运气不佳。现在我正在尝试使用 if 语句制作一个非常简单的三角计算器，但我无法让它工作。实际问题发生在输入三角函数（正弦、余弦、正切）之后。这就是发生的事情。
1\. 我编译它
2\. 它输出用户提示
3\. 我输入函数并回车
4\. 程序跳转到一个新的空白行
5\. 没有任何反应，如果我按下回车，程序关闭

这是代码本身。如果我做了一些非常愚蠢的事情，请善待，我对 C 很陌生。

```
#include <stdio.h>
#include <math.h>
#include <stdlib.h>

int main(void)
{
    float x;
    float a, o, h;
    float sine, cosine, tangent;

    printf("Enter the trig function you wish to calculate: ");
    scanf("%f", &x);

    if (x == sine)
    {    printf("Enter the value of the opposite leg: ");
         scanf("%f", &o);
         printf("Enter the value of the hypotenuse: ");
         scanf("%f", &h);

         sine = o / h;
         printf("The sine is equal to %f", sine);
    }

    if (x == cosine)
    {    printf("Enter the value of the adjacent leg: ");
         scanf("%f", &a);
         printf("Enter the value of the hypotenuse: ");
         scanf("%f", &h);

         cosine = a / h;
         printf("The cosine is equal to %f", cosine);
    }

    if (x == tangent)
    {    printf("Enter the value of the opposite leg: ");
         scanf("%f", &o);
         printf("Enter the value of the adjacent leg: ");
         scanf("%f", &a);

         tangent = o / a;
         printf("The tangent is equal to %f", tangent);
    }

    getch();
} 
```

感谢所有真正有帮助并且对我缺乏理解的人并不粗鲁，我没有意识到我必须添加一个数字字符而不仅仅是一个字符。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-30T02:48:49.550

### 简单（最小）的修复

是的，你即将做一些经验丰富的程序员会称之为愚蠢的事情，但它们是新手会犯的那种错误（你既不是第一个也不是最后一个犯的错误）。

```
int main(void)
{
    float x;
    float a, o, h;
    float sine, cosine, tangent;

    printf("Enter the trig function you wish to calculate: ");
    scanf("%f", &x);

    if (x == sine) 
```

主要问题是您没有给出`sine`,`cosine`或`tangent`值，因此您不知道输入什么来使相等起作用。

第二个问题是比较浮点数是否相等不是一个好主意。

您可能最好使用以下方法：

```
int main(void)
{
    int x;
    float a, o, h;
    enum { sine, cosine, tangent };

    printf("Enter the trig function (0 = sine, 1 = cosine, 2 = tangent): ");
    scanf("%d", &x);

    if (x == sine) 
```

这或多或少是正统的，读取和比较整数是否相等是可靠的。您必须更改操作，因为我已经抢占了 names `sine`、`cosine`和`tangent`作为枚举（整数）常量。您可以通过对常量使用大写名称（这是非常正统的）或使用名称前缀来解决这个问题，或者...

```
int main(void)
{
    int x;
    float a, o, h;
    float sine, cosine, tangent;
    enum { SINE, COSINE, TANGENT };

    printf("Enter the trig function (0 = sine, 1 = cosine, 2 = tangent): ");
    scanf("%d", &x);

    if (x == SINE) 
```

* * *

### 更友好的输入

正如您可能从下面的评论中收集到的那样，最好允许用户输入他们想要输入的函数的名称，而不是让他们输入一个编码数字。可靠地编码有点棘手，这就是我使用数字在上面留下答案的主要原因。

```
#include <stdio.h>
#include <string.h>

int main(void)
{
    char line[4096];

    printf("Enter trig function you wish to calculate: ");
    if (fgets(line, sizeof(line), stdin) != 0)
    {
        char *nl = strchr(line, '\n');
        if (nl != 0)
            *nl = '\0';
        if (strcmp(line, "sine") == 0)
        {
            /* Process sine */
        }
        else if (strcmp(line, "cosine") == 0)
        {
            /* Process cosine */
        }
        else if (strcmp(line, "tangent") == 0)
        {
            /* Process tangent */
        }
        else
        {
            fprintf(stderr, "Unrecognized trig function (%s)\n", line);
        }
    }
} 
```

4096 只是一个很大的整数，它是如此之长，以至于任何人都不太可能进入比这更长的行。如果他们确实输入了这样的一行，那么 GIGO 和他们将得到他们应得的（这将是一个礼貌的错误消息，表明他们输入的名称未被识别）。

这仍然不是美妙的代码。去除前导和尾随空格可能是合理的，并且可能会将输入大小写转换为小写，并且其中一条消息可能应该标识有效的函数名称。可能会重复代码循环，但是您需要一个函数来提示和读取响应等。所有这些都以牺牲更多代码为代价增加了可用性，这对于初学者来说不必要地使事情复杂化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T02:49:09.307

您的`if`语句不起作用，因为您正在将输入值`x`与尚未设置的浮点值进行比较。我想你想要做的是：

```
int x;
printf("Enter the trig function you wish to calculate\n");
printf("1=sine, 2=cosine, 3=tangent: ");
scanf("%d", &x);

if (x == 1)
{
    // do sine
}
else if (x == 2)
{
    // do cosine
}
else if (x == 3)
{
    // do tangent
}
else
{
    printf("I don't know that function.\n");
} 
```

愚蠢至极？呐。当你第一次开始编程时，这是一个很容易犯的错误。坚持下去。我们都去过那里。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T02:59:41.760

我不确定你从什么开始进入程序，但这就是你的错误所在。如果您正在输入一个字符数组（一个“字符串”），并且正在传递给`x`，则无法将其与浮点值进行比较。此外，您的`sine`、`cosine`和`tangent`变量没有值/没有被分配任何东西。要解决您的问题，请为您的变量分配一个数字，例如`float sine = 1;`并确保您在命令行中输入要传递给`x`的内容是一个数字。如果要输入“余弦”并将该值传递给`x`，则必须将`x`变量更改为 char 数组，例如`char[] x = ""`，然后更改`sine`,`cosine`和`tangent`变量也是字符数组。如果您确实将变量更改为数组，请记住`&`从 scanf 语句中删除 ，例如 -> `scanf("%s", x);`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-30T02:48:45.297

现在，这段代码：

```
float x;
float a, o, h;
float sine, cosine, tangent;

printf("Enter the trig function you wish to calculate: ");
scanf("%f", &x);

if(x == sine) 
```

...将一个值读入`x`，然后将其与 的当前值进行比较`sine`。不幸的是，您还没有初始化`sine`，所以它与一些未知的半随机值进行比较。

当您与 和 进行比较时`cosine`，`tangent`您所做的更多相同。

这些比较都没有有意义的结果（例如，它们很可能都是真的）。

猜测一下，您可能希望用户输入一个字符串，然后将其与值`"sine"`、`"cosine"`和进行比较`"tangent"`，使用`strcmp`。

# cuda - 结构和 Cuda C

> ID：14087866
> 
> 赞同：2
> 
> 时间：2012-12-30T02:44:23.043
> 
> 标签：cuda

我不记得能够将构造函数和重载运算符添加到普通 C 中的结构。在我正在阅读的一本书中，它在 CUDA C 的示例中使用了这两者。

如果 C 和 CUDA C 中的结构之间存在任何差异，对它们的一般解释是什么？在书中，他们在 CUDA C 中使用了 C++ 风格的结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-27T04:20:26.383

1）C结构只能包含数据成员，但CUDA C更像是C++风格的类，可以包含函数等。

2) CUDA struct 和 CUDA class 之间唯一的主要区别是前者所有成员默认都是公共的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-16T17:49:20.283

CUDA C 实际上是 CUDA C++ 并且依赖于 C++ 编译器。

根据经验`nvcc`，编译实际的 C 代码有困难（出于同样的原因，C++ 编译器可能会这样做）。

曾经有一个`--host-compilation`选项可以将编译器从 切换`C`到 ，`C++`但它从来没有工作过。（见[这里](https://devtalk.nvidia.com/default/topic/508479/cuda-programming-and-performance/nvcc-forces-c-compilation-of-cu-files/#entry1340190)）

# android - Android上未调用警报

> ID：14087868
> 
> 赞同：0
> 
> 时间：2012-12-30T02:44:39.097
> 
> 标签：android, alarmmanager

因此，我正在尝试在我的 Android 应用程序中实现此站点的重复功能 - [http://www.java2s.com/Code/Android/Core-Class/Exampleofschedulingoneshotandrepeatingalarms.htm](http://www.java2s.com/Code/Android/Core-Class/Exampleofschedulingoneshotandrepeatingalarms.htm) - 但由于某种原因它没有调用该类是代码摘录。

```
public class MainActivity extends Activity implements SensorEventListener {

// Schedule repeating alarm

          Intent intent = new Intent(MainActivity.this, RepeatingAlarm.class);
          PendingIntent sender = PendingIntent.getBroadcast(MainActivity.this, 0,
              intent, 0);

          // We want the alarm to go off 30 seconds from now.
          long firstTime = SystemClock.elapsedRealtime();
          firstTime += 15 * 1000;

          // Schedule the alarm!
          AlarmManager am = (AlarmManager) getSystemService(ALARM_SERVICE);
          am.setRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP, firstTime,
              15 * 1000, sender);

          // Tell the user about what we did.
            Toast.makeText(
                    getApplicationContext(),
                    "Scheduled", Toast.LENGTH_LONG)
                    .show();

}

//Schedule alarm for data upload
class RepeatingAlarm extends BroadcastReceiver {
      @Override
      public void onReceive(Context context, Intent intent) {
            Toast.makeText(
                    context,
                    "ALARMED!", Toast.LENGTH_LONG)
                    .show();
      }
} 
```

如果它有帮助，完整的代码在这里：[https ://gist.github.com/4410665](https://gist.github.com/4410665)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:04:29.023

解决方案是采取：

```
//Schedule alarm for data upload
class RepeatingAlarm extends BroadcastReceiver {
      @Override
      public void onReceive(Context context, Intent intent) {
            Toast.makeText(
                    context,
                    "ALARMED!", Toast.LENGTH_LONG)
                    .show();
      }
} 
```

并将其保存为 RepeatingAlarm.java 基本上它是自己的类。然后进入mainfest文件，添加一些这个效果

```
<receiver android:name="RepeatingAlarm"></receiver> 
```

# c# - 如何使用 mongoDB 执行“全有或全无”操作？

> ID：14087869
> 
> 赞同：2
> 
> 时间：2012-12-30T02:44:40.140
> 
> 标签：c#, mongodb, transactions, push, insertion

我需要在文档的字段数组中插入一些元素。嗯……我知道 Mongo 有原子 Update.Push……事实上，我需要在许多文档中进行这种插入。情况如下（我需要为每个用户名插入一个角色数组）：

```
 public override void AddUsersToRoles(string[] usernames, string[] roleNames)
        {
            foreach (string role in roleNames)
            {
                if (!this.RoleExists(role))
                {
                    throw new ProviderException(String.Format("The role '{0}' was not found.", role));
                }
            }

            //How to guarantee that all users will be updated with roles?
            foreach (string user in usernames)
            {
                var docs = this.users.Update(Query.And(Query.EQ("Username", user),
                    Query.EQ("Applications.Name", this.ApplicationName)), Update.AddToSetEach("Applications.$.Roles", 
                   new BsonArray(roleNames)));
            }
        } 
```

假设在将角色“推送”到第三个用户名时连接断开。我需要回滚以前的操作。任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T03:29:35.283

根据我对 MongoDB 的了解，它在多个集合方面不符合 ACID。现在，如果你一次更新一个集合，你应该很好。否则，如果您愿意，非 ACID 合规性是包装盒上警告标签的一部分。

*   [隔离操作序列](http://docs.mongodb.org/manual/tutorial/isolate-sequence-of-operations/)
*   [回答“MongoDB 不符合 ACID 的真正含义是什么？”](https://stackoverflow.com/a/7150406/275679)

# android - EditText android：提示不会消失 onFocus

> ID：14087870
> 
> 赞同：9
> 
> 时间：2012-12-30T02:44:46.207
> 
> 标签：android, android-edittext, hint

我在 Android 4+ 上，我正在尝试向我的编辑文本小部件添加提示。我尝试将提示添加到布局中，如下所示...

```
 <EditText
        android:id="@+id/bar_name"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:inputType="text"
        android:hint="@string/bar_name_hint"
        /> 
```

但是当我专注于文本框时，它会覆盖提示而不是提示消失。

![在此处输入图像描述](../Images/a81e4cf7751e28404c1454c7fb074c47.png)

我找到了有关向 EditText 添加 onFocus 侦听器的文档，但我想避免以编程方式执行此操作。下面的帖子也提到了使用选择器，但我找不到有关如何执行此操作的文档。

[Android EditText 提示](https://stackoverflow.com/questions/4373888/android-edittext-hint)

那么处理这个问题的最佳方法是什么？

我在@A--C 和@Flexo 的推荐下写了这篇[文章](https://stackoverflow.com/questions/9656492/androidhint-not-disappearing-onfocus-using-edittext/14078629#14078629)，因为他们说“除了“我也是”之外什么都不说的评论只是噪音。最好再问同样的问题。

像这样的评论作为联系第一个遇到问题的人的方式非常有用......也许他已经修复了它并且可以发布一个对每个人都有用的答案但尚未发布，因为他认为没有人会关心。

我不会仅仅为了获得分数而发布问题的答案，以便我可以发表评论......我还有更多事情要做......无论如何它应该可供所有人使用。

如果我没有尝试一切来解决我的问题，我就不会发布这个。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-31T19:37:01.990

出于某种原因，我将活动和片段布局设置了两次。在活动上创建：

```
 protected void onCreate(Bundle savedInstanceState) {
    setContentView(R.layout.edit_consumption); 
```

在片段 onCreateView 上：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    View view = inflater.inflate(R.layout.edit_consumption, null); 
```

所以我有2层布局。我只需要从 Activity onCreate 中删除该布局即可解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-05T09:24:50.890

在 oncreate() 中使用以下代码

```
myEditText.setOnFocusListener(new OnFocusListener(){
  public void onFocus(){
    myEditText.setHint("");
  }
}); 
```

# winforms - 如何允许用户在 Winforms DataGrid 单元格中插入换行符？

> ID：14087871
> 
> 赞同：0
> 
> 时间：2012-12-30T02:44:59.017
> 
> 标签：winforms, datagridview

在我的 Winforms 应用程序中，我有一个标准的数据网格视图。但是，在我的应用程序中，我收到允许用户在单元格中插入换行符的请求。在 excel 中，用户可以使用 alt+enter （或 shift+enter，忘记哪个）来执行此操作。但是，我不确定如何在 Winforms 数据网格中执行此操作。

问题是，默认情况下，如果您正在编辑数据网格中的单元格，则按 Enter 将提交编辑。我尝试在我的 Datagrid 的 KeyDown 事件中为 Alt+Enter 添加一个检查，并让它添加一个换行符，但这不起作用。这也不允许用户在文本中间添加换行符（因为我看不到在编辑单元格时如何获取光标的位置）。

有谁知道我怎么能做到这一点？

# c# - 如何挂钩全局 WM_APPCOMMAND 消息？

> ID：14087873
> 
> 赞同：3
> 
> 时间：2012-12-30T02:45:53.210
> 
> 标签：c#, hook, message, global

我正在写一个简单的音乐播放器。我希望它挂钩全局`WM_APPCOMMAND`消息（`APPCOMMAND_MEDIA_PLAY`, `APPCOMMAND_MEDIA_PAUSE`, `APPCOMMAND_MEDIA_NEXTTRACK`,...）。
你能帮我怎么做吗？非常感谢你！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T09:59:39.543

这需要一个 WH_SHELL 挂钩，由 SetWindowsHookEx() 设置。挂钩回调将获得[HSHELL_APPCOMMAND 通知](http://msdn.microsoft.com/en-us/library/ms644991%28VS.85%29.aspx)。

这个钩子需要一个可以注入到所有正在运行的进程中的 DLL。您不能用 C# 之类的托管语言编写这样的 DLL，您尝试注入的进程不会加载 CLR。需要非托管代码，C 是典型的选择。 [这个项目](http://www.codeproject.com/Articles/18638/Using-Window-Messages-to-Implement-Global-System-H)应该有助于让这样的 DLL 运行。请注意 64 位操作系统上相当复杂的问题，您需要两个帮助程序，以便您可以同时注入 32 位和 64 位进程。

# imap - 同步 IMAP 服务器和消息的本地副本

> ID：14087875
> 
> 赞同：1
> 
> 时间：2012-12-30T02:46:19.497
> 
> 标签：imap, sync, local, directory

从程序员的角度来看，我是使用 IMAP 的新手，但正在尝试编写一个简单的 IMAP 电子邮件客户端。

我有一个第 3 方控件，它完成了将 7 talkking 连接到服务器的大部分繁重工作。我需要的是有关如何创建和同步“离线版本”（本地副本）的更多信息。

我可能还想在本地完成所有消息、文件夹等的组织工作，并最终与服务器“同步”。在 IMAP 中必须有一个标准的方法来处理这个问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-19T11:56:04.257

不要重新发明轮子，最好的解决方案是使用系统管理员方式。检查**[offlineimap](http://www.offlineimap.org/)**这是一个带有小[配置文件](http://www.offlineimap.org/doc/conf_examples.html)的脚本，它可以将您的imap 邮件服务器与ssl 支持同步。本地到远程或远程到本地。

```
$dnf install offlineimap
$vi ~/.offlineimaprc
$offlineimap 
```

# haskell - Functor 类中 (<$) 的目的是什么？

> ID：14087881
> 
> 赞同：15
> 
> 时间：2012-12-30T02:47:20.017
> 
> 标签：haskell, functor

该类`Functor`包含一个隐藏的第二个成员：

```
class Functor f where
  fmap :: (a -> b) -> f a -> f b
  (GHC.Base.<$) :: a -> f b -> f a 
```

文档：

> 用相同的值替换输入中的所有位置。默认定义是`fmap . const`，但这可能会被更高效的版本覆盖。

我想知道更多。为什么这个`fmap . const`成语是一个单独的成员？替代实现如何更有效？这个组合器有什么应用？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-30T03:29:31.553

它作为一个成员包含在允许用户自定义它的速度，我猜是因为它使它与`>>`.

我认为在 reader monad 的情况下它可能会更快`((->) r)`。

```
x <$ _ = const x 
```

对比

```
x <$ fa = fmap (const x) fa = (const x) . fa 
```

虽然，这确实是编译器优化的问题。而且，它似乎没有为 base 中的 reader monad 定义。

它还可能导致严格集合的性能提升。即

```
data Strict a = Strict !a

instance Functor Strict where
   fmap f (Strict a) = Strict (f a)
   x <$ _ = Strict x 
```

这不符合函子定律，但尽管如此，您可能希望在某些情况下这样做。

第三个例子来自无限集合。考虑无限列表

```
data Long a = Cons a (Long a)

instance Functor Long where
  fmap f (Cons x xs) = Cons (f x) (fmap f xs) 
```

效果很好，但想想

```
countUpFrom x = Cons x (countUpFrom (x+1))
ones = 1 <$ (countUpFrom 0) 
```

现在，我们的定义将扩展到

```
ones = 1 <$ (countUpFrom 0)
   = fmap (const 1) (countUpFrom 0) 
   = Cons (const 1 0) (fmap (const 1) (countUpFrom 1)
   = Cons (const 1 0) (Cons (const 1 1) (fmap (const 1) (countUpFrom 2)) 
```

`Cons`也就是说，当您遍历此列表时，它将分配一大堆单元格。而另一方面，如果你定义

```
x <$ _ = let xs = Cons x xs in xs 
```

比

```
ones = 1 <$ countUpFrom 0
 = let xs = Cons 1 xs in xs 
```

这已经打结了。一个更极端的例子是无限树

```
data ITree a = ITree a (ITree a) (ITree a) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-30T11:20:51.947

另一个`<$`使用示例：

假设您有一个解析器仿函数`P`，并且`parser :: P A`.

`f <$> parser`意味着您需要解析某些内容然后应用于`f`结果。

`a <$ parser`意味着你不需要解析任何东西（你对结果不感兴趣）——你只需要*识别*，这可以更快。

参见例如[regex-applicative](https://github.com/feuerbach/regex-applicative/blob/master/Text/Regex/Applicative/Interface.hs)库（注意`Void`构造函数的使用）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-30T02:58:39.243

这是我目前正在编写的一些代码片段，它们可能会让您了解使用此组合器的目的：

```
pPrimType = choice
    [ WIPrimIntType <$> flag "unsigned" <*> pIntTypeSize
    , WIPrimFloatType <$> flag "unrestricted" <*> pFloatTypeSize
    , WIPrimBoolType <$ "boolean"
    , WIPrimByteType <$ "byte"
    , WIPrimOctetType <$ "octet"
    ]

pConst = WIConst 
     <$  "const"
     <*> pConstType
     <*> pIdent
     <*  "="
     <*> pConstValue
     <*  semicolon 
```

如果字符串文字看起来很奇怪，那是因为我已`OverloadedStrings`启用并且正在将它们转换为与字符串匹配的解析器，同时执行其他一些操作（吃空格、检查标记边界等）

这看起来很微不足道，但老实说，当您使用不产生您关心的值的解析器（例如必需的关键字等）时，它使`Applicative`-y 解析器定义*更具可读性。*否则你必须引入一堆额外`pure`的 s 或奇怪的括号或其他分散注意力的噪音。

至于为什么它是类型类的一部分，向类型类添加其他多余函数的通常原因是期望某些实例能够优化它，例如`(>>)`. 由于效率差异取决于实例（这就是重点！）那里没有单一的答案。不过，我无法立即想到任何明显的例子，它会产生重大影响。

# azure - 将 Windows Azure 云服务部署到多个数据中心？

> ID：14087884
> 
> 赞同：4
> 
> 时间：2012-12-30T02:47:59.800
> 
> 标签：azure, cloud

将单个 Windows Azure 云服务应用程序部署到多个数据中心的推荐方法是什么？

我是否应该在所有数据中心暂停现有应用程序，然后在部署完成后重新启用它们？或者有更好的方法来做到这一点？

理想情况下，我希望能够在 Windows Azure 云项目的配置文件中设置数据中心列表，以便在单个发布操作期间，应用程序将同时上传到多个数据中心（例如美国中北部、西欧和东亚数据中心）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T04:11:56.843

您所描述的将需要一些自定义部署逻辑。我建议您熟悉 PowerShell 和[Windows Azure 管理 Cmdlet](http://msdn.microsoft.com/en-us/library/windowsazure/jj152841)。[Github](https://github.com/search?q=azure%20cmdlets&ref=commandbar)上提供了一堆关于如何使用 PowerShell 打包部署的示例。

我会使用相同的 PowerShell 脚本将您的 Azure 包和服务配置文件上传到您在每个数据中心（即您的多个数据中心）中拥有的每个主机服务的暂存槽，每个托管服务具有不同的参数。您需要有一些自定义等待逻辑来轮询暂存槽部署的状态并等待 READY 状态。一旦完成，您就知道您的 VM 已准备就绪，如果您的应用程序加载速度很快，您也可以使用 PowerShell 执行 VIP 交换。

完成此操作所需的 PowerShell 命令如下：

*   **新部署**（使用它部署到每个数据中心的托管服务）
*   **Get-HostedService**（使用它来获取新部署的托管服务的状态）
*   **移动部署**（一旦您的所有暂存槽部署准备就绪，使用它执行 VIP 交换）

请注意，即使您构建了它，也有可能事情最多会不同步几秒钟，最坏的情况是几分钟，因此您的新部署将始终需要与您的底层数据存储系统/架构倒退。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T05:17:29.343

我建议为此使用[Windows Azure 服务管理 REST API](http://msdn.microsoft.com/en-us/library/windowsazure/ee460799)。对于多个部署，PowerShell 往往是重复且缓慢的（即，每个部署都将包上传到存储，即使它是同一个包）。[在Windows Azure ServiceManagement Sample](http://code.msdn.microsoft.com/windowsazure/Windows-Azure-CSManage-e3f1882c)中有一个关于使用 REST API 的出色且完整的示例。我们针对类似情况扩展了此示例：我们有 45 多个微型站点使用相同的代码库，并使用 REST API 异步部署到每个服务实例。我们将包上传到 Azure Blob，然后使用 Blob URL 触发每个服务的异步更新。使用 REST API，您可以从生成服务器或 Azure 辅助角色运行更新。

# bash - 捕获用户输入 bash if/then/elif

> ID：14087893
> 
> 赞同：0
> 
> 时间：2012-12-30T02:49:42.467
> 
> 标签：bash, if-statement, ssh

我正在尝试创建一个简单的脚本，用于通过 ssh 登录到各种服务器，所有密钥都已安装并且正在工作，但我根本无法让这个脚本为我工作。基本上有一个关于用户希望登录到哪个服务器的选项，但它不断抛出以下错误：

```
': not a valid identifier `INPUT
login.sh: line 24: syntax error near unexpected token `elif'
'ogin.sh: line 24: `elif [ $INPUT -eq 2 ] ; then 
```

脚本布局可以在下面找到虚拟信息：

```
#!/bin/bash
echo "What Server would you like to login to?"
echo ""
echo ""
echo "1\. Server 1"
echo "2\. Server 2"
echo "3\. Server 3"
echo "4\. Server 4"
echo "5\. Exit"
read INPUT
if [ $INPUT -eq 1 ] ; then
echo"Logging in"
echo"..."
ssh root@1.2.3.4 -p 5678

elif [ $INPUT -eq 2 ] ; then
echo"Logging in"
echo"..."
ssh root@1.2.3.4 -p 5678

elif [ $INPUT -eq 3 ] ; then
echo"Logging in"
echo"..."
ssh root@1.2.3.4 -p 5678

elif [ $INPUT -eq 4 ] ; then
echo"Logging in"
echo"..."
ssh root@1.2.3.4 -p 5678

elif [ $INPUT -eq 5 ] ; then
exit 0
else
echo "invalid choice"
return
fi 
```

任何帮助将不胜感激，使用 bash 相对较新，现在这让我很烦！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T02:59:53.470

看起来你在 Windows 上创建了这个文件。尝试，使用 dos2unix 像：

```
dos2unix <your_script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T09:39:07.943

这个答案真的只是一个评论，但评论不适合代码。你的脚本可以大大简化。考虑类似的事情：

```
#!/bin/bash

servers=( host1 host2 host3 )
ips=( 192.168.1.1 192.168.1.2 192.168.1.3 )
ports=( 123 22 33 )
select server in ${servers[@]}; do
    echo "Logging into $server..."
    ssh root@${ips[$REPLY]} -p ${ports[$REPLY]}
break
done 
```

（虽然完全不清楚为什么要指定 IP 地址而不是使用主机名！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T03:04:15.497

通过复制粘贴尝试了您的脚本，它起作用了。我对其进行了更多修改，以使无效的选择选项起作用。

呃……对不起，但它对我有用吗？

```
#!/bin/bash
while true ; do
    echo "What Server would you like to login to?"
    echo ""
    echo ""
    echo "1\. Server 1"
    echo "2\. Server 2"
    echo "3\. Server 3"
    echo "4\. Server 4"
    echo "5\. Exit"

    read INPUT
    if [ $INPUT -eq 1 ] ; then
        echo "Logging in 1"
        echo "..."
        ssh root@1.2.3.4 -p 5678

    elif [ $INPUT -eq 2 ] ; then
        echo "Logging in 2"
        echo "..."
        ssh root@1.2.3.4 -p 5678

    elif [ $INPUT -eq 3 ] ; then
        echo "Logging in 3"
        echo "..."
        ssh root@1.2.3.4 -p 5678

    elif [ $INPUT -eq 4 ] ; then
        echo "Logging in 4"
        echo "..."
        ssh root@1.2.3.4 -p 5678

    elif [ $INPUT -eq 5 ] ; then
        exit 0
    else
        echo "invalid choice"
    fi
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-30T03:14:01.037

我会回答你在这个问题上没有问的问题，把自己扔到 SO 巴士前。为什么不使用`select`？

```
echo 'Which server would you like to log into?'
select server in 192.168.0.1 192.168.0.2 192.168.0.3 192.168.0.4; do
    printf 'Logging in to server %s...\n' "$server"
    ssh "$server" -p "$port"
done 
```

如果你不喜欢`select`，那为什么不至少使用`case`呢？

```
read -p 'Which server do you want? ' input
case "$input" in
    whatever)
        printf 'Logging in to server %s...\n' "$server"
        ssh "$server" -p "$port"
        ;;
    *)
        echo 'Invalid option'
        ;;
esac 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-30T03:16:44.237

我意识到这并不能回答你的问题，但你说你是 bash 的新手。我建议使用 case 语句而不是一堆 if 语句，并且我还在你的 read 语句中添加了一个提示（使用 -p 选项）。您也可以查看 select 语句而不是 case。

```
#!/bin/bash
echo "What Server would you like to login to?"
echo ""
echo ""
echo "1\. Server 1"
echo "2\. Server 2"
echo "3\. Server 3"
echo "4\. Server 4"
echo "5\. Exit"
read -p "cmd> " INPUT

case $INPUT in

1)
    echo "Logging in"
    echo "..."
    echo ssh root@1.2.3.4 -p 5678
    ;;

2)
    echo "Logging in"
    echo "..."
    echo ssh root@1.2.3.4 -p 5678
    ;;

3)
    echo "Logging in"
    echo "..."
    echo ssh root@1.2.3.4 -p 5678
    ;;

4)
    echo "Logging in"
    echo "..."
    echo ssh root@1.2.3.4 -p 5678
    ;;

5)
    echo "exiting"
    exit 0
    ;;

*)
    echo "invalid choice"
    return
    ;;
esac 
```

# ruby-on-rails - 验证唯一字段时避免重复的优雅解决方案？

> ID：14087896
> 
> 赞同：1
> 
> 时间：2012-12-30T02:50:06.160
> 
> 标签：ruby-on-rails, validation, unique

我确实成功地直接在模型中验证了重复的 url。下面的代码显示，当用户创建新书签时，验证效果很好。

```
validate :url_cannot_be_duplicated_per_user

def url_cannot_be_duplicated_per_user
  current_user = User.find(self.user_id)
  if current_user.bookmarks.any?{|b| b.url.eql? self.url }
    errors.add(:url, "already added")
  end
end 
```

但问题是验证阻止编辑书签，因为在编辑它时基本相同的书签，它将再次通过模型并捕获重复。因此，使用该代码，更新操作永远不会发生。

知道如何解决吗？

PS：我确实在控制器中放置了一个块 if else 在提交给模型之前先检查 url。尽管验证工作非常正确，但代码变得混乱。

我的控制器

```
if duplicated? params[:bookmark][:url]
  flash[:error] = 'This bookmark already added'
  @bookmark = current_user.bookmarks.build(params[:bookmark])
  render 'new'
else 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:52:04.583

您可以`uniqueness`使用以下方式进行验证`scope`：

```
class Bookmark < ActiveRecord::Base
  validates :url, :uniqueness => {:scope => :user_id}
end 
```

# java - 这个编程语句叫什么？

> ID：14087897
> 
> 赞同：1
> 
> 时间：2012-12-30T02:50:07.090
> 
> 标签：java, boolean

> **可能重复：**
> [什么是 Java ?: 运算符，它有什么作用？](https://stackoverflow.com/questions/798545/what-is-the-java-operator-called-and-what-does-it-do)

这种类型的代码语句叫什么？我以前在 Java 和 C++ 中见过它，但我不记得它叫什么了。int someVariable = (true) ? 1：0；

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T02:51:12.547

它被称为[三元运算符](http://en.wikipedia.org/wiki/Ternary_operator)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T02:55:27.467

它的三元运算符避免了简单条件检查的代码行

`int biggerNumber = a > b ? a : b;`

更

`int bigNumber = a > b ? (a > c ? a : c) : b > c ? b : c ;`

# c++ - 通过宏检查错误

> ID：14087905
> 
> 赞同：5
> 
> 时间：2012-12-30T02:52:18.620
> 
> 标签：c++, c, macros, compiler-errors

我想编译如下所述的时间错误检查。但我不知道如何在里面使用它`main()`？

```
#define BUILD_BUG_ON_ZERO(e) (sizeof(struct { int:-!!(e); }))
#define BUILD_BUG_ON_NULL(e) ((void *)sizeof(struct { int:-!!(e); }))
int main(){
BUILD_BUG_ON_NULL(12);
} 
```

下面是提到的错误

```
1--error C2332: 'struct' : missing tag name
2--error C2143: syntax error : missing ')' before '{'
3--error C2027: use of undefined type 'main::<unnamed-tag>'
4--error C2143: syntax error : missing ';' before '{'
5--error C2059: syntax error : ')' 
```

谁能让我知道我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T03:11:48.710

**编辑**：这个问题最初被标记为 C++，但现在只是 C。

我不打算追究这个问题的进一步根本变化。

C++ 标记问题的原始答案：

* * *

这个源代码：

```
#define BUILD_BUG_ON_ZERO(e) (sizeof(struct { int:-!!(e); }))
#define BUILD_BUG_ON_NULL(e) ((void *)sizeof(struct { int:-!!(e); }))
int main(){
BUILD_BUG_ON_NULL(0);
} 
```

用g++ 4.7.1编译，产生

```
foo.cpp：在函数'int main()'中：
foo.cpp:4:1：错误：类型可能未在“sizeof”表达式中定义
foo.cpp:4:21：警告：语句无效 [-Wunused-value]

```

这直接说明出了什么问题。

所以用不同的编译器编译是个好主意。

* * *

可能您正在寻找**编译时断言**。

使用 C++11，您可以使用`static_assert`，例如通过宏，例如

```
#define STATIC_ASSERT( e ) static_assert( e, #e ) 
```

在 C++03 中，您可以将其实现为 valid/invalid `typedef`，因为 a`typedef`可以在同一个翻译单元中重复，并且可以在类定义中使用：

```
#define STATIC_ASSERT( e ) typedef char staticAssert_shouldBeTrue[e? 1 : -1] 
```

一个问题是 g++ 有/有一个编译器错误，其中重复`typedef`并不总是被接受，因此需要为每个生成一个本地唯一的名称，例如通过使用`__LINE__`.

但是你总是可以只使用 Boost 库中的定义，因为 Boost 支持大多数现存的编译器，每个编译器都根据需要进行特殊处理。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T03:39:59.017

首先是宏`BUILD_BUG_ON_ZERO`，`BUILD_BUG_ON_NULL`如果它们的参数*不同于* `0`.

如果宏参数是`0`，它们不会触发任何编译错误，但会产生一个`0`for`BUILD_BUG_ON_ZERO`和一个`(void *) 0`for`BUILD_BUG_ON_NULL`

这些宏来自用 C 语言编写的 Linux 内核，它们仅适用于 C 程序。

在 C++ 中，这些宏*不起作用*。原因是在 C++ 中，您不能在`sizeof`表达式中声明结构。

如果您是用 C 或 C++ 编译程序，您没有在问题中提及，但我强烈怀疑您是用 C++ 编译它。所以不要在 C++ 中使用这些宏。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-30T03:15:19.563

编译`gcc -std=c99 -pedantic-errors`，我得到

```
screwed.c: In function ‘main’:
screwed.c:5:1: error: negative width in bit-field ‘&lt;anonymous>’
screwed.c:5:1: error: struct has no named members [-pedantic] 
```

这些是当代码编译为 C 时编译应该给出的错误。位域的宽度必须是非负数（如果它有名称，则为正数），并且 a`struct`必须至少有一个命名成员（两个，如果最后一个是灵活的数组成员）。`struct`允许不带标签的 s。

您要么将代码编译为 C，要么编译器不符合标准。

编译为 C++ 时，附加错误

```
error: types may not be defined in ‘sizeof’ expressions 
```

生成（但关于`struct`没有命名成员的那个消失了）。

在 C++ 中，您可能不会在`sizeof`表达式中定义类型，并且您的编译器选择了一种不太清楚的方式来告诉您。

# php - 有没有办法在每个 DOM 标签旁边添加行号？

> ID：14087910
> 
> 赞同：2
> 
> 时间：2012-12-30T02:53:27.370
> 
> 标签：php, dom

我的代码是这样的，它将访问所有 DOM 元素。现在我想在它们旁边添加行号。谁能帮忙。谢谢。

```
<?php   
$dom = new domDocument;
// load the html into the object
$dom->loadHTMLFile('$url');
// keep white space
$dom->preserveWhiteSpace = true;
// nicely format output
$dom->formatOutput   = true;
//get element by tag name
$htmlRootElement = $dom->getElementsByTagName('html');
$new = htmlspecialchars($dom->saveHTML(), ENT_QUOTES);
echo '<pre>' .$new. '</pre>';
?> 
```

上面的代码不会给出任何行号。我想做这样的事情。

```
<!DOCTYPE html>
1.<html>
2.<head>
3\.    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
4\.   <title></title>
5.</head>
6.<body>
7.</html> 
```

请有任何建议。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:54:51.357

```
$lines = explode(PHP_EOL, $html); 
```

这是我的提示，我相信你可以弄清楚其余的。顺便说一句，已经有 PHP 库，比如[GeSHi](http://qbnz.com/highlighter/)

哦，你的代码有一个小错误。在您加载 HTML 的地方，您会这样做`'$url'`，这字面意思是`$url`，而不是您的变量。使用双引号或根本不使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T02:58:25.740

只需用新行拆分字符串，然后打印出行号，然后是行：

```
$lines = preg_split( '/\r\n|\r|\n/', $new );//split the string on new lines
echo "<pre>";
foreach($lines as $lineNumber=>$line){
  echo "\r\n" . $lineNumber . ". " . $line; 
}
echo "</pre>"; 
```

# iphone - iPhone开发者初学者：关于[操作sendMessage：参数]

> ID：14087913
> 
> 赞同：-4
> 
> 时间：2012-12-30T02:54:08.697
> 
> 标签：iphone, objective-c, ios

我是 iPhone 应用程序的初学者。

有一个关于 Objective-C 中 sendMessage 语法的讲座提到：

```
[operation sendMessage:argument] 
```

有人能告诉我这个语法的文档在哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T02:59:07.173

您所说的称为[Message Passing](http://en.wikipedia.org/wiki/Message_passing)。

这些可能有助于解释：

*   [http://sldn.softlayer.com/blog/sthompson/understanding-objective-c-messaging](http://sldn.softlayer.com/blog/sthompson/understanding-objective-c-messaging)
*   [http://en.wikipedia.org/wiki/Objective-C#Messages](http://en.wikipedia.org/wiki/Objective-C#Messages)
*   [Apples Programming with Objective-C 指南](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/WorkingwithObjects/WorkingwithObjects.html#//apple_ref/doc/uid/TP40011210-CH4-SW2)

# javascript - 递归创建 JSON 树，仅在最深层次添加

> ID：14087914
> 
> 赞同：3
> 
> 时间：2012-12-30T02:54:24.767
> 
> 标签：javascript, recursion

我想创建一个未知对象的JSON层次结构，所以必须递归处理。

这是我的函数，其中`angular.element.isEmptyObject()`继承自 jQuery，`angular.copy()`是一个创建对象深层副本的函数（我使用的是[AngularJS](http://angularjs.org)）。

```
function recurseTree(tree, newKey, newId) {
    if(angular.element.isEmptyObject(tree)) {
        tree[newKey] = {_id: newId};
    } else {
        for(var key in tree) {
            if(typeof tree[key] == 'object') recurseTree(tree[key], newKey, newId);
            else tree[newKey] = {_id: newId};
        }
    }
    return angular.copy(tree);
} 
```

现在运行这个：

```
var testT = {};
console.log(recurseTree(testT, 'a', '1'));
console.log(recurseTree(testT, 'b', '2'));
console.log(recurseTree(testT, 'c', '3'));
console.log(recurseTree(testT, 'd', '4'));
console.log(recurseTree(testT, 'e', '5')); 
```

您会注意到第一个和第二个按预期返回：

```
{ 
    a: { 
        _id: '1',
        b: {
            _id: '2'
        }
    }
} 
```

但第三个是我遇到麻烦的地方。

```
{ 
    a: { 
        _id: '1',
        b: {
            _id: '2',
            c: {
                _id: '3'
            }
        },
        c: {
            _id: '3'
        }
    }
} 
```

我需要解决什么问题才能将`c`对象附加**为**的子级`b`，而不是 的子级`a`？我难住了。

这是它的 JSFiddle，请检查您的控制台以获取结果。 [http://jsfiddle.net/winduptoy/Mjq5D/2/](http://jsfiddle.net/winduptoy/Mjq5D/2/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T04:13:49.833

尝试这个：

```
function recurseTree(tree, newKey, newId) {
    if(angular.element.isEmptyObject(tree)) {
        tree[newKey] = {_id: newId};
        return;
    } 

    var child = null; // find current tree's child
    for(var key in tree) {
        if (key != '_id') {
            child = tree[key]; // found a child
            break;
        }
    }
    if (child) { // recursively process on child
        recurseTree(child, newKey, newId);
    } else { // no child, so just fill the tree
        tree[newKey] = {_id: newId};
    }
} 
```

测试：

```
var testT = {};
recurseTree(testT, 'a', '1');
console.log(testT);  
recurseTree(testT, 'b', '1');
console.log(testT); 
recurseTree(testT, 'c', '1');
console.log(testT); 
recurseTree(testT, 'd', '1');
console.log(testT); 
recurseTree(testT, 'e', '1');
console.log(testT); 
```

请注意，我没有使用`angular.copy(tree)`性能的缘故。如果您不想更改树，请在将其传递给函数之前将其复制`recurseTree`。请在[jsFiddle](http://jsfiddle.net/hzheng/tsV2X/ "jsFiddle")上尝试一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T03:12:06.377

试试？有必要使用`for loop`吗？

```
for(var key in tree) {
   if(typeof tree[key] == 'object'){ 
       recurseTree(tree[key], newKey, newId);
       break;
   }
   else {
       tree[newKey] = {_id: newId};
       break;
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-27T06:09:20.950

我的解决方案：

```
vm.getChilds = function (data, parent_id) {
        return _.filter(data, function (item) {
            return item.parent_id == parent_id;
        });
    };
    vm.getIds = function (arr) {
        var ids = [];
        arr.forEach(function (item) {
            ids.push(item.id);
        });
        return ids;
    };
    vm.updateList = function (data, arr) {
        var ids = vm.getIds(arr);
        var result = [];
        data.forEach(function (item) {
            if (ids.indexOf(item.id) == -1) {
                result.push(item);
            }
        });
        return result;
    };
    vm.getThree = function (data, parent_id) {
        var items = vm.getChilds(data, parent_id);
        if (items.length == 0) return null;
        var tree = [];
        var newData = vm.updateList(data, items);
        items.forEach(function (item) {
            item.sub_departments = vm.getThree(newData, item.id);
            tree.push(item);
        });
        return tree;
    }; 
```

# c# - 在 ASP.NET WebForm 应用程序中创建更友好的 URL

> ID：14087917
> 
> 赞同：0
> 
> 时间：2012-12-30T02:55:02.150
> 
> 标签：c#, asp.net, url-rewriting, webforms

我有一个 ASP.NET WebForms 应用程序。我想做的是使用`RewritePath`. 我想要做的是获取进入的 URL 的子域，检查我的数据库中调用的表`Domains`，然后根据子域，重写 url 添加查询字符串`?id=1`或任何`id`内容。

另外，我想确定要加载的页面的路径。例如：

```
http://www.mysite.com should go to                --> http://www.mysite.com/Default.aspx
http://dog.mysite.com should go to                --> http://www.mysite.com/MainPage.aspx?id=1
http://cat.mysite.com should go to                --> http://www.mysite.com/MainPage.aspx?id=2
http://cat.mysite.com?p=15 should go to           --> http://www.mysite.com/MainPage.aspx?id=2&p=15
http://cat.mysite.com/OtherPage should go to      --> http://www.mysite.com/OtherPage.aspx?id=2
http://cat.mysite.com/OtherPage?p=15 should go to --> http://www.mysite.com/OtherPage.aspx?id=2&p=15 
```

希望这些例子能给你我正在寻找的想法。我更希望能够从 global.asax 文件中执行此操作，因为我无法访问 IIS Web 服务器机器来安装一些用于 URL 重写的服务器端模块。

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:30:29.790

阅读[ScuttGu 的这篇博客，](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)它详细讨论了 url 重命名。

# objective-c - 建议：将 sqllite ios 同步到网络的最佳方式

> ID：14087920
> 
> 赞同：2
> 
> 时间：2012-12-30T02:55:30.667
> 
> 标签：objective-c, ios, sqlite, core-data, synchronization

如果可以的话，请在这里提供一些建议和建议。

我正在创建一个 iPad 应用程序（IOS6），它将数据写入设备上的本地数据库，然后立即或稍后将该记录复制到 Web 服务（基本上是云服务）。

你认为最好的解决方法是什么？

我想在本地数据库中有一个名为“同步”的列，并在创建记录时立即将标志设置为“0”，然后立即或定期同步记录为“0”。然后在复制每条记录时显然将标志设置为“1”。

我希望应用程序离线工作，然后在设备与我的网络服务有可用连接时同步。

理想情况下，每条记录都应该立即或几秒钟后复制，但在没有网络连接的情况下，我希望能够将复制排队进行。

那么你认为最好的方法或实现这一目标是什么？提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T03:02:14.687

解决方案将在很大程度上取决于您的整体解决方案的复杂程度。

例如，如果记录只是在本地设备上创建然后上传，而不进行修改，那么您的解决方案将绰绰有余。

但是，如果您允许更新本地设备上的记录，或者记录一旦进入您的 Web 服务就可以更新，那么您需要开始管理冲突解决。我们解决这种情况的方法是在“主”数据库（由 Web 服务更新的数据库）中记录时间戳，并在记录作为新记录或更新上传时同步该时间戳。当用户更新记录时，我们发送时间戳，如果数据库中的值与发送的数据库不同，则更新请求被拒绝。当然，解决冲突有不同的方法，这只是一种适用于我们的应用程序和用户的方法。

# node.js - 调用退出后无法排队握手

> ID：14087924
> 
> 赞同：92
> 
> 时间：2012-12-30T02:57:29.777
> 
> 标签：node.js, express

我已经实现了以下代码：

```
module.exports = {
    getDataFromUserGps: function(callback)
    {
        connection.connect();
        connection.query("SELECT * FROM usergps", 
            function(err, results, fields) {
                if (err) return callback(err, null);
                return callback(null, results);
            }
        ); 
        connection.end();
    },
    loginUser: function(login, pass, callback)
    {
        connection.connect();
        connection.query(
            "SELECT id FROM users WHERE login = ? AND pass = ?",
            [login, pass],
            function(err, results, fields) 
            {
                if (err) return callback(err, null);
                return callback(null, results);
            }
        ); 
        connection.end();
    },
    getUserDetails: function(userid, callback)
    {
        connection.connect();
        connection.query(
            "SELECT * FROM userProfilDetails LEFT JOIN tags ON userProfilDetails.userId = tags.userId WHERE userProfilDetails.userid = ?",
            [userid],
            function(err, results, fields)
            {
                if (err) return callback(err, null);
                return callback(null, results);
            }
        );
        connection.end();
    },
    addTags: function(userId, tags)
    {
        connection.connect();
        connection.query(
            "INSERT INTO tag (userId, tag) VALUES (?, ?)",
            [userId, tags],
            function(err, results, fields)
            {
                if (err) throw err;
            }
        )
        connection.end();
    }
} 
```

一切都只在第一次工作得很好。如果我想第二次“使用”查询，我会收到以下错误：

```
Cannot enqueue Handshake after invoking quit 
```

我试过不`.end()`连接，但没有帮助。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：261
> 
> 时间：2013-01-09T21:47:40.750

如果您使用 node-mysql 模块，只需删除 .connect 和 .end。刚刚自己解决了这个问题。显然，他们在最后一次迭代中加入了不必要的代码，这也是错误的。如果您已经运行了 createConnection 调用，则不需要连接

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2013-05-03T18:58:58.447

根据：

*   修复节点 Mysql“错误：调用退出后无法排队握手。”：

    [http://codetheory.in/fixing-node-mysql-error-cannot-enqueue-handshake-after-invoking-quit/](http://codetheory.in/fixing-node-mysql-error-cannot-enqueue-handshake-after-invoking-quit/)

> **TL;DR**`createConnection`您需要在每次断开连接后调用该方法来建立新连接。

和

> **注意：**如果您正在处理 Web 请求，那么您不应该在每个请求上都结束连接。只需在服务器启动时创建一个连接，并始终使用连接/客户端对象进行查询。您可以侦听错误事件以处理服务器断开连接和重新连接。完整代码 [在这里](https://github.com/felixge/node-mysql#server-disconnects)。

* * *

从：

*   Readme.md - 服务器断开连接：

    [https://github.com/felixge/node-mysql#server-disconnects](https://github.com/felixge/node-mysql#server-disconnects)

它说：

> ## 服务器断开连接
> 
> 由于网络问题、服务器超时或服务器崩溃，您可能会失去与 MySQL 服务器的连接。所有这些事件都被认为是致命错误，并且将具有`err.code = 'PROTOCOL_CONNECTION_LOST'`. 有关详细信息，请参阅错误处理部分。
> 
> 处理此类意外断开连接的最佳方法如下所示：
> 
> ```
> function handleDisconnect(connection) {
>   connection.on('error', function(err) {
>     if (!err.fatal) {
>       return;
>     }
> 
>     if (err.code !== 'PROTOCOL_CONNECTION_LOST') {
>       throw err;
>     }
> 
>     console.log('Re-connecting lost connection: ' + err.stack);
> 
>     connection = mysql.createConnection(connection.config);
>     handleDisconnect(connection);
>     connection.connect();
>   });
> }
> 
> handleDisconnect(connection); 
> ```
> 
> 正如您在上面的示例中看到的，重新连接连接是通过建立新连接来完成的。一旦终止，现有的连接对象就不能按设计重新连接。
> 
> 使用 Pool，断开连接的连接将从池中删除，从而为下一次 getConnection 调用创建新连接腾出空间。

* * *

我已经调整了函数，每次需要连接时，初始化函数都会自动添加处理程序：

```
function initializeConnection(config) {
    function addDisconnectHandler(connection) {
        connection.on("error", function (error) {
            if (error instanceof Error) {
                if (error.code === "PROTOCOL_CONNECTION_LOST") {
                    console.error(error.stack);
                    console.log("Lost connection. Reconnecting...");

                    initializeConnection(connection.config);
                } else if (error.fatal) {
                    throw error;
                }
            }
        });
    }

    var connection = mysql.createConnection(config);

    // Add handlers.
    addDisconnectHandler(connection);

    connection.connect();
    return connection;
} 
```

初始化连接：

```
var connection = initializeConnection({
    host: "localhost",
    user: "user",
    password: "password"
}); 
```

**小建议：**这可能不适用于所有人，但我确实遇到了与范围有关的小问题。如果 OP 认为此编辑是不必要的，那么他/她可以选择将其删除。对我来说，我必须在 中更改一行`initializeConnection`，这`var connection = mysql.createConnection(config);`只是

```
connection = mysql.createConnection(config); 
```

原因是如果`connection`是程序中的全局变量，那么之前的问题是您`connection`在处理错误信号时创建了一个新变量。但是在我的 nodejs 代码中，我一直使用相同的全局`connection`变量来运行查询，因此 new`connection`将在`initalizeConnection`方法的本地范围内丢失。但是在修改中，它确保全局`connection`变量被重置如果您遇到称为的问题，这可能是相关的

> 致命错误后无法排队查询

在失去连接后尝试执行查询然后成功重新连接后。这可能是OP的错字，但我只是想澄清一下。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-09-04T10:16:28.763

我遇到了同样的问题，谷歌把我带到了这里。我同意@Ata 的观点，即仅删除是不正确的`end()`。进一步谷歌搜索后，我认为使用`pooling`是一种更好的方法。

[关于池的 node-mysql 文档](https://github.com/felixge/node-mysql/blob/master/Readme.md#pooling-connections)

就像这样：

```
var mysql = require('mysql');
var pool  = mysql.createPool(...);

pool.getConnection(function(err, connection) {
    connection.query( 'bla bla', function(err, rows) {
        connection.release();
    });
}); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-07-10T12:20:34.790

不要在函数内部进行 connect() 和 end()。这将导致重复调用该函数时出现问题。仅建立连接

```
var connection = mysql.createConnection({
      host: 'localhost',
      user: 'node',
      password: 'node',
      database: 'node_project'
    })

connection.connect(function(err) {
    if (err) throw err

}); 
```

一次并重用该连接。

函数内部

```
function insertData(name,id) {

  connection.query('INSERT INTO members (name, id) VALUES (?, ?)', [name,id], function(err,result) {
      if(err) throw err
  });

} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-02-28T23:47:35.683

# AWS Lambda 函数

> 使用**mysql.createPool()**和**connection.destroy()**

这样，新的调用使用已建立的池，但不保持函数运行。即使您没有获得池的全部好处（每个新连接都使用一个新连接而不是现有连接），但它使得第二次调用可以建立一个新连接，而不必先关闭前一个连接。

**关于`connection.end()`**

这可能会导致后续调用引发错误。调用仍将稍后重试并工作，但有延迟。

**关于`mysql.createPool()`与`connection.release()`**

Lambda 函数将继续运行，直到计划的超时，因为仍然有一个打开的连接。

### 代码示例

```
const mysql = require('mysql');

const pool = mysql.createPool({
  connectionLimit: 100,
  host:     process.env.DATABASE_HOST,
  user:     process.env.DATABASE_USER,
  password: process.env.DATABASE_PASSWORD,
});

exports.handler = (event) => {
  pool.getConnection((error, connection) => {
    if (error) throw error;
    connection.query(`
      INSERT INTO table_name (event) VALUES ('${event}')
    `, function(error, results, fields) {
      if (error) throw error;
      connection.destroy();
    });
  });
}; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-08-17T09:48:41.960

代替`connection.connect();`使用 -

```
if(!connection._connectCalled ) 
{
connection.connect();
} 
```

如果它已经被调用，则`connection._connectCalled =true`&
它不会执行`connection.connect()`；

**注意**- 不要使用`connection.end();`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-02-01T22:17:32.853

我认为这个问题与我的类似：

1.  连接到 MySQL
2.  结束 MySQL 服务（不应退出节点脚本）
3.  启动 MySQL 服务，Node 重新连接 MySQL
4.  查询 DB -> FAIL（致命错误后无法排队查询。）

我通过使用 Promise (q) 重新创建新连接解决了这个问题。

mysql-con.js

```
'use strict';
var config          = require('./../config.js');
var colors          = require('colors');
var mysql           = require('mysql');
var q               = require('q');
var MySQLConnection = {};

MySQLConnection.connect = function(){
    var d = q.defer();
    MySQLConnection.connection = mysql.createConnection({
        host                : 'localhost',
        user                : 'root',
        password            : 'password',
        database            : 'database'
    });

    MySQLConnection.connection.connect(function (err) {
        if(err) {
            console.log('Not connected '.red, err.toString().red, ' RETRYING...'.blue);
            d.reject();
        } else {
            console.log('Connected to Mysql. Exporting..'.blue);
            d.resolve(MySQLConnection.connection);
        }
    });
    return d.promise;
};

module.exports = MySQLConnection; 
```

mysqlAPI.js

```
var colors          = require('colors');
var mysqlCon        = require('./mysql-con.js');
mysqlCon.connect().then(function(con){
   console.log('connected!');
    mysql = con;
    mysql.on('error', function (err, result) {
        console.log('error occurred. Reconneting...'.purple);
        mysqlAPI.reconnect();
    });
    mysql.query('SELECT 1 + 1 AS solution', function (err, results) {
            if(err) console.log('err',err);
            console.log('Works bro ',results);
    });
});

mysqlAPI.reconnect = function(){
    mysqlCon.connect().then(function(con){
      console.log("connected. getting new reference");
        mysql = con;
        mysql.on('error', function (err, result) {
            mysqlAPI.reconnect();
        });
    }, function (error) {
      console.log("try again");
        setTimeout(mysqlAPI.reconnect, 2000);
    });
}; 
```

我希望这有帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-06-07T08:34:12.520

您可以使用调试：假，

示例：//mysql连接

```
var dbcon1 = mysql.createConnection({
      host: "localhost",
      user: "root",
      password: "",
      database: "node5",
      debug: false,
    }); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-20T01:26:20.717

**解决方案：**为防止此错误（对于 AWS LAMBDA）：

为了退出“Nodejs事件循环”，您必须结束连接，然后重新连接。添加下一个代码以调用回调：

```
connection.end( function(err) {
        if (err) {console.log("Error ending the connection:",err);}

       //  reconnect in order to prevent the"Cannot enqueue Handshake after invoking quit"

         connection = mysql.createConnection({
                host     : 'rds.host',
                port     :  3306,
                user     : 'user',
               password : 'password',
               database : 'target database'

               });
        callback(null, {
            statusCode: 200,
            body: response,

        });
    }); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-01-18T23:14:36.017

如果你想得到一个 lambda，我发现结束处理程序`context.done()`让 lambda 完成。在添加那 1 行之前，它会一直运行直到超时。

# ruby-on-rails - 在 Rails 中设置 Stripe 支付处理时出现语法错误

> ID：14087926
> 
> 赞同：1
> 
> 时间：2012-12-30T02:57:46.677
> 
> 标签：ruby-on-rails

我的应用程序布局中此代码的最后一行遇到了“意外的 tASSOC”语法错误：

```
<%= stylesheet_link_tag    "application", :media => "all" %>
<%= javascript_include_tag "https://js.stripe.com/v1/", "application" %>
<%= csrf_meta_tags %>
<%= tag :meta, :name => "stripe-key", &crarr; :content => STRIPE_PUBLIC_KEY %> 
```

之前遇到错误`STRIPE_PUBLIC_KEY`：

```
unexpected tASSOC, expecting ')' 
```

据我所知，此代码与[RailsCast Stripe 教程](http://railscasts.com/episodes/288-billing-with-stripe?view=asciicast)相匹配，但该教程来自 2011 年，可能已经过时。我知道 hashrocket 语法很旧，但我不希望这会导致错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:35:20.137

教程代码中有一个随机回车。

# c# - 具有非用户实例的实体框架代码优先

> ID：14087929
> 
> 赞同：0
> 
> 时间：2012-12-30T02:58:03.037
> 
> 标签：c#, .net, entity-framework

这些是我使用 Entity Framework Code First 工作流程的第一步，所以也许我遗漏了一些简单的东西。我创建了继承自 DbContext 的上下文类

```
public class Context : DbContext
{
    public DbSet<Book> Books { get; set; }
    public DbSet<Author> Authors { get; set; }
} 
```

我在控制器代码中执行它：

```
var author = new Author()
{
  FirstName = "Julia",
  LastName = "Lerman"
};

using (var context = new Context())
{
  context.Authors.Add(author);
  context.SaveChanges();
} 
```

我没有为 EF 设置的其他代码或配置。当我启动应用程序并在控制器中点击代码时，一切正常，唯一的问题是数据库实际上不是在 SQL Server 中创建的，而是在某种程度上在本地运行。这意味着当我的应用程序运行时，我不能真正使用 SQL Server 管理工作室来检查数据，而我想要这样做。

我发现在 web.config 中自动添加了以下键：

```
<add name="ApplicationServices" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=false;" providerName="System.Data.SqlClient" /> 
```

如何修改此配置键（或者我需要做其他任何事情）以确保此数据库将在实际的 SQL Server Express 上而不是在进程中运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:47:44.053

好的，我想通了，感谢“Programming Entity Framework: Code First”一书，显然这是配置场景的约定，对于要获取的查询字符串，它的名称需要与 Context 类的名称相匹配（您从 DbContext 继承的那个）。因此我需要添加新的连接字符串，如下所示：

```
<add name="Context" connectionString="Data Source=.\SS2012EXPRESS;Initial Catalog=HomeLibrary;Integrated Security=True" providerName="System.Data.SqlClient" /> 
```

原始连接字符串可以保持原样，运行时不使用。我不完全确定它的目的是什么。

# string - 如何最好地在变量中搜索字符串“%00”？

> ID：14087930
> 
> 赞同：0
> 
> 时间：2012-12-30T02:58:03.787
> 
> 标签：string, perl

我有一个 Perl 变量，其中包含（链接终端调用）字符串“&00”。该字符串可能在较大的字符串中多次出现。

我怎样才能发现较大的字符串是否包含较小的字符串，以“砍”它？它总是出现在字符串的末尾。

就像是：

```
if ($string =~ (m//)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:29:24.890

假设您只想检查或替换字符串的结尾，

```
if ($string =~ /\&00$/) 
```

来检测它。

或者如果你只是想更换它，

```
$string =~ s/(.*)\&00$/$1/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:31:04.200

您可以使用[索引功能](http://perldoc.perl.org/functions/index.html)。

```
use strict;
use warnings;

my $sometext = "my text here contains &00 and some more text";
my $text_to_search = "&00";
print index($sometext, $text_to_search), "\n"; 
```

您可以稍后使用[substr](http://perldoc.perl.org/functions/substr.html)将其砍掉。

```
my $idx = index($sometext, $text_to_search);
print substr($sometext, 0, $idx); # if it's to the end, you can alter to suit. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T03:11:45.660

如果您只想删除它，如果它在最后：

```
if ( substr($string, -3) eq '&00' ) 
```

# mysql - mysql: ERROR 1044 (42000) at line 41: Access denied for user

> ID：14087933
> 
> 赞同：0
> 
> 时间：2012-12-30T02:58:33.070
> 
> 标签：mysql, permissions

我在使用 mysql 时遇到了一个奇怪的权限错误。

当我尝试上传备份时，我得到：

```
mysql DB -uDB -pPASS < files.30.12.12.sql
ERROR 1044 (42000) at line 41: Access denied for user 'DB'@'localhost' to database 'DB' 
```

奇怪的是，使用相同的用户名和密码我可以登录到 mysql consul：

```
mysql DB -uDB -pPASS
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 51
Server version: 5.5.27-28.1 Percona Server (GPL), Release rel28.1, Revision 296

Copyright (c) 2000, 2011, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:31:44.790

检查您是否也可以在手动登录时运行该 SQL 文件。我猜您的 SQL 语句不能由该指定用户 (-uDB) 执行。该错误不一定意味着您没有登录MySQL，很可能意味着您没有运行脚本的权限

您可以通过执行简单的语句来尝试登录，例如

```
mysql DB -uDB -pPASS < SHOW TABLES 
```

# c# - Windows 8 App 读取和/或复制锁定文件

> ID：14087936
> 
> 赞同：0
> 
> 时间：2012-12-30T02:59:07.220
> 
> 标签：c#, visual-studio, windows-8, windows-store-apps

我正在编写一个 Windows 8 应用程序（如标题所示），我希望能够在另一个程序完成编写但仍在使用时复制另一个程序使用的文件。Windows 资源管理器不允许复制该文件，因为它说它正在被另一个程序使用。我已经广泛搜索了这个问题，每个人都说用来`System.IO.FileStream`完成任务。但是，因为我使用的是 Metro 应用程序，所以这不是一个选项。我还能如何完成这项任务？

**更新：** 这是我迄今为止尝试过的

```
//FAILED TO READ LOCKED FILE
//await Windows.Storage.FileIO.ReadBufferAsync(file);
//await file.OpenSequentialReadAsync();
//await file.OpenAsync(FileAccessMode.Read);
//await file.OpenReadAsync();
//await file.OpenSequentialReadAsync();
//await file.OpenStreamForReadAsync();
//await FileIO.ReadBufferAsync(file);
//await FileIO.ReadLinesAsync(file);
//await FileIO.ReadTextAsync(file); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T15:53:31.933

我终于找到了我的答案！使用`await file.CopyAsync(storageFolder);`我创建了文件的副本而没有问题

# c# - Visual Studio 2012 / VS11 是否有自定义语言插件？

> ID：14087937
> 
> 赞同：4
> 
> 时间：2012-12-30T02:59:35.067
> 
> 标签：c#, vb.net, visual-c++, visual-studio-2012, visual-studio-addins

好吧，我想在Visual Studio 2012中添加对[PAWN 语言的支持。](http://www.compuphase.com/pawn/pawn.htm)

但是由于缺乏经验和缺乏我可以编辑的教程/插件，这确实是一项艰巨的任务。

现在我只想添加文件类型和编译器，不需要智能感知和语法高亮，可以使用 C 语法高亮器。

我知道有 OOK 语言实现和 Boo 语言，但这些加载项适用于 VS2010，不会为 VS2012 编译。

我将如何做到这一点？

是否有可以编辑/用作基础/用作示例的语言插件（用于 VS2012）？

我的最后一次尝试导致了一个黑色窗口/无法使用的 VS2012 IDE。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-08T10:30:32.937

Visual Studio 2010的官方语言[扩展示例](http://msdn.microsoft.com/en-us/library/bb458154.aspx)是[Iron Python](http://ironpython.net/)集成示例。

您可以从这里下载它：[IronPython 集成](http://code.msdn.microsoft.com/IronPython-Integration-6b03988d)。这里有一个相关的文档：[Visual Studio IronPython Integration Deep Dive](http://archive.msdn.microsoft.com/IPyDD)

不幸的是，据我所知，此示例并未针对 Visual Studio 2012 进行更新。但是，这里是将其转换为 Visual Studio 2012 的步骤。

1.  从此处安装 Visual Studio 2012 SDK：[Microsoft Visual Studio 2012 SDK](http://www.microsoft.com/en-us/download/details.aspx?id=30668)
2.  下载 Iron Python 集成示例，提取到磁盘上的某个位置
3.  打开`IronPython.sln`，并接受所有升级转换
4.  将项目的平台目标从更改`AnyCpu`为`x86`
5.  某些项目对 Visual Studio 11 程序集（针对 .NET 4.5 构建）的引用不正确（自动提示），因此它们不会按原样编译。将它们改回 Visual Studio 10 程序集。例如，IronPython.Console 项目中的 Microsoft.VisualStudio.ExtensibilityHosting.dll 需要指向`C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\PrivateAssemblies`.
6.  将`IronPython.Project`项目定义为启动项目，并更新其调试参数：启动操作需要启动`C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\devenv.exe`（VS 2012 shell）外部程序，而不是`C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\devenv.exe`默认设置的（VS 2010 shell）外部程序。命令行参数应设置为`/RootSuffix Exp`
7.  `IronPython.targets`更新所有基本模板以使用 VS 2012 目录而不是仅使用 VS 2010 目录：在所有 .pyproj 文件中搜索字符串并添加 VS 2012 案例，如下所示：

前：

```
 <PropertyGroup>
    <!-- Set the IronPythonPath property by proving in different locations where Iron Python could be installed -->
    <!-- Regular LocalAppData -->
    <IronPythonPath Condition=" '$(IronPythonPath)' == '' AND Exists('$(LocalAppData)\Microsoft\VisualStudio\10.0\Extensions\Microsoft\IronPython\1.0\IronPython.targets')">$(LocalAppData)\Microsoft\VisualStudio\10.0\Extensions\Microsoft\IronPython\1.0</IronPythonPath>
    <!-- Experimental LocalAppData -->
    <IronPythonPath Condition=" '$(IronPythonPath)' == '' AND Exists('$(LocalAppData)\Microsoft\VisualStudio\10.0Exp\Extensions\Microsoft\IronPython\1.0\IronPython.targets')">$(LocalAppData)\Microsoft\VisualStudio\10.0Exp\Extensions\Microsoft\IronPython\1.0</IronPythonPath>
      <!-- Integrated Shell -->
    <IronPythonPath Condition=" '$(IronPythonPath)' == '' AND Exists('$(MSBuildExtensionsPath)\Microsoft\IronPython Studio 2010\1.0\IronPython.targets')">$(MSBuildExtensionsPath)\Microsoft\IronPython Studio 2010\1.0</IronPythonPath>
  </PropertyGroup> 
```

后：

```
 <PropertyGroup>
    <!-- Set the IronPythonPath property by proving in different locations where Iron Python could be installed -->
    <!-- Regular LocalAppData -->
    <IronPythonPath Condition=" '$(IronPythonPath)' == '' AND Exists('$(LocalAppData)\Microsoft\VisualStudio\10.0\Extensions\Microsoft\IronPython\1.0\IronPython.targets')">$(LocalAppData)\Microsoft\VisualStudio\10.0\Extensions\Microsoft\IronPython\1.0</IronPythonPath>
    <!-- Experimental LocalAppData -->
    <IronPythonPath Condition=" '$(IronPythonPath)' == '' AND Exists('$(LocalAppData)\Microsoft\VisualStudio\10.0Exp\Extensions\Microsoft\IronPython\1.0\IronPython.targets')">$(LocalAppData)\Microsoft\VisualStudio\10.0Exp\Extensions\Microsoft\IronPython\1.0</IronPythonPath>
      <!-- Regular LocalAppData VS10212 -->
      <IronPythonPath Condition=" '$(IronPythonPath)' == '' AND Exists('$(LocalAppData)\Microsoft\VisualStudio\11.0\Extensions\Microsoft\IronPython\1.0\IronPython.targets')">$(LocalAppData)\Microsoft\VisualStudio\11.0\Extensions\Microsoft\IronPython\1.0</IronPythonPath>
      <!-- Experimental LocalAppData VS2012-->
      <IronPythonPath Condition=" '$(IronPythonPath)' == '' AND Exists('$(LocalAppData)\Microsoft\VisualStudio\11.0Exp\Extensions\Microsoft\IronPython\1.0\IronPython.targets')">$(LocalAppData)\Microsoft\VisualStudio\11.0Exp\Extensions\Microsoft\IronPython\1.0</IronPythonPath>
      <!-- Integrated Shell -->
    <IronPythonPath Condition=" '$(IronPythonPath)' == '' AND Exists('$(MSBuildExtensionsPath)\Microsoft\IronPython Studio 2010\1.0\IronPython.targets')">$(MSBuildExtensionsPath)\Microsoft\IronPython Studio 2010\1.0</IronPythonPath>
  </PropertyGroup> 
```

就是这样。编译并运行（由于注册的谜团，第一次都需要一段时间）。

以下是从 Visual Studio 2012 启动新 Iron Python 项目时的结果： ![在此处输入图像描述](../Images/a03dbcc3d879824cadfa8bbb04495a50.png)

并在构建时： ![在此处输入图像描述](../Images/1431459daa521bbd1a71b105910e9d70.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-30T03:26:53.743

查看这篇[CodeProject 文章](http://www.codeproject.com/Articles/477550/Developing-extension-packages-for-Visual-Studio-20)使用 C# 和源代码开发扩展包，该文章似乎已针对 Visual Studio 2012 以及旧版本的 Visual Studio 进行了更新。

这是来自 Microsoft 的一篇[关于创建加载项主题的](http://msdn.microsoft.com/en-us/library/80493a3w.aspx)文章。

这是第二篇[CodeProject 文章，属于扩展 Visual Studio 第 2 部分创建插件系列的一部分](http://www.codeproject.com/Articles/324611/Extending-Visual-Studio-Part-2-Creating-Addins)。

# opengl - 位图字体的立即模式

> ID：14087938
> 
> 赞同：0
> 
> 时间：2012-12-30T02:59:35.503
> 
> 标签：opengl, vbo, bitmap-fonts

我在 OpenGL 中绘制文本。文本移动和变化非常频繁。

我有一个位图字体图集（png 和 XML 文件），并且能够为字形生成纹理坐标。现在我面临如何渲染四边形。

我突然想到，立即模式将是一种非常方便的方式。管理一个充满不断变化的字形四边形的缓冲区似乎相当麻烦——设置一个池分配器、所有映射和取消映射以更新顶点等。我想知道与立即模式相比的性能改进是否会是这样伟大的。

作为一个球场，一次屏幕上可能不会超过几百个字形。

你怎么看？为此使用立即模式会非常错误吗？

# python - 在 pyinstaller-2.0/PyInstaller/lib/macholib/util.py 中使用 Pyinstaller 2.0 语法错误时

> ID：14087942
> 
> 赞同：0
> 
> 时间：2012-12-30T03:00:13.580
> 
> 标签：python, executable, exe, python-2.5, pyinstaller

我刚刚安装了 PyInstaller 2.0，我一直在尝试使用它来创建 python 脚本的可执行文件。但是，从终端，当我 cd 进入目录 pyinstaller-2.0 并运行包含的`README`文本文件中的命令时，如下所示：

`python pyinstaller.py Path/to/my/application.py`

我收到一条错误消息，似乎表明其中一个 PyInstaller 文件中存在语法错误：

```
File "pyinstaller.py", line 26, in <module>
    import PyInstaller.build
  File "/Desktop/pyinstaller-2.0/PyInstaller/build.py", line 30, in <module>
    import bindepend
  File "/Desktop/pyinstaller-2.0/PyInstaller/bindepend.py", line 30, in <module>
    from PyInstaller.depend import dylib
  File "/Desktop/pyinstaller-2.0/PyInstaller/depend/dylib.py", line 149, in <module>
    from PyInstaller.lib.macholib import util
  File "/Desktop/pyinstaller-2.0/PyInstaller/lib/macholib/util.py", line 136
    except (IOError, os.error) as why:
                                ^
SyntaxError: invalid syntax 
```

我缺少一个步骤吗？这是一个常见的错误吗？我在 Mac OSX 10.5.8 上使用 Python 2.5.1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:05:46.837

Python 2.5 不使用该`except Exception as name:`格式。改为使用 `except Exception, name:`。

有关更多信息，请参阅[http://docs.python.org/2.5/tut/node10.html](http://docs.python.org/2.5/tut/node10.html)

# javascript - JSON 字符串化和解码 JS/PHP

> ID：14087947
> 
> 赞同：0
> 
> 时间：2012-12-30T03:01:57.603
> 
> 标签：javascript

我在 PHP 中发送对象时遇到问题。在将对象发送到 PHP 文件之前，我将其字符串化。

然后 PHP 文件使用 json_decode。但解码显示一个空白变量。

我 console.log 的对象显示为它的结构：

![在此处输入图像描述](../Images/f3b714a1f88d962f49a9a7ffb13e34ce.png)

然后将其发送到 PHP：

```
 console.log(my_Obj);
    var as = JSON.stringify(my_Obj);        
    call_data('add.php?&as='+as, nxtFunc); 
```

现在在 PHP 文件中我有这个处理这种情况：

```
 $path = json_decode($_GET['as']);
    echo $_GET['as'].'<br/>';
    print_r($path);
    die; 
```

结果是：

```
[null,null,{\"8\":[null,null,null,null,null,null,[],[],[],[],[]],\"9\":
[null,null,null,null,null,null,null,null,null,null,[]],\"10\":
[null,null,null,null,null,null,null,null,null,null,[],[]],\"11\":
[null,null,null,null,null,null,null,null,null,null,null,[]]}]   
<br/> 
```

我在 Chrome 中的 XHR 请求网址显示：

```
add.php?as=[null,null,{%228%22:[null,null,null,null,null,null,[],[],[],[],[]],%229%22:[null,null,null,null,null,null,null,null,null,null,[]],%2210%22:[null,null,null,null,null,null,null,null,null,null,[],[]],%2211%22:[null,null,null,null,null,null,null,null,null,null,null,[]]}] 
```

注意 print_r 什么也没显示。我不应该使用 stringify 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:04:32.020

那是因为`my_Obj`它是一个数组而不是一个对象。

试试这个：

```
var as = JSON.stringify({data: my_Obj}); 
```

笔记：

您还需要在字符串化之前清理数组 - 即清除所有空/未定义的索引。检查这个答案：[https ://stackoverflow.com/a/281335/921204](https://stackoverflow.com/a/281335/921204)

# php - php - 如何使事件队列在浏览器游戏中以离线模式工作

> ID：14087948
> 
> 赞同：0
> 
> 时间：2012-12-30T03:02:02.187
> 
> 标签：php, events, mmo

在考虑制作网页游戏时，我遇到了一个令人不安的麻烦。许多游戏都有这样的“事件队列”。我有一支“军队”并将其发送给我的对手。我需要一些时间。当我的“军队”获得对手“军队”的位置时，就会计算出一场战斗，因此我的“军队”输了或赢了。当我或我的对手在比赛中时，一切都很好。某种 ajax 工作可以管理要调用的 php 脚本并计算战斗 - 然后将其结果保存到数据库。但是如果战斗发生时我和对手都没有登录，它怎么能工作呢？这种游戏的一个很好的例子是Ogame，当您将船只发送到另一个星球时，它可以在您注销时到达目的地，进行战斗，获取敌人的来源并卷土重来，

我一直认为我可以在数据库行中节省攻击者和他的对手的攻击时间，并在任何玩家登录游戏时计算战斗，但这种解决方案有很多缺点。例如，如果在我攻击我的对手之前有第三个玩家会攻击，这将改变他的军队统计数据（因为他可以杀死他的一部分军队）并且我有很多后果。此外，如果长时间没有玩家退出，他们就会出现在游戏中，因为他们没有在战斗，这不是真的。

你知道如何制作这样的事件队列吗？我想使用 cron 也不是一个好主意——它有时很少被使用，如果有成千上万的玩家，成千上万的 cron 实例可能会成为性能杀手。任何概念都将不胜感激-希望我能很好地描述我的问题:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:25:50.377

在您的数据库中，创建一个“作业”表（无论您需要什么内容，加上一个 EXPIRE 日期 - 即作业完成的时间），并且每次用户创建作业（例如，将船只从一个集群移动到另一个集群），制作一个此表中的新条目，其中 EXPIRE 设置为船只到达目标集群的时间。

然后，每当任何人（！）加载任何站点（甚至是起始页）时，脚本都会检查队列中应该现在已经完成的作业。如果有任何 EXPIRE 低于 NOW 的作业，那么它会完成这项工作（或者，对于更大的作业，分叉一个 php cli 进程来完成这项工作）。

假设现在是2012-12-28 12:00，游戏有两个玩家A和B，其中A向B发起攻击需要6个小时。使用 EXPIRE=2012-12-28 18:00 和内容“Fleet foobar Attack B”创建作业。

案例 A：现在，A 退出，直到 19:00 才发生任何事情。B 登录，在其他任何事情发生之前（这对于确保“通知”或收件箱不会出现不同步很重要），脚本会看到工作在表中并且过期。该脚本执行作业并向 B 创建通知，通知他被来自 A 的庞大舰队淹没。作业完成，一切都很好（除了 B 的情绪）。

案例 B：A 退出。18:30，一位匿名用户访问了起始页。该脚本再次查看作业表并执行作业。B 在 19:00 登录并看到他丢失的通知。任务完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-12T08:19:56.570

在我的项目中，无 CRON 事件队列背后的想法很简单：

1.  所有事件都有“结束”时间。我正在使用原始 UNIX time() 时间戳来轻松进行比较操作。

2.  当用户“点击”（打开任何游戏页面）时，队列引擎根据优先级获取所有“结束”<= 当前时间（）的事件。在同一秒发生的事件从高优先级到低优先级执行。

3.  如果游戏中没有用户 - 没有人需要事件。就这么简单:) 游戏会一直休眠，直到有人登录游戏并回滚事件队列，如第二步所述。

您可以在任何网站上添加相同的功能，这些网站具有定期事件和可观的每日网站流量。

（其实我也是按需求做了cron.php后端）

# php - 无法修改标头信息 - 与 MySQL 查询相关

> ID：14087959
> 
> 赞同：0
> 
> 时间：2012-12-30T03:05:39.617
> 
> 标签：php, mysql

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

我解决了这个问题，但由于我不明白是什么原因造成的，我不能确定它是否真的解决了。

在您登录之前，我的 PHP 站点会在主页上显示最新的活动。我最近修改了逻辑以包含更多类型的活动。看起来它有效，但我在登录时收到以下错误：

```
Warning: Cannot modify header information - headers already sent by
(output started at header.php:75)
in index.php on line 26 
```

我认为此错误消息具有误导性，因为我修复它的方法是在 MySQL 查询中将“LIMIT 10”更改为“LIMIT 9”，以使活动显示在主页上。

```
 public function getLatestActivity()
{
    $sql = "SELECT 'Debate' AS Type, d.Debate_ID AS ID, CONCAT('debate.php?debate_id=', d.Debate_ID) AS URL, d.Title, d.Add_Date
        FROM debates d

        UNION SELECT 'Discussion' AS Type, d.Discussion_ID AS ID, CONCAT('discussion.php?discussion_id=', d.Discussion_ID) AS URL, d.Title, d.Add_Date
        FROM discussions d

        UNION SELECT 'Petition' AS Type, p.Petition_ID AS ID, CONCAT('petition.php?petition_id=', p.Petition_ID) AS URL, p.Petition_Title AS Title, p.Add_Date
        FROM petitions p

        ORDER BY Add_Date DESC
        LIMIT 9";

    try
    {
        $stmt = $this->_db->prepare($sql);
        $stmt->execute();
        $activity = array();
        while ($row = $stmt->fetch())
        {
            $activity[] = '<span style="font-size: x-large"><strong>Latest activity</strong></span><br /><span style="font-size: large">' . $row['Type'] . ': <span style="color: #900"><a href="' . $row['URL'] . '" style="color: #900">' . $row['Title'] . '</a></span></span>';
        }
        $stmt->closeCursor();

        return $activity;
    }
    catch(PDOException $e)
    {
        return FALSE;
    }
} 
```

这就是我对该函数返回的数据所做的事情。它遍历数组并每 4 秒显示一个新项目。

```
 <?php $latest_activity = $pdb->getLatestActivity(); ?>
<script type="text/javascript">
    var activity = <?php echo json_encode($latest_activity);  ?>;
    var index = -1;
    $(function()
    {
        getLatestActivity();
    });
    function getLatestActivity()
    {
        index = (index + 1) % activity.length;
        var div = document.getElementById('divLatestActivity');
        if (index < activity.length)
        {
            div.innerHTML = activity[index];
        }
        setTimeout("getLatestActivity()", 4000);
    }
</script> 
```

为什么将“LIMIT 10”更改为“LIMIT 9”可以解决“无法修改标头信息”问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:11:18.803

在 PHP 中，如果您使用 header() 函数（即 header("Location:login.php"); 重定向到 login.php 页面），您必须*在*任何其他可能向浏览器输出文本的代码之前执行此操作。

```
//this will CAUSE a warning
echo "Login now";
session_start()
header("content-type:text/html");
header("cache-control:max-age=3600"); 
```

然而...

```
//this will NOT CAUSES a warning
header("content-type:text/html");
header("cache-control:max-age=3600");
session_start();
echo "Login now"; 
```

因此，梳理执行任何 session_start() 或 header() 指令的代码，并确保没有 echo ""; 在他们面前。如果您在 session_start() 或 header() 之前有任何 MySQL 警告被抛出到页面上，也会导致此警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:14:56.927

您需要检查是否以 echo、print 或 HTML 的形式完成了某些输出。如果这样做了，那么 header("LOCATION: login.php") 将抛出一个错误。

解决这个问题的一种方法是使用输出缓冲。

> ob_start();

# oop - 帕斯卡“这个”参考

> ID：14087962
> 
> 赞同：1
> 
> 时间：2012-12-30T03:06:13.377
> 
> 标签：oop, this, pascal, freepascal

我开始使用面向对象的方法来探索 Pascal。~~我想知道是否存在对当前对象的`this`或引用？`self`我四处寻找文档，但没有找到答案。~~

**编辑**
通过反复试验我发现您可以使用`self`. 现在我的问题是我可以在编译器不抛出“重复标识符错误”的情况下实现这一点*（下面的片段）吗？*

```
constructor Employee.create(name:String; salary:Real);
begin
  self.name := name;
  self.salary := salary;
end; 
```

我有一个下面的程序，它创建 2 名员工并显示他们的信息

```
{$mode objfpc} // directive to be used for defining classes
{$m+}          // directive to be used for using constructor

program EmployeeTest;
type
  Employee = class
  private
    name:String;
    salary:Real;
  public
    constructor create(name:String; salary:Real);
    procedure setName(name:String);
    function getName():String;
    procedure setSalary(salary:Real);
    function getSalary():Real;
    procedure displayEmployee;
end;

var empl1,empl2:Employee;

constructor Employee.create(name:String; salary:Real);
begin
  setName(name);
  setSalary(salary);
end;

procedure Employee.setName(name:String);
begin
  self.name := name;
end;

procedure Employee.setSalary(salary:Real);
begin
  self.salary := salary;
end;

function Employee.getName():String;
begin
  getName := self.name;
end;

function Employee.getSalary():Real;
begin
  getSalary := self.salary;
end;

procedure Employee.displayEmployee;
begin
  writeln('Name: ',getName,', Salary: $',getSalary:0:2);
end;

begin
  empl1 := Employee.create('Bob', 75000);
  empl2 := Employee.create('Joe', 50000);
  empl1.displayEmployee();
  empl2.displayEmployee();
  readln; {pause}
end. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T03:22:25.513

没想到我会回答我的问题。

[在这里](http://www.lazarus.freepascal.org/index.php?topic=4785.0)找到了答案。

如果要在嵌套函数中重复变量名称，则必须使用`{$mode delphi}`而不是。`{$mode objfpc}`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T12:12:29.557

1.  不要为参数和属性使用相同的名称。使用前缀 A 作为参数。
2.  不要实现 getter 和 setter 方法。在 Pascal 中使用 property 关键字。
3.  对私有字段使用前缀 F。
4.  对自定义类型使用前缀 T。

这是您班级的示例：

```
type
  TEmployee = class(TObject)
    private
      FName: String;
      FSalary:Real;
    public
      constructor Create(AName:String; ASalary:Real);
      property Name: String read FName write FName;
      property Salary: Real read FSalary write FSalary;
      procedure DisplayEmployee;
  end;

constructor TEmployee.Create(AName:String; ASalary:Real);
begin
  inherited Create;
  FName := AName;
  FSalary := ASalary;
end;

procedure TEmployee.DisplayEmployee;
begin
  WriteLn('Name: ', FName, ', Salary: $', FSalary:0:2);
end; 
```

# javascript - JavaScript 中的“function() { get: function(...) { ... } }” 是什么意思？

> ID：14087963
> 
> 赞同：0
> 
> 时间：2012-12-30T03:06:14.347
> 
> 标签：javascript

[我在这里](http://www.yearofmoo.com/2012/10/more-angularjs-magic-to-supercharge-your-webapp.html#you-should-be-using-custom-services)找到了以下代码片段：

```
App.factory('myHttp',['$http',function($http) {
  return function() {
    get: function(url, success, fail) {
      $http.get(url).success(function(response) {
        return response.data;
      }).error(fail);
    }
  };
}]); 
```

我想知道这个语法是什么意思：

```
function() {
  get: function(...) { ... }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T03:09:39.263

看起来这是一个错字。这绝对是语法错误。它类似于[ES5 的 getter 表示法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/get)，但即便如此，您也只能将其与属性名称一起使用，例如`get response() { ... }`.

也许作者的意图是：

```
App.factory('myHttp',['$http',function($http) {
  return {
    get: function(url, success, fail) {
      $http.get(url).success(function(response) {
        return response.data;
      }).error(fail);
    }
  };
}]); 
```

这*不是*ES5 的 getter 表示法，而是一个简单的对象，它有一个名为 的属性`get`，指的是[HTTP GET](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods)（而不是 POST）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:29:36.310

我有理由确定 JavaScript 解析器会将`get`那里解释为[label](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/label)。没用，因为标签只对循环控制有用，这里没有循环。尽管如此，它主要是合法的语法。也就是说，Firefox 的解释器会抱怨死代码匿名函数。

# virtual-machine - 切换 Vagrant 以使用 Parallels 而不是 VirtualBox

> ID：14087966
> 
> 赞同：9
> 
> 时间：2012-12-30T03:06:56.417
> 
> 标签：virtual-machine, vagrant

是否可以在 Vagrant 中使用 Parallels 而不是（非常慢的）VirtualBox？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-09-22T05:38:10.217

也许这会帮助你（新鲜和新的）

[https://github.com/yshahin/vagrant-parallels](https://github.com/yshahin/vagrant-parallels)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-14T21:14:18.560

虽然它不是 Parallels（您可能已经付费），但有一个用于使用 VMWare Fusion 的插件：

[http://www.vagrantup.com/vmware](http://www.vagrantup.com/vmware)

该插件*不是*免费的，因此您需要为插件和 Fusion 购买许可证。

我每周在我的虚拟机中遇到几次内核恐慌。根据 Mitchell 的说法，VirtualBox 在 Mac 上的内核恐慌问题多年来一直没有得到很好的解决，而换成 Fusion 是最好的选择。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-04-10T14:46:30.203

终于有了来自 Parallels 的官方 Vagrant Provider！[不幸的是， www.vagrantup.com](http://www.vagrantup.com)上没有提到它。

请参阅[Parallels 的 Vagrant 文档](http://parallels.github.io/vagrant-parallels/)和 Vagrant 提供程序项目的[Parallels GitHub 页面](https://github.com/Parallels/vagrant-parallels/)。有关提供商的更多问题，请访问[专门的官方论坛](http://forum.parallels.com/forumdisplay.php?737-Parallels-Provider-for-Vagrant)。

~~到目前为止，只有一个限制：“Parallels 提供程序支持所有基本的 Vagrant 功能，除了下一个：“转发端口”配置尚不可用。” （取自[GitHub 上的自述文件](https://github.com/Parallels/vagrant-parallels#features)）~~

感谢[AgentK](https://stackoverflow.com/users/14868/agentk)指出“转发端口”从 Parallels 10 for Mac 开始可用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-30T03:14:48.963

几个月前有一个大型提交，合并了*机器抽象*分支：

*   [https://github.com/mitchellh/vagrant/commit/391dc392675c73518ebf04252d824fe916e8860b](https://github.com/mitchellh/vagrant/commit/391dc392675c73518ebf04252d824fe916e8860b)

甚至[在 Hacker News 上也进行了一些讨论](http://news.ycombinator.com/item?id=4406467)。

> 这个分支引入了“机器抽象”代码。这是 Vagrant 开发中的一个重要里程碑，因为它将所有 VirtualBox 特定的代码抽象到一个插件中。

问题：

> White 现在在技术上可以为其他提供商编写插件，但要使之可行，仍有大量工作要做。

到目前为止，*master*中唯一的提供者是 virtualbox：

*   [https://github.com/mitchellh/vagrant/tree/master/plugins/providers](https://github.com/mitchellh/vagrant/tree/master/plugins/providers)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-28T07:07:46.583

您*可以*将 Parallels 与 Vagrant 一起使用。以下是执行此操作的逐行说明（假设您安装了 Parallels 和 Vagrant）。

1.  `$ vagrant plugin install vagrant-parallels`
2.  `$ mkdir some-project/ && cd some-project`
3.  `$ vagrant init parallels/ubuntu-14.04`
4.  `$ vagrant up --provider parallels`

请注意，您只需安装`vagrant-parallels`一次。另请注意，您只需在`--provider parallels`第一次传递时`up`，它就会自动使用并行提供程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-13T03:19:53.220

在 google 中找到了这个线程以及官方的 Parallels-Vagrant 集成：[https ://github.com/Parallels/vagrant-parallels](https://github.com/Parallels/vagrant-parallels)

# php - 右数输出PHP

> ID：14087968
> 
> 赞同：-3
> 
> 时间：2012-12-30T03:07:10.307
> 
> 标签：php

我想要这样的数字格式：

```
1000 = 1k

10500 = 10.5k

1843 = 1.8k

17434 = 17.4k 
```

但我不知道该怎么做。语言是PHP

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T03:12:54.140

尝试这个：

```
$num = 14600;
if($num >= 1000)
{
    echo round(($num/1000),1) . 'k';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T03:13:16.267

这将满足您的需要。

```
<?php
$num = 10234;
echo round($num/1000*100)/100.'k';
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T03:10:14.327

这应该适用于任何数字。

```
$num = 1000;
echo round($num / 1000) . "k"; 
```

# ruby-on-rails-3 - 工厂女孩，依赖工厂

> ID：14087972
> 
> 赞同：5
> 
> 时间：2012-12-30T03:08:12.267
> 
> 标签：ruby-on-rails-3, factory-bot, minitest

# 更新

我又开始使用 Fixtures。IMOP，夹具比工厂好得多；更容易使用，更容易编写，更容易理解（没有魔法）。我的建议：将您的测试库限制在最基本的范围内（听 DHH）...使用带有夹具的 minitest。

# 原帖

在我的应用程序中，一个地区有很多学校，一个学校有很多用途，一个用户有很多账户，一个账户有一个角色。为了创建完整的工厂进行测试，我需要创建一个跨工厂持续存在的用户和学校。在我最近的尝试中，我遇到了“堆栈级别太深”的错误。

我的 user_test.rb

```
 FactoryGirl.define do

   factory :district do
     name "Seattle"
   end

   factory :school do
     association :primarycontact, factory: :user # expecting this to attach the user_id from factory :user as :primary contact_id in the school model
     association :district, factory: :district # expecting this to attach the :district_id from the :district factory as :district_id in the school model
     name "Test School"
   end

   factory :user do, aliases: [:primarycontact]
     email "adam@example.com"
     name "Who What"
     username "wwhat"
     password "123456"
     password_confirmation { |u| u.password }
     association :school, factory: :school # expecting this to create :school_id in the users model, using the :school factory
   end

   factory :role do
     name "student"
   end

   factory :account do
     association :user, factory: :user
     association :role, factory: :role
   end

 end 
```

因此，我正在尝试`FactoryGirl.create(:account)...`创建一个帐户，该帐户具有上述工厂的用户和角色，以及与该地区相关联的学校相关联的用户。这对我不起作用。在失败的测试中，我得到一个“堆栈级别太深”的错误。而且，我相信我在每个 DatabaseCleaner.clean 之前都会在每个新工厂之前清除测试数据库。

调用这些工厂的测试是：

```
describe "User integration" do

  def log_em_in
    visit login_path
    fill_in('Username', :with => "wwhat")
    fill_in('Password', :with => "123456")
    click_button('Log In')
  end

  it "tests log in" do
    user = FactoryGirl.create(:account)
    log_em_in
    current_path.should == new_user_path
  end

end 
```

.

```
current_path.should == new_user_path returns unknown method error 'should' 
```

如何改进此代码以正确嵌套工厂并获取 current_user 以继续测试？

# 楷模

学校.rb

```
 belongs_to :district
  belongs_to :primarycontact, :class_name => "User"
  has_many :users, :dependent => :destroy 
```

用户.rb

```
 belongs_to :school
  has_many :accounts, :dependent => :destroy 
```

区.rb

```
 has_many :schools 
```

帐号.rb

```
 belongs_to :role
  belongs_to :user 
```

角色.rb

```
 has_many :accounts
  has_many :users, :through => :accounts 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-01T08:14:46.300

您的基本问题是您的`user`工厂和您的`school`工厂之间存在循环依赖关系，这是由于您`primarycontact`在创建学校时创建了一个（用户），然后该用户创建了学校，等等。

您可以通过更改在工厂`school`内定义关联的方式来解决此问题。`user`不过，在这样做之前，我建议作为一般规则使用关联的速记符号。所以替换这个：

```
factory :account do
  association :user, factory: :user
  association :role, factory: :role
end 
```

有了这个：

```
factory :account do
  user
  role
end 
```

使用这种简化，以下工厂将做你想做的事，而不会产生任何循环依赖：

```
FactoryGirl.define do

  factory :district do
    name "Seattle"
  end

  factory :school do |school|
    district
    primarycontact
    name "Test School"
    after_build do |s|
      s.primarycontact.school = s
    end
  end

  factory :user do
    email "adam@example.com"
    name "Who What"
    username "wwhat"
    password "123456"
    password_confirmation { |u| u.password }
    school
  end

  factory :primarycontact, class: "User" do
    # add any attributes you want the primarycontact user to have here
  end

  factory :role do
    name "student"
  end

  factory :account do
    user
    role
  end

end 
```

请注意，我所做的是`primarycontact`使用该`class: "User"`选项创建工厂。与`user`工厂不同，该工厂默认不创建`school`，避免了循环依赖。

然后在`school`工厂中，我使用`after_build`回调将学校本身分配给 上的`school`关联`primarycontact`，而不是创建新学校（这导致您的工厂出现问题）。

希望这是有道理的。请注意，最新版本的 factory_girl 中的回调语法已更改，有关详细信息，请参阅[文档](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md)。

# c# - 如何在 win 表单项目中创建用户控件的 dll？

> ID：14087975
> 
> 赞同：7
> 
> 时间：2012-12-30T03:09:06.997
> 
> 标签：c#

我有我在我的项目中创建的这个用户控件。当我编译项目时，我看到了项目 dll。但是我怎么能做到这一点，当我编译项目时，它也会创建一个用户控件的 dll，所以稍后在其他项目中我将能够将此用户控件 dll 添加到我的工具箱中？

```
/*----------------------------------------------------------------
 * Module Name  : ListBoxControl
 * Description  : Change listBox items color
 * Author       : Danny
 * Date         : 30/12/2012
 * Revision     : 1.00
 * --------------------------------------------------------------*/

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Windows.Forms;

/*
 *  Introduction :
 * 
 *  By default the color is red.
 *  Added a property to change the color.
 *  Right mouse click on item to change item color.
 *  Left mouse click on item to change the item color back. 
 * */

namespace ListBoxControl
{
    public partial class ListBoxControl : UserControl
    {
        Color m_MyListColor;
        private List<int> m_itemIndexes = new List<int>();

        public ListBoxControl()
        {
            InitializeComponent();

            for (int i = 0; i < 10; i++)
            {
                listBox1.Items.Add("Test " + i);
            }
        }

        private void listBox1_MouseDown(object sender, MouseEventArgs e)
        {
            int index = listBox1.IndexFromPoint(e.X, e.Y);
            listBox1.SelectedIndex = index;

            if (e.Button == System.Windows.Forms.MouseButtons.Right)
            {
                if (m_itemIndexes.Contains(index))
                    return;

                m_itemIndexes.Add(index);
                DrawItem(index);
            }
            else if (e.Button == MouseButtons.Left)
            {
                if (!m_itemIndexes.Contains(index))
                    return;

                m_itemIndexes.Remove(index);
                DrawItem(index);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-30T03:14:21.007

您将需要创建一个类型为[**Windows 窗体控件库**](http://mindstick.com/Articles/d1bc25c6-b686-4423-9cf0-147046d6e39d/)的单独项目，并将您的 UserControls 添加到其中。它的输出是类型类库。编译后，您可以通过右键单击并选择选择项目并浏览到 dll 的位置将其添加到工具箱中。

# php - 简单的mysql查询

> ID：14087983
> 
> 赞同：0
> 
> 时间：2012-12-30T03:10:39.570
> 
> 标签：php, mysql

```
$to = '555';
$from = '555';
$message = 'stuff';

mysql_query("INSERT INTO `convo` (to, from, content) 
              VALUES ( '$to', '$from', '$message' )") or die(mysql_error()); 
```

我无法弄清楚我上面的简单查询有什么问题。我错过了什么明显的东西？

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'to, from, content) VALUES ('555', '555', 'stuff' )' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T03:12:58.057

它看起来像是`to`一个 MySQL 保留字。

尝试

```
mysql_query("INSERT INTO `convo` (`to`, `from`, `content`) VALUES ( '$to', '$from', '$message' )") or die(mysql_error()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T03:13:07.333

TO 是 MySQL 关键字。要解决此问题，请在 to 字段周围加上反引号。

# ios - 当用户点击返回按钮时停止计时器运行（UINavigationController）

> ID：14087984
> 
> 赞同：0
> 
> 时间：2012-12-30T03:11:06.880
> 
> 标签：ios

我正在使用 UINavigationController。当用户点击后退按钮时，如何在计时器上停止（调用 invalidate 方法）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T03:22:12.923

我认为您可以使用`viewWillDisappear`方法间接检测何时按下后退并使您的计时器无效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:20:20.940

//放置这个viewDidLoad并确保你有一个模仿后退按钮的back.png

```
UIImage *buttonImage = [UIImage imageNamed:@"back.png"];
UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
[button setImage:buttonImage forState:UIControlStateNormal];
button.frame = CGRectMake(0, 0, buttonImage.size.width, buttonImage.size.height);
[button addTarget:self action:@selector(backPressed:) forControlEvents:UIControlEventTouchUpInside];
UIBarButtonItem *customBarItem = [[UIBarButtonItem alloc] initWithCustomView:button];
self.navigationItem.leftBarButtonItem = customBarItem; 

- (void)backPressed:(id)sender {
     [yourTimer invalidate];
  } 
```

如果计时器在另一个类中运行，则使用 NSNotificationCenter 在 backPressed 方法中发布通知

请参阅此处的 NSNotification 中心示例[NSNotification 教程](http://agilewarrior.wordpress.com/2012/02/09/dead-simple-nsnotification-example-iphone/)

# animation - 在终止前获取至少一个周期的 UIImageView 动画

> ID：14087987
> 
> 赞同：-2
> 
> 时间：2012-12-30T03:11:29.690
> 
> 标签：animation, uiimageview, nsoperation, uiactivityindicatorview, nsinvocationoperation

我是 Objective C 和 X 代码的新手，我无法让我的 UIImageView 动画在屏幕上停留至少一个完整的周期。我将它用作自定义等待动画，用于点击按钮并发生一堆保存和处理的事情。我使用 NSOperationQueue 在单独的线程中执行这些操作。这是我的代码的第一部分：

我的动画是在 ViewDidLoad 中定义的，它被称为“myAnimation”。它是一个 UIImageView 动画，由 UIImages 数组组成。我立即将其设置为隐藏并在需要时显示它。

```
-(void)viewDidLoad
{
    [super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.

    NSArray *myAnimationArray  = [[NSArray alloc] initWithObjects:
                        [UIImage imageNamed:@"arisprite_0000.png"],
                        [UIImage imageNamed:@"arisprite_0001.png"],
                        [UIImage imageNamed:@"arisprite_0002.png"],
                        [UIImage imageNamed:@"arisprite_0003.png"],
                        [UIImage imageNamed:@"arisprite_0004.png"],
                        [UIImage imageNamed:@"arisprite_0005.png"],
                        [UIImage imageNamed:@"arisprite_0006.png"],
                        [UIImage imageNamed:@"arisprite_0007.png"],
                        [UIImage imageNamed:@"arisprite_0008.png"],
                        [UIImage imageNamed:@"arisprite_0009.png"],
                        [UIImage imageNamed:@"arisprite_0010.png"],
                        [UIImage imageNamed:@"arisprite_0011.png"],
                        [UIImage imageNamed:@"arisprite_0012.png"],
                        [UIImage imageNamed:@"arisprite_0013.png"],
                        [UIImage imageNamed:@"arisprite_0014.png"],
                        [UIImage imageNamed:@"arisprite_0015.png"],
                        [UIImage imageNamed:@"arisprite_0016.png"],
                        [UIImage imageNamed:@"arisprite_0017.png"],
                        [UIImage imageNamed:@"arisprite_0018.png"],
                        [UIImage imageNamed:@"arisprite_0019.png"],
                        [UIImage imageNamed:@"arisprite_0020.png"],
                        [UIImage imageNamed:@"arisprite_0021.png"],
                        [UIImage imageNamed:@"arisprite_0022.png"],
                        [UIImage imageNamed:@"arisprite_0023.png"],
                        [UIImage imageNamed:@"arisprite_0024.png"],
                        [UIImage imageNamed:@"arisprite_0025.png"],
                        [UIImage imageNamed:@"arisprite_0026.png"],
                        [UIImage imageNamed:@"arisprite_0027.png"],
                        [UIImage imageNamed:@"arisprite_0028.png"],
                        [UIImage imageNamed:@"arisprite_0029.png"],
                        [UIImage imageNamed:@"arisprite_0030.png"],
                        [UIImage imageNamed:@"arisprite_0031.png"],
                        [UIImage imageNamed:@"arisprite_0032.png"],
                        [UIImage imageNamed:@"arisprite_0033.png"],
                        [UIImage imageNamed:@"arisprite_0034.png"],
                        [UIImage imageNamed:@"arisprite_0035.png"],
                        [UIImage imageNamed:@"arisprite_0036.png"],
                        [UIImage imageNamed:@"arisprite_0037.png"],
                               nil];

myAnimation.animationImages = myAnimationArray;
myAnimation.animationDuration = 2.5;
    [myAnimation.layer setBorderColor:[[UIColor blackColor] CGColor]];
    [myAnimation.layer setBorderWidth:2.0];

[self.view addSubview:myAnimation];
    [myAnimation setHidden:YES];
...
...
...
}

-(IBAction)saveToYYY:(id)sender
{
// hide current view and show save screen
[self showAnimatedSaveScreen];

// show the saving screen
[self.view bringSubviewToFront:savingBackgroundView];
[self.view bringSubviewToFront:savingText];
[self.view bringSubviewToFront:myAnimation];

/* Operation Queue init */
NSOperationQueue *queue = [NSOperationQueue new];

/* Create our NSInvocationOperation to call save code, passing in nil */
NSInvocationOperation *saveToYYYOperation = [[NSInvocationOperation alloc]
                                    initWithTarget:self
                                    selector:@selector(saveToYYYWithOperation)
                                    object:nil];

NSInvocationOperation *saveToXXXOperation = [[NSInvocationOperation alloc]
                                                  initWithTarget:self
                                                       selector:@selector(saveToXXXWithOperation)
                                                  object:nil];

/* Add the operation to the queue */
[saveToXXXOperation addDependency:saveToYYYOperation];
[queue addOperation:saveToYYYOperation];
[queue addOperation:saveToXXXOperation];    
} 
```

然后，在我的最后一个队列操作中，我有

```
-(void)saveToXXXWithOperation
{
... 
a bunch of processing
...

[self performSelectorOnMainThread:@selector(hideAnimatedSaveScreen) withObject:nil     waitUntilDone:YES];
} 
```

一切似乎都运行良好，除了当这些保存操作太快时，尤其是在 iPad 上，myAnimation 无法完成 2.5 的持续时间。在隐藏动画之前，我想至少播放一次。有没有办法实现这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:21:58.467

如果问题是“我如何在完成保存后等待 2.5 秒”，只需让您的`hideAnimatedSaveScreen`实现使用延迟性能 ( `performSelector:withObject:afterDelay:`)。您可以使用时间戳`[NSDate date]`（

如果问题是“我怎么知道我的动画何时完成”，这很难说，因为你实际上并没有在代码中显示任何动画，所以当你说你有一个UIImageView 动画。

# sql - 以国家为列的数据库中的规范化

> ID：14087988
> 
> 赞同：2
> 
> 时间：2012-12-30T03:11:36.323
> 
> 标签：sql, database, database-design, normalization

这一直困扰着我一段时间，考虑一个具有如下属性的表： ，主键`{ID, Value, Australia, India, France, Germany}`在哪里，是一些文本，比如汽车型号，在每个属性下，如，是对应于该值的汽车制造数量。`ID``Value``Australia``India`

直觉上我知道这是正确的方法`{ID, Value, Cars-Manufactured, Country}` ，但是有人可以告诉我为什么在数据库规范化方面这是正确的吗？第一个表不符合哪个规范化。还是第一张表也正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-30T06:36:01.300

它违反的规则是“没有重复组”。这是第一范式的规则之一。

每个国家的一列是一个重复组。每列下的数据是相同的数据，只是适用于不同的上下文。当那里只有一个价值时——比如那个国家制造的汽车数量——这可能并不明显，甚至可能值得商榷。但是假设我们需要每个国家/地区的两条信息，例如制造数量和销售数量。现在该表有一组成对的列：Australia_manufactured、Australia_sold、India_manufactured、India_sold、France_manufactured、France_sold 等。您有一组重复多次的两列。

有人可能会问，多个不同的字段和重复组有什么区别？“India_manufactured, Australia_manufactured, France_manufactured”与“number_manufactured, price, description”有何不同？不同的是，在第一种情况下，值的语义是相同的，不同的是一个上下文，一个应用程序。第二种情况，语义不同。也就是说，很难想象一个查询或程序会处理超出微不足道的“找到最大值”的数据，或者我们今天将运行它处理 number_manufactured，然后在明天运行它执行完全相同的处理但在销售价格。但我们可以很容易地想象今天为印度竞选，明天为德国竞选。

当然，有时它可能是模棱两可的。这就是为什么数据库设计人员获得大笔报酬的原因。:-)

好吧，这就是规则。规则有实用价值吗？

让我们考虑场景 A，一张表：

```
model (model_id, description, india_manufactured, australia_manufactured, france_manufactured) 
```

场景B，两张表：

```
model (model_id, description)
production (model_id, country_code, manufactured) 
```

场景 A 糟糕的原因有很多。这是最大的：

使用场景 B，查询要简单得多。我们不必将国家/地区硬编码到我们的程序或查询中。编写查询以接受国家代码作为参数并返回在该国家制造的每种型号的数量。在场景 B 中，简单：

```
select description, manufactured 
from model join production on model.model_id=production.model_id
where production.country_code=@country 
```

简单的。现在用场景 A 来做。像：

```
select description,
  case when @country_code='IN' then india_manufactured
  when @country_code='AU' then australia_manufactured
  when @country_code='FR' then france_manufactured
  else null
  end as manufactured
from model 
```

或者假设我们想要所有国家的总产量。场景 B：

```
select description, sum(manufactured)
from model
join production on model.model_id=production.model_id 
```

情景一：

```
select description, india_manufactured+australia_manufactured+france_manufactured
from model 
```

（如果我们必须允许空值，可能会更复杂。）

在整个系统中，我们可能会有很多很多这样的查询。在现实生活中，许多会比这复杂得多，有多个这样凌乱的 case 子句或杂耍多个列。现在假设我们添加另一个国家。在场景 B 中，这是零努力。我们可以添加和删除我们喜欢的所有国家，并且查询不会改变。但在场景 A 中，我们必须找到每个查询并更改它。如果我们错过了一个，我们将不会得到任何编译错误或类似的东西。我们只会神秘地得到不正确的结果。

哦，顺便说一句，有时我们可能只想处理某些国家/地区。比如说，有些国家有增值税，有些没有，或者其他什么。在场景 B 中，我们为此事实添加一列并对其进行测试。这只是“在 country.country_code=production.country_code 和 country.vat=1 上加入国家”。在场景 A 中，程序员几乎肯定会在每个查询中硬编码特定国家的列表。后来有人过来，看到查询 X 处理印度和法国，查询 Y 处理法国和德国，查询 Z 处理德国和新加坡，他可能不知道为什么。即使他知道，该列表在每个查询中都是硬编码的，因此每次更新都需要更新每个查询，更改代码而不是更改数据。

假设我们遇到一个只处理四个国家中的三个的查询。

哦，顺便说一句，

我们怎么知道这是否是一个错误，有人在编写查询时忘记了其中一个国家，或者在添加新国家时错过了这个查询；或者这个国家被排除在外有什么原因吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:22:29.387

第二种方法更适合您，因为您可以更清楚地了解数据，并且可以避免`INSERT DELETE`异常`UPDATE`情况。是的，使用第二种方法，您将拥有更多的数字数据。

基本上，当您设计数据库时，通常的方法是`3NF.`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T04:56:57.393

```
Table COUNTRYANDCARS [MODEL (PK), AUSTRALIA, INDIA, FRANCE, GERMANY] 
```

理想情况下，当您只有固定国家/地区时，上述方法是正确的。

```
Table CARPRODUCTION [MODEL (PK), COUNTRY (PK), COUNT] 
```

这将满足所有人。

# php - Javascript 和 PHP：PushState 的问题

> ID：14087993
> 
> 赞同：0
> 
> 时间：2012-12-30T03:12:19.137
> 
> 标签：php, javascript

一旦用户单击转到下一个或上一个图像，我将使用 Pushstate 更新图像 ID。

目前，我有`window.history.pushState(null, null, './action=viewcomic&id=' + imgIndex);`哪个工作正常。

![在此处输入图像描述](../Images/0ce89f1ec9b1f52f5bb569c522bd1a14.png)

但是，如果我重新加载该 url，它会给我一个“未找到”错误：

![在此处输入图像描述](../Images/4fa29ecb3c9b5c74dd9d1e6fbac64fc8.png)

我认为这是因为我没有在 URL 中“pushState'ing”站点参数......所以当我转到下一张图片时，URL 来自：

```
http://www.hittingtreeswithsticks.com/?action=viewimage&site=comics&id=54 
```

到：

```
http://www.hittingtreeswithsticks.com/action=viewcomic&id=55 
```

所以我试图通过在 pushState 中包含 site 参数来解决这个问题：

```
var site = <?php echo $site ?>;
window.history.pushState(null, null, './action=viewcomic&site=' + site + '&id=' + imgIndex); 
```

但现在它甚至不会加载图像。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T03:28:00.573

您没有在“操作” GET 变量前面添加问号。

# php - 语法错误，意外的 T_STRING，需要 ']'

> ID：14087994
> 
> 赞同：0
> 
> 时间：2012-12-30T03:12:23.780
> 
> 标签：php, parsing, syntax-error, tstringlist

有人可以解释为什么我在下面的代码中收到这个错误以及我可以做些什么来修复它，错误指的是：`echo "<tr><td>{$r['logID']}</td><td><a href='viewuser.php?u={$r['>{$r['username']}</a> [{$r['userID']}]</td><td>{$r['amount']}</td><td><a href='5050.php?chal={$r['>Challenge</a></td><td>";`

在这里把它放到上下文中就是整个片段。

```
<?php
include "globals.php";
$minbet=1;
$maxg=10;
echo "<big>50 / 50 Crystals Game</big>";
function add_game()
{
        global $ir,$t,$userid, $db, $minbet, $maxg;
        if(!isset($_POST['amt']))
        {
            echo "<big>Adding a game</big>
                <form action='5050.php?add=1' method='post'>
                Amount of crystals:<input type='text' name='amt' size=10 maxlength=10>
                <input type='submit' value='Add!'></form>
                ($maxg games max per user)
                <a href='5050.php'>Back</a>";

        }
    else
        {
            $_POST['amt'] = abs((int) $_POST['amt']); 
            if($_POST['amt'] < $minbet)
                {
                    echo "The minimum bet is $minbet
                        <a href='5050.php?add=1'>Back</a>";exit;
                }
            $theckcount=$db->query("SELECT logID FROM tchance WHERE userID={$ir['userid']} and active=1");
            if($db->num_rows($theckcount) > ($maxg-1))
                {
                echo "There is a maximum of $maxg games per user.
                    <a href='5050.php'>Back</a>";exit;
                }
            if($ir['crystals'] < $_POST['amt'])
                {
                echo "You cannot afford that amount.
                    <a href='5050.php'>Back</a>";exit;
                }
            $db->query("UPDATE users SET crystals = crystals - {$_POST['amt']} WHERE userid = {$ir['userid']}");
            $ir['crystals']=$ir['crystals'] - $_POST['amt'];
            $db->query("INSERT INTO tchance VALUES ('', {$ir['userid']}, {$_POST['amt']}, 1)");
            echo "Your game has been set.  Good Luck.
                <a href='5050.php'>Back</a>";
        }

}
function view_games()
{
        global $ir,$t,$userid, $db, $maxg;

        $q=$db->query("SELECT t.*, u.username FROM tchance t left join users u on u.userid = t.userID WHERE t.active = 1 ORDER BY t.logID ASC");

        echo "<a href='5050.php?add=1'>Add Game</a>

    Table of users awaiting a challenge

        <table class='table' width=50%><tr><th>Game ID</th><th>User</th><th>Amount</th><th>Challenge</th><th>Cancel</th></tr>";
        if($db->num_rows($q) < 1){echo "<tr><td colspan=5>There are currenly no challenges</td></tr>";}
        while($r=$db->fetch_row($q))
    {
        echo "<tr><td>{$r['logID']}</td><td><a href='viewuser.php?u={$r['>{$r['username']}</a> [{$r['userID']}]</td><td>{$r['amount']}</td><td><a href='5050.php?chal={$r['>Challenge</a></td><td>";
        if($ir['userid']==$r['userID']){echo "<a href='5050.php?cancel={$r['>Cancel</a>";}             
        echo "</td></tr>";
        }
        echo "</table>";
        }
    function dogame()
        {
        global $ir,$t,$userid, $db;
        $_GET['chal'] = abs((int) $_GET['chal']);
        $q=$db->query("SELECT t.*, u.username from tchance t LEFT JOIN users u ON t.userID = u.userid Where t.logID={$_GET['chal']} AND t.active = 1 LIMIT 1");
        if($db->num_rows($q) > 0)
        {
            $r=$db->fetch_row($q);
            if($ir['crystals'] < $r['amount'])
                {
                    echo "You cannot afford the challenge amount.
                    <a href='5050.php'>Back</a>";exit;
                }
                if($ir['userid'] == $r['userID'])
                {
                    echo "You cannot accept your own challenge.
                    <a href='5050.php'>Back</a>";exit;
                }
                if(rand(1,2) == 1)
                {
                    $winner=$r['userID']; $loser=$ir['userid'];
                    $winnername=$r['username'];
                    $losername=$ir['username'];
                    $tstring="Sorry, you Lost. Better luck next time.
                    <a href='5050.php'>Back</a>";
                    $db->query("UPDATE users SET crystals = crystals - {$r['amount']} WHERE userid={$ir['userid']}");
                    $db->query("UPDATE users SET crystals = crystals + ({$r['amount']} * 2) WHERE userid={$r['userID']}");
                }
                else
                {
                    $winner=$ir['userid']; $loser=$r['userID'];
                    $winnername=$ir['username'];
                    $losername=$r['username'];
                    $tstring="You Won! Congratulations! You Won {$r['amount']} crystals. 
                    <a href='5050.php'>Back</a>";
                    $db->query("UPDATE users SET crystals = crystals + {$r['amount']} WHERE userid={$ir['userid']}");
                }
                event_add($winner, "The game of {$r['amount']} crystals challenged by <a href='viewuser.php?u={$r['>{$r['username']}</a> was won by <a href='viewuser.php?u={$winner}'>{$winnername}</a>.", $t);
                event_add($loser, "The game of {$r['amount']} crystals challenged by <a href='viewuser.php?u={$r['>{$r['username']}</a> was won by <a href='viewuser.php?u={$winner}'>{$winnername}</a>.", $t);
                $db->query("UPDATE tchance SET active = 0 WHERE logID={$_GET['chal']}");
                echo $tstring;
        }
        else
        {
            echo "This game has either been cancelled or someone played before you got the 5050.
            <a href='5050.php'>Back</a>"; exit;
        }
    }

function cancel()
{
    global $ir,$t,$userid, $db;
    $_GET['cancel'] = abs((int) $_GET['cancel']);
    $q=$db->query("SELECT * from tchance where logID={$_GET['cancel']} AND active = 1");
    if($db->num_rows($q) > 0)
    {
        $r=$db->fetch_row($q);
        $db->query("UPDATE users SET crystals = crystals + {$r['amount']} WHERE userid = {$ir['userid']}");
        $ir['crystals']=$ir['crystals'] + $r['amount'];
        $db->query("UPDATE tchance SET active = -1 WHERE logID = {$_GET['cancel']}");
        echo "The game has been cancelled, and your crystals has been returned.
        <a href='5050.php'>Back</a>";
    }
        else
    {
        echo "This game has already been canceled, does not exist, or someone already played.
        <a href='5050.php'>Back</a>";
    }

}

if(isset($_GET['cancel'])){cancel();}
elseif(isset($_GET['chal'])){dogame();}
elseif(isset($_GET['add'])){add_game();}
else{view_games();}

?> 
```

感谢您花时间帮助我和教我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T03:16:19.747

您忘记关闭数组： `?chal={$r['>Challenge</a></td><td>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T03:24:26.170

```
echo "<tr><td>{$r['logID']}</td><td><a href='viewuser.php?u={$r['>{$r['username']}</a> [{$r['userID']}]</td><td>{$r['amount']}</td><td><a href='5050.php?chal={$r['>Challenge</a></td><td>"; 
```

双引号中间有 "$r[" 。用斜杠转义它，你会更好（PHP 正在尝试评估你的变量）。您可能不是要拥有 $r，而只是要拥有 r

```
 echo "<tr><td>{$r['logID']}</td><td><a href='viewuser.php?u={\$r['>{$r['username']}</a> [{$r['userID']}]</td><td>{$r['amount']}</td><td><a href='5050.php?chal={$r['>Challenge</a></td><td>"; 
```

我个人认为您的语法令人困惑，我宁愿使用“。” 连接字符串和变量：

```
echo ' <tr><td>'
         .   $r['logID']
         . '</td><td>'
         .  '<a href="viewuser.php?u=r[' . $r['username'] .']">'.$r['username'].'</a>'
         .  '['.$r['userID'].']</td><td>'
         .  $r['amount'] . '</td><td>'
         . '<a href="5050.php?chal=r">Challenge</a></td><td>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T03:30:42.130

您的回声中还有许多未转义的双引号，这导致了另一个错误。看看你能不能找到它们！这是一个很好的做法。

当您过度使用双引号时，我还建议使用单引号，反之亦然。

# php - 上传通知

> ID：14087998
> 
> 赞同：0
> 
> 时间：2012-12-30T03:13:11.987
> 
> 标签：php, javascript

我正在使用 EFUMultiple Uploader 在我的网站上接收文件。有谁知道每次上传文件夹中有新文件或一批文件时如何通知我的教程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T03:25:29.127

它会变得烦人，很快，我可以向你保证。

但无论哪种方式，在您的上传脚本中，如果您没有在 PHP 安装中配置 SMTP 服务器，您将需要使用[mail()](http://php.net/mail)函数或例如[PHPMailer库。](https://code.google.com/a/apache-extras.org/p/phpmailer/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T03:59:43.980

考虑这个（未经测试的）脚本：

```
#!/usr/bin/env php
<?php
// Warning: this script and UPLOADED_FILES_DB, for security reasons, should not be in UPLOAD_PATH.
define('UPLOAD_PATH', '...');
define('UPLOADED_FILES_DB', 'uploaded_files');

define('MAIL_TO', 'you@example.com');
define('MAIL_FROM', 'cron@example.com');
define('MAIL_SUBJECT', 'Uploaded files');

// Get old files:
if (file_exists(UPLOADED_FILES_DB)) {
    $old_files = unserialize(file_get_contents(UPLOADED_FILES_DB));
} else {
    $old_files = array();
}

// Get current files:
$current_files = array();
foreach (new DirectoryIterator(UPLOAD_PATH) as $file_info) {
    if (!$file_info->isDot()) {
        $current_files[$file_info->getFilename()] = filemtime($file_info->getFilename());
    }
}

// Update database:
file_put_contents(serialize($current_files), UPLOADED_FILES_DB);

// Compute differences:
$added_files = array_diff(array_keys($old_files), array_keys($current_files));
$removed_files = array_diff(array_keys($current_files), array_keys($old_files));
$changed_files = array_diff_assoc($old_files, $current_files);

// Send message:
$headers = 'From: ' . MAIL_FROM . "\r\n";
$message = 'Added files: ' . implode(', ', $added_files);
mail($to, $subject, $message, $headers); 
```

然后，您可以将该脚本放在一个 cron 作业中以每天左右执行，或者您可以`include`将它放在您上传代码所在的任何位置——不过，后一种方法会很快变得烦人。